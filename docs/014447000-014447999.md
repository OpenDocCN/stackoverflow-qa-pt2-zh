# StackOverflow 问答 14447000-14447999

# ruby-on-rails - 检测 Facebook 用户是否使用 HTTPS

> ID：14447004
> 
> 赞同：1
> 
> 时间：2013-01-21T20:51:08.743
> 
> 标签：ruby-on-rails, ruby, facebook, facebook-graph-api, koala

我有一个通过 NET:HTTP 连接提取所有用户个人资料照片的过程。问题是我不知道用户的帐户使用的是 HTTP 还是 HTTPS——如果我得到了正确的细节，这个过程就可以正常工作。有没有一种好的、可靠的方法可以让 Koala gem 显示用户的安全级别？

我一直在挖掘 FB api，找不到任何有关此的信息。希望给点建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-31T21:35:53.580

我通过完全绕过它解决了这个问题。我重新设计了应用程序以相互通信，而不是每个人都向 FB Graph 发出自己的请求。

连接到 FB api 的应用程序将我需要的内容转储到数据库中，然后向另一个应用程序发出请求（使用新记录的 id）。然后，该应用程序回调 FB 应用程序，该应用程序提供一个 json 服务，其中包含其他应用程序从图中需要的所有内容。完全消除 http/https 问题和身份验证问题。

# ruby - ruby 正则表达式以 gsub 字符串的特定部分

> ID：14447007
> 
> 赞同：1
> 
> 时间：2013-01-21T20:51:26.173
> 
> 标签：ruby, regex

如何在 ruby​​ 中指定特定字符或特定字符`gsub`的子字符串？`starts with``enclosed by`

例如：输入是：`Prime rates[ U.S. Effective Date: 12/16/2008 ]` 我想 gsub 由两个方括号 [ 和 ] 括起来的子字符串，并希望输出如下：`Prime Rates`

如何使用 ruby​​ 正则表达式来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:55:07.947

也许是这样的：

```
s.gsub(/\[.*\]/, "") 
```

`[]`假设此类子字符串不超过一次，这将删除包含在其中的任何内容。

# ruby - 收到错误“nil:NilClass (No MethodError)”

> ID：14447008
> 
> 赞同：0
> 
> 时间：2013-01-21T20:51:26.637
> 
> 标签：ruby, mechanize, mechanize-ruby

***请找到代码的一部分：***

```
button = Login_form.button_with(:name => 'Submit')
loggedin_page = Login_form.submit(button)

bizz_hierarchy_form=loggedin_page.form('login_showSplashForm')
button = bizz_hierarchy_form.button_with(:name => 'btnHome')  #error raised here
# buyer_page = bizz_hierarchy_form.submit(button)
# print buyer_page.title 
```

***错误***

```
D:\Ruby script>ruby Test.rb
mechanize.rb:20:in `<main>': undefined method `button_with' for nil:NilClass (No
MethodError)

D:\Ruby script> 
```

***html***

```
<td>
<input type="submit" name="btnHome" value="Homepage" class="btnBig"><input type="hidden" name="_synchToken_hom" value="1139cc8dd7d906f1"/>
</td> 
```

请帮我解决错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:55:35.723

看起来`form('login_showSplashForm')`什么都没有，尝试使用`form_with`或者也许`forms.first`

# .htaccess - 需要在 Chrome、FireFox 中提示 RDP 文件下载

> ID：14447014
> 
> 赞同：0
> 
> 时间：2013-01-21T20:51:54.460
> 
> 标签：.htaccess, google-chrome, rdp

我们的网站上有一个 RDP 链接，该链接在 IE 中运行良好（提示用户下载）。但是，如果用户尝试在 Chrome 或 FireFox 中访问该链接，则会显示文件内容而不是强制下载。

我添加了正确的 content-type 和 content-disposition 标头，并在 HTACCESS (AddType application/x-rdp rdp) 中添加了 mime 类型，但没有运气强制下载。有什么建议么？

下载链接：[http ://www.drivecms.com/uploads/city-commercial.com/2100236394CityCom%20TS01.RDP](http://www.drivecms.com/uploads/city-commercial.com/2100236394CityCom%20TS01.RDP)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:15:50.457

Web 服务器配置中的某个位置或父目录的 .htaccess 文件中的[AllowOverride](http://httpd.apache.org/docs/2.2/mod/core.html#allowoverride "阿帕奇文档")指令可能会阻止您通过 htaccess 文件更改 MIME 类型。

# mysql - 如何使用 MYSQL（每行的子查询）优化这些指令？

> ID：14447018
> 
> 赞同：1
> 
> 时间：2013-01-21T20:52:00.003
> 
> 标签：mysql

我的问题是我们做了一个选择，然后，对于每一行，我们运行 4 个不同的请求 SQL（很疯狂），你可以猜到我们发出了很多请求，并且使用它的系统非常慢。

```
SELECT 
    deal_source.id, 
    deal_source.source_name, 
    deal_source.spider_status, 
    spider.last_success_date
FROM deal_source 
JOIN spider 
ON deal_source.id = spider.deal_source_id 
```

然后对于这个查询的每一行，我们进行：

```
$total_query = "SELECT count(id) as total
                FROM spider_log 
                WHERE deal_source_id = '$deal_source_id' 
                AND date_format(date_created, '%Y-%m-%d') = '$lastdate' ";

$added_query = "SELECT count(id) as added
                FROM spider_log 
                WHERE deal_source_id = '$deal_source_id' 
                AND action = 'added'  
                AND date_format(date_created, '%Y-%m-%d') = '$lastdate' ";

$extended_query = "SELECT count(id) as extended 
                   FROM spider_log 
                   WHERE deal_source_id = '$deal_source_id' 
                   AND action = 'extended'  
                   AND date_format(date_created, '%Y-%m-%d') = '$lastdate' ";

$duplicate_query = "SELECT count(id) as duplicate 
                    FROM spider_log 
                    WHERE deal_source_id = '$deal_source_id' 
                    AND action = 'duplicate'  
                    AND date_format(date_created, '%Y-%m-%d') = '$lastdate' "; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:00:00.893

```
SELECT   d.id,
         d.source_name,
         d.spider_status,
         s.last_success_date,
         COUNT(l.id) AS total,
         SUM(l.id IS NOT NULL AND l.action='added'    ) AS added,
         SUM(l.id IS NOT NULL AND l.action='extended' ) AS extended,
         SUM(l.id IS NOT NULL AND l.action='duplicate') AS duplicate
FROM     deal_source d
    JOIN spider      s
      ON s.deal_source_id  = d.id
    JOIN spider_log  l
      ON l.deal_source_id  = d.id
      ON l.date_created   >= s.last_success_date
     AND l.date_created   <  s.last_success_date + INTERVAL 1 DAY
GROUP BY d.id 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T21:04:50.527

几点：

*   您可以优化每个查询的性能，使用`EXPLAIN`和仔细添加索引。

*   您可以将所有查询组合成一个大查询，因此您不必使用大量查询来访问数据库。

*   除了大量查询之外，The`date_format(date_created, '%Y-%m-%d') = '$lastdate'`还是一个性能杀手，因为它将函数 ( `DATE_FORMAT()`) 应用于列 ( `date_created`)，因此无法使用索引，并且该函数被调用数千次或数百万次（因为检查了许多行）。将此类条件（无论它们在您的代码中的何处）更改为：

    ```
     (  date_created >= DATE('$lastdate') 
    AND date_created < DATE('$lastdate') + INTERVAL 1 DAY
     ) 
    ```

    甚至更好，如果那`$lastdate`是一个日期，到：

    ```
     (  date_created >= '$lastdate' 
    AND date_created < '$lastdate' + INTERVAL 1 DAY
     ) 
    ```

    `date_created`如果是一`DATE`列，则更好的是：

    ```
     date_created = '$lastdate' 
    ```

# java - Java RCaller - 基本示例不起作用

> ID：14447020
> 
> 赞同：2
> 
> 时间：2013-01-21T20:52:06.383
> 
> 标签：java, r, rcaller

我在这里安装了 R：

C:\Program Files\R\R-2.15.2\bin\ 我在哪里找到我的“Rscript.exe”和“R.exe”

我正在使用[此处找到的代码示例](http://stdioe.blogspot.com/2011/07/rcaller-20-calling-r-from-java.html)

我为 RCaller-2.0.7.jar 添加了我的 rCaller 参考

当我运行代码 1 - 我不能只有上面的路径时，我需要输入完整路径和文件名 (.exe)。如果我这样做，我会得到：

```
 run:
        [Fatal Error] Routput5525030595700249151:1:1: Premature end of file.
        packageExist<-require(Runiversal)
        if(!packageExist){
        install.packages("Runiversal", repos=" http://cran.r-project.org")
        }

        packageExist<-require(Runiversal)
        if(!packageExist){
        install.packages("Runiversal", repos=" http://cran.r-project.org")
        }

        x<-c(1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0);
        y<-c(2.0, 4.0, 6.0, 8.0, 10.0, 12.0, 14.0, 16.0, 18.0, 30.0);
        ols<-lm(y~x)
        cat(makexml(obj=ols, name="ols"), file="C:/DOCUME~1/Jason/LOCALS~1/Temp/Routput5525030595700249151")

        rcaller.exception.RCallerExecutionException: Can not handle R results due to : rcaller.exception.RCallerParseException: Can not parse the R output: org.xml.sax.SAXParseException; systemId: file:/C:/DOCUME~1/Jason/LOCALS~1/Temp/Routput5525030595700249151; lineNumber: 1; columnNumber: 1; Premature end of file.
        BUILD SUCCESSFUL (total time: 0 seconds) 
```

现在..我不是 R 的专业人士，但如果我进去尝试，`install.packages("Runiversal",repos="http://cran.r-project.org")`我会被告知：

> install.packages("Runiversal", repos=" [http://cran.r-project.org](http://cran.r-project.org) ") 警告：无法访问存储库的索引 [http://cran.r-project.org/src/contrib](http://cran.r-project.org/src/contrib) 警告：无法访问存储库的索引 [http://cran.r-project.org/bin/windows/contrib/2.15](http://cran.r-project.org/bin/windows/contrib/2.15) 警告消息：包“Runiversal”不可用（对于 R 版本 2.15.2）

请我对这篇文章感到抱歉，但我想不出更好的方法来证明我的问题/沮丧。

谢谢你。

# iphone - 我可以通过 testflight 分发测试而不在 iTunes Connect 上创建我的应用程序吗？

> ID：14447021
> 
> 赞同：0
> 
> 时间：2013-01-21T20:52:13.930
> 
> 标签：iphone, ios, xcode, app-store-connect, testflight

我想通过 TestFlight 将我的应用程序演示发送给某人。

我一直在关注这个答案：[https ://stackoverflow.com/a/11917884/555690](https://stackoverflow.com/a/11917884/555690)

最终，您会看到：

> 登录 iTunes Connect 并创建应用程序详细信息

我现在必须在 iTunes Connect 中创建我的应用吗？我认为我还没有足够的信息/细节。另外，我听说当您创建应用程序时，您必须在一定的时间范围内（六个月？）上传二进制文件，否则您将被迫创建不同的 iTunes Connect 应用程序条目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:56:54.683

不，您无需登录 iTunes Connect 并添加详细信息。

您需要登录 developer.apple.com -> Member Center -> Create Ad hoc distribution profile -> Create build -> Upload to test-flight。

希望这些信息对你有帮助..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T20:57:16.137

不，您不需要在 iTunes Connect 中创建它，但您确实需要在[Apple iOS Developer Portal](https://developer.apple.com/devcenter/ios/index.action)中创建它。

# php - 不再数组 json 以及如何在 jquery 中提醒 json 数据

> ID：14447022
> 
> 赞同：-1
> 
> 时间：2013-01-21T20:52:24.070
> 
> 标签：php, arrays, json, codeigniter

不知道为什么这不再是数组并且 {},{} 之间没有逗号

```
foreach ($query->result_array() as $row) {
    header("Content-type: application/json");
    echo (json_encode($row,JSON_PRETTY_PRINT));
} 
```

以及如何在 jquery 中提醒 json 数据？在此之前，我在 js 中使用 for 循环来循环它，但由于某种原因，我现在必须在服务器端循环。

已编辑

```
//because i want to replace $row['url'] to get_thumb();    
foreach($query->result_array() as $row){
        $row['url'] = $this->vz_image->get_thumb($row['url'],'n');
        header("Content-type: application/json");
    echo (json_encode($row,JSON_PRETTY_PRINT));
    } 
```

然后我得到了这个结果，但我不知道如何在 jquery 中提醒这个 json 数据。有什么帮助吗？

```
{
"id": "44",
"url": "assets\/img\/uploaded_photos\/thumbs\/1358786330_n.jpg",
"created_time": "1358786330",
"photo_id": "170",
"tag_id": "44",
"name": "Lan Yao Yeng",
"num_photo": "3"
}{
"id": "44",
"url": "assets\/img\/uploaded_photos\/thumbs\/1358711532_n.jpg",
"created_time": "1358711532",
"photo_id": "169",
"tag_id": "44",
"name": "Lan Yao Yeng",
"num_photo": "3"
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:55:52.477

它不是一个数组，因为你没有给它一个数组。

您一个接一个地呼应了许多对象；不是对象数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T20:56:15.497

如果要将整个数组传递给客户端，只需对数组本身进行编码，而不是对每个元素进行编码。

```
function map($row){
    if (isset($row['url']))
        $row['url'] = $this->vz_image->get_thumb($row['url'],'n');
    return $row;
}

header("Content-type: application/json");
echo json_encode(array_map("map", $query->result_array()),JSON_PRETTY_PRINT); 
```

如果您在课堂上使用它，您可能需要更改`array_map("map", $query->result_array())`为`array_map(array($this, "map"), $query->result_array())`.

# symfony - Symfony2 和 Doctrine - 如何从连接表中插入项目

> ID：14447023
> 
> 赞同：0
> 
> 时间：2013-01-21T20:52:24.723
> 
> 标签：symfony, doctrine

我有两张桌子，`game`和`own`。在`own`的实体中，我创建了`OneToMany`关系：

```
 /** @ORM\ManyToOne(targetEntity="Game") */ 
 private $game; 
```

并且在`game`Entity 字段`id`中也被映射：

```
* @ORM\OneToMany(targetEntity="Own", mappedBy="game") 
```

现在我在我的数据库中插入新数据时遇到了问题。我尝试简单地持久化对象：

```
$gameown = new Own();
$gameown -> setGame('3');
$gameown -> setUpdated(date("Y-m-d H:i:s"));

$em = $this->getDoctrine()->getEntityManager();
$em->persist($gameown);
$em->flush(); 
```

但它不起作用。Symfony 说它必须是一个`Game`实例，而不是一个字符串。如何解决这个问题？

当我尝试这个时：

```
$gameown -> setGame($game->getId('3')); 
```

它插入没问题，但是......空值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T01:24:23.910

或者

你也可以这样做

`$gameObject = $em->getRepository('YourBundle:Game')->findOneBy(array('id' => 3));`

然后你可以使用

`$gameown->setGame($gameObject);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T23:17:15.380

实际上，您必须使用游戏对象，而学说会为您完成工作。用对象思考，而不是用表格思考。

首先，您必须检索您的对象（例如从数据库中）：

```
$em = $this->getDoctrine()->getEntityManager();
$game = $em->getRepository('AppMonBundle:Game')->find(3); 
```

然后，您可以设置关系：

```
$gameown->setGame($game); 
```

# html - URI 后缀的意义是什么？

> ID：14447028
> 
> 赞同：1
> 
> 时间：2013-01-21T20:52:51.157
> 
> 标签：html, uri

我创建了一个文件并将其命名为 test.txt。该文件包含以下内容：

```
<!DOCTYPE html>
<body>
Testing ...
</body> 
```

当我将浏览器指向它时，不会呈现文件的内容。如果我将文件重命名为 test.htm，它会正确显示，即没有标记符号。有人能解释一下后缀的意义，或者给我一些相关的文件吗？谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T20:56:55.810

在文件系统上，文件扩展名决定了文件中存储的数据类型。

在 HTTP URI 中，它是没有意义的……但是，如果您将 URL 映射到文件系统（提供静态内容的常用方法），那么 Web 服务器将使用文件扩展名来确定`Content-Type`浏览器使用的 HTTP 响应标头确定数据类型。

# indexeddb - 为什么 indexedDB objectStore.get 即使在 objectStore 不包含对象的情况下也会调用 onsuccess？

> ID：14447030
> 
> 赞同：1
> 
> 时间：2013-01-21T20:52:53.523
> 
> 标签：indexeddb

关于 indexedDB 的奇怪之处之一是带有不在 objectstore 中的键的 objectStore.get() 请求会生成成功事件`(event.target.results == undefined)`（请参阅：[http ://www.w3.org/TR/IndexedDB/#object-存储](http://www.w3.org/TR/IndexedDB/#object-store)get 函数）。

我需要捕获这种类型的*“成功”*并记录下来。现在，我在返回的事件中找不到 KEY。所以我正在做一个真正的黑客并将其存储在事务中。有什么建议吗？

```
 var deferred = new jQuery.Deferred(); // this is what gets returned
    var id = view.zoom + "-" + view.tile.column + "-" + view.tile.row;
    trans = DB.transaction(["Images"], "readonly");
    store = trans.objectStore("Images");
    req = store.get(id);
    trans._keyPathForGet = id; // hack
    req.onsuccess = function (e) {
        var blob = e.target.result;
        if (blob == undefined) {
            console.log("no blob of id: " + e.target.transaction._keyPathForGet);
            deferred.resolve(null);
        } else {
            var imgURL = URL.createObjectURL(blob);
            deferred.resolve(imgURL); // let leaflet know we're done, and give it the URL
            URL.revokeObjectURL(imgURL); // not sure if we're revoking it too soon here
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T02:47:32.460

这是用于组合键和键范围的过度紧凑 API 设计的产物。即使没有删除任何内容，您也可以找到删除 ramdon 键也会获得成功事件。我对键范围查询返回成功很好，但键查询应该返回错误事件。

无论如何，这类问题有很好的替代解决方案。最好的方法是使用光标。存储密钥不是问题，您可以在函数闭包下保存。

```
var getFile = function (id) {
  ...
  var req = store.openCursor(id);
  req.onsuccess = function(e) {
    var cursor = e.target.result;
    if (cursor) {
       var blob = cursor.value; 
       ...
    } else {
       var err = new Error();
       err.name = 'NotFoundError';
       err.id = id;
       deferred.reject(err);        
    }
  }
  return deferred;
} 
```

您还可以使用`count`方法来查询键是否在对象存储中。

# programming-languages - 如何选择编程语言？

> ID：14447032
> 
> 赞同：0
> 
> 时间：2013-01-21T20:52:56.057
> 
> 标签：programming-languages

我有一个导航提供界面，在给定起点和终点的地方，也许还有街道地图，然后根据地图选择路径，即如果找到一条路然后朝该方向移动，或者如果一些发现阻塞，或者如果路径不会通向所需的目的地，则可能检查其他路径。

现在哪种编程语言最适合它？到目前为止，我只使用过 C。我可以只用 C 编写代码吗？

在我开始这个项目之前，我还有什么需要注意的吗？（除了实施问题）。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:55:45.453

看，最好的办法就是开始编码并找出答案。如果您没有经验，最好使用您熟悉的语言而不是学习新的语言。归根结底，您可以使用大多数语言完成大多数任务。

重要的不是你使用*什么*，而是你*如何*使用它。

在寻路实现方面，您可能希望从查看 A-star 或 Dijkstra 算法开始。

# c++ - Direct3D YUV 格式？

> ID：14447033
> 
> 赞同：2
> 
> 时间：2013-01-21T20:52:57.397
> 
> 标签：c++, video, direct3d, yuv, dxgi

[Direct3D 11 for Windows 8 中](http://msdn.microsoft.com/en-us/library/windows/desktop/bb173059%28v=vs.85%29.aspx)的 YUV 纹理格式如何工作？文档有点稀疏，我没有找到任何示例。

在着色器中读取此类纹理时，是否会`texture.rgb`发生`.yuv`自动转换或自动转换？如果是这样，使用什么转换（[ITU-R BT.601](http://en.wikipedia.org/wiki/YCbCr#ITU-R_BT.601_conversion)）SD 或（[ITU-R BT.701](http://en.wikipedia.org/wiki/YCbCr#ITU-R_BT.709_conversion)）HD 还是根据纹理大小自动选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-30T23:49:16.657

Direct3D 不执行 YUV 颜色空间转换。有关映射，请参阅 DXGI_FORMAT 页面（在您的问题中链接）。例如：

> **DXGI_FORMAT_AYUV** ... 到视图通道的映射是 V->R8、U->G8、Y->B8 和 A->A8。

# excel - 在 Excel 中按名称和状态查找顶部求和子值

> ID：14447039
> 
> 赞同：1
> 
> 时间：2013-01-21T20:53:43.777
> 
> 标签：excel, pivot-table

我有一个包含状态、名称和计数的 Excel 表。我试图通过每个州的计数总和来找到最高名称。因此，例如，使用以下内容：

```
State | Name     | Count
IA    | Joe      | 10
IA    | John     | 10
IA    | Joe      | 5
NE    | Joe      | 5
NE    | John     | 10
NE    | John     | 15
NE    | Joe      | 10
NE    | Amy      | 30
OH    | Joe      | 10
OH    | John     | 10
OH    | Amy      | 5
OH    | Joe      | 5 
```

预期结果将是：

```
IA | Joe (15)
NE | Amy (30)
OH | Joe (15) 
```

关于如何做到这一点的任何想法？也许有数据透视表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:09:43.697

几种方法脱颖而出

1) 使用 2 个具有名称和状态的行标签的枢轴作为列标签并对值求和。第二个枢轴基于第一个枢轴使用列表名称作为行标签和状态最大值作为值，然后使用条件格式突出显示具有相同总计的那些。 ![在此处输入图像描述](../Images/b08e16dfda369409fee8b52734dd7872.png)

第二个选项与第一个选项相似，但不是使用第二个枢轴，而是为每个状态设置单独的值，这些值具有枢轴中状态的公式（=max），然后基于此条件格式。

第三个选项将其定义为一个表，然后使用嵌入式 SQL 和表单编写一个查询，以按状态为您提供总和和最大值。目前还没有这样的示例。

# windows - 如何从 Git Gui 打开 Git Bash？

> ID：14447040
> 
> 赞同：6
> 
> 时间：2013-01-21T20:53:56.567
> 
> 标签：windows, git, git-gui

在 Windows 中，有没有办法从 Git Gui 当前打开的存储库中打开 Git Bash？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T21:17:09.200

转到“工具”菜单并选择“添加”。在名称输入字段中，输入“bash prompt”之类的内容，然后在命令输入字段中输入`start bash --login -l`并选中“不显示命令输出窗口”。这将添加以下配置条目：

```
[guitool "bash"]
    cmd = start bash --login -l
    noconsole = yes 
```

这为您提供了一个“Tools\bash”菜单项，单击它会启动您的 bash 提示符。

请注意，由于 'start' 命令前缀，它独立于启动的 Tcl 应用程序，并且会在您退出 git gui 后保留。

# iphone - 自动更新目标 c 中两个位置之间的距离

> ID：14447043
> 
> 赞同：1
> 
> 时间：2013-01-21T20:54:00.840
> 
> 标签：iphone, objective-c, cllocation

我对objective-c非常陌生，并且尝试了多种资源来找到答案。到目前为止没有运气。请帮帮我。

我正在构建一个具有位置功能的应用程序。当覆盖给定距离时，应用程序必须发出警报。因此我必须保存一个初始位置。移动时必须显示实际位置和距离。

我所做的是以下内容：

```
-(void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{
//display latitude
NSString *lat =[[NSString alloc]initWithFormat:@"%f",
                 newLocation.coordinate.latitude];
latitude.text=lat;
//latr = lat;

//display longitude
NSString *lon = [[NSString alloc]initWithFormat:@"%f",
                 newLocation.coordinate.longitude];
longitude.text=lon;
//longr = lon;

//display accuracy
//NSString *acc = [[NSString alloc]initWithFormat:@"%f",
//                 newLocation.horizontalAccuracy];
//accuracy.text=acc;
    }

-(void)recordLocation{

double valueLat = [[latitude text]doubleValue];
int latSeconds = valueLat * 3600;
int latDegrees = latSeconds / 3600;
latSeconds = abs(latSeconds % 3600);
int latMinutes = latSeconds / 60;
latSeconds %= 60;

char latChar = (latitude > 0) ? 'N' : 'S';

double valueLon = [[longitude text]doubleValue];
int lonSeconds = valueLon * 3600;
int lonDegrees = lonSeconds / 3600;
lonSeconds = abs(lonSeconds % 3600);
int lonMinutes = lonSeconds / 60;
lonSeconds %= 60;

char lonChar = (longitude > 0) ? 'E' : 'W';

CLLocation *tempPos = [[CLLocation alloc] initWithLatitude:valueLat longitude:valueLon];

NSString *recPosition = [[NSString alloc]initWithFormat:@"%i° %i' %i\" %c" "   " @"%i° %i' %i\"  %c \n", latDegrees, latMinutes, latSeconds, latChar,lonDegrees, lonMinutes, lonSeconds, lonChar];

_labelDegrees.text = recPosition;

NSLog(@"%f" , valueLat);
NSLog(@"%f" , valueLon);
NSLog (@"%@", tempPos);

[self distanceFromLocation:tempPos];

}

- (CLLocationDistance)distanceFromLocation:(const CLLocation *)tempPos{

double lat1 = [[latitude text] doubleValue];
double lon1 = [[longitude text] doubleValue];

CLLocation *currentLocation = [[CLLocation alloc] initWithLatitude:lat1 longitude:lon1];

CLLocationDistance locDistance = [currentLocation distanceFromLocation:tempPos];

NSString *distText = [[NSString alloc]initWithFormat:@"%f", locDistance];

NSLog(@"%@", currentLocation);
NSLog(@"%f", locDistance);
NSLog(@"%@", distText);

[lonDistance setText:distText];
} 
```

它可以工作，但只有一次，当我单击界面中的按钮时。没有 locDistance 的自动更新。初始位置自动更新（在互联网上找到），该位置的记录也可以。我的代码有什么问题。这可能是一个简单的问题，但我无法找到解决方案。

（请原谅我糟糕的英语，我是荷兰人）

预先感谢您的帮助

问候，

阿德里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:23:55.580

您需要从 didUpdateToLocation:fromLocation: 方法中调用 recordLocation。只要位置变化超过可以在位置管理器上设置的 distanceFilter 距离，位置管理器就会自动调用该方法。当它被调用时，您希望它调用 recordLocation，然后调用 distanceFromLocation。

locationManager:didUpdateToLocation:fromLocation: 在 iOS 6 中已弃用，因此如果您使用的是该 iOS，那么您应该使用 locationManager:didUpdateLocations:

# python - 从 django-social-auth 导入测试时出现 Python 导入错误

> ID：14447044
> 
> 赞同：1
> 
> 时间：2013-01-21T20:54:03.700
> 
> 标签：python, testing, import, django-socialauth

我正在尝试从 django-social-auth 包中继承一些类来创建自定义测试。

来源[https://github.com/omab/django-social-auth](https://github.com/omab/django-social-auth)

问题是我无法导入“测试”部分：

```
C:\Users\Alle>python
Python 2.6.6 (r266:84297, Aug 24 2010, 18:46:32) [MSC v.1500 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> import social_auth.tests.base
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named tests.base
>>> import social_auth.tests
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named tests
>>> import social_auth.db
>>> social_auth.db
<module 'social_auth.db' from 'C:\Python26\lib\site-packages\social_auth\db\__init__.pyc'>
>>> 
```

为什么我会得到这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:00:49.003

默认情况下不安装测试

来自social_auth[`setup.py`](https://github.com/omab/django-social-auth/blob/master/setup.py)

```
 packages=['social_auth',
            'social_auth.management',
            'social_auth.management.commands',
            'social_auth.backends',
            'social_auth.backends.contrib',
            'social_auth.backends.pipeline',
            'social_auth.migrations',
            'social_auth.db'], 
```

# mysql - MySQL IF 以数字开头做 X，否则做 Y

> ID：14447048
> 
> 赞同：0
> 
> 时间：2013-01-21T20:54:30.387
> 
> 标签：mysql

> **可能重复：**
> [MySQL - 如果它以数字或特殊字符](https://stackoverflow.com/questions/1214035/mysql-if-it-starts-with-a-number-or-special-character)
> [开头 选择以数字开头的值](https://stackoverflow.com/questions/4511945/select-values-that-begin-with-a-number)

我正在尝试创建一个 ORDER BY 语句来检查列是否以数字开头，如果是，则应将 + 0 添加到列中。如果没有，它不会。

像这样的东西`IF(title begins with number, title + 0, title)`

不知道该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:59:45.173

```
ORDER BY IF(title REGEXP '^[0-9]',title+0,title) 
```

但是，该表达式将返回一个数值；并且由于“title+0”本质上等于“title”（就数值比较而言），我认为这不会达到你想要的效果。

（“+0”操作会将零添加到字符串值的前导数字部分，并返回一个数值；因此整个表达式将被评估为一个数值。这意味着裸露的“标题”也将是数值，如果没有前导数值，则返回 0。

因此，这基本上等同于：

```
ORDER BY title+0 
```

您实际上希望按什么顺序返回标题值？您是否希望按前导数字的顺序返回行，然后按标题字符串？

我想您想按`title`没有前导数字时的字符串值进行排序；否则，通过前导数字的数值，然后是标题的字符串值，所以这样的事情可能会让你更接近你想要的：

```
ORDER BY title REGEXP '^[0-9]', title+0, title 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T20:59:30.130

您可以强制将标题解释为整数并测试它是否 >= 1：

```
ORDER BY IF(title+0 >= 1, title+0, title) 
```

但我必须评论说，听起来您将一列用于两个不同的目的，这在关系数据库设计中是一个禁忌。

而且它会很慢，因为 ORDER BY 不能从索引中受益。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T20:58:19.403

```
if title LIKE 'number%' then
    CONCAT(title, '0');
end if; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T20:59:50.027

```
if (left(title,1) regexp '[0-9]', title+0, title) 
```

或者

```
if (title regexp '^[0-9]', title+0, title) 
```

# c++ - 每次调用析构函数时出错

> ID：14447049
> 
> 赞同：0
> 
> 时间：2013-01-21T20:54:33.487
> 
> 标签：c++, visual-c++

每次调用析构函数时，我都会收到一条奇怪的消息。由于我的私有变量之一是动态分配的数组（`int *member;`），我这样写析构函数：

```
ClassSet::~ClassSet(){delete []member;} 
```

每次`ClassSet`调用析构函数时，我都会收到一条错误消息：

> Windows 已在 Hw1.exe 中触发断点。
> 
> 这可能是由于堆损坏，这表明 Hw1.exe 或其已加载的任何 DLL 中存在错误。
> 
> 这也可能是由于用户在 Hw1.exe 具有焦点时按 F12。

全班：

```
class ClassSet
{
  public:
    ClassSet(int n = DEFAULT_MAX_ITEMS);
ClassSet(const ClassSet& other);
ClassSet &operator=(const ClassSet& other);
~ClassSet();
  private:
    int size;
int *member;
 };

ClassSet::ClassSet(int n){
   size = n;
   member = new int[n];
}

ClassSet::ClassSet(const ClassSet& other){
    int i = 0;
    this->size = other.size;
member = new int [capacity];
while (i<size)
{
    this->member[i] = other.member[i];
    i++;
}
 }

 Multiset& Multiset::operator=(const Multiset &other)
 {
    if (&other == this){return *this;}
this->size = other.size;
int i = 0;
    delete [] member;
    member = new int[size];
while (i<other.size)
{
    this->member[i] = other.member[i];
    i++;
}
return *this;
} 
```

知道这个析构函数有什么问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T20:57:46.823

您未能实施（或实施不正确）`ClassSet::ClassSet(const ClassSet&)`或之一`ClassSet::operator=(const ClassSet&)`。

换句话说，你违反了[三法则](http://en.wikipedia.org/wiki/Rule_of_three_%28C%2B%2B_programming%29)。

然而，最好的解决方案可能**不是**实现它们，而是改变您为动态数组分配空间的方式。不要使用`new[]`and `delete[]`，而是尝试用 . 替换该成员`std::vector<>`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T20:58:21.240

堆损坏通常是事后检测到的。它可能与您的析构函数有关，或者正如我所见，可能在堆访问发生错误之前发生。

基本上“检测到堆损坏”仅仅意味着在给定的堆访问时，Windows 确定堆的当前状态不一致/无效。前一阵子出了点事。

这些错误很难追踪。堆损坏的一个常见原因是**双重删除**，您无意中删除了两次。这可能指向更深层次的问题，即数据如何围绕代码和设计进行复制。

正如其他人所说，当您没有复制动态内存的适当复制构造函数/赋值运算符时，可能会发生这种情况。“复制”会删除您的记忆，然后再次删除初始类，从而导致双重删除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T22:34:28.277

如果您发布了实际代码，那么我认为问题出在：

```
ClassSet::ClassSet(const ClassSet& other){
    int i = 0;
    this->size = other.size;
    member = new int [capacity];  // <--- what is capacity?
    while (i<size)
    {
        this->member[i] = other.member[i];
        i++;
    }
} 
```

您正在根据`capacity`与`other.size`. 如果`capacity`小于`size`复制元素的循环将破坏堆。

假设这是一个学术练习，一旦你解决了这个问题，你应该研究用于此类类的[复制/交换习语，以确保异常安全。](https://stackoverflow.com/questions/3279543/what-is-the-copy-and-swap-idiom)

如果这不是学术练习，那么您应该查看`std::vector`图书馆提供的其他容器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T21:53:00.487

这个问题很常见。默认的复制构造函数等价于

```
ClassSet(const ClassSet& other) {
    size = other.size;
    member = other.member;
} 
```

这样做的问题是，当一个实例`ClassSet`被复制时，原始实例和新实例都持有一个指向`member`. 两个析构函数都会释放`member`，导致您看到的双重释放问题。

例如，

```
{
    ClassSet a
    ClassSet b(a); // assert(b.member == a.member)
} // At this point, both a and b will free the same pointer. 
```

您可以通过不允许复制或移动指针而不是复制来缓解这种情况。

# haskell - 如何为第三类型构造函数（ext3）的类型扩展定义 SYB 函数？

> ID：14447050
> 
> 赞同：5
> 
> 时间：2013-01-21T20:54:51.030
> 
> 标签：haskell, generic-programming, scrap-your-boilerplate

在[Scrap Your Boilerplate 包](http://hackage.haskell.org/package/syb-0.3.7)中[`Data.Generics.Aliases`](http://hackage.haskell.org/packages/archive/syb/0.3.7/doc/html/Data-Generics-Aliases.html)，有一些函数允许对一元和二元类型构造函数进行类型扩展。[`ext1`](http://hackage.haskell.org/packages/archive/syb/0.3.7/doc/html/Data-Generics-Aliases.html#v%3aext1R)特别是和有定义[`ext2`](http://hackage.haskell.org/packages/archive/syb/0.3.7/doc/html/Data-Generics-Aliases.html#v%3aext2R)。

现在，`ext1`和是根据， 和`ext2`定义的，它们是类型类的一部分，通常由机器定义。但是，没有，所以我看不到一个简单的方法来定义。[`dataCast1`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Data.html#v%3adataCast1)[`dataCast2`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Data.html#v%3adataCast1)[`Data`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Data.html#t%3aData)`DeriveDataTypeable``dataCast3``ext3`

是否可以定义`ext3`，如果可以，如何定义？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T19:53:58.263

我很确定这还不够。但感觉离得很近。

```
ext3 :: (Data a, Typeable3 t)
     => c a
     -> (forall d1 d2 d3\. c (t d1 d2 d3))
     -> c a
ext3 def ext = maybe def (id) (gcast3' ext)

gcast3' :: (Typeable3 t, Data a) => c (t f g h) -> Maybe (c a)
gcast3' x = r
 where
  r = if typeOf3 (getArg x) == typeOf3' (getArg (fromJust r))
       then Just $ unsafeCoerce x
       else Nothing
  getArg :: c x -> x
  getArg = undefined
  typeOf3' z = mkTyConApp (typeRepTyCon (typeOf z)) [] 
```

# ruby - "R".match(%r[^R]) 找到匹配项？

> ID：14447051
> 
> 赞同：2
> 
> 时间：2013-01-21T20:54:52.137
> 
> 标签：ruby

`"R".match(%r[^R])`找到匹配项。

我对正则表达式了解不多，但我认为`^`在`[`否定字符类之后，括号之间的字符。

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T20:57:57.840

在您的情况下，括号不是正则表达式的一部分，您的情况类似于`%r|^R|`or或在 您想要的之前和之后`%r'^R'`放置任何字符是or`%``R`
`%r|[^R]|``/[^R]/`

# sql - 查询上传到 SQL Server 中单列的 XML 文件

> ID：14447052
> 
> 赞同：1
> 
> 时间：2013-01-21T20:55:02.790
> 
> 标签：sql, sql-server, sql-server-2008, tsql, xquery

我正在尝试在 SQL Server 中学习 XQuery 和 Xpath

我创建了一个示例文件并将其上传到具有 2 列 ID、XMLDoc 的表中。以下代码位于 XMLDoc 列中的文档中，因此它是该列中的唯一记录。

我正在尝试查询该文件，以便它像普通的 select 语句一样在表中显示所有结果。您将如何构造 select 语句来选择像 select * 这样的所有信息？您将如何像所有供应商一样选择一个领域？我想为每个项目选择供应商、请求者。

这是xml：

```
 <tst:Document xmlns:tst ="http://www.w3.org/2001/XMLSchema" SchemaVersion="0.1" Classification="Test" UniqueIdentifier="1234" Title="Test">
  <tst:Revision RevNumber="0" TimeStamp="2013-01-21T12:56:00">
    <tst:Author Name="Me" Guid="1234" />
  </tst:Revision>
  <tst:Formats>
    <tst:A12 Item="1">
      <tst:Requestor Name="ADC" />
      <tst:Supplier Name="BBC" />
      <tst:Code>B</tst:Code>
      <tst:IsRequirement>true</tst:IsRequirement>
      <tst:IsNotRequired>false</tst:IsInformation>
      <tst:Remarks>ADC (Random Input Section)</tst:Remarks>
      <tst:Notes>Next Round.</tst:Notes>
      <tst:Events>
        <tst:SubTest Item="0">
          <tst:BLDG>BLDG1</tst:BLDG>
          <tst:BLDG2>BLDG2</tst:BLDG2>
          <tst:Function>Testing</tst:Function>
          <tst:Desciption>Normal Flow</tst:Desciption>
        </tst:SubTest>
      </tst:Events>
      <tst:IsReady>true</tst:IsReady>
      <tst:IsNotReady>false</tst:IsNotReady>
    </tst:A12>
    <tst:A12 Item="2">
      <tst:Requestor Name="ADC" />
      <tst:Supplier Name="BBC" />
      <tst:Code>A</tst:Code>
      <tst:IsRequirement>true</tst:IsRequirement>
      <tst:IsInformation>false</tst:IsInformation>
      <tst:Remarks>Requirement Not yet met.</tst:Remarks>
      <tst:Notes>Ready.</tst:Notes>
      <tst:Events>
        <tst:SubTest Item="0">
          <tst:BLDG>BLDG3</tst:BLDG>
          <tst:BLDG2>BLDG4</tst:BLDG2>
          <tst:TotalEvents>1</tst:TotalEvents>
          <tst:Function>Development</tst:Function>
          <tst:Desciption>Process Flow</tst:Desciption>
        </tst:SubTest>
      </tst:Events>
      <tst:IsReady>true</tst:IsReady>
      <tst:IsNotReady>false</tst:IsNotReady>
    </tst:A12>
  </tst:Formats>
</tst:Document> 
```

我跑的查询

我刚得到一个回报，但它仍然以 xml 形式显示：

```
Select XMLDoc.query('/*/*/*/*[local-name()=("Requestor", "Supplier")]')
       From XMLLoad 
```

我更新了 xml 片段，sry 有一个错字！现在将加载

```
INSERT INTO TableName(ColumnName)
SELECT * FROM OPENROWSET(
BULK 'C:\Users\Filepath.xml',
SINGLE_BLOB) AS x; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T07:40:15.220

[SQL小提琴](http://sqlfiddle.com/#!3/580f1/1)

**MS SQL Server 2008 架构设置**：

```
create table XMLDoc (XMLLoad xml);

insert into XMLDoc(XMLLoad) values('
     <tst:Document xmlns:tst ="http://www.w3.org/2001/XMLSchema" SchemaVersion="0.1" Classification="Test" UniqueIdentifier="1234" Title="Test">
  <tst:Revision RevNumber="0" TimeStamp="2013-01-21T12:56:00">
    <tst:Author Name="Me" Guid="1234" />
  </tst:Revision>
  <tst:Formats>
    <tst:A12 Item="1">
      <tst:Requestor Name="ADC" />
      <tst:Supplier Name="BBC" />
      <tst:Code>B</tst:Code>
      <tst:IsRequirement>true</tst:IsRequirement>
      <tst:IsInformation>false</tst:IsInformation>
      <tst:Remarks>ADC (Random Input Section)</tst:Remarks>
      <tst:Notes>Next Round.</tst:Notes>
      <tst:Events>
        <tst:SubTest Item="0">
          <tst:BLDG>BLDG1</tst:BLDG>
          <tst:BLDG2>BLDG2</tst:BLDG2>
          <tst:Function>Testing</tst:Function>
          <tst:Desciption>Normal Flow</tst:Desciption>
        </tst:SubTest>
      </tst:Events>
      <tst:IsReady>true</tst:IsReady>
      <tst:IsNotReady>false</tst:IsNotReady>
    </tst:A12>
    <tst:A12 Item="2">
      <tst:Requestor Name="ADC" />
      <tst:Supplier Name="BBC" />
      <tst:Code>A</tst:Code>
      <tst:IsRequirement>true</tst:IsRequirement>
      <tst:IsInformation>false</tst:IsInformation>
      <tst:Remarks>Requirement Not yet met.</tst:Remarks>
      <tst:Notes>Ready.</tst:Notes>
      <tst:Events>
        <tst:SubTest Item="0">
          <tst:BLDG>BLDG3</tst:BLDG>
          <tst:BLDG2>BLDG4</tst:BLDG2>
          <tst:TotalEvents>1</tst:TotalEvents>
          <tst:Function>Development</tst:Function>
          <tst:Desciption>Process Flow</tst:Desciption>
        </tst:SubTest>
      </tst:Events>
      <tst:IsReady>true</tst:IsReady>
      <tst:IsNotReady>false</tst:IsNotReady>
    </tst:A12>
  </tst:Formats>
</tst:Document>'); 
```

**查询 1**：

```
with xmlnamespaces('http://www.w3.org/2001/XMLSchema' as tst)
select A12.X.value('@Item', 'int') as A12,
       A12.X.value('tst:Requestor[1]/@Name', 'varchar(25)')        as Requestor,
       A12.X.value('tst:Supplier[1]/@Name', 'varchar(25)')         as Supplier,
       A12.X.value('(tst:Code/text())[1]', 'varchar(25)')          as Code,
       A12.X.value('(tst:IsRequirement/text())[1]', 'bit')         as IsRequirement,
       A12.X.value('(tst:IsInformation/text())[1]', 'bit')         as IsInformation,
       A12.X.value('(tst:Remarks/text())[1]', 'varchar(50)')       as Remarks,
       A12.X.value('(tst:Notes/text())[1]', 'varchar(50)')         as Notes,
       ST.X.value('@Item', 'int')                                  as SubTest,
       ST.X.value('(tst:BLDG/text())[1]', 'varchar(25)')           as BLDG,
       ST.X.value('(tst:BLDG2/text())[1]', 'varchar(25)')          as BLDG2,
       ST.X.value('(tst:TotalEvents/text())[1]', 'int')            as TotalEvents,
       ST.X.value('(tst:Function/text())[1]', 'varchar(25)')       as [Function],
       ST.X.value('(tst:Desciption/text())[1]', 'varchar(50)')     as Desciption
from XMLDoc as X
  cross apply X.XMLLoad.nodes('/tst:Document/tst:Formats/tst:A12') as A12(X)
  cross apply A12.X.nodes('tst:Events/tst:SubTest')                as ST(X) 
```

**[结果](http://sqlfiddle.com/#!3/580f1/1/0)**：

```
| A12 | REQUESTOR | SUPPLIER | CODE | ISREQUIREMENT | ISINFORMATION |                    REMARKS |       NOTES | SUBTEST |  BLDG | BLDG2 | TOTALEVENTS |    FUNCTION |   DESCIPTION |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|   1 |       ADC |      BBC |    B |             1 |             0 | ADC (Random Input Section) | Next Round. |       0 | BLDG1 | BLDG2 |      (null) |     Testing |  Normal Flow |
|   2 |       ADC |      BBC |    A |             1 |             0 |   Requirement Not yet met. |      Ready. |       0 | BLDG3 | BLDG4 |           1 | Development | Process Flow | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:58:20.853

查看[value()](http://msdn.microsoft.com/en-us/library/ms178030.aspx)和[nodes()](http://msdn.microsoft.com/en-us/library/ms188282.aspx)。

# javascript - 如何处理节点上phonegap的req？

> ID：14447054
> 
> 赞同：1
> 
> 时间：2013-01-21T20:55:11.117
> 
> 标签：javascript, node.js, cordova

我在 Cordova-2.2.0 上构建了这个 Android 应用程序，我在服务器端使用节点。有一部分需要将图像从相机或文件发送到服务器。图片已成功上传到服务器，但保存时似乎已损坏。如果我在记事本上打开图像，文件上有这个“额外的标题”。除此之外，所有文件都是一样的。这是我在客户端上的代码：

```
function getPhoto() {

        navigator.camera.getPicture(uploadPhoto,
                                    function(message) { alert('No image selected');},
                                    { quality: 50, 
                                    destinationType: navigator.camera.DestinationType.FILE_URI,
                                    sourceType: navigator.camera.PictureSourceType.PHOTOLIBRARY }
                                    );

    }

function uploadPhoto(imageURI) {
        var largeImage = document.getElementById('Image');
        largeImage.style.display = 'block';
        largeImage.src = imageURI;
        var options = new FileUploadOptions();
        options.fileKey="file";
        options.fileName=imageURI.substr(imageURI.lastIndexOf('/')+1);
        options.mimeType="image/jpg";

        options.chunkedMode = false;

        var ft = new FileTransfer();
        ft.upload(imageURI, "http://10.8.13.92:8082", win, fail, options);
    } 
```

这是服务器上的代码：

```
http.createServer(function (req,res){
var fs = require('fs');
var imagen = fs.createWriteStream("imagen.jpg",{'flags':'a'});

req.addListener('response',function(response){

})
});

req.addListener('data',function(chunk){
    imagen.write(chunk,encoding='binary');
});

req.on('end',function(){
    imagen.end();

    console.log('File written');
});

}).listen(8082); 
```

我知道问题出在服务器上，但我找不到任何与此不同的东西来编写 .jpg 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T00:33:18.903

**从文档：**

> FileTransfer 对象提供了一种使用 HTTP 多部分 POST 请求将文件上传到远程服务器的方法。

您正在尝试将所有请求数据写入图像文件，但请求数据不仅仅是二进制图像数据。它包含 HTTP 多部分格式的文件，需要在写入文件之前进行解析。

最简单的方法 - 使用[connect](https://github.com/senchalabs/connect)和 bodyParser 中间件。

示例应用程序：

```
var http = require('http');
var connect = require('connect');

var app = connect();
var server = http.createServer(app);
app.use(connect.bodyParser());
app.use(function(req, res) {
    console.log(req.files); // Here is object with uploaded files
});

server.listen(8082); 
```

您可以在对象中找到上传文件的路径`req.files`并将其移动到所需的目的地。

# css - 在 Wordpress 中为基础添加排水沟

> ID：14447062
> 
> 赞同：0
> 
> 时间：2013-01-21T20:55:36.973
> 
> 标签：css, zurb-foundation

我开始从在 Foundation 3 代码上运行的 Reverie 的基础上设计一个 Wordpress 主题。我以前创建过主题，但我试图了解网格方法，特别是如何最好地实现排水沟。

问题：

在此处查看我的测试站点[http://diskbacker.com/](http://diskbacker.com/)

我有带有背景颜色的内容 div 和侧边栏 div 来显示问题。默认情况下，它们会相互接触。

1.  如何在内容 div 和侧边栏 div 之间添加分隔符？

2.  如何向内容和侧边栏添加内部填充？

3.  当我要“响应”时，这种分离会导致移动设备出现问题吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T14:48:11.060

如果您在列内放置另一个 div 作品...

```
<div class="four columns">
<div style="margin:25px; background: #ccc;">test</div></div>
<div class="eight columns">eight</div> 
```

您还可以在基础中查找类 .panel 并适应您的特定需求：

```
.panel { background: #f2f2f2; border: solid 1px #e6e6e6; margin: 0 0 22px 0; padding: 20px; } 
.panel > :first-child { margin-top: 0; } 
.panel > :last-child { margin-bottom: 0; } 
```

或者 - 使用基础 v2

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T09:26:49.777

我建议首先阅读 ZURB Foundation 文档，其中解释了网格的用法：

[http://foundation.zurb.com/docs/grid.php](http://foundation.zurb.com/docs/grid.php)

> 只需在列上填充填充即可创建排水沟。这意味着列具有简单的宽度，例如 25% 或 50%。调整 padding 可以调整装订线，这可以通过 Scss 变量、下载定制器或 CSS 本身来控制。

与任何 HTML/CSS 站点一样，您可以识别要修改的元素的选择器，并在自定义 CSS 样式表中识别该元素的填充，例如：

```
.sidebar {padding:14px;} 
```

希望有帮助。

# bash - awk 在匹配模式的第 n 次出现之间打印

> ID：14447064
> 
> 赞同：1
> 
> 时间：2013-01-21T20:55:41.140
> 
> 标签：bash, awk

我正在尝试在第 n 次出现 2 个模式之间提取数据。

模式一： `CardDetail`

模式二： `]`

输入文件`input.txt`有数千行，每行包含的内容各不相同。我关心从中获取数据的行将始终包含`CardDetail`在行中的某个位置。使用 查找匹配行很容易`awk`，但是在每个匹配项之间提取数据并将其放在单独的行上是我的不足之处。

`input.txt`包含有关网络设备和任何附加/子设备的数据。它看起来像这样：

```
DeviceDetail [baseProductId=router-5000, cardDetail=[CardDetail [baseCardId=router-5000NIC1, cardDescription=Router 5000 NIC, cardSerial=5000NIC1], CardDetail [baseCardId=router-5000NIC2, cardDescription=Router 5000 NIC, cardSerial=5000NIC2]], deviceSerial=5000PRIMARY, deviceDescription=Router 5000 Base Model]
DeviceDetail [baseProductId=router-100, cardDetail=[CardDetail [baseCardId=router-100NIC1, cardDescription=Router 100 NIC, cardSerial=100NIC1], CardDetail [baseCardId=router-100NIC2, cardDescription=Router 100 NIC, cardSerial=100NIC2]], deviceSerial=100PRIMARY, deviceDescription=Router 100 Base Model] 
```

*** 更新：我忘了在最初的帖子中提到我还需要`deviceSerial`列出设备的父序列号 ( )。***

我希望`output.txt`看起来像这样：

```
"router-5000NIC1","Router 5000 NIC","5000NIC1","5000PRIMARY"
"router-5000NIC2","Router 5000 NIC","5000NIC2","5000PRIMARY"
"router-100NIC1","Router 100 NIC","100NIC1","100PRIMARY"
"router-100NIC2","Router 100 NIC","100NIC2","100PRIMARY" 
```

`CardDetail`单行上出现的次数可能在 0 到数百之间变化，具体取决于设备。我需要能够在每次出现`CardDetail`和下一次出现之间按字段提取所有数据，`]`并将它们以 CSV 格式传输到自己的行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:58:23.357

如果您有 gawk 或 mawk 可用，您可以通过（错误）使用记录和字段拆分功能来做到这一点：

```
awk -v RS='CardDetail *\\[' -v FS='[=,]' -v OFS=',' -v q='"' '
  NR > 1 { sub("\\].*", ""); print q $2 q, q $4 q, q $6 q }' 
```

输出：

```
"router-5000NIC1","Router 5000 NIC","5000NIC1"
"router-5000NIC2","Router 5000 NIC","5000NIC2"
"router-100NIC1","Router 100 NIC","100NIC1"
"router-100NIC2","Router 100 NIC","100NIC2" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:02:07.497

够了吗？

```
$> grep -P -o "(?<=CardDetail).*?(?=\])" input.txt | grep -P -o "(?<=\=).*?(?=\,)"
router-5000NIC1
Router 5000 NIC
router-5000NIC2
Router 5000 NIC
router-100NIC1
Router 100 NIC
router-100NIC2
Router 100 NIC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T22:03:48.867

这是一个使用正则表达式的示例。如果文本格式有细微的变化，这将处理它们。这也收集了数组中的所有值；然后，如果您愿意，您可以进行进一步处理（对值进行排序、删除重复项等）。

```
#!/usr/bin/awk -f

BEGIN {
    i_result = 0
    DQUOTE = "\""
}

{
    line = $0
    for (;;)
    {
        i = match(line, /CardDetail \[ **([^]]*) *\]/, a)
        if (0 == i)
            break
        # a[1] has the text from the parentheses
        s = a[1]
        # replace from this: a, b, c   to this:  "a","b","c"
        gsub(/ *, */, "\",\"", s)
        s = DQUOTE s DQUOTE

        results[i_result++] = s
        line = substr(line, RSTART + RLENGTH - 1)
    }
}

END {
    for (i = 0; i < i_result; ++i)
        print results[i]
} 
```

PS 只是为了好玩，我制作了一个 Python 版本。

```
#!/usr/bin/python

import re
import sys

DQUOTE = "\""

pat_card = re.compile("CardDetail \[ *([^]]*) *\]")
pat_comma = re.compile(" *, *")

results = []

def collect_cards(line, results):
    while True:
        m = re.search(pat_card, line)
        if not m:
            return
        len_matched = len(m.group(0))
        s = m.group(1)
        s = DQUOTE + re.sub(pat_comma, '","', s) + DQUOTE
        results.append(s)
        line = line[len_matched:]

if __name__ == "__main__":
    for line in sys.stdin:
        collect_cards(line, results)

    for card in results:
        print card 
```

编辑：这是一个新版本，它还查找“deviceID”并将匹配的文本作为第一个字段。

在 AWK 中，您只需将字符串在表达式中彼此相邻放置即可连接；当两个字符串并排时，存在隐式连接运算符。因此，这会将 deviceID 文本放入一个名为 s0 的变量中，并使用连接在其周围加上双引号；然后稍后使用连接将 s0 放在匹配字符串的开头。

```
#!/usr/bin/awk -f

BEGIN {
    i_result = 0
    DQUOTE = "\""
    COMMA = ","
}

{
    line = $0
    for (;;)
    {
        i = match(line, /deviceID=([A-Za-z_0-9]*),/, a)
        s0 = DQUOTE a[1] DQUOTE
        i = match(line, /CardDetail \[ **([^]]*) *\]/, a)
        if (0 == i)
            break
        # a[1] has the text from the parentheses
        s = a[1]
        # replace from this: foo=a, bar=b, other=c   to this:  "a","b","c"
        gsub(/[A-Za-z_][^=,]*=/, "", s)
        # replace from this: a, b, c   to this:  "a","b","c"
        gsub(/ *, */, "\",\"", s)
        s = s0 COMMA DQUOTE s DQUOTE

        results[i_result++] = s
        line = substr(line, RSTART + RLENGTH - 1)
    }
}

END {
    for (i = 0; i < i_result; ++i)
        print results[i]
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-22T02:46:36.483

试试这个

```
 #awk -f myawk.sh temp.txt
 BEGIN { RS="CardDetail"; FS="[=,]"; OFS=","; print "Begin Processing "}
 $0 ~ /baseCardId/ {gsub("]","",$0);print $2, $4 , $6}
 END {print "Process Complete"} 
```

# html - 如何根据屏幕调整带有图像的div？

> ID：14447073
> 
> 赞同：1
> 
> 时间：2013-01-21T20:56:19.700
> 
> 标签：html, css, media-queries

我正在尝试在图像上使用“宝丽来”效果，但我希望在桌面屏幕上具有全尺寸（约 200 像素），但在移动设备上查看时使其缩放，例如 50%。

为了实现这一点，我想我必须使用@media 查询对吗？我从来没有使用过媒体查询，所以我需要一些帮助。如果没有，谁能指出我可以在没有javascript的情况下完成这项工作的方法？

我有以下代码：

HTML：

```
<section id="splash">
            <header>Celso Santos</header>
            <div class="container">
                <div id="polaroid">
                    <figure>
                        <img src="img/zedblade.jpg" alt="Celso Santos" />
                        <figcaption>Geek</figcaption>
                    </figure>
                </div>
            </div>
        </section> 
```

和CSS：

```
 /***Position the figures containing the images and captions***/
#polaroid figure {
    /*float: left;*/ /*places the images in a horizontal line*/
    position: relative; /*allows precise positioning of the tape in step 5- see support section below for more info*/
    width: 178px; /*width of the images*/
    /*margin: 0 auto; /*space between the images*/
}

#polaroid figure {
    padding: 6px 8px 10px 8px; /*size of the frame*/
    /*give the frame's background colour a gradient*/
    background: #eee6d8; /*fallback colour for browsers that don't support gradients*/
    background: -webkit-linear-gradient(top, #ede1c9, #fef8e2 20%, #f2ebde 60%);
    background: -moz-linear-gradient(top, #ede1c9, #fef8e2 20%, #f2ebde 60%);
    background: -o-linear-gradient(top, #ede1c9, #fef8e2 20%, #f2ebde 60%);
    background: -ms-linear-gradient(top, #ede1c9, #fef8e2 20%, #f2ebde 60%);
    background: linear-gradient(top, #ede1c9, #fef8e2 20%, #f2ebde 60%);
    /*give the Polaroids a small drop shadow*/
    -webkit-box-shadow: 4px 4px 8px -4px rgba(0, 0, 0, .75);
    -moz-box-shadow: 4px 4px 8px -4px rgba(0, 0, 0, .75);
    box-shadow: 4px 4px 8px -4px rgba(0, 0, 0, .75);
}

#polaroid figcaption {
    text-align: center;
    font-family: 'Reenie Beanie', cursive; /* Reenie Beanie is available through Google Webfonts */
    font-size:1.3em;
    color: #454f40;
    letter-spacing: 0.09em;
}

figure:before { /*see the support section below to more info on using the :before psuedo element*/
    content: '';
    display: block;
    position: absolute;
    left:5px; /*postion from the left side of the frame (positive value move the tape right, negative moves it left)*/
    top: -15px; /*position from the top of the frame (positive move it above the frame, negative below)*/
    width: 75px; /*width of the tape*/
    height: 25px; /*height of the tape*/
    background-color: rgba(222,220,198,0.7); /*colour of the tape, use rgba to make it slightly transparent*/
    /*rotate the tape 12 degrees anti-clockwise*/
    -webkit-transform: rotate(-12deg);
    -moz-transform: rotate(-12deg);
    -o-transform: rotate(-12deg);
    -ms-transform: rotate(-12deg);
}

/**The tape for the even numbered images needs to be rotated the opposite way, as the images are, and positioned on the other side of the frame, I've also changed the width slightly**/
figure:nth-child(even):before {
    left:150px;
    top: -15px;
    width: 55px;
    height: 25px;
    -webkit-transform: rotate(12deg);
    -moz-transform: rotate(12deg);
    -o-transform: rotate(12deg);
    -ms-transform: rotate(12deg);
} 
```

为简化起见，我添加了一个指向我的公共保管箱文件夹的链接，并带有“实时”预览：[https ://dl.dropbox.com/u/3543277/www/index.html](https://dl.dropbox.com/u/3543277/www/index.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:02:29.990

要使您的图像缩放，您应该将其 CSS 设置为：

```
img{
   max-width: 100%;
   height: auto;
} 
```

这将允许它根据其父容器进行伸缩

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:00:51.427

像这样创建元标记：[http ://www.seabreezecomputers.com/tips/mobile-css.htm](http://www.seabreezecomputers.com/tips/mobile-css.htm)

```
<link media="Screen" href="styles.css" type="text/css" rel="stylesheet" />
<link media="handheld, only screen and (max-width: 480px), only screen and (max-device-width: 480px)" href="mobile.css" type="text/css" rel="stylesheet" /> 
```

基于“每个人都问这个问题”，我将期待您的下一个关于如何为移动设备缩放页面的问题：[http ://www.onlywebpro.com/2011/08/30/viewport-meta-tag-for-mobile-设备/](http://www.onlywebpro.com/2011/08/30/viewport-meta-tag-for-mobile-devices/)

# python - Python 生成器对象和 .join

> ID：14447081
> 
> 赞同：16
> 
> 时间：2013-01-21T20:57:07.950
> 
> 标签：python, string, list, pointers, generator

只是关于 python 和 .join() 方法的一个基本问题：

```
file1 = open(f1,"r")
file2 = open(f2,"r")
file3 = open("results","w")

diff = difflib.Differ()
result = diff.compare(file1.read(),file2.read())
file3.write("".join(result)), 
```

上面的代码片段产生了一个很好的输出，以字符串格式存储在一个名为“results”的文件中，逐行显示了两个文件之间的差异。但是我注意到，如果我只打印“结果”***而不***使用 .join()，编译器会返回一条包含内存地址的消息。***在尝试不***使用 .join()将结果写入文件后，编译器通知我在 .join() 方法中只能使用字符串和字符缓冲区，而不是生成器对象。因此，根据我引用的所有证据，如果我错了，请纠正我：

1.  `result = diff.compare(file1.read(),file2.read())` <---- 结果是生成器对象？

2.  `result`是一个字符串列表，`result`它本身就是对第一个字符串的引用？

3.  `.join()`获取一个内存地址并指向第一个，然后遍历该结构中字符串的其余地址？

4.  生成器对象是返回指针的对象吗？

如果我的问题不清楚，我很抱歉，但我基本上是想问问蟒蛇老兵我的推论是否正确。我的问题不是关于可观察的结果，而是关于 python 的内部工作原理。我感谢您的所有帮助。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-01-21T20:59:04.890

`join`是一种字符串方法。该方法采用任何可迭代对象并对其进行迭代并将内容连接在一起。（内容必须是字符串，否则会引发异常。）

如果您尝试将生成器对象直接写入文件，您将只获取生成器对象本身，而不是其内容。 `join`“展开”生成器的内容。

你可以看到一个简单的、显式的生成器发生了什么：

```
def gen():
    yield 'A'
    yield 'B'
    yield 'C'

>>> g = gen()
>>> print g
<generator object gen at 0x0000000004BB9090>
>>> print ''.join(g)
ABC 
```

生成器一次分发一个内容。如果您尝试查看生成器本身，它不会释放任何东西，您只会将其视为“生成器对象”。要获取其内容，您需要遍历它们。您可以使用`for`循环、`next`函数或迭代事物（`str.join`其中包括）的任何其他各种函数/方法来执行此操作。

当您说结果“是字符串列表”时，您就接近了这个想法。生成器（或可迭代的）有点像“潜在列表”。它不是一次真正*地*成为所有内容的列表，而是让您一次剥离每个项目。

没有一个对象是“内存地址”。生成器对象的字符串表示形式（与许多其他对象一样）包括一个内存地址，因此如果您将其打印（如上）或将其写入文件，您将看到该地址。但这并不意味着对象“是”那个内存地址，并且地址本身并不是真正可用的。它只是一个方便的识别标签，因此如果您有多个对象，您可以将它们区分开来。

# compilation - 在 Ubuntu 上编译 wkhtmltopdf

> ID：14447082
> 
> 赞同：0
> 
> 时间：2013-01-21T20:57:12.243
> 
> 标签：compilation, wkhtmltopdf

我正在尝试`wkhtmltopdf`从最新的源代码编译。我在 Ubuntu 12.10 x64 服务器版上。

我使用了[这里](http://blog.tcs.de/install-wkhtmltopdf-on-ubuntu-server/)和[这里](http://code.google.com/p/wkhtmltopdf/wiki/compilation)的说明。

对于`wkhtmltopdf-qt`编译，正如作者所说，新的 Git 存储库位于`gitorious.org/~antialize/qt/antializes-qt.git`分支上`4.8.2`。所以，这也是我使用的。

一切都很顺利。（qt 和 wkhtmltopdf）的编译都成功完成。但我只能以 root 身份使用 wkhtmltopdf（使用 sudo）。当我以任何其他用户身份运行它时，出现以下错误。

```
error while loading shared libraries: libQtWebKit.so.4: cannot open shared object file: No such file or directory. 
```

我以 root 身份完成了所有编译，文件位于 root 用户的主目录 (/root) 中。我猜想wkhtmltopdf程序需要读取`wkqt`编译后的qt所在的目录（和`libQtWebKit.so.4`文件）。该目录也位于 root 用户的主目录中，因此阻止其他用户运行`wkhtmltopdf`.

所以，我决定从头开始。这一次，我把所有的源文件（`wkhtmltopdf-qt`和`wkhtmltopdf`）放在`/usr/wkhtmltopdf`. 但是在 qt 的编译过程中，编译器尝试访问`qmake`存在 qt 源的先前（旧）位置时出现错误（`/root/wkhtmltopdf-qt`）。

以下错误：

```
ln -s libQtDeclarative.so.4.8.2 libQtDeclarative.so
ln -s libQtDeclarative.so.4.8.2 libQtDeclarative.so.4
ln -s libQtDeclarative.so.4.8.2 libQtDeclarative.so.4.8
rm -f ../../lib/libQtDeclarative.so.4.8.2
rm -f ../../lib/libQtDeclarative.so
rm -f ../../lib/libQtDeclarative.so.4
rm -f ../../lib/libQtDeclarative.so.4.8
mv -f libQtDeclarative.so.4.8.2 libQtDeclarative.so libQtDeclarative.so.4 libQtDeclarative.so.4.8 ../../lib/
make[1]: Leaving directory `/usr/wkhtmltopdf/wkhtmltopdf-qt/src/declarative'
cd src/3rdparty/webkit/Source/ && make -f Makefile.WebKit 
make[1]: Entering directory `/usr/wkhtmltopdf/wkhtmltopdf-qt/src/3rdparty/webkit/Source'
/root/wkhtmltopdf-qt/bin/qmake -spec ../../../../mkspecs/linux-g++-64 -o Makefile.WebKit WebKit.pro
make[1]: /root/wkhtmltopdf-qt/bin/qmake: Command not found
make[1]: *** [Makefile.WebKit] Error 127
make[1]: Leaving directory `/usr/wkhtmltopdf/wkhtmltopdf-qt/src/3rdparty/webkit/Source'
make: *** [sub-webkit-make_default-ordered] Error 2 
```

当我从绝对新鲜的源代码开始时，我不明白这怎么可能。

有什么方法可以完全删除（卸载）以前安装的`wkhtmltopdf-qt`和`wkhtmltopdf`？

我会很感激一些帮助。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:16:46.497

Okay, I figured it out.

Apparently, the source code was not as fresh as I thought.

I was cleaning the untracked and modified files in the Git working copy of the QT source directory. Running `git status` showed no modified files. But what I missed was that there were a lot of *git-ignored* folders and files, which still had the info about the previous compilation. These files and folders were not showing up in `git status`.

So, I temporarily moved the `.gitignore` file outside the repo and ran `git clean -fd`. That cleaned out all unnecessary files. Then I moved the `.gitignore` file back. For safety, I also ran `git checkout -- .` to get the latest versions of all the files from HEAD.

Compilation worked after that.

# c# - 在实体框架中检查实体属性的唯一性

> ID：14447085
> 
> 赞同：0
> 
> 时间：2013-01-21T20:57:16.187
> 
> 标签：c#, entity-framework, entity-framework-4

在实体框架代码迁移中，我意识到可以将唯一索引添加到列中。但是当尝试插入重复值时，您会从基于包含在 UpdateException 中的 SQL 异常中的数据中返回错误消息。这对于向用户显示不是非​​常用户友好的。

最好查询数据库是否存在该值并显示用户朋友错误消息？

如果没有，是否有更直观的方法来进行唯一性检查并显示用户友好的错误消息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T16:28:02.650

UpdateException 的 InnerException(s) 中必须有[System.Data.SqlClient.SqlException](http://msdn.microsoft.com/en-us/library/686y883x.aspx)。SqlException 有一个解决异常原因的[Number 属性](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlexception.number.aspx)。SqlException 还提供有关其他属性的错误的更多详细信息。

# php - Ajax 返回 HTTP 响应 501：方法未实现

> ID：14447086
> 
> 赞同：0
> 
> 时间：2013-01-21T20:57:20.993
> 
> 标签：php, javascript, ajax, linux, apache

我正在请求一个回显一行的简单 php 文件；使用 AJAX，但我从 linux 上的 localhost 服务器收到 HTTP 501 响应。我的问题是，什么可能导致这种错误？

**JavaScript：**

```
var request = new XMLHttpRequest();

request.onreadystatechange = function () {
    //console.log(request.responseText);
    if (request.readyState == 4 && request.status == 200) {
        console.log(0);
    } else if (request.status == 501) {
        console.log(request.responseText);
    }
}
request.open('test.php', 'GET', true);
request.send(); 
```

*测试.php：*

```
<?php echo 'this is a test'; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T04:17:03.470

据了解，您无法检测到服务器之前的状态`readyState`。如果是`4`(so `DONE`) 则可以检查服务器状态。

所以你需要在检查`readyState`之前先检查`status`。

```
if (req.readyState === 4) {
    // 200 is not enough to detect successful requests
    // cos there are many success status codes
    if (req.status === 200) {
        // every thing ok
    } else {
        // something is wrong with server?
    }
} 
```

在这里查看 HTTP 状态代码：http: [//www.w3.org/Protocols/rfc2616/rfc2616-sec10.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)

也许这对你有用：[https ://github.com/qeremy/mii/blob/master/mii.ajax.js#L248](https://github.com/qeremy/mii/blob/master/mii.ajax.js#L248)

# performance - devexpress xtratreelist 性能不佳

> ID：14447088
> 
> 赞同：0
> 
> 时间：2013-01-21T20:57:33.610
> 
> 标签：performance, xtratreelist

我在表单上有一个简单的 xtratreelist，我有一个包含 846 行的简单 firebird 数据表。我从数据库中选择 5 列并填充树列表。

这是代码：

```
ConnectToDb(fbconn, CEGNEV)
    fbcommand.Connection = fbconn
    fbcommand.CommandText = "select szamlaszam, szamlanev, szamlacsop, szamlatip, szamlakat from szamlatukor order by szamlaszam"
    fbadapter.SelectCommand = fbcommand
    fbadapter.Fill(fbdataset)
    fbdataset.Tables(0).TableName = "szamlatukor"
    trlSzamlatukor.DataMember = "szamlatukor"
    trlSzamlatukor.DataSource = fbdataset
    trlSzamlatukor.ParentFieldName = "szamlaszam"
    trlSzamlatukor.PopulateColumns()
    fbconn.Close() 
```

填充树列表需要 18 秒！这很慢，非常慢。

我也添加了一个 xtragridcontrol 并用同一张表填充它。它发生在鼠标点击的时候。

树列表性能不佳的原因可能是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T19:56:47.633

尝试这个避免立即视觉更新的目的是什么？

```
trlSzamlatukor.BeginUpdate()
trlSzamlatukor.PopulateColumns()
trlSzamlatukor.EndUpdate() 
```

# android - Android - 设置 imageView Url 时出错

> ID：14447091
> 
> 赞同：0
> 
> 时间：2013-01-21T20:57:45.953
> 
> 标签：android, android-imageview

当我从 url 显示图像时，应用程序崩溃。我做错了什么？请帮我。谢谢！

我的布局

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/hello_world" />
    <ImageView
        android:id="@+id/imageview"
        android:layout_gravity="center"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:scaleType="center"
        />
</RelativeLayout> 
```

这是我的 MainActivity.java。

```
private String imageFileURL = "http://www.google.com/images/nav_logo114.png";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    ImageView myImageView = (ImageView)findViewById(R.id.imageview);
    try {
        URL url = new URL(imageFileURL);
        URLConnection conn = url.openConnection();

        HttpURLConnection httpConn = (HttpURLConnection)conn;
        httpConn.setRequestMethod("GET");
        httpConn.connect();

        if (httpConn.getResponseCode() == HttpURLConnection.HTTP_OK) {
            InputStream inputStream = httpConn.getInputStream();

            Bitmap bitmap = BitmapFactory.decodeStream(inputStream);
            inputStream.close();
            myImageView.setImageBitmap(bitmap);
        }
    } catch (MalformedURLException e1) {
        e1.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

在 AndroidManifest.xml 中，我添加

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

但是，它在运行和应用程序崩溃时仍然显示错误。

以下是Logcat

```
01-22 04:44:19.019: D/AndroidRuntime(4452): Shutting down VM
01-22 04:44:19.019: W/dalvikvm(4452): threadid=1: thread exiting with uncaught exception (group=0x40aba228)
01-22 04:44:19.029: E/AndroidRuntime(4452): FATAL EXCEPTION: main
01-22 04:44:19.029: E/AndroidRuntime(4452): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.test/com.test.MainActivity}: android.os.NetworkOnMainThreadException
01-22 04:44:19.029: E/AndroidRuntime(4452):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2194)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2229)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at android.app.ActivityThread.access$600(ActivityThread.java:139)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1261)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at android.os.Looper.loop(Looper.java:154)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at android.app.ActivityThread.main(ActivityThread.java:4945)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at java.lang.reflect.Method.invokeNative(Native Method)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at java.lang.reflect.Method.invoke(Method.java:511)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at dalvik.system.NativeStart.main(Native Method)
01-22 04:44:19.029: E/AndroidRuntime(4452): Caused by: android.os.NetworkOnMainThreadException
01-22 04:44:19.029: E/AndroidRuntime(4452):     at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1178)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at java.net.InetAddress.lookupHostByName(InetAddress.java:394)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at java.net.InetAddress.getAllByNameImpl(InetAddress.java:245)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at java.net.InetAddress.getAllByName(InetAddress.java:220)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at libcore.net.http.HttpConnection.<init>(HttpConnection.java:71)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at libcore.net.http.HttpConnection.<init>(HttpConnection.java:50)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at libcore.net.http.HttpConnection$Address.connect(HttpConnection.java:351)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at libcore.net.http.HttpConnectionPool.get(HttpConnectionPool.java:86)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at libcore.net.http.HttpConnection.connect(HttpConnection.java:128)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at libcore.net.http.HttpEngine.openSocketConnection(HttpEngine.java:308)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at libcore.net.http.HttpEngine.connect(HttpEngine.java:303)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at libcore.net.http.HttpEngine.sendSocketRequest(HttpEngine.java:282)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at libcore.net.http.HttpEngine.sendRequest(HttpEngine.java:232)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at libcore.net.http.HttpURLConnectionImpl.connect(HttpURLConnectionImpl.java:80)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at com.test.MainActivity.onCreate(MainActivity.java:77)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at android.app.Activity.performCreate(Activity.java:4531)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1071)
01-22 04:44:19.029: E/AndroidRuntime(4452):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2150)
01-22 04:44:19.029: E/AndroidRuntime(4452):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:01:13.297

您正在主 UI 线程上执行网络操作。如果您的目标 SDK 是 11 (Honeycomb) 或更高版本，则会抛出`NetworkOnMainThreadException`，因为此行为可能会阻塞 UI 并导致应用程序无响应。

您可以使用 an`AsyncTask`来解决这个问题，将数据加载到其`doInBackground(..)`.

# java - Java 监视器是否包含实例变量？

> ID：14447095
> 
> 赞同：21
> 
> 时间：2013-01-21T20:57:56.907
> 
> 标签：java, synchronized

Java中的监视器是否不限制对实例变量的访问，而仅限于声明为*同步*的方法或*同步*语句中的代码？

我创建了两个线程，`thread y`调用`sync()`方法，该方法声明为*同步*，而`thread r`调用`unsync()`未声明为同步的方法。两者都调用共享对象上的方法`s`。

`Thread r`能够修改对象的实例变量，`s`而该对象的*监视器*或*锁*仍由`thread y`.

是不是 Java 中的监视器不限制对实例变量的访问，而仅限于声明为*同步*的方法或*同步*语句中的代码？

```
public class Stuff {

    private int a = 10;

    public synchronized void sync() {
        long t1 = System.currentTimeMillis();
        System.out.println("Okay, I am in sync() method. "
                        + "I will be waiting for 10 seconds. Current Time = "
                        + System.currentTimeMillis());
        while (System.currentTimeMillis() - t1 < 10000);
        System.out.println("Okay, I have waited for 10 seconds. Current time is "
                        + System.currentTimeMillis()
                        + ". Now I will exit from sync() method, a = " + this.a);
    }

    public void unsync() {
        System.out.println("Alright, I am in unsync() method. The current time is "
                        + System.currentTimeMillis());
        this.a = this.a + 1;
        System.out.println(". The time of exit from unsync() method is "
                        + System.currentTimeMillis());

    }
}

class T1 extends Thread {

    Stuff s;

    public T1(Stuff s) {
        this.s = s;
    }

    public void run() {
        s.sync();
    }
}

class T2 extends Thread {

    Stuff s;

    public T2(Stuff s) {
        this.s = s;
    }

    public void run() {
        s.unsync();
    }
}

class Main {

    public static void main(String args[]) throws Exception {
        Stuff s = new Stuff();
        T1 y = new T1(s);
        T2 r = new T2(s);
        y.start();
        Thread.sleep(2000);
        r.start();
    }
} 
```

程序的输出如下：

> ```
>  
> 好的，我在 sync() 方法中。我将等待 10 秒。当前时间 = 1358801766310  
> 好吧，我在 unsync() 方法中。当前时间为1358801768343。退出unsync()方法的时间为1358801768343  
> 好的，我已经等了 10 秒。当前时间是 1358801776310。现在我将退出 sync() 方法，a = 11
> 
> ```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-21T21:02:09.843

是的。持有一个对象的监视器可以防止另一个线程执行另一个代码块或在同一个对象上同步。如果一个方法没有同步，任何线程都可以随时调用它，而不管另一个线程是否持有监视器。

如果至少有一个线程有可能修改此共享状态，则对共享状态的每次访问，即使是只读访问，都必须同步。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T21:01:48.677

> java中的监视器是否不限制对实例变量的访问，而仅限于声明为同步的方法或同步语句中的代码？

是的。

除其他外，同步块（或方法）是互斥的。这不会阻止用作锁的对象（监视器，我们称之为它`lock`）在这些块之外使用，在这种情况下不会执行同步。例如，一个线程可以读取或写入，而另一个线程位于监视器`lock`所在的同步块内。`lock`

如果要限制对变量的访问，则需要确保在持有锁时进行所有访问（任何锁，只要每次访问都相同）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-21T21:16:39.893

使方法同步有两个效果：

首先，同一对象上的同步方法的两次调用不可能交错。当一个线程正在为一个对象执行同步方法时，所有其他为同一对象调用同步方法的线程都会阻塞（暂停执行），直到第一个线程处理完该对象。

其次，当同步方法退出时，它会自动与任何后续对同一对象的同步方法调用建立起之前的关系。这保证了对象状态的更改对所有线程都是可见的。

（来源：[Java 教程](http://docs.oracle.com/javase/tutorial/essential/concurrency/syncmeth.html)）

# ios - 为什么从 MPMediaPicker (iOS) 返回 (null)

> ID：14447099
> 
> 赞同：2
> 
> 时间：2013-01-21T20:57:59.823
> 
> 标签：ios, objective-c

我正在编程让 iPhone 音乐库显示，用户选择一首歌曲，然后这首歌的标题反映在`UILabel`. 要是这么简单就好了！我已经尝试`MPMediaItem`进入一个`NSString`然后`UILabel`反映这一点，但我只是得到（null）返回！

```
- (IBAction)showMediaPicker:(id)sender {
    MPMediaPickerController *mediaPicker = [[MPMediaPickerController alloc] initWithMediaTypes: MPMediaTypeAny];

    mediaPicker.delegate = self;
    //mediaPicker.allowsPickingMultipleItems = YES;
    mediaPicker.prompt = @"Select Your Favourite Song!";

    [self presentModalViewController:mediaPicker animated:YES];
}

- (void) mediaPicker: (MPMediaPickerController *) mediaPicker didPickMediaItems: (MPMediaItem *) mediaItemCollection {

    NSString *titleString = [mediaItemCollection valueForProperty:MPMediaItemPropertyTitle];
    titleLabel.text = [NSString stringWithFormat:@"Title: %@",titleString];

    [self dismissModalViewControllerAnimated: YES];
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:04:52.523

您正在尝试获取 mediaItemCollection 的标题。您需要像这样获取单个歌曲的标题：

```
MPMediaItem *selectedSong = [mediaItemCollection items] objectAtIndex:0];
NSString *titleString = [selectedSong valueForProperty:MPMediaItemPropertyTitle]; 
```

顺便说一句，您的 MPMediaPickerControllerDelegate 的委托设置错误：

它应该是：

```
- (void)mediaPicker:(MPMediaPickerController *)mediaPicker didPickMediaItems:(MPMediaItemCollection *)mediaItemCollection 
```

- 你有 MPMediaItemCollection 作为一个 MPMediaItem

# javascript - 适用于 Web 的 Windows 8 样式列表视图

> ID：14447106
> 
> 赞同：0
> 
> 时间：2013-01-21T20:58:21.473
> 
> 标签：javascript, html, windows-8

我希望能够像在 Windows 8 Listview 中那样在寻找的网格中显示项目。这些项目将是正方形（瓷砖）。

我可以通过创建位于同一行的 div 来让它们像这样显示。

项目 1 项目 2 项目 3

第 4 项 第 5 项 第 6 项

但我希望他们像这样显示

项目 1 项目 3 项目 5

第 2 项 第 4 项 第 6 项

我想知道是否有人知道如何实现这一目标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:44:17.470

我在这里有一个演示[JsBIN](http://jsbin.com/akakad/2/edit)

通过这个演示，我们在 javascript中设置每个项目的`width`and和在 CSS 中设置列​​表的or 。`height``li``height``max-height`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T15:27:40.283

IE10 引擎与 Windows 8 使用的引擎相同，但在 Windows 8 应用程序中使用的 ListView 控件是在 WinJS 框架之外不可用的自定义控件。该引擎确实实现了[CSS flexbox 标准](http://www.w3.org/TR/css3-flexbox/)并[在此处](http://msdn.microsoft.com/en-us/library/windows/apps/hh453474.aspx)详细说明。对 flexbox 的跨浏览器支持非常好（参见[此处](http://caniuse.com/#search=flexbox)）。flexbox 包括垂直排列元素和换行的能力。这两件事的结合将实现您正在寻找的东西。像这样的东西（我会省掉你所有的供应商前缀，只使用 -ms 版本）：

```
<!-- HTML snippet -->
<div class="parent">
  <div>item 1</div>
  <div>item 2</div>
  <div>item 3</div>
  <div>item 4</div>
  <div>item 5</div>
  <div>item 6</div>
</div>

/* CSS snippet */
.parent {
  display: -ms-flexbox;
  -ms-flex-wrap: wrap;
  -ms-flex-direction: column;
  height: 300px; /* adjust to create the two rows you're looking for */
}

.parent > div {
  /* you may want to set some flex properties on the children here */
} 
```

# asp.net - mvc，net中的多条路由

> ID：14447107
> 
> 赞同：1
> 
> 时间：2013-01-21T20:58:22.003
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4, routes

我的 mvc 应用程序中有多个路由。我想知道应用程序中的多个路由对性能不利吗？

```
routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
            routes.MapRoute(
                "Faq",
                "Faq/{action}",
                new { controller = "Faq", action = "Index" }
                );
            routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
            routes.MapRoute(
                "PostArchive",
                "Post/{action}",
                new { controller = "Post", action = "PostArchive" }
                );
            routes.MapRoute(
                "LogOn",
                "Account/{action}",
                new { controller = "Account", action = "LogOn" }
                );
            routes.MapRoute(
                "Localization",
                "{lang}/{controller}/{action}/{id}",
                new { controller = "Home", action = "Index", id = UrlParameter.Optional, lang = UrlParameter.Optional } // Parameter defaults
                );

            routes.MapRoute(
                name: "Default",
                url: "{controller}/{action}/{id}/{Name}",
                defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional, name = UrlParameter.Optional },
                namespaces: new[] { "MVCTemplateProject.Controllers" }
                );

            routes.MapRoute(
                name: "Post",
                url: "{lang}/{controller}/{action}/{id}/{Title}",
                defaults: new { controller = "Post", action = "Index", id = UrlParameter.Optional, Title = UrlParameter.Optional },
                namespaces: new[] { "MVCTemplateProject.Controllers" }
                ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:53:10.860

[Sam Saffron 写了一篇](http://samsaffron.com/archive/2011/10/13/optimising-asp-net-mvc3-routing)关于路由性能的有趣博客文章 - 特别是使用正则表达式约束的路由以及路由的排序。绝对值得一读，特别是如果您考虑到他通过那些相对简单的实现技术实现的性能改进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:02:46.093

不，路线检查快速有效。

大多数站点几乎没有或只有一条路线。

其他站点有 30 多条路线。根据我的经验，拥有 30 条不同路线的站点在性能上没有明显的滞后。

# ios - 将值传递给xcode中的按钮

> ID：14447110
> 
> 赞同：0
> 
> 时间：2013-01-21T20:58:37.663
> 
> 标签：ios, objective-c

我正在查看是否有办法将变量传递给 xcode 中的按钮。我有一个从存储到 NSString 的 API 中检索的 Web 链接。我只是想知道是否有办法将其传递给按钮，以便在单击它时可以相应地跟随链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:05:42.657

您将该 URL 存储在某个 ivar 或属性中。你像往常一样为你的按钮分配一个动作。该操作无非是您的视图控制器的一种方法。在该方法中，您执行该链接。

这是您可以“关注”您的链接的方式：

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"http://www.klecker.de"]]; 
```

在您的情况下，您将使用 NSString 变量而不是我在此示例中使用的常量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:23:56.977

您可以将 UIBUtton 子类化并添加您喜欢/需要的任何属性/变量。根据您的描述，我会使用 NSURL 而不是 NSString ...

创建一个新的 UIButton 子类，在您的 .h 文件中写入：

```
#import <UIKit/UIKit.h>
@interface MyButton : UIButton
{
     NSURL* buttonUrl;
}
@property (nonatomic, retain) NSURL* buttonUrl;
@end 
```

并在 .m 文件中简单地：

```
#import "MyButton.h"
@implementation MyButton
@synthesize buttonUrl;
@end 
```

然后在您的 ViewController 中：（不要忘记 #import "MyButton.h)

```
MyButton *theButton = [[MyButton alloc] initWithFrame:someframe];
[theButton addTarget:self action:@selector(buttonPushed:) forControlEvents:UIControlEventTouchUpInside];
theButton.buttonUrl = [NSURL URLWithString:apiString];
[self.view addSubView:theButton];
[theButton release]; 
```

...然后您可以在按下按钮时再次获取 URL：

```
-(void)buttonPushed:(id)sender{
    NSURL* theUrl = [(MyButton*)sender getButtonUrl];
} 
```

# java - 将 32 位整数的半字节设置为某个值

> ID：14447116
> 
> 赞同：3
> 
> 时间：2013-01-21T20:58:49.507
> 
> 标签：java, bit-manipulation, nibble

我被困在如何将 4 位值替换为原始 32 位整数的某个位置。非常感谢所有帮助！

```
/**
 * Set a 4-bit nibble in an int.
 * 
 * Ints are made of eight bytes, numbered like so:
 *   7777 6666 5555 4444 3333 2222 1111 0000
 *
 * For a graphical representation of this:
 *   1 1 1 1 1 1                 
 *   5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 
 *  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 *  |Nibble3|Nibble2|Nibble1|Nibble0|
 *  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 * 
 * Examples:
 *     setNibble(0xAAA5, 0x1, 0); // => 0xAAA1
 *     setNibble(0x56B2, 0xF, 3); // => 0xF6B2
 * 
 * @param num The int that will be modified.
 * @param nibble The nibble to insert into the integer.
 * @param which Selects which nibble to modify - 0 for least-significant nibble.
 *            
 * @return The modified int.
 */
public static int setNibble(int num, int nibble, int which)
{
           int shifted = (nibble << (which<<2));
       int temp = (num & shifted);
           //this is the part I am stuck on, how can  I replace the original
           // which location with the nibble that I want? Thank you!
       return temp;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:05:45.530

```
public static int setNibble(int num, int nibble, int which) {
    return num & ~(0xF << (which * 4)) | (nibble << (which * 4));
} 
```

这里：

*   `& ~(0xF << (which * 4))`屏蔽掉半字节的原始值；
*   将`| (nibble << (which * 4))`其设置为新值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:06:02.940

```
nibble &= 0xF; // Make sure
which &= 0x3;
int shifts = 4 * which; // 4 bits
num &= ~(0xF << shifts);
num |= nibble << shifts;
return num; 
```

# sql - 根据用户设置将 SQL 日期转换为 NSDate

> ID：14447118
> 
> 赞同：0
> 
> 时间：2013-01-21T20:59:01.630
> 
> 标签：sql, nsdate, nsdateformatter

我需要将 SQL 日期（来自 SQLite 请求）转换为 NSDate。

我有一个类别：

```
- (NSDate*)dateWithSQLString
{  
  if (sqlDateFormatter == nil) 
  {    
    [NSDateFormatter setDefaultFormatterBehavior:NSDateFormatterBehavior10_4];
    sqlDateFormatter = [[NSDateFormatter alloc] init];
    [sqlDateFormatter setDateFormat:@"yyyy-MM-dd HH:mm:ss"];
    [sqlDateFormatter setTimeZone:[NSTimeZone timeZoneForSecondsFromGMT:0]];
  }
  return [sqlDateFormatter dateFromString:self];
} 
```

如果用户设置是 24 小时，这很有效，但它不适用于 iPhone 上的上午/下午设置。

用户设置为 AM/PM（其他国际设置为法语）的简单测试：

```
 FMResultSet *dbRows = [self.database executeQuery:@"SELECT pulled_at FROM countries WHERE id = '1'"];
  [dbRows next];
  NSString *pulled_at = [dbRows stringForColumn:@"pulled_at"];
  NSLog(@"SQL String : %@", pulled_at);
  NSDate *sqlDate = [pulled_at dateWithSQLString];
  NSLog(@"SQL Date : %@", sqlDate); 
```

> [2906:907] SQL 字符串：2012-01-01 00:00:00
> 
> [2906:907] SQL 日期：（空）

对于设置为 24H 的 iPhone，同样的测试是可以的。

有什么想法可以解决此问题吗？

# objective-c - 仅在“源列表”中的某些项目上的上下文菜单

> ID：14447120
> 
> 赞同：6
> 
> 时间：2013-01-21T20:59:06.167
> 
> 标签：objective-c, cocoa, contextmenu, nsoutlineview, nsmenu

我有一个带有源列表（NSOutlineView）的窗口。我的源列表只有两个级别。一级是标题，二级是数据。我想在某些数据单元格上有一个上下文菜单。不是全部。

首先，我尝试在代表数据单元格的表格单元格视图上附加一个菜单-> 没有任何反应。

其次，我在 IB 的大纲视图上附加了一个菜单 -> 在每个单元格（标题和数据）上打开上下文菜单。我搜索停止打开菜单，但我什么也没找到。

你有什么想法吗？

谢谢

OS X 10.8.2 狮子，Xcode 4.5.2，SDK 10.8

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-10T20:18:49.397

如果你继承 NSOutlineView，你可以重写`menuForEvent:`以仅在用户单击正确的行时返回菜单。这是一个例子：

```
- (NSMenu *)menuForEvent:(NSEvent *)event;
{
    //The event has the mouse location in window space; convert it to our (the outline view's) space so we can find which row the user clicked on.
    NSPoint point = [self convertPoint:[event locationInWindow] fromView:nil];
    NSInteger row = [self rowAtPoint:point];

    //If the user did not click on a row, or is not exactly one level down from the top level of hierarchy, return nil—that is, no menu.
    if ( row == -1 || [self levelForRow:row] != 1 )
        return nil;

    //Create and populate a menu.
    NSMenu *menu = [[NSMenu alloc] init];
    NSMenuItem *delete = [menu addItemWithTitle:NSLocalizedString( @"Delete", @"" ) action:@selector(delete:) keyEquivalent:@""];

    [self selectRowIndexes:[NSIndexSet indexSetWithIndex:row] byExtendingSelection:NO];

    //Set the Delete menu item's represented object to the clicked-on item. If the user chooses this item, we'll retrieve its represented object so we know what to delete.
    [delete setRepresentedObject:[self itemAtRow:row]];

    return menu;
} 
```

这假设我们正在使用 ARC 进行编译，因此您不需要自动释放正在创建的菜单对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-03T14:56:02.480

这个扩展 + 子类（包括 NSOutlineView 和 NSTableView）可以明智地查看菜单是否附加到单元格视图或行视图。只是一个通用的、可重用的子类！

在单元格视图中设置菜单`outlineView:viewForTableColumn:item:`-`menu`是一个 NSResponder 属性。

（下面是斯威夫特）

```
// An extension lets us both subclass NSTableView and NSOutlineView with the same functionality
extension NSTableView {
    // Find a cell view, or a row view, that has a menu. (e.g. NSResponder’s menu: NSMenu?)
    func burnt_menuForEventFromCellOrRowViews(event: NSEvent) -> NSMenu? {
        let point = convertPoint(event.locationInWindow, fromView: nil)
        let row = rowAtPoint(point)
        if row != -1 {
            if let rowView = rowViewAtRow(row, makeIfNecessary: true) as? NSTableRowView {
                let column = columnAtPoint(point)
                if column != -1 {
                    if let cellView = rowView.viewAtColumn(column) as? NSTableCellView {
                        if let cellMenu = cellView.menuForEvent(event) {
                            return cellMenu
                        }
                    }
                }

                if let rowMenu = rowView.menuForEvent(event) {
                    return rowMenu
                }
            }
        }

        return nil
    }
}

class OutlineView: NSOutlineView {
    override func menuForEvent(event: NSEvent) -> NSMenu? {
        // Because of weird NSTableView/NSOutlineView behaviour, must set receiver’s menu otherwise the target cannot be found
        self.menu = burnt_menuForEventFromCellOrRowViews(event)

        return super.menuForEvent(event)
    }
}

class TableView: NSTableView {
    override func menuForEvent(event: NSEvent) -> NSMenu? {
        // Because of weird NSTableView/NSOutlineView behaviour, must set receiver’s menu otherwise the target cannot be found
        self.menu = burnt_menuForEventFromCellOrRowViews(event)

        return super.menuForEvent(event)
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T01:00:46.380

从您的问题中不清楚您的大纲是基于视图还是基于单元格。这很重要。

如果您是基于视图的，那么您的视图实例可以实现

```
- (NSMenu *)menuForEvent:(NSEvent *)theEvent 
```

并返回适合该项目的菜单 - 如果您根本不想要菜单，则返回 nil 。

如果您是基于单元格的，或者出于某种原因不想在视图类中处理此问题，则需要将 NSOutlineView 子类化并`- (NSMenu *)menuForEvent:(NSEvent *)theEvent`在那里实现。同样，您将确定哪个单元格被点击或激活，并从中决定您想要什么菜单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-14T15:34:16.153

```
- (void)rightMouseDown:(NSEvent *)event 
```

NSView 不会将此传递给下一个视图，此方法查看当前类是否有一个 menuForEvent:，如果有，则调用它。如果没有，那么它就完成了，不会发生其他任何事情。这就是为什么您不会看到 NSTableCellView 响应 menuForEvent: 的原因，因为表格视图吞下了 rightMouseDown:。

您可以子类化 tableview 并处理 rightMouseDown: 事件并调用 NSTableCellView 的 rightMouseDown: 并处理显示您在情节提要中构建并连接到 NSTableViewCell 的菜单。

这是我在子类 NSTableView 中的解决方案：

```
- (void)rightMouseDown:(NSEvent *)event
{
    for (NSTableRowView *rowView in self.subviews) {

        for (NSView *tableCellView in [rowView subviews]) {

            if (tableCellView) {
                NSPoint eventPoint = [event locationInWindow];
//            NSLog(@"Window Point:     %@", NSStringFromPoint(eventPoint));

                eventPoint = [self convertPoint:eventPoint toView:nil];
                eventPoint = [self convertPoint:eventPoint toView:self];
//            NSLog(@"Table View Point: %@", NSStringFromPoint(eventPoint));

                NSRect newRect = [tableCellView convertRect:[tableCellView bounds] toView:self];
//            NSLog(@"Rect: %@", NSStringFromRect(newRect));

                BOOL rightMouseDownInTableCellView = [tableCellView mouse:eventPoint inRect:newRect];
//            NSLog(@"Mouse in view: %hhd", mouseInView);

                if (rightMouseDownInTableCellView) {
                    if (tableCellView) {
                        // Lets be safe and make sure that the object is going to respond.
                        if ([tableCellView respondsToSelector:@selector(rightMouseDown:)]) {
                            [tableCellView rightMouseDown:event];
                        }
                    }
                }
            }
        }
    }
} 
```

这将找到鼠标右键事件发生的位置，检查我们是否有正确的视图并将 rightMouseDown: 传递给该视图。

请让我知道此解决方案是否适合您。

# android - 我可以在 Libgdx 的底层添加一个演员吗？

> ID：14447123
> 
> 赞同：4
> 
> 时间：2013-01-21T20:59:18.743
> 
> 标签：android, game-engine, libgdx, layer, actor

我正在 Libgdx 中制作游戏，但遇到了一个小问题。我有许多演员动态地出现在屏幕上。如果有一个 Image 演员出现在第一个之后，我可以将它发送到后面，这样它就不会覆盖已经在屏幕上的第一个演员吗？

通常，Libgdx 会像堆栈一样在层次结构中将每个新演员添加到更高的层次，并将每个演员都放在前面。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-21T21:47:46.317

在 Actor 类中尝试以下方法：[toFront()](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/scenes/scene2d/Actor.html#toFront%28%29)、[toBack()](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/scenes/scene2d/Actor.html#toBack%28%29)和[setZIndex()](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/scenes/scene2d/Actor.html#setZIndex%28int%29)

# java - Windows下Eclipse SWT中使用64位XulRunner

> ID：14447126
> 
> 赞同：5
> 
> 时间：2013-01-21T20:59:48.077
> 
> 标签：java, swt, eclipse-rcp, xulrunner

是否可以将 64 位 XulRunner for Windows（[可从此处获得](http://wiki.mozilla-x86-64.com/Download)）与 Eclipse 浏览器小部件一起使用？它在 32 位 Windows 下运行良好，[这个问题](https://stackoverflow.com/questions/7890994/rcp-with-swt-browser-and-xulrunner)的答案解释了它是如何工作的。但是当我在 64 位 Windows 下尝试这个时，我得到以下异常：

```
 org.eclipse.swt.SWTError: No more handles (java.lang.UnsatisfiedLinkError: Could not   
 load SWT library. Reasons: 
   no swt-xulrunner-win32-3834 in java.library.path
   no swt-xulrunner-win32 in java.library.path
   Can't load library: 
     C:\Users\...\.swt\lib\win32\x86_64\swt-xulrunner-win32- 3834.dll
     Can't load library: C:\Users\...\.swt\lib\win32\x86_64\swt-xulrunner-win32.dll
    at org.eclipse.swt.SWT.error(SWT.java:4387)
    at org.eclipse.swt.SWT.error(SWT.java:4276)
    at org.eclipse.swt.browser.Mozilla.initXULRunner(Mozilla.java:2594)
    at org.eclipse.swt.browser.Mozilla.create(Mozilla.java:684)
    at org.eclipse.swt.browser.Browser.<init>(Browser.java:99)
    at org.openlca.ui.BrowserFactory.createMozilla(BrowserFactory.java:52) 
```

谢谢你的帮助，迈克尔

**编辑：** 我在 Eclipse 错误跟踪器中找到了它（[链接在这里](https://bugs.eclipse.org/bugs/show_bug.cgi?id=316157)）：

> swt 的 64 位 Windows 端口没有 xulrunner 支持，因为 mozilla.org 在 Windows 上不提供 64 位 xulrunner

但正如关于这个错误的最后一条评论所说，有一个[64 位 XulRunner](http://wiki.mozilla-x86-64.com/Download)可用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-02T14:30:23.350

Yes, XULRunner support on Windows x86_64 is now in place for the upcoming Eclipse/SWT 4.3 release.

Regarding the XPCOM error 0x80004005, if you're trying to use XULRunner 3.6.x (like the poster in the other question) then support for this was released even more recently, see [https://bugs.eclipse.org/bugs/show_bug.cgi?id=406912](https://bugs.eclipse.org/bugs/show_bug.cgi?id=406912) .

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T14:39:09.243

所以我带着类似的问题来到这里：试图在 Java Swing 中运行 DJ Project 浏览器——更具体地说，在需要 SWT 和 XULRunner 的 Mozilla XPCOM 下载管理器示例中。

在您的 OP 中的 eclipse bug 链接之后 - 我发现了另一个（[eclipse bugzilla](https://bugs.eclipse.org/bugs/show_bug.cgi?id=199660)） - 看起来这是一个长期存在的问题（只有 5 年以上！！） - 实际上是现在（截至 2013 年 11 月 4 日 - 2几天前！）已修复。

我已经从[Eclipse nightly builds](http://download.eclipse.org/eclipse/downloads/)下载了 SWT 包，我可以确认它现在确实包含 swt-xulrunner-win32-xxxx.dll。不幸的是，我现在有其他问题阻止我的测试工作，但我想我会在这里发布我发现的内容。

编辑：实际上我现在的问题与此[XPCOM 错误 0x80004005相同](https://stackoverflow.com/questions/15200224/swt-x64-with-xulrunner-3-6-28-x86)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-07T03:33:39.470

我意识到这个问题已经过时并且已经有一个可以接受的答案，但是关于`XPCOM error 0x80004005`，我也许可以提供帮助。

使用 64 位 4.3 SWT，我能够通过使用 XULRunner 版本 1.9.2.25 运行时修复此异常。最初我从这里找到了下载：[https ://osdn.net/projects/sfnet_runawfe/downloads/SRC%20and%20BIN%20files/extras/xulrunner-1.9.2.25-win64.zip/](https://osdn.net/projects/sfnet_runawfe/downloads/SRC%20and%20BIN%20files/extras/xulrunner-1.9.2.25-win64.zip/)

但是，我也将其重新托管为[`xulrunner-1.9.2.25.en-US.win64.zip`](http://repo.thedesertmonk.com/artifactory/generic/org/mozilla/xulrunner/1.9.2.25/runtimes/xulrunner-1.9.2.25.en-US.win64.zip).

我的答案中发布了完整的解释：[https ://stackoverflow.com/a/44848877/3300205](https://stackoverflow.com/a/44848877/3300205)

# java - KeyListener 没有触发动作

> ID：14447130
> 
> 赞同：2
> 
> 时间：2013-01-21T21:00:02.237
> 
> 标签：java, swing

尽管我将帧注册到 keyListener，但 keyListener 不会触发操作。在其他代码中，实现 KeyListener 接口、注册 JFrame 并覆盖适当的方法是 keyListener 工作所需的全部内容。

```
import java.awt.BorderLayout;
import java.awt.Point;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.event.MouseMotionAdapter;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;

public class Mains implements KeyListener {
    private static Point point = new Point();

    public Mains() {
        final JFrame frame = new JFrame();
        frame.setUndecorated(true);
        JButton button = new JButton("Close Me");
        button.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                System.exit(0);
            }
        });

        frame.addMouseListener(new MouseAdapter() {
            public void mousePressed(MouseEvent e) {
                point.x = e.getX();
                point.y = e.getY();
            }
        });
        frame.addMouseMotionListener(new MouseMotionAdapter() {
            public void mouseDragged(MouseEvent e) {
                Point p = frame.getLocation();
                frame.setLocation(p.x + e.getX() - point.x, p.y + e.getY()
                        - point.y);
            }
        });

        frame.setSize(300, 300);
        frame.setLocation(200, 200);
        frame.setLayout(new BorderLayout());

        frame.getContentPane().add(button, BorderLayout.NORTH);
        frame.getContentPane().add(new JLabel("Drag Me", JLabel.CENTER),
                BorderLayout.CENTER);
        frame.setVisible(true);
        frame.addKeyListener(this);
    }

    public static void main(String[] args) {
        new Mains();
    }

    public void keyPressed(KeyEvent e) {
        System.out.println("pressed");
    }

    public void keyReleased(KeyEvent e) {
        System.out.println("released");
    }

    public void keyTyped(KeyEvent e) {

    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T21:05:07.063

默认情况下，`JFrame`窗口组件是不可聚焦的。尽管您*可以*调用，但使用[键绑定](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)`JFrame.setFocusable(true)`要好得多。

`KeyListener`需要关注组件才能进行交互`KeyEvents`。相反，当使用键绑定时，即使组件没有焦点，您也可以将 Action 映射到 KeyStroke。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-21T21:05:50.743

A`KeyListerner`只有在它附加到的组件可以接收焦点并具有焦点时才能接收键事件。

a 的问题`JFrame`在于它包含 a `JRootPane`，其中包含一个占据整个框架表面的内容窗格，这将阻止框架获得焦点，这永远无法接收关键事件。

`KeyListener`很少选择正确的 API，通常情况下，最好使用[键绑定](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)

您还可以找到[如何使用](http://docs.oracle.com/javase/tutorial/uiswing/components/rootpane.html)感兴趣的根窗格

# gnu-screen - 杀死所有分离的屏幕会话

> ID：14447131
> 
> 赞同：60
> 
> 时间：2013-01-21T21:00:04.547
> 
> 标签：gnu-screen

当我执行`screen -ls`时，我看到以下内容。我怎样才能杀死所有分离的会话？

> 屏幕上有：
> 
> ```
>  84918.ttys002.ros-mbp   (Detached)
> 
>     84944.ttys008.ros-mbp   (Detached)
> 
>     84970.ttys013.ros-mbp   (Attached)
> 
>     84998.ttys002.ros-mbp   (Detached)
> 
>     85024.ttys002.ros-mbp   (Detached) 
> ```
> 
> /var/folders/86/062qtcyx2rxbnmn8mtpkyghs0r0r_z/T/.screen 中有 5 个插槽。

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2013-06-20T03:58:54.173

`screen -ls | grep pts | cut -d. -f1 | awk '{print $1}' | xargs kill`

只杀死**分离**的屏幕会话（信用@schatten）：

`screen -ls | grep Detached | cut -d. -f1 | awk '{print $1}' | xargs kill`

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2014-05-12T17:16:08.063

这是一个结合了所有答案的解决方案：将此添加到您的`.bashrc`or `.bash_profile`：

```
killscreens () {
    screen -ls | grep Detached | cut -d. -f1 | awk '{print $1}' | xargs kill
} 
```

*   这是一个方便的功能，容易记住
*   只杀死分离的屏幕，阻止你做一些愚蠢的事情
*   记得打开一个新的 bash 终端或运行`source .bashrc`以使其`killscreens`可用

*感谢@Rose Perrone、@Milind Shah 和 @schatten*

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-01-21T21:00:04.547

在你的 .bash_profile 中包含这个函数：

```
killd () {
    for session in $(screen -ls | grep -o '[0-9]\{4\}')
    do
        screen -S "${session}" -X quit;
    done
} 
```

要运行它，请调用`killd`. 这将杀死所有屏幕会话，无论是否分离。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-03-20T15:27:14.057

将 Edward Newell 和 Rose Perrone 的解决方案组合成一个更具可读性和类似“屏幕”的解决方案。

将下面添加到您的`.bashrc`或`.bash_profile`.

```
# function for killing all detached screen sessions
killds() {
    detached_sessions=$(screen -ls | grep Detached | cut -d. -f1 | awk '{print $1}')
    for s in ${detached_sessions}
    do
        screen -S "${s}" -X quit;
    done
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-29T17:54:24.753

如果屏幕死了，请使用：

```
screen -wipe 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-05-03T20:28:55.757

```
'[0-9]\{3,\}' 
```

的情况下

```
There is a screen on:
20505.blabla    (03/05/2014 22:16:25)   (Detached)
1 Socket in /var/run/screen/S-blabla. 
```

将匹配 20505 和 2014，其中退出 2014 将返回“未找到屏幕会话”。

```
[0-9]\{3,\}\.\S* 
```

可能会奏效。

我总是遇到模式 20505\. *name*，如果使用 -S 标志启动屏幕，则*name*是主机名或会话名。适用于 OS X 和 Debian，可能不是通用的。

# sql - SQL查询 - 如何显示数据何时重复x个条目

> ID：14447135
> 
> 赞同：0
> 
> 时间：2013-01-21T21:00:18.433
> 
> 标签：sql, sql-server, group-by, sql-server-2008-r2

我正在使用 SQL Server 2008 R2 Standard，但我对 SQL Server 还是很陌生。

我试图找出当 ax （测量值）具有超过 48 个日期时间间隔的趋势数据时。

提前致谢。

我的基本查询结构是

```
SELECT sites.site_name, 
       measurements.measurement_name, 
       trend_data_temp.trend_data_avg, 
       trend_data_temp.trend_data_time 
FROM   sites 
       INNER JOIN group_sites 
               ON sites.site_id = group_sites.site_id 
       INNER JOIN groups 
               ON group_sites.group_id = groups.group_id 
       INNER JOIN measurements 
               ON sites.site_id = measurements.site_id 
       INNER JOIN trend_data 
               ON measurements.measurement_id = trend_data.measurement_id 
       INNER JOIN trend_data_temp 
               ON measurements.measurement_id = trend_data_temp.measurement_id 
GROUP  BY sites.site_name, 
          measurements.measurement_name, 
          trend_data_temp.trend_data_avg, 
          trend_data_temp.trend_data_time 
ORDER  BY sites.site_name, 
          measurements.measurement_name 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:37:58.943

稍微有点黑暗，没有输入数据和输出数据的任何轮廓，但也许你需要这样的东西（未经测试）

```
 SELECT 
           sites.site_name, 
           measurements.measurement_name, 
           trend_data_temp.trend_data_avg, 
           [occurances] = count(trend_data_temp.trend_data_time) 
    FROM   sites 
           INNER JOIN group_sites 
                   ON sites.site_id = group_sites.site_id 
           INNER JOIN groups 
                   ON group_sites.group_id = groups.group_id 
           INNER JOIN measurements 
                   ON sites.site_id = measurements.site_id 
           INNER JOIN trend_data 
                   ON measurements.measurement_id = trend_data.measurement_id 
           INNER JOIN trend_data_temp 
                   ON measurements.measurement_id = trend_data_temp.measurement_id 
    GROUP  BY 
           sites.site_name, 
           measurements.measurement_name, 
           trend_data_temp.trend_data_avg
    HAVING count(trend_data_temp.trend_data_time) >=48 
```

# c# - 将 DropDownBox 添加到 Telerik MVC 网格

> ID：14447138
> 
> 赞同：0
> 
> 时间：2013-01-21T21:00:38.023
> 
> 标签：c#, asp.net-mvc, visual-studio-2010, telerik, dropdownbox

我正在尝试将 DropDownBox 放入 Telerik MVC 网格中。我已经阅读了与此相关的所有答案，并在网上搜索了三天。我在这里不知所措，我一定在某处遗漏了一些简单的东西。我将在下面发布相关代码。

模型：

```
public class PriceListItemViewModel : IValidatableObject
{
        public string TaxLevelID
    { get; set; }

    //[UIHint("TaxLevels")]
    public string TaxLevelDescription
    { get; set; }

    public int TaxTypeID
    { get; set; }   

    //[UIHint("TaxTypes")]
    public string TaxTypeDescription
    { get; set; }
 } 
```

控制器：

```
 public ActionResult EditTaxRecordEntryList(int? id)
    {
        ViewBag.TaxLevels = GetTaxLevels();
        ViewBag.TaxTpes = GetTaxTypes();
        PriceList taxRecordEntryList = RestRequest.Communicate<PriceList>("PriceMaintenanceService/PriceList/" + id, "GET");
        PriceListViewModel viewModel = AutoMapper.Mapper.Map<PriceList, PriceListViewModel>(taxRecordEntryList);
        return View(viewModel);
    }

    public List<SelectListItem> GetTaxTypes()
    {
        List<SelectListItem> selectList = new List<SelectListItem>();
        List<TaxType> taxTypes = RestRequest.Communicate<List<TaxType>>("PriceMaintenanceService/alltaxtypes", "GET");
        taxTypes.ForEach(o => selectList.Add(new SelectListItem
        {
            Text = o.Description,
            Value = o.ID,
            Selected = (taxTypes != null)
        }));

        return selectList;
    }

    public List<SelectListItem> GetTaxLevels()
    {
        List<SelectListItem> selectList = new List<SelectListItem>();
        List<TaxLevel> taxTypes = RestRequest.Communicate<List<TaxLevel>>("PriceMaintenanceService/alltaxlevels", "GET");
        taxTypes.ForEach(o => selectList.Add(new SelectListItem
        {
            Text = o.Description,
            Value = o.ID,
            Selected = (taxTypes != null)
        }));

        return selectList;
    } 
```

看法：

```
 Html.Telerik().Grid(Model.PriceListItems)
    .Name("TaxRecordEntryList")
    .DataKeys(k => 
        k.Add(o => o.ID))
    .Columns(c =>
    {
        //c.Bound(o => o.TaxLevels).ClientTemplate("<#= TaxLevels #>");
        c.Bound(o => o.TaxLevelDescription).ClientTemplate(
            Html.Telerik().DropDownList()
            .Name("Tax Level")
            .BindTo(new SelectList(ViewBag.TaxLevels)));
        c.Bound(o => o.TaxTypeDescription).ClientTemplate("<#= TaxTypes #>");
        c.Bound(o => o.TaxRate).Title("Rate (1-100)%");
        c.Bound(o => o.EffectiveStartDate).Title("Start Date");
        c.Bound(o => o.EffectiveEndDate).Title("End Date");
        c.Command(commands =>
        {
            commands.Edit().ButtonType(GridButtonType.Image);
            commands.Delete().ButtonType(GridButtonType.Image);
        }).Title("Commands").HeaderHtmlAttributes(new { @style = "max-width:35px;" });
        c.Bound(o => o.TaxLevelID).Hidden(true);
        c.Bound(o => o.TaxTypeID).Hidden(true);
    })
    .DataBinding(binding => binding.Ajax()
        .Select("SelectPriceListItemsJson", "TaxRecord", new { PriceListID = Model.ID, priceType = "Tax" })
        .Update("UpdatePriceListItemsJson", "TaxRecord", new { PriceListID = Model.ID, priceType = "Tax" })
        .Insert("InsertPriceListItemsJson", "TaxRecord", new { PriceListID = Model.ID, priceType = "Tax" })
        .Delete("DeletePriceListItemsJson", "TaxRecord", new { PriceListID = Model.ID, priceType = "Tax" })
    )
    .Sortable()
    .ToolBar(tools =>
    {
        tools.Insert().ButtonType(GridButtonType.Image);
    })
    .ClientEvents(events => events
        .OnEdit("onEdit")
        .OnRowDataBound("OnRowDataBound") 
    )
    .Filterable(filtering => filtering.Enabled(true)) 
```

)

# ember.js - 是否可以通过继承而不是使用“需要”与 ember 中的控制器共享行为

> ID：14447141
> 
> 赞同：4
> 
> 时间：2013-01-21T21:00:48.913
> 
> 标签：ember.js

下面我提供了一个我“认为”应该起作用的例子，但没有。我的期望是，如果一个控制器继承自另一个控制器，那么它应该能够访问父类中提供的行为。我知道“需要”可以实现相同的行为，但我认为如果你可以继承行为会更清晰。

[https://gist.github.com/4589210](https://gist.github.com/4589210)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-11-10T17:22:29.700

您也可以使用`mixin`. 这是什么？这是一种多继承。

```
App.Important = Ember.Mixin.create({
  sharedBehavior: function() {
    return "A winner is you!!!";
  }.property()
});

App.OtherImportant = Ember.Mixin.create({
  otherSharedBehavior: function() {
    return "A winner is not you!!!";
  }.property()
});

App.AnotherController = Ember.controller.extend(App.Important, App.OtherImportant, {
  importantStuff: function() {
    var ohBeehave = this.get("sharedBehavior");
    if(ohBeehave) { 
      return ohBeehave;
    } else {
      return "FML";
    }
  }.property("sharedBehavior")
}); 
```

见[http://emberjs.com/api/classes/Ember.Mixin.html](http://emberjs.com/api/classes/Ember.Mixin.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T21:45:26.623

您是正确的，控制器应该能够从其他控制器继承属性。这是一个基于您的要点的工作示例：

[http://jsbin.com/uzeyum/1/edit](http://jsbin.com/uzeyum/1/edit)

```
App = Ember.Application.create();

App.ApplicationController = Ember.Controller.extend({
  sharedBehavior: function() {
    return "A winner is you!!!";
  }.property()
});

App.AnotherController = App.ApplicationController.extend({
  importantStuff: function() {
    var ohBeehave = this.get("sharedBehavior");
    if(ohBeehave) { 
      return ohBeehave;
    } else {
      return "FML";
    }
  }.property("sharedBehavior")
}); 
```

也就是说，根据经验，我可以告诉你，继承很少是你想要的。造成这种情况的原因有很多，请参阅更[喜欢组合而不是继承？](https://stackoverflow.com/questions/49002/prefer-composition-over-inheritance)详情。

通过通过`needs`属性而不是继承声明一组依赖项，随着时间的推移，您会发​​现您的应用程序不那么脆弱并且更容易测试/更改。

# java - Android 编程：循环语音识别

> ID：14447144
> 
> 赞同：3
> 
> 时间：2013-01-21T21:00:56.293
> 
> 标签：java, android, audio-recording, voice-recognition, mediarecorder

我正在寻找一个定制的 Android 应用程序来帮助一个身体残疾的人。我需要严重依赖语音识别。这个想法是：

1.  应用程序（通过语音识别）接受他的讲话
2.  该应用程序解析他的讲话并执行他的命令（“给爸爸发电子邮件”、“发短信”、“现在几点了？”等，以及我将添加的其他内容来控制他的电视、灯光等）
3.  执行后，应用程序等待他的下一个命令（循环回到#1）

我的#1 和#2 工作正常，但我想不出#3 的好方法。我不能让谷歌的语音识别视图无限期地运行，因为它可能在下一个命令之前几个小时。但是“触发器”确实必须基于声音/声音。必须完全解放双手。

理想情况下，该应用程序只会听声音，如果该声音高于某个预编程的分贝水平，我会开始语音识别。是否可以不断循环只听噪音，然后在它“如此”响亮时做出反应？

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-04T09:35:58.683

[CMUSphinx](http://cmusphinx.sourceforge.net)是一个很好的解决方案：

1.  您可以轻松连续收听，提供语音检测API
2.  您可以提高一组自定义命令的准确性
3.  您可以使模型适应用户的声音，从而显着提高准确性

有关在 Android 上使用 CMUSphinx 的更多详细信息，请参阅

[http://cmusphinx.sourceforge.net/2011/05/building-pocketsphinx-on-android/](http://cmusphinx.sourceforge.net/2011/05/building-pocketsphinx-on-android/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-04T01:35:18.287

所以这个想法是你希望语音识别持续进行。很难做到这一点。但我实现这一点的方法是使用：

```
 try {
       Thread.sleep(4500);
       mSpeechRecognizer.startListening(mSpeechRecognizerIntent);
   }  catch (InterruptedException e) {
        // It depends on your app logic what to do with InterruptedException
        // You can process it or rethrow or restore interrupted flag
   } 
```

之后`onReady`（因此，如果用户在 4.5 秒左右没有说什么，它会重置并显示结果。这对我来说非常有用。

# tomcat - Tomcat：Web 应用程序中的自定义表单验证器，而不是作为独立 JAR 模块。可能的？

> ID：14447146
> 
> 赞同：1
> 
> 时间：2013-01-21T21:00:59.773
> 
> 标签：tomcat, form-authentication, context.xml, tomcat-valve

我们的 Web 应用程序需要内部具有特定逻辑的自定义表单身份验证。当前的表单验证器实现需要验证器模块，我们称之为它`custom.auth.jar`，在`%CATALINA_HOME%/lib`Web 应用程序启动之前存在。`context.xml`Web 应用程序使用以下指令使用该自定义身份验证器模块：

```
<Valve className="foo.bar.CustomAuth" characterEncoding="UTF-8"/> 
```

据我了解 Tomcat 的要求，在 Web 应用程序启动之前，该模块`custom.auth.jar`必须存在于 Tomcat 的`lib`目录中，因为 Web 应用程序似乎不需要与 Web 存档一起打包的身份验证器代码——它总是试图在`%CATALINA_HOMA%/lib`. 否则 Web 应用程序根本无法启动：

```
SEVERE: Parse error in context.xml for /webapp
java.lang.ClassNotFoundException: foo.bar.CustomAuth 
```

由于鉴权业务逻辑的特殊性和一些保护，我们被迫引入某种鉴权模块的版本控制，并在 Web 应用程序监听器中检查其版本——如果 Web 应用程序发现鉴权模块的版本不兼容（不检查 Tomcat 库目录中提供的 JAR 文件——我们使用反射代替）——它只是拒绝开始报告正在尝试启动的 Web 应用程序和身份验证模块之间的兼容性错误。同样，必须在 中指定*现有的*`context.xml`身份验证器模块。

尽管它保护了不兼容的版本，但这带来了一些主要困难：我们不能在同一个 Tomcat 实例中启动同一个应用程序的另一个版本，因为这两个应用程序需要不同版本的身份验证模块。`lib`但是在 Tomcat 的目录中可以有一个版本。

我的问题是：是否可以将自定义`FormAuthenticator`直接打包到 Web 应用程序中，而不需要在`FormAuthenticator`启动 Web 应用程序之前加载单个版本？这将允许启动我们想要的任意多个版本的 Web 应用程序，并且根本不接触`%CATALINA_HOME%/lib`。

换句话说：如何让 Tomcat 从 Web 应用程序中获取自定义身份验证器模块，而不是从其主库目录中获取？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:31:57.050

`Valve`webapp 类加载器无法加载类。看看[这个](https://stackoverflow.com/questions/6138396/custom-tomcat-valve-contained-in-web-app-war-file)问题的答案。

作为版本控制问题的可能解决方案，考虑通过覆盖 CATLINA_BASE 环境变量来启动不同的 Tomcat 实例。使用单独的 CATALINA_HOME 和 CATALINA_BASE 运行记录在 RUNNING.txt 文件中，该文件可以在 Tomcat 发行版中找到。我还可以分享一个工作示例配置。

# php - Cakephp Recaptcha 不工作

> ID：14447154
> 
> 赞同：0
> 
> 时间：2013-01-21T21:01:24.717
> 
> 标签：php, cakephp, recaptcha

当我尝试从[http://bakery.cakephp.org/articles/tbsmcd/2011/02/05/recaptcha_plugin_6](http://bakery.cakephp.org/articles/tbsmcd/2011/02/05/recaptcha_plugin_6)添加recaptcha 插件时，显示以下错误。

> Strict (2048)：RecaptchaComponent::startup() 的声明应该与 Component::startup(Controller $controller) 兼容 [APP/Plugin/recaptcha_plugin/Controller/Component/RecaptchaComponent.php，第 17 行]
> 
> Strict (2048)：ValidationBehavior::beforeValidate() 的声明应该与 ModelBehavior::beforeValidate(Model $model) [APP/Plugin/recaptcha_plugin/Model/Behavior/ValidationBehavior.php，第 2 行] 兼容*** *

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:29:30.740

您是否正在尝试将此 CakePHP 1.3 插件与 CakePHP 2.x 一起使用？我问的原因是文件名`recaptcha_plugin`不遵循 CakePHP 约定。按照[Git Repo](https://github.com/tbsmcd/recaptcha_plugin)上的自述文件进行操作。

看起来您需要重命名插件目录中的插件文件夹：

```
/app/Plugin/Recaptcha 
```

# jquery - 带有 if 语句的 jQuery 正则表达式代码用于密码

> ID：14447158
> 
> 赞同：0
> 
> 时间：2013-01-21T21:02:03.760
> 
> 标签：jquery, regex, passwords

我正在尝试制作一个 if 语句来测试 jQuery（或 Javascript）中的字符串。以下是条件：

1.  必须在 6-8 个字符之间。
2.  第一个字符不能是数字。
3.  必须包含 1 个数字、1 个小写字母和 1 个大写字母。

这是我的正则表达式代码：

```
((?=^[^0-9])(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,8}) 
```

我在一个测试正则表达式代码的网站上对其进行了测试，它运行良好。

这是我目前的if语句：

```
if(((?=^[^0-9])(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,8}).test(strOldPassword))
{
    alert("Something");
} 
```

但是，当我的网页加载时出现语法错误，说正则表达式存在问题。

有人可以帮我找出我做错了什么吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:10:16.457

有两种方法可以在 JavaScript 中定义正则表达式。

1.  使用`/.../`语法。

    ```
    /((?=^[^0-9])(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,8})/ 
    ```

2.  通过创建 RegExp 对象的实例，该对象在构造函数中接受正则表达式作为字符串。

    ```
    new RegExp("((?=^[^0-9])(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,8})") 
    ```

那是，

```
if(/((?=^[^0-9])(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,8})/.test(strOldPassword)){
  alert("Something");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:14:36.830

尝试以下操作：

```
if(/^(?=^[^0-9])(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,8})$/.test(strOldPassword))
// --                                                -- 
```

`/.../`分隔正则表达式文字，以便解析器知道将什么解析为正则表达式，而不是 javascript（很像单引号分隔字符串）。

`^...$`表示应该匹配整个字符串（否则您将测试*至少*6-8 个字符）。

`// -- ... --`只是一个评论，表明我已经改变了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T21:31:23.153

知道了！

```
if (!(/((?=^[^0-9])(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,8})$/.test(strOldPassword)))
{
    jQuery('#txtOldPassword').addClass('error');
} 
```

谢谢提醒伙计。

# openerp - 如何将自定义模型的 one2many 字段添加到 Openerp 的树视图中？

> ID：14447166
> 
> 赞同：2
> 
> 时间：2013-01-21T21:02:34.747
> 
> 标签：openerp

我想在表单视图中添加一个选择字段并在树视图中显示选择。

我首先尝试向模型添加自定义选择字段，但由于我有很多值要添加到选择字段，我碰到了模型`char(128)`选择字段的限制`ir.model`。

其次，我创建了一个名为 x_newmodel 的新自定义模型，其中包含 3 个名称`x_name`为 , 的字段`x_code`， `x_description` 添加了一个连接到解决表单视图问题的字段。 但是，当我尝试将新字段添加到树视图时，我无法在视图上显示数据。 `one2many``x_newfield``x_newmodel`
`x_newfield`

**我的问题是如何将自定义字段的字段 one2many 关系添加到树视图？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T10:57:59.120

AFAIK，不支持。

你可以做的是在你的模型上添加一个函数字段来计算

```
','.join(elem.name for elem in obj.x_newfield) 
```

并在您的树显示中使用它。

如果您需要添加过滤器，您可以为您的功能字段实现搜索功能。

# node.js - 使用 siege 测试 node.js 服务器时出现问题

> ID：14447167
> 
> 赞同：3
> 
> 时间：2013-01-21T21:02:36.697
> 
> 标签：node.js, load, websocket

我正在使用 siege 为我的 node.js 服务器（一个小型​​ web 应用程序）做一些负载测试。我可以看到，即使是像 300 这样的少量并发连接，它也会显示一些错误

```
siege -c 300 -n myserver.com:3000 
```

然后我可以看到一些结果，例如

```
[error] socket: read error Connection reset by peer sock.c:460: Connection reset by peer
[error] socket: read error Connection reset by peer sock.c:460: Connection reset by peer
[error] socket: read error Connection reset by peer sock.c:460: Connection reset by peer
[error] socket: read error Connection reset by peer sock.c:460: Connection reset by peer
[error] socket: read error Connection reset by peer sock.c:460: Connection reset by peer
[error] socket: read error Connection reset by peer sock.c:460: Connection reset by peer
[error] socket: read error Connection reset by peer sock.c:460: Connection reset by peer
[error] socket: read error Connection reset by peer sock.c:460: Connection reset by peer 
```

我可以看到服务器正在关闭连接。为什么会这样。我该如何调试它。我有一台运行在 4GB 内存的 Macbook pro 上的服务器。我想让你知道我使用过 websockets。即客户端访问运行在 node.js 上的 Web 服务器返回的页面。然后，此页面使用 websockets 连接到同一服务器以进行双向通信。什么可能导致这样的问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T06:52:12.903

当遇到您认为您可能会用完套接字的情况时，有两件事需要确认。

1.  检查您是否*明确*关闭了套接字。在某些语言中，垃圾收集器的终结逻辑会在你之后清理，但这涉及滞后且马虎；在其他不这样做的语言中，您的应用程序将“泄漏”套接字（以及文件句柄），直到它终止。
2.  使您的操作系统允许您的应用程序的用户帐户为您的测试提供足够的峰值套接字。

要解决第 1 点：您要关闭套接字吗？我不是一个重度 node.js 用户，但我认为：

```
var conn = new net.Socket();
conn.destroy(); //Are you doing this? 
```

要解决第 2 点：将硬打开和软打开文件限制设置为足够高的值，以免妨碍您：

```
launchctl limit maxfiles 8192 8192 
```

不带参数运行`sudo launchctl limit`应该打印出您当前的限制。有关更多详细信息，请查看[有关 launchctl 的 Apple 文档。](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/launchctl.1.html)

# arrays - 将模拟输出存储在数组 (R) 中

> ID：14447174
> 
> 赞同：0
> 
> 时间：2013-01-21T21:02:54.763
> 
> 标签：arrays, r, loops

我试图将我的模拟输出存储在一个数组中。我写了以下代码：

```
nsim=50
res=array(0,c(nsim,20,20))
for(i in 1:nsim) {
    cat("simul=",i,"\n")
    simulated = NULL
    stik.simulated = NULL
    simulated = rpp(....)
    stik.simulated = STIKhat(....)
    # from stik.simulated we will get $khat and $Ktheo and 
    # the dimension of stik.simulated$Khat-stik.simulated$Ktheo is 20 x 20
    res[i,,] = stik.simulated$Khat - stik.simulated$Ktheo  
} 
```

但是每当函数试图将输出存储在数组中时，我都会收到以下错误：

```
simul= 1 
Xrange is  20 40 
Yrange is  -20 20 
Doing quartic kernel
Error in res[, , i] = stik.simulated$Khat - stik.simulated$Ktheo : 
  subscript out of bounds 
```

寻求你的帮助。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:29:06.827

我认为您需要组织代码以避免此类错误。我假设您正在使用 package `stpp`。

首先，您创建一个生成每次迭代矩阵的函数；尝试使用许多值测试您的函数。

```
stick_diff <- function(u,v){
  u <- seq(0,u,by=1)
  v <- seq(0,v,by=1)
  simulated <- rpp(...)                    ## call here rpp with right parameters
  stik <- STIKhat(xyt=simulated$xyt,
                     dist=u, times=v, ...)
  stik$Khat-stik$Ktheo                     ## !! here if u#v you will have recycling!
} 
```

一旦你确定你的功能，你就称它为循环，具有正确的尺寸。

```
nsim <- 50
u    <- 20
res=array(0,c(nsim,u,u))
for(i in 1:nsim)
  res[i,,] <- stick_diff(i,u,u) 
```

# ios - 在uitableviewcell中隐藏空行

> ID：14447181
> 
> 赞同：1
> 
> 时间：2013-01-21T21:03:36.783
> 
> 标签：ios, objective-c, uitableview

我在表格视图中显示文件。在 cellForRowAtIndexPath 中，我只想显示某些类型的文件。

我正在做这样的事情：

```
 if (document is folder) {
       display folder details;
    } 
    else (document is not folder) {
       display empty cell;
     } 
```

通过这样做，我可以显示空单元格，但那些仍然存在（隐藏）如何摆脱这些行。有关详细信息，请参见图片。

![在此处输入图像描述](../Images/4565223b037acbc422fa2d415b267843.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:15:54.133

我认为你应该重新考虑这个问题，`cellForRowAtIndexPath:`永远不应该为一个不存在的单元格调用。确定您的数据集中有多少文件夹可用，并在`tableView:numberOfRowsInSection:`

然后您不必担心一旦`cellForRowAtIndexPath:`到达就隐藏它，因为它是应该创建的真实单元格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:15:06.020

要“隐藏”单元格，您需要首先创建一个仅包含文件夹的数组。您并不是真的要隐藏单元格，而是只在表数据源数组中包含正确的对象。

在您的`viewDidLoad`, 遍历整个文档数组并将任何文件夹添加到单独的 folderArray 中，如下所示：

```
_folderArray = [NSMutableArray new];
for(Document *doc in documentsArray)
{
    if(doc is a folder)
    {
        [_folderArray addObject:doc];
    }
} 
```

在您的所有 tableView 委托和数据源方法中使用该文件夹数组，而不是使用文档数组。

# .htaccess - .htaccess 文件问题

> ID：14447182
> 
> 赞同：1
> 
> 时间：2013-01-21T21:03:44.573
> 
> 标签：.htaccess

当我将 .htaccess 文件放在我的根目录中时，它给了我以下错误：

> 内部服务器错误 服务器遇到内部错误或配置错误，无法完成您的请求。请通过 admin@localhost 联系服务器管理员，告知他们此错误发生的时间，以及您在此错误之前执行的操作。更多信息服务器错误日志中可能会提供有关此错误的信息。”

这是我的 .htaccess 代码：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /login/profile.php?username=$1 
```

基本上这段代码的功能就像当用户在 url 中输入他的个人资料名称然后它通过 URI 显示用户个人资料页面`localhost/login/adam`。

# ios - iTunes Connect 不接受我的大应用程序图标

> ID：14447184
> 
> 赞同：6
> 
> 时间：2013-01-21T21:03:46.170
> 
> 标签：ios, icons, app-store-connect

我已向 iTunes Connect 提交了一个符合所有规范的大型应用程序图标：.png 文件、1024x1024 像素等，但我仍然收到错误：

> “您上传的大应用程序图标无效。它必须是 .jpeg、.jpg、.tif、.tiff 或 .png 文件，大小为 1024 x 1024 像素，至少 72 DPI，并且在 RGB 颜色空间中。 "

我使用 Photoshop Elements 创建了它。非常感谢任何指导。

更新 - 问题已解决：

我又试了一次。有效。不需要将导出为 PNG 或 TIF，我不确定这次（尝试 4 小时后）到底有什么不同，但它上传了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-11-11T06:44:26.687

下面的命令是对基线 PNG 图像的破解，并将它们格式化为“苹果方式”。在命令行（终端）中使用以下命令，更改“/path/to/image/folder/”以匹配 PNG 文件的位置：

```
sips --deleteColorManagementProperties /path/to/image/folder/*.png 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T14:23:46.880

注意需求中关于 RGB 颜色空间的部分。也许您的文件最初保存为 CMYK？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-13T07:05:01.893

如果您通过更改名称（强制从 image.jpg 到 image.png）更改了图像的扩展名并且您没有将图像导出为该格式，则可能会出现此错误。

只需将图像导出为该格式即可解决您的问题。您可以使用 72dpi 的 512x512 或 1024x1024 RGB 色彩空间图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-23T01:49:29.673

使用“非隔行扫描”选项保存它，因为我认为它不接受隔行扫描 PNG

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-04T13:39:13.177

我有同样的问题，尝试了很多不同的图像尺寸 1024、512、jpg、png ......首先它们都处于错误的 CMYK 颜色模式。然后我用RGB尝试了jpg，没有用

最后：

.PNG 1024x1024px 与颜色模式“RGB”工作

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-02-06T14:08:53.430

您的图标文件必须使用以下配置保存：

*   尺寸 1024 x 1024 像素，最大分辨率 72 dpi
*   您的图像/图片没有 alpha 颜色（取消选中 alpha 清单）
*   没有透明度，没有圆角
*   以 PNG 或 JPEG 格式保存

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-08-20T18:35:31.467

对于那些没有脚本或其他活动的人。允许 apple.com，否则您只会收到“无法加载您的文件。再试一次”。一遍又一遍地。

# encryption - 无法为新用户生成有效的 ssh 公钥/私钥对

> ID：14447185
> 
> 赞同：2
> 
> 时间：2013-01-21T21:03:50.050
> 
> 标签：encryption, ssh, key, private, public

我正在尝试将一个新用户添加到我的 Ubuntu 系统并为他们提供 SSH 访问权限，使用公钥/私钥登录。但我似乎无法让它工作。

使用 putty gen 生成公钥/私钥对。然后将公钥复制到他们的 homedir/.ssh/authorized_keys 中。但是，当我在 Windows 会话中将私钥加载到 Pageant 并尝试使用 putty 进入时，我得到“断开连接：没有可用的支持的身份验证方法”。

有趣的是，如果我将相同的公钥放在现有用户的 ./.ssh/authorized_keys 文件中，我可以使用该用户登录。这是由我之前的人设置的，但我现在无法联系，所以我不知道有什么区别。

如果我检查 etc/ssh/sshd_config 文件，AuthorizedKeysFile 行将被注释掉。#AuthorizedKeysFile %h/.ssh/authorized_keys

但是即使我把它放回去并重新启动 ssh 服务它仍然不起作用（尽管我认为不会解决它，因为为什么当前用户会工作）

有什么我可以做的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:16:53.100

阅读`sshd`系统日志中的守护进程错误消息（`auth.log`或`security.log`类似的）。

我的猜测是新用户家中的目录和/或文件权限`.ssh`或过于宽松（不安全）。`.ssh/authorized_keys`如果这是问题，这应该解决它：

```
chmod 700 .ssh
chmod 644 .ssh/authorized_keys 
```

# php - 使用 Codeigniter 自动化路由

> ID：14447186
> 
> 赞同：1
> 
> 时间：2013-01-21T21:03:53.343
> 
> 标签：php, codeigniter, routes

我正在将 CI 作为一个模块集成到另一个脚本中，我需要配置和设置路由才能正常工作，但是从这个父脚本内部，mod 会重写等等。

基本上启动父脚本将所有 URL 路由`m/MODULE_NAME`到模块文件夹。在这个模块文件夹中，我让 CI 接管并处理发送给它的请求。

当我查看请求的所有部分时：`http://www.example.com/folder/m/memberships`

CI 打印出这样的段：

```
array( [0] => 'folder', [1] => 'm', [2] => 'memberships' ) 
```

我试图弄清楚如何更改配置设置，以便在`/m/memberships`.

现在我基本上是单独设置每条路线：

```
// Main config routes
$route['(:any)/m/memberships'] = 'home';
$route['(:any)/m/memberships/admin'] = 'admin/dashboard';
$route['(:any)/m/memberships/admin/config'] = 'admin/config'; 
```

我尝试将基本 url 设置为`http://www.domain.com/m/memberships`，但即使是此处列出的路由也没有添加到段中，我无法将它们指向正确的控制器。

有人有什么建议吗？我对CI相当陌生。

编辑：这些是我设置的一些配置，可能会有所帮助：

```
$config['base_url']   = 'http://www.domain.com/folder/';
$config['index_page']    = '';
$config['uri_protocol']  = 'AUTO'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:37:12.997

有两种方法可以做到这一点

1) 设置`$config['base_url'] = 'http://www.domain.com/folder/m/memberships';` 并清除路线

2) 设置路线`$route['m/memberships/(:any)/(:any)'] = '$1/$2';`

第一个更干净

# iphone - iOS：XIB 中使用的图像名称

> ID：14447189
> 
> 赞同：3
> 
> 时间：2013-01-21T21:04:03.943
> 
> 标签：iphone, ios, objective-c, xib, nscoder

有没有办法找出在 XIB 中使用的图像代号，例如按钮的背景？

假设我有带有按钮的xib，其属性背景（对于状态配置：默认）设置为“button.png”，按钮有一个IBOutlet，例如myButton。当我的视图是从 xib 创建时，我可以通过以下方式轻松访问图像：[myButton backgroundImageForState:UIControlStateNormal] 但它当然是 UIImage，但我需要找到在 xib 中使用的图像名称（“button.png”）。

我试图继承 UIButton 并在 initWithCoder:(NSCoder *)aDecoder 中找到带有 NSCoder 的东西，但没有结果

定义按钮背景的 xib 的一部分是

```
<object class="NSCustomResource" key="IBUINormalBackgroundImage">
    <string key="NSClassName">NSImage</string>
    <string key="NSResourceName">button.png</string>
</object> 
```

正在尝试类似的东西：

```
NSObject * obj = [aDecoder decodeObjectForKey:@"IBUINormalBackgroundImage"]; 
```

但不起作用（从笔尖初始化时如何使用 NSCoder？）

也试图覆盖

```
-(void)setBackgroundImage:(UIImage *)image forState:(UIControlState)state{
    [super setBackgroundImage:image forState:state];
} 
```

但是永远不会被调用，但是在 awakeFromNib 中，everyting 已经被初始化并加载了。

任何人都可以解释/帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T15:11:28.110

是的，一旦是 UIImage，就不会保留原始文件名的引用。

但是，如果您需要从 UIButton 获得它，则可以通过使用其 imageView 的**可访问性标识符**来规避该问题。这个方法应该在任何继承 UIView 的类上都可用。

```
NSString *filename = [button.imageView accessibilityIdentifier] ; 
```

# javascript - knockoutjs - 对象的 changeTracker/dirtyFlag 立即触发

> ID：14447190
> 
> 赞同：2
> 
> 时间：2013-01-21T21:04:14.113
> 
> 标签：javascript, knockout.js

我最近在我的代码中成功地找到并应用了[changeTracker/dirtyFlag](https://stackoverflow.com/questions/9995104/eventhandler-model-change-in-knockout-js)方法，一切都很好。非常整洁和有用。不过，今天，我试图再次使用它，但发生了一些奇怪的事情：我一打开页面，*somethingHasChanged*触发器就被触发了。

我看了，搜了，什么也没有。设置跟踪器后，我没有对可观察对象进行任何更改。经过几个小时，我找到了问题的根源：

其中一个 observables 绑定到一个`<select>`元素，从而设置当前选择的`<option>`.

如果我删除此绑定，它将不再触发。我不知道为什么会发生这种情况，因为该值仅被读取（据说）。

对此有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:11:26.810

我的猜测是您正在绑定数值，并且所选的值正在作为字符串写回您的视图模型，因为 KO 从 DOM 元素中读取它。

# c++ - 覆盖子类中的数组大小

> ID：14447192
> 
> 赞同：2
> 
> 时间：2013-01-21T21:04:18.467
> 
> 标签：c++, arrays, inheritance

我有一个数组作为类的成员。在一个子类中，我想用不同的大小重新定义数组。我想这样做是因为我预计会创建许多子类，每个子类只有它需要的数组大小，仅此而已。

```
class Foo
{
    Foo() {ivar = 1};
    int thisArray[2];
    int ivar;
}

class Bar : public Foo
{
    Bar() {ivar = 3};
    int thisArray[4];
}

int main()
{
    Foo myFoo;
    Bar myBar;

    Foo fooCollection[] = {myFoo,myBar};

    cout << "myFoo array size = " << sizeof(myFoo.thisArray)/sizeof(int) << endl;
    cout << "myBar array size = " << sizeof(myBar.thisArray)/sizeof(int) << endl;

    for (int n=0;n<2;n++)
    {
        cout << "fooCollection[" << n << "] array size = ";
        cout << sizeof(fooCollection[n].thisArray)/sizeof(int) << endl;
    }
    for (int n=0;n<2;n++)
    {
        cout << "fooCollection[" << n << "] ivar = ";
        cout << fooCollection[n].ivar << endl;
    }

} 
```

我的结果是：

```
myFoo array size = 2
myBar array size = 4
fooCollection[0] array size = 2
fooCollection[1] array size = 2
fooCollection[0] ivar = 1
fooCollection[1] ivar = 3 
```

我明白了，因为我将数组对象声明为 class 的对象`Foo`，所以`myBar`在该范围内引用的引用`myBar`将好像它是 a`Foo`并因此解释`thisArray`为等于 2 的大小。我也理解为什么`ivar`会这样。

有没有办法影响类`thisArray`内的大小，`Bar`以便可以在对象数组中识别其“正确”大小`Foo`？我会使用矢量，但它们在 arduino 平台上并不友好。我也可以简单地在 Foo 类中创建大小为 100 的数组，但我试图注意内存分配。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-21T21:11:29.050

您可以模板化您的基类：

```
template <size_t Size>
class FooBase
{
    // etc....
    int thisArray[Size];
};

class Foo : public FooBase<2> { ... };

class Bar : public FooBase<4> { ... }; 
```

当然，这仅适用于所有内容派生的`FooBase`情况——也就是说，您没有派生自`Bar`需要不同数组大小的类。

此外，正如评论中所说，如果您需要将它们保存在数组中，则需要存储指针。

```
Foo myFoo;
Bar myBar;
Foo * fooCollection[] = { &myFoo, &myBar }; 
```

哎呀，我假设它`Bar`来自`Foo`，它不再这样做了。如果您想要一个未模板化的公共基础，您需要`FooBase<Size>`从另一个基础派生模板化类`FooType`，现在使用`FooType`. 我认为这会奏效。

```
class FooType {
  public:
      // etc...
      virtual size_t GetSize() const = 0;
};

template <size_t Size>
class FooBase : public FooType
{
  public:
    // etc...
    virtual size_t GetSize() const { return Size; }

  protected:
    // etc....
    int thisArray[Size];
}; 
```

接着：

```
FooType *fooCollection[] = { &myFoo, &myBar }; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-21T21:06:57.417

您可以将数组定义为指针，然后`new`将其与构造函数和`delete`析构函数一起定义。记住三法则，你会没事的。

除非我完全误解了你对这个程序的意图。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-21T21:17:19.877

当你这样做:`cout << sizeof(fooCollection[n].thisArray)/sizeof(int) << endl;`时，不可能知道 的大小，`thisArray`因为你没有使用实际的多态性。所以编译器假定所有元素`fooCollection`都是简单的`Foo`（静态绑定）。

从使用指针开始：

```
Foo * fooCollection[] = { &myFoo, &myBar }; 
```

**并声明一个虚拟成员，它将在运行时**知道数组的大小。（动态绑定）

```
virtual int size() {return sizeof(thisArray);} 
```

然后重写为：

```
cout << fooCollection[n]->size()/sizeof(int) << endl; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T21:21:13.597

我的意见是不允许基类成为具体类：

1.  让基类成为一个抽象类，为数组提供接口（数组的大小，对数组的读写）。

2.  让数组的构造和销毁由派生类控制。

这样，每个派生类都可以根据需要选择其数组的长度。

代码草图：

```
class foo {
  public:
    virtual size_t array_size() const = 0;
    virtual int *  array_base() const = 0;
    int array_get( size_t index ) const {
      array_verify_index( index );
      return *( array_base() + index );
    }
    void array_set( size_t index, int value ) {
      array_verify_index( index );
      *( array_base() + index ) = value;
    }
  private:
    void array_verify_index( size_t index ) const {
      assert( index < array_size() );
    }
};

class bar : public foo {
  public:    
    bar() {
       array_base = new int[ BarArraySize ];
    }
    ~bar() {
      delete [] array_base;
    }
    virtual size_t array_size() const {
      return BarArraySize;
    }
    virtual int * array_base() const {
      return array_base;
    }
  private:
    int * array_base;
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-10T13:15:06.493

很清楚我迟到了两年，我想添加另一个选项 - 对于那些在没有虚拟方法或新运算符的情况下寻求这个问题的答案的人：

```
class Foo
{
protected:
    // Can only be constructed by Bar, or other derived type.
    Foo(int* _array, size_t _size) :
        array(_array), 
        arraySize(_size)
    {};
private:
    int* array;
    size_t arraySize;
};

template<size_t Size>
class Bar : public Foo
{
public:
    Bar() : Foo(arrayData, Size) {};
private:
    int arrayData[Size];
}; 
```

这允许 Foo 成为多个类的通用“数组”接口，没有虚拟方法和堆栈分配的数组。唯一真正的缺点是我们必须插入 Foo::arraySize，但这仍然是相对较小的成本（32/64 位上的 4/8 字节）。

# perl - 在 foreach 循环中分配一个变量

> ID：14447194
> 
> 赞同：1
> 
> 时间：2013-01-21T21:04:23.630
> 
> 标签：perl

我真的不明白如何将此代码的输出分配给每一行输出的变量或一个大块变量。如果有帮助，我正在使用 Mail::POP3Client。我希望分配一个变量的输出是“ print "$_\n" if /^(From|Subject):/i;"

```
my $count = $pop->Count();
if ($count < 0) {
    print $pop->Message();
} elsif ($count == 0) {
    print "no messages\n";
} else {
    print "$count messsages\n\n";

    for my $i (1 .. $count) {
        foreach ($pop->Head($i)) {
            print "$_\n" if /^(From|Subject):/i;
        }
        print "\n";
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:08:39.537

您有两种选择，具体取决于您希望如何处理数据

定义一个变量并依次附加到它

```
my $from = '';
...
foreach ($pop->Head($i)) {
    $from .= "$_\n" if (/^(From|Subject):/i);
} 
```

这将为您提供一个包含所有`From`s 和`Subject`s 的大字符串。或者你定义一个数组并追加到这个数组的末尾

```
my @from;
...
foreach ($pop->Head($i)) {
    push @from, $_ if (/^(From|Subject):/i);
} 
```

这将产生一个数组，其中每个元素包含一个`From`或`Subject`一行。

根据[Mail::POP3Client](http://search.cpan.org/~sdowd/Mail-POP3Client-2.16/POP3Client.pm)，如果要删除 POP 服务器上的所有邮件

```
for my $i (1 .. $count) {
    $pop->Delete($i);
} 
```

*关闭前*应将所有消息标记为删除。当你最终关闭连接时，

```
$pop->Close(); 
```

将处理所有待处理的删除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T21:07:40.397

事先制作一个数组，称为`@mystuff`. 取而代之的是`print "$_\n" if /^(From|Subject):/i;`，做出来`push(@mystuff, $_) if /^(From|Subject):/i;`。最后，您有一组当前正在 foreach 中打印的内容。

# browser - 使 Chrome/Firefox 重用现有打开的文件

> ID：14447195
> 
> 赞同：0
> 
> 时间：2013-01-21T21:04:37.463
> 
> 标签：browser, emacs

我在 Emacs 中添加了逻辑，以便`browse-url`在完成我编写的特殊构建完成挂钩后自动调用 DMD 生成的 html 文档文件。

为了使它可用，我现在希望此调用*仅在**第*一次调用时打开一个新的浏览器选项卡，*其余*时间仅*重新加载*已显示 doc 文件的选项卡。

这可能吗，最好是在谷歌浏览器中？

我已经扫描了 GC 和 FF 的命令行参数，但一无所获。

我怀疑一些 Javascript/HTML-5 可能会起作用，但我对此一无所知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:33:33.023

对于 Firefox 查看`browse-url-firefox-new-window-is-tab`和/或`browse-url-maybe-new-window`. 您可以从 , 的定义中遵循执行路径`browse-url-default-browser`，所有这些都在`browse-url.el`.

但基本的想法是，您可以只查看如何实现，例如，`browse-url-firefox`编写一个完全符合您要求的程序（以您需要的方式启动 Firefox），然后将其设置为`browse-url-browser-function`. 此变量的值必须是从 调用的函数`browse-url`。

有趣的是（谷歌浏览器中可能有类似的东西），有[MozRepl](http://www.emacswiki.org/emacs/MozRepl)，显然，它将在 Mozilla 浏览器中运行，并且 Emacs 有一个绑定来与这个 REPL（交互式 JavaScript 解释器）对话。使用它，您可以对浏览器的行为进行非常细粒度的控制，包括但不限于创建新的 GUI 组件（使用 XUL）、操作浏览器窗口等。可能取决于您愿意花多少时间在上面。

# php - Paypal Sandbox 定期付款，初始金额待定

> ID：14447200
> 
> 赞同：11
> 
> 时间：2013-01-21T21:04:56.920
> 
> 标签：php, paypal, sandbox

我在[这里](https://github.com/thenbrent/paypal-digital-goods)使用 PHP 库来创建一个新的订阅配置文件。如果我设置了初始金额，配置文件将显示为“待处理”。

例子：

```
Pending
Customer Mark Wally Verified
Profile start date Feb 18, 2013 | Profile ID I-BE824P6F9PER 
```

另一方面，如果我没有设置初始付款金额，则配置文件将是“有效的”。我将初始付款和开始日期设置为未来 1 个月，因为我想按月计费并立即获得付款。

我已经验证过：

*   帐户设置为接受任何货币的资金
*   卖家账户启用了数字商品（通过自动化流程创建）
*   两个帐户均已验证
*   买家账户有信用卡和贝宝余额
*   两个账户都是美国的
*   我尝试了多个帐户

任何帮助将不胜感激！

用于创建使用上面列出的库的订阅的代码片段：

```
$subscription_details = array(
  'description'    => 'Premium membership: $4.95 every 30 days',
  'initial_amount' => '4.95',
  'amount'         => '4.95',
  'period'         => 'Day',
  'start_date'     => gmdate( 'Y-m-d\TH:i:s', strtotime( '+30 day' ) ),
  'frequency'      => '30'
); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-07-29T16:33:15.990

以防万一其他人有这个麻烦，我的发现是：

没有什么可解决的——沙盒真的很慢，有时需要几天时间才能激活配置文件并发送 IPN。换句话说，沙盒根本不适合测试这些功能，只需上线并退还几次测试即可。即使是直播有时也需要一些时间……我见过有时需要几个小时，所以不要发疯。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T17:07:12.143

来自 PayPal doco：

“默认情况下，如果初始支付金额失败，PayPal 不会激活配置文件。要覆盖此默认行为，请将 FAILEDINITAMTACTION 字段设置为 ContinueOnFailure。如果初始支付金额失败，ContinueOnFailure 会指示 PayPal 将失败的支付金额添加到未结余额中在此定期付款资料中到期。

如果您未设置 FAILEDINITAMTACTION 或将其设置为 CancelOnFailure，PayPal 将创建定期付款配置文件。但是，在初始付款完成之前，PayPal 会将配置文件置于待处理状态。如果初始付款清除，PayPal 会通过即时付款通知 (IPN) 通知您它已激活待处理的配置文件。如果付款失败，PayPal 会通过 IPN 通知您已取消待处理的配置文件”

来自[https://cms.paypal.com/mx/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_WPRecurringPayments](https://cms.paypal.com/mx/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_WPRecurringPayments)，就在表 6 下方。

# django - 如何处理 heroku 重命名我的根级应用程序？

> ID：14447202
> 
> 赞同：2
> 
> 时间：2013-01-21T21:05:02.337
> 
> 标签：django, heroku

Heroku 似乎更喜欢部署的应用程序具有一定的结构，主要是 .git 和 manage.py 位于根级别，其他所有内容都低于此级别。

我继承了一个我试图部署用于测试目的的 Django 应用程序，但我认为我无法对其进行重组，所以我想知道我是否有替代方案。

我继承的结构在根文件夹中有大部分文件：

```
./foo: 
  __init__.py, 
  .git, 
  Procfile, 
  settings.py, 
  manage.py, 
  bar/
    models.py, etc 
```

从 foo 我可以运行`python manage.py shell`并在那里`from foo.bar import models`工作。

但是，当我将其推送到 Heroku 时，它会将根放入，`/app`因此`foo`变得不再有效。`app``from foo.bar import models`

是否有任何神奇的设置可以让我表明这`app`是真的`foo`，并允许我在不重构应用程序结构和/或所有导入的情况下继续？

*类似的问题*：我认为我的问题类似于[Heroku - Django: 必须改变每一个提到的内容`myproject`才能`app`让我的网站正常工作。将来如何最好地避免这种情况？](https://stackoverflow.com/questions/11972817/heroku-django-had-to-change-every-mentioning-of-myproject-into-app-to-get)，除了我问我是否可以在不更改站点结构的情况下做任何事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T00:57:26.317

您可以尝试向 manage.py 添加一行来修改 sys.path 以确保它`foo`在您的路径中：

```
import sys

PROJECT_DIR = os.path.abspath(os.path.dirname(os.path.dirname(__file__)))
if PROJECT_DIR not in sys.path:
    sys.path.insert(0, PROJECT_DIR) 
```

尽管作为旁注，让您的顶级目录成为 python 模块并不是很好的 django 风格，正是因为它使部署更加复杂（我不认为上述内容适用于 heroku）。我可能会建议您将代码更改为`bar`直接导入并删除`foo/__init__.py`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T17:38:15.670

最简单的方法是删除`foo/__init__.py`和修改您的 import 语句以 import from`bar`而不是 from `foo`，例如

```
from foo.bar.models import * 
```

变成

```
from bar.models import * 
```

或者，您可以使用[相对导入](http://docs.python.org/2/tutorial/modules.html#intra-package-references)。所以如果你想 import `bar.models`in `bar.views`，你会做

```
from .models import * 
```

这是一个问题的原因是 Django 1.4 更改了新创建项目的文件夹结构。在 1.4 之前，您将拥有与您描述的类似的结构，减号`foo/__init__.py`。Heroku 改编了 Django 1.4 的项目结构，这可以说是更好的，因为它封装了项目中的设置并使其更具可移植性。

# xslt - XSLT 中的除法

> ID：14447205
> 
> 赞同：38
> 
> 时间：2013-01-21T21:05:18.073
> 
> 标签：xslt

我正在尝试从数据库中提取一个值并将其除以 12 并显示该数字，但我似乎无法正确处理。到目前为止，这是我要显示的值：

```
$<xsl:value-of select="format-number(number(//Applications/AveAnnualVolume),'###,###,##0.00')"/> 
```

那部分有效，但我不知道如何将它除以 12 并显示它。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-01-21T21:09:11.687

XPath`div`用于除法，因为斜杠用作分隔符。

```
$<xsl:value-of select="format-number(//Applications/AveAnnualVolume div 12,'###,###,##0.00')"/> 
```

# php - 下载的 WAV 文件无法播放

> ID：14447207
> 
> 赞同：4
> 
> 时间：2013-01-21T21:05:40.040
> 
> 标签：php, wav, download

我正在从我的远程服务器（Centos 5.8）下载一个 WAV 文件。使用以下 PHP 脚本：

```
header('Content-Description: File Transfer');
header('Content-Type: audio/x-wav');
header('Content-Disposition: attachment; filename=' . basename($realLink));
header('Content-Transfer-Encoding: binary');
header('Expires: 0');
header('Cache-Control: must-revalidate');
header('Pragma: public');
header('Content-Length: ' . filesize($realLink));
ob_clean();
flush();
readfile($realLink); 
```

当我尝试使用 Windows Media Player 或 Itunes 播放下载的文件时，它不会播放。即使在我的本地计算机上下载的 WAV 的文件大小与服务器上的文件版本相同，下载文件的属性显示 00:00 长度并且不会播放。此外，如果我使用 ftp 手动下载文件，文件下载和播放也很好。仅当我使用上述脚本下载时才会出现明显的损坏。我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:08:32.360

以下是 WAV 的有效 MIME 类型：

```
audio/vnd.wave
audio/wav
audio/wave
audio/x-wav 
```

你正在使用`application/x-wav`. 请参阅[此处](https://www.rfc-editor.org/rfc/rfc2361)和[此处](http://filext.com/file-extension/WAV)以获取参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-24T20:18:16.420

此代码适用于下载 wav 音频。

```
$ctype ='audio/x-wav'; // file type
$filepath = '/var/www/html/audio.wav';//absolute url
$size = filesize($fichero); // size of file
$name = basename($fichero); // name of file

$fp=fopen($fichero, "rb");
if ($size && $ctype && $fp) {
    header("Pragma: public");
    header("Expires: 0");
    header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
    header("Cache-Control: public");
    header("Content-Description: wav file");
    header("Content-Type: " . $ctype);
    header("Content-Disposition: attachment; filename=" . $name);
    header("Content-Transfer-Encoding: binary");
    header("Content-length: " . $size);
    ob_clean();
    fpassthru($fp);
} 
```

# python - numpy.array() 的简写符号

> ID：14447215
> 
> 赞同：8
> 
> 时间：2013-01-21T21:06:11.967
> 
> 标签：python, numpy

是否有任何公认的速记符号`numpy.array()`？对我来说，与专用数字语言相比，使用 numpy 的最大缺点是没有用于创建数组的紧凑符号。

我典型的详细用法是：

```
import numpy as np
a = np.array([1,2,3]) 
```

任何人都可以提供现有成熟项目中使用的 numpy 数组创建的速记符号示例吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:30:49.937

根据[DSM](https://stackoverflow.com/users/487339/dsm)的评论，这里有一个可能的简写：

可以首先定义以下内容：

```
import numpy as np
class ShorthandArray(object):
    def __getitem__(self, key):
        if isinstance(key, tuple):
            return np.array(key)
        else:
            return np.array([key])

_ = ShorthandArray() 
```

现在可以使用以下方法创建数组：

```
a = _[1,2,3] 
```

这也适用于多维数组：

```
a = _[[1,2,3]] 
```

这当然是紧凑的，但完全是非标准的 python 表示法。括号用于访问项目，而不是用于创建类。我可以看到这可能会造成很大的混乱。

# jboss - JBoss 6 类加载器问题

> ID：14447216
> 
> 赞同：0
> 
> 时间：2013-01-21T21:06:14.310
> 
> 标签：jboss, classloader, jboss6.x

我正在尝试在 JBoss 6 上部署 WAR 应用程序。我收到 LinkageError：

```
java.lang.LinkageError: loader constraint violation: 
when resolving interface method "javax.xml.stream.XMLStreamReader.getName()Ljavax/xml/namespace/QName;" the class loader (instance of org/jboss/classloader/spi/base/BaseClassLoader) of the current class, org/codehaus/xfire/soap/handler/ReadHeadersHandler, 
and the class loader (instance of <bootloader>) for resolved class, javax/xml/stream/XMLStreamReader, have different Class objects for the type javax/xml/namespace/QName used in the signature 
```

所以我正在尝试设置一个类加载器存储库 WEB-INF/jboss-web.xml 文件：

```
<class-loading>
 <loader-repository java2ClassLoadingCompliance="false">
 com.example:archive=unique-archive-name
    <loader-repository-config>java2ParentDelegation=false</loader-repository-config>
 </loader-repository>
</class-loading> 
```

但我仍然遇到同样的错误，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T00:50:51.027

`javax/xml/namespace/QName`这意味着两个不同的类加载器正在加载两个副本。[这个线程](https://stackoverflow.com/questions/244482/how-to-deal-with-linkageerrors-in-java)和[这个](https://stackoverflow.com/questions/3247662/xpath-class-resolution-in-jboss5)线程有几个有用的响应，应该可以帮助您开始弄清楚如何深入挖掘并希望克服这个问题。

# php - 从 ajax 搜索结果中获取选定的内容

> ID：14447217
> 
> 赞同：0
> 
> 时间：2013-01-21T21:06:17.340
> 
> 标签：php, html, ajax, jquery

> **可能重复：**
> [使用 jquery 从搜索结果中添加内容](https://stackoverflow.com/questions/14430105/adding-content-from-search-result-with-jquery)

我正在使用这个不错的脚本[http://qpoit.com/marcofolio_demo/apple_search/](http://qpoit.com/marcofolio_demo/apple_search/)但是我想在 div 中显示选定的值，`$.("#result").html(selectedValue);`但我不知道如何在搜索结果出现后获取选定的值。请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:16:22.807

如果要显示出现在`<span>`标签中的搜索结果的文本：

```
// Place inside the keyup method used for triggering AJAX call
$('#searchresults a').mouseenter(function() {
   $('#result').text($(this).children('.searchheading').text());
}).mouseleave(function() {
   $('#result').text('');
}); 
```

# html - HTML5 + JavaScript - 鼠标定位

> ID：14447221
> 
> 赞同：0
> 
> 时间：2013-01-21T21:06:45.277
> 
> 标签：html, position, mouse

我对 HTML5 很陌生，但我正在学习，而且现在 - 我正在开发一个非常简单的游戏。

我想要做的是让鼠标 X 和 Y 位置与画布相关，并有一个图像跟随鼠标（如十字准线，瞄准）。

但现在，我只想拉鼠标值。

所以，我有一个名为 init 的函数，它初始化所有内容。加载图像精灵时调用它：

```
function init(){
    drawBg();
    startDrawing();

    document.addEventListener('keydown', checkKeyDown, false);
    document.addEventListener('keyup', checkKeyUp, false);

    document.addEventListener('ommousemove', mouseTarget, false);

} 
```

如果 'ommousemove' 是正确的，我不是 100%，不确定我应该放什么。然后我有 mouseTarget 功能：

```
function mouseTarget(e){

    var mouseX;
    var mouseY;

    if(e.offsetX){
        mouseX = e.offsetX;
        mouseY = e.offsetY;
    }
    else if(e.layerX){
        mouseX = e.layerX;
        mouseY = e.layerY;
    }

    console.debug("Mouse X: " +  mouseX + " Mouse Y: " + mouseY);

} 
```

我还有一个名为“draw”的函数，每 5 帧（每次更新）调用一次，所以我假设我需要检查其中的鼠标位置？

```
function draw(){
   mouseTarget();
} 
```

但后来我收到一个错误：未捕获：TypeError：无法读取未定义的属性“offsetX”。我在这里做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:30:46.433

问题（正如您所怀疑的）出在这条线上

```
document.addEventListener('ommousemove', mouseTarget, false); 
```

它应该是

```
document.addEventListener('mousemove', mouseTarget, false); 
```

函数中的`e`参数`mouseTarget`仅包含通过事件调用时的事件信息。在您的情况下，它永远不会通过事件调用，而只能通过`draw`函数调用。

这就是您收到`Cannot read property 'offsetX' of undefined.`错误的原因，因为实际上您正在尝试访问`undefined.offsetX`

您应该做的是将鼠标位置保留在单独的变量中，然后在“绘制”函数中引用它们。

# javascript - 鼠标悬停子菜单时禁用 .slideUp 功能

> ID：14447223
> 
> 赞同：2
> 
> 时间：2013-01-21T21:06:58.180
> 
> 标签：javascript, menu, hover, submenu, slideup

我有一个小问题。我希望当我将鼠标悬停在子菜单上时，当它打开时，子菜单不会折叠。谢谢。

```
$('.navigation').find('ul').parent().addClass('lv2-menu');

    $('.lv2-menu').hover(

        function(){

            el = $(this);

            el.find('ul').stop(false,true).slideDown(1000);

        },
        function(){

            el = $(this);

            el.find('ul').stop(false,true).slideUp(1000);

        }
    )

    $('.navigation').find('.lv2-menu').each(function(){

        el = $(this);

        if(el.find('.current-menu-item').size()){

            el.addClass('show-sub');
            el.find('ul').css({'display':'block'});
        }

    }) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:15:08.477

只需使用`onmouseover`and`onmouseout`事件侦听器。对于该`onmouseover`功能，让元素向下滑动。对于该`onmouseout`功能，让元素向后滑动。

[鼠标移到](http://api.jquery.com/mouseover/)

[鼠标输出](http://api.jquery.com/mouseout/)

# python - 如何解决 strptime() 导致的幼稚 datetime RuntimeWarning？

> ID：14447224
> 
> 赞同：3
> 
> 时间：2013-01-21T21:07:02.937
> 
> 标签：python, django

我正在尝试编码而不在我的控制台中抛出任何警告。到目前为止，我一直很擅长避免这种情况，直到出现这种情况，这对我来说似乎是先有鸡还是先有蛋的情况。

```
from datetime import datetime as dt 

last_contacted = "19/01/2013"
current_tz = timezone.get_current_timezone()
date_time = dt.strptime(last_contacted, get_current_date_input_format(request))
date_time = current_tz.localize(date_time) 
```

第三行是抛出这个警告：

> RuntimeWarning：在时区支持处于活动状态时，DateTimeField 收到了一个幼稚的日期时间 (2013-01-19 00:00:00)。）

这有点奇怪，因为我需要先将 unicode 转换为 datetime，然后才能将 datetime 对象转换为第四行中的 datetime-aware 对象（支持时区）。

专家有什么建议吗？

谢谢

**更新：**

```
def get_current_date_input_format(request):
    if request.LANGUAGE_CODE == 'en-gb':
        return formats_en_GB.DATE_INPUT_FORMATS[0]
    elif request.LANGUAGE_CODE == 'en':        
        return formats_en.DATE_INPUT_FORMATS[0] 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-29T12:45:44.350

从评论到您的问题，我猜您的代码中真正拥有的是这样的：

```
from datetime import datetime as dt 

last_contacted = "19/01/2013"
current_tz = timezone.get_current_timezone()
model_instance.date_time = dt.strptime(last_contacted, get_current_date_input_format(request))
model_instance.date_time = current_tz.localize(date_time) 
```

其中`model_instance`是 Model 的一个实例，它有一个名为 的 DateTimeField `date_time`。

```
class MyModel(models.Model)
    ....
    date_time = DateTimeField() 
```

Python[`datetime.strptime`](http://docs.python.org/2/library/datetime.html#datetime.datetime.strptime)函数返回一个`datetime`您尝试分配给`DateTimeField`它的天真对象，然后生成警告，因为在启用时区支持时使用非天真`datetime`对象不正确。

如果将对`strptime`和的调用组合在`localize`一行上，则在分配到之前完成从幼稚`datetime`转换为非幼稚的完整计算，因此在这种情况下您*不会*收到错误。`datetime``date_time`

 *附加说明：`get_current_date_input_format`如果请求中没有时区，您的函数应返回一些默认时区，否则`strptime`调用将失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:48:43.833

您是否在[设置](https://docs.djangoproject.com/en/dev/ref/settings/#std%3asetting-USE_TZ)文件中打开了 USE_TZ？

```
USE_TZ = True 
```

此外，从[文档](https://docs.djangoproject.com/en/dev/topics/i18n/timezones/#code)中可以采取一些更具体的步骤。*

# c++ - ZXing 库：iOS 中的错误：未使用私有字段“cached_y_”

> ID：14447230
> 
> 赞同：9
> 
> 时间：2013-01-21T21:07:20.147
> 
> 标签：c++, ios, objective-c, zxing

我目前正在尝试将 ZXing 库用于 iOS 项目。但是我什至无法让示例项目工作。

ScanTest 项目以及我自己创建的项目在 BinaryBitmap.cpp 文件中引发以下错误。

```
In file included from /Volumes/Macintosh HD/Users/Tim/Downloads/zxing-2.1/iphone/ZXingWidget/../../cpp/core/src/zxing/BinaryBitmap.cpp:20:
../../cpp/core/src/zxing/BinaryBitmap.h:33:7: error: private field 'cached_y_' is not used [-Werror,-Wunused-private-field]
            int cached_y_;
                ^
1 error generated. 
```

我在 Google 和 Stackoverflow 上进行了搜索，但没有找到解决该问题的方法。

我已经在当前稳定版本的 XCode 和 beta 中进行了尝试。

我不知道其他人是否也遇到了这个问题，但任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-21T21:50:13.787

这是叮当声，对吧？[您可以在此处](http://clang.llvm.org/docs/UsersManual.html#options-to-control-error-and-warning-messages)阅读相关的编译器选项。错误消息告诉您哪些编译器标志是相关的。

`-Wunused-private-field`意味着您会收到有关未在任何地方使用的类（或结构，...）的私有成员字段的警告。警告是因为您可能确实打算使用它们。这通常不会停止编译，但是......

`-Werror`将警告变成错误。很多人使用这个选项来强迫自己编写非常干净的代码。把这个拿出来就够了。

# c# - 将 DataTable 插入到 StoredProcedure 中的表中

> ID：14447237
> 
> 赞同：2
> 
> 时间：2013-01-21T21:07:53.920
> 
> 标签：c#, sql, sql-server-2008, stored-procedures, datatable

这是我的`DataTable`样子（2列：`Name`和`Code`）：

**`Name Code`**

```
name1 code1
name2 code2
name3 code3 
```

我想将它插入`DataTable`到一个名为的现有表中，该表`MyTable`具有一个主键和这 2 列。

我真的不知道我应该如何开始编写我的存储过程，有没有办法发送参数 a`DataTable`或类似的东西？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:14:35.013

在 SQL-Server 2008 中，您可以使用[表值参数](http://msdn.microsoft.com/en-us/library/bb675163.aspx)。像这样的东西：

```
CREATE TYPE dbo.MyTableType AS TABLE 
(   Name    VARCHAR(5),
    Code    VARCHAR(5)
);
GO;
CREATE PROCEDURE dbo.MyProcedure (@MyTableType dbo.MyTableType READONLY)
AS
    INSERT dbo.MyTable (Name, Code)
    SELECT Name, Code
    FROM    @MyTableType;

GO; 
```

然后只需将您的数据表作为 SqlCommand 中的参数 (SqlDbType.Structured) 的值传递。

或者您可以使用 SQLBulkInsert 并绕过存储过程。

# scala - 如何修改包含 Sets 的 Map 的值，返回一个新的 Map？

> ID：14447242
> 
> 赞同：1
> 
> 时间：2013-01-21T21:08:25.450
> 
> 标签：scala, functional-programming, immutability

给定 a `Map[Int, Set[Int]]`，我如何修改 Map 的单个值，在此过程中生成一个新值，例如：

```
val x = Map(1 -> Set(1,2,3))
x(1) + 5 // This creates a new Set, but not a new Map

val y = x(1) change { x => x + 5 }
// The previous functionality is what I'm looking for
// z: Set[Int]] = List(Set(1, 2, 3, 5)) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T22:21:40.543

正如 Robin Green 所说，镜头是为这项工作而制造的。事实上，您需要一个局部镜头，因为地图是键 -> 值的局部函数。

Scalaz 7 包含将`mapVPLens`部分镜头 ( `PLens`) 设置为所选键处的值的功能：

```
import scalaz.PLens._
val x = Map(1 -> Set(1,2,3))

mapVPLens(1) mod ((_: Set[Int]) + 5, x) // Map(1 -> Set(1, 2, 3, 5)) 
```

修改不存在键的值将无效：

```
mapVPLens(9) mod ((_: Set[Int]) + 5, x) // Map(1 -> Set(1,2,3)) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-21T22:02:11.943

在 Scala 2.10 中：

```
implicit class ChangeableMap[K,V]( val m: Map[K,V] ) extends AnyVal {
  def change( k: K )( transform: V => V ): Map[K,V] = {
    m.get( k ).map{ v => m + (k-> transform(v)) }.getOrElse( m )
  }
} 
```

一些测试：

```
scala>val x = Map(1 -> Set(1,2,3), 2 -> Set(4,5))
x: scala.collection.immutable.Map[Int,scala.collection.immutable.Set[Int]] = Map(1 -> Set(1, 2, 3), 2 -> Set(4, 5))
scala> x.change(1) { x => x + 5 }
res1: Map[Int,scala.collection.immutable.Set[Int]] = Map(1 -> Set(1, 2, 3, 5), 2 -> Set(4, 5)) 
```

如果您使用的是 scala 2.9，则可以：

```
class ChangeableMap[K,V]( m: Map[K,V] ) {
  def change( k: K )( transform: V => V ): Map[K,V] = {
    m.get( k ).map{ v => m + (k-> transform(v)) }.getOrElse( m )
  }
}
implicit def toChangeableMap[K,V]( m: Map[K,V] ) = new ChangeableMap[K,V]( m ) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-21T21:19:44.667

使用镜头！

但是，定义镜头的 Scalaz 6 没有针对您的情况的特定预制镜头，这意味着您需要做更多的工作 - 尽管如果您的地图反过来包含在另一个对象中，它确实有[（隐藏得很好) 支持这种情况](https://github.com/scalaz/scalaz/blob/master/core/src/main/scala/scalaz/Lens.scala#L236)。Scalaz 7 将配备独立地图的镜头。

此外，镜头只是成对的功能，不需要语言支持，因此您可以自己滚动。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T21:08:25.450

解决此问题的一种非常惯用的方法如下（感谢[Viktor Klang](https://groups.google.com/d/msg/scala-user/-PLq3jCJL0k/Ja8G8wN23SwJ)）：

```
val x = Map(1 -> Set(1,2,3), 2 -> Set(1), 3 -> Set(5))
x.map { case (1, v) => (1, v + 5); case x => x }
// res0: Map(1 -> Set(1, 2, 3, 5)) 
```

或者很好地打包成一个类以及一个隐式：

```
class ChangeableMap[K,V](map:Map[K,V]) {
    def change(index:K)(f:V => V) = map.map {
        case (`index`, v:V) => (index, f(v))
        case x => x
    }
}

object ChangeableMap {
    implicit def fromMap[K,V](map:Map[K,V]) = new ChangeableMap(map)
} 
```

使用先前的声明，以下将起作用：

```
x.change(1) { x => x + 5 }
x.change(1) { _ + 5 }
// res1:  Map(1 -> Set(1, 2, 3, 5)) 
```

**请注意，这可能不是最快的解决方案，因为 Scala 将（可能尚未确认）迭代整个地图！**

一个可能更快的实现如下（尽管我还没有验证它是否真的更快）：

```
class ChangeableMap[K,V](map:Map[K,V]) {
    def change(index:K)(f:V => V) = map.get(index) match {
        case Some(x) => map + ((index, f(x)))
        case None => map
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-21T21:14:35.500

这是我们代码库中的一个。

```
/**
 * Alters a value in a map.
 *
 * modifyMap :: Map k v -> k -> (Maybe v -> Maybe v) -> Map k v
 * See Haskell's Data.Map.alter
 *
 * @param m   the map to modify
 * @param key the key to modify the value of
 * @param mod a function that takes the existing value (if any) and returns an optional new value
 *
 * @return the modified map
 */
def modifyMap[K,V](m: Map[K,V], key: K)
                  (mod: (Option[V] ⇒ Option[V])): Map[K,V] = {
  mod(m.get(key)) match {
    case Some(newVal) ⇒ m + (key → newVal)
    case None ⇒ m - key
  }
} 
```

以下是你如何使用它：

```
modifyMap(myMap, "someKey") { 
  case Some(someVal) => 
    // present
    if (condition) 
      Some(valueDerivedFrom(someVal)) // provide a new mapping for someKey
    else 
      None // someKey will now be unset
  case None => 
    // wasn't present
    if (condition)
      Some(newValue) // provide a new value for someKey
    else
      None // leave someKey unset
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-22T09:20:45.883

我认为最简单的方法是使用`scala.collection.mutable.Map`.

```
import scala.collection.mutable.Map

val m = Map(1 -> Set(1,2,3))
m.update(1, m(1) + 5)
// now the Map looks like this: Map(1 -> Set(1,2,3,5)) 
```

如果你得到一个不可变的 Map，你可以简单地将它转换为一个可变的，方法是：

```
val n: collection.mutale.Map(m.toSeq: _*) 
```

如果您需要返回不可变的 Map，这也适用于其他方式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-12T11:01:40.077

如前所述，您可以使用 Partial Lens 来解决此类问题，[scalaz](https://github.com/scalaz/scalaz)和[Monocle](https://github.com/julien-truffaut/Monocle)实现了它。以下是使用 Monocle 的方法：

```
import monocle.syntax.taversal._ // to use |->>
import monocle.syntax.at._       // to use at

val x = Map(1 -> Set(1,2,3))

x |->> at(1) modify(_ + 5) == Map(1 -> Set(1,2,3,5)) 
```

# jquery - 如何在没有任何效果的情况下使用 jquery ui 的 show 方法？

> ID：14447250
> 
> 赞同：-3
> 
> 时间：2013-01-21T21:08:41.377
> 
> 标签：jquery, jquery-ui

我需要页面上的 jQuery-UI，因为我正在使用可拖动和其他功能。jQuery-UI 覆盖了`.show()`jQuery 的方法。它迫使我至少指定一个代表效果的参数。但我想使用`.show()`没有任何参数和任何效果的方法，就像在 jQuery 中一样简单。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:17:48.753

尝试这个：

```
show: {
    show: null;
} 
```

> “如果值为 false，则不会出现动画，元素将立即显示。”

取自：http: [//jqueryui.com/upgrade-guide/1.9/#added-_show-and-_hide-methods-to-support-show-and-hide-options](http://jqueryui.com/upgrade-guide/1.9/#added-_show-and-_hide-methods-to-support-show-and-hide-options)

# iphone - 为什么 Xcode 成功构建和复制我的应用程序，但不会启动它？

> ID：14447267
> 
> 赞同：3
> 
> 时间：2013-01-21T21:10:02.250
> 
> 标签：iphone, ios, xcode

在 Xcode 4.5.2 上开发 iPhone 应用程序。设备：iPhone 4。

我正在准备我的申请，以便通过 testflight 将其发送给某人。我为此创建了一个分发配置文件和证书。我这样做了：[https ://stackoverflow.com/a/11917884/555690](https://stackoverflow.com/a/11917884/555690)

无论如何，最近，Xcode 无法启动我的项目。当我按下运行时，它会成功构建文件并将其复制到设备，但是在尝试启动它时，它会发送错误：

> 启动远程程序时出错：没有这样的文件或目录（/Users/Me/Library/Developer/Xcode/DerivedData/MyGame-xxxxxxxxxxxxxxx/Build/Products/Debug-iphoneos/MyGame.app/MyGame）。

我不确定为什么会这样。

一个非常相似的问题是：[Xcode 成功构建了我的目标，但没有运行产品](https://stackoverflow.com/questions/8244953/xcode-successfully-builds-my-target-but-does-not-run-the-product)，但是，它似乎更面向 OSX 而不是 iOS，并且那里的解决方案也没有帮助我。另外，我确实收到了错误（他没有收到错误）。

如果我在设备中运行应用程序（没有 Xcode），它工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:38:21.977

是的，这在新的 Xcode 中经常发生。

一种可行的方法是：

*   断开设备与计算机的连接
*   从设备中删除应用程序
*   重置设备

*   退出xcode（不仅仅是关闭项目，退出程序）

*   在 Finder 中转到 ~/Library/Developer/Xcode/DerivedData （库文件夹已隐藏：您可以打开 Finder->Go->Go to Folder...）

*   删除那里的所有子文件夹

*   清空垃圾

*   重新连接设备

*   打开项目

*   现在您应该可以再次在设备上运行该应用程序了

# ruby - 无法在 Ubuntu 中安装 therubyracer-heroku

> ID：14447269
> 
> 赞同：1
> 
> 时间：2013-01-21T21:10:24.383
> 
> 标签：ruby, ubuntu, heroku, rubygems, therubyracer

我无法在 Ubuntu 12.04 中安装 therubyracer-heroku。我在互联网上的一两个其他地方看到过这个错误，但没有解决方案。我运行的命令是：

```
sudo gem install therubyracer-heroku -v '0.8.1.pre3' 
```

输出很长，这些是最后几行（包含错误）：

```
src/bootstrapper.cc: In static member function 'static bool v8::internal::Genesis::CompileScriptCached(v8::internal::Vector<const char>, v8::internal::Handle<v8::internal::String>, v8::internal::SourceCodeCache*, v8::Extension*, v8::internal::Handle<v8::internal::Context>, bool)':
src/bootstrapper.cc:1002:18: error: variable 'result' set but not used [-Werror=unused-but-set-variable]
src/bootstrapper.cc: In member function 'bool v8::internal::Genesis::InstallNatives()':
src/bootstrapper.cc:1227:24: error: variable 'name' set but not used [-Werror=unused-but-set-variable]
cc1plus: all warnings being treated as errors
scons: *** [obj/release/bootstrapper.o] Error 1
scons: building terminated because of errors.
make: *** [build/v8/libv8.a] Error 2
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --without-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=/usr/bin/ruby1.8
extconf.rb:9: Error compiling V8 (RuntimeError) 
```

请帮忙！谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T05:37:16.620

缺口，

therubyracer-heroku 和 therubyracer 版本 0.8.1 是古老的。请尝试使用最新版本的 therubyracer 的普通版本，当前版本为 0.11.3

```
gem install therubyracer 
```

或者，如果您觉得必须坚持使用特定版本

```
gem install therubyracer -v 0.11.3 
```

# css - 垂直居中 div，但也有 20px 边距顶部和底部

> ID：14447271
> 
> 赞同：0
> 
> 时间：2013-01-21T21:10:43.680
> 
> 标签：css

我如何将模态窗口垂直居中，同时与顶部和底部的边缘保持 20px 的距离？

这是我目前拥有的：

```
#colorbox, #cboxWrapper{position:absolute; top:20px; bottom:20px; left:0; z-index:9499;} 
```

它在顶部创建了 20px 的边距，但在底部没有。这是为什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:38:39.427

小提琴：http: [//jsfiddle.net/BZKHq/1/](http://jsfiddle.net/BZKHq/1/)

的HTML：

```
<p>Lorem or whatever makes your ipsum dolorful Lorem or whatever makes your ipsum dolorful Lorem or whatever makes your ipsum dolorful Lorem or whatever makes your ipsum dolorful Lorem or whatever makes your ipsum</p>

<div id="overlay">Lorem ipsum and stuff...</div> 
```

CSS

```
#overlay {
    color:white;
    background-color: black;
    position:absolute;    /* <<<--- The trick starts here ---<<< */
    bottom:0;
    top:0;
    left:0;
    right:0;
    margin:20px;    /* <<<--- The trick ends here ---<<< */
    padding:20px;
    z-index: 10000;
} 
```

# sql - 根据行是否存在更新或插入数据

> ID：14447274
> 
> 赞同：1
> 
> 时间：2013-01-21T21:11:05.320
> 
> 标签：sql, sql-server-2005

我有一组从 Web 服务获得的行。其中一些行将被插入，一些是对现有行的更新。除非我对表中的 ID 进行查询，否则无法判断。如果我找到它，然后更新。如果我不这样做，那么插入。

```
Select @ID from tbl1 where ID = @ID

IF @@ROWCOUNT = 0
BEGIN
Insert into tbl1
values(1, 'AAAA', 'BBBB', 'CCCC', 'DDD')
END
ELSE
BEGIN
UPDATE tbl1
SET 
A = @AAA,
B = @BBB,
C = @CCC,
D = @DDD
WHERE ID = @ID
END 
```

我试图找出将这些行更新/插入表中的最有效方法，而无需一次将它们传递到存储过程中。

**更新 1**

我应该提到我正在使用 SQL Server 2005。此外，如果我有 300 条记录，我不想进行 300 次存储过程调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:21:55.903

最有效的方法是首先尝试更新表，如果它返回 0 行更新然后只做插入。例如。

```
UPDATE tbl1
    SET 
    A = @AAA,
    B = @BBB,
    C = @CCC,
    D = @DDD
    WHERE ID = @ID    
IF @@ROWCOUNT = 0
    BEGIN
    Insert into tbl1
    values(1, 'AAAA', 'BBBB', 'CCCC', 'DDD')
    END
    ELSE
    BEGIN

END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:16:13.493

与其先支付搜索费用，然后使用另一个搜索进行更新，不如继续尝试更新。如果更新没有找到任何行，您仍然只支付了一次查找费用，并且不必引发异常，但您知道可以插入。

```
UPDATE dbo.tbl1 SET 
A = @AAA,
B = @BBB,
C = @CCC,
D = @DDD
WHERE ID = @ID;

IF @@ROWCOUNT = 0
BEGIN
  INSERT dbo.tbl1(ID,A,B,C,D)
    VALUES(@ID,@AAA,@BBB,@CCC,@DDD);
END 
```

你也可以看看，`MERGE`但我回避这个，因为（a）语法令人生畏，（b）有很多错误，其中一些仍未解决。

~~当然，您应该使用表值参数，而不是一次执行一个@ID。~~

 ~~```
CREATE TYPE dbo.tbl1_type AS TABLE
( 
  ID INT UNIQUE,  
  A <datatype>,
  B <datatype>,
  C <datatype>,
  D <datatype>
); 
```~~ 

现在您的存储过程可以如下所示：

```
CREATE PROCEDURE dbo.tbl1_Update
  @List AS dbo.tbl1_type READONLY
AS
BEGIN
  SET NOCOUNT ON;

  UPDATE t 
    SET A = i.A, B = i.B, C = i.C, D = i.D
  FROM dbo.tbl1 AS t
  INNER JOIN @List AS i
  ON t.ID = i.ID;

  INSERT dbo.tbl1
  SELECT ID, A, B, C, D
    FROM @List AS i
    WHERE NOT EXISTS 
    (
      SELECT 1
      FROM dbo.tbl1 WHERE ID = i.ID
    );
END
GO 
```

~~现在，您可以将 DataTable 或其他 C# 集合作为单个参数直接传递到过程中。~~

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T21:13:47.893

从您从服务器获得的行集合中找出哪些已经存在：

```
select @id from tbl1 where id in (....) 
```

然后你有一个在表中的 id 列表和一个不在表中的 id 列表。然后您将有 2 个批处理操作：一个用于更新，另一个用于插入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T21:21:56.830

我的理解是这样的：

在前端你发出一条 sql 语句

```
ArrayofIDsforInsert = select ID from tbl1 where ID not in ( array of ids at the front end)
ArrayofIDsforUpdate = (IntialArrayofids at frontend) - (ArrayofIdsforInsert) 
```

一张插入表格，一张更新表格...

```
now call the insert into table with ArrayofIds for insert
call the update table with ArrayofIds for update.. 
```

# ruby-on-rails - 避免在多个条件where子句中两次搜索数据库

> ID：14447276
> 
> 赞同：1
> 
> 时间：2013-01-21T21:11:12.360
> 
> 标签：ruby-on-rails, arrays, where, multiple-conditions

我想知道Rails是否有魔法可以避免在以下情况下两次搜索数据库：

背景：我正在搜索来自用户的订单，这些订单要么是 PENDING 要么 SENT 并且今天到期。

这是伪代码：

```
order_array = Order.where(:filled => pending) || Order.where(:fileld => done, :due => today) 
```

现在的问题是这会搜索数据库两次。我想在一次搜索中做到这一点，并希望得到有关 RoR 如何做到这一点的指针。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:12:36.703

我认为这就是你要找的：

```
order_array = Order.where("filled = 'PENDING' OR (filled = 'SENT' AND due BETWEEN ? AND ?)", Time.zone.now.beginning_of_day, Time.zone.now.end_of_day) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-24T12:13:52.607

尝试如下链条件 -

```
Customer.where(:reseller_id => :map_reseller_id).where(:is_deleted_by_reseller => false) 
```

# html - vb.net 登录网站

> ID：14447279
> 
> 赞同：1
> 
> 时间：2013-01-21T21:11:18.160
> 
> 标签：html, vb.net

我正在尝试`Rueters.com`通过我的 VB.net 程序登录。到目前为止，我的代码一直有效，直到我单击“登录”按钮。没有发生错误，但它也没有登录。我究竟做错了什么？提前感谢您的帮助。

```
Public Class Form1
Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    WebBrowser1.Navigate("https://commerce.us.reuters.com/login/pages/login/login.do?backUrl=http%3A%2F%2Fwww.reuters.com%2F&backParameterEncoded=false&source=portfolio&flow=PORTFOLIO&entry_source=registration")
End Sub

Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click
    WebBrowser1.Document.GetElementById("loginName").SetAttribute("value", "username")
    WebBrowser1.Document.GetElementById("password").SetAttribute("value", "password")

    Dim allelements As HtmlElementCollection = WebBrowser1.Document.All

    For Each webpageelement As HtmlElement In allelements

        If webpageelement.GetAttribute("class") = "button" Then

            webpageelement.InvokeMember("click")

        End If

    Next
End Sub 
```

**抱歉，我忘了包含 HTML！这里是：**

```
<div class="label">
    Email</div>
  <div class="textfield">
    <input type="text" size="40" maxlength="100" name="loginName" value="username" />
  </div>
  <div class="label">
    Password</div>
  <div class="textfield">
    <input type="password" value="" size="40" maxlength="20" name="password" />
  </div>

  <div class="checkbox">
    <input type="hidden" value="true" name="flag" /> 
    <input type="checkbox" onclick="if(this.checked) this.form.flag.value='true'; else this.form.flag.value='false';" id="RememberCredentialsCBID" checked="checked" /> 
    <label class="label"  for="RememberCredentialsCBID">Remember me on this computer</label>
  </div>
  <div id="loginErr" class="label error">
  </div>  
  <div class="submit">
    <div class="button"><input type="image" src="/resources_v2/images/btn_sign_in.gif" />
  </div>
</div>
<div class="textfield">
       <a href="/login/restorePassword">Forgot your password?</a>
     </div>
  </form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:10:43.923

怎么样：

```
WebBrowser1.Document.GetElementById("loginName").SetAttribute("value", "username")
    WebBrowser1.Document.GetElementById("password").SetAttribute("value", "password")

    Dim allelements As HtmlElementCollection = WebBrowser1.Document.All

    For Each webpageelement As HtmlElement In allelements

        If webpageelement.GetAttribute("type") = "image" Then
            If webpageelement.GetAttribute("src") = "https://commerce.us.reuters.com/resources_v2/images/btn_sign_in.gif" Then

                webpageelement.InvokeMember("click")

            End If
        End If

    Next 
```

# reporting-services - 报表服务器中的字段未显示

> ID：14447280
> 
> 赞同：0
> 
> 时间：2013-01-21T21:11:24.400
> 
> 标签：reporting-services, ssrs-2008, business-intelligence, reportserver

我在 BID 中做了一些报告，一切正常 [http://imgur.com/QNletGQ](http://imgur.com/QNletGQ) 但是当我将它们部署到我们的报告服务器时，随机字段不包含任何值 [http://imgur.com/BcnTMHu](http://imgur.com/BcnTMHu)在这种情况下'claimstatusprogkey'

有没有人知道这是怎么回事？我不确定问题可能出在哪里或真的如何开始诊断问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T02:21:02.753

我怀疑您的数据源定义在 BIDS 和 Report Manager 之间有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T14:55:00.187

我使用相同的存储过程重新创建了数据集，瞧。我确实更改了存储过程并刷新了数据集中的字段，无论出于何种原因它都没有更新。现在我得到了我所期望的。谢谢

# javascript - 主干视图 el 作为表格列

> ID：14447283
> 
> 赞同：3
> 
> 时间：2013-01-21T21:11:51.127
> 
> 标签：javascript, backbone.js, backbone-views

有没有人使用 Backbone.js 使用垂直表列作为视图“el”取得任何成功？由于表是基于行的，因此使用表行作为与视图关联的 DOM 容器很简单。但是，我需要实现的布局是垂直的，因此表格列将是我设计的“el”，但表格列没有类似的容器元素，因为表格布局是水平的。

到目前为止，我还不能成功地为表列创建子视图，这意味着我将数据绑定到我的 DOM 以便检索和操作表列。我的设计变得更加复杂，这导致我重新评估原始方法，希望有更好的方法通过子视图来管理这种情况。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T17:25:13.597

您可以利用以下事实

*   jQuery 对象是 DOM 元素的列表
*   Backbone 不需要唯一的 DOM 节点（至少据我所知）
*   `this.$el`然后在视图中可以是您想要的任何节点

考虑到这一点，您可以一次性渲染您的表格（请参阅[BackboneJS 渲染问题](https://stackoverflow.com/questions/12004534/backbonejs-rendering-problems/12006179#12006179)，它更快，在您的情况下可能更容易），然后将您的子视图应用于与模型关联的表格单元格。我使用了一个类名进行选择，但是每行的第 n 个元素上的选择器应该可以工作。

*模板*

```
<table>
    <thead>
        <tr>
            <th></th>
            <% _(children).each(function(model) { %>
                <th><%= model.id %></th>                
            <% }); %>
        </tr>
    </thead>
    <tbody>
    <% _(properties).each(function(prop) { %>
        <tr>
            <td><%= prop %></td>
            <% _(children).each(function(model) { %>
                <td class="<%= model.cid %>"><% print(model[prop]); %></td>
            <% }); %>
        </tr>
    <% }); %>
    </tbody>
 </table> 
```

*看法*

```
ListView = Backbone.View.extend({
    initialize: function(opts) {
        this.options = opts;
    },
    render: function () {
        var data, html, $table, template = this.options.template;

        data = this.collection.map(function (model) {
            return _.extend(model.toJSON(), {
                cid: model.cid
            });
        });

        html = this.options.template({
            children: data,
            properties: ['id', 'name']
        });

        $table = $(html);

        this.collection.each(function (model, ix) {
            var $el = $table.find("." + model.cid),
                subview = new ItemView({
                    el: $el,
                    model: model
                });
        });

        this.$el.empty();
        this.$el.append($table);

        return this;
    }
}); 
```

正如您可以在此演示[http://jsfiddle.net/nikoshr/psasT/12/](http://jsfiddle.net/nikoshr/psasT/12/)中查看的那样，每一列都由专用视图处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T16:51:27.870

我想不出一个直接解决您问题的方法。让多个视图共享`<table>`元素`el`听起来像是一场潜在的噩梦。

如何从不同的角度解决问题，而不是使用 HTML 表格，用浮动`<div>`元素构建表格列，并将视图绑定到这些元素？就像是：

```
<div class="faux-table">
  <div class="faux-column">
    <div class="faux-header">Col 1</div>
    <div>Foo</div>
    <div>Bar</div>
    <div>Baz</div>
    <div>Qux</div>
  </div>
  <div class="faux-column">
    <div class="faux-header">Col 2</div>
    <div>Foo</div>
    <div>Bar</div>
    <div>Baz</div>
    <div>Qux</div>
  </div>
</div> 
```

还有一个 CSS 规则：

```
.faux-table > div.faux-column {
    float:left;
} 
```

[这个小提琴](http://jsfiddle.net/u4ByT/)中的一个工作样本。这个解决方案当然远非完美，因为如果你有可变大小的内容，你必须自己实现行大小。但是如果你需要获取 Backbone 视图渲染的表格，从 JS 的角度来看，这可能是最简单的方法。

**编辑：**实际上，在我看来，一个更好且不那么脆弱的解决方案是使用表格`<td>`元素作为列，并将行实现为`<div>`s 而没有任何 CSS 浮动黑客：

```
<table>
    <tr>
        <td class="faux-column">
            <div class="faux-header">Col 1</div>
            <div>Foo</div>
            <div>Bar</div>
            <div>Baz</div>
            <div>Qux</div>
        </td>
        <td class="faux-column">
            <div class="faux-header">Col 2</div>
            <div>Foo</div>
            <div>Bar</div>
            <div>Baz</div>
            <div>Qux</div>
        </td>
    </tr>
</table> 
```

[此小提琴中的修订版](http://jsfiddle.net/u4ByT/1/)。

# google-chrome - 当用户来自谷歌浏览器应用程序图标时如何设置引用者？

> ID：14447291
> 
> 赞同：0
> 
> 时间：2013-01-21T21:12:27.063
> 
> 标签：google-chrome, chromium, http-referer

我有一个 chrome 应用程序，它基本上只是一个视觉书签，可以将访问者发送到我的网站。

目前它没有显示任何推荐人，因为从技术上讲，用户直接访问了该网站。

有没有办法检测到这一点？

我知道我可以在 chrome 应用程序的 URL 中附加一些查询参数，但我想知道是否有比这更干净的解决方案。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-08-16T23:22:58.150

chrome.webRequest 属性应该允许您设置所需的信息。我找不到有帮助的确切细节，但有一个 Auth 选项，您可以将其用作推荐人。

希望这可以帮助。对不起，我无法提供进一步的帮助。

[https://developer.chrome.com/extensions/webRequest.html](https://developer.chrome.com/extensions/webRequest.html)

# jquery - 使用带有 jQ uery 验证的自定义 CSS？

> ID：14447295
> 
> 赞同：-1
> 
> 时间：2013-01-21T21:12:43.363
> 
> 标签：jquery, css, validation, jquery-validate

如何为错误消息使用自定义 CSS 类？我宁愿不设置标准 label.error 的样式。我想使用我已经拥有的 CSS 类。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T22:09:10.647

[jQuery Validate](http://docs.jquery.com/Plugins/Validation/validate#toptions)有一个选项，称为`errorClass`：

> 使用此类创建错误标签，查找现有错误标签并将其添加到无效元素。

您需要做的就是在原始`$.validate`调用中指定它：

```
$('#myForm').validate({
   errorClass:'myClass'
   //your options
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-21T22:02:49.807

你可以这样做：

html:

```
<form action="">
    <ul>
        <li><input type="text" id="name" value="Your name" /></li>
        <li><input type="submit" id="submit" /></li>
        <li class="error">
            <span>Ops!</span>
        </li>
    </ul>
</form> 
```

CSS：

> 形式 .error {显示：无；}

jQuery：

```
$('form').submit(function(){
    if($('#name').val()==''||$('#name').val()=='Your name'){
        $('form .error').css({display: 'block'});
    }
}) 
```

# asp.net-mvc - ASP.NET MVC 4，如何在将视图模型对象用作操作方法参数之前访问/修改视图模型对象（并更改视图和操作方法）？

> ID：14447297
> 
> 赞同：4
> 
> 时间：2013-01-21T21:12:46.973
> 
> 标签：asp.net-mvc, asp.net-mvc-4, model-binding

ASP.NET MVC（MVC4）中是否有任何有用的钩子可以让您在调用操作方法之前访问操作方法参数（视图模型），然后（例如，取决于您在操作方法中检查的值）参数）让您阻止调用操作方法，即，将视图模型对象（操作方法参数）转发到另一个操作方法或直接转发到某个视图（即在操作方法中没有任何进一步处理）？

如果您不理解这个问题，请参阅下面的代码示例，它应该说明我正在寻找的代码类型......（虽然我不知道是否真的存在这种接口以及将实现挂钩的可能性MVC 框架）

如果这确实是可能的，我希望看到一个关于如何做到这一点的代码示例的答案（而不仅仅是一个声称“尝试使用方法'ActionFilterAttribute.OnActionExecuting'或'IModelBinder.BindModel'”的人的回应，因为我已经尝试过这些并且无法使其工作）。另外，请尊重我不希望这个帖子成为关于*为什么*这样做的讨论，而是想看看*如何*去做。（即，我对与诸如“您实际上想要实现的目标是什么？”或“做您想做的事情可能有更好的事情……”之类的回答进行讨论不感兴趣）

这个问题可以分成三个子问题/代码示例，因为下面我自己的代码示例试图说明：（但希望它们“重构”为使用真实现有类型的真实代码）（显然，下面的每个类型都包含子字符串*“*有些”是我编造的，正在寻找对应的实物……）

(1) 在使用视图模型对象参数调用实际操作方法之前，如何在通用位置访问（并可能修改）视图模型对象（操作方法参数）的示例。

我正在寻找的代码示例可能与下面类似，但不知道要使用哪种接口以及如何注册它才能执行以下操作：

```
public class SomeClass: ISomeInterface { // How to register this kind of hook in Application_Start ?
  public void SomeMethodSomewhere(SomeActionMethodContext actionMethodContext, object actionMethodParameterViewModel) {
    string nameOfTheControllerAboutToBeInvoked = actionMethodContext.ControllerName;
    string nameOfTheActionMethodAboutToBeInvoked = actionMethodContext.MethodName;
    // the above strings are not used below but just used for illustrating that the "context object" contains information about the action method to become invoked by the MVC framework
    if(typeof(IMyBaseInterfaceForAllMyViewModels).IsAssignableFrom(actionMethodParameterViewModel.GetType())) {
        IMyBaseInterfaceForAllMyViewModels viewModel = (IMyBaseInterfaceForAllMyViewModels) actionMethodParameterViewModel;
        // check something in the view model:
        if(viewModel.MyFirstGeneralPropertyInAllViewModels == "foo") {
            // modify something in the view model before it will be passed to the target action method
            viewModel.MySecondGeneralPropertyInAllViewModels = "bar";
        }
    }
  }
} 
```

(2) 如何阻止目标动作方法被执行而调用另一个动作方法的示例。该示例可能是上述示例的扩展，如下所示：

```
 public void SomeMethodSomewhere(SomeActionMethodContext actionMethodContext, object actionMethodParameterViewModel) {
        ... same as above ...
        if(viewModel.MyFirstGeneralPropertyInAllViewModels == "foo") {
            actionMethodContext.ControllerName = "SomeOtherController";
            actionMethodContext.MethodName = "SomeOtherActionMethod";
            // The above is just one example of how I imagine this kind of thing could be implemented with changing properties, and below is another example of doing it with a method invocation:
            SomeHelper.PreventCurrentlyTargetedActionMethodFromBecomingExecutedAndInsteadExecuteActionMethod("SomeOtherController", "SomeOtherActionMethod", actionMethodParameterViewModel);
            // Note that I do _NOT_ want to trigger a new http request with something like the method "Controller.RedirectToAction"
        } 
```

(3) 示例如何阻止执行正常的操作方法，而是将视图模型对象直接转发到视图而不进行任何进一步处理。

该示例将是上述第一个示例的扩展，如下所示：

```
 public void SomeMethodSomewhere(SomeActionMethodContext actionMethodContext, object actionMethodParameterViewModel) {
        ... same as the first example above ...
        if(viewModel.MyFirstGeneralPropertyInAllViewModels == "foo") {
            // the below used razor view must of course be implemented with a proper type for the model (e.g. interface 'IMyBaseInterfaceForAllMyViewModels' as used in first example above)
            SomeHelper.PreventCurrentlyTargetedActionMethodFromBecomingExecutedAndInsteadForwardViewModelToView("SomeViewName.cshtml", actionMethodParameterViewModel);
        } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T21:38:01.840

您可以使用操作过滤器并覆盖`OnActionExecuting`事件：

```
public class MyActionFilterAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        ...            
    }
} 
```

现在让我们看看您可以从`filterContext`传递给此方法的参数中提取哪些有用信息。您应该寻找的属性被称为[`ActionParameters`](http://msdn.microsoft.com/en-us/library/system.web.mvc.actionexecutingcontext.actionparameters%28v=vs.98%29.aspx)并代表一个`IDictionary<string, object>`. 顾名思义，此属性包含按名称和值传递给控制器​​操作的所有参数。

因此，假设您有以下控制器操作：

```
[MyActionFilter]
public ActionResult Index(MyViewModel model)
{
    ...
} 
```

以下是在模型绑定后如何检索视图模型的值：

```
public class MyActionFilterAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        var model = filterContext.ActionParameters["model"] as MyViewModel;
        // do something with the model
        // You could change some of its properties here
    }
} 
```

现在让我们看看你问题的第二部分。如何使控制器动作短路并重定向到另一个动作？

这可以通过为属性赋值来完成`Result`：

```
public class MyActionFilterAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext) 
    {
        ... some processing here and you decide to redirect:

        var routeValues = new RouteValueDictionary(new
        {
            controller = "somecontroller",
            action = "someaction"
        });
        filterContext.Result = new RedirectToRouteResult(routeValues);
    }
} 
```

或者例如，您决定缩短控制器操作的执行并直接呈现视图：

```
public class MyActionFilterAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        var viewResult = new ViewResult
        {
            ViewName = "~/Views/FooBar/Baz.cshtml",
        };
        MyViewModel someModel = ... get the model you want to pass to the view
        viewResult.ViewData.Model = model;
        filterContext.Result = viewResult;
    }
} 
```

或者您可能决定呈现 JSON 结果：

```
public class MyActionFilterAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        MyViewModel someModel = ... get the model you want to pass to the view
        filterContext.Result = new JsonResult
        {
            Data = model,
            JsonRequestBehavior = JsonRequestBehavior.AllowGet
        };
    }
} 
```

因此，正如您所见，您可以做的事情是无限的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T00:47:47.070

我对用户 Darin Dimitrov 提供的答案中的代码进行了实验，答案的第一部分和第三部分是正确的。

（虽然，对于可能找到这个线程并感兴趣的其他人，我可以澄清一下，在第一个答案中，“模型”似乎不是一个始终用于模型的硬编码关键字，但似乎必须对应于所选的名称动作方法参数。换句话说，如果你有方法签名

```
public ActionResult Index(MyViewModel myViewModel) 
```

然后在你的动作过滤器中你必须使用

```
var model = filterContext.ActionParameters["myViewModel"] as MyViewModel; 
```

)

关于第二个答案，“RedirectToRouteResult”的使用将触发一个新的 http 请求（正如我在我的第二个代码示例中提到的那样，这是不希望的）。通过实际显式调用它，我找到了另一种“更改”操作方法的方法：

```
var controller = new SomeController();
ActionResult result = controller.SomeAction(model);
filterContext.Result = result; 
```

上面的代码实际上似乎阻止了最初的目标操作方法被调用，即当我在用'[MyActionFilter]'注释的方法中放置一个断点时，执行从未进入该方法。通常，可能不需要像上面那样对控制器进行硬编码，而是可以使用反射，例如下面的第三方库“fasterflect”：

```
string nameOfController = ... 
string nameOfActionMethod = ... 
// both above variables might for example be derived by using some naming convention   and parsing the refering url, depending on what you want to do ...
var theController = this.GetType().Assembly.CreateInstance(nameOfController);
ActionResult result = (ActionResult)theController.CallMethod(nameOfActionMethod, model);
filterContext.Result = result; 
```

（对于那些想要提取当前目标控制器和动作方法的名称的人，在实现逻辑以确定要调用的控制器时，可以在过滤器中使用此代码：

```
var routeValueDictionary = filterContext.RouteData.Values;
string nameOfTargetedController = routeValueDictionary["controller"].ToString();
string nameOfTargetedActionMethod = routeValueDictionary["action"].ToString(); 
```

)

我认为像上面那样实例化和调用控制器感觉有点尴尬，如果可能的话，更愿意以另一种方式更改目标控制器和操作方法？那么，剩下的问题是（在 MVC 4 最终版本中）是否仍然无法在服务器“内部”重定向/转发执行（没有像“RedirectToAction”那样触发新的 http 请求）？

基本上，**我想我在这里只是在寻找**与 ASP.NET Web 窗体一起使用的“Server.Transfer”之类的东西（以及我相信可以使用相同东西的旧经典 ASP）。

我已经看到关于这个问题的较早的问题/答案，人们使用他们自己的一些“TransferResult”类自己实现这种行为，但它似乎倾向于在不同的 MVC 版本中被破坏。（例如，请参阅此处的 MVC 4 beta：[如何在不返回 301 的情况下重定向 MVC 操作？（使用 MVC 4 beta）](https://stackoverflow.com/questions/9559642/how-to-redirect-mvc-action-without-returning-301-using-mvc-4-beta)）。

**关于如何在没有新的 http 请求的情况下进行“内部重定向” （如 RedirectToAction 所做的那样）**，真的还没有一个简单的标准解决方案（在 MVC 4 final 中实现）吗？****

# ruby - 导入文件中的 __FILE__ 变量

> ID：14447301
> 
> 赞同：2
> 
> 时间：2013-01-21T21:13:02.663
> 
> 标签：ruby

我在两个不同的目录中有两个文件：

```
module MyModule
  def my_method path
    p File.join (File.dirname __FILE__), path
  end
end 
```

和

```
require_relative '../modules/mymodule' # definition of MyModule
class MyClass
  extend MyModule
  my_method 'my_file.yml'
end 
```

我得到了类似的输出，`my_home_dir/modules/my_file.yml`但我希望它是定义的目录名称在哪里`my_home_dir/files/my_file.yml`。`files``MyClass`

我知道我可以在调用时使用完整路径，`my_method`但是有没有办法让导入的文件仍然`__FILE__`设置为导入文件的名称？

基本上，`my_method`我需要拥有文件的完整路径，并且我只想传递一个相对于我的调用文件路径的路径。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:34:25.120

`__FILE__`always 是包含`__FILE__`变量的文件的名称，因此说`my_method`将始终返回`my_method`定义的位置，而不是`MyClass`调用它的位置。

您可能可以使用以下方式获取您想要的信息[`caller`](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-caller)：

```
module MyModule
  def my_method path
    p caller
  end
end

include MyModule # definition of MyModule
class MyClass
  extend MyModule
  my_method 'my_file.yml'
end

my_class = MyClass.new 
```

哪个输出：

```
["test.rb:10:in `<class:MyClass>'", "test.rb:8:in `<main>'"] 
```

* * *

编辑：

> 调用者数组只有没有路径的文件名......

好吧，我希望你知道如何解决这个问题，但是......

这是在 test.rb 中：

```
require './test2'
class MyClass
  extend MyModule
  my_method __FILE__, 'my_file.yml'
end

my_class = MyClass.new 
```

这是在 test2.rb 中：

```
module MyModule
  def my_method path, file
    dir = File.dirname(path)
    p caller.map{ |c| File.join(dir, c) }
  end
end 
```

运行 test.rb 输出：

```
["./test.rb:4:in `<class:MyClass>'", "./test.rb:2:in `<main>'"] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-02T22:50:56.227

如果您可以传入一个块，则可以使用更简单的方法；使用块的绑定：

```
# In example.rb:
module Example
  def execute_if_main(&block)
    if $PROGRAM_NAME == eval("__FILE__", block.binding)
      yield
    end
  end
end 
```

然后在测试文件中：

```
# in test.rb:
require_relative 'example.rb'

include Example

execute_if_main do
  puts "hi, I'm being loaded"
end 
```

仅当 Ruby 解释器直接加载 test.rb 时，才会执行该块。如果 test.rb 是通过其他文件通过 require 加载的，那么最后的块将不会被执行（这就是想法）

# .net - Team Foundation 服务器，如何查看项目中某一天签入的所有文件

> ID：14447302
> 
> 赞同：0
> 
> 时间：2013-01-21T21:13:07.410
> 
> 标签：.net, visual-studio, tfs

我正在使用 TFS 源代码控制开发 ASP.NET MVC 项目。我对 TFS 很陌生，有谁知道我可以在某一天查看所有签入文件的方法？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:45:06.947

试试这个工具

"C:\Program Files (x86)\Microsoft Team Foundation Server 2012 Power Tools\TFPT.EXE" searchcs

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:02:35.313

在 Visual Studio 中：

打开源代码管理资源管理器，右键单击项目文件夹并选择**查看历史记录。**（{这将列出所有的变更集）

然后单击“**比较文件夹**”图标以打开“**比较**”对话框

在此对话框中，将 Target Path 设置为 Source Path，并为两者选择 Type = Date。

对于源路径，将日期设置为您要查询的当天的开始，对于目标路径，将日期设置为当天的开始。

在“查看选项”中，勾选前三个框。这是一个示例，我正在搜索昨天添加到特定项目的所有变更集。

![在此处输入图像描述](../Images/67fffcce61770dc8d640ba24f8d79756.png)

单击确定。然后，这将显示当天添加的变更集中文件的所有更改。

# javascript - 自动折叠网格主题中帖子之间的垂直间距

> ID：14447303
> 
> 赞同：1
> 
> 时间：2013-01-21T21:13:07.907
> 
> 标签：javascript, css, wordpress, web, grid-layout

我正在尝试为我的 wordpress 网站制作一个基于网格的自定义主题。我想做的一件事是使同一列中的帖子之间的垂直间距自动折叠，这样即使帖子的高度不同，它们之间也没有空白空间。

例如，在[这个站点上](http://rebelbits.tumblr.com)，网格正在按照我想要的方式折叠。然而，在[这个网站上](http://www.jrt4.net/)，帖子是按水平排列的行排列的，每行之间都有空格。

是否有用于使帖子像第一个示例站点一样排列的技术的名称？我至少在寻找一个我可以用谷歌搜索的术语来学习如何做到这一点......但更好的是一个代码示例，它可以展示如何制作一个以这种方式自动排列的网格。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T02:59:28.137

这被称为**动态网格**或*类似 Pinterest 的网格*。它被[Pinterest](http://pinterest.com/)推广。

本质上，您不能单独使用 CSS 和 HTML 来做到这一点。这种类型的网格需要使用一些 Javascript 或服务器端处理来处理。我建议使用 Javascript 并检查许多 jQuery 插件中的一个，这些插件完全符合您的要求*（请注意，您链接到的第一个站点使用插件进行布局）*：

*   [http://masonry.desandro.com/](http://masonry.desandro.com/) *（您链接到的第一个网站使用什么）*
*   [http://www.wookmark.com/jquery-plugin](http://www.wookmark.com/jquery-plugin)
*   [http://www.inwebson.com/jquery/blocksit-js-dynamic-grid-layout-jquery-plugin/](http://www.inwebson.com/jquery/blocksit-js-dynamic-grid-layout-jquery-plugin/)
*   [http://yconst.com/web/freetile/](http://yconst.com/web/freetile/)

这些中的任何一个都可以解决问题。

**Masonry**让您使用 CSS 设置容器宽度和块之间的间距。您可以在 Javascript 中指定所需的列宽。块宽和间距的计算将决定容器中有多少列。

**Wookmark**和**BlocksIt**有类似的配置选项。它们让您指定容器宽度，然后指定块宽度。在它和偏移量*（块之间的距离）之间，*您可以对其进行排列，以便最终得到 3 列相同宽度的列。

**开箱即用的Freetile**不支持相同宽度的列*（其功能之一）*，但是您可以通过一点 CSS 和/或直接修改插件来完成相同的事情。

这里的主要部分是设置这些插件之一并使其工作。一旦到位，您只需要根据自己的喜好调整 CSS。这些插件中的每一个都提供了工作示例以及代码示例和文档。Masonry 的简单实现如下所示：

HTML：

```
<div id="grid-container">
    <div class="post">...</div>
    <div class="post">...</div>
    <div class="post">...</div>
    <div class="post">...</div>
    <div class="post">...</div>
</div> 
```

CSS：

```
#grid-container {
    width: 940px; //width of your container
}
.post {
    margin: 10px; //spacing between each block/post
} 
```

Javascript：

```
$('#grid-container').masonry({
    itemSelector: '.post', //selector for each block
    columnWidth: 300       //width of your columns
}); 
```

每个块的帖子都会很`300px`宽，`10px`周围都有边距。你最终会得到 3 列，每列`10px`之间都有边距。

列出的每个插件都以可免费用于个人/商业用途的方式获得许可*（请参阅每个插件的各自许可）*，所以不用担心。

# javascript - 注销按钮问题

> ID：14447304
> 
> 赞同：0
> 
> 时间：2013-01-21T21:13:21.227
> 
> 标签：javascript, html, css, facebook, login

我正在尝试在我的网页上实现 Facebook Connect 登录，到目前为止，您在下面有我的（糟糕的）尝试。

*   如果被注销，则会显示登录按钮，如预期的那样。
*   如果单击登录按钮，则会出现 Facebook 登录弹出窗口，如预期的那样。
*   如果弹出窗口中的登录消失，则用户登录并且按钮变为注销按钮。

*   如果单击注销按钮，用户将被注销，但是！：

    1.  该按钮不会更改为登录按钮。
    2.  有时最多会打开三个弹出窗口（登录）。
    3.  函数 testAPI() 被执行。
    4.  有时控制台中会显示以下错误消息：“拒绝显示文档，因为 X-Frame-Options 禁止显示。”

**JS：**

```
 window.fbAsyncInit = function() {
    FB.init({
      appId      : 'xxxxxxxxxxxxxxxx', // App ID
      status     : true, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      xfbml      : true  // parse XFBML
    });

    FB.getLoginStatus(function(response) {
      if (response.status === 'connected') {
        showLogoutButton();
      } else if (response.status === 'not_authorized') {
        showLoginButton();
      } else {
        showLoginButton();
      }
     });
  };

  function showLoginButton() {
    $('#FBButtonDiv').show();

    $('#FBButton').html('Log in Facebook');
    $('#FBButton').on('click', function(){
      login();
    });
  }

  function showLogoutButton() {
    $('#FBButtonDiv').show();

    $('#FBButton').html('Log out Facebook');
    $('#FBButton').on('click', function(){
      logout();
    });
  }

  function login() {
      FB.login(function(response) {
          if (response.authResponse) {
              // connected
              testAPI();
              showLogoutButton();
          } else {
              // cancelled
          }
      });
  }

  function logout() {
    FB.logout(function(response) {
      showLogoutButton();
    });
  }

  function testAPI() {
      console.log('Welcome!  Fetching your information.... ');
      FB.api('/me', function(response) {
          console.log('Good to see you, ' + response.name + '.');
      });
  }

  (function(d){
     var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement('script'); js.id = id; js.async = true;
     js.src = "//connect.facebook.net/en_US/all.js";
     ref.parentNode.insertBefore(js, ref);
   }(document)); 
```

**HTML：**

```
...
<div id="FBButtonDiv"><button id="FBButton">Facebook login!</button></div>
... 
```

**CSS：**

```
#FBButtonDiv {
  display: none;
} 
```

那么，我的代码有什么问题？

注意：我知道代码包含很多 DRY，但是当我让它工作时我会做很多重构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:16:04.700

不是我的专长，JS/FB-API，但我猜：

```
function logout() {
  FB.logout(function(response) {
    showLogoutButton();
  });
} 
```

应该：

```
function logout() {
   FB.logout(function(response) {
     showLoginButton();
   });
} 
```

因为收到响应后，回调应该是向现在注销的用户显示登录按钮。当然，您可能应该像登录一样检查响应以确认注销成功。

# database - SQLite 在单行命令上定义输出字段分隔符

> ID：14447311
> 
> 赞同：9
> 
> 时间：2013-01-21T21:13:58.510
> 
> 标签：database, sqlite, output, separator

我需要使用**单个命令行**从数据库中获取一组记录。如果我这样做：

```
$ sqlite3 con.db "SELECT name,cell,email FROM contacts" 
```

我得到带有分隔符“|”的输出，输出如下所示：

```
Alison|+12345678|alison@mail.com
Ben|+23456789|ben@mail.com
Steve|+34567890|steve@mail.com 
```

有没有办法（**以上面指定的单命令行格式**）将输出字段分隔符更改为其他内容，例如“;;;” 或其他或更独特的东西。这是因为输出偶尔会得到字符“|” 在记录中，它会导致问题。

我想要的结果是：

```
Alison;;;+12345678;;;alison@mail.com
Ben;;;+23456789;;;ben@mail.com
Steve;;;+34567890;;;steve@mail.com 
```

或任何其他唯一的分隔符，这不太可能在值中找到。

（命令在Linux机器上执行）

谢谢你。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-21T21:59:13.910

该[`-separator`选项](http://www.sqlite.org/sqlite.html)可以满足您的要求：

```
sqlite3 -separator ';;;' con.db "SELECT ..." 
```

* * *

格式化输出以保证您不会在值中获取分隔符的唯一方法是引用所有字符串：

```
sqlite3 con.db "SELECT quote(name), quote(cell), quote(email) FROM contacts" 
```

但是，这需要您根据 SQL 语法规则解析输出。

# javascript - 如何将 javascript 添加到 ASP.NET 超链接控件

> ID：14447312
> 
> 赞同：0
> 
> 时间：2013-01-21T21:14:05.843
> 
> 标签：javascript, asp.net, hyperlink

如何将此 URL 输入到 HyperLink ASP.NET 控件中？

```
<a href="https://plus.google.com/share?url={URL}" 
   onclick="javascript:window.open(this.href,'','menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
    <img src="https://www.gstatic.com/images/icons/gplus-64.png" alt="Share on Google+"/>
</a> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:18:54.443

只需使用`onclick`. ASP.Net 无法识别的任何属性都按原样传递。

```
<asp:HyperLink ID="HyperLink1" runat="Server"
    NavigateUrl="https://plus.google.com/share?url={URL}"
    onclick="javascript:window.open(this.href, '',
      'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');
      return false;">
  ...
</asp:HyperLink> 
```

一般来说，如果您不需要服务器端访问控件，我不建议将它们转换为服务器端，因为它会为服务器增加额外的不必要的处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:22:02.753

要在声明性语法中添加它，只需添加它，即

```
<asp:HyperLink 
    runat="server" 
    ID="theLink" 
    onclick="javascript:window.open(this.href, '','menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');
  return false;">
</asp:HyperLink> 
```

您必须注意 OnClick（它是 ASP.NET 的事件绑定和小写版本的 onclick 不一样）

如果您想在后面的代码中执行此操作，则可以通过 WebControl.Attributes 数组执行此操作；）

# gdb - 在发布模式下分析应用程序的调试器输出

> ID：14447314
> 
> 赞同：0
> 
> 时间：2013-01-21T21:14:09.513
> 
> 标签：gdb, wine, stack-dump

我在 Ubuntu 12.10 下使用 i686-w64-mingw32-gcc 4.7.2 交叉编译器开发了一个 win32 应用程序。

当我运行以发布模式编译的应用程序并崩溃时，我可能会收到如下输出。

我想知道如何解释它？我可以从中获得一些有用的信息吗？例如，是否可以从堆栈转储中获取我的源代码中的行？

```
wine: Unhandled page fault on read access to 0x00006c11 at address 0x401cb1 (thread 0009), starting debugger...
Application tried to create a window, but no driver could be loaded.
Make sure that your X server is running and that $DISPLAY is set correctly.
Unhandled exception: page fault on read access to 0x00006c11 in 32-bit code (0x00401cb1).
Register dump:
 CS:0023 SS:002b DS:002b ES:002b FS:0063 GS:006b
 EIP:00401cb1 ESP:007af750 EBP:007af9c8 EFLAGS:00010206(  R- --  I   - -P- )
 EAX:00406a20 EBX:00000004 ECX:00006c11 EDX:00006c11
 ESI:00000068 EDI:00110440
Stack dump:
0x007af750:  007af7df 00000030 00000043 00000004
0x007af760:  00142fc0 3ff54e5b 00406a20 3ff57208
0x007af770:  0207251c 3ff4cb7d 02072574 3ff51f7f
0x007af780:  ea9e6eeb 3ff49b90 e09fe868 3ff4c562
0x007af790:  00006c11 00000045 0209c5b4 007afa0c
0x007af7a0:  00000004 019b0000 007af7f8 00110000
000c: sel=0067 base=00000000 limit=00000000 16-bit --x
Backtrace:
=>0 0x00401cb1 in analyser (+0x1cb1) (0x007af9c8)
  1 0x00536147 in analyser (+0x136146) (0x007afd98)
  2 0x004013fa __tmainCRTStartup+0x279() [/home/ruben/mingw-w64/src/mingw-w64/mingw-w64-crt/crt/crtexe.c:313] in analyser (0x007afe70)
  3 0x7b859ddc call_process_entry+0xb() in kernel32 (0x007afe88)
  4 0x7b85b04f in kernel32 (+0x4b04e) (0x007afec8)
  5 0x7bc71d90 call_thread_func_wrapper+0xb() in ntdll (0x007afed8)
  6 0x7bc7486d call_thread_func+0x7c() in ntdll (0x007affa8)
  7 0x7bc71d6e RtlRaiseException+0x21() in ntdll (0x007affc8)
  8 0x7bc49f4e call_dll_entry_point+0x61d() in ntdll (0x007affe8)
0x00401cb1: movl    0x0(%edx),%eax
Modules:
Module  Address         Debug info  Name (89 modules)
PE    240000-  273000   Deferred        ssleay32
PE    280000-  37e000   Deferred        libeay32
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T02:12:47.990

> 我想知道如何解释它？

看起来已经很清楚了：您的代码，更准确地说：地址处的指令`0x401cb1`，试图取消引用地址处的内存`0x00006c11`。该内存访问无效，并触发了页面错误。

> 我可以从中获得一些有用的信息吗？

是的，如上所述。

> 例如，是否可以从堆栈转储中获取我的源代码中的行？

当然：在发布模式下构建应用程序时，添加`-g`标志。然后

```
addr2line -fe analyser 0x401cb1 
```

`0x401cb1`应该告诉您地址对应于哪个文件/行。

# css - 特定页面链接悬停

> ID：14447317
> 
> 赞同：-1
> 
> 时间：2013-01-21T21:14:32.003
> 
> 标签：css, hover, hyperlink

我在让页面底部的三个链接在悬停时改变颜色时遇到问题。查看当前工作 » 立即开始 » 和查看社区资料 » 是我想要处理的链接。希望这是有道理的。谢谢您的帮助。

[http://www.jobspark.ca/](http://www.jobspark.ca/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:17:53.853

您必须删除环绕它们的内联样式规则，否则它们将覆盖您在`.css`文件中编写的任何内容。

然后你可以为每个锚点添加一个类，比如说`.call-to-action`.

```
<a href="/job-listings/" class="call-to-action">View Current Jobs »</a>
<a href="/post-a-job/" class="call-to-action">Get Started Now »</a>
<a href="/community-profiles/" class="call-to-action">View Community Profiles »</a> 
```

然后你可以像这样设计它：

```
.call-to-action { color: orange; } 
```

# python - Python Celery 任务重启 celery worker

> ID：14447322
> 
> 赞同：7
> 
> 时间：2013-01-21T21:14:55.457
> 
> 标签：python, celery, celeryd

在 celery 中，有没有一种简单的方法来创建一个（一系列）任务，我可以用它来自动重启一个工作人员？

目标是让我的部署在每次从 github 获取新源时自动重新启动所有子 celery 工作人员。因此，我可以向该机器上的管理 celery 实例发送一个 restartWorkers() 任务，该任务将杀死（实际上是停止等待）该机器上的所有 celery 工作进程，并使用新模块重新启动它们。

该计划是让每台机器拥有：

*   管理节点 [Queues: Management, machine-specific] - 负责管理机器上的其余工作人员，在必要时启动新节点并杀死旧节点
*   工作节点 [队列：特定于 git 修订版、特定于工作人员、特定于机器] - 实际负责完成工作。

看起来我需要的代码在 dist_packages/celery/bin/celeryd_multi.py 中的某个位置，但是对于启动工作人员来说，源代码相当不透明，我不知道它应该如何工作或它实际上在哪里启动节点。（看起来shutdown_nodes是调用杀死进程的正确代码，我正在慢慢调试我的方式来弄清楚我的论点应该是什么）

是否有我可以调用的函数/函数 restart_nodes(self, nodes) 或者我将在 python 中运行 shell 脚本？

/另外，有没有比杀死和重新启动进程更简单的方法将源重新加载到 Python 中？如果我知道重新加载模块确实有效（实验表明它没有。在我重新启动该过程之前，对功能的更改不会渗透），我会这样做而不是间接使用管理节点。

编辑：我现在可以关闭，多亏了广播（谢谢 mihael。如果我有更多的代表，我会投票）。有什么方法可以广播重启？有 pool_restart，但这不会杀死节点，这意味着它不会更新源。

我一直在研究 celery.bin.celeryd:WorkerCommand().run() 中的一些幕后源代码，但是在 run 调用之前和之后发生了一些奇怪的事情，所以我不能只调用它功能并完成，因为它崩溃了。从 python 脚本调用 shell 命令来运行另一个 python 脚本只是 0 有意义，我不敢相信我是第一个想要这样做的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T00:26:32.653

您可以尝试使用Celery 的[广播功能](http://docs.celeryproject.org/en/latest/reference/celery.app.control.html?highlight=broadcast#celery.app.control.Control.broadcast)。

在这里你可以看到一些很好的例子：[https ://github.com/mher/flower/blob/master/flower/api/control.py](https://github.com/mher/flower/blob/master/flower/api/control.py)

# wpf - 在 XAML 代码中获取当前区域性日期模式

> ID：14447323
> 
> 赞同：1
> 
> 时间：2013-01-21T21:14:58.843
> 
> 标签：wpf, xaml, date, binding, currentculture

因此，在我的（大型）项目中，我有一个特殊的日期框，它源自一个蒙面文本框，因此具有“格式”属性。它通过给它一个短日期格式来工作，例如：

```
<extended:DateMaskTextBox Format="yyyy-MM-dd" /> 
```

现在在应用程序开始时，根据某些逻辑设置 CultureInfo.CurrentCulture.DateTimeFormat 对象的 ShortDatePattern 属性。我想获取此 ShortDatePattern 以将其用作我的 DateMaskTextBox 的 Format 属性的值。

到目前为止，我已经得到了这个，但它**不起作用**：

```
<extended:DateMaskTextBox Format="{Binding Source={x:Static glob:CultureInfo.CurrentCulture}, Path=DateTimeFormat.ShortDatePattern}" /> 
```

知道为什么这不起作用吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T03:40:09.390

该 Binding 语法是正确的，应该可以正常工作。您是否在输出窗口中收到任何绑定错误？您是否尝试过在 TextBlock.Text 上显示相同的绑定来代替您的控件以查看字符串是否通过？

如果没有看到它的代码，我无法判断，但我怀疑问题可能出在 DateMaskTextBox 而不是 Binding 上。如果控件未正确设置以尊重其 Format 属性的新设置值，则绑定值可能根本没有被使用，或者使用得太晚而影响您在与控件交互时看到的行为。

# optimization - 优化 ifort 中的 SIGSEGV

> ID：14447324
> 
> 赞同：2
> 
> 时间：2013-01-21T21:15:03.313
> 
> 标签：optimization, segmentation-fault, fftw, intel-fortran

如果我在 ifort 中使用 -O0 编译，程序可以正常运行。但是只要我打开优化选项，比如-O，-O3，-fast，就会出现SIGSEGV分段错误。

此错误发生在名为 maketable() 的子例程中。以下是现象：

(1) 我在这个子程序中调用了 fftw 库。如果我评论关于 fftw 的句子，就可以了。但我认为这不是fftw的错，因为我在这段代码的其他一些地方也使用了fftw，它们都很好。

(2) fftw在循环中被调用，当程序crash时循环可以运行多次。段错误不会在第一次进入循环时发生。

（3）我考虑过堆栈溢出，但我现在不这么认为。我有很久以前别人编译的可执行文件，可以在我的电脑上执行。我认为这表明这不是由于系统堆栈溢出。

ifort 的版本是 10.0，fftw 的版本是 fftw-2.1.5。cpu类型是intel xeon 5130。非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:14:01.533

Fortran 程序中的分段错误有两个常见原因：

1.  试图访问数组边界之外的元素。
2.  过程调用中的实际参数和虚拟参数不匹配。

两者都比较容易找到：

1.  您的编译器可以选择生成在运行时执行*数组边界检查的代码。*检查您的编译器文档，重建您的代码并重新运行它。如果这是问题的原因，您将收到一条错误消息，指出您的代码出错的地方。
2.  为程序中的任何子例程和函数编写显式接口，或使用模块以便编译器为您生成此类接口，或使用编译器选项（请参阅文档）在编译时检查参数类型是否匹配。

此类错误（似乎）仅在优化调高时才会出现，这并不罕见。

**编辑**

请注意，我并不是说优化会导致您观察到的错误，而是它会导致错误影响程序的执行并变得明显。

不正确的程序显然可以毫无故障地运行多次，这并不陌生，例如，使用新的编译器版本重新编译以创建每次都崩溃的可执行文件。

我建议，您希望仅对似乎出现分段错误的子例程关闭优化，这是完全错误的。我希望我的程序在任何优化级别上都能正确执行（除了编译器错误的明确证据，这样的事情并不是未知的）。我认为，通过关闭优化，您可以在地毯下扫除程序的一个真正问题，就像它一样。

# nhibernate - 在 Nhibernate 的 where 条件下调用实例方法

> ID：14447326
> 
> 赞同：0
> 
> 时间：2013-01-21T21:15:06.863
> 
> 标签：nhibernate, fluent-nhibernate

我在 TaskRepository 中有这段代码：

```
public List<Task> GetActiveTasks()
    {

        return SessionContainer.Session
            .Query<Task>()
            .Where(t => t.IsActive())
            .ToList();
    } 
```

这是任务类中的 IsActive() 方法

```
public virtual bool IsActive()                                 
{
 return States.ToList().Max().Name == "Active";
} 
```

我的问题是`GetActiveTasks()`返回`NotSupportedException`。

有谁知道什么问题？我认为不可能在 Where 谓词中调用实例方法。如果这不可能，是否有任何解决方法？我需要完成所有活动任务，但如果不是这样，我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T05:34:24.217

Query 中给出的 lambdas 必须转换为 sql。NHibernate 应该如何解释你实现的方法？它不能。但是，您可以将 IsActive 映射为 Formula 属性并对其进行查询。就像是：

```
Map(x => x.IsActive).Formula("(SELECT ... FROM (Select s.Name FROM States s WHERE s.task_id = Id ORDER BY Id desc LIMIT 1) maxState WHERE maxState.Name == Active)") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T08:09:07.380

一种选择是重构 Task 类，如下所示：

```
public static Expression<Func<Task, bool>> IsActiveExpr =
    (task) => task.States.Max().Name == "Active";
private static Func<Task, bool> _IsActiveCompiled = IsActiveExpr.Compile();

public virtual bool IsActive()                                 
{
    return IsActiveCompiled(this);
} 
```

现在您可以在 LINQ 查询中使用 IsActiveExpr。

另一种选择是扩展 NHibernate 查询提供程序，以便它直接识别 IsActive() 方法。进行搜索，或者例如查看我对这个问题的回复：[Lambda string as VARCHAR](https://stackoverflow.com/questions/14396166/lambda-string-as-varchar/14399760)。但可能需要注意避免重复逻辑。

# ios - 在 Salesforce iOS SDK 中查询用户名

> ID：14447328
> 
> 赞同：2
> 
> 时间：2013-01-21T21:15:09.843
> 
> 标签：ios, salesforce

我有一个使用最新 Salesforce iOS SDK 的 iOS 应用程序。它使用 Salesforce 站点上的 oAuth2.0 通过 web 视图对用户进行身份验证，因此我不会在我的应用程序中捕获用户名。有没有一种方法可以让我以某种方式使用 API 或会话信息查询用户名？我只是希望能够显示用户名，以便用户知道他们登录了哪个帐户（如果他们有多个）谢谢，约瑟夫

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-22T14:57:32.940

当前用户的用户名存储在 SFIdentityData 对象中

```
#import "SFIdentityData.h"

NSString *userName = [SFAccountManager sharedInstance].idData.username; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T08:36:29.030

我不知道你是使用 REST 还是 SOAP API ......

对于**REST** ，metadaddy有一篇出色的文章：[http :](http://wiki.developerforce.com/page/Digging_Deeper_into_OAuth_2.0_at_Salesforce.com#The_Force.com_Identity_Service) [//wiki.developerforce.com/page/Digging_Deeper_into_OAuth_2.0_at_Salesforce.com#The_Force.com_Identity_Service](https://salesforce.stackexchange.com/users/67/metadaddy)

身份服务链接的格式为`/id/(organization id)/(user id)`，请在此博客文章中向上滚动一下，以了解您应该期待它的时间。

![工作台](../Images/a6e0ba6545f7ebeaaecf35f62b42e6f7.png)

**SOAP** API，提供[`getUserInfo()`](http://www.salesforce.com/us/developer/docs/api/Content/sforce_api_calls_getuserinfo.htm)方法（它返回一个类似于 Apex`UserInfo`类的对象）。只需单击此处的第一个链接即可查看您可以调用的方法的完整列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-08T18:43:36.547

**斯威夫特**

要使用 Salesforce Mobile SDK 4 在 UILabel 和 UIImageView 中显示登录用户的全名和聊天资料图片，您需要首先创建 @IBOutlets

```
@IBOutlet weak var yourtextLabel: UILabel!
@IBOutlet weak var profileImage: UIImageView! 
```

然后，您只需要 viewDidLoad() 中的以下内容

```
yourtextLabel.text = SFAuthenticationManager.sharedManager().idCoordinator.idData.displayName

let imageURL = SFAuthenticationManager.sharedManager().idCoordinator.idData.pictureUrl
let image =  UIImage(data: NSData(contentsOfURL: imageURL!)!)
profileImage.image = image 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-06T08:41:27.390

您需要导入**SFAuthenticationManager** .h 类

```
#import <SalesforceSDKCore/SFAuthenticationManager.h> 
```

然后您可以通过这种方式获取用户详细信息（**名字**、**姓氏**、**电子邮件**等）

```
NSLog(@"userData= %@",[SFAuthenticationManager sharedManager].idCoordinator.idData);

NSLog(@"first name = %@",[SFAuthenticationManager sharedManager].idCoordinator.idData.firstName);
NSLog(@"last name = %@",[SFAuthenticationManager sharedManager].idCoordinator.idData.lastName);
NSLog(@"email name = %@",[SFAuthenticationManager sharedManager].idCoordinator.idData.email); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-08T20:04:29.000

**SalesforceMobileSDK-iOS 7.0**

**斯威夫特版本**

```
import SalesforceSDKCore 
```

```
guard let userId = UserAccountManager.shared.currentUserAccountIdentity?.userId else {return} 
```

取决于您的需要，这可能也有帮助：

```
guard let userId = UserAccountManager.shared.currentUserAccount?.idData?.userId else {return} 
```

# macos - Mac 核心数据未捕获异常

> ID：14447329
> 
> 赞同：0
> 
> 时间：2013-01-21T21:15:14.123
> 
> 标签：macos, cocoa, core-data

我收到此错误：

```
2013-01-21 15:09:49.479 obtl[13136:403] An uncaught exception was raised
2013-01-21 15:09:49.484 obtl[13136:403] [<NSApplication 0x10012a600> valueForUndefinedKey:]: this class is not key value coding-compliant for the key managedObjectContext.
2013-01-21 15:09:49.493 obtl[13136:403] (
    0   CoreFoundation                      0x00007fff8c000f56 __exceptionPreprocess + 198
    1   libobjc.A.dylib                     0x00007fff934f4d5e objc_exception_throw + 43
    2   CoreFoundation                      0x00007fff8c08b1b9 -[NSException raise] + 9
    3   Foundation                          0x00007fff8ef65703 -[NSObject(NSKeyValueCoding) valueForUndefinedKey:] + 240
    4   Foundation                          0x00007fff8ee9c38e _NSGetUsingKeyValueGetter + 108
    5   Foundation                          0x00007fff8ee9c315 -[NSObject(NSKeyValueCoding) valueForKey:] + 392
    6   AppKit                              0x00007fff938596ef -[NSApplication(NSScripting) valueForKey:] + 510
    7   Foundation                          0x00007fff8eebbda2 -[NSObject(NSKeyValueCoding) valueForKeyPath:] + 348
    8   AppKit                              0x00007fff936572fa -[NSBinder _valueForKeyPath:ofObject:mode:raisesForNotApplicableKeys:] + 654
    9   AppKit                              0x00007fff93656fe4 -[NSBinder valueForBinding:resolveMarkersToPlaceholders:] + 171
    10  AppKit                              0x00007fff93656c52 -[NSObjectParameterBinder _updateObject:observedController:observedKeyPath:context:] + 1181
    11  AppKit                              0x00007fff93648f8f -[NSObject(NSKeyValueBindingCreation) bind:toObject:withKeyPath:options:] + 591
    12  AppKit                              0x00007fff936422a1 -[NSIBObjectData nibInstantiateWithOwner:topLevelObjects:] + 1079
    13  AppKit                              0x00007fff936388bb loadNib + 322
    14  AppKit                              0x00007fff93637db8 +[NSBundle(NSNibLoading) _loadNibFile:nameTable:withZone:ownerBundle:] + 217
    15  AppKit                              0x00007fff93637cd3 +[NSBundle(NSNibLoading) loadNibFile:externalNameTable:withZone:] + 141
    16  AppKit                              0x00007fff93637c16 +[NSBundle(NSNibLoading) loadNibNamed:owner:] + 364
    17  AppKit                              0x00007fff938a8cd7 NSApplicationMain + 398
    18  obtl                                0x0000000100001b52 main + 34
    19  obtl                                0x0000000100001b24 start + 52
)
2013-01-21 15:09:49.503 obtl[13136:403] *** Terminating app due to uncaught exception 'NSUnknownKeyException', reason: '[<NSApplication 0x10012a600> valueForUndefinedKey:]: this class is not key value coding-compliant for the key managedObjectContext.'
*** First throw call stack:
(
    0   CoreFoundation                      0x00007fff8c000f56 __exceptionPreprocess + 198
    1   libobjc.A.dylib                     0x00007fff934f4d5e objc_exception_throw + 43
    2   CoreFoundation                      0x00007fff8c08b1b9 -[NSException raise] + 9
    3   Foundation                          0x00007fff8ef65703 -[NSObject(NSKeyValueCoding) valueForUndefinedKey:] + 240
    4   Foundation                          0x00007fff8ee9c38e _NSGetUsingKeyValueGetter + 108
    5   Foundation                          0x00007fff8ee9c315 -[NSObject(NSKeyValueCoding) valueForKey:] + 392
    6   AppKit                              0x00007fff938596ef -[NSApplication(NSScripting) valueForKey:] + 510
    7   Foundation                          0x00007fff8eebbda2 -[NSObject(NSKeyValueCoding) valueForKeyPath:] + 348
    8   AppKit                              0x00007fff936572fa -[NSBinder _valueForKeyPath:ofObject:mode:raisesForNotApplicableKeys:] + 654
    9   AppKit                              0x00007fff93656fe4 -[NSBinder valueForBinding:resolveMarkersToPlaceholders:] + 171
    10  AppKit                              0x00007fff93656c52 -[NSObjectParameterBinder _updateObject:observedController:observedKeyPath:context:] + 1181
    11  AppKit                              0x00007fff93648f8f -[NSObject(NSKeyValueBindingCreation) bind:toObject:withKeyPath:options:] + 591
    12  AppKit                              0x00007fff936422a1 -[NSIBObjectData nibInstantiateWithOwner:topLevelObjects:] + 1079
    13  AppKit                              0x00007fff936388bb loadNib + 322
    14  AppKit                              0x00007fff93637db8 +[NSBundle(NSNibLoading) _loadNibFile:nameTable:withZone:ownerBundle:] + 217
    15  AppKit                              0x00007fff93637cd3 +[NSBundle(NSNibLoading) loadNibFile:externalNameTable:withZone:] + 141
    16  AppKit                              0x00007fff93637c16 +[NSBundle(NSNibLoading) loadNibNamed:owner:] + 364
    17  AppKit                              0x00007fff938a8cd7 NSApplicationMain + 398
    18  obtl                                0x0000000100001b52 main + 34
    19  obtl                                0x0000000100001b24 start + 52
)
terminate called throwing an exception 
```

相关信息：

Mac OSX App（试图让拥有 Snow Leopard 的用户也能使用它）。一切都适当地绑定到`FileOwner.managedObjectContext`适当的实体。我已经三次检查了我所有的表格、按钮等，以确保它们连接到正确的绑定。我只有 1 个窗口文件。我在 Mac Lion 上使用 Xcode 4.5.2（不使用自动布局）。我不知道如何解决这个问题——是的，我研究了很多类似的问题，并尝试了一些相同的解决方案，但无济于事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:26:37.877

从崩溃日志中，您似乎正在加载一个 nib，并且该 nib 尝试访问`managedObjectContext`在该 nib 的所有者中定义的属性。它没有找到，所以崩溃了。这可能是由于笔尖所有者错误。

我建议查看您的 nib 文件：

1.  文件的所有者应该是类型：`NSApplication`;

2.  文件的所有者应该有一个`delegate`绑定到应用程序委托的出口；

3.  应用程序委托应声明该`managedObjectContext`属性。

# django - 如何通过 Django 的多表继承允许可覆盖的方法？

> ID：14447330
> 
> 赞同：0
> 
> 时间：2013-01-21T21:15:28.363
> 
> 标签：django, django-models

我的模型组织如下。

```
class Animal(models.Model):

  first_name = models.CharField(max_length=128, unique=True)

class Cat(Animal):

  def make_sound(self):
    return "mreooooow"

class Dog(Animal):

  def make_sound(self):
    return "AARF!"

class EvilMonkey(Animal):

  def make_sound(self):
    return "muahahaha ..." 
```

如您所见，各种动物都继承自一个名为“Animal”的类。每个子类也有一个方法`make_sound`。

但是，在我看来，当我调用`make_sound`通用动物时，Django 抱怨`Animal`对象没有方法调用`make_sound`，这是有道理的，因为只有子类的对象`Animal`才有方法。

我可以以某种方式告诉 Django，我可以保证子类的所有对象`Animal`都具有该`make_sound`方法吗？通过Java接口之类的东西？我知道 Django 文档说“不允许“隐藏”字段名称”，但我觉得覆盖方法对于继承非常重要，因此 Django 应该支持它。

我不想说得特别具体，`my_animal.cat.make_sound()`因为我想笼统地对待动物对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:01:15.647

问题不在于Animal 不知道make_sound。很简单，当您在 Django 中请求 Animal 时，您会得到：即使该 Animal “实际上”是子类而不是基类，也只会返回基实例。这是因为 Django 不会尝试执行查询来查找任何子类表中是否存在相关项目 - 这可能是一件好事，因为您会有许多不必要的查询。

唯一要做的就是在基类上记录它是什么类型的 Animal，然后编写一个方法从中获取相关的子类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:57:45.037

本文[提供](https://stackoverflow.com/questions/929029/how-do-i-access-the-child-classes-of-an-object-in-django-without-knowing-the-nam/929982#929982)了一些见解。如果有更简单的方法会很方便。“[更有效的技术](https://github.com/carljm/django-model-utils/blob/master/model_utils/managers.py#L36)”看起来很有希望。

# forms - 德尔福登录表格

> ID：14447331
> 
> 赞同：5
> 
> 时间：2013-01-21T21:15:29.063
> 
> 标签：forms, delphi, login

在我的 Delphi 程序中，我有一个登录表单，它在创建主表单之前显示，但我面临的问题是我想在主表单中处理登录检查，这意味着登录表单将使用检查和继续的主要表格，

请阅读以下评论：

> 过程 LogInButtonClick(Sender: TObject) ;

这是 TLoginForm 代码（[来自 delphi.about.com](http://delphi.about.com/od/windowsshellapi/a/password_login.htm)）：

```
 unit login;

 interface

 uses
   Windows, Messages, SysUtils, Variants, Classes,
   Graphics, Controls, Forms, Dialogs, StdCtrls;

 type
   TLoginForm = class(TForm)
     LogInButton: TButton;
     pwdLabel: TLabel;
     passwordEdit: TEdit;
     procedure LogInButtonClick(Sender: TObject) ;
   public
     class function Execute : boolean;
   end;

 implementation
 {$R *.dfm}

 class function TLoginForm.Execute: boolean;
 begin
   with TLoginForm.Create(nil) do
   try
     Result := ShowModal = mrOk;
   finally
     Free;
   end;
 end;

 procedure TLoginForm.LogInButtonClick(Sender: TObject) ;
 begin
   if passwordEdit.Text = 'delphi' then
   {
   Here how it's possible to use :
    if MainForm.text=passwordEdit.Text then 
    ModalResult := mrOK
    }

     ModalResult := mrOK
   else
     ModalResult := mrAbort;
 end;

 end. 
```

这是主程序初始化流程：

```
program PasswordApp;

 uses
   Forms,
   main in 'main.pas' {MainForm},
   login in 'login.pas' {LoginForm};

 {$R *.res}

 begin
   if TLoginForm.Execute then
   begin
     Application.Initialize;
     Application.CreateForm(TMainForm, MainForm) ;
     Application.Run;
   end
   else
   begin
     Application.MessageBox('You are not authorized to use the application. The password is "delphi".', 'Password Protected Delphi application') ;
   end;
 end. 
```

谢谢你

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-21T21:24:52.803

如果需要先创建主窗体，那么先创建它：

```
begin
  Application.Initialize;
  Application.CreateForm(TMainForm, MainForm);//created, but not shown
  if TLoginForm.Execute then//now the login form can refer to the main form
    Application.Run//this shows the main form
  else
    Application.MessageBox('....');
end; 
```

* * *

这是对您提出的问题的直接而幼稚的回答。从更广泛的角度考虑，我鼓励您将登录测试移出主窗体。将它放在任何更高级别的代码都可以使用的地方。您当前正在努力的设计具有不健康的耦合。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-21T21:32:12.550

我通常`OnCreate`从`MainForm`; 或者从 的`OnCreate`，`DataModule`如果你有的话。例如：

```
TMainForm.OnCreate(Sender: TObject);
var F: TLoginForm;
begin
  F := TLoginForm.Create(Self);
  try
    F.ShowModal;
  finally F.Free;
  end;
end; 
```

我不喜欢把`DPR`文件弄得太乱。这有效，以正确的顺序显示表单，如果`TMainForm`是由 Delphi 自动创建的，则该`MainForm`变量已经分配并准备好在`OnCreate`触发时使用；

PS：访问`MainForm`变量实际上是糟糕的设计，但如果你想要它就在那里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T21:31:33.873

与[大卫的回答](https://stackoverflow.com/a/14447491/757830)类似，但行为略有不同，我之前回答[了这个](https://stackoverflow.com/a/7845993/757830)能够在应用程序生命周期中重用的解决方案。

# python - 在 python 中，包含 80000 个项目的列表大约会消耗多少内存？

> ID：14447333
> 
> 赞同：1
> 
> 时间：2013-01-21T21:15:34.823
> 
> 标签：python, performance, list, memory

我有一个 python 列表，其中包含 80000 个列表。这些内部列表中的每一个或多或少都具有以下格式：

```
["012345", "MYNAME" "Mon", "A", 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20] 
```

你能说出这个由 80000 个列表组成的列表大约会消耗多少内存吗？

在 python 中使用和操作这么大的列表是否常见/可以？我做的大部分操作是用列表理解方法从这个列表中提取数据。

实际上，我想学习的是：python 是否足够快，可以使用列表理解方法从大列表中提取数据。我希望我的脚本快

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:18:02.230

```
In [39]: lis=["012345", "MYNAME" "Mon", "A", 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
     20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20]

In [40]: k=[lis[:] for _ in xrange(80000)]

In [41]: k.__sizeof__()
Out[41]: 325664

In [42]: sys.getsizeof(k)  #after gc_head
Out[42]: 325676 
```

根据其中的代码，[`sysmodule.c`](http://hg.python.org/cpython/file/6110ed94f86d/Python/sysmodule.c#l813)它看起来像是调用`__sizeof__`方法来获取对象的大小。

```
 837   method = _PyObject_LookupSpecial(o, &PyId___sizeof__);   
   838     if (method == NULL) {
   839         if (!PyErr_Occurred())
   840             PyErr_Format(PyExc_TypeError,
   841                          "Type %.100s doesn't define __sizeof__",
   842                          Py_TYPE(o)->tp_name);
   843     }
   844     else {
   845         res = PyObject_CallFunctionObjArgs(method, NULL);
   846         Py_DECREF(method);
   847     } 
```

然后增加一些`gc`开销：

```
 860     /* add gc_head size */
   861     if (PyObject_IS_GC(o)) {
   862         PyObject *tmp = res;
   863         res = PyNumber_Add(tmp, gc_head_size);
   864         Py_DECREF(tmp);
   865     }
   866     return res;
   867 } 
```

我们还可以使用[docs](http://docs.python.org/dev/library/sys#sys.getsizeof)[`recursive sizeof recipe`](http://code.activestate.com/recipes/577504/)中建议的方法递归计算每个容器的大小：

```
In [17]: total_size(k)  #from recursive sizeof recipe
Out[17]: 13125767

In [18]: sum(y.__sizeof__() for x in k for y in x)
Out[18]: 34160000 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T21:18:14.257

在我使用 32 位 Python 2.7.3 的机器上，包含问题中确切列表的 80K 副本的列表大约需要 10MB。这是通过比较两个相同的解释器的内存占用量来衡量的，一个有列表，一个没有。

我试过用 测量尺寸`sys.getsizeof()`，但返回的结果明显不正确：

```
>>> l=[["012345", "MYNAME" "Mon", "A", 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20] for i in range(80000)]
>>> sys.getsizeof(l)
325680 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T22:55:07.603

[应用Python 对象大小（修订版）](http://code.activestate.com/recipes/546530-size-of-python-objects-revised/)配方中的当前（第 13 版）代码并放置在名为 的模块`sizeof`中，然后将其应用到您的示例列表中，结果如下（使用 32 位 Python 2.7.3）：

```
from sizeof import asizeof  # from http://code.activestate.com/recipes/546530

MB = 1024*1024
COPIES = 80000
lis=["012345", "MYNAME" "Mon", "A", 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
     20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20]

lis_size = asizeof(lis)
print 'asizeof(lis): {} bytes'.format(lis_size)
list_of_lis_size = asizeof([lis[:] for _ in xrange(COPIES)])
print 'asizeof(list of {:,d} copies of lis): {:,d} bytes ({:.2f} MB)'.format(
                         COPIES, list_of_lis_size, list_of_lis_size/float(MB)) 
```

```
asizeof(lis): 272 bytes
asizeof(list of 80,000 copies of lis): 13,765,784 bytes (13.13 MB) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T21:20:55.967

> sys.getsizeof: (object, default)
> │ │ getsizeof(object, default) -> int
> │ │<br> │ │ 以字节为单位返回对象的大小。

**代码**

```
>> import sys
>> sys.getsizeof(["012345", "MYNAME" "Mon", "A", 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20])
>> 160 
```

它为您的列表返回`160`字节。将其乘以大约 80,000 或 12.8 MB。（使用 Python 2.7.2、Python 3.2 的 32 位机器）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-21T22:48:26.297

请注意以下与解释器的交互：

```
>>> import sys
>>> array = ['this', 'is', 'a', 'string', 'array']
>>> sys.getsizeof(array)
56
>>> list(map(sys.getsizeof, array))
[29, 27, 26, 31, 30]
>>> sys.getsizeof(array) + sum(map(sys.getsizeof, array))
199
>>> 
```

在这种特定情况下，答案是用于`sys.getsizeof(array) + sum(map(sys.getsizeof, array))`查找字符串列表的大小。但是，以下将是一个更完整的实现，它考虑了对象容器、类和 __slots__ 的用法。

```
import sys

def sizeof(obj):
    return _sizeof(obj, set())

def _sizeof(obj, memo):
    # Add this object's size just once.
    location = id(obj)
    if location in memo:
        return 0
    memo.add(location)
    total = sys.getsizeof(obj)
    # Look for any class instance data.
    try:
        obj = vars(obj)
    except TypeError:
        pass
    # Handle containers holding objects.
    if isinstance(obj, (tuple, list, frozenset, set)):
        for item in obj:
            total += _sizeof(item, memo)
    # Handle the two-sided nature of dicts.
    elif isinstance(obj, dict):
        for key, value in dict.items():
            total += _sizeof(key, memo) + _sizeof(value, memo)
    # Handle class instances using __slots__.
    elif hasattr(obj, '__slots__'):
        for key, value in ((name, getattr(obj, name))
            for name in obj.__slots__ if hasattr(obj, name)):
            total += _sizeof(key, memo) + _sizeof(value, memo)
    return total 
```

* * *

**编辑：**

一段时间后解决这个问题后，设计了以下替代方案。请注意，它不适用于无限迭代器。此代码最适合用于分析的静态数据结构。

```
import sys

sizeof = lambda obj: sum(map(sys.getsizeof, explore(obj, set())))

def explore(obj, memo):
    loc = id(obj)
    if loc not in memo:
        memo.add(loc)
        yield obj
        # Handle instances with slots.
        try:
            slots = obj.__slots__
        except AttributeError:
            pass
        else:
            for name in slots:
                try:
                    attr = getattr(obj, name)
                except AttributeError:
                    pass
                else:
                    yield from explore(attr, memo)
        # Handle instances with dict.
        try:
            attrs = obj.__dict__
        except AttributeError:
            pass
        else:
            yield from explore(attrs, memo)
        # Handle dicts or iterables.
        for name in 'keys', 'values', '__iter__':
            try:
                attr = getattr(obj, name)
            except AttributeError:
                pass
            else:
                for item in attr():
                    yield from explore(item, memo) 
```

# node.js - Nodejitsu 是否支持 neo4j？

> ID：14447335
> 
> 赞同：2
> 
> 时间：2013-01-21T21:15:40.987
> 
> 标签：node.js, neo4j, nodejitsu

我想使用 Nodejitsu 来托管我的 Node.js 应用程序。该应用程序还使用 Neo4j。Nodejitsu 是否为此提供任何形式的支持？还是我需要单独托管 Neo4j（并为所有网络流量付费）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T07:24:27.290

[Nodejitsu](http://nodejitsu.com/)不支持原生 Neo4j 集成。如果您可以托管 Neo4j 服务或找到可以使用它的服务，并且对于 node.js 应用程序，您可以将 neo4j api 与[https://github.com/thingdom/node-neo4j一起使用](https://github.com/thingdom/node-neo4j)

我会尽力为您找到最佳答案，如果我能找到任何关于 Neo4j 托管的信息，我会更新这个问题。

# android - android phonegap 相机和图像上传

> ID：14447336
> 
> 赞同：5
> 
> 时间：2013-01-21T21:15:43.967
> 
> 标签：android, camera, cordova, file-transfer

自周五以来，我一直在努力完成这项工作，搜索谷歌和这里。我的最终目标是能够拍摄多张带有标题和描述的照片并将它们上传到服务器，然后显示在网页上。

到目前为止我所拥有的是：给一张图片一个标题和描述，浏览画廊，找到一张图片并选择它的能力。但是当我这样做时，图像会立即与表单一起上传。我希望能够使用提交按钮来做到这一点。

我也有一个按钮来拍摄图像，并出现页面上图像的预览。但是当我用相机拍照时，我不知道如何上传我的表格。我能够使用 div 和 innerHTML 调用将图像数据打印到屏幕上......但老实说，我很迷茫，甚至不知道从哪里开始发布特定的代码片段。我将发布整个页面，因为它目前存在......

```
<html>
<head>
    <title>File Transfer Example</title>

    <script type="text/javascript" charset="utf-8" src="cordova-2.3.0.js"></script>
    <script type="text/javascript" charset="utf-8">

        var pictureSource;   // picture source
        var destinationType; // sets the format of returned value

        // Wait for Cordova to load
        //
        document.addEventListener("deviceready", onDeviceReady, false);

        // Cordova is ready
        //
function onDeviceReady() {
    pictureSource=navigator.camera.PictureSourceType;
    destinationType=navigator.camera.DestinationType;
}

        function browse(){
            navigator.camera.getPicture(uploadPhoto,
                                        function(message) { alert('get picture failed'); },
                                        { quality: 50,
                                        destinationType: navigator.camera.DestinationType.FILE_URI,
                                        sourceType: navigator.camera.PictureSourceType.PHOTOLIBRARY }
                                        );
        }

        function uploadPhoto(imageURI) {
            var options = new FileUploadOptions();
            options.fileKey="file";
            options.fileName=imageURI.substr(imageURI.lastIndexOf('/')+1);
            options.mimeType="image/jpeg";

            var params = {};
            params.value1 = "test";
            params.value2 = document.getElementById('file_name').value + "";
            params.value3 = document.getElementById('file_description').value + "";
            options.params = params;

            var ft = new FileTransfer();
            ft.upload(imageURI, encodeURI("http://site.com/pages/upload.php"), win, fail, options);
        }

        function win(r) {
            console.log("Code = " + r.responseCode);
            console.log("Response = " + r.response);
            console.log("Sent = " + r.bytesSent);
        }

        function onFileSystemSuccess(fileSystem) {
            console.log(fileSystem.name);
        }

        function onResolveSuccess(fileEntry) {
            console.log(fileEntry.name);
        }

        function fail(evt) {
            console.log(evt.target.error.code);
        }

        function fail(error) {
            alert("An error has occurred: Code = " + error.code);
            console.log("upload error source " + error.source);
            console.log("upload error target " + error.target);
        }

function capturePhoto() {
  // Take picture using device camera, allow edit, and retrieve image as base64-encoded string  
  navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 20, allowEdit: true,
    destinationType: destinationType.DATA_URL });
}

function onPhotoDataSuccess(imageData) {
  // console.log(imageData);

  var smallImage = document.getElementById('smallImage');
  smallImage.style.display = 'block';
  smallImage.src = "data:image/jpeg;base64," + imageData;

  var smallTEXT = document.getElementById('smallTEXT');
  smallTEXT.style.display = 'block';
  smallTEXT.innerHTML = "data:image/jpeg;base64," + imageData;
}

function onPhotoURISuccess(imageURI) {
  // Uncomment to view the image file URI 
  // console.log(imageURI);

  // Get image handle
  //
  var largeImage = document.getElementById('largeImage');

  // Unhide image elements
  //
  largeImage.style.display = 'block';

  largeImage.src = imageURI;
}
function capturePhoto() {
  // Take picture using device camera and retrieve image as base64-encoded string
  navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 50,
    destinationType: destinationType.DATA_URL });
}

// Called if something bad happens.
// 
function onFail(message) {
  alert('Failed because: ' + message);
}

        </script>
</head>
<body> 
```

```
 <h1>Example</h1>
    <p>Upload File</p>

    <form name ="filename" id="file_name_form" action="#">
    Title <br><input type="text" name="name" id="file_name" /><br>
    Description <br><textarea type="text" name="description" id="file_description" /></textarea>
    </form>
    <button onclick="capturePhoto();">Use Camera</button> <br>
    <button onclick="browse();">browse gallery</button><br>
    <img style="display:none;width:160px;" id="smallImage" src="" />
    <hr>
    <div id="smallTEXT">ggg</div>
    <button onclick"uploadPhoto();">submit</button>

</body> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-07-23T19:36:41.410

根据这个答案：[Phonegap android无法使用fileTransfer上传图片](https://stackoverflow.com/questions/11754299/phonegap-android-unable-to-upload-image-using-filetransfer) 你不能直接使用URI....

但是，似乎 uri 可以直接使用......（见下面我的代码）

**编辑 25-7-2013** 我得到了这个工作：像这样调用：

```
navigator.camera.getPicture(onPhotoUriSuccess, onFailCamera, { quality: 50,
        destinationType: pictDestinationType.FILE_URI }); 
```

并成功：

```
function onPhotoUriSuccess(imageUriToUpload){
    var url=encodeURI("http://your_url_for_the_post/");

    var username='your_user';
    var password='your_pwd';

    var params = new Object();
    params.your_param_name = "something";  //you can send additional info with the file

    var options = new FileUploadOptions();
    options.fileKey = "the_name_of_the_image_field"; //depends on the api
    options.fileName = imageUriToUpload.substr(imageUriToUpload.lastIndexOf('/')+1);
    options.mimeType = "image/jpeg";
    options.params = params;
    options.chunkedMode = true; //this is important to send both data and files

    var headers={'Authorization':"Basic " + Base64.encode(username + ":" + password)};
    options.headers = headers;

    var ft = new FileTransfer();
    ft.upload(imageUriToUpload, url, succesFileTransfer, errorFileTransfer, options);

} 
```

顺便说一句，我在 api 网站上使用了一个 apache webserver，我在这里看到，nginx 可能有分块模式的问题： [PhoneGap chunckedMode true upload error](https://stackoverflow.com/questions/9736588/phonegap-chunckedmode-true-upload-error)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-03T17:22:34.627

```
<!DOCTYPE html>
<html>
<head>
<title>Capture Audio,Image,Video</title>
<script type="text/javascript" charset="utf-8" src="cordova-1.9.0.js"></script>
<script type="text/javascript" charset="utf-8" src="json2.js"></script>
<script type="text/javascript" charset="utf-8">
// Called when capture operation is finished
//
function captureSuccess(mediaFiles) {
var i, len;
for (i = 0, len = mediaFiles.length; i < len; i += 1) {
uploadFile(mediaFiles[i]);
}
}
function captureSuccess2(mediaFiles) {
var i, len;
for (i = 0, len = mediaFiles.length; i < len; i += 1) {
uploadFile2(mediaFiles[i]);
}
}
function captureSuccess3(mediaFiles) {
var i, len;
for (i = 0, len = mediaFiles.length; i < len; i += 1) {
uploadFile3(mediaFiles[i]);
}
}
// Called if something bad happens.
//
function captureError(error) {
var msg = "An error occurred during capture: " + error.code;
navigator.notification.alert(msg, null, "Uh oh!");
}
function captureError2(error) {
var msg = "An error occurred during capture: " + error.code;
navigator.notification.alert(msg, null, "Uh oh!");
}
function captureError3(error) {
var msg = "An error occurred during capture: " + error.code;
navigator.notification.alert(msg, null, "Uh oh!");
}
// A button will call this function
//
function captureAudio() {
// Launch device audio recording application,
// allowing user to capture up to 2 audio clips
navigator.device.capture.captureAudio(captureSuccess, captureError, {limit: 2});
}
function captureImage()
{
// Launch device camera application,
// allowing user to capture up to 2 images
navigator.device.capture.captureImage(captureSuccess2, captureError2, {limit: 2});
}
function captureVideo() {
// Launch device video recording application,
// allowing user to capture up to 2 video clips
navigator.device.capture.captureVideo(captureSuccess3, captureError3, {limit: 2});
}
// Upload files to server
function uploadFile(mediaFile) {
var win = function (r) {
alert("Code = " + r.responseCode);
alert("Bytes Sent = " + r.bytesSent);
alert("Audio Uploaded");
}
var fail = function (error) {
alert("An error has occurred: Code = " + error.code);
alert("upload error source " + error.source);
alert("upload error target " + error.target);
}
var options = new FileUploadOptions();
//options.fileKey = mediafile.file;
options.fileName = mediaFile.file;
options.mimeType = "audio/wav";
fileURL=mediaFile.fullPath;
var ft = new FileTransfer();
ft.upload(fileURL, encodeURI("http://192.168.1.101:80/myfile.php"), win, fail,
options);
}
function uploadFile2(mediaFile) {
var win = function (r) {
alert("Code = " + r.responseCode);
alert("Bytes Sent = " + r.bytesSent);
alert("Image Uploaded");
}
var fail = function (error) {
alert("An error has occurred: Code = " + error.code);
alert("upload error source " + error.source);
alert("upload error target " + error.target);
}
var options = new FileUploadOptions();
//options.fileKey = mediafile.file;
options.fileName = mediaFile.file;
options.mimeType = "text/plain";
ImageURL=mediaFile.fullPath;
var ft = new FileTransfer();
ft.upload(ImageURL, encodeURI("http://192.168.1.101:80/myfile.php"), win, fail,
options);
}
function uploadFile3(mediaFile) {
var win = function (r) {
alert("Code = " + r.responseCode);
alert("Bytes Sent = " + r.bytesSent);
alert("Video Uploaded");
}
var fail = function (error) {
alert("An error has occurred: Code = " + error.code);
alert("upload error source " + error.source);
alert("upload error target " + error.target);
}
var options = new FileUploadOptions();
//options.fileKey = mediafile.file;
options.fileName = mediaFile.file;
options.mimeType = "video/mpeg";
VideoURL=mediaFile.fullPath;
var ft = new FileTransfer();
ft.upload(VideoURL, encodeURI("http://192.168.1.101:80/myfile.php"), win, fail,
options);
}
</script>
</head>
<body>
<center><h1>MCA3B Capture Session</h1></center><br><br>
<center> <button onclick="captureAudio();">Capture Audio</button> <br><br>
<button onclick="captureImage();">Capture Image</button> <br><br>
<button onclick="captureVideo();">Capture Video</button> <br>
</center>
</body>
</html> 
```

以上是捕获图像、音频和视频并将其上传到本地服务器的代码。

# c++ - 将四元数转换为欧拉角。Y角范围问题

> ID：14447338
> 
> 赞同：1
> 
> 时间：2013-01-21T21:15:51.720
> 
> 标签：c++, math, 3d, irrlicht, ode-library

我正在尝试使用 Irrlicht 作为图形引擎和物理 ODE 在 C++ 中编写 3d 模拟。然后我使用一个函数将 ODE 四元数转换为 Irrlicht Euler 角。为了做到这一点，我正在使用这段代码。

```
void QuaternionToEuler(const dQuaternion quaternion, vector3df &euler)
{
    dReal w,x,y,z;

    w = quaternion[0];
    x = quaternion[1];
    y = quaternion[2];
    z = quaternion[3];

    double sqw = w*w;    
    double sqx = x*x;    
    double sqy = y*y;    
    double sqz = z*z; 

    euler.Z = (irr::f32) (atan2(2.0 * (x*y + z*w),(sqx - sqy - sqz + sqw)) * (180.0f/irr::core::PI));
    euler.X = (irr::f32) (atan2(2.0 * (y*z + x*w),(-sqx - sqy + sqz + sqw)) * (180.0f/irr::core::PI));          
    euler.Y = (irr::f32) (asin(-2.0 * (x*z - y*w)) * (180.0f/irr::core::PI));

} 
```

它可以很好地绘制正确的位置和旋转，但问题与`asin`指令有关。它只返回`0..90`-范围内的值`0..-90`，我需要从`0..360`度数中获取一个范围。至少我需要`0..360`在我打电话时的范围内进行轮换`node->getRotation().Y`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T21:41:58.203

欧拉角（任何类型）具有奇点。在您使用的那些特定欧拉角的情况下（看起来像 Tait-Bryan 角或其一些变体），奇点位于正负 90 度的俯仰角 (Y)。这是欧拉角的固有限制，也是它们很少在任何严肃环境中使用的主要原因之一（飞机动力学除外，因为所有飞机的速度矢量（可能不是水平的）俯仰能力非常有限，所以它们很少靠近那个奇点）。

这也意味着您的计算实际上只是两个等效解决方案之一。对于给定的四元数，欧拉角有两种解法，代表相同的旋转，一种在奇点的一侧，另一种反映第一个。由于两种解决方案是等效的，您只需选择最简单的一侧，即俯仰角在 -90 到 90 度之间的那个。

此外，您的代码需要处理接近奇点以避免获得 NaN。换句话说，您必须检查您是否接近（小公差）奇异点（俯仰角为 -90 和 90 度），如果是，请使用替代公式（只能计算一个最接近的角度）旋转）。

如果您有任何方法可以完全避免使用欧拉角，我强烈建议您这样做，几乎任何旋转表示都比欧拉角更可取。Irrlicht 本机使用矩阵，还支持通过[轴角表示](http://irrlicht.sourceforge.net/docu/classirr_1_1core_1_1_c_matrix4.html#a2fad61540e78fc7dafe7f6270b0558ac)设置/获取旋转，这更容易使用（并且更容易从四元数获得，并且没有奇点）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:38:49.000

想想地球的地球。其上的每个点只能使用纬度（在范围内`[-90, 90]`）和经度（在范围内`[-180, 180]`）来定义。因此，可以使用这些角度来指定球体上的每个点。现在球体上的一个点指定一个向量，球体上的所有点指定所有可能的向量。[因此，正如本文](http://en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles)所指出的，您使用的公式将生成所有可能的方向。

希望这可以帮助。

# javascript - 附有 javascript 魔法的复选框不会取消选中

> ID：14447348
> 
> 赞同：0
> 
> 时间：2013-01-21T21:16:24.710
> 
> 标签：javascript, checkbox

我有一个脚本，如果选中了复选框，我会在其中使用复选框和 javascript 来显示其他项目。这似乎在大多数时候工作得很好。但是有一个复选框会出现问题。我假设是因为与之相关的 javascript 魔法。选中它然后取消选中它时，复选框总是在发布后返回 isset。

永远不要选中复选框并提交未按应有设置的退货。检查和提交退货检查，因为它应该检查，取消检查和提交退货......检查！我在[http://vampke.uphero.com/tst.php上设置了一个示例](http://vampke.uphero.com/tst.php)

这是代码：

```
if($_SERVER['REQUEST_METHOD'] == 'POST') {
if(isset($_POST['se_currentitem'])) echo "CHECKBOX = ISSET";
else echo "CHECKBOX = NOT SET";
}

echo <<< EOD

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>test</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<style type="text/css">
.hiddenDiv {display: none;}
.visibleDiv{display: block;}
</style>
</head>
<body>
<script language="javascript" type="text/javascript">
<!--

var currentitem = 0;

function toggle_currentitem(){
mydiv = document.getElementById("currentitemcontainer");
if (document.getElementById('se_currentitem').checked){
mydiv.className = "visibleDiv";
if(currentitem==0){
addcurrentitem();
}
}
else {
mydiv.className = "hiddenDiv";
}
}

function addcurrentitem(){
currentitem++;
var newitem = document.createElement('div');
newitem.id = currentitem;
newitem.innerHTML= "<p><strong><em>new item</em></strong><br /><label>select a number:</label><select name='se_currentitem[]'><option value='1'>1</option><option value='2'>2</option><option value='3'>3</option><option value='4'>4</option><option value='5'>5</option></select></p>";

document.getElementById('currentitem').appendChild(newitem); 
}

//-->
</script>
<form action ="" method="post">
<input type="checkbox" id="se_currentitem" name="se_currentitem" value="1" onchange="toggle_currentitem()" /><label for="se_currentitem">click the checkbox to activate the items</label> <br />

<div id="currentitemcontainer" class="hiddenDiv">
<div id="currentitem"></div>
<a id='addnewcurrent' onclick='addcurrentitem()'>add item</a>
</div>
<input type="submit" name="submit" value="submit" />
</form>
</body>
</html> 
```

有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:22:19.757

复选框被命名`se_currentitem`，`select`菜单被命名`se_currentitem[]`。PHP 的`$_POST`数组将这些视为相同。

*   当您选中该框时，您将创建`select`菜单。
*   当您取消选中该框时，您隐藏了`select`菜单，但它仍保留在 DOM 中，并由浏览器提交。注意网络检查器（或 tcpflow 等）。浏览器同时提交`se_currentitem`和`se_currentitem[]`。

您应该重命名复选框以使其不被调用`se_currentitem`（或重命名`select`菜单以使其不被调用`se_currentitem[]`）。

# sql - 如何在 SQL Server 中使用 TRIM 函数

> ID：14447350
> 
> 赞同：36
> 
> 时间：2013-01-21T21:16:31.510
> 
> 标签：sql, sql-server, trim

我无法让这个 TRIM 代码工作

```
SELECT 
   dbo.COL_V_Cost_GEMS_Detail.TNG_SYS_NR AS [EHP Code], 
   dbo.COL_TBL_VCOURSE.TNG_NA AS [Course Title], 
   LTRIM(RTRIM(FCT_TYP_CD)& ') AND (' & LTRIM(RTRIM(DEP_TYP_ID) & ')' AS [Course Owner] 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-01-21T21:18:35.210

您缺少两个右括号......而且我不确定＆符号是否可以用作字符串连接运算符。试试“+”

```
SELECT dbo.COL_V_Cost_GEMS_Detail.TNG_SYS_NR AS [EHP Code], 
dbo.COL_TBL_VCOURSE.TNG_NA AS [Course Title], 
LTRIM(RTRIM(FCT_TYP_CD)) + ') AND (' + LTRIM(RTRIM(DEP_TYP_ID)) + ')' AS [Course Owner] 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-10-31T13:13:49.467

`TRIM`所有`SPACE`' `TAB`s 和`ENTER`'s:

```
DECLARE @Str VARCHAR(MAX) = '      
          [         Foo    ]       
          '

DECLARE @NewStr VARCHAR(MAX) = ''
DECLARE @WhiteChars VARCHAR(4) =
      CHAR(13) + CHAR(10) -- ENTER
    + CHAR(9) -- TAB
    + ' ' -- SPACE

;WITH Split(Chr, Pos) AS (
    SELECT
          SUBSTRING(@Str, 1, 1) AS Chr
        , 1 AS Pos
    UNION ALL
    SELECT
          SUBSTRING(@Str, Pos, 1) AS Chr
        , Pos + 1 AS Pos
    FROM Split
    WHERE Pos <= LEN(@Str)
)
SELECT @NewStr = @NewStr + Chr
FROM Split
WHERE
    Pos >= (
        SELECT MIN(Pos)
        FROM Split
        WHERE CHARINDEX(Chr, @WhiteChars) = 0
    )
    AND Pos <= (
        SELECT MAX(Pos)
        FROM Split
        WHERE CHARINDEX(Chr, @WhiteChars) = 0
    )

SELECT '"' + @NewStr + '"' 
```

# 作为函数

```
CREATE FUNCTION StrTrim(@Str VARCHAR(MAX)) RETURNS VARCHAR(MAX) BEGIN
    DECLARE @NewStr VARCHAR(MAX) = NULL

    IF (@Str IS NOT NULL) BEGIN
        SET @NewStr = ''

        DECLARE @WhiteChars VARCHAR(4) =
              CHAR(13) + CHAR(10) -- ENTER
            + CHAR(9) -- TAB
            + ' ' -- SPACE

        IF (@Str LIKE ('%[' + @WhiteChars + ']%')) BEGIN

            ;WITH Split(Chr, Pos) AS (
                SELECT
                      SUBSTRING(@Str, 1, 1) AS Chr
                    , 1 AS Pos
                UNION ALL
                SELECT
                      SUBSTRING(@Str, Pos, 1) AS Chr
                    , Pos + 1 AS Pos
                FROM Split
                WHERE Pos <= LEN(@Str)
            )
            SELECT @NewStr = @NewStr + Chr
            FROM Split
            WHERE
                Pos >= (
                    SELECT MIN(Pos)
                    FROM Split
                    WHERE CHARINDEX(Chr, @WhiteChars) = 0
                )
                AND Pos <= (
                    SELECT MAX(Pos)
                    FROM Split
                    WHERE CHARINDEX(Chr, @WhiteChars) = 0
                )
        END
    END

    RETURN @NewStr
END 
```

### 例子

```
-- Test
DECLARE @Str VARCHAR(MAX) = '      
          [         Foo    ]       
              '

SELECT 'Str', '"' + dbo.StrTrim(@Str) + '"'
UNION SELECT 'EMPTY', '"' + dbo.StrTrim('') + '"'
UNION SELECT 'EMTPY', '"' + dbo.StrTrim('      ') + '"'
UNION SELECT 'NULL', '"' + dbo.StrTrim(NULL) + '"' 
```

**结果**

```
+-------+----------------+
| Test  | Result         |
+-------+----------------+
| EMPTY | ""             |
| EMTPY | ""             |
| NULL  | NULL           |
| Str   | "[   Foo    ]" |
+-------+----------------+ 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-21T21:20:23.807

```
LTRIM(RTRIM(FCT_TYP_CD)) & ') AND (' & LTRIM(RTRIM(DEP_TYP_ID)) & ')' 
```

我认为你`)`在两个装饰上都缺少一个。一些 SQL 版本只支持 TRIM，它同时进行 L 和 R 修剪...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-29T12:31:05.870

例子：

```
DECLARE @Str NVARCHAR(MAX) = N'
            foo   bar
        Foo           Bar        

'

PRINT '[' + @Str + ']'

DECLARE @StrPrv NVARCHAR(MAX) = N''

WHILE ((@StrPrv <> @Str) AND (@Str IS NOT NULL)) BEGIN
    SET @StrPrv = @Str

    -- Beginning
    IF EXISTS (SELECT 1 WHERE @Str LIKE '[' + CHAR(13) + CHAR(10) + CHAR(9) + ']%')
        SET @Str = LTRIM(RIGHT(@Str, LEN(@Str) - 1))

    -- Ending
    IF EXISTS (SELECT 1 WHERE @Str LIKE '%[' + CHAR(13) + CHAR(10) + CHAR(9) + ']')
        SET @Str = RTRIM(LEFT(@Str, LEN(@Str) - 1))
END

PRINT '[' + @Str + ']' 
```

结果

```
[
            foo   bar
        Foo           Bar        

]
[foo   bar
        Foo           Bar] 
```

# 使用 fnTrim

来源：[https ://github.com/reduardo7/fnTrim](https://github.com/reduardo7/fnTrim)

```
SELECT dbo.fnTrim(colName) 
```

# javascript - 使用 javascript 正则表达式解析 url 以获取 id

> ID：14447355
> 
> 赞同：0
> 
> 时间：2013-01-21T21:16:45.260
> 
> 标签：javascript, regex, url, backbone.js, url-routing

我正在编写一个路由器，它将解析 url 并重定向到代码中的必要组件，当我更改我的 url 并使用它传递对象 id 时，我想使用正则表达式解析它并路由它以通过 id 获取该对象。

```
mysite.com/blah#path=folder/?folderId=klafjlka 
```

如何使用 javscript 正则表达式解析此 url 并将其路由到该文件夹

关于主干，我想编写一个代码来执行此操作，但我没有使用主干

```
routes : { "folder/:id" : "handler" }, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:27:04.373

我倾向于发现在这些情况下使用 .split 通常会创建更具可读性的代码。

如果您最初使用 window.location.hash 来获取数据，那么您将剩下

```
#path=folder/?folderId=klafjlka 
```

消除第一批不需要的东西。其余的可以简单地通过拆分和循环拆分来完成。

```
//Remove the initial hash from the window.location.hash
var hash = window.location.hash.substr(1),
    //Split it down so we have ["path=folder","folderId=klafjlka"]
    paramSplit = hash.split("/?");

var params = {};
for (var x=0; x<paramSplit.length; x++){
  //Split it at the equals
  var split = paramSplit[x].split("=");
  params[split[0]]=split[1];
}

console.log(params); 
```

参数应该返回

```
{
  path: "folder",
  folderId: "klafjlka"
} 
```

无论您的目的是什么，它都很容易使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:25:57.690

如果您的 url 在字符串中并且始终具有相同的结构

```
var url = 'mysite.com/blah#path=folder/?folderId=klafjlka';
var re = /#path=(.+?)\?folderId=(.*)/i
var args = url.match(re);
var path = args[1];
var id = args[2]; 
```

这将搜索`#path=`并捕获以下字符，直到`?`然后搜索`?folderId=`并捕获其他所有内容。

现在`path`将包含`folder/`并将`id`包含`klafjlka`。

# c - WskSocketConnect - 可能的内存损坏问题？

> ID：14447360
> 
> 赞同：1
> 
> 时间：2013-01-21T21:17:03.460
> 
> 标签：c, windows, driver, wdk

我正在尝试使用驱动程序中的 WinSock API 连接到另一台计算机。问题是`WskSocketConnect`（`WskConnect`如果我走那条路）失败了`STATUS_INVALID_ADDRESS`. 我的代码是：

```
#pragma warning(push)
#pragma warning(disable:4510)
#pragma warning(disable:4512)
#pragma warning(disable:4610)

#include <ntddk.h>
#include <wsk.h>

#pragma warning(pop)

const WSK_CLIENT_DISPATCH WskClientDispatch = {
    MAKE_WSK_VERSION(1, 0),
    0,
    NULL
};

WSK_REGISTRATION WskRegistration;

typedef struct _ASYNCHRONOUS_OPERATION_CONTEXT {
    KEVENT Event;
    PIRP Irp;
} ASYNCHRONOUS_OPERATION_CONTEXT, *PASYNCHRONOUS_OPERATION_CONTEXT;

extern "C" DRIVER_INITIALIZE DriverEntry;
extern "C" DRIVER_UNLOAD DriverUnload;
extern "C" KSTART_ROUTINE WorkerThread;
extern "C" IO_COMPLETION_ROUTINE SyncIrpCompletionRoutine;
extern "C" NTSTATUS WorkerThreadImpl();
extern "C" NTSTATUS InitializeAsynchronousOperationContext(PASYNCHRONOUS_OPERATION_CONTEXT Context);
extern "C" void FreeAsynchronousOperationContext(PASYNCHRONOUS_OPERATION_CONTEXT Context);
extern "C" void ReuseAsynchronousOperationContext(PASYNCHRONOUS_OPERATION_CONTEXT Context);
extern "C" NTSTATUS WaitForOperation(PASYNCHRONOUS_OPERATION_CONTEXT Context, NTSTATUS DispatchStatus);

NTSTATUS
    DriverEntry(
    __in PDRIVER_OBJECT DriverObject,
    __in PUNICODE_STRING RegistryPath
    );

VOID
    WorkerThread(
    __in PVOID Context
    );

VOID
    DriverUnload(
    __in PDRIVER_OBJECT DriverObject
    );

#ifdef ALLOC_PRAGMA

#pragma alloc_text(INIT, DriverEntry)
#pragma alloc_text(PAGE, DriverUnload)
#pragma alloc_text(PAGE, WorkerThread)
#pragma alloc_text(PAGE, WorkerThreadImpl)
#pragma alloc_text(PAGE, InitializeAsynchronousOperationContext)
#pragma alloc_text(PAGE, FreeAsynchronousOperationContext)
#pragma alloc_text(PAGE, ReuseAsynchronousOperationContext)
#pragma alloc_text(PAGE, WaitForOperation)

#endif

#define DATA_BUFFER_POOL_TAG 'wskt'

NTSTATUS
    DriverEntry(
    __in PDRIVER_OBJECT DriverObject,
    __in PUNICODE_STRING RegistryPath
    )
{
    NTSTATUS status;
    HANDLE threadHandle;
    WSK_CLIENT_NPI wskClientNpi;

    UNREFERENCED_PARAMETER(RegistryPath);

    PAGED_CODE();

    DbgPrint("Loading");

    wskClientNpi.ClientContext = NULL;
    wskClientNpi.Dispatch = &WskClientDispatch;
    status = WskRegister(&wskClientNpi, &WskRegistration);

    if (!NT_SUCCESS(status)) {
        return status;
    }

    status = PsCreateSystemThread(
        &threadHandle, THREAD_ALL_ACCESS, NULL, NULL, NULL,
        WorkerThread, NULL);

    if (!NT_SUCCESS(status)) {
        WskDeregister(&WskRegistration);
        return status;
    }

    ZwClose(threadHandle);

    DriverObject->DriverUnload = DriverUnload;

    DbgPrint("Loaded");

    return STATUS_SUCCESS;
}

VOID
    DriverUnload(
    __in PDRIVER_OBJECT DriverObject
    )
{  
    UNREFERENCED_PARAMETER(DriverObject);

    PAGED_CODE();

    DbgPrint("Unloading");
    WskDeregister(&WskRegistration);
    DbgPrint("Unloaded");
}

WSK_PROVIDER_NPI wskProviderNpi;
//CHAR Foo[10]; // padding
PCHAR DataBuffer;

USHORT htons(USHORT value)
{
    return value >> 8 | ((value & 0xff) << 8);
}

NTSTATUS InitializeAsynchronousOperationContext(PASYNCHRONOUS_OPERATION_CONTEXT Context)
{
    PAGED_CODE();

    Context->Irp = IoAllocateIrp(1, FALSE);
    if (Context->Irp == NULL) {
        return STATUS_INSUFFICIENT_RESOURCES;
    }

    KeInitializeEvent(&Context->Event, SynchronizationEvent, FALSE);

    IoSetCompletionRoutine(Context->Irp,
        SyncIrpCompletionRoutine,
        &Context->Event, TRUE, TRUE, TRUE);

    return STATUS_SUCCESS;
}

void FreeAsynchronousOperationContext(PASYNCHRONOUS_OPERATION_CONTEXT Context)
{
    PAGED_CODE();

    IoFreeIrp(Context->Irp);
}

void ReuseAsynchronousOperationContext(PASYNCHRONOUS_OPERATION_CONTEXT Context)
{
    PAGED_CODE();

    IoReuseIrp(Context->Irp, STATUS_UNSUCCESSFUL);
    IoSetCompletionRoutine(Context->Irp,
        SyncIrpCompletionRoutine,
        &Context->Event, TRUE, TRUE, TRUE);
}

NTSTATUS WaitForOperation(PASYNCHRONOUS_OPERATION_CONTEXT Context, NTSTATUS DispatchStatus)
{
    PAGED_CODE();

    if (DispatchStatus == STATUS_PENDING) {
        KeWaitForSingleObject(&Context->Event, Executive, KernelMode, FALSE, NULL);
    }

    return Context->Irp->IoStatus.Status;
}

NTSTATUS WorkerThreadImpl()
{
    PAGED_CODE();

    NTSTATUS status;

    status = WskCaptureProviderNPI(
        &WskRegistration, 
        WSK_INFINITE_WAIT,
        &wskProviderNpi);

    if (!NT_SUCCESS(status)) {
        DbgPrint("WskCaptureProviderNPI FAIL");
        return status;
    }

    DataBuffer = (PCHAR) ExAllocatePoolWithTag(NonPagedPool, PAGE_SIZE, DATA_BUFFER_POOL_TAG);
    if (DataBuffer == NULL) {
        WskReleaseProviderNPI(&WskRegistration);
        return STATUS_INSUFFICIENT_RESOURCES;
    }

    ASYNCHRONOUS_OPERATION_CONTEXT OperationContext;
    status = InitializeAsynchronousOperationContext(&OperationContext);
    if (!NT_SUCCESS(status)) {
        WskReleaseProviderNPI(&WskRegistration);
        ExFreePoolWithTag(DataBuffer, DATA_BUFFER_POOL_TAG);
        return status;
    }

    SOCKADDR_IN localAddr  = { AF_INET, 0, IN4ADDR_ANY_INIT };
    SOCKADDR_IN remoteAddr = { AF_INET, htons(7777), IN4ADDR_LOOPBACK_INIT };
    DbgPrint("%p", DataBuffer);

    status = wskProviderNpi.Dispatch->WskSocketConnect(&wskProviderNpi.Client,
        SOCK_STREAM, IPPROTO_TCP,
        (PSOCKADDR) &localAddr, (PSOCKADDR) &remoteAddr, 0,
        NULL, NULL, NULL, NULL, NULL,
        OperationContext.Irp);
    // BUGBUG here, DataBuffer has changed since the previous DbgPrint()
    DbgPrint("%p", DataBuffer);
    status = WaitForOperation(&OperationContext, status);

    if (NT_SUCCESS(status)) {
        PWSK_SOCKET socket = (PWSK_SOCKET) OperationContext.Irp->IoStatus.Information;
        PWSK_PROVIDER_CONNECTION_DISPATCH connectionDispatch = (PWSK_PROVIDER_CONNECTION_DISPATCH) socket->Dispatch;
        ReuseAsynchronousOperationContext(&OperationContext);
        status = connectionDispatch->Basic.WskCloseSocket(socket, OperationContext.Irp);
        status = WaitForOperation(&OperationContext, status);
    }

    FreeAsynchronousOperationContext(&OperationContext);

    WskReleaseProviderNPI(&WskRegistration);
    ExFreePoolWithTag(DataBuffer, DATA_BUFFER_POOL_TAG);
    return STATUS_SUCCESS;
}

VOID
    WorkerThread(
    __in PVOID Context
    )
{
    UNREFERENCED_PARAMETER(Context);

    PAGED_CODE();

    PsTerminateSystemThread(WorkerThreadImpl());
}

NTSTATUS
    SyncIrpCompletionRoutine(
    __in PDEVICE_OBJECT Reserved,
    __in PIRP Irp,
    _In_reads_opt_(_Inexpressible_("varies")) PVOID Context
    )
{    
    UNREFERENCED_PARAMETER(Reserved);
    UNREFERENCED_PARAMETER(Irp);

    ASSERT(Context != NULL);

    if (Irp->PendingReturned) {
        KeSetEvent((PKEVENT) Context, 2, FALSE);
    }

    return STATUS_MORE_PROCESSING_REQUIRED;
} 
```

`0xc0000141`调用与( )同步失败`STATUS_INVALID_ADDRESS`。我确实有一个应用程序在本地主机上的该端口上侦听，并且它与远程计算机的行为方式相同。

任何提示将不胜感激！

**编辑**现在事情变得越来越奇怪了。我用我的完整文件更新了源代码。

我发现了问题`WskSocketConnect`：我正在重构东西，我试图将`WskCaptureProviderNPI`and移动`WskReleaseProviderNPI`到不同的函数，但我开始遇到另一个错误。这很奇怪，所以我把我的`WSK_PROVIDER_NPI`全局设置为——它起作用了。

稍后，我尝试在该套接字上发送一条消息，但我在它之前收到了两个字节的垃圾。经过几个小时和一些调试消息后，我注意到`WskSocketConnect`调用后缓冲区地址发生了变化。现在，缓冲区地址也是一个全局变量，在我的`WSK_PROVIDER_NPI`结构之后声明。添加一些填充（搜索“ `Foo`”和“ `WorkerThread()`”）修复它。

现在怎么办？我对此完全陌生，但看起来内存损坏是由`Wsk`函数引起的，特别是因为我的代码`DriverEntry`并没有在`WskSocketConnect`调用之间运行。有任何想法吗？

这是在 Windows 7 x64 上。

**更新 2** 我在代码开头禁用的编译警告如下：

```
warning C4510: '_WSK_TDI_MAP_INFO' : default constructor could not be generated
warning C4512: '_WSK_TDI_MAP_INFO' : assignment operator could not be generated
warning C4610: struct '_WSK_TDI_MAP_INFO' can never be instantiated - user defined constructor required 
```

我想将文件编译为 C 会修复它们。

关于 my `WSK_CLIENT_NPI`，文档`WskRegister`没有提到它应该保持有效（就像它对另一个参数所做的那样），并且`echosrv`DDK 中的示例做同样的事情。可以肯定的是，我尝试将其设为全球性，但我得到了相同的行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T10:10:48.040

我不建议忽略或禁用警告，因为警告可以很好地指示代码可能无法执行您想要的操作。自豪地炫耀您的警告，我们将帮助您以标准方式删除它们。确保向我们展示警告所在的行以及警告消息。在我看来，您可能正在调用未定义的行为，而警告可能会突出显示这一点。

带有前导下划线的标识符也可能很麻烦，因为这种格式是为 OS API、编译器和标准库保留的。请重命名 _ASYNCHRONOUS_OPERATION_CONTEXT。

%p 告诉 DbgPrint（它使用 printf 格式说明符）期望哪种指针？空白 *。我建议进行一些转换，以处理 printf 引起问题的不太可能的情况。

似乎 &wskProviderNpi.Client 旨在引用与 &wskClientNpi 相同的对象。这里的问题是当 DriverEntry 返回时 wskClientNpi 将被销毁，从而导致您提到的“STATUS_INVALID_ADDRESS”错误（以一种活泼的方式）。您是否尝试将 wskClientNpi 声明直接放在 wskRegistration 声明下方？

# c# - 在简单 Lucene 中使用 IndexService

> ID：14447361
> 
> 赞同：0
> 
> 时间：2013-01-21T21:17:04.673
> 
> 标签：c#, lucene, azure-storage

我继承了一些使用 Simple Lucene 的代码。我对简单的 Lucene 知之甚少。现在，代码依赖于`IndexService`索引实体。使用以下代码：

```
using (var indexService = GetIndexService())
{
  indexService.IndexEntities(cachedResults, p =>
  {
    var document = new Document();
    document.Add(new Field("Name", p.Name, Field.Store.YES, Field.Index.NOT_ANALYZED));
    document.Add(new Field("ID", p.ID, Field.Store.YES, Field.Index.NOT_ANALYZED));
    document.Add(new Field("Description", p.Description, Field.Store.YES, Field.Index.NOT_ANALYZED));
    return document;
  });
} 
```

`GetIndexService`返回一个`SimpleLucene.Impl.DirectorySerivce`实例。这种方法用于将索引存储在本地机器上。但是，现在我需要将其移动到 Windows Azure 存储 blob。为了做到这一点，我依赖于在以下位置找到的库：[https](https://github.com/richorama/AzureDirectory) ://github.com/richorama/AzureDirectory 。

此处显示的示例返回一个`Lucene.Net.Index.IndexWriter`. 我不知道如何通过现有的方法使用这个对象。这些类型似乎完全不兼容。我想做的就是为索引文件使用不同的存储位置。有没有办法做到这一点？如果是这样，如何。我在这里完全是一条小溪。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:34:26.123

看起来`IndexEntities`像[这样](https://bitbucket.org/retroviz/lucenetests/src/24d5ad1f63c6/SimpleLucene/Impl/IndexService.cs)：

```
public int IndexEntities<TEntity>(DirectoryInfo indexLocation, IEnumerable<TEntity> entities, Func<TEntity, Document> converter)
{
    using (var indexer = new IndexWriterWrapper(indexLocation)) {
        int indexCount = 0;
        foreach (TEntity entity in entities) {
            indexer.Writer.AddDocument(converter(entity));
            indexCount++;
        }
        return indexCount;
    }
} 
```

基本上，它打开一个 IndexWriter，遍历一个实体列表，将它们转换为文档，并通过 writer 将它们添加到索引中，并返回一个计数。

您表示您从包中返回了一个 IndexWriter，因此您无需担心创建一个。您正在创建一个文档，因此不需要映射（转换器可以对传入的文档进行一些更改，我想，但可能不会），而您只是在创建一个，因此迭代或计数并不是真正必要的。剩下的就是添加文档，通过`IndexWriter.addDocument(Document)`

```
var writer = //However you get the writer...
var document = new Document();
document.Add(new Field("Name", p.Name, Field.Store.YES, Field.Index.NOT_ANALYZED));
document.Add(new Field("ID", p.ID, Field.Store.YES, Field.Index.NOT_ANALYZED));
document.Add(new Field("Description", p.Description, Field.Store.YES, Field.Index.NOT_ANALYZED));
writer.addDocument(document); 
```

# javascript - 需要帮助设置 ng-grid

> ID：14447367
> 
> 赞同：0
> 
> 时间：2013-01-21T21:17:40.887
> 
> 标签：javascript, angularjs, ng-grid

我有一些 JSON 数据，我想尝试使用 ng-grid。在线查看一些示例，它没有显示如何将数据从应用程序位置放入网格。这就是我到目前为止所拥有的。

```
function DataCtrl($scope, Json) {
   $scope.Data = Json.query(); // Here we want to query for all Json data
   console.log($scope.Data);
}; 
```

有谁知道如何获取这个数组`Json.query`并将其放在 ng-grid 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:44:13.820

[ng-grid](http://angular-ui.github.com/ng-grid/#/examples)站点上的示例非常易于解释。我想知道您的问题是否正在返回数据。您的 $scope.Data 对象应该已返回 Json 对象，一旦您确定拥有它们，将它们添加到网格中就非常容易。

下面是来自 ng-grid 站点的基本示例代码：

HTML：

```
<body ng-controller="MyCtrl">
    <div class="gridStyle" ng-grid="gridOptions"></div>
</body 
```

Javascript：

```
var app = angular.module('myApp', ['ngGrid']);
app.controller('MyCtrl', function($scope) {
    $scope.myData = [{name: "Moroni", age: 50},
                     {name: "Tiancum", age: 43},
                     {name: "Jacob", age: 27},
                     {name: "Nephi", age: 29},
                     {name: "Enos", age: 34}];
    $scope.gridOptions = { data: 'myData' };
}); 
```

[Plunker 示例](http://plnkr.co/edit/T6qaQX?p=preview)

这是 AngularJS 的一个模块，所以我建议花一点时间来学习它。这是一个值得学习的漂亮框架。一旦您了解了 AngularJS 的基础知识，这可能会更有意义。

# go - Web Socket 连接中的 Http 重定向 [现在更好地解释]

> ID：14447376
> 
> 赞同：1
> 
> 时间：2013-01-21T21:18:02.353
> 
> 标签：go

我认为我最初的问题（见栏下方）太含糊了。我编造了以下愚蠢的例子来说明我的观点。

```
package main

import (
    "fmt"
    "net/http"
    "time"
)

func main() {
    http.HandleFunc("/redir", redirHandler)
    http.HandleFunc("/", rootHandler)
    _ = http.ListenAndServe("localhost:4000", nil)
}

func redirHandler(w http.ResponseWriter, r *http.Request) {
    fmt.Fprint(w, "hello, this is redir which will host the foreign html page")
}

func rootHandler(w http.ResponseWriter, r *http.Request) {
    fmt.Fprint(w, "hello, this is root")

    // at some point "foreign webserver" sends me a complete
    // html page.
    // I want to serve this page at "/redir/", and I feel my
    // best shot is to redirect to "/redir"
    time.Sleep(2 * time.Second)

    http.Redirect(w, r, "/redir/", http.StatusFound)
} 
```

此代码不起作用，因为我无法重新使用 w 来执行重定向。那么，在这种情况下是否可以重定向，例如通过另一个 http 包调用？

我希望我已经把自己说清楚了...

提前致谢

克里斯

* * *

我正在以下配置中的“我的服务器”上工作

```
[web browser client] -- [my server] -- [foreign webservice] 
```

“我的服务器”为“Web 浏览器客户端”提供以下内容

```
func main() {
    http.HandleFunc("/launch", launchHandler)
    http.HandleFunc("/", rootHandler)
    http.Handle("/socket", websocket.Handler(socketHandler))
    err := http.ListenAndServe(listenAddr, nil)
    if err != nil {
        log.Fatal(err)
    }
} 
```

RootHandler向“web浏览器客户端”写入一个html页面，socketHandler在“web浏览器客户端”和“我的服务器”之间建立websocket连接。

来自“Web 浏览器客户端”的请求通过 Web 套接字连接到达并由“我的服务器”处理，“我的服务器”与“外部 Web 服务”通信以确定响应。

通常，“外国网络服务”会提供一些数据，“我的服务器”使用这些数据来响应“网络浏览器客户端”。

在某些情况下，“外部网络服务”会以完整的 html 页面进行响应。

我不确定如何将此类 html 页面传达给“网络浏览器客户端”

到目前为止，我最好的猜测是执行 http.Redirect() 到 launchHandler 以便 launchHandler 可以将从“外国 Web 服务器”获得的 html 页面写入“Web 浏览器客户端”。（关闭 web socket 连接时没有问题。）

为此，我使用 http.ResponseWriter、*http.Request 作为 httpRedirect 的参数，这些参数首先在 rootHandler 中接收。

这不起作用并产生日志消息：“http：multiple response.WriteHeader calls”

对于如何解决这个问题，有任何的建议吗？也许我执行 http.Redirect 的方法是错误的；也许我应该获取其他 http.ResponseWriter 和/或 *http.Request 值。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T07:24:18.787

从您给出的新示例中，您需要更改一些内容：

*   只要您调用 fmt.Fprint，您就会返回一个响应，从而返回一个标头（状态码为 200）。检查[http://golang.org/pkg/net/http/#ResponseWriter](http://golang.org/pkg/net/http/#ResponseWriter)

    `// Changing the header after a call to WriteHeader (or Write) has no effect.`

如果您想要一个简单的重定向，请忽略`fmt.Fprint(w, "hello, this is root")`.

*   `/redir`并且`/redir/`是不同的端点。您需要更改处理程序的 URL 或重定向。
*   如果你想显示一个页面，然后在后台下载后重定向，我建议使用带有第三个处理程序的 Javascript，你可以从根处理程序返回的 HTML 页面在后台调用它，并有一个重定向的回调用户一旦完成

例如..：

```
 +------------+ $.GET +---------------------+   
   | Root page  | ----> |  Background handler |  
   |            |       +---------+-----------+
   |            |                 |
   +------------+ <---Task done---+
         |
         v [redirect using JS]
    +---------------+  
    |/redir/ handler|
    +---------------+ 
```

另一种选择可能是使用 iframe 来显示“外国网页”。

# css - 添加css渐变

> ID：14447384
> 
> 赞同：0
> 
> 时间：2013-01-21T21:18:39.483
> 
> 标签：css

我使用这个 css 代码在 jsf 页面上可视化绿色背景：

```
.container{
    background:-webkit-gradient(linear, left top, left bottom, color-stop(0, #5fa309), color-stop(1, #3b8018));
    background:-webkit-linear-gradient(top, #5fa309 0%, #3b8018 100%);
    background:-moz-linear-gradient(top, #5fa309 0%, #3b8018 100%);
    background:-o-linear-gradient(top, #5fa309 0%, #3b8018 100%);
    background:-ms-linear-gradient(top, #5fa309 0%, #3b8018 100%);
    background:linear-gradient(top, #5fa309 0%, #3b8018 100%);
    position:relative;
    display:inline-block;
    padding:0 20px 0 10px;
    width:270px;
    line-height:20px;
    font-size:12px;
    font-family:sans-serif;
    text-shadow:0 1px 0 #264400;
    font-weight:bold;
    color:#fff
}
.container:after{
    content:'';
    background:-webkit-gradient(linear, left top, right bottom, color-stop(0, #5fa309), color-stop(1, #3b8018));
    background:-webkit-linear-gradient(top left, #5fa309 0%, #3b8018 100%);
    background:-moz-linear-gradient(top left, #5fa309 0%, #3b8018 100%);
    background:-o-linear-gradient(top left, #5fa309 0%, #3b8018 100%);
    background:-ms-linear-gradient(top left, #5fa309 0%, #3b8018 100%);
    background:linear-gradient(top left, #5fa309 0%, #3b8018 100%);
    position:absolute;
    top:3px;
    right:-7px;
    width:15px;
    height:15px;
    -webkit-transform:rotate(45deg);
    -moz-transform:rotate(45deg);
    -o-transform:rotate(45deg);
    -ms-transform:rotate(45deg);
    transform:rotate(45deg)
} 
```

我很感兴趣如何在最后添加这种白色效果：

![在此处输入图像描述](../Images/e82e728d08588f958a8f8e598871020f.png)

纯CSS可以做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T17:28:08.683

您可以使用许多 CSS 渐变生成器中的一种来非常接近。这是我从[ColorZilla](http://www.colorzilla.com/gradient-editor/#b4df5b+40,ffffff+89;Custom)生成的：

```
background: #b4df5b; /* Old browsers */
background: -moz-linear-gradient(45deg,  #b4df5b 40%, #ffffff 89%); /* FF3.6+ */
background: -webkit-gradient(linear, left bottom, right top, color-stop(40%,#b4df5b), color-stop(89%,#ffffff)); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(45deg,  #b4df5b 40%,#ffffff 89%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(45deg,  #b4df5b 40%,#ffffff 89%); /* Opera 11.10+ */
background: -ms-linear-gradient(45deg,  #b4df5b 40%,#ffffff 89%); /* IE10+ */
background: linear-gradient(45deg,  #b4df5b 40%,#ffffff 89%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#b4df5b', endColorstr='#ffffff',GradientType=1 ); /* IE6-9 fallback on horizontal gradient */ 
```

如果您需要它更接近您的目标，您将不得不细化渐变。为了使所有浏览器中的背景看起来完全相同，背景图像是您最好的选择。

# ruby-on-rails - 通过电子邮件邀请新用户访问网站

> ID：14447390
> 
> 赞同：0
> 
> 时间：2013-01-21T21:18:56.267
> 
> 标签：ruby-on-rails

我想在我的网站上建立一个表格，已经注册的用户可以通过电子邮件邀请新用户注册这个网站。发送邀请的用户和接受邀请（并注册）的用户然后通过“友谊”关系连接。

我想通过 ActionMailer 发送邀请。

我的问题是：我如何将电子邮件“链接”到友谊关系。一种方法可能是创建一个唯一的 sender_id，它指向用户并将用作电子邮件中的链接。

还有另一种可能吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:13:06.357

在链接中创建一个参数，您可以在其中传递一个可以识别您的关系的 ID。像：[http ://example.com/invite?abcd](http://example.com/invite?abcd)

比在你的控制器中你可以处理这种关系。

其他选择是使用[设计邀请](https://github.com/scambra/devise_invitable)

# iphone - iPhone 上的视频卡拉 OK 开发

> ID：14447391
> 
> 赞同：0
> 
> 时间：2013-01-21T21:18:58.153
> 
> 标签：iphone, ios, audio, video, sdk

我有一个卡拉 OK 应用程序，它采用 mp3+g 文件并在麦克风中混音（使用音频单元）......并且能够将最终结果记录到原始 pcm 文件中。

我有潜在客户问我是否可以对卡拉 OK 视频文件做同样的事情。那么，我可以...

1）播放视频并混入麦克风音频？

2) 将#1 录制到视频文件中？

3）甚至可能将摄像机和麦克风输入以及视频音频...保存到文件中？

考虑到这一点，我可以... 使用 mp3、摄像头和麦克风输入并将所有这些混合到视频文件中吗？

感谢您的任何反馈！

*   布赖恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-02T19:03:39.263

是的，所有这些都是可能的。使用 CD+G 格式，您最好在桌面上将它们转换为 h.264，然后将它们作为带有 AAC 音轨的电影加载。尝试为 iOS 编写 CD+G 解析器将是一场噩梦，因为有很多 CD+G 文件被严重破坏。此外，CD+G 文件非常大，比 MP3 文件大得多，因为 CD+G 是 80 年代的无声无压缩视频。这是一种愚蠢的格式。

# android - Android - 防止edittext复制/粘贴和双击全选

> ID：14447396
> 
> 赞同：9
> 
> 时间：2013-01-21T21:19:12.587
> 
> 标签：android, android-edittext, copy-paste, gesture

我正在寻找一种解决方案来禁用长按编辑菜单（复制/粘贴）以及用于编辑文本框的双击全选功能。我已经以类似的方式阅读了有关此问题的一些解决方案，但是，需要更进一步。

对于这个应用程序，我需要阻止用户在我的应用程序上使用复制/粘贴功能，并且需要一种方法来禁用此功能，该功能适用​​于 2.3 API 以及在较新的平板电脑上使用时。我正在使用 NexusOne 手机设备和 Galaxy 平板电脑进行测试。（minSDK 为 8，目标为 10）

目前我正在使用这个（例如）：edittextPassword.setLongClickable(false); -禁用弹出编辑菜单，太好了！

此方法确实适用于电话设备以防止弹出编辑菜单。在平板电脑上，长按操作也会禁用此功能。然而，平板电脑具有更新的双击功能，可以选择所有文本并打开编辑菜单。旧 API 有没有办法取消/捕获/禁用新 API 功能或防止双击手势？

* * *

更新：使用连接到 GestureDetector 的 setLongClickable(false) 和 setOnTouchListener 的组合（感谢 Nikola 的建议），我可以捕获/取消双击和长按打开的编辑菜单。

下一部分要弄清楚的是......在三星手机（Galaxy S，目前不确定其他设备）上，当您点击一个字段时，您会看到一个光标和一个浮动光标指针按钮（正确名称？？ ）。单击此指针按钮是打开编辑菜单的另一种方法。有谁知道如何禁用这个？我唯一的解决方法是使用 TextWatcher 清除 BeforeTextChanges 和 AfterTextChanges 上的剪贴板。这样可以确保即使您进入“复制/粘贴”菜单，剪贴板也会被清除并且没有可粘贴的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-06T07:16:05.423

关于称为[光标控制器或句柄](https://stackoverflow.com/questions/5227725/android-text-selection-terminology)的“浮动光标指针按钮”以及单击它时出现的上下文菜单，是的，有一种方法可以禁用它。我假设你指的是这个：

![带有粘贴菜单的文本选择句柄](../Images/bfbb1657c57b32dc2c16d38b65158869.png)

除了 setLongClickable(false) 和 setOnTouchListener 代码之外，修复还在于防止 PASTE/REPLACE 菜单出现在[`show()`](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.4.2_r1/android/widget/Editor.java#Editor.ActionPopupWindow.show%28%29)（未记录的）`android.widget.Editor`类的方法中。在菜单出现之前，对 进行检查`if (!canPaste && !canSuggest) return;`。用作设置这些变量的基础的两种方法都在`EditText`类中：

*   [`isSuggestionsEnabled()`](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.4.2_r1/android/widget/TextView.java#TextView.isSuggestionsEnabled%28%29)是[`public`](http://developer.android.com/reference/android/widget/TextView.html#isSuggestionsEnabled())，因此可能会被覆盖。
*   [`canPaste()`](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.4.2_r1/android/widget/TextView.java#TextView.canPaste%28%29)不是，因此必须通过在派生类中[引入同名函数来隐藏。](https://stackoverflow.com/a/2000156/3063884)

更完整的答案[可在此处获得](https://stackoverflow.com/a/28893714/3063884)。

正如@CommonsWare 所提到的，个别设备制造商可能已经更改了`EditText`控件的默认 AOSP 行为，因此有必要进行测试。

# php - 正则表达式替换所有匹配项，除非匹配项位于字符串的末尾

> ID：14447397
> 
> 赞同：4
> 
> 时间：2013-01-21T21:19:17.157
> 
> 标签：php, regex, string, preg-replace

我目前正在使用此正则表达式替换字符串中的所有非字母数字字符并用破折号替换它们

```
$newString = preg_replace("/[^a-z0-9.]+/i", "-", $string); 
```

这**适用**于以下字符串。

```
$string = "this will work fine";
$newString = "this-will-work-fine"; 
```

**但是**如果字符串有一个非字母数字作为最后一个字符，它将匹配并替换它，正如人们所怀疑的那样。

```
$string = "How can I fix this?";
$newString = "How-can-I-fix-this-"; 
```

如何改进此正则表达式以获得以下输出？

```
$newString = "How-can-I-fix-this"; 
```

正则表达式应该适用于**这两种**情况。我知道我可以使用单独的函数修剪字符串，但理想情况下我想使用一个正则表达式。这可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T21:28:42.880

由于您使用的是 PHP，因此您可以一次性定义多个模式和替换。这是一个快速演示：

```
$string = "How can I fix this?";
$patterns = array('/[^0-9a-z.]+/i', '/[^0-9a-z.]+(?=$)/i');
$replacements = array('-', '');

echo preg_replace($patterns, $replacements, $string) . "\n"; 
```

打印：

```
我怎样才能解决这个问题
```

这实际上只不过是两个连续的替换：

```
$string = "How can I fix this?";

echo preg_replace('/[^0-9a-z.]+/', '-', preg_replace('/[^0-9a-z.]+$/', '', $string)) . "\n"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T21:25:29.297

我认为您必须分两步执行此操作，因为您有两种不同的情况：在字符串的开头和中间，您想用“-”替换非字母数字。最后，您想用空字符串替换它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-21T21:33:26.457

你总是可以`trim("-how-can-i-fix-this-", "-");`的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T22:02:22.730

实际上，它*可以*在一个正则表达式中完成：

`$newString = preg_replace('/[^a-z0-9.]++([a-z0-9.]++)(?:[^a-z0-9.]++$)?/i', '-$1', $string);`

**笔记：**

*   为了将来参考，`'-\1'`、`'-\\1'`、`"-\\1"`和`"-$1"`都是替换字符串的有效替代项。
*   在这种情况下，所有格量词并不是真正必要的。但是，即使速度提高微乎其微，我也总是使用它们。

**编辑：**

第三种情况（第一个字符不是字母数字）也可以用一个正则表达式完成：

`$newString = preg_replace('/(?:^[^a-z0-9.]++([a-z0-9.]++))?[^a-z0-9.]++([a-z0-9.]++)(?:[^a-z0-9.]++$)?/i', '$1-$2', $string);`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-21T23:06:13.217

```
$string = 'How can I fix this?';
$string = trim(preg_replace('/[^A-Za-z0-9]/', '-', $string), '-'); 
```

用 替换所有非字母数字`'-'`，然后从末端修剪。

# ruby-on-rails-3 - Rails 3 以格式解析 TimeZone 字符串：“（GMT-05:00）东部时间（美国和加拿大）”

> ID：14447398
> 
> 赞同：0
> 
> 时间：2013-01-21T21:19:18.157
> 
> 标签：ruby-on-rails-3, timezone

如何将此时区字符串解析为正确的格式，以便我可以使用`Time.zone = <the proper time zone string>"`. 目前已知的格式类型是：`Eastern Time (US & Canada)`，不知道为什么它不想接受更精确的格式，例如“（GMT-05:00）东部时间（美国和加拿大）”。

Rails 中是否有任何内置工具来处理我拥有的字符串，并将其转换为正确的 Time.zone 格式？请注意，该解决方案应正确映射到 Rail 的所有时区列表...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:01:40.460

不知道你从哪里得到你的区域字符串，但检查一下`TimeZone.to_s`

```
# Returns a textual representation of this time zone.
def to_s
  "(GMT#{formatted_offset}) #{name}"
end

# Returns the offset of this time zone as a formatted string, of the
# format "+HH:MM".
def formatted_offset(colon=true, alternate_utc_string = nil)
  utc_offset == 0 && alternate_utc_string || self.class.seconds_to_utc_offset(utc_offset, colon)
end 
```

所有你需要的是`Time.zone.name # => "Eastern Time (US & Canada)"`

如果你没有，那么用正则表达式解析字符串

```
'(GMT-05:00) Eastern Time (US & Canada)'.match(/\(.*\) (.*)/)[1]
#=> "Eastern Time (US & Canada)" 
```

[https://github.com/rails/rails/blob/5fe88b11f11bb3b30bc23c57b36be4f027d915ba/activesupport/lib/active_support/values/time_zone.rb#L337](https://github.com/rails/rails/blob/5fe88b11f11bb3b30bc23c57b36be4f027d915ba/activesupport/lib/active_support/values/time_zone.rb#L337)

# mongodb - 为 find() 提供投影参数是否会限制添加到 Mongo 工作集中的数据？

> ID：14447403
> 
> 赞同：1
> 
> 时间：2013-01-21T21:19:42.487
> 
> 标签：mongodb

在 Mongo 中，假设我有一个`mycollection`包含字段`a`、`b`和的集合`huge`。我经常想在 上执行查询、mapreduce、更新等`a`，并且`b`偶尔也想`huge`在查询结果中返回。

我知道这`db.mycollection.find()`将扫描整个集合并导致 Mongo 尝试将整个集合添加到工作集中，这可能会超过我可用的 RAM 量。

如果我改为调用`db.mycollection.find({}, { a : 1, b : 1 })`，这是否仍会导致将整个集合添加到工作集中或仅将我的投影条款添加到工作集中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:36:44.813

MongoDB 可以使用称为覆盖查询的东西：http: [//docs.mongodb.org/manual/applications/indexes/#create-indexes-that-support-covered-queries](http://docs.mongodb.org/manual/applications/indexes/#create-indexes-that-support-covered-queries)这些允许您从索引加载所有值，而不是磁盘或内存，如果这些文档当时在内存中。

请注意，您不能在全表扫描中使用覆盖查询，条件、投影和排序都必须在索引内；IE：

```
db.col.ensureIndex({a:1,b:1});
db.col.find({a:1}, {_id:0, a:1, b:1})(.sort({b:1})); 
```

会工作（排序在括号中，因为它不是完全需要的）。`_id`如果您也打算返回它，您可以添加到您的索引中。

Map Reduce 不支持覆盖查询，据我所知，没有办法只将一定数量的字段投影到 MR 中；也许有一些我不知道的黑客。Map Reduce 仅`$match`在输入查询方面支持 like 运算符，并为传入查询的排序提供单独的参数（[http://docs.mongodb.org/manual/applications/map-reduce/](http://docs.mongodb.org/manual/applications/map-reduce/)）。

请注意，对于更新，我相信只有原子操作：[http](http://docs.mongodb.org/manual/tutorial/isolate-sequence-of-operations/) ://docs.mongodb.org/manual/tutorial/isolate-sequence-of-operations/ （不包括`findAndModify`）不要将文档加载到您的工作集中，但是，相信是那里的关键字。

考虑到您需要对这些记录进行 MR 和正常查找和更新，我强烈建议您检查一下为什么要分页这么多数据，以及您是否真的需要经常这样做。似乎您正试图在短时间内频繁地进行过多的处理。

另一方面，如果这是一个每晚运行的脚本或其他什么，那么我不会太担心它过多的工作集（即记分板重新计算脚本）。

# php - 从表单发布时将日期添加到表格

> ID：14447405
> 
> 赞同：1
> 
> 时间：2013-01-21T21:19:50.620
> 
> 标签：php, date

使用表单我正在向我的表中添加一些基本字段。

我还想添加表单数据发布的当前日期。

任何有关如何执行此操作的建议将不胜感激。

谢谢。

```
$sql="INSERT INTO Experiments(Author, Title, Description) 
    VALUES
('$_POST[author]','$_POST[title]','$_POST[description]')";

if (!mysql_query($sql,$connection))
    {
die('Error: ' . mysql_error());
    }
header('Location: http://example.com'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:23:37.843

你不需要用 PHP 输入它。在表中添加一`TIMESTAMP`列并将其默认值设置为`CURRENT_TIMESTAMP`：

```
ALTER TABLE `Experiments` ADD COLUMN `time` TIMESTAMP DEFAULT CURRENT_TIMESTAMP 
```

哦，请[清理您的数据输入](http://php.net/manual/en/filter.filters.sanitize.php)！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:21:17.793

$sql="INSERT INTO Experiments(Author, Title, Description, DATE) VALUES ('$_POST[author]','$_POST[title]','$_POST[description]', NOW())";

# linux - Bash Shell 脚本 - 检查标志并获取其值

> ID：14447406
> 
> 赞同：96
> 
> 时间：2013-01-21T21:19:58.827
> 
> 标签：linux, bash, shell, debian

我正在尝试制作一个设计为像这样运行的shell脚本：

```
script.sh -t application 
```

首先，在我的脚本中，我想检查脚本是否已使用 -t 标志运行。例如，如果它在没有这样的标志的情况下运行，我希望它出错：

```
script.sh 
```

其次，假设有一个 -t 标志，我想获取该值并将其存储在我可以在脚本中使用的变量中，例如：

```
FLAG="application" 
```

到目前为止，我能够在这方面取得的唯一进展是 $@ 获取所有命令行参数，但我不知道这与标志有什么关系，或者这是否可能。

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2013-01-21T21:24:00.853

你应该阅读这个[getopts](https://archive.is/TRzn4)教程。

`-a`需要参数的开关示例：

```
#!/bin/bash

while getopts ":a:" opt; do
  case $opt in
    a)
      echo "-a was triggered, Parameter: $OPTARG" >&2
      ;;
    \?)
      echo "Invalid option: -$OPTARG" >&2
      exit 1
      ;;
    :)
      echo "Option -$OPTARG requires an argument." >&2
      exit 1
      ;;
  esac
done 
```

就像 graybot 说的（`getopt`！= `getopts`）：

> 外部命令 getopt(1) 永远不会安全使用，除非您*知道* 它是 GNU getopt，以 GNU 特定的方式调用它，*并*确保 GETOPT_COMPATIBLE 不在环境中。改用 getopts（shell 内置），或者简单地循环位置参数。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-01-21T21:24:47.117

用于`$#`获取参数的数量，如果不等于 2 则提供的参数不足：

```
if [ $# -ne 2 ]; then
   usage;
fi 
```

接下来，检查是否`$1`等于`-t`，否则使用了未知标志：

```
if [ "$1" != "-t" ]; then
  usage;
fi 
```

最后存储`$2`在`FLAG`：

```
FLAG=$2 
```

注意：`usage()`是一些显示语法的函数。例如：

```
function usage {
   cat << EOF
Usage: script.sh -t <application>

Performs some activity
EOF
   exit 1
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2018-09-03T22:04:17.977

这是一个通用的简单命令参数界面，您可以将其粘贴到所有脚本的顶部。

```
#!/bin/bash

declare -A flags
declare -A booleans
args=()

while [ "$1" ];
do
    arg=$1
    if [ "${1:0:1}" == "-" ]
    then
      shift
      rev=$(echo "$arg" | rev)
      if [ -z "$1" ] || [ "${1:0:1}" == "-" ] || [ "${rev:0:1}" == ":" ]
      then
        bool=$(echo ${arg:1} | sed s/://g)
        booleans[$bool]=true
        echo \"$bool\" is boolean
      else
        value=$1
        flags[${arg:1}]=$value
        shift
        echo \"$arg\" is flag with value \"$value\"
      fi
    else
      args+=("$arg")
      shift
      echo \"$arg\" is an arg
    fi
done

echo -e "\n"
echo booleans: ${booleans[@]}
echo flags: ${flags[@]}
echo args: ${args[@]}

echo -e "\nBoolean types:\n\tPrecedes Flag(pf): ${booleans[pf]}\n\tFinal Arg(f): ${booleans[f]}\n\tColon Terminated(Ct): ${booleans[Ct]}\n\tNot Mentioned(nm): ${boolean[nm]}"
echo -e "\nFlag: myFlag => ${flags["myFlag"]}"
echo -e "\nArgs: one: ${args[0]}, two: ${args[1]}, three: ${args[2]}" 
```

通过运行命令：

```
bashScript.sh firstArg -pf -myFlag "my flag value" secondArg -Ct: thirdArg -f 
```

输出将是这样的：

```
"firstArg" is an arg
"pf" is boolean
"-myFlag" is flag with value "my flag value"
"secondArg" is an arg
"Ct" is boolean
"thirdArg" is an arg
"f" is boolean

booleans: true true true
flags: my flag value
args: firstArg secondArg thirdArg

Boolean types:
    Precedes Flag(pf): true
    Final Arg(f): true
    Colon Terminated(Ct): true
    Not Mentioned(nm): 

Flag: myFlag => my flag value

Args: one => firstArg, two => secondArg, three => thirdArg 
```

基本上，参数分为标志布尔值和通用参数。通过这种方式，用户可以将标志和布尔值放在任何地方，只要他/她按照指定的顺序保留通用参数（如果有的话）。

**让我和现在你再也不用处理 bash 参数解析了！**

**[您可以在此处](https://github.com/jozsefmorrissey/BashScripts/blob/master/commandParser.sh)查看更新的脚本**

这在去年非常有用。它现在可以通过在变量前面加上范围参数来模拟范围。

只需像这样调用脚本

```
replace() (
  source $FUTIL_REL_DIR/commandParser.sh -scope ${FUNCNAME[0]} "$@"
  echo ${replaceFlags[f]}
  echo ${replaceBooleans[b]}
) 
```

看起来我没有实现参数范围，不知道为什么我猜我还不需要它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-06T18:43:55.940

试试 shFlags -- 用于 Unix shell 脚本的高级命令行标志库。

[http://code.google.com/p/shflags/](http://code.google.com/p/shflags/)

它非常好，非常灵活。

FLAG TYPES：这是您可以执行的 DEFINE_* 的列表。所有标志都采用名称、默认值、帮助字符串和可选的“短”名称（单字母名称）。一些标志有其他参数，这些参数用标志来描述。

DEFINE_string：接受任何输入，并将其解释为字符串。

DEFINE_boolean：通常不带任何参数：比如 --myflag 将 FLAGS_myflag 设置为 true，或 --nomyflag 将 FLAGS_myflag 设置为 false。或者，您可以说 --myflag=true 或 --myflag=t 或 --myflag=0 或 --myflag=false 或 --myflag=f 或 --myflag=1 传递选项与传递选项具有相同的效果选项一次。

DEFINE_float：接受输入并将其解释为浮点数。由于 shell 本身不支持浮点数，因此输入仅被验证为有效的浮点值。

DEFINE_integer：接受输入并将其解释为整数。

特殊标志：有一些标志具有特殊含义： --help（或 -?）以人类可读的方式打印所有标志的列表 --flagfile=foo 从 foo 读取标志。（尚未实现）——如在 getopt() 中，终止标志处理

示例用法：

```
-- begin hello.sh --
 ! /bin/sh
. ./shflags
DEFINE_string name 'world' "somebody's name" n
FLAGS "$@" || exit $?
eval set -- "${FLAGS_ARGV}"
echo "Hello, ${FLAGS_name}."
-- end hello.sh --

$ ./hello.sh -n Kate
Hello, Kate. 
```

注意：我从 shflags 文档中获取了此文本

# php - 用于保持用户登录的 PHP Cookie - 这是否足够安全？

> ID：14447409
> 
> 赞同：2
> 
> 时间：2013-01-21T21:20:15.237
> 
> 标签：php, mysql, authentication, cookies

我有一个存储加密密码的用户数据库，并想创建一个“让我登录”cookie。我相信以下方法对于我的目的应该足够安全，但我想听听您的想法：

1.  如果用户选择“让我保持登录”框并提供正确的凭据，请创建一个包含非常大的随机字符串的 cookie（称为*信标*）。这也存储在用户表的单独列中。
2.  每次用户访问该页面时，都在用户表中搜索*信标*cookie。如果它不存在，什么也不做。如果确实存在，则检索用户的信息并将其视为已登录。
3.  当用户注销或登录时未选中该框，请销毁*信标*cookie。

如果有人要正确猜测信标字符串，则可以对其进行操作，但我的目的是使其足够大且足够随机，以至于很难做到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:35:14.037

我认为这是在正常会话处理之外完成的，以作为稍后重新创建会话的方式。

可以采取一些措施来提高安全性。

1.  使用 SSL，使 cookie 拦截变得更加困难。
2.  每次使用后重新生成 cookie 哈希。它应该只对一次登录有效。
3.  如果您将此作为 1 个 cookie 存储给 1 个用户，如果用户在多个设备上，它将不起作用（来自第一个设备的 cookie 被第二个设备上的 cookie 覆盖）。
4.  哈希需要是随机的，不应在生成中包含任何用户数据。
5.  用户数据（尤其是电子邮件、密码）应需要密码才能更改。如果 cookie 被拦截，拦截器将无法更改帐户上的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:50:55.167

我认为这不是实现“记住我”cookie 的最佳方式。使散列更大不是解决方案。

想想在你的 cookie 中保存更多的东西。

您建议这样做：

```
'a89bd752123cde09' 
```

*如果您有很多用户，那么获得有效令牌可能并不像您想象的那么困难*

如果您只是将用户 ID 添加到此哈希...

```
$userID . '-' . 'a89bd752123cde09 
```

*现在，他们需要获取与正确用户 ID 相关联的有效令牌，我们让它变得有点复杂*

您也可以连接一些关于用户浏览器或会话的内容，并对其进行加密，可能是这样的：

```
hash_hmac('sha256', $userID . '-' . 'a89bd752123cde09' . '-' . md5(timeStamp when remember expires) . '-' . md5(browser user agent), A_SECRET_KEY); 
```

当您检查 cookie 时，将其解密并检查数据是否正确。

这不是最好的解决方案，但我认为它更好。有很多关于网络安全的信息，请阅读它并且不要直接实现它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T21:38:40.127

听起来您正在尝试从头开始重新创建会话。为什么不直接通过 session_set_cookie_params() 真正长的超时？

# ios - EC2 上的 APNS 无法正常工作

> ID：14447412
> 
> 赞同：1
> 
> 时间：2013-01-21T21:20:37.220
> 
> 标签：ios, apple-push-notifications

我在我的开发环境中设置了 APNS，一切正常。在生产中，我可以看到设备正在注册，并且我在我的数据库中看到了 deviceToken，并且我看到正在发送消息......但用户没有收到它们。安全组有什么必须在这里完成的吗？我尝试阅读以下内容：

[Amazon EC2 上的 Apple 推送通知服务器已连接但未收到通知](https://stackoverflow.com/questions/10526724/apple-push-notification-server-on-amazon-ec2-connected-but-not-receive-notificat)

[http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CommunicatingWIthAPS/CommunicatingWIthAPS.html](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CommunicatingWIthAPS/CommunicatingWIthAPS.html)

我尝试远程登录到 gateway.push.apple.com 并且我能够...还有什么我遗漏的吗？

**编辑**

我的服务器日志很好，经过大量调试后，问题似乎出在 APNS 上。有人可以告诉我我的设置是否正常吗？

我正在使用开发配置文件并在类似 prod 的环境（但仍然不是 prod）中使用 prod apns 证书和密钥进行测试。这是不允许的吗？我是否不允许以这种方式自己使用开发配置文件进行测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T00:02:17.413

您的证书应该匹配。您不能使用生产 APNS 证书/密钥发送到开发配置文件，反之亦然。

从关于[推送通知配置](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ProvisioningDevelopment/ProvisioningDevelopment.html#//apple_ref/doc/uid/TP40008194-CH104-SW1)的文档中：

> 每个证书也仅限于两个开发环境之一，每个环境都有自己分配的 IP 地址。
> 
> 您必须获得沙盒（开发）环境和生产环境的单独证书。

# javascript - 单击单选按钮，在列表框中查看默认值

> ID：14447417
> 
> 赞同：0
> 
> 时间：2013-01-21T21:20:56.170
> 
> 标签：javascript, html

我有 3 个单选按钮（值：Y、N 和无）和一个列表框。列表框上的默认选择应根据用户选择的单选按钮而改变。如果用户单击“Y”单选按钮，则列表框应默认为“XYZ”，依此类推。

我不能使用 Jquery。我必须坚持JS。请帮我设置一个默认值。

```
function radio4_onclick(ctrl) {
    var flag1;
    for (var i=0; i < 3; i++)
        if (document.form_r1.radio4[i].checked==true)
            flag1= document.form_r1.radio4[i].value;
        if (flag1=='NONE');
        //this is the place where I want to set listbox1 to Default 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:33:19.623

默认选择列表中的第一个选项。（请参阅我的 jfiddle 中的第一个列表。）但是，您可以像这样设置列表的“selectedIndex”：

```
var list=document.getElementById('list');
list.selectedIndex = 1; 
```

索引从 0 开始。因此，如果您想要第二个选项，则索引为 1，依此类推。

这是一个工作示例：http: [//jsfiddle.net/AmR8C/1/](http://jsfiddle.net/AmR8C/1/)

# c++ - 在 C++ 中乘以小数

> ID：14447418
> 
> 赞同：-8
> 
> 时间：2013-01-21T21:21:00.730
> 
> 标签：c++

我在带有数字的 C++ 中遇到了这个问题：

给定两个数字：

```
numb1 = 0.000171438
numb2 = 11666; 
```

如果我做

```
fillweight= float(numb1 * numb2) 
```

我得到的答案是“1”，而如果我这样做的话

```
fillweight = 0.000171438 * 11666 
```

我在屏幕上正确得到“1.9999”答案 - 传入浮点数有什么问题？我也尝试过类似的东西

```
fillweight = float(float(numb1) * float(numb2)) 
```

但他们总是相同的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:22:30.770

在

```
fillweight = 0.000171438 * 11666 
```

第一个数字是一个`double`常数，乘法是使用双精度算术完成的（11666 将转换为`double`）这很可能在编译时发生。

```
fillweight = 0.000171438f * 11666f 
```

将与

```
fillweight = float(float(numb1) * float(numb2)) 
```

如果 numb1 和 numb2 是`float`s。

虽然这并不能解决你的问题。但是如果没有一个最小的工作示例，除了注意你的类型之外，没有什么可说的了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:23:44.530

浮点数的可用精度明显低于双精度数 - 在“有效”的情况下，文字被解释为双精度数。

很多关于这方面的信息可以在这里找到：

[浮点数与双精度](https://stackoverflow.com/questions/5098558/float-vs-double-precision)

仔细检查浮动可以容纳的东西 - 这种差异很可能不是导致您的问题的原因。我敢打赌，问题在于您尝试保存结果的变量可能是`int`正在执行的乘法的一个或其他一些不合适的类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T22:09:18.667

您可能会在输出方法中看到舍入。例如，采用以下代码：

```
#include "stdafx.h"
#include <iostream>

int _tmain(int argc, _TCHAR* argv[])
{
    std::cout.precision(5);
    std::cout << "Precision(5)" << std::endl;
    {
    float numb1 = 0.000171438;
    float numb2 = 11666;
    float fillweight = float(numb1 * numb2);
    std::cout << "Test #1: fillweight = " << fillweight << " numb1 = " << numb1 << " numb2 = " << numb2 << std::endl;
    }
    {
    float numb1 = 0.000171438;
    float numb2 = 9999;
    float fillweight = float(numb1 * numb2);
    std::cout << "Test #2: fillweight = " << fillweight << " numb1 = " << numb1 << " numb2 = " << numb2 << std::endl;
    }
    std::cout.precision(10);
    std::cout << "Precision(10)" << std::endl;
    {
    float numb1 = 0.000171438;
    float numb2 = 11666;
    float fillweight = float(numb1 * numb2);
    std::cout << "Test #3: fillweight = " << fillweight << " numb1 = " << numb1 << " numb2 = " << numb2 << std::endl;
    }
    {
    float numb1 = 0.000171438;
    float numb2 = 9999;
    float fillweight = float(numb1 * numb2);
    std::cout << "Test #4: fillweight = " << fillweight << " numb1 = " << numb1 << " numb2 = " << numb2 << std::endl;
    }

    int i;
    std::cin >> i;
    return 0;
} 
```

你会得到这个输出：

```
Precision(5)
Test #1: fillweight = 2 numb1 = 0.00017144 numb2 = 11666
Test #2: fillweight = 1.7142 numb1 = 0.00017144 numb2 = 9999
Precision(10)
Test #3: fillweight = 1.999995708 numb1 = 0.0001714380051 numb2 = 11666
Test #4: fillweight = 1.714208603 numb1 = 0.0001714380051 numb2 = 9999 
```

# ios - 将 .csv 读入 NSObjects，然后按不同的标准对它们进行排序

> ID：14447425
> 
> 赞同：9
> 
> 时间：2013-01-21T21:21:25.623
> 
> 标签：ios, objective-c, csv

这是一个开放的问题，而不是与错误相关的问题，所以如果你不喜欢回答这类问题，请不要发火。

我在 .csv 文件中有一个巨大的（！）船舶列表，由`,`

矩阵是这样组织的： ![在此处输入图像描述](../Images/2523ab92bb5bf9b9c7d93074cd264dfd.png)
用不同的数据重复大约 500 次。

现在，我希望将其读入对象，可进一步用于填充`UITableView` 当前，我将数据硬编码到对象文件中，如下所示

```
arrayWithObjectsForTableView = [[NSMutableArray alloc] init];
if ([boatsFromOwner isEqualToString:@"Owner1"]) {
    cargoShips* ship = [[cargoShips alloc]init];
    ship.name = @"name1";
    ship.size = 1000;
    ship.owner = @"Owner1";

    [self.boatsForOwner addObject:ship];

    ship = [[cargoShips alloc]init];
    ship.name = @"Name 2";
    ship.size = 2000;
    ship.owner = @"Owner2"; 
```

依此类推，使用 if-else。这是一个不好的方法，因为 1）它很无聊并且需要很长时间 2）如果我想更新信息需要更多时间。所以，我认为以编程方式从矩阵中读取而不是自己做会更聪明。是的，船长显然是来探望我的大脑的。

**那么，问题来了！** 我怎样才能读取看起来像这样的 .csv 文件： 以对象的形式将![在此处输入图像描述](../Images/fb2bb0f29f5d6f44a9272a5e9625022a.png) 所有者的船添加到 a`NSMutableArray`中。（所以它们可以用来喂我`UITableView`的船。

我还希望可以选择按不同的内容进行排序，例如建造国家、运营商等。如何制作将从 .csv 读取的相关船只提供给对象的代码？我不太了解编程，因此非常感谢您提供深入的答案。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-25T01:48:18.280

您的处理深度将决定此任务需要哪种数据结构。这是我会使用的方法：

**1：**将文件读`.csv`入一个巨大的`NSString`对象：

```
NSString *file = [[NSString alloc] initWithContentsOfFile:yourCSVHere]; 
```

**2：**获取各行：

```
NSArray *allLines = [file componentsSeparatedByCharactersInSet:[NSCharacterSet newlineCharacterSet]]; 
```

**3：**对于每一行，获取各个组件：

```
for (NSString* line in allLines) {
    NSArray *elements = [line componentsSeparatedByString:@","];
    // Elements now contains all the data from 1 csv line
    // Use data from line (see step 4)
} 
```

**4：**这取决于你。我的第一个想法是创建一个类来存储您的所有数据。例如：

```
@interface Record : NSObject
//...
@property (nonatomic, copy) NSString *name
@property (nonatomic, copy) NSString *owner
// ... etc
@end 
```

**4a：**然后，回到第 3 步，为每一行创建一个`Record`对象，然后将所有 Record 对象放入一个单独的`NSArray`（范围更大的东西！）。

**5：**使用`NSArray`包含所有`Record`对象的你作为你的数据源`UITableView`。

步骤 4 和 5 的实施取决于您。`.csv`对于中等大小的文件，这可能就是我会这样做的方式。

**编辑：**这是生成`Records`.

```
//
NSMutableArray *someArrayWithLargerScope = [[NSMutableArray alloc] init];
//

NSString *file = [[NSString alloc] initWithContentsOfFile:yourCSVHere];
NSArray *allLines = [file componentsSeparatedByCharactersInSet:[NSCharacterSet newlineCharacterSet];

for (NSString* line in allLines) {
    NSArray *elements = [line componentsSeparatedByString@","];
    Record *rec = [[Record alloc] init];
    rec.name = [elements objectAtIndex:0];
    rec.owner = [elements objectAtIndex:1];
    // And so on for each value in the line.
    // Note your indexes (0, 1, ...) will be determined by the
    // order of the values in the .csv file.
    // ...
    // You'll need one `Record` property for each value.

    // Store the result somewhere
    [someArrayWithLargerScope addObject:rec];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T02:18:45.027

就 CSV 解析而言，假设您可以花费内存，这可能是最容易将整个内容读取到 a 的`NSString`，将其拆分为换行符，然后将每一行拆分为逗号，基本上正如 PLPiper 所建议的那样。

那时我会绕道进入键值编码。为 CSV 文件中的列提供与运行时对象上的属性完全相同的名称。然后你可以写如下内容：

```
// this method will create an object of the given type then push the values
// from valueRow to the properties named by headingRow. So, ordinarily,
// headingRow will be the first row in your CSV, valueRow will be any other
- (id)populatedObjectOfType:(Class)type withHeadingRow:(NSArray *)headingRow valueRow:(NSArray *)valueRow
{
    // we need the count of fields named in the heading row to 
    // match the count of fields given in this value row
    if([headingRow count] != [valueRow count]) return nil;

    // autorelease if you're not using ARC
    id <NSObject> newInstance = [[type alloc] init];

    // we need to enumerate two things simultaneously, so
    // we can fast enumerate one but not the other. We'll
    // use good old NSEnumerator for the other
    NSEnumerator *valueEnumerator = [valueRow objectEnumerator];
    for(NSString *propertyName in headingRow)
    {
        [newInstance setValue:[valueEnumerator nextObject] forKey:propertyName];
    }

    return newInstance;
}

... elsewhere ....
CargoShip *newShip = [self populateObjectOfType:[CargoShip class] withHeadingRow:[csvFile objectAtIndex:0] valueFor:[csvFile objectAtIndex:1]]; 
```

主要需要注意的是，内置机制将在标量和对象之间转换，但不会在不同类型的对象之间转换。因此，如果你有 all`NSString`和 C 整数类型（`short`、`int`、`NSUInteger`等），你会很好，但如果你有一些`NSString`s ，比如说，一些`NSNumber`s ，那么你最终会得到存储在数字槽中的字符串。看起来您正在使用 C 整数类型（这很正常），所以您应该没问题。

在过滤方面，您可以使用`NSPredicate`s. 例如，假设您有一个`CargoShip`s 数组，并且希望每个数组的 a`size`至少为 500：

```
NSArray *bigShips = [allShips filteredArrayUsingPredicate:
    [NSPredicate predicateWithFormat:@"size > 500"]]; 
```

同样，对于排序，您可以在问题上抛出一些`NSSortDescriptor`s。例如

```
NSArray *shipsSortedBySize = [allShips sortedArrayUsingDescriptors:
     @[[NSSortDescriptor sortDescriptorWithKey:@"size" ascending:YES]]]; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-25T06:28:53.420

你可以使用这个链接，
[https://github.com/davedelong/CHCSVParser](https://github.com/davedelong/CHCSVParser)
是.csv 解析器，CHCSVParser 可以配置解析其他“字符分隔”文件格式，例如“TSV”（制表符分隔）或逗号分隔。

# java - 生成的子进程是否计入用户时间？

> ID：14447429
> 
> 赞同：3
> 
> 时间：2013-01-21T21:21:37.637
> 
> 标签：java, time, overhead, kill-process, child-process

我有一个 Java 进程，它启动一堆子进程并通过执行“kill -STOP”和“kill -CONT”将它们交错（按照[Suspend a child process spawned by java 中](https://stackoverflow.com/questions/14248484/suspend-a-child-process-spawned-by-java)给出的建议）

现在我想计时这个过程。我运行“时间 java [...]”

并且由此产生的“用户”时间大约是“真实”时间的一半（“sys”时间可以忽略不计）。

无论子进程是否算作“用户”时间，这都没有意义，因为（除非我的代码使用的 CPU 比我想象的要多得多）我的 java 代码花费的大部分时间都被花费了（或者应该花费）等待（通过`wait(10000)`每十秒唤醒一次的循环来杀死 -STOP 一个进程并杀死 -CONT 另一个，直到其中一个成功返回）。

调用是否有很多开销`kill`（即间隔太短十秒）？子进程是否计入用户时间？如果是这样，还有什么可以解释这种差异？

# wpf - 如何在 WPF 故事板启动后的预定义时间暂停/停止它？

> ID：14447431
> 
> 赞同：0
> 
> 时间：2013-01-21T21:21:44.203
> 
> 标签：wpf, storyboard

如何让 WPF 的情节提要在启动后的预定义时间停止/暂停？例如开始后 20 秒？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:37:58.030

如果我正确理解了您的问题，从我的项目中，我会在定义的秒内将 UI 元素从一个元素平滑地更改为另一个元素。

```
void ScreenSelector(FrameworkElement CurrentElement, FrameworkElement ToNextElement, bool Side)
  {
   if (_Storyboard != null) _Storyboard.Stop(this);

   Thickness _TicknessLeft = new Thickness(Width, 0, -Width, 0);
   Thickness _TicknessRight = new Thickness(-Width, 0, Width, 0);
   Thickness _TicknessClient = new Thickness(0, 0, 0, 0);

   TimeSpan _TimeSpanStarting = TimeSpan.FromSeconds(0);
   TimeSpan _TimeSpanStopping = TimeSpan.FromSeconds(0.5);

   KeyTime _KeyTimeStarting = KeyTime.FromTimeSpan(_TimeSpanStarting);
   KeyTime _KeyTimeStopping = KeyTime.FromTimeSpan(_TimeSpanStopping);

   ToNextElement.Margin = Side ? _TicknessRight : _TicknessLeft;
   ToNextElement.Visibility = Visibility.Visible;

   Storyboard _StoryboardTemp = new Storyboard();

   ThicknessAnimationUsingKeyFrames _CurrentThicknessAnimationUsingKeyFrames = new ThicknessAnimationUsingKeyFrames();

   _CurrentThicknessAnimationUsingKeyFrames.BeginTime = _TimeSpanStarting;
   Storyboard.SetTargetName(_CurrentThicknessAnimationUsingKeyFrames, CurrentElement.Name);
   Storyboard.SetTargetProperty(_CurrentThicknessAnimationUsingKeyFrames, new PropertyPath("(FrameworkElement.Margin)"));
   _CurrentThicknessAnimationUsingKeyFrames.KeyFrames.Add(new SplineThicknessKeyFrame(_TicknessClient, _KeyTimeStarting));
   _CurrentThicknessAnimationUsingKeyFrames.KeyFrames.Add(new SplineThicknessKeyFrame(Side ? _TicknessLeft : _TicknessRight, _KeyTimeStopping));

   _StoryboardTemp.Children.Add(_CurrentThicknessAnimationUsingKeyFrames);

   ThicknessAnimationUsingKeyFrames _NextThicknessAnimationUsingKeyFrames = new ThicknessAnimationUsingKeyFrames();

   _NextThicknessAnimationUsingKeyFrames.BeginTime = _TimeSpanStarting;
   Storyboard.SetTargetName(_NextThicknessAnimationUsingKeyFrames, ToNextElement.Name);
   Storyboard.SetTargetProperty(_NextThicknessAnimationUsingKeyFrames, new PropertyPath("(FrameworkElement.Margin)"));
   _NextThicknessAnimationUsingKeyFrames.KeyFrames.Add(new SplineThicknessKeyFrame(Side ? _TicknessRight : _TicknessLeft, _KeyTimeStarting));
   _NextThicknessAnimationUsingKeyFrames.KeyFrames.Add(new SplineThicknessKeyFrame(_TicknessClient, _KeyTimeStopping));

   _StoryboardTemp.Children.Add(_NextThicknessAnimationUsingKeyFrames);

   _StoryboardTemp.Completed += (EventHandler)delegate(object sender, EventArgs e)
   {
    CurrentElement.Visibility = Visibility.Hidden;
    _Storyboard = null;
   };

   _Storyboard = _StoryboardTemp;
   BeginStoryboard(_StoryboardTemp);
  } 
```

# asp.net - 如何避免空标签对应的空行

> ID：14447441
> 
> 赞同：0
> 
> 时间：2013-01-21T21:22:07.117
> 
> 标签：asp.net, html

我正在使用 html 表显示几个 asp.net 面板控件。最初，面板设置为可见 = false。根据数据库中的数据，一些面板将可见。问题是如果第二个和第十个面板可见，页面中会显示几个空白行，因为创建了几个对应于不可见面板的空标签。请让我知道如何避免空行。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:26:07.783

赋予样式而不是可见属性

```
<div style="display:none"></div> 
```

然后从后面的代码 make`display : "block"`这将完全隐藏您的元素，并且不会有空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T16:25:43.853

如果您将`<tr>`标签放在`Panel`控件中，则在以下情况下不会呈现这些标签`Panel.Visible == false`：

```
<asp:Panel ...>
    <tr>...</tr>
</asp:Panel> 
```

# python - 如何矢量化这个 python 代码？

> ID：14447442
> 
> 赞同：16
> 
> 时间：2013-01-21T21:22:19.443
> 
> 标签：python, numpy, vectorization

我正在尝试使用 NumPy 和矢量化操作来使一段代码运行得更快。但是，我似乎对如何向量化此代码有误解（可能是由于对向量化的理解不完整）。

这是带有循环的工作代码（A和B是设定大小的二维数组，已经初始化）：

```
for k in range(num_v):
    B[:] = A[:]
    for i in range(num_v):
        for j in range(num_v):
            A[i][j] = min(B[i][j], B[i][k] + B[k][j])
return A 
```

这是我对上述代码进行矢量化的尝试：

```
for k in range(num_v):
    B = numpy.copy(A)
    A = numpy.minimum(B, B[:,k] + B[k,:])
return A 
```

为了测试这些，我使用了以下代码，上面的代码包含在一个名为“算法”的函数中：

```
def setup_array(edges, num_v):
    r = range(1, num_v + 1)
    A = [[None for x in r] for y in r]  # or (numpy.ones((num_v, num_v)) * 1e10) for numpy
    for i in r:
        for j in r:
            val = 1e10
            if i == j:
                val = 0 
            elif (i,j) in edges:
                val = edges[(i,j)]
            A[i-1][j-1] = val 
    return A

A = setup_array({(1, 2): 2, (6, 4): 1, (3, 2): -3, (1, 3): 5, (3, 6): 5, (4, 5): 2, (3, 1): 4, (4, 3): 8, (3, 4): 6, (2, 4): -4, (6, 5): -5}, 6) 
B = []
algorithm(A, B, 6) 
```

预期的结果，以及我使用第一个代码得到的是：

```
[[0, 2, 5, -2, 0, 10] 
 [8, 0, 4, -4, -2, 9]
 [4, -3, 0, -7, -5, 5]
 [12, 5, 8, 0, 2, 13]
 [10000000000.0, 9999999997.0, 10000000000.0, 9999999993.0, 0, 10000000000.0]
 [13, 6, 9, 1, -5, 0]] 
```

第二个（矢量化）函数改为返回：

```
[[ 0\. -4\.  0\.  0\.  0\.  0.]
 [ 0\. -4\.  0\. -4\.  0\.  0.]
 [ 0\. -4\.  0\.  0\.  0\.  0.]
 [ 0\. -4\.  0\.  0\.  0\.  0.]
 [ 0\. -4\.  0\.  0\.  0\.  0.]
 [ 0\. -4\.  0\.  0\. -5\.  0.]] 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-21T21:41:34.383

通常你想对代码进行矢量化，因为你认为它运行得太慢了。
如果您的代码太慢，那么我可以告诉您正确的索引会使其更快。
而不是`A[i][j]`你应该写`A[i, j]`- 这避免了（子）数组的临时副本。
由于您在代码的最内层循环中执行此操作，这可能会非常昂贵。

看这里：

```
In [37]: timeit test[2][2]
1000000 loops, best of 3: 1.5 us per loop

In [38]: timeit test[2,2]
1000000 loops, best of 3: 639 ns per loop 
```

在您的代码中始终如一地执行此操作——我坚信这已经解决了您的性能问题！

话说回来...

## ...这是我对如何矢量化的看法

```
for k in range(num_v):
    numpy.minimum(A, np.add.outer(A[:,k], A[k,:]), A)
return A 
```

[numpy.minimum](http://docs.scipy.org/doc/numpy/reference/generated/numpy.minimum.html)将比较两个数组并按元素返回两个元素中较小的一个。如果您传递第三个参数，它将获取输出。如果这是一个输入数组，则整个操作就位。

正如 Peter de Rivay 解释的那样，您的广播解决方案存在问题 - 但从数学上讲，您想要做的是某种外积而不是两个向量的相加。因此，您可以在 add 函数上使用外部操作。

NumPy 的二进制 ufunc 有[特殊的方法](http://docs.scipy.org/doc/numpy/reference/ufuncs.html#methods)来执行某些特殊的向量化操作，如 reduce、accumulate、sum 和 outer。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-21T22:33:58.853

该问题是由该行中的数组广播引起的：

```
A = numpy.minimum(B, B[:,k] + B[k,:]) 
```

B 的大小为 6 x 6，B[:,k] 是一个包含 6 个元素的数组，B[k,:] 是一个包含 6 个元素的数组。

（因为您使用的是 numpy 数组类型，所以 B[:,k] 和 B[k,:] 都返回形状为 N 的 rank-1 数组）

Numpy 会自动更改大小以匹配：

1.  首先将 B[:,k] 添加到 B[k,:] 以生成具有 6 个元素的中间数组结果。（这不是你想要的）
2.  其次，这个 6 元素数组通过重复行广播到 6 x 6 矩阵
3.  第三，计算原始矩阵和该广播矩阵的最小值。

这意味着您的 numpy 代码相当于：

```
for k in range(num_v):
   B[:] = A[:]
   C=[B[i][k]+B[k][i] for i in range(num_v)]
   for i in range(num_v):
      for j in range(num_v):
         A[i][j] = min(B[i][j], C[j]) 
```

修复代码的最简单方法是使用矩阵类型而不是数组类型：

```
A = numpy.matrix(A)
for k in range(num_v):
    A = numpy.minimum(A, A[:,k] + A[k,:]) 
```

矩阵类型使用更严格的广播规则，因此在这种情况下：

1.  A[:,k] 通过重复列扩展为 6 x 6 矩阵
2.  A[k,:] 通过重复行扩展为 6 x 6 矩阵
3.  广播的矩阵加在一起形成一个 6 x 6 矩阵
4.  应用最小值

# javascript - 模态弹出在打开点击时淡入，在关闭时淡出

> ID：14447444
> 
> 赞同：4
> 
> 时间：2013-01-21T21:22:21.957
> 
> 标签：javascript, jquery, css, onclick, fade

有一次我有一个相当简单的问题。我有删除按钮，可打开模式弹出窗口以确认或拒绝删除。我希望这些模式弹出窗口在点击时淡入并在取消时淡出。我已经尝试了一些不同的东西，到目前为止还没有运气。我只需要一个简单的解决方案。提前致谢。这是我的代码

```
<style>
div.delModal
{   
    position:absolute;
    border:solid 1px black;
    padding:8px;
    background-color:white;
    width:160px;
    text-align:right
}
</style>
<script>
function showModal(id) {
        document.getElementById(id).style.display = 'block';
        //$(this).fadeIn('slow');
    }
    function hideModal(id) {
        document.getElementById(id).style.display = 'none';
    }

</script>
</head>

<body>
<input type ="button" value="delete" onclick="showModal('delAll1')">

<div class="delModal" style="display:none" id="delAll1">
  <img src="images/warning.png" />&nbsp;Are you sure you want to delete vessel and the corresponding tanks?<br />
    <input type="button" value="Cancel" class="hide" onclick="hideModal('delAll1')"/>     
    <input type="button" value="Delete" onclick="delVesselAll(1)" id="delete"/>
</div>
</body> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T21:27:22.633

在您的参数 ( ) 上使用`.fadeIn()`and 而不是 on 。`.fadeOut()``id``"delAll1"``this`

```
function showModal(id) {
    $("#" + id).fadeIn('slow');
}
function hideModal(id) {
    $("#" + id).fadeOut('slow');
} 
```

通过使用，`$("#" + id)`您可以通过它选择一个元素`id`，即`"#" + id`.

[看这里。](http://jsfiddle.net/bpDKL/)

**注意：**从左侧边栏的框架下更改`onLoad`为修复范围问题。`no wrap (head)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T21:44:33.103

我对你的前两条评论不满意，所以我做了一个新的小提琴：

[http://jsfiddle.net/dkmkX/](http://jsfiddle.net/dkmkX/)

```
$(document).ready(function () {
$('.deleteButton').each(function (i) {
    var whichModal = i; //use this index, a data attribute on the modal, or $(this).parent().parent() to find delete the actual item from the page
    var deleteModal = $(this).parent().find('.deleteModal');
    $(this).click(function (e) {
        deleteModal.fadeIn('slow');
    });
    $(this).parent().find('.modalDelete').click(function (e) {
        deleteModal.fadeOut('slow');
    });
    $(this).parent().find('.modalCancel').click(function (e) {
        deleteModal.fadeOut('slow');
    });
});
}); //ready 
```

这将允许您添加多个删除按钮，每个按钮都有自己的模式。

JS 中有一条关于如何找出已按下哪个模式的评论，因为此解决方案与 ID 无关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T21:34:56.067

为什么不像这样对每个按钮使用 id

```
<input type ="button" value="show" id="show">

<div class="delModal" style="display:none" id="delAll1">
  <img src="images/warning.png" />&nbsp;Are you sure you want to delete vessel and the corresponding tanks?<br />
    <input type="button" value="Cancel" class="hide" id="delete"/>     
    <input type="button" value="Delete" onclick="delVesselAll(1)" id="delete"/>
</div> 
```

而像这样的jquery

```
$("#show").click(function() {
        $("#delAll1").fadeIn();
    });
$("#delete").click(function() {
        $("#delAll1").fadeOut();
    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T21:29:54.203

`fadeIn()`在右选择器（`'#'+id`）上使用，`this`在当前上下文中将是全局对象。

```
function showModal(id) {   
    $('#'+id).fadeIn();
    //$(this).fadeIn('slow');
}
function hideModal(id) {
    $('#'+id).fadeOut();
} 
```

[**演示**](http://jsfiddle.net/mowglisanu/CJXUX/1/)

# ios - __NSCFDictionary 长度无法识别的选择器发送到 NSJSONSerialied NSData

> ID：14447448
> 
> 赞同：-2
> 
> 时间：2013-01-21T21:22:40.447
> 
> 标签：ios, objective-c

当我使用 NSURLConnection 发出 JSON 请求时，我收到“无法识别的选择器”错误 [__NSCFDictionary 长度]。

我们从将请求在标头中作为 UTF8String 发送到它工作的地方，更改为由于某种原因需要 NSData 的正文。我们进行了更改，因为最终会有太多的数据用于标题。

为什么我会收到此错误，我该如何解决？这在某种程度上是内存中的对象的问题吗？我很困惑。

```
 -(void)initWebserviceWithJSONRequest:(NSData *)jsonRequest url:(NSURL *)url
    {
       //initialize the responseData property //
       self.responseData = [[NSMutableData alloc] init];
       NSError *error = nil;
       NSMutableData *requestData = [[NSMutableData alloc] init];
       requestData = [NSJSONSerialization JSONObjectWithData:jsonRequest options:NSJSONWritingPrettyPrinted error:&error];
       // create the URL request that will be passed to the NSURLConnection class // 
       NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url cachePolicy:NSURLRequestReloadIgnoringLocalAndRemoteCacheData timeoutInterval:60];

       // set up the request values //
       [request setHTTPMethod:@"POST"];
       // line below included to show that there is a length available for requestData
       int jsonLength = requestData.description.length;// This works because it's .description.length
       [request setHTTPBody:requestData ];

       // Make a connection //
       self.connection = [NSURLConnection connectionWithRequest:request delegate:self];
    } 
```

这个方法的调用是这样的：

```
 NSData *jsonData = [[NSData alloc] initWithData:[jsonString dataUsingEncoding:NSUTF8StringEncoding]];
    [service createWebserviceWithJSONRequest:jsonData url:loginURL]; 
```

这是我在正文中发送的 json：

```
 {
        CURRENTDATETIME = "2012-11-16 18:11:26";
        CURRENTUSERTOKEN = "";
        REQUESTDATA = "{\"USERNAME\":\"testUserName\", \"PASSWORD\":\"TestPassword\", \"APPVERSION\":\"0.001.1\", \"CARRIER\":\"ATT\", \"DEVICENAME\":\"iPad Simulator\", \"DEVICETOKEN\":\"9A384B42-7766-55AE-B61D-0AAB74A4304B\", \"OSVERSION\":\"5.1\", \"LATITUDE\":10.72182, \"LONGITUDE\":-10.148127, \"ISWIFI\":\"true\", \"BATTERYLEVEL\":42.2, \"SCREENHEIGHT\":1024, \"SCREENWIDTH\":768, \"SCREENPPI\":132, \"SIGNALSTRENGTH\":4, \"APPPACKAGE\":1003}";
        TRANSACTIONDATETIME = "2012-11-16 18:11:26";
        TRANSACTIONUSERTOKEN = "";
    } 
```

注意我使用的是 xcode 版本 4.3.2 (4E2002)

和 iOS 模拟器版本 5.1 (272.21)

在 Mac OS X 10.7.5 上

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:32:03.043

```
requestData = [NSJSONSerialization JSONObjectWithData:jsonRequest options:NSJSONWritingPrettyPrinted error:&error]; 
```

是错误的，因为`JSONObjectWithData:options:error:`不会返回 a `NSData`。

返回的类型取决于您的内容`jsonRequest`（可能是 a `NSDictionary`、 a`NSArray`或其他...）。

现在的问题是：为什么不简单地将`jsonRequest`对象传递给`setHTTPBody`方法呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:25:27.577

通常，当通过 JSON 发送数据时，您的手机（或其他）中有一些相对复杂的结构，您希望将其转换为 JSON 字符串以进行传输。

JSON 字符串很好地“映射”到 NSDictionaries 和 NSArrays，因此假设您将手机端的数据放入 NSDictionaries 和 NSArrays 的结构中，然后将“根”字典/数组传递给`dataWithJSONObject`（或者，更好的是，不同的JSON 解析器/序列化器的品牌）。Apple API 将从该转换中返回一个 NSData 对象，该对象可以直接发送或转换为 NSString 并发送，具体取决于您使用的网络接口。

当/如果您返回 JSON 数据时，您将其发送`JSONObjectWithData`以转换为您的应用程序可以理解的 NSArray 和 NSDictionaries 的“巢”。

你的输入和输出颠倒了。

# ruby-on-rails - 使用多态时如何自定义“CanCan”？

> ID：14447449
> 
> 赞同：0
> 
> 时间：2013-01-21T21:22:44.540
> 
> 标签：ruby-on-rails, ruby-on-rails-3, cancan

我正在使用名为`acts_as_commentable_with_threading`
它的 gem 自动创建评论表，其中有这些列，例如`commentable_type`、`commentable_id`和等。

它被制成多态的，并且工作正常。

我有这三个模型。

*   用户
*   社区
*   话题

他们对每个都有评论。

我想让用户在他的用户页面上删除他的评论或其他人的评论。
（他可以删除他用户页面上的所有评论）

我想使它能够像下面的代码一样进行编码。
但我发现社区页面和主题页面也会发生同样的事情。
即使用户不是评论的原始创建者，如果 Community/Topic 的 ID 与 USER ID 相同，他也可以删除所有评论。

我只喜欢它启用 USER 模型。我该如何定制这个？

**模型/能力.rb**

```
can [:create, :destroy], Comment, {:user_id => user.id}
can [:destroy], Comment, {:commentable_id => user.id} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:36:36.390

由于您的`Comment`班级使用多态关联，因此`delete`当前允许在`commentable_id`匹配`id`用户时执行该操作。由于您可以在不同的表中具有冲突的 id，因此您也需要匹配`commentable_type`。尝试这样的事情：

```
can [:destroy], Comment, {:commentable_id => user.id, :commentable_type => user.class.name} 
```

# java - 如何让 JPanel 变得越来越透明、越来越透明并最终消失？

> ID：14447450
> 
> 赞同：3
> 
> 时间：2013-01-21T21:22:47.480
> 
> 标签：java, swing, jpanel, transparency

我想制作一个扩展的面板，`JPanel`当它变得可见时，它开始变得越来越透明，越来越透明，最后消失了。我的代码有什么问题？

```
public class BaloonPanel extends JPanel
{

private float transparency = 1f;
Timer timer;

public BaloonPanel()
{

    setBackground(Color.white);
    ActionListener action = new ActionListener()
    {
        @Override
        public void actionPerformed(ActionEvent e)
        {
            transparency = transparency - 0.01f;

            if (transparency < 0.0f)
            {
                timer.stop();
            }
            repaint();
        }
    };

    timer = new Timer(100, action);
    timer.start();
}

@Override
public void paint(Graphics g)
{
    Graphics2D g2 = (Graphics2D) g.create();
    g2.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER, transparency));
    super.paint(g2);
    g2.dispose();
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T23:03:44.697

因为它`BallonPanel`是不透明的，所以重绘管理器不会费心在它下面进行绘制。这是对绘画过程的优化，为什么要画那些不需要画的东西。

您需要“说服”重绘管理器在组件下方进行绘制，同时仍绘制其背景。

将 设置`BallonPanel`为透明 ( `setOpaque(false)`) 并更新`paint`方法以填充背景。

```
public class FadePane {

    public static void main(String[] args) {
        new FadePane();
    }

    public FadePane() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.getContentPane().setBackground(Color.BLUE);
                frame.setBackground(Color.BLUE);
                frame.add(new BaloonPanel());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);

            }
        });
    }

    public class BaloonPanel extends JPanel {

        private float transparency = 1f;
        Timer timer;

        public BaloonPanel() {

            setBackground(Color.white);
            ActionListener action = new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    transparency = transparency - 0.1f;

                    if (transparency < 0.1f) {
                        transparency = 0;
                        timer.stop();
                    }
                    invalidate();
                    repaint();
                }
            };

            timer = new Timer(100, action);
            timer.setRepeats(true);

            setOpaque(false);

            final JButton fade = new JButton("Fade");
            fade.addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    timer.start();
                    fade.setEnabled(false);
                }
            });

            setLayout(new GridBagLayout());
            add(fade);
        }

        @Override
        public void paint(Graphics g) {
            Graphics2D g2 = (Graphics2D) g.create();
            System.out.println(transparency);
            g2.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER, transparency));
            g2.setColor(getBackground());
            g2.fillRect(0, 0, getWidth(), getHeight());
            super.paint(g2);
            g2.dispose();
        }
    }
} 
```

# java - 使用 JSoup for Java 从网页中提取特定行

> ID：14447452
> 
> 赞同：2
> 
> 时间：2013-01-21T21:22:52.477
> 
> 标签：java, screen-scraping, web-scraping, jsoup

嗨，我想使用 JSoup 库从网站上抓取一些文本。我尝试了以下代码，这给了我整个网页，我只想提取一个特定的行。这是我正在使用的代码：

```
Document doc = null;
try {
doc = Jsoup.connect("http://www.example.com").get();
} catch (IOException e) {
e.printStackTrace();
}
String text = doc.html();

System.out.println(text); 
```

打印出以下内容

```
<html>
 <head></head>
 <body>
  Martin,James,28,London,20k
  <br /> Sarah,Jackson,43,Glasgow,32k
  <br /> Alex,Cook,22,Liverpool,18k
  <br /> Jessica,Adams,34,London,27k
  <br /> 
 </body>
</html> 
```

如何仅提取读取的第 6 行`Alex,Cook,22,Liverpool,18k`并将其放入数组中，其中每个元素都是逗号前的一个单词（例如：[0] = Alex，[1] = Cook 等）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:59:33.503

也许您必须稍微格式化（？）结果：

```
 Document doc = Jsoup.connect("http://www.example.com").get();
    int count = 0; // Count Nodes

    for( Node n : doc.body().childNodes() )
    {
        if( n instanceof TextNode )
        {
            if( count == 2 ) // Node 'Alex'
            {
                String t[] = n.toString().split(","); // you have an array with each word as string now

                System.out.println(Arrays.toString(t)); // eg. output
            }
            count++;
        }
    } 
```

**输出：**

```
[ Alex, Cook, 22, Liverpool, 18k ] 
```

## 编辑：

由于您无法`TextNode`通过其内容选择 's（仅可能与`Element`s 一起使用），因此您需要一个小解决方法：

```
for( Node n : doc.body().childNodes() )
{
    if( n instanceof TextNode )
    {
        str = n.toString().trim();

        if( str.toLowerCase().startsWith("alex") ) // Node 'Alex'
        {
            String t[] = n.toString().split(","); // you have an array with each word as string now

            System.out.println(Arrays.toString(t)); // eg. output
        }
    }
} 
```

# delphi - 如何计算字符串网格中选定单元格的最小值、最大值和平均值？

> ID：14447453
> 
> 赞同：2
> 
> 时间：2013-01-21T21:22:54.593
> 
> 标签：delphi, delphi-xe3

我正在使用 Delphi XE3，并且正在开发一个应用程序来从 Excel 中读取数字类型的单元格。我正在使用`TStringGrid`此导入。

我已经知道，如何让它们进入字符串网格，但无法像 Excel 中那样执行任何数学函数。如何计算字符串网格的选定单元格值的最小值、最大值和平均值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:30:29.983

您可以尝试以下功能。它返回在当前字符串网格的选择中找到的数值的计数。传递给它的声明参数返回当前选择的数值（如果有的话）的最小值、最大值和平均值：

```
uses
  Math;

function CalcStats(AStringGrid: TStringGrid; var AMinValue, AMaxValue,
  AAvgValue: Double): Integer;
var
  Col, Row, Count: Integer;
  Value, MinValue, MaxValue, AvgValue: Double;
begin
  Count := 0;
  MinValue := MaxDouble;
  MaxValue := MinDouble;
  AvgValue := 0;

  for Col := AStringGrid.Selection.Left to AStringGrid.Selection.Right do
    for Row := AStringGrid.Selection.Top to AStringGrid.Selection.Bottom do
    begin
      if TryStrToFloat(AStringGrid.Cells[Col, Row], Value) then
      begin
        Inc(Count);
        if Value < MinValue then
          MinValue := Value;
        if Value > MaxValue then
          MaxValue := Value;
        AvgValue := AvgValue + Value;
      end;
    end;

  Result := Count;
  if Count > 0 then
  begin
    AMinValue := MinValue;
    AMaxValue := MaxValue;
    AAvgValue := AvgValue / Count;
  end;
end; 
```

这是一个示例用法：

```
procedure TForm1.Button1Click(Sender: TObject);
var
  MinValue, MaxValue, AvgValue: Double;
begin
  if CalcStats(StringGrid1, MinValue, MaxValue, AvgValue) > 0 then
    Label1.Caption :=
      'Min. value: ' + FloatToStr(MinValue) + sLineBreak +
      'Max. value: ' + FloatToStr(MaxValue) + sLineBreak +
      'Avg. value: ' + FloatToStr(AvgValue)
  else
    Label1.Caption := 'There is no numeric value in current selection...';
end; 
```

另一章是如何在字符串网格的选择发生变化时获得通知。没有事件也没有虚拟方法来实现像`OnSelectionChange`. 但这将是另一个问题的主题。

# android - 如何让android应用程序支持多种屏幕尺寸 所以我使用下面的代码让我的应用程序在不同的 android 设备上缩放屏幕尺寸，但是当我在我的 Nexus 7 上进行测试时，它不会缩放，就好像它在 4 英寸屏幕上一样。当我在 7 英寸屏幕上的模拟器中运行它时，它可以工作。我的清单文件有什么问题吗？ <supports-screens 1="" 4="" 7="" 4840="" android:resizeable="true" 问问题="" 2013-01-21t21:22:56.900="" 次="" this="" question="" shows="" research="" effort;="" it="" is="" useful="" and="" clear="" does="" not="" show="" any="" unclear="" or="" bookmark="" question.="" activity="" on="" post.="" 所以我使用下面的代码让我的应用程序在不同的="" android="" 设备上缩放屏幕尺寸，但是当我在我的="" nexus="" 上进行测试时，它不会缩放，就好像它在="" 英寸屏幕上一样。当我在="" 英寸屏幕上的模拟器中运行它时，它可以工作。我的清单文件有什么问题吗？="" <supports-screens="" android:smallscreens="true" android:largescreens="true" android:xlargescreens="true" android:normalscreens="true" android:anydensity="true">这段代码就在“应用程序”部分之前，对吗？ Gradle 不会通过工具 api 公开语言级别，所以我认为这只是 intellij 中定义的“默认项目”语言。 您可以在这张jetbrains youtrack 票中查看详细信息，并回溯到相应的 gradle 问题 至于“如何解决它”，我认为唯一真正的选择是不使用 use jetgradle & use the gradle idea plugin。Intellij 12.1 将有一个大大改进的 jetgradle 插件，但如果信息不在工具 api 上，那么很难看出如何解决这个问题。 编辑：Gradle 刚刚发布了 2.11 的 RC，其中（终于！）包含此功能，有关详细信息，请参阅发行说明，其中解释了对工具 api（即 intellij jetgradle）和 gradle idea 插件的支持。 android 4 2 回答 2 This answer is useful 4 好的，所以您必须知道的是，support-screens这不会使您的应用程序在您支持的屏幕上看起来“漂亮”（查看此链接）。它只是告诉具有此类屏幕的用户将能够下载您的应用程序，但要使其正确显示则取决于您。您必须自己为特定屏幕创建布局。 有关它的更多信息，您可以在 Android 的文档中阅读：http: //developer.android.com/guide/practices/screens_support.html 基本上，您必须正确命名存储布局文件的目录，以便让 Android 知道它应该为特定设备选择哪个目录。例如，如果您的布局文件是“layout.xml”，您应该： /res/layout/layout.xml // Default layout /res/layout-small/layout.xml // Small screens /res/layout-large/layout.xml // Large screens /res/layout-xlarge/layout.xml // Extra large screens 您可以更进一步，通过在目录名称中指定另一个关键字来为portrait和视图制作不同的布局：landscape /res/layout-small-land/layout.xml // Small screens, landscape view /res/layout-small-portrait/layout.xml // Small screens, portrait view 请记住，标签顺序很重要，因此您不能编写layout-portrait-small. 于 2013-01-21T21:25:07.853 回答 This answer is useful 0 使用相对布局它将解决您的大部分问题。另外使用文件夹名称，下面给出我处理多个屏幕的方式是这种方式，它的工作正常.....如果有人改进了方式，请指导我 屏幕尺寸 480x800 布局-正常-hdpi-480x800 可绘制-正常-hdpi-480x800 屏幕尺寸Galaxy Nexus --- 虽然它的尺寸是1280x720但实际上由于系统栏其尺寸（屏幕尺寸）不同 布局-正常-xhdpi 可绘制的正常 xhdpi 屏幕尺寸注 5.3 --- 布局-正常-xhdpi-1280x800 可绘制-正常-xhdpi-1280x800 屏幕尺寸S3 --- 布局-正常-xhdpi-1280x720 可绘制-正常-xhdpi-1280x720 屏幕尺寸7 英寸选项卡 2支持 OS 版本 3 及更高版本 --- 由于系统栏其尺寸（屏幕尺寸）不同，实际不要写尺寸 1026x600 bsz 布局-大-mdpi 可绘制的大 mdpi 屏幕尺寸7inch tab p1000等支持小于 3 的操作系统版本--- 布局-大-hdpi-1024x600 可绘制-大-hdpi-1024x600 屏幕尺寸1280x800 选项卡 10.1、10.2、注释 10.1等 --- 如果您想添加尺寸，其他方式也可以 布局-xlarge-mdpi 可绘制-xlarge-mdpi 于 2013-10-28T12:40:02.620 回答 Related 1 java - XSD 导入问题 2 salesforce - 如何在apex中将一个类的方法调用到另一个类中 1 javascript - The proper way to handle the XMLHttpRequest by using javascript 1 vb.net - Invalid printer specified 4 javascript - JQuery将多个类添加到一个div标签 4 perl - 在打印函数中调用子程序 2 colors - 机器之间颜色不同 3 java - 如何将字节数组转换为整数？ 4 html - CSS对齐多个文本部分 1 c# - Webforms Login-Control and IE 10 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641</supports-screens>

> ID：14447454
> 
> 赞同：1
> 
> 时间：
> 
> 标签：android

所以我使用下面的代码让我的应用程序在不同的 android 设备上缩放屏幕尺寸，但是当我在我的 Nexus 7 上进行测试时，它不会缩放，就好像它在 4 英寸屏幕上一样。当我在 7 英寸屏幕上的模拟器中运行它时，它可以工作。我的清单文件有什么问题吗？

```
<supports-screens 
android:resizeable="true"
android:smallScreens="true" 
android:largeScreens="true"
android:xlargeScreens="true"  
android:normalScreens="true" 
android:anyDensity="true"
/> 
```

这段代码就在“应用程序”部分之前，对吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T21:25:07.853

好的，所以您必须知道的是，`support-screens`这不会使您的应用程序在您支持的屏幕上看起来“漂亮”（查看此[链接](http://developer.android.com/guide/topics/manifest/supports-screens-element.html)）。它只是告诉具有此类屏幕的用户将能够下载您的应用程序，但要使其正确显示则取决于您。您必须自己为特定屏幕创建布局。

有关它的更多信息，您可以在 Android 的文档中阅读：http: [//developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

基本上，您必须正确命名存储布局文件的目录，以便让 Android 知道它应该为特定设备选择哪个目录。例如，如果您的布局文件是“layout.xml”，您应该：

```
/res/layout/layout.xml         // Default layout
/res/layout-small/layout.xml   // Small screens
/res/layout-large/layout.xml   // Large screens
/res/layout-xlarge/layout.xml  // Extra large screens 
```

您可以更进一步，通过在目录名称中指定另一个关键字来为`portrait`和视图制作不同的布局：`landscape`

```
/res/layout-small-land/layout.xml      // Small screens, landscape view
/res/layout-small-portrait/layout.xml  // Small screens, portrait view 
```

请记住，标签顺序很重要，因此您**不能**编写`layout-portrait-small`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-28T12:40:02.620

使用相对布局它将解决您的大部分问题。另外使用文件夹名称，下面给出我处理多个屏幕的方式是这种方式，它的工作正常.....如果有人改进了方式，请指导我

屏幕尺寸 480x800

布局-正常-hdpi-480x800

可绘制-正常-hdpi-480x800

屏幕尺寸**Galaxy Nexus** --- 虽然它的尺寸是**1280x720**但实际上由于系统栏其尺寸（屏幕尺寸）不同

布局-正常-xhdpi

可绘制的正常 xhdpi

屏幕尺寸**注 5.3** ---

布局-正常-xhdpi-1280x800

可绘制-正常-xhdpi-1280x800

屏幕尺寸**S3** ---

布局-正常-xhdpi-1280x720

可绘制-正常-xhdpi-1280x720

屏幕尺寸7 英寸**选项卡 2**支持 OS 版本 3 及更高版本 --- 由于系统栏其尺寸（屏幕尺寸）不同，实际不要写尺寸 1026x600 bsz

布局-大-mdpi

可绘制的大 mdpi

屏幕尺寸**7inch tab p1000**等支持小于 3 的操作系统版本---

布局-大-hdpi-1024x600

可绘制-大-hdpi-1024x600

屏幕尺寸**1280x800 选项卡 10.1、10.2、注释 10.1**等 --- 如果您想添加尺寸，其他方式也可以

布局-xlarge-mdpi

可绘制-xlarge-mdpi

# c# - 单元测试数据库修改功能？

> ID：14447460
> 
> 赞同：3
> 
> 时间：2013-01-21T21:23:20.423
> 
> 标签：c#, asp.net, sql, linq, unit-testing

我有这样的方法：

```
public static bool ChangeCaseEstimatedHours(int caseID, decimal? time)
   {
       Case c = Cases.Get(caseID);

       if (c != null)
       {
           c.EstimatedHours = time;
           return Cases.Update(c);
       }

       return false;
   }

   public static bool RemoveCase(int caseID)
   {
       return Cases.Remove(caseID);
   } 
```

它在内部使用 LINQ 进行查询。

我想知道我应该如何测试这些。它们没有状态，所以它们是静态的。他们还修改数据库。

因此，我必须创建一个案例，然后在同一个测试中将其删除，但单元测试应该只做一件事。在这些情况下通常会做什么？

如何测试数据库查询、更新和删除？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:43:43.887

需要访问数据库的测试可能是最难维护的测试。如果您可以避免在单元测试中接触数据库，我会尝试为 Cases 类创建一个接口。

```
interface ICase
    {
        ICase Get(int caseID);
        bool RemoveCase(int caseID);
    } 
```

然后使用 RhinoMock、Moq 验证是否调用了 Get() 和 RemoveCase()。

如果您坚持需要使用数据库进行测试，那么您将需要花时间设置测试数据库并进行适当的数据清理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:38:51.593

也许您可以考虑基于 Rails 框架的方法：

1.  通过预设（Rails 中的固定装置）初始化数据库表内容
2.  开启交易
3.  运行测试
4.  回滚事务
5.  转到第 2 点。进行另一个测试

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T22:29:28.847

“知路与行路”是有区别的。您要测试的内容将归类为集成测试而不是单元测试。单元测试是在没有任何外部依赖的情况下独立执行的，因此即使您正在运行它的机器上没有物理数据库实例，它也可以使测试运行。[在此处](https://stackoverflow.com/questions/5357601/unit-test-and-integration-tests)查看更多差异。

这就是为什么像 Repository 这样的模式在做基于持久性的应用程序时非常受欢迎，因为它们通过 Mocking 提高了数据层的单元测试能力。[在此处](http://www.codeproject.com/Articles/26667/Implementing-the-Repository-Pattern-with-LINQ-to-S)查看示例。

因此，您有 2 个选项（蓝色药丸或红色药丸）：

Blue Pill：购买[TypeMock Isolator essential](http://www.typemock.com/isolator-product-page)或[JustMock 之](http://www.telerik.com/products/mocking.aspx)类的工具，您将能够模拟代码中的任何内容，“然后故事就结束了”。

Red Pill：将现有的数据层设计重构为基于接口的模式之一，并使用免费的 Mocking 框架，如[Moq](http://code.google.com/p/moq/)或[RhinoMocks](http://hibernatingrhinos.com/oss/rhino-mocks)，并“看看兔子洞有多深”

祝一切顺利。

# tomcat - Tomcat 7.1.1：访问被拒绝

> ID：14447463
> 
> 赞同：1
> 
> 时间：2013-01-21T21:23:28.477
> 
> 标签：tomcat

我无法登录到 Tomcat 7.1.1 的管理器应用程序。即使使用正确的凭据，我总是会收到 403 Access Denied。我错过了什么？

tomcat-users.xml：

```
<tomcat-users>
  <role rolename="manager"/>
  <role rolename="manager-gui"/>
  <role rolename="admin"/>
  <user username="admin1" password="password" roles="manager, admin"/>
  <user username="admin2" password="password" roles="manager-gui"/>
</tomcat-users> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:07:17.400

如果在 tomcat 启动后 tomcat-users.xml 文件已更改，您可能尝试使用的不是实际的用户/密码对。在这种情况下，重新启动 tomcat 应该会有所帮助。

如果tomcat启动`CATALINA_HOME`并`CATALINA_BASE`指向不同的目录，请确保您正在查看`$CATALINA_BASE/conf/tomcat-users.xml`文件。

另外，请确保对管理器应用程序的访问由 控制`UserDatabaseRealm`，否则，此文件中的用户/密码信息无效。在 中搜索`<Realm/>`元素`CATALINA_HOME/conf/server.xml`。

还有一些其他组件可能会覆盖/修改`UserDatabse`JNDI 资源，该资源通常从 tomcat-users.xml 读取用户和角色信息以供`UserDatabaseRealm`. 在 中搜索`<Resource name="UserDatabase"/>`元素`CATALINA_HOME/conf/server.xml`。

您可能还想查看 Tomcat 文档中的[此](http://tomcat.apache.org/tomcat-7.0-doc/realm-howto.html)页面。

# java - 如何通过两个线程同步关闭套接字？

> ID：14447473
> 
> 赞同：1
> 
> 时间：2013-01-21T21:24:05.433
> 
> 标签：java, android, synchronized

我有两个线程，一个用于读取，一个用于通过同一个套接字写入数据。何时出现连接问题，两个线程捕获异常并尝试重新连接。为此，它们调用相同的方法

```
 public synchronized void close_connection() {
        try {
            socket.shutdownInput();
            socket.shutdownOutput();
            socket.close();
            try {
                Thread.sleep(500);
            } catch (InterruptedException e1) {
                e1.printStackTrace();
            }
        } catch (IOException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        }
    } 
```

然后第二个尝试建立连接：

```
public synchronized boolean connect() {
            boolean result=true;
            socket = new Socket();
            try {
                socket.connect(new InetSocketAddress(address, port), 500);
                in = new BufferedReader(new InputStreamReader(
                        socket.getInputStream()));
                out = new BufferedWriter(new OutputStreamWriter(
                        socket.getOutputStream()));
            } catch (IOException e) {
                result=false;

            }
            return result;
        } 
```

问题是如何避免立即尝试从两个线程一一连接服务器（在连接错误之后 - 例如在服务器关闭连接之后）。我的意思是：如果一个线程尝试连接，第二个线程应该知道这一点并且不要尝试做同样的事情，而是等待第一个线程建立连接（以避免永久战斗线程问题断开连接、连接、断开连接、连接......） . 我试过同步，但我的经验太少了。问候， 阿蒂克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:17:24.570

You could try something like this:

```
while(not connected){
   try reconnecting
   if(success){
      //Everything is ok, go on
   } else {
      //sleep for random period of time and retry
   }
} 
```

or you can implement the socket operations in an object and share that object between your threads using locks.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-20T08:35:59.530

使用适当的互斥锁。这将确保只有一个线程可以访问代码的 connect() 部分。

# repository - 创建私有远程 Ivy 存储库

> ID：14447475
> 
> 赞同：3
> 
> 时间：2013-01-21T21:24:16.243
> 
> 标签：repository, gradle, ivy

我一直在进行大量搜索，但无法将所有部分放在一起。我想在我们的一台服务器上创建一个常春藤存储库。我想将其锁定为私有，然后能够从 Gradle 发布到此存储库。

我知道如何使用 Gradle 进行发布，并且我可以使用 Gradle 创建的本地 ivy 文件系统：

```
repositories {
  mavenCentral()
  ivy {
    name "localRepos"
    url "${System.properties['user.home']}/repos"
  }
}

uploadArchives {
  repositories {
    add project.repositories.localRepos
  }
} 
```

所以我现在需要做的就是将其转化为发布到远程私人仓库。但首先，显然，我需要创建该存储库，但我似乎无法从 Ivy 文档或 Google 搜索中弄清楚这一点。有人可以指出我正确的方向吗？

我宁愿不必采用 Nexus 等方法（没有 Maven）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T22:41:34.777

Ivy 存储库只是一个文件存储，因此您需要设置一个服务器（例如 Apache httpd）来允许读取和写入这些文件（例如通过 HTTP GET/PUT）。但是，我强烈建议使用存储库管理器。[神器](http://www.jfrog.com/home/v_artifactory_opensource_overview)是个不错的选择。

# algorithm - 计算斜坡下方平面的百分比

> ID：14447476
> 
> 赞同：0
> 
> 时间：2013-01-21T21:24:17.710
> 
> 标签：algorithm

我有点被这个问题困住了。我有一个 NxN 正方形和一条穿过这个正方形的线。在给定任意斜率的情况下，如何计算落在线上方和下方的 NxN 正方形的百分比？我想我必须在这个上使用勾股定理，我只是不知道如何应用它。任何帮助表示赞赏。（不是作业）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:38:39.183

基本思路：找到直线与正方形相交的0、1或2个点。如果有 0 或 1 个交叉点，则正方形完全位于线的一侧。如果有两个，则将正方形平分为两个多边形（如果两个交点在相邻边上，则为三角形和五边形，如果交点在相对边上，则为两个四边形）。找到两个部分的各自区域，这将为您提供百分比。

# css - 将 css 属性：值作为 sass mixin 参数传递

> ID：14447477
> 
> 赞同：5
> 
> 时间：2013-01-21T21:24:17.537
> 
> 标签：css, sass

在 sass/scss 中是否可能出现类似以下 dummyexample 的内容？我需要这样的东西来防止不同设备的无休止的媒体查询重复。

```
// The dummy mixin
@mixin iphone_rules($webapp_portrait:null){

  @if($webapp_portrait != null){
    // Portrait (webapp)
    @media screen and (max-height: 460px){

     // The following line is just a dummy 
     eg. echo $webapp_portrait;
    }
  }
}

// How I want to use it
.mySelector{

   margin-left:10px;
   padding:0px;

   @include iphone_rules('margin-left:20px; padding:2px;');
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-21T21:33:10.330

Sass 不允许使用任意字符串代替属性/值语法。

对于大多数 mixin，该`@content`指令是传递样式信息的最佳选择：

```
@mixin iphone_rules {
    @media screen and (max-height: 460px){
        @content;
    }
}

.mySelector {
    @include iphone_rules {
        margin-left:10px;
        padding:0px;
    }
} 
```

否则，样式信息可以作为映射（或 Sass 3.2 及更早版本的列表列表）传入：

```
@mixin iphone_rules($styles: ()) {
    @media screen and (max-height: 460px){
        @each $p, $v in $styles {
            #{$p}: $v;
        }
    }
}

.mySelector {
    margin-left:10px;
    padding:0px;

    @include iphone_rules(('margin-left': 20px, 'padding': 2px));
} 
```

# c - 如何通知父进程我已完成

> ID：14447482
> 
> 赞同：0
> 
> 时间：2013-01-21T21:24:24.487
> 
> 标签：c, linux

这是一个非常基本的问题。父进程将创建一些共享内存，将两个整数放入其中，然后分叉一个子进程，该子进程将转到共享内存并计算它们的总和。这一切都很好，但是孩子如何通知父母它已经完成计算总和？我是否需要在两个进程之间创建一个管道来执行此操作？或 waitpid() 足以实现这一目标？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:26:20.763

如果孩子在写完总和后退出，那么`waitpid()`就足够了。否则，您需要一些 IPC（互斥量/信号量/管道）来表示完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:26:22.347

`waitpid()`为此目的应该没问题。只需 fork 并在父级中执行`waitpid()`，在子级中计算相同的共享内存位置，然后返回并`waitpid()`解除阻塞，父级可以使用该总和做任何它想做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T21:30:01.723

如果在计算整数的总和后不再需要您的子进程，它可以从 main 返回总和，并且父进程可以使用 waitpid 检索结果。在这种情况下，孩子看起来像这样：

子进程：

```
int main(int argc, char** argv) {
    int a,b;
    /* read integers a and b from shared memory */

    /* return sum */
    return a + b;
} 
```

如果子进程还需要为父进程做进一步的工作，在子进程和父进程之间建立一个管道，或者安排一些其他形式的 IPC 来回传递信息。

# scala - 从两个 HList 中创建所有对的 HList

> ID：14447487
> 
> 赞同：14
> 
> 时间：2013-01-21T21:24:42.983
> 
> 标签：scala, shapeless, hlist

我在 Scala 中使用 shapeless，我想编写一个函数 allPairs，它将采用两个 HList 并返回所有元素对的 HList。例如：

```
import shapeless._
val list1 = 1 :: "one" :: HNil
val list2 = 2 :: "two" :: HNil
// Has value (1, 2) :: (1, "two") :: ("one", 2) :: ("one", "two") :: HNil
val list3 = allPairs(list1, list2) 
```

知道怎么做吗？

另外，我想强调一下，我正在寻找一个*函数*，而不是内联的代码块。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-22T10:55:31.717

您不能在此处使用`for`-comprehension 或与函数文字的组合`map`（`flatMap`正如其他答案所建议的那样），因为这些方法`HList`需要[更高级别的函数](https://github.com/milessabin/shapeless/blob/master/core/src/main/scala/shapeless/poly.scala)。如果您只有两个静态类型列表，这很容易：

```
import shapeless._

val xs = 1 :: 'b :: 'c' :: HNil
val ys = 4.0 :: "e" :: HNil

object eachFirst extends Poly1 {
  implicit def default[A] = at[A] { a =>
    object second extends Poly1 { implicit def default[B] = at[B](a -> _) }
    ys map second
  }
}

val cartesianProductXsYs = xs flatMap eachFirst 
```

这给了我们以下（适当输入）：

```
(1,4.0) :: (1,e) :: ('b,4.0) :: ('b,e) :: (c,4.0) :: (c,e) :: HNil 
```

编写一个使用`HList`参数来执行此操作的方法比较棘手。这是一个如何完成它的快速示例（使用一些更通用的机器）。

我将首先指出，我们可以将查找两个普通列表的笛卡尔积视为“提升”一个函数，该函数接受两个参数并将它们作为元组返回给列表的应用函子。例如，您可以[在 Haskell 中编写以下代码](https://stackoverflow.com/a/4119898/334519)：

```
import Control.Applicative (liftA2)

cartesianProd :: [a] -> [b] -> [(a, b)]
cartesianProd = liftA2 (,) 
```

我们可以写一个多态二进制函数，对应`(,)`这里：

```
import shapeless._

object tuple extends Poly2 {
  implicit def whatever[A, B] = at[A, B] { case (a, b) => (a, b) }
} 
```

为了完整起见，再次定义我们的示例列表：

```
val xs = 1 :: 'b :: 'c' :: HNil
val ys = 4.0 :: "e" :: HNil 
```

现在我们将致力于一个名为的方法，该方法`liftA2`将允许我们编写以下内容：

```
liftA2(tuple)(xs, ys) 
```

并得到正确的结果。这个名字`liftA2`有点误导，因为我们并没有真正的应用函子实例，而且因为它不是通用的——我正在研究名为`flatMap`and `map`on的方法的模型`HList`，并且愿意接受更好的建议。

现在我们需要一个类型类，它允许我们采用 a `Poly2`，将其部分应用于某些东西，并将生成的一元函数映射到 a 上`HList`：

```
trait ApplyMapper[HF, A, X <: HList, Out <: HList] {
  def apply(a: A, x: X): Out
}

object ApplyMapper {
  implicit def hnil[HF, A] = new ApplyMapper[HF, A, HNil, HNil] {
    def apply(a: A, x: HNil) = HNil
  }
  implicit def hlist[HF, A, XH, XT <: HList, OutH, OutT <: HList](implicit
    pb: Poly.Pullback2Aux[HF, A, XH, OutH],
    am: ApplyMapper[HF, A, XT, OutT]
  ) = new ApplyMapper[HF, A, XH :: XT, OutH :: OutT] {
    def apply(a: A, x: XH :: XT) = pb(a, x.head) :: am(a, x.tail)
  }
} 
```

现在有一个类型类来帮助提升：

```
trait LiftA2[HF, X <: HList, Y <: HList, Out <: HList] {
  def apply(x: X, y: Y): Out
}

object LiftA2 {
  implicit def hnil[HF, Y <: HList] = new LiftA2[HF, HNil, Y, HNil] {
    def apply(x: HNil, y: Y) = HNil
  }

  implicit def hlist[
    HF, XH, XT <: HList, Y <: HList,
    Out1 <: HList, Out2 <: HList, Out <: HList
  ](implicit
    am: ApplyMapper[HF, XH, Y, Out1],
    lift: LiftA2[HF, XT, Y, Out2],
    prepend : PrependAux[Out1, Out2, Out]
  ) = new LiftA2[HF, XH :: XT, Y, Out] {
    def apply(x: XH :: XT, y: Y) = prepend(am(x.head, y), lift(x.tail, y))
  }
} 
```

最后是我们的方法本身：

```
def liftA2[HF, X <: HList, Y <: HList, Out <: HList](hf: HF)(x: X, y: Y)(implicit
  lift: LiftA2[HF, X, Y, Out]
) = lift(x, y) 
```

这就是全部——现在`liftA2(tuple)(xs, ys)`可以了。

```
scala> type Result =
     |   (Int, Double) :: (Int, String) ::
     |   (Symbol, Double) :: (Symbol, String) ::
     |   (Char, Double) :: (Char, String) :: HNil
defined type alias Result

scala> val res: Result = liftA2(tuple)(xs, ys)
res: Result = (1,4.0) :: (1,e) :: ('b,4.0) :: ('b,e) :: (c,4.0) :: (c,e) :: HNil 
```

正如我们所愿。

# php - 出现错误：警告：preg_match() [function.preg-match]: Unknown modifier ',' in

> ID：14447499
> 
> 赞同：-1
> 
> 时间：2013-01-21T21:25:23.973
> 
> 标签：php, preg-match, ereg

这是我试图用来替换 PHP5.3 有问题的“if (ereg”) 的语法。

原始代码：

```
if (ereg('([0-9.-]{1,}),([0-9.-]{1,})', $location, $regs)) 
```

新代码：

```
if (preg_match('/[0-9.-]{1,}/,/[0-9.-]{1,}/', $location, $regs)) 
```

这个新代码导致了警告。我试图使用以前的帖子来解决这个问题，在这里，但我不太正确。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T21:27:40.917

您忘记转义作为正则表达式分隔符的斜杠：

```
if (preg_match('/[0-9.-]{1,}/,/[0-9.-]{1,}/', $location, $regs)) 
```

应该

```
if (preg_match('/[0-9.-]{1,}\/,\/[0-9.-]{1,}/', $location, $regs)) 
```

# iphone - Skype 如何在 iOS 上 10 分钟后继续发送通知？

> ID：14447501
> 
> 赞同：1
> 
> 时间：2013-01-21T21:25:34.540
> 
> 标签：iphone, ios, ipad, cryptography, skype

我注意到 iPad 上的 Skype 有点奇怪。即使在我关闭应用程序后，它也会不断向我发送通知，其中包含人们以文本形式发送给我的内容。对于前十分钟，这是有道理的，因为这是关闭应用程序后某些东西可以在后台运行多长时间。这些是本地通知。然而，除此之外，它根本不可能。Skype 多年来一直声称他们的连接是端到端加密的。让他们在十分钟后继续发送这些通知意味着他们是通过 Apple 的推送通知服务发送的。这意味着他们以某种方式解密了我在他们的服务器上收到的消息，并通过 Apple 将它们发送到我的设备。这似乎是没有端到端加密的明确证据，或者他们与 Apple 达成了一项协议，允许他们继续运行十分钟以上。如果是后者，有没有办法在我自己的应用程序中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:33:09.547

允许某些类别的应用程序在后台继续运行。这包括 GPS 应用程序和 VOIP 应用程序等。请参阅`UIBackgroundModes`Info.plist 键的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:36:08.467

可能，这篇文章更详细地描述了答案：[iOS：让应用程序像服务一样运行](https://stackoverflow.com/questions/11044095/ios-keep-an-app-running-like-a-service)

也在此处（搜索 UIBackgroundModes）：http: [//developer.apple.com/library/ios/#documentation/general/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html](http://developer.apple.com/library/ios/#documentation/general/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html)

# java - 德州扑克承认一对

> ID：14447504
> 
> 赞同：3
> 
> 时间：2013-01-21T21:25:46.260
> 
> 标签：java, arraylist, poker

我的程序只有在第一次检查两对后才能识别一对。当首先检查一对时，它发现它没问题。但是当我先检查两对然后检查一对时，它没有找到它。任何帮助，将不胜感激。

```
package card.game.simulator;

import java.util.ArrayList;

public class RankingUtility {
private RankingEnum rank;

public String getRankOfHand(ArrayList<Card> hand) {
    System.out.printf("%s\n", hand.toString());
    ArrayList<Card> rankingCards = getTwoPair(hand);
    if(rankingCards != null) {
        return "Two Pair!";
    }
    System.out.printf("%s\n", hand.toString());
    rankingCards = getOnePair(hand);
    if(rankingCards != null) {
        return "One Pair!";
    }
    System.out.printf("%s\n", hand.toString());
    return "You got nuthin...";
}

public boolean isSameSuit(ArrayList<Card> hand) {
    CardSuitEnum suit = hand.get(0).getSuit();
    for(Card card : hand) {
        if(card.getSuit() != suit) {
            return false;
        }
    }
    return true;
}

public ArrayList<Card> checkPair(ArrayList<Card> hand) {
    ArrayList<Card> checkedPair = new ArrayList<>();
    for(Card card1 : hand) {
        checkedPair.add(card1);
        for(Card card2 : hand) {
            if(!card1.equals(card2) && card1.getFace().equals(card2.getFace())) {
                checkedPair.add(card2);
                return checkedPair;
            }
        }
        checkedPair.clear();
    }
    return null;
}

public ArrayList<Card> getTwoPair(ArrayList<Card> hand) {
    ArrayList<Card> twoPair = new ArrayList<>();
    ArrayList<Card> checkedPair = checkPair(hand);
    if(checkedPair != null) {
        twoPair.addAll(checkedPair);
        hand.removeAll(checkedPair);
    }
    checkedPair = checkPair(hand);
    if(checkedPair != null) {
        twoPair.addAll(checkedPair);
        return twoPair;
    }
    return null;
}

public ArrayList<Card> getOnePair(ArrayList<Card> hand) {
    return checkPair(hand);
}
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T21:29:02.270

在`checkTwoPair`你正在做的`hand.removeAll()`。这是从底层移除它`ArrayList`。这就是为什么您事后找不到它的原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T21:29:38.727

问题是您`hand`在寻找两对时正在修改：

```
 hand.removeAll(checkedPair); 
```

因此，当`getTwoPair()`完成时，唯一的一对已从手中取出，`checkPair()`不再起作用。

你需要做到`getTwoPair()`非侵入式。

或者，您可以将这两种方法合二为一，根据找到的对数返回零、两张或四张牌。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T21:30:01.473

当您运行`getTwoPair`第一个操作时，您会`checkPair(hand);`发现这对（您想要的那个）将其删除，然后尝试再次检查。当此检查失败时，它会返回。

在返回后，您将得到 (1) 已移除对子的手和 (2) 从`getTwoPair`. 这个结果给你留下了一个条件，导致主流继续，但找不到单对，因为它被删除了。

我建议制作一个数组列表的副本以进行搜索。如果找不到两对，只需返回原始数组。如果找到两对，则返回修改后的数组。

# css - 不透明度属性的简单 (?) CSS 动画

> ID：14447505
> 
> 赞同：8
> 
> 时间：2013-01-21T21:25:47.567
> 
> 标签：css, animation, css-animations

好吧，我不明白这个。我以前做过 CSS3 动画，但由于某种原因，简单地为不透明度设置动画现在对我不起作用。我错过了什么愚蠢的东西吗？

**CSS：**

```
@-webkit-keyframes fadein {
    from: { opacity: 0; }
    to: { opacity: 1; }
}

@-moz-keyframes fadein {
    from: { opacity: 0; }
    to: { opacity: 1; }
}

@keyframes fadein {
    from: { opacity: 0; }
    to: { opacity: 1; }
}

#foo {
    background-color: green;
    color: white;
    -webkit-animation: fadein 2s ease-in alternate infinite;
    -moz-animation: fadein 2s ease-in alternate infinite;
    animation: fadein 2s ease-in alternate infinite;
} 
```

**HTML：**

```
<div id="foo">This is Foo!</div> 
```

我也将它作为小提琴发布：http: [//jsfiddle.net/NRutman/Lcyvy/](http://jsfiddle.net/NRutman/Lcyvy/)

任何帮助，将不胜感激。

谢谢，-内特

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-21T21:46:46.243

`from`和之后不需要冒号`to`：

```
@keyframes fadein {
    from { opacity: 0; }
    to { opacity: 1; }
} 
```

[http://jsfiddle.net/Lcyvy/6/](http://jsfiddle.net/Lcyvy/6/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-21T21:32:25.230

改变

```
@keyframes fadein {
    from: { opacity: 0; }
    to: { opacity: 1; }
} 
```

至

```
@keyframes fadein {
    0%   { opacity: 0; }
    100% { opacity: 1; }
} 
```

[**演示**](http://jsfiddle.net/Lcyvy/4/)

# python - 将 Python 中嵌套的“while”循环函数输出到文本文件中

> ID：14447507
> 
> 赞同：0
> 
> 时间：2013-01-21T21:25:53.100
> 
> 标签：python, loops, while-loop, nested, text-files

我一直在尝试将 Python 中嵌套的“while”循环函数的输出转换为文本文件。我知道“写入文件”是：

```
TheFile=open("C:/test.txt","w")
TheFile.write("Hello")
TheFile.close() 
```

但是，当想要将我的纬度和经度坐标嵌套循环的输出输出到文本文件中时，我应该使用什么？我能够从打印功能中得到我想要的东西，但似乎无法将它放入文本文件中......谢谢：

```
lat=-100
long=-190
 while lat <=80:
  lat=lat+10
  long=-190
  while long<=170:
      long=long+10
     print ("latitude:"+format(lat),"longitude:"+format(long)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:44:10.927

```
#! /usr/bin/python3.2

with open("out2.txt","w") as f:
    for lat in range (-90, 100, 10):
        for lon in range (-180, 190, 10):
                f.write ("latitude: {}\tlongitude: {}\n".format (lat, lon) ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:30:37.293

只使用一个`TheFile=open("C:/test.txt","w")`语句，并且只使用一个`TheFile.close()`语句，并确保它们在所有循环之外。

然后，您可以使用`file=`to 的参数`print`，否则将其保留为完全相同的`print`语句。

在您的示例中，例如：

```
TheFile=open("C:/test.txt","w")
lat=-100
long=-190
 while lat <=80:
  lat=lat+10
  long=-190
  while long<=170:
      long=long+10
      print ("latitude:"+format(lat),"longitude:"+format(long), file=TheFile)
TheFile.close() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T21:31:34.887

这会将打印的输出打印`stdout`到文件中。您是否在 write() 函数中使用了“，”？它将它视为两个单独的参数。

更多`write`来自 Python shell 的帮助。

> **写(...)**
> 写(str) -> 无。将字符串 str 写入文件。
> 
> ```
> Note that due to buffering, flush() or close() may be needed before
> the file on disk reflects the data written. 
> ```

试试这个代码：

```
with open("output","w") as f:
  lat=-100
  long=-190
  while lat <=80:
    lat=lat+10
    long=-190
    while long<=170:
      long=long+10
      f.write("latitude:"+format(lat)+" longitude:"+format(long)) 
```

# sql - 插入嵌套字段

> ID：14447509
> 
> 赞同：0
> 
> 时间：2013-01-21T21:25:57.767
> 
> 标签：sql, linq, linq-to-sql

我是 LINQ to SQL 的新用户，我在使用它时遇到了一些问题。我使用 LINQ to SQL Designer 并创建了我的类，映射到数据库表上。特别是，我有一个名为 voice 的课程：

```
[global::System.Data.Linq.Mapping.TableAttribute(Name="dbo.voce")]
public partial class voce : INotifyPropertyChanging, INotifyPropertyChanged
{

    private static PropertyChangingEventArgs emptyChangingEventArgs = new PropertyChangingEventArgs(String.Empty);

    private int _id_voce;

    ... other private fields;

    private int _category;

    private EntityRef<category> _category1;
            public voce()
    {
        this._riepilogo = new EntitySet<riepilogo>(new Action<riepilogo>(this.attach_riepilogo), new Action<riepilogo>(this.detach_riepilogo));
        this._hera = default(EntityRef<hera>);
        this._category1 = default(EntityRef<category>);
        OnCreated();
    }

    [global::System.Data.Linq.Mapping.ColumnAttribute(Storage="_id_voce", AutoSync=AutoSync.OnInsert, DbType="Int NOT NULL IDENTITY", IsPrimaryKey=true, IsDbGenerated=true)]
    public int id_voce
    {
        get
        {
            return this._id_voce;
        }
        set
        {
            if ((this._id_voce != value))
            {
                this.Onid_voceChanging(value);
                this.SendPropertyChanging();
                this._id_voce = value;
                this.SendPropertyChanged("id_voce");
                this.Onid_voceChanged();
            }
        }
    }

    ......
    [global::System.Data.Linq.Mapping.ColumnAttribute(Storage="_category", DbType="Int NOT NULL")]
    public int category
    {
        get
        {
            return this._category;
        }
        set
        {
            if ((this._category != value))
            {
                if (this._category1.HasLoadedOrAssignedValue)
                {
                    throw new System.Data.Linq.ForeignKeyReferenceAlreadyHasValueException();
                }
                this.OncategoryChanging(value);
                this.SendPropertyChanging();
                this._category = value;
                this.SendPropertyChanged("category");
                this.OncategoryChanged();
            }
        }
    } 
```

如您所见，voce 类有一个名为 category 的字段，它引用一个名为 category 的表。

当我向我的数据库添加一个新的声音时，我创建了一个新的声音，使用 DataContext，我只需添加它，使用：

```
voce v = new voce(){...field, category1 = //create or retrieve category}; 
```

特别是，如果已经存在，则从数据库中检索类别字段，如果不存在，则在插入语音之前将其插入。

问题是当我在数据库中添加语音时：

```
datacontext.InsertOnSubmit(v);
datacontext.SubmitChanges(); 
```

它再次插入类别，但由于独特的约束而失败。

如何在不添加每个嵌套对象的情况下添加声音？

谢谢你，对不起我的英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T09:09:21.790

```
internal category GetCategoryFromDescription (string desc, Utility.VOICE_MODALITY mode)
    {
        bool type = mode == Utility.VOICE_MODALITY.ENTRATA ? true : false;
        var query = from cat in dc.category
                    where cat.description == desc && cat.type == type
                    select cat;

        if (query.Count() == 0)
        {
            category newC =  new category() { description = desc };
            dc.category.InsertOnSubmit(newC);
            dc.SubmitChanges();
            return newC;
        }
        else
            return query.Single();

    } 
```

# actionscript-3 - AS3 - TypeError #1009 与计时器

> ID：14447512
> 
> 赞同：1
> 
> 时间：2013-01-21T21:26:19.787
> 
> 标签：actionscript-3, typeerror

我只是不知道该怎么办。我已经浏览了一个小时，并且一直在阅读错误：

```
TypeError: Error #1009: Cannot access a property or method of a null object reference.
    at Shooter_Enemy/shotHandler()
    at flash.utils::Timer/_timerDispatch()
    at flash.utils::Timer/tick() 
```

当我调试它时，它指向将“seekingBullet”添加到舞台的代码行。任何解决此问题的帮助都将受到欢迎。

```
package 
{
    import flash.display.*;
    import flash.events.*;
    import flash.utils.Timer;

    public class Shooter_Enemy extends MovieClip
    {
        private var yMove:int = 2;
        private var shootTimer:Timer = new Timer(500);

        public function Shooter_Enemy()
        {
            this.name = "mc_shooter_enemy";
            this.addEventListener(Event.ENTER_FRAME,enemyMove);

            shootTimer.start();
            shootTimer.addEventListener(TimerEvent.TIMER,shotHandler);
        }

        public function addShooterEnemy(X:int):void
        {
            this.x = X;
            this.y = 0;
        }
        public function removeEnemy()
        {
            shootTimer.removeEventListener(TimerEvent.TIMER,shotHandler);
            shootTimer.stop();

            this.removeEventListener(Event.ENTER_FRAME,enemyMove);
            this.x = 0;
            this.y = (stage.height + this.height);
        }
        private function shotHandler(te:TimerEvent):void
        {
            var seekingBullet:SeekingBullet = new SeekingBullet();
            Main.seekingBulletArray.push(seekingBullet);
            stage.addChild(seekingBullet);
            seekingBullet.addSeekingBullet(this.x,this.y);
        }
        private function enemyMove(e:Event)
        {
            this.y +=  yMove;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T05:32:18.540

如果它是实际的，使用舞台的一个好习惯是听 *Event.ADDED_TO_STAGE* 然后开始你的活动，如：

```
package 
{
    import flash.display.*;
    import flash.events.*;
    import flash.utils.Timer;

    public class Shooter_Enemy extends MovieClip
    {
        private var yMove:int = 2;
        private var shootTimer:Timer = new Timer(500);

        public function Shooter_Enemy()
        {
            this.name = "mc_shooter_enemy";
            this.addEventListener(Event.ENTER_FRAME,enemyMove);

            shootTimer.addEventListener(TimerEvent.TIMER, shotHandler);
            addEventListener(Event.ADDED_TO_STAGE, addedToStageHandler);
        }

        public function addShooterEnemy(X:int):void
        {
            this.x = X;
            this.y = 0;
        }
        public function removeEnemy()
        {
            shootTimer.removeEventListener(TimerEvent.TIMER,shotHandler);
            shootTimer.stop();

            this.removeEventListener(Event.ENTER_FRAME,enemyMove);
            this.x = 0;
            this.y = (stage.height + this.height);
        }
        private function addedToStageHandler(e:Event)
        {
            shootTimer.start();
        }
        private function shotHandler(te:TimerEvent):void
        {
            var seekingBullet:SeekingBullet = new SeekingBullet();
            Main.seekingBulletArray.push(seekingBullet);
            stage.addChild(seekingBullet);
            seekingBullet.addSeekingBullet(this.x,this.y);
        }
        private function enemyMove(e:Event)
        {
            this.y +=  yMove;
        }
    }
} 
```

# information-retrieval - Lucene - 在索引中搜索一组单词

> ID：14447514
> 
> 赞同：0
> 
> 时间：2013-01-21T21:26:21.773
> 
> 标签：information-retrieval, lucene

我有一种特殊的问题（至少我认为是一个^^）。我希望我能描述我想做的事情：

我有一组术语（字符串）每个术语也有一个分数（双）。我现在想将这些术语与我的 lucene 索引中的文档进行匹配。

但我想考虑这些术语的所有可能组合。起初我的想法是简单地建造一个巨人

```
`BooleanQuery: field1:term1 OR field1:term2 .... OR field2:term1 OR field2:term2 ...` 
```

但是这个查询当然不会返回与为每个术语生成单独查询相同的结果：

```
`Query1: field1:term1 OR field2:term1 ...`
`Query2: field1:term2 OR field2:term2 ...` 
```

问题是，我的应用程序是一个 ir 应用程序，这些术语是自动生成/提取的，我不知道应该一起搜索哪些术语，还是单独搜索更好。所以我想拥有“两全其美”。

有没有办法让查询搜索我的术语列表的所有可能组合？

当然我可以做一些循环并为每个可能的组合生成一个查询，但这可能会永远运行......

希望你明白我想要什么并能帮助我:)谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:20:21.963

不太确定您想要的最终结果集是什么，但这里有几种可能性：

如果您只是希望任何搜索字段中的每个匹配项都与任一术语匹配，那么：

```
field1:term1 OR field1:term2 .... OR field2:term1 OR field2:term2 ... 
```

或者

```
field1:term1 field1:term2 .... field2:term1 field2:term2 ... 
```

完全足够了。

如果您只想要在所有可用术语上至少有一个匹配项但在任何搜索字段中的结果，那么您可以像这样构造查询：

```
+(field1:term1 field2:term1) +(field1:term2 field2:term2) ... 
```

或者，您可以将要在此处搜索的字段合并为一个可搜索的字段，使它们更容易一起搜索。不过，这是否是实现此目的的更好方法取决于您的应用程序。

* * *

至于调整您的查询以防止一个词支配您的搜索结果：

我认为调整查询的第一步是找出为什么某些术语会主导您的结果。关键是学习使用：[IndexSearcher.explain(query,doc)](http://lucene.apache.org/core/4_0_0/core/org/apache/lucene/search/IndexSearcher.html#explain%28org.apache.lucene.search.Query,%20int%29)。这将解释文档是如何评分的。Luke 提供了一个很好的界面来尝试对索引进行查询，并查看文档为什么会得到它们所做的分数。

此外，[TFIDFSimilarity](http://lucene.apache.org/core/4_0_0/core/org/apache/lucene/search/similarities/TFIDFSimilarity.html)记录了默认计算分数的 DefaultSimilarity 类的主要部分。那里的文档将有助于理解 Luke/explain(query,doc) 中显示的评分参数的某些方面。

我对这个问题的最佳猜测是，您可能会在多个领域使用相同的常用术语。这将复合该术语在其所在的每个字段中的分数，并且可以消除仅出现在一个字段中的术语的结果（但在您的情况下可能同样相关）。[在这种情况下，您可以通过使用DisjunctionMaxQuery](http://lucene.apache.org/core/4_0_0/core/org/apache/lucene/search/DisjunctionMaxQuery.html)包装搜索同一术语的多个字段来修复它。

例如：

```
BooleanQuery root = new BooleanQuery()
DisjunctionMaxQuery dismax1 = new DisjunctionMaxQuery(1.1);
dismax.add(new TermQuery(new Term("field1", "term1")));
dismax.add(new TermQuery(new Term("field2", "term1")));
//etc
root.add(dismax1, BooleanClause.occur.SHOULD);
DisjunctionMaxQuery dismax2 = new DisjunctionMaxQuery(1.1);
dismax.add(new TermQuery(new Term("field1", "term2")));
dismax.add(new TermQuery(new Term("field2", "term2")));
//etc
root.add(dismax2, BooleanClause.occur.SHOULD); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T09:46:03.010

不确定这是否会有所帮助，但您可以从所有字段中获取信息并将它们复制到另一个字段中。

我知道这是多余的，但如果磁盘空间不是问题，运行查询可能会更方便，这样你的查询就变成了

```
aggr_field:(term1 OR term2 OR term3) 
```

# bonsaijs - 如何在不解构/重构的情况下将事件数据从舞台传递到父上下文？

> ID：14447515
> 
> 赞同：1
> 
> 时间：2013-01-21T21:26:22.273
> 
> 标签：bonsaijs

考虑以下代码：

```
window.stage = bonsai.run(document.getElementById('stage'), {
  code: function() {
    var circle;
    circle = new Circle(200, 200, 50);
    circle.stroke('green', 2);
    circle.addTo(stage);
    circle.on('click', function(ev) {
      stage.sendMessage('click', ev);
    });
  },
  width: 500,
  height: 500
});

stage.on('load', function() {
  console.log('loaded');
  stage.on('message:click', function(ev) {
      console.log('click', ev);
  });
}); 
```

所以，点击圆圈会给我错误：**DATA_CLONE_ERR: DOM Exception 25**

如果我只是发送 ev.x 和 ev.y 之类的属性，它们就会很好地传递出去。我还可以在发送之前从其属性中重建对象，并且它可以正常通过。

如何在不解构-> 重构的情况下将事件对象原封不动地发送到父上下文？顺便说一句，为什么盆景会这样工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T23:57:52.623

太好了，你问我们为什么要这样分离。刚刚浏览了 BonsaiJS 文档并意识到我们没有明确说明为什么我们将渲染与执行线程分开。

BonsaiJS 代码主要在工作人员中执行（如果工作人员不可用，则回退到 iframe）并用于`postMessage`与创建工作人员的上下文进行通信。被`DATA_CLONE_ERR: DOM Exception 25`引发是因为 DOM 事件对象不能被`postMessage`. 为了解决您的问题，您可以创建一个简单的函数，该函数删除应该传递的对象的所有嵌套对象/函数：

```
window.stage = bonsai.run(document.getElementById('stage'), {
  code: function() {
    var circle;
    var makeSerializable = function(obj) {
      var ret = {}, val;
      Object.keys(obj).forEach(function(key) {
        val = obj[key];
        if (typeof val != 'object' && typeof val != 'function') {
          ret[key] = val;
        };
      });
      return ret; 
    };
    circle = new Circle(200, 200, 50);
    circle.stroke('green', 2);
    circle.addTo(stage);
    circle.on('click', function(ev) {
      stage.sendMessage('click', makeSerializable(ev));
    });
  },
  width: 500,
  height: 500
});

stage.on('load', function() {
  console.log('loaded');
  stage.on('message:click', function(ev) {
    console.log('click', ev);
  });
}); 
```

或者您可以强制 BonsaiJS 在 iF​​rame 中执行。然后你就可以访问 DOM 并且可以序列化任何对象（注意：见下文，为什么我不建议这样做）：

```
window.stage = bonsai.setup({
  runnerContext: bonsai.IframeRunnerContext
}).run({...}); 
```

将主要代码执行放到worker中的主要原因是，我们不希望任何计算阻塞渲染“线程”，这样我们可以获得更流畅的动画（如果代码在iFrame中执行，渲染+代码执行将发生在同一个线程中，并且不会像工作线程那样流畅）。在 worker 中执行 JS 代码的另一个好处是，我们不依赖 DOM，还可以获取相同的 JS 代码并在 Rhino 或 NodeJS 等不同的 JS 环境中执行它（这里有一些示例代码，你如何可以在节点上执行 BonsaiJS 并通过 SocketIO 将渲染消息发送到浏览器：[https](https://github.com/uxebu/bonsai-server) ://github.com/uxebu/bonsai-server ）。

# sql - 如果插入数据上有特殊值，则运行触发器 INSTEAD OF INSERT

> ID：14447524
> 
> 赞同：1
> 
> 时间：2013-01-21T21:27:04.613
> 
> 标签：sql, triggers, insert

**我想写一个触发器，当特殊数据要插入我的表时运行** ，例如我的税表有两列

*   1.身份证

*   2.TAXVALUE

我想当数据要插入第 2 列时。检查数据是否包含“欧元”字符串，插入取消。我的意思是做任何事情而不是插入……如果包含“欧元”，则数据不应该被插入。请帮助我...非常感谢。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:37:36.230

这应该这样做。

```
CREATE TRIGGER TrigerName ON SomeTable
INSTEAD OF INSERT
AS
BEGIN
  INSERT INTO SomeTable
  SELECT ID, TAXVALUE
  FROM INSERTED
  WHERE NOT TAXVALUE LIKE '%euro%'
END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:33:43.633

触发器将是

```
ALTER TRIGGER [dbo].[yourtableinsert] 
   ON  [dbo].[yourtable] 
   AFTER Insert
AS 
BEGIN
    delete from yourtable where id=inserted.id and  inserted.TAXVALUE like '%euro%';        
END 
```

如果 TAXVALUE 包含欧元，这将删除插入的行。

# php - 无法弄清楚为什么 php 脚本在 $.ajax 调用上失败

> ID：14447526
> 
> 赞同：4
> 
> 时间：2013-01-21T21:27:06.020
> 
> 标签：php, jquery

这是我的 jQuery 脚本：

```
$.ajax({
type: 'POST',
url: 'zipCodes.php',
data: searchZipCode,
cache: false,
success: function(response) {
    alert ('response from db search: ' + response);
},
error: function(response) {
    console.log(response);
    alert('Query failed, php script returned this response: ' + response);
}
}); 
```

上面的脚本在表单所在的html文件的head标签中。php脚本与html文件在同一个文件夹中。

这是表格：

```
<form id="frmZipCodeSearch" action="">
    <label for="txtZipCodeSearch">Enter a zip code</label>
    <input type="text" id="txtZipCodeSearch" length="10" maxlength="5" />
    <input type="submit" id="btnSubmitZipCodeSearch" />
</form> 
```

我还验证了“searchZipCode”是有价值的。

每次我运行搜索时，我都会从 ajax 调用的错误部分收到警报，上面写着

> 查询失败，php 脚本返回此响应：[object Object]

这在控制台中显示：

> 对象 {readyState: 0, setRequestHeader: function, getAllResponseHeaders: function, getResponseHeader: function, overrideMimeType: function…}

我尝试将 php 脚本剥离为一个回声。我没有在服务器上的脚本文件夹中生成任何 php 错误日志。我所做的任何改变似乎都没有给我带来不同的结果。除了一个例外：

我得到不同结果的唯一一次是当我剥离 ajax 并将 php 脚本移动到带有表单的文件并执行“常规”html 表单 POST 方法时。那行得通。但是当 php 是不同的文件时，我不**认为**路径是错误的，因为我在控制台中没有得到“找不到文件”。

我到底在这里想念什么？

**[附加信息]** 为了响应 hek2mgl 的回答，我在错误响应中添加了 xhr 并在控制台中获得了更多信息：

```
Uncaught ReferenceError: xhr is not defined     zipCodeSearch.html:57
    $.ajax.error                                zipCodeSearch.html:57
    l                                           jquery-1.8.3.min.js:2
    c.fireWith                                  jquery-1.8.3.min.js:2
    T                                           jquery-1.8.3.min.js:2
    r                                           jquery-1.8.3.min.js:2 
```

我正在使用的所有其他 jQuery 工作正常，但这是我自己第一次使用 v1.8.3。

**[Answer - credit hek2mgl]** 正如 hek2mgl 在我们疯狂的长时间讨论中解释的那样，我提交了两次表单，因为 ajax 调用是在表单按钮的单击事件中。

对此的解决方法是将 ajax 调用从 click 事件中移出到它自己的函数中，在我的客户端验证之后，调用 ajax 函数并添加“return false;” 在函数调用之后。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T21:30:22.433

$.ajax 错误回调定义如下：

> 类型：函数（jqXHR jqXHR，字符串 textStatus，字符串 errorThrown ）

您已经转储了整个 jqXHR 对象。与成功函数不同，响应文本本身不是错误回调的参数。要检索响应文本（如果有），请使用：

```
error: function(xhr) {
    var response = xhr.responseText;
    console.log(response);
    var statusMessage = xhr.status + ' ' + xhr.statusText;
    var message  = 'Query failed, php script returned this status: ';
    var message = message + statusMessage + ' response: ' + response;
    alert(message);
} 
```

# grails - 为什么 Grails 一直要求我“升级”到较低的插件版本？

> ID：14447528
> 
> 赞同：2
> 
> 时间：2013-01-21T21:27:10.570
> 
> 标签：grails, plugins, dependencies

我正在尝试使用 Resources 1.2.RC3，但每次编译或尝试运行时都会收到以下提示。我运行了一个依赖报告，它正确地报告了 1.2.RC3 已经为那些请求 1.1.6 或更高版本的东西驱逐了 1.1.6。这与RC版本有关吗？有什么办法可以让它停止询问吗？

> 您当前已经安装了一个版本的插件 [resources-1.2.RC3]。是否要更新到 [resources-1.1.6]？[y,n]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T21:30:49.433

> 有什么办法可以让它停止询问吗？

找出哪个插件请求 1.1.6 并排除 BuildConfig 中的传递依赖。

```
plugins {
  compile(':some-plugin:1.2.3') {
    excludes 'resources'
  }
} 
```

我遇到了同样的问题，不能依靠通常的驱逐逻辑来避免降级提示，唯一可靠的选择是显式排除。如果有问题的插件是使用已弃用的`install-plugin`脚本安装的，那么您必须删除添加的行`application.properties`并添加正确的 BuildConfig 依赖项（使用`excludes`）。

# ios - 将 PNG 转换为 GIF - Alpha 通道已损坏

> ID：14447529
> 
> 赞同：1
> 
> 时间：2013-01-21T21:27:19.960
> 
> 标签：ios, objective-c, png, gif, javax.imageio

我有一个 PNG，我正在使用 Objective-c（使用 ImageIO 框架）将其转换为 GIF，但是我的 Alpha 通道被奇怪地转换了。

例如，我有一个红色正方形，正方形顶部有一个光滑的半透明覆盖层，使其看起来像某种斜面。我将图像保存为 PNG，然后在 Objective-c 中尝试将其转换为 GIF。当它被转换时，存在半透明光泽的整个部分变为纯白色（或 UIView 在 UIImage 后面的任何颜色。）

我猜我没有正确设置我的PNG图像的字典值......那么可能的值是什么：

kCGImagePropertyPNGInterlaceType

或者

kCGImagePropertyPNGsRGBIntent

这是我将 gif 转换为动画 gif 然后将其复制到剪贴板的代码（它有效，它只是丢失了我的一些 png 上的 alpha 通道）

```
NSString *path = [[NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject] stringByAppendingPathComponent:@"animated.gif"];
    CGImageDestinationRef destination = CGImageDestinationCreateWithURL((CFURLRef)[NSURL fileURLWithPath:path],
                                                                        kUTTypeGIF,
                                                                        16,
                                                                        NULL);

    NSMutableDictionary *dict = [NSMutableDictionary dictionaryWithCapacity:5];
    //[dict setObject:(NSString *) ??? forKey:(NSString *)kCGImagePropertyPNGInterlaceType];
    //[dict setObject:(NSString *) ??? forKey:(NSString *)kCGImagePropertyPNGsRGBIntent];

    NSDictionary *frameProperties = [ NSDictionary dictionaryWithObject: dict
                                                                 forKey: (NSString*) kCGImagePropertyPNGDictionary ];

    NSMutableDictionary *dict2 = [NSMutableDictionary dictionaryWithCapacity:5];

    const uint8_t colorTable2[ 9 ] = { 0, 0, 0, 128, 128, 128, 255,255,255};
    NSData* colorTableData2 = [ NSData dataWithBytes: colorTable2 length: 9 ];

    [dict2 setObject:colorTableData2 forKey:(NSString *)kCGImagePropertyGIFImageColorMap];
    [dict2 setObject:[NSNumber numberWithInt:0] forKey:(NSString *)kCGImagePropertyGIFLoopCount];
    [dict2 setObject:[NSNumber numberWithFloat:0.005] forKey:(NSString *)kCGImagePropertyGIFDelayTime];

    NSDictionary *gifProperties = [ NSDictionary dictionaryWithObject: dict2
                                                                 forKey: (NSString*) kCGImagePropertyGIFDictionary ];

    CGImageDestinationAddImage(destination, image1.image.CGImage, (CFDictionaryRef)frameProperties);
    CGImageDestinationAddImage(destination, image2.image.CGImage, (CFDictionaryRef)frameProperties);
    CGImageDestinationAddImage(destination, image3.image.CGImage, (CFDictionaryRef)frameProperties);
    CGImageDestinationAddImage(destination, image4.image.CGImage, (CFDictionaryRef)frameProperties);
    CGImageDestinationAddImage(destination, image5.image.CGImage, (CFDictionaryRef)frameProperties);
    CGImageDestinationAddImage(destination, image6.image.CGImage, (CFDictionaryRef)frameProperties);
    CGImageDestinationAddImage(destination, image7.image.CGImage, (CFDictionaryRef)frameProperties);
    CGImageDestinationAddImage(destination, image8.image.CGImage, (CFDictionaryRef)frameProperties);
    CGImageDestinationAddImage(destination, image9.image.CGImage, (CFDictionaryRef)frameProperties);
    CGImageDestinationAddImage(destination, image10.image.CGImage, (CFDictionaryRef)frameProperties);
    CGImageDestinationAddImage(destination, image11.image.CGImage, (CFDictionaryRef)frameProperties);
    CGImageDestinationAddImage(destination, image12.image.CGImage, (CFDictionaryRef)frameProperties);
    CGImageDestinationAddImage(destination, image13.image.CGImage, (CFDictionaryRef)frameProperties);
    CGImageDestinationAddImage(destination, image14.image.CGImage, (CFDictionaryRef)frameProperties);
    CGImageDestinationAddImage(destination, image15.image.CGImage, (CFDictionaryRef)frameProperties);
    CGImageDestinationAddImage(destination, image16.image.CGImage, (CFDictionaryRef)frameProperties);

    CGImageDestinationSetProperties(destination, (CFDictionaryRef)gifProperties);
    CGImageDestinationFinalize(destination);
    CFRelease(destination);

    NSData *gifData = [[NSData alloc] initWithContentsOfFile:path];

    UIPasteboard *pasteboard = [UIPasteboard generalPasteboard];

    [pasteboard setData:gifData forPasteboardType:@"com.compuserve.gif"];

    [gifData release]; 
```

# html - 使用 CSS 显示不同的项目名称

> ID：14447531
> 
> 赞同：1
> 
> 时间：2013-01-21T21:27:40.370
> 
> 标签：html, css, list

我无法控制它托管在另一台服务器上的 html。如果我想用css来修改一些列表项，我该怎么做呢？

例如

服务器端html：

```
<ol>
<li>Coffee</li>
<li>Milk</li>
<li>Orange Juice</li>
<li>Chocolate Milk</li>
<li>Espresso with hot foamy milk</li>
<li>Espresso diluted with hot water</li>
</ol> 
```

我想使用 css 将最后两项显示为“Cappuccino”和“Americano”。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:35:01.703

实际上可以通过使用`:after`伪类来渲染它。但它真的很丑。仅当您没有其他选择时才这样做：

```
ol li:nth-child(5){
    color: #fff;           /* same color as the background to hide it */
    position:relative;
}    
ol li:nth-child(5):after{
    content: "Capuccino";
    display: block;
    color: #000;          /* your text color */
    position:absolute;
    top:0;
    left:0;
} 
```

[jsfiddle](http://jsfiddle.net/25Jw5/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T21:30:36.330

您不能通过 CSS 更改 HTML 标记的内容。

您可以希望通过 JavaScript 这样做，即使那样，您也需要从 DOM 中选择匹配的元素，并替换它们的`innerHTML`属性。

* * *

但是用 CSS 是不可能的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T21:30:30.210

我能想到的唯一黑客是使用该属性：

```
{display:none} 
```

手动为每个标签。

# android - 考虑 DST 计算确切的 UTC 偏移量？

> ID：14447534
> 
> 赞同：0
> 
> 时间：2013-01-21T21:28:03.427
> 
> 标签：android, timezone, utc, dst

上`Android`，似乎没有API可以轻松获取本地时间。通过网络挖掘，我找到了一些代码来计算`UTC`使用类的时间偏移量`TimeZone`：

```
final long timestamp = System.currentTimeMillis();
int offset = TimeZone.getDefault().getOffset(timestamp);
if (TimeZone.getDefault().inDaylightTime(Calendar.getInstance().getTime())) {
    offset = offset - TimeZone.getDefault().getDSTSavings();
} 
```

现在，这段代码几乎是我所需要的，但很快就会发现公式是错误的。例如`CET`，偏移量变为 3600000，但`CEST`它会是 0 - 这是错误的（应该是 7200000）。

显然，我可以修补代码以使用加法而不是减法，但我不确定这是否安全，因为原作者明确表示需要减法（我认为它是为了`PST`）。

**如何让我的公式适用于所有时区？**

# java - Maxmind 数据库文件对于 AppEngine 应用程序来说太大

> ID：14447536
> 
> 赞同：0
> 
> 时间：2013-01-21T21:28:14.063
> 
> 标签：java, google-app-engine, maxmind

我正在尝试将 MaxMind geoIP 数据库部署为部署在 Google AppEngine 中的 Java 应用程序的一部分。当我们使用免费版本时一切正常，但在升级到付费（和更大）数据库时，尝试部署会出现错误：

```
File /tmp/appcfg4412552511405829763.tmp/WEB-INF/GeoIPCity.dat is too large (limit 32000000 bytes) 
```

据我所知，我启用了 jar 拆分，但这无济于事，因为这不是 jar（将其重命名为 .jar 也不会神奇地修复它:)。有什么方法可以将这么大（~48mb）的文件部署为 AppEngine 应用程序的一部分？

我的后备计划是将文件推送到 Cloud Storage 并从那里获取。不幸的是，Maxmind 的 Java 代码真的*很*想要一个文件——不是流，不是阅读器，不是字节[]，而是文件——这在 AppEngine 中很难获得。在我最终重写一堆东西之前，我想我会看看是否有人已经设法解决了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:06:02.937

在 GAE 上，[最大应用程序文件大小为 32Mb](https://developers.google.com/appengine/docs/java/runtime#Quotas_and_Limits)。

AFAIK 你无法解决这个问题。如果您可以将其拆分为较小的文件，那将是最好的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T08:44:38.567

当您在 appengine 请求标头中免费获取地理位置、国家、地区和城市时，为什么要使用 3rd 方 geoip 数据库文件来获取此信息？

我的建议是为此目的分别使用 x-appengine-geopoint、-country、-region 和 -city 标头。

这应该可行，但需要您在请求级别捕获 thor 标头并将其与其他用户数据一起存储在数据存储中。

# ruby-on-rails - 在heroku上删除以前的迁移

> ID：14447538
> 
> 赞同：0
> 
> 时间：2013-01-21T21:28:23.363
> 
> 标签：ruby-on-rails, heroku, migration, web-deployment

我有一个 Ruby on Rails 应用程序。我改变了我的数据库，我想把它部署到heroku。

如何删除 heroku 上以前的迁移并迁移我的新数据库设计？

我使用此代码进行测试：`heroku run db:migrate`，但是当我想从我的新数据库设计中创建一个对象时，我收到了这个错误：`We're sorry, but something went wrong`

但是，当我刷新页面时，它就创建了！它有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:30:08.507

你确定这是你的数据库？尝试`heroku logs -t`再次运行并运行请求。然后检查您的日志并发布您的结果。它甚至可能不是数据库问题。

擦除数据库运行

```
heroku pg:reset --db SHARED_DATABASE_URL 
```

或者

```
heroku pg:reset --db SHARED_DATABASE 
```

然后运行

```
heroku run rake db:migrate 
```

如果您的所有迁移都是正确的，那么您应该不会遇到同样的问题。

# java - 如何在 Twitter Finagle 中禁用缓存？

> ID：14447539
> 
> 赞同：1
> 
> 时间：2013-01-21T21:28:28.763
> 
> 标签：java, twitter, netty, finagle

当对同一个端点进行多次调用时，Twitter Finagle 库似乎使用了缓存。通常这会很好，但它不利于自动化测试。有缓存吗，可以关掉吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T23:00:24.397

Finagle 没有这样的缓存...

# android - 在 sdcard 上写入时出现 IllegalArgumentException

> ID：14447541
> 
> 赞同：0
> 
> 时间：2013-01-21T21:28:30.587
> 
> 标签：android

我看到这个问题已经遇到很多次了，但奇怪的是我找不到解决方案。

我正在尝试将二进制文件写入 SD 卡。这是源代码：

```
private void saveDataLongs() {
    try
    {
        ObjectOutputStream oos = new ObjectOutputStream(ctx.openFileOutput(Environment.getExternalStorageDirectory().getAbsolutePath()+"/longs.bin", ctx.MODE_WORLD_WRITEABLE));
        for (int w=0; w<longCount; w++)
            oos.writeLong(longs[w]);
        oos.close();
    }
    catch(IOException e)
    { e.printStackTrace(); }
} 
```

清单包含

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/> 
```

我收到这个错误：

```
 01-21 22:19:57.323: E/AndroidRuntime(13713): java.lang.RuntimeException: Unable to start activity ComponentInfo{it.ccc.ccc/it.ccc.ccc.Ccc}: java.lang.IllegalArgumentException: File /sdcard/longs.bin contains a path separator 
```

从其他帖子中，我可以理解某些功能仅用于在应用程序的私有存储中写入，因此他们不希望管理目录和路径。有人能帮助我吗？我应该使用不同的方法将数据写入 sd，还是在执行之前进行一些其他操作？我正在尝试向 sdcard 写入一个简单的二进制文件（顺便说一句，它是一个预先计算的数字序列，我需要将它传递给我的 PC，然后将其移回资产，所以，如果有不同的方法来获取这个目标，反正没问题）。

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:34:14.747

您说您正在尝试写入外部存储，但您正在调用`openFileOutput()`，这是用于内部存储的。

改变：

```
new ObjectOutputStream(ctx.openFileOutput(Environment.getExternalStorageDirectory().getAbsolutePath()+"/longs.bin", ctx.MODE_WORLD_WRITEABLE)); 
```

至：

```
new ObjectOutputStream(new FileOutputStream(new File(Environment.getExternalStorageDirectory(), "longs.bin"))); 
```

或者，更好的是：

```
new ObjectOutputStream(new FileOutputStream(new File(ctx.getExternalFilesDir(null), "longs.bin"))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:04:08.243

我喜欢 CommonsWare 的回答。我只想补充一点，如果您确实想走一条路，请不要使用`/`. 使用`File.separator`. 我认为我在简单使用`/`但仍然没有出现任何错误时出现过。
因此，如果您在 sdcard 的目录中创建了一个名为“To-dos”的子文件夹，您将执行以下操作：
`new ObjectOutputStream(new File(Environment.getExternalStorageDirectory() + File.separator + "To-dos", "longs.bin"));`

# amazon-ec2 - ec2不同账户之间的入站流量

> ID：14447542
> 
> 赞同：0
> 
> 时间：2013-01-21T21:28:37.297
> 
> 标签：amazon-ec2

我正在 EC2 上部署我的 Web 应用程序。我的应用使用第三方 REST API。第三方托管在 US-EAST-1 上。如果我也在那里托管我的应用程序，通信是否仍算作无需付费的入站流量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:34:46.917

如果您通过公共 DNS（即公共 IP 或公共主机名）连接到第三方 REST API，它将被视为出站流量。如果外部服务发回数据，它将计入您的入站流量 - 这纯粹是因为它通过公共互联网（通过 DNS）进行通信。

如果您想降低*您自己的服务器*之间的成本，请将您的 EC2 实例移动到 VPC 并让它们通过私有 IP 地址相互通信。据我所知，私人交通是免费的。但是您只能在一个 VPC 中拥有相同可用区的实例。有关详细信息，请参阅[亚马逊的定价模型](http://aws.amazon.com/ec2/)：

> **可用区数据传输**每 GB 0.00 美元 – 使用私有 IP 地址在同一可用区中的实例之间传输的所有数据。
> 
> **区域数据传输**每 GB 0.01 美元 – 在同一区域的不同可用区中的实例之间传输的所有数据。

# spring - 带有 Jsp 的泽西岛

> ID：14447546
> 
> 赞同：0
> 
> 时间：2013-01-21T21:28:56.077
> 
> 标签：spring, jsp, jersey

这是我的 web.xml

```
 <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/beans-web.xml</param-value>
    </context-param>
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
    <listener>
        <listener-class>org.springframework.web.context.request.RequestContextListener</listener-class>
    </listener>
    <servlet>
        <servlet-name>Jersey Spring Web Application</servlet-name>
        <servlet-class>com.sun.jersey.spi.spring.container.servlet.SpringServlet</servlet-class>
        <init-param>
            <param-name>com.sun.jersey.spi.container.ContainerRequestFilters</param-name>
            <param-value>com.sun.jersey.api.container.filter.LoggingFilter</param-value>
        </init-param>
        <init-param>
            <param-name>com.sun.jersey.spi.container.ContainerResponseFilters</param-name>
            <param-value>com.sun.jersey.api.container.filter.LoggingFilter</param-value>
        </init-param>
        <init-param>
            <param-name>com.sun.jersey.api.json.POJOMappingFeature</param-name>
            <param-value>true</param-value>
        </init-param>
        <init-param>
            <param-name>com.sun.jersey.config.property.JSPTemplatesBasePath</param-name>
            <param-value>/WEB-INF/jsp</param-value>
        </init-param>
        <init-param>
            <param-name>com.sun.jersey.config.feature.Redirect</param-name>
            <param-value>true</param-value>
        </init-param>
        <init-param>
            <param-name>com.sun.jersey.config.feature.ImplicitViewables</param-name>
            <param-value>true</param-value>
        </init-param>
        <init-param>
            <param-name>com.sun.jersey.config.property.WebPageContentRegex</param-name>
            <param-value>/(images|css)/.*</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>Jersey Spring Web Application</servlet-name>
        <url-pattern>/*</url-pattern>
    </servlet-mapping>
</web-app> 
```

请求`GET http://localhost:8082/so/`

如果我不将根上下文指定为 /v1/* 我得到以下异常

```
2 > GET http://localhost:8082/so/
2 > Host: localhost:8082
2 > User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/534.53.11 (KHTML, like Gecko) Version/5.1.3 Safari/534.53.10 
```

并再次在内部重定向到

```
3 > GET http://localhost:8082/so/WEB-INF/jsp/index.jsp
3 > Host: localhost:8082
3 > User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/534.53.11 (KHTML, like Gecko) Version/5.1.3 Safari/534.53.10 
```

并且失败信息：

```
3 * Server out-bound response
3 < 404

INFO: 2 * Server out-bound response
2 < 200
2 < Content-Type: text/html 
```

如果我将根上下文放入 /v1/* 工作正常..

我错过了什么吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T05:19:34.837

See the accepted answer here [Spring, Jersey and Viewable JSP Integration](https://stackoverflow.com/questions/4559893/spring-jersey-and-viewable-jsp-integration). You have to use the SpringServlet as a filter instead of a servlet in the web.xml.

# directx - 检索用于创建 ID2D1RenderTarget 的 IDXGISurface

> ID：14447549
> 
> 赞同：2
> 
> 时间：2013-01-21T21:29:11.943
> 
> 标签：directx, direct2d

假设一个渲染目标是通过`ID2D1Factory::CreateDxgiSurfaceRenderTarget`.

然后渲染目标被传递给我的函数。我只有目标而不是 IDXGISurface。

有没有办法`IDXGISurface`从目标访问？QueryInterface 不检索它。

DirectX 10。Windows 7。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T14:04:21.360

不幸的是，这不可用。渲染目标和 DXGI 表面是不同的对象，因此`QueryInterface`将不起作用。在内部，渲染目标持有一个指向底层 DXGI 表面的指针。

这在 Direct2D 1.1 (DirectX 11.1) 中更加明确和易于管理，您可以将 DXGI 表面包装在 Direct2D 位图 ( `CreateBitmapFromDxgiSurface`) 中，然后将其设置为`SetTarget`Direct2D 1.1 渲染目标 () 的目标 ( `ID2D1DeviceContext`)。然后，您可以向目标询问位图 ( `GetTarget`) 并询问位图以获取底层 DXGI 表面 ( `ID2D1Bitmap1::GetSurface`)。

# php - 当构造函数的参数不可用时 PHP 依赖注入

> ID：14447550
> 
> 赞同：8
> 
> 时间：2013-01-21T21:29:26.887
> 
> 标签：php, mongodb, dependency-injection

我们刚刚开始齐心协力在我们的项目中统一使用依赖注入，我遇到了一个问题。

我正在编写一个类来处理我们的 MongoDB 查询。我将 MongoClient 作为对构造函数的依赖项传入，没有问题。但是，当实例化对象所需的变量在实例化时不可用时，我该如何处理依赖关系？

特别是，我们有一个 MongoCollection 方法的包装器 findOne，如果您传入一个字符串，当前（在旧代码中）将该字符串转换为带有“new MongoId($_id)”的 MongoId，并将其用于查找功能。

根据我对依赖注入的了解，拥有“new MongoId”是个坏主意，而且我已经知道，为将字符串转换为 MongoId 的函数编写测试用例会变得更加困难。

但是，当 MongoId 类在构造函数上获取 id 字符串时，我该如何处理注入呢？

我认为唯一可行的方法是在类构造函数上传递一个闭包，该闭包执行以下操作：

```
$getMongoId = function( $id ){
    return new MongoId( $id );
}; 
```

和

```
class MyMongo
{
   function __construct( MongoClient $client, Closure $mongoIdGetter){...}
} 
```

[编辑以修复最后一部分]

但这是正确的处理方式吗？当然，如果我们使用 DiC，我们可以做到，但是要求构造函数的闭包似乎有点多。我对注入我的依赖关系太教条了吗？我想我可以通过在新类中使用“new MongoId($_id)”来轻松解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:14:02.830

您可以使用工厂代替闭包：

```
class MongoFactory
{
    public function createMongoDb($id)
    {
        return new MongoId($id);
    }
} 
```

在工厂中，拥有“新事物”硬编码依赖项被认为是可以的，因为创建对象是它们的唯一目的，您可以轻松地将它们替换为另一个工厂。

`MyMongo`你`MongoFactory`的消费者类（

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:48:27.113

> 但是，当实例化对象所需的变量在实例化时不可用时，我该如何处理依赖关系？

在您有机会自己处理之前，PHP 将出现致命错误。如果您使用类型参数和/或未将它们定义为，默认情况下，`null`当该参数未传递给任何函数时，PHP 将出现致命错误。

> 根据我对依赖注入的了解，使用“new MongoId”是个坏主意，而且我已经知道，为将字符串转换为 MongoId 的函数编写测试用例会变得更加困难。

它会（在 PHPUnit 中）吗？

```
$this->assertInstanceOf('\MongoId', $getMongoId($id_string)); 
```

> 但是，当 MongoId 类在构造函数上获取 id 字符串时，我该如何处理注入呢？

不知道你的意思是什么，但你应该只测试`MongoId`s 处理的结果。

你问题的最后一点让我有点松懈，我认为这是因为它不是真正的 PHP（即`$__construct`）。

我不确定你为什么需要像这样将函数推入类中。我的意思是我最多的时候是：

```
function findById($id){
    if(!$id instanceof \MongoId) $id = new MongoId($id);
    return $this->getCollection()->findOne($id);
} 
```

你不需要更多的东西，你不需要测试构造函数，`MongoId`因为它已经过单元测试，你应该对你的公共 API 而不是其他人的公共 API 进行单元测试。

# posix - 查看是否在 sh 脚本中定义函数的符合 POSIX 标准的方法

> ID：14447555
> 
> 赞同：3
> 
> 时间：2013-01-21T21:29:41.317
> 
> 标签：posix, sh

我正在寻找正确的方法来查看是否定义了函数。一种符合 POSIX 标准的方式。

```
__function_defined() {
    FUNC_NAME=$1
    d=$(declare -f $FUNCNAME)

    if [ "${DISTRO_NAME_L}" = "centos" ]; then
        if typeset -f $FUNC_NAME &>/dev/null ; then
            echo " * INFO: Found function $FUNC_NAME"
            return 0
        fi

    # Try POSIXLY_CORRECT or not
    elif test -n "${POSIXLY_CORRECT+yes}"; then
        if typeset -f ${FUNC_NAME} >/dev/null 2>&1 ; then
            echo " * INFO: Found function $FUNC_NAME"
            return 0
        fi
    else
        # Arch linux seems to fall here
        if $( type ${FUNC_NAME}  >/dev/null 2>&1 ) ; then
            echo " * INFO: Found function $FUNC_NAME"
            return 0
        fi
    echo " * INFO: $FUNC_NAME not found...."
    return 1
} 
```

根据 debian 的[checkbashisms](http://sourceforge.net/projects/checkbaskisms/)脚本，以上所有内容都被视为 bash'isms。

尝试 grep 脚本也不行。例如：

```
 if [ "$(grep $FUNC_NAME $(dirname $0)/$(basename $0))x" != "x" ]; then
        # This is really ugly and counter producing but it was, so far, the
        # only way we could have a POSIX compliant method to find if a function
        # is defined within this script.
        echo " * INFO: Found function $FUNC_NAME"
        return 0
    fi 
```

不起作用，因为脚本也应该像这样工作：

```
wget --no-check-certificate -O - http://URL_TO_SCRIPT | sudo sh 
```

那么，什么是正确的、符合 POSIX 标准的方法呢？

请纯 sh，不要 bash，不要 ksh，不要其他 shell，只需纯 sh。哦，而且实际上也没有尝试运行该功能:)

可能吗？

## **我找到了一个符合 POSIX 的解决方案：**

```
if [ "$(command -v $FUNC_NAME)x" != "x" ]; then
    echo " * INFO: Found function $FUNC_NAME"
    return 0
fi 
```

现在的问题**是，有更好的解决方案**吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:30:49.653

## 我找到了一种符合 POSIX 的方式

```
if [ "$(command -v $FUNC_NAME)x" != "x" ]; then
    echo " * INFO: Found function $FUNC_NAME"
    return 0
fi 
```

现在的问题**是，有更好的解决方案**吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-09-02T20:05:39.970

这个答案不是 POSIX，因此不会与公认的答案竞争，但是当您只需要特定外壳的东西时，它可以是 FWIW/TDIL。

在`zsh`你可以做到`test "$(whence -w name)" = 'name: function'`。

在`bash`你可以做到`test "$(type -t name)" = 'function'`。

额外详情`bash`：

```
function fn () {
  echo 'my function'
}

if test "$(type -t fn)" = 'function'; then
  echo 'fn is a function'
else
  echo 'fn is not a function'
fi

if test "$(type -t missing-fn)" = 'function'; then
  echo 'missing-fn is a function'
else
  echo 'missing-fn is not a function'
fi 
```

`help`您可以通过输入提示符，然后输入`help type`和来了解有关 bash bultins 的更多信息`help test`。

`type -t name`还可以判断是否`name`是各种事物，包括内置函数、文件或演示的函数。

如果您只关心变量或函数是否存在，您可以使用：

```
if test -v name; then
  echo "name is present: $name"
else
  echo "name is missing"
fi 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-09-02T21:48:50.597

以下是 POSIX 兼容的，应该可以在任何地方工作：

```
checkfunc() {
   case "$(type "$1" 2>/dev/null | head -n1)" in
   *" function"|*" function from zsh") return 0; ;;
   esac
   return 1
}
# Tested with:
# My shell is bash
script="$(declare -f checkfunc)"'
if checkfunc checkfunc; then :; else echo $0:error:not function; exit 1; fi
if checkfunc ls; then echo $0:error:executable; exit 1; fi
if checkfunc type; then echo $0:error:builtin; exit 1; fi
if checkfunc does-not-exists; then echo $0:error:not-exists; exit 1; fi
'
docker run --rm bash bash -c "$script"
docker run --rm alpine ash -c "$script"
docker run --rm ubuntu dash -c "$script"
docker run --rm alpine ash -c 'apk add mksh >/dev/null && mksh -c "$1"' - "$script"
docker run --rm alpine ash -c 'apk add zsh >/dev/null && zsh -c "$1"' - "$script" 
```

如果我可以说，我会说我也可以拥有 SVR4 的源代码并进行了修补`ksh`，因此它可以与当前的 GCC 编译并在那里进行测试，并且`type`可以在`<xxx> is a function`那里输出，就像`ash`.

`zsh`碰巧输出`<func> is a shell function from zsh`，所以我决定`from zsh`专门处理。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-11-10T02:57:01.077

虽然我能理解您为什么会这样想，但从另一个位置动态拉取您的脚本对于在运行它之前按您喜欢的方式解析（或“grepping”）它并没有很大的障碍。这样的事情可以通过多种方式完成，但是，据我所知，它们都需要一个基本的文件描述符来完成功能上的操作。

Bash 及其同类通过重定向的子壳命令为我们提供了透明文件描述符的便利，这些命令允许各种管道灵活性，如下所示：

```
eval "$(wget --no-check-certificate -O - ${_URL} | tee \
    >(read func; echo '_FUNC='"$(grep -Eo '^[^ |^#]*()' <(echo "${func}"))") \
    | sudo sh)" 
```

但是，正如已经提到的，POSIX 并未指定此类语法设备，因此您必须找到另一种方法。此外，虽然它可能更短，但这可能会有点令人困惑。可能有更好的方法可以做到这一点，但我想它们至少需要 2 或 3 个子外壳级别。（不过，以其他方式显示肯定会很酷。）

然而，POSIX 确实指定的是非常有用的`heredoc`. 在`heredoc`可声明的 POSIX 变量语法类型中很少见，不仅因为它可以整齐地跨越多行而不会出现转义错误，或者因为它允许通过简单地引用它的终止符来干净地定义 shell 替换，但最重要的是因为它描述了一个文件类型句柄。的这种质量`heredoc`经常被忽视，也许是因为 Bash 和 co 已经在很大程度上消除了它的重要性一段时间，但每次我们遵守以`heredoc`“文件结尾”首字母缩略词结尾的约定时，我们都应该提醒它`EOF`。

为了拉入脚本文件，以编程方式对其进行修改，然后使用 shell 解释器执行它，您将需要一个文件描述符。当然，您可以读写`/tmp/`以允许这样做，但我通常会尽量避免这种情况，因为它只是感觉草率。如果必须，你甚至可以重写自己，但这可能不是最好的习惯。但是，如果您发现这样做的真正原因，最安全的方法可能是在脚本开头的函数中定义重写代码，并且只在最后调用它，这样您就可以确保整个文件已完全加载进入记忆。像这样的东西：

```
_rewrite_me() {printf %s "${1}" > ${0} && exec ${0}} 
#SHELL CODE
#MORE 
_NEW_ME="$(printf %s "${_MORE_SHELL_CODE}" | cat <${0})"
rewrite_me ${_NEW_ME} 
```

尽管如此，我还是最喜欢`heredoc`最好的，我认为这是本案中缺失的拼图。以下是使用`heredoc`.

```
#!/bin/sh
_URL='http://URL/TO/SCRIPT'

_SCRIPT="$(wget --no-check-certificate -O - ${_URL} |\
    grep -Ev '^#!')" 

_FUNC="$(sed -n 's:^\([^ |^#|^=]*\)().*{.*$:\1:p' <<_EOF_)"
${_SCRIPT}
_EOF_
echo "${_FUNC}"

sh <<_EOF_
${_SCRIPT}
_EOF_ 
```

# python - python map 中的副作用（python“do”块）

> ID：14447560
> 
> 赞同：6
> 
> 时间：2013-01-21T21:30:07.510
> 
> 标签：python, python-3.x

告诉某人“我想将其应用于`func`每个元素`iterable`的副作用”的首选方式是什么？

```
# Option 1... clear, but two lines.
for element in iterable:
    func(element)

# Option 2... even more lines, but could be clearer.
def walk_for_side_effects(iterable):
    for element in iterable:
        pass

walk_for_side_effects(map(func, iterable))  # Assuming Python3's map.

# Option 3... builds up a list, but this how I see everyone doing it.
[func(element) for element in iterable] 
```

我喜欢选项 2；标准库中是否有已经等效的函数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T21:36:10.390

避免聪明的诱惑。使用选项 1，其意图清晰明确；您正在将该函数`func()`应用于迭代中的每个元素。

选项 2 只是让每个人都感到困惑，寻找应该做什么（这确实让我感到困惑，直到我意识到你需要在 Python 3`walk_for_side_effects`中迭代）。`map()`

`func()`当您从 实际获得结果时，应该使用选项 3 ，而*不是*因为副作用。打击任何这样做只是为了副作用的人。列表推导应该用于生成列表，而不是做其他事情。相反，您使理解和维护代码变得更加困难（并且为所有返回值构建列表会更慢启动）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T21:44:10.093

这已被多次询问，例如，[here](https://stackoverflow.com/questions/5766816/applying-a-method-with-no-return-value-to-each-element-of-a-list)和[here](https://stackoverflow.com/questions/1080026/is-there-a-map-without-result-in-python)。但这是一个有趣的问题。列表推导旨在用于其他用途。

其他选项包括

1.  使用`map()`- 与您的样品基本相同
2.  使用`filter()`- 如果你的函数返回 None，你将得到一个空列表
3.  只是一个普通的`for`循环

而普通循环是最好的方法。在这种情况下，在语义上是正确的，所有其他方式，包括列表理解，滥用概念的副作用。

在 Python 3.x 中，`map()`并且`filter()`是生成器，因此在迭代它们之前什么都不做。因此，我们需要例如 a `list(map(...))`，这会使情况变得更糟。

# facebook-like - 喜欢按钮“发布到 Facebook”未提交

> ID：14447562
> 
> 赞同：0
> 
> 时间：2013-01-21T21:30:13.470
> 
> 标签：facebook-like, facebook-social-plugins

我在我管理的几个网站上看到了一些复杂的、未记录的行为，其中包含“赞”按钮。

这里有两个例子：

> [http://action.anthonybrown.com/secondterm/thanks/](http://action.anthonybrown.com/secondterm/thanks/)
> 
> [http://handsoffwomenshealth.com/thanks/](http://handsoffwomenshealth.com/thanks/)

在这两种情况下，这些都是注册表单“谢谢”页面，其预期目的是“喜欢”实际的主登录页面。

在这两种情况下，用户都可以单击“赞”按钮，而“赞”实际上会被注册回 Facebook。

在这两种情况下，允许用户发布评论/状态的弹出“弹出窗口”都会正确显示。但是，当您填写评论并单击“发布到 Facebook”时，什么也没有发生。您的评论不会发布到 Facebook，对话框也不会消失。

此处对错误报告的评论：

> 见评论 1

...表明这是预期的行为，当类似按钮生成的链接受到 Facebook 的“保护”并在 facebook.com 中的用户单击时以“请小心”插页式显示时。

当我自己使用点赞按钮时，我的两个页面的活动帖子中的链接确实会通过这种“保护”机制：

> 见评论 2

需要明确的是，我实际上并不确定未能发表评论是否与“请小心”警告有关，但它似乎确实相关。

Google、Facebook 和 Stack Exchange 搜索都表明这个问题相当普遍，但对它发生的原因以及如何缓解它提供了几乎零的洞察力。

任何理解/解决问题的帮助将不胜感激。

# json - 所有超级碗冠军

> ID：14447563
> 
> 赞同：1
> 
> 时间：2013-01-21T21:30:15.997
> 
> 标签：json, freebase, mql

我正在努力获得超级碗的所有冠军。
我使用[查询编辑器](http://www.freebase.com/queryeditor/)并编写了以下代码：

```
[{
  id: "/en/super_bowl"
  "/sports/sports_championship_event/champion" : [{}]
}]​ 
```

但我得到的一切都是这样的：

```
{
  "code":          "/api/status/ok",
  "result": [{
    "/sports/sports_championship_event/champion": [],
    "id":            "/en/super_bowl"
  }],
  "status":        "200 OK",
  "transaction_id": "cache;cache02.p01.sjc1:8201;2013-01-21T20:27:29Z;0064"
} 
```

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T00:05:55.743

如果您转到[/en/super_bowl](http://dev.freebase.com/en/super_bowl)的主题页面，您会看到超级碗是一项[体育联赛冠军赛](http://dev.freebase.com/sports/sports_championship?schema)，由各个[体育联赛冠军赛](http://dev.freebase.com/sports/sports_championship_event?schema)（例如[超级碗 XLVI](http://dev.freebase.com/m/043t_rh)）组成。

当您需要查询的是 Freebase 中每个超级碗冠军赛的冠军时，您的查询是询问超级碗的所有冠军。该查询如下所示：

```
{
  "id": "/en/super_bowl",
  "/sports/sports_championship/events": [{
    "/sports/sports_championship_event/champion": [{}]
  }]
}​ 
```

您可以调整此查询以获得获胜团队和年份，如下所示：

```
{
  "id": "/en/super_bowl",
  "/sports/sports_championship/events": [{
    "name": null,
    "season": {
      "/time/event/start_date": null
    },
    "/sports/sports_championship_event/champion": [{
      "id":   null,
      "name": null
    }]
  }]
}​ 
```

去尼纳斯！

# javascript - 淘汰赛：如何设置选项为 javascript 对象的选择框的值？

> ID：14447565
> 
> 赞同：1
> 
> 时间：2013-01-21T21:30:18.013
> 
> 标签：javascript, knockout.js

我有一个`select`使用绑定绑定到复杂 javascript 对象列表的元素`options`：

```
<select data-bind="options: availableCountries, optionsText: 'countryName', value: selectedCountry, optionsCaption: 'Choose...'"></select> 
```

其中 availableCountries 是一个可观察的 javascript 对象数组。[你可以在这个 fiddle](http://jsfiddle.net/7csj5/1/)中看到完整的例子。

现在，当我在列表中选择一个项目时，这可以正常工作。但是，如果我需要从应用程序的其他部分更新值，则只有在使用与 availableCountries 数组中完全相同的 Country 对象时才能执行此操作。这也已在这个[相关问题](https://stackoverflow.com/questions/11638609/manually-set-default-values-for-a-select-box-using-knockout-on-complex-objects)中建立，但不幸的是它并没有解决我的问题。

在[options binding](http://knockoutjs.com/documentation/options-binding.html)的文档中，他们预料到了这个问题，并说我应该使用`optionsValue`绑定：

> 通常，您只想使用 optionsValue 来确保 KO 在更新可用选项集时可以正确保留选择。例如，如果您通过 Ajax 调用反复获取“汽车”对象列表并希望确保保留所选汽车，您可能需要将 optionsValue 设置为“carId”或每个“汽车”对象具有的任何唯一标识符, 否则 KO 不一定知道之前的“汽车”对象中的哪些对应于新对象中的哪些。

但不幸的是，这不起作用，因为它也会影响值绑定 - 如果我设置`optionsValue`为`'countryName'`，`selectedCountry`将只包含国家/地区的名称而不是整个对象。

我正在寻找一种方法来结合这些。我仍然希望 value 是整个对象，但我希望选项值比较使用我指定的特定属性。基本上，是这样的：

```
<select data-bind="options: availableCountries, optionsText: 'countryName', optionsComparator: 'countryName', value: selectedCountry, optionsCaption: 'Choose...'"></select> 
```

但是，据我所知，这涉及修改`value`绑定。我还有其他选择吗？我可以用其他方式解决这个问题吗？扩展器？自定义绑定处理程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:52:29.033

我已经制作了一个修复此问题的选定绑定，请检查我的绑定集合

Demo，下拉菜单在页面末尾 [http://jsfiddle.net/H8xWY/8/](http://jsfiddle.net/H8xWY/8/)

[https://github.com/AndersMalmgren/Knockout.Bindings](https://github.com/AndersMalmgren/Knockout.Bindings)

代码

```
ko.bindingHandlers.selected = {
    init: function (element, valueAccessor, allBindingsAccessor) {
        var selected = valueAccessor();
        var items = ko.utils.unwrapObservable(allBindingsAccessor().options);
        var key = allBindingsAccessor().optionsKey ? allBindingsAccessor().optionsKey : allBindingsAccessor().optionsText;

        var observable = ko.computed({
            read: function () {
                var value = ko.utils.unwrapObservable(selected);
                return ko.utils.arrayFirst(items, function (item) {
                    return value != null ? ko.utils.unwrapObservable(item[key]) == ko.utils.unwrapObservable(value[key]) : false;
                });
            },
            write: function (value) {
                writeValueToProperty(selected, allBindingsAccessor, "selected", value);
            }
        });

        ko.applyBindingsToNode(element, { value: observable });
    }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-18T18:22:49.410

我通过将 getCountryByPop 方法附加到我的 availableCountries 数组，然后调用它来设置 observable 的值，解决了类似的问题：

```
availableCountries.getCountryByPop = function(pop) {
    var ret;
    this().forEach(function(country) {
        if (country.countryPopulation == pop) {
            ret = country;
        }
    });
    return ret;
};

...

viewModel.selectedCountry(availableCountries.getCountryByPop(9)); 
```

[jsfiddle.net/6BaP5/](http://jsfiddle.net/6BaP5/)

# delphi - 如何获取打印机驱动程序的 COLLATE 设置？

> ID：14447568
> 
> 赞同：3
> 
> 时间：2013-01-21T21:30:24.547
> 
> 标签：delphi, printing, delphi-xe2, quickreports

我需要捕获 Windows 机器已设置的打印机驱动程序设置，以确定它们是否已为特定打印机打开分页。

我知道如何使用传入 DC_COLLATE 的 DeviceCapabilities 调用来获取打印机是否*可以进行校对，但这并不能告诉我打印驱动程序是否设置为校对，只是打印机具有校对能力，而不是它**会*校对。

为什么？

我正在尝试使用 Delphi XE2 解决 QuickReports 中的一个问题，我们的程序不再像在 Delphi 6 下编译时那样工作。对于 Delphi 6 版本，无论 QuickReport 的设置如何，它总是遵守打印机驱动程序中的整理设置. 对于 Delphi XE2 版本，它不会。

用户没有安全性来更改分页设置，系统管理员强制他们启用，并且这些文档需要在指定的打印机上打印分页。

如果我可以确定驱动程序是否设置为始终进行整理，我可以强制在 QuickReport 中进行整理设置，它会执行我需要的操作，从而解决我上面的问题。

一如既往，我很欣赏任何想法。

干杯!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T22:08:40.723

您需要使用 Windows API 函数[`OpenPrinter`](http://msdn.microsoft.com/en-us/library/dd162751%28v=vs.85%29.aspx)和[`GetPrinter`](http://msdn.microsoft.com/en-us/library/dd144911%28VS.85%29.aspx). 调用时`GetPrinter`，传递一条[`PRINTER_INFO_2`](http://msdn.microsoft.com/en-us/library/dd162845%28v=vs.85%29.aspx)记录，该记录将返回，`pDevMode`成员设置为a [`DEVMODE`](http://msdn.microsoft.com/en-us/library/dd183565%28v=vs.85%29.aspx)；该`DEVMODE`记录包含是否启用排序规则的标志（除其他外）。

这是 TeamB 的 Peter 下面的旧 Borland NG 帖子。它演示了更新打印机设置以使其永久化，但它包括使用`OpenPrinter`、`GetPrinter`、`ClosePrinter`和`PRINTER_INFO_2`，以及使用`DEVMODE`（在下面的代码中引用`hDevMode`）；它应该让你开始。

```
Procedure MakePrintersettingsPermanent;
var
  hPrinter: THandle;
  Device : array[0..255] of char;
  Driver : array[0..255] of char;
  Port   : array[0..255] of char;
  hDeviceMode: THandle;
  pDevMode: PDeviceMode;
  bytesNeeded: Cardinal;
  pPI: PPrinterInfo2;
  Defaults: TPrinterDefaults;
  retval: BOOL;
begin
  Assert( Printer.PrinterIndex >= 0 );
  Printer.GetPrinter(Device, Driver, Port, hDeviceMode);
  FillChar( Defaults, Sizeof(Defaults), 0 );
  Defaults.DesiredAccess:= 
    PRINTER_ACCESS_ADMINISTER or PRINTER_ACCESS_USE;
  if not WinSpool.OpenPrinter(@Device, hPrinter, @Defaults ) then
        RaiseLastWin32Error;
  try
    retval := WinSpool.GetPrinter(
      hPrinter,
      2,
      Nil, 0, @bytesNeeded );
    GetMem( pPI, bytesNeeded );
    try
      retval := WinSpool.GetPrinter(
        hPrinter, 2,
        pPI, bytesNeeded, @bytesNeeded );
      If not retval Then 
        RaiseLastWin32Error;

      pDevMode := GlobalLock( hDeviceMode );
      Assert( Assigned( pdevmode ));
      try
        Move( pdevmode^, pPI^.pDevMode^, Sizeof( pdevmode^ ));
      finally
        GlobalUnlock( hDevicemode );
      end;
      If not WinSpool.SetPrinter(
        hPrinter, 2,
        pPI,
        0 )
      Then
        RaiseLastWin32error;
    finally
      FreeMem( pPI );
    end;
  finally
    WinSpool.ClosePrinter( hPrinter );
  end;
end; 
```

# ruby-on-rails-3 - Rails如何将belongs_to添加到gem文件

> ID：14447569
> 
> 赞同：0
> 
> 时间：2013-01-21T21:30:27.697
> 
> 标签：ruby-on-rails-3, activerecord, gem, belongs-to

这对我来说很难解释，但我需要将`belongs_to`属性添加到 gem 的模型中。

我正在使用[`APN_on_rails`](https://github.com/timsu/apn_on_rails)gem 向我的 Web 应用程序添加推送通知功能。在这个 gem 中，它创建了一个`model`被调用的`Device`( `APN::Device`)，它有一些需要它工作的字段。

我现在需要将`Device`模型链接到我自己的`User`模型。我已成功将 a 迁移`user_id`到数据库表。

现在唯一的问题是添加`belongs_to`到模型中。它不在 die`/app/models/`目录中。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T03:14:18.563

它是 Ruby，因此您可以重新打开该类并添加更多内容。

在您的模型目录中创建一个`device.rb`文件，然后添加适当的文件，就`belongs_to`好像您自己创建了整个模型一样。只要你不重新定义任何重要的方法而不调用`super`它，就会用你需要的东西来补充他们的模型。您可能还需要添加`attr_accessible`或`attr_protected`能够使用它，具体取决于他们定义模型的方式。

我希望这会有所帮助。

# erlang - 将文件整个平面文本文件读取到数组

> ID：14447575
> 
> 赞同：0
> 
> 时间：2013-01-21T21:30:40.657
> 
> 标签：erlang

我正在使用 erlang 编写一个 escript，并且我已经看到了许多带有文件 io 的示例，但并不那么容易理解，所以我发现了这个：

```
Text = file:read_file("f.txt"),
io:format("~n", Text). 
```

以某种方式工作，它确实打印文件内容，然后出现多个错误

```
in call from erl_eval:do_apply/6 (erl_eval.erl, line 572)
in call from escript:eval_exprs/5 (escript.erl, line 850)
in call from erl_eval:local_func/5 (erl_eval.erl, line 470)
in call from escript:interpret/4 (escript.erl, line 768)
in call from escript:start/1 (escript.erl, line 277)
in call from init:start_it/1 (init.erl, line 1050)
in call from init:start_em/1 (init.erl, line 1030) 
```

那么读取整个文件并将内容存储在数组或列表中以供以后使用的最简单方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:48:20.087

首先，file:read_file/1 将在成功时返回 {ok, Binary}，其中 Binary 是表示文件内容的二进制文件。出错时，返回 {error, Reason}。因此，您的 Text 变量实际上是一个元组。简单的修复（如果出现错误则崩溃）：

```
{ok, Text} = file:read_file("f.txt") 
```

接下来，io:format/2 的第一个参数是格式字符串。~n 是一种表示“换行符”的格式，但您没有给它一个表示其他任何含义的格式，因此它不期望 Text 作为参数。此外，格式字符串的所有参数都应该在作为第二个参数传递的列表中。~s 表示字符串，所以：

```
io:format("~s~n", [Text]) 
```

将打印出整个文件，然后是换行符。如果你想传递多个参数，它看起来像：

```
io:format("The number ~B and the string ~s~n", [100, "hello"]) 
```

注意 io:format/2 只有两个参数；一个恰好是一个包含多个条目的列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T15:23:52.367

由于您的问题要求一种将文件内容读入数据结构的简单方法，因此您可能会喜欢 file:consult/1。此解决方案**假定**您可以控制文件的格式，因为 Consult/1 期望文件包含以“.”结尾的行。它返回 {ok, [terms()]} | {错误，原因}。

因此，如果您的文件 t.txt 包含以“.”结尾的行 如下：

```
'this is an atom'.
{person, "john", "smith"}.
[1,2,3]. 
```

那么你可以利用 file:consult/1

```
1> file:consult("c:\t.txt").
2> {ok,['this is an atom',{person,"john","smith"},[1,2,3]]} 
```

# neo4j - AttributeError：“TraversalDescription”对象没有属性“评估者”

> ID：14447576
> 
> 赞同：1
> 
> 时间：2013-01-21T21:30:41.380
> 
> 标签：neo4j

我试图遍历一个图使用

```
from neo4jrestclient.client import GraphDatabase
G = GraphDatabase("http://localhost:7474/db/data/")
# G is generated here in my program but for space purpose I removed these steps
traverser = G.traversal().evaluator(my_evaluator).traverse(root) 
```

我从stackoverflow借了my_evaluator函数，它是

```
def my_evaluator(path):
    # Filter on end node property
    if path.end['value'] == 105:
        return Evaluation.INCLUDE_AND_CONTINUE
    # Filter on last relationship type
    if path.last_relationship.type.name() == 'edge':
        return Evaluation.INCLUDE_AND_PRUNE
    # You can do even more complex things here, like subtraversals.
    return Evaluation.EXCLUDE_AND_CONTINUE 
```

当我尝试执行代码时，我收到以下错误消息： Traceback（最近一次调用最后一次）：文件“C:\Users\firas\Desktop\ACO_neo4j.py”，第 747 行，在 traverser = G.traversal() 中。 evaluator(my_evaluator).traverse(root) AttributeError: 'TraversalDescription' 对象没有属性 'evaluator'

你能帮我吗？谢谢。

菲拉斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T18:01:05.190

您始终可以使用 Cypher 查询来相同。

这里的问题是该`evaluator`功能可能是 Neo4j 家伙从本机驱动程序中借用的，嵌入式 Python 驱动程序。到目前为止，使用`neo4-rest-client`遍历来遍历图有一些限制。因为在它下面使用的是 REST 接口，所以编写评估器的唯一方法是编写一个 Javascript 函数，AFAIK。

# scroll - 修复了滚动时以 2 倍滚动速度垂直移动的 div

> ID：14447580
> 
> 赞同：2
> 
> 时间：2013-01-21T21:30:53.807
> 
> 标签：scroll, fixed

我想`div`在滚动时以更快的速度向下移动（即，如果用户向下滚动 200 像素，`div`则将平滑地向下滚动 400 像素。）
基本上是一个固定`div`的，以滚动速度的 2 倍（可能更小）的速率上下移动

我已经搜索了很多答案，但没有运气，所以我希望你们中的一个聪明人可以帮助我。

如果您需要我更具体，我可以制作视频或插图来阐明我正在尝试做的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:43:37.587

您正在寻找*视差滚动*效果。有很多 js 库可以做到这一点，其中之一是：[Stellar.js](http://markdalgleish.com/projects/stellar.js/)

耐克还做了一个临时网站（[Better World](http://www.youtube.com/watch?v=kmGDwm5-a80)），起到了这种作用。

# ruby - 电子表格 gem 中的 Ruby 跳过标头

> ID：14447583
> 
> 赞同：2
> 
> 时间：2013-01-21T21:31:06.287
> 
> 标签：ruby, spreadsheet, xls

我正在尝试从 Excel XLS 电子表格中导入一些数据。

我以前只使用过 CSV 文件，并且知道如何跳过它们的第一行，这是一个标题。

如何处理 XLS 文件？

我有这个代码：

```
require 'spreadsheet'
ook = Spreadsheet.open("/#{Rails.public_path}/uploads_prices/"+name)
book.worksheets.each do |sheet|
      sheet.each do |row|
***** 
```

如何跳过第一个条目，即标题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T21:52:12.297

从[文档](http://spreadsheet.rubyforge.org/GUIDE_txt.html)：“（...）你可以告诉工作表应该在开头省略多少行。以下从第 3 行开始，无论它或前面的行是否包含任何数据：”

```
sheet2.each 2 do |row|
  # do something interesting with a row
end 
```

因此，对于这种情况，以下应该有效：

```
book.worksheets.each do |sheet|
  sheet.each 1 do |row|
    #... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:39:10.180

尝试：

```
book.worksheets.each do |sheet|
  sheet[1..-1].each do |row|
    ... 
```

使用将迭代`[1..-1]`的数组或可枚举切片`sheet.each`，跳过第一个值`[0]`，返回所有其余值。

# java - Android如何命名图像以保存在/camera中？

> ID：14447584
> 
> 赞同：0
> 
> 时间：2013-01-21T21:31:07.790
> 
> 标签：java, android, file, camera

我建立了一个相机应用程序。我的问题是我想继续默认相机应用程序使用的逻辑命名。

EG：相机应用程序生成文件，例如：

```
IMG_20130104_033852
IMG_20130104_033853 
```

如果这些是我的 /camera 文件夹的唯一内容，理论上我应该命名我的照片`IMG_20130104_033854`。我应该寻找具有“最大”名称的图像并添加一个数字，还是有更好的解决方案来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:27:59.853

我建议建立名称，直到您到达最后一个数字序列，然后您可以查找最大的数字，如果您愿意，可以添加一个。

因此，例如，根据今天的日期，您可以构建`IMG_20130121_`零件。你可以这样做`File [] fList = f.listFiles();`，`f`指向`/camera/`目录的位置。从那里，您可以通过执行`fileName.startsWith("IMG_20130121_")`IF 语句来检查文件。
从那里，做一个子字符串来抓取最后一个下划线 (_) 之后的字符串数字，转换为整数，然后循环直到完成所有整数的比较。

我为文件夹名称做了这个。独立的 cd 刻录设备会创建以 开头`ezb_`，后跟数字的文件夹。如果这些信息还不够，我明天可以粘贴我的循环代码。

作为旁注，如果您要在 之后开始自己的命名算法`IMG_20130121_`，例如添加 s 或其他内容，您仍然必须跟踪或查找最大的数字。你也可以像我试图解释的那样实现一些东西。让我知道是否需要澄清！

# android - 有没有办法在新的 Google Maps Android API v2 中的 MapView 对象中准备好 GoogleMap 时收到通知？

> ID：14447596
> 
> 赞同：0
> 
> 时间：2013-01-21T21:32:08.410
> 
> 标签：android, google-maps-android-api-2

我现在在我的应用程序中实现了新的 Google Maps Android API，当地图加载时我想做一些事情，例如将地图移动到当前位置并在那里显示一个标记并启用某些叠加层，如卫星视图。但是，当我尝试访问 Mapview 的 getMap() 时遇到了 NPE，因为 GoogleMap 对象还没有准备好。

有没有办法检测 MapView 的 GoogleMap 何时准备就绪？我发现 CommonsWare 建议处理 SupportMapFragment 并检测 getMap() 何时不会为空，但 M​​apView 的等效事件是什么？

CommonsWare 对 SupportMapFragment 的建议：[在使用 SupportMapFragment 时，我如何知道地图已准备好使用？](https://stackoverflow.com/questions/14047257/how-do-i-know-the-map-is-ready-to-get-used-when-using-the-supportmapfragment/14047363#14047363)

这似乎有点坏了，没有办法确定 GoogleMap 对象何时准备就绪，以便我们可以进行所有这些设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:57:51.010

要直接使用 MapView，您需要确保将 Activity 生命周期方法转发到 MapView。

例如，要设置它，您可以在 onCreate() 中执行此操作

```
 @Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.raw_mapview_demo);

    mMapView = (MapView) findViewById(R.id.map);
    mMapView.onCreate(savedInstanceState);

    setUpMapIfNeeded();
}

private void setUpMapIfNeeded() {
    if (mMap == null) {
        mMap = ((MapView) findViewById(R.id.map)).getMap();
        if (mMap != null) {
            setUpMap();
        }
    }
} 
```

该代码取自 Play Services 库中包含的 Google 示例代码。您还需要路由 onDestroy()、onResume() 和 onPause()。

仅供参考，您需要检查 MapView 和 MapFragment 的空指针，因为用户可能没有安装 Google Play 服务。如果未安装，用户应该会收到安装 APK 的提示，然后您可以返回此活动。

希望有帮助。

瑞安

# php - 跨表的MYSQL更新不起作用

> ID：14447601
> 
> 赞同：0
> 
> 时间：2013-01-21T21:32:40.927
> 
> 标签：php, mysql, sql, pdo

我试图用来自另一个表列的数据填充一个表的一列中的所有行，并使用产品代码将它们全部结合起来。

所以`aatest.stock`要更新`products_attributes.attributes_part_number`

这就是我所拥有的：

```
$dbh = new PDO('mysql:host=localhost;dbname='. 
           DB_DATABASE, DB_SERVER_USERNAME, DB_SERVER_PASSWORD);

$dbh->exec('UPDATE products_attributes 
        SET aatest.code = products_attributes.attributes_part_number 
        WHERE products_attributes.attributes_stock = aatest.stock');

    ?> 
```

任何关于为什么这不起作用的建议将不胜感激。

我正在运行 MySQL 5.5

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:38:26.790

您的语句“不起作用”的原因是因为它是无效的 MySQL 语法。

[http://dev.mysql.com/doc/refman/5.5/en/update.html](http://dev.mysql.com/doc/refman/5.5/en/update.html)

像这样的东西应该可以得到你想要的结果，将表中的列设置为`code`从表列中`aatest`检索到的值`products_attributes`：

```
UPDATE aatest
  JOIN products_attributes 
    ON aatest.stock = products_attributes.attributes_stock
   SET aatest.code = products_attributes.attributes_part_number 
```

如果要避免使用 JOIN 关键字，可以改用逗号运算符，并将连接谓词从 ON 子句移至 WHERE 子句：

```
UPDATE aatest
     , products_attributes 
   SET aatest.code = products_attributes.attributes_part_number
 WHERE aatest.stock = products_attributes.attributes_stock 
```

（但连接语法的逗号风格是老派，我们喜欢这种`JOIN ... ON`风格。）

我得到这样一个语句的方法是从一个 SELECT 语句开始，如下所示：

```
SELECT *
  FROM aatest
  JOIN products_attributes 
    ON aatest.stock = products_attributes.attributes_stock 
```

（如果是很多列，当然，我会指定感兴趣的列。）

SELECT 让我看看将要更新哪些行、`code`列的当前值（来自 aatest）以及将分配的新值。

一旦我得到这个工作，我可以用`SELECT * FROM`' `UPDATE`'关键字替换' '，然后添加一个`SET`指定要更新的列的子句。

```
 SET aatest.code = expr 
```

（关于更新语法的奇怪之处在于`SET`子句需要出现在`WHERE`子句之前。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:35:27.820

您需要在 UPDATE 语句中添加两个表之间的连接。

像这样的东西：

```
UPDATE aatest
       JOIN products_attributes on products_attributes.attributes_stock = aatest.stock
        SET aatest.code = products_attributes.attributes_part_number 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T22:07:22.690

感谢大家的所有投入，这真的很有帮助。最后正确的代码是这样的：

```
$dbh->exec('UPDATE products_attributes, aatest 
            SET products_attributes.attributes_stock = aatest.stock 
            WHERE products_attributes.attributes_part_number = aatest.code'); 
```

但是，我在拔掉头发几个小时后发现的问题是我在 MYSQL 中创建的表与我试图与之交换数据的表有不同的编码（默认设置）。嗬！

希望这可以帮助另一个崭露头角的程序员，就像我一样，这是他自己最大的敌人：D

再次感谢所有输入。你们所有人试图帮助的速度之快让我不知所措。对我来说这是第一次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T21:45:09.023

尝试：

```
UPDATE products_attributes, aatest 
    SET aatest.code = products_attributes.attributes_part_number 
        WHERE products_attributes.attributes_stock = aatest.stock 
```

# xamarin.ios - 使用 Mono Droid 和 Mono Touch 上的 OAuth 使用 Facebook 和 Google 帐户对用户进行身份验证的库

> ID：14447602
> 
> 赞同：2
> 
> 时间：2013-01-21T21:32:42.467
> 
> 标签：xamarin.ios, oauth-2.0, xamarin.android

我对 Mono Droid 和 Mono TOuch 很陌生，但我想知道是否有任何库允许我使用他们的 Facebook 和 Google 帐户对我的应用程序用户进行身份验证？

我在 "Mono for Android" 和 "Mono Touch" 上看到了一些 Facebook SDK 的例子，但是因为我不需要完整的 facebook SDK，我只需要用户提供的一小部分信息，我想知道是否有是一个简单的库，它允许我使用 OAuth 对任何站点进行身份验证（我现在只对 Google 和 Facebook 感兴趣）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T07:33:55.310

[您是否尝试过OAuth 站点](http://oauth.net/code/)的基于社区的实施？

关于 Facebook API 绑定：我尝试了 MonoTouch 的 Facebook API 绑定，但没有成功。之后我开始使用官方的基于 JSON 的[Facebook Graph API](http://developers.facebook.com/docs/reference/api/)。实现任何 API 方法的调用都相对容易。有关在 MonoTouch/MonoDroid 应用程序中使用 Facebook API 的更多信息，请参阅[该答案](https://stackoverflow.com/questions/13597807/logout-not-working-propperly-in-monotouch-bindings-facebook-sample/13605682#13605682)。

# java - GAE 后端实例调用和 Spring 集成

> ID：14447603
> 
> 赞同：0
> 
> 时间：2013-01-21T21:32:43.067
> 
> 标签：java, google-app-engine, spring-mvc, google-api

谷歌应用引擎文档说：

> 后端与您的主应用程序版本共享 web.xml 中定义的一组 servlet

我们在我们的谷歌引擎应用程序中使用 Spring Framework，因此我们在 web.xml 中仅定义 spring dispatcherServlet 我的期望是具有单独 url 的 Spring servlet 可以作为“后端实例”触发。但是我不知道如何在给定的“子域”上定义 spring servlet 的 url。

我正在尝试使用队列任务“doStuffQueue”调用后端“myBackendId”：

```
Queue queue = QueueFactory.getQueue("doStuffQueue");
TaskOptions taskOptions = TaskOptions.Builder.withUrl("/doTask/")
             .param("someParam", someParam)
             .header("Host", BackendServiceFactory.getBackendService().getBackendAddress("myBackendId"))
             .method(Method.POST);
   queue.add(taskOptions); 
```

但上面的 TaskOption 将其作为标准前端实例运行，因为子域被忽略，所以这个 url 被调用：

```
 myAppId.appspot.com/doTask 
```

作为解决方法，我尝试像这样定义 TaskOption：

```
 TaskOptions.Builder.withUrl("myBackendId.myAppId.appspot.com/doTask") 
```

但这在架构中是不允许的，因为 url 必须以**/开头**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T09:07:50.987

您的代码是正确的，我想您可能在注释定义中遇到问题。

确保您使用的是 RequestMethod.POST。另外，我相信您可能必须使用“/task/doTask”开始任务网址，例如：

@RequestMapping(value = "/task/doTask", method = { RequestMethod.POST })

# c# - 绑定没有找到参考源（MenuItem）

> ID：14447605
> 
> 赞同：4
> 
> 时间：2013-01-21T21:32:52.980
> 
> 标签：c#, wpf, xaml

我收到错误消息：

> System.Windows.Data 错误：4：找不到与引用“ElementName = gridProductViewDataGrid”绑定的源。绑定表达式：路径=选定项；数据项=空；目标元素是'MenuItem'（名称=''）；目标属性是“IsEnabled”（类型“布尔”）

在 Visual Studio 的输出窗口中，我的代码没有做它应该做的事情。

添加工作正常，因为它永远不需要被禁用，但删除没有被禁用。

```
<DataGrid AutoGenerateColumns="False" IsReadOnly="False" CanUserAddRows="False" CanUserDeleteRows="False" EnableRowVirtualization="True" ItemsSource="{Binding Items, Mode=TwoWay}" x:Name="gridViewProductDataGrid" RowDetailsVisibilityMode="VisibleWhenSelected" >
        <DataGrid.ContextMenu>
            <ContextMenu>
                <MenuItem Header="{Binding LabelStrings.AddProductLabel, Source={StaticResource ResourceWrapper}}" Click="Add_Product_MenuItem_Click"/>
                <MenuItem Header="{Binding LabelStrings.RemoveProductLabel, Source={StaticResource ResourceWrapper}}" Click="Remove_Product_MenuItem_Click" IsEnabled="{Binding ElementName=gridViewProductDataGrid, Path=SelectedItem, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource ObjectToBooleanConverter}}"/>
                </MenuItem>
            </ContextMenu>
        </DataGrid.ContextMenu> 
```

如果没有对象，则转换器只需返回 true，如果存在则返回 false。我已经尝试将此代码移入和移出网格以及以不同的顺序移动绑定的部分。当我运行代码并放入断点时，它从未进入布尔转换器的代码。为什么它在里面时看不到网格？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T21:44:09.207

ContextMenu 在不同的可视树上打开，然后是他的父级，因此命名绑定不起作用。

尝试这样的事情：

```
IsEnabled="{Binding PlacementTarget.DataContext.SelectedItem, 
                    RelativeSource={RelativeSource FindAncestor,AncestorType=ContextMenu}, 
                    Converter={StaticResource ObjectToBooleanConverter}}" 
```

它使用 ContextMenu `PlacementTarget`（即 DataGrid）来获取正确的 DataContext。

另一个选项是`NameScope`为 ContextMenu 设置。将以下行添加到您的 CodeBehind：

```
NameScope.SetNameScope(contextMenu, NameScope.GetNameScope(this)); 
```

`contextMenu`你给你的 ContextMenu 的名字在哪里

# python - 需要 Python 中的 2D 碰撞处理解决方案

> ID：14447606
> 
> 赞同：0
> 
> 时间：2013-01-21T21:33:05.867
> 
> 标签：python, 2d, collision

我在当前的台球模拟中为简单的 2D 碰撞检测和处理编写了一个程序，但是它正在寻找一个涉及适当物理的解决方案，即用于碰撞的牛顿运动定律。到目前为止我所拥有的，它不保存动量并简化物理学是

```
 def collide(ball1,ball2):
        dx = ball1.x - ball2.x
        dy = ball1.y - ball2.y

        dist = (dx)**2+(dy)**2
       if dist < (ball1.radius + ball2.radius)**2:

            tangent = atan2(dy, dx)
            angle = 0.5 * pi + tangent

            angle1 = 2*tangent - ball1.angle
            angle2 = 2*tangent - ball2.angle

            speed1 = ball2.speed*e
            speed2 = ball1.speed*e

            (ball1.angle, ball1.speed) = (angle1, speed1)
            (ball2.angle, ball2.speed) = (angle2, speed2)

            ball1.x += sin(angle)
            ball1.y -= cos(angle)
            ball2.x -= sin(angle)
            ball2.y += cos(angle) 
```

我必须进行碰撞的是，bounce() 用于撞墙

```
 running = True
    while running:
        background()

        for i,ball in enumerate(balls,1):
            ball.bounce()
            ball.move()
            for ball2 in balls[i:]:
                collide(ball,ball2)
            ball.display()

        pygame.display.flip() 
```

我对此还是很陌生，所以请更改无用/愚蠢的内容

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:36:47.250

我记得我不久前做了一个简单的台球模拟器。正如您所提到的，这是出于教育目的，我将把您从整个代码中解放出来（而且我也不必为它挖掘:)）

但基本上，我记录了自上一帧以来已经过去了多长时间。在给定每个球的速度向量的情况下，我利用这段时间找出每个球的新位置。对于帧中的碰撞，我必须确定两个球碰撞的确切时间，然后在该确切时间应用每次碰撞。伪代码看起来像：

```
while running:
  frame_time_ms = time elapsed since last frame
  collisions = all collisions that will happen during this frame, with the exact time of collision. (1)
  while collisions:
    collision = first collision in collisions
    collision_time_ms = time of collision (1)
    move all balls to collision_time_ms
    collide the two balls in the collision (2)
    collisions = all remaining collisions after the time of collision (1)
  move all balls to the end time of the frame 
```

因此，您需要带回您的几何和物理知识，以找出关键公式：

1.  给定一个框架（或框架的一部分）中两个球的开始和结束位置，它们是否会发生碰撞，以及它们会在哪一点发生碰撞。记得在这里也包括球的半径。这将为您提供碰撞时间。
2.  给定两个球在精确的碰撞位置，它们的新速度向量之后会是什么样子。一些提示是使用弹性碰撞，并试验它的实际弹性： [http](http://en.wikipedia.org/wiki/Elastic_collision) ://en.wikipedia.org/wiki/Elastic_collision对于奖励积分，您还可以包括球的旋转 :)

祝你好运！=)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-09T01:12:43.223

圆对圆碰撞很简单。取中心点坐标，减去它们以确定每个圆之间的距离。

然后，如果距离大于两个圆半径之和，则它们不接触。如果相等，它们就会接触，如果小于，它们就会重叠。

简单地说，如果他们正在接触，让他们互相排斥。您可以通过几种方式做到这一点。如果你跟踪他们移动的方向，让他们向相反的方向移动。

至于墙壁，只需将每个墙壁与 > < 语句一起使用。因此，如果一个圆的 pos 的 x 坐标小于西墙，则它已经通过了那堵墙。再一次，让他们击退墙壁。

Circle Collison 非常简单，但是如果您想做其他形状，这将是难以置信的困难。除非你只是在这些形状周围挖圈或使用像素完美碰撞（这是非常高的性能需求。）

如果您想要高度准确的非圆碰撞，请获取物理引擎。

# iphone - 如何以编程方式确定当前语言环境是否使用 AM/PM 或 24 小时格式的时间？

> ID：14447610
> 
> 赞同：3
> 
> 时间：2013-01-21T21:33:22.533
> 
> 标签：iphone, ios, ipad, nslocale

我有一个像 13:30 这样的 24 小时格式的时间字符串，当用户的语言环境使用 AM/PM 时，我必须将其转换为 12 小时格式的字符串。我怎样才能可靠地检测到呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T22:54:16.817

有几种方法。在这里查看我的问题[检测 iPhone 24 小时时间设置](https://stackoverflow.com/questions/12214398/detect-iphone-24-hour-time-setting) 基本上你设置一个时间并检查上午或下午的字符串

# android - 如何保存 ListView 以恢复？

> ID：14447614
> 
> 赞同：1
> 
> 时间：2013-01-21T21:33:34.437
> 
> 标签：android, listview

如何保存 ListView 并通过简历恢复它？因为当我关闭应用程序时，所有内容都会被删除。

感谢您的回答

公共类 ToDoList 扩展 Activity {

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    ListView myListView = (ListView)findViewById(R.id.todolist);
    final EditText myEditText = (EditText)findViewById(R.id.addtodo);
    final ArrayList todoItems = new ArrayList();
    final ArrayAdapter aa;
    aa = new ArrayAdapter(this,
    android.R.layout.simple_list_item_1,
    todoItems);
    myListView.setAdapter(aa);

    String edittext="";
    SharedPreferences settings = getSharedPreferences("PreferencesName", 0);
    edittext = settings.getString("Content", edittext);
    todoItems.add(0, edittext);

    myEditText.setOnKeyListener(new OnKeyListener() {
    public boolean onKey(View v, int keyCode, KeyEvent event) {
    if (event.getAction() == KeyEvent.ACTION_DOWN)
    if (keyCode == KeyEvent.KEYCODE_ENTER){
    todoItems.add(0, myEditText.getText().toString());
    aa.notifyDataSetChanged();

    String edittext= myEditText.getText().toString();
    SharedPreferences settings = getSharedPreferences("PreferencesName", 0);
    SharedPreferences.Editor editor = settings.edit();
    editor.putString("Content",  edittext);

    myEditText.setText("");
    return true;
    }
    return false;
    }
    });
    }} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:57:24.523

根据您给出的评论-关于关闭应用程序后丢失数据-您必须解决问题的选项很少。

您需要做的是存储您的数据以供进一步使用 - 您可以使用`SharedPreferences`或`SQLite database`.

## 共享首选项

对于少量数据是不错的选择。如果您尝试存储`ListView`的内容，`SharedPreferences`则很可能对您来说不是一个好选择。

此代码可用于将数据存储在您的`SharedPreferences`：

```
SharedPreferences settings = getSharedPreferences("PreferencesName", 0);
SharedPreferences.Editor editor = settings.edit();
editor.putInteger("FirstInteger", a);
editor.putInteger("SecondInteger", b);
(...) 
```

这就是您检索它的方式：

```
SharedPreferences settings = getSharedPreferences("PreferencesName", 0);
int a = settings.getInteger("FirstInteger", false);
int b = settings.getInteger("SecondInteger", false); 
```

无论如何，您可以在这里阅读更多相关信息：http: [//developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)

## 数据库

更适合大量数据。比较困难，但是如果你了解 MySQL 的基础知识，你使用它是没有问题的。有一个关于在 android 应用程序中使用 SQLite 数据库的很好的教程： [http ://www.vogella.com/articles/AndroidSQLite/article.html](http://www.vogella.com/articles/AndroidSQLite/article.html)

存储数据后，您可以访问本地存储以检索它们，重新填充适配器并重新创建`ListView`.

# c# - 2 个匹配集合到 1 个列表

> ID：14447617
> 
> 赞同：2
> 
> 时间：2013-01-21T21:33:39.240
> 
> 标签：c#, regex

大家好，我有 2 个 MatchCollection：

```
MatchCollection users_ids = Regex.Matches(result, @"url"":""(.*?)""");
MatchCollection users_names = Regex.Matches(result, @"fullname"":""(.*?)"""); 
```

2 个集合的数学数相等

我需要将所有匹配项加入 1 个列表。像这样：

```
 foreach (Match match in users_ids)
                {
                   string id = match.Groups[1].Value.ToString();
                  // string name = users_names(every match) .Groups[1].Value.ToString();
                   online_list.Add(id + "|" + name);
                } 
```

有什么解决办法吗？=\

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T21:40:57.697

这看起来像是 的完美应用`Zip`，它经过两次枚举，获取每个枚举当前索引处的项目并使用给定函数将它们映射到结果中：

```
var matches = users_ids.Cast<Match>()
    .Zip(users_names.Cast<Match>(),
    (id, name) => id.Groups[1].Value + "|" + name.Groups[1].Value); 
```

# javascript - 为什么jquery的“on”方法在赋值后立即触发其目标函数？

> ID：14447622
> 
> 赞同：2
> 
> 时间：2013-01-21T21:33:53.000
> 
> 标签：javascript, jquery, events

在单击另一个元素后，我正在尝试为单击主体分配一个功能。这是我正在使用的代码：

```
$('#myButton').click(function() {
  $('body').on('click', closePopup);
});

closePopup = function() {
    console.log('closePopup fired');
    $('body').off('click', closePopup);
}; 
```

期望的结果是仅在单击 myButton 之后才将 closePopup 分配给正文。但是当点击 myButton 时会立即触发 closePopup。为什么会这样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T21:36:17.513

发生这种情况是因为事件冒泡。一旦您的事件处理程序完成对按钮上的事件的处理，它就会冒泡到主体然后由主体处理它。为防止这种情况发生，请停止在按钮单击时传播事件。

```
$('#myButton').click(function(e) {
  e.stopPropagation();
  $('body').on('click', closePopup);
});
... 
```

但是请注意，如果您多次单击该按钮，这将导致绑定多个事件。您可以通过更多修改来修复它：

```
$('#myButton').click(function(e) {
  e.stopPropagation();
  $('body').off('click', closePopup).on('click', closePopup);
});
... 
```

# css - 修复了 div 高度阻碍的背景图像？

> ID：14447625
> 
> 赞同：0
> 
> 时间：2013-01-21T21:33:58.487
> 
> 标签：css

我通过 jquery 将背景图像加载到 DiV 中，偶尔会弹出一个模式，它会拉伸屏幕高度，以便您必须滚动。

我想让我的 bg 图像随视图滚动，但问题是这`height:100%`显然意味着原始高度的 100%。div 不会随着屏幕的其余部分拉伸。

这是为什么？这是我的代码：

```
#bgDiv {
    display: none;
    height: 100%;
    width: 100%;
    background-repeat: no-repeat;
    background-position: center center;
        background-attachment:fixed;
    top:0;
    right:0;
    position: absolute;
    z-index: -9999;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:58:38.063

如果您将位置设置为固定而不是绝对位置，它应该保持不变，即使在滚动时也是如此。

# r - 从函数内调用 summary() 不会输出任何内容

> ID：14447627
> 
> 赞同：2
> 
> 时间：2013-01-21T21:34:07.947
> 
> 标签：r

为什么没有这个功能：

```
test <- function(somebool = FALSE) {

        mydata<-read.csv("mycsvfile.csv")
        if(somebool){
                print("somebool")
                summary(mydata)
        }
        mydata
}

outdata<-test(somebool=TRUE)
print("head")
head(outdata) 
```

在函数调用中打印摘要？它确实在它之前打印“somebool”，但不打印摘要。

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-21T21:37:58.287

您正在调用该函数`summary`但不打印结果。只需将其更改为：

```
 print(summary(mydata)) 
```

# c# - 如何在 C# 中实现 SQLite

> ID：14447628
> 
> 赞同：-1
> 
> 时间：2013-01-21T21:34:09.390
> 
> 标签：c#, sql, sqlite

大家好，我的项目是关于考试的，所以我必须提出问题并存储用户完成的所有考试，我想使用 SQLite 但我想知道用户是否必须安装任何工具才能从数据库中读取？如果不是，我如何实现数据库并使用它以及我必须使用什么库？
非常感谢
PS：对我的项目的任何建议都会很有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:14:18.263

您可以使用[http://sqlite.phxsoftware.com/](http://sqlite.phxsoftware.com/)从 c# 与 SQLite 交互

SQLite 管理器是创建/查看/编辑/等数据库的好工具：[https ://addons.mozilla.org/en-us/firefox/addon/sqlite-manager/](https://addons.mozilla.org/en-us/firefox/addon/sqlite-manager/)

# ruby-on-rails - 推送到 heroku master 会减慢我的网站速度

> ID：14447629
> 
> 赞同：1
> 
> 时间：2013-01-21T21:34:14.040
> 
> 标签：ruby-on-rails, deployment, heroku

我有一个 RoR/Heroku 应用程序。现在，我的部署过程包括签入 git，然后运行“git push heroku master”。问题是，这引入了大约 10 秒的延迟，我的现场站点在恢复之前出现故障。如果他们碰巧注意到它，这会导致网站上的现有访问者感到沮丧并离开。

那么避免这种情况的最佳实践方法是什么？

```
git push heroku master 
```

我阅读了有关设置“暂存”环境的信息，但这有助于避免这种情况吗？我仍然需要运行一个 git push heroku master，不是吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:02:05.707

Heroku 有一个实验室功能，可以在将负载从旧的 dyno 转移到新的[dyno 之前预启动新的 dyno。](https://devcenter.heroku.com/articles/labs-preboot/)这样，新的测功机将在开始接收请求时启动并准备就绪，并且您的用户在您更新应用程序时不会看到任何延迟。以下是启用预启动的方法：

```
heroku labs:enable -a myapp preboot 
```

# javascript - jQuery AddClass 然后删除一个类

> ID：14447635
> 
> 赞同：20
> 
> 时间：2013-01-21T21:34:24.980
> 
> 标签：javascript, jquery

在我的 Rails 应用程序中，当用户点击 Save 按钮时，我发送一个 Ajax 请求，当它发送请求时，我可以返回一些 jQuery。

我想做的是添加一个类（保存），延迟然后删除该类。

所以，我添加了这个：

```
$('.button').addClass('saving').delay(2000).removeClass('saving'); 
```

由于某种原因，它不起作用。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-01-21T21:35:38.600

[.delay()](http://api.jquery.com/delay/)实际上是用于动画的。

使用**[setTimeout()](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)**

```
$('.button').addClass('saving');

setTimeout(function () { 
    $('.button').removeClass('saving');
}, 2000); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-21T21:41:33.430

`delay`仅适用于与动画相关的方法，您可以使用`queue`方法：

```
$('.button').addClass('saving').delay(2000).queue(function( next ){
    $(this).removeClass('saving'); 
    next();
}); 
```

[http://jsfiddle.net/Rp6Xw/44/](http://jsfiddle.net/Rp6Xw/44/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-05-16T12:17:33.010

如果有人需要多个类的添加/删除，.dequeue(); 也需要正常运行。

```
$('.button').addClass('saving').delay(2000).queue(function(){
   $(this).removeClass('saving'); 
   $(this).dequeue();
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T21:37:45.760

试试这个也许：

```
$('.button').addClass('saving').delay(2000, function() {
    $(this).removeClass('saving')
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-03-26T06:06:51.383

最短的方式。

```
$(".button").addClass("saving").show(0).delay(2000).removeClass("saving"); 
```

# java - 泳池什么时候换？

> ID：14447637
> 
> 赞同：18
> 
> 时间：2013-01-21T21:34:36.613
> 
> 标签：java, string, pool

我有两个问题：

```
public static void main(String[] args) {
  String s1 = "bla";
  String s2 = "b" +"l" + "a";
  String s3 = "b".concat("l").concat("a");

  if(s1 == s2) 
        System.out.println("Equal");
  else
        System.out.println("Not equal");
  if(s1 == s3) 
        System.out.println("Equal");
  else
        System.out.println("Not equal");
} 
```

*   为什么`s1`and`s2`指向同一个对象，而`s1`and`s3`不指向同一个对象？（*没有使用`new`关键字*）。

*   如果我从用户那里得到一个字符串并将这些行添加到上面的代码中：

    ```
    BufferedReader in=new BufferedReader(new InputStreamReader(System.in));
    String name=in.readLine();
    if(name.equals("test"))
        s1 = s1 + "xyz"; 
    ```

    如果用户输入`xyz`程序就会打印`Not equal`，当用户输入另一个东西时程序会输出`Equal`。这是否意味着池会随着整个程序的执行而改变？优化器是否在编译时工作并*继续在`runtime`*?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-21T21:38:16.180

> 为什么 s1 和 s2 指向同一个对象，而 s1 和 s3 却没有？（没有使用 new 关键字）。

因为连接发生在编译时，因此完成的字符串进入常量池，与第一个示例相同。这是编译器“已知”的特殊情况。这实际上意味着长字符串，以这种方式连接多行，仍然可以获得与简单字符串常量相同的性能改进的好处。

在第二个示例中，您在运行时执行计算，因此它不会成为常量池的一部分。

但是请注意，在 JLS 中，字符串常量池中可以和不可以进入的细节故意保持模糊，因此不同的实现可能会以不同的方式进行优化。它指定了关于*必须*进入的内容的某些规则，但不要依赖此行为在实现之间保持一致。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-21T21:37:27.373

> 为什么 s1 和 s2 指向同一个对象，而 s1 和 s3 却没有？（没有使用 new 关键字）。

由于`String`在 Java 中是`Immutable`，所以字符串类的任何方法都会返回一个新的 String 对象（虽然有一些例外 - 一个是`substring`方法）。因此`concat`，方法创建了一个新字符串，该字符串进入*Heap*，并且不添加到常量池中。

就`s1`and`s2`而言，这两个字符串在*编译*时都是已知的，因此它们是相同的字符串文字。

请注意，第二个字符串中的*连接操作*：-

```
String s2 = "b" +"l" + "a"; 
```

在编译时进行评估，结果与第一个字符串相同，并且向常量池添加一个条目。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-22T05:33:56.837

有时（当编译器很明显 String 的值在运行时是什么时）编译器使用字符串池，在其他情况下则不使用。

**实际上，您的代码不应取决于使用或不使用池的事实。**

您不能总是运行 main，因此如果您想查看是否使用了池中的 String，您可以使用**javap**反编译代码，清单相对不言自明。

# python - python whoosh IndexingError中断时

> ID：14447641
> 
> 赞同：1
> 
> 时间：2013-01-21T21:34:47.127
> 
> 标签：python, whoosh

在我中断了 whoosh 提交过程后出现了这个奇怪的错误。当我现在尝试提交时，我得到了

```
 File "/usr/local/lib/python2.7/dist-packages/whoosh/filedb/filewriting.py", line 179, in     _check_state
    raise IndexingError("This writer is closed")
whoosh.writing.IndexingError: This writer is closed 
```

我试图重新安装lib，更改索引目录，但它不起作用。那么我该如何修复嗖嗖声？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:52:53.933

我认为没有必要“修复嗖嗖”（或索引）。

可能只是您的代码打开了一个编写器，可能使用它，关闭它，然后再次尝试使用关闭的编写器。

总是这样做：

```
with myindex.writer() as w:
    w.add_document(title=u"First document", content=u"Hello there.")
    w.add_document(title=u"Second document", content=u"This is easy!") 
```

如果您以后需要添加更多文档（在这个“with”块之外），以同样的方式打开一个新的作家......

注意：编写器 w 在离开 with 块时会自动关闭，这就是所谓的上下文管理器的工作方式。

# entity-framework - EF 查询包含不正确的元素

> ID：14447643
> 
> 赞同：0
> 
> 时间：2013-01-21T21:34:50.200
> 
> 标签：entity-framework

我有一个 EF 查询，如下所示：

`var x = _db.qMetaDataLookups.ToList();`

如果我直接在 SQL 服务器上执行，`SELECT * FROM qMetaDataLookup`将返回 2155 个不同的行。执行上述操作后，x ALSO 包含 2155 个元素。

问题是数据有误。我从 EF 获取的数据与从 SQL 查询获取的数据不同。

特别是，SQL 输出中存在一个特定元素，称为“WXYZ”，它在 EF 版本的查询中根本没有出现（针对完全相同的数据库）。

相反，我发现很多重复。如果我`x.Distinct()`将列表过滤器从 2155 个元素减少到仅 143 个。

我很困惑。我从未见过我的 EF 和 SQL 结果在如此简单的查询上有所不同。必须有一个非常简单的 [face-palm] 解释，但我错过了它。

谢谢。

**编辑** qMetaDataLookup（视图）包含有关我们数据库的信息。本质上，它是所有表和视图的列表，以及它们的每一列，以及有关数据类型、长度、精度、比例等的其他信息。该表中的“键”应该是与“tableName”匹配的列。 columnName”，而是 EF 为其选择了所有数据类型属性。这就是查询无法按预期执行的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:31:42.987

确保为实体数据模型中的 qMetaDataLookup 正确设置实体键。有时实体键搞砸了......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-13T22:37:10.650

问题可能是您的模型使用具有重复值的键，而实体框架期望唯一值。例如，如果您的数据模型使用由其他表中的外键组成的复合主键，就会发生这种情况。似乎 EF 不太喜欢复合主键，因此查询返回的结果将生成看似重复的行。

修复似乎是在您的表中添加一个代理主键列，该列保证是唯一的。如果您仍然需要引用外部列，那很好，只要它们不被用作表的复合主键。

我不能为解决方案申请任何功劳，但这里是帮助我解决问题的链接：http: [//jepsonsblog.blogspot.ca/2011/11/enitity-framework-duplicate-rows-in.html](http://jepsonsblog.blogspot.ca/2011/11/enitity-framework-duplicate-rows-in.html)

# javascript - 如何让 js 检查 0 而不是 undefined

> ID：14447647
> 
> 赞同：2
> 
> 时间：2013-01-21T21:34:59.263
> 
> 标签：javascript

我有一个函数，它接受一个参数并用它执行一些计算。参数是一个数字。但是，当参数为0时，js将其视为未定义。所以，如果我有这样的支票：

`if (param == 0) { ... }`

这总是错误的，因为`param==0`它是`false`但又`param==undefined`是真的。所以我必须重写代码并在param = 0时有一个特殊情况。

示例：
`result= param*123*456 +789;` 这必须更改为：

```
if (param == undefined) {
  result= 789;
} else {
  result= param*123*456 +789;
}
return result; 
```

这是重复代码。一定会有更好的办法。更好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:39:51.360

您可以执行一个

```
param = param || 0; 
```

在你的功能的顶部。

这将确保 if `param`is`undefined`将变为 0，因此您的所有计算都将按预期工作..

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T21:40:06.367

将您的代码更新为

```
result= (param||0)*123*456 +789; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T21:42:13.647

你可以把`if (param === undefined) param = 0;`顶部。

不过，您的问题可能出在其他地方。你说“但是，当参数为0时，js将其视为未定义”，但这不正常。

# groovy - 无法使用 groovy 注释中的类中定义的变量

> ID：14447650
> 
> 赞同：5
> 
> 时间：2013-01-21T21:35:10.900
> 
> 标签：groovy, annotations, gradle

我正在尝试将 Dropwizard 示例中的一些代码从 java 移植到 groovy。

我看到在 java 中，我可以毫无问题地使用以下代码：

```
package com.example.helloworld;
import javax.ws.rs.*;
import javax.ws.rs.core.MediaType;

@Produces(MediaType.APPLICATION_JSON)
public class HelloWorldService{  

} 
```

但是，使用 groovy 编译器（ 1.8 和 2.0.6 ），该类无法编译，并且在 MediaType.APPLICATION_JSON 周围出现 noClassFoundException

如果我更改此代码以使用实际的字符串值

```
@Produces('application/json')
public class HelloWorldService{  

} 
```

一切正常。

groovy 解析注解的方式和 java 的方式有什么不同吗？

为了完整起见，这是 gradle 项目的一部分，这是我的 build.gradle （该文件位于 src/groovy/com/example/helloworld 下）

```
apply plugin: 'groovy'

// Set our project variables
project.ext {
    dropwizardVersion = '0.6.1'
}

repositories {
    mavenCentral()
}

dependencies {
    compile group: 'com.yammer.dropwizard', name: 'dropwizard-core', version: dropwizardVersion
    groovy group: 'org.codehaus.groovy', name: 'groovy-all', version: '1.8.7'
} 
```

编译错误是：

> 原因：java.lang.RuntimeException: java.lang.ClassNotFoundException: com.sun.ws.rs.ext.RuntimeDelegateImpl ... 17 更多原因：java.lang.ClassNotFoundException: com.sun.ws.rs.ext。 RuntimeDelegateImpl 在 org.gradle.api.internal.tasks.compile.TransformingClassLoader.findClass(TransformingClassLoader.java:47)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-22T00:23:58.817

该问题是由 Groovy 编译器的一个不幸限制引起的，即它使用反射来访问编译类路径上的类。这可能反过来触发其他类被加载，这在编译类路径上可能不可用。通常（但不总是）这些是运行时依赖项。

在具体情况下，Groovy 编译器`javax.ws.rs.core.MediaType`通过反射加载，最终导致`com.sun.ws.rs.ext.RuntimeDelegateImpl`通过`Class.forName`不在编译类路径上的（由静态初始化程序触发）加载。解决方案是将该类放在编译类路径上。（从长远来看，解决方案是修复独立的 Groovy 编译器不使用反射，据我所知，这已经在队列中。）如果你的模块的传递依赖不是问题，实现这一点的最简单方法是：

```
dependencies {
    compile "com.sun.jersey:jersey-client:1.15" 
} 
```

我怀疑 Eclipse Groovy 编译器没有这个问题，因为它不使用反射来访问编译类路径。我希望 GMaven 会像 Gradle 一样爆炸，除非它被配置为使用 Eclipse 编译器（Gradle 目前不支持）。

# c# - 为什么这会引发空对象异常

> ID：14447654
> 
> 赞同：2
> 
> 时间：2013-01-21T21:35:18.903
> 
> 标签：c#, nullpointerexception

我得到一个未设置为对象实例的对象引用。：OperatorAssembly: 0 line 157。我不明白什么会触发这个异常

```
LogFile.Info("order="+order.Id);

if (order.Location != null)
{
    LogFile.Info("order=" + order.Location.Address);
}    
else
{
    LogFile.Info("order location is null");
}

LogFile.Info("order=" + order.Location.Latitude);
LogFile.Info("order=" +  order.IsResolved);
LogFile.Info("order user id=" + order.User.Id);
LogFile.Info("order ser name=" + order.User.Name);
LogFile.Info("order ser dest =" + order.Destination.Address);                       

line 157:
result = new OrderDataDriver
{
    OrderId = order.Id,
    Address = order.Location.Address,
    Lat = order.Location.Latitude,
    Lng = order.Location.Longitude,
    DestinationAddress = order.Destination.Address,
    DestinationLat = order.Destination.Latitude,
    DestinationLng = order.Destination.Longitude,
    IsCanceled = order.IsCanceled,
    IsPendingResponse = order.IsPendingResponse,
    IsResolved = order.IsResolved,
    UserId = order.User.Id,
    Message = order.MessageForDriver,
    UserName = order.User.Name,
    // IsAdvanceBooking = order.AdvenceBookingTime != null,
    AdvanceBookingTime = order.AdvenceBookingTime,
    AdvancePrice = order.CalculatedPrice,
    AdvanceDistance = order.CalculatedDistance,
    SecondsToRespond = 30,
    Status=order.DriverStatus
};

[DataContract]
public class OrderDataDriver
{

    [DataMember] public string Address { get; set; }
    [DataMember] public string Feedback { get; set; }
    [DataMember] public double Lat { get; set; }
    [DataMember] public double Lng { get; set; }
    [DataMember] public int UserId { get; set; }
    [DataMember] public string Status { get; set; }
    [DataMember] public bool? IsEligible { get; set; }
    [DataMember] public bool? IsCanceled { get; set; }
    [DataMember] public bool? IsResolved { get; set; }
    [DataMember] public bool? IsPendingResponse { get; set; }
    [DataMember] public bool? AllowsTracking { get; set; }
    [DataMember]
    public int OrderId { get; set; }
    [DataMember]

    public int App { get; set; }
    [DataMember]
    public int? PreferedDriver { get; set; }
    [DataMember]
    public bool IsAdvanceBooking { get; set; }
    [DataMember]
    public DateTime? AdvanceBookingTime { get; set; }
    [DataMember]
    public double? AdvancePrice { get; set; }
    [DataMember]
    public double? AdvanceDistance { get; set; }
    [DataMember]
    public string DestinationAddress { get; set; }
    [DataMember]
    public double DestinationLat { get; set; }
    [DataMember]
    public double DestinationLng { get; set; }
    [DataMember]
    public string Message { get; set; }
    [DataMember]
    public string UserName { get; set; }
    [DataMember]
    public int SecondsToRespond { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T21:41:14.930

将复杂对象初始化更改为如下所示：

```
var result = new OrderDataDriver();
result.blablah = foor.bar; 
```

然后，您将收到一条更好的错误消息，其中包含您尝试访问空对象的属性的确切行号。

这里是参考这个可爱模式的好地方，它使开发人员的生活更轻松 [http://en.wikipedia.org/wiki/Fail-fast](http://en.wikipedia.org/wiki/Fail-fast)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:39:24.160

如果属性为 null，则这些访问器中的任何一个都可能崩溃：

```
//If Location is null BOOM!!!
Lat = order.Location.Latitude,
Lng = order.Location.Longitude,

//If Destination is null BOOM!!!
DestinationAddress = order.Destination.Address,
DestinationLat = order.Destination.Latitude,
DestinationLng = order.Destination.Longitude, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T22:25:18.390

当您使用对象初始化程序时，例如

```
result = new OrderDataDriver { OrderId = order.Id, Address = order.Location.Address, Lat = order.Location.Latitude, Lng = order.Location.Longitude, }; 
```

不要指望行号（和列号，如果有的话）准确指出大括号内的哪些“属性分配”`{ }`会导致异常。毕竟，这被转换为对临时（不可见）变量属性的赋值。只有一切顺利，临时变量才会复制到您的`result`值。

对于涉及对象初始化程序的堆栈跟踪，我也遇到过这种不便。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T21:44:58.323

由于可能`null`已经记录了一些事情，因此应该更早地抓住它们。

除非你有一个有副作用的属性获取器。那些是纯粹的邪恶，所以要小心。另一种可能性是另一个线程更改了一个值。这更难证明。

# javascript - 在 mongodb 中插入数据时添加条件

> ID：14447657
> 
> 赞同：1
> 
> 时间：2013-01-21T21:35:27.483
> 
> 标签：javascript, node.js, mongodb, express, node-mongodb-native

基本上我想在插入数据之前检查数据库中是否存在特定数据（我使用本机 mongodb 驱动程序），所以我尝试使用`collection.findOne()`检查数据是否存在，如果属性的属性为 null 则`collection.insert()`执行。

显然我的代码没有按照逻辑工作，请有人赐教！

我的一些代码：

```
exports.addUser = function(req, res) {
    var twitterId = req.body.provider;
    var userEmail = req.body.email;

    db.collection('users', function(err, collection) {
        collection.findOne({'email':userEmail }, function(err, item){

            if(item.email === null){

                collection.insert({
                    'email': userEmail,
                    'provider': {
                        'twitter': {
                            'id': twitterId
                        }
                    }
                }, function(err, result) {
                    if (err) {
                        res.send({'error':'An error has occurred'});
                    } else {
                        console.log('Success: ' + JSON.stringify(result[0]));
                        res.send(result[0]);
                    }
                });   

            }else{
                console.log("Email exits ");
            }
        });

    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T00:39:01.057

您的`if`声明预计`item.email`将明确设置为`null`. 如果`item.email`不是 的属性`item`，则该 if 语句将评估为`false`。

```
var foo = {bar:'baz'}
foo.bar // 'baz'
foo.notSet // undefined
foo.notSet === undefined // true
foo.notSet === null // false

// now if we set foo.notSet to undefined...
foo.notSet = null // undefined
foo.notSet === null // true 
```

所以，选择很少...

```
if (item.email) {} else {};
if ('email' in item) {} else {};
if (item.hasOwnProperty('email')) {} else {}; 
```

如果你尝试调用对象本身不存在的属性，JS 将检查它的原型，如果它在任何地方的原型上都不存在，那么它将返回 undefined。

操作员将`in`检查左侧操作数是否是右侧对象的属性。

最后`Object.hasOwnProperty`将检查它的参数作为对象的属性。

说了这么多，`{upsert:true}`可能是你最好的选择。

# c - ansi-c ：赋值使指针从没有强制转换的整数

> ID：14447660
> 
> 赞同：2
> 
> 时间：2013-01-21T21:35:36.493
> 
> 标签：c, pointers, casting

我正在尝试更多地了解C，我想知道是否有人可以澄清这里发生了什么。我收到编译器警告：“警告：赋值从指针生成整数而无需强制转换 @ msg[msglen+1] = "\0""

```
char *msg = NULL;
int len = 10;
int msglen = 0;

while(<argument>) {

msg = (char *)calloc(len, 1);
strncpy(msg, <some string>, len);
msglen = strlen(msg);
msg[msglen+1] = "\0"; 
```

谢谢，感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:36:58.387

您正在尝试将指向字符串文字的指针分配给`char`. 将双引号更改`"`为单引号`'`，如下所示：

```
msg[len - 1] = '\0'; 
```

请注意，我更改`msglen+1`了`len - 1`最后分配的字符的索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:45:22.363

"\0" 被视为常量字符串，并且当您尝试执行此操作时，该字符串的地址会被放置到位，`msg[len - 1] = "\0"`因此您会收到消息“converts...”

改为这样做`msg[len - 1] = '\0'`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T21:41:44.227

```
msg = malloc(len + 1);
/* check return value here ... */
memcpy(msg, some_string, len);
msg[len] = 0;
msglen = strlen (msg); /* this is to catch premature NULs */ 
```

# android - 从 XML 膨胀并在 ActionBar 的 MenuItem 上使用 setActionView 时发生内存泄漏

> ID：14447663
> 
> 赞同：2
> 
> 时间：2013-01-21T21:35:50.790
> 
> 标签：android, memory-leaks, android-actionbar

这是一个非常简单`Activity`的`ActionBar`包含单个`MenuItem`“搜索”的内容。我想为搜索按钮设置一个 ActionView，并使用它`MenuItem.setActionView(int ResId)`来传递 XML 布局。膨胀我想要`MenuItem`作为操作视图附加到的布局。

简单的`button`开始完全相同`Activity`。在开发选项中设置了“不保留活动”。

问题：在操作视图中的小部件上设置 OnClickListener 后，`MainActivity`永远不会被垃圾收集（参见下面的 MAT）。但是，如果我在 java 中创建视图层次结构（而不​​是膨胀它），它应该是 GC。

```
public class MainActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Button button = new Button(this);
    button.setText("Click");

    button.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            Intent i = new Intent(MainActivity.this, MainActivity.class);
            startActivity(i);
        }
    });
    setContentView(button);
}

@SuppressLint("NewApi")
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuItem searchIcon = menu.add("search");
    searchIcon.setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS | MenuItem.SHOW_AS_ACTION_COLLAPSE_ACTION_VIEW);
    // I set the ActionView here:
    searchIcon.setActionView(R.layout.action_search_form);
    ViewGroup vg = ((ViewGroup)searchIcon.getActionView());
    ImageButton btn = (ImageButton)vg.findViewById(R.id.search_clear_btn);
    btn.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            Toast.makeText(MainActivity.this, "click", Toast.LENGTH_SHORT).show();
        }

    return true;
}
} 
```

对象的数量与我单击`button`. 如果我删除`onCreateOptionsMenu()`块，对象的数量不完全是 1，但总是低于 10。

![在此处输入图像描述](../Images/afb43fe868df931281c2f69a171b913c.png)

# three.js - 有没有人将globe（chrome实验）移植到最新的threejs版本？

> ID：14447664
> 
> 赞同：3
> 
> 时间：2013-01-21T21:35:58.573
> 
> 标签：three.js

*短篇小说：*
globe 代码基于（并包含）**threejs v40**，而 github 中的最新版本目前是**threejs r55**。我想知道是否有人（在这方面比我知识渊博）将*地球*移植到更新的 threejs 版本？

*长话短说：*
我正在摆弄来自[http://www.chromeexperiments.com/globe](http://www.chromeexperiments.com/globe)的谷歌地球仪。我注意到它基于旧的threejs（在github上）版本。使用最新版本（并获得相同的结果！）并不容易。另请参阅[此问题](https://stackoverflow.com/questions/12750344/three-js-select-geometry-by-id)。

我更改了一些函数名称并摸索了一些参数，没什么大不了的。然后我转向着色器。事实证明，这更具挑战性。**老版本的threejs在做Mesh.flipSided = true;**的时候好像有bug ：新旧版本的着色器中的法线向量似乎不同。但是*globe*中的着色器代码是针对这个错误编写的，所以我不得不更正着色器代码。

我现在有一些看起来一样的东西，但是将大气和地球结合起来根本不起作用。我怀疑[这个threejs错误](https://github.com/mrdoob/three.js/issues/1461)在其中起作用，但我不确定。这又是一个可能已被*全球*作者使用的*反面错误。*

 *嗯，嗯，我有点卡在这里。我可以做我想做的事情坚持旧版本，但不知何故感觉很糟糕。

任何人都可以在这里阐明一下吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T01:39:40.437

根据[https://code.google.com/p/webgl-globe/source/browse/globe/globe.js](https://code.google.com/p/webgl-globe/source/browse/globe/globe.js)上的更改日志：

“2012 年 11 月 5 日。更新为 threejs r52 和 tweenjs r7。”

所以，从表面上看，它听起来像是更新了……代码的哪些部分特别给你带来了麻烦？

现在，`Mesh.flipSided = true`在网格的材质中，您需要设置`side:THREE.BackSide`而不是。

您可以发布或发送指向您的代码的链接以进行进一步调查吗？全球项目的更新版本听起来像是一项最有价值的工作。*

# visual-studio-lightswitch - Lightswitch - 无法更新应用程序

> ID：14447665
> 
> 赞同：0
> 
> 时间：2013-01-21T21:36:02.803
> 
> 标签：visual-studio-lightswitch

我有一个我正在尝试运行的 Lightswitch 应用程序（3 层，桌面），但是以下错误阻止我继续前进。

![在此处输入图像描述](../Images/a2c9036904bb572e60dd5d80df6b6583.png)

该应用程序以前可以运行，但由于某种原因，今天它只是不想安装。

从 IIS 删除站点/内容、清除浏览器缓存、卸载应用程序、清理项目并从 Visual Studio 发布应用程序后，我收到错误屏幕。这在应用程序安装并首次打开后立即发生。

很好奇，因为应用程序的 xap 尚未在发布设置中签名。我想知道这可能是什么原因？我在 \Trace.axd 中没有看到任何异常

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T07:33:51.940

您需要使用证书对 xap 进行签名。它可以是用于测试的自签名证书，您可以手动将其存储在本地证书存储中。

# ios - 在 iOS 上未显示数字键盘

> ID：14447668
> 
> 赞同：81
> 
> 时间：2013-01-21T21:36:08.870
> 
> 标签：ios, html

根据[Apple的文档](http://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/InputTypes.html)，当我设置类型为的输入元素时，`number`我应该得到一个数字键盘。

```
<input type="number"/> 
```

> `number`：用于指定数字的文本字段。在 iOS 3.1 及更高版本中调出数字键盘。

看起来该死的几乎不可能搞砸。但是，当我在我的 iPhone 或模拟器（都是 iOS6）上查看这个简单的小提琴时，数字键盘没有出现，而是我得到了标准的字母键盘。

[http://jsfiddle.net/Cy4aC/3/](http://jsfiddle.net/Cy4aC/3/)

我到底能在这里搞砸什么？

![在此处输入图像描述](../Images/a5b2546d7813a33c157b7cb4f6f1e6f1.png)

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2013-01-21T21:47:12.860

您需要指定模式：

```
<input type="number" pattern="\d*"/> 
```

由于 a`number`可以是负数或浮点数，因此`-`and`.`和`,`应该在键盘中可用，除非您指定仅数字模式。

![在此处输入图像描述](../Images/faf7cba558e9736bfdf49807e9286837.png)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2020-09-02T19:11:28.020

从 ios 12.2（2019 年 3 月 25 日发布）开始，此解决方案将起作用，并且实现起来最简单

```
<input type="number" inputmode="decimal"/> 
```

这将只显示数字键盘，而没有使用 input="tel" 附带的#+* 字符

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-21T21:43:08.373

我不确定这是否是您想要的，但输入 type = "tel" 会给您“电话号码键盘”。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-06-21T13:41:30.383

以我的经验，这在浏览器之间非常不一致。iOS 在为我的用例正确支持这一点之间来回走动。我通常只希望默认显示的键盘是数字键盘。上次我检查时，使用 input type="number" 正确调出数字键盘，但忽略了“size”属性，这严重影响了我的移动格式。我为所有我希望默认使用数字键盘的输入添加了一个属性，并且当浏览器检测到一个可以正常工作的属性时，我使用 jQuery 来更改任何属性（即 type="number"）。这样我就不必返回并更新各个输入，并允许我只在支持的浏览器中应用它。

如果主要的移动操作系统除了输入类型之外还有一个“默认键盘”属性，那就太好了。如果用户输入地址或邮政编码怎么办？通常那些以数字开头，因此默认显示数字键盘但允许任何文本是有帮助的。

至于验证，我不能依赖浏览器来支持特定输入类型的验证，所以我使用 javascript 和服务器端验证。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-02-20T13:42:43.593

*问候。我知道这个问题很老，但我觉得这是一个非常受欢迎的解决方案，并决定发布一个答案。*

这是我为**解决****iPad 键盘**以及几乎所有问题而创建的解决方案。

此外，这种方法**不需要您使用数字类型的输入**，在我看来这是非常丑陋的。

下面，您可能会找到一个工作版本。

**关于 Apple iPad 键盘按键的思考...**

我必须创建一个 keyPress 事件处理程序来捕获和抑制 iPad 上似乎没有被 keyDown 事件处理或不明确的键？？？！

```
// Bind keydown event to all input type=text in form.
$("form input[type=text]").keydown(function (e) {

// Reference to keyCodes...
var key = e.which || e.keyCode;
// Reference to shiftKey...
var shift_key = e.shiftKey;
// Reference to ctrlKey...
var ctrl_key = e.ctrlKey;
// Reference to altKey...
var alt_key = e.altKey;

// When user presses the shiftKey...
if(e.shiftKey) {

//...supress its click and whatever key follows after it.
console.log(e.shiftKey + ' and ' + key + ' supressed.');

// Deny
return false;

// ONLY Allow Numbers, Numberpad, Backspace & Tab
} else if ( (key >= 48 && key <=57) || (key >= 96 && key <=105) || (key >= 8 && key <=9) ) {

// Allow
return true;

} else {

// Deny every other key and/or shift + key combination NOT explicitly declared.
return false;
}

});

// KeyPresss to handle remaining iPAD keyboard keys!
// These keys don't seem to be handled by the keyDown event or are ambiguous???!
// Bind keypress event to all input type=text in form.
$("form input[type=text]").keypress(function (e) {

// Reference to keyCodes...
var key = e.which || e.keyCode;
// Reference to shiftKey...
var shift_key = e.shiftKey;
// Reference to ctrlKey...
var ctrl_key = e.ctrlKey;
// Reference to altKey...
var alt_key = e.altKey;

switch (key) {

// Character -> ^
case 94:
return false;

// Character -> #
case 35:
return false;

// Character -> $
case 36:
return false;

// Character -> @
case 64:
return false;

// Character -> &
case 38:
return false;

// Character -> *
case 42:
return false;

// Character -> (
case 40:
return false;

// Character -> )
case 41:
return false;

// Character -> %
case 37:
return false;

// Character -> !
case 33:
return false;

}

});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<form action="">

<label for="text1">Numbers, Numberpad, Backspace & Tab ONLY:</label>
<input id="text1" type="text" placeholder="0" min="0" input pattern="[0-9]*" inputmode="numeric" value="" maxlength="4">

</form>
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-22T16:58:55.717

在阅读并尝试了很多想法之后，我发现没有一个可以准确地显示只有数字和逗号或点的键盘。

我在这个输入上完成了使用 just`<input type="number">`和一个`onkeyup`处理程序，我做了这样的事情：

```
var previousValue = localStorage.getItem('myInputId');
if (input.getAttribute('type') === "number" && input.validity && input.validity.badInput) {
    input.value = previousValue || "";
}
localStorage.setItem('myInputId', input.value); 
```

如果存在有效性错误，这可以防止用户通过将值替换为前一个值来写入错误的字符（我不知道这是一个 iOS 对象还是标准）

*当心我没有测试这个代码片段，因为我身边有更复杂的东西，但我希望你能明白*

使用此解决方案：

*   在 iOS 上：用户有一个完整的经典键盘，但默认打开数字，不能写错字符。
*   在 Android 上，数字键盘是完美的。
*   将来我们可以希望 iOS 能够触发良好的数字键盘，并且永远不会调用 javascript 部分。

# php - $sth->execute() 返回 false

> ID：14447677
> 
> 赞同：0
> 
> 时间：2013-01-21T21:36:43.097
> 
> 标签：php, pdo, execute

我有这个代码：

```
$dbh = new PDO("mysql:host=$dbHost;dbname=$dbName", $dbUser, $dbPassword);
$sth = $dbh->prepare(" SELECT `login`, `password` FROM `admins` WHERE `login` = ?, `password` = ? ");
var_dump($sth->bindParam(1, $login)); // true
var_dump($sth->bindParam(2, $password)); // true
var_dump($sth->execute()); // false 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:39:45.363

```
WHERE `login` = ?, `password` = ? 
```

那不应该是……

```
WHERE `login` = ? and `password` = ? 
```

# matlab - 为什么这个指数方程返回一个全零数组？

> ID：14447681
> 
> 赞同：3
> 
> 时间：2013-01-21T21:36:56.560
> 
> 标签：matlab, zero, exponential

我试图弄清楚为什么我在下面的代码中得到全零。

```
a = 7.0e16;
e = 100000;
r = 8.3140;
t = 253:2:325;

k = a.*exp(-e./t.*r); 
```

`k`返回为仅由零组成的 1x37 数组。

是因为我的数字太大还是太小？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T21:43:56.257

你得到了下溢。事情在 exp 中变为零，之后乘以一个大数字为时已晚。它看起来像一个物理方程——在这种情况下，你想除以 r，而不是相乘。尝试

`exp(log(a)-e./(t*r))`

它应该工作

编辑 - 必须在指数中添加而不是相乘 log(a) ...

# javascript - 在 MobileSafari 中点击状态栏在我的测试页面上不起作用

> ID：14447684
> 
> 赞同：0
> 
> 时间：2013-01-21T21:37:13.957
> 
> 标签：javascript, ios, html, safari, mobile-safari

我正在尝试对此进行调试，但无法取得任何进展。我有这个我正在构建的 HTML5 JavaScript 库，它的测试页面可以包含大量输出，因为我正在管道`console.log`和异常输出到 DOM 以在移动设备上快速检查它们（这是我知道的唯一检查方法例如 Android 设备上的状态）

[这](http://unphased.github.com/ply/test.html)是页面。只要我在处理此问题时不推送损坏的代码，您应该能够产生大量调试输出，这些输出将被泵入`<body>`从而允许页面滚动。另请注意，要切换大蓝色调试面板的可见性，您可以点击页面顶部的标题文本（如按钮）。

这个问题是 iOS 特有的：点击 iOS 状态栏在纵向或横向模式下都不起作用，我不确定我用 JS 做了什么，或者禁用了这个非常方便的功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T22:05:28.783

使用`-webkit-overflow-scrolling: touch`似乎是 iOS6 的罪魁祸首。实际上，iOS5 在这个问题上似乎没有那么糟糕。

`-webkit-overflow-scrolling: touch`我认为可能有一种方法可以通过捕获触摸事件来动态设置需要它的元素来解决这个问题。或者只是将其关闭，因为它们仍然可用（只是没有动力）。

# wicket - Wicket Ajax Keyevent

> ID：14447688
> 
> 赞同：4
> 
> 时间：2013-01-21T21:37:31.287
> 
> 标签：wicket, wicket-1.6

我是 Wicket 的新手，如果按下 Functionkey，我想创建一个调用我的 Javacode 的 ajax 行为。

我的想法是创建一种将一些 Javascript 发送到浏览器的行为，只有 F 键会导致 ajax 回调。

```
public class HomePage extends WebPage {
public HomePage(final PageParameters parameters) {
    super(parameters);

    add(new AbstractDefaultAjaxBehavior(){

        @Override
        protected void respond(AjaxRequestTarget target) {
            //retrieve the Parametervalue from request
            final Request request = RequestCycle.get().getRequest();
            final String jsKeycode = request.getRequestParameters()
                            .getParameterValue("keycode").toString("");

            //test output   
            target.appendJavaScript("alert('from wicket ajax. you pressed "+jsKeycode+"')");
        }

        @Override
        public void renderHead(Component component, IHeaderResponse response) {
            super.renderHead(component, response);

            //Append JavaScriptcode 
            response.render(OnDomReadyHeaderItem.forScript(
                    "\n\n" +
                    "$(document).keydown(" +
                        "function(event){\n" + //120, 121 Example for F9 and F10
                            "if((event.keyCode == 120) || (event.keyCode == 121)){\n" + 
                                "event.preventDefault();\n" +
                                "window.alert('F-Key pressed');\n" +
                                //perform ajax-callback with keyCode
                            "}\n" +
                        "});\n"));   
        }
    }); 
```

现在我的问题是：我必须编写什么代码，将按下的键码作为参数执行 ajax 回调？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-22T22:09:15.257

osmdamv 提示我为我的问题找到“Wicketsolution”。现在这是我的代码，用于捕获按键并仅在某些情况下向 wicketserver 发送 ajaxrequest。

使用此示例，其他用户应该可以根据他们的需要调整此代码。

```
public HomePage(final PageParameters parameters) {
    super(parameters);

    add(new AjaxEventBehavior("keydown"){
        @Override
        protected void updateAjaxAttributes(AjaxRequestAttributes attributes) {
            super.updateAjaxAttributes(attributes);

            IAjaxCallListener listener = new AjaxCallListener(){
                @Override
                public CharSequence getPrecondition(Component component) {
                    //this javascript code evaluates wether an ajaxcall is necessary.
                    //Here only by keyocdes for F9 and F10 
                    return  "var keycode = Wicket.Event.keyCode(attrs.event);" +
                            "if ((keycode == 120) || (keycode == 121))" +
                            "    return true;" +
                            "else" +
                            "    return false;";
                }
            };
            attributes.getAjaxCallListeners().add(listener);

            //Append the pressed keycode to the ajaxrequest 
            attributes.getDynamicExtraParameters()
                .add("var eventKeycode = Wicket.Event.keyCode(attrs.event);" +
                     "return {keycode: eventKeycode};");

            //whithout setting, no keyboard events will reach any inputfield
            attributes.setAllowDefault(true);
        }

        @Override
        protected void onEvent(AjaxRequestTarget target) {
            //Extract the keycode parameter from RequestCycle
            final Request request = RequestCycle.get().getRequest();
            final String jsKeycode = request.getRequestParameters()
                            .getParameterValue("keycode").toString("");

            target.appendJavaScript("alert('from wicket ajax. you pressed "+jsKeycode+"')");
        }
 }); 
```

**编辑：**

我插入 attributes.setAllowDefault(true)。现在它工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T00:18:44.627

[你应该使用装饰器](http://wicketinaction.com/2012/07/wicket-6-javascript-improvements/)来使用 AjaxEventBehavior

```
 @Override
  protected void updateAjaxAttributes(AjaxRequestAttributes attributes)
  {
      super.updateAjaxAttributes(AjaxRequestAttributes attributes);

      IAjaxCallListener listener = new IAjaxCallListener()
      {
         @Override
         public CharSequence getBeforeHandler(Component c) { return handler; }
        .....
   };

  attributes.getAjaxCallListeners().add(listener); 
```

}

# ruby-on-rails - edit_content_path 错误 Ruby On Rails

> ID：14447690
> 
> 赞同：0
> 
> 时间：2013-01-21T21:37:33.013
> 
> 标签：ruby-on-rails

你好！

我有许多链接，例如 <%= link_to 'Edit', edit_content_path(content) %> 但由于我的 Rails 更新和其他一些路线更改，路径是错误的。

它导致域/内容而不是正确的域/子文件夹/内容......有什么问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T19:22:28.397

这是我的路线.rb：

```
ActionController::Routing::Routes.draw do |map|

  map.root :controller => "store"

  map.resources :users
  map.resources :orders, :controller => 'order'
  map.resources :contents
  map.resources :products

  map.resources :kundservice => "store/kundservice"
  map.resources :foretaget => "store/foretaget"

  # Install the default routes as the lowest priority.
  map.connect 'subfolder/:controller/:action/:id'
  map.connect 'subfolder/:controller/:action/:id.:format'
end 
```

由于我的网站所在的主机公司，我必须将它放在我的域下的子文件夹中，www.domain.com/subfolder/store。

谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T01:12:33.783

您是否在您的 routes.rb 文件中嵌套了任何路由？

如果您必须将父级添加到路径中。

```
edit_parent_content_path(@parent, @content_id) 
```

类似的东西。运行->

```
$ rake routes 
```

将帮助您确定是否是路线问题。（尝试在结果中找到您当前的路径。）

如果您仍有问题，请发布您的 routes.rb 文件。

# ios - 如何格式化将字符串 2013-01-27T02:31:47+08:00 转换为 NSDate

> ID：14447693
> 
> 赞同：1
> 
> 时间：2013-01-21T21:37:39.583
> 
> 标签：ios, objective-c, ios6, nsdate, nsdateformatter

我曾多次尝试将字符串`2013-01-27T02:31:47+08:00`转换为 NSDate。我找到了苹果的[格式化指南](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html#//apple_ref/doc/uid/TP40002369-SW1)并复制了它的代码并尝试了，但它不起作用。

```
 NSDateFormatter *rfc3339DateFormatter = [[NSDateFormatter alloc] init];
    NSLocale *enUSPOSIXLocale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"];

    [rfc3339DateFormatter setLocale:enUSPOSIXLocale];
    [rfc3339DateFormatter setDateFormat:@"yyyy'-'MM'-'dd'T'HH':'mm':'ss'Z'"];
    [rfc3339DateFormatter setTimeZone:[NSTimeZone timeZoneForSecondsFromGMT:8]];

    // Convert the RFC 3339 date time string to an NSDate.
    NSDate *date = [rfc3339DateFormatter dateFromString:@"2013-01-27T02:31:47+08:00"]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T21:43:00.153

你的格式应该是`@"yyyy-MM-dd'T'HH:mm:ssZZZZZ"`. 您只需要在格式化程序不会使用的字母周围加上单引号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:44:08.863

```
 NSDateFormatter *dateFormat = [[NSDateFormatter alloc] init];
  [dateFormat setDateFormat:@"yyyy-MM-dd HH:mm:ss"];
  [dateFormat setTimeZone:[NSTimeZone timeZoneForSecondsFromGMT:0]];

  NSString *dateTimeString = @"2013-01-09 16:00:00";
  NSLog(@"DateTimeString = %@", dateTimeString);

  NSDate *myDate =[dateFormat dateFromString:dateTimeString];
  NSLog(@"myDate:          %@", myDate); 
```

输出：

```
 dateTimeString = 2013-01-09 16:00:00
  myDate:        = 2013-01-09 16:00:00 +0000 
```

要向用户显示日期，请使用 stringFromDate 将 NSDate 转换为 NSString，但不要设置时区（以便使用本地时区）：

```
 NSDateFormatter *dateFormat2 = [[NSDateFormatter alloc] init];
   [dateFormat2 setDateFormat:@"yyyy-MM-dd HH:mm:ss"];

     NSString *localDateString = [dateFormat2 stringFromDate:myDate];
   NSLog(@"localDateString: %@", localDateString); 
```

输出：

```
 localDateString: 2013-01-09 17:00:00 
```

# php - 推送通知以更改其他人的内存缓存/会话数据

> ID：14447699
> 
> 赞同：1
> 
> 时间：2013-01-21T21:37:59.193
> 
> 标签：php, codeigniter, session, memcached, push-notification

我想知道处理我的网站用户将相互发送的评论的推送通知的最佳方式。

当提交新评论时，它显然会存储在我的数据库中。但是，我还想将每个用户的评论存储在 memcache 中或作为会话数据（无论什么被认为是最好的？），这样每次用户访问我的网站/刷新页面时，他们都可以快速获得未读通知而不会点击我的数据库。

我想到的一种方法是在用户收到推送通知时，将 AJAX 请求发送回服务器以更新他们的内存缓存/会话数据。

问题是如果用户未登录或当前未使用该站点，该怎么办。即使用户不在那里“接收”它，AJAX 请求是否仍会被发送？还是 AJAX 请求会“等待”并在用户重新访问该站点时立即发生？首先以这种方式处理通知是否是一个好主意？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:06:03.253

你想保持你的 PHP 会话很小。将大量数据塞入其中会导致性能下降。我不会将它们用于此目的。我最多会使用它来存储他们最后一次检查他们的评论。

您也不是在做推送通知，而是在使用客户端轮询。您可以使用 Websockets 进行推送通知，但不能使用 AJAX（您可以使用长轮询来伪造它）。除非您的用户已登录并打开浏览器访问您的站点，否则不会运行任何 Javascript 来启动 AJAX 调用以检查评论。

Websockets 或长轮询要求您使用 Apache 的辅助服务器。他们会吃掉你在 Apache 中的可用连接。

我假设您希望评论是持久的，所以请记住“忘记”是 Memcached 的一个功能。Redis 可以设置为持久化数据。如果您使用 memcached 作为性能提升，您需要确定数据完整性是否重要（删除通知是可以的），或者您是否需要设计一些健壮性以便他们总能收到通知。

希望这可以帮助。

# c# - XElement.element() 有时返回 null

> ID：14447703
> 
> 赞同：1
> 
> 时间：2013-01-21T21:38:14.707
> 
> 标签：c#, xml, null, xml-namespaces

我正在加载一个 XML 文件，获取一些节点的值，然后将这些值设置为一个对象。

问题是虽然我可以进入每个节点，但我无法获取它的值：它只是返回 null。在 Google 和 SO 中搜索，我发现几个线程说通常这是名称空间的问题。所以我在 XML 文件上设置了一个命名空间，并在我的代码中使用它。现在事情变得有趣了：

*   如果除最后一个节点之外的所有节点都以命名空间为前缀（在我的代码中），则除了给出 ArgumentNullException 的特定节点（`tabla`在某些属性上不接受空值）之外，所有节点都会被设置。这似乎是预期的行为。
*   如果我更正最后一行并设置命名空间（应该如此），那么异常会在 FIRST 节点处引发。

这是 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<root xmlns="http://daniel.ponticelli.com/ns/dataExport">
  <PollInstance>
    <Poll_Instance_id>1</Poll_Instance_id>
    <POLL_description>Mes 1</POLL_description>
    <dt_start>01/09/2012 12:00:00 a.m.</dt_start>
    <dt_end>30/09/2012 12:00:00 a.m.</dt_end>
    <POLL_status>0</POLL_status>
    <dt_created>03/09/2012 09:50:36 a.m.</dt_created>
    <dt_updated>03/09/2012 09:50:36 a.m.</dt_updated>
    <id_original_clone>0</id_original_clone>
    <target_locs>0</target_locs>
    <id_poll>1</id_poll>
  </PollInstance>
</root> 
```

这是最后一个元素没有命名空间的“错误”代码：

```
XElement instancia = xml.Descendants().First();
XNamespace ra = "http://daniel.ponticelli.com/ns/dataExport";

tabla.Poll_Instance_id = (int)instancia.Element(ra + "Poll_Instance_id");
tabla.POLL_description = (string)instancia.Element(ra + "POLL_description");
tabla.dt_start = DateTime.Parse((string)instancia.Element(ra + "dt_start"));
tabla.dt_end = DateTime.Parse((string)instancia.Element(ra + "dt_end"));
tabla.POLL_status = (int)instancia.Element(ra + "POLL_status");
tabla.dt_created = DateTime.Parse((string)instancia.Element(ra + "dt_created"));
tabla.dt_updated = DateTime.Parse((string)instancia.Element(ra + "dt_updated"));
tabla.id_original_clone = (int)instancia.Element(ra + "id_original_clone");
tabla.target_locs = (int)instancia.Element(ra + "target_locs");
tabla.id_poll = (int)instancia.Element("id_poll"); 
```

前面的代码在最后一行给出了异常。

现在这是“正确”的代码，所有元素都以命名空间为前缀：

```
XElement instancia = xml.Descendants().First();
XNamespace ra = "http://daniel.ponticelli.com/ns/dataExport";

tabla.Poll_Instance_id = (int)instancia.Element(ra + "Poll_Instance_id");
tabla.POLL_description = (string)instancia.Element(ra + "POLL_description");
tabla.dt_start = DateTime.Parse((string)instancia.Element(ra + "dt_start"));
tabla.dt_end = DateTime.Parse((string)instancia.Element(ra + "dt_end"));
tabla.POLL_status = (int)instancia.Element(ra + "POLL_status");
tabla.dt_created = DateTime.Parse((string)instancia.Element(ra + "dt_created"));
tabla.dt_updated = DateTime.Parse((string)instancia.Element(ra + "dt_updated"));
tabla.id_original_clone = (int)instancia.Element(ra + "id_original_clone");
tabla.target_locs = (int)instancia.Element(ra + "target_locs");
tabla.id_poll = (int)instancia.Element(ra + "id_poll"); 
```

这段代码现在在第三行给出了异常！（以 开头的那个`tabla.Poll_Instance_id`）。如果我在最后一行之前的“错误”代码上设置断点，我可以在 VS 中检查确实从 XML 检索值`tabla`并按预期​​在对象上设置；所以我不知道发生了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:59:52.817

您的日期字符串格式无效`a.m.`- 使用`am`不带点

```
<?xml version="1.0" encoding="utf-8"?>
<root xmlns="http://daniel.ponticelli.com/ns/dataExport">
  <PollInstance>
    <Poll_Instance_id>1</Poll_Instance_id>
    <POLL_description>Mes 1</POLL_description>
    <dt_start>01/09/2012 12:00:00 am</dt_start>
    <dt_end>30/09/2012 12:00:00 am</dt_end>
    <POLL_status>0</POLL_status>
    <dt_created>03/09/2012 09:50:36 am</dt_created>
    <dt_updated>03/09/2012 09:50:36 am</dt_updated>
    <id_original_clone>0</id_original_clone>
    <target_locs>0</target_locs>
    <id_poll>1</id_poll>
  </PollInstance>
</root> 
```

此外，您应该在获取`instancia`节点时使用命名空间，或者您应该从 Root 开始`xdoc.Root.Descendants().First()`：

```
XNamespace ra = "http://daniel.ponticelli.com/ns/dataExport";
XElement instancia = xdoc.Descendants(ra + "PollInstance").First();

tabla.Poll_Instance_id = (int)instancia.Element(ra + "Poll_Instance_id");
tabla.POLL_description = (string)instancia.Element(ra + "POLL_description");
tabla.dt_start = ParseDate((string)instancia.Element(ra + "dt_start"));
tabla.dt_end = ParseDate((string)instancia.Element(ra + "dt_end"));
tabla.POLL_status = (int)instancia.Element(ra + "POLL_status");
tabla.dt_created = ParseDate((string)instancia.Element(ra + "dt_created"));
tabla.dt_updated = ParseDate((string)instancia.Element(ra + "dt_updated"));
tabla.id_original_clone = (int)instancia.Element(ra + "id_original_clone");
tabla.target_locs = (int)instancia.Element(ra + "target_locs");
tabla.id_poll = (int)instancia.Element(ra + "id_poll"); 
```

并使用 ParseExact 以您的格式解析日期

```
static DateTime ParseDate(string s)
{
    return DateTime.ParseExact(s, "dd/MM/yyyy hh:mm:ss tt",
                               CultureInfo.InvariantCulture);
} 
```

更新如果您无法更改 xml 的数据格式，则只需`String.Replace`更改`a.m.`为`am`：

```
static DateTime ParseDate(string s)
{
    string dateString = s.Replace("a.m.", "AM").Replace("p.m.", "PM");
    return DateTime.ParseExact(dateString, 
          "dd/MM/yyyy hh:mm:ss tt", CultureInfo.InvariantCulture);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T14:04:45.487

我找到了解决方案，感谢@lazyberezovsky 用 root() 为我指出了正确的方向。

问题出在`Descendants()`方法上，它给了我所有的后代节点；所以我得到了 PollInstance 节点以及`Poll_instance_id`其他节点。这就是为什么它在“正确”代码的第一行中断的原因：在处理第一个节点之后，它阻塞了其他节点。

相反，我必须使用`Elements()`只返回直接孩子的方法；就我而言，只有`PollInstance`.

# javascript - 鼠标悬停时的灰度

> ID：14447707
> 
> 赞同：0
> 
> 时间：2013-01-21T21:38:29.043
> 
> 标签：javascript, html, canvas, grayscale

我正在尝试使用 HTML5 画布在 Javascript 中将图像转换为灰度。我到底在这里做错了什么！？我知道它真的很近！

```
function convertToGreyscale(str)
{
    // Get the Canvas
    var oCanvas = document.getElementById(str);
    // Get the Canvas Context
    var oContext = oCanvas.getContext('2d');

    // Get the height & width of the canvas
    var oHeight = oCanvas.height;
    var oWidth = oCanvas.width;

    // Get the image data object
    // getImageData(startX,startY,endX,endY)
    var oImageData = oContext.getImageData(0,0,oHeight,oWidth);

    // Get the actual pixel information
    var oPixelArray = oImageData.data;
    var iLength = oPixelArray.length;

    for (var iCount = 0; iCount < iLength; iCount += 4)
    {
        var oRedPixel = oPixelArray[iCount];
        var oGreenPixel = oPixelArray[iCount+1];
        var oBluePixel = oPixelArray[iCount+2];
        var oGreyValue = oRedPixel * 0.2126 + oGreenPixel * 0.7152 + oBluePixel * 0.0722;

        // Set R,G & B to be the new grey value
        oRedPixel = oGreyValue;
        oGreenPixel = oGreyValue;
        oBluePixel = oGreyValue;

    }

    // Set the greyscale image back on the canvas.
    oContext.putImageData(oImageData,0,0);
    oCanvas.src = oCanvas.toDataURL();

} 
```

这是相关的HTML：

```
<canvas id="myCanvas" width="500" height="500"></canvas>

<div style="border: 1px solid black" onmouseover="convertToGreyscale('myCanvas')">Mouseover</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:41:30.670

就目前而言，您只是更改了 oRedPixel、oGreenPixel 和 oBluePixel 的值，但实际值`oPixelArray`保持不变。

尝试直接更改数组值

```
oPixelArray[iCount] = oGreyValue;
oPixelArray[iCount+1] = oGreyValue;
oPixelArray[iCount+2] = oGreyValue; 
```

而且你不需要这条线，因为画布没有`src`属性

```
// oCanvas.src = oCanvas.toDataURL(); 
```

# c# - 将颜色绑定到 ListPicker

> ID：14447721
> 
> 赞同：0
> 
> 时间：2013-01-21T21:39:37.633
> 
> 标签：c#, xaml, binding, windows-phone-7.1, listpicker

我正在尝试制作一个包含级别列表的 ListPicker 控件，每个级别旁边都有一个彩色方块。这就是我所拥有的：

```
<toolkit:ListPicker Grid.Row="1"
                    x:Name="LevelList"
                    Header="Level"
                    ItemCountThreshold="0"
                    FontFamily="Segoe WP Light">
  <toolkit:ListPicker.ItemTemplate>
    <DataTemplate>
      <StackPanel Orientation="Horizontal">
        <Rectangle Fill="{Binding}"
                   Width="43"
                   Height="43" />
        <TextBlock Text="{Binding}"
                   Margin="12 0 0 0" />
      </StackPanel>
    </DataTemplate>
  </toolkit:ListPicker.ItemTemplate>
  <toolkit:ListPicker.FullModeItemTemplate>
    <DataTemplate>
      <StackPanel Orientation="Horizontal"
                  Margin="16 21 0 20">
        <Rectangle Fill="{Binding}"
                   Width="43"
                   Height="43" />
        <TextBlock Text="{Binding}"
                   Margin="16 0 0 0"
                   FontSize="43"
                   FontFamily="{StaticResource PhoneFontFamilyLight}" />
      </StackPanel>
    </DataTemplate>
  </toolkit:ListPicker.FullModeItemTemplate>
</toolkit:ListPicker> 
```

在c#部分，我有

```
 String[] Level= { "E1", "E2", "E3", "E4", "E5"};
    String[] colors = { "#FFE5AD1B", "#FF0050EF", "#FFE51400", "#FF008A00", "#FFAA00FF" };

    public TolonPk()
    {
        InitializeComponent(); 
        this.listaNivel.ItemsSource = Level;
        this.listaNivel.ItemsSource = colors;
    } 
```

我的问题是我不知道如何将 Textblock 严格绑定到 Level String 数组并将矩形填充到颜色...我可能缺少一些简单的东西，但我似乎无法得到它.. .

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:56:33.293

如果 toolkit:ListPicker 像其他 WPF ItemsControl 子类一样使用它的 ItemsSource，那么您需要在同一个列表中同时拥有 Level 字符串和 Color 字符串。

制作一个包含级别字符串和颜色字符串的小结构/类。

```
public struct LevelAndColor
{
    public String Level { get; set; }
    public String Color { get; set; }
} 
```

创建一些 IEnumerable（列表、ObservableCollection 等）并用您的级别颜色对实例填充它。

在绑定中，像这样绑定：

```
<StackPanel Orientation="Horizontal">
    <Rectangle Fill="{Binding Color}" Width="43" Height="43"/>
    <TextBlock Text="{Binding Level}" Margin="12 0 0 0"/>
</StackPanel> 
```

# wordpress - 404 由于 WordPress mod_rewrite 规则？

> ID：14447722
> 
> 赞同：2
> 
> 时间：2013-01-21T21:39:40.377
> 
> 标签：wordpress, .htaccess, mod-rewrite

客户将 WordPress 安装添加到他们的文档根目录。之后，一个非 WordPress 目录给出了 404。

在浏览器中，您可以毫无问题地访问`/foo/facebook/index.php`，但如果您尝试访问 WordPress 404 页面，您将获得`/foo_admin/index.php`. Wordpress 位于 / 中（由于杂乱，此处未显示）。

这是 doc 根目录的整个 .htaccess：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

编辑：

刚刚意识到 /gcb_admin 中的基本身份验证 .htaccess 以某种方式干扰。现在已经尝试在基本身份验证指令之前和之后添加 RewriteEngine ，但这没有任何改变。删除基本身份验证指令允许访问文件...

```
AuthUserFile /home/foof/.htpasswd
AuthName "FOO Admin"
AuthType Basic

<Limit GET>
        require valid-user
</Limit>

RewriteEngine off 
```

我该如何纠正？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:50:45.907

试试这个解决方案——本质上，它只是关闭了特定目录中的重写引擎：

[http://wordpress.org/support/topic/exclude-directories-from-wp-rewrite](http://wordpress.org/support/topic/exclude-directories-from-wp-rewrite)

使用以下代码将文件添加`.htaccess`到您希望 Wordpress 重写忽略的目录：

```
RewriteEngine off 
```

或者，尝试更改您必须的最后一行：

```
RewriteRule ./ /index.php [L] 
```

# c# - 如何使项目版本独立？

> ID：14447723
> 
> 赞同：0
> 
> 时间：2013-01-21T21:39:42.450
> 
> 标签：c#, console-application, dll

我正在创建一个控制台应用程序。它使用第三方`.DLL`。我的电脑有最新版本（比如 2.3.0.0）。当我在其他 PC 上运行此应用程序（通过复制`.exe`文件）时，我*`FileNotFound exception`*发现它找不到`.dll`2.3.0.0 版。另一台 PC 的版本为 2.1.0.0，基于

我怎么知道，不要在运行时查找特定版本？

我知道编译时可以通过将*“特定版本”*设置为 false 来避免这种情况。但是运行时间呢？

# php - 为什么我的脚本缺少记录集的第一条记录？

> ID：14447726
> 
> 赞同：0
> 
> 时间：2013-01-21T21:40:04.527
> 
> 标签：php, odbc, record, missing-data

我得到了一个从数据库中检索值的小 PHP 脚本。它有效，但只是缺少记录集的第一条记录。

这是代码：

```
$conn = odbc_connect("database","user","passwd");

if (!$conn) {
   echo $php_errormsg;
   die("Connection failed");
}

$sql = "EXEC dbo.pr_stored_procedure param1, param2";

echo ("sql=". $sql."\n");
$rs=odbc_exec($conn,$sql);

while(odbc_fetch_row($rs)) {
   $item1 = odbc_result($rs,"item1");
   $item2 = odbc_result($rs,"item2"); 
   echo($item1 . " " .  $item2);
}

odbc_close($conn); 
```

我不明白为什么它会跳过第一行，因为这是非常基本的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T10:50:41.100

它可能是您使用的 ODBC 驱动程序或其他库中的错误。

您是否在该环境中执行类似查询或更改参数以返回不同数据集时遇到问题？

您已经从 ASP 编写了此查询，但也尝试在其他 ODBC 环境中执行它。我最喜欢的是带有模块的 ActivePython`odbc`或带有 JDBC-ODBC 桥的 Jython。您将在我的问题中找到此类代码的示例：[如何使用 ODBC 从 Informix 中的 varchar 列获取尾随空格](https://stackoverflow.com/questions/464567/how-to-get-trailing-spaces-from-varchar-column-in-informix-using-odbc)

也许第一排有什么特别之处？示例：如果第一列是日期时间，我已经看到用于 Linux 的 Informix ODBC 驱动程序返回第一行的空数据。

一旦您看到此查询在其他 ODBC 环境中工作，请尝试启用 ODBC 跟踪并将工作环境中的跟踪与 PHP 中的跟踪进行比较。

# git - 撤消与除一个文件之外的所有内容相关的提交

> ID：14447730
> 
> 赞同：0
> 
> 时间：2013-01-21T21:40:23.013
> 
> 标签：git, github, fork, commit

我分叉了一个存储库并创建了一个我想稍后与原始存储库结合的文件。

但是，在此过程中，我一直在搞乱并编辑/创建/移动其他不相关的文件，这些文件进入了提交。

现在重要文件已准备好与原始存储库合并，我拥有与该文件无关的所有这些错误提交。

是否有某种方法可以撤消除特定文件之外的所有更改，回到过去的某个时间点？

* * *

作为参考，我将 chrome-storage-sync.js 文件添加到我的草坪椅包装器的分支中，用于 html5/js 客户端存储

[https://github.com/hayksaakian/lawnchair](https://github.com/hayksaakian/lawnchair)

我带有不良提交的拉取请求：

[https://github.com/brianleroux/lawnchair/pull/150](https://github.com/brianleroux/lawnchair/pull/150)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:43:17.643

这似乎回答了我的问题：

[http://jasonrudolph.com/blog/2009/02/25/git-tip-how-to-merge-specific-files-from-another-branch/](http://jasonrudolph.com/blog/2009/02/25/git-tip-how-to-merge-specific-files-from-another-branch/)

# java - Spring Rest 服务中的可选请求标头

> ID：14447731
> 
> 赞同：15
> 
> 时间：2013-01-21T21:40:32.327
> 
> 标签：java, web-services, spring, rest

我正在使用 Spring Restful Web 服务并具有带有请求标头的请求正文，如下所示：

```
@RequestMapping(value = "/mykey", method = RequestMethod.POST, consumes="applicaton/json")
public ResponseEntity<String> getData(@RequestBody String body, @RequestHeader("Auth") String authorization)  {
try {
    ....
} catch (Exception e) {
    ....
}
} 
```

我想再传递一个名为“X-MyHeader”的可选请求标头。如何在 Spring REST 服务中指定此可选请求标头？

另外，如何在响应标头中传递相同的值？谢谢！

更新：我刚刚发现我可以在请求标头中设置 required=false，这样一个问题就解决了。现在，剩下的唯一问题是如何在响应中设置标头？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2020-08-21T05:31:40.560

用`required=false`在你的`@RequestHeader`：

```
@RequestMapping(value = "/mykey", method = RequestMethod.POST, 
consumes="applicaton/json")
public ResponseEntity<String> getData(@RequestBody String body, 
@RequestHeader(value = "Auth", required = false) String authorization)  {
    try {
   ....
    } catch (Exception e) {
        ....
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-22T15:51:19.493

这个问题在这里得到了回答： [在 Spring MVC 中，如何在使用 @ResponseBody 时设置 mime 类型标头](https://stackoverflow.com/questions/4471584/in-spring-mvc-how-can-i-set-the-mime-type-header-when-using-responsebody)

下面是一个代码示例：[http ://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/mvc.html#mvc-ann-httpentity](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/mvc.html#mvc-ann-httpentity)

```
@RequestMapping("/something")
public ResponseEntity<String> handle(HttpEntity<byte[]> requestEntity) throws UnsupportedEncodingException {
  String requestHeader = requestEntity.getHeaders().getFirst("MyRequestHeader");
  byte[] requestBody = requestEntity.getBody();
  // do something with request header and body

  HttpHeaders responseHeaders = new HttpHeaders();
  responseHeaders.set("MyResponseHeader", "MyValue");
  return new ResponseEntity<String>("Hello World", responseHeaders, HttpStatus.CREATED);
} 
```

# php - php Mysqli 未定义函数

> ID：14447734
> 
> 赞同：1
> 
> 时间：2013-01-21T21:40:41.190
> 
> 标签：php, database, phpmyadmin, mysqli, connection

执行时

```
mysqli_bind_result(); 
```

我收到一条错误消息，提示“调用未定义的函数”。

我的代码如下所示：

```
$mysqli = new mysqli("localhost", "root", "", "*****");
if(isset($_POST['login'])){
    if($_POST['username']){
    if($_POST['password']){
    $username = $_POST['username'];
    $passwordtmp = $_POST['password'];
    $password = md5(md5($passwordtmp));
    //Connect to Database//
    if ($mysqli->connect_errno) {
            echo "Failed to connect to MySQL: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error;
    }
    //Check if user exist in database//
    $query = mysqli_query($mysqli,"SELECT * FROM users WHERE username = '$username'");
    $numrows = mysqli_num_rows($query);
    if($numrows == 1){
        if($stmt = mysqli_prepare($mysqli, "SELECT password FROM users WHERE username = '$username'")){
            mysqli_execute($stmt);
                    mysqli_bind_result($stmt,$passw);
                    while(mysqli_stmt_fetch($stmt)){
                        $pass = $passw;  
                    } 
```

附加信息：

1.  我使用与我的 mysql 数据库的相同连接将此代码从另一台计算机传输到我的笔记本电脑。

    ```
     $mysqli = new mysqli("localhost", "root", "", "*****"); 
    ```

    1.  我将确切的数据库复制到我的笔记本电脑上，我的电脑和笔记本电脑都在使用 wamp。

    2.  我想知道这是否可能是与数据库问题的连接，或者只是一个编码错误。但它在我原来的电脑上完美运行，没有任何问题。

先感谢您。我会感谢有用的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T21:42:41.823

您可能正在使用 PHP > 5.4，因为该函数`mysqli_bind_result`已在 PHP 5.4 中删除。

将其更改为[`mysqli_stmt_bind_result`](http://php.net/manual/en/mysqli-stmt.bind-result.php)应该可以解决您的问题。

```
mysqli_stmt_bind_result($stmt, $passw); 
```

# c# - 在 ac# 项目中使用未知 dll

> ID：14447736
> 
> 赞同：0
> 
> 时间：2013-01-21T21:40:49.393
> 
> 标签：c#, dllimport, code-reuse

我从我的计算机上的另一个程序中获得了一个 dll。根据它的名称，它可能具有我自己的 c# 项目所需的功能。它似乎也是用 c# 制作的。

是否可以找出其中的功能并使用它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:43:58.533

如果它是 C# DLL，那么您可以添加引用并使用它。如果它是本机 DLL，那么您需要进行一些逆向工程。

但是，您所描述的并不是开发软件的正常方式。要编写体面的软件，您需要为您使用的库提供良好的文档。试图猜测如何调用图书馆是灾难的根源。开发应该基于对您正在使用的工具的扎实而深刻的理解。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T21:43:26.093

如果您想深入了解 DLL（对于那些用 .NET 编写的涉及 IL 的人），Visual Studio 提供了[对象浏览器。](http://blogs.msdn.com/b/erikreitan/archive/2010/07/14/understanding-webmatrix-helpers-using-visual-studio-s-object-browser.aspx)

[对象浏览器截图 http://blogs.msdn.com/resized-image.ashx/__size/550x0/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-65-29/4774.wmob04.jpg](http://blogs.msdn.com/resized-image.ashx/__size/550x0/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-65-29/4774.wmob04.jpg)
^(*借用来自[这个 msdn 博客](http://blogs.msdn.com/b/erikreitan/archive/2010/07/14/understanding-webmatrix-helpers-using-visual-studio-s-object-browser.aspx)*)

但是，如果您需要更多控制权或希望不仅包含库，还希望能够查看源代码（在大多数情况下）并单步执行（调试），我建议使用[.NET Reflector](http://www.reflector.net)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T21:57:30.900

您可以`dll`在项目中引用您想要的内容，并使用它`Object Browser`来查看您可以访问哪些方法等。

**第 1 步：**添加参考

![在此处输入图像描述](../Images/8c8711ae2f24709df4401fe3ea794d20.png)

**第二步：**选择dll

![在此处输入图像描述](../Images/ed659511b7f298907a37c05d222585c8.png)

**第 3 步：**在对象浏览器中查看

![在此处输入图像描述](../Images/9852ab7f7c843b339dd3fda20e997fb1.png)

**第 4 步：**浏览图书馆

![在此处输入图像描述](../Images/9d1081a7fca282c7c388ffebee5a8862.png)

**第五步：**找到你需要的东西

快乐编码:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T21:43:39.157

绝对地！如果您可以通过右键单击项目引用，单击添加引用，然后浏览到它来将其添加为引用，那么它应该与您正在使用的 .NET 版本兼容。此时，尝试实例化它，看看是否可以在实例化上进行定义。习惯使用外部 dll 的粗略但有效的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-21T21:44:19.350

如果它确实是一个 C# DLL，那么您可以将其添加为项目的引用，然后使用对象浏览器查看它包含的命名空间和类。

# javascript - 在Javascript的匿名函数回调中修改对象属性的正确方法

> ID：14447737
> 
> 赞同：1
> 
> 时间：2013-01-21T21:40:52.090
> 
> 标签：javascript, node.js, function, sqlite, anonymous

我正在使用 Node.js + Express + nodejs-sqlite3 制作一个表单，提交时将在 slite3 数据库中插入一个新行。在查询成功时，我想写一些回复。

所以小问题只是：在 sqlite3.run() 的回调函数中修改将存储要显示的 html 的字符串

我读到了闭包，并通过方法传递一个对象来修改它自己的属性。但它似乎不起作用。它将传递对象的属性和方法，但回调函数结束时不会保留任何更改。我读到对象将作为参考传递，而不是副本。

这是代码：

```
app.post("/insert.html", function(req, res){
    function TheBody(){
        this.html = "";
        this.msg = "";
        this.num = "";
    }
    TheBody.prototype.add = function(string){
        this.html = this.html + string;
    }
    var body = new TheBody();

    body.msg = req.body.message;
    body.num = req.body.number;

    var insertCallback = function(data){
        return function(err){
            if( err != null){
                console.log("Can't insert new msg: " + err.message);
                data.add("ERROR-DB");                                               
            } else {
                console.log("Ok. Inserted: " + data.msg);
                console.log(data.html);
                data.add("OK - MSG: "+data.msg+" NUM: "+data.num);
                console.log(data.html);
            }
        };
    };                                                                                   

    var db = new lite.Database('database.db');
    var query = "INSERT INTO outbox (message, number) VALUES (?, ?)";
    db.run(query, [body.msg, body.num], insertCallback(body) );

    res.setHeader('Content-Type', 'text/html');
    res.setHeader('Content-Length', body.html.length);
    res.end(body.html);
} 
```

在服务器端，我会看到

```
Ok. Inserted: TestString
[Blank space since data.html still has no information]
OK - MSG: TestString NUM: TestNumber [Showing that indeed was modified inside the function] 
```

但是在客户端`res.end(body.html);`会发送一个空字符串。该对象未作为参考传递。

代码中缺少什么，以及我必须更改回调匿名函数中的字符串变量有哪些更简单的替代方法？

我已经知道如果它更简单，我可以`response.write()`直接在函数上编写。但是我发现只有在回调内部使用它才会起作用`response.end()`，否则（现在在外部）它将满足竞争条件，即缓冲区将在`sqlite3.run()`能够使用之前关闭`response.write()`。

-------- 已答复 --------

正如 Justin Bicknell 所暗示并由 George P 确认的那样。Nodejs-sqlite3 函数是异步运行的。所以我在调用回调之前结束了到客户端的流，因此没有打印任何内容。这是一个更多关于“这是 SPART-nodejs，所以根据事件编写你的东西”的问题，而不是逻辑问题。我发现这种编程有点复杂，但除了我之外没有人告诉我使用 nodejs。对于那些想知道如何对数据库的查询顺序进行排序的人，nodejs-sqlite3 函数返回一个用于链接下一个查询的数据库对象。

由于我***在每个处理的事件中只向客户端打印一次***信息，因此生成的对象以如下方式结束：

```
function TheBody(response){
    this.response = response;
}
TheBody.prototype.printAll = function(string){
    this.response.setHeader('Content-Type', 'text/html');
    this.response.setHeader('Content-Length', string.length);
    this.response.end(string);
} 
```

宁愿将所有代码弄乱很多 res.setHeader() 行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:53:40.110

默认情况下，node-sqlite3 方法是[并行](https://github.com/developmentseed/node-sqlite3/wiki/Control-Flow)（异步）运行的。这意味着您的代码正在经历这个时间线：

1.  您的代码调用`db.run(...)`
2.  您的代码调用`res.end(...)`
3.  `db.run`完成并调用您的回调。

这是关于 SO 的大量问题的来源，因此您几乎可以肯定找到比我在合理时间内在这里写的任何内容更好的答案。

我将从这里开始：[异步 Javascript 执行是如何发生的？什么时候不使用return语句？](https://stackoverflow.com/questions/7104474/how-does-asynchronous-javascript-execution-happen-and-when-not-to-use-return-st)

# svg - 放大的 svg 阴影

> ID：14447740
> 
> 赞同：2
> 
> 时间：2013-01-21T21:41:06.007
> 
> 标签：svg, svg-filters

以下代码显示带有阴影的箭头。该要求要求使阴影略大于箭头，以便如果箭头是直的并且直接指向前方，则可以在箭头的任一侧看到等量的阴影。我尝试创建两个仅在水平位置上有所不同但从未使其正常工作的阴影。

该要求要求阴影不模糊，因此通过添加模糊来“放大”不是一种选择。图像不应该看起来很逼真。

我已经有代码可以创建放大的、垂直移动的、黑色的箭头副本。我希望有一个更完善的解决方案，因为那是很多代码和冗余数据。

```
<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg id="785849135" width="960pt" height="720pt"
 viewBox="160 0 960 720"
 xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">
  <defs>
    <filter id='drop-shadow'>
      <!-- Shadow Offset -->
      <!-- EDIT: dx and dy to change the size of the shadow -->
      <feOffset     
        dx='-4'
        dy='4'
      />
      <!-- Shadow Blur -->
      <!-- EDIT: edit stdDeviation to change the shadow blurriness -->
      <!-- "0" is no blur -->
      <feGaussianBlur
        stdDeviation='0'
        result='offset-blur'
      />
      <!-- Color & Opacity -->
      <feFlood
        flood-color='black'
        flood-opacity='1'
        result='color'
      />      
      <!-- Clip color inside shadow -->
      <feComposite
        operator='in'
        in='color'
        in2='offset-blur'
        result='shadow'
      />      
      <!-- Put original object over shadow -->
      <feComposite
        operator='over'
        in='SourceGraphic'
        in2='shadow'
      />
    </filter>
    </defs>
      <g  filter='url(#drop-shadow)'>
        <path fill="#654114" stroke="#654114" stroke-width="0.0" d="M547.71777 390.23407 L 527.47506 392.82273 540.08449 392.79837 539.86309 393.17777 426.68945 586.88612 399.23955 630.62126 361.53130 686.78918 337.97979 720.00000 362.91010 720.00000 391.19683 720.00000 410.65441 686.73793 441.43435 630.48495 463.47400 586.70712 552.51368 393.15324 552.68787 392.77403 565.28519 392.74969 547.71777 390.23407 z"/>
      </g>
</svg> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:49:39.283

据我了解，您不需要模糊效果，而是需要实心箭头。也许仍然使用`<feGaussianBlur>`使箭头“更大”，然后添加一个`<feColorTransfre>`来调整 Alpha 通道，基本上使整个模糊区域成为实心。

```
<svg id="785849135" width="960pt" height="720pt"
 viewBox="160 0 960 720"
 xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">
  <defs>
    <filter id='drop-shadow'>
      <!-- Shadow Offset -->
      <!-- EDIT: dx and dy to change the size of the shadow -->
      <feOffset     
        dx='-4'
        dy='4'
      />
      <!-- Shadow Blur -->
      <!-- EDIT: edit stdDeviation to change the shadow blurriness -->
      <!-- "0" is no blur -->
      <feGaussianBlur
        stdDeviation='1'
        result='offset-blur'
      />
      <!-- Color & Opacity -->
      <feFlood
        flood-color='black'
        flood-opacity='1'
        result='color'
      />      
      <!-- Clip color inside shadow -->
      <feComposite
        operator='in'
        in='color'
        in2='offset-blur'
        result='shadow'
      />      
      <!-- Put original object over shadow -->
      <feComposite
        operator='over'
        in='SourceGraphic'
        in2='shadow'
      />
      <feComponentTransfer>
        <feFuncA type="linear" slope="99"/>
      </feComponentTransfer>
    </filter>
    </defs>
      <g  filter='url(#drop-shadow)'>
        <path fill="#654114" stroke="#654114" stroke-width="0.0" d="M547.71777 390.23407 L 527.47506 392.82273 540.08449 392.79837 539.86309 393.17777 426.68945 586.88612 399.23955 630.62126 361.53130 686.78918 337.97979 720.00000 362.91010 720.00000 391.19683 720.00000 410.65441 686.73793 441.43435 630.48495 463.47400 586.70712 552.51368 393.15324 552.68787 392.77403 565.28519 392.74969 547.71777 390.23407 z"/>
      </g>
</svg>
```

^(顺便说一句，我认为您的`<svg>`元素的 ID 无效。AFAIK，它必须以字母或下划线开头。)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T02:44:00.977

这应该产生你想要的（或者至少我认为你想要的）。就像 Thomas 建议的那样，它使用了高斯模糊——但仅限于 x 方向。然后它使用组件传输将除了模糊边缘之外的所有部分的 alpha 值调高到 1 - 这基本上是单独存在的。如果你不这样做，你最终会得到一个锯齿状的边缘（你实际上是在手动对阴影边缘进行抗锯齿处理）。另一个 feFunc 将颜色调低为黑色。享受。

```
<svg id="785849135" width="960pt" height="720pt"
 viewBox="160 0 960 720"
 xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">
  <defs>
    <filter id='drop-shadow'>
      <!-- Shadow Offset -->
      <!-- EDIT: dx and dy to change the position of the shadow -->
      <feOffset     
        dx='-2'
        dy='4'
      />
      <!-- Shadow Blur -->
      <!-- EDIT: edit stdDeviation to change the shadow width -->
      <!-- "0 0 " is no blur -->
      <feGaussianBlur
        stdDeviation='3 0'
        result='offset-blur'
      />

      <feComponentTransfer in="offset-blur" result="shadow">
          <feFuncA type="table" tableValues="0 1 1 1 1 1 1 1 1 1 1 1 1 1"/>
          <feFuncR type="discrete" tableValues="0"/>
          <feFuncG type="discrete" tableValues="0"/>
          <feFuncB type="discrete" tableValues="0"/>

        </feComponentTransfer>
      <!-- Put original object over shadow -->
      <feComposite
        operator='over'
        in='SourceGraphic'
        in2='shadow'
      />
    </filter>
    </defs>
      <g filter="url(#drop-shadow)">
        <path fill="#654114" stroke="#654114" stroke-width="1" d="M547.71777 390.23407 L 527.47506 392.82273 540.08449 392.79837 539.86309 393.17777 426.68945 586.88612 399.23955 630.62126 361.53130 686.78918 337.97979 720.00000 362.91010 720.00000 391.19683 720.00000 410.65441 686.73793 441.43435 630.48495 463.47400 586.70712 552.51368 393.15324 552.68787 392.77403 565.28519 392.74969 547.71777 390.23407 z"/>
      </g>
</svg> 
```

# visual-c++ - 列出可用的平台工具集

> ID：14447742
> 
> 赞同：9
> 
> 时间：2013-01-21T21:41:08.520
> 
> 标签：visual-c++, visual-studio-2012, msvcrt

有什么方法可以列出 VS2012 中可用的平台工具集吗？我的意思是一个可能包含 v90、v100、v110、v110_xp 和任何外部提供的平台工具集的列表。或者（应该更容易）：有没有办法检查是否安装了给定的平台工具集？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-09T16:07:16.223

这是一个控制台应用程序实用程序（在 C# 中），它转储工具集列表（对于每个可用配置）。您需要添加对`Microsoft.Build`才能进行编译的引用。请注意，正确的工具集列表应该取决于要构建的项目：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;

namespace ListToolsets
{
    class Program
    {
        static void Main(string[] args)
        {
            if (args.Length == 0)
            {
                Console.WriteLine("Format is ListToolsets <project file path>");
                return;
            }

            foreach (var toolset in PlatformToolset.GetPlatformToolsets(args[0]))
            {
                Console.WriteLine(toolset.Platform);
                foreach (string ts in toolset.Toolsets)
                {
                    Console.WriteLine(" " + ts);
                }
            }
        }

    }

    public class PlatformToolset
    {
        private PlatformToolset()
        {
            Toolsets = new List<string>();
        }

        public string Platform { get; private set; }
        public IList<string> Toolsets { get; private set; }

        public static IList<PlatformToolset> GetPlatformToolsets(string projectPath)
        {
            var list = new List<PlatformToolset>();
            var project = new Microsoft.Build.Evaluation.Project(projectPath);
            AddPlatformToolsets(project, @"$(VCTargetsPath14)\Platforms", list);
            AddPlatformToolsets(project, @"$(VCTargetsPath12)\Platforms", list);
            AddPlatformToolsets(project, @"$(VCTargetsPath11)\Platforms", list);
            AddPlatformToolsets(project, @"$(VCTargetsPath10)\Platforms", list);
            return list;
        }

        private static void AddPlatformToolsets(Microsoft.Build.Evaluation.Project project, string path, IList<PlatformToolset> list)
        {
            string platforms = Path.GetFullPath(project.ExpandString(path));
            if (!Directory.Exists(platforms))
                return;

            foreach (string platformPath in Directory.GetDirectories(platforms))
            {
                string platform = Path.GetFileName(platformPath);
                PlatformToolset ts = list.FirstOrDefault(t => t.Platform == platform);
                if (ts == null)
                {
                    ts = new PlatformToolset();
                    ts.Platform = platform;
                    list.Add(ts);
                }

                foreach (string toolset in Directory.GetDirectories(Path.Combine(platformPath, "PlatformToolsets")))
                {
                    string name = Path.GetFileName(toolset);
                    string friendlyName = project.GetPropertyValue("_PlatformToolsetFriendlyNameFor_" + name);
                    ts.Toolsets.Add(string.IsNullOrWhiteSpace(friendlyName) ? name : friendlyName);
                }
            }
        }
    }
} 
```

# wcf - 为什么 InstanceContextMode.Single 服务会在关闭时处理单例？

> ID：14447746
> 
> 赞同：0
> 
> 时间：2013-01-21T21:41:20.097
> 
> 标签：wcf, singleton, servicehost, objectdisposedexception, instancecontextmode

我有一个装饰为 InstanceContextMode.Single 的 WCF (4.0) 服务，实现该服务的类遵循单例模式。

我首先使用 Instance 属性创建我的服务实现的单例实例。然后我将此单个实例传递给 ServiceHost 的构造函数，而不是使用带有 typeof() 参数的构造函数。

我可以在服务上执行 Open()，然后可以执行 Close()，一切都很好。但显然在 Close() 上，它以某种方式处理了我的单例 (???)，因为当我在同一个 ServiceHost 上再次尝试 Open() 时，抛出了 ObjectDisposedException。

我的服务由 Windows 窗体应用程序中的 NetTcpBInding 托管。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T06:38:41.533

不支持重新打开同一个 ServiceHost。您需要创建一个新的 ServiceHost。

ServiceHost 实现 ICommunicationObject 状态机。从[了解状态变化](http://msdn.microsoft.com/en-us/library/ms789041.aspx)：

> 当处于关闭状态时，对象基本上已经到达状态机的末尾。一旦一个对象从一个状态转换到下一个状态，它就不会回到之前的状态。

# php - 使用 jQuery，我在不刷新浏览器的情况下提交了一个表单，我需要帮助在自定义表列中列出提交的数据

> ID：14447755
> 
> 赞同：0
> 
> 时间：2013-01-21T21:41:53.467
> 
> 标签：php, jquery

我有一个表，它的行是由 foreach 循环生成的。

每个表格行有两列，一列是表单，另一列是表单提交的数据，我称之为注释。（并使用 jQuery 库进行更新而不刷新浏览器）。

```
<script>
    $(".notes_column").each(function(){

            var $myform = $(this).find('.notes_form');
            var $mynotes = $(this).find('.notes');

            $myform.validate({
                submitHandler: function(form) {
                    $.post('process.php', $myform.serialize(), function(data) {
                        $mynotes.html(data);
                    });
                }
            });

    }); // each function
</script>

<table id="myTable" class="tablesorter" border="1" cellpadding="5">
<thead> 
    <tr>
        <th>Notes</th>
        <th>Submit Note</th>
    </tr>
</thead>
<tbody>
<?php
    foreach($myarray as $myvar){
        echo ' 
            <tr>
                <td>ID LIKE TO PLACE THE content of the div class="notes"  HERE, HOW CAN I DO IT?</td>
                <td class="notes_column">
                    <form class="notes_form" action="" method="post">
                        <input class="q" type="text" name="notes" size="30" placeholder="Place your notes here..." />
                        <input class="searchsubmit" type="submit" name="submit" value="Submit" />
                    </form>
                    <div class="notes"></div>
                </td>
            </tr>
        ';
    }
?>
</tbody> 
</table> 
```

现在我使用一个 jQuery **each 函数**，它遍历每个表列，并且对于每个具有类名**“.notes_column”**的列，使用提交的数据填充一个带有**类“notes”的 div。**

**问题在代码中以大写字母列出**，**如何用表单提交的数据填充另一列？**

有任何想法吗？

泰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:46:03.597

将每个选择器更改为 $('#myTable tr')，然后您可以遍历表中的每个。

然后您可以在 tr 对象上执行 each 来访问每个 td，或者在后续选择器中使用 jQuery 的 :first-child 和 nth-child(2) 等

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:01:43.477

```
I would create a <div> in the first <td> such as

<td>
    <div class="put_notes_here">ID LIKE TO PLACE THE content of the div class="notes"  HERE, HOW CAN I DO IT?</div>
</td>

Then populate it the same as you did before
$mynotes.closest("tr").find(".put_notes_here").html(data); 
```

# ruby-on-rails - 了解“button_to”是如何工作的

> ID：14447767
> 
> 赞同：0
> 
> 时间：2013-01-21T21:43:04.210
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

在这段代码中：

```
<

    % @products.each do |product| %>
      <div class="entry">
        <%= image_tag(product.image_url) %>
        <h3><%= product.title %></h3>
        <p><%= sanitize(product.description) %></p>
        <div class="price_line">
          <span class="price"><%= number_to_currency(product.price) %></span>
    <!-- START_HIGHLIGHT -->
          <%= button_to 'Add to Cart', line_items_path(product_id: product),
            remote: true %>
    <!-- END_HIGHLIGHT -->
        </div>
      </div>
    <% end %> 
```

在底部我们有传递参数的 button_to 方法：

```
 <%= button_to 'Add to Cart', line_items_path(product_id: product),
        remote: true %> 
```

查看代码，这是我对正在发生的事情的理解，是我理解正确还是遗漏了什么？

> 在该代码中，我们正在创建一个带有“添加到购物车”文本的按钮，然后我们将 prodcut 变量的 product_id 传递给它，它来自顶部的 for-each 循环并告诉它转到 link_items 页面ID 为 product_id 的产品的 POST 方法。

**另一个问题：**在 lines_items_path 我们可以只传递 product.product_id 吗？或者那行不通？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:07:57.290

我刚刚明白你的另一个问题。答案是：代码将值赋给`product.id`符号`product_id`。该符号`product_id`将用于下一步（可能用于创建关联，其中的值`product_id`将成为键）。你的问题“为什么公正`product`，而不是`product.id`”将是合理的。答案在 Rails 框架的约定中——如果你想使用对象的 ID，你只需省略`.id`部分，Rails 就会正确猜测。

您不能通过`product.product_id`，因为模型 Product 没有`product_id`方法或属性（您更喜欢哪个）。它有`.id`.

请澄清你问题的第一部分。

编辑（问题的第一部分 - 一步一步）

`@products.each do |product|`- 循环遍历对象数组（@products 是对象数组，由控制器的操作组成，如下所示：`@products= Product.all`或类似）。在每一步，里面的代码都`do .. end`对局部变量进行操作`product`。这是一个对象，对应于数据库的一行，因此它具有“属性”（对应于列），如 product.id 、 product.name 等。

然后创建与提取的数据库行数一样多的按钮。

关于按下哪个按钮的信息由新变量携带（在这种情况下以符号的形式 - 一个特殊的 Ruby 术语，值得研究:)）因此，您将 product.id 的值分配给它，就像这样: `product_id: product.id`. 总结：你组成了局部变量`product_id`。此代码的旧样式：`:product_id => product`更具描述性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:21:57.047

我认为这是《[Agile Web Development with Rails](https://rads.stackoverflow.com/amzn/click/com/097669400X)》一书中的一个例子。我很久以前读过它...如果我没记错的话，有`products`,`orders`和`line_items`。

如果你打电话`rake routes`，你会发现，作为`line_items_path`POST，是. 更多细节：[CRUD 动词和动作](http://guides.rubyonrails.org/routing.html#crud-verbs-and-actions)`create``line_items_controller`

因此，您将传递`product_id`给 create 操作，您应该在其中具有以下内容：

```
def create
  product = Product.find(params[:product_id])
...
end 
```

# java - 如何将 args 传递给我在 Play 2 中编写的自定义方法？

> ID：14447770
> 
> 赞同：1
> 
> 时间：2013-01-21T21:43:10.830
> 
> 标签：java, scala, playframework, playframework-2.0

我在 Play Framework 2 scala 模板中编写了一个方法来生成日期/时间输入。我不知道如何将 html args 传递`_label`给它。

```
@dateField(field: Field, timeName: String)(implicit handler: FieldConstructor, lang: play.api.i18n.Lang) = {
    @input(field, '_showConstraints -> false) { (id, name, value, args) =>
        <input type="text" value="@value" name="@name" @toHtmlArgs(args)>
        <input type="text" value='@eventForm(timeName).value()' name="@timeName" />
    }
} 
```

我希望能够调用它来生成一个没有标签的字段：

```
@dateField(eventForm("event.endDate"), "event.endTime", '_label -> "") 
```

我需要做什么才能使它起作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:40:58.793

您必须定义一个 vargs 字段。在 Scala 中，这由星号表示。有关更多详细信息，请参阅[此答案](https://stackoverflow.com/questions/1008783/using-varargs-from-scala)。

您的代码将如下所示：

```
@dateField(field: Field, timeName: String, more: (Symbol, Any)*)(implicit handler: FieldConstructor, lang:  play.api.i18n.Lang) = {
  @input(field, ('_showConstraints -> false :: more.toList) : _*) { (id, name, value, args) =>
    <input type="text" value="" name="@name" @toHtmlArgs(args)>
  }
} 
```

# java - Android 异步任务重用

> ID：14447780
> 
> 赞同：6
> 
> 时间：2013-01-21T21:43:39.737
> 
> 标签：java, android, asynchronous

我正在开发一个应用程序，在许多活动中我需要通过 Http 检索数据。一旦我有了数据，我就会在 onPostExecute() 回调方法中处理它。

如果我将异步任务定义为内联类，这可以正常工作，但由于我想在许多活动中进行相同的处理，我将其定义为外部类。

所以问题是，使用外部类如何将“事件”发回给调用类，作为将数据传回的一种方式。我知道如何在 C# 中做到这一点，但我是 Java 新手，看不到如何实现这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T22:52:07.443

虽然 Listener 在技术上是正确的，但我认为它要么太复杂，要么不够复杂。

这是一个更简单的解决方案：

```
class Foo {
   class Bar extends AsyncTask<Void, Void, Result> {

      public void onPostExecute(Result res) {
         doSomething(res);
      }
   }

   public void doSomething(Result res) {
      /// process result
   }

   public void startTask() {
       new Bar().execute();
   }
} 
```

相当于：

```
class Bar extends AsyncTask<Void, Void, Result> {
     private final Foo foo;
     public Bar(Foo foo) { this.foo = foo; }

     public void onPostExecute(Result res) {
       foo.doSomething(res);
     }
}

class Foo {
   public void doSomething(Result res) {
      /// process result
   }

   public void startTask() {
       new Bar(this).execute();
   }
} 
```

...这就是您所问的：当您将内部类拉出时，您会丢失隐式指针。只需使其明确并传入即可。

坏消息是这种解决方案会引发各种内存泄漏和生命周期问题。我**强烈**建议您在程序变得更大之前，考虑使用 IntentService 而不是 AsyncTask 并使用 Handler 或 Activity.runOnUiThread 将结果返回到 UI 线程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T21:54:52.920

一种方法：

定义一个父抽象类`ParentActivity`（当然是扩展Activity）。让它包含一个名为的抽象方法`onAsyncCallback();`

让每个使用该任务的类扩展该类并实现该方法。

在您的 AsyncTask 构造函数中，让它接受`ParentActivity`.

例如

```
ParentActivity activity;
public MyTask (ParentActivity myActivity)
{
 this.activity = myActivity;
} 
```

完成后`onPostExecute()`，只需执行

```
activity.onAsyncCallback(data); 
```

这也适用于接口，它做同样的事情，除了你让构造函数在侦听器实例中接受。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-18T01:39:58.387

如果您想以干净的方式进行操作，请尝试以下方法

首先创建一个包含所有异步调用名称的枚举

```
public enum TaskType {
    USER_LOGIN(1), GET_PRODUCTS(2), GET_EMPLOYEE(3);

    int value;

    private TaskType(int value) {
        this.value = value;
    }
} 
```

然后创建一个接口

```
public interface AsyncTaskListener {
    public void onTaskCompleted(String result, TaskType taskType);
} 
```

现在在您要调用 GetAsyncTask 的活动中实现此接口，例如：-

```
 public class LoginActivity extends Activity implements AsyncTaskListener {

 protected void onCreate(Bundle savedInstanceState) {
     String url = ".....";
     new GetAsyncTask(LoginActivity.this, LoginActivity.this, TaskType.USER_LOGIN).execute(url);
 }
    ...
    public void onTaskCompleted(String result, TaskType taskType) {
       if(taskType == TaskType.USER_LOGIN){
       //your login result handling here
       }
} 
```

最后，这是你的 AsyncTask

```
public class GetAsyncTask extends AsyncTask<String, Void, String> {
    String outputStr;
    ProgressDialog dialog;
    Context context;
    AsyncTaskListener taskListener;
    TaskType taskType;

    public GetAsyncTask(Context context, AsyncTaskListener taskListener, TaskType taskType){
        this.context = context;
        this.taskListener = taskListener;
        this.taskType = taskType;
    }

    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        dialog = ProgressDialog.show(context, "Loading", "Please wait...", true);
    }
    @Override
    protected String doInBackground(String... params) {
        String urlString = params[0];

        try {

            URL url = new URL(urlString);
            HttpURLConnection conn
                    = (HttpURLConnection) url.openConnection();
            conn.setConnectTimeout(5000);
            if (conn.getResponseCode() != 200) {
                throw new IOException(conn.getResponseMessage());
            }

            // Buffer the result into a string
            BufferedReader rd = new BufferedReader(
                    new InputStreamReader(conn.getInputStream()));
            StringBuilder sb = new StringBuilder();
            String line;
            while ((line = rd.readLine()) != null) {
                sb.append(line);
            }
            rd.close();
            conn.disconnect();
            String jsonStr = sb.toString();
            outputStr = jsonStr;
        } catch (SocketTimeoutException e) {
            outputStr = "timeout";
        }catch(Exception e){
            e.printStackTrace();
            outputStr = "error";
        }

        return outputStr;
    }

    @Override
    protected void onPostExecute(String result) {
        super.onPostExecute(result);
        taskListener.onTaskCompleted(result, taskType);
        dialog.dismiss();
    }

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T21:58:28.950

使用侦听器模式。看看这里[TaskListener](https://github.com/gobozov/myshows/blob/master/src/ru/myshows/tasks/TaskListener.java)，[使用这个监听器](https://github.com/gobozov/myshows/blob/master/src/ru/myshows/tasks/GetShowsTask.java)的任务和[调用任务的片段](https://github.com/gobozov/myshows/blob/master/src/ru/myshows/fragments/ShowsFragment.java)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-30T11:03:17.020

尝试制作您自己的扩展 AsyncTask 的 http 请求类，然后​​将您的代码放在“doInBackground”调用中。你只需要用 url 和 params 实例化你的类并读取响应。这对我有用。

这是示例：

```
public class HttpRequest extends AsyncTask<String, Void, String> {
    public String url;
    public List<NameValuePair> nameValuePairs;
    public String httpResponse =null;

    public HttpRequest(String _url, List<NameValuePair> _nameValuePairs) {
        url = _url;
        nameValuePairs=_nameValuePairs;
    }

    @Override
    protected String doInBackground(String... params) {
        httpResponse = getWebPageWithFormData(url, nameValuePairs);
        return "";
    }

    public static String getWebPageWithFormData( String url, List<NameValuePair> nameValuePairs ){
        String html = "";
        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost(url);
        if (nameValuePairs!=null){
            try {httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));}
            catch (Exception e){}
        }
        HttpResponse response = null;
        try {
            response = httpclient.execute(httppost);
        }
        catch (ClientProtocolException e) { return ""; }
        catch (IOException e) { return ""; }
        int responseCode = response.getStatusLine().getStatusCode();
        switch(responseCode) {
            case 200:
                HttpEntity entity = response.getEntity();
                if(entity != null) {
                    try{ html = EntityUtils.toString(entity);}
                    catch (Exception e) {}
                }
                break;
        }
        return html;
    }
} 
```

# opengl - OpenGL C 代码适用于 Mac OS X，但不适用于 Linux

> ID：14447782
> 
> 赞同：0
> 
> 时间：2013-01-21T21:43:47.113
> 
> 标签：opengl, x11

我是一名新手 C 程序员，这是我第一次使用图形。我得到了一些代码，其中包含一些在我的 MacBook Pro（运行 OS X 版本 10.6.8）上正常工作的 OpenGL 功能，但它无法在运行 Linux（CentOS 版本 2.16.0）的办公机器上编译。在这两种情况下，我都使用 gcc。在 Mac 上编译时，我通过了以下选项：

```
-lcurses -lX11 -lGL -lm -fast 
-I/usr/X11R6/include/ -I/usr/X11R6/include/GL -L/usr/X11R6/lib 
-L/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries 
-Wl,-dylib_file,/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib:/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib 
```

尝试使用以下选项在 Linux 上编译时

```
-lcurses -lX11 -lGL -lm 
```

我收到以下错误

```
cem_master.c:159: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
cem_master.c:160: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
cem_master.c:161: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token 
```

它指的是以下代码行：

```
static WINDOW *mainwnd;
static WINDOW *screen;
WINDOW *my_win; 
```

关于什么是错的任何想法？关于如何理解这一点的提示？

* * *

作为对评论的回应，这里是从第一行到导致错误的部分的源代码的简化版本。*我在 include 和 / Display Crap* / 部分之间删掉了很多垃圾，但这仍然会产生错误。

```
#include <stdlib.h>      
#include <stdio.h>
#include <math.h>
#include <time.h>
#include <GL/glx.h>
#include <GL/gl.h>
#include <unistd.h>

/* Display Crap */
static WINDOW *mainwnd;
static WINDOW *screen;
WINDOW *my_win;

float   xcellwidth;
float   ycellwidth;
int     current_getch;
int     xplotoff;
int     yplotoff;

Display                 *dpy;
Window                  root;
XVisualInfo             *vi;
Colormap                cmap;
XSetWindowAttributes    swa;
Window                  win;
GLXContext              cx;
XEvent                  event; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T21:49:11.123

`WINDOW`并且`SCREEN`来自`ncurses`图书馆。你需要`#include <ncurses.h>`使用它。

# json - 在 JSONException 之后读取请求正文

> ID：14447783
> 
> 赞同：1
> 
> 时间：2013-01-21T21:43:48.410
> 
> 标签：json, grails

我有一个 Grails 控制器，它接受带有 JSON 主体的 POST 请求。在某些请求中，JSON 格式不正确，我收到 JSONException。如何获取请求正文以记录或检查它（我并不总是可以访问客户端）？Grails`request.JSON`已经使用了流，所以看起来我无法通过 request.body 访问它。

这是我的控制器操作：

```
def setScore(ScoreCommand scoreCommand) {
   try {
      def context = request.JSON.optJSONObject("context")
      userService.updateContext(context)
   } catch (ConverterException ce) {
      log.error("Error parsing JSON")
      // I want to log the malformed JSON body
   }
   def scoreResponse
   if (!scoreCmd.validate()) {
      scoreResponse = errorResponse(scoreCommand)
   } else {
      def scoreResult = gameService.setScore(scoreCommand)
      scoreResponse = buildResponse(scoreResult)
   }
   render scoreResponse as JSON
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T02:34:51.300

这行得通吗？

```
def json = request.JSON

try {
  def context = json.optJSONObject("context")
  userService.updateContext(context)
}catch(e) {
  log.error json.toString()
} 
```

# javascript - CSS 高度依赖于其他 div 高度

> ID：14447786
> 
> 赞同：0
> 
> 时间：2013-01-21T21:44:01.873
> 
> 标签：javascript, css

我有一个网站，顶部有水平菜单和子菜单。下面是主要的 div 和页脚。我想将我的子菜单最大高度设置为等于主 div 高度（每个页面上的高度不同，具体取决于内容）以不让它超过页脚。是否可以根据其他元素属性设置元素的 css 属性？

预先感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:43:10.483

这可以通过 CSS 和其他 HTML 代码来解决。

我很想建议您使用[clearfix hack](http://www.webtoolkit.info/css-clearfix.html)，但我不会，而是建议您使用[另一个答案中描述并在](https://stackoverflow.com/a/9932508/358906)[JS Bin](http://jsbin.com/eciwev/27/edit)中演示的此解决方案进行调查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:57:11.617

您可以在页面加载后通过脚本设置菜单的最大高度。使用 JQuery 的示例：

```
var mainDivHeight = $('#mainDiv').css('height');
//manipulate the height as you want if it is different than the maindiv's height
var menuHeight = mainDivHeight - 50;
$('#menuDiv').css('max-height', 'menuHeight'); 
```

# c# - 如何检测何时将项目添加到 ListBox？

> ID：14447802
> 
> 赞同：-3
> 
> 时间：2013-01-21T21:45:02.147
> 
> 标签：c#, winforms, listbox

我已经翻遍了，什么也找不到。我找到的唯一解决方案是在添加项目时手动调用该函数，但这效率低下，我知道这是可能的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:00:30.433

将逻辑包装在一个单独的类中。这样，您只需调用一段代码，但您也可以知道何时添加项目。

.NET 列表框控件没有与此相关的事件。唯一的其他选择是将列表框子类化并手动收听。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:17:13.437

`ListBox.Items`在您的情况下，将集合绑定到一个`ObservableCollection`以便您可以订阅该`CollectionChanged`事件不是更容易吗？

# git-pull - 为什么需要将分支名称放在 git pull remote 如果更新的分支是你在哪里？

> ID：14447804
> 
> 赞同：1
> 
> 时间：2013-01-21T21:45:02.987
> 
> 标签：git-pull

当我从一个分支执行 git“pull origin master”时，分支会更新，而不是 master。为了更新主人，我需要做一个“git checkout master”，然后调用“git pull origin master”。如果更新发生在当前分支而不一定是主分支，为什么命令中需要“主控”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:02:06.760

因为它指定了要与当前分支合并的远程分支。所以`git pull origin master`字面意思是：在`origin`远程定义的 URL 上查询存储库，检查它的`master`分支，下载我需要的任何内容，以便在我的存储库中拥有该分支的副本（将保存为名为 的分支`origin/master`），然后将该分支合并到任何分支我恰好在此刻。

# javascript - 将日期和时间转换为 UNIX 时间

> ID：14447805
> 
> 赞同：0
> 
> 时间：2013-01-21T21:45:05.583
> 
> 标签：javascript, datetime, unix-timestamp

我有 3 个数字文本字段，分别是天、小时和分钟。我以这样一种方式编写脚本，即用户只能为每个字段输入 2 位数字。

有人可以帮我将这 3 个字段组合成一个整数（这是一个 UNIX 时间），以便我可以将它作为单列时间保存在数据库中。

**HTML**

```
<table><tr>
<td><input id='days' type='text' maxLength='2' placeholder='Days'></td>
<td><input id='hours' type='text' maxLength='2' placeholder='hours'></td>
<td><input id='min' type='text' maxLength='2' placeholder='Min'></td>
</tr></table> 
```

**JavaScript**

```
var day = document.getElementById('days').value;
var hours = document.getElementById('hours').value;
var min = document.getElementById('min').value; 
```

如何将这 3 个变量（天、小时、分钟）组合成一个 unix 时间变量并将其保存在数据库中。（我知道如何将它保存在数据库中，但是？如何组合 3 个变量并将其保存在单个 JavaScript 变量中？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:47:53.510

为此，我正在使用您要使用当前月份和年份吗？您需要将字段发布到您的 PHP 脚本并用于[`strtotime`](http://php.net/manual/en/function.strtotime.php)制定时间戳：

```
$timestamp = strtotime(date('Y-M') . '-' . $_POST['days'] . ' ' . $_POST['hours'] . ':' . $_POST['min']); 
```

或者，使用 JavaScript：

```
var d = new Date();
var ts = Math.round((new Date(d.getFullYear(), d.getMonth(), $('#day').val(), $('#hours').val(), $('#min').val())).getTime() / 1000); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:03:37.367

[Unix 时间戳](http://en.wikipedia.org/wiki/Unix_time)是自 unix 纪元开始以来的秒数。

[javascript Date 对象](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)有一个 getTime 方法，它返回自 unix 纪元开始以来的毫秒数。

因此，如果您希望在客户端计算值：

```
var time = new Date(0,0,day,hours,min);
var milliseconds = time.getTime();
var seconds = milliseconds / 1000; 
```

我没有包括如何将值发送到服务器并将其保存到数据库的示例 - 这完全取决于您使用的服务器端技术，并且快速 google 或 stackoverflow 搜索将帮助您完成这部分。

# java - 带有简单 HTMLserializer 的 NullPointerException

> ID：14447807
> 
> 赞同：0
> 
> 时间：2013-01-21T21:45:08.757
> 
> 标签：java, android, html, html-parsing, htmlcleaner

我正在尝试从`TagNode`. 问题是，有一个内部异常阻止它工作。这是我的电话：

```
CleanerProperties props = new CleanerProperties();
SimpleHtmlSerializer serializer = new SimpleHtmlSerializer(props);
changes.setHtmlForTimetable(serializer.getAsString(root)); 
```

root 当然不为空，显然序列化器也不为空。

这是堆栈跟踪：

```
01-21 23:42:50.860: W/System.err(25196): java.lang.NullPointerException
01-21 23:42:50.865: W/System.err(25196):    at org.htmlcleaner.HtmlSerializer.isMinimizedTagSyntax(HtmlSerializer.java:54)
01-21 23:42:50.875: W/System.err(25196):    at org.htmlcleaner.HtmlSerializer.serializeOpenTag(HtmlSerializer.java:189)
01-21 23:42:50.880: W/System.err(25196):    at org.htmlcleaner.SimpleHtmlSerializer.serialize(SimpleHtmlSerializer.java:52)
01-21 23:42:50.885: W/System.err(25196):    at org.htmlcleaner.Serializer.write(Serializer.java:249)
01-21 23:42:50.890: W/System.err(25196):    at org.htmlcleaner.Serializer.getAsString(Serializer.java:176)
01-21 23:42:50.900: W/System.err(25196):    at org.htmlcleaner.Serializer.getAsString(Serializer.java:197)
01-21 23:42:50.905: W/System.err(25196):    at org.htmlcleaner.Serializer.getAsString(Serializer.java:206)
01-21 23:42:50.915: W/System.err(25196):    at com.roneven.blich.GetChanges$1$1$1.callback(GetChanges.java:125)
01-21 23:42:50.920: W/System.err(25196):    at com.roneven.blich.GetChanges$1$1$1.callback(GetChanges.java:1)
01-21 23:42:50.930: W/System.err(25196):    at com.androidquery.callback.AbstractAjaxCallback.callback(AbstractAjaxCallback.java:501)
01-21 23:42:50.935: W/System.err(25196):    at com.androidquery.callback.AbstractAjaxCallback.afterWork(AbstractAjaxCallback.java:1269)
01-21 23:42:50.940: W/System.err(25196):    at com.androidquery.callback.AbstractAjaxCallback.run(AbstractAjaxCallback.java:993)
01-21 23:42:50.945: W/System.err(25196):    at android.os.Handler.handleCallback(Handler.java:725)
01-21 23:42:50.945: W/System.err(25196):    at android.os.Handler.dispatchMessage(Handler.java:92)
01-21 23:42:50.950: W/System.err(25196):    at android.os.Looper.loop(Looper.java:137)
01-21 23:42:50.950: W/System.err(25196):    at android.app.ActivityThread.main(ActivityThread.java:5191)
01-21 23:42:50.955: W/System.err(25196):    at java.lang.reflect.Method.invokeNative(Native Method)
01-21 23:42:50.955: W/System.err(25196):    at java.lang.reflect.Method.invoke(Method.java:511)
01-21 23:42:50.960: W/System.err(25196):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:795)
01-21 23:42:50.960: W/System.err(25196):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:562)
01-21 23:42:50.965: W/System.err(25196):    at dalvik.system.NativeStart.main(Native Method) 
```

更新：我找到了一种解决方法，甚至没有使用 HtmlSerializer 或 TagNode （使用我已经成功提取的 html 和一些字符串命令）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:09:59.943

根据来自[HtmlCleaner](http://htmlcleaner.sourceforge.net)的消息，`HtmlSerializer.isMinimizedTagSyntax()`调用`CleanerProperties.getTagInfoProvider()`. 而在`CleanerProperties.java`

```
ITagInfoProvider tagInfoProvider = null;
...
public ITagInfoProvider getTagInfoProvider() {
    return tagInfoProvider;
} 
```

没有办法设置它`CleanerProperties`。`tagInfoProvider`必须以某种方式设置，然后再使用它。

我认为，要找出方法，您必须深入研究 HtmlCleaner 的文档，例如[Java 代码使用](http://htmlcleaner.sourceforge.net/javause.php)中提供的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T08:43:16.350

我也遇到了同样的问题，花了很多时间寻找解决方案。

```
CleanerProperties props = new CleanerProperties() {

    @Override
    public ITagInfoProvider getTagInfoProvider() {
        return DefaultTagProvider.getInstance();
    }

};

HtmlSerializer simpleHtmlSerializer = new SimpleHtmlSerializer(props);
String message = simpleHtmlSerializer.getAsString(tagNode, true); 
```

# objective-c - 将坐标保存到字符串中

> ID：14447812
> 
> 赞同：0
> 
> 时间：2013-01-21T21:45:29.967
> 
> 标签：objective-c, coordinates, cllocation

在这里扯我的头发我需要将值作为一个字符串放入一个数组中，这里有人建议我这样设置......

```
[twitterLocation addObject:[NSString stringWithFormat:@"%g,%g", latitude, longitude]]; 
```

但是，这是行不通的。纬度、经度在我的日志中包含值，但不会合并到字符串和数组中 - 它返回为 NULL。我的纬度，经度设置为双倍谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:24:39.797

阅读评论我猜你至少需要分配你的数组：

```
double lat = 0.3231231;
double lon = 0.4343242;
NSMutableArray *twitterLocation = [[NSMutableArray alloc]init];
[twitterLocation addObject:[NSString stringWithFormat:@"%g%g", lat, lon]]; 
```

如果您跳过分配，则可变数组没有用于保存对象的内存位置。

# matlab - Matlab中的边界框（regionprops）

> ID：14447813
> 
> 赞同：2
> 
> 时间：2013-01-21T21:45:35.373
> 
> 标签：matlab, bounding-box, image-segmentation

我正在编写一个 Matlab 程序来分割图像，然后在分割后的图像周围放置一个边界框。我的代码以前可以工作，但是我现在收到错误：

> *   使用矩形时出错
> *   值必须是 4 元素向量

有问题的数组是由 regionprops 创建的 BoundingBox，它*应该*只包含四个元素，但是由于某种原因包含更多元素。这是我的代码（defaultSegment 函数返回二进制图像）：

```
function [ boundImage ] = boundSegment( input_image )
image = defaultSegment(input_image);
clear s;
s = regionprops(image, 'Area', 'BoundingBox');
numObj = numel(s);
index = 1;
for k = 1: numObj-1
    if s(k+1).Area > s(index).Area
        index = k+1;
    else
        index = index;
    end
end
figure, imshow(input_image);
rectangle('Position',s(index).BoundingBox);
boundImage = null; 
```

（如果我的代码可以直接将边界框放在图像上而不是绘制它，我实际上更喜欢它，但我还没有找到没有视觉工具箱的方法）

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:21:37.627

我怀疑它`image`有两个以上的维度。检查使用`size(image)`. 只有当有两个维度`BoundingBox`时才会有四个元素。`image`来自[Matlab 的 regionprops 帮助](http://www.mathworks.com/help/images/ref/regionprops.html#bqkf8hf)：

> 'BoundingBox' - 包含该区域的最小矩形，一个 1×Q *2 向量，其中 Q 是图像维度的数量：ndims(L)、ndims(BW) 或 numel(CC.ImageSize)。

图像具有三维的原因是用于多个颜色通道。如果要转换为灰度进行处理，请使用[rgb2gray](http://www.mathworks.com/help/images/ref/rgb2gray.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T19:34:27.330

继续@shoelzer 关于`image`三个通道的回答，我怀疑您得到彩色图像是因为您的分割算法 ( `defaultSegment`) 将每个段绘制成不同的颜色。尝试[`rgb2ind`](http://www.mathworks.com/help/matlab/ref/rgb2ind.html)转换`image`为分割标签的二维矩阵

# graph - 在有向图中包含一条边的循环“覆盖”

> ID：14447817
> 
> 赞同：1
> 
> 时间：2013-01-21T21:45:44.670
> 
> 标签：graph, cycle, cover

我想知道是否存在针对以下问题的快速算法。给定一个有向图 G，可能带有循环（即在同一顶点开始和结束的边）和 G 中边 e 的选择，G 中包含 e 和承认一个顶点不相交的循环覆盖。

# python - 用相同长度的字符串替换正则表达式

> ID：14447818
> 
> 赞同：11
> 
> 时间：2013-01-21T21:45:45.400
> 
> 标签：python, regex

我想用与标记字符数相同的重复字符序列替换 XML 标记。

例如：

```
<o:LastSaved>2013-01-21T21:15:00Z</o:LastSaved> 
```

我想将其替换为：

```
#############2013-01-21T21:15:00Z############## 
```

我们如何使用 RegEx 呢？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-21T21:49:09.377

[`re.sub`](http://docs.python.org/2/library/re.html#re.sub)接受一个函数作为替换：

> ```
> re.sub(pattern, repl, string, count=0, flags=0) 
> ```
> 
> If`repl`是一个函数，每次出现不重叠的模式时都会调用它。该函数采用单个匹配对象参数，并返回替换字符串。

这是一个例子：

```
In [1]: import re

In [2]: def repl(m):
   ...:     return '#' * len(m.group())
   ...: 

In [3]: re.sub(r'<[^<>]*?>', repl,
   ...:     '<o:LastSaved>2013-01-21T21:15:00Z</o:LastSaved>')
Out[3]: '#############2013-01-21T21:15:00Z##############' 
```

我使用的模式可能需要一些修饰，我不确定匹配 XML 标记的规范解决方案是什么。但你明白了。

# c# - 如何使用 XDocument 和 XElement 将 XML 作为单独的值返回

> ID：14447819
> 
> 赞同：0
> 
> 时间：2013-01-21T21:45:47.073
> 
> 标签：c#, .net, xml, linq

我正在尝试使用 XDocument 和 XElement 从 XML 文档中获取值。我正在尝试获取三个值，但是当我尝试返回它们时，它们会合并为一个值。这是我正在搜索的 XML：

```
<create_maint_traveler>     
<Paths>
        <outputPath value="D:\Intercim\DNC_Share\itcm\DataInput\MCDHeaderDrop\" />
        <outputPath_today value="D:\Intercim\DNC_Share\itcm\DataInput\Today\" />
        <log value="D:\Intercim\DNC_Share\itcm\Log\CreateMaintLog.log" />
    </Paths>
</create_maint_traveler> 
```

这是我查询值的方式：

```
XDocument config = XDocument.Load(XML);
            foreach (XElement node in config.Root.Elements("Paths"))
            {
                if (node.Name == "outputPath") outputPath = node.Value;
                if (node.Name == "outputPath_today") outputPath = node.Value;
                if (node.Name == "log") outputPath = node.Value;
            } 
```

当我输出到文件时，我发现返回的值是

```
D:\Intercim\DNC_Share\itcm\DataInput\MCDHeaderDrop\D:\Intercim\DNC_Share\itcm\DataInput\Today\D:\Intercim\DNC_Share\itcm\Log\CreateMaintLog.log 
```

否则将一无所有。我在标签之外有 XML 文件中的值，之前返回了一个 long 值。我对如何分别返回 outputPath、outputPath_today 和日志值感到困惑。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:54:21.640

尝试：

```
var xDoc = XDocument.Load(XML);
var paths = xDoc.Root.Elements("Paths");

var res = from p in paths
          select new
                     {
                         outputPath = p.Element("outputPath").Attribute("value").Value,
                         outputPath_today = p.Element("outputPath_today").Attribute("value").Value,
                         log = p.Element("log").Attribute("value").Value
                    };

 foreach(path in res)
 {
      System.Console.WriteLine(path.outputPath);
      System.Console.WriteLine(path.outputPath_today);
      System.Console.WriteLine(path.log);
      // or do anything you want to do with those properties
 } 
```

您将获得`outputPath`,`outputPath_today`和`log`匿名`IEnumerable`对象的值。这些对象每个都将具有属性`outputPath`，`outputPath_today`并且`log`具有从 XML 填充的值。

# input - 使用多个输入框按“输入”

> ID：14447821
> 
> 赞同：2
> 
> 时间：2013-01-21T21:46:00.500
> 
> 标签：input, enter

我有一个带有几个输入框和相应的输入按钮的 HTML 表单。当我在第一个输入框中输入内容并按下`Enter`或按钮时，它工作正常。但是，如果我按下`Enter`其他盒子，它就像在第一个盒子里一样工作。按钮工作正常。

这是我的代码：

```
<script type="text/javascript">
  function fn (num) {
    alert(num);
    document.getElementById(num).focus();
  }
</script>
</head>
<body>
<form>
  <input id="1" type="text"></input> <button onclick="fn(1);">press</button><br/>
  <input id="2" type="text"></input> <button onclick="fn(2);">press</button><br/>
  <input id="3" type="text"></input> <button onclick="fn(3);">press</button><br/>
</form> 
```

显然这是 ECMA 中的一个“怪癖”（我在 FF18.0.1 和 Safari 5.1.7 中进行了测试）。这个怪癖有解决办法吗？

我发现的一种解决方案是为每个输入框添加一个表单。

```
<form>
  <input id="1" type="text"></input> <button onclick="fn(1);">press</button><br/>
</form>
<form>
  <input id="2" type="text"></input> <button onclick="fn(2);">press</button><br/>
</form>
<form>
  <input id="3" type="text"></input> <button onclick="fn(3);">press</button><br/>
</form> 
```

这是错误还是功能？有更好的解决方案吗？感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:53:00.383

您需要使用 onKeyPress 而不是 onClick。尝试这个：

```
function myKeyPress(args) {
  if ((e.which && e.which == 13) || (e.keyCode && e.keyCode == 13)) {
    // do something here (enter has been pressed)
  }
  else {
    return false; // somehow prevents "default" form behaviors
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:51:07.857

尝试这个 ：

```
$("id").keypress(function(e) {
    if(e.which == 13) {
        respective functions
    }
}); 
```

或者

```
 <input type="text" name="q" id="q" 
        onkeypress="if (event.keyCode == 13) {call function}" /> 
```

# sass - Sass mixin 默认参数、插值、引用等 Compass box-shadow()

> ID：14447825
> 
> 赞同：0
> 
> 时间：2013-01-21T21:46:34.477
> 
> 标签：sass, compass-sass, mixins

我正在尝试做这个混合

```
@mixin dshadow($one: #{2px 3px 3px rgba(222,222,222, 0.3) false}, $two: #{-1px -1px 3px rgba(222,222,222, 0.3) false}){ 
@include box-shadow($one, $two);    
} 
```

我试过插值和不插值，但我没有得到它。我根本没有阴影CSS。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:20:20.810

如果你放弃`false`，那么它可以在没有插值的情况下工作。不知道为什么它会导致 Sass 窒息。颜色应该是 box-shadow 值中的最后一项（参见：[https](https://developer.mozilla.org/en-US/docs/CSS/box-shadow) ://developer.mozilla.org/en-US/docs/CSS/box-shadow ）

```
@import "compass/css3/box-shadow";

@mixin dshadow($one: 2px 3px 3px rgba(222,222,222, 0.3), $two: -1px -1px 3px rgba(222,222,222, 0.3)) { 
    @include box-shadow($one, $two);    
}

.test {
    @include dshadow;
} 
```

生成：

```
.test {
  -webkit-box-shadow: 2px 3px 3px rgba(222, 222, 222, 0.3), -1px -1px 3px rgba(222, 222, 222, 0.3);
  -moz-box-shadow: 2px 3px 3px rgba(222, 222, 222, 0.3), -1px -1px 3px rgba(222, 222, 222, 0.3);
  box-shadow: 2px 3px 3px rgba(222, 222, 222, 0.3), -1px -1px 3px rgba(222, 222, 222, 0.3);
} 
```

# java - 将带有自定义参数的 Java 构造函数转换为 Objective-C 代码

> ID：14447826
> 
> 赞同：0
> 
> 时间：2013-01-21T21:46:37.183
> 
> 标签：java, ios, objective-c, variables, constructor

我正在将 OpenGL java 应用程序转换为 Objective-C。这是来自我的 java 构造函数的构造函数副本，该构造函数来自一个名为 AmbientMovement 的文件：

```
public class AmbientMovement {

private final float         FPS;

private final Frame[]               FRAMES;
private final int           NUMBER_FRAMES;
private final float         CYCLE;
private final Random            RANDOM;
private int             indexAmbient;
private float               timeAmbient;
private float               timeCurrent;

public AmbientMovement(Frame[] frames, float fps) {

    this.FPS              = fps;

    this.FRAMES           = frames;
    this.NUMBER_FRAMES    = frames.length;

    Frame lastframe       = frames[this.NUMBER_FRAMES - 1];
    this.CYCLE            = lastframe.getTime() + lastframe.getDuration();
    this.RANDOM           = new Random();

    this.resetClock();
} 
```

这是我尝试使用 iOS 6 和 X-Code 4.5 的 Objective-c 编写代码：

环境运动.h

```
 #import "VA-Frame.h"
    #import "VA-TRSet.h"
    #import "VA-Morph.h"
    #import "VA-Quaternion.h" 
    #import "math.h"

    @interface VA_AmbientMovement : NSObject{

    /* Private members */
    @private {
        @property float const*  FPS;
        @property int const*    NUMBER_FRAMES;
        @property float const*  CYCLE;
        @property int           indexAmbient;
        @property float         timeAmbient;
        @property float         timeCurrent;
    }

} 
```

环境运动.m

```
#import "VA_AmbientMovement.h"

@implementation VA_AmbientMovement

/* Initialise the AmbientMovement constructor */
-(id)initAmbientMovement:(Frame[])frames AndFPS :(float)fps{
    self=[super init];
    if(self){
        FPS                 = 0;
        NUMBER_FRAMES       = 0;
        CYCLE               = 0;
        indexAmbient        = 0;
        timeAmbient         = 0;
        timeCurrent         = 0;

        Frame* frame = [[Frame alloc]      initAmbientManager:frames AndFPS:fps];
        TRSet* trset = [[TRSet alloc]      initAmbientManager:frames AndFPS:fps];
        Morph* morph = [[Morph alloc]      initAmbientManager:frames AndFPS:fps];
        Quaternion* quat   = [[Quaternion alloc]    initAmbientManager:frames AndFPS:fps];
    }
    return self;
};

-(id)init{
    return [self initAmbientMovement:0 AndFPS: 0];
}; 
```

我感到困惑的主要事情之一是如何传递类类型的参数。在 java 中，这是通过“Frame[] 帧”完成的。我可以使用以下行“（Frame []）aframes”在objective-c中执行此操作还是我犯了错误？

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T21:50:11.807

你在那里的东西会很好用——但通常在objective-c中传递数组时，你会想要使用an`NSArray`或an`NSMutableArray`而不是c风格的数组。

# asp.net-mvc - OnMetadataCreated 执行多次

> ID：14447830
> 
> 赞同：0
> 
> 时间：2013-01-21T21:46:53.570
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor

我正在设置自定义属性以保护视图中的对象。这是我的自定义属性的定义：

```
[AttributeUsage(AttributeTargets.Property)]
public class SecureObjectAttribute : Attribute, IMetadataAware
{
    public void OnMetadataCreated(ModelMetadata metadata)
    {
        if(!metadata.AdditionalValues.ContainsKey("isSecure"))
        {
            if (ObjectId == 1)
            {
                metadata.AdditionalValues.Add("isSecure", true);
            }
            else
            {
                metadata.AdditionalValues.Add("isSecure", false);
            }
        }
    }
    public int ObjectId { get; set; }
} 
```

这是我的视图模型：

```
public class HomeViewModel
{
    [SecureObject(ObjectId = 1)]
    [Display(Name = "Name")]
    public string Name { get; set; }

    [Display(Name = "Address")]
    public string Address { get; set; }
} 
```

我正在为安全标签和安全文本框定义助手。这是我的辅助函数：

```
 public static MvcHtmlString SecureLabelFor<TModel, TProperty>(this HtmlHelper<TModel> html, Expression<Func<TModel, TProperty>> expression)
    {
        var metadata = ModelMetadata.FromLambdaExpression(expression, html.ViewData);
        if ((bool)metadata.AdditionalValues["isSecure"])
        {
            return null;
        }
        else
        {
            return html.LabelFor(expression);
        }
    }

    public static MvcHtmlString SecureTextBoxFor<TModel, TProperty>(this HtmlHelper<TModel> html, Expression<Func<TModel, TProperty>> expression)
    {
        var metadata = ModelMetadata.FromLambdaExpression(expression, html.ViewData);
        if ((bool)metadata.AdditionalValues["isSecure"])
        {
            return null;
        }
        else
        {
            return html.TextBoxFor(expression);
        }
    } 
```

所有这些都正常工作，但是，我遇到的问题是每次定义安全标签和安全文本框时，都会调用 OnMetadataCreated 方法。

我正在 OnMetadataCreated 方法（示例中未显示）上访问数据库以获取对象的权限，并且我想避免单个对象的重复行程。

以下是导致 OnMetadataCreated 在我的视图中被调用两次的代码示例：

```
    @Html.SecureLabelFor(m => m.Name)
    @Html.SecureTextBoxFor(m => m.Name)

```

关于如何避免第二次调用 OnMetadataCreated 方法或避免重复访问数据库的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T08:22:26.147

您可以将查询的执行结果存储在 HttpContext 中，以避免在同一请求中往返于数据库：

```
public void OnMetadataCreated(ModelMetadata metadata)
{
    // TODO: if you are using a DI framework you could pass the context
    // as a constructor argument dependency and use HttpContextBase
    HttpContext context = HttpContext.Current;

    bool isSecure;
    string key = "isSecure_" + ObjectId;
    if (context.Items.Contains(key))
    {
        // The isSecure value was found in the HttpContext => 
        // no need to query the database once again within this request
        isSecure = (bool)context.Items[key];
    }
    else
    {
        // Get the value from the database
        isSecure = GetFromDb(context.User.Identity.Name, ObjectId);
        // and store into the HttpContext to avoid roundtrips to the database
        // within this request
        context.Items[key] = isSecure;
    }

    ...
} 
```

# ios - 固定 5 行的 UITableView

> ID：14447834
> 
> 赞同：0
> 
> 时间：2013-01-21T21:47:24.680
> 
> 标签：ios, objective-c

我正在开发一个需要一直显示 5 行数据的应用程序。行的数据来自一个`NSArray`字符串。可以为空，`NSArray`也可以最多包含 5 个元素。我想强制`UITableView`一直显示 5 行。我试过了，当`NSArray`只有 1 个元素时，由于我定义了 5 行 ( `numberOfRowsInSection`)，iOS 会引发异常。如何`UITableView`在不引发异常的情况下始终显示 5 行（分组、单行）？另外，如何使节标题居中？我正在使用`titleForHeaderInSection`方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:51:07.890

在您的`cellForRowAtIndexPath`中，您需要实现基于`NSArray`字符串大小的逻辑。

使用 查找字符串的总数`[NSArray count]`。然后，检查是否`indexPath.row`小于`[NSArray count]`并使用标准实现，从数组中获取字符串`indexPath.row`作为索引。如果`indexPath.row`不小于`[NSArray count]`，那么您可以将单元格保持为空（并且不要尝试从数组中检索任何内容）。那么你不会有那个例外。

对于标题标题，这有效吗？ [https://discussions.apple.com/thread/2539133?start=0&tstart=0](https://discussions.apple.com/thread/2539133?start=0&tstart=0)

替换`UITextAlignmentCenter`为`NSTextAlignmentCenter`。

它通过使用`viewForHeaderInSection`和返回居中的`UILabel`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:54:19.127

1.  要显示 5 行，您应该在 numberOfRowsInSection 中返回常量 5 并在方法中`cellForRowAtIndexPath`生成您的空单元格`if indexPath.row >= [array count]`。
2.  要在中心显示标题，请使用

```
- (UIView*)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section 
```

# ios - 使用 Devise 通过 iOS 应用注册、登录和退出

> ID：14447835
> 
> 赞同：2
> 
> 时间：2013-01-21T21:47:31.170
> 
> 标签：ios, objective-c, ruby-on-rails, devise

我有一个非常基本的 Rails 应用程序，它使用 Devise 进行用户注册、登录等。我想将 Devise 暴露给 iOS 应用程序。有很多线程是高级解释，但我对 Rails 很陌生。我基本上是向 users/sign_up 发布请求，如下所示：

```
AFHTTPClient *client = [AFHTTPClient clientWithBaseURL:[NSURL URLWithString:@"http://localhost:5000"]];
//[client defaultValueForHeader:@"Accept"];
[client setParameterEncoding:AFJSONParameterEncoding];
NSDictionary *params = [NSDictionary dictionaryWithObjects:[NSArray arrayWithObjects:
                                                            @"first.last@gmail.com",
                                                            @"testtest",
                                                            @"testtest",
                                                            nil]
                                                   forKeys:[NSArray arrayWithObjects:
                                                            @"email",
                                                            @"password",
                                                            @"password_confirmation",
                                                            nil]];

[client registerHTTPOperationClass:[AFHTTPRequestOperation class]];
NSURLRequest *request = [client requestWithMethod:@"GET" path:@"/users/sign_up" parameters:params];
AFHTTPRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
    NSLog(@"%@", JSON);
    NSLog(@"%@", [response allHeaderFields]);
} failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON) {
}];

[operation setAcceptableContentTypes:[NSSet setWithObjects:@"application/json", @"text/json", @"text/javascript", @"text/plain",@"text/html", nil]];
[operation start]; 
```

当我收到 200 OK 时，这似乎在 iOS 端进行：

```
 2013-01-21 13:38:00.412 Starfish[35773:c07] I 
restkit.network:RKHTTPRequestOperation.m:152 GET 'http://localhost:5000/signup?password=testtest&password_confirmation=testtest&email=first.last%40gmail.com'
2013-01-21 13:38:01.073 Starfish[35773:c07] (null)
2013-01-21 13:38:01.073 Starfish[35773:7207] I restkit.network:RKHTTPRequestOperation.m:179 GET 'http://localhost:5000/signup?password=testtest&password_confirmation=testtest&email=first.last%40gmail.com' (200 OK) [0.6611 s]
2013-01-21 13:38:01.074 Starfish[35773:c07] {
    "Cache-Control" = "max-age=0, private, must-revalidate";
    Connection = close;
    "Content-Type" = "text/html; charset=utf-8";
    Etag = "\"5dfe88700e41a015a8f524850446e327\"";
    Server = "thin 1.5.0 codename Knife";
    "Set-Cookie" = "_geo-photo_session=BAh7B0kiD3Nlc3Npb25faWQGOgZFRkkiJTEyZTJjMjFkZjAwZGZlMWIzMTJmNTg5ODNkNjM5OGI0BjsAVEkiEF9jc3JmX3Rva2VuBjsARkkiMTN4eUZGUzVhb1pIdXc1QlJJUnBxSFVrZmYvUDdpeGtaeklxNGhOejFOeEk9BjsARg%3D%3D--5130edc939facbe7004570141c069d40f5f7feca; path=/; HttpOnly";
    "X-Request-Id" = a2480798afed4e7aca17f3f1e2d3d44d;
    "X-Runtime" = "0.219984";
    "X-UA-Compatible" = "IE=Edge";
} 
```

在 Rails 方面：

```
Started GET "/signup?password=[FILTERED]&password_confirmation=[FILTERED]&email=first.last%40gmail.com" for 127.0.0.1 at 2013-01-21 13:38:00 -0800
13:43:15 web.1  | Processing by Devise::RegistrationsController#new as */*
13:43:15 web.1  |   Parameters: {"password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]", "email"=>"first.last@gmail.com"}
13:43:15 web.1  |   Rendered devise/shared/_links.erb (2.1ms)
13:43:15 web.1  |   Rendered devise/registrations/new.html.erb within layouts/application (23.7ms)
13:43:15 web.1  | Completed 200 OK in 142ms (Views: 64.9ms | ActiveRecord: 6.9ms) 
```

开箱即用注册：

```
<h2>Sign up</h2>

<%= form_for(resource, :as => resource_name, :url => registration_path(resource_name)) do |f| %>
  <%= devise_error_messages! %>

  <div><%= f.label :email %><br />
  <%= f.email_field :email, :autofocus => true %></div>

  <div><%= f.label :password %><br />
  <%= f.password_field :password %></div>

  <div><%= f.label :password_confirmation %><br />
  <%= f.password_field :password_confirmation %></div>

  <div><%= f.submit "Sign up" %></div>
<% end %>

<%= render "devise/shared/links" %> 
```

我不知道 Rails 足以解决的问题是我不希望呈现任何视图。我只是想将注册或登录凭据作为 JSON 对象传递并接收用户已创建或登录的验证。我上面的内容不是创建用户，因为它正在尝试呈现视图。任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-10T17:07:07.827

我正在做类似的事情，到目前为止，它的注册部分是通过 CURL 使用 JSON（应该很容易转换为 iOS）以及通过浏览器工作的。使用[NeverBe](https://stackoverflow.com/users/1025520/neverbe)[对此答案](https://stackoverflow.com/questions/14792746/create-a-user-account-with-devise-via-a-native-ios-app "这个答案")的修改：

我修改了**config/initializers/devise.rb**并添加了以下行：

```
config.navigational_formats = ["*/*", "/", :html, :json] 
```

* * *

我修改**了 config/routes.rb**并替换了这一行：

```
devise_for :users 
```

用这条线：

```
devise_for :users, :controllers => {:registrations => "registrations"} 
```

* * *

我创建了一个新文件**app/controllers/registrations_controller.rb**

```
class RegistrationsController < Devise::RegistrationsController

  def create
    respond_to do |format|
      format.html {
        super
      }
      format.json {
        if params[:user][:email].nil?
          render :status => 400,
                 :json => {:message => 'User request must contain the user email.'}
          return
        elsif params[:user][:password].nil?
          render :status => 400,
                 :json => {:message => 'User request must contain the user password.'}
          return
        end

        if params[:user][:email]
          duplicate_user = User.find_by_email(params[:user][:email])
          unless duplicate_user.nil?
            render :status => 409,
                   :json => {:message => 'Duplicate email. A user already exists with that email address.'}
            return
          end
        end

        @user = User.create(params[:user])

        if @user.save
          render :json => {:user => @user}
        else
          render :status => 400,
                 :json => {:message => @user.errors.full_messages}
        end
      }
    end
  end
end 
```

附加说明：即使没有所有自定义错误处理代码，您仍然可以获得错误处理，但我想返回状态代码错误（400 和 409）而不是带有自定义错误消息的 200，这是我从默认设计行为中得到的。

# c# - 使用 AND 和 OR

> ID：14447837
> 
> 赞同：2
> 
> 时间：2013-01-21T21:47:34.413
> 
> 标签：c#, mongodb

试图获得一个同时具有`AND`并`OR`在 C# 中工作的查询。

在 SQL Server 中会是这样的：

```
... where (Code = 'abc' OR Description = 'def') AND (Flag = 0) 
```

使用 MongoVUE，我似乎已经可以使用它了：

```
{ "$or" : [{ "Description" : /def/i }, { "Code" : /abc/i }], "$and": [{ "Flag" : 0 }] } 
```

但似乎无法用 C# 得到它：试过这个：

```
List<IMongoQuery> qryValue = new List<IMongoQuery>();
qryValue.Add(Query.EQ("Code", "abc"));
qryValue.Add(Query.EQ("Description", "def"));
qryValue.Add(Query.And(Query.EQ("Flag", 1)));
var query = Query.Or(qryValue.ToArray()); 
```

但把这个拿回来：

```
{ "$or" : [{ "Code" : "abc" }, { "Description" : "def" }, { "Flag" : 1 }] } 
```

这并没有给出正确的结果：缺少`AND`部分。

任何人都可以帮助解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T21:57:18.733

你把它拿回来了，因为你把你所有的东西都`Query.EQ`放在`Query.Or`了最后一行。将单个值传递给 a`Query.And`不会做任何事情；就像您将单个值传递给任何其他方法一样。你没有用任何东西和-ed它。

您需要像上面在 SQL 中那样用代码编写它：**尊重括号**。

首先将您`Or`组合在一起，并将其作为第一个参数传递给`And`，然后是单个附加子句 for `Flag`。

```
var clauses = new[] { Query.EQ("Code", "abc"), Query.EQ("Description", "def") };
var query = Query.AND(Query.OR(clauses), Query.EQ("Flag", 1)) 
```

像这样的东西应该工作。

# javascript - 在 IE8 上安装 Chrome Frame

> ID：14447838
> 
> 赞同：0
> 
> 时间：2013-01-21T21:47:38.817
> 
> 标签：javascript, google-chrome, google-chrome-frame

尝试在 WindowsXP SP3、IE8 上安装 Chrome Frame，使用以下命令：

```
<script src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script>

  $('#chrome1').on('click',function(e) {
      e.preventDefault();
      CFInstall.check({
        mode: "overlay",
        url: "http://www.google.com/chromeframe/eula.html?user=true",
        destination: "www.mysite.com"
    });
  }); 
```

在安装过程中，我得到“此内容无法在框架中显示”。由于谷歌推荐的安装方法（http://www.chromium.org/developers/how-tos/chrome-frame-getting-started），我想知道为什么我会得到这个？

# get - 在 bigCouch 中通过一个请求获取多个文档

> ID：14447840
> 
> 赞同：1
> 
> 时间：2013-01-21T21:47:49.443
> 
> 标签：get, bulk, bigcouch

我试图在 bigCouch 中通过一个请求（http://wiki.apache.org/couchdb/HTTP_Bulk_Document_API#Fetch_Multiple_Documents_With_a_Single_Request）获取多个文档，但它似乎没有按预期工作，它返回数据库中的所有文档. 相同的请求和相同的数据在 couchDB 中工作。bigCouch 不支持吗？

请求是：http://xxxx:5984/database/_all_docs?keys=["test"]

# javascript - 如何通过 Javascript 检测 Android 上的“完成”键盘操作

> ID：14447842
> 
> 赞同：2
> 
> 时间：2013-01-21T21:48:07.897
> 
> 标签：javascript, android

我有一个移动网络应用程序，其中有一个 HTML5 输入字段（类型=数字）。在默认 Galaxy S3 浏览器上，键盘上的“完成”按钮不会触发该字段上的“模糊”事件。（这在 Iphone 上运行良好）。我需要知道如何在 Android 上捕获 'done' 事件。任何人都知道如何实现这一目标？

提前致谢。

# asp.net - 使用 T-SQL 创建 SimpleMember 用户帐户 - 如何对密码进行哈希处理？

> ID：14447843
> 
> 赞同：2
> 
> 时间：2013-01-21T21:48:11.640
> 
> 标签：asp.net, sql-server, tsql, simplemembership

可以从 SQL Server Management Studio 创建简单会员用户帐户吗？

在运行应用程序时，我发现的用于创建用户/帐户的唯一方法是在 C# 中：

```
WebSecurity.CreateUserAndAccount("userName", "password",
                        new
                        {
                            ...
                        }, false); 
```

有什么方法可以生成可用于 t-SQL 的简单成员资格的散列密码？简单会员哈希密码的要求是否已知？我找到了使用 DefaultMembershipProvider 生成密码的其他方法，但密码与 Simple Membership 不兼容。

编辑：我希望找到一个类似的过程：

```
declare @salt nvarchar(128)
declare @password varbinary(256)
declare @input varbinary(512)
declare @hash varchar(64)

-- Change these values (@salt should be Base64 encoded)
set @salt = N'eyhKDP858wdrYHbBmFoQ6DXzFE1FB+RDP4ULrpoZXt6f'
set @password = convert(varbinary(256),N'mypassword')

set @input = hashbytes('sha1',cast('' as  xml).value('xs:base64Binary(sql:variable(''@salt''))','varbinary(256)') + @password)
set @hash = cast('' as xml).value('xs:base64Binary(xs:hexBinary(sql:variable(''@input'')))','varchar(64)') 
```

可用于简单会员资格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:55:27.560

我认为最简单的方法是创建然后导入一个简单的 .NET 程序集并在 Sql Server 中使用它。
[http://msdn.microsoft.com/en-us/library/ms189876.aspx](http://msdn.microsoft.com/en-us/library/ms189876.aspx)

会员服务使用 .NET 的系统和加密库的配置来生成单向哈希 AFAIK，因此在 t-sql 中重做同样的事情并非易事。

# java - 在不减慢结果页面的情况下调用 doPost() 中的方法

> ID：14447845
> 
> 赞同：1
> 
> 时间：2013-01-21T21:48:24.747
> 
> 标签：java, servlets

下面的 index.html 调用（下面的）servet 的 doPost 以查看 url 是否在拍卖中可用。一切运行良好。但是，我希望*在页面重定向之后*从其他类执行两个附加方法。我的问题是其他两种附加方法需要很长时间才能完成，所以我不能将它们直接放在 response.sendRedirect 之后，因为它们会保留初始响应。

如何立即发送重定向（如下所示），然后调用其他两个需要在 doPost 中找到的相同字符串数据变量才能操作的方法？

**索引.html**

```
<html>
<head>
<title>URL Auction Search Page</title>
</head>
<body>
<CENTER>
 <FORM ACTION="/ResultServlet/Results" METHOD=GET>
   <INPUT TYPE=TEXT NAME="st">
   <INPUT TYPE=SUBMIT VALUE=Submit>
  </FORM>
</CENTER>
</body>
</html> 
```

**小服务程序**

```
@WebServlet("/Results")
public class Results extends HttpServlet {
    private static final long serialVersionUID = 1L;
       public static String str="";

    private String businessLogic(String q){
        try {
            str = new compute.URL.GetAvailURI( "https://www.registerdomains.com/auctionAPI/Key:a05u3***1F2r6Z&urlSearch="+q);
            /*more boring number crunching */
            return str;
            }
/*
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
    }
*/
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        Results r = new Results();
        String st = request.getParameter("st");
    String data = r.businessLogic(st);
        response.sendRedirect("results/resultActionURL.html?st="+data);
//IDEALLY I WOULD LIKE TO CALL outsideMethod1(data) and outsideMethodTWO(data) HERE 
    //BUT IT TAKES TOO LONG. HOW CAN I RUN THEM W/O SLOWING DOWN THE RESPONSE 
             //(LIKE A ProcessBuilder call to a shell for example where there's almost a handoff)
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:03:33.140

在单独的线程中执行这些方法。

```
public class Results extends HttpServlet{
...
  private Thread t;
  private volatile String myResult;
...
  protected void doPost(...){
  ...
      t = new Thread(){
        public void run(){
          myResult = outsideMethod1(data);
        }
      }
      t.start();
  }
} 
```

然后在您想要返回结果的方法中：

```
t.join();
String result = myResult;
... 
```

同样对于外部方法二

# sql-server - Log-Shipping：为什么要选择 No Recovery 模式？

> ID：14447847
> 
> 赞同：19
> 
> 时间：2013-01-21T21:48:27.703
> 
> 标签：sql-server, standby, log-shipping

在为 SQL Server 配置 LogShipping 时，您可以选择辅助数据库处于无恢复模式或待机模式。无恢复意味着在进行日志传送时您无法访问数据库。Standby 为您提供只读访问权限，如果您选择在恢复即将发生时断开用户连接的选项，似乎不会干扰日志传送过程。在我看来，这就像待机模式的额外好处，但据我所见，文档没有提到任何不利影响。

因此，我想知道为什么有人会选择使用无恢复模式？我能想到的唯一可能的原因是待机模式是否导致性能显着下降（但在文档中没有提到类似的事情），或者是否有一些安全要求来主动阻止任何人看到辅助数据库的内容（这似乎很少见/不太可能）。

谁能告诉我选择无恢复模式的好处应该是什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-21T21:59:49.540

使用`NORECOVERY`模式时，不会授予对目标数据库的访问权限，因此数据库不必关心未提交的事务。日志可以“按原样”恢复并保持该状态。

使用`STANDBY`mode 时，数据库恢复为`NORECOVERY`，然后分析并回滚日志中所有未提交的事务。然后它可以为用户提供只读访问权限。当下一个日志恢复时，数据库会断开所有用户的连接，并在恢复之前再次将上一个日志中未提交的事务向前滚动。

如您所见，`STANDBY`根据您的事务量，在还原时可能会有很大的额外开销。

更多详细信息，请参阅[My World of SQL 上的这篇文章](http://askmesql.blogspot.se/2011/01/log-shipping-norecovery-vs-standby-mode.html)。

# c# - 在 ASP.NET 应用程序中配置 WSE 3.0 值

> ID：14447849
> 
> 赞同：4
> 
> 时间：2013-01-21T21:48:36.627
> 
> 标签：c#, asp.net, web-services, configuration, wse3.0

我的 ASP.NET Web 应用程序通过引用程序集 Microsoft.Web.Services3.dll, v2.0.50727 来使用 WSE 3.0 协议

```
namespace Microsoft.Web.Services3
{
    public class WebServicesClientProtocol : SoapHttpClientProtocol
    {
        public WebServicesClientProtocol();

        ............
        public void SetPolicy(Policy policy);
        public void SetPolicy(string policyName);
        ............
    }
} 
```

我的问题特定于`SetPolicy(string policyName)` 当前字符串是从该策略的特定配置文件中获取的。

```
<policies xmlns="http://schemas.microsoft.com/wse/2005/06/policy">
  <extensions>
    <extension name="CertificateOverTransportSecurityAssertion" type="ABCD.ApplicationBlocks.WSSecurity.CertificateOverTransportSecurityAssertion, AAAA.ApplicationBlocks.WSSecurity" />
  </extensions>
  <policy name="ClientPolicy">
    <CertificateOverTransportSecurityAssertion clientCertificateSubjectDistinguishedName="E=xxxxx, CN=yyyyy, OU=zzzz, O=ssss, L=hhhhh, S=ee, C=ii"/>
  </policy>
</policies> 
```

我想从代码中进行配置。

```
//current -- where "ClientPolicy" is gotten from config. file. 
theServiceWse.SetPolicy("ClientPolicy");

//proposed usage of
    public void SetPolicy(Policy policy); 
```

我该怎么办？

# java - Android怎么做图片屏幕滑动？

> ID：14447850
> 
> 赞同：15
> 
> 时间：2013-01-21T21:48:45.273
> 
> 标签：java, android, image-processing

我正在android上构建一个非常基本的画廊，它显示相机文件夹中的最后一张图片，用户可以向左滑动查看前一张。

我完成了一个使用 viewpager 的实现，以及一个使用 sampleSize 缩放图像的 pagerAdapter。我的问题是，该实现远不如默认图库应用程序高效，每次滑动图像时，您都必须等待大约 200 毫秒才能加载下一个图像。所以基本上我关于如何实现它的想法是行不通的。

我怎样才能有效地做到这一点，如果可能的话，使用允许稍后放大和缩小的实现？

* * *

这看起来很有希望，但我不知道如何用文件而不是可绘制文件来实现它 [http://www.androidviews.net/2012/11/photoview/](http://www.androidviews.net/2012/11/photoview/)

* * *

编辑：

我已经设法使用photoview（一个被黑的viewpager）提高了一点速度，但是将文件路径转换为位图或drawables需要太多时间。

我已经尝试了 dilix 和 iDroid Explorer 建议的这两种方法：

```
// Method A
Drawable d = Drawable.createFromPath(imagePath);
imageView.setImageDrawable(d);

// Method B
Bitmap myBitmap = BitmapFactory.decodeFile(imagePath);
imageView.setImageBitmap(myBitmap); 
```

但两者都会产生错误`Bitmap too large to be uploaded into a texture`。我需要尽快将图像获取到 imageView 并以某种方式绕过此错误，也许我会获得不错的速度。现在我正在缩放图像并将它们转换为可绘制的，但它不是很有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T05:16:59.910

检查这个很棒的网站：[http](http://www.androidviews.net/) ://www.androidviews.net/ ，也许这就是你想要的：[http ://www.androidviews.net/2012/11/photoview/](http://www.androidviews.net/2012/11/photoview/)

它有你需要的页面滚动、缩放和平移我已经在我的项目中使用了它，并进行了一些修改和延迟图像加载。它完全按照您的需要工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T13:42:04.310

1)

> 这看起来很有希望，但我不知道如何用文件而不是可绘制文件来实现它[http://www.androidviews.net/2012/11/photoview/](http://www.androidviews.net/2012/11/photoview/)

您不必在适配器中存储可绘制对象列表，而是存储指向 sd 卡上文件的链接，然后加载它。

2）但我可以想象文件而不是drawables不会那么有效，因为要从文件加载你必须从sd卡解析它。

我认为您可以通过同时在内存中加载多个图像（压缩）来节省时间，当您滑动到其他图像时，您已经拥有图像和内存，并且在滑动时您可以开始在内存中加载其他图像。

翻阅画廊时，您可能无法加载图像并在几乎停止后加载它。

这是主要问题：内存消耗与性能。

**更新**

我认为比自己探索更好的是探索谷歌画廊的现有代码：[https ://github.com/CyanogenMod/android_packages_apps_Gallery](https://github.com/CyanogenMod/android_packages_apps_Gallery)

正如我所检查的那样——它们存储缓存（几乎就像我所说的加载多个位图）并且只存储调整大小的图像——似乎很有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-30T04:02:13.330

我不确定你是否得到了正确的解决方案。但是，如果您想使用给定的链接继续您自己的实现，那么：

```
http://www.androidviews.net/2012/11/photoview/   //this link is given in your question 
```

您可以查看[此 SO](https://stackoverflow.com/questions/5834221/android-drawable-from-file-path)，了解如何将文件路径转换为可绘制对象。现在，您可以绘制指定文件并在您提供的链接上实现。

我认为该链接会很好用。

随意发表评论。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-29T13:45:13.573

请参阅官方文档以获取一个很好的示例，该示例将引导您有效地使用带有 viewpager 的位图。您应该使用已经加载的图像的缓存，并且图像应该在 UI 线程之外加载。您还希望将图像缩放到显示所需的最小尺寸（通常是 2 的幂 - 请注意，图像不会总是按您的要求缩放！） ViewPager 还会在后台加载图像以准备下一个slide，用 setOffScreenPageLimit 方法设置的（默认通常是好的，我觉得是 2）

[https://developer.android.com/training/displaying-bitmaps/index.html](https://developer.android.com/training/displaying-bitmaps/index.html)

# visual-studio-2012 - 从前端控制缓存

> ID：14447855
> 
> 赞同：0
> 
> 时间：2013-01-21T21:49:27.613
> 
> 标签：visual-studio-2012, asp.net-web-api

我想在某些调用中从前端控制缓存`PracticeUpdate`。

例如，`/api/GetAllTags`从`javascript`函数调用时`GetAllTags`，我可以在 Fiddler 中看到缓存控制的返回标头设置为无缓存。是否可以在 中进行修改`api`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:59:13.847

您需要做的就是获得`HttpResponseMessage`对请求对象的访问权限。您可以通过要求控制器的`Request`属性为您创建响应来在控制器操作中执行此操作：

```
var response = Request.CreateResponse(HttpStatusCode.OK); 
```

然后您可以`CacheControl`通过以下方式访问该对象`Headers`：

```
response.Headers.CacheControl = new CacheControlHeaderValue
{
    Public = true, MaxAge = TimeSpan.FromMinutes(5)
}; 
```

您也可以`ActionFilter`在这种情况下使用 ，因此可以通过属性将缓存应用于 ApiController Action 方法：

```
public class HttpCacheForMinutesAttribute : ActionFilterAttribute
{
    private readonly int _duration;

    public HttpCacheForMinutesAttribute(int duration)
    {
        _duration = duration;
    }

    public override void OnActionExecuted(HttpActionExecutedContext actionExecutedContext)
    {
        base.OnActionExecuted(actionExecutedContext);

        actionExecutedContext.Response.Headers.CacheControl = new CacheControlHeaderValue
        {
            Public = true, MaxAge = TimeSpan.FromMinutes(_duration)
        };
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T19:12:45.423

Web API 的默认缓存策略是不缓存。

您可以将缓存添加到每个操作中，或者仅使用框架为您执行此操作，例如[CacheCow](https://github.com/aliostad/CacheCow)，它是客户端（当您使用时`HttpClient`）和服务器中 HTTP 缓存的完整实现。

# sharepoint-2007 - Sharepoint 2007 核心.css

> ID：14447859
> 
> 赞同：0
> 
> 时间：2013-01-21T21:49:48.547
> 
> 标签：sharepoint-2007

Sharepoint 2007：Core.css 文件位于 12 文件夹：12\TEMPLATE\LAYOUTS\1033\STYLES

但我的问题是：这个文件是否为共享点服务器上的所有 Web 应用程序共享？

我认为这不是因为当我在 core.css 中进行更改时，只有一个应用程序显示了更改，那么其他 core.css 文件在哪里？

我在我的 c 驱动程序中进行了搜索，我发现只有一个 core.css！！！！

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:13:21.930

此文件由所有 Web 应用程序共享。您所经历的很可能是由于激进的客户端 Web 浏览器缓存造成的。尝试清除浏览器缓存并刷新页面。

话虽如此...
这不是您应该自定义 SharePoint 的方式。永远不要触摸 12 配置单元中的 OOB 文件。下次您应用更新或服务包时，您的所有更改都将消失。此外，通过触摸 OOB 文件，您将自动失去 Microsoft 的所有支持。

相反，您应该 a) 开发一个 SharePoint 功能，使用您的 CSS 更改发布自定义母版页，或者 b) 使用 SharePoint 设计器进行母版页更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T09:09:43.687

Core.css 始终由所有 Web 应用程序共享。

AS magnus 说你所看到的是由于浏览器缓存或类似的东西。删除浏览器缓存或重新启动浏览器，然后重试..

愿这对你有帮助

谢谢

# python - Python按掩码排序

> ID：14447862
> 
> 赞同：-4
> 
> 时间：2013-01-21T21:50:00.437
> 
> 标签：python, sorting, text

我有一些文字：

```
228;u;Ali;
129;cr;Daan;
730;c;Arton;
466;cr;Frynk;
314;c;Katuhkay;
9822;c;Kinberley; 
```

我想将此文本写入文件，但我只想写带有符号';cr;'的行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:54:02.517

像这样的东西：

```
with open("input.txt") as f,open("output.txt","w") as f2:
    for line in f:                #iterate over each line of input.txt
        if ";cr;" in line:        #if ';cr;' is found
            f2.write(line+'\n')      #then write that line to "output.txt" 
```

在 python 中，您可以使用以下命令轻松检查子字符串`in`：

```
In [167]: "f" in "qwertyferty"
Out[167]: True

In [168]: "z" in "qwertyferty"
Out[168]: False 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:55:50.780

```
with open("input.csv", "r") as inp, open("output","w") as out:
    inpList = inp.read().split()
    out.write('\n'.join(el for el in inpList if ';cr;' in el)) 
```

如果您希望从网络读取数据，请使用以下命令：

```
from urllib2 import urlopen
inp = urlopen("<URL>")
with open("output","w") as out:
    inpList = inp.read().split()
    out.write('\n'.join(el for el in inpList if ';cr;' in el)) 
```

`read()`一次读取整个文件。`split()`将其拆分为由空格分隔的列表。

```
读（...）
    read([size]) -> 最多读取 size 个字节，以字符串形式返回。

    如果 size 参数为负数或省略，则读取直到到达 EOF。
```

为了写入文件，`'\n'.join([elem1,...])`从所有包含 ';cr;' 的 inpList 元素中创建一个字符串。这个字符串被传递给`write(str)`它将字符串打印到输出文件。

# php - 扩展类和受保护的数据

> ID：14447865
> 
> 赞同：3
> 
> 时间：2013-01-21T21:50:21.507
> 
> 标签：php

我试图创建一个类来管理小部件。我在父类中遇到受保护数据的问题：

小部件.php

```
/** Parent class **/
class Widget{
    protected $html =""; //formated html data
    // method to load views in {system_path}/widgets/{widget_name}/views/
    protected function LoadView($filename){
        if(!empty($filename) && is_string($filename)){
            $output = "";
            $dir = WIDGET_PATH . "views" . DS . $filename;
            ob_start();
                include($dir);
                $output = ob_get_contents();
            ob_end_clean();
            return $output;
        }
        return NULL;
    }

    //method to render formated html data
    public function Render(){
        if(isset($this->html) && !empty($this->html)){
            return $this->html;
        }
        return NULL;
    }
    //static method to load a Widget
    public static function Load($widgetName){
        if(!empty($widgetName) && is_string($widgetName)){
            $widgetName = strtolower($widgetName);
            if(file_exists(WIDGET_PATH . $widgetName . DS . $widgetName . ".php")){
                include_once(WIDGET_PATH . $widgetName . DS . $widgetName . ".php");
                if(class_exists($widgetName."_Widget")){
                    $class = $widgetName."_Widget";
                    return new $class();
                }
            }
        }
        return FALSE;
    }

} 
```

/widgets/socialbar.php

```
/** SocialBar Widget **/
class Socialbar_Widget extends Widget
{   
    public function __construct(){
        $this->html = "demo"; // test to see if it works
    }
} 
```

索引.php

```
/*load class files, etc */
$Social = Widget::Load("socialbar"); //works, perfectly loads Socialbar_Widget()

var_dump($social); // works : object(Socialbar_Widget)[29] protected html = 'demo' ......

$Social->Render(); // throws Fatal error: Using $this when not in object context 
```

要在父类中扩展变量，我应该使用“public”吗？或者我错了什么。谢谢你们的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T23:26:27.520

您的班级名称是 class Socialbar_Widget，您以小写形式调用它

```
$Social = Widget::Load("socialbar") 
```

在加载方法中，您正在执行 strtolower($widgetName)。
检查类文件名.php。加载函数可能返回 false。

# jakarta-ee - 在基于 Java EE 的订购系统中集成固定电话

> ID：14447866
> 
> 赞同：2
> 
> 时间：2013-01-21T21:50:31.690
> 
> 标签：jakarta-ee

目前在经营一家小型企业，我们接到很多客户的电话；我们目前安装了一个基于 Java EE 的信息系统，并有两条电话线及其相应的分机。我希望能够以某种方式记录来电显示数据，将来电显示数据与来电相关联，并从计算机内控制其他与固定电话相关的功能。

我不知道从哪里开始，无论是硬件还是软件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-13T22:08:13.387

您正在寻找“计算机电话集成”或 CTI 解决方案。有许多示例和选项，包括基于 Java 的 API、JTAPI 或“Java Telephony API”。

您可用的选项取决于电话线路的设置方式 - 如果您有支持 JTAPI 或类似 CTI api 或协议的 PABX，那么您可能能够相对轻松地实现您正在寻找的呼叫控制类型.

如果您的两条线路只是直接连接到墙上插座的标准简单电话，那么您可能需要获得某种 PABX，尽管您可以使用线卡和 Asterix 类型的服务器将 PABX 构建到您自己的服务器中。

一些有用的链接可以帮助您入门：

*   示例 Asterix 卡（我注意到这家公司和其他线卡供应商存在 - 这只是一个示例）[适用于 Asterix PABX 的线卡](http://www.digium.com/en/products/telephony-cards/analog/4-port)
*   一般 CTI 信息：[CTI 维基百科链接](http://en.wikipedia.org/wiki/Computer_telephony_integration)

# ruby-on-rails - 与预定义对象模型的 Mongoid 关系？

> ID：14447869
> 
> 赞同：0
> 
> 时间：2013-01-21T21:50:48.257
> 
> 标签：ruby-on-rails, mongoid

这是我的用例：

我收集了一个完整的从 CSV 文件导入的销售税率。我创建了 Mongoid 模型来镜像字段名称（这些是不可更改的）：

```
class SalesTaxRate
  include Mongoid::Document

  field :state, type: String
  field :zip_code, type: String
  field :tax_region_name, type: String
  field :tax_region_code, type: String
  field :combined_rate, type: Float
end 
```

接下来，我正在构建一个用于我的应用程序的模型。假设我想创建一个名为 Location 的东西：

```
class Location
  include Mongoid::Document

  field :name, type: String
  field :street, type: String
  field :city, type: String
  field :state, type: String
  field :zip_code, type: String
end 
```

我希望能够通过简单地调用这样的东西来获得一个位置的销售税率：

```
home = new Location(...)
home.sales_tax_rate 
```

我永远不会通过 设置费率`home`，只是查找它。

这样做的“正确”方法是什么？我可以想到两种方法——简单的方法似乎只是定义一个进行查找的方法，如下所示：

```
class Location
  ...
  def sales_tax_rate
     SalesTaxRate.where(zip_code: self.zip_code).first.combined_rate
  end 
```

这有效。但我想知道我是否应该使用`belongs_to`关联，如果是，为什么以及如何最好地做到这一点。

仍然在这里学习绳索，如果这是一个新手/愚蠢的问题，请道歉。提前谢谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T04:24:30.383

如果您`zip_code`在模型中有一个索引，`SalesTaxRate`那么您正在做的事情与将要做的事情基本相同`belongs_to`。只需对您的代码进行 nil 检查以确保它不会失败：

```
SalesTaxRate.where(zip_code: self.zip_code).first.try(:combined_rate)
# or
rate = SalesTaxRate.where(zip_code: self.zip_code).first
rate.nil? ? nil : rate.combined_rate 
```

如果你还想走`belongs_to`路线，你可以`zip_code`在你的`SalesTaxRate`. 但是如果你这样做，你应该注意几件事：首先，导入数据中的所有邮政编码都必须是唯一的。其次，您的位置模型不能有任何不可用的邮政编码，`SalesTaxRate`否则您将面临问题。

# node.js - 使用猫鼬按日期发布排序

> ID：14447871
> 
> 赞同：1
> 
> 时间：2013-01-21T21:50:52.890
> 
> 标签：node.js, mongodb, express, mongoose

这是我的架构：

```
var userschema = new mongoose.Schema({

  user: String,
  imagen: [{ 

              name: String,
              author: String,
              date: { type: Date, default: Date.now },

           }],
  follow: [String]

}); 
```

这是代码：

```
usermodel.findOne({ user: req.session.user }, function (err, user){

        usermodel.find({ _id: {$in: user.follow } }, function (err, images){

          console.log(images);

           if (err) throw err;

            res.render('home.ejs', {

              user: user,
              following: images

            });

         });

}); 
```

Schema 中的 follow 数组包含`_id`实际用户正在关注的用户的 s。我试图得到这样的输出：

```
{ _id: 50fd9c7b8e6a9d087d000006,
   imagen: 
    [ { name: 'fff.png',
        author: 'foo',
        _id: 50fd9ca2bc9f163e7d000006,
        date: Mon Jan 21 2013 20:53:06 GMT+0100 (CET) },
      { name: 'mmm.png',
        author: 'foo',
        _id: 50fda83a3214babc88000005,
        date: Mon Jan 21 2013 21:41:34 GMT+0100 (CET) } ] },
 { _id: 50fd9d3ce20da1dd7d000006,
        imagen: 
          [ { name: 'ddd.jpg',
              author: 'faa',
              _id: 50fda815915e068387000005,
              date: Mon Jan 21 2013 21:42:57 GMT+0100 (CET) } ] } 
```

我正在尝试获得类似的输出，例如：

```
 { [ { name: 'fff.png',
        author: 'foo',
        _id: 50fd9ca2bc9f163e7d000006,
        date: Mon Jan 21 2013 20:53:06 GMT+0100 (CET) },
      { name: 'ddd.png',
        author: 'faa',
        _id: 50fda815915e068387000005,
        date: Mon Jan 21 2013 21:42:34 GMT+0100 (CET) }, 
       { name: 'mmm.png',
        author: 'foo',
        _id: 50fda83a3214babc88000005,
        date: Mon Jan 21 2013 21:41:34 GMT+0100 (CET) }
  ] } 
```

我认为我想要的东西是不可能的，或者非常复杂，有什么解决方案可以解决这个问题......？

谢谢提前！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T20:28:51.440

在这一行：

```
usermodel.find({ _id: {$in: user.follow } }, function (err, images){ 
```

`images`不是好名字，更好的名字是`users`甚至`docs`（你会在那里有一组用户模型模式的文档）。所以`images`在你的代码中找到了文件。

我已经使用与您提供的相同架构进行了一个小测试。这是我加入所有`user.imagen`数组然后对它们进行排序的部分（当然它是测试用例，但它有效，希望这会引导您找到正确的方法）：

```
User.find {}, (err, users) ->
  all_images = []
  # iterate users array to join all imagen arrays
  for user in users
    all_images.push user.imagen
  # flatten nested arrays in all_images with underscore function
  all_images = _.flatten all_images
  # sort all_images the way you want (i.e. descending)
  all_images.sort (a, b) -> b.date - a.date
  # render page and see that it works
  res.render 'test.html', {images: all_images} 
```

# python - 无需重置的 Python 变量添加

> ID：14447876
> 
> 赞同：0
> 
> 时间：2013-01-21T21:51:11.033
> 
> 标签：python, variables, types

是否有任何类型的变量可以让我增加它的值，而不会覆盖记忆的值？例子：

```
def main():
var = 0

  inc = input("Want to increase your variable?")
    if inc == "yes":
      var = var + 1
      main()
      #restart the script from the top
    if inc == "no":
      exit() 
```

当代码重新启动时，var 将返回其值“0”，而不会记住我们所做的“var = var + 1”位，是否有任何变量类型会自我更新以匹配脚本中所做的更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:57:26.893

如果您的意思`var`是在迭代中不保留 的值，这与您在 中使用递归有关`main()`。这是完全没有必要的，最好用迭代代替：

```
var = 0

while True:
   inc = input("Want to increase your variable?")
   if inc == "yes":
      var = var + 1
   else:
      break
   print(var) 
```

如果您的意思是要在`var`整个脚本的调用中保留 的值，则可以使用[`pickle`](http://docs.python.org/3.3/library/pickle.html)：

```
import os, pickle

PERSIST_FILE = "persist.dat"
if os.path.exists(PERSIST_FILE):
   var = pickle.load(open(PERSIST_FILE, "rb"))
else:
   var = 0

while True:
   print(var)
   inc = input("Want to increase your variable?")
   if inc == "yes":
      var = var + 1
   else:
      break

pickle.dump(var, open(PERSIST_FILE, "wb")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:54:57.197

否 - 当您按预期更改变量时，变量的值将被更改，除非使用某些后缀增量，即使那样，该变量也仅保持其“旧”状态以用于该行的评估。

听起来您需要使用“临时”变量。虽然显示的代码并没有真正告诉我任何事情，tbh。

更新：

编辑你的问题......我认为你的意思是你想要一个函数之间的全局变量，它确实记住函数调用之间的状态。

这是如何制作和使用这些全局变量的一个很好的来源：

[http://www.python-course.eu/global_vs_local_variables.php](http://www.python-course.eu/global_vs_local_variables.php)

双重更新：

您可能的意思是，即使您关闭程序，您也希望变量记住它的状态！在这种情况下`pickle`，用作另一个答案详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T23:10:10.693

当您运行您的函数 main() 时，您将 var 重置为 0。注意它在函数内部的方式，因此函数内部的任何内容都将运行。

这里 var 不会每次都变为 0：

```
var = 0
def main(number):
    print number
    inc = raw_input("Want to increase your variable?") # Or input() if python 3.x
    if inc == "yes":
        number += 1
        return main(number)
    if inc == "no":
        return number

var = main(var)
print var 
```

在这种情况下 var 是一个全局变量。它可以在整个代码中访问。

上面的代码，运行时：

```
python file.py
0
Want to increase your variable?yes
1
Want to increase your variable?yes
2
Want to increase your variable?no
2 #result of printing var at the end 
```

我希望这能回答你的问题。如果您有任何其他问题，我会尝试回答它们；）。我对python有点新手。

# python - 在 Python 中解析 MIME 正文部分

> ID：14447877
> 
> 赞同：0
> 
> 时间：2013-01-21T21:51:17.537
> 
> 标签：python, email, imap, mime

我在解析 MIME 消息的特定正文部分时遇到问题。

我有一个电子邮件客户端 Web 界面。我想允许用户下载电子邮件的附件。过去，每次我想下载附件时，我都会使用参数 RFC822 调用 IMAP 服务器以获取整个消息，我可以使用 Python 轻松解析。

但是，这效率不高，我需要一种方法来获取所需的附件。我正在使用特定正文部分的 BODY[1]、BODY[2] 等索引调用 IMAP 服务器的替代方法。

当我进行此 IMAP 调用时，我获得了正确的正文部分（当我调用 BODYSTRUCTURE 时，我正在寻找的部分中的字节数加起来，所以我肯定获得了正确的部分）。

但是，我无法将这个身体部分解析为可用的东西，或者为此保存它。

一个具体的例子：我打电话获取邮件的 BODY[1] 并获取回来

```
 ('4 (UID 26776 BODY[2] {5318}', '/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAoHBwkHBgoJCAkLCwoMDxkQDw4ODx4WFxIZJCAmJSMg\r\nIyIoLTkwKCo2KyIjMkQyNjs9QEBAJjBGS0U+Sjk/QD3/2wBDAQsLCw8NDx0QEB09KSMpPT09PT09\r\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT3/wAARCABRAQIDASIA\r\nAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQA\r\nAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3\r\nODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWm\r\np6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEA\r\nAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSEx\r\nBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElK\r\nU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3\r\nuLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD2aiii\r\ngAooooAKKKKACorm4jtLaS4mbbFEpdzjOAOtS1neIf8AkXdR/wCvaT/0E1UVeSRM3yxbRbtbuC9t\r\n1ntZUliboyHIqauA+F+f+JkMnH7vj/vqu/rSvS9lUcE9jLDVvbUlNq1wooorE3CiiigAooooAKKK\r\nKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKzvEP8AyLuo/wDX\r\ntJ/6Cabruu23h/T2urlJZAPuxxLuZv8A63vXlWo+M/EXjC9FnpMUsMRORBb8sR6u3p+QrehSlJ83\r\nRGFerGKcerOp+F/XUv8Atn/7NXfE4GT0FcN4fx4Ss5jqTwS6jPt3w2vRcZxuPQHnnH5VDe6vqOuS\r\n+RGG2t0hi7/X1/HiniZqpVckThKbpUVCW534IYAggg8gilqG0QxWcKMMMsaqR6YFTVznSFFFFABR\r\nRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFITgZPSuen8daJDqLW\r\na3Xmug3SPENyRjIHJ+p7ZqowlLSKuTKcYq8nY6Kio1uIngEyyIYmGQ4PBH1qCLVLSa5Nuky+bjIU\r\n8bh7etSUcn8TGaOz05kYqwlYgg4I4qbRiLXw7ZG3SOFrmLzJmjQKZGyeSRUHxO/48dP/AOurfyqb\r\nTf8AkXNK/wCvf+prtn/usPVnn0/98n6Ikh8KzXt9LPdP5UDOWAXlmH9K6Wy0+20+Ly7WJUHc9z9T\r\n3pXdotOZ0OGWLcPqBXF6V4m1S4k0xpLvzPtTESRvaeWijBPyv0Y8dBXPClKabXQ6qlaNNpPqd5RX\r\nKWuvX8ug6HdPIhlvLsRTHYMFSW6Dt0FM0HxBqF/faZHcSIyXEM7yAIBkq5A+nFU8PNJvt/wf8iVi\r\nYNpd7fjb/M66iuZvrzVZ/Ed3ZWV7HbRQWqzDdAH3E5461lr4w1E2clyRESumLcBNvHmGTZn1x7UR\r\nw8pK6/q4SxMIuzT/AOGO6orjL7XdW0QzR3FzDds1ibmNvJ2bGBAxgHkc1saXJeJewx3+rxTySwea\r\nLcW4Q445yD0HSlKi4q9xxxCk+VJ/h/mbdFcodS1G6uNVnOqw2FnY3Bh+a3D8DHJJPqa09B1G4v7j\r\nVEuHVlt7too8Lj5QBSlSaVxxrxk7W/r+kbFFcW+v6t9in1ZbiEW0V79n+y+T1XcFzvznPNVF8T6q\r\nS8gvBuF55Iia0xGV345l6A4q1hpvqZvFwW6Z39FcRdeJr+P7VeJfWqrBeGBbEoNzoGC7s5znv0rf\r\n0HUbi/l1MXDBhb3jwx4XGFGMD3qZUJRjzMuGIhOXKv6/qxsUVzWva9d6XqsqQ7Gij057gIy9XDYH\r\nPpVOTXNV0lomu7iG8W4sZLlR5Pl+WyqGA4PI5ojQk0muopYmEW0+h2NFcjBrOq2U+nteXMN1HfWs\r\nk+wQ7PLKpvABB5Haq665rMFnpt5LdQzLqKviEQBfKO0kYOeenen9Xl3X9X/yF9aj2f8AVv8ANHbU\r\nVysXiG6e18PyCVHa7jd7gBR821CT9ORVTT/EmoPJpc0t/azi/Yq9skYDQcEjkHPbvR9Xn/Xz/wAh\r\n/Woaf12/zO1orkdI8R6tLpVpdXsFmYZiVEzT7Gc5PATHXjpntUdnrmriHSL+4uYZINSm8s24h2+X\r\nnOCGzk9O9H1eSuhLFQaTSev9fqdlRXB6Z4m1K4Gnyf2lbXM9xcCOSyWEB0XJy2Qc9Bn8as6T4gvp\r\n9Rgj1K+kt5JJin2Y2JCnk4USU5Yaav5Cji4Stbr6f5/8E7OikornOoWoLyWWC0llt4DcSopKxBgp\r\nc+mTwKnrP1LWrPTFInkzJ2jTlj/h+NAHkPiLxL4m8Rak2lyW9xbEnH2GFCGP+8erfyq7F4FvdA8P\r\n3ep6jIiSsixrbpztBdeWPTPHQV1g8Q3OoavDsVYIySMIPmIwTgt6e3SpPFF5JdeD71ZcEoY/m9cs\r\nK7qWIbnGEVZXRwV6CVOc5O7syj4SYnwlgkkLdsACeg2iofFhGn2cF8gkmldSBCi8gKfvZ9Km8I/8\r\nim3/AF+N/wCgiqXjpikGkMpKsElIIOCPmFDpqpinF92TGq6WDjNdkcoPEGu+IZ0SQrc28fAjkHyJ\r\n77uuffOa9JtvIXSbKG1mEqwQ7GI7H0NadnpFnqHh6xWeFQTAjb0G1gSAScj3qnZ+EDb3xka8byl+\r\n6EGGb2NY1qvN7iVkjpo0lH327tm5cyJFpEskgLIkBZgvUgLziuUtLPTrWSEhbyQWsgFtbTXWfnLB\r\nQQmOB82c+hrspII5rd4ZFDRupRl9QRjFVZNHs5m3Sxs5Awu6Rjs5B+Xn5eg6Y6VjGco6JmsqcZWc\r\nkc+ulWulXsDyWtz5UKyXSRG63xQ7cbiq+vzcVAunaUmlwXJkurcwRyGAQ3XzupO5hkDrk11v2C3I\r\nUOhfajRguxY7WxkEnrnA601dOt1tHtdrtA67SjyM3GMY5PAqvbT7k+wp/wApy0thpxa2nM2qCS5z\r\nbl1ucMwWQJ8x78t+VW9T0TSLEW8EkM4iuo1sSUfiNAdwJz/tAc+9bDaJYOWLQH5ju4dhtJYMSvPy\r\n/MAeMVLNplrcWwgnjMsYVlxIxY4YEHknPQmj20+4ewp/ynM3Fxp+rySzGxuJRFF9kIaUIGRpNoP4\r\nkA59DUxt7Tw7qMM5a6muBauQJ7oEKgK5Vc9TzwK310myQyFbdR5hUtgnnacj8jUzWsL3KzvGrSqp\r\nRWPYEg/zApe0la1x+yhfmtqcZfQ6ZdiS4eO+hh1Bt+xbkIkpDqhLA/d5INTQ2dvNfLNajUIzdXD7\r\n/KvNqF1zk8dRgf0rpRotgH3fZwfm3AFiQp3BuBnA+YA8VLHp9tE6tHCqlXaRcZ4Zup/Gn7WdrXF7\r\nCne9jlpLLTJLi2eOC8YXpS6S18/bCXbJyR+GahmsdMgeRZReNAswklhW8BQykb+F7jpz/hXULodg\r\ni4WAjGNpEjZTGcBTn5RyeBjrSLoGmLHsFnGRkHJyWzjHXr0o9tU7h7Cn/KZd1oWkDSWmltmIuZ0m\r\naTI8xWd1/i7AE9PTNU47SyfXrmO1lv4pPPMswW72ITk5IUDn7p49q6ePTreO0e2Cs0DrtKSOzjGM\r\nY5Jpkek2cRjMUbJsQINkjDKgk4bB+bknrnqaPaz7h7Gn2OfvZbHVLuKS7tLsSXlqIYxE4OYny2cd\r\nj8v61JfRaZdxFpYrkrZxC0G1wCVkAB/EVuPo9k6xgw48pFjjKsVKKvTBByOtMGh6eCuLcAKANoZs\r\nHGcEjOCRk8nml7SS2ZTpwd7o55b/AE+efS1FuzSQQbYB9oUpsZMEOR/FgdPerMOj2Wm6rAsUV1N9\r\nkj84JLcEx26kkfKO54NbJ0Wx3xusGx40CI0bshVRkAZBB7mppNPt5Z0mdW8xF2bg7DK9cHB5H1zR\r\n7Se1xeyhvY5nT4dPtbxmtrCYXF9GDCjSgqscgZjt/ufdOR9Kgt00m3h0xl05oHiKSQO0qKXDBgPM\r\nb8Dx7iupg0iyt3R44cNGRsJZm24BAAyeAAx46c0DSbIGEi3T9yAsecnaBnH8zR7WfcPYw7HJ2Mel\r\nB5LiGC6eCxDzfZ5LnKIwBJ2J0I54Oe9T/ZNK0u8siIdSfEp8i3eQlYWJAyEJ/wBr+ddO+mWryyO0\r\nZzKNsih2CuMbeVzg8cdKi/sLTyOYCzZyHZ2LA8YO4nPG0Y9MU/az7iVGmvsmEtppkQstNtrSdpYJ\r\nVmhLOFbdlyQzdcDaePpTLRLK4vrW7dtSnjSdNpnudyxyuMj5fbIGa6EaJYgDbCVYHO9XYPnLHO7O\r\nc/M3PfNPj0qziQJHAqqHWQAZ4ZQAp/AAUvaz7j9jDsW6KKKg0AjIIPQ1zV34NjluxJBcskbHLq/z\r\nEfQ/4101FAGbDpFpptjMttF85QgueWbj1rlNYu7ebSriwDl3mKZZOQu056967zqOawtX8LW17DM9\r\noqwXLL8pyQmfcD+lVB2kmiZpSi01c5HToZLO0aZLlLOyhY75pXwgOORj+I9OKx/EXijTddntrW2e\r\nRFtlZEmkTCyliM8clenGf0pn/CBeJ9W1U2t6iQQRHPmlv3IB7oB1P6+pr0Pw34G0rw4Fkij+0Xg6\r\n3EoBYf7o6L+HPvXYpQoy5+bmkccoSrx9ny2ibGkRtFo9lHIpV0gRWB7EKKuUUVxN3dztSsrBRRRS\r\nGFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQA\r\nneloooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKA\r\nCiiigD//2Q==\r\n'). 
```

此特定响应对应于 JPEG 图像附件。

我尝试提取代表身体部分的字符串（所以，我说的是从'/9j'开始并以'2Q==\r\n'结束的字符串）并将其保存为.jpg文件，但是它不是一个有效的文件。

然后我认为，由于该字符串中有多个 \r\n 实例，因此该字符串可能会使用换行符/回车符进行拆分，因此我拆分了字符串并将其从 \r\n 中剥离，然后加入了子字符串并尝试将其保存到文件中。仍然不是有效的 JPEG 文件。

我能做些什么来尝试解析这个响应？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:12:04.860

您需要解析`BODYRESPONSE`字符串以查看数据编码的格式，请参阅[IMAP RFC 3501，第 7.4.2 节](https://www.rfc-editor.org/rfc/rfc3501#section-7.4.2)。第 5 个字段是内容编码：

```
['IMAGE', 'JPEG', ['NAME', 'image001.jpg'], '<image001.jpg@01CDE914.6E62F850>', None, 'BASE64', 5318, None, None, None] 
```

这些字段依次是类型和子类型（`image/jpeg`在这种情况下）、正文参数（例如字符集、格式流或在这种情况下的文件名）、附件 id、描述、编码、大小、MD5 签名（如果有）、性格和语言。

在这种情况下，数据是 base-64 编码的：

```
>>> imagedata = datastring.decode('base64')
>>> imagedata[:10]
'\xff\xd8\xff\xe0\x00\x10JFIF' 
```

对我来说，这看起来像 JPEG 数据。

# c# - 中继器和自定义控件 - 动态添加到集合并保留值

> ID：14447883
> 
> 赞同：1
> 
> 时间：2013-01-21T21:51:33.707
> 
> 标签：c#, asp.net

我已经很久没有使用 Web 表单了，我发现自己已经记不起大部分的好处了。

我有一个用户控件，它有一个按钮、一个转发器，并且转发器的 ItemTemplate 属性是另一个用户控件。

```
<asp:Button runat="server" ID="btnAdd" CssClass="btn" Text="Add" OnClick="btnAdd_Click"/>
<br/>
<asp:Repeater runat="server" ID="rptrRequests">
    <ItemTemplate>
        <uc1:ucRequest ID="ucNewRequest" runat="server" />
    </ItemTemplate>
</asp:Repeater> 
```

这个想法是，当用户单击“添加”按钮时，会将一个新的 ucRequest 实例添加到集合中。后面的代码如下：

```
public partial class ucRequests : UserControl
{
    public List<ucRequest> requests
    {
        get
        {
            return (from RepeaterItem item in rptrRequests.Items 
                    select (ucRequest) (item.Controls[1])
                    ).ToList();
        }
        set
        {
            rptrRequests.DataSource = value;
            rptrRequests.DataBind();
        }
    }

    protected void Page_Load(object sender, EventArgs e)
    {
        if (IsPostBack) return;

        requests = new List<ucRequest>();
    }

    protected void btnAdd_Click(object sender, EventArgs e)
    {
        var reqs = requests;
        reqs.Add(new ucRequest());
        requests = reqs;
    }
} 
```

经过多次谷歌搜索后，我现在记得我应该在 OnInit 方法中绑定中继器，以便 ViewState 将控件的捕获数据放在 ucRequest 控件中的回发之间，但是当我尝试这样做时，我将始终拥有因为它的 Items 集合总是空的，所以Repeater 上的控件的单个实例。

我怎么能做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:54:47.560

您只需要视图状态中的控件 ID 而不是整个控件集合。

![在此处输入图像描述](../Images/2748ea70c2c73468bc45287b2e838b4a.png)

```
<%@ Control Language="C#" AutoEventWireup="true" 
    CodeBehind="ucRequests.ascx.cs"
    Inherits="RepeaterWebApplication.ucRequests" %>
<asp:Button runat="server" ID="btnAdd" CssClass="btn" Text="Add" 
   OnClick="btnAdd_Click" />
<br /><asp:PlaceHolder runat="server" ID="PlaceHolder1"></asp:PlaceHolder>

<%@ Control Language="C#" AutoEventWireup="true" 
   CodeBehind="ucRequest.ascx.cs" 
   Inherits="RepeaterWebApplication.ucRequest" %>
<asp:TextBox runat="server" ID="TextBox1"></asp:TextBox>

private List<int> _controlIds;

private List<int> ControlIds
{
    get
    {
        if (_controlIds == null)
        {
            if (ViewState["ControlIds"] != null)
                _controlIds = (List<int>) ViewState["ControlIds"];
            else
                _controlIds = new List<int>();
        }
        return _controlIds;
    }
    set { ViewState["ControlIds"] = value; }
}

protected void Page_Load(object sender, EventArgs e)
{
    if (IsPostBack)
    {
        foreach (int id in ControlIds)
        {
            Control ctrl = Page.LoadControl("ucRequest.ascx");
            ctrl.ID = id.ToString();

            PlaceHolder1.Controls.Add(ctrl);
        }
    }
}

protected void btnAdd_Click(object sender, EventArgs e)
{
    var reqs = ControlIds;
    int id = ControlIds.Count + 1;

    reqs.Add(id);
    ControlIds = reqs;

    Control ctrl = Page.LoadControl("ucRequest.ascx");
    ctrl.ID = id.ToString();

    PlaceHolder1.Controls.Add(ctrl);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:03:30.363

尝试在 OnItemDatabound 事件期间获取 ucRequests，此时您可以编辑转发器的 itemtemplate 的内容。您可以在单击添加按钮导致回发后到达那里。[这是一个类似场景的示例](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.repeater.onitemdatabound.aspx)

# android - UrlImageViewCallback ：仅在图像加载成功时调用

> ID：14447884
> 
> 赞同：0
> 
> 时间：2013-01-21T21:51:35.453
> 
> 标签：android, callback, urlimageviewhelper

我正在使用来自 koush [https://github.com/koush/UrlImageViewHelper的令人惊叹的 UrlImageViewHelper 库](https://github.com/koush/UrlImageViewHelper)

根据回调文档，我目前面临的问题是助手仅在 iMage 成功加载时通知：

> 回调 UrlImageViewCallback 的实例，当图像成功完成加载时调用。该值可以为空。

```
UrlImageViewCallback myCallback = new UrlImageViewCallback() {
    @Override
    public void onLoaded(ImageView imageView, Drawable loadedDrawable,
            String url, boolean loadedFromCache) { 
```

我只是想知道如何在未加载 ImageView 时收到通知。（服务器没有回答，或错误的网址）

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:11:28.993

听起来我必须创建自己的回调：

```
public interface UrlImageViewCallback {
    void onLoaded(ImageView imageView, Drawable loadedDrawable, String url, boolean loadedFromCache);
    void onFail(ImageView imageView, String url);
} 
```

现在工作正常。

# git - 如何使用 method_missing 方法在砂砾中使用 Push

> ID：14447887
> 
> 赞同：0
> 
> 时间：2013-01-21T21:51:52.263
> 
> 标签：git, grit

我正在尝试使用 grit 进行推送。但是我无法弄清楚要在下面的 rmpush.push 命令中传递的所有参数。我已经使用 git remote add 创建了一个远程别名，并且它工作正常。

```
location = 'D:\GritRepo'
repo = Grit::Repo.init(location)
rmpush = Grit::Git.new(location+'\.git')
# this works fine
repo.remote_add("remoterep","https://github.com/ahmadosama/GritRepo.git")
# need help here
rmpush.Push({:repo=>'remoterep', :remote=>'master'}) 
```

# java - 如何在 GWT 中模块化面板

> ID：14447889
> 
> 赞同：0
> 
> 时间：2013-01-21T21:52:03.980
> 
> 标签：java, gwt

假设我的页面有以下布局：

```
vertical panel mainbody = new VerticalPanel;

//beginning of 1st sub-vertical panel
VerticalPanel first_panel = new verticalPanel();
first_panel.add(...);
//other such stuff, end of first_panel
mainbody.add(first_panel);

//beginning of 2nd sub-vertical panel
VerticalPanel second_panel = new verticalPanel();
second_panel.add(...);
//other such stuff, end of first_panel
mainbody.add(second_panel);

//beginning of 3rd sub-vertical panel
VerticalPanel third_panel = new verticalPanel();
third_panel.add(...);
//other such stuff, end of first_panel
mainbody.add(third_panel);

//end of mainbody
RootPanel.get().add(mainbody); 
```

我想对其进行模块化，这样每个子面板（`first_panel`和`second_panel`）都`third_panel`属于单独的文件，这样在一些导入之后，我就可以在主页上编写代码来完成这个技巧：

```
vertical panel mainbody = new VerticalPanel;

mainbody.add(first_panel);
mainbody.add(second_panel);
mainbody.add(third_panel);

//end of mainbody
RootPanel.get().add(mainbody); 
```

子面板本身可以使用其他子面板，模块化应该级联。现在我需要做什么来启用它？谷歌文档对我来说不是很清楚。具体来说，

1.  如何在单个文件（包或文件夹）中定义这些面板，以便可以将它们导入主文件？

2.  我如何导入它们（有点像`include`在 PHP 中）？

3.  我需要对`xml`文件进行哪些更改（如果需要）？

4.  如何为导入的文件也定义相同的规则集，以便导入级联？也就是说，如果`a`imports`b`和`b`imports `c`and `d`to 构造自己，两者`c`和`d`都被导入到主文件中导入？

5.  主 CSS 文件中的`CSS`规则是否足以满足所有导入的面板？

**如果有人能从随附的默认StockWatcher**应用程序的角度解释这一点`GWT`（以便我们可以对理解目录结构有一些共同点），我将很容易理解。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T02:08:08.703

你需要制作一个`Widget`面板。

```
package com.example.widgets // Make this package whatever you want

import com.google.gwt.user.client.ui.Composite

public class FirstPanel extends Composite{

    private VerticalPanel verticalPanel;

    public FirstPanel(){

        verticalPanel = new VerticalPanel();

        // All composites must call initWidget() in their constructors.
        initWidget(verticalPanel);

        // For your CSS
        setStyleName("example-SomeStyle");

        // Continue constructing object ...
    }

} 
```

每次使用`initWidget()`构造函数时都需要调用一次。它将小部件设置为由组合包装。[在此处](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/Composite.html#initWidget%28com.google.gwt.user.client.ui.Widget%29)查看文档。

然后你就可以像这样使用它了

```
VerticalPanel mainPanel = new VerticalPanel();

FirstPanel firstPanel = new FirstPanel();
mainPanel.add(firstPanel); 
```

1.  以上应该回答第1点

2.  如果您的 Widget 与上面的代码不在同一个包中，则需要导入它。对于上面的例子：`import com.example.widget.FirstPanel`

3.  无需在 XML 文件中进行任何更改

4.  是的，导入将按照您的描述进行级联。

5.  只要您在小部件中声明样式名称，主 CSS 中的 CSS 规则就足够了。您可以通过调用来做到这一点，`setStyleName("example-SomeStyle");`如上例所示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T23:36:42.117

您要问的是所谓的自定义小部件。您可以创建一个自定义小部件来代表 first_panel，另一个代表 second_panel 等。然后，如果需要，您可以制作包含其他小部件的小部件。每个自定义小部件都是一个单独的类 - 它将由一个单独的文件表示（或者如果您使用 Ui:Binder 作为自定义小部件，则使用两个文件）。

您可以在此处阅读有关自定义小部件的更多信息： [https ://developers.google.com/web-toolkit/doc/latest/DevGuideUiCustomWidgets](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiCustomWidgets)

# android - 使用相同证书进行更新的 Android 签名证书错误

> ID：14447890
> 
> 赞同：1
> 
> 时间：2013-01-21T21:52:05.750
> 
> 标签：android, google-play

我正在尝试更新 Google Play 上的当前应用。我正在使用一个 .keystore 文件，我确信它与以前的版本相同，并且我确信密码是正确的。我已经更新了 manifest.xml 中的 versionCode 和 versionName，并阅读了所有 android 文档以提交更新。我只是使用相同的 .keystore 来更新另一个应用程序，它运行良好。当我尝试上传新的 .apk 文件时，我收到以下错误：

**上传失败 您上传的 APK 使用与之前的 APK 不同的证书进行签名。您必须使用相同的证书。您现有的 APK 使用带有指纹的证书进行签名：**

**[SHA1：CB：17：93：81：FA：07：6E：B7：4C：83：EA：64：79：85：44：3B：7D：08：71：6E]**

**并且用于签署您上传的 APK 的证书有指纹：**

**[ SHA1：ED：79：37：8A：77：3A：6E：82：8A：60：55：95：99：0E：56：60：CB：5B：3C：EF，**

**SHA1：CB:17:93:81:FA:07:6E:B7:4C:83:EA:64:79:85:44:3B:7D:08:71:6E]**

如您所见，第二个（新）证书的第二个 SHA1 参数与第一个证书相同。但是，由于某种原因，第二个证书有 2 个 SHA1: 参数。有谁知道为什么会有2？我找不到这方面的任何信息，非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:55:33.560

我只是快速浏览了一下，但根据这个[我们可以在密钥库中加载多个证书和密钥吗？](https://stackoverflow.com/questions/6370745/can-we-load-multiple-certificates-keys-in-a-key-store)可能有多个密钥，您确定您使用了正确的别名吗？

# c# - 将文件设置为只读直到签出

> ID：14447893
> 
> 赞同：2
> 
> 时间：2013-01-21T21:52:13.023
> 
> 标签：c#, winforms, visual-studio-2010

我需要将项目文件默认设置为只读，当且仅当我签出文件进行本地编辑时才使它们可写。

我认为这是默认行为，但由于某种原因我失去了它。我怎么能把它拿回来？

（我的最终目的是防止开发人员在没有先签出的情况下编辑文件。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T21:56:32.340

看起来您正在使用 TFS 2012 的“[本地工作区](http://visualstudiomagazine.com/articles/2012/11/02/local-workspaces-in-tfs-2012.aspx)”功能。

这意味着所有文件都是可写的，不需要签出即可删除只读标志（很像 SVN 和 Git）。一旦您对文件进行更改，它将被签出。

您可以将 TFS 更改为[默认](http://blogs.msdn.com/b/visualstudioalm/archive/2012/10/05/set-local-workspaces-as-default-when-upgrading-to-tfs-2012.aspx)为服务器工作区，或者只是将工作区设置为每个开发人员的服务器工作区。

# python - 热门从 Python 脚本获取查询字符串（在 IIS 上使用 PyISAPI）

> ID：14447900
> 
> 赞同：0
> 
> 时间：2013-01-21T21:52:43.210
> 
> 标签：python

我已经从这个博客[http://geographika.co.uk/setting-up-python-on-iis7](http://geographika.co.uk/setting-up-python-on-iis7)完成了所有工作。我只使用 Python 2.6（不是 Django）并且想在我的 python 脚本中获取查询字符串参数。

例如，在执行过程中`http://localhost/MyApp/program.py?par=test`

如何在我的脚本 program.py 中获取值测试：

```
from Http import *
def Request():
    Header("Content-type: text/html")
    Write(get_param("par")) 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:00:11.023

知道了

```
from Http import *
def Request():
    Header("Content-type: text/html")
    Write(Env.QUERY_STRING) 
```

# ios - 对象删除/上下文保存后指向 NSManagedObject 的指针？

> ID：14447901
> 
> 赞同：1
> 
> 时间：2013-01-21T21:52:43.787
> 
> 标签：ios, objective-c, core-data

有人可以解释在删除对象并保存上下文后指向 NSManagedObjects 的指针会发生什么吗？我应该如何设置它们以便它们自动设置为零？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:01:11.473

嗯，这很简单。

```
[managedObjectContext deleteObject:managedObject];
[managedObjectContext save:error];
managedObject = nil; 
```

如果您在删除大量对象时担心内存泄漏，请使用快速枚举。这几乎可以保证自行清理：

```
for (NSManagedObject *obj in fetchedObjects) {
    [managedObjectContext deleteObject:obj];
}
[managedObjectContext save:error]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T22:04:38.923

删除对象后，该`isDeleted`属性将为 true。保存上下文后，如果您仍然有对托管对象的引用，则`isDeleted`将为**false 。**

您可以安全地`weak`引用托管对象。当`weak`Core Data 使用它们时，引用将在 ARC 下自动为您消失。

以下是核心数据编程指南中的三个相关段落：

> Core Data“拥有”托管对象的生命周期。使用故障和撤消，您不能对托管对象的生命周期做出与标准 Cocoa 对象相同的假设——托管对象可以根据需要由框架实例化、销毁和复活。
> 
> 创建托管对象时，将使用托管对象模型中为其实体指定的默认值对其进行初始化。在许多情况下，模型中设置的默认值可能就足够了。但是，有时您可能希望执行额外的初始化——可能使用模型中无法表示的动态值（例如当前日期和时间）。
> 
> 您通常不应覆盖 dealloc 来清除瞬态属性和其他变量。相反，您应该覆盖 didTurnIntoFault。didTurnIntoFault 由 Core Data 自动调用，当一个对象变成一个错误时，并且在实际释放之前。您可能会专门将托管对象变为故障以减少内存开销（请参阅“减少内存开销”），因此确保在 didTurnIntoFault 中正确执行清理操作非常重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-21T12:50:50.477

我检查（managedObject.managedContext == nil）。如果它是 nil，那么它被删除了。尽管 Apple 文档不能保证这一点，但它似乎对我来说很好。如果你在不同的上下文中使用它或者它没有被保存，它就不会起作用。请参阅[如何判断 `NSManagedObject` 是否已被删除？](https://stackoverflow.com/questions/4340445/how-can-i-tell-whether-an-nsmanagedobject-has-been-deleted/7896369#7896369)详情。

# mechanize - 如何使用mechanize点击没有id和name的提交按钮？

> ID：14447902
> 
> 赞同：0
> 
> 时间：2013-01-21T21:52:53.407
> 
> 标签：mechanize, ruby-1.9.3, mechanize-ruby

找到以下 HTML 代码：

```
<input type="hidden" name="TARGET" value="www.example.com"/>
<noscript><input type="submit" value="Resume"/></noscript>
</form> 
```

如何使用mechanize点击没有id和name的提交按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:29:58.237

我已经找到了此类场景的答案，代码如下：

```
agent = Mechanize.new
#---some more codes are here, the main trick started at below.
button = Login_form.button_with(:name => 'Submit')
loggedin_page = Login_form.submit(button)
loggedin_page=agent.submit(loggedin_page.forms.first, loggedin_page.forms.first.buttons.first) 
```

# escaping - 通过转义（忽略）继续符号和换行符（'\n'）在下一行继续标记（即 ID）的语法

> ID：14447903
> 
> 赞同：3
> 
> 时间：2013-01-21T21:52:56.147
> 
> 标签：escaping, newline, antlr4

IBM i 控制语言 (CL) 语句以`\n`(newline) 结尾，并在下一行使用`+\n`或`-\n`继续一个长语句（从下一行`-`的位置 1 继续，从下一行`+`的第一个非空白字符继续）。我在书中使用了 ANTLR4 RC1 "Fun with Python Newlines" 示例，这是一个非常接近的匹配并且工作正常，前提是`+`or`-`继续字符不会拆分标记文本。例如，这在 CL 中有效：

```
 chg+                                                   
    var +                                                
    &x (&-                                             
    x++                                                    
       1) /* "Change variable" statement resulting in: chgvar &X (&X+1) */ 
```

-或者-

```
 chgvar &y (&a || 'some +
    stuff') /* result: chgvar &y (&a || 'some stuff') */ 
```

这是一个简单的测试装置的语法，仅支持`ID`和`-`作为换行符：

注意：基于 lexmagic/SimplePy.g4

```
 grammar CL;
    pgm       :   stat+ EOF ;
    stat      :   ID NEWLINE ;
    ID        :   [a-zA-Z_] [a-zA-Z_0-9]* ;
    NEWLINE   :   '\r'? '\n' ;
    WS        :   [ \t]+ -> skip ;
    LINE_ESC  :   '-' '\r'? '\n' -> skip ; 
```

这是运行它的方法（在终端需要所有导出和别名之后）：

```
 antlr4 CL.g4
    javac *.java
    grun CL pgm -tree
    abc- (Return once)
    def (Return, CTRL-D)
    line 2:0 extraneous input 'def' expecting NEWLINE
    (pgm (stat abc def \n) <EOF>) 
```

ANTLR4 将`ID`视为两个令牌`abc`，`def`而不是`abcdef`，我理解为什么（当 Lexer 看到`-\n`它发出`ID`令牌时`abc`，丢弃`-\n`并`def`作为新令牌开始。）。解析器看到`abc` `def\n`而不是`abcdef\n`.

问题是，有没有办法让解析器将`abc-\ndef\n`其视为一个令牌而不是两个？

另一方面，如果源代码 =`abc -\ndef\n`那么它应该合法地发出 2 个令牌，因为 和 之间有`abc`空格`-\n`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T00:18:20.873

我倾向于使用自定义[`CharStream`](http://antlr.org/api/Java/index.html)实现来隐藏词法分析器中的延续字符，它的工作方式类似于标准流，除了：

*   执行[`IntStream.LA(i)`](http://antlr.org/api/Java/org/antlr/v4/runtime/IntStream.html#LA%28int%29)需要在需要时跳过正负连续字符`i`。
*   的实现[`IntStream.consume`](http://antlr.org/api/Java/org/antlr/v4/runtime/IntStream.html#consume%28%29)需要在必要时跳过隐藏区域，即在使用 的常规实现之后`consume`，如果接下来的两个字符是`-\n`或`+\n`则立即将索引移过跳过的字符。
*   的实现[`IntStream.seek`](http://antlr.org/api/Java/org/antlr/v4/runtime/IntStream.html#seek%28int%29)需要确保索引保留在可见字符上（有关更多信息，请参阅 Javadocs）。
*   的实现[`CharStream.getText`](http://antlr.org/api/Java/org/antlr/v4/runtime/CharStream.html#getText%28org.antlr.v4.runtime.misc.Interval%29)应该从指定的间隔返回文本，并从结果中去除不可见的连续字符。

*   [`IntStream.mark`](http://antlr.org/api/Java/org/antlr/v4/runtime/IntStream.html#mark%28%29), [`IntStream.release`](http://antlr.org/api/Java/org/antlr/v4/runtime/IntStream.html#release%28int%29),[`IntStream.index`](http://antlr.org/api/Java/org/antlr/v4/runtime/IntStream.html#index%28%29)和[`IntStream.size`](http://antlr.org/api/Java/org/antlr/v4/runtime/IntStream.html#size%28%29)的实现[`IntStream.getSourceName`](http://antlr.org/api/Java/org/antlr/v4/runtime/IntStream.html#getSourceName%28%29)不需要任何特别的东西。

您可能需要执行额外的步骤来确保与您的标记关联的行号和列号是正确的，因为词法分析器不会看到每个输入符号。

# ruby-on-rails - 无法让相关模型对的模型验证正常工作

> ID：14447904
> 
> 赞同：0
> 
> 时间：2013-01-21T21:52:58.427
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在尝试为父模型和子模型实现类似于 Reddit 的投票功能（链接和评论，但在我的情况下，对于问题，哪个`has_many`答案）。

投票功能目前在对问题进行投票时效果很好，但是在回答问题时，用户只能为给定问题出现的**一个**答案投票，而不能为任何后续问题投票（不像 SO，它可以让您投票给尽可能多的人）随心所欲的回答..)

我发现我的问题在我的`Vote.rb`文件中（当它被注释掉时，它可以工作..），如下所示：

```
class Vote < ActiveRecord::Base
  attr_accessible :question_id, :answer_id, :up # up is a boolean used for voting

  belongs_to :user
  belongs_to :question
  belongs_to :answer 

  validates :user_id, :uniqueness => { :scope => :question_id } #this line causes the issue..

end 
```

通过保证用户只能为一个问题投票一次，验证适用于问题，但由于我在问题`show`页面中呈现答案，我的直觉是`user_id`/`question_id`唯一性规则也阻碍了它为 answer_ids 工作。如果可能的话，我想知道我是否可以构造验证，以便它首先验证`answer_id`/`user_id`唯一性，然后是问题/用户对.. 虽然我不知道该逻辑是否正确并使其正常工作。

谢谢你的帮助！

* * *

作为补充材料，这是我的控制器：

```
class VotesController < ApplicationController
  def create
    @vote = Vote.where(params[:vote].slice(:question_id, :answer_id).merge(:user_id => current_user.id)).first
    if @vote
      @vote.up = params[:vote][:up]
      @vote.save
    else
      @vote = current_user.votes.create(params[:vote])
    end
    redirect_to :back
  end
end 
```

# sql - 最大返回自联接的所有值

> ID：14447909
> 
> 赞同：2
> 
> 时间：2013-01-21T21:53:12.347
> 
> 标签：sql, plsql

我的问题需要我从表中查询数据，并包含一列来计算增加百分比。我只需要使用 MAX 提取增长百分比最高的记录。我认为我在正确的轨道上，但由于某种原因，它返回所有记录，尽管有条款只要求最大值。

```
Select
  O.Grocery_Item,
  TO_CHAR(sum(g.Price_IN_2000), '$99,990.00') TOTAL_IN_2000,
  TO_CHAR(sum(g.Estimated_Price_In_2025), '$99,990.00') TOTAL_IN_2025,
  TO_CHAR(Round(O.MY_OUTPUT),'9,990') || '%' as My_Output
From
  GROCERY_PRICES g,
  (SELECT
     GROCERY_ITEM,
     (((sum(Estimated_Price_In_2025) -
        sum(Price_IN_2000))/sum(Price_IN_2000))*100) MY_OUTPUT
   FROM
     GROCERY_PRICES
   GROUP BY GROCERY_ITEM) O
Where
  G.GROCERY_ITEM = O.GROCERY_ITEM 
GROUP BY
  O.GROCERY_ITEM, O.MY_OUTPUT
Having
  my_output IN (select Max(O.MY_OUTPUT) from GROCERY_PRICES); 
```

结果：

```
GROCERY_ITEM                   TOTAL_IN_2000 TOTAL_IN_2025 MY_OUTPUT
------------------------------ ------------- ------------- ---------
M_004                                $2.70         $5.65      109%   
B_001                                $0.80         $2.64      230%   
T_006                                $5.70         $6.65       17%   
B_002                                $2.72         $7.36      171%   
E_001                                $0.62         $1.78      187%   
R_003                                $4.00        $13.20      230%   

 6 rows selected 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:16:34.503

You can simplify your query so you only select from the Groceries table once since your `My_Output` column is only a function of numbers you are already producing the self join is not necessary. Then I've used RANK to get the top records (although if you are not concerned about ties ROWNUM will work better):

```
SELECT  g.Grocery_Item,
        g.TOTAL_IN_2000,
        g.TOTAL_IN_2025,
        g.My_Output
FROM    (   SELECT  Grocery_Item,
                    TO_CHAR(TOTAL_IN_2000, '$99,990.00') TOTAL_IN_2000,
                    TO_CHAR(TOTAL_IN_2025, '$99,990.00') TOTAL_IN_2025,
                    TO_CHAR(ROUND(((TOTAL_IN_2025 / TOTAL_IN_2000) - 1) * 100), '9,990') || '%' as My_Output,
                    RANK() OVER(PARTITION BY Grocery_Item ORDER BY (TOTAL_IN_2025 / TOTAL_IN_2000) - 1 DESC) AS GroceryRank
            FROM    (   SELECT  g.Grocery_Item,
                                SUM(g.Price_IN_2000) TOTAL_IN_2000,
                                SUM(g.Estimated_Price_In_2025) TOTAL_IN_2025
                        FROM    GROCERY_PRICES g
                        GROUP BY g.Grocery_Item
                    ) g
        ) g
WHERE   GroceryRank = 1; 
```

I've also simplified your percentage calculation.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:09:36.027

试试这个：

```
select *
from (Select O.Grocery_Item, TO_CHAR(sum(g.Price_IN_2000), '$99,990.00') TOTAL_IN_2000,
             TO_CHAR(sum(g.Estimated_Price_In_2025), '$99,990.00') TOTAL_IN_2025,
             TO_CHAR(Round(O.MY_OUTPUT),'9,990') || '%' as My_Output
      From GROCERY_PRICES g join
           (SELECT GROCERY_ITEM,
                   (((sum(Estimated_Price_In_2025) -
                    sum(Price_IN_2000))/sum(Price_IN_2000))*100
                    ) MY_OUTPUT
            FROM GROCERY_PRICES
            GROUP BY GROCERY_ITEM
           ) O
           on G.GROCERY_ITEM = O.GROCERY_ITEM 
      GROUP BY O.GROCERY_ITEM, O.MY_OUTPUT
      ORDER BY my_output desc
     ) t
where rownum = 1 
```

问题是您的子查询只有外部引用。因此，`o.my_output`来自外部表，而不是`from`子查询中的子句。您正在将一个值与其自身进行比较，对于非 NULL 值，它始终为真。

由于您想要最大值，因此最简单的方法是对列表进行排序并取第一行。您也可以使用分析函数执行此操作，但 rownum 通常更有效。

# jquery - 用 jQuery 逗号分隔的错误列表

> ID：14447910
> 
> 赞同：0
> 
> 时间：2013-01-21T21:53:16.230
> 
> 标签：jquery, list, error-handling, comma

我正在尝试创建一个逗号分隔的列表。我不想确保最后一行没有逗号。

这是我到目前为止没有任何逗号的数据：

```
var labelText = $(this).attr("placeholder");
$('div.errors').append(''+labelText+' Required'); 
```

不确定我是否应该为此使用 map() 函数或执行某种 if 语句？任何帮助/输入表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:04:14.037

您可以使用[Array.join()](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/join)

```
var colors = ["Orange", "Blue", "Red", "Green"];
var string = colors.join(); // Orange, Blue, Red, Green 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-22T17:27:50.960

看不到其余代码，您可能有一个变量

```
var errorComma = ""; //Initialized to blank 
```

然后在执行附加的代码中

```
var labelText = $(this).attr("placeholder");
$('div.errors').append(errorComma +labelText+' Required');
errorComma =","; 
```

因此，第一个调用在逗号位置将有一个空字符串，并且所有后续调用都将包含逗号。

# mongodb - 如何更新 Mongo 中的字段值以等于同一文档中另一个字段的值？

> ID：14447912
> 
> 赞同：3
> 
> 时间：2013-01-21T21:53:28.047
> 
> 标签：mongodb, pymongo

我有一些文件：

```
{"required" : 100, "total" : 30} 
```

我想更新文档，使得 required = total （无论 total 的值是什么）。我努力了：

`db.collection.update({}, {"$set" : {"required" : "total"}})`

但这将其设置为字符串文字“total”，在这种情况下，我如何访问该字段的值`30`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-05T07:35:23.370

你不能那样做。试试这个：

```
db.collection.find().forEach(function(d) {
    d.required = d.total;
    db.collection.save(d);
}); 
```

# shell - 用于替换 xml 文档中的日期格式的 shell 脚本

> ID：14447913
> 
> 赞同：1
> 
> 时间：2013-01-21T21:53:32.503
> 
> 标签：shell, date, cron

> **可能重复：**
> [如何从命令行更改日期格式？](https://stackoverflow.com/questions/279329/how-can-i-change-the-format-of-a-date-from-the-command-line)

我正在运行一个下载和 XML 文件的夜间 cron 作业。XML 文件的日期格式如下：

```
<date>2011-09-30</date> 
```

我想设置第二个 cron 作业，将每个日期更改为如下格式：

```
<date>September 30</date> 
```

然后保存文件。

有没有用 shell 脚本来做这件事的好方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:02:39.727

使用[Xpath](http://en.wikipedia.org/wiki/XPath)和 shell 工具的解决方案：

XML 示例：

```
$ cat sample.xml
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<doc>
<date>2011-09-30</date>
</doc> 
```

`xmllint`使用Xpath[获取](http://en.wikipedia.org/wiki/XPath)日期：

```
$ dat=$(xmllint --xpath '/doc/date/text()' sample.xml )
$ echo $dat
2011-09-30 
```

现在，翻译日期的格式：

```
$ new_dat=$(date -d "$dat" "+%B %d") 
```

（如果您想要当前日期，只需使用`new_dat=$(date "+%B %d")`）

使用以下命令编辑 xml `xmlstarlet`：

```
$ xmlstarlet edit -L -u "/doc/date" -v "$new_dat" sample.xml 
```

最后

```
$ cat sample.xml
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<doc>
  <date>septembre 30</date>
</doc> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:57:45.677

你可以使用这个：

```
date '+%Y-%m-%dT%T.%N' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T22:47:06.437

用于将具有一种日期格式的文件过滤（标准输入到标准输出）到另一种日期格式的 Bash 语法...

```
while read line; do
  case "$line" in
    '<date>'*)
      echo '<date>'
      date -j -f %F `echo "$line" | sed -e 's/<date>//' -e 's-</date>--'` '+%B %d'
      echo '</date>'
      ;;
    *)
      echo "$line"
      ;;
  esac
done 
```

# android - BroadcastReceiver 意图不接收额外内容

> ID：14447919
> 
> 赞同：3
> 
> 时间：2013-01-21T21:53:59.773
> 
> 标签：android, broadcastreceiver

我有一个很奇怪的问题。

我正在发送广播并设置一些附加内容，但接收者没有收到它们：

发送：

```
private void notifyAboutDownload(String reference, Context ctx) {
    Intent i = new Intent(InitialActivity.ACTION_PACKAGE);
    i.setAction(InitialActivity.ACTION_DOWNLOAD_COMPLEATED);
    i.putExtra(InitialActivity.DOWNLOAD_ID, reference);

    ctx.sendBroadcast(i);

} 
```

并接收：

```
public void onReceive(Context context, Intent intent) {

        String downloadID =   intent.getExtras().getString(InitialActivity.DOWNLOAD_ID);

        Log.i(TAG, "downloadID :  "+ downloadID);
    }
}; 
```

由于某种原因，downloadID 为空。有什么提示吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-04T17:41:16.523

尝试像这样设置您的意图

```
Intent i = new Intent(getApplicationContext(), MyReceiver.class); 
```

# python - 将 Pandas 数据框 NaN 迭代并写入 MySQL

> ID：14447925
> 
> 赞同：1
> 
> 时间：2013-01-21T21:54:04.197
> 
> 标签：python, mysql, iteration, pandas

我正在尝试将回归的结果写回 MySQL，但是在迭代拟合值并使 NaN 写为空值时遇到问题。最初，我是这样进行迭代的：

```
for i in dataframe:
    cur = cnx.cursor()
    query = ("UPDATE Regression_Data.Input SET FITTEDVALUES="+(dataframe['yhat'].__str__())+" where timecount="+(datafrane['timecount'].__str__())+";")
    cur.execute(query)
    cnx.commit()
    cur.close() 
```

.....哪个SQL返回给我说：

```
 "mysql.connector.errors.ProgrammingError: 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'NaN' 
```

因此，我一直试图通过仅在 yhat 不等于 NaN 时要求 Python 提交来过滤掉 NaN：

```
for i in dataframe:
    if cleandf['yhat']>(-1000):
        cur = cnx.cursor()
        query = ("UPDATE Regression_Data.Input SET FITTEDVALUES="+(dataframe['yhat'].__str__())+" where timecount="+(datafrane['timecount'].__str__())+";")
        cur.execute(query)
        cnx.commit()
       cur.close() 
```

但后来我明白了：

```
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all() 
```

所以，我尝试在上面的语法中解决这个问题：

```
if cleandf['yhat'][i]>(-1000): 
```

但然后得到这个：

```
ValueError: Can only tuple-index with a MultiIndex 
```

然后尝试将 itterows() 添加到两者中，如下所示：

```
 for i in dataframe.iterrows():
        if cleandf['yhat'][i]>(-1000): 
```

但遇到与上述相同的问题。

我不确定我在这里做错了什么，但假设它与 Pandas DataFrames 中的迭代有关。但是，即使我的迭代正确，我也想将 Null 写入出现 NaN 的 SQL 中。

那么，你觉得我应该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T20:15:59.947

我没有完整的答案，但也许我有一些可能会有所帮助的提示。我相信您将您的`dataframe`视为类似于 SQL 记录集的对象。

```
for i in dataframe 
```

这将遍历数据框中的列名字符串。 `i`将采用列名，而不是行。

```
dataframe['yhat'] 
```

这将返回一整列（`pandas.Series`，即 a `numpy.ndarray`），而不是单个值。所以：

```
dataframe['yhat'].__str__() 
```

将给出对人类阅读有用的整个列的字符串表示。它肯定不是可以转换为字符串以供您查询的单个值。

```
if cleandf['yhat']>(-1000) 
```

这会产生一个错误，因为同样，`cleandf['yhat']`它是一个完整的值数组，而不仅仅是一个值。将其视为一整列，而不是单行的值。

```
if cleandf['yhat'][i]>(-1000): 
```

这越来越接近了，但你真的想`i`在这里成为一个整数，而不是另一个列名。

```
for i in dataframe.iterrows():
    if cleandf['yhat'][i]>(-1000): 
```

使用`iterrows`似乎对你来说是正确的。但是，`i`采用每行的值，而不是可以索引到列的整数（`cleandf['yhat']`是一个完整的列）。

另外，请注意，与依赖巨大的负数相比，pandas 有更好的方法来检查缺失值。尝试这样的事情：

```
non_missing_index = pandas.isnull(dataframe['yhat'])
cleandf = dataframe[non_missing_index]
for row in cleandf.iterrows():
    row_index, row_values = row
    query = ("UPDATE Regression_Data.Input SET FITTEDVALUES="+(row_values['yhat'].__str__())+" where timecount="+(row_values['timecount'].__str__())+";")
    execute_my_query(query) 
```

你可以`execute_my_query`比我更好地实现，我期望。然而，这个解决方案并不是你想要的。您真的想遍历所有行并执行两种类型的插入。尝试这个：

```
for row in dataframe.iterrows():
    row_index, row_values = row
    if pandas.isnull(row_values['yhat']):
        pass # populate the 'null' insert query here
    else:
        query = ("UPDATE Regression_Data.Input SET FITTEDVALUES="+(row_values['yhat'].__str__())+" where timecount="+(row_values['timecount'].__str__())+";")
    execute_my_query(query) 
```

希望能帮助到你。

# perl - Perl：搜索在特定时间差内发生的模式

> ID：14447931
> 
> 赞同：0
> 
> 时间：2013-01-21T21:54:28.290
> 
> 标签：perl, pattern-matching, timedelta

首先是我的问题：我有一个文档，我想在其中搜索两种模式。在每一行中，都有一个时间戳。所以也有时间与模式一致。

现在我只想获得这两种模式，它们发生在某个时差或时差高于我输入的时间（我想确定）的地方。喜欢：

```
19:03 Pattern1 
19:04 Pattern2
20:04 Pattern1
20:10 Pattern2

time difference: 4 sec 
```

我计算了绝对时间和差异。模式匹配没有问题。但我的问题是给出时间差大于例如 4 秒的所有线条/图案的线条。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:17:02.820

你忘了问一个问题！也许你想要匹配的线条？

```
my ($pat1_time, $pat1_line); 
while (<>) {
   my $time = ...;
   if (/pat1/) {
      $pat1_line = $_;
      $pat1_time = $time;
   }
   if (/pat2/) {
      if ($time - $pat1_time > 4) {
         print($pat1_line);
         print($_);
      }
   }
} 
```

# bluetooth - Bluetooth for ARM embedded linux

> ID：14447943
> 
> 赞同：1
> 
> 时间：2013-01-21T21:55:39.857
> 
> 标签：bluetooth, arm, embedded-linux, obex, bluez

I'm struggling now for a few days to setup bluetooth services on an ARM embedded device running Linux. I'm using a bluetooth dongle connected via USB.

Let's start with the beginning. I had to compile myself all the required packages, and that means expat, dbus, zlib, libffi, glib, bluez-3.36-libs and bluez-3.36-utils (yeah 3.36, I know they're old but so is my cross-compiler), libopenobex-1.3, obexd-0.3, obexftp. Then I put the binaries and libs on the device. Also, bluetooth is enabled in kernel.

I'm able to activate the bluetooth using `hciconfig hci0 up` command, I can perform scan using `hcitool scan`, I can even ping with l2ping previously discovered devices.

What I want is to be able to transfer files between that ARM device and another bluetooth device using ftp protocol and here my problems begin.

1.  Are these the only tools that I need?

2.  After putting everything on the device, I turn on bluetooth using `hciconfig hci0 up`, then I start dbus daemon using `dbus-launch` and after these I try to start obexd. When I run `dbus-launch`, it prints the values for DBUS_SESSION_BUS_ADDRESS and some pid and next when I try to start obexd it asks me to set the DBUS_SESSION_BUS_ADDRESS. Is this normal because I read that you have to set this only for test purposes? What is the default (real) dbus session bus address? How should I properly configure dbus?

3.  I tend to think that the problem is in the pairing process, when the two bluetooth devices are trying to authenticate. How can I do this from command line as this is all that I have (no GUI)?

4.  Could you please present me the detailed step to follow in order to achieve my goal. I tried to learn more about them from the Internet and also I tried to find these steps online but I could not find what I need.

5.  Could you please explain me the difference between obexd, obexd-client, obexd-server, obex-data-server, obexftp? Are they meant to be used together or they offer the same functionalities? I could not clarify this from their man pages.

I know this is a really long post with a lot of questions, but I don't have experience with bluetooth and I'm under time pressure to solve this. Any help would be kindly appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T12:57:26.350

Many questions you raised, but will try to answer them :

1.  Thatz pretty much everything you will need.

2.  Why are you starting session bus ? Will not starting system bus help and hcid uses system bus( as far as i know ). You need to execute the cross-compiled obexd ( or any other utility) with correct parameters.

3.  you can use simple-agent ( it is in tools dir in 3.36 release if i am not wrong ). In a non-gui mode ( simple-agent --default [ follower by your pincode ] ) will work.

4.  Basically you will need to find a device ( do scan ), authenticate ( pair ) and then proceed with file transfer which will involve obex level request / response ( to put in simple words).

5.  As much i know, initially obexftp / obex-push were the only standalone utilities that worked on top of openobex for file transfer. Obex-data-serer was developed as part of GSOC competition, which got included in major distros. obexd is the slimmer version of obex-data-server specifically designed for embedded usage and is closely integrated with hcid ( and bluetoothd later). Please use only one of the utilities and not all at same time.

# r - predict 如何处理包含 AsIs 函数的模型？

> ID：14447944
> 
> 赞同：0
> 
> 时间：2013-01-21T21:55:41.977
> 
> 标签：r, modeling, predict

我有模型`lm(y~x+I(log(x))`，我想根据我的模型`predict`来预测包含 的新值的新数据框`x`。predict 如何处理`I`模型中的 AsIs 函数？是否`I(log(x))`需要在 of 的`newdata`参数中额外指定`predict`或`predict`理解它应该构造和使用`I(log(x))`from `x`？

**更新**

@DWin：变量进入模型的方式会影响系数，尤其是对于交互作用。我的例子很简单，但试试这个

```
x<-rep(seq(0,100,by=1),10)
y<-15+2*rnorm(1010,10,4)*x+2*rnorm(1010,10,4)*x^(1/2)+rnorm(1010,20,100)
z<-x^2

plot(x,y)
lm1<-lm(y~x*I(x^2))
lm2<-lm(y~x*x^2)
lm3<-lm(y~x*z)

summary(lm1)
summary(lm2)
summary(lm3) 
```

您会看到 lm1=lm3，但 lm2 有所不同（只有 1 个系数）。假设您不想创建虚拟变量`z`（对于大型数据集计算效率低下），构建像 lm3 这样的交互模型的唯一方法是使用`I`. 同样，这是一个非常简单的示例（可能没有统计意义），但它在复杂模型中是有意义的。

@Ben Bolker：我想避免猜测并尝试寻求权威答案（我无法直接用我的模型检查这一点，因为它们比示例复杂得多）。我的猜测是`predict`正确地假设并构建`I(log(x))`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T23:05:18.770

你不需要让你的变量名看起来像 term `I(x)`。只需在 newdata 参数中使用“x”。

原因`lm(y~x*I(x^2))`和`lm(y~x*x^2)`不同之处在于“^”和“*”是 R 中公式的保留符号。`log`函数不是这种情况。交互只能用 构建也是不正确的`I()`。如果您想要 R 中的二次多项式，您应该使用`poly(x, 2)`. 如果您使用 I(log(x)) 或仅使用 I(log(x)) 构建，`log(x)`您应该得到相同的模型。`predict`如果您使用，它们都将正确转换为预测值：

```
newdata=dataframe( x=seq( min(x), max(x), length=10) ) 
```

使用`poly`将保护您免受因使用`I(x^2)`.

# mysql - 是什么导致本地 mysql 服务器查询速度出现随机峰值？

> ID：14447945
> 
> 赞同：0
> 
> 时间：2013-01-21T21:55:42.887
> 
> 标签：mysql, sql, phpmyadmin

因此，当我在 phpMyAdmin 中的本地主机上玩耍并使用 SQL 做一些事情时，我意识到执行数据库查询所需的时间会随机出现巨大的峰值。我有一个包含大约 3000 个条目的数据库表，我正在运行一个非常简单的查询来显示其中的前 2500 个。

平均而言，运行此查询大约需要 0.003 到 0.004 秒。（当然，加载 phpMyAdmin 页面需要更长的时间，但我们只是查看查询时间。）但是，我注意到查询时间偶尔会超过 0.01。一旦它甚至飙升至0.04。因此，我的好奇心越来越强，我决定重复运行相同的查询，并生成我的结果图表：

![在此处输入图像描述](../Images/58f7413e81ad6f03888051b2862146fa.png)

我没有在我的计算机上运行任何其他可能与 MySQL 交互的东西，而且因为它是我的本地主机，所以我是唯一一个对我的数据库做任何事情的人（对吧？）。轻微的异常值是可以理解的，但是是什么导致加载时间从 3 倍增加到 30 倍，看起来完全是随机的？

谁能帮我满足我的好奇心？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:00:57.877

即使您的数据库在本地主机上运行，​​它也不是完全孤立地运行的。它正在与您正在运行的所有其他进程竞争您的系统资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:59:38.793

> 我没有在我的计算机上运行任何其他可能与 MySQL 交互的东西

但是您的计算机上是否还有其他运行的东西可能会定期与您的硬盘驱动器/CPU 交互？因为这可以解释尖峰。也许扫描正在运行的进程，并将 cpu/磁盘活动与峰值进行比较。

# python - Emacs 延迟错误

> ID：14447948
> 
> 赞同：4
> 
> 时间：2013-01-21T21:55:51.687
> 
> 标签：python, emacs

我已经`jedi-emacs`使用安装了 Emacs 包`M-x package install`

和以下 Python 包：

*   `Jedi`
*   `EPC`
*   `argparse`

使用：

*   `pip install --install-option="--prefix=~/.my_python_packages/" jedi`
*   `pip install --install-option="--prefix=/.my_python_packages/" epc`
*   `pip install --install-option="--prefix=/.my_python_packages/" argparse`

因为我没有root权限。

当我打开 Python 文件时，无论我将光标放在哪里，都会在 minibuffer 中收到以下错误：

`deferred error : (error Server may raise an error : Traceback (most recent call last): File "/home/avazquez/.emacs.d/elpa/jedi-20130119.830/jediepcserver.py", line 261, in <module> )`

可能是什么原因造成的？

这是与`Emacs 24.2.1`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T19:34:28.920

I found the solution to my problem. I did not have `PYTHONPATH` set up correctly (it should include the corresponding paths for `/path/to/custom-packages`).

For more info on this issue see the corresponding ticket in the [package repository for emacs-jedi](https://github.com/tkf/emacs-jedi/issues/22).

# javascript - jquery (this) 交叉函数

> ID：14447949
> 
> 赞同：0
> 
> 时间：2013-01-21T21:55:57.093
> 
> 标签：javascript, jquery

> **可能重复：**
> [Jquery get .val](https://stackoverflow.com/questions/14490563/jquery-get-val)

我已经修改了这个问题。我需要的是“这个”值

```
( $(this).attr("value")); 
```

出现在“这个”的

```
$("#activities_" +btn_id).val($(this).val()); 
```

这是代码。

```
$('.thoughts_list').click(function(){
    ( $(this).attr('id'));
    ( $(this).attr("value"));
}); 
    $('#close_thoughts').click(function(){

    $("#activities_" +btn_id).val($(this).val());   
}); 
```

目前，返回的值是“取消”，这是“#close_thoughts”的值，而不是我需要点击的“.thoughts列表”的值

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:04:51.683

```
var btn_id = '';
var radio_value = '';

$('.thoughts_list').click(function(){
    btn_id = this.id;
    radio_value = $('someRadioElement').prop('value');
});

$('.close_thoughts').click(function(){
    $( "#activities_" + btn_id ).val( radio_value  );
}); 
```

# powershell - 比较多个文件夹的文件差异

> ID：14447950
> 
> 赞同：2
> 
> 时间：2013-01-21T21:55:59.293
> 
> 标签：powershell, powershell-2.0

我开始比较 2 个文件夹结构以查找日期和大小不匹配的文件，但要求已更改为 4 个文件夹，我被卡住了。

所以这就是我想要做的：我们将数百个文件夹\文件上传到 4 个不同的服务器。文件必须全部匹配。有时文件无法正确复制。所以我需要一个脚本来读取所有四个目录并比较所有文件以确保它们按大小和日期匹配。输出应该只是一个简单的列表，向我显示不匹配的文件。

有任何想法吗？谢谢。

我可以做两个文件夹，但丢失了四个。此外，此输出令人困惑。不知道如何只列出那些不匹配的。

```
 $path1 = "\\path\folder
    $path2 = "\\path\folder1
    $dif = Compare-Object -ReferenceObject $path1 -DifferenceObject $path2 -Property FullName, Length, LastWriteTime
    $dif | ft -AutoSize 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:24:02.690

尝试这个：

请记住，`PrimaryPath`必须是主位置（内容正确）。此外，与您编写路径的方式保持一致（如果您包含`\`或不包含）。前任。用于`c:\folders\folder1\`所有路径或`c:\folders\folder1`.

比较.ps1

```
Param( 
    [parameter(Mandatory=$true)] [alias("p")] [string]$PrimaryPath,
    [parameter(Mandatory=$true)] [alias("c")] [string[]]$ComparePath
    ) 

#Get filelist with relativepath property
function Get-FilesWithRelativePath ($Path) {
    Get-ChildItem $Path -Recurse | ? { !$_.PSIsContainer } | % { 
        Add-Member -InputObject $_ -MemberType NoteProperty -Name RelativePath -Value $_.FullName.Substring($Path.Length)
        $_
    }
}

#If path exists and is folder
if (Test-Path $PrimaryPath -PathType Container) {
    #Get master fileslist
    $Masterfiles = Get-FilesWithRelativePath (Resolve-Path $PrimaryPath).Path

    #Compare folders
    foreach ($Folder in $ComparePath) {
        if (Test-Path $Folder -PathType Container) {
            #Getting filelist and adding relative-path property to files
            $ResolvedFolder = (Resolve-Path $Folder).Path
            $Files = Get-FilesWithRelativePath $ResolvedFolder

            #Compare and output filepath to missing or old file
            Compare-Object -ReferenceObject $Masterfiles -DifferenceObject $Files -Property RelativePath, Length, LastWriteTime | ? { $_.SideIndicator -eq "<=" } | Select @{n="FilePath";e={Join-Path $ResolvedFolder $_.RelativePath}}
        } else { Write-Error "$Folder is not a valid foldername. Foldertype: Compare" }
    }

} else { Write-Error "$PrimaryPath is not a valid foldername. Foldertype: Master" } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:35:31.480

我会使用基于哈希的方法来解决它，并且可能使用数据库表来帮助自己。顺便说一句，[PSCX](http://pscx.codeplex.com/)具有`Get-Hash`可帮助您执行此操作的命令行开关。

**基本方法**

遍历每个服务器所需的文件夹树（出于性能原因，您希望在所涉及的服务器**上**执行此操作，而不是通过网络共享！）并为您找到的每个文件生成哈希。将散列值、完整路径和服务器名称存储在某处，最好是可从所有四台服务器访问的数据库表——这将使处理变得更加容易。

然后，如果您使用过数据库表，请编写一些简单的查询：

1.  找到少于 4 个散列实例的任何散列。
2.  找到具有不同哈希值的任何文件路径（您可能必须处理路径字符串以将其获取到每个服务器的相同相对根目录）（尽管这可能被上面的 1\. 覆盖）。

当然，所有这些都可以在 PS 中完成。

**为什么这种做事方式可能会有所帮助**

1.  您不必运行四向比较对象。哈希值可作为您的比较点。
2.  生成哈希的 Powershell 代码是在每台服务器上运行的相同函数。
3.  它可以扩展。您可以轻松地为 100 个文件夹执行此操作。
4.  您最终会得到一些易于操作和“分发”的东西，即可以访问所涉及的服务器——数据库表。

**缺点**

PSCX Get-Hash 不是很快。这可以通过让 PS 触发[一些更快的哈希生成命令来轻松解决，例如 md5sums](http://www.pc-tools.net/win32/md5sums/)。

**如何不使用数据库表**
1\. 在处理散列文件夹时，将散列、文件路径、服务器名写入每台服务器上的文件，并在完成后将这些文件带回。
2\. 将文件处理成一个哈希表，该哈希表键入哈希码并计算每个哈希码。3\. 您可以有一个并行哈希表（与 2\. 同时构建，当您通过结果文件时），将每个哈希码上的键连接到该哈希码的路径/服务器数组。
4\. 在哈希表 1 中查找计数小于 4 的哈希码。使用并行哈希表 2 查找计数小于 4 的哈希码，找出文件路径和服务器是。

# ruby-on-rails - 如何使用 mongoid + rails 3 从祖父访问孙子文件

> ID：14447951
> 
> 赞同：1
> 
> 时间：2013-01-21T21:56:14.490
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1, mongoid

```
class User
 include Mongoid::Document
 has_many :orders
 has_one :payments
end

class Order
 include Mongoid::Document
 belongs_to :user
 has_one :payment, dependent: :destroy, :autosave => true
end

class Payment
 include Mongoid::Document
 belongs_to :order
 belongs_to :user
ebd 
```

`user_controller.rb`行动上`jobs`：

```
def jobs
 #
 #
 jobs = Order.where(:seller_id => current_user.id).order_by :created_at, :desc
 @jobs = []
 for j in jobs
  if j.payment.preapproval_key != nil && j.payment.correlation_id != nil && j.payment.approved == true
   @jobs << j
  end
 end
 #
 #
end 
```

`payment.preapproval_key != nil && payment.correlation_id != nil && payment.approved == true`是否可以在不使用此循环的情况下过滤所有作业？

**有更好的方法来做到这一点吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T04:34:32.940

您可以在以下几行中做一些事情，仍然很少有数据库请求，但由于连接不可用，这是可以预料的。但它会小于您现在正在执行的 db 请求：

```
all_order_ids = Order.where(:seller_id => current_user.id).only(:_id).map(&:id)
payments = Payment.where(:order_id.in => all_order_ids, 
                         :preapproval_key.ne => nil,
                         :correlation_id.ne => nil,
                         :approved => true)
jobs = Order.where(:_id.in => payments.only(:order_id).map(&:order_id)) 
```

# php - 从我的自定义库中调用 Zend FlashMessanger

> ID：14447956
> 
> 赞同：0
> 
> 时间：2013-01-21T21:56:23.730
> 
> 标签：php, zend-framework, zend-form, zend-studio

我在网上搜索过，但找不到任何示例，所以也许您知道这是否可能以及这是否是一个好主意。

我写了一个`adminloginCheck()`位于`library/myNameSpace/LoginCheck.php`

我移动了`preDispatch()`我的控制器内部的代码，`preDispatch()`我正在调用`$mynamespace->adminloginCheck();`

在我的`predispatch()`我有一个 FlashMessanger`$this->_helper->FlashMessenger($message);`

但它看起来（并且肯定不会）`$this->_helper->FlashMessenger($message)`在我自己的班级中不起作用 -`library/myNameSpace/LoginCheck.php`

所以我的问题是 - 如何`FlashMessenger`在我自己的班级中从控制器外部调用。

我`$auth = Zend_Auth::getInstance();`直接在里面打电话。那么如何用 FlashMessanger 做同样的事情呢？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:01:09.913

尝试：

```
$messenger = new Zend_Controller_Action_Helper_FlashMessenger();
$messenger->addMessage('hello');
$messages = $messenger->getMessages();
... 
```

# java - XML获取所有同名节点

> ID：14447960
> 
> 赞同：3
> 
> 时间：2013-01-21T21:56:36.300
> 
> 标签：java, xml

我有如下所示的 xml 文档：

```
<?xml version="1.0"?>
<root>
    <success>true</success>
    <note>
        <note_id>32219</note_id>
        <the_date>1336763490</the_date>
        <member_id>108649</member_id>
        <area>6</area>
        <note>Note 123123123</note>
    </note>
    <note>
        <note_id>33734</note_id>
        <the_date>1339003652</the_date>
        <member_id>108649</member_id>
        <area>1</area>
        <note>This is another note.</note>
    </note>
    <note>
        <note_id>49617</note_id>
        <the_date>1343050791</the_date>
        <member_id>108649</member_id>
        <area>1</area>
        <note>this is a 3rd note.</note>
    </note>
</root> 
```

我想获取该文档，获取所有 `<note>`标签并将它们转换为字符串，然后将它们传递给我的 XML 类并将 XML 类放入数组列表中。我希望这是有道理的。所以这是我试图用来获取所有`<note>`标签的方法。

```
public ArrayList<XML> getNodes(String root, String name){
    ArrayList<XML> elList = new ArrayList<>();
    NodeList nodes = doc.getElementsByTagName(root);
    for(int i = 0; i < nodes.getLength(); i++){
        Element element = (Element)nodes.item(i);
        NodeList nl = element.getElementsByTagName(name);
        for(int c = 0; c < nl.getLength(); c++){
            Element e = (Element)nl.item(c);
            String xmlStr = this.nodeToString(e);
            XML xml = new XML();
            xml.parse(xmlStr);
            elList.add(xml);
        }
    }
    return elList;
}

private String nodeToString(Node node){
    StringWriter sw = new StringWriter();
    try{
        Transformer t = TransformerFactory.newInstance().newTransformer();
        t.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "yes");
        t.transform(new DOMSource(node), new StreamResult(sw));
    }catch(TransformerException te){
        System.out.println("nodeToString Transformer Exception");
    }
    return sw.toString();
} 
```

所以，我的问题是，我怎样才能将每个`<note>`标签作为一个字符串？有了我现在得到的代码，我得到的`null`只是`String xmlStr = e.getNodeValue();`.

**编辑**
我编辑了我的主要代码，这似乎有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:35:19.883

**澄清后更新**

`<note>`您可以使用 XPath找到所有元素。

这将允许您简单地隔离每个节点。然后，您可以根据找到的节点创建一个新文档并将其转换回字符串

```
public class TestXML01 {

    public static void main(String[] args) {

        String xml = "<?xml version=\"1.0\"?>";
        xml += "<root>";
        xml += "<success>true</success>";
        xml += "<note>";
        xml += "<note_id>32219</note_id>";
        xml += "<the_date>1336763490</the_date>";
        xml += "<member_id>108649</member_id>";
        xml += "<area>6</area>";
        xml += "<note>Note 123123123</note>";
        xml += "</note>";
        xml += "<note>";
        xml += "<note_id>33734</note_id>";
        xml += "<the_date>1339003652</the_date>";
        xml += "<member_id>108649</member_id>";
        xml += "<area>1</area>";
        xml += "<note>This is another note.</note>";
        xml += "</note>";
        xml += "<note>";
        xml += "<note_id>49617</note_id>";
        xml += "<the_date>1343050791</the_date>";
        xml += "<member_id>108649</member_id>";
        xml += "<area>1</area>";
        xml += "<note>this is a 3rd note.</note>";
        xml += "</note>";
        xml += "</root>";

        ByteArrayInputStream bais = null;

        try {
            bais = new ByteArrayInputStream(xml.getBytes());
            DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
            factory.setNamespaceAware(false);
            DocumentBuilder builder = factory.newDocumentBuilder();
            Document xmlDoc = builder.parse(bais);

            Node root = xmlDoc.getDocumentElement();

            XPathFactory xFactory = XPathFactory.newInstance();
            XPath xPath = xFactory.newXPath();

            XPathExpression xExpress = xPath.compile("/root/note");
            NodeList nodes = (NodeList) xExpress.evaluate(root, XPathConstants.NODESET);

            System.out.println("Found " + nodes.getLength() + " note nodes");

            for (int index = 0; index < nodes.getLength(); index++) {
                Node node = nodes.item(index);
                Document childDoc = builder.newDocument();
                childDoc.adoptNode(node);
                childDoc.appendChild(node);
                System.out.println(toString(childDoc));
            }

        } catch (Exception exp) {
            exp.printStackTrace();
        } finally {
            try {
                bais.close();
            } catch (Exception e) {
            }
        }
    }

    public static String toString(Document doc) {

        String sValue = null;

        ByteArrayOutputStream baos = null;
        OutputStreamWriter osw = null;

        try {
            baos = new ByteArrayOutputStream();
            osw = new OutputStreamWriter(baos);

            Transformer tf = TransformerFactory.newInstance().newTransformer();
            tf.setOutputProperty(OutputKeys.INDENT, "yes");
            tf.setOutputProperty(OutputKeys.METHOD, "xml");
            tf.setOutputProperty("{http://xml.apache.org/xslt}indent-amount", "4");

            DOMSource domSource = new DOMSource(doc);
            StreamResult sr = new StreamResult(osw);
            tf.transform(domSource, sr);

            osw.flush();
            baos.flush();
            sValue = new String(baos.toByteArray());
        } catch (Exception exp) {
            exp.printStackTrace();
        } finally {
            try {
                osw.close();
            } catch (Exception exp) {
            }
            try {
                baos.close();
            } catch (Exception exp) {
            }
        }
        return sValue;
    }
} 
```

这现在输出...

```
Found 3 note nodes
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<note>
    <note_id>32219</note_id>
    <the_date>1336763490</the_date>
    <member_id>108649</member_id>
    <area>6</area>
    <note>Note 123123123</note>
</note>

<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<note>
    <note_id>33734</note_id>
    <the_date>1339003652</the_date>
    <member_id>108649</member_id>
    <area>1</area>
    <note>This is another note.</note>
</note>

<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<note>
    <note_id>49617</note_id>
    <the_date>1343050791</the_date>
    <member_id>108649</member_id>
    <area>1</area>
    <note>this is a 3rd note.</note>
</note> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:24:57.630

使用 XPath，以下代码：

```
public class NotesExtractor {
   public static List< String > getTextOf( Document doc, String tagName )
      throws Exception
   {
      List< String > notes  = new ArrayList<>();
      XPathFactory xPathFactory = XPathFactory.newInstance();
      XPath xPath = xPathFactory.newXPath();
      NodeList xText =
         (NodeList)xPath.evaluate(
            "//" + tagName + "/text()", doc, XPathConstants.NODESET );
      for( int i = 0; i < xText.getLength(); ++i ) {
         Text textElt = (Text)xText.item( i );
         String noteTxt = textElt.getTextContent().trim();
         if( ! noteTxt.isEmpty())
         {
            notes.add( noteTxt.trim());
         }
      }
      return notes;
   }

   public static void main( String[] args ) throws Exception {
      DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
      dbf.setIgnoringElementContentWhitespace( true );
      DocumentBuilder db = dbf.newDocumentBuilder();
      Document doc = db.parse( "Notes.xml" );
      System.out.println( getTextOf( doc, "note" ));
   } 
```

输出：

```
[Note 123123123, This is another note., this is a 3rd note.] 
```

# sql - 需要找到一种使用一条 SQL 更新 ORACLE 9 中的多行的最佳方法

> ID：14447962
> 
> 赞同：1
> 
> 时间：2013-01-21T21:56:48.950
> 
> 标签：sql, oracle, ora-01427

问题描述：需要从平面文件匹配和更新新的描述（如果不同）生产表。在 temptable 中导入了平面文件。

```
sample from prod table:
[mstr_plan]

char(5)    varchar2(30) char(3)
PLAN_CODE PLAN_DESC FIN_CLUSTER
BB123     Plan_desc3 Z01
BB124     Plan_desc4 Z02
BB125     Plan_desc5 Z02
BB126     Plan_desc6 Z03
BB127     Plan_desc7 Z04
BB128     Plan_desc8 Z06
<about 500 records>

tmptbl01 <new records from flat file)
PLAN_CODE PLAN_DESC    FIN_CLUSTER
BB123     Plan_desc3    Z01
BB124     Plan_desc4    Z02
BB125     Plan_desc51   Z02
BB126     Plan_desc61   Z03
BB127     Plan_desc7    Z04
BB128     Plan_desc81   Z06
<about 150 records> 
```

选择查询：

```
select * from mstr_plan, tmptbl01
where mstr_plan.plan_code = tmptbl01.plan_code and 
(mstr_plan.PLAN_DESC <> tmptbl01.PLAN_DESC or
mstr_plan.FIN_CLUSTER <> tmptbl01.FIN_CLUSTER);

<in my database with 500 & 150 rows it returns 17 rows>
<in sample should return 3 rows>
PLAN_CODE PLAN_DESC    FIN_CLUSTER
BB125     Plan_desc51   Z02
BB126     Plan_desc61   Z03
BB128     Plan_desc81   Z06 
```

FIN_CLUSTER 没有变化。因此，将其从更新查询中取出。

```
UPDATE mstr_plan 
SET mstr_plan.PLAN_DESC = 
(select tmptbl01.plan_desc from mstr_plan, tmptbl01 where mstr_plan.plan_code=
 tmptbl01.plan_plan_code and mstr_plan.plan_desc <> mstr_plan.plan_desc )

where mstr_plan.PLAN_DESC = <or IN>
(select tmptbl01.plan_desc from mstr_plan, tmptbl01 where mstr_plan.plan_code=
 tmptbl01.plan_plan_code and mstr_plan.plan_desc <> mstr_plan.plan_desc ) 
```

返回 ORA-01427: 单行子查询返回多于一行

方法： <1> 手动逐一更新 17 条记录 <2> 了解一个粗略的方法来“and where with rownum = 1”。还没试过。

请推荐我更好的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:06:38.847

该错误是因为您已将`mstr_plan`表放在子查询中。

即使您更正了这一点，您的任何`UPDATE`陈述都不会起作用，因为它们包含`and mstr_plan.plan_desc <> mstr_plan.plan_desc`在`WHERE`子句中，使其始终为假。

通常最好使用`SELECT`您已有的变体并正确找到要更新的行。您只需要选择要更新的列和新值，然后更新此派生表：

```
UPDATE 
    ( SELECT mstr_plan.plan_desc 
           , tmptbl01.plan_desc AS new_plan_desc 
      FROM mstr_plan 
        JOIN tmptbl01 
          ON mstr_plan.plan_code = tmptbl01.plan_code 
      WHERE mstr_plan.plan_desc <> tmptbl01.plan_desc  
    ) 
SET plan_desc = new_plan_desc ; 
```

这样，如果您在代码中出错，您更新错误行的机会就会减少（如果您`WHERE`始终为 true 而不是始终为 false，您可能已经更新了`mstr_plan`表中的所有行，可能会将一些`NULL`值放在 (500-17 ) 不应更新的行。

您还可以使用别名使其更具可读性：

```
UPDATE 
    ( SELECT m.plan_desc 
           , t.plan_desc AS new_plan_desc 
      FROM mstr_plan  m
        JOIN tmptbl01  t
          ON m.plan_code = t.plan_code 
      WHERE m.plan_desc <> t.plan_desc  
    ) 
SET plan_desc = new_plan_desc ; 
```

# android - 删除 ListView 中的多个选定项

> ID：14447963
> 
> 赞同：1
> 
> 时间：2013-01-21T21:56:59.397
> 
> 标签：android, sqlite, listview, multiple-choice

我有一个显示数据库记录的列表视图。列表视图中的每一行都有一个复选框。我如何能...

1.  创建一个 toast 消息显示所选项目的值？
2.  识别用户在列表视图中选择的记录？
3.  遍历每个选定的项目并仅从数据库中删除列表视图中选定的行？

我一直在关注这个有用的教程：//http://www.vogella.com/articles/AndroidSQLite/article.html

```
public class PhoneNumberDataBaseListView extends ListActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        NumbersDataSource datasource = new NumbersDataSource(this);
        datasource.open();
        String number = "123";
        datasource.createNumber(number);
        List<Number> values = datasource.getAllNumbers();
        ArrayAdapter<Number> adapter = new ArrayAdapter<Number>(this, android.R.layout.simple_list_item_multiple_choice, values);
        setListAdapter(adapter);
    }

    public void deleteNumber() {
        NumbersDataSource datasource = new NumbersDataSource(this);
        datasource.open();
        ListView LV = (ListView) findViewById(android.R.id.list);
        List<Number> values = datasource.getAllNumbers();
        ArrayAdapter<Number> adapter = new ArrayAdapter<Number>(this, android.R.layout.simple_list_item_multiple_choice, values);
        setListAdapter(adapter);

        SparseBooleanArray checkedItems = LV.getCheckedItemPositions();
        for (int i = 0; i < checkedItems.size(); i++) {
            if(checkedItems.valueAt(i)) {
                Number item = adapter.getItem(i);
                Toast t = Toast.makeText(this, item.getNumber().toString(), Toast.LENGTH_LONG);
                t.show();
             }  
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:18:37.557

Method getCheckedItemPositions() returns SparseBooleanArray that indicates which items are checked (if item on specific position is checked, method valueAt(position) invoked on that array returns true). Class DBAdapter from tutorial you are following provides you with deleteTitle(long rowId) method which you should use to acheive what you want.Therefore your code should look more or less like this:

```
SparseBooleanArray checkedItems = listView.getCheckedItemPositions();
for (int i = 0; i < checkedItems.size(); i++) {
    if(checkedItems.valueAt(i)) {
        db.deleteTitle(adapter.getItemId(i));
     }
} 
```

Of course SimpleCursorAdapter and DBAdapter should be stored in object attributes so that you have access to them from both methods (onCreate and deleteRecord). By the way, View parameter passed to deleteRecord method is not needed.

# android - 如何将操作栏保持在顶部

> ID：14447965
> 
> 赞同：0
> 
> 时间：2013-01-21T21:57:00.853
> 
> 标签：android, android-actionbar

我的操作栏显示在底部，我如何控制它显示在顶部？我正在关注[本教程](http://wptrafficanalyzer.in/blog/adding-action-items-and-overflow-menu-items-to-action-bar-in-android/)。

一张说明我想做什么的图片。

![图片](../Images/e53a1c9751007ecc5e91019817065cdf.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:58:20.890

> 我的操作栏显示在底部，我如何控制它显示在顶部？

`android:uiOptions="splitActionBarWhenNarrow"`从您的清单中删除。

> 一张说明我想做什么的图片。

抱歉，操作栏无法做到这一点。

# ruby-on-rails - 如何将超过 2 个参数传递给部分？

> ID：14447968
> 
> 赞同：1
> 
> 时间：2013-01-21T21:57:13.807
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我想传递 2 个参数，例如`topic`和`icon_photo`。
我怎样才能做到这一点？

> 未定义的方法“icon_photo？”

我在下面的代码中遇到了这个错误。

**看法**

```
<div class="Topic">
  <% @community.topics.each do |topic| %>
    <%= render 'topics/topic', :topic => topic, :icon_photo => topic.user.profile.avatar %>
  <% end %>
</div> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-21T21:58:53.520

您可以传递本地哈希：

```
<div class="Topic">
  <% @community.topics.each do |topic| %>
    <%= render 'topics/topic', locals: {topic: topic, icon_photo: topic.user.profile.avatar, etc: 'blabla' } %>
  <% end %>
</div> 
```

在此处查看一些**文档**： [http ://www.tutorialspoint.com/ruby-on-rails/rails-render.htm](http://www.tutorialspoint.com/ruby-on-rails/rails-render.htm)

**可以做一点改进**，你可以像这样渲染你的收藏：

```
<div class="Topic">
  <%= render partial: 'topics/topic', collection: @community.topics %>
</div>

# in your partial topics/_topic.html.erb:
<% icon_photo = topic.user.profile.avatar %> 
```

# string - 以十六进制等形式写入以空字符结尾的字符串“R5”等

> ID：14447974
> 
> 赞同：1
> 
> 时间：2013-01-21T21:57:32.103
> 
> 标签：string

这应该是一门低级的课程，而且只是第三天的课。但是，我们被要求“以十六进制、二进制和八进制表示法编写以 null 结尾的字符串 'R5'。假设使用 ASCII 码”

我不知道去哪里学习如何做到这一点。有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:10:48.067

看起来这只需要您从 ASCII 表中查找适当的条目，该表在大多数情况下会列出十六进制和八进制以及字符本身。

ASCII 是定义字符表示方式的标准方式，大多数表格将根据相应的十六进制、十进制和八进制值列出字符。前 128 个是标准字符，接下来的 128 个是扩展字符（那些不映射到英文键盘的奇怪字符）。

如果你用谷歌搜索“ASCII 表”，你会被不同的链接所淹没。我在 www.asciitable.com 上看到的最上面的那个似乎有你需要的一切——除了二进制。

大多数情况下，您不会看到二进制列表，但是将十六进制值转换为二进制是相当学术的 - 您的 Windows 计算器会很乐意为您完成此操作。

为了更直接地翻译您的特定字符串，您将分别查找每个字符（包括 NULL）并单独翻译每个字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:06:49.463

以 NULL 结尾的 ASCII 字符串存储为每个字符一个字节，加上一个字节用于 NULL。因此，您将打印三个字节 - 'R'、'5' 和 0。

[在ASCII 图表](http://www.asciitable.com/)上查找“R”和“5”以查看 ASCII 中这些字符的数值。然后，用三种不同的方式写出你的三个字节——十六进制、二进制和八进制各一种。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T22:13:23.847

最终对电脑来说，一切都是数字。为了表示字母或符号等字符，我们可以就这些字符的*编码*或编号达成一致。例如，我们可以发明一种新的编码，其中 1 表示“A”，2 表示“B”，依此类推。ASCII 是一种常用的文本编码，它将字符映射到数字。在这种情况下，我们关心一个由 3 个字符组成的字符串[：](https://www.google.com/search?q=ASCII)`'R'` ,`'5'`和`null`(数值为、和。`82``53``0`

```
String: R, 5, <null>
Decimal numbers: 82, 53, 0 
```

我们的正常数字系统是以 10 为底，或十进制。这意味着每个数字代表的值是下一个数字的十倍（1、10、100、1000 等）。备用碱基包括 8（八进制）、16（十六进制）和 2（二进制）。有一种在基数之间进行转换的简单方法，尽管您也可以轻松找到可以为您进行转换的计算器。您可能需要查看教科书的相关部分，或查看 Wikipedia 文章。对于十进制 82 的示例，十六进制值为 52（这意味着 5*16 + 2 = 8*10 + 2）。通常您会看到前缀“0x”，这通常用于明确以下数字是以 16 为基数的。（否则，您可能会认为“52”指的是十进制值 52）。

* * *

> 有趣的。那么说以空字符结尾的字符串“R5”只是“52,35,30”是正确的，还是有更正确的格式？感谢您的耐心等待。——</p>

正如我在另一条评论中指出的那样，实际*值*0 标志着字符串的结尾，而不是值 0x30，它表示字符串中的字符“0”。请注意，`0`无论您的数字在哪个基数中，零 ( ) 的值都是相同的。

```
String: R, 5, <null>
Decimal : 82, 53, 0
Hexadecimal: 52, 35, 0 
```

# flash - 项目不会在闪存中构建，开发无法弄清楚为什么

> ID：14447975
> 
> 赞同：0
> 
> 时间：2013-01-21T21:57:42.337
> 
> 标签：flash, flash-builder, flashdevelop

我在尝试在 Flash 开发中构建项目时遇到这些错误我想知道是否有人可以帮助我

*   C:\flash\Projects\FM104\Audio Player\src\EqualizerAnimation.as(63): col: 4 错误：访问未定义属性 TweenLite。C:\flash\Projects\FM104\Audio Player\src\EqualizerAnimation.as(7): col: 11 错误：找不到定义 gs:TweenLite。C:\flash\Projects\FM104\Audio Player\src\EqualizerAnimation.as(94): col: 4 错误：访问未定义属性 TweenLite。C:\flash\Projects\FM104\Audio Player\src\EqualizerAnimation.as(93): col: 4 错误：访问未定义属性 TweenLite。C:\flash\Projects\FM104\Audio Player\src\EqualizerAnimation.as(92): col: 4 错误：访问未定义属性 TweenLite。C:\flash\Projects\FM104\Audio Player\src\EqualizerAnimation.as(91): col: 4 错误：访问未定义属性 TweenLite。C:\flash\Projects\FM104\Audio Player\src\EqualizerAnimation.as(91): col: 4 错误：访问未定义属性 TweenLite。C：\flash\Projects\FM104\Audio Player\src\EqualizerAnimation.as(89): col: 4 错误：访问未定义的属性 TweenLite。C:\flash\Projects\FM104\Audio Player\src\EqualizerAnimation.as(88): col: 4 错误：访问未定义属性 TweenLite。C:\flash\Projects\FM104\Audio Player\src\EqualizerAnimation.as(68): col: 4 错误：访问未定义属性 TweenLite。C:\flash\Projects\FM104\Audio Player\src\EqualizerAnimation.as(67): col: 4 错误：访问未定义属性 TweenLite。C:\flash\Projects\FM104\Audio Player\src\EqualizerAnimation.as(66): col: 4 错误：访问未定义的属性 TweenLite。C:\flash\Projects\FM104\Audio Player\src\EqualizerAnimation.as(65): col: 4 错误：访问未定义的属性 TweenLite。C:\flash\Projects\FM104\Audio Player\src\EqualizerAnimation.as(64): col: 4 错误：访问未定义的属性 TweenLite。C：\flash\Projects\FM104\Audio Player\src\EqualizerAnimation.as(63): col: 4 错误：访问未定义的属性 TweenLite。C:\flash\Projects\FM104\Audio Player\src\EqualizerAnimation.as(62): col: 4 错误：访问未定义属性 TweenLite。

现在是均衡器动画动作脚本文件，记住我的 Flash 技能为零，我们失去了 Flash 开发人员

```
package  
{
    import flash.display.MovieClip;
    import flash.events.*
    import flash.utils.Timer;

    import gs.TweenLite;
    import gs.easing.*;

    /**
     * Controls the equalizer animation
     * @author FM104 
     */
    public class EqualizerAnimation
    {

        private var eq:MovieClip;
        private var eqTimer:Timer;

        public function EqualizerAnimation():void
        {
            eq = Main.instance.player.Eq; 
        }

        /**
         * start timer
         * @param
         * @return void
         */
        public function start():void
        {
            eqTimer = new Timer(100, 0);
            eqTimer.addEventListener(TimerEvent.TIMER, startAnimation);
            eqTimer.start();
        }

        /**
         * stop
         * @param
         * @return void
         */
        public function stop():void
        {
            try {
                eqTimer.removeEventListener(TimerEvent.TIMER, startAnimation);
                eqTimer.stop();
                stopAnimation();
            } catch (err:Error) {}
        }

        /**
         * animate the eq bars
         * @param   evt
         * @return void
         */
        private function startAnimation(evt:TimerEvent):void
        {
            TweenLite.to( eq.Bar1, 0.1, { height:( Math.floor(Math.random() * (30 - 10 + 1)) + 10 ) } );
            TweenLite.to( eq.Bar2, 0.1, { height:( Math.floor(Math.random() * (30 - 10 + 1)) + 10 ) } );
            TweenLite.to( eq.Bar3, 0.1, { height:( Math.floor(Math.random() * (30 - 10 + 1)) + 10 ) } );
            TweenLite.to( eq.Bar4, 0.1, { height:( Math.floor(Math.random() * (30 - 10 + 1)) + 10 ) } );
            TweenLite.to( eq.Bar5, 0.1, { height:( Math.floor(Math.random() * (30 - 10 + 1)) + 10 ) } );
            TweenLite.to( eq.Bar6, 0.1, { height:( Math.floor(Math.random() * (30 - 10 + 1)) + 10 ) } );
            TweenLite.to( eq.Bar7, 0.1, { height:( Math.floor(Math.random() * (30 - 10 + 1)) + 10 ) } );
        }

        /**
         * stop animating
         * @param
         * @return void
         */
        private function stopAnimation():void
        {
            /*
            TweenLite.to( eq.Bar1, 0, { height:30 } );
            TweenLite.to( eq.Bar2, 0, { height:30 } );
            TweenLite.to( eq.Bar3, 0, { height:30 } );
            TweenLite.to( eq.Bar4, 0, { height:30 } );
            TweenLite.to( eq.Bar5, 0, { height:30 } );
            TweenLite.to( eq.Bar6, 0, { height:30 } );
            TweenLite.to( eq.Bar7, 0, { height:30 } );
            */
            TweenLite.to( eq.Bar1, 1, { height:1 } );
            TweenLite.to( eq.Bar2, 1, { height:1 } );
            TweenLite.to( eq.Bar3, 1, { height:1 } );
            TweenLite.to( eq.Bar4, 1, { height:1 } );
            TweenLite.to( eq.Bar5, 1, { height:1 } );
            TweenLite.to( eq.Bar6, 1, { height:1 } );
            TweenLite.to( eq.Bar7, 1, { height:1 } );
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T03:41:47.677

如评论所述，您需要添加 TweenLite 库。TweenLite 网站上有说明：http: [//www.greensock.com/get-started-tweening/#installing](http://www.greensock.com/get-started-tweening/#installing)

从您的代码来看，似乎使用了旧版本的 TweenLite，因此您必须更改所有以“gs”开头的导入语句，例如：

```
import gs.TweenLite;
import gs.easing.*; 
```

到 com.greensock：

```
import com.greensock.TweenLite;
import com.greensock.easing.*; 
```

# php - 从 Ajax 传递变量时 $_POST 不起作用

> ID：14447979
> 
> 赞同：0
> 
> 时间：2013-01-21T21:57:56.767
> 
> 标签：php, javascript, ajax

请原谅这个基本问题，我对这一切都很陌生，但我很想学习，并且一直试图让这个工作总共大约 7 个小时。没运气。我希望你能帮忙！

这是我的 Ajax 调用：

```
<script type="text/javascript">
  FB.Event.subscribe('edge.create',
    function(response) {
    $.post("http://www.mydomain.com/fbtest.php", { category: "<?php echo $vpostid; ?>" } );
    }
  );
</script> 
```

这是我的 fbtest.php 代码：

```
<?php
/** Set up WordPress environment */
require_once( './wp-load.php' );
require_once( './wp-admin/admin-ajax.php' );
require_once( './wp-includes/post.php' );

$vcatid = $_POST['category'];

$meta_val = get_post_meta($vcatid, 'fb_likes', true);

$fbmetval = intval($meta_val);
$fbmetval = $fbmetval + 1;

update_post_meta($vcatid, 'fb_likes', $fbmetval);

?> 
```

任何想法将不胜感激。我确定我只是缺少一些非常基本的东西。

在此先感谢，罗布

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:10:25.560

您可能想看看插件 Codex 中的 Ajax：http: [//codex.wordpress.org/AJAX_in_Plugins](http://codex.wordpress.org/AJAX_in_Plugins)

我发现在使用 Wordpress 时我无法让 AJAX 以正常方式工作，并且必须为其设置处理程序。上面的链接当然值得一看。我发现先按照示例进行操作，然后在了解发生的情况后编写我想要的内容很有用。

# javascript - Backbone.js：类型错误：对象# has no method 'parse' I'm learning backbone.js and have a problem following 问问题

> ID：14447980
> 
> 赞同：2
> 
> 时间：2013-01-21T21:57:58.207
> 
> 标签：javascript, backbone.js

I'm learning backbone.js and have a problem following [this tutorial](http://addyosmani.github.com/backbone-fundamentals/#exercise-1-todos---your-first-backbone.js-app). I have a Collection of `Era`s called `History`. When trying `app.History.create({ from: 0, until: 1, stash: {from: null, until: null}, _enabled: true})` I get the error in the title.

Here's my code:

**The Model**

```
var app = app || {};

app.Era = Backbone.Model.extend({

    defaults: {
        from: Number.NEGATIVE_INFINITY,
        until: Number.POSITIVE_INFINITY,
        stash: {
            from: null,
            until: null
        },
        _enabled: true
    },

    toggle: function(){
        if(this.get('_enabled')){
            this.disable();
        }else{
            this.enable();
        }

        this.save();
    },

    enable: function(){
        this.from = this.stash.from;
        this.until = this.stash.until;

        this.stash.from = null; // strictly speaking unnecssary
        this.stash.until = null;

        this._enabled = true;
    },

    disable: function(){
        this.stash.from = this.from;
        this.stash.until = this.until;

        this.from = null;
        this.until = null;

        this._enabled = false;
    },

    enabled: function(){
        return this._enabled;
    },

});

var History = Backbone.Collection.extend({

    model: app.Era,

    localStorage: new Backbone.LocalStorage('karass-history'),

    enabled: function(){
        return this.filter(function(era){
            return era.enabled();
        }); 
    },

    nextOrder: function(){
        if(!this.length){
            return 1;
        }

        return this.last().get('order') + 1;
    },

    comparator: function( era ) {
        return era.get('order');
    },

    comparatorFrom: function( era ){
        return era.get('from');
    },

    comparatorUntil: function(era){
        return era.get('until');
    },

    getFirstFrom: function(){
        // todo
    },

    getLastUntil: function(){
        // todo
    },

    getEraAt: function(time){
        // todo
    },

});

app.History = new History(); 
```

**The Views**

```
app.AppView = Backbone.View.extend({

    // bind to the karassApp div we set up in the html file
    el: "#karassApp", 

    // Our template for the line of statistics at the bottom of the app.
    statsTemplate: _.template( $('#stats-template').html() ),

    // delegated events for creating new items, and clearing completed ones
    events: {
        'keypress #new-era-start': 'focusOnEnd',
        'keypress #new-era-end': 'createEraOnEnter',
        'click #disable-history': 'toggleEnabledAllEras'
    },

    // At initialization we bind to the relevant events on the 'eras' 
    // collection, when items are added or changed. Kick things off by
    // loading any preexisting todos that might be saved in *localStorage*
    initialize: function(){
        //_.bindAll(this);

        this.era_start = this.$('#new-era-start');
        this.era_end = this.$('#new-era-end');
        this.disableHistory = this.$('#disable-history');
        this.$footer = this.$('#footer');
        this.$main = this.$('#main');

        window.app.History.on('add', this.addOneEra, this);
        window.app.History.on('reset', this.addAllEras, this);
        // window.app.History.on('add:true', this.addAllEras, this);
        window.app.History.on('change:_enabled', this.filterOneEra, this);
        window.app.History.on('filter', this.filterAllEras, this);

        window.app.History.on('all', this.renderHistory, this);

        app.History.fetch();
    },

    // Re-rendering the App just means refreshing the statistics -- the rest
    // of the app doesn't change.
    renderHistory: function(){
        var era_count = app.History.length();

        if(app.History.length){
            this.$main.show();
            this.$footer.show();

            this.$footer.html(this.statsTemplate({
                era_count: era_count,
            }));

            this.$('#filters li a')
                .removeClass('selected')
                .filter('[href=#/' + (app.EraFilter || '' ) + '"]')
                .addClass('selected');

        }else{
            this.$main.hide();
            this.$footer.hide();
        }

        this.disableHistory = !app.History.enabled();
    },

    // Add a single era item to the list by creating a view for it, and
    // appending its element to the `<ul>`.
    addOneEra: function(era){
        var view = new app.EraView({ model: era });
        $('#history').append(view.render().el);
    },

    addAllEras: function(){
        this.$('#history').html('');
        app.History.each(this.addOneEra, this);
    },

    filterOneEra: function(era){
        era.trigger('visible');
    },

    filterAllEras: function(){
        app.History.each(this.filterOne, this);
    },

    // Generate the attributes for the new Era Item
    newEraAttributes: function(){
        return {
            from: this.era_start.val().trim(), // validation logic should probably go here: make sure it's a date that can be saved
            until: this.era_end.val().trim(), // ditto
            stash: {
                from: null,
                until: null
            },
            order: app.History.nextOrder(),
            _enabled: true,
        }
    },

    focusOnEnd: function(e){
        if(e.which !== ENTER_KEY || !this.era_start.val().trim()){
            return;
        }

        this.era_end.focus();
    },

    createEraOnEnter: function(e){
        if(e.which !== ENTER_KEY || !this.era_start.val().trim()){
            return;
        }

        app.History.create(this.newEraAttributes());
        this.era_start.val('');
        this.era_end.val('');
    },

    toggleEnabledAllEras: function(){
        var enabled = !this.disableHistory.checked;

        app.History.each(function(era){
            era.toggle();
            era.save();
        });
    }
});

app.EraView = Backbone.View.extend({
    tagName: 'li',
    template: _.template( $('#era-template').html() ),

    // The DOM events specified to an item
    events: {
        'dblclick label': 'edit',
        'keypress .edit .start': 'focusOnEnd',
        'keypress .edit .end': 'updateOnEnter',
        'blur .edit': 'close',
    },

    // The EraView listens for changes to its model, re-rendering. Since there's
    // a one-to-one correspondence between an era and a EraView in this app, 
    // we set a direct reference on the model for convenience.
    initialize: function(){
        //_.bindAll(this);
        this.model.on('change', this.render, this);
    },

    // Re-renders the era item to the current state of the model and
    // updates the reference to the era's edit input within the view
    render: function(){
        this.$el.html( this.template(this.model.toJSON()));
        this.era_start = this.$('.era-start');
        this.era_end = this.$('.era-end');
        return this;
    },

    // Switch this view into editing mode, displaying the input field
    edit: function(){
        this.$el.addClass('editing');
        this.era_start.focus();
    },

    // Close the editing mode, saving changes to the era
    close: function(){
        var start = this.era_start.val().trim();
        var end = this.era_end.val().trim();

        if(start && end){
            this.model.save({from: start, until: end});
        }

        this.$el.removeClass('editing');
    },

    focusOnEnd: function(e){
        if(e.which !== ENTER_KEY || !this.era_start.val().trim()){
            return;
        }

        this.era_end.focus();
    },

    updateOnEnter: function(e){
        if(e.which !== ENTER_KEY || !this.era_end.val().trim()){
            return;
        }

        this.close();
    }
}); 
```

And last but not least:

**The HTML**

```
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Backbone.js • HistoryMVC</title>
</head>
<body>
    <section id="karassApp">
        <header id="header">
            <h1>Karass</h1>
            <input id="new-era-start" placeholder="Since when?" autofocus>
            <input id="new-era-end" placeholder="Until when?" >
        </header>
        <section id="main">
            <input id="disable-history" type="checkbox">
            <label for="disable-history">Disable History, work on Snapshot instead</label>
            <ul id="history"></ul>
        </section>
        <footer id="footer"></footer>
    </section>
    <div id="info">
        No info here, traveller!
    </div>

    <script type="text/template" id="era-template">
        <li>
            <input class="era-start" placeholder="Since when?" value="<%= from %>">
            <input class="era-end" placeholder="Until when?" value="<%= until %>">
            <label>Edit</label>
        </li>
    </script>

    <script type="text/template" id="stats-template">
        <% if (era_count) { %>
            <p>There are <%= era_count %> eras to display</p>
        <% }else{ %>
            <p>There are no eras to display, yet.</p>
        <% } %>
    </script>

    <script src="js/lib/jquery-1.9.0.min.js"></script>
    <script src="js/lib/underscore-min.js"></script>
    <script src="js/lib/backbone.js"></script>
    <script src="js/lib/backbone.localStorage-min.js"></script>
    <script src="js/models/era.js"></script>
    <script src="js/models/history.js"></script>
    <script src="js/views/app.js"></script>
    <script src="js/views/era.js"></script>
</html> 
```

**Debug**

I'm able to instantiate an `Era` using `era = new app.Era({ from: 0, until: 1, stash: {from: null, until: null}, _enabled: true});`, but calling `app.History.create(...)` with the same arguments throws the error.

**Question** What is the error here? I tried to do everything anologous to the tutorial, and have been over all parts of the code three times now to see if I would spot an error.

Thank you!

Oh yeah, and credit goes to [Nyxynyx](https://stackoverflow.com/users/741099/nyxynyx), whose question I shamelessly ripped off after not finding an answer to mine.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T22:09:03.623

这是 Backbone.localStorage 中的一个错误，它与 Backbone 0.9.10 不兼容。

Github 上有一个[pull request ，同时用](https://github.com/jeromegn/Backbone.localStorage/pull/63)[这个 version](https://github.com/phoey/Backbone.localStorage)替换 Backbone.LocalStorage 。

# actionscript-3 - 错误 #1006：descendre 不是 main/loop() 处的函数

> ID：14447990
> 
> 赞同：0
> 
> 时间：2013-01-21T21:58:25.673
> 
> 标签：actionscript-3

我试图让我的角色在 AS3 中使用键盘箭头移动。我得到了错误：

```
Error #1006: descendre is not a function at main/loop() 
```

这是我的代码：

在`main.as`：

```
 private function down(e:KeyboardEvent):void {
        if (e.keyCode==_LEFT) {
            gauche=true;
        }
        if (e.keyCode==_UP) {
            haut=true;
        }
        if (e.keyCode==_DOWN) {
            bas=true;
            trace("down")
        }
        if (e.keyCode==_RIGHT) {
            droit=true;
        }
    }//down
    private function up(e:KeyboardEvent):void {
        if (e.keyCode==_LEFT) {
            gauche=false;
        }
        if (e.keyCode==_UP) {
            haut=false;
        }
        if (e.keyCode==_DOWN) {
            bas=false;
        }
        if (e.keyCode==_RIGHT) {
            droit=false;
        }
    }//up
    private function loop(e:Event):void{;
        if (haut) {
            vache_mc.monter();
        }
        if (bas) {
            vache_mc.descendre();
        }
        if (droit) {
            vache_mc.coted();
        }
        if (gauche) {
            vache_mc.coteg();
        }
    }//loop 
```

在`vache.as`：

```
 private function monter():void {
        trace("monter");
    }//monter
    private function descendre():void {
        trace("descendre");
    }//descendre
    private function coted():void {
        trace("coted");
    }//coted
    private function coteg():void {
        trace("coteg");
    }//coteg 
```

我的角色实例名称是`vache_mc`并且它已经在舞台上。

感谢你们对我的帮助 ：）

（我是法国人，这就是为什么变量名很奇怪而且我的英语很差）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:08:52.937

您在 vache.as 中的移动方法需要使用，`public`而不是`private`从 main.as 中调用它们。我认为您还需要确保 vache.as 实际上设置为 vache_mc 的类。

# spring - 如何验证休眠延迟加载集合大小？

> ID：14447992
> 
> 赞同：0
> 
> 时间：2013-01-21T21:58:34.177
> 
> 标签：spring, hibernate

```
Class MyModel {

    public interface ServerGroup {}
    @NotNull
    private String name;

    @Size(min = 1, groups=ServerGroup.class)
    //@NotEmpty(groups=ServerGroup.class) // Tried this as well but not working!
    @OneToMany
    //@OneToMany(fetch=FetchType.EAGER) It works! Don't really want to do eager fetch
    private List<Person> persons = new ArrayList<Person>();

  //getters and setters here
  .....
}

Class Mytest {

@Test
public void testMyModel
MyModel myModel = new MyModel();
myModel.setName("This is testing");
persist(myModel); //persisting to database

//Now loading back again from database
MyModel myModel = MyModel.Service.findMyModelByName("This is testing");
Set<ConstraintViolation<MyModel>> violations = validator.validate(myModel,ServerGroup.class);
Assert.assertEquals(1, violations.size()); //It fails here saying no violation
} 
```

如您所见，从数据库中创建并加载 mymodel，其中人员为空，因此尝试针对 ServerGroup 'group' 运行验证但没有违规，如果我将其更改为急切加载，那么它可以工作吗？请有任何建议。

# .net - 是否可以将 VB 项目用作 n 服务总线解决方案中的端点？

> ID：14447994
> 
> 赞同：0
> 
> 时间：2013-01-21T21:58:42.713
> 
> 标签：.net, vb.net, nservicebus, endpoint

是否可以将 VB 项目用作 n 服务总线解决方案中的端点？当我添加一个端点 - “Nservice Bus Web EndPoint”时，它会自动将其创建为一个 C# 项目。我希望它是 Visual Basic 项目。这可能吗？另外，如果我已经在我的 Nservice 总线解决方案中创建了一个 Visual Basic 项目，我该如何将它添加为端点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:45:22.297

NServiceBus 端点可以是在 NServiceBus 主机之外运行的类库。主机只是一个可执行文件（.exe 文件），它将运行您的类库，您可以使用它轻松地从开发/测试环境中的控制台应用程序切换到生产环境中的 Windows 服务。所以从技术上讲，您可以在 NServiceBus 解决方案中使用的语言确实没有限制，但是由于默认模板只有 C#，您需要自己设置它。执行以下步骤以将 VB.NET 项目作为 NServiceBus 端点运行：

1.  创建一个新的（或使用现有的）VB.NET 类库。
2.  将 NServiceBus 库添加到引用中
3.  将 NServiceBus 主机（.exe 文件）添加到引用中
4.  编译解决方案并在项目设置中选择主机可执行文件作为调试程序集。这将确保在您调试解决方案时运行可执行文件。
5.  添加一个实现 IConfigureThisEndPoint 的类。
6.  使该类还实现对您的场景有意义的角色（例如 AsA_Server）。

现在通过运行/调试您的类库，控制台应用程序应该会弹出日志和其他所有内容。

# python - 在 shell 脚本中运行 Python 脚本 - 检查状态

> ID：14447997
> 
> 赞同：13
> 
> 时间：2013-01-21T21:58:50.213
> 
> 标签：python, bash, shell, scripting, exit-code

在我的 shell 脚本中，我运行以下命令：

```
python script.py 
```

我想知道，作为一个两部分的问题：

1.  如何根据 python 脚本中发生的情况对我的 python 脚本进行编程以将状态传递回运行它的 shell 脚本。例如，如果 python 脚本出现问题，则让它退出并返回代码 1，然后将其发送回 shell。

2.  如何让我的 shell 脚本读取 python 的退出代码并退出错误？例如，除了 0 之外的任何状态码都会退出。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-21T22:02:42.750

首先，您可以将所需的退出代码作为参数传递给`sys.exit`您的 python 脚本。

`bash`其次，可以在参数中找到最近退出进程的退出代码`$?`。但是，您可能不需要明确检查它：

```
if python script.py; then
    echo "Exit code of 0, success"
else
    echo "Exit code of $?, failure"
fi 
```

要显式检查退出代码，您需要为`if`语句提供条件表达式：

```
python script.py
if [[ $? = 0 ]]; then
    echo "success"
else
    echo "failure: $?"
fi 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-09-29T15:48:44.650

讨厌复活恐龙，但是虽然这个选定的答案按书面形式工作，但我想添加一个变体，可以检查多个退出代码。`$?`似乎只检索一次最后执行的程序的退出代码。因此，如果您需要针对多种情况检查退出代码，则有必要分配`$?`给一个变量，然后检查该变量，a la（使用@chepner 的示例）：

```
python script.py
exit_code=$?
if [[ $exit_code = 0 ]]; then
    echo "success"
elif [[ $exit_code = 1 ]]; then
    echo "a different form of success, maybe"
else
    echo "failure: $exit_code"
fi 
```

# ios - 当分配的值不不同时 KVO 触发

> ID：14447999
> 
> 赞同：8
> 
> 时间：2013-01-21T21:58:59.993
> 
> 标签：ios, cocoa, key-value-observing

如果我有如下属性

```
@property(assign, nonatomic) NSUInteger myValue; 
```

并为其分配一个属性

```
self.myValue = 2; 
```

KVO 将按预期触发。如果，稍后，我给它分配相同的值

```
self.myValue = 2; 
```

KVO 将再次触发。我假设如果分配的值没有不同，Objective-C 中的 KVO 不会触发。看来我是不正确的。

有没有办法强制这种默认行为，即禁用每次分配值时触发的 KVO 通知？我可以创建自己的访问器，但如果有很多我想更改的属性，这可能是很多工作......

感谢您的任何回复。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-21T22:12:54.153

KVO 在调用 setter（或其他 mutator）时触发。没有额外的检查。一般来说，KVO 是极其轻量级和性能敏感的。由于不必要的更改通常很少见，并且在大多数情况下对观察者无害，因此它们不包括检查旧值的额外开销。检查以前的值可能会很昂贵，例如，如果托管对象没有出现故障，那么做很多工作只是为了检查这种情况不是默认行为。

如果您需要检查值如何更改或未更改，您可以通过传递 options 以观察者身份进行`NSKeyValueObservingOptionNew|NSKeyValueObservingOptionOld`。然后，您将同时收到新值和旧值，您可以决定是否对这些信息进行任何处理。但是，我在实践中发现不应该经常需要它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-19T03:29:46.083

仅供参考，将此逻辑添加到设置器（使用手动更改通知），您将使用：

```
- (void)setValue:(int)value
{
    if (_value == value) return;
    [self willChangeValueForKey:@"value"];
    _value = value;
    [self didChangeValueForKey:@"value"];
}

+ (BOOL)automaticallyNotifiesObserversOfValue { return NO; } 
```