# StackOverflow 问答 13214000-13214999

# java - 大内存（数据大小）集合

> ID：13214006
> 
> 赞同：2
> 
> 时间：2012-11-03T22:12:47.847
> 
> 标签：java, data-structures, collections, bigdata

很多时候，我必须使用 java.util.collection 包中的对象，这些对象符合 Map 和 Set 接口。

当我将数百万个元组或实体插入这些对象（HashMap、TreeMap 等）时，它们的性能、插入和查找速度都慢得令人难以置信。

我设计了派生类，它们本质上是 java.util.collection 中的类的组合，可以更好地扩展性能。

我想知道是否有针对处理大量数据进行了优化的 java.util.collections 包的开源等效项。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T22:22:23.457

为了更好地执行收藏库，请尝试[trove](http://trove.starlight-systems.com/)。但是，一般来说，您希望通过流式处理或其他形式的延迟加载来解决这类问题，这样您就可以在不将整个数据集加载到内存的情况下进行聚合等操作。

您还可以使用 Redis 或 CouchDB 等键值存储来存储这些数据。

# algorithm - 在数组上构建堆算法。无需暴力破解即可生成结果

> ID：13214013
> 
> 赞同：1
> 
> 时间：2012-11-03T22:14:02.187
> 
> 标签：algorithm, language-agnostic, heap

CLRS 中给出的 Build-Heap 算法

```
BUILD-MAX-HEAP(A)
1  heap-size[A] ← length[A]
2  for i ← ⌊length[A]/2⌋ downto 1
3       do MAX-HEAPIFY(A, i) 
```

它只产生几种可能情况中的一种。是否有其他算法会产生与上述算法不同的情况。对于输入数组 A={4,1,3,2,16,9,10,14,8,7} Build-Heap 产生 A={16,14,10,8,7,9,3,2,4 ,1} 满足堆属性。可能这是从数组中构建堆的最有效算法，但是数组的其他几种排列也具有堆属性。当我生成数组的所有排列并对堆属性进行测试时，我得到了具有堆属性的数组的 3360 个排列。

```
Count1   16    9    14    4    8    10    3    2    1    7
Count2   16    9    14    4    8    10    3    1    2    7
Count3    16    9    14    4    8    10    2    1    3    7
Count4    16    9    14    4    8    10    2    3    1    7
Count5    16    9    14    4    8    10    7    2    1    3
Count6    16    9    14    4    8    10    7    2    3    1
Count7    16    9    14    4    8    10    7    1    3    2
Count8     16    9    14    4    8    10    7    1    2    3
Count9     16    9    14    4    8    10    7    3    1    2
Count10    16    9    14    4    8    10    7    3    2    1
 ...........................................................

Count3358    16    8    14    7    4    9    10    2    1    3
Count3359    16    8    14    7    4    9    10    3    2    1
Count3360    16    8    14    7    4    9    10    3    1    2 
```

那么是否有一种不同的构建堆算法会给出与上述算法不同的输出，或者给出 3360 种可能的结果中的一些？

一旦我们使用build-heap得到一个满足heap属性的数组。我们如何使用这个数组生成最大数量的其他case。我们可以交换堆的叶子节点来生成一些case。有没有在不检查堆属性测试的所有排列的情况下获得更多可能情况的其他方法？

给定数组中的值范围和所有值都是不同的。我们能说一下满足堆属性的可能情况的总数吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T03:46:39.337

任何堆构建算法都会对插入项目的顺序敏感。如果你给它相同的元素，即使是 Build-Heap 算法也会生成一个不同的堆，但顺序不同。

请记住，当您构建堆时，部分构建的部分必须在每次插入后保持堆属性。所以这将限制任何特定算法可以生成的不同排列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T05:24:15.627

给定一个堆，至少生成一些允许的排列是相当容易的。

一个节点不关心它的两个子节点的相对大小。因此，您可以交换任何节点的子节点，然后对两者中较小的一个进行筛选，以确保为该子树维护堆属性（即，如果它小于其子节点之一，则交换它使用该子节点，并继续沿该路径执行相同的操作，直到它到达比任何一个子节点都大的位置，或者它已移动到足够靠近数组的末尾以使其成为叶节点的位置。

# mysql - 执行多个 UPDATE 语句的正确方法是什么？

> ID：13214014
> 
> 赞同：1
> 
> 时间：2012-11-03T22:14:02.137
> 
> 标签：mysql, optimization

`UPDATE`我有一个服务器每 3-5 秒向一个单独的 MySQL 服务器发送多达 20 条语句来进行游戏。我的问题是，将它们连接在一起是否更快（`UPDATE;UPDATE;UPDATE`）。在事务中执行它们然后提交事务是否更快？单独做每一个会更快`UPDATE`吗？

任何见解将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T22:20:27.043

这有点取决于服务器的连接方式。如果服务器之间的连接是持久的，那么连接语句或多个单独语句之间可能不会有很大差异。

但是，如果执行涉及到建立连接，执行SQL语句，然后断开连接，一次执行多条语句会节省数据库服务器的大量资源。建立连接的过程往往是一项昂贵且耗时的过程，并且由于机器是独立的，因此会增加 DNS 解析的开销。

建立连接、开始事务、单独执行语句、提交事务并断开与数据库服务器的连接对我来说是最合乎逻辑的。在这种情况下，无论您将所有`UPDATE`语句作为单个连接还是多个单独语句发送都可能不会产生太大影响，尤其是如果这仅涉及这两个服务器之间的定期通信并且您不需要期望它会随着用户负载而扩展， 例如。

事务的使用假设您的 3-5 秒周期性突发`UPDATE`语句在逻辑上以某种方式相关。如果它们不是相互依赖的，那么您可以跳过事务以节省一些资源。

与任何有关性能的问题一样，最好的答案是，*如果您当前的系统满足您的性能和扩展需求，您现在不应该过多关注对其进行微优化。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T22:33:19.960

将这些更新包装到单个事务块中总是更快。这样做的代价是，如果该块内发生任何故障，那将是什么都没有发生——你将不得不再次重复你的工作。

另外，请记住 MySQL 中的事务仅在使用 InnoDB 引擎时才有效。

# build - Go build：“找不到包”（即使设置了 GOPATH）

> ID：13214029
> 
> 赞同：177
> 
> 时间：2012-11-03T22:15:59.440
> 
> 标签：build, go, package

即使我已经`GOPATH`正确设置，我仍然无法通过“go build”或“go run”来找到我自己的包。我究竟做错了什么？

```
$ echo $GOROOT
/usr/local/go

$ echo $GOPATH
/home/mitchell/go

$ cat ~/main.go
package main
import "foobar"
func main() { }

$ cat /home/mitchell/go/src/foobar.go
package foobar

$ go build main.go
main.go:3:8: import "foobar": cannot find package 
```

* * *

## 回答 #1

> 赞同：185
> 
> 时间：2012-11-04T22:26:58.177

它不起作用，因为您的`foobar.go`源文件不在名为`foobar`. `go build`并`go install`尝试匹配目录，而不是源文件。

1.  设置`$GOPATH`为有效目录，例如`export GOPATH="$HOME/go"`
2.  搬到`foobar.go`和`$GOPATH/src/foobar/foobar.go`建设应该工作得很好。

其他推荐步骤：

1.  添加`$GOPATH/bin`到您`$PATH`的：`PATH="$GOPATH/bin:$PATH"`
2.  移动`main.go`到 的子文件夹`$GOPATH/src`，例如`$GOPATH/src/test`
3.  `go install test`现在应该创建一个可执行文件`$GOPATH/bin`，可以通过`test`在终端中键入来调用它。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2020-07-15T01:20:45.700

尽管关于需要将目录与包名称匹配的公认答案仍然是正确的，但您确实需要迁移到使用 Go 模块而不是使用 GOPATH。遇到这个问题的新用户可能会对提到使用 GOPATH （就像我一样）感到困惑，这些现在已经过时了。因此，我将尝试解决此问题并提供与使用 Go 模块时防止此问题相关的指导。

如果您已经熟悉 Go 模块并且遇到了这个问题，请跳到下面我更具体的部分，这些部分涵盖了一些容易忽略或忘记的 Go 约定。

本指南讲授 Go 模块：[https ://golang.org/doc/code.html](https://golang.org/doc/code.html)

**使用 Go 模块的项目组织**

一旦你迁移到 Go 模块，如那篇文章中所述，按照描述组织项目代码：

> 存储库包含一个或多个模块。模块是一起发布的相关 Go 包的集合。Go 存储库通常只包含一个模块，位于存储库的根目录。一个名为 go.mod 的文件声明了模块路径：模块中所有包的导入路径前缀。该模块包含包含其 go.mod 文件的目录中的包以及该目录的子目录，直到包含另一个 go.mod 文件（如果有）的下一个子目录。
> 
> 每个模块的路径不仅作为其包的导入路径前缀，而且还指示 go 命令应该从哪里下载它。例如，为了下载模块 golang.org/x/tools，go 命令将参考[https://golang.org/x/tools](https://golang.org/x/tools)指示的存储库（在此处进行更多描述）。
> 
> 导入路径是用于导入包的字符串。包的导入路径是其模块路径与其在模块中的子目录相连。例如，模块 github.com/google/go-cmp 在目录 cmp/ 中包含一个包。该包的导入路径是 github.com/google/go-cmp/cmp。标准库中的包没有模块路径前缀。

你可以像这样初始化你的模块：

```
$ go mod init github.com/mitchell/foo-app 
```

您的代码无需位于 github.com 上即可构建。然而，最好的做法是构建您的模块，就好像它们最终会被发布一样。

**了解尝试获取包裹时会发生什么**

这里有一篇很棒的文章讨论了当您尝试获取包或模块时会发生什么：[https](https://medium.com/rungo/anatomy-of-modules-in-go-c8274d215c16) ://medium.com/rungo/anatomy-of-modules-in-go-c8274d215c16 它讨论了包的存储位置以及将如果您已经在使用 Go 模块，可以帮助您了解为什么会出现此错误。

**确保导入的函数已经导出**

请注意，如果您在从其他文件访问函数时遇到问题，则需要确保已导出函数。如我提供的第一个链接中所述，函数必须以大写字母开头才能导出并可用于导入其他包。

**目录名称**

另一个关键细节（如已接受的答案中所述）是目录名称是定义包名称的内容。（您的包名称需要与其目录名称匹配。）您可以在此处查看示例：[https](https://medium.com/rungo/everything-you-need-to-know-about-packages-in-go-b8bac62b74cc) ://medium.com/rungo/everything-you-need-to-know-about-packages-in-go-b8bac62b74cc 与也就是说，包含您的`main`方法的文件（即应用程序的入口点）在某种程度上不受此要求的约束。

例如，在使用这样的结构时，我的导入出现问题：

```
/my-app
├── go.mod
├── /src
   ├── main.go
   └── /utils
      └── utils.go 
```

我无法将代码导入`utils`到我的`main`包中。

但是，一旦我放入`main.go`它自己的子目录，如下所示，我的导入工作得很好：

```
/my-app
├── go.mod
├── /src
   ├── /app
   |  └── main.go
   └── /utils
      └── utils.go 
```

在该示例中，我的 go.mod 文件如下所示：

```
module git.mydomain.com/path/to/repo/my-app

go 1.14 
```

当我在添加对 的引用后保存 main.go 时`utils.MyFunction()`，我的 IDE 自动拉入对我的包的引用，如下所示：

```
import "git.mydomain.com/path/to/repo/my-app/src/my-app" 
```

（我正在使用带有 Golang 扩展的 VS Code。）

请注意，导入路径包含包的子目录。

**处理私人回购**

如果代码是私有仓库的一部分，您需要运行 git 命令来启用访问。否则，您可能会遇到其他错误本文提到如何为私有 Github、BitBucket 和 GitLab 存储库执行此操作：[https ://medium.com/cloud-native-the-gathering/go-modules-with-private-git- repositories-dfe795068db4](https://medium.com/cloud-native-the-gathering/go-modules-with-private-git-repositories-dfe795068db4) 此处也讨论了此问题：[“获取”私有存储库的正确方法是什么？](https://stackoverflow.com/questions/27500861/whats-the-proper-way-to-go-get-a-private-repository)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2020-08-23T10:24:16.910

我通过将我的 go env GO111MODULE 设置为 off 解决了这个问题

```
go env -w  GO111MODULE=off 
```

注意：设置 GO111MODULE=off 将关闭最新的 GO Modules 功能。

参考：[为什么到处都是 GO111MODULE，以及关于 Go Modules 的一切（随 Go 1.17 更新）](https://maelvls.dev/go111module-everywhere/)

> **GO111MODULE 与 Go 1.16**
> 
> 从 Go 1.16 开始，默认行为是 GO111MODULE=on，这意味着如果你想继续使用旧的 GOPATH 方式，你将不得不强制 Go 不使用 Go Modules 功能：
> 
> 导出 GO111MODULE=off

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-11-03T22:30:36.607

编辑：因为您的意思是 GOPATH，请参阅[fasmat](https://stackoverflow.com/users/1680661/fasmat)的[回答](https://stackoverflow.com/a/13223578/6309)（赞成）

正如“[如何让 go find 我的包？](https://stackoverflow.com/questions/10600776/how-do-i-make-go-find-my-package) ”中提到的，您需要将包`xxx`放在目录`xxx`中。

请参阅[Go 语言规范](http://golang.org/ref/spec#Package_clause)：

```
package math 
```

> 一组共享相同`PackageName`形式的文件执行一个包。
> 一个实现可能要求一个包的所有源文件位于同一个目录中。

[守则组织](http://golang.org/doc/code.html#GOPATH)提到：

> `widget`在构建导入包“ ”的程序时，该`go`命令`src/pkg/widget`会在 Go 根目录中查找，然后——如果在那里找不到包源——它会**`src/widget`**按顺序在每个工作区中搜索。

（“工作区”是您的路径条目`GOPATH`：该变量可以为您的 ' `src, bin, pkg`' 引用多个路径）

* * *

（原答案）

您还应该设置[`GOPATH`](http://golang.org/cmd/go/#GOPATH_environment_variable)为 ~/go，而不是`GOROOT`，如“[如何编写 Go 代码](http://golang.org/doc/code.html)”中所示。

> Go 路径用于解析导入语句。它由 go/build 包实现并记录在案。
> 
> `GOPATH`环境变量列出了查找 Go 代码的位置。
> 在 Unix 上，该值是一个冒号分隔的字符串。
> 在 Windows 上，该值是以分号分隔的字符串。
> 在计划 9 中，值是一个列表。

这不同于`GOROOT`：

> Go 二进制发行版假定它们将安装在`/usr/local/go`（或`c:\Go`在 Windows 下），但可以将它们安装在不同的位置。
> 如果这样做，则需要`GOROOT`在使用 Go 工具时将环境变量设置为该目录。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2020-09-11T01:49:24.103

在最近从 1.14 开始的 go 版本中，我们必须`go mod vendor`在构建或运行之前做，因为默认情况下 go 附加`-mod=vendor`到 go 命令。所以在做之后`go mod vendor`，如果我们尝试构建，我们将不会遇到这个问题。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-01-31T07:43:04.487

**TL;DR：**遵循 Go 约定！（吸取教训），检查旧的 go 版本并[删除](https://golang.org/doc/install#uninstall)它们。安装最新。

对我来说，解决方案是不同的。我在一个共享的 Linux 服务器上工作，在`GOPATH`多次验证了我的和其他环境变量之后，它仍然无法正常工作。我遇到了几个错误，包括“找不到包”和“无法识别的导入路径”。尝试按照[golang.org](https://golang.org/doc/install)上的说明使用[此](https://stackoverflow.com/a/20459819/2470092)解决方案重新安装后（包括[卸载](https://golang.org/doc/install#uninstall)部分）仍然遇到问题。

我花了一些时间才意识到还有一个旧版本没有被卸载（`go version`然后`which go`再次运行...... DAHH）这让我想到了[这个](https://stackoverflow.com/questions/42952979/go-version-command-shows-old-version-number-after-update-to-1-8)问题并最终解决了。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-05-22T20:00:32.403

在不编辑 GOPATH 或任何东西的情况下，就我而言，只需执行以下操作：

* * *

```
/app
├── main.go
├── /utils
    └── utils.go 
```

在需要的地方导入包。这可能不直观，因为它与**应用程序**路径无关。您还需要在包路径中添加**应用程序：**

`main.go`：

```
package main

import(
   "app/util"  
) 
```

在 app 目录中，运行：

`go mod init app`

`go get <package/xxx>`

`go build main.go` / `go run main.go`

你应该很高兴。

* * *

GOPATH =`/home/go`

应用路径 =`/home/projects/app`

创建一个适当的**go.mod**和**go.sum**（`go mod init app`删除旧之前）

之后解决所有依赖项，例如缺少`go get github.com/example/package`.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-11-20T12:19:42.473

如果您有一个有效的`$GOROOT`但`$GOPATH`正在它们之外进行开发，则如果尚未下载包（您的或其他人的），您可能会收到此错误。

如果是这种情况，请尝试`go get -d`（-d 标志阻止安装）以确保在运行、构建或安装之前下载包。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-05-14T18:56:21.580

对我来说，上述解决方案都没有奏效。但是我的 go 版本不是最新的。我已经下载了最新版本并在我的 mac os 中替换了旧版本，之后它运行良好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-01-09T22:57:55.853

简单来说，即使使用**GO111MODULE=on**也可以使用以下导入语法解决导入问题：

```
import <your_module_name>/<package_name> 
```

**your_module_name** -> 模块名称，可以在模块的 go.mod 文件中作为第一行找到。

示例：github.com/nikhilg-hub/todo/ToDoBackend

**package_name** -> 模块内包的路径。

例子：orm

所以导入语句看起来像：

```
import "github.com/nikhilg-hub/todo/ToDoBackend/orm" 
```

根据我的说法，我们需要指定模块名+包名，因为我们可能需要在两个或多个不同的模块中使用相同的包名。

**注意：**如果你从同一个模块导入一个包，你仍然需要像上面一样指定完整的导入路径。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-02-08T13:23:01.210

我在构建 docker 文件时遇到了类似的问题：

```
[1/3] STEP 9/9: RUN CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -a -o manager main.go
api/v1alpha1/XXX.go:5:2: cannot find package "." in:
        /workspace/client/YYY/YYY.go 
```

这仅在构建 Dockerfile 时出现，在本地构建工作正常。

问题原来是我的 Dockerfile 中缺少的语句：

```
COPY client/ client/ 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2021-05-06T19:59:16.743

跑步`go env -w GO111MODULE=auto`对我有用

* * *

## 回答 #13

> 赞同：-8
> 
> 时间：2012-11-04T08:53:57.373

您是否尝试过将**go**的绝对目录添加到您的“路径”？

```
export PATH=$PATH:/directory/to/go/ 
```

# sql-server - 将 sql server spatial 和 NHibernate 与 CreateSqlQuery 相结合

> ID：13214033
> 
> 赞同：1
> 
> 时间：2012-11-03T22:16:34.000
> 
> 标签：sql-server, nhibernate, spatial, geography

我没有在 sql server 2008 中映射地理表，我想在 c# 中使用 nhibernate 用多边形实例查询它。
在开始时，我试图直接使用 sql server spatial，但遇到了这个问题： [Using SQL Server 2008 Geography types with nHibernate's CreateSQLQuery](https://stackoverflow.com/questions/238050/using-sql-server-2008-geography-types-with-nhibernates-createsqlquery)

我的第二次尝试是这样的：

```
session.CreateSQLQuery("select [shape] from [table] where (:codeShape).STIntersects([shape]) = 1").SetParameter("codeShape", codeShape, NHibernateUtil.Custom(typeof(MsSql2008GeographyType))); 
```

但是，此尝试也会引发异常：

```
Could not execute query [select [shape] from [table] where (?).STIntersects([shape]) = 1")] Name:codeShape - Value:POLYGON((30 40, ...)) 
```

内部例外是：

```
The specified input does not represent a valid geography instance. 
```

尽管 codeShape.IsValid 返回 true。

当我直接在 sql server 中运行此查询时，我得到了预期的结果。

任何想法或解决方案？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T07:08:41.473

问题解决了。我不得不反转多边形的点。

# cookies - 10.8 中的 webview cookie 错误？

> ID：13214038
> 
> 赞同：1
> 
> 时间：2012-11-03T22:17:14.530
> 
> 标签：cookies, webview, webkit

我有一个使用 webkit 实现 Web 浏览器的应用程序。它在 10.7 中运行良好，但在 10.8 中，允许登录网站的 cookie 适用于登录的第一个网站，但此后不会，除非我重新启动应用程序。分配和使用第二个 webview 失败。这似乎是某种与缓存相关的问题，但我在 10.8 发行说明中找不到解决此问题的任何内容。我知道 Safari 可以在 10.8 上运行，所以这一定是可以解决的。有没有其他人经历过这个？有任何想法吗？谢谢！

# c# - 基类上的 Ninject 属性注入

> ID：13214047
> 
> 赞同：7
> 
> 时间：2012-11-03T22:18:17.990
> 
> 标签：c#, dependency-injection, ninject

我正在尝试使用`ninject`. 鉴于`ninject`下面模块中的两个绑定，我希望`ConcreteDependency`将`B`.
但是，似乎`WhenInjectedInto`不考虑注入的类型，只考虑目标的声明类型（在这种情况下为属性）。

有没有办法实现我预期的行为？

```
static void Main(string[] args)
{
    var kernel = new StandardKernel(new TestModule());
    var b = kernel.Get<B>();
    var c = kernel.Get<C>();
}

class TestModule : NinjectModule
{
    public override void Load()
    {
        Bind<IDependency>().To<EmptyDependency>();
        Bind<IDependency>().To<ConcreteDependency>().WhenInjectedInto<B>();
    }
}

abstract class A
{
    [Inject]
    public IDependency Dependency { get; set; }
}

class B : A {}

class C : A {}

interface IDependency {}

class EmptyDependency : IDependency { }

class ConcreteDependency : IDependency { } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-04T20:50:44.070

如果可能，您应该使用构造函数注入而不是属性注入。这是一种更好的技术，由 Mark Seeman 推荐，因为使对象构造所需的依赖项显式化，并且通过构造函数的对象签名更具表现力。代码应如下所示：

```
 abstract class A
    {
        public IDependency Dependency { get; private set; }

        public A (IDependency dependency)
        {
            Dependency = dependency;
        }

    }

    class B : A
    {
        public B (IDependency dependency)
            : base(dependency)
        {

        }
    }

    class C : A
    {
        public C (IDependency dependency)
            : base(dependency)
        {

        }
    }

    interface IDependency { }

    class EmptyDependency : IDependency { }

    class ConcreteDependency : IDependency { } 
```

配置将与您的示例相同。以下测试通过

```
 [Test]
    public void TestSpecificBindingToObjectB()
    {
        var kernel = new StandardKernel(new TestModule());
        var b = kernel.Get<B>();
        var c = kernel.Get<C>();

        Assert.AreNotEqual(b.Dependency.GetType(), c.Dependency.GetType());
        Assert.AreEqual(typeof(ConcreteDependency), b.Dependency.GetType());
    } 
```

如果您有一个具有默认实现的可选依赖项，并且您可以使用属性装饰您的类`Inject`，您可以从请求中提取父信息，如下所示：

```
class TestModule : NinjectModule
{
    public override void Load()
    {
        Bind<IDependency>().To<EmptyDependency>();
        Bind<IDependency>().To<ConcreteDependency>().When(req =>req.ParentContext.Request.Service == typeof(B));
    }
} 
```

然后上面给出的相同测试通过属性注入的类层次结构。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-07T01:37:20.860

为了检查具体类型，您可以`ParentContext.Plan.Type`在`IRequest`界面上使用。这应该会给你你期望的行为`WhenInjectedInto`。例如：

```
When(req => req.ParentContext.Plan.Type == typeof(B)) 
```

# git - 将远程分支与本地仓库合并

> ID：13214050
> 
> 赞同：1
> 
> 时间：2012-11-03T22:18:44.430
> 
> 标签：git, github

我已经搜索了这个问题的答案列表，我似乎无法弄清楚 git 在这方面是如何工作的。

我确定这是一个简单的问题，所以我提前为新手内容道歉！

我有一个已克隆的远程存储库：

git clone git://github.com/package1/package1.git

[我在https://github.com/package2/package2.git](https://github.com/package2/package2.git)有另一个远程 git 存储库，其中包含一些已添加到 package1 存储库的附加补丁和程序。

提取 package2 的内容，然后将所有内容与 package1 合并的最佳方法是什么？

在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T22:21:28.323

如果 package1 和 package2 最初是同一个存储库，则类似于

```
git remote add -f p2 https://github.com/package2/package2.git
git merge p2/thebranch 
```

如果没有，您只需从 package2 存储库中获取所需的差异并将其应用于 package1。

# javascript - 从数组中删除动态创建的行

> ID：13214051
> 
> 赞同：0
> 
> 时间：2012-11-03T22:18:44.343
> 
> 标签：javascript, jquery, html, ajax

我有两个文本框和一个添加按钮。当您单击添加时，它会在文本框下方生成一个表格，每行都有一个删除按钮。当您单击删除时，它会删除表格行，但不会从数组中删除内容（至少我不认为）。

我如何让它也删除内容？目前，当我单击添加然后删除一些时，它会通过插入第一个很好但然后通过不插入它或仅添加 1 列来搞乱我的数据库表....如果我不删除任何它工作得很好。

```
 var $tdRemoveRow = $('<td>').appendTo($tr);
    $('<a>').attr({
        'href': '#',
    'id': 'submit-button'
    }).text("Remove").click(function() {
        $tr.remove();
        return false;
    }).appendTo($tdRemoveRow); 
```

错误必须在上面的代码中的某个地方。有人看到问题吗？

```
 var locations = [];   
$("#add").click(function() {
    var address = $("#address").val();
    var city = $("#city").val();

    if (address =="" || city =="") {
    $("#locationDeals").text('*Please enter an address and city');
    return false;
} 
else {
codeAddress();
        var $tr = $('<tr>').css({
            'padding': '4px',
            'background-color': '#ddd'
        }).appendTo('#locationDeals');

        var location = [
            address,
            city                
        ];
        locations.push(location);

        for (i = 0; i < 2; i++) {
            var $td = $('<td>').appendTo($tr);
            $('<span>').text(location[i]).appendTo($td);
            $('<input type="hidden">').attr({
                'name': 'loc[' + ctr + '][' + i + ']',
                'value': location[i]
            }).appendTo($td);
        }

        var $tdRemoveRow = $('<td>').appendTo($tr);
        $('<a>').attr({
            'href': '#',
        'id': 'submit-button'
        }).text("Remove").click(function() {
            $tr.remove();
            return false;
        }).appendTo($tdRemoveRow);

        ctr++;

        $("#locationtext").text('');
        return false;
    } 
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T22:26:04.467

删除行时，使用`.splice`也将其从数组中删除：

```
.click(function() {
    $tr.remove();
    locations.splice(locations.indexOf(location), 1);
    return false;
}) 
```

`location`请注意，如果不在 inside ，这将无法正常运行`locations`，但是使用您的代码可以保证不会出现这种情况。

* * *

您还应该减少输入名称中的索引（就在删除之前`tr`）：

```
var index = $tr.index();
$("#tableDailyDeals input[type='hidden']").each(function() {
    this.name = this.name.replace(/\[(\d+)\]/, function(str, number) {
      return "[" + (+number > index ? number - 1 : number) + "]";
    });
}); 
```

# java - 当我在 GUI 上按下按钮时，如何存储按钮的值？

> ID：13214058
> 
> 赞同：3
> 
> 时间：2012-11-03T22:20:02.943
> 
> 标签：java, swing, jbutton

我正在编写一个预测文本程序，并为按钮分配了字符串值。假设我点击 4 然后 6 然后 6 然后 3。我如何获得 4663？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T22:21:35.300

您可以使用`JButton`s[`getText()`](http://docs.oracle.com/javase/7/docs/api/javax/swing/AbstractButton.html#getText%28%29)方法，该方法将在 上返回`String`文本的表示形式`JButton`，从那里可以将其转换为整数等或连接/操作：

```
JButton button1=new JButton("Hello,");
JButton button2=new JButton("world!");
...
String text=button1.getText()+" "+button2.getText();//getText of button 1 and 2

System.out.println(text);//Hello, world! 
```

至于你的确切问题：

> 假设我点击 4 然后 6 然后 6 然后 3。我如何获得 4663？

我建议声明一个全局`StringBuilder`来保存数据并在每个`JButton`方法中使用`append()`：

```
StringBuilder sb=new StringBuilder();

..
@Override
public void actionPerformed(ActionEvent ae) {//method executed on click
...
sb.append(((JButton)ae.getSource()).getText());//get the JButton text and append it
} 
```

只需`StringBuilder`调用`toString()`其实例即可打印

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T22:27:29.750

一种方法是使用 a`StringBuilder`作为类成员变量并在每次单击按钮时附加值：

```
myStringBuilder.append(myButton.getText());
... 
```

并在需要时获取全文：

```
String numberString = myStringBuilder.toString(); 
```

`StringBuilder`以先进先出的方式工作，因此将保持添加数字的顺序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-22T21:08:57.533

希望对您有所帮助...您可以在editText控件或textview中显示值，没关系，这里我在Eclipse中使用了EditText控件

```
EditText etView = (EditText)findViewById(R.Id.etView);

When you click button 4 -->> etView.Append("4");
When you click button 6 -->> etView.Append("6");
When you click button 3 -->> etView.Append("3");

463 
```

# ip - 位数不足的 IP 校验和

> ID：13214059
> 
> 赞同：0
> 
> 时间：2012-11-03T22:20:09.393
> 
> 标签：ip, checksum

我必须计算和验证 IP 数据包的校验和（我正在用 C 语言编写路由器）。表示 IP 标头的结构具有 16 位校验和，但结构中的总位数不能被 16 整除——它短 8 位。

我的问题是这个。我是否一次读取 struct 16 位并用零填充最后一组位以计算校验和？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T21:16:11.810

如果位数错误，则将零位填充到数据的*末尾*。

**但是**，IP 是在标头字段上计算的，因此*总是*有一个 16 位的倍数来计算校验和。TCP 有时在数据末尾需要一个额外的零字节。

[http://en.wikipedia.org/wiki/IPv4_header_checksum](http://en.wikipedia.org/wiki/IPv4_header_checksum)

# php - xpath replace [en-media] elements with [img]

> ID：13214060
> 
> 赞同：1
> 
> 时间：2012-11-03T22:20:18.343
> 
> 标签：php, dom, simplexml, evernote

I need to find and replace in an Evernote xml file. It contains multiple entries like this:

```
<en-media alt="Evernote Logo" hash="4914ced8925f9adcc1c58ab87813c81f" type="image/png"></en-media>
<en-media alt="Evernote Logo" hash="4914dsd8925f9adcc1c58ab87813c81f" type="image/png"></en-media> 
```

with

```
<img src="https://sandbox.evernote.com/shard/s1/res/143c8ad0-da92-4271-8410-651b88e8a2f1" height="something" width="something"/>
<img src="https://sandbox.evernote.com/shard/s1/res/143c8233-da92-4271-8410-651b88e8a2f1" height="something" width="something"/> 
```

I'm doing this because Evernote's SDK admittedly lacks an easy way to show *both* textual and mime data (images, pdf's, etc.) in a single (or several easy) commands.

Here is my attempt at a "find" but now I need the "replace":

```
$content=html_entity_decode($content); //content contains &nbsp; and &mdash; causing simplexml to complain
$content=str_replace('&',htmlentities('&'),$content); //encode & -- Lewis & Clark

$x = new SimpleXMLElement($content);
$x = xpath('//en-media'); //find
[?????] MYCODE_getLink(); //replace
$content=$x->asXML(); //output
$content=htmlentities($content); //put entities back 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:12:23.197

下面是我的解决方案，它只是附加，因为我无法弄清楚替换。对于最终的 HTML 演示文稿，我仍然需要删除某些 XML 标记。无论如何，它有效，所以我把它贴在这里以防它帮助你：

```
$f = new NoteFilter();
$f->notebookGuid="e0a42e90-0297-442f-8157-44a596e5b8b5"; //default
//$f->notebookGuid="b733f6ab-e3b7-443a-8f5a-2bbe77ea1c1e"; //MyStuff

$n = $noteStore->findNotes($authToken, $f, 0, 100); // Fetch up to 100 notes
$total=$n->totalNotes;
if (!empty($n->notes)) {
foreach ($n->notes as $note) {
    $fullNote = $noteStore->getNote($authToken, $note->guid, true, false, false, false);
    $content  = $fullNote->content;

    $dom = new DOMDocument;
    $dom->loadXml($content);

    //list all <en-media>
    $medias = $dom->getElementsByTagName('en-media');
    foreach ($medias as $media) {
        $hash = $media->getAttribute('hash');
        $hash = hashXmlToBin($hash); //xml to bin for ByHash method below
        $resource=$noteStore->getResourceByHash($authToken, $note->guid,$hash,0,0,0,0);

        //get url 
        $url=resourceUrl($authToken,$resource);

        //if image, show inline 
        $inline=array('image/png','image/jpeg','image/jpg','image/gif');
        if (in_array($resource->mime,$inline)) {
            $img=$dom->createElement('img');
            $img->setAttribute('src', $url);
            $img->setAttribute('width', $resource->width);
            $img->setAttribute('height', $resource->height);
        }else { //show link
            $rewrite=array('application/pdf'=>'PDF');
            $mime=str_replace('application/','',$resource->mime);
            $filename=$resource->attributes->fileName;
            $img=$dom->createElement('a',"Download {$filename} ({$mime})");
            $img->setAttribute('href', $url);
            $img->setAttribute('class', "download-attachement");
        }
        // append to DOM
        $media->appendChild($img);
    }//foreach medias
    $content=$dom->saveXML();
    $out[]=$content;
    }//foreach notes 
    foreach ($out as $val)
        print "<hr/>".$val; //each note
}//notes exist

/*
 * http://discussion.evernote.com/topic/4521-en-media-hash/
 */
function hashXmlToBin($hash) {

    $chunks = explode("\n", chunk_split($hash,2,"\n"));
    $calc_hash = "";
    foreach ($chunks as $chunk) {
        $newdata="";
        if (!empty($chunk)) {
            $len = strlen($chunk);
            for($i=0;$i<$len;$i+=2) {
                $newdata .= pack("C",hexdec(substr($chunk,$i,2)));
            }
            $bin_chunk = $newdata;
            $calc_hash .= $bin_chunk;
        }
    }
    return $calc_hash;
}

/*
 * return a resource url
 */
function resourceUrl($authToken, $resource, $resize = FALSE, $thumbnailSize = 150) {
    //build URL
    if (!$resize)
        $url=EVERNOTE_SERVER."/shard/".$_SESSION['shard']."/res/".$resource->guid; //originals
    else
        $url=EVERNOTE_SERVER."/shard/".$_SESSION['shard']."/thm/res/".$resource->guid."?size={$thumbnailSize}"; //thumbnail

    return $url;
} 
```

# android - getItem() 在 FragmentPagerAdapter 中多次调用

> ID：13214063
> 
> 赞同：1
> 
> 时间：2012-11-03T22:20:31.137
> 
> 标签：android, android-layout

我正在使用带有片段的 viewpager 开发应用程序。在我的应用程序中，我有一个显示在列表中的项目。之后，当我单击时，我调用了 SherlockFragmentActivity，它使用适配器调用 ViewPager。现在问题是 FragmentPagerAdapter 中的 getItem 在一个单一的位置给出多个位置time.Also 当我翻转 backword 然后也给出错误的位置。这是我的代码

ViewPager 代码：-

```
private void initialisePaging() {
            //Adapter Context;
    this.mPagerAdapter = new MyPagerAdapter(
            super.getSupportFragmentManager(), getApplicationContext(),
            title, link, description);

    ViewPager pager = (ViewPager) super.findViewById(R.id.viewpager);
    pager.setAdapter(this.mPagerAdapter);
           //Take position from ListView & set postion .
    pager.setCurrentItem(post_position);
} 
```

我的适配器类负责设置片段：-

问题：- 问题是 getItem 调用 3 次 & 假设我点击 4 个项目，它给了我 3、4、5 号码。

```
public MyPagerAdapter(FragmentManager fm, Context cont,
            ArrayList<String> title, ArrayList<String> link,
            ArrayList<String> description) {

             super(fm);
    this.context = cont;
    this.key_desc = description;
    this.key_link = link;
    this.key_title = title;
    viewPagerApplication = (RssItem) cont;

}

@Override
public Fragment getItem(int position) {
        return Fragment0.newInstance(position, this.context, key_title,
            key_link, key_desc);
}

@Override
public int getCount() {
     return key_title.size();
}
My Fragment Class:-

Problem:-Here if i show postion in textview its correct position but if i want take position in logcat for further parsing its giving me again 4,3,5 number which is also diffrent from getItem();

public static Fragment0 newInstance(int num,Context cont, ArrayList<String> key_title, ArrayList<String> key_link, ArrayList<String> key_desc) {
    context=cont;

    Fragment0 f = new Fragment0();
    Bundle args = new Bundle();
    args.putInt("num", num);
    f.setArguments(args);

    return f;
}

 public void onCreate(Bundle savedInstanceState) {

   super.onCreate(savedInstanceState);

 };

   public int getShownIndex() {
       return getArguments().getInt("num", 0);
   }
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
         View v = inflater.inflate(R.layout.newsdetailfragment_screen, container, false);
          tv = v.findViewById(R.id.headingtextview_id);
         ((TextView)tv).setText(String.valueOf(getShownIndex()));
          ((TextView)tv).setTextColor(Color.BLACK);
         ((TextView)tv).setTextSize(20);
           return v;
    }

@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);
} 
```

现在请让我知道我错在哪里以及我如何才能获得一个确切的位置以进行进一步的处理。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T23:24:20.590

在getItem()里面，position参数就是需要渲染的位置。它不是用户将看到的当前焦点项目的位置。当前显示视图的左右页面需要在内存中预渲染，以便这些屏幕的动画流畅。要获取当前位置的项目，请使用：

```
pager.getCurrentItem(); 
```

如果您需要页面的实际位置，您可以实现 onPageChangeListener

```
pager.setOnPageChangeListener(new ViewPager.OnPageChangeListener() {
        @Override
        public void onPageSelected(int position) {
} 
```

onPageSelected 中的位置将给出页面的准确当前位置。

# ruby - 如何在 MongoDB-Ruby 中按两个值排序？

> ID：13214067
> 
> 赞同：0
> 
> 时间：2012-11-03T22:21:17.617
> 
> 标签：ruby, mongodb, sorting

所以我有一个 Ruby 脚本，我在其中找到“成绩”集合中“学生”数据库（MongoDB）中所有类型为“家庭作业”的文档。事情是，按照以下说明进行操作：

**[http://api.mongodb.org/ruby/current/file.TUTORIAL.html](http://api.mongodb.org/ruby/current/file.TUTORIAL.html)**

我尝试按分数排序，然后按学生 ID（或反之亦然）：

```
homeworks.sort(:score, 1).sort(:student_id, 1).to_a 
```

并运行文件（“mongo.rb”），我得到按分数（升序）而不是按学生 ID 排序的作业输出......（它们被打乱了）如果我尝试切换值，我得到的数组按student_id（升序）但不是按分数...（在这种情况下，分数值被打乱）

如何使用 ruby​​ 在 mongo 中按两个参数升序排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T22:36:07.210

根据文档，尝试

```
homeworks.sort([[:score, 1], [:student_id, 1]]).to_a 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T15:34:39.533

这个怎么样：

```
c = db['grades']
x = c.find({}, {:sort=>[[:student_id, 1], [:score, 1]]}).to_a 
```

这在 irb 中对我有用。

# javascript - .load 和 .ready 的关系

> ID：13214070
> 
> 赞同：0
> 
> 时间：2012-11-03T22:21:31.770
> 
> 标签：javascript, jquery

我正在使用`.load`jQuery 中的函数将页面的一部分加载到另一个页面中

```
$("#loadingDockShotPg").load("include/shot_comments.php?id="+get['id']); 
```

在我正在加载到 id 为“loadingDockShotPg”的 div 的文件中，其中有一些元素，我希望在其中受到我的 jQuery 命令的影响。

被放入另一个页面的 HTML 使用`.load`

```
 <textarea id='newNoteTextarea' class='width100 hidden' placement='Write a comment...'></textarea> 
```

放置在上面的 HTML 所在的父文件中的 jQuery

```
 $(document).ready(function(){
        $("input[placement], textarea[placement]").each(function(){
        var orAttr = $(this).attr("placement");

        $(this).val(orAttr);

        $(this).focus(function(){
            if($(this).val() == orAttr)
            {
                $(this).val("");
            }
        });
        $(this).blur(function(){
            if($(this).val() == "")
            {
                $(this).val(orAttr);
            }
        });
        });
    }); 
```

问题是我的 textarea 不受应该将放置属性放在 textarea 值中的 jQuery 的影响。我必须做什么才能完成这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T22:25:08.440

您可能想查看使用`.live()`, （在技术上已被贬值）或`.on()`在使用时附加/绑定到选定元素上的事件`.load()`

[http://api.jquery.com/live/](http://api.jquery.com/live/)

[http://api.jquery.com/on/](http://api.jquery.com/on/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T22:30:16.763

你`.load()`是一个“现场功能”。您正在加载内容后向 DOM 添加内容。在您`.each()`的内容与`.load()`. 要解决此问题，您可以在完成时作为回调运行您的`.each()`函数。`.load()`

这就是我应该这样做的方式：

```
$(function(){
    var inputElements = $("input[placement], textarea[placement]");

    function setInputValue() {
        var self = $(this),
            orAttr = self.attr("placement");

        self
            .val(orAttr)
            .focus(function(){
                if(self.val() == orAttr)
                {
                self.val("");
                }
            })
            .blur(function(){
                if(self.val() == "")
                {
                self.val(orAttr);
                }
            });
    }

    inputElements.each(setInputValue);

    $("#loadingDockShotPg").load("include/shot_comments.php?id="+get['id'], function(){
        inputElements = $("input[placement], textarea[placement]");
        inputElements.each(setInputValue);
    });
}); 
```

# php - 排序给出奇怪的结果

> ID：13214077
> 
> 赞同：1
> 
> 时间：2012-11-03T22:22:22.610
> 
> 标签：php

我有一组要排序的电子邮件地址，但结果很奇怪。这就是我的意思：

```
sort($array);
print_r($array);
...[79] => 91******@******.com [80] => 9l***@**********.com 
[81] => ps*******@**********.com [82] => a.c******@*****.com 
[83] => a.d****@*****.com... 
```

什么会导致以 p 开头的电子邮件在数字之后和 A 之前混在一起？

我从数据库中删除了该电子邮件地址并将其替换为“测试”，然后“测试”出现在同一位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T22:38:37.747

To make sure you're comparing in English put this before your sort:

```
 setlocale (LC_COLLATE, 'en_US');
  sort($array); 
```

If this changes anything and the sort works, your system is set to compare strings not as US/English.

Other than that, I can only think of spaces being at the start of the string or some starting with upper case and others starting lower. To fix cased string sorting issues, you could do:

```
 natsort($array); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T22:58:35.020

maybe you are sorting with some weird rule. Force the sorting mode to "string" passing SORT_STRING

```
sort($array, SORT_STRING); 
```

and tell us what it spit out.

sort() uses SORT_REGULAR as default, I suspect that the emails with numeric prefixes (92*) are considered integers thus the weird sorting.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T22:48:13.667

You have a space before `ps` ... when I inspected the code you posted it is visible. Make a `trim` before sorting.

# java - System.out.println 纠正了网络异常，但我不想使用它

> ID：13214078
> 
> 赞同：2
> 
> 时间：2012-11-03T22:22:22.890
> 
> 标签：java, exception, network-programming

这是我的第一个问题。我搜索了几个小时来帮助自己，但互联网上没有解决方案。我的程序只会在我插入“System.out.println()”时运行，我想使用 tcp 传输一个大文件（mp3，5Mb）。我有很多使用 java 的经验，但这是一个非常有趣的失败。

服务器和客户端位于 128.0.0.1

这是我的客户代码

```
public void receive(int port) {
        try {
            ServerSocket s = new ServerSocket(port);
            Socket socket = s.accept();
            BufferedInputStream in = new BufferedInputStream(
                    socket.getInputStream());
            FileOutputStream fileOut = new FileOutputStream("dateiname.mp3");

            startzeit = Calendar.getInstance().getTimeInMillis();

            byte[] b = new byte[32];
            while (in.available() > 0) {
                System.out.println(Calendar.getInstance().getTimeInMillis()
                        - startzeit);
                in.read(b);
                fileOut.write(b);
                fileOut.flush();
                received += 1;
            }
            System.out.println("Feritg");
            fileOut.close();
        } catch (SocketException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    } 
```

和服务器

```
import java.io.BufferedOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.net.InetAddress;
import java.net.Socket;

public class FileTransfer {
    @SuppressWarnings("resource")
    public static void send(File datei, InetAddress ip, int port)
            throws IOException 
        {
        Socket socket = new Socket(ip, port);
        BufferedOutputStream out = new BufferedOutputStream(socket.getOutputStream());
        FileInputStream fileIn = new FileInputStream(datei);
        while (fileIn.available() > 0) {
            byte[] b = new byte[32];
            fileIn.read(b);
            out.write(b);
            out.flush();
        }
        out.close();
        socket.close();
    }
} 
```

至少是服务器抛出的异常

```
Exception in thread "main" java.net.SocketException: Connection reset by peer: socket write error
 at java.net.SocketOutputStream.socketWrite0(Native Method)
 at java.net.SocketOutputStream.socketWrite(Unknown Source)
 at java.net.SocketOutputStream.write(Unknown Source)
 at java.io.BufferedOutputStream.flushBuffer(Unknown Source)
 at java.io.BufferedOutputStream.flush(Unknown Source)
 at FileTransfer.send(FileTransfer.java:20)
 at MainServer.main(MainServer.java:12) 
```

请帮我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T22:45:05.760

该异常意味着客户端意外关闭了套接字。

您可能不想`available()`在 while 循环中使用您的检查。该函数仅指示可以在不阻塞的情况下读取的字节数，而不是文件中的总字节数。你想要的是在服务器中是这样的：

```
while (fileIn.read(b) != -1) { ... 
```

客户端应该使用类似的代码。

另请注意，您的代码无法处理您读取的字节数少于 32 的情况。你真的应该这样做：

```
while ((n = fileIn.read(b))!= -1) {
  out.write(b, n);
  ... 
```

最后，32 字节是一个非常小的大小，您可以使用 4KB、8KB 甚至更大的缓冲区获得更快的传输。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T22:51:19.707

不要重新发明轮子。`IOUtils.copy(InputStream input, OutputStream output)`从 Apache Commons IO 库中使用。

# jquery - 部分高度滑块

> ID：13214079
> 
> 赞同：0
> 
> 时间：2012-11-03T22:23:00.330
> 
> 标签：jquery, slide

我正在为我的作品集制作一个滑块，该滑块将显示部分作品，然后在展开时显示其余部分。你可以在这里看到它的预览：http: [//staging.pautlerdesign.com/portfolio/index.php](http://staging.pautlerdesign.com/portfolio/index.php)。我正在使用以下代码来获得预期的效果：

```
 if ($(window).width()>768) {
    var sliderHeight = "180px";
    $('.slider').each(function () {
      var current = $(this);
      var height = $(current).height();
      current.attr("box_h", height);
    });

    $('.slider').css("height", sliderHeight);
    $(".slider_menu").html('<a href="javascript:void(0);" class="expand"><i class="ss-plus"></i></a>');
    $(".slider_menu a").click(function() {
      openSlider($(this).parent().prev("ul.slider"), $(this).parent());
      return false;
    });
  }

  function openSlider(obj, slideMenu) {
      var open_height = $(obj).attr("box_h") + "px";
      $(obj).animate({
          "height": open_height
      }, {
          duration: "slow"
      });
      $(slideMenu).html('<a href="javascript:void(0);" class="expand"><i class="ss-hyphen"></i></a>');
      $(slideMenu).children("a").click(function() {
          closeSlider(obj, slideMenu);
      });
      return false;
  }

  function closeSlider(obj, slideMenu) {
      $(obj).animate({
          "height": sliderHeight
      }, {
          duration: "slow"
      });
      $(slideMenu).html('<a href="javascript:void(0);" class="expand"><i class="ss-plus"></i></a>');
      $(slideMenu).children("a").click(function() {
          openSlider(obj, slideMenu);
      });
      return false;
  } 
```

由于某种原因，顶部的部分在将“box_h”分配给 ul 时无法完全正常工作。它适用于前几项，但当你到达底部时，它会应用 22、44 或 66 的高度。我不知道为什么它会适用于某些部分，但不适用于其他。有任何想法吗？我认为这是一件很小的事情，但我一生都无法弄清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T01:31:27.860

看起来您需要将代码包装在：

```
$(window).load( function() {
  //...
}) 
```

代替：

```
$( function() {
  //...
}); 
```

因为这会延迟代码执行，直到页面上的 DOM*和图像*加载完毕。当前，您列出的 Javascript 块在保证仅加载 DOM 时正在运行，页面后面的项目将具有不准确的高度，因为图像可能尚未加载并展开框。

# c# - 声明一个通用集合

> ID：13214081
> 
> 赞同：0
> 
> 时间：2012-11-03T22:23:11.750
> 
> 标签：c#, generics

我有 3 个类（`A`, `B`, `C`），并且必须为所有类实现一个存储方法，所以我想使用一个通用列表，`List<T> = new List<T>();`但它不允许我使用它。

我希望方法是这样的：

```
class Bascket
{
   List<T> list= new List<T>();

   public void addToBasket(T value)
   {
      list.Add(value);
   }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T22:34:26.940

假设 A、B 和 C 是您希望存储在 Basket 对象中的项目，您应该创建这些项目的基类，并将泛型集合声明为基类的集合，即

```
public interface IBasketItem
{ 
    /* put some common properties and methods here */
    public decimal Price { get; set; }
    public string Name { get; set; }
}
public class A : IBasketItem
{ /* A fields */ }
public class B : IBasketItem
{ /* B fields */ }
public class C : IBasketItem
{ /* C fields */ }

public class Basket
{
    private List<IBasketItem> _items = new List<IBasketItem>();

    public void Add(IBasketItem item)
    {
        _items.Add(item);
    }

    public IBasketItem Get(string name)
    {
        // find and return an item
    }
} 
```

然后，您可以使用 Basket 类来存储您的所有物品。

```
Basket basket = new Basket();
A item1 = new A();
B item2 = new B();
C item3 = new C();
basket.Add(item1);
basket.Add(item2);
basket.Add(item3); 
```

但是，在取回项目时，您应该使用通用接口，或者您应该知道对象实际上是哪种类型。例如：

```
IBasketItem myItem = basket.Get("cheese");
Console.WriteLine(myItem.Name);
// Take care, if you can't be 100% sure of which type returned item will be
// don't cast. If you cast to a wrong type, your application will crash.
A myOtherItem = (A)basket.Get("milk");
Console.WriteLine(myOtherItem.ExpiryDate); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T22:24:57.707

问题是`T`没有声明。您可以为您的类添加一个通用参数以使其工作：

```
class Basket<T>
{
   List<T> list= new List<T>();

   public void addToBasket(T value)
   {
      list.Add(value);
   }
} 
```

这允许您像这样使用您的类：

```
var basket = new Basket<string>();
basket.addToBasket("foo"); // OK
basket.addToBasket(1); // Fail, int !== string 
```

# soundcloud - 在 webView 中使用 SoundCloud HTML5 小部件将其外观更改为“网络应用”

> ID：13214084
> 
> 赞同：1
> 
> 时间：2012-11-03T22:23:49.293
> 
> 标签：soundcloud

很烦人的是，SoundCloud 有这么好的 HTML5 播放器，它在 Mobile Safari 中完美运行，但是当你尝试在应用程序的 webView 中使用相同的 iframe 时，它​​会完全无视所有尺寸，将自己转变为这种“类似应用程序的播放器界面”和设置为小部件。它试图伪装成一个 webapp（ish），这不是我在 HTML5 小部件中要求的。

在移动 Safari 中查看：http: [//imgur.com/5TowM](http://imgur.com/5TowM)

并在 iPhone 应用程序中的 WebView 中：http: [//imgur.com/hxJlK](http://imgur.com/hxJlK)

是否可以将查询字符串添加到 iframe src uri 以覆盖此“过度响应”设计？谢谢。

# solr - Solr 的 Amazon EC2 实例类型

> ID：13214085
> 
> 赞同：4
> 
> 时间：2012-11-03T22:23:56.253
> 
> 标签：solr, amazon-ec2

对于具有大约 14M 小文档、长尾查询、2 个分片、每台服务器一个分片的 Solr 集合，最佳 Amazon 实例大小是多少？

索引大小当前为 360 GB。

不确定什么更重要：大量 RAM 和 CPU，或快速磁盘（EBS IOPS 等）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T02:23:04.077

通常，当整个索引可以加载到服务器上的 RAM 中时，Solr 中的最佳性能就会实现。因此，一旦您确定了索引的物理大小，如果您可以放置​​该数量的 RAM，再加上操作系统所需的任何内容，应该可以为您提供最佳的索引性能。如果您不能在一台服务器上全部安装它，那么您可能会考虑将索引拆分到多个分片中。更新索引时，快速磁盘将有助于提高性能。

# fancybox - 从 FancyBox 库中的 Fancybox 计数器中删除“图像”字样

> ID：13214089
> 
> 赞同：1
> 
> 时间：2012-11-03T22:24:53.533
> 
> 标签：fancybox, wordpress

我在 Wordpress 主题中使用 FancyBox 库。

我想删除：

图片 1 / 1

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T03:47:20.370

你可以在这里使用 CSS

```
#fancybox-title-over{
   display:none;   
} 
```

使用[firebug](http://getfirebug.com/)仔细检查元素是否具有**fancybox-title-over的 id**

# php - .htaccess 使用查询字符串重定向到人类可读的 url

> ID：13214093
> 
> 赞同：0
> 
> 时间：2012-11-03T22:25:13.590
> 
> 标签：php, .htaccess, url-rewriting

我有一个网址：*`www.abc.com/change.php`*。

参数值通过 post 传递`$_POST[param]`。

我想通过这样的方式将它转换为像 url`.htaccess`这样的 MVC：

*`www.abc.com/change.php`*`$_POST["height"]`重定向到*`www.abc.com/change/height`*

和：

*`www.abc.com/change.php`*`$_POST["width"]`重定向到*`www.abc.com/change/width`*.

我的`.htaccess`文件应该如何更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T22:29:33.977

我很确定您不能根据 post 变量的名称重定向或重写。

实际上那是.htaccess。如果您使用 php 重定向，您绝对可以这样做，但这不是您所要求的。

我想你也应该能够重定向/重写获取变量名。

# java - 递归算法中的无限循环

> ID：13214094
> 
> 赞同：1
> 
> 时间：2012-11-03T22:25:17.063
> 
> 标签：java, algorithm, sorting, recursion, pivot

我需要制作一个枢轴排序算法，基本上你取链表的第一项，将其排序到两个单独的列表中它们递归地直到你到达一个已经排序的大小为 1 的链表，然后将小于和大于列表合并在一起形成一个排序列表。

我的算法一直卡在无限循环中的最后一个项目上，我现在已经有大约 23 个小时没有睡觉了，需要一双新的眼睛来发现我在哪里犯了错误。如果你能帮忙，我将非常感激。

链表类很简单，有两项，第一项只是一个正整数，第二项当然是列表中的下一项。当代码碰到最后一项时，代码在 Sort() 函数中被捕获，然后没有将最后一项附加在一起

```
public class PivotSort {
   public static void main(String[] args) {
      try {
         intList x = intList.CreateFromUserInput(); // just makes a linked list
                                                    // from numbers I type in
         x = Sort(x);
         x.PrintList();
      } catch (Exception e) {
         System.out.println(e);
      }
   }

   public static intList Sort(intList list) {
      if (list == null || list.item == null)
         return list;
      return Append(Sort(Part_Less(list.item, list)),
            Sort(Part_Greater(list.item, list)));
   }

   public static intList Part_Less(int N, intList L1) {
      if (L1 == null)
         return null;
      if (L1.item < N)
         return new intList(L1.item, Part_Less(N, L1.next));
      else
         return Part_Less(N, L1.next);
   }

   public static intList Part_Greater(int N, intList L1) {
      if (L1 == null)
         return null;
      if (L1.item >= N)
         return new intList(L1.item, Part_Greater(N, L1.next));
      else
         return Part_Greater(N, L1.next);
   }

   public static intList Append(intList L1, intList L2) {
      try {
         if (L1 == null)
            return L2;
         if (L2 == null)
            return L1;
         for (intList curr = L1; curr != null; curr = curr.next) {
            if (curr.next == null) {
               curr.next = L2;
               break;
            }
         }
         return L1;
      } catch (Exception e) {
         System.out.println(e);
         return null;
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T22:39:04.707

问题是，`Sort`第二次调用永远无法达到您的基本情况：

```
Sort(Part_Greater(list.item, list)) 
```

该`Part_Greater()`函数将首先构造一个列表，其中包含所有大于或等于第一项的项。假设这是您的原始列表：

```
10 5 7 11 15 7 16 20 
```

`Part_Greater()`将构造一个列表，其中包含`10 11 15 16 20`. 当您将其传递给 时`Sort`，它会再次调用`Part_Greater()`该列表，从而产生该列表。

由于在第一次调用 后没有删除任何元素`Part_Greater()`，因此您进入了无限递归。

您需要做的是从列表中删除枢轴元素。这确保了在每一个递归步骤中，您的数字列表至少会缩短一个，最终在列表为空时达到基本情况。

```
return Append(
    Sort(Part_less(list.item, list.next)),
    new intList(list.item, Sort(Part_Greater(list.item, list.next)))
); 
```

# html - Golang GAE - HTML 模板未将链接正确插入网页

> ID：13214095
> 
> 赞同：4
> 
> 时间：2012-11-03T22:25:44.157
> 
> 标签：html, google-app-engine, parsing, templates, go

我在 Google App Engine 上使用 Google Go。我`string`将结构中的描述保存到 a`datastore`中，如下所示：

```
type Foo struct{
    Bar string
} 
```

该描述包括 html 标签，例如：

```
<a href="/">Bar</a> 
```

我希望将该`html template`描述包含在 html 文件中，以便将其解析为 html。例如：

```
<html><head><title>Title</title></head>
<body>{{.Bar}}</body></html> 
```

被解析为：

```
<html><head><title>Title</title></head>
<body><a href="/">Bar</a></body></html> 
```

但相反，我得到了这样的东西：

```
<html><head><title>Title</title></head>
<body>&lt;a href=&#34;/&#34;&gt;Bar&#39;s&lt;/a&gt;</body></html> 
```

如何将`template`解析`string`正确地转换为 html 链接？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T22:32:03.590

该`"http/template"`包自动转义所有字符串。要解决这个问题，您必须设置 type 的值`template.HTML`。例如

```
import "html/template"

type Foo struct {
    Bar template.HTML
} 
```

然后在您的代码中执行以下操作：

```
Foo.Bar = template.HTML(barString) 
```

# php - 使用 Twig 渲染 CSS 文件

> ID：13214103
> 
> 赞同：2
> 
> 时间：2012-11-03T22:26:56.863
> 
> 标签：php, html, css, twig, template-engine

我使用 Twig 作为模板引擎。我想通过 Twig 渲染我的 CSS 文件，并利用宏的优势。我收到的回复看起来不错。但不知何故，如果我包含它，HTML 页面不会将其识别为 css 文件。当我包含真正的 css 文件时，该站点工作得很好。收到的源码对比一下，一模一样……

虽然，Chrome 以不同的方式显示文件。它在一行上显示渲染文件。它可能被解释为 HTML 文件。

真正的 css 文件像源代码一样显示在多行上。

您包含扩展名为 .css 的两个文件。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T23:04:44.163

也许你应该看看[LESS](http://www.lesscss.de/)它更高效，而不是解析你的 CSS 文件。使用 LESS，您有很多可能性来制作块和重用带有变量的函数。

也许它可以解决您的问题。

**编辑：**
[模板后缀](http://symfony.com/doc/current/book/templating.html#template-suffix)
[在带有 Symfony2 的 Twig 中使用 {% stylesheets %} 标记时通过 Twig 运行 CSS 文件](https://stackoverflow.com/questions/11033172/run-css-file-through-twig-when-using-stylesheets-tag-in-twig-with-symfony2)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T09:25:39.683

你说你得到了正确的内容，但它没有被解释为 css。这可能是因为不正确的 contenty-type 标头。

Css 文件应发送为`text/css`，在 Sf 中默认为`text/html`. 在呈现您的 CSS 的操作中，请确保设置正确的标题。

# javascript - Change HTML text input cursor symbol to "block"

> ID：13214104
> 
> 赞同：10
> 
> 时间：2012-11-03T22:27:01.560
> 
> 标签：javascript, html, css, input, text-cursor

> **Possible Duplicate:**
> [How to use this square cursor in a HTML input field?](https://stackoverflow.com/questions/3758023/how-to-use-this-square-cursor-in-a-html-input-field)

Is there a way to change the cursor style of an HTML text `<input>`'s cursor to the "block" kind like a command prompt?

![Block cursor](../Images/8a78f9700ed632c71188d256626f09df.png)

If not, is there a way to hide the default text cursor then append a block character at the end of the text that cannot be deleted?

Thanks.

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2012-11-03T22:34:02.073

要隐藏光标，您可以使用： cursor: none;

# java - 表单对象的 id 设置为 0

> ID：13214105
> 
> 赞同：1
> 
> 时间：2012-11-03T22:27:09.767
> 
> 标签：java, forms, spring

我不知道为什么这个控制器方法不起作用，但也许有人以前见过这样的东西。我的 Web 表单使用伪装的 PUT 方法提供所有 Property 对象的变量（其中一个是 id）。它是这样注释的：

```
package uk.co.nicshouse.jester.domain;

import java.io.Serializable;
import javax.persistence.Embedded;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;

@Entity
public class Property implements Serializable
{
    @Id
    @GeneratedValue
    private long id;
    private String name;
    private String description;

    @Embedded
    private Address address;

    @Override
    public boolean equals(Object obj)
    {
        if (obj == null) {
            return false;
        }
        if (getClass() != obj.getClass()) {
            return false;
        }
        final Property other = (Property) obj;
        if (this.id != other.id) {
            return false;
        }
        if ((this.name == null) ? (other.name != null) : !this.name.equals(other.name)) {
            return false;
        }
        if ((this.description == null) ? (other.description != null) : !this.description.equals(other.description)) {
            return false;
        }
        if (this.address != other.address && (this.address == null || !this.address.equals(other.address))) {
            return false;
        }
        return true;
    }

    @Override
    public int hashCode()
    {
        int hash = 3;
        hash = 29 * hash + (int)this.id;
        hash = 29 * hash + (this.name != null ? this.name.hashCode() : 0);
        hash = 29 * hash + (this.description != null ? this.description.hashCode() : 0);
        hash = 29 * hash + (this.address != null ? this.address.hashCode() : 0);
        return hash;
    }

    @Override
    public String toString()
    {
        return "Property{" + "id=" + id + ", name=" + name + ", description=" + description + ", address=" + address + '}';
    }

    public long getId()
    {
        return id;
    }

    public void setId(long id)
    {
        this.id = id;
    }

    public String getName()
    {
        return name;
    }

    public void setName(String name)
    {
        this.name = name;
    }

    public String getDescription()
    {
        return description;
    }

    public void setDescription(String description)
    {
        this.description = description;
    }

    public Address getAddress()
    {
        return address;
    }

    public void setAddress(Address address)
    {
        this.address = address;
    }

} 
```

控制器如下所示：

```
package uk.co.nicshouse.jester.mvc;

import java.util.List;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.validation.Valid;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.portlet.ModelAndView;
import uk.co.nicshouse.jester.domain.Property;
import uk.co.nicshouse.jester.service.PropertyService;

@Controller
@RequestMapping("/property")
public class PropertyController
{
    @Autowired
    private PropertyService propertyService;

    /*
     * Methods that return views
     */

    @RequestMapping(method=RequestMethod.GET, produces="text/html")
    public String listProperty(Model model, HttpServletRequest request)
    {
        model.addAttribute( propertyService.getAll() );
        model.addAttribute("hostname", request.getServerName());
        return "property/list";
    }

    @RequestMapping(value="/{id}", method=RequestMethod.GET, produces="text/html")
    public String viewProperty(@PathVariable long id, Model model)
    {
        model.addAttribute( propertyService.getById(id) );
        return "property/view";
    }

    @RequestMapping(value="/{id}/edit", method=RequestMethod.GET, produces="text/html")
    public String editProperty(@PathVariable long id, Model model)
    {
        model.addAttribute( propertyService.getById(id) );
        return "property/edit";
    }

    @RequestMapping(value="/new", method=RequestMethod.GET, produces="text/html")
    public String newProperty(Model model)
    {
        model.addAttribute( new Property() );
        return "property/edit";
    }

    @RequestMapping(value="/new", method=RequestMethod.POST)
    public String createProperty(@Valid Property property, BindingResult bindingResult)
    {
        getPropertyService().create(property);
        return "redirect:/property/" + property.getId();
    }

    @RequestMapping(value="/**", method=RequestMethod.PUT)
    public String updateProperty(@RequestParam("id") int id, Property property)
    {
        System.out.println("Supplied id: " + id);
        System.out.println("Supplied property: " + property);
        getPropertyService().update(property);

        return "redirect:/property/" + property.getId();
    }

    public PropertyService getPropertyService()
    {
        return propertyService;
    }

    public void setPropertyService(PropertyService propertyService)
    {
        this.propertyService = propertyService;
    }
} 
```

jstl 生成的表单如下所示：

```
<form id="property" action="/jester/property/1/edit" method="post" enctype="multipart/form-data"><input type="hidden" name="_method" value="PUT"/>
<input id="id" name="id" type="hidden" value="3"/>
<div>
    <label for="name">Name</label>
    <input id="name" name="name" type="text" value="Test Name" size="15"/><br/>

</div>
<div>
    <label for="description">Description</label>
    <textarea id="description" name="description" size="15">Test Description Here</textarea><br/>

</div>
<div>
    <label for="address.street">Street</label>
    <input id="address.street" name="address.street" type="text" value="Test Street" size="15"/><br/>

</div>
<div>
    <label for="address.borough">Borough</label>
    <input id="address.borough" name="address.borough" type="text" value="" size="15"/><br/>

</div>
<div>
    <label for="address.town">Town</label>
    <input id="address.town" name="address.town" type="text" value="Test Town" size="15"/><br/>

</div>
<div>
    <label for="address.county">County</label>
    <input id="address.county" name="address.county" type="text" value="Test County" size="15"/><br/>

</div>
<div>
    <label for="address.postcode">Postcode</label>
    <input id="address.postcode" name="address.postcode" type="text" value="TT11 1TT" size="15"/><br/>

</div>
<div>
    <label for="address.country">Country</label>
    <input id="address.country" name="address.country" type="text" value="UK" size="15"/><br/>

</div>
<div>
    <input type="submit" value="Save" />
    <input type="reset" />
</div> 
```

奇怪的是`id==3`（来自 HTML 表单的正确值），但是`property.id==0`! 属性的其他变量设置正确。任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T17:08:48.607

想通了这个，这是我的一个错误。Property.id 的类型很长，但 Property.setId 接受一个 int。这似乎在某种程度上把 Spring 搞砸了！不过感谢您的努力！NFV

# cocos2d-iphone - Box2d & Cocos2d 正确的碰撞点

> ID：13214107
> 
> 赞同：0
> 
> 时间：2012-11-03T22:27:25.797
> 
> 标签：cocos2d-iphone, box2d-iphone

我的游戏中有碰撞检测。现在我需要碰撞点。我明白了：

```
int numPoints = contact.b2contact->GetManifold()->pointCount;
b2WorldManifold worldManifold;
contact.b2contact->GetWorldManifold( &worldManifold );
for (int i = 0; i < numPoints; i++)
{
    NSLog(@"%@" NSStringFormCGPoint(ccp(worldManifold.points[i].x,worldManifold.points[i].y));
} 
```

此日志显示位置，但在 box2d 标准中。我应该如何正确地将其转换为 Cocos2d v2 线？因为乘以 PTM_RATIO 不能很好地工作。

## 更新

此刻我想出了这个。

```
b2Manifold* mainfold = contact->GetManifold();
int numPoints = mainfold->pointCount;

    for (int i=0; i<numPoints; i++) {
        b2ManifoldPoint *p = mainfold->points;
        NSLog(@"Dot:%@",NSStringFromCGPoint(ccp(p->localPoint.x * PTM_RATIO, p->localPoint.y * PTM_RATIO);));
    } 
```

但这仅显示一个身体的正确点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T11:44:31.897

我认为您的第一个示例是正确的，但是您没有正确地将积分转换为世界积分。像这样的东西可能会起作用（我不在我的电脑上进行测试，但我认为这无论如何都会给你正确的方向。

```
int numPoints = contact.b2contact->GetManifold()->pointCount;
b2WorldManifold worldManifold;
contact.b2contact->GetWorldManifold( &worldManifold );
for (int i = 0; i < numPoints; i++)
{
    b2Vec2 worldPoint = worldManifold.points[i]->GetWorldPoint();
    NSLOG(@"(%f,%f)", worldPoint.x*PTM_RATIO, worldPoint.y*PTM_RATIO);
} 
```

# java - display.async 和平滑过渡

> ID：13214110
> 
> 赞同：0
> 
> 时间：2012-11-03T22:27:52.033
> 
> 标签：java, multithreading, swt

我有我的自定义小部件，它在悬停时会改变背景。它工作得很好，但我希望在无背景和悬停背景之间平滑过渡。它将与 一起使用`GC.setAlpha()`，但是：

```
Display.getDefault().asyncExec(new Runnable() {
    public void run() {
        for (int i=0;i<255;i++) {
            setBG(BGHelper(imgHover,i)); //i - alpha
            try {
                Thread.sleep(1);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }   
}); 
```

此代码等到`i == 255`，但它不显示平滑过渡。为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T18:04:40.310

这是行不通的，因为只要你在你的 Code SWT 中就不会重绘或改变组件。

您应该在单独的线程中完成工作并要求`Display.asyncExec`每次更改。

```
for (int i = 0; i < 255; i++) {
    final int x = i;
    Display.getDefault().asyncExec(new Runnable() {
        public void run() {
            setBG(BGHelper(imgHover,x)); //x - alpha
        }
    });
    try {
        Thread.sleep(1);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
} 
```

# java - 将任务从 EDT 分派到主节点？

> ID：13214111
> 
> 赞同：2
> 
> 时间：2012-11-03T22:27:59.293
> 
> 标签：java, multithreading, swing, concurrency, event-dispatch-thread

我一直在阅读一些关于并发的文章（这让我很头疼）。

我了解您可以使用以下方法从主线程设置要在 EDT 上运行的任务：

```
SwingUtilities.invokeLater 
```

但是你能设置一个任务在 EDT 的主线程上运行吗？

如：

```
Thread mymainthread=Thread.currentThread();//<referring to the thread that initially kicks off public static void main

public void mousePressed(MouseEvent e){ //queue a task to run on mymainthread } 
```

可以做到吗？这是个坏主意吗？

与此类似的另一个问题（[此处](https://stackoverflow.com/questions/2436113/make-process-run-on-non-edt-event-dispatch-thread-thread-from-edt)）谈到了创建一个新线程，但如果我的目标是单线程（+EDT）应用程序，继续使用主线程不是更安全、更简单吗？.......或者也许我把这一切都弄错了。

编辑：我应该解释的内容：我想创建可以在主线程上相互通信的对象（在慢循环中运行），所以我不希望它们中的任何一个在不同的线程、edt 或其他线程上实例化。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T22:35:38.327

> 但是你能设置一个任务在 EDT 的主线程上运行吗？

我认为您对 EDT 是什么感到困惑。Swing 和许多其他框架使用一种称为线程限制的技术。
为了保证线程安全，所有动作都从单个线程执行。Swing 中的这个线程称为 Event Dispatcher Thread。该线程有一个队列，并在同一个线程中一次一个*顺序地*
执行该队列中的所有任务。这就是为什么你的任务应该很短以免阻塞 UI。 因此，当您使用 EDT 时，您实际上是将任务从您的线程传递到其队列，而 EDT 最终将执行它。 *您可以做的是在 EDT 队列上放置一个任务，该队列会生成一个要在单独线程上执行的线程。如果您出于某种原因想将当前线程用作后台线程，也许可以，但为什么需要它？最直接的方法是提交一个runnable作为一些后台线程的一部分运行，例如池的一部分*

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T15:55:42.387

您可以创建自己的事件循环来执行线程限制。这将允许您有一个单独的单线程，其行为类似于 EDT。注意不要同时在两个线程之间共享 [有效] 可变对象。

实现可以像`while`带有`BlockingQueue`. 您可以通过获取`ExecutorService`from来稍微提高一点水平`java.util.concurrent.Executors.newFixeThreadPool(1)`。*

# java - 为什么当我从 Web 浏览器打开它并用 Java 读取它时，html 源代码会有所不同？

> ID：13214112
> 
> 赞同：-2
> 
> 时间：2012-11-03T22:28:00.410
> 
> 标签：java, html, parsing

我有一个关于解析在线 html 页面的问题。

当我从网络浏览器打开 html 源代码时，我可以看到其中的数据。

但是当我从 java 读取这个 html 页面时。我无法访问数据。

在我保存了这个 html 文件并将其作为本地文件读取后，

然后我可以从那里读取数据。

我以 eBay.com.au 为例。

// - - - - 例子 - - - - -

目标网页网址：http://www.ebay.com.au/sch/i.html?_trksid=p3907.m570.l1311&_nkw=imac+27&_sacat=0&_from=R40

这是我的Java代码

```
import org.htmlcleaner.CleanerProperties;
import org.htmlcleaner.TagNode;
import org.htmlcleaner.HtmlCleaner;
import java.net.URL;

public class HtmlCleanerTest
{

    public static void main(String[] args) throws Exception
    {

        CleanerProperties props = new CleanerProperties();

        URL myURL = new URL("http://www.ebay.com.au/sch/i.html?_trksid=p3907.m570.l1311&_nkw=imac+27&_sacat=0&_from=R40");

        TagNode tagNode = new HtmlCleaner(props).clean(myURL);

        Object[] myNodes = tagNode.getElementsByAttValue("class", "s1", true, true);

        for(Object oNote : myNodes)
        {
            TagNode n = (TagNode) oNote;
            System.out.println(n.getText());

        }
    }
} 
```

我可以使用此代码获取每个产品的价格，但我希望使用此代码获取卖家位置信息。我怎么做？

//---重新编辑-------------------

我找到了解决问题的方法，我在这里为像我这样有同样问题的人发布了它。我并不是说这是最好的解决方案，但我希望它可以给你一个想法。这里是。

```
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.firefox.FirefoxDriver;
import java.util.List;;

public class Test{
    public static void main(String[] args)
    {
        WebDriver driver = new FirefoxDriver();
        driver.get("http://www.ebay.com.au/sch/i.html?scp=ce0&_sacat=0&_from=R40&_nkw=imac+27&_pppn=r1&_rdc=1");

        driver.findElement(By.id("e1-14")).click();

        driver.findElement(By.name("Stores")).click();
        driver.findElement(By.id("e1-3")).click();

        driver.quit();
    }
} 
```

/ *-------------- ------END-------- --------------* /

我带着一个问题来到这里，如果 HTML 文件带有 Javascript，我们如何在完整执行 Javascript 的情况下从中获取数据。我想我不是很好的提问者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T23:16:11.390

页面可能有一些 JavaScript 代码由浏览器执行，并在加载 HTML 后向页面加载更多数据。使用 Java 仅读取 HTML 不会执行 JavaScript，因此流中不可见其他数据。

编辑：像 HtmlUnit 这样的库可能有助于在一定程度上解决加载 Ajaxified Html 页面的常见问题：http: [//htmlunit.sourceforge.net/](http://htmlunit.sourceforge.net/)

# mysql - 使用 MySQL Match 和 Union 进行 ZEND 搜索

> ID：13214115
> 
> 赞同：0
> 
> 时间：2012-11-03T22:28:25.237
> 
> 标签：mysql, zend-framework, search, zend-db

我不得不承认我无法弄清楚如何完成这个。我可以让查询在 MySql 中工作，我可以在 Zend Framework 中获得简单的表或视图查询，但这超出了我的范围！

这是我要运行的查询：

```
SELECT * from (
SELECT 
'Tab' as 'table_name', TabId as id, `TabTitle` as title,
(MATCH(`TabTitle`,`TabSubTitle`) AGAINST (@target)) as relevance
from Tab
UNION
SELECT 
'Tab2' as 'table_name', 
Tab2Id as id, `Tab2Title` as title,
(MATCH(`Tab2Title`,`Tab2Desc`) AGAINST (@target)) as relevance
from Tab2
)
as sitewide WHERE relevance > 0 order by relevance DESC; 
```

我希望您能提供任何关于如何将其硬塞到 Zend 的 MVC 框架中的指示！

编辑添加：

这是我正在使用的当前模型代码，它给出了错误“传递给 Zend_Paginator_Adapter_DbTableSelect::__construct() 的参数 1 必须是 Zend_Db_Select 的实例，给定字符串”

```
class Application_Model_Search extends Zend_Db_Table
{
protected $_name = ‘Search’;
protected $_primary = 'SearchId';

function getSearchResults($page, $searchTerm) 
{

    $query = "
SELECT * from (
 SELECT 
 'Tab' as 'table_name', TabId as id, `TabTitle` as title,
 (MATCH(`TabTitle`,`TabSubTitle`) AGAINST (@target)) as relevance
 from Tab
 UNION
 SELECT 
 'Tab2' as 'table_name', 
 Tab2Id as id, `Tab2Title` as title,
 (MATCH(`Tab2Title`,`Tab2Desc`) AGAINST (@target)) as relevance
 from Tab2
)
as sitewide WHERE relevance > 0 order by relevance DESC;        
    ";

    echo ($query);      

    $paginator = new Zend_Paginator(new Zend_Paginator_Adapter_DbTableSelect($query));
    $paginator->setItemCountPerPage(15); //
    $paginator->setCurrentPageNumber($page); 
    return $paginator; 

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T12:12:43.643

```
 $config = array (
        'dbname' => 'test',
        'password' => 'passwd',
        'username' => 'user'
    );

    $database = new Zend_Db_Adapter_Mysqli ($config);

    $query_1 = new Zend_Db_Select ($database);
    $query_1->from ('Tab', array (
        'Tab AS table_name',
        'TabId AS id',
        'TabTitle` as title',
        new Zend_Db_Expr ('(MATCH(`TabTitle`,`TabSubTitle`) AGAINST (@target)) as relevance')
    ));

    $query_2 = new Zend_Db_Select ($database);
    $query_2->from ('Tab2', array (
        'Tab2 AS table_name',
        'Tab2Id AS id',
        'Tab2Title` as title',
        new Zend_Db_Expr ('(MATCH(`Tab2Title`,`TabDesc`) AGAINST (@target)) as relevance')
    ));

    $query = $database->select ()
        ->union (array (
        $query_1,
        $query_2
    ));

    echo $database->select ()->from ($query)->where ('relevance>0')
        ->order ('relevance DESC'); 
```

# javascript - 使用 ajax 的 javascript 函数的引用错误

> ID：13214117
> 
> 赞同：-3
> 
> 时间：2012-11-03T22:28:27.830
> 
> 标签：javascript, ajax

我正在使用 ajax 在 mysql 数据库上使用关键字搜索，当结果出现时，我想将选项显示为带有 onclick 功能的 href，搜索工作正常，但是当我单击任何选项时，我得到一个参考错误我的萤火虫，这是代码：index.php

```
 <html>

<body>
    <style>
        #displayDiv {
            background-color: #ffeeaa;
            width: 200;
        }
    </style>
    <script type="text/javascript">
        function aca(esto) {
            var esta = esto;
            alert(esta);
        }
    </script>
    <script type="text/javascript">
        function ajaxFunction(str) {
            var httpxml;
            try {
                // Firefox, Opera 8.0+, Safari
                httpxml = new XMLHttpRequest();
            } catch (e) {
                // Internet Explorer
                try {
                    httpxml = new ActiveXObject("Msxml2.XMLHTTP");
                } catch (e) {
                    try {
                        httpxml = new ActiveXObject("Microsoft.XMLHTTP");
                    } catch (e) {
                        alert("Your browser does not support AJAX!");
                        return false;
                    }
                }
            }

            function stateChanged() {
                if (httpxml.readyState == 4) {
                    document.getElementById("displayDiv").innerHTML = httpxml.responseText;

                }
            }
            var url = "search.php";
            url = url + "?txt=" + str;
            url = url + "&sid=" + Math.random();
            httpxml.onreadystatechange = stateChanged;
            httpxml.open("GET", url, true);
            httpxml.send(null);
        }
    </script>
    </head>

    <body>
        <form name="myForm">
            <input type="text" onkeyup="ajaxFunction(this.value);" name="username"
            />
            <div id="displayDiv"></div>
        </form>
    </body> 
```

这是search.php

```
<?php
include ("dbinfo.php");
$in = $_GET['txt'];
$msg = "";
if (strlen($in) > 0 and strlen($in) < 20) {
    $t = mysql_query("select RubroId, RubroDisp from rubros where KeyWords like '$in%'");
    while ($nt = mysql_fetch_array($t)) {
        $valor = $nt[RubroDisp];
        $valorCodificado = str_replace(" ", "_", $valor);
        echo "<a href='#' onclick='aca($valorCodificado);'>$valor</a><br />";

                                        }
                                          }
?> 
```

[您可以在此 url](http://www.gsilvainc.com/buscador)看到工作页面

你能告诉我如何解决它吗？或者我做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T22:38:53.823

`aca($valorCodificado);`将生成 JavaScript 调用带有变量（可能不存在）作为参数的函数。看起来你想要一个字符串。字符串需要引号。

# formatting - 读取未格式化的数据，intel ifort vs Ibm xlf

> ID：13214119
> 
> 赞同：1
> 
> 时间：2012-11-03T22:28:34.480
> 
> 标签：formatting, fortran

我正在尝试从 intel ifort 转移到 IBM xlf，但是在读取“未格式化的输出数据”（未格式化的意思是它们的长度不同）时，出现了问题。这是一个例子：

```
program main
implicit none
real(8) a,b
open(unit=10,file='1.txt')
read (10,*) a
read (10,*) b
write(*,'(E20.14E2)'),a,b
close(10)
end program 
```

1.txt：

```
0.10640229631236
8.5122792850319D-02 
```

使用 ifort 我得到输出：

```
0.10640229631236E+00
0.85122792850319E-01 
```

使用 xlf 我得到输出：

```
' in the input file.  The program will recover by assuming a zero in its place.e invalid digit '
0.10640229631236E+00
0.85122792850319E-01 
```

由于1.txt中的数据是未格式化的，所以我无法使用固定的格式来读取数据。有谁知道如何解决这个警告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-25T17:55:34.877

（评论中回答的问题。请参阅[没有答案的问题，但问题已在评论中解决（或在聊天中扩展）](https://meta.stackoverflow.com/questions/251597/question-with-no-answers-but-issue-solved-in-the-comments)）

@MSB 写道：

> 输入文件中是否有撇号？或者除了数字、小数点和“D”之外的任何字符？您的阅读是“列表定向”。

OP写道：

> 是的，在 0.10640229631236 之后似乎有一些字符会导致此警告。当我手动将这些数字写入新文件时（通过回车键更改 0.10640229631236 之后的行），此警告消失。我`cat -v`有这两个文件：使用警告文件我得到 0.10640229631236^M 8.5122792850319D-02 而没有警告文件我得到 0.10640229631236 8.5122792850319D-02 你知道 M 代表什么以及它来自哪里吗？

@agentp 给出了链接：

> ['^M' 字符在行尾](https://stackoverflow.com/questions/64749/m-character-at-end-of-lines)

这解释了 ^M 是用于回车的 windows 字符

# .htaccess - 具有不同文件夹和参数的 htaccess 重定向 url

> ID：13214121
> 
> 赞同：1
> 
> 时间：2012-11-03T22:29:05.230
> 
> 标签：.htaccess

我想`.htaccess`从以下网址重定向一个网址：

```
domain_name.com/folder/index.php?param=0 
```

至：

```
domain_name.com/another_folder/page.html 
```

如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T22:42:24.957

```
RewriteRule ^another_folder/page([A-Za-z0-9-]+)\.html$ folder/index.php?param=$1 
```

# objective-c - 是否允许使用 ARC 在 ObjC 中调用 [obj copy]？

> ID：13214126
> 
> 赞同：0
> 
> 时间：2012-11-03T22:29:33.587
> 
> 标签：objective-c, memory-management, copy, automatic-ref-counting, autorelease

关于 ARC，我不明白一件事：我们现在应该如何处理使用创建的局部变量`[... copy]`？如果我用`(copy)`标志创建一个属性，ARC 会自动处理这个，但据我所知，变量没有`__copy`标志。

我已经用这样的代码对此进行了测试：

```
@interface Foo : NSString
@end

@implementation Foo

- (void) dealloc {
  NSLog(@"%p deallocated", self);
}

- (NSUInteger) length {
  return 1;
}

- (unichar) characterAtIndex: (NSUInteger) i {
  return 'x';
}

@end

- (void) foo {
  Foo *f = [[Foo alloc] init];
  NSLog(@"%p", f);

  Foo *f2 = [f copy];
  NSLog(@"%p", f2);
} 
```

我得到的是：

```
0x102406530
0x102015f10
0x102406530 deallocated 
```

我从来没有得到“0x102015f10 deallocated”，这表明复制的变量没有被释放。它甚至没有自动释放，因为当我创建另一个`[Foo foo]`返回自动释放对象的方法时，我确实在片刻后收到了“已释放”消息。

那么有什么方法可以在不将其转换为属性的情况下释放它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T23:02:56.020

Ok, my bad - ARC does actually handle copied objects properly. I got wrong results because of using NSString for the test, because I wanted to use a class that already implemented copying instead of implementing it explicitly; when I repeated the test on a class inheriting from NSObject and implementing `copyWithZone:` by returning `[[Foo alloc] init]`, I got two "deallocated" messages. Thanks to @Paul.s for pointing that out.

# linux - wget 一些网站 .gif 文件

> ID：13214129
> 
> 赞同：-1
> 
> 时间：2012-11-03T22:30:13.790
> 
> 标签：linux, parsing, wget

我尝试了不同的选项，但我仍然无法 获得[http://auno.org/ao/nanos.php?prof=nano-technician](http://auno.org/ao/nanos.php?prof=nano-technician) 我想获得所有的 littles .gif 图像。

我目前的要求是：

```
wget -A.gif http://auno.org/ao/nanos.php?prof=nano-technician/ 
```

我尝试了许多选项，例如 -O 或 -U firefox 等。感谢阅读。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T22:58:41.540

这样你只下载请求的页面，没有别的。如果您想下载更多内容，则必须打开递归下载 ( `-r`)。

此外，由于图像位于不同的主机上，您可能希望启用主机跨接（`-H`），并且当您这样做时，您还应该指定限制性递归限制以避免下载一半的互联网（`-l`）：

```
wget -A .gif -r -l 1 -H http://auno.org/ao/nanos.php?prof=nano-technician/ 
```

# python - 如何一次打印多个项目

> ID：13214131
> 
> 赞同：1
> 
> 时间：2012-11-03T22:30:19.937
> 
> 标签：python, addition

```
print "i'm going to calculate minutes for you \n"

print "enter the amount of minutes for your introduction"
intro_minutes = int(raw_input('# '))

print "enter the amount of seconds for your introduction"
intro_seconds = int(raw_input('# ')) 

print "your introduction is "  (intro_seconds + (60 * intro_minutes)) " seconds long." 
```

我正在创建这个程序来计时我必须发表的演讲。我得到的错误是：

```
File "speech.py", line 9
    print "your introduction is " (intro_seconds + (60 * intro_minutes)) " seconds long.)

SyntaxError: invalid syntax 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T22:33:23.673

一种解决方案是连接您要打印的字符串：

```
print "your introduction is " + str(intro_seconds + (60 * intro_minutes)) + " seconds long." 
```

注意额外的调用`str()`，因为如果您尝试将数字添加到字符串中，Python 会出错（因为不清楚您想要什么）。

这种连接有点难看，所以你可能想使用字符串格式：

```
print "your introduction is {0} seconds long.".format(intro_seconds + (60 * intro_minutes)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T22:34:40.367

您需要以某种方式连接要打印的不同部分。在您的情况下，最简单的方法是添加逗号：

```
print "your introduction is",  (intro_seconds + (60 * intro_minutes)), "seconds long." 
```

当然，更“经典”的方法是进行字符串连接：

```
print "your introduction is " + str(intro_seconds + (60 * intro_minutes)) + " seconds long." 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-03T22:34:11.193

你需要连接字符串：

```
print "your introduction is " + str(intro_seconds + (60 * intro_minutes)) + " seconds long." 
```

或者：

```
print "your introduction is %d seconds long." % (intro_seconds + (60 * intro_minutes)) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-03T22:34:35.587

您应该使用逗号分隔 print 中的值：

```
print "your introduction is ", (intro_seconds + (60 * intro_minutes)), " seconds long." 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-03T22:35:04.927

```
print "your introduction is %s seconds long" % (intro_seconds + (60 * intro_minutes)) 
```

# cuda - 在 Web 应用程序中使用 amazon gpu 集群

> ID：13214136
> 
> 赞同：1
> 
> 时间：2012-11-03T22:30:48.693
> 
> 标签：cuda, amazon, gpu

有没有人有任何在 Web 应用程序中插入 Amazon gpu 集群的经验？甚至可能吗？我想为我用 cuda 编写的模拟器制作一个在线界面，但到目前为止我所看到的一切都涉及 ssh 和命令行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T03:03:11.187

是的，这很有可能！

*如果您打算不*使用较低级别的编程语言构建前端逻辑，那么您可能需要考虑将您的 CUDA C 代码（我只是假设 C）绑定到您首选的脚本语言以提高效率，但这绝对是可能的。

请记住，许多 Web 开发人员严格从命令行构建他们的应用程序，您只需要找到一种有效且高效的方式从您的 Web 应用程序调用 CUDA 代码，然后只需将结果返回给发出请求的客户端。

# php - 谷歌地图信息窗口替代品

> ID：13214137
> 
> 赞同：-3
> 
> 时间：2012-11-03T22:30:51.857
> 
> 标签：php, google-maps, google-maps-api-3, infowindow

我尝试了 infobox，它似乎是标准 infowindow 的最具延展性的替代品，它不能按我想要的样式设置。信息框似乎有一些问题，我在这里发布了，但没有得到任何答案。

所以我的新问题是：还有其他选择吗？我的意思是一个很好的。我在这个网站上发现了另外两个非常难看的例子。我比他们更喜欢标准的信息窗口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T10:09:12.810

Check these out:

*   [Alternatives to infowindow](https://stackoverflow.com/questions/1121252/alternatives-to-infowindow)
*   [Googlemap custom infowindow](https://stackoverflow.com/questions/3364533/googlemap-custom-infowindow)
*   [Styling Google Maps InfoWindow](https://stackoverflow.com/questions/5634991/styling-google-maps-infowindow)

First one has plenty of links regarding custom InfoWindows, and the second and third might help you stylizing either a default or custom InfoWindow.

# asp.net-mvc - 模型层对 MVC 属性的依赖

> ID：13214138
> 
> 赞同：0
> 
> 时间：2012-11-03T22:31:03.920
> 
> 标签：asp.net-mvc, nhibernate, model, data-annotations

我们有一个使用 nHibernate 的 MVC3 项目；有一个单独的模型项目，其中包含存储库和服务层使用的所有模型类。这些模型使用 System.ComponentModel.DataAnnotations 中的 DisplayAttribute 和 RequiredAttribute 等数据注释。

System.Web.Mvc 中还包含诸如 RemoteAttribute 之类的属性。

这当然意味着模型项目现在依赖于特定的前端技术。

假设解决方案可能有其他前端，那么处理此依赖链接的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T04:47:53.300

为了减少数据库模型和前端技术之间的依赖关系，您可以使用特殊的视图模型来验证控制器中的其他前端操作，并将数据从视图模型放到数据库实体之后。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T04:15:27.300

`RemoteAttribute`不属于模型，因为它指定了一个控制器/动作来验证服务器上的属性，并且模型不应该了解控制器、动作或路由等概念。表示层取决于模型，而不是相反。

我将创建一个继承模型的视图模型，覆盖属性（必须是虚拟的）并添加`RemoteAttribute`. 这种方式可以避免重复和映射，尽管这也是一种替代方法。

# css - 使用 Twitter Bootstrap 在 Sass 中处理自定义媒体查询

> ID：13214139
> 
> 赞同：1
> 
> 时间：2012-11-03T22:31:15.613
> 
> 标签：css, sass, media-queries

我有一个基于 Twitter Bootstrap 响应式媒体查询的 Sass mixin 用于我的媒体查询：

```
@mixin respond-to($media) {
    @if $media == handhelds {
        /* Landscape phones and down */
        @media (max-width: 480px) { @content; }
    }
    @else if $media == small {
        /* Landscape phone to portrait tablet */
        @media (max-width: 767px) {@content; }
    }
    @else if $media == medium {
        /* Portrait tablet to landscape and desktop */
        @media (min-width: 768px) and (max-width: 979px) { @content; }
    }
    @else if $media == large {
        /* Large desktop */
        @media (min-width: 1200px) { @content; }
    }
    @else {
        @media only screen and (max-width: #{$media}px) { @content; }
    }
} 
```

我在我的 SCSS 文件中这样称呼它们：

```
.link {
   color:blue;
   @include respond-to(medium) {
        color: red;
    }
} 
```

但是，有时我想用相同的样式设置多个查询的样式。现在我正在这样做：

```
.link {
    color:blue; /* this is fine for handheld and small sizes*/

    /*now I want to change the styles that are cascading to medium and large*/
    @include respond-to(medium) {
        color: red;
    }
    @include respond-to(large) {
        color: red;
    }
} 
```

但我在重复代码，所以我想知道是否有更简洁的方法来编写它，以便我可以针对多个查询。像这样的东西，所以我不需要重复我的代码（我知道这不起作用）：

```
@include respond-to(medium, large) {
    color: red;
} 
```

有关处理此问题的最佳方法的任何建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T23:47:34.453

像这样的 mixin 会让您处于一个不太灵活的位置，而不仅仅是因为您使用的是 px（请参阅： http: [//blog.cloudfour.com/the-ems-have-it-proportional-media-queries-英尺/](http://blog.cloudfour.com/the-ems-have-it-proportional-media-queries-ftw/)）。简单地说，你让你的 mixin 太具体了，对其他网站来说不是很可重用。

我目前正在使用 4 个 mixin 的集合来处理最常见的媒体查询：min-width、max-width、between 和 outside（我在下面采样了 min-width 和 between）

```
$output-media-width: true !default; // true = all, otherwise use a list of numeric values (eg. 320px 23em)

@mixin media-min-width($bp) {
    @if type-of($output-media-width) != list {
        @media (min-width: $bp) {
            @content;
        }
    } @else {
        $output-bp: find-comparable($bp, $output-media-width);
        @if not comparable($output-bp, $bp) {
            @debug "Output breakpoint: #{$output-bp}, Chosen minimum width: #{$bp}";
        } @else if $output-bp >= $bp {
            @content;
        }
    }
}

@mixin media-between($bp1, $bp2) {
    @if type-of($output-media-width) != list {
        @media (min-width: $bp1) and (max-width: make-less-than($bp2)) {
            @content;
        }
    } @else {
        $output-bp1: find-comparable($bp1, $output-media-width);
        $output-bp2: find-comparable($bp2, $output-media-width);
        @if not comparable($output-bp1, $bp1) or not comparable($output-bp2, $bp2) {
            @debug "Output breakpoints: #{$output-bp1} and #{$output-bp2}, Chosen breakpoints: #{$bp1} and #{$bp2}";
        } @else if $output-bp2  >= $bp1 and $output-bp2 < $bp2 {
            @content;
        }
    }
}

@function find-comparable($val, $list) {
    @each $item in $list {
        @if comparable($val, $item) {
            @return $item;
        }
    }
}

@function make-less-than($val) {
    @return if(unit($val) == em, $val - .001, $val - 1);
} 
```

这个 mixin 套件让我可以生成一个响应式 CSS 文件或一组我想要的任何宽度的非响应式 CSS 文件（特别是对于那些不喜欢媒体查询的设备），只需在我的顶部有一个这样的变量文件：

```
$output-media-width: 800px 60em; 
```

尺寸列表让我可以在 em 不合适的极少数情况下使用 px（例如用于处理图像）。

```
// Device widths
$device-x-narrow: 23em; // 320px
$device-narrow: 35em; // 480px
$device-medium: 60em; // 800px
$device-wide: 70em; // 1000px

article.event {
    @mixin tableify {
//      footer { display: table-row }
        footer section { display: table-cell }
        footer section + section { padding-left: 2em }
    }

    @include media-min-width($device-medium) { // 2-col layout still
        #main > & { // single event view
            @include tableify;
        }
    }

    // sometimes you need a non-standard breakpoint, too...
    @include media-min-width(27em) { // narrow devices
        section & {
            @include tableify;
        }
    }

    @include media-max-width(27em) {
        footer section.categories ul {
            display: block;
            padding-left: 0;
            li { display: inline }
            li + li { margin-left: 1em }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T06:41:11.543

尽管@cimmanon 在我发布我正在使用 Twitter Bootstrap 之前回答了我的问题，但其中有一些非常有趣的想法，我想我将从现在开始将这些想法应用到使用 Twitter Bootstrap 的 Sass 项目中。这是我发现效果很好的方法：

```
/* Responsive dimensions */
$handheld-max: 479px;
$small-min: $handheld-max + 1;
$small-max: 767px;
$medium-min: $small-max + 1;
$medium-max: 979px;
$large-min: $medium-max + 1;
$large-max: 1199px;
$xlarge: 1200;

/*Responsive query mixins */
@mixin media-above($min) {
  @media (min-width: $min) { @content; }
}
@mixin media-below($max) {
  @media (max-width: $max) { @content; }
}
@mixin media-between($min, $max) {
  @media (min-width: $min) and (max-width: $max) { @content; }
} 
```

然后像这样在我的代码中调用它（根据我在问题中的要求）：

```
.link {
    color: blue;
    @mixin media-above($medium-min){
       color: red;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-22T23:07:22.827

Using bootstrap-sass variables, I defined such mixins in SASS syntax:

```
=media-width-below($max)
  @media (max-width: $max)
    @content

=media-width-between($min, $max)
  @media (min-width: $min), (max-width: $max)
    @content

=media-width-above($min)
  @media (min-width: $min)
    @content

=media-xs
  +media-width-above($screen-xs-min)
    @content

=media-sm
  +media-width-above($screen-sm-min)
    @content

=media-md
  +media-width-above($screen-md-min)
    @content

=media-lg
  +media-width-above($screen-lg-min)
    @content 
```

Those mixins will be useable just like `+make-sm-column` or `.col-md-5` classes. You can just use it like this:

```
body
  +media-xs
    background-color: yellow
  +media-sm
    background-color: blue
  +media-md
    background-color: red
  +media-lg
    background-color: green 
```

When you will be making your browser smaller by changing it from large to xs, you'll see colors in this order: green, red, blue, yellow.

# objective-c - UIScrollView 不滚动。怎么了？

> ID：13214140
> 
> 赞同：0
> 
> 时间：2012-11-03T22:31:24.527
> 
> 标签：objective-c, ios

我`scroll(width 320, height 420)`在“界面生成器”中创建了一个。

在课堂上：

```
 -(void)viewWillAppear:(BOOL)animated {
    [scroll setContentSize:CGSizeMake(scroll.frame.size.width, 1000)];
 } 
```

但滚动视图不滚动？

查看打印屏幕

```
 http://imageshack.us/photo/my-images/832/scrollo.png 
  http://imageshack.us/photo/my-images/203/capturadetela20121103s2.png 
  http://img802.imageshack.us/img802/889/capturadetela20121103s2.png 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T01:40:26.357

我想也许你没有成功添加图片或者没有成功设置scrollView的contentSize。我建议您在将图像视图添加到滚动视图后设置 contentSize。`viewDidLoad`是个好主意。大部分时间都不会做太多的工作`viewWillAppear`。在此方法完成之前，不会显示视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T11:06:09.770

已解决的问题：“自动布局”已打开...必须关闭。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T00:46:05.450

检查您是否使用带有框架的滚动视图进行初始化：

```
self.scrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, 280, 360)]; 
```

还要记住将 contentSize 设置为大于 frame，例如：

```
self.scrollView.contentSize = CGSizeMake(2*280, 360); 
```

还在您的界面中添加委托：

```
<UIScrollViewDelegate> 
```

并委托它：

```
self.scrollView.delegate = self; 
```

# java - 多个线程与 Pipe 流通信并使用 PushbackInputStream

> ID：13214144
> 
> 赞同：1
> 
> 时间：2012-11-03T22:32:05.267
> 
> 标签：java, multithreading, random, iostream, pipe

问题如下：

创建 3 个线程。

*   第一个将生成 10 个随机数，
*   第二个将总结这 10 个的偶数。
*   第三个将把相同的 10 个随机数的奇数相加。

我的问题是：在第二个线程中，我读取了所有数字并将它们推回流，但是当第三个线程想要从流中读取时，读取的第一个值是 -1 ？！

这是代码：

```
//main program 
import java.io.*;
public class anonymous {

public static void main(String[] args) throws  IOException, InterruptedException {
    final PipedOutputStream out= new PipedOutputStream();  
    final PipedInputStream in= new PipedInputStream(out);
    Thread1 th1 = new Thread1(out);
    Thread2 th2 = new Thread2(in);
    Thread3 th3 = new Thread3(in); 
    Thread t1 = new Thread(th1);
    Thread t2 = new Thread(th2); 
    Thread t3 = new Thread(th3); 
    t1.start(); 
    t2.start();
    t2.join();
    t3.start(); 
    t3.join();
    System.out.println("main finished.");   
}
}

//Thread1
import java.io.*;
import java.util.Random;
public class Thread1 implements Runnable{
PipedOutputStream out=null;
Random r = new Random();
public Thread1(PipedOutputStream send){
    this.out = send; 
}
public void run(){
    int num;
    System.out.println("thread 1 generated random numbers: ");
    try{
    for ( int i=0; i<10; i++)
        {
        num=r.nextInt(10);
        System.out.print(num + " ");
        out.write(num);
        }
    } catch (IOException e) {
        e.printStackTrace();
    } 
try {
    out.close();
} catch (IOException e) {
    e.printStackTrace();
}
System.out.println("\nthread 1 finished");
}
}

//Thread2
import java.io.*;
public class Thread2 implements Runnable{
PipedInputStream in=null;
public Thread2( PipedInputStream get){
    this.in = get;

}
public void run(){ 
    PushbackInputStream push = new PushbackInputStream(in , 10);
    //PushbackInputStream takes an InputStream and it will read the first 10 bytes
            // in the stream and push them back to the stream
    try {
        byte[] byteArr = new byte[10]; 
        int i, sum=0, idx=0;
        i=push.read();
        while (i != -1)
        { 
            if( i%2 == 0)
                sum += i; 
            byteArr[idx]=( byte) i;
            i=push.read();
            idx++;
        }
        push.unread(byteArr,0 , 10);
        System.out.println("thread 2: the sum of even random numbers: " + sum); 
    } catch (IOException e) {
        e.printStackTrace();
    }
System.out.println("thread 2 finished"); 
}
}

//Thread3
import java.io.*;
public class Thread3 implements Runnable{

PipedInputStream in;
public Thread3( PipedInputStream get){
    this.in = get;
}
public void run(){
    try {
        int i, sum=0;
        i=in.read();
        while (i != -1)
        { 
            if( i%2 == 1)
                sum += i; 
            i=in.read();
        }
        System.out.println("thread 3: the sum of odd random numbers:  " + sum);
    } catch (IOException e) {
        e.printStackTrace();
    }
    try {
        in.close();
    } catch (IOException e){
        e.printStackTrace();
    } 
System.out.println("thread 3 finished"); 
}
} 
```

输出如下：

> 线程 1 生成的随机数：
> 4 8 7 5 6 8 7 1 0 5
> 线程 1 完成
> 线程 2：偶数随机数之和：26
> 线程 2 完成
> 线程 3：奇数随机数之和：0
> 线程 3 完成
> main 完成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T22:39:44.973

您应该在第二个和第三个流之间使用另一个管道，而不是滥用推回功能。

# android - ProgressBar 和 AsyncTask

> ID：13214145
> 
> 赞同：0
> 
> 时间：2012-11-03T22:32:10.573
> 
> 标签：android, service, android-asynctask, progress-bar

我目前正在运行一个 AsyncTask，它在下载文件时更新 Activity 中的进度条。问题是当我离开 Activity 并重新进入时，ProgressBar 将不再更新。

我尝试在服务中运行 AsyncTask，但我不知道如何将 ProgressBar 值发送回我的 Activity 的 UI 线程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T23:04:50.047

1.  在您的活动中添加静态进度变量
2.  将进度保存到首选项

当您重新进入活动抓取并从静态变量或首选项设置进度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T20:36:54.600

我遇到了和你一样的问题：

*   我想要执行一个异步任务（作为服务）
*   我希望能够旋转设备，能够更新 UI，即使任务在屏幕关闭时完成并且我没有收到任何通知。

我想出了类似的东西：

```
public class DatabaseIncompleteActivity extends RoboActivity {
private BroadcastReceiver       receiver;
private ProgressDialog          progressDialog;

@Inject
private DatabaseSetManager      databaseSetManager;
@Inject
private DatabaseDownloadLogger  databaseDownloadLogger;

private LocalBroadcastManager   localBroadcastManager;
private String                  jobId;

private static final int        ERROR_RETRY_DIALOG  = 1;
private static final String     ERROR_MESSAGE       = "errorMsg";

@Override
protected void onCreate( Bundle savedInstanceState ) {
    super.onCreate( savedInstanceState );
    localBroadcastManager = LocalBroadcastManager.getInstance( this );

    showProgressDialog();
    if ( getLastNonConfigurationInstance() == null ) {
        startService();
    }
}

private void showProgressDialog() {
    progressDialog = new ProgressDialog( this );
    progressDialog.setMessage( getString( R.string.please_wait ) );
    progressDialog.setProgressStyle( ProgressDialog.STYLE_HORIZONTAL );
    progressDialog.setIndeterminate( true );
    progressDialog.setCancelable( false );
    progressDialog.show();
}

private void startService() {
    this.jobId = UUID.randomUUID().toString();
    Intent intent = new Intent( this, ClientDatabaseDroidService.class );
    intent.putExtra(    ClientDatabaseDroidService.JOB_ID,
                        jobId );
    intent.putExtra(    ClientDatabaseDroidService.INTERACTIVE,
                        true );
    startService( intent );
}

private void registerListenerReceiver() {
    if ( receiver != null ) {
        return;
    }
    localBroadcastManager.registerReceiver( this.receiver = new ClientDatabaseBroadcastReceiver(),
                                            new IntentFilter( ClientDatabaseDroidService.PROGRESS_NOTIFICATION ) );
}

@Override
protected void onPause() {
    super.onPause();
    unregisterListenerReceiver();
}

@Override
protected void onResume() {
    super.onResume();

    DatabaseDownloadLogEntry logEntry = databaseDownloadLogger.findByJobId( jobId );
    // check if service finished while we were not listening
    if ( logEntry != null ) {
        if ( logEntry.isSuccess() )
            onFinish();
        else {
            Bundle bundle = new Bundle();
            bundle.putString(   ERROR_MESSAGE,
                                logEntry.getErrorMessage() );
            onError( bundle );
        }
        return;
    }

    registerListenerReceiver();
}

@Override
public Object onRetainNonConfigurationInstance() {
    return Boolean.TRUE;
}

final class ClientDatabaseBroadcastReceiver extends BroadcastReceiver {
    @Override
    public void onReceive( Context context, Intent intent ) {
        Bundle extras = intent.getExtras();

        int eventType = extras.getInt( ClientDatabaseDroidService.EVENT_TYPE );

        switch ( eventType ) {
        case ClientDatabaseDroidService.EVENT_TYPE_DOWNLOADING:
            onDownloading( extras );
            break;
        case ClientDatabaseDroidService.EVENT_TYPE_FINISHED:
            onFinish();
            break;
        case ClientDatabaseDroidService.EVENT_TYPE_ERROR:
            Bundle bundle = new Bundle();
            bundle.putString(   ERROR_MESSAGE,
                                extras.getString( ClientDatabaseDroidService.EXTRA_ERROR_MESSAGE ) );
            onError( bundle );
            break;
        default:
            throw new RuntimeException( "should not happen" );
        }
    }

}

private void unregisterListenerReceiver() {
    if ( receiver != null ) {
        localBroadcastManager.unregisterReceiver( receiver );
        receiver = null;
    }
}

private void onError( Bundle extras ) {
    progressDialog.dismiss();
    showDialog( ERROR_RETRY_DIALOG,
                extras );
}

private void onFinish() {
    progressDialog.dismiss();
    setResult( RESULT_OK );
    finish();
}

@Override
protected Dialog onCreateDialog( final int id, Bundle args ) {
    if ( id == ERROR_RETRY_DIALOG ) {
        Builder builder = new AlertDialog.Builder( this );
        builder.setTitle( R.string.error );
        builder.setMessage( "" );
        builder.setPositiveButton(  R.string.yes,
                                    new OnClickListener() {
                                        @Override
                                        public void onClick( DialogInterface dialog, int which ) {
                                            showProgressDialog();
                                            startService();
                                        }
                                    } );
        builder.setNegativeButton(  R.string.no,
                                    new OnClickListener() {
                                        @Override
                                        public void onClick( DialogInterface dialog, int which ) {
                                            setResult( RESULT_CANCELED );
                                            finish();
                                        }
                                    } );
        return builder.create();
    }

    return super.onCreateDialog(    id,
                                    args );
}

@Override
protected void onPrepareDialog( int id, Dialog dialog, Bundle args ) {
    if ( id == ERROR_RETRY_DIALOG ) {
        ( (AlertDialog) dialog ).setMessage( String.format( "%s\n\n%s",
                                                            args.getString( ERROR_MESSAGE ),
                                                            getString( R.string.do_you_wish_to_retry ) ) );
        return;
    }

    super.onPrepareDialog(  id,
                            dialog );
}

private void onDownloading( Bundle extras ) {
    String currentDatabase = extras.getString( ClientDatabaseDroidService.EXTRA_CURRENT_CLASSIFIER );
    Progress databaseProgress = extras.getParcelable( ClientDatabaseDroidService.EXTRA_DATABASE_PROGRESS );
    Progress downloadProgress = extras.getParcelable( ClientDatabaseDroidService.EXTRA_DOWNLOAD_PROGRESS );
    progressDialog.setIndeterminate( false );
    progressDialog.setMessage( String.format(   "[%d/%d] %s",
                                                databaseProgress.getProcessed(),
                                                databaseProgress.getSize(),
                                                currentDatabase ) );
    progressDialog.setProgress( (int) downloadProgress.getProcessed() );
    progressDialog.setMax( (int) downloadProgress.getSize() );
} 
```

}

主要思想是：

*   活动通过广播与服务通信。以下事件从服务分派到 UI：下载进度（每 x 个字节报告一次）、下载完成、发生错误
*   每个活动开始都被分配一个唯一的作业 ID，该 ID 保留用于屏幕旋转。
*   每个作业结果都被持久化到数据库（或任何其他持久性存储）中。这样，即使收到的广播目前没有收听（屏幕关闭），我也可以获得工作结果。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T23:40:56.203

这很正常。当您离开它们或旋转您的设备时，活动就会消失。然后它们被重新创建。AsyncTasks 不会自动重新链接到新的 Activity 实例。

实际上，[RoboSpice](https://github.com/octo-online/robospice)是您正在寻找的库：它允许您从 Activity 启动下载、旋转设备、离开 Activity，甚至离开应用程序，甚至使用任务切换器杀死它，您的下载将继续存在。任何活动、以前活动的新实例，甚至是完全不同的活动，都可以重新链接到您的下载。

您应该从商店下载应用程序[RoboSpice Motivations](http://goo.gl/pzqH4)，它将向您解释为什么使用 AsyncTasks 进行网络不是一个好主意，并向您展示如何使用 RoboSpice。

要快速了解此问题，请查看[此信息图表](http://goo.gl/jxNin)。

另请注意，如果您只下载二进制数据并且对 POJO 不感兴趣，那么您仍然可以使用 RoboSpice 或[DownloadManager](http://developer.android.com/reference/android/app/DownloadManager.html)（但它的 API 不如 RoboSpice 直观）。

# google-apps-script - 在 Google 协作平台中生成 pdf 缩略图

> ID：13214148
> 
> 赞同：0
> 
> 时间：2012-11-03T22:32:39.167
> 
> 标签：google-apps-script, google-drive-api

是否有可以在 Google 网站中生成 PDF 缩略图的脚本。现在我正在使用 DocList 来获取我的谷歌驱动器中一些 PDF 文件的名称和大小，并将它们列出在谷歌站点上。我想要一个脚本，它也可以生成这些文件的 pdf 缩略图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T07:24:45.567

不，您不能以编程方式获取文件图标。您需要使用图标图像通过 UIService 或 HtmlService 在 UI 中显示它。[您可以在此处](https://sites.google.com/site/collaboratory20/journal/displayingthecontentsofagoogledocscollectionusingthetreeuiwidgetingoogleappsscript)查看 Saqib Ali 的示例。他正在使用 UiService 和 DocList 来显示集合中的项目。

# python - 在列表中分组并重新读取序列

> ID：13214153
> 
> 赞同：5
> 
> 时间：2012-11-03T22:33:19.740
> 
> 标签：python, list

我有一个字符串（例如：BCVDBCVCCBCBD），我已使用

```
seq_split = [string[i:i+1] for i in range (0, len(string),1)] 
```

这导致了一个类似 ['B' ,'C','V'.........,'D'] 的列表

现在考虑我采用数字形式的用户输入（例如 2）。我需要从头开始读取每个第二个元素，即序列的第一个字母和距离第一个字母 2 个位置的字母（计数它将是从头开始的第三个字母）。第二次生病需要阅读序列中的第二个字母，并再次阅读距离 2 个位置的字母。即序列的第2个和第4个字母。（我知道它有点混乱，所以这里有一个详细的解释）

如果用户输入的是数字 2：那么在一个新列表中，我需要在新列表中附加（使用给定的字符串作为示例）- 'BV' 、 'CD' 、 'VB' 等等。

同样，如果输入是 4。那么我创建的新列表将具有 - 'BB'、'CC' 等......我对如何索引它们感到困惑。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-03T22:38:53.973

您可以使用

```
[x + y for x, y in zip(string, string[i:])] 
```

其中`i`是用户选择的数字。例子：

```
>>> string = "BCVDBCVCBCBD"
>>> i = 2
>>> [x + y for x, y in zip(string, string[i:])]
['BV', 'CD', 'VB', 'DC', 'BV', 'CC', 'VB', 'CC', 'BB', 'CD'] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-03T22:39:29.567

```
In [31]: L
Out[31]: ['B', 'C', 'V', 'D', 'B', 'C', 'V', 'C', 'B', 'C', 'B', 'D']

In [32]: sep = 2

In [33]: [L[i]+L[i+sep] for i in range(len(L)-sep)]
Out[33]: ['BV', 'CD', 'VB', 'DC', 'BV', 'CC', 'VB', 'CC', 'BB', 'CD']

In [34]: sep = 4

In [35]: [L[i]+L[i+sep] for i in range(len(L)-sep)]
Out[35]: ['BB', 'CC', 'VV', 'DC', 'BB', 'CC', 'VB', 'CD'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T22:55:11.817

```
#!/usr/bin/python
l = 'BCVDBCVCBCBD'
while True:
    try:
        step = int (raw_input('> '))
    except ValueError:
        import sys
        sys.exit(0);
    print map(
            lambda pos: ''.join(
                (
                    l[pos%len(l)],                                                                                                             
                    l[(pos+step)%len(l)]
                )),
            xrange(0, len(l))
            ) 
```

输出：

```
@delphi# python manglechars.py 
> 2
['BV', 'CD', 'VB', 'DC', 'BV', 'CC', 'VB', 'CC', 'BB', 'CD', 'BB', 'DC']
> 3
['BD', 'CB', 'VC', 'DV', 'BC', 'CB', 'VC', 'CB', 'BD', 'CB', 'BC', 'DV']
> 4
['BB', 'CC', 'VV', 'DC', 'BB', 'CC', 'VB', 'CD', 'BB', 'CC', 'BV', 'DD']
> 
```

# apache - Apache 不会在新的 Xampp 安装上启动：管道已结束。孩子：无法从父母那里读取套接字数据

> ID：13214154
> 
> 赞同：2
> 
> 时间：2012-11-03T22:33:21.223
> 
> 标签：apache, windows-8, xampp, localhost

我刚刚在 Windows 8 上安装了 Xampp 1.8.1。我尝试启动 Apache，它最初变成绿色，然后关闭。我检查了错误日志，但即使在谷歌搜索之后，错误消息对我来说也是希腊语。

这是一个截屏视频： [http://screencast.com/t/VnSsZy6h9Wap](http://screencast.com/t/VnSsZy6h9Wap)

以下是错误消息：

```
[mpm_winnt:notice] [pid 4676:tid 392] AH00455: Apache/2.4.3 (Win32) PHP/5.4.7 configured -- resuming normal operations
[mpm_winnt:notice] [pid 4676:tid 392] AH00456: Server built: Aug 18 2012 12:41:37
[core:notice] [pid 4676:tid 392] AH00094: Command line: 'c:\\xampp\\apache\\bin\\httpd.exe -d C:/xampp/apache'
[mpm_winnt:notice] [pid 4676:tid 392] AH00418: Parent: Created child process 732
[mpm_winnt:crit] [pid 732:tid 392] (OS 109)The pipe has been ended.  : AH00404: Child: Unable to read socket data from parent
[mpm_winnt:crit] [pid 4676:tid 392] AH00427: Parent: child process exited with status 3 -- Aborting. 
```

未安装 Skype。我将 C:\xampp\apache\bin\httpd.exe 添加到 Windows Defender，甚至禁用了 Windows 防火墙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T04:26:11.330

你可以尝试两件事..

一，在不同于现在配置的端口上配置apache（可能是默认80）..

第二件事，您尝试不要将apache安装为服务..如果它作为服务安装，您可以使用它`sc delete [service name]`来删除服务..

# winforms - 当用户拖动面板、标签等时如何移动表单？

> ID：13214156
> 
> 赞同：-1
> 
> 时间：2012-11-03T22:33:39.740
> 
> 标签：winforms, visual-c++, move

当用户拖动面板或标签或我想要的任何项目时，我希望移动整个表单。我如何在 VisualC++ 中做到这一点？我知道在 VB 中这样做，但我正在使用 VisualC++。有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T22:39:17.150

我不知道是否有其他选择，但您可以为 WM_MOUSEDOWN 创建自己的处理程序（不记得确切）。然后你要做的就是计算出点击位置和控制器之间的差异。

此外，为了让它移动，您需要处理 WM_MOUSEMOVE 或其他东西，以使用指针移动表单。

您可以通过简单地使用布尔值来告诉 mousemove 它是否应该对鼠标移动做出反应来做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-16T09:06:33.717

1.  选择主窗体
2.  从**属性窗口**选择**事件**并添加**MouseMove**事件
3.  编码：

    ```
    public int X_cood;
    bool Mouse_Cord_Stored = false;
    int MainForm_Mouse_X_Coordinates;
    int MainForm_Mouse_Y_Coordinates;
    Point p = new Point(ActiveForm.Location.X, ActiveForm.Location.Y);

    private void MainForm_MouseMove(object sender, MouseEventArgs e)
    {
        switch (e.Button)
        {
            case (MouseButtons.Left)://To Let user move the Form1 when Left mouse button is pressed
                {
                    switch (Mouse_Cord_Stored)
                    {
                        case false:
                            {
                                //If Mouse Coordinates are not stored, then store them.
                                MainForm_Mouse_X_Coordinates = e.X;
                                MainForm_Mouse_Y_Coordinates= e.Y;
                                Mouse_Cord_Stored = true;
                                break;
                            }
                        case true:
                            {
                                //Move the Form using ActiveForm.Location if mouse coordinates are stored
                                Form1.ActiveForm.Location = new Point(Form1.ActiveForm.Location.X + e.X - MainForm_Mouse_X_Coordinates
                                                                            , Form1.ActiveForm.Location.Y + e.Y - MainForm_Mouse_Y_Coordinates);
                                break;
                            }
                    }
                    break;
                }

            default:
                {
                    switch (Mouse_Cord_Stored)
                    {
                        case true:
                            {
                                Mouse_Cord_Stored = false;
                                break;
                            }
                    }
                    break;
                }
        } 
    ```

# facebook - SLRequest performRequestWithHandler 在 ios 6 中不起作用

> ID：13214164
> 
> 赞同：1
> 
> 时间：2012-11-03T22:34:38.553
> 
> 标签：facebook, facebook-graph-api, ios6

我正在尝试构建简单的原型，在其中将一些文本发布到我的 Facebook 帐户。我已经阅读了 ios 6 facebook 集成文档并提出了以下代码。一切似乎都工作正常，直到我在方法 postTextToFacebook 中创建 SLRequest 对象并尝试使用处理程序块执行 performRequestWithHandler 的最后一个块。控制永远不会在处理程序块内进行。我假设在这种情况下 performRequestWithHandler 调用不成功。有人成功完成了吗？这是供您参考的代码。

```
#import <Social/Social.h>
#import "ViewController.h"

@implementation ViewController
@synthesize facebookAccount;
@synthesize accountStore;
@synthesize textToPost;

- (void)viewDidLoad
{
    [super viewDidLoad];

}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];

}

-(IBAction) postToFacebook:(id)sender
{
    self.statusLabel.text = @"Logging in ...";
    if(self.accountStore == nil)
    {
        self.accountStore = [[ACAccountStore alloc] init];
    }

    ACAccountType *facebookAccountType = [self.accountStore enter code hereaccountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierFacebook];

    NSMutableDictionary *myOptions = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                    @"172197712918906", ACFacebookAppIdKey,
                                    [NSArray arrayWithObjects:@"email", @"user_about_me", @"user_likes", nil], ACFacebookPermissionsKey, ACFacebookAudienceFriends, ACFacebookAudienceKey, nil];
    [self.accountStore requestAccessToAccountsWithType:facebookAccountType options:myOptions completion:^(BOOL granted, NSError *error){
        __block NSString *statusText;
        if(granted)
        {
            NSArray *accounts = [self.accountStore accountsWithAccountType:facebookAccountType];
            self.facebookAccount = [accounts lastObject];
            [myOptions setObject:[NSArray arrayWithObjects:@"publish_stream", nil] forKey:ACFacebookPermissionsKey];
            [self.accountStore requestAccessToAccountsWithType:facebookAccountType options:myOptions completion:^(BOOL granted, NSError *error) {
                 __block NSString *statusText1;
                if(granted && error == nil)
                {
                    NSArray *accounts = [self.accountStore accountsWithAccountType:facebookAccountType];
                    self.facebookAccount = [accounts lastObject];
                    [self postTextToFacebook];
                    statusText1 = @"Text Posted.";
                }
                else{
                    statusText1 = @"Publish Failed.";
                }

                dispatch_async(dispatch_get_main_queue(), ^{
                    self.statusLabel.text = statusText1;
                });
            }];
        }
        else{
            statusText = @"Login Failed.";
            NSLog(@"Error = %@",error);
        }

    }];

}

-(void) postTextToFacebook
{
    NSDictionary *parameters = @{@"message":self.textToPost.text};
    NSURL *feedURL = [NSURL URLWithString:@"https://graphs.facebook.com/me/feed"];

    SLRequest *request = [SLRequest requestForServiceType:SLServiceTypeFacebook requestMethod:SLRequestMethodPOST URL:feedURL parameters:parameters];

    request.account = self.facebookAccount;

    [request performRequestWithHandler:^(NSData *responseData, NSHTTPURLResponse *urlResponse, NSError *error) {        
        NSLog(@"Facebook request received, status code %d", urlResponse.statusCode);
        NSString *response = [[NSString alloc] initWithData:responseData encoding:NSUTF8StringEncoding];
        NSLog(@"Response data: %@", response);

        //handle errors
        if(error == nil)
        {
            dispatch_async(dispatch_get_main_queue(), ^{
                self.statusLabel.text = @"text posted to facebook";
            });
        }

    }];
}

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T09:52:24.923

你的网址应该是

[https://graph.facebook.com/me/feed](https://graph.facebook.com/me/feed)

代替

[https://graphs.facebook.com/me/feed](https://graphs.facebook.com/me/feed)

我遇到了同样的问题，并且出现了 NSURLErrorDomain -1003 错误。

# django - django 脆皮表格内联表格

> ID：13214166
> 
> 赞同：5
> 
> 时间：2012-11-03T22:34:45.357
> 
> 标签：django, django-forms, django-crispy-forms

我正在尝试采用脆形式和引导程序，并尽可能多地使用它们的功能，而不是一遍又一遍地发明一些东西。

有没有办法像 django-admin 表单那样使用脆的表单/引导程序来实现内联表单功能？

这是一个例子：

```
class NewProjectForm(forms.Form):
    name = forms.CharField(required=True, label=_(u'Название проекта'), widget=forms.TextInput(attrs={'class':'input-block-level'}))
    group = forms.ModelChoiceField(required=False, queryset=Group.objects.all(), label=_(u'Группа проектов'), widget=forms.Select(attrs={'class':'input-block-level'}))
    description = forms.CharField(required=False, label=_(u'Описание проекта'), widget=forms.Textarea(attrs={'class':'input-block-level'}))

    class Meta:
        model = Project
        fields = ('name','description','group')

    def __init__(self, *args, **kwargs):
        self.helper = FormHelper()
        self.helper.form_class = 'horizontal-form'
        self.helper.form_action = 'submit_new_project'
        self.helper.layout = Layout(
            Field('name', css_class='input-block-level'),
            Field('group', css_class='input-block-level'),
            Field('description',css_class='input-block-level'),
        )
        self.helper.add_input(Submit('submit',_(u'Создать проект')))
        self.helper.add_input(Submit('cancel',_(u'Я передумал')))
        super(NewProjectForm, self).__init__(*args, **kwargs) 
```

它将显示一个体面的形式：

![用crispy-forms 渲染的单一表单示例](../Images/d7344a222d2a193681f089e9c8b5f7a3.png)

如何添加一个基本上代表此模型的表单：

```
class Link(models.Model):
    name = models.CharField(max_length=255, blank=False, null=False, verbose_name=_(u'Название'))
    url = models.URLField(blank=False, null=False, verbose_name=_(u'Ссылка'))
    project = models.ForeignKey('Project') 
```

所以会有一个项目和名称/url链接以及添加许多的方法，就像在 django-admin 中完成的一样，您可以添加与您的主模型相关的数据的额外“行”。在下面的截图中，您可以填写“问题”对象的数据，在下方您可以为 QuestionOption 对象添加数据 - 您可以单击“+”图标添加任意数量的 QuestionOptions。

我不是在寻找一种方法来从模型中自动生成表单（这很好但不是最重要的） - 有没有一种方法可以构建一个表单，让你像 django-admin 一样添加“行”数据?

![django-admin 的截图](../Images/c841b9a8b55591cda8bd8c8f52f5e6a6.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T11:02:18.963

您所指的内联表单在 Django 中称为 Formsets。如果您想了解更多关于表单集的信息，可以在[Django 表单文档](https://docs.djangoproject.com/en/dev/topics/forms/formsets/)中找到它们。

Crispy 支持渲染内联表单集，如[“渲染表单集”部分所述](http://django-crispy-forms.readthedocs.org/en/d-0/tags.html#rendering-formsets)

请注意，默认情况下，表单集显示 3 个额外的内联表单，允许您再添加三个对象。保存后，您将再次获得三个额外的内联表单集以添加更多内容。

如果您想要像 Django Admin 中的“添加更多”按钮，您将需要使用一些 Javascript 来动态添加这些行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T22:58:06.107

If using class based views, you can use [django-extra-views](https://github.com/AndrewIngram/django-extra-views).

# c# - 端口是否自动从 SQL Server 收集？

> ID：13214174
> 
> 赞同：2
> 
> 时间：2012-11-03T22:36:05.727
> 
> 标签：c#, sql, sql-server, port, sqlclient

我注意到，如果在构建连接字符串时不提供端口，我仍然可以通过类似于 [SERVER][INSTANCE_NAME] 的命名实例连接到 SQL Server。

sqlclient 会自动为我收集端口号吗？即使实例是默认实例，我是否必须关心端口号？

如果这个问题看起来很新手，我很抱歉。谷歌只是没有为我提供任何东西。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T06:57:26.270

但要记住的一件事是，如果您在同一台计算机上安装了多个 SQL Server 实例，则每个实例将使用不同的随机端口号（尽管可以使用 SQL Server 配置管理器指定特定的端口号，右键单击服务并选择属性）。

如果您通过实例名称进行连接，并且 SQL Server Browser 服务正在运行，它将自动将所有请求重定向到适当的端口。

要记住的另一件事是 SQL Server 的 Express Edition（即免费版本）默认情况下不启用 TCP/IP 协议。我知道这是旧版本 SQL Server 的行为，但在新版本中可能已经改变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T23:57:07.070

好吧，通常 SQL Server 侦听的默认端口是 1433，因此您不需要在连接字符串中指定端口号。

有一篇不错的文章提供了有关该主题的更多信息：

[http://benchmarkitconsulting.com/colin-stasiuk/2009/02/02/what-tcp-port-is-sql-server-running-under/](http://benchmarkitconsulting.com/colin-stasiuk/2009/02/02/what-tcp-port-is-sql-server-running-under/)

# c# - Lucene.net 和 NHibernate 搜索并发问题

> ID：13214177
> 
> 赞同：1
> 
> 时间：2012-11-03T22:36:38.310
> 
> 标签：c#, nhibernate, concurrency, lucene.net, nhibernate-search

我有一个使用 Lucene.Net 和 NHibernate.Search 作为全文搜索引擎的 Web 应用程序。NHibernate.Search 的设置使得每当数据库中发生更改时，它都会传播到 Lucene 索引。

Web 应用程序使用 4 个工作进程运行。首先，这是一个问题吗？我注意到 Lucene 索引不是 100% 与数据库同步。对数据库的某些更改未出现在 Lucene 索引中。但是，当我手动尝试重新索引数据时，效果很好。

在多进程环境中使用 Lucene.Net 是否有任何并发​​影响？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-04T09:51:36.173

这听起来像是一个打开的 IndexWriter 锁定索引目录的问题。一个工作进程将锁定其他进程的索引。

只要每个索引只有一个写入器，Lucene.Net 就可以在多进程环境中使用。不同的目录实现以不同的方式强制执行此操作，通常涉及名为`write.lock`.

一个常见的解决方案是有一个单独的搜索过程来处理索引和搜索。

# java - 如何在 Java 和 Eclipse 中使用包？

> ID：13214178
> 
> 赞同：1
> 
> 时间：2012-11-03T22:36:40.807
> 
> 标签：java, eclipse, packages

我从这里的 repo 将包 tcpcommclient 和 tcpcommserver 导入[到](https://github.com/roman10/roman10-android-tutorial)我的 Eclipse 中。我创建了一个名为 Ygen 的新项目。然后我想使用包：它们的对象、方法等，但它没有在我的 Eclipse 环境中实现包，如下所示，为什么？

![在此处输入图像描述](../Images/e28e17c1985cf207e3bce04da6266235.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T22:38:20.277

Are they added to `Build Path`?

# amazon-web-services - Amazon VOD 拆箱目录架构

> ID：13214179
> 
> 赞同：3
> 
> 时间：2012-11-03T22:36:59.897
> 
> 标签：amazon-web-services, amazon

我正在尝试为亚马逊拆箱目录 XML 文件查找架构定义。具体来说，我正在寻找一个能向我展示他们使用的所有可能类型标签的来源。有谁碰巧知道这些东西记录在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T15:13:06.903

我怀疑亚马逊是否公开了有限的流派标签列表。我建议找到最常见的 50 个左右，然后在您的程序中允许动态创建新的。亚马逊的目录有多种语言，因此它们可能允许任意命名的流派。

# ios - NSObject 子类的最佳数据持久性

> ID：13214181
> 
> 赞同：0
> 
> 时间：2012-11-03T22:37:17.810
> 
> 标签：ios, core-data

我对 iOS 开发相当陌生，所以我需要一些建议。

我正在做一个项目（为即将推出的桌面 RPG 创建角色表应用程序），我似乎已经把车放在了马前。

我已经创建了一个名为 characterClass 的 NSObject 子类，它包含我需要的单个字符表实例的所有内容。它还具有计算派生信息的方法。我还有 2 个存储能力的类，并将它们放在 characterClass 的 NSArrays 中。现在它正在工作，我需要处理数据持久性以及存储/检索多个字符。

我正在考虑使用 Core Data，创建一个与我的 characterClass 匹配的单独实体，并使用一个 characterClass init 方法从 Core Data 中提取数据并将其放入 characterClass 的当前实例中。这对我来说似乎有点迟钝，（实现一个与实体分开的类）但也许这是一个很好的方法。

我最终想为此信息设置保管箱同步，所以无论我做什么，我都希望与之兼容。（以 XML 文件为后端的核心数据？）

对于这样的事情，最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T00:06:11.400

与其只是从 Core Data 中提取数据并使用它来创建您的角色类，您还可以调整您的角色类，使其成为 NSManagedObject 子类。这样您就可以将对象直接存储在 Core Data 中

# symfony - TWIG 如何在 if 语句中回避实体上的未定义属性

> ID：13214186
> 
> 赞同：0
> 
> 时间：2012-11-03T22:37:56.160
> 
> 标签：symfony, logic, twig

所以我一直在努力解决这个问题。

在 PHP 中，首先说出 isset($var) 和 $var == 就足够了，它不会抱怨我试图比较不存在的东西。

显然，在 TWIG 中这还不够。

现在，为什么这不起作用？我首先运行 if 来检查 entity.container 是否已设置，如果没有，请不要通过该块。

看来 TWIG 无论如何都必须遍历所有代码。所以，我有这个实体并不总是有一个容器（entity.container）集，那么我应该怎么做呢？因为当我运行此代码时，TWIG 只是抱怨我有一个 if 语句，当 entity.container 不存在时，我尝试去 entitiy.container.containerType 。

```
{% if entity.container is defined %}
    {% if entity.trash == false and entity.container.containerType.name =='Module' %}
        <form action="{{ path('deleteContent', { 'id': entity.id }) }}" method="post" onsubmit="return confirm('Bekräfta att du vill radera detta innehåll? Detta går inte att ångra.')">
            {{ form_widget(delete_form) }}
            <button type="submit" style="color:red;">Radera permanent</button>
        </form>
    {% elseif entity.trash == false and entity.container.containerType.name !='Module' %}
        <form action="{{ path('deleteContent', { 'id': entity.id }) }}" method="post">
            {{ form_widget(delete_form) }}
            <button type="submit" style="color:red;">Flytta till papperskorgen</button>
        </form>
    {% elseif entity.trash == true and entity.container != null %}
        <form action="{{ path('restoreContent', { 'id': entity.id }) }}" method="post">
            {{ form_widget(delete_form) }}
            <button type="submit" style="color:red;">Återställ till ursprunglig plats</button>
        </form>
    {% else %}
        För att återställa detta innehåll måste du först välja en plats för det.
    {% endif %}
{% else %}
hehe
{% endif %} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T23:56:13.763

我认为在您的情况下， entity.container[已定义](http://twig.sensiolabs.org/doc/tests/defined.html)但未设置，可能为空。[已定义变量与空变量或空](http://twig.sensiolabs.org/doc/tests/null.html)变量之间存在差异。

所以第一个 if 语句被检查并允许解析里面的逻辑。

要检查是否设置了变量，您必须使用

```
{% if entity.container %} 
```

或者干脆使用“不为空”，

```
{% if entity.container is not null %} 
```

两者都具有应定义变量的条件，否则您将收到错误“Item or Object”container.whateverYouWant” for “entity” does not exist ...”

# php - 通过 sendmail 跟踪按钮

> ID：13214188
> 
> 赞同：0
> 
> 时间：2012-11-03T22:38:06.963
> 
> 标签：php, sendmail, user-tracking

我需要跟踪一个将用户重定向到另一个网站的按钮，就像 pinterest 一样。如果有人单击图像，它会以更大的尺寸打开图像，并带有一个按钮，如果您单击它，它将重定向到原始站点，例如 pinterest。

作为解决它的一种方法，我创建了一个 sendmail 功能，以便在用户每次单击按钮时向我发送一封电子邮件。代码是这样的：

```
<div class="buy">
<a onclick="target='_blank'" href="<?php echo $this->pin['from'];?>">

<?php
$message = "Item buy: ";
$link = $this->pin['from'];
mail('xxx@mail.com', '@Buy', $message.$link);
?> 
<img src="http://example.com/data/images/buy.jpg" alt="buy"   />                            
            </a>
            </div> 
```

问题是每次有人点击图片时它都会发送一封电子邮件，我只需要跟踪每次有人点击按钮“buy.jpg”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T22:40:11.937

PHP 在服务器上执行，因此每次有人加载该页面时 send-mail 都会向您发送一封电子邮件，而不是当有人单击您的按钮时。

您应该将 PHP 页面与**[AJAX 请求](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest)**链接，如果您只需要该电子邮件，则每次单击该图像时都会触发该请求。

# c# - 将TextBlock的文本设置为字符串加绑定项？

> ID：13214194
> 
> 赞同：3
> 
> 时间：2012-11-03T22:38:36.327
> 
> 标签：c#, listview, binding

我有一个`ListView`与多个`TextBlock`s 。有可能有这样的东西吗？

```
TextBlock x:Name="AuthorInfo" Text="Author: {Binding data.author}" 
```

还是在设置时将其添加到 data.author 会更好吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T22:43:58.187

如果是 XAML，您可以使用 StringFormat

```
<TextBox Text="{Binding Path=data.author, StringFormat=Author: {0}}"/> 
```

# timer - Linux内核中的hrtimer重复任务

> ID：13214197
> 
> 赞同：8
> 
> 时间：2012-11-03T22:38:46.340
> 
> 标签：timer, callback, linux-kernel

我的目标是使用`hrtimer`struct 在 linux 内核中创建一个循环任务。我希望它每 500 毫秒重复一次。

但是，我`hrtimer`对 linux 内核中的工作方式有点困惑（请参阅 参考资料`linux/hrtimer.h`）。我知道指定了时间，回调应该返回`HRTIMER_RESTART`or `HRTIMER_NORESTART`。我在网上找到了一些资源，指出需要使用该`hrtimer_forward`方法在回调中重置计时器。但是，我看到的消息来源对于如何添加时间有点不清楚。这是我到目前为止的代码：

```
static struct hrtimer timer;

static enum hrtimer_restart timer_callback(struct hrtimer *timer)
{
    printk(KERN_ERR "Callback\n");
    //I know something needs to go here to reset the timer
    return HRTIMER_RESTART;
}

static int init_timer(void)
{   
    ktime_t ktime;
    unsigned long delay_in_ms = 500L;
    printk(KERN_ERR "Timer being set up\n");

    ktime = ktime_set(0,delay_in_ms*1E6L);
    hrtimer_init(&timer, CLOCK_MONOTONIC, HRTIMER_MODE_REL);

    timer.function = &timer_callback;
    printk(KERN_ERR "Timer starting to fire\n");
    printk(KERN_ERR "in %ldms %ld\n", delay_in_ms, jiffies);

    hrtimer_start(&timer, ktime, HRTIMER_MODE_REL);
    return 0;
}

static void clean_load_balancing_timer(void)
{
    int cancelled = hrtimer_cancel(&timer);

    if (cancelled)
        printk(KERN_ERR "Timer still running\n");
    else
        printk(KERN_ERR "Timer cancelled\n");
} 
```

有人可以准确解释在回调函数中重置计时器是如何工作的吗？谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-04T00:31:38.310

如果您在函数 sched_rt_period_timer 的第 170 行附近查看 kernel/sched.c，您将看到一个示例用法。基本线路是

```
now = hrtimer_cb_get_time(timer);                               
overrun = hrtimer_forward(timer, now, rt_b->rt_period); 
```

现在获取计时器的当前时间作为 ktime_t 和 rt_b->rt_period 是另一个 ktime_t 指定提前计时器的周期。hrtimer的过期时间会按周期不断递增，直到大于当前时间。如果需要多于一个时间段相加才能使过期时间大于当前时间，则返回值将大于 1（表示更多超限）。如果计时器到期根本没有提前，它可以为零。

参考： http: [//lwn.net/Articles/167897/](http://lwn.net/Articles/167897/)

它使用的 API 来自不同版本的内核，因此一些参数已经改变。基本思想还是一样的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-28T10:53:24.303

下面是简单的解决方案，

```
#include <linux/slab.h>
#include <linux/time.h>
#include <asm/string.h>
#include <linux/kernel.h>
#include <linux/module.h>
#include <linux/hrtimer.h>
#include <linux/ktime.h>

#define NSEC_PER_MSEC   1000000L

static struct hrtimer hr_timer;

enum hrtimer_restart enHRTimer=HRTIMER_NORESTART;
s64 i64TimeInNsec = 500 * NSEC_PER_MSEC;

enum hrtimer_restart my_hrtimer_callback( struct hrtimer *timer )
{
    hrtimer_forward(timer,hrtimer_cb_get_time(timer),ktime_set(0,i64TimeInNsec));   
    return enHRTimer;
}

void hrtimer_event_init_module(void)
{ 
    ktime_t kt;

        enHRTimer = HRTIMER_RESTART;

    //HRT init  
    kt = ktime_set(0, i64TimeInNsec);
    hrtimer_init( &hr_timer, CLOCK_REALTIME, HRTIMER_MODE_ABS);
    hrtimer_set_expires(&hr_timer, kt);
    hr_timer.function = &my_hrtimer_callback;
    hrtimer_start( &hr_timer, kt, HRTIMER_MODE_ABS);
}

void hrtimer_event_cleanup_module( void )
{
    //Reset
        hrtimer_cancel(&hr_timer);
                enHRTimer = HRTIMER_NORESTART;
        printk("HR-Timer module uninstalized\n");
} 
```

# java - 使用二叉树，我想按连续顺序添加下一个节点，但是我的算法不太有效

> ID：13214207
> 
> 赞同：3
> 
> 时间：2012-11-03T22:39:22.843
> 
> 标签：java, binary-tree

例如，如果我有

```
 A
 / \
 B  C
/  
D 
```

我希望下一个补充是：

```
 A
 / \
 B  C
/ \ 
D  E 
```

但是我在检测下一个要输入的项目的位置时遇到了很多麻烦。我有以下代码：

```
 public static BinaryTree<String> addToTree(BinaryTree<String> tree, String name) {
        if (tree.getLeft() == null) {
            BinaryTree<String> newTree = new BinaryTree<String>();
            newTree.makeRoot(name);
            tree.attachLeft(newTree);
        }
        else if (tree.getRight() == null) {
            BinaryTree<String> newTree = new BinaryTree<String>();
            newTree.makeRoot(name);
            tree.attachRight(newTree);
        }
        // Both are non-null
        else {
            if (tree.getLeft().getLeft() == null || tree.getLeft().getRight() == null) {
                tree.attachLeft(addToTree(tree.getLeft(), name));
            }
            else if (tree.getRight().getLeft() == null || tree.getRight().getRight() == null) {
                tree.attachRight(addToTree(tree.getRight(), name));
            }
        }

        return tree;
    } 
```

但它只适用于最多三层树。如果我尝试添加第四个，它不再添加任何内容。

我该如何实现它，以便它找出下一个项目为空的位置，然后将其添加到那里？

我也想过有一个`checkNullity()`方法，我会拿一棵树，检查它的孩子是否为空，但我也很难弄清楚如何得到孩子的孩子。我想找到它为空的位置，然后将其添加到那里。

谁能提供一些意见？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T23:06:30.747

我认为您可以修改[广度优先遍历](http://en.wikipedia.org/wiki/Tree_traversal)来完成此操作。当您从队列中弹出项目时，检查是否有任何子项为空。第一个空子槽是您要添加的位置。

```
addNode(root, newNode) 
  q = empty queue
  q.enqueue(root)
  while not q.empty do
    node := q.dequeue()
    if node.left == null
      //create new node as nodes left child
      return
    q.enqueue(node.left)
    if node.right == null
      //create new node as nodes right child
      return
    q.enqueue(node.right) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T23:10:08.187

您可以枚举所有节点，同时将它们添加到树中。如果要将`n`第 -th 节点添加到树中，它将是`n/2`第 -th 节点的子节点：left if`n%2 == 0`和 right if `n%2 == 1`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T23:30:00.283

因为，您希望按从左到右的顺序插入元素，并从同一级别开始。我建议您查看呼吸优先搜索。我提供了一个基本的实现。

```
public void insert(child, root){

    if (root == null){
        root = child
    }

    Node iter = root
    Myqueue q = new Myqueue(); //Implementation of the Java Queue Interface

    while (iter!=null){

        //Check: If the left node exists, enque in the que
        if(iter.is_left()){
            q.insert(iter.left)
        }
        else{
            iter.left = child
            iter = null
        }

        //Similary for the right
        if(iter.is_right()){
            q.insert(iter.right)
        }
        else{
            iter.right = child
            iter = null
        }
        if (iter != null){
        iter = q.poll() //Retreiving the head of the queue
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T23:34:05.243

这肯定会创建您要求的树，尽管我仍然不确定它是否是您想要的：

```
public class BinaryTree<T> {
  T root = null;
  BinaryTree<T> left = null;
  BinaryTree<T> right = null;

  public BinaryTree<T> getLeft() {
    return left;
  }

  public BinaryTree<T> getRight() {
    return right;
  }

  public void makeRoot(T root) {
    this.root = root;
  }

  public void attachLeft(BinaryTree<T> tree) {
    left = tree;
  }

  public void attachRight(BinaryTree<T> tree) {
    right = tree;
  }

  public static BinaryTree<String> addToTree(BinaryTree<String> tree, String name) {
    if (tree.getLeft() == null) {
      BinaryTree<String> newTree = new BinaryTree<String>();
      newTree.makeRoot(name);
      tree.attachLeft(newTree);
    } else if (tree.getRight() == null) {
      BinaryTree<String> newTree = new BinaryTree<String>();
      newTree.makeRoot(name);
      tree.attachRight(newTree);
    } else {
      addToTree(tree.getLeft(), name);
    }
    return tree;
  }

  public static void main(String[] args) {

    try {
      BinaryTree<String> tree = new BinaryTree<String>();
      String add = "ABCDEFG";
      tree.makeRoot(add.substring(0, 1));
      for (int i = 1; i < add.length(); i++) {
        addToTree(tree, add.substring(i, i + 1));
      }
      System.out.println("Done");
    } catch (Throwable e) {
      e.printStackTrace();
    }
  }
} 
```

**添加**

我显然误解了这个问题。也许一个例子会有所帮助。

如果我从以下字符串中一次添加一个字符（作为字符串），您会期望什么？

“ABCDEFG”

```
 A
 / \
 B   C
/ \  | \
D  E F  G? 
```

或者是其他东西。

然后你会期待什么

“ADEFGBC”

```
 A
 / \
 D   E
/ \  | \
F  G B  C 
```

或者

```
 A
 / \
 B   C
/ \  | \
D  E F  G 
```

或者是其他东西？

两者都是可能的，但在任何一种情况下我都看不到任何价值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-04T15:14:44.590

为了将元素添加到二叉树的适当位置，您必须从每个节点的根开始回答以下问题：*我应该下降到左边还是右边的子树？*这就是您的问题归结为 - 如何在每个节点上做出此决定。

你开始就OK了。如果节点没有左子树，那么新添加的叶子应该是它的左孩子。如果节点有左子树但没有右子树，那么新添加的叶子应该是它的右孩子。

但是如何判断节点是否有两个子树呢？为此，您需要在可用于决定的节点上保留某种信息。一种可能性是在每个节点上保持其子树的总大小。然后，如果两个子树的大小相同，则意味着两者都是完美平衡的，因此您将其添加到左侧。否则，如果左子树的大小为*2^n-1*，则意味着它是平衡的（而右子树不是），因此您添加到右侧。如果没有，请添加到左侧。

* * *

但是，**您可以做的比这简单得多**。由于您的树始终保持这种结构，因此您可以将树表示为`ArrayList`. 根节点位于索引*0*处，对于索引*n*处的节点，其子节点位于索引 _2*n+1_ 和 _2*n+2_ 处。这就是[二进制堆的实现方式](https://en.wikipedia.org/wiki/Binary_heap#Heap_implementation)。这样，您将获得*O(1)*添加新节点的时间复杂度 - 只需将其附加到列表的末尾即可。（但是，如果您需要一些经典的树操作，例如旋转，则此实现将不起作用。）

# java - 我应该对生成的 Java 代码进行单元测试吗？

> ID：13214209
> 
> 赞同：2
> 
> 时间：2012-11-03T22:39:29.907
> 
> 标签：java, spring, junit, spring-data

简单的问题。如果我使用 spring-data 为我的 DAO 层生成 CRUD 方法，我还应该针对生成的方法编写单元测试吗？或者这相当于单元测试库代码？

提前致谢。

*编辑：为了澄清，我问除了*在发布之前运行的一套集成测试之外，是否需要编写单元测试。例如， DAO 层的 findAll() 方法的[单元测试](https://en.wikipedia.org/wiki/Unit_test)将类似于以下内容：

```
class DepartmentDAOTest extends spock.lang.Specification {
   /* ... */
   def "returns all departments"() {
       setup:
       def result = new List<Department>()
       when:
       result = dao.findAll()
       then:
       result.size() == EXPECTED_SIZE
   }
} 
```

而[集成测试](https://en.wikipedia.org/wiki/Integration_test)可能由测试团队或开发人员手动运行，可能在标记新版本之前。这可以使用[JWebUnit](http://jwebunit.sourceforge.net/)或[Geb](http://www.gebish.org/)自动化，并测试每个组件（包括平台）以确保它们在“集成”时按预期工作。

如果我要使用 JdbcTemplate 手动编写 DAO 实现，那么毫无疑问我应该对每个方法进行单元测试。当我对服务层（调用 DAO 层）进行单元测试时，我可以模拟 DAO 层，因此我不会对其进行两次测试。

如果我调用 pdfbox 之类的第三方库来生成 PDF，那么每种方法都可以正常工作（因为它是作为 pdfbox 项目的一部分进行测试的）。我没有测试他们的 drawSquare 方法是否真的画了一个正方形，但是在集成测试期间，我会看到我的导出 PDF 功能正确地以我们想要的方式导出 PDF。

所以这个问题真的应该改写为“我应该在哪个测试阶段测试我对 spring-data 的使用？”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T22:40:59.777

不。作为一般规则，不要测试平台。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-04T07:31:53.260

首先，根本没有生成代码。我们根据您声明的查询方法构建了一个查询元模型，并动态执行这些查询。简短的回答是：您绝对应该测试声明的这些方法。原因很简单：查询方法声明——无论它们使用派生查询还是手动声明的查询——与您为实体定义的映射元数据交互。因此，检查查询方法的执行以确保您看到预期的结果绝对是合理的。这当然更多的是集成测试和对执行查询的语义检查，而不是经典的单元测试。

# jquery - jQuery 和 Chrome HTTP 请求之间的区别

> ID：13214211
> 
> 赞同：1
> 
> 时间：2012-11-03T22:39:35.953
> 
> 标签：jquery, ajax, http, embed, content-type

我正在编写一个脚本，该脚本将简单的命令发布到嵌入在设备上的 Web 服务器。我不确定服务器到底是什么（我相信嵌入式 Linux 上的某种 Apache 风格），这对于我的要求无关紧要。

`$.ajax()`服务器上的代码对 jQuery函数发送的 URL 和 Chrome 发送的完全相同的 URL 的反应不同。我试图找到一种方法来弄清楚 Chrome 对这个请求做了什么，jQuery 不是为了让我的 javascript 工作。

细节：

当我发布到设备以向其发送命令时，我会这样做：

```
$.ajax({
    type: "GET",
    url: urlPrefix+'/setsetting/'+name+'='+value,
    success: function(r) {
        //command was sent
    },
    error: function(e) {
            //some http error
    }
}); 
```

当我发出一个值不包含空格的请求时，服务器会正​​常工作。但是，当我发出一个值包含空格的请求时，服务器不会完成它的工作。因此，服务器上的代码如何处理 URL 中的空格显然存在问题，对吧？奇怪的是：当我将使用此代码构建的 URL 直接放入浏览器窗口时，即使值中有空格，服务器也会执行其工作。所以这个 URL 从我的脚本发送：

```
http://[ip]/setsetting/setting1=value 1 
```

不起作用，但如果我将相同的网址插入我的浏览器（Chrome），它确实有效。Chrome 会将空格更改为`%20`. 我尝试格式化代码中的值以替换无用的空格`%20`。我尝试将 contentType 属性添加`$.ajax()`到其他事物中，但这些都没有帮助。

编辑：我刚刚注意到 $.ajax() 的错误函数正在触发。e.responseText 是一个显示“400 - 错误请求”的 html 页面。嗯？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T22:46:02.933

只使用 encodeURIComponent 函数怎么样？它会自动将所有特殊符号转换为 url 友好格式。

encodeURI(url) 用于整个 url，encodeURIComponent 用于编写 url "http://example/?someValue=" + encodeURIComponent(someValue)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-03T22:47:12.377

Try this:

```
$.ajax({
    type: "GET",
    url: urlPrefix+'/setsetting/?'+name+'='+value, //Note the use of '?'
    data: 
    success: function(r) {
        //command was sent
    },
    error: function(e) {
            //some http error
    }
}); 
```

Here we use the `?` to better delimitate where your query strings parameters begin.

# ios - ios 音频单元 kAUVoiceIOProperty_DuckNonVoiceAudio 错误 -10879

> ID：13214223
> 
> 赞同：1
> 
> 时间：2012-11-03T22:40:58.153
> 
> 标签：ios, audio, audio-streaming, audiounit

我使用 Novocaine 框架[https://github.com/alexbw/novocaine](https://github.com/alexbw/novocaine)，如果我从麦克风暂停输入单元（但输出正在工作），然后再次播放，结果我得到回声。在苹果文档中，我看到了语音处理 I/O 音频单元属性 - kAUVoiceIOProperty_DuckNonVoiceAudio。我尝试：

```
UInt32 zero = 0;
CheckError( AudioUnitSetProperty(inputUnit,
                                 kAUVoiceIOProperty_DuckNonVoiceAudio,
                                 kAudioUnitScope_Global,
                                 kInputBus,
                                 &zero,
                                 sizeof(UInt32)), "ERROR"); 
```

在方法 setupAudio
结果我有

```
ERROR (-10879) 
```

在文档中我没有找到描述。一般来说，如何在 iOS 中为 audioUnits 实现回声消除？我认为问题可能不在此属性中（因为默认情况下应该启用它）.. 我发现这篇很棒的文章 - [http://atastypixel.com/blog/developing-loopy-part-2-implementation/](http://atastypixel.com/blog/developing-loopy-part-2-implementation/)作者说的是相关信号和他们的减法..在这种情况下，我认为我需要自适应滤波器，但如果可以为 iOS 实现？

有任何想法吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T12:42:16.557

我找到了为什么会发生此错误的答案：在 Novocaine AudioComponentDescription init 中：

```
inputDescription.componentSubType = kAudioUnitSubType_RemoteIO; 
```

但在我的情况下是正确的：

```
inputDescription.componentSubType = kAudioUnitSubType_VoiceProcessingIO; 
```

经过一些实验，我得出结论，在使用 kAudioUnitSubType_VoiceProcessingIO echo disable 但不完全之后。可能是我没有正确使用它。

# jquery - Jquery Mobile：带有背景图像+导航栏的自定义标题

> ID：13214228
> 
> 赞同：4
> 
> 时间：2012-11-03T22:41:39.933
> 
> 标签：jquery, css, jquery-mobile, header, navbar

一整天都在为此苦苦挣扎，我觉得有人对这个主题有更多的了解可以为我省去很多悲伤......

我使用 Jquery Mobile 创建了一个网站，我想在我的所有页面上使用自定义图像/徽标而不是标准标题。让它稍微复杂一点的是，我还在自定义标题/图像下方使用导航栏进行导航。请参阅下图了解我在说什么：

[http://postimage.org/image/ywh1wajjr/](http://postimage.org/image/ywh1wajjr/)

所以这就是我遇到问题的地方......自定义图像/标题的缩放让我做噩梦。在某个分辨率下（例如 Dreamweaver 中的 480x800 预设），一切看起来都很好。但是，当分辨率增加时，我开始遇到问题：

首先，图像高度不断变大，使整体标题（图像和导航栏）比我想要的大很多。其次，如果您使用的分辨率非常高，超过了图像的总宽度，则图像会停在其最大宽度处，而导航栏（和页面的其余部分）会继续扩展至 100% 的宽度页面 - 这显然看起来很奇怪。

我正在使用以下文件/设置：

jquery-1.8.2.min.js、jquery.mobile.structure-1.2.0.css、jquery.mobile.theme-1.2.0.css、jquery-1.8.2.min.js、jquery.mobile-1.2。 0.js 和 Dreamweaver cs6。

我已经尝试了对上述文件中的 CSS 以及页面中的 html 的一百万种不同的变体，但没有成功。我有一种感觉，它将涉及媒体查询，具有 3 或 4 个不同版本的图像，但尽管我尽了最大努力，但我还没有找到最好的方法。

我的理想场景 - 链接的背景图像 + 导航栏组合（或类似的东西）在纵向和横向模式下在所有流行的移动设备上都能很好地工作。

任何意见，将不胜感激...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T14:20:36.893

它不是 100%，但希望它能让您了解 CSS 可以做什么，只使用徽标图像而不是背景：

![在此处输入图像描述](../Images/9b4d01faca7a9a69ecb8d18513df0465.png)

然后使用 CSS 制作顶层和底层

例子：

*   [http://jsfiddle.net/PMhXe/](http://jsfiddle.net/PMhXe/)

CSS：

```
.bgimg {
    background-image: url(http://dummyimage.com/5x5/a80c10/ffffff.png), url(http://dummyimage.com/5x5/a80c10/ffffff.png);
    background-repeat:repeat-x;
    background-position:100% 120px, 100% -120px;
    background-size:100% 180px;
}
.logo-font {
    font-size:x-large;
    font-weight:bold;
} 
```

HTML：

```
<div data-role="page" class="type-home">
    <div data-role="header" class="bgimg">
        <h1><img src="http://www.albionroad.com/images/stories/logos/manchester-united-logo-1.png" alt="logo" /><br /><div class="logo-font">MANCHESTER UNITED<br />&lt;&nbsp;&middot;&nbsp;&gt;</div></h1> 
        <div data-role="navbar">
            <ul>
                <li><a href="#">One</a></li>
                <li><a href="#">Two</a></li>
                <li><a href="#">Three</a></li>
                <li><a href="#">Four</a></li>
                <li><a href="#">Five</a></li>
            </ul>
        </div><!-- /navbar -->
    </div><!-- /header -->
</div>​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T08:32:27.297

您的 jquery 移动应用程序标题有类似的内容，您的徽标图像将显示在哪里：

```
<div data-id="header" data-position="fixed" data-theme="c" data-role="header" role="banner" class="header-manU ui-header ui-bar-c ui-header-fixed slidedown">
  <h1 class="manU-logo ui-title" role="heading" aria-level="1">
    <a href="#" class="ui-link">
      <img src="css/themes/default/images/logo_header.png">
    </a>
  </h1>
</div> 
```

只需应用此 CSS：

```
.ui-mobile .header-manU a img {
  width: 100%;
 } 
```

希望这可以帮助

# git - 使用 TortoiseGit 将 SVN 存储库克隆到 Git（包含所有修订版）？

> ID：13214229
> 
> 赞同：2
> 
> 时间：2012-11-03T22:42:00.920
> 
> 标签：git, svn, tortoisesvn, clone, tortoisegit

我是 Git 的新手，我从 SVN 实现了飞跃。是否可以使用 TortoiseGit 将所有修订和文件（基本上是整个 repo）从 SVN 克隆到 Git？如果是这样，有人可以指导我现在我可以这样做吗？

感谢您的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T23:37:43.877

正如这个[GitHub 帮助](https://help.github.com/articles/importing-from-subversion)页面中提到的，**[svn2git](https://github.com/nirvdrum/svn2git)**仍然是将 SVN 存储库导入 git 的推荐解决方案。*然后*
你可以使用 TortoiseGit。

 *Svn2Git 用于一次拍摄，[或](https://stackoverflow.com/questions/12402117/how-can-one-integrate-svn-and-git)从 SVN 到 Git 的一种方式转换，如[本问题](https://stackoverflow.com/questions/13013966/how-to-use-svn-dcommit-for-svn-all-fast-export-qt-script)所述。它也可以[在 Windows 上运行](https://stackoverflow.com/questions/10717571/trying-to-get-svn2git-working-on-windows)。*

# c# - 来自实例化类的相同随机数

> ID：13214232
> 
> 赞同：1
> 
> 时间：2012-11-03T22:42:22.337
> 
> 标签：c#, random

我正在学习 C# 并在我的程序中创建了一个包含随机数生成器的类：

```
class RandomNumberGenerator
{
    Random RNG = new Random();
    // A bunch of methods that use random numbers are in here
} 
```

在这个类中有一些使用 RNG 的方法。数据从程序的其他部分发送到这里，经过处理，然后返回。其中一种方法执行以下操作：

```
// Method works something like this
int Value1 = RNG.Next(x, y);
int Value2 = RNG.Next(x, y);
int Value3 = RNG.Next(x, y); 
```

,`x`值`y`将从另一个类发送到这里。因此，我必须`RandomNumberGenerator`在该类中创建一个实例，以便调用它的方法并将 x 和 y 值传递给它。

```
class DoStuff
{
    RandomNumberGenerator Randomizer = new RandomNumberGenerator
    // Here I call a bunch of Randomizer methods that give me values I need
} 
```

上述方法中的问题是，我每次对所有三个值都得到相同的数字。我不确定是不是因为它们靠得很近，而`Randomizer`' 的种子值还没有来得及改变，或者我在创建`RandomNumberGenerator`类的新实例时做错了什么。

我已经在这里找到了一堆答案，通常这样的问题是由于人们`Random`在运行方法时创建了许多新对象（因此将所有这些对象的种子设置为相同的值），但`Random`我唯一的新对象create 在`RandomNumberGenerator`类内。然后我在另一个类中实例化一次，这样我就可以向它传递数据并使用它的方法。

为什么会发生这种情况，我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T22:44:51.737

通常，您应该有一个 的静态实例`Random`，并使用该实例来获取应用程序的所有随机数。`lock`如果要从多个线程中使用它，请确保。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T22:46:36.740

我假设这是`DoStuff`在循环中创建实例。

当调用太快时，多个随机实例将产生相同的种子，从而导致相同的数字。

在 for 循环外声明一次或将其传递给方法。

```
 Random r = new Random();
    for (int i = 0; i < count; i++)
    {
        // use the same random instance
    } 
```

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.random%28v=vs.110%29.aspx)：

> 随机数生成从种子值开始。**如果重复使用相同的种子，则会生成相同的数字序列**。产生不同序列的一种方法是使种子值与时间相关，从而为每个新的 Random 实例产生不同的序列。默认情况下，Random 类的无参构造函数使用系统时钟生成其种子值，而其有参构造函数可以根据当前时间的刻度数取一个 Int32 值。但是，由于时钟的分辨率有限，因此使用无参数构造函数以紧密连续的方式创建不同的 Random 对象会创建生成相同随机数序列的随机数生成器。

# javascript - 如何操作表单输入使用地理位置而不是纯文本

> ID：13214234
> 
> 赞同：1
> 
> 时间：2012-11-03T22:42:24.190
> 
> 标签：javascript, jquery, geolocation, local-storage

我的 Jquery Mobile 页面上有一个表单，用户可以在其中插入起始位置和目的地。

这些值将保存在本地存储中。现在我正在尝试像这样操作输入：

当您在输入框中键入（例如）“当前”时，用户的位置将被放置在本地存储数据库中，而不是“当前”一词。

我已经制作了这个脚本来获取用户的位置：

```
var geocoder;

 if (navigator.geolocation) {
navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
} 
//Get the latitude and the longitude;
function successFunction(position) {
var lat = position.coords.latitude;
var lng = position.coords.longitude;
codeLatLng(lat, lng)
}

function errorFunction(){
alert("Geocoder failed");
}

function initialize() {
geocoder = new google.maps.Geocoder();
 }

function codeLatLng(lat, lng) {

var latlng = new google.maps.LatLng(lat, lng);
geocoder.geocode({'latLng': latlng}, function(results, status) {
    if (status == google.maps.GeocoderStatus.OK) {
    console.log(results)
        if (results[1]) {
        //formatted address
        document.getElementById('formatedAddress').innerHTML = results[0].formatted_address;
        //find country name
            for (var i=0; i<results[0].address_components.length; i++) {
            for (var b=0;b<results[0].address_components[i].types.length;b++) {

                //there are different types that might hold a city admin_area_lvl_1 usually does in come cases looking for sublocality type will be more appropriate
                if (results[0].address_components[i].types[b] == "administrative_area_level_1") {
                //this is the object you are looking for
                city= results[0].address_components[i];
                break;
                }
            }
        }
    }
    }
}
);
} 
```

2个输入字段：

```
<label for="start">Startlocation:</label>
<input type="text" name="start" value="" id="start"/>

<label for="destination">Destination:</label>
<input type="text" name="destination" value="" id="destination"/> 
```

我对 javascript 和 jQuery 非常陌生，我似乎无法找到解决问题的方法。我希望有人能帮助我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T20:49:59.453

```
var start = document.getElementById('start').value;

if (start == 'current') {
    //set lat & long to current
}
else {
    //read lat & long from input fields
} 
```

这一点逻辑可能证明是你所追求的——但我确实倾向于同意[逻辑黑猩猩](https://stackoverflow.com/users/1680345/logical-chimp)的观点，即用户体验非常重要，并且“使用当前位置”按钮可能对用户更有用。

# obfuscation - 在 WordPress 中混淆 URL

> ID：13214235
> 
> 赞同：0
> 
> 时间：2012-11-03T22:42:49.503
> 
> 标签：obfuscation

嗨，我有一个会员网站，作为会员的一部分，用户可以下载一些报告，这些报告都存储在服务器上的特定文件夹中。有没有办法混淆这些报告的 URL，以便用户无法自动下载所有报告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T22:46:58.197

Hash the user's username and include that in the filename of the report that he is downloading.

# java - 在imageView，android中动态更改位图

> ID：13214238
> 
> 赞同：2
> 
> 时间：2012-11-03T22:43:29.183
> 
> 标签：java, android, multithreading, bitmap

全部，

我有一个与 imageView、android 相关的问题。
我有一个包含 10 个位图对象的数组，称为`bm`.
我有一个名为`im`.

现在我想将数组中的位图一张一张地显示在 im 中，所以我做了以下操作：

```
new Thread(new Runnable() {
       public void run() {
         for(int j=0;j<10;j++){
             im.setImageBitmap(bm[j]);
         }
       }
      }).start(); 
```

但结果只显示数组中的最后一个位图。

有人可以告诉我如何处理这个问题吗？

百万感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T22:54:14.737

您需要在设置新图像后插入`sleep`呼叫，以便您的眼睛有机会看到图像:)。就像是：

```
im.setImageBitmap(bm[j]);
try {                             
    Thread.sleep(5000);           
} catch (InterruptedException e) {
    e.printStackTrace();          
} 
```

应该保持图像五秒钟，然后再进行下一张。

像其他人建议的那样，您需要使用`postDelayed`正确通知 UI 您正在设置位图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T22:59:13.810

1.  您应该有例外，因为您只能在 UI 线程中使用视图。如果要对其进行更改，则应在视图上调用[post方法。](http://developer.android.com/reference/android/view/View.html#post%28java.lang.Runnable%29)
2.  实际上，它的变化如此之快，以至于您只看到最后一项。

这是正确的代码：

```
 new Thread(new Runnable() {
        public void run()
        {
            for (int j = 0; j < 10; j++)
            {
                final int index = j;
                im.postDelayed(new Runnable() {

                    @Override
                    public void run()
                    {
                        im.setImageBitmap(bm[index]);
                    }
                }, j * 1000); // delay j seconds
            }
        }
    }).start(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T22:59:45.320

1.  永远不要更改线程中的 UI 元素。大多数情况下，这会导致异常。我不知道为什么它没有在这里。

2.  您只需几毫秒就可以浏览所有十张图像。这就是为什么最后一个是你看到的唯一一个。你需要放慢速度。

3.  最简单的方法是 Handler/Runnable 实现，如下所示：

    ```
    im.post(new Runnable() {   
       int j = 0;      
       @Override   
       public void run() {
          im.setImageBitmap(bm[j]);
          if(j++ < 10){
             im.postDelayed(this, 1000);
          }
       }
    }); 
    ```

# c++ - C++ 构造函数与初始化列表速度比较

> ID：13214241
> 
> 赞同：19
> 
> 时间：2012-11-03T22:44:02.083
> 
> 标签：c++, constructor, initialization-list

构造函数和初始化列表之间的执行时间是否有任何差异？（或者这只是编码偏好的问题）。我有一组需要经常创建的对象，并且想知道使用初始化列表而不是构造函数是否有任何性能提升。

如果我要创建一百万个 A 类实例和另外一百万个 B 类实例，那么哪个选择会更好（对象代表网络中生成的数据包，因此这些数字）。

```
 class A {
   private:
     int a, b;

   public:
     A(int a_var, int b_var):a(a_var), b(b_var) {}; 
 };

 class B {
   private:
     int a, b;

   public:
     B(int a_var, int b_var) {
        a = a_var;
        b = b_var;
     }
}; 
```

如果任何构造函数对于原始类型来说比另一个更快（如示例中所示），如果将 a 和 b 替换为类型会更快吗？

类型示例：

```
 class AType {
   private:
     string a, b;

   public:
     AType(string a_var, string b_var):a(a_var), b(b_var) {}; 
}; 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-03T22:53:15.740

不同之处在于没有琐碎的默认构造函数的类型，编译器会在您的类中为您调用该构造函数`B`。您的课程`B`相当于：

```
 class B {
   private:
     SleepyInt a, b;

   public:
     // takes at least 20s
     B(int a_var, int b_var) : a(), b()
     //                      ^^^^^^^^^^ 
     {
        a = a_var;
        b = b_var;
     }
  }; 
```

如果您没有将成员变量或基类构造函数放在初始化列表中 - 它会为它们调用默认构造函数。`int`是基本类型 - 它的默认构造函数没有任何成本 - 所以在你的示例中没有区别，但对于更复杂的类型，构造函数+赋值可能不仅仅是构造成本。

一些有趣的例子，只是为了说明区别：

```
class SleepyInt {
public:
  SleepyInt () { 
    std::this_thread::sleep_for(std::chrono::milliseconds( 10000 ));  
  }
  SleepyInt (int i) {}
  SleepyInt & operator = (int i) { return *this; }
};

class A {
   private:
     SleepyInt a, b;

   public:
     A(int a_var, int b_var):a(a_var), b(b_var) {}; 
 };

 class B {
   private:
     SleepyInt a, b;

   public:
     // takes at least 20s
     B(int a_var, int b_var) {
        a = a_var;
        b = b_var;
     }
}; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-03T23:29:03.077

在构造函数中使用初始化列表而不是赋值是普遍接受的做法，这是有充分理由的。

初始化列表可用于初始化 POD（普通旧数据）和用户定义类型。初始化 POD 类型时，效果与赋值运算符完全相同，这意味着 POD 类型的构造函数中的初始化列表或赋值之间没有性能差异。

当我们考虑非 POD 类型时，事情会变得更有趣。在调用构造函数之前，先调用父类的构造函数，然后调用任何包含的成员，默认情况下调用无参数构造函数。使用初始化列表，您可以选择调用哪个构造函数。

所以要回答这个问题，存在性能差异，但仅在初始化非 POD 类型时。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-03T22:45:41.750

如果成员的类型或多或少复杂，那么赋值初始化将首先导致默认的构造函数调用，然后调用`operator=`，这可能需要更长的时间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-03T22:48:03.770

如果类型是内置/固有类型，则不会有性能改进。

那说：

> [结论](http://www.parashift.com/c++-faq/init-lists.html)：在所有其他条件相同的情况下，如果您使用初始化列表而不是赋值，您的代码将运行得更快。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-09-02T13:36:54.657

初始化列表是有用的引用类型、成员类对象或 const 成员。否则需要更多时间。

看我的测试代码：

```
#include <iostream>
#include <ctime>

using namespace std;

class A{
    int a;
public:
    A(int a_):a(a_){}
};

class B{
    int b;
public:
    B(){
    }

    B(int b_){
        b=b_;
    }
};

class C{
    B b;
public:
    C(int c_):b(c_){
    }
};

class D{
    B b;
public:
    D(int d_){
        b=d_;
    }
};

int main()
{
    clock_t start1[10], start2[10], end1[10], end2[10];
    for(int j=0;j<10;j++){
        start1[j]=clock();
        for(int i=0;i<100000;i++){   
            A *newA=new A(i);
            delete newA;
        }
        end1[j]=clock();
        start2[j]=clock();
        for(int i=0;i<100000;i++){   
            B *newB=new B(i);
            delete newB;
        }
        end2[j]=clock();
    }
    double avg1=0, avg2=0;
    for(int i=0;i<10;i++){
        avg1+=(end1[i]-start1[i]);
        avg2+=(end2[i]-start2[i]);
    }
    cout << avg1/avg2 << endl;

    for(int j=0;j<10;j++){
        start1[j]=clock();
        for(int i=0;i<100000;i++){   
            C *newC=new C(i);
            delete newC;
        }
        end1[j]=clock();
        start2[j]=clock();
        for(int i=0;i<100000;i++){   
            D *newD=new D(i);
            delete newD;
        }
        end2[j]=clock();
    }
    avg1=avg2=0;
    for(int i=0;i<10;i++){
        avg1+=(end1[i]-start1[i]);
        avg2+=(end2[i]-start2[i]);
    }
    cout << avg1/avg2 << endl;

    system("pause");
    return 0;
} 
```

示例输出如下：

1.02391
0.934741

# castle-windsor - 如何通过代码将 log4net 配置文件传递给 Castle.Facilities.Logging.LoggingFacility.UseLog4Net？

> ID：13214252
> 
> 赞同：0
> 
> 时间：2012-11-03T22:45:21.987
> 
> 标签：castle-windsor, log4net, castle, log4net-configuration

我正在使用来自城堡温莎文档的以下代码。我不知道如何在安装此安装程序的引导程序容器安装程序上传递我的 configFile。

```
 public void Install(IWindsorContainer container, IConfigurationStore store)
    {
        container.AddFacility<LoggingFacility>(f => f.UseLog4Net("NameOfConfigFile"));
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T04:33:07.603

默认情况下，我相信它会在项目的根目录上使用 logging.config。你还需要使用比这更定制的东西吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T14:00:46.413

我能够做到这一点的唯一方法是更新我的安装程序并传入 NameOfConfigFile 并在我的安装程序的构造函数中将私有实例字段设置为此值。

```
_bootStrapContainer = new WindsorContainer().Install(new LoggerInstaller(configPath));
```

# c# - 至少匹配一个字符和一个数字，不分顺序，不带后缀？

> ID：13214255
> 
> 赞同：1
> 
> 时间：2012-11-03T22:45:48.600
> 
> 标签：c#, regex, asp.net-mvc

我需要一个满足此声明的正则表达式：

> **至少有一个字符和一个数字，不分顺序，最后没有后缀（即域名）。**

所以我有这个测试清单：

```
ra182
jas182
ra1z4 
```

我有这个正则表达式：

```
[a-z]+[0-9]+$ 
```

它完全匹配前两个，但它只匹配`z4`最后一个。尽管对我来说为什么它只匹配最后一个条目的那部分是有道理的，但我需要一些帮助才能在剩下的过程中得到这个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T22:50:40.307

您可以使用前瞻检查前两个条件：

```
/^(?=.*[a-z])(?=.*[0-9])/i 
```

...如果第三个几乎没有`.`，那么检查也很简单：

```
/^(?=.*[a-z])(?=.*[0-9])[^.]+$/i 
```

但我可能更喜欢使用三个单独的测试：首先检查符号（你确定只检查范围 - [az] - 而不是 Unicode`Letter`属性就足够了吗？），第二个检查数字，和这个讨厌的点的最后一个，像这样：

```
if (Regex.IsMatch(string, "[a-zA-Z]") 
    && Regex.IsMatch(string, "[0-9]")
    && ! Regex.IsMatch(string, @"\.") ) 
{ 
    // string IS valid, proceed
} 
```

问题中的正则表达式将尝试匹配一个或多个符号，后跟一个或多个数字；对于像`9a`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T23:07:34.127

我建议使用

```
Match match = Regex.Match(str, @"^(?=.*[a-zA-Z])(?=.*\d)(?!.*\.).*"); 
```

或者

```
Match match = Regex.Match(str, @"^(?=.*[a-zA-Z])(?=.*\d)(?!.*[.]).*"); 
```

或者

```
Match match = Regex.Match(str, @"^(?=.*[a-zA-Z])(?=.*\d)[^.]*$"); 
```

或者

```
Match match = Regex.Match(str, @"^(?=.*[a-zA-Z])[^.]*\d[^.]*$"); 
```

* * *

```
if (match.Success) ... 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-03T23:02:57.320

您需要匹配至少有一个字母和一个数字的字母数字字符串？尝试这样的事情：

```
\w*[a-z]\w*[0-9]\w* 
```

这将确保您至少有一个字母和一个数字，字母后面是数字。如果要考虑字母前的数字，只需使用相应的表达式g（字母前的数字）和`|`两者。

# javascript - Do 404 errors impact performance?

> ID：13214259
> 
> 赞同：0
> 
> 时间：2012-11-03T22:46:03.640
> 
> 标签：javascript, nginx

I have a few scripts included in some web pages that no longer exist. People get tons of 404s because the pages are high traffic. I just removed them, but, does it impact performance if I were to leave these in?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T22:54:52.670

They certainly do, as they are unnecessary request/response interactions that can add to page load time.

Yahoo explains it very well in their "[Best Practices for Speeding Up Your Website](http://developer.yahoo.com/performance/rules.html#no404)".

In your particular case, my suggestion is use a tool such as [YSlow](http://developer.yahoo.com/yslow/) or [PageSpeed](https://developers.google.com/speed/pagespeed/) to determine how big is the impact of the 404 responses.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T22:54:06.327

You still have the request/response communication between client and server, even if a 404 is sent back. However, no processing is needed (such as PHP or other server-side languages) so you will recover some of the load but it's still best not to leave the 404 references in there.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-17T01:31:13.697

目前尚不清楚您是在询问断开的链接还是有效的链接，或者您是在询问断开的链接还是根本没有链接。

所以我对所有三种情况都做了一些测试。在我的测试中，我使用了指向图像的链接，因此指向文档的链接可能会给您带来不同的结果。我创建了一个加载 100 个独特图像的测试页面。我用图像加载了五次，用损坏的图像链接加载了五次（创建 404 错误），五次根本没有任何图像标签。每次在加载页面之前，我都会清除缓存以确保这是一场公平的战斗。

有 100 张图片，这些是我的结果：

```
3138 milliseconds
3102 milliseconds
2721 milliseconds
4105 milliseconds
3365 milliseconds 
```

有 100 个损坏的图像链接：

```
1700 milliseconds
1706 milliseconds
1734 milliseconds
1661 milliseconds
1678 milliseconds 
```

完全删除图像标签：

```
10 milliseconds
13 milliseconds
21 milliseconds
12 milliseconds
12 milliseconds 
```

所以一个断开的链接比一个有效的链接快，但它仍然比没有链接慢。如果您不需要它们，则可能值得摆脱它们。

# java - Getting Started with GlassFish

> ID：13214265
> 
> 赞同：5
> 
> 时间：2012-11-03T22:46:28.863
> 
> 标签：java, eclipse, glassfish

This is a question for all you GlassFish users out there, in hopes that this can be a reference for future searches. I'm new to GlassFish, and am looking for a good place to get nice introduction. Can you direct me to some nice references or `Hello World` type of projects?

In my case, I'm using the [GlassFish plugin for Eclipse](http://glassfishplugins.java.net/) and hoping to use GlassFish as a server for some Java projects and would especially like references that pertain to this. I'll accept the first answer that gives a really good example or links to a really good example of this.

Here are some decent references I have found so far:

*   [Example (from Blog Post) Using Enterprise Java Beans](http://edwin.baculsoft.com/2010/09/a-simple-java-client-server-application-using-ejb3-and-glassfish3/)
*   [GlassFish Official Project Site](http://glassfish.java.net/)
*   [GlassFish Wiki](https://wikis.oracle.com/display/GlassFish/GlassFishWiki)
*   [Hello World Eclipse with GlassFish on Code Ranch](http://www.coderanch.com/t/499224/java-EJB-SCBCD/certification/run-Hello-World-example-Eclipse)

I found some fairly nice tutorials from Oracle on YouTube, but they're not quite the simple Hello World I'm looking for:

1.  [Java EE 6 Development using GlassFish and Eclipse](http://www.youtube.com/watch?v=aBjlR9HoR50) - guides you through getting the plugin, initial server setup, and creation of a servelet.
2.  [Building Web Apps with GlassFish and Java EE 6](http://www.youtube.com/watch?v=vuwXxuCjOm0) -

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T23:06:41.787

看看书：

使用 GlassFish 3 开始 Java EE 6

[http://www.amazon.com/Beginning-GlassFish-Experts-Voice-Technology/dp/143022889X](https://rads.stackoverflow.com/amzn/click/com/143022889X)

里面有很多简单的例子。

# matlab - 对于迭代器（循环）

> ID：13214271
> 
> 赞同：0
> 
> 时间：2012-11-03T22:47:27.200
> 
> 标签：matlab, for-loop, simulink

我正在尝试使用 simulink 在角度下模拟球的投掷。我可以模拟一个角度，但我想用循环来模拟它。这就是我想在 simulink 中使用 FOR 做的事情：

`for i=-5:10:85`

这是我的simulink的图片：

![在此处输入图像描述](../Images/34e8bdc21da7b0584605f37af2e12b62.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T04:39:38.697

如果我正确理解了您的问题，那么您基本上希望针对常数 Degrees 的不同值重新运行多次模拟。除了使用 For Iterator 之外，您还可以通过使用向量运算来有效地实现相同的结果。也就是说，将常量 Degrees 的值从标量值改为向量（在这种特殊情况下，只需将其值设置为 [5:10:85]）。Simulink 模型的输出（即 x 和 y 结果）现在应该是对应于各种 Degree 值的向量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T03:27:15.080

将所有模块放入 for-iterator 子系统。For Iterator 模块将输出当前迭代，您可以使用该索引（从 0/1 开始）将角度从 -5 循环到 85（尝试将 For Iterator 模块与 Gain 和 Sum 模块挂钩）。在每次迭代中，for-iterator 子系统中的所有模块都将运行，并且 For Iterator 模块的输出将加一。

先前使角度成为矢量的解决方案也将起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T23:08:45.237

使用 MATLAB 的[参考页面](http://www.mathworks.com.au/help/matlab/ref/for.html)，我将您的行重写为：

```
for i=5:10:85
 ...
end 
```

# iphone - Xcode 4.5 构建错误：格式错误的对象

> ID：13214277
> 
> 赞同：2
> 
> 时间：2012-11-03T22:48:22.087
> 
> 标签：iphone, objective-c, xcode, ipad, build-error

我正在尝试使用 Xcode 4.5.1 构建一个使用 Xcode 4.4 创建的项目，但出现以下错误：

> codesign_allocate：用于架构 armv7 对象：/Users/myUsername/Library/Developer/Xcode/DerivedData/MyAPP-araevdowzmmoupfieakjpjmpsmhq/Build/Products/Debug-iphoneos/MyAPP.app/MyAPP 格式错误的对象（未知加载命令 36）/Users/myUsername/库/开发人员/Xcode/DerivedData

有人可以帮我吗？

谢谢！

**更新：**

我仍然有这个问题，但只有在为 iOS 设备编译时，而不是为模拟器编译。我无法创建存档。

请帮助我！

**解决了**

问题是由于构建阶段中的“运行脚本”我被遗忘了......并且指向旧路径 /Developer

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T22:55:11.833

删除您的派生数据，执行干净的构建，然后重试。

1.  要删除派生数据，请转到 Organizer->Projects，然后选择“Delete...”

    ![删除派生数据屏幕](../Images/4ce8f32528efbef1219ec4ec6ac1a3c9.png)

2.  要进行干净的构建，请在 Xcode 中选择 Project，然后选择“Clean”

    ![如何进行干净的构建，Shift+Cmd+K](../Images/c008d0c81ee5cd53141fbd3fe92fc4da.png)

**更新：**验证您的项目设置在这里也可能有所帮助。在 Xcode 中转到您的项目文件并选择它。

![验证项目设置](../Images/462f1e1f30505d04383d66ea69788ca7.png)

**更新 2：**似乎有东西干扰`codesign`，导致它使用了不正确的加载命令。也许您的旧版本的 Xcode (4.4) 留下了一些工件，这导致旧版本的`codesign`运行。我建议卸载您拥有的任何 Xcode 实例，确保它们都消失了，然后重新安装最新版本。

**更新3：**我很茫然，我不知道发生了什么。我的最后一个建议是创建一个新的 Xcode 项目，然后迁移你的东西；某些东西可能干扰了您的构建设置，这可能是大海捞针的情况。确保您拥有最新的 Xcode 和 OS X。

# javascript - How can I use an external js file for my popcorn.js script?

> ID：13214278
> 
> 赞同：2
> 
> 时间：2012-11-03T22:48:21.557
> 
> 标签：javascript, popcornjs

So it works perfectly when it's inline between tags, but how can I put this in an external js file and have it run? I copied it verbatim and it won't work. What's the issue?

edit: you can see the tutorial I'm working off of here: [http://popcornjs.org/popcorn-101](http://popcornjs.org/popcorn-101)

code:

```
// ensure the web page (DOM) has loaded
document.addEventListener("DOMContentLoaded", function () {

 // Create a popcorn instance by calling Popcorn("#id-of-my-video")
 var pop_Stephen = Popcorn("#vid_Stephen");

 // add a footnote at 2 seconds, and remove it at 6 seconds
 pop_Stephen.footnote({
   start: 2,
   end: 6,
   text: "Pop!",
   target: "pop"
 });

 // play the video right away
 // pop_Stephen.play();

}, false); 
```

edit: OK it seems that it just doesn't work within CODA2, which is a bummer. Any idea why this is?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T23:01:19.600

I'm betting that your `<script />` tags have you loading your external file before the Popcorn library.

Make sure you load `<script src="http://popcornjs.org/code/dist/popcorn-complete.min.js"></script>` before your external file.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-22T13:44:07.150

也许使用实用方法 Popcorn.getScript？

[http://popcornjs.org/popcorn-docs/utility-methods/#Popcorn.getScript](http://popcornjs.org/popcorn-docs/utility-methods/#Popcorn.getScript)

从网站：

```
Popcorn.getScript("yourscript.js"); 
```

# nunit - 尝试在 LINQPad 中使用 TypeMock 运行 nunit 测试时出错

> ID：13214279
> 
> 赞同：4
> 
> 时间：2012-11-03T22:48:25.777
> 
> 标签：nunit, linqpad, typemock

我喜欢 LINQPad 并且每天都在使用它。一段时间以来，我一直在尝试寻找一种方法来使用 nunit 和 TypeMock 在 LINQPad 中创建和运行临时测试。

所以我偶然发现并得到了一些结果，但仍然缺少一些链接。

这是我所做的：

1.  在 linqpad 中创建一个新查询，添加对 NUnit 和 Typemock 程序集的引用。

2.  创建一个 Nunit 跑步者。（感谢[http://www.paraesthesia.com/archive/2008/02/21/template-for-quick-typemock-testing.aspx](http://www.paraesthesia.com/archive/2008/02/21/template-for-quick-typemock-testing.aspx)）

3.  添加几个环境变量以启用 Typemock 分析器。

此时，我可以让 Nunit 和 Typemock 使用一些手动步骤（需要将 nunit 和 typemock dll 复制到执行目录，例如 \AppData\Local\Temp\1\LINQPad\skbidgcw）。

但是，如果我将我们的程序集（我想测试的）添加到 LINQPad 脚本中，测试将失败，因为 NUnit 无法在执行目录中找到程序集。我什至尝试将所有 DLL 复制到其中，但这也会失败，因为：

`System.IO.FileNotFoundException : Could not load file or assembly 'LINQPad, Version=1.0.0.0, Culture=neutral, PublicKeyToken=21353812cd2a2db5' or one of its dependencies. The system cannot find the file specified.`

我的 linqpad 查询在这里：[http ://pastebin.com/QtPNCv25](http://pastebin.com/QtPNCv25)

任何帮助将不胜感激！

附带说明一下，我也尝试使用**NUnitLite**，虽然它可以很好地运行 Nunit 测试，但我找不到让它与 Typemock 一起工作的方法，它会抛出错误说“Typemock Isolator 需要与 Coverage Tool 链接才能运行”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T23:24:47.733

终于找到了一种使用 NUnitLite 做我想做的事情的方法。

*   为我的系统添加了以下环境变量以启用 Typemock 分析器。

> Cor_Enable_Profiling=0×1
> 
> COR_PROFILER={B146457E-9AED-4624-B1E5-968D274416EC}

（NUnitLite 可能已经在另一个 AppDomain 中运行测试，因此通过 LINQPad 设置环境变量并没有启用分析器；如果在 NUnitLite 中有一个开关可以绕过，但我没有研究过。）

*   将 TypeMock.dll 和 Typemock.ArrangeActAssert.dll 放在 Linqpad 的插件文件夹中。

*   创建新查询并通过 Nuget 添加 NUnitLite。添加必要的命名空间。

现在以下应该工作。

```
void Main()
{
    new NUnitLite.Runner.TextUI().Execute( new[]{"-noheader"} );
}

// Define other methods and classes here
[Test, Isolated]
public void TestMock()
{
    Isolate.WhenCalled( () => DateTime.Now ).WillReturn( DateTime.Today );

    var dt = DateTime.Now;

    Assert.AreEqual( DateTime.Today, dt );
} 
```

现在我的生活应该容易得多。谢谢！

# .net - Monotouch：需要 WCF 客户端示例

> ID：13214286
> 
> 赞同：1
> 
> 时间：2012-11-03T22:49:30.140
> 
> 标签：.net, wcf, xamarin.ios, slsvcutil

我正在尝试创建一个 WCF 客户端以使用 MonoTouch 连接到我的服务器。由于 Monotouch 不支持动态代码生成，我厌倦了使用 slscvutil.exe 生成客户端代码。我从中得到的输出无法编译。它试图`ChannelBase`用作泛型类`ChannelBase<T>`，但它不是泛型的。此外，我能找到的所有示例都`ChannelBase`用作泛型类。有没有人有.net 4.0 中的 MonoTouch WCF 客户端示例？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T16:35:50.160

我没有给你一个示例——我构建的两个 WCF 客户端应用程序都是闭源的——但我已经成功地按照[http://docs.xamarin.com/ios/Guides/Application_Fundamentals/Introduction_to_Web_Services](http://docs.xamarin.com/ios/Guides/Application_Fundamentals/Introduction_to_Web_Services)上的步骤进行操作构建 2 个应用程序，包括使用 SLsvcutil 工具 - [http://msdn.microsoft.com/en-us/library/cc197958%28v=vs.95%29.aspx](http://msdn.microsoft.com/en-us/library/cc197958%28v=vs.95%29.aspx)。

此外，`ChannelBase<T>`在 SL4 中显然是通用的 - [http://msdn.microsoft.com/en-us/library/cc190431%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/cc190431%28v=vs.100%29.aspx)

您是否可以发布显示错误的示例？例如，复制您看到的错误的客户端和服务。

# streaming - RTSP 到 RTMP 流媒体或其他

> ID：13214287
> 
> 赞同：1
> 
> 时间：2012-11-03T22:49:31.543
> 
> 标签：streaming, video-streaming, rtsp, rtmp

我在 IP 摄像头上有一个 RTSP 流。我需要在网页上发布这个摄像头。我尝试使用 JWPlayer，但我认为 jwplayer 只支持 rtmp 而不是 rtsp。如果网页上不支持 RTSP。我需要将 RTSP 转换为 RTMP。我怎样才能做到这一点 ？

# javascript - 使用 Javascript 选择单个表单

> ID：13214288
> 
> 赞同：0
> 
> 时间：2012-11-03T22:49:41.070
> 
> 标签：javascript, html, forms

```
 <script>
 $(document).ready(function() {
$('form["meldaan"] input').keyup(function() {

    var empty = false;
    $('form["meldaan"] input').each(function() {
        if ($(this).val() == '') {
            empty = true;
        }
    });

    if (empty) {
        $('#register').attr('disabled', 'disabled');
    } else {
        $('#register').removeAttr('disabled');
    }
});
});
</script> 
```

该脚本适用于一种形式，但我在一页上有两种或三种不同的形式。我希望每个表单都被区别对待，如果我使用此代码，所有表单中的所有字段都需要填写，这显然是我不想要的。

如何识别独特的表格？假设一种形式被命名`name="formone"`，另一种形式被命名`name="formtwo"`。我将如何实施？（如果我必须制作更多功能也没关系）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T22:51:42.283

你只需要调整你的选择器：

```
$('form[name="formone"] > input') 
```

更新：@Andre，在您的实时示例中，输入不是表单元素的直接子元素，因此您需要使用：

```
$('form[name="formone"] input') 
```

更新 2：如果您使用的是 id：

```
$('#formid input') 
```

# python - 通用异常处理和异常返回 arg

> ID：13214289
> 
> 赞同：3
> 
> 时间：2012-11-03T22:50:17.930
> 
> 标签：python, exception-handling

我正在尝试创建通用异常处理程序 - 我可以设置一个 arg 以在异常情况下返回，灵感来自[这个答案](https://stackoverflow.com/questions/129144/generic-exception-handling-in-python-the-right-way)。

```
import contextlib

@contextlib.contextmanager
def handler(default):
    try:
        yield
    except Exception as e:
        yield default

def main():
    with handler(0):
        return 1 / 0

    with handler(0):
        return 100 / 0

    with handler(0):
        return 'helllo + 'cheese' 
```

但这导致

```
RuntimeError: generator didn't stop after throw() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T22:58:14.277

主要的概念问题是您试图使调用函数从被调用函数中隐式返回一个值。举个例子，你试图做的在概念上等同于这种情况：

```
def f():
    # some magic code here

def g():
    f() 
```

现在你想让魔法代码`g()`返回一些值。这永远行不通。

上下文管理器是用于此目的的错误工具。考虑改用装饰器。

# php - 多列无限滚动？

> ID：13214293
> 
> 赞同：1
> 
> 时间：2012-11-03T22:51:01.220
> 
> 标签：php, javascript, jquery, infinite-scroll, multiple-columns

我有一个由 4 个 div 列组成的 php/html 页面站点。他们四个都从 MySQL 数据库中的特定表中提取结果，而且都相当长。我决定采用无限滚动解决方案，但问题是我发现的所有脚本都指的是仅滚动一个附加结果的 div。

所以我想也许通过一些定制应该可以使它适用于多个列。我决定试一试：[https](https://github.com/tournasdim/PHP-infinite-scrolling) ://github.com/tournasdim/PHP-infinite-scrolling 。我尝试过更改值并添加多个查询源，然后将它们附加到不同的 div，但我不太确定我应该如何处理。

这是来自 custom_jquery.js ：

```
$.ajax({
dataType : "html" ,
url: "jquery-loadMoreComments.php?lastComment="+ $(".postedComment:last").attr('id') ,  
success: function(html) {
 doMouseWheel = 1 ; 
if(html){
$("#postedComments").append(html);
//console.log("Append html--------- " +$(".postedComment:first").attr('id'));
//console.log("Append html--------- " +$(".postedComment:last").attr('id'));
$("#last").remove();
$("#postedComments").append( "<p id='last'></p>" );
$('div#loadMoreComments').hide();
}else{      
$('div#loadMoreComments').replaceWith("<center><h1 style='color:red'>End of countries !!!!!!!</h1></center>"); 
```

你对如何处理这个有什么建议吗？

任何提供的见解将不胜感激！

此外，如果您知道另一个开箱即用效果更好或需要较少修改的脚本，我们也欢迎您。

我目前使用 CodeIgniter 从数据库中提取结果并将它们显示在页面上，但是因为它是一个简单的页面，所以我也可以不使用 CodeIgniter。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T21:36:52.180

只需将滚动事件绑定到四个 Ajax 调用，使用不同的 id，您就可以快速而肮脏地做到这一点，但这将非常低效。

尤其是当它检查所有四列时，即使您知道其中一列已用完新内容。

理想情况下，您应该将所有四个调用合并为一个，然后相应地拆分响应。

如果没有看到更多代码，我真的帮不上什么忙，但这应该是一个起点。

# c# - 如何在类中使用对象的公共结构

> ID：13214294
> 
> 赞同：0
> 
> 时间：2012-11-03T22:51:15.130
> 
> 标签：c#, oop, class, struct

所以，我有这个类和结构：

```
class CarCollection
{
    //struct contenant les informations pour décrire une voiture de la collection
    public struct voiture
    {
        public string marque, couleur, condition;
        public int annee;
        public DateTime dateAcquisition, dateVente;
        public double prix;
    }
    ... 
```

我想要的是能够在我拥有包含此结构的对象的类中创建此结构类型的变量：

```
class Program
{
    static CarCollection collection;
    ...
    voiture temp = new voiture();
    //or
    collection.voiture temp = new collection.voiture(); 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T22:54:18.043

如果要初始化 a `voiture`，则必须通过外部类访问它，因为全名是`CarCollection.voiture`：

```
 CarCollection.voiture v = new CarCollection.voiture(); 
```

您正在使用外部类的实例来引用结构。

[嵌套类型（C# 编程指南）](http://msdn.microsoft.com/en-us/library/ms173120.aspx)

# php - XML 时间 PHP 转换

> ID：13214297
> 
> 赞同：0
> 
> 时间：2012-11-03T22:51:38.227
> 
> 标签：php, xml, time, date-formatting

我可以让日期和月份显示正常，但我的问题在于时间。在我给出的 XML 文件中，它被设置为：

```
<Start>2012-11-11T01:00:00Z</Start>
<End>2012-11-11T02:00:00Z</End> 
```

但最终的风格应该是下午 2 点到 3 点，我的时区是新西兰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T23:03:07.880

```
$start = "2012-11-11T01:00:00Z";
$end = "2012-11-11T02:00:00Z";
echo date("Ga", strtotime($start)) . "\n";
echo date("Ga", strtotime($end)); 
```

输出 ：

```
1am

2am 
```

参考文档： http: [//php.net/manual/en/function.date.php](http://php.net/manual/en/function.date.php)

# opencv - 改进harris角点检测器的结果

> ID：13214299
> 
> 赞同：4
> 
> 时间：2012-11-03T22:52:02.203
> 
> 标签：opencv, feature-detection

我一直在阅读有关特征检测的内容，并想尝试使用 harris 角检测器。我意识到这是通过调用来实现的

`void cornerHarris(InputArray src, OutputArray dst, int blockSize, int ksize, double k, int borderType=BORDER_DEFAULT )`

其中 dst 是包含每个像素角强度的浮点图像。

我想看到它工作，所以我想把它应用到下面的图片中：

[![笔记本电脑的图片](../Images/136411037fbc0438fc7ebdaf3aab18fa.png)](https://i.stack.imgur.com/HfIcn.jpg)

产生的结果是这样的：

[![未检测到角落](../Images/a0263ebe335ccf8ae5b1a9ba57b89aba.png)](https://i.stack.imgur.com/nZ4x9.jpg)

如您所知，结果并不好。在我看来，它只是拾起噪音，甚至没有检测到主要角落。

这是我用来在图像上打印角的代码，我使用了阈值并为阈值设置了任意值。

```
int _tmain(int argc, _TCHAR* argv[])
{

Mat img, dst, threshed;
img = imread("c:\\laptop.jpg",0);

dst = Mat::zeros(img.size(), CV_32FC1);

cornerHarris(img, dst, 2, 3, 0.04, BORDER_DEFAULT);

threshold(dst, threshed, 0.00001, 255, THRESH_BINARY_INV);

namedWindow("meh", CV_WINDOW_AUTOSIZE);
imshow("meh", threshed);
//imwrite("harris.jpg", threshed);
waitKey(0);

return 0; 
```

`If I reduce threshold the result is white with just a few black dots (detections) Increasing threshold just produces a more noisy like image.`

我错过了什么吗？如何提高此功能的质量？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-04T10:07:18.193

您可以尝试一个[好的FeaturesToTrack](http://docs.opencv.org/modules/imgproc/doc/feature_detection.html#goodfeaturestotrack)功能。它建立在 Harris 角点检测器之上，但过滤了我们的噪声并仅返回强角点。

# opengl - 使顶点变暗的快速方法？

> ID：13214302
> 
> 赞同：0
> 
> 时间：2012-11-03T22:52:44.033
> 
> 标签：opengl, lwjgl, lighting

要为体素游戏制作照明系统，我需要为每个顶点指定一个暗度值。我正在使用`GL_COLOR_MATERIAL`并指定每个顶点的颜色，如下所示：

```
glEnable(GL_COLOR_MATERIAL);

glBegin(GL_QUADS);

glColor3f(0.6f, 0.6f, 0.6f);
glTexCoord2f(...);
glVertex3f(...);

glColor3f(0.3f, 0.3f, 0.3f);    
glTexCoord2f(...);
glVertex3f(...);

glColor3f(0.7f, 0.7f, 0.7f);        
glTexCoord2f(...);
glVertex3f(...);

glColor3f(0.9f, 0.9f, 0.9f);
glTexCoord2f(...);
glVertex3f(...);

glEnd(); 
```

这是可行的，但是对于许多四边形，它非常慢。我也在使用显示列表。关于如何使顶点更暗的任何好主意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T23:18:02.363

您正在使用即时模式（glBegin、glEnd 以及介于两者之间的所有内容）。如果性能是您所需要的，那么我建议您停止这样*做*。

您可能追求的是通用顶点属性。你瞧：现代 OpenGL 实际上有这个：通用属性。他们甚至走到了这一步，做正确的事并取消了预定义的属性（位置、颜色、法线、texcoords 等），并且在 OpenGL-3 核心及更高版本中只有通用属性。

函数 glVertexAttrib（大多数时候*Uniform*做得更好）和 glVertexAttribPointer 是你的朋友。指定如何使用适当的顶点着色器处理顶点属性。

# ruby-on-rails - 使用 ror 加载 MongoDB / Mongoid 嵌入式文档

> ID：13214305
> 
> 赞同：0
> 
> 时间：2012-11-03T22:52:48.033
> 
> 标签：ruby-on-rails, mongodb, mongoid

我有一个包含许多嵌入文档（DataPoint）（1：N 关系）的文档（DataSet）。由于这在rails中对我来说是一个数组，例如，如果我想读取每20个元素，它会将每个元素加载到内存中，还是仅每20个元素？

我试图弄清楚这是否效率低下。理想情况下，我只想从数据库中加载我需要的东西。

这是一个例子：

```
a = DataSet.first
points = a.data_points.values_at(*(0..a.data_points.count).step(20)) 
```

这很糟糕吗？有没有一种特殊的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T06:45:10.373

嵌入文档不是关系（以典型的 RDBMS 方式），而是实际上嵌入（因此得名）父记录中，就像任何其他属性一样。因此，当您调用 时`DataSet.first`，您会将整个文档及其嵌入的记录加载到内存中。

根据您的应用程序的结构，您可能会看到将每 20 次非规范化`DataPoint`为一个单独的嵌入关系（在回调期间，或在后台任务中，或类似的事情），然后当您加载文档时，仅加载那些带有`DataSet.only(:datapoints_sample).first`- 的点只会将该关系加载到内存中（并且没有其他属性）。

# json - 如何在代码中为 JACKSON 提供命名空间映射器？

> ID：13214306
> 
> 赞同：1
> 
> 时间：2012-11-03T22:52:51.097
> 
> 标签：json, jaxb, jackson

我正在尝试序列化 JAXB 生成的类。使用 Jettison，我能够创建一个哈希映射，将 XML 命名空间映射到任何 JSON 前缀。使用 Jettison，我还可以在序列化中正确区分大小写。对于 JACKSON，它都是小写的。所以，似乎 Jettison 能够`XMLRootElement(name=…)`更好地理解。

如何让 JACKSON 更好地理解 JAXB 注释`XMLRootElement`？

如何为 JACKSON 提供 XML→JSON 命名空间映射器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T11:48:02.230

**注意：** 我是[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)负责人，也是[JAXB (JSR-222)](http://jcp.org/en/jsr/detail?id=222)专家组的成员。

EclipseLink MOXy 是符合 JAXB (JSR-222) 的实现。在 EclipseLink 2.4.0 中，我们引入了 JSON 绑定。由于 MOXy 是一个 JAXB 实现，您会发现 MOXy 生成的 JSON 输出将与基于相同元数据的 XML 输出非常一致。我将在下面用一个例子来演示。

* * *

**领域模型**

以下是我将用于此答案的域模型。有关在 JAXB 模型中指定命名空间信息的更多信息，请参阅：[http ://blog.bdoughan.com/2010/08/jaxb-namespaces.html](http://blog.bdoughan.com/2010/08/jaxb-namespaces.html)

***包信息***

```
@XmlSchema(
        namespace="http://www.example.com/A",
        elementFormDefault=XmlNsForm.QUALIFIED,
        xmlns={
                @XmlNs(prefix="a",namespaceURI = "http://www.example.com/A"),
                @XmlNs(prefix="b",namespaceURI = "http://www.example.com/B")
        }
)
package forum13214306;

import javax.xml.bind.annotation.*; 
```

***顾客***

```
package forum13214306;

import javax.xml.bind.annotation.*;

@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class Customer {

    String firstName;

    @XmlElement(namespace="http://www.example.com/B")
    String lastName;

} 
```

* * *

**XML 处理**

下面是域模型如何对应于 XML 表示的示例。

***演示***

```
package forum13214306;

import java.io.File;
import javax.xml.bind.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Customer.class);

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        File xml = new File("src/forum13214306/input.xml");
        Customer customer = (Customer) unmarshaller.unmarshal(xml);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(customer, System.out);
    }

} 
```

***输入.xml/输出***

```
<?xml version="1.0" encoding="UTF-8"?>
<a:customer xmlns:b="http://www.example.com/B" xmlns:a="http://www.example.com/A">
   <a:firstName>Jane</a:firstName>
   <b:lastName>Doe</b:lastName>
</a:customer> 
```

* * *

**JSON 处理 - 没有命名空间**

命名空间不是 JSON 概念，因此如果可以避免这种情况，我建议不要模拟它们。下面我将证明 MOXy 不需要它们。`JAXBContext`请注意，这里使用的域模型与用于带有名称空间的 XML 文档完全相同。

***jaxb.properties***

要将 MOXy 指定为您的 JSON 提供程序，您需要包含一个`jaxb.properties`在与域模型相同的包中调用的文件，其中包含以下条目（请参阅：[http](http://blog.bdoughan.com/search/label/jaxb.properties) ://blog.bdoughan.com/search/label/jaxb.properties ）。

```
javax.xml.bind.context.factory=org.eclipse.persistence.jaxb.JAXBContextFactory 
```

***演示***

要启用 JSON 绑定，`MEDIA_TYPE`需要在`Marshaller`和上启用该属性`Unmarshaller`。

```
package forum13214306;

import java.io.File;
import javax.xml.bind.*;
import org.eclipse.persistence.jaxb.MarshallerProperties;
import org.eclipse.persistence.jaxb.UnmarshallerProperties;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Customer.class);

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        unmarshaller.setProperty(UnmarshallerProperties.MEDIA_TYPE, "application/json");
        File json = new File("src/forum13214306/input.json");
        Customer customer = (Customer) unmarshaller.unmarshal(json);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.setProperty(MarshallerProperties.MEDIA_TYPE, "application/json");
        marshaller.marshal(customer, System.out);
    }

} 
```

***输入.json/输出***

下面是运行演示代码的输入和输出。请注意 JSON 文档中没有模拟命名空间信息。

```
{
   "customer" : {
      "firstName" : "Jane",
      "lastName" : "Doe"
   }
} 
```

* * *

**JSON 处理 - 使用模拟的命名空间**

***演示***

如果您真的想在 JSON 文档中模拟名称空间，您可以利用and`NAMESPACE_PREFIX_MAPPER`上的属性来执行此操作。`Marshaller``Unmarshaller`

```
package forum13214306;

import java.io.File;
import java.util.*;
import javax.xml.bind.*;
import org.eclipse.persistence.jaxb.MarshallerProperties;
import org.eclipse.persistence.jaxb.UnmarshallerProperties;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Customer.class);

        Map<String, String> namespaceToPrefixMap = new HashMap<String, String>(2);
        namespaceToPrefixMap.put("http://www.example.com/A", "a");
        namespaceToPrefixMap.put("http://www.example.com/B", "b");

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        unmarshaller.setProperty(UnmarshallerProperties.MEDIA_TYPE, "application/json");
        unmarshaller.setProperty(UnmarshallerProperties.JSON_NAMESPACE_PREFIX_MAPPER, namespaceToPrefixMap);
        File json = new File("src/forum13214306/input.json");
        Customer customer = (Customer) unmarshaller.unmarshal(json);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.setProperty(MarshallerProperties.MEDIA_TYPE, "application/json");
        marshaller.setProperty(MarshallerProperties.NAMESPACE_PREFIX_MAPPER, namespaceToPrefixMap);
        marshaller.marshal(customer, System.out);
    }

} 
```

**输入.json/输出**

```
{
   "a.customer" : {
      "a.firstName" : "Jane",
      "b.lastName" : "Doe"
   }
} 
```

* * *

**了解更多信息**

*   [http://blog.bdoughan.com/2011/08/json-binding-with-eclipselink-moxy.html](http://blog.bdoughan.com/2011/08/json-binding-with-eclipselink-moxy.html)
*   [http://blog.bdoughan.com/2012/05/moxy-as-your-jax-rs-json-provider.html](http://blog.bdoughan.com/2012/05/moxy-as-your-jax-rs-json-provider.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T19:48:54.163

与 XML 不同，JSON 没有名称空间。那么为什么你觉得你需要命名空间映射呢？数据绑定意味着 Java POJO 和数据格式之间的映射，使用格式的特性。对于 XML，这包括名称空间、元素与属性的选择等。使用 JSON 可以消除大部分复杂性，这意味着按原样使用属性名称。

至于 JAXB 注解：Jackson 有自己的一组更匹配的注解，但如果您确实想使用 JAXB 注解作为附加或替代配置源，则需要使用[JAXB Annotation 模块](https://github.com/FasterXML/jackson-module-jaxb-annotations)。但是对于使用`XMLRootElement`，JSON 是没有必要的：JSON 对象没有名称。

我不知道您所说的“在序列化中正确区分大小写”是什么意思——在什么意义上？问题是什么？您将需要给出 POJO 定义的示例以及预期的 JSON。

最后，请记住，JSON 和 XML 表示法没有必要看起来彼此相似。这些是具有不同逻辑数据模型的不同数据格式，以及自然不同的映射：例如，JSON 在 Arrays 和 Objects 之间具有原生区别；而 XML 必须同时使用 Elements。XML 具有 JSON 所缺乏的名称空间和属性。这些导致不同的自然映射，并且尝试将两者“统一”会导致其中一个或另一个或两者都有一些不自然的结果。对于 Jettison（以及使用它的框架），它是丑陋的 JSON（“franken-JSON”）。

# css - 在 1 个主 DIV 的每一侧放置一个 DIV

> ID：13214308
> 
> 赞同：1
> 
> 时间：2012-11-03T22:53:08.577
> 
> 标签：css, html, position

如何将 4 个 DIV 放置在另一个 DIV 的两侧？

北1个，南1个，西1个，东1个。

```
<div id="frame">
  <div id="north"></div>
  <div id="east"></div>
  <div id="map"></div>
  <div id="south"></div>
  <div id="west"></div>
</div> 
```

注意：框架以 为中心`margin: auto;`。的`width`and`height`可以`map`改变。它周围的每个 Div 都应该是整洁的。边界。

看这张图片：

```
 |-------|
     |  n    |
|----|-------|----|
|  w |  map  |  e |
|----|-------|----|
     |  s    |
     |-------| 
```

我怎样才能做到最好？

* * *

**编辑：**

感谢您到目前为止的答案。我希望 Navi Div 不是绝对定位，而是更像是“链接”到地图 Div。抱歉缺少信息。

我现在使用 jQuery 的`mouseleave`函数来确定离开地图时鼠标移动的方向。这样就完成了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T23:00:41.267

我在这里创建了一个小提琴[来](http://jsfiddle.net/Astraldiva/Kt7PP/)演示您的示例。它使用相对 -> 绝对定位。它假定您知道元素的确切宽度/高度。

标记：

```
<div id="frame">
  <div id="north">north</div>
  <div id="east">east</div>
  <div id="map">map</div>
  <div id="south">south</div>
  <div id="west">west</div>
</div> 
```

CSS：

```
#frame {width: 450px; height: 450px; position: relative; margin: auto;}

#frame div {position: absolute; width: 150px; height: 150px;}

#map {top: 150px; left: 150px; background-color: orange;}

#east {right: 0px; top: 150px; background-color: yellow;}

#west {left: 0px; top: 150px; background-color: blue;}

#north {left: 150px; top: 0; background-color: green;}

#south {left: 150px; bottom: 0; background-color: gray;} 
```

我使用了一些背景颜色，所以它更清晰。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T21:54:17.153

解决了我的问题：我现在使用jQuery的mouseleave函数来确定离开地图时鼠标移动的方向。这样就完成了。

# sql - compare 2 columns from different tables

> ID：13214317
> 
> 赞同：1
> 
> 时间：2012-11-03T22:54:34.823
> 
> 标签：sql, sqlite

I have 2 tables with same column in each.. Lets call it colors. How do I compare the two to show the unique colors in table B that are not in table A?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T22:57:25.697

```
select b.color
  from tbl1 b
 where not exists (select * from tbl2 a where b.color=a.color) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T23:00:16.640

```
SELECT b.color AS color FROM tableB b
LEFT JOIN tableA a ON a.color = b.color
WHERE a.color IS NULL; 
```

# ios - 无法从展开的 segue 动作中弹出

> ID：13214321
> 
> 赞同：0
> 
> 时间：2012-11-03T22:54:56.820
> 
> 标签：ios, uistoryboardsegue

我有一个基于 tableview 的导航控制器。根视图控制器有一个 + 按钮，用于添加一个新项目。这会导致向视图控制器推送 segue，从而允许用户输入新项目的数据。

在这个视图控制器上，左上角的导航栏项目是标有“后退”的标准按钮。我已将“保存”[bar] 按钮 [item] 作为右上角的导航栏项。

我创建了一个展开 IBAction 推送视图控制器。

然后，我从 Save 按钮控制拖动到视图控制器上的出口，并将其连接到 unwind IBAction。

当我点击“保存”按钮时，会调用此展开操作。

但是，我在展开操作中所做的任何操作都不会弹出视图控制器。这是一个小代码：

```
- (BOOL)canPerformUnwindSegueAction:(SEL)action fromViewController:(UIViewController *)fromViewController withSender:(id)sender     {

   return YES;
}

- (BOOL)shouldPerformSegueWithIdentifier:(NSString *)identifier sender:(id)sender {

   NSLog( @"Should seque from %@", identifier );
   return YES;
}

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

}

- (IBAction)unwindFromGoalEdit:(UIStoryboardSegue *)segue {

   NSLog( @"UNWINDING!!");

   [self.navigationController popToViewController:segue.destinationViewController animated:YES];
} 
```

在下面的展开操作中，我尝试了各种方法来弹出视图控制器。但什么也没有发生。没有运行时错误，什么都没有。但是我确实看到了 NSLog() 所以我知道它被调用了。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-17T17:38:55.700

问题可能是您有一个保留周期。展开会自动弹出它上面的每个视图，除非它不能。你不会从放松中弹出任何东西。因此，将日志添加到您希望在 dealloc 方法或断点中弹出的视图控制器。如果这没有触发，那么您就知道视图控制器没有被弹出。这几乎可以肯定意味着您有一个保留周期。查看您的代表或您将自己（父母）传递到块中的任何地方。顶视图控制器不应该有对其父级的强引用。实际上，出于这个原因，任何孩子都不应该强烈提及其父母。如果这样做，则展开将不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T23:32:54.383

在哪个班`unwindFromGoalEdit:`？看起来你可能已经将它添加到“新项目”视图控制器中......这个方法应该放在根视图控制器中，不需要调用popToViewController。一个空的方法在这里就足够了。

# mysql - Complex query to update table field. Is this possible?

> ID：13214326
> 
> 赞同：2
> 
> 时间：2012-11-03T22:55:31.530
> 
> 标签：mysql

I have two database tables called Item and Inspection. An Item has many inspections. Basically, an inspection is done on an item and the inspection records it's state of bring "not broken" vs. "broken". Regular inspections are made on each item.

I want to update a newly added field for each record in the Items table called "last_broken_at". It needs to be updated to the "created" datetime found in the oldest related Inspection for that Item, where the Inspection "status" field is equal to "broken".

While that is definitely possible via a single MySQL update statement, here is the caveat:

If an Item was repaired at some point and inspection found the item to be "not broken", but is then later found to be "broken" again, the Item's "last_broken_at" field must be updated to the "created" datetime of the inspection where the status was "broken" after an inspection of status "not broken".

Basically, the "last_broken_at" field in the Items table must be true to its name, it must indeed be closest time we know the Item went from being "not broken" to "broken".

Here are what the tables look like:

Items table

*   ID (INT)
*   created (DATETIME)
*   name (VARCHAR)
*   status (VARCHAR) Note: contains latest status of the item, as per the last inspection.
*   last_broken_at (DATETIME)

Inspections

*   id (INT)
*   created (DATETIME)
*   item_status (VARCHAR)
*   item_id (INT)

Thanks!!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T23:06:20.000

尝试：

```
UPDATE items t 
SET    t.last_broke_at = (
                          SELECT min(created) 
                          FROM   inspections t1 
                          WHERE  t.item_id=t1.item_id 
                             AND status='broken' 
                             AND NOT EXISTS (
                                             SELECT * 
                                             FROM   inspections t2 
                                             WHERE  t1.item_id = t2.item_id 
                                                AND t2.created> t1.created 
                                                AND t2.status = 'not broken'
                                            )
                         ) 
```

# php - 使用多个文本框添加到数据库

> ID：13214330
> 
> 赞同：0
> 
> 时间：2012-11-03T22:56:28.417
> 
> 标签：php, mysql, post

我试图用这个脚本做的是允许用户更新他们网站的 url，因为每个用户不会拥有相同数量的网站，所以我很难为每个用户添加`$_POST['website']`。

这是脚本

```
<?php
include("config.php");
include("header.php");
include("functions.php");

if(!isset($_SESSION['username']) && !isset($_SESSION['password'])){
    header("Location: pubs.php");
    }

$getmember = mysql_query("SELECT * FROM `publishers` WHERE username = '".$_SESSION['username']."'");
$info = mysql_fetch_array($getmember);
$getsites = mysql_query("SELECT * FROM `websites` WHERE publisher = '".$info['username']."'");

$postback = $_POST['website'];
$webname = $_POST['webid'];
if($_POST['submit']){
foreach ( $_POST['website'] as $key => $value )
{
 $update = mysql_query("UPDATE `websites` SET `postback` = '".mysql_real_escape_string($postback[$value])."' WHERE id = '$webname'");
}
}

print"
<div id='center'>
<span id='tools_lander'><a href='export.php'>Export Campaigns</a></span>
<div id='calendar_holder'>
<h3>Please define a postback for each of your websites below. The following variables should be used when creating your postback.<br />
cid = Campaign ID<br />
sid = Sub ID<br />
rate = Campaign Rate<br />
status = Status of Lead. 1 means payable 2 mean reversed<br />
A sample postback URL would be <br />
http://www.example.com/postback.php?cid=#cid&sid=#sid&rate=#rate&status=#status</h3>
<table class='balances' align='center'>
<form method='POST' action=''>";

while($website = mysql_fetch_array($getsites)){
print"
<tr>
<input type ='hidden' name='webid' value='".$website['id']."' />
<td style='font-weight:bold;'>".$website['name']."'s Postback:</td>
<td><input type='text' style='width:400px;' name='website[]' value='".$website['postback']."' /></td>
</tr>";
}
print"
<td style='float:right;position:relative;left:150px;'><input type='submit' name='submit' style='font-size:15px;height:30px;width:100px;' value='Submit' /></td>
</form>
</table>
</div>";

include("footer.php");
?> 
```

我正在尝试做的是将文本框中输入的内容插入到其相应的网站，我想不出任何其他方式来做到这一点，这显然不起作用并返回一条通知，说明`Array to string conversion` 如果有更合乎逻辑的方式要做到这一点，请告诉我。

**更新** 我添加了一个 foreach 语句，但这似乎仍然不能解决问题。它不会更新数据库中的任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T01:22:21.127

我能够通过一些试验和错误来解决问题，Lawrence 帮助通知我使用 foreach 语句。这就是我的结局。

```
<?php
include("config.php");
include("header.php");
include("functions.php");

if(!isset($_SESSION['username']) && !isset($_SESSION['password'])){
    header("Location: pubs.php");
    }

$getmember = mysql_query("SELECT * FROM `publishers` WHERE username = '".$_SESSION['username']."'");
$info = mysql_fetch_array($getmember);
$getsites = mysql_query("SELECT * FROM `websites` WHERE publisher = '".$info['username']."'");

$postback = $_POST['website'];
$webname = $_POST['webid'];
if($_POST['submit']){
$i = -1;
foreach ($postback as $key => $value)
{
$i ++;
print_r($webname[$i]);
 $update = mysql_query("UPDATE `websites` SET `postback` = '".cleanQuery($postback[$key])."' WHERE `id` = '".$webname[$i]."'") or die("MySQL ERROR: ".mysql_error());
}
}

print"
<div id='center'>
<span id='tools_lander'><a href='export.php'>Export Campaigns</a></span>
<div id='calendar_holder'>
<h3>Please define a postback for each of your websites below. The following variables should be used when creating your postback.<br />
cid = Campaign ID<br />
sid = Sub ID<br />
rate = Campaign Rate<br />
status = Status of Lead. 1 means payable 2 mean reversed<br />
A sample postback URL would be <br />
http://www.example.com/postback.php?cid=#cid&sid=#sid&rate=#rate&status=#status</h3>
<table class='balances' align='center'>
<form method='POST' action=''>";

while($website = mysql_fetch_array($getsites)){
print"
<tr>
<input type ='hidden' name='webid[]' value='".$website['id']."' />
<td style='font-weight:bold;'>".$website['name']."'s Postback:</td>
<td><input type='text' style='width:400px;' name='website[]' value='".$website['postback']."' /></td>
</tr>";
}
print"
<td style='float:right;position:relative;left:150px;'><input type='submit' name='submit' style='font-size:15px;height:30px;width:100px;' value='Submit' /></td>
</form>
</table>
</div>";

include("footer.php");
?> 
```

# backbone.js - 如何获取和填充 Google Places JS API 的主干模型？

> ID：13214332
> 
> 赞同：0
> 
> 时间：2012-11-03T22:56:45.887
> 
> 标签：backbone.js, google-places-api

我正在实现一个需要访问[Google Places JS API](https://developers.google.com/maps/documentation/javascript/places)的系统。在大部分项目中，我一直在使用 rails，但现在我想在我的一个视图中注入一点 AJAX。基本上，它是一个显示您所在位置附近地点的视图。为此，我使用了 Google Places 的 JS API。一个快速的工作流程是：

1- 用户输入文本查询并点击回车。2- 有一个 AJAX 调用从 Google Places API 请求数据。3-成功的结果呈现给用户。

问题主要出在第 2 步。我想为此使用[骨干网](http://backbonejs.org)，但是当我创建骨干网模型时，它会请求“rootURL”。如果对 Places 的请求是从服务器完成的，这将不是问题，但事实并非如此。

地方电话是这样完成的：

```
service = new google.maps.places.PlacesService(map);
service.nearbySearch(request, callback); 
```

传递回调函数：

```
function callback(results, status) {
  if (status == google.maps.places.PlacesServiceStatus.OK) {
    for (var i = 0; i < results.length; i++) {
      var place = results[i];
      createMarker(results[i]);
    }
  }
} 
```

是否可以覆盖骨干模型中的“获取”方法并使用成功的 Places 结果填充模型？这是一个坏主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T23:19:08.680

可以覆盖骨干模型的 fetch 方法。

```
var mapModel = Backbone.Model.extend({
    fetch: function (options) {
        // do your call to google places here
    },
    callBackFunctionForGoogleMaps: function (results, status) {
        // call back function here would set model properties
    }
});
return mapModel; 
```

这样，您可以覆盖 fetch 并删除 Backbone 的默认行为以进行 ajax 调用。

仅供参考，如果您想覆盖 Backbone 模型 fetch 但仍然具有 model.fetch 的默认行为，您可以执行以下操作。注意调用 Backbone.Model.fetch 的返回。

```
var mapModel = Backbone.Model.extend({
    fetch: function (options) {
        // do any pre-fetch actions here
        return Backbone.Model.fetch.call(options);
    }
});
return mapModel; 
```

在这里重写 fetch 方法可能不是一个坏主意，因为您仍在为模型获取数据，而不是通过最终的 ajax 调用。不过，留下评论指出您以这种方式覆盖 fetch 是有原因的，这将是明智的。

# jquery - 切换缓存/cookies

> ID：13214338
> 
> 赞同：2
> 
> 时间：2012-11-03T22:57:39.783
> 
> 标签：jquery, cookies, toggle

我正在使用 jQuery 切换功能进行导航。默认情况下，作者切换是可见的，档案切换是关闭的。

[http://jsfiddle.net/TeDFs/4/](http://jsfiddle.net/TeDFs/4/)

我的问题是，当用户切换到另一个页面时，切换会自行重置。

例如，当用户关闭作者切换并打开存档切换然后导航到另一个页面时，将加载默认设置。

我读到可以通过 cookie 存储设置，但我对 jQuery 完全陌生，如果有人能帮助我，那就太好了！

HTML

```
<div id="authors" class="widget">
<h2 class="widget-title-visible">Authors</h2>
<div class="toggle">
    <div class="submenu">
        <ul>
            <li>Name 1</li>
            <li>Name 2</li>
            <li>Name 3</li>
            <li>Name 3</li>
        </ul>
    </div>
</div> 
```

```
<div id="archives" class="widget">
<h2 class="widget-title">Archiv</h2>
<div class="toggle hidden">
    <div class="submenu">       
        <ul>
            <li>November 2012</li>
            <li>Oktober 2012</li>
        </ul>
    </div>
</div>
</div>​ 
```

jQuery

```
function toggleWidgets() {
    jQuery('.widget-title').addClass('plus'); 

    jQuery('.widget-title-visible').addClass('minus'); 

    jQuery('.widget-title').click(function() {
        $(this).toggleClass('plus').toggleClass('minus').next().toggle(180);
    });

    jQuery('.widget-title-visible').click(function() {
        $(this).toggleClass('minus').toggleClass('plus').next().toggle(180);
    });
} 

jQuery(document).ready(function() {
    toggleWidgets();
} )​ 
```

CSS

```
.hidden{
    display:none;
}

.plus {
    background: url(http://moargh.de/daten/sidebar_arrows.png) 0 5px no-repeat;
    padding: 0 0 0 12px;
}
.minus {
    background: url(http://moargh.de/daten/sidebar_arrows.png) 0 -10px no-repeat;
    padding: 0 0 0 12px;
} 
```

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T23:01:44.030

```
function createCookie(name, value, days) {
    var expires;
    if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        expires = "; expires=" + date.toGMTString();
    }
    else expires = "";
    document.cookie = name + "=" + value + expires + "; path=/";
}

function readCookie(name) {
    var nameEq = name + "=";
    var ca = document.cookie.split(';');
    for (var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ')
            c = c.substring(1, c.length);
        if (c.indexOf(nameEq) == 0)
            return c.substring(nameEq.length, c.length);
    }
    return null;
}

function eraseCookie(name) {
    createCookie(name, "", -1);
} 
```

以下是读取/写入 cookie 的函数。您可以根据需要保留设置:)

如果要切换两个 div 的可见性，只需使用 div 的“id”作为 cookie 名称，并在 cookie 中保存“true”或“false”，因为它是否可见。

当您单击 div 时，获取它的“id”和可见性以及

```
var divId = $(this).attr("id");
var visible = false;
if($(this).isVisible())
    visible = true;

createCookie(divId, visible, 1); 
```

当您重新加载页面时

```
var visibleAuthors = readCookie("authors");
var visibleArchives = readCookie("archives") 
```

加载页面时解析cookie的结果，然后显示你想要的div

# java - Android ProgressDialog inside another dialog

> ID：13214340
> 
> 赞同：0
> 
> 时间：2012-11-03T22:57:48.457
> 
> 标签：java, android, dialog, progressdialog

I'm working on a game using AndEngine, and I need to show the users the list of his Facebook friends. I've created my custom `Adatper` for the `ListView` and after the loading finishes everything works great. I have a problem with the loading part it self.

The `ListView` is inside a custom dialog, So inside this dialog, I'm running an `AsyncTask` to fetch the friends' info, in that `AsyncTask` I have a `ProgressDialog`. The problem is, the `ProgressDialog` shows up behind the dialog that contains the to-be list (which while loading, is just the title). I can see the `ProgressDialog` "peeking" behind that dialog.. Any Ideas?

Here's some code:

`FriendsDialog.java`

```
private ProgressDialog dialog;

//Constructor of the AsyncTask
public FriendsLoader(Context context) {
    dialog = new ProgressDialog(context);
    dialog.setMessage("Please wait..\nLoading Friends List.");
}

@Override
protected void onPreExecute() {
    dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
    LayoutInflater inflater = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    dialog.setView(inflater.inflate(R.layout.loading, null));
    dialog.setMessage("Please wait..\nLoading friends.");
    dialog.show();
}

@Override
protected void onPostExecute(ArrayList<HashMap<String, Object>> data) {
    if (dialog.isShowing()) {
        dialog.dismiss();
    }
    MyAdapter myAdapter = new MyAdapter(context, data);
    listView = (ListView) findViewById(R.id.list);
    listView.setAdapter(myAdapter);
    listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> myAdapter, View myView, int myItemInt, long mylng) {
            String id = (String) listView.getItemAtPosition(myItemInt);
            listener.onUserSelected(id);
            dismiss();
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T01:02:40.927

Opening a dialog from another dialog is not the best idea, especially if one of them is a progress dialog (try to rotate the screen..).

I suggest a better approach:

The friends dialog will have 2 views: ListView and a ProgressBar. The ListView will be invisible when you load the data, and the ProgressBar will be visible at the time. When you'll finish loading the data, just switch the visibility between those 2 views.

For a smoother transition between those views, you can use [ViewAnimator](http://developer.android.com/reference/android/widget/ViewAnimator.html), which takes care of the visibility modes and even allows you to add an effect to the transition (e.g. fade, slide etc.). It's very simple to use and there are lots of examples online.

Best of luck!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T06:17:32.840

Use Activity as a dialog by setting style(in manifest). and than you can use Progress Dialog inside that activity

# java - Java ByteBuffer 到 VB .NET

> ID：13214348
> 
> 赞同：-1
> 
> 时间：2012-11-03T22:58:50.590
> 
> 标签：java, vb.net, bytebuffer

我有这个java代码：

```
 ByteBuffer p = ByteBuffer.allocate(packet.length - 10 + 14);
    p.order(ByteOrder.LITTLE_ENDIAN);
    p.putInt(packet.length);
    p.putInt(packet.request_id);
    p.putInt(packet.type);
    p.put(packet.paylod);
    p.put((byte) 0);
    p.put((byte) 0);
    new DataOutputStream(sock.getOutputStream()).write(p.array()); 
```

我想把它翻译成 VB .NET 我从这个开始：

```
 Dim p(packet.length - 10 + 14) As Byte
    Dim Stream As MemoryStream = New MemoryStream()
    Dim Writer As BinaryWriter = New BinaryWriter(Stream)
    Using Writer
        Writer.Write(packet.length)
        Writer.Write(packet.request_id)
        Writer.Write(packet.type)
        Writer.Write(packet.paylod)
        Writer.Write(CByte(0))
        Writer.Write(CByte(0))
    End Using
    p = Stream.ToArray() 
```

但是在我不知道如何按小端顺序排序之后

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T23:40:08.510

查看文档[http://msdn.microsoft.com/en-us/library/24e33k1w.aspx](http://msdn.microsoft.com/en-us/library/24e33k1w.aspx)，似乎`BinaryWriter.Write`整数方法默认为小端顺序。

> BinaryWriter 以小端格式存储此数据类型。

所以它应该按原样工作。

# python - 对于开源项目来说，*太小*有多小？

> ID：13214349
> 
> 赞同：2
> 
> 时间：2012-11-03T22:58:50.573
> 
> 标签：python, open-source, driver, libraries

在过去的 2 年中，我一直在使用大量较小的项目/库。我正在考虑将它们移至 Google Code，以便更轻松地与同事分享，并更轻松地将它们导入我自己环境中的新项目中。例如简单的 FSM、CAN（控制器局域网）驱动程序和 GPIB 驱动程序。它们中的大多数都很小（不到 500 行），所以我想知道这些类型的东西对于独立的开源项目来说太小了吗*？*

请注意，我想让它开源，因为它不会给我或我的公司带来任何真正的优势。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T23:03:19.300

越小越好。

一个 10 行函数来将 HSV 转换为 RGB 或找到最接近三角形的点或类似 CAN/GPIB 驱动程序的东西比一个庞大的、复杂的、文档不足的框架更容易被阅读和使用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T23:09:17.597

不要考虑代码行数，要考虑代码的实用性。如果您的代码对某人有用，请将您的代码上传到一个或多个存储库，编写 wiki、示例等。我看到了一个不到 100 行的有用 Python 库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T23:03:29.767

500行？这在我看来很多。

将它们作为项目发布听起来不错。我的意思是，您阅读了多少篇博客文章，只用了一些节省时间的代码？

现在想象一下，只有 500 行代码和一个为此目的而设计的永久主机

# iphone - Custom Grouped Table Cell

> ID：13214359
> 
> 赞同：2
> 
> 时间：2012-11-03T23:00:29.803
> 
> 标签：iphone, objective-c, ios, quartz-graphics

I am trying to draw my grouped table cells in the drawRect method. I get the following results, but I have one problem with. I want the outer border to be a darker, but I can not seem to accomplish this, which I am sure is a problem with my drawing.

I like the color of the line in the middle between the cells, just not the outer border of the cells.

Edit:

```
-(void)drawRect:(CGRect)rect
{
    const float kLineWidth = 3.0;

    UIColor *topLineColor = [UIColor whiteColor];
    UIColor *bottomLineColor = [UIColor colorWithRed:225.0f/255.0f green:225.0f/255.0f blue:225.0f/255.0f alpha:1.0f];
    UIColor *backgroundColor = [UIColor colorWithRed:242.0f/255.0f green:242.0f/255.0f blue:242.0f/255.0f alpha:1.0f];

    CGColorRef bottomSeparatorColorRef = [bottomLineColor CGColor];
    CGColorRef topSeparatorColorRef = [topLineColor CGColor];

    CGContextRef context = UIGraphicsGetCurrentContext();

    UIRectCorner corners = 0;

    switch(self.position) {

        case OTCellBackgroundViewPositionTop:
            corners = UIRectCornerTopLeft | UIRectCornerTopRight;
            break;

        case OTCellBackgroundViewPositionMiddle:
            break;

        case OTCellBackgroundViewPositionBottom:
            corners = UIRectCornerBottomLeft | UIRectCornerBottomRight;
            break;

        default:
            break;
    }

    [backgroundColor setFill];
    [topLineColor setStroke];

    UIBezierPath *bezierPath =   [UIBezierPath bezierPathWithRoundedRect:rect byRoundingCorners:corners cornerRadii:CGSizeMake(10.0f, 10.0f)];

    [bezierPath fill];
    [bezierPath stroke];
    [bezierPath setLineWidth:3.0f];

    if (self.position == OTCellBackgroundViewPositionTop) {
        // Draw the Bottom Line
        CGContextSetStrokeColorWithColor(context, bottomSeparatorColorRef);
        CGContextSetLineWidth(context, kLineWidth);
        CGContextSetLineCap(context, kCGLineCapSquare);
        CGContextMoveToPoint(context, 0.0, rect.size.height);
        CGContextAddLineToPoint(context, rect.size.width, rect.size.height);
        CGContextStrokePath(context);   
    }

    if (self.position == OTCellBackgroundViewPositionBottom) {
        // Draw the Top Line
        CGContextSetStrokeColorWithColor(context, topSeparatorColorRef);
        CGContextSetLineWidth(context, kLineWidth);
        CGContextSetLineCap(context, kCGLineCapSquare);
        CGContextMoveToPoint(context, 0.0, 0.0);
        CGContextAddLineToPoint(context, rect.size.width, 0);
        CGContextStrokePath(context);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T00:38:04.633

您将顶部分隔符设置为白色。

```
UIColor *topLineColor = [UIColor whiteColor];
CGColorRef topSeparatorColorRef = [topLineColor CGColor];
// Top Line
CGContextSetStrokeColorWithColor(context, topSeparatorColorRef); 
```

只需将其设置为较深的颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T00:39:17.540

让我们看一下顶部位置单元格的代码。首先，您创建一个表示整个单元格轮廓的路径。接下来，填充背景 - 很好。然后你抚摸两侧和顶部 - 很好。然后你抚摸单元格的底部 - 很好。然后，您在执行其他部分之前添加并描边您创建的完整轮廓路径 - 不好。

摆脱您创建的路径，不要抚摸该路径。背景、顶线和底线的代码就是您所需要的。

您最后做的额外笔划是用您使用的最后一种颜色（用于底线）重新绘制完整的单元格轮廓。这涵盖了您的顶线笔划。

附带说明一下，您应该使用以下`if-else`设置：

```
if (_position == OTCellBackgroundViewPositionTop) {
    // draw top cell
} else if (_position == OTCellBackgroundViewPositionMiddle) {
    // draw middle cell
} else if (_position == OTCellBackgroundViewPositionBottom) {
    // draw bottom cell
) 
```

当您只需要一个可能的执行路径时，应始终使用这种结构。当可能或需要执行多个路径时，您拥有的结构是合适的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T00:47:14.107

我在想这样的事情可能更易于管理。您必须调整 bezierPath 大小等以获得正确的。

```
UIRectCorner corners = 0;

switch(position) {
  case OTCellBackgroundViewPositionTop:
    corners = UIRectCornerTopLeft | UIRectCornerTopRight;
    break;

  case OTCellBackgroundViewPositionMiddle:
    break;

  case OTCellBackgroundViewPositionBottom:
    corners = UIRectCornerBottomLeft | UIRectCornerBottomRight;
    break;
}

[backgroundColor setFill];
[topLineColor setStroke];

UIBezierPath *bezierPath =   [UIBezierPath bezierPathWithRoundedRect:rect
                                                   byRoundingCorners:corners 
                                                         cornerRadii:CGSizeMake(3.f, 3.f)];

[bezierPath fill];
[bezierPath stroke];

// Now stroke over the lines in a different colour. 
```

# 编辑

查看您发布的代码。

1.  您已将顶线颜色设置为白色 - 因此它是白色的，也许您打算将其设置为您需要的灰色。

2.  正在绘制的轮廓被剪裁。为了解决这个问题，您可以将矩形插入您正在绘制的线条宽度的一半。

    ```
    rect = CGRectInsetRect(rect, 0.5f * kLineWidth, 0.5f * kLineWidth); 
    ```

3.  您需要在描边之前设置描边宽度，否则它将使用默认值

    ```
    [bezierPath setLineWidth:kLineWidth];
    [bezierPath stroke]; 
    ```

# c# - 应用按钮两次进入选择事件

> ID：13214367
> 
> 赞同：2
> 
> 时间：2012-11-03T23:02:27.397
> 
> 标签：c#, windows-phone-7, button

当我单击我的应用程序按钮时，它会进入选择事件处理程序两次。知道为什么吗？

## 前端代码：

```
<phone:PhoneApplicationPage.ApplicationBar>
    <shell:ApplicationBar IsVisible="True" IsMenuEnabled="True">
        <shell:ApplicationBarIconButton IconUri="/Images/appbar_button1.png" 
                                        Text="New"
                                        x:Name="addIconButton"
                                        Click="addIconButton_Click"/>
    </shell:ApplicationBar>
</phone:PhoneApplicationPage.ApplicationBar> 
```

## main的后端代码：

**构造函数：**

```
addIconButton = (ApplicationBarIconButton)ApplicationBar.Buttons[0];
addIconButton.Click +=new EventHandler(addIconButton_Click); 
```

**事件处理程序：**

```
private void addIconButton_Click(object sender, EventArgs e)
{
    MessageBox.Show("enters addIcon Main");
    Note note = new Note();
    note.Modified = DateTimeOffset.Now;

    if (note != null)
    {
        Settings.NotesList.Add(note);
        //Settings.NotesList[0] = note;
    }
    Settings.CurrentNoteIndex = 0;
    this.NavigationService.Navigate(new Uri("/DetailsPage.XAML",UriKind.Relative));

    //DetailsPage mynewPage = new DetailsPage(); 
    //this.Content = mynewPage;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T23:08:28.690

```
Click="addIconButton_Click" //in your Front-end code 
```

然后，

```
addIconButton.Click +=new EventHandler(addIconButton_Click); 
```

您不是刚刚添加了两次点击处理程序吗？

# ios - 在 didSelectRowAtIndexPath 中推送视图时修复空导航控制器？

> ID：13214370
> 
> 赞同：0
> 
> 时间：2012-11-03T23:02:58.350
> 
> 标签：ios, uitableview, uinavigationcontroller

我已经使用 Storyboards 构建了我的表格。我在导航控制器中嵌入了一个表格视图。My Details View 也是嵌入在 Navigation Controller 中的 Table View Controller。这是我的代码：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
  {
    NHCDependantDetailsViewController *detailView = [self.storyboard instantiateViewControllerWithIdentifier:@"AddDependant"];
    [self.navigationController pushViewController:detailView animated:YES];
  } 
```

我发现问题是我的导航控制器为空。不幸的是，我不知道如何或在哪里正确解决这个问题。先感谢您。

**编辑：**我已按照以下建议将导航控制器设置为初始视图控制器，但现在我无法访问我的 TableView。也许问题在我的故事板的这张图片中很明显？有两个导航箭头不可能是好的......

![在此处输入图像描述](../Images/3458cc81e874013e22a116a517bfa774.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T23:17:35.720

我假设您的故事板有 1 个嵌入在导航控制器中的表视图和 NHCDependantDetailsViewController，它也嵌入在导航控制器中。

首先，您需要通过在属性检查器上勾选“是初始视图控制器”将表格视图的导航控制器设置为初始视图控制器。

其次，我认为没有必要将 NHCDependantDetailsViewController 嵌入到导航控制器中，因为您可以将许多视图控制器推送到主导航器控制器。

# java - Invalid info_hash (Java BitTorrent client)

> ID：13214371
> 
> 赞同：1
> 
> 时间：2012-11-03T23:03:01.490
> 
> 标签：java, sha1, bittorrent

according to the specification: [http://wiki.theory.org/BitTorrentSpecification](http://wiki.theory.org/BitTorrentSpecification)

> info_hash: urlencoded 20-byte SHA1 hash of the value of the info key from the Metainfo file. Note that the value will be a bencoded dictionary, given the definition of the info key above.

`torrentMap` is my dictionary, I get the `info` key which is another dictionary, I calculate the hash and I `URLencode` it.

But I always get an `invalid info_hash` message when I try to send it to the tracker.

This is my code:

```
 public String GetInfo_hash() {
    String info_hash = "";

    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    ObjectOutput out = null;
    try {
        out = new ObjectOutputStream(bos);
        out.writeObject(torrentMap.get("info"));
        byte[] bytes = bos.toByteArray();        //Map => byte[]

        MessageDigest md = MessageDigest.getInstance("SHA1");
        info_hash = urlencode(md.digest(bytes));  //Hashing and URLEncoding

        out.close();
        bos.close();

    } catch (Exception ex) {        }

    return info_hash;
}

private String urlencode(byte[] bs) {
    StringBuffer sb = new StringBuffer(bs.length * 3);
    for (int i = 0; i < bs.length; i++) {
        int c = bs[i] & 0xFF;
        sb.append('%');
        if (c < 16) {
            sb.append('0');
        }
        sb.append(Integer.toHexString(c));
    }
    return sb.toString();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T00:05:32.883

这几乎肯定是问题所在：

```
out = new ObjectOutputStream(bos);
out.writeObject(torrentMap.get("info")); 
```

您将要散列的是 的值的*Java 二进制序列化格式*`torrentMap.get("info")`。我很难相信所有的 BitTorrent 程序都应该知道这一点。

从规范中我并不清楚“info”键的值是什么意思，但是您需要找出其他方法将其转换为字节数组。如果它是一个字符串，我希望有一些明确指定的编码（例如 UTF-8）。如果它已经是二进制数据，则直接使用该字节数组。

编辑：实际上，根据您的报价，听起来该值将是一个“编码字典”，看起来它将是一个字符串。在散列可供抓取之前，您打算如何对该字符串进行编码（例如，这听起来可能包括不在 ASCII 中的值）。如果您的示例字符串都是 ASCII，那么使用“ASCII”和“UTF-8”作为编码名称`String.getBytes(...)`无论如何都会给出相同的结果，当然......

# c# - 等待不释放异步方法中的调用线程

> ID：13214373
> 
> 赞同：0
> 
> 时间：2012-11-03T23:03:14.703
> 
> 标签：c#, .net, task-parallel-library, async-await

我在 AsyncDemoViewModel 中打印出 Messages 属性字符串列表。

如果我在 GetVideosSlowlyAsync() 中使用 Thread.Sleep(1000) 输出是

```
Time spent: 4001 milliseconds 

 - Started on thread 18, finished on thread 18  
 - Started on thread 18, finished on thread 18  
 - Started on thread 18, finished on thread 18 
 - Started on thread 18, finished on thread 18 
```

如果我在 GetVideosSlowlyAsync() 中使用 await Task.Delay(1000) 输出是

```
Time spent: 4053 milliseconds 

 - Started on thread 12, finished on thread 19 
 - Started on thread 19, finished on thread 16 
 - Started on thread 16, finished on thread 19 
 - Started on thread 19, finished on thread 9 
```

**为什么等待调用没有释放调用线程？**我预计 await 版本的完成时间会快 4 倍。

控制器代码：

```
public class AsyncDemoController : Controller
{
    private DepartmentDb _db;

    public AsyncDemoController(DepartmentDb db)
    {
        _db = db; 
    }

    public async Task<ActionResult> Index()
    {

        var sw = Stopwatch.StartNew();
        var v1 = await GetVideosSlowlyAsync();
        var v2 = await GetVideosSlowlyAsync();
        var v3 = await GetVideosSlowlyAsync();
        var v4 = await GetVideosSlowlyAsync();

        var vm = new AsyncDemoViewModel() {Videos = v1.Item2, Messages = new List<string>()};
        sw.Stop();
        vm.Messages.Add(string.Format("Time spent: {0} milliseconds", sw.ElapsedMilliseconds));
        vm.Messages.Add(v1.Item1);
        vm.Messages.Add(v2.Item1);
        vm.Messages.Add(v3.Item1);
        vm.Messages.Add(v4.Item1);

        return View(vm);
    }

    private async Task<Tuple<string, IEnumerable<Video>>> GetVideosSlowlyAsync()
    {
        var t1 = Thread.CurrentThread.ManagedThreadId;
        await Task.Delay(1000); // Thread.Sleep(1000);
        var t2 = Thread.CurrentThread.ManagedThreadId;
        return Tuple.Create(string.Format("Started on thread {0}, finished on thread {1}", t1, t2), _db.Videos.AsEnumerable());
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T23:21:37.013

await 方法等待 GetVideosSlowlyAsync 方法完成。您需要将 await 移动到需要操作结果的地方：

```
public async Task<ActionResult> Index()
{

    var sw = Stopwatch.StartNew();
    var v1 = GetVideosSlowlyAsync();
    var v2 = GetVideosSlowlyAsync();
    var v3 = GetVideosSlowlyAsync();
    var v4 = GetVideosSlowlyAsync();

    var vm = new AsyncDemoViewModel() {Videos = (await v1).Item2, Messages = new List<string>()};
    sw.Stop();
    vm.Messages.Add(string.Format("Time spent: {0} milliseconds", sw.ElapsedMilliseconds));
    vm.Messages.Add((await v1).Item1);
    vm.Messages.Add((await v2).Item1);
    vm.Messages.Add((await v3).Item1);
    vm.Messages.Add((await v4).Item1);

    return View(vm);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T23:16:37.963

您正在调用`await GetVideosSlowlyAsync()`它将返回调用方法，直到任务完成。如果你想看到你期望的结果，你需要删除这个等待。这样，当方法在线程池上休眠时，它将`GetVideosSlowlyAsync()`一个接一个地启动所有 4 个。`Task.Delay()`

试试这样的，

```
List<Task> taskList = new List<Task>();
taskList.Add(GetVideosSlowlyAsync());
taskList.Add(GetVideosSlowlyAsync());
taskList.Add(GetVideosSlowlyAsync());
taskList.Add(GetVideosSlowlyAsync());

Task.WaitAll(taskList.ToArray())
foreach (Task task in taskList)
    vm.Messages.Add(task.Result.Item1); 
```

# python - 通用异常处理返回值

> ID：13214377
> 
> 赞同：1
> 
> 时间：2012-11-03T23:03:25.447
> 
> 标签：python, exception-handling

我正在尝试创建通用异常处理程序 - 我可以在其中设置一个 arg 以在发生异常时返回。

而不是这样做：

```
try:
    ...
except Exception:
    return list()

try:
    ...
except Exception:
    return dict()

try:
    ...
except Exception:
    return str() 
```

我想创建一个系统，我有一个通用的异常处理程序，它返回我提供的 arg。例如，

```
def handler(code, default):
    try:
        code
    except Exception:
        return default

def mains():
    code = <code to execute>
    default = str()
    return handler(code, dafault) 
```

但以更蟒蛇的方式

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T23:09:33.307

一个简单的装饰器将为您完成此操作。

```
import functools

def catch_wrap(on_err):
    def wrapper(func):
        @functools.wraps(func)
        def inner(*args, **kw):
            try:
                return func(*args, **kw)
            except Exception:
                return on_err
        return inner
    return wrapper 
```

一个简短的例子：

```
@catch_wrap('SPAM!')
def doer():
    """
    YUP
    """
    1 / 0
    return 'EGGS!'

print doer()
print doer.__doc__ 
```

# javascript - jquery计数到数字

> ID：13214384
> 
> 赞同：0
> 
> 时间：2012-11-03T23:05:53.167
> 
> 标签：javascript, jquery

我有一段代码从 0 计数到具有指定延迟的指定数字。

问题是它加 1，我希望它加 0.01

怎么做？代码如下：

```
 <!DOCTYPE HTML>
<html>
<head>
<style>body{font:11px verdana;color:#555;}</style>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript">
var max = 20;// set with php
$(incCounter);
function incCounter() {
    var currCount = parseInt($('.counter').html());
    $('.counter').text(currCount+1);
    if (currCount+1 != max) {
        setTimeout(incCounter,50);
    }
}
</script>
</head>
<body>
<div class="counter">0</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T23:09:49.960

我还没有测试过这个，但尝试...

```
function incCounter() {
    var currCount = parseFloat($('.counter').html());
    currCount += .01;
    $('.counter').text( currCount.toFixed(2) );
    if (currCount < max)
        setTimeout(incCounter,50);
} 
```

[**JS Fiddle**](http://jsfiddle.net/GPhmN/)玩。

# c# - 为产品列表创建类

> ID：13214386
> 
> 赞同：1
> 
> 时间：2012-11-03T23:06:09.627
> 
> 标签：c#, asp.net

我有这个`GridView`我正在尝试将数据绑定到，我需要使用我的所有属性创建一个新类并将它们显示在`Grid`. 这应该是一个列表集合吗，因为我尝试了一个列表，但`Grid`无法在列表中找到名称。

我通常不处理收藏品。所以，我对它不是很熟悉。我只需要一些关于这应该如何的指导。我知道我的收藏需要一个类，我的属性是字符串。

```
//This is where I am stuck, not sure how to set these and put these in a list.
public class Product
{
    string Title;
    string SmallImage;
} 
```

```
<form id="ResultsForm" runat="server">
    <div id="SearchBox">
        <asp:TextBox ID="SearchBoxText" runat="server" Height="20px" Width="400px"></asp:TextBox>
        <asp:Button ID="SearchButton" runat="server" Height="30px" Width="100px" Text="Search" OnClick="SearchButton_Click" />
    </div>

    <div id="ResultsTable">
        <asp:GridView runat="server" ID="myGrid" 
                      OnRowCommand="MyGrid_RowCommand">
            <Columns>
                <asp:TemplateField>
                    <ItemTemplate>
                        <img src='<%#Eval("SmallImage") %>' />
                    </ItemTemplate>
                </asp:TemplateField>

                <asp:TemplateField>
                    <ItemTemplate>
                        <div>Title: <%#Eval("Title") %>  </div>
                        <div>Weight: <%#Eval("Weight") %>  </div>
                        <asp:Button runat="server" ID="GetOfferButton" CommandArgument='<%#Eval("OfferID") %>'></asp:Button>
                    </ItemTemplate>
                </asp:TemplateField>
            </Columns>
        </asp:GridView>
    </div>
</form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T23:16:01.303

1）在单独的文件中创建类......像Product.cs

```
 public class Product
    {

        public string Title { get; set; }
        public string SmallImage { get; set; }
    } 
```

2）在你的 aspx.cs

```
 protected void Page_Load(object sender, EventArgs e)
            {

                if(!Page.IsPostBack)
                {
                 List<Product> lst = new List<Product>();
                 lst.Add(new Product(){Title="title 1", SmallImage = "some path"});
                 lst.Add(new Product(){Title="title 2", SmallImage = "some "});
                 myGrid.DataSource = lst;
                 myGrid.DataBind();
                }

            } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T23:19:08.037

假设您的类被调用`Product`并具有以下两个属性：

```
public class Product{
    string Title;
    string SmallImage;
} 
```

您必须在代码隐藏中的某处声明此类，最好在页面的代码隐藏文件之外的另一个文件中声明（因为您可能希望在其他地方重用该类）。

现在您必须填写`List<Product>`此 aspx 页面的代码隐藏文件。我会建议`Page_Load`。

[请注意，您应该只这样做`if(!IsPostBack)`，否则您将覆盖用户所做的所有更改并阻止触发事件。]

然后你需要使用这个列表作为`DataSource`和`GridView`它`DataBind`之后。

```
protected void Page_Load(object sender, EventArgs e) 
{
    if(!Page.IsPostBack)
    {
        List<Product> list = new List<Product>();
        Product prod = new Product();
        // set the properties
        list.Add(prod);
        // add other products
        gridView1.DataSource = list;
        gridView1.DataBind();
    }
} 
```

# sql - 我可以为包含引用表中不存在的元素的表创建外键吗？

> ID：13214391
> 
> 赞同：2
> 
> 时间：2012-11-03T23:06:46.893
> 
> 标签：sql, database, postgresql

我正在处理一项希望我在表上编写一些参照完整性约束的任务。它要求我确保结果中的每场战斗也在战斗中提及，并通过将引用值设置为 NULL 来处理所有违规行为。

我正在使用以下模式

```
Battles(
    name VARCHAR(255) PRIMARY KEY, 
    date VARCHAR(255), 
)
Outcomes(
    ship VARCHAR(255),
    battle VARCHAR(255),
    RESULT VARCAHR(255),
    PRIMARY KEY(ship, battle)
) 
```

我正在尝试像这样添加foregin键：

```
alter table outcomes 
add foreign key (battle) 
references battles(name) 
on delete set null 
on update cascade; 
```

我收到以下错误：

```
SQL error:

ERROR:  insert or update on table "outcomes" violates foreign key constraint "outcomes_battle_fkey"
DETAIL:  Key (battle)=(Pearl Harbor 
```

我知道这是因为“珍珠港”在 OUTCOMES 但不在 BATTLES 中，我想知道是否有某种方法可以忽略这一事实并设置外键？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T23:23:18.167

> 并通过将引用值设置为 NULL 来处理所有违规行为。

这是不可能的，因为`battle`它是 PK 的一部分，`Outcomes`所以它不能为 NULL。您的数据模型根本不是为了处理“无战斗”结果而构建的。

* * *

如果您要更改模型并`battle`从子表的 PK 中删除，那么您可以通过以下方式“修复”数据：

```
UPDATE Outcomes SET battle = NULL
WHERE battle NOT IN (SELECT battle FROM Battles) 
```

此时，您将能够创建 FK 而不会导致违规（FK 仅在非 NULL 字段上强制执行）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T23:14:13.853

您必须寻找一个选项，以防止在创建密钥时进行检查，对于 Sql Server，它会是`WITH NOCHECK`：

> 指定是否针对新添加或重新启用的 FOREIGN KEY 或 CHECK 约束验证表中的数据。如果未指定，则假定 WITH CHECK 用于新约束，而 WITH NOCHECK 假定用于重新启用的约束。

# java - 将文件从 Struts/JSP 上传到数据库中的 PostgreSQL 大对象 ("lo"/"oid")

> ID：13214397
> 
> 赞同：1
> 
> 时间：2012-11-03T23:07:31.127
> 
> 标签：java, jsp, postgresql, struts

我有一个使用 PostgreSQL、JSP 和 STRUTS 框架的应用程序

我想使用 OID 类型将文件插入到 PostgreSQL 中的表中，因此它作为一个大对象存储在数据库中。

我的表定义是这个：

```
CREATE TABLE mensaje
(
  id serial NOT NULL,
  file oid,
  CONSTRAINT pk_mensaje PRIMARY KEY (id)
)
WITH (
  OIDS=TRUE
);
ALTER TABLE mensaje
 OWNER TO postgres; 
```

有人知道`Action`, the`ActionForm`和 the`.jsp`应该如何的例子吗？

如果没有，是否有任何其他示例可以解释如何在不使用 OID 类型的情况下执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T23:16:52.233

这是解决问题的两步过程：

1.  [使用 Struts 2 上传文件](http://struts.apache.org/2.0.14/docs/file-upload.html)
2.  [PostgreSQL Java 教程](http://zetcode.com/db/postgresqljavatutorial/)，查看*编写图像*部分。

附加说明：在您的操作中收到文件后，您应该使用字节数组数据将其保存在您的`OID`字段中。

* * *

根据您的评论，这应该是 Struts 1.x 中的方式

在 JSP 中

```
<html:form action="fileUploadAction" method="post" enctype="multipart/form-data">
    File : <html:file property="upload" /> 
    <br />
    <html:submit />
</html:form> 
```

在你的行动课上

```
YourForm uploadForm = (YourForm) form;
FormFile file = null;
try {
    file = uploadForm.getFile();
    //FormFile#getFileData() returns the byte array containing the file data
    //You can use it to save the file in your database and other things you want/need
    int id = 9001; //assuming this is a valid id in the mensaje table
    MensajeService mensajeService = new MensajeService();
    mensajeService.saveFile(id, file.getFileData());
} catch (Exception e) {
    //log the errors for maintenance purposes (bugs, fixes, etc) 
} 
```

该类`MensajeService`将连接到您的 Postgre 数据库并保存文件

```
public class MensajeService {

    public MensajeService() {
    }

    public void saveFile(int id, byte[] fileData) throws SQLException {
        //this is a very simple skeleton, you have to adapt this to 
        //your needs, the way you're connecting to dabatase, etc...
        Connection con = null;
        PreparedStatement pstmt = null;
        try {
            con = ... //get the connection to your postgre db

            //Initialize a new transaction
            con.setAutoCommit(false);
            // Get the Large Object Manager to perform operations with
            LargeObjectManager lobj = ((org.postgresql.PGConnection)conn)
                .getLargeObjectAPI();
            // Create a new large object
            int oid = lobj.create(LargeObjectManager.READ | LargeObjectManager.WRITE);
            // Open the large object for writing
            LargeObject obj = lobj.open(oid, LargeObjectManager.WRITE);
            //in the provided example, the code shows a way to get the byte array data
            //from the file (using the File and FileInputStream classes)
            //you don't need all that because you already have the byte array (good!)
            //so you only write the binary data in your LargeObject (OID) object
            obj.write(fileData);

            //creating the SQL statement to insert the OID
            String sql = "INSERT INTO mensaje VALUES (?, ?)";
            pstmt = con.prepareStatement(sql);
            pstmt.setInt(1, id);
            ps.setInt(2, oid);
            //
            pstmt.setBinaryStream(2, fin, (int) img.length());
            //saving the file
            pstmt.executeUpdate();
            //closing the transaction successfully
            con.commit();
        } catch (SQLException e) {
            //error in the transaction, start a rollback
            if (con != null) {
                con.rollback();
            }
            throw e;
        } finally {
            //don't forget to free the resources after using them
            pstmt.close();
            con.close();
        }
    }
} 
```

Struts 1 代码改编自：[Uploading a file in struts1](https://stackoverflow.com/q/8255244/1065197)。

PostreSQL 代码改编自[这里](http://jdbc.postgresql.org/documentation/80/binary-data.html)。

# javascript - 从 URL 复制所有文本并存储在对象中

> ID：13214404
> 
> 赞同：0
> 
> 时间：2012-11-03T23:07:58.843
> 
> 标签：javascript, json, url, text, readfile

我需要从 JSON 文件的 URL 中复制文本。我需要简单的 javascript，我不能使用 AJAX 调用，因为我有相同的来源策略错误。

链接如下： [http ://webapp.armadealo.com/home.json?within=50&lng=-71.071123&lat=42.3526751](http://webapp.armadealo.com/home.json?within=50&lng=-71.071123&lat=42.3526751)

我需要将上述链接中的所有内容存储在一个变量中，比如说`var allText`

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T23:10:21.580

> 我不能使用 AJAX 调用，因为我有相同的来源策略错误。

然后，您无法通过客户端 JavaScript 直接获取文本，句号（除非托管的服务器支持[CORS](http://www.w3.org/TR/access-control/)并允许来自您的源的请求，*并且*您使用的是支持 CORS 的浏览器）。您也许可以[使用 YQL 作为代理](http://ajaxian.com/archives/using-yql-as-a-proxy-for-cross-domain-ajax)，但除此之外，您将需要自己的服务器端代理。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-03T23:10:29.747

尝试这个

```
var pathname = window.location.pathname; 
```

# css - iframe srcdoc 的替代品？

> ID：13214419
> 
> 赞同：17
> 
> 时间：2012-11-03T23:09:59.667
> 
> 标签：css, html, iframe

一般来说，我反对使用 iframe，但它解决了我的一个特定问题。

问题是我在网页上有一个 tinyMCE 编辑器。用户使用此编辑器制作内容后，内容将作为 HTML 发送到 Web 应用程序。这个内容然后显示在一个 div 中。问题是 tinyMCE 经常添加**具有绝对位置的样式**以及与 Web 应用程序的其余部分相冲突的东西。

在测试时，我发现新的 HTML 5`iframe srcdoc="<p>Some HTML</p>"`非常`seamless="true"`适合我的情况。它看起来无缝，内容风格和我的风格完好无损。遗憾的是，我现在看到 Android 尚不支持 HTML5 srcdoc 属性（[http://w3schools.com/html5/tryit.asp?filename=tryhtml5_iframe_srcdoc](http://w3schools.com/html5/tryit.asp?filename=tryhtml5_iframe_srcdoc)在 chrome 和 android 浏览器中产生不同的结果）。

所以问题是：是否有任何替代 iframe srcdoc 的方法可以保留接收到的内容的所有样式并将其包含在 div 中？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-07-17T18:21:46.983

您可以像这样写入 iframe 的文档：

```
const html = '<body>foo</body>';
const iframeDocument = document.querySelector('iframe#foo').contentDocument;
const content = `<html>${html} </html>`;
iframeDocument.open('text/html', 'replace');
iframeDocument.write(content);
iframeDocument.close(); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-04T12:01:55.583

正如 eicto 通过评论所建议的那样，jquery 可用于在就绪事件中填充 iframe。为了将 iframe 的高度调整为内容的高度，必须应用一些肮脏的技巧，但我最终使用的代码或多或少是：

**HTML**

```
<!-- IMPORTANT! Do not add src or srcdoc -->
<!-- NOTICE!    Add border:none to get a more "seamless" integration -->
<iframe style="border:none" scrolling="no" id="myIframe">
    Iframes not supported on your device
</iframe> 
```

**JS**

```
// Wait until iFrame is ready (body is then available)
$('#myIframe').ready(function() {

    var externalHtml = '<p>Hello World!</p>';

    // Find the body of the iframe and set its HTML
    // Add a wrapping div for height hack
    // Set min-width on wrapping div in order to get real height afterwords
    $('#myIframe').contents().find('body')
        .html('<div id="iframeContent" style="min-width:'+$('body').width()+'px">'
            +externalHtml
            +'</div>'
    );

    // Let the CSS load before getting height 
    setTimeout(function() {
        // Set the height of the iframe to the height of the content
         $('#myIframe').css('height', 
             $('#myIframe').contents()
             .find('#iframeContent').height() + 'px' 
         );
    },50);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-20T16:37:50.547

使用新的[数据 URI 方案](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs)。例子：

```
var content = "<html></html>";
document.getElementById("my_iframe_id").src = "data:text/html;charset=UTF-8," + content;
```

# java - 如何在方法中重新分配引用？

> ID：13214422
> 
> 赞同：0
> 
> 时间：2012-11-03T23:10:27.563
> 
> 标签：java, methods, reference, linked-list, singly-linked-list

我有一个使用“ListNode”类对象的链接列表

ListNode 具有以下非静态方法：

```
getValue()
setValue(Object obj)
getNext()
setNext(ListNode ln) 
```

它的构造函数接受一个值和一个下一个。

在我的驱动程序类的主要方法中，创建我的链表：

```
ListNode head = new ListNode("Overflow!", null);
head = new ListNode("Stack", head);
head = new ListNode("in", head);
head = new ListNode("is", head);
head = new ListNode("This", head); 
```

我有一个方法叫`printList(ListNode ln)`.

我在我的主要方法中连续调用它两次，如下所示：

```
printList(head);
System.out.println();
printList(head); 
```

我的方法如下所示：

```
public static void printList(ListNode head)
{
    while(head != null)
    {
        System.out.print(head.getValue()+" ");
        head = head.getNext();
    }
} 
```

在我的方法中，每次在 while 循环中将引用更改为指向不同的对象。所以在我退出方法后，引用“head”应该指向一个空值，对吧？但是，当第二次调用 printList(head) 时，它会神奇地打印列表中的所有元素！

这是 jGrasp 控制台显示的内容：

```
 ----jGRASP exec: java StackOverflowQuestionExampleClass

This is in Stack Overflow! 
This is in Stack Overflow! 
 ----jGRASP: operation complete. 
```

这是我的老师告诉我使用的 listnode 类：

```
//Thomas Bettge, TJHSST, 10-20-2006
    public class ListNode
   {
      private Object value;
      private ListNode next;
       public ListNode(Object v, ListNode n)
      {
         value=v;
         next=n;
      }
       public Object getValue()
      {
         return value;
      }
       public ListNode getNext()
      {
         return next;
      }
       public void setValue(Object newv)
      {
         value=newv;
      }
       public void setNext(ListNode newn)
      {
         next=newn;
      }
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T23:14:44.103

`head`是方法 print 中的本地引用。重新分配给它不会影响`head`方法外的引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T01:24:31.030

混淆可能源于您有 2 个具有相同名称“head”的标签。printList 方法中的“head”参数是对传入对象的新引用。重新分配它不会影响原始引用的目标（从某种意义上说，t 不会导致它引用其他东西。一个旁白：改变被引用对象的*状态*会产生影响，因为它是同一个对象，不管引用它的是什么）。

可能会更清楚地查看您的代码，如下所示：

```
public void yourMainMethod() {
    ListNode head = new ListNode("Overflow!", null);
    head = new ListNode("Stack", head);
    head = new ListNode("in", head);
    head = new ListNode("is", head);
    head = new ListNode("This", head);

    printList(head);
    System.out.println();
    printList(head);
}

//note different name, to clarify this is a separate reference
public static void printList(ListNode node) {
    while(node != null)
    {
        System.out.print(node.getValue()+" ");
        node = node.getNext();

        //node.setValue(new Object());//note that this would change the state inside the ListNode passed in
    }
} 
```

# php - 贝宝整合混乱

> ID：13214424
> 
> 赞同：0
> 
> 时间：2012-11-03T23:10:38.587
> 
> 标签：php, paypal

我正在设计一个向学生销售课程的数据库系统。这一切都在 PHP 中完成。我想在我的网站上使用 Paypal 付款，并且做了一些研究，我需要 IPN。

我一直在阅读有关如何从 www.x.com 实现这一目标的文档/指南，但是找到我需要的信息非常令人困惑，因为似乎有不止一种方法可以做某事。IPN 的东西看起来很简单，paypal 只需要唯一的发票号码，通知脚本使用它来检索记录并将适当的响应发布到数据库中，如果一切顺利，将页面重定向到谢谢。

问题是我最初将我的值发送到 Paypal 的方法是什么，我真的不想传递数量和运输数据，因为所有这些数据都无关紧要，我不希望我的最终用户看到。我必须开始考虑使用 paypal api 吗？

感谢您的建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T23:17:00.977

由于您的问题似乎是“我应该从哪里开始寻找与 php 的良好贝宝集成”，所以我会给您一些一般性的“建议”。几个月前我遇到了同样的问题。

是的，您必须阅读贝宝文档，不幸的是，它们没有清晰的天赋.. 非常完整，但我发现它们不是很清楚。然而，这个 php 类对我的类似项目非常有帮助：[https](https://github.com/Quixotix/PHP-PayPal-IPN) ://github.com/Quixotix/PHP-PayPal-IPN希望也能帮助你。

这些文章/类/文档也很有帮助（但最后我没有使用它们）以清除我对 PP 集成的想法： http: [//drewjoh.com/wiki/code/classes/phppaypal](http://drewjoh.com/wiki/code/classes/phppaypal) http://www .geekality.net/2011/05/28/php-tutorial-paypal-instant-payment-notification-ipn/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T23:17:51.633

设置一个沙盒帐户[https://developer.paypal.com/](https://developer.paypal.com/)
然后通过[一些教程](https://www.x.com/developers/paypal/documentation-tools/how-to-guides/how-accept-basic-digital-goods-payment-using-express-checkout)
您还需要设置一些测试帐户，注意左侧的导航（来自开发人员页面）。它拥有你需要的一切

# c# - ImportMany 的 MEF 加载合同两次

> ID：13214429
> 
> 赞同：1
> 
> 时间：2012-11-03T23:11:50.093
> 
> 标签：c#, .net, wpf, mef, caliburn.micro

我有两个 Exports 类`IScreen`，但是当我使用导入相同的类时

```
[ImportMany(typeof(IScreen))]
private IEnumerable<Lazy<IScreen,IJIMSMetadata>> _modules;
public IEnumerable<Lazy<IScreen, IJIMSMetadata>> Modules
{
        get { return _modules; }
} 
```

模块包含四个 IScreen 实例，但我只导出了两个。

这是容器

```
container = new CompositionContainer(
                new AggregateCatalog(AssemblySource.Instance.Select(x => new AssemblyCatalog(x)))                
                );

protected override IEnumerable<Assembly> SelectAssemblies()
{
    string _modulePath = Path.Combine(Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location), "Modules");
    var files = Directory.GetFiles(_modulePath, "*.dll", SearchOption.AllDirectories);

    List<Assembly> assemblies = new List<Assembly>();
    assemblies.Add(Assembly.GetExecutingAssembly());
    foreach (var file in files)
    {
        assemblies.Add(Assembly.LoadFrom(file));
    }
    return assemblies;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-14T20:29:22.343

由于您使用的是 AggregateCatalog，因此请检查以确保您没有为包含正在执行的程序集的位置添加 AssemblyCatalog 和 DirectoryCatalog。

例如，以下代码避免了两次处理相同的程序集。

```
var catalog = new AggregateCatalog();
var locations = new List<string>();
foreach (var loc in GetPluginDirectories())
    if (!locations.Contains(loc))
    {
        catalog.Catalogs.Add(new DirectoryCatalog(loc));
        locations.Add(loc);
    }

var asm = Assembly.GetExecutingAssembly();
if (!locations.Contains(Path.GetDirectoryName(asm.Location)))
    catalog.Catalogs.Add(new AssemblyCatalog(asm)); 
```

# html - 为什么浏览器窗口调整大小时正文宽度不设置为 100%？

> ID：13214433
> 
> 赞同：1
> 
> 时间：2012-11-03T23:12:43.520
> 
> 标签：html, css

例如，让我们看一下 Twitter 引导程序的主页[http://twitter.github.com/bootstrap/index.html](http://twitter.github.com/bootstrap/index.html)

如果我将浏览器窗口大小调整为 400 像素，我会在右侧看到奇怪的空间（看图片）。

![在此处输入图像描述](../Images/24872432e87b421c2266befabb1ae0aa.png)

另一个示例是 StackOverflow。在浏览器调整灰色背景的标题行时，不要调整到所有屏幕（见下文）。

![在此处输入图像描述](../Images/4937bc8835bd4fc7846ff9efa8a118d6.png)

为什么 body 不调整到浏览器窗口的 100%？我的网站上有类似的问题

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T23:25:42.467

当您使浏览器窗口小于内容的最小宽度并水平滚动时，就会出现此问题。设置为 100% 宽度的元素是宽度的 100%，直到您水平滚动，它们似乎被截断。

解决方案是在这些元素上设置 a `min-width`，使它们至少与内容一样宽。

这是一个例子：

HTML

```
<div id="header1">Broken header</div>
<div id="header2">Fixed header</div>
<div id="content">
  content goes here.
</div> 
```

CSS

```
#header1 {
  background-color:#ccc;
  border: 2px solid #00F;
}

#header2 {
  background-color:#ddd;
  min-width: 600px;
  border: 2px solid #0F0;
}

#content {
  width: 600px;
  border: 2px solid #F00;
} 
```

[**演示**](http://jsbin.com/ifinix/1)

类似的问题：

*   [100% 宽度的 bg 图像不在水平滚动上延伸](https://stackoverflow.com/questions/3042979/100-width-bg-images-not-extending-on-horizontal-scroll)
*   [CSS：水平滚动时背景不存在](https://stackoverflow.com/questions/2426050/css-background-absent-when-scrolling-horizontally)
*   [水平滚动时页脚未拉伸 100%](https://webmasters.stackexchange.com/questions/5064/footer-not-stretching-100-when-horizontally-scrolled)
*   [当显示比视口更宽的内容时，如何避免我的页眉和页脚被破坏？](https://stackoverflow.com/questions/4226376/how-can-i-avoid-my-headers-and-footers-being-broken-when-displaying-content-wide)

# entity-framework-5 - Entity Framework 5 Code first 自定义键逻辑？

> ID：13214434
> 
> 赞同：0
> 
> 时间：2012-11-03T23:12:52.400
> 
> 标签：entity-framework-5

我有一个实体（实际上是几个），我希望在创建它们时根据自定义逻辑为其分配一个键值。我知道我可以在实体构造函数中执行此操作，但理想情况下，我希望在创建新实体时将其作为数据上下文逻辑的一部分。

我找到了如何关闭自动生成，但我宁愿用我自己的逻辑替换自动生成，理想情况下由 C# 代码处理（我也看到了通过存储过程完成它的技术，我宁愿不使用）。

这甚至可以集中进行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T02:30:18.737

自动生成发生在服务器端，而不是由 EF 完成。这是对表键列的设置。所以 EF 不生成任何密钥 - 如果自动生成打开，这是生成密钥的数据库，如果自动生成关闭，这是负责生成密钥的用户。如果您不想在保存更改时生成密钥，您可能需要覆盖 SaveChanges 并为所有新添加的实体生成密钥。

# fabricjs - Canvas.observe 似乎没有效果

> ID：13214436
> 
> 赞同：0
> 
> 时间：2012-11-03T23:12:59.910
> 
> 标签：fabricjs

我写过这个：

```
// canvasRoot is a Canvas object
canvasRoot.observe('mouse:down', function() {console.log('<mouse down event>')}); 
```

但是，如果我单击画布上的任意位置，似乎不会触发该事件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T00:15:48.947

检查 canvasRoot 是实际的 fabric.Canvas 还是 DOM 画布节点 ^_^

您还应该使用 canvas.on(...) 而不是 canvas.observe(...) [同样的功能]

此外，如果要将事件附加到 fabric.Canvas 对象，则应将它们附加到画布的**“mousedown”**与**“mouse:down”**。

查看源代码以获取更多信息:)

# algorithm - 按升序或降序排序（任意选择；以便宜者为准）

> ID：13214438
> 
> 赞同：5
> 
> 时间：2012-11-03T23:13:21.013
> 
> 标签：algorithm, sorting

我有一个元素数组。这个数组可以是：

*   随机洗牌（大约 20% 的时间）
*   几乎按升序排序*（大约 40% 的时间）
*   几乎按降序排序（大约 40% 的时间）

但我不知道（提前）这些案例中的哪一个适用。我更愿意将数组排序为它已经接近的顺序。

输出是升序还是降序无关紧要，但它必须是一个或另一个（所以我可以对其执行二进制搜索。）

排序不必是稳定的。

* * *

一些背景信息：该过程大致如下：

*   填充数组
*   对某个属性 A 进行排序
*   做一些处理（计算分位数和其他一些小东西）
*   按其他属性 B 排序
*   做更多的处理
*   按属性 C 排序
*   做更多的处理

A 和 B 通常相互关联（但可能是正的或负的）。同样适用于 B 和 C。偶尔 A == C。

* 这里的“几乎排序”意味着大多数元素都接近它们的最终位置。但很少准确地位于它们的最终位置（有很多附加噪声，并且没有多少长排序的子序列。）仍然，在数组的开头和结尾通常有一些“异常值”，它们是顺序的不良预测指标下一种。 

* * *

有没有一种算法可以利用我不偏好升序和降序这一事实，以更便宜地进行排序（与我目前使用的 TimSort 相比？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T23:17:12.163

我会继续使用 Timsort （但是，一个很好的选择是[Smoothsort](http://en.wikipedia.org/wiki/Smoothsort) ^*），但首先探测数组以决定是按升序还是降序排序。查看第一个和最后一个元素并进行相应的排序。如果数组未排序，则选择无关紧要；如果它是（部分）排序的，则以较宽的间隔进行探测更有可能正确检测到哪种方式。

^* Smoothsort 与 Timsort 具有相同的最佳、平均和最坏情况时间，以及更好的空间复杂度。与 Timsort 一样，它专门设计用于利用部分排序的数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T23:35:17.020

另一种考虑的可能性：

*   开始进行（手动）插入排序
*   当你走的时候，计算你执行的反转次数
*   在您完成了一些固定的少量插入后，将您计算的反转次数与如果数据开始反向排序到该点将发生的最大反转次数进行比较：
*   如果该比例接近 0，则（可能）数据接近排序。完成插入排序，它在几乎排序的数据上表现得非常好。如果你不喜欢“可能”的声音，那么继续计算反转，如果它低于阈值，则准备好回退到 Timsort。
*   如果比例接近 1，那么（可能）数据几乎是反向排序的，并且您在开始时有少量排序的元素。将它们移到最后，将它们反转，并使用反向比较器完成插入排序。
*   Otherwise the data is random, use your favourite sorting algorithm. I'd say Timsort, but since that does well on nearly-sorted data there *must* be some other algorithm that does at least a tiny bit better than Timsort does on uniformly-shuffled data. Probably plain merge sort without the Tim.

The "small fixed number" can be a number for which insertion sort is fairly fast even in bad cases. I would guess 10-20 or so. It's possible to work out the probability of a false positive in uniformly shuffled data for any given number of insertions and any given threshold of "close to 0/1", but I'm too lazy.

You say the first and last few array elements typically buck the trend, in which case you could exclude them from the initial test insertion sort.

显然，这种方法在某种程度上受到了 Timsort 的启发。但是 Timsort 对包含运行的数据进行了极其优化——我试图只对接近一次大运行（在任一方向）的数据进行极其优化。Timsort 的另一个特点是它经过了很好的测试，我不声称要分享这一点。

# haskell - `Ord` 实例 `on` 一些函数

> ID：13214440
> 
> 赞同：3
> 
> 时间：2012-11-03T23:13:39.393
> 
> 标签：haskell, typeclass

我想`Ord`为一个数据类型编写一个实例，`Foo`它将所有比较委托给一个函数`bar :: Foo -> Bar`，其中`Bar`一个数据类型有一个`Ord`可用的实例。

如果我手动编写此实例，它看起来像：

```
instance Ord Foo where
  compare x y
    | bar x == bar y = EQ
    | bar x <= bar y = LT
    | otherwise      = GT 
```

有没有更简洁的方法来写这个？

* * *

在 Scala（使用 Scalaz）中，我可以编写：

```
 implicit val FooOrder: Order[Foo] = Order[Bar] contramap bar 
```

Haskell有类似的东西吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-03T23:17:31.443

```
import Data.Ord

instance Ord Foo where
    compare = comparing bar 
```

是我能想到的OTTOMH最简洁的版本。

稍微不那么简洁，但更好地概括是

```
import Data.Function

instance Ord Foo where
    compare = compare `on` bar 
```

# php - 在 MySQL 中查询多个表

> ID：13214442
> 
> 赞同：0
> 
> 时间：2012-11-03T23:13:44.567
> 
> 标签：php, mysql, database

我正在尝试根据下拉菜单中选择的内容从多个表中获取数据。我的下拉菜单包含一个 ID 列表（001、002 等）。

一旦用户选择其中之一，我将使用 AJAX 根据选择的内容动态获取数据。我能够根据选择的内容获取单个值，但在涉及多个表时会出现问题。

我的表是这样设置的：

**库存**表：

```
inven_ID (primary)
cost
description 
```

**订单**表：

```
order_ID(primary)
orderdesc 
```

**销售**表：

```
inven_ID
order_ID
quantity
primary(inven_ID,order_ID) 
```

我的查询如下：

```
$QRY = "SELECT 
          inven_ID, 
          order_ID, 
          cost, 
          description 
        FROM 
          Inventory, 
          Order, 
          Sale 
        WHERE Inventory.inven_ID = Sale.inven_id 
        AND Sale.order_ID = Order.order_ID 
        AND Order.order_ID ='".$q."'"; 
```

`$q`代表下拉菜单中的值（我检查过是有效的）。我收到错误`inven_ID`字段列表中的列“”不明确。基本上，当他们从下拉列表中选择某个订单 ID（比如 001）时，它会`order_ID`在我的订单表中查找，并获取该特定订单 ID 的 inven_ID/cost/description。

例如。如果有人以 10、20、30 的价格订购了零件 xy、yz、xyz。

```
Selecting 001 would bring up:
001 xy 10
001 yz 20
001 xyz 30 
```

我认为我没有正确加入表格，因为错误表明它模棱两可。

对此有什么帮助吗？

编辑：是的，解决了这个问题，很明显我没有抓住它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T23:18:09.977

在您选择的列列表中，您只需要指定要检索的 inven_ID 即可。例如：

```
SELECT Inventory.inven_ID, ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T23:18:30.647

错误非常明显。inven_ID 是模棱两可的，因为你有它 in`Sale`和 in `Inventory`。使用类似`Sale.inven_ID`or的说明符`Inventory.inven_ID`。

# android - 重新启动我的应用程序

> ID：13214448
> 
> 赞同：-6
> 
> 时间：2012-11-03T23:14:18.250
> 
> 标签：android, android-intent

我正在构建一个带有 3 个“生命”和一个计时器的小游戏。当生命结束或计时器为零时，我告诉它去“游戏结束”活动。在游戏结束时，我有一个“重试”按钮，它会将您发送到欢迎活动，您可以重新开始。问题是我认为上一场比赛的计时器仍在运行，因为它会在下一场比赛中进入游戏结束活动，即使计时器和生命都可以。

当有人按下“重试”时，我可以通过什么方式将应用程序重置为启动模式？

谢谢 ：）

编辑：我的代码：这是时间结束并进入游戏结束活动的时间，

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_test);
    ImageView iv =(ImageView) findViewById(R.id.imageView1);
    final TextView mTextField = (TextView) findViewById(R.id.textView2);
    CountDownTimer one = new CountDownTimer(30000, 1000) {

     public void onTick(long millisUntilFinished) {
         mTextField.setText("time: " + millisUntilFinished / 1000);
     }

     public void onFinish() {

         toGameOver(null);

     }
  }.start();

}

public void toGameOver (View view)
{
    Intent intent = new Intent(this,GameOverActivity.class);
    intent.putExtra(EXTRA_MESSAGE, points.toString());
    startActivity(intent);

} 
```

这是生命结束并进入游戏结束活动的时间：

```
public void changepic(View view)
{
    boolean isCorrect=false;
    int n = 8;
    ImageView iv =(ImageView) findViewById(R.id.imageView1);
    TextView tv = (TextView) findViewById(R.id.textView1);  
    if(rndInt<3&&rndInt>0){
        isCorrect=true;
        points++;
    }

    if(!isCorrect&&lives==0)
        toGameOver(null);
    if (!isCorrect&&lives==1&&rndInt!=0)
    {
        lives--;
        ImageView iv1 = (ImageView) findViewById(R.id.imageView3);
        iv1.setVisibility(View.INVISIBLE);
    }
    if (!isCorrect&&lives==2&&rndInt!=0)
    {
        lives--;
        ImageView iv1 = (ImageView) findViewById(R.id.imageView4);
        iv1.setVisibility(View.INVISIBLE);
    }
    if (!isCorrect&&lives==3&&rndInt!=0)
    {
        lives--;
        ImageView iv1 = (ImageView) findViewById(R.id.imageView2);
        iv1.setVisibility(View.INVISIBLE);
    } 
```

当我希望它开始时，这是在游戏过度活动中：

```
public void goToStart (View view)
{
    Intent intent = new Intent(this,WelcomeActivity.class);
    startActivity(intent);

} 
```

很抱歉在询问时没有发布

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T02:00:13.827

如果你想在游戏结束时停止计时器，那么在函数 toGameOver() 内部你需要调用 one.cancel() ，这将导致计时器被取消。然后当游戏重新开始时，你应该调用 one.start()

# jquery - 鼠标输入事件功能在 Firefox 中不起作用

> ID：13214453
> 
> 赞同：0
> 
> 时间：2012-11-03T23:15:38.963
> 
> 标签：jquery

我有这张图片：

```
<img src="..." class="scroller_poster" alt="Some information about movie"> 
```

...并且我正在尝试在页面其他位置的 DIV 中显示 ALT 中的值：

```
<div class="scroller_movie_data"></div> 
```

...使用此函数（包含在 $(document).ready 中）：

```
$('.scroller_poster').mouseenter(function() {
    var movie_data = $(this).attr('alt');
    if (movie_data) {
        $('.scroller_movie_data').html(movie_data);
        $(this).mouseleave(function() {
            $('.scroller_movie_data').html('');
        });
    }
}); 
```

这适用于除 Firefox 之外的所有浏览器，我不知道为什么。有人可以对此有所了解吗？

**笔记：**

悬停的图像位于 jQuery 插件 ( [SmoothDivScroll](http://www.smoothdivscroll.com) ) 中，我认为这是导致问题的原因。

下面是我正在做的事情的截图，它可能有助于理解我在做什么。上面写着“马达加斯加 3：欧洲通缉犯（2012 年）”的地方是我试图让每个悬停的 ALT 值显示的地方。

![在此处输入图像描述](../Images/58a70152516d9bf1db6823df55707984.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T23:20:04.837

您可能不应该在每次 mouseenter 元素时重新绑定 mouseleave 函数，因为这会导致事件被多次绑定：

```
$(document).on({
     mouseenter: function() {
         var movie_data = $(this).attr('alt');
         if (movie_data.length) $('.scroller_movie_data').html(movie_data);
     },
     mouseleave: function() {
         $('.scroller_movie_data').html('');
     }
}, '.scroller_poster'); 
```

[**小提琴**](http://jsfiddle.net/BUxHW/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T23:22:13.137

为什么在 mouseenter 事件中有 mouseleave 事件？这是非常糟糕的做法，并且可以创建多个事件处理程序。

在jquery中使用hover方法（第一个函数是mouseenter，第二个函数是mouseout）：

```
$('.scroller_poster').hover(
  function() {
    var movie_data = $(this).attr('alt');
    if (movie_data)
      $('.scroller_movie_data').html(movie_data);
}, 
  function() {
    $('.scroller_movie_data').html('');
}); 
```

# jquery - 对 Rails 控制器的 Ajax POST 请求的格式化参数 - 用于 jQuery-UI 可排序列表

> ID：13214454
> 
> 赞同：0
> 
> 时间：2012-11-03T23:15:42.493
> 
> 标签：jquery, ruby-on-rails, ajax, jquery-ui, jquery-ui-sortable

我正在使用 jQuery-UI 可排序连接列表。我将连接列表的顺序保存到 Rails 服务器。

我的做法是获取每个列表项的列表 ID、列 ID 和索引位置。然后我想将它包装到一个对象中，该对象可以作为参数传递回 Rails 控制器以保存到数据库中。所以理想情况下，我希望像这样格式化参数：`Parameters: {"Activity"=>[{id:1,column:2,position:1},{id:2,column:2,position:2} ,...]}`

如何正确格式化要在此 Ajax POST 请求中传递的参数？现在，通过下面的方法，我正在传递 `Parameters: {"undefined"=>""}`

这是我当前不起作用的 jQuery 代码（Coffeescript）：

```
jQuery ->
  $('[id*="day"]').sortable(
    connectWith: ".day"
    placeholder: "ui-state-highlight"
    update: (event, ui) ->
      neworder = new Array()
      $('[id*="day"] > li').each ->
        column = $(this).attr("id")
        index = ui.item.index() + 1
        id = $("#" + column + " li:nth-child(" + index + ") ").attr('id')
        passObject={}
        passObject.id = id
        passObject.column = column
        passObject.index = index
        neworder.push(passObject)
      alert neworder
      $.ajax
        url: "sort"
        type: "POST"
        data: neworder
    ).disableSelection() 
```

我很抱歉，因为这似乎是一个非常业余的问题，但我才刚刚开始编写 jQuery 和 Javascript。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:14:38.993

假设你所有的选择器都是正确的，那么你应该能够做到这一点：

```
$.ajax
  url: "sort"
  type: "POST"
  data: { Activity: JSON.stringify(neworder) } 
```

* * *

您还可以简化其余代码：

```
update: (event, ui) ->
  neworder = [ ]
  $('[id*="day"] > li').each ->
    # 'this' should be the DOM element so just read off the 'id' attribute,
    # you don't need to waste time building a jQuery object just to get an
    # 'id' attribute.
    column = @id
    index  = ui.item.index() + 1

    # String interpolation to skip the string addition noise. You already
    # have a jQuery object here so there's nothing wrong with using
    # attr('id') here.
    id = $("##{column} li:nth-child(#{index})").attr('id')

    # You don't need 'passObject' here, just use an object literal and push
    # it onto neworder all in one go.
    neworder.push(
      id:     id
      column: column
      index:  index
    )
  $.ajax
    url: "sort"
    type: "POST"
    data: { Activity: JSON.stringify(neworder) } 
```

或者更紧凑（如果你喜欢那种东西）：

```
update: (event, ui) ->
  neworder = [ ]
  $('[id*="day"] > li').each ->
    index = ui.item.index() + 1
    neworder.push(
      id:     $("##{column} li:nth-child(#{index})").attr('id')
      column: @id
      index:  index
    )
  $.ajax
    url: "sort"
    type: "POST"
    data: { Activity: JSON.stringify(neworder) } 
```

然后你可以`JSON.parse(params[:Activity])`在你的控制器中解压它。

* * *

经过评论中的一些讨论，我认为您的`index`价值观是错误的。这样做：

```
index = ui.item.index() + 1 
```

会给你同样`index`的每个`<li>`。你可能想要更像这样的东西：

```
$lis = $('[id*="day"] > li')
$lis.each ->
  index = $lis.index(@)
  #... 
```

这应该为您提供您正在迭代的 s 集合中当前`<li>`( ) 的索引。或者，您可以使用传递给迭代器函数的参数：`@``<li>`[`each`](http://api.jquery.com/each/)

```
$('[id*="day"] > li').each (index, el) ->
  # Just use `index` as-is in here... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T06:30:25.813

这是我的 jQuery 代码（在 Coffeescript 中）：

```
jQuery ->
  $('[id*="day"]').sortable(
    connectWith: ".day"
    placeholder: "ui-state-highlight"
    update: (event, ui) ->
      neworder = new Array()
      $(this).children().each ->
        column = $(this).parent().attr("id").match(/\d+/)[0]
        id = $(this).attr("id").match(/\d+/)[0]
        neworder.push(
          id: id
          column: column
        )
      alert neworder
      $.ajax
        url: "sort"
        type: "POST"
        data: { Activity: JSON.stringify(neworder) }
    ).disableSelection() 
```

我如何将 AJAX 调用解析回 Rails 控制器：

```
def sort
    JSON.parse(params[:Activity]).each_with_index do |x, index|
      idx = x["id"]
      positionx = index+1
      column = x["column"]
      activity = Activity.find(idx)
      activity.update_attributes(:position => positionx, :day_id => column)
    end
    render nothing: true
  end 
```

回到我的模型中，我按位置订购“活动”关联。

```
has_many :activities, :order => 'position' 
```

非常感谢您的帮助@muistooshort

# javascript - location.protocol 是否曾经无效？

> ID：13214460
> 
> 赞同：15
> 
> 时间：2012-11-03T23:16:22.507
> 
> 标签：javascript

我想使用与加载当前运行的 JavaScript 的页面相同的方案（可能是“http：”或“https：”）构建 URL。现代浏览器支持简单地省略该方案（例如，`src="//example.com/test.js"`），但这并不完全跨浏览器兼容。（我读过 IE 6 是唯一不支持它的浏览器，但我仍然需要与该版本兼容。）

执行此操作的跨浏览器方法似乎是检查`location.protocol`. 例如，谷歌分析使用：

```
('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + ... 
```

在 Google 的案例中，他们希望根据请求是否使用 SSL 来使用不同的域，因此这种模式是有意义的。但是我看到其他人使用相同的模式，即使只有协议不同：

```
('https:' == location.protocol ? 'https:' : 'http:') + "//example.com" 
```

（一个例子在[http://css-tricks.com/thinking-async/](http://css-tricks.com/thinking-async/)的“Final Wufoo Snippet”中。）

我更喜欢使用这个更简单的表达式：

```
location.protocol + "//example.com" 
```

`location.protocol`当我的代码在我无法控制的网站上使用时，我是否真的应该担心会出现“https：”或“http：”以外的其他值？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-03T23:20:28.197

它总是被设置为某个值，但有时它可能被设置为一个既不是“http”也不是“https”的值。您最有可能看到的其他三个值是`file:`（对于 HTML 文件）、`about:`（对于涉及 的 iframe 魔术`about:blank`），也许还有`ftp:`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-05T07:16:09.833

**注意：**这并不是关于 document.location.protocol 的返回是否有效，而是描述了一个很难发现的错误（您可以覆盖 document.location.protocol 的行为而无需编写任何 javascript）。

我遇到了一个看似奇怪的案例，其中**document.location.protocol**似乎没有按应有的方式工作。该站点有一个跟踪-Javascript，它使用以下代码段来解析当前协议：

```
var proto = ('https:' === document.location.protocol ? 'https://' : 'http://') 
```

该站点使用 HTTPS，但在某些页面上，协议会变成**http**而不是预期的**https**。

在谷歌搜索和调查应用程序堆栈配置上花费了大量时间后，一位开发人员发现出现协议解决问题的页面具有**具有以下属性的 HTML 表单：**

```
name="location" 
```

这导致协议解析行为不端，并错误地将协议推断为 http 而不是 https（不，表单没有称为协议的字段，也不应该有）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-03T23:20:44.727

> 当我的代码在我无法控制的网站上使用时，我真的应该担心 document.location.protocol 具有“https:”或“http:”以外的其他值的可能性吗？

不是特别的，但话又说回来，你的方法没有特别的危害（无论协议是什么）。Google Analytics 可能会进行实际检测，因为它们使用的主机与其他主机不同。

# php - 连接/显示具有相同列名的多个表

> ID：13214465
> 
> 赞同：1
> 
> 时间：2012-11-03T23:16:42.743
> 
> 标签：php, mysql, sql

我想要做的是设置一个从数据库调用的查询（特别是 Chinook 数据库 - [http://chinookdatabase.codeplex.com/](http://chinookdatabase.codeplex.com/)）

现在，为了正确显示查询输出，我需要连接多个表——每个表共享相似的列名。在 Chinook 数据库中，有多个表（艺术家、专辑、流派、媒体类型、曲目等）。假设我正在尝试显示艺术家姓名的内容：

```
public function fetchArtistName(){
    return $row['Name'];
} 
```

这是非常模糊的，因为该行会在找到艺术家姓名之前找到媒体类型或专辑名称的名称字段。

我的SQL语句如下：

```
SELECT *  
FROM track AS t  
LEFT JOIN album al 
ON t.AlbumId = al.AlbumId  
LEFT JOIN artist ar ON al.ArtistId = ar.ArtistId  
LEFT JOIN mediatype m ON t.MediaTypeId = m.MediaTypeId 
LIMIT 0,15; 
```

有没有办法可以将输出的表格更改为 | t.姓名 | al.Name | ar.Name | m.name |

这样我基本上可以更容易地调用这些

```
public function fetchArtistName(){
    return $row['ar.Name'];
} 
```

自从我玩 SQL 以来已经很久了，我真的被困住了。任何帮助将不胜感激，我已经用谷歌搜索并在这里搜索过。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T23:20:33.140

我不确定您是否可以使用`SELECT *...`. 您需要执行以下操作：

```
SELECT t.Name as track_name,
  al.Name as album_name, ar.Name as artist_name, m.Name as media_name 
FROM track AS t  
LEFT JOIN album al 
ON t.AlbumId = al.AlbumId  
LEFT JOIN artist ar ON al.ArtistId = ar.ArtistId  
LEFT JOIN mediatype m ON t.MediaTypeId = m.MediaTypeId 
LIMIT 0,15; 
```

...这样你的 PHP 函数被定义为

```
public function fetchArtistName(){
    return $row['artist_name'];
} 
```

# ios - 使用 UITableViewCellAccessoryCheckMark

> ID：13214471
> 
> 赞同：4
> 
> 时间：2012-11-03T23:17:10.610
> 
> 标签：ios, xcode, uitableview, checkmark

我正在努力完成这项工作，但似乎无法完全理解这个想法。

到目前为止，我已经将它带到了您可以选择一个单元格并能够生成复选标记的位置。然后，当您选择不同的单元格时，先前的复选标记将消失，并且表格视图将在您刚刚选择的新单元格上进行新的复选标记。这一切都很好。

但是，我想在您选择带有复选标记的同一个单元格时，复选标记不会消失。但是，确实如此！

我已经尝试了大量的 if 语句，看看我是否可以弄清楚如何使这项工作，但无法找出解决方案。这可能是我需要在我的代码中重新排列的小事。

这是我的代码：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    if(self.checkedIndexPath)
    {
        UITableViewCell* uncheckCell = [tableView
                                        cellForRowAtIndexPath:self.checkedIndexPath];
        uncheckCell.accessoryType = UITableViewCellAccessoryNone;
        [tableView deselectRowAtIndexPath:indexPath animated:YES];

    }

    if([self.checkedIndexPath isEqual:indexPath])
    {
        self.checkedIndexPath = nil;
    }

    else
    {
         cellCheck = [tableView cellForRowAtIndexPath:indexPath];
        cellCheck.accessoryType = UITableViewCellAccessoryCheckmark;
        self.checkedIndexPath = indexPath;
        [tableView deselectRowAtIndexPath:indexPath animated:YES];
        NSLog(@"%@", indexPath);

    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-03T23:42:30.183

如果您选择带有复选标记的单元格，则将执行此代码。

```
if(self.checkedIndexPath)
{
    UITableViewCell* uncheckCell = [tableView
                                     cellForRowAtIndexPath:self.checkedIndexPath];
     uncheckCell.accessoryType = UITableViewCellAccessoryNone;
     [tableView deselectRowAtIndexPath:indexPath animated:YES];
} 
```

此代码将删除您在第一次选择期间添加的复选标记。

那么这段代码将被执行

```
if([self.checkedIndexPath isEqual:indexPath])
{
    self.checkedIndexPath = nil;
} 
```

因此，只有当您再次选择相同的单元格时，复选标记才会重新出现

我认为更清洁的方式如下。

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell* cellCheck = [tableView
                                    cellForRowAtIndexPath:indexPath];
    cellCheck.accessoryType = UITableViewCellAccessoryCheckmark;
}

- (void)tableView:(UITableView *)tableView didDeselectRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell* uncheckCell = [tableView
                                    cellForRowAtIndexPath:indexPath];
    uncheckCell.accessoryType = UITableViewCellAccessoryNone;
 } 
```

因为您可以从 [tableView indexPathForSelectedRow] 获取 self.checkedIndexPath 的值；self.checkedIndexPath 的设置是可选的，具体取决于代码的逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T23:43:38.150

您不会像那样直接操作单元格，将检查状态存储在某处并更改 cellForRowAtIndex 中的附件类型：

```
static BOOL checkedRows[100]; // example data storage

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath;
{
    checkedRows[indexPath.row] = !checkedRows[indexPath.row];
    [tableView reloadData];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath;
{

    UITableViewCell * cell = [tableView dequeueReusableCellWithIdentifier:@"somecell"];

    if(!cell)
    {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellIdentifier];
    }

    cell.accessoryType = checkedRows[indexPath.row] ? UITableViewCellAccessoryCheckmark : UITableViewCellAccessoryNone;

    return cell;
} 
```

# php - php连接重新初始化我的变量

> ID：13214478
> 
> 赞同：0
> 
> 时间：2012-11-03T23:18:08.690
> 
> 标签：php, concatenation, scope

我有两个 foreach 循环，一个给`$value1`另一个给`$value2`。我`$values`在顶部定义了一个字符串变量。

```
foreach(...)// get $value1 here
{
   if(strlen($values) > 0)
   $values .=",('".$value1."','')";
   else
   $values .="('".$value1."','')";
}
foreach(...) // get $value2 here
{
   if(strlen($values) > 0)
   $values .=",('','".$value2."')";
   else
   $values .="('','".$value2."')";
} 
```

`$values`变量重新启动。

我从每个循环中得到两个结果，但我想要一个结果，我想将所有这些值连接到一个变量`$values`。我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T23:53:37.883

确保 $values在 2 个循环`globally`之前启动。`foreach`

```
$values = ''; 
foreach(..){

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T23:23:54.040

实际上 if在它是一个局部变量`$values`之前没有定义。before blocks 会让你的生活更轻松。`foreach``$values = '';``foreach`

```
$values = '';
foreach(...) {
   if(strlen($values) > 0) {
     $values .=",('".$value1."','')";
   } else {
     $values .="('".$value1."','')";
   }
} 
```

你也可以使用`implode`。

# c++ - 变量引用和名称之间的区别

> ID：13214480
> 
> 赞同：9
> 
> 时间：2012-11-03T23:18:15.383
> 
> 标签：c++, variables, pointers, reference

我正在研究c ++的引用，现在我对变量名和引用之间的区别感到很困惑。测试代码如下：

```
class TestClass{
private:
    int num;
public:
    TestClass(int n):num(n){
        cout<<this<<" : init of : " <<this->num<<endl;
    }

    TestClass(const TestClass& t):num(t.num){
        cout<<this<<" : copyInit of : " <<this->num<<endl;
    }

};

int main(int argc, const char * argv[]){

    TestClass t = *(new TestClass(55)); //just to test copy initialization

    const TestClass t2 = TestClass(100); //option1
    const TestClass &t2 = TestClass(100); //option2

} 
```

所以现在我有两个制作对象的选择，它们是相互排斥的。

据我了解，如果我使用**options2**，编译器会在堆栈内存中创建一个临时对象并将引用值返回给 t2。

如果这是正确的，我该如何表达或解释**option1**？似乎在堆栈内存中创建了相同的对象，并且计算机为该对象提供了名称“t2”，但我不清楚此**选项 1与****选项 2**有何不同，因为变量和引用的名称有些令人困惑。

此外，交替切换选项，我可以看到在每种情况下对象都是在不同的内存位置创建的。（例如option1的对象是在0x7fff5fbff828中创建的，或者option2是在0x7fff5fbff820中的）

你能解释一下吗

**1.**变量名（option1）和引用（option2）有什么区别。

**2.**选项 1 和 2 的工作方式有何不同。

**3.**为什么在这两种情况下都在不同的内存位置创建对象。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T23:30:43.463

```
const TestClass t2 = TestClass(100); //option1
const TestClass &t2 = TestClass(100); //option2 
```

选项1：

调用 TestClass 的复制构造函数并传入在“=”右侧创建的临时值。复制省略消除了不必要的对象复制（参见下面的 Piotrs 评论）。

选项 2：

您创建 1 个对象，即临时对象，该对象将绑定到引用。

> 1.  变量名（选项1）和引用（选项2）有什么区别。

编辑：我以前不知道这一点，但实际上选项 1 中没有第二次分配（感谢 Piotr）这是由于复制省略，它指的是一种编译器优化技术，可以消除不必要的对象复制。

用你的话来说，“变量名”是一块包含数据的内存。引用就像一个指针，它指向另一个“变量名”，但它必须被初始化，并且永远不会为空。

> 1.  选项 1 和 2 中的工作方式有何不同。

正如其他人所说，选项 1 是静态类型，其中选项 2 可以指向派生（来自 TestClass）对象的实例。

> 1.  为什么在这两种情况下都在不同的内存位置创建对象。

尽管是“相同的”TestObjects(100)，但它们是单独的实例，因此在不同的内存（地址）中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T23:28:36.107

> 1）变量名（选项1）和引用（选项2）有什么区别。

名称具有静态类型。引用可以绑定到派生类——我们不知道引用对象的确切类型。

在您的示例中 - 对于选项 2 - 您通过创建对临时对象的 const 引用来延长临时对象的生命周期 - 请参阅[http://herbsutter.com/2008/01/01/gotw-88-a-candidate-for-the-最重要的常量/](http://herbsutter.com/2008/01/01/gotw-88-a-candidate-for-the-most-important-const/)

> 通常，临时对象只持续到它出现的完整表达式的结尾。但是，C++ 特意指定将临时对象绑定到堆栈上的 const 引用会将临时对象的生命周期延长到引用本身的生命周期，从而避免常见的悬空引用错误。

* * *

> 2）选项 1 和 2 中的工作方式有何不同。

如果您调用虚函数 - 那么对于变量名，您知道将调用哪个函数，对于引用 - 您无法知道比您的示例更复杂的示例。

* * *

> 3）为什么在这两种情况下都在不同的内存位置创建对象。

它们是不同的对象，它们同时存在——那么为什么它们的内存位置应该相同呢？

其他区别是，对于选项 1，您创建了自动变量，对于选项 2，它是临时变量 - 两者都可能使用不同的内存（堆栈与寄存器或仅用于临时的一些保留内存）

* * *

考虑更复杂的例子：

```
class TestClass{
protected:
    int num;
public:
    TestClass(int n):num(n){
        cout<<this<<" : init of : " <<this->num<<endl;
    }
    TestClass(const TestClass& t):num(t.num){
        cout<<this<<" : copyInit of : " <<this->num<<endl;
    }
    virtual void printNum () const { cout << "NUM: " << num << endl; }
};

class TestClassDerived : public TestClass {
public:
    TestClassDerived(int n):TestClass(n){}
    virtual void printNum () const { cout << "DERIVED NUM: " << num << endl; }
};

int main(int argc, const char * argv[]){
    const TestClass t1 = TestClass(100); //option1
    const TestClass &t2 = TestClassDerived(100); //option2
    t1.printNum();
    t2.printNum();
} 
```

# wpf - WPF 命令模式

> ID：13214481
> 
> 赞同：3
> 
> 时间：2012-11-03T23:18:18.143
> 
> 标签：wpf, command

我有一个应用程序范围的标志，它是一个应用程序设置。

```
MyApp.Properties.Settings.Default.SoundMuted 
```

标志是我的应用程序声音是否静音。我有许多通过.Net 的声音播放器播放声音的窗口。我在想标志将被连接到带有命令的工具栏按钮。我正在考虑静音通知让我的类播放声线到一个类（例如`SoundManager`）挂在实现的应用程序上`NotifyPropertyChange`。然后，如果用户单击工具栏按钮，我会在我的设置中设置静音属性，`SoundManager`并让所有声音播放器类都获得`PropertyChange`静音。

有没有更好的模式呢？假设我可以将所有声音播放器连接到命令并且该命令会触发。

还有一些巧妙的方法可以将该应用程序设置连接为xaml中的可绑定属性吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T12:17:41.847

一种方法是创建一个包装类来提供对 static 的可绑定访问`Settings.Default`。

**从那以后我意识到这比需要的工作更多，请参阅我的其他答案**

```
namespace MyApp
{
    internal sealed class ResourceWrapper
    {
        public Settings Default
        {
            get
            {
                return Settings.Default;
            }
        }
    }
} 
```

现在，我们需要将它作为资源添加到某处，可以在 App.xaml 中完成，这里我已经在使用它的窗口本地完成，不要忘记命名空间：

```
xmlns:local="clr-namespace:MyApp"

<Window.Resources>
    <local:ResourceWrapper x:Key="SettingsWrapper"/>
</Window.Resources> 
```

现在我们需要绑定到它，这表明它在`MenuItem`同一个窗口中使用：

```
<Menu>
    <MenuItem Header="Audio">
        <MenuItem Header="Mute" IsCheckable="True"
          IsChecked="{Binding Path=Default.SoundMuted, Source={StaticResource ResourceKey=SettingsWrapper}}"/>
    </MenuItem>
</Menu> 
```

就像我说的，您可以在应用程序级别添加资源，或者您可以在不同的窗口/控件中创建多个这些 ResourceWrapper，它们都将指向相同的静态底层。

带有测试的完整 xaml 窗口`TextBlock`：

```
<Window x:Class="Test_WpfApplication2.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:MyApp"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <local:ResourceWrapper x:Key="SettingsWrapper"/>
    </Window.Resources>
    <Grid>
        <Menu>
            <MenuItem Header="Audio">
                <MenuItem Header="Mute" IsCheckable="True" IsChecked="{Binding Path=Default.SoundMuted, Source={StaticResource ResourceKey=SettingsWrapper}}"/>
            </MenuItem>
        </Menu>
        <TextBlock Text="{Binding Path=Default.SoundMuted, Source={StaticResource ResourceKey=SettingsWrapper}}" Height="23" HorizontalAlignment="Left" Margin="18,156,0,0" VerticalAlignment="Top" Width="75" />
    </Grid>
</Window> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T12:27:11.497

尽管我总是采用与其他答案相同的方法来敲击该示例，但我已经意识到这是不合理的。您可以直接绑定到`Settings`对象，如下所示：

```
<Window x:Class="Test_WpfApplication2.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:MyApp"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <local:Settings x:Key="SettingsRes"/>
    </Window.Resources>
    <Grid>
        <Menu>
            <MenuItem Header="Audio">
                <MenuItem Header="Mute" IsCheckable="True"
                   IsChecked="{Binding Path=Default.SoundMuted, Source={StaticResource ResourceKey=SettingsRes}}"/>
            </MenuItem>
        </Menu>
        <TextBlock Text="{Binding Path=Default.SoundMuted, Source={StaticResource ResourceKey=SettingsRes}}" Height="23" HorizontalAlignment="Left" Margin="18,156,0,0" VerticalAlignment="Top" Width="75" />
    </Grid>
</Window> 
```

同样，该资源的多个实例仍然可以很好地协同工作，例如将 绑定`TextBlock`到第二个资源：

```
<Window x:Class="Test_WpfApplication2.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:MyApp"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <local:Settings x:Key="SettingsRes"/>
        <local:Settings x:Key="SettingsRes2"/>
    </Window.Resources>
    <Grid>
        <Menu>
            <MenuItem Header="Audio">
                <MenuItem Header="Mute" IsCheckable="True" IsChecked="{Binding Path=Default.SoundMuted, Source={StaticResource ResourceKey=SettingsRes}}"/>
            </MenuItem>
        </Menu>
        <TextBlock Text="{Binding Path=Default.SoundMuted, Source={StaticResource ResourceKey=SettingsRes2}}" Height="23" HorizontalAlignment="Left" Margin="18,156,0,0" VerticalAlignment="Top" Width="75" />
    </Grid>
</Window> 
```

# c - 读写动态分配的内存

> ID：13214484
> 
> 赞同：1
> 
> 时间：2012-11-03T23:19:00.970
> 
> 标签：c, memory, heap-memory, calloc

我有一些包含以下部分的代码：

```
typedef unsigned long long int ulli_t;
typedef unsigned int obj_t;
// --- SOME UNIMPORTANT PART OF CODE
objects = (obj_t*)malloc(hw*sizeof(obj_t));
objNums = (ulli_t*)calloc(hw, sizeof(ulli_t));
printf("%#x, %#x\n", objects, objNums);
// --- SOME UNIMPORTANT CODE
/// NEXT PART IS for-CYCLED
objNums[k] ++;
if (k>=Nobj) {
   objects[k] = obj;
   Nobj++;
   printf(" %lu - %#x - %#x\n", k, objects+k, objNums+k);
}; 
```

我得到了这部分代码的输出：

```
0xaafdf9d8, 0xaad693b0
 0 - 0 - 0xaafdf9d8
 1 - 0 - 0xaafdf9dc
 2 - 0 - 0xaafdf9e0
 3 - 0 - 0xaafdf9e4
 4 - 0 - 0xaafdf9e8
 5 - 0 - 0xaafdf9ec
 6 - 0 - 0xaafdf9f0
 7 - 0 - 0xaafdf9f4
 8 - 0 - 0xaafdf9f8
 9 - 0 - 0xaafdf9fc
 10 - 0 - 0xaafdfa00
 11 - 0 - 0xaafdfa04 
```

所以，问题来了——如果“objects”变量不为零，那么为什么“objects+k”为零？当我制作：

```
printf(" %lu - %#x - %#x\n", k, objects[k], objNums[k]); 
```

我得到如下行：

```
value of k - 0 - hex value of objNums[k] 
```

这是为什么？想到那件事，我已经脑袋坏掉了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:43:16.013

您正在使用 %lu 打印您的 long long。您应该使用 %llu。

# c# - 加载对项目问题的特定 32/64 位 dll 引用

> ID：13214485
> 
> 赞同：3
> 
> 时间：2012-11-03T23:19:04.750
> 
> 标签：c#, dll, 64-bit, 32-bit

我一直在寻找一段时间，但似乎我的问题与大多数人有所不同。

这是交易，我想让我的程序同时兼容 32 位和 64 位。由于是用 .NET 编写的，所以这不是问题，但是我使用了一个特定于位的 sqlite dll。

尽管事实上，我有两个版本的 dll，而且我也能够为 64 位编译主程序，通过将 64 位版本引用重新添加到项目中，我想让它工作不知何故不同。

必须编译两次对我来说效率不够，相反，我想找到一种使其动态可调的方法：鉴于 Dll 是相同的，它们的内容：函数方法无论如何都是相同的，唯一的区别是他们，是位版本。因此，我想让我的程序的兼容性取决于它旁边的 dll。

由于通常它是作为参考添加到项目中的，Visual Studio 通过突出显示来检测其内容，我想以某种方式将其作为参考添加，但要加载实际的 dll（位于 exe 旁边），而不会失去以我迄今为止所做的方式使用 dll 函数，在编辑器中突出显示。

我已经阅读了有关 Assembly.Load/LoadFrom/LoadFile, + Reflection 的信息，但这并不是我所需要的。

提前致谢，

大卫

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-04T00:06:33.287

我知道您已经进行了很多搜索，但是这两个链接确实为您提供了两个很好的选择，您可能已经错过了。

[基于 64 位或 32 位操作系统导入外部 dll](https://stackoverflow.com/questions/2593916/import-external-dll-based-on-64bit-or-32bit-os)

[试图不需要 x86 和 x64 程序的两个单独的解决方案](https://stackoverflow.com/questions/4599797/trying-to-not-need-two-separate-solutions-for-x86-and-x64-program)

在这两个链接中，查看 Hans Passant 的答案。很棒。

希望这可以帮助。

# javascript - 如何移动 HTML DOM 元素的开始和结束标签？

> ID：13214488
> 
> 赞同：5
> 
> 时间：2012-11-03T23:19:17.777
> 
> 标签：javascript, jquery, html, dom, dom-traversal

我该如何改变这个：

```
<div class="container">
  <div class="span-19">
    <div id="content">
       <!-- variable amount of content -->
         <form class="move-me">
        <!-- form -->
         </form>
    </div>
  </div>
</div> 
```

进入这个：

```
<form class="move-me">
  <div class="container">
    <div class="span-19">
      <div id="content">
        <!-- variable amount of content -->
        <!-- form data -->
      </div>
    </div>
  </div>
</form> 
```

使用 jQuery？请注意，我特别想只移动`<form>`开始和结束标签，而不是该表单的子元素。最好我想要一些`jQuery.fn`这样我就可以做到这一点：

```
$('.move-me').changeNesting('.container'); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T23:33:24.150

使用`unwrap`和`wrap`：

```
var toMove = $('.move-me'​);
toMove.​​​​​​children().unwrap()​;
$('.container'​).wrap(toMove);​ 
```

**更新**：请注意，如果表单有嵌套的原始文本，上面的代码将不起作用。您可以用另一个标签包装表单的子项以使其工作（也使用`end`Yoshi 在评论中指出的）：

```
$('.container').wrap(
  $('.move-me').wrapInner('<div class="nostyle"/>').children().unwrap().end()
);​​​​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T23:20:51.113

使用[.wrap()](http://api.jquery.com/wrap/)和.detach( [)](http://api.jquery.com/detach/)，如下所示：

```
$('.container').wrap( $('form.move-me').detach() ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T23:28:19.980

```
$('.move-me').replaceWith(function() {
    return $('*', this);
});
$('.container').wrap('<form class="move-me" />');​ 
```

演示[http://jsfiddle.net/KX63Z/](http://jsfiddle.net/KX63Z/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T23:30:58.223

```
var $form=$('form.move-me')
$form.replaceWith($form.html()));
$('.container').wrap('<form class="move-me">'); 
```

# javascript - 提交按钮上的 Javascript 功能 - 等待它完成

> ID：13214490
> 
> 赞同：0
> 
> 时间：2012-11-03T23:19:43.353
> 
> 标签：javascript

我想在表单上按下提交按钮时触发一个函数并等待javascript函数完成，然后继续表单提交。我不希望在 javascript 函数完成之前提交表单。**

这就是我目前所拥有的：http: [//jsfiddle.net/njDvn/68/](http://jsfiddle.net/njDvn/68/)

```
function autosuggest() {
var input = document.getElementById('location');
    var options = {
    types: [],
    };
    var autocomplete = new google.maps.places.Autocomplete(input, options);
}

<!-- Get lat / long -->      
function getLatLng() {
    var geocoder = new google.maps.Geocoder();
    var address = document.getElementById('location').value;
    geocoder.geocode({
        'address': address
    }, function (results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            var latLng = results[0].geometry.location;
            $('#lat').val(results[0].geometry.location.lat());
            $('#lng').val(results[0].geometry.location.lng());
        } else {
            alert("Geocode was not successful for the following reason: " + status);
        }
    });
}

<!-- Load it --> 
window.onload = autosuggest; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:21:40.473

首先你需要防止表单被提交，在函数`return false`末尾添加一个。`getLatLng()`

然后当地理编码完成后，手动提交表单`document.getElementsByTagName('form')[0].submit()`

这是一个更新的 jsfiddle：http: [//jsfiddle.net/njDvn/70/](http://jsfiddle.net/njDvn/70/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T00:54:36.210

您可以拦截表单提交、中止它并将地理编码请求发送给 Google。

当服务器响应时，您可以从回调中重新提交表单（或在失败的情况下显示错误）。

将请求的状态存储在某处（为简单起见，我在示例中使用了全局变量）。在这种情况下，它只是一个指示地理编码请求是否成功完成的标志（所以现在，当提交表单并重新触发侦听器时，它将知道不重新发送地理编码请求）。

[http://jsfiddle.net/njDvn/75/](http://jsfiddle.net/njDvn/75/)

随意删除控制台日志记录。

您可能还希望隐藏纬度/经度字段。

```
var GeoCoded = {done: false}; // this holds the status of the geo-coding request

$(document).ready(function(){
    autosuggest(); // place your auto-suggest (now called autocomplete) box

    $('#myform').on('submit',function(e){

        if(GeoCoded.done)
            return true;

        e.preventDefault();
        console.log('submit stopped');
        var geocoder = new google.maps.Geocoder();
        var address = document.getElementById('location').value;

        // disable the submit button
        $('#myform input[type="submit"]').attr('disabled',true);

        // send the request
        geocoder.geocode({
            'address': address
        },
        function (results, status) {
            // update the status on success
            if (status == google.maps.GeocoderStatus.OK) {
                var latLng = results[0].geometry.location;
                $('#lat').val(results[0].geometry.location.lat());
                $('#lng').val(results[0].geometry.location.lng());
                // if you only want to submit in the event of successful 
                // geocoding, you can only trigger submission here.
                GeoCoded.done = true; // this will prevent an infinite loop
                $('#myform').submit();
            } else { // failure
                console.log("Geocode was not successful for the following reason: " + status);
                //enable the submit button
                $('#myform input[type="submit"]').attr('disabled',false);
            }

        });        

    });   

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T00:19:22.737

```
myFunction = new function(callback) {
    $.ajax({...}).done(callback());
}

myFunction(new function() {
    getLatLng();
}); 
```

这里需要调用`myFunction`onSubmit 事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T00:31:28.950

正如 MasterAM 所说，您需要做的就是以下几点：

```
/// I've included the following function to allow you to bind events in a 
/// better way than using the .onevent = function(){} method.
var addEvent = (function(){
  if ( window.addEventListener ) {
    return function(elm, eventName, listener, useCapture){
      return elm.addEventListener(eventName,listener,useCapture||false);
    };
  }
  else if ( window.attachEvent ) {
    return function(elm, eventName, listener){
      return elm.attachEvent('on'+eventName,listener);
    };
  }
})();

/// add another window.onload listener
addEvent(window,'load',function(){
  /// find the form, obviously should use whatever id you have on your form
  var form = document.getElementById('my_form');
      form.preventSubmit = true;
  /// add our onsubmit handler
  addEvent(form,'submit',function(e){
    /// only stop the form if we haven't already
    if ( form.preventSubmit ) {
      /// place/call whatever code you need to fire before submit here.
      alert('submit was blocked!');
      /// after that code is complete you can use the following
      form.preventSubmit = false;
      form.submit();
      /// return false prevents the submit from happening
      return false;
    }
  });
}); 
```

# ios - 用户位置-地图视图

> ID：13214491
> 
> 赞同：0
> 
> 时间：2012-11-03T23:19:48.130
> 
> 标签：ios, mkmapview, mapkit

我想在我的应用程序加载时找出用户位置坐标。我已经实现了以下代码，但它返回 0.000

```
 mapView.showsUserLocation=YES;

CLLocationCoordinate2D annotationCoordinate;
annotationCoordinate.latitude=mapView.userLocation.location.coordinate.latitude;
NSLog(@"%f",annotationCoordinate.latitude); 
```

我无法弄清楚。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T23:34:37.340

首先，您应该考虑到检索用户位置需要时间。此外，用户可以为您的应用程序禁用定位服务，甚至在连接条件下定位服务可能不可用。所以你最好重新考虑你的应用程序启动程序。

当您做出决定时，请查看协议`mapView:didUpdateUserLocation:`方法。`MKMapViewDelegate`在此方法触发后，可以`userLocation`通过`MKMapView`.

*更新*

如果您想在已检查用户位置的情况下打开地图视图，您可以考虑使用`CLLocationManager`and `CLLocationManagerDelegate`。通过这种方式，您可以检查位置服务是否可用，并在方法`locationManager:didUpdateToLocation:fromLocation:`启动后打开地图视图。

有关完整信息，请查看[获取用户位置](https://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/LocationAwarenessPG/CoreLocation/CoreLocation.html#//apple_ref/doc/uid/TP40009497-CH2-SW1)编程指南

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-02T12:38:02.400

**1) 添加 FrameWork CoreLocation 和 Mapkit**
**2) 在 ViewController.h 文件中**

```
#import <UIKit/UIKit.h>
#import <MapKit/MapKit.h>
@interface MapViewController : UIViewController<MKMapViewDelegate,CLLocationManagerDelegate>
{
      CLLocationManager *locationManager;
}
@property (nonatomic, strong) IBOutlet MKMapView *mapView; 
```

**3) 在 vi​​ewController.m 文件中**

```
- (void)viewDidLoad
{
[super viewDidLoad];
self.mapView.delegate = self;
locationManager = [[CLLocationManager alloc] init];
 locationManager.delegate=self;
locationManager.distanceFilter = kCLDistanceFilterNone; // whenever we move
locationManager.desiredAccuracy = kCLLocationAccuracyHundredMeters; // 100 m
[locationManager startUpdatingLocation];
} 
```

**现在在 didUpdateUserLocation**

```
- (void)mapView:(MKMapView *)mapView didUpdateUserLocation:(MKUserLocation *)userLocation{
MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(userLocation.coordinate, 800, 800);
[self.mapView setRegion:[self.mapView regionThatFits:region] animated:YES];
// Add an annotation
MKPointAnnotation *point = [[MKPointAnnotation alloc] init];
point.coordinate = userLocation.coordinate;
point.title = @"Where am I?";
point.subtitle = @"I'm here!!!";
[self.mapView addAnnotation:point];} 
```

**4) 现在在你的 UI 中添加 Mapview**

**注意**：选择**MapView**并转到**Attribute Inspector**和**CKECK Mark the Shows user location** Under BEHAVIOR

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T23:40:00.590

您无法在视图中获取用户位置坐标确实加载了您需要做的是使用下面的委托方法。

```
- (void)mapView:(MKMapView *)mapView didUpdateUserLocation:(MKUserLocation *)userLocation
{
    NSLog(@"coordinates = %f,%f", mapView.userLocation.coordinate.latitude,
          mapView.userLocation.coordinate.longitude);
} 
```

确保您的地图对象与委托连接刚刚测试它应该可以工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T23:52:09.733

我认为你应该使用这个：

```
#import <CoreLocation/CoreLocation.h> 
```

然后在 viewDidLoad 方法中：

```
CLLocationManager *locationManager = [[CLLocationManager alloc] init];
    [locationManager startUpdatingLocation];
    [mapView setRegion:MKCoordinateRegionMake(locationManager.location.coordinate, MKCoordinateSpanMake(0.2, 0.2))];
    mapView.showsUserLocation = YES;
    NSLog(@"%f",mapView.region.center.latitude); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-03T16:26:27.610

好的，所以我自己也设法修复了它。没有人告诉你的是，你需要在 info.plist 中设置一个键/值对。

根据您需要在“信息属性列表”字典下添加键的方法（requestAlwaysAuthorization 或 requestWhenInUseAuthorization）。第一种方法使用：NSLocationAlwaysUsageDescription，第二种方法使用：NSLocationWhenInUseUsageDescription。

两个键的值字段都可以设置为您希望向用户显示的任何字符串。

顶部的两个键都是我们正在寻找的。 [![它应该是什么样子](../Images/5cb1c290a0689c394f38442c86cbdc44.png)](https://i.stack.imgur.com/uSZdy.png)

现在您应该会看到一个提示您确认的对话框。

PS：互联网上没有教程列出该过程的这一步，但是当您阅读每个方法的文档时（CLLocationManager 上的 requestWhenInUse），它确实提到没有这两个键不会显示任何内容。

# ruby-on-rails - 在 Rails 中选择不同的 PostgreSQL 错误

> ID：13214494
> 
> 赞同：1
> 
> 时间：2012-11-03T23:20:31.477
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql, rails-postgresql

在 Mysql 上它可以正常工作。

> PG::Error: ERROR: 对于 SELECT DISTINCT，ORDER BY 表达式必须出现在选择列表 LINE 1 中：) ORDER BY programs.rating DESC、program_sc... ^ :

询问：

> SELECT DISTINCT "programs".* FROM "programs" INNER JOIN "program_schedules" ON "program_schedules"."program_id" = "programs"."id" WHERE (programs.rating >= 5 AND program_schedules.start >= '2012-11 -03 23:14:43.457659') AND (ptype = 'movie') ORDER BY programs.rating DESC，program_schedules.start DESC

导轨代码：

> @data = Program.joins(:program_schedules).where('programs.rating >= ? AND program_schedules.start >= ?',5, Time.now).order('programs.rating DESC, program_schedules.start DESC') .uniq

我试过了

> Program.select("programs.*, program_schedules.*).joins(:program_schedules).where(...

但是，这样，当我要阅读

> @data.program_schedules

我得到一个 nil 值（当我知道没有 nil 值时）

## PostgreSQL 9.2 (Heroku)、Ruby 1.9.2

关于我的数据库的一些信息：

```
class Program < ActiveRecord::Base
   has_many :program_schedules
end

class ProgramSchedule < ActiveRecord::Base
  belongs_to :program
end 
```

架构数据库

```
 create_table "program_schedules", :force => true do |t|
        t.integer  "program_id"
        t.datetime "start"
  end

  create_table "programs", :force => true do |t|
    t.string  "title",
    t.string  "ptype"
  end 
```

**编辑：** 我不需要订购“programs_schedules”，因为我需要与该程序相关的数组中的所有programs_schedules。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T00:11:39.763

您的查询在两种情况下模棱两可：

`ptype`不是表限定的，您没有透露表定义。所以查询是模棱两可的。

更重要的是，您希望：

```
ORDER BY programs.rating DESC, program_schedules.start DESC 
```

然而，与此同时，您指示 PostgreSQL 为您提供`DISTINCT`来自`programs`. 如果 中有多个匹配的行`program_schedules`，Postgres 怎么知道为`ORDER BY`子句选择哪一个？首先？最后的？最早、最新、最环保？它只是未定义。

通常，`ORDER BY`子句不能与`DISTINCT`子句不一致，这就是错误消息告诉您的内容。

基于一些假设，填写缺失的信息，您的查询可能如下所示：

```
SELECT p.*
FROM   programs p
JOIN   program_schedules ps ON ps.program_id = p.id
WHERE  p.rating >= 5
AND    ps.start >= '2012-11-03 23:14:43.457659'
AND    p. ptype = 'movie'   -- assuming ptype is from programs  (?)
GROUP  BY p.id              -- assuming it's the primary key
ORDER  BY p.rating DESC, min(ps.start) DESC;  -- assuming smallest start 
```

还假设您有 PostgreSQL 9.0 或更高版本，这是工作所必需的。（主键覆盖整个表`GROUP BY`。）

至于：

> 在 Mysql 上它可以正常工作。

**不，它没有**。它“有效”，但以神秘的方式而不是“正确”。MySQL 允许各种奇怪的错误，并竭尽全力（和 SQL 标准）以避免抛出异常——这是处理错误的一种非常不幸的方式。它经常回来困扰你。[Youtube 上的演示](http://www.youtube.com/watch?v=1PoFIohBSM4)。

### 问题更新

> 我需要数组中与该程序相关的所有programs_schedules。

您可能要添加：

```
SELECT p.*, array_agg(ps.start ORDER BY ps.start) 
```

# mysql - Innodb 显示不正确的计数（id）

> ID：13214496
> 
> 赞同：1
> 
> 时间：2012-11-03T23:20:42.893
> 
> 标签：mysql, innodb

有一个 ~3G 文件大小的 innodb 表（我使用 innodb_file_per_table = 1），刚刚从转储和 ~1.3G 转储文件导入。不知道这里有多少记录。

当我执行“select count(id) from $table”时，我看到“27117291”（27,117,291 便于阅读）。当我执行“select count(id) from $table limit 100”时，我也看到“27117291”

为什么会这样？InnoDB*真的*比 MyISAM 更好吗？

PS如果我执行“select count(id) from $table where id=73010460;” 我看到“1”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T23:24:58.553

```
select count(id) from $table 
```

返回一行，其中包含计数。所以你的**限制**没有区别。

（**[参考](http://dev.mysql.com/doc/refman/5.1/en/counting-rows.html)**）

```
+-----------+
| COUNT(id) |
+-----------+
|  <count>  |
+-----------+ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-03T23:25:00.173

我不是 SQL 专家，但我的猜测是这是因为 count() 只返回 1 行，因此限制为 100 无济于事。

我猜你需要做更多这样的事情来获得预期的结果：select count((select id from x limit 100))

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-03T23:24:58.973

限制不适用于该查询。计数查询返回 1 行，您限制为 100 行。如果您的计数查询将返回超过 100 行，那将是有效的。

该查询的限制不限制计数，过滤器返回行

# hadoop - 每当我停止和启动 hadoop 服务时都必须重复格式化 HDFS

> ID：13214499
> 
> 赞同：1
> 
> 时间：2012-11-03T23:20:47.623
> 
> 标签：hadoop

我在单节点集群上设置了 hadoop。当我使用 start=all.sh 启动所有 hadoop 服务时，一切正常。但是，每当我停止所有服务并重新启动 hadoop 服务时，都会出现以下异常，我必须再次重新格式化文件系统。现在我正在开发中，每当我重新格式化它时我都会复制文件。但我不能在生产中出现这种行为。我检查了日志，这里是例外。我的 etc/hosts 文件也是一样的，我禁用了 IPV6

```
2012-11-03 18:49:45,542 INFO     org.apache.hadoop.hdfs.server.namenode.NameNode:             STARTUP_MSG: 
/************************************************************
STARTUP_MSG: Starting NameNode
STARTUP_MSG:   host = nikhil-VirtualBox/127.0.1.1
STARTUP_MSG:   args = []
STARTUP_MSG:   version = 1.0.4
STARTUP_MSG:   build = https://svn.apache.org/repos/asf/hadoop/common/branches    /branch-1.0 -r 1393290; compiled by 'hortonfo' on Wed Oct  3 05:13:58 UTC 2012
************************************************************/
2012-11-03 18:49:45,738 INFO org.apache.hadoop.metrics2.impl.MetricsConfig: loaded properties from hadoop-metrics2.properties
2012-11-03 18:49:45,750 INFO org.apache.hadoop.metrics2.impl.MetricsSourceAdapter: MBean for source MetricsSystem,sub=Stats registered.
2012-11-03 18:49:45,751 INFO org.apache.hadoop.metrics2.impl.MetricsSystemImpl: Scheduled snapshot period at 10 second(s).
2012-11-03 18:49:45,751 INFO org.apache.hadoop.metrics2.impl.MetricsSystemImpl: NameNode metrics system started
2012-11-03 18:49:45,899 INFO org.apache.hadoop.metrics2.impl.MetricsSourceAdapter: MBean for source ugi registered.
2012-11-03 18:49:45,902 WARN org.apache.hadoop.metrics2.impl.MetricsSystemImpl: Source name ugi already exists!
2012-11-03 18:49:45,910 INFO org.apache.hadoop.metrics2.impl.MetricsSourceAdapter: MBean for source jvm registered.
2012-11-03 18:49:45,910 INFO org.apache.hadoop.metrics2.impl.MetricsSourceAdapter: MBean for source NameNode registered.
2012-11-03 18:49:45,932 INFO org.apache.hadoop.hdfs.util.GSet: VM type       = 32-bit
2012-11-03 18:49:45,934 INFO org.apache.hadoop.hdfs.util.GSet: 2% max memory = 19.33375 MB
2012-11-03 18:49:45,934 INFO org.apache.hadoop.hdfs.util.GSet: capacity      = 2^22 = 4194304 entries
2012-11-03 18:49:45,934 INFO org.apache.hadoop.hdfs.util.GSet: recommended=4194304, actual=4194304
2012-11-03 18:49:46,020 INFO org.apache.hadoop.hdfs.server.namenode.FSNamesystem: fsOwner=hduser
2012-11-03 18:49:46,020 INFO org.apache.hadoop.hdfs.server.namenode.FSNamesystem: supergroup=supergroup
2012-11-03 18:49:46,021 INFO org.apache.hadoop.hdfs.server.namenode.FSNamesystem: isPermissionEnabled=true
2012-11-03 18:49:46,024 INFO org.apache.hadoop.hdfs.server.namenode.FSNamesystem: dfs.block.invalidate.limit=100
2012-11-03 18:49:46,024 INFO org.apache.hadoop.hdfs.server.namenode.FSNamesystem: isAccessTokenEnabled=false accessKeyUpdateInterval=0 min(s), accessTokenLifetime=0 min(s)
2012-11-03 18:49:46,169 INFO org.apache.hadoop.hdfs.server.namenode.FSNamesystem: Registered FSNamesystemStateMBean and NameNodeMXBean
2012-11-03 18:49:46,191 INFO org.apache.hadoop.hdfs.server.namenode.NameNode: Caching file names occuring more than 10 times 
2012-11-03 18:49:46,194 INFO org.apache.hadoop.hdfs.server.common.Storage: Storage directory /tmp/hadoop-hduser/dfs/name does not exist.
2012-11-03 18:49:46,196 ERROR org.apache.hadoop.hdfs.server.namenode.FSNamesystem: FSNamesystem initialization failed.
org.apache.hadoop.hdfs.server.common.InconsistentFSStateException: Directory     /tmp/hadoop-hduser/dfs/name is in an inconsistent state: storage directory does not exist     or is not accessible.
at             org.apache.hadoop.hdfs.server.namenode.FSImage.recoverTransitionRead(FSImage.java:303)
at     org.apache.hadoop.hdfs.server.namenode.FSDirectory.loadFSImage(FSDirectory.java:100)
at     org.apache.hadoop.hdfs.server.namenode.FSNamesystem.initialize(FSNamesystem.java:388)
at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.<init>(FSNamesystem.java:362)
at org.apache.hadoop.hdfs.server.namenode.NameNode.initialize(NameNode.java:276)
at org.apache.hadoop.hdfs.server.namenode.NameNode.<init>(NameNode.java:496)
at org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:1279)
at org.apache.hadoop.hdfs.server.namenode.NameNode.main(NameNode.java:1288)
2012-11-03 18:49:46,197 ERROR org.apache.hadoop.hdfs.server.namenode.NameNode: org.apache.hadoop.hdfs.server.common.InconsistentFSStateException: Directory /tmp/hadoop-hduser/dfs/name is in an inconsistent state: storage directory does not exist or is not accessible.
at org.apache.hadoop.hdfs.server.namenode.FSImage.recoverTransitionRead(FSImage.java:303)
at org.apache.hadoop.hdfs.server.namenode.FSDirectory.loadFSImage(FSDirectory.java:100)
at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.initialize(FSNamesystem.java:388)
at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.<init>(FSNamesystem.java:362)
at org.apache.hadoop.hdfs.server.namenode.NameNode.initialize(NameNode.java:276)
at org.apache.hadoop.hdfs.server.namenode.NameNode.<init>(NameNode.java:496)
at org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:1279)
at org.apache.hadoop.hdfs.server.namenode.NameNode.main(NameNode.java:1288) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T23:25:03.920

只需不要在`/tmp`目录中安装 HDFS。每次启动时，您的操作系统都会清理它。

就我个人而言，我已经将我的 HDFS 安装在 中`/srv/hdfs/`，但我想这是一个口味问题。

# winapi - 为什么我的服务没有调用 SvcShutdown()？

> ID：13214502
> 
> 赞同：1
> 
> 时间：2012-11-03T23:21:07.030
> 
> 标签：winapi, service

**当 Windows 关闭时**，我无法弄清楚为什么`SvcShutdown()`我的 win32 服务没有被调用。其他一切都完美无缺（停止、暂停/继续等）。在网上搜索了几个小时后，我什么也没找到。

 **任何帮助将非常非常感谢！

提前致谢，

詹姆士

```
import win32serviceutil
import servicemanager
import win32service
import win32event
import win32api

import datetime

LOGINFO = 0
LOGWARNING = 1
LOGERROR = 2

class MyService(win32serviceutil.ServiceFramework):
_svc_name_ = 'MyService'
_svc_display_name_ = 'MyService service'

def __init__(self, *args):
    win32serviceutil.ServiceFramework.__init__(self, *args)
    # Create events for service stop, pause & continue
    # CreateEvent(securityAttrs, bManualReset, bInitialState, name)
    self.evStop = win32event.CreateEvent(None, 0, 0, None)
    self.evPause = win32event.CreateEvent(None, 0, 0, None)
    self.evContinue = win32event.CreateEvent(None, 0, 0, None)

    # Create event list for WaitForMultipleObjects()
    self.evhandles = self.evStop, self.evPause, self.evContinue
    # sigStatus must be this range for a valid SCM event
    self.validSignals = range(win32event.WAIT_OBJECT_0, 
                              win32event.MAXIMUM_WAIT_OBJECTS)

    # Signal ID returned from WFMO() else None
    self.sigStatus = None
    # Service run state. False means pausing/paused or stopping
    self.runState = True

def logEvent(self, msg, logtype=LOGINFO, logcategory=None):
    import servicemanager

    if logtype == LOGINFO:
        servicemanager.LogInfoMsg(str(msg))
    elif logtype == LOGWARNING:
        servicemanager.LogWarningMsg(str(msg))
    elif logtype == LOGERROR:
        servicemanager.LogErrorMsg(str(msg))

def sleep(self, sec):
    '''A delay method sympathetic to SCM notifications.'''

    while sec > 0:
        # SCM event has taken place?
        if self.notificationFromSCM():
            break
        win32api.Sleep(1000)
        sec = sec -1

def notificationFromSCM(self):
    '''Returns True if SCM notification(s) have taken place.

    sigStatus has the value.
    Note: that calls to WaitForMultipleObjects() only returns the event
    status ONCE, after which it's reset (ie. calling it may return
    WAIT_OBJECT_0 and an immediate subsequent call will yield WAIT_TIMEOUT
    or similar.'''

    if self.sigStatus is not None:
        # Still have a live SCM event to process, so exit
        return True

    # WaitForMultipleObjects(handles, bWaitAll, dwMilliseconds)
    self.sigStatus = win32event.WaitForMultipleObjects(self.evhandles, 0, 0)
    if self.sigStatus in self.validSignals:
        return True
    else:
        # Timeout signal or similar, so MUST reset sigStatus
        self.sigStatus = None
        return False

def SvcDoRun(self):
    self.ReportServiceStatus(win32service.SERVICE_START_PENDING)
    self.logEvent('Starting {0} Service...'.format(self._svc_display_name_))
    self.ReportServiceStatus(win32service.SERVICE_RUNNING)
    self.logEvent('{0} Service started.'.format(self._svc_display_name_))

    while True:         
        if self.runState:
            try:
                # Insert service work activity here...
                self.logEvent('Working: {0}'.format(datetime.datetime.now()))
                self.sleep(10)
            except Exception as x:
                self.logEvent('Exception : {0}'.format(x), LOGERROR)
        else:
            self.sleep(30)

        # SCM notification?
        if self.notificationFromSCM():
            if self.sigStatus == self.evhandles.index(self.evStop):
                # STOP event
                self.logEvent('Stopping {0} Service...'.format(self._svc_display_name_))
                break
            elif self.sigStatus == self.evhandles.index(self.evPause):
                # PAUSE event
                self.logEvent('Pausing {0} Service...'.format(self._svc_display_name_))
                self.runState = False
                # Other cleanup code here...
                self.logEvent('{0} Service paused.'.format(self._svc_display_name_))
                self.ReportServiceStatus(win32service.SERVICE_PAUSED)
            elif self.sigStatus == self.evhandles.index(self.evContinue):
                # CONTINUE event
                self.logEvent('Resuming {0} service...'.format(self._svc_display_name_))
                self.runState = True
                # Reset pause & continue to non-signaled state
                win32event.ResetEvent(self.evPause)
                win32event.ResetEvent(self.evContinue)
                # Other cleanup code here...
                self.logEvent('{0} Service started.'.format(self._svc_display_name_))
                self.ReportServiceStatus(win32service.SERVICE_RUNNING)

            # Clear signal flag
            self.sigStatus = None

    # If we get here, then service has been stopped/shutdown
    self.logEvent('{0} Service stopped.'.format(self._svc_display_name_))
    self.ReportServiceStatus(win32service.SERVICE_STOPPED)

def SvcStop(self):
    self.ReportServiceStatus(win32service.SERVICE_STOP_PENDING)
    # Signal STOP event
    win32event.SetEvent(self.evStop)

def SvcPause(self):
    self.ReportServiceStatus(win32service.SERVICE_PAUSE_PENDING)
    # Signal PAUSE event
    win32event.SetEvent(self.evPause)

def SvcContinue(self):
    self.ReportServiceStatus(win32service.SERVICE_CONTINUE_PENDING)
    # Signal CONTINUE event
    win32event.SetEvent(self.evContinue)

def SvcShutdown(self):
    self.ReportServiceStatus(win32service.SERVICE_STOP_PENDING)
    self.logEvent('**SvcShutdown event**')
    # Shutdown code here...
    win32event.SetEvent(self.evStop) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T16:45:32.237

看看这个：

[[python-win32] win32 服务在重新启动时未收到关闭通知](http://www.mail-archive.com/python-win32@python.org/msg01284.html)**

# .net - 目标 .NET 4.0 但需要 .NET 4.5

> ID：13214503
> 
> 赞同：8
> 
> 时间：2012-11-03T23:21:22.897
> 
> 标签：.net, winforms, visual-studio-2012

我们最近迁移到 VS 2012，但我们需要继续使用 .NET 4.0。我们的大部分客户群仍在使用 XP，Windows XP 不支持 .NET 4.5。

现在，解决方案中的所有项目都针对 .NET 4.0 或更低版本。当我们运行应用程序时，它告诉我们安装 .NET 4.5 Framework，而只使用 .NET 4.0？

在生成的配置文件中，我看到：

```
<startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5" />
</startup> 
```

如果我在配置文件`Version=v4.5`中`Version=v4.0`手动更改，一切正常，我们可以运行应用程序，但是必须这样做似乎很奇怪？有人可以向我解释在我们为 4.0 开发时导致解决方案要求 4.5 的原因吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T05:18:43.063

当您使用 Visual Studio 2012 创建 .NET Framework 4.5 项目时，此 XML 内容会自动在 app.config 文件中创建。当您将项目重新定位到 .NET Framework 4 时，这些条目也会在 app.config 文件中恢复。看起来您的 app.config 条目由于某种原因未还原。可以手动编辑文件（就像您所做的那样）。您的项目将不再需要 .NET Framework 4.5。

# c++ - 检查是否等于多种可能性的简写

> ID：13214506
> 
> 赞同：8
> 
> 时间：2012-11-03T23:21:40.370
> 
> 标签：c++

> **可能重复：**
> [C++ 将一堆值与给定值进行比较](https://stackoverflow.com/questions/639496/c-comparing-bunch-of-values-with-a-given-one)

我需要在 C++ 中的 for 循环中检查是否相等，但是循环需要为 x 等于多种可能性工作。

例如，现在我有类似的东西：

```
if(x==a || x==b || x==c || x==d || x==e || x==f || x==g || x==h)
{
    //loop body
} 
```

但是对于我拥有的数字，它看起来很乱，我想知道是否有一种简写方式来表达“如果（x ==（其中任何一个））”，或者是否将它们全部写出来是唯一的选择。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T00:22:27.933

谢谢你的问题，现在我找到了一个解决方案（我敢说是一个优雅的解决方案），我会自己使用它。

与使用 std::find 的解决方案不同：a ) 是否会在编译时展开到 N 次比较 b) 适用于 X 可以与之比较的任何类型

```
struct TagAnyOf {};

template <typename... Args>
std::tuple <TagAnyOf, Args...> AnyOf (Args&&... args)
{
   return std::tuple <TagAnyOf, Args...> (TagAnyOf(), std::forward<Args>(args)...);
}

template <class X, class Tuple, size_t Index, size_t ReverseIndex>
struct CompareToTuple
{
    static bool compare (const X& x, const Tuple& tuple)
    {
        return x == std::get<Index> (tuple) || CompareToTuple<X, Tuple, Index+1, ReverseIndex-1>::compare (x, tuple);
    }
};

template <class X, class Tuple, size_t Index>
struct CompareToTuple <X, Tuple, Index, 0>
{
    static bool compare (const X& x, const Tuple& tuple)
    {
        return false;
    }
};

template <typename X, typename... Args>
bool operator == (const X& x, const std::tuple<TagAnyOf, Args...>& any)
{
    typedef std::tuple <TagAnyOf, Args...> any_of_type;
    return CompareToTuple <X, any_of_type, 1, std::tuple_size<any_of_type>::value-1>::compare (x, any);
} 
```

用法

```
int main()
{
    int x = 1;
    if (x == AnyOf (1, 2, 3, 4))
    {
        std::cout << "Yes!" << std::endl;
    }
    else
    {
        std::cout << "No!" << std::endl;
    }

    if (x == AnyOf (4, 3, 2, 1))
    {
        std::cout << "Yes!" << std::endl;
    }
    else
    {
        std::cout << "No!" << std::endl;
    }

    if (x == AnyOf (2, 3, 4, 5))
    {
        std::cout << "Yes!" << std::endl;
    }
    else
    {
        std::cout << "No!" << std::endl;
    }

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T23:35:17.170

考虑使用一个带有 initializer_list 的函数（这是一个 c++11 特性）。
第一个参数将是左侧值（在您的情况下为 x），其余参数将是右侧值。

* * *

这是一个使用模板完成任务的示例。

```
#include <iostream>
#include <cstdlib>
#include <algorithm>

template<class T> 
bool Test(T const& test, std::initializer_list<T> const& values){
    return std::find(std::begin(values), std::end(values), test) != std::end(values);
}

int main(){

    char var1 = 'a';
    char var2 = 'a';
    char var3 = 'b';
    char var4 = 'c';
    char var5 = 'd';

    if (Test<char>(var1,{var2,var3,var4,'o',var5})){
        std::cout << "true. at least one is equivelent" << std::endl;
    }else{
        std::cout << "false. none are equivelent" << std::endl;
    }

    if (Test<char>(var1,{var3,var4,var5})){
        std::cout << "true. at least one is equivelent" << std::endl;
    }else{
        std::cout << "false. none are equivelent" << std::endl;
    }

    return EXIT_SUCCESS;
} 
```

如果您使用类执行此操作，请确保重载 '!=' 运算符。

**编辑：**错误已修复。GManNickG 指出

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T00:06:06.320

> 我想知道是否有一种简写方式来表达“如果（x ==（其中任何一个））”

是的，该标准为您提供`std::find`并`std::find_if`准确回答了这个问题：

```
int a=3,b=5,c=6,d=7;
std::array<int,4> vals{{a,b,c,d}}; // or std::vector
int x=5;
bool foundit= (end(vals) != std::find_if(begin(vals), end(vals),x ); 
```

你会需要

```
#include <array>
#include <algorithm> 
```

您也可以使用`std::initializer_list<int> booleans{a,b,c,d};`代替`vector`或`array`

如果您的情况更复杂，您可以使用 find_if：

```
 bool foundit= (end(vals) != 
               std::find_if(begin(vals), end(vals),
                            [&x](const int &v){return v*(v+x)<x;})); 
```

# python - 将媒体从 Heroku 上传到 Amazon S3

> ID：13214507
> 
> 赞同：4
> 
> 时间：2012-11-03T23:21:43.540
> 
> 标签：python, django, heroku, amazon-s3

Heroku 和 Amazon S3 的新手，请耐心等待。将我的 Django 应用程序上传到 Heroku，但用户媒体上传存在问题。模型如下：

```
#models.py
class Movie(models.Model):
    title           = models.CharField(max_length = 500)
    poster          = models.ImageField(upload_to = 'storages.backends.s3boto')
    pub_date        = models.DateTimeField(auto_now_add = True)
    author          = models.ForeignKey(User) 
```

海报属性是上传图片的属性。我让它在本地运行良好，现在在 Heroku 上出现错误。所以我添加了“storages.backends.s3boto”，正如许多其他帖子告诉我的那样。（不确定是否正确）。

我的 Settings.py 文件现在看起来像这样，有点乱：

```
#settings.py
PROJECT_ROOT   = os.path.abspath(os.path.dirname(__file__))
PROJECT_DIR    = os.path.join(PROJECT_ROOT, '../qanda')

DEFAULT_FILE_STORAGE    = 'storages.backends.s3boto.S3BotoStorage'
STATICFILES_STORAGE     = 'storages.backends.s3boto.S3BotoStorage'

AWS_ACCESS_KEY_ID         = '****************'
AWS_SECRET_ACCESS_KEY     = '************'
AWS_STORAGE_BUCKET_NAME   = 'mrt-assets'
AWS_PRELOAD_METADATA      = True

MEDIA_ROOT = os.path.join(PROJECT_ROOT, 'qanda/media/movie_posters/)
MEDIA_URL = '/media'
STATIC_ROOT = os.path.join(PROJECT_ROOT, 'staticfiles')
STATIC_URL = 'https://mrt-assets.s3.amazonaws.com/static/'
STATICFILES_DIRS = (os.path.join(PROJECT_DIR, 'static'),) 
```

我的存储桶称为 mrt-assets，其中有 2 个静态文件夹（css、js、图像和媒体。我现在不太担心静态文件，因为我已将 CSS/JS 文件硬编码到我的HTML 文件*，但我如何让我的用户上传的媒体（任何类型的图像）到 mrt-assets/media？

*尽管如果有人也想帮助处理 STATIC 文件，那就太好了。但用户上传媒体更为紧迫。

编辑（根据 Yuji 的评论）：

尝试了许多选项，但都没有工作。我已经返回并删除了很多更改，现在这是我的设置

```
#settings.py
PROJECT_ROOT = os.path.abspath(os.path.dirname(__file__))
MEDIA_ROOT = 'http://s3.amazonaws.com/mrt-assets/media/'
MEDIA_URL = '/media/'
STATIC_ROOT = 'http://s3.amazonaws.com/mrt-assets/static/'
STATIC_URL = '/static/'
ADMIN_MEDIA_PREFIX = STATIC_URL + 'admin/'
TEMPLATE_DIRS = (os.path.join(PROJECT_ROOT, "templates"),)

#models.py
#same as before, but now have changed the poster directory
poster = models.ImageField(). 
```

不太确定该怎么做，需要将我的 Heroku 应用程序连接到 S3，以便将用户媒体上传保存在那里。

现在已将我的 S3 存储桶更改为此

```
mrt-assets
    static
        css
        js
        images
    media
        (empty) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T11:06:10.400

让您的媒体上传到`<bucket>/media`您的静态资产到其中的技巧`<bucket>/static`是为这两种资产类型创建两个不同的默认存​​储后端，或者使用带`location`参数的存储对象显式实例化您的模型字段。

# 使用自定义存储实例化模型字段

```
from storages.backends.s3boto import S3BotoStorage

class Movie(models.Model):
    title = models.CharField(max_length=500)
    poster = models.ImageField(storage=S3BotoStorage(location='media'))
    pub_date = models.DateTimeField(auto_now_add=True)
    author = models.ForeignKey(User) 
```

给所有上传的文件加上路径前缀`S3BotoStorage`。`location`

# 为媒体和静态资产创建自定义存储后端

这与显式定义带有位置的存储后端几乎相同，但我们将使用`settings.MEDIA_ROOT`并 `settings.STATIC_ROOT`在全局范围内应用路径前缀。

```
# settings.py
STATIC_ROOT = '/static/'
MEDIA_ROOT  = '/media/'

DEFAULT_FILE_STORAGE = 'app.storage.S3MediaStorage'
STATICFILES_STORAGE = 'app.storage.S3StaticStorage'

# app/storage.py
from django.conf import settings
from storages.backends.s3boto import S3BotoStorage

class S3MediaStorage(S3BotoStorage):
    def __init__(self, **kwargs):
        kwargs['location'] = kwargs.get('location', 
            settings.MEDIA_ROOT.replace('/', ''))
        super(S3MediaStorage, self).__init__(**kwargs)

class S3StaticStorage(S3BotoStorage):
    def __init__(self, **kwargs):
        kwargs['location'] = kwargs.get('location', 
            settings.STATIC_ROOT.replace('/', ''))
        super(S3StaticStorage, self).__init__(**kwargs) 
```

# 提炼它

您可以优化上述代码以利用 [Heroku 配置变量](https://devcenter.heroku.com/articles/config-vars#using-foreman) ，使其更便携：

```
# settings.py
import os
STATIC_ROOT = os.environ.get('STATIC_ROOT',
    os.path.join(os.path.dirname(__file__), 'static'))

MEDIA_ROOT = os.environ.get('MEDIA_ROOT',
    os.path.join(os.path.dirname(__file__), 'media'))

DEFAULT_FILE_STORAGE = os.environ.get('DEFAULT_FILE_STORAGE', 
    'django.core.files.storage.FileSystemStorage')

STATICFILES_STORAGE = os.environ.get('STATICFILES_STORAGE', 
    'django.contrib.staticfiles.storage.StaticFilesStorage') 
```

将上述设置与`.env`文件相结合，您可以在本地使用默认存储后端进行开发和测试，并且在 Heroku 上部署时，您将分别自动切换到 `app.storage.S3MediaStorage`和`app.storage.S3StaticStorage`：

```
# .env
STATIC_ROOT=static
MEDIA_ROOT=media
DEFAULT_FILE_STORAGE=app.storage.S3MediaStorage
STATICFILES_STORAGE=app.storage.S3StaticStorage 
```

# r - 使用“粘贴”矢量参考执行计算

> ID：13214508
> 
> 赞同：1
> 
> 时间：2012-11-03T23:21:54.167
> 
> 标签：r, for-loop, automation, paste

所以我有一些激光雷达数据，我想计算一些指标（我将在评论中附上数据的链接）。
我也有地面图，我已经提取了周围的激光雷达点，因此每个图有几百个点（19 个图）。每个点都有 X、Y、Z、离地高度和相关图。

我需要在绘图级别计算一堆指标，所以我`plotsgrouped`用`split(plotpts, plotpts$AssocPlot)`.
所以现在我有一个数据框，每个绘图都有一个“页面”，所以我可以通过“绘图页面”计算我的所有指标。这对个别地块很有效，但我想自动化它。（是的，我知道只有 19 个图，但这是它的原理，该死！:-P）
到目前为止，我有一个 for 循环来计算指标并将结果放入一个名为`Results`. 我将组的名称也放入了一个名为的列表`groups`中。

```
for(i in 1:length(groups)){
Results$Plot[i] <- groups[i]
Results$Mean[i] <- mean(plotsgrouped$PLT01$Z)
Results$Std.Dev.[i] <- sd(plotsgrouped$PLT01$Z)
Results$Max[i] <- max(plotsgrouped$PLT01$Z)
Results$75%Avg.[i] <- mean(plotsgrouped$PLT01$Z[plotsgrouped$PLT01$Z <= quantile(plotsgrouped$PLT01$Z, .75)])
Results$50%Avg.[i] <- mean(plotsgrouped$PLT01$Z[plotsgrouped$PLT01$Z <= quantile(plotsgrouped$PLT01$Z, .50)])
...
and so on. 
```

当我尝试执行以下操作时会出现问题：
`Results$mean[i] <- mean(paste("plotsgrouped", groups[i],"Z", sep="$"))`. `mean()`不将 识别`paste`为对 vector 的引用`plotsgrouped$PLT27$Z`，而是失败了。我推断这是因为它看到引号并认为，“哦，你只是一些文本，我无法理解你的意思。” 或类似的东西。
顺便说一句，groups 是 19 个地块名称的列表：PLT01-PLT27（有时不连续）和 FTWR，所以我不能简单地为名称的数字部分放置一个序列。
**任何人都有更简单的方法来遍历我的测试图并获得任意指标？
我觉得我拥有所有正确的部分，但只是不知道它们如何组合在一起给我想要的东西。**
另外，如果有人能为这个问题想出一个更好的标题，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T00:04:37.963

尝试：

```
for(i in seq_along(groups)) {

  Results$Plot[i] <- groups[i] # character names of the groups
  tempZ = plotsgrouped[[groups[i]]][["Z"]]
  Results$Mean[i] <- mean(tempZ)
  Results$Std.Dev.[i] <- sd(tempZ)
  Results$Max[i] <- max(tempZ)
  Results$75%Avg.[i] <- mean(tempZ[tempZ <= quantile(tempZ, .75)])
  Results$50%Avg.[i] <- mean(tempZ[tempZ <= quantile(tempZ, .50)])

} 
```

# android - 相对于彼此的移动位置

> ID：13214509
> 
> 赞同：0
> 
> 时间：2012-11-03T23:22:07.143
> 
> 标签：android, iphone, windows-phone-7

是否有任何库可以帮助我确定一个移动设备相对于其他设备的位置？

例如：一部 iPhone 能否确定旁边还有另一部 iPhone，如果可以，它面向哪个方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T23:32:33.270

我不知道有什么方法可以做你所要求的。

NFC 要求设备基本上可以触摸。Wifi 和 GPS 定位服务可能没有将位置确定到那个精确级别的粒度。可能可以使用定位服务来确定两部手机是否在同一个房间（不是桌子），以及在哪个位置。我认为在现实世界中，这会产生不同的结果，而且不可行。

我想知道新的 Wifi Direct 技术是否提供类似的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T23:25:22.643

在 Android 上，您可以使用[近场通信](http://developer.android.com/guide/topics/connectivity/nfc/index.html)

# php - 组合数组字符串值并丢弃数组元素

> ID：13214512
> 
> 赞同：3
> 
> 时间：2012-11-03T23:23:10.240
> 
> 标签：php, arrays

我有下面的`$test`数组按“*日期*”和“*网站*”排序。

```
$test = array ( 
0 => array ( 
       'id' => '45', 
       'rating' => 'p1', 
       'site' => 'Heavener SW', 
       'time' => '11-03-2012 Sat 10:00:00', 
       ), 
1 => array ( 
       'id' => '45', 
       'rating' => 'h3', 
       'site' => 'Heavener SW', 
       'time' => '11-03-2012 Sat 10:00:00', 
       ),
2 => array ( 
       'id' => '45', 
       'rating' => 'h4', 
       'site' => 'Heavener SW', 
       'time' => '11-03-2012 Sat 16:00:00', 
       ),
3 => array ( 
       'id' => '110', 
       'rating' => 'p3', 
       'site' => 'Red Oak', 
       'time' => '11-03-2012 Sat 16:00:00', 
       ), 
4 => array ( 
       'id' => '110', 
       'rating' => 'h3', 
       'site' => 'Red Oak', 
       'time' => '11-03-2012 Sat 16:00:00', 
       ), 
5 => array ( 
       'id' => '32', 
       'rating' => 'p2', 
       'site' => 'Panopoint', 
       'time' => '11-04-2012 Sun 10:00:00', 
       ) 
 ); 
```

我已经疯了，试图为每个“站点”-“时间”组合组合“评级”。

```
$result = array (
0 => array ( 
       'id' => '45', 
       'rating' => 'p1, h3', 
       'site' => 'Heavener SW',
       'time' => '11-03-2012 Sat 10:00:00', 
       ),
2 => array ( 
       'id' => '45', 
       'rating' => 'h4', 
       'site' => 'Heavener SW', 
       'time' => '11-03-2012 Sat 16:00:00', 
       ),
3 => array ( 
       'id' => '110', 
       'rating' => 'p3, h3', 
       'site' => 'Red Oak', 
       'time' => '11-03-2012 Sat 16:00:00', 
       ),
5 => array ( 
       'id' => '32', 
       'rating' => 'p2', 
       'site' => 'Panopoint', 
       'time' => '11-04-2012 Sun 10:00:00', 
       ) 
 ); 
```

一个站点可以拥有的“评级”数量或有多少“站点”或“时间”没有限制（在合理范围内）。在 中保留索引`$result`是可选的（即不是必需的）。

我发现了这个类似的帖子（和其他帖子），但我不明白如何实现。 [根据价值获取所有相关的](https://stackoverflow.com/questions/7215262/php-arrays-getting-all-the-related-ones-based-on-value)

我已经尝试了很多不同的方式，我的头在旋转，非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T23:41:36.860

你可以简单地使用`array_reduce`

```
$test = array_reduce($test, function ($a, $b) {
    isset($a[$b['time'] . "|" . $b['id']]) ? $a[$b['time'] . "|" . $b['id']]['rating'] .= "," . $b['rating'] : $a[$b['time'] . "|" . $b['id']] = $b;
    return $a;
});

$test = array_values($test);
var_dump($test); 
```

输出

```
array
  0 => 
    array
      'id' => string '45' (length=2)
      'rating' => string 'p1,h3' (length=5)
      'site' => string 'Heavener SW' (length=11)
      'time' => string '11-03-2012 Sat 10:00:00' (length=23)
  1 => 
    array
      'id' => string '45' (length=2)
      'rating' => string 'h4' (length=2)
      'site' => string 'Heavener SW' (length=11)
      'time' => string '11-03-2012 Sat 16:00:00' (length=23)
  2 => 
    array
      'id' => string '110' (length=3)
      'rating' => string 'p3,h3' (length=5)
      'site' => string 'Red Oak' (length=7)
      'time' => string '11-03-2012 Sat 16:00:00' (length=23)
  3 => 
    array
      'id' => string '32' (length=2)
      'rating' => string 'p2' (length=2)
      'site' => string 'Panopoint' (length=9)
      'time' => string '11-04-2012 Sun 10:00:00' (length=23) 
```

[观看现场演示](http://codepad.viper-7.com/1XbuZt)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T23:31:08.627

由于保留键是可选的，因此一个简单的选择是构建一个由唯一对键控的新数组，`site|time`同时遍历原始数组。

对于其中的每一个，我们还将创建一个`rating`值数组，最后，`implode()`将该数组转换为返回`'ratings'`键的字符串。

```
$rekeyed = array();
foreach ($test as $item) {
  // Build temporary key by concatenating site, time
  $key = $item['site'] . '|' . $item['time'];
  // If it already exists, add to the ratings
  if (isset($rekeyed[$key])) {
    $rekeyed[$key]['ratings'][] = $item['rating'];
  }
  else {
    // Otherwise, set the key and the ratings array
    $rekeyed[$key] = $item;
    // And set the first rating, initialized as an array
    $rekeyed[$key]['ratings'] = array();
    $rekeyed[$key]['ratings'][] = $item['rating'];
  }
}

// Finally, loop over and implode all the ratings back into a comma-separated string
foreach ($rekeyed as &$item) {
  $item['rating'] = implode(',', $item['ratings']);
  // Don't need the 'ratings' array anymore, unset it
  unset($item['ratings']);
}

var_dump($rekeyed); 
```

### 输出：

```
array(4) {
  ["Heavener SW|11-03-2012 Sat 10:00:00"]=>
  array(5) {
    ["id"]=>
    string(2) "45"
    ["rating"]=>
    string(5) "p1,h3"
    ["site"]=>
    string(11) "Heavener SW"
    ["time"]=>
    string(23) "11-03-2012 Sat 10:00:00"
  }
  ["Heavener SW|11-03-2012 Sat 16:00:00"]=>
  array(5) {
    ["id"]=>
    string(2) "45"
    ["rating"]=>
    string(2) "h4"
    ["site"]=>
    string(11) "Heavener SW"
    ["time"]=>
    string(23) "11-03-2012 Sat 16:00:00"
  }
  ["Red Oak|11-03-2012 Sat 16:00:00"]=>
  array(5) {
    ["id"]=>
    string(3) "110"
    ["rating"]=>
    string(5) "p3,h3"
    ["site"]=>
    string(7) "Red Oak"
    ["time"]=>
    string(23) "11-03-2012 Sat 16:00:00"
  }
  ["Panopoint|11-04-2012 Sun 10:00:00"]=>
  &array(5) {
    ["id"]=>
    string(2) "32"
    ["rating"]=>
    string(2) "p2"
    ["site"]=>
    string(9) "Panopoint"
    ["time"]=>
    string(23) "11-04-2012 Sun 10:00:00"
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T23:33:03.903

我认为 PHP foreach 循环按顺序进行，所以这应该有效。我还没有测试它，所以让我知道它是怎么回事。

```
$previous_id = '';
// for each row, check if it was the same as the previous row (since you have sorted it properly)
foreach($result as $k => $row){
    // if it matches the previous, add the rating and remove now duplicate row
    if ($row['time'] == $result[$previous_id]['time']
     && $row['site'] == $result[$previous_id]['site']){
        $result[$previous_id]['rating'] .= ', '.$row['rating'];
        unset($result[$k]);
    } // otherwise, set new previous_id to check
    else {
        $previous_id = $k;
    }
} 
```

这具有保留您遇到的第一个 row-id 的额外好处，但可能没有特别优化。

# javascript - IFrame 按钮点击事件

> ID：13214522
> 
> 赞同：2
> 
> 时间：2012-11-03T23:24:41.063
> 
> 标签：javascript, iframe

我正在尝试将事件侦听器附加到 IFrame 中页面上按钮的“单击”事件。iframe 中的页面与父窗口属于同一个域。

```
window.frames["iframe_Id"].document.getElementById("button_id").addEventListener("click",functionToRun,false); 
```

上面的示例对我不起作用。这可能只是我的实际代码中的语法错误，但我想看看这是否是一般想法。

**注意：**我发现了很多关于将点击事件添加到整个 iframe 的示例，但我不确定它对于 iframe 中的按钮是否同样有效。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-03T23:31:00.877

使用 jQuery：

```
$("#iframe_Id").contents("#button_id").click(functionToRun); 
```

或者没有 jQuery：

```
document.getElementById("iframe_Id").contentWindow.document.getElementById("button_id").addEventListener("click", functionToRun, false); 
```

这仅在 iframe 满足[相同的源策略时才有效。](https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T23:32:18.717

window.frames 是一个类似数组的对象，因此它的元素只能通过索引访问。

您应该遍历它们，并检查它们的 ID，例如：

```
var frame; for(i = 0; i < frames.length; i++) {
    frame = frames[i];
    if (frame.id === 'iframe_id') {
         frame.document
              .getElementById("button_id")
              .addEventListener("click",functionToRun,false);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T23:37:43.167

```
window.frames["iframe_Id"].contentWindow.document.getElementById("button_id").addEventListener("click",functionToRun,false);

                              ^ 
```

**[contentWindow](https://developer.mozilla.org/en-US/docs/HTML/Element/iframe)**属性。

> 从 DOM iframe 元素，脚本可以通过 contentWindow 属性访问包含的 HTML 页面的 window 对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-03T23:40:03.770

您是否尝试过在[“捕获”与“冒泡”](http://www.quirksmode.org/js/events_order.html)阶段执行事件？

```
document.getElementById("iframe_Id")
 .document.addEventListener("click", functionToRun, true); 
```

请注意，`true`而不是`false`作为最终参数。

# jquery - jquery动态添加图片

> ID：13214527
> 
> 赞同：1
> 
> 时间：2012-11-03T23:25:18.037
> 
> 标签：jquery

我正在尝试将图像动态添加到页面。我的 html 包含以下代码行：

```
 <div class="figuredisplay"></div> 
```

我的 css 包含以下代码行：

```
.figuredisplay {
  width:350px;
  height:600px;
  padding:10px;
  border:5px solid gray; 
 } 
```

现在，我正在动态获取图像位置，并尝试将这些图像添加到“figuredisplay”中。我正在使用 jquery 来做到这一点。所以，我的代码是这样的：

```
show_figure= function(figrlocation){
  $('.figuredisplay').empty();
  var figrhtmlcode='<img src="' + figrlocation + '" width="300" height="300">';
  $('.figuredisplay').append(figrhtmlcode);
 } 
```

但 div 中没有显示图像。当我尝试

```
 $('.figuredisplay').append(figrlocation); 
```

它在 div 元素上正确显示了图形位置（在磁盘上）。经过一番搜索后，我尝试了

```
$('<img src="'+ figrlocation +'">').load(function() {
  $(this).width(300).height(300).appendTo('.figuredisplay');
 }); 
```

同样，没有运气。任何人都可以指出我做错了什么吗？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T23:28:50.190

尝试使用 .html() 而不是追加。

所以它会是这样的：

```
var img = '<img src="image.jpg" width="300" height="300">';

$('.figuredisplay').html(img); 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T23:34:33.677

```
show_figure= function(figrlocation){
  $('.figuredisplay').empty();
  var figrhtmlcode='<img src="' + figrlocation + '" width="300" height="300">';
  $('.figuredisplay').append(figrhtmlcode);
 } 
```

这段代码应该可以工作。你确定 figrlocation 不是未定义的。检查您的控制台是否有错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-09T21:09:17.480

**我将使用 jQuery，在这里找到它：http: [//jquery.com/download/](http://jquery.com/download/)**
**我通过循环浏览文件夹中所有名为*pic*的图像（例如 pic1.jpg 、 pic2.jpg 、 pic3.jpg 等）来完成此操作。 ..)**

我过去是通过简单地向图像添加两个函数来做到这一点的。
第一个是`onLoad`

*   这将让我们调用我们的函数来添加下一张图片

第二个是`onError`

*   这将让我们调用我们的函数来停止加载图像（因为我们已经用完了它们）

首先，这是我们将使用的变量：

```
var preSrc = "/images/pic";     // This gives the first part of the path to the images
var n = 1;                     // This will be which image we are on (denoted by #)
var fileType = ".jpg";        // The file type for your images

// Now put it all together 

var imgSrc = preSrc + n + fileType; // This is the full source for your images

// Now add the rest of the html to be appended

var img = '<img src="' + imgSrc + '" onLoad="nextImg(' + n + ');" onError="stopLoad(this);" />'; 
```

那么这里发生了什么？
我们最初的几个变量是不言自明的，我们只是在创建图像的来源。不过，这里的最后一个变量有点困难。我们正在创建一个名为*img*的变量，它将保存将添加到文档中的实际 html 标记。它还保存当前图像的数据（n）。

它还有两个我想谈谈的属性。
首先是`onLoad`功能：

*   这里我们调用一个名为 的函数`nextImg`。我们稍后会创建这个函数，但现在只知道它会准备好并将我们文件夹中的下一个图像发布到页面。

第二个是`onError`功能：

*   这里我们调用一个名为 的函数`onError`。这绝对不是停止加载图像的*最佳*方法，但它是我个人发现的唯一一种可以使用纯 JavaScript 的方法。同样，我们将创建这是一个时刻，所以只要知道当我们用完图像时这将停止加载图像。

现在我们已经处理好图像的来源，我们需要编写将图像添加到页面的函数。可以通过几种不同的方式调用此函数，但我现在只使用一种。

```
//When the document is loaded, this function will be called

$(document).ready(function() {
    //Create the variables in this function so we can use them
    var preSrc = "/images/pic";
    var n = 1;
    var fileType = ".jpg";

    var imgSrc = preSrc + n + fileType;

    var img = '<img src="' + imgSrc + '" onLoad="nextImg(' + n + ');" onError="stopLoad(this);" />';

    $('#imgContainer').append(img); // Here we use jQuery to append our image to a container with the id of "imgContainer" (This can of course be changed)
}); 
```

所以现在我们的第一个图像在页面准备就绪时被加载，我们可以创建我们的“onLoad”函数：

```
// Here we create our "nextImg" function and create the variable called "currentImg" which will tell us what image was just loaded on the page  
function nextImg(currentImg) {

    //Create the variables in this function so we can use them
    var preSrc = "/images/pic";
    var n = currentImg++; // We add 1 to the current image number so that we can publish the next image in the folder to our page
    var fileType = ".jpg";

    var imgSrc = preSrc + n + fileType;

    var img = '<img src="' + imgSrc + '" onLoad="nextImg(' + n + ');" onError="stopLoad(this);" />';

    $('#imgContainer').append(img); // Now that we have incremented our image number, this statement will now add the next image in our folder to the page.
} 
```

两个下来，一个去！
现在让我们开始处理最后一个函数`onError`.

```
// Here we have the same setup as the last function except for the name
function stopLoad(currentImg) { 

    // Now we simply make sure that there is no "broken image" link left on the page
    $(currentImg).css('display', 'none');
    $(currentImg).css('visibility', 'hidden');
} 
```

希望这对您有所帮助，如果您有任何问题或建议（我相信有更好的方法可以做到这一点），请随时告诉我！

# c++ - Visual Studio 还能优化预编译代码吗？

> ID：13214529
> 
> 赞同：4
> 
> 时间：2012-11-03T23:25:25.447
> 
> 标签：c++, visual-studio, optimization

好的，解释我的问题的最佳方法是通过 2 个示例：

**示例 1：**

*您已经为自己创建了一个框架或某种称为 MyLibrary 的引擎，并且您已经构建了一个具有最大优化选项的**.lib**。现在您包含标题并将**.lib**链接到一个名为 MyImplementation 的新项目中。该项目使用了大部分MyLibrary 的功能，完成后，您构建项目（再次进行最大优化）。*

**示例 2：**

*同样，您拥有相同的库，但不是构建它，而是将其保持**开源**。然后您制作相同的 MyProject，包含标题并构建 MyProject，并启用最大优化。*

那么，**示例 2**会运行得更快吗，因为编译器可以访问整个源代码（框架/引擎 + 您使用它的项目）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T23:37:30.310

静态库是预编译的，这意味着任何进一步的优化都取决于链接器。如今，链接器可以获得很大的性能提升，但通常最好的结果来自配置文件引导优化，这确实需要特殊的编译器设置来引导配置文件。最好将项目开源（除非您正在保护知识产权），因为这样开发人员就可以为他们的平台和编译器编译项目，更不用说没有源代码几乎不可能进行调试。

# objective-c - 如何在条件下更改 UI 文本字段颜色

> ID：13214530
> 
> 赞同：-1
> 
> 时间：2012-11-03T23:25:30.457
> 
> 标签：objective-c, ios, uitextfield

我有一个带有“通过”或“失败”选项的 UIpicker，如果 UIText 字段收到“失败”一词，是否可以将“失败”的显示文本颜色更改为红色（当前为黑色）？

我在想一个 if 语句吗？

`if textbox1.text = @"Fail"`....然后呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T00:32:10.073

```
if ([textbox1.text isEqualToString:@"Fail"]){
    textbox1.textColor = [UIColor blackColor];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T00:18:18.620

您可以`UITextField`通过将 设置`textColor`为所需的颜色来设置 a 中文本的颜色。

要比较两个字符串，您需要使用`isEqualToString:`方法，而不是赋值运算符`=`。

# php - 通过 .htaccess 将 $_GET 变量传递给虚拟目录

> ID：13214531
> 
> 赞同：4
> 
> 时间：2012-11-03T23:25:38.063
> 
> 标签：php, .htaccess, mod-rewrite

我有以下`.htaccess` **重写规则**，用于将虚拟目录转换为参数，例如：

`www.example.com/usa/ny/nyc`被 PHP 解释为`www.example.com/index.php?path=usa/ny/nyc`.

我似乎无法弄清楚我将如何更改`regex`下面的内容以处理虚拟目录本身的参数。例如，我想要：

`www.example.com/usa/ny/nyc/?display=off&settings=none`被 PHP 视为`www.example.com/index.php?path=usa/ny/nyc&param=display:off,settings:none`.

更棘手的是，参数并不总是我在上面示例中使用的那两个选项，它们会动态变化。关于如何实现这一目标的任何想法或建议？

```
RewriteRule ^/?([a-zA-Z_\-/]+)$ index.php?path=$1 [L] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T23:30:46.413

假设您想传递未修改的查询字符串，您可以使用`[QSA]`(query string append) 选项，如下所示：

```
RewriteRule /(.+)$ /index.php?path=$1 [L,QSA] 
```

[您可以在此处](http://httpd.apache.org/docs/current/rewrite/flags.html)找到该`QSA`选项的文档。从文档：

> 使用 [QSA] 标志，对 /pages/123?one=two 的请求将被映射到 /page.php?page=123&one=two。如果没有 [QSA] 标志，相同的请求将被映射到 /page.php?page=123 - 也就是说，现有的查询字符串将被丢弃。

因此，您的 PHP 脚本会将所有参数视为标准`_$_GET`参数，而不需要进行任何其他修改。

如果您希望将结果更像是典型的路径元素，您可以使用以下内容：

```
RewriteRule /(.+)$ /index.php/$1 [L,QSA] 
```

在上述情况下，您的查询字符串仍将被附加，但是您需要使用`$_SERVER['PATH_INFO']`.

# installation - 由于已弃用的核心音频功能，无法安装端口音频

> ID：13214534
> 
> 赞同：4
> 
> 时间：2012-11-03T23:26:18.083
> 
> 标签：installation, core-audio, deprecated, portaudio

我一直在尝试将 Port Audio 安装到我的 Mac 上，但遇到了困难。每次我尝试使用以下方式安装它时：

```
./configure --disable-mac-universal && make 
```

它以错误代码 1 退出，因为 CoreAudio 具有已弃用的功能。我听说 CoreAudio 在最近的一次更新中坏了，或者被弄乱了，也许这导致了我的问题？我不确定现在要尝试什么，因为我找不到在我的计算机上回滚 Core Audio 框架版本的方法。你们的任何建议都会很棒。

Mac OSX 10.7.5
XCode 4.5.2
最新的 PortAudio 版本

* * *

实际错误代码：

`AVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DLT_OBJDIR=\".libs/\" -DSIZEOF_SHORT=2 -DSIZEOF_INT=4 -DSIZEOF_LONG=8 -DHAVE_NANOSLEEP=1 -DPA_USE_COREAUDIO=1 src/hostapi/coreaudio/pa_mac_core.c -fno-common -DPIC -o src/hostapi/coreaudio/.libs/pa_mac_core.o cc1: warnings being treated as errors src/hostapi/coreaudio/pa_mac_core.c: In function 'PaMacCore_GetChannelName': src/hostapi/coreaudio/pa_mac_core.c:140: warning: 'AudioDeviceGetPropertyInfo' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2611) src/hostapi/coreaudio/pa_mac_core.c:151: warning: 'AudioDeviceGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2640) src/hostapi/coreaudio/pa_mac_core.c:159: warning: 'AudioDeviceGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2640) src/hostapi/coreaudio/pa_mac_core.c:193: warning: 'AudioDeviceGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2640) src/hostapi/coreaudio/pa_mac_core.c: In function 'PaMacCore_GetBufferSizeRange': src/hostapi/coreaudio/pa_mac_core.c:232: warning: 'AudioDeviceGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2640) src/hostapi/coreaudio/pa_mac_core.c: In function 'gatherDeviceInfo': src/hostapi/coreaudio/pa_mac_core.c:361: warning: 'AudioHardwareGetPropertyInfo' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:1249) src/hostapi/coreaudio/pa_mac_core.c:374: warning: 'AudioHardwareGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:1270) src/hostapi/coreaudio/pa_mac_core.c:393: warning: 'AudioHardwareGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:1270) src/hostapi/coreaudio/pa_mac_core.c:410: warning: 'AudioHardwareGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:1270) src/hostapi/coreaudio/pa_mac_core.c: In function 'ClipToDeviceBufferSize': src/hostapi/coreaudio/pa_mac_core.c:445: warning: 'AudioDeviceGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2640) src/hostapi/coreaudio/pa_mac_core.c: In function 'CalculateFixedDeviceLatency': src/hostapi/coreaudio/pa_mac_core.c:525: warning: 'AudioDeviceGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2640) src/hostapi/coreaudio/pa_mac_core.c:530: warning: 'AudioStreamGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:3023) src/hostapi/coreaudio/pa_mac_core.c:534: warning: 'AudioDeviceGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2640) src/hostapi/coreaudio/pa_mac_core.c:538: warning: 'AudioDeviceGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2640) src/hostapi/coreaudio/pa_mac_core.c: In function 'CalculateDefaultDeviceLatencies': src/hostapi/coreaudio/pa_mac_core.c:568: warning: 'AudioDeviceGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2640) src/hostapi/coreaudio/pa_mac_core.c: In function 'GetChannelInfo': src/hostapi/coreaudio/pa_mac_core.c:597: warning: 'AudioDeviceGetPropertyInfo' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2611) src/hostapi/coreaudio/pa_mac_core.c:604: warning: 'AudioDeviceGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2640) src/hostapi/coreaudio/pa_mac_core.c: In function 'InitializeDeviceInfo': src/hostapi/coreaudio/pa_mac_core.c:670: warning: 'AudioDeviceGetPropertyInfo' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2611) src/hostapi/coreaudio/pa_mac_core.c:677: warning: 'AudioDeviceGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2640) src/hostapi/coreaudio/pa_mac_core.c:684: warning: 'AudioDeviceGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2640) src/hostapi/coreaudio/pa_mac_core.c: In function 'UpdateSampleRateFromDeviceProperty': src/hostapi/coreaudio/pa_mac_core.c:1033: warning: 'AudioDeviceGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2640) src/hostapi/coreaudio/pa_mac_core.c: In function 'QueryUInt32DeviceProperty': src/hostapi/coreaudio/pa_mac_core.c:1062: warning: 'AudioDeviceGetProperty' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2640) src/hostapi/coreaudio/pa_mac_core.c: In function 'SetupDevicePropertyListeners': src/hostapi/coreaudio/pa_mac_core.c:1120: warning: 'AudioDeviceAddPropertyListener' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2703) src/hostapi/coreaudio/pa_mac_core.c:1123: warning: 'AudioDeviceAddPropertyListener' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2703) src/hostapi/coreaudio/pa_mac_core.c:1125: warning: 'AudioDeviceAddPropertyListener' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2703) src/hostapi/coreaudio/pa_mac_core.c:1127: warning: 'AudioDeviceAddPropertyListener' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2703) src/hostapi/coreaudio/pa_mac_core.c: In function 'CleanupDevicePropertyListeners': src/hostapi/coreaudio/pa_mac_core.c:1135: warning: 'AudioDeviceRemovePropertyListener' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2729) src/hostapi/coreaudio/pa_mac_core.c:1138: warning: 'AudioDeviceRemovePropertyListener' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2729) src/hostapi/coreaudio/pa_mac_core.c:1140: warning: 'AudioDeviceRemovePropertyListener' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2729) src/hostapi/coreaudio/pa_mac_core.c:1142: warning: 'AudioDeviceRemovePropertyListener' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2729) src/hostapi/coreaudio/pa_mac_core.c: In function 'OpenAndSetupOneAudioUnit': src/hostapi/coreaudio/pa_mac_core.c:1304: warning: 'AudioDeviceAddPropertyListener' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2703) src/hostapi/coreaudio/pa_mac_core.c: In function 'AudioIOProc': src/hostapi/coreaudio/pa_mac_core.c:2340: warning: 'AudioConverterFillBuffer' is deprecated (declared at /System/Library/Frameworks/AudioToolbox.framework/Headers/AudioConverter.h:699) src/hostapi/coreaudio/pa_mac_core.c:2519: warning: 'AudioConverterFillBuffer' is deprecated (declared at /System/Library/Frameworks/AudioToolbox.framework/Headers/AudioConverter.h:699) src/hostapi/coreaudio/pa_mac_core.c: In function 'CloseStream': src/hostapi/coreaudio/pa_mac_core.c:2599: warning: 'AudioDeviceRemovePropertyListener' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2729) src/hostapi/coreaudio/pa_mac_core.c:2608: warning: 'AudioDeviceRemovePropertyListener' is deprecated (declared at /System/Library/Frameworks/CoreAudio.framework/Headers/AudioHardware.h:2729) make: *** [src/hostapi/coreaudio/pa_mac_core.lo] Error 1`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T15:20:49.150

如果更新到最新的 PortAudio SVN 不能解决问题，这是邮件列表中的建议：

从构建脚本中删除 -Werror 并将其替换为 -Wall

或者尝试在 -Werror 之前添加 -Wno-deprecated

如果您确实尝试添加 -Wno-deprecated，请告诉我们您的情况，因为这是目前的首选选项，尽管它尚未经过太多测试。

我相信，“构建脚本”是指 configure.in。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-03T17:07:19.490

这对我有用（-w 禁用 GCC 中的所有警告）

```
CFLAGS=-w ./configure && make 
```

我尝试了-Wno-depreacted，但它对我不起作用：

```
command line option "-Wno-deprecated" is valid for C++/Java/ObjC++ but not for C 
```

# c - 如何生成 .exe 驱动程序而不是 .sys？

> ID：13214541
> 
> 赞同：2
> 
> 时间：2012-11-03T23:28:01.147
> 
> 标签：c, kernel, driver, mode

我是内核模式世界的新手。我尝试在 Windows 7 虚拟机中编写一个简单的“hello world”驱动程序，我正在使用 WDK 7600.16385.1 -> x86 Free Build Environment 进行编译，当它编译时，生成的驱动程序是一个 .sys 文件扩展名，所以我想知道是否可以设置编译器以生成 .exe 文件，以便用户可以通过双击可执行文件来运行它。

我想也许，当我安装一些驱动程序并且“设置”是一个 .exe 文件时，实际上它并不是真正的驱动程序，它是一个在您的计算机上安装驱动程序（以 .sys 扩展名）的程序，所以.exe 文件只是安装程序，而不是驱动程序本身。但我不确定这是否属实。

如果您能给我一些有关为 Windoes 生成驱动程序的信息，我将永远感激不尽！

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T23:31:01.077

`.exe`您正在查看的文件确实是安装程序。有许多工具可用于创建安装程序；[NSIS](http://nsis.sourceforge.net/)是较受欢迎的选项之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T19:19:22.723

`.exe`标记 Windows 用户模式的可执行文件。用户模式和内核模式“可执行文件”的格式有很大不同。特别是，没有用户运行内核可执行文件之类的东西。用户模式不能直接访问内核驱动程序；仅允许通过操作系统定义的接口进行通信，即用户模式组件必须执行专用的操作系统调用，该调用将由操作系统路由到内核组件。内核模式和用户模式之间还有很多区别，但是这个特殊的区别解释了为什么用户无法运行内核驱动程序（也不应该）。

至于你的第二个问题，是的，这些`.exe`文件是安装程序。

# ios - 在 MapView 上绘制矩形

> ID：13214542
> 
> 赞同：2
> 
> 时间：2012-11-03T23:28:18.340
> 
> 标签：ios, mapkit

我的应用程序在以下覆盖区域中获取数据。我想使用这些边界值在地图上绘制矩形。你有什么主意吗？提前致谢

> 左上界：30.439217,-95.899668；
> 
> 右上边界：30.443953，-94.685679；
> 
> 左下边界：28.930662,-95.908595；
> 
> 右下边界：28.930061,-94.690486；

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T00:37:04.577

如果你想用线条画一些基本的东西，你可以使用这个 MKPolyline

试试下面的代码，确保您的委托与您的地图视图对象连接

```
- (void) drawRect
{

    CLLocation *coordinates1 =  [[CLLocation alloc] initWithLatitude:30.439217 longitude:-95.899668];

    CLLocation *coordinates2 =  [[CLLocation alloc] initWithLatitude:30.443953 longitude:-94.685679];

    CLLocation *coordinates3 =  [[CLLocation alloc] initWithLatitude:28.930061 longitude:-94.690486];

    CLLocation *coordinates4 =  [[CLLocation alloc] initWithLatitude:28.930662 longitude:-95.908595];

    NSMutableArray *locationCoordinates = [[NSMutableArray alloc] initWithObjects:coordinates1,coordinates2,coordinates3,coordinates4,coordinates1, nil];

    int numberOfCoordinates = [locationCoordinates count];

    CLLocationCoordinate2D coordinates[numberOfCoordinates];

    for (NSInteger i = 0; i < [locationCoordinates count]; i++) {

        CLLocation *location = [locationCoordinates objectAtIndex:i];
        CLLocationCoordinate2D coordinate = location.coordinate;

        coordinates[i] = coordinate;
    }

    MKPolyline *polyLine = [MKPolyline polylineWithCoordinates:coordinates count:numberOfCoordinates];
    [self.myMapView addOverlay:polyLine];

}

- (MKOverlayView *)mapView:(MKMapView *)mapView viewForOverlay:(id <MKOverlay>)overlay {

    MKPolylineView *polylineView = [[MKPolylineView alloc] initWithPolyline:overlay];
    polylineView.strokeColor = [UIColor redColor];
    polylineView.lineWidth = 1.0;

    return polylineView;
} 
```

更新：这是 drawRect 函数的快速版本

```
func drawRect() {
    let coordinates1 = CLLocation(latitude: 30.439217, longitude: -95.899668)
    let coordinates2 = CLLocation(latitude: 30.443953, longitude: -94.685679)
    let coordinates3 = CLLocation(latitude: 28.930061, longitude: -94.690486)
    let coordinates4 = CLLocation(latitude: 28.930662, longitude: -95.908595)
    let locationCoordinates = [coordinates1,coordinates2,coordinates3,coordinates4,coordinates1]

    let coordinates = locationCoordinates.map { $0.coordinate }

    let polyLine = MKPolyline(coordinates: coordinates, count: coordinates.count)
    mapView.addOver(polyLine)
} 
```

更换

```
- (MKOverlayView *)mapView:(MKMapView *)mapView viewForOverlay:(id <MKOverlay>)overlay (deprecated) 
```

和

```
func mapView(mapView: MKMapView, rendererForOverlay overlay: MKOverlay) -> MKOverlayRenderer 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T00:14:43.077

既然你问了一个一般性的问题，我只能给你一个一般性的提示。

MKMapView 有一个方法`convertCoordinate:toPointToView:`可以将坐标转换为视图中的一个点。您可以使用它在叠加层上绘制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T00:21:11.863

第一的：

```
#import <QuartzCore/QuartzCore.h> 
```

然后在您想要的地方执行此操作：

```
CLLocationCoordinate2D koor = CLLocationCoordinate2DMake(30.439217,-95.899668);
CLLocationCoordinate2D koor2 = CLLocationCoordinate2DMake(30.443953,-94.685679);
CLLocationCoordinate2D koor3 = CLLocationCoordinate2DMake(28.930662,-95.908595);
CGPoint point1 = [mapView convertCoordinate:koor toPointToView:mapView];
CGPoint point2 = [mapView convertCoordinate:koor2 toPointToView:mapView];
CGPoint point3 = [mapView convertCoordinate:koor3 toPointToView:mapView];
UIView *someView = [[UIView alloc]initWithFrame:CGRectMake(point1.x, point1.y, point2.x-point1.x, point3.y-point1.y)];
[self viewBicimle:someView];
[someView setBackgroundColor:[UIColor clearColor]];
[someView.layer setBorderColor:[[[UIColor blackColor] colorWithAlphaComponent:1.0] CGColor]];
[someView.layer setBorderWidth:1.0];
[mapView addSubview:someView];
[someView release]; 
```

但这仅适用于不可移动的某些 MapView。当您移动地图时，它会滑动...

# java - java.lang.IllegalArgumentException：需要属性“transactionManager”

> ID：13214551
> 
> 赞同：7
> 
> 时间：2012-11-03T23:29:32.300
> 
> 标签：java, spring, hibernate

部署 Spring 应用程序时出现以下错误：

java.lang.IllegalArgumentException：需要属性“transactionManager”

我正在使用： OS：OSX Mountain Lion IDE：Springsource Tools Suite 3.1.0 Spring：3.1.2 Hibernate：4.1.7 Java：1.6 webserver：vFabric tomcat v2.7

我有一些缺少的配置吗？我的 pom.xml 中的库是否错误？

部署日志：

```
Nov 3, 2012 2:32:12 PM org.apache.catalina.core.StandardContext loadOnStartup
SEVERE: Servlet /basicServer threw load() exception
java.lang.IllegalArgumentException: Property 'transactionManager' is required
    at org.springframework.transaction.interceptor.TransactionAspectSupport.afterPropertiesSet(TransactionAspectSupport.java:195)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:292)
    at org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerByCGLIB$$8779d852.transactionInterceptor(<generated>)
    at org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration.transactionAdvisor(ProxyTransactionManagementConfiguration.java:46)
    at org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerByCGLIB$$8779d852.CGLIB$transactionAdvisor$0(<generated>)
    at org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerByCGLIB$$8779d852$$FastClassByCGLIB$$4a8a503d.invoke(<generated>)
    at net.sf.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:228)
    at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:280)
    at org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration$$EnhancerByCGLIB$$8779d852.transactionAdvisor(<generated>)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:149)
    at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:570)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1015)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:911)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
    at org.springframework.aop.framework.autoproxy.BeanFactoryAdvisorRetrievalHelper.findAdvisorBeans(BeanFactoryAdvisorRetrievalHelper.java:86)
    at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.findCandidateAdvisors(AbstractAdvisorAutoProxyCreator.java:100)
    at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.findEligibleAdvisors(AbstractAdvisorAutoProxyCreator.java:86)
    at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.getAdvicesAndAdvisorsForBean(AbstractAdvisorAutoProxyCreator.java:68)
    at org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.wrapIfNecessary(AbstractAutoProxyCreator.java:359)
    at org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.postProcessAfterInitialization(AbstractAutoProxyCreator.java:322)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsAfterInitialization(AbstractAutowireCapableBeanFactory.java:407)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1461)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:353)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1015)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:911)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:848)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:748)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:707)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)
    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:353)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1015)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:911)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
    at org.springframework.aop.framework.autoproxy.BeanFactoryAdvisorRetrievalHelper.findAdvisorBeans(BeanFactoryAdvisorRetrievalHelper.java:86)
    at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.findCandidateAdvisors(AbstractAdvisorAutoProxyCreator.java:100)
    at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.findEligibleAdvisors(AbstractAdvisorAutoProxyCreator.java:86)
    at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.getAdvicesAndAdvisorsForBean(AbstractAdvisorAutoProxyCreator.java:68)
    at org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.wrapIfNecessary(AbstractAutoProxyCreator.java:359)
    at org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.postProcessAfterInitialization(AbstractAutoProxyCreator.java:322)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsAfterInitialization(AbstractAutowireCapableBeanFactory.java:407)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1461)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
    at org.springframework.context.support.AbstractApplicationContext.registerBeanPostProcessors(AbstractApplicationContext.java:740)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:449)
    at org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:631)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:588)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:645)
    at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:508)
    at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:449)
    at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:133)
    at javax.servlet.GenericServlet.init(GenericServlet.java:160)
    at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1266)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1185)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1080)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:5027)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5314)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:618)
    at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:650)
    at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1582)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:680)
Nov 3, 2012 2:32:12 PM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory /Users/bruce/springsource/vfabric-tc-server-developer-2.7.2.RELEASE/base-instance/webapps/manager
Nov 3, 2012 2:32:12 PM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory /Users/bruce/springsource/vfabric-tc-server-developer-2.7.2.RELEASE/base-instance/webapps/ROOT
Nov 3, 2012 2:32:13 PM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["http-bio-8080"]
Nov 3, 2012 2:32:13 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 8754 ms 
```

我的配置文件（ServicesConfiguration.java AppConfig.java）ServicesConfiguration.java：

```
package com.bsches.basicServer.config;

import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;
import java.util.Properties;

import javax.sql.DataSource;

import org.hibernate.SessionFactory;
import org.hibernate.dialect.H2Dialect;
import org.hibernate.service.ServiceRegistry;
import org.hibernate.service.ServiceRegistryBuilder;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.cache.Cache;
import org.springframework.cache.CacheManager;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.cache.concurrent.ConcurrentMapCache;
import org.springframework.cache.support.SimpleCacheManager;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.jdbc.datasource.DriverManagerDataSource;
import org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseBuilder;
import org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseType;
import org.springframework.orm.hibernate4.HibernateTransactionManager;
import org.springframework.orm.hibernate4.LocalSessionFactoryBuilder;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.annotation.EnableTransactionManagement;
import org.springframework.web.servlet.config.annotation.EnableWebMvc;

import com.bsches.basicServer.services.CustomerService;

import entities.Customer;

@Configuration
@EnableCaching
@EnableWebMvc
@EnableTransactionManagement
public class ServicesConfiguration {

    @Value("${jdbc.driverClassName}")
    private String driverClassName;
    @Value("${jdbc.url}")
    private String url;
    @Value("${jdbc.username}")
    private String username;
    @Value("${jdbc.password}")
    private String password;

    @Value("${hibernate.dialect}")
    private String hibernateDialect;
    @Value("${hibernate.show_sql}")
    private String hibernateShowSql;
    @Value("${hibernate.hbm2ddl.auto}")
    private String hibernateHbm2ddlAuto;

    @Bean
    public CustomerService customerService() throws Exception {
        return new CustomerService(this.sessionFactory());
    }

    @Bean
    public SessionFactory sessionFactory() throws Exception {
        Properties props = new Properties();

        Map<String, String> p = new HashMap<String, String>();
        p.put(org.hibernate.cfg.Environment.HBM2DDL_AUTO, hibernateHbm2ddlAuto);
        p.put(org.hibernate.cfg.Environment.HBM2DDL_IMPORT_FILES,
                "import_h2.sql");
        p.put(org.hibernate.cfg.Environment.DIALECT, hibernateDialect);
        p.put(org.hibernate.cfg.Environment.SHOW_SQL, hibernateShowSql);
        Map<String, String> propsMap = p;

        for (String k : propsMap.keySet())
            props.setProperty(k, propsMap.get(k));

         org.hibernate.cfg.Configuration configuration = new org.hibernate.cfg.Configuration();
         configuration.configure();
         ServiceRegistry serviceRegistry = new ServiceRegistryBuilder().applySettings(props).buildServiceRegistry();        
         SessionFactory sessionFactory = configuration.buildSessionFactory(serviceRegistry);
         return sessionFactory;

    }

    @Bean
    public PlatformTransactionManager transactionManager() throws Exception {
        return new HibernateTransactionManager(sessionFactory());
    }

    @Bean()
    public DataSource dataSource() {
        DriverManagerDataSource ds = new DriverManagerDataSource();
        ds.setDriverClassName(driverClassName);
        ds.setUrl(url);
        ds.setUsername(username);
        ds.setPassword(password);
        return ds;
    }

    @Bean
    public CacheManager cacheManager() throws Exception {
        SimpleCacheManager scm = new SimpleCacheManager();
        Cache cache = new ConcurrentMapCache("customers");
        scm.setCaches(Arrays.asList(cache));
        return scm;
    }
} 
```

AppConfig.java：

```
package com.bsches.basicServer.config;

import org.springframework.beans.factory.config.PropertyPlaceholderConfigurer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import org.springframework.core.io.ClassPathResource;

@Import({ServicesConfiguration.class})
@Configuration
public class AppConfig {
    @Bean
    public static PropertyPlaceholderConfigurer getPropertyPlaceholderConfigurer()
    {
        PropertyPlaceholderConfigurer ppc = new PropertyPlaceholderConfigurer();
        ppc.setLocation(new ClassPathResource("application.properties"));
        ppc.setIgnoreUnresolvablePlaceholders(true);
        return ppc;
    }

} 
```

pom.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.bsches</groupId>
    <artifactId>basicServer</artifactId>
    <name>basicServer</name>
    <packaging>war</packaging>
    <version>1.0.0-BUILD-SNAPSHOT</version>
    <properties>
        <java-version>1.6</java-version>
        <org.springframework-version>3.1.0.RELEASE</org.springframework-version>
        <org.aspectj-version>1.6.9</org.aspectj-version>
        <org.slf4j-version>1.5.10</org.slf4j-version>
    </properties>
    <dependencies>
        <!-- Spring -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>${org.springframework-version}</version>
            <exclusions>
                <!-- Exclude Commons Logging in favor of SLF4j -->
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                 </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>

        <!-- AspectJ -->
        <dependency>
            <groupId>org.aspectj</groupId>
            <artifactId>aspectjrt</artifactId>
            <version>${org.aspectj-version}</version>
        </dependency>   

        <!-- Logging -->
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>${org.slf4j-version}</version>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>jcl-over-slf4j</artifactId>
            <version>${org.slf4j-version}</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-log4j12</artifactId>
            <version>${org.slf4j-version}</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>1.2.15</version>
            <exclusions>
                <exclusion>
                    <groupId>javax.mail</groupId>
                    <artifactId>mail</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>javax.jms</groupId>
                    <artifactId>jms</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>com.sun.jdmk</groupId>
                    <artifactId>jmxtools</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>com.sun.jmx</groupId>
                    <artifactId>jmxri</artifactId>
                </exclusion>
            </exclusions>
            <scope>runtime</scope>
        </dependency>

        <!-- @Inject -->
        <dependency>
            <groupId>javax.inject</groupId>
            <artifactId>javax.inject</artifactId>
            <version>1</version>
        </dependency>

        <!-- Servlet -->
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>servlet-api</artifactId>
            <version>2.5</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>javax.servlet.jsp</groupId>
            <artifactId>jsp-api</artifactId>
            <version>2.1</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>

        <!-- Test -->
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.7</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-jdbc</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-jpa</artifactId>
            <version>2.0.8</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-orm</artifactId>
            <version>3.1.2.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>5.0.0.Alpha1</version>
        </dependency>
        <dependency>
            <groupId>cglib</groupId>
            <artifactId>cglib</artifactId>
            <version>2.2.2</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>4.1.7.Final</version>
        </dependency>
    </dependencies>
    <build>
        <plugins>
            <plugin>
                <artifactId>maven-eclipse-plugin</artifactId>
                <version>2.9</version>
                <configuration>
                    <additionalProjectnatures>
                        <projectnature>org.springframework.ide.eclipse.core.springnature</projectnature>
                    </additionalProjectnatures>
                    <additionalBuildcommands>
                        <buildcommand>org.springframework.ide.eclipse.core.springbuilder</buildcommand>
                    </additionalBuildcommands>
                    <downloadSources>true</downloadSources>
                    <downloadJavadocs>true</downloadJavadocs>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                    <compilerArgument>-Xlint:all</compilerArgument>
                    <showWarnings>true</showWarnings>
                    <showDeprecation>true</showDeprecation>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>exec-maven-plugin</artifactId>
                <version>1.2.1</version>
                <configuration>
                    <mainClass>org.test.int1.Main</mainClass>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T23:46:26.323

> 春天：3.1.2

你确定你使用的是 Spring 3.1.2 吗？

我查看了代码，`TransactionAspectSupport.afterPropertiesSet(TransactionAspectSupport.java:195)`从 3.1.2 版开始没有抛出异常。

也许你的类路径上有 2 个不同的版本？

您的 pom.xml 建议使用 3.1.0.RELEASE。

```
<org.springframework-version>3.1.0.RELEASE</org.springframework-version> 
```

你最好只使用一个版本的 Spring Framework。混合版本可能会出现奇怪的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T23:39:28.913

在你的 spring 配置中，你在某处有 transactionManager 属性，但你没有定义它。你应该有类似的东西：

```
<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="entityManagerFactory" />
</bean>

<tx:annotation-driven transaction-manager="transactionManager" />

<bean id="entityManagerFactoryclass="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
     <property name="dataSource" ref="dataSource" />
     <property name="persistenceUnitName" value="persistenceUnit"></property>
</bean>

.... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-14T14:25:37.067

在我的情况下，由于旧的依赖关系，旧的 spring-dao 库被引入。排除 spring-dao 解决了这个问题。

# php - Symfony2 多对多未保存

> ID：13214552
> 
> 赞同：1
> 
> 时间：2012-11-03T23:29:35.260
> 
> 标签：php, symfony, many-to-many

我有一个 M2M 关系，但是当我创建一个项目时，关系没有保存，我找不到问题出在哪里。该模型：

```
class Serie
 {    

/**
 * @ORM\ManyToMany(targetEntity="Magazine", mappedBy="series")
 * */
protected $magazines;

/**
 * Constructor
 */
public function __construct()
{
    $this->magazines = new \Doctrine\Common\Collections\ArrayCollection();
}

/**
 * Add magazines
 *
 * @param MyList\DBBundle\Entity\Magazine $magazines
 * @return Serie
 */
public function addMagazine(\MyList\DBBundle\Entity\Magazine $magazines)
{
    $this->magazines[] = $magazines;

    return $this;
}

/**
 * Remove magazines
 *
 * @param MyList\DBBundle\Entity\Magazine $magazines
 */
public function removeMagazine(\MyList\DBBundle\Entity\Magazine $magazines)
{
    $this->magazines->removeElement($magazines);
}

/**
 * Get magazines
 *
 * @return Doctrine\Common\Collections\Collection 
 */
public function getMagazines()
{
    return $this->magazines;
}
} 
```

杂志类：

```
class Magazine
{

/**
 * @ORM\ManyToMany(targetEntity="Serie" , inversedBy="magazines")
 * @ORM\JoinTable(name="magazines_series")
 * */
protected $series;

public function __construct()
{
    $this->series = new \Doctrine\Common\Collections\ArrayCollection();
}

/**
 * Add series
 *
 * @param MyList\DBBundle\Entity\Serie $series
 * @return Magazine
 */
public function addSerie(\MyList\DBBundle\Entity\Serie $serie)
{
    $serie->addMagazine($this);
    $this->series[] = $serie;

    return $this;
}

/**
 * Remove series
 *
 * @param MyList\DBBundle\Entity\Serie $series
 */
public function removeSerie(\MyList\DBBundle\Entity\Serie $series)
{
    $this->series->removeElement($series);
}

/**
 * Get series
 *
 * @return Doctrine\Common\Collections\Collection 
 */
public function getSeries()
{
    return $this->series;
}
} 
```

控制器类 SerieController 扩展控制器 { public function newAction() { $entity = new Serie(); $form = $this->createForm(new SerieType(), $entity);

```
 return array(
        'entity' => $entity,
        'form'   => $form->createView(),
    );
}

/**
 * Creates a new Serie entity.
 *
 * @Route("/create", name="serie_create")
 * @Method("POST")
 * @Template("DBBundle:Serie:new.html.twig")
 */
public function createAction(Request $request)
{
    $entity  = new Serie();
    $form = $this->createForm(new SerieType(), $entity);
    $form->bind($request);

    if ($form->isValid()) {
        $em = $this->getDoctrine()->getManager();
        $em->persist($entity);
        $em->flush();

        return $this->redirect($this->generateUrl('serie_show', array('id' => $entity->getId())));
    }

    return array(
        'entity' => $entity,
        'form'   => $form->createView(),
    );
}
} 
```

和表格：

```
class SerieType extends AbstractType
{
public function buildForm(FormBuilderInterface $builder, array $options)
{
    $builder
        ->add('title')
        ->add('start')
        ->add('end')
        ->add('type')
        ->add('status')
        ->add('magazines','entity',array(
                'class' => 'DBBundle:Magazine',
                'multiple' => true,
                'property' => 'name'
                ))
    ;
}

public function setDefaultOptions(OptionsResolverInterface $resolver)
{
    $resolver->setDefaults(array(
        'data_class' => 'MyList\DBBundle\Entity\Serie'
    ));
}

public function getName()
{
    return 'mylist_dbbundle_serietype';
}
} 
```

我知道对此有一些问题（即[Symfony2-Doctrine: ManyToMany 关系未保存到数据库](https://stackoverflow.com/questions/7044864/symfony2-doctrine-manytomany-relation-is-not-saved-to-database)），但它们都没有解决我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T23:51:44.327

这是因为你从来没有`persist()`杂志，表格已经将它添加到实体中，但 Doctrine 仍然需要管理它。

将其添加到`if ($form->isValid())`：

```
...
$magazines = $entity->getMagazines();
foreach($magazines as $magazine){
    $em->persist($magazine);
}
...
$em->flush(); 
```

# c - 重新初始化数组正在创建段错误？

> ID：13214567
> 
> 赞同：0
> 
> 时间：2012-11-03T23:32:12.740
> 
> 标签：c, memory-management, initialization, segmentation-fault

我正在对来自输入文件的格式（u、v、权重）的大型图形数据集运行广度优先搜索和贝尔曼福特算法。

我在广度优先搜索中初始化，所有顶点都应该标记为 0 表示未访问。

在程序的后期，因为我在每次添加边之后都调用 BFS，而不是在程序结束时一起调用（它是贝尔曼福特和 BFS 研究项目的一部分，尽管它不太有意义）我将顶点数组重新初始化为未访问。

但是，当我运行更大的集合时，我遇到了分段错误，似乎在我重新初始化顶点数组时。我对更大的集合做出假设，因为我有一些较小的测试数据集，从 8 个顶点到 10 个，然后在 100 个或更大时它失败了。

以下是我在程序开始时的初始化方式：

```
for(i=0;i<numberVertices;i++)
{
    vertexArray[i].v = i+1;
    vertexArray[i].adj = NULL;
    vertexArray[i].marked = 0;
    if(i==0)
    {
        vertexArray[i].weight = 0;
    }
    else{
        vertexArray[i].weight = 10000;
    }
} 
```

下面是我如何在 while 循环结束时重新初始化，设置为在 BFS 完成后直接到达文件末尾时中断：

```
BFS(q, u)
for(i=0;i<numberVertices;i++)
{
    vertexArray[i].marked = 0;
} 
```

就像我说的那样，它似乎适用于较小的数据集，但我不明白为什么当我重新初始化时它似乎会出现段错误。

请让我知道您的想法和建议！

Valgrind 输出示例：

```
==6634== Memcheck, a memory error detector
==6634== Copyright (C) 2002-2010, and GNU GPL'd, by Julian Seward et al.
==6634== Using Valgrind-3.6.0 and LibVEX; rerun with -h for copyright info
==6634== Command: ./a.out 100S.txt
==6634==
==6634== Conditional jump or move depends on uninitialised value(s)
==6634==    at 0x400C13: checkonqueue (bfs.c:160)
==6634==    by 0x400B7F: BFS (bfs.c:142)
==6634==    by 0x40094A: main (bfs.c:103)
==6634==
==6634== Invalid write of size 4
==6634==    at 0x40096E: main (bfs.c:107)
==6634==  Address 0x4d00000041 is not stack'd, malloc'd or (recently) free'd
==6634==
==6634==
==6634== Process terminating with default action of signal 11 (SIGSEGV)
==6634==  Access not within mapped region at address 0x4D00000041
==6634==    at 0x40096E: main (bfs.c:107)
==6634==  If you believe this happened as a result of a stack
==6634==  overflow in your program's main thread (unlikely but
==6634==  possible), you can try to increase the size of the
==6634==  main thread stack using the --main-stacksize= flag.
==6634==  The main thread stack size used in this run was 10485760.
==6634==
==6634== HEAP SUMMARY:
==6634==     in use at exit: 3,448 bytes in 181 blocks
==6634==   total heap usage: 181 allocs, 0 frees, 3,448 bytes allocated
==6634==
==6634== LEAK SUMMARY:
==6634==    definitely lost: 0 bytes in 0 blocks
==6634==    indirectly lost: 0 bytes in 0 blocks
==6634==      possibly lost: 0 bytes in 0 blocks
==6634==    still reachable: 3,448 bytes in 181 blocks
==6634==         suppressed: 0 bytes in 0 blocks
==6634== Reachable blocks (those to which a pointer was found) are not shown.
==6634== To see them, rerun with: --leak-check=full --show-reachable=yes
==6634==
==6634== For counts of detected and suppressed errors, rerun with: -v
==6634== Use --track-origins=yes to see where uninitialised values come from
==6634== ERROR SUMMARY: 16120 errors from 2 contexts (suppressed: 6 from 6)
Segmentation fault (core dumped) 
```

检查队列功能：

```
int checkonqueue(int * q, int value)
{
    int i = 0;
    for(i=0;i < max;i++)
    {
        if(q[i] == value)
        {
            return 1;
        }
    }
    return 0;
} 
```

第 160 行是 if 条件的行

# javascript - JavaScript 构造函数和原型对象

> ID：13214569
> 
> 赞同：1
> 
> 时间：2012-11-03T23:32:23.563
> 
> 标签：javascript

我很好奇这里发生了什么。如您所见，我定义了一个构造函数，调用`range`它来构建新`range`对象。我已经`range`通过它的原型扩展了构造函数，添加了一个简单的`includes`方法。我已经创建了我的新对象并使用了`p`. 当我尝试将此方法用于我的`range`对象时，一切都很好，并且可以按预期工作。问题是当我尝试查看`p.prototype`它时告诉我它的类型是未定义的并且`p.prototype`没有方法......嗯？？

这里发生了什么？？`p`一个对象如何，`p.prototype`又不是？

```
 function range(from, to) {
        this.from = from;
        this.to = to;
    }

    range.prototype = {
        includes: function(x) { return this.from <= x && x <= this.to; },
    }

    var p = new range(1, 4);

    console.log(typeof p) //outputs object
    console.log(typeof p.prototype) //outputs undefined

    console.log(Object.getOwnPropertyNames(range.prototype)); //outputs includes
    console.log(Object.getOwnPropertyNames(p.prototype)); //throws error, p.prototype is not an object 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T23:37:51.897

> 问题是当我尝试查看`p.prototype`它时告诉我它的类型未定义

这是正确的。构造函数创建的对象`range`没有`prototype`属性，但它们有一个底层原型（从函数的`prototype`属性中提取`range`）。

让我们看看当你这样做时会发生什么`new range()`：

1.  JavaScript 引擎创建一个新的空白对象。
2.  JavaScript 引擎将该对象的底层原型（而不是`prototype`）分配为 所引用的对象`range.prototype`。（在规范中，这个属性——它不能在代码中*直接*访问，但见下文——被称为`[[Proto]]`。）
3.  JavaScript 引擎`range`通过`this`引用新对象进行调用。
4.  假设`range`不返回*不同*的对象（它可以这样做；这有点模糊），结果`new range`是在步骤 1 中创建的新对象。

稍后，当您使用 时`this.includes`，会发生以下情况：

1.  引擎查看实际对象以查看它是否具有`includes`属性。
2.  既然没有，引擎`[[Proto]]`就会查看*它*是否有一个。
3.  既然这样做了，它就会使用那个（如果没有，它会查看`[[Proto]]`'s`[[Proto]]`等等）。

这里的关键是：

1.  对象具有底层原型，不能通过对象本身的任何命名属性访问。（事实上​​，过去我们根本无法使用它们***。***现在，在 ES5 中，我们有[`Object.getPrototypeOf`](http://ecma-international.org/ecma-262/5.1/#sec-15.2.3.2)。）
2.  Objects created via `new SomeFunctionName` get their prototype from `SomeFunctionName.prototype` property, which is a perfectly normal property of the `SomeFunctionName` object (functions are first-class objects in JavaScript).

* * *

Side note: You're *replacing* the `prototype` of `range` with your code. In general, although it works, I would avoid that. Instead, *augment* the existing object referred to by `range.prototype`. (Add properties to it, rather than replacing it.) But that's not central to your question.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T23:34:55.733

我想你想要的是：

```
range.prototype.includes = function(x) { 
    return this.from <= x && x <= this.to; 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T23:35:32.677

您重新定义了原型对象，因此对原始对象的引用消失了。试试这个方法：

```
range.prototype.includes = function(x) { 
    return this.from <= x && x <= this.to;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-20T07:33:24.267

```
Number.prototype.myRound = function (decimalPlaces) {
    var multiplier = Math.pow(10, decimalPlaces);

    return (Math.round(this * multiplier) / multiplier);
}; 
```

# php - PHP GD：由于错误而无法显示图像

> ID：13214574
> 
> 赞同：0
> 
> 时间：2012-11-03T23:33:36.740
> 
> 标签：php, gd

好的..所以我一直在尝试为我玩的游戏制作“签名”。唯一的问题是，我在想要插入头像和在线/离线图像时遇到了很多问题。

我一直在尝试做的两件事是：

1.  通过检查 habbo_offline.gif 是否存在，从网页 habplus.com/home/[username] 获取用户状态。

    ```
    if(strpos(file_get_contents('http://www.habpl.us/home/'.$username.''), 
              'habbo_offline.gif') == true) { 
    ```

2.  抓取用户图像并显示在最终图像上

    ```
    function habSigFigure($username){
            $omgfig = 'http://www.habpl.us/figure.php?user='.$username.'&img_format=gif';
            return $omgfig; 

    //place habbo avatar
        $habsigfig = imagecreatefromgif($omgfig);
        imagecopy($img, $habsigfig, 13, 32, 0, 0, imagesx($habsigfig), imagesy($habsigfig));*/
        //place habbo avatar 
    ```

我已经包含了整个源代码，并且可以在[此处访问页面 -](http://plusparadise.net/dynamicsig/sig.php)[包含](http://plusparadise.net/dynamicsig/sig.php?user=Elite&img=default2.png&img=&red=255&green=255&blue=255) 变量的另一个链接

希望你能提供帮助..真诚的，马尔莫克

```
<?php
include 'config.php';
$username=$_REQUEST["user"];
$grabstat3 = fopen("http://habplus.com/fansitetools/userStats.php?user={$username}&stat=motto", "r"); 
while (!feof($grabstat3)){ $motto1 = fgets($grabstat3);
}   
fclose($grabstat3);
$username=$_REQUEST["user"];
$grabstat2 = fopen("http://habplus.com/fansitetools/userStats.php?user={$username}&stat=pixels", "r"); 
while (!feof($grabstat2)){ $pixels1 = fgets($grabstat2);
}
fclose($grabstat2);
$username=$_REQUEST["user"];
$grabstat1 = fopen("http://habplus.com/fansitetools/userStats.php?user={$username}&stat=credits", "r"); 
while (!feof($grabstat1)){ $credits1 = fgets($grabstat1);
}
fclose($grabstat1);

$pixels = 'Pixels: '.$pixels1.'';
$credits = 'Credits: '.$credits1.'';
$motto = 'Motto: '.$motto1.'';
/* Get custom img */
if(empty($_REQUEST['img'])){
    $img = 'default.png';
}else{ 
    $img =$_REQUEST['img'];
}

/* TEXT COLORS */
$red =$_REQUEST['red'];
$green =$_REQUEST['green'];
$blue =$_REQUEST['blue'];

/* Font size */
$fsize =$_REQUEST['fsize'];

    /*function habSigStatus($username){
        if(strpos(file_get_contents('http://www.habpl.us/home/'.$username.''), 'habbo_offline.gif') == true){
            return false;
        }else{
            return true;

    function habSigFigure($username){
        $omgfig = 'http://www.habpl.us/figure.php?user='.$username.'&img_format=gif';
        return $omgfig;
    }
    }
}*/

/*

    //place habbo avatar
    $habsigfig = imagecreatefromgif($omgfig);
    imagecopy($img, $habsigfig, 13, 32, 0, 0, imagesx($habsigfig), imagesy($habsigfig));*/
    //place habbo avatar

    //habbo status
    if(strpos(file_get_contents('http://www.habpl.us/home/'.$username.''), 'habbo_offline.gif') == true){
        $status_img = imagecreatefromgif('habbo_offline.gif');
    }else{
        $status_img = imagecreatefromgif('habbo_online.gif');
    }
    imagecopy($image, $status_img, 403, 96, 0, 0, 50, 16);
    //habbo status

$image = imagecreatefrompng($img); 
$font_color = imagecolorallocate($image, $red, $green, $blue); 
imagefttext($image, $fsize, 0, 3, 12, $font_color, './volt.ttf', $credits);  /* top left     */
imagefttext($image, $fsize, 0, 403, 12, $font_color, './volt.ttf', $pixels); /* top right    */
imagefttext($image, $fsize, 0, 3, 96, $font_color, './volt.ttf', $motto);    /* bottom left  */
imagefttext($image, $fsize, 0, 403, 96, $font_color, './volt.ttf', $online); /* bottom right */
/* imagefttext ( resource $image , float $size , float $angle , int $x , int $y , int $color , string $fontfile , string $text [, array $extrainfo]) */
header('Content-type: image/png'); 
imagepng($image); 
imagedestroy($image); 

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T23:44:41.903

这是你的问题，老实说相当愚蠢：

```
imagecopy($image, $status_img, 403, 96, 0, 0, 50, 16);
$image = imagecreatefrompng($img); 
```

您需要先创建图像*，然后*才能复制到它。交换这两条线，你应该很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T00:09:39.920

$image 应该是有效资源，在您的代码中 $image 为 null

```
 $image = imagecreatefrompng($img); 
  imagecopy($image, $status_img, 403, 96, 0, 0, 50, 16); 
```

您可以使用

```
 $image = imagecreatetruecolor(50, 16); //width,height
   imagecopy($image, $status_img, 403, 96, 0, 0, 50, 16); 
```

# android - Android 相机（从不同的类获取 imageView）

> ID：13214576
> 
> 赞同：1
> 
> 时间：2012-11-03T23:34:18.463
> 
> 标签：android

我目前正在开发一个应用程序，用户可以通过拍照或从相册上传照片来通过图像回答问题。

我分成了两个类，分别是 FulfillPhotoTaskActivity、AddPhotoActivity。FulfillPhotoTaskActivity 有imageView、addphoto 按钮和save 按钮。当我按下 addphoto 按钮时，它转到 AddPhotoActivity，我们可以选择两个选项（拍照或上传照片）。我完成了如果用户按下拍照按钮然后它会打开相机并拍照的部分。我创建了获取图像数据的 onActivityResult。但在许多示例中，在 onActivityResult 内部它们也有 imageView，例如 setImageBitmap。

我的问题是，如何从 AddPhotoActivity 获取 imageView 并将其显示在我已经为 XML 制作的 FulfillPhotoTaskActivity 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T00:05:10.390

当您拍照时，它会将图像保存到文件中。您可以检索此图像文件，然后可以在 FulfillPhotoTaskActivity 中调用您的 imageView 并将 imageView 设置为文件中的图像。

以下代码将启动相机意图和文件到给定位置：

```
 File root = new File(Environment.getExternalStorageDirectory().getAbsolutePath() + "/Folder/SubFolder");

    String folder = root.toString(); 
    File file = new File(folder, "fileName" + ".jpg");
    Uri outputFileUri = Uri.fromFile(file);

    Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
    cameraIntent.putExtra(MediaStore.EXTRA_OUTPUT, outputFileUri);

    startActivityForResult(cameraIntent, 0); 
```

现在，当用户拍照时，您就知道它会保存在哪里。在您的 FulfillPhotoTaskActivity 中，您可以调用您的 imageview：

```
 ImageView imageView = (ImageView)findViewById(R.id.YOUR_IMAGE_VIEW_ID); 
```

最后，您可以将图像设置为图像视图：

```
 imageView.setImageBitmap(BitmapFactory.decodeFile(file)); 
```

因此，您不需要从 AddPhotoActivity 获取 imageview。您只需要文件名。然后，您可以返回 FulfillPhotoTaskActivity 并将 imageview 设置为位图文件。

我希望这有帮助！

# wpf - DockPanel 的边框画笔上的 XAML 异常？

> ID：13214579
> 
> 赞同：0
> 
> 时间：2012-11-03T23:34:35.037
> 
> 标签：wpf, visual-studio-2012, .net-4.5

'在 'System.Windows.Baml2006.TypeConverterMarkupExtension' 上提供值引发了异常。' 行号“12”和行位置“18”。

```
<Window x:Class="Gasoline.Style.BaseWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="BaseWindow" Height="300" Width="300" ResizeMode="NoResize" WindowStyle="None" BorderBrush="Black">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="26"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <DockPanel LastChildFill="False" Height="26">
            <DockPanel.Background>
                <ImageBrush ImageSource="/Resources/FrameTitle.png"/>
            </DockPanel.Background>

        </DockPanel>

    </Grid>
</Window> 
```

原因是：

```
<ImageBrush ImageSource="/Resources/FrameTitle.png"/> 
```

我在这里做错了什么？
一旦我给画笔一个图像源（即使是通过创建不同值的属性窗口），当我启动应用程序时它就会抛出该错误。
设计师工作得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T01:16:25.200

可能的解决方案/提示：

1 - 每次收到“提供值引发异常”异常时，请尝试查看 InnerException 以查找根异常。

2 - 确保您的图像文件在其构建操作中设置为“资源”。您不需要“复制到输出目录”。

3 - 如果一切都失败了，请尝试使用[Pack URI 语法](http://msdn.microsoft.com/en-us/library/aa970069.aspx)

# android - Android 开发 - 2 秒后连续更改 gridview 图像 - 如何使用处理程序来完成此任务？

> ID：13214582
> 
> 赞同：1
> 
> 时间：2012-11-03T23:35:13.520
> 
> 标签：android, gridview

我对android中的网格视图有疑问。我有一个 5x5 图像的网格。我想不断地改变这些图像。每次从数组中加载一组新的图像。我有一个随机生成器函数，它每次加载后都会更改 mThumbIds 数组的值。但我无法在需要一些事件来渲染新图像集之前应用新图像。在这里我没有任何事件。我希望他们不断地改变。你能不能取悦我。无法找到任何解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T23:50:42.707

您是否尝试使用 AsyncTask 更改图像？AsyncTask 可以更改一个图像，然后启动一个新的 AsyncTask。

另一种选择是使用处理程序。实际上，这可能是您最好的选择。[http://mobileorchard.com/android-app-developmentthreading-part-1-handlers/](http://mobileorchard.com/android-app-developmentthreading-part-1-handlers/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T00:00:24.763

您的意思是每2秒触发一次图像更改功能的计时器吗？如果是这样，请尝试处理程序。就像是

```
 private Handler mHandler = new Handler();

    public void onCreate(Bundle savedInstanceState) {
       // init grid and set first batch of images
    }

    protected void onResume() {
         mHandler.postDelayed(mUpdateImagesTask , 2000);
     }

    private Runnable mUpdateImagesTask = new Runnable() {
    public void run() {
               // Code to change the images

               // call me in 2 seconds...
               mHandler.postDelayed(this, 2000); // 2 seconds
            }
     }; 
```

如果你想停止循环，只需在 mUpdateImagesTask 中设置一些条件来调用 Handler.postDelayer() 或从 Runnable 外部调用 mHandler.removeCallbacks(mUpdateImagesTask) （单击按钮，即）。

# azure - Azure 云发布不上传新文件

> ID：13214585
> 
> 赞同：1
> 
> 时间：2012-11-03T23:35:20.470
> 
> 标签：azure, permissions, windows-8, cloud, publish

我最近将我的 Visual Studio 2010 网站项目从我的 Windows 7 PC 复制到了一台运行 Windows 8 的新 PC。这一切都相对顺利。当我现在发布或打包云项目时，它只打包最初在 Windows 7 PC 上的文件。我在 Windows 8 PC 上创建的任何文件都将被忽略。该解决方案构建良好，我可以很好地运行和调试项目。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T23:53:28.700

不知道为什么会这样，但可以尝试以下方法：在 Visual Studio 解决方案资源管理器中，右键单击解决方案并选择清理解决方案。然后再次尝试打包/发布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T07:20:15.833

问题是，云项目在某处与 Web 项目解除关联，因此实际上并没有更新文件列表以进行发布——它只是使用了在我的旧 PC 上已经生成的文件列表。

解决方法是废弃云项目并重新开始一个新项目，然后向其中添加一个新的 Web 角色，然后将该 Web 角色转换为一个 Web 应用程序项目，然后将我的整个现有网站移动到该项目中......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T14:16:33.720

当您说文件时，您是指图像/JavaScript吗？

“复制到输出目录”的设置是什么？对于未制作的文件/内容...确保未将其设置为“**请勿**复制”

您使用的是 SDK 的新 v1.8 版本吗？（你升级你的项目了吗？）......如果你使用以前计算机上的旧 SDK，然后尝试使用“全新安装”来构建东西，就会发生这种情况。

# matlab - Matlab，如何将一串整数转换为向量？

> ID：13214590
> 
> 赞同：5
> 
> 时间：2012-11-03T23:36:33.557
> 
> 标签：matlab

> **可能重复：**
> [在matlab中将字符串转换为数字数组](https://stackoverflow.com/questions/12046605/convert-string-to-number-array-in-matlab)

Matlab中是否有一种简单的方法来转换这样的字符串

```
'123456789' 
```

变成这样的向量？

```
[1 2 3 4 5 6 7 8 9] 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-03T23:41:35.847

如果您只有从 0 到 9 的连续字符：

```
v = double(s)-'0'; 
```

double(s) 将字符串转换为数组，其中每个元素都是对应字符的 ASCII 码。为了获得数字值，我们减去“0”（实际上是 ASCII 中的 48），并且由于数字在 ASCII 码中具有顺序表示（“1”= 49，“2”= 50 等），我们最终得到预期结果。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-03T23:44:42.073

一种方法是`regexp`用于此。但当然它只适用于个位数。

```
>> str = '123456789';
>> num = regexp(str,'\d')

num =

 1     2     3     4     5     6     7     8     9 
```

# windows-8 - 我在哪里可以看到事件日志中的平铺通知错误？

> ID：13214591
> 
> 赞同：3
> 
> 时间：2012-11-03T23:36:36.443
> 
> 标签：windows-8, event-log

我在使用 Windows 8 应用程序和磁贴通知时遇到了一些问题。我已经让它们工作了，但有时几天或更长时间后，磁贴就会停止更新。

[http://msdn.microsoft.com/en-au/library/windows/apps/hh465403.aspx](http://msdn.microsoft.com/en-au/library/windows/apps/hh465403.aspx)

> 当您的磁贴通知未显示时，您可以使用事件日志检查错误。在应用程序和服务日志下的事件查看器中查找涉及您的磁贴通知的事件
> 
> > Microsoft > Windows > 沉浸式外壳 > Microsoft-Windows-TWinUI > 操作。

文档提到了事件日志，但是当我查看我的机器上不存在该节点时。我假设它已被移动并且文档未更新。我在哪里可以看到事件日志中的平铺通知错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T23:54:57.877

看起来 TWinUI 操作日志已移至以下事件日志路径：

> Microsoft > Windows > 应用程序 > Microsoft-Windows-TWinUI > 操作。

# ruby-on-rails - Rails act_as_tenant - 想阻止在没有子域的情况下访问我的网站

> ID：13214593
> 
> 赞同：2
> 
> 时间：2012-11-03T23:37:15.740
> 
> 标签：ruby-on-rails, subdomain, multi-tenant

act_as_tenant gem 非常好用。为多个租户保存和检索数据没有问题。但是，当我在没有子域的情况下访问我的开发站点时遇到了挑战。

问题：如果我不指定子域，任何租户的用户仍然可以登录。

示例 - cheese.lvh.me:3000 的用户将无法登录并访问来自 bacon.lvh.me:3000 的数据（反之亦然）。但是奶酪和培根用户都可以登录 lvh.me:3000。登录后，租户范围不再适用，因此所有新插入都将获得 NULL account_id。

我想：如果未指定子域，则阻止用户登录。

我正在使用流行的 railstutorial.org 中的 M.Hartl 的用户登录方法。

```
def create
  user = User.find_by_email(params[:session][:email].downcase)
  if user && user.authenticate(params[:session][:password]) 
    sign_in user
    flash[:success] = "Welcome user!"
    redirect_to users_path
  else
    flash.now[:error] = 'Invalid email/password combination'
    render 'new'
  end
end 
```

将不胜感激任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T10:30:49.820

我能想到的最简单的方法是将您不想在没有子域的情况下访问的路由包装在子域约束中：

```
constraints(SubdomainRequired) do
  # routes go here
end 
```

`SubdomainRequired`我认为，这个常量最好定义在`lib/constraints`应用程序目录中的一个以类 ( ) 命名的文件中`lib/constraints/subdomain_required.rb`：

```
class SubdomainRequired
  def self.matches?(request)
    request.subdomain.present?
  end
end 
```

然后，只需在您的路线文件顶部要求此约束即可：

```
require 'constraints/subdomain_required' 
```

如果此子域存在，则将找到该路由。如果请求不是使用子域发出的，则不会找到它。

# javascript - 在 div 中设置滚动，以便表格不会超出垂直限制 - 表格高度大于 div

> ID：13214600
> 
> 赞同：0
> 
> 时间：2012-11-03T23:38:03.307
> 
> 标签：javascript, css, html, html-table

我搜索了一下，并没有真正找到我正在寻找的答案。

我有一张桌子，在一个固定高度的 div 里面。

该表是通过 Javascript 动态添加的，因此每一行都是根据用户输入和按钮单击事件添加的。

表格宽度和单元格宽度都已设置好，并且添加信息有效，但是当我得到太多行时，表格会继续构建在它周围定义的 div 区域之外。

如何使 div 区域可滚动，以便随着表格的增长，用户可以在该 div 区域中滚动以查看添加到表格中的其他字段？

下面是我的 CSS、Javascript、html 代码。

一如既往地非常感谢任何帮助。

------------------------------------ CSS -------------- --------

```
#notesEntered {
    float:left;
    border: 1px solid #bbbbbb;
    height:300px;
    width:850px;
    border-radius:4px;
    -webkit-border-radius:4px;
    -moz-border-radius:4px;
}

.noteEntryField {
    position:relative;
    top:20px;
    }

.noteEntryButton {
    position:relative;
    top:20px;
    height:27px;
    outline:none;
    text-align:center;
    background: #66ff33;
    background: -webkit-gradient(linear, left top, left bottom, from(#66cc33), to(#669933));
    background: -moz-linear-gradient(top,  #66cc33,  #669933);
    font-size:14px;
    border-radius:4px;
    color:#606060;
    text-shadow:2px 2px 2px #f0f0f0;
    }

.noteTable {
    max-height:300px;
    border:1px solid #cccccc;
    border-collapse:collapse;
    width:850px;
    }

.inLnBlk {
    display:inline-block;
    }

.noteHeaderCells {
    border:1px solid #dddddd;
    background-color:#1111ff;
    color:#ffffff;
    }

.cellDateEntered {
    width:200px;
    }

.cellEnteredBy {
    width:175px;
    }

.cellNoteEntered {
    width:475px;
    }

.noteBodyCells {
    border:1px solid #dddddd;
} 
```

------------------ JS ----------------------

```
function addNoteRow()
    {
        event.preventDefault();
        console.log("Made it to note entry.");
        var noteTxt = $('#noteEntry').val();
        var noteEntBy = 'BGM';
        var nowNote = Date();
        var noteEntDate = dateFormat(nowNote, "mm/dd/yyyy HH:MM:ss");
        if (!document.getElementsByTagName) return;
        tabBody=document.getElementsByTagName("TBODY").item(0);
        row=document.createElement("TR");
        cell1=document.createElement("TD");
        cell2=document.createElement("TD");
        cell3=document.createElement("TD");
        textnode1=document.createTextNode(noteEntDate);
        textnode2=document.createTextNode(noteEntBy);
        textnode3=document.createTextNode(noteTxt);
        cell1.appendChild(textnode1);
        cell2.appendChild(textnode2);
        cell3.appendChild(textnode3);
        row.appendChild(cell1);
        row.appendChild(cell2);
        row.appendChild(cell3);
        tabBody.appendChild(row);
        document.getElementById("noteEntry").value = '';
        document.getElementById("noteEntry").focus();
       } 
```

--------------------HTML------------------------

```
<div id="Notes" class='acceptEnterNotes'>
            <form>
            <input type="text" name="noteEntry" id="noteEntry" class="noteEntryField" placeholder="Note Entry" size="115" />
            <button type="submit" onclick="addNoteRow()" class="noteEntryButton buttonAddNote" id="sendNoteToDispatch" value="Submit">Submit Note</button>
            </form>
            <br /><br />
            <div id="notesEntered">
            <table id="notesEnteredGrid" class="noteTable">
                <tbody class="inLnBlk">
                <tr class="enteredNotesHeader">
                    <td class="noteHeaderCells cellDateEntered">Date Entered</td><td class="noteHeaderCells cellEnteredBy">Entered by</td><td class="noteHeaderCells cellNoteEntered">Note</td>
                </tr>
                </tbody>
            </table>

            </div>

        </div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T23:40:42.283

将此 css 规则添加到您的 div 容器中：overflow-y: scroll

# mysql - MySQL 查询：如何对列中的 3 个不同值求和，显示结果集中每个值的总和

> ID：13214601
> 
> 赞同：2
> 
> 时间：2012-11-03T23:38:13.207
> 
> 标签：mysql, sql, pivot, aggregate-functions

我有一个名为 inventory 的表，其中包括如下两列：

![在此处输入图像描述](../Images/9a43e47f0d35f266d8bcc1e5bbd5b706.png)

我想查询该表以返回一个结果集，该结果集列出了我拥有的每个条件的项目数（下面示例中显示的列标题在结果集中不需要...只是在此处显示以清楚起见）：

![在此处输入图像描述](../Images/375d6eebd4fbf9641da184b3c901feb3.png)

我想它看起来像：

```
 SELECT item, sum(condition???), sum(condition???), sum(condition???) 
    FROM inventory 
GROUP BY item 
```

我怎样才能做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T23:45:15.330

你非常接近：

```
SELECT item, 
  sum(case when `condition` = 'poor' then 1 else 0 end) as poor, 
  sum(case when `condition` = 'fair' then 1 else 0 end) as fair, 
  sum(case when `condition` = 'good' then 1 else 0 end) as good
FROM inventory 
GROUP BY item 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/bc6d5/4)

# php - 如何显示存储在 MySql 数据库中的 BLOB 图像？

> ID：13214602
> 
> 赞同：5
> 
> 时间：2012-11-03T23:38:29.853
> 
> 标签：php, html, mysql, image, blob

我正在尝试在 MySql 中显示上传到我的“商店”表的最后 5 张图片。我对 PHP 和数据库完全是个菜鸟，我已经阅读了很多关于如何做到这一点的文章，但没有运气。

我可以一次存储和显示一张图片，但我希望能够有一个画廊来显示最近上传的 5 张。

任何建议或帮助将不胜感激谢谢！

ps 我知道将图片存储到这样的数据库是不受欢迎的，但这个项目只是为了练习。

索引.php

```
<!DOCTYPE html>
<html>
<head>
<title>Project One</title>
</head>

<body>

<form action="index.php" method="POST" enctype="multipart/form-data">
    File:
    <input type="file" name="image"> <input type="submit" value="Upload">
<form>
<p />

<?php

//connect to database
(connect to server)
(select correct DB)

//file properties
$file = $_FILES['image']['tmp_name'];

if (!isset($file))
    echo "please select an image.";
else
  {
  $image = addslashes(file_get_contents($_FILES['image']['tmp_name']));
  $image_name = $_FILES['image']['name'];
  $image_size = getimagesize($_FILES['image']['tmp_name']); 

  if($image_size==FALSE)
    echo "That's not an image.";
  else
  {
    if (!$insert = mysql_query("INSERT INTO store VALUES ('', '$image_name', '$image')"))
        echo "Problem Uploading Image.";
    else
        {

        $lastid = mysql_insert_id();
        echo "Image uploaded. <p />Your image:<p /><img src=get.php?id=$lastid>";

        }
  }
  }

?>

<p />
<p />
<a href="http://WEBSITE.com/gallery.php"> Go to Gallery </a>
</body>

</html> 
```

获取.php

```
<?php

   //connect to database
    (connect to server)
    (select correct DB)

$id = addslashes($_REQUEST['id']);

$image = mysql_query("SELECT * FROM store WHERE id=$id");
$image = mysql_fetch_assoc($image);
$image = $image['image'];

header("Content-type: image/jpeg");

echo $image;

?> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-03T23:57:32.797

这是我想做类似事情时使用的……很久以前！=P

```
$sql = "SELECT image FROM table WHERE cond ORDER BY xxxx DESC LIMIT 5";
$result = mysqli_query($db,$sql);
while($arraySomething = mysqli_fetch_array($result))
{
    echo "<img src='php/imgView.php?imgId=".$arraySomething."' />";
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-05-12T08:08:05.780

我尝试第一种方法，`header('content-type: image/jpeg');`但最终没有显示图像。在通过网站搜索了一些谷歌之后，我找到了可以将图像从数据库显示到我的页面的解决方案

尝试这个：

```
mysql_connect("localhost","root","")or die("Cannot connect to database"); //keep your db name
mysql_select_db("example_db") or die("Cannot select database");
$sql = "SELECT * FROM `article` where `id` = 56"; // manipulate id ok 
$sth = mysql_query($sql);
$result=mysql_fetch_array($sth);
// this is code to display 
echo '<img src="data:image/jpeg;base64,'.base64_encode( $result['image_file'] ).'"/>' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-08T06:16:53.710

```
mysql_connect("localhost","root","")or die("Cannot connect to database"); 

//keep your db name
mysql_select_db("example_db") or die("Cannot select database");

$sql = "SELECT * FROM `article` where `id` = 56"; 
// manipulate id ok 
$sth = mysql_query($sql);
$result=mysql_fetch_array($sth);
// this is code to display 

echo '<img src="data:image/jpeg;base64,'.base64_encode( $result['image_file'] ).'"/> width="xxxx" height="xxxx"'; 
```

**还要添加高度和宽度**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-04-07T13:39:17.660

您也可以使用此功能

```
//Retrieve image from database and display it on html webpage    
function displayImageFromDatabase(){    
//use global keyword to declare conn inside a function    
global $conn;    
$sqlselectimageFromDb = "SELECT * FROM `imageuploadphpmysqlblob` ";    
$dataFromDb = mysqli_query($conn, $sqlselectimageFromDb);    
while ($row = mysqli_fetch_assoc($dataFromDb)) {    
echo '<img height="250px" width="250px" src=data:image;base64,'.$row['image'].'/>';    
} 
```

像这样将其插入mysql数据库：

```
$image = $_FILES['imagefile']['tmp_name'];
$name = $_FILES['imagefile']['name'];
$image = base64_encode(file_get_contents(addslashes($image))); 
```

参考：[https ://mauricemutetingundi.blogspot.com/2019/04/how-to-upload-blob-image-to-mysql.html](https://mauricemutetingundi.blogspot.com/2019/04/how-to-upload-blob-image-to-mysql.html)

# c# - FTP没有正确上传文件

> ID：13214604
> 
> 赞同：3
> 
> 时间：2012-11-03T23:39:01.167
> 
> 标签：c#, upload, ftp

我正在尝试制作一个小型个人屏幕捕获应用程序，我可以在其中按下快捷键并上传屏幕的完整屏幕截图。

我已设法将文件上传到我的网站，但我遇到的问题是，当您转到 URL 时，它显示为损坏的图像。

这是我的代码：

```
private void CaptureFullScreen()
{
    string file = DateTime.Now.ToString("ddmmyyyyhhmmss") + ".jpg";
    string file_store = screenshotDir + "\\" + file;

    Rectangle bounds = Screen.GetBounds(Point.Empty);
    using(Bitmap bitmap = new Bitmap(bounds.Width, bounds.Height))
    {
        using(Graphics g = Graphics.FromImage(bitmap))
        {
            g.CopyFromScreen(Point.Empty, Point.Empty, bounds.Size);
        }

        bitmap.Save(file_store, ImageFormat.Jpeg); 
    }

    //System.Diagnostics.Process.Start(file);
    ShowBalloonTip("Uploading...", "Screen Capture is being uploaded", ToolTipIcon.Info, 1000);
    FtpFileUpload(file_store, file);
}
private void FtpFileUpload(string file_store, string file_name)
{
    try
    {
        FtpWebRequest request = (FtpWebRequest)WebRequest.Create("ftp://passion4web.co.uk/www/apps/imgcap/" + file_name);
        request.Method = WebRequestMethods.Ftp.UploadFile;

        request.Credentials = new NetworkCredential("username", "password");

        StreamReader strRead = new StreamReader(file_store);
        byte[] fileContents = Encoding.UTF8.GetBytes(strRead.ReadToEnd());
        strRead.Close();
        request.ContentLength = fileContents.Length;

        Stream reqStream = request.GetRequestStream();
        reqStream.Write(fileContents, 0, fileContents.Length);
        reqStream.Close();

        FtpWebResponse response = (FtpWebResponse)request.GetResponse();

        string url = "http://passion4web.co.uk/apps/imgcap/" + file_name;
        string resp = response.StatusDescription;

        ShowBalloonTip("Screenshot uploaded", "Click this balloon to open", ToolTipIcon.Info, 5000, url);

        response.Close();
    }
    catch (Exception ex)
    {
        //Ignore this - used for debugging
        MessageBox.Show(ex.ToString(),"Upload error");
        MessageBox.Show(file_name + Environment.NewLine + file_store, "Filename, Filestore");
    }
} 
```

这是一个示例： [屏幕截图](http://passion4web.co.uk/apps/imgcap/03362012113648.jpg)

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T23:54:59.133

这就是问题：

```
StreamReader strRead = new StreamReader(file_store);
byte[] fileContents = Encoding.UTF8.GetBytes(strRead.ReadToEnd()); 
```

您正在阅读您的文件，就好像它是 UTF-8 编码的文本一样。它不是——它是一个图像。任意二进制数据。

采用：

```
byte[] fileContents = File.ReadAllBytes(file_store); 
```

一切都应该没问题。

您的其余代码仍然可以使用一些 TLC - 修复命名约定，`using`适当地使用语句等 - 但将任意二进制数据视为文本是这里的主要问题。

# for-loop - Lua - 为什么不动态计算for循环限制？

> ID：13214611
> 
> 赞同：3
> 
> 时间：2012-11-03T23:40:08.873
> 
> 标签：for-loop, lua, iteration

好的，这是一个基本的 for 循环

```
local a = {"first","second","third","fourth"}
for i=1,#a do 
    print(i.."th iteration")
    a = {"first"}
end 
```

就像现在一样，循环执行所有 4 次迭代。

不应该在旅途中计算for-loop-limit吗？如果它是动态计算的，#a 在第一次迭代结束时将为 1，并且 for 循环将中断....

那肯定会更有意义吗？或者有什么特别的原因说明为什么不是这样？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T06:28:49.717

数值循环限制只计算一次的主要原因`for`肯定是为了性能。

使用当前行为，您可以将任意复杂表达式置于`for`循环限制中而不会降低性能，包括函数调用。例如：

```
local prod = 1
for i = computeStartLoop(), computeEndLoop(), computeStep() do
  prod = prod * i
end 
```

`computeEndLoop`如果并且`computeStep`需要在每次迭代中调用上述代码，将会非常缓慢。

如果标准 Lua 解释器，尤其是 LuaJIT 与其他脚本语言相比如此之快，那是因为许多 Lua 特性在设计时就考虑到了性能。

* * *

在不希望单个评估行为的极少数情况下，使用or将`for`循环替换为通用循环很容易。`while end``repeat until`

```
local prod = 1
local i = computeStartLoop()
while i <= computeEndLoop() do
  prod = prod * i
  i = i + computeStep()
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T00:54:41.327

长度在 for 循环初始化时计算一次。每次循环都不会重新计算它 - for 循环用于从起始值迭代到结束值。如果您希望在重新分配数组时提前终止“循环”，您可以编写自己的循环代码：

```
local a = {"first", "second", "third", "fourth"}                                                                           

function process_array (fn)                                                                                                
   local inner_fn                                                                                                          
   inner_fn =                                                                                                              
      function (ii)                                                                                                        
         if ii <= #a then                                                                                                  
            fn(ii,a)                                                                                                       
            inner_fn(1 + ii)                                                                                               
         end                                                                                                               
      end                                                                                                                  
   inner_fn(1, a)                                                                                                          
end                                                                                                                        

process_array(function (ii)                                                                                                
                    print(ii.."th iteration: "..a[ii])                                                                     
                    a = {"first"}                                                                                          
                     end) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T17:21:16.467

性能是一个很好的答案，但我认为它也使代码更易于理解且不易出错。此外，您可以（几乎）确保 for 循环始终终止。

想一想，如果您改为这样写会发生什么：

```
local a = {"first","second","third","fourth"}
for i=1,#a do 
    print(i.."th iteration")
    if i > 1 then a = {"first"} end
end 
```

你怎么理解`for i=1,#a`？是相等比较（何时停止`i==#a`）还是不等比较（何时停止`i>=#a`）。在每种情况下会产生什么结果？

您应该将 Lua`for`循环视为对序列的迭代，例如 Python 习惯用法 using `(x)range`：

```
a = ["first", "second", "third", "fourth"]
for i in range(1,len(a)+1):
    print(str(i) + "th iteration")
    a = ["first"] 
```

如果您想在每次使用时评估条件`while`：

```
local a = {"first","second","third","fourth"}
local i = 1
while i <= #a do 
    print(i.."th iteration")
    a = {"first"}
    i = i + 1
end 
```

# validation - The HTML rel tag

> ID：13214619
> 
> 赞同：5
> 
> 时间：2012-11-03T23:41:00.887
> 
> 标签：validation, html-validation

I am trying to validate my HTML5 document with the w3c. I am using the fancybox jQuery plugin for simple light boxes and image galleries. In order to differentiate between each image gallery I am using the `rel` tag.

When I validate my page I get the following error:

> Bad value gallery for attribute rel on element a: Not an absolute IRI. The string gallery is not a registered keyword or absolute URL.

Here is my code:

```
<div class="portItem">
    <div class="thumbs">
        <div class="items">
        <img src="images/rsl.jpg" class="col" alt="A website for R.S.Lynch and Company"/>
        <div class="caption">
            <a class="fancybox" rel="gallery1" href="images/rs1.jpg">R.S.Lynch & Company</a>
            <div class="hidden">
            <a class="fancybox" rel="gallery1" href="images/rs2.jpg"></a>
            <a class="fancybox" rel="gallery1" href="images/rs3.jpg"></a>
            <a class="fancybox" rel="gallery1" href="images/rs4.jpg"></a>
            <a class="fancybox" rel="gallery1" href="images/rs5.jpg"></a>
            </div>
        </div>
        </div>
    </div>
</div> 
```

Is there a better tag to use and get the same result? Thanks

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T23:50:54.977

I'd suggest using `data`-family attribute here, like this:

```
<a class="fancybox" data-gallery="1" href="images/rs1.jpg">R.S.Lynch & Company</a>
<a class="fancybox" data-gallery="1" href="images/rs2.jpg">...</a>
<a class="fancybox" data-gallery="1" href="images/rs3.jpg">...</a>
<a class="fancybox" data-gallery="1" href="images/rs4.jpg">...</a>
<a class="fancybox" data-gallery="1" href="images/rs5.jpg">...</a> 
```

... as this type of attribute was designed specifically for attaching some data to DOM elements. It's more semantic than using `class`, in my opinion.

You can easily access these values with `$('some selector').data('gallery')` syntax.

As for `rel` attribute, it looks like in HTML5 it's restricted to the set of predefined [attributes](http://www.whatwg.org/specs/web-apps/current-work/multipage/links.html#linkTypes), and is used to define more high-level relationships between documents.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T23:50:37.437

You could add a class for each gallery instead: `class="fancybox gallery1"`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-03-23T10:55:05.170

```
<a class="fancybox" data-gallery="1" href="images/img1.jpg">...</a>
<a class="fancybox" data-gallery="1" href="images/img2.jpg">...</a> 
```

$(".fancybox").attr('rel', 'data-gallery').fancybox();

# c++ - 在类中存储指针

> ID：13214620
> 
> 赞同：0
> 
> 时间：2012-11-03T23:41:10.143
> 
> 标签：c++, class, variables, pointers

我正在学习 C++ 并且遇到了指针问题。
这个简单的项目包含一张发票，其中包含指向客户的指针。

**课程：**

```
class Customer {
    string name;
public:
    Customer(string name) { this->name = name; };
    string getName() { return name; };
    void changeName(string name) { this->name = name; };
};

class Invoice {
    Customer * customer;
public:
    Invoice(Customer *customer) { this->customer = customer; };
    Customer getCustomer() { return *customer; };
}; 
```

**主要的：**

```
Customer *customer1 = new Customer("Name 1");
Invoice invoice1(customer1);

cout << invoice1.getCustomer().getName() << endl; //Return:Name 1; 
```

我如何使用 Customer::changeName(string name) 来完成这项工作：

```
(...) changeName("Name 2");

cout << invoice1.getCustomer().getName() << endl; //Return:Name 2; 
```

我不知道我应该使用什么来更改客户的名称。或者我在类发票中做错了什么。

**为什么要通过 Invoice 更改名称？**
所以我可以在项目开始变大之前学习如何使用指针。
稍后我将有一个发票向量和一个客户向量。从发票或客户向量中获取指向客户的指针应该是相同的。

谢谢你，
爱德华多

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-03T23:43:49.590

```
Customer getCustomer() { return *customer; }; 
```

应该

```
Customer& getCustomer() { return *customer; }; 
```

因为在第一种情况下，您复制了客户对象，因此您的更改发生在一个被丢弃的临时对象中......

在第二个中，您将返回对您创建的对象的引用。

改名

```
string newName = "Edu";
invoice1.getCustomer().changeName( newName ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T23:55:44.030

如果你想让这大大加强，我在这里采取了这样的自由。客户和发票声明都进行了重大更新。将它们与您现有的代码进行比较。**不要**只是将其复制到您的代码中，因为它肯定会破坏很多东西。相反，看看它，看看它是否对你有意义：

```
class Customer 
{
    string name;

public:
    Customer(const string& name) : name(name) {};

    const string& getName() const { return name; };
    void changeName(const string& name) { this->name = name; };
};

class Invoice 
{
    const Customer& customer;

public:
    Invoice(const Customer& customer) : customer(customer) {};

    const Customer& getCustomer() const { return customer; };
}; 
```

一般来说（通常情况下，无论如何）您需要通过指针传递对象的**唯一时间是对象指针***接收器*是否有机会接受 NULL 作为有效值。否则使用引用或智能指针。支持多态访问的对象指针数组无法承受（即使是智能指针 ftw），这通常是一个很好的规则。

做出的重大改变：

*   除非特别需要非 const 访问，否则使用 const 引用
*   类具有初始化列表以确保成员变量的最佳构造，事实上现在对于 Invoice 是必需的，因为*必须*在初始化列表中初始化客户引用成员。

**主要的**

```
Customer customer1("Name 1");
Invoice invoice1(customer1);

// note: invoice now only allows you to obtain a const-reference
//  to the customer of the invoice. As such, you can only fire
//  const-members on the returned customer reference.
cout << invoice1.getCustomer().getName() << endl; //Return:Name 1;

// without the const-ness of the getCustomer() member and the reference
//  it returns, you would have been able to do this:
//
//  invoice.getCustomer.changeName("newname");
//
// As it is written now, you can only change a customer name from
//  a non-const customer reference (or pointer), and in doing so, 
//  *all* invoices for that customer will reflect this change.
customer1.changeName("Name 2");

// note: the invoice was not changed, but the customer it references
//  was, and we should see that change now.
cout << invoice1.getCustomer().getName() << endl; //Return:Name 2; 
```

我希望这能给您一些想法，让您了解如何在以后的项目中限制和强化对象访问。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T23:52:18.100

在`Invoice`中，返回指向`Customer`自身的指针，而不是其取消引用值的副本：

```
Customer* getCustomer() { return customer; }; 
```

然后你可以像这样更改名称，更改将影响实际`Customer`对象：

```
invoice1.getCustomer()->changeName("Name2") 
```

# android - Android GridView 未在活动中填充 oncreate

> ID：13214623
> 
> 赞同：0
> 
> 时间：2012-11-03T23:41:37.947
> 
> 标签：android, android-gridview

试图从我创建和填充的 gridView 中获取特定位置项背后的数据。下面的侦听器方法 setOnItemClickListener() 效果很好，但我需要的是获取有关渲染屏幕（gridview）的信息，而不仅仅是在项目单击时。

这是从我的活动中截取的：

```
 ImageAdapter adapter = new ImageAdapter(LaunchActivity.this,
                myArray, elements);
        gridview.setAdapter(adapter);

        gridview.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View v,
                    int position, long id) {

                ImageView iv = (ImageView) v.findViewById(R.id.icon_image);
                iv.setImageDrawable(getResources()
                        .getDrawable(R.drawable.drank));
                String name = elements[position].toString();
                System.out.println("===POSITION: " + position);
                if (dbHelper.getElementByPosition(position) == null) {
                    System.out.println("can insert");
                    dbHelper.addElement(new Beer(name, 1, position));
                } else {
                    System.out.println("already exists");
                }
            }
        });

        if (!elements.isEmpty()) {
            for (Element cn : elements) {
            Element item = (Element) gridview.getItemAtPosition(cn.getPosition());

                System.out.println(cn.getPosition() + ", ITEM: " + item);

}
        } 
```

它继续返回null ...：

```
[2012-11-04 01:33:46 - Emulator] I/System.out( 1771): 7, ITEM: null
[2012-11-04 01:33:46 - Emulator] I/System.out( 1771): 3, ITEM: null
[2012-11-04 01:33:46 - Emulator] I/System.out( 1771): 11, ITEM: null
[2012-11-04 01:33:47 - Emulator] I/System.out( 1771): 14, ITEM: null
[2012-11-04 01:33:47 - Emulator] I/System.out( 1771): 12, ITEM: null 
```

我不明白为什么我会出错......也许有人能发现我的错误，或者只是一个想法会很棒。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T23:46:40.070

在 onCreate 期间，适配器尚未填满您的网格。你有几种可能性。其中之一是例如在 onStart 中使用延迟的可运行

```
 new Handler().runDelayed( Runnable, long ). 
```

在这个可运行文件中，您的网格将被填充。

或者更好的是，在你的适配器上注册一个 datasetobserver，你就会知道你的网格何时被填满。

# gwt - GWT 日期处理...让客户尊重服务器的时区

> ID：13214624
> 
> 赞同：4
> 
> 时间：2012-11-03T23:41:55.643
> 
> 标签：gwt, date, timezone

我在这里读过很多帖子：GWT 日期处理。

一个特别触动我的就是这个

[将日期和时区从 GAE 服务器发送到 GWT 客户端](https://stackoverflow.com/questions/11989219/sending-a-date-and-timezone-from-gae-server-to-gwt-client)

无论如何，我正在从事的一个项目需要能够将天、小时、分钟间隔显示为网格中的标签。我的团队采用了一种方法，所有日期/时间实例都以 ISO8601 字符串格式从服务器传递给客户端。服务器时区将受到客户端的尊重。商业用例是所有日期/时间实例都处于“市场时间”，因此访问该应用程序的任何浏览器都将看到并使用“市场时间”时区中的日期，该时区恰好是 GMT-05:00（如果夏令时生效）或 GMT-06:00（如果标准时间生效）。

我在 Github 上发布了一些资源，这里：

[https://github.com/fastnsilver/gwt-datehandling-example](https://github.com/fastnsilver/gwt-datehandling-example)

特别...

[https://github.com/fastnsilver/gwt-datehandling-example/blob/master/src/main/java/me/fns/gwt/datehandling/client/util/CSTimeUtil.java](https://github.com/fastnsilver/gwt-datehandling-example/blob/master/src/main/java/me/fns/gwt/datehandling/client/util/CSTimeUtil.java)

和 GWTTestCase

[https://github.com/fastnsilver/gwt-datehandling-example/blob/master/src/test/java/me/fns/gwt/datehandling/client/util/CSTimeUtilTestGwt.java](https://github.com/fastnsilver/gwt-datehandling-example/blob/master/src/test/java/me/fns/gwt/datehandling/client/util/CSTimeUtilTestGwt.java)

希望有人可以盯着我们用于日期处理的实用程序（和测试）并帮助我们看到我们没有看到的东西。

**编辑** 基本问题是`CSTimeUtil#hoursInDay(Date)`“过渡日”在生产模式下没有正确计算此方法被其他方法（如`CSTimeUtil#dateToHour(Date)`和`CSTimeUtil#labelsForDay(Date)`）使用。

我已经使用当前的实现部署了我们的应用程序，`CSTimeUtil`它似乎可以工作，但并不完全。例如，当`mvn gwt:test`操作系统时区设置为除 US`GMT-05:00`或`GMT-06:00`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-07T22:37:03.763

根据安德烈的一些提示和一些严重的血汗和泪水，我自己弄清楚了这一点。我已经更新了 Github 中的代码，所以如果你好奇，请去那里看看。

基础知识：

*   确保从服务器发送到客户端时所有字符串都符合 ISO8601（无毫秒）标准，反之亦然
*   使用 `DateTimeFormat.getFormat("yyyy-MM-ddTHH:mm:ss.SZZZZ")`到`format`和`parse`日期
*   `java.util.Date`使用 检索“市场时间”中以 GMT 为前缀的时区信息`DateTimeFormat(Date, TimeZone)`，其中`TimeZone`参数设置为`TimeZone.createTimeZone(TZ_CONSTANTS_INSTANCE.americaChicago())`，时区字符串由检索`TimeZone.getISOTimeZoneString(Date)`
*   从源日期生成天数、see`generateDay(Date, int)`或 hours`generateHour(Date, int)`必须考虑到如果发生在“过渡日”，增量或减量可能会触发时区偏移的变化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T03:33:11.640

如果您的时区是固定的，为什么要使用字符串来表示日期/时间？您可以将标准 Java Date 对象发送到客户端。如果需要，您甚至可以将所有日期和时间存储为 Long 并仅传递 Long。您还为您的时区发送 GWT 的 TimeZone Json 字符串（每个会话一次）。您可以在 GWT 中找到它 - 有一个包含所有时区字符串的文件。

在客户端上，您使用具有许多预定义格式的 DateTimeFormat 来显示您需要的任何内容：完整日期、月份和日期、日期和时间等。只要记住从这个 Json 字符串创建 TimeZone 对象并在 DateTimeFormat.getFormat(... ).format（日期，时区）。

使用这种方法，您不必担心 DST 更改（它们被编码在该 Json 字符串中）和语言环境。您只传递简单的 Date 或 Long 对象。

# html - 我们应该在 div#wrapper 还是 ?

> ID：13214626
> 
> 赞同：12
> 
> 时间：2012-11-03T23:42:09.937
> 
> 标签：html, css, media-queries, semantic-markup

很多人的 HTML 标记是这样的：

```
<html>
  <body>
    <div id="wrapper">
      <p>Stuff in here</p>
    </div>
  </body>
</html> 
```

大多数情况下，在此处或网络上的示例中，人们建议您应该将宽度设置应用于`#wrapper`，而不是`<body>`.

有没有潜在的原因？

例如，在一篇关于[优雅降级媒体查询技术](http://coding.smashingmagazine.com/2011/08/10/techniques-for-gracefully-degrading-media-queries/)的文章中，并为您提供有关**技术 1：什么都不做**的背景信息：

> 房间里的大象是用于桌面的**Internet Explorer 。**使用移动优先的解决方案，大屏幕将在一列中显示内容，从而给用户带来痛苦的阅读体验，远远超过了既定的最大舒适度：50 到 75 个字符。 **在你的主容器中设置一个 max-width 属性，然后在媒体查询中增加这个 max-width 可能是值得的。**

还有他们的 CSS：

```
#wrapper {
 _width: 460px; /* Take that, IE6! */
 max-width: 460px;
}

@media only screen and (width) {

#wrapper {
  max-width: 1200px;
 } 
} 
```

以下是[IE 的组合方式](http://jsfiddle.net/Baumr/9Atn6/)（媒体查询已被注释掉）。

考虑到标准网站`#wrapper`，我们将其应用于而不是将其应用于 ，会有什么区别吗？`<body>`

任何潜在的错误？[我在这里试了一下](http://jsfiddle.net/Baumr/9Atn6/1/)，好像还可以。如果布局变得更高级怎么办......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T03:22:12.450

好吧，我猜你想使用尽可能少的元素。但是，在许多情况下，#page-wrapper 和 body 是不可互换的。在许多情况下，您需要使用 body 作为背景颜色而不是 html 标签。在这些情况下（例如加权页脚），您需要 body 来拉伸 html，并且需要一个包装器来包含内容，也许可以将内容居中，并强制 body 拉伸并包含它。

所以 - 我想我会说，大多数人使用包装器是因为他们在第一堂课或在线教程中看到了它。我认为在大多数情况下，这是许多人的习惯。我会保持身体原样并将包装器边缘设置为 0 auto 并使用像你一样的最大宽度。这只是 EI 8 及之前的版本 -[我可以使用媒体查询吗？](http://caniuse.com/#feat=css-mediaqueries)- 也许你应该检测 EI 8 并制作一个独特的样式表。我发现在为 mobil 定义了所有内容之后，我的媒体查询只是在那之后的几行迭代——

# python - PyQT4 异步 QTcpServer（如何创建事件循环）

> ID：13214632
> 
> 赞同：0
> 
> 时间：2012-11-03T23:42:52.347
> 
> 标签：python, pyqt, pyqt4

试图将用 C++ 编写的服务器转换为 Python。服务器被写入异步/非阻塞。在 C++ 中有效的东西似乎不想在 Python 中为我工作

我正在使用 PyQT4。我读过 Python 你必须创建事件循环或类似的东西任何想法都非常感谢

我应该提到似乎不起作用的是Class Server中的**incomingConnection**函数永远不会被调用。

*干杯

```
import sys
from PyQt4.QtCore import *
from PyQt4.QtNetwork import *

class Client(QObject):
    def __init__(self, parent=None):
        QObject.__init__(self)
        QThreadPool.globalInstance().setMaxThreadCount(15)

    def SetSocket(self, Descriptor):
        self.socket = QTcpSocket(self)
        self.connect(self.socket, SIGNAL("connected()"), SLOT(self.connected()))
        self.connect(self.socket, SIGNAL("disconnected()"), SLOT(self.disconnected()))
        self.connect(self.socket, SIGNAL("readyRead()"), SLOT(self.readyRead()))

        self.socket.setSocketDescriptor(Descriptor)
        print "Client Connected from IP %s" % self.socket.peerAddress().toString()

    def connected(self):
        print "Client Connected Event"

    def disconnected(self):
        print "Client Disconnected"

    def readyRead(self):
        msg = self.socket.readAll()
        print msg

class Server(QObject):
    def __init__(self, parent=None):
        QObject.__init__(self)

    def incomingConnection(self, handle):
        print "incoming"
        self.client = Client(self)
        self.client.SetSocket(handle)

    def StartServer(self):
        self.server = QTcpServer()
        if self.server.listen(QHostAddress("0.0.0.0"), 8888):
            print "Server is awake"    
        else:
            print "Server couldn't wake up"

def main():
    app = QCoreApplication(sys.argv)
    Server().StartServer()
    sys.exit(app.exec_())

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T07:53:53.497

`incomingConnection`未调用，因为调用`QTcpServer`了函数的基本实现。作为`incomingConnection`一个虚拟功能，您只需将您的分配给 QTcpServer 的incomingConnection 属性，如下所示：

```
class Server(QObject):
    def __init__(self, parent=None):
        QObject.__init__(self)

    def incomingConnection(self, handle):
        print "incoming"
        self.client = Client(self)
        self.client.SetSocket(handle)

    def StartServer(self):
        self.server = QTcpServer()
        self.server.incomingConnection = self.incomingConnection
        if self.server.listen(QHostAddress("0.0.0.0"), 8888):
            print "Server is awake"    
        else:
            print "Server couldn't wake up" 
```

你可以查看 PySide 的文档，因为它比 PyQt 的更 Pythonic，目前仅在此处托管： [http ://srinikom.github.com/pyside-docs/](http://srinikom.github.com/pyside-docs/)

# objective-c - Cocos2d 初学者 objc_msgSend EXC_BAD_ACCESS

> ID：13214635
> 
> 赞同：0
> 
> 时间：2012-11-03T23:43:43.600
> 
> 标签：objective-c, ios, cocos2d-iphone, ios6

我正在用 Objective C 中的 Cocos2d 开发我的第一个 iOS 应用程序。我是 Objective c 的新手，但我试图用谷歌搜索，但我找不到这个普遍问题的解决方案。

```
-(void)accelerate{
     moveSpeed = 720.0 / 3.0;

     [self stopAllActions];
     _moving = FALSE;
     CCAnimation *walkAnim = [CCAnimation animationWithFrames:_walkAnimFrames delay:0.066f];
     self.walkAction = [CCRepeatForever actionWithAction:[CCAnimate actionWithAnimation:walkAnim restoreOriginalFrame:NO]];
     CGPoint loc = ccp(500, 200);
     [self playerMoveTo:loc];
 }

-(void)playerMoveTo:(CGPoint)moveLocation{
     CGPoint moveDifference = ccpSub(moveLocation, self.position); //here is EXC_BAD_ACCESS
     float distanceToMove = ccpLength(moveDifference);
 } 
```

这就是我从我的游戏场景中调用 Player1 加速的方式：

```
-(void) ccTouchEnded:(UITouch *)touch withEvent:(UIEvent *)event {
    CGPoint touchLocation = [touch locationInView: [touch view]];
    touchLocation = [[CCDirector sharedDirector] convertToGL: touchLocation];
    touchLocation = [self convertToNodeSpace:touchLocation];
    [self.Player1 accelerate];
} 
```

Player1 在我的 gameScene 中：

```
//implementation
@synthesize Player1 = _Player1;

//header
@property (nonatomic,retain) TPlayer *Player1; 
```

感谢您的耐心和帮助。我不确定我应该把代码的哪一部分放在这里，所以请告诉我什么，我会添加它。

西蒙

**编辑 1：** Player1 分配在游戏场景的初始化函数中。TPlayer 是 CCSprite 的子类：

```
_Player1 = [[TPlayer alloc] initWithSpriteFrameName:@"walk2"]; 
```

EXC_BAD_ACCESS 发生在这一行：

```
CGPoint moveDifference = ccpSub(moveLocation, self.position); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T00:13:07.577

*   属性应该以小写字母开头（并且是驼峰式）

*   你显示你@synthesize 属性的位置，而不是你实际分配实例的位置。

就像是：

```
_player1 = [[Player alloc] init]; 
```

如果没有看到回溯和定义，很难说更多`ccpSub()`。最好的猜测是`self.position`返回一个无意义的值，使`ccpSub()`出轨。不太可能是`self`过度发布，但仍然足够可行以允许随后在调用`[self position]`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T10:31:38.260

你现在得到了崩溃的解决方案……但是你的 moveTo 函数不正确。

```
-(void)playerMoveTo:(CGPoint)moveLocation{
     CGPoint moveDifference = ccpSub(moveLocation, self.position); //here is EXC_BAD_ACCESS
     float distanceToMove = ccpLength(moveDifference);

     [self runAction:[CCMoveTo actionWithDuration:1 position:moveLocation]];

 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T10:47:13.600

如前所述，由于内存问题，self.position 可能会崩溃。自我可能会被你释放。你运行的是什么版本的 Xcode？在最新版本中，@synthesize 是不必要的，因为属性会自动为您合成。您也可以考虑将您的项目转换为 ARC。我已经用我的 Cocos2D 项目完成了它，我很高兴我做到了。

你可以试试：

```
_Player1 = [[[TPlayer alloc] initWithSpriteFrameName:@"walk2"] autorelease]; 
```

或在初始化后手动增加引用计数：

```
[self.Player1 retain]; 
```

看看是否有帮助。这就是我喜欢ARC的原因：）

# ruby-on-rails - 使用 Faker gem 生成范围内的唯一整数

> ID：13214637
> 
> 赞同：1
> 
> 时间：2012-11-03T23:44:11.070
> 
> 标签：ruby-on-rails, ruby, faker

这似乎应该很简单，但我在任何地方都找不到答案！

我正在 Rails 中构建一个 sample_data rake 文件，以使用 Faker gem 填充我的数据库。（虽然我认为我不需要那个宝石来生成整数）

某些字段需要是设定范围内的整数，但每个字段都必须是唯一的。例如：

```
10.times do |a|
  a.special_number = rand(1..10)
end 
```

效果很好，除了数字不是唯一的......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-03T23:50:19.363

与其尝试生成唯一随机数列表，不如生成一系列数字并打乱该列表？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T01:04:40.590

我建议使用哈希而不是数组，因为比较 Array 中的数字的复杂性是 array.length 而在 hash 中它是 1。您最终可以将哈希键传输到数组中。

```
hash = {}   r = [ ]
while hash.length < n
  a = rand(max)
  if !hash_has_key? (a)
     hash(a) = :ok
  end
end

r = hash.keys 
```

如果您测试 n=30000 和 max = 500000，则与使用数组相比，消耗的时间非常不同。

# actionscript-3 - 如何与工人一起创建弹性项目？

> ID：13214644
> 
> 赞同：3
> 
> 时间：2012-11-03T23:45:19.613
> 
> 标签：actionscript-3, flash, apache-flex, actionscript

我正在尝试将我的应用程序转换为使用工作人员。

我已经将一些类扩展为精灵。然后我将它们添加为项目面板中的工作人员。但是当我尝试使用教程时会出现以下错误：

> 1046：未找到类型或不是编译时常量：Worker。

我正在使用 flash builder 4.7 beta、“installapacheflex”应用程序安装的 Apache Flex SDK 4.8 和 AIR 3.4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T06:55:48.563

目前 Workers 仅支持使用 AIR SDK 3.5 的动作脚本项目，仍然不确定如何在 flex SDK 4.6 中使用 worker。

[检查此链接](http://gotoandlearn.com/play.php?id=162)以获取更多信息

# c++ - 当多个 QGLWidget 可见时，QPainter::end() 很慢

> ID：13214647
> 
> 赞同：2
> 
> 时间：2012-11-03T23:46:11.617
> 
> 标签：c++, qt, opengl

在我的 MDI 子窗口 GUI 中，我有两个选项卡：一个选项卡是一个大型`QGLWidget`派生类，另外四个选项卡`QGLWidget`由拆分器分隔。它们每个都有自己的 OpenGL 上下文（用于实际绘制），在所有 5 个上下文中共享另一个（用于几何数据），并在应用程序范围内共享一个（用于着色器）。

在单个视口选项卡中绘图时，速度如预期的那样快；但是在四边形视图中绘制时（每个视口按创建顺序从计时器更新），随着列表的迭代，每个视口的渲染速度都会下降并且变得更糟。

我开始分析并将搜索范围缩小到`Qt`在四视图中比单视图花费更长的时间的呼叫：

```
QPainter::end(); 
```

所以当只有大的单个视口可见时，我会得到`QPainter::end()`这样的时间（以微秒为单位）：

```
Total time(us): 981
Number of calls: 32
Average call time(us): 30.656250 
```

很合理。但是当我切换到四视图时：

```
Viewport 1:
Total time(us): 196023
Number of calls: 32
Average call time(us): 6125.718750

Viewport 2:
Total time(us): 509769
Number of calls: 32
Average call time(us): 15930.281250

Viewport 3:
Total time(us): 518504
Number of calls: 32
Average call time(us): 16203.250000

Viewport 4:
Total time(us): 518226
Number of calls: 32
Average call time(us): 16194.562500 
```

对于应该是相同数量的工作来说，时间要长得多。更奇怪的是，它增加了 200 倍（！），然后在稳定之前为下一个视口增加 2.5 倍。如果我运行更长时间的测试，它们会给出几乎完全相同的读数——它不会进一步增加。

有问题的`QPainter`代码很简单：

```
QPainter p;
p.begin( this );
p.beginNativePainting();
glUseProgram( program_ );

glActiveTexture( GL_TEXTURE0 );
glBindTexture( GL_TEXTURE_2D, buffer2d_->texture() );
glActiveTexture( GL_TEXTURE1 );
glBindTexture( GL_TEXTURE_2D, buffer3d_->texture() );

surfaceBuf_.bind();
glDrawArrays( GL_TRIANGLE_FAN, 0, 4 );
surfaceBuf_.unbind();

p.endNativePainting();
p.end(); 
```

我浏览了 and 的源代码`QPainter::end()`，`QOpenGLPaintEngine::end()`但它似乎只是状态恢复并确保绘制队列已被刷新。考虑到我没有设置任何状态请求，或者通过 Qt 进行任何绘图（我所有的调用都是原始 OpenGL） - 它不应该有任何事情要做。

为什么即使`QPainter`在堆栈上创建实例并且每个视口都在做相同数量的工作，时间也会增加？

# javascript - 为什么我的文件上传（到 Flask 服务器）没有出现在 request.files 中，但出现在 request.stream 中？

> ID：13214649
> 
> 赞同：5
> 
> 时间：2012-11-03T23:46:29.147
> 
> 标签：javascript, python, flask

我有一个如下所示的表单（恰好位于 iframe 中）：

```
<form id='picture-file-input-button' action='/post-picture' method='post' enctype='multipart/form-data' encoding='multipart/form-data'>
    <button type='button' class='choose-picture-button'>Choose picture</button>
    <input class='picture-file-input' type='file' />
</form> 
```

我使用 $('#picture-file-input-button').submit() 提交表单，这工作正常。请求被发送到正确的 URL，我的 Flask 函数将其拾取并将响应正确地发送回客户端（iframe 被重新加载）。

我没有在 Flask 中做任何花哨的事情。它看起来像这样：

```
@app.route('/post-picture', methods=['POST'])
def post_provider_page_route():
    app.logger.debug(request)
    app.logger.debug(request.data)
    app.logger.debug(request.stream)
    app.logger.debug(request.files)
    app.logger.debug(request.form)
    return render_template('iframe_template.html') 
```

调试所有输出空的 ImmutableMultiDict，除了 request.stream 输出：

```
<werkzeug.wsgi.LimitedStream object at 0x9a7d30c> 
```

我希望看到该文件显示在 request.files 中。为什么它没有出现在 request.files 中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-03T23:46:29.147

除非文件输入元素具有名称属性集，否则不会填充 request.files。name 属性可以设置为任何值。所以上述代码的修复是改变：

```
<input class='picture-file-input' type='file' /> 
```

到

```
<input class='picture-file-input' type='file' name='picture' /> 
```

# mysql - 按 MySQL 字段中的单词数排序

> ID：13214653
> 
> 赞同：2
> 
> 时间：2012-11-03T23:46:59.463
> 
> 标签：mysql, sql-order-by

我想按指定列中的单词数对 MySQL 查询的结果进行排序。

像这样的东西：

```
SELECT bar FROM foo ORDER BY WordCountFunction(bar) 
```

可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-03T23:52:22.207

据我所知，MySQL 中没有字数统计功能，但是如果您的数据格式正确，您可以计算空格数并添加一个（单词的空格分隔符，条目开头/结尾没有空格）。

这是首先列出最长单词的查询：

```
SELECT bar FROM foo ORDER BY (LENGTH(bar) - LENGTH(REPLACE(bar, ' ', ''))+1) DESC 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-03T23:56:00.533

使用[此方法](http://www.mwasif.com/2008/12/count-number-of-words-in-a-mysql-column/)计算列中的单词数，您的查询将如下所示：

`SELECT bar FROM foo ORDER BY (LENGTH(bar) - LENGTH(REPLACE(bar, ' ', ''))+1) DESC`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-03T23:52:37.447

是的，有点。但它不会是 100% 准确的：

```
SELECT SUM(LENGTH(bar) - LENGTH(REPLACE(bar, ' ', ''))+1) as count
FROM table
ORDER BY count DESC 
```

但这假设单词由空格分隔`' '`并且不考虑标点符号。您总是可以用另一个字符替换它，它也不考虑双空格或其他字符。

为了完全准确，您可以随时提取结果并以您选择的语言进行字数统计 - 准确的字数统计功能确实存在！

希望这可以帮助。

# php - convert_uuencode 只返回 2 个字节

> ID：13214655
> 
> 赞同：1
> 
> 时间：2012-11-03T23:47:21.237
> 
> 标签：php, uuencode

我有这个代码：

```
$input  = fopen("input.uue", "rb");
$output = fopen("output.tar.gz", "wb");
$string = fread( $input, 10000000 );
$converted_string = convert_uudecode( $string );
echo $converted_string;
echo fwrite( $output, $converted_string ); 
```

但是 convert_uudecode 只返回 2 个字节而不是几十个。

“input.uue”是 100% 正确的文件（我可以通过我的存档器打开它）。

怎么了？

**UPD**：我已经删除了由 uuencode() 工具添加的初始“begin ...”和“end”，但现在它只读取 87 个字节... **UPD2**已 解决。案例是 UNIX 和 Windows 的行尾符号之间的差异。

`tr -d '\15\32' < windows_encoded_file > unix_encoded_file`解决了这个问题。

# c++ - 在 main 之前退出程序是明确定义的行为吗？

> ID：13214661
> 
> 赞同：13
> 
> 时间：2012-11-03T23:48:52.050
> 
> 标签：c++, exit, main, undefined-behavior

[正如this question](https://stackoverflow.com/questions/9439871/can-you-print-anything-in-c-before-entering-into-the-main-function)`main`中的许多示例所见，在调用之前执行代码绝对是可能的。

但是，如果在那个 pre-main 代码中，程序被告知通过`std::exit`or退出`std::abort`呢？既然`main`被定义为程序的开始，那么在开始之前退出会有什么后果呢？

在每个部分打印一些内容后，我得到以下结果：

***格式：***
**部分**：`output`

**Main**：`main`
**Init（在 main 之前调用）**： Exit（**在 Init 内部**`init`
**设置`std::atexit`**） ：`exiting`

***样品运行：***

**Init 在没有退出的情况下被调用：**

> 初始化
> 主
> *返回 0*

**Init 调用 std::exit(0)：**

> 初始化
> *返回 0*

**Init 调用 std::abort：**

> init
> *在 GCC 4.7.2*
> *崩溃的 Windows 上崩溃并返回 3 崩溃并打开通常的框，VS11*
> *在 LiveWorkSpace 上返回 0*

**Init 设置处理程序并调用 std::exit(0)：**

> 初始化
> 退出
> *返回 0*

**Init 设置处理程序并调用 std::abort：**

> 初始化
> *与没有处理程序相同的交易*

在搜索时，我看到了这个问题：[C/C++ 程序是否可以在 main() 之前崩溃？](https://stackoverflow.com/questions/2518415/is-there-any-way-a-c-c-program-can-crash-before-main). 但是，它没有回答我想知道的问题：是否有任何这种行为，调用`std::exit`或`std::abort`之前`main`，定义明确？有任何这种未定义的行为吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-03T23:55:33.297

简短的回答是：（几乎）没有后果。如果您意外调用了一些析构函数，可能不会调用`exit`，但仅此而已。
通常，不调用析构函数不是最干净的方法，但最终结果还是一样的。

当进程终止时（通过`exit`或`abort`仅通过段错误或其他原因），句柄（内核对象、文件等）被关闭，并且与程序地址空间相关的内存被操作系统回收。

它也没有什么其他的，因为当你调用`exit`or时`abort`，你基本上是在请求程序终止（这些函数永远不会返回！）所以你真的不能指望此后会发生任何事情。

请注意，注册一个像`Init`之前调用的函数`main`是非标准的东西，但是您可以通过在全局中使用构造函数来获得相同的效果。

# python - 使用 Python 中的操作系统默认操作打开 URL

> ID：13214665
> 
> 赞同：0
> 
> 时间：2012-11-03T23:50:13.147
> 
> 标签：python, windows, steam

我正在编辑一个名为 TF2idle 的程序，可以在这里看到：http://facepunch.com/showthread.php?t= [1161862](http://facepunch.com/showthread.php?t=1161862)

我正在添加一个按钮来对使用他可用的人的来源选择的任何帐户进行碎片整理。

我在 python 文件中发现这是所有魔法发生的地方，也是我需要编辑以添加我的 Defrag 按钮的地方。

[http://pastebin.com/9PjzqU5u](http://pastebin.com/9PjzqU5u)

第 136 - 142 和 328-337 行是我自己添加的。这些行如下：

```
startDefragIcon = QtGui.QIcon()
            startDefragIcon.addPixmap(QtGui.QPixmap(returnResourcePath('images/defrag.png')), QtGui.QIcon.Normal, QtGui.QIcon.Off)
            self.startDefragAction = self.mainwindow.htoolBar.addAction(startDefragIcon, 'Defrag Accounts')
            QtCore.QObject.connect(self.startDefragAction, QtCore.SIGNAL('triggered()'), curry(self.startUpAccounts, action='start_Defrag')) 
```

和

```
 if action == 'start_Defrag':
                                    command = r'"%s/Steam.exe" -login %s %s' % (sandbox_install, username, password)
                                    if easy_sandbox_mode == 'yes' and self.settings.get_option('Account-' + account, 'sandbox_install') == '':
                                            self.commandthread.addSandbox('TF2Idle' + username)
                                            self.createdSandboxes.append(username)
                                            command = r'"%s/Start.exe" /box:%s %s' % (sandboxielocation, 'TF2Idle' + username, command)
                                    else:
                                            command = r'"%s/Start.exe" /box:%s %s' % (sandboxielocation, sandboxname, command)
                                    #Right here add script to launch steam://defrag/440 
```

程序可以对帐户进行碎片整理的一种方法是启动“steam://defrag/440”，它会自动执行。例如，我可以在我的谷歌浏览器地址栏中输入该地址，它会告诉 Steam 对 ID 为 440 的程序进行碎片整理，即 TF2。

问题是，我不知道如何将其添加到脚本中。我正在考虑添加一个 BAT 文件，其中包含“steam://defrag/440”，并添加一行将在第 336 行启动所述 BAT 文件。

我希望这里有人知道我如何做到这一点。

第二个问题是我不知道在我完成编辑后如何将所有这些源文件转换为 .EXE。我知道这对我来说都是先进的，但如果我想上大学学习计算机科学，我必须开始学习，而且这真的会帮助许多使用这个工具的用户。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T23:59:36.647

我怀疑你想要[webbrowser 模块](http://docs.python.org/2.7/library/webbrowser.html)：

```
import webbrowser
webbrowser.open_new('steam://defrag/440') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T23:57:55.183

如果你想做的只是对该地址的请求，python 提供了简单的模块来处理它。

```
from httplib2 import Http
h = Http
h.request('steam://defrag/440', 'GET') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T00:04:47.947

这本身可能不符合作为答案的条件，但是由于您的问题也不是真正的问题（：-P），因此这里有一些提示：

*   Steam 客户端将自己注册为`steam://`协议的 URL 处理程序。
*   您应该能够使用[webbrowser](http://docs.python.org/2/library/webbrowser.html)模块实现您建议的工作流程。
*   您可以在 BAT 文件中执行的任何操作，都可以在 Python 脚本中执行。
*   通常，Python 脚本不会被编译（例如编译成 .exe 文件）。也就是说，*py2exe* [将](http://www.py2exe.org/)解释器、代码和依赖项包装到 .exe 文件包中。

编辑：请参阅 Eric 对您关于最后一点的问题的评论。

# php - 将两个或多个数组插入“最终数组”？

> ID：13214673
> 
> 赞同：1
> 
> 时间：2012-11-03T23:52:01.777
> 
> 标签：php, arrays, json

这是我的代码：

```
<?php

    //header code to define as json and if $_GET statement...

    $JSONArrayA[$variableA] = array('id' => $idA, 'test' => $testVariableA);

    $JSONArrayB[$variableB] = array('id' => $idB, 'test' => $testVariableB);

    //current code resulting in ["ArrayArray"]
    $FinalJSONArray[] = $JSONArrayA . $JSONArrayB;

    echo json_encode($FinalJSONArray);
?> 
```

我的问题：如何使数组包含两个或多个数组？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T23:54:48.017

**[数组合并](http://php.net/manual/en/function.array-merge.php)**

```
$FinalJSONArray = array_merge($JSONArrayA, $JSONArrayB); 
```

> 将一个或多个数组的元素合并在一起，以便将一个数组的值附加到前一个数组的末尾。它返回结果数组。

如果您想返回一个**包含**其他两个数组本身的数组，请使用

```
 $FinalJSONArray = array($JSONArrayA, $JSONArrayB); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T23:55:09.060

尝试

```
 $FinalJSONArray[] = $JSONArrayA;
 $FinalJSONArray[] = $JSONArrayB; 
```

这将产生 2 个子数组。如果您希望它们合并使用：

```
 $FinalJSONArray[] = $JSONArrayA+$JSONArrayB; 
```

带有两个数组的“+”将它们联合起来（参见： http: [//php.net/manual/en/language.operators.array.php](http://php.net/manual/en/language.operators.array.php)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-03T23:55:11.130

取决于您希望 JSON 的样子

```
$FinalJSONArray = array($JSONArrayA,$JSONArrayB); 
```

# node.js - 使用选择的 Azure 查询

> ID：13214680
> 
> 赞同：0
> 
> 时间：2012-11-03T23:52:44.780
> 
> 标签：node.js, azure, azure-storage, azure-table-storage

我正在尝试在 azure 中获取一个查询，在该查询中我想获取具有给定分区键和基于日期的行键的实体。

我保留实体分区键、行键、日期、附加信息。

我正在寻找使用 tableservies 的查询，以便我总是得到最新的（使用日期）

我怎样才能得到查询？（我正在使用节点和 Azure）

```
 TableQuery
        .select()
        .from('myusertables')
        .where('PartitionKey eq ?', '545455'); 
```

如何写表查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T01:19:51.510

要回答您的问题，请查看之前回答的问题： [如何仅选择 LINQ 中日期最高的记录](https://stackoverflow.com/questions/470440/how-to-select-only-the-records-with-the-highest-date-in-linq)

但是，您可能会遇到设计问题。执行您尝试执行的操作将需要您从基础 Azure 表中提取所有实体，随着时间的推移，随着实体的添加，这些实体的执行速度会变慢。因此，您可能需要重新考虑您的设计，并可能更改您使用分区键和行键的方式。您还可以将最新的实体存储在单独的表中，以便每个表仅找到 1 个实体，将您的扫描/过滤器转换为查找操作。深思熟虑...

# android - 当我的应用程序项目加载 url 时，服务器说请求无效，但是当我手动将其放入浏览器时，它可以连接到服务器

> ID：13214685
> 
> 赞同：1
> 
> 时间：2012-11-03T23:54:03.197
> 
> 标签：android, webview

```
public class WebViewActivity extends Activity {

private WebView webView;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.webview);
    Bundle extras = getIntent().getExtras();
    String a =extras.getString("txtPub");
    String b =extras.getString("txtPriv");

    webView = (WebView) findViewById(R.id.web_view);
    webView.getSettings().setJavaScriptEnabled(true);
    webView.loadUrl("http://volkova.eu01.aws.af.cm/login/"+a+"+"+b+"/facebook"); 
```

[当我输入一个像http://volkova.eu01.aws.af.cm/login/](http://volkova.eu01.aws.af.cm/login/) "type"+"test"/facebook 这样的虚拟网址时，它也无法连接到服务器。但是当我在股票浏览器上手动输入时，它可以连接到服务器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T04:41:12.133

您是否已将此添加到清单中？该应用程序在加载时可能会出错，因为它没有请求访问互联网。

```
<uses-permission android:name="android.permission.INTERNET"/> 
```

# meteor - 在 Meteor 中拖放可排序列表

> ID：13214686
> 
> 赞同：9
> 
> 时间：2012-11-03T23:54:09.530
> 
> 标签：meteor, jquery-ui-sortable, collaboration

你会怎么做这个？

列表中的项目可以对应于集合中的记录，并且它们在列表中的位置可以对应于每条记录上的一个字段（也许是“排名”），当“停止”事件发生时必须更新该字段。

Meteor 能否与 jQueryUI Sortable 很好地配合使用？如果多个用户试图一次拖动和排序同一个列表会发生什么？Meteor 是否需要自定义排序行为？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-05T07:02:34.817

编辑：以下答案已过时，@cutemachine 的答案或 [http://blog.differential.com/sortable-lists-in-meteor-using-jquery-ui](http://blog.differential.com/sortable-lists-in-meteor-using-jquery-ui)更接近最先进的技术。

* * *

简短的回答是：如果您希望它具有反应性，这并不容易。要制作非响应式版本，只需将模板包装在标签中，然后按照@bento 的建议`{{#constant}}`连接 jquery-ui 可排序。`render`

要制作响应式版本，您的可排序小部件将不得不处理其下发生的变化（考虑在数据重新排序时处于中间拖动状态）。以下是一些关于你将如何去做的想法：

1.  不幸的是，让它动画化并不容易，这将导致糟糕的用户体验。让我们暂时把它放在一边。

2.  使用以下内容渲染项目： `{{#each items}} {{> item}} {{/item}}`

    当数据从服务器下来时，这将重新排序（没有动画）。

3.  将每个项目设置为在呈现时可拖动。你也可以

    一世。使用类似 jquery-ui 可拖动的东西，并将其连接`render`到`item`模板上。您可能会遇到问题，因为如果从上游更改顺序，则底层元素可能会在拖动过程中消失。

    ii. 实现您自己的拖动代码，可能使用较低级别的库。

4.  当一个项目被拖到适当的位置时，立即在本地重新排序列表（这样用户应该看到正确的东西。希望服务器会尊重这个变化......但我们也不要进入那个）。

我认为非常需要这样一个小部件，以一种快速的方式完成。它在我个人的雷达上（但很多事情也是如此，包括用动画重新排序的好方法）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-09T14:43:20.427

Meteor 的新渲染引擎 Blaze 现在可以更好地使用 jQuery。[这是一个简短的视频](https://www.youtube.com/watch?v=ISNEhPG0wnA)，展示了如何使用 Meteor 和 jQuery-UI-sortable 实现可排序列表。

[代码可以在 GitHub 上的 Meteor 存储库中的示例文件夹中](https://github.com/meteor/meteor/tree/devel/examples/unfinished/reorderable-list)找到。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-11-17T06:46:39.317

2014 年 10 月，Differential 发布了带有 Meteor 和 jQuery UI 的可排序列表的最新示例：

[http://differential.com/blog/sortable-lists-in-meteor-using-jquery-ui](http://differential.com/blog/sortable-lists-in-meteor-using-jquery-ui)

请注意，在 Meteor 切换到 Blaze 模板引擎后，以前的解决方案可能无法正常工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-09T23:33:58.513

**更新为 1.0

查看 MeteorPad：[http ://meteorpad.com/pad/TzQTngcy7PivnCCjk/sortable%20demo](http://meteorpad.com/pad/TzQTngcy7PivnCCjk/sortable%20demo)

这是我实现的版本 - 与@tomsabin 的非常相似，但不需要收集行为。它对我来说对多个用户都很有效，而且是被动的。

**HTML** （让 div id 与 _id 相同可能不是一个好主意，我相信您会找到更好的解决方法。）

```
<template name="myList">
  <div class="step_list">
    {{#each card}}
      {{> card_template}}          
    {{/each}}
  </div>
</template>

<template name="card_template">
  <div class="card" id="{{_id}}">             
       <h3>{{name}}</h3>   
  </div>
</template> 
```

**JS**

```
Template.myList.helpers ({
    card : function () {
        return Cards.find({}, {sort: {pos: 1}}
    )}
})

Template.myList.rendered = function(){

     $(".step_list").sortable({
       items: ".card",
       delay: 100,
       refreshPositions: true,
       revert: true,
       helper: "clone",
       scroll: true,
       scrollSensitivity: 50,
       scrollSpeed: 35,
       start: function(event, ui) {
        $(ui.helper).addClass("dragging");
       }, // end of start
       stop: function(event, ui) {
        $(ui.item).removeClass("dragging");
       }, // end of stop
       update: function(event, ui) {
        var index = 0;                   
        _.each($(".card"), function(item) {
          Cards.update({_id: item.id}, {
            $set:{
              pos: index++,
            }
          });
        });
      } 
    }).disableSelection();

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-25T10:14:23.397

[我设法分别使用jQuery UI sortable](https://jqueryui.com/sortable/)和[Meteor Collection Hooks](https://github.com/matb33/meteor-collection-hooks)和[contentEditable](http://www.w3schools.com/tags/att_global_contenteditable.asp)实现了一个拖放、可排序和可编辑的列表。有关部分工作的示例，请查看[此演示](http://sortable-editable-drag-n-droppable-lists.meteor.com/)。

我的实现如下（不幸的是，它不是一个简单的即插即用示例，~~但我希望尽快为这个特定示例启动并运行一个演示~~）：

**用于拖放和保存的客户端 JS：**

```
Template.templateName.rendered = ->
  Deps.autorun ->
    $('#list').sortable
      handle: '.handle'
      stop: (event, ui) ->
        _.each $(event.target).children('div'), (element, index, list) ->
          Elements.update { _id: element.getAttribute('data-element-id') },
            $set: position: index + 1 
```

这里有几件事需要注意，我使用“手柄”来拖动元素，因为每个 div 内部都有其他按钮和可编辑的内容。一旦用户拖动一个元素并将其放置在适当的位置，“停止”事件就会启动，我会使用新的位置更新该列表中的**每个**元素。

我还可以向页面添加元素，这些元素将位于列表的底部。否则，您可能会使用[Meteor Collection Behaviors](https://github.com/Sewdn/meteor-collection-behaviours)和/或[Mongo Counter](https://github.com/awwx/meteor-mongo-counter)包而侥幸逃脱。但是，我使用[Meteor Collection Hooks#.before.insert](https://github.com/matb33/meteor-collection-hooks#beforeinsertuserid-doc)如下：

**钩前收集**

```
@Elements.before.insert (userId, doc) ->
  highestElement = Elements.findOne({},
                     sort: { position: -1 }
                     limit: 1
                   )
  position = if highestElement? then highestElement.position else 0
  doc.position = position + 1 
```

在这里，我们只是获取最高的文档，对位置属性进行排序。如果它不存在（例如要创建的第一个元素），那么我们将位置初始化为从 1 开始。

PS：如果您不了解 CoffeeScript，请将代码复制到这个[令人难以置信的工具（Js2coffee）](http://js2coffee.org/)中。

编辑：请在此处查看独立版本：[演示](http://sortable-editable-drag-n-droppable-lists.meteor.com/)（在 Meteor 的服务器上非常慢）和[源代码](https://github.com/tomsabin/meteor-sortable-editable-drag-n-droppable-lists)

# git - 设置 git 分支

> ID：13214694
> 
> 赞同：0
> 
> 时间：2012-11-03T23:55:17.353
> 
> 标签：git

嗨，我已经在本地机器上设置了 git。

所以我现在可以在本地完全开发并将我的文件推送到主源。

但我希望能够将我的文件从本地提交到远程的阶段文件夹，然后从那里创建一个包含所有用于生产的文件的分支。关于我如何建立这个的任何想法？我对 git 很陌生。（刚学会热提交，新的哈哈）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T23:58:33.170

你真的不在你的遥控器上。您在本地进行更改并将它们推送到远程。因此，在您的情况下，您可以在本地存储库中按照您想要的方式设置分支，并将您想要的分支推送到远程。

# css - CSS min-height 100% 页面内容高度为 100%

> ID：13214695
> 
> 赞同：0
> 
> 时间：2012-11-03T23:55:28.943
> 
> 标签：css

我创建了一个页面，其最小高度为 100%，带有页脚，如[http://peterned.home.xs4all.nl/examples/csslayout1.html所述](http://peterned.home.xs4all.nl/examples/csslayout1.html)

它适用于页面填充 div，但我想在其中包含元素，这些元素也占据了它们可用的所有高度。

尝试：

*   添加`height: 100%`到它们不起作用。他们将使用父母的高度，但还有其他元素和填充等，所以这是错误的高度。
*   使它们成为绝对和设置`top: 0px; bottom: 0px;`。这将使 div 填满整个高度，但如果添加内容，则 div 不会变得更高。

如果这个解释不清楚，我在这里有一个例子：http: [//markv.nl/stack/quine.php](http://markv.nl/stack/quine.php)

所以父母规定了一个最小高度，内容也是如此。应选择其中最高的。我发现这是一项艰巨的挑战。没有javascript可以吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T00:04:20.597

没有javascript是可能的。但是你不应该使用绝对定位来解决这个问题。使用[此](http://ryanfait.com/resources/footer-stick-to-bottom-of-page/)解决方案将页脚粘贴到页面底部。并使内容 div min-height: 100%。随着内容的增加，它会展开并将页脚向下推，而内容较少的页脚将位于页面底部，而内容 div 将被向上推到页脚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T19:14:16.353

经过一番摆弄，我相当有信心，我想做的事是不可能的。如我错了请纠正我。

就我而言，事实证明可以修复。我用`position: absolute`来创建背景图案。在此之上，我在`width:100%`div 中添加了内容以使页面缩放。

它仅适用于某些应用程序，但我认为通用解决方案是不可能的。

# git - Git服务器设置问题

> ID：13214703
> 
> 赞同：3
> 
> 时间：2012-11-03T23:56:16.430
> 
> 标签：git, ubuntu

[我正在按照本教程http://kris.me.uk/2010/09/30/git-repository-server-gitolite.html](http://kris.me.uk/2010/09/30/git-repository-server-gitolite.html)在一个清晰的 VPS 上设置我的 gitserver

它一直工作到这一行：

```
 src/gl-system-install ~/bin ~/share/gitolite/conf ~/share/gitolite/hooks 
```

我在输出中得到了这个：

```
 bash: src/gl-system-install: No such file or directory 
```

这是我第一次设置 git 服务器，所以我有点迷茫，我用谷歌搜索了这个问题，但我找不到任何有意义的东西。感谢各位的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:06:09.350

`gl-system-install`是一个 Gitolite 命令，并且[Gitolite](https://github.com/sitaramc/gitolite)已移至[V3 (或 'g3')](http://sitaramc.github.com/gitolite/master-toc.html)。
在 V3 中，`gl-system-install`不存在，现在称为 gitolite (and `gitolite-shell`)

```
gitolite/install -to $HOME/bin
gitolite setup -pk YourName.pub 
```

有关更新的设置过程，请参阅**[Gitolite 安装页面](http://sitaramc.github.com/gitolite/install.html)**。

> “安装”包含以下选项：
> 
> 1.  将源保存在任何地方并使用完整路径来运行`gitolite`命令。
> 2.  将源代码保存在任何地方，并将程序符号链接`gitolite`到您的`$PATH`.
> 3.  将源代码复制到某处并使用该路径运行`gitolite`命令。
> 
> 选项 2 最适合一般用途。

```
# option 2
gitolite/install -ln
# defaults to $HOME/bin (which is assumed to exist)
#   ** or **
# or use a specific directory (please supply full path):
gitolite/install -ln /usr/local/bin 
```

# mysql - 在模型属性 rails 3 上设置时间范围

> ID：13214704
> 
> 赞同：0
> 
> 时间：2012-11-03T23:56:17.740
> 
> 标签：mysql, ruby-on-rails-3

我有一个应用程序，允许您将食谱上传到数据库，作为应用程序的一部分，我希望有一个从食谱数据库中随机调用的“特色食谱”。我正在使用这种方法来调用随机记录

```
 @featurerecipe = Recipe.offset(rand(Recipe.count)).limit(1) 
```

正如预期的那样，当我刷新页面时，记录会发生变化，但是我希望随机记录保持原位 24 小时，即使页面刷新也是如此。我正在寻找一些关于如何解决这个问题的建议，或者也许其他人已经在他们自己的项目中做到了这一点？我在想你可以有一个名为 feature 的 db 列，然后为其设置一个“真”值，将其他所有内容设置为假，然后在某个地方需要发生一个循环来检查值“真”所花费的时间，然后在 24小时选择另一个随机食谱？

我可能在这里过得很好，任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:50:48.750

正如您所提到的，在表格中添加一个“特色”标志。将 resque/resque-scheduler 或延迟作业设置为每 24 小时运行一次并随机选择一个新项目。

# wpf - Caliburn micro 和 tabcontrol

> ID：13214705
> 
> 赞同：5
> 
> 时间：2012-11-03T23:56:40.487
> 
> 标签：wpf, mvvm, caliburn.micro

我查看了大多数资源，但我可以找到一个好的解决方案。我有一个标签控件硬编码。

```
<TabControl TabStripPlacement="Left" Padding="0" Style="{DynamicResource SettingsTab}" ItemContainerStyle="{DynamicResource SettingsTabItemStyle}" Background="WhiteSmoke" >
                <TabItem Header="ΓΕΝΙΚΑ" Margin="0" IsEnabled="False" > <Grid /></TabItem>                              
                <TabItem Header="Προσωπικό" Margin="0" IsSelected="True">
                    <Grid MinHeight="400">                     

                        <ContentControl HorizontalAlignment="Stretch" Margin="50,67,50,0"  Name="ActiveItem" />
                    </Grid>
                </TabItem>
                <TabItem Header="Τραπέζια" Margin="0">
                    <Grid />
                </TabItem> 
```

**更新 - 重述问题**
这是我自定义的选项卡控件。灰色文本是一个禁用的选项卡项，它的作用类似于一个组。像一般设置，系统设置等。所以它有一个导航菜单的作用。目前，我在每个 tabitem（不是禁用的）都有一个内容控件，并绑定了我想要的视图模型。
但我不能将 Conductor.Collection.OneActive 与 CM 一起使用。
为什么？
我已经从 CM 示例和其他示例中看到了 helloscreens 示例，但这里的问题是，如果我通过绑定执行此操作，那么除了创建一个无用的虚拟视图模型之外，没有其他方法可以显示禁用的 tabitems。那么我该如何实现这 ？

![广告](../Images/f799d23fdd983435b8cb7a855e53abfb.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T04:54:59.620

更新：来源[在这里](https://bitbucket.org/dbeattie/cmwpftabexample/src)

> 我有一个标签控件硬编码。

这是一个要求吗？

> 但我不能将 Conductor.Collection.OneActive 与 CM 一起使用。为什么？

我认为这不起作用的原因是使用`Conductor.Collection.OneActive`您需要将 绑定`ItemsSource`到 Items 集合。如果你要绑定`ItemsSource`，你也不能在`XAML`.

我创建了一个不涉及在 xaml 中描述选项卡项的解决方案。

关键部分：

中描述`ShellView`了`TabControl` `ItemContainerStyle`可以将选项卡项`IsEnabled`属性绑定到视图模型。

```
 <TabControl x:Name="Items"
                    Grid.Row="1"
                    TabStripPlacement="Left">
            <TabControl.ItemContainerStyle>
                <Style TargetType="{x:Type TabItem}">
                    <Setter Property="IsEnabled" Value="{Binding IsEnabled}"/>
                </Style>
            </TabControl.ItemContainerStyle>
        </TabControl> 
```

ShellViewModel 类似，但我们现在激活第二个视图模型，因为第一个未启用。

```
public class HeaderViewModel : BaseTabViewModel
    {
        public HeaderViewModel(string name)
        {
            DisplayName = name;
            IsEnabled = false;
        }
    }

  public ShellViewModel(Tab2ViewModel tab2ViewModel,
                              Tab3ViewModel tab3ViewModel
            )
        {
             Items.Add (new HeaderViewModel ("ΓΕΝΙΚΑ"));
            Items.Add(tab2ViewModel);
            Items.Add(tab3ViewModel);

            ActivateItem (tab2ViewModel);
        } 
```

在视图模型的构造函数中启用或禁用选项卡项。

```
 public Tab2ViewModel()
        {
            DisplayName = "Προσωπικό";
            IsEnabled = true;
        } 
```

未设置样式的结果是第一个选项卡项目被禁用，而接下来的两个选项卡项目被启用。

![在此处输入图像描述](../Images/1c6f3eb6bfb6ffba5510e7d2dc1eefa7.png)

# java - 与列表的每个元素相交 与彼此

> ID：13214707
> 
> 赞同：3
> 
> 时间：2012-11-03T23:56:42.857
> 
> 标签：java, algorithm

我正在尝试将包含彼此的列表中的每个元素相交`String []`。输入列表中的每个元素 ( `String[]`) 的长度为 3 或 4

```
Input: [{'J', 'K', 'L'}, {'G', 'H', 'I'}]
Output: ["JG", "JH", "JI", 
         "KG", "KH", "KI", 
         "LG", "LH", "LI"]

Input: [{'J', 'K', 'L'}, {'G', 'H', 'I'}, {'A', 'B', 'C'}]
Output: ["JGA", "JGB", "JGC", 
         "KGA", "KGB", "KGC", 
         "LGA", "LGB", "LGC", 
         "JHA", "JHB", "JHC",
         "KHA", "KHB", "KHC", 
         "LHA", "LHB", "LHC", 
         "JIA", "JIB", "JIC",
         "KIA", "KIB", "KIC",
         "LIA", "LIB", "LIC"] 
```

输出中每个元素的大小等于输入列表中的总元素。

我已经完成了以下操作，但没有得到正确的结果。

```
ArrayList<String> output = new ArrayList();
for (String [] s : InputList)
   for (int i = 0; i < s.length; i++) {
      if (output.size < 3)
         output.add(s[i])
      else {
         output.add(output.get(i)+s[i]);
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:40:12.990

您可以使用递归方法。这适用于任何（合理）大小的列表：

```
public static List<String> combine(List<String[]> list) {
    List<String> elements = new ArrayList<String>();
    if (!list.isEmpty()) {
        String[] head = list.get(0);
        List<String> tail;
        if (list.size() > 1) {
            tail = combine(list.subList(1, list.size()));
        } else {
            tail = Arrays.asList("");
        }
        for (String headElem : head) {
            for (String tailElem : tail) {
                elements.add(headElem + tailElem);
            }
        }
    }
    return elements;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T23:58:55.913

如果您仍然感兴趣，这是一个非递归版本：

```
public String[] cartesian(char input[][]) {                 
    List<String> output = new ArrayList<String>();          
    int m = input.length;                                   
    int n = input[0].length;                                
    int c[] = new int[m];                                   
    int i = m - 1;                                          
    do {                                                    
        output.add(getElement(input, c, m));                
        do {                                                
            if (c[i] < n - 1) {                             
                c[i]++;                                     
                if (i < m - 1)                              
                    i++;                                    
                break;                                      
            } else {                                        
                c[i] = 0;                                   
                i--;                                        
            }                                               
        } while (i >= 0);                                   
    } while (i >= 0);                                       
    return output.toArray(new String[output.size()]);       
}                                                           

private String getElement(char[][] list, int[] c, int n) { 
    String element = "";                                    
    for (int i = 0; i < n; i++)                             
        element += list[i][c[i]];                           
    return element;                                         
} 
```

您应该能够使用任意数量的子列表。对于您的场景，您可以执行以下操作：

```
char[][] input={{'J', 'K', 'L'}, {'G', 'H', 'I'}, {'A', 'B', 'C'}};
String[] output = cartesian(input); 
```

# php - 使用 PDO 准备语句从搜索字段中使用多个关键字进行 LIKE 查询

> ID：13214712
> 
> 赞同：0
> 
> 时间：2012-11-03T23:57:37.943
> 
> 标签：php, pdo, sql-like

站点用户使用搜索表单来查询产品数据库。输入的关键字在数据库中搜索产品的标题。

```
 public function startSearch($keywords){
        $keywords = preg_split('/[\s]+/', $keywords);
        $totalKeywords = count($keywords);

        foreach($keywords as $key => $keyword){
            $search .= '%'.$keyword.'%';
            if($key != ($totalKeywords)-1){
                $search .= ' AND itemTitle LIKE ';
            }
        }
$sql=$this->db->prepare("SELECT * FROM prodsTable WHERE itemTitle LIKE ?");
$sql->bindParam(1, $search);        
$sql->execute ();
$sql->fetchALL(PDO::FETCH_ASSOC); 
```

如果用户输入单个关键字，则搜索有效，但如果使用多个关键字，则不会执行查询。

如果：$keywords = '苹果 ipod'; $search = '%apple% AND itemTitle LIKE %ipod%';

所以准备好的语句应该是这样的：

“从 prodsTable 中选择 * 在哪里 itemTitle LIKE %apple% AND itemTitle LIKE %ipod%”

如果两个产品的标题中同时包含“apple”和“ipod”，则不会返回任何结果。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-04T00:54:29.567

准备好的语句保护您免受 sql 注入，因此参数中的 sql 代码不会被解释。 `AND itemTitle LIKE ?`在调用 prepare() 之前，您必须使用正确的数量构建一个 sql 查询。

```
 $keywords = preg_split('/[\s]+/', $keywords);
  $totalKeywords = count($keywords);
  $query = "SELECT * FROM prodsTable WHERE itemTitle LIKE ?";

  for($i=1 ; $i < $totalKeywords; $i++){
    $query .= " AND itemTitle LIKE ? ";
  }

  $sql=$this->db->prepare($query);
  foreach($keywords as $key => $keyword){
    $sql->bindValue($key+1, '%'.$keyword.'%');
  }
  $sql->execute (); 
```

# c++ - SDL/C++ 中的鼠标悬停不起作用

> ID：13214713
> 
> 赞同：0
> 
> 时间：2012-11-03T23:57:38.930
> 
> 标签：c++, sdl

我有一个简单的脚本，当鼠标悬停在第一个初始按钮上时，我希望脚本加载第二个按钮。但它不会返回 true，所以我似乎无法让它工作。

这是我的班级检查情况：

```
class Button
    {
    private:
        int m_x, m_y;            
        int m_width, m_height;

    public:
    Button(int x, int y, int width, int height)
    {
       m_x = x;
       m_y = y;
       m_width = width;
       m_height = height;

    }

    bool IsIn( int mouseX, int mouseY )
    {
        if (((mouseX > m_x) && (mouseX < m_x + m_width)) 
        && ((mouseY > m_y) && (mouseY < m_y + m_height ) ) ) {
            return true;
        } else {
            return false;
        }
    }

    void Render(SDL_Surface *source,SDL_Surface *destination)
    {
        SDL_Rect offset;
        offset.x = m_x;
        offset.y = m_y;
        offset.w = m_width;
        offset.h = m_height;

        source = IMG_Load("button.png");

        SDL_BlitSurface( source, NULL, destination, &offset );

    }
}; 
```

它是`IsIn`我试图开始工作的功能......在我的主循环中，我有：

```
while(!quit){
while( SDL_PollEvent( &event ) )
        switch( event.type ){
            case SDL_QUIT: quit = true; break;
            case SDL_MOUSEMOTION: mouseX = event.motion.x; mouseY = event.motion.y; break;      
        }

 Button btn_quit(screen->w/2,screen->h/2,0,0);
 btn_quit.Render(menu,screen);

 if(btn_quit.IsIn(mouseX,mouseY)){

     Button btn_settings(screen->w/2,screen->h/2+70,0,0);
     btn_settings.Render(menu,screen);

 } 
```

`SDL_Quit``btn_quit`工作正常，但是当我将鼠标悬停在按钮上时，我似乎无法让 case 语句之后的 if 语句返回 true 。任何想法为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:13:04.753

因为`btn_quit`没有宽度或高度，因此你永远不能在它的范围内。

```
Button btn_quit(screen->w/2,screen->h/2,0,0); 
```

您的检查将失败，因为您的鼠标位置永远不会是`>x && <x+0`或`>y && <y+0`。

也许更好的方法是定义按钮的位置，然后从加载的图像中获取尺寸？

```
class Button
{
  public:
    // Construct the button with an image name, and position on screen.
    // This is important, your existing code loaded the image each render.
    // That is not necessary, load it once when you construct the class.
    Button(std::string name, int x, int y) : img(IMG_Load(name)) 
    {
      if(img) // If the image didn't load, NULL is returned.
      {
        // Set the dimensions using the image width and height.
        offset.x = x; offset.y = y;
        offset.w = img.w; offset.h = img.h;
      }
      else { throw; } // Handle the fact that the image didn't load somehow.
    }     
    ~Button() { SDL_FreeSurface(img); } // Make sure you free your resources!
    void Render(SDL_Surface *destination)
    {
      // Simplified render call.
      SDL_BlitSurface(img, NULL, destination, &offset );
    }
    bool Contains(int x, int y)
    {
      if((x>offset.x) && (x<offset.x+offset.w)
      && (y>offset.y) && (y<offset.y+offset.h))
      return true; // If your button contains this point.
      return false;  // Otherwise false.
    }
  private:
    SDL_Rect offset; // Dimensions of the button.
    SDL_Surface* img; // The button image.
} 
```

# php - 线程视图中的分层评论系统：PHP 和 MySQL

> ID：13214714
> 
> 赞同：1
> 
> 时间：2012-11-03T23:57:41.847
> 
> 标签：php, mysql, hierarchy, comments

我需要呈现 2 级分层评论系统的线程视图。评论存储在数据库中。有关层次结构的信息由字段“parent_id”（顶级注释为 0）给出。我无法更改数据库的结构。目前的解决方案是通过多个 SQL 查询：

1.  执行 SQL 查询以获取所有顶级注释
2.  代码循环遍历顶级注释，并为每个注释执行 SQL 查询以获取其子级

现在我想知道只有一个 SQL 查询来获取所有注释的解决方案是否会更有效，因为它们后面跟着[这里建议的代码以按线程对它们进行排序。](https://stackoverflow.com/questions/7673044/nested-array-third-level-is-disappearing/7673415#7673415)有什么推荐吗？

谢谢，卢西亚诺

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T11:07:34.223

我已经完成了类似的脚本，从我的角度来看，最好进行第一个查询以获取所有“父母”（parent_id == 0），然后为每个人执行另一个查询以获取其所有“儿子”信息.

如果您必须使用单个查询检索大量威胁，则必须等待查询完成才能处理数据。如果您将搜索划分为不同且较小的查询，您可以在查找“儿子”之前开始格式化和打印它们。同样在单个查询中执行此操作可能会使查询变慢，因为在同一查询中使用更多表可能会在某人创建新威胁时由于 lock_table 而使其停止。

另一种解决方案，如果由于被迫使用多个 JOIN 或将 WHERE 与非索引字段一起使用而导致查询非常慢，我只建议使用该解决方案（你不应该这样做，但如果你不能更改数据库......） ，是在单个查询中检索所有威胁（父母和儿子，没有任何使查询变慢的 WHERE 或 JOIN），然后使用 PHP 组织它们。这绝不是实用的，除非完成查询的时间很长，否则永远不要使用这种方法。

# php - 如何在循环遍历数组时将项目添加到数组中？

> ID：13214716
> 
> 赞同：9
> 
> 时间：2012-11-03T23:57:58.193
> 
> 标签：php, arrays, loops, foreach

在`foreach`循环中，PHP 似乎在一开始就读取了整个数组，因此如果您突然需要将新项目附加到数组中，它们将不会被循环处理：

```
$a = array (1,2,3,4,5,6,7,8,9,10);

foreach ($a as $b)
    {
        echo " $b ";
        if ($b ==5) $a[] = 11;
    } 
```

只打印出来： `1 2 3 4 5 6 7 8 9 10`

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-04T00:05:17.613

只需创建您正在循环的数组的参考副本

```
$a = array(1,2,3,4,5,6,7,8,9,10);
$t = &$a; //Copy
foreach ( $t as $b ) {
    echo " $b ";
    if ($b == 5)
        $t[] = 11;
} 
```

或者只是使用`ArrayIterator`

```
$a = new ArrayIterator(array(1,2,3,4,5,6,7,8,9,10));
foreach ( $a as $b ) {
    echo "$b ";
    if ($b == 5)
        $a->append(11);
} 
```

输出

```
 1 2 3 4 5 6 7 8 9 10 11 
```

[观看现场演示](http://codepad.viper-7.com/FHXJmo)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-03T23:57:58.193

本着[its-ok-to-ask-and-answer-your-own-questions](https://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/)的精神，这是我发现的最佳解决方法：将其转换为`while`循环。

```
$a = array (1,2,3,4,5,6,7,8,9,10);
$i = 0;
while ($i < count($a))
    {
        $b =  $a[$i];
        echo " $b ";
        if ($b ==5) $a[] = 11;
        $i++;
    } 
```

不是它正确地发出 `1 2 3 4 5 6 7 8 9 10 11`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-29T14:00:53.970

一个简单的方法是创建第二个数组，它将保留旧数组，并且在循环时您可以在那里添加新值。

在循环结束时，新数组将包含**旧数组 + 新插入的值**

# android - android中是否有任何库用于识别语音相同的声音

> ID：13214719
> 
> 赞同：1
> 
> 时间：2012-11-03T23:58:16.323
> 
> 标签：android, search

我正在尝试构建一个 android 应用程序。在其中一个屏幕中，用户可以在搜索栏中输入一些内容，而我必须对同一个单词的不同拼写采取相同的操作。

**例如：**用户可以输入*"elephant"*或*"alephant"*或*"elefant"*。我必须对所有这三个词采取相同的行动。

有没有将这些词识别为相似词的库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:11:18.827

看起来你可以使用 sound ex 来获得字符串之间的一些语音距离：[实现语音搜索的最有效方法](https://stackoverflow.com/questions/8359595/the-most-efficient-way-to-implement-a-phonetic-search)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T21:51:43.527

Double Metaphone 和 Metaphone3 是识别语音相似词的出色解决方案。在我的案例中，我使用了 Double Metaphone，仅仅是因为它是开源的并且 Java 实现可用。它工作得很好。

[Metaphone 和双 Metaphone 的 Java 实现](http://commons.apache.org/codec/userguide.html)

Metaphone 3 应该更好，但我认为没有可用的免费[实现](http://amorphics.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T00:00:57.037

也许拼写检查器可以：http: [//developer.android.com/guide/topics/text/spell-checker-framework.html](http://developer.android.com/guide/topics/text/spell-checker-framework.html)

这是一种不同的方法，但非常接近且更灵活。

# php - MSOFFICE MIME 类型验证

> ID：13214720
> 
> 赞同：8
> 
> 时间：2012-11-03T23:58:31.250
> 
> 标签：php, file-upload, ms-office, mime-types

我有以下内容：

```
$mimeTypes = array('application/msword'); //used to be an array

$finfo = new finfo(FILEINFO_MIME, "/usr/share/misc/magic"); 

$type = $finfo->file($_FILES['userfile']['tmp_name']);
$mime = substr($type, 0, strpos($type, ';'));

    if (in_array($mime, $mimeTypes)) 
      { //let it in 
```

问题是我将“application/vnd.ms-office”作为我尝试上传的任何 MSOFFICE 文件的文件类型。我不希望允许所有 MSOFFICE 文件，只允许 .DOC 文件。有解决方法吗？

**请注意，这些 MSOFFICE 类型的文件是在 OPENOFFICE 中创建的，这会有所不同吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-04T00:08:59.280

您可以做的最好的事情是在知道文件是 Office 文档 ( `application/vnd.ms-office`) 后验证文件扩展名，并为当前文件手动设置正确的 MIME。

如果您有权访问 Apache，则可以在其中添加正确的 MIME`conf/mime.types`

```
application/msword doc
application/vnd.ms-excel xls
[..] etc 
```

Office MIME 类型列表（来自[http://fileext.com/faq/office_mime_types.php](http://filext.com/faq/office_mime_types.php)）

```
.doc    application/msword
.dot    application/msword
.docx   application/vnd.openxmlformats-officedocument.wordprocessingml.document
.dotx   application/vnd.openxmlformats-officedocument.wordprocessingml.template
.docm   application/vnd.ms-word.document.macroEnabled.12
.dotm   application/vnd.ms-word.template.macroEnabled.12
.xls    application/vnd.ms-excel
.xlt    application/vnd.ms-excel
.xla    application/vnd.ms-excel
.xlsx   application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
.xltx   application/vnd.openxmlformats-officedocument.spreadsheetml.template
.xlsm   application/vnd.ms-excel.sheet.macroEnabled.12
.xltm   application/vnd.ms-excel.template.macroEnabled.12
.xlam   application/vnd.ms-excel.addin.macroEnabled.12
.xlsb   application/vnd.ms-excel.sheet.binary.macroEnabled.12
.ppt    application/vnd.ms-powerpoint
.pot    application/vnd.ms-powerpoint
.pps    application/vnd.ms-powerpoint
.ppa    application/vnd.ms-powerpoint
.pptx   application/vnd.openxmlformats-officedocument.presentationml.presentation
.potx   application/vnd.openxmlformats-officedocument.presentationml.template
.ppsx   application/vnd.openxmlformats-officedocument.presentationml.slideshow
.ppam   application/vnd.ms-powerpoint.addin.macroEnabled.12
.pptm   application/vnd.ms-powerpoint.presentation.macroEnabled.12
.potm   application/vnd.ms-powerpoint.template.macroEnabled.12
.ppsm   application/vnd.ms-powerpoint.slideshow.macroEnabled.12 
```

# linux - fail2ban-regex 找不到任何文本

> ID：13214726
> 
> 赞同：1
> 
> 时间：2012-11-03T23:59:19.380
> 
> 标签：linux, iptables

我安装了服务器**FAIL2BAN**，现在无法理解问题所在。

fail2ban-regex 找不到正则表达式，即使很简单：

```
fail2ban-regex "192.168.1.1" "<HOST>$" 
```

和答案

```
Running tests
=============

Use regex line : <HOST>$
Use single line: 192.168.1.1

Results
=======

Failregex
|- Regular expressions:
|  [1] <HOST>$
|
`- Number of matches:
   [1] 0 match(es)

Ignoreregex
|- Regular expressions:
|
`- Number of matches:

Summary
=======

Sorry, no match

Look at the above section 'Running tests' which could contain important
information. 
```

请告诉我可能是蜜蜂错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T10:49:53.740

我有这个：

> 找到“192.168.1.1”的匹配项，但没有找到“192.168.1.1”的有效日期/时间。请联系作者以获得对该格式的支持

因此，看起来它需要示例字符串中的日期时间。

例如，这很好用：

```
fail2ban-regex "03-12-2012 12:00:00 192.168.1.1" "<HOST>$"

Running tests
=============

Use regex line : <HOST>$
Use single line: 03-12-2012 12:00:00 192.168.1.1

Results
=======

Failregex
|- Regular expressions:
|  [1] <HOST>$
|
`- Number of matches:
   [1] 1 match(es)

Ignoreregex
|- Regular expressions:
|
`- Number of matches:

Summary
=======

Addresses found:
[1]
    192.168.1.1 (Mon Dec 03 12:00:00 2012)

Date template hits:
0 hit(s): MONTH Day Hour:Minute:Second
0 hit(s): WEEKDAY MONTH Day Hour:Minute:Second Year
0 hit(s): WEEKDAY MONTH Day Hour:Minute:Second
0 hit(s): Year/Month/Day Hour:Minute:Second
0 hit(s): Day/Month/Year Hour:Minute:Second
0 hit(s): Day/MONTH/Year:Hour:Minute:Second
0 hit(s): Month/Day/Year:Hour:Minute:Second
0 hit(s): Year-Month-Day Hour:Minute:Second
0 hit(s): Day-MONTH-Year Hour:Minute:Second[.Millisecond]
2 hit(s): Day-Month-Year Hour:Minute:Second
0 hit(s): TAI64N
0 hit(s): Epoch
0 hit(s): ISO 8601
0 hit(s): Hour:Minute:Second
0 hit(s): <Month/Day/Year@Hour:Minute:Second>

Success, the total number of match is 1

However, look at the above section 'Running tests' which could contain important
information. 
```

# javascript - 在 Windows 8 Javascript 应用程序中使用 SQLite3

> ID：13214727
> 
> 赞同：10
> 
> 时间：2012-11-03T23:59:29.707
> 
> 标签：javascript, windows-8, sqlite, microsoft-metro

使用 JavaScript 为新的 Windows 应用商店构建 Windows 8 应用程序我偶然发现缺乏良好的数据存储机制。

我希望我的应用程序使用 SQLite3，但我似乎无法让它工作。尝试通过 JavaScript 访问 SQLite3 API 时，我能得到的最接近的错误是“类未注册”。

如果您使它适用于您的应用程序，请分享一个示例。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T00:02:20.110

看看 github 上的 SQLLite-WinRT 项目。我还没有玩过它，但它在我的尝试队列中。

[https://github.com/doo/SQLite3-WinRT](https://github.com/doo/SQLite3-WinRT)

这是一个教程： [http ://timheuer.com/blog/archive/2012/08/07/updated-how-to-using-sqlite-from-windows-store-apps.aspx](http://timheuer.com/blog/archive/2012/08/07/updated-how-to-using-sqlite-from-windows-store-apps.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:34:55.967

我不确定它在 javascript 中是如何工作的，但是在使用 sqlite 的 C# 版本中，您必须将 dll 添加到应用程序的根文件夹中，并确保在其属性中将其设置为：内容-> 始终复制

# qt - 在不同线程上运行时，QTimer 超时信号不调用插槽

> ID：13214730
> 
> 赞同：4
> 
> 时间：2012-11-03T23:59:59.520
> 
> 标签：qt

我有一个 QObject 的子类，称为 myObject，它在构造函数的堆上分配了一个 QTimer 数据成员。myObject 还有一个槽，它连接到构造函数中的 QTimer timeout() 信号。我将 myObject 的指针称为 myObject_ptr。

我想在与主线程不同的线程上运行 myObject。按照相对较新的建议，我不继承 QThread。在主线程中，我使用 myObject 如下：

```
QThread *thread = new QThread(this);
myObject_ptr->moveToThread(thread);
connect(myObject_ptr, SIGNAL(destroyed(), thread, SLOT(quit())); //thread not needed if no object
connect(thread, SIGNAL(finished()), thread, SLOT(deleteLater())); //to avoid memory leak
connect(thread, SIGNAL(terminated()), thread, SLOT(deleteLater())); //to avoid memory leak
thread->start(); 
```

主线程调用 myObject_ptr 的函数，该函数依次启动 QTimer 数据成员。当它超时时，什么也没有发生，但我希望定时器的 timeout() 信号连接到的 myObject 插槽被调用。问题是什么？你如何使这项工作。如果 myObject 在创建它的同一线程（即主线程）上运行，它可以完美地工作。

从我所做的所有阅读中，我认为我正在创建的新线程可能没有处理事件，因为它没有自己的事件循环。我还阅读了与此相反的文档/文章，说当线程启动时， run() 函数调用 exec() 并且您有一个事件循环。

有人可以帮我吗？

如果我将 QThread 子类化，我可能会让它正常工作，但根据当前的建议，我宁愿避免这样做。

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T02:42:17.977

我解决了我的问题！！在 MyObject 的构造函数中，定时器在堆上分配如下：

```
timer_ptr = new QTimer(this); 
```

但要正常工作，它应该是：

```
timer_ptr = new QTimer(0); 
```

在析构函数中，手动删除对象：

```
timer_ptr->deleteLater(); 
```

我猜当他们说不能将带有父对象的对象移动到线程时，他们确实是指所有对象，包括实际被移动到新线程的对象的数据成员。

快乐编码。

# android - 相机预览上的 OpenGL 覆盖 - 需要以相反的顺序设置内容视图？

> ID：13214731
> 
> 赞同：2
> 
> 时间：2012-11-04T00:00:00.690
> 
> 标签：android, opengl-es, android-camera

我正在尝试通过 Android 相机预览显示动态 OpenGL。我使用了其他指南/站点中建议的典型框架来创建一个实现 GLSurfaceView.Renderer 接口的对象，然后使用 setContentView() 和 addContentView() 。问题是 onDrawImage 发生在显示相机预览的表面支架后面。

这是一个更大的应用程序的一部分，我已经单独测试了一个侧面应用程序中的所有组件。两者之间的唯一区别是较大的应用程序在此之前有几个活动，而侧面应用程序仅将此活动用作主要活动。

**更新** 答案是切换setContentView和addContentView的顺序。如果是主应用，请使用本文中的顺序：[opengl overlay on camera view](https://stackoverflow.com/questions/8986437/opengl-overlay-on-camera-view)；但是，如果您来自其他活动，请运行：

```
setContentView(theCameraCallbackView)
addContentView(theOpenGLView, new LayoutParams( LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT )) 
```

如果有人可以在这背后提供一些推理，将不胜感激！我在这个两行交换上花了大约 8 个小时，所以很高兴知道这是什么原因（并希望防止其他人出现类似问题）。

# javascript - javascript中无法理解的东西

> ID：13214732
> 
> 赞同：-1
> 
> 时间：2012-11-04T00:00:06.620
> 
> 标签：javascript

这是什么意思？

1.

```
a==b&&b={} 
```

2.

```
a==b||b={} 
```

我没有找到答案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:03:18.673

这意味着，如果 a 等于 b，则将 b 设置为空对象。第二个意思差不多。不同之处在于，如果 a 和 b 不相等，第一个不会将 b 设置为空对象。但无论如何，第二个总是会这样做。那是因为 javascript 中的 OR 运算符在 AND 运算符短路的地方继续存在。

[http://www.openjs.com/articles/syntax/short_circuit_operators.php](http://www.openjs.com/articles/syntax/short_circuit_operators.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T00:04:49.767

`a==b`是要测试的条件。运算符`&&`和`||`测试条件非常类似于三元运算符，但是当您只需要测试一个条件时使用它，要么是 false`||`要么是 true `&&`。这将与以下内容相同：

```
if ( a == b ) { b = {} } // a == b && ( b = {} )
if ( a != b ) { b = {} } // a == b || ( b = {} ) 
```

但正如 Esailija 在评论中指出的那样，您似乎缺少一些括号：

```
a == b || ( b = {} ) 
```

# javascript - 动态加载 ASP 用户控件会丢失 javascript 换行符

> ID：13214740
> 
> 赞同：1
> 
> 时间：2012-11-04T00:01:06.633
> 
> 标签：javascript, debugging

我正在从 web 方法加载一个 asp.net 用户控件。但是在使用 Firebug 或 Chrome 进行调试时，javascript 不再有任何换行符。有没有办法保留换行符？

```
[WebMethod]
public static string LoadUserControl(string message)

{
    using (Page page = new Page())
    {
        UserControl userControl = (UserControl)page.LoadControl("Message.ascx");
        (userControl.FindControl("lblMessage") as Label).Text = message;
        page.Controls.Add(userControl);
        using (StringWriter writer = new StringWriter())
        {
            page.Controls.Add(userControl);
            HttpContext.Current.Server.Execute(page, writer, false);
            return writer.ToString();
        }
    }
} 
```

# r - 如何在 Latex knitr 图形标题中添加希腊字母？

> ID：13214741
> 
> 赞同：13
> 
> 时间：2012-11-04T00:01:11.773
> 
> 标签：r, latex, knitr

我搜索了这个，但找不到它。在 knitr 文档中，我想将 $\alpha_1$ 作为标题添加到图上，如下所示：

```
<<fig.cap='$\alpha_1$'>>=
 plot(1:5,1:5)
@ 
```

试图编织这个会出现错误

```
! Text line contains an invalid character.
l.172 ...axwidth]{figure/plotSigma1} \caption[$^^G
                                              lpha_1$]{$^^Glpha_1$\label... 
```

有办法吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-04T00:03:10.147

没关系 - 你只需要为 alpha 转义 \

```
<<fig.cap='$\\alpha_1$'>>=
 plot(1:5,1:5)
@ 
```

# php - 强制限制用户 MySQL 查询

> ID：13214744
> 
> 赞同：0
> 
> 时间：2012-11-04T00:02:04.200
> 
> 标签：php, mysql, pdo, limit

所以我有一个区域，人们可以针对我的数据库编写自己的查询，但我想限制返回的结果（很像 PhpMyAdmin）。

所以我需要检查`$_POST['query']`是否有限制声明，如果有，请确保它低于 30，比如说。如果没有限制，我需要添加它。

我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T00:13:42.913

忽略风险......我认为最好的是将查询用作子查询并应用限制。所以你避免评估查询。

```
SELECT * 
FROM (
 SELECT * 
 FROM 'table'
 LIMIT 0 , 100
) AS query

LIMIT 0 , 30 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T00:29:51.900

您可以使用`preg_*`函数来检查查询并注入您的首选限制。

**编辑：**我完全忽略了`LIMIT`关键字的可能用途。这是编辑后的版本。

```
$query = 'SELECT * FROM aa LIMIT 100,20';
$limit = 20; // predefined max limit

// possibilities:
// LIMIT N[,N]
// LIMIT N OFFSET N

preg_match('~(?<=\blimit\s)\s*(?<limit>\d+)\s*(,\s*\d+|\soffset\s+\d+)?\s*$~i',$query,$limitStr);
if (isset($limitStr['limit'])) {
    $maxLimit = min((int)$limitStr['limit'],$limit);
    // user might have already limited it so this is
    // just to make sure it does not exceed your max.
    $query = preg_replace('~(?<=\blimit\s)\s*\d+\s*(,\s*\d+|\soffset\s+\d+)?\s*$~i',$maxLimit.'$1',$query);
} else $query .= " LIMIT $limit";

echo $query; 
```

将输出`SELECT * FROM aa LIMIT 20,20`

# bash - 带有 Crontab 的 Bash 脚本

> ID：13214745
> 
> 赞同：0
> 
> 时间：2012-11-04T00:02:07.597
> 
> 标签：bash, text, cron, crontab

我正在尝试设置一个 crontab 我在我当前的工作中在我登录的当前用户中有这个

```
* * * * * /CS/day/get_info.sh 
```

get_info.sh 应该每分钟输出一个文本文件，我怀疑它会在脚本所在的同一目录中输出一个文件，但事实并非如此。

我还检查了系统日志，看看我是否能解决这个问题。

```
(user) CMD (/CS/day/get_info.sh)
(user) MAIL (mailed 46 bytes of output but got status  0x0001#012) 
```

有人可以向我解释为什么会这样吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T11:25:39.823

`man cron`告诉你：

> ```
>  When executing commands, any output is  mailed  to  the  owner  of  the
>   crontab (or to the user named in the MAILTO environment variable in the
>   crontab, if such exists).  The children copies of  cron  running  these
>   processes  have their name coerced to uppercase, as will be seen in the
>   syslog and ps output. 
> ```

所以你必须

*   `cd`自己进入适当的目录（cron将使用`$HOME`）
*   *将任何*输出重定向到您选择的文件

你可以在 crontab 中做这两件事。但我建议在脚本本身的第一行执行此操作：

```
#!/bin/bash
cd WHEREEVER_YOU_WANT
exec > YOUR_LOG_FILE 2&>1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-20T09:19:55.283

就我而言，我只需要安装和配置一个 smtp 客户端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T00:06:05.637

该脚本在用户的主目录中运行，并且该文件也应该在那里。如果您希望它与脚本位于同一目录中，请在脚本中执行 a`cd`或修改您的 crontab 条目：

```
*/1 19-20 * * * cd /CS/day; /CS/day/get_info.sh 
```

crontab 条目的另一个常见问题是环境。如果脚本在您的终端中正常运行，请尝试在从 cron 运行时对其进行调试：

```
40 11 * * * bash -x /CS/day/get_info.sh >/tmp/get_info.sh.log 2>&1 
```

仅使用当前时间运行一次，否则您将每分钟覆盖一次日志文件。

# php - 如果字符串为空 PHP

> ID：13214747
> 
> 赞同：0
> 
> 时间：2012-11-04T00:02:14.917
> 
> 标签：php, string

我正在尝试创建一个 if 语句来显示内容（如果它不为空）。它当前显示 if 为空值。

```
$openHomeStart = '2012-11-10T01:00:00Z';

if(!empty($openHomeStart)){
    echo 'value';
}else{
    foreach ($openHomeTimes as $time){
        $openHomeDetails .= $time;
    }       
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:06:31.153

我认为你只是有你的条件错误的方式。如果 $openHomeStart*不为空*，则它会输出“值” 。如果您希望它迭代该值（并且拥有一个值是您可以迭代它的唯一方法，那么您只需要删除 ! 从您的条件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T00:10:03.467

```
$openHomeStart = "2012-11-10T01:00:00Z";
if(empty($openHomeStart))
{
    echo 'empty';
} else {
    echo 'not empty';
} 
```

嗯……Shane先说的^_^

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T00:23:33.513

pst 已经说过，但那些反引号不会给出错误，但也不会设置变量。

```
<?php
$var = `2012-11-10T01:00:00Z`;

echo $var; 
```

结果：没有

此外，假设您只是没有粘贴 $openHomeTimes 值的代码，如果您只想在 $openHomeStart 为空时迭代 $openHomeTimes 或在 $openHomeStart 不为空时回显“某个值”，那么您就有了 if 语句正确的。只需将反引号更改为引号即可。

# .net - 在 TextBox 中以 d/mm 格式输入日期

> ID：13214749
> 
> 赞同：10
> 
> 时间：2012-11-04T00:02:22.483
> 
> 标签：.net, windows-8, .net-4.5, cultureinfo

我有一个 TextBox 绑定到一个可为空的 DateTime 属性。

我在澳大利亚，所以我希望以 d/mm/yyyy 格式显示日期。

在我的 Windows 7 框中，我可以输入 d/mm 格式的日期，并且它已正确转换（例如，1/11 转换为 11 月 1 日，13/1 转换为 1 月 13 日等）

在我的 Windows 8 机器上，相同的输入被解释为美国格式，因此 1/11 转换为 1 月 11 日，而 13/1 失败（因为没有第 13 个月）。

两台计算机都设置为使用澳大利亚格式，我在 Application.StartUp 事件中有以下代码：

```
FrameworkElement.LanguageProperty.OverrideMetadata(GetType(FrameworkElement), New FrameworkPropertyMetadata(XmlLanguage.GetLanguage(CultureInfo.CurrentCulture.IetfLanguageTag))) 
```

Binding 的 StringFormat 设置为 d/MM/yyyy，并且我通过将 TextBlock 绑定到 StringFormat 设置为 D 的相同属性（长日期格式，它给出的值如“星期三， 2012 年 1 月 11 日')。

有没有人有任何想法？

**更新：**进一步调查（见下面的评论）表明这似乎是一个问题，与 Windows 7 相比，Windows 8 上的 en-AU 文化不同，这意味着它以 mm/dd 格式解释像“1/11”这样的日期Windows 8，而在 Windows 7 上，它以 dd/mm 格式解释它们，这是我在使用 en-AU 文化时所期望的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T06:36:26.527

由于不推荐使用 IetfLanguageTag，您是否考虑过使用 Name 属性？

[http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.ietflanguagetag.aspx](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.ietflanguagetag.aspx)：

> IETF 语言标签的格式类似于 Name 属性返回的文化名称，但不能唯一标识文化。也就是说，如果这些文化具有相同的语言特征，则不同的文化共享相同的 IETF 语言标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-07T00:44:16.653

使用

```
System.Globalization.DateTimeFormatInfo.CurrentInfo.MonthDayPattern = "dd MMMM"; 
```

将更新您当前线程的月份和日期格式。Windows Server 2012 中的`MonthDayPattern`变化。我还没有弄清楚为什么。

# html - LessCss：带有 & 关键字的多个类选择器

> ID：13214750
> 
> 赞同：9
> 
> 时间：2012-11-04T00:02:51.907
> 
> 标签：html, css, less

说 - 有一个 .less 表，其中包含大量“多个”css 规则来管理图标。像这样：

```
.icon { display:inline-block; position:relative; text-indent:-9999em;}
.icon-l.legend { width:24px; height:24px;}
.icon-white.legend{ background:url(@icon_legend_white) no-repeat;}
.icon-l.arrow_left{background-position: -128px -32px;} 
```

并应用这样的规则：

```
<i class="icon icon-l icon-color legend arrow_left"></i> 
```

正如人们所期望的那样，当我可以访问标记时，这可以正常工作，但是我很难将这些规则`less`应用于给定元素：

这是我期望的工作：

```
#something{
  .icon;
  .icon-l.legend;
  .icon-white.legend;
  .icon-l.arrow_left;
} 
```

这只会引发错误。

我“相信”“&”运算符可以应用如下规则：

```
#something{
 .icon;
 .icon-l{&.legend{}};
 .icon-white{&.legend{}};
 .icon-l{&.arrow_left{}};
} 
```

这不会引发错误，但只会`.icon`应用规则。

有人有解决方案吗？

**更新**

仅供参考 - 我正在为许多不同的独特工作表一起编译几个 .less 文件。效果很好。

[SublimeText2 插件](http://tech.diaslopes.com/?p=112)- 工作得相当好，并且很好地集成到工作流程中（需要“构建”文件） - 但无法像这样渲染多个类

[SimpLess](http://wearekiss.com/simpless) - 是我非常喜欢的一个不错的独立版本，除了我在编译更少的堆栈时不断收到错误 - 没有明确引用错误位置

[WinLess](http://winless.org/) - 设法完成我所有的编译需求，以及像这样成功编译多个类。此外 - 它的错误报告非常具体。让它成为赢家。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-04T00:15:27.740

Mixin 名称应该由一个类名组成，而不是多个。像这样创建一个mixin：

```
.icon() {
    display: inline-block;
    position: relative;
    text-indent: -9999em;

    &.icon-l.legend {
        width: 24px;
        height: 24px;
    }

    &.icon-white.legend {
        background: url(@icon_legend_white) no-repeat;
    }

    &.icon-l.arrow_left {
        background-position: -128px -32px;
    }
} 
```

然后以这种方式使用它：

```
#something {
    /* "Injecting" .icon mixin into #something */
    .icon;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-05T17:39:17.067

## 似乎是编译器问题

如果您采用您最初的想法：

```
.icon { display:inline-block; position:relative; text-indent:-9999em;}
.icon-l.legend { width:24px; height:24px;}
.icon-white.legend{ background:url(@icon_legend_white) no-repeat;}
.icon-l.arrow_left{background-position: -128px -32px;} 
```

和

```
#something{
  .icon;
  .icon-l.legend;
  .icon-white.legend;
  .icon-l.arrow_left;
} 
```

然后假设您为变量分配了一些东西`@icon_legend_white`，然后[**在线 winless 编译器**](http://winless.org/online-less-compiler)将其编译为以下内容（其中变量设置为“somepath”）：

```
#something {
  display: inline-block;
  position: relative;
  text-indent: -9999em;
  width: 24px;
  height: 24px;
  background: url("somepath") no-repeat;
  background-position: -128px -32px;
} 
```

因此，如果您的编译器抛出错误，那么它们的编译方式显然存在一些差异。然后，一种解决方案是切换编译器，或调试您正在使用的编译器。

**更新**

对 winless 编译器的一些进一步实验表明，它仅在项目由类或 id 定义时才有效（这是可以理解的，因为这对 mixins 有效），但它确实有一个错误，即它会混合两者之一或两者，`.icon-l.legend`并`.icon-l .legend`通过对任一者的简单混入调用。因此，如果将第二组（使其成为子选择器）称为 mixin，则将忽略第二组之间的“空格”。对于那个编译器来说，这肯定是错误的。[**另一个在线编译器**](http://leafo.net/lessphp/editor.html)似乎没有受到该错误的影响，但仍然根据您的原始尝试进行编译。

# ios - 在 XCode 4 中的方法中切换视图

> ID：13214756
> 
> 赞同：0
> 
> 时间：2012-11-04T00:03:58.940
> 
> 标签：ios, methods, switching

我正在使用 XCode 4.4 并使用情节提要制作应用程序。我想在一个视图的方法中切换到另一个视图。我想在方法内部实现与通过模态在情节提要上切换视图相同的功能。到目前为止，我正在使用以下代码：

```
-(IBAction)xplus:(id)sender
{
    x++;
     if(x>30)
    {
           ViewController_2 *viewControllerx = [[ViewController_2 alloc] init];
         [self presentViewController:viewControllerx animated:YES completion:nil];
     }

 } 
```

当视图应该改变时，即当 x 大于 30 时，会出现黑屏而不是所需的视图。我个人认为我的代码是正确的，但为什么它显示黑屏？

如何在方法内部实现与通过模式在情节提要上切换视图相同的功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T18:54:55.953

您的方法不起作用可能是因为您没有将`.xib`文件与要访问的视图控制器一起使用并使用情节提要。

无论如何，让我给你一个简单有效的方法来执行任务。

第 1 步：转到项目的情节提要并单击`View Controller`要在方法中进入的位置，即`ViewController_2.Click`检查器图标（这是第 4 个）。在标识符字段中输入名称，例如：`second`。

第 2 步：在您的方法中使用以下行来创建`ViewController_2`使用该`initiateViewControllerWithIdentifier`方法的实例并对其进行模态化。

```
ViewController_2 *v2=[self.storyboard initiateViewControllerWithIdentifier:@"second"]; [self presentModalViewController:v2.animated:YES]; 
```

现在应用程序将转到（创建实例）`ViewController`具有与作为参数给出的标识符相同的标识符，即`second`。

# c# - 如何找到包含等待/异步代码的间歇性单元测试失败的原因？

> ID：13214757
> 
> 赞同：3
> 
> 时间：2012-11-04T00:04:19.020
> 
> 标签：c#, .net, windows-8, windows-runtime, async-await

我在使用 WinRT C# 构建的 Windows Store 应用程序中使用[xUnit](http://xunit.codeplex.com/)进行单元测试。被测代码调用了等待的异步方法，问题是有些有时会失败，有时会成功。我的猜测是，等待的代码的一些延续是在与捕获的不同的同步上下文中执行的，然后`Task`调用链中的某个地方没有等待。但是我找不到任何这样的地方。如何找到错误的原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T14:46:32.310

确保您的单元测试`async Task`不是`async void`. [xUnit 尚不支持](http://xunit.codeplex.com/workitem/9752)`async void`单元测试。

`async void`如果您在单元测试中遇到异常，[则存在竞争条件，它可能会错误地成功](http://nitoprograms.blogspot.com/2012/02/async-unit-tests-part-1-wrong-way.html)（链接到我的博客文章，其中包含更多详细信息；它讨论了 MSTest，但 xUnit 也存在相同的情况）。

# r - 在 R 中随机选择组（以及每组的所有案例）？

> ID：13214769
> 
> 赞同：2
> 
> 时间：2012-11-04T00:05:48.747
> 
> 标签：r, sample

我有一个包含两个数据级别的 R 数据框：`id`和`year`. 在由 定义的组内`id`，年数增加（整个数据集每组的年数相同，如下所示：

```
id    year    var1    var2
11A   2001    ...     ...
11A   2002    ...     ...
11A   2003    ...     ...
11A   2004    ...     ...
13B   2001    ...     ...
13B   2002    ...     ...
13B   2003    ...     ...
13B   2004    ...     ...
22Z   2001    ...     ... 
```

我的数据中有大约 20.000 个组，当然太多了，无法绘制出漂亮的增长曲线图。如何随机选择大约 20 个我的 id？（所以：还选择与该 ID 对应的所有 4 行年份？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T00:29:16.577

`sample`如果您使用然后索引，这非常简单。这是一个虚构的示例，看起来与您提供的内容相似。它实际上只有两行代码，如果您愿意，可以在一行中完成。

```
dat <- data.frame(id=paste0(LETTERS[1:8], rep(1:1250, 8)), 
   year=as.factor(as.character(sample(c(1990:2012, 20000, T)))), 
   var1=rnorm(20000), var2=rnorm(20000))

#a look at the data
head(dat)

#sample 20 id's randomly
(ids <- sample(unique(dat$id), 20))

#narrow your data set
dat2 <- dat[dat$id %in% ids, ] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T00:30:45.190

```
subset(df, id %in% sample(levels(df$id), 20)) 
```

这是假设您的数据框被调用`df`并且您`id`是一个因素（如果不是，则使用`unique`而`levels`不是）

# powershell - 如何更改 Powershell 模块的安装位置？

> ID：13214775
> 
> 赞同：5
> 
> 时间：2012-11-04T00:06:14.387
> 
> 标签：powershell

我使用的是 3.0 版，似乎没有办法指定安装所有模块的默认文件夹。特别是，我正在尝试安装 Posh-Git，但它坚持将模块安装在 MyDocuments\WindowsPowershell 中。我该如何改变？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-04T06:41:01.743

默认情况下，PowerShell 在两个位置之一中查找模块，这两个位置都在 PSModulePath 环境变量中指定。

```
 System modules: %windir%\System32\WindowsPowerShell\v1.0\Modules
   Current user modules:  %UserProfile%\Documents\WindowsPowerShell\Modules 
```

您可以将自己的模块目录添加到路径中：

```
$env:PSModulePath+=';c:\MyModules' 
```

# c - 段错误仅出现在 GDB 中

> ID：13214779
> 
> 赞同：5
> 
> 时间：2012-11-04T00:06:44.880
> 
> 标签：c, linux, assembly, x86, segmentation-fault

为什么下面的程序在执行时不会崩溃，而是在 GDB 中出现段错误而崩溃？使用 GCC 4.5.2 在 32 位 x86（Athlon 64，如果需要的话）上编译。

```
#include <stdio.h>
#include <string.h>

int modify(void)
{
        __asm__("mov $0x41414141, %edx"); // Stray value.
        __asm__("mov $0xbffff2d4, %eax"); // Addr. of ret pointer for function().
        __asm__("mov %edx, (%eax)");
}

int function(void)
{
        modify();

        return 0;
}

int main(int argc, char **argv)
{
        function();

        return 0;
} 
```

mov $0xbffff2d4, %eax 是使用 GDB 确定的，以查找存储“函数”函数的返回指针的地址。这在不同的系统上可能会有所不同。为此禁用了 ASLR。

当我执行程序时，什么也没有发生。也没有关于 dmesg 崩溃的报告。但是，当我在 GDB 中执行相同的程序时：

```
Program received signal SIGSEGV, Segmentation fault.
0x41414141 in ?? ()
=> 0x41414141:  Cannot access memory at address 0x41414141 
```

这也是我正常执行程序时所期望的。当其他程序崩溃时，我确实会像往常一样遇到段错误，而且我可以轻松编写一个小程序，该程序会因段错误而崩溃。但是为什么这个特定的程序不会因段错误而崩溃？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T01:24:36.600

即使禁用了完整的 ASLR，您仍然可能会获得随机堆栈和堆。`norandmaps`您可以使用内核引导参数全局关闭它，也可以在运行时通过设置`/proc/sys/kernel/randomize_va_space`为零来关闭它。这也是过程个性的一部分。

在 GDB 中，您可以使用以下`disable-randomization`设置进行调整：

```
(gdb) help set disable-randomization
Set disabling of debuggee's virtual address space randomization.
When this mode is on (which is the default), randomization of the virtual
address space is disabled.  Standalone programs run with the randomization
enabled by default on some platforms. 
```

作为一个小测试程序来说明这一点，可以打印一个局部变量的地址，例如：

```
#include <stdio.h>

int main(int argc, char **argv)
{
    printf("%p\n", &argc);
    return 0;
} 
```

# android - 需要获取没有 GPS 的城市名称的解决方案吗？

> ID：13214780
> 
> 赞同：1
> 
> 时间：2012-11-04T00:07:39.233
> 
> 标签：android

似乎他们对该领域的方法进行了一些更新，因为许多现有示例无法正常工作......

有人可以告诉我如何从没有 gps 的网络中获取城市名称并烤到屏幕上吗？

将不胜感激。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T00:14:48.637

您可以通过获取用户的 IP 地址并使用免费的 GeoLocation API 服务来做到这一点，例如：http: [//freegeoip.net/static/index.html](http://freegeoip.net/static/index.html)

这些服务大部分时间都在 Wifi 上运行，但并不完全可靠。在某些情况下，例如如果用户使用代理，这些服务会给出错误（或不准确）的位置。

在 3G 上，这些服务可能非常不准确。这可能是因为分配给电话的 IP 地址植根于网络提供商的中心网络位置。在使用 3G 时，请不要对城市做出假设，国家可能是您可以合理获得的最佳选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T00:43:11.283

使用 获取经纬度`NETWORK_PROVIDER`，不使用 GPS。这是`Locator`我为我的目的编写的一个实用程序类，欢迎您使用并对其进行修改。它在`minSdk`7 个应用程序中工作和测试。

```
package com.emil;

import android.content.Context;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;

/**
 * For determining location of user using various methods
 * 
 * @author Emil http://stackoverflow.com/users/220710/emil
 *
 */
public class Locator implements LocationListener {

    static private final int TIME_INTERVAL = 100; // minimum time betweeen updates in milliseconds
    static private final int DISTANCE_INTERVAL = 1; // minimum distance between updates in meters

    static public enum Method {
        NETWORK,
        GPS,
        NETWORK_THEN_GPS
    }

    private Context context;
    private LocationManager locationManager;
    private Locator.Method method;
    private Locator.Listener callback;

    public Locator(Context context) {
        super();
        this.context = context;
        this.locationManager = (LocationManager) context.getSystemService(Context.LOCATION_SERVICE);
    }

    public void getLocation(Locator.Method method, Locator.Listener callback){
        this.method = method;
        this.callback = callback;
        switch(this.method){
        case NETWORK:
        case NETWORK_THEN_GPS:
            Location networkLocation = this.locationManager.getLastKnownLocation(LocationManager.NETWORK_PROVIDER);
            if(networkLocation != null){
                this.callback.onLocationFound(networkLocation);
            }else{
                System.out.println("REQUEST UPDATES to NETWORK PROVIDER");
                this.requestUpdates(LocationManager.NETWORK_PROVIDER);
            }
            break;
        case GPS:
            Location gpsLocation = this.locationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);
            if(gpsLocation != null){
                this.callback.onLocationFound(gpsLocation);
            }else{
                System.out.println("REQUEST UPDATES to GPS PROVIDER");
                this.requestUpdates(LocationManager.GPS_PROVIDER);
            }
            break;
        }
    }

    private void requestUpdates(String provider){
        if(this.locationManager.isProviderEnabled(provider)){
            if(provider.contentEquals(LocationManager.NETWORK_PROVIDER) 
                    && Connectivity.isConnected(this.context)){
                System.out.println("NETWORK CONNECTED, START LISTENING: "+provider);
                this.locationManager.requestLocationUpdates(provider, TIME_INTERVAL, DISTANCE_INTERVAL, this);
            }else if(provider.contentEquals(LocationManager.GPS_PROVIDER) 
                    && Connectivity.isConnectedMobile(this.context)){
                System.out.println("MOBILE NETWORK CONNECTED, START LISTENING: "+provider);
                this.locationManager.requestLocationUpdates(provider, TIME_INTERVAL, DISTANCE_INTERVAL, this);
            }else{
                System.out.println("PROPER NETWORK NOT CONNECTED : "+provider);
                this.onProviderDisabled(provider);
            }
        }else{
            this.onProviderDisabled(provider);
        }
    }

    public void cancel(){
        this.locationManager.removeUpdates(this);
    }

    @Override
    public void onLocationChanged(Location location) {
        System.out.println("LOCATION FOUND : "+location.getLatitude()+", "+location.getLongitude()+(location.hasAccuracy() ? " : +- "+location.getAccuracy()+" meters" : ""));
        this.locationManager.removeUpdates(this);
        this.callback.onLocationFound(location);
    }
    @Override
    public void onProviderDisabled(String provider) {
        System.out.println("PROVIDER DISABLED : "+provider);
        if( this.method == Locator.Method.NETWORK_THEN_GPS 
                && provider.contentEquals(LocationManager.NETWORK_PROVIDER) ){
            // Network provider disabled, try GPS
            System.out.println("REQUEST UPDATES to GSP PROVIDER, NETWORK PROVIDER DISABLED");
            this.requestUpdates(LocationManager.GPS_PROVIDER);
        }else{
            this.locationManager.removeUpdates(this);
            this.callback.onLocationNotFound();
        }
    }
    @Override
    public void onProviderEnabled(String provider) {
        // empty
        System.out.println("PROVIDER ENABLED : "+provider);
    }
    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
        // empty
        System.out.println("PROVIDER STATUS CHANGED : "+provider+" : STATUS : "+status);

    }

    public interface Listener {
        void onLocationFound(Location location);
        void onLocationNotFound();
    }

} 
```

确保在您的使用位置提供程序中添加[适当的权限。](http://developer.android.com/training/basics/location/locationmanager.html#TaskDeclarePermissions)`AndroidManifest.xml`

然后使用来自[谷歌地图](https://developers.google.com/places/documentation/details)或其他东西的 API 转换为城市名称。

# php - 使用位置标题重定向到页面？

> ID：13214781
> 
> 赞同：0
> 
> 时间：2012-11-04T00:07:47.777
> 
> 标签：php, redirect

当在用户个人资料页面上单击按钮时，我有一个在 php 文件中运行的函数。功能完成后，我希望将用户重定向回他们的个人资料页面。通常我知道如何重定向，但这需要包括用户 ID 才能转到他们的特定配置文件。我制作了以下代码，并附`err=1`在其末尾，希望尝试在他们的个人资料中显示一条消息。

希望这是有道理的。

```
<?php
    header('Location: http://localhost/ptb1/profile.php?id=echo $_SESSION['user_id']err=1');
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T00:08:57.057

阅读有关[字符串连接](http://php.net/manual/language.operators.string.php)的信息：

```
<?php
session_start();
header('Location: http://localhost/ptb1/profile.php?id=' . $_SESSION['user_id'] . '&err=1'); 
```

您还需要[`session_start()`](http://php.net/session_start)在尝试使用`$_SESSION`变量之前调用。

# c++ - 在另一个函数中调用具有结构作为变量的函数

> ID：13214790
> 
> 赞同：-1
> 
> 时间：2012-11-04T00:10:01.773
> 
> 标签：c++, function, structure

好吧，我有一个结构和两个函数，在其中一个函数中，我使用这些结构来执行一些检查，我想在另一个函数中调用该函数，因此当在该函数中执行某些操作时，另一个可以进行检查. 假设目标球上升，在它再次移动之前执行检查。我知道你可以在另一个函数中调用函数，但是我不能像我用变量 int 调用其他函数那样调用它，我想是因为结构。如何在显示功能中调用该检查器功能？提前致谢！

```
 struct box{
    //code
    };

    void checker(box A, box B, box C, box D, box E, box Q){
    /*Creating struct of type boxes here and statements to cheack if any of the limits between    them   intersect each other*/
    }

    void display(){
    //Displaying the objects here that are inside the structure box to check collision
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:13:34.860

像这样？

```
void display()
{
    box A, B, C, D, E, Q;
    // ...
    checker(A, B, C, D, E, Q);
    // ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T00:14:43.103

你想知道如何传递参数吗？

你似乎是 C++ 的新手。您可能想阅读一些有关函数的信息。

[功能（一）关于Cplusplus](http://www.cplusplus.com/doc/tutorial/functions/)

[Cplusplus上的功能（二）](http://www.cplusplus.com/doc/tutorial/functions2/)

```
struct box{
//code
}; //forgot semicolon

void checker(box A, box B, box C, box D, box E, box Q){
//code
}

void display() //forgot parenthesis 
{
    box A, B, C, D, E, Q;

    //initialize and use variables.

    //call function...
    checker(A, B, C, D, E, Q);
} 
```

很难说出你到底在问什么。

**一个主意。**

也许你想要这样的东西（在这里大胆猜测。主要只是向你展示一个场景。）：

```
class Box
{
//code
};

class GameState
{
    public:
        GameState(map<std::string, Box> _boxes);
        void display();
        void moveBox(std::string boxID, int x, int y);
    private:
        bool checkMove(std::string boxID, int x, int y);

        std::map<std::string, Box> boxes;
};

void mainLoop()
{
    map<string, Box> boxes;
    boxes["A"] = Box();
    boxes["B"] = Box();
    boxes["C"] = Box();
    boxes["D"] = Box();
    boxes["E"] = Box();
    boxes["Q"] = Box();

    bool quit = false;
    GameState game(boxes);

    while(true)
    {
        int action = game.getAction();

        switch(action)
        {
            case DISPLAY_ACTION:
                game.display();
                break;
            case MOVE_ACTION:
                string boxId;
                int x, y; 
                //get those somehow...

                game.moveBox(boxId, x, y);
                break;
            case QUIT;
                quit = true;
                break;
        }
        if (quit)
            break;
    }
}

int GameState::getAction(box& aBox)
{
    //return some action code
}

bool GameState::checkMove(string boxId, int x, y)
{
    //check box
}

void GameState::display()
{

}

void GameState::moveBox(string boxId, int x, int y)
{
    if (checkMove(boxId, x, y))
    {
        //more code
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T00:16:56.627

首先，显示函数的原型缺少参数：

```
void display(/* parameters here if needed */) {
//I want to call the void checker here
} 
```

关于您的问题，调用函数是一件小事。例如，使用不带任何参数的显示函数：

```
void display() {
    // have some boxes defined here
    Box ba,bb,bc,bd,be,bq;
    // here we have some code related to the boxes
    // (...)
    // (...)
    // and now we call the function checker
    checker(ba,bb,bc,cd,be,bq);
} 
```

但是，您似乎还想在 中创建框的内容`checker`，然后在 中显示它们`display`。为此，您需要*通过引用*传递Box 对象`checker`，以便在退出函数时保留该函数所做的任何修改。

因此，您需要将 checker 的原型更改为：

```
void checker(box &A, box &B, box &C, box &D, box &E, box &Q){
   /* your function body here */
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T01:05:44.940

您需要进一步澄清您的问题。但从上下文来看，这表明您正在尝试执行以下操作：

1.  您有一个包含一组对象的游戏。
2.  每个对象都由 this 结构体表示：

    ```
    struct box { }; 
    ```

3.  您有一个显示功能，可以显示游戏的状态（布局）。

4.  您想在显示之前检查是否存在碰撞。

如果以上是您要实现的目标，则以下代码可能会完成这项工作：

```
class Game {
public:
  Game() {} // Initialize your box objects here
  ~Game() {}

  void display() {
    // Your code
    checker(a_, b_); // Check here
    // Display code
  }

private:
  struct Box {
    // box state data
  };

  Box a_;
  Box b_;
  // ... etc.

  void checker(const Box& a, const Box& b) const {
    // Do your check here
    // I used const here assuming your checker has no side effects 
  }

}; 
```

# jquery - jQueryMobile 默认字体是什么？

> ID：13214793
> 
> 赞同：0
> 
> 时间：2012-11-04T00:10:29.577
> 
> 标签：jquery, fonts

没有什么比标题已经说过的了。谁能告诉我 jQueryMobile 的默认字体是什么？我似乎无法在 CSS 或 Google 的任何地方找到它...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T02:24:32.390

它默认为这个......

```
font-family: Helvetica, Arial, sans-serif /*{global-font-family}*/; 
```

您还可以使用主题滚轮将其设置为您想要的任何内容。

[http://jquerymobile.com/themeroller/](http://jquerymobile.com/themeroller/)

# latex - 自 Xetex 弃用以来使用 Pandoc 将 Markdown 转换为 PDF

> ID：13214797
> 
> 赞同：8
> 
> 时间：2012-11-04T00:11:05.893
> 
> 标签：latex, markdown, pandoc, xetex

在我的 MacBook（OSX Mountain Lion）上，我曾经使用这个 Pandoc 命令将 Markdown 转换为 PDF：

```
$ markdown2pdf -N -o pandoc_output.pdf  --xetex --toc --template=mytemplate.tex myfile.md 
```

但`markdown2pdf`不再有效，并且`--xetex`选项 in`markdown2pdf -N -o ../../Desktop/pandoc_output.pdf --xetex --toc --template=mytemplate-headers-garamond_date.tex`已弃用。

如果我这样做：

```
$ pandoc -N -o Desktop/pandoc_output.pdf  --xetex --toc --template=mytemplate.tex myfile.md 
```

我明白了：

```
pandoc: unrecognized option `--xetex' 
```

但如果我拿出来`--xetex`这样做：

```
$ pandoc -N -o Desktop/pandoc_output.pdf  --toc --template=mytemplate.tex myfile.md 
```

然后我得到这个：

```
pandoc: Error producing PDF from TeX source.
! Package hyperref Error: Wrong driver option `xetex',
(hyperref)                because XeTeX is not detected.

See the hyperref package documentation for explanation.
Type  H <return>  for immediate help.
 ...                                              

l.3925 \ProcessKeyvalOptions{Hyp} 
```

解决方案是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-29T09:16:26.317

尝试`--latex-engine=xelatex`代替`--xetex`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-05-29T01:00:24.357

这个问题的先前答案对我有帮助，因为几年前我安装了 pandoc，但从未安装过 Tex Live。因此我不知道我是否正确安装了它，所以放入整个路径有助于我看到它正在工作，如下所示：

`pandoc --latex-engine=/usr/local/texlive/2012basic/bin/universal-darwin/xelatex`

这是您从 Pandoc 安装页面下载的 BasicTex 设置的默认安装位置。

我也忘记了使用`pandoc -D Latex >my-latex-template.tex`来生成模板。在给出 .tex 模板而不是我的 .html 模板（导致“您没有 BEGIN {”错误）之后，我得到了 .PDF：换句话说，默认模板有效。

另外，我错误地输入`-t pdf`（上面未显示）将 pdf 设置为输出格式，但这是不正确的。输出格式为 Latex，然后被翻译成 PDF。不必使用破折号 -t 选项指定输出格式。

我希望我的小失误记录可以节省一些时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T18:24:19.180

有关该选项，请参阅[pandoc 用户指南](http://johnmacfarlane.net/pandoc/README.html#options-affecting-specific-writers)（或手册页）`--latex-engine`。

# python - 列表有 str.join() 吗？

> ID：13214798
> 
> 赞同：4
> 
> 时间：2012-11-04T00:11:09.170
> 
> 标签：python, list

我明白`str.join()`：

```
>>> '|'.join(['1','2','3'])
'1|2|3' 
```

有没有输出列表的东西？是否有一个函数会输出：

```
['1', '|', '2','|', '3'] 
```

也就是说，一个`str.join()`for 列表？（或任何其他可迭代的？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T00:13:10.213

```
list('|'.join(['1','2','3'])) 
```

应该在您使用字符列表的地方解决问题。

适用于所有对象的更通用的解决方案是：

```
from itertools import izip_longest, chain

def intersperse(myiter, value):
    return list(
        chain.from_iterable(izip_longest(myiter, [], fillvalue=value))
    )[:-1] 
```

我不知道这个函数的内置/标准库版本。

在行动：

```
print intersperse([1,2,3], '|') 
```

输出：

```
[1, '|', 2, '|', 3] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T00:13:12.630

这个怎么样？

```
>>> list('|'.join(['1','2','3']))
['1', '|', '2', '|', '3'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T00:58:10.370

```
a = [1, 2, 'str', 'foo']
print [x for y in a for x in y, '|'][:-1]
# [1, '|', 2, '|', 'str', '|', 'foo'] 
```

对于一般情况，请考虑`roundrobin` [itertools 配方](http://docs.python.org/2/library/itertools.html#recipes)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T10:46:59.777

这个简单的生成器避免了构建列表（更快，节省内存）：

```
def intersperse(iterable, element):
    iterable = iter(iterable)
    yield next(iterable)
    while True:
        next_from_iterable = next(iterable)
        yield element
        yield next_from_iterable 
```

例子：

```
>>> list(intersperse(['1', '2', '3'], '|'))
['1', '|', '2', '|', '3'] 
```

# javascript - 没有 jquery 的 Ajax parsexml

> ID：13214801
> 
> 赞同：1
> 
> 时间：2012-11-04T00:11:22.163
> 
> 标签：javascript, ajax, jquery, gmail

我有一段代码可以获取 Gmail 的未读计数。它使用 jQuery，我想知道如何在没有 Javascript 库的情况下使用 Javascript。

```
$.ajax({
  type: "GET",
  url: "https://mail.google.com/mail/feed/atom",
  dataType: "xml",
  success: parseXml
});

function parseXml(xml)
{
  var result = $(xml).find("fullcount").text();
  alert("count:" + result);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T03:38:34.320

试试这个

```
var  xmlhttp=new XMLHttpRequest();

xmlhttp.setRequestHeader("Access-Control-Allow-Origin","https://mail.google.com");
xmlhttp.open("POST","https://mail.google.com/mail/feed/atom",false,"username","pwd");
xmlhttp.send();
xmlDoc=xmlhttp.responseXML;
var mailCount=xmlDoc.getElementsByTagName("entry").length; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T20:30:57.073

好的，解决了

```
xhrGmail = new XMLHttpRequest();
xhrGmail.open('GET','https://mail.google.com/mail/feed/atom')
xhrGmail.onload = function() { console.log(xhrGmail.responseText.split("<fullcount>")   [1].split("</fullcount>")[0]) }
xhrGmail.send(null); 
```

# java - Android - 生成随机数时崩溃

> ID：13214803
> 
> 赞同：4
> 
> 时间：2012-11-04T00:11:36.067
> 
> 标签：java, android, random, runtime-error

因此，我在其他地方查看了如何生成随机数，并将其放入 Android 应用程序中。我希望这可以工作，但遗憾的是，它与这个 LogCat 崩溃：

```
11-03 17:06:48.930: W/dalvikvm(8327): threadid=1: thread exiting with uncaught exception (group=0x41ff0300)
11-03 17:06:48.938: E/AndroidRuntime(8327): FATAL EXCEPTION: main
11-03 17:06:48.938: E/AndroidRuntime(8327): java.lang.IllegalArgumentException
11-03 17:06:48.938: E/AndroidRuntime(8327):     at java.util.Random.nextInt(Random.java:187)
11-03 17:06:48.938: E/AndroidRuntime(8327):     at com.spng453.randomnum.RandomNumber$1.onClick(RandomNumber.java:24)
11-03 17:06:48.938: E/AndroidRuntime(8327):     at android.view.View.performClick(View.java:4084)
11-03 17:06:48.938: E/AndroidRuntime(8327):     at android.view.View$PerformClick.run(View.java:16966)
11-03 17:06:48.938: E/AndroidRuntime(8327):     at android.os.Handler.handleCallback(Handler.java:615)
11-03 17:06:48.938: E/AndroidRuntime(8327):     at android.os.Handler.dispatchMessage(Handler.java:92)
11-03 17:06:48.938: E/AndroidRuntime(8327):     at android.os.Looper.loop(Looper.java:137)
11-03 17:06:48.938: E/AndroidRuntime(8327):     at android.app.ActivityThread.main(ActivityThread.java:4745)
11-03 17:06:48.938: E/AndroidRuntime(8327):     at java.lang.reflect.Method.invokeNative(Native Method)
11-03 17:06:48.938: E/AndroidRuntime(8327):     at java.lang.reflect.Method.invoke(Method.java:511)
11-03 17:06:48.938: E/AndroidRuntime(8327):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
11-03 17:06:48.938: E/AndroidRuntime(8327):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
11-03 17:06:48.938: E/AndroidRuntime(8327):     at dalvik.system.NativeStart.main(Native Method)
11-03 17:06:51.376: I/Process(8327): Sending signal. PID: 8327 SIG: 9 
```

我已经尝试了我能想到的一切来让它工作，但没有任何效果。这是代码：

```
private OnClickListener Gen = new OnClickListener() {
    public void onClick(View v) {
        Random rand;
        rand = new Random();
        EditText maxin = (EditText)findViewById(R.id.max);
        EditText minin = (EditText)findViewById(R.id.min);
        TextView out = (TextView)findViewById(R.id.out);
        int max = Integer.parseInt(maxin.getText().toString().trim());
        int min = Integer.parseInt(minin.getText().toString().trim());
        out.setText(Integer.toString(rand.nextInt(max-min) + min));
    }
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T00:13:22.910

`max`好吧，如果您的文本框的数字小于或等于您的文本框，那肯定会发生`min`。您应该在调用之前验证这一点[`Random.nextInt(int)`](http://docs.oracle.com/javase/7/docs/api/java/util/Random.html#nextInt%28int%29)。正如文档所述：

> **抛出：**
> IllegalArgumentException - 如果 n 不是正数

当然，您*还*应该处理文本框根本没有有效数字的情况。

最后，您有什么理由*将*的声明和分配分开`rand`？

```
Random rand;
rand = new Random(); 
```

为什么不只是：

```
Random rand = new Random(); 
```

?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T00:14:35.560

`java.lang.IllegalArgumentException`表示您正在将非法参数传递给您的`nextInt()`函数。我猜你的论点不是零，或者类似的东西。检查调试器中的这些值以确保您的参数有效。

# javascript - getElementsByClassName 在 Firefox 中不起作用

> ID：13214804
> 
> 赞同：2
> 
> 时间：2012-11-04T00:11:37.373
> 
> 标签：javascript

我为我制作的一个 5 星评级系统编写了这个脚本，当用户将鼠标悬停在它们上方时，它会使星星亮起，例如：如果用户将鼠标悬停在第三颗星上，那颗星会显示点亮的星星图像以及前两个。该脚本适用于除 FireFox 之外的所有较新的浏览器。我已经为此绞尽脑汁了一段时间，无法弄清楚为什么它不能在 Firefox 中工作。任何帮助表示赞赏。此外，我只对原始 Javascript 的响应感兴趣，而不是 JQuery 或任何其他框架。谢谢一堆。

```
function btnSwap(){
var myBtns = document.getElementsByClassName('btns');
for(i=0; i<myBtns.length; i++){
    var elem = document.getElementById(myBtns[i].id);
    elem.src = "images/"+"starNorm.png";
    elem.onmouseover = btnOver;
    elem.onmouseout = btnOut;
    function btnOver(){
        var lit = document.getElementById(this.id);
        if(lit.id == "rb1"){
        lit.src = "images/"+"starOver.png";
        }
        if(lit.id == "rb2"){
        lit.src = "images/"+"starOver.png";
        document.getElementById('rb1').src = "images/"+"starOver.png";
        }
        if(lit.id == "rb3"){
        lit.src = "images/"+"starOver.png";
        document.getElementById('rb1').src = "images/"+"starOver.png";
        document.getElementById('rb2').src = "images/"+"starOver.png";
        }
        if(lit.id == "rb4"){
        lit.src = "images/"+"starOver.png";
        document.getElementById('rb1').src = "images/"+"starOver.png";
        document.getElementById('rb2').src = "images/"+"starOver.png";
        document.getElementById('rb3').src = "images/"+"starOver.png";
        }
        if(lit.id == "rb5"){
        lit.src = "images/"+"starOver.png";
        document.getElementById('rb1').src = "images/"+"starOver.png";
        document.getElementById('rb2').src = "images/"+"starOver.png";
        document.getElementById('rb3').src = "images/"+"starOver.png";
        document.getElementById('rb4').src = "images/"+"starOver.png";
        }

}

function btnOut(){
        var lit = document.getElementById(this.id);
        if(lit.id == "rb1"){
        lit.src = "images/"+"starNorm.png";
        }
        if(lit.id == "rb2"){
        lit.src = "images/"+"starNorm.png";
        document.getElementById('rb1').src = "images/"+"starNorm.png";
        }
        if(lit.id == "rb3"){
        lit.src = "images/"+"starNorm.png";
        document.getElementById('rb1').src = "images/"+"starNorm.png";
        document.getElementById('rb2').src = "images/"+"starNorm.png";
        }
        if(lit.id == "rb4"){
        lit.src = "images/"+"starNorm.png";
        document.getElementById('rb1').src = "images/"+"starNorm.png";
        document.getElementById('rb2').src = "images/"+"starNorm.png";
        document.getElementById('rb3').src = "images/"+"starNorm.png";
        }
        if(lit.id == "rb5"){
        lit.src = "images/"+"starNorm.png";
        document.getElementById('rb1').src = "images/"+"starNorm.png";
        document.getElementById('rb2').src = "images/"+"starNorm.png";
        document.getElementById('rb3').src = "images/"+"starNorm.png";
        document.getElementById('rb4').src = "images/"+"starNorm.png";
        }

    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:20:04.047

不要将函数声明放在`for`循环中。

```
function btnSwap(){

    var myBtns = document.getElementsByClassName('btns');

    // begin loop
    for(i=0; i<myBtns.length; i++){
        var elem = document.getElementById(myBtns[i].id);
        elem.src = "images/"+"starNorm.png";
        elem.onmouseover = btnOver;
        elem.onmouseout = btnOut;
    }

    // outside the loop.. now function declarations.

    function btnOver(){
        var lit = document.getElementById(this.id);
        if(lit.id == "rb1"){
        lit.src = "images/"+"starOver.png";
        }
        if(lit.id == "rb2"){
        lit.src = "images/"+"starOver.png";
        document.getElementById('rb1').src = "images/"+"starOver.png";
        }
        if(lit.id == "rb3"){
        lit.src = "images/"+"starOver.png";
        document.getElementById('rb1').src = "images/"+"starOver.png";
        document.getElementById('rb2').src = "images/"+"starOver.png";
        }
        if(lit.id == "rb4"){
        lit.src = "images/"+"starOver.png";
        document.getElementById('rb1').src = "images/"+"starOver.png";
        document.getElementById('rb2').src = "images/"+"starOver.png";
        document.getElementById('rb3').src = "images/"+"starOver.png";
        }
        if(lit.id == "rb5"){
        lit.src = "images/"+"starOver.png";
        document.getElementById('rb1').src = "images/"+"starOver.png";
        document.getElementById('rb2').src = "images/"+"starOver.png";
        document.getElementById('rb3').src = "images/"+"starOver.png";
        document.getElementById('rb4').src = "images/"+"starOver.png";
        }

    }

    function btnOut(){
        var lit = document.getElementById(this.id);
        if(lit.id == "rb1"){
        lit.src = "images/"+"starNorm.png";
        }
        if(lit.id == "rb2"){
        lit.src = "images/"+"starNorm.png";
        document.getElementById('rb1').src = "images/"+"starNorm.png";
        }
        if(lit.id == "rb3"){
        lit.src = "images/"+"starNorm.png";
        document.getElementById('rb1').src = "images/"+"starNorm.png";
        document.getElementById('rb2').src = "images/"+"starNorm.png";
        }
        if(lit.id == "rb4"){
        lit.src = "images/"+"starNorm.png";
        document.getElementById('rb1').src = "images/"+"starNorm.png";
        document.getElementById('rb2').src = "images/"+"starNorm.png";
        document.getElementById('rb3').src = "images/"+"starNorm.png";
        }
        if(lit.id == "rb5"){
        lit.src = "images/"+"starNorm.png";
        document.getElementById('rb1').src = "images/"+"starNorm.png";
        document.getElementById('rb2').src = "images/"+"starNorm.png";
        document.getElementById('rb3').src = "images/"+"starNorm.png";
        document.getElementById('rb4').src = "images/"+"starNorm.png";
        }

    }
} 
```

* * *

## 解释

Firefox 尊重包装函数声明的条件代码块。例如：

```
if (true) {
    function a() { return 1; }
} else {
    function a() { return 2; }
}
a(); // => Chrome: 2, Firefox: 1 
```

由于`for`代码块可能*不会*被执行，Firefox 会尝试尊重`for`循环的条件特性。`while (false)`您可以在循环中更直接地看到这一点。

```
while(false) {
    function a() { return 'a'; }
}
a(); // => Chrome: 'a', Firefox: Throws an error. 
```

在 Firefox 中，`a`永远不会定义，因为条件永远不会成功。

但是，如果有一个无论条件如何都将始终执行的代码块，则函数定义*将*被提升。我们可以在`do...while`循环中看到这一点。

```
var x = a;
do {
    function a() { return 'a'; }
} while(false);
x(); // => Both browsers: 'a' 
```

在这里提升没有问题，因为`do...while`始终保证执行代码块。

* * *

另外，你做这样的事情是有原因的吗？

```
var elem = document.getElementById(myBtns[i].id) 
```

如果您已经拥有它，则无需通过 id 获取元素。只需使用

```
var elem = myBtns[i]; 
```

# excel - 使用条件语句按日期（文本类型）自动过滤

> ID：13214806
> 
> 赞同：1
> 
> 时间：2012-11-04T00:11:49.203
> 
> 标签：excel, vba

我正在尝试过滤具有文本格式日期的列，例如“ *`07/12/2012`*”我需要使用条件语句自动过滤 column34：

如果每个单元格中的日期小于当前日期 +15，则选择该行。

运行以下代码后，我得到空结果，即未选择任何行。有人知道为什么吗？

```
With srcSheet
   srcEndRow = .Cells(.Rows.Count, 1).End(xlUp).Row
   .Range("A2" & ":BU" & srcEndRow).AutoFilter Field:=34, Criteria1:="<>NULL", Operator:=xlAnd, Criteria2:="<" & Format(Date, "0") 
End With 
```

# python - 如何检查一个单词是否适合指定数量的列？

> ID：13214807
> 
> 赞同：2
> 
> 时间：2012-11-04T00:12:26.113
> 
> 标签：python, string

所以我被要求编写一个代码，要求用户输入最大列数（行宽），然后让用户输入一个段落。现在，如果每行中的最后一个单词不适合该行，那么我必须将其移至下一行并用前一行中的空格替换它。我想知道如何检查一个单词是否适合该行，如果不适合我如何在下一行打印它。这是我的代码：

```
 max_num=int(input("Enter the maximum number of columns for printing: "))
    paragraph = input("Enter your paragraph:\n")
    paragraph = input()

    word_list = paragraph.split(" ")

    counter = 0
    while (counter < len(paragraph)):
        a = paragraph[counter:counter+max_num]
        counter+=max_num

        print('|'+str(a)+'|') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T00:23:48.793

如果这是一个练习，最酷的方法是使用动态解决方案来解决自动[换行问题](http://en.wikipedia.org/wiki/Word_wrap#Algorithm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T00:20:27.550

如果这不是一个练习，那么简单的方法就是[textwrap](http://docs.python.org/2/library/textwrap.html)。

# flash-builder - 如何更改标签的文本属性以显示我的“if”语句？

> ID：13214808
> 
> 赞同：0
> 
> 时间：2012-11-04T00:12:37.297
> 
> 标签：flash-builder

我需要在我的 SLabel text=" " 中放置什么来显示我的 if 语句定义的内容？到目前为止，这是我的代码：

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
           xmlns:s="library://ns.adobe.com/flex/spark" 
           xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600">
<fx:Declarations>
    <!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations>

<fx:Script>
    <![CDATA[
        import mx.events.SliderEvent;
        protected function ValueSlider_changeHandler(event:SliderEvent):void
    {
        ValueLabel.text = String(ValueSlider.value);
            if(String(ValueSlider.value) == "0")
            ValueLabel.text = "150";
            if(String(ValueSlider.value) == "1")
            ValueLabel.text = "333";
            if(String(ValueSlider.value) == "2")
            ValueLabel.text = "543";
            if(String(ValueSlider.value) == "3")
            ValueLabel.text = "9342";
    }
    ]]>
</fx:Script>
<s:Panel x="199" y="141" width="250" height="200">
    <s:HSlider id="ValueSlider" x="78" y="69" maximum="3" minimum="0" stepSize="1" value="1"/>
    <s:Label id="ValueLabel" x="109" y="38" text= "{ValueLabel.text}"/>
</s:Panel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T23:34:25.980

导入 mx.events.SliderEvent；

```
<s:HSlider id="ValueSlider" x="78" y="69" maximum="3" minimum="0" stepSize="1" value="1"/> 
```

**s:HSlider** spark 没有**SliderEvent**

**s:HSlider**应该绑定到 **mx:HSlider**。mx:HSlider 没有`stepSize`所以删除它。
为了使“ValueSlider_changeHandler(event)”生效，必须设置为：

```
change="ValueSlider_changeHandler(event)" 
```

完整的线路：

```
 <mx:HSlider id="ValueSlider" x="78" y="69" maximum="3" minimum="0" value="1" change="ValueSlider_changeHandler(event)"/> 
```

现在它应该看起来像：

```
 <fx:Script>
        <![CDATA[
            import mx.events.SliderEvent;
            private var slvalue:int = 0;
            protected function ValueSlider_changeHandler(event:SliderEvent):void
            {
                slvalue = ValueSlider.value;
                if(slvalue == 0)
                    ValueLabel.text = "150";
                if(slvalue == 1)
                    ValueLabel.text = "333";
                if(slvalue == 2)
                    ValueLabel.text = "543";
                if(slvalue == 3)
                    ValueLabel.text = "9342";
            }
        ]]>
    </fx:Script>
    <s:Panel x="199" y="141" width="250" height="200">
        <mx:HSlider id="ValueSlider" x="78" y="69" maximum="3" minimum="0" value="1" change="ValueSlider_changeHandler(event)"/>
        <s:Label id="ValueLabel" x="109" y="38" text= "{ValueLabel.text}"/>
    </s:Panel> 
```

你不能像这样测试它：

```
ValueLabel.text = String(ValueSlider.value);
            if(String(ValueSlider.value) == "0")
            ValueLabel.text = "150"; 
```

**ValueLabel.text = "150"**立即被下一个事件覆盖！！！

将其存储在局部变量中！以上：`slvalue`

# python - 漂亮的打印二维列表？

> ID：13214809
> 
> 赞同：83
> 
> 时间：2012-11-04T00:12:56.030
> 
> 标签：python, matrix

是否有一种简单的内置方法可以将 2D Python 列表打印为 2D 矩阵？

所以这：

```
[["A", "B"], ["C", "D"]] 
```

会变成类似的东西

```
A    B
C    D 
```

我找到了该`pprint`模块，但它似乎没有做我想要的。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-11-04T00:36:01.240

为了让事情变得有趣，让我们尝试一个更大的矩阵：

```
matrix = [
   ["Ah!",  "We do have some Camembert", "sir"],
   ["It's a bit", "runny", "sir"],
   ["Well,",  "as a matter of fact it's", "very runny, sir"],
   ["I think it's runnier",  "than you",  "like it, sir"]
]

s = [[str(e) for e in row] for row in matrix]
lens = [max(map(len, col)) for col in zip(*s)]
fmt = '\t'.join('{{:{}}}'.format(x) for x in lens)
table = [fmt.format(*row) for row in s]
print '\n'.join(table) 
```

输出：

```
Ah!                     We do have some Camembert   sir            
It's a bit              runny                       sir            
Well,                   as a matter of fact it's    very runny, sir
I think it's runnier    than you                    like it, sir 
```

UPD：对于多行单元格，这样的东西应该可以工作：

```
text = [
    ["Ah!",  "We do have\nsome Camembert", "sir"],
    ["It's a bit", "runny", "sir"],
    ["Well,",  "as a matter\nof fact it's", "very runny,\nsir"],
    ["I think it's\nrunnier",  "than you",  "like it,\nsir"]
]

from itertools import chain, izip_longest

matrix = chain.from_iterable(
    izip_longest(
        *(x.splitlines() for x in y), 
        fillvalue='') 
    for y in text) 
```

然后应用上面的代码。

另见[http://pypi.python.org/pypi/texttable](http://pypi.python.org/pypi/texttable)

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2015-08-22T18:36:11.693

如果您可以使用 Pandas（Python 数据分析库），您可以通过将其转换为 DataFrame 对象来漂亮地打印 2D 矩阵：

```
from pandas import *
x = [["A", "B"], ["C", "D"]]
print DataFrame(x)

   0  1
0  A  B
1  C  D 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2018-05-09T16:06:03.893

对于没有任何第三方库的 Python 3：

```
matrix = [["A", "B"], ["C", "D"]]

print('\n'.join(['\t'.join([str(cell) for cell in row]) for row in matrix])) 
```

输出

```
A   B
C   D 
```

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2016-04-11T01:48:14.423

你总是可以使用**[numpy](https://www.numpy.org/)**：

```
import numpy as np
A = [['A', 'B'], ['C', 'D']]
print(np.matrix(A)) 
```

**输出：**

```
[['A' 'B']
 ['C' 'D']] 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2019-12-01T08:48:07.977

只是为了提供一个更简单的替代方案[`print('\n'.join(\['\t'.join(\[str(cell) for cell in row\]) for row in matrix\]))`](https://stackoverflow.com/a/50257693/7129538)：

```
matrix = [["A", "B"], ["C", "D"]]
for row in matrix:
    print(*row) 
```

**解释** `*row`unpacks `row`，因此`print("A", "B")`称为 when `row`is `["A", "B"]`，例如。

**注意** 只有当每列具有相同的宽度时，两个答案才会被很好地格式化。要更改分隔符，请使用`sep`关键字。例如，

```
for row in matrix:
    print(*row, sep=', ') 
```

将打印

```
A, B
C, D 
```

反而。

**没有 for 循环的单线**

```
print(*(' '.join(row) for row in matrix), sep='\n') 
```

`' '.join(row) for row in matrix)`为每一行返回一个字符串，例如`A B`when `row`is `["A", "B"]`。

`*(' '.join(row) for row in matrix), sep='\n')`解包返回序列的生成器`'A B', 'C D'`，因此在给出`print('A B', 'C D', sep='\n')`的示例中调用它`matrix`。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-08-22T20:47:23.277

`pandas`比使用`prettytable`模块更轻量级的方法

```
from prettytable import PrettyTable

x = [["A", "B"], ["C", "D"]]

p = PrettyTable()
for row in x:
    p.add_row(row)

print p.get_string(header=False, border=False) 
```

产量：

```
A B
C D 
```

`prettytable`有很多选项可以以不同的方式格式化您的输出。

有关更多信息，请参阅[https://code.google.com/p/prettytable/](https://code.google.com/p/prettytable/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-09-10T17:02:54.397

如果您使用的是 Notebook/IPython 环境，那么 sympy 可以使用 IPython.display 打印令人愉悦的矩阵：

```
import numpy as np
from sympy import Matrix, init_printing
init_printing()

print(np.random.random((3,3)))
display(np.random.random((3,3)))
display(Matrix(np.random.random((3,3)))) 
```

[![在此处输入图像描述](../Images/f68c37184e5b06a58d1433b1a8fec8ac.png)](https://i.stack.imgur.com/MG55x.png)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-12-10T22:04:58.040

我还推荐[tabulate](https://pypi.org/project/tabulate/)，它也可以选择打印标题：

```
from tabulate import tabulate

lst = [['London', 20],['Paris', 30]]
print(tabulate(lst, headers=['City', 'Temperature'])) 
```

：

```
City      Temperature
------  -------------
London             20
Paris              30 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-12-23T06:57:50.913

You can update `print`'s `end=' '` so that it prints space instead of '\n' in the inner loop and outer loop can have `print()`.

```
a=[["a","b"],["c","d"]]
for i in a:
  for j in i:
    print(j, end=' ')
  print() 
```

I found this solution from [here](https://snakify.org/en/lessons/two_dimensional_lists_arrays/).

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2018-01-13T14:30:43.260

请参阅以下代码。

```
# Define an empty list (intended to be used as a matrix)
matrix = [] 
matrix.append([1, 2, 3, 4])
matrix.append([4, 6, 7, 8])
print matrix
# Now just print out the two rows separately
print matrix[0]
print matrix[1] 
```

# c# - ASP.Net - 链接按钮无法在 Chrome 和 Mozilla 上呈现正确的 html

> ID：13214815
> 
> 赞同：0
> 
> 时间：2012-11-04T00:13:18.390
> 
> 标签：c#, asp.net

我的页面上有链接按钮，可以在 IE 上正常工作，但不能在 Chrome 和 Mozilla 上工作。当我深入研究时，我发现它的渲染html是这样的

```
<div >
  <a  id="ContentPlaceHolder1_Register" 
      href="javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions
      (&quot;ctl00$ContentPlaceHolder1$Register&quot;, &quot; &quot;, true, 
      &quot;grpReg&quot;, &quot;&quot;, false, true))" >Register</a>
</div> 
```

如果我们看到我们`&quot;`的方法内部有问题，那就是创建问题。所以请帮我解决这个问题

TIA

阿米特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T00:19:05.920

我已在所有浏览器中尝试过此代码，并且在替换   后工作正常；和 ”

也许这是一个编码问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T08:03:15.803

谢谢它解决了。实际上由于错误，它的视图状态被设置为 false。

# php - 在 ubuntu 软件中心分发 php 应用程序

> ID：13214818
> 
> 赞同：1
> 
> 时间：2012-11-04T00:13:33.663
> 
> 标签：php, mysql, ubuntu, software-distribution

我最近注意到世界需要一个基于 ubuntu 的 SME（不是餐厅）的 POS 系统。我找不到可用的。所以我决定为自己写一个。我希望与其他 linux/ubuntu 用户共享该软件。

那么有人知道我可以分发php应用程序的方法吗？让我困惑的是：

1.  安装 LAMP 时不应打扰最终用户 [似乎已经不可能]
2.  使用安装程序创建雾化器应用程序，以便应用程序在直接窗口中打开，而不是在 firefox/其他浏览器中打开
3.  php 文件的权利/所有权决定。

我知道这是一个难题，但如果可以做到，我确实有技能和时间来创建一些急需的应用程序。

# php - PhpStorm IDE 颜色问题，区分单引号颜色和双引号颜色

> ID：13214821
> 
> 赞同：1
> 
> 时间：2012-11-04T00:14:03.817
> 
> 标签：php, ide, phpstorm

我需要知道如何让 PhpStorm 区分单引号字符串和双引号字符串的颜色。

就像假设我希望双引号字符串为绿色，单引号字符串为红色，如下所示：

```
$stringgreen = "This String is Green Color";

$stringred = 'This String is Red Color'; 
```

# jquery - 重新加载作者的 Flickr 请求

> ID：13214822
> 
> 赞同：1
> 
> 时间：2012-11-04T00:14:20.113
> 
> 标签：jquery, flickr

我对我的 flickr 画廊进行了编码，但我希望能够单击作者的姓名，页面将重新加载该作者的图像。

这是我当前的代码

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Outbrain Test Gallery</title>
<link href="styles.css" rel="stylesheet" type="text/css" />

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script src="jquery.masonry.min.js"></script>
 <script type="text/javascript">
$(window).load(function(){
  $('#flkr').masonry({
    // options
    itemSelector : '.tiles',
    isResizable: true,
  });
});
</script>
<script type="text/javascript">$(document).ready(function() {
  $('<ul />').prependTo('#flkr');
  $.getJSON('http://api.flickr.com/services/feeds/photos_public.gne?lang=en-us&format=json&jsoncallback=?', function(data) {
    $.each(data.items, function(i,item) {
      var squares = (item.media.m).replace('_m.jpg', '_q.jpg');
      if(i <= 20){
        $('<img/>').attr({
          alt: item.title, 
          src: squares, 
          height: '150', 
          width: '150'
        }).appendTo('#flkr ul').wrap('<li class="tiles"><a href="' + item.link + '"></a><p class="title">' + item.title + '</p><p class="author"><strong>By:</strong> ' + item.author + '</p><p class="date"><strong>Uploaded: </strong>' + item.published + '</p></li>');
      }
    });
  });
});
</script>
</head>

<body>
 <ul id="flkr"></ul>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T04:58:52.723

如果你现在拥有它的方式对你有用，那么本质是一样的，你只需要更改你的`$.getJSON`url 以匹配作者的那个..并将 URL`getJSON`传递给与传递任何其他变量相同大约。

您唯一需要想出的方法是获取您要展示的下一个画廊的作者 URL。我也希望您`$.empty()`在`ul`再次添加之前先填写。

现在至于您如何获得下一个人的 URL，这取决于您。我确定您将使用的 URL 有足够的相似性，您可以将其硬编码并使用 ID 号或成员名称，不确定 flickr 如何处理其 API 的 URL，但总的来说都是一样的。只需使用正确的 API，对于特定于公共成员的提要，其余的应该是相当直截了当的。总之，你正朝着正确的方向前进。

# ruby-on-rails - 使用 elasticsearch 进行索引映射时，将索引设置为 not_analyzed 有什么作用？

> ID：13214830
> 
> 赞同：4
> 
> 时间：2012-11-04T00:14:58.147
> 
> 标签：ruby-on-rails, elasticsearch, tire

如果`:index => :not_analyzed`我将其映射到字段或不将其添加到字段，该怎么办？我在 github 轮胎主页面或 elasticsearch.org 网站上找不到定义。

代码示例：

```
class Article < ActiveRecord::Base
      include Tire::Model::Search
      include Tire::Model::Callbacks

      #...

      mapping do
        indexes :id,           :index    => :not_analyzed
        indexes :title,        :analyzer => 'snowball', :boost => 100
      end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T08:13:44.970

未分析意味着该字段按原样存储并且未使用分析工具进行处理。如果你分析它，你可以选择你的分析仪。默认情况下，应用标准分析器。它将您的内容分解为标记，将它们小写，删除标点符号，删除英语停用词（as, is, are, ...）

我建议使用分析 API 来了解分析器之间的区别：[http ://www.elasticsearch.org/guide/reference/api/admin-indices-analyze.html](http://www.elasticsearch.org/guide/reference/api/admin-indices-analyze.html)

查看分析部分了解更多详细信息：[http ://www.elasticsearch.org/guide/reference/index-modules/analysis/](http://www.elasticsearch.org/guide/reference/index-modules/analysis/)

# django - Django pagination without the whole queryset

> ID：13214834
> 
> 赞同：1
> 
> 时间：2012-11-04T00:15:34.620
> 
> 标签：django, optimization

In Django, I use the paginator like the following:

from django.core.paginator import Paginator, EmptyPage, PageNotAnInteger

```
def myView(request):
    ...
    paginator = Paginator(Annonce.objects.filter(name="huhu"), 10)
    paginator._count = s.count()
    try:
        annonces = paginator.page(page)
    except PageNotAnInteger:
        annonces = paginator.page(1)
    except EmptyPage:
        annonces = paginator.page(paginator.num_pages) 
```

In the s.search() function I do a query on my postgres db.

It turns out that even if I display 10 items per page, the query is not limited.

I tried to limit the query with a `Annonce.objects.filter(name="huhu")[:10]` and specifying the count myself. But the paginator doesn't work if I do so.

Is there a way to optimize this?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-04T02:13:24.110

Use this example [https://docs.djangoproject.com/en/dev/topics/pagination/#using-paginator-in-a-view](https://docs.djangoproject.com/en/dev/topics/pagination/#using-paginator-in-a-view) as your guide to writing a view function which uses django Paginator appropriately.

Notice that in the example code snippert -

```
def listing(request):
    contact_list = Contacts.objects.all()
    paginator = Paginator(contact_list, 25) # Show 25 contacts per page

    page = request.GET.get('page')  # <--- This is the key to your solution. 
```

`contact_list` is an assigned queryset which has not actually been evaluated yet. The `paginator = Paginator(contact_list, 25)` assignment to a `Paginator instance` is lazy and doesn't really get executed until it has to.

`page = request.GET.get('page')` gets your extra GET variable `?page=2` (as an example) from your url. The url would actually look something like `http://localhost:8000/my/listing?page=2` when we attempt to retrieve the 25 objects that should appear on your listing page, page 2.

This is where the actual query to your database gets executed:-

```
try:
    contacts = paginator.page(page)
except PageNotAnInteger:
    # If page is not an integer, deliver first page.
    contacts = paginator.page(1) 
```

the `contacts = paginator.page(page)` executes a query to the database **retrieving only a limited set of objects based on the page number given to it** and on the condition that we want "25" objects per page.

# javascript - jQuery：在视口中运行一个函数

> ID：13214838
> 
> 赞同：0
> 
> 时间：2012-11-04T00:16:12.503
> 
> 标签：javascript, jquery

我试图在`div`进入视口时运行一个函数，我试图在谷歌上搜索它，但没有找到任何有效的 jQuery 视口检测器插件。

请帮助我使用 jQuery 检测视口

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T01:33:13.697

你想要完成的很像延迟加载图像（只是你想调用你自己的自定义函数）。

您可以尝试研究[lazyload jQuery 插件](http://www.appelsiini.net/projects/lazyload)或[Lazy-Load-Images-without-jQuery](https://github.com/ezYZ/Lazy-Load-Images-without-jQuery)并从那里继续。

# data-binding - 程序在使用可观察集合 WP7 导航时爆炸

> ID：13214841
> 
> 赞同：0
> 
> 时间：2012-11-04T00:16:39.730
> 
> 标签：data-binding, collections, observable

在缅因州，在我的按钮单击事件处理程序上，我执行以下操作：

```
 private void addIconButton_Click(object sender, EventArgs e)
    {
        if (test)
        {
            MessageBox.Show("enters addIcon Main");
            Note note = new Note();
            note.Modified = DateTimeOffset.Now;

            if (note != null)
            {
               Settings.NotesList.Add(note);  //this causes the issue. 

                //Settings.NotesList[0] = note;
            }
            Settings.CurrentNoteIndex = 0;
            test = false;

            MessageBox.Show("right before navigate");
            this.NavigationService.Navigate(new Uri("/DetailsPage.XAML", UriKind.Relative));
            MessageBox.Show("after navigate");

        }
        //DetailsPage mynewPage = new DetailsPage(); 
        //this.Content = mynewPage;

    } 
```

在我的导航到我做：

```
 protected override void OnNavigatedTo(System.Windows.Navigation.NavigationEventArgs e)
    {
        MessageBox.Show("enters onNav Main");
        DataContext = null;
        DataContext = Settings.NotesList;

        Settings.CurrentNoteIndex = -1;
        Listbox.SelectedIndex = -1;

        if (Settings.NotesList != null)
        {
            if (Settings.NotesList.Count == 0)
            {
                Notes.Text = "No Notes";
            }
            else
            {
                Notes.Text = "";
            }
        }
    } 
```

在我的前端代码中，我这样做：

```
 <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
        <ListBox x:Name="Listbox" SelectionChanged="listbox_SelectionChanged" ItemsSource="{Binding}">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Border Width="800" MinHeight="60">
                        <StackPanel>
                            <TextBlock x:Name="Title" VerticalAlignment="Center" FontSize="{Binding TextSize}"  Text="{Binding Name}"/>
                            <TextBlock x:Name="Date"  VerticalAlignment="Center" FontSize="{Binding TextSize}"  Text="{Binding Modified, 
                                    Mode=TwoWay, Converter={StaticResource dateConverter}}"/>
                        </StackPanel>
                    </Border>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid>
</Grid> 
```

我在静态类中有一个可观察的集合，在构造函数中我将其设置为：

```
public static class Settings
{
    public static ObservableCollection<Note> NotesList;
    static IsolatedStorageSettings settings;
    private static int currentNoteIndex;

    static Settings()
    {
        NotesList = new ObservableCollection<Note>();
        settings = IsolatedStorageSettings.ApplicationSettings;
        MessageBox.Show("enters constructor settings");
    } 
```

然后在 Notes 类中，它看起来像这样：

```
public class Note
{
    public DateTimeOffset Modified { get; set; }
    public string Title  { get; set; }
    public string Content { get; set; }
    public int TextSize { get; set; }

} 
```

当我单击应用程序按钮并在调用 navigationService 后立即调用 invent 处理程序时，我得到：

```
 // Code to execute on Unhandled Exceptions
    private void Application_UnhandledException(object sender, ApplicationUnhandledExceptionEventArgs e)
    {
        if (System.Diagnostics.Debugger.IsAttached)
        {
            // An unhandled exception has occurred; break into the debugger
            System.Diagnostics.Debugger.Break();
        }
    } 
```

这只发生在 Settings.NotesList.Add(note); 在 addIconButton_click 方法中添加..

有什么建议么？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T04:05:44.763

我通过在构造函数内的 Notes 类中为实例变量设置默认值来修复它......

# ruby - Is there an Equivalent to `Enumerable` for defining mathematical operations in Ruby?

> ID：13214846
> 
> 赞同：3
> 
> 时间：2012-11-04T00:18:47.607
> 
> 标签：ruby

I am creating a wrapper class for Ruby's NArray (numeric array). I would like my class to respond to all of the standard mathematical operators (+, +=, -, -=, *, *=, etc) in the same way that an instance of NArray does. I know how to make wrappers for `Array`s and other `Enumerable` objects, include `Enumerable` in the wrapper, and define an `each` method that just redirects to the wrapped `Enumerable` object. I would like something similar with the NArray. Is there a single module to include/method I can define that will define the whole bevy of mathematical operators to target the wrapped NArray? Or do I have to define them all manually?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T01:04:55.840

You could use `Forwardable`:

```
require 'forwardable'
class MyWrapper

  extend Forwardable
  def_delegators :@narray, :+, :*, # etc...

  def initialize(narray)
    @narray = narray
  end
end 
```

I'm not sure this will work with the `+=` et al methods (I don't know exactly how they are implemented, but I believe they are a feature of the parser and not actually methods you can reference).

Calling `+=` on an instance of MyWrapper would set the reference to the result of that operation, so you would need to figure out a way for that to return the same instance. That raises the question - is that what you want to do (return a wrapped NArray as the result of mathematical operations), or do you expect your NArray to handle the returns?

# c - TraceFs：ioctl：设备的 ioctl 不合适

> ID：13214847
> 
> 赞同：0
> 
> 时间：2012-11-04T00:19:03.347
> 
> 标签：c, linux-kernel

嗨，我收到此错误：ioctl: inappropriate ioctl for device on the ioctl() call 如下所示。

```
fd = open(mount, O_RDONLY);

destid = ioctl(fd, TRACEFS_IOCTL_ADD_OUTPUT_DRIVERS, data);

#define IOCBASE 10

#define TRACEFS_IOCTL_ADD_OUTPUT_DRIVERS    _IOW(0x15, IOCBASE + 0, int) 
```

我不确定如何调试此问题或解决错误。

任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T00:26:14.643

该 ioctl 仅适用于 TraceFS（特定文件系统）。我假设您需要将文件系统挂载为 TraceFS 来解决问题。

# ios - iOS中是否有任何用于识别语音相同声音的库

> ID：13214848
> 
> 赞同：5
> 
> 时间：2012-11-04T00:19:04.610
> 
> 标签：ios, search, phonetics

我正在尝试构建一个 iOS 应用程序。在其中一个屏幕中，用户可以在搜索栏中输入一些内容，而我必须对同一个单词的不同拼写采取相同的操作。

**例如：**用户可以输入*"elephant"*或*"alephant"*或*"elefant"*。我必须对所有这三个词采取相同的行动。

有没有将这些词识别为相似词的库？我不能使用拼写检查器，因为我也需要英语以外的其他语言。我做了一些研究，发现有一些语音算法，如 Text::soundex 可以在服务器端实现这一点。想知道是否有适用于 iOS 的库？

提前致谢 ！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T00:46:21.147

例如，没有可用的 soundex `NSString`，但如果这是您想要的，那么它很容易实现。这是来自 CocoaDev 的一个——尽管格式很糟糕——<a href="http://cocoadev.com/wiki/NSStringSoundex" rel="nofollow">soundex NSString 类别。

您还可以使用 Levenstein 距离算法来捕捉简单的拼写错误。也很容易实现（详细信息请阅读[Wikipedia 文章](http://en.wikipedia.org/wiki/Levenshtein_distance)），但[这里有一个 NSString 类别](https://gist.github.com/1515464)。

在使用这些算法之前，请对输入进行规范化。Core Foundation 中有一个很棒的`CFStringTransform`类（参见NSHipster 上关于它的[这篇很棒的文章——尤其是关于规范化的最后一部分），它可以自动将不同的语言输入转换为规范化形式。](http://nshipster.com/cfstringtransform/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-10T22:23:57.123

Soundex 的更好替代方案是 Double Metaphone，或者甚至更好的是 Metaphone 3。您不会说您使用的是什么语言，但是这两种算法都可以在 C++、C# 和 Java 中使用

# linux - 每个用户的 rc.local 文件是个坏主意？

> ID：13214850
> 
> 赞同：0
> 
> 时间：2012-11-04T00:19:21.400
> 
> 标签：linux, startup, boot, rc

我正在考虑以普通用户身份在系统启动时运行命令。目前，为此，我使用如下语法：

```
su -c 'command with some arguments' user 
```

但我认为在 ~/.rc.local 中拥有一个每个用户的 rc.local 文件可能会有所帮助，该文件会在启动时自动以用户身份运行。我想出的代码是这样的：

```
awk -F":" '{ if ($3 >= 1000) print $1, $6 }' /etc/passwd | while read u h
do 
  [ -x "$h/.rc.local" ] && su -c "cd $h; ./.rc.local" $u
done 
```

这将被添加到 /etc/rc.local。它搜索每个非系统用户的主目录（即，uid >= 1000），如果文件存在并且可执行，它会 cd 到用户主目录并以用户身份执行该脚本。

对我来说，这似乎消除了任何安全风险来源，因为它将以用户而不是 root 身份执行脚本，但我最近被提醒我缺乏安全知识，所以我提出了这个问题：这是一个坏主意？

现在，我只会在我的家用电脑上运行它，而我的家用电脑只有一个非系统用户。几年后，我的女儿在电脑上获得了自己的帐户，但除此之外，完全陌生的人无论如何也无法访问它。

那么，是否有任何我忽略的潜在安全漏洞？此外，是否有更优雅的方式来编写该命令？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T01:34:19.110

`@reboot`这与每用户 crontab的功能重叠。

# ruby-on-rails - Rails 3.2 中缺少“post_id”列和用户/帖子/评论之间的关系

> ID：13214851
> 
> 赞同：1
> 
> 时间：2012-11-04T00:19:21.473
> 
> 标签：ruby-on-rails, model, has-many, belongs-to, relationships

我仍在熟悉 Rails，并且对我尝试使用 Rails 3.2 解决的问题有疑问。这是我认为我的问题所在的几个文件的链接：

[https://gist.github.com/0fe5cf9093b21f4f632f](https://gist.github.com/0fe5cf9093b21f4f632f)

如果代码真的很糟糕/添加了一些不需要存在的东西，我深表歉意，因为我仍在努力适应一切的工作方式。

我想对我网站上的每篇文章发表评论——我的逻辑是用户有很多评论，我想这些帖子有很多来自用户的评论。我确实添加了这种关系（尽管它似乎没有做任何特别的事情），而且我觉得我所有的表引用都是正确的（尽管我没有向用户添加任何东西，因为我正在使用设计和感觉我不需要添加任何东西，因为帖子本身就是一个单独的对象）。

截至目前，我可以显示所有评论，因为我可以创建和保存它们。我至少还保存了`user_id`变量，因此它可以了解哪个帐户正在发表评论。我不确定我应该在哪里/何时通过`post_id`，所以这是最大的问题。我尝试过的任何方式`posts_controller`（因为理论上我应该能够在加载帖子页面时编辑该属性），我得到一个

```
undefined method 'post_id' 
```

或者

```
no post_id column 
```

错误，表明它不存在，即使据我了解，我已经定义了它。`user_id`如前所述，能够保存的事实使我更加困惑。

如果我显示在我的显示视图中创建的评论的属性，我会得到以下信息：

```
{
    "id"=>1,
    "content"=>"text here",
    "posted"=>Sat, 03 Nov 2012 20:36:53 UTC +00:00,
    "user_id"=>1,
    "created_at"=>Sat, 03 Nov 2012 20:36:53 UTC +00:00,
    "updated_at"=>Sat, 03 Nov >2012 20:36:53 UTC +00:00
} 
```

没有`post_id`，尽管我确实将它添加到迁移表中以供评论。尝试`@post.id`在帖子控制器中传递 （到 show 方法的评论实例，因为它可以在帖子下方使用）会导致质量分配错误。弄乱`:class`and`:foreign_key`选项也没有多大作用。根据我所做的研究，其中包括 Rails 自己的一些文档，我认为我不需要`has_many`直通关系，但我不知道我在哪里缺少相应保存信息所需的内容。

也许这部分是由于我对数据库/模型关系设计缺乏了解，尽管感谢任何帮助。我见过几个类似的问题，但我仍然发现很难将他们的解决方案应用到我自己的特定问题的上下文中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:43:35.773

根据您的帖子，听起来您可能在创建表后将 post_id 添加到迁移中。如果这是真的，请理解修改迁移文件是不好的做法。相反，您应该创建一个新的迁移来“修复”数据库的状态。

看起来您的关系已正确设置为帖子和评论。带有“belongs_to”的模型将具有外键；因此，我希望评论有“post_id”。

请查看以下内容是否适合您：

1.  将“post_id”添加到您已经运行的评论迁移文件中。
2.  创建一个新的迁移： `rails g migration addPostIdToComments`
3.  在生成的迁移中，在“更改”方法中输入：`add_column :comments, :post_id, :integer`
4.  运行你的迁移：“rake db:migrate”

这应该将 post_id 列添加到您的评论表中。

如果您陷入困境并想要完全破坏您的数据库并从头开始重新创建它（它看起来像一个示例应用程序），（**请注意这将完全删除数据库**）您可以运行：`rake db:drop db:create db:migrate`

批量分配问题可能与 rails 中的新安全选项有关，该选项需要将所有可以在数据库中更新的模型属性（列）列入白名单。请参阅 attr_accessible 文档以了解白名单属性：[http ://api.rubyonrails.org/classes/ActiveModel/MassAssignmentSecurity/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveModel/MassAssignmentSecurity/ClassMethods.html)

欢迎来到轨道！希望这可以帮助！

# java - 如何输出到我在 java 中输入的同一个 txt 文件？

> ID：13214853
> 
> 赞同：-4
> 
> 时间：2012-11-04T00:19:35.880
> 
> 标签：java, printwriter

我想“覆盖”输入文件中的内容并将其替换为更新的信息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T00:21:48.943

如果您可以读取整个文本文件，然后关闭它，这样做 - 然后使用`FileOutputStream`包裹在`OutputStreamWriter`, 中（`FileOutputStream`默认情况下将覆盖）。

如果您需要同时读取和写入，则应写入不同的文件，然后删除“旧”文件并将“新”文件重命名到位。

# objective-c - Objective C - 函数（不知道如何解释这个）

> ID：13214861
> 
> 赞同：3
> 
> 时间：2012-11-04T00:21:01.853
> 
> 标签：objective-c, ios, function, syntax, cocos2d-iphone

我正在使用 Cocos2D 开发一个 iOS 应用程序，我遇到了很多我想做一些稍微延迟的事情的情况，所以我使用这样的代码行：

```
[self scheduleOnce:@selector(do_something) delay:10]; 
```

发生的事情`do_something`只是一行代码。有没有办法让我在我安排它的那一行定义函数？

当我曾经使用 jQuery 进行编程时，这与我想要实现的目标相似：

```
$("a").click(function() {
  alert("Hello world!");
}); 
```

看看 function() 是如何在那里定义的？有没有办法在 Objective-C 中做到这一点？另外，这个有名字吗？为了将来的搜索？因为我觉得这很难解释。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T00:22:56.500

您可以使用`dispatch_after`在一定时间后执行块。

```
int64_t delayInSeconds = 2.0;
dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, delayInSeconds * NSEC_PER_SEC);
dispatch_after(popTime, dispatch_get_main_queue(), ^(void){
    /* code to be executed on the main queue after delay */
}); 
```

我将其称为时间调度块。

**编辑**：如何只发送一次。

```
static dispatch_once_t onceToken;
dispatch_once(&onceToken, ^{
    /* code to be executed once */
}); 
```

所以在你的情况下：

```
static dispatch_once_t onceToken;
dispatch_once(&onceToken, ^{
    int64_t delayInSeconds = 2.0;
    dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, delayInSeconds * NSEC_PER_SEC);
    dispatch_after(popTime, dispatch_get_main_queue(), ^(void){
        /* code to be executed on the main queue after delay */
    })
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T09:25:09.727

由于您使用的是 Cocos2D，您还可以利用 CCDelayTime 方法并将其组合到 CCSequence 中以达到您想要的效果。类似于以下内容：

```
id delayAction = [CCDelayTime actionWithDuration:10];
id callSelector = [CCCallFunc actionWithTarget: self selector: @selector(do_something)];
[self runAction:[CCSequence actionOne:delayAction two:callSelector]]; 
```

或者您也可以使用 CCCallBlock，这样您就不必为 do_something 编写单独的方法，只需将其放在一个块中即可。

```
[self runAction:[CCSequence actionOne:delayAction two:[CCCallBlock actionWithBlock:^{
// do something here
           }]]]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T00:27:12.083

我想您需要将方法“do_something”声明为

```
-(void)do_something {
    //Your implementation here
} 
```

在这种情况下，您可以为 do_something 方法添加尽可能多的行。

@selector(do_something) 是在类中执行方法的命令。

# javascript - 带有js的forEach循环中的异步函数

> ID：13214862
> 
> 赞同：6
> 
> 时间：2012-11-04T00:21:06.390
> 
> 标签：javascript

> **可能重复：**
> [javascript：使用一个回调执行一堆异步方法](https://stackoverflow.com/questions/2911822/javascript-execute-a-bunch-of-asynchronous-method-with-one-callback)

几天来我一直在努力解决这个问题，但我就是想不出一种优雅的方式来处理它。这就是问题所在。

我正在运行一个 forEach 循环，我需要知道一切何时完成。由于 forEach 循环是阻塞的，因此在 forEach 循环之后删除 a 应该很容易`console.log`，它将在 forEach 循环完成时运行。但是，如果 forEach 循环中有任何不同步的函数，整个系统很快就会崩溃，除了非常奇怪的 hacky 计数器和 if 语句之外，我无法知道循环的内容何时完成。我的问题是在 javascript 中是否有一种优雅的方式来处理这种情况。

这里有几个例子：

在这种情况下，forEach 循环运行得非常好，因为循环中的所有内容都是同步的。

```
[1,2,3].forEach(function(num){
  console.log("we're on " + num);
});
console.log('done counting!')

//=> we're on 1
//=> we're on 2
//=> we're on 3
//=> done counting! 
```

这是我们开始遇到问题的地方，作为一个基本示例：

```
[1,2,3].forEach(function(num){
  setTimeout(function(){ console.log(num) }, 200);
});
console.log('done counting!');

//=> done counting!
//=> we're on 1
//=> we're on 2
//=> we're on 3 
```

尽管发生这种情况确实是有道理的，但我现在手头有一个不幸的问题，当我们完成计数时我需要回调，而且除了像这样恶心的东西之外，我没有其他顺利的方法：

```
var counter = 0;
var numbers = [1,2,3]

var log_number = function(num){
  console.log("we're on " + num);
  counter++;
  if (counter == numbers.length) {
    console.log("done counting!")
  }
}

numbers.forEach(function(num){
  setTimeout(log_number(num), 200);
});

//=> we're on 1
//=> we're on 2
//=> we're on 3
//=> done counting! 
```

天哪，这是一个非常多的开销。有没有更顺畅的方法来实现这一点？我已经检查了承诺、延迟和序列，但我还没有真正能够以一种更简洁的方式实现它们中的任何一个:(

需要明确的是，我的问题并不是 setTimeout，它通常在同步函数中运行异步函数——这只是最简单的例子。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T02:54:45.917

```
Array.prototype.forEachDone = function(fn, scope, lastfn) {
    for(var i = 0, c = 0, len = this.length; i < len; i++) {
        fn.call(scope, this[i], i, this, function() {
            ++c === len && lastfn();
        });
    }
};

[1,2,3].forEachDone(function(num, i, arr, done){
  setTimeout(function(){ console.log(num); done() }, 200);
}, this, function() {
    console.log('done counting!');
}); 
```

这将满足您的需求。forEachDone 将采用与 forEach 完全相同的参数，最后还有一个额外的参数，它是在应用于数组的每个元素的函数完成时调用的回调。将应用于数组中每个元素的函数也采用与 forEach 完全相同的参数，但还有一个额外的参数，该函数应该在函数完成时调用。

PS：就个人而言，我永远不会接触原生对象的原型，但如果你正在寻找漂亮，就是这样。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-04T00:47:03.017

```
var list = ["your", "mom"];
var count = 0;

for(var i = 0; i < list.length; ++i) {
    getSomething(list[i], function() {
     if(++count == list.length)
      imDone();
     });
} 
```

**另一种方式是这样的**

```
var biscuits = ["cheddar", "butter milk"];

(function eatBiscuits(location) {
  eatIt(biscuits[++location], whenAllEaten);
  typeof biscuits[location] != "undefined" && eatBiscuits(location);
}(-1))

function eatIt(biscuit, cb) {
 if (typeof biscuit == "undefined") {
  cb();
 } else {
  stuffMyFace();
 }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T02:21:24.753

我倾向于使用这样的小实用功能：

```
​function asyncCallback( iterations, onComplete ){
  var total = iterations.length || iterations, count = 0;
  return function( func ){
    func();
    if ( ++count == total ) onComplete();
  };
}

var arr = [1,2,3];

var async = asyncCallback(arr, function(){
  console.log('donezo!');
});

arr.forEach(function(num){
  setTimeout(function(){
    async(function(){
      console.log(num);
    });
  }, 200);
}); 
```

​</p>

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-04T01:36:27.500

如果您愿意使用 lib，那么[async](https://github.com/caolan/async)将是一个不错的选择（适用于浏览器以及 node.js）！

```
async.parallel([
    function(){ ... },
    function(){ ... }
], callback);

async.series([
    function(){ ... },
    function(){ ... }
]); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-04T00:31:31.277

实际上，没有“聪明”的方法可以做到这一点。您需要使用类似`setTimeout`, `setInterval`, `Worker`

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-11-04T00:30:20.293

```
[1,2,3,4,5,6,7,8].forEach(function(n){
 setTimeout(function(){
  console.log(arguments[0]);
 },1000*n,n);
}); 
```

这对我来说很好

# javascript - 使用日期精度比较 javascript/jquery 中的两个日期

> ID：13214863
> 
> 赞同：1
> 
> 时间：2012-11-04T00:21:11.380
> 
> 标签：javascript, jquery, date, compare

我需要使用最佳精度比较两个日期，对我来说一天会很好并考虑闰年。

有可能的 ？我现在只创建比较月份精度的函数：/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T00:36:19.620

如果您有日期字符串，则可以使用`Date.parse("datestring")`. 它将返回 long（以毫秒为单位的时间）。你可以比较任意两个多头。

```
var date1 = new Date("10/25/2011");
var date2 = new Date("09/03/2010");
var date3 = new Date(Date.parse(date1) - Date.parse(date2));

var dayDiff = date3.getDate() - 1;
var monthDiff = date3.getMonth();
var yearDiff = date3.getFullYear() - 1970; 
```

这是[jsfiddle](http://jsfiddle.net/JmYCN/25/)来测试它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T00:46:49.347

您可以从另一个 Date 对象中减去 Date 对象并返回微秒

```
var d= new Date('2012/11/29');
var a= new Date('2012/11/30');
alert( (a-d) /(1000*24*60*60)) ); /* returns 1 */ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T00:32:09.713

这应该以相当好的精度适用于天数差异：

```
function daysSince( past ) {
  return 0|( new Date().getTime() - past.getTime() ) * 1.16e-8;
}

console.log( daysSince( new Date('10/03/2012') ) ); //=> 31 
```

**编辑：**实际上，如果您只想知道两个日期之间的差异，您总是可以返回一个正数。

```
function daysBetweenDates( d1,d2 ) {
  return Math.abs( 0|( d1.getTime() - d2.getTime() ) * 1.16e-8 );
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-04T00:43:44.843

我遇到的最好的 JavaScript 时间和日期操作库是[Moment.js](http://momentjs.com)

获取两个日期之间的天数：

```
d1 = moment('2012-10-31')
d2 = moment('2012-11-02')
Math.abs(moment.duration(d1-d2, 'ms').days())
// => 2 
```

默认精度为毫秒。

# javascript - Rails：根据数据库中的值运行脚本

> ID：13214865
> 
> 赞同：0
> 
> 时间：2012-11-04T00:21:22.087
> 
> 标签：javascript, ruby-on-rails

现在，我有一些我想在我的应用程序的每个页面上运行的工具提示 JavaScript，但前提是当前用户的模型在我的数据库中将 User.advanced_tooltips 设置为 true。

从概念上讲，让这个 JavaScript 根据数据库中的值有条件地触发的最佳方法是什么？我在让 JavaScript 和 Rails 进行通信时遇到了一些真正的麻烦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:53:33.150

假设您使用的是 jquery，您可以这样做：

```
<script type='text/javascript'>
$(document).ready(function() {
   var advtt = '<%= @user.advanced_tooltips ? "yes" : "no" %>';
   if ( advtt == 'yes')
     # ?? add css, or whatever
});
</script> 
```

这假设在呈现包含上述 Javascript 的视图之前在控制器中设置了 @user。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T11:19:12.557

一个干净简单的解决方案是将javascript函数包装在rails逻辑中：

```
<script type='text/javascript'>

  var setupTooltips = function() {
    // do something here
  }

  $(document).ready(function() {

    <% if current_user.advanced_tooltips %>
      setupTooltips();
    <% end %>

  });

</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T18:36:20.173

这是我最终使用的解决方案（鉴于该项目施加的非常奇怪的限制）：

首先，我设置了一个控制器路由来查找当前用户，然后将其 advanced_tooltip 值呈现为文本。

然后，在我的 application.js 中，我使用 $.get 对该路由进行了 AJAX 调用，然后检查结果是否 == "true" 以确定用户是否启用了高级工具提示。

这是一个混乱的解决方案（上面列出的实际上更好），但由于我在完成其他人的项目时遇到了一些非常严格的限制，所以我必须这样做。

仍然给予两个评论投票，因为它们是有效的并且在正常情况下完全可以工作。

# php - DOMDocument 命名空间有什么用？

> ID：13214866
> 
> 赞同：5
> 
> 时间：2012-11-04T00:21:39.437
> 
> 标签：php, xml, rss, domdocument, xml-namespaces

```
$xpath->registerNamespace('slash', 'http://purl.org/rss/1.0/modules/slash/'); 
```

据我了解，它们的作用类似于文档定义，并且需要识别某些 XML 元素。

PHP 是否真的向该 URL 发出请求并验证该元素是否存在于文档定义中？

因为该 URL 显示[404 未找到](http://purl.org/rss/1.0/modules/slash)页面 :(

```
$result = $xpath->evaluate('string(//atom:entry[3]/slash:comments)'); 
```

`<slash>`这可能是我在尝试从 RSS 提要中检索元素值时得到一个空字符串的原因吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-03T16:16:12.463

> ```
> $xpath->registerNamespace('slash', 'http://purl.org/rss/1.0/modules/slash/'); 
> ```
> 
> 据我了解，它们的作用类似于文档定义，并且需要识别某些 XML 元素。
> 
> PHP 是否真的向该 URL 发出请求并验证该元素是否存在于文档定义中？

**不**
，那个[URI](https://www.rfc-editor.org/rfc/rfc3986)标识一个[XML 名称空间](http://en.wikipedia.org/wiki/XML_namespace)，它代表一个 XML 词汇表。这样的命名空间旨在处理使用具有不同含义的相同术语的不同上下文。使用名称空间，单个 XML 文件可以包含具有相同“名称”的标记和属性，它们通过前缀进行限定。例如，您可以有一个这样的 xml 文档：

```
<html xmlns="http://www.w3.org/1999/xhtml" 
        xmlns:human="http://sample.xml.com/Human">
  <title>John Smith measures.</title>
  <body>
    <human:name>John</human:name> <human:surname>Smith</human:surname>
    is <human:height unit="feet">6</human:height> feet tall.
  </body>
</html> 
```

在此类内容中，“human”前缀用于标记来自**[http://sample.xml.com/Human](http://sample.xml.com/Human)**命名空间的元素，而空字符串（即默认前缀）用于标记来自**[http://www的元素.w3.org/1999/xhtml](http://www.w3.org/1999/xhtml)**命名空间。这些 URI 是命名空间标识符，而不是模式位置（可以用[DOCTYPE 声明](http://xmlwriter.net/xml_guide/doctype_declaration.shtml)或[XML 模式实例](http://www.w3.org/2001/XMLSchema-instance)表示）。在命名空间 URI 标识的位置提供适当的命名空间文档是一种很好的做法，但这不是必需的（实际上 xhtml 命名空间 URI 指向相关的 W3C 文档，但您正在寻找的 RSS 扩展并不） .

但是请注意，`resolveExternals`和`validateOnParse`都可能影响目标 xml 引用的 DTD 或模式定义的下载，但**不会**影响命名空间文档。任何解析器都不会下载这样的文档，因为它是供人类使用的。

> ```
> $result = $xpath->evaluate('string(//atom:entry[3]/slash:comments)'); 
> ```
> 
> 这可能是我在尝试从 RSS 提要中检索元素值时得到一个空字符串的原因吗？

**不。**
首先，检查源 xml 是否包含正确的 xmlns 声明，并且它是否包含**第三个**atom 条目`<slash:comments>`内的节点（注意，第三个，因为**xpath 索引是基于一个的**，所以这意味着每个条目都是它自己的第一个条目父节点，第二个等等）。 如果是这样，我怀疑您忘记注册**atom**命名空间。 尝试这样的事情（改编自用户对[DOMXPath::registerNamespace](http://www.php.net/manual/en/domxpath.registernamespace.php#91538)文档的贡献）：****`//atom:entry[1]``//atom:entry[2]`**** 

 ******```
$doc = new DOMDocument;
$doc->loadXML($xml); // your xml string here
$xpath = new DOMXPath($doc);

$xpath->registerNamespace('atom', "http://www.w3.org/2005/Atom");
$xpath->registerNamespace('slash', 'http://purl.org/rss/1.0/modules/slash/');

$result =  $xpath->evaluate('string(//atom:entry[3]/slash:comments)'); 
```

[你可以在http://codepad.org/JX8RpaKu](http://codepad.org/JX8RpaKu)看到这个运行

实际上，要使用合格的 xpath，您也需要注册默认命名空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-07T13:39:29.430

你有多个问题。我将尝试一一解决：

> ```
> $xpath->registerNamespace('slash', 'http://purl.org/rss/1.0/modules/slash/'); 
> ```
> 
> 据我了解，它们的作用类似于文档定义，并且需要识别某些 XML 元素。

是的，只要您有一个带有命名空间的 XML 文档，那么每个元素都可以在它自己的命名空间中。

如果您想访问它们自己命名空间中的元素，那么是的，您需要命名空间来识别它们。例如在 Xpath 表达式中。

在 PHP 中，DOMDocument 和其他基于 libxml 的 XML 扩展支持 XML 命名空间。

> PHP 是否真的向该 URL 发出请求并验证该元素是否存在于文档定义中？

不，对于您提供的代码示例：

```
$xpath->registerNamespace('slash', 'http://purl.org/rss/1.0/modules/slash/'); 
```

PHP*不会*请求该 URL。您已经注意到 URL 是空的 / 给出 404，所以您可能想了解这是什么意思。该 URL 实际上是一个 URI。这就是*Identifier*和*Locator*的区别。

![URI Pill：可以是 URL 或 URN](../Images/f99f7a5fb709880544a4524d82739093.png)

要使 XML 名称空间正常工作，不需要定位任何内容。只需要标识命名空间。因此，一个有效的 XML 命名空间可以用任何 URI 表示。例如，`fantasy:space`是一个有效的 URI，并且完全符合指定 XML 命名空间的要求。但是当您在浏览器中输入它时，您甚至不会得到任何服务器响应（您的浏览器不知道“幻想”代表什么）。

因此，您得到的 404 并不是 Xpath 评估中斜杠为空的原因：

```
$result = $xpath->evaluate('string(//atom:entry[3]/slash:comments)'); 
```

你在这里得到一个空字符串的原因是不同的。查看 Xpath 表达式：

```
string(//atom:entry[3]/slash:comments) 
```

那是要求节点集的字符串值。您已将节点集指定为：

```
//atom:entry[3]/slash:comments 
```

在 PHP DOMDocument 中[获取节点集的字符串意味着：](http://www.w3.org/TR/1999/REC-xpath-19991116/#function-string)

> 通过返回节点集中在文档顺序中排在第一位的节点的[字符串值，将节点集转换为字符串。](http://www.w3.org/TR/1999/REC-xpath-19991116/#dt-string-value)如果节点集为空，则返回一个空字符串。

由于节点是一个元素，[元素节点](http://www.w3.org/TR/1999/REC-xpath-19991116/#element-nodes)的字符串值意味着：

> 元素节点的字符串值是该元素节点的所有文本节点后代的字符串值按文档顺序串联而成。

所以这里有两个解释为什么你会得到一个空字符串：节点集是空的，或者元素字符串值只是一个空字符串。

[`count()`您可以使用以下函数](http://www.w3.org/TR/1999/REC-xpath-19991116/#function-count)快速了解节点集中的节点数：

```
$result = $xpath->evaluate('count(//atom:entry[3]/slash:comments)'); 
```

那么这应该让您更好地了解这两种情况中的哪一种。由于您没有共享源 XML，因此无法具体说明*为什么*它 - 正如我所假设的那样 - 不包含节点。看到来源应该很容易澄清这一点。

在那之前，我只能猜测您可能正在解析一个不包含`<atom:entry>`元素而只包含元素的 RSS 2 提要`<item>`。看我的例子：

```
$feed = 'http://hakre.wordpress.com/feed/';

$doc = new DOMDocument();
$doc->load($feed);
$xpath = new DOMXPath($doc);

echo $xpath->evaluate('string(//item[3]/slash:comments)'); # 1 
```

它输出值“1”作为第三项的评论计数。这是标准 Wordpress 博客的提要。[我已将此作为交互式示例放到网上，因此您可以看到它的实际效果并输入您的提要 URL](http://codepad.viper-7.com/L5MURC)。

顺便说一句：如果您在加载 XML*后*`DOMXPath`创建对象，则无需注册命名空间 URI，只要您知道文档中使用了哪些前缀即可。这就是为什么在示例中我没有注册任何命名空间 URI。

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T09:33:08.237

有关名称空间的教程，已有 13 年历史但仍然有用，请参阅

[http://www.jclark.com/xml/xmlns.htm](http://www.jclark.com/xml/xmlns.htm)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-04T00:52:18.707

如果您想检索命名空间节点的内容，您是否尝试过[getElementsByTagNameNS](http://www.php.net/manual/en/domdocument.getelementsbytagnamens.php)？

```
$dom - new DOMDocument($url);
$slashEls = $dom->getElementsbyTagNameNS('slash', 'slash'); // Assuming the element is <slash:slash> in the XML
foreach($slashEls as $slash) {
    // ...
} 
```*******

# google-app-engine - appcfg upload_data 上的管道损坏错误

> ID：13214868
> 
> 赞同：0
> 
> 时间：2012-11-04T00:21:48.203
> 
> 标签：google-app-engine

我已经成功地从我的 Mac OS X 10.8 (SDK 1.6) 上的数据存储区下载了我的数据。但是，当我使用 appcfg upload_data 时，出现以下错误；任何想法 ？

appcfg.py upload_data --url=http://localhost:8081/_ah/remote_api --filename=db_backup_2012_Nov_3

错误：

[INFO ] 连接到 localhost:8081/_ah/remote_api [INFO ] 开始导入；每个帖子最多 10 个实体...... [INFO] 意外线程死亡：WorkerThread-2 [INFO] 发生错误。正在关闭... ........[ERROR] WorkerThread-2 中的错误：[ERROR] WorkerThread-7 中的错误：

[INFO] 总共 350 个实体，0 个先前传输 [INFO] 190 个实体（179958 字节）在 15.2 秒内传输 [INFO] 一些实体未成功传输

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T02:20:29.150

我通过在运行 appcfg upload_data 时将线程数限制为 1 解决了这个问题：

appcfg.py upload_data --url=http://localhost:8081/_ah/remote_api --filename=db_backup_2012_Nov_3 --num_threads=1

开发应用服务器似乎正在丢弃线程。也许是因为 app.yaml 中有“threadsafe: no”！

# visual-studio-2008 - 如何将 .vb 转换为项目

> ID：13214870
> 
> 赞同：1
> 
> 时间：2012-11-04T00:22:00.320
> 
> 标签：visual-studio-2008

我在 Visual Basic 2008 Express 中创建了一个应用程序，但是当我保存它时，我错误地使用了“另存为”选项，它创建了 3 个文件：

1.  实践1.resx
2.  实战1.Designer.vb
3.  实践1.vb

现在我无法将其作为项目打开。

有什么方法可以将这些文件转换为我的原始项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:37:20.163

不 - 您根本没有保存项目，只保存了`practica 1`模块的各个文件。

创建一个新项目并导入这些文件。

# jquery - jquery 将鼠标悬停在我的子类别上消失

> ID：13214871
> 
> 赞同：3
> 
> 时间：2012-11-04T00:22:05.433
> 
> 标签：jquery, hover, mouseover

我的 jQuery 代码：

```
$(function()
{
    $(".third-categories").hide();  
});

$(function()
{
    $(".second-categories").hover(function() {
    $(this).next(".third-categories").show("slow");},
    function(){
    $(this).next(".third-categories").hide("slow");}
    );

});
$(function()
{
    $(".third-categories").mouseover(function(){(".third-categories").show("slow");});  
}); 
```

我的 HTML 代码：我在 smarty 模板上写，但装备看起来像这样：

```
<ul class="second-categories">
<ul class="second-categories">
<ul class="third-categories" style="display: none;">
  <li style="padding-left: 13px;">
</ul>
<ul class="second-categories">
<ul class="second-categories">
<ul class="third-categories" style="display: none;">
  <li style="padding-left: 13px;">
  <li style="padding-left: 13px;">
</ul>
<ul class="second-categories">
</html> 
```

当我将鼠标悬停在“第二类”ul 上时，我希望“第三类”ul 出现。这种情况正在发生，但我也希望“第三类”ul 在我将鼠标悬停在它上面时保持可见。我尝试了一切，但我不知道是什么问题...如果有人可以提供帮助将不胜感激...谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T01:26:13.183

这是你在找什么：**工作演示** [http://jsfiddle.net/8gdxG/](http://jsfiddle.net/8gdxG/)

此外，您的 HTML 看起来有点错误。另请注意，您无需多次添加准备好的文档就足够了。

下面的其余代码将有助于解决问题`:)`

**JQ代码**

```
$('.second-categories').mouseleave(function() {

        $(this).find('li ul.third-categories').each(function () {
            $(this).stop().slideUp('slow');
        });
    });

    $("ul li").mouseenter(function() { $(this).children('ul').stop().slideDown('slow'); });​ 
```

**HTML 代码**

```
<ul class="second-categories">
    <li>Hulk
      <ul class="third-categories">
          <li>child1</li>
         <li>child2</li>
      </ul>
     </li>    
    <li>Ironman
     <ul class="third-categories">
          <li>child</li>
         <li>child</li>
      </ul> 
    </li>
    <li>Thor
      <ul class="third-categories">
          <li>child</li>
      </ul>              
    </li>
</ul>​ 
```

# c++ - 使用 C++ 写入 Windows 安全日志

> ID：13214873
> 
> 赞同：0
> 
> 时间：2012-11-04T00:22:09.517
> 
> 标签：c++, winapi, event-log

我的任务是向 Windows 安全日志写入条目。整个项目是 Win32 C++ 代码。我已经（在各种在线资源的帮助下）编写了一个日志类，用于处理注册、注销和执行 ReportEvent() 调用的代码。此外，我已经完成了事件记录的 mc.exe 和 rc.exe 步骤，如果这有助于确定我在项目中的位置。

我的问题是多方的：

1.  我在[填写 Windows XP 安全事件日志](https://stackoverflow.com/questions/4095455/filling-windows-xp-security-event-log)时注意到，有些人认为 Windows 不允许这样做。其他（[How to write log to SECURITY event Log in C#?](https://stackoverflow.com/questions/11794013/how-to-write-log-to-security-event-log-in-c)）另有暗示。可能与否？

2.  如果可能，如何让它写入安全日志。调用 RegisterEventSource() 时是否像将“Security”指定为我的源名称一样简单？

3.  至于注销，什么时候应该发生？什么时候卸载应用？应用程序何时关闭？何时写入日志条目？

4.  如何查找我的日志条目？我查看了 Windows 事件查看器，但没有看到我在测试应用程序中添加的条目，尽管系统调用有所有适当的返回值。当我调用 RegisterEventSource() 时，我会在哪里查找源名称为“yarp”的事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:54:28.097

目前，我将只处理第一个问题，因为这个问题的答案*可能*会使其余的问题变得无关紧要。

[只有本地安全机构 (lsass.exe) 可以写入安全日志](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363658.aspx)。这不是试图获得特权的其他事物会失败的问题——而是根本没有其他任何方法可以请求特权（这是设计使然）。

从那里开始，您其他问题的唯一答案是“对不起！”

# ios - 以米为单位获取 MKMapView 边界

> ID：13214874
> 
> 赞同：3
> 
> 时间：2012-11-04T00:22:10.193
> 
> 标签：ios, mapkit

如何找出 MKMapKit 视图当前显示区域的大小，最好以米为单位？

MKMapKit 有一个`visibleMapRect`方法可以用来获取 a `MKMapSize`，文档说：

> 该值的单位是地图点。

什么是“地图点”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:27:16.977

这可能会有所帮助：

[iphone -- 将 MKMapPoint 距离转换为米](https://stackoverflow.com/questions/7395925/iphone-convert-mkmappoint-distances-to-meters)

# mysql - 如何在mysql表中强制类别与产品关系

> ID：13214880
> 
> 赞同：1
> 
> 时间：2012-11-04T00:23:02.540
> 
> 标签：mysql, database-design

我正在设计一个数据库，我想在其中完成这种情况：我有一个 Category 表和 Products 表。我想让没有分配现有类别的产品无法添加（我相信我是使用 Products 表上的 FK 做到的）。我想在类别上强制删除，以删除分配给该类别的所有子项（产品）。我不想删除一个类别，如果/当所有属于它的产品都被删除时。

目前，我想出的是： [http ://codepad.org/eSGqtyOs](http://codepad.org/eSGqtyOs)

我不确定，有人说类别表上的 FK 会阻止我添加没有产品的类别（catch 22 ..），如果我在产品表中添加 On delete CASCADE，它会自动删除一个类别，一次该类别中的最后一个产品被删除...

请帮助解决这个问题。

另外，请不要试图说服我不再“出售”旧类别/产品 - 我有我的理由，我知道我对这个系统的要求。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T02:18:32.763

根据您的要求，您不需要类别中的 FK（参考产品）。事实上，按照您制作这些 FK 循环的方式，您将无法插入*任何*数据，因为存在先有鸡还是先有蛋的问题。

您**只**需要产品中的 FK（引用类别）。

> 我想让没有分配现有类别的产品无法添加（我相信我是使用 Products 表上的 FK 做到的）。

这是正确的。

> 我想在类别上强制删除，以删除分配给该类别的所有子项（产品）。

ON DELETE CASCADE 应该注意这一点。

> 我不想删除一个类别，如果/当所有属于它的产品都被删除时。

FK 允许没有孩子的父母。

因此，在您的情况下，产品引用类别的 FK 将允许在没有任何产品的情况下存在类别。

# memory-management - NET 内存管理：由拥有的 UserControl 处理的 FORMCLOSED

> ID：13214881
> 
> 赞同：1
> 
> 时间：2012-11-04T00:23:21.783
> 
> 标签：memory-management

当 UserControl 正在侦听由其所有者表单引发的 FORMCLOSED 事件时，UserControl 是否需要调用 RemoveHandler 作为处理 Form 事件的一部分，以确保 Form 和 UserControl 都将正确 GC'd？

# web-services - java.lang.classcastexception - SOAP 错误 - 在 Android 中使用 KSOAP2

> ID：13214886
> 
> 赞同：1
> 
> 时间：2012-11-04T00:23:50.753
> 
> 标签：web-services, classcastexception, android-ksoap2

找了好久。这些错误的问题在于，虽然文本可能看起来相同，但问题总是不同的。

我的服务接受一个字符串值并返回一个字符串响应。这是我的代码：

```
private class UploadStats extends AsyncTask<String, Void, String>
{
    private static final String WSDL_TARGET_NAMESPACE = "http://tempuri.org/";
    private static final String SOAP_ADDRESS = "http://192.168.1.101/rss/RSS_Service.asmx?WSDL";

    private static final String INSERTURLACTION = "http://192.168.1.101/rss/RSS_Service.asmx/InsertURL";
    private static final String INSERTURLMETHOD = "InsertURL";

    @Override
    protected String doInBackground(String... url)
    {
        String status = "";

        SoapObject request = new SoapObject(WSDL_TARGET_NAMESPACE,
                INSERTURLMETHOD);

        request.addProperty("url", "www.yahoo.com");
        SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
        envelope.dotNet = true;

        envelope.setOutputSoapObject(request);
        HttpTransportSE httpTransport = new HttpTransportSE(SOAP_ADDRESS);

        try
        {
            httpTransport.call(INSERTURLACTION, envelope);
            SoapObject response = (SoapObject) envelope.bodyIn;

            status = response.getProperty(0).toString();
        }
        catch (Exception exception)
        {

            Log.d("Error", exception.toString());
        }

        if(status.equals("1"))
        {
            Log.d("InsertURL", "New URL Inserterd");
        }

        else if(status.equals("0"))
        {
            Log.d("InsertURL", "URL Exists. Count incremented");
        }

        else
        {
            Log.d("InsertURL", "Err... No");
        }

        return status;
    }

} 
```

我收到错误： **java.lang.classcastexception org.ksoap2.SoapFault**

我究竟做错了什么？如果需要更多详细信息，我可以添加它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T06:09:57.310

该错误与 Web 服务有关。

服务端不正确的命名空间可能会导致此错误（许多其他问题也会如此）。

最好的检查方法是在本地机器（托管服务的地方）上运行 web 服务。

# c - 使用 Code::Blocks IDE 的 C 中未定义的引用错误

> ID：13214889
> 
> 赞同：1
> 
> 时间：2012-11-04T00:24:26.747
> 
> 标签：c, reference, undefined, codeblocks

我正在尝试设置一些 .c 文件，以便在它开始变大时更容易找到东西。我将在程序中使用 SDL 调用，因此包含。

这是我的 main.cpp 现在的样子：

```
#include <stdio.h>
#include <SDL.h>
#include <SDL_gfxPrimitives.h>
#include <SDL_ttf.h>
#include "WriteText.h"

int main(int argc, char *argv[])
{
int i =0;
i = b();

return 0;
} 
```

在我的 WriteText.c 我有：

```
#include "WriteText.h"

int b(void)
{
return 3;
} 
```

最后是我的 WriteText.h：

```
#ifndef WRITETEXT_H_INCLUDED
#define WRITETEXT_H_INCLUDED

int b(void);

#endif // WRITETEXT_H_INCLUDED 
```

试图编译它，我得到一个未定义的“b()”引用。我不知道为什么会发生这种情况，我在一些基本的示例代码中进行了练习，一切都很好，但是一旦我将它实际用于实际的事情，我就会遇到这样的错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T00:27:46.933

问题是您没有将其链接`WriteText.c`到可执行文件中。如果您提供有关如何创建可执行文件的更多信息，我们可能会提供更好的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T11:35:55.813

我发现了我的问题，我的主文件是 .cpp 并使用了 CPP 编译器（因为它是一个 SDL 项目），但是当我添加一个新的 .cpp 文件并复制时，我添加的新文件是 .c 并使用了 C 编译器- 将我的代码粘贴到其中，一切顺利。

（我不确定在 .cpp 文件中编写 C 代码是否是“错误的形式”，但如果我打算使用 SDL，我想这是唯一的方法。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T00:31:14.270

您的编译可能没有使用 writetext 目标文件。假设 *nix 和 gcc，你的 makefile 应该看起来像：

```
all: myprog

myprog: myprog.o writetext.o
    gcc -o $@ $^

myprog.o: myprog.cpp

writetext.o: writetext.cpp 
```

# .net - 将一段代码的执行限制为 4 个线程的最低开销方法是什么

> ID：13214897
> 
> 赞同：1
> 
> 时间：2012-11-04T00:26:25.390
> 
> 标签：.net, multithreading

> **可能重复：**
> [限制一次执行方法的线程数](https://stackoverflow.com/questions/2552192/limiting-the-number-of-threads-executing-a-method-at-a-single-time)

在单个应用程序中，我们需要将一段代码的执行限制为 4 个线程。这部分不是线程的开始/结束，它是线程内部的一段代码。

如何做到这一点很容易 - 创建一个 EventWaitHandle 并在其上等待/发出信号。但是我想到做 4 的每一种方式都留下了确定我需要等待的可能性，另一个线程存在该部分和信号，然后我等待 - 永远。

那么当所有线程都在一个应用程序中时，最轻量级的方法是什么？

背景：我们正在更改我们的许可模型，以允许最多 N（本示例中为 4 个）线程连续调用我们的库。因为我们是一个库，而不是服务器，所以我们不控制线程的使用（就像数据库一样）。对于 Web 应用程序，调用应用程序也不控制线程数，因此我们需要暂停线程 5 调用我们，直到前 4 个线程退出该代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T00:34:14.143

[Semaphore](http://msdn.microsoft.com/en-us/library/system.threading.semaphore.aspx)是非常适合您的线程原语。它将允许最多指定数量的并发用户；额外的用户将阻止。

```
private static Semaphore _semaphore = new Semaphore(4, 4); 
```

然后对于您要共享的代码：

```
_semaphore.WaitOne();
try
{
    // protected code goes here
}
finally
{
    _semaphore.Release();
} 
```

就开销而言，这样做的好处是高效：它*正确地*`WaitOne`阻塞了您的线程，并且当有人调用 a 时您可以有效地解除阻塞。*`Release`*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T00:39:50.413

[正如romkyns](https://stackoverflow.com/a/13214942/167251)所提到的，我会使用 Semaphore 。然而，信号量下的操作应该是相当大的——开销很大。考虑[SemaphoreSlim](http://msdn.microsoft.com/en-us/library/system.threading.semaphoreslim.aspx)是否适合您的情况（即，如果许可仅适用于单个进程，请参阅[如何在 Semaphore 和 SemaphoreSlim 之间进行选择？](https://stackoverflow.com/q/4154480/167251)和[MSDN](http://msdn.microsoft.com/en-us/library/z6zx288a.aspx)）。

题外话：

This seems like a very inconvinient licensing scheme. What do you want to achieve doing this? The licensing scheme should reflect buisness value and talking about number of concurrent threads seems hard to communicate to management. Secondly, how will this licensing scheme help you communicate the need for more licenses? It seems hard to monitor the usage if you base the licenses on the number of threads, making it hard to justify the need for more licenses to your users.*

# asp.net - asp.net Ajax Toolkit CascadingDropdown - 未知的网络方法

> ID：13214901
> 
> 赞同：1
> 
> 时间：2012-11-04T00:26:48.697
> 
> 标签：asp.net, ajaxcontroltoolkit, asp.net-4.0

我正在尝试使用 Ajax Control Toolkit 中的一个非常基本的 CascadingDropDown。我想要实现的是让用户从下拉列表中选择“州”和“城市”。CascadingDropDown 代码如下所示。

```
 State : <asp:DropDownList ID="DdlState" runat="server" />
    <asp:CascadingDropDown ID="CddState" runat="server" TargetControlID="DdlState" Category="State"
    EmptyText="Select State" EmptyValue="0" ServiceMethod="GetDropDownContents" 
    />

    City : <asp:DropDownList ID="DdlCity" runat="server" />
    <asp:CascadingDropDown ID="CddCity" runat="server" TargetControlID="DdlCity" ParentControlID="DdlState" Category="City"
    EmptyText="Select City" EmptyValue="0" ServiceMethod="GetDropDownContents"
    /> 
```

这是我在代码隐藏中所拥有的

```
[WebMethod]
[System.Web.Script.Services.ScriptMethod]
public CascadingDropDownNameValue[] GetDropDownContents(string knownCategoryValues, string category) {
    if (category.Equals("State")) {
        StateManager stateManager = new StateManager(null);
        List<CascadingDropDownNameValue> states = new List<CascadingDropDownNameValue>();
        foreach (State state in stateManager.GetQueryableStates().ToList()) {
            states.Add(new CascadingDropDownNameValue(state.Name, state.Id.ToString()));
        }
        return states.ToArray();
    } else {
        CityManager cityManager = new CityManager(null);
        List<CascadingDropDownNameValue> cities = new List<CascadingDropDownNameValue>();
        foreach (City city in cityManager.GetQueryableCities()
                             .Where(c => c.State.Id == 1))) {
            cities.Add(new CascadingDropDownNameValue(city.Name,city.Id.ToString()));
        }
        return cities.ToArray();
    }
} 
```

上面的代码因 500 Internal Server Error 而失败。使用 fiddler 我可以看到以下错误**"Unknown web method GetDropDownContents"**。但是我的代码隐藏文件中已经有了 Web 方法 GetDropDownContents()，并且也被标记为 [WebMethod]。

那么，为什么填充下拉请求找不到我在代码隐藏文件中的 Web 方法。

**更新** 这里是演示[CascadingDropDown的链接](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/CascadingDropDown/CascadingDropDown.aspx)

**Update-2** 类声明。

```
public partial class Index : System.Web.UI.Page
{
    ....
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T21:54:33.167

`GetDropDownContents`方法必须是静态的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T01:53:25.980

您的页面上是否有启用了 pagemethods 的脚本管理器？

# c# - Filestream文件在使用过程中的变化

> ID：13214903
> 
> 赞同：0
> 
> 时间：2012-11-04T00:27:11.723
> 
> 标签：c#, filestream

我正在开发一个维护类似于 Dropbox 的实时备份的项目。当我使用文件流上传文件时，如果文件更改、删除或重命名会发生什么情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T00:37:09.400

您的应用程序应该（应该确保）对该文件进行文件锁定，因此不能进行任何更改。

# .htaccess - htaccess 不工作 - 查看图片

> ID：13214904
> 
> 赞同：0
> 
> 时间：2012-11-04T00:27:13.237
> 
> 标签：.htaccess

```
Options -MultiViews
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ $1.php [L]
RewriteRule ^([^/]+)/$ view_image.php?rand=$1 [L] 
```

有人可以告诉我为什么这行不通吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T00:45:06.870

将在线回答

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
#next  is last rule [L], 
#all works like following:
#helloworld/ -> helloworld/.php
#helloworld/helloworld -> helloworld/helloworld.php
#image.png -> image.png.php
RewriteRule ^(.*)$ $1.php [L]
#next rule never fires, as 1st rule ooverride it
#and if it would be before previous it will fire only to 1st word:
#image -> skipped
#image/ -> view_image.php?rand=image
#image/image -> skipped
RewriteRule ^([^/]+)/$ view_image.php?rand=$1 [L] 
```

# android - 被父级裁剪的 Android 视图的全尺寸

> ID：13214906
> 
> 赞同：3
> 
> 时间：2012-11-04T00:27:26.213
> 
> 标签：android, layout, view, size, android-linearlayout

请看一下这个 xml 布局。

```
 <LinearLayout android:id="@+id/dataTableContainer"
                  android:orientation="vertical"
                  android:layout_width="fill_parent"
                  android:layout_height="wrap_content"
                  android:clipChildren="true">

        <LinearLayout android:id="@+id/dataTable"
                   android:layout_width="wrap_content"
                   android:layout_height="wrap_content"
                   android:orientation="vertical"/>  

    </LinearLayout> 
```

在运行时，“dataTable”元素填充了比“dataTableContainer”可以显示的更宽的子元素。但是，当我在 Eclipse 中检查两个元素的 mMeasuredWidth（甚至是 getWidth() 的返回值）时，它们结果是完全相同的。这不应该是这样。我的理解是，“dataTable”的孩子应该在给定“wrap_content”设置的情况下将其推入自己的宽度。相反，“dataTableContainer”应该比它小，因为它的“fill_parent”设置受屏幕大小的限制。

我还尝试将“clipChildren”设置为 false，以防宽度被容器裁剪但结果保持不变：表格和容器都具有相同的宽度。

任何人都可以解释发生了什么吗？

为了给你一些背景信息，我想要做的是收集这些元素的大小，以确定有多少“dataTable”元素位于容器外部，因此是看不见的。这反过来又需要限制用户可以拖动表格元素的距离。ScrollView 元素本身限制了运动，但是当我使用 LinearLayout 时，我需要复制该限制功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T11:14:12.147

看来我太信任Eclipse了。在使用断点进行调试以检查应用程序的状态和许多可用变量的值时，我依赖于 eclipse 提供的变量列表，其中包括 mMeasuredWidth/mMeasuredHeight。请注意，这些不是我的源代码中的变量。Eclipse 不知何故自己找到了它们，并为我检查了这些对象。因此，我假设它们确实以某种方式代表了测量的宽度/高度。然而，我的假设是错误的，如果只是因为可以以不同的方式测量视图（即使用 MeasureSpec.UNSPECIFIED 或 MeasureSpec.EXACTLY）并且 eclipse 无法知道我需要哪种测量。

因此，我通过添加到我的代码来触发我需要的测量：

```
int measureSpecParams = View.MeasureSpec.getSize(View.MeasureSpec.UNSPECIFIED);
dataTableView.measure(measureSpecParams, measureSpecParams);
int measuredWidth = dataTableView.getMeasuredWidth();
int measuredHeight = dataTableView.getMeasuredHeight(); 
```

这确实给了我想要的视图大小，即如果父视图或屏幕限制它，“dataTable”视图会有多大。

# collections - Fluent NHibernate fluent映射对象和对象集合

> ID：13214907
> 
> 赞同：2
> 
> 时间：2012-11-04T00:27:39.197
> 
> 标签：collections, fluent-nhibernate, fluent-nhibernate-mapping

一般来说，我是 Fluent Nhibernate (FNH) 或 NHibernate (甚至是 ORM) 的新手。我有一个用于学习 FNH 的宠物项目，但我被困住了，这看起来像是一个设计问题。它是一个基本的图书馆管理系统，我有书籍、用户、booksize(!) 等对象。例如，我有一个 BookSize 类和它的管理器 BookSizesManager，其中包含 BookSize 对象的列表。谁能告诉我如何为他们两个创建 ClassMap，这样我的数据库（出于测试目的，比如 SQLite 数据库）将只有一个名为“BookSizes”的表，并列出 BookSizeManager 中的所有 BookSize 对象？

我目前的实现是遵循和有缺陷的，因为它产生了两个表 1\. BookSize 2\. BookSizes（来自 BookSizeManager Map）。

我的 BookSize 类

```
public class BookSize
{
    public virtual string ID { get; set; }
    public virtual string Name { get; set; }
    public virtual double Length { get; set; }
    public virtual double Width { get; set; }
} 
```

对应的ClassMap

```
public class BookSizeMap : ClassMap<BookSize>
{
    public BookSizeMap()
    {
        Id(x => x.ID);
        Map(x => x.Name);
        Map(x => x.Length);
        Map(x => x.Width);
    }
} 
```

我的 BookSizesManager 类

```
public class BookSizesManager
{
    public virtual string Id { get; set; }

    private IList<BookSize> m_bookSizes = new List<BookSize>();
    public virtual IList<BookSize> Items
    {
        get { return new ReadOnlyCollection<BookSize>(m_bookSizes); } 
        set { if(value != null) m_bookSizes = value; }
    }

    public virtual void Add(BookSize size)
    {
        if (size != null)
        {
            m_bookSizes.Add(size); 
        }
    }// Also contains other unimplemented CRUD methods, but haven't listed them here to reduce 'noise'
} 
```

对应的ClassMap

```
public class BookSizesManagerMap : ClassMap<BookSizesManager>
{
    public BookSizesManagerMap()
    {
        Id(x => x.Id);
        HasMany(x => x.Items)
            .Cascade.All();
        Table("BookSizes");
    }
} 
```

任何帮助是极大的赞赏。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T08:52:57.573

我会完全摆脱`BookSizesManager`并直接使用会话并明确指定表名

```
public class BookSizeMap : ClassMap<BookSize>
{
    public BookSizeMap()
    {
        Table("BookSizes");
        ...
    }
} 
```

`BookSizesManager.Add(booksize);`变成`session.Save(booksize);` `BookSizesManager.Get(booksizeId);`变成`session.Get(booksizeId);`

# java - (Java) Heapsort - 实现不对半个元素进行排序？

> ID：13214910
> 
> 赞同：2
> 
> 时间：2012-11-04T00:28:08.617
> 
> 标签：java, algorithm, list, sorting, heapsort

我今天写了两种不同的 heapsort 实现，都给了我相同的结果：

```
Object i: 18
Object i: 11
Object i: 10
Object i: 9
Object i: 8
Object i: 3
Object i: 7
Object i: 1
Object i: 4 
```

现在我在[这里](http://www.codecodex.com/wiki/Heapsort#Pseudocode)用这个页面检查了我的代码；并相信我的一个实现与伪代码所建议的完全相同，而另一个与 Java 实现之一非常相似。

我想强调一个事实，我实际上写了两个不同的版本，并根据我能找到的实现来检查它们！所以我现在真的很难过！我已经用调试器逐步完成了几次 - 但可能在此过程中必须有一些东西？我什至制作了一个调试功能，它只是循环遍历列表并使用输出内容`System.out.println()`- 但这仍然没有太大帮助！

该算法正在处理一个列表 - 在这个阶段我没有做*任何*优化它；目前这只是一个实验。我有 QuickSort、BubbleSort 和插入排序的工作实现——但是这个让我很难过！

我的第一个实现如下：

```
public static List<Integer> execSort(List<Integer> s) {

    int n = (s.size()-1);
    Integer t;

    for(int i = n/2; i>0; i--){
        s = downheap(s, i, n);
    }

    while(n >= 1){
        t= s.remove(0);
        s.add(0, s.remove(n-1));
        s.add(n-1, t);

        n--;
        s = downheap(s, 1, n);
    } 

    return s;
}

public static List<Integer> downheap(List<Integer> s, int i, int n){
    Integer t = s.get(i-1);
    int j;

    while( i <= n/2 ){  
        j = i*2;

        if( (j<n) && (s.get(j-1) < s.get(j)))
            j++;

        if( t >= s.get(j-1)){
            break;
        } else {
            /* Swap them, without using a third variable 
                        - although with all the get()/set() methods
                        it would be better to have a third one, doh! */ 
            s.set(i-1, (s.get(i-1) + s.get(j-1)));
            s.set(j-1, (s.get(i-1) - s.get(j-1)));
            s.set(i-1, (s.get(i-1) - s.get(j-1)));

            i=j;
        }
    }

    s.set(i-1, t);
    return s;
} 
```

您还可以在 Github 上将它们视为 Gists： -[实施 1](https://gist.github.com/4008286) -[实施 2](https://gist.github.com/4008286)

**关于为什么某些元素不想排序的任何想法？**我知道这个实现将是次优的，在 List<> 上工作不会是最好的数据结构，我可能应该考虑使用原始数据类型而不是（ab）使用自动装箱...但这是另一篇文章！我只想要一个工作版本，然后再尝试改进它；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T00:54:15.243

在要点中（您不小心将两者链接到同一个），您有一些错别字

```
public static List<Integer> execSort(List<Integer> s) {

    int start = (s.size()/2)-1;
    int end = s.size()-1;

    while( start >= 0){
        s = sift(s, start, end); 
```

`sift`将计数作为最后一个参数，而不是最后一个索引，因此参数应该是`s.size()`(or `end+1`) 而不是`end`.

```
public static List<Integer> sift(List<Integer> s, int start, int count){

    int root = start;

    while( ((root*2)+1) < 2 ){ 
```

那一定是`while(root*2+1 < count)`，而不是`< 2`。

在你在这里的代码中，你有部分相同的问题（我怀疑是由一个奇怪的索引策略引起的）：

```
 for(int i = n/2; i>0; i--){
        s = downheap(s, i, n); 
```

因为你总是`get(i-1)`resp。`j-1`在 中，您需要或在构建初始堆时`downheap`的上限。`s.size()``n+1`

```
 }

    while(n >= 1){ 
```

这个循环应该只运行 while `n > 1`，否则你会交换最小的元素。

```
 t= s.remove(0);
        s.add(0, s.remove(n-1));
        s.add(n-1, t); 
```

旧根必须放在最后一个位置，即 place `n`，而不是`n-1`, `s.add(n,t)`。

```
 n--;
        s = downheap(s, 1, n);
    } 
```

中`downheap`，决赛

```
 s.set(i-1, t); 
```

是多余的，你总是交换`t`，所以当到达那条线时，元素`i-1`已经是`t`。

# html - 如何创建具有行列的无序列表

> ID：13214911
> 
> 赞同：1
> 
> 时间：2012-11-04T00:28:37.777
> 
> 标签：html, css, html-lists

基本上我想扩展这个[演示](http://www.prodevtips.com/demos/drag_drop_tree/)并将文本节点变成具有多列和相等（固定）宽度的行。一种带有缩进行的经典表格。树（无序列表）现在看起来像这样：

![在此处输入图像描述](../Images/6f48ad2542280df4076c3ab608f39bd4.png)

我想添加一些额外的列：

![在此处输入图像描述](../Images/5b087b785aa81ebafc94301394a76fd8.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T00:48:37.973

如果您更好地解释您的要求，您可能会得到更多的响应和更好的质量。老实说，期望人们点击链接以找出您正在尝试实现的目标是一种自负的小精灵。毕竟，人们出于善意，免费为您提供时间和知识。你能做的至少是让帮助 gou 变得尽可能容易。务必参考链接，但仅作为附加参考点。

只是说......

# java - hadoop 映射器中的配置对象为空

> ID：13214914
> 
> 赞同：0
> 
> 时间：2012-11-04T00:28:55.790
> 
> 标签：java, hadoop

我有以下映射器类。我想在我的映射器函数中写入 hdfs。所以我需要访问我在 setup() 方法中检索的配置对象。但是它被返回为空，我得到一个 NPE。你能让我知道我做错了什么吗？

这是堆栈跟踪

```
 hduser@nikhil-VirtualBox:/usr/local/hadoop/hadoop-1.0.4$ bin/hadoop jar GWASMapReduce.jar /user/hduser/tet.gpg /user/hduser/output3
12/11/04 08:50:17 WARN mapred.JobClient: Use GenericOptionsParser for parsing the arguments. Applications should implement Tool for the same.
12/11/04 08:50:24 INFO mapred.FileInputFormat: Total input paths to process : 1
12/11/04 08:50:28 INFO mapred.JobClient: Running job: job_201211031924_0008
12/11/04 08:50:29 INFO mapred.JobClient:  map 0% reduce 0%
12/11/04 08:51:35 INFO mapred.JobClient: Task Id : attempt_201211031924_0008_m_000000_0, Status : FAILED
 java.lang.NullPointerException
at org.apache.hadoop.fs.FileSystem.getDefaultUri(FileSystem.java:131)
at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:123)
at com.test.GWASMapper.writeCsvFileSmry(GWASMapper.java:208)
at com.test.GWASMapper.checkForNulls(GWASMapper.java:153)
at com.test.GWASMapper.map(GWASMapper.java:51)
at com.test.GWASMapper.map(GWASMapper.java:1)
at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:50)
at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:436)
at org.apache.hadoop.mapred.MapTask.run(MapTask.java:372)
at org.apache.hadoop.mapred.Child$4.run(Child.java:255)
at java.security.AccessController.doPrivileged(Native Method)
at javax.security.auth.Subject.doAs(Subject.java:415)
at     org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1121)
at org.apache.hadoop.mapred.Child.main(Child.java:249)

attempt_201211031924_0008_m_000000_0: ******************************************************************************************************************************************************************************************
attempt_201211031924_0008_m_000000_0: null
attempt_201211031924_0008_m_000000_0: ******************************************************************************************************************************************************************************************
12/11/04 08:51:37 INFO mapred.JobClient: Task Id :     attempt_201211031924_0008_m_000001_0, Status : FAILED 
```

这是我的司机课

```
import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.conf.Configured;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapred.FileInputFormat;
import org.apache.hadoop.mapred.FileOutputFormat;
import org.apache.hadoop.mapred.JobClient;
import org.apache.hadoop.mapred.JobConf;
import org.apache.hadoop.util.Tool;
import org.apache.hadoop.util.ToolRunner;

public class GWASMapReduce extends Configured implements Tool{

/**
 * @param args
 */
public static void main(String[] args) throws Exception {
    Configuration configuration = new Configuration();
    ToolRunner.run(configuration, new GWASMapReduce(), args);
}

@Override
public int run(String[] arg0) throws Exception {
    JobConf conf = new JobConf();
    conf.setInputFormat(GWASInputFormat.class);
    conf.setOutputKeyClass(Text.class);
    conf.setOutputValueClass(Text.class);
    conf.setJarByClass(GWASMapReduce.class);
    conf.setMapperClass(GWASMapper.class);
    conf.setNumReduceTasks(0);
    FileInputFormat.addInputPath(conf, new Path(arg0[0]));
    FileOutputFormat.setOutputPath(conf, new Path(arg0[1]));
    JobClient.runJob(conf);
    return 0;
}
} 
```

映射器类

```
import java.io.IOException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;
import java.util.Map;
import java.util.TreeMap;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.FSDataOutputStream;
import org.apache.hadoop.fs.FileSystem;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.io.LongWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapred.FileSplit;
import org.apache.hadoop.mapred.MapReduceBase;
import org.apache.hadoop.mapred.Mapper;
import org.apache.hadoop.mapred.OutputCollector;
import org.apache.hadoop.mapred.Reporter;

import com.google.common.base.Strings;

public class GWASMapper extends MapReduceBase implements Mapper<LongWritable, GWASGenotypeBean, Text, Text> {

private static Configuration conf;

@SuppressWarnings("rawtypes")
public void setup(org.apache.hadoop.mapreduce.Mapper.Context context) throws IOException {

    conf = context.getConfiguration();
    // conf is null here 
}

@Override
public void map(LongWritable inputKey, GWASGenotypeBean inputValue, OutputCollector<Text, Text> output, Reporter reporter) throws IOException {
    // mapper code
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-14T21:16:12.190

这只是给面临类似问题的其他人的提示：
请确保您首先设置值并声明工作。

例如：

```
Configuration conf = new Configuration(); 
conf.set("a","2"); 
conf.set("inputpath",args[0]);
//Must be set before the below line:
Job myjob = new Job(conf); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T19:01:18.133

我想你错过了这个

```
JobClient jobClient = new JobClient();
client.setConf(conf);

JobClient.runJob(conf); 
```

conf 参数不传递给jobclient。试试这个，看看它是否有帮助

我建议使用新的 mapreduce 库。检查 v2.0 的字数 [http://hadoop.apache.org/docs/mapreduce/r0.22.0/mapred_tutorial.html#Example%3A+WordCount+v2.0](http://hadoop.apache.org/docs/mapreduce/r0.22.0/mapred_tutorial.html#Example%3A+WordCount+v2.0)

也试试这个 `JobConf job = new JobConf(new Configuration());`

我认为配置对象没有在这里初始化。此外，您在配置对象中没有任何特别之处，因此您也可以在映射器中初始化配置对象，但这对于尝试来说并不是一个好习惯

# php - 将评级百分比 (50%) 转换为 PHP 中的等值 5 星评级

> ID：13214917
> 
> 赞同：3
> 
> 时间：2012-11-04T00:29:52.133
> 
> 标签：php

我确信这是可能的，但我的数学并不是那么出色。

我在我的页面上显示最新电影，我的应用程序使用 5 星评级系统，但是，我从 Web 服务收到的数据以百分比形式到达，例如 50%。

有什么办法可以将此百分比转换为等值的星级，在这种情况下为 50% = 2.5，允许我显示 2.5 颗星？

当我有 50% 的时候看起来很简单，但如果我有 94​​%，它会把我可怜的小豌豆弄糊涂了！请帮忙。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-04T00:31:17.233

如果要将`0..100`比例转换为`0..5`比例，只需除以 20。

如果您希望它位于半星边界上，则将其除以，这`10`就是您需要的半星数。

请记住，我在这里谈论的是*整数*除法，其中值被截断（向下舍入）。

您可能还想考虑在除法期间更智能地舍入它，而不是截断，这样 99% 之类的东西就是 5 颗星（而不是 4.5 颗星）。这可以通过简单地在除法之前添加一半的量来完成，例如（在 C 中）：

```
int percent = 94;
int halfstars = (percent + 5) / 10; 
```

对于介于 0 和 100 之间的输入值，这将给出以下结果：

```
percent     halfstars
-------     ---------
  0-  4         0
  5- 14         1
 15- 24         2
 25- 34         3
 35- 44         4
 45- 54         5
 55- 64         6
 65- 74         7
 75- 84         8
 85- 94         9
 95-100        10 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T00:32:15.363

计算百分比的公式相当简单：

```
$percentInDecimalForm * $number 
```

例如，94% 的评分将是：

```
.94 * 5 = 4.7 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T00:38:09.977

您只需要解决以下问题：

```
100% ---------- 5
 94% ---------- x = (94 * 5) / 100 (=) x = 4.7 
```

现在有必要知道你的星标的粒度（你可以划分多少次星）。

既然你提到了 0.5 颗星，我会假设你的星粒度是 1 / 0.5 = 2，所以只需解决：

```
round(4.7 * 2) / 2 (=) 9 / 2 (=) 4.5 
```

# image - 如何将图像保存到 .war 文件？

> ID：13214919
> 
> 赞同：1
> 
> 时间：2012-11-04T00:30:24.123
> 
> 标签：image, servlets, save, war, executable-jar

我有一个 Java 项目，旨在让用户登录并将图像上传到服务器；Flickr 模型。我可以将用户上传的照片保存在 JBoss 默认服务器目录中，但是有没有办法将它们保存在 .war 文件中？我意识到我无法在使用时将图像保存到 war/jar 文件中的 ./data 文件夹，但是如何将它们保存*在*jar 中呢？我需要下载一些库吗？

# css - gs960网格之间没有空间

> ID：13214920
> 
> 赞同：-1
> 
> 时间：2012-11-04T00:30:37.853
> 
> 标签：css, 960.gs

我正在使用 gs960 并想创建一个具有两个 div 的 container_12，一个是 grid_8，另一个是 grid_4。现在，gs960 通常会在两个 div 之间添加一些边距。在我的设计中，我希望它们之间没有空间。我尝试使用：

```
<div class='grid_8 alpha omega'>
</div>

<div class='grid_4 alpha omega'>
</div> 
```

但似乎 div 不再填充 960px 并且最后一个似乎与第一个重叠。你知道怎么做吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:44:27.507

使用此[生成器](http://www.gridsystemgenerator.com/gs01.php)并将边距设置为**0px**，当然您也可以在 .css 文件中执行此操作。

# groovy - 下面解释关于 Groovy 闭包的语句。

> ID：13214924
> 
> 赞同：1
> 
> 时间：2012-11-04T00:31:08.903
> 
> 标签：groovy

我正在读这个：`A closure looks a lot like a regular Java or Groovy code block, but actually it's not the same. The code within a regular code block (whether its a method block, static block, synchronized block, or just a block of code) is executed by the virtual machine as soon as it's encountered. With closures the statements within the curly brackets are not executed until the call() is made on the closure. In the previous example the closure is declared in line, but it's not executed at that time. It will only execute if the call() is explicitly made on the closure`

我在想，这是怎么回事，在Java中，如果你有一个实例方法，代码只在调用该方法时执行，那么他们怎么说上面的VM一看到它就执行？如果我有一个方法`func(){int a =5; return a+5;}`，我的理解是只有在调用时才会执行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T05:07:21.360

仅使用同步块或常规范围大括号可能会更好地进行描述。它试图表明的是，当执行线程遇到常规代码块时，它会继续执行内容。使用闭包定义，块中的代码不会立即执行 - 它用于定义/实例化包含该逻辑的闭包对象（例如，clos），稍后可以通过 clos.call() （或只是 clos( ））。

例子：

```
def x = 1

synchronized(this) {
    x = 1000
}
println x //x == 1000 
```

对比

```
def x = 1

Closure clos = { 
    x = 1000
}
println x // x == 1
clos()  // or clos.call()
println x // x == 1000 
```

W/R/T 方法/静态块：我不清楚是否有一些细微的方式可以在 JVM 上下文中使用“遇到”和“执行”来使语句的那一部分正确，但出于实际目的，这充其量是误导。方法仍然只在调用时执行，而不是因为它们的声明位于代码执行的明显路径中，因为可以在 groovyConsole 中运行以下内容来显示：

```
def x = 1

void methodA() {
    x = 1000
}

def b = {
    x = x + 1

}

println x // x is still 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T14:14:51.387

另一个在技术上不一定准确的类比是将闭包视为具有单个方法（闭包的主体）的匿名内部类。

执行closure.call() 或closure()（call() 的简写），调用该单一方法。

当然，闭包还有其他特性，但我认为这是思考基础知识的好方法。

# variables - Lua将多个变量插入表中

> ID：13214926
> 
> 赞同：1
> 
> 时间：2012-11-04T00:31:11.807
> 
> 标签：variables, insert, lua, lua-table

我的问题是如何（或是否）可以将两个值插入到 lua 表中。

我有一个返回的函数（可变数量的值）

```
function a(x, y)
   return x, y
end 
```

以及另一个将指向表插入的函数，

```
function b(x, y)
   table.insert(myTable, x, y)
end 
```

那么我怎样才能使我可以使用可变数量的参数调用函数 b 并将它们全部插入我的表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T01:14:53.893

该[`select`](http://www.lua.org/manual/5.1/manual.html#pdf-select)函数对可变参数进行操作`...`

```
function b(...)
  for i = 1, select('#',...) do
    myTable[#myTable+1] = select(i,...)
  end
end 
```

例如，

```
> myTable = {'a','b'}
> b('c','d')
> for i = 1, #myTable do print(myTable[i]) end
a
b
c
d
> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T01:04:14.397

如果函数的最后一个参数是`...`（称为 vararg 函数），Lua 解释器会将任何额外的参数放入`...`. 您可以使用将其转换为表`{...}`并将键/值复制到名为`myTable`. 这是您的功能的样子：

```
function b(...)
  for k, v in pairs({...}) do
    myTable[k] = v
  end
end

b(1, 2) -- {[1] = 1, [2] = 2} is added to myTable 
```

您应该根据是否要将元素替换、合并或附加到`myTable`.

# c - 用openCL/C实现矩阵乘法

> ID：13214928
> 
> 赞同：0
> 
> 时间：2012-11-04T00:31:16.313
> 
> 标签：c, arrays, matrix, opencl

我了解矩阵乘法的理论，我对这个特定的内核实现只有两个问题：

作为参考，num_rows = 32。矩阵 B (b_mat) 之前已经被另一个内核转置，所以据我所知，我们将行向量点在一起。

1）为什么我们需要使用参数“vectors_per_row”以及内部循环？我以为我们可以只做 sum += dot(row of A, row of B)，看起来这个参数正在将行分成更小的部分（为什么？）。

2）我不明白a_mat和b_mat的地址偏移量，即a_mat += start；b_mat += 开始*4；

```
__kernel void matrix_mult(__global float4 *a_mat,
   __global float4 *b_mat, __global float *c_mat) {
   float sum;
   int num_rows = get_global_size(0);
   int vectors_per_row = num_rows/4;
   int start = get_global_id(0) * vectors_per_row;    
   a_mat += start;                                          
   c_mat += start*4;                                  
   for(int i=0; i<num_rows; i++) {             
      sum = 0.0f;                                      
      for(int j=0; j<vectors_per_row; j++) {   
         sum += dot(a_mat[j],                  
                b_mat[i*vectors_per_row + j]); 
      }                                     
      c_mat[i] = sum;                           
   }                                        
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T00:38:17.637

1.  您的矩阵由一组 float4 组成。Flaoa4 是 4 个浮点数的向量。这就是 4 的由来。Dot 仅适用于内置类型，因此您必须在 float4 上执行此操作。

2.  c_mat 是 float 类型，这就是为什么它有 start*4 而 a_mat 有 start。偏移量是因为代码被分成几个（可能数百个）线程。每个线程只计算乘法运算的一小部分。`start`只是线程开始计算的地方。这就是 get_global_id(0) 的用途。它本质上是获取你的线程 ID。从技术上讲，它是第一个维度的线程索引，但看起来您只有一个线程维度，所以在这里您可以将其视为线程 ID。

# android - Android 调用主屏幕启动器的 onNewIntent()

> ID：13214937
> 
> 赞同：1
> 
> 时间：2012-11-04T00:32:45.923
> 
> 标签：android, android-intent, android-activity

我了解到，当调用 onNewIntent() 时，Android 启动器会将主屏幕重置为默认页面。我知道当活动已经在前台接收另一个开始意图时调用 onNewIntent() 。有没有办法在后台调用活动的 onNewIntent() ？

我尝试了几个标志，如 FLAG_ACTIVITY_CLEAR_TOP、FLAG_ACTIVITY_SINGLE_TOP 和 FLAG_ACTIVITY_REORDER_TO_FRONT，但似乎没有一个会调用 onNewIntent。

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T01:33:01.097

试试这个，它会帮助你，

```
Intent intent = new Intent(MainActivity.this, TargetActivity.class);
intent.setAction(Intent.ACTION_VIEW);
intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
MainActivity.startActivity(intent); 
```

# javascript - 将 Bookmarklet 放入网页

> ID：13214938
> 
> 赞同：1
> 
> 时间：2012-11-04T00:33:00.150
> 
> 标签：javascript, bookmarklet

我有一个以以下开头的书签代码：

```
*javascript:var%20nodeaddpath="http://www..................* 
```

并以：

```
*bout:blank"==l?nourl():a();;void(0);* 
```

我没有在开始和结束之间写代码，因为它们不需要写。现在我想将此书签插入其他网页，即 html 页面，当访问者单击它时，它看起来像一个链接，它与浏览器书签栏上的链接完全一样。我在 stackoverflow 和其他网站上阅读了许多教程，但由于它们不是一步一步的，我无法使用它们。请逐步为我解释所有细节，因为我是编程新手，我可以将此书签插入网页。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T02:40:54.260

据我所知，书签只是一段 JavaScript。您以一种好像它存在并在页面上执行的方式对其进行编程。换句话说，就像它只是一个普通的脚本一样编写它。

页面上的小书签与从书签栏运行的小书签没有区别。它们只是通过地址栏运行的“后处理”JavaScript。

因此，给定一个书签脚本：

```
javascript:(function(){alert('hi');}()); 
```

您可以将其嵌入到页面中，例如：

```
<a href="javascript:(function(){alert('hi');}());">Say Hi!</a> 
```

尝试将链接拖到书签栏并单击它，它会做同样的事情。

# php - Symfony 1 - 来自嵌入表单的管理生成器值

> ID：13214941
> 
> 赞同：1
> 
> 时间：2012-11-04T00:33:16.700
> 
> 标签：php, symfony1, doctrine, propel

```
JobeetCategory:
  actAs: { Timestampable: ~ }
  columns:
    name: { type: string(255), notnull: true, unique: true }
    test: { type: string(255), notnull: true, unique: true }

JobeetJob:
  actAs: { Timestampable: ~ }
  columns:
    category_id:  { type: integer, notnull: true }
    type:         { type: string(255) }
    company:      { type: string(255), notnull: true }
  relations:
    JobeetCategory: { onDelete: CASCADE, local: category_id, foreign: id, foreignAlias: JobeetJobs } 
```

在 JobeetJobForm 中，我添加了：

```
$cat = new JobeetCategory();
$this->embedForm('category', $cat); 
```

我生成了管理员。

现在我可以从这些表单中获取所有小部件。我可以在 generator.yml 中更改它。有位置**表格**

```
 form:
    display:
      One: [category_id, type]
      Two:   [company, test] // test - not working 
```

我有错误小部件测试不存在。如何在生成器中使用嵌入表单？

我尝试：

```
 form:
    display:
      One: [category_id, type]
      Two:   [company, JobeetCategory[test]] 
```

但这也行不通。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T13:14:35.813

您不能从嵌入表单中添加单独的字段，您应该将整个嵌入表单添加到显示键。

```
 form:
    display:
      One: [category_id, type]
      Two: [company, category] 
```

# javascript - 输入焦点时运行函数的Javascript

> ID：13214943
> 
> 赞同：1
> 
> 时间：2012-11-04T00:35:19.710
> 
> 标签：javascript

当用户在输入框（焦点）内单击时，运行函数的代码是什么，例如称为“myfunction”。

我已经在 jquery 中看到了示例，但我看不到如何使用直接的 javascript 来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T00:37:42.000

使用 onfocus 属性

```
<input type="text" onfocus="someFunc()">

<script>
  function someFunc(){

  }
</script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T00:42:12.907

```
var addEvent = (function(){
  /// addEventListener works for all modern browsers
  if ( window.addEventListener ) {
    /// I'm returning a closure after the choice on which method to use
    /// has been made, so as not to waste time doing it for each event added.
    return function(elm, eventName, listener, useCapture){
      return elm.addEventListener(eventName,listener,useCapture||false);
    };
  }
  /// attachEvent works for Internet Explorer
  else if ( window.attachEvent ) {
    return function(elm, eventName, listener){
      /// IE expects the eventName to be onclick, onfocus, onkeydown (and so on)
      /// rather than just click, focus, keydown as the other browsers do.
      return elm.attachEvent('on'+eventName,listener);
    };
  }
})(); 
```

使用上面的跨浏览器功能，您可以执行以下操作（一旦 dom 完全加载）：

```
addEvent(document.getElementById('your_input'),'focus',function(e){
  var input = e.target || e.srcElement;
  alert('this input has gained focus!');
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T00:37:07.107

```
document.getElementById("elementId").addEventListener("focus",function(e){
 //Do Something here
}); 
```

# jquery - fancybox 没有使用 ajax 请求正确的页面

> ID：13214944
> 
> 赞同：0
> 
> 时间：2012-11-04T00:35:19.727
> 
> 标签：jquery, ajax, fancybox

```
$(document).ready(function() {
        $(".modalbox").fancybox({

  type: 'ajax',
  ajax : {
        type    : "GET",
        URL: 'requestajax.php',
        data    : {cid:'3'},
        error: function(){
    alert('failure');
  }
    }
}); 
```

所以这是我的代码，当我使用 firebug 时，我看到数据正在传递（在参数下），但请求的 url 是同一个文件 index.php 而它应该说 requestajax.php?cid=3 任何想法？我想我做错了什么。模态框加载了 index.php 内容而不是 requestajax.php。那是问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T12:43:17.017

尝试将您的 URL 设置为`href`参数：

```
$(".modalbox").fancybox({
    href : 'requestajax.php',
    type : 'ajax',
    ajax : {
        type  : "GET",
        data  : {cid:'3'},
        error: function(){
            alert('failure');
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T00:54:09.143

我认为

```
URL: 'requestajax.php', 
```

必须是这样的小写：

```
url: 'requestajax.php', 
```

无论如何，您必须小心 JavaScript 中的选项，因为 onStart 与 onstart 不同。

如果不是这种情况，请尝试将绝对 url 添加到您的 fancybox 中，例如：

```
url: '/requestajax.php', 
```

# ruby-on-rails - Rails 在请求 Javascript 时使用 HTML 视图

> ID：13214948
> 
> 赞同：1
> 
> 时间：2012-11-04T00:36:40.150
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我要求提供 JS 文件但 Rails 提供 HTML 文件的奇怪问题。而且它只在我的登台服务器（Heroku）上，而不是在我的本地机器上。

我有一个动态 Javascript 文件，需要通过脚本将其包含在其他页面中，以便如下所示：

```
<script type="text/javascript" src="http://example.com/embed.js></script> 
```

该嵌入映射到也处理 HTML 的控制器和操作。相关路线如下所示：

```
match "/embed(.:format)" => "articles#embed", as: "embed" 
```

控制器动作非常标准。

```
def embed
  respond_to do |format|
    format.html do
      #it renders some HTML
    end
    format.js #no block is given
  end
end 
```

而且，我在 app/views/articles 下有两个视图

*   嵌入.html.haml
*   嵌入.js.coffee

在我的本地机器上，请求 localhost:3000/embed.js 有效。它可以毫无问题地呈现 Javascript。但是，在我的登台服务器上，这是我在日志中看到的内容：

```
Started GET "/embed.js" for 124.168.219.36 at 2012-11-04 00:23:01 +0000
Processing by ArticlesController#embed as JS
  Rendered articles/embed.html.haml (1.5ms)
Completed 500 Internal Server Error in 2ms 
```

内部服务器错误不是问题。问题在于它将请求识别为 JS，但决定*仅*在暂存时呈现 HTML 模板。

这是怎么回事？

# c - SysV 信号量是否在文件系统中表示？

> ID：13214950
> 
> 赞同：1
> 
> 时间：2012-11-04T00:36:44.940
> 
> 标签：c, key, shared-memory, semaphore

调用是否会`semget()`导致在文件系统的某处创建唯一文件？我正在尝试使用信号量作为共享内存段的密钥，并认为 ftok() 可能是一个可行的选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:41:23.453

不会。System V IPC 对象（信号量、消息队列和共享内存）存在于与文件系统不同的命名空间中。

# java - Tomcat作为服务无法使用系统剪贴板？

> ID：13214960
> 
> 赞同：0
> 
> 时间：2012-11-04T00:37:45.780
> 
> 标签：java, tomcat, service

我做了一个密码管理器作为java web应用程序（确切地说是Tapestry），想法如下，当你点击密码标签旁边的按钮时，匹配的密码应该被复制到系统剪贴板。当我以标准方式启动tomcat（运行startup.bat）时，它可以完美运行，但这不是我所需要的。我需要我的 tomcat 在启动时作为 Windows 服务启动，但在这种情况下，我的应用程序中的所有内容都可以正常工作，除了应对剪贴板。没有错误发生，我在日志中也没有任何错误，文本只是没有复制。有人可以告诉我为什么会这样，什么会导致这种行为？可能是该服务没有权利弄乱剪贴板，如果是这样，我可以让它工作吗？欢迎任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:52:22.560

当 tomcat 作为服务运行时，如果用户链接到主窗口 GUI，它不会运行，因此所有 awt 功能都被禁用。让他们中的一些人回来的唯一方法是添加

```
-Djava.awt.headless=true 
```

to the tomcat startup parameters - see [http://support.sas.com/kb/12/599.html](http://support.sas.com/kb/12/599.html) 但是，这可能还不够，因为每个用户都有自己的控制台，所以 tomcat 会复制到自己的用户控制台中 - 你应该使用与本地登录用户相同的用户运行 tomcat，使“作为 .bat 运行”成为最简单的选项。

# perl - 使用 LWP::UserAgent 检索 ISO-8859-1 编码网站的正确方法？

> ID：13214961
> 
> 赞同：2
> 
> 时间：2012-11-04T00:37:59.573
> 
> 标签：perl, encoding, iso-8859-1, lwp-useragent

我正在使用带有以下代码的“LWP::UserAgent”检索“ISO-8859-1”编码的网站。

问题是特殊字符显示不正确，尤其是“€”符号显示错误。

内容编码被识别为“ISO-8859-1”，这是正确的。

为了显示检索到的文本，我将它保存到一个文件中并使用 Notepag++ 打开它。

**问题：**如何以正确的方式检索“ISO-8859-1”编码的特殊字符？

```
 #SENDING REQUEST
my $ua = LWP::UserAgent->new();
$ua->agent('Mozilla/5.0 (Windows NT 6.1; WOW64; rv:15.0) Gecko/20100101 Firefox/15.0.1'); # pretend we are very capable browser

my $req = HTTP::Request->new(GET => $url);

#add some header fields
$req->header('Accept', 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8');
$req->header('Accept-Language', 'en;q=0.5');
$req->header('Connection', 'keep-alive');
$req->header('Host', 'www.url.com');

#SEND
my $response = $ua->request($req);

#decode  trial1
print $response->content_charset(); # gives ISO-8859-1 which is right
my $content  = $response->decoded_content(); #special chars are displayed wrong

#decode trial2
my $decContent =  decode('ISO-8859-1', $response->content());
my $utf8Content = encode( 'utf-8', $decContent ); #special char € is displayed as Â

#decode trial3
Encode::from_to($content, 'iso-8859-1', 'utf8'); #special char € is displayed as Â too

#example on writing data to file
open(MYOUTFILE, ">>D:\\encodingperl.html"); #open for write, overwrite
print MYOUTFILE "$utf8Content"; #write text
close(MYOUTFILE); 

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T03:57:14.657

和其他一样：

```
my $content = $response->decoded_content(); 
```

也就是说，[iso-8859-1](http://en.wikipedia.org/wiki/Iso-8859-1)字符集不包括欧元符号。你可能实际上有[cp1252](http://en.wikipedia.org/wiki/Windows-1252)。您可以按如下方式解决此问题：

```
my $content = $response->decoded_content( charset => 'cp1252' ); 
```

您的第二个问题是您没有对输出进行编码。这就是你的做法。

```
open(my $MYOUTFILE, '>>:encoding(cp1252)', 'D:\\encodingperl.html')
   or die $!;
print $MYOUTFILE $content; 
```

`UTF-8`如果不是`cp1252`您想要的，请使用适合您的编码（例如）。如果您想要原始编码的原始文件，请使用

```
my $content = $response->decoded_content( charset => 'none' ); 
```

和

```
open(my $MYOUTFILE, '>>', 'D:\\encodingperl.html')
   or die $!;
binmode($MYOUTFILE);
print $MYOUTFILE $content; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T00:55:10.810

ISO-8859-1 没有欧元符号。如果您需要欧元符号，您应该使用 ISO-8859-15，或者更好的是 UTF-8。

# c# - 在类和对象之间使用枚举器

> ID：13214969
> 
> 赞同：0
> 
> 时间：2012-11-04T00:38:47.837
> 
> 标签：c#, struct, foreach, enumerator

我在一个对象中有一个结构数组。我想使用 foreach 循环将数组中的每个结构传递给类，以便我可以显示类中的每个结构。这是对象中传递 struct 的代码：

```
public IEnumerator recup_voitures()
{
    foreach (voiture v in _arrVCollection)
    {
        yield return (v);
    }
} 
```

我尝试使用以下方法在课堂上恢复这些：

```
foreach (CarCollection.voiture o in collection.recup_voitures())
{
   //some console.writeline to display whats inside each struct 
} 
```

这不起作用。我收到一个错误，说它没有公共 GetEnumerator。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T00:39:30.817

您需要返回一个**IEnumer**。（最好`IEnumerable<T>`）

`foreach`操作（看起来像的对象）`IEnumerable<T>`并调用`GetEnumerator()`枚举集合。

# actionscript-3 - AS3：从嵌入的移动剪辑返回到主时间轴中的场景

> ID：13214971
> 
> 赞同：1
> 
> 时间：2012-11-04T00:39:19.727
> 
> 标签：actionscript-3, flash

所以基本上，我有一个名为 homeButton 的影片剪辑，嵌入在另一个名为 overlay 的影片剪辑中。此叠加层放置在电影中的每个场景上。我想要发生的是，当从任何场景中单击 homeButton 时，返回场景“floorSelect”

在覆盖符号中，我有动作脚本：

```
homeButton.addEventListener(MouseEvent.CLICK, homeButtonClicked);

function homeButtonClicked(e:MouseEvent):void
{
    parent.gotoAndPlay(1, "floorSelect");
} 
```

我猜我的错误是在 gotoAndPlay 中，我尝试过：

```
root.gotoAndPlay(1, "floorSelect");
parent.parent.gotoAndPlay(1, "floorSelect"); 
```

在此先感谢，J

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T01:36:49.357

你试过这些吗？

```
MovieClip(root).gotoAndPlay(1,'floorSelect');
// or
MovieClip(parent).gotoAndPlay(1,'floorSelect'); 
```

# php - 如何在 MySql 表中以某个 id 回显图像？

> ID：13214980
> 
> 赞同：0
> 
> 时间：2012-11-04T00:40:53.347
> 
> 标签：php, mysql, image, blob

我在尝试在我的商店表中显示 ID：2 处的图像时遇到了一点麻烦......

这就是我想出的（ps 我设置 $id = 2 的原因是因为我计划将此作为一个循环，我将在其中增加该值以打印其他图像）

```
<!DOCTYPE html>
<html>
<head>
<title>Gallery</title>
</head>

<body>
<?php

mysql_connect   ...
mysql_select_db   ...

$id = 2;
$image = mysql_query("SELECT * FROM store WHERE id=$id");
$image = mysql_fetch_assoc($image);
$image = $image['image'];
echo $image;

?>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T00:43:51.177

首先，一些警告：

*   不要使用`mysql_*`函数
*   不要在 SQL 中存储图像。存储位置。（您可能已经这样做了）。

如果要存储位置，则需要将`<img>`标签添加到`echo`

```
echo "<img src='$image'>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T00:42:23.983

也许您还需要回显标记？

```
echo '<img src="'.$image.'">'; 
```

# ssl - RijndaelManaged 和 ServicePointManager 的安全性

> ID：13214981
> 
> 赞同：1
> 
> 时间：2012-11-04T00:40:54.657
> 
> 标签：ssl, rijndaelmanaged, servicepointmanager

我有一个关于**RijndaelManaged**和 **ServicePointManager**的安全问题。

我已经实现了一个系统，其中 C# 应用程序正在加密数据，例如用户凭据和一些 XML 数据。然后我使用 WebClient 将加密的用户凭据和一些包含指令的加密 XML 文档一起发送到我的 Tomcat Java Web 应用程序。Java 应用程序的工作：解密用户凭证和 XML 指令——执行指令并用加密的 XML 结果响应 C#。

从我的 C# 应用程序到 Tomcat 服务器的所有连接都启用了 SSL（目前为自签名证书）。

**第一个问题：** 鉴于我的 C# 应用程序默认情况下总是连接到我的服务器（仅）启用 SSL。我可以简单地将回调函数实现为：

ServicePointManager.ServerCertificateValidationCallback = 委托 { 返回真；};

据我了解，回调函数用于识别和验证我正在连接的服务器使用的证书。如果我将该应用程序提供给——比如我的一个客户连接到我的服务器（启用 SSL）——上面的代码是否令人满意？如果客户端使用我的应用程序连接到另一个未知的服务器并且我不知道它的 SSL 证书状态 - 上面的代码应该替换为实际的证书验证函数。我的问题有意义吗？

**第二个问题：** 我在我的 C# 应用程序中使用 RijndaelManaged 实现了加密/解密。但我使用的密钥是 C# 应用程序的一部分——应用程序被混淆了。据我了解，这不是一种安全的方式。

C# 应用程序是否有可靠的方法从我的 Web 应用程序接收加密/解密密钥。或者有没有办法在 C# 应用程序中生成密钥，Web 应用程序可以使用它来解密数据 - 如果是这样：我如何生成该密钥，最重要的是如何以可靠的安全方式将其发送到服务器方法。由于连接是 SSL - 密钥可以只是加密流的一部分吗？

这是我在 C# 应用程序中用于加密的代码。

```
private const string KEY = "samplekey";
private const int KEY_SIZE = 128;
private const int KEY_BITS = 16;
private string Encrypt(string textToEncrypt)
{
    RijndaelManaged rijndaelCipher = new RijndaelManaged();
    rijndaelCipher.Mode = CipherMode.CBC;
    rijndaelCipher.Padding = PaddingMode.PKCS7;

    rijndaelCipher.KeySize = KEY_SIZE;
    rijndaelCipher.BlockSize = KEY_SIZE;

    byte[] pwdBytes = Encoding.UTF8.GetBytes(KEY);
    byte[] keyBytes = new byte[KEY_BITS];

    int len = pwdBytes.Length;
    if (len > keyBytes.Length)
    {
        len = keyBytes.Length;
    }

    Array.Copy(pwdBytes, 0, keyBytes, 0, len);
    rijndaelCipher.Key = keyBytes;
    rijndaelCipher.IV = keyBytes;

    ICryptoTransform transform = rijndaelCipher.CreateEncryptor();
    byte[] plainText = Encoding.UTF8.GetBytes(textToEncrypt);

    return System.Convert.ToBase64String(transform.TransformFinalBlock(plainText, 0, plainText.Length));
} 
```

# php - 如果（事件）然后将数组设置为空？

> ID：13214983
> 
> 赞同：0
> 
> 时间：2012-11-04T00:42:01.377
> 
> 标签：php, arrays, if-statement

我有一个进行选择的 MySQL 查询。然后我有一个`$numrows`变量，我设置为`$numrows = mysql_num_rows($query);`. 如果 的值`$numrows == 0`，我希望我必须将数组变量设置为空。我尝试将数组变量设置为`null`，`"";`但那些不起作用。有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T00:43:55.523

清空数组

```
$array= array(); 
```

彻底删除

```
unset($array); 
```

# java - 是否可以使用 java 套接字从客户端发送 sslv2 hello 消息

> ID：13214987
> 
> 赞同：1
> 
> 时间：2012-11-04T00:42:35.840
> 
> 标签：java, ssl, network-programming

是否可以发送 sslv2 hello 消息？当我尝试与远程服务器启动 ssl 握手时，默认版本是`TLS`. 我需要测试服务是否接受 sslv2，因此，我需要强制我的 Java 程序发送 sslv2 hello 消息。这可能吗？如何？请注意，我需要这个仅用于测试。我不是在做一个真正的 Java 应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T07:27:13.877

Sun/Oracle Java 从未支持 SSLv2。它确实支持 SSLv2ClientHello*消息*，出于兼容性目的，协商 SSLv3 或更高版本，但我认为在 1.7 中已撤回。IBM Java 曾经支持 SSLv2，但我不能代表当前版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T16:18:30.947

不支持 SSLV2，如果您需要强制`SSLv2Hello`消息，您可以设置系统属性：

```
System.setProperty("https.protocols", "SSLv3,SSLv2Hello"); 
```

或者您可以直接管理您的套接字：

```
SSLContext context = SSLContext.getInstance("TLSv1");
SSLSocketFactory sslsocketfactory = (SSLSocketFactory) SSLSocketFactory.getDefault();
SSLSocket sock = (SSLSocket) sslsocketfactory.createSocket("hostserver", 443);
String[] protocols = {"SSLv2Hello", "SSLv3", "TLSv1"}; 
```

# windows-phone-8 - 检测页面中的点击？

> ID：13214994
> 
> 赞同：0
> 
> 时间：2012-11-04T00:43:28.693
> 
> 标签：windows-phone-8

我有`PhoneApplicationPage`一些网格、图像和一些按钮。如果我在按钮外点击页面中的任何位置（在图像、网格或其他任何地方），我想打开一个新页面。

如何检测页面上任意位置的点击/单击？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T09:31:48.120

我看到至少有两种方法可以做到这一点：

1.  在`MouseLeftButtonUp`您的`PhoneApplicationPage`. 它应该由图像和标签触发，而不是由按钮触发
2.  在`Tap`您的`PhoneApplicationPage`. 但是，即使用户点击按钮，也会触发此事件。为了防止这种情况，您可以在事件处理程序中检索点击坐标处的控件列表，并仅在没有按钮时打开新页面：

    ```
    private void PhoneApplicationPage_Tap(object sender, System.Windows.Input.GestureEventArgs e)
    {
        var element = (UIElement)sender;

        var controls = VisualTreeHelper.FindElementsInHostCoordinates(e.GetPosition(element), element);

        if(controls.OfType<Button>().Any())
        {
            return;
        }

        // Open the new page
    } 
    ```

# php - 内容分析 - 给定术语相关性分数

> ID：13214997
> 
> 赞同：1
> 
> 时间：2012-11-04T00:43:48.790
> 
> 标签：php, terminology, yahoo-api, opencalais

我们正在考虑使用现有的内容分析服务 API 来返回文章中给定的术语相关性分数。

发现了一些非常好的内容分析服务，例如：

1.  雅虎内容分析服务
2.  开加来...

但是，我们正在寻找一种方法来返回给定的术语相关性分数

例如，

我们有一个词汇表——主题包含“成本”、“政府”

和一个页面[http://www.test.dev/article/1.html](http://www.test.dev/article/1.html)

然后我们想使用内容分析服务来检查文章中主题的相关性

所以我们可以决定从我们自己的词汇表中自动标记文章。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T19:58:38.630

您提到的[雅虎内容分析服务](http://developer.yahoo.com/search/content/V2/contentAnalysis.html)可用于识别相关链接和其他元数据。如果您专门寻找词汇术语，您可以尝试使用[Yahoo Term Extraction 服务](http://developer.yahoo.com/search/content/V1/termExtraction.html)。它接受源文本和查询词。

这是 YQL 控制台中显示的演示查询：

[`select * from search.termextract where context="Italian sculptors and painters of the renaissance favored the Virgin Mary for inspiration" and query="madonna"`](http://developer.yahoo.com/yql/console/?q=select%20%2a%20from%20search.termextract%20where%20context%3D%22Italian%20sculptors%20and%20painters%20of%20the%20renaissance%20favored%20the%20Virgin%20Mary%20for%20inspiration%22%20and%20query%3D%22madonna%22)

和样本结果：

```
"results": {
 "Result": [
  "Italian sculptors",
  "the Virgin Mary",
  "painters",
  "the renaissance"
 ]
} 
```

一个重要的警告：雅虎曾表示，Term Extraction 服务将在某个时候关闭。相反，他们建议新开发使用内容分析服务。（[来源](http://developer.yahoo.com/search/content/V1/termExtraction.html)）

如果您想在相同的上下文中尝试该服务结果，还有 OpenCalais 的 YQL 表。