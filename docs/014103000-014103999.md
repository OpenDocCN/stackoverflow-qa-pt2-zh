# StackOverflow 问答 14103000-14103999

# ruby - 安装 ruby gem（没有写权限）？

> ID：14103000
> 
> 赞同：3
> 
> 时间：2012-12-31T14:51:09.300
> 
> 标签：ruby, rubygems

尝试安装 sass 时出现此错误我应该在安装语句之前使用 sudo 吗？

```
rd-macbook-pro:~ redres$ gem install css_parser
ERROR:  While executing gem ... (Gem::FilePermissionError)
    You don't have write permissions into the /Library/Ruby/Gems/1.8 directory.
rd-macbook-pro:~ redres$ 
```

谢谢， 丰富

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T14:59:22.060

是的，您可以使用 sudo 或设置 gem 路径

```
mkdir -p /Users/redres/.gem/ruby/1.8
export GEM_PATH=/Users/redres/.gem/ruby/1.8
export GEM_HOME=/Users/redres/.gem/ruby/1.8 
```

但我强烈建议尝试使用 RVM [https://rvm.io/rvm/install/](https://rvm.io/rvm/install/)

```
curl -L https://get.rvm.io | bash -s stable 
```

安装和

```
rvm requirements 
```

获取更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:53:38.777

如果您没有使用 ruby​​ 版本管理器（如 rvm 或 rbenv），则需要使用`sudo`在系统级别进行安装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-10T09:23:26.233

错误的原因是您没有在终端上以 root 用户身份登录。

如果您已经在终端类型的 Mac 上启用了 root 使用权限（不带 $）

```
$ su 
```

如果您没有 root 用户，则需要使用以下步骤启用它

1.  从 Apple 菜单中选择系统偏好设置...。
2.  从视图菜单中选择用户和组。
3.  单击锁并以管理员帐户身份验证。
4.  单击登录选项...。
5.  单击右下角的“编辑...”或“加入...”按钮。
6.  单击“打开目录实用程序...”按钮。
7.  单击“目录实用程序”窗口中的锁。
8.  输入管理员帐户名和密码，然后单击确定。
9.  从编辑菜单中选择启用根用户。
10.  在密码和验证字段中输入您希望使用的根密码，然后单击确定。

更多内容请访问[http://support.apple.com/kb/ht1528](http://support.apple.com/kb/ht1528)

至少在卡住几个小时后它对我有用。

# oracle - Oracle 获取从包内的选择查询返回的两个变量

> ID：14103001
> 
> 赞同：1
> 
> 时间：2012-12-31T14:51:11.423
> 
> 标签：oracle

我修改了过程以使其更小，但我真的只想运行一次选择查询。这将降低运行程序的成本。如何在不运行两次查询的情况下获得`prevContectID`and 。`nextContentID`这是替换以前的过程，所以我不想更改`IN`，`OUT`所以我不必找到它被调用的每个地方。

```
procedure getSeq(theContentID IN table.contentID%type,
                 prevContentID OUT table.contentID%type, 
                 nextContentID OUT table.contentID%type)
BEGIN

  SELECT myPrev into prevContentID, myNext into nextContentID
    from myTable
   where contentID=theContentID;
  RETURN;
END getSeq; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T14:55:45.977

显示的过程很可能无法编译。使用多个变量的 SELECT ... INTO 的正确语法是：

```
SELECT myPrev, myNext INTO prevContentID, nextContentID
from myTable
where contentID = theContentID; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:55:57.253

您还可以使用游标从中获取值`myTable`。对于您的方法，当 myTable 中不存在时，您需要进行适当的异常处理，`theContentID`因为这会给您带来`NO_DATA_FOUND`异常。

```
PROCEDURE getSeq (theContentID    IN     table.contentID%TYPE,
                  prevContentID      OUT table.contentID%TYPE,
                  nextContentID      OUT table.contentID%TYPE)
IS
   CURSOR getcontentID_cur
   IS
      SELECT myPrev, myNext
        FROM myTable
       WHERE contentID = theContentID;
BEGIN
   OPEN getcontentID_cur;

   FETCH getcontentID_cur
   INTO prevContentID, nextContentID;

   CLOSE getcontentID_cur;
END getSeq; 
```

# delphi - 在 FireMonkey Delphi XE2 中更改 ColumnCount

> ID：14103005
> 
> 赞同：0
> 
> 时间：2012-12-31T14:51:38.257
> 
> 标签：delphi, delphi-xe2, firemonkey, stringgrid

我正在尝试在 Delphi XE2 Firemonkey 中从文件中加载 stringgrid。当我在 Delphi 中这样做时，它看起来像这样：

```
procedure TForm1.File2StringGrid(Sender: TObject);
var
F: TextFile;
 Tmp, x, y: Integer;
TmpStr: string;
begin
AssignFile(F, (ExtractFilePath(ParamStr(0))+'stringgrid1.sgf'));
Reset(F);
Readln(F, Tmp);
StringGrid1.ColumnCount:=Tmp;

Readln(F, Tmp);
StringGrid1.RowCount:=Tmp;
for x:=0 to StringGrid1.ColumnCount-1 do
for y:=0 to StringGrid1.RowCount-1 do
begin
  Readln(F, TmpStr);
  StringGrid1.Cells[x,y]:=TmpStr;
 end;
CloseFile(F);
end; 
```

在 Firemonkey 中出错：[DCC Error] Unit1.pas(179): E2129 Cannot assign to a read-only property in line: StringGrid1.ColumnCount:=Tmp;

任何想法如何解决它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T17:04:52.987

从文档：

```
property ColumnCount: Integer read GetColumnCount;
...
Set ColumnCount to add or delete columns at the right side of the grid. 
```

因此，文档与来源不匹配。

请尝试以下操作：

```
while StringGrid1.ColumnCount < Tmp do
  StringGrid1.AddObject(TStringColumn.Create(StringGrid1)); 
```

# asp.net - SQL 多用户类型数据库

> ID：14103006
> 
> 赞同：0
> 
> 时间：2012-12-31T14:51:42.080
> 
> 标签：asp.net, mysql, database

我需要一个数据库来存储以下信息：

**用户：**名字、姓氏、电子邮件、手机、关于/描述、类型（员工/自由职业者/客户）

**员工：**类型（设计师/FE 开发人员/BE 开发人员/DB 开发人员/SE 乐观主义者）、员工等级
（经理/员工/员工）、从事的项目、正在从事的活动项目、地址、技能（HTML/CSS/JS/ASPX /PHP/DB 开发/SEO/设计）、软件（Photoshop/Illustrator/In-Design/Fireworks/VisualStudio/MSQL/Wordpress）

**自由职业者：**类型（设计师/FE 开发人员/BE 开发人员/DB 开发人员/SE 乐观主义者），从事的项目，正在从事的活动项目，地址，技能（HTML/CSS/JS/ASPX/PHP/DB 开发/SEO/设计），软件（Photoshop/Illustrator/InDesign/Fireworks/VisualStudio/MSQL/Wordpress）

**客户：**拥有的项目、拥有的活动项目、地址（家庭/工作/发票/交付）

**地址 :**门牌号:, 街道地址, 2 号线, 3 号线, 县, 国家, 邮编, 座机

**项目：**标题、客户名称、开始日期、结束日期、截止日期、状态（活动、保留、非活动）、关于、开发团队（从事项目工作的自由职业者或员工的列表）、进度（由里程碑完成：设计/FE /BE/DB/BO/SEO/部署）

基本上，我正在努力解决的问题是如何链接不同类型的地址和用户等。例如，用户可以是：员工或自由职业者或客户，或者员工或自由职业者也可以是客户。我不知道这将如何以数据库格式工作。地址类型等也是如此。

任何帮助？我真的卡住了。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T15:05:14.580

您在询问 RDBMS 设计的基础知识。它有时被称为实体关系设计。这是一个很大的话题。你可能想读一本书。

听起来您需要一个 Person 表，其中有一行描述系统中每个唯一的人。

然后，您可能需要一个包含一行描述每个组织（公司、咨询公司、自由职业实体、客户、提供商等）的组织表。

Person_Organization 表可以将人员与组织联系起来。这将实现人员和组织之间的多对多实体关系。此表可以包含 PersonID、OrganizationID 和描述该人在该组织中的角色的字段。

您可以添加一个包含联系信息（地址、电话号码、电子邮件等）的联系人表。它将在每一行中包含一个 Person id。

您将有一个 Project 表，其中每个项目都有一行。这将包含一个为其标识单个客户的 OrganizationID，以及描述该项目的其他材料。

还有一个角色表，其中每个组织在每个项目中扮演一个角色。

如何处理具有多个联系地址的组织是一项留给您的练习。

请记住，在这种工作中“太聪明就是愚蠢”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T14:59:01.243

您可以使用外键的概念来完成所有这些操作。

通常，一个好主意是为每个表提供一个主键列，该列将用作每行数据的标识符。用户表将具有 UserId，项目表将具有 ProjectId，等等。

从那里，您将外键约束添加到其他表中的列，强制这些行映射到用户。例如，您的 Address 表将有一个名为 UserId 的列，它是 User 表的外键；此键告诉您该行的地址属于相应的用户。

如何构建外键约束取决于您的要求和数据之间的关系；这是您应该弄清楚的事情，以便您能够使用简单的查询访问所有必要的信息。

另外，请记住，您的数据是分层的。您有一个客户、自由职业者和员工，每个人都需要一个地址。但这三个人都是用户。将这些表中的每一个都键入到 User 表中，然后将 Address 表也键入到 User 表中会更有意义。这使您的关系更加灵活和易于理解。

# php - 如何在 mysql_query() 函数中执行多个 MySQL 查询？

> ID：14103017
> 
> 赞同：0
> 
> 时间：2012-12-31T07:27:23.610
> 
> 标签：php, mysql

我在更新表上的记录时遇到问题。以下是详细信息：

我有一个名为 tbl_option 的表，它有 2 个字段 : `option_name`, `option_value`. 当前表记录如下：

```
option_name | option_value
site_name   | MySite
site_desc   | About anything 
```

我想同时更新 site_name 和 site_desc option_value，这是我的 php 脚本来更新`site_name`和`site_desc`option_value：

```
require "include/config.php";
$name = "MyNewSitess";
$desc = "About Computer";

$query = mysql_query("UPDATE tbl_option SET option_value='$name' WHEREoption_name='site_name';# UPDATE tbl_option SET option_value='$desc' WHERE option_name='site_desc'");

if ($query) { echo "Saved"; }
else echo "Not saved : ".mysql_errno()." | ".mysql_error(); 
```

执行后出现以下错误：

> 未保存：1064 | 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'UPDATE tbl_option SET option_value='About Computer' WHERE option_name='site_desc' 附近使用正确的语法

记录未更新。但是当我在第二个 UPDATE 查询之前添加 (#) 时：

```
<?php
...
$query = mysql_query("UPDATE tbl_option SET option_value='$name' WHERE option_name='site_name'; #UPDATE tbl_option SET option_value='$desc' WHERE option_name='site_desc'");
...
?> 
```

它没有显示任何错误。我得到以下信息：

> 已保存

并且记录被更新

问题是什么 ？

是的，我模仿了 wordpress 表的概念，但我不知道如何对表进行 UPDATE 查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T10:25:16.017

从改变

```
$query = mysql_query("UPDATE tbl_option SET option_value='$name' WHEREoption_name='site_name';# UPDATE tbl_option SET option_value='$desc' WHERE option_name='site_desc'"); 
```

到

```
$query = mysql_query("UPDATE tbl_option SET option_value='$name' WHERE option_name='site_name'"); 

if($query) $query = mysql_query("UPDATE tbl_option SET option_value='$desc' WHERE option_name='site_desc'"); 
```

但是，如果这是 WordPress 更新，那么您最好在[此处](https://wordpress.stackexchange.com/)发布此问题。你可能会得到一个更好的解决方案:-)

如果您只执行一次此操作，另一种选择是直接使用控制台或名为 PhpMyAdmin 的流行工具进行更新。

# html - 使用 PSD 或导出的 jpg 作为导航栏

> ID：14103021
> 
> 赞同：0
> 
> 时间：2012-12-31T14:53:21.373
> 
> 标签：html

假设我刚刚制作了一张很棒的图片，打算用作导航栏。我将它导出为 jpg，现在我需要制作实际的导航栏。我最初想到的是图像映射，但这很古老，不支持下拉菜单。我用谷歌搜索，仍然找不到答案。如何使用一张照片作为我的导航栏？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:54:35.500

您可以使用[CSS sprites](http://css-tricks.com/css-sprites/)的技术；将您的精美图片设置`background-image`为菜单标题，并`background-position`用于在每个标题中显示图片的适当部分。

让它达到像素级的完美可能需要大量的实验和耐心。

# android - 如何修复 Android 应用中的 CameraPreview 错误？

> ID：14103029
> 
> 赞同：0
> 
> 时间：2012-12-31T14:54:02.910
> 
> 标签：android

这是我得到的错误，但我没有得到任何关于如何修复它的**快速修复。**它只是给了我错误。我是修复 Android 应用程序错误的新手。

引发错误的代码位：

```
Toast.makeText(CameraPreview2.this, "Cancelled!", Toast.LENGTH_LONG).show(); 
```

错误：

```
The method makeText(Context, CharSequence, int) in the type Toast is not
applicable for the arguments (CameraPreview2<detailLayout>, String, int) 
```

完整的代码是：

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    // TODO Auto-generated method stub
    if (resultCode == RESULT_OK) {
        if (requestCode == 1) {
            uriVideo = data.getData();
            Toast.makeText(CameraPreview2.this, uriVideo.getPath(),
            Toast.LENGTH_LONG).show();
        }
    } else if (resultCode == RESULT_CANCELED) {
        uriVideo = null;
        Toast.makeText(CameraPreview2.this, "Cancelled!", Toast.LENGTH_LONG)
            .show();
    ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T14:58:00.527

不可能用你发布的一点代码说但`Toast.makeText(...)`确实需要一个`Context`（通常类似于`this`or `ClassName.this`。）我不确定你传递了什么，但显然它不是上下文。

# c - 在 Xcode 中同时运行两个 c 程序

> ID：14103046
> 
> 赞同：1
> 
> 时间：2012-12-31T14:55:39.613
> 
> 标签：c, xcode, build, linker

我有两个 c 文件，client.c 和 server.c。在命令行中，我可以编译两者，打开两个终端选项卡，然后合而为一地运行，这样我就可以看到它们是如何相互交互的。它们中的每一个都只包含一个函数，main，它永远运行直到手动终止。

我想通过从 Xcode 运行这些来加快这个过程。我创建了一个名为“exercise”的新项目，其中包含这两个文件以及一些文本和其他文件。但是，当我单击运行时，它给了我一个链接器错误，说符号 _main 是重复的。如何向 XCode 指定我想要运行的 c 文件，或者更好的是，当我单击运行时告诉它独立运行这两个文件？

# c - 自身校验和的 C 代码 *in ram*

> ID：14103061
> 
> 赞同：17
> 
> 时间：2012-12-31T14:57:16.847
> 
> 标签：c, load, embedded, data-integrity

我正在尝试为校验和本身获取一个驻留在内存中的图像，事实证明这说起来容易做起来难。

代码首先在交叉开发平台上编译，生成 .elf 输出。使用实用程序去除二进制映像，并将该映像与映像大小一起刻录到目标平台上的闪存。当目标启动时，它会将二进制文件复制到 ram 的正确区域，然后跳转到该区域。该实用程序还计算精灵中所有用于 ram 的单词的校验和，并将其烧录到闪存中。所以我的图像理论上可以使用先验起始地址和保存在闪存中的大小来校验它自己的内存驻留图像，并与保存在闪存中的总和进行比较。

无论如何，这就是理论。问题是，一旦图像开始执行，`.data`随着变量的修改，该部分就会发生变化。当求和完成时，已求和的图像不再是实用程序计算总和的图像。

我已经消除了由于我的应用程序定义的变量而导致的更改，方法是将校验和例程移动到应用程序中的所有其他初始化之前（这很有意义，因为如果完整性检查失败，为什么要运行它，对吧？），但是杀手是 C 运行时本身。似乎有一些`malloc`与指针转换相关的项目以及在输入之前更改`main()`的其他内容。

自校验和 C 代码的整个想法是蹩脚的吗？如果有办法强制应用程序和 CRT .data 进入不同的部分，我可以避免 CRT 颠簸，但有人可能会争辩说，如果目标是在执行（大部分）图像之前对图像进行完整性检查，那么初始化的 CRT 数据应该成为其中的一部分。有没有办法像这样在 RAM 中制作代码校验和本身？

FWIW，我似乎对此有一个要求。就我个人而言，我认为要走的路是在传输到 ram 之前*对 flash 中*的二进制文件进行校验和，并信任加载程序和 ram。偏执狂必须在某个地方结束，对吗？

其他详细信息：工具链是 GNU，图像包含`.text`，`.rodata`并且`.data`作为一个连续加载的块。没有操作系统，这是嵌入式裸机。主加载器本质上`memcpy`是将我的二进制文件放入 ram 中，位于预定地址。不会发生搬迁。不使用虚拟机。校验和只需要在初始化时测试一次。

* * *

**更新** 发现这样做..

```
__attribute__((constructor)) void sumItUp(void) {
    // sum it up
    // leave result where it can be found
} 
```

..我可以在几乎所有事情之前完成总和，除了 CRT init 对`malloc`/ `sbrk`vars 的初始化，以及“impure.o”和“locale.o”拥有的一些 vars。现在，`malloc`/`sbrk`值是我从项目链接器脚本中知道的。如果 impure.o 和 locale.o 可以得到缓解，可能会做生意。

**更新** 由于我可以控制入口点（通过主加载程序的闪存中所述），现在似乎最好的攻击角度是使用一段自定义汇编代码来设置堆栈和 sdata 指针，调用校验和例程，然后分支到“正常” _start 代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T15:19:12.273

如果校验和足够早地完成，您可以只使用堆栈变量，而不是写入任何数据部分变量 - 也就是说，使您需要执行校验和 [以及到达该点的所有先前步骤] 只使用本地用于存储东西的变量[当然你可以读取全局数据]。

我相当确信正确的方法是相信闪存和加载程序来加载闪存中的内容。如果你想对代码进行校验和，当然，去做[假设它当然没有被加载器修改 - 例如共享库的运行时加载或可执行文件本身的重定位，例如随机虚拟地址空间等]。但是一旦执行正确开始，就不能依赖从闪存加载的数据。

如果其他人要求您执行此操作，请向他们解释执行此操作不可行，并且“目前的要求”已“损坏”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T17:13:15.390

我建议像执行打包程序一样处理这个问题，比如[upx](http://upx.sourceforge.net)。

其他答案和您的问题中有几件事，由于缺乏更好的术语，让我感到紧张。

*   我不会相信装载机或任何非强加于我的闪存中的东西。
*   网上流传着一些源代码，用于保护我认为 HTC 最近推出的手机之一。在 forum.xda-developers.com 上四处看看，看看是否可以找到它并用作示例。
*   我会反对这个要求。手机制造商花费大量时间来锁定他们的图像，最终，他们都被打败了。这似乎是一个恶性循环。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T17:40:02.410

您可以使用链接器脚本将 impure.o 和 locale.o 放置在其他所有内容之前或之后，从而允许您对除这些和 malloc/sbrk 之外的所有内容进行校验和吗？我猜 malloc 和 sbrk 在加载您的应用程序的引导加载程序中被调用，因此无法消除由这些引起的抖动？

仅仅告诉你反对这个要求并不是一个答案，但我同意这似乎是多虑了。我敢肯定你不能详细说明，但我假设规范作者关心的是恶意用户/黑客，而不是由于宇宙射线等导致的常规内存损坏。在这种情况下，如果恶意用户/黑客可以更改加载到 RAM 中的内容，他们可以更改您的校验和例程（它本身是从 RAM 运行的，对吗？）以始终返回快乐状态，无论他们不再运行的校验和例程设计得有多好.

即使他们担心定期的内存损坏，这个校验和例程也只会在原始复制到内存期间发生错误时才会发现，这实际上是发生此类错误的可能性最小的时间，仅仅是因为系统尚未运行足够长的时间来发生腐败事件的可能性很高。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T15:43:54.147

通常，您想要做的事情是不可能的，因为在许多（大多数？）平台上，程序加载器可能会“重新定位”一些程序地址常量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-31T21:16:55.870

在将闪存驻留二进制映像复制到 ram 之前，您能否更新加载程序以对闪存驻留二进制映像执行校验和测试？

# html - 修复ie9中的td高度

> ID：14103063
> 
> 赞同：2
> 
> 时间：2012-12-31T14:57:41.307
> 
> 标签：html, css

我在 td 中有动态内容 - 如果副本太长，则单元格会忽略设置的高度并拉伸。这只发生在ie9中。

这是我的CSS

```
table tr {
min-height: 58px;
height: 58px;  overflow:hidden!important;
}
table td {
border-right: 1px solid #CCCCCC;
border-bottom: 1px solid #CCCCCC;
padding: 0 15px 0 15px;  overflow:hidden!important; height: 58px; white-space:wrap;
} 
```

不太确定如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:06:47.013

不要使用 td 来布局内容。仅将表格用于表格数据。使用 span 和 div 以及适当的 css。

这只是您必须接受并适当编码的浏览器内容之一。我确定它会在 ie14 中修复，但当然会出现其他问题；）

# php - 我可以使用while循环创建数组吗

> ID：14103064
> 
> 赞同：1
> 
> 时间：2012-12-31T14:57:42.920
> 
> 标签：php, arrays, wordpress

==================================================== =================================

**解决方案代码：**

```
$array = array();
$i = 1;
while( $i <= $instance['posts_num'] ) {
    $array['tab'.$i.'_title'] = 'Category Heading';
    $array['tab'.$i.'_thumb'] = 'Insert link here';
    $array['tab'.$i.'_featured'] = 'Insert link here';
    $array['tab'.$i.'_description'] = 'Insert category desciption';
    $array['tab'.$i.'_link'] = 'Insert category link';          
$i += 1;
}   

$instance = wp_parse_args( (array)$instance, array(
    'heading' => 'Featured Area', 
    'title' => '',
    'posts_num' => 1,

    (array) $array
) ); 
```

==================================================== =================================

如何使用 while 循环创建数组。

我正在尝试借助简单的 wordpress 插件中的 while 循环创建一个数组。我的代码如下：

```
 $instance = wp_parse_args( (array)$instance, array(
        'heading' => 'Featured Area', 
        'title' => '',
        'posts_num' => 1,

        $array = array();

        $i = 1;
        while( $i <= $instance['posts_num'] ) {

            $array[] = 'tab'.$i.'_title' => 'Category Heading',
            $array[] = 'tab'.$i.'_thumb' => 'Insert link here',
            $array[] = 'tab'.$i.'_featured' => 'Insert link here',
            $array[] = 'tab'.$i.'_description' => 'Insert category desciption',
            $array[] = 'tab'.$i.'_link' => 'Insert category link',

        $i += 1;
        }

    ) ); 
```

我只是想确认我是否做得正确。

我想生成这样的数组：

```
'tab1_title' => 'Category Heading',
'tab1_thumb' => 'Insert link here',
'tab1_featured' => 'Insert link here',
'tab1_description' => 'Insert category desciption',
'tab1_link' => 'Insert category link',

'tab2_title' => 'Category Heading',
'tab2_thumb' => 'Insert link here',
'tab2_featured' => 'Insert link here',
'tab2_description' => 'Insert category desciption',
'tab2_link' => 'Insert category link', 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:59:15.410

您正在尝试在其中放置一个 while 循环`array()`。那是行不通的。在调用之前构造数组`wp_parse_args`，然后将完成的数组传入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:06:23.477

```
while( $i <= $instance['posts_num'] ) {

            $array["tab{$i}_title"] = 'Category Heading';
            //...Repeat for others here.

        $i += 1;
        }

array(4) {
  ["tab0_title"]=>
  string(16) "Category Heading"
  ["tab1_title"]=>
  string(16) "Category Heading"
  ["tab2_title"]=>
  string(16) "Category Heading"
  ["tab3_title"]=>
  string(16) "Category Heading"
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T15:03:02.590

您的代码的问题是您使用了错误的语法/逻辑。

例子 ：

```
$array['tab'.$i.'_title'] = 'Category Heading';
$array['tab'.$i.'_thumb'] = 'Insert link here';
$array['tab'.$i.'_featured'] = 'Insert link here';
$array['tab'.$i.'_description'] = 'Insert category desciption';
$array['tab'.$i.'_link'] = 'Insert category link'; 
```

# c# - C# 中哪种对象初始化风格更合适？

> ID：14103066
> 
> 赞同：2
> 
> 时间：2012-12-31T14:57:59.840
> 
> 标签：c#

C# 中哪种对象初始化风格更合适？

*   声明私有对象并在同一行初始化它：

    ```
    private List<ReportRow> rows = new List<ReportRow>(); 
    ```

*   声明私有对象并在构造函数中对其进行初始化：

    ```
    private List<ReportRow> rows; 
    ```

    在构造函数中

    ```
    rows = new List<ReportRow>(); 
    ```

*   声明私有对象并在使用它的方法中对其进行初始化：

    ```
    private List<ReportRow> rows; 
    ```

    在我的 Run() 方法中

    ```
     rows = new List<ReportRow>(); 
    ```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T15:05:45.647

都是合适的。这实际上取决于代码的细节。如果您只是将该字段初始化为一个空列表，我的偏好是根据声明对其进行初始化。如果您将值放入依赖于构造函数参数的列表中，那么我将在构造函数中对其进行初始化。如果人口很昂贵并且可以跳过，那么我会在第一次调用消耗代码时对其进行初始化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:59:04.540

您的前两个选项是相同的；你应该使用你觉得更清楚的那个。
您还应该制作该字段`readonly`。

您的第三个选项不同；该字段将保留`null`，直到您调用`Run()`。
这可能不是一个好主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T15:04:17.817

选项

> 声明私有对象并在使用它的方法中对其进行初始化。

是最好的 - 如果在一个函数中使用它，则无需在构造函数中初始化它或在类级别声明它。

当您分配在构造函数中传入（注入）的值时，您应该在构造函数中初始化对象。在构造函数中声明它意味着它被本地化到那个范围，如果它没有在构造函数中使用并且只在一个方法中使用，那么在构造函数中初始化它没有多大意义——它应该被限定为那个方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T23:28:31.757

我会对 slugster 的回答发表评论，并提到即使一个对象仅用于一种方法，如果初始化它的成本很高，最好还是在类级别声明它。您仍然可以在它使用的方法中对其进行初始化，以便仅在必要时进行。但是，使用成员变量，您可以在初始化它之前检查它是否为空，以便它只执行一次。

这个问题让我想念 C++ 中的静态局部变量，尽管如果您需要为类的每个实例使用不同的对象，即使这些也无济于事。

# backbone.js - 如何将 .el 设置为 underscore.js 模板中的 div？

> ID：14103068
> 
> 赞同：0
> 
> 时间：2012-12-31T14:57:59.207
> 
> 标签：backbone.js, underscore.js, subviews

这是非常基本的事情，但我仍然找不到答案。我需要将视图设置为模板中的`el:`div 。`underscore.js`

```
<script id="product" type="text/template">
    <div class="productInfo"></div>
    <div class="prices"></div>
    <div class="photos"></div>
</script> 
```

第一个视图呈现`product`模板。我需要在此模板中将其他视图呈现给 div。我不知道如何设置`el:`，因为`el: '.prices'`只是不使用模板中的 div。

这个 Views 结构类似于[How to handle initializing and rendering subviews in Backbone.js?](https://stackoverflow.com/questions/9337927/how-to-handle-initializing-and-rendering-subviews-in-backbone-js) . 但我使用模板而不是渲染到现有的 div。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:09:24.117

所以问题是如果匹配未附加到页面的 DOM，则使用 CSS 选择器字符串`this.el`将找不到任何内容。`<div>`在你的`<script>`标签模板的情况下，标签的内容`<script>`不是附加的 DOM 节点，只有一个文本节点。

给定 HTML 的一种选择是忘记`<script>`标签并将空`<div>`标签直接放入 HTML。它们是空的，因此应该是无害且不可见的，直到您实际在其中渲染一些内容。如果你这样做，`el: '.productInfo:first'`应该可以正常工作。

除此之外，您需要按照以下方式将逻辑放入您的父视图中：

*   将模板渲染到分离的 DOM 节点中
*   在分离的 DOM 节点中搜索子视图 div
*   将子视图 div 映射到对应的主干视图子类
*   实例化并渲染子视图，然后使用类似的东西`this.$el.find('.productInfo').replaceWith(productInfoView.el)`将渲染的 HTML 放入正确位置的父视图中

我的一般意见是视图应该渲染到分离的 DOM 节点，并将其留给其他组件，例如路由器或布局管理器，以决定它们在真实 DOM 中的位置。我认为这使视图更具可重用性和可测试性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:12:15.087

渲染父视图，然后将 '.prices' 分配为子视图的 el：

```
var ParentView = Backbone.View.extend({
    render : function() {
        var html='<h1>Parent View</h1><div class="productInfo"></div><div class="prices"></div><div class="photos"></div>';
        this.$el.html(html);

        var prices = new PricesView({
            el : this.$('.prices')
        });
        prices.render();
    }
});

var PricesView = Backbone.View.extend({
    render : function() {
        var html='<h2>Prices View</h1>';
        this.$el.html(html);
    }
});

// Create a parent view instance and render it
var parent = new ParentView({
    el : $('.parent')
});

parent.render(); 
```

​</p>

关于 jsfiddle 的工作示例：http: [//jsfiddle.net/JpeJs/](http://jsfiddle.net/JpeJs/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T15:21:13.597

从[0.9.9 版本](http://backbonejs.org/#changelog)开始，主干让您将`el`视图的属性定义为函数：

> 在声明视图时，如果您希望在运行时确定它们的值，现在可以将选项、el 和 tagName 定义为函数。

假设子视图是在主视图之后创建的，如果您的子视图知道它们的父视图，这可能会对您有所帮助：

```
 SubView = Backbone.View.extend({
     el : function(){
         return this.parent.$('.prices');
     }
 });

 var subViewInstance = new SubView({parent : theParentView}); 
```

# sql-server - 案例语句中的 SQL Server 函数

> ID：14103070
> 
> 赞同：0
> 
> 时间：2012-12-31T14:58:33.323
> 
> 标签：sql-server

```
 select top 10 *, case     
    when datediff(day,DateOfSale, getDate())  > 5 then '5'
        when datediff(day,DateOfSale, getDate())  > 10 then '10'
... (more datediff clauses)
...
...
        else '20'
        end as jack
        from Foo 
```

SQL Server 是否足够聪明，可以`datediff`在 case 语句中评估一次函数调用，然后为每个`when`子句使用该值？还是该函数被调用了“n”次，其中“n”是`when`子句的数量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T15:05:32.240

很难看出 SQL Server 如何评估一次调用。该调用有一列作为参数，因此必须对每一行进行评估。

因此，您的情况最好写成：

```
when DateOfSale < dateadd(day, -5, getdate()) then '5' 
```

在这种情况下，差异很小。日期计算很便宜。

函数调用确实很重要的经典示例是`where`在日期列上有索引的表上的条件。例如，`YourTable`在`(dt)`. 此查询将允许使用索引：

```
select * from YourTable where dt < dateadd(day, -5, getdate()) 
```

虽然此查询不会：

```
select * from YourTable where datediff(day, DateOfSale, getDate()) > 5 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T15:16:36.077

令人费解的是，这么多答案都提到了索引。实际上，`DATEDIFF`它不是 SARGable，但这在这里完全无关紧要，因为 CASE WHEN 不会导致 SQL Server 中的查询优化器考虑索引使用情况（除了试图找到覆盖的可扫描路径）。据我所知，涉及索引路径的 DATEDIFF 表达式的候选资格与这个问题完全无关。

`CASE`很容易证明，一旦找到第一个真正的谓词，SQL Server 确实会停止评估语句中的谓词。

为了证明这一事实，让我们制作一些示例数据：

```
CREATE TABLE Diffy (SomeKey INTEGER NOT NULL IDENTITY(1,1), DateOfSale DATE);

DECLARE @ThisOne AS DATE;
SET @ThisONe = '2012-01-01';
WHILE @thisONe < '2013-01-01'
BEGIN
    INSERT INTO Diffy (DateOfSale) VALUES(@ThisOne);
    SET @ThisOne = DateAdd(d, 1, @ThisOne);
END; 
```

然后，让我们`SELECT`按照原始问题的模式进行。请注意，原始问题指定了`TOP 10`没有子句的`ORDER BY`子句，因此我们实际返回的值是随机的。但是如果我们在`CASE`that 中添加一个会毒化评估的子句，我们可以看到发生了什么：

```
SELECT TOP 10 *, CASE 
WHEN datediff(day,DateOfSale, getDate())  > 5 then '5'
WHEN datediff(day,DateOfSale, getDate())  > 10 then '10'
WHEN 1/0  > 1then 'boom'
ELSE '20' END
AS Jack
FROM Diffy; 
```

请注意，如果我们曾经评估过`1/0 > 1`，那么我们会期望像`'Divide by zero error encountered.'`. 但是，对我的服务器运行此查询会产生 10 行，列中都包含“5” `Jack`。

如果我们去掉 TOP 10，果然我们得到了一些行，然后得到了`Divide by zero`错误。因此，我们可以安全地得出结论，SQL Server 正在对 CASE 语句进行提前退出评估。

最重要的是，[文档](http://msdn.microsoft.com/en-us/library/ms181765.aspx)还告诉我们：

> CASE 语句按顺序评估其条件并在满足条件的第一个条件处停止。

也许这个问题的意思是询问公共`DATEDIFF()`子表达式是否从所有语句中提升`CASE`，计算一次，然后在每个谓词的上下文中进行评估。通过观察 的输出`SET SHOWPLAN_TEXT ON`，我认为我们可以得出结论并非如此：

```
 |--Compute Scalar(DEFINE:([Expr1004]=CASE WHEN datediff(day,CONVERT_IMPLICIT(datetimeoffset(7),[Scratch3].[dbo].[Diffy].[DateOfSale],0),CONVERT_IMPLICIT(datetimeoffset(3),getdate(),0))>(5) THEN '5'  ELSE CASE WHEN datediff(day,CONVERT_IMPLICIT(datetimeoffset(7),[Scratch3].[dbo].[Diffy].[DateOfSale],0),CONVERT_IMPLICIT(datetimeoffset(3),getdate(),0))>(10) THEN '10' ELSE CASE WHEN (1)/(0)>(1)  THEN 'boom' ELSE '20' END END END))
        |--Index Scan(OBJECT:([Scratch3].[dbo].[Diffy].[DiffyHelper])) 
```

由此，我们可以得出结论，这个查询的结构意味着`DATEDIFF()`对每一行和每个谓词进行评估，所以`O(rows * predicates)`调用，最坏的情况。这会导致查询的一些 CPU 负载，但`DATEDIFF()`并不是*那么*昂贵，也不应该引起太大的关注。如果在实践中证明它会导致性能问题，那么有一些方法可以手动从查询中提升计算。例如，`DATEDIFF()`在比较的相对日期方面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T15:08:01.497

当然，但不是在你的情况下（表达式基于每行更改的表列值），但无论如何，不​​要对表列值执行 datediff，在谓词上运行 dateadd （比较）值，因此您的查询仍然可以使用 DateOfSale 上的任何现有索引...

```
 select top 10 *, 
      case When DateOfSale < dateadd(day, -20, getDate()) then '20'
           When DateOfSale < dateadd(day, -15, getDate()) then '15'
           When DateOfSale < dateadd(day, -10, getDate()) then '10' 
           When DateOfSale < dateadd(day, -5, getDate()) then '5' 
          else '20' end jack
  from Foo 
```

# c# - 演员阵容 收藏

> ID：14103082
> 
> 赞同：1
> 
> 时间：2012-12-31T15:00:04.630
> 
> 标签：c#, inheritance

这里有另一个简单的问题让我难以理解。

我有 2 节课：

```
namespace Assets
{
   public class BaseAsset
   {
       // Code here
   }
} 
```

和

```
namespace Assets
{
   public class Asset : BaseAsset
   {
       // Code here
   }
} 
```

我有一个从数据库返回资产集合的函数，我希望另一个函数执行该函数并返回 BaseAsset 的集合。我试过这个：

```
 public static Collection<BaseAsset> GetCategoryAssets(int CategoryId, string UserId, string CompanyId)
    {
        return (Collection<BaseAsset>)AssetData.getAssets(CategoryId, UserId, CompanyId);
    } 
```

但你可以猜到，它不起作用。如果我正在使用列表，我可以这样做：

```
 public static List<BaseAsset> GetCategoryAssets(int CategoryId, string UserId, string CompanyId)
    {
        return AssetData.getAssets(CategoryId, UserId, CompanyId).Cast<BaseAsset>().ToList();
    } 
```

但我更喜欢使用一个集合，任何人都可以提出一个优雅的解决方案吗？

干杯，r3plica

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-31T16:58:53.827

这是一个非常常见的问题。您想要的功能名称是*通用协方差*；也就是说，“如果长颈鹿是一种动物，那么长颈鹿列表就是动物列表”的特征。

问题是长颈鹿列表*不是*动物列表。您可以将老虎放入动物列表中，但不能将老虎放入长颈鹿列表中，因此在任何需要动物列表的上下文中都不能使用长颈鹿列表。

您应该使用的原因`IEnumerable<T>`是`Collection<T>`因为从 C# 4 开始，`IEnumerable<T>`在 T 中是协变的，前提是提供的类型参数都是引用类型。也就是说，字符串序列可以用作对象序列，因为两者都是引用类型。但是整数序列不能用作对象序列，因为一个是值类型。

这是安全的原因是因为*没有办法将老虎插入`IEnumerable<Giraffe>`.*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T15:03:48.777

如果您想要轻松`.ToList`，只需编写自己的`.ToCollection`扩展方法即可。实现应该很简单——通过一个`IEnumerable<T>`, 循环并将所有内容添加到一个集合中`Add`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T15:04:46.613

问题在于`Collection<T>`and`ICollection<T>`是不变的（即，`Collection<BaseAsset>`既不是 的子类型也不是超类型`Collection<Asset>`）。

`IEnumerable<BaseAsset>`通过返回或`IReadOnlyList<BaseAsset>`代替 ，这个问题将很容易解决`Collection<BaseAsset>`。

也就是说，你可以写：

```
public static IEnumerable<BaseAsset> GetCategoryAssets(int CategoryId, string UserId, string CompanyId)
{
    return AssetData.getAssets(CategoryId, UserId, CompanyId);
} 
```

演员表变得不必要了。

通常，在指定返回值和函数参数时，您应该更喜欢接口类型（例如`IList<T>`、或）而不是具体类型（或）。`IReadOnlyList<T>``ICollection<T>``IEnumerable<T>``Collection<T>``List<T>`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T15:04:25.870

与其尝试转换为基类，不如直接提取一个接口并使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-31T21:13:50.550

由于`Collection<T>`该类有一个以 a[`IList<T>`](http://msdn.microsoft.com/en-us/library/ms132401.aspx)作为参数的构造函数，因此您始终可以执行以下操作：

```
Collection<BaseAsset> = new Collection<BaseAsset>(
                                           assetList.Cast<BaseAsset>().ToList()); 
```

当然，如果你需要重用这个行为，你可以做一个 CastToCollection 扩展：

```
public static Collection<TResult> CastToCollection<TResult>(this IEnumerable source)
{
   return new Collection<TResult>(source.Cast<TResult>().ToList());
} 
```

# node.js - Amazon ec2 服务器上的 Nodejs，无法使用 multipart/form-data 处理 POST 请求

> ID：14103089
> 
> 赞同：3
> 
> 时间：2012-12-31T15:00:54.280
> 
> 标签：node.js, amazon-ec2, multipart, form-data, enctype

真的需要帮助。

当 enctype="multipart/form-data" 时，Nodejs 无法接收 POST 请求，浏览器只是挂起.. 没有响应，没有任何反应，然后超时（以后可以在服务器上的指定文件夹中找到具有哈希字符串名称的文件）。该代码在本地进行了测试，可以正常工作。

**请求信息（来自 Google Chrome 网络选项卡）**

> 标头：Content-Type:multipart/form-data；
> 
> 有效负载：内容处置：表单数据；名称=“文件”；文件名="1_leaf_music.png"
> 
> 回复：空

使用其他编码类型“application/x-www-form-urlencoded”的 POST 请求工作正常，它应该只在“multipart/form-data”时挂起。

安装在 Amazon ec2 虚拟服务器上，其他一切正常。

> 示例 > 挂起回调 > app.post('/form-file', ... > console.log 从不跟踪

应用程序.js：

```
var http    = require('http');
var express     = require('express');
var path    = require('path');
var app     = express();

app.configure(function(){
    app.set('views', __dirname + '/views');
    app.set('view engine', 'jade');
    app.use(express.favicon());
    app.use(express.bodyParser({uploadDir:__dirname + '/public/uploads'}));
    app.use(express.methodOverride());
    app.use(express.static(path.join(__dirname, 'public')));
});

app.get('/', function(req, res, next) {
    console.log('get:/');
    res.render('index', { title: 'Upload a single file (using Express BodyParser()) ' })
});

app.post('/form-file', function(req, res, next)  {
    console.log("multipart/form-data recived... file recived: ",req.files.file.name);
    res.send("multipart/form-data recived... file recived: " + req.files.file.name);
});

app.post('/form-text', function(req, res, next)  {
    console.log("application/x-www-form-urlencoded: txt: ",req.body.txt);
    res.send("application/x-www-form-urlencoded... txt: " + req.body.txt);
});

var port = 8001;
http.createServer(app).listen(port, function() {
    console.log("Express server listening on port " + port);
}); 
```

看法：

```
<code>
form(method="post", name="f", action="/form-file", enctype="multipart/form-data")
  fieldset
    legend Upload a File
    input(type="file", name="file")
  div.actions
    button.btn.primary(type="submit") Upload
    button.btn.cancel(type="button") Cancel
</code> 
```

亚马逊服务器上相同的代码寿命：http: [//node.form.co.il :8001/](http://node.form.co.il:8001/)

**更新：** 问题出在模块 bodyParser 中。如果它被删除，节点将按预期触发响应。

# objective-c - 如何从被调用的 ViewController 中修改发送方 ViewController？

> ID：14103091
> 
> 赞同：0
> 
> 时间：2012-12-31T15:01:24.857
> 
> 标签：objective-c, ios, cocoa-touch, uiviewcontroller

我有一个从 Storyboard segue 调用的登录视图控制器。当用户正确登录后，我需要关闭当前的 ViewController，返回调用方 ViewController 并隐藏登录按钮。

如何引用发送方 ViewController 来隐藏按钮？我必须将`root`ViewController 的实例传递给登录名还是有其他方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:26:02.763

您应该使用委托。使带有按钮的 VC 成为其他人的代表。登录成功后，关闭 VC 并调用委托方法隐藏按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:26:55.787

使用委托。

为您的 DetaliViewControler 创建一个协议，例如

```
@protocol DetailViewControllerDelegate <NSObject>
-(void)successFullyLoggedInOnController:(DetailViewController *) controller;
@end 
```

向 DetailViewController 的界面添加委托声明，例如

```
@property (weak) id<DetailViewControllerDelegate> delegate; 
```

使 MasterViewController 符合协议。

```
-(void)successFullyLoggedInOnController:(DetailViewController *) controller
{
    [self.loginButton setHidden:YES];
} 
```

现在就在 MasterViewController 显示 DetailViewController 之前，执行类似的操作

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if ([segue.identifier isEqualToString:@"DetailViewSegue"]) {
        DetailViewController *vc = segue.destinationViewController;
        vc.delegate = self;
    }
} 
```

在 DetailViewController 中，一旦输入凭据并验证调用

```
[self.delegate successFullyLoggedInOnController:self]; 
```

并关闭 DetailViewController

# c# - 如何从 WCF 服务返回 multipart/form-data 作为响应

> ID：14103094
> 
> 赞同：2
> 
> 时间：2012-12-31T15:01:28.820
> 
> 标签：c#, wcf, multipartform-data

我希望我的 WCF 服务返回多部分/表单数据。尽管响应正文确实包含所需的内容，但是当我想查看 Content-type: multipart/form-data 时，响应标头表明正文是 application/octet-stream。

代码从以下单元测试开始。

```
 [TestMethod, Owner(TEST_AUTHOR), TestCategory("MIME Testing")]
    public void TempWcfService_PostMimeRequest_ExpectSuccess()
    {
        //Arrange
        HttpClient client = new HttpClient();

        HttpMultipartMimeForm form = new HttpMultipartMimeForm();
        form.Add("Key1", "Value1");
        form.Add("Key2", "Value2");

        //Act
        HttpResponseMessage response = client.Post(TEST_HOST_URL + "/mime-test", form.CreateHttpContent());
        response.EnsureStatusIsSuccessful();

        Stream responseStream = response.Content.ReadAsStream();
        string sResponse = responseStream.ToString();

        //Assert
        Console.Write(sResponse);
    } 
```

上述测试使用了一个 WCF 服务，其界面如下所示。

```
namespace TempWcfService
{
    /// <summary>
    /// Interface added to support http without the WCF client class
    /// </summary>
    [ServiceContract]
    public interface ITempPing
    {
        [OperationContract]
        [WebInvoke(Method = "GET", UriTemplate = "ping")]
        [Description("Pings the service for availability")]
        string ping();

        [OperationContract]
        [WebInvoke(UriTemplate = "mime-test", 
                   Method = "POST",
                   BodyStyle = WebMessageBodyStyle.Bare)]
        [Description("Tests a simple MIME request")]
        Stream TestMultipartMime(Stream data);

    }
} 
```

以及实施...

```
namespace TempWcfService
{
    /// <summary>
    /// Implementation added to support http without the WCF client class
    /// </summary>
    [AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
    [ServiceBehavior(InstanceContextMode = InstanceContextMode.Single)]
    public class TempPing : ITempPing
    {
        public string ping()
        {
            return "TempPing ping() successful";
        }

        public Stream TestMultipartMime(Stream data)
        {
            // Re-construct the multipart/form-data content
            MultipartFormData multipartFormData = new MultipartFormData(WebOperationContext.Current.IncomingRequest, data);
            HttpMultipartMimeForm responseForm = new HttpMultipartMimeForm(multipartFormData.Items);
            responseForm.Add("ErrorCode", "Success");
            responseForm.Add("ErrorMessage", "None");

            HttpResponseMessage responseMsg = new HttpResponseMessage();
            responseMsg.StatusCode = System.Net.HttpStatusCode.OK;
            responseMsg.Content = responseForm.CreateHttpContent();
            responseMsg.Headers.Add("Accept", "multipart/form-data");
            responseMsg.Headers.ContentType = "multipart/form-data; boundary=" + multipartFormData.Boundary;

            return responseMsg.Content.ReadAsStream();
        }

    }
} 
```

WCF 似乎在“帮助我”，方法是根据使用 ReadAsStream() 返回的内容，使用“application/octet-stream”的内容类型覆盖代码中指定的 ContentType。有没有办法让 Content-Type 标头指示多部分/表单数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T19:08:36.793

您需要在传出上下文中设置内容类型：

```
public Stream TestMultipartMime(Stream data)
{
    // Re-construct the multipart/form-data content
    MultipartFormData multipartFormData = new MultipartFormData(WebOperationContext.Current.IncomingRequest, data);
    HttpMultipartMimeForm responseForm = new HttpMultipartMimeForm(multipartFormData.Items);
    responseForm.Add("ErrorCode", "Success");
    responseForm.Add("ErrorMessage", "None");

    HttpResponseMessage responseMsg = new HttpResponseMessage();
    responseMsg.StatusCode = System.Net.HttpStatusCode.OK;
    responseMsg.Content = responseForm.CreateHttpContent();

    WebOperationContext.Current.OutgoingResponse.ContentType = "multipart/form-data; boundary=" + multipartFormData.Boundary;
    WebOperationContext.Current.OutgoingResponse.Headers["Accept"] = "multipart/form-data";

    return responseMsg.Content.ReadAsStream();
} 
```

请注意，您不需要`Accept`在*响应*中设置标头- 此标头用于客户端*请求*告诉服务器它想要接收哪些内容类型。

# linux - 计数/枚举按内容过滤的文件夹中的文件

> ID：14103095
> 
> 赞同：0
> 
> 时间：2012-12-31T15:01:36.183
> 
> 标签：linux, bash, ubuntu

我有一个文件夹，里面有很多文件和一些数据。并非每个文件都有完整的数据集。完整的数据集在最后一行都有一个“yyyy-mm-dd”形式的通用字符串，所以我想我可能会用类似的东西过滤`tail -n 1`，但不知道该怎么做。

知道如何在简单的脚本或 bash 命令中执行类似的操作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T15:05:09.577

```
for f in *
do
    tail -n 1 "$f" |
    grep -qE '^[0-9]{4}-[01][0-9]-[0-3][0-9]$' &&
    echo "$f"
done 
```

# android - FragmentPagerAdapter 类仅在第一次单击选项卡时触发

> ID：14103097
> 
> 赞同：0
> 
> 时间：2012-12-31T15:01:48.337
> 
> 标签：android, android-viewpager, fragmentpageradapter

我正在尝试开发一个基于标签的应用程序。每个选项卡都有其片段。其中之一有 ViewPager，而 ViewPager 有自己的页面。我通过在这个 viewpager 中滚动来从另一个移动。

当我第一次打开应用程序时，没有问题。但是，当我从该选项卡移动并再次访问它时，它不会显示 viewpager 内容，也不会触发 FragmentPagerAdapter 类。

标签 A - 标签 B - 标签 C

Tab C 片段有 ViewPage。

ViewPage 有自己的页面。

```
public class FragmentC extends Fragment {

public static final String ARG_SECTION_NUMBER = "section_number";
 static ViewPager C_mViewPager; 
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {

    C_mViewPager = (ViewPager)inflater.inflate(R.layout.fragmentC, container,false);
             C_SectionsPagerAdapter mC_PagerAdapter=new C_SectionsPagerAdapter(MainActivity.fragmentManagerv4);
             C_mViewPager.setAdapter(mC_PagerAdapter);

 return C_mViewPager;

}
public class C_SectionsPagerAdapter extends FragmentPagerAdapter {

    public C_SectionsPagerAdapter (FragmentManager fm) {
        super(fm);
    }

    @Override
    public Fragment getItem(int i) {
        Fragment fragment = null ;
         Bundle args;
        switch (i) {
        case 0:

            fragment=new A_SubFragment();
            break;

        case 1:

            fragment = new B_SubFragment();
            break;

        case 2:

        fragment = new C_SubFragment();
        break;

        case 3:

        fragment = new D_SubFragment();
        break;

}
        return fragment;
    }

    @Override
    public int getCount() {
        return 4;
    }

    @Override
    public CharSequence getPageTitle(int position) {
        switch (position) {
            case 0: return getString(R.string.title_section1).toUpperCase();
            case 1: return getString(R.string.title_section2).toUpperCase();
            case 2: return getString(R.string.title_section3).toUpperCase();
            case 3: return getString(R.string.title_section4).toUpperCase();

        }
        return null;
    }
}
public static class A_SubFragment extends Fragment {

    public A_SubFragment() {
    }

    public static final String ARG_SECTION_NUMBER = "section_number";

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        RelativeLayout theLayout=(RelativeLayout)inflater.inflate(R.layout.a_sub_fragment, container,false);
//...
 return theLayout;}}
} 
```

片段 C;

```
<android.support.v4.view.ViewPager xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:id="@+id/pager"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T08:04:58.487

我得到了答案，我使用 FragmentStatePagerAdapter 而不是 FragmentPagerAdapter

# php - 如何在php中获取文本框值到变量并用按钮发布

> ID：14103100
> 
> 赞同：4
> 
> 时间：2012-12-31T15:02:27.370
> 
> 标签：php, html, mysql

我有一个代码

```
 <form action="index.php" method="post">  
    <input type="text" name="jam" />
    <input type="submit" name="submit" value="Translate" />
    </form>

<?php
$conn = mysql_connect ("localhost", "root","")  or die (mysql_error());
mysql_set_charset('utf8',$conn);
mysql_select_db ("movedb");

$jam = $_POST['jam'];

$sql = mysql_query("select * from WORD where ENGLISH like '$jam%' Limit 15");

while ($row = mysql_fetch_array($sql)){
    echo ' '.$row['ENGLISH']; 
echo ' - '.$row['SINHALA']; 
    echo '<br/>';

    }

?> 
```

我想发布像 index.php?=text=(text box value here) 这样的文本值

我想把它提交给$jam

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T15:05:05.453

`get`表格方法不应该`post`。

此外，`>`从您的操作中删除 。小错字。

尝试：

```
<form action="index.php" method="get">  
<input type="text" name="jam" />
<input type="submit" name="submit" value="Translate" />
</form> 
```

然后你可以这样做：`$jam = $_GET['jam'];`

# php - 导出excel的PHP设置路径

> ID：14103101
> 
> 赞同：1
> 
> 时间：2012-12-31T15:02:32.753
> 
> 标签：php, export-to-excel, filepath

我想将 excel 导出到特定文件夹，用户可以将其保存在他们想要的任何地方。目前我已经成功导出到 excel 但我在本地对其进行了测试并将其下载到我的本地服务器文件夹中。我希望有一个人可以帮助我。谢谢你。

```
$id=$_GET['id'];
$excel=new ExcelWriter("./excel/company".$id.".xls");
if($excel==false)   
echo $excel->error;
$myArr=array("NO", "COMPANY", "ADDRESS1", "ADDRESS2", "ADDRESS3", "POSTCODE", "CITY", "STATE", "PHONE NO", "FAX NO", "EMAIL", "WEBSITE");
$excel->writeLine($myArr);
$qry=mysql_query(" SELECT organizations.*, states.state, cities.city FROM organizations, states, cities WHERE idOrg='$id' AND organizations.state_id=states.idState AND organizations.city_id=cities.idCity");
if($qry!=false)
{
    $i=1;
    while($res=mysql_fetch_array($qry))
    {
        $myArr=array($i,$res['companyName'], $res['add1'], $res['add2'], $res['add3'], $res['postcode'], $res['city'],$res['state'], $res['phoneNo'], $res['faxNo'], $res['email'], $res['website']);
        $excel->writeLine($myArr);
        $i++;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T15:17:36.613

您的问题标题表明您假设使用 PHP，您可以在客户端的 PC 上保存 Excel 文件。不完全是。您可以将其保存到本地网络服务器（正如您已经发现的那样）。但是要将其传输到客户端 PC，您应该将其作为下载提供。

文件写入完成后（正如您已经在做的那样），向用户提供指向服务器上文件的链接。然后，他们将能够选择应该在他们的 PC 上下载它的位置。

另一种可能性是将excel文件数据作为HTTP响应写出，并将`Content-Type`标头设置为`application/vnd.ms-excel`（或任何适合您的文件类型的内容）和a `Content-Disposition`of `attachment`（[示例](http://www.jtricks.com/bits/content_disposition.html)）。

我对 ExcelWriter 不熟悉，所以我不知道它是否有某种`dump`功能。也许在你写出文件之后，你只需执行以下操作：

```
header('Content-Type: application/vnd.ms-excel');
header('Content-Disposition: attachment; filename=company'. $id .'.xls');

echo file_get_contents('./excel/company'. $id .'.xls'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:17:13.580

解决方案在他们的文档中

[http://pear.php.net/manual/en/package.fileformats.spreadsheet-excel-writer.intro.php](http://pear.php.net/manual/en/package.fileformats.spreadsheet-excel-writer.intro.php)

摘自上述网站

```
// sending HTTP headers
$workbook->send('test.xls'); 
```

> 这意味着我们将电子表格发送到浏览器。但是，如果我们只想将电子表格保存在我们的机器中呢？好吧，您只需要省略该行并为工作簿构造函数提供一个有效的文件路径。
> 
> 例如，如果我们想将我们在第一个示例中创建的同一个电子表格保存到一个名为“test.xls”的文件中，我们可以这样做：

然后，您可以将用户指向该文件的链接，以便他可以将其保存在他喜欢的位置

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T15:14:23.093

```
"./excel/company".$id.".xls" 
```

是相对路径，您确定这是您要保存的位置吗？您可以使用 $_SERVER['DOCUMENT_ROOT'] 获取文档根目录并使用它+这样的路径。

```
$_SERVER['DOCUMENT_ROOT'] . "/excel/company".$id.".xls 
```

也不要忘记关闭文件。

```
$excel->close(); 
```

# java - Zk 6：兼容模式下的 Internet Explorer

> ID：14103102
> 
> 赞同：0
> 
> 时间：2012-12-31T15:02:36.810
> 
> 标签：java, internet-explorer, meta-tags, zk

我们在 Internet Explorer v8 上以兼容模式部署了一个网站。不幸的是，Zk 没有很好地管理兼容性。

目前，我们添加了一个元标记来强制引擎。

```
<? meta http-equiv="X-U-Compatible" content="IE=8" ?> 
```

但结果并不好。

与 IE 8（无兼容模式）的结果不同是否正常？使用 IE7 引擎强制内容的元数据的结果几乎是好的，但其他组件受到影响（例如菜单栏）。

如何正确管理？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T17:19:23.230

从使用标准文档类型开始：

```
<!DOCTYPE html> 
```

如果您愿意，您仍然可以使用`x-ua-compatible`标题或元标记：

```
<meta http-equiv="x-ua-compatible" content="IE=8"> 
```

这会强制文档进入 IE8 标准模式。在 IE7 中，文档将以 IE7 标准模式显示，而在 IE9+ 中，文档将以 IE8 标准模式显示。

一旦您的文档处于标准模式，您就可以期待更一致的行为和呈现。此时，您需要识别浏览器之间不一致的区域，并根据具体情况进行处理。

当那个时候到来时，我们会在这里提供帮助。在此之前，请通读[Specifying Legacy Document Modes](http://msdn.microsoft.com/en-us/library/jj676915%28v=vs.85%29.aspx)。

# c++ - 使用 boost 打开日志文件并附加一些条目

> ID：14103105
> 
> 赞同：0
> 
> 时间：2012-12-31T15:02:57.403
> 
> 标签：c++, file, logging, boost

我必须为自定义条目编写一个小记录器。我使用 boost 类“boost::filesystem::fstream”进行读写。首先我打开一个日志文件 _file.open( boost::filesystem::path( _fileName ), std::ios_base::out | std::ios_base::binary ); 并从那里阅读所有条目。然后我写了一个新条目，我得到一个“badbit”-异常。我做错了什么？

# jquery - 已创建 Jquery 菜单但没有任何效果

> ID：14103109
> 
> 赞同：0
> 
> 时间：2012-12-31T15:03:22.623
> 
> 标签：jquery, jquery-ui, javascript-framework

我在我的网站顶部创建了自己的显示菜单脚本，但我遇到了一些问题

基本问题是

1.  当我将鼠标放在显示菜单的链接上时，菜单会在第一时间完美显示，

2.  但是，如果我将鼠标放在菜单显示的 div -show until - 上，此菜单将一直隐藏并且不会保留

使用此脚本，我尝试显示`div`，当鼠标离开此脚本时`div`，将其隐藏

我的脚本是这样的：

```
function menu(id,width,color)
{

$(".men"+id).mouseover(function(e) {

//
//$(".m"+id).show("blind", { direction: "vertical" }, 500);
//$(".m"+id).show(500);

$(".m"+id).css("width",""+width);
$(".m"+id).show("slide", { direction: "up" }, 500);
$(".m"+id).css("background-color",""+color);

e.stopPropagation();
e.stopImediatePropagation();

});

$(".m"+id).mouseout(function(e) {

$(this).hide(500);
e.stopPropagation();
e.stopImediatePropagation();

});

} 
```

CSS 样式：

```
#content_menu
{
margin-top:7px;
position:absolute;
min-height:50px;
height:auto;
border:1px solid;
text-align:left;
font-family:Arial;
font-size:12px;
z-index:2;
-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";
filter: alpha(opacity=80);
-moz-opacity:0.8;
-khtml-opacity: 0.8;
opacity: 0.8;
}

#content_menu_into
{
position:relative;
width:98%;
min-height:28px;
height:auto;
line-height:28px;
font-family:Arial;
font-size:14px;
color:#000000;
padding-left:2%;
text-align:left;
} 
```

对于调用脚本：

```
 <a href="#" onmouseover="javascript:menu('1','200','#000000');" class="men1">
   Home Web Menu
   </a>

    <div id="content_menu" class="m1" style="display:none;">
    <div id="content_menu_into">
    Home
    News
    Articles
    Users
    Vote
    </div>
    </div> 
```

谢谢帮忙，新年快乐！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T15:13:30.547

你有两件事要解决：

1.  （这不能回答您的问题）：您正在事件中运行`menu`函数。`mouseover`你所做的`menu`是绑定`mouseover`（和`mouseout`）。这有点多余。你应该打电话`menu`到`document.ready`。
2.  （这确实回答了您的问题）：仅当鼠标不在两者中时才应隐藏菜单：`m1`和`men1`.

只是出于好奇：您为什么不使用所有现有的菜单插件？

# linux - bash free 命令停止工作

> ID：14103111
> 
> 赞同：0
> 
> 时间：2012-12-31T15:03:49.493
> 
> 标签：linux, bash, tail, free-command

我正在尝试执行以下操作：

获取 的输出`free -mo`，取第二行并每 30 秒将其记录到文件中。

当我跑

```
$free -mo -s 30 
```

它每 30 秒运行一次并显示输出。

但是当我跑步时

```
$ free -mo -s 30 | head -2 | tail -1 
```

它只运行一次。我无法弄清楚出了什么问题。

free Manual 说 free -s 30 每 30 秒运行一次命令。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T15:06:08.910

`head -2`只返回前 2 行输出然后退出。`tail -1`返回最后一行，然后退出。当任何程序在管道中退出时，它会杀死整个管道，因此在完成`free`时停止。`head``tail`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:08:34.350

采用`free -mo -s 30 &> test.txt &`

这将获取`free`命令的所有输出并将其输出到 test.txt 并在后台运行它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T15:18:02.520

尝试

```
free -mos 30 | grep 'Mem:' >yourlog.txt 
```

（但您可能会更好地考虑使用类似 sar 来捕获此类数据 - 它还可以报告许多其他内容 - 只需推迟过滤/提取，直到您从数据中生成报告）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T15:28:32.280

威尔·哈通是对的。而是这样做：

> 虽然是真的；做免费-mo | 头-2 | 尾巴-1；睡30；完毕

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-01T07:17:00.803

感谢您的回答。我试图监视进程的内存利用率。我想我明白了。

```
START_TIME=$(date);
cd /data;

INPUT_DATA=$1;
CODE_FILE=$2;
TIMES=$3;

echo "$START_TIME" > "$CODE_FILE.freeMemory_$TIMES.log";
free -mo -s 30 >> "$CODE_FILE.freeMemory_$TIMES.log" &
freepid=$!;

sleep 1m;
#echo "PID generated for free command -- $freepid";
START_TIME=$(date);
i=0;
while [ $i -le $TIMES ]
    do
            sh runCode.sh $CODE_FILE "output.csv" $INPUT_DATA;
            i=`expr $i + 1`
    done

END_TIME=$(date);
echo "process started at $START_TIME and ended at $END_TIME " ;
sleep 1m;
kill -9 $freepid;
END_TIME=$(date);
echo "$END_TIME" >> "$CODE_FILE.freeMemory_$TIMES.log"; 
```

# node.js - 从节点服务器向客户端发送会话描述

> ID：14103114
> 
> 赞同：1
> 
> 时间：2012-12-31T15:04:16.120
> 
> 标签：node.js, web-applications, xmlhttprequest, html5-video, webrtc

我需要使用 websocket 将 JSON 数据发送到我的客户端吗？（这是一个很小的会话描述）

目前，我的客户端代码通过 XHR 向我的 Node.js 服务器发送会话描述。收到后，我的节点服务器需要将其发送到“房间”中的另一个客户端。

我可以使用 socket.io 来实现这一点，但是是否可以做任何更快/更安全的事情，例如 XHR？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T00:03:45.283

如果您只是想收到对方的报价而不是其他，我建议您尝试 HTML5 Server Sent Events。

但这可能会由于不同的浏览器支持而带来问题，所以我会使用一个简单的长池请求。由于您只想获得 SDP 报价，因此实施非常简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T01:26:42.637

不，您不需要使用 WebSocket API 通过服务器将 JSON 数据从客户端发送到客户端，但除非您使用 Google 专有的 App Engine Channel API，否则 WebSocket API 可能是您的最佳选择。

另外，请记住，您不仅要发送会话描述，还要发送候选信息（多次）以及您可能需要开始/关闭会话等的其他任意数据。

据我所知，WebSocket API 是最快的信号解决方案（比 XHR 更快），因为在初始握手后，多个 HTTP 请求所涉及的所有开销都不存在。

如果您想自己编写代码，我会开始阅读最新的[WebSocket 草案](https://datatracker.ietf.org/doc/html/draft-ietf-hybi-thewebsocketprotocol-17)并学习如何自己编写 WebSocket 服务器端脚本，否则您将不得不依赖像 Socket.IO 这样的 WebSocket 库或专有解决方案像 Google 的 App Engine Channel API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T02:24:28.390

使用[303 HTTP 状态码](http://en.wikipedia.org/wiki/HTTP_303)怎么样？

第一个客户端将会话描述发送到资源 X，服务器确认收到并以 303 状态代码响应，该状态代码指向一个新创建的资源 Y，该资源 Y 累积了其他客户端会话描述。

第一个客户端轮询资源 X 直到它发生变化。

第二个客户端将其会话描述发送到资源 A，服务器确认接收并更新资源 Y。第一个客户端在下一次轮询时注意到更新，现在将拥有第二个客户端的会话信息。

# css - Div 容器最小高度错误

> ID：14103123
> 
> 赞同：1
> 
> 时间：2012-12-31T15:05:01.640
> 
> 标签：css, html

嗨，我遇到了以下问题：我使用 min-height:230px 因为 div 中的文本需要这个高度。但是 Iphone 需要另一个高度，所以它应该增加到 320 像素。我的想法是使用 height:auto 所以它会自动适应文本的高度，但由于某种原因它不起作用。该网站是[http://www.sterntaufe-deutschland.de/](http://www.sterntaufe-deutschland.de/)请检查“Über Sterntaufe Deutschland”下面的 4 个文本框的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T15:59:29.407

你不能通过设置来`min-height`重置`height`。您应该重置（或根本不指定）`min-height`自身。

顺便说一句，考虑`display: inline-block`为每个项目使用，这样就不需要指定任何高度，因为它们会自动垂直对齐。例如：

```
UL.services {font-size: 0; }

UL.services > LI {
    display: inline-block;
    font-size: 14px;
    width: 50%;
    vertical-align: top;
} 
```

HTML：

```
<ul class="services">
    <li>
        <h3>30 Tage Rückgaberecht</h3>
        <p>Wir taufen nur gut sichtbare Sterne!</p>
    </li>

    <li>
        <h3>Schneller Versand</h3>
        <p>Durch unsere langjährige Erfahrung.</p>
    </li>

    <li>
        <h3>Das Sterntaufenregister</h3>
        <p>Wir sind Partner des Sterntaufenregisters.</p>
    </li>

    <li>
        <h3>Wir sind für Sie da</h3>
        <p>Sollten Sie bei uns einen Stern kaufen.</p>
    </li>
</ul> 
```

# java - 我的字符切换软件返回相同的答案？

> ID：14103130
> 
> 赞同：0
> 
> 时间：2012-12-31T15:05:37.270
> 
> 标签：java, arrays, encryption, char

我想制作一个接受字符串并对其进行加密的程序。

在程序执行期间，它应该将字符串转换为 char 数组。然后，一个 switch 语句遍历数组以将 a 替换为 b，反之亦然。

但是，程序只是返回与开始时相同的内容！这是代码

```
import java.lang.*;
import java.util.Scanner;

public class Program
{

    public static void main(String args[]) 
    {
        Scanner input = new Scanner(System.in);
        String pw = input.next();
        char pwa[] = pw.toCharArray();

        for(char c : pwa ){
          switch(c){
            case 'a':
            c = 'b';
            break;
            case 'b': 
            c ='a';
            break;
          }
        }
        String convpw = new String(pwa);
        System.out.println(convpw);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T15:07:15.050

您只是在更改变量`c`，而不是`pwa`，并且`c`是循环的本地变量。

你可以这样做 ：

```
for (int i=0; i<pwa.length; i++) {
    switch(pwa[i]){
    case 'a':
       pwa[i] = 'b';
       break;
    case 'b': 
       pwa[i] ='a';
       break;
    }
} 
```

# ruby-on-rails - 独立表单的 Ruby on Rails 时间日期字段

> ID：14103131
> 
> 赞同：0
> 
> 时间：2012-12-31T15:05:38.190
> 
> 标签：ruby-on-rails, ruby

我有一个处理预订的系统。我正在为用户编写 UI 以选择提交给房间控制器并返回这些日期的所有可用房间的开始和结束日期。我正在努力

1.  实际形式
2.  在房间控制器中处理日期。

使用`form_for`了很多，我知道 datetime_select 是如何工作的，但是使用`form_tag`我似乎无法找到如何实现相同的东西。

此外，看起来好像使用`datetime_select :year, :start_year`5 个参数将日期传递给控制器​​，解析起来会很麻烦。

我想知道如果我正确配置表单，控制器会知道如何原生解析日期并自动解决第二个问题

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T15:31:35.987

如果我正确理解您的问题，请查看此[答案](https://stackoverflow.com/questions/7860502/what-is-the-equivalent-of-date-select-for-a-form-tag-instead-of-form-for)，然后您可以像使用`form_for`.

# python - 如何正确关闭 tweepy 流

> ID：14103133
> 
> 赞同：16
> 
> 时间：2012-12-31T15:05:47.510
> 
> 标签：python, multithreading, tweepy

我试图弄清楚如何正确关闭异步 tweepy 流。

tweepy 流媒体模块可以在[这里](https://github.com/tweepy/tweepy/blob/master/tweepy/streaming.py)找到。

我像这样开始流：

```
stream = Stream(auth, listener)
stream.filter(track=['keyword'], async=True) 
```

关闭应用程序时，我尝试关闭流，如下所示：

```
stream.disconnect() 
```

此方法似乎按预期工作，但似乎有一个问题：流线程仍在循环中间（等待/处理推文）并且直到下一个循环才被杀死，所以当流收到推文时，即使在之后应用程序已关闭，它仍然尝试调用侦听器对象（这可以通过侦听器对象上的简单打印语法看到）。我不确定这是否是一件坏事，或者是否可以简单地忽略它。

我有两个问题：

1.  这是关闭流的最佳方式还是我应该采取不同的方法？
2.  不应该将异步线程创建为守护线程吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-12-30T10:02:29.053

我有同样的问题。我通过重新启动脚本来修复它。Tweepy Stream 直到下一条传入推文才会停止。

例子：

```
import sys
import os

python=sys.executable

time.sleep(10)

print "restart"
os.execl(python,python,*sys.argv) 
```

我没有找到其他解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-01T02:50:29.133

我不确定它是否适用于您的情况，但总的来说，您可以通过将适用的实体放在一个`with`块中来自行清理它们：

```
with stream = Stream(auth, listener):
    stream.filter(track=['keyword'], async=True)
    # ...
# Outside the with-block; stream is automatically disposed of. 
```

“处置”实际上意味着，它`__exit__`调用了实体函数。
大概 tweepy 会覆盖它来做正确的事情。
正如@VooDooNOFX 建议的那样，您可以检查来源以确定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-31T22:36:33.740

这是设计使然。[查看源代码](https://github.com/tweepy/tweepy/blob/master/tweepy/streaming.py#L258)，您会注意到断开连接没有立即终止选项。

```
def disconnect(self):
    if self.running is False:
        return
    self.running = False 
```

调用 disconnect() 时，它只是设置 self.running = False，然后在[_run 方法的下一个循环中检查](https://github.com/tweepy/tweepy/blob/master/tweepy/streaming.py#L120)

**你可以忽略这个副作用。**

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-02-27T13:49:08.230

正如@burkay 建议的那样，我没有重新启动脚本，而是最终删除了 Stream 对象并启动了一个新对象。在我的示例中，有人想添加一个新用户来关注，所以我以这种方式更新跟踪列表：

```
stream.disconnect() # that should wait until next tweet, so let's delete it
del stream
# now, create a new object
stream = tweepy.Stream( auth=api.auth, listener=listener )
stream.userstream( track=all_users(), async=True ) 
```

# magento - magento 属性 / 一个选择的多个 atts

> ID：14103135
> 
> 赞同：-1
> 
> 时间：2012-12-31T15:05:56.390
> 
> 标签：magento, attributes, magento-1.7

真的可以用您的专家建议/知识和帮助...

我们有一个客户，我们为他建立了一个 magento 网站。他销售摩托车、摩托艇、越野摩托车等零件。

我们设置了三个属性“制造商”、“型号”和“年份”——这是每个产品内部的选择过程，以向下钻取价格（随着型号年份的价格变化）以实现他想要的定价结构，我们使用了更简单的配置产品插件，很有魅力。（我发现通过这些论坛搜索）

问题..“模型”属性变得太大（浏览器崩溃并超时 - 并且接近我被告知的是属性的限制）所以我​​们必须重新考虑逻辑（最后的手段是改变整体网站并将它们全部添加为简单产品并使用过滤器代替 - 客户不想要）

经过几天的压力和研究，我们仍然没有更聪明......

一种想法是将模型属性拆分为制造商..所以“Hond_Model”..“Aprilla_Model”等等..但是我们不能保留一个产品的结构，里面有所有选项，我们可以在里面产品（前端）

*   选择本田车型
*   选择四月模型
*   选择 Can Am 模型

*   年

但用户可以从“型号”下拉列表中的任意三个中选择一个型号，然后将其他 2 个型号属性空白并让用户选择年份以获取价格。但是在后端，当我尝试这个时，所有三个“模型”属性都有一个红色星号，并且需要在所有三个中输入..

帮助！

抱歉，如果其中一些是基本的，我是一名设计师，过去 6 个月在我的开发人员的帮助下学习 magento，所以对此仍然很陌生，但已经超出了我的深度。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T17:17:38.003

鉴于复杂程度、贵公司与 Magento 的相对新颖性以及汽车配件领域的细节，购买现有配件模块可能是明智之举（例如[Year Make Model Extension](http://www.magentocommerce.com/magento-connect/year-make-model-extension.html) -***不是*背书**- 我没有第一手资料此扩展）来引导您的开发或从中学习。您应该首先与模块供应商核实，以确保代码适合此目的（未混淆/加密，使用 Magento 约定编写）。

根据前端演示和后端报告的工作方式，可以采取多种方法，但这些方法过于宽泛，无法在此讨论。

# ruby - 为什么我的 Rails 开发环境没有重新加载代码更改？

> ID：14103136
> 
> 赞同：5
> 
> 时间：2012-12-31T15:06:04.883
> 
> 标签：ruby, ruby-on-rails-3, thin, rubymine, webrick

每次我对代码进行更改时，我都必须重新启动服务器，否则它不会改变输出。

我尝试过使用瘦和 webrick。

我的`development.rb`文件说“ `config.cache_classes = false`”。

我正在使用 RubyMine。

有时我的视图会更新，但模型永远不会更新。

您还需要知道什么来帮助我解决此问题吗？

编辑：

我现在远离我的编码机，但我开始思考。我在 app/models 目录中有一个名为 makeandwich.rb 的文件，并且 app/models/Lesson.rb 调用了该文件中的一个函数。我一直在对makesandwich.rb 文件进行更改，但它没有重新加载。我需要添加该文件还是应该将其自动包含在重新加载中？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-07-10T22:56:06.917

我最近也遇到了这个问题。正如其他人所说，这可能是由设置配置引起的。cache_classes 或 config.threadsafe！为真，这在大多数情况下可能是问题所在。

但是，我的问题是由在 VM 上运行 rails 引起的。我的代码存储在我的主机上的一个文件夹中，然后将其安装到 VM 上。不幸的是，我的主机的时钟时间与虚拟机不同步。这是我修改代码时会发生的情况：

1.  我会在主机上的文本编辑器中更改一些代码
2.  保存代码会将文件的修改时间设置为我的主机的当前时间
3.  从 VM 的角度来看，这次是未来
4.  当文件更新检查器查找修改后的文件时，它忽略了我的文件，因为修改日期是将来的日期

同样，这可能是非常罕见的情况，但是如果您在 VM 上运行 rails，则值得检查一下

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:34:43.973

如果您正在处理 Rails 3 项目，您可能会发现 Zeus 很有帮助。它跟踪项目中的文件，并仅重新加载内存中更改的代码。它使 REPL 在 Rails 3 开发中变得更快。

[https://github.com/burke/zeus](https://github.com/burke/zeus)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T13:05:20.313

问题是我将一个函数放在一个单独的文件中并在那里编辑该函数。这对于生产来说可以正常工作，但出于开发目的，我将函数放回 Lesson.rb 文件中，并且刷新开始正常工作。

# c - 交换 2 个连续字符串 - 时间复杂度

> ID：14103140
> 
> 赞同：0
> 
> 时间：2012-12-31T15:06:33.800
> 
> 标签：c, time-complexity, c-strings

目标：函数，它接受一个指向字符串的指针和两个长度，并在由长度表示的内部字符串之间进行交换，**而不**使用取决于输入大小的额外内存。例如，给定字符串“abcdef123”和长度 6,3，结果应该是“123abcdef”。

一种可能的递归实现（我的）是：

```
void invertStrings(char* str, int len1, int len2){
    if(len1==0 || len2==0)
        return;
    if(len1>len2){
        for(int i=0;i<len2;++i)
            swapChars(str, len1+i, len1-len2+i);
        invertStrings(str,len1-len2,len2);
    }
    else{
        for(int i=0;i<len1;++i)
            swapChars(str, len1+i, i);
        invertStrings(str+len1,len1,len2-len1);
    }
} 
```

我认为时间复杂度是 O(len1+len2) 甚至可能是 O(max{len1,len2})。

问题：时间复杂度是多少，如何证明？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T15:49:49.080

所写的算法似乎是`O(len1+len2)`。让我们将函数调用的“总工作量”定义为`len1 + len2`. 每次调用该函数时，它都会进行`min(len1,len2)`交换，并使用 递归调用自身`total_work[n+1] = total_work[n] - min(len1,len2)`。因此，所有递归调用中所做工作的上限是`len1+len2`.

这里的另一个转折是终止条件取决于`gcd(len1,len2)`. 当 len1,len2 之一为 0 时循环终止，因此我们保证交换次数严格小于`len1+len2`. 最后“剩余”多少取决于两个长度的gcd。例如，如果我们`(6,3)`以 为起点，那么我们将得到`(6,3)->(3,3)->(0,3)`, 总共 6 次掉期（少于预期的 8 次）。但如果我们从头开始，`(7,3)->(4,3)->(1,3)->(1,2)->(1,1)->(1,0)`我们最终会进行 9 次交换。掉期的数量一般正好是`len1 + len2 - gcd(len1,len2)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:12:42.393

这是**O(n)**，因为每个交换操作都会将至少一个字符放在正确的最终位置。

算法复杂度是输入大小的函数，这里操作的成本随着输入的大小线性增长。

通常具有复杂性，您只关心它表现出的增长类型。如果它是线性的，那么您不关心系数是多少（例如，您不关心它是输入数据量的两倍还是 7）。

# json - Backbone.js - 如何在不同的路由上从 JSON 加载列表或单个项目？

> ID：14103145
> 
> 赞同：0
> 
> 时间：2012-12-31T15:07:08.327
> 
> 标签：json, backbone.js, backbone-views, backbone-routing

我刚刚通过为自己创建一个简单的投资组合网站开始使用 Backbone.js。目前没有太多功能，但我希望在熟悉该库后添加更多更多功能。我正在使用 json 来填充站点的数据，该站点要么列出我的所有投资组合项目，要么根据路线显示其中一个。我有工作/显示的投资组合项目列表，但我很难只显示特定路线的一个项目（例如 /#projects/2），这是我需要帮助的地方。

在我开始学习 Backbone 时，我试图让一切尽可能简单，并且看过各种样板和教程，但没有一个对我有很大帮助。

在这些路线上，我希望发生这种情况：

1.  / - 投资组合项目列表
2.  /#projects - 投资组合项目列表
3.  /#projects/3 - 一个投资组合项目

我已将尝试放入 JSbin，但它不起作用，因为我不知道如何正确加载 json...

*   [http://jsbin.com/asezul/6/edit](http://jsbin.com/asezul/6/edit)进行编辑
*   [http://jsbin.com/asezul/6/](http://jsbin.com/asezul/6/)查看

我确定我的问题出现了，因为我将所有项目加载到集合而不是模型中。那正确吗？

1.  **我怎样才能使这项工作？**
2.  **我该如何改进呢？**

**[编辑 - - - - - - - - - - ]**

**在下面彼得非常友好的帮助之后，我仍然需要帮助。他说：**

> 一个视图显示 1 个模型，一个集合视图显示一个视图列表，每个模型一个。

**那么，如何创建一个视图来显示 json 数据中的一项，然后创建集合视图来显示所有这些？我问的原因是因为我可以毫无问题地退回所有物品，但事实证明退回一件物品非常棘手。**

**我也更新了我的代码示例：http: [//jsbin.com/asezul/8/edit](http://jsbin.com/asezul/8/edit)**

**[ - - - - - - - - - - -编辑]**

如果您需要更多信息，请告诉我，我是 Backbone 的新手，可能错过了有助于回答我的问题的重要部分。

这是一些代码摘录，但我建议在 JSbin 中查看代码：

**该模型：**

```
SITE.Project = Backbone.Model.extend({
    initialize: function() {
        console.log(this, this.attributes.name);
    }
}); 
```

**收藏：**

```
SITE.Projects = Backbone.Collection.extend({
    model: SITE.Project,
    url: 'content.json',
    parse: function(response) {
        console.log(response);
        return response.portfolio;
    }
}); 
```

**一个看法：**

```
SITE.ProjectsView = Backbone.View.extend({
    el: '#main',
    initialize: function() {
        _.bindAll(this, 'render');
        // create a collection
        this.collection = new SITE.Projects();
        // Fetch the collection and call render() method
        var that = this;
        this.collection.fetch({
            success: function () {
                that.render();
            }
        });
    },
    template: SITE.helpers.template('project-list'),
    render: function() {
        $(this.el).html(this.template({ projects: this.collection.toJSON() }));
    }
}); 
```

**路由器：**

```
SITE.Router = Backbone.Router.extend({
    initialize: function() {
        this.el = $('#main');
    },
    routes: {
        "": "index",
        "projects": "projects",
        "projects/:id": "project"
    },

    // Homepage / List of projects
    index: function() {
        var view = new SITE.ProjectsView();
    },

    // List of projects
    projects: function() {
        var view = new SITE.ProjectsView();
    },

    // Individual Project
    project: function(id) {
        var view = new SITE.ProjectView();
        console.log("You are trying to reach project " + id);
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:36:56.027

因此，您的数据并不是真正动态的，因此与项目集合不断变化的动态应用程序相比，您可以稍微作弊。我只会在应用程序启动时加载项目集合，然后从那里为您的其余页面使用加载的集合和模型。

```
SITE.Router = Backbone.Router.extend({
    initialize: function() {
        //Router's don't have a this.el
        //this.el = $('#main');
        this.projects = new SITE.Projects();
    },
    routes: {
        "": "index",
        "projects": "projects",
        "projects/:id": "project"
    },

    // Homepage / List of projects
    index: function() {
        var view = new SITE.ProjectsView({collection: this.projects});
        if (this.projects.isEmpty()) {
            this.projects.fetch({success: function () {
                view.render();
            }});
        } else {
            view.render();
        }
    },

    // List of projects
    projects: function() {
        var view = new SITE.ProjectsView({collection: this.projects}).render();
    },

    // Individual Project
    project: function(id) {
        var view = new SITE.ProjectView({model: this.projects.get(id)}).render();
    }
}); 
```

然后让你的观点更简单/愚蠢。视图应该在构造函数/初始化的选项参数中接受它们的模型/集合。试一试，看看你能不能让它发挥作用。否则，您的代码看起来应该能够自行更改相应的视图代码，所以我将把它作为练习留给读者。

# c++ - 链表中的节点 *next

> ID：14103146
> 
> 赞同：2
> 
> 时间：2012-12-31T15:07:12.117
> 
> 标签：c++, data-structures

我是数据结构和算法的新手。我遇到了以下代码

```
typedef struct node                                                
    {                                                               
          int data;            
          node *next;            
    }; 
```

谁能告诉我为什么我们要声明 node *next？*next 不能声明为 int *next 吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-31T15:09:01.447

因为你会希望能够做到`n->next->next->next...`等等。

`next`需要指向另一个`node`，而不是一个`int`，否则之后你将无法看到下一个`int`（你不能这样做`(aInt)->next`，可以吗？）！

您可以将`node`s 视为包含 a `int`（或任何其他数据）和对下一个小框的引用的小框。如果您直接指向数据，那么您将无法获得之后的框（这只是愚蠢的数据！） - 您需要指向框（`node`s）！

这是一张可能有助于理解我的意思的图片（感谢[弗吉尼亚理工大学](http://courses.cs.vt.edu/csonline/DataStructures/Lessons/OrderedListImplementationView/index.html)）： ![这是一个解释它的小图像](../Images/751d1edd0b3b5fbc12a8e27413d74285.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:08:55.643

你可以，但它不会帮助你写一个链表。`node *next`确保您有一个变量 next ，它是指向`node`. `int *next`这意味着 next 将指向一个整数而不是`node`, 不会给你链接列表，这就是你似乎正在寻找的。

# java - Quartz 调度程序：如何通过 API 从 Java 动态读取石英属性？

> ID：14103150
> 
> 赞同：1
> 
> 时间：2012-12-31T15:07:26.180
> 
> 标签：java, quartz-scheduler

[Quartz](http://quartz-scheduler.org/documentation/quartz-1.x/quick-start)通常通过`quartz.properties`类路径配置。

例如：

```
org.quartz.scheduler.instanceName = BagginsScheduler
org.quartz.threadPool.class=org.quartz.simpl.SimpleThreadPool   
org.quartz.threadPool.threadCount=5  
org.quartz.threadPool.threadPriority=1 
```

在将运行 Quartz 作业的同一应用程序中，**我想读出属性。**

读取调度程序名称很容易：

```
Scheduler scheduler = StdSchedulerFactory.getDefaultScheduler();  
String name = scheduler.getSchedulerName(); 
```

但是我怎样才能读取 `threadPriority' 属性呢？

**以下不起作用：**

```
scheduler.getContext().getString("org.quartz.threadPool.threadPriority"); 
```

**更新的解决方案**：似乎无法通过 Quartz API 读取该属性，您必须通过常规`Properties`：

```
Properties prop = new Properties();
prop.load(AnyClassUsedByJVM.class.getClassLoader().getResourceAsStream("quartz.properties"));
String prio = prop.getProperty("org.quartz.threadPool.threadPriority"); 
```

这工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T15:10:59.577

您只需将该属性添加到您的`quartz.properties`. 例如：

```
org.quartz.threadPool.threadPriority=3 
```

有关更多信息，请参阅[此处](http://quartz-scheduler.org/documentation/quartz-1.x/configuration/ConfigThreadPool)和[配置文档](http://quartz-scheduler.org/documentation/quartz-1.x/configuration/)

**编辑**：要在运行时读取属性，您可以使用[Properties](http://docs.oracle.com/javase/7/docs/api/java/util/Properties.html)。这是您可以使用的示例代码片段：

```
Properties p = new Properties();
p.load("/tmp/quartz.properties"); // path to your properties file
System.out.println(p.getProperty("org.quartz.threadPool.threadPriority"); // prints 3 
```

# c# - 列表和 foreach

> ID：14103151
> 
> 赞同：6
> 
> 时间：2012-12-31T15:07:27.920
> 
> 标签：c#, wpf, listview, foreach

我似乎遇到了一个非常奇怪的问题，我真的不知道发生了什么。这是我正在尝试调试的源代码

```
StorageFile file = await roamingFolder.GetFileAsync(filename);
string text = await FileIO.ReadTextAsync(file);

string[] shows = text.Split(new[] { ":?;" }, StringSplitOptions.None);
List<show> showslist = new List<show>();

foreach (string splitshow in shows)
{
    string[] show1 = splitshow.Split(new[] { ",?;" }, StringSplitOptions.None);
    episode = show1[0];
    name = show1[1];

    showslist.Add(new show { name = name, episode = episode });
}

Output.ItemsSource = showslist; 
```

奇怪的是，只有当我放入`Output.ItemsSource = showslist;`foreach 循环内部时才会显示该列表，而不是当它在外部时才显示，我真的不明白为什么它不是。我的意思是列表的元素已经添加到它不是吗？

尝试了许多不同的方法，其中大多数即使确实显示列表数据也存在许多不同的问题，这些问题太混乱而无法修复。

无论如何感谢任何提示或帮助，谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-31T16:01:27.710

我敢打赌，您的数据并不完全正确。我认为后来/最后的条目之一是引发异常，并且它在您的代码中被更高的吞没（或者没有被报告给您的记录器/用户界面）。`foreach`在您分配数据源之前，它永远不会完成循环并退出该方法。

我猜您的第二次拆分，其中一个条目实际上并不包含您的分隔符`,?;`，因此该`show1`数组的长度仅为 1 并且不包含“名称”条目。当您尝试访问`show1[1]`时，它会抛出一个`IndexOutOfRangeException`.

顺便说一句，我是否建议您使用更简单的分隔符进行调查，或者更好的是，使用某种形式的 XML（或 JSON，或其他）序列化来读取您的数据。

编辑：我从您在评论中发布的代码示例中看到，问题是最后一个条目。给定`hlj,?;lljhjh:?;hhmm,?;drr:?;oo,?;hello:?;ff,?;ff:?;`，您的第一个`String.Split`操作`:?;`将产生一个空字符串作为最后一个条目。因此，当您尝试对其执行第二次拆分时，`,?;`它会拆分为空并返回一个包含单个条目的数组`String.Empty`。当你点击`show1[1]`异常时抛出。

如果您将第一个拆分更改为使用`StringSplitOptions.RemoveEmptyEntries`它应该消除空条目：

```
string[] shows = text.Split(new[] { ":?;" }, StringSplitOptions.RemoveEmptyEntries); 
```

如果您愿意，您可以添加一个检查，这样`if (show1.Length == 2)`您就可以避免不良数据（但也许您更愿意报告它以便修复它）。如果您的程序本身正在编写这些不良数据，也许您应该进行一些快速的单元测试，以确保您始终在写入/读取有效数据。

# objective-c - UIActivityViewController 如何将字符串转换为打印

> ID：14103152
> 
> 赞同：2
> 
> 时间：2012-12-31T15:07:30.230
> 
> 标签：objective-c, ios6

我正在使用 UIActivityViewController 从我的应用程序中共享一些文本。我可以将文本发送到消息、电子邮件、副本等，但我无法将其发送到打印。

我看到 UIActivityTypePrint 采用 NSData 的数据类型。如何创建 UIActivityViewController 以将我的字符串作为字符串和 NSData 以使视图具有可用的打印选项？

```
NSString *textToShare = self.note.note;
        NSArray *itemsToShare = [[NSArray alloc] initWithObjects:textToShare, nil];
        shareVC = [[UIActivityViewController alloc] initWithActivityItems:itemsToShare applicationActivities:nil];
        shareVC.excludedActivityTypes = [[NSArray alloc] initWithObjects:UIActivityTypeSaveToCameraRoll,  UIActivityTypePostToWeibo, nil]; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-31T16:14:47.900

知道了。它不直接采用 NSData，它采用 UISimpleTextPrintFormatter。

```
NSString *textToShare = self.note.note;

UISimpleTextPrintFormatter *printData = [[UISimpleTextPrintFormatter alloc]
                                                         initWithText:textToShare];
NSArray *itemsToShare = [[NSArray alloc] initWithObjects:textToShare,printData, nil];
shareVC = [[UIActivityViewController alloc] initWithActivityItems:itemsToShare applicationActivities:nil];
shareVC.excludedActivityTypes = [[NSArray alloc] initWithObjects:UIActivityTypeSaveToCameraRoll,  UIActivityTypePostToWeibo, nil]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:21:32.020

Add another item of NSData type in the array itemsToShare

```
NSString *textToShare = self.note.note;
NSData* data = [textToShare dataUsingEncoding:NSUTF8StringEncoding];
NSArray *itemsToShare = [[NSArray alloc] initWithObjects:textToShare,data, nil];
shareVC = [[UIActivityViewController alloc] initWithActivityItems:itemsToShare applicationActivities:nil];
shareVC.excludedActivityTypes = [[NSArray alloc] initWithObjects:UIActivityTypeSaveToCameraRoll,  UIActivityTypePostToWeibo, nil]; 
```

OR

use dictionary to send item

```
NSString *textToShare = self.note.note;
NSData* data = [textToShare dataUsingEncoding:NSUTF8StringEncoding];

NSMutableDictionary *dictionary = [NSMutableDictionary dictionary];
[dictionary setObject:textToShare forKey:@"shareString"];
[dictionary setObject:data forKey:@"shareData"];
NSArray *itemsToShare = [[NSArray alloc] initWithObjects:dictionary, nil];
[dictionary release];
shareVC = [[UIActivityViewController alloc] initWithActivityItems:itemsToShare applicationActivities:nil];
shareVC.excludedActivityTypes = [[NSArray alloc] initWithObjects:UIActivityTypeSaveToCameraRoll,  UIActivityTypePostToWeibo, nil]; 
```

# algorithm - 从给定数字计算唯一值

> ID：14103153
> 
> 赞同：3
> 
> 时间：2012-12-31T15:07:37.280
> 
> 标签：algorithm

假设我有一些 6 个随机数，我想从这些数字中计算出一些唯一值。

**编辑：** 允许的操作是 +、-、* 和 /。每个号码只能使用一次。您不必使用所有数字。

**例子：**

```
Given numbers: 3, 6, 100, 50, 25, 75
Requested result: 953

3 + 6 = 9
9 * 100 = 900
900 + 50 = 950
75 / 25 = 3
3 + 950 = 953 
```

编写解决此问题的程序的**最简单**算法方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T15:12:11.317

最简单的方法是全部尝试：您有六个数字，这意味着您可以在最多五个位置放置运算符，并且最多可以`6!`排列。鉴于只有四个运算符，您需要通过`6!*4^5`, 或 737280 种可能性。这可以通过递归函数轻松完成，甚至可以使用嵌套循环。根据语言，您可以使用库函数来处理排列。

与语言无关的递归方法将让您定义三个函数：

```
int calc(int nums[6], int ops[5], int countNums) {
    // Calculate the results for a given sequence of numbers
    // with the specified operators.
    // nums are your numbers; only countNums need to be used
    // ops are your operators; only countNums-1 need to be used
    // countNums is the number of items to use; it must be from 1 to 6
}

void permutations(int nums[6], int perm[6], int pos) {
    // Produces all permutations of the original numbers
    // nums are the original numbers
    // perm, 0 through pos, is the indexes of nums used in the permutation so far
    // pos, is the number of perm items filled so far
}

void solveRecursive(int numPerm[6], int permLen, int ops[5], int pos) {
    // Tries all combinations of operations on the given permutation.
    // numPermis the permutation of the original numbers
    // permLen is the number of items used in the permutation
    // ops 0 through pos are operators to be placed between elements
    // of the permutation
    // pos is the number of operators provided so far.
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-31T15:16:29.093

我认为最简单的算法方法是[回溯](http://en.wikipedia.org/wiki/Backtracking)。它相当容易实现，如果存在，总会找到解决方案。基本思想是递归的：在构建解决方案的每个步骤中做出任意选择，然后从那里开始。如果不成功，请尝试不同的选择。当您用完选项时，将失败报告到上一个选择点（如果没有上一个选择点，则报告找不到解决方案）。

您的选择是：将涉及多少个数字，每个数字是什么（每个数字位置的选择）以及操作员如何连接它们（每个操作员位置的选择）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T15:14:07.863

当您提到“唯一数字”时，假设您的意思是使用手头的所有数字生成的可能结果域中的结果。

如果是这样，为什么不首先尝试排列所有运算符和可用数字呢？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-31T15:36:57.080

如果你想保证你从这些数字中生成一个唯一的数字，而没有机会从不同的数字集中得到相同的数字，那么你应该使用基数算术，类似于十进制、十六进制等。

但是您需要知道数字的最大值。

基本上，它会是`A + B * MAX_A + C * MAX_A * MAX_B + D * MAX_A * MAX_B * MAX_C + E * MAX_A * MAX_B * MAX_C * MAX_D + F * MAX_A * ... * MAX_E`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-31T15:22:15.110

使用递归来排列数字和运算符。它是 O(6!*4^5)

# c# - 如何使用 HttpClient 确定是否从缓存中完成了 HttpResponseMessage

> ID：14103154
> 
> 赞同：6
> 
> 时间：2012-12-31T15:07:37.547
> 
> 标签：c#, .net, http, dotnet-httpclient

使用[HttpClient](http://msdn.microsoft.com/en-us/library/hh193681%28v=VS.110%29.aspx)和[HttpResponseMessage时，与](http://msdn.microsoft.com/en-us/library/system.net.http.httpresponsemessage.aspx)[WebResponse.IsFromCache](http://msdn.microsoft.com/en-US/library/system.net.webresponse.isfromcache%28v=vs.110%29.aspx)等效的是什么？

我可以查看响应中的一些 HTTP 标头吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-02T21:50:22.297

仅供参考：Windows.Web.Http HttpClient（针对 Windows 8.1 应用程序开发的类似 API）确实包含一个 HttpResponseMessage.Source 字段，该字段指定结果的来源（常见值为“缓存”和“网络”）。

Windows.Web.Http 类可用于 C# 和其他 .NET 语言、C++ 和 JavaScript（当作为 WwaHost 应用程序运行时，如来自 Windows 应用商店）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T01:48:02.127

我能问一下你想达到什么目的吗？是否试图避免缓存？

问的原因是我已经查看了`HttpClient`（特别是`HttpClientHandler`）的源代码和源代码`HttpWebResponse`，我不相信你可以从标题中获得这些信息。

HttpClient/HttpClientHandler*确实在* `HttpWebResponse`内部使用，但它*不会*公开以下所有属性`HttpWebResponse`：

```
private HttpResponseMessage CreateResponseMessage(HttpWebResponse webResponse, HttpRequestMessage request)
{
      HttpResponseMessage httpResponseMessage = new HttpResponseMessage(webResponse.StatusCode);
      httpResponseMessage.ReasonPhrase = webResponse.StatusDescription;
      httpResponseMessage.Version = webResponse.ProtocolVersion;
      httpResponseMessage.RequestMessage = request;
      httpResponseMessage.Content = (HttpContent) new StreamContent((Stream) new HttpClientHandler.WebExceptionWrapperStream(webResponse.GetResponseStream()));

      //this line doesnt exist, would be nice
      httpResponseMessage.IsFromCache = webResponse.IsFromCache;// <-- MISSING!
     ...
 } 
```

所以你的选择在我看来是：

a）查看源代码`HttpWebRequest`以确定逻辑`IsFromCache`并以某种方式对其进行改造`HttpClient`（这甚至可能不可能，取决于逻辑实际做什么/需要什么）

b) 要求 ASP.NET 团队将此属性包含在 HttpResponseMessage 中。要么直接作为财产，要么他们可以“保留”`HttpWebResponse`

这些选项都不是那么抱歉，因此我最初的问题是，你想达到什么目的？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-12-05T19:57:02.793

我最近也一直在为这种情况而苦苦挣扎。

我需要的是一个集成测试来验证：

*   对新创建资源的响应具有服务器设置的正确标头。
*   对该资源的后续请求是从客户端缓存中完成的。
*   对现有资源的响应也具有服务器设置的正确标头。

我最终做的是双重检查：

用于检查初始响应的非缓存 HttpClient：

```
new WebRequestHandler
{
  AllowAutoRedirect = true,
  UseCookies = true,
  CookieContainer = new CookieContainer(),
  CachePolicy = new HttpRequestCachePolicy(HttpRequestCacheLevel.Refresh)
};

var client = new HttpClient(handler) 
```

和第二个 HTTP 客户端检查客户端缓存：

```
new WebRequestHandler
{
  AllowAutoRedirect = true,
  UseCookies = true,
  CookieContainer = new CookieContainer(),
  CachePolicy = new HttpRequestCachePolicy(HttpRequestCacheLevel.Default)
};

var client = new HttpClient(handler) 
```

为了验证响应消息的来源，我比较了第`HttpResponseMessage.Headers.Date`1 步和第 2 步的值（如果响应来自客户端缓存，这将是相同的）。对于我的第三步，我可以重新使用第一步中的客户端并将任意字符串附加到 URL。

免责声明：这适用于 .NET Framework 4.7，并忽略了有关 HttpClient 使用的最佳实践，但在我的测试套件中似乎对我有用。像上面提到的那样的显式属性会更好，但似乎不可用。由于这里的最后一个回复已经有几年了，可能有更好的方法来处理这个问题，但我想不出一个。

# guice - play.exceptions.JPAException：JPA 上下文未初始化

> ID：14103155
> 
> 赞同：1
> 
> 时间：2012-12-31T15:07:43.100
> 
> 标签：guice, playframework-1.x

我有一个bean，它在构造函数中访问JPA，例如从数据库预加载缓存。

在应用程序启动时我收到

```
Caused by: java.lang.IllegalStateException: Unable to create Guice injector 
```

Guice注入导致应用启动失败

```
1) Error injecting constructor, play.exceptions.JPAException: The JPA context is not initialized.
 JPA Entity Manager automatically start when one or more classes annotated with the @javax.persistence.Entity annotation are found in the application. 
```

这个问题的根本原因是，Guice 在播放 JPA 实体管理器之前创建了我的 bean 的实例。其余的 JPA 代码可以正常工作，如果我在 bean 的构造函数中注释 JPA 调用，它也可以正常工作。

要配置我的 bean，请使用以下代码片段：

```
public class MainGuiceModule extends AbstractModule {
    @Override
    protected void configure() {
             bind(UserManager.class).to(UserManagerImpl.class).in(Singleton.class);
              ...
        }
} 
```

问题是，如何使用 Play 从构造函数访问 JPA！和古斯？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T17:46:03.807

最后我找到了避免这种异常的方法，我必须用

```
play.Play.plugin(JPAPlugin.class).startTx(true); 
```

和

```
play.Play.plugin(JPAPlugin.class).closeTx(false); 
```

我会接受更优雅的解决方案的答案

# c# - PreviewMouseLeftButtonDown 干扰点击选择

> ID：14103159
> 
> 赞同：1
> 
> 时间：2012-12-31T15:08:00.230
> 
> 标签：c#, wpf, xaml, drag-and-drop, listbox

我已实现此代码以在列表框中执行拖动功能。

[http://www.c-sharpcorner.com/uploadfile/dpatra/drag-and-drop-item-in-listbox-in-wpf/](http://www.c-sharpcorner.com/uploadfile/dpatra/drag-and-drop-item-in-listbox-in-wpf/)

但意识到事件 PreviewMouseLeftButtonDown 会干扰 clic 选择。所以当我想选择一个项目时，我必须在项目中单击两次。

我应该修改什么来修复这个错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T17:06:55.260

为避免干扰正常选择，通常在您通过 DragDrop.DoDragDrop() 实际执行拖放操作之前让用户将项目拖动几个像素（在您的示例中，正是此调用中断了正常的单击选择）。

一种方法是稍微扩展您的示例，并通过侦听 ListBox 的 PreviewMouseMove 和 PreviewMouseLeftButtonUp 事件以及 PreviewMouseLeftButtonDown 事件来跟踪“潜在的拖动”：

```
<ListBox x:Name="lbOne" 
         PreviewMouseLeftButtonDown="ListBox_PreviewMouseLeftButtonDown"
         PreviewMouseMove="ListBox_PreviewMouseMove"
         PreviewMouseLeftButtonUp="ListBox_PreviewMouseLeftButtonUp"
         ... /> 
```

请注意我们在这里如何使用*potentialDragStartPoint*，以及如何将大量代码从 ListBox_PreviewMouseLeftButtonDown 移动到 ListBox_PreviewMouseMove：

```
ListBox dragSource = null;
Point? potentialDragStartPoint = null;

private void ListBox_PreviewMouseLeftButtonDown(object sender, MouseButtonEventArgs e)
{
    if (potentialDragStartPoint == null)
    {
        ListBox parent = (ListBox)sender;
        potentialDragStartPoint = e.GetPosition(parent);
    }
}

private void ListBox_PreviewMouseLeftButtonUp(object sender, MouseButtonEventArgs e)
{
    potentialDragStartPoint = null;
}

private void ListBox_PreviewMouseMove(object sender, MouseEventArgs e)
{
    if (potentialDragStartPoint == null) { return; }

    ListBox parent = (ListBox)sender;
    var dragPoint = e.GetPosition(parent);

    Vector potentialDragLength = dragPoint - potentialDragStartPoint.Value;
    if (potentialDragLength.Length > 5)
    {
        dragSource = parent;
        object data = GetDataFromListBox(dragSource, potentialDragStartPoint.Value);

        if (data != null)
        {
            DragDrop.DoDragDrop(parent, data, DragDropEffects.Move);
            potentialDragStartPoint = null;
        }
    }
} 
```

# cordova - 低/高通滤波器

> ID：14103164
> 
> 赞同：0
> 
> 时间：2012-12-31T15:08:44.707
> 
> 标签：cordova, filter, lowpass-filter

我正在创建一个 android phonegap 应用程序来检测路面不规则性，例如坑洼和减速带。我依靠手机通过 phonegap 提供的加速度计值，并将使用这些值进行一些处理。

然而，由于这些值相当粗糙，我想使用某种过滤来平滑这些值。我知道有低通和高通滤波器。但是它们之间有什么区别呢？在我的应用程序中使用一个而不是另一个会如何影响值的平滑性和可靠性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:13:32.417

这么说可能有点轻率，但直截了当的解释是低通滤波器允许低频并拒绝/减少高频，反之亦然。

平滑通常包括拒绝高频分量。您可以通过一些简单的技术取得进步：

1.  简单移动平均（简单地平均最近的*N*个样本）。

2.  指数移动平均线 ( `y[n] = alpha * y[n-1] + (1 - alpha) * x[n]`)。

有关更多信息，请参见例如[http://en.wikipedia.org/wiki/Moving_average](http://en.wikipedia.org/wiki/Moving_average)。

选择*N*或*alpha*参数的值需要特定于应用程序的调整。

然而，正确的过滤器设计是一门复杂的科学/艺术。例如，拒绝高频分量可能会削弱您检测“真实”事件（如坑洼）的能力（它们也会被平滑掉）。您可能开始需要复杂的非线性技术，例如阈值处理。但这是整本书的主题！

# c++ - C++ 容器上的 Seg 故障循环

> ID：14103174
> 
> 赞同：0
> 
> 时间：2012-12-31T15:09:47.827
> 
> 标签：c++, std

这是代码（查找 2 组的并集）：

```
template <class dtype>
void printSet(dtype data)
{
    std::cout<<"\n";
    for(auto i = data.begin(); i != data.end(); i++)
    {
        std::cout<<*i<<" ,";
    }
}

int main(int argc, char const *argv[])
{
    int arr[] = {1,2,3,4,5};
    std::set<long long> a(arr, arr + 5), b(arr, arr + 5), c;
    std::vector<long long> v;
    b.insert(1000);
    printSet(a);
    printSet(b);
    set_union(a.begin(), a.end(), b.begin(), b.end(), v.begin());
    printSet(v);
    return 0;
} 
```

这就是我得到的：

```
1 ,2 ,3 ,4 ,5 ,
[1]    9444 segmentation fault  ./a.out 
```

我哪里搞砸了？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-31T15:14:28.837

`v``v.begin()`为空，因此无法写入。你应该`std::back_inserter(v)`改用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-31T15:12:25.350

`set_union`期望一个有效的输出迭代器，在某种意义上它应该被允许在那个迭代器上写。`v`为空，因此`v.begin()`不是有效的迭代器。

尝试将您的向量声明为

```
std::vector<long long> v(42); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-31T16:09:28.453

为清楚起见：如果您`std::cout`在该`set_union`行之前冲洗，您应该看到它也`b`被打印出来。

至于错误，我建议添加以下内容：

```
#include <iterator> 
```

并将您的`set_union`线路更改为：

```
set_union(a.begin(), a.end(), b.begin(), b.end(), back_inserter(v)); 
```

`back_insert_iterator`返回的 by是`back_inserter`一个适合在这里使用的输出迭代器：它将调用`v.push_back`分配给它的每个项目`set_union`。

* * *

## 关于您的平台和环境的说明：

一般来说，您应该确保您的核心文件大小限制不为零（除非您正在编写大量程序，否则请使其不受限制），并学习使用调试器检查核心文件。

# java - 有没有一种简单的方法来调用睡眠和传播异常

> ID：14103181
> 
> 赞同：4
> 
> 时间：2012-12-31T15:10:28.190
> 
> 标签：java, guava

我想打电话`Thread.sleep`，并传播`InterruptException`if 确实它被抛出了。

虚构语法：

```
Interruptibles.sleep(1000); 
```

这相当于

```
try {
    Thread.sleep(1000);
} catch (InterruptException e) {
    throw Throwables.propagate(e);
} 
```

公共库（番石榴、apache commons 等）中是否有类似的功能。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-01T04:06:00.767

包装在 RuntimeException 中可能会导致痛苦。这是一个复杂的话题，我推荐 Java Concurrency in Practice 中的相关部分，以充分了解您的选择。
Guava 有[sleepUninterruptibly](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/util/concurrent/Uninterruptibles.html#sleepUninterruptibly%28long,%20java.util.concurrent.TimeUnit%29)，它实现了那里描述的标准习语之一。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-31T15:25:32.933

你可以这样做。

```
try {
    Thread.sleep(1000);
} catch (InterruptException e) {
    Thread.currentThread().interrupt();
} 
```

或者

```
try {
    Thread.sleep(1000);
} catch (InterruptException e) {
    Thread.currentThread().stop(e);
} 
```

但通常最好让异常“冒泡”到可以正确处理的地方。您的 IDE 可以通过填写您需要的代码来简化此操作。

# javascript - CSS 框布局，如 google webstore

> ID：14103185
> 
> 赞同：0
> 
> 时间：2012-12-31T15:11:01.253
> 
> 标签：javascript, html, css

我有一个网站，其设计类似于谷歌网上商店。这是它的样子：

![在此处输入图像描述](../Images/742363c70b35a4bfb4dafa3be51f5a5f.png)

如果您在底部区域注意到 2 个框并没有填满上面的空间。

盒子被包裹起来`ul`，物品在`li`. 列表项是向左浮动的，并且`ul`是明确的。

这是 jsfiddle [http://jsfiddle.net/wTCKr/的链接](http://jsfiddle.net/wTCKr/)

请建议 CSS 或任何可以解决此问题的 JS。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:47:47.153

如果你想要右边的大盒子，你需要让它们向右浮动，这样左边的小盒子才能正确填充。

```
<li class="items big" style="float:right"> 
```

请参阅[此更新的 JS Fiddle fork](http://jsfiddle.net/BMWnh/1/)。

如果将大盒子放在中间，这将无法解决问题。如果你还需要支持这种情况，我建议是时候使用绝对定位和一些 jQuery 或 JS 来为你做布局了。

更新：我喜欢快速挑战，所以我写了一些[JS 来](http://jsfiddle.net/eNhvd/)为你做绝对定位。我使用了 jQuery，但如果您的网站上不使用 jQuery，您可以将其转换为直接的 JS。该代码假定您在有效顺序中拥有正确数量的框（例如，如果所有其他行都用小框填充，则不能在最后一行放置大框）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:57:54.577

你可以做`ul { top: -200px or margin-top: -200px;}`，这会奏效。

# python - Appengine 数据存储区属性 fromString() 方法

> ID：14103195
> 
> 赞同：1
> 
> 时间：2012-12-31T15:12:21.700
> 
> 标签：python, google-app-engine

是否有一种通用方法可以从字符串中设置数据存储实体实例中的属性，以便它根据属性类型执行基础转换。

```
person = Person ()
person.setattr("age", "26") # age is an IntegerProperty
person.setattr("dob", "1-Jan-2012",[format]) # dob is a Date Property 
```

这很容易编写，但这是一个非常常见的用例，想知道 Datastore Python API 是否有任何规定。

（对不起，如果这是一个普通的问题，我对 Appengine 比较陌生，无法通过文档找到）。

感谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:02:20.570

几天前，我对另一个用例有同样的问题。为了解决这个问题，我创建了一个属性类型列表，以进行我需要的转换。该解决方案利用了未记录的 db 函数和 db.Model 类的内部结构。也许有更好的解决方案。

```
from google.appengine.ext import db
kind = 'Person'
models_module = { 'Person' : 'models'}       # module to import the model kind from

model_data_types = {}                        # create a dict of properties, like DateTimeProperty, IntegerProperty
__import__(models_module[kind], globals(), locals(), [kind], -1) 
model_class = db.class_for_kind(kind)        # not documented
for key in model_class._properties :         # the internals of the model_class object
    model_data_types[key] = model_class._properties[key].__class__.__name__ 
```

要转换字符串，您可以创建一个具有字符串转换函数的类，例如：

```
class StringConversions(object)

    def IntegerProperty(self, astring):

        return int(astring)     

    def DateTimeProperty(self, astring):

        # do the conversion here
        return .... 
```

并像这样使用它：

```
property_name = 'age'
astring = '26'

setattr(Person, property_name, getattr(StringConversions,  model_data_types[property_name] )(astring) ) 
```

**更新：**

没有文档： `db.class_for_kind(kind)` 但是有更好的解决方案。替换这两行：

```
__import__(models_module[kind], globals(), locals(), [kind], -1) 
model_class = db.class_for_kind(kind)        # not documented 
```

和 ：

```
module = __import__(models_module[kind], globals(), locals(), [kind], -1) 
model_class = getattr(module, kind) 
```

# powershell - 如何判断我是否在远程 PowerShell 会话中？

> ID：14103197
> 
> 赞同：10
> 
> 时间：2012-12-31T15:12:28.877
> 
> 标签：powershell, powershell-remoting

我想执行特定于远程 PSSession 的代码。也就是说，该代码不适用于本地，但适用于所有远程会话。

如果我处于活动的 PSSession 中，是否有任何环境变量、函数或 cmdlet 可以有效地返回 true，如果我在本地运行则返回 false？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-31T16:01:35.783

检查`$PSSenderInfo`变量是否存在。从*about_Automatic_Variables*：

> ### `$PSSenderInfo`
> 
> 包含有关启动 PSSession 的用户的信息，包括用户身份和原始计算机的时区。此变量仅在 PSSessions 中可用。
> 
> 该`$PSSenderInfo`变量包括一个用户可配置的属性 ， `ApplicationArguments`默认情况下，它仅包含 `$PSVersionTable`来自原始会话的 。要将数据添加到 `ApplicationArguments`属性，请使用cmdlet的`ApplicationArguments`参数。`New-PSSessionOption`

# parsing - LR(1) 项 DFA - 计算前瞻

> ID：14103199
> 
> 赞同：21
> 
> 时间：2012-12-31T15:12:58.393
> 
> 标签：parsing, context-free-grammar, lookahead, dfa, lr

我很难理解如何计算 LR(1) 项的前瞻。

可以说我有这个语法：

```
S -> AB
A -> aAb | a
B -> d 
```

LR(1)-item 是具有前瞻功能的 LR(0) 项。所以我们将得到状态 0 的以下 LR(0)-item：

```
S -> .AB , {lookahead} 
A -> .aAb,  {lookahead} 
A -> .a,  {lookahead} 
```

状态：1

```
A ->  a.Ab, {lookahead} 
A ->  a. ,{lookahead} 
A -> .aAb ,{lookahead} 
A ->.a ,{lookahead} 
```

有人可以解释如何计算前瞻吗？一般的做法是什么？

先感谢您

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-01-02T18:35:35.163

LR(1) 解析器中使用的前瞻计算如下。首先，开始状态有一个项目的形式

```
S -> .w  ($) 
```

对于每个产生式 S -> w，其中 S 是开始符号。这里，$ 标记表示输入的结束。

接下来，对于包含 A -> x.By (t) 形式的项目的任何状态，其中 x 是终端和非终端的任意字符串，B 是非终端，添加 B -> .w 形式的项目(s) 对于每个产生式 B -> w 以及对于集合 FIRST(yt) 中的每个终端。（这里，FIRST 指的是[FIRST 集合](http://www.cs.virginia.edu/~cs415/reading/FirstFollowLL.pdf)，通常在谈论 LL 解析器时介绍。如果您以前没有见过它们，我会花几分钟时间看一下那些讲义）。

让我们在你的语法上试试这个。我们首先创建一个项目集，其中包含

```
S -> .AB ($) 
```

接下来，使用我们的第二条规则，对于 A 的每个产生式，我们添加一个与该产生式相对应的新项目，并在 FIRST(B$) 中添加每个终端的前瞻。由于 B 总是产生字符串 d，FIRST(B$) = d，所以我们介绍的所有产生式都会有前瞻 d。这给

```
S -> .AB ($)
A -> .aAb (d)
A -> .a (d) 
```

现在，让我们构建与在此初始状态下看到“a”相对应的状态。我们首先将每个以 a 开头的产品的点移动一个步骤：

```
A -> a.Ab (d)
A -> a. (d) 
```

现在，由于第一个项目在非终结符之前有一个点，我们使用我们的规则为 A 的每个产生式添加一个项目，让这些项目提前 FIRST(bd) = b。这给

```
A -> a.Ab (d)
A -> a. (d)
A -> .aAb (b)
A -> .a (b) 
```

继续这个过程最终会为这个 LR(1) 解析器构建所有的 LR(1) 状态。这显示在这里：

```
[0]
S -> .AB  ($)
A -> .aAb (d)
A -> .a   (d)

[1]
A -> a.Ab (d)
A -> a.   (d)
A -> .aAb (b)
A -> .a   (b)

[2]
A -> a.Ab (b)
A -> a.   (b)
A -> .aAb (b)
A -> .a   (b)

[3]
A -> aA.b (d)

[4]
A -> aAb. (d)

[5]
S -> A.B  ($)
B -> .d   ($)

[6]
B -> d.   ($)

[7]
S -> AB.  ($)

[8]
A -> aA.b (b)

[9]
A -> aAb. (b) 
```

如果有帮助，我去年夏天教了一个编译器课程，并**[在网上提供了所有的讲座幻灯片](http://www.stanford.edu/class/archive/cs/cs143/cs143.1128/)**。自底向上解析的幻灯片应该涵盖了 LR 解析和解析表构建的所有细节，希望对您有用！

希望这可以帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-03-14T06:55:52.080

这是语法的 LR(1) 自动机，因为上面已经完成了以下操作

![这是语法的自动机](../Images/4fcc647124cacb14b2207567305b0bd0.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T06:39:30.287

你构建的 LR(1) 项集应该还有两个项。

I8 A--> aA.b ，来自 I2 的 b

I9 A--> aAb。, b 来自 I8

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-29T07:33:02.817

我也得到 11 个州，而不是 8 个：

```
State 0
        S: .A B ["$"]
        A: .a A b ["d"]
        A: .a ["d"]
    Transitions
        S -> 1
        A -> 2
        a -> 5
    Reductions
        none
State 1
        S_Prime: S .$ ["$"]
    Transitions
        none
    Reductions
        none
State 2
        S: A .B ["$"]
        B: .d ["$"]
    Transitions
        B -> 3
        d -> 4
    Reductions
        none
State 3
        S: A B .["$"]
    Transitions
        none
    Reductions
        $ => S: A B .
State 4
        B: d .["$"]
    Transitions
        none
    Reductions
        $ => B: d .
State 5
        A: a .A b ["d"]
        A: .a A b ["b"]
        A: .a ["b"]
        A: a .["d"]
    Transitions
        A -> 6
        a -> 8
    Reductions
        d => A: a .
State 6
        A: a A .b ["d"]
    Transitions
        b -> 7
    Reductions
        none
State 7
        A: a A b .["d"]
    Transitions
        none
    Reductions
        d => A: a A b .
State 8
        A: a .A b ["b"]
        A: .a A b ["b"]
        A: .a ["b"]
        A: a .["b"]
    Transitions
        A -> 9
        a -> 8
    Reductions
        b => A: a .
State 9
        A: a A .b ["b"]
    Transitions
        b -> 10
    Reductions
        none
State 10
        A: a A b .["b"]
    Transitions
        none
    Reductions
        b => A: a A b . 
```

# php - 如何在没有 FETCHALL 的情况下在 MYSQL PDO 中获取 2 次

> ID：14103202
> 
> 赞同：5
> 
> 时间：2012-12-31T15:13:21.613
> 
> 标签：php, mysql, pdo, while-loop, fetch

我有这个示例查询：

```
$STH = $DBH->query("SELECT id FROM table"); 
```

我想获取第一行，然后循环并显示所有行。所以我使用以下内容来获取第一行：

```
$STH->setFetchMode(PDO::FETCH_ASSOC);
$first_row = $STH->fetch();
$first_row = $first_row['id']; 
```

我使用 while 循环再次显示所有行：

```
while ($list = $STH->fetch()) {      
$id = $list['id'];
echo $id;
} 
```

现在 while 跳过第一行，我希望它显示出来。是否有相当于`mysql_data_seek`将指针再次重置到第一行？我知道`fetchall`可以使用，但它对内存不好并且浪费。我也可以运行查询并限制为 1，但不建议这样做，因为我有一个连接多个表的查询并且会非常慢。还有其他解决方案吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T15:19:58.240

我收回它，看起来你可以使用光标方向内容来选择结果......示例代码来了......我还没有尝试过，所以你可能需要玩一下。这也是基于这样的假设，即 a 的`PDO::FETCH_ORI_FIRST`行为类似于 data_seek 并将光标留在第一个位置，而不是将其返回到之前的位置。

```
$stmt = $pdo->prepare('SELECT id FROM table', array(PDO::ATTR_CURSOR => PDO::CURSOR_SCROLL));
$stmt->execute();

$first = $pdo->fetch(PDO::FETCH_ASSOC, PDO::FETCH_ORI_FIRST);
$first_row = $first['id'];

// other stuff

// first iteration we rewind to the first record;
$cursor = PDO::FETCH_ORI_FIRST;

while (false !== ($row = $stmt->fetch(PDO::FETCH_ASSOC, $cursor))) {
   $id = $row['id'];
   // successive iterations we hit the "next" record
   $cursor = PDO::FETCH_ORI_NEXT; 
   echo $id;
} 
```

* * *

我不认为你可以倒回一个语句......假设这些块不是由一堆中间逻辑 id 分隔的，只需在循环中执行。

```
$STH->setFetchMode(PDO::FETCH_COLUMN); // no need to pull an array
$count = 0;
while ($id = $STH->fetch()) {      
  if($count === 0) {
   $first_row = $id;
  }
  echo $id;
  $count++;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:16:49.157

你能用一个`do...while`循环来代替吗？

```
$STH->setFetchMode(PDO::FETCH_ASSOC);
$list = $STH->fetch();
$first_id = $list['id'];

do {
  $id = $list['id'];
  echo $id;
} while ($list = $STH->fetch()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T15:17:27.923

您可以获取所有结果，然后将其作为数组处理。因此，例如，您可以将第一个结果从前面移开，然后遍历任何其他行：

```
<?php

$sql = "YOUR QUERY";
$stmt = $pdo->prepare($sql);
$stmt->execute();
$rows = $stmt->fetchAll(PDO::FETCH_ASSOC);

// get first row
$firstRow = array_shift($rows);

// loop over remaining rows
foreach ($rows as $row) {
    // do something
} 
```

# java - 删除模板输出上不必要的换行符？

> ID：14103205
> 
> 赞同：5
> 
> 时间：2012-12-31T15:13:40.763
> 
> 标签：java, templates, rest, playframework-2.0

使用 Play 2 我正在实现一个简单的 REST API，输出是纯文本。我的模板如下所示：

```
@(items: Map[String,String]) 
@for((key, value) <- items) {
@value
@key
} 
```

在控制器中：

```
return ok(views.html.bla.render(itemsMap)).as("text/plain"); 
```

这给出了以下输出：

```
(empty line)
(empty line)
value
key
(empty line)
value
key 
```

我想摆脱前 2 个空行 - 这可能吗？

将 for 放在第一行会删除顶部的一个空行，但是仍然保留一个空行，并且第一行中的 for 使模板难以阅读）：感谢您的任何提示！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T15:45:31.527

首先，如果您使用纯文本，您应该使用 txt 模板 ( `bla.scala.txt`)。他们还自动设置`text/plain; charset=utf-8` 内容类型。

要修剪内容，可以直接返回渲染的内容：

```
return ok(views.txt.bla.render(itemsMap).body().trim()); 
```

如果您想呈现 HTML 内容，则需要手动更改：

```
return ok(views.html.ble.render().body().trim()).as("text/html; charset=utf-8"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:39:58.073

如果您从地图生成纯文本输出，为什么要使用视图？它们对您的情况没有任何好处。

您可以在纯 Scala 中编写渲染函数。就像是

```
items.map{ case (k,v) => v + '\n' + k}.mkString('\n') 
```

# asp.net-mvc - 带有资源文件的模型的单选按钮枚举帮助程序

> ID：14103206
> 
> 赞同：2
> 
> 时间：2012-12-31T15:13:41.890
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor

**问题：**

需要绑定具有 Gender 作为枚举属性的强类型模型。我也喜欢显示资源文件中的显示文本。

我的模型是

```
public enum GenderViewModel
{
  [Display(Name = "Male", ResourceType = typeof(Resources.Global), Order = 0)]
  Male,
  [Display(Name = "Female", ResourceType = typeof(Resources.Global), Order = 1)]
  Female

} 
```

最初，我尝试遵循[http://romikoderbynew.com/2012/02/23/asp-net-mvc-rendering-enum-dropdownlists-radio-buttons-and-listboxes/](http://romikoderbynew.com/2012/02/23/asp-net-mvc-rendering-enum-dropdownlists-radio-buttons-and-listboxes/)

但它有点复杂，我无法更正我想要的 HTML。

然后我从stackoverflow看了一下简单易行的实现，[将枚举传递给html.radiobuttonfor MVC3](https://stackoverflow.com/questions/5621013/pass-enum-to-html-radiobuttonfor-mvc3)

并在 cshtml 中使用了 HtmlHelper，如下所示

```
@Html.RadioButtonForEnum(m => m.Gender) 
```

生成的 HTML

```
<label for="_Gender_Male">
 <input type="radio" value="Male" name="Gender" id="_Gender_Male" 
 data-val-required="Gender is required" data-val="true" checked="checked">
 <span class="radiotext">Male</span>
</label>

<label for="_Gender_Female">
<input type="radio" value="Female" name="Gender" id="_Gender_Female">
<span class="radiotext">Female</span></label> 
```

> 它真的很简单，对我来说效果很好。但我没有从资源文件中获取值。我的应用程序是多语言的，我使用全局资源文件来支持不同的语言。

**问题：**

**显示的男性**应该是***男性***，显示的**女性**应该是***Kvinna***应该来自资源文件，因为我当前的文化是**sv-se**

任何人都可以帮助/提供一个可以很好地控制 HTML 的简单解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T11:51:50.673

您所要做的就是适应[`my original helper`](https://stackoverflow.com/a/5621200/29407)，以便考虑到`DisplayAttribute`：

```
public static class HtmlExtensions
{
    public static MvcHtmlString RadioButtonForEnum<TModel, TProperty>(
        this HtmlHelper<TModel> htmlHelper,
        Expression<Func<TModel, TProperty>> expression
    )
    {
        var metaData = ModelMetadata.FromLambdaExpression(expression, htmlHelper.ViewData);
        if (!metaData.ModelType.IsEnum)
        {
            throw new ArgumentException("This helper is intended to be used with enum types");
        }

        var names = Enum.GetNames(metaData.ModelType);
        var sb = new StringBuilder();

        var fields = metaData.ModelType.GetFields(
            BindingFlags.Static | BindingFlags.GetField | BindingFlags.Public
        );

        foreach (var name in names)
        {
            var id = string.Format(
                "{0}_{1}_{2}",
                htmlHelper.ViewData.TemplateInfo.HtmlFieldPrefix,
                metaData.PropertyName,
                name
            );
            var radio = htmlHelper.RadioButtonFor(expression, name, new { id = id }).ToHtmlString();
            var field = fields.Single(f => f.Name == name);
            var label = name;
            var display = field
                .GetCustomAttributes(typeof(DisplayAttribute), false)
                .OfType<DisplayAttribute>()
                .FirstOrDefault();
            if (display != null)
            {
                label = display.GetName();
            }

            sb.AppendFormat(
                "<label for=\"{0}\">{1}</label> {2}",
                id,
                HttpUtility.HtmlEncode(label),
                radio
            );
        }
        return MvcHtmlString.Create(sb.ToString());
    }
} 
```

现在，如果您使用 DisplayAttribute 修饰了一些枚举值，则这些值将来自资源文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:35:18.317

您应该在扩展方法中替换它`name`用于`<label>`使用您想要的资源。

您应该使用我从[这里](https://stackoverflow.com/a/1799401/310276)改编的代码类型：

```
var type = typeof(metaData.ModelType);
var memInfo = type.GetMember(name);
var attributes = memInfo[0].GetCustomAttributes(typeof(DisplayAttribute), false);
var description = ((DisplayAttribute)attributes[0]).GetDescription(); 
```

然后`description`放入`<label>`。

**我没有测试过！**

# javascript - 在 Javascript 中使用键的值作为键值对中的键

> ID：14103212
> 
> 赞同：0
> 
> 时间：2012-12-31T15:14:16.057
> 
> 标签：javascript, keyvaluepair

如何在 javascript 中使用键值对的值作为不同键值对中的键？

我想做以下事情：

```
var gizmos = {gizmo1: "G1"};
var things = {gizmos.gizmo1: "T1"}; 
```

所以事情基本上等于：

```
var things = {"G1": "T1"}; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T15:15:56.007

像这样：

```
var gizmos = {gizmo1: "G1"};
var things = {};
things[gizmos.gizmo1] = "T1"; 
```

作为对象初始化器（又名对象“文字”）的一部分，没有办法做到这一点，你必须在之后做。

它起作用的原因是，在 JavaScript 中，您可以通过两种方式访问​​（获取或设置）对象的属性：使用点分符号和*文字*，例如`foo.bar`，或使用括号符号和*字符串*，例如`foo["bar"]`。在后一种情况下，字符串不必是字符串文字，它可以是任何表达式的结果（在这种情况下，包括对另一个对象的属性查找）。

* * *

旁注：如果您在执行该行后进行*更改，它* *不会*更改. 没有持久的链接，因为在行中使用 的值*来*确定属性名称（就像在任何其他表达式中一样）。`gizmos.gizmo1``things[gizmos.gizmo1] = "T1";`*`things`*`gizmos.gizmo1``things[gizmos.gizmo1] = "T1";`**

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:17:03.917

要获取对象上给定键的值，请使用`object["key"]`或`object.key`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T15:15:58.113

```
var gizmos = {gizmo1: "G1"};
var things = {};
things[gizmos.gizmo1]="T1"; 
```**

# vba - 在 VBA Excel 中读取 HTML 文件

> ID：14103220
> 
> 赞同：2
> 
> 时间：2012-12-31T15:14:39.350
> 
> 标签：vba

我想阅读 VBA 中的 HTML 代码（类似于 Java 中的 URL）。我需要将它保存在一个字符串中。之后我会解析它。

alpan67

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-31T15:42:20.497

这是给你的一个功能。它将返回给定 URL 返回的 HTML 字符串。

```
Function GetHTML(URL As String) As String
    Dim HTML As String
    With CreateObject("MSXML2.XMLHTTP")
        .Open "GET", URL, False
        .Send
        GetHTML = .ResponseText
    End With
End Function 
```

只需确保您提供的 URL 格式正确即可。IE 它包括`http://`or`https://`如果合适的话。

例如：`GetHtml("www.google.com")`不正确。
你会想要`GetHtml("https://www.google.com/")`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:35:25.677

*   要进行[URL 解码](https://stackoverflow.com/questions/4998715/does-vba-have-any-built-in-url-decoding)，您可以使用该帖子作为参考。

*   这是[一篇使用 MS Word 将网页的 html 保存为文本的文章](http://windowssecrets.com/forums/showthread.php/109109-Save-HTML-as-Text-in-VBA-%28VBA-Access-2007%29)。

*   Excel VBA 中的代码 -[来自 VBAExpress](http://www.vbaexpress.com/forum/showthread.php?t=27050)：我不想复制他的代码。您可以尝试一下并发表评论。

# ruby-on-rails - 如何修改 rails_admin 编辑视图

> ID：14103224
> 
> 赞同：2
> 
> 时间：2012-12-31T15:15:04.260
> 
> 标签：ruby-on-rails, ruby-on-rails-3, action, rails-admin

我有一个`Contact`与类关联的`User`类，如下所示

```
class Contact < ActiveRecord::Base
   belongs_to :users
end 
```

在我的编辑中，我想显示一个下拉列表，其中包含用户名列表作为组件应绑定的选项`contact.user_id`。

如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T15:27:42.380

有很多方法可以实现这一点，这里是一个例子。

```
<%= f.select :user_id, Contact.all.collect{|c| [c.user.name, c.user.id]} %> 
```

这将创建一个由contact.user.name 和contact.user.id 组成的数组，并根据关联的user_id 将选定的联系人提交给您的控制器。

您将[在此处](http://guides.rubyonrails.org/form_helpers.html#making-select-boxes-with-ease)找到更多信息。

# asp.net-mvc-4 - 捆绑链接断开

> ID：14103226
> 
> 赞同：0
> 
> 时间：2012-12-31T15:15:44.387
> 
> 标签：asp.net-mvc-4

当您创建一个新的 ASP.Net MVC4 项目时，会在 App_Start 中创建一个名为 BundleConfig.cs 的文件（您可以在其中创建脚本和 css 文件包。）

该文件的顶部是一条注释，内容如下：

```
// For more information on Bundling, visit http://go.microsoft.com/fwlink/?LinkId=254725 
```

据我所知，此链接已损坏。它只是直接重定向到这里：[http ://www.asp.net/mvc](http://www.asp.net/mvc)

在撰写本文时，其中绝对没有特定于捆绑的信息。

原来去哪儿了？现在应该去哪里？

# linux - watir 无头测试在本地 linux 上运行良好，但在无头 linux 盒上出现错误

> ID：14103228
> 
> 赞同：1
> 
> 时间：2012-12-31T15:15:52.823
> 
> 标签：linux, watir, headless

我正在使用 watir headless 在我的网站上运行基本的登录测试用例。它在我的机器（普通的开发 Linux 机器）上运行良好，但在无头 linux 服务器（使用 firefox）上失败并出现以下错误：

脚本：

感谢您的回复。我尝试使用 when_present，它永远不会返回 true 和脚本超时。该脚本在带有 ui 的 linux 开发机器上运行良好，但在 linux 服务器上的 'browser.text_field(:name, "memberForm.memberpassword").set("password")' 处失败。

以下是脚本：

```
require 'rubygems'
require 'watir'
require 'watir-webdriver'
require 'headless'

headless = Headless.new
headless.start
begin
browser = Watir::Browser.start 'http://127.0.0.1:8080/login'
browser.text_field(:name, "memberForm.memberemail").set("tester")
puts browser.text_field(:name, "memberForm.memberpassword")
browser.text_field(:name, "memberForm.memberpassword").set("password")
browser.button(:id, "login-button").click
puts browser.text
if(resultText.include?'Error Message')
   puts 'login failed'  
else
  puts 'success'
end

rescue => e
    puts e.message
    p e.backtrace
ensure
    browser.close
    headless.destroy
end 
```

错误是：

```
 [remote server] file:///tmp/webdriver-profile20121231-18379-1ad5l77/extensions/fxdriver@googlecode.com/components/command_processor.js:6771:in `unknown': Element is not currently visible and so may not be interacted with (Selenium::WebDriver::Error::ElementNotVisibleError) 
```

HTML 是：

```
<div class="row">
 <fieldset id="login-form-fieldset">

             <div class="clearfix">
                 <input class="span5"
                        id="memberForm_memberemail_id"
                        name="memberForm.memberemail"
                        type="text"                        
                        value="<gs:property value="memberForm.memberemail" escape="false"/>"/>
             </div>

             <div class="clearfix">
                 <input class="span5"
                        id="memberForm_memberpassword_id"
                        name="memberForm.memberpassword"
                        type="password"
                        placeholder="Password" />
             </div>

             <gs:token />

            <div class="clearfix">
                <button type="submit" id="login-button" class="btn btn-large btn-primary">Login</button>

                <div class="pull-right" style="margin-top: 10px;">
                    Forgot Password? <a href="<gs:url action="forgot-password" namespace="/" />">Click here</a>
                </div>
            </div>

        </fieldset>
</div> 
```

我不明白无头 linux 服务器出了什么问题？如果我不尝试将值设置为密码字段，它可以正常工作并转到忘记密码页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T09:19:52.950

错误消息说`Element is not currently visible and so may not be interacted with`。这听起来像是脚本有问题，而不是机器有问题。当脚本尝试与之交互时，该元素不可见。

有关于如何等待元素的文档：[http ://watirwebdriver.com/waiting/](http://watirwebdriver.com/waiting/)

如果您提供相关代码，有人可能会知道更多。

# jquery - 使用jquery在rails 3中选择提交按钮

> ID：14103236
> 
> 赞同：1
> 
> 时间：2012-12-31T15:16:08.613
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3

目前我只是想让jquery在我的表单中按下提交按钮时显示警报，我给了它一个id

```
<%= submit_tag "search", :id => 'submitForm' %> 
```

并尝试了这个

```
$(document).ready(function() {
 $('#submitForm').submit(function(e) {
e.preventDefault();
 alert('clicked');

 });
}); 
```

但我没有收到警报，我也尝试过

```
$(document).ready(function() {
 $(':input#submitForm').submit(function(e) {
 e.preventDefault();
  alert('clicked');

 }); 
```

});

但这也不起作用..我在做什么显然是不正确的

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:17:56.857

`submit`为表单元素触发事件，而不是提交按钮，因为您的元素是具有提交类型的输入/按钮元素，您应该选择您的表单元素：

```
$(function(){
   $('#theForm').submit(function(e) {
      // ...
   });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:21:50.790

提交事件只能附加到表单，不能提交标签。您需要将 ID 放在表格上。

```
<%= form_tag "/", id: "submitForm" do %>
  <%= submit_tag "search" %>
<% end %> 
```

# mysql - MYSQL 按列表排序

> ID：14103237
> 
> 赞同：0
> 
> 时间：2012-12-31T15:16:09.080
> 
> 标签：mysql, sql, select, sql-order-by

我有一个表 A，它有一个“ID”和“消息”，另一个表 B 是有序的。我希望根据表 B 中的排序方式订购表 A。

示例 - 表 A：

```
ID    Message
-------------
1     ABC
2     DEF
3     HIJ
4     KLM
5     NOP 
```

表 B：

```
ID
---
5
2
4
1
3 
```

预期结果：

```
ID    Message
-------------    
5     NOP
2     DEF
4     KLM
1     ABC
3     HIJ 
```

我有以下查询：

```
SELECT DISTINCT s.message, s.stream_id
FROM Stream s
ORDER BY ..... ; 
```

我该怎么做？显然使用 FIND_IN_SET 没有考虑表 B 的顺序

更新

表 B 的排序如下：

```
SELECT stream_id 
FROM SearchCache 
GROUP BY stream_id 
ORDER BY COUNT(stream_id); 
```

因此，查询应该如下所示：

```
SELECT DISTINCT s.message, s.stream_id
FROM Stream s
ORDER BY s.stream_id *SOMETHING* (SELECT stream_id 
                                  FROM SearchCache 
                                  GROUP BY stream_id 
                                  ORDER BY COUNT(stream_id)) ASC; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T15:41:45.517

由于您是`Table B`按聚合排序的`COUNT()`，因此您可以在`ORDER BY`. 只需将其添加到`SELECT`派生的列表中`Table B`。

```
SELECT
  DISTINCT 
  s.message, 
  s.stream_id
FROM 
  Stream s
  /* Join against a subquery that produces a count per stream_id */
  /* Using LEFT JOIN in case none exist for a given s.stream_id */
  LEFT JOIN (
    SELECT stream_id, COUNT(*) AS num_streams
    FROM SearchCache
    GROUP BY stream_id
   ) stream_counts ON s.stream_id = stream_counts.stream_id
/* Order by the COUNT() aggregate supplied by the joined subquery */
ORDER BY stream_counts.num_streams ASC 
```

注意：*如果您发布`SearchCache`表格示例，我将使用 SQLFiddle 示例进行更新...*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:08:48.857

尝试这个：

```
SELECT a.id, a.message 
FROM tablea a 
INNER JOIN (SELECT (@auto:=@auto+1) auto, id 
            FROM tableb, (SELECT @auto:=0) AS a) AS b ON a.id = b.id 
ORDER BY b.auto; 
```

# java - 关闭子窗口时关闭父窗口

> ID：14103239
> 
> 赞同：2
> 
> 时间：2012-12-31T15:16:26.863
> 
> 标签：java, swing, window, parent-child

我有一个应用程序，当按下同名按钮时，它会创建一个新窗口（我们称之为 Cuprins）。我遇到的问题是，当我关闭新窗口时，它也会关闭主窗口。关闭 Cuprins 窗口时是否有使主窗口不关闭的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T15:19:35.270

检查默认关闭操作是什么。将其设置为“关闭时处理”或“关闭时不执行任何操作”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T06:13:31.547

新打开的窗口应该使用 dispose on close 来处理框架，或者使用 setVisible(false) 来暂时隐藏它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-25T09:05:00.840

只需在创建子窗口时使用此行。

```
myFrame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE); 
```

用法示例：

```
AddLeagues addLeague = new AddLeagues(); //Child View
addLeague.setVisible(true);
myFrame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE); 
```

# php - 无法在php登录页面中显示用户名

> ID：14103242
> 
> 赞同：0
> 
> 时间：2012-12-31T15:16:28.923
> 
> 标签：php, login-system

我正在为我的网站创建登录系统，并且在用户登录后无法打印出用户名。

从数据库验证后，我已经这样做了：

```
 $_SESSION['userName'];
  $_SESSION['password'];
  header("location:success.php"); 
```

这是在success.php文件中打印用户名的代码：

```
 session_start();
   if($_SESSION['userName']!='')
   {
    header("location:login_form.php");

    }
    else
    {
     echo '<h2>Successfully Login <br /> Welcome '.$userName.'</h2>';

     echo '<a href="logout.php"> Log Out</a>';
     } 
```

但不打印用户名。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T15:18:05.277

我想你想要：

```
echo '<h2>Successfully Login <br /> Welcome '.$_SESSION['userName'].'</h2>'; 
```

和

```
if($_SESSION['userName']!='') 
```

应该

```
if($_SESSION['userName']=='') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T15:20:53.353

首先，您没有将会话分配给任何值。

```
$_SESSION['userName'];
$_SESSION['password'];

header("location:success.php"); 
```

应该：

```
$_SESSION['userName'] = 'My Username';
$_SESSION['password'] = 'My Password';
header("location:success.php"); 
```

其次，您还没有定义变量`$userName`。将其更改为：`$_SESSION['userName']`。

`die()`附带说明一下，您不应该在会话中存储密码，此外，您应该`exit()`在使用`header()`.

**编辑：**

只需重新阅读您的代码。尽管我之前的回答者建议您更改此行：

```
if ($_SESSION['userName'] != '') 
```

至：

```
if ($_SESSION['userName'] == '') 
```

使用逻辑运算符检查会话是否存在实际上是一种不好的做法。正确的方法是使用该`isset()`功能：

```
if (isset($_SESSION['userName'])) 
```

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T15:18:01.787

这一行：

```
if($_SESSION['userName']!='') 
```

应该：

```
if($_SESSION['userName']=='') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T15:35:26.727

除非您在其他地方省略了代码，否则不会定义此变量：`$userName`

您缺少将其定义为变量。尝试：

```
$userName= $_SESSION['userName'];
$password = $_SESSION['password']; 
```

# mysql - mysql REPLACE INTO 和可选值 IFNULL

> ID：14103244
> 
> 赞同：0
> 
> 时间：2012-12-31T15:16:36.020
> 
> 标签：mysql, replace, ifnull, optional-values

我正在尝试在存储过程中做这样的事情：

```
REPLACE INTO mytable
SET myid = `IDvalue`, mytitle = `sMyTitle`, myoptionalvalue = IFNULL(`sMyOptValue`, myoptionalvalue); 
```

但似乎不起作用，知道该怎么做吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:24:47.423

REPLACE INTO 语法的工作方式与 INSERT INTO 完全相同，只是在插入新行之前会自动删除具有相同主键或唯一键的任何旧行。

这意味着您应该将主键添加到被替换的值中，而不是 WHERE 子句，以限制您的更新。

```
REPLACE INTO myTable (
 myPrimaryKey,
 myColumn1,
 myColumn2
  ) VALUES (
 100,
 'value1',
 'value2'
 ); 
```

...将提供与...相同的结果

```
UPDATE myTable
SET myColumn1 = 'value1', myColumn2 = 'value2'
WHERE myPrimaryKey = 100; 
```

# php - 通过 iFrame 提交表单数据的安全性？

> ID：14103249
> 
> 赞同：1
> 
> 时间：2012-12-31T15:17:02.373
> 
> 标签：php, asp.net-mvc, forms, security, salesforce

好的，让我稍微介绍一下我的情况：

*   在 WordPress 中重新设计网站
*   网站有一些提交给 Salesforce 的表单
*   当权者不相信 PHP 表单数据的安全性达到标准（这是一家 Windows 商店，正在慢慢扩展到其他技术）
*   他们想在 ASP 中创建表单

所以这是我的问题。如果我通过 iframe 提交表单数据，它的安全性如何？我最初的想法是通过 iframe 获取表单并取消所有滚动条等，使其看起来尽可能无缝。

这是我必须处理的问题，但我只是想在这里找出最佳解决方案。任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:26:55.840

这个问题; [iframe 安全问题](https://stackoverflow.com/questions/1163985/iframe-security-issues)应该能够帮助解决 iframe 安全问题，但由于跨域脚本限制，您将难以访问和操作 DOM 元素。

如果表单安全性是一个潜在问题（尽管我很想知道为什么......）那么也许看看 salesforce api，因为您可以以您认为合适的方式处理表单数据，然后使用 SOAP 或 REST 客户端来处理商业逻辑...

[http://www.salesforce.com/us/developer/docs/api/index.htm](http://www.salesforce.com/us/developer/docs/api/index.htm)用于 SOAP [http://www.salesforce.com/us/developer/docs/api_rest/index.htm](http://www.salesforce.com/us/developer/docs/api_rest/index.htm)用于 REST

希望这可以帮助...

# mysql - 如何对特定查询进行分页？

> ID：14103251
> 
> 赞同：1
> 
> 时间：2012-12-31T15:17:02.893
> 
> 标签：mysql, pagination

即使是互联网上的“简单”分页教程，我也很难理解。

我正在为我的公司创建一个 Intranet 站点，完成它的唯一步骤是对所有查询进行分页，因为它们都包含数千个结果，尤其是搜索结果。

我的问题是我能否按如下方式对查询进行分页：

```
SELECT * FROM hdticket WHERE id = 22; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T15:22:34.210

您需要在`LIMIT`MySQL 查询中添加一个子句。这很简单：

```
SELECT * FROM hdticket WHERE id = :ticknum LIMIT 0, 10 
```

这将从头开始获取十条记录（假设您的记录是基于零索引的）。第一个数字是从何时开始获取，第二个数字是之后要获取的数量。所以从 0 开始，它正在获取接下来的 10 条记录。这将是第 1 页。

要获取后续记录页，您只需增加第一个数字。因此，要获取第二页，您需要从 10 开始计数，并获取接下来的 10 条记录。此查询如下所示：

```
SELECT * FROM hdticket WHERE id = :ticknum LIMIT 10, 10 
```

然后是第 3 页：

```
SELECT * FROM hdticket WHERE id = :ticknum LIMIT 20, 10 
```

等等。希望你能看到正在出现的模式。

当您使用`$_GET`参数时，您可以只定制您的 URL 来分页您的记录。所以**http://intranet/index.php?page=2**的 URL会给出：

```
<?php

$page = intval($_GET['page']);
$limit = 10;
$offset = (($page - 1) * $limit);

$sql = "SELECT * FROM hdticket WHERE id = :ticknum LIMIT $offset, $limit"; 
```

希望这可以帮助。

此外，还有一些旁白。不要使用这些`mysql_`功能，因为它们已被弃用。您可以从官方手册页中看到这一点：http: [//php.net/manual/en/function.mysql-query.php](http://php.net/manual/en/function.mysql-query.php)。

此外，您的代码容易受到 SQL 注入攻击，因为您正在获取 URL 中的内容并直接在 SQL 查询中使用它。如果您在其中输入用于分页的数字，这一切都很好，但是如果有人恶意将 SQL 放入 URL，他们可以做各种各样的事情，例如截断您的表或整个数据库，这会发生，因为您'只是通过它而不检查它。

为了解决这个问题，如果您使用`mysql_`函数的替代方法，例如[PDO](http://php.net/manual/en/book.pdo.php) ，您可以在 SQL 语句中准备变量。您的代码将如下所示：

```
<?php

$sql = "SELECT * FROM hdticket WHERE id = :ticknum LIMIT :offset, :limit";
$stmt = $pdo->prepare($sql);
$stmt->bindParam(':ticknum', $ticknum, PDO::PARAM_INT);
$stmt->bindParam(':offset', $offset, PDO::PARAM_INT);
$stmt->bindParam(':limit', $limit, PDO::PARAM_INT);
$stmt->execute(); 
```

这可确保传递给您的 SQL 字符串的数据是您所期望的，并自动转义以防止 SQL 注入。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-31T15:20:47.723

你可以使用 top / limit 这样做..

如果你只想要前 10 名，那么：

```
 select top 10,* from table; 
```

或者如果你想去页面那么：

```
 select * from table limit 10 , 20; 
```

# wordpress - 自定义 WP Schedule 事件

> ID：14103262
> 
> 赞同：2
> 
> 时间：2012-12-31T15:17:46.280
> 
> 标签：wordpress

专家们，

目前在我的一个 wordpress 插件中，有一个按以下时间表运行的 cron。wp_schedule_event（时间（），“每小时”，“w4pr_cron”）；我想将其更改为在特定时间范围内每 5 分钟运行一次。

例如，您所知道的当前代码将在一天中每小时运行一次。（一天运行 24 次）。我希望它仅在早上 5:00 到早上 6:30（美国东部标准时间）之间每 5 分钟运行一次（一天运行 18 次）。

任何帮助表示赞赏！

谢谢托马斯

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-31T19:23:12.653

[首先创建一个自定义间隔，您可以在此处](http://codex.wordpress.org/Function_Reference/wp_get_schedules)找到有关此的更多信息。

```
 add_filter( 'cron_schedules', 'cron_add_5min' );

 function cron_add_5min( $schedules ) {
    $schedules['5min'] = array(
        'interval' => 5*60,
        'display' => __( 'Once every five minutes' )
    );
    return $schedules;
 } 
```

确保您已取消计划插件注册的事件：

```
wp_unschedule_event( next_scheduled_event( 'w4pr_cron' ), 'w4pr_cron' ); 
```

接下来安排具有此重复间隔的事件在凌晨 5 点开始：

```
if( time() > strtotime( 'today 5:00' ) )
    wp_schedule_event( strtotime( 'tomorrow 5:00' ), '5min', 'w4pr_cron' );
else
    wp_schedule_event( strtotime( 'today 5:00' ), '5min', 'w4pr_cron' ); 
```

w4pr_cron 不是一个函数，而是一个附加了函数的钩子。因此，您要做的是确保如果时间戳不在您给定的时间间隔内，则在调用此挂钩时不会发生任何事情。所以在functions.php或在每次页面加载时都会看到它执行的地方，放：

```
add_action( 'init', function() {
    $start = strtotime( 'today 5:00' );
    $end = strtotime( 'today 6:30' );
    if( !(time() > $start && time() < $end) ) remove_all_actions( 'w4pr_cron' );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T19:04:53.990

您首先需要添加自定义 cron 计划，使其每 5 分钟运行一次

```
 // Add cron interval of 60 seconds
function addCronMinutes($array) {
    $array['minute'] = array(
            'interval' => 60,
            'display' => 'Once a Minute',
    );
    return $array;
}
add_filter('cron_schedules','addCronMinutes'); 
```

但是，为了只允许它在特定时间范围内运行而不会造成额外开销，您最好不要安排每个特定事件。

另一种选择是将逻辑放入触发器中，以仅在指定的时间范围内运行您的函数，但这会导致高流量站点的额外开销，其中 cron 每 5 分钟触发一次。

# asp.net-mvc - 针对跨平台和域站点的 SSO 解决方案的建议

> ID：14103263
> 
> 赞同：2
> 
> 时间：2012-12-31T15:17:51.907
> 
> 标签：asp.net-mvc, single-sign-on, dotnetopenauth, wif

我现在对如何为我正在进行的项目构建 SSO 解决方案感到有点不知所措。我知道我需要一个集中的登录站点，但是，我想输入我应该使用什么框架来实现这一点。我一直在阅读一些有关 Windows Identity Foundation (WIF) 的信息，但是，文档和代码示例的缺乏令人非常失望。DotNotOpenAuth 听起来它在社区中的使用量比 WIF 多得多，但是，我不确定这是否是我使用的正确框架，因为我不会让第三方帐户用于登录。

还需要考虑多个用户数据存储；活动目录和 SQL Server 数据库。

我真的不在乎我使用什么框架，只要它简单直观即可；我不想要一个过于复杂的解决方案。文档和样本也是一个加分项！我已经有创建自定义角色提供者和成员提供者的经验；这些都是轻而易举的事情，而且很容易做到。

这是我正在处理的结构的一个非常快速的视图：

![在此处输入图像描述](../Images/994bc1a5b009fe925822be477e5d218d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T04:50:21.367

请参阅：[基于声明的身份和访问控制指南](http://claimsid.codeplex.com/)和[身份开发人员培训工具包](http://www.microsoft.com/en-us/download/details.aspx?id=14347)。那里有 WIF 样本。

就您想要实现的目标而言，ADFS v2.0 可以帮助您完成大部分工作，但它只能针对 AD 进行身份验证。对于 SQL 服务器，使用[IdentityServer](http://thinktecture.github.com/)，然后联合 ADFS 和 IdentityServer。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T21:27:11.590

就跨平台而言，[SAML](http://en.wikipedia.org/wiki/Saml)往往处于领先地位。有很多实现（java、php、perl）。正如 Dominick (@leastprivilege) 所提到的，如果每个应用程序都是基于 .Net 的，那么通过[WIF](http://en.wikipedia.org/wiki/Windows_Identity_Foundation)的 WS-Fed就是要走的路。**（顺便说**一句，多米尼克是WIF 的佼佼者——如果你打算探索这条路线，肯定会访问他的博客和论坛）

OpenId 和 OAuth 是您将听到的替代方案。它们的安全性稍差一些（信任在于用户，而不是基础设施），您会发现您必须构建一个提供程序才能支持使用您自己的用户存储进行登录。

无论您选择哪种路线，都要准备好进行大量阅读和学习。查看上面的维基百科文章，了解这些技术是如何工作的，不要害怕提出问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T15:29:22.407

看看 SAML。它旨在解决 SSO。您可能还想查看 OpenID。

那里有企业产品，例如 CA Site Minder 或 IBM Tivoli 等。它们并不便宜，因为为此构建自定义解决方案将是一项壮举。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-01T18:22:24.173

如果您是基于 .NET 的 - 那么 .NET 4.5（包括 WIF）是您的最佳选择。

但是框架将是您最简单的问题。建立这种安全基础设施是困难的。从 nzpcmad 的答案中查看书籍和身份服务器作为起点。

# android - ArrayAdapter 中的 IllegalStateException

> ID：14103271
> 
> 赞同：0
> 
> 时间：2012-12-31T15:18:51.967
> 
> 标签：android, android-asynctask, illegalstateexception

我`AsyncTask`从我的活动中调用一个从网络下载字符串。下载字符串后，我想将字符串传递到我的活动中，以便解析它，然后填充`ListView`.

我在我的活动中创建了一个要调用的方法`onPostExecute()`，这就是代码：

```
@Override
    protected void onPostExecute(String res) {   
        IndexPicker index = new IndexPicker();
        index.onAsyncFinish(res);
    } 
```

这是我的`onASyncFinish()`方法：

```
public void onAsyncFinish(String json) {
        ArrayList<Index> arrayList = parseJSON(json);
        populateListView(arrayList);
    }
} 
```

在`populateListView`方法中是 IllegalStateException 的地方，当调用 ArrayAdapter 的构造函数时。

```
public IndexItemAdapter(Context context, int layoutResourceId,
            ArrayList<Index> data) {
        super(context, layoutResourceId, data); // This line.
        this.layoutResourceId = layoutResourceId;
        this.context = context;
        this.data = data;
    } 
```

这是日志：

```
E/AndroidRuntime(821): FATAL EXCEPTION: main
E/AndroidRuntime(821): java.lang.IllegalStateException: System services not available to Activities before onCreate()
E/AndroidRuntime(821):  at android.app.Activity.getSystemService(Activity.java:4463)
E/AndroidRuntime(821):  at android.widget.ArrayAdapter.init(ArrayAdapter.java:310)
E/AndroidRuntime(821):  at android.widget.ArrayAdapter.<init>(ArrayAdapter.java:153)
E/AndroidRuntime(821):  at com.test.exampleapp.index.IndexItemAdapter.<init>(IndexItemAdapter.java:23)
E/AndroidRuntime(821):  at com.test.exampleapp.activity.IndexPicker.populateListView(IndexPicker.java:39)
E/AndroidRuntime(821):  at com.test.exampleapp.activity.IndexPicker.onAsyncFinish(IndexPicker.java:56)
E/AndroidRuntime(821):  at com.test.exampleapp.async.DownloadIndexJSON.onPostExecute(DownloadIndexJSON.java:45)
E/AndroidRuntime(821):  at com.test.exampleapp.async.DownloadIndexJSON.onPostExecute(DownloadIndexJSON.java:1)
E/AndroidRuntime(821):  at android.os.AsyncTask.finish(AsyncTask.java:631)
E/AndroidRuntime(821):  at android.os.AsyncTask.access$600(AsyncTask.java:177)
E/AndroidRuntime(821):  at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:644)
E/AndroidRuntime(821):  at android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime(821):  at android.os.Looper.loop(Looper.java:137)
E/AndroidRuntime(821):  at android.app.ActivityThread.main(ActivityThread.java:5039)
E/AndroidRuntime(821):  at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime(821):  at java.lang.reflect.Method.invoke(Method.java:511)
E/AndroidRuntime(821):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
E/AndroidRuntime(821):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
E/AndroidRuntime(821):  at dalvik.system.NativeStart.main(Native Method) 
```

经过研究，显然问题是我调用 onASyncFinish 方法的方式，使用`IndexPicker index = new IndexPicker();`. 我相信这是正确的，因为当我尝试在主线程上进行网络测试时，列表视图会正确填充。

所以我的问题是，解决这个问题的最佳方法是什么，以便我可以将 ASyncTask 的结果传递给活动，然后填充我的列表视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:27:58.563

我假设那`IndexPicker`是你的`Activity`，在这种情况下你正在做一件非常糟糕的事情来实例化它（因为它不会有一个有效的`Context`（正是异常告诉你的））。活动不应手动实例化，它们由 Android 系统创建和处理。

相反，为了做你想做的事，你应该传递一个对`Activity`从哪里开始的引用`AsyncTask`（在`AsyncTask`的构造函数中），并使用该引用`onAsyncFinish`在`onPostExecute`回调中调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:30:41.690

这里有两种可能的解决方案：

一 :: 向您发送 Listview 对 ASyncTask 的引用，并在 ASyncTask 完成时将数据绑定到 listview。

二：：您想在活动中的列表视图中绑定数据，然后首先检查 ASyncTask 是否完成，然后绑定数据。要从 ASyncTask 获取数据，您需要在 ASyncTask 类中创建一个方法，当它完成时调用它，此方法返回类型是返回您的数据。

但我认为第二种方法不好，因为您需要运行一个线程来继续检查 ASyncTask 是否完成。

谢谢

# yeoman - Yeoman 安装组件失败

> ID：14103277
> 
> 赞同：1
> 
> 时间：2012-12-31T15:20:02.563
> 
> 标签：yeoman, bower

当我执行`yeoman install git://github.com/paperjs/paper.js.git`时，它失败了。这是输出：

> 运行“凉亭：安装：git://github.com/paperjs/paper.js.git”（凉亭）
> 
> 任务凉亭克隆 git://github.com/paperjs/paper.js.git 凉亭缓存
> 
> git://github.com/paperjs/paper.js.git bower 获取 paper.js bower
> 
> 查看 paper.js#39f744de0c117e678b7c663dbf489c55def6f415 凉亭
> 
> 复制
> 
> /Users/my-username/.bower/paper.js/58f9c1c5f33cae79df922c8fde57158c
> 
> GET [https://bower.herokuapp.com/packages/canvas](https://bower.herokuapp.com/packages/canvas) `<FATAL>`找不到画布`</FATAL>`

似乎它正在寻找一个不存在的“画布”模块。关于如何解决这个问题的任何想法？

它可能与 'cavas' 被定义为 中的依赖关系有关`package.json`，但该`package.json`文件适用于[NPM](https://npmjs.org/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T01:15:28.957

> 它可能与 'cavas' 被定义为 package.json 中的依赖项有关，但 package.json 文件适用于 NPM。

这是正确的。这是一个无效的组件，因为它缺少一个 component.json 文件，如果组件具有依赖项，则需要该文件。您可以要求 Paper.js 的作者添加一个 component.json 文件，或者 fork 存储库并自己添加。

此外，`yeoman install`（Bower）使用的它们的 git 标签是无效的[semver](http://semver.org)（`v0.22`而有效的符号是`0.2.2`）。这将导致它无法工作。

# php - 检测用户是否有可能导致站点错误的错误日期/时间

> ID：14103280
> 
> 赞同：2
> 
> 时间：2012-12-31T15:20:34.080
> 
> 标签：php, javascript, magento

我注意到，如果用户关闭计算机时钟（错误的日期或上午而不是下午等）并将商品添加到购物车并单击结帐，他将收到一条消息，指出他的购物车中没有商品，因为有时间不匹配会破坏代码。

因此，与其让用户感到沮丧并致电支持（或完全放弃购物车），我想知道是否有某种方法可以检测用户的时间/日期是否正确，如果没有则创建警报来修复他的时钟。

有任何想法吗？该站点在 php 上运行，因此 php、javascript/ajax 等中的任何脚本都会很棒。

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-31T15:22:16.480

您最好更改您的代码，以便完全不依赖客户端时钟。

你如何处理不同的时区等......？

服务器端代码不应该依赖客户端环境来匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:52:04.257

我不建议您主要依靠客户端来验证购物车的时间/时区。客户端的时间可能设置不正确（甚至是故意为恶意行为......诡计永远不会结束。）

您需要做的是妥善处理不同时区用户的场景。

这是您可以执行的操作：

*   使用 JavaScript 检索客户端的时间/时区（[请参阅此问题](https://stackoverflow.com/q/1091372/247696)）
*   向服务器发布帖子以验证它。
*   将时间转换为相应的时区。这可用于向用户正确显示某个时间或存储在 cookie/会话中以跟踪用户信息。
*   如果未提供有效时间，请使用服务器时间。

这一切都取决于你目前如何处理不同的时区......

# c++ - 检查 Windows 8 中的设备（PC / 平板电脑）是什么

> ID：14103285
> 
> 赞同：0
> 
> 时间：2012-12-31T15:21:12.827
> 
> 标签：c++, xaml, windows-8, directx

这里有谁知道如何检查哪个设备在 Windows 8 中运行应用程序？

最好是 Directx + Xaml 版本。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:49:15.257

当我们开发 Windows 8 时，我们有意将“平板电脑”和“PC”合二为一。如果你看看新一代的硬件（UltraBooks 脱离对接变成平板电脑、基于 ARM 的笔记本电脑等），你就会明白为什么不能向应用程序开发人员保证设备是“平板电脑”或“PC”。您可以将许多功能检查串在一起进行猜测，但您可能会因意外用例而无意中导致糟糕的用户体验。

期待“但 Apple...”的回复：这对于 Apple 生态系统来说是不同的，因为他们的 PC 硬件运行的操作系统与他们的平板电脑完全不同，而且他们的平台仅在少数已知的 Apple 设备上可用。将手机与平板电脑进行比较时，情况也有所不同，因为智能手机本质上是屏幕较小的平板电脑。Windows 的目的是在各种硬件制造商的各种设备上运行。这两种情况都有优缺点。

# c# - 如何使用 async/await 调用 web 服务？

> ID：14103288
> 
> 赞同：30
> 
> 时间：2012-12-31T15:21:26.340
> 
> 标签：c#, soap, windows-phone-8, wsdl

我有一个用[Yii](http://www.yiiframework.com/doc/guide/1.1/en/topics.webservice)（php 框架）编写的[web服务。](http://ychat.marpel.cz/ychat/WebService)

我使用 C# 和 Visual Studio 2012 开发 WP8 应用程序。我为我的项目添加了一个服务引用（添加服务引用）。所以我可以使用网络服务功能。

```
 client = new YChatWebService.WebServiceControllerPortTypeClient();

   client.loginCompleted += client_loginCompleted;   // this.token = e.Result;
   client.loginAsync(this.username, this.password); 

   client.getTestCompleted += client_getTestCompleted;
   client.getTestAsync(this.token); 
```

function`getTestAsync`和`loginAsync`return`void`都是异步的。函数是否可以返回`Task<T>`？我想在我的程序中使用`async`/`await`关键字。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-31T15:42:20.163

假设 loginAsync 返回 void，并且 loginCmpleted 事件在登录完成时触发，这称为基于事件的异步模式，或 EAP。

要将 EAP 转换为等待/异步，请参阅[任务和基于事件的异步模式](https://devblogs.microsoft.com/pfxteam/tasks-and-the-event-based-asynchronous-pattern/)。特别是，您需要使用 TaskCompletionSource 将基于事件的模型转换为基于任务的模型。一旦你有了一个基于任务的模型，你就可以使用 C# 5 的性感等待特性。

这是一个例子：

```
// Use LoginCompletedEventArgs, or whatever type you need out of the .loginCompleted event
// This is an extension method, and needs to be placed in a static class.
public static Task<LoginCompletedEventArgs> LoginAsyncTask(this YChatWebService.WebServiceControllerPortTypeClient client, string userName, string password) 
{ 
    var tcs = CreateSource<LoginCompletedEventArgs>(null); 
    client.loginCompleted += (sender, e) => TransferCompletion(tcs, e, () => e, null); 
    client.loginAsync(userName, password);
    return tcs.Task; 
}

private static TaskCompletionSource<T> CreateSource<T>(object state) 
{ 
    return new TaskCompletionSource<T>( 
        state, TaskCreationOptions.None); 
}

private static void TransferCompletion<T>( 
    TaskCompletionSource<T> tcs, AsyncCompletedEventArgs e, 
    Func<T> getResult, Action unregisterHandler) 
{ 
    if (e.UserState == tcs) 
    { 
        if (e.Cancelled) tcs.TrySetCanceled(); 
        else if (e.Error != null) tcs.TrySetException(e.Error); 
        else tcs.TrySetResult(getResult()); 
        if (unregisterHandler != null) unregisterHandler();
    } 
} 
```

现在您已经将基于事件的异步编程模型转换为基于任务的模型，您现在可以使用 await：

```
var client = new YChatWebService.WebServiceControllerPortTypeClient();
var login = await client.LoginAsyncTask("myUserName", "myPassword"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-31T15:28:52.630

在添加您的服务参考时，请确保您`Generate Task based operations`在`Advanced`部分中选择。这将创建可等待的方法，例如`LoginAsync`返回`Task<string>`

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-12-09T17:02:59.740

去年我不得不这样做几次，我使用了上面@Judah的代码和他引用的[原始示例](https://blogs.msdn.microsoft.com/pfxteam/2009/06/19/tasks-and-the-event-based-asynchronous-pattern/)，但每次我都遇到以下问题：异步调用有效但**没有完成**。如果我单步执行它，我可以看到它会进入`TransferCompletion`方法，但`e.UserState == tcs`总是会`false`。

事实证明，像 OP 这样的 Web 服务异步方法`loginAsync`有两个签名。第二个接受一个`userState`参数。解决方案是将`TaskCompletionSource<T>`您创建的对象作为此参数传递。这样`e.UserState == tcs`将返回true。

在 OP 中，`e.UserState == tcs`删除了 以使代码工作是可以理解的 - 我也被诱惑了。但我相信这是为了确保正确的事件完成。

完整的代码是：

```
public static Task<LoginCompletedEventArgs> RaiseInvoiceAsync(this Client client, string userName, string password)
{
    var tcs = CreateSource<LoginCompletedEventArgs>();
    LoginCompletedEventHandler handler = null;
    handler = (sender, e) => TransferCompletion(tcs, e, () => e, () => client.LoginCompleted -= handler);
    client.LoginCompleted += handler;

    try
    {
        client.LoginAsync(userName, password, tcs);
    }
    catch
    {
        client.LoginCompleted -= handler;
        tcs.TrySetCanceled();
        throw;
    }

    return tcs.Task;
} 
```

或者，我相信也有一个`tcs.Task.AsyncState`属性可以提供`userState`. 因此，您可以执行以下操作：

```
if (e.UserState == taskCompletionSource || e.UserState == taskCompletionSource?.Task.AsyncState)
{
    if (e.Cancelled) taskCompletionSource.TrySetCanceled();
    else if (e.Error != null) taskCompletionSource.TrySetException(e.Error);
    else taskCompletionSource.TrySetResult(getResult());
    unregisterHandler();
} 
```

这是我最初尝试的，因为它似乎是一种更轻松的方法，我可以传递一个 Guid 而不是完整的 TaskCompletionSource 对象。如果您有兴趣， Stephen Cleary[对 AsyncState 有很好的描述。](http://blog.stephencleary.com/2014/05/a-tour-of-task-part-2-asyncstate-and-creationoptions.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-27T15:12:30.940

（从 OP 复制，每[https://meta.stackexchange.com/a/150228/136378](https://meta.stackexchange.com/a/150228/136378)）

**回答：**

以下代码似乎有效。

```
internal static class Extension
{
    private static void TransferCompletion<T>(
        TaskCompletionSource<T> tcs, System.ComponentModel.AsyncCompletedEventArgs e, 
        Func<T> getResult)
    {
        if (e.Error != null)
        {
            tcs.TrySetException(e.Error);
        }
        else if (e.Cancelled)
        {
            tcs.TrySetCanceled();
        }
        else
        {
            tcs.TrySetResult(getResult());
        }
    }

    public static Task<loginCompletedEventArgs> LoginAsyncTask(
        this YChatWebService.WebServiceControllerPortTypeClient client,
        string userName, string password)
    {
        var tcs = new TaskCompletionSource<loginCompletedEventArgs>();
        client.loginCompleted += (s, e) => TransferCompletion(tcs, e, () => e);
        client.loginAsync(userName, password);
        return tcs.Task;
    }
} 
```

我这样称呼它

```
client = new YChatWebService.WebServiceControllerPortTypeClient();
var login = await client.LoginAsyncTask(this.username, this.password); 
```

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2012-12-31T15:44:13.943

如果您希望能够等待这些方法，它们应该返回 Task。您不能等待返回 void 的方法。如果您希望它们返回一个值，例如它们应该返回的 int，`Task<int>`那么该方法应该返回 int。

```
public async Task loginAsync(string username, string password) {} 
```

然后你可以打电话

```
Task t = loginAsync(username, password);
//login executing
//do something while waiting

await t; //wait for login to complete 
```

# jquery - 浏览器兼容的解决方法，而不是使用 .data()

> ID：14103290
> 
> 赞同：1
> 
> 时间：2012-12-31T15:21:28.693
> 
> 标签：jquery

似乎某些浏览器（带有 Compatibility View 的 Internet Explorer `ON`）不支持该[`.data()`](http://api.jquery.com/jQuery.data/)对象，接下来最好使用什么？

```
$("#object").data('value','hi'); 
```

我在想我可以将类应用于对象并使用`hasClass()`，但也许有更好的方法？如果它尽可能轻量级会更好（不使用cookies）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T15:25:49.660

即使在这种模式下，我也相当确定`data()`作品。

如果没有，请将正确的元标记添加到您的`<head>`中，以强制 IE 不使用损坏模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:28:10.483

您可以使用 html5 数据属性。

```
$("#object").attr('data-val1','hi'); 
```

# c - 在 C 中实现队列

> ID：14103293
> 
> 赞同：2
> 
> 时间：2012-12-31T15:21:45.577
> 
> 标签：c, queue, gstreamer, tail, head

我正在尝试为 Gstreamer 缓冲区实现自定义队列。问题是当我尝试出队时，似乎我失去了队列的头部。每当我尝试两次出队时，都会出现分段错误。我还注意到 head 总是等于 head->next。现在我不确定入队或出队是否有问题。请帮帮我。谢谢你。

```
typedef struct _GstBUFFERQUEUE GstBufferQueue;

struct _GstBUFFERQUEUE {
  GstBuffer *buf;
  guint buf_size;
  struct _GstBUFFERQUEUE *next;
};

void enqueue_gstbuffer(GstBufferQueue **head, GstBufferQueue **tail, guint *queue_size, GstBuffer *buf)
{
  if (*queue_size == 0)
  {
    *head = malloc(sizeof(GstBufferQueue));
    (*head)->buf = gst_buffer_try_new_and_alloc (GST_BUFFER_SIZE(buf));
    (*head)->buf = gst_buffer_copy(buf); 
    *tail = *head;
  }
  else
  {
    if ((*tail)->next = malloc(sizeof(GstBufferQueue))) {
        (*tail)->next->buf = gst_buffer_try_new_and_alloc (GST_BUFFER_SIZE(buf));
        (*tail)->next->buf = gst_buffer_copy(buf);
        (*tail) = (*tail)->next;
    }
    else {
        GST_WARNING("Error allocating memory for new buffer in queue");
    } 
  } 
  (*tail)->next = NULL; 
  (*queue_size)++;

}

void dequeue_gstbuffer(GstBufferQueue **head, GstBufferQueue **tail, guint *queue_size, GstBuffer **buf)
{
  GstBufferQueue **tmpPtr = head;
  GstBufferQueue **nextPtr;
  *nextPtr = (*head)->next; 
  *buf = gst_buffer_try_new_and_alloc (GST_BUFFER_SIZE((*tmpPtr)->buf));
  *buf = gst_buffer_copy((*tmpPtr)->buf);
  gst_buffer_unref((*tmpPtr)->buf);
  free((*tmpPtr));
  *head = *nextPtr;

  if ((*head) == NULL)
     (*tail) = NULL;

   (*queue_size)--;   
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T17:38:44.167

当通过添加足够的伪基础设施来模拟 GST 系统转换为可编译代码时，GCC 会出现一个警告，这几乎肯定是您的问题的根源：

```
gstq.c: In function ‘dequeue_gstbuffer’:
gstq.c:73:12: warning: ‘nextPtr’ is used uninitialized in this function [-Wuninitialized] 
```

这些行是：

```
72  GstBufferQueue **nextPtr;
73  *nextPtr = (*head)->next; 
```

在这些行中，您需要：

```
GstBufferQueue *nextPtr = (*head)->next; 
```

您还需要使用：

```
(*head)->next = nextPtr; 
```

注意你的编译器警告。如果你的编译器没有警告，让它这样做。如果您不能使其警告，请获得更好的编译器。

* * *

### SSCCE

```
#include <stdlib.h>
#include <stdio.h>
#include <assert.h>

#define GST_BUFFER_SIZE(x)  sizeof(x)
#define GST_WARNING(x)      fprintf(stderr, "%s\n", x)

typedef struct GstBuffer { int value; } GstBuffer;
typedef unsigned int guint;

static GstBuffer *gst_buffer_try_new_and_alloc(int size)
{
    GstBuffer *buf = malloc(sizeof(GstBuffer));
    assert(buf != 0);
    buf->value = size;
    return buf;
}

static GstBuffer *gst_buffer_copy(const GstBuffer *buf)
{
    GstBuffer *new_buf = malloc(sizeof(GstBuffer));
    assert(new_buf != 0);
    new_buf->value = buf->value;
    return new_buf;
}

static void gst_buffer_unref(GstBuffer *buf)
{
    buf->value = -1;
}

typedef struct _GstBUFFERQUEUE GstBufferQueue;

struct _GstBUFFERQUEUE {
  GstBuffer *buf;
  guint buf_size;
  struct _GstBUFFERQUEUE *next;
};

extern void enqueue_gstbuffer(GstBufferQueue **head, GstBufferQueue **tail, guint *queue_size, GstBuffer *buf);
extern void dequeue_gstbuffer(GstBufferQueue **head, GstBufferQueue **tail, guint *queue_size, GstBuffer **buf);

void enqueue_gstbuffer(GstBufferQueue **head, GstBufferQueue **tail, guint *queue_size, GstBuffer *buf)
{
  if (*queue_size == 0)
  {
    *head = malloc(sizeof(GstBufferQueue));
    (*head)->buf = gst_buffer_try_new_and_alloc(GST_BUFFER_SIZE(buf));
    (*head)->buf = gst_buffer_copy(buf); 
    *tail = *head;
  }
  else
  {
    if (((*tail)->next = malloc(sizeof(GstBufferQueue))) != 0)
    {
        (*tail)->next->buf = gst_buffer_try_new_and_alloc(GST_BUFFER_SIZE(buf));
        (*tail)->next->buf = gst_buffer_copy(buf);
        (*tail) = (*tail)->next;
    }
    else
    {
        GST_WARNING("Error allocating memory for new buffer in queue");
    } 
  } 
  (*tail)->next = NULL; 
  (*queue_size)++;
}

void dequeue_gstbuffer(GstBufferQueue **head, GstBufferQueue **tail, guint *queue_size, GstBuffer **buf)
{
  GstBufferQueue **tmpPtr = head;
  GstBufferQueue  *nextPtr;
  nextPtr = (*head)->next; 
  *buf = gst_buffer_try_new_and_alloc (GST_BUFFER_SIZE((*tmpPtr)->buf));
  *buf = gst_buffer_copy((*tmpPtr)->buf);
  gst_buffer_unref((*tmpPtr)->buf);
  free((*tmpPtr));
  *head = nextPtr;

  if ((*head) == NULL)
     (*tail) = NULL;

   (*queue_size)--;   
}

int main(void)
{
    GstBufferQueue *q_head = 0;
    GstBufferQueue *q_tail = 0;
    guint           q_size = 0;

    for (int i = 0; i < 10; i++)
    {
        GstBuffer *buf = gst_buffer_try_new_and_alloc(i + 100);
        enqueue_gstbuffer(&q_head, &q_tail, &q_size, buf);
        printf("EQ: %d\n", buf->value);
        free(buf);
        if (i % 2 == 1)
        {
            GstBuffer *buf;
            dequeue_gstbuffer(&q_head, &q_tail, &q_size, &buf);
            printf("DQ: %d\n", buf->value);
            free(buf);
        }
    }

    while (q_size > 0)
    {
        GstBuffer *buf;
        dequeue_gstbuffer(&q_head, &q_tail, &q_size, &buf);
        printf("DQ: %d\n", buf->value);
        free(buf);
    }

    printf("All done\n");
    return(0);
} 
```

### 输出

```
EQ: 100
EQ: 101
DQ: 100
EQ: 102
EQ: 103
DQ: 101
EQ: 104
EQ: 105
DQ: 102
EQ: 106
EQ: 107
DQ: 103
EQ: 108
EQ: 109
DQ: 104
DQ: 105
DQ: 106
DQ: 107
DQ: 108
DQ: 109
All done 
```

请注意，上面的 SSCCE 代码比筛子更容易泄漏。我没有修复泄漏的计划，因为它们在模拟 GST 缓冲区管理的代码中。请检查您的代码是否受到内存泄漏的影响。

* * *

我认为你应该以不同的方式包装你的“队列”。你所说的 a`GstBufferQueue`应该真的是 a `GstBufferQueueItem`，你的实际`GstBufferQueue`应该包含 head 和 tail 指针，以及大小。您将指向（修订后的） and 函数的指针传递`GstBufferQueue`给`enqueue_gstbuffer()`and`dequeue_gstbuffer()`函数，而不是传递 3 个单独的参数。

```
typedef struct GstBufferQueueItem GstBufferQueueItem;

struct GstBufferQueueItem
{
  GstBuffer *buf;
  guint buf_size;
  GstBufferQueueItem *next;
};

typedef struct GstBufferQueue GstBufferQueue;

struct GstBufferQueue
{
    GstBufferQueueItem *head;
    GstBufferQueueItem *tail;
    guint               size;
};

// Uncompiled - but to give you an idea
void dequeue_gstbuffer(GstBufferQueue *q, GstBuffer **buf)
{
    GstBufferQueueItem *item = q->head;
    GstBufferQueueItem *next = item->next; 
    *buf = gst_buffer_try_new_and_alloc(GST_BUFFER_SIZE(item->buf));
    *buf = gst_buffer_copy(item->buf);
    gst_buffer_unref(item->buf);
    free(item);
    q->head = next;

    if (q->head == NULL)
        q->tail = NULL;

    q->size--;   
} 
```

请注意，这些名称避免使用前导下划线。这样的名字是危险的。带有下划线和大写字母的名称保留用于任何目的的实现。带有下划线和小写字母的名称被保留为不同的单词，但使用其中任何一个都是狡猾的（尽管标准很少提及下划线和数字，但不要与它们玩游戏 - 将前导下划线视为“保留用于系统”，除非你写的是“系统”）。

### ISO/IEC 9899:2011 §7.1.3 保留标识符

> *   以下划线和大写字母或另一个下划线开头的所有标识符始终保留用于任何用途。
> *   所有以下划线开头的标识符始终保留用作普通和标记名称空间中具有文件范围的标识符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-31T17:41:47.433

代替

```
GstBufferQueue **nextPtr;
*nextPtr = (*head)->next;
...
*head = *nextPtr; 
```

经过

```
GstBufferQueue *nextPtr;
nextPtr = (*head)->next;
...
*head = nextPtr; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T16:59:47.150

对我来说突出的一件事是当您第一次分配队列时（当 *queue_size == 0 时）您没有将新创建的节点的“下一个”指针设置为 NULL。

不能保证在分配和分配给 (*head) 之后它会为 NULL，因此当您执行出列时，您的 (*head)->next 可能指向垃圾地址。

# git - 在 github 上拉一个“podified”项目的分支

> ID：14103296
> 
> 赞同：3
> 
> 时间：2012-12-31T15:21:55.340
> 
> 标签：git, github, magicalrecord, cocoapods

我想拉一个github项目的分支而不是master。有人知道如何做到这一点，而不必自己分叉主人并将分支与主人合并吗？

pod 'MagicalRecord', :git => 'https://github.com/nhenin/MagicalRecord.git'

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-21T22:22:52.817

[这个拉取请求](https://github.com/CocoaPods/CocoaPods/pull/262)使这成为可能。文档似乎不是最新的。

这是如何做到的：

```
pod 'JSFooBar', :git => 'https://github.com/joelso/JSFooBar.git', :branch => 'develop' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T15:46:45.800

查看[Wiki 上的文档](https://github.com/CocoaPods/CocoaPods/wiki/Dependency-declaration-options)，它为您提供了一些额外的选项，例如选择特定的提交。

# sql - 关系代数 - 除法

> ID：14103297
> 
> 赞同：2
> 
> 时间：2012-12-31T15:21:58.697
> 
> 标签：sql, database-design, relational-database, relational-algebra

如果我有以下表格并在关系代数中执行 R1/R2，结果会是 A 值为 1 和 3 的表格吗？我有点困惑，因为我知道 3 将是一个结果，因为它同时包含 5 和 1，但是结果 1 除了匹配的值之外还有 B 的其他值，所以这也会包括在内，为什么？

```
 R1          R2
    +---+---+   +---+
    | A | B |   | B |
    |---|---|   |---|
    | 1 | 1 |   | 5 |
    | 1 | 2 |   | 1 |
    | 1 | 3 |   +---+
    | 1 | 4 |
    | 2 | 3 |
    | 2 | 4 |
    | 3 | 5 |
    | 3 | 1 |
    | 1 | 5 |
    | 5 | 7 |
    | 5 | 8 |
    +---+---+ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T22:20:42.650

在关系数据库中 Divide 定义为：
R1(Y,X) DIVIDE R2(X) = R1[Y] MINUS ((R1[Y] TIMES R2) MINUS R1)[Y]

请记住，R1[Y] 是“PROJECT R1 over Y”的另一种形式。
所以结果是 {1,3}

# ruby-on-rails-3 - 带有自定义过滤器的 exception_notification gem 正在生成 ActionView::Template::Error: can't dup Symbol 错误

> ID：14103301
> 
> 赞同：0
> 
> 时间：2012-12-31T15:22:12.223
> 
> 标签：ruby-on-rails-3

我正在尝试这样做：

```
config.filter_parameters << lambda do |k,v|
  if k == "content"
    v.slice!(250..-1)
    v.insert(-1, "...[TRUNCATED]")
  end
end 
```

以便通过大的“内容”字段来管理日志。但是当我生成异常时，我得到以下堆栈跟踪。异常通知 3.0、Rails 3.2.8

想法？

```
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/http/parameter_filter.rb:40:in `dup'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/http/parameter_filter.rb:40:in `block (2 levels) in compiled_filter'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/http/parameter_filter.rb:32:in `each'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/http/parameter_filter.rb:32:in `block in compiled_filter'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/http/parameter_filter.rb:11:in `call'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/http/parameter_filter.rb:11:in `filter'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/http/parameter_filter.rb:36:in `block (2 levels) in compiled_filter'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/http/parameter_filter.rb:32:in `each'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/http/parameter_filter.rb:32:in `block in compiled_filter'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/http/parameter_filter.rb:11:in `call'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/http/parameter_filter.rb:11:in `filter'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/http/filter_parameters.rb:38:in `filtered_env'
ruby/1.9.1/gems/exception_notification-3.0.0/lib/exception_notifier/views/exception_notifier/_environment.text.erb:1:in `__home_myappuser_myapp_shared_bundle_ruby_______gems_exception_notification_______lib_exception_notifier_views_exception_notifier__environment_text_erb__953280712_90713590'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_view/template.rb:145:in `block in render'
ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/notifications.rb:125:in `instrument'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_view/template.rb:143:in `render'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_view/renderer/partial_renderer.rb:265:in `render_partial'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_view/renderer/partial_renderer.rb:238:in `block in render'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_view/renderer/abstract_renderer.rb:38:in `block in instrument'
ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/notifications.rb:123:in `block in instrument'
ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
ruby/1.9.1/gems/activesupport-3.2.8/lib/active_support/notifications.rb:123:in `instrument'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_view/renderer/abstract_renderer.rb:38:in `instrument'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_view/renderer/partial_renderer.rb:237:in `render'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_view/renderer/renderer.rb:41:in `render_partial'
ruby/1.9.1/gems/actionpack-3.2.8/lib/action_view/helpers/rendering_helper.rb:27:in `render'
ruby/1.9.1/gems/exception_notification-3.0.0/lib/exception_notifier/views/exception_notifier/exception_notification.text.erb:9:in `block in __home_myappuser_myapp_shared_bundle_ruby_______gems_exception_notification_______lib_exception_notifier_views_exception_notifier_exception_notification_text_erb___442452799_85036510' 
```

# c++ - 将类声明为类的一部分的问题

> ID：14103304
> 
> 赞同：0
> 
> 时间：2012-12-31T15:22:17.073
> 
> 标签：c++, class, header, include, declaration

我在编写一个作为 C++ 程序的一部分的类时遇到问题 - 其中我有三个类，FirstClass、SecondClass 和 ThirdClass - First 和 Second 类都包括 ThirdClass.h，但是在 SecondClass 中我可以正常声明它们，在 FirstClass 中，第一个声明工作正常，但任何进一步的声明都会给我一个错误，“ThirdClass 不是类型名称”

这是错误类中的一个片段

```
#include "ThirdClass.h"

class FirstClass
{
public:

    FirstClass(void);

    // This decleration of ThirdClass works fine
    FirstClass(ThirdClass ());
    FirstClass(const FirstClass& rhs);
    ~FirstClass(void);

private:

    //These are the two that're erroring
    ThirdClass nestedClass();

    void Init (ThirdClass ());
    void Copy (FirstClass);
}; 
```

我假设这与它们都链接到同一个头文件有关，但我一直在寻找广泛的方法，试图在网上找到解决方案，但无济于事。我确实设法通过将包含放在命名空间中来使其工作，但我也读到这是非常糟糕的做法，所以我真的不想那样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T16:04:23.987

```
FirstClass(ThirdClass ()); 
```

这应该做什么？

如果`ThirdClass`已经声明了类型，那么它声明了一个以函数地址作为参数的构造函数，这不是你想要的，对吧？ `ThirdClass ()`是不带参数并返回 a 的函数的类型`ThirdClass`，因此您的构造函数参数是该类型的函数（地址）。

如果`ThirdClass` *尚未*声明（并且您得到的错误暗示尚未声明），则它相当于：

```
FirstClass ThirdClass(); 
```

即调用的（非构造函数）函数`ThirdClass`返回一个`FirstClass`对象。

您可能希望它是一个以`ThirdClass`对象为参数的构造函数，即：

```
FirstClass(ThirdClass); 
```

或者为了避免复制参数（这通常是你想要的）：

```
FirstClass(const ThirdClass&); 
```

对于您的`Init`功能也是如此。

说`ThirdClass`不是类型名称的错误表明该类型尚未声明。我们只能猜测，因为您没有显示完整的、独立的示例（没有 cookie），但您`#include "FirstClass.h"`的`ThirdClass.h`标题中可能有，这会导致循环引用，并且只有一个文件被正确处理。

有关更多信息，请参阅这些问题（及其答案）：
[头文件之间的循环依赖](https://stackoverflow.com/q/2089056/981959)
[C++ 循环头依赖](https://stackoverflow.com/q/5239943/981959)
[C++ 错误：'Line2' 尚未声明](https://stackoverflow.com/q/5058363/981959)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T15:30:19.403

我猜，你的构造函数`Init()`应该是

```
FirstClass(const ThirdClass &rhs);
...
void Init (const ThirdClass &rhs); 
```

此外，您应该考虑添加[include guards](http://en.wikipedia.org/wiki/Include_guard)。

# wordpress - htaccess 将 wordpress 网站的子域重定向到页面

> ID：14103308
> 
> 赞同：1
> 
> 时间：2012-12-31T15:23:01.617
> 
> 标签：wordpress, .htaccess, subdomain

我目前在 domain1.org 运行子域 WordPress 网络。其中一个子域站点是映射到 domain2.org 的域。我正在尝试向 domain2.org 添加一个子域，该子域将显示为 sample.domain2.org。问题是 domain2 指向 domain1。我们不使用通配符，我们手动编辑每个子域站点的 DNS（服务器管理规则）。尝试了重定向规则，例如`Redirect 301 http://friend.episode13.org/ http://episode13.org/friend/`

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T17:02:21.617

您需要为 设置一个虚拟主机`friend.episode13.org`，并在该虚拟主机中重定向到`http://episode13.org/friend/`：

```
Redirect 301 / http://episode13.org/friend/ 
```

否则，您可以尝试使用 mod_rewrite 并在`friend.episode13.org`子域指向的 vhost（或文档根目录中的 htaccess 文件）中添加：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^friend\.episode13\.org$ [NC]
RewriteRule ^/?(.*)$ http://episode13.org/friend/$1 [L,R=301] 
```

# java - Java IndexOutOfBoundsException

> ID：14103310
> 
> 赞同：0
> 
> 时间：2012-12-31T15:23:09.570
> 
> 标签：java, android, indexing, bounds, out

我创建了一个小安卓游戏，但出现了奇怪的错误。

这是日志：

```
 12-31 16:10:22.407: E/AndroidRuntime(12824): FATAL EXCEPTION: Thread-1461
    12-31 16:10:22.407: E/AndroidRuntime(12824): java.lang.IndexOutOfBoundsException: Invalid index 1, size is 0
    12-31 16:10:22.407: E/AndroidRuntime(12824):    at java.util.ArrayList.throwIndexOutOfBoundsException(ArrayList.java:251)
    12-31 16:10:22.407: E/AndroidRuntime(12824):    at java.util.ArrayList.get(ArrayList.java:304)
    12-31 16:10:22.407: E/AndroidRuntime(12824):    at **.***.****.GameScreen.updatePaused(GameScreen.java:91)
    12-31 16:10:22.407: E/AndroidRuntime(12824):    at **.***.****.GameScreen.update(GameScreen.java:43)
    12-31 16:10:22.407: E/AndroidRuntime(12824):    at **.***.****.framework.impl.AndroidFastRenderView.run(AndroidFastRenderView.java:39)
    12-31 16:10:22.407: E/AndroidRuntime(12824):    at java.lang.Thread.run(Thread.java:856) 
```

这是执行的部分代码：

```
 int len = touchEvents.size();
    for(int i = 0; i < len; i++) {
        TouchEvent event = touchEvents.get(i); ->>> this line
    .
    .
    . 
```

怎么了 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T15:52:54.207

如果您遇到线程问题，则必须在像这样循环之前在集合上同步

```
synchronize(touchEvents) {
    for(TouchEvent event : touchEvents) {
        //do whatever you want with events
    }
} 
```

或者，您可以制作集合的本地副本并循环，如果在您处理副本时处理集合中的事件仍然有效，如果它们已被删除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T15:34:02.810

最安全的方法肯定是像这样使用增强的 for 循环

```
for(TouchEvent event : touchEvents) {
    //do whatever you want with events
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-31T15:52:23.977

您应该始终检查 NULL。

```
int len = touchEvents != null ? touchEvents.size() : 0
for(int i = 0; i < len; i++)
  TouchEvent event = touchEvents.get(i); 
```

# networking - 网络和 CRC 混淆

> ID：14103311
> 
> 赞同：0
> 
> 时间：2012-12-31T15:23:16.863
> 
> 标签：networking, crc

我目前正在做一个项目，需要将数据从A发送到B。B收到数据后，需要能够确定传输过程中是否发生错误。

我已经阅读了 CRC 并决定 CRC16 适合我的需求；我可以将数据分成块并一次发送一个块。

但是，我对 B 如何判断是否发生错误感到困惑。我最初的想法是让A生成一个CRC，然后将数据发送给B。一旦B接收到数据，生成CRC并将其发送回A。如果CRC匹配，则传输成功。但是 - 如果从 B 到 A 的 CRC 传输出错怎么办？将 CRC 发回似乎是多余的，因为它可能会以与数据相同的方式损坏。

我是否遗漏了什么或使情况过于复杂？

任何想法将不胜感激。

谢谢，P

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:33:52.730

CRC 是错误检测，请注意，您的代码只能检测*有限*数量的错误。但是，您可以计算 CRC16 冲突的概率（这对于大多数实际目的而言相对较小）。

现在 CRC 的工作原理是使用多项式除法。您的 CRC 值是一些多项式（对于 CRC16，可能是 (x^15) 的顺序）。也就是说，多项式以二进制形式表示为系数。例如，x^3 + [(0)*x^2] + x + 1 = 1011 是 x^3 阶的某个多项式。现在，您将数据块除以 CRC 多项式。余数是 CRC 值。因此，当您再次对 B 上接收到的块（以及余数）执行此除法运算时，多项式除法应该甚至为 0。如果没有发生这种情况，则说明您有传输错误。

现在，这假设（包括您的 CRC 值的损坏）如果 n 位损坏，CRC 检查将检测到故障（假设没有冲突）。如果CRC校验不通过，只需向A发送重传请求。否则，继续正常处理。如果发生冲突，则无法验证数据是否损坏，除非您手动查看接收到的数据（或发送多个希望无错误的副本 - 请注意，此方法会产生大量开销，并且冗余仅适用于*有限*精度再次）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:27:32.923

您通常将校验和*与*数据一起发送。然后从接收端的数据中计算校验和，并将其与随附的校验和进行比较。如果它们不匹配，则数据或校验和已损坏（除非您不幸发生冲突）-在这种情况下，您应该要求重新传输。

# android - 在 2 个活动之间传递字符串

> ID：14103316
> 
> 赞同：0
> 
> 时间：2012-12-31T15:23:36.693
> 
> 标签：android, xml, android-intent

从数据类我得到一个字符串并试图将它传递给 OpenedClass 但是当我单击按钮时实际上没有任何反应。因为调试器没有显示错误。我假设我的活动不起作用，但我不知道为什么？

这是我的数据类

```
package com.android;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class Data extends Activity implements OnClickListener {
    Button start, startFor;
    EditText sendET;
    TextView gotAnswer;

    @Override
    protected void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.get);
    }

    private void initialize() {
        start = (Button) findViewById(R.id.bSA);
        startFor = (Button) findViewById(R.id.bSAFR);
        sendET = (EditText) findViewById(R.id.etSend);
        gotAnswer = (TextView) findViewById(R.id.tvGOT);
        start.setOnClickListener(this);
        startFor.setOnClickListener(this);

    }

    @Override
    public void onClick(View v) {
        switch (v.getId()) {

        case R.id.bSA:
            String bread = sendET.getText().toString();
            Bundle basket = new Bundle();
            basket.putString("key", bread);
            Intent a = new Intent(Data.this, OpenedClass.class);
            a.putExtras(basket);
            startActivity(a);
            break;

        case R.id.bSAFR:
            break;
        }
    }
} 
```

这里是我的 AndroidManifest.xml 代码相关部分

```
<activity
            android:name=".Data"
            android:exported="false"
            android:label="Data" >
        </activity>
        <activity
            android:name=".OpenedClass"
            android:exported="false"
            android:label="OpenedClass" >
        </activity> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:44:44.747

您没有调用Activity `initialize()` ，`onCreate`因此将其调用 `setContentView`为：

```
 @Override
    protected void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.get);

        initialize() ;  //<<< call initialize method here
    } 
```

# ruby - 在 Ruby 中传递多种数据类型？

> ID：14103319
> 
> 赞同：1
> 
> 时间：2012-12-31T15:24:10.933
> 
> 标签：ruby, syntax

如何将哈希、字符串、数组和符号传递给 Ruby 中的函数？我试过这样：

```
func key: 'value', 'string', ['some', 'array'], :asymbol 
```

这不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T15:25:20.763

您需要使用括号在哈希后传递其他参数。它们只能隐含在方法的最后一个参数中。

```
func({key: 'value'}, 'string', ['some', 'array'], :asymbol) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:26:48.267

`{}`如果在它之后还有其他参数，则需要围绕散列。

```
# this will work
func({key: 'value'}, 'string', ['some', 'array'], :asymbol) 
```

因此，将哈希类型视为方法签名中的最后一个参数是很常见的。只需更新您的方法以最后接受哈希。

```
# this will work, too
func 'string', ['some', 'array'], :asymbol, key: 'value' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T15:28:17.763

你的语法不好。请使用括号和方括号：

```
func({key: "val"}, 'str', [1, 2], :sym) 
```

否则，语言只是看到胡言乱语。

# php - 依赖注入容器，仅用于创建一个类的实例？

> ID：14103322
> 
> 赞同：0
> 
> 时间：2012-12-31T15:24:33.803
> 
> 标签：php, oop, ioc-container

我有这个小依赖注入容器，我实例化如下：

```
$services = new Services(); 
```

如果我需要向它添加参数，我只是这样做：

```
$services->setParameter($name, $value); 
```

我通过我的一些对象的构造函数传递这个实例，`$services`如果我需要数据库句柄之类的东西，我就去`$this->services->getService('db');`，它返回一个数据库句柄的实例，如果我稍后再次调用该方法，它将返回相同的实例数据库处理它之前所做的。

我想知道的是依赖注入容器仅适用于像您的对象这样的单实例`$dbh, $config, $user, $auth`对象吗？

例如，我需要创建一个`Products`类的多个实例，但如果我去：

```
$services->setParameter('product.id', $productId);
$product[] = $services->getService('product'); 
```

它显然会创建一个新实例，`Product`但是如果我再次重复该代码，它只会返回与之前相同的实例，我显然可以`getService()`稍微修改该方法，以便它可以返回我需要的尽可能多的新实例，但是将 DIC 用于它不适合的东西？

所以基本上 DIC 应该只返回一个类的单个实例`$dbh, $user etc`吗？而不是像创建对象`Orders, Products, Invoices`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T15:33:21.793

看看疙瘩的代码：

[https://github.com/fabpot/Pimple](https://github.com/fabpot/Pimple)

您可以定义返回单个实例或返回多个实例的不同方法，具体取决于服务在容器中的定义方式。

Pimple 使用 $container->share 方法来定义共享服务。那么你如何调用你的服务并不重要，重要的是你如何定义它们。

或者你可以只使用已经拥有你需要的一切的疙瘩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:42:33.207

对于产品案例：服务本身只有一个。该服务有一些方法允许您创建多个产品，但这些方法很可能是数据对象，而不是服务。所以基本上你可以拥有`$this->getContainer->getService('product')->createNew()`which 应该返回一个新的产品实例。

在某些情况下，您需要返回多个服务实例，但这些可能不适用于您的示例。正如@camus 之前提到的，Pimple 是这种实现的一个很好的例子，也很容易实现和理解。

# azure - Windows Azure 中的网站可用性

> ID：14103323
> 
> 赞同：0
> 
> 时间：2012-12-31T15:24:45.973
> 
> 标签：azure, azure-web-app-service

> **可能重复：**
> [天蓝色网站的应用程序池超时](https://stackoverflow.com/questions/10943111/app-pool-timeout-for-azure-web-sites)

我正在开发一个托管在 Windows Azure 中的 asp.net mvc 4 应用程序。这个应用程序不会有很多流量，因为人们会间歇性地（每小时一次）使用它。我想尝试使用 Windows Azure。

我的应用程序当前设置为使用免费网站模式。我注意到 30 分钟后，网站需要很长时间（> 5 秒）才能加载。在初始加载之后，它很快。然后，如果有人在 30 分钟内不使用它，则再次加载需要 >5 秒。

然后我尝试将网站模式升级为共享实例。我在那里遇到了同样的问题。

然后我尝试将网站模式升级为 RESERVED 实例。然后问题就消失了。

虽然我想使用 Windows Azure，但对于一个迄今为止很少有人使用过的站点来说，每月为 RESERVED 实例支付 50 美元以上的费用是相当昂贵的。但是，我不能有最初的滞后。这只会推迟我拥有的少数用户。你可以说你得到了你所支付的。同时，我很难相信其他人正在经历这个问题而不抱怨。一定有我想念的东西。

我认为问题必须处理应用程序池重置。但是，我似乎无法解决这个问题。有人熟悉这个问题吗？有没有办法在免费或共享实例上修复它？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T15:54:58.753

这是基于 Windows Azure 网站工作方式的预期行为。他们居住的应用程序池是“按需”启动的，然后在一段时间内闲置。

有关详细（和无耻的插件），您可以查看我的文章：[http ://www.simple-talk.com/dotnet/.net-framework/windows-azure-websites-%e2%80%93-a -new-hosting-model-for-windows-azure/](http://www.simple-talk.com/dotnet/.net-framework/windows-azure-websites-%e2%80%93-a-new-hosting-model-for-windows-azure/)

总之：

网站托管在运行 IIS 的机器群上的进程中。如果站点闲置了一段时间，则该过程将自动关闭。此外，如果盒子由于盒子上的其他站点而受到很大压力，则空闲超时可能会降低很多（甚至低至五分钟）。当下一个电话进来时，您会看到该过程再次启动（可能在完全不同的服务器上）。这是因为您处于共享环境中（并且类似于 Heroku 的工作方式）。一旦你移动到保留，那么你就是那个虚拟机上唯一的人，如果你因为你自己的东西而在处理它时遇到嘈杂的邻居问题。

有一些方法可以让您的网站保持“正常运行”，例如有一份经常 ping url 的工作；但是，鉴于空闲超时有点不稳定，它可能无法解决所有情况。您可以查看 Sandrino 最近关于如何将 Azure 移动服务用作作业调度程序的帖子：http: [//fabriccontroller.net/blog/posts/job-scheduling-in-windows-azure/](http://fabriccontroller.net/blog/posts/job-scheduling-in-windows-azure/)。还有可用的 3rd 方服务可以自动为您执行 ping。

老实说，网站是快速开发和测试的一个很好的功能，甚至是你所说的相对低流量的网站。如果您需要高水平的正常运行时间和更好的性能，那么您将需要查看预留，或者如果成本不符合预期，则可以选择其他选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:44:43.523

这不是 Azure 问题。它是 IIS 中托管的任何网站的“功能”。应用程序池的默认超时为 20 分钟。在此处阅读有关应用程序池超时的信息 - [http://technet.microsoft.com/en-us/library/cc771956(v=ws.10).aspx](http://technet.microsoft.com/en-us/library/cc771956(v=ws.10).aspx) - 一种方法是创建一个保持活动页面并每 10 分钟 ping 一次页面或者。

# ruby-on-rails - 成功远程更新时出现 javascript 错误

> ID：14103331
> 
> 赞同：0
> 
> 时间：2012-12-31T15:25:57.443
> 
> 标签：ruby-on-rails

嗨，我有以下表格：

```
<%= form_for featured_content, :remote => true do |f| %>
                                <%= f.text_field :url, :value => featured_content.url, :class => "form_text_field ajaxSingle" %>
                                <%= button_tag "Update", :class=>'greystyle', :type=>"submit" %>
                            <% end %> 
```

使用以下 JS：

```
 $('.ajaxSingle').live('keyup', function() {
  $(this).parents('form:first').submit();
}); 
```

这将转到以下控制器操作：

```
 def update
    @fc = FeaturedContent.find(params[:id])
    @fc.update_attributes(params[:featured_content])
  end 
```

这一切都完美无缺。但是，每次更新字段时，我都会在 javascript 控制台中收到以下错误：

```
ActionView::MissingTemplate (Missing template featured_contents/update, application/update with {:locale=>[:en], :formats=>[:js, "application/ecmascript", "application/x-ecmascript", :html, :text, :js, :css, :ics, :csv, :png, :jpeg, :gif, :bmp, :tiff, :mpeg, :xml, :rss, :atom, :yaml, :multipart_form, :url_encoded_form, :json, :pdf, :zip], :handlers=>[:builder, :erb, :coffee]}. Searched in:
  * "/Users/rordev/Code/RubyOnRails/Projects/EverythingEver/Dev/everythingever/app/views" 
```

我只有创建、销毁、更新和索引。我该如何摆脱这个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T15:42:10.640

你必须告诉 Rails 为你的 ajax 调用提供一个专门的响应：

```
def update
  @fc = FeaturedContent.find(params[:id])
  @fc.update_attributes(params[:featured_content])
  respond_to do |format|
    format.html
    format.js   { render :json => {:status => 'ok' } } #or any response you might find usefull
  end
end 
```

# css - 让 div 不离开页面顶部

> ID：14103340
> 
> 赞同：0
> 
> 时间：2012-12-31T15:27:07.050
> 
> 标签：css

当您将鼠标悬停在图像上时，我有一个通过 jQuery 函数在设定位置弹出的 DIV，其中有很多是垂直的（比如总高度为 1800 像素）

问题是，如果我向下到页面底部并鼠标悬停，则 div 看起来太高了（超出浏览器）。

我怎样才能让那个 div 不流出页面的操作？IE坚守顶，而不是离去>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T17:55:36.527

我认为您希望将其相对于视口而不是页面定位，对吗？

如果是这样，您需要`position:static`在您的元素上使用。

# c - ncurses 打印的奇怪键值

> ID：14103341
> 
> 赞同：2
> 
> 时间：2012-12-31T15:27:09.507
> 
> 标签：c, linux, keyboard, ascii, curses

我正在使用 Linux 上的 ncurses 库用 C 语言编写一个小程序。

我决定使用*getch()*函数检查我收到的输入，更具体地说，是*退格*键。

*退格*ASCII十进制值为**127**，链接：[这里](http://www.asciitable.com/) 我决定打印我按下的键的十进制数值，例如：

一个-> 97

一个 -> 65

] -> 93 ...

后者是正确的。

但是，以下值**不**正确：

退格 -> 7（即 BELL）

Supr -> 74（即“J”）

这是测试代码：

```
#include <curses.h>

int main(int argc, char **argv)
{
  char ch;
  int column,line;
  int s_column,s_line;
  initscr();
  clear();
  noecho();
  raw();
  keypad(stdscr,TRUE);
  printw("Type: \n> ");
  refresh();
  getyx(stdscr,s_line,s_column);
  while((ch=getch())!='\n')
    {
      printw("%d",ch);
      addch(ch);
      refresh();
    }
  endwin();
  return 0;
} 
```

**注意：**将*raw()*更改为*cbreak()*会生成相同的输出

输出测试：（注意：我输入：'a'，'A'，（Backspace），（Supr），'J'）

```
Type:
> 97a65A7^G74J74J 
```

我不明白为什么会这样，有人可以解释为什么 Backspace 键输出 7 而不是 127，而 Supr 输出 74，这与 sa 'J' 相同吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T16:46:00.020

对于特殊功能键，`getch()`不一定返回 ASCII 字符，它`KEY_xxx`返回`<curses.h>`. 在退格的情况下，这是：

```
#define KEY_BACKSPACE   0407        /* backspace key */ 
```

由于您声明`ch`为`char`而不是`int`，因此该值`0407`被截断为`07`。

将声明更改为：

```
int ch; 
```

然后它会`263`在您按 Backspace 时显示。 `addch()`但是，仍然会显示`^G`，因为它不使用`KEY_xxx`宏。您需要在代码中处理这些字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:55:07.773

我相信“特殊”键正在生成多字符读数，这解释了输出中的 ^ 。

有关更多信息，请参见[插入符号](http://en.wikipedia.org/wiki/Caret_notation)。

# python - 如何在初始化时创建和存储类的实例？

> ID：14103344
> 
> 赞同：2
> 
> 时间：2012-12-31T15:27:36.457
> 
> 标签：python, python-3.x

使用 Python 3.3，我想将一个类绑定`Test`到另一个名为的类，`TestManager`以便管理器创建实例`Test`并存储它们，以便之后访问它们。

简而言之（我的意思是，Python shell ...），我希望能够做到这一点（假设`name`是 的属性`Test`）：

```
> t = Test.objects.get(id=3)
> t.name
# Returns 'Name 3' 
```

诀窍是我的对象集合是一个“静态”集合，从某种意义上说，它是首先创建的（不是由任何用户创建的），然后从未修改或删除，也没有删除或编辑它的记录。它是固定的。所以这是我尝试的代码：

```
class TestManager:
    def __init__(self, *args, **kwargs):
        self._tests = [Test(name='Name {}'.format(i)) for i in range(100)]

    def get(self, id):
        return self._tests[id]

class Test:
    objects = TestManager()

    def __init__(self, name=''):
        self.name = name 
```

正如预期的那样，`NameError: global name 'Test' is not defined`由于循环初始化。理想情况下，我应该`create()`在管理器中有一个方法来负责在列表中添加元素（而不是`__init__()`），但这意味着创建不是在管理器中完成，而是在其他地方完成。

到目前为止，我想出的“最佳”解决方案是首先在`get()`方法中检查列表是否为空，然后调用一个`fill_the_damn_list()`方法，但对我来说这似乎很hackish。另一种方法是使用字典而不是列表，并首先动态创建实例`get()`。后一个的优点是它不会创建无用/从未创建过`get()`的实例，但总共只有一百个，我不确定它是否真的重要，而且这个解决方案的 hackish-ness 看起来与我...

由于我对 Python 很陌生（如果还不够清楚......），我想知道是否有更好的方法来做到这一点并保持简单。如果需要，我也可以重构，但我还没有找到更好的解决方案......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:59:21.560

我完全同意肖恩的评论：您的设计很奇怪，而且我认为毫无用处，这甚至在开始使用它之前就引起了问题。无论如何，如果你想这样做，你可以使用很多不同的方法。

简单的方法：

```
class TestManager:
    def __init__(self, *args, **kwargs):
        self._tests = [Test(name='Name {}'.format(i)) for i in range(100)]

    def get(self, id):
        return self._tests[id]

class Test:
    objects = None

    def __init__(self, name=''):
        self.name = name

Test.objects = TestManager() 
```

另一种方法是使用装饰器：

```
>>> class TestManager(object):
...     def __init__(self, *args, **kwargs):
...             self._tests = []
...     def init_class(self, cls):
...             self._tests = [cls(name='Name {}'.format(i)) for i in range(100)]
...             cls.objects = self
...             return cls
...     def get(self, id):
...             return self._tests[id]
... 
>>> manager = TestManager()
>>> @manager.init_class
... class Test(object):
...     def __init__(self, name=''):
...             self.name = name
... 
>>> manager.get(5)
<__main__.Test object at 0x7f4319db8110> 
```

如果是单例，上面的方法有效`TestManager`，但如果它不是单例，你只需要记住`TestManager.init_class(TheClass)`在访问类实例之前调用，这可以在你的代码中的任何地方完成。

您也可以为此使用吸气剂：

```
>>> class TheGetter(object):
...     def __init__(self, cls):
...             self._cls = cls
...             self._inst = None
...     def __get__(self, inst, owner):
...             if self._inst is None:
...                     self._inst = self._cls()
...             return self._inst
... 
>>> class Test(object):
...     objects = TheGetter(TestManager)
...     def __init__(self, name):
...             self.name = name
... 
>>> Test.objects.get(5)
<__main__.Test object at 0x7f431690c0d0> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T18:50:44.313

您的设计似乎有点奇怪——不清楚为什么`Test`类需要引用`TestManger`实例。无论如何，我认为以下将实现这一点。它使用元类来创建类的属性`objects`，*并将*您想要的属性添加到它创建的实例中——这一切都使这成为一个相当奇特的答案……我想是合适的。;-)`Test`*`_tests``TestManger`*

 *```
class TestManager:
    def __init__(self, *args, **kwargs):
        print('creating TestManager')

    def get(self, id):
        return self._tests[id]

class TestMetaClass(type):
    def __new__(mcl, name, bases, classdict):
        # add an "objects" attribute to the class being created
        classdict['objects'] = tm = TestManager()
        cls = type.__new__(mcl, name, bases, classdict)
        # add a "_tests" attribute to the TestManager instance just created
        # (can't use class's name, since it hasn't been returned yet)
        tm._tests = [cls(name='Name {}'.format(i)) for i in range(100)]
        return cls

class Test(metaclass=TestMetaClass):
    def __init__(self, name=''):
        self.name = name

t = Test.objects.get(3)
print(t.name) 
```*

# php - 使用两行脚本记住页面位置

> ID：14103345
> 
> 赞同：2
> 
> 时间：2012-12-31T15:27:40.213
> 
> 标签：php, javascript

在除 Internet Explorer 之外的所有主流浏览器中，以下脚本在重新加载时将页面返回到之前的垂直位置：

```
<?php $y = $_COOKIE["y"]; ?> //in head tag before any output 
```

和

```
<?php
print "<body onScroll=\"document.cookie='y=' + window.pageYOffset\" onLoad='window.scrollTo(0,$y)'>"; 
```

有人可以告诉我如何修改此代码以记住页面在 IE 中的垂直位置吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T15:31:37.347

来自[w3Schools](http://www.w3schools.com/jsref/prop_win_pagexoffset.asp)：

IE 8 及更早版本不支持此属性，但可以使用“document.body.scrollLeft”和“document.body.scrollTop”代替。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T16:04:39.683

我使用以下代码进行基本的 IE/非 IE 浏览器检测：

```
if(document.all) {  //if IE
    //code
} else {            //if not IE
    //code
} 
```

您应该能够将此与 AlecTMH 的建议`document.body.scrollLeft`和`document.body.scrollTop`建议结合起来，以获得您要去的地方。但是您可能必须为它编写一个函数，然后在`onScroll()`.

我不完全是 JavaScript 专家，但是...

```
function blah() {
    if(document.all) {  //if IE
        document.cookie='y=' + document.body.scrollTop
    } else {            //if not IE
        document.cookie='y=' + window.pageYOffset
    }
} 
```

...可能几乎是功能代码。

# symfony - html5错误信息，翻译

> ID：14103346
> 
> 赞同：2
> 
> 时间：2012-12-31T15:27:41.013
> 
> 标签：symfony, translation, symfony-forms

我对表单一无所知，我猜是 HTML5。我确实构建了这样的表单文本：

```
->add(
  'subject', 'text', array(
  'constraints' => array(new MaxLength(array('limit' => 5, 'message' => 'subject.maxlength'))),
  'required' => true,
  'attr'=>array('oninvalid'=> "setCustomValidity('". $this->get('translator')->trans('subject.oninvalid',array(), 'validators') ."')")
)) 
```

1.) 问题 - 形式：

如果我没有对主题进行任何输入，HTML-subject.oninvalid 就会出现。当我因为 MaxLength 达到限制 5 时，我发送此表单并渲染一个额外的字段 error_messages，看起来不像 subject.oninvalid。为什么 symfony 会弹出两种不同的错误方式？为什么没有像subject.oninvalid那样弹出subject.maxlength？

2.) 问题 - 翻译：

我确实有一个包含多个条目的validators.en.xliff 文件，这是什么工作。Symfony 期望通过 subject.maxlength 复数翻译。为什么？我怎样才能通过[http://symfony.com/doc/2.0/book/translation.html#explicit-interval-pluralization](http://symfony.com/doc/2.0/book/translation.html#explicit-interval-pluralization)`%count%`之类的？`'message' => 'subject.maxlength'`

# java - 输出流到字节[]

> ID：14103348
> 
> 赞同：0
> 
> 时间：2012-12-31T15:27:43.557
> 
> 标签：java, pdf, byte, blob, outputstream

我试图达到的目标是将 PDF 保存到 Oracle 数据库中的 BLOB 中。目前，我使用的 servlet 仅通过 HttpServletResponse 发回一个 pdf。

`Printers.getPDFPrinter(0).printToResponse(myTemplate, response, 0, TemplateA.PDF);`

我无权访问 printToResponse 脚本，所以我不知道它的作用。我只知道响应有一个 HttpServletResponse 类型，我可以从中获取 OutputStream，而 myTemplate 实现了一个我也无法访问的 IDocument 接口。

如果我可以将 myTemplate 或响应放入字节数组（以便将其保存为 blob），那就没问题了。然而，在我所有的搜索中，我只找到了从输入流而不是输出流创建字节数组的代码。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:35:24.650

该代码可能需要完整的 HttpResponse，因为它还需要设置内容类型和其他一些位。尽管听起来很糟糕，但您可以创建一个“模拟”响应对象并覆盖相关方法以拦截其对输出流的写入。您可以为 PDFWriter 提供一个 ByteArrayOutputStream 以便您可以获取 byte[] 并将其写入您的数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:54:01.177

我不确定 servlet 使用哪个库来访问`Printers.getPDFPrinter(0)`，但是：

*   该库可能提供除`printToResponse`( `printToStream`, `printToFile`, ...?)以外的其他方法
*   你可以通过你自己的`HttpServletResponse`返回一个虚拟的[ServletOutputStream](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletOutputStream.html) on `getOutputStream()`。这个虚拟子类必须通过委托[Blob.setBinaryStream(1)](http://docs.oracle.com/javase/6/docs/api/java/sql/Blob.html#setBinaryStream%28long%29)的结果来实现[write(int b](http://docs.oracle.com/javase/6/docs/api/java/io/OutputStream.html#write%28int%29) ) 。

如果您想编写自己的[HttpServletResponse](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletResponse.html)`HttpServletResponseWrapper` ，如果 servlet 还应该返回您`ServletOutputStream`需要委托原始和 Blob 流的 PDF ，我更愿意继承。

如果您希望 servlet 只是为了返回一个 id 以便稍后从数据库中检索 PDF，您需要实现自己的`HttpServletResponse`. 在这种情况下，我会使用 a`Proxy`和`InvocationHandler`handles `getOutputStream()`。

# excel - 如何在 CSV 文件中的公式中转义逗号

> ID：14103350
> 
> 赞同：1
> 
> 时间：2012-12-31T15:27:58.190
> 
> 标签：excel, csv, escaping, delimiter, comma

我正在尝试创建一个 CSV 文件（Excel 或 LibreOffice），其中包含一个使用逗号分隔的多个参数的公式。逗号被解释为字段分隔符。是否可以以某种方式转义逗号，以便可以使用需要逗号的公式？

这按预期工作：

```
=Sum(A1:A10) 
```

由于在公式中使用逗号，这不能正确读取：

```
=Confidence.Norm(.01, Stdev.p(A1:A10), 10) 
```

想象的不起作用的解决方案：

```
=Confidence.Norm(.01 \, Stdev.p(A1:A10) \, 10)
=Confidence.Norm(.01 ',' Stdev.p(A1:A10) ',' 10)
=+"Confidence.Norm(.01 \, Stdev.p(A1:A10) \, 10)" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T15:29:51.123

试试这个：

```
"=Confidence.Norm(.01, Stdev.p(A1:A10), 10)" 
```

# android - HoloEveryWhere 不改变 ICS + 上的 ActionBarColor - 自定义主题

> ID：14103358
> 
> 赞同：0
> 
> 时间：2012-12-31T15:29:07.487
> 
> 标签：android, android-actionbar, actionbarsherlock, android-holo-everywhere

我使用 HoloEveryWhere 库`Holo.Theme.Sherlock.Light`作为父主题。我也在使用`splitActionBarWhenNarrow`，所以顶部`ActionBar`和底部`ActionBar`将是浅色。我想在 top 有深色`ActionBar`，所以我以编程方式对其进行了更改，并且效果很好。

由于我将 Light 主题作为父主题并在顶部使用深色`ActionBar`，因此`homeAsUpIndcator`将是深色，在深色顶部不可见`ActionBar`。

因此，我创建了一个自定义主题来制作`homeAsUpIndcator`一个轻量级的主题。我已经成功地使用了这个主题：

`

```
<style name="AppTheme" parent="@style/Holo.Theme.Sherlock.Light">
    <item name="android:homeAsUpIndicator">@drawable/abs__ic_ab_back_holo_dark</item>
    <item name="homeAsUpIndicator">@drawable/abs__ic_ab_back_holo_dark</item>
</style> 
```

`

这在 Android 2.2 Emulator 中完美运行，但在 ICS+ 中`ActionBar`却`ActionPopupMenus`不行

实际上我没有在任何地方指定任何黑暗主题！我是否缺少自定义主题的任何属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T15:36:50.827

我怀疑您有一个 values-v11 文件夹，其中还声明了您的主题（'AppTheme'）。您可以删除样式（如果您不打算用它做其他事情）

# c# - WaitHandle 在不应该关闭时关闭

> ID：14103360
> 
> 赞同：0
> 
> 时间：2012-12-31T15:29:33.510
> 
> 标签：c#, multithreading, waithandle

这段代码大部分时间都有效，所以我在考虑一些竞争条件。**结果**类是不可变的，但我认为问题不在于该类。

```
public Result GetResult()
{
    using (var waitHandle = new ManualResetEvent(false))
    {
        Result result = null;

        var completedHandler = new WorkCompletedEventHandler((o, e) =>
        {
            result = e.Result;

            // somehow waitHandle is closed, thus exception occurs here
            waitHandle.Set();
        });
        try
        {
            this.worker.Completed += completedHandler;

            // starts working on separate thread
            // when done, this.worker invokes its Completed event
            this.worker.RunWork();

            waitHandle.WaitOne();

            return new WorkResult(result);
        }
        finally
        {
            this.worker.Completed -= completedHandler;
        }
    }
} 
```

编辑：抱歉，在调用 GetResult() 方法之前，我错过了对 this.worker.RunWork() 的调用。这显然导致（有时）两次执行相同的工作，尽管我不确定为什么 waitHandle 在**waitHandle.Set()**之前关闭，尽管 Completed 事件触发了两次。这根本没有影响 IO 工作（结果*是正确的*；在我更改代码以手动关闭**waitHandle 之后**）。

因此，即使问题不完整，[铱星的答案也应该是最接近的答案（如果不是正确的答案）。](https://stackoverflow.com/a/14103796/93944)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:19:26.720

在您给出的代码中似乎没有什么特别的问题，这表明您未显示的代码中可能存在导致问题的东西。我假设`worker`您正在使用的是您的代码库的一部分（而不是 .NET BCL 的一部分`BackgroundWorker`？）它可能值得发布代码，以防出现导致问题的问题。

例如，如果同一个工作线程被多个线程重复使用（或者有一个错误`Completed`可以为同一个工作多次引发），那么如果工作线程使用“通常”的方式来调用事件处理程序， IE：

```
var handler = Completed;
if (handler != null)
{
    handler(...);
} 
```

您可以有一个实例 where在子句*之前*`var handler = Completed;`执行（因此在从事件中分离之前），但在退出块*之后*调用（因此在处理之后）。然后，您的事件处理程序将在处置后执行，并且您看到的异常将被抛出。*`finally``completedHandler``Completed``handler(...)`*`using(...)``ManualResetEvent``waitHandle`**

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T16:13:16.900

没有明显的原因导致发布的代码会失败。但是我们看不到堆栈跟踪，也看不到触发 Completed 事件的逻辑，因此几乎没有机会为您调试它。任意地，如果事件多次触发，那么您肯定会遇到这种种族问题。

棘手的线程问题很难调试，线程竞争是发生在微秒级的问题。尝试调试它就足以让比赛消失。或者它发生得如此罕见，以至于有任何发现问题的希望都太罕见了，以至于无法证明尝试的合理性。

此类问题通常需要记录以诊断比赛。一定要选择轻量级的记录方法，登录本身可以改变时间，足以防止比赛发生。

最后但同样重要的是：请注意，在这里使用线程是没有意义的。通过直接调用由 RunWork() 启动的任何线程执行的代码，您可以获得*完全相同的结果。*减去开销和头痛。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T15:40:51.603

如果你摆脱使用你的代码不会在你指定的行抛出异常......如果你真的需要，你必须找到一个合适的地方来处理它。

```
public Result GetResult()
{
    var waitHandle = new ManualResetEvent(false);

        Result result = null;

        var completedHandler = new WorkCompletedEventHandler((o, e) =>
        {
            result = e.Result;

            // somehow waitHandle is closed, thus exception occurs here
            waitHandle.Set();
            waitHandle.Dispose();
        });
        try
        {
            this.worker.Completed += completedHandler;

            // starts working on separate thread
            // when done, this.worker invokes its Completed event
            this.worker.RunWork();

            waitHandle.WaitOne();

            return new WorkResult(result);
        }
        finally
        {
            this.worker.Completed -= completedHandler;
        }
} 
```**

# python - python优雅绕过在Windows上没有locale.D_T_FMT

> ID：14103365
> 
> 赞同：1
> 
> 时间：2012-12-31T15:30:04.333
> 
> 标签：python, datetime

这是交易。我有一个用 C# 编写的工具（不是我的，无法更改），除其他外，它会打印到当前语言环境中的日志时间和日期。
到目前为止一切顺利......我想编写一个解析这个的python代码。
“正确”的方式是`datetime.strptime`作为`locale.nl_langinfo(locale.D_T_FMT)`格式字符串给出。
可惜！我在 Windows 上（其中语言环境对象没有 D_T_FMT） 有什么
优雅的方法可以绕过这个吗？

# solr - 降低特定类别的 Solr 分数

> ID：14103367
> 
> 赞同：0
> 
> 时间：2012-12-31T15:30:14.500
> 
> 标签：solr, filtering

我正在使用 Solr 在我的目录中搜索产品。我试图为“书籍”类别的产品打低分，但没有成功。我还尝试从“书籍”类别中过滤结果，但我仍然得到它们，所以我认为我做错了什么。类别字段已编入索引。

这是我提出的请求的一次尝试（在许多其他尝试中）：

```
http://localhost:8080/solr/collection1/query?q=iphone+4s&rows=4&fq=price:[*+TO+500]&debugQuery=on&fq=not(query(category:Books)) 
```

我还尝试使用对“书籍”产生负面影响的 bf 参数，但仍然没有运气。

当我有“书籍”和其他类别时，我应该怎么做才能降低分数？以及如何过滤特定类别的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:58:59.757

您可以尝试将以下代码附加到您的请求中：-

```
&bq=(*:* -category:Books)^1000000 
```

数字 1000000 指定了一个非常大的数字，它将提升类别不是书籍的那些记录。

因此，您的代码变为：-

```
http://localhost:8080/solr/collection1/query?q=iphone+4s&rows=4&fq=price:[*+TO+500]&debugQuery=on&bq=(*:* -category:Books)^1000000 
```

要过滤具有特定类别的结果，请将以下代码附加到您的请求中：-

```
&fq=category:Books 
```

以上将显示类别为书籍的所有记录。

要获取类别不是书籍的所有记录，请尝试以下操作：-

```
&fq=(*:* -category:Books) 
```

# php - Php - 在每个 array_chunk 的开头添加一个计数器，并在末尾添加一个文本

> ID：14103375
> 
> 赞同：2
> 
> 时间：2012-12-31T15:31:12.023
> 
> 标签：php, arrays, forms

我无法在每个 array_chunk 的开头添加一个计数器并在末尾添加一个文本。

下面是我的实际代码。我使用 $txtcontent 作为来自网络表单的文本输入。

```
 function hexToStr($hex)
{
    $string='';
    for ($i=0; $i < strlen($hex)-1; $i+=2)
    {
        $string .= chr(hexdec($hex[$i].$hex[$i+1]));
    }
    return $string;
}

    $format = $_POST['format'];
    $titre= strtoupper($_POST['titre']);
    $txtcontent = $_POST['texte'];
    $txtcontent =  wordwrap($txtcontent,20,hexToStr('0D0A'),true);

$txtcontent = explode("\n", $txtcontent);
$input = array_chunk($txtcontent, 9, false);
foreach($input as $key => $array){
    foreach($array as $k => $v){
        $input[$key][$k] = '\text '.($k*6+1).',1,'.$commas.str_replace(hexToStr('0D'), "", $v).$commas.hexToStr('0D0A');
    }
}
function array_flatten($array) { 
  if (!is_array($array)) { 
    return FALSE; 
  } 
  $result = array(); 
  foreach ($array as $key => $value) { 
    if (is_array($value)) { 
      $result = array_merge($result, array_flatten($value)); 
    } 
    else { 
      $result[$key] = $value; 
    } 
  } 
  return $result; 
} 
$array = array_flatten($input);

$filecontent = implode($array);     

    header('Content-Type: application/octet-stream');
    header('Content-Disposition: attachment;filename='.$_POST['titre'].'.'.$format.'');
    header('Cache-Control: max-age=0');

    //$fh = fopen($filename, 'wb');
    $fh = fopen('php://output', 'wb');
    fwrite($fh, $filecontent);
    fclose($fh); 
```

我想在每个 array_chunk 的开头添加一个计数器，并在末尾添加一个文本。

示例：如果我将此内容作为输入汇总到网络表单中：

```
line1
line2
line3
line4
line5
line6
line7
line8
line9
line10
line11
line12
line13
line14
line15
line16
line17
line18
line19
line20 
```

我将有一个包含以下内容的文件：

```
\text 1,1,"line1"
\text 7,1,"line2"
\text 13,1,"line3"
\text 19,1,"line4"
\text 25,1,"line5"
\text 31,1,"line6"
\text 37,1,"line7"
\text 43,1,"line8"
\text 49,1,"line9"
\text 1,1,"line10"
\text 7,1,"line11"
\text 13,1,"line12"
\text 19,1,"line13"
\text 25,1,"line14"
\text 31,1,"line15"
\text 37,1,"line16"
\text 43,1,"line17"
\text 49,1,"line18"
\text 1,1,"line19"
\text 7,1,"line20" 
```

但是，我想要下面的代码。在每个块的开头应添加计数器，如 \If S=1, ... 并在末尾添加文本 \IfEnd

```
\If S=1
\text 1,1,"line1"
\text 7,1,"line2"
\text 13,1,"line3"
\text 19,1,"line4"
\text 25,1,"line5"
\text 31,1,"line6"
\text 37,1,"line7"
\text 43,1,"line8"
\text 49,1,"line9"
\IfEnd
\If S=2
\text 1,1,"line10"
\text 7,1,"line11"
\text 13,1,"line12"
\text 19,1,"line13"
\text 25,1,"line14"
\text 31,1,"line15"
\text 37,1,"line16"
\text 43,1,"line17"
\text 49,1,"line18"
\IfEnd
\If S=3
\text 1,1,"line19"
\text 7,1,"line20" 
```

请注意，输入总是可以大于 20 行。

有人对如何做有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:53:14.210

我尝试将以下代码代替您的 foreach 循环，并最终得到您描述的相同输出（减去引号）：

```
$i = 1;
foreach($input as $key => $array){
    $j = 1;
    $input[$key][0] = "\If S=".$i."\n";
    foreach($array as $k => $v){
        $input[$key][$k+1] = '\text '.($k*6+1).',1,'.$commas.str_replace(hexToStr('0D'), "", $v).$commas.hexToStr('0D0A');
        $j++;
    }
    if ($j == 10) $input[$key][10] = "\IfEnd\n";
    $i++;
} 
```

我希望这有帮助。基本上我在你的数组中添加了额外的键值对来为每次迭代获取一个 If 和 IfEnd，并保留一些计数。

# javascript - 在 javascript 中应用的更改将在回发后返回

> ID：14103381
> 
> 赞同：0
> 
> 时间：2012-12-31T15:31:38.157
> 
> 标签：javascript, asp.net

我想在 AsyncFileUpload 中看到 ClientUploadComplete 上的控件。

```
 <cc1:AsyncFileUpload ID="ImageFileUpload" Width="400px" OnClientUploadComplete="uploadComplete"/> 
```

我使用一个函数来显示我的控件。当它完成时，控制的可见性将是真实的。

```
function uploadComplete(sender, args) {
        var filename = args.get_fileName();
        var id = '<%= Session["ID"].ToString()%>' + "." + filename.split('.').pop();
        document.getElementById('FileImage').setAttribute('src', 'Temp/' + id);
        var btn = document.getElementById('<%= RemoveImageButton.ClientID  %>')
        btn.style.visibility = 'visible';

    } 
```

但是在回发之后，该控件的可见性将是错误的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T15:45:25.067

在回发时设置一些其他控件，例如隐藏字段，如下所示。

```
 function uploadComplete(sender, args) {
    var filename = args.get_fileName();
    var id = '<%= Session["ID"].ToString()%>' + "." + filename.split('.').pop();
    document.getElementById('FileImage').setAttribute('src', 'Temp/' + id);
    var btn = document.getElementById('<%= RemoveImageButton.ClientID  %>')
    btn.style.visibility = 'visible';
    hid1.val(1);

} 
```

并在文件上。准备检查隐藏字段值，如果它是一组，则相应地可见。

# javascript - 从另一个站点读取值

> ID：14103382
> 
> 赞同：0
> 
> 时间：2012-12-31T15:32:08.763
> 
> 标签：javascript, jquery

我有这个代码：

```
<html>
<head>
<script src="http://code.jquery.com/jquery-1.8.2.js"></script>
<script src="http://code.jquery.com/ui/1.9.1/jquery-ui.js"></script>
<script>
document.URL = "www.google.com";
var t = document.getElementById("xjsd").innerHTML; 
$('#r').html(t);
</script>
</head>
<body>
<div id="r">
</div>
</body>
</html> 
```

我想从另一个网站（例如 google）读取应答器的值并将其写入我自己的页面，但它不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T15:36:41.157

这是不可能的。否则，这将是一个重大的安全风险（想象一下我的网站访问您当前登录的网上银行网站）。

但是，您可以使用服务器端脚本来获取站点，然后返回 HTML 代码甚至您正在寻找的任何信息。

# javascript - 如何为onclick事件返回两个函数

> ID：14103386
> 
> 赞同：1
> 
> 时间：2012-12-31T15:32:55.460
> 
> 标签：javascript, function, onclick, return

> **可能重复：**
> [如何将 JS 变量的值（而不是引用）传递给函数？](https://stackoverflow.com/questions/2568966/how-do-i-pass-the-value-not-the-reference-of-a-js-variable-to-a-function)

我有几个链接（var a []），上面有一个 onclick 事件。到目前为止，这通过使用一个功能运行良好：

```
function setCurrentImage(x) {
    return function() {
        alert("Image: "+x);
        return false;
    }
}

for(var i = 0; i < a.length; i++) {
    a[i].onclick = setCurrentImage(i);
} 
```

问题是，我需要两个功能。这段代码不起作用：

```
function setCurrentImage(x) {
    return function() {
        alert("Image: "+x);
    }
}

function setCurrentNote(x) {
    return function() {
        alert("Note: "+x);
    }
}

for(var i = 0; i < a.length; i++) {
    a[i].onclick = function() {
        setCurrentImage(i);
        setCurrentNote(i);
        return false;
    }
} 
```

这段代码有什么问题？提前致谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T15:35:26.523

您调用的每个函数都返回一个函数，但实际上并没有做任何事情。
你永远不会调用它们返回的函数。

一旦你解决了这个问题，你就会遇到另一个问题；您的所有内联处理程序共享相同的`i`变量。
您需要将其包装在 IIFE 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:39:33.477

扩展 SLaks 的答案：

```
function setCurrentImage(x) {
    alert("Image: "+x);
}

function setCurrentNote(x) {
    alert("Note: "+x);
}
function setOnclickHandler(x) {
    return function() {
        setCurrentImage(x);
        setCurrentNote(x);

        return false;
    };
}

for(var i = 0; i < a.length; i++) {
    a[i].onclick = setOnclickHandler(x);
} 
```

# android - ORMLite如何在同一个表中使用两列制作'<='？

> ID：14103387
> 
> 赞同：2
> 
> 时间：2012-12-31T15:32:57.760
> 
> 标签：android, where-clause, ormlite

我想做一个这样的查询：

```
SELECT * FROM my_table where column_one <= column_two; 
```

使用 QueryBuilder 我可以制作`where().le(column_one, Object obj)`，但我想要一些类似的东西`where().le(column_one, column_two)`；

实际上，我想要以下查询：

> SELECT * FROM table_one INNER JOIN table_two ON table_one.column_foreign_id = table_two.id WHERE table_two.column_one <= table_two.column_two。

什么是最好的方法？

感谢您的时间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-06-27T14:41:54.883

是的，你可以做到。代码：

```
QueryBuilder<Account, String> queryBuilder = accountDao.queryBuilder();

queryBuilder.where().le(Account.COLUMN_ONE_NAME,
    new ColumnArg(Account.COLUMN_TWO_NAME));

List<Account> results = queryBuilder.query(); 
```

更多信息[请参见 3.7 使用列参数](http://ormlite.com/javadoc/ormlite-core/doc-files/ormlite_3.html#Column-Arguments)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T17:01:39.103

您是否考虑过使用[rawQuery](http://ormlite.com/javadoc/ormlite-core/doc-files/ormlite_2.html#SEC26)代替？

正如文档所说：

> Dao 接口和 QueryBuilder 类中可用的内置方法不提供处理所有类型查询的能力。

# jquery - 用于绘制 UML 图的免费 JQuery 插件

> ID：14103390
> 
> 赞同：5
> 
> 时间：2012-12-31T15:33:14.587
> 
> 标签：jquery, uml

是否有一个免费（用于商业用途）的 jQuery 库，我可以使用它来集成到我的网站中以便能够绘制 UML 图？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T15:35:56.787

### 你可以试试这些：

1.  jQuery SVG - 您必须创建自己的 UML 或流程图形状： http: [//keith-wood.name/svg.html](http://keith-wood.name/svg.html)
2.  Raphael JS - 使用 JavaScript 库创建基于矢量的图形： [http ://raphaeljs.com/](http://raphaeljs.com/)
3.  JavaScript InfoVis： [http ://thejit.org/demos/](http://thejit.org/demos/)
4.  名为 mxGraph 的商业（付费）工具： [http ://www.jgraph.com/mxgraph.html](http://www.jgraph.com/mxgraph.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-01T12:48:22.120

检查[jsUML2](http://www.jrromero.net/tools/jsUML2) javascript/HTML5 库。这个[基于网络的建模工具](http://modeling-languages.com/web-based-modeling-tools/)列表也可能有一些有用的链接

# ocaml - Ocaml Opam 安装 camlbz2

> ID：14103392
> 
> 赞同：2
> 
> 时间：2012-12-31T15:33:35.467
> 
> 标签：ocaml, opam

安装 camlbz2 时出错

%opam 安装 camlbz2

```
...
...
. checking bzlib.h usability... no
. checking bzlib.h presence... no
. checking for bzlib.h... no 
```

awk：第 1 行：正则表达式编译失败（语法错误 ^* 或 ^+）^+ 配置：错误：未找到 'opam install camlbz2' 失败。我找不到任何可以让 opam 安装“libbz2”之类的东西，有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T08:17:40.020

OPAM 仅（当前）处理 OCaml 源包。

在这里，您的问题来自`./configure`OCaml 包的脚本检测到缺少*系统包*，而不是 OCaml 包（您可以看到它已经搜索了带有`.h`扩展名的文件，即 C 包含文件）。

要解决您的问题，您需要安装此系统包。正如 Ontologiae 所说，缺少的包与`libbz2`库有关，并且包含文件通常在开发包中提供，因此您应该尝试`libbz2-dev`使用操作系统的系统安装程序进行安装。该软件包不在 OCaml 中，因此不存在弄乱 OPAM 安装的风险。

请注意，由于您使用`opam config -env`设置 OCaml 环境，即使您使用系统安装程序安装 OCaml 包，也不应该与 OPAM 安装在您的 homedir 中的包进行不良交互。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-31T17:10:07.603

您需要安装 libbz2 C 库。因此，请检查您的软件包系统并安装它。

在 Debian 中，它是包“libbz2-dev”（所以 sudo apt-get install libbz2-dev）

# java - Android：为什么我会收到 NullPointerExceptions？

> ID：14103397
> 
> 赞同：-1
> 
> 时间：2012-12-31T15:33:59.640
> 
> 标签：java, android

我正在尝试使用 Android TMX Loader 加载游戏地图。我一直遇到/似乎是因为文件未加载的问题。我使用了提供的示例，只是替换了我的文件，但无论我使用什么路径，它都不会加载。我要么得到一个文件未找到异常，要么在加载文件的行上出现一个空指针异常。我已经验证资产正在使用 WinRar 放入 APK，它们确实在那里......

这是我的代码：

```
ImageView mapView;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    loadWorld("World.tmx");

    setContentView(R.layout.activity_main);
}

/*
 * public void displayMap() { Display display =
 * getWindowManager().getDefaultDisplay(); Point size = new Point();
 * display.getSize(size); int width = size.x; int height = size.y;
 * 
 * }
 */

public void loadWorld(String path) {
    // Start the parser, get back TMX data object
    TileMapData t = TMXLoader.readTMX(path, this);

    mapView = (ImageView) findViewById(R.id.MapImage);

    // Create a Bitmap from the tilemap data
    Bitmap mapImage = TMXLoader.createBitmap(t, this, 0, t.layers.size());

    // Set the imageview to show the map, if we have one
    if (mapImage != null) {
        mapView.setImageBitmap(mapImage);
    }
    // Map loading problem, inform the user.
    else {
        Toast errorMessage = Toast.makeText(getApplicationContext(),
                "Map could not be loaded", Toast.LENGTH_LONG);
        errorMessage.show();
    }
} 
```

这是最新的 LogCat 堆栈：

```
12-31 07:44:25.046: E/AndroidRuntime(18074): FATAL EXCEPTION: main
12-31 07:44:25.046: E/AndroidRuntime(18074): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.fionaheiss.shovelshovel/com.fionaheiss.shovelshovel.DisplayMap}: java.lang.NullPointerException
12-31 07:44:25.046: E/AndroidRuntime(18074):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2006)
12-31 07:44:25.046: E/AndroidRuntime(18074):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2031)
12-31 07:44:25.046: E/AndroidRuntime(18074):    at android.app.ActivityThread.access$600(ActivityThread.java:126)
12-31 07:44:25.046: E/AndroidRuntime(18074):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1166)
12-31 07:44:25.046: E/AndroidRuntime(18074):    at android.os.Handler.dispatchMessage(Handler.java:99)
12-31 07:44:25.046: E/AndroidRuntime(18074):    at android.os.Looper.loop(Looper.java:137)
12-31 07:44:25.046: E/AndroidRuntime(18074):    at android.app.ActivityThread.main(ActivityThread.java:4486)
12-31 07:44:25.046: E/AndroidRuntime(18074):    at java.lang.reflect.Method.invokeNative(Native Method)
12-31 07:44:25.046: E/AndroidRuntime(18074):    at java.lang.reflect.Method.invoke(Method.java:511)
12-31 07:44:25.046: E/AndroidRuntime(18074):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
12-31 07:44:25.046: E/AndroidRuntime(18074):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
12-31 07:44:25.046: E/AndroidRuntime(18074):    at dalvik.system.NativeStart.main(Native Method)
12-31 07:44:25.046: E/AndroidRuntime(18074): Caused by: java.lang.NullPointerException
12-31 07:44:25.046: E/AndroidRuntime(18074):    at com.fionaheiss.shovelshovel.DisplayMap.loadWorld(DisplayMap.java:38)
12-31 07:44:25.046: E/AndroidRuntime(18074):    at com.fionaheiss.shovelshovel.DisplayMap.onCreate(DisplayMap.java:20)
12-31 07:44:25.046: E/AndroidRuntime(18074):    at android.app.Activity.performCreate(Activity.java:4635)
12-31 07:44:25.046: E/AndroidRuntime(18074):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
12-31 07:44:25.046: E/AndroidRuntime(18074):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1970)
12-31 07:44:25.046: E/AndroidRuntime(18074):    ... 11 more 
```

出了什么问题？我这辈子都想不通。

非常感谢你帮助我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:37:49.217

这里

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    loadWorld("World.tmx");  //<< here

    setContentView(R.layout.activity_main);
} 
```

`ImageView` `MapImage` 您在将布局添加到当前活动之前尝试查找，因此将代码更改为：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_main);

    loadWorld("file:///android_asset/World.tmx");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:37:46.277

这意味着 t 或 t.layers 为空。

# asp.net - 如何下载会员供应商？

> ID：14103400
> 
> 赞同：0
> 
> 时间：2012-12-31T15:34:32.420
> 
> 标签：asp.net, membership-provider

我有最新版本的 ASP.NET 和 Visual Studio 2012，但我不知道在哪里下载会员提供程序以便为应用程序创建用户系统。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T15:36:44.347

.NET 附带了一些内置的网络成员资格提供程序。包括例如`SqlMembershipProvider`and `WindowsMembershipProvider`。前者是您通常希望在公共网站上使用的内容。

或者您是否在寻找非内置的特定功能？

# sql - Firebird + Delphi - 在 dblabel 中显示连接字段值

> ID：14103401
> 
> 赞同：1
> 
> 时间：2012-12-31T15:34:46.970
> 
> 标签：sql, database, delphi, firebird

我使用 Firebird db，并且我有一个表，它使用 Join 显示其他表中的一些字段。在使用 Delphi 制作的软件 UI 中，我使用 dblookup 更改 ID 并设置外部表值。

一旦用户更改了 dblookup 值，我想在 dblabel 组件中显示其他连接字段。有没有不使用刷新的自动方法？

请指教

SQL：

```
select 
   table1.f_id,
   table1.f2_id,
   table1.f_name,
   table2.alias_name, //<<<<<--- this is the field I want to display
from table1
   left outer join table2 on (table1.f2_id = table2.f2_id) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:33:47.617

您可以为此使用查找字段。您需要先为 table1 创建静态字段。然后添加一个新的查找字段并用适当的值连接它。当联接字段的内容发生更改而必须再次执行联接查询以更新字段值时，将评估查找字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T13:37:15.050

我发现一个好方法是读取查找框中的查找字段，一旦用户选择一个，我也可以读取其他字段

# c++ - 模型中的 Qt 模型？

> ID：14103402
> 
> 赞同：6
> 
> 时间：2012-12-31T15:34:54.540
> 
> 标签：c++, qt, model, qml

我有一个 Qt 模型，它很可能是一个`QAbstractListModel`. 每个“行”代表我存储在`QList`. 我`QML`在`ListView`. 但是，每个对象都有一个属性，它恰好是一个字符串数组。我想将此显示为`ListView`显示该行的委托中的 a 。但我不知道如何将该模型（对于对象的字符串数组属性）公开到`QML`. 我不能通过 data 函数公开它，因为 Models 是`QObjects`，而不能是`QVariants`。我想`QAbstractItemModel`改用，但我仍然不知道如何为我的`ListView`. 万一这很重要，我使用的是`Qt`5.0.0 版本。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-02T08:44:32.000

您可以从主**QAbstractListModel**返回**QVariantList** ，然后可以将其作为模型分配给您在委托中拥有的内部**ListView 。**我添加了一个小例子，它有一个非常简单的单行模型，以内部模型为例。

 ****c++模型类：

```
class TestModel : public QAbstractListModel
{
  public:

  enum EventRoles {
    StringRole = Qt::UserRole + 1
  };

  TestModel()
  {
    m_roles[ StringRole] = "stringList";
    setRoleNames(m_roles);
  }

  int rowCount(const QModelIndex & = QModelIndex()) const
  {
    return 1;
  }

  QVariant data(const QModelIndex &index, int role) const
  {
    if(role == StringRole)
    {
      QVariantList list;
      list.append("string1");
      list.append("string2");
      return list;
    }
  }

  QHash<int, QByteArray> m_roles;
}; 
```

现在您可以将此模型设置为 QML 并像这样使用它：

```
ListView {
  anchors.fill: parent
  model: theModel //this is your main model

  delegate:
    Rectangle {
      height: 100
      width: 100
      color: "red"

      ListView {
        anchors.fill: parent
        model: stringList //the internal QVariantList
        delegate: Rectangle {
          width: 50
          height: 50
          color: "green"
          border.color: "black"
          Text {
            text: modelData //role to get data from internal model
          }
        }
      }
    }
} 
```****

# image - html2canvas 更改 div

> ID：14103409
> 
> 赞同：0
> 
> 时间：2012-12-31T15:35:35.680
> 
> 标签：image, html, save, html2canvas

我对在画布 div 中显示屏幕截图的 html2canvas 有疑问。

实际上图片将显示在

```
<div id="content"> </div> 
```

但我喜欢在我的画布上显示代码

```
<div id="content">
<canvas id="myimage"> HERE I LIKE TO SHOW THE IMAGE</canvas>
</div> 
```

在内联 javascript 中，我可以更改 div 容器 ID，但我不知道如何更改代码以获取 canvas 元素中的图像。

```
<script type="text/javascript">var date=new Date();var message,timeoutTimer,timer;var proxyUrl="http://urlcanvas.appspot.com";function addRow(a,c,d){var b=$("<tr />").appendTo($(a));b.append($("<td />").css("font-weight","bold").text(c)).append($("<td />").text(d))}function throwMessage(b,a){window.clearTimeout(timeoutTimer);timeoutTimer=window.setTimeout(function(){message.fadeOut(function(){message.remove()})},a||2000);$(message).remove();message=$("<div />").html(b).css({margin:0,padding:10,background:"#000",opacity:0.7,position:"fixed",top:10,right:10,fontFamily:"Tahoma",color:"#fff",fontSize:12,borderRadius:12,width:"auto",height:"auto",textAlign:"center",textDecoration:"none"}).hide().fadeIn().appendTo("body")}$(function(){$("#recommended a").click(function(c){c.preventDefault();$("#url").val(this.href);$("button").click()});var a,b;$('input[type="button"]').click(function(){$(a.contentWindow).unbind("load");$(a).contents().find("body").html2canvas({canvasHeight:b.body.scrollHeight,canvasWidth:b.body.scrollWidth,logging:true})});$("#getscreenshot").click(function(d){d.preventDefault();$(this).prop("disabled",true);var c=$("#url").val();$("#contentx").append($("<img />").attr("src","loading.gif").css("margin-top",40));var f=document.createElement("a");f.href=c;$.ajax({data:{xhr2:false,url:f.href},url:proxyUrl,dataType:"jsonp",success:function(e){a=document.createElement("iframe");$(a).css({visibility:"hidden"}).width($(window).width()).height($(window).height());$("#contentx").append(a);b=a.contentWindow.document;b.open();$(a.contentWindow).load(function(){var g=$(a).contents().find("body"),h={onrendered:function(j){$("#contentx").empty().append(j);$("#getscreenshot").prop("disabled",false);$("base").attr("href","")},allowTaint:true,taintTest:false,flashcanvas:"src/flashcanvas.min.js"},i=html2canvas(g,h)});$("base").attr("href",f.protocol+"//"+f.hostname+"/"+f.pathname);e=e.replace("<head>","<head><base href='"+f.protocol+"//"+f.hostname+"/"+f.pathname+"'  />");if($("#disablejs").prop("checked")){e=e.replace(/\<script/gi,"<!--<script");e=e.replace(/\<\/script\>/gi,"<\/script>-->")}b.write(e);b.close()}})})});</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T15:43:00.740

这是一个很好的参考[使用 html2canvas 创建网页截图（无法正确初始化）](https://stackoverflow.com/questions/10457608/create-screenshot-of-webpage-using-html2canvas-unable-to-initialize-properly)希望它会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-28T14:53:30.490

如果我理解得很好，您需要像这样附加画布：

```
html2canvas(document.getElementById("content"), {
  onrendered: function(canvas) {
    document.getElementById("content").appendChild(canvas);
  }
}); 
```

# objective-c - iOS 设备之间共享数据

> ID：14103411
> 
> 赞同：2
> 
> 时间：2012-12-31T15:35:36.707
> 
> 标签：objective-c, ios

我正在开发一个内部 iOS 可可应用程序，其中多个设备需要连接并读取/写入数据连接。它将类似于库存应用程序。

最好使用服务器端 SQLLite 通信器或某种其他类型的服务器端数据存储来完成此操作？或者有没有一种我不知道多个设备可以共享数据的方法。

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:26:22.213

[Parse](https://parse.com/)可能值得一试的第三方服务。

> 借助 Parse，您可以在几分钟内添加可扩展且功能强大的后端，并在创纪录的时间内启动功能齐全的应用程序，而无需担心服务器管理。我们提供推送通知、社交集成、数据存储以及使用 Cloud Code 将丰富的自定义逻辑添加到应用程序后端的能力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:23:54.143

根据复杂性并假设所有设备都可以连接到同一个 icloud 帐户，您可以为此使用 icloud。

[http://www.raywenderlich.com/6015/beginning-icloud-in-ios-5-tutorial-part-1](http://www.raywenderlich.com/6015/beginning-icloud-in-ios-5-tutorial-part-1)

# java - 如何将日期中的数字转换为单词（例如 2012 两千十二）？

> ID：14103412
> 
> 赞同：2
> 
> 时间：2012-12-31T15:35:47.180
> 
> 标签：java, calendar

```
 import java.text.*; //SimpleDateFormat
    import java.util.*; //Date

    class MyClass
    {
        public static void main (String[] args)
        {
            SimpleDateFormat sdt = new SimpleDateFormat ("d-y-M");
            Date today = new Date();

            String msg = sdt.format(today);

            System.out.println(msg);
        }
    } 
```

此代码给出输出：“31-2012-12”.. 但我想要如下：“31 - 2012 - 12”..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T15:42:58.020

添加我的评论作为回答：

您可以将其转换为数字，然后使用这篇文章作为参考：[How to convert number to words in java](https://stackoverflow.com/questions/3911966/how-to-convert-number-to-words-in-java) to convert numbers to words。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:41:43.800

[http://cboard.cprogramming.com/c-programming/44180-converting-numbers-words.html](http://cboard.cprogramming.com/c-programming/44180-converting-numbers-words.html)

这是一个 C 算法，但它应该给你的想法。请，下次在提交问题之前尝试表现出一些努力。

# android - Android 4.1+/ContactContract：查找组到给定的contactId（从查找数字派生）

> ID：14103416
> 
> 赞同：1
> 
> 时间：2012-12-31T15:36:16.150
> 
> 标签：android, contactscontract

以下函数将电话号码作为输入参数（例如 +436641234567 或 +436641234567）并在联系人数据库中执行两次查找：首先，识别属于该号码的用户（这已经有效），然后使用用户的 id获取此联系人分配到的**所有组**（这不起作用）。测试（再次）返回正确的 id，但是，该组为“null”。

```
 public String getNameGroupByNumber(Context context, String number) {
    String name = "?";
    String contactId = "0";
    String group = "0";
    String test = "0";

    // Step 1: LookUp Name to given Number
    ContentResolver contentResolver = context.getContentResolver();

    Uri uri = Uri.withAppendedPath(ContactsContract.PhoneLookup.CONTENT_FILTER_URI, Uri.encode(number));
    String[] contactProjection = new String[] {BaseColumns._ID, ContactsContract.PhoneLookup.DISPLAY_NAME };
    Cursor contactLookup = contentResolver.query(uri, contactProjection, null, null, null);

    try {
        if (contactLookup != null && contactLookup.getCount() > 0) {
            contactLookup.moveToNext();

            name = contactLookup.getString(contactLookup.getColumnIndex(ContactsContract.Data.DISPLAY_NAME));
            contactId = contactLookup.getString(contactLookup.getColumnIndex(BaseColumns._ID));     
        }
    } finally {         
        if (contactLookup != null) {
            contactLookup.close();
        }
    }

    Log.d(TAG, "Name: " +name + " ContactId: " + contactId);    // works as expected

    // Step 2: Lookup group memberships of the contact found in step one
    Uri groupURI = ContactsContract.Data.CONTENT_URI;
    String[] groupProjection = new String[]{ ContactsContract.CommonDataKinds.GroupMembership.GROUP_ROW_ID , ContactsContract.CommonDataKinds.GroupMembership.CONTACT_ID};
    Cursor groupLookup = contentResolver.query(groupURI, groupProjection, ContactsContract.CommonDataKinds.GroupMembership.CONTACT_ID+"="+contactId, null, null);

    try {

        if (groupLookup != null && groupLookup.getCount() > 0) {
            groupLookup.moveToNext();

             test = groupLookup.getString(groupLookup.getColumnIndex(ContactsContract.CommonDataKinds.GroupMembership.CONTACT_ID));
             group = groupLookup.getString(groupLookup.getColumnIndex(ContactsContract.CommonDataKinds.GroupMembership.GROUP_ROW_ID));

             Log.d(TAG, "Group found with Id: " + test + " and GroupId: " + group);   // test is again the contactID from above but group is null

        }
    } finally {         
        if (groupLookup != null) {
            groupLookup.close();
        }
    }

    return name;
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T15:58:02.690

```
Cursor groupLookup = getContentResolver().query(
        ContactsContract.Data.CONTENT_URI,
        new String[]{
                ContactsContract.CommonDataKinds.GroupMembership.GROUP_ROW_ID , 
                ContactsContract.CommonDataKinds.GroupMembership.CONTACT_ID
        },
        ContactsContract.Data.MIMETYPE + "=? AND " + ContactContract.Data.CONTACT_ID + "=?",
        new String[]{
                ContactsContract.CommonDataKinds.GroupMembership.CONTENT_ITEM_TYPE,
                contact_id
        }, null
); 
```

请改用此`groupLookup`光标。

```
Cursor groupCursor = getContentResolver().query(
        ContactsContract.Groups.CONTENT_URI,
        new String[]{
                ContactsContract.Groups._ID,
                ContactsContract.Groups.TITLE
        }, ContactsContract.Groups._ID + "=" + _id, null, null
); 
```

`groupCursor`有助于从 _id 获取组标题。

# java - TwoLineListItem 源代码

> ID：14103417
> 
> 赞同：0
> 
> 时间：2012-12-31T15:36:17.320
> 
> 标签：java, android

由于 TwoLineListItem 自 API 17 起已被弃用，我已采取措施将其替换为自定义 XML 和 ViewHolder。但是，我真的希望我的应用程序看起来与使用 TwoLineListItem 时完全相同（因为它是应用程序的重要组成部分）。因此，我想知道是否有可能找到 Android 正在使用的最新 TwoLineListItem 的 XML 源代码（我发现的所有内容都已过时），还是我必须基本上进行反复试验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T15:47:14.610

我不确定你在寻找什么。这`TwoLineListItem`是一个简单的小部件，它使用一种布局，如果您`layout`在`SDK/platforms/android-x/data/res/layout`. 这是一个`Jelly Bean`：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical">

    <TextView android:id="@android:id/text1"
        android:textSize="16sp"
        android:textStyle="bold"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"/>

    <TextView android:id="@android:id/text2"
        android:textSize="16sp"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"/>

</LinearLayout> 
```

小部件的代码[很容易复制](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/widget/TwoLineListItem.java/)。

# java - Java - 通过套接字发送文件（聊天客户端 -> 服务器 -> 另一个聊天客户端）

> ID：14103418
> 
> 赞同：3
> 
> 时间：2012-12-31T15:36:21.437
> 
> 标签：java, swing, file, send, java-io

所以我正在开发一个聊天程序，现在我想添加一个发送文件选项。我尝试添加它并且它工作但在文件传输完成后，两个套接字都关闭（两个客户端的套接字）。这是聊天客户端的 SSCCE：

```
public class SSCCEChatClient extends JFrame {

    private JPanel contentPane;
    private JTextField inputUsernameField;
    private JTextArea textArea;
    String serversock = "84.252.37.82";
    String username;
    Socket sock;
    BufferedReader reader;
    PrintWriter writer;
    InputStreamReader streamreader;

    public class IncomingReader implements Runnable{

        public void run() {
            String stream;
            String[] data;

            try {
                while ((stream = reader.readLine()) != null) {

                    data = stream.split("`");
                     if(data[2].equals("receiveFile")&&(!data[3].equals(username))){
                        DataInputStream in = new DataInputStream(sock.getInputStream());
                        byte[] bytes = new byte[Integer.parseInt(data[1])];
                        in.read(bytes);
                        FileOutputStream fos = new FileOutputStream(System.getProperty("user.home") + "\\Desktop\\" + data[0]);
                        fos.write(bytes);
                        fos.close();
                        in.close();
                        textArea.append("Success!");
                    }else if(data[2].equals("server")){
                        textArea.append(data[0]);
                    }

                }
           }catch(Exception ex) {
           }
        }
    }//Incoming Reader

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                try {
                    SSCCEChatClient frame = new SSCCEChatClient();
                    frame.setVisible(true);
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
    }

    public SSCCEChatClient() {
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setBounds(100, 100, 450, 300);
        contentPane = new JPanel();
        contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
        contentPane.setLayout(new BorderLayout(0, 0));
        setContentPane(contentPane);

        textArea = new JTextArea();
        contentPane.add(textArea, BorderLayout.SOUTH);

        JButton btnNewButton = new JButton("Send File");
        btnNewButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent arg0) {
                File transferFile = new File (System.getProperty("user.home") + "\\Desktop\\PNG\\Night.png");
                byte [] bytearray  = new byte [(int)transferFile.length()];
                try {
                    BufferedInputStream bin = new BufferedInputStream(new FileInputStream(transferFile));
                    bin.read(bytearray,0,bytearray.length);
                    DataOutputStream os = new DataOutputStream(sock.getOutputStream());
                    writer.println(transferFile.getName() + "`" + transferFile.length() + "`receiveFile`" + username);
                    writer.flush();
                    os.write(bytearray,0,bytearray.length);
                    os.flush();
                    bin.close();
                    os.close();

                } catch (IOException e) {
                    e.printStackTrace();
                }
                System.out.println("File transfer complete");
            }
        });
        contentPane.add(btnNewButton, BorderLayout.CENTER);

        JButton btnNewButton_1 = new JButton("Connect");
        btnNewButton_1.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                try {
                    username = inputUsernameField.getText();
                    sock = new Socket(serversock, 5000);
                    streamreader = new InputStreamReader(sock.getInputStream());
                    reader = new BufferedReader(streamreader);
                    writer = new PrintWriter(sock.getOutputStream());
                    Thread IncomingReader = new Thread(new IncomingReader());
                    IncomingReader.start();
                    writer.println(username + "``connect");
                    writer.flush();

                } catch (Exception ex) {
                    textArea.append("\nCannot Connect!");
                }
            }
        });
        contentPane.add(btnNewButton_1, BorderLayout.WEST);

        inputUsernameField = new JTextField();
        contentPane.add(inputUsernameField, BorderLayout.NORTH);
        inputUsernameField.setColumns(10);
    }

} 
```

这是服务器端：

```
public class SSCCEServer {
    static ArrayList<PrintWriter> clientOutputStreams;
    static ArrayList<DataOutputStream> clientDataOutputStreams;
    static ArrayList<String> onlineUsers = new ArrayList<>();
    public class ClientHandler implements Runnable  {
        BufferedReader reader;
        Socket sock;
        PrintWriter client;

        public ClientHandler(Socket clientSocket, PrintWriter user) {
        // new inputStreamReader and then add it to a BufferedReader
            client = user;
            try {
                sock = clientSocket;
                System.out.println(clientSocket.getRemoteSocketAddress().toString() + " - ");
                InputStreamReader isReader = new InputStreamReader(sock.getInputStream());
                reader = new BufferedReader(isReader);
            }
            catch (Exception ex) {
                System.out.println("error beginning StreamReader");
            }

        }

        public void run() {
            String message;
            String[] data;
            try {
                while ((message = reader.readLine()) != null) {

                    data = message.split("`");

                    if(data[2].equals("receiveFile")){
                        DataInputStream in = new DataInputStream(sock.getInputStream());
                        byte[] bytes = new byte[Integer.parseInt(data[1])];
                        in.read(bytes);
                        tellEveryone(data[0] + "`" + data[1] + "`" + data[2] + "`" + data[3]);
                        for(DataOutputStream dos:clientDataOutputStreams){
                            try {
                                dos.write(bytes);
                                dos.close();
                            }
                            catch (Exception ex) {
                                System.out.println("error telling everyone");
                            }
                        }
                        tellEveryone("File transfer complete``server");
                    }else if(data[2].equals("connect")){
                        System.out.println(data[0] + "has connected.");
                    }else {
                        System.out.println("No Conditions were met.");
                      }
                 }
            }
            catch (Exception ex) {
                System.out.println("lost a connection");
                System.out.println(ex.getMessage().toString());
                clientOutputStreams.remove(client);
            }
        }
    }
    public void tellEveryone(String message) {
    // sends message to everyone connected to server
        for(PrintWriter writer:clientOutputStreams){
                try {
                    writer.println(message);
                    //pop("Sending: " + message);
                    writer.flush();
                }
                catch (Exception ex) {
                    System.out.println("error telling everyone");
                }
        }
       }
    public static void main(String[] args) {
        new SSCCEServer().go();
    }
    public void go(){
        clientOutputStreams = new ArrayList<PrintWriter>();
        clientDataOutputStreams = new ArrayList<>();

        try {
            @SuppressWarnings("resource")
            ServerSocket serverSock = new ServerSocket(5000);
            while(true){
                Socket clientSock = serverSock.accept();
                PrintWriter writer = new PrintWriter(clientSock.getOutputStream());
                clientOutputStreams.add(writer);
                clientDataOutputStreams.add(new DataOutputStream(clientSock.getOutputStream()));
                Thread listener = new Thread(new ClientHandler(clientSock, writer));
                listener.start();
            }
        } 
        catch (Exception ex)
        {
            System.out.println("error making a connection");
        }
    }

} 
```

对不起，如果它真的很长，但这是我可以带它的最小数量。这也不是全部，因为它错过了发送文本方法，但这并不影响 SSCCE。我已经用服务器端的方法“tellEveryone”演示了发送方法。此外，“\PNG\Night.png”只是一个示例，您可以创建自己的文件夹和文件以运行 SSCCE。发送文件后，我该怎么做才能修复套接字的关闭？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T15:48:20.027

1.  关闭所有块`Objects`( )`finally``try - catch - finally`

2.  您[在 Swing 中遇到 Concurency](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)问题，但有三种方法

    a) 适当的方法

    *   将代码包装到`Runnable#Thread`（最简单的），必须将对 Swing GUI 的任何更改包装到`invokeLater()`

    *   使用`SwingWorker`（以标准方式实现），其中方法`publish`，`process`并且`done`非常保证所有`events`都在`EDT`

    b）捷径，有效但不正确的方式

    *   将 Swing GUI 代码`invokeLater()`直接包装到

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:46:50.713

当您关闭输出流时，套接字会关闭。如果要保持套接字打开，请不要关闭流。供参考看看[`SocketOutputStream.java`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/net/SocketOutputStream.java#SocketOutputStream.close%28%29)

# jquery - 将查询字符串从一页传递到另一页

> ID：14103422
> 
> 赞同：-1
> 
> 时间：2012-12-31T15:36:52.760
> 
> 标签：jquery, mysql, ajax

我正在尝试将查询字符串从一个页面传递到另一个页面，AJAX 将在该页面中将其作为 the`url`然后返回。

我用于 AJAX 查询字符串的方法是使用单独的用户界面表单更改隐藏的表单值，然后`.serialize`将隐藏的表单值更改为 AJAX 获取并运行它的查询字符串。

最初的“搜索”页面将在主页上，然后参数将被传递到结果页面，但我不知道如何将它们带到那里。

使用 PHP，它就像一个 POST 表单到必要的页面一样简单。但我不知道如何使用 AJAX 来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:40:27.377

请查看`data`任何 jQuery AJAX 函数的参数，例如。[`jQuery.get()`](http://api.jquery.com/jQuery.get/)

# backbone.js - 为什么每当我从服务器获取我的主集合时，我的过滤集合会被我的主集合填充？

> ID：14103426
> 
> 赞同：0
> 
> 时间：2012-12-31T15:37:24.787
> 
> 标签：backbone.js, marionette

我有一个主要的模型集合，然后我将它们过滤成 3 个单独的集合（思考分类菜单）。我有一个计时器来获取我的主集合以确保它是同步的。我过滤的每个集合都是 Marionette CollectionView 的基础，并在第一次通过时正确呈现。计时器完成我的主集合提取后，每个过滤的集合都会使用主集合的数据进行刷新。

**更新：**我的猜测是，由于我将过滤后的集合包装在一个新的 Backbone.Collection 中，重置应用于共享相同模型的每个集合，因此触发我的集合重置的获取实际上触发了也重置我所有过滤的集合，然后用完整的集合填充它。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:54:29.233

问题是我。:)

我没想到，我正在创建主要集合类型的新实例，即使是为我过滤的集合也是如此。这也在所有过滤的集合上创建了计时器，当然，也是用主集合数据刷新过滤的集合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:35:35.633

在我看来，您通过引用共享某些对象。如果您想包含 3 个基于某些原始共享状态的隔离集合，但不创建与该状态的任何关系，我将复制所有数据并创建新对象。这可以通过[_.extend](http://underscorejs.org/#extend)完成。

我可能完全误解了你的情况。一些上下文/代码会有所帮助。

# java - 两个线程访问同一个 LinkedList

> ID：14103427
> 
> 赞同：2
> 
> 时间：2012-12-31T15:37:35.957
> 
> 标签：java, android, thread-safety

我是 Java 新手，在尝试实现一个简单的游戏时遇到了问题。目前游戏的前提是，使用计时器来添加汽车，并且更频繁地更新汽车的运动。一辆车可以通过触摸来选择，并通过绘制它的路径来引导。更新功能将沿着路径移动汽车。

**现在，游戏因IndexOutOfBoundsException**而崩溃，我几乎可以肯定这是因为偶尔，当重新选择汽车时，当前路径会被擦除，它允许绘制新路径。路径存储为**LinkedList**，并在汽车被触摸时清除。

我想如果通过触摸事件清除路径，而计时器线程正在更新汽车沿路径的移动，这就是发生错误的地方（两个线程访问这个列表时也可能出现类似的其他问题。

我的问题是，在 Java 中，处理这个问题的最佳方法是什么？是否应该使用特定类型的列表而不是 LinkedList，或者在 c++ 中是否存在诸如 Mutex 之类的对象，我可以在使用它的同时保护该列表？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-31T15:41:26.300

在 Java 中，这通常使用[同步来完成](http://docs.oracle.com/javase/tutorial/essential/concurrency/sync.html)

一个小例子可能看起来像这样：

```
LinkedList list = //Get/build your list

public void doStuffToList()
{
    synchronized(list)
    {
        //Do things to the list
    }
}

public void clearList()
{
    synchronized(list)
    {
        list.clear();
    }
} 
```

如果此时列表上当前有另一个线程在运行，则此代码不会执行清除操作。注意这会导致阻塞，所以要小心死锁。

或者，如果您`List`是您自己构建的类，则使数据结构线程本身安全可能是有意义的：

```
public class SynchroLinkedList
{
    //Implementation details

    public synchronized void doThingsToList()
    {
        //Implementation
    }

    public synchronized void clearList()
    {
        //Implementation
    }
} 
```

这两种方法可以有效地以相同的方式工作，但是使用第二种方法，您的线程安全被抽象为数据类型，这很好，因为当您使用列表时，您不必担心所有地方的线程安全。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T08:03:51.677

您有几个内置选项，而不是重新创建自己的线程安全列表实现，本质上是：

*   使用[同步列表](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#synchronizedList%28java.util.List%29)：

    ```
    List list = Collections.synchronizedList(new LinkedList()); 
    ```

    请注意，您需要在列表（`synchronized(list) { }`）上同步迭代和其他需要原子的组合操作）

*   使用线程安全的集合，例如[CopyOnWriteArrayList](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/CopyOnWriteArrayList.html)或[ConcurrenLinkedQueue](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentLinkedQueue.html)，如果您不需要访问列表中间的项目，而只需要添加一个迭代，这可能是一个不错的选择。

    请注意，根据您的用例，CopyOnWriteArrayList 可能会降低性能，特别是如果您定期添加项目（即每隔几微秒）并且列表可能会变大。

# jquery - 我有 2 个版本的 jQuery，为什么 noConflict() 不允许我使用正确的版本？

> ID：14103432
> 
> 赞同：3
> 
> 时间：2012-12-31T15:37:49.963
> 
> 标签：jquery

我有一个加载这个脚本的 boolmarklet，它加载 jQuery。我尽量避免与网站上任何已加载的 jQuery 发生冲突。

当我这样做时：

```
/* Loading jquery and making sure we don't enter in conflict with
another js lib or another jquery */
var oldJquery;

if (typeof jQuery !== "undefined") { 
    log('jQuery is present. Setting noConflict() on', jQuery().jquery)
    oldJquery = jQuery.noConflict(true); 
} else {
    oldJquery= false;
}

log('Starting to load jQuery')
var head = document.getElementsByTagName('head')[0];
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = 'http://code.jquery.com/jquery-1.8.3.min.js?' + (new Date().getTime());
script.onreadystatechange = function() {
    setTimeout(function(){
    log('jQuery is loaded. Starting BM with', $().jquery)
    bookmarklet(jQuery.noConflict(true))
    if (oldJquery){
        log('Restore old jQuery reference')
        jQuery = oldJquery;
        $ = jQuery;
    }
    }, 4000)

};
script.onload = script.onreadystatechange
head.appendChild(script); 
```

我最终得到这个输出：

```
############# RESTART #############

jQuery is present. Setting noConflict() on1.4.4
Starting to load jQuery
jQuery is loaded. Starting BM with 1.4.4
Scratchpad (ligne 312)
BM is started with jquery version 1.4.4
Scratchpad (ligne 27)
Display alert: Please wait...
Load view jQuery viewport plugin and wait for DOM ready
Restore old jQuery reference 
```

为什么在“BM is started with jquery version”中没有 I 1.8.2 作为 jquery 版本？

我尝试了各种组合都`($|jQuery).noConflict([true])`没有成功。清空缓存似乎还不够，而且我也不可能要求最终用户这样做。

# portlet - 在 WebSphere Portal 上清除渲染参数

> ID：14103433
> 
> 赞同：0
> 
> 时间：2012-12-31T15:38:00.137
> 
> 标签：portlet, websphere-portal, jsr286

我需要 WebSphere Portal 来清除页面更改时的渲染参数。现在发生的事情 - 这是产品的导航状态功能 - 我在某些 URL 中使用的渲染参数正在 URL 中进行编码，因此即使在我离开页面后，当我返回我的渲染参数时仍然存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T20:42:35.203

如果允许您创建友好的 url 或修改主题导航以使用 keepNavigationalState 属性，您可以尝试以下链接中的一些选项。

[http://www-01.ibm.com/support/docview.wss?uid=swg21586973](http://www-01.ibm.com/support/docview.wss?uid=swg21586973)

编辑：我查找了我认为我从 RenderRequest 中删除了参数的 portlet 代码。我实际上是使用 PortletSession 将属性从 processAction 方法移动到 doView。然后我从会话中删除了属性，因此它不会在页面刷新时使用。这是一种 hack，您需要打开公共会话以支持匿名用户 ( [http://publib.boulder.ibm.com/infocenter/wpdoc/v6r0/index.jsp?topic=/com.ibm.wp。 exp.doc/wps/srvcfgref.html](http://publib.boulder.ibm.com/infocenter/wpdoc/v6r0/index.jsp?topic=/com.ibm.wp.exp.doc/wps/srvcfgref.html) - 转到导航服务）但这是另一个需要考虑的选项。

# c# - #region 描述编译成 .net 中的 .exe？

> ID：14103434
> 
> 赞同：6
> 
> 时间：2012-12-31T15:38:02.587
> 
> 标签：c#, .net, visible, region, compiled

#region/#endregion 指令“描述”是否编译到 .NET 中的 .EXE 中？我知道注释不是，但我经常在一个区域内分块代码组并给它一个有用的描述。

我想确保这些描述在我的编译代码中不可见。（我不是在寻找混淆信息。不过，谢谢。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-31T15:39:55.163

不，他们不是。它们是预处理器表达式，不会出现在代码中。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-31T15:39:58.190

不，他们不是。区域描述基本上是注释，不包含在程序集本身或 PDB 中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-31T15:43:38.120

Region 是 C# 预处理器指令之一。

尽管编译器没有单独的预处理器，但此链接中描述的指令

[http://msdn.microsoft.com/en-us/library/ed8yd1ha(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/ed8yd1ha(v=vs.110).aspx)

像有一个一样被处理。

但我想知道，这个问题的目的是什么？:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-31T15:42:16.503

不，他们不是。它们就像评论一样。查看[预处理指令](http://msdn.microsoft.com/en-us/library/aa691094%28v=vs.71%29.aspx)

> 预处理指令提供有条件地跳过源文件部分、报告错误和警告条件以及描绘源代码的不同区域的能力。术语“预处理指令”仅用于与 C 和 C++ 编程语言保持一致。在 C# 中，没有单独的预处理步骤；预处理指令作为**词法分析阶段**的一部分进行处理。 **预处理指令不是标记，也不是 C# 句法语法的一部分**。但是，预处理指令可用于包含或排除标记序列，并且可以通过这种方式影响 C# 程序的含义。

# seo - 如何避免重复的站点地图内容？

> ID：14103435
> 
> 赞同：0
> 
> 时间：2012-12-31T15:38:07.790
> 
> 标签：seo, sitemap, google-search

我有一个 php 动态壁纸网站[http://www.fondolandia.com](http://www.fondolandia.com)，它已经上线一年了，最近我已经将页面提交到一个站点地图构建器站点，并且在站点地图文件中我发现一些链接指向不同分辨率的相同图像，例如

```
<url>
<loc>http://www.fondolandia.com/portal/display/51_palacio-europa1356656199/1600x1200</loc>
<changefreq>daily</changefreq>
<priority>0.64</priority>
</url>
<url>
<loc>http://www.fondolandia.com/portal/display/51_palacio-europa1356656199/1280x960</loc>
<changefreq>daily</changefreq>
<priority>0.64</priority>
</url>
<url>
<loc>http://www.fondolandia.com/portal/display/51_palacio-europa1356656199/1024x768</loc>
<changefreq>daily</changefreq>
<priority>0.64</priority>
</url>
<url>
<loc>http://www.fondolandia.com/portal/display/51_palacio-europa1356656199/800x600</loc>
<changefreq>daily</changefreq>
<priority>0.64</priority>
</url> 
```

实际上 4 个链接指向同一图像但分辨率不同，我应该从站点地图中删除这些链接，因为另一个链接指向同一图像的概述。

```
<url>
<loc>http://www.fondolandia.com/portal/fondo/51_palacio-europa1356656199</loc>
<changefreq>daily</changefreq>
<priority>0.80</priority>
</url> 
```

在做一个 site:url 时，我看到许多指向已从网站中删除并出现在搜索结果中的旧图片的链接，谷歌应该在它抓取我的网站后解决这个问题还是我应该做些什么？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T15:43:59.147

要回答您的第一个问题，站点地图中的重复链接是可以的，但每个页面都应该有一个[规范链接](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=139394)，以告诉 google 它们实际上是同一件事。

至于搜索结果中已删除的页面，只要您的网站返回适当的状态代码（例如 404 或 301 重定向到其他页面），谷歌在重新抓取页面时也应该解决这个问题

# javascript - 在 Javascript 函数参数中使用键的值作为键值对中的键

> ID：14103438
> 
> 赞同：0
> 
> 时间：2012-12-31T15:38:37.487
> 
> 标签：javascript, function-parameter, keyvaluepair

> **可能重复：**
> [在 Javascript 中使用键值作为键值对中的键](https://stackoverflow.com/questions/14103212/use-keys-value-as-key-in-key-value-pair-in-javascript)

作为在 Javascript函数参数[中使用键的值作为键值对中的键的](https://stackoverflow.com/questions/14103212/use-keys-value-as-key-in-key-value-pair-in-javascript/)后续操作。如何将键值对的值用作 Javascript 函数参数中不同键值对中的键？

我想做以下事情：

```
var params = {param1: "paramname1"};
somefunction({params.param1:"param1value"}); 
```

所以事情基本上等于：

```
somefunction({"paramname1":"param1value"}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T15:40:55.270

要将表达式用作属性名称，您需要使用`[]`语法而不是对象文字：

```
var params = {
    param1: "paramname1"
};
var data = {};
data[params.param1] = "param1value";
somefunction(); 
```

# java - 修改包含元数据的 Excel 工作表 - 如何避免不必要的警告？

> ID：14103443
> 
> 赞同：2
> 
> 时间：2012-12-31T15:39:19.110
> 
> 标签：java, excel, jxl

我得到了一个必须填写的 Excel 工作表，所以我使用 JExcel 来为我填写。但是，当我使用 JExcel 仅填充一个单元格时，它可以工作，但我会收到一大堆不必要的警告，这些警告会滞后于所有内容（我假设这是因为 excel 文件中包含所有元数据）。有谁知道如何在不删除元数据的情况下避免这些警告？（我需要保留元数据，因为我假设它对于解析另一端填充的 Excel 工作表很重要）

非常感谢您的帮助！

```
public static void main(String args[]){
    Workbook workbook;
    try{
        workbook = Workbook.getWorkbook(new File("Test.xls"));
        WritableWorkbook copy = Workbook.createWorkbook(new File("output.xls"), workbook);
        WritableSheet sheet1 = copy.getSheet(0); 
        Label label = new Label(4,5, "PO1234355");
        sheet1.addCell(label);

        copy.write(); 
        copy.close();

    }
    catch(Exception e){
        System.out.println("Could not get workbook. Error: " + e.toString());
    }
} 
```

这些是我得到的疯狂警告：

```
Warning:  Cannot read name ranges for BUY - setting to empty
Warning:  Cannot read name ranges for Buyer - setting to empty
Warning:  Cannot read name ranges for Casual_Buyer - setting to empty
Warning:  Cannot read name ranges for Departments - setting to empty
Warning:  Cannot read name ranges for Dept_No - setting to empty
Warning:  Cannot read name ranges for Designer - setting to empty
Warning:  Cannot read name ranges for Model - setting to empty
Warning:  Cannot read name ranges for Seasons - setting to empty
Warning:  Cannot read name ranges for Supplier - setting to empty
Warning:  Cannot read name ranges for Technologist - setting to empty
Warning:  Cannot read name ranges for Typed_by - setting to empty
Warning:  Cannot read name ranges for YESNO - setting to empty
Warning:  no filename property for drawing
Warning:  no filename property for drawing
Warning:  no filename property for drawing
Warning:  no filename property for drawing
Warning:  no filename property for drawing
Warning:  no filename property for drawing
Warning:  no filename property for drawing
Warning:  no filename property for drawing
Warning:  no filename property for drawing 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:45:19.737

您可以考虑使用此代码将一个工作簿中的工作表复制到另一个工作簿中的新工作表以避免此类警告。还要检查如何`WorkBookSettings`在 jxl 中使用，这可能会帮助您避免这些警告。

```
for (int i = 0 ; i < numrows ; i++)
  {
    for (int j = 0 ; j < numcols ; j++)
    {
      readCell = sheet.getCell(i, j);
      newCell = readCell.copyTo(i, j);
      readFormat = readCell.getCellFormat();
      newFormat = new WritableCellFormat(readFormat);
      newCell.setCellFormat(newFormat);
      newSheet.add(newCell);
    }
  } 
```

[这](http://www.docjar.org/html/api/jxl/read/biff/NameRecord.java.html)是该警告的源代码

```
String n = name != null ? name : builtInName.getName();
logger.warn("Cannot read name ranges for " + n + 
                  " - setting to empty");
NameRange range = new NameRange(0,0,0,0,0);
ranges.add(range); 
```

希望您能够分析警告的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-05T21:58:34.893

我也有同样的警告。我删除了 Excel 中的所有命名范围（公式 > 名称管理器）。之后所有的警告都消失了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-27T14:52:39.987

我的文件没有命名范围，我仍然有那个警告。所以我尝试使用带有 WorkbookSettings 的构造函数来获取我的工作簿。它帮助了我。

```
WorkbookSettings ws = new WorkbookSettings();
ws.setSuppressWarnings(true);
Workbook workbook = Workbook.getWorkbook(new File("Stock labels.xls"), ws); 
```

# php - Python 版本上下文中的 ProtocolConnectionException

> ID：14103444
> 
> 赞同：0
> 
> 时间：2012-12-31T15:39:29.763
> 
> 标签：php, python, sockets, networking, sublimetext2

我对 Python 完全不熟悉，但我有一段代码需要修复。它来自 Sublime Text 2 的[SublimeXdebug](https://github.com/Kindari/SublimeXdebug)插件，它是唯一一个使用 Sublime Text 进行 PHP 调试的插件。该插件是用 Python 编写的，更具体地说，是用 Python 2.6 或更早版本编写的，而运行该插件的系统（Ubuntu 12.04）仅支持 Python >= 2.7。但是，插件/Sublime Text 开发人员似乎设法“模拟”了 Python 2.6，因为当我插入`print sys.version`插件的代码时，它会报告`Python 2.6.6`. 它本可以帮助其他一些插件，但不能帮助 SublimeXdebug：

```
Traceback (most recent call last):
  File ".\threading.py", line 532, in __bootstrap_inner
  File ".\threading.py", line 484, in run
  File "./Xdebug.py", line 321, in thread_callback
    protocol.accept()
  File "./Xdebug.py", line 137, in accept
    raise(ProtocolConnectionException, x)
ProtocolConnectionException 
```

有问题的代码（可能不是唯一的）是这样的：

```
def accept(self):
    serv = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    if serv:
        try:
            serv.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
            serv.settimeout(1)
            serv.bind(('', self.port))
            serv.listen(1)
            self.listening = True
            self.sock = None
        except Exception, x:
            raise(ProtocolConnectionException, x) # line 137 <------------

        while self.listening:
            try:
                self.sock, address = serv.accept()
                self.listening = False
            except socket.timeout:
                pass

        if self.sock:
            self.connected = True
            self.sock.settimeout(None)
        else:
            self.connected = False
            self.listening = False

        try:
            serv.close()
            serv = None
        except:
            pass
        return self.sock
    else:
        raise ProtocolConnectionException('Could not create socket') 
```

（对于那些建议在 .deb 中下载 2.6 版本的 Python，将其解包，然后移至 .deb 的人`usr/lib/python2.6`，`{sublime text folder}/lib`我已经尝试过了，但没有帮助。）

那么问题的根源可能在于 Python 版本不匹配或其他原因吗？

*编辑：*

如果我将第 137 行更改为`raise`它说：

```
Traceback (most recent call last):
  File ".\threading.py", line 532, in __bootstrap_inner
  File ".\threading.py", line 484, in run
  File "./Xdebug.py", line 321, in thread_callback
  File "./Xdebug.py", line 132, in accept
  File "<string>", line 1, in bind
error: [Errno 98] Address already in use 
```

第 132 行是`serv.bind(('', self.port))`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:19:47.687

我怀疑这个 Python 版本的东西是红鲱鱼。发生的事情是这段代码试图在 TCP 端口上监听（不管`self.port`是什么），但其他东西已经在那里监听了。在 Linux 上，您可以运行`sudo netstat -anp | grep LISTEN`以找出它是什么进程。

# ios - OpenGL ES 2.0 照明在 iOS 应用程序中不起作用

> ID：14103464
> 
> 赞同：1
> 
> 时间：2012-12-31T15:41:26.003
> 
> 标签：ios, opengl-es-2.0

我目前正在学习 OpenGL 2.0 并正在创建一个基本的 iPhone 应用程序。我在搅拌机中创建了一个模型并将其导出到一个 .obj 文件并编写了一个解析器来提取坐标。形状显示正常但没有颜色（黑色）。这意味着法线有问题。但是我检查了法线，发现它们有什么问题。我的代码中是否缺少某些内容？

对于这方面的任何帮助，我将不胜感激！

截屏

![在此处输入图像描述](../Images/78167e330a7a40fe552eff3d29489a23.png)

这是我的 OpenGL 代码

```
glEnable(GL_DEPTH_TEST);
glEnableClientState(GL_TEXTURE_COORD_ARRAY);

glGenVertexArraysOES(1, &_vertexArray);
glBindVertexArrayOES(_vertexArray);

glGenBuffers(1, &_vertexBuffer);
glBindBuffer(GL_ARRAY_BUFFER, _vertexBuffer);
glBufferData(GL_ARRAY_BUFFER, loader.currentCountOfVerticies * sizeof(GLfloat) * 3, arrayOfVerticies, GL_STATIC_DRAW);

glEnableVertexAttribArray(GLKVertexAttribPosition);
glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 12, BUFFER_OFFSET(0));

glGenVertexArraysOES(1, &_normalArray);
glBindVertexArrayOES(_normalArray);

glGenBuffers(1, &_normalBuffer);
glBindBuffer(GL_ARRAY_BUFFER, _normalBuffer);
glBufferData(GLKVertexAttribNormal, loader.currentCountOfNormals  * sizeof(GLfloat) * 3,loader.arrayOfNormals , GL_STATIC_DRAW);

glEnableVertexAttribArray(GLKVertexAttribNormal);
glVertexAttribPointer(GLKVertexAttribNormal, 3, GL_FLOAT, GL_FALSE, 12, BUFFER_OFFSET(0));

glGenVertexArraysOES(1, &_textureArray);
glBindVertexArrayOES(_textureArray);

glGenBuffers(1, &_textureBuffer);
glBindBuffer(GL_ARRAY_BUFFER, _textureBuffer);
glBufferData(GL_ARRAY_BUFFER, loader.currentCountOfTextureCoordinates * sizeof(GLfloat) * 2, loader.arrayOftextureCoOrdinates, GL_STATIC_DRAW);

glEnableVertexAttribArray(GLKVertexAttribTexCoord0);
glVertexAttribPointer(GLKVertexAttribTexCoord0, 2, GL_FLOAT, GL_FALSE, 8, BUFFER_OFFSET(0));

glBindVertexArrayOES(0); 
```

和我的`DrawRect`方法

```
- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect
{
    glClearColor(0.65f, 0.65f, 0.65f, 1.0f);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glBindVertexArrayOES(_vertexArray); 

    glUseProgram(_program);

    glUniformMatrix4fv(uniforms[UNIFORM_MODELVIEWPROJECTION_MATRIX], 1, 0, _modelViewProjectionMatrix.m);
    glUniformMatrix3fv(uniforms[UNIFORM_NORMAL_MATRIX], 1, 0, _normalMatrix.m);

    #ifdef DEBUG_VERTEX_DATA_LOOP
    NSLog(@"size of c array * type %ld", loader.currentCountOfVerticies *sizeof(GLfloat));
    #endif

    //Takes in the ammout of indicies not triangels!
    glDrawArrays(GL_TRIANGLES, 0, loader.currentCountOfVerticies);
} 
```

来自加载着色器方法的代码

```
glBindAttribLocation(_program, GLKVertexAttribPosition, "position");  
glBindAttribLocation(_program, GLKVertexAttribNormal, "normal");
glBindAttribLocation(_program, GLKVertexAttribTexCoord0, "TextCo"); 
```

顶点着色器

```
//  Created by Jake Cunningham on 13/10/2012.
//  Copyright (c) 2012 Jake Cunningham. All rights reserved.
//

attribute vec4 position;
attribute vec3 normal;

varying lowp vec4 colorVarying;

uniform mat4 modelViewProjectionMatrix;
uniform mat3 normalMatrix;

attribute vec2 TextCo;
varying vec2 textCoOut;

void main()
{
    vec3 eyeNormal = normalize(normalMatrix * normal);
    vec3 lightPosition = vec3(0.0, 0.0, 1.0);
    vec4 diffuseColor = vec4(0.4, 0.4, 1.0, 1.0);

    float nDotVP = max(0.0, dot(eyeNormal, normalize(lightPosition)));

    colorVarying = diffuseColor * nDotVP;

    gl_Position = modelViewProjectionMatrix * position;
    textCoOut = TextCo;
} 
```

片段着色器

```
//
//  Created by Jake Cunningham on 13/10/2012.
//  Copyright (c) 2012 Jake Cunningham. All rights reserved.
//

varying lowp vec4 colorVarying;

varying lowp vec2 textCoOut;
uniform sampler2D texture;

void main()
{
    gl_FragColor = colorVarying * texture2D(texture, textCoOut);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T20:18:37.300

我建议首先测试与纹理分开的照明。片段着色器中的乘法意味着如果你的纹素是黑色的——如果你没有加载纹理或有其他纹理问题，很可能是这样——你将看不到照明代码的输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T12:30:53.203

我已经解决了这个问题，但我必须承认我仍然不确定问题是什么。我将我的代码从上面更改为

```
glEnable(GL_DEPTH_TEST);

glGenVertexArraysOES(1, &_vertexArray);
glBindVertexArrayOES(_vertexArray);

glGenBuffers(1, &_vertexBuffer);
glBindBuffer(GL_ARRAY_BUFFER, _vertexBuffer);
glBufferData(GL_ARRAY_BUFFER, total * sizeof(GLfloat), mergedArray, GL_STATIC_DRAW);

glEnableVertexAttribArray(GLKVertexAttribPosition);
glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 24, BUFFER_OFFSET(0));
glEnableVertexAttribArray(GLKVertexAttribNormal);
glVertexAttribPointer(GLKVertexAttribNormal, 3, GL_FLOAT, GL_FALSE, 24, BUFFER_OFFSET(12));

glBindVertexArrayOES(0); 
```

将顶点和法线数组合并到一个缓冲区中解决了这个问题。我现在有照明。为什么我无法使用 2 个缓冲区，我不知道如果有人能发现我看不到的东西，我将不胜感激任何反馈。

非常感谢所有 GC

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T13:15:34.233

问题是您使用了多个顶点数组对象。顶点数组对象 (VAO) 是一个轻量级对象（意味着它不包含任何实际的顶点属性数据），它封装了使用单个绘制调用渲染一组顶点数组所需的所有状态，特别是：

*   `glVertexAttribPointer`为每个属性索引所做的设置
*   启用的属性数组
*   绑定元素数组缓冲区

因此，它比单个顶点属性数组高一级，包括单个（概念）场景对象的所有顶点属性数组设置，或者更准确地说，单个绘制调用。

但是在您的代码中，您为每个单独的属性创建一个新的顶点数组对象。然后渲染时，您只绑定`_vertexArray`，而后者只设置和启用`GLKVertexAttribPosition`属性，因此没有法线、texCoords 或其他任何东西。

因此，您应该将原始代码替换为：

```
glGenVertexArraysOES(1, &_vertexArray);
glBindVertexArrayOES(_vertexArray);

glGenBuffers(1, &_vertexBuffer);
glBindBuffer(GL_ARRAY_BUFFER, _vertexBuffer);
glBufferData(GL_ARRAY_BUFFER, loader.currentCountOfVerticies * sizeof(GLfloat) * 3, arrayOfVerticies, GL_STATIC_DRAW);

glEnableVertexAttribArray(GLKVertexAttribPosition);
glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 12, BUFFER_OFFSET(0));

//forget this
//glGenVertexArraysOES(1, &_normalArray);
//glBindVertexArrayOES(_normalArray);

glGenBuffers(1, &_normalBuffer);
glBindBuffer(GL_ARRAY_BUFFER, _normalBuffer);
glBufferData(GLKVertexAttribNormal, loader.currentCountOfNormals  * sizeof(GLfloat) * 3,loader.arrayOfNormals , GL_STATIC_DRAW);

glEnableVertexAttribArray(GLKVertexAttribNormal);
glVertexAttribPointer(GLKVertexAttribNormal, 3, GL_FLOAT, GL_FALSE, 12, BUFFER_OFFSET(0));

//and this, too
//glGenVertexArraysOES(1, &_textureArray);
//glBindVertexArrayOES(_textureArray);

glGenBuffers(1, &_textureBuffer);
glBindBuffer(GL_ARRAY_BUFFER, _textureBuffer);
glBufferData(GL_ARRAY_BUFFER, loader.currentCountOfTextureCoordinates * sizeof(GLfloat) * 2, loader.arrayOftextureCoOrdinates, GL_STATIC_DRAW);

glEnableVertexAttribArray(GLKVertexAttribTexCoord0);
glVertexAttribPointer(GLKVertexAttribTexCoord0, 2, GL_FLOAT, GL_FALSE, 8, BUFFER_OFFSET(0));

glBindVertexArrayOES(0); 
```

# regex - 为什么 $([System.Text.RegularExpressions.Regex]::IsMatch()) 在 ItemGroupDefinition 中被评估一次？

> ID：14103467
> 
> 赞同：2
> 
> 时间：2012-12-31T15:41:47.053
> 
> 标签：regex, msbuild, msbuild-4.0, msbuild-propertygroup

如此摆弄 MSBuild 任务，我发现 Regex 元数据属性被评估一次，而不是每个项目。

例如

```
<!-- 
  actual items, we use standard project reference items and extend via 
  ItemDefinitionGroup. add project references through IDE to extend 
  coverage
-->
<ItemGroup>
  <ProjectReference Include="..\Example.UnitTests-x86\Example.UnitTests-x86.csproj">
    <Project>{7e854803-007c-4800-80f9-be908655229d}</Project>
    <Name>Example.UnitTests-x86</Name>
  </ProjectReference>
  <ProjectReference Include="..\Example.UnitTests\Example.UnitTests.csproj">
    <Project>{eaac5f22-bfb8-4df7-a711-126907831a0f}</Project>
    <Name>Example.UnitTests</Name>
  </ProjectReference>
</ItemGroup>

<!-- additional item properties, defined with respect to item declaring it -->
<ItemDefinitionGroup>
  <ProjectReference>
    <Isx86>
      $([System.Text.RegularExpressions.Regex]::IsMatch(%(Filename), '.*x86*'))
    </Isx86>
  </ProjectReference>
</ItemDefinitionGroup>

<!-- additional task target, invoke both x64 and x86 tasks here -->
<Target Name="AdditionalTasks">
  <Message 
    Text="%(ProjectReference.Filename) Isx86 '%(Isx86)' Inline 
    '$([System.Text.RegularExpressions.Regex]::IsMatch(%(Filename), '.*x86*'))'" 
    Importance="high" />
</Target> 
```

产生这个输出

```
Example.UnitTests-x86 Isx86 'False' Inline 'True'
Example.UnitTests Isx86 'False' Inline 'False' 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-19T20:52:23.327

# 问题

文档[ItemDefinitionGroup Element (MSBuild)](https://docs.microsoft.com/visualstudio/msbuild/itemdefinitiongroup-element-msbuild?view=vs-2019)指的是[Item Definitions](https://docs.microsoft.com/visualstudio/msbuild/item-definitions?view=vs-2019)，其中有一条说明：

> ItemGroup 中的项元数据在 ItemDefinitionGroup 元数据声明中没有用，因为 ItemDefinitionGroup 元素在 ItemGroup 元素之前处理。

这意味着您的`%(Filename)`元数据引用`<ItemDefinitionGroup/>`无法扩展。您可以通过以下代码片段自己查看。在代码段中，`.ToString()`调用将结果转换为字符串对象，从而阻止 MSBuild 进一步扩展它。（如果我遗漏`.ToString()`了，MSBuild 会留下一个`System.RegularExpressions.Match`对象。将元数据定义保留为`Match`对象似乎会延迟扩展为字符串，直到评估`<Message/>`'s `Text`，导致 MSBuild 对其进行字符串扩展传递，从而`%(Identity)`导致在您可能没有预料到的时候展开。下面的代码片段也演示了这种延迟的展开。）

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <MyItem Include="MyItem’s value" />
    <MyItem Include="MyItem’s second value" />
  </ItemGroup>
  <ItemDefinitionGroup>
    <MyItem>
      <ItemDefinitionMatchedText>$([System.Text.RegularExpressions.Regex]::Match(%(Identity), ".*").get_Groups().get_Item(0).ToString())</ItemDefinitionMatchedText>
      <ItemDefinitionMatchedTextDelayed>$([System.Text.RegularExpressions.Regex]::Match(%(Identity), ".*").get_Groups().get_Item(0))</ItemDefinitionMatchedTextDelayed>
    </MyItem>
  </ItemDefinitionGroup>
  <Target Name="Build" Outputs="%(MyItem.Identity)">
    <Message Text="Data being matched against for item “%(MyItem.Identity)” is “%(ItemDefinitionMatchedText)”"/>
    <Message Text="Delayed string conversion causes delayed expansion: “%(MyItem.ItemDefinitionMatchedTextDelayed)”"/>
  </Target>
</Project> 
```

输出：

```
Build:
  Data being matched against for item “MyItem’s value” is “%(Identity)”
  Delayed string conversion causes delayed expansion: “MyItem’s value”
Build:
  Data being matched against for item “MyItem’s second value” is “%(Identity)”
  Delayed string conversion causes delayed expansion: “MyItem’s second value” 
```

MSBuild 文档中的注释表明 Item 元数据在`<ItemDefinitionGroup/>`. 从 using 看来，`Regex.Match()`属性[函数扩展](https://docs.microsoft.com/visualstudio/msbuild/property-functions?view=vs-2019)正在处理`%(Identity)`，或者在您的情况下，`%(Filename)`将其视为未引用的自由格式字符串。因此，由于您`Regex.IsMatch()`使用与我在上面示例中调用的相同语法进行调用`Regex.Match()`，因此您`Regex.IsMatch()`正在尝试检查文字字符串是否`%(Filename)`包含`x8`（可选地后跟任意数量的 6，其存在或不存在都不会影响匹配）。

# 解决方案

我所知道的根据现有元数据动态计算项目元数据的唯一方法是创建一个从原始项目派生的新项目。例如，要`<ProjectReference/>`使用您需要的元数据创建一个 s 列表，您可以使用以下项目定义来生成`ProjectReferenceWithArch`项目。我选择在使用后使用[属性函数语法](https://docs.microsoft.com/visualstudio/msbuild/property-functions?view=vs-2019#string-property-functions)[`[MSBuild]::ValueOrDefault()`](https://docs.microsoft.com/visualstudio/msbuild/property-functions?view=vs-2019#msbuild-valueordefault)将其转换为属性扩展上下文中的字符串，以便我可以使用`String.Contains()`（对于您的情况，Regex 有点矫枉过正，但如果需要，您可以轻松修改它以匹配正则表达式）。我更新了您`<Message/>`以打印出`Project`元数据，以证明此元数据在新项目的定义中仍然存在。

```
<ItemGroup>
  <ProjectReferenceWithArch Include="@(ProjectReference)">
    <Isx86>$([MSBuild]::ValueOrDefault('%(Filename)', '').Contains('x86'))</Isx86>
  </ProjectReferenceWithArch>
</ItemGroup>
<Target Name="AdditionalTasks">
  <Message 
    Text="%(ProjectReferenceWithArch.Filename) Isx86 '%(Isx86)' Inline '$([System.Text.RegularExpressions.Regex]::IsMatch(%(Filename), '.*x86*'))' Project '%(Project)'" 
    Importance="high" />
</Target> 
```

输出：

```
AdditionalTasks:
  Example.UnitTests-x86 Isx86 'True' Inline 'True' Project '{7e854803-007c-4800-80f9-be908655229d}'
  Example.UnitTests Isx86 'False' Inline 'False' Project '{eaac5f22-bfb8-4df7-a711-126907831a0f}' 
```

# 替代解决方案（编辑）

我刚刚注意到[，如果您在`<Target/>`](https://stackoverflow.com/a/857195/429091). 语法如下所示：

```
<Target Name="AdditionalTasks">
  <ItemGroup>
    <ProjectReference>
      <Isx86>$([MSBuild]::ValueOrDefault('%(Filename)', '').Contains('x86'))</Isx86>
    </ProjectReference>
  </ItemGroup>
</Target> 
```

只需确保此目标在您需要检查`Isx86`元数据的目标之前运行，或者`<ItemGroup/>`在您的`<Target/>`.

# php - 只选择一个节点并继续 php

> ID：14103468
> 
> 赞同：0
> 
> 时间：2012-12-31T15:41:46.747
> 
> 标签：php, xml, foreach, simplexml

我有一个来自 Echonest API 和 Spotify URI 的歌曲列表，但它添加了我需要的更多歌曲。我只需要其中一个而不是全部，但我想继续这样做 20 次。所以我只想得到节点内的第一条轨道，然后继续下一条。

[这是我从中获取信息的 xml 文件](http://developer.echonest.com/api/v4/playlist/static?api_key=FILDTEOIK2HBORODV&artist=Rihanna&format=xml&results=20&type=artist&bucket=id%3aspotify-WW&bucket=tracks&limit=true)

这是我使用的 PHP：

```
<iframe src="https://embed.spotify.com/?uri=spotify:trackset:Playlist based on Rihanna:<?php 
$completeurl = "http://developer.echonest.com/api/v4/playlist/static?api_key=FILDTEOIK2HBORODV&artist=Rihanna&format=xml&results=20&type=artist-radio&bucket=tracks&bucket=id:spotify-WW"; 
$xml = simplexml_load_file($completeurl); 
$i = 1;
foreach ($xml->xpath('//songs') as $playlist) {
    $spotify_playlist = $playlist->foreign_id;
    $spotify_playlist2 = str_replace("spotify-WW:track:",'',$spotify_playlist);
    echo  "$spotify_playlist2,"; 
    if ($i++ == 10) break;
}
?>" width="300" height="380" frameborder="0" allowtransparency="true" style="float: right"></iframe> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T15:56:33.227

> 所以我只想得到节点内的第一条轨道，然后继续下一条。

您正在描述[`continue`](http://php.net/manual/en/control-structures.continue.php)- 移动到下一次迭代并跳过当前循环中的以下代码。而`break`结束当前循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T12:56:38.680

您可以通过计算结果来检索歌曲数量：

```
$numberOfSongsElements = count($xml->xpath('//songs')); 
```

这应该可以确定您要检索的歌曲是否在其中。例如：

```
$playlistNumber = 1;
if ($playlistNumber > $numberOfSongsElements) {
    throw new Exception('Not enough <songs> elements');
}
$songsElement = $xml->xpath("//songs[$playlistNumber]"); 
```

通过使用 Xpath 谓词中的位置编号：

```
//songs[1]  --  abbreviated form of: //songs[position()=1]
//songs[2]
//songs[3]
... 
```

您可以直接选择您感兴趣的节点，无论是第一个 ( `1`) 还是其他数字，甚至是最后一个 ( `last()`)。请参阅[2.4 谓词](http://www.w3.org/TR/xpath/#predicates)和[4.1 节点集函数](http://www.w3.org/TR/xpath/#section-Node-Set-Functions)。

希望这会有所帮助。正如已经评论的那样，您的问题并不那么清楚。我希望计数和编号访问将允许您至少以编程方式选择您正在寻找的元素。

# ruby-on-rails - ActiveRecord 中查询的非流利准备

> ID：14103475
> 
> 赞同：1
> 
> 时间：2012-12-31T15:42:21.057
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, ruby-on-rails-3.2

我的模型中有一些代码如下所示：

```
query = open

if options.has_key? "user_id"
  query = query.where({
    :user_id => user_id
  })      
end

if options.has_key? "shop_id"
  query = query.where({
    :shop_id => shop_id
  })
end 
```

出于好奇，有没有一种方法可以告诉我的查询对象简单地“保留”我分配给它的 where 子句（比如：shop_id 和 :user_id 是否都存在）。从而阻止我总是必须将结果分配回本地查询变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:54:27.197

为什么不使用[范围](http://guides.rubyonrails.org/active_record_querying.html#scopes)

例如，您将拥有：

```
scope :for_user, lambda { |user| where(user_id: user.id) }
scope :for_shop, lambda { |shop| where(shop_id: shop.id) } 
```

然后给他们两个打电话

```
model.for_user(@user).for_shop(@shop) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T12:42:43.910

您还可以在模型中定义方法

**对于用户**

```
def for_user(user)
  where("user_id = ?", user.id)
end 
```

**和商店**

```
def for_shop(shop)
  where("shop_id = ?", shop.id)
end 
```

你也可以结合这两种方法

```
def for_user_or_shop(user_shop)
  where("#{user_shop}_id = ?", user_shop.id)
end 
```

**注意：如果你通过范围，那么它比方法更好，所以使用范围**

# jquery - 单击将删除页面上某处的某些类

> ID：14103480
> 
> 赞同：0
> 
> 时间：2012-12-31T15:42:51.327
> 
> 标签：jquery, hyperlink

我有一个带有一些导航的单页网站，当我单击导航链接时，它需要处于活动状态（一些 div 可见）。在弹出 div 中有一个关闭链接，当单击关闭链接时，导航按钮需要处于非活动状态。

因此，基本上使链接处于活动状态并在单击其他链接后使其处于非活动状态。

我做了一个小提琴：http: [//jsfiddle.net/fourroses666/TKnUZ/1/](http://jsfiddle.net/fourroses666/TKnUZ/1/)

```
$(function() {
   $('a.link').click(function() {
       $('a.link').removeClass('active');
       $(this).addClass('active');
   });
}); 
```

单击取消链接时，链接需要处于非活动状态！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T15:46:23.897

您只需要添加一个新的单击处理程序即可删除每个链接上的“活动”类（参见[小提琴](http://jsfiddle.net/TKnUZ/4/)）

```
$(function() {
   $('a.link').click(function() {
       $('a.link').removeClass('active');
       $(this).addClass('active');
   });

   $('a.close').click(function() {
       $('a.link').removeClass('active'); 
   });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:47:53.213

只需在超链接上的 .close 类的单击事件中执行相同的操作

```
$(function() {    
    $('a.close').click(function(){
       $('a.link').removeClass('active'); 
    });
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T15:54:41.643

It appears that the function only accommodates for a.link and the close link is a.close and so is not getting picked up in that function. This will work: [http://jsfiddle.net/TKnUZ/6/](http://jsfiddle.net/TKnUZ/6/)

```
$(function() {
   $('a.link').click(function() {
       $('a.link').removeClass('active');
       $(this).addClass('active');
   });
    $('a.close').click(function(){
         $('a.link').removeClass('active');                   
    })
 });​ 
```

however im not sure if you were trying to handle it all in the first one click method... Hope it helps at least

# javascript - CSSStyleRule 的跨浏览器（现代浏览器）操作

> ID：14103486
> 
> 赞同：2
> 
> 时间：2012-12-31T15:43:29.813
> 
> 标签：javascript, css, dom-manipulation

根据 MDN ( [https://developer.mozilla.org/en-US/docs/DOM/CSSStyleRule](https://developer.mozilla.org/en-US/docs/DOM/CSSStyleRule) ) CSSStyleRule 对象的样式属性是只读的。有没有办法能够在现代浏览器中可靠地修改其样式属性（主要是 chrome/safari 和 firefox，但 IE9 也不错）？

半相关的问题，但有没有办法访问样式规则内的评论（编辑：并知道评论“属于”哪个规则/选择器）？即对于这个规则：

```
.my-rule {
    /* A Comment */
    color: blue;
} 
```

我希望能够`/* A Comment */`通过 javascript 检索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:59:36.893

这是更新的[**演示**](http://jsbin.com/iwazos/8/edit)

**JavaScript**：

```
var styles = document.getElementsByTagName('style')[0].textContent;
var comments =  styles.match(/\/\*.*\*\//g);
console.log(comments); 
```

**更新**

由于 OP 想要与评论建立关系，请改用此代码：

```
var styles = document.getElementsByTagName('style')[0].textContent;
var objItems = {};
var arrItems = styles.split('}');
arrItems.pop();

for (var i = 0; i < arrItems.length; i++) {
    var grp = arrItems[i].split('{');
    objItems[$.trim(grp[0])] = arrItems[i].match(/\/\*.*\*\//g);
}

for(var i in objItems) {
      console.log(i + ': [ ' + objItems[i] + ' ]');
} 
```

# leaflet - 传单层控制事件？

> ID：14103489
> 
> 赞同：20
> 
> 时间：2012-12-31T15:43:38.703
> 
> 标签：leaflet

所有，我想检测用户层选择，以便将我的侧边栏与显示的层同步。

但是我在 API 参考中没有看到任何层控制事件；我如何判断何时发生了此类用户层选择？

作为替代方案，我查看了图层加载和卸载事件，但在返回的内容中没有看到任何标识。我是否以某种方式错过了它？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2014-08-29T11:28:35.213

有一些事件可以让您知道用户何时激活/停用图层。

这可能会帮助您：

[https://leafletjs.com/reference-1.4.0.html#map-baselayerchange](https://leafletjs.com/reference-1.4.0.html#map-baselayerchange)

例如：

```
map.on('overlayadd', onOverlayAdd);

function onOverlayAdd(e){
    //do whatever
} 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-09-06T11:30:43.507

这里定义了一个“baselayerchange”事件[http://leafletjs.com/reference.html#control-layers](http://leafletjs.com/reference.html#control-layers) 只需将它绑定到地图对象就可以了。

```
map.on('baselayerchange', function(e) {
  console.log(e);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T15:02:25.640

您可以使用 jQuery 将您自己的“更改”事件绑定到 Leaflet 图层控制单选按钮，如下所示：

```
 $("[name='leaflet-base-layers']").change( function () {
        alert('Layers selected: ' + $(this).parent().text());
    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-15T09:58:31.573

我还没有真正尝试过使用它，但这个插件看起来很有希望： [https ://github.com/vogdb/Leaflet.ActiveLayers](https://github.com/vogdb/Leaflet.ActiveLayers)

我将在我的一个项目中试一试，因为这是一个非常有用的功能。

# actionscript-3 - 在运行时构造变量名

> ID：14103490
> 
> 赞同：0
> 
> 时间：2012-12-31T15:43:45.427
> 
> 标签：actionscript-3

我是 AS3 新手，需要一些帮助。

我有这段代码来播放不同的音频文件并动态循环它们：

```
var mIntroLoop = 12495;
var mBattleLoop = 29000;
var currentPlaying;

function playMusic(x):void
{
     musicChannel = x.play();
     currentPlaying = x;
}

function loopSound(m:Object):Function {
  return function(e:Event):void {
         musicChannel = m.play(m.toString() + "Loop");
     musicChannel.addEventListener(Event.SOUND_COMPLETE, loopSound(currentPlaying));
  }
}

playMusic(mIntro);
musicChannel.addEventListener(Event.SOUND_COMPLETE, loopSound(currentPlaying)); 
```

正如您在代码顶部看到的那样，我有两个变量，`mIntroLoop`并且`mBattleLoop`.

我需要这条线的帮助：

```
musicChannel = m.play(m.toString() + "Loop"); 
```

这当然行不通，它在那里只是为了让你知道我想要做什么。

在该行中，`m.play()`需要将`mIntroLoop`or的返回值作为参数`mBattleLoop`，具体取决于我当前正在播放的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T19:42:06.977

我看到你自己解决了，但我认为你还是应该看看这个。

因为所有 AS3 类都扩展`Object`了类，所以您可以执行以下操作：

```
musicChannel = m.play( this[m.toString() + "Loop"] ); 
```

虽然我不建议使用这种方法，因为当你回到你的代码时它真的很难阅读。否则我认为这是一个干净的解决方案。

# c# - 根据 Datagridview C# 中的内容为单元格组着色

> ID：14103496
> 
> 赞同：0
> 
> 时间：2012-12-31T15:44:52.477
> 
> 标签：c#, .net, datagridview

我正在使用绑定到数据表的相当大的数据网格。我的目标是根据单元格中的数据为单元格组着色。

我希望数据网格为包含值的所有单元格着色，然后在检测到新值时切换颜色并在整个表中重复此操作。

这是我在表格中使用的示例：

```
 Contract ID:
    123456 //Top of the contract, color all cells in the contract blue
    123456 //blue
    123456 //blue
    123456 //blue
    456789 //New contract, color all these cells green
    456789 //green 
    456789 //green
    987654 //Another new contract color all these blue (or another color) again
    etc... 
```

我尝试了类似下面的方法，但无济于事......

```
for (int i = 0; i < myDataGridView.Rows.Count; i++)
    {
         if (i > 0)
         {
             if (myDataGridView.Rows[i].Cells["contract_id"].Value != myDatagridView.Rows[i-1].Cells["contract_id"].Value)
             {
             myDataGridView.CurrentRow.Cells["contract_id"].BackColor = Color.Blue;
             }
         }
    } 
```

我不知道从哪里开始，我尝试循环遍历行并检查值，但这最终会降低性能和速度，并且不会给我我正在寻找的结果。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T17:31:19.583

`DataGridView.CellValueChanged`如果我正确理解您的情况，您可以通过处理事件来实现您正在寻找的东西。这可以防止您必须遍历所有行。理论上，这应该在您填充 DGV 控件时起作用。

这是我正在谈论的一个非常粗略的例子。您可能需要使用它以使其适用于您的特定情况。就我而言，它会在`Style.Backcolor`提交更改的值时调整单元格的 。由于输入数据时可能只有一行，因此我也设置了一个条件来处理这种情况。

如果这是 Winforms DGV 控件，则需要在代码中使用`Cell.Style.BackColor`属性，而不是`Cell.BackColor`属性（在 Winforms DGV 上不存在）。

您将不得不改进代码以适应您的情况。. .

```
 private void Form1_Load(object sender, EventArgs e)
    {
        // Add a handler for the cell value changed event:
        this.myDataGridView.CellValueChanged += new DataGridViewCellEventHandler(myDataGridView_CellValueChanged);
    }

    void myDataGridView_CellValueChanged(object sender, DataGridViewCellEventArgs e)
    {
        // grab a reference to the changed cell:
        DataGridViewCell cell = myDataGridView.Rows[e.RowIndex].Cells["contract_id"];

        // Guard against the case where this is the first row in the DGV table:
        if (cell.RowIndex - 1 >= 0)
        {
            if (cell.Value != myDataGridView.Rows[cell.RowIndex - 1].Cells["contract_id"].Value)
            {
                // CHange the Style.BackColor property for the cell:
                myDataGridView.CurrentRow.Cells["contract_id"].Style.BackColor = Color.Blue;
            }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:08:44.923

毫无疑问，您唯一的选择是遍历数据表行，因为您的数据库中没有此颜色标志。

我建议您在现有数据表中添加一个新数据列，遍历它并在其中设置颜色。

然后，您可以在“CellFormating”事件中为单元格着色。在这种情况下，您可以读取颜色列的值并使用它。

这里有一个完整而简单的单元格格式化事件示例：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellformatting.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellformatting.aspx)

问候

# jsf - p:fileUpload 有时会触发句柄事件，有时不会

> ID：14103499
> 
> 赞同：1
> 
> 时间：2012-12-31T15:45:01.280
> 
> 标签：jsf, file-upload, primefaces

我可以在另一个页面上成功上传图片，但是在带有以下代码的页面上：

```
<p:fileUpload  id="vendorLogoUpload" fileUploadListener="#{vendorEditController.handleVendorLogo}" mode="advanced" auto="true" 
                                                        update="vendorLogo" sizeLimit="10000000" allowTypes="/(\.|\/)(gif|jpe?g|png)$/" /> 
```

首次打开对话框时会触发handleVendorLogo，第二次尝试上传另一张照片时，不会触发handle 事件。这可能是关于什么的？

# nfc - pn512 调试传输命令

> ID：14103508
> 
> 赞同：0
> 
> 时间：2012-12-31T15:46:17.313
> 
> 标签：nfc

我正在尝试在 NFC 目标模式下使用 pn512 的传输命令（http://www.nxp.com/documents/data_sheet/PN512.pdf 19.3.1.5）。

填充 FIFO 并设置命令后，FIFO 为空，但广播中什么也没有发生。

我检查了错误寄存器，没有错误。

您有什么想法，可能出了什么问题，或者如何进一步调试？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T13:10:28.547

为了发送调制，必须通过设置 TxMode 寄存器中的相应位来反转调制

# vbscript - 数组上的拆分函数

> ID：14103510
> 
> 赞同：3
> 
> 时间：2012-12-31T15:46:43.290
> 
> 标签：vbscript

我有一个带有多个分隔符（例如：、、、）的大文本文件（1 长`~`行`*`）`:`。`~`定界符标记一个新的部分，和`*`定界符`:`标记子部分或段。

我尝试了以下方法，但出现类型不匹配错误，可能是因为该`Split`函数旨在用于字符串，而不是数组。

```
Dim  strFileLine, arrSection, arrSegment, arrSegField
strFileLine = "C:\sometextfile.txt"
arrSection  = Split(strFileLine, "~")
arrSegment  = Split(arrSection, "*")
arrSegField = Split(arrSegment, ":") 
```

我正在尝试使用此逻辑将我的段和段字段保留在正确的部分中，并将这些值插入到数据库中。

关于如何使用 VBScript 完成此任务的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T13:43:09.010

解决方案取决于如何将字段导入数据库。如果您只想按照它们在输入文件中出现的顺序处理所有字段，您可以用换行符替换分隔符，然后在换行符处拆分字符串：

```
Set fso = CreateObject("Scripting.FileSystemObject")

Set text = fso.OpenTextFile("C:\sometextfile.txt").ReadAll

text = Replace(text, "~", vbNewLine)
text = Replace(text, "*", vbNewLine)
text = Replace(text, ":", vbNewLine)

arr = Split(text, vbNewLine)

For Each field In arr
  WScript.Echo field
Next 
```

如果您需要更加强调输入文件的结构，可以使用嵌套循环处理输入字符串：

```
Set fso = CreateObject("Scripting.FileSystemObject")

Set text = fso.OpenTextFile("C:\sometextfile.txt").ReadAll

For Each segment In Split(text, "~")
  For Each section In Split(segment, "*")
    For Each field In Split(section, ":")
      WScript.Echo field
    Next
  Next
Next 
```

正如 Ekkehard.Horner 已经指出的那样，为了进一步的帮助，您需要提供有关如何将层次结构导入数据库的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T17:21:09.817

```
 Dim strFileLine
    Dim arrSection()
    Dim arrSegment()
    Dim arrSegField()
    Dim strBuf 
    Dim counta 
    Dim character 
    dim sectioncount 
    dim segmentcount 
    dim segfieldcount 

    strFileLine = "aaaaa~00000?AAAAA:bbbbb~11111?BBBBB:ccccc~22222?CCCCC:ddddd~33333?DDDDD:eeeee~44444?EEEEE:fffff~55555?EEEEE:"
    strBuf = ""
    For counta = 1 To Len(Trim(strFileLine))
        character = Mid(strFileLine, counta, 1)
        Select Case character
            Case "~"
                sectioncount = sectioncount + 1
                redim preserve arrSection(sectioncount - 1)
                arrSection(sectioncount-1)=strBuf
                strBuf = ""
            Case "?"
                segmentcount = segmentcount + 1
                redim preserve arrSegment(segmentcount - 1)
                arrSegment(segmentcount-1)=strBuf
                strBuf = ""
            Case ":"
                segfieldcount = segfieldcount + 1
                redim preserve arrSegField(segfieldcount - 1)
                arrSegField(segfieldcount-1)=strBuf
                strBuf = ""
            Case Else
                strBuf = strBuf & character
        End Select
    Next
    For counta = 0 To ubound(arrSection)-1
        document.Write("SECTION:=" & arrSection(counta) & "<br/>")
    Next
    For counta = 0 To ubound(arrSegment)-1
        document.Write("SEGMENT:=" & arrSegment(counta) & "<br/>")
    Next
    For counta = 0 To ubound(arrSegField)-1
        document.Write("SEGFIELD:=" & arrSegField(counta) & "<br/>")
    Next 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-01T07:52:44.450

要获得 Zaf 解决方案中缺少的第五部分（第 5 节/第 5 段/第 5 段），必须从 FOR 循环中删除 -1。例如：

```
redim preserve arrSection(sectioncount)
arrSection(sectioncount) = strBuf
sectioncount = sectioncount + 1
strBuf = ""

For counta = 0 To ubound(arrSection)   'REMOVE -1 from here
    document.Write("SECTION " & counta & " : " & arrSection(counta) & "<br>")
Next 
```

（对于 Segment 和 Segfield 也是如此）。（另外：strFileLine (EEEEE:) 中的最后 6 个字符应为 FFFFF: ) 无论如何，Zaf 很好地表明，对于小数据，Redim Preserve 非常快！（他的解决方案可以保存为HTM文件进行测试（如果使用IE则在IE10模式下））

# objective-c - 如何使状态栏应用程序与其他状态栏应用程序一起捕获“applicationDidResignActive:”？

> ID：14103513
> 
> 赞同：2
> 
> 时间：2012-12-31T15:46:55.893
> 
> 标签：objective-c, xcode, macos, cocoa, nsapplication

现在我正在开发一个状态栏应用程序，我每次都需要知道应用程序何时失去焦点。所以我目前正在使用`applicationDidResignActive:`它，但是当我打开另一个状态栏应用程序的菜单时，这并没有引起注意。每次我的应用程序失去焦点时，即使打开另一个状态栏应用程序，我
如何才能（或任何其他方法）捕捉到？`applicationDidResignActive:`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T18:17:46.073

我认为您真正要寻找的是窗口失去焦点时。

您可以使用以下`NSWindowDelegate`方法：

```
windowDidResignMain: 
```

您还必须设置`canBecomeMainWindow`为`YES`

```
- (BOOL)canBecomeMainWindow {
    return YES;
} 
```

确保将其连接到代表，你应该没问题。

# objective-c - 通过 NSXPCConnection 传递 xpc_object_t

> ID：14103514
> 
> 赞同：3
> 
> 时间：2012-12-31T15:47:01.813
> 
> 标签：objective-c, foundation, xpc, nsxpcconnection

我是 XPC 服务编程的新手，我正在尝试将在 XPC 服务中创建的 IOSurface 共享给主机应用程序。我可以使用 NSXPCConnection API 设置一个简单的主机和服务，现在我想我应该使用这两种方法（在[IOSurfaceAPI.h](http://developer.apple.com/library/mac/#documentation/Miscellaneous/Reference/IOSurfaceAPI_header_reference/Reference/reference.html#//apple_ref/c/func/IOSurfaceLookupFromXPCObject)中找到）将 IOSurface 传递给主机：

```
IOSurfaceRef IOSurfaceLookupFromXPCObject(xpc_object_t xobj);
xpc_object_t IOSurfaceCreateXPCObject(IOSurfaceRef aSurface); 
```

有没有办法可以使用 NSXPCConnection API 传递 xpc_object_t，还是应该使用 C API（如 xpc.h 中定义）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T00:13:13.220

好问题。[“守护进程和服务编程指南”](http://developer.apple.com/library/mac/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingXPCServices.html#//apple_ref/doc/uid/10000172i-SW6-DontLinkElementID_4)指出 XPC 代理方法只能处理以下数据类型：

*   算术类型（int、char、float、double、uint64_t、NSUInteger 等）
*   布尔值
*   C 字符串
*   仅包含上面列出的类型的 C 结构和数组
*   实现 NSSecureCoding 协议的 Objective-C 对象

`xpc_object_t`只是一个 typedef for `void *`，所以它不符合任何这些标准，我看不出有任何方法可以将它包装在符合要求的东西中。（尝试将其转换为数据，或将其转换为适当大小的 int 是行不通的。）

另一方面，在 10.8 上，`xpc_object_t`也足以使用 ARC 保留/释放 Objective-C 对象，添加到 Objective-C 集合等。

尝试通过你的协议很容易`xpc_object_t`，只是看看苹果是否留下了一个未记录的漏洞。试试看！

否则，较低级别的 XPC API 肯定会起作用：

```
 xpc_object_t message = xpc_dictionary_create(NULL, NULL, 0);
 xpc_object_t xpcSurface = IOSurfaceCreateXPCObject(aSurface);
 xpc_dictionary_set_value(message, "surface", xpcSurface);
 xpc_connection_send_message(connection, message); 
```

# excel - Do While，循环在初始循环后找不到文件

> ID：14103515
> 
> 赞同：1
> 
> 时间：2012-12-31T15:47:03.653
> 
> 标签：excel, vba

循环一直在工作，直到我添加了 If/ElseIf 语句来区分以“N”或“V”开头的两个不同文件。一切似乎都很好，但在它最初循环之后，它会直接通过 If 语句跳到否则。我在本地窗口中观看，它正在正确分配下一个文件，但是脚本将其视为开始时没有“V”，而实际上确实如此。建议？谢谢！

这是有问题的部分：

```
folderPath = myDir
If Right(folderPath, 1) <> "\" Then folderPath = folderPath + "\"
filename = Dir(folderPath & "*.xls")
Do While filename <> ""
    Application.ScreenUpdating = False
    Set wbkCS = Workbooks.Open(folderPath & filename)
    If filename = Dir(folderPath & "V*" & "*.xls") Then
        wbkCS.Worksheets("Cut Sheet").Range("S4:S2000").Copy
        With wbkVer.Worksheets("Cutsheets")
            .Range("A" & .Rows.Count).End(xlUp).Offset(1).PasteSpecial xlPasteValues
        End With
    ElseIf filename = Dir(folderPath & "N*" & "*.xls") Then
        wbkCS.Worksheets("PON Cut Sheet").Range("AV3:AV2000").Copy
        With wbkVer.Worksheets("Cutsheets")
            .Range("A" & .Rows.Count).End(xlUp).Offset(1).PasteSpecial xlPasteValues
        End With
    End If

    filename = Dir
Loop
Application.ScreenUpdating = True 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T16:08:34.067

正如 Remy Porter 所指出的，您对 Dir 函数的重复使用会在每次使用时抓取混乱的条目。

`If filename = Dir(folderPath & "V*" & "*.xls") Then`
这条线将再次`V**.xls`从该路径中获取第一个匹配项。这肯定不是你想要的。

在 Excel VBA 中，您可以将`like`其用作最简单的解决方案：
`If filename like "N*.xls" Then`

（而且你不应该使用那些 double `**`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T16:05:03.007

而不是这个： -

```
If filename = Dir(folderPath & "V*" & "*.xls") Then 
```

*   使用 a 执行以下操作`Regex`

代码：

```
Function ContainsAMatch(ByRef fileName as String) as Boolean
Dim regex as Object
Dim strtxt As String

  strtxt = fileName
  Set regex = CreateObject("VBScript.RegExp")

  With regex
    '-- matches first letter to be V and last set to be .xls
    .Pattern = "^(V)[a-zA-Z0-9]+(.xls)$"   
    .Global = True
    If regex.Test(strTxt) Then
      containsAMatch = True
    Else
      containsAMatch = False
    End If
  End With

End Sub 
```

*   另一种查找是否存在`V`和`.xls`使用的方法`instr`

例如文件名=“Vvtmvy89file.xls”

代码：

```
If InStr(Left(filename,1),"V") > 0 then 
  If InStr(filename, ".xls") > 0 then
    '-- Do Something
  End If
End IF 
```

PS：更新了代码以获得准确的`Regex`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T16:05:07.577

Dir 是一种混乱的功能。不带参数调用 Dir 会回顾对 Dir 的*最后*调用，并获取满足该条件的下一个文件。因此，您的最后一行`filename = Dir`现在正在获取满足 if 或 elseif 中的 Dir 标准的下一个文件。

您应该改用[文件系统对象](http://www.vb123.com/index.html?200408_cw_fso.htm)。

# c# - 如何将格式化的字符串保存到字符串变量中？

> ID：14103517
> 
> 赞同：0
> 
> 时间：2012-12-31T15:47:16.827
> 
> 标签：c#, string, formatting, currency, string.format

我正在创建一个 C# 方法，它应该
1\. 接受一个字符串
2\. 将该字符串格式化为货币（没有小数或美分）并返回它

`String.Format`擅长格式化，~~但它的格式化仅适用于打印或输出值时。~~当我单步执行代码时，我可以清楚地看到实际保存到字符串中的值没有格式化。但我需要将其格式化。这就是需要你帮助的地方。

在上面的步骤 1 中，输入的字符串将属于 3 种可能格式中的一种。（下面，我使用 " 来指定字符串的开头和结尾。" 实际上并不是字符串的一部分。）
1\. "<5000"
2\. "5000-10000"
3\. ">10000"

对于这 3 个示例，该方法应输出
1\. "<$5,000"
2\. "$5,000 - $10,000"
3\. ">$10,000"

基本上，该方法应该在需要的地方添加 $ 和 （`String.Format`做得很好）。其余的格式，如添加 <、> 或 - 很容易。我可以制作一种手动执行此操作的方法，但必须有一种更简单的方法！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T15:49:22.683

只是为了确保您*正在*分配`String.Format`某个地方的结果，对吗？

```
string result = String.Format("<{0}>", 123); 
```

.NET 中的字符串是不可变的，因此函数总是创建新字符串而不是修改现有字符串。此外，“打印和输出”绝不是神奇的，所以当一个函数在之后输出它的结果时不可能有不同的行为。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-31T15:48:42.227

`string.Format`不修改字符串，但返回一个全新的实例。您可以通过以下方式将其分配给变量：

```
var newString = string.Format("{0} is my format", oldString); 
```

你可以用 a 解决你的问题`Regex`，以防你只有原始字符串而不是它们里面的值。这仅适用于您带来的三个示例，但您可以通过更改模式来适应它。

编辑：~~我注意到它不应用逗号，但您可以尝试修改模式以匹配您想要的输出。~~现在它按照作者的要求工作。

```
string[] samples =
{
    "<5000",
    "5000-10000",
    ">10000"
};
var results = samples.
    Select(s => Regex.Replace(s, @"\d+",
        m => Convert.ToInt32(m.Value).ToString("$#,#"))).
    ToArray(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T02:26:18.040

(copied from my comment)

If you already have a string variable, let's call it `s`, saying:

```
string.Format( /* something with s in it */ ) 
```

will not change `s` itself. You might want to reassign, as in

```
s = string.Format( /* something with s in it */ ) 
```

where on the right-hand side the "old" `s` object is used, and the result of `Format` is then "saved" to `s` and becomes the new `s`.

But note that `String.Format` cannot format a *string* as currency. It can format a *number* (like a `decimal` or a `double`) as a currency, but once you have string, no format like `{0:C}` or `{0:C0}` will help change the string output.

# iphone - 如何将谷歌地图集成到我的 iPhone 应用程序中

> ID：14103518
> 
> 赞同：-4
> 
> 时间：2012-12-31T15:47:21.157
> 
> 标签：iphone, objective-c, ios

嗨，我在 iphone 中集成谷歌地图时遇到问题。当我在 iphone 模拟器上运行应用程序时，它运行良好，没有任何错误，当它加载到 iphone 屏幕上时，我只能看到红点而不是整个 [地图.com/maps/documentation/ios/start](https://developers.google.com/maps/documentation/ios/start) 我已经提供了 google 分配给我的 api 密钥，但是当应用程序在 iphone 中加载时，这个 nslog 会不断生成

```
2012-12-31 20:36:17.132 google map[848:12e03] provideAPIKey: should be called at most once
2012-12-31 20:36:17.747 google map[848:12e03] GMSZoomTableQuadTree lacks root zoom table for tile type (mapType: 10)
2012-12-31 20:36:19.062 google map[848:12e03] ClientParametersRequest failed, 3 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:36:19.196 google map[848:14603] Google Maps SDK for iOS version: 1.0.1.1154
2012-12-31 20:36:19.244 google map[848:12e03] ClientParametersRequest failed, 2 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:36:25.618 google map[848:12e03] ClientParametersRequest failed, 1 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:36:33.793 google map[848:12e03] ClientParametersRequest failed, 0 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:36:39.026 google map[848:12e03] ClientParametersRequest failed, 3 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:36:40.885 google map[848:12e03] ClientParametersRequest failed, 2 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:36:45.096 google map[848:12e03] ClientParametersRequest failed, 1 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:36:53.275 google map[848:12e03] ClientParametersRequest failed, 0 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:37:00.036 google map[848:12e03] ClientParametersRequest failed, 3 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:37:00.335 google map[848:12e03] ClientParametersRequest failed, 2 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:37:04.719 google map[848:12e03] ClientParametersRequest failed, 1 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:37:12.941 google map[848:12e03] ClientParametersRequest failed, 0 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:37:25.739 google map[848:12e03] ClientParametersRequest failed, 3 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:37:26.057 google map[848:12e03] ClientParametersRequest failed, 2 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:37:32.466 google map[848:12e03] ClientParametersRequest failed, 1 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:37:40.932 google map[848:12e03] ClientParametersRequest failed, 0 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:37:56.592 google map[848:12e03] ClientParametersRequest failed, 3 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:37:57.050 google map[848:12e03] ClientParametersRequest failed, 2 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:38:02.515 google map[848:12e03] ClientParametersRequest failed, 1 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:38:10.864 google map[848:12e03] ClientParametersRequest failed, 0 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:38:33.764 google map[848:12e03] ClientParametersRequest failed, 3 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:38:34.018 google map[848:12e03] ClientParametersRequest failed, 2 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:38:38.405 google map[848:12e03] ClientParametersRequest failed, 1 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:38:46.651 google map[848:12e03] ClientParametersRequest failed, 0 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:39:19.375 google map[848:12e03] ClientParametersRequest failed, 3 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:39:19.625 google map[848:12e03] ClientParametersRequest failed, 2 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:39:23.874 google map[848:12e03] ClientParametersRequest failed, 1 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:39:32.150 google map[848:12e03] ClientParametersRequest failed, 0 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:40:18.172 google map[848:12e03] ClientParametersRequest failed, 3 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:40:18.427 google map[848:12e03] ClientParametersRequest failed, 2 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:40:22.677 google map[848:12e03] ClientParametersRequest failed, 1 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:40:31.162 google map[848:12e03] ClientParametersRequest failed, 0 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:41:42.868 google map[848:12e03] ClientParametersRequest failed, 3 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:41:43.128 google map[848:12e03] ClientParametersRequest failed, 2 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:41:48.785 google map[848:12e03] ClientParametersRequest failed, 1 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:41:57.027 google map[848:12e03] ClientParametersRequest failed, 0 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:43:43.507 google map[848:12e03] ClientParametersRequest failed, 3 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:43:43.879 google map[848:12e03] ClientParametersRequest failed, 2 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:43:48.065 google map[848:12e03] ClientParametersRequest failed, 1 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)"
2012-12-31 20:43:56.264 google map[848:12e03] ClientParametersRequest failed, 0 attempts remaining. Error Domain=DASHConnectionError Code=100 "The operation couldn’t be completed. (DASHConnectionError error 100.)" 
```

所以请告诉我我需要做什么，因为我浪费了 6 到 7 个小时，我的老板对我很生气，请帮助我

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T16:03:02.757

[入门页面](https://developers.google.com/maps/documentation/ios/start)说：

> 如果您看到标记，但地图不可见，请确认您已提供 API 密钥。

你真的申请了*Google Maps SDK **for iOS***吗？您真的在 Google API 控制台的*服务页面上看到了****适用于 iOS****的Google Maps SDK吗？***（在我的 API 项目中，我看不到它。）**

 ***您可能正在使用*Google Maps API v3*的 API 密钥，这是您想要做的错误服务。

看起来 Google 还没有为 iOS 服务发送很多 API 密钥。您所能做的就是申请该服务并等待谷歌的答复。***

# jquery - jQuery Boilerplate 将元素作为选项传递

> ID：14103525
> 
> 赞同：0
> 
> 时间：2012-12-31T15:48:15.770
> 
> 标签：jquery, jquery-plugins, plugins

我正在使用 jQuery 样板作为插件模式
，有关 jQuery 样板的更多信息可以在这里找到：[https ://github.com/jquery-boilerplate/boilerplate/](https://github.com/jquery-boilerplate/boilerplate/)

我想将一个元素作为默认选项传递，但我无法访问它
这里是（简化的）代码：

```
;(function ( $, window, document, undefined ) {

    /*creating the default settings*/
    var pluginName = 'pluginName',
        defaults = {
            nextElem:$('#right') 
        };
    console.log(defaults.nextElem); // return : Object[] , not cool

    /*merging default and options, then calling init*/
    function Plugin( element, options ) {
        this.options = $.extend( {}, defaults, options);
        this.init();
    }
    Plugin.prototype = {
        init: function() {
            /*trying to access the default nextElem */
            console.log(this.options.nextElem); // return : Object[] , not cool
            console.log(this._defaults.nextElem); // return : Object[] , not cool
            this.options.nextElem = $('#right');
            console.log(this.options.nextElem);// return : Object[div#right] , cool
        }
    };

    $.fn[pluginName] = function ( options ) {
        return this.each(function () {
            if (!$.data(this, 'plugin_' + pluginName)) {
                $.data(this, 'plugin_' + pluginName, new Plugin( this, options ));
            }
        });
    }
})( jQuery, window, document ); 
```

和 HTML

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <script type="text/javascript" src="js/jquery1.8.3.js"></script>
        <script type="text/javascript" src="js/pluginName.js"></script>
    </head>
    <body>
    <script>
    $(function(){
        $('#img').PluginName();
    });
    </script>
    <div id="img"></div>
    <div id="right"></div>
    </body>
</html> 
```

为什么这两个 3`console.log(this.options.nextElem)`没有返回我的 jQuery 对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:50:41.743

似乎您之前正在运行插件的代码`document.ready`。

即使您只是在文档准备好之后才*调用*插件函数，您的插件函数本身也会*在*此之前运行；最初的调用`$('#right')`是在之前完成的`document.ready`。

* * *

另一种方法是传递字符串而不是实际对象：

```
var pluginName = 'pluginName',
    defaults = {
        nextElem: '#right'
    };

function Plugin( element, options ) {
    this.options = $.extend( {}, defaults, options);
    this.options.nextElem = $(this.options.nextElem);
    this.init();
} 
```

# android - 使用“if (convertView == null)”时的 GridView 和图标混乱

> ID：14103527
> 
> 赞同：4
> 
> 时间：2012-12-31T15:48:33.447
> 
> 标签：android, gridview, layout-inflater

我是这方面的新手，所以请耐心等待:)

我正在使用一些 LayoutInflater 来设置带有图标 + 文本的 GridView。当我如下使用时，一切正常。但是当我删除评论标记“//”时，一切都搞砸了。图标以错误的顺序呈现，甚至在少数地方它们会翻倍。

```
 View v;
//    if (convertView == null) {  // if it's not recycled, initialize some attributes
        LayoutInflater li = (LayoutInflater) mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        v = li.inflate(R.layout.icon, null);
        TextView tv = (TextView)v.findViewById(R.id.icon_text);
        tv.setText(kraj[position]);
        ImageView iv = (ImageView)v.findViewById(R.id.icon_image);
        iv.setImageResource(mThumbIds[position]);
        iv.setScaleType(ImageView.ScaleType.CENTER_CROP);
        iv.setLayoutParams(new LinearLayout.LayoutParams(mniejszy, mniejszy));
//    } else {
    //    v = (View) convertView;
//    }
    return v; 
```

这是我从中获得部分代码的教程：http: [//developer.android.com/guide/topics/ui/layout/gridview.html](http://developer.android.com/guide/topics/ui/layout/gridview.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T15:54:45.010

发生这种情况是因为您**仅**在`convertView`is时设置图像`null`（例如，当`GridView`屏幕上首次显示时会发生这种情况），并且当`GridView`滚动时（`convertView`不会为空），它将回收行视图，因此您最终会得到您未使用新图像/文本更新的旧行。你的代码应该是这样的：

```
View v;
    if (convertView == null) {  // if it's not recycled, initialize some attributes
        LayoutInflater li = (LayoutInflater) mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        v = li.inflate(R.layout.icon, null);            
    } else {
       v = (View) convertView;
    }
    TextView tv = (TextView)v.findViewById(R.id.icon_text);
    tv.setText(kraj[position]);
    ImageView iv = (ImageView)v.findViewById(R.id.icon_image);
    iv.setImageResource(mThumbIds[position]);
    iv.setScaleType(ImageView.ScaleType.CENTER_CROP);
    iv.setLayoutParams(new LinearLayout.LayoutParams(mniejszy, mniejszy));
    return v; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:57:02.343

您所经历的可能是由于`recycled view`您之前分配的数据。

请查看以下代码以获取方向。

```
View v;
if(convertView == null) {
  LayoutInflater li = (LayoutInflater) mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        v = li.inflate(R.layout.icon, null);
} else {
 v = (View) convertView; 
}

// now override whatever `recycled view` has

     TextView tv = (TextView)v.findViewById(R.id.icon_text);
        tv.setText(kraj[position]);
        ImageView iv = (ImageView)v.findViewById(R.id.icon_image);
        iv.setImageResource(mThumbIds[position]);
        iv.setScaleType(ImageView.ScaleType.CENTER_CROP);
        iv.setLayoutParams(new LinearLayout.LayoutParams(mniejszy, mniejszy));

return v; 
```

# php - PHP 打印热敏收据打印机

> ID：14103530
> 
> 赞同：3
> 
> 时间：2012-12-31T15:48:49.953
> 
> 标签：php, printing, point-of-sale

我拥有连接到本地 PHP 销售点的 Sewoo 热敏打印机。现在作为使用 php 的简单打印测试，我编写了以下代码：

```
<?php
$handle = printer_open("THERMAL LK-TXXX");
$handle = printer_open();
?> 
```

我得到了这个错误：

```
Fatal error: Call to undefined function printer_open() in C:\wamp\www\frame\reciept.php on line 2 
```

我使用 Wampp 作为我的 Web 服务器，Windows 7，并且我已经为我的打印机安装了正确的驱动程序。我该如何解决这个问题，或者是否有替代的“打印”方法使用 PHP 自动打印而不显示打印预览？

谢谢你

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T15:53:49.040

POS 打印机（大部分）不是使用 Windows 打印功能创建输出的打印机，它完全独立于设备，而只是打印机控制语言中串行数据的接收器（我们构建了一个票务系统驱动非常相似的打印机）。

一种方法是使用`Win32API`PHP 和`OpenDriver`API 的扩展，但结果却是一团糟。最好的方法是简单`fopen()`的打印机端口并通过以下方式写入您的 PCL 数据`fwrite()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:57:05.067

您可能会收到此错误，因为未安装打印机扩展。来自 PHP 手册：

> 安装
> 
> 这个 » PECL 扩展不与 PHP 捆绑在一起。
> 
> Windows 用户必须在 php.ini 中启用 php_printer.dll 才能使用这些功能。此 PECL 扩展的 DLL 当前不可用。另请参阅 Windows 部分的构建。

安装说明可以在这里找到：http: [//php.net/manual/en/install.windows.building.php](http://php.net/manual/en/install.windows.building.php)

# spring - Spring MVC：@RequestParam 仅用于 POST 请求

> ID：14103533
> 
> 赞同：0
> 
> 时间：2012-12-31T15:49:08.597
> 
> 标签：spring, spring-mvc, portlet

我正在使用 Spring 作为我的框架构建一个 Portlet 应用程序。在方法中需要一个`@RequestParam`参数`@RenderMapping`，所以我实际上是这样做的：

```
@RenderMapping
public String iDoSomething(
        @RequestParam(required = false) String theParameter,
        ModelMap modelMap, PortletSession session, Principal principal) 
```

我还在 @ModelAttribute 方法中使用参数，如下所示：

```
@ModelAttribute("imInModel")
public AClass iCreateAModel(
        @RequestParam(required = false) String theParameter,
        BindingResult bindingResult, PortletSession session,
        Principal principal, PortletRequest request) { 
```

现在，我只想在使用的 HTTP 方法是 POST 时才将参数传递给我的方法，如果方法是 GET，则忽略它。那可能吗？

# linux - 我可以使用静态 IP 检测已配置连接设备的网络和网络掩码吗

> ID：14103535
> 
> 赞同：2
> 
> 时间：2012-12-31T15:49:11.327
> 
> 标签：linux, networking, tcp, ping, ifconfig

我正在运行带有有线网络接口的 Linux 设备。此接口的另一端插入另一个网络感知设备，该设备配置为使用一些静态 IP 地址和一些网络掩码。因此，我们有一个非常简单的网络，仅由两台设备和一根电缆组成，甚至没有在它们之间切换，什么都没有。

任务是开始与另一台设备通话，我们需要

1.  用 ifconfig 之类的把网络挂起来。
2.  获取 IP 地址并启动我的程序，该程序使用此 IP 地址与设备一起工作。

我知道我可以进行广播 ping 并获取电缆另一端设备的 IP 地址。这对我有用。但是要激活网络并进行广播 ping，我需要知道网络地址和网络掩码。我当前的 bash 脚本看起来像

```
ifconfig 192.168.100.1 netmask 255.255.255.0 up
ping -b 192.168.100.255 
```

设备做出响应。不幸的是，其中一些设备可能被错误地配置为不可预测的网络和网络掩码。任何人都可以提出如何自动检索网络设置（netbase，网络掩码）的想法吗？即使是部分解决方案也会感激不尽。如果有帮助，可以在我这边编译和安装一个自定义 C 工具。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T16:43:58.017

对于第一部分，只要您能以某种方式限制范围，您就可以使用 nmap，根据您的评论，这已经应该为您提供所需的主机：

```
sudo nmap -PR -sn 192.168.0-255.0-255 -e <interface-to-test> 
```

这会根据 ARP 进行发现，如果成功，则在之后进行额外的 ICMP ping 以获取活动性。这个在没有活动本地主机的范围和 4 个活动主机的范围内花了我大约一秒钟的时间。因此，您甚至可以将其扩展到更大的范围，但不是完整的 IPv4 地址空间，除非您有一两天时间。在这种情况下，我只需连接wireshark 或tcpdump 并等待一个免费的ARP。

**编辑**：为此，您必须使用要测试的子网中的 IP 配置“源计算机”。我以为它会在离开子网或未配置 ip 时使用 ARP 的 DAD 模式，但它什么也不做。我在为下面的算法编写的脚本中添加了一个更通用的版本，但它比简单地使用 nmap 来获得这个结果要慢一些。

检测配置的网络掩码有点棘手。但我认为这个程序会起作用，主要思想是主机将向其子网中的主机发送一个 ARP 请求，而对于不在其子网中的主机，它的 default-gw 没有任何内容或 ARP 请求。

1.  从倒数第二个子网开始`N=29`。
2.  `X`从这个由主机 IP 和子网掩码组成的子网中选择一个 IP `N`。确保选择的 IP 不是主机的 IP，也不是网络/广播。还要确保这个 IP 不是由主机 IP 和掩码形成的子网的一部分`N+1`。
3.  使用源 Ping 另一台主机`X`（您不在乎它是否应答，只需发送请求即可）
4.  如果您看到 ARP 请求`X`，则减`N`一。回到 2
5.  如果您没有看到 的 ARP 请求`X`，`N+1`则搜索子网。

一个缺陷可能是过于雄心勃勃的网络堆栈实现可能会从传入的 ICMP 请求中学习 MAC，但我个人不知道有任何以这种方式工作的终端设备堆栈。

我不知道是否有工具可以为您执行此操作，但使用 ping、tcpdump 和子网计算器手动操作应该很容易；)。[或者，如果您觉得有一些黑客行为，那么使用scapy](http://www.secdev.org/projects/scapy/)实现这一点可能并没有太多工作

我自己编写了一个完整的 python scapy 脚本，它应该可以工作，我在我的家庭网络上的 linksys homegw、另一台 linux 机器和一个 android 设备上对其进行了测试：

```
from __future__ import print_function, absolute_import, unicode_literals
from scapy.base_classes import Net
from scapy.config import conf
from scapy.layers.inet import Ether, ARP, ICMP, IP
from scapy.sendrecv import srp, debug
import scapy.route

iface = b'eth0'
subnet_to_test = b'192.168.1.0/24'
#or:
subnet_to_test = b'192.168.1.*'

#IP/MAC discovery
pkt = Ether(dst=b'ff:ff:ff:ff:ff:ff') / ARP(psrc=b'0.0.0.0', pdst=subnet_to_test, hwdst=b'ff:ff:ff:ff:ff:ff')
responses = srp(pkt, timeout=1, retry=0, verbose=0, iface=iface)
for r in responses[0]:
    found = r[1].getfieldval('psrc')
    foundmac = r[1].getfieldval('hwsrc')

n = 29
conf.debug_match = 1
while n > -1:
    net = Net("{}/{}".format(found, n))
    my_src = net.choice()
    while my_src in Net("{}/{}".format(found, n + 1)):
        my_src = net.choice()
    pkt = Ether(dst=foundmac) / IP(dst=found, src=my_src) / ICMP(type=8)
    resp = srp(pkt, timeout=1, retry=0, verbose=0, iface=iface, filter=b'ether dst FF:FF:FF:FF:FF:FF and arp')
    received = [x for x in debug.recv if x.haslayer(ARP) and x.getfieldval('pdst') == my_src]
    received.extend(x[1] for x in resp[0] if x[1].haslayer(ARP) and x[1].getfieldval('pdst') == my_src)
    if len(received) == 0:
        print("Found host: {}/{} on mac {}".format(found, n + 1, foundmac))
        break
    n -= 1 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-31T21:46:09.783

你所要求的是不可能的。

最初，您有一个没有 IP 地址的接口。因此，您发送的任何数据包都不知道将回复发送到哪里（ICMP 或 ARP 请求因此不起作用）。

由于发件人不知道如何到达此接口，您可以在该接口上侦听任何广播 ARP 请求（使用 tcpdump、wireshark 等）。这将向您显示网络中正在解析哪些 IP 地址，但确实如此不给你网络掩码（以及网络地址）。此外，它*不仅*为您提供直接连接的邻居的 IP 地址，它还将为您提供在此广播域内发出的*所有ARP 请求（因此您可能会看到许多 IP 地址）。*

现在，至于确定设备正在使用的网络掩码，在使用 CIDR 时是不可能的（前缀可能在 /16 和 /32 之间的任何位置，并且无法确切知道邻居设备正在使用哪一个.)

话虽如此，您可能想查看链接本地 IPv4 地址。在 Linux 上有一个名为 AVAHI 的程序，而在 Windows 上则称为 APIPA。两者都实现了 RFC 3927：[https ://www.rfc-editor.org/rfc/rfc3927](https://www.rfc-editor.org/rfc/rfc3927)

链路本地地址只能用于与同一物理或逻辑链路上的设备通信，因此如果您确实希望此设备位于同一子网上，则必须手动配置接口。

# php - ZF2 覆盖我的错误处理程序？

> ID：14103537
> 
> 赞同：0
> 
> 时间：2012-12-31T15:49:18.983
> 
> 标签：php, error-handling, zend-framework2

我认为 ZF2 似乎正在覆盖我的自定义错误处理程序。

在我的初始化中，我正在设置数据库，然后执行以下操作。

```
$errorHandling = new catalina\ErrorHandler($database);
set_error_handler(
    array($errorHandling, 'userErrorHandler')
);

set_exception_handler(
    array($errorHandling, 'userExceptionHandler')
);

/**
 * Configure the session management
 */

$sessionOptions         = new DbTableGatewayOptions();
$sessionTableGateway    = new TableGateway('session', $database);
$saveHandler            = new DbTableGateway($sessionTableGateway, $sessionOptions);
$sessionManager         = new SessionManager(NULL, NULL, $saveHandler);

/**
 * Start the session
 */
$sessionManager->start(); 
```

看来，一旦我开始会话，我的自定义错误处理就没有得到遵守。有什么不好的想法吗？

即使在会话开始后设置它似乎也无法解决它。

# c# - RadGridView 更改文本颜色

> ID：14103539
> 
> 赞同：4
> 
> 时间：2012-12-31T15:49:34.850
> 
> 标签：c#, wpf, telerik, telerik-grid, radgridview

我有一个简单`RadGridView`的方法，我想更改特定行（= 3 个单元格）的文本颜色。不幸的是，这段代码不起作用：

```
//add new row to the grid
EventLogGrid.Items.Add(new EventLogRow(eventType, occured, msg));

//change the color of the text of all cells if it's an exception
if (eventType == EventLogger.EventType.Exception)
{
  var rows = this.EventLogGrid.ChildrenOfType<GridViewRow>();
  rows.Last().Foreground = new SolidColorBrush(Colors.Yellow);
} 
```

任何输入将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T21:06:42.360

实际上有一个非常简单的解决方案：

1.  附加事件处理程序：

    ```
    EventLogGrid.RowLoaded += EventLogGrid_RowLoaded; 
    ```

2.  更改行的颜色：

    ```
    if (((EventLogRow)e.DataElement).MsgType == EventLogger.EventType.Exception)
    {
       e.Row.Foreground = new SolidColorBrush(Colors.Red);
    } 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T16:04:24.960

尝试类似的方法 Telerik 网站也有大量很棒的示例[Telerik Radgrid 概览](http://www.telerik.com/search.aspx?insection=False&start=0&client=telerik_developer_tools&q=radgrid&sid=1)

```
protected void RadGrid1_ItemDataBound(object sender, Telerik.Web.UI.GridItemEventArgs e)
{
    //Check if the Item is a GridDataItem
    if (e.Item is GridDataItem)
    {
        GridDataItem dataBoundItem = e.Item as GridDataItem;

        if (int.Parse(dataBoundItem["yourColounName"].Text) == "Date")
        {
            dataBoundItem["yourColounName"].ForeColor = Color.Red;
            dataBoundItem["yourColounName"].Font.Bold = true;
        }
    }
} 
```

或者这对你有用这对你来说很有意义

```
protected void RadGrid1_ItemDataBound(object sender, GridItemEventArgs e)
{
    if (e.Item is GridDataItem)
    {
        GridDataItem item = (GridDataItem)e.Item;
        TableCell cell = (TableCell)item["YourColumnName"];
        cell.BackColor = System.Drawing.Color.Yellow;
    }
} 
```

# wamp - 互联网上的 WAMP 服务器

> ID：14103541
> 
> 赞同：1
> 
> 时间：2012-12-31T15:49:54.227
> 
> 标签：wamp, portforwarding

我希望我的 WAMP 服务器可以在互联网上使用。我怎么做？有人告诉我，一种选择是使用端口转发，我这样做了 [http://portforward.com/english/routers/port_forwarding/Dlink/DSL-2642B/defaultguide.htm](http://portforward.com/english/routers/port_forwarding/Dlink/DSL-2642B/defaultguide.htm)

但是，它没有用。我无法从公共 IP 访问我的网站。谁能帮助我，我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:11:12.057

在获得静态 IP 后，您仍然需要将 wamp 服务器作为网络中的虚拟主机。

在您的 httpd 文件中添加以下内容：

```
<VirtualHost yourlocalIP 127.0.0.1> 
ServerName something.loc    //for use locally and not a domain name 
ServerAlias www*.something.loc //for use locally and not a domain name
DocumentRoot "C:/wamp/www" 
<Directory "C:/wamp/www"> 
Options Indexes FollowSymLinks +Includes +ExecCGI 
AllowOverride None 
Order allow,deny 
Allow from all 
</Directory> 
</VirtualHost> 
```

并且不要忘记在位于的主机文件中进行所需的修改`C:\Windows\system32\drivers\etc`

因此，当路由器为您进行 ip 转发时，您的本地主机知道该怎么做。您可能还需要使用您的LocalIP 指定端口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:02:50.180

1.) 检查 WAMP 服务器当前是否正在运行（主要是接受端口 80 上的传入连接的 apache 网络服务器）。您可以通过验证系统托盘中 wampserver 图标的颜色来检查这一点。如果它是绿色的，表示一切正常。仍然打开 cmd 和 telnet 到端口 80 以检查 apache 是否正在运行。

2.)你是在局域网后面（你正在使用路由器）还是直接连接到互联网？如果前者是真的，那么你必须在你的路由器中启用端口转发（你已经按照你说的做了）

3.) 您在浏览器的地址栏中输入什么 IP 地址以从外部机器访问您的 WAMP 服务器？我希望它不是您的 LAN 地址（192.168.1.4）。它必须是一个 WAN ip（你看到的那个是[http://whatismyip.com](http://whatismyip.com)）

4.）最后但并非最不重要的检查它是否没有在您的 Windows 防火墙中被阻止

# c++ - 使用递归或迭代来分隔 C++ 链表中的偶数和奇数长度字符串更好吗？

> ID：14103544
> 
> 赞同：1
> 
> 时间：2012-12-31T15:50:50.853
> 
> 标签：c++, recursion, iteration

早上好。使用递归或迭代来分隔 C++ 链表中的偶数和奇数长度字符串更好吗？

更好意味着 1) 稳健性 2) 跨平台 Windows/Linux/Unix 可移植性 3) 最坏情况下的运行时性能。

```
cSinglyLinkedList* SeparateOddandEvenlLengthStrings(cSinglyLinkedList* list){
    cSinglyLinkedList* Retval(NULL);
    char* Temp(NULL);
    if (list == NULL || list->Head == NULL){
        return NULL;
    }
    if (list && list->Current && list->Current->Next == NULL){
        return list;
    }
    if (list->Iterate()){
        Temp = list->Current->String;

        Retval = SeparateOddAndEvenLengthStrings(list);

        if ((strlen(Temp) % 2) == 0){
            Retval->Remove(Temp);       
            Retval->Add(Temp);
        }
        return Retval;
    }
    return NULL;
}

class cSinglyLinkedList {
private:
    struct SinglyLinkedInfo{
        SinglyLinkedInfo* Next;
        char* String;
        SinglyLinkedInfo(void){
            Next =  0;
            String= 0;
        }
    } Item;
    SinglyLinkedInfo *Head, *Current; 
    int Count;
    void ClearStrings(void);

public:
    cSinglyLinkedList(void);
    ~cSinglyLinkedList(void);
    bool Add(const char *string1);
    void Remove(const char *string1);
    bool RestartIterator(void);
    bool Iterate(void);
    int GetCount(void);
    SinglyLinkedInfo* GetHead(void);
    SinglyLinkedInfo* GetCurrent(void);
    void Trace(const char *title_);
};

inline bool cSinglyLinkedList::RestartIterator(void) {
    Current=Head;
    return (Current!=0);
}

inline bool cSinglyLinkedList::Iterate(void) {
    if (Current==0){
        Current=Head;
    } else if (Current){ 
        Current = Current->Next;
    }
    return (Current!=0);
}
inline SinglyLinkedInfo *cSinglyLinkedList::GetHead(void) {
    return Head;
}
inline SinglyLinkedInfo *cSinglyLinkedList::GetCurrent(void) {
    return Current;
}
cSinglyLinkedList::cSinglyLinkedList(void) {
    Head=Current=0;
    Count=0;
}
cSinglyLinkedList::~cSinglyLinkedList(void) {
    ClearStrings();
}
void cSinglyLinkedList::ClearStrings(void) {
    SinglyLinkedInfo* nextCurrent;
    Current=Head;
    while (Current!=0) {
        nextCurrent = Current->Next;
        delete[] Current;
        Current=nextCurrent;
    }
    Head=Current=0;
    Count=0;
}
void cSinglyLinkedList::Remove(const char* string1_) {
    SinglyLinkedInfo* Prev(NULL);
    RestartIterator();
    Current = Head;
    while (Current!=0) {
        if (strcmp(Current->String,string1_)==0){       
            if (Prev){
                Prev->Next = Current->Next;
            } else{
                Head = Current->Next;
            }
            delete [] Current;
            break;
        }
        Prev=Current;
        Current=Current->Next;
    }
    RestartIterator();
    Count -= 1;
}

bool cSinglyLinkedList::Add(const char *string1_){ 
    SinglyLinkedInfo* newElement = (SinglyLinkedInfo*)new char[sizeof(SinglyLinkedInfo)];
    memset(newElement, '\x0', sizeof(SinglyLinkedInfo)); 
    newElement->String = new char[sizeof(char*)];
    memcpy(newElement->String, &string1_, sizeof(char*));
    newElement->String = (char*)string1_; 
    newElement->SinglyLinked = new cPCRE();
    newElement->SinglyLinked->SetOptions(PCRE_CASELESS);
    if (newElement->SinglyLinked->Compile(string1_) == 0){
        return false;
    }
    if (Head==0) {
        Head = newElement;

    } else {
        SinglyLinkedInfo* Temp(NULL);

        Temp = Head;

        while (Temp != 0 && Temp->Next != 0){
            Temp = Temp->Next;
        }

        Temp->Next = newElement;
    }

    Count++;
    return true;
}
void cSinglyLinkedList::Trace(const char *title_) {
    int i=0;

    if (title_!=0)
        printf("%s:\n",title_);

    if (RestartIterator()) {
        do {
            printf(" %d: %s\n",i++,GetString());
        } while (Iterate());
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T15:54:32.593

[虽然最终可能因为尾调用优化](http://en.wikipedia.org/wiki/Tail_call)而无关紧要，但链表处理的迭代方法更惯用，至少就 C++ 而言。与递归方法不同，即使您的编译器不应用尾调用优化，迭代方法也不会导致堆栈溢出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T16:08:43.590

没有“有界”[1] 的递归绝对是一件坏事。如果有人将莎士比亚的全集作为输入给你的函数会发生什么（我的意思是所有的书，而不是大约 32 个字符长的“莎士比亚全集”）。

无限递归的问题在于它会以一种你无法恢复的方式爆炸，因为一旦堆栈完全用完，除了终止进程之外，任何人都无能为力。你不能调用一个函数说“对不起，我用完了堆栈”，因为它使用了堆栈空间！

[1] 或者这样，您可以合理地说，对于给定数量的递归调用，它会没问题 - 例如，一个合理平衡的二叉树可以在 32 个递归级别搜索 40 亿个条目，所以如果您的数据库不运行超过几百万个条目[并且有防范病理情况是所有节点都在树的左侧或右侧的链表中结束]，那么你可以说没关系。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T16:12:02.893

根据我的经验，我可以说对于任何算法，迭代版本总是比递归版本快。递归版本也可能导致溢出，因为递归的长度是有限的。但是，递归实现的一个优点是它们非常简单。

# c# - HttpWebRequest.UserAgent 已设置，但无法响应

> ID：14103550
> 
> 赞同：0
> 
> 时间：2012-12-31T15:52:01.217
> 
> 标签：c#, silverlight, httpwebrequest, windows-phone-7.1

我正在为 Windows Phone 7.1.1 开发应用程序

我`HttpWebRequest`用来获取网站的HTML代码问题是，它总是获取“桌面”版本的HTML代码谷歌后，我发现它是由UserAgent字符串控制的

所以，我设置`UserAgent`了`HttpWebRequest`

但它仍然没有得到“移动”版本的 HTML 代码

这是我的代码

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create(new Uri(link, UriKind.Absolute));
        request.UserAgent = "Mozilla/5.0 (compatible; MSIE 9.0; Windows Phone OS 7.5; Trident/5.0; IEMobile/9.0)";
        request.BeginGetResponse(new AsyncCallback(ResponseReady), request); 
```

这是 ResponseReady 的代码

```
private void ResponseReady(IAsyncResult asyncResult)
    {
        try
        {
            HttpWebRequest request = asyncResult.AsyncState as HttpWebRequest;
            HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(asyncResult);
            Stream responseStream = response.GetResponseStream();
            StreamReader reader = new StreamReader(responseStream, Encoding.UTF8);

            HtmlDocument htmlDocument = new HtmlDocument();

            string result = reader.ReadToEnd();

blah blah blah 
```

响应始终与根本不是 UserAgent 相同（桌面版）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T08:19:49.973

我的问题解决了

只需使用 WebViewer / WebBrowser 控件来加载链接。然后使用 OuterHtml 获取该网站的 HTML 代码。真的很简单。您可以将该控件的可见性设置为折叠以将其隐藏在屏幕上

# android - 网站可用性不适用于 Android 应用程序

> ID：14103554
> 
> 赞同：0
> 
> 时间：2012-12-31T15:53:00.840
> 
> 标签：android, eclipse, web

我使用PhoneGap，所以如果我的网页可用，我可以显示它，如果它不可用，我只使用资产中的自定义网页。我已经尝试了几个功能，但没有一个工作。请帮助我并检查我做错了什么。

```
 package com.test.project;

    import java.net.HttpURLConnection;
    import java.net.URL;

    import org.apache.cordova.DroidGap;

    import android.os.Bundle;
    import android.widget.Toast;

    public class MainActivity extends DroidGap {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    super.setIntegerProperty("splashscreen", R.drawable.splash);
    super.setIntegerProperty("loadUrlTimeoutValue", 70000);

    if (isSiteAvailable()) {

        super.loadUrl("http://m.mywebsite.com", 10000);
        Toast.makeText(getApplicationContext(), "Ima!", Toast.LENGTH_SHORT).show();

    } else {

        super.loadUrl("file:///android_asset/www/index.html", 10000);
        Toast.makeText(getApplicationContext(), "nemaaa!", Toast.LENGTH_SHORT).show();    
    }
}
public boolean isSiteAvailable() {

    try {
        URL u = new URL("http://www.google.com");
        HttpURLConnection huc =  (HttpURLConnection) u.openConnection(); 
        huc.setRequestMethod("GET"); 
        huc.connect(); 
        huc.setRequestProperty("Connection", "close");
        huc.setConnectTimeout(2000); // Timeout 2 seconds.
        int response=huc.getResponseCode();

        if ((response >= 400) || (response < 200))
            return false;

        return true;
    }
    catch (Exception e) {
        // TODO Auto-generated catch block
        System.out.println("OOPSIE");
        e.printStackTrace();
    } 

    return false;
}

} 
```

Manifest 具有 Internet 和网络权限，config.xml 允许我的网站 url，除了检查连接外一切正常。请告诉我有什么问题。SDK版本从8到17。我已经重启了eclipse并清除了几次。

我整天都在阅读主题，但我找不到问题。

这是我的清单

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="rs.mujen.nekretnine"
android:versionCode="1"
android:versionName="1.3" >

<supports-screens
    android:anyDensity="true"
    android:largeScreens="true"
    android:normalScreens="true"
    android:resizeable="true"
    android:smallScreens="true" />

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17" />

<supports-screens
    android:anyDensity="true"
    android:largeScreens="true"
    android:normalScreens="true"
    android:resizeable="true"
    android:smallScreens="true" />

<uses-permission android:name="android.permission.CAMERA" />
<uses-permission android:name="android.permission.VIBRATE" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_LOCATION_EXTRA_COMMANDS" />
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.RECEIVE_SMS" />
<uses-permission android:name="android.permission.RECORD_AUDIO" />
<uses-permission android:name="android.permission.MODIFY_AUDIO_SETTINGS" />
<uses-permission android:name="android.permission.READ_CONTACTS" />
<uses-permission android:name="android.permission.WRITE_CONTACTS" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.GET_ACCOUNTS" />
<uses-permission android:name="android.permission.BROADCAST_STICKY" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

<application
    android:allowBackup="true"
    android:hardwareAccelerated="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:permission="android.permission.ACCESS_CHECKIN_PROPERTIES"
    android:testOnly="false"
    android:theme="@style/AppTheme" >
    <activity
        android:name="rs.mujen.nekretnine.MainActivity"
        android:configChanges="orientation|keyboardHidden"
        android:label="@string/app_name"
        android:screenOrientation="portrait" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name="org.apache.cordova.DroidGap"
        android:configChanges="orientation|keyboardHidden"
        android:label="@string/app_name" >
        <intent-filter>
        </intent-filter>
    </activity>
</application> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:44:55.920

将连接时间注释掉，因为网络延迟与时间无关

主要问题是带有连接的 urlconnection 上的 setRequestProperty() --> close 关闭连接

```
public boolean isSiteAvailable() {

try {
    URL u = new URL("http://www.google.com");
    HttpURLConnection huc =  (HttpURLConnection) u.openConnection(); 
    huc.setRequestMethod("GET"); 
    huc.connect(); 
    //huc.setRequestProperty("Connection", "close");
    //huc.setConnectTimeout(2000); // Timeout 2 seconds.
    int response=huc.getResponseCode();

    if ((response >= 400) || (response < 200))
        return false;

    return true;
}
catch (Exception e) {
    // TODO Auto-generated catch block
    System.out.println("OOPSIE");
    e.printStackTrace();
 } 

 return false;
} 
```

希望这些代码对你有用！:)

# javascript - JS函数定义：最后一个括号的含义

> ID：14103575
> 
> 赞同：3
> 
> 时间：2012-12-31T15:54:56.737
> 
> 标签：javascript, jquery, function

> **可能重复：**
> [javascript中自执行函数的目的是什么？](https://stackoverflow.com/questions/592396/what-is-the-purpose-of-a-self-executing-function-in-javascript)
> [这是什么意思？(函数 (x,y)){…}){a,b); 在 JavaScript 中](https://stackoverflow.com/questions/3921922/what-does-this-mean-function-x-y-a-b-in-javascript)

我有时会看到像这些示例定义的函数：

```
(function() {
    ....     
})();

(function(param) {
    ....     
})(JQuery);

(function(chat, Friend) {
    ....     
})(chat, chat.module("friend"); 
```

经过一些网络研究，我没有找到任何关于最后括号信息含义的信息。

有人解释如何使用它吗？或者只是指向一个解释含义的网络链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:00:55.267

假设我们有：

```
function add1 (x) {
    return x+1;
} 
```

然后我们可能会调用`add1(5)`以获取值 6。

但是使用括号，而不是调用`add1(5)`，我们可以将其替换为`(function (x) {return x+1;})(5)`。基本上这会创建一个函数，并立即将其应用于值 5，而当我们调用 时`add1(5)`，我们使用的是命名/定义的函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T16:01:10.960

> 最后刹车的意思

```
(function() {
    ....     
})(); 
```

最后`()`导致函数内部的代码立即执行。

```
(function(param) {
    ....     
})(JQuery); 
```

最后`(JQuery)`导致函数内部的代码立即执行，并`JQuery`作为参数传递给它。

```
(function(chat, Friend) {
    ....     
})(chat, chat.module("friend")); 
```

最后`(chat, chat.module("friend"))`导致函数内部的代码立即执行，并将`chat`其`chat.module("friend")`作为参数传递给它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T15:59:00.447

看看这个问题：[在 JavaScript 中这种做法是什么？](https://stackoverflow.com/questions/3720283/what-is-this-practice-called-in-javascript)

基本上，该函数将使用您传递的参数执行。在此示例中，`param`将具有以下值`jQuery`：

```
(function(param) {
    ....     
})(JQuery); 
```

# objective-c - 告诉自定义委托何时调用方法

> ID：14103578
> 
> 赞同：2
> 
> 时间：2012-12-31T15:55:05.807
> 
> 标签：objective-c, objective-c, ios, class, delegates

我在[objective-c](/questions/tagged/objective-c "显示标记为“objective-c”的问题")中创建了一个具有各种方法的自定义类，并且我还向该类添加了委托方法，可以从另一个导入我的自定义类的类中调用这些委托方法。特别是我正在使用iOS。这是我的头文件 (.h) 和实现 (.m) 文件的一个小示例：

```
//iCloud.h
#import <UIKit/UIKit.h>
#import <Foundation/Foundation.h>

@protocol iCloudDelegate;
@class iCloud;

@interface iCloud : NSObject {
    __weak id<iCloudDelegate> delegate_;
}

@property (nonatomic, weak) id <iCloudDelegate> delegate;

//Methods (abridged for StackOverflow)
+ (void)checkCloudAvailability;

@end

@class iCloud;
@protocol iCloudDelegate <NSObject>
//Methods (abridged for StackOverflow)
@optional
- (void)documentWasSaved;
@required
- (void)iCloudAvailable:(BOOL)status;
@end 
```

我的部分实现（.m）：

```
#import "iCloud.h"
@implementation iCloud
@synthesize delegate;

- (void)documentWasSaved {
    [[self delegate] documentWasSaved];
}

-(void)iCloudAvailable:(BOOL)status {
    [[self delegate] iCloudAvailable:status];
}

+ (void)checkCloudAvailability {
NSLog(@"Checking iCloud availablity...");
NSURL *returnedURL = [[NSFileManager defaultManager] URLForUbiquityContainerIdentifier:nil];

if (returnedURL){
    NSLog(@"iCloud is available");
} else {
    NSLog(@"iCloud not available. ☹");
}
} 
```

我查看了许多教程、SO 帖子、示例代码等，试图弄清楚**如何告诉委托何时调用委托方法**，但我找不到任何东西。大多数帖子显示实现应该添加委托（使用`<DelegateName>`语法），*但是*我的自定义类实现不是我想要使用委托的地方（它在另一个没有创建委托的类中）。

正如您在上面的示例代码中看到的那样，我已经添加了委托方法（在实现中），但据我所知，这一切都会在使用它的其他类中调用委托方法。如果这是正确的，那么我如何让委托调用这些方法（比如从我的`checkCloudAvailability`类中，它不是委托方法之一）？这是我正在尝试做的一个例子：

```
+ (void)checkCloudAvailability
    if (returnedURL){
      [[self delegate] iCloudAvailable:YES]; 
    ...
} 
```

当我尝试使用该`[[self delegate] methodName];`行时，我收到以下错误，并且 Xcode 假装它不知道我在说什么了：![在此处输入图像描述](../Images/176f633de475ee09fe41f8300e95eaa0.png)

为什么会这样？为什么我不能告诉委托*何时*调用委托方法？这在委托方法内部工作得很好，但为什么不能在实现它的类中呢？

任何形式的想法、想法、链接、教程、代码或帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T16:03:25.687

该错误表示它找不到在*类方法*`delegate`的上下文中不可用的方法（即用符号表示的方法）。这可能看起来令人困惑，因为类方法内部不对应于实例，而是对应于类；另一方面，该属性属于一个实例，这意味着它不可用。*`+``self``delegate`*

 *为了解决这个问题，您应该创建`checkCloudAvailability`一个实例方法，或者将其重写如下：

```
+(void)checkCloudAvailabilityWithDelegate:(id<iCloudDelegate>)delegate {
    ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T16:02:58.387

你调用**类**方法 +(void)checkCloudAvailability。类方法中的“self”表示类对象，而不是实例对象。但是为实例对象声明的委托变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T16:50:01.740

看它是一个类方法。我还将使用属性而不是实例变量：

```
@property (weak, nonatomic) id<iCloudDelegate> delegate;
@synthesize delegate = delegate_; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-31T16:04:26.093

当你在函数调用之前使用“+”注解时，它就变成了一个静态方法。在静态方法中，您不能调用“self”*

# asp.net-mvc-3 - 自定义 Html 助手不起作用

> ID：14103586
> 
> 赞同：0
> 
> 时间：2012-12-31T15:56:42.103
> 
> 标签：asp.net-mvc-3, razor, html-helper

我正在尝试从 Pro ASP.NET MVC3 Framework 学习 MVC3。但是我被困在我们添加自定义 Html Helper 的地方。

我做了书中提到的所有事情，但我无法添加自定义 Html 助手。

有人可以帮忙吗。

谢谢

**列表.cshtml**

```
 @model SportsStore.WebUI.Models.ProductListViewModel          

@{    
    ViewBag.Titke = "Product";
}

<!DOCTYPE html>

<html>
<head>
    <title>List</title>
</head>
<body>
    <div>
        @foreach (var p in Model.Products)
        {
            <div class="item">
                @p.Name
                @p.Description
                <h4>@p.Price.ToString("c")</h4>                
            </div>
        }
        <div class="Pager">
        @Html.PageLinks(Model.pagingInfo, x => Url.Action("List", new {page = x}))
        </div>
    </div>    
</body>
</html> 
```

**PagingHelper.Cs**

```
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using SportsStore.WebUI.Models;
using System.Text;

namespace SportsStore.WebUI.HtmlHelpers
{
    public static class PagingHelper
    {
        public static MvcHtmlString PageLinks(HtmlHelper helper, PagingInfo pagingInfo, Func<int, string> pageUrl)
        {
            StringBuilder linkString = new StringBuilder();
            for (int i = 1; i <= pagingInfo.TotalPages; i++)
            {
                TagBuilder tag = new TagBuilder("a");
                tag.MergeAttribute("href", pageUrl(i));
                tag.InnerHtml = i.ToString();
                if (i == pagingInfo.CurrentPage)
                {
                    tag.AddCssClass("selected");
                }
                linkString.Append(tag.ToString());
            }
            return MvcHtmlString.Create(linkString.ToString());

        }
    }
} 
```

**网络配置**

```
 <system.web.webPages.razor>
    <host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <pages pageBaseType="System.Web.Mvc.WebViewPage">
      <namespaces>
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Routing" />
    <add namespace="SportsStore.WebUI.HtmlHelpers" /> 
      </namespaces>
    </pages>
  </system.web.webPages.razor> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T15:57:54.887

您没有创建扩展方法。

要制作扩展方法，您需要用`this`关键字装饰第一个参数。

# css - 通配符不适用于 CSS 宽度

> ID：14103587
> 
> 赞同：2
> 
> 时间：2012-12-31T15:56:43.293
> 
> 标签：css, wildcard

这个通配符有什么问题？

```
div[id*='Form_Form_EditableTextField'] {
    width:554px !important;
} 
```

这没有任何问题。只是为了调试。

```
#Form_Form_EditableTextField1 {
    width:500px;
}​ 
```

html

```
 <div class="middleColumn">
    <input id="Form_Form_EditableTextField1" type="text" name="EditableTextField1">
    <input id="Form_Form_EditableTextField2" type="text" name="EditableTextField1">
    </div>​ 
```

**演示** [http://jsfiddle.net/wLSjY/](http://jsfiddle.net/wLSjY/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T16:01:15.363

> ```
> div[id*='Form_Form_EditableTextField'] 
> ```

这将选择`<div>`具有匹配`id`属性的元素。您要选择`<input>`元素。以下应该有效：

```
input[id*='Form_Form_EditableTextField'] 
```

# windows-phone-7 - Multi-Touch UI：同时拖放多个对象

> ID：14103589
> 
> 赞同：1
> 
> 时间：2012-12-31T15:56:50.657
> 
> 标签：windows-phone-7, drag-and-drop, expression-blend, windows-phone

有没有办法在 Windows Phone 中同时移动多个对象？（如果我移动左右索引，我想移动这两个项目）

我找到了两种在 Windows Phone 上实现拖放的解决方案。但是，我只能同时移动一项。

**使用表情混合**

```
<Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
       <Image Margin="129,112,167,122" Source="mypicture.png" Stretch="Fill">
                <Custom:Interaction.Behaviors>
                    <il:MouseDragElementBehavior/>
                </Custom:Interaction.Behaviors>
       </Image>
</Grid> 
```

**使用 Windows Phone 工具包**

```
<Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
             <Rectangle x:Name="myRectangle" Width="200" Height="200" Fill="Blue">
                 <toolkit:GestureService.GestureListener>
                     <toolkit:GestureListener DragDelta="GestureListener_DragDelta"/> 
                 </toolkit:GestureService.GestureListener>
             </Rectangle>
 </Grid> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T17:46:36.950

其实解决办法就是使用`Touch.FrameReported`

```
// MainPage.xaml
<Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
    <Rectangle x:Name="RedRect" Width="100" Height="100" Fill="Red">
        <Rectangle.RenderTransform>
            <TranslateTransform x:Name="RedTransform" Y="-100" />
        </Rectangle.RenderTransform>
    </Rectangle>
    <Rectangle x:Name="BlueRect" Width="100" Height="100" Fill="Blue">
        <Rectangle.RenderTransform>
            <TranslateTransform x:Name="BlueTransform" Y="100" />
        </Rectangle.RenderTransform>
    </Rectangle>
</Grid>

// MainPage.xaml.cs
public partial class MainPage : PhoneApplicationPage
{
    private Dictionary<int, RectInfo> _rects = new Dictionary<int, RectInfo>();

    // Constructor
    public MainPage()
    {
        InitializeComponent();

        // Register handler for Touch.FrameReported events
        Touch.FrameReported += new TouchFrameEventHandler(OnFrameReported);
    }

    private void OnFrameReported(object sender, TouchFrameEventArgs e)
    {
        TouchPointCollection points = e.GetTouchPoints(null);

        foreach (TouchPoint point in points)
        {
            if (point.Action == TouchAction.Down)
            {
                // Find out if a rectangle was touched
                Rectangle rect = null;

                if (point.TouchDevice.DirectlyOver == RedRect)
                    rect = RedRect;
                else if (point.TouchDevice.DirectlyOver == BlueRect)
                    rect = BlueRect;

                // If the answer is yes, associate the "device" (finger) ID with
                // the rectangle and store information regarding that rectangle.
                // Then change the rectangle's fill color to yellow.
                if (rect != null)
                {
                    TranslateTransform transform =
                        rect.RenderTransform as TranslateTransform;
                    RectInfo ri = new RectInfo() { Rect = rect, Translation =
                        new Point(transform.X, transform.Y), StartPos = point.Position,
                        Fill = rect.Fill };
                    _rects.Add(point.TouchDevice.Id, ri);
                    rect.Fill = new SolidColorBrush(Colors.Yellow);
                }
            }
            else if (point.Action == TouchAction.Move)
            {
                // Find the rectangle (if any) associated with the finger being moved
                int id = point.TouchDevice.Id;

                RectInfo ri = null;
                _rects.TryGetValue(id, out ri);

                if (ri != null)
                {
                    Rectangle rect = ri.Rect;
                    TranslateTransform transform =
                        rect.RenderTransform as TranslateTransform;

                    // Get the current position of the cursor
                    Point pos = point.Position;

                    // Compute the offset from the starting position
                    double dx = pos.X - ri.StartPos.X;
                    double dy = pos.Y - ri.StartPos.Y;

                    // Apply the deltas to the transform
                    transform.X = ri.Translation.X + dx;
                    transform.Y = ri.Translation.Y + dy;
                }
            }
            else if (point.Action == TouchAction.Up)
            {
                // Find the rectangle (if any) associated with the finger being moved
                int id = point.TouchDevice.Id;

                RectInfo ri = null;
                _rects.TryGetValue(id, out ri);

                if (ri != null)
                {
                    // Restore the original fill color of the rectangle associated
                    // with the finger that was just lifted
                    Rectangle rect = ri.Rect;
                    rect.Fill = ri.Fill;

                    // Remove the finger ID from the dictionary
                    _rects.Remove(id);
                }
            }
        }
    }
}

public class RectInfo
{
    public Rectangle Rect;
    public Point Translation;
    public Point StartPos;
    public Brush Fill;
} 
```

# java - 方法 Calendal.getInstance(Locale aLocale) 中的语言环境

> ID：14103593
> 
> 赞同：0
> 
> 时间：2012-12-31T15:57:12.693
> 
> 标签：java, calendar, locale

问题标题中指定的方法中Locale的作用是什么？它如何影响任何结果？我正在尝试以下两行代码：

```
Calendar cal = Calendar.getInstance();
System.out.println(cal.getTime().toString()); 
```

即使我使用参数 Locale.GERMANY 或 Locale.ITALY 尝试它，我也会收到相同的结果。它何时会影响实际结果？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T15:59:39.927

当您拨打一周的第一天等电话时，它将很有用，当您这样做时，`getTime()`您可能看不到任何区别。

根据[javadoc](http://docs.oracle.com/javase/6/docs/api/java/util/Calendar.html)

> Calendar 使用两个参数定义特定于语言环境的一周 7 天：一周的第一天和第一周的最少天数（从 1 到 7）。这些数字是在构造日历时从语言环境资源数据中获取的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T17:54:39.237

好吧，我要同时使用 Locale.GERMANY 和 Locale.ITALY。

尝试将 Locale.CANADA 与 Locale.GERMANY 进行比较

# actionscript-3 - 在函数中使用 EventListener 访问 TextField 值

> ID：14103597
> 
> 赞同：0
> 
> 时间：2012-12-31T15:57:48.400
> 
> 标签：actionscript-3, air, touch-event, event-listener

我正在使用 Adob​​e Air（AS 文档类）开发一个 android 应用程序，并且我有一个函数，它从 SqlLite 数据库获取一个 SQLLite ResultSetb 作为字符串数组，遍历列表，为每次迭代创建一个 TextField，并且将它们附加到舞台上。

当用户点击特定的 TextField 时，我希望将其从数据库中删除。为了捕获事件，我在每个 TextField 上实现了 TouchEvent 侦听器，但我不知道如何识别从事件侦听器中点击了哪个 TextField。

我的代码是：

```
function displayNumbers(allNumbers:Array){
   var y:int=20;
   var telNo:String;
   for(var i:int=0; i<allNumbers.length; i++){
       telNo = allNumbers[i];
       var myText:TextField = new TextField();
       myText.text="text"+i;                    
       myText.addEventListener( TouchEvent.TOUCH_TAP,doDelNo);                  
       myText.x= 20;
       myText.y=y;
       stage.addChild(myText);
       y+=25;
   }
} 
```

现在 doDelNo EventListener 代码如下：

```
function doDelNo(e:MouseEvent):void{                
   var telNo:String = myText.text; //This is where the problem is
   delNo(telNo);
} 
```

问题出在函数“doDelNo”的第 2 行，因为我似乎无法获得被点击的 TextField 实例。ActionScript 甚至在第 2 行抛出错误 - “访问未定义的属性 myText”。

如果有人能帮助我指出正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:02:57.810

```
function doDelNo(e:MouseEvent):void{   
    var currTextField:TextField = e.currentTarget as TextField; //This is how you get the TextField which was clicked
    if (currTextField != null) {
        var telNo:String = currTextField .text; 
        delNo(telNo);
    }
} 
```

# c# - 在 VS2010 中执行 Powershell 调用时出错

> ID：14103598
> 
> 赞同：4
> 
> 时间：2012-12-31T15:57:51.083
> 
> 标签：c#, powershell

我正在尝试从一个类中执行一个 powershell 脚本，但是当我在 x86 模式下设置平台目标时出现错误：

```
Cannot retrieve the dynamic parameters for the cmdlet. Retrieving the COM class factory for component with CLSID {688EEEE5-6A7E-422F-B2E1-6AF00DC944A6} failed due to the following error: 80040154 Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG)). 
```

我有从 x86 Powershell 文件夹中获得的 System.Management.Automation dll，所以我不明白为什么不能在 x86 中工作

如果我将平台目标设置为 x64，它可以正常工作

这是我的代码：

```
 RunspaceConfiguration runspaceConfiguration = RunspaceConfiguration.Create();

        Runspace runspace = RunspaceFactory.CreateRunspace(runspaceConfiguration);
        runspace.Open();

        RunspaceInvoke scriptInvoker = new RunspaceInvoke(runspace);

        Pipeline pipeline = runspace.CreatePipeline();

        //Here's how you add a new script with arguments
        string fullPath = Path.GetFullPath(@"..\..\Scripts\CreateApplicationPool.ps1");
        Command myCommand = new Command(fullPath);

        myCommand.Parameters.Add("ApplicationPoolName", "example");

        pipeline.Commands.Add(myCommand);

        // Execute PowerShell script
        Collection<PSObject> results = pipeline.Invoke(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-15T16:26:19.667

我意识到这是一个旧问题的新帖子......在我自己寻找解决方案时遇到了它。

关于这篇文章，在 x86 平台目标下从 .NET 运行 PowerShell 时，似乎某些命令/模块似乎有问题。我特别遇到了“Import-Module WebAdministration”的问题，并且会收到与您相同的错误。我从哪里得到 System.Management.Automation.dll 也没关系。此外，使用[ILSpy](http://ilspy.net/)查看 dll ，两者“视觉上”似乎是相同的。

不幸的是，我无法解决这个问题，也找不到任何可行的解决方案。有几篇关于这个完全相同或相似类型问题的帖子都指向在 x86 目标平台上运行（我相信这可能是由于 .NET 应用程序神奇地重定向到 PowerShell 的 SySWoW64 版本。[这是一个示例那与文件系统](https://stackoverflow.com/questions/949959/why-do-64-bit-dlls-go-to-system32-and-32-bit-dlls-to-syswow64-on-64-bit-windows)。

虽然我知道这不是一个很好的答案，但我相信答案是不能在 x86 平台上完成。如果您尝试使用 WebAdministration 模块执行操作并且无法克服此错误，您可以尝试[Matt Wrock 的](http://www.mattwrock.com/post/2011/01/04/Nuget-and-Powershell-WebAdministration-Module-Issues.aspx)Importing the Microsoft.Web.Administration 解决方案。这似乎是一个可以接受的解决方法。

最终，我对我所在项目的解决方案是将框架定位到“任何 CPU”，并将 32 位机器视为“不受支持”。

# facebook - 保存用户的头像 URL 是否安全？

> ID：14103604
> 
> 赞同：0
> 
> 时间：2012-12-31T15:58:18.553
> 
> 标签：facebook, facebook-graph-api

我可以只保存图片的 URL 并在每次需要显示用户的图片时使用此 URL 吗？或者这个 URL 是否会在将来某个时候过期，因此如果我保存图像会更好？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T21:11:48.867

如果您使用这种格式，您将始终获得当前用户的公开照片。

> http://graph.facebook.com/[userid]/picture

因此，要获取 Facebook 创始人的照片，请使用： http: [//graph.facebook.com/4/picture](http://graph.facebook.com/4/picture)

因此，用户可以将他们的照片更改一百万次，而您总是会得到最新的。（尽管在 Zuck 的情况下，我认为他多年来都没有改变过那张照片）

# php - PHP Captcha - 会话总是空的

> ID：14103609
> 
> 赞同：2
> 
> 时间：2012-12-31T15:59:25.940
> 
> 标签：php, session, captcha

我试图在我的注册表单中添加验证码。图像渲染得很好，除了会话变量总是空的，所以它根本不起作用..

我正在使用以下课程：[http ://www.ejeliot.com/pages/php-captcha](http://www.ejeliot.com/pages/php-captcha)

根据文档，我必须制作一个包含以下内容的 php 文件：

```
<?php
require('classes/PhpCaptcha.php');
$aFonts = array('fonts/VeraBd.ttf', 'fonts/VeraIt.ttf', 'fonts/Vera.ttf');
$oVisualCaptcha = new PhpCaptcha($aFonts, 200, 60);
$oVisualCaptcha->SetBackgroundImages('captchaimgbg.jpg');
$oVisualCaptcha->Create();
?> 
```

并将其作为图像包含在内。

现在我查看了 Create(); 函数，在这个函数中还有另一个名为 GenerateCode() 的函数；被调用，它负责生成字母并将其放入会话变量中。

代码如下：

```
 function GenerateCode() {
     // reset code
     $this->sCode = '';

     // loop through and generate the code letter by letter
     for ($i = 0; $i < $this->iNumChars; $i++) {
        if (count($this->aCharSet) > 0) {
           // select random character and add to code string
           $this->sCode .= $this->aCharSet[array_rand($this->aCharSet)];
        } else {
           // select random character and add to code string
           $this->sCode .= chr(rand(65, 90));
        }
     }

     // save code in session variable
     if ($this->bCaseInsensitive) {
        $_SESSION[CAPTCHA_SESSION_ID] = strtoupper($this->sCode);
     } else {
        $_SESSION[CAPTCHA_SESSION_ID] = $this->sCode;
     }
  } 
```

CAPTCHA_SESSION_ID 定义在类文件的顶部。在我的索引中，我有 session_start(); ，我仔细检查了这个，这不是问题。

无论我尝试什么， $_SESSION 始终为空，即使我在 create(); 中手动添加 $_SESSION['bla'] = 'bla'; 功能，不显示。

有谁知道是什么原因造成的，或者我做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T16:05:09.013

```
<?php

session_start();
require('classes/PhpCaptcha.php');
$aFonts = array('fonts/VeraBd.ttf', 'fonts/VeraIt.ttf', 'fonts/Vera.ttf');
$oVisualCaptcha = new PhpCaptcha($aFonts, 200, 60);
$oVisualCaptcha->SetBackgroundImages('captchaimgbg.jpg');
$oVisualCaptcha->Create();

?> 
```

您需要在访问/设置变量`session_start()`的所有页面上的代码顶部开始会话。`$_SESSION`

# javascript - Mongoose：获取完整的用户列表

> ID：14103615
> 
> 赞同：118
> 
> 时间：2012-12-31T15:59:45.973
> 
> 标签：javascript, node.js, mongodb, mongoose

我尝试使用 Mongoose 发送所有用户的列表，如下所示：

```
server.get('/usersList', function(req, res) {
    var users = {};

    User.find({}, function (err, user) {
        users[user._id] = user;
    });

    res.send(users);
}); 
```

当然，`res.send(users);`是要发送`{}`，这不是我想要的。有没有`find`语义略有不同的替代方案，我可以在哪里执行以下操作？

```
server.get('/usersList', function(req, res) {    
    User.find({}, function (err, users) {
        res.send(users);
    });
}); 
```

本质上，我希望仅在从数据库中获取所有用户时才执行回调。

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2012-12-31T16:07:44.007

好吧，如果你真的想从 to 返回一个映射`_id`，`user`你总是可以这样做：

```
server.get('/usersList', function(req, res) {
  User.find({}, function(err, users) {
    var userMap = {};

    users.forEach(function(user) {
      userMap[user._id] = user;
    });

    res.send(userMap);  
  });
}); 
```

`find()`返回数组中的所有匹配文档，因此您最后截取的代码将该数组发送到客户端。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-02-05T18:00:02.587

如果您想将数据发送到视图，请传入以下内容。

```
 server.get('/usersList', function(req, res) {
        User.find({}, function(err, users) {
           res.render('/usersList', {users: users});
        });
    }); 
```

在您的视图中，您可以使用变量 users 遍历数据

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2018-05-24T06:45:17.650

有一种非常简单的方法可以列出您的数据：

```
server.get('/userlist' , function (req , res) {
 User.find({}).then(function (users) {
 res.send(users);
 });
}); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-06-10T09:30:54.947

这只是对@soulcheck 答案的改进，并修复了 forEach 中的错字（缺少右括号）；

```
 server.get('/usersList', (req, res) => 
        User.find({}, (err, users) => 
            res.send(users.reduce((userMap, item) => {
                userMap[item.id] = item
                return userMap
            }, {}));
        );
    ); 
```

干杯！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-08-25T07:46:03.163

异步等待和箭头函数也可以做到这一点

```
server.get('/usersList', async (req, res) => {

const users = await User.find({});

const userMap = {};
users.forEach((user) => {
    userMap[user._id] = user;
});

res.send(userMap);

}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-10-29T18:26:46.840

使函数等待获取列表。

```
getArrayOfData() {
    return DataModel.find({}).then(function (storedDataArray) {
        return storedDataArray;
    }).catch(function(err){
        if (err) {
            throw new Error(err.message);
        }
    });
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-01-05T01:27:47.677

如果我们想要`list all documents in Mongoose collection`之后`update`或`delete`

我们可以将函数编辑为如下内容：

```
exports.product_update = function (req, res, next) {
        Product.findByIdAndUpdate(req.params.id, {$set: req.body}, function (err, product) {
            if (err) return next(err);
            Product.find({}).then(function (products) {
                res.send(products);
                });
            //res.send('Product udpated.');
        });
    }; 
```

这将`list all documents`成功，而不仅仅是`showing success message`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-06-15T09:57:53.473

你可以试试这个——

```
User.find().exec(function(err, users){
 console.log('users : ', users);
 console.log('err', err);
 return res.send(users);
}); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-01-07T19:10:06.690

我的解决方案

```
User.find()
        .exec()
        .then(users => {
            const response = {
                count: users.length,
                users: users.map(user => {

                    return {
                        _id: user._id,
                        // other property
                    }

                })

            };
            res.status(200).json(response);
        }).catch(err => {
        console.log(err);
        res.status(500).json({
            success: false
        })
    }) 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2021-01-13T16:21:53.080

你也可以通过异步函数来获取所有用户

```
await User.find({},(err,users)=>{

    if (err){
    return  res.status(422).send(err)
    }

    if (!users){
        return res.status(422).send({error:"No data in the collection"})
    }

    res.send({Allusers:users})

}) 
```

# ruby-on-rails - 嵌套属性不保存/更新

> ID：14103616
> 
> 赞同：0
> 
> 时间：2012-12-31T15:59:53.570
> 
> 标签：ruby-on-rails, nested-attributes

我被困在这个问题上。我可以为新/编辑加载视图，但创建/更新不会更改`Caracteristicas`属性，也不会保存在数据库中。如果需要，会更新的`Produto`属性。对我来说，它似乎都在正确的地方，这就是我寻求帮助的原因。

有人可以指出应用程序无法保存/更新的问题`Caracteristica`吗？

**楷模**

```
class Produto < ActiveRecord::Base
  has_many :caracteristicas
  attr_accessible :titulo, :caracteristicas_attributes
  accepts_nested_attributes_for :caracteristicas, :reject_if => lambda { |c| c[:content].blank? }, :allow_destroy => true
end

class Caracteristica < ActiveRecord::Base
  belongs_to :produto
  attr_accessible :titulo, :conteudo
end 
```

**产品控制器**

```
def new
  @produto = Produto.new
  @produto.caracteristicas.build

  respond_to do |format|
    format.html # new.html.erb
    format.json { render json: @produto }
  end
end 
```

**产品.html.erb**

```
<%= f.fields_for :caracteristicas do |builder| %>
  <%= render 'caracteristica_fields', :f => builder %>
<% end %> 
```

**caracteristica_fields.html.erb**

```
<%= f.label :conteudo %><br />
<%= f.cktext_area :conteudo, :toolbar => 'Easy' %> 
```

**创建参数**

```
{"utf8"=>"✓",
 "authenticity_token"=>"mnWb2X4FiolU/mPjnZcg5nA8eYUbv9GvaBawdl9jr74=",
 "produto"=>{"titulo"=>"cdsacdsacdsa",
 "caracteristicas_attributes"=>{"0"=>{"conteudo"=>"<p>\r\n\t12321312</p>\r\n"},
 "1356968992110"=>{"conteudo"=>"<p>\r\n\tdewdewdewdwe</p>\r\n"}}},
 "commit"=>"Create Produto"} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:25:45.350

我会替换：

```
:reject_if => lambda { |c| c[:content].blank? } 
```

和

```
:reject_if => lambda { |c| c[:conteudo].blank? } 
```

# javascript - 降低 nodejs 服务器上的 CPU 利用率

> ID：14103617
> 
> 赞同：2
> 
> 时间：2012-12-31T15:59:54.587
> 
> 标签：javascript, node.js, web-applications, linkedin, express

我正在寻找有趣的方法来降低 NodeJS 服务器上的 CPU 利用率。

在我的研究中，我发现了以下文章： [http ://engineering.linkedin.com/nodejs/blazing-fast-nodejs-10-performance-tips-linkedin-mobile](http://engineering.linkedin.com/nodejs/blazing-fast-nodejs-10-performance-tips-linkedin-mobile)

这些都是很好的提示，但我对提示#4 有疑问。

这是否真的意味着用户正在请求“JavaScriptTemplate.html”，然后随后请求所有 JSON（此处未实现）？

假设所有动态内容都应该在没有用户交互的情况下可用（例如在按钮单击事件上请求 JSON），实现这一目标的最佳方法是什么？我可以考虑加载额外的 JS 依赖项（requirejs），其中执行函数以请求 JSON 内容。

由于我从来没有看到大型网站调用静态 html 文件，而是请求路由到他们的应用程序服务器，所以上面链接建议的解决方案有多常见？他们真的使用服务器端模板将 CPU 利用率浪费在大多数静态文本内容上吗？？？

对于 Node (expressJS)，这必须是一种次优方式，尤其是如果要生成的 HTML 相当复杂……理想情况下，Node 应该只是作为提供 JSON 数据的 API 服务器运行。

你有什么想法可以分享吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:08:32.100

这不是最常见的方法，但现在仍然很常见。有许多 Web 框架（ google 的[angularjs](http://angularjs.org)、[knockout](http://knockoutjs.com)、[mustache](http://mustache.github.com)等）可以很好地在客户端使用这种模板思想。

模型被请求到服务器（即 json）并映射到静态视图（模板）中。

我认为当你有一个提供 JSON 数据的 API 服务器时它非常适合。这样您就可以开发另一个 API 客户端，在本例中为 Web 客户端 (RIA)。但我不认为这种方法背后的主要原因是为了节省 CPU。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T17:48:03.193

感谢分享这篇文章 - 这是一篇很棒的文章（对我来说非常及时）。

您实际上是在问两个问题 - 1）如何在没有客户端交互的情况下加载数据以呈现 html 客户端，以及 2）如何在用户实际请求路由时将静态文件发送到浏览器。

## 在没有用户交互的情况下渲染页面和我在客户端 MVC 上的 ¢2

1）您需要在页面加载后运行所有初始化/数据加载/渲染代码来渲染页面。如果您在客户端使用 jQuery（就像大多数 Web 应用程序一样）：

```
$(document).ready(function(){
    // Your code here
}); 
```

它只是从[jQuery docs](http://docs.jquery.com/How_jQuery_Works#Launching_Code_on_Document_Ready)复制而来。

大多数人使用主干/下划线在客户端构建 MVC 层。尽管有很多更高级（并且看起来更强大）的客户端框架可以做到这一点，但这对夫妇为您提供了足够的功能，而不会限制您的选择或降低您在某些时候肯定需要的灵活性。下划线（无论如何都是骨干依赖）除了许多非常有用的功能（如果你花一个小时阅读整个一页手册，你会惊讶于 JavaScript 的可能）有自己的模板，这些模板看似简单，同时time 非常强大，因为它们只是在模板中运行所有 javascript。

尽管在模板中包含应用程序逻辑通常是一件坏事（因为下划线允许，而大多数更高级和“更强大”的模板引擎则不允许），但能够在模板中添加一些逻辑通常非常方便且更好当您发现自己处于某个狭窄的角落时（通常会这样），而不是重新设计大量应用程序逻辑或添加额外的模板。

另外，我的意见是避免使用 require.js 或任何其他模块加载器（直到你真的必须使用它们），就像我在[这里](https://stackoverflow.com/questions/14037727/best-backbone-js-and-require-js-boilerplate-for-huge-apps/14041967#14041967)写的那样。

## 为任何路由提供静态 html，为 node-as-api 提供 nginx 配置

2）您需要重写对所有路由的请求，以使用相同的静态 html 文件（或多个依赖于路由的 html 文件）进行响应。根据您的偏好或应用程序要求，它可以是具有空正文的文件（在这种情况下，用户将看到一个空白页面，直到您的数据被加载并且页面在正文中呈现/插入），一些欢迎页面甚至一些模板页面，其中显示的是纺车而不是数据。

重写请求的方式取决于用于提供静态内容和代理请求的 Web 服务器。如果您使用 Apache（Node 不太可能选择，因为它是同步的），您需要使用 .htaccess 文件。如果您像大多数使用 node 的人一样使用 Nginx，则需要在配置文件中的 server 块内使用 rewrite 指令，如下例所示：

```
server {
    listen       80;
    server_name  example.com;
    root         html/example;

    access_log   logs/example.log;

    # location block below sends specific static assets from inside your app's
    # public directory when routes /img, /js, /css, /views are requested
    location ~ /(img|js|css|views)/ {
        rewrite ^(.*)$ /public/$1 break;
    }

    # location block below proxies all data requests (/api route) to your node app
    location /api {
        proxy_pass             http://localhost:3000/;
        proxy_redirect         http://localhost:3000/ http://example.com;
        proxy_connect_timeout  30s;
        proxy_read_timeout     30s;
        proxy_cookie_domain    localhost example.com;
        #proxy_http_version     1.1;
    }

    # location block below rewrites all other routes to a specific html file
    # that is sent to the client and that is supposed to load all JS and
    # static assets to render a page
    location / {
        rewrite ^(.*)$ /public/app.html;
    }
} 
```

您在客户端中呈现页面的方式（以及您从服务器请求的数据）将取决于用户请求的路由（您可以在 javascript 中访问/更改以及设置/访问/更改 cookie ）。应用程序内部的所有导航（当用户单击任何按钮或内部链接时 - 您需要捕获所有单击事件）都会发生，而不需要对已加载的页面或静态资产的额外请求，只有数据请求被发送到服务器。

我希望它有所帮助。

## 搜索引擎优化更新

nginx 的建议配置仅适用于您不需要任何由机器人索引的页面并且对需要静态 html 的其他 Web 应用程序可见的页面，例如 facebook，例如对于您想要索引的页面，您需要添加条件以不同的方式路由来自机器人的请求（基于 $http_user_agent），并为这些路由呈现一些静态 html。但它可以是不同的纯语义 html（更小，没有设计图像、布局 div/类、UI 元素和 javascript 以减少来自爬虫机器人和 Web 应用程序的请求）。

# javascript - 有没有办法在加载之前检测 iframe 将被重定向到的 src？

> ID：14103618
> 
> 赞同：2
> 
> 时间：2012-12-31T15:59:56.443
> 
> 标签：javascript, dom, iframe

我有一个 iframe，我无法控制它的内容。在 iframe 内部会有重定向，而不是在顶部窗口中重定向（我期望的），重定向总是发生在 iFrame 中。我在这里尝试了解决方案：[如果无法控制重定向，如何在 onload 发生之前获取重定向 url？](https://stackoverflow.com/questions/14053253/how-to-get-redirect-url-before-onload-happens-if-no-control-on-the-redirection)但结果并不理想。

现在在 iframe 页面中，我想使用`$(window).unload()`并手动更改`top.window.location.href`以在顶部窗口中强制重定向。那么有谁知道如何在点击之后和`onload`重定向页面之前检测要重定向到的地址？谢谢！

PS：重定向的页面是同域的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T16:16:29.050

我希望这可以帮助你，它只适用于同一域 iframe 内容，新属性沙箱将扩展可能性，但目前仅由 Chrome 实现。

1）检测IF何时加载

```
myIF.addEventListener("load",ifOnLoad,true); 
```

2）每次加载 iframe 时，获取 IF Window 的引用并为 onBeforeUnload 事件注册一个侦听器。

```
ifContentWindow = myIF.contentWindow;
ifContentWindow.addEventListener("beforeunload", ifOnUnload,false); 
```

3）当你的handler(ifOnUnload) 将被调用是为了提前获取ifContentWindow.location，然后设置一个延迟来读取它。

```
setTimeout(delayedIFUnload, 100); 
```

4）在delayedIFUnload 函数中获取if 位置并重定向您的主页。

```
window.location = ifContentWindow.location; 
```

我只在我的环境（MAC、Chrome）中测试代码，您需要做一些工作来调整其他浏览器的代码。例如使用 addEventListener 或 contentWindow。

这是工作代码[http://pannonicaquartet.com/test/testif.html](http://pannonicaquartet.com/test/testif.html)的链接，我尝试在小提琴中进行，但小提琴有很多框架，并且其中的代码无法正常工作。我对消息使用跨度，因为在这种类型的操作中，警报被阻止，至少在 Chrome 中是这样。

```
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Untitled Document</title>
    <script language="javascript" type="text/javascript">
        var myIF, spNotify, ifContentWindow;
        function init(){
            myIF = document.getElementById("myIF");
            spNotify = document.getElementById("spNotify");
            myIF.src="testIF_1.html";
            myIF.addEventListener("load",ifOnLoad,true);
        }

        function ifOnLoad(){
            try{
                ifContentWindow = myIF.contentWindow;
                ifContentWindow.addEventListener("beforeunload", ifOnUnload,false);
            }catch(er){
                alert(er);
            }
        }

        function ifOnUnload(){
            try{
                notify(ifContentWindow.location);
                setTimeout(delayedIFUnload, 100);
            }catch(er){
                alert(er);
            }
        }

        function delayedIFUnload(){
            try{
                notify(ifContentWindow.location);
            }catch(er){
                alert(er);
            }
        }

        function notify(what){
            spNotify.innerText = what;
        }
    </script>
</head>
<body onload="init();">
    <div id="dvMsg">Target: <span id = "spNotify"></span></div>
    <iframe  id="myIF" src=" " style="width:1100px;height:700px;" />
</body> 
```

新年快乐！！！

* * *

```
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Untitled Document</title>
    <script language="javascript" type="text/javascript">
        var myIF, spNotify, ifContentWindow, lastURL, timerRef;
        function init(){
            myIF = document.getElementById("myIF");
            spNotify = document.getElementById("spNotify");
            myIF.src="testIF_1.html";
            myIF.addEventListener("load",ifOnLoad,true);
        }

        function ifOnLoad(){
            try{
                ifContentWindow = myIF.contentWindow;
                ifContentWindow.addEventListener("beforeunload", ifOnUnload,false);
            }catch(er){
                alert(er);
            }
        }

        function ifOnUnload(){
            try{
                notify(ifContentWindow.location);
                lastURL = ifContentWindow.location;
                timerRef = setInterval(delayedIFUnload, 5);
            }catch(er){
                alert(er);
            }
        }

        function delayedIFUnload(){
            try{
                if(lastURL != ifContentWindow.location){
                    notify(ifContentWindow.location);
                    clearInterval(timerRef);
                }
            }catch(er){
                alert(er);
            }
        }

        function notify(what){
            spNotify.innerText = what;
        }
    </script>
</head> 
```

# python - 按长度排序的列表，但在一个步骤中按字母顺序的长度相同

> ID：14103620
> 
> 赞同：6
> 
> 时间：2012-12-31T15:59:59.647
> 
> 标签：python, python-2.6

我的 Python 字符串列表类似于`x`但足够长：

```
x = ['aaa','ab','aa','c','a','b','ba'] 
```

我想将此列表排序为： `['a', 'b', 'c', 'aa', 'ab', 'ba', 'aaa']`我**分两步**执行以下操作：

```
>>> x.sort()   
>>> x.sort(key=len)      
>>> x
['a', 'b', 'c', 'aa', 'ab', 'ba', 'aaa'] 
```

但我需要一步：我还使用`lambda`函数绑定（[**采取了帮助**](https://stackoverflow.com/questions/4655591/python-sort-list)）：

```
>>> x.sort(key=lambda item: (item, len(item)))
>>> x
['a', 'aa', 'aaa', 'ab', 'b', 'ba', 'c'] 
```

但不是我想要的：

是否可以一步到位？让我开心。

我的蟒蛇：

```
~$ python --version  
Python 2.6.6 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-31T16:01:07.470

你得到了元组的顺序错误的方式。当 Python 对元组进行排序时，第一个值是*主*排序，第二个是子排序，依此类推...... - 您的代码假定相反的顺序。

您想按长度排序，*然后*按字母顺序：

```
>>> x.sort(key=lambda item: (len(item), item))
>>> x
['a', 'b', 'c', 'aa', 'ab', 'ba', 'aaa'] 
```

编辑：正如 DSM 在评论中指出的那样，Python 首先将字母排序为大写，然后是小写。如果不需要此行为，请参阅[此答案](https://stackoverflow.com/a/36156/722121)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T16:19:11.380

使用`itertools.grouby()`：

```
In [29]: lis = ['aaa','ab','aa','c','a','b','ba']
In [30]: list(chain(*[sorted(g) for k,g in groupby(sorted(lis,key=len),key=len)]))
Out[30]: ['a', 'b', 'c', 'aa', 'ab', 'ba', 'aaa'] 
```

`timeit`比较：

```
In [38]: x = ['aaa','ab','aa','c','a','b','ba']*1000

In [39]: random.shuffle(x)

#may be in more tricky test cases this would be fast

In [40]: %timeit sorted(x,key=lambda item: (len(item), item))
100 loops, best of 3: 11.3 ms per loop

In [41]: %timeit list(chain(*[sorted(g) for k,g in groupby(sorted(x,key=len),key=len)]))
100 loops, best of 3: 7.82 ms per loop 
```

# assembly - 如何在 MacOSX 上使用 nasm 进行编译

> ID：14103624
> 
> 赞同：14
> 
> 时间：2012-12-31T16:00:21.287
> 
> 标签：assembly, nasm

我正在尝试在 Assembler 上编译和链接我的第一个程序。我尝试编译以下代码：

```
; %include "stud_io.inc"    
global _main     

section .text
_main: 
    xor eax, eax
again:
    ; PRINT "Hello"
    ; PUTCHAR 10
    inc eax     
    cmp eax, 5
    jl again 
```

在用于编译和链接程序的控制台命令下方：

```
-bash-3.2$ nasm -f macho main.asm -o main.o  && ld -e _main -macosx_version_min 10.8 -arch x86_64 main.o 
```

但结果是：

```
ld: warning: ignoring file main.o, file was built for i386 which is not the architecture being linked (x86_64): main.o
Undefined symbols for architecture x86_64:
  "_main", referenced from:
     -u command line option
ld: symbol(s) not found for architecture x86_64 
```

我认为有必要为 x86_64 编译 main.asm 文件。如何为我的系统正确编译程序？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-31T16:26:00.160

我建议首先更新您的[NASM](http://www.nasm.us/pub/nasm/releasebuilds/2.10/)。

之后，尝试运行：

```
nasm -f macho64 main.asm -o main.o  && ld -e _main -macosx_version_min 10.8 -arch x86_64 main.o -lSystem 
```

请注意，新命令在上面添加了 JasonD 的建议 ( `macho64`)，但还在命令中添加了`-lSystem`以`ld`阻止 ld 抛出以下错误：

```
ld: dynamic main executables must link with libSystem.dylib for architecture x86_64 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-01T20:45:09.947

我注意到大多数示例显示了独立的汇编程序，但从 C 调用汇编可能更常见。我创建了一个简单的 C 程序，它使用了一个最小的 nasm 汇编函数，如下所示：

```
extern unsigned cpuid(unsigned n);

/* ... */
        unsigned n = cpuid(1); 
```

程序集如下所示：

```
section .text
    global _cpuid

_cpuid:
    push rbp
    mov rbp, rsp
    mov rax, rdi
    cpuid
    mov rax, rcx
    leave
    ret 
```

您可以在此处查看整个内容，包括 makefile 中的 nasm CLI 选项：

[https://github.com/ecashin/low/tree/master/cpuid](https://github.com/ecashin/low/tree/master/cpuid)

它通过打印出一些特定于 CPU 的功能的可用性来做一些稍微有用的事情。（但它通过使用 CPUID 而不检查它是否可用来做到这一点。如果 CPU 是 Intel 并且比 i486 更新，那很好。）

该示例在 Mac OS X Snow Leopard 上使用 ports 集合中的 nasm 进行了测试。移除下划线前缀是移植到 Linux x86_64 所需的唯一更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-25T04:38:48.343

也许尝试静态链接？

```
ld -macosx_version_min 10.13 -e _main -static main.o 
```

# php - 如何使用 pecl 在 aws beanstalk 上安装 php-solr-client

> ID：14103625
> 
> 赞同：2
> 
> 时间：2012-12-31T16:00:25.363
> 
> 标签：php, solr, amazon-ec2, amazon-elastic-beanstalk

我在亚马逊 AWS 上安装了 beanstalk 服务器。我还有一个运行 SOLR 服务器的不同实例。

在我的 php 脚本中，我使用这个模块：[http://php.net/manual/en/solrclient.adddocument.php](http://php.net/manual/en/solrclient.adddocument.php) 来查询 SOLR 数据库。

要将它安装在 beanstalk 上，我登录到它的 ec2 实例（ec2-user）。这个模块使用 pecl

在 ec2 外壳中：

```
sudo pecl install -n solr 
```

完成后，pecl 将添加`extension = solr.so`到 php.ini

从这一点开始，当我运行 php 脚本时，我会收到：

`PHP Startup: Unable to load dynamic library '/usr/lib/php/modules/solr.so' - /usr/lib/php/modules/solr.so: undefined symbol: curl_easy_getinfo in Unknown on line 0`

我发现了一些关于这个问题的其他帖子，但大多数都放弃了或给出了不完整/不清楚的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T09:38:41.023

如何在 aws beanstalk 上安装 solr php 客户端 - （这个 php 客户端 - [http://php.net/manual/en/solrclient.construct.php](http://php.net/manual/en/solrclient.construct.php)）

1.  假设您已启动并运行 beanstalk 服务器
    *   登录到由 beanstalk 创建的 ec2 实例
2.  sudo pecl install -n solr ->（在提示输入 xmlcurl 时添加 /usr/lib 作为位置文件夹，通过 pecl 安装时 libcur）
3.  从 php.ini -> 中删除“extension=solr.so”（在 root/etc 中找到）
4.  用一行添加文件“solr.ini”=（放入root/etc/php.d）
5.  sudo /etc/init.d/httpd restart -> 重启服务器
    *   确保 solr 服务器端口 8443 : 8983 对 beanstalk 开放。
6.  利润。
7.  现在它正在运行，如果您正在运行它以连接到 solr 4.0 服务器，您会注意到它无法正常工作（commit -> waitflush arg 已在 4.0 中删除，但仍存在于客户端上）
8.  对我来说没有利润...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-11T13:33:02.343

Yaron 的回复对我没用。

然而，下面做了。

我只是添加了

```
extension=curl.so
extension=json.so
extension=solr.so 
```

在**php.ini**结束时 ，它没有任何问题。

注意：我使用的是 php 5.5.12

# windows - 如何禁用 dgv 中的行排序？

> ID：14103626
> 
> 赞同：0
> 
> 时间：2012-12-31T16:00:30.367
> 
> 标签：windows, forms, sorting, row

如何在 Windows 窗体的数据网格视图中禁用用户行排序（因此通过单击列标题）？

我知道您可以禁用列排序，但我找不到任何禁用行排序的方法。我可以使用具有正确索引的隐藏字段。因此，即使用户重新排序行，它也会正确保存在数据库中（通过隐藏索引字段重新排序列表）。但这似乎有点乱。必须有一个内置的方法或属性，对吧？

致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T11:14:17.327

你应该实现 column_added 事件有点棘手：

```
Private Sub DGV_ColumnAdded(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DataGridViewColumnEventArgs) Handles DataGridViewOrganigramme.ColumnAdded
        DGV.Columns(e.Column.DisplayIndex).SortMode = DataGridViewColumnSortMode.NotSortable;
End Sub 
```

希望这可以帮助。

# asp.net-mvc - 数据初始化如何工作？

> ID：14103636
> 
> 赞同：2
> 
> 时间：2012-12-31T16:01:20.790
> 
> 标签：asp.net-mvc, entity-framework, initialization, sql-server-ce, seeding

我在将数据初始化到`.sdf`.NET Web 应用程序中的 SQL Server Compact 数据文件时遇到问题。

我有一个数据初始化类。

```
namespace R10491.Models
{
    public class SampleData : DropCreateDatabaseAlways<LibraryEntities>
    {
        protected override void Seed(LibraryEntities context)
        {
            var categories = new List<Category>
            {
                new Category{Id=1, Name="Sci-fi"}
            };

        }
    }
} 
```

（出于测试目的，我使用`DropCreateDatabaseAlways`而不是`DropCreateDatabaseIfModelChanges`）

我在文件中调用的这个初始化程序类`Global.asax.cs`：

```
protected void Session_Start()
{
   System.Data.Entity.Database.SetInitializer(new R10491.Models.SampleData());
} 
```

（再次出于测试目的，我在每次会话开始时调用它）。

我的连接字符串定义：

```
 <connectionStrings>
    <add name="LibraryEntities"
     connectionString="Data Source=C:\Users\Administrator\Documents\Visual Studio 2012\Projects\2OBOP3_KU1\R10491\App_Data\R10491_library.sdf;"
     providerName="System.Data.SqlServerCe.4.0"/>
  </connectionStrings> 
```

但是初始化不起作用 -`SampleData`类中定义的表没有创建，也没有初始化数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:12:25.737

看起来您忘记将刚刚创建的添加`Category`到数据库表中。如果您不将其添加到`context`' 表中，`Entity Framework`则不会看到任何内容...所以您必须执行以下操作：

```
protected override void Seed(LibraryEntities context)
{
    var categories = new List<Category>
    {
        new Category{Id=1, Name="Sci-fi"}
    };

    foreach(Category c in categories)
    {
        context.Categories.Add(c)
    }

    // Call the Save method in the Context
    context.SaveChanges();  
} 
```

* * *

对于 DataSource 问题，试试这个修改后的连接字符串：

```
<add name="LibraryEntities"
     connectionString="DataSource=|DataDirectory|R10491_library.sdf"
     providerName="System.Data.SqlServerCe.4.0" /> 
```

在我的一个项目中，我有这个连接字符串：

```
<add name="FitnessCenterContext"
     connectionString="DataSource=|DataDirectory|FitnessCenter.Model.FitnessCenterContext.sdf"
     providerName="System.Data.SqlServerCe.4.0" /> 
```

请注意，数据库名称与命名空间和上下文名称相匹配。

* * *

我也`Application_Start()`用来调用文件中的`SetInitializer`方法`Global.asax.cs`。我看到你在里面调用它`Session_Start()`。也许这就是问题所在...将您的代码更改为：

```
protected void Application_Start()
{
     System.Data.Entity.Database.SetInitializer(new R10491.Models.SampleData());
} 
```

* * *

您也可以尝试调用该`Initialize`方法：

```
protected void Application_Start()
{
     System.Data.Entity.Database.SetInitializer(new R10491.Models.SampleData());

     using (var context = new LibraryEntities())
     {
         context.Database.Initialize(true);
     }
} 
```

# c++ - QTableWidget 更新项目

> ID：14103643
> 
> 赞同：2
> 
> 时间：2012-12-31T16:02:25.343
> 
> 标签：c++, qt

我在更新 QTableWidgetItems 时遇到问题。我不明白我做错了什么:(

代码和解释。

一步一步的问题。

1.  在第一次插入 = OK，所有第一个单元格都被填充。
2.  更新第一个插入的项目 = OK，所有第一个单元格都被更新。
3.  在第二次插入 = OK 时，所有第二个单元格都已填充。
4.  更新第二个插入的项目 = OK，所有第二个单元格都被更新。
5.  更新第一个插入的项目 = FAIL，所有第一个单元格都被更新，但 NEXT 单元格的第一个表是空的。为什么？

代码：

```
void MainWindow::fillTable(QList<QByteArray> Info)
{
    int Row = ui->clientsList->rowCount() - 1; //Starts from 0.

    //Check if client row already exists.
    for(int i = Row; i >= 0; i--)
    {
        if(ui->clientsList->item(i, 0)->text().contains(QString(Info[1])))
        {
            //Update row.
            for(int u = 0; u < Info.count() - 1; u++)
            {
                ui->clientsList->setItem(i, u, new QTableWidgetItem(QString(Info[u + 1])));
            }

            return; //avoid new row insertion.
        }
    }

    //Insert new row.
    Row = ui->clientsList->rowCount() + 1;
    ui->clientsList->setRowCount(Row);
    for(int i = 0; i < Info.count() - 1; i++)
    {
        //Fill rows.
        ui->clientsList->setItem(Row - 1, i, new QTableWidgetItem(QString(Info[i + 1])));
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:40:41.833

Not full solution yet, but few comments:

1.There may be memory leak in line

```
ui->clientsList->setItem(i, u, new QTableWidgetItem(QString(Info[u + 1]))); 
```

why not use

```
 ui->clientsList->item(i, u)->setText(QString(Info[u + 1])); 
```

which is safer and more clear.

2.My understanding is you are relying on the fact that Info has same length as the row length is, perhaps it worth to add check for that?

# 960.gs - 为什么这个网站看起来比它的 960px 宽？

> ID：14103647
> 
> 赞同：-1
> 
> 时间：2012-12-31T16:02:40.683
> 
> 标签：960.gs

[http://www.zara.com/webapp/wcs/stores/servlet/category/uk/en/zara-neu-W2012-s/317582/Coats#product=827429](http://www.zara.com/webapp/wcs/stores/servlet/category/uk/en/zara-neu-W2012-s/317582/Coats#product=827429) 我检查了它的元素，身体是745侧边栏大约是 120 - 那么它怎么看起来这么宽呢？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:08:44.227

它“看起来很宽”，因为左侧的侧边栏设置为屏幕左侧的固定位置，因此当在更宽的显示器上显示时，侧边栏始终保持在屏幕的最左侧，而主 div 会进行一些反应性调整大小和停留在中心。

# ios - 向客户分发内部 iOS 应用程序，无需分发源代码

> ID：14103653
> 
> 赞同：1
> 
> 时间：2012-12-31T16:03:15.547
> 
> 标签：ios, key, private, ipa

我们创建了一个 IOS 应用程序并希望将其分发给我们的客户。问题是我们不能给他们我们的源代码，他们也不能给我们他们的私钥。我们如何将 iOS 应用分发给我们的客户？我们现在有三个不同的客户。

我们可以在没有代码签名的情况下创建一个 ipa，然后将其提供给我们的客户并让他们对`.ipa`文件进行代码签名吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T16:09:59.467

只需给他们IPA。使用您的密钥对其进行签名可能比根本不签名更容易 - 它是否已经签名并不重要。`codesign`IPA 可以像普通 zip 文件一样解压缩，然后使用该工具重新签名，[如该问题的答案所示](https://stackoverflow.com/questions/5160863/how-to-re-sign-the-ipa-file)。然后他们可以重新压缩它以获得正确签名的 IPA 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:06:39.263

例如，您可以使用 Testflight。或 Ad-Hoc 分发。

# javascript - 与多个用户一起访问 Mongoose 中的不同级别

> ID：14103655
> 
> 赞同：0
> 
> 时间：2012-12-31T16:03:28.137
> 
> 标签：javascript, node.js, express, mongoose

我有这个模型：

```
var userschema = new mongoose.Schema({
  user: String,
  imagen: [{ 
              title: String,
              author: String,
              index: Number,
              date: { type: Date, default: Date.now },
              comments: [{
                         user: String,
                         body: String,
                         date: { type: Date, default: Date.now }
                 }]
           }],
  }); 
```

我知道如何设置，例如图片的作者，但我不知道如何搜索指定图片的日期。

而且，如果我想搜索多个用户的图像，我如何按时间顺序显示这些图像，作为 Twitter 的时间线。我使用 EJS 作为模板，在服务器端使用 Express.js，我该如何做那个图像时间线？我什至不知道如何访问指定的图像日期，所以，我是一个真正的猫鼬初学者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T13:55:10.613

您正在使用“时间”组件存储日期，因此如果要检索特定日期的数据，则必须设置一整天的时间间隔：

```
var query = userschema.find( 
{"imagen.date": {"$gte": new Date(2013, 1, 7), "$lt": new Date(2013, 1, 8)}});

query.sort({"imagen.date":1}).exec(callback); 
```

# jquery - 从 json 解析图像

> ID：14103659
> 
> 赞同：0
> 
> 时间：2012-12-31T16:03:50.400
> 
> 标签：jquery, html, json

[http://api.wunderground.com/api/102376e7c0e1c995/geolookup/conditions/q/IA/Cedar_Rapids.json](http://api.wunderground.com/api/102376e7c0e1c995/geolookup/conditions/q/IA/Cedar_Rapids.json)

这是获取爱荷华州锡达拉皮兹天气状况的 .json 文件。在这个 json 文件中，有一个变量给出了天气图标的条件。我想看到使用 ID 将此图像放入 html 中。

```
<html>
<head>
<script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
</head>
<body>
<h1 id='meteo'></h1>
<script type="text/javascript">
jQuery(document).ready(function($) {
    var state = 'CA';
    var city = 'San_Francisco';
    var URL = 'http://api.wunderground.com/api/102376e7c0e1c995/geolookup/conditions/q/' + state + '/' + city + '.json';
    $.ajax({ 
        url : URL, 
        dataType : "jsonp", 
        success : function(parsed_json) { 
            var location = parsed_json['location']['city']; 
            var temp = parsed_json['current_observation']['temperature_string'];
            var wicon = parsed_json['current_observation']['icon_url'];
            $("#meteo").text(temp); 
        }
    });
}); 
</script>
</body>
what can i do
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:10:18.217

只需创建一个具有正确 src 属性的 img 标签。

```
$( '<img>' ).attr( 'src', wicon ).appendTo( '#meteo' ); 
```

演示：http: [//jsfiddle.net/dAz2p/](http://jsfiddle.net/dAz2p/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T16:10:46.140

作为脚本的最后一行，添加：

```
$("#meteo").append('<img src="' + wicon + '"/>"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T16:08:30.687

您只需要分配`wicon`给`src`占位符图像的属性

**编辑：**代码，按要求。

首先，在要显示最终图标的位置放置一个占位符图像：

```
...
<img id='meteo_icon' src='meteo_loading.png'>
<h1 id='meteo'></h1>
... 
```

然后，在分配文本时，还要分配 src：

```
...
$("#meteo").text(temp);
$("#meteo_icon").attr("src", wicon);
... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T16:10:57.913

在页面上放置一个图像元素（比如 id Image1），然后：

```
 success: function (parsed_json)
    {
        var location = parsed_json['location']['city'];
        var temp = parsed_json['current_observation']['temperature_string'];
        var wicon = parsed_json['current_observation']['icon_url'];
        $("#meteo").text(temp);

        $("#Image1").attr("src", wicon);
     } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-31T16:14:40.310

请添加具有正确属性的图像标签。

```
$( '<img>' ).attr( 'src', wicon ).appendTo( '#meteo' ); 
```

检查自己：http: [//jsfiddle.net/dAz2p/](http://jsfiddle.net/dAz2p/)

# javascript - node.js 同步版 http.get

> ID：14103662
> 
> 赞同：5
> 
> 时间：2012-12-31T16:04:05.593
> 
> 标签：javascript, node.js, http, testing

我想编写一个测试器来测试我为课堂编写的 http 服务器。我需要一个同步版本的 http.get/http.post

我想用“测试”方法制作一个对象，如果测试通过，该方法将返回真或假，但找不到让代码等到服务器响应获取请求的方法。

关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:37:29.463

如果没有可怕的、忙于等待的黑客，你就无法用 Node.js 做到这一点。使您的`test`方法也异步，调用回调参数将测试结果返回给调用者。或者使用不同的语言进行单元测试。

# php - Group-Concat 和 GROUP BY 的问题

> ID：14103664
> 
> 赞同：0
> 
> 时间：2012-12-31T16:04:07.543
> 
> 标签：php, mysql

我试图接受这个查询：

```
SELECT
    events.ID,
    events.EVENT_NAME,
    GROUP_CONCAT(music_styles.MUSIC_STYLE_NAME) AS MUSIC_STYLE_NAME
FROM events
INNER JOIN events_music_styles
    ON events.ID = events_music_styles.event_id
INNER JOIN music_styles
    ON events_music_styles.music_style_id = music_styles.id
GROUP BY events.ID 
```

效果很好，我做了这个：

```
$id = (int) $_GET['id'];
$data2 = mysql_query("
SELECT 
    events.ID,
    events.EVENT_NAME,
    events.SHORT_EVENT_DESC,
    events.SMALL_POSTER_URL,
    events.start_datetime,
    events.VENUE_LOCATION
    GROUP_CONCAT(music_styles.MUSIC_STYLE_NAME) AS MUSIC_STYLE_NAME
FROM 
    venues
INNER JOIN events
    ON events.VENUE_LOCATION = venues.ID 
INNER JOIN events_music_styles
    ON events.ID = events_music_styles.event_id
INNER JOIN music_styles
    ON events_music_styles.music_style_id = music_styles.id
WHERE
    events.VENUE_LOCATION = venues.ID
AND
    WHERE start_datetime >= '$DATE_START_SELECTED'
AND 
    venues.id = ".$id."
GROUP BY events.start_datetime) or die(mysql_error()); 
```

这给了我两个错误：

*首先是与集团 Concat：*

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以了解在 'GROUP_CONCAT(music_styles.MUSIC_STYLE_NAME) AS MUSIC_STYLE_NAME FROM avenues IN' 附近使用的正确语法

我知道我主要从`venues`表格中检索数据，但是加入`events`表格时是否重要？

*第二个是`Group by`我有：*

> 解析错误：语法错误，意外的 T_ENCAPSED_AND_WHITESPACE，需要 T_STRING 或 T_VARIABLE 或 T_NUM_STRING

我以为我关闭了所有字符串，所以我不确定它为什么会这样做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T16:05:52.563

前面少了一个逗号`GROUP_CONCAT`，仅此而已！

**编辑：**

第二个也是错字：最后一行缺少引号，

```
GROUP BY events.start_datetime) or die(mysql_error()); 
```

应该

```
GROUP BY events.start_datetime") or die(mysql_error()); 
```

# haskell - 如何在 Haskell 中使用 Cairo 绘制 X11 Drawable

> ID：14103667
> 
> 赞同：5
> 
> 时间：2012-12-31T16:04:21.773
> 
> 标签：haskell, x11, cairo, xlib, surface

我最近在 Haskell 中进行了 X11 编程的第一步，现在我想使用 Cairo/Pango 绘制文本。我找到了一些 C 教程，似乎我需要[使用`cairo_xlib_surface_create()`](http://cairographics.org/manual/cairo-XLib-Surfaces.html#cairo-xlib-surface-create).
Cairo有一个[Haskell 包装器](http://hackage.haskell.org/packages/archive/cairo/0.12.4)，但似乎缺少此功能的包装器。
然而，似乎仍然有一种方法可以直接在 Cairo 的 X11 窗口上绘图，因为 Surface 的文档[提到了 Xlib 后端](http://hackage.haskell.org/packages/archive/cairo/0.12.4/doc/html/Graphics-Rendering-Cairo.html#v%3asurfaceFinish)。
但我找不到任何进一步的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:30:26.177

文件说

请注意，Haskell 绑定不支持所有可能的 cairo 后端，因为它需要相关技术（例如 X11、glitz 等）的绑定，但是可以在外部实现与其他后端的绑定。例如，Gtk2Hs 为 X11（和 Windows 上的 win32）提供了到后端的绑定。

因此，您似乎必须使用 gtk2hs，或者自己使用所需的绑定。

# javascript - 我的选择器选择所有元素，如何选择一些？

> ID：14103671
> 
> 赞同：0
> 
> 时间：2012-12-31T16:04:27.520
> 
> 标签：javascript, jquery, ruby-on-rails-3

我正在制作一个小脚本出现/消失，但我的 jquery 元素全选，我想如果我为所有人创建一个独特的类是非常类的使用，我更喜欢使用 jquery 的**$this**的一种模式，但我不知道，我的代码是ruby on rails 是这样的......：

```
<%= link_to_function "Comentar","$(this(div #comment_form)).fadeIn();",:class => 'comentar' %> 
```

但选择所有帖子以显示评论框

和我的 aplication.js 消失默认：

```
$(document).ready(function(){

$("div #comment_form").hide();

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:59:15.850

如果您想影响页面上的特定元素，则需要在每个元素上设置 id 属性。所以你可能有这样的事情：

```
<% @things.each do |t| %>
  <div id='comment_<%= t.id %>' style='display:none'>
    A Comment 
  </div>
  <%= link_to_function "Comment #{t.id}","$('#comment_#{t.id}').fadeIn();" %>
<% end %> 
```

# php - 尝试进入控制器时出现 Kohana 错误 (ERR_EMPTY_RESPONSE 324)

> ID：14103675
> 
> 赞同：0
> 
> 时间：2012-12-31T16:04:48.513
> 
> 标签：php, kohana

尝试访问时，我在 Kohana 中不断收到此错误

[http://example.com/dailysales](http://example.com/dailysales)

当我在生产时。在本地它工作正常..当尝试在产品上输入通知时它也可以工作..我的引导程序是一样的..

这是我的引导路线

```
Route::set('notifications', '(<controller>)(/<action>)', array('controller' => 'notifications|dailysales', 'action' => 'index|send'))
->defaults(array('controller' => 'notifications', 'action' => 'index'));

Route::set('sales', 'sales(/<action>)', array('action' => 'index|export'))
->defaults(array('controller' => 'sales', 'action' => 'index')); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T06:58:47.433

首先，第一条路线不应该有 2 个可选参数。其次，在你的 pcre 正则表达式中加上一些括号。第三，更具体的路线应该总是先走：

```
Route::set('sales', 'sales(/<action>)', array('action' => '(index|export)'))
->defaults(array(
  'controller' => 'sales', 
  'action' => 'index'
));

Route::set('notifications', '<controller>(/<action>)', array(
   'controller' => '(notifications|dailysales)', 
   'action' => '(index|send)'
))
->defaults(array(
   'controller' => 'notifications', 
   'action' => 'index'
)); 
```

最后，检查您`Kohana::$environment`的设置是否正确以及“开发”是否与“生产”有任何差异（每个环境的配置不同）。最后“责备”的是 PHP 版本。

# java - LWJGL 渲染器需要 GLSL 和 OpenGL2

> ID：14103679
> 
> 赞同：2
> 
> 时间：2012-12-31T16:05:08.997
> 
> 标签：java, opengl, glsl, jmonkeyengine, video-card

我的第一个 JMonkeyEngine 程序有问题。我得到这个：

```
java.lang.UnsupportedOperationException: GLSL and OpenGL2 is required for the LWJGL renderer!
    at com.jme3.renderer.lwjgl.LwjglRenderer.initialize(LwjglRenderer.java:165)
    at com.jme3.system.lwjgl.LwjglContext.initContextFirstTime(LwjglContext.java:231)
    at com.jme3.system.lwjgl.LwjglContext.internalCreate(LwjglContext.java:271)
    at com.jme3.system.lwjgl.LwjglAbstractDisplay.initInThread(LwjglAbstractDisplay.java:117)
    at com.jme3.system.lwjgl.LwjglAbstractDisplay.run(LwjglAbstractDisplay.java:207)
    at java.lang.Thread.run(Unknown Source) 
```

我知道这是因为我需要 GLSL 和 OpenGL2（在[此处](http://jmonkeyengine.org/forum/topic/where-can-i-get-glsl-and-opengl2/)找到）但我似乎已经拥有最新的显卡驱动程序：

![已安装适合您设备的最佳驱动程序软件](../Images/9d4ff4e9d18691aeb3ad5f89e885a3d0.png)

我怎样才能解决这个问题？（注意：我在[这里](http://jmonkeyengine.org/wiki/doku.php/jme3:beginner:hello_simpleapplication)学习教程）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:12:54.847

> [Intel(R) G33/G31 Express 芯片组家族](http://en.wikipedia.org/wiki/Comparison_of_Intel_graphics_processing_units#Third_generation)
> 
> 我怎样才能解决这个问题？

安装更新的 OpenGL 实现。

[梅萨](http://www.mesa3d.org/)有一个免费的。不过可能有点慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:09:09.437

Windows 支持 OpenGL 1.4 或类似的东西。您应该从供应商网站下载驱动程序。例如英伟达网站

# html - 在 Rails 中使用引导程序时，将窗口大小调整为小时，“nav pull-right”的内容会消失

> ID：14103688
> 
> 赞同：1
> 
> 时间：2012-12-31T16:05:53.403
> 
> 标签：html, css, ruby-on-rails, ruby, sass

我正在使用引导程序来创建类似应用程序的 twitter。当窗口大小调整为小时，导航栏上的“nav pull-right”下的内容会消失。我怎么做？这是我的erb文件..

```
<header class="navbar navbar-fixed-top navbar-inverse">
  <div class="navbar-inner">
    <div class="container">
      <%= link_to "cntwitter", root_path, id: "logo" %>
      <nav>
        <ul class="nav pull-right" id="right_nav">
          <li><%= link_to "Home", root_path %></li>
          <% if signed_in? %>
            <li><%= link_to "Users", users_path %></li>
            <li id="fat-menu" class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"> Account <b class="caret"></b> </a>
              <ul class="dropdown-menu">
                <li><%= link_to "Profile", current_user %></li>
                <li><%= link_to "Settings", edit_user_path(current_user) %></li>
                <li class="divider"></li>
                <li>
                  <%= link_to "Sign out", signout_path, method: "delete" %>
                </li>
              </ul>
            </li>
          <% else %>
            <li><%= link_to "Sign in", signin_path %></li>
          <% end %>
        </ul>
      </nav>
    </div>
  </div>
</header> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:23:42.397

twitter 引导脚手架或网格默认情况下是静态的。听起来您希望网页的内容随浏览器窗口缩放。在这种情况下，我建议使用“流体”脚手架 :: [http://twitter.github.com/bootstrap/scaffolding.html#fluidGridSystem](http://twitter.github.com/bootstrap/scaffolding.html#fluidGridSystem)

# c# - 在派生类中可克隆

> ID：14103693
> 
> 赞同：4
> 
> 时间：2012-12-31T16:06:20.777
> 
> 标签：c#, icloneable

假设我有一个类`A`，`B`它派生自`A`：

```
class A : ICloneable
{
    public object Clone() {...}
}

class B : A, ICloneable
{
    public object Clone() {...}
} 
```

这使

```
'B.Clone()' hides inherited member 'A.Clone()'. Use the new keyword if hiding was intended. 
```

警告。

(1) 建议的方法是什么？使用`new`或声明`A.Clone()`as`virtual`和`override`in `B`?

(2) 如果有一些成员 in`A`并正确克隆 in `A.Clone()`，是否有一种简单的方法可以克隆它们，`B.Clone()`或者我是否也必须显式克隆它们`B.Clone()`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-31T16:16:26.987

如果您可以访问您的源（我猜这里就是这种情况），那么绝对将其声明为`virtual`并覆盖它。如果隐藏基地可能是个坏主意`Clone`。`new`如果任何代码不*知道*它正在使用 a `B`，那么它将触发*错误*的克隆方法并且不会返回正确的克隆。

关于属性的分配，也许考虑实现复制构造函数，每个级别都可以处理自己的克隆：

```
 public class A : ICloneable
    {
        public int PropertyA { get; private set; }

        public A()
        {

        }

        protected A(A copy)
        {
            this.PropertyA = copy.PropertyA;
        }

        public virtual object Clone()
        {
            return new A(this);
        }
    }

    public class B : A, ICloneable
    {
        public int PropertyB { get; private set; }

        public B()
        {

        }

        protected B(B copy)
            : base(copy)
        {
            this.PropertyB = this.PropertyB;
        }

        public override object Clone()
        {
            return new B(this);
        }
    } 
```

每个复制构造函数调用基本复制构造函数，将自身传递到链中。每个继承级别直接复制属于它的属性。

编辑：如果您使用`new`关键字来隐藏基本实现，这里有一个可能发生的例子。使用示例实现（表面上看起来不错）

```
public class A : ICloneable
{
    public int PropertyA { get; protected set; }

    public object Clone()
    {
        Console.WriteLine("Clone A called");
        A copy = new A();
        copy.PropertyA = this.PropertyA;
        return copy;
    }
}

public class B : A, ICloneable
{
    public int PropertyB { get; protected set; }

    public new object Clone()
    {
        Console.WriteLine("Clone B called");
        B copy = new B();
        copy.PropertyA = this.PropertyA;
        copy.PropertyB = this.PropertyB;
        return copy;
    }
} 
```

但是当你使用它时：

```
B b = new B();
A a = b;
B bCopy = (B)a.Clone();
//"Clone A called" Throws InvalidCastException! We have an A! 
```

# ruby-on-rails - 传递 JSON 参数以更新 Rails 模型

> ID：14103696
> 
> 赞同：1
> 
> 时间：2012-12-31T16:06:41.783
> 
> 标签：ruby-on-rails, ruby-on-rails-3, json, jquery

我正在尝试通过 JSON 更新模型。现在我能够执行 put 方法。

从我的浏览器控制台中，我看到了这一点，所以我相信我的请求确实通过了。

```
PUT http://localhost:3000/slot_allocations/1 [HTTP/1.1 200 OK  7ms] 
```

但是，我不太确定如何让 Rails 接受我想要更新的数据，如果有人可以帮助我，我将不胜感激。

这是我的 Ajax 请求的 Jquery 代码。dataToServer 是我要发送以更新模型的数据。

```
var url = 'slot_allocations/'+alloc_id;
var dataToServer = {slot_allocation:{timeslot:timeslot, subject:subject,slot_allocation_id:alloc_id-1, group_id:"Group 2", lesson_type:"Tutorial"}}

$.ajax({
  type: "PUT",
  url: url, 
  dataType: "json",
  data:  JSON.stringify(dataToServer) , // message to send goes here
  success: function (data)
  {
  }
}); 
```

在控制器中的更新方法中，我有以下代码。

```
 def update
    @slot_allocation = SlotAllocation.find(params[:id])
    respond_to do |format|
      if @slot_allocation.update_attributes(params[:slot_allocation])
        format.html { redirect_to @slot_allocation, notice: 'Slot allocation was successfully updated.' }
        format.json { render :json=>@slot_allocation.as_json }
      else
        format.html { render action: "edit" }
        format.json { render json: @slot_allocation.errors, status: :unprocessable_entity }
        format.js  { render :js => @slot_allocation.errors, :status => :unprocessable_entity }
      end
    end
  end 
```

这是我的 as_json 方法。我将它用于从服务器到客户端的发送请求，但我不太确定是否可以使用相同的方法将信息从客户端发送到服务器端。

```
 def as_json(options={}) 
  {
     :group_id =>self.group_index,
     :lesson_type =>self.lesson_type,
     :timeslot =>self.timeslot_id,
     :subject =>self.subject_id,
     :slot_allocation_id => self.slot_allocation_id
  }
  end 
```

如果有人能指导我，我将不胜感激，因为我不太熟悉如何让 Rails 接受参数来更新模型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:51:16.453

我相信你需要先解析 JSON 参数：

```
attributes = ActiveSupport::JSON.decode(params[:slot_allocation])
if @slot_allocation.update_attributes(attributes)
  ...
end 
```

[如何使用 Ruby on Rails 解析 JSON？](https://stackoverflow.com/questions/1826727/how-do-i-parse-json-with-ruby-on-rails)

# java - jQuery-File-Upload 发送正确的响应

> ID：14103697
> 
> 赞同：0
> 
> 时间：2012-12-31T16:07:04.677
> 
> 标签：java, jquery, google-app-engine

尝试使用 Java App 引擎示例，请[点击此处](https://github.com/blueimp/jQuery-File-Upload/wiki/Google-App-Engine-Java)。我不断收到空上传文件的错误。我的 rest/file/{key}/meta 看起来像这样

```
[{"name":"243739_694783416343_2004680911_o.jpg","size":41992,"url":"/rest/file/4UH8_IOX5NcMXFX8Kfy_BQ","delete_url":"/rest/file/4UH8_IOX5NcMXFX8Kfy_BQ","delete_type":"DELETE"}] 
```

这似乎是一个适当的回应。

我已经意识到图像正在存储到 blobstore。我只需要让客户知道文件已成功上传。

此外，我无法让多个上传工作。第一次上传开始后，上传会话似乎到期。

任何帮助是极大的赞赏。一直在努力完成这个设置。昨天花了一整天时间正确设置球衣以正确输出 json。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T18:52:12.387

Json 需要采用格式

```
{"files":[{"name":"243739_694783416343_2004680911_o.jpg","size":41992,"url":"/rest/file/4UH8_IOX5NcMXFX8Kfy_BQ","delete_url":"/rest/file/4UH8_IOX5NcMXFX8Kfy_BQ","delete_type":"DELETE"}]} 
```

# python - Mac OS Pygame 使用已弃用的函数 CGSFlushWindow

> ID：14103699
> 
> 赞同：5
> 
> 时间：2012-12-31T16:07:12.917
> 
> 标签：python, pygame

我在 OS Mountain Lion 下以 32 位模式运行 Python 2.7.3，我刚刚开始使用 Pygame。我在终端窗口中不断收到以下错误消息：

```
2012-12-31 10:58:03.695 Python[12097:f07] Warning once: This application, or a library it
uses, is using NSQuickDrawView, which has been deprecated. Apps should cease use of 
QuickDraw and move to Quartz.

Dec 31 10:58:03 bigden.local Python[12097] <Error>: The function `CGSFlushWindow' is 
obsolete and will be removed in an upcoming update. Unfortunately, this application, or a 
library it uses, is using this obsolete function, and is thereby contributing to an 
overall degradation of system performance. Please use `CGSFlushWindowContentRegion' 
instead. 
```

有什么办法可以避免这种情况？Pygame 有修复吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-01T00:42:41.733

尝试安装[1.9.2pre](http://www.pygame.org/ftp/pygame-1.9.2pre-py2.7-macosx10.7.mpkg.zip)版本。我不再收到这些错误。

# ios - 丢失的手势 iPad 风景

> ID：14103700
> 
> 赞同：0
> 
> 时间：2012-12-31T16:07:23.460
> 
> 标签：ios, uiwebview, uigesturerecognizer, uisplitviewcontroller

我有一个应用程序，其中`MGSplitView`包含一个表格视图和一个`UIWebView`固定为横向的应用程序。Web 视图有一个`UITapGestureRecognizer`（用于三次点击）附加到 Web 视图。在 web 视图的左侧部分中的点击工作；Web 视图右侧的点击丢失 - 未触发操作，也未收到手势委托消息。

问题似乎不在于`MGSplitViewController`，因为切换到 a`UISplitViewController`也有同样的问题；从点击更改为长按也有相同的结果。

轻按位置报告的 x 坐标等于或接近于gesture.view 的最大宽度，但显然靠近显示器的中心，我希望这与问题的根源有关 - 然而Web 视图内容清晰可见并正确放置。

所涉及的所有视图控制器都实现了`shouldAutorotate`and `supportedInterfaceOrientations`，因此似乎不太可能陷入纵向，即`MGSplitViewController`我的`UITableView`子类（左侧面板）和`UIViewController`右侧面板的子类。

我的手势识别器委托和输出一次三次点击（右侧面板 Web 视图中的视图）：

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch {
    NSLog(@"%s", __PRETTY_FUNCTION__);
    NSLog(@"gestureRecognizer view frame: %@", NSStringFromCGRect(gestureRecognizer.view.frame));
    NSLog(@"location %@", NSStringFromCGPoint([gestureRecognizer locationInView:gestureRecognizer.view]));
    return YES;
}

-[DocumentBrowser gestureRecognizer:shouldReceiveTouch:]
gestureRecognizer view frame: {{0, 0}, {703, 704}}
location {703, -20}
-[DocumentBrowser gestureRecognizer:shouldReceiveTouch:]
gestureRecognizer view frame: {{0, 0}, {703, 704}}
location {414.5, 204.5}
-[DocumentBrowser gestureRecognizer:shouldReceiveTouch:]
gestureRecognizer view frame: {{0, 0}, {703, 704}}
location {414.5, 204.5} 
```

报告的第一个位置似乎很奇怪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:14:11.413

检查您的方向和视图大小调整机制。当这些区域出现问题时，我已经多次看到这种情况 - 如果您记录触摸位置，我想您可能会发现它们在左侧 768 点处停止，即某处有一个认为它的视图是纵向的。

# php - PHP将除某些单词外的所有字母（包括斜线后）大写

> ID：14103702
> 
> 赞同：3
> 
> 时间：2012-12-31T16:07:38.940
> 
> 标签：php, string, capitalization

我想使用 PHP 通过大写每个单词来清理一些标题，包括斜线后面的那些。但是，我不想将单词“and”、“of”和“the”大写。

下面是两个示例字符串：

> 会计技术/技术员和簿记
> 
> 脊柱骨科手术

应更正为：

> 会计技术/技术员和簿记
> 
> 脊柱整形外科

* * *

这是我目前拥有的。我不确定如何将内爆与 preg_replace_callback 结合起来。

```
// Will capitalize all words, including those following a slash
$major = implode('/', array_map('ucwords',explode('/',$major)));

// Is supposed to selectively capitalize words in the string
$major = preg_replace_callback("/[a-zA-Z]+/",'ucfirst_some',$major);

function ucfirst_some($match) {
   $exclude = array('and','of','the');
   if ( in_array(strtolower($match[0]),$exclude) ) return $match[0];
   return ucfirst($match[0]);
} 
```

* * *

现在它将字符串中的所有单词大写，包括我不想要的单词。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-31T16:22:16.877

好吧，我打算尝试对 进行递归调用`ucfirst_some()`，但是您的代码在没有第一行的情况下似乎可以正常工作。IE：

```
<?php
$major = 'accounting technology/technician and bookkeeping';
$major = preg_replace_callback("/[a-zA-Z]+/",'ucfirst_some',$major);
echo ucfirst($major);

function ucfirst_some($match) {
   $exclude = array('and','of','the');
   if ( in_array(strtolower($match[0]),$exclude) ) return $match[0];
   return ucfirst($match[0]);
} 
```

打印所需的`Accounting Technology/Technician and Bookkeeping`.

您的正则表达式已经匹配字符串，您似乎根本不需要担心斜线。请注意，单词中间的数字或符号 [如连字符] 也会导致大写。

此外，不要理会那些喋喋不休地指责你的`$exclude`阵列不够完整的人，你总是可以在遇到他们时添加更多的词。或者只是谷歌列表。

[应该注意的是，没有单一的、商定的“正确”方式来确定应该/不应该以这种方式大写的内容。](https://writers.stackexchange.com/questions/4621/which-words-should-not-be-capitalized-in-title-case)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T16:22:47.340

您还想确保在句子开头使用诸如 an 和 the 之类的词是否都是大写字母。

注意：我想不出任何以 of 或 和 开头的术语，但在奇怪的数据潜入您的程序之前更容易解决此类问题。

我以前在 [http://codesnippets.joyent.com/posts/show/716上使用过一个代码片段](http://codesnippets.joyent.com/posts/show/716)

它在评论部分 [http://php.net/manual/en/function.ucwords.php#84920的 ucwords 的 php.net 功能页面上被引用](http://php.net/manual/en/function.ucwords.php#84920)

# ios - 故事板两个场景。从场景 2 中的 UITableViewCell 获取文本到场景 1 中的 UILabel

> ID：14103720
> 
> 赞同：0
> 
> 时间：2012-12-31T16:09:30.760
> 
> 标签：ios, uitableview, storyboard, scene

我在故事板中有两个场景。由于我不允许上传图片（新用户），我们称它们为场景 1 和场景 2。

Scene 1: UITableViewCell with a UILabel, when this cell is selected, it takes you to Scene 2\.
Scene 2: Provides users options to select in UITableView. 一旦选择了一个选项，它就会在选定的 UITableViewCell 旁边放置一个复选标记。

当您单击场景 2 上的保存按钮时，如何获取它，它从场景 2 中选定的 UITableViewCell 中获取文本，并将用户带回场景 1，并使用场景 2 中的文本填充 UILabel？

我使用故事板来创建 UITableViews。每个单元格都有自己的类。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:31:25.397

使用委托设计模式允许两个对象相互通信（[Apple 参考](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/CocoaFundamentals/CommunicatingWithObjects/CommunicateWithObjects.html#//apple_ref/doc/uid/TP40002974-CH7-SW18)）。

一般来说：

1.  在场景 2 中创建一个名为委托的属性。
2.  在场景 2 中创建一个协议，定义场景 2 委托必须定义的方法。
3.  在场景 1 到场景 2 的转场之前，将场景 1 设置为场景 2 的代理。
4.  当在场景 2 中选择了一个单元格时，向场景 2 的代理发送消息以通知代理选择。
5.  允许代理处理选择并在选择完成后关闭场景 2。

作为一个例子：

场景二界面

```
@class LabelSelectionTableViewController

@protocol LabelSelectionTableViewControllerDelegate
  - (void)labelSelectionTableViewController:(LabelSelectionTableViewController *)labelSelectionTableViewController didSelectOption:(NSString *)option;
@end

@interface LabelSelectionTableViewController : UITableViewController
  @property (nonatomic, strong) id <LabelSelectionTableViewControllerDelegate> delegate;
@end 
```

场景二实现

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
  UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];   
  [self.delegate labelSelectionTableViewController:self didSelectOption:cell.textLabel.text];
} 
```

场景一实现

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
  if ([segue.destinationViewController isKindOfClass:[LabelSelectionTableViewController class]] == YES)
  {
    ((LabelSelectionTableViewController *)segue.destinationViewController).delegate = self;
  }
}

// a selection was made in scene 2
- (void)labelSelectionTableViewController:(LabelSelectionTableViewController *)labelSelectionTableViewController didSelectOption:(NSString *)option
{
  // update the model based on the option selected, if any    
  [self dismissViewControllerAnimated:YES completion:nil];
} 
```

# jquery - 自定义可选项卡 DIV 元素虚线边框应用不一致

> ID：14103722
> 
> 赞同：0
> 
> 时间：2012-12-31T16:09:44.853
> 
> 标签：jquery, focus, tabindex, outline

因此，我开发了一些 jQuery 功能，可以找到一个 <SELECT> 元素，将其隐藏，然后用一个充满图像的 <DIV> 替换它。<DIV> 允许用户进入它，然后，它侦听左/右箭头按键事件，突出显示适当的图像（即，将所需的 img 设置为完全不透明，使其他图像变灰）。您可以将其与传统的 HTML 进行比较，在传统 HTML 中，您可以通过选项卡选择 SELECT 并使用向上/向下键来更改所选项目。

我使用通过 jQuery 添加的基本 HTML 来添加新的可选项卡 DIV 元素：

> jQuery('#desiredOuterDomObjectID').prepend("<div tabindex='0' id='mnu1'>");

这适用于我表单上 3 个 SELECT 元素中的 2 个。

所以，这里是第三个 SELECT 元素的问题：我将无数的 jQuery 函数更进一步，并将它们包装到一个适当的插件中。我的代码的插件版本还创建了一个完美工作的、可选项卡的 <DIV> ，其中包含可以键入的 IMG 对象的内部数组。唯一的区别是：*虚线高亮边框框不会出现在这个特定的 <DIV> 元素上*。

当然，目标是在整个 HTML 表单中使用我的“改进”插件代码，并放弃我早期的开发工作.. 除了我似乎无法让我的插件在其他正常的可选项卡 DIV 上创建可见边框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T21:16:38.017

我终于弄清楚了我的 DIV 元素之间的区别。

除了我添加到它们中的 tabindex 属性之外，前两个元素（当它们成为焦点时正确显示了虚线轮廓）似乎还分配了某种类型的*height属性。*

胭脂 DIV 元素（也包含 tabindex 属性）没有指定任何高度（我认为它可能会自动获得高度，因为它包含 IMG 元素，类似于其他 DIV 元素）。

一旦我使用 javascript 为其 style.height 属性分配像素值，指示选项卡焦点的虚线边框开始正确显示。

# sql - JPA - 更新嵌入式实体会生成无效的 SQL

> ID：14103723
> 
> 赞同：7
> 
> 时间：2012-12-31T16:09:48.293
> 
> 标签：sql, entity, updating

我正在尝试更新嵌入式实体，而 JPA 似乎生成了错误的 SQL。

我有一个带有嵌入式徽标实体的公司实体

```
@Entity
public class Company {

  private Long id;
  @Embedded
  private Logo logo;

  // Omitted other fields, getters, setters, etc

}

@Embeddable
public class Logo {

  private String fileName;
  private String fileExtension;
  private String imageDataType;

  // Omitted getters and setters
} 
```

在我的 DAO 方法中，我试图像这样更新嵌入式徽标：

```
@Override
public void setLogo(Logo logo, Long companyId) {
    String q = "update Company c SET c.logo = :logo where c.id = :companyId";
    Query query = entityManager.createQuery(q);
    query.setParameter("companyId", companyId);
    query.setParameter("logo", logo);
    query.executeUpdate();
} 
```

JPA（实际上是 Hibernate）生成以下 SQL。

```
update px_company set file_extension, file_name, file_type=(?, ?, ?) where id=? 
```

Hibernate 似乎明白它必须更新三个嵌入的徽标字段，但它会为它生成无效的 SQL。生成的 SQL 会导致错误。

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' file_name, file_type=('jpg', '7679075394', 0) where id=1' at line 1 
```

知道我应该如何更新嵌入式实体吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-10-29T18:27:53.437

有点旧但只是有同样的问题 - 你应该完全解决 JPQL 中嵌入类的属性：

```
update Company c
SET c.logo.fileName = :fileName
    ,c.logo.fileExtension = :fileExtension
    ,c.logo.imageDataType= :imageDataType
where c.id = :companyId 
```

# wordpress - 如何在 WordPress 中添加不同类型的帖子？

> ID：14103724
> 
> 赞同：0
> 
> 时间：2012-12-31T16:09:53.163
> 
> 标签：wordpress, custom-post-type

这是一个模糊的问题，我在谷歌上搜索过，结果很短。我想创建一种称为`Employee`. 他应该附有 2 张图片、一些文字、Facebook 个人资料（可选）等。我可以创建一个内容类型来处理这个吗？我已经尝试过[自定义帖子类型 UI](http://wordpress.org/extend/plugins/custom-post-type-ui/)插件，但这仍然给了我一个标准类型的帖子，本质上只是一个新类别。那不是我想要的。我希望添加/编辑帖子屏幕能够布置这些选项。我可以使用自定义字段很好地处理静态内容。困难的部分是图像上传。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:46:56.373

[哇，使用名为Advanced Custom Fields](http://www.advancedcustomfields.com/)的插件很容易做到

# jquery - 我在 jquery 的单击事件上遇到了一些错误-“未定义”的事件处理程序中的错误：INDEX_SIZE_ERR

> ID：14103725
> 
> 赞同：0
> 
> 时间：2012-12-31T16:09:58.367
> 
> 标签：jquery, click

![在此处输入图像描述](../Images/132c4d896fefd96b4ca24e2423fc9617.png)代码太多，所以我把它们放到 Fiddle 上。[http://jsfiddle.net/ylkwan/XP39S/7/](http://jsfiddle.net/ylkwan/XP39S/7/) ,如果你使用Chrome，按ctrl+shift+j并双击登录按钮或注册按钮。有一些错误发生

css

```
/* Below is Header elements */
#header{
    padding: 4px 4px;
    border-bottom: 1px solid #fff;
    background-color: #777;
    box-shadow: 0 -3px 3px rgba(0,0,0,.5) inset;
    width:1200;
    border-radius: 0 0 5 5;
}

#header #loginpaneldiv{
    float: right;
}

#header #loginpaneldiv ul{
    margin: 0 8 0 0 ;
    padding: 0;
    list-style: none;            
}
#header #loginpaneldiv ul li {
    height :27px;
    padding:0;
    float: left;
    display: inline-block;
}

#header #loginpaneldiv ul li.left {
    border-right: 1px solid #ddd;   
}

#header #loginpaneldiv li a {
    background:#eee;
    height:100%;
    display: inline-block;
    line-height: 25px;
    font-weight: bold;
    padding: 0 8px;
    text-decoration: none;
    color: #444;
    text-shadow: 0 1px 0 #fff;
}

#header #loginpaneldiv ul li.left a{
      border-radius: 2 0 0 2;
}

#header #loginpaneldiv ul li.right a{
      border-radius: 0 2 2 0;
}

#header #loginpaneldiv a:hover
{
     background:#fff;
}

#header .form{
    display: none;
    float: right;
    position: relative;
    top:-2;
    margin: 0px 0px -100% 0px;
    padding: 15px;
    border-bottom: 1px solid #fff;
    border-radius: 3px 0 3px 3px;
    width:250px;
    z-index:100;
    background: #fff;
    background-image: linear-gradient(top, #fff, #eee);
    box-shadow: 0 2px 2px -1px rgba(0,0,0,.9);

} 
```

html

```
<! DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" 
"http://www.w3.org/TR/html4/frameset.dtd" >
<html>

<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>

</head>

<body>
<div id="wrapper">  
    <div id="header">
        <div id="loginpaneldiv">
            <ul>
                <li class="left" id="login">
                    <a href="#">Log in <span>&#x25BC;</span></a>                                
                </li>
                <li class="right" id="signup">
                    <a href="#">Sign up <span>&#x25BC;</span></a>                    
                </li>
            </ul>   
        </div>
        <div style="clear:both"></div>
        <div id="loginformdiv"  class="form">
            <form id="loginform" action="" method="post">
                <input class="textbox" id="email" type="email" name="email" placeholder="Your email address" required>
            </form>
        </div>
        <div id="signupformdiv" class="form">
            <form id="signupform" action="" method="post">
                <input class="textbox" id="lastname" type="text" name="lastname" placeholder="Your Last Name" required>
            </form>
        </div>
    </div>
</div>

</body>

</html>​ 
```

​jQuery

```
$(document).ready(function(){
    function hide($element){
        $element.css('background','#eee');
        $element.find("span").html("&#x25BC;");
        $element.css('hover','#fff');
        $('#'+$element.attr("id")+'formdiv').hide();
    }
    function slideUp($element){
        $element.find("span").html("&#x25BC;");
        $element.css('background','#eee');
        $('#'+$element.attr("id")+'formdiv').slideUp("fast");
    }

    function slideDown($element){
        $element.css('background','#fff');
        $element.find("span").html("&#x25B2;");
        $('#'+$element.attr("id")+'formdiv').slideDown("fast");
    }    
try{
    $("#loginpaneldiv li").click(function(event){
        if($(this).attr("id")=="login"){
            if($('#loginformdiv').is(':visible')){
                hide($("#signup"));
                slideUp($('#login'));
            }else{
                hide($("#signup"));
                slideDown($('#login'));
            }
        }else if($(this).attr("id")=="signup"){
            if($('#signupformdiv').is(':visible')){
                hide($("#login"));
                slideUp($('#signup'));
            }else{
                hide($("#login"));
                slideDown($('#signup'));
            }
        }
    });

}catch(e){
}
});
      ​ 
```

# error-handling - 使用错误异常处理程序和关闭序列防止没有堆栈帧的异常

> ID：14103727
> 
> 赞同：2
> 
> 时间：2012-12-31T16:10:11.157
> 
> 标签：error-handling, shutdown, php

这一周我遇到了一个小问题。前面的错误消息是关于：

> [2012 年 12 月 30 日 15:19:32] PHP 致命错误：在第 0 行的未知中抛出没有堆栈帧的异常

我认为这是因为我的错误处理程序（详见下文）正在将任何错误变成异常。如果没有堆栈框架，我可能应该阻止这种情况。

有没有一种简单的方法可以找出 PHP 中是否有任何堆栈框架？

> *细节：*

在我的一个网站上，我运行了一个错误处理程序，它将每个错误都变成异常，[`ErrorException`](http://php.net/ErrorException)准确地说是常见的。

我前段时间介绍了它，因为该站点主要是遗留代码，我希望有任何问题导致异常，我最终可以以简化的方式“捕获”异常处理程序并停止请求。

我把它放到它自己的类中，注册处理程序，同时打开一个输出缓冲区来捕获输出，直到抛出异常。基本上是这样的代码：

```
// register output buffering
$r = ob_start(array($this, 'handleBuffer'));

// register error handler       
$this->_originalErrorHandler = set_error_handler(array($this, 'handleError'));

// register exception handler
$this->_originalExceptionHandler = set_exception_handler(array($this, 'handleException')); 
```

直到我决定在混合中添加另一个输出缓冲类之前，这一切都很好。只有一个能够捕获所有输出，然后可以在网站上进行一些“后期制作”，包括检查 HTML 问题（是的，这都有点遗留，所以实际上这有点老套，我知道）。顺便说一句，这也很好用。但是当我在新组件中犯了一个错误时：

> [2012 年 12 月 30 日 15:19:32] PHP 致命错误：在第 0 行的未知中抛出没有堆栈帧的异常

这基本上是我的问题。有没有一种简单的方法可以防止出现这些错误？我有点知道为什么会出现错误，但我不太确定，所以我很难真正规避这个问题。我试图在脚本进入新的关闭阶段*之前释放新的输出缓冲区，因为我认为这会导致这种情况。*但这并没有成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T17:25:34.873

您的问题表明您正在使用 PHP 的**EOL** ( *End Of Life* ) 版本（特别是 PHP < 5.3.0），这意味着它不再受支持。这个问题来自抛出一个不存在 strack 框架的异常，因此旧引擎不知道如何正确处理这些异常。

这可能是由于几个不同的原因。一些最常见的如下：

1.  您从错误处理程序或异常处理程序内部引发了异常。
2.  您从析构函数内部抛出了异常。
3.  您从回调内部抛出异常（如输出缓冲回调函数）。

这是一个示例，可以在某些情况下演示您的问题...

```
function myErrorHandler($errno, $errstr, $errfile, $errline)
{
    throw new ErrorException($errstr, $errno, 0, $errfile, $errline);
}

function myExceptionHandler($exception) {
    echo "We got an exception with message: '{$exception->getMessage()}'";
}

function myCallBack($contents) {
    trigger_error('ohnoes!'); // You can't throw an error from the output buffer callback function in older versions of PHP < 5.3
}

class Foo {
    public function __destruct() {
        trigger_error('ohnoes!'); // You can't throw an error from a destructor in older versions of PHP < 5.3
    }
}

set_error_handler('myErrorHandler');
set_exception_handler('myExceptionHandler'); 
```

上面的代码会导致您看到您在此处描述的致命错误...

```
ob_start("myCallBack"); 
```

... 和这里...

```
$foo = new foo; 
```

此问题已在 PHP >= 5.3.0 中修复，因此如果您使用的是最新版本的 PHP，则不会看到此问题。

最简单的解决方法是升级您的 PHP。如果这不是一个选项，您必须考虑这些事实，即您不能在 PHP 不期望它们被抛出的地方抛出异常（在回调函数、错误处理程序、异常处理程序等中...... - 实际上所有这些都被认为是回调到 PHP）。

另一件事是您不应该以这种方式将每个错误都变成异常。如果您正在做的事情正如我提供的代码所演示的那样（即从错误处理程序内部抛出异常 - 从而将每个错误都变成异常），那么您将给自己**带来很多**痛苦并且几乎没有任何好处。PHP 错误不应该被处理。它们旨在通知客户问题（*客户是编写 PHP 代码的人*) 或潜在问题。处理错误本身并不像将每个错误都变成异常然后处理该异常那么简单，因为并非每个错误都应该是异常的。例如，E_NOTICE 级别的错误在异常处理中没有位置。它们主要用于通知您潜在的错误，而不是您的代码一定有错误，更不用说它们中的大多数甚至无法在用户空间代码中轻松处理（它们大多需要重新分解代码本身）。**我强烈反对这种糟糕的做法**。

# html - 网站构建中的 iPad 缩放问题

> ID：14103729
> 
> 赞同：0
> 
> 时间：2012-12-31T16:10:15.317
> 
> 标签：html, css, wordpress, ipad

我尝试搜索三天的大部分时间，但也许我的问题没有正确，所以我决定在这里尝试。

我目前正在开发一个我觉得看起来很棒的网站，但是在 iPad 上它从一开始就以 1 比 1 的比例放大。我一生都无法弄清楚是什么导致了这个问题。在我构建的其他网站上，iPad 只是简单地缩放视图以适应其查看区域。但遗憾的是，情况并非如此。

[这是目前的网站](http://mud.cleartouchvisuals.com/)

我正在使用 Genesis 框架在 Wordpress 上进行开发。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:11:27.063

您应该使用`Viewport`元标记来指定您希望您的网站在不同屏幕上的行为方式：

[https://developer.mozilla.org/en-US/docs/Mobile/Viewport_meta_tag](https://developer.mozilla.org/en-US/docs/Mobile/Viewport_meta_tag)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:11:36.533

执行此操作的是视口元标记。这是您正在使用的：

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/> 
```

# hibernate - java.lang.ClassNotFoundException：某些 EJB 的 org.hibernate.collection.internal.PersistentBag

> ID：14103730
> 
> 赞同：1
> 
> 时间：2012-12-31T16:10:15.370
> 
> 标签：hibernate, jboss7.x, classnotfoundexception

我不知道如何，但是在更改实体类（又添加了一列）之后，远程客户端开始找不到在该实体上运行的方法。更准确地说：

我有一个实体类：

```
@Entity(name = "Ride_Offers")
public class RideOffers implements Serializable{

//declarations...

//new added attribute:

@Column(name = "Deadline")
@Temporal(TemporalType.TIMESTAMP)
private Date deadline;

//getters-setters..
} 
```

一个不开始工作的示例方法：

```
@Override
public RideOffers getOfferByID(int OfferID) {
        return (RideOffers) entityManager.find(RideOffers.class, OfferID);
} 
```

起初我认为无状态 bean 有问题，但是当我将该方法复制到另一个 bean 时，它仍然无法正常工作，而复制的 bean 上的其他方法工作正常。

请注意，该问题发生在同一台计算机上的 Tomcat 服务器中部署的 webapp 上。在离线 Java 应用程序中，一切正常。

业务逻辑部署在 JBoss AS 7 上。JNDI 上下文名称查找很好。当我进行一些搜索时，一些帖子指出问题是客户端应用程序中不存在休眠库，但是所有这些库都已添加到构建路径中，并且直到几个小时前都可以正常运行。我不知道我应该为解决问题提供更多信息。提前致谢。

# javascript - 原型 - spiceworks 批量关闭门票选择

> ID：14103736
> 
> 赞同：1
> 
> 时间：2012-12-31T16:10:51.120
> 
> 标签：javascript, select, prototype

我正在寻找指导，以寻找一种方法来解决我没有经验的编程困难。

我正在使用[Spiceworks](http://www.spiceworks.com)和一个名为[Plugin Bulk Delete and Close](http://community.spiceworks.com/plugin/340)的自定义插件 ，它工作正常，但我需要一个额外的逻辑。我有一个名为 Master Number 的自定义属性，我可以在其中指定门票[截图](http://i.imgur.com/HlKEE.png)的关系。

我正在寻找一种方法，以防选择一张票以关闭所有具有相同主号码的票。好吧，我的编程非常有限，我刚开始使用原型并阅读了一个半月的 jquery。任何帮助或指导都是我需要的，这可能很简单，但对我来说不是。

```
 SPICEWORKS.app.helpdesk.ready(function(){

if(document.URL.indexOf("Master_View") >= 0){

  if ($('Multi-Toolbar') === null)
  {
 var toolbarDInsert = '<a class="delete toolbar_buton" href="#" id="plugin-Dactions">';
  var toolbarCInsert = '<a class="clopen toolbar_buton" href="#" id="plugin-Cactions"><span class="inner icon">Close/Open Ticket(s)</span></a>';
  var cbInsert = '<span style="float:left;"><input type="checkbox" class="plugin-operation" name="cbselection" /></span>';
  var HdInsert = 'div#ticket-list-body table tr td.cell-status';
  var thinsert = '<div id="Multi-Toolbar" class="sui-toolbar"><tr><th><input type="checkbox" id="plugin-all" /></th></tr></div>';
  plugin.includeStyles();  

  $('primary').insert({top:thinsert});
  $('Multi-Toolbar').insert(toolbarCInsert);
  $('Multi-Toolbar').insert(toolbarDInsert);  

    var insertcheckbox = function(actions){
    actions.style.width = '2.5em';
    actions.insert({top:cbInsert});
    };

    $$(HdInsert).each(insertcheckbox);

  $('plugin-Cactions').observe('click', function(event){
    event.stop();
    var entries = $$('input.plugin-operation').select(function(input){

      return input.checked;
    }).collect(function(input){
      return input.up('tr').id.replace('ticket-', '');
    });
    if(entries.size() > 0){    
    var answer = confirm('You are about to Close / Open ' + entries.size() + ' Ticket(s) Relying on the Ticket(s) state. \nContinue ?') ;   
    if (answer){
      entries.each(function(entry){ new Ajax.Request('/tickets/toggle_status/' + entry);

      });
    }}  
    if(entries.size() <= 0){
    alert('No ticket(s) selected, please select at least one ticket');    
    }
  });

  $('plugin-all').observe('click',function (e) {
  var toggle = $('plugin-all').checked;
  $$('div#ticket-list-body input[type=checkbox]').each(function(check) {
  check.checked = toggle;
  });
});  
}
}
}); 
```

# c - 1L 是什么意思？

> ID：14103738
> 
> 赞同：18
> 
> 时间：2012-12-31T16:10:54.630
> 
> 标签：c, literals

> **可能的重复：**
> [“-1L”在 C 中是什么意思？](https://stackoverflow.com/questions/4115566/what-does-1l-mean-in-c)

C中的“0L”，“1L”是什么意思？它与“0”和“1”有何不同？在 C 中是否有除 "L" 之外具有类似功能的其他文字？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-31T16:11:40.017

它是一个整数常量，具有`long int`类型而不是`int`.

> **C11, § 6.4.4.1 整数常量 #1**
> 
> *长后缀：其中之一`l` `L`*

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-31T16:12:54.800

`0L`表示`long`格式为0。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-31T16:28:42.827

在[C99 标准](http://www.open-std.org/JTC1/sc22/wg14/www/docs/n1256.pdf)（草案 PDF）中，描述的后缀在 6.4.4.1（整数后缀）和 6.4.4.2（浮动后缀）中

整数后缀有`u`( `unsigned`)、`l`（小写 L）( `long`)、`ll`( `long long`)、`ul`( `unsigned long`)、`ull`( `unsigned long long`)、`lu`( `long unsigned`)、`llu`( `long long unsigned`) 和大写版本。

浮动后缀是`f`( `float`) 和`l`( `long double`) 以及大写版本。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-31T16:12:13.963

`L`后缀使它成为 a而`long`不是`int`文字 - 它基本上可以应用于任何数字（尽管如果数字足够大以至于它不适合 an `int`，`long`无论是否包含后缀，它都是 a ）。

# php - 将数组值与文本匹配

> ID：14103747
> 
> 赞同：0
> 
> 时间：2012-12-31T16:11:47.897
> 
> 标签：php, arrays, preg-match

> **可能重复：**
> [如何在 php 中执行模式为数组的 preg_match？](https://stackoverflow.com/questions/683702/how-do-you-perform-a-preg-match-where-the-pattern-is-an-array-in-php)

如何将数组中的值与字符串匹配？

我使用一个数组来修复文本中的拼写错误。我想回收这个数组来匹配它的值。

```
$fruitNameFixes = array(
        '/bann?ann?a/i' => 'banana',        
        '/app?e?le?/i' => 'apple',
    );

$str = "I like bananas and oranges!";

if( preg_match('/(banana|apple)/i', $str) ) { //add $fruitNameFixes values
    echo "He likes fruits from the fruitNameFixes array";
} else {
    echo "Nope, he doesn't like fruits from the fruitNameFixes array";
} 
```

测试：[http ://codepad.viper-7.com/N92WVb](http://codepad.viper-7.com/N92WVb)

# php - 使用来自 mysql 的数据填充多个表

> ID：14103750
> 
> 赞同：0
> 
> 时间：2012-12-31T16:12:10.603
> 
> 标签：php, mysql, html-table

我正在尝试从 mysql 填充多个表，并按 id 对它们进行排序。我不知道该怎么做，在这里也找不到太多。

目前我只从 mysql 填充一个表，但我已经在我的 mysql 表中添加了一个新列，这将是每个表的特定 id - 虽然不知道如何循环这个。

在预测表中，我有一列名为 'accid' 。我希望此列将一组具有相同“acid”的结果组合在一起并插入到 html 表中。我该怎么做呢？

这是我目前所拥有的：

```
 $result = mysql_query("SELECT results.home_team, results.away_team, results.home_id,    
       results.away_id, results.ht_score, results.ft_score, predictions.draw,    
       predictions.winningid 
          FROM results 
              LEFT JOIN predictions ON results.match_id = predictions.matchid 
          WHERE userid='".$_SESSION['id']."' ORDER BY home_team");

    $num_rows = mysql_num_rows($result);   

    if($num_rows) {
    $wonBet = true;  #ADDED
    $notlong = false;
    while ($row = mysql_fetch_assoc($result)) {
        echo "<tr>";
        if(!$row["ht_score"]) {
            $halftime = "-";
        } else {
            $halftime = $row["ht_score"];
        }
        if(!$row["ft_score"]) {
            $fulltime = "-";
        } else {
            $fulltime = $row["ft_score"];
        }

        echo "<td>" . $row["home_team"] . "</td>" . "<td>" . " vs " . "</td>" . "<td>" . $row["away_team"] . "</td>" . "<td>" . $halftime . "</td>" . "<td>" . $fulltime . "</td>";

        $value = $fulltime;
        $apart = explode('-',$value); 
        if($apart[0] > $apart[1] && $row["home_id"]==$row["winningid"]) {
            $hometeamwin = "Win";

        } else if($apart[0] < $apart[1] && $row["away_id"]==$row["winningid"]) {
            $hometeamwin = "Win"; 

        } else if($apart[0] == $apart[1] && !$row["winningid"]) {
            $hometeamwin = "Win"; 

        } else { 
            $hometeamwin = "lose";
               #ADDED 

        }

        if($fulltime!=$row["ft_score"]) {
             $hometeamwin = ""; 
             }

             if($hometeamwin == "lose"){   #ADDED
            $wonBet = false;         #ADDED
        } 

             if($hometeamwin == ""){   #ADDED
            $notlong = true;         #ADDED
        }       

        echo "<td>" . $hometeamwin . "</td>";
        echo "</tr>";
    }

    echo '</table>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:23:06.037

要多次使用相同的查询结果，请将它们提取到数组中。然后，您可以在相同的结果上循环多次。

哦 - 并切换到 PDO / MySQLi。..并使用准备好的语句..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:23:35.630

```
$data = array();

$result = mysql_query("SELECT results.home_team, results.away_team, results.home_id,    
   results.away_id, results.ht_score, results.ft_score, predictions.draw,    
   predictions.winningid 
      FROM results 
          LEFT JOIN predictions ON results.match_id = predictions.matchid 
      WHERE userid='".$_SESSION['id']."' ORDER BY home_team");
while($dbrow = mysql_fetch_assoc($result)) {
   $data[] = $dbrow;
}

foreach($data as $row) {
   //Table

}

foreach($data as $row) {
   //Table 2

} 
```

关于酸裂的一些想法

```
while($dbrow = mysql_fetch_assoc($result)) {
     $accid = $dbrow['accid'];
     $data[$accid][] = $dbrow;
}
foreach($data as $accid -> rows) {
  //Table Header
  foreach($rows as $row) {
   //Table Row        
  }
  //Table Footer
} 
```

# php - 在组合框 PHP 中获取文件名

> ID：14103756
> 
> 赞同：0
> 
> 时间：2012-12-31T16:12:32.270
> 
> 标签：php, glob, file-handling

我想在组合框中的文件夹中获取文件名。这是我的代码

```
$directory = "keys/";

//get all image files with a .jpg extension.
$images = glob($directory . "*.jpg");
 echo "yes";
//print each file name
foreach($images as $image)
{
echo $image;
} 
```

它应该显示文件名，但没有显示任何文件名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:37:25.107

尝试运行它应该可以帮助您调试代码。您应该在将来进行调试。

```
/*
 * glob() a pattern inside a directory
 */
$directory = "keys/";
$pattern   = "*.jpg";

if (!is_dir($directory)) {
    throw new Exception('Directory was not found!');
}

$images = glob($directory . $pattern);

if (FALSE === $images) {
    throw new Exception('Glob returned an error.');
}

if (!$images) {
    throw new Exception('No files returned by Glob. That was not expected.');
}

// print each file name
foreach ($images as $image) {
    echo $image;
} 
```

# jquery - 让 jQuery 提交两种形式之一

> ID：14103759
> 
> 赞同：0
> 
> 时间：2012-12-31T16:13:03.253
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3

我试图让 jQuery 在单击 submit_tag 时提交两种表单之一。我的条件是基于文本的存在，所以无论哪种形式有文本，然后提交那个。我的表格看起来像这样

```
<div class="container margin50">
 <div class="row">
  <div class="span6 offset3 cf formBackground">
   <h1>CoverArt Finder</h1>

   <h3>Search Movies</h3>
   <%= form_tag main_results_path, :method => "get", :id => 'submitMovie' %>
   <%= text_field_tag 'search', nil, :placeholder => 'Enter Film Name Here.....', :id => 'movieForm' %>

   <h1>OR<h1>

   <h3>Search Albums</h3>
   <%= form_tag album_album_results_path, :method => "get", :id => 'submitAlbum' %>
   <%= text_field_tag 'search', nil, :placeholder => 'Enter Artist Name here.....', :id => 'albumForm' %>
   <%= submit_tag "search", :id => 'submitForm' %>

   </div>
  </div>
 </div> 
```

HTML

```
<div class="container margin50">
 <div class="row">
  <div class="span6 offset3 cf formBackground">
   <h1>CoverArt Finder</h1>
   <h3>Search Movies</h3>
    <form id="submitMovie" method="get" action="/main/results" accept-charset="UTF-8">
     <input id="movieForm" type="text" placeholder="Enter Film Name Here....." name="search">
    <h1>OR</h1>

    <h3>Search Albums</h3>
    <input id="albumForm" type="text" placeholder="Enter Artist Name here....." name="search">
    <input id="submitForm" type="submit" value="search" name="commit">
    </form>
    </div>
   </div>
  </div> 
```

如果两者都填写，我还想显示一条错误消息。这里的另一个问题是：文本事件是否将占位符计为文本？如果是这样，文本事件将不起作用，是吗？

到目前为止，我已经提出了这个，我知道这是错误的；有人会指出我正确的方向吗？

```
$(document).ready(function() {
 $('#submitForm').click(function(e) {
   e.preventDefault();
    if ($('#submitMovie').text().length > 0) 
    $('#submitMovie').submit();
   else if
   ($('#submitAlbum').text().length > 0)
   $('#submitAlbum').submit();
   else
    ($('#submitAlbum' + 'submitMovie').text().length > 0)
   alert("Cant fill in both forms");

  });
 }); 
```

另外，我刚刚从发布我的 HTML 中注意到，albumSearch 的表单 ID 不存在。任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:19:50.923

您应该检查输入中是否存在文本，而不是表单中。

小提琴：http: [//jsfiddle.net/rdqch/1/](http://jsfiddle.net/rdqch/1/)

```
$('#submitForm').click(function(e) {

    var movie = false,
        album = false,
        $movieForm = $('#movieForm'),
        $albumForm = $('#albumForm');

    // Prevent the default action of the submit button
    e.preventDefault();

    if ($movieForm.val().length) {
        movie = true;
    }

    if ($albumForm.val().length) {
        album = true;
    }

    if (movie && album) {
        alert('Can\'t fill in both forms.');
    } else if (movie) {
        $movieForm.closest('form').submit();
    } else if (album) {
        $albumForm.closest('form').submit();
    }

});

// This is just for demonstration   
$('#submitMovie').on('submit', function (event) {
    event.preventDefault();
    alert('We have submitted a movie search');
});

$('#submitAlbum').on('submit', function (event) {
    event.preventDefault();
    alert('We have submitted an album search');
}); 
```

注意事项：我知道这超出了您的问题范围，您可能已经领先于我，但没有理由告诉您的用户，如果您可以自动修复交互，他们不能同时使用这两种形式。只需在其中一个搜索框中输入任何内容，即可删除另一个搜索框中当前的任何内容。

示例：http: [//jsfiddle.net/rdqch/2/](http://jsfiddle.net/rdqch/2/)

# pentaho - 如何在 Pentaho Report Designer 柱形图中排除一个类别？

> ID：14103763
> 
> 赞同：1
> 
> 时间：2012-12-31T16:13:31.163
> 
> 标签：pentaho

我需要创建一个柱形图，其中包含我的数据集中的大部分（但不是全部）类别。例如，我的数据集的类别是 {x, y, z}，我需要柱形图来仅显示 {x,y} 的数据。如何在 Pentaho Report Designer (PRD) 中执行此操作？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T16:08:01.200

通过执行以下操作，我已成功排除了 Pentaho Report Designer (PRD) 柱形图中的数据点：

1.  创建一个开放公式函数： `=if([category_name]= "value to be excluded";null(); [category_name])`
2.  在设置类别列的图表设置中，选择刚刚创建的函数作为类别。

# objective-c - DDXMLDocument目标-c上的递归循环

> ID：14103765
> 
> 赞同：-1
> 
> 时间：2012-12-31T16:14:09.320
> 
> 标签：objective-c, recursion, kissxml

我想在 DDXMLDocument 上递归循环，并更改元素属性。

我该怎么做 ？我目前有文档和根元素：

```
DDXMLDocument *theDocument = [[DDXMLDocument alloc] initWithXMLString:content options:0 error:&error];
    DDXMLElement *rootElement = theDocument.rootElement; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T17:48:20.580

后缀树遍历实现：

```
-(void)processNode:(DDXMLNode *)node {
    if(node.kind == DDXMLElementKind) {
       //...
       for(DDXMLNode *child in node.children) {
           [self processNode:child];
       }
    }
} 
```

# c# - 将 VLC 播放器嵌入到 WPF 应用程序中

> ID：14103768
> 
> 赞同：5
> 
> 时间：2012-12-31T16:14:17.637
> 
> 标签：c#, wpf, vlc

我有兴趣将 VLC 播放器嵌入到 WPF 应用程序中。它被用作质量控制工具，用户可以在其中观看电影、暂停和移动到不同的帧，以便更好地了解电影的外观。其中大部分是 MP4 文件，但也有少数 .MOV 文件。（因此需要 VLC）有人知道从哪里开始吗？我已经看到了 activex 页面，我认为这将是最好的方法。有没有人有任何见解或链接到一个好的指南？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-31T16:35:29.737

看看[VideoLan DotNet](https://github.com/ZeBobo5/Vlc.DotNet/)，他们有用于 WPF 和 Winforms 的 VLC 控件。

[这](https://github.com/ZeBobo5/Vlc.DotNet/wiki)是教程。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-31T16:28:47.147

你会想要使用[VLC ActiveX 插件](http://wiki.videolan.org/ActiveX)。

也可以看看：

*   [在 WPF 中使用 VLC ActiveX 控件](http://zahidakbar.wordpress.com/2011/06/27/using-the-vlc-activex-control-in-wpf/)
*   [如何使用 c# 在我的 Windows 窗体应用程序中嵌入 vlc](https://stackoverflow.com/questions/13645743/how-to-embed-vlc-in-my-windows-form-application-with-c-sharp)
*   [演练：在 WPF 中托管 ActiveX 控件](http://msdn.microsoft.com/en-us/library/ms742735.aspx)

# c++ - SFML 鼠标位置和文件中的碰撞加载

> ID：14103769
> 
> 赞同：0
> 
> 时间：2012-12-31T16:14:38.003
> 
> 标签：c++, position, mouse, collision, sfml

好的，所以我有两个问题。首先，我制作了一个正方形，该正方形被锁定在与我的瓷砖大小相同的网格上。这将用于更改瓷砖。它工作正常，除非我开始滚动。我知道为什么会这样。这是因为鼠标位置是相对于窗口的，而不是相对于地图的。我想知道是否有一种方法可以编码方块以跟随我的鼠标，即使我滚动。

当前代码：

```
if (Event.type == sf::Event::MouseMoved)
        {

            rect.setFillColor(sf::Color(255, 0, 255));
            rect.setSize(sf::Vector2f(BLOCKSIZE, BLOCKSIZE));
            int x_offset = (Window.getView().getCenter().x - Window.getSize().x /2);
            int y_offset = (Window.getView().getCenter().y - Window.getSize().y /2);

            rect.setPosition(((sf::Mouse::getPosition(Window).x/32 *32) + (x_offset/32 *32)), ((sf::Mouse::getPosition(Window).y/32 * 32) + (y_offset/32 * 32)));
             std::cout << "Mouse position: x:" << ((sf::Mouse::getPosition(Window).x/32 *32) + (x_offset/32 *32)) << " y:" << ((sf::Mouse::getPosition(Window).y/32 * 32) + (y_offset/32 * 32)) << ")\n\n";
        } 
```

下一个问题是加载碰撞。

代码：

```
for(int i = 0; i < CollisionVector.size(); i++)
    {
        //Loop through the height of the MapVector
        for(int j = 0; j < CollisionVector[i].size(); j++)
        {
            sf::RectangleShape rect;
            //If the stored number is 1
            if(CollisionVector[i][j] == 1)
            {
                rect.setFillColor(sf::Color(255, 0, 255));
                rect.setSize(sf::Vector2f(BLOCKSIZE, BLOCKSIZE));
                //Set the position of the rectangle
                rect.setPosition(j * BLOCKSIZE, i * BLOCKSIZE);
            }
            //Draw the rectangle
            Window.draw(rect);
        }
    } 
```

如果我添加它，我会得到一个空白屏幕。我希望矩形是透明的，但我将它更改为粉红色以防万一这是问题（不是）

屏幕滚动代码：

```
void Camera::Update(float x, float y)
{
    cameraX = x - (ScreenWidth / 2);
    cameraY = y - (ScreenHeight / 2);

    if (cameraX < 0)
        cameraX = 0.0;
    if (cameraY < 0)
        cameraY = 0.0;

    CameraPosition.reset(sf::FloatRect(cameraX, cameraY, ScreenWidth, ScreenHeight));
    CameraPosition.setViewport(sf::FloatRect(0,0,1,1));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:25:07.750

对于第一个：由于您通过更改滚动来`sf::View`计算视图偏移并将其添加到您的坐标中：

```
[...]
float x_offset = Window.getView().getCenter().x - Window.getSize().x * .5f;
float y_offset = Window.getView().getCenter().y - Window.getSize().y * .5f;

rect.setPosition(sf::Mouse::getPosition(Window).x/32 * 32 + x_offset, 
            sf::Mouse::getPosition(Window).y/32 * 32 + y_offset; 
```

对于第二个......呃，我现在什么都没有。我检查了 SFML 并且 a`sf::RectangleShape`默认初始化为 (0, 0) 的大小，所以这不是问题。也许问题出在周围的代码中？

# mysql - 嵌套外键（带有多个表）

> ID：14103773
> 
> 赞同：2
> 
> 时间：2012-12-31T16:14:49.183
> 
> 标签：mysql, foreign-keys, mysql-workbench

我有三张桌子：

用户身份

文件夹：id、user_id

词：id，folders_id

（每个表中都有更多的列，但它们与这个问题无关）

一个用户包含几个文件夹，每个文件夹包含几个单词。

到目前为止，一切都很好。我在 MySQL Workbench 的帮助下将这些表与外键互连。

MySQL-Workbench 对第一个连接（folders.user_id -> user.id）所做的与我预期的一样。但是当我添加第二个关系（words.folders_id->folders.id）时，它会自动在两列上生成一个索引：预期的一个folders.id，但也在第一个外键folders.user_id的列上

![这是添加第二个外键后 MySQL Workbench 的屏幕截图。 自动地，这个也是在第一个外键的列上生成的：folders.user_id](../Images/33853cc9694583d1b553c68cd24ad5c7.png)

我一直认为，MySQL 数据库中的重复数据不是一个好的解决方案。但是为什么 MySQL-Workbench 建议我这样做呢？我能想到的唯一优点是，我可以直接从单词中选择用户的 id，而无需 JOIN。这是这个索引超过两列的目的吗？

感谢您向我解释这种现象。

* * *

我还没有找到解决方案，但是当我在谷歌图片中搜索[MySQL Workbench 中的关系图时](https://www.google.com/search?q=foreign%20keys%20workbench&oe=utf-8&aq=t&rls=org.mozilla%3ade%3aofficial&client=firefox-a&um=1&ie=UTF-8&hl=de&tbm=isch&source=og&sa=N&tab=wi&ei=ECDiUKy-L47s9ASz5YDQCg&biw=1536&bih=660&sei=EyDiUKTAFIb28wSK7IHIBg)，这些嵌套的外键永远不会出现。所以我认为它们不是必需的，我只是在 MySQL Workbench 创建它们时继续删除它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T19:20:30.207

为什么不按如下方式编写查询：

```
select user.id from user
inner join folders on folders.user_id=user.id
inner join words on words.folder_id=folders.id 
```

# asp.net-mvc - 依赖注入到 MVC 操作方法中

> ID：14103774
> 
> 赞同：3
> 
> 时间：2012-12-31T16:14:51.897
> 
> 标签：asp.net-mvc, dependency-injection, controller, actionmethod

我想知道这是否可能。我有一个典型的 MVC 操作方法，其签名如下所示：

```
public ActionResult View(MyModel model)
{
   IAnObject myObject = new AnObject();
   //several lines of code follow.....
   return View(model);
} 
```

我想摆脱该`new`关键字并将 IAnObject 的实例注入到操作方法中。但我不确定 MVC 是否允许这样做，在动作方法中将一个类与模型一起注入？有没有人遇到过这个问题，有没有办法解决它？（我们的 IoC 容器是 Windsor，以防万一。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T05:54:13.797

您可能希望在`OnActionExecuting`执行控制器上的任何操作之前调用其中的注入。这将为您提供诸如 the 之类的上下文，`Request`但将允许您设置成员变量 - 从而“模拟”构造函数注入。当然，您只需为整个控制器执行一次。

```
 [NonAction]
    protected override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        _myService = .........;  // get from IoC container

        base.OnActionExecuting(filterContext);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T17:42:40.473

如果您希望将此引用作为参数注入到操作方法中，您可以查看 ControllerActionInvoker，它有[一个 InvokeActionMethod 方法](http://msdn.microsoft.com/en-us/library/system.web.mvc.controlleractioninvoker.invokeactionmethod%28v=vs.108%29.aspx)，我相信它是从 InvokeAction 调用的。这个方法有一个传递给它的参数列表，以及一个动作描述（[ActionDescriptor 类](http://msdn.microsoft.com/en-us/library/system.web.mvc.actiondescriptor%28v=vs.108%29.aspx)）。此操作描述符有一个 GetParameters 方法，该方法将为您[提供有关参数的更多详细信息](http://msdn.microsoft.com/en-us/library/system.web.mvc.parameterdescriptor%28v=vs.108%29.aspx)，例如依赖注入器所需的类型信息。我没有这样做，所以我不太清楚它是如何工作的，但它似乎是可能的。

我也不知道这会如何影响 MVC 如何选择要发布到的操作方法，所以将其考虑在内。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T16:38:19.210

好吧，我同意评论中的人的观点，但是如果您想在方法范围内获取一个实例，请尝试从您的 IoC 容器中获取它，如下所示：

```
public ActionResult View(MyModel model)
{
   // take from the container of IoC
   IAnObject myObject = _continerIoC.Resolve<IAnObject >();

   //several lines of code follow.....
   return View(model);
} 
```

避免使用`new`在容器中创建实例和具体类型，并将控制器与依赖项/引用解耦。

我真的考虑使用构造函数/属性注入。还有一个[方法注入](http://msdn.microsoft.com/en-us/library/ff649751.aspx)。

# python - 一种简单的填充和切片以获得固定长度字符串的方法

> ID：14103777
> 
> 赞同：-4
> 
> 时间：2012-12-31T16:15:19.400
> 
> 标签：python, string, python-3.x, python-2.7

我正在寻找一个函数（希望是内置的），它可以创建固定宽度的 certian 填充和对齐字符串。就我而言，我有一个需要放入固定格式文件的名称列表（以及其他数据）。

示例 1：`"Spams spam and spam"`两者`"viking inc"` 都需要放入一个 15 个字符的固定宽度字段中。
结果：`("Spams spam and ", "viking inc ")`

示例 2：转换`(25, 100, 1234567890)`为`8`用零填充的字符固定宽度字符串的数字版本。
结果：`("00000025", "00000100" "34567890")` <-注意前 2 个字符是如何丢弃的

可接受的答案还可能包括称我为白痴并告诉我固定宽度的字符串处理有些简单。这也应该在 python 2.7 和 3.3 中理想地工作（我们公司目前使用 2.7，但很快就会迁移到 3.3）

我试过的：

```
"{0:<30}".format("viking inc")  #works
"{0:<30}".format("Spams spam and spam") #does not work, output it too long. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:23:46.707

对于数字：

```
>>> for n in (25, 100, 1234567890):
        print('{:0>8}'.format(n)[-8:])

00000025
00000100
34567890 
```

对于字符串，您的示例有点模棱两可。如果您只想选择前 15 个字符（最多），那么只需执行以下操作：

```
>>> 'Spams spam and spam'[:15]
'Spams spam and '
>>> 'viking inc'[:15]
'viking inc' 
```

如果你想再次填充它——你没有在你的例子中——那么你可以再次使用格式：

```
>>> '{:<15}'.format('Spams spam and spam'[:15])
'Spams spam and '
>>> '{:<15}'.format('viking inc'[:15])
'viking inc     ' 
```

# html - 将注册用户分组到都市区

> ID：14103779
> 
> 赞同：-1
> 
> 时间：2012-12-31T16:16:01.913
> 
> 标签：html, node.js, location, user-experience, ip-geolocation

我必须将所有注册到我的网站的用户分组到都会区。都会区被定义为靠近世界上 100 个人口最多的城市之一。

在我提出的解决方案中，用户将看到 2 个下拉菜单。一种用于国家，一种用于城市。这似乎是最好的用户体验。我也在考虑使用 html5 浏览器位置 API 来预先选择下拉列表中的一些位置。

以前有没有人做过类似的事情，你是如何处理的？

**子问题**：你将如何存储这些数据

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:24:41.667

ip-geolocation 通常不是非常精确。

我会强制用户输入国家、城市和邮编。

并使用来自浏览器位置 api 的数据预先填写表单。

在数据库中，我将存储国家、城市、邮编和纬度。

使用 google geocoder api 可以很容易地通过 lat long 和 backword 查找匹配的城市 + zip。 [https://developers.google.com/maps/documentation/geocoding/](https://developers.google.com/maps/documentation/geocoding/)

那么您只需要大城市的经纬度值即可进行区域搜索。Easyes 是在方形而不是圆形中搜索。但是如果你真的需要一个 cirty，你必须使用一个具有 gis 功能的数据库。[http://postgis.refractions.net/](http://postgis.refractions.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:32:41.220

我不会使用地理位置。它在所有浏览器中的工作方式并不总是相同的，并且在每种情况下并不总是可靠的。

我做了类似的事情，我使用了区号。一些大都市区有重叠的区号，但如果您使用都市区的主要区号，您可以找到一个很好的方法来解决这个问题。有些州只有几个主要的区号....有些要高得多，但您知道区号越多，该地区的人口就越多（通常）。附加到都会区的更多区号可用作确定人口稠密城市的另一个因素。

大多数用户可能不想提供城市或邮政编码，但会在注册时提供区号。您可以将区号分配给各州，也可以将区号分配给都会区。

如果您决定以这种方式将其作为额外价值来处理，这张地图应该会有所帮助 [http://www.nanpa.com/area_code_maps/ac_map_static.html](http://www.nanpa.com/area_code_maps/ac_map_static.html)

# sql - 仅从完整日期返回日期

> ID：14103782
> 
> 赞同：-2
> 
> 时间：2012-12-31T16:16:46.980
> 
> 标签：sql, vb.net

> **可能重复：**
> [从 sql 中的日期时间获取日期](https://stackoverflow.com/questions/1978839/to-get-date-from-datetime-in-sql)

在我的桌子上，我有专栏`date`

这是我的 sql 代码：

```
SELECT        [date], enterHour, exitHour
FROM            enterAndExit
WHERE        DATEPART(MONTH, date) = 10; 
```

我只想要日期为 10 的行。

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:19:52.013

试试这个 SQL：

```
SELECT   [date], enterHour, exitHour
FROM     enterAndExit
WHERE    Month([Date]) = 10; 
```

# javascript - HTML/Javascript - 按钮需要两次点击才能执行点击事件

> ID：14103783
> 
> 赞同：3
> 
> 时间：2012-12-31T16:17:11.320
> 
> 标签：javascript, html, button, onclick

然而，测试一个简单的切换显示，第一次切换显示需要两次单击。之后它合而为一。

```
<html>
<head>
<style>
#carousel{border:2px solid blue;
width:1280px;
height:720px;}

#p2{visibility:hidden;}

#p1{display:block;}

#btn{position:absolute;
    top:2000px;}
</style>

<script src="mainScript.js"></script>
</head>

<body>

<div id="carousel">
    <img id="p1" src="pic1.jpg">
    <img id="p2" src="pic2.jpg">
</div>

<button type="button" id="button" onclick="clickEvent()">Click</button>

</body>
</html> 
```

这是我的javascript：

```
function clickEvent(){
var p = document.getElementById("p1");
if(p.style.display == "block")
    p.style.display = "none";
else
    p.style.display = "block";
} 
```

应该注意的是，我没有使用 jQuery，因为我发现的所有其他问题都与 jQuery 相关。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T16:22:58.657

```
function clickEvent(){
var p = document.getElementById("p1");
if(p.style.display == "none")
    p.style.display = "block";
else
    p.style.display = "none";
} 
```

您还可以稍微简化一下：

```
p.style.display = p.style.display == "none" ? "block" : "none"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T16:40:40.570

I have an update to my previous fiddle posted in my comment above. My previous fiddle still ran into the same problem after further testing of the double click.

After stepping through, the initial display value is coming back as `""` not `block`. I'm not sure why its not taking your value you set in the `<head></head>` section but if you inline it like so:

```
<img id="p1" src="pic1.jpg" style="display: none;" /> 
```

it works correctly the first time with only one click of the button.

Here is my new updated [fiddle](http://jsfiddle.net/qYyy8/1/) demonstrating this.

I'm going to look more into why your styling in the `<head></head>` section but for now, here is a quick (and semi crude) fix.

Hope this helps and best of luck!

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T16:22:27.983

默认显示属性是“内联”，因此您的逻辑没有考虑到这一点。它在第一次运行时将其更改为块，因此它仍然可见，然后在第二次单击时将其隐藏（将显示设置为无）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-21T10:55:11.433

您的答案

```
 function clickEvent(){
    var p = document.getElementById("p1");
    if(p.style.display === "block")
        p.style.display = "none";
    else
        p.style.display = "block";
    } 
```

我改变了条件我有同样的问题，我意识到这是关于订单代码执行我的 CSS 样式的元素已经是“块”，我正在检查元素显示是否为“无”然后做显示块的事情，所以当我第一次点击时，它将显示更改为“无”，然后在第二次将显示更改为阻止，我希望我的解释很清楚

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2016-11-28T10:22:49.207

同样的问题只需更换即可解决， `"block" : "none";`第`?"none" : "block";` 一次不需要双击切换按钮，单击即可。

# tfs - TFS 2012 - 如何判断变更集是否经过代码审查？

> ID：14103788
> 
> 赞同：20
> 
> 时间：2012-12-31T16:17:38.043
> 
> 标签：tfs, visual-studio-2012

我们最近开始使用 Team Foundation Server 2012，并且正在使用代码审查功能让其他开发人员审查代码更改。它似乎工作得很好；但是，作为项目负责人，我希望能够看到给定的变更集已被其他人审查。

例如，假设开发人员 Bob 进行了更改并请求对这些更改进行审核。这会为更改生成一个搁置集，并为请求的审查创建一个代码审查工作项。开发人员 Alice 审核更改，提出一些意见，然后完成审核。Bob 将 Alice 的建议和检查合并到变更集中。

作为项目负责人，我搜索变更集并看到 Bob 签入了变更集 123。如果我查看此变更集，就会发现 Bob 正在处理的任务有一个关联的工作项，但没有迹象表明该变更集已被其他任何人审核.

如果我查看代码审查工作项，我可以找到已审查的内容并查看注释。这很麻烦，因为我必须筛选工作项并找到恰好相关的一项。

**我如何从给定的变更集中得知它已被审查，以及查看审查评论？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-11T14:18:39.030

变更集可以链接到任何类型的工作项，包括代码审查。当您请求对一组待定更改进行审核时，它们会自动关联到新的审核工作项。当您双击变更集时，您应该能够在相关工作项下看到如下内容：

![链接到变更集的代码审查（对于丑陋的屏幕截图感到抱歉）](../Images/b45d0855fc99cdae144ff76add0f6f9f.png)

在这种情况下，此变更集有 2 条评论，第二条评论在请求时自动出现。第一个必须手动链接，就像任务一样。

如果你双击评论项目，你可以看到所有的评论。

**提示：**如果您想在签入后进行审核：转到“历史记录”视图 --> 双击变更集 --> 操作 --> 请求审核。

**提示 2：**您必须手动检查每个变更集是否都有审核，这有点烦人。如果缺乏审查对您的团队来说确实是个问题，我建议您制定签到政策。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-10T17:01:29.433

您可以查询**代码审查**工作项，您将在字段***关联上下文***（变更集 ID 或搁置集名称）上找到关联的变更集

在 Code Review 中，您可以通过工作项视图顶部的链接检查变更集。

当然，还有另一种选择直接查询 TFS 数据库（仓库），但它很棘手，需要访问该数据库并了解模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T07:55:57.440

从工作项历史记录中，您可以检查所有更改集....更改集已由其他任何人审查过此功能 TFS 不提供！可能是我丢失了一些东西，但我没有看到任何关于已审核的更改集的答案。但是您可以通过（历史记录，并按日期对源代码控制进行排序）检查更改。祝你好运！

# exchangewebservices - Exchange SDK Streaming API：获取新的邮件内容和主题

> ID：14103790
> 
> 赞同：0
> 
> 时间：2012-12-31T16:18:33.970
> 
> 标签：exchangewebservices, exchange-server, exchange-server-2010

我需要快速帮助。我如何使用 Exchange Streaming API 来拦截每次新邮件到达事件并获取它的内容。

[这篇](http://gsexdev.blogspot.com/2011/09/using-ews-streaming-notifications-in.html)文章讲的是PowerSHell，[这篇](http://blogs.msdn.com/b/exchangedev/archive/2010/12/22/working-with-streaming-notifications-by-using-the-ews-managed-api.aspx)讲的是Console APP。我如何实现自动化？一种方法是 Windows 服务，但还有其他简单的方法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T10:41:07.993

您需要某种接收通知的主机。这是控制台应用程序还是 Windows 服务取决于您。

# regex - AWK 在匹配几列时替换第二个文件的 $0

> ID：14103791
> 
> 赞同：1
> 
> 时间：2012-12-31T16:18:37.937
> 
> 标签：regex, bash, awk

当两个文件中的两个第一列匹配并用第二个文件列替换第一个文件值时，我如何合并两个文件......我的意思是......

相同的列数：

```
FILE 1:
121212,0100,1.1,1.2,
121212,0200,2.1,2.2,

FILE 2:
121212,0100,3.1,3.2,3.3,
121212,0130,4.1,4.2,4.3,
121212,0200,5.1,5.2,5.3,
121212,0230,6.1,6.2,6.3,

OUTPUT:
121212,0100,3.1,3.2,3.3,
121212,0200,5.1,5.2,5.3, 
```

换句话说，我需要在匹配时和两个文件中打印`$0`第二个文件。我理解逻辑，但我无法使用数组来实现它。这显然应该使用。`$1``$2`

请花点时间解释任何代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:54:48.797

用于`awk`打印模式文件中的前 2 个字段并通过管道进行`grep`匹配：

```
$ awk 'BEGIN{OFS=FS=","}{print $1,$2}' file1 | grep -f - file2
121212,0100,3.1,3.2,3.3,
121212,0200,5.1,5.2,5.3, 
```

该`-f`选项告诉`grep`从文件中获取模式，但使用`-`而不是文件名使得`grep`从`stdin`.

因此，第一个`awk`脚本产生了`file1`我们通过管道匹配的模式`file2`using `grep`：

```
$ awk 'BEGIN{OFS=FS=","}{print $1,$2}' file1
121212,0100
121212,0200 
```

您可能希望使用以下命令将匹配锚定到行首`^`：

```
$ awk 'BEGIN{OFS=FS=","}{print "^"$1,$2}' file1 
^121212,0100
^121212,0200

$ awk 'BEGIN{OFS=FS=","}{print "^"$1,$2}' file1 | grep -f - file2
121212,0100,3.1,3.2,3.3,
121212,0200,5.1,5.2,5.3, 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T00:14:38.340

这是一种使用方法`awk`：

```
awk -F, 'FNR==NR { a[$1,$2]; next } ($1,$2) in a' file1 file2 
```

结果：

```
121212,0100,3.1,3.2,3.3,
121212,0200,5.1,5.2,5.3, 
```

# azure - HTTP 代码 403：禁止来自 Microsoft Visual Studio Team Foundation Service 2012 云服务

> ID：14103792
> 
> 赞同：1
> 
> 时间：2012-12-31T16:18:40.730
> 
> 标签：azure, visual-studio-2012, azure-devops

我的项目托管在 Microsoft Visual Studio Team Foundation Service(2012) 云服务中。但是当我的队友尝试从这个项目中获取最新版本时，他们会 在少数文件上随机收到**“HTTP code 403: Forbidden”错误。**这些错误的根本原因是什么。但看起来他们对项目下的所有文件都有读取/签入/签出权限。

# jquery - 使用 jQuery 查找类并添加属性

> ID：14103794
> 
> 赞同：2
> 
> 时间：2012-12-31T16:19:08.937
> 
> 标签：jquery, css, dynamic, jquery-selectors

我有一个页面，其中类名是动态生成的。该类具有“写作模式：tb-rl;” 属性，但我想在 IE 以外的其他浏览器中添加垂直文本所需的其他属性。

链接到 JSFiddle 示例：http: [//jsfiddle.net/VheJd/1/](http://jsfiddle.net/VheJd/1/)

完整的 HTML：

```
<html>
<head>
<title>test page</title>
<style type="text/css">
    .dynamic_name {
        writing-mode: tb-rl;
        /*Would like to find the class by the writing-mode property then add the properties below:*/
        /*-webkit-transform: rotate(90deg);
         -moz-transform: rotate(90deg);
         -o-transform: rotate(90deg);*/
    }
</style>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script type="text/javascript">
    $(function () {
        //find classes with  writing-mode: tb-rl and add -moz-transform etc... properties
    });
</script>
</head>
<body>
<table>
    <tr>
        <td class="dynamic_name">text 1</td>
        <td class="dynamic_name">text 2</td>
    </tr>
    <tr>
        <td>hello</td>
        <td>world</td>
    </tr>
</table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:21:54.383

您可以使用[getComputedStyle()](https://developer.mozilla.org/en-US/docs/DOM/window.getComputedStyle)通过 JS 检查页面上所有元素的特定 CSS 属性的值，但这会非常慢。

最好想办法确定动态类的名称，然后通过这个类名选择需要的元素。例如，如果所有这些动态类都有一些前缀，你可以这样选择这样的元素（前缀`foo-`在这个例子中）：

```
var elems = document.querySelectorAll('[class ^= "foo-"]'); 
```

如果类名总是包含数字子字符串（并且页面上没有其他元素具有包含数字的类名），则可以使用复杂的属性子字符串选择器：

```
TD[class*="1"], TD[class*="2"], TD[class*="3"], TD[class*="4"], TD[class*="5"],
TD[class*="6"], TD[class*="7"], TD[class*="8"], TD[class*="9"], TD[class*="0"] 
```

# c - c的未使用功能检测实用程序

> ID：14103800
> 
> 赞同：4
> 
> 时间：2012-12-31T16:19:44.893
> 
> 标签：c, code-analysis

我正在尝试测量我在 C 项目中的代码覆盖率利用率，该项目由几个库和主程序组成。

是否有一个实用程序可以帮助我从库和主程序中找到我不使用的功能。

我想构建我的主程序未使用的函数（公共函数）列表，以便在我的代码覆盖率报告中忽略它们。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T16:21:55.470

如果您使用 gcc，您可以使用以下[选项](http://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html)编译代码：

```
-Wunused-function 
```

> 每当声明了静态函数但未定义或未使用非内联静态函数时发出警告。此警告由 -Wall 启用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T14:12:53.483

cflow 可以为程序创建调用图，但在某些情况下它不能很好地处理指向函数的指针。

例如：

```
#include <stdio.h>

static int f1(){
        return 1;
}

int (*p_f1)() = f1;

int main() {
        p_f1();
        return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T16:37:01.303

有免费可用的覆盖工具 - 例如与 gcc 工具套件一起运行的“gcov”。但是，代码覆盖率只会告诉您哪些功能会受到您的测试（或您为执行代码所做的任何事情）的影响，例如

```
ptr = malloc(...);
if (!ptr)
{
   allocation_failed(__FILE__, __LINE__);
} 
```

如果您还使用一些使您的分配不时失败的工具，只会显示调用了 allocation_failed 。

我不知道有一种工具可以向您展示大型系统（具有多个库等）不使用哪些功能。我希望您可以通过使用“nm”的输出和一些“拉入”来制作一些东西。在这种情况下，它不会涵盖未使用的 foo 和 bar ：

```
unit1.c:
   extern int foo(void);

   int bar()
   {
       return foo();
   }

unit2.c:

   int foo(void)
   {
      return 42;
   }

   int baz(void)
   {
      return bar();
   } 
```

然后 baz 不在任何地方使用。但是如果你删除baz，它会显示没有调用bar，然后你可以删除foo...

编辑：疯狂的想法时间-如何获取项目中的每个 C 文件并将整个内容连接到一个单独的 .C 文件中，然后在每个函数的开头添加静态，并使用 -Wunused-functon 进行编译 - 我敢肯定如果你的代码写得不是很好，这会产生一些“有趣”的效果，但它可能值得一试[在 Linux 系统中这样做相当容易，比如`find . -name "*.c" -print | xargs cat {} > giantsource.c`- 你需要一点点sed 或其他东西将所有函数标记为静态，我不太确定你会怎么做——这在很大程度上取决于代码的格式。

你可能想看看这个： [http ://www.gedanken.demon.co.uk/cxref/](http://www.gedanken.demon.co.uk/cxref/)

我没有使用过它，但任何体面的交叉引用工具都应该能够将任何“未使用”的东西识别为没有任何引用。当然，您可能仍然需要多次运行代码以清除未被调用的函数所使用的函数等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-05T23:10:25.467

`cflow`可以选择构建交叉引用表：`--xref`

[GNU cflow](https://www.gnu.org/software/cflow/manual/html_node/Cross_002dReferences.html)描述了输出的格式：Cross-Reference

GNU cflow 还能够生成交叉引用列表。此模式由`--xref`( `-x`) 命令行选项启用。交叉引用输出将每个符号出现在单独的行上。每行显示标识符和它出现的源位置。如果此位置是定义符号的位置，则另外用星号标记并后跟定义。例如，这里是 dc 程序的交叉引用输出的片段：

```
printdir * d.c:42 void printdir (int level,char *name)
printdir   d.c:74
printdir   d.c:102 
```

它表明函数 printdir 在第 42 行中定义，并在第 74 行和第 102 行被引用了两次。

要检测未使用的函数，请搜索带有星号的行，而不是具有相同前缀的行。以下 GNU Awk 代码打印未使用的函数：

```
 {
   if( $2 == "*" ) {
      if( f ) {
         print f
      }
      f = $1
   }
   else {
      f = ""
   }
} 
```

命令可能是：

```
cflow -x src/*.c src-gen/*.c | awk -f find-unused-functions.awk 
```

# android - Android安装位置自动不起作用

> ID：14103804
> 
> 赞同：1
> 
> 时间：2012-12-31T16:19:53.070
> 
> 标签：android, installation, sd-card, android-sdcard

我已经`installocation="auto"`在清单中设置了，并且在大多数设备上都可以使用。

不工作（没有移动到 SD 卡的选项）：
Razr Max HD（Android 4.0）
三星 GS3（4.0 和 4.1）
三星 Note 2（4.0）
Droid 4（Android 4.0）。这只是说它会移动到内部空间，但是错误地说没有空间（错误）。

作品：
Rooted, Incredible (4.1)
三星 Note 1 (2.3.6)

有任何想法吗？似乎 +4.0 不想识别标签。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T16:46:45.483

某些手机​​（例如[Razr Max HD](http://forum.xda-developers.com/showthread.php?t=1991655)和[Galaxy S3](http://forum.xda-developers.com/showthread.php?t=1896924)）根本不支持将应用程序移动到 SD 卡。不幸的是，制造商有能力从他们的 Android 版本中删除此功能，并且一些制造商使用该功能。

# bash - 测试一个目录是否可以被给定的 UID 写入？

> ID：14103806
> 
> 赞同：52
> 
> 时间：2012-12-31T16:20:01.070
> 
> 标签：bash, directory, file-permissions

我们可以通过当前进程的uid来测试一个目录是否可写：

```
if [ -w $directory ] ; then echo 'Eureka!' ; fi 
```

*但是任何人都可以建议一种方法来测试一个目录是否可以被其他*uid写入？

我的场景是我正在管理一个 MySQL 服务器实例，并且我想临时更改慢查询日志文件的位置。我可以通过执行 MySQL 命令`SET GLOBAL slow_query_log_file='$new_log_filename'`然后禁用和启用查询日志记录以`mysqld`开始使用该文件来做到这一点。

但我希望我的脚本检查`mysqld`进程的 uid 是否有权创建新的日志文件。所以我想做一些类似（伪代码）的事情：

```
$ if [ -w-as-mysql-uid `basename $new_log_filename` ] ; then echo 'Eureka!' ; fi 
```

但当然，这是一个虚构的测试谓词。

*澄清：* 我想要一个不依赖的解决方案，`su`因为我不能假设我的脚本的用户具有 su 特权。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-31T17:42:14.780

这是一个漫长而迂回的检查方式。

```
USER=johndoe
DIR=/path/to/somewhere

# Use -L to get information about the target of a symlink,
# not the link itself, as pointed out in the comments
INFO=( $(stat -L -c "%a %G %U" "$DIR") )
PERM=${INFO[0]}
GROUP=${INFO[1]}
OWNER=${INFO[2]}

ACCESS=no
if (( ($PERM & 0002) != 0 )); then
    # Everyone has write access
    ACCESS=yes
elif (( ($PERM & 0020) != 0 )); then
    # Some group has write access.
    # Is user in that group?
    gs=( $(groups $USER) )
    for g in "${gs[@]}"; do
        if [[ $GROUP == $g ]]; then
            ACCESS=yes
            break
        fi
    done
elif (( ($PERM & 0200) != 0 )); then
    # The owner has write access.
    # Does the user own the file?
    [[ $USER == $OWNER ]] && ACCESS=yes
fi 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-31T16:31:16.443

那可以做测试：

```
if read -a dirVals < <(stat -Lc "%U %G %A" $directory) && (
    ( [ "$dirVals" == "$wantedUser" ] && [ "${dirVals[2]:2:1}" == "w" ] ) ||
    ( [ "${dirVals[2]:8:1}" == "w" ] ) ||
    ( [ "${dirVals[2]:5:1}" == "w" ] && (
        gMember=($(groups $wantedUser)) &&
        [[ "${gMember[*]:2}" =~ ^(.* |)${dirVals[1]}( .*|)$ ]]
    ) ) )
  then
    echo 'Happy new year!!!'
  fi 
```

说明：

只有**一个**测试（如果），**没有循环**，**也没有 fork**。

**+**注意：正如我使用`stat -Lc` 的那样`stat -c`，这也适用于符号链接！

所以条件是 **如果**，

*   我可以成功读取的统计信息`$directory`并将它们分配给`dirVals`,
*   **和**(
    *   （所有者匹配**和**标志 UserWriteable 存在）
    *   **或**标记存在*其他可写内容*
    *   **或**( 标志 GroupWriteabe 存在 **并且**
        *   我可以成功地将成员列表`$wantedUser`分配给`gMember` **AND**
        *   通过将字段 2 合并到 last of 构建的字符串`$gMember`将匹配*beginOfSting-Or-something-followed-by-a-space*，紧随其后的是目标的组 ( `${dirVals[1]}`)，紧随其后的是*a-space-followed-by-something-Or-endOfString* . )

**然后**回声**新年快乐！**

由于小组的测试意味着第二次*分叉*（而且我喜欢尽可能减少此类调用），因此这是最后一个要完成的测试。

**旧**：

简单地：

```
su - mysql -c "test -w '$directory'" && echo yes
yes 
```

或者：

```
if su - mysql -s /bin/sh -c "test -w '$directory'" ; then 
    echo 'Eureka!'
  fi 
```

**注意：**警告先用双引号括起来，因为已经`$directory`开发了！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-31T16:31:34.480

您可以使用`sudo`在脚本中执行测试。例如：

```
sudo -u mysql -H sh -c "if [ -w $directory ] ; then echo 'Eureka' ; fi" 
```

为此，执行脚本的用户`sudo`当然需要特权。

如果您明确需要 uid 而不是用户名，您还可以使用：

```
sudo -u \#42 -H sh -c "if [ -w $directory ] ; then echo 'Eureka' ; fi" 
```

在这种情况下，`42`是`mysql`用户的 uid。如果需要，替换您自己的值。

**更新**（以支持非 sudo 特权用户）
要获得一个 bash 脚本来更改用户而不`sudu`需要能够`suid`（“切换用户 id”）。[正如这个答案](https://stackoverflow.com/questions/556194/calling-a-script-from-a-setuid-root-c-program-script-does-not-run-as-root)所指出的，这是一个安全限制，需要破解才能解决。查看[此博客](http://www.vidarholen.net/contents/blog/?p=30)以获取“如何”解决它的示例（我尚未测试/尝试过，因此无法确认它是否成功）。

如果可能的话，我的建议是用 C 语言编写一个允许 suid (try `chmod 4755 file-name`) 的脚本。然后，您可以`setuid(#)`从 C 脚本调用以设置当前用户的 id，并从 C 应用程序继续执行代码，或者让它执行一个单独的 bash 脚本来运行您需要/想要的任何命令。这也是一种非常老套的方法，但就非 sudo 替代方案而言，它可能是最简单的方法之一（在我看来）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-04-28T09:50:21.980

因为我必须对@chepner 的答案进行一些更改才能使其正常工作，所以我在此处发布我的临时脚本以便于复制和粘贴。这只是一个小的重构，我赞成 chepner 的回答。如果接受的答案通过这些修复更新，我将删除我的。我已经对该答案发表了评论，指出了我遇到的问题。

我想取消 Bashisms，所以这就是我根本不使用数组的原因。`((`算术评估仍然是 Bash 独有的`))`功能，所以我还是坚持使用 Bash。

```
for f; do
    set -- $(stat -Lc "0%a %G %U" "$f")
    (("$1" & 0002)) && continue
    if (("$1" & 0020)); then
        case " "$(groups "$USER")" " in *" "$2" "*) continue ;; esac
    elif (("$1" & 0200)); then
        [ "$3" = "$USER" ] && continue
    fi
    echo "$0: Wrong permissions" "$@" "$f" >&2
done 
```

没有评论，这甚至相当紧凑。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-31T17:47:17.667

一个有趣的可能性（但它不再是 bash）是使用 mysql 拥有的 suid 标志制作一个 C 程序。

### 步骤1。

创建这个美妙的 C 源文件，然后调用它`caniwrite.c`（抱歉，我一直不喜欢选择名称）：

```
#define _GNU_SOURCE
#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>

int main(int argc,char* argv[]) {
   int i;
   for(i=1;i<argc;++i) {
      if(eaccess(argv[i],W_OK)) {
         return EXIT_FAILURE;
      }
   }
   return EXIT_SUCCESS;
} 
```

### 第2步。

编译：

```
gcc -Wall -ocaniwrite caniwrite.c 
```

### 步骤 3。

将它移动到您喜欢的任何文件夹中，`/usr/local/bin/`这是一个不错的选择，更改它的所有权并设置 suid 标志：（以 root 身份执行此操作）

```
# mv -nv caniwrite /usr/local/bin
# chown mysql:mysql /usr/local/bin/caniwrite
# chmod +s /usr/local/bin/caniwrite 
```

完毕！

只需将其称为：

```
if caniwrite folder1; then
    echo "folder1 is writable"
else
    echo "folder1 is not writable"
fi 
```

事实上，您可以`caniwrite`使用任意数量的参数进行调用。如果*所有*目录（或文件）都是可写的，则返回码为真，否则返回码为假。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-07-18T18:35:13.353

为什么不做一些简单的事情，比如在有问题的文件夹上尝试 mkdir。这样比较靠谱......

```
 mkdir your_directory/
    [[ $? -ne 0 ]] && echo "fatal" || echo "winner winner chicken dinner.." 
```

或者 ？

```
 # -- run the following commands as the_User_ID
    sudo su - the_User_ID << BASH

    mkdir your_directory/
    [[ $? -ne 0 ]] && echo "fatal" || echo "winner winner chicken dinner.."

    BASH 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-01-17T16:11:19.267

我编写了一个函数，如果传递给它的用户是文件/目录的所有者，或者是对该文件/目录具有写访问权限的组的成员，`can_user_write_to_file`它将返回。`1`如果不是，则该方法返回`0`.

```
## Method which returns 1 if the user can write to the file or
## directory.
##
## $1 :: user name
## $2 :: file
function can_user_write_to_file() {
  if [[ $# -lt 2 || ! -r $2 ]]; then
    echo 0
    return
  fi

  local user_id=$(id -u ${1} 2>/dev/null)
  local file_owner_id=$(stat -c "%u" $2)
  if [[ ${user_id} == ${file_owner_id} ]]; then
    echo 1
    return
  fi

  local file_access=$(stat -c "%a" $2)
  local file_group_access=${file_access:1:1}
  local file_group_name=$(stat -c "%G" $2)
  local user_group_list=$(groups $1 2>/dev/null)

  if [ ${file_group_access} -ge 6 ]; then
    for el in ${user_group_list-nop}; do
      if [[ "${el}" == ${file_group_name} ]]; then
        echo 1
        return
      fi
    done
  fi

  echo 0
} 
```

为了测试它，我写了一个小测试函数：

```
function test_can_user_write_to_file() {
  echo "The file is: $(ls -l $2)"
  echo "User is:" $(groups $1 2>/dev/null)
  echo "User" $1 "can write to" $2 ":" $(can_user_write_to_file $1 $2)
  echo ""
}

test_can_user_write_to_file root /etc/fstab
test_can_user_write_to_file invaliduser /etc/motd
test_can_user_write_to_file torstein /home/torstein/.xsession
test_can_user_write_to_file torstein /tmp/file-with-only-group-write-access 
```

至少从这些测试来看，考虑到文件所有权和组写访问权限，该方法按预期工作:-)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-01-17T04:39:58.173

`alias wbyu='_(){ local -i FND=0; if [[ $# -eq 2 ]]; then for each in $(groups "$1" | awk "{\$1=\"\";\$2=\"\"; print \$0}"); do (($(find "${2}" \( -perm /220 -o -group "$each" -a -perm /g+w \) 2>/dev/null | wc -l))) && FND=1; done; else echo "Usage: wbyu <user> <file|dir>"; fi; (($FND)) && echo "Eureka!"; }; _'`

我把它放到一个别名中，它有两个参数，第一个是用户，第二个是要检查的目录。它查找任何人都可写的权限，并循环遍历指定用户的组以检查目录是否在用户组中并且可写 - 如果有任何一个被命中，它会设置一个 found 标志并打印 Eureka！在最后。

爱荷华州：

```
FND=0
USER=user1
DIR=/tmp/test
for each in $(groups "$USER" | awk '{$1="";$2=""; print $0}'); do 
(($(find "$DIR" \( -perm /220 -o -group "$each" -a -perm /g+w \)\ 
   2>/dev/null | wc -l))) && FND=1 
done
(($FND)) && echo 'Eureka!' 
```

# css - 骨架列在 Firefox 顶部添加奇怪的空间

> ID：14103808
> 
> 赞同：1
> 
> 时间：2012-12-31T16:20:26.390
> 
> 标签：css, firefox, layout, skeleton-css-boilerplate

我是骨架新手，正在尝试建立一个简单的网站，但我已经遇到了 Firefox 的问题。代码非常简单，这里是：

```
<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>

    <!-- Basic Page Needs
  ================================================== -->
    <meta charset="utf-8">
    <title>Title</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Mobile Specific Metas
  ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!-- CSS
  ================================================== -->
    <link href="stylesheets/fonts.css" media="all" rel="stylesheet" type="text/css" />
<link href="stylesheets/base.css" media="all" rel="stylesheet" type="text/css" />
<link href="stylesheets/skeleton.css" media="all" rel="stylesheet" type="text/css" />
<link href="stylesheets/layout.css" media="all" rel="stylesheet" type="text/css" />

    <!--[if lt IE 9]>
        <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Favicons
    ================================================== -->
    <link rel="shortcut icon" type="image/x-icon" href="images/favicon.ico" />
    <link rel="icon" type="image/x-con" href="images/favicon.ico" />
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">

</head>

<body>
    <!-- Primary Page Layout
    ================================================== -->

    <div class="container" style="background-color:#399;"><!-- container START -->

        <div class="fifteen columns" style="background-color:#CF0">
            ENGLISH
        </div>

    </div><!-- container END -->

<!-- End Document
================================================== -->
</body>
</html> 
```

当我使用列时，它在除 Firefox 之外的所有浏览器上都显示良好。相反，如果我使用“三分之二”作为班级，甚至“三分之二”，它会显示得很好。

[这是当我使用任何列时 Firefox 所做的](http://imgur.com/CG6vG,j15A9#0)（图片）（它在顶部 102px 处广告了一个奇怪的空间）

[如果我使用“三分之二”firefox 会再次显示正常](http://imgur.com/CG6vG,j15A9#1)（图片）

我查看了所有代码，但无法弄清楚发生了什么。为什么列在 Firefox 中表现不佳？如果这很重要，我在 17.0.1 上。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T20:25:35.743

好的，我想通了，出于某种原因，“clear:both”在 Firefox 中表现不佳。所以我不得不添加： clarfix 到容器 div。

现在工作！

# playorm - 身份证更新卡桑德拉

> ID：14103811
> 
> 赞同：0
> 
> 时间：2012-12-31T16:20:58.623
> 
> 标签：playorm

我最初在其他地方发布了这个。

概要：

读取包含几位信息的日志文件。我正在使用时间戳（四舍五入到分钟）和一个 id 来构建我的密钥。（1348495218081lID1）。我在每次放置之前都会进行查找，以便查看数据库中是否存在具有相同键的记录。如果命中，我会在返回的记录上增加一个计数器字段，然后对该记录执行 put。但是，我在数据库中看不到任何计数器值大于 1 的记录。我应该有很多这样的记录。

这是一个例子：

```
 UserNameCountRecord countRecordLookup = new UserNameCountRecord();
            countRecordLookup.setStartDate(1348495218081l);
            countRecordLookup.setUserName(ID1);
            countRecordLookup.buildId();
            // getId() will return "1348495218081lID1"
            userNameCountRecord = findUserNameCountById(countRecordLookup.getId());
            if (userNameCountRecord != null) {
                userNameCountRecord.incrementCount();
                entityManager.put(userNameCountRecord, false);
            } else {
                userNameCountRecord = new UserNameCountRecord();
                userNameCountRecord.setStartDate(wibEntry.getStartDate());
                userNameCountRecord.setUserName(wibEntry.getUserName());
                userNameCountRecord.setCount(1);
                if (wibEntry.isKnownUserId()) {
                    userNameCountRecord.setKnownUserName(true);
                } else {
                    userNameCountRecord.setKnownUserName(false);
                }
                userNameCountRecord.buildId();
                entityManager.put(userNameCountRecord);
            }
            entityManager.flush(); 
```

任何帮助将不胜感激。感谢您所做的所有出色工作！

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T17:14:47.473

嗯，如果您使用的是 playorm，那么您使用的是 cassandra，这句话让我有点害怕......

“我在每次放置之前都会进行查找，以便查看数据库中是否存在具有相同键的记录。”

如果您有两台服务器，那么两者都可能会进行查找并看到密钥不存在，然后继续使用相同的密钥并发生冲突。通常，您最好生成 TimeUUID 或使用 playOrm UniqueKeyGenerator.generateKey （playOrm 在自动生成 ID 时为您执行此操作）。来自 playorm 的 id 保证在您的集群中是唯一的（与 TimeUUID 相比也很好而且很短）。

无论如何，您可能想重新考虑一下，好像您的 clsuter 扩展了您可能会遇到问题，尽管我不知道您的其余设计或上下文。

院长

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:30:16.427

我是个白痴。为此表示歉意。我的增量器方法不起作用。

# r - 有没有一种简单的方法来对多个标准进行排名，以保留 R 中的关系？

> ID：14103812
> 
> 赞同：21
> 
> 时间：2012-12-31T16:21:08.810
> 
> 标签：r

当单个标准排序良好时，rank 函数会返回显而易见的结果：

```
rank(c(2,4,1,3,5))
[1] 2 4 1 3 5 
```

当单个标准具有平局时，排名函数（默认情况下）将平均排名分配给平局：

```
rank(c(2,4,1,1,5))
[1] 3.0 4.0 1.5 1.5 5.0 
```

rank 函数不允许您根据多个标准进行排序，因此您必须使用其他内容。一种方法是使用匹配和顺序。对于没有关系的单个标准，结果是相同的：

```
rank(c(2,4,1,3,5))
[1] 2 4 1 3 5

match(1:5, order(c(2,4,1,3,5)))
[1] 2 4 1 3 5 
```

但是，对于具有联系的单个标准，结果会有所不同：

```
rank(c(2,4,1,4,5))
[1] 2.0 3.5 1.0 3.5 5.0

match(1:5, order(c(2,4,1,4,5)))
[1] 2 3 1 4 5 
```

联系被打破的方式是，被联系的元素保留其原始顺序，而不是被分配相同的等级。显然，当您根据多个标准进行排序时，此功能可以概括：

```
match(1:5, order(c(2,4,1,4,5),c(10,11,12,11,13)))
[1] 2 3 1 4 5 
```

最后，问题是：是否有一种简单的或内置的方法来计算排名，使用多个标准来保持平局？我已经编写了一个函数来做到这一点，但是对于这样一个基本功能来说，它很丑而且看起来非常复杂......

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-31T16:50:02.990

`interaction`做你需要的：

```
> rank(interaction(c(2,4,1,4,5),c(10,11,12,11,13), lex.order=TRUE))
[1] 2.0 3.5 1.0 3.5 5.0 
```

这是正在发生的事情。

`interaction`期望因子，因此向量是强制的。这样做会在因子水平中产生由 指示的顺序`sort.list`，这对于`numeric`数字而言是非递减顺序。
然后将这两个因素结合起来，交互作用通过最快地改变第二个参数来创建因子水平（因为`lex.order=TRUE`）。因此，第一个向量中的关系由第二个向量中的值解决（如果可能的话）。
最后，`rank`将结果因子强制为`numeric`.

实际排名：

```
> as.numeric(interaction(c(2,4,1,4,5),c(10,11,12,11,13), lex.order=TRUE))
[1]  5 10  3 10 16 
```

如果您提供选项，您将节省一些`drop=TRUE`内存`interaction`。这将改变排名数值，但不会改变它们的顺序，因此最终结果是相同的。

# matlab - MATLAB：为蒙特卡洛模拟索引一个大矩阵

> ID：14103813
> 
> 赞同：3
> 
> 时间：2012-12-31T16:21:10.680
> 
> 标签：matlab, indexing

我试图在 MATLAB 中索引一个大矩阵，其中包含跨行和跨列单调递增的数字，即如果矩阵被调用`A`，对于每个`(i,j)`，`A(i+1,j) > A(i,j)`和`A(i,j+1) > A(i,j)`。

我需要创建一个随机数`n`并将其与矩阵 A 的值进行比较，以查看该随机数应放置在矩阵 A 中的哪个位置。换句话说，n 的值可能不等于矩阵的任何内容，但它可能位于任意两行和任意两列之间，这确定了一个“bin”，该“bin”标识了它在 A 中的位置。一旦找到这个位置，我就会在与 A 大小相同的新矩阵中增加相应的索引.

问题是我想这样做 1,000,000 次。我需要创建一个随机数一百万次，并对这些数字中的每一个进行索引检查。这是从一个点降落在屏幕上的一百万个光子的蒙特卡罗模拟；矩阵 A 由球坐标中的角度组成，随机数是每个入射光子的立体角。

到目前为止，我的代码是这样的（我没有在这里复制粘贴它，因为细节并不重要）：

```
for k = 1:1000000  
    n = rand(1,1)*pi;  
    for i = length(A(:,1))  
        for j = length(A(1,:))  
            if (n > A(i-1,j)) && (n < A(i+1,j)) && (n > A(i,j-1)) && (n < A(i,j+1))  

                new_img(i,j) = new_img(i,j) + 1;   % new_img defined previously as zeros

            end
        end
    end
end 
```

“if”语句只是检查以查找形成 n 边界的 A 的索引。

这工作得很好，但它需要很长时间，特别是因为我的矩阵 A 是尺寸为 11856 x 11000 的图像。有没有更快/更聪明/更简单的方法来做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:41:45.530

Are the values in `A` bin edges? Ie does `A` specify a grid? If this is the case then you can QUICKLY populate A using `hist3`.

Here is an example: numRand = 1e n = randi(100,1e6,1); nMatrix = [floor(data./10), mod(data,10)];

```
edges = {0:1:9, 0:10:99};

A = hist3(dataMat, edges); 
```

If your `A` doesn't specify a grid, then you should create all of your random values once and sort them. Then iterate through those values.

Because you know that `n(i) >= n(i-1)` you don't have to check bins that were too small for `n(i-1)`. This is a very easy way to optimize away most redundant checks.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T16:32:48.393

`A`您可以通过一次对所有元素执行计算来摆脱内部循环。此外，您可以一次创建所有随机数，而不是一次创建一个。请注意，最外面的像素`new_img`永远不能不为零。

```
randomNumbers = rand(1,1000000)*pi;
new_img = zeros(size(A));
tmp_img = zeros(size(A)-2);

for r = randomNumbers
    tmp_img = tmp_img + A(:,1:end-2)<r & A(:,3:end)>r & A(1:end-1,:)<r & A(3:end,:)>r;
end

new_img(2:end-1,2:end-1) = tmp_img; 
```

/aside：如果数组更小，我会用于`bsxfun`比较，但是使用 OP 中的数组大小，该方法会耗尽内存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T16:36:12.267

这是一个在内部循环中应该有很大帮助的片段，它会找到比你的`value`.

```
idx1 = A<value
idx2 = A(idx1) == max(A(idx1)) 
```

如果你想找到确切的位置，你可以用`find`.

# php - 如何制作 PHP webhook 服务器

> ID：14103816
> 
> 赞同：0
> 
> 时间：2012-12-31T16:21:25.720
> 
> 标签：php, webhooks

我需要制作一个 webhook 服务器，我可以从该服务器将 json 数据发送到不同的接收器/客户端。如何使用 PHP 构建它？

我应该使用什么方法来发送 json 数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:27:42.090

你应该看看：

[http://php.net/manual/en/book.curl.php](http://php.net/manual/en/book.curl.php)

[http://php.net/manual/en/function.json-encode.php](http://php.net/manual/en/function.json-encode.php)

[使用 php 发送 json 帖子](https://stackoverflow.com/questions/6213509/send-json-post-using-php)

[php://input <> $_POST?](https://stackoverflow.com/questions/4703906/php-input-post)

# python - python递归函数并返回非可变字典

> ID：14103818
> 
> 赞同：0
> 
> 时间：2012-12-31T16:21:44.283
> 
> 标签：python, recursion, dictionary, hdf5, h5py

我试图让函数 VisitAllObjects 接受不同的文件并返回一个字典。但是我目前有什么指向同名？因此，一旦 gdata 运行，fdata 就会更改为 gdata。我怎样才能使它 fdata 和 gdata 等于他们的 gh5 文件中的尊重数据？

```
f = h5py.File('testfile.gh5', 'r')
g = h5py.File('testfile2.gh5', 'r')

def VisitAllObjects(Group,Path, FileInfo=None):
    if FileInfo is None:
        FileInfo = {}
    for i in Group.items():
        if isinstance(i[1], h5py.Group):
            VisitAllObjects(i[1], Path + '/' + i[0])
        else:
            DatasetName = Path + '/' + i[0]
            FileInfo[DatasetName] = (Group[DatasetName].shape, Group[DatasetName].dtype)
    return FileInfo

fdata = VisitAllObjects(f,'')
gdata = VisitAllObjects(g,'') 
```

在您的帮助下并在调用 visit_all_objects 时添加 file_info ，我能够让它工作。如果您发现这有任何问题，请告诉我，我仍然需要进一步检查，但使用 fdata 和 gdata 会返回不同的数据并且`fdata is gdata`是 False。谢谢。

我得到它与以下工作：

```
def visit_all_objects(Group,Path, file_info=None):
    if file_info is None:
        file_info = {}
    for i in Group.items():
        if isinstance(i[1], h5py.Group):
            visit_all_objects(i[1], Path + '/' + i[0], file_info)
        else:
            DatasetName = Path + '/' + i[0]
            file_info[DatasetName] = (Group[DatasetName].shape, Group[DatasetName].dtype)
    return file_info 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:26:51.840

与其修改字典，不如尝试制作一个新字典，然后对其进行修改。您可以通过`FileInfo = FileInfo.copy()`在处理 where 的情况之后将其放在函数顶部附近来做到这一点`FileInfo is None`。

# firefox - 萤火虫显示奇怪的字符

> ID：14103821
> 
> 赞同：1
> 
> 时间：2012-12-31T16:21:55.800
> 
> 标签：firefox, firebug

出于某种原因，我的 Firebug HTML 选项卡一直显示这些奇怪的字符，例如： →‌¶‌→‌¶‌→‌ 有人能告诉我如何摆脱这个吗？提前谢谢！这是一个屏幕截图：

[http://screencast.com/t/xWa9JAyKxY](http://screencast.com/t/xWa9JAyKxY)

![在此处输入图像描述][1]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:41:53.260

Just disable "show Whitespace" as below: ![](../Images/5df33897f87753333921d408f9f522b1.png)

# lisp - 将列表列表的元素定义为 common lisp 中的新变量

> ID：14103827
> 
> 赞同：1
> 
> 时间：2012-12-31T16:22:30.023
> 
> 标签：lisp, common-lisp

我在表单的 Common Lisp 中有如下列表列表

```
((1 2) (3 4) (5 6)) 
```

这是变量的值`list`，我想要三个新变量，其值是列表的元素。例如：

```
list-1 (1 2)
list-2 (3 4)
list-3 (5 6) 
```

有没有执行此操作的功能？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-31T18:44:10.043

使用[`setq`](http://clhs.lisp.se/Body/s_setq.htm), [`first`](http://clhs.lisp.se/Body/f_firstc.htm)(或[`nth`](http://clhs.lisp.se/Body/f_nth.htm)and [`elt`](http://clhs.lisp.se/Body/f_elt.htm))*设置*:

```
(setq list-1 (first list)
      list-2 (second list)
      list-3 (third list)) 
```

或*绑定*：[`destructuring-bind`](http://clhs.lisp.se/Body/m_destru.htm)_

 *```
(destructuring-bind (list-1 list-2 list-3) list
  ...) 
```

同样，`destructuring-bind` [**绑定**](http://clhs.lisp.se/Body/26_glo_b.htm#binding)变量而不是[**分配**](http://clhs.lisp.se/Body/26_glo_a.htm#assign)它们（即，它是 like [`let`](http://clhs.lisp.se/Body/s_let_l.htm)，而不是 like [`setq`](http://clhs.lisp.se/Body/s_setq.htm)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T07:01:49.313

`list-#`可以概括将列表的元素绑定到表单名称的概念。

您可以创建一个函数来生成一个以序数列表名称作为参数和给定主体的 lambda：

```
(defun make-list-lambda (n body)
  (let ((list-names (loop for index from 1 to n
     collect (intern (format nil "LIST-~D" index)))))
    `(lambda ,list-names
       (declare (ignorable ,@list-names))
       ,@body))) 
```

然后创建一个宏来创建 lambda，对其进行编译，并将其应用于列表：

```
(defmacro letlist (list &body body)
  (let ((assignments (gensym)))
    `(let ((,assignments ,list))
       (apply (compile nil (make-list-lambda (length ,assignments) ',body))
          ,assignments)))) 
```

通过这种方式，分配被本地化到 lambda 主体：

```
CL-USER> (letlist '(a b c d e f)
       (format t "list-1: ~A~%" list-1)
       (format t "list-3: ~A~%" list-3))
list-1: A
list-3: C
NIL 
```

**注意：**每次调用宏时都会编译表单，因为`list-#`在出​​现列表之前不知道会出现多少参数！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-11-30T19:21:10.027

首先将您的列表设置为一个变量，例如 mylist。然后使用函数格式吐出所需的输出。我正在使用 CLISP。希望这可以帮助。这是实际的 REPL 输出。

`(setf mylist '((1 2) (3 4) (5 6)) )`

((1 2) (3 4) (5 6))

`(format t "list-1 ~d~%list-2 ~d~%list-3 ~d" (car mylist)` (second mylist) (last mylist)) list-1 (1 2) list-2 (3 4) list-3 ((5 6)) NIL [142]> 有人可以告诉我如何摆脱“NIL”上面的输出？我是 Lisp 的新手。只是为了好玩而学习。*

# c# - 打印可滚动的窗体。

> ID：14103832
> 
> 赞同：8
> 
> 时间：2012-12-31T16:23:13.867
> 
> 标签：c#, .net

> **可能重复：**
> [如何在 C# 中截取 Winforms 控件/表单的屏幕截图？](https://stackoverflow.com/questions/1493591/how-can-i-take-a-screenshot-of-a-winforms-control-form-in-c)

我有一个包含名称和图片列表的 Windows 窗体。该列表很长，因此有一个滚动面板。现在，我想打印此表单，但我不能，因为打印功能只打印“可见”部分，因为当您向下滚动时会看到不可见部分。那么，有没有办法一次打印整个表格？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T18:17:31.410

在 Visual Basic PowerPacks 工具箱中查找打印表单控件

要打印可滚动表单的完整客户区，请尝试以下操作...

1.在工具箱中，单击 Visual Basic PowerPacks 选项卡，然后将 PrintForm 组件拖到窗体上。

PrintForm 组件将被添加到组件托盘中。

2.在“属性”窗口中，将 PrintAction 属性设置为 PrintToPrinter。

3\. 在适当的事件处理程序中添加以下代码（例如，在打印按钮的 Click 事件处理程序中）。

1.PrintForm1.Print（我，PowerPacks.Printing.PrintForm.PrintOption.Scrollable）

试一试，让我知道它是如何为你工作的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T09:54:53.893

这不是一个完整的答案，但这里有一段代码截取窗体上可滚动面板控件的屏幕截图（位图）。最大的缺点是截屏时屏幕闪烁。我已经在简单的应用程序上对其进行了测试，因此它可能不适用于所有情况，但这可能是一个开始。

以下是如何使用它：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent(); // create a scrollable panel1 component
    }

    private void button1_Click(object sender, EventArgs e)
    {
        TakeScreenshot(panel1, "C:\\mypanel.bmp");
    }
} 
```

这是实用程序：

```
 public static void TakeScreenshot(Panel panel, string filePath)
    {
        if (panel == null)
            throw new ArgumentNullException("panel");

        if (filePath == null)
            throw new ArgumentNullException("filePath");

        // get parent form (may not be a direct parent)
        Form form = panel.FindForm();
        if (form == null)
            throw new ArgumentException(null, "panel");

        // remember form position
        int w = form.Width;
        int h = form.Height;
        int l = form.Left;
        int t = form.Top;

        // get panel virtual size
        Rectangle display = panel.DisplayRectangle;

        // get panel position relative to parent form
        Point panelLocation = panel.PointToScreen(panel.Location);
        Size panelPosition = new Size(panelLocation.X - form.Location.X, panelLocation.Y - form.Location.Y);

        // resize form and move it outside the screen
        int neededWidth = panelPosition.Width + display.Width;
        int neededHeight = panelPosition.Height + display.Height;
        form.SetBounds(0, -neededHeight, neededWidth, neededHeight, BoundsSpecified.All);

        // resize panel (useless if panel has a dock)
        int pw = panel.Width;
        int ph = panel.Height;
        panel.SetBounds(0, 0, display.Width, display.Height, BoundsSpecified.Size);

        // render the panel on a bitmap
        try
        {
            Bitmap bmp = new Bitmap(display.Width, display.Height);
            panel.DrawToBitmap(bmp, display);
            bmp.Save(filePath);
        }
        finally
        {
            // restore
            panel.SetBounds(0, 0, pw, ph, BoundsSpecified.Size);
            form.SetBounds(l, t, w, h, BoundsSpecified.All);
        }
    } 
```

# java - SSN 和电话号码的正则表达式

> ID：14103840
> 
> 赞同：-6
> 
> 时间：2012-12-31T16:24:28.843
> 
> 标签：java, regex, regex-negation

该字符串不应包含 SSN 或电话号码。下面的正则表达式不起作用，它只接受 xxxxxxxxx 格式。

不应包含`xxx-xx-xxxx`or`xxx-xxx-xxx`或`xxxxxxxxx`。

`regex = "^((?!\\d[9]$)|(?!(\\d{3}-?\\d{2}-?\\d{4}$)|(?!(\\d{3}-?\\d{3}-?\\d{3})$)$";`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T17:38:00.267

你可以试试：

```
^(?!((\\d{9})|(\\d{3}-\\d{2}-\\d{4})|(\\d{3}-\\d{3}-\\d{3}))$).* 
```

为了解释，如果我们阅读您提供的查询：

```
^((?!\\d[9]$)|(?!(\\d{3}-?\\d{2}-?\\d{4}$)|(?!(\\d{3}-?\\d{3}-?\\d{3})$)$ 
```

我们可以读到：（ `is not followed by xxxxxxxxx OR is not followed by xxx-xx-xxxx OR is not followed by xxx-xxx-xxx`在我的顶部版本中，我将其改写为：`is not (xxxxxxxxx OR xxx-xx-xxxx OR xxx-xxx-xxx)`.）。

世界上的任何字符串都保证至少不匹配其中两个，所以它们的组合总是正确的，给你一个更简单有效的正则表达式：

```
^$ 
```

`?!`是一个零宽度的断言，所以它什么都不消耗。即使您匹配前瞻检查的内容，您也不会消耗输入，因此您永远不会达到 $，这是前瞻之外的要求。只需`.*`在最终`$`修复之前添加一个。

你的连字符不应该跟着？，我不认为。使它们成为可选的，意味着您还可以匹配`xxx-xxxxxx`和`xxx-xx-x-xxx`。如果这是有意的，您可以将它们添加回来，或大大简化您的正则表达式，以：

```
^(?!\\d{3}-?\\d{2}-?\\d-?\\d{3}$).* 
```

另一个问题`\\d[9]$`应该是`\\d{9}$`

# iphone - 电子邮件应用程序，获取消息预览

> ID：14103841
> 
> 赞同：2
> 
> 时间：2012-12-31T16:24:30.510
> 
> 标签：iphone, ios, imap, mailcore

我正在为 iOS 开发电子邮件客户端。目前我正在使用[MailCore](http://libmailcore.com/ "邮件核心")进行 IMAP/SMTP 交互。我目前正在为收件箱视图获取消息预览。我能想到的唯一方法是从服务器实际获取整个消息正文（仅用于速度的正文），然后仅显示消息的一部分。但是当用户打开消息时，我将不得不再次下载整个消息（这次是所有标题等）。这对我来说似乎有点低效，但我想不出另一种方法来解决这个问题。我一开始就考虑只下载每条消息的全部内容，但这似乎是对用户移动数据的滥用，而且用预览填充收件箱会更慢。关于如何处理消息预览的任何想法？

此外，出于本问题的目的，假设消息发送者姓名、日期、主题和标志已加载到设备上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T10:47:44.263

存在一个原始提取命令，但不确定它上面是否存在任何包装器 api。

> 获取 2 (BODY[]<0.size>)

例如，如果你想获取前 100 个字节的邮件，那么你可以触发一个命令

> 获取 2 (BODY[]<0.100>)

# ruby-on-rails-3 - 搜索有重音没有重音的单词

> ID：14103844
> 
> 赞同：0
> 
> 时间：2012-12-31T16:25:03.130
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.2

我在我的网站上进行了搜索，今天我发现如果一个帖子有例如“implicación en el proyecto”这样的描述，并且我尝试使用“implicacion”这个词而不带重音来查找这个帖子，我不明白任何结果，但是如果我尝试使用带有重音的字母 o 来使用“implicación”，我找到了该帖子。

如何修复此搜索，即使用户使用没有重音的单词，我也需要找到帖子。

这是对我的模型的实际搜索。我正在使用 postgresql 进行生产。

```
find(:all, :conditions => ['title LIKE ? OR title LIKE ? OR description LIKE ? OR description LIKE ?', "%#{search}%", "%#{search.capitalize}%", "%#{search}%", "%#{search.capitalize}%"] ) 
```

在此先感谢您的帮助

编辑

* * *

```
private

    def pg_strip_accents(field)
          "<<EOS
          translate(
            LOWER(#{field}),
            'âãäåāăąÁÂÃÄÅĀĂĄèééêëēĕėęěĒĔĖĘĚìíîïìĩīĭÌÍÎÏÌĨĪĬóôõöōŏőÒÓÔÕÖŌŎŐùúûüũūŭůÙÚÛÜŨŪŬŮ',
            'aaaaaaaaaaaaaaaeeeeeeeeeeeeeeeiiiiiiiiiiiiiiiiooooooooooooooouuuuuuuuuuuuuuuu'
          )
          EOS"
        end

    def self.search(search)
        if search.present?
                where("#{pg_strip_accents('title')} LIKE :search OR #{pg_strip_accents('description')} LIKE :search", 
          :search => "%#{search.downcase}%")
        else
            find(:all)
        end
      end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T18:06:03.500

您可以使用 postgresql函数来执行[此](http://wiki.postgresql.org/wiki/Strip_accents_from_strings,_and_output_in_lowercase)`translate`操作，如此处所示。此外，如果在测试之前将两边都转换为大写或小写，则可以将搜索词的数量减半：

```
where(<<EOS
translate(
  LOWER(title),
  'âãäåāăąÁÂÃÄÅĀĂĄèééêëēĕėęěĒĔĖĘĚìíîïìĩīĭÌÍÎÏÌĨĪĬóôõöōŏőÒÓÔÕÖŌŎŐùúûüũūŭůÙÚÛÜŨŪŬŮ',
  'aaaaaaaaaaaaaaaeeeeeeeeeeeeeeeiiiiiiiiiiiiiiiiooooooooooooooouuuuuuuuuuuuuuuu'
)
LIKE :search OR
translate(
  LOWER(description),
  'âãäåāăąÁÂÃÄÅĀĂĄèééêëēĕėęěĒĔĖĘĚìíîïìĩīĭÌÍÎÏÌĨĪĬóôõöōŏőÒÓÔÕÖŌŎŐùúûüũūŭůÙÚÛÜŨŪŬŮ',
  'aaaaaaaaaaaaaaaeeeeeeeeeeeeeeeiiiiiiiiiiiiiiiiooooooooooooooouuuuuuuuuuuuuuuu'
)
LIKE :search
EOS }, :search => "%#{search.downcase}%") 
```

如链接所示，您可以创建一个专用函数以使其更易于重用。或者您可以使用 ruby​​ 代码为您执行此操作：

```
def pg_strip_accents(field)
  <<EOS
  translate(
    LOWER(#{field}),
    'âãäåāăąÁÂÃÄÅĀĂĄèééêëēĕėęěĒĔĖĘĚìíîïìĩīĭÌÍÎÏÌĨĪĬóôõöōŏőÒÓÔÕÖŌŎŐùúûüũūŭůÙÚÛÜŨŪŬŮ',
    'aaaaaaaaaaaaaaaeeeeeeeeeeeeeeeiiiiiiiiiiiiiiiiooooooooooooooouuuuuuuuuuuuuuuu'
  )
  EOS
end

where("#{pg_strip_accents('title')} LIKE :search OR #{pg_strip_accents('description')} LIKE :search", 
          :search => "%#{search.downcase}%") 
```

# java - 试图找出经典的背包重现

> ID：14103846
> 
> 赞同：2
> 
> 时间：2012-12-31T16:25:43.270
> 
> 标签：java, algorithm, dynamic-programming, knapsack-problem

我正在阅读`Knapsack Problem`（无界）这是我理解的 DP 经典。
虽然我认为我在阅读时理解了解决方案，但我不清楚如何将其转换为实际代码。
例如在下面的重复“公式”中：

`M(j) = MAX {M(j-1), MAX i = 1 to n (M(j - Si) + Vi) } for j >=1`

我不确定如何将其转换为代码，因为我不清楚内部`MAX`是应该在那里还是应该只是：
`M(j) = MAX {M(j-1), M(j - Si) + Vi } for j >=1`

任何帮助找出公式并对其进行编码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T16:28:59.830

你可以这样编码：

```
for w = 0 to W   //W is the maximum capacity
V[0,w] = 0
for i = 1 to n
V[i,0] = 0
for i = 1 to n
for w = 0 to W
    if wi <= w // item i can be part of the solution
        if  bi + V[i-1,w-wi] > V[i-1,w]
            V[i,w] = bi + V[i-1,w- wi]
        else
            V[i,w] = V[i-1,w]
    else V[i,w] = V[i-1,w]  // wi > w 
```

![在此处输入图像描述](../Images/1fd85780a9a99e1d29b296f204f41e29.png)

这意味着以下内容：

这意味着，总权重为 w 的 Sk 的最佳子集是：

1) 总权重 > w 的 Sk-1 的最佳子集，或

2) Sk-1 的最佳子集，总重量 > w-wk 加上项目 k

总权重 > w 的 Sk 的最佳子集，要么包含项目 k，要么不包含项目 k。

**第一种情况**：wk>w。项目 k 不能成为解决方案的一部分，因为如果是，总重量将 > w，这是不可接受的。

**第二种情况**：wk <= w。那么项目 k 可以在解中，我们选择价值更大的情况。

# c# - 如何在 C# 中设置控件模板

> ID：14103851
> 
> 赞同：2
> 
> 时间：2012-12-31T16:26:00.377
> 
> 标签：c#, xaml, windows-runtime, windows-store-apps

如何使用 C# 代码将`.Template`元素的属性（例如`FlipViewItem`我的情况）设置为我的预定义属性`StandardStyles.xaml`

这是相关的模板：

```
<ControlTemplate x:Key="DocumentFlipViewItemControlTemplate" TargetType="FlipViewItem">
    <Grid Width="160" HorizontalAlignment="Left">
        <MyProject:DocumentTabControl Name="MainDocumentTabControl"/>
    </Grid>
</ControlTemplate> 
```

请注意，这是与[如何在代码中设置控制模板不同的问题？](https://stackoverflow.com/questions/5755455/how-to-set-control-template-in-code)- 该问题即时创建一个模板，然后将其分配给控件，我只想设置一个预定义的模板。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T16:36:56.797

```
 <Style x:Key="DocumentFlipViewItemStyle" TargetType="FlipViewItem" >
            <Setter Property="Template" Value="{StaticResource DocumentFlipViewItemControlTemplate}"/>
    </Style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:34:19.597

更改此部分：

```
TargetType="FlipViewItem" 
```

像这样：

```
TargetType="{x:Type FlipViewItem}" 
```

这会将样式应用于`type`整个应用程序。现在要注意的一件事是，您可能需要在类型前面声明名称空间。因此，如果它来自标准库以外的其他东西，您可能需要以下内容：

```
TargetType="{x:Type local:FlipViewItem}" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-16T19:08:07.633

我知道这个问题很老，但是您可以像这样简单地分配它：

```
var template = 
    (ControlTemplate)Application.Current
        .MainWindow // Your WPF window.
        .FindResource("DocumentFlipViewItemControlTemplate"); 
```

然后你把它分配给你`FlipViewItem`这样的：

```
var flipItem = new FlipViewItem { Template = template }; 
```

# language-agnostic - 如何为原始数据类型创建一个类

> ID：14103854
> 
> 赞同：-1
> 
> 时间：2012-12-31T16:26:45.017
> 
> 标签：language-agnostic, primitive

所以我想知道创建一个可以保存原始数据类型的类的最佳方法是什么？我想要一个基本上可以保存任何数据类型的类，比如当我使用构造函数创建类时，我可以将其设为浮点、双精度或整数、无符号或有符号。另外，您将如何添加或减去双精度和浮点数？

此外，我正在寻找广泛的答案，因为不是特定于一种编程语言，除了 c#。

编辑：很难描述我在这里的意思。基本上，我想要的是某种方式，在给定某些信息的情况下，我可以创建自己的原始数据类型。例如，如果需要，我可以创建一个 7 字节的 unsigned int，然后将其添加到我创建的无符号浮点数中。另外我希望这些都是同一个类，这样当添加两个类时，我不需要为每种类型的类添加一个方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:28:55.433

我不是 100% 确定你在问什么，但我认为你正在寻找的是[泛型](http://msdn.microsoft.com/en-us/library/512aeb7t%28v=vs.100%29.aspx)

从那个链接：

```
// Declare the generic class.
public class GenericList<T>
{
    void Add(T input) { }
}
class TestGenericList
{
    private class ExampleClass { }
    static void Main()
    {
        // Declare a list of type int.
        GenericList<int> list1 = new GenericList<int>();

        // Declare a list of type string.
        GenericList<string> list2 = new GenericList<string>();

        // Declare a list of type ExampleClass.
        GenericList<ExampleClass> list3 = new GenericList<ExampleClass>();
    }
} 
```

# ruby-on-rails - Rails：类继承和复杂的多态has_many：通过关联

> ID：14103857
> 
> 赞同：0
> 
> 时间：2012-12-31T16:27:16.387
> 
> 标签：ruby-on-rails, has-many-through, polymorphic-associations, single-table-inheritance

我正在开发的应用程序有 3 个主要模型和许多单表继承模型：

1.  问题
2.  用户
    1.  专业的
    2.  代表
3.  分类
    1.  类别
    2.  话题
    3.  职业
    4.  地方性
    5.  地区
    6.  国家

有多种用户（`User`, `Professional < User`, `Representant < User`），它们都继承自具有单表继承的 User 类。

有多种分类法（`Category < Taxonomy`, `Topic < Taxonomy`, `Profession < Taxonomy`, `Locality < Taxonomy`, `Region < Taxonomy`, `Country < Taxonomy`），它们都继承自具有单表继承的 Taxonomy 类。

问题以及专业人士也通过多对多关系进行分类（他们可以有许多主题、许多专业、许多类别等......）

现在，我正在寻找一种方法来建立这些多态对象之间的多对多关系。我已经尝试了`has_many :through`解决方案并创建了一个分类类。

迁移文件：

```
class CreateClassifications < ActiveRecord::Migration
  def change
    create_table :classifications, :id => false do |t|
      t.references :classifiable, :null => false, :default => 0, :polymorphic => true
      t.references :taxonomy,     :null => false, :default => 0, :polymorphic => true
    end

    add_index :classifications, [:classifiable_id, :taxonomy_id]
    add_index :classifications, [:taxonomy_id, :classifiable_id]
  end
end 
```

模型文件：

```
class Classification < ActiveRecord::Base

  attr_accessible :classifiable, :classifiable_id, :classifiable_type,
                  :taxonomy, :taxonomy_id, :taxonomy_type

  belongs_to :classifiable, :polymorphic => true
  belongs_to :taxonomy,     :polymorphic => true

end 
```

然后，我`has_many :through`为问题、专业人士和分类法添加了关联。

分类法.rb

```
has_many :classifications, :as => :taxonomy, :foreign_key => :taxonomy_id
has_many :classifiables, :through => :classifications, :source => :classifiable
has_many :users,         :through => :classifications, :source => :classifiable, :source_type => "User"
has_many :professionals, :through => :classifications, :source => :classifiable, :source_type => "Professional"
has_many :representants, :through => :classifications, :source => :classifiable, :source_type => "Representant"
has_many :questions,     :through => :classifications, :source => :classifiable, :source_type => "Question"
has_many :guides,        :through => :classifications, :source => :classifiable, :source_type => "Guide" 
```

问题.rb

```
has_many :classifications, :as => :classifiable, :foreign_key => :classifiable_id, :dependent => :destroy
has_many :taxonomies, :through => :classifications, :source => :taxonomy
has_many :topics,     :through => :classifications, :source => :taxonomy, :source_type => "Topic" 
```

专业.rb

```
has_many :classifications, :as => :classifiable, :foreign_key => :classifiable_id, :dependent => :destroy
has_many :taxonomies,  :through => :classifications, :source => :taxonomy
has_many :topics,      :through => :classifications, :source => :taxonomy, :source_type => "Topic"
has_many :professions, :through => :classifications, :source => :taxonomy, :source_type => "Profession" 
```

现在，在设置完所有这些之后，事情就不太顺利了......

1.  我似乎无法将分类法分配给专业人士或问题（即`Question.create(:title => "Lorem Ipsum Dolor Sit Amet", :author => current_user, :topics => [list of topics,...])`除了未保存的主题外效果很好。）

2.  Where 子句不能正常工作（即`Question.joins(:topics).where(:conditions => {:topics => {:id => [list of topics,...]}})`失败并出现`no such column: "Topics"."id"`错误。

有什么帮助吗？谢谢！

**更新**

我已经按照说明安装了 gem 'store_base_sti_class'。它对分类模型产生了预期的效果。

```
#<Classification classifiable_id: 1, classifiable_type: "Professional", taxonomy_id: 17, taxonomy_type: "Topic"> 
```

但是，当我查询主题 ( `Professional.find(1).topics`) 时，ActiveRecord 仍在寻找“用户”类而不是“专业”类...

```
SELECT "taxonomies".* FROM "taxonomies" INNER JOIN "classifications" ON "taxonomies"."id" = "classifications"."taxonomy_id" WHERE "taxonomies"."type" IN ('Topic') AND "classifications"."classifiable_id" = 1 AND "classifications"."classifiable_type" = 'User' AND "classifications"."taxonomy_type" = 'Topic' 
```

知道如何为两者修复它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T17:42:34.487

对于问题 #2，where 子句中的键应该映射到表名，而不是关联名。所以我想你会想要：

```
Question.joins(:topics).where(Topic.table_name => {:id => [...]}) 
```

对于问题 #1，似乎当您设置时`question.topics = [...]`，Rails 创建的分类对象正在设置为“分类法”（而不是“主题”）的 taxonomy_type。这似乎是由于 Rails 的 through_association.rb:51，它采用了`base_class`正在存储的模型，而不仅仅是实际的类名。

我能够通过分类模型上的 before_validation 回调来解决这个问题。在我看来，替代方法是对实际的 Rails 关联代码进行补丁，以使这种行为可配置。

```
class Classification < ActiveRecord::Base
  attr_accessible :classifiable, :classifiable_id, :classifiable_type,
                  :taxonomy, :taxonomy_id, :taxonomy_type

  belongs_to :classifiable, polymorphic: true
  belongs_to :taxonomy, polymorphic: true
  before_validation :set_valid_types_on_polymorphic_associations

  protected

  def set_valid_types_on_polymorphic_associations
    self.classifiable_type = classifiable.class.model_name if classifiable
    self.taxonomy_type = taxonomy.class.model_name if taxonomy
  end
end 
```

**更新**

似乎有另一个 Rails 决定（在[preloader/association.rb:113](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/associations/preloader/association.rb#L113)中）在设置关联范围时使用`model.base_class.sti_name`而不是。`model.sti_name`

那颗宝石应该为你处理好这件事。请参阅[store_base_sti_class_for_3_1_and_above.rb:135](https://github.com/appfolio/store_base_sti_class/blob/master/lib/store_base_sti_class_for_3_1_and_above.rb#L135)了解它如何包装`has_many :as`选项。在我的本地环境中，这按预期工作：

```
$ bundle exec rails console
irb(main):001:0> topics = 3.times.map { Topic.create }
irb(main):002:0> p = Professional.new
irb(main):003:0> p.topics = topics
irb(main):004:0> p.save!
irb(main):005:0> exit

$ bundle exec rails console
irb(main):001:0> puts Professional.find(1).topics.to_sql
SELECT "taxonomies".* FROM "taxonomies" INNER JOIN "classifications" ON "taxonomies"."id" = "classifications"."taxonomy_id" WHERE "taxonomies"."type" IN ('Topic') AND "classifications"."classifiable_id" = 2 AND "classifications"."classifiable_type" = 'Professional' AND "classifications"."taxonomy_type" IN ('Topic')
irb(main):002:0> Professional.find(1).topics.count
=> 3 
```

# sql-server-2005 - 无法为数据库创建备份

> ID：14103860
> 
> 赞同：-2
> 
> 时间：2012-12-31T16:27:29.840
> 
> 标签：sql-server-2005, backup, database-backups

我无法创建数据库备份，因为我登录的用户不是超级用户并且它没有所有权限。

如何创建对数据库拥有所有权限的用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:41:39.880

Use below script to create a login with sysadmin permission for all databases. Replace 'test' with your username.

```
 USE [master]
 GO
 CREATE LOGIN [test] WITH PASSWORD=N'test', DEFAULT_DATABASE=[master], CHECK_EXPIRATION=OFF, CHECK_POLICY=OFF
 GO
 EXEC master..sp_addsrvrolemember @loginame = N'test', @rolename = N'sysadmin'
 GO 
```

Then create your backup..

# asp.net - currentUser 作为模型绑定参数

> ID：14103861
> 
> 赞同：3
> 
> 时间：2012-12-31T16:27:40.447
> 
> 标签：asp.net, asp.net-mvc, model-binding

现在我正在考虑一种将“当前用户”作为我的操作中的模型绑定参数的模式。

我的动作看起来像这样：

```
public JsonResult ListStuff(User currentUser, string paramter1, int parameter2)
{
} 
```

我有一个非常简单的 ModelBinder，如下所示：

```
public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
{
    if ( bindingContext.ModelName == "currentUser" )
        return Globals.HttpContextItems.User;

    return null;
} 
```

我真的很喜欢这个动作不太依赖另一个控制器属性。它使函数的“输入参数”更加清晰，更易于重用，并且将来更容易测试。

我有点害怕安全问题。我可能必须非常确定（即在 DefaultModelBinder 中）currentUser 永远不会被其他 ModelBinder 自动绑定。

如果这可能是一个好的模式，并且如果有一些我目前没有考虑的东西，那么任何人都可以发光，但这会在未来产生问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:50:18.387

如果您担心其他 ModelBinders 会设置该参数，为什么不创建一个 ActionFilterAttribute 以便您必须明确地装饰您的操作方法：

```
public class GetCurrentUserAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        filterContext.ActionParameters["currentUser"] = filterContext.HttpContext.User;
    }
} 
```

然后使用它：

```
[GetCurrentUser]
public ActionResult Index(User currentUser)
{
} 
```

绝对不像默认模型绑定器那样干净，但更明确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T16:50:06.597

有趣的想法。而且我喜欢它通过将需求注入方法来与 IoC 保持一致（人们经常忘记您可以将依赖项注入方法，而不仅仅是构造函数）。

您的安全问题将被抽象到您将填充此上下文项的位置。我的建议是将相同的逻辑放置在同一位置，以填充上下文项。在两个地方（一个模型绑定器，然后说一个控制器方法）拥有这种逻辑会让你在两个地方追逐一个错误。我说这个模型绑定器应该负责加载那个上下文项，如果它为空的话。

最后，如果您想这样做，这将在将来抽象出更复杂的“用户验证”服务。例如，我曾经有一个项目要求，通过安全检查确保传递到域中的每条数据和 ID 都属于该用户。你描述的这个方法让你看到的是有一个从你的基本用户对象继承的自定义用户对象，称为类似的东西`UserContext : User`，可以有许多额外的 UI 相关功能和属性 - 包括额外的安全布尔验证。

我可能会在我的下一个项目中尝试这个。

# java - IOUtils.copy 第二次失败

> ID：14103864
> 
> 赞同：0
> 
> 时间：2012-12-31T16:27:53.587
> 
> 标签：java, servlets

我有一个 servlet，它使用具有以下逻辑的方法：

```
 ServletOutputStream out = response.getOutputStream();
        IOUtils.copy(content, out);
        out.close(); 
```

当我第一次运行它时，一切都按预期工作。如果我再次尝试使用相同的内容执行相同的过程，则 out 为空。我在第二次调试时检查了内容对象，它与第一次的内容相同。任何想法可能会发生什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:45:07.563

假设您没有尝试写入关闭的输出流（这是我的第一个猜测，但您的评论让我认为 servlet 本身被重新调用，这将打开一个新的响应），那么您的输入很可能是流需要重置。根据实际流的类型，您可以在流本身上使用标记和重置，也可以重新创建流，或者可以将其作为字节数组复制到内存中以供重用。看到这个问题：[两次读取流](https://stackoverflow.com/questions/9501237/read-stream-twice)

# javascript - 在不重绘的情况下将行添加到 JQuery DataTable

> ID：14103867
> 
> 赞同：3
> 
> 时间：2012-12-31T16:28:18.927
> 
> 标签：javascript, jquery, datatable

如何在不重绘整个表的情况下向 JQuery DataTable 添加行？

我想要的行为是找到正确的位置（基于排序）将行插入表中，同时保持表的滚动位置和分页（如果有）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-19T12:49:32.717

我面临着同样的问题。我为此找到的解决方案是一个名为 fnStandingRedraw [http://datatables.net/plug-ins/api/fnStandingRedraw](http://datatables.net/plug-ins/api/fnStandingRedraw)的新函数。我添加了上面的代码以便能够使用这个功能，

```
$.fn.dataTableExt.oApi.fnStandingRedraw = function (oSettings) {
    if (oSettings.oFeatures.bServerSide === false) {
        var before = oSettings._iDisplayStart;

        oSettings.oApi._fnReDraw(oSettings);

        // iDisplayStart has been reset to zero - so lets change it back
        oSettings._iDisplayStart = before;
        oSettings.oApi._fnCalculateEnd(oSettings);
    }

    // draw the 'current' page
    oSettings.oApi._fnDraw(oSettings);
}; 
```

之后我执行以下命令，

```
theTable.fnAddData([reply], false);
theTable.fnStandingRedraw(); 
```

其中，
**theTable** : 是数据表变量 (var theTable = $('#example').dataTable();)。
**回复**：是我添加到我的数据表行中的信息。更多关于[http://datatables.net/plug-ins/api/fnStandingRedraw](http://datatables.net/plug-ins/api/fnStandingRedraw)。

第一个命令在表格上添加一行而不重绘它。此后，新行将不会显示在表格上。
第二个命令重绘表格，因此会出现新的原始数据，但保留当前的分页设置。
这对我来说很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T18:28:45.523

利用`dataTable().fnAddData()`

[http://datatables.net/ref#fnAddData](http://datatables.net/ref#fnAddData)

例子：

[http://www.datatables.net/release-datatables/examples/api/add_row.html](http://www.datatables.net/release-datatables/examples/api/add_row.html)

# javascript - 如何在 JQuery 中重新排列数组

> ID：14103870
> 
> 赞同：1
> 
> 时间：2012-12-31T16:28:29.547
> 
> 标签：javascript, jquery

我有这个被发布到我的脚本

```
Array
(
  [0] => Array
      (
          [name] => test1
          [value] => test1 value
      )

  [1] => Array
      (
          [name] => test2
          [value] => test2 value
      )
) 
```

我想要的是：

```
Array
(
  [0] => Array
      (
          [test1] => test1 value
      )

  [1] => Array
      (
          [test2] => test2 vlaue
      )
) 
```

这是我用来发布数据的 JQuery。有人可以告诉我我需要什么来实现这一目标吗？

```
var vals = $("#post").find('input,select,textarea').serializeArray();
vals.push({
    name: 'article',
    value: CKEDITOR.instances.article.getData()
});
var qs = $.param(vals);

$.post('test.php', {
    data: vals
}, function (data) {
    if(data.success == 0) {

    }
}, 'json'); 
```

**编辑：** 我要做的是简单地访问我的服务器上的每个键值，如下所示：

```
 echo $_POST['test1'];
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:38:28.370

从您的帖子看来，您的“姓名”属性是恒定的，等于“文章”。但是，如果 article 实际上是代码中前面定义的变量，那么这应该有效：

```
var vals = $("#post").find('input,select,textarea').serializeArray();
var newVal = {};
newVal[article] = CKEDITOR.instances.article.getData();
vals.push(newVal); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T17:05:40.890

使用`$.post`时，第二个参数是您要发送到服务器的数据。这不像`$.ajax`你传递一个带有选项的对象。

试试这个：

```
var vals = $("#post").find('input,select,textarea').serializeArray();
vals.push({
    name: 'article',
    value: CKEDITOR.instances.article.getData()
});

$.post('test.php', vals, function (data) {
    if(data.success == 0) {
    }
}, 'json'); 
```

# python - 为什么python字典在我启动一个新的类实例时会记住前一个实例的值？

> ID：14103871
> 
> 赞同：4
> 
> 时间：2012-12-31T16:28:35.693
> 
> 标签：python, class, dictionary, instance

> **可能的重复：**
> [Python 中的“Least Astonishment”：可变默认参数](https://stackoverflow.com/questions/1132941/least-astonishment-in-python-the-mutable-default-argument)

当我尝试编写如下所示的课程时，我有一些很奇怪的事情。在第 3 行，我必须将参数 newdata 的新副本放到 self.data 中，否则，似乎当我启动一个新的类实例时，前一个的值仍然被类记住。请参阅下面的示例，请注意第 3 行两个版本代码的唯一区别。

```
class Pt(object):                                                               
    def __init__(self,newdata={}):                                              
        self.data=newdata.copy()                                                       
        if self.data == {}:                                                     
            self._taglist = []                                                  
        else:                                                                   
            self._taglist = self.data.keys()                                    
    def add_tag(self,tag=None):                                                 
        self.data[tag]={'x':[0,1,2,3,4]}                                        
        self._taglist.append(tag)                                               

In [49]: pt = Pt()

In [50]: pt.add_tag('b')

In [51]: pt.add_tag('a')

In [52]: pt.data
Out[52]: {'a': {'x': [0, 1, 2, 3, 4]}, 'b': {'x': [0, 1, 2, 3, 4]}}

In [53]: pt2 = Pt()

In [54]: pt2._taglist
Out[54]: [] 
```

* * *

```
class Pt(object):                                                               
    def __init__(self,newdata={}):                                              
        self.data=newdata                                                       
        if self.data == {}:                                                     
            self._taglist = []                                                  
        else:                                                                   
            self._taglist = self.data.keys()                                    
    def add_tag(self,tag=None):                                                 
        self.data[tag]={'x':[0,1,2,3,4]}                                        
        self._taglist.append(tag)                                               

In [56]: pt = Pt()

In [57]: pt.add_tag('a')

In [58]: pt.add_tag('b')

In [59]: pt._taglist
Out[59]: ['a', 'b']

In [60]: pt2 = Pt()

In [61]: pt2._taglist
Out[61]: ['a', 'b']

In [62]: pt2.data
Out[62]: {'a': {'x': [0, 1, 2, 3, 4]}, 'b': {'x': [0, 1, 2, 3, 4]}} 
```

我猜第二种情况的发生是因为：newdata 和 self.data 都引用同一个对象（但怎么会发生这种情况，值应该从右到左而不是反向给出），所以当我使用“add_tag”方法时要更新 self.data，也会更新 newdata。然而我认为当我通过pt2 = Pt（）启动一个新实例时，newdata应该使用默认值（{}），它仍然可以保留pt1的旧值吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T17:25:21.097

Python中的“Least Astonishment”中已经很好地解释了为什么和所有[：可变默认参数](https://stackoverflow.com/questions/1132941/least-astonishment-in-python-the-mutable-default-argument)。因此，这里只是如何解决您的问题的快速帮助。

由于保留了默认参数对象，因此您永远不应使用可变对象作为默认参数值。相反，您应该定义一个固定值，通常是`None`，作为默认值，然后初始化默认对象。所以你的构造函数看起来像这样：

```
def __init__(self, newdata=None):
    if newdata is None:
        newdata = {}
    # ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T16:30:24.783

您的问题是您复制字典，创建具有相同值的新字典。这意味着您的字典中的列表是相同的，因此当您修改它们时，它们会在您的所有字典中进行修改。

您想要做的是[`copy.deepcopy()`](http://docs.python.org/2/library/copy.html#copy.deepcopy)- 这不仅会复制字典，还会复制列表。

# symfony - 如何使用 Symfony2 模拟 404 错误？

> ID：14103874
> 
> 赞同：45
> 
> 时间：2012-12-31T16:28:53.707
> 
> 标签：symfony, symfony-2.1

所以我正在寻找一种模拟 404 错误的方法，我尝试了这个：

```
throw $this->createNotFoundException(); 
```

和这个

```
return new Response("",404); 
```

但没有一个有效。

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2012-12-31T16:44:13.210

您可以在 Symfony2 文档中找到解决方案：

[http://symfony.com/doc/2.0/book/controller.html](http://symfony.com/doc/2.0/book/controller.html)

**管理错误和 404 页面**

```
public function indexAction()
{
    // retrieve the object from database
    $product = ...;
    if (!$product) {
        throw $this->createNotFoundException('The product does not exist');
    }

    return $this->render(...);
} 
```

文档中有一个简短的信息：

“createNotFoundException() 方法会创建一个特殊的**NotFoundHttpException**对象，它最终会在 Symfony 内部触发 404 HTTP 响应。”

```
use Symfony\Component\HttpKernel\Exception\NotFoundHttpException 
```

在我的脚本中，我做了这样的：

```
use Symfony\Component\HttpKernel\Exception\NotFoundHttpException

/**
 * @Route("/{urlSlug}", name="test_member")
 * @Template()
 */
public function showAction($urlSlug) {
    $test = $this->getDoctrine()->.....

    if(!$test) {
        throw new NotFoundHttpException('Sorry not existing!');
    }

    return array(
        'test' => $test
    );
} 
```

# c# - 如何处理 DataColumn 的 NullValue 属性引发的异常？

> ID：14103879
> 
> 赞同：0
> 
> 时间：2012-12-31T16:29:36.963
> 
> 标签：c#, null, dataset, datacolumn

我有一个使用向导制作的数据集。此 DataSet 具有 ID 列的 DataTable，其 NullValue 属性设置为（引发异常）。如何在代码中处理这种异常？例如显示我的信息或做其他事情。

# postgresql - 在 to_tsquery 中转义特殊字符

> ID：14103880
> 
> 赞同：22
> 
> 时间：2012-12-31T16:29:45.070
> 
> 标签：postgresql, full-text-search

您如何对传递给的字符串中的特殊字符进行分隔`to_tsquery`？例如，这种查询：

```
select to_tsquery('AT&T'); 
```

产生：

```
NOTICE:  text-search query contains only stop words or doesn't contain lexemes, ignored

 to_tsquery 
------------

(1 row) 
```

编辑：我还注意到`to_tsvector`.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-02-27T11:32:22.683

一个简单的解决方案是按如下方式创建 tsquery：

```
select $$'AT&T'$$::tsquery; 
```

您可以进行更复杂的查询：

```
select $$'AT&T' & Phone | '|Bang!'$$::tsquery; 
```

有关更多信息，请参阅文本搜索[文档](http://www.postgresql.org/docs/current/static/datatype-textsearch.html)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-01-23T11:10:22.670

我发现这个评论非常有用，它使用了`plainto_tsquery('AT&T)`函数[https://stackoverflow.com/a/16020565/350195](https://stackoverflow.com/a/16020565/350195)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-31T16:51:15.763

如果您希望将“AT&T”视为搜索词，则需要一些自定义组件，因为默认解析器将其拆分为两个词：

```
steve@steve@[local] =# select * from ts_parse('default', 'AT&T');
 tokid | token 
-------+-------
     1 | AT
    12 | &
     1 | T
(3 rows)
steve@steve@[local] =# select * from ts_debug('simple', 'AT&T');
   alias   |   description   | token | dictionaries | dictionary | lexemes 
-----------+-----------------+-------+--------------+------------+---------
 asciiword | Word, all ASCII | AT    | {simple}     | simple     | {at}
 blank     | Space symbols   | &     | {}           |            | 
 asciiword | Word, all ASCII | T     | {simple}     | simple     | {t}
(3 rows) 
```

正如您从[CREATE TEXT PARSER 的文档](http://www.postgresql.org/docs/current/static/sql-createtsparser.html)中看到的那样，这不是很简单，因为解析器似乎需要是一个 C 函数。

您可能会发现有人将“underscore_word”识别为单个标记的帖子很有用：http: [//postgresql.1045698.n5.nabble.com/Configuring-Text-Search-parser-td2846645.html](http://postgresql.1045698.n5.nabble.com/Configuring-Text-Search-parser-td2846645.html)

# java - java内存大小优化

> ID：14103882
> 
> 赞同：5
> 
> 时间：2012-12-31T16:29:56.193
> 
> 标签：java, memory, optimization

我正在编写一些需要在内存中保存大量数据的“大数据”软件。我用 C++ 写了一个原型，效果很好。然而，实际的最终用户通常使用 Java 编写代码，因此他们要求我也编写一个 Java 原型。

我已经完成了关于 java 内存占用的背景阅读和一些初步测试。例如，假设我有这个对象

```
public class DataPoint{

    int cents, time, product_id, store_id;

    public DataPoint(int cents, int time, int product_id, int store_id){
    this.cents = cents;
    this.time = time;
    this.product_id = product_id;
    this.store_id = store_id;
    }
} 
```

在 C++ 中，这个结构的大小是 16 字节，这是有道理的。在 Java 中，我们必须是间接的。例如，如果我创建 10m 的这些对象并在前后使用 Runtime.totalMemory() - Runtime.freeMemory()，然后根据需要进行划分，我得到每个结构大约 36 个字节。大约 2.4 倍的内存差异非常糟糕；当我们试图在内存中保存数亿个数据点时，它会变得丑陋。

我在某处读到，在 Java 中的这种情况下，最好将数据存储为数组——本质上是基于列的存储而不是基于行的存储。我想我理解这一点：基于列的方式减少了引用的数量，也许 JVM 甚至可以智能地将 int 打包成 8 字节的单词。

我可以使用哪些其他技巧来减少本质上是一个内存块的内存占用量，该内存块具有一个非常大的维度（数百万/十亿个数据点）和一个非常小的维度（O(1) 列/变量数）？

结果将数据存储为 4 个 int 数组，每个条目正好使用 16 个字节。教训：小对象在 java 中具有令人讨厌的比例开销。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:42:46.123

在 Java 中查看数据结构占用了多少内存并不是那么简单。totalMemory() 显示分配给 vm 的空间大于实际使用量。您可以尝试使用 Java 分析器来显示数据结构的空间消耗，它们很容易设置和运行。一个方便的免费工具是 Java 自己的[VisualVM](http://visualvm.java.net/)，例如显示应用程序的内存行为，如果您使用它，您还将了解 Java 的 GC 是如何工作的。

显示性能足迹的 VisualVM 屏幕截图（图片来自[http://visualvm.java.net/features.html](http://visualvm.java.net/features.html)）： ![在此处输入图像描述](../Images/988d6c6e02374c6848504ce8b5c7c425.png)

如果可能，您还应该考虑将变量设为最终变量。它允许 Java VM 更好地优化代码（虽然不确定它是否节省空间）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:42:49.650

首先，in 中的对象`Java`总是比版本稍大，`C++`因为对象封装了运行时类型信息，使您能够`instanceof`执行`C++`. 此外，它还有助于您必须自己手动进行的内存管理，因此您也可以将这部分`C++`代码视为代码库的一部分。

您可以查看[享元模式](http://en.wikipedia.org/wiki/Flyweight_pattern)以减少内存需求，以便重用`DataPoints`（使类[Immutable](http://en.wikipedia.org/wiki/Immutable_object)）。我假设如果你说的有数十亿个点，有些可能是相同的值。
我相信这里的其他人会提供一些关于优化内存空间的更具体的信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T16:50:52.877

根据值范围，您可能可以使用较小的数据类型。您可以对某些成员使用 byte 或 short 吗？

# haskell - 编写 Haskell 过滤器

> ID：14103886
> 
> 赞同：0
> 
> 时间：2012-12-31T16:30:20.203
> 
> 标签：haskell, composition, applicative

我正在将[zxcvbn 密码强度](https://tech.dropbox.com/2012/04/zxcvbn-realistic-password-strength-estimation/)算法转换为 Haskell。

我有两个函数可以检查所有字符是否为 ASCII 并且可以进行暴力攻击：

```
filterAscii :: [String] -- ^terms to filter
            -> [String] -- ^filtered terms
filterAscii = filter $ all (\ chr -> ord chr < 128) 
```

和

```
filterShort :: [String] -- ^terms to filter
            -> [String] -- ^filtered terms
filterShort terms = map fst $ filter long $ zip terms [1..]
  where long (term, index) = (26 ^ length term) > index 
```

我将它们组合成一个函数：

```
filtered :: [String] -- ^terms to filter
         -> [String] -- ^filtered terms
filtered = filterAscii . filterShort 
```

我现在需要使用第三个过滤器来组合这些以检查这些术语是否不为空：

```
filter (not . null) terms 
```

我突然想到我正在创建一个过滤器链，并且创建一个单独的函数会更有意义，该函数需要一个过滤器函数列表并按给定的顺序组合它们。

如果我从阅读中回忆起，我相信这是一个应用函子的工作。我可以为此使用应用程序吗？

在过滤之前，我不确定如何处理`filterShort`我需要`zip`使用基于一个的索引的每个项目的功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T16:48:42.720

您可以使用`Endo`wrapper from`Data.Monoid`来获取一个 monoid 实例，该实例将允许您`mconcat`像这样使用：

```
Prelude> :m + Data.Monoid
Prelude Data.Monoid> :t appEndo $ mconcat [Endo filterAscii, Endo filterShort]
appEndo $ mconcat [Endo filterAscii, Endo filterShort] :: [String] -> [String] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T21:14:44.000

换句话说，你想要：

```
filters :: [a -> Bool] -> [a] -> [a]
filters fs = filter (\a -> and $ map ($ a) fs) 
```

`filter`但是您也应该知道，无论如何，GHC（据我所知）很可能会优化 s的管道。所以创建这个函数可能不值得。请注意，`filterShort`由于它不是纯过滤器，因此您会遇到一些问题。

# android - mono for android 获取 html 源代码

> ID：14103889
> 
> 赞同：0
> 
> 时间：2012-12-31T16:30:38.143
> 
> 标签：android, xamarin.android, android-webview

* * *

我想在 c# 中获取 html 源代码（用于 android 的单声道）

我在我的项目中添加了 webview。网络视图名称是网络。

我的代码：

```
WebView webView;
protected override void OnCreate(Bundle bundle)
        {
            base.OnCreate(bundle);

            // Set our view from the "main" layout resource
            SetContentView(Resource.Layout.Main);    webView.Settings.JavaScriptEnabled = true;
            webView.Settings.SetSupportZoom(true);
            webView.Settings.BuiltInZoomControls = true;
            webView.Settings.LoadWithOverviewMode = true; //Load 100% zoomed out
            webView.ScrollBarStyle = ScrollbarStyles.OutsideOverlay;
            webView.ScrollbarFadingEnabled = true;

            webView.VerticalScrollBarEnabled = true;
            webView.HorizontalScrollBarEnabled = true;

            webView.SetWebViewClient(new AwesomeWebClient());
            webView.SetWebChromeClient(new AwesomeWebChromeClient(this));
            webView.LoadUrl(@"http://www.google.com");
        }
    private class AwesomeWebClient : WebViewClient { }

    private class AwesomeWebChromeClient : WebChromeClient
    {
        private Activity mParentActivity;
        private string mTitle;
        private string username;
        private string password;
        private string oldurl="";

        public AwesomeWebChromeClient(Activity parentActivity)
        {
            mParentActivity = parentActivity;
            mTitle = parentActivity.Title;
        }

        public override void OnProgressChanged(WebView view, int newProgress)
        {
            mParentActivity.Title = string.Format("Loading {0}%", newProgress);
            mParentActivity.SetProgress(newProgress * 100);
            if (newProgress==100) mParentActivity.Title=mTitle;
        }
    } 
```

我在 webview 组件中打开 www.google.com，我想查看 html 源代码

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T16:02:43.243

我不相信有办法从`WebView`.

相反，您应该使用[WebRequest](http://androidapi.xamarin.com/?link=T:System.Net.WebRequest)自己获取 HTML ，例如[这个方便的 StackOverflow 答案](https://stackoverflow.com/a/4704065/83444)。

# python - 将 EMF/WMF 文件转换为 PNG/JPG

> ID：14103891
> 
> 赞同：11
> 
> 时间：2012-12-31T16:30:48.417
> 
> 标签：python, python-imaging-library

我收到一个带有 Word docx 文档的表单上传。我成功完成了所有解析。然后我必须在网络上显示该 Word 文档。

我现在遇到的问题是我嵌入了 EMF 文件（PIL 库识别为 WMF 格式），我不知道如何将它们转换为可以在网络上显示的东西（任意选择 PNG）。

代码有点简单：

```
im = PIL.Image.open（StringIO.StringIO（数据））
fmt = im.format
如果（fmt == 'WMF'）：
  fmt = 'PNG'
  输出 = StringIO.StringIO()
  im.save（输出，格式=fmt）
  数据 = 输出.getvalue()
  输出.close()
return '''<img src="data:image/{0};base64,{1}" />'''.format(fmt, base64.encodestring(data))

```

我得到的错误是：

```
IOError: cannot find loader for this WMF file 
```

这些 Word 文档来自普通用户，他们可能只是从网络上剪切和粘贴图像或从文件中插入。

在 linux 系统上是否有适合我的解决方案？

谢谢。

**编辑：**

为了我的辩护，我试图将该文档上传到谷歌驱动器并且图像也没有显示。也许没有简单的解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-05-05T07:15:22.880

点安装枕头

从 PIL 导入图像

Image.open("xxx.wmf").save("xxx.png")

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-09-05T15:48:05.243

我发现使用 Wand 包进行这种转换更容易。我尝试了以前的建议但没有成功。所以这就是我所做的：（顺便说一句，我想将所有'.wmf'文件转换为pdf）

```
import os

from wand.image import Image as wima

folder='C:/Users/PythonLover/Pictures/pics'

for oldfilename in os.listdir(folder):

    if oldfilename.endswith(".wmf"):

        with wima(filename=folder+'/'+oldfilename) as img:

            newfilename = oldfilename.split('.')[0]+'.pdf'

            newfilename = folder+'/'+newfilename

            img.format = 'pdf'

            img.save(filename=newfilename) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-03T01:58:27.343

您需要了解您正在处理的内容，以便了解为什么您尝试做的事情是有问题的。WMF 文件（或更新的 EMF 和 EMF+ 格式）需要 Windows GDI 来呈现它所描述的图像。因此，当您在 Windows 之外转换此格式时，没有简单的解决方案，因为您需要复制 GDI API。

一种解决方案是使用依赖于 OpenOffice/LibreOffice 的 UNO 绑定的[unoconv工具。](http://dag.wieers.com/home-made/unoconv/)第二种解决方案将使用[pyemf](http://pyemf.sourceforge.net)模块对输入进行解码，然后使用第二个工具（由您完成）将其渲染。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-31T20:45:48.213

您可以使用`libwmf`将图像转换为 SVG，然后再`pyrsvg`转换为 PNG [（在另一个问题中描述）](https://stackoverflow.com/questions/6589358/convert-svg-to-png-in-python "堆栈溢出帖子")。

我还没有找到`libwmf`项目网站，但 Debian（和 Ubuntu）有`libwmf-bin`包含`wmf2svg`实用程序的包。

# android - Android XMLWise 从资源文件夹读取 Plist

> ID：14103892
> 
> 赞同：2
> 
> 时间：2012-12-31T16:30:57.177
> 
> 标签：android

我有一个关于 XMLWise 的问题。我想在我的资源文件夹（R.raw.key_text.plist）中阅读以下 plist 文件

```
<dict>
   <key> 551 </key>
   <string> Hello World </ string>
   ....
</dict> 
```

对于我的java：

```
Map<String, Object> properties = Plist.load(/*What do I put in here*/); 
```

我在网上搜索过，但似乎无法找到结论。我想在旁边的字符串旁边打印它们的键。

帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-03T12:58:57.497

把你的 plist 放在那里。

```
Map<String, Object> properties = Plist.load("R.raw.key_text.plist"); 
```

# node.js - 结合 Yeoman Server 和 Node Supervisor

> ID：14103894
> 
> 赞同：0
> 
> 时间：2012-12-31T16:31:16.927
> 
> 标签：node.js, yeoman

我正在使用 Yeoman 开发前端 html 应用程序（骨干网和引导程序），并希望使用相同的文件夹进行 api（节点、快递、mongodb）的后端开发。

无论前端或后端更改了什么文件，我想做的是刷新浏览器。

我现在正在做的是：

*   对于 Yeoman，我使用的是“yeoman 服务器”，它会在我每次更改 app 文件夹中的内容时刷新浏览器。
*   我正在使用节点主管模块并执行“主管 server.js”来自动终止服务器并在后端更改文件时重新启动节点服务器。

我想避免这种情况，因为我需要在不同的端口上运行 yeoman 和节点服务器。

有没有办法通过节点主管强制自动重新加载浏览器或使用 yeoman 服务器作为经典节点服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T02:59:46.177

您应该能够使用 command 强制浏览器重新加载[`grunt reload`](https://github.com/yeoman/yeoman/blob/0.9.6/cli/tasks/server.js#L181-L187)。只是`childProcess.exec`或`childProcess.spawn`命令。

# ruby-on-rails-3 - 为什么 Rails 3.2.9 不能自动要求“lib”目录中的 *.rb 文件？

> ID：14103897
> 
> 赞同：0
> 
> 时间：2012-12-31T16:31:32.740
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.2

我意识到默认情况下不再自动加载“lib”。但是，我的 application.rb 文件中有这个：

```
config.autoload_paths += %W(#{config.root}/lib #{config.root}/app/datatables) 
```

我在 lib 中有一个名为 的模块`utility.rb`，声明如下：

```
module MyApp
  module Utility 
```

我有一些实用方法，例如一个方法，它接受一个数组并将其转换为可以从 MySQL 查询的值。我有：

```
include MyApp 
```

在需要该方法的类的顶部，这样我就可以调用：

```
Utility::array_to_query_string 
```

不幸的是，这不起作用。无论是运行 rake 任务还是应用程序，我都会遇到：

```
uninitialized constant MyApp 
```

`require`除了我上面的之外，我不知道如何制作 Rails 。在控制台中，如果我明确键入`require 'utility'`，然后我可以成功地执行包含。我该怎么做才能让 Rails 自动加载这个模块？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:35:20.440

问题可能是您的 lib 文件夹中的目录结构。rails autoloader 可以找到您的文件，它需要放置在正确的位置。您的`MyApp::Utility`模块应该存在于一个名为：`lib/my_app/utility.rb`.

如果您将文件直接放在 lib`lib/utility.rb`中，自动加载器将找不到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:41:07.530

在我的一些应用程序中，我添加了一个初始化程序来加载我的自定义代码。

在 config/initializers/utility.rb 中，

```
require "#{Rails.root}/lib/utility" 
```

# c# - 我需要在这种情况下使用 BaseClass 吗？

> ID：14103899
> 
> 赞同：5
> 
> 时间：2012-12-31T16:31:40.627
> 
> 标签：c#, inheritance, object-oriented-analysis

基本上我有一个名为 Asset 的类，它包含我系统中资产的所有信息。这可能会变得很大（资产有缩略图、文件名、元数据、评级、评论等）。

在我的结果页面上，我列出了所有符合特定条件的资产，然后可以使用 jQuery 进行过滤。

我在 IE8 中发现了性能问题，所以我做的第一件事就是查看 Asset 类，看看在页面上显示 Asset 不需要什么。（后来我访问了我的 jQuery，发现这是导致性能问题的原因）。

因此，当我将我的课程剥离到基础知识时，我制作了 BaseAsset 并从中派生了 Asset。

我的问题是，我需要这样做吗？有什么需要吗？

如有必要，我将提供示例，但我暂时避免，因为帖子可能会变得很大:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T16:39:30.037

我不认为你需要一个`base class`人说，我认为你需要的是发送**你需要的东西。**问题似乎只是因为您并不总是**需要**所有数据*。*

我知道这很乏味，但只在需要**时发送你需要的东西***，*你不会有任何问题。当您*需要*更多数据时，可以使用 AJAX 调用异步加载它，或者甚至创建另一个用户导航到的页面。

# actionscript-3 - 我可以使用 AS3 Stage3D AGAL 来实现类似 CUDA 的处理吗？

> ID：14103902
> 
> 赞同：1
> 
> 时间：2012-12-31T16:32:10.797
> 
> 标签：actionscript-3, flash, apache-flex, stage3d, agal

我有一个程序可以在 320x240 流运行时检测球，但是如果我流更大的分辨率，它会变得太慢。我假设如果我可以使用 GPU 来计算每个像素（以及它们的相邻帧和相邻像素），它会更快。任何人都知道我是否可以使用 AGAL 从 GPU 取回数据？

在排序中，我有下面的循环，通过帧的每个像素，我想在 GPU 上计算最多，以获得更好的性能。

```
for(var i:int=cv.length-1; i>1;i--){
                if( (110*255) < (cv[i] & 0x0000FF00) && (cv[i] & 0x0000FF00) < (150*255)){ //i zöld
                    if(  (cv[i+2] & 0x0000FF00) > (150*255) ) { //i+2 világos
                        if(floodhere(cv, i+2)){ //méret nagy
                            prevDiff[i]=0xffffffff; //fehér
                            close.push(i);
                        }
                        else prevDiff[i]=0xffff0000 //méret kicsi -> piros
                    } else {
                        prevDiff[i]=0xff000055 //kék
                    }
                } else {
                    prevDiff[i]=0xff000000 //fekete
                }
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-17T00:00:50.037

您可以使用 AGAL 在 GPU 上进行快速计算，但请注意限制。它大致是这样的：
您需要将数据作为纹理（an*m 矩阵）上传，一个数据点是一个 3x8 位值。将任何类型的大数据上传到 GPU 都很慢，因此您不应该在每一帧都这样做。将纹理恢复到 Actionscript 也很慢。
您可以将数据上传到 GPU 到其全局变量内存（但数量有限）

GPU 将在该矩阵的每个元素上并行运行您的 AGAL 程序，并且输出也将是一个 n*m 矩阵。
每个程序实例都可以访问三件事：它的坐标、全局变量和上传的矩阵。您的程序的输出将被写入到相同位置的输出矩阵。如果您编写多个程序，可以快速访问此输出矩阵，但将其恢复到正常内存（用于操作脚本操作）很慢。

与 Actionscript 相比，AGAL 程序非常有限：
- 最大。256 条指令。
- 没有循环、函数、类。您只有数学运算符和条件（“if-else”）。
- 无法写入全局内存

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T03:40:22.067

您也许可以使用 PixelBender。它还可以在单​​独的线程中工作，并利用多核 CPU，因此比 actionscript 快得多。

有关示例，请参见[http://www.flashmagazine.com/tutorials/detail/using_pixel_bender_to_calculate_information/](http://www.flashmagazine.com/tutorials/detail/using_pixel_bender_to_calculate_information/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T12:32:28.903

没有办法取回数据。你只能恢复颜色。此外，要在动作脚本中获取像素颜色，您应该将数据从纹理复制到位图数据，这非常慢。

# python - __init__ 还是 __call__？

> ID：14103903
> 
> 赞同：9
> 
> 时间：2012-12-31T16:32:16.827
> 
> 标签：python

我应该什么`__init__`时候使用什么`__call__`方法？

我很困惑我应该使用第一个还是第二个。

目前我可以同时使用它们，但我不知道哪个更合适。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-31T16:34:35.657

这两个是完全不同的。

`__init__()`是构造函数，它在对象的新实例上运行。

`__call__()`当您尝试像调用函数一样调用对象的实例时运行。

例如：假设我们有一堂课，`Test`：

```
a = Test() #This will call Test.__init__() (among other things)
a() #This will call Test.__call__() 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-31T16:35:24.200

快速测试显示它们之间的区别

```
class Foo(object):
    def __init__(self):
        print "init"
    def __call__(self):
        print "call"

f = Foo()  # prints "init"
f()        # prints "call" 
```

这些绝不是可以互换的

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-12-31T16:36:08.740

最有可能的是，您想使用`__init__`. 这是用于初始化类的新实例的方法，您可以通过调用该类来创建该实例。`__call__`如果您想让您的实例可调用。这不是经常做的事情，尽管它可能很有用。这个例子应该说明：

```
>>> class C(object):
...   def __init__(self):
...     print 'init'
...   def __call__(self):
...     print 'call'
... 
>>> c = C()
init
>>> c()
call
>>> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-12-28T08:42:35.820

一个简单的代码片段将更好地阐述这一点。

```
>>> class Math:
...     def __init__(self):
...             self.x,self.y=20,30
...     def __call__(self):
...             return self.x+self.y
... 
>>> m=Math()
>>> m()
50 
```

# facebook-graph-api - Facebook：打开图表操作不聚合

> ID：14103905
> 
> 赞同：5
> 
> 时间：2012-12-31T16:32:30.057
> 
> 标签：facebook-graph-api, facebook-javascript-sdk, facebook-opengraph

我正在开发一个 facebook 开放图形应用程序，该应用程序将允许登录我的网站并通过我的网站进行身份验证的用户在他们的 facebook 时间线上汇总“最近阅读”的文章。

我已经创建了聚合并且添加预览对象似乎可以工作，并且它适当地出现在“时间线预览”区域中。发布动作有效并且它出现在活动日志中（虽然不在时间线中，除非我手动告诉它出现在那里）。

使用 facebooks url scraper，我的链接似乎工作正常，并且所有预期的元标记确实出现了，但同样 - 没有聚合。

到目前为止，我已经用我的应用发布了大概 8 或 9 个故事，但仍然没有汇总。

这是一些代码..

Facebook登入

```
$('.facebook-login').click(function() {
        var loginBool = $(this).hasClass('loginfb');

        if (!loginBool) {
            FB.logout(function(response){
                if (response.authResponse) {
                    updateStatus();
                }
            });
        }
        else if (loginBool) {
            FB.login(function(response){
                if (response.authResponse) {
                    updateStatus();
                }
            }, {scope: 'user_about_me,user_birthday,user_interests,user_likes,user_location,read_stream,email,publish_actions,publish_stream'});
        }
    }); 
```

FB.app 分享码

```
$('.read-action').click(function() {
    FB.api('/me/news.reads', 'post',{
        article : window.location.href
    }, function(response){ console.log(response)} );
}); 
```

发布动作会在 javascript 控制台中记录动作 ID，就像我说的那样，它会显示在活动日志中，在允许它出现后我可以在时间轴上看到它。

聚合设置如下：

要显示的数据：读取

布局显示：列表

有什么我做错了，或者需要什么步骤来汇总我的帖子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T21:06:15.077

我对其他内置操作也有同样的问题。内置操作类型似乎不允许自定义聚合。但是内置聚合足够理智。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T21:00:18.263

What is the value of `Data to Display` in your aggregation?

Sometimes you need to do several OG actions of that type in order for the aggregation to start showing up on your timeline.

# javascript - RingoJS httpserver 抛出 BindException

> ID：14103906
> 
> 赞同：0
> 
> 时间：2012-12-31T16:32:36.353
> 
> 标签：javascript, httpserver, ringojs

我在 RingoJS 中遇到了一个非常奇怪的问题。考虑以下保存在中的代码`main.js`：

```
var {Application} = require("stick");
var {main} = require("ringo/httpserver");
var app = exports.app = new Application;
app.configure("error", "notfound");
if (module === require.main)
    main(module.id); 
```

运行按预期`ringo main.js`启动 http 服务器`http://localhost:8080/`，显示默认`notfound`页面。

现在考虑以下代码，它与上面相同，除了我将`if`条件硬编码为`true`：

```
var {Application} = require("stick");
var {main} = require("ringo/httpserver");
var app = exports.app = new Application;
app.configure("error", "notfound");
if (true) main(module.id); 
```

运行`ringo main.js`会启动 http 服务器，但在打开站点时它会给我一个`error`页面而不是`notfound`页面。它说`Wrapped java.net.BindException: Address already in use`并给了我以下堆栈跟踪：

```
at ringo/httpserver.js:327 (Server)
at ringo/httpserver.js:428 (init)
at ringo/httpserver.js:506 (main)
at /home/aaditmshah/main.js:5
at ringo/jsgi/connector.js:28 (handleRequest) 
```

发生了什么？条件如何`if`影响服务器？毕竟这两个条件都表达了价值`true`（这就是http服务器工作的原因）。这让我非常困惑。它是一个错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-19T09:21:16.093

进来的请求将在您的脚本的第二个版本中重新执行您的主模块。我们写“if (module === require.main)”是有原因的，请参阅本页底部：[http ://ringojs.org/tutorial/httpserver.md](http://ringojs.org/tutorial/httpserver.md)

# c++ - 在 C++11 中返回一个可变值

> ID：14103911
> 
> 赞同：0
> 
> 时间：2012-12-31T16:33:40.630
> 
> 标签：c++, c++11, rvalue-reference, rvalue

我想知道让一个方法返回一个 r 值。具体来说，我想知道是否有办法使用重载的运算符来做到这一点。我有这个代码：

```
struct vec4 {
    float x;
    float y;
    float z;
    float w;
    ...
    inline float operator [] (int i)
    {
            switch (i) {
            case 0:
                    return this->x;
            case 1:
                    return this->y;
            case 2:
                    return this->z;
            case 3:
                    return this->w;
            default:
                    exit(1);
                    return 0;
            }
    }
}; 
```

我怎样才能改变它，以便我可以使用一些东西来达到

```
vec4 v;
...
v[2] = 5.0f; 
```

我听说过 C++11 中的右值引用，它们可能是一个潜在的解决方案吗？

编辑：我找到了一种方法来输入我的实际代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T16:36:20.317

为此不需要 C++11。只要有：

```
float & operator[](std::size_t i) { return data[i]; } 
```

现在你可以说`v[2] = 5;`一切都很好。

如果您愿意，您可以添加一个不使用引用且可用于*读取*值的常量重载。

```
float operator[](std::size_t i) const { return data[i]; } 
```

* * *

您唯一可能考虑使用右值成员函数限定符的情况是，如果您想允许分配*给*临时成员：

```
vec4{}[2] = 5; 
```

在这种情况下，您仍然返回一个左值引用，但您必须限定成员函数：

```
float & operator[](std::size_t i) && { return data[i]; }
//                               ^^^^ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-31T16:37:27.810

对于你想要完成的事情，你显然想要返回一个左值，而不是一个右值。这实际上很容易：

```
float &operator[](size_t i) { return data[i]; } 
```

请注意，当您在类定义中定义函数时，这`inline`是多余的——在类定义中定义函数使其成为`inline`默认值。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-31T16:36:07.913

您可以简单地使用：

```
float& operator [] (int index)
{
    return data [i];
} 
```

这使您可以编写`v[2] = 5.0f;`并且它将按预期工作。这里不需要 r 值引用。

您还应该添加一个 const-overload 来检索该值，如下所示：

```
float operator [] (int index) const
{
    return data [i];
} 
```

这将允许您编写如下代码：`const vec4 v; float x = v[1];`.

# javascript - Javascript .slice 方法（深入了解）

> ID：14103912
> 
> 赞同：-1
> 
> 时间：2012-12-31T16:33:45.793
> 
> 标签：javascript, arrays, function, methods

我是编程新手，正在研究 LearnStreet 的*“写作功能”*。我的问题是：

```
function capitalizeFirst(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
} 
```

我明白了，如果它只是：

```
return str.charAt(0).toUpperCase(); 
```

只有第一个字母会被返回并大写，但为什么添加会返回`.slice(1)`整个字符串？

如果是：

```
capitalizeFirst("i am apple");
// "I am apple" is returned 
```

但与

```
function capitalizeFirst(str) {
    return str.charAt(0).toUpperCase() + str.slice(0); // 0 instead of 1
}

capitalizeFirst("i am apple");
// "Ii am apple" is returned 
```

提前感谢您对此问题的任何帮助/指导。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T16:36:24.170

`str.slice(x, y)``x`将返回 index和 index之间的字符串字符`y`。
如果你不通过`y`（你不通过），它默认到字符串的末尾。

因此，`str.slice(1)`将返回字符串中从 index 开始的所有字符`1`。
由于索引是从零开始的，这意味着除了第一个字符之外的所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T17:11:13.793

你的困惑是自然的。几乎每个程序员在他们生命中的某个时刻都会犯[一个错误。](http://en.wikipedia.org/wiki/Off-by-one_error "一个错误 - 维基百科，免费的百科全书")因此，我将使用示例向您解释：

考虑字符串`"Hello World!"`。在计算机中，它将在内存中表示为字符数组。它看起来像这样：

```
+---+---+---+---+---+---+---+---+---+---+---+---+
| H | e | l | l | o |   | W | o | r | l | d | ! |
+---+---+---+---+---+---+---+---+---+---+---+---+
0   1   2   3   4   5   6   7   8   9  10  11  12 
```

现在我想让你注意只有 12 个框（字符），但有 13 个索引（`0`to `12`）。索引在字符之间。

**注意：**最后一个索引始终是数组的长度。

程序员常犯的一个错误是，当他们考虑数组时，他们考虑的是框而不是索引。

**重要提示：**数组是根据其索引而不是框数来描述的。

现在让我们看看`slice`方法。此方法采用两个索引，第二个是可选的。它返回给定字符串的子字符串。

例如，如果我只想要`"World"`from`"Hello World!"`我会像这样提取它（`"World"`从 index 开始并在 index`6`结束`11`）：

```
"Hello World!".slice(6, 11); // "World" 
```

如果我想要空格后的所有内容`"Hello World!"`（即如果我想要`"World!"`），那么我可以使用简短形式而不是`slice(6, 12)`. 这里`12`是隐含的，所以我可以简单地使用`slice(6)`：

```
"Hello World!".slice(6); // "World!" 
```

我什至可以在不知道字符串长度的情况下使用负索引来提取字符串的最后一个字符：

```
"Hello World!".slice(-1); // "!" 
```

这里`-1`代表索引`length - 1`。由于`length`被定义为最后一个索引，因此`12 - 1`在这种情况下很简单。因此它返回 index 之后的所有内容`11`。

**明白了吗？**所以现在你了解了栅栏问题。

这就是为什么你在调用时得到整个字符串的原因`slice(0)`；和你打电话时第一个字符之后的所有内容`slice(1)`。

在处理数组时，永远记住要考虑索引而不是框。

**在字符之间阅读。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T16:37:29.150

slice(1) 返回字符串的其余部分，即第一个字符之后的所有内容。因此，您可以通过将第一个字母（大写）和字符串的其余部分相加来获得整个字符串。

# linux - Amazon EC2 上的 zfs 安装问题 Ubuntu 12.04

> ID：14103914
> 
> 赞同：0
> 
> 时间：2012-12-31T16:33:55.760
> 
> 标签：linux, amazon-ec2, ubuntu-12.04, zfs

我将三个 3GB 的 EBS 卷附加到一个 Amazon EC2 微实例并安装了磁盘 xvdd、xvdc 和 xvdb。

我的目标是使用这 3 个磁盘创建一个 zfs 池。

我已经更新、升级了 Ubuntu 12.04，安装了 zfs-linux 依赖项，添加了 zfs-native repo PPA，然后发出了 zfs install 命令，它是

```
sudo apt-get install ubuntu-zfs 
```

在此之后，我得到如下所示的控制台状态，并且在下面**指示的“运行部件：”状态之后，安装过程从未继续进行**。我等了 20 多分钟，得到了这个：

```
Setting up zfs-dkms (0.6.0.91-0ubuntu1~precise1) ...
Loading new zfs-0.6.0.91 DKMS files...
First Installation: checking all kernels...
Building only for 3.2.0-31-virtual
Module build for the currently running kernel was skipped since the
kernel source for this kernel does not seem to be installed.
Setting up linux-headers-3.2.0-35 (3.2.0-35.55) ...
Setting up linux-headers-3.2.0-35-generic (3.2.0-35.55) ...
Examining /etc/kernel/header_postinst.d.
run-parts: executing /etc/kernel/header_postinst.d/dkms 3.2.0-35-generic /boot/vmlinuz-3.2.0-35-generic 
```

这个问题与 Ubuntu 的 EC2 内核有关吗？或者运行 ZFS 的机器是否应该具有更高的容量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T12:00:59.483

通常对于托管服务提供商，内核就是这种情况。我的提供商 (ovh) 提供了他们自己定制的（据称更安全）内核（可惜没有源代码），尽管不情愿地允许安装通用内核，这为我解决了这个问题。我不了解亚马逊——也许他们定制的内核对他们的 EC2 服务至关重要。另一方面，我非常怀疑任何托管服务提供商会生成其内核的源代码。

# html - 如何在 Joomla 2.5 模板中垂直对齐这两列？

> ID：14103915
> 
> 赞同：0
> 
> 时间：2012-12-31T16:34:00.273
> 
> 标签：html, css, joomla, joomla2.5, joomla-template

我对以下 Joomla 2.5 模板（或者可能是模块的 CSS 样式）有一些问题。

如果你去这里你可以理解我的意思： http: [//onofri.org/scorejava/](http://onofri.org/scorejava/)

正如您在主要内容区域中看到的那样，我有两列（由名为“特色类别”的模块的两个不同实例创建，这一列：[http](http://www.joomlacsszengarden.com/joomla16/index.php/featured-categories) ://www.joomlacsszengarden.com/joomla16/index.php/featured-categories )

这两列的标题是“Articoli più letti”和“Ultimi articoli”。

您可以看到第一列的标题与第二列的标题没有垂直对齐。

我试图理解为什么使用 Firebug，但目前我还没有找到解决方案......

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:46:57.823

`rt-block`默认情况下，类具有 15px 填充。右边的块（带有'ultimi'）具有填充0，因为它被不同的块包裹。

请看下面的代码：

```
<div id="rt-content-bottom">
    <div class="rt-grid-5 rt-alpha">
        <div class="rt-block">
...
    <div class="rt-grid-4 rt-omega">
       <div class="rt-block"> 
```

和CSS：

```
rt-main .rt-container .rt-grid-6 .rt-block, #rt-main .rt-container .rt-grid-4 .rt-block {
padding: 0;
} 

.rt-block { margin-bottom: 10px; padding: 15px; position: relative; } 
```

只需将相同的填充值设置为 .rt-grid-5 .rt-block 和 rt-grid-4 .rt-block

# r - 一个图中两个图例之间的间隙较小（例如颜色和大小比例）

> ID：14103920
> 
> 赞同：22
> 
> 时间：2012-12-31T16:34:43.643
> 
> 标签：r, ggplot2

如何减少一个情节中两个指南之间的差距。在下面的示例中，两个指南来自颜色和大小比例，我想更改两者之间的差距，以便标题“大小”正好低于 1 的图例点。设计方面，它可能不会在此示例中有意义，但在我的实际应用中确实如此。

```
df=data.frame(x=rnorm(100),y=rnorm(100),color=factor(rbinom(100,1,0.5)),size=runif(100))
ggplot(df,aes(x=x,y=y,color=color,size=size)) + geom_point() 
```

编辑：这是情节。我想让绿线和箭头突出显示的间隙变小。

![在此处输入图像描述](../Images/da50aef16b6bcc7d624ef9d4aa111540.png)

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2017-03-10T11:01:18.457

现在似乎可以使用主题参数：

```
ggplot(df,aes(x=x,y=y,color=color,size=size)) + geom_point() + 
theme(legend.spacing.y = unit(-0.5, "cm")) 
```

您还可以尝试减少图例的边距：

```
legend.margin = margin(-0.5,0,0,0, unit="cm") 
```

或更老

```
legend.margin=unit(0, "cm") 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-01T10:26:46.303

我试图玩自定义`legend`或`guide`参数，但我找不到解决方案。我希望使用 ggplot2 设置提供解决方案。

这里有 2 个基于`gtable`和`grid`包的解决方案。

对于`gtable`解决方案，代码的灵感来自这个[问题](https://stackoverflow.com/questions/13426470/justification-of-multiple-legends-in-ggmap-ggplot2)。

![在此处输入图像描述](../Images/f0109a97395456ae363e17782cb32201.png)

```
 library(gtable)
  # Data transformation
  data <- ggplot_build(p)
  gtable <- ggplot_gtable(data)
  # Determining index of legends table
  lbox <- which(sapply(gtable$grobs, paste) == "gtable[guide-box]")
  # changing the space between the 2 legends: here -0.5 lines
  guide <- gtable$grobs[[lbox]]
  gtable$grobs[[lbox]]$heights <- unit.c(guide$heights[1:2],
                                    unit(-.5,'lines'),  ## you can the GAP here
                                    guide$heights[4:5])
  # Plotting
  grid.draw(gtable) 
```

使用包类似`grid`（我们在图例的视口中重绘）

```
pp <- grid.get('guide',grep=T)
 depth <- downViewport(pp$wrapvp$name)
 guide <- grid.get('guide',grep=T)
 grid.rect(gp=gpar(fill='white'))
 guide$heights <- unit.c(guide$heights[1:2],unit(-0.2,'lines'),guide$heights[4],unit(0.1,'lines'))
 grid.draw(guide)
 upViewport(depth) 
```

# haskell - Haskell 返回类型多态性

> ID：14103927
> 
> 赞同：6
> 
> 时间：2012-12-31T16:35:34.153
> 
> 标签：haskell

我有以下数据结构：

```
data TempUnit = Kelvin Float
              | Celcius Float
              | Fahrenheit Float 
```

我想实现一个将温度从开尔文转换为另一个单位的功能。如何将返回类型单元传递给函数？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-31T16:50:02.517

这样做的一种方法是为不同的温度单位使用 3 种不同的类型，然后使用类型类将它们“统一”为温度，例如

```
newtype Kelvin = Kelvin Float
newtype Celcius = Celcius Float
newtype Fahrenheit = Fahrenheit Float

class TempUnit a where
   fromKelvin :: Kelvin -> a
   toKelvin :: a -> Kelvin

instance TempUnit Kelvin where
   fromKelvin = id
   toKelvin = id

instance TempUnit Celcius where
   fromKelvin (Kelvin k) = Celcius (k - 273.15)
   toKelvin (Celcius c) = Kelvin (c + 273.15)

instance TempUnit Fahrenheit where
   fromKelvin (Kelvin k) = Fahrenheit ((k-273.15)*1.8 + 32)
   toKelvin (Fahrenheit f) = Kelvin ((f - 32)/1.8 + 273.15 
```

现在您可以只使用`toKelvin`/`fromKelvin`并且将根据（推断的）返回类型选择适当的实现，例如

```
absoluteZeroInF :: Fahrenheit 
absoluteZeroInF = fromKelvin (Kelvin 0) 
```

（注意使用`newtype`而不是`data`，这与`data`没有额外构造函数的运行时成本相同。）

该方法自动提供任意转换功能`convert :: (TempUnit a, TempUnit b) => a -> b`：`convert = fromKelvin . toKelvin`. 需要注意的是，这需要编写处理具有`TempUnit a => ... a`约束的任意温度的函数的类型签名，而不仅仅是简单的`TempUnit`.

* * *

也可以使用一个“哨兵”值，否则会被忽略，例如

```
fromKelvin :: TempUnit -> TempUnit -> TempUnit
fromKelvin (Kelvin _) (Kelvin k) = Kelvin k
fromKelvin (Celcius _) (Kelvin k) = Celcius (k - 273.15)
fromKelvin (Fahrenheit _) (Kelvin k) = Fahrenheit (...) 
```

（这可能通过@seliopou 建议的方法更好地完成：打破一个单独的`Unit`类型。）

这可以像这样使用：

```
-- aliases for convenience
toC = Celcius 0
toK = Kelvin 0
toF = Fahrenheit 0

fromKelvin toC (Kelvin 10)
fromKelvin toF (Kelvin 10000) 
```

请注意，此方法*不是*类型安全的：尝试转换时会发生`Celcius 100`什么`fromKelvin`？（即 的值是`fromKelvin toF (Celcius 100)`多少？）

* * *

综上所述，最好在一个单元上进行内部标准化，仅在输入和输出上转换为其他单元，即只有读取或写入温度的函数需要担心转换，其他一切都可以使用（例如）`Kelvin`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-31T16:45:55.080

让我建议一个可以帮助你的重构：

```
data Unit = Kelvin | Celcius | Fahrenheit
data Temp = Temp Unit Float 
```

然后你可以轻松地做你想做的事：

```
convert :: Temp -> Unit -> Temp 
```

**编辑：**

如果你不能执行重构，那么你仍然可以做你想做的事情，只是有点不干净：

```
convert :: Temp -> Temp -> Temp 
```

假设您要将温度`Kelvin`（绑定到标识符的值`t`）转换为`Celcius`。你会做这样的事情：

```
convert t (Celcius 0) 
```

您的实现`convert`将在第二个参数上进行模式匹配以确定要转换为的单位。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-31T16:55:42.170

您的代码中只有一种类型，那就是`TempUnit`. `Kelvin`，`Celcius`并且`Fahrenheit`不是类型，它们是数据构造函数。所以你不能使用多态性在它们之间进行选择。

如果要使用返回类型多态性，则需要定义 3 个不同的类型并使它们成为同一类型类的实例。这可能看起来像这样：

```
newtype Kelvin = Kelvin Float
newtype Celsius = Celsius Float
newtype Fahrenheit = Fahrenheit Float

class Temperature t where
  fromKelvin :: Kelvin -> t
  toKelvin :: t -> Kelvin

instance Temperature Kelvin where
  fromKelvin = id
  toKelvin = id

instance Temperature Celsius where
  fromKelvin (Kelvin k) = Celsius $ -- insert formula here
  toKelvin (Celsius c) = Kelvin $ -- insert formula here

instance Temperature Fahrenheit where
  -- same as for Celsius 
```

然后，您可以通过提供类型注释（或在需要特定类型的上下文中使用结果）来选择所需的转换：

```
myTemp :: Celsius
myTemp = fromKelvin $ Kelvin 42 
```

然而，这似乎不是对多态性的良好使用。您拥有代数数据类型`TemperatureUnit`然后将温度表示为与单位相结合的数字的方法似乎更合理。这样，转换函数将简单地将目标单元作为参数 - 不涉及多态性。

# c# - 在 NativeWindow 中等待消息

> ID：14103929
> 
> 赞同：1
> 
> 时间：2012-12-31T16:35:38.557
> 
> 标签：c#, messaging, wndproc, autoresetevent, nativewindow

我正在尝试做的是`WM_TIMER`在我的进程中的窗口上捕获并等待消息（尽管我无法控制）。

我正在尝试使用 an`AutoResetEvent`来等待消息。

该`WaitForMaterialUpdate`方法将 连接`NativeWindow`到窗口，并阻塞直到收到消息。

这是我正在使用的代码：

```
public class MaterialEditorWindow : NativeWindow
{
    private const int WM_TIMER = 0x0113;

    private AutoResetEvent waiter;

    public void WaitForMaterialUpdate(IntPtr handle)
    {
        waiter = new AutoResetEvent(false);
        AssignHandle(handle);
        waiter.WaitOne(5000);
        ReleaseHandle();
    }

    protected override void WndProc(ref Message m)
    {
         if (m.Msg == WM_TIMER) waiter.Set();
         base.WndProc(ref m);
    }
} 
```

我不是在一个非常可调试的环境中，但我已经确认使用`MessageBox`该窗口实际上`WM_TIMER`在等待期间接收消息，但`WaitOne`总是在返回之前等待完整的 5000 毫秒超时时间。

知道我哪里出错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:49:27.917

`WaitOne()`是阻塞调用。UI 线程在返回
之前不会收到任何消息。`WaitOne()`由于您在 UI 线程收到消息时设置了等待句柄，因此您遇到了死锁。

您需要在后台线程上执行此操作，或者在收到消息时简单地调用回调。

# java - 使用菜单更改文本字体

> ID：14103937
> 
> 赞同：3
> 
> 时间：2012-12-31T16:36:32.737
> 
> 标签：java, swing, fonts, awt, jmenuitem

我有这段代码，当用户单击其中一种字体“粗体或斜体......”时，文本应该会改变。我无法添加将执行此操作的操作侦听器：

```
import java.awt.*;
import javax.swing.*;
import java.awt.event.*;

public class question4 extends JFrame {

    private JTextField textField;
    private JComboBox fontbox;
    private String names[]={ "Bold","Italic","Plain"};
    private Icon icons[]={};

    public question4()
    {
        super("JcheckBox");
        setLayout(new FlowLayout());//set frame
        fontbox = new JComboBox(names);//set jcobobox
        fontbox.setMaximumRowCount(3);
        //listener

        add(fontbox);
        //add the text content
        textField = new JTextField ("Hello World", 20);
        textField.setFont(new Font("Calibri", Font.BOLD,18));//set the text font and size
        add(textField);//add textfield to jframe
    }

    public static void main(String args[])
    {
        question4 obj = new question4();//create object
        obj.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        obj.setSize(700,400);
        obj.setVisible(true);
    }//end main

 }//end class 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T17:03:11.707

这里有一些指导方针可以帮助您，而不是直接为您提供解决方案：

*   重新审视 an `ActionListener`（甚至是[Action](http://docs.oracle.com/javase/tutorial/uiswing/misc/action.html)）的概念，特别是在`JComboBox` `fontbox`.
*   为您的样式创建一个`JComboBox`自定义对象，`Font`以便包装显示的文本和要使用的整数常量（提示）。作为指南，请参阅此[示例](https://stackoverflow.com/questions/8804674/jtable-jcombobox-using-custom-objects)
*   然后在您的 中`ActionListener`，读取从[getSelectedItem](http://docs.oracle.com/javase/7/docs/api/javax/swing/JComboBox.html#getSelectedItem%28%29)返回的值，并`JTextField.setFont`使用对象中的样式常量相应地调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T18:43:29.497

您需要像`ActionListner`这样添加`FontBox (JcomboBox)`：

```
 private void fontboxActionPerformed(java.awt.event.ActionEvent evt) {
    String font = (String) fontbox.getSelectedItem();

    if(font=="Bold")
        textField.setFont(new Font("Calibri", Font.BOLD, 18));
    else if(font == "Italic")
        textField.setFont(new Font("Calibri", Font.ITALIC, 18));
    else if(font == "Plain")
        textField.setFont(new Font("Calibri", Font.PLAIN, 18));

} 
```

并在您的代码中调用此方法，如下所示：

```
fontbox.addActionListener(new java.awt.event.ActionListener() {
    public void actionPerformed(java.awt.event.ActionEvent evt) {
        fontboxActionPerformed(evt);
    }
}); 
```

# sql - 使用 Vbscript 处理大型 csv（500k 记录）并将其导入 SQL 服务器的最佳方法是什么？

> ID：14103940
> 
> 赞同：3
> 
> 时间：2012-12-31T16:36:57.323
> 
> 标签：sql, sql-server, sql-server-2008, asp-classic, vbscript

我的系统需要通过 CSV 上传导入大量姓名和电子邮件地址（仅两个字段）。

我可以很容易地处理上传，在处理导入之前如何验证电子邮件地址。

另外，我怎样才能快速处理这个或作为后台进程而不需要用户观看脚本？

使用经典 ASP/SQL Server 2008。

请不要嘲笑经典的 asp。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T17:49:59.190

您是否需要通过 ASP 应用程序进行此上传？如果不是，那么无论哪种脚本语言你觉得最舒服，并且可以用最少的编码时间做到这一点，都是完成这项工作的最佳工具。如果您需要用户能够上传到经典的 ASP 应用程序并有一个可靠的过程来将有效记录插入数据库并拒绝无效记录，那么您的选项会改变。

您需要向用户提供反馈吗？就像告诉他们确切的行是无效的？

如果您正在处理第二种情况，我会让 asp 应用程序简单地存储文件，并有另一个进程、.net 服务或计划任务或其他东西，进行导入并在文本中报告其进度asp 应用程序可以检查的文件。这使您可以重新使用您熟悉的任何脚本语言来执行此操作，并且您不必处理 http 请求超时。

如果您搜索“正则表达式有效电子邮件”，您可以找到各种用于识别无效电子邮件地址的正则表达式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T23:15:46.090

[在以前的生活中，我曾经通过使用DTS](http://msdn.microsoft.com/en-us/library/aa933484%28v=SQL.80%29.aspx)将文件拖到工作表中，然后使用批量 SQL 命令处理该文件来执行此类操作。今天，您将使用[集成服务](http://msdn.microsoft.com/en-us/library/ms141026%28v=sql.100%29.aspx)。

这使您可以非常快速地将数据导入 SQL Server，并防止脚本超时，然后您可以使用您喜欢的任何方法（例如 AJAX 驱动的批处理、重定向驱动的批处理等）来处理谨慎的块数据，或将其安排为作为单个批处理（[SQL Server 作业](http://msdn.microsoft.com/en-us/library/ms187763%28v=sql.100%29.aspx)）运行并仅报告结果。

您可能很幸运能够通过上传脚本一次性处理 500K 行，但我不会碰运气。

# python - 找不到正确的正则表达式语法来匹配换行符或字符串结尾

> ID：14103942
> 
> 赞同：12
> 
> 时间：2012-12-31T16:37:01.453
> 
> 标签：python, regex, newline

这感觉像是一个非常简单的问题，但我在任何地方都找不到答案。

（注意：我使用的是 Python，但这无关紧要。）

假设我有以下字符串：

```
s = "foo\nbar\nfood\nfoo" 
```

我只是试图找到一个正则表达式，它将匹配“foo”的两个实例，但不匹配“food”，基于“food”中的“foo”不是紧跟换行符或结尾的事实细绳。

这可能是表达我的问题的一种过于复杂的方式，但它提供了一些具体的东西。

以下是我尝试过的一些事情，有结果（注意：我想要的结果是 [ `foo\n`, `foo`]）：

`foo[\n\Z]` => [ `'foo\n'`]

`foo(\n\Z)` => [ `'\n'`, `''`] <= 这似乎与换行符和 EOS 匹配，但不是`foo`

`foo($|\n)` => [ `'\n'`, `''`]

`(foo)($|\n)` => [( `foo`, `'\n'`), ( `foo`, `''`)] <= 差不多了，这是一个可用的 B 计划，但我想找到完美的解决方案。

我发现唯一有效的是：

`foo$|foo\n` => [ `'foo\n'`, `'foo']

对于这样一个简单的例子来说这很好，但是很容易看出它是如何使用更大的表达式变得笨拙的（是的，这个`foo`东西是我实际使用的更大表达式的替代品）。

* * *

有趣的是：我能找到的最接近我的问题的 SO 问题是这个：[在正则表达式中，匹配字符串的结尾或特定字符](https://stackoverflow.com/questions/12083308/in-regex-match-either-the-end-of-the-string-or-a-specific-character)

在这里，我可以简单地替换`\n`我的“特定角色”。现在，接受的答案使用 regex `/(&|\?)list=.*?(&|$)/`。我注意到 OP 正在使用 JavaScript（问题被标记为`javascript`标签），所以 JavaScript 正则表达式解释器可能不同，但是当我在 Python 中使用上述正则表达式的问题中给出的确切字符串时，我得到了不好的结果：

```
>>> findall("(&|\?)list=.*?(&|$)", "index.php?test=1&list=UL")
[('&', '')]
>>> findall("(&|\?)list=.*?(&|$)", "index.php?list=UL&more=1")
[('?', '&')] 
```

所以，我很难过。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-31T16:55:17.487

```
>>> import re
>>> re.findall(r'foo(?:$|\n)', "foo\nbar\nfood\nfoo")
['foo\n', 'foo'] 
```

`(?:...)`做一个[非捕获组](http://www.regular-expressions.info/refadv.html)。

这是有效的，因为（来自[re 模块参考](http://docs.python.org/2/library/re.html)）：

> re.findall（模式，字符串，标志=0）
> 
> 返回字符串中模式的所有非重叠匹配，作为字符串列表。从左到右扫描字符串，并按找到的顺序返回匹配项。*如果模式中存在一个或多个组，则返回组列表；如果模式有多个组，这将是一个元组列表。*空匹配包含在结果中，除非它们触及另一个匹配的开始。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-31T16:49:13.657

您可以在模式中使用*并*包含`re.MULTILINE`可选的换行符：*`$`*

 *```
s = "foo\nbar\nfood\nfoo"
pattern = re.compile('foo$\n?', re.MULTILINE)
print re.findall(pattern, s)
# -> ['foo\n', 'foo'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T16:38:37.280

If you're only concerned with `foo`:

```
In [42]: import re

In [43]: strs="foo\nbar\nfood\nfoo"

In [44]: re.findall(r'\bfoo\b',strs)
Out[44]: ['foo', 'foo'] 
```

`\b` is denotes a word boundary:

> `\b`
> 
> Matches the empty string, but only at the beginning or end of a word. A word is defined as a sequence of alphanumeric or underscore characters, so the end of a word is indicated by whitespace or a non-alphanumeric, non-underscore character. Note that formally, \b is defined as the boundary between a \w and a \W character (or vice versa), or between \w and the beginning/end of the string, so the precise set of characters deemed to be alphanumeric depends on the values of the UNICODE and LOCALE flags. For example, r'\bfoo\b' matches 'foo', 'foo.', '(foo)', 'bar foo baz' but not 'foobar' or 'foo3'. Inside a character range, \b represents the backspace character, for compatibility with Python’s string literals.

([Source](http://docs.python.org/2/library/re.html#regular-expression-syntax))*

# delphi - Indy 10 TCP 服务器

> ID：14103944
> 
> 赞同：6
> 
> 时间：2012-12-31T16:37:03.377
> 
> 标签：delphi, delphi-7, indy, indy10, tcpserver

经过大量搜索后，我认为 Indy TCP 服务器将是我正在开发的即时通讯服务器上使用的最佳选择。我现在面临的唯一问题是向其他连接的客户端广播和转发消息，向同一个客户端发送回响应似乎没问题并且不会挂起其他客户端的活动，但是对于将消息转发给其他客户端的机制，我知道是通过使用`aContext.locklist`, 并在连接列表之间进行迭代以找到要接收数据的客户端连接。

我认为这里的问题是它冻结了列表并且在调用解锁列表之前不处理其他客户端请求。那么它不会损害服务器的性能吗？锁定列表并在连接之间迭代以转发每条消息（因为这在信使中经常发生）。有没有更好的方法来做到这一点？

我正在使用 Indy 10 和 Delphi 7

广播代码：

```
Var tmpList: TList;
    i: Integer;
Begin
tmpList := IdServer.Contexts.LockList;

For i := 0 to tmpList.Count Do Begin
  TIdContext(tmpList[i]).Connection.Socket.WriteLn('Broadcast message');
End;
IdServer.Contexts.UnlockList; 
```

转发消息代码：

```
Var tmpList: TList;
  i: Integer;
Begin
  tmpList := IdServer.Contexts.LockList;

  For i := 0 to tmpList.Count Do Begin
    If TIdContext(tmpList[i]).Connection.Socket.Tag = idReceiver Then
      TIdContext(tmpList[i]).Connection.Socket.WriteLn('Message');
  End;
  IdServer.Contexts.UnlockList; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-31T21:07:45.670

是的，您必须遍历`Contexts`列表才能将消息广播给多个客户端。但是，您不（也不应该）从循环内部执行实际写入。第一，正如您已经注意到的，服务器性能可能会因将列表锁定一段时间而受到影响。第二，它不是线程安全的。如果您的循环将数据写入一个连接，而另一个线程同时写入同一个连接，那么这两个写入将相互重叠并破坏您与该客户端的通信。

我通常做的是实现每个客户端的出站队列，使用 TIdContext.Data 属性或 TIdServerContext 后代来保存实际队列。当您需要从客户端事件之外向客户端发送数据时`OnExecute`，请将数据放入该客户端的队列中。然后，该客户端的`OnExecute`事件可以在安全的情况下将队列的内容发送给客户端。

例如：

```
type
  TMyContext = class(TIdServerContext)
  public
    Tag: Integer;
    Queue: TIdThreadSafeStringList;
    ...
    constructor Create(AConnection: TIdTCPConnection; AYarn: TIdYarn; AList: TThreadList = nil); override;
    destructor Destroy; override;
  end;

constructor TMyContext.Create(AConnection: TIdTCPConnection; AYarn: TIdYarn; AList: TThreadList = nil);
begin
  inherited;
  Queue := TIdThreadSafeStringList.Create;
end;

destructor TMyContext.Destroy;
begin
  Queue.Free;
  inherited;
end; 
```

.

```
procedure TForm1.FormCreate(Sender: TObject);
begin
  IdServer.ContextClass := TMyContext;
end;

procedure TForm1.IdServerConnect(AContext: TIdContext);
begin
  TMyContext(AContext).Queue.Clear;
  TMyContext(AContext).Tag := ...
end;

procedure TForm1.IdServerDisconnect(AContext: TIdContext);
begin
  TMyContext(AContext).Queue.Clear;
end;

procedure TForm1.IdServerExecute(AContext: TIdContext);
var
  Queue: TStringList;
  tmpList: TStringList;
begin
  ...
  tmpList := nil;
  try
    Queue := TMyContext(AContext).Queue.Lock;
    try
      if Queue.Count > 0 then
      begin
        tmpList := TStringList.Create;
        tmpList.Assign(Queue);
        Queue.Clear;
      end;
    finally
      TMyContext(AContext).Queue.Unlock;
    end;
    if tmpList <> nil then
      AContext.Connection.IOHandler.Write(tmpList);
  finally
    tmpList.Free;
  end;
  ...
end; 
```

.

```
var
  tmpList: TList;
  i: Integer;
begin
  tmpList := IdServer.Contexts.LockList;
  try
    for i := 0 to tmpList.Count-1 do
      TMyContext(tmpList[i]).Queue.Add('Broadcast message');
  finally
    IdServer.Contexts.UnlockList;
  end;
end; 
```

.

```
var
  tmpList: TList;
  i: Integer;
begin
  tmpList := IdServer.Contexts.LockList;
  try
    for i := 0 to tmpList.Count-1 do
    begin
      if TMyContext(tmpList[i]).Tag = idReceiver then
        TMyContext(tmpList[i]).Queue.Add('Message');
    end;
  finally
    IdServer.Contexts.UnlockList;
  end;
end; 
```

# opengl - GLSL 中 gl_LightSource 衰减因子的问题

> ID：14103949
> 
> 赞同：1
> 
> 时间：2012-12-31T16:37:28.993
> 
> 标签：opengl, glsl, phong

我正在尝试使用 Phong/Blinn 着色模型，但在让衰减正常工作时遇到了麻烦。由于某种原因，面向点光源的几何图形变成了完全白色。我特别卡住了，因为（1）代码在固定功能中工作得很好（即我所有的衰减/位置因子都设置得很好），并且（2）如果我替换它工作得很好：

```
att = 1.0 / (gl_LightSource[i].constantAttenuation + gl_LightSource[i].linearAttenuation * dist + gl_LightSource[i].quadraticAttenuation * dist * dist); 
```

和

```
att = 1.0 / (1 + 0.1*dist); 
```

也就是说，我所有的其他计算（距离、方向、归一化）似乎工作正常，但是这行代码存在问题（不知何故）。如果需要，我很乐意发布更多信息，但这似乎是问题所在。

PS 运行 Windows 7，我的 OpenGL 版本打印为 4.3。

更新：

这是该问题的打印屏幕。

[错误图片 http://snag.gy/EWpOl.jpg](http://snag.gy/EWpOl.jpg)

和它的样子`att = 1.0 / (1 + 0.1*dist);`

[正确的图像 http://snag.gy/NiYvA.jpg](http://snag.gy/NiYvA.jpg)

# php - 如何使用 HTML 表单将 JavaScript 值传递到另一个 PHP 页面？

> ID：14103952
> 
> 赞同：3
> 
> 时间：2012-12-31T16:37:44.233
> 
> 标签：php, javascript, html, geolocation, submit

我花了两个多月的时间试图解决这个编码问题。首先，我知道 JavaScript 在客户端运行，而 PHP 在服务器上运行。

我有两个 PHP 页面（index23.php 和 index24.php），都使用 HTML/PHP 和 JS。

我正在使用 HTML5 地理定位 API：

```
<body onload="getLocation()">

<p id="demo"></p>

<script>
var x = document.getElementById("demo");

function getLocation()
{
    if (navigator.geolocation)
    {
        navigator.geolocation.getCurrentPosition(showPosition);
    }
    else
    {
        x.innerHTML="Geolocation is not supported by this browser.";
    }
}

function showPosition(position)
{
    x.innerHTML= "+" + position.coords.latitude + "+" + position.coords.longitude;  
}
</script> 
```

我可以在我当前的 PHP 页面 (index23.php) 上看到地理编码值。然后我单击一个 HTML 表单按钮，浏览器转到另一个页面 (index24.php)。

如何使用表单上的提交按钮将第一个 PHP 页面上的 JavaScript 值传递到第二个 PHP 页面？

这是我的表格：

```
<form id="searchbox" action="index24.php" method="get">
<input name="q" type="text" placeholder="Type here"/>
<input id="submit" type="submit" value="Search"></form> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T16:45:50.863

您需要做的是隐藏输入类型并通过它发送值

```
<input name="bla"  type="hidden" value="blabla"> 
```

html也不是服务器端..只有php是。我希望下面的图片能解释

![在此处输入图像描述](../Images/bcffab1b98115247b5426d4b4d06b920.png)

[[[图片来源](http://www.html.net/tutorials/php/lesson1.php)]]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T16:53:03.037

index23.php：

```
<html>
<head>
<script type="text/javascript">
function getLocation(){
    var x = document.getElementById("demo");
    if (navigator.geolocation){
        navigator.geolocation.getCurrentPosition(showPosition);
    }else{
        x.innerHTML="Geolocation is not supported by this browser.";
    }
}
function showPosition(position){
    var x = document.getElementById("demo"),latitude=document.getElementById("latitude"),longitude=document.getElementById("longitude");
    x.innerHTML="+" + position.coords.latitude + "+" + position.coords.longitude;
    latitude.value = position.coords.latitude;
    longitude.value = position.coords.longitude;
}

</script>

</head>
<body onload="getLocation()">

    <p id="demo"></p>
    <form id="searchbox" action="index24.php" method="get">
    <input name="q" type="text" placeholder="Type here"/>
    <input name="latitude" id="latitude" type="hidden">
    <input name="longitude" id="longitude" type="hidden">
    <input id="submit" type="submit" value="Search"></form>
</body></html> 
```

index24.php

```
$latitude = $_GET['latitude'];
$longitude = $_GET['longitude']; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T16:49:29.850

您可以在获取坐标时动态地将值添加到表单中。

```
<form id="searchbox" action="index24.php" method="get">
<input name="q" type="text" placeholder="Type here"/>
<input id="submit" type="submit" value="Search">
<input name="latitude" type="hidden" id="latitude" value="" />
<input name="longitude" type="hidden" id="longitude" value="" />
</form>
<script>
var x=document.getElementById("demo");
function getLocation()
{
  if (navigator.geolocation)
  {
    navigator.geolocation.getCurrentPosition(showPosition);
  }
  else{x.innerHTML="Geolocation is not supported by this browser.";}
}
function showPosition(position)
{
  document.getElementById('latitude').value = position.coords.latitude;
  document.getElementById('longitude').value = position.coords.longitude;
  x.innerHTML="+" + position.coords.latitude + "+" + position.coords.longitude;    
}
</script> 
```

# objective-c - 替换 NSString 中的几个不同的字符

> ID：14103953
> 
> 赞同：0
> 
> 时间：2012-12-31T16:37:58.433
> 
> 标签：objective-c, regex, nsstring, replace, nsregularexpression

我正在制作一个供个人使用的 iPad 应用程序，并且我正在为某些字符串中的一些字符替换而苦苦挣扎。例如，我得到了一个包含“\t\t\t C D”的 NSString。现在我想做的是用 C# 和 D# 替换其中的每个 C 和每个 D。我已经设法做到了，但不幸的是，它对我来说根本没有效率。

到目前为止，这是我的代码：

```
- (IBAction)buttonPressed:(id)sender
{
    if(sender)
    {
        NSError *error;
        NSString *newTab = [[NSString alloc] init];
        NSRegularExpression *regexC = [NSRegularExpression regularExpressionWithPattern:@"C" options:0 error:&error];
        NSRegularExpression *regexD = [NSRegularExpression regularExpressionWithPattern:@"D" options:0 error:&error];

        newTab = [regexC stringByReplacingMatchesInString:self.tab options:0 range:NSMakeRange(0, self.tab.length) withTemplate:@"C#"];

        NSString *newTabAfterFirstRegex = [[NSString alloc] initWithString:newTab];

        newTabAfterFirstRegex = [regexD stringByReplacingMatchesInString:newTab options:0 range:NSMakeRange(0, newTab.length) withTemplate:@"D#"];

        NSLog(@"%@",newTabAfterFirstRegex);
    } 
```

}

另外，这只是一个小的测试代码。我真正想做的是有一个算法来检查给定字符串中所有音乐标签（CC＃DD＃EFF＃GG＃AA＃B）的实例，并且当触发IBAction时我想要它们中的每一个被下一个替换（B变成C）。

任何想法将不胜感激！

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T18:24:46.757

正则表达式似乎有点矫枉过正，你可以只做两个字符串替换，这样你就不会从正则表达式中得到所有开销，使用

```
- (NSString *)stringByReplacingOccurrencesOfString:(NSString *)target 
                                    withString:(NSString *)replacement 
```

只需更换两次。此外，您不需要进行 NSString 分配，因为它会在返回中创建一个引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:56:50.143

您可以设置一个正则表达式（例如'[AG]#?'）来匹配某些字符串。使用方法`-matchesInString:options:range:`，您可以遍历所有匹配项（它将为每个匹配项返回一个范围）并使用该范围进行替换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T18:29:57.603

前几天我创建了以下加密方法。我已经根据您的目的对其进行了测试，它似乎有效。

```
-(NSString *)ReplaceMe:(NSString *)s {
// Putting the source into an array
NSMutableArray *myArray = [[NSMutableArray alloc] init];
int i;
for (i = 0; i < s.length; i++) {
    [myArray addObject: [self Mid:s :i :1]];
}
// Creating a string with the revised array
NSMutableString *myString = [NSMutableString new];
for (i = 0; i < s.length; i++) {
    [myString appendString:[self Conversion:[myArray objectAtIndex:i]]];
}
// Final
return myString;
} 
```

上述方法需要两个附加功能。

```
-(NSString *)Mid:(NSString *)str:(NSInteger)s:(NSInteger)l {
if ((s <= str.length-1) && (s + l <= str.length) && (s >= 0) && (l >= 1)) {
    return [str substringWithRange:NSMakeRange(s, l)];
}
else {
    return @"";
}
} 
```

另一个是...

```
-(NSString *)Conversion:(NSString *)s {
if ([s isEqualToString:@"C"]) {
    return @"C#";
}
else if ([s isEqualToString:@"D"]) {
    return @"D#";
}
else {
    return s;
}
} 
```

您可以将其他转换对放在上面的函数中。以下是如何使用 ReplaceMe 的示例。

```
- (IBAction)clickAction:(id)sender {
textField2.text = [self ReplaceMe:textField1.text];
} 
```

所以它的 ReplaceMe 非常好用。

# javascript - 调用控制组 .click() 方法

> ID：14103957
> 
> 赞同：2
> 
> 时间：2012-12-31T16:38:25.063
> 
> 标签：javascript, jquery, cordova, click

尝试在另一种方法中调用控制组的 .click() 方法。继承人我到目前为止：

```
$("#list").click(function() {
    searchclick = true;
    value = $("#listval").text().split(" - ");
    window.location.href = "index.html";
    item = $("#listval").attr("title");
    if (item == "this") {
        $("#this").click();
    } else {
        $("#that").click();
    }
});​ 
```

“#this”和“#that”是控制组中的两个按钮。控制组点击方法初始化如下：

```
$("#this, #that").click(function(){ ...code... } 
```

有什么帮助吗？

编辑：这是 html 的样子：

```
<div data-role="content" class="ui-content" role="main">
            <div id="item" data-role="fieldcontain">
                <fieldset data-role="controlgroup" data-type="horizontal">
                    <legend>
                    </legend>
                    <input id="this" name="choose" value="val1" type="radio"/>
                    <label for="this">
                        val1
                    </label>
                    <input id="that" name="choose" value="val2" type="radio"/>
                    <label for="that">
                        val2
                    </label>
                </fieldset>
            </div>
            ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T18:19:20.773

这会将当前值发送到服务器，其中（我想）您拥有处理发送值并生成正确响应的代码。

**笔记：**

*   是`searchclick`和`value`全局变量吗？如果是这样，它们将在*#this*和*#that*点击的处理程序中可用，但在提交表单后将丢失。
*   是`item`局部变量吗？如果是这样，您应该像这样声明它：`var item = $("#listval").attr("title");`. 作为一般规则：除非绝对必要，否则不要创建全局变量。
*   下一个代码可能会干扰表单中的其他代码。如果修复其他代码太难，您可以尝试其他选项：不提交表单，而是执行 ajax 调用（请参阅[此处](http://api.jquery.com/jQuery.ajax/)的 jQuery 文档）。

```
$("#list").click(function() {
    searchclick = true;
    value = $("#listval").text().split(" - ");
    item = $("#listval").attr("title");
    if (item == "this") {
        $("#this").click();
    } else {
        $("#that").click();
    }

    //your controls are inside a form, right?
    document.forms[0].submit();

});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:00:11.627

我最终将变量设置为局部变量并在`index.html`页面中调用它们。在`index.html`中，我使用了 try,catch 块来检查页面加载时，局部变量中是否有任何变量。这是我的代码`index.html`（在其他页面上单击列表后：

```
try{
//grab variables set in search
if(window.localStorage.getItem("searchclick") == "true"){
    searchclick = true; 
}else{searchclick = false}
thisthat = window.localStorage.getItem("thisthat");
if(thisthat == "this"){
    $("#this").click();
    $("#thislabel").addClass("ui-btn-hover-c");
    $("#thislabel").addClass("ui-radio-on");
    $("#thislabel").addClass("ui-btn-active");
}else if(thisthat == "that"){
    $("#that").click();
    $("#thatlabel").addClass("ui-btn-hover-c");
    $("#thatlabel").addClass("ui-radio-on");
    $("#thatlabel").addClass("ui-btn-active");
}
//clear local variables after being used
window.localStorage.clear(); 
```

}catch(err){alert(err);}

# c# - How convert string to Datetime by a format?

> ID：14103970
> 
> 赞同：7
> 
> 时间：2012-12-31T16:39:52.020
> 
> 标签：c#, string, datetime, format

> **Possible Duplicate:**
> [Convert string to DateTime in c#](https://stackoverflow.com/questions/1592653/convert-string-to-datetime-in-c-sharp)

How can I convert string to DateTime by a format?

```
Convert.ToDateTime("12/11/17 2:52:35 PM") 
```

Result is `12/11/2017 02:52:35 PM` and this is incorrect because my expect is `11/17/2012 02:52:35 PM`

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-31T16:41:36.527

You're looking for `DateTime.ParseExact()`.

```
DateTime.ParseExact(myStr, "yy/MM/dd h:mm:ss tt", CultureInfo.InvariantCulture); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-31T16:42:12.567

Use [`DateTime.ParseExact()`](http://msdn.microsoft.com/en-us/library/w2sa9yss.aspx) method.

> Converts the specified string representation of a date and time to its DateTime equivalent using the specified format and culture-specific format information. The format of the string representation must match the specified format exactly.

```
 DateTime result = DateTime.ParseExact(yourdatestring, 
                                        "yy/MM/dd h:mm:ss tt",             
                                         CultureInfo.InvariantCulture); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T16:41:06.683

It is better to use one of the `DateTime.*Parse` methods.

These take the string representing the `DateTime`, a format string (or array of them) and some other parameters.

The [custom format string](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx) would be `yy/MM/dd h:mm:ss tt`.

So:

```
var date = DateTime.ParseExact("12/11/17 2:52:35 PM", 
                               "yy/MM/dd h:mm:ss tt"
                               CultureInfo.InvariantCulture); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-31T16:41:54.673

You need to specify the [culture of the string](http://msdn.microsoft.com/en-us/library/vstudio/cc165448.aspx):

```
// Date strings are interpreted according to the current culture. 
// If the culture is en-US, this is interpreted as "January 8, 2008",
// but if the user's computer is fr-FR, this is interpreted as "August 1, 2008" 
string date = "01/08/2008";
DateTime dt = Convert.ToDateTime(date);            
Console.WriteLine("Year: {0}, Month: {1}, Day: {2}", dt.Year, dt.Month, dt.Day);

// Specify exactly how to interpret the string.
IFormatProvider culture = new System.Globalization.CultureInfo("fr-FR", true);

// Alternate choice: If the string has been input by an end user, you might  
// want to format it according to the current culture: 
// IFormatProvider culture = System.Threading.Thread.CurrentThread.CurrentCulture;
DateTime dt2 = DateTime.Parse(date, culture, System.Globalization.DateTimeStyles.AssumeLocal);
Console.WriteLine("Year: {0}, Month: {1}, Day {2}", dt2.Year, dt2.Month, dt2.Day);

/* Output (assuming first culture is en-US and second is fr-FR):
    Year: 2008, Month: 1, Day: 8
    Year: 2008, Month: 8, Day 1
 */ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-31T16:48:45.327

尝试这个

```
dateValue = DateTime.ParseExact(dateString,
                                "yy/MM/dd hh:mm:ss tt",
                                new CultureInfo("en-US"),
                                DateTimeStyles.None); 
```

“tt”是 AM/PM 指示符。

# c# - Interface result delphi to c# - class define dll use in c#

> ID：14103973
> 
> 赞同：0
> 
> 时间：2012-12-31T16:40:38.520
> 
> 标签：c#, delphi

I have a class define in dll. I export this class by interface. I use this dll and class in other Delphi project very good but I want use this class in c# but send error for me.

Source DLL:

```
type
  IMyDate = interface
    ['{D032F796-167D-4B0D-851D-2AEEA226646A}']
    Procedure Analyze_Date(var y:Integer; m,d:Integer); stdcall;
  end;

  TMyDate = Class(TInterfacedObject, IMyDate)
  Public
    Procedure Analyze_Date(var y:integer; m,d:Integer); stdcall;
  End;

procedure TMyDate.Analyze_Date(var y:Integer; m, d: Integer);
begin
  y:= m+d;
end;

Function MyDate:IMyDate; stdcall;
begin
  result:= TMyDate.Create;
end;

exports
  MyDate; 
```

Unit use in Delphi example:

```
Function MyDate:IMyDate; stdcall; external 'Project11';

implementation

procedure TForm3.Button1Click(Sender: TObject);
var
  md:IMyDate;
  var y,m,d:Integer;
begin
  md:= MyDate;
  y:=10;
  m:=20;
  d:=30;
  md.Analyze_Date(y,m,d);
  showMessage(intTostr(y));
end; 
```

Use in c# but get error:

```
//[Guid("D032F796-167D-4B0D-851D-2AEEA226646A")]
public interface IMyDate
{
    void Analyze_Date(ref int y, int m, int d); 
}

[DllImport(
"Project11.dll"
, EntryPoint = "MyDate"
, SetLastError = true
, CallingConvention = CallingConvention.StdCall
, CharSet = CharSet.Unicode)]
public static extern IMyDate MyDate(); 

private void button9_Click(object sender, EventArgs e)
{
  int y, m, d;
  IMyDate da;
  da = MyDate(); // get error this line
  y = 10;
  m = 20;
  d = 30;
  da.Analyze_Date(ref y, m, d);
} 
```

**Update**

thank you for answer

i add new function to Interface and class but my function only return false

also my function and procedure in delphi is stdcall and interface in C# is normaly !!!

```
IMyDate = interface
['{D032F796-167D-4B0D-851D-2AEEA226646A}']
Function testing():Boolean; stdcall;
end;

TMyDate = Class(TInterfacedObject, IMyDate)
Public
Function testing():Boolean; stdcall;
End;

function TMyDate.testing(): Boolean;
begin
result:= true;
end; 
```

c#:

```
[ComImport, Guid("D032F796-167D-4B0D-851D-2AEEA226646A"),
 InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
public interface IMyDate
{
    bool testing();        
}

[DllImport(
      "Project11.dll"
      , EntryPoint = "CreateMyDate"//"MyDate"
      , SetLastError = true
      , CallingConvention = CallingConvention.StdCall
      , CharSet = CharSet.Unicode)]    
public static extern void CreateMyDate(out IMyDate Date); 

    Boolean b;

    b = da.testing();  //this line only return false
    if (b)
    {
        MessageBox.Show("ffff");
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T16:50:54.440

我看到的第一个问题是，Delphi 的函数返回值的二进制接口与 C# 使用的接口不同（实际上是所有其他主要的 Windows 编译器）。

因此，不要使用函数，而是使用`out`参数。

```
procedure CreateMyDate(out Date: IMyDate); stdcall;
begin
  Date := TMyDate.Create;
end; 
```

然后在 C# 上，您可以像这样声明函数：

```
[DllImport(@"Project11.dll")]
public static extern void CreateMyDate(out IMyDate Date); 
```

`DllImport`请注意，我删除了您的属性的大量虚假参数。我猜你是随机添加的！

另一个问题是界面。它需要声明为支持`IUnknown`. 像这样：

```
[ComImport, Guid("D032F796-167D-4B0D-851D-2AEEA226646A"), 
    InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
public interface IMyDate
{
    void Analyze_Date(ref int y, int m, int d); 
} 
```

**更新 1**

更新问题的第一个问题是我在原始答案中未能找到的问题。声明 C# 接口的方式意味着编组器假定本机函数都返回`HRESULT`COM 错误代码。如果 C# 方法有返回值，那么它会隐式转换为`out`参数。在 Delphi 中有一种简单的方法可以实现这一点。您替换接口`stdcall`中`safecall`的每个方法，显然是在该接口的实现中。请注意，您不应更改`CreateMyDate`函数的调用约定。

所以你的 Delphi 代码应该是这样的：

```
IMyDate = interface
  ['{D032F796-167D-4B0D-851D-2AEEA226646A}']
  Function testing():Boolean; safecall;
end;

TMyDate = Class(TInterfacedObject, IMyDate)
Public
  Function testing():Boolean; safecall;
End; 
```

更新问题中方法的另一个问题是 C# 编组`bool`为 4 字节值，但 Delphi`Boolean`只是一个字节。这个错误实际上是良性的，但是你可以通过使接口的两侧匹配来解决这个问题。例如：

```
[return: MarshalAs(UnmanagedType.U1)]
bool testing(); 
```

我重复我上面所说的。我从您的`DllImport`属性中删除了虚假参数。特别是不要使用`SetLastError`，因为您的代码没有设置 Win32 最后一个错误。你`DllImport`应该完全按照我的回答。不要通过向属性添加不必要的额外参数来混淆事物。

**更新 2**

你在评论中说你不能`safecall`在德尔福方面使用。这意味着您需要`HRESULT`在接口的 C# 端抑制签名转换。这已经完成了[`MethodImplOptions.PreserveSig`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.preservesigattribute.aspx)。您需要将其应用于 C# 接口上的每个方法。

```
[ComImport, Guid("D032F796-167D-4B0D-851D-2AEEA226646A"), 
    InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
public interface IMyDate
{
    [MethodImplAttribute(MethodImplOptions.PreserveSig)]
    void Analyze_Date(ref int y, int m, int d); 

    [MethodImplAttribute(MethodImplOptions.PreserveSig)]
    [return: MarshalAs(UnmanagedType.U1)]
    bool testing();  
} 
```

该接口与声明如下的 Delphi 接口相匹配：

```
IMyDate = interface
  ['{D032F796-167D-4B0D-851D-2AEEA226646A}']
  procedure Analyze_Date(var y: Integer; m, d: Integer); stdcall;
  function testing(): Boolean; stdcall;
end; 
```

# java - 使用球衣将名称添加到数组

> ID：14103979
> 
> 赞同：0
> 
> 时间：2012-12-31T16:41:23.470
> 
> 标签：java, json, jersey

我在[这里实现一个例子](https://github.com/blueimp/jQuery-File-Upload/wiki/Google-App-Engine-Java)

我需要输出 json 来命名数组。

`{"files":[]}`而不是`{[]}`我目前得到的输出。我需要做什么才能将名称添加到数组中？

```
 @GET
 @Path("/{key}/meta")
public Response redirect(@PathParam("key") String key) throws IOException {
BlobKey blobKey = new BlobKey(key);
BlobInfo info = blobInfoFactory.loadBlobInfo(blobKey);

String name = info.getFilename();
long size = info.getSize();
String url = "/rest/file/" + key; 
FileMeta meta = new FileMeta(name, size, url);

List<FileMeta> metas = Lists.newArrayList(meta);
GenericEntity<List<FileMeta>> entity = new GenericEntity<List<FileMeta>>(metas) {};
return Response.ok(entity).build(); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T17:15:23.870

您需要您的实体类包含一个`List<FileMeta>`被调用的实例`files`以具有该 JSON 输出。

```
public Class EntityClass
{
  private List<FileMeta> files;
  //Getter and Setter Methods.
} 
```

这是您需要的`redirect`方法。

```
@GET
@Path("/{key}/meta")
@Produces(MediaType.APPLICATION_JSON)
public Response redirect(@PathParam("key") String key) throws IOException {
BlobKey blobKey = new BlobKey(key);
BlobInfo info = blobInfoFactory.loadBlobInfo(blobKey);

String name = info.getFilename();
long size = info.getSize();
String url = "/rest/file/" + key; 
FileMeta meta = new FileMeta(name, size, url);

List<FileMeta> meta = Lists.newArrayList(meta);
EntityClass entity= new EntityClass();
entity.setFiles(meta);
return Response.ok(entity).build();
} 
```

PS：另外，您需要在 web.xml 中配置 POJOMapping。

```
<init-param>
  <param-name>com.sun.jersey.api.json.POJOMappingFeature</param-name>
  <param-value>true</param-value>
</init-param> 
```

# php - 从 SQL 数据库中删除特定数量的行

> ID：14103981
> 
> 赞同：1
> 
> 时间：2012-12-31T16:41:35.170
> 
> 标签：php, mysql, joomla, sql-delete

我正在尝试创建一个批量删除按钮。我正在尝试有一个输入字段，管理员可以在其中指定他/她要删除的行数。

到目前为止，我正在使用以下代码尝试删除输入字段中指定的数量，但没有任何反应，错误日志中也没有错误：

**助手.php**

```
function deleteall($all) {
    $db = JFactory::getDBO();
    $query = $db->getQuery(true);
    $query->delete()
    ->from('#__shoutbox');
    $db->setQuery($query, 0, $all);
    $db->query();
} 
```

**mod_shoutbox.php**

```
if(isset($post['deleteall'])) {
    $all = $post['all'];
    modShoutboxHelper::deleteall($all);
} 
```

**默认的.php**

```
<form method="post" name="deleteall">
    <input name="all" type="text" value="" />
    <input name="deleteall" type="submit" value="mass delete" />
</form> 
```

我相信 SQL 查询很好，问题与**default.php**中的 HTML 有关，但不是 100% 确定。有人可以让我知道我哪里出错了吗？

**更新：**

`$post`已经被定义为我使用 Joomla 编码标准。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T10:28:09.093

我想由于以下原因，您尝试做的事情是无法完成的。你怎么能告诉数据库要删除哪些行？你显然应该有一个过滤器。例如：`DELETE FROM table_name WHERE ID BETWEEN 1 AND 2999`。此处仅删除 ID 介于 1 和 2999 之间的行。

否则你想要的是`LIMIT`. 例如：`DELETE FROM table_name WHERE ID BETWEEN 1 AND 2999 LIMIT 1000`。`LIMIT`可以限制要删除的行。

```
DELETE [LOW_PRIORITY] [QUICK] [IGNORE] FROM tbl_name
    [PARTITION (partition_name,...)]
    [WHERE where_condition]
    [ORDER BY ...]
    [LIMIT row_count] 
```

在这里你没有任何语法错误，你出错的地方是逻辑。希望能解释一切。如果您有任何问题，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:46:46.210

您的帖子处理程序不正确。它应该是 $_POST['deleteall']

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T16:58:50.707

问题是该方法`deleteall`没有接收到它的`$all`参数（它什么也没收到，所以查询类使用 0 代替）。

# java - How to set a URL connection as POST

> ID：14103983
> 
> 赞同：0
> 
> 时间：2012-12-31T16:41:38.393
> 
> 标签：java, android

I'm looking at the documentation here: [http://docs.oracle.com/javase/7/docs/api/java/net/URLConnection.html](http://docs.oracle.com/javase/7/docs/api/java/net/URLConnection.html)

I'm not seeing an option to flag a request as a POST method. I'd expect to see `.setRequestMethod("POST");` or something. Am I looking at the wrong documentation?

I'm using Android 4.2 and Java 1.6\. Though I'm unsure if `javase/1.4.2` is what I should be looking for.

```
URL url = new URL(this.getUrl());
URLConnection connection = url.openConnection();
connection.setDoOutput(true);
connection.setDoInput(true);
connection.setRequestMethod("POST");
connection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
connection.setRequestProperty("charset", "utf-8");
connection.setRequestProperty("Content-Length", "" + Integer.toString(urlParameters.getBytes().length));
connection.setUseCaches (false); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:44:51.410

您需要使用[HTTPURLConnection](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/HttpURLConnection.html)而不是[URLConnection](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/URLConnection.html)。

HTTPURLConnection 有[setRequestMethod](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/HttpURLConnection.html#setRequestMethod%28java.lang.String%29)

例子：

```
HttpURLConnection connection = (HttpURLConnection) url.openConnection(); 
```

注意：最好使用最新的 javadoc 而不是旧版本，1.4 是相当旧的 java 版本。

[归功于 Luigi R.](https://stackoverflow.com/users/258289/luigi-r-viggiano) Viggiano ：

我上面的回答只涉及如何访问`setRequestMethod`. 如果您不想使用 setRequestMethod，而是按照 Luigi 的建议实现 POST，则可以忽略调用 `setRequestMethod`，只需 set即可`setDoOutput(true)`。阅读本[教程](http://docs.oracle.com/javase/tutorial/networking/urls/readingWriting.html)以获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:53:20.370

你可以使用这个，你已经有了比我发布的更多的选择

```
HttpParams httpParams = new BasicHttpParams();
HttpConnectionParams.setConnectionTimeout(httpParams, TIMEOUT_MILLIS);
HttpConnectionParams.setSoTimeout(httpParams, TIMEOUT_MILLIS);
HttpClient client = new DefaultHttpClient(httpParams);

HttpUriRequest request = new HttpPost(serverUrl); 
```

# javascript - Canvas and SpriteMaterial

> ID：14103986
> 
> 赞同：3
> 
> 时间：2012-12-31T16:41:46.747
> 
> 标签：javascript, three.js

Sorry if this is a Noob question.

I've been trying to add labels to a timeline created in three.js using dynamically generated canvas elements as sprites. The timeline part is rendering great, but I am having difficulty getting the canvas sprites to render. This is what i'm using for the sprites (taken out of the context of the larger scene):

```
var canvas = document.createElement('canvas');
var size = 250;
canvas.width = size;
canvas.height = size;
var context = canvas.getContext('2d');
context.fillStyle = '#990000';
context.textAlign = 'center';
context.font = '24px Arial';
context.fillText("some text", size / 2, size / 2);

var amap = new THREE.Texture(canvas);
amap.needsUpdate = true;

var mat = new THREE.SpriteMaterial({
    map: amap,
    transparent: false,
    useScreenCoordinates: false,
    color: 0x000000
});

var sp = new THREE.Sprite(mat);
scene.add(sp); 
```

You can see a fuller set of example code here: [http://jsfiddle.net/rgE2j/2/](http://jsfiddle.net/rgE2j/2/).

Any help at all is appreciated.

Thanks, peter

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T23:10:46.823

好吧，你有几个错误。我将相机移近并进行了一些其他更改，这些更改已注明。此外，小提琴使用的是旧版本的库。

更新小提琴：http: [//jsfiddle.net/rgE2j/141/](http://jsfiddle.net/rgE2j/141/)

三.js r.54

```
var canvas = document.createElement('canvas');
var size = 256; // CHANGED
canvas.width = size;
canvas.height = size;
var context = canvas.getContext('2d');
context.fillStyle = '#ff0000'; // CHANGED
context.textAlign = 'center';
context.font = '24px Arial';
context.fillText("some text", size / 2, size / 2);

var amap = new THREE.Texture(canvas);
amap.needsUpdate = true;

var mat = new THREE.SpriteMaterial({
    map: amap,
    transparent: false,
    useScreenCoordinates: false,
    color: 0xffffff // CHANGED
});

var sp = new THREE.Sprite(mat);
sp.scale.set( 10, 10, 1 ); // CHANGED
scene.add(sp); 
```

# android - 即使在实现 close() 之后，也从未在数据库上显式调用 Close()

> ID：14103993
> 
> 赞同：3
> 
> 时间：2012-12-31T16:42:20.043
> 
> 标签：android, android-sqlite

即使我已经实现了上述方法 close()，Eclipse 仍向我显示上述错误。

这是代码：

```
public void update_project(View view) {

    EditText cinone = (EditText) findViewById(R.id.pname);
    pname = cinone.getText().toString();

    String fDate = pday + ". " + pmonth + ". " + pyear;

    projectdatabase dbupdate = new projectdatabase(UpdateProject.this);

    dbupdate.open();
    dbupdate.updateProject(id, pname, fDate); 
    dbupdate.close();

} 
```

日志猫：

```
12-31 22:05:51.114: E/SQLiteDatabase(4180): close() was never explicitly called on  
database '/data/data/com.kk.project/databases/project_db' 
12-31 22:05:51.114: E/SQLiteDatabase(4180):  
android.database.sqlite.DatabaseObjectNotClosedException: Application did not close the     
cursor or database object that was opened here
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at  
android.database.sqlite.SQLiteDatabase.<init>(SQLiteDatabase.java:1943)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at 
android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:1007)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at   
android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:986)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at 
android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:1051)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at 
android.app.ContextImpl.openOrCreateDatabase(ContextImpl.java:770)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at  
android.content.ContextWrapper.openOrCreateDatabase(ContextWrapper.java:221)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at 
android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:157)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at     
com.kk.project.projectdatabase.open(projectdatabase.java:66)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at  
com.kk.project.ProjectExplorer.getinfo(ProjectExplorer.java:30)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at    
com.kk.project.ProjectExplorer.onCreate(ProjectExplorer.java:25)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at  
android.app.Activity.performCreate(Activity.java:4465)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at  
android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at 
android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at 
android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at  
android.app.ActivityThread.access$600(ActivityThread.java:123)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at 
android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at  
android.os.Handler.dispatchMessage(Handler.java:99)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at 
android.os.Looper.loop(Looper.java:137)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at  
android.app.ActivityThread.main(ActivityThread.java:4424)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at   
java.lang.reflect.Method.invokeNative(Native Method)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at     
java.lang.reflect.Method.invoke(Method.java:511)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at 
com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at   
com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
12-31 22:05:51.114: E/SQLiteDatabase(4180):     at 
dalvik.system.NativeStart.main(Native Method)
12-31 22:05:51.165: E/System(4180): Uncaught exception thrown by finalizer
12-31 22:05:51.174: D/dalvikvm(4180): GREF has increased to 201
12-31 22:05:51.204: I/dalvikvm(4180): threadid=3: reacting to signal 3
12-31 22:05:51.324: E/System(4180): java.lang.IllegalStateException: Don't have   
database lock!
12-31 22:05:51.324: E/System(4180):     at  
android.database.sqlite.SQLiteDatabase.verifyLockOwner(SQLiteDatabase.java:2090)
12-31 22:05:51.324: E/System(4180):     at  
android.database.sqlite.SQLiteDatabase$1.entryRemoved(SQLiteDatabase.java:2182)
12-31 22:05:51.324: E/System(4180):     at   
android.database.sqlite.SQLiteDatabase$1.entryRemoved(SQLiteDatabase.java:2178)
12-31 22:05:51.324: E/System(4180):     at  
android.util.LruCache.trimToSize(LruCache.java:197)
12-31 22:05:51.324: E/System(4180):     at   
android.util.LruCache.evictAll(LruCache.java:285)
12-31 22:05:51.324: E/System(4180):     at   
android.database.sqlite.SQLiteDatabase.deallocCachedSqlStatements  
(SQLiteDatabase.java:2143)
12-31 22:05:51.324: E/System(4180):     at  
android.database.sqlite.SQLiteDatabase.closeClosable(SQLiteDatabase.java:1126)
12-31 22:05:51.324: E/System(4180):     at  
android.database.sqlite.SQLiteDatabase.finalize(SQLiteDatabase.java:1914)
12-31 22:05:51.324: E/System(4180):     at   
java.lang.Daemons$FinalizerDaemon.doFinalize(Daemons.java:182)
12-31 22:05:51.324: E/System(4180):     at  
java.lang.Daemons$FinalizerDaemon.run(Daemons.java:168)
12-31 22:05:51.324: E/System(4180):     at java.lang.Thread.run(Thread.java:856) 
```

奇怪的是，我宝贵地使用了类似的代码，而且它工作得完美无缺。此外，来自同一数据库类的其他方法也可以完美运行。

调用 updateProject 的活动代码：

```
public class UpdateProject extends Activity implements OnItemSelectedListener,  DatePickerDialog.OnDateSetListener {

int mPos;
String mSelection;

String pname;
String pdifficulty;

int pday;
int pmonth;
int pyear;

String id;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_update_project);

    id = getIntent().getExtras().getString("idforupdate");

    userdatabase viewname = new userdatabase(this);             //Get username
    viewname.open();
    String name = viewname.getusername();
    viewname.close();

    if(name.equals("")) {

        DialogFragment newFragment = new NouserexitFragment();
        newFragment.show(getFragmentManager(), "exit");

    }

    Spinner spinner = (Spinner) findViewById(R.id.difficultyspinner); ArrayAdapter<CharSequence> 
    adapter = ArrayAdapter.createFromResource(this,R.array.difficultyarray, android.R.layout.simple_spinner_item);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    spinner.setAdapter(adapter);
    spinner.setOnItemSelectedListener(this);

    pdifficulty = spinner.getSelectedItem().toString();
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_update_project, menu);
    return true;
}

@TargetApi(Build.VERSION_CODES.HONEYCOMB)
public void datepicker(View v) {                                                        //Date picker   
    DialogFragment newFragment = new DatePickerForUpdate();
    newFragment.show(getFragmentManager(), "datePickerforupdate");

}

    @Override
public void onDateSet(DatePicker view, int year, int month, int day) {
    // TODO Auto-generated method stub

    pday = day;
    pmonth = month +1;
    pyear = year;

    month = month + 1;
    Button activityButton = (Button)findViewById(R.id.datebutton);
    activityButton.setText (day + "." + month + "." + year);

}

@Override
public void onItemSelected(AdapterView<?> parent, View view, int pos, long id) {
    // TODO Auto-generated method stub

    UpdateProject.this.mPos = pos;
    UpdateProject.this.mSelection = parent.getItemAtPosition(pos).toString();

}

@Override
public void onNothingSelected(AdapterView<?> arg0) {
    // TODO Auto-generated method stub

}

public void update_project(View view) {

EditText cinone = (EditText) findViewById(R.id.pname);
pname = cinone.getText().toString();

String fdate = pday + ". " + pmonth + ". " + pyear;

projectdatabase update = new projectdatabase(UpdateProject.this);
update.open();
update.updateProject(id, pname, fdate);
update.close();

} 
```

}

数据库类代码：

```
public class projectdatabase {

public static final String KEY_ROWID = "_id";
public static final String PROJECT_NAME = "project_name";
public static final String PROJECT_ID = "project_id";
public static final String PROJECT_DIFFICULTY = "project_difficulty";
public static final String PROJECT_STATUS = "project_status";
public static final String PROJECT_START_DATE = "project_start_date";
public static final String PROJECT_FINISH_DATE = "project_finsish_date";

private static final String DATABASE_NAME = "project_db";
static final String DATABASE_TABLE = "project_details";
private static final int DATABASE_VERSION = 1;

private DbHelper ourHelper;
private final Context projectdbContext;
private SQLiteDatabase projectDatabase;

private static class DbHelper extends SQLiteOpenHelper {
    public DbHelper(Context context) {

        super(context, DATABASE_NAME, null, DATABASE_VERSION);

    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        // TODO Auto-generated method stub

        db.execSQL("CREATE TABLE "+ DATABASE_TABLE + " (" +
                KEY_ROWID + " INTEGER PRIMARY KEY AUTOINCREMENT, " +
                PROJECT_NAME + " TEXT NOT NULL, " +
                PROJECT_ID + " INTEGER, " +
                PROJECT_START_DATE + " TEXT, " +
                PROJECT_FINISH_DATE + " TEXT, " +
                PROJECT_DIFFICULTY + " TEXT, " +
                PROJECT_STATUS + " TEXT);"
               ); 

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // TODO Auto-generated method stub

        db.execSQL("DROP TABLE IF EXIST " + DATABASE_NAME);
        onCreate(db);

    }
}

public projectdatabase (Context c) {                            
     projectdbContext = c;
}

public projectdatabase open() {                                                 //Open database
    ourHelper = new DbHelper(projectdbContext);
    projectDatabase = ourHelper.getWritableDatabase();
    return this;
}

public void close() {                                                           //Close database
    ourHelper.close();
}

public long createEntry(String name, String pid, String startdate, String finishdate, String difficulty, String Status) {           //Enter project data into database

    ContentValues cv = new ContentValues();
    cv.put(PROJECT_NAME, name);
    cv.put(PROJECT_ID, pid);
    cv.put(PROJECT_START_DATE, startdate);
    cv.put(PROJECT_FINISH_DATE, finishdate);
    cv.put(PROJECT_DIFFICULTY, difficulty);
    cv.put(PROJECT_STATUS, Status);

    return projectDatabase.insert(DATABASE_TABLE, null, cv);
}

public String getData() {                                                       //Retrieve all project data

    String[] columns = new String[] {KEY_ROWID, PROJECT_NAME, PROJECT_ID, PROJECT_START_DATE, PROJECT_FINISH_DATE, PROJECT_DIFFICULTY, PROJECT_STATUS};
    Cursor c = projectDatabase.query(DATABASE_TABLE, columns, null, null, null, null, null);
    String result = "";

    int iRow = c.getColumnIndex(KEY_ROWID);
    int iName = c.getColumnIndex(PROJECT_NAME);
    int iID = c.getColumnIndex(PROJECT_ID);
    int iStartDate = c.getColumnIndex(PROJECT_START_DATE);
    int iFinishDate = c.getColumnIndex(PROJECT_FINISH_DATE);
    int iDifficulty = c.getColumnIndex(PROJECT_DIFFICULTY);
    int iStatus = c.getColumnIndex(PROJECT_STATUS);

    for(c.moveToFirst(); !c.isAfterLast(); c.moveToNext()) {

        result = result + c.getString(iRow) + "|" + c.getString(iName) + "|" + c.getString(iID) + "|" + c.getString(iStartDate) + "|" + c.getString(iFinishDate) + "|" + c.getString(iDifficulty) + "|" + c.getString(iStatus) + "\n";

    }

    return result;
}

public Cursor getDataforDisplay () {                                            //Project data for list view

    String[] columns = new String[] {KEY_ROWID, PROJECT_NAME, PROJECT_FINISH_DATE, PROJECT_DIFFICULTY, PROJECT_STATUS};
    Cursor c = projectDatabase.query(DATABASE_TABLE, columns, null, null, null, null, null);

    c.moveToFirst();
    return c;

}

public String getProjectName(String id) {                   

    String[] columns = new String[] {PROJECT_NAME,KEY_ROWID};
    Cursor c = projectDatabase.query(DATABASE_TABLE, columns, KEY_ROWID + "=" + id, null, null, null, null);

    if(c != null) {

        int iName = c.getColumnIndex(PROJECT_NAME);

        c.moveToFirst();
        String name = c.getString(iName);
        return name;

    }

    return null;
} 
```

公共字符串getProjectStatus（字符串ID）{

```
 String[] columns = new String[] {PROJECT_STATUS,KEY_ROWID};
    Cursor c = projectDatabase.query(DATABASE_TABLE, columns, KEY_ROWID + "=" + id, null, null, null, null);

    if(c != null) {

        int iStatus = c.getColumnIndex(PROJECT_STATUS);

        c.moveToFirst();
        String status = c.getString(iStatus);
        return status;

    }

    return null;
} 
```

公共字符串getProjectDifficulty（字符串ID）{

```
String[] columns = new String[] {PROJECT_DIFFICULTY,KEY_ROWID};
Cursor c = projectDatabase.query(DATABASE_TABLE, columns, KEY_ROWID + "=" + id, null, null, null, null);

if(c != null) {

    int iDiff = c.getColumnIndex(PROJECT_DIFFICULTY);

    c.moveToFirst();
    String diff = c.getString(iDiff);
    return diff;

}

return null; 
```

}

公共字符串 getProjectstartdate（字符串 id）{

```
String[] columns = new String[] {PROJECT_START_DATE,KEY_ROWID};
Cursor c = projectDatabase.query(DATABASE_TABLE, columns, KEY_ROWID + "=" + id, null, null, null, null);

if(c != null) {

    int iSdate = c.getColumnIndex(PROJECT_START_DATE);

    c.moveToFirst();
    String sdate = c.getString(iSdate);
    return sdate;

}

return null; 
```

}

公共字符串 getProjectfinishdate（字符串 id）{

```
String[] columns = new String[] {PROJECT_FINISH_DATE,KEY_ROWID};
Cursor c = projectDatabase.query(DATABASE_TABLE, columns, KEY_ROWID + "=" + id, null, null, null, null);

if(c != null) {

    int iFdate = c.getColumnIndex(PROJECT_FINISH_DATE);

    c.moveToFirst();
    String fdate = c.getString(iFdate);
    return fdate;

}

return null; 
```

}

public void updateProject(String id, String PName, String FDate) { //更新数据库的方法

```
ContentValues cvUpdate = new ContentValues();
cvUpdate.put(PROJECT_NAME, PName);
cvUpdate.put(PROJECT_FINISH_DATE, FDate);

projectDatabase.update(DATABASE_TABLE, cvUpdate, KEY_ROWID + "=" + id, null); 
```

}

}

编辑：如果我用数据库类中的任何其他方法替换 updateProject() 方法，错误消失并且应用程序运行没有问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T05:09:20.740

您需要`SQLiteOpenHelper`正确设计您的课程。许多大师建议进行静态引用，以确保`DatabaseHelper`任何时候都只存在一个实例。

下面的代码会给你一些想法。（这不是一个完整的代码，但会给你一些提示）

```
public class DatabaseHelper extends SQLiteOpenHelper { 
    private static DatabaseHelper mDBHelper;

    public static DatabaseHelper getInstance(Context ctx) {

        if (mDBHelper == null) { //this will ensure no multiple instances out there.
            mDBHelper = new DatabaseHelper(ctx.getApplicationContext());
        }
        return mDBHelper;
    }

} 
```

现在，做一个技巧。

打开数据库

```
private SQLiteDatabase db;
    public synchronized SQLiteDatabase open() throws SQLException {

        if(db ==null){
            db = DBHelper.getWritableDatabase();
        }

        return db;
    } 
```

关闭数据库。

```
public synchronized void close() {

        //do nothing. This is a trick.
    } 
```

**原因：**对于移动应用程序，不需要打开和关闭机制。它最适合多个用户尝试访问数据库的 Web 应用程序，但在移动应用程序的情况下，只有单个用户将使用您的应用程序。

此 hack 还将确保您永远不会收到`Close() was never explicitly called on database`错误。**当您打开的 SQLiteDatabase 实例多于关闭的 SQLiteDatabase 实例时会引发此异常，**而现在在我们的例子中只有一个 SQLiteDatabse 实例。这也将处理并发数据库访问/写入问题。

希望这个 hack 能帮助你理解实际的问题。

为了更好地理解，您可以参考此[链接](http://www.androiddesignpatterns.com/2012/05/correctly-managing-your-sqlite-database.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T17:42:24.370

```
public projectdatabase open() {
    ourHelper = new DbHelper(projectdbContext);
    projectDatabase = ourHelper.getWritableDatabase();
    return this;
}

public void close() {
    ourHelper.close();
} 
```

在上面，尝试更改`ourHelper.close()`为`projectDatabase.close()`. 您必须关闭`WriteableDatabase`您打开的 SQLiteDatabase 的实例。**不是**`DBHelper`. _

因此，您的关闭功能将变为：

```
public void close() {
    projectDatabase.close();
} 
```

**[编辑]**：从 sqlite 网站我找到[了这个信息](http://www.sqlite.org/lockingv3.html)。当您替换`updateProject()`为任何其他方法时它起作用的原因是因为这是您获得数据库写锁定的唯一方法。SQLite 数据库没有读锁，只有写锁。

**您是否尝试过在`updateProject()`方法结束时（在其中）对 projectDatabase 调用关闭？**

我会提出的另一个建议是让您的 Database 类**成为 singleton**。这将避免任何冲突，因为在任何给定时间只有一个对象访问数据库。

# php - 从 fgetcsv 返回错误

> ID：14103994
> 
> 赞同：2
> 
> 时间：2012-12-31T16:42:34.617
> 
> 标签：php, csv

我目前有下面的代码块处理用户上传文件的表单。如果用户上传了 fgetcsv 无法处理的文件，我如何让它返回错误？现在，当我尝试让它处理图像时，我的脚本继续运行并且我从未收到错误消息。

我尝试测试 $data 以确定它是否为空，但我得到的只是错误。

```
if (($handle = fopen($_FILES['fileUpload']['tmp_name'], 'r')) !== FALSE) {
    while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
        $total = count($data);

        for ($e=0; $e < $total; $e++) {
            echo $data[$e] . "<br />";
        }
        echo "<br />";
    }
    fclose($handle);
} 
```

作为一个仅供参考 - 我只是为了测试目的打印出 csv 内容。在最终脚本中，我将只将数组保存在会话中。

**更新：** 正如@hakre 建议的那样，我问了错误的问题。我已经接受了他的回答，因为我遇到了麻烦并且我不完全理解它，所以我将其修改为您在下面看到的内容。

~~一切都很好，**除了**线路`if ($row === null) continue;`不起作用。我已经尝试过使用和不使用括号`null`。空行是在文件中间还是最后一行似乎并不重要。~~这是根据@harke 评论修复的。 `if ($row === null) continue;`被替换为`if ($row === array(null)) continue;`

```
$uploadTempfile = $_FILES['fileUpload']['tmp_name'];
$file = new SplFileObject($uploadTempfile);
$file->setFlags(SplFileObject::READ_CSV);
$limit = new LimitIterator($file, 0, 10); // scan the first 10 lines only
foreach ($limit as $row) {
    if ($row === array(null)) continue; // skip empty lines
    $columnCount[] = count($row);
    }
if(count(array_unique($columnCount)) === 1){
    echo 'file is valid';
    } else {
    echo 'file is INVALID';
    } 
```

***我已经根据下面的评论和答案更新了上面的代码块，以便它现在可以正常工作。***

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T17:03:25.023

> 如果用户上传了 fgetcsv 无法处理的文件，我如何让它返回错误？

那可能是个错误的问题。`fgetcsv`可以处理*任何*文件。因此，这始终是正确的，这样的函数将始终返回成功，而不是错误。

您可能的意思是您想要检查 CSV 文件并在某种程度上验证它的内容，如果它可能是您正在寻找的这种 CSV 文件。

这还需要您明确文件是否实际上应该具有某种特定性质，例如始终相同数量的列，这可能是您正在寻找的。

以下代码示例检查 CSV 文件的前 10 行是否至少包含一行，这 10 行中的每一行（如果不为空）都具有完全相同的计数并且计数大于 1：

```
$uploadTempfile = $_FILES['fileUpload']['tmp_name'];

$file = new SplFileObject($uploadTempfile);
$file->setFlags(SplFileObject::READ_CSV);

$limit = new LimitIterator($file, 0, 10); // scan the first 10 lines only

foreach ($limit as $row) {

    if ($row === [null]) continue; // skip empty lines

    $rowCount = count($row);

    if (!isset($count)) {
        $count = $rowCount;
    }

    if ($rowCount !== $count) {
        break;
    }
}

$valid = (isset($count) and $rowCount === $count and $count > 1); 
```

# android - 如何在 wordpress 中显示 Android 的 xml 文件？

> ID：14103997
> 
> 赞同：1
> 
> 时间：2012-12-31T16:43:16.847
> 
> 标签：android, xml, wordpress

我正在通过 WP-CodeBox 插件写一篇关于 Android 的博客，并希望将 layout.xml 添加到博客中，如下所示：

```
<pre><LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"

    android:layout_width="match_parent"
    android:layout_height="match_parent"
    >
    <ImageView android:id="@+id/icon"
        android:layout_width="@dimen/notification_large_icon_width"
        android:layout_height="@dimen/notification_large_icon_height"
        android:background="@android:drawable/bg_tile"
        android:scaleType="center"
        />

</LinearLayout></pre> 
```

在 HTML 模式下，当我将编辑模式更改为可视模式时，xml 消失了！请帮助我如何在 xml 模式下显示 xml 而不会出现格式错误。wordpress 中还有其他 xml 编辑插件吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T18:27:24.277

你可以用[这个](http://tohtml.com/xml/)荧光笔。这将为您的 XML 提供以下输出（使用 Eclipse 样式）：

```
<pre style='color:#000000;background:#ffffff;'><span style='color:#7f0055; '>&lt;</span><span style='color:#7f0055; '>LinearLayout</span> xmlns:android=<span style='color:#2a00ff; '>"</span><span style='color:#2a00ff; '>http</span><span style='color:#2a00ff; '>:</span><span style='color:#7f0055; font-weight:bold; '>//</span><span style='color:#3f3fbf; '>schemas.android.com</span><span style='color:#3f3fbf; '>/apk/res/android</span><span style='color:#2a00ff; '>"</span>

    android:layout_width=<span style='color:#2a00ff; '>"</span><span style='color:#2a00ff; '>match_parent</span><span style='color:#2a00ff; '>"</span>
    android:layout_height=<span style='color:#2a00ff; '>"</span><span style='color:#2a00ff; '>match_parent</span><span style='color:#2a00ff; '>"</span>
    <span style='color:#7f0055; '>></span>
    <span style='color:#7f0055; '>&lt;</span><span style='color:#7f0055; '>ImageView</span> android:id=<span style='color:#2a00ff; '>"</span><span style='color:#2a00ff; '>@+id/icon</span><span style='color:#2a00ff; '>"</span>
        android:layout_width=<span style='color:#2a00ff; '>"</span><span style='color:#2a00ff; '>@dimen/notification_large_icon_width</span><span style='color:#2a00ff; '>"</span>
        android:layout_height=<span style='color:#2a00ff; '>"</span><span style='color:#2a00ff; '>@dimen/notification_large_icon_height</span><span style='color:#2a00ff; '>"</span>
        android:background=<span style='color:#2a00ff; '>"</span><span style='color:#2a00ff; '>@android:drawable/bg_tile</span><span style='color:#2a00ff; '>"</span>
        android:scaleType=<span style='color:#2a00ff; '>"</span><span style='color:#2a00ff; '>center</span><span style='color:#2a00ff; '>"</span>
        <span style='color:#7f0055; '>/></span>

<span style='color:#7f0055; '>&lt;/</span><span style='color:#7f0055; '>LinearLayout</span><span style='color:#7f0055; '>></span>
</pre> 
```

它看起来像这样：

![在此处输入图像描述](../Images/ff3862b24ac8ca436aeb84d07a5e5b00.png)