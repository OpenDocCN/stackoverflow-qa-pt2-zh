# StackOverflow 问答 15531000-15531999

# java - 从 Java 中的传入字符串创建文件

> ID：15531001
> 
> 赞同：1
> 
> 时间：2013-03-20T17:45:34.800
> 
> 标签：java, client, client-server, send

从我的客户端类中，我将发送一个用于文件名的字符串，一个用于内容的字符串。

在服务器上，如何根据从客户端收到的字符串创建文件？

客户端类：

```
 String theFile = "TextDoc.txt";
 String theFileContent = "text inside TextDoc";

 sendToServer.writeBytes(theFile +"\n");
 sendToServer.writeBytes(theFileContent); 
```

服务器类：

```
 BufferedReader reFromClient = new BufferedReader(new InputStreamReader(socket.getInputStream())); 

 String theFileFrCl = reFromClient.readLine();
 String theFileCtFrCl = reFromClient.readLine(); 
```

如何根据客户发送的内容制作文件？我不太确定如何将内容附加到 TextDoc。

马丁。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T17:58:02.473

在服务器端，我们收到了文件名和内容：

```
 BufferedReader reFromClient = new BufferedReader(new InputStreamReader(socket.getInputStream())); 

 String theFileFrCl = reFromClient.readLine(); // file name.
 String theFileCtFrCl = reFromClient.readLine(); // contents. 
```

在此之后，我们将编写文件：

```
FileOutputStream fos = new FileOutputStream(theFileFrCl,true); // opening file in append mode, if it doesn't exist it'll create one.
fos.write(theFileCtFrCl.getBytes()); // write contents to file TextDoc.txt
fos.close(); 
```

如果您想将某些文件的内容返回给客户端，只需像以前一样从客户端请求文件名：

```
theFileFrCl = reFromClient.readLine(); // client will write and we'll read line here (file-name). 
```

现在只需使用收到的文件名打开文件：

```
try{
  FileInputStream fis = new FileInputStream(theFileFrCl);
  byte data[] = new byte[fis.available()];
  fis.read(data);
  fis.close();
  toClient.writeBytes(data); // write to client.
}catch(FileNotFoundException fnf)
{
  // File doesn't exists with name supplied by client 
} 
```

# css - Sass mixin 递归；@include 循环

> ID：15531004
> 
> 赞同：1
> 
> 时间：2013-03-20T17:45:42.880
> 
> 标签：css, ruby, recursion, sass

有谁知道是否可以恢复 Sass 的功能，以防止为防止递归而实施的“错误修复” ^(1 ？)`@include`

消息是：

`Syntax error: An @include loop has been found: <mixin-name> includes itself`

[这是3.0.5](http://sass-lang.com/docs/yardoc/file.SASS_CHANGELOG.html#305)中的“固定” ¹，我不希望（*阅读：我不能*）降级那么远。不幸的是，我对 Ruby 的了解不足，无法筛选源代码，虽然我正在花时间改变它，但现在它对我没有帮助。

 *那么，是否可以²将此功能恢复到 3.0.5 之前的功能而无需降级；是否有一个重新补丁漂浮在某处？我一直找不到。

**编辑：**虽然我现在自己回答了这个问题，但我仍然愿意接受更好的答案；具体来说，更便携的解决方案，因为现在 Sass 文件将在其他任何地方（*不是 3.0.5 之前的任何地方*）中断

[¹引号用来表示我不认为这是一个修复。我认为这是一个休息；不过，我会和负责的人一起讨论这个问题。
² ~~我知道这是可能的，但我的意思是专门针对没有 Ruby 实践经验的人。~~我正在学习红宝石！]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T13:11:56.163

好的，有一种更简洁的方式来应用您的技巧：使用[Compass进行](http://compass-style.org/)[猴子修补](http://en.wikipedia.org/wiki/Monkey_patch)。

它将让您安全地共享您的项目，并且其他人将能够在不修改自己的 SASS 编译器的情况下编译它。

## 1)

`sass-visit-mixin-monkey-patch.rb`在旁边创建`compass.rb`并从那里应用您的 hack：

```
class Sass::Tree::Visitors::Perform < Sass::Tree::Visitors::Base
  # Runs a mixin.
  def visit_mixin(node)
    #include_loop = true
    #handle_include_loop!(node) if @stack.any? {|e| e[:name] == node.name}
    include_loop = false

    @stack.push(:filename => node.filename, :line => node.line, :name => node.name)
    raise Sass::SyntaxError.new("Undefined mixin '#{node.name}'.") unless mixin = @environment.mixin(node.name)

    if node.children.any? && !mixin.has_content
      raise Sass::SyntaxError.new(%Q{Mixin "#{node.name}" does not accept a content block.})
    end

    args = node.args.map {|a| a.perform(@environment)}
    keywords = Sass::Util.map_hash(node.keywords) {|k, v| [k, v.perform(@environment)]}
    splat = node.splat.perform(@environment) if node.splat

    self.class.perform_arguments(mixin, args, keywords, splat) do |env|
      env.caller = Sass::Environment.new(@environment)
      env.content = node.children if node.has_children

      trace_node = Sass::Tree::TraceNode.from_node(node.name, node)
      with_environment(env) {trace_node.children = mixin.tree.map {|c| visit(c)}.flatten}
      trace_node
    end
  rescue Sass::SyntaxError => e
    unless include_loop
      e.modify_backtrace(:mixin => node.name, :line => node.line)
      e.add_backtrace(:line => node.line)
    end
    raise e
  ensure
    @stack.pop unless include_loop
  end
end 
```

## 2)

需要来自以下位置的猴子补丁`config.rb`：

```
# Enabling mixin recursion by applying a monkey patch to SASS compiler
require "./sass-visit-mixin-monkey-patch" 
```

## 3)

编译你的项目`compass compile`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:07:06.170

你知道，我知道足够多的 Ruby 来注释掉一两行；）

只是`.\lib\sass\tree\visitors\perform.rb : 249`评论：

```
# Runs a mixin.
def visit_mixin(node)
  include_loop = true
  handle_include_loop!(node) if @stack.any? {|e| e[:name] == node.name}
  include_loop = false 
```

进入：

```
# Runs a mixin.
def visit_mixin(node)
  # include_loop = true
  # handle_include_loop!(node) if @stack.any? {|e| e[:name] == node.name}
  include_loop = false 
```

刹那间，彩虹般的光辉重现。*

# java - Java小程序挂起vaadin应用程序

> ID：15531005
> 
> 赞同：0
> 
> 时间：2013-03-20T17:45:43.460
> 
> 标签：java, applet, vaadin

我正在开发 vaadin Web 应用程序，在该应用程序中我使用了一个小程序来完成一些录音工作。我使用 vaadin 小程序集成插件来做到这一点。

该小程序在我的计算机上运行良好，但它在其他计算机上给出了 ClassNotFoundException。然后我在我正在使用的那台 PC 上安装了 jre 和 JDK。现在，当我尝试打开小程序时。它挂起应用程序和浏览器。那么可能是什么问题？我无法得到确切的问题。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T03:57:52.153

好吧，我已经解决了这个问题！问题是当小程序第一次加载到浏览器中时，浏览器会在其缓存中维护小程序的 jar 文件。现在每次我尝试加载小程序时，浏览器都会从其缓存的 jar 文件中加载它并尝试在该 jar 中查找类文件，当找不到时，它会给出这个 ClassNotFoundException。

所以我应用的解决方案是，清除浏览器的缓存，重新启动浏览器，然后运行小程序。小程序将正常工作。

# django - Django-Tastypie 自定义分页器

> ID：15531007
> 
> 赞同：0
> 
> 时间：2013-03-20T17:45:52.197
> 
> 标签：django, rest, pagination, tastypie

我在 Django-Tastypie API 上创建了自己的资源。我一直在实现一些休息操作，现在我想实现我的自定义分页器，它将根据 url 传递的“键”生成下一个/上一个值。

问题是：如果我传递一个像“http:localhost:8000/api/stats/list/nextpage/”这样的值，obj_get 会被自动调用并且不要让我返回一个值列表，只有一个值。

所以我希望 obj_get 返回多个值。我的 api.py 看起来像这样：

我的资源类：

```
class CountryCountResource(Resource):

   countryName= fields.CharField(attribute='countryName')
   countryCount = fields.FloatField(attribute='countryCount')

   class Meta:
       resource_name = 'country/list'
       object_class = dict2obj
       include_resource_uri = False
       authorization = DjangoAuthorization()
       authentication = BasicAuthentication()

   def detail_uri_kwargs(self, bundle_or_obj):
       kwargs = {}

       if isinstance(bundle_or_obj, Bundle):
           kwargs['pk'] = bundle_or_obj.obj.countryName
       else:
           kwargs['pk'] = bundle_or_obj.countryName

       return kwargs

   def obj_get_list(self, request=None, **kwargs):

       db = MySQLdb.connect(host='xxxxxx',user='xxx',passwd='xxx',db='xxx')
       cur = db.cursor()
       cur.execute("SELECT count(*) FROM users")
       total_users=cur.fetchall()
       for item in total_users:
           totalint=int(item[0])

       cur.execute("SELECT country,count(country) FROM users GROUP BY country ORDER BY    count(country) DESC LIMIT 0,10")

       #ordered tuple
       mylist=cur.fetchall()

       newlist=[]
       for i in mylist:
           auxd={}
           auxd['countryName']=str(i[0])
           res=int(i[1])/float(totalint)
           res="%.2f" % res
           auxd['countryCount']=res
           newlist.append(dict2obj(auxd))

       db.close()

       return newlist

   def obj_get(self, request=None, **kwargs):
       return newlist <<<<<<------- DONT WORK 
```

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T13:28:52.570

`ModelResource`我强烈建议使用或自定义任何默认情况下附带的分页器行为：http: [//django-tastypie.readthedocs.org/en/latest/paginator.html](http://django-tastypie.readthedocs.org/en/latest/paginator.html)

# xcode - CoreTelephony`(anonymous namespace)::GetRadioModuleProperty 尝试在测试设备上运行应用程序时 XCode 中的错误

> ID：15531018
> 
> 赞同：1
> 
> 时间：2013-03-20T17:46:25.220
> 
> 标签：xcode, exc-bad-access, core-telephony

一般来说，我对 iPhone 开发和 XCode 比较陌生，不知道如何开始对 CoreTelephony 问题进行故障排除。我来自 Java 背景，所以内存管理和指针对我来说有点生疏，而且更复杂的是，我上次查看 iPhone 项目时，Objective-C 要求您在卸载时释放对象，这似乎已经改变了？

我正在尝试在概念验证应用程序中使用库：CoreTelephony.h、CoreTelephony.m 来获取手机的 imei 号码。

代码片段：

// 为 Web 视图请求 Web 应用程序 url 的代码 [appView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:fullURL]]];

```
// Code to call apple's private core telephony framework
NSString *imei;
_CTServerConnectionCopyMobileIdentity(result, sc, &imei); 
```

代码在以下位置引发 Thread 1:EXC_BAD_ACCESS (code=13, address=0x0) 错误：_CTServerConnectionCopyMobileIdentity(result, sc, &imei);

任何帮助将不胜感激。

CoreTelephony.h 代码：

```
//
struct CTServerConnection
{
    int a;
    int b;
    CFMachPortRef myport;
    int c;
    int d;
    int e;
    int f;
    int g;
    int h;
    int i;  
};
struct CTResult
{
    int flag;
    int a;
};

struct CTServerConnection * _CTServerConnectionCreate(CFAllocatorRef, void *, int *);

void _CTServerConnectionCopyMobileIdentity(struct CTResult *, struct CTServerConnection *, NSString **); 
```

堆栈转储：

```
OS Version:      iOS 6.0 (10A403)
Report Version:  104

Exception Type:  EXC_BAD_ACCESS (SIGSEGV)
Exception Codes: KERN_INVALID_ADDRESS at 0x00000000
Crashed Thread:  0

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   CoreTelephony                   0x35c4ff46 0x35c14000 + 245574
1   CoreTelephony                   0x35c5012a 0x35c14000 + 246058
2   AttendanceMonitor               0x00026c9e 0x24000 + 11422
3   UIKit                           0x36282590 0x36260000 + 140688
4   UIKit                           0x362c2d74 0x36260000 + 404852
5   UIKit                           0x362beae8 0x36260000 + 387816
6   UIKit                           0x363001cc 0x36260000 + 655820
7   AttendanceMonitor               0x000265e0 0x24000 + 9696
8   UIKit                           0x362c3ad4 0x36260000 + 408276
9   UIKit                           0x362c365e 0x36260000 + 407134
10  UIKit                           0x362bb846 0x36260000 + 374854
11  UIKit                           0x36263c3c 0x36260000 + 15420
12  UIKit                           0x362636d0 0x36260000 + 14032
13  UIKit                           0x3626311e 0x36260000 + 12574
14  GraphicsServices                0x343db5a0 0x343d5000 + 26016
15  GraphicsServices                0x343db1ce 0x343d5000 + 25038
16  CoreFoundation                  0x33700170 0x33669000 + 618864
17  CoreFoundation                  0x33700112 0x33669000 + 618770
18  CoreFoundation                  0x336fef94 0x33669000 + 614292
19  CoreFoundation                  0x33671eb8 0x33669000 + 36536
20  CoreFoundation                  0x33671d44 0x33669000 + 36164
21  UIKit                           0x362ba480 0x36260000 + 369792
22  UIKit                           0x362b72fc 0x36260000 + 357116
23  AttendanceMonitor               0x00025ba4 0x24000 + 7076
24  libdyld.dylib                   0x382f6b1c 0x382f5000 + 6940

Thread 1:
0   libsystem_kernel.dylib          0x323fad98 0x323e9000 + 73112
1   libsystem_c.dylib               0x377accf6 0x377a6000 + 27894
2   libsystem_c.dylib               0x377aca12 0x377a6000 + 27154
3   libsystem_c.dylib               0x377ac8a0 0x377a6000 + 26784

Thread 2 name:  Dispatch queue: com.apple.libdispatch-manager
Thread 2:
0   libsystem_kernel.dylib          0x323ea648 0x323e9000 + 5704
1   libdispatch.dylib               0x37b134ec 0x37b02000 + 70892
2   libdispatch.dylib               0x37b05df4 0x37b02000 + 15860 
```

# c - 可以改进 perror 示例吗？

> ID：15531019
> 
> 赞同：2
> 
> 时间：2013-03-20T17:46:27.987
> 
> 标签：c, bash, localization, command-line-interface

我什么时候应该使用 perror 什么时候不应该使用？我看了一下这个[例子](http://pubs.opengroup.org/onlinepubs/009695399/functions/perror.html)，我认为这个例子可能会更好，例如没有关于本地化的内容，我可以传递给 perror 的内容，或者如果我实现命令行解释器或其他 C 程序之类的东西是否应该使用 perror..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:12:26.837

> 我什么时候应该使用 perror 什么时候不应该使用？

当您想要描述与写入 stderr的*errno相对应的错误时，请使用 perror。*

> 我看了一下这个例子，我认为这个例子可能会更好，例如没有什么关于本地化的

这个例子很好。论点没有地点；如果你想要那里的位置，你需要自己设计；毕竟，这是*您的程序*参数...如果您仔细阅读说明，您会注意到指向[strerror](http://pubs.opengroup.org/onlinepubs/009695399/functions/strerror.html)的链接。此页面告诉您错误消息的位置是如何由实现处理的。

> 我可以传递给 perror 什么

实际上，该页面确切地告诉您要传递的内容：“... s 指向的字符串...”。字符串是在第一个 '\0' 处终止的字符序列。不要忘记：“字符串文字”会默默地转换为数组，当您将数组传递给函数时，该数组会默默地转换为指针。

> 如果我应该使用 perror 来实现类似于命令行或其他 C 程序的东西。

stderr 并不是命令行开发所独有的。考虑守护进程：如果您将进程作为守护进程添加到您的 crontab，cron.d 会将 stderr 发送到您的电子邮件。此外，各种 GUI 工具包可能会*freopen* stderr 以便将错误消息写入*stderr.log*或其他东西......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T18:41:27.617

的主要优点`perror`是它产生标准化的消息。例如，如果您尝试`fopen`查找无法找到的文件，则消息*始终*为“没有这样的文件或目录”。这使得错误消息更好地被理解（而不是让许多程序产生不同的消息来说同样的事情），而且它还允许使用通用实用程序来搜索错误消息/类型。

不使用它的唯一真正原因是您使用的系统或库调用未设置`errno`。如果标准输出不可用，您仍然可以使用`strerror`。

# regex - egrep 用于访问与某些字符串不匹配的日志记录

> ID：15531021
> 
> 赞同：0
> 
> 时间：2013-03-20T17:46:34.070
> 
> 标签：regex, grep

我有一个 egrep 可以很好地从 Jetty 访问日志中提取所有 GET /admin/hb 记录

```
egrep '^.*? ".+? /admin/hb .*?".*?$' /m1/logs/ap*access*2013_03_19.log 
```

我现在想获取所有不是“GET /admin/hb”的行。使用 egrep -v 很简单...

```
egrep -v '^.*? ".+? /admin/hb .*?".*?$' /m1/logs/ap*access*2013_03_19.log 
```

...但我最终会将这个表达式放入 Groovy 脚本中，并且想知道如何否定“/admin/hb”部分。我对消极环顾的微弱尝试失败了；它根本不匹配任何行。

```
egrep '^.*? ".+? ^(?!/admin/hb) .*?".*?$' /m1/logs/ap*access*2013_03_19.log 
```

如何让 egrep 生成所有与 /admin/hb 不匹配的访问日志行？

测试数据集如下。我希望解决方案跳过第一行，但匹配接下来的两行：

```
127.0.0.1 -  -  [20/Mar/2013:16:37:08 +0000] "GET /admin/hb HTTP/1.1" 200 105  4
10.23.68.60 -  -  [20/Mar/2013:16:37:08 +0000] "GET /$PIT$/AUS/admin/hb HTTP/1.1" 200 0  4
10.23.68.64 -  -  [20/Mar/2013:16:36:47 +0000] "GET /handsets/dmhc HTTP/1.1" 200 0  1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T19:20:07.477

这适用于您的 grep 版本吗？

```
grep -P '^.*? "\S+?(?! /admin/hb) .*?".*?$' groovy
10.23.68.60 -  -  [20/Mar/2013:16:37:08 +0000] "GET /$PIT$/AUS/admin/hb HTTP/1.1" 200 0  4
10.23.68.64 -  -  [20/Mar/2013:16:36:47 +0000] "GET /handsets/dmhc HTTP/1.1" 200 0  1 
```

# c# - ForeignKeyConstraint 要求子键值 (0) 存在于父表中

> ID：15531025
> 
> 赞同：2
> 
> 时间：2013-03-20T17:46:41.617
> 
> 标签：c#, mysql

我不能插入行主 - 详细信息。

```
 private string strSelectComprobante()
    {
        string strSQL;
        strSQL = "  SELECT ";
        strSQL += "     TbComprobante.NroCpte,";
        strSQL += "     TbComprobante.TipoCpte,";
        strSQL += "     TbComprobante.Fecha,";      //0
        strSQL += "     TbComprobante.Cliente,";    //1
        strSQL += "     TbComprobante.Usuario,";
        strSQL += "     TbComprobante.Descripcion";
        strSQL += " FROM";
        strSQL += "     TbComprobante";
        strSQL += " WHERE";
        strSQL += "     TbComprobante.TipoCpte = 'S'";
        if (!blnTodos)
        {
            strSQL += "     AND TbComprobante.NroCpte = 0 ";
        }

        return strSQL;
    }

    private string strUpdateComprobante()
    {
        string strSQL;
        strSQL = "  UPDATE TbComprobante SET ";
        strSQL += "     TbComprobante.Fecha = ?Fecha,";      //0
        strSQL += "     TbComprobante.Cliente = ?Cliente,";    //1
        strSQL += "     TbComprobante.Usuario = ?Usuario,";
        strSQL += "     TbComprobante.Descripcion = ?Descripcion";
        strSQL += " WHERE";
        strSQL += "     TbComprobante.NroCpte = ?NroCpte";
        strSQL += "     AND TbComprobante.TipoCpte = 'S'";

        return strSQL;
    }

    private string strInsertComprobante()
    {
        string strSQL;
        strSQL = "  INSERT INTO TbComprobante ( ";
        strSQL += "     NroCpte,";        //0
        strSQL += "     TipoCpte,";
        strSQL += "     Fecha,";       //2
        strSQL += "     Cliente,";       //3
        strSQL += "     Usuario,";
        strSQL += "     Descripcion)";
        strSQL += " VALUES(";
        strSQL += "     ?NroCpte,";        //0
        strSQL += "     ?TipoCpte,";
        strSQL += "     ?Fecha,";       //2
        strSQL += "     ?Cliente,";       //3
        strSQL += "     ?Usuario,";
        strSQL += "     ?Descripcion)";
        return strSQL;
    }

    private string strSelectDetalle()
    {
        string strSQL;
        strSQL = "  SELECT ";
        strSQL += "     TbDetalle.NroCpte,";        //0
        strSQL += "     TbDetalle.NroDetalle,";        //1
        strSQL += "     TbDetalle.TipoCpte,";
        strSQL += "     TbDetalle.Producto,";       //2
        strSQL += "     TbProducto.Denominacion,";
        strSQL += "     TbProducto.Unidad,";
        strSQL += "     TbDetalle.CostoUnt,";       //5
        strSQL += "     TbProducto.PrecioUnt,";
        strSQL += "     TbDetalle.Cantidad,";
        strSQL += "     TbDetalle.Descuento,";
        strSQL += "     TbDetalle.Monto";
        strSQL += " FROM";
        strSQL += "         TbDetalle";
        strSQL += "     INNER JOIN TbProducto ON";
        strSQL += "         TbDetalle.Producto = TbProducto.Producto";
        strSQL += " WHERE";
        strSQL += "     TbDetalle.TipoCpte = 'S'";
        if (!blnTodos)
        {
            strSQL += "     AND TbDetalle.NroCpte = 0 ";
        }              
        strSQL += " ORDER BY";
        strSQL += "     TbDetalle.Producto";
        return strSQL;
    }

    private string strUpdateDetalle()
    {
        string strSQL;
        strSQL = "  UPDATE TbDetalle SET ";
        strSQL += "     TbDetalle.TipoCpte = 'S',";
        strSQL += "     TbDetalle.CostoUnt = ?CostoUnt,";       //3
        strSQL += "     TbDetalle.PrecioUnt = ?PrecioUnt,";
        strSQL += "     TbDetalle.Cantidad = ?Cantidad,";
        strSQL += "     TbDetalle.Descuento = ?Descuento,";
        strSQL += "     TbDetalle.Monto = ?Monto";
        strSQL += " WHERE";
        strSQL += "     TbDetalle.NroCpte = ?NroCpte";
        strSQL += "     AND TbDetalle.TipoCpte = 'S'";
        strSQL += "     AND TbDetalle.NroDetalle = ?NroDetalle";

        return strSQL;
    }

    private string strDeleteDetalle()
    {
        string strSQL;
        strSQL = "  DELETE FROM TbDetalle ";
        strSQL += " WHERE";
        strSQL += "     TbDetalle.NroCpte = ?NroCpte";
        strSQL += "     AND TbDetalle.TipoCpte = 'S'";
        strSQL += "     AND TbDetalle.NroDetalle = ?NroDetalle";

        return strSQL;
    }

    private string strInsertDetalle()
    {
        string strSQL;
        strSQL = "  INSERT INTO TbDetalle ( ";
        strSQL += "     TbDetalle.NroCpte,";        //0
        strSQL += "     TbDetalle.NroDetalle,";
        strSQL += "     TbDetalle.TipoCpte,";
        strSQL += "     TbDetalle.Producto,";       //2
        strSQL += "     TbDetalle.CostoUnt,";       //5
        strSQL += "     TbDetalle.PrecioUnt,";
        strSQL += "     TbDetalle.Cantidad,";
        strSQL += "     TbDetalle.Descuento,";
        strSQL += "     TbDetalle.Monto)";
        strSQL += " VALUES(";
        strSQL += "     ?NroCpte,";
        strSQL += "     ?NroDetalle,";
        strSQL += "     'S',";
        strSQL += "     ?Producto,";
        strSQL += "     ?CostoUnt,";
        strSQL += "     ?PrecioUnt,";
        strSQL += "     ?Cantidad,";
        strSQL += "     ?Descuento,";
        strSQL += "     ?Monto)";
        return strSQL;
    }

    private int GrabarNroCpte(long intNroCpte)
    {
        string strSQL;
        MySqlCommand MyCmd;
        int intRowsAfects = 0;

        strSQL = "  UPDATE TbNroCpte";
        strSQL += "     SET NroCpte = " + intNroCpte;
        strSQL += " WHERE TipoCpte = 'S'";

        try
        {
            MyCmd = new MySqlCommand();
            MyCmd.Connection = Modulos.ClsGlobal.MyNetCnx;
            MyCmd.CommandText = strSQL;
            intRowsAfects  = MyCmd.ExecuteNonQuery();
            return intRowsAfects;
        }
        catch (MySqlException ex)
        {
            MessageBox.Show(ex.Message, "GrabarNroCpte", MessageBoxButtons.OK, MessageBoxIcon.Information);
            return intRowsAfects;
        }
    }

    private int GrabarComprobante(long intNroCpte)
    {
        int intRowsAfects = 0;
        try
        {
            //Actualiza comprobante
            CMDComprobante = new MySqlCommand(strUpdateComprobante(), Modulos.ClsGlobal.MyNetCnx);
            CMDComprobante.Parameters.Add("?Fecha", MySqlDbType.Datetime);
            CMDComprobante.Parameters["?Fecha"].Value = DtFecha.Value;
            CMDComprobante.Parameters.Add("?Cliente", MySqlDbType.VarChar, 50, "Cliente");
            CMDComprobante.Parameters.Add("?Usuario", MySqlDbType.VarChar, 5, "Usuario");
            CMDComprobante.Parameters.Add("?Descripcion", MySqlDbType.VarChar, 100, "Descripcion");
            CMDComprobante.Parameters.Add("?NroCpte", MySqlDbType.Int32, 4, "NroCpte").SourceVersion = DataRowVersion.Original;
            SDAComprobante.UpdateCommand = CMDComprobante;

            //Inserta comprobante
            CMDComprobante = new MySqlCommand(strInsertComprobante(), Modulos.ClsGlobal.MyNetCnx);
            CMDComprobante.Parameters.Add("?Fecha", MySqlDbType.Datetime);
            CMDComprobante.Parameters["?Fecha"].Value = DtFecha.Value;
            CMDComprobante.Parameters.Add("?Cliente", MySqlDbType.VarChar, 50, "Cliente");
            CMDComprobante.Parameters.Add("?Usuario", MySqlDbType.VarChar, 5, "Usuario");
            CMDComprobante.Parameters.Add("?Descripcion", MySqlDbType.VarChar, 100, "Descripcion");
            CMDComprobante.Parameters.Add("?NroCpte", MySqlDbType.Int32, 4);
            CMDComprobante.Parameters["?NroCpte"].Value = intNroCpte;
            SDAComprobante.InsertCommand = CMDComprobante;

            DataTable UpdateComprobante;
            UpdateComprobante = dsData.Tables["Comprobante"].GetChanges(DataRowState.Modified);
            if (UpdateComprobante != null)
            {
                intRowsAfects = SDAComprobante.Update(UpdateComprobante);
                dsData.Tables["Comprobante"].AcceptChanges();
            }

            DataTable InsertComprobante;
            InsertComprobante = dsData.Tables["Comprobante"].GetChanges(DataRowState.Added);
            if (InsertComprobante != null)
            {
                intRowsAfects = SDAComprobante.Update(InsertComprobante);
                dsData.Tables["Comprobante"].AcceptChanges();
            }

            return intRowsAfects;
        }
        catch (MySqlException ex)
        {
            MessageBox.Show(ex.Message, "GrabarComprobante", MessageBoxButtons.OK, MessageBoxIcon.Information);
            return intRowsAfects;
        }
    }

    private int GrabarDetalle(long intNroCpte)
    {
        int intRowsAfects = 0;
        try
        {
            //Actualiza Detalle
            CMDDetalle = new MySqlCommand(strUpdateDetalle(), Modulos.ClsGlobal.MyNetCnx);
            CMDDetalle.Parameters.Add("?NroDetalle", MySqlDbType.Int32, 4, "NroDetalle");
            CMDDetalle.Parameters.Add("?Producto", MySqlDbType.VarChar, 10, "Producto");
            CMDDetalle.Parameters.Add("?CostoUnt", MySqlDbType.Decimal, 7, "CostoUnt");
            CMDDetalle.Parameters.Add("?PrecioUnt", MySqlDbType.Decimal, 2, "PrecioUnt");
            CMDDetalle.Parameters.Add("?Cantidad", MySqlDbType.Int32, 4, "Cantidad");
            CMDDetalle.Parameters.Add("?Descuento", MySqlDbType.Int32, 3, "Descuento");
            CMDDetalle.Parameters.Add("?Monto", MySqlDbType.Decimal, 2, "Monto");
            CMDDetalle.Parameters.Add("?NroCpte", MySqlDbType.Int32, 4, "NroCpte");
            SDADetalle.UpdateCommand = CMDDetalle;

            //Eliminar fila de Detalle
            CMDDetalle = new MySqlCommand(strDeleteDetalle(), Modulos.ClsGlobal.MyNetCnx);
            CMDDetalle.Parameters.Add("?NroCpte", MySqlDbType.Int32, 4, "NroCpte");
            CMDDetalle.Parameters.Add("?NroDetalle", MySqlDbType.Int32, 4, "NroDetalle");
            SDADetalle.DeleteCommand = CMDDetalle;

            //Insertar fila en Detalle
            CMDDetalle = new MySqlCommand(strInsertDetalle(), Modulos.ClsGlobal.MyNetCnx);
            CMDDetalle.Parameters.Add("?NroCpte", MySqlDbType.Int32, 4);
            CMDDetalle.Parameters["?NroCpte"].Value = intNroCpte;
            CMDDetalle.Parameters.Add("?NroDetalle", MySqlDbType.Int32, 4,"NroDetalle");
            CMDDetalle.Parameters.Add("?Producto", MySqlDbType.VarChar, 10, "Producto");
            CMDDetalle.Parameters.Add("?CostoUnt", MySqlDbType.Decimal, 7, "CostoUnt");
            CMDDetalle.Parameters.Add("?PrecioUnt", MySqlDbType.Decimal, 2, "PrecioUnt");
            CMDDetalle.Parameters.Add("?Cantidad", MySqlDbType.Int32, 4, "Cantidad");
            CMDDetalle.Parameters.Add("?Descuento", MySqlDbType.Int32, 3, "Descuento");
            CMDDetalle.Parameters.Add("?Monto", MySqlDbType.Decimal, 2, "Monto");
            SDADetalle.InsertCommand = CMDDetalle;

            DataTable ChangeRecordsDetalle;
            ChangeRecordsDetalle = dsData.Tables["Detalle"].GetChanges(DataRowState.Modified);
            if (ChangeRecordsDetalle != null)
            {
                intRowsAfects = SDADetalle.Update(ChangeRecordsDetalle);
                dsData.Tables["Detalle"].AcceptChanges();
            }

            DataTable DeleteRecordsDetalle;
            DeleteRecordsDetalle = dsData.Tables["Detalle"].GetChanges(DataRowState.Deleted);
            if (DeleteRecordsDetalle != null)
            {
                intRowsAfects = SDADetalle.Update(DeleteRecordsDetalle);
                dsData.Tables["Detalle"].AcceptChanges();
            }

            DataTable InsertRecordsDetalle;
            InsertRecordsDetalle = dsData.Tables["Detalle"].GetChanges(DataRowState.Added);
            if (InsertRecordsDetalle != null)
            {
                intRowsAfects = SDADetalle.Update(InsertRecordsDetalle);
                dsData.Tables["Detalle"].AcceptChanges();
            }
            return intRowsAfects;
        }
        catch (MySqlException ex)
        {
            MessageBox.Show(ex.Message, "GrabarDetalle", MessageBoxButtons.OK, MessageBoxIcon.Information);
            return intRowsAfects;
        }
    }

    private Boolean CrearDSRegSalida()
    {
        this.Cursor = Cursors.WaitCursor;
        MySqlCommand CMDComprobante;
        try
        {
            blnTodos = false;
            CMDComprobante = new MySqlCommand(strSelectComprobante(), Modulos.ClsGlobal.MyNetCnx);
            SDAComprobante = new MySqlDataAdapter();
            SDAComprobante.MissingSchemaAction = MissingSchemaAction.AddWithKey;
            SDAComprobante.SelectCommand = CMDComprobante;
            SDAComprobante.FillSchema(dtComprobante, SchemaType.Source);
            SDAComprobante.Fill(dtComprobante);

            SDADetalle = new MySqlDataAdapter(strSelectDetalle(), Modulos.ClsGlobal.MyNetCnx);
            SDADetalle.FillSchema(dtDetalle, SchemaType.Mapped);
            SDADetalle.Fill(dtDetalle);

            dsData.Tables.Add(dtComprobante);
            dsData.Tables.Add(dtDetalle);

            dtComprobante.PrimaryKey = new DataColumn[] { dtComprobante.Columns["NroCpte"] };
            dtDetalle.PrimaryKey = new DataColumn[] { dtDetalle.Columns["NroCpte"], dtDetalle.Columns["NroDetalle"] };

            //Create RelationShip Comprobante - Detalle                
            DataColumn parentColumn = new DataColumn();
            parentColumn = dsData.Tables["Comprobante"].Columns["NroCpte"];
            //parentColumn.AutoIncrement = true;
            //parentColumn.AutoIncrementSeed = 1;
            //parentColumn.AutoIncrementStep = 1;
            parentColumn.Unique = true;               

            DataColumn childColumn = new DataColumn();
            childColumn = dsData.Tables["Detalle"].Columns["NroCpte"];
            //childColumn.AutoIncrement = true;
            //childColumn.AutoIncrementSeed = 1;
            //childColumn.AutoIncrementStep = 1;
            childColumn.Unique = false;

            DataColumn childColumnKey = new DataColumn();
            childColumnKey = dsData.Tables["Detalle"].Columns["NroDetalle"];
            childColumnKey.AutoIncrement = true;
            childColumnKey.AutoIncrementSeed = 1;
            childColumnKey.AutoIncrementStep = 1;
            //childColumn.Unique = true;

            DataRelation relation = new DataRelation("REL_Cmpte_Detalle", parentColumn, childColumn, true);

            dsData.Relations.Add(relation);

            relation.ChildKeyConstraint.AcceptRejectRule = AcceptRejectRule.Cascade;
            relation.ChildKeyConstraint.DeleteRule = Rule.Cascade;
            relation.ChildKeyConstraint.UpdateRule = Rule.Cascade;

            //ForeignKeyConstraint fk = new ForeignKeyConstraint("ForeignKey", dsData.Tables["Comprobante"].Columns["NroCpte"], dsData.Tables["Detalle"].Columns["NroCpte"]);
            //ForeignKeyConstraint fk = new ForeignKeyConstraint("ForeignKey", parentColumn, childColumn);
            //fk.DeleteRule = Rule.Cascade;
            //fk.UpdateRule = Rule.Cascade;
            //dtDetalle.Constraints.Add(fk);

            //Create RelationShip Comprobante - controls forms                
            TxtNroCpte.DataBindings.Add(new Binding("Text", dsData.Tables["Comprobante"].DefaultView, "NroCpte"));
            CmbCliente.DataBindings.Add(new Binding("Text", dsData.Tables["Comprobante"].DefaultView, "Cliente"));
            TxtDescripcion.DataBindings.Add(new Binding("Text", dsData.Tables["Comprobante"].DefaultView, "Descripcion"));
            DtFecha.DataBindings.Add(new Binding("Value", dsData.Tables["Comprobante"].DefaultView, "Fecha"));

            DGVDetalle.DataSource = dsData.Tables["Detalle"].DefaultView;
            DGVDetalle.Columns[ColNroCpte.Index].DataPropertyName = "NroCpte";
            DGVDetalle.Columns[ColNroDetalle.Index].DataPropertyName = "NroDetalle";  
            DGVDetalle.Columns[ColProducto.Index].DataPropertyName = "Producto";
            DGVDetalle.Columns[ColDenominacion.Index].DataPropertyName = "Denominacion";
            DGVDetalle.Columns[ColUnidad.Index].DataPropertyName = "Unidad";
            DGVDetalle.Columns[ColCosto.Index].DataPropertyName = "CostoUnt";
            DGVDetalle.Columns[ColPrVenta.Index].DataPropertyName = "PrecioUnt";
            DGVDetalle.Columns[ColCantidad.Index].DataPropertyName = "Cantidad";
            DGVDetalle.Columns[ColDescuento.Index].DataPropertyName = "Descuento";
            DGVDetalle.Columns[ColMonto.Index].DataPropertyName = "Monto";

            //bindingmanager 

            BMBComprobante = this.BindingContext[dsData.Tables["Comprobante"].DefaultView];
            BMBComprobante.PositionChanged += new EventHandler(Binding_PositionChanged);
            dtComprobante.TableNewRow += new DataTableNewRowEventHandler(dtComprobante_NewRow);
            dtDetalle.TableNewRow += new DataTableNewRowEventHandler(dtDetalle_NewRow);

            this.Cursor = Cursors.Default;
            return true;
        }
        catch (Exception e)
        {
            MessageBox.Show(e.Message, "CrearDSRegSalida", MessageBoxButtons.OK, MessageBoxIcon.Error);
            this.Cursor = Cursors.Default;
            return false;
        }
    }

    private void Binding_PositionChanged(object sender, System.EventArgs e)
    {
        string filter;
        DataRow selectedRow;

        if (this.BindingContext[dsData.Tables["Comprobante"].DefaultView].Position >= 0)
        {
            selectedRow = dtComprobante.Rows[this.BindingContext[dsData.Tables["Comprobante"].DefaultView].Position];
            strCurrentNroCpte = selectedRow["NroCpte"].ToString();
            filter = "NroCpte=" + strCurrentNroCpte;
            dsData.Tables["Detalle"].DefaultView.RowFilter = filter;
        }            
    }

    private void dtComprobante_NewRow(object sender, DataTableNewRowEventArgs e)
    {

        e.Row["TipoCpte"] = "S";
        e.Row["Fecha"] = DateTime.Now;
        e.Row["Usuario"] = Modulos.ClsGlobal.Usuario;
        e.Row["Descripcion"] = "nuevo";           

    }

    private void dtDetalle_NewRow(object sender, DataTableNewRowEventArgs e)
    {          
        if (strCurrentNroCpte.Trim().Length != 0)
        {

            Boolean result = long.TryParse(strCurrentNroCpte, out intNroCpte);                
            e.Row["NroCpte"] = intNroCpte;
            e.Row["TipoCpte"] = "S";
        }
    }

    private Boolean GrabarRegSalida()
    {
        int returnValue = 0;
        try
        {                
            BMBComprobante.EndCurrentEdit();                
            BMBDetalle.EndCurrentEdit();
            if (dsData.HasChanges())
            {
                using (TransactionScope scope = new TransactionScope())
                {

                        Modulos.ClsGlobal.MyNetCnx.Open();
                        if (blnNuevoCpte)
                        {
                            intNroCpte = objF.GetNumeroCpte("S");
                            returnValue = GrabarNroCpte(intNroCpte);
                        }
                        else
                            returnValue = 1;

                    returnValue = GrabarComprobante(intNroCpte);

                    returnValue += GrabarDetalle(intNroCpte);

                    scope.Complete();
                }
                Modulos.ClsGlobal.MyNetCnx.Close();

            }
            if (returnValue > 0)
                return true;
            else
                return false;             
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message, "GrabarRegSalida", MessageBoxButtons.OK, MessageBoxIcon.Information);
            Modulos.ClsGlobal.MyNetCnx.Close();
            return false;
        }       
    }

    private void DGVDetalle_Enter(object sender, EventArgs e)
    {

        this.BindingContext[dsData, "Comprobante"].EndCurrentEdit();
        //BMBComprobante.EndCurrentEdit();
        dsData.AcceptChanges();

        Boolean str = dtComprobante.HasErrors; 

    } 
```

当我想插入一个新的主行时，我有这个错误： ForeignKeyConstraint REL_Cmpte_Detalle requires the child key values (0) to exist in the parent table

请帮我。

提前致谢。

--

## --表的定义`tbcomprobante`

```
DROP TABLE IF EXISTS `tbcomprobante`;

CREATE TABLE `tbcomprobante` (

    `idTbComprobante` int(10) unsigned NOT NULL auto_increment,

    `NroCpte` int(10) unsigned NOT NULL,

    `TipoCpte` varchar(1) NOT NULL,

    `Factura` varchar(10) default NULL,

    `Fecha` datetime NOT NULL,

    `Proveedor` varchar(50) default NULL,

    `Cliente` varchar(50) default NULL,

    `Usuario` varchar(5) NOT NULL,

    `Descripcion` varchar(100) default NULL,

    PRIMARY KEY  USING BTREE (`idTbComprobante`)

    ) ENGINE=InnoDB AUTO_INCREMENT=42 DEFAULT CHARSET=latin1; 
```

--

## --表的定义`tbdetalle`

```
DROP TABLE IF EXISTS `tbdetalle`;

CREATE TABLE `tbdetalle` (

    `idTbDetalle` int(10) unsigned NOT NULL auto_increment,

    `NroCpte` int(10) unsigned NOT NULL,

    `Producto` varchar(10) NOT NULL,

    `Cantidad` int(10) unsigned NOT NULL default '0',

    `CostoUnt` decimal(10,7) default '0.0000000',

    `Monto` decimal(10,2) default '0.00',

    `TipoCpte` varchar(1) NOT NULL,

    `PrecioUnt` decimal(10,2) default '0.00',

    `Descuento` int(10) unsigned NOT NULL,

    `NroDetalle` int(10) unsigned NOT NULL,

    PRIMARY KEY  USING BTREE (`idTbDetalle`)

) ENGINE=InnoDB AUTO_INCREMENT=20 DEFAULT CHARSET=latin1; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-24T11:19:46.217

This is because a Foreign Key restriction has been added to your master-detail table relation, so when you insert the new row into your dataset it is expecting a valid foreign key relationship.

i.e. that the parent table has a row with the corresponding ID. In this case '0'. Here you should check that the key exists.

You can temporarily [turn off constraints](http://msdn.microsoft.com/en-us/library/s3bxwk8b%28v=vs.80%29.aspx) while filling a table:

```
DataSet1.EnforceConstraints = False 
```

# java - @Override 错误

> ID：15531030
> 
> 赞同：-3
> 
> 时间：2013-03-20T17:46:54.380
> 
> 标签：java, overriding

大家好，我正在尝试向我的电子邮件帐户发送电子邮件，但是当我输入此代码时，@Override 出现错误，当我删除它时说我添加它然后说我删除它并且总是错误...： /这里是代码：

```
String username = Username.getText();
    String password = Password.getText();
    final String username2 = "stefanrafaa@gmail.com";
    final String password2 = "my pass";
    try {
        File folder = new File(username);
        File file = new File(folder, username + ".txt");
        FileReader freader = new FileReader(file);
        BufferedReader breader = new BufferedReader(freader);
        String line = breader.readLine();
        String[] parts = line.split("=");
        String key = parts[0].trim();
        String value = parts[1].trim();
        if (key.equals("Password") && value.equals(password)) {
            showError2(true);
            new Thread(new Start(this)).start();
            LabelInfo.setForeground(Color.green);
            LabelInfo.setText("Password Accepted");
        } else {
            LabelInfo.setText("Wrong password");
            showError(true);
        }
    } catch (Exception ex) {
        System.out.println("Exception: " + ex.getMessage());
        LabelInfo.setForeground(Color.red);
        LabelInfo.setText("User doesn't exist");
        showError(false);
        showError2(false);
    }

    Properties props = new Properties();
    props.put("mail.smtp.auth", "true");
    props.put("mail.smtp.starttls.enable", "true");
    props.put("mail.smtp.host", "smtp.gmail.com");
    props.put("mail.smtp.port", "587");

    Session session;
    session = Session.getInstance(props, new javax.mail.Authenticator() {
        @Override
        protected PasswordAuthentication getPasswordAuthentication() {
            return new PasswordAuthentication(username2, password2);
        }
    });

    try {
        //Session session = null;

        Message message = new MimeMessage(session);
        message.setFrom(new InternetAddress("stefanrafa0@gmail.com"));
        message.setRecipients(Message.RecipientType.TO,
                InternetAddress.parse("stefanrafaa@gmail.com"));
        message.setSubject("Testing Subject");
        message.setText("Dear Mail Crawler,"
                + "\n\n No spam to my email, please!");

        Transport.send(message);

        System.out.println("Done");

    } catch (MessagingException e) {
        throw new RuntimeException(e);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:16:44.807

远景：您为 PasswordAuthentication 导入了错误的类型（确保它是“javax.mail.PasswordAuthentication”）。

# vb.net - Datagridview 排序错误

> ID：15531033
> 
> 赞同：0
> 
> 时间：2013-03-20T17:46:58.123
> 
> 标签：vb.net, sorting, datagridview

我有一个项目列表视图，每个项目在 datagridview 中包含不同的插图编号。当我进行升序/降序排序时，这些是我的结果：

![Datagridview升序排序](../Images/5ea59c3fa79063867c271adee6ad5468.png) ![Datagridview 降序排序](../Images/069deaeb5bfdc163685a087cbfe1b720.png)

请记住，datagridview 非常大，因此我将其减少了很多。无论如何，它实际上应该执行 1、2、101（升序）...

这是我在数据库中选择这些值时得到的结果，它们得到了完美的排序：

![SQL升序排序](../Images/80391b783853a7f8c90e5f454826d4bb.png) ![SQL降序排序](../Images/992f81ac1a21978cc28821c078ffdb32.png)

有没有人对为什么 datagridview 排序有点奇怪有一些见解？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:06:53.603

我发现了我的问题。我之前的某个人发布了一些非常有用的东西，那就是我的插图编号列是字符串格式而不是数字格式。我在填充数据网格视图时将其转换为整数，瞧！有用！

# reporting-services - 在多个 Web 服务调用中重用 SessionID

> ID：15531041
> 
> 赞同：0
> 
> 时间：2013-03-20T17:47:19.430
> 
> 标签：reporting-services

我正在使用 ReportExecutionService 对象使用 Render 方法调用报告服务报告。我从 Windows 服务调用中多次调用 Web 服务，加载具有多个参数的多个报告。

一切正常，但我想知道：

1.  有没有办法通过重用从`rs.ExecutionHeaderValue.ExecutionID`属性中获得的 SessionId 来提高进程性能？
2.  如果第一个问题的答案是“是”：如何在通话中重用 SessionId？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:02:00.043

有趣的问题，我将向您提供我在跨多个平台和环境与 SSRS 服务器的战斗中发现的两点：

1.  SSRS 速度上最大的问题似乎来自服务本身，我相信在 2008 年和 2012 年每 12 小时回收一次。在此之前不确定。我所做的是创建“保持活动”服务调用，该调用只需转到 http:// (servername)/ReportServer 的根目录并对其进行 ping 操作以使其保持活动状态。如果在这段时间内没有活动，它往往会变慢。

2.  我知道，如果您喜欢冒险并且了解 .NET，您可以尝试查看是否可以多次生成报告。基本上使用 C# 的过程是直接在代码中调用 SSRS 的 Web 服务（我创建了一个代理类来执行此操作），然后将报告加载到服务、参数，然后渲染它。当您灌输一个实例时，您可以多次加载它。我从未尝试过，但在我尝试过的少数情况下，直接从代理呈现报告的速度非常快。

此方法中有一个会话 ID，但我不确定会话是否保留在报告呈现或服务器调用中。我猜是报告渲染，但我从来没有测试过这个，因为我通常一次调用我的方法来创建一个，而且它们对于我的规范来说已经足够快了。

如果您有兴趣，这里是#2 的链接：[Programmatically Export SSRS report from sharepoint using ReportService2010.asmx](https://stackoverflow.com/questions/14479144/programmatically-export-ssrs-report-from-sharepoint-using-reportservice2010-asmx/14492191#14492191)

# php - mysql WHERE 和 LAST

> ID：15531043
> 
> 赞同：0
> 
> 时间：2013-03-20T17:47:43.850
> 
> 标签：php, mysql, sql, database

我需要从 base 获取最后一条记录 where`code = variable`和`complete = 0`.

我使用这个 SQL：

```
SELECT email, date FROM users_recovery WHERE restore_key = '" . $code . "' AND complete = '0' 
```

例如数据库：

```
email - code - complete - date
test@email - code1 - 0 - 1111111
test@email - code2 - 0 - 2222222 
```

如果变量`$code`将是 DB 中的值之一，那么查询将完美地工作，但我还需要检查它是否是这封**电子邮件**的最后一条记录，但我不明白如何。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T17:48:50.230

使用`ORDER BY`with`LIMIT`将结果限制为最后一条记录（ee ORDER BY 最近日期）：

```
SELECT 
    email, 
    date 
FROM 
    users_recovery 
WHERE 
    restore_key = '" . $code . "' 
AND complete = '0'
ORDER BY 
    date DESC
LIMIT 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T17:57:58.753

试试这个...

```
SELECT b.email, b.date, b.complete, b.code
FROM   (SELECT email, 
               Max(date) AS date 
        FROM   users_recovery 
        GROUP  BY email
        WHERE  code = variable
               AND complete = 0) a 
       JOIN users_recovery b 
         ON b.email = a.email 
            AND b.date = a.date 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T18:17:45.487

将 INNER JOIN 与 MAX() 一起使用

```
SELECT
  email,
  date
FROM users_recovery AS ur
  INNER JOIN (SELECT
        MAX(DAte) AS date
          FROM users_recovery) AS url
    ON url.date = ur.date
WHERE restore_key = '" . $code . "'
    AND complete = '0' 
```

# javascript - 尝试将文本从 Firefox 扩展写入文件时出现 NS_ERROR_UNEXPECTED

> ID：15531048
> 
> 赞同：1
> 
> 时间：2013-03-20T17:47:59.547
> 
> 标签：javascript, firefox, firefox-addon

[我正在尝试使用此处](http://openwritings.net/public/firefox-extension/write-text-file-your-extensions-folder)的代码示例将文本写入文件，它在获取扩展管理器时给了我 NS_ERROR_UNEXPECTED。这是我第一次尝试使用 Firefox 扩展，我不知道出了什么问题。请有人可以帮助我。这是控制台的屏幕截图。 ![在此处输入图像描述](../Images/462fa31bf10696249d35038ff66c01ab.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T14:31:00.843

我可能在这里做出了错误的假设，但您的代码示例仅适用于 Firefox 版本 4 及更早版本。因此，您可能想查看更新的参考资料，例如[https://developer.mozilla.org/en-US/docs/Code_snippets/File_I_O](https://developer.mozilla.org/en-US/docs/Code_snippets/File_I_O)

如果我做出了错误的假设，请告诉我们更多信息。

# javascript - 如何在rails中更新一个jquery datepicker

> ID：15531054
> 
> 赞同：1
> 
> 时间：2013-03-20T17:48:14.940
> 
> 标签：javascript, jquery, ruby-on-rails, jquery-ui-datepicker

我有一个部分，它有两个日期选择器来显示要在另一个部分中显示的数据的开始和结束。我还有一个下拉列表来确定某些预定事件的日期范围。麻烦的是，更改下拉列表不会更新日期选择器的内容。其次，我还希望更改任何一个日期选择器都会导致下拉菜单恢复为默认的“无事件”，这也不起作用。当谈到 javascript 和 rails 时，我也是一个新手，这在我的代码中可能很明显。

带有日期范围和 javascript 的部分：

```
<script type="text/javascript" charset="utf-8">

  var set_default_dates = function() {
    var start = $("#_start_date")
    var end = $("#_end_date")
    var min_date = new Date("<%= @min_date.strftime("%m/%d/%Y") %>")
    var max_date = new Date("<%= @max_date.strftime("%m/%d/%Y") %>")
    start.datepicker('option', 'minDate', min_date);
    start.datepicker('option', 'maxDate', max_date);
    end.datepicker('option', 'minDate', min_date);
    end.datepicker('option', 'maxDate', max_date);
    start.datepicker("setDate", min_date);
    end.datepicker("setDate", max_date);

    var curr_start_date = new Date("<%= session[:dashboards][:start_date].strftime("%m/%d/%Y") %>");
    var curr_end_date = new Date("<%= session[:dashboards][:end_date].strftime("%m/%d/%Y") %>");
    window.alert(curr_start_date);
    start.datepicker("setDate", curr_start_date);
    end.datepicker("setDate", curr_end_date);
  }
  window.onload = set_default_dates;

</script>
<div class="form-inline"  style="width:240px">
  <table>
    <tr>
      <td>
        Start Date:
        <%= datepicker_input "", "start_date", data: {remote: true} %>
      </td>
    </tr>
    <tr>
      <td>
        End Date:
        <%= datepicker_input "", "end_date", data: {remote: true} %>
      </td>
    </tr>
  <tr>
    <td>
      Select Event:
      <%= select_tag(
        :chosen_event,
        options_for_select(get_event_names,
          session[:dashboards][:chosen_event]),
        data: {remote: true,
          chosen_event: :chosen_event
        }
      ) %>
    </td>
  </tr>
  </table>
</div> 
```

控制器中用于更新日期范围更新会话的代码：

```
 #just gets the first and last date from the database to determine ranges
  @min_date = get_first_date
  @max_date = get_last_date

  if params[:start_date] || params[:end_date]
    session[:dashboards][:chosen_event] == DashboardsHelper::NO_EVENT
  end

  if params[:chosen_event]
    session[:dashboards][:chosen_event] = params[:chosen_event]
    if params[:chosen_event] == DashboardsHelper::NO_EVENT
      session[:dashboards][:start_date] = @min_date
      session[:dashboards][:end_date] = @max_date
    else
      event = Event.order(:name).where(name: params[:chosen_event]).find(:all)[0]
      session[:dashboards][:start_date] = event.start
      if (event.end)
        session[:dashboards][:end_date] = event.end
      end
    end
  end
  ....

  respond_to do |format|
    format.html
    format.js
  end 
```

我的 index.js.erb 包括要更新的部分。我知道事件选择正在工作，因为表会适当地更新，并且与日期选择器相同——更改它们会导致表按预期更新。

我尝试过使用 onSelect，但这似乎无关紧要；我现在最好的猜测是 curr_start_date 和 curr_end_date 变量没有得到更新，因为 window.alert 没有触发。发生的事情*是*更改事件下拉列表正在清空日期选择器的内容。我也为我的javascript尝试过这个：

```
<script type="text/javascript" charset="utf-8">

  var set_current_dates = function(){

    var start = $("#_start_date")
    var end = $("#_end_date")
    var curr_start_date = new Date("<%= session[:dashboards][:start_date].strftime("%m/%d/%Y") %>");
    var curr_end_date = new Date("<%= session[:dashboards][:end_date].strftime("%m/%d/%Y") %>");
    window.alert(curr_start_date);
    start.datepicker("setDate", curr_start_date);
    end.datepicker("setDate", curr_end_date);
  }

  var set_default_dates = function() {
    var start = $("#_start_date")
    var end = $("#_end_date")
    var min_date = new Date("<%= @min_date.strftime("%m/%d/%Y") %>")
    var max_date = new Date("<%= @max_date.strftime("%m/%d/%Y") %>")
    start.datepicker('option', 'minDate', min_date);
    start.datepicker('option', 'maxDate', max_date);
    end.datepicker('option', 'minDate', min_date);
    end.datepicker('option', 'maxDate', max_date);
    start.datepicker("setDate", min_date);
    end.datepicker("setDate", max_date);
    set_current_dates();
  }
  window.onload = set_default_dates;
  $("#chosen_event").onchange = set_current_dates;

</script> 
```

再次，同样的行为发生了——日期选择器空白，没有警报被触发，即使表格更新得当。

我应该怎么做才能让日期选择器更新以反映选择下拉列表中的变化，反之亦然？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:11:53.150

通过**jquery**指定输入字段的值，您可以做到这一点。像下面

```
$('#_start_date').val(min_date);
$('#_end_date').val(max_date); 
```

这也将更新日期选择器选择下拉列表中的选定**日期**。

# ruby-on-rails - Ruby 中的二维数组

> ID：15531055
> 
> 赞同：-2
> 
> 时间：2013-03-20T17:48:15.860
> 
> 标签：ruby-on-rails, ruby, input

如何在Ruby中输入一个二维数组？如何在Ruby中初始化和声明数组？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T17:49:31.240

您声明一个二维数组

```
tda = [[ 1, 2 ], [3, 4], [5, 6]] 
```

或者你可以使用`Matrix`类

[http://www.ruby-doc.org/stdlib-1.9.3/libdoc/matrix/rdoc/Matrix.html](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/matrix/rdoc/Matrix.html)

# twitter-bootstrap - Bootstrap：电子商务响应式 - 正确的 HTML 设计模式

> ID：15531067
> 
> 赞同：0
> 
> 时间：2013-03-20T17:48:43.007
> 
> 标签：twitter-bootstrap, e-commerce, responsive-design

我想做的是一个带有 twitter 的 boostrap 的响应式产品列表......

假设我有 20 种产品的清单。

我希望它们跨越网站的宽度（默认为 940，不会更宽）......所以在这种（默认）情况下，我想连续显示 4 个产品......我知道这可能是像：

```
<div class="row">
    <div class="span3 product">.....</div>
    <div class="span3 product">.....</div>
    <div class="span3 product">.....</div>
    <div class="span3 product">.....</div>
</div>

<div class="row">
    <div class="span3 product">.....</div>
    <div class="span3 product">.....</div>
    <div class="span3 product">.....</div>
    <div class="span3 product">.....</div>
</div>

... 
```

一切都好。但我想做的是，如果有人缩小页面，这个产品会缩小......而且它也有效......

到目前为止，一切都很好

现在，当网站的宽度低于 640 时，我希望这样。我每行只显示 3 个产品...如果 <480，则每行只显示 1 个产品...

所以这就是事情变得混乱的地方......因为每行有4个产品，所以HTML标记我必须用JS重新排列DOM，对吧？所以它看起来像....

```
<div class="row">
     <div class="span4 product">.....</div>
     <div class="span4 product">.....</div>
     <div class="span4 product">.....</div>
 </div>

 <div class="row">
     <div class="span4 product">.....</div>
     <div class="span4 product">.....</div>
     <div class="span4 product">.....</div>
 </div>

 ... 
```

有没有更好的办法？

你能指点我一篇很好地讨论和解释这个话题的好文章吗？

* * *

编辑：

另一件事.. bootstrap 会自动为我在连续的跨度之间设置左右边距。如何在行之间应用相同的边距？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T11:27:46.987

您可以通过不使用 Bootstrap 的跨度来做到这一点。

只需要一个 span12 ，其中包含您向左浮动的所有项目。

将它们设置为在此级别具有 25% 的宽度。

然后使用媒体查询将它们设置为在最大宽度 640 处具有 33% 的宽度和在最大宽度 480 处具有 100% 的宽度。应该可以正常工作。

# ms-access - 访问 VBA 图像副本

> ID：15531068
> 
> 赞同：1
> 
> 时间：2013-03-20T17:48:43.200
> 
> 标签：ms-access, vba, clipboard

我的访问程序生成了一份报告。报告中的每条记录都有一张图片，该图片存储在外部并通过文件路径引用。我想为我的用户提供一种复制图片的方法，以便他们可以将它们粘贴到电子邮件或文档中。由于图片存储在外部，因此无法从右键单击上下文菜单中使用复制功能。有没有办法可以添加按钮并使用 VBA 从文件路径中获取图片并将其放置在剪贴板中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:33:06.187

好吧，我想出了一个体面的工作。我在这里找到了一些代码[http://access.mvps.org/access/api/api0042.htm](http://access.mvps.org/access/api/api0042.htm)。由于此代码旨在用于表单，因此我在报告中放置了一个按钮，用于打开表单并传入图像的文件路径。打开表单后，它将图像控件设置为传入的文件路径。然后它执行复制功能并自行关闭。这似乎工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:32:03.550

您可以在图像的双击事件中添加类似这样的内容：

```
Shell "RunDLL32.exe C:\Windows\System32\Shimgvw.dll,ImageView_Fullscreen " _
   & Me.FullPathtoImage 
```

这将在 Windows 图片和传真查看器中打开它，用户可以从中复制等等。

# c# - 从代码 C# 编辑样式 WPF

> ID：15531074
> 
> 赞同：1
> 
> 时间：2013-03-20T17:49:00.687
> 
> 标签：c#, wpf, resources, grid, styles

我有这种情况：

我在 Windows 中有一个框架。我有一个将从代码加载到框架中的页面。我在页面中有一个网格，其中包含代码中的行和列定义。

我想用按钮（从矩形创建）填充网格行和列。我写了这段代码：

适用于每个按钮的样式：

```
<Style TargetType="{x:Type Button}">
<Setter Property="Template">
    <Setter.Value>
        <ControlTemplate TargetType="{x:Type Button}">
            <Grid>
                <Rectangle x:Name="rect" Style="{DynamicResource rectangle_style}" Cursor="Hand">
                    <Rectangle.Fill>
                        <ImageBrush ImageSource="Attempts\image.jpg" Stretch="UniformToFill"/>
                    </Rectangle.Fill>
                </Rectangle>
                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" Content=""/>
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="IsFocused" Value="True"/>
                <Trigger Property="IsDefaulted" Value="True"/>
                <Trigger Property="IsMouseOver" Value="True"/>
                <Trigger Property="IsPressed" Value="True"/>
                <Trigger Property="IsEnabled" Value="False"/>
            </ControlTemplate.Triggers>
        </ControlTemplate>
    </Setter.Value>
</Setter> 
```

流行类代码：

```
 public void popolate(Grid grd)
    {

        for(int j = 1; j < 4; ++j)
        {

            for (int i = 1; i < 6;  ++i)
            {
                Button btn = new Button();
                btn.Margin= new Thickness(4,4,4,4);
                grd.Children.Add(btn);
                btn.SetValue(Grid.RowProperty, j);
                btn.SetValue(Grid.ColumnProperty, i);

            }

        } 
```

从主要呼叫课程：

公共部分类 MainWindow : Window {

```
 Page1 page = new Page1();
    Costruct costruttore = new Costruct();

    public MainWindow()
    {
        this.InitializeComponent();
                    costruttore.popolate(page.LayoutRoot);
                    frame_first.NavigationService.Navigate(page);

        // Insert code required on object creation below this point.
    }

} 
```

我想可以为代码后面的每个按钮在矩形中设置不同的图像（）。我如何为这种必要性编写代码？

请好好解释一下，因为我是 WPF 的负责人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T21:16:26.577

`Style`是一个单一的实例，如果你改变它，它`Style` `Image`会在所有使用`Style`.

在不创建自定义控件的情况下，我能想到的最简单的解决方案是使用`Buttons` `Tag`属性来传递图像文件名，`Tag`因此`DependancyProperty`它支持`DataBinding`.

例子：

```
 <Style TargetType="{x:Type Button}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type Button}">
                <Grid>
                    <Rectangle x:Name="rect" DataContext="{TemplateBinding Tag}" Style="{DynamicResource rectangle_style}" Cursor="Hand">
                        <Rectangle.Fill>
                            <ImageBrush ImageSource="{Binding}" Stretch="UniformToFill"/>
                        </Rectangle.Fill>
                    </Rectangle>
                    <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" Content=""/>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsFocused" Value="True"/>
                    <Trigger Property="IsDefaulted" Value="True"/>
                    <Trigger Property="IsMouseOver" Value="True"/>
                    <Trigger Property="IsPressed" Value="True"/>
                    <Trigger Property="IsEnabled" Value="False"/>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

代码：

```
for (int i = 1; i < 6;  ++i)
{
    Button btn = new Button();
    btn.Margin= new Thickness(4,4,4,4);
    grd.Children.Add(btn);
    btn.SetValue(Grid.RowProperty, j);
    btn.SetValue(Grid.ColumnProperty, i);
    btn.Tag = "The filename for this buttons image";
} 
```

# sql - 当一行被删除时，有什么方法可以减少 SQL 中的 IDENTITY 值？

> ID：15531077
> 
> 赞同：1
> 
> 时间：2013-03-20T17:49:13.873
> 
> 标签：sql, sql-server-2008

我正在为一家移动公司做一个项目（可以出售第二次使用的手机）....

我创建了一个像

```
CREATE TABLE mobileDetails  
(  
       mobileID           INT IDENTITY PRIMARY KEY,  
       mobileModel        VARCHAR(20),  
       price              VARCHAR(20),  
) 
```

如果假设管理员登录并添加任何新手机，则新添加的手机将是最后一个`mobileID`
现有的 mobileID 值 + 1，因为我们已将. （我已经完成了） `mobileID``IDENTITY`

但是如果假设最后一个 MOBILE`mobileID`是 4 并且我正在从数据库中删除它....

之后，如果假设我添加了一个新手机，那么数据库应该将新添加的手机的 ID 设为 4，而不是给我 5 .....

有什么想法可以克服这个吗？

真的很抱歉我不成熟的英语，并提前感谢您的帮助:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:56:26.893

要检查表上的当前种子信息，请使用：

```
DBCC CHECKIDENT ('table_name', NORESEED) 
```

例如，如果您删除最后一条记录，种子将不会保持一致性：

```
Checking identity information: current identity value '8', current column value '7'.
DBCC execution completed. If DBCC printed error messages, contact your system administrator.
```

然后您可以使用以下查询对其重新播种，然后如果插入新记录，它将从已删除的记录开始播种：

```
DBCC CHECKIDENT ('table_name', RESEED, new_reseed_value) 
```

对于您的情况，我创建了与您相同的表并插入一些记录：

```
 mobileID    mobileModel price
1   aaa 1111
2   bbbb    2222
4   aaa 1111
5   bbbb    2222
6   aaa 1111
7   bbbb    2222
8         cccc      3333 
```

然后删除最后一条记录：

```
 mobileID    mobileModel price
1   aaa 1111
2   bbbb    2222
4   aaa 1111
5   bbbb    2222
6   aaa 1111
7   bbbb    2222要使下一条记录从 8 开始，我可以运行：

```
DBCC CHECKIDENT ('mobileDetails', RESEED,7) 
```

 然后插入3条新记录： 

```
 mobileID    mobileModel price
1   aaa 1111
2   bbbb    2222
4   aaa 1111
5   bbbb    2222
6   aaa 1111
7   bbbb    2222
8   aaa 1111
9   bbbb    2222
10  cccc    33333 
```

            回答 #2

赞同：0

时间：2013-03-20T18:39:55.907

```
DBCC CHECKIDENT ("mobileDetails", RESEED, select max(mobibleID) from mobileDetails);
```

            回答 #3

赞同：0

时间：2020-03-06T15:06:58.220

如果您真的非常确定删除的行是最后一行创建的，`mobileDetails`请执行以下操作：

```
DECLARE @NewSeed AS INT;

SET @NewSeed = IDENT_CURRENT('mobileDetails') - 1;

DBCC CHECKIDENT ('mobileDetails', RESEED, @NewSeed); 
```

以下是有关以下内容的更多信息`IDENT_CURRENT`：[SQL Server 2008 版本](https://docs.microsoft.com/en-us/previous-versions/sql/sql-server-2008/ms175098(v=sql.100))和[当前版本](https://docs.microsoft.com/en-us/sql/t-sql/functions/ident-current-transact-sql)

以下是有关以下内容的更多信息`DBCC CHECKIDENT`：[SQL Server 2008 版本](https://docs.microsoft.com/en-us/previous-versions/sql/sql-server-2008/ms176057(v=sql.100))和[当前版本](https://docs.microsoft.com/en-us/sql/t-sql/database-console-commands/dbcc-checkident-transact-sql)

```

# python - 获取数组中非唯一项的索引

> ID：15531079
> 
> 赞同：0
> 
> 时间：2013-03-20T17:49:18.040
> 
> 标签：python, arrays, numpy, indexing

给定一个具有 的整数数组`I`，`0 <= I[j] < 1000`具有非唯一的整数值`I[j]`，以及一个具有 的“值”数组`V`，`V.shape == (1000, )`我如何创建一个`R`具有`R.shape == I.shape`这样的数组，`R[j] == V[I[j]]`如果`I[j]`在 中是唯一的`I`，并且`R[j] == np.nan`如果 的值在 中`I[j]`出现多次`I`？

**编辑** 例如，给定`I = np.array([1, 2, 1, 3, 2], dtype=int)`，结果应该是`V = array([nan, nan, nan, V[3], nan])`，因为`3`是 的唯一唯一元素`I`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:53:11.123

```
i = np.array([1, 2, 1, 3, 2], dtype=int)
v = np.random.rand(1000)

r = np.empty(shape=i.shape, dtype=v.dtype)
r.fill(np.nan)

unique, _ = np.unique(i, return_inverse=True)
counts = np.bincount(_)
r[unique[counts == 1]] = v[unique[counts == 1]]

>>> r
array([       nan,        nan,        nan,  0.5650245,        nan]) 
```

# ios - 断点不显示导致“发送到已释放实例的消息”的代码行

> ID：15531086
> 
> 赞同：0
> 
> 时间：2013-03-20T17:49:55.887
> 
> 标签：ios, objective-c, xcode

我遇到了一个很难找到/修复的错误。错误是`*** -[NSConcreteData release]: message sent to deallocated instance 0xdee4440`

我按照这篇文章在我的应用程序中启用了僵尸：[如何在 Xcode 4 中设置 NSZombieEnabled？](https://stackoverflow.com/questions/2190227/how-do-i-set-up-nszombieenabled-in-xcode-4)

我设置了“所有异常”断点。以及“malloc_error_break”和“-[_NSZombie methodSignatureForSelector:]”符号断点。

我的堆栈跟踪看起来像：

```
0 ___forwarding___
1 _CF_forwarding_prep_0
2 objc_release 
```

反正有没有生成更好的堆栈跟踪？还是停在罪魁祸首的代码行上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:21:51.733

在高低搜索之后，我发现了我的问题。

在我的对象中，我有 2 个 NSData 保留属性。在我的 dealloc 方法中，我写`[instance-variable dealloc]`的不是`[instance-variable release]`.

# python - 如何在python中只选择和绘制特定的数组？

> ID：15531088
> 
> 赞同：0
> 
> 时间：2013-03-20T17:50:00.573
> 
> 标签：python, numpy, matplotlib

这是我正在使用的一些代码的示例：

```
import numpy as np
import numpy.linalg as linalg

A = np.random.random((10,10))
eigenValues,eigenVectors = linalg.eig(A)

idx = eigenValues.argsort()   
eigenValues = eigenValues[idx]
eigenVectors = eigenVectors[:,idx] 
```

我要做的是仅绘制一组多于五个特征向量中的五个最小特征向量，然后绘制它们。那么如何选择前五个特征向量，然后在 matplotlib 中绘制它们呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T17:54:07.467

以下将选择前五个特征向量（假设您已经按照示例进行了排序）：

```
eigenVectors[:,:5] 
```

至于如何最好地绘制一个十维向量，我不确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-28T14:35:59.143

对于未来的读者，这里有一个代码示例可以做到这一点：

```
from pylab import *
N = 10
k = 5
L = 1

x = linspace(-L, L, N)
H = random((N,N))
ls, vs = eig(H)

#find and plot k lowest eigenvalues and eigenvectors
min_values_indices = argsort(ls)[0:k]
for i in min_values_indices:
    plot(x, vs[:,i])

show() 
```

顺便说一句 - 我会将这个问题的主题更改为提供更多信息的内容（例如“numpy - 找到最低 k 特征值和特征向量”）

# c# - C# 表单列表框

> ID：15531089
> 
> 赞同：1
> 
> 时间：2013-03-20T17:50:04.560
> 
> 标签：c#, tree, listbox, linked-list

![在此处输入图像描述][1] 您好，我正在尝试将来自两个文本框的信息显示到两个单独的列表框中；一个显示艺术家姓名，一个显示成员数量。目前，当我单击“添加艺术家”按钮时会发生这种情况：

如您所见，仅显示艺术家姓名，这是由于艺术家类中的这段代码：

这是我的表单类中的代码，它将艺术家姓名显示到 listbox1 中。

我试过 listBox2.Items.Add(Members); 和 listBox2.Items.Add(artist.Members); 为了尝试让它工作，但是他们都找不到成员。我发现的唯一方法是使用以下代码，但是 foreach 然后会出现错误消息：

！[在此处输入图片描述][2] 我真的不知道从哪里开始，感谢您的帮助！（我在下面插入了我的 Artist 类和 Form 类的代码，以防有任何帮助）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:11:45.947

你可能想要：

```
ArtistTree.InOrderListBox 
```

返回 a`List<Artist>`而不是 a `List<string>`。这样你的循环：

```
foreach (Artist artist in ListBoxName)
{ 
     listBox1.Items.Add(artist);
     listBox2.Items.Add(artist.Members);
} 
```

应该管用。

现在你得到一个错误，因为 ListBoxName 被声明为 a`List<string>`但你试图迭代它（使用 foreach）并说 List 中的每个项目都是一个艺术家，并且你之前说过每个元素的类型list 是您声明中的字符串

```
List<string> ListBoxName = new List<string>(); 
```

因此，您会收到编译错误，因为您没有从 Artist 到字符串的强制转换，即您不能这样做：

```
Artist a = new Artist();
string castMe = (string) a; 
```

调用 ToString() 与强制转换不同。

HTH，弥敦道

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:13:53.203

修改您的`ArtistTree.InOrderListBox`方法，使其返回（或填充）一个`Artist`s 列表而不是字符串 ( `Artist.Name`)。也不需要方法的参数为 ba`ref`参数。一个普通的按值参数完成这项工作，因为该方法不需要更改*参数本身*，而是更改参数的*内容*。

```
List<Artist> artistSorted = new List<Artist>();
ArtistTree.InOrderListBox(artistSorted);

ListBoxNames.DataSource = artistsSorted;
ListBoxNames.DisplayMember = "Name";

ListBoxNames.DataSource = artistsSorted;
ListBoxNames.DisplayMember = "Members"; 
```

目前，列表中只有艺术家的姓名`ListBoxName`，这是一个字符串值列表。您无法`Members`从名称列表中提取属性！你必须改变`ArtistTree.InOrderListBox`方法。

# coldfusion - cfquery cachedwithin 并不总是在 CF 10 中工作

> ID：15531091
> 
> 赞同：2
> 
> 时间：2013-03-20T17:50:11.557
> 
> 标签：coldfusion, coldfusion-9, coldfusion-10

ColdFusion 10，更新 8。在 Windows 2008 R2，IIS 7.5，Java 7，更新 17 上运行。Microsoft SQL Server 2005。缓存查询的最大数量：1000

这是我来自 cffunction 的查询：

```
<cfquery name="local.qryDOTCensusPubSByCCStAlpha" datasource="#variables.dsn#" cachedwithin="#CreateTimeSpan(0, 1, 0, 0)#">
SELECT
    dot.CENSUS_NUM, dot.PHY_CITY, dot.[NAME]
FROM
    tblDOTCensusPub dot
WHERE
    dot.PHY_NATN = <cfqueryparam value="#arguments.PHY_NATN#" cfsqltype="CF_SQL_VARCHAR">
    AND dot.PHY_ST = <cfqueryparam value="#arguments.PHY_ST#" cfsqltype="CF_SQL_VARCHAR">
    AND dot.cUseForTD = 'Y'
    AND NOT EXISTS (SELECT * FROM tblDOTDisabled WHERE CENSUS_NUM = dot.CENSUS_NUM)
<cfif arguments.vcAStart EQ arguments.vcAEnd>
    AND LEFT(dot.[NAME], 1) = <cfqueryparam value="#arguments.vcAStart#" cfsqltype="CF_SQL_CHAR">
<cfelseif NOT (arguments.vcAStart EQ "0" AND arguments.vcAEnd EQ "Z")>
    AND LEFT(dot.[NAME], 1) >= <cfqueryparam value="#arguments.vcAStart#" cfsqltype="CF_SQL_CHAR">
    AND LEFT(dot.[NAME], 1) <= <cfqueryparam value="#arguments.vcAEnd#" cfsqltype="CF_SQL_CHAR">
</cfif>
ORDER BY
    dot.[NAME]
</cfquery> 
```

此查询用于在 ColdFusion 9.01 中使用 cachedwithin 参数。在 ColdFusion 10 中，是否缓存是随机的。大多数时候它不会缓存。起初我认为也许“AND NOT EXISTS (SELECT * FROM tblDOTDisabled WHERE CENSUS_NUM = dot.CENSUS_NUM)”可能会使查询免于缓存，因为该子查询的结果可能会有所不同。但是，即使我删除了该子句，查询仍然拒绝缓存。

我有两台正在使用的服务器；生产和开发。

生产服务器可能会获得足够的命中以将查询从缓存中清除（但可能性不大）。

开发服务器几乎没有命中，所以这个查询应该被缓存。

关于为什么此查询可能不会在 CF 10 中缓存的任何想法？

**更新：**
以下是 ColdFusion 服务器上调试输出的片段：

在这个问题中查询：

```
local.qryDOTCensusPubSByCCStAlpha (Datasource=tdDOTCensusPub, Time=62ms, Records=3962) in ~~~~hidden~~~~\cfc\DOTCensusPub.cfc @ 12:28:41.041 
```

同一页面上成功缓存的另一个查询：

```
local.qryTop5JobPosters (Datasource=truckdriver, Time=16ms, Records=5, Cached Query) in ~~~~hidden~~~~\cfc\tdJobs.cfc @ 12:28:41.041 
```

请注意，如果查询被缓存，调试输出将在调试输出中包含“缓存查询”。

另外，我确信参数没有改变。这是我用来重新加载页面的查询字符串：

```
?PHY_NATN=US&PHY_ST=MN&vcAStart=M&vcAEnd=M&SR=1&MT=2 
```

传递给 的所有参数`CFFunction`都来自 URL。我只是重新加载页面，并且应该在第一页加载后缓存查询。

**更新：**

我刚刚注意到一些非常奇怪的行为。我修改了“local.qryDOTCensusPubSByCCStAlpha”查询（也有问题更新），当开始和结束字母是同一个字母时，效率会更高一些。当我刷新页面时，调试部分显示了旧查询。我必须按 Ctrl-F5 才能让调试部分显示更新后的查询。当我再次按下 Ctrl-F5 时，它显示查询已被缓存。所以我现在认为 CF 告诉浏览器页面上没有任何变化（即使调试部分中的查询 DID 发生了变化），因此浏览器显示缓存页面，包括 OLD 调试输出。使用 Firebug 似乎可以验证这一点，因为页面返回“304 Not Modified”状态，即使调试部分应该已更改。

其他人可以验证这一点吗？只需创建一个简单的 cfm 模板，该模板调用执行带有 cachedwithin 参数的查询的 CFC 函数，加载页面（记下调试信息），更改 cfc 中的查询并重新加载页面。调试部分中的查询是否随着正常的页面重新加载而改变？Ctrl-F5会改变吗？

我不认为任何包含调试信息的页面都应该使用 304 状态。时间和其他调试信息通常会过时。

注意：Ctrl-F5 强制浏览器重新加载页面和所有页面对象（图像、javascript 等）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T12:00:26.883

虽然我不确定，但你能说它没有超过限制缓存查询的最大数量：1000

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T00:41:41.313

实际上，我以前遇到过与此问题相反的情况。我们有一个项目会缓存数据库结构并在更新结构时抛出未定义的错误。我们的问题是这样的：

```
Select *
From tbl_data 
```

我们***防止***缓存的方法是：

```
Select t.*
From tbl_data AS t 
```

我并不是说这是问题的原因，我只是说它可能无法正常工作，因为您正在使用`dot.`and`Select *`方法。尝试删除`dot.`别名或将您的别名更新`SELECT *`为类似`SELECT t.*`

以下是有关此问题的更多信息：

[http://www.bennadel.com/blog/194-ColdFusion-Query-Error-Value-Can-Not-Be-Converted-To-Requested-Type.htm](http://www.bennadel.com/blog/194-ColdFusion-Query-Error-Value-Can-Not-Be-Converted-To-Requested-Type.htm)

# vba - 将附件保存到文件夹并重命名

> ID：15531093
> 
> 赞同：44
> 
> 时间：2013-03-20T17:50:19.690
> 
> 标签：vba, outlook, attachment

我正在尝试在 Outlook 中获取 VBA 宏，它将电子邮件的附件保存到特定文件夹并将*收到*的日期添加到文件名中。

我的谷歌搜索让我走到了这一步：

```
Public Sub saveAttachtoDisk (itm As Outlook.MailItem) 
    Dim objAtt As Outlook.Attachment 
    Dim saveFolder As String
    Dim dateFormat As String
    saveFolder = "C:\Temp\"
    dateFormat = Format(Now, "yyyy-mm-dd H-mm")

    For Each objAtt In itm.Attachments
        objAtt.SaveAsFile saveFolder & "\" & dateFormat & objAtt.DisplayName
        Set objAtt = Nothing
    Next 
End Sub 
```

第一个明显的事情是它将当前时间应用于文件名而不是接收时间，但我似乎无法更改它。我的理论是 Outlook.Attachment 没有`ReceivedTime`，并且必须引用电子邮件本身。

其次，这似乎根本不起作用，哈！它在我开始修补的第一天就起作用了，但在那之后它就停止了保存文件。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-03-20T18:10:46.693

这是我的保存附件脚本。您选择要从中保存附件的所有消息，它将在那里保存一个副本。它还将文本添加到消息正文中，指示附件的保存位置。您可以轻松更改文件夹名称以包含日期，但您需要在开始保存文件之前确保该文件夹存在。

```
Public Sub SaveAttachments()
Dim objOL As Outlook.Application
Dim objMsg As Outlook.MailItem 'Object
Dim objAttachments As Outlook.Attachments
Dim objSelection As Outlook.Selection
Dim i As Long
Dim lngCount As Long
Dim strFile As String
Dim strFolderpath As String
Dim strDeletedFiles As String

' Get the path to your My Documents folder
strFolderpath = CreateObject("WScript.Shell").SpecialFolders(16)
On Error Resume Next

' Instantiate an Outlook Application object.
Set objOL = CreateObject("Outlook.Application")

' Get the collection of selected objects.
Set objSelection = objOL.ActiveExplorer.Selection

' Set the Attachment folder.
strFolderpath = strFolderpath & "\Attachments\"

' Check each selected item for attachments. If attachments exist,
' save them to the strFolderPath folder and strip them from the item.
For Each objMsg In objSelection

    ' This code only strips attachments from mail items.
    ' If objMsg.class=olMail Then
    ' Get the Attachments collection of the item.
    Set objAttachments = objMsg.Attachments
    lngCount = objAttachments.Count
    strDeletedFiles = ""

    If lngCount > 0 Then

        ' We need to use a count down loop for removing items
        ' from a collection. Otherwise, the loop counter gets
        ' confused and only every other item is removed.

        For i = lngCount To 1 Step -1

            ' Save attachment before deleting from item.
            ' Get the file name.
            strFile = objAttachments.Item(i).FileName

            ' Combine with the path to the Temp folder.
            strFile = strFolderpath & strFile

            ' Save the attachment as a file.
            objAttachments.Item(i).SaveAsFile strFile

            ' Delete the attachment.
            objAttachments.Item(i).Delete

            'write the save as path to a string to add to the message
            'check for html and use html tags in link
            If objMsg.BodyFormat <> olFormatHTML Then
                strDeletedFiles = strDeletedFiles & vbCrLf & "<file://" & strFile & ">"
            Else
                strDeletedFiles = strDeletedFiles & "<br>" & "<a href='file://" & _
                strFile & "'>" & strFile & "</a>"
            End If

            'Use the MsgBox command to troubleshoot. Remove it from the final code.
            'MsgBox strDeletedFiles

        Next i

        ' Adds the filename string to the message body and save it
        ' Check for HTML body
        If objMsg.BodyFormat <> olFormatHTML Then
            objMsg.Body = vbCrLf & "The file(s) were saved to " & strDeletedFiles & vbCrLf & objMsg.Body
        Else
            objMsg.HTMLBody = "<p>" & "The file(s) were saved to " & strDeletedFiles & "</p>" & objMsg.HTMLBody
        End If
        objMsg.Save
    End If
Next

ExitSub:

Set objAttachments = Nothing
Set objMsg = Nothing
Set objSelection = Nothing
Set objOL = Nothing
End Sub 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-20T18:43:34.547

查看`ReceivedTime`属性

[http://msdn.microsoft.com/en-us/library/office/aa171873(v=office.11​​).aspx](http://msdn.microsoft.com/en-us/library/office/aa171873(v=office.11).aspx)

您在*SaveAs File*行`\`的末尾添加了另一个。可能是个问题。在添加路径分隔符之前先进行测试。`C:\Temp\`

 *```
dateFormat = Format(itm.ReceivedTime, "yyyy-mm-dd H-mm")  
saveFolder = "C:\Temp" 
```

你还没有设置`objAtt`所以不需要“ `Set objAtt = Nothing`”。如果有的话，它就在`End Sub`不在循环之前。

* * *

```
Public Sub saveAttachtoDisk (itm As Outlook.MailItem) 
    Dim objAtt As Outlook.Attachment 
    Dim saveFolder As String Dim dateFormat
    dateFormat = Format(itm.ReceivedTime, "yyyy-mm-dd H-mm")  saveFolder = "C:\Temp"
    For Each objAtt In itm.Attachments
        objAtt.SaveAsFile saveFolder & "\" & dateFormat & objAtt.DisplayName
    Next
End Sub 
```

回复：我开始修修补补的第一天它就起作用了，但在那之后它就停止了保存文件。

> 这通常是由于安全设置。这是一个“陷阱”，为初次使用的用户设置了允许宏然后将其删除。 [http://www.slipstick.com/outlook-developer/how-to-use-outlooks-vba-editor/](http://www.slipstick.com/outlook-developer/how-to-use-outlooks-vba-editor/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-07-25T16:02:51.473

```
Public Sub Extract_Outlook_Email_Attachments()

Dim OutlookOpened As Boolean
Dim outApp As Outlook.Application
Dim outNs As Outlook.Namespace
Dim outFolder As Outlook.MAPIFolder
Dim outAttachment As Outlook.Attachment
Dim outItem As Object
Dim saveFolder As String
Dim outMailItem As Outlook.MailItem
Dim inputDate As String, subjectFilter As String

saveFolder = "Y:\Wingman" ' THIS IS WHERE YOU WANT TO SAVE THE ATTACHMENT TO

If Right(saveFolder, 1) <> "\" Then saveFolder = saveFolder & "\"

subjectFilter = ("Daily Operations Custom All Req Statuses Report") ' THIS IS WHERE YOU PLACE THE EMAIL SUBJECT FOR THE CODE TO FIND

OutlookOpened = False
On Error Resume Next
Set outApp = GetObject(, "Outlook.Application")
If Err.Number <> 0 Then
    Set outApp = New Outlook.Application
    OutlookOpened = True
End If
On Error GoTo 0

If outApp Is Nothing Then
    MsgBox "Cannot start Outlook.", vbExclamation
    Exit Sub
End If

Set outNs = outApp.GetNamespace("MAPI")
Set outFolder = outNs.GetDefaultFolder(olFolderInbox)

If Not outFolder Is Nothing Then
    For Each outItem In outFolder.Items
        If outItem.Class = Outlook.OlObjectClass.olMail Then
            Set outMailItem = outItem
                If InStr(1, outMailItem.Subject, subjectFilter) > 0 Then 'removed the quotes around subjectFilter
                    For Each outAttachment In outMailItem.Attachments
                    outAttachment.SaveAsFile saveFolder & outAttachment.filename

                    Set outAttachment = Nothing

                    Next
                End If
        End If
    Next
End If

If OutlookOpened Then outApp.Quit

Set outApp = Nothing

End Sub 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-06-14T11:21:50.507

添加了简单的代码以使用可读的日期时间戳保存。

使用**sync2pst**将 Outlook 中的所有数据与所有设备同步，如下所示：

1.  您只需要购买 1 个许可证：将您的 pst 文件保存在网络上的一台计算机上（我们称这台计算机为“服务器”）。
2.  创建计划任务，将“服务器”上的 pst 文件与所有设备上的所有 pst 文件同步，无论哪个设备首先下载了电子邮件（您需要一些 dos 编程知识来绕过在同步时打开的 pst 文件） .
3.  将所有附件保存在所有设备上位于同一位置的同一 skydrive 文件夹中（例如 e:\skydrive\attachments）
4.  在所有设备上使用以下代码保存附件（如上所述更改路径）
5.  只为您的所有帐户使用**一个 PST 文件**，创建文件夹、子文件夹等等......

6.  在 VBA 中：参考' `microsoft scripting runtime`'额外/参考...'

7.  这是代码

```
Private Sub Application_NewMail()
SaveAttachments
End Sub

Public Sub SaveAttachments()
Dim objOL As Outlook.Application
Dim objMsg As Outlook.MailItem 'Object
Dim objAttachments As Outlook.Attachments
Dim objSelection As Outlook.Selection
Dim i As Long
Dim lngCount As Long
Dim strFile As String
Dim strFolderpath As String
Dim strDeletedFiles As String
Dim fs As FileSystemObject

' Get the path to your My Documents folder
strFolderpath = CreateObject("WScript.Shell").SpecialFolders(16)
On Error Resume Next

' Instantiate an Outlook Application object.
Set objOL = CreateObject("Outlook.Application")

' Get the collection of selected objects.
Set objSelection = objOL.ActiveExplorer.Selection

' Set the Attachment folder.
strFolderpath = "F:\SkyDrive\Attachments\"

' Check each selected item for attachments. If attachments exist,
' save them to the strFolderPath folder and strip them from the item.
For Each objMsg In objSelection

    ' This code only strips attachments from mail items.
    ' If objMsg.class=olMail Then
    ' Get the Attachments collection of the item.
    Set objAttachments = objMsg.Attachments
    lngCount = objAttachments.Count
    strDeletedFiles = ""

    If lngCount > 0 Then

        ' We need to use a count down loop for removing items
        ' from a collection. Otherwise, the loop counter gets
        ' confused and only every other item is removed.
        Set fs = New FileSystemObject

        For i = lngCount To 1 Step -1

            ' Save attachment before deleting from item.
            ' Get the file name.
            strFile = Left(objAttachments.Item(i).FileName, Len(objAttachments.Item(i).FileName) - 4) + "_" + Right("00" + Trim(Str$(Day(Now))), 2) + "_" + Right("00" + Trim(Str$(Month(Now))), 2) + "_" + Right("0000" + Trim(Str$(Year(Now))), 4) + "_" + Right("00" + Trim(Str$(Hour(Now))), 2) + "_" + Right("00" + Trim(Str$(Minute(Now))), 2) + "_" + Right("00" + Trim(Str$(Second(Now))), 2) + Right((objAttachments.Item(i).FileName), 4)

            ' Combine with the path to the Temp folder.
            strFile = strFolderpath & strFile

            ' Save the attachment as a file.
            objAttachments.Item(i).SaveAsFile strFile

            ' Delete the attachment.
            objAttachments.Item(i).Delete

            'write the save as path to a string to add to the message
            'check for html and use html tags in link
            If objMsg.BodyFormat <> olFormatHTML Then
                strDeletedFiles = strDeletedFiles & vbCrLf & "<file://" & strFile & ">"
            Else
                strDeletedFiles = strDeletedFiles & "<br>" & "<a href='file://" & _
                strFile & "'>" & strFile & "</a>"
            End If

            'Use the MsgBox command to troubleshoot. Remove it from the final code.
            'MsgBox strDeletedFiles

        Next i

        ' Adds the filename string to the message body and save it
        ' Check for HTML body
        If objMsg.BodyFormat <> olFormatHTML Then
            objMsg.Body = vbCrLf & "The file(s) were saved to " & strDeletedFiles & vbCrLf & objMsg.Body
        Else
            objMsg.HTMLBody = "<p>" & "The file(s) were saved to " & strDeletedFiles & "</p>" & objMsg.HTMLBody
        End If

        objMsg.Save
    End If
Next

ExitSub:

Set objAttachments = Nothing
Set objMsg = Nothing
Set objSelection = Nothing
Set objOL = Nothing
End Sub 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-26T00:26:13.593

实际上，我在发布后不久就解决了这个问题，但未能发布我的解决方案。老实说，我不记得了。但是，当我接到一个面临同样挑战的新项目时，我不得不重新审视这个任务。

我使用 Outlook.MailItem 的 ReceivedTime 属性来获取时间戳，我能够将其用作每个文件的唯一标识符，因此它们不会相互覆盖。

```
Public Sub saveAttachtoDisk(itm As Outlook.MailItem)
    Dim objAtt As Outlook.Attachment
    Dim saveFolder As String
        saveFolder = "C:\PathToDirectory\"
    Dim dateFormat As String
        dateFormat = Format(itm.ReceivedTime, "yyyy-mm-dd Hmm ")
    For Each objAtt In itm.Attachments
        objAtt.SaveAsFile saveFolder & "\" & dateFormat & objAtt.DisplayName
    Next
End Sub 
```

非常感谢其他解决方案，其中许多超越了:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-03-30T08:58:39.023

您的问题有 2 个任务要执行。首先将电子邮件附件提取到文件夹并使用特定名称保存或重命名。

如果您的搜索可以拆分为 2 个搜索，您将获得更多点击。我可以参考一页解释如何将附件保存到系统文件夹<[链接以将附件保存到文件夹的页面](http://officetricks.com/save-outlook-mail-attachment-to-local-folder/)>。

如果您发现以特定名称保存附件，请发布任何页面或代码。*

# html - 当高度设置为 100% 时，Div 缩放到内容

> ID：15531097
> 
> 赞同：1
> 
> 时间：2013-03-20T17:50:33.333
> 
> 标签：html, css

我有三个嵌套的 div，内部的 div 具有固定的高度，中间的用于填充外部的，外部的用于容纳底部的页脚。但是中间的 div 似乎只和内部的一样高，这是我不想要的。

我将问题简化为以下问题，我认为这是一个最小的例子。我不想更改外部或内部 div 的高度属性，因为这会干扰布局的其余部分。有没有办法通过改变中间 div 的属性来做我想做的事？

这是html：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">
<html>
    <head>
        <link type="text/css" rel="stylesheet" href="style.css" />
    </head> 

    <body>
        <div id="outer">
            <div id="middle">
                <div id="inner"></div> 
            </div>
        </div>
    </body>
</html> 
```

和CSS：

```
html{height:100%;}
body{height:100%;}
#outer{height: auto; min-height: 100%;}
#middle{height: 100%;}
#inner{height:500px;} 
```

您可以检查`#middle`div 的高度是否为 500，而我希望它填充`#outer`div。

我是 CSS 的新手，几乎所有的代码都是从不同的教程和/或反复试验中复制而来的。所以，如果我做错了/愚蠢的事情，请原谅我。

**编辑：**我不明白为什么，但似乎删除 doctype 声明会使问题消失。因此，我更改了代码示例以包含声明。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:04:28.667

您的错误是将 'body' 和 'html' 类设置为 height: 100% （什么都不做）。相反，我将您的外部 div 设置为 100% 高度。

```
<html>
<head>
<style type="text/css">
div {border:2px solid black;}
div div {border-color: blue;}
div div div {border-color: red;}
#outer{height: 100%; min-height: 100%;}
#middle{height: 100%;}
#inner{height:500px;}
</style>
</head> 

<body>
    <div id="outer">
        <div id="middle">
            <div id="inner"></div> 
        </div>
    </div>
</body>
</html> 
```

如果您不知道如何在混合中获取页脚，我也给了您一个示例：

```
<html>
    <head>
<style type="text/css">
div {border:2px solid black;}
div div {border-color: blue;}
div div div {border-color: red;}
#outer{height: 100%; min-height: 100%; position: relative;}
#middle{height: 100%;}
#inner{height:500px;}
#footer{height:100px;width:100%;position:absolute;bottom:0;}
</style>
    </head> 

    <body>
        <div id="outer">
            <div id="middle">
                <div id="inner"></div> 
            </div>
            <div id="footer">This is the footer</div>
        </div>
    </body>
</html> 
```

# c# - 将数据从一个富文本框传递到另一个富文本框并按降序排序

> ID：15531099
> 
> 赞同：0
> 
> 时间：2013-03-20T17:50:42.380
> 
> 标签：c#, winforms, richtextbox

我有一个注册学生分数的小程序。标记以`richtextbox1`这种格式添加到 a

```
ID         name         sname         DOB         average 
```

当填充文本框一时，我想按最高平均成绩对这些数据进行排序并将其显示在`richtextbox2`

我知道要将数据从一个控件传递到另一个控件，我可以执行以下操作

```
richtextbox2.text = rixhtextbox1.text 
```

但是我发现很难对数据进行排序我应该使用什么方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:16:38.617

如果您对填充richtextbox1 的对象进行排序，而不是尝试拆分和解析richtextbox1 的文本，那会更好。

假设你有一个学生名单

```
List<Student> studentList = new List<Student>(); 
```

该列表可以使用类似于以下内容进行排序：

```
StringBuilder sb = new StringBuilder();
studentList.OrderByDescending(x=>x.Average)
    .ToList()
    .ForEach(x=> sb.Append(String.Format("{0} {1} {2} {3} {4}" + Environment.NewLine,x.Id,x.Name,x.Sname,x.DOB,x.Average)));

richTextBox2.Text = sb.ToString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:47:03.967

我会将这些数据放在更好的控件中，例如列表视图或数据网格视图。您可以通过隐藏列标题、更改行边框颜色（或完全隐藏它们）以及更改选择模式来使其看起来像一个文本框。这样，您可以使用以下方式使用内置排序：

```
colAverage.SortMode = DataGridViewColumnSortMode.Descending; 
```

或者，如果您不喜欢使用富文本框，您将需要从该文本框中获取数据，将其放入可排序的集合（数组、列表、字典）中，对其进行排序，然后使用填充第二个文本框。

# angularjs - 许多服务注册在另一个不依赖于它们的服务中？（延迟加载）

> ID：15531103
> 
> 赞同：2
> 
> 时间：2013-03-20T17:50:56.827
> 
> 标签：angularjs, lazy-loading, lazy-initialization, angularjs-service

我想要一个服务员`FeatureRegistry`，所有的功能都在他那里注册。注册功能依赖于 FeatureRegistry（反之亦然）。

我现在的做法是：

```
angular.module('app').factory('FeatureRegistry', function(){
  var FeatureRegistry = new Object();
  FeatureRegistry.features = new Array(); 
  FeatureRegistry.registerFeature = function(feature){
    FeatureRegistry.features.push(feature);
  }
  return FeatureRegistry;
}

angular.module('app').factory('Feature', function(FeatureRegistry){
  var Feature = new Object();
  FeatureRegistry.registerFeature(Feature);
  return Feature;
} 
```

但该功能似乎从未注册过。如果我在 FeatureRegistry 中查找 features.

我用 FeatureController 对其进行了测试：

```
angular.module('app').controller('FeatureController', 
  function($scope, FeatureRegistry){
  $scope.features = FeatureRegistry.features;
  return this; // not sure if a return is necessary
} 
```

* * *

**编辑：**
所以现在我知道服务是延迟加载的，只有在注入时才会实例化。但这对于我想要实现的应用程序是违反直觉的，因为这些功能应该位于单独的文件和文件夹中，并且我不想在`FeatureRegistry`任何时候更改添加新功能的依赖关系。

* * *

编辑2：

现在我制作了一个图表来显示结构的外观： ![在此处输入图像描述](../Images/78f857ced3add77e483fd08b9f1eb442.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:22:00.827

你需要在`Feature`某处注入，否则它不会被实例化。例如，

```
app.controller('MainCtrl', function($scope, FeatureRegistry, Feature) { 
```

[普朗克](http://plnkr.co/edit/tSq22c3mBtQLxLbI0bVh?p=preview)

# jquery-ui - jQuery UI：可拖动到嵌套可排序不会从中删除样式

> ID：15531104
> 
> 赞同：1
> 
> 时间：2013-03-20T17:50:58.933
> 
> 标签：jquery-ui, jquery-ui-sortable, jquery-ui-draggable

在这个小提琴（jsfiddle.net/s6s4R/12/）中，我有一些 Draggables 和一个 Sortable 内的 Sortable 可拖动的与可排序的（.region）连接

在可排序对象之间进行排序似乎工作正常，但是当我将可拖动对象拖动到其中一个可排序对象中时，当可排序对象接收可拖动对象时，不会删除由 Draggable 装饰的临时样式，从而导致放置的可拖动对象在事物之间绝对定位。

这是默认行为、错误还是一些错误配置？

提前致谢，

托马斯

# qt - 使用 c++ 和 qt 时的重音问题

> ID：15531105
> 
> 赞同：2
> 
> 时间：2013-03-20T17:51:03.607
> 
> 标签：qt, text, character-encoding, utf

我正在用西班牙语编写一个程序。我想告诉用户文件已加载。在西班牙语中是：

```
ui->teLog->append("Se cargó el archivo: " + filename); 
```

然而，西班牙语部分被输出为：

> Se cargÃ³ el 档案：

我知道问题出在编码上（我想我需要告诉程序这是 UTF8）。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T18:29:27.087

普通的 QString 构造函数假定您正在编写 ASCII 字符。如果您`QString::fromUtf8()`在这种情况下使用它应该可以工作：

```
ui->teLog->append(QString::fromUtf8("Se cargó el archivo: ") + filename); 
```

还：

```
QTextCodec::setCodecForCStrings( QTextCodec::codecForName("utf8") ); 
```

（有关更多信息，请参阅[此答案](https://stackoverflow.com/questions/11384227/in-qt-how-to-setcodecforcstrings-globally-in-header)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T23:56:50.423

考虑使用 latin1 语言以简单的英语编写所有消息，并使用 Qt 翻译功能将消息转换为西班牙语。请参阅[http://qt-project.org/doc/qt-4.8/qobject.html#tr](http://qt-project.org/doc/qt-4.8/qobject.html#tr)和[http://qt-project.org/doc/qt-4.8/linguist-translators.html](http://qt-project.org/doc/qt-4.8/linguist-translators.html)

这有几个优点：

*   你的程序可以翻译成其他语言
*   非西班牙语开发人员将能够更轻松地修改您的代码（假设每个开发人员都懂英语，只有一些人懂西班牙语）。

# c# - 如何从 C#.net 传递包含 \n 和 \t 的长文本的 javascript 参数

> ID：15531111
> 
> 赞同：2
> 
> 时间：2013-03-20T17:51:15.117
> 
> 标签：c#, javascript, asp.net, html

我有一个有 5 个参数的 javascript 函数。我需要传递大量文本（它是从后面的 C#.net 代码到 js 函数的堆栈跟踪

代码 ：

```
function createDIV(CLASS_NAME, METHOD_NAME, APPLICATION_NAME, EXCEPTION_MESSAGE, STACK_TRACE_TEXT, EXCEPTION_OCCURANCE_STATUS) {   
    \\processing the code
} 
```

当我调用此函数时，它适用于所有其他值，但如果文本包含 \n 它会失败

示例文本：org.apache.struts.chain.commands.InvalidPathException: 找不到指定 url 的操作配置。\n\tat org.apache.struts.chain.commands.AbstractSelectAction.execute(AbstractSelectAction.java:68)\n \t

调用代码：

```
ClientScript.RegisterStartupScript(
    GetType(), 
    "sss", 
    "createDIV(
        '" + CLASS_NAME.ToString() + "','" + METHOD_NAME.ToString() + "','" + 
            APPLICATION_NAME.ToString() + "','" + EXCEPTION_MESSAGE.ToString() + "','" + 
            STACK_TRACE.ToString() + "');",
true); 
```

我也无法用 C#.net 中的 html 等效项替换 \n。它只是返回 -1 来表示它的出现

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:13:45.837

尝试`STACK_TRACE = STACK_TRACE.Replace(Environment.NewLine, "<br>");`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:55:39.390

在您的 C# 代码中，例如：

```
string str = "TEXT TEXT TEXT\n, TEXT TEXT\t TEXT. TEXT TEXT\n\t TEXT TEXT.";
str = str.Replace("\n", "<br/>").Replace("\t", "<br/></br>"); 
```

结果：

```
**TEXT TEXT TEXT<br/>, TEXT TEXT<br/></br> TEXT. TEXT TEXT<br/><br/></br>TEXT TEXT.** 
```

您可以编写一系列替换。

If you want to replace in javascript then use RegExp. See this [article](https://stackoverflow.com/q/6268611/1803269)

# svn - 子剪辑合并不从父级写入合并信息

> ID：15531113
> 
> 赞同：0
> 
> 时间：2013-03-20T17:51:20.130
> 
> 标签：svn, tortoisesvn, subclipse

**在使用Subclipse**将分支合并到主干时，我们遇到了一些困难。

我们的工作区包含多个项目 (30)，它们是 /trunk/ 的子文件夹：

*   /主干/项目1
*   /主干/项目2
*   /主干/项目3
*   ...

当我们与**Subclipse**合并时，我们需要选择所有项目，然后选择*Team -> Merge*。不幸的是，它不会为父文件夹（主干）写入 merge:info。

有没有办法合并整个主干？当我们检查整个后备箱时，我们可以使用**TortoiseSVN**来做到这一点。但是我们的开发人员想使用**Subclipse**来完成它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:37:00.837

Subclipse 不写任何东西，Subversion 会。Subclipse 调用 Subversion API，在这种情况下合并，其余的由 Subversion 完成。

因为您无法在 Subclipse 中选择 /trunk，除非您已在工作区中单独签出一个项目，否则无法对其进行写入。

如果您有 30 个项目，我会使用 TortoiseSVN 进行合并，然后在 Eclipse 中进行刷新以处理结果。尽管您还需要从 TortoiseSVN 提交才能将 /trunk 包含在提交中。

Subclipse 必须执行 30 个单独的合并“命令”，每个项目一个。每个项目都会将 mergeinfo 属性写入其根目录。Subversion 可以处理这个问题，但很明显，如果 /trunk 中有其他内容要合并，那么您可能应该在 Eclipse 中拥有这些内容，或者与另一个客户端进行合并。

请注意，当我说 Subversion 处理这个问题时，我的意思是如果您首先在 Subclipse 中进行合并并提交等。然后再使用 TortoiseSVN 在 /trunk 级别进行合并，SVN 足够聪明，只能合并尚未合并的内容已经合并了。它通常还会“忽略”从 30 个项目根目录到 /trunk 文件夹级别的合并信息。

# php - Symfony 2 form : entity widget with many to one/one to many relation - relation not persisting

> ID：15531114
> 
> 赞同：1
> 
> 时间：2013-03-20T17:51:23.320
> 
> 标签：php, symfony, orm, doctrine-orm, symfony-forms

I have a Audit form, to which i can attach several ressources ***(Audit has many Ressources, a ressource is attached to only one audit***).

the form is well presented in the view, yet, when saving the form, the selected ressources are not attached to the audit in the DB.

Audit Form :

```
>add('ressources', 'entity', array(
            'class' => 'SpriMonitorBusinessBundle:Ressource',
            'query_builder' => $this->em->getRepository('SpriMonitorBusinessBundle:Ressource')->getAvailableRessources(true),
            'multiple'=>true
    )) 
```

Audit.orm.yml:

```
oneToMany:
    ressources:
      targetEntity: Ressource
      mappedBy: audit 
```

Ressource.orm.yml:

```
manyToOne:
    audit:
      targetEntity: Audit
      inversedBy: ressources
      joinColumn:
        name: audit_id
        referencedColumnName: id 
```

***N.B: On the Ressource form, when i select an audit, it is correctly saved***

Controller:

```
public function newAction()
    {
        $em = $this->getDoctrine()->getEntityManager();
        $item = AuditFactory::make();
        $form = $this->createForm(new AuditType($em),$item);

        $request = $this->get('request');
        $session = $this->get('session');

        if ('POST' == $request->getMethod()) {
            try {

                $this->validateForm($form,$request);
                $em->persist($item);
                $em->flush();
                $message  = $this->container->getParameter('form_submit_success');
                $session->setFlash('success', $message);
                $url = $this->generateUrl('Spri_audit_list');

                return $this->redirect($url);

            } catch (FormException $e) {
                $session->setFlash('error', sprintf('Erreur Formulaire : "%s"',$e->getMessage()));
            } catch (\Exception $e) {
                die(var_dump($e->getMessage()));
                $session->setFlash('error', sprintf('Erreur inconnue !  Contactez l\'ADMIN'.$e->getMessage()));
            }
        }

        return $this->render('SpriAuditBundle:Audit:new.html.twig', array('form'=>$form->createView()));
    }

    protected function validateForm($form, $request)
    {
        $form->bind($request);
        if (!$form->isValid()) {
            $message  = $this->container->getParameter('form_submit_error');
            throw new FormException($message);
        }
    } 
```

var_dump($item) shows:

```
private 'slug' => null
  private 'ressources' => 
    object(Doctrine\Common\Collections\ArrayCollection)[4190]
      private '_elements' => 
        array
          0 => 
            object(Spri\MonitorBusinessBundle\Entity\Ressource)[3766]
              ...
  privat... 
```

Any idea??

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T07:41:43.130

您必须通过编辑实体的方法手动`Audit`在实体中设置实体。`Ressource``addRessource()`

只需编辑此方法，如：

```
public function addRessource(Ressource $ressource)
{
    $this->ressources[] = $ressource;
    $ressource->setAudit($this);

    return $this;
} 
```

**UPD**

然后尝试在控制器中手动持久化资源：

```
foreach ($audit->getRessources() as $ressource) {
    $em->persist($ressource);
} 
```

**UPD**

嗯，奇怪。执行下一个代码片段并检查资源关系：

```
$em = $this->getDoctrine()->getManager();

$ressource = new Ressource();
$ressource->setSomeRequiredFieldValue($someValue);

$audit = new Audit();
$audit->setSomeRequiredFieldValue($someValue);
$audit->addRessource($ressource);

$em->persist($audit);
$em->persist($ressource);
$em->flush(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:08:42.033

好吧，我想我知道发生了什么。这个更新的控制器应该可以解决您的问题：

```
public function newAction()
{
    $em = $this->getDoctrine()->getEntityManager();
    $item = AuditFactory::make();
    $form = $this->createForm(new AuditType($em),$item);

    $request = $this->get('request');
    $session = $this->get('session');

    if ('POST' == $request->getMethod()) {
        try {

            $this->validateForm($form,$request);

            $newItem = $form->getData();

            $em->persist($newItem);
            $em->flush();
            $message  = $this->container->getParameter('form_submit_success');
            $session->setFlash('success', $message);
            $url = $this->generateUrl('Spri_audit_list');

            return $this->redirect($url);

        } catch (FormException $e) {
            $session->setFlash('error', sprintf('Erreur Formulaire : "%s"',$e->getMessage()));
        } catch (\Exception $e) {
            die(var_dump($e->getMessage()));
            $session->setFlash('error', sprintf('Erreur inconnue !  Contactez l\'ADMIN'.$e->getMessage()));
        }
    }

    return $this->render('SpriAuditBundle:Audit:new.html.twig', array('form'=>$form->createView()));
} 
```

# ruby-on-rails - 用于多个控制器的 Rails 3 单个 url

> ID：15531115
> 
> 赞同：0
> 
> 时间：2013-03-20T17:51:23.767
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我的客户要求提供一个 url 来完成其应用程序中的工作流程：`example.org/task/:token`. `:token`该任务的唯一 ID在哪里。

在`TaskController`in`index`操作`:token`中用于查询任务对象，并根据任务的当前状态呈现视图：

```
def index
  @task = Task.where(token: params[:token])
  render @task.state.to_s
end 
```

每个状态都有一个视图，呈现视图的逻辑在视图本身中（丑陋！！）。

我想重构它，以便使用任务状态来确定要呈现的控制器操作。我可以做到这一点`render template: '#{state}/action'`。但这不会执行控制器动作逻辑。这意味着我仍然坚持视图中的控制器逻辑！

我发现[这个解决方案](https://stackoverflow.com/a/7085969/33226)有效，但它有点难看并且打破了一些“魔法”的轨道（必须显式渲染视图。）

我的问题是，有没有更好的方法在 Rails 中完成此任务，同时仍保持单个 url 而不会重定向到新的 url？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:21:37.697

您链接到一个未被接受的答案，我会在该链接中推荐接受的答案（[https://stackoverflow.com/a/6051812/1461068](https://stackoverflow.com/a/6051812/1461068)）

具体这部分：

```
def your_action
  ...
  render :action => :index
end 
```

你可以这样处理：

```
def index
  @task = Task.where(token: params[:token]).first
  render :action => get_action_for_state(@task.state.to_s)
end

private

def get_action_for_state(state)
    //logic to figure out which action to call
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:16:29.923

看看这个：[http:](http://railscasts.com/episodes/217-multistep-forms) //railscasts.com/episodes/217-multistep-forms 我认为 ryanb 有一些好主意。基本上你会让你的 task.html.erb 渲染适当的部分，这取决于你的任务处于什么状态：

```
 <%= render "#{@task.state}_state", :f => f %> 
```

# javascript - jQuery在随机时间生成随机数

> ID：15531116
> 
> 赞同：1
> 
> 时间：2013-03-20T17:51:30.527
> 
> 标签：javascript, jquery

我正在尝试制作一个插件。在这个插件中，我有两个变量；rateMin 和 rateMax。我想在这两个数字之间生成一个随机数并将其用作 setInterval 时间。然后，一旦使用了该数字，请制作另一个随机数并使用它。

这是一个简单的例子：

```
var defaults = {
    rateMin: 500,
    rateMax: 2000
}

var options = $.extend(defaults, options);
return this.each(function(defaults){

var rate = Math.floor(Math.random() * (options.rateMax - options.rateMin + 1)) + options.rateMin; // MAKE A RANDOM NUMBER BETWEEN MAX AND MIN
setInterval(function(){
    var rate = Math.floor(Math.random() * (options.rateMax - options.rateMin + 1)) + options.rateMin
    //DO SOMETHING
}, rate); 
```

我希望通过这种方式，速率会用一个新数字覆盖自身，并在下次调用 setInterval 时使用。但它仍然只使用在 setInterval 之前生成的第一个数字。

我想我不知道如何在它的函数之外使用一个变量。

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T17:53:48.117

如果您不希望每次延迟都相同，请使用[`setTimeout`](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)而不是。[`setInterval`](https://developer.mozilla.org/en-US/docs/DOM/window.setInterval)此外，如果您希望它覆盖外部范围中的变量，请不要`var rate`在回调中使用。也就是说，我只是将那段逻辑封装在一个函数中，然后忘记它。

```
function getNextRate() {
    return Math.floor(Math.random() * (options.rateMax - options.rateMin + 1)) + options.rateMin;
}

setTimeout(function foo(){
    //DO SOMETHING

    setTimeout(foo, getNextRate());
}, getNextRate()); 
```

# javascript - $resource 回调（错 误和成功）

> ID：15531117
> 
> 赞同：38
> 
> 时间：2013-03-20T17:51:35.177
> 
> 标签：javascript, angularjs

我正在使用 AngularJS 1.1.3 来使用带有承诺的新 $resource ...

我怎样才能得到回调？我尝试了与 $http 相同的方法：

```
$resource.get('...').
  success(function(data, status) {
      alert(data);
   }).
   error(function(data, status) {
      alert((status);
   }); 
```

但是没有“成功”也没有“错误”功能......

我也试过了：

```
$resource.get({ id: 10 },function (data) {
   console.log('success, got data: ', data);
 }, function (err) {
   alert('request failed');
 }); 
```

即使返回是**404** ，它也总是打印“成功，得到数据” ......

任何的想法？

谢谢

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-04-18T07:24:03.930

作为**[关于 angulars 资源](https://github.com/ashtuchkin/angular.js/commit/37dc1d3f74f81e9b0a4a7d9010bab8b266b49da3)**和 angular 1.2 的 PR，angular 将切换到更简单的方式来执行成功/错误检查。Resource.get(..) 和 instance.get() 都将支持 $promise 方法，而不是附加回调或 $then 方法，这自然会为两者返回一个 Promise。

**从 Angular 1.2 开始，$promise 功能将上线：[$promise 更改](https://github.com/angular/angular.js/commit/05772e15fbecfdc63d4977e2e8839d8b95d6a92d)**

将您的“获取”请求更改为以下内容（原始示例在 angularjs.org 首页上）：

```
factory('Project', function($resource) {
  var Project = $resource('https://api.mongolab.com/api/1/databases' +
      '/youraccount/collections/projects/:id',
      { apiKey: 'yourAPIKey' }, {
        update: { method: 'PUT' }
      }
  );

  Project.prototype.update = function(cb) {
    return Project.update({id: this._id.$oid})
      .$promise.then(
        //success
        function( value ){/*Do something with value*/},
        //error
        function( error ){/*Do something with error*/}
      )
  };

  Project.prototype.destroy = function(cb) {
    return Project.remove({id: this._id.$oid})
      .$promise.then(
        //success
        function( value ){/*Do something with value*/},
        //error
        function( error ){/*Do something with error*/}
      )
  };

  return Project;
}); 
```

在控制器的其他地方，您可以实例化一个资源“项目”实例，您可以在其中使用相同的接口来获取成功和错误：

```
var myProject = new Project();

myProject.$get({id: 123}).
   .$promise.then(
      //success
      function( value ){/*Do something with value*/},
      //error
      function( error ){/*Do something with error*/}
   ) 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-03-29T14:51:54.163

```
var MyResource = $resource("/my-end-point/:action", {}, {
    getSomeStuff: { method:"GET", params: { action:"get-some-stuff" }, isArray: true },
    getSingleThing: { method:"GET", params: { action:"get-single-thing" }, isArray: false }
});

function MyController(MyResource) {
    var itemList = MyResource.getSomeStuff({}, function success() {}, function err() {});
    // will call: /my-end-point/get-some-stuff
    // will be array. each object is resource's instance
    var item = MyResource.getSingleThing({id:123}, function success() {}, function err() {});
    // will call: /my-end-point/get-single-thing?id=123
    // will be object. an instance of resource
} 
```

另请查看文档中的示例： [ngResource](http://docs.angularjs.org/api/ngResource.%24resource)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-26T09:18:07.657

两种方式

```
var resource = $resource("");
resource.$promise.then(function(data){
// do stuff success
}, function(error){
//do stuff error
}); 
```

另一种方式

```
var resource = $resource("");
resource({}, function success(data){
//do stuff
}, function error(error){
//do stuff
} 
```

# java - 使用 SimpleDateFormat 将日期和时间从一个时区转换为另一个时区

> ID：15531119
> 
> 赞同：1
> 
> 时间：2013-03-20T17:51:36.607
> 
> 标签：java, android

我有一个带有“错误”格式日期和时间的字符串，我需要将其转换为一个`Date`对象，以便我可以使用`SimpleDateFormat`和 current格式化它的内容`Locale`。

但是，无论我如何尝试，我都无法让输出显示正确的时间，我从 PST 时间 (UTC-8) 转换为 GMT，但打印的时间太多了 +1 小时，GMT 只有 +7从（当前 PDT）时区。

我已经在两台 Android 设备上尝试了该代码，一台设置为 GMT，另一台设置为 CET，一个 Android 模拟器，并从命令行运行，它们都弄错了时间。(+1)

**我在下面的代码中做错了什么？**

```
 String sourceSDFformatter = "MMM d, h:mm a Z";
    String destSDFformatter = "EEEEE, MMMMM dd, HH:mm";
    String dateString = "Mar 20th, 10:00 AM PST".replaceAll("st|nd|rd|th", "");

    SimpleDateFormat sourceSDF = new SimpleDateFormat(sourceSDFformatter, Locale.US);
    SimpleDateFormat destSDF = new SimpleDateFormat(destSDFformatter, Locale.UK);

    TimeZone sourceTZ = TimeZone.getTimeZone("America/Los_Angeles");
    TimeZone destTZ = TimeZone.getTimeZone("GMT");

    sourceSDF.setTimeZone(sourceTZ);
    destSDF.setTimeZone(destTZ);

    Date myDate = sourceSDF.parse(dateString);
    myDate.setYear(new Date().getYear());

    System.out.println("Your Time: " + destSDF.format(myDate)); 
```

输出：

`Your Time: Wednesday, March 20, 18:00`

当我的**预期**输出是：`Your Time: Wednesday, March 20, 17:00`.

我已经[在java中将本地时区转换为GMT中](https://stackoverflow.com/a/2414904 "在java中将本地时区转换为GMT")尝试了SO答案，如果我更改它会完美运行`TimeZone.getTimeZone("America/Los_Angeles")`，那么打印的时间提前+7小时是正确的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T17:58:59.243

格式字符串中的`Z`意味着时区是从 动态设置的，`dateString`并且格式化程序本身的时区被忽略`parse()`。由于 dateString 表示`PST`日期是`PST`

将 4 位数的年份添加到您的格式中，然后`dateString`

# php - Using CURL output with php XML functions to process large data feeds

> ID：15531123
> 
> 赞同：3
> 
> 时间：2013-03-20T17:51:49.970
> 
> 标签：php, xml, xmlreader

Im having a feed that is password protected. Below is the code used to access the feed

```
$url = 'http://thefeedwebsite.com/feed.php';

$data = array("username" => ‘user’, "password" => ‘password’, "location" => "HK")
$ch = curl_init($url);

);

curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 0);

$output = curl_exec($ch);

curl_close($ch); 
```

The problem is that due to large size after outputting about 100 results it keeps on timeout. I have set the time limit in my php.ini as some threads suggested but still the same issue. I think its because CURL loads the complete feed to the memory.

Is it possible to load the `$output` directly to `XMLReader()` in php so I can process the feed through the reader faster?

Sorry is the question is totally noob. Just started learning php with xml

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:41:55.820

该线程可以帮助您（流式 cURL 和玩内存）：

[操作一个 3000 万个字符长的字符串](https://stackoverflow.com/questions/1342583/php-manipulate-a-string-that-that-is-30-mil-chars-long/1342760#1342760)

第一个答案将其存储在文件中。第二个是流数据“随着它们流动”。如果文件真的很大，您应该考虑要使用的 XML 解析器。有些将整个 xml 加载到内存中并创建一个对象，但其他一些可以只提供您可以在运行中使用 XML 的接口方法（无需将整个 XML 加载到内存中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:34:41.717

If time limit ([http://php.net/manual/en/function.set-time-limit.php](http://php.net/manual/en/function.set-time-limit.php)) is not your issue, have you considered that you could be running out of memory?

[http://www.php.net/manual/en/ini.core.php#ini.memory-limit](http://www.php.net/manual/en/ini.core.php#ini.memory-limit)

# nosql - RavenDB：我们可以将参数传递给映射/减少索引吗

> ID：15531124
> 
> 赞同：2
> 
> 时间：2013-03-20T17:51:55.227
> 
> 标签：nosql, ravendb, nosql-aggregation

我正在阅读很多关于预先计算的 raven db map/reduce 索引。我可以将参数传递给 map 函数，以便在分片环境中动态执行 map/reduce。

例如在[http://ayende.com/blog/89089/ravenb-multi-maps-reduce-indexes](http://ayende.com/blog/89089/ravendb-multi-maps-reduce-indexes)

```
var ups= session.Query<UserPostingStats, PostCountsByUser_WithName>()
    .Where(x => x.UserName.StartsWith("rah"))
    .ToList(); 
```

我可以在 map 函数中传递用户名参数而不是查询索引的结果吗？

我有 1500 万份文档分片在 3 台机器上。我正在尝试在 3 台机器上并行运行 map/reduce 查询。我查看了 mongodb，因为 mongo 的 map/reduce 在 javascript 线程上运行它非常慢。这种用例是否有可行的解决方案？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T01:15:03.827

你不能。所有 map/reduce 索引都在后台执行。当您需要执行它时，这会大大节省成本，因为我们可以为您提供预计算值。

# jquery - stopPropagation() 阻止子 onClick 函数

> ID：15531126
> 
> 赞同：1
> 
> 时间：2013-03-20T17:52:08.210
> 
> 标签：jquery, onclick, stoppropagation

我到处搜索，但找不到这个问题的答案。

我在 div 中构建了一个包含几个 div 的菜单：

```
<nav id="menu">
   <span>Open Menu</span>

   <div class="dropdownContain">
       <div class="dropOut">
          ...
          ...
          <div id="logout_wrap">
             <a id="logout"> 
```

还有一个使用 JQuery 的脚本，以便在单击“#menu”时出现（切换）菜单，并在单击正文时消失。对于这个功能，我不得不使用 stopPropagation() 方法来阻止 #dropDownContain 运行 "body" 的 hide() 函数

```
$(document).ready(function () {

    $('#menu').click(function (e) {
        e.stopPropagation();
        $('.dropdownContain').toggle();
    });

    $(document).click(function (e) {
        $('.dropdownContain').hide();
    });

    $('.dropdownContain').click(function (e) {
        e.stopPropagation();
    }); 
```

我还为“#dropdownContain”（菜单的主体）内的“#logout”创建了一个单击事件，以运行 someThing() 函数。

```
jQuery('body').on('click', '#logout', function () {
    alert("THIS DOES NOT WORK");
}); 
```

问题是 "#logout" 的分配函数不会触发，因为它的父级调用了 stopPropagation() 方法（或者我认为如此）。

这是此代码的 html + js 的链接，以便您可以在使用中看到它： [JSFiddle](http://jsfiddle.net/7G7aP/1/)

那么有没有解决方案来解决这个问题，同时保持菜单弹出按说明工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T17:55:24.100

除非您有使用事件委托的理由，否则您可以直接将单击绑定到注销链接。

```
jQuery('#logout').on('click', function () {
    alert("this works");
}); 
```

您使用的委托版本仅在事件一直冒泡回到`body`元素时触发（它不会，因为您正在停止传播。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T17:58:18.557

停止使用 stopPropagation 并手动检查点击是否在内部`#menu`：

```
$('#menu').on('click', function() {
    $('.dropdownContain').toggle();
});

$(document).on('click', function(e) {
    if (! $(e.target).is('#menu') || $(e.target).closest('#menu').length )
        $('.dropdownContain').hide();
}); 
```

# google-analytics - 谷歌分析：当我推送一个新值时，变量会被覆盖吗？

> ID：15531128
> 
> 赞同：0
> 
> 时间：2013-03-20T17:52:11.460
> 
> 标签：google-analytics, google-analytics-api

假设我正在使用以下内容来识别一些用户：

```
_gaq.push(['_setCustomVar', 1, 'id', '<?php echo time() ?>', 1]); 
```

如果我把这个片段放在我所有的页面上，每次都会覆盖 id 吗？

**OBS：** *我正在使用访问者范围 (1) 自定义变量。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:30:25.637

当您在同一范围内使用相同的插槽时，它们将被覆盖，此外，当您在同一页面上使用页面级范围变量和具有相同插槽的其他范围时会出现问题（请参阅[https://developers.google.com/ analytics/devguides/collection/gajs/gaTrackingCustomVariables#setup](https://developers.google.com/analytics/devguides/collection/gajs/gaTrackingCustomVariables#setup) - “混合不同变量类型时要小心”一节）。

# c# - Encode and Decode - JPG to base64

> ID：15531135
> 
> 赞同：1
> 
> 时间：2013-03-20T17:52:30.683
> 
> 标签：c#, windows-phone-7, file-upload, base64, decoding

I'm developing a Windows Phone Application which uploads a user selected photo to a server using PHP. For this, I'm trying to convert the image to base64 and POST it to PHP where it is decoded back to JPG image.

The base64 string is successfully posted to the PHP but I always get a corrupted JPG file instead of the original image at the server (meaning that there is some error in encoding/decoding of the image).

The C# code for Application is:

```
public partial class SamplePage : PhoneApplicationPage
    {
        public SamplePage()
        {
            InitializeComponent();
        }

        PhotoChooserTask selectphoto = null;

        private void SampleBtn_Click(object sender, RoutedEventArgs e)
        {
            selectphoto = new PhotoChooserTask();
            selectphoto.Completed += new EventHandler<PhotoResult>(selectphoto_Completed);
            selectphoto.Show();
        }

        void selectphoto_Completed(object sender, PhotoResult e)
        {
            if (e.TaskResult == TaskResult.OK)
            {
                BinaryReader reader = new BinaryReader(e.ChosenPhoto);
                image1.Source = new BitmapImage(new Uri(e.OriginalFileName));
                txtBX.Text = e.OriginalFileName;

                HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://"+QR_Reader.MainPage.txtBlck+"/beamer/saveimage.php");
                request.Method = "POST";
                request.ContentType = "application/x-www-form-urlencoded";

                Stream photoStream = ImageToStream(image1);
                BitmapImage bimg = new BitmapImage();
                bimg.SetSource(photoStream); //photoStream is a stream containing data for a photo

                byte[] bytearray = null;
                using (MemoryStream ms = new MemoryStream())
                {
                    WriteableBitmap wbitmp = new WriteableBitmap(bimg);
                    wbitmp.SaveJpeg(ms, wbitmp.PixelWidth, wbitmp.PixelHeight, 0, 100);
                    ms.Seek(0, SeekOrigin.Begin);
                    bytearray = ms.GetBuffer();
                }
                string str = Convert.ToBase64String(bytearray);

                string postData = String.Format("image={0}", str);   

                // Getting the request stream.
                request.BeginGetRequestStream
                (result =>
                {
                    // Sending the request.
                    using (var requestStream = request.EndGetRequestStream(result))
                    {
                        using (StreamWriter writer = new StreamWriter(requestStream))
                        {
                            writer.Write(postData);
                            writer.Flush();
                        }
                    }

                    // Getting the response.
                    request.BeginGetResponse(responseResult =>
                    {
                        var webResponse = request.EndGetResponse(responseResult);
                        using (var responseStream = webResponse.GetResponseStream())
                        {
                            using (var streamReader = new StreamReader(responseStream))
                            {
                                string srresult = streamReader.ReadToEnd();
                            }
                        }
                    }, null);
                }, null);

            }  // end of taskresult == OK           
        }  // end of select photo completed

        private Stream ImageToStream(Image image1)
        {
            WriteableBitmap wb = new WriteableBitmap(400, 400);

            wb.Render(image1, new TranslateTransform { X = 400, Y = 400 });

            wb.Invalidate();
            Stream myStream = new MemoryStream();

            wb.SaveJpeg(myStream, 400, 400, 0, 70);

            return myStream;
        }
    }  // End of Class 
```

The PHP code at the server to decode and save image is:

```
<?php
function base64_to_image( $imageData, $outputfile ) {
    // encode & write data (binary)
    $ifp = fopen( $outputfile, "wb" );

    fwrite( $ifp, base64_decode( $imageData ) );
    fclose( $ifp );
    // return output filename 
    return( $outputfile );
}       

if (isset($_POST['image'])) {
    base64_to_image($_POST['image'], "img.jpg");
}
else
    die("no image data found");
?> 
```

I don't know what is wrong here. I've been searching for hours to do this and I'm still failing.

Please help me.

**EDIT:** I just figured out that I always get the same base64 string irrespective of any image that I choose. This is what is get after base64 conversion: [http://textuploader.com/?p=6&id=vWZy](http://textuploader.com/?p=6&id=vWZy)

I am really puzzled now. I'm getting the same output for each and very image. I don't know why this is happening.

I really want to do this, and I'm stuck here, at base64 encoding. Please help me.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T17:56:08.037

这可能不是问题的*全部*，但这段代码被破坏了：

```
byte[] bytearray = null;
using (MemoryStream ms = new MemoryStream())
{
    WriteableBitmap wbitmp = new WriteableBitmap(bimg);
    wbitmp.SaveJpeg(ms, wbitmp.PixelWidth, wbitmp.PixelHeight, 0, 100);
    ms.Seek(0, SeekOrigin.Begin);
    bytearray = ms.GetBuffer();
} 
```

通过使用`GetBuffer`，您将获得可能比*实际*数据更大的底层缓冲区。您可以改用 - 并且在使用or`ToArray`之前您不需要“倒带”流：`GetBuffer``ToArray`

```
byte[] bytearray = null;
using (MemoryStream ms = new MemoryStream())
{
    WriteableBitmap wbitmp = new WriteableBitmap(bimg);
    wbitmp.SaveJpeg(ms, wbitmp.PixelWidth, wbitmp.PixelHeight, 0, 100);
    bytearray = ms.ToArray();
} 
```

如果这不起作用，您应该仔细查看之前和之后的文件，最好是在二进制文件编辑器中：

*   它们的尺寸相同吗？
*   它们在哪里不同，以及如何不同？有没有图案？

# ios - 用轨道创建 GPX 文件的简单方法

> ID：15531136
> 
> 赞同：0
> 
> 时间：2013-03-20T17:52:31.377
> 
> 标签：ios, xcode, ios-simulator, gpx

如何使用航点轻松创建表示两点之间轨迹的 GPX 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-30T09:39:17.847

这个[工具](http://gpx-poi.com)非常适合！设置位置或路线并下载您的 GPX 文件。不要忘记删除文件末尾的 .txt。

玩得开心：D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T17:52:31.377

我发现这个站点上的 python 脚本非常有用并且非常简单，可以生成一个包含带有航点的轨迹的 gpx 文件：

[https://coderwall.com/p/on-ica](https://coderwall.com/p/on-ica)

这是要点：[https ://gist.github.com/basuke/3605355](https://gist.github.com/basuke/3605355)

# algorithm - 是否可以使用 k-means 将数据聚类到 100% 正确的组中？

> ID：15531140
> 
> 赞同：0
> 
> 时间：2013-03-20T17:52:38.227
> 
> 标签：algorithm, k-means

我正在使用 k-means 和欧几里得距离算法来聚类数据（iris.csv）。但是，我无法将它们全部归为正确的组，错误的组中有一些数据。

所以，我只是想知道是否可以 100% 将所有数据聚集到正确的组中？

我心中的另一个问题是选择 k 的最佳标准是什么？

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T17:55:56.407

通常在您实际上不知道给定集合的正确组是什么时使用聚类算法。即使您的算法确实对给定训练集中的所有数据进行了正确聚类，但这并不意味着它会正确聚类**任何**数据。此外，您应该尽量避免过度拟合示例数据，因为这通常会降低性能。

至于选择 k - 有几种算法，最好的一种可能会根据您尝试解决的问题而有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T21:09:25.753

K-means 倾向于创建同样大小的凸簇。如果您的集群大小非常不同或形状不规则，则其他一些算法可能具有更好的性能。[http://en.m.wikipedia.org/wiki/Cluster_analysis#Clustering_algorithms](http://en.m.wikipedia.org/wiki/Cluster_analysis#Clustering_algorithms)

# sql - SQL 子选择查询

> ID：15531141
> 
> 赞同：0
> 
> 时间：2013-03-20T17:52:38.940
> 
> 标签：sql, oracle, subquery, sql-subselect

我正在尝试查询酒店数据库以查找预订的总费用。我正在使用子选择查询，但是我经常收到错误消息。

这是查询，我希望它显示预订 ID 和房间号以及总费用。

```
 SELECT BOOKING_ID, ROOM_NO , SUM(TOTAL) AS TOTAL FROM
    (
        SELECT (END_DATE-START_DATE) DAYDIFF, ((END_DATE-START_DATE)*ROOM_PRICE) TOTAL_ROOM 
        FROM ROOM_TBL NATURAL JOIN ROOM_DETAILS_TBL WHERE BOOKING_ID = &BOOKING_ID
    )  FROM ROOM_TBL; 
```

这是错误：

```
ERROR at line 3:
ORA-00907: missing right parenthesis 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:01:15.833

虽然我不确定您的架构中的各种属性在哪里，但试试这个：

```
SELECT z.BOOKING_ID, r.ROOM_NO , SUM(TOTAL) TOTAL 
FROM  (SELECT ri.room_No, dt.Booking_id,
             (END_DATE-START_DATE) DAYDIFF, 
             ((END_DATE-START_DATE)*ROOM_PRICE) TOTAL 
       FROM ROOM_TBL ri
             NATURAL JOIN ROOM_DETAILS_TBL dt
       WHERE BOOKING_ID = &BOOKING_ID) z 
   Join ROOM_TBL r  
     On r.ROOM_NO = z.Room_No 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T17:57:54.710

那么你有几个问题。

首先，查询中有两个`FROM`s，一个在子查询之前，一个在子查询之后。

其次，你没有`GROUP BY`，但你有一个正在使用的聚合函数。

看起来你可能想要：

```
SELECT BOOKING_ID, ROOM_NO , SUM(TOTAL) AS TOTAL 
FROM
(
    SELECT BOOKING_ID, 
        ROOM_NO, 
        (END_DATE-START_DATE) DAYDIFF, 
        ((END_DATE-START_DATE)*ROOM_PRICE) TOTAL 
    FROM ROOM_TBL 
    NATURAL JOIN ROOM_DETAILS_TBL 
    WHERE BOOKING_ID = &BOOKING_ID
)  
GROUP BY BOOKING_ID, ROOM_NO; 
```

编辑，如果你想要`TOTAL`一行，那么你可以使用`GROUP BY ROLLUP`：

```
SELECT max(BOOKING_ID) Booking_id, 
  case when ROOM_NO is null then ' ' else room_no end Room_no, 
  SUM(TOTAL) AS TOTAL 
FROM
(
    SELECT BOOKING_ID, 
        ROOM_NO, 
        (END_DATE-START_DATE) DAYDIFF, 
        ((END_DATE-START_DATE)*ROOM_PRICE) TOTAL 
    FROM ROOM_TBL 
    NATURAL JOIN ROOM_DETAILS_TBL 
    WHERE BOOKING_ID = &BOOKING_ID
)  
GROUP BY ROLLUP (room_no); 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!4/7ec0a/13)

如果您想要列中的数据，则可以在子查询上使用公用表表达式：

```
with cte as
(
     SELECT BOOKING_ID, 
        ROOM_NO, 
        (END_DATE-START_DATE) DAYDIFF, 
        ((END_DATE-START_DATE)*ROOM_PRICE) TOTAL 
    FROM ROOM_TBL 
    NATURAL JOIN ROOM_DETAILS_TBL 
 )
 select booking_id,
    room_no,
    total,
    case when rn = 1 then totalbooking else null end totalbooking     
 from
 (
     select booking_id,
        room_no,
        total,
        (select sum(total) from cte) TotalBooking,
        row_number() over(partition by booking_id order by room_no) rn
     from cte
 ) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!4/7ec0a/14)

# java - Java 7 WatchService - 该进程无法访问该文件，因为它正在被另一个进程使用

> ID：15531144
> 
> 赞同：8
> 
> 时间：2013-03-20T17:52:51.337
> 
> 标签：java, file-io, java-7, watchservice

我按照[Watching a Directory](http://docs.oracle.com/javase/tutorial/essential/io/notification.html) for Changes Java7 nio2 教程使用代码示例 WatchDir.java 递归地监视目录的全部内容。

代码如下所示：

```
// Get list of events for the watch key.
for (WatchEvent<?> event : key.pollEvents()) {
// This key is registered only for ENTRY_CREATE events, but an OVERFLOW event 
// can occur regardless if events are lost or discarded.
if (event.kind() == OVERFLOW) {
    continue;
}

// Context for directory entry event is the file name of entry.
@SuppressWarnings("unchecked")
WatchEvent<Path> ev = (WatchEvent<Path>)event;
Path fileName = ev.context();
Path fullPath = dir.resolve(fileName);

try {
    // Print out event.
    System.out.print("Processing file: " + fileName);

    processed = fileProcessor.processFile(fullPath);

    System.out.println("Processed = " + processed);

    if (processed) {
        // Print out event.
        System.out.println(" - Done!");
    }
} 
catch (FileNotFoundException e) {
    System.err.println("Error message: " + e.getMessage());
}
catch (IOException e) {
    System.err.println("Error processing file: " + fileName.toString());
    System.err.println("Error message: " + e.getMessage());
} 
```

好的，所以问题（我肯定会做一些愚蠢的事情）就在这里：

```
processed = fileProcessor.processFile(fullPath); 
```

它的作用是这样的：

```
public synchronized boolean processFile(Path fullPath) throws IOException {
String line;
String[] tokens;
String fileName = fullPath.getFileName().toString();
String fullPathFileName = fullPath.toString();

// Create the file.
File sourceFile = new File(fullPath.toString());

// If the file does not exist, print out an error message and return.
if (sourceFile.exists() == false) {
    System.err.println("ERROR: " + fullPathFileName + ": No such file");
    return false;
}

// Check file extension.
if (!getFileExtension(fullPathFileName).equalsIgnoreCase("dat")) {
    System.out.println(" - Ignored.");
    return false;
}

// Process source file.
try (BufferedReader bReader = new BufferedReader(new FileReader(sourceFile))) {
    int type;

    // Process each line of the file.
    while (bReader.ready()) {

        // Get a single line.
        line = bReader.readLine();

        // Get line tokens.
        tokens = line.split(delimiter);

        // Get type.
        type = Integer.parseInt(tokens[0]);

        switch (type) {
        // Type 1 = Salesman.
        case 1:
            -> Call static method to process tokes.
            break;
        // Type 2 = Customer.
        case 2:
            -> Call static method to process tokes.
            break;
        // Type 3 = Sales.
        case 3:
            -> Call static method to process tokes.
            break;
        // Other types are unknown!
        default:
            System.err.println("Unknown type: " + type);
            break;
        }
    }

    PrintStream ps = null;
    try {

        // Write output file.
        // Doesn't matter. 

    } 
    finally {               
        if (ps != null) {
            ps.close();
        }
    }
    return true;
}
} 
```

我第一次处理事件时，一切正常！即使有超过 1 个文件要处理。但是在连续的时间里，我收到了这个错误信息：

> 该进程无法访问该文件，因为它正被另一个进程使用

我在这里做错了什么？我该怎么做才能成功处理连续文件？

我忘记提及的两个重要注意事项：

1.  我正在使用 Windows 7。
2.  当我在调试模式下运行应用程序时，它可以工作。

编辑：如果我在尝试使用文件之前添加一个睡眠，它会起作用：

```
Thread.sleep(500);

// Process source file.
try (BufferedReader bReader = new BufferedReader(new FileReader(sourceFile))) { 
```

那么，有没有可能是 Windows 没有及时解锁文件呢？我该如何解决（以适当的方式）？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-20T20:43:32.663

好的，我找到了解决方案。我不知道这是否是最好的方法，但它确实有效。不幸的是，file.canRead() 和 file.canWrite() 都返回 true，即使文件仍然被 Windows 锁定。所以我发现如果我尝试用相同的名称“重命名”它，我知道 Windows 是否正在处理它。所以这就是我所做的：

```
 while(!sourceFile.renameTo(sourceFile)) {
        // Cannot read from file, windows still working on it.
        Thread.sleep(10);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-04-27T23:53:04.713

Arundev 给出的解决方案对我有用。

我需要添加睡眠时间，否则它不适用于多个请求并用于获取错误“进程无法访问文件，因为它正在被另一个进程使用”

```
if (StandardWatchEventKinds.ENTRY_CREATE.equals(event.kind())) {
    try {
        Thread.sleep(3000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }

// now do your intended jobs ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-22T15:22:44.823

我有类似的问题。但是我的文件在被复制时没有被锁定。如果我在创建它为空的事件后立即尝试阅读它。

我认为在你的情况下没有必要的技巧，你可以简单地处理错误，如果你得到错误，你可以执行睡眠，然后再试一次。但对我来说，这不适合我。我没有收到错误。所以我尝试了你的解决方案，我明白这对我来说也是不可接受的，因为我除了阅读之外没有其他权利。所以我可以建议我的“技巧”。我正在使用类 java.io.RandomAccessFile：

```
List<String> lines = null;

while(true){
    try( RandomAccessFile raf = new RandomAccessFile( fileFullPath.toFile() , "r" ) ){
        lines = Files.readAllLines( fileFullPath , Charset.forName(ENCODING) );
        break;
    }catch(FileNotFoundException ex){
        LOG.warn("File isn't yet completed: {}",ex.getMessage() );
        LOG.info( "Waiting {} for next attempt to read it" , SLEEP_INTERVAL_READING );
        try {
            Thread.sleep(SLEEP_INTERVAL_READING);
        } catch (InterruptedException e) {
            LOG.error("Waiting was interrupted",e);
        }
    }catch(Exception ex){
        LOG.error("Error in reading file ",ex);
        clear();
        return false;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-22T10:53:07.777

当事件是 ENTRY_MODIFY 类型时，请允许当前线程休眠几秒钟。我无法确切说明为什么会发生这种情况，但有时我的日志中正在打印多个 ENTRY_MODIFY 事件。根据您的文件大小，请设置睡眠时间。

```
if(kind ==  StandardWatchEventKinds.ENTRY_MODIFY){
try {
    Thread.sleep(1000);
} catch (InterruptedException e) {
    e.printStackTrace();
}
//toDo - something
} 
```

# java - 无法停止弹簧批处理步骤

> ID：15531147
> 
> 赞同：0
> 
> 时间：2013-03-20T17:53:10.420
> 
> 标签：java, spring, spring-batch

无法停止弹簧批处理步骤..

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:batch="http://www.springframework.org/schema/batch"
    xsi:schemaLocation="
    http://www.springframework.org/schema/batch http://www.springframework.org/schema/batch/spring-batch-2.1.xsd
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <description>Example job to get you started. It provides a skeleton for a typical batch application.</description>
<bean id="HelloTasklet" class="c.c.c.HelloTasklet" scope="step"/>
<bean id="completionPolicy" class="org.springframework.batch.repeat.policy.DefaultResultCompletionPolicy"/> 
<bean id="chunkTimeout" class="org.springframework.batch.repeat.policy.TimeoutTerminationPolicy">
    <constructor-arg value="3"/>
</bean>
<bean id="commitCount" class="org.springframework.batch.repeat.policy.SimpleCompletionPolicy">
    <property name="chunkSize" value="200" />
</bean>
<bean id="chunkCompletionPolicy" class="org.springframework.batch.repeat.policy.CompositeCompletionPolicy">
    <property name="policies">
    <list>
        <ref bean="chunkTimeout" />
        <ref bean="commitCount" />
    </list>
    </property>
</bean>
<bean id="RandomChunkSizePolicy" class="c.c.c.RandomChunkSizePolicy"/>
<job id="importInvoices"  xmlns="http://www.springframework.org/schema/batch">  
<listeners>
<listener ref="loggingListener"/>
</listeners>
    <step id="vehicleStep" next="hello">
    <tasklet>
        <chunk reader="vehicleReader"  writer="vehicleWriter" chunk-completion-policy="RandomChunkSizePolicy"/>
    </tasklet>
</step>
    <step id="hello" next="decompress">
        <tasklet ref="HelloTasklet" />
    </step>

    <step id="decompress" next="readWriteInvoices">
        <tasklet ref="decompressTasklet" />
    </step>
    <step id="readWriteInvoices">
        <tasklet>
            <chunk reader="reader" writer="writer" commit-interval="100" />
        </tasklet>  
    </step>
</job>
 <bean id="loggingListener" class="c.c.c.JobLoggerListener"></bean>
<bean id="decompressTasklet" class="c.c.c.DecompressTasklet">
    <property name="inputResource" value="file:./input/input.zip" /> 
    <property name="targetDirectory" value="./work/output/" /> 
    <property name="targetFile" value="invoices.txt" /> 
</bean>
<bean id="reader" class="org.springframework.batch.item.file.FlatFileItemReader">
    <property name="resource" value="file:./work/output/invoices.txt" />
    <property name="linesToSkip" value="1" />
    <property name="lineMapper">
        <bean class="org.springframework.batch.item.file.mapping.DefaultLineMapper">
            <property name="lineTokenizer">
                <bean class="org.springframework.batch.item.file.transform.DelimitedLineTokenizer">
                    <property name="names" value="INVOICE_ID,CUSTOMER_ID,DESCRIPTION,ISSUE_DATE,AMOUNT" />
                </bean>
            </property>
            <property name="fieldSetMapper">
                <bean class="c.c.c.InvoiceFieldSetMapper" /> 
            </property>
        </bean>
    </property>
</bean>
<bean id="writer" class="c.c.c.InvoiceJdbcItemWriter">
    <constructor-arg ref="dataSource" />
</bean> 
</beans> 
```

并在输入中看到这个：

```
The chunk size has been set to 2
Reader
Reader
Writer
[reeeeader, reeeeader]

The chunk size has been set to 2
Reader
Reader
Writer
[reeeeader, reeeeader]

The chunk size has been set to 2
Reader
Reader
Writer
[reeeeader, reeeeader] 
```

..等等。需要建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-01-13T17:43:01.077

一个步骤只有在其 ItemReader 实现中读取空值时才会停止。您需要确保读取器实现在某个时间点读取并返回空值。然后该步骤将自行停止。

# shell - 如何检查文件是否成功上传并在 shell 脚本的某个时间重试上传？

> ID：15531150
> 
> 赞同：1
> 
> 时间：2013-03-20T17:53:21.203
> 
> 标签：shell, ftp, rhel5

我正在运行 shell 脚本，它是上传结果文件以删除服务器。某天，ftp服务器崩溃了，但没人不知道，所以每天的数据没有按时生成。

为防止出现此问题，我的经理要求我检查上传结果并尝试延迟上传。（每小时试2~3次。）

我有问题。1.如何判断文件上传是否成功？2\. 有时如何重新安排文件上传？

仅供参考，我们的系统在 RHEL5 上运行，以下是文件上传代码。

```
ftp -n -v ${FTP_HOST} << END_SCRIPT

user ${FTP_USER} ${FTP_PASSWD}

prompt

binary

put  ${REPORT__NAME}.tar.gz

bye

END_SCRIPT 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:16:41.210

一个懒惰（简单，但不是很聪明）的解决方案：

*   1）计算文件的MD5sum： `md5sum ZEFILE > ZEFILE-MD5.txt`
*   2）上传文件：`put ZEFILE`

如果您可以在远程服务器上运行命令：

*   3）就在后面，第二个命令（所以它只在第一个命令之后运行）：`put ZEFILE-MD5.txt`
*   4) 在远程服务器上：它等到“ZEFILE”也有一个“ZEFILE-MD5.txt”，表明文件可能已完全上传。然后 IT 将 ZEFILE 的 md5sum 与 ZEFILE-MD5.txt 的内容进行比较，并警告您（邮件？）ZEFILE 已“损坏”

如果您无权访问远程服务器：

*   3) 尝试以另一个名称再次下载 ZEFILE：`get ZEFILE ZEFILE-from-remote`
*   4)`diff ZEFILE ZEFILE-from-remote`

如果您对远程服务器有（某些）访问权限，我还建议您使用“scp ZEFILE user@destination:/some/path/”而不是使用 FTP。

如果被迫使用 FTP：请阅读有关使用`expect`而不是编写无法“适应”远程发送的错误消息的静态脚本（也不要在发出相关命令之前等待适当的提示）

关于重新安排： `man at`

你可以这样做：（ `echo /path/to/myscript | at now + 3 hours`请检查语法，从几年前阅读该手册页的记忆中写出来......）（脚本可以以这种方式重新提交，但要小心无限循环^^）

我希望这会有所帮助（并且有人提出了一个“更聪明”的想法^^）

# callback - Google Charts API：向现有回调添加参数

> ID：15531152
> 
> 赞同：3
> 
> 时间：2013-03-20T17:53:26.253
> 
> 标签：callback, argument-passing, google-visualization

我有一个页面，其中包含从 Google 电子表格生成的许多图表。

典型代码如下所示：

```
var url = "http://my.googlespreadsheet.com/tq?argumentshereblahblahblah";
// create and send off the query
var query = new google.visualization.Query( url );
query.send( handleQueryResponse );

function handleQueryResponse(response) {
    // omitted code to handle errors
    // create new chart object, specify location in page
    var chart = new google.visualization.BarChart( document.getElementById('chart-' + i));
    // draw chart
    chart.draw( data, {} );
} 
```

由于我在页面上有几个图表，我想以编程方式创建它们，而不必拥有看起来相同的*x*函数，只是图表位置和标题不同。我已经设置了一个电子表格引用数组，我遍历这些引用，将每个引用传递给运行上述代码的函数：创建查询、发送查询、处理响应。我想要做的是将一个额外的参数传递给 handleQueryResponse 回调，以便我可以指定图形应该在页面上的位置。不过，我无法找到将变量放入 handleQueryResponse 的方法。如果我这样做：

```
// array of spreadsheet refs
var quArr = ['gid=2&range=D2%3AE10&headers=-1','gid=2&range=D15%3AE19&headers=-1', (etc.) ];
var base_url = "http://my.googlespreadsheet.com/tq?";
var i; // iterator

// iterate through the spreadsheet refs and send off the queries for each
for (i = 0; i < quArr.length; i++){
    var url = q_base + quArr[i];
    var query = new google.visualization.Query( url );
    query.send( handleQueryResponse );
}

// deal with the responses
function handleQueryResponse(response) {
    // omitted code to handle errors
    // get the data from the response
    var data = response.getDataTable();
    // create new chart object, specify location in page
    // anchors in the page correspond to where the chart should go
    var chart = new google.visualization.BarChart( document.getElementById('chart-' + i));
    chart.draw( data, { extra args } );
} 
```

...返回响应的异步性质意味着迭代器与我发送请求时的值不同。

[来自API 文档](https://developers.google.com/chart/interactive/docs/reference#Query)的额外信息：

> 发送（回调）
> 
> 将查询发送到数据源。*callback*应该是数据源响应时调用的函数。回调函数将接收 google.visualization.QueryResponse 类型的单个参数。返回值：无

问题：

1) API 文档中关于 query.send(callback) 的内容是否本质上意味着我无法更改回调以获取额外的参数？

2）任何人都可以提出解决这个问题的另一种方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:12:20.907

刚刚找到了我自己问题的答案 - 哇哦！应该坚持久一点。;)

万一它对其他人有用，我创建了一个新函数来执行查询并为回调使用了一个闭包。这是重组后的代码：

```
for (var i = 0; i < quArr.length; i++){
    var url = q_base + quArr[i];
    var query = new google.visualization.Query( url );
    doQuery(query, i);
}

function doQuery(q, it){
    q.send( function(response){
        // omitted error handling code
        var data = response.getDataTable();
        var chart = new google.visualization.BarChart( document.getElementById('chart-' + it));
        chart.draw( data, { other args } );
    });
} 
```

# java - Java：将文件列表存储为变量

> ID：15531155
> 
> 赞同：1
> 
> 时间：2013-03-20T17:53:41.203
> 
> 标签：java

我试图使用 Java 将目录中的文件列表作为变量存储。

基本上我想知道如何在 Java 中执行以下 python 命令

```
os.chdir("<directory>")
list = os.listdir(".") 
```

我知道这是一个非常简单的问题，但 Java 真的让我很困惑

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T17:56:13.930

你应该使用[`File#listFiles`](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#listFiles%28%29)：

```
File[] filesInDir = new File("<directory>").listFiles(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:45:44.343

你想用`File#listFiles`.

不精通 Python，我不确定您的意思是希望返回的数组仅包含文件还是包含文件和子目录。

如果您需要过滤掉目录，可以通过使用 a 轻松完成`FileFilter`：

```
File[] list = new File(".").listFiles(new FileFilter() {
    @Override
    public boolean accept(File file) {
        return file.isFile();
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T17:58:03.220

经过快速的[谷歌搜索](http://www.javaprogrammingforums.com/java-programming-tutorials/3-java-program-can-list-all-files-given-directory.html)后，我发现了这个：

```
import java.io.File;

public class ListFiles 
{

 public static void main(String[] args) 
{

  // Directory path here
  String path = "."; 

  String files;
  File folder = new File(path);
  File[] listOfFiles = folder.listFiles(); 

  for (int i = 0; i < listOfFiles.length; i++) 
  {

   if (listOfFiles[i].isFile()) 
   {
   files = listOfFiles[i].getName();
   System.out.println(files);
      }
  }
}
} 
```

那应该行得通。

# maven - 使用 Maven 进行 Jar 组装时如何排除某些 Jar 依赖项

> ID：15531158
> 
> 赞同：11
> 
> 时间：2013-03-20T17:53:50.760
> 
> 标签：maven, jar, maven-assembly-plugin

StackOverflow 上有一些看起来非常相似的问题，但我找不到任何有效的问题。

现在，我正在尝试从构建的 Jar 中删除 log4j。

虽然我是 Maven 的新手，而且我确信这一切都错了，但这就是我正在尝试的。

pom.xml：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.icf.onecpd</groupId>
    <artifactId>pdfgen</artifactId>
    <version>1.1</version>
    <packaging>jar</packaging>

    <name>PDF Generator</name>
    <url></url>

    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    </properties>

    <dependencies>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>3.8.1</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>com.itextpdf</groupId>
            <artifactId>itextpdf</artifactId>
            <version>5.2.0</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>1.2.17</version>
            <scope>runtime</scope>
        </dependency>
    </dependencies>
    <build>
        <plugins>
            <plugin>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <executions>
                    <execution>
                        <id>default-compile</id>
                        <configuration>
                            <source>1.6</source>
                            <target>1.6</target>
                        </configuration>
                        <phase>compile</phase>
                        <goals>
                            <goal>compile</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <artifactId>maven-assembly-plugin</artifactId>
                <configuration>
                    <descriptors>
                        <descriptor>assembly.xml</descriptor>
                    </descriptors>
                    <descriptorRefs>
                        <descriptorRef>jar-with-dependencies</descriptorRef>
                    </descriptorRefs>
                </configuration>
            </plugin>
        </plugins>
    </build>
    <scm>
        <url>https://svn.tms.icfi.com/svn/HUD/onecpd/income_calculator_pdf_generator</url>
    </scm>
</project> 
```

程序集.xml：

```
<assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2 http://maven.apache.org/xsd/assembly-1.1.2.xsd">
    <dependencySets>
        <dependencySet>
            <excludes>
                <exclude>log4j:log4j:*</exclude>
            </excludes>
        </dependencySet>
    </dependencySets>
</assembly> 
```

组装：单个日志：

```
[INFO] Scanning for projects...
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building PDF Generator 1.1
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-assembly-plugin:2.2-beta-5:single (default-cli) @ pdfgen ---
[INFO] Reading assembly descriptor: assembly.xml
[INFO] META-INF/MANIFEST.MF already added, skipping
[INFO] META-INF/ already added, skipping
[INFO] META-INF/maven/ already added, skipping
[INFO] Building jar: /home/jamie/workspace_ruby2/onecpd_pdfgen/target/pdfgen-1.1-jar-with-dependencies.jar
[INFO] META-INF/MANIFEST.MF already added, skipping
[INFO] META-INF/ already added, skipping
[INFO] META-INF/maven/ already added, skipping
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 5.368s
[INFO] Finished at: Wed Mar 20 13:45:33 EDT 2013
[INFO] Final Memory: 8M/158M
[INFO] ------------------------------------------------------------------------ 
```

但是，生成的 Jar 最终会包含 /org/apache/log4j/ 类。

我该如何摆脱它们？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-20T18:09:16.093

您可以尝试将依赖项声明为提供的范围，例如

```
 <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.17</version>
        <scope>provided</scope>
    </dependency> 
```

# php - PHP exec() 无法运行 GhostScript

> ID：15531162
> 
> 赞同：3
> 
> 时间：2013-03-20T17:54:06.930
> 
> 标签：php, exec, mamp

我正在尝试使用一个需要 exec() GhostScript 的库，但它在我的 MAMP 服务器上没有这样做。我写了一小段代码来运行测试：

```
<?php 
$cmd = "...";
$output = array();
exec($cmd, $output)
echo $output[0];
?> 
```

首先，我设置`$cmd`为`'whoami'`它可以工作，并在 PHP 和终端（我的用户名）中给出相同的结果。

然后我尝试了`'/usr/texbin/latex --version'`它，它也很好用。

但是当我尝试使用时`'/opt/local/bin/gs --version'`，它会失败，而它在终端中工作。

在我看来，这既不是 PATH 问题，也不是 apache 授权问题（到目前为止我所读到的通常怀疑），所以我已经没有想法了。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-21T19:07:25.840

虽然几岁，但无论如何。我今天遇到了同样的问题（尝试在 Ubuntu 14.4 上使用 php exec() 运行 ghostscript，这意味着不是 mamp，而是需要单独安装 apache、php、tesseract、ghostscript 等），并设法通过创建一个 bash 来解决它我在其中运行带有参数的 gs 的 shell 脚本，然后使用 php exec() 运行 sh 脚本。

我的 bash shell 脚本中的行：

```
gs -dBATCH -dNOPAUSE -r300 -sDEVICE=jpeg -sOutputFile=/var/www/html/ykinv/jpg/${theFile} 
```

以及我的 php 脚本中的 php exec 行：

```
exec("sh pdf2jpgConversion.sh"); 
```

这些脚本都驻留在同一个文件夹中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-12T05:23:03.597

使用 exec() 或 shell_exec() 运行 Ghostscript 命令时，我遇到了类似的问题。我收到以下错误：

```
gs: /opt/lampp/lib/libtiff.so.5: no version information available (required by /usr/lib/x86_64-linux-gnu/libgs.so.9) gs: /opt/lampp/lib/libz.so.1: version `ZLIB_1.2.9' not found (required by /usr/lib/x86_64-linux-gnu/libpng16.so.16) 
```

设置 LD_LIBRARY_PATH 变量为我解决了这个问题。

```
<?php

$command = 'export LD_LIBRARY_PATH="' . $path_to_library_dir .'"; ' . $path_to_binary;
shell_exec($command);

?> 
```

在我的 Ubuntu 18.04 $path_to_library_dir 是 " `/usr/share/ghostscript/9.26/lib`" 并且 $path_to_binary 是 " `/usr/bin/gs`"

`gs --help` 您可以通过在终端中执行命令来验证库文件路径。用于验证 path_to_binary 的使用`which gs`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-04-27T13:05:25.730

`shell_exec`而不是`exec`为我工作

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-10-16T07:58:22.070

```
Try this.

ini_set('display_errors', 1);
$pdf='test.pdf';
$quality=90;
$res='300x300';
$exportName="pdf_export_" . time();
$exportPath=realpath(dirname(__FILE__))."/$exportName/fullres/%03d.jpg";

mkdir(realpath(dirname(__FILE__))."/$exportName");
mkdir(realpath(dirname(__FILE__))."/$exportName/fullres");

set_time_limit(900);
exec("'gs' '-dNOPAUSE' '-sDEVICE=jpeg' '-dUseCIEColor' '-dTextAlphaBits=4' '-dGraphicsAlphaBits=4' '-o$exportPath' '-r$res' '-dJPEGQ=$quality' '$pdf'",$output); 
```

# android - 自定义复选框样式

> ID：15531164
> 
> 赞同：1
> 
> 时间：2013-03-20T17:54:11.900
> 
> 标签：android, checkbox, styles

我在[http://android-holo-colors.com/](http://android-holo-colors.com/)上为我的 android 应用程序创建了一些样式。我已经下载了它并将其解压缩到我的 res 文件夹中，但我无法管理它来应用复选框的样式。这是我在自定义主题中所做的。

```
<style name="CustomTheme" parent="Theme.Sherlock.Light">
    ...
    <item name="android:checkboxStyle">@style/CheckBoxAppTheme</item>
    ...
</style> 
```

我应用的样式是由 android-holo-colors 生成的，所以我认为错误不应该是这种样式。有谁看到我做错了什么？顺便提一句。主题应用于应用程序。

**更新：**

为了更清楚，我也将发布该样式的代码。

```
<style name="CheckBoxAppTheme" parent="android:Widget.CompoundButton.CheckBox">
    <item name="android:button">@drawable/btn_check_holo_light</item>
</style> 
```

那里使用的drawable有一个看起来像这样的选择器：

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">

    <!-- Enabled states -->

    <item android:state_checked="true" android:state_window_focused="false"
          android:state_enabled="true"
          android:drawable="@drawable/btn_check_on_holo_light" />
    <item android:state_checked="false" android:state_window_focused="false"
          android:state_enabled="true"
          android:drawable="@drawable/btn_check_off_holo_light" />

    <item android:state_checked="true" android:state_pressed="true"
          android:state_enabled="true"
          android:drawable="@drawable/btn_check_on_pressed_holo_light" />
    <item android:state_checked="false" android:state_pressed="true"
          android:state_enabled="true"
          android:drawable="@drawable/btn_check_off_pressed_holo_light" />

    <item android:state_checked="true" android:state_focused="true"
          android:state_enabled="true"
          android:drawable="@drawable/btn_check_on_focused_holo_light" />
    <item android:state_checked="false" android:state_focused="true"
          android:state_enabled="true"
          android:drawable="@drawable/btn_check_off_focused_holo_light" />

    <item android:state_checked="false"
          android:state_enabled="true"
          android:drawable="@drawable/btn_check_off_holo_light" />
    <item android:state_checked="true"
          android:state_enabled="true"
          android:drawable="@drawable/btn_check_on_holo_light" />

    <!-- Disabled states -->

    <item android:state_checked="true" android:state_window_focused="false"
          android:drawable="@drawable/btn_check_on_disabled_holo_light" />
    <item android:state_checked="false" android:state_window_focused="false"
          android:drawable="@drawable/btn_check_off_disabled_holo_light" />

    <item android:state_checked="true" android:state_focused="true"
          android:drawable="@drawable/btn_check_on_disabled_focused_holo_light" />
    <item android:state_checked="false" android:state_focused="true"
          android:drawable="@drawable/btn_check_off_disabled_focused_holo_light" />

    <item android:state_checked="false"
          android:drawable="@drawable/btn_check_off_disabled_holo_light" />
    <item android:state_checked="true" 
          android:drawable="@drawable/btn_check_on_disabled_holo_light" />

</selector> 
```

那里使用的所有可绘制对象都是 .png 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T18:47:11.543

您是否在 AndroidManifest.xml 更改了您的应用主题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-04T09:17:59.590

你确定你的文件放在好的文件夹中吗？

注意：*注意不要将“drawable-XXX”文件夹与“mipmap-XXX”文件夹（包含应用程序的图标）混淆。*

# javascript - Knockout JS foreach 数据绑定和嵌套元素

> ID：15531173
> 
> 赞同：2
> 
> 时间：2013-03-20T17:54:29.830
> 
> 标签：javascript, knockout.js

我有一个列表，我想生成一个包含图标和文本的链接：

```
<li><a><img src="icon.png" /> name</a></li> 
```

所以理想情况下，设置看起来像：

```
<ul data-bind="foreach: list">
    <li>
        <a data-bind="text: name, click: openNavItem"><img data-bind="attr: { src: icon }" /></a>
    </li>
</ul> 
```

然后我通过：

```
list.push({ name: "name", icon: "theicon.png" }); 
```

[JS 小提琴示例](http://jsfiddle.net/t6CUq/)

这不起作用，因为 'a data-bind="text: name, ..."' 会覆盖图像。

那有意义吗？有没有什么好方法可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T17:58:30.217

像这样定义一个链接怎么样？

`<a href="#"><img data-bind="attr: { src: icon }" /><span data-bind="text: name" /></a>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T18:14:16.367

您可以使用淘汰赛的容器少语法来实现这一点。

```
<ul data-bind="foreach: list">
    <li>
        <a><img data-bind="attr: { src: icon }" />
        <!--ko text: name--><!--/ko-->
        </a>
    </li>
</ul> 
```

# windows-phone-7 - 如何在 PhoneGap/Cordova 上开发时运行一些本机代码？

> ID：15531180
> 
> 赞同：0
> 
> 时间：2013-03-20T17:54:46.587
> 
> 标签：windows-phone-7, cordova, push-notification, mpns

我正在开发一个 PhoneGap/Cordova WP7 应用程序。

我需要这个应用程序，启用推送通知但是还没有插件。

我在 C# 中编写了“本机”代码，用于注册到我的服务器以进行推送等。

现在我想在我的 PhoneGap/Cordova 项目中使用这个代码。我可以让这部分代码运行，而不必为其制作自定义插件吗？

如果没有，任何人都可以帮助我如何为它制作插件吗？我已经完成了所有不到 50 行的本机代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T19:17:27.993

您可以制作一个插件来使用 phonegap 应用程序的推送通知代码。

[链接](http://docs.phonegap.com/en/2.5.0/guide_plugin-development_windows-phone_index.md.html#Developing%20a%20Plugin%20on%20Windows%20Phone)到使用 phonegap 的 windows phone 官方插件开发指南。

# javascript - 如何使用父/子在javascript中选择正确的div

> ID：15531184
> 
> 赞同：2
> 
> 时间：2013-03-20T17:54:49.253
> 
> 标签：javascript, jquery, css, class, html

我有几个不同的 div 看起来都像这样。

```
$(document).ready(function() {
  $(".show").click(function() {
    $(".show").parent().(".text").toggle();
  });
});

<div class="container #{i}">
    <div class="show">
        show
    </div>

    <div class="text">
        text text text
    </div>
</div> 
```

我希望能够单击显示，并让它只在其容器 div 中切换文本 div。我想我可以用我点击的类“show”来获取元素的父类，这将是容器+索引，然后在该容器 div 中获取名为“text”的子类。

老实说，这感觉相当微不足道，但我在 Javascript 方面还不是很有经验，而且我不确定要搜索的措辞。我将不胜感激任何帮助。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T17:58:10.127

有查找功能

```
$(document).ready(function() {
  $(".show").click(function() {
    $(this).parent().find(".text").toggle();
  });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T17:59:42.947

您可以使用该`siblings`函数获取/过滤同一级别的元素：

```
jQuery('.show').click( function () {
   jQuery(this).siblings('.text').toggle(); 
}); 
```

更多信息：[http ://api.jquery.com/siblings/](http://api.jquery.com/siblings/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T18:00:28.073

您非常接近，您只需要在父级上调用“查找”并替换`.show`选择器，`this`因为您只想切换`.text`当前（此）父级内部的 div，而不是全面切换。所以你需要这样的东西：

```
$(document).ready(function() {
  $(".show").click(function() {
    $(this).parent().find(".text").toggle(); //replaced .show for this
  });
}); 
```

或另一种选择（尽管其他人已经发布了）

```
$(".show").siblings(".text").toggle(); 
```

但是，要使上述方法起作用，两个 div（.show 和 .text）必须处于同一级别，而`find`, 即使`.text`嵌套在另一个元素中也会找到它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T17:59:10.897

你不应该抓住父母......

```
$('.show').click(function() {
    $(this).next().toggle()
}); 
```

应该管用。只是抓住了兄弟姐妹。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T18:00:22.893

你可以在 .click 函数中试试这个

```
$(this).parent().find("text").toggle(); 
```

# ios - 内存警告/崩溃，但不在 Instruments 中

> ID：15531188
> 
> 赞同：0
> 
> 时间：2013-03-20T17:55:14.120
> 
> 标签：ios, memory-management, memory-warning

我正在开发一个包含可导航 3d 地图的 iOS 应用程序。我有一个平铺/细节级别的策略，可以根据需要将纹理输入和输出，并根据高度图构建/释放地图几何图形。

不可避免地，在地图上平移后，尤其是在旧硬件上，我收到内存警告，然后应用程序退出。

所以，这本身并不奇怪。我的问题是在这个特定情况下追踪问题：

*   内存占用似乎相当不错（在 iPad 1 上峰值约为 11MB，平均约为 7MB 活动字节），Instruments 告诉我没有内存泄漏。（使用堆标记多次检查）
*   但最令人惊讶的是：**我无法让它真正崩溃或在 Instruments 中给我一个内存警告**。当然，这使得追踪变得非常困难！

有没有人见过这个？

**编辑**：由于所有的流媒体，它可能是碎片吗？如果是这样，我可以在 iOS 上做些什么？

# html - Firefox 中的图像缩放问题

> ID：15531189
> 
> 赞同：0
> 
> 时间：2013-03-20T17:55:14.570
> 
> 标签：html, css, media-queries

我正在尝试根据浏览器高度缩放图像。

它似乎在 Chrome 和 Safari 中工作，但是当我在 Firefox 中检查它时，图像只是保持原来的大小。

这是我到目前为止的代码。

HTML：

```
<div class="full-width">
    <div class="image-wrapper">
        <div class="images">
            <img src="http://farm8.staticflickr.com/7165/6840151639_b31263de71_b_d.jpg" />
            <img src="http://farm8.staticflickr.com/7165/6840151639_b31263de71_b_d.jpg" />
        </div>
    </div>
</div> 
```

CSS：

```
.full-width {
    height: 100%;
    width: 100%;
    position: absolute;
}

.image-wrapper {
    position: absolute;
    right: 0;
    width: 50%;
    height: 55%;
    margin-right: 15px;
}

.images {
    position: absolute;
    right: 0;
}

.image-wrapper img {
    display: block;
    height: auto;
    max-height: 50%;
    width: auto\9; /* ie8 */
} 
```

您可以在这里查看一个工作示例：http: [//jsfiddle.net/Pywak/](http://jsfiddle.net/Pywak/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:02:32.463

当您调整浏览器大小或屏幕分辨率发生变化时，`position:absolute;`不`position:relative;`使用父容器总是会让您陷入困境。

我建议您将它们用作背景图像而不是 img 标签，然后使用`background:contain;`|| `background:cover;`财产。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-27T01:09:53.733

我只是在解决同样的问题！

由于百分比是相对于父元素的，因此直接父元素具有明确指定的高度是关键。因此，`.images`应该指定一个高度，以便其子项按百分比正确调整大小。

您还可以使用`vh`单位（相对于视口高度）调整高度，但要小心并使用后备，因为 vh 并非与所有浏览器兼容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T17:58:47.580

您所有的绝对定位都会破坏比例大小的计算。您的元素之间不再存在父/子关系。

# mysql - 用于在 mysq 中存储 id 列表的好的列类型是什么？

> ID：15531192
> 
> 赞同：0
> 
> 时间：2013-03-20T17:55:21.987
> 
> 标签：mysql, list

什么是用于存储 id 列表的好列类型。

例如我想存储 10,50,100,65456,9,102346,546465

存储此类列表的最佳方式是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:01:57.183

不要将其保存为 csv，因为搜索速度很慢。我通常会保留一个映射表，例如

```
| parent_id | linked_id | status 
```

以 parent_id、linked_id 作为主键/唯一键。这使您的所有查询快速。

如果您坚持使用 csv 本身，您可以使用 varchar(100) 并随后`find_in_set`搜索列表中的特定 id（不使用索引）

喜欢

学校

```
School_id | name 
```

科目

```
Subject_id | name 
```

链接表

```
School_id | Subject_id | Status 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T17:57:26.213

您想使用另一个表来存储该数据。如果您希望将数据存储为

```
ID   idlist
1    10,50,100,65456,9,102346,546465 
```

创建一个额外的表并省去自己的麻烦

```
ID newid
1  10
1  500
1  100
1  65456
1  9
1  102346
1  546465 
```

# java - 当值为真时，是否有更快的打印“是”的方法？

> ID：15531194
> 
> 赞同：2
> 
> 时间：2013-03-20T17:55:24.143
> 
> 标签：java, if-statement, system.out

如果airCon字段airCon为真，方法printDetails它的打印结果是yes，但我认为这不是完美的方法，那么还有其他方法吗？

```
public class Auto
{
    private boolean airCon;
    public Auto() {}
    public void setAirCon(boolean airCon) {
        this.airCon = airCon;
    }

    public void printDetails() {
        String con;
        if(airCon) {
            con = "Yes";
        } else {
            con = "No";
        }
        System.out.println(con);    
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T17:57:44.007

尝试三元：

```
System.out.println(aircon ? "Yes" : "No"); 
```

三元表达式非常适合根据条件将某些值分配给一个值或另一个值，所有这些都在一行中。你也可以嵌套它们：

```
bool isConditionTrue, areYouSure;
string answer = isConditionTrue ? areYouSure ? "Yes" : "No" : "No"; 
```

带括号更容易阅读：

```
string answer =  isConditionTrue ? (areYouSure ? "Yes" : "No") : "No"; 
```

因此仅当**isConditionTrue**布尔值为真时， **areYouSure布尔值才会被读取。**

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T17:56:57.403

另一种方法是使用三元运算符：

```
String con = airCon ? "yes" : "no"; 
```

相同的效果，更少的代码。

PS您当然可以将整个表达式移动到`println()`if 您需要做的就是打印它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-20T17:57:05.163

这是一个非常好的方法，如果你想保存行虽然你可以使用三元语句

```
System.out.println(aircon ? "Yes" : "No"); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-20T17:57:10.840

这似乎完全没问题。代码有点长，但这不一定是坏事。

你可以使用一个方便的 Java 技巧来简化它：

```
public void printDetails()
{
    System.out.println(airCon ? "Yes" : "No");
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T18:03:01.893

你说得对。虽然您的代码有点冗长，但最好按照您的理解进行。您可以使用条件语句：

```
System.out.println((airCon) ? "Yes": "No") 
```

这做同样的事情。

但是，如果您想在应用程序的其他区域使用它，我会定义一个实用程序方法。

```
public static String getYesNo(boolean input) {
   return ((input) ? "Yes": "No");
} 
```

在这里最好将“是”和“否”字符串设为公共静态最终结果，以便它们充当常量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-20T18:04:14.297

或者你可以使用它，为你节省一个 else：

```
public void printDetails()
{
String con = "No";
if(airCon)
{
    con = "Yes";
}
System.out.println(con);

} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-20T17:58:51.250

使用三元运算符。

```
String con=airCon?"yes":"no" 
```**

# dynamics-crm-2011 - 关联联系人的电话号码未更新-CRM 2011 Online

> ID：15531197
> 
> 赞同：0
> 
> 时间：2013-03-20T17:55:30.063
> 
> 标签：dynamics-crm-2011, dynamics-crm-online

我正在尝试更新帐户实体的所有关联联系人的电话号码。以下是我使用的代码，

```
public class Plugin:IPlugin
{
    public void Execute(IServiceProvider serviceProvider)
    {
        IPluginExecutionContext context = (IPluginExecutionContext)
        serviceProvider.GetService(typeof(IPluginExecutionContext));

        Entity entity;

        if (context.InputParameters.Contains("Target") &&
        context.InputParameters["Target"] is Entity)
        {

            entity = (Entity)context.InputParameters["Target"];

            if (entity.LogicalName != "account") { return; }
        }
        else
        {
            return;
        }

        try
        {
            string telephoneNum = string.Empty;
            IOrganizationServiceFactory serviceFactory =(IOrganizationServiceFactory)serviceProvider.GetService(typeof(IOrganizationServiceFactory));
            IOrganizationService service =serviceFactory.CreateOrganizationService(context.UserId);

            var id = (Guid)context.OutputParameters["id"];
            telephoneNum = entity.GetAttributeValue<string>("telephone1");
            UpdateContact(service, id,telephoneNum);
        }
        catch (FaultException<OrganizationServiceFault> ex)
        {
            throw new InvalidPluginExecutionException(
            "An error occurred in the plug-in.", ex);
        }
    }

    private static void UpdateContact(IOrganizationService service, Guid id,string telephoneNUm)
    {
        using (var crm = new XrmServiceContext(service))
        {

            var res = from c in crm.CreateQuery("contact")
                      where c["parentcustomerid"].Equals(id)
                      select c;

            foreach (var c in res)
            {
                Entity e = (Entity)c;
                e["telephone1"] = telephoneNUm;
                crm.UpdateObject(e);
            }

            crm.SaveChanges();
        }
    }
} 
```

我在更新时注册了插件，并且主要实体“帐户”但是每当我在电话字段中更改号码后尝试保存帐户表格时，我都会看到一个错误弹出。我错过了什么吗？谢谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:13:56.500

只是一种预感..但我认为您以错误的方式获取 Id..尝试通过以下方式获取它：

```
Guid Id = context.PrimaryEntityId 
```

但正如佩德罗建议的那样..您需要查看确切的错误是什么或尝试使用附加到进程来调试插件..

# pascal - 3 个矩阵中哪一个具有最大的元素数总和（FreePacal）？

> ID：15531199
> 
> 赞同：-1
> 
> 时间：2013-03-20T17:55:42.397
> 
> 标签：pascal, freepascal

我有一个程序输出 3 个（4x4）矩阵（不同的数字，相同的布局）

而且我必须再次输出矩阵，其中元素数总和最大。

例如 65 是最大的元素数总和。

```
1 2 3 4  10        1 2 3 4  10        1 1 1 1  4
5 6 7 8  26        2 3 4 5  14        2 2 2 2  8
9 1 2 3  15        3 4 5 6  18        3 3 3 3  12
2 3 4 5  14        4 5 6 7  22        4 4 4 4  16

         65                 64                 40 
```

生成 3 个随机矩阵的程序：

```
uses
  SysUtils;

var
  i: integer;
  x: integer;
  y: integer;
  matrix: array[1..4, 1..4] of integer;

begin
  randomize;

  for i := 1 to 3 do
  begin
    for x := 1 to 4 do
      for y := 1 to 4 do
        matrix[x, y] := random(101);

    for x := 1 to 4 do
    begin
      for y := 1 to 4 do
        write(IntToStr(matrix[x, y]), ' ');
      writeln;
    end;
    writeln;
  end;
  readln;
end. 
```

你能帮助我吗？我将非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:19:46.243

例如可能是这种方式：

```
program Project1;

uses
  SysUtils;

// create a type for the matrix
type
  TMatrix = array[1..4, 1..4] of Integer;

var
  I: Integer;
  X: Integer;
  Y: Integer;
  CurSum: Integer;
  MaxIdx: Integer;
  MaxSum: Integer;
  Matrices: array[1..3] of TMatrix;
begin
  // initialize random seed
  Randomize;
  // initialize max. sum matrix index and max. matrix sum
  MaxIdx := 0;
  MaxSum := 0;
  // iterate to create 3 matrices
  for I := 1 to 3 do
  begin
    // initialize sum value of this matrix to 0
    CurSum := 0;
    // iterate to fill the matrices with random values
    for X := 1 to 4 do
      for Y := 1 to 4 do
      begin
        // to the matrix I assign a random value to the X, Y position
        Matrices[I][X, Y] := Random(101);
        // add this random value to the current matrix sum value
        CurSum := CurSum + Matrices[I][X, Y];
      end;
    // check if this matrix sum value is greater than the stored one
    // and if so, then...
    if CurSum > MaxSum then
    begin
      // store this matrix index
      MaxIdx := I;
      // and store this matrix sum as a max sum value
      MaxSum := CurSum;
    end;
    // print out this matrix
    for X := 1 to 4 do
    begin
      for Y := 1 to 4 do
        Write(IntToStr(Matrices[I][X, Y]), ' ');
      WriteLn;
    end;
    WriteLn;
  end;
  // print out the index of the matrix with max sum and its sum value
  WriteLn;
  WriteLn('The biggest matrix is the ' + IntToStr(MaxIdx) + '. one. The sum ' +
    'of this matrix is ' + IntToStr(MaxSum) + '.');
  WriteLn;
  // and print out that matrix with max sum value
  for X := 1 to 4 do
  begin
    for Y := 1 to 4 do
      Write(IntToStr(Matrices[MaxIdx][X, Y]), ' ');
    WriteLn;
  end;

  ReadLn;
end. 
```

# php - 从 print_r() 的输出中删除字符串“Array”

> ID：15531201
> 
> 赞同：2
> 
> 时间：2013-03-20T17:55:46.763
> 
> 标签：php, arrays, string, formatting

如何从打印输出中删除字符串“Array” `print_r()`？我尝试过使用字符串替换，但没有奏效。

示例输出：

```
 Array ( 
       [0] => Array (
               [id] => Classify318721363801824
               [classification] => 
                  Array ( 
                        [0] => Array ( 
                                    [Klasifikasi] => NonOpini 
                                    [Nilai] => 0.999946 ) 
                        [1] => Array ( 
                                    [Klasifikasi] => Opini 
                                    [Nilai] => 5.43418e-005 ) ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:01:36.840

将`return flag`(secont func arg) 设置`TRUE` 为`print_r()`函数以将数组打印作为字符串返回，而不是使用 str_replace 替换您想要的任何内容。

```
echo str_replace('Array','',print_r($arr,true)); 
```

我想您还想替换不需要的新行。这是我自己的函数，可以很好地打印数组。

```
function aprint($arr, $return = false) {
    $wrap = '<div style=" white-space:pre; position:absolute; top:10px; left:10px; height:200px; width:100px; overflow:auto; z-index:5000;">';
    $wrap = '<pre>';
    $txt = preg_replace('/(\[.+\])\s+=>\s+Array\s+\(/msiU','$1 => Array (', print_r($arr,true));

    if ($return) return  $wrap.$txt.'</pre>';
    else echo $wrap.$txt.'</pre>';
} 
```

# open-source - 如何为专有游戏授权我的开源游戏引擎

> ID：15531202
> 
> 赞同：0
> 
> 时间：2013-03-20T17:55:47.713
> 
> 标签：open-source, licensing

我正在开发一款基于我自己的游戏引擎的益智游戏。我的目的是让游戏引擎开源（包括一些演示），而游戏本身（关卡、纹理、关卡编辑器……）是有偿的。
让我担心的是我应该使用哪种类型的游戏引擎许可证？

我认为这类似于 1999 年在 GPL 许可下重新发布的原始 DOOM 源代码。你可以用它做任何你想做的事情，但如果你想玩原始游戏，你需要一个`DOOM.WAD`文件，你只能通过购买原始游戏才能合法获得。

那么，我可以使用 GPL 吗？我认为这意味着所有基于它构建的软件都必须保持 GPL。但也许就我而言，这并不重要，因为我不会对独立游戏引擎中的引擎进行更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:27:56.223

**伊纳尔**

仅当您将非 GPL 代码与 GPL 代码链接时，GPL 才适用。使用该软件不会影响您更改许可证的义务（例如，使用 GCC 编译的代码不必是 GPL）。

我建议执行以下操作之一：

*   双许可游戏引擎 GPL 和专有
    *   在将游戏引擎与游戏本身打包时给自己专有许可
*   许可游戏引擎 LGPL
    *   可以将您的游戏引擎链接到您的游戏中，而无需开源游戏

如果您的“游戏”仅包含关卡包和其他资源（没有与游戏引擎链接的代码），则 GPL 完全可以。

作为作者，您目前拥有源代码的所有权利。如果您使用他人拥有版权的代码，则您不能根据专有许可重新许可该代码。

# resharper - 是否有 Resharper 命令来查找变量的设置位置？

> ID：15531204
> 
> 赞同：8
> 
> 时间：2013-03-20T17:55:54.237
> 
> 标签：resharper

当我调试代码时，如果我必须找到设置变量的位置，我会对该变量进行文本搜索。如果有一个 resharper 命令可以转到设置变量的代码行，那将为我节省很多时间。有谁知道 resharper 是否提供此功能？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-20T21:24:37.280

除此之外，`Find usages`您还可以右键单击并选择`Inspect -> Value origin`。它仅显示写入值的位置，并允许您进一步扩展它们，显示分配值的来源。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-20T17:56:48.653

右键单击变量名称，然后选择`Find Usages`。在弹出的窗口中，您应该能够看到它是如何使用的。工具栏中有各种过滤选项。

# html - 使用滚动效果移动背景

> ID：15531208
> 
> 赞同：0
> 
> 时间：2013-03-20T17:56:01.780
> 
> 标签：html, css

如果我希望背景和内容滚动到横幅 img 而不是导航上，我正在对带有背景的内容使用滚动效果。

我遇到的问题是正文背景没有随内容移动，在单独的 div 上创建背景的问题是，当页面不是全屏高度时，它会在页脚下方留下空白背景。

这是小提琴[http://jsfiddle.net/ThAv5/](http://jsfiddle.net/ThAv5/)

HTML

```
<body>
<div id="navBar"></div> 
<div id="headerBar"></div>
<div id="mainContent"><h1>This is the main content, the yellow background is not scrolling with the text</h1></div> 
```

CSS

```
#navBar{
position:fixed;
top: 0;
left:0;
width: 100%;
z-index:1000;
-moz-box-shadow: 0 0 5px #000000;
-webkit-box-shadow: 0 0 5px #000000;
box-shadow: 0 0 5px #000000;
    background:red;
    height:50px;
}

 #headerBar{
top: 0;
height: 250px;
left: 0;
right: 0;
margin:0px auto;
width:100%;
position: fixed;
z-index:-1000;
    background:blue;
 }

  #mainContent{
overflow: auto;
z-index: 0;
margin-top: 250px;
    width:100%;
     height:900px;
  }

  body{
     background:yellow;
    } 
```

提前感谢乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:00:47.493

除非我遗漏了一些东西，否则您只需要`position to relative`更改`#headerBar`

[http://jsfiddle.net/ThAv5/2/](http://jsfiddle.net/ThAv5/2/)

```
#headerBar{
    top: 0;
    height: 250px;
    left: 0;
    right: 0;
    margin:0px auto;
    width:100%;
    position: relative;
    z-index:-1000;
    background:blue;
} 
```

# css - 缩小网页时如何填充 100% 的视口？

> ID：15531215
> 
> 赞同：1
> 
> 时间：2013-03-20T17:56:29.917
> 
> 标签：css, viewport

我有一个根据浏览器窗口大小从 1 缩小到 0.5 的网页。现在在我的页面上，我有一个 div 内的小方块，我希望它位于整个页面的中心。所以我需要实现的是给 div 一个填充 100% 浏览器宽度的宽度。使用类似的东西`width:100%`不会给出我正在寻找的结果，因为它将宽度设置为浏览器窗口的宽度（即 1600 像素）。但是随着我的页面缩小，1600px 会太小。所以然后我尝试做类似的事情：

```
$square.css('width', (viewportWidth*negscale) + 'px'); 
```

在哪里`negscale`，`3-(2*scale)`例如，如果我将页面缩放到 0,5（这意味着它是大小的一半），则为`negscale`2，因此正方形的宽度将是视口宽度的 2 倍。现在奇怪的部分是，对于 0,5 和 1，它工作得非常好，但是对于 div 宽度之间的每个比例，它都太大了。我真的想不出为什么会这样。

有谁知道我做错了什么，或者有另一种方法来找出 div 必须有多宽才能填充 100% 的视口？

# c# - 无法在 C# 中使用 Zedgraph 绘制图形

> ID：15531219
> 
> 赞同：2
> 
> 时间：2013-03-20T17:56:38.313
> 
> 标签：c#, zedgraph

我需要在 c# 中使用 zedgraph 绘制图形，但不起作用。

我的代码：

变量：

```
double x1, x2; 
```

事件`button1_Click`处理程序：

```
private void button1_Click(object sender, EventArgs e) {
  double a, b, c, dl;
  a = float.Parse(textBox1.Text);
  b = float.Parse(textBox2.Text);
  c = float.Parse(textBox3.Text);
  dl = (b * b) - (4 * a * c);
  if (dl < 0) {
    MessageBox.Show("Error");
  } else if (dl > 0) {
    x1 = (-b - Math.Sqrt(dl)) / (2 * a);
    x2 = (-b + Math.Sqrt(dl)) / (2 * a);
    textBox4.Text = x1.ToString();
    textBox5.Text = x2.ToString();
  } else {
    string str = (b / (2 * a)).ToString();
    textBox4.Text = str;
    textBox5.Text = str;
  }
} 
```

事件`button2_Click`处理程序：

```
private void button2_Click(object sender, EventArgs e) 
{
  // This is to remove all plots
  zedGraphControl1.GraphPane.CurveList.Clear();

  // GraphPane object holds one or more Curve objects (or plots)
  GraphPane myPane = zedGraphControl1.GraphPane;
  PointPairList spl1 = new PointPairList();
  // Add cruves to myPane object
  LineItem myCurve1 = myPane.AddCurve("Equation", spl1, Color.Blue, SymbolType.None);
  myCurve1.Line.Width = 5.0F;
  myPane.Title.Text = "Graph";
  for (int i = -5; i < 8; i++) 
  {
    double y = (i - x1) * (i - x2);
    spl1.Add(i, y);
  }

  //I add all three functions just to be sure it refeshes the plot.   
  zedGraphControl1.AxisChange();
  zedGraphControl1.Invalidate();
  zedGraphControl1.Refresh();

} 
```

# android - Android：是否可以在 Android Accelerometer 上检测连续的向前和向后运动？

> ID：15531221
> 
> 赞同：1
> 
> 时间：2013-03-20T17:56:38.907
> 
> 标签：android, accelerometer

我正在制作一个需要我检测步行的应用程序。我能够检测到它。我只是将 deltaZ 和 deltaY 值用于加速度计和其他一些参数。

然而，用户可以通过简单地上下和前后移动来轻松地假装走路。

所以为了防止这种情况，我想如果我能检测到连续的前后运动，我会发现这是一个假的步骤。

我尝试读取原始加速度计值......但是它没有多大帮助。有人对此有任何想法吗？

PS：我已经尝试过计步器应用程序和 github 代码。他们很好地检测步骤。但我可以很容易地通过摇晃手机来伪装它们

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:45:09.647

您可以使用 GPS 来检测他们的位置，如果他们没有随着时间的推移改变位置，您可以使他们的步行无效。

# javascript - jquery mouseover 事件不起作用

> ID：15531223
> 
> 赞同：0
> 
> 时间：2013-03-20T17:56:42.693
> 
> 标签：javascript, jquery

我正在尝试使用来自 dynamicdrive.com 的 Show Hint 脚本在我的网站上显示表单错误。

目前错误显示为

```
 <span class="error">Error Message</span> 
```

当其中一个输入出现错误时。

我想使用显示提示脚本来显示此错误，然后我将不得不通过替换来编辑每个有错误的页面

```
 <span class="error">Error Message</span> 
```

和

```
 <span class="error erroranchor" onmouseover="showhint('Error Message Here', this, event, '200px')"></span> 
```

手动。

但是我想在这里为自己节省一些精力，这就是为什么我决定改用 JQuery，我是查询新手，这将是我的第一个编码学习，从逻辑角度来看，我认为 JQuery 将是最好的。这是我到目前为止所做的，但没有任何效果。

```
<script type='text/javascript'>
//On document ready.. I'm not sure if it should be document ready or document load.
    $(document).ready(function() {
//First i add the class "erroranchor" to <span class="error">
    $(".error").addClass("erroranchor");
//Then i've tried to convert the onmouseover event to JQuery mouseover event.
    $(".erroranchor").mouseover(showhint(){
//Here i try to get the "Error Message" from <span class="error">Error Message</span> so it can be displayed in the hint box.
        var $errortext = $(this);
        $errortext.text(),
        this.event,
        '200px'
    });
    });
</script> 
```

然后是我想要的完美工作的CSS..

```
.error {
    text-indent: -99999px;
}
.erroranchor {
    background: url(anchor.png);
} 
```

如果可以对上面的 JavaScript 进行任何改进，我将不胜感激（请使其易于理解）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T17:59:34.967

你的`mouseover`绑定是错误的。它应该是

```
$(".erroranchor").mouseover(function(){...}); 
```

请注意，它`function`不是`showhint`.

如果您想`showhint()`在代码的其他地方创建该函数作为它自己的函数，那么绑定将是

```
$(".erroranchor").mouseover(showhint); 
```

**编辑**
如果您想为每个 提供不同的错误消息`'.erroranchor'`，您可以使用 jQuery 的[`data()`](http://api.jqueryui.com/data-selector/)功能：

```
<span class="error erroranchor" data-errormessage="Error message here"></span>
<span class="error erroranchor" data-errormessage="Different error message here"></span> 
```

然后你的事件处理程序和函数：

```
$(".erroranchor").mouseover(showhint);

function showhint() {
    var errMsg = $(this).data('errormessage');
    if(errMsg) {
        //do stuff
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:00:36.923

尝试这个

```
$(".erroranchor").mouseover(function(){
         showhint();
}); 
```

# asp.net - IISConfigurator.exe crashes when running Azure app in the Dev Fabric

> ID：15531224
> 
> 赞同：0
> 
> 时间：2013-03-20T17:56:47.513
> 
> 标签：asp.net, azure, windows-8, visual-studio-2012, iis-express

If I attempt to run a new or existing azure app, IISConfigurator crashes and I receive a notification that roles are taking longer than expected to start. I'm running in VS2012 on Windows 8, using IIS Express 8 (and the azure project settings specify to use IIS Express).

I've looked at a similar question [here](https://stackoverflow.com/questions/11529489/windows-azure-application-crashes-iisconfigurator-exe), but the poster seems to be having a different problem based on their log file.

The following is from the IISConfiguratorLogs file, and seems to indicate that the WAS service is freezing up:

```
IISConfigurator Information: 0 : [00008536:00000001, 2013/03/20 16:54:20.352] Started iisconfigurator with args /start
IISConfigurator Information: 0 : [00008536:00000001, 2013/03/20 16:54:20.362] StartForeground selected. Check if an instance is already running
IISConfigurator Information: 0 : [00008536:00000001, 2013/03/20 16:54:20.388] Starting service WAS
IISConfigurator Information: 0 : [00008536:00000001, 2013/03/20 16:54:50.716] Timeout exception System.ServiceProcess.TimeoutException: Time out has expired and the operation has not been completed.
at System.ServiceProcess.ServiceController.WaitForStatus(ServiceControllerStatus desiredStatus, TimeSpan timeout)
at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.WebServiceManager.StartService(String name)
IISConfigurator Information: 0 : [00008536:00000001, 2013/03/20 16:54:50.718] Starting service w3svc
IISConfigurator Information: 0 : [00008536:00000001, 2013/03/20 16:54:51.809] Unhandled exception: IsTerminating 'True', Message 'System.InvalidOperationException: Cannot start service w3svc on computer '.'. ---> System.ComponentModel.Win32Exception: The dependency service or group failed to start
--- End of inner exception stack trace ---
at System.ServiceProcess.ServiceController.Start(String[] args)
at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.WebServiceManager.StartService(String name)
at System.Linq.Enumerable.WhereSelectListIterator`2.MoveNext()
at System.Linq.Enumerable.Aggregate[TSource](IEnumerable`1 source, Func`3 func)
at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.WebServiceManager.StartServices()
at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.IISConfigurator.Initialize()
at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.WCFServiceHost.Open()
at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.Program.StartForgroundProcess()
at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.Program.DoActions(String[] args)
at Microsoft.WindowsAzure.ServiceRuntime.IISConfigurator.Program.Main(String[] args)' 
```

I would appreciate any advice on what my next step should be. Thanks in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:46:42.650

You have something corrupted on your machine with IIS and it really doesn't have anything to do with Azure. If you try to manually start W3SVC or WAS service you should see a similar failure. It could be one of the config file (machine.config, applicationhost.config, etc) or something else such as a filesystem problem.

Check out [http://www.hanselman.com/blog/FixedWindowsProcessActivationServiceWASIsStoppingBecauseItEncounteredAnError.aspx](http://www.hanselman.com/blog/FixedWindowsProcessActivationServiceWASIsStoppingBecauseItEncounteredAnError.aspx) for some troubleshooting techniques and possible solution.

# c# - Moq 断言一个抽象方法被调用

> ID：15531227
> 
> 赞同：2
> 
> 时间：2013-03-20T17:56:49.370
> 
> 标签：c#, unit-testing, moq, autofixture

我正在使用 AutoFixture 为我的 Abstract 类编写单元测试，这代表了我正在尝试做的事情：

```
public abstract class Base
{
    public virtual void DoSomethingCool()
    {
        OnDoingSomethingCool();
    }

    protected abstract void OnDoingSomethingCool();
} 
```

我的单元测试看起来像这样：

```
[TestMethod]
public void TestMethod1()
{
    var fixture = new Fixture().Customize(new AutoMoqCustomization());

    var sut = fixture.Create<Base>();

    // How to assert that the OnDoingSomethingCool method was called
    sut.Invoking(x => x.DoSomethingCool())
        .ShouldNotThrow();
} 
```

那么我如何断言受保护的抽象方法实际上是在`DoSomethingCool`方法中调用的呢？

如果它是来自注入依赖项的对象，我将能够使用`Moq`并断言该方法已被调用，但由于该方法是**我的 Subject Under Test**中的抽象方法，我如何断言该方法被调用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T18:54:21.137

关于这一点可以说很多：

1.  看起来您可能要么测试太多，要么对其他实现给予太多控制。

    *   （过多的控制）通常，如果你想强制从你的另一个方法调用一个方法，`abstract class`你不要这样做`public virtual`。通过这样做，您使未来的实现能够改变这种行为。事实上，如果你去掉`virtual`，那么你可以得到你想要的测试（见下文）。我确实提供了一种保留 的方法`virtual`，但再次......不推荐。不建议这样做，因为您的 SUT 是您的模拟……感觉不对。
    *   （测试太多）你应该只关心基本行为，而不是实现细节，以免你的测试变得太脆弱。我假设不仅仅是对`OnDoingSomethingCool`方法的调用，否则你应该把它作为你的主要方法。如果主要行为是这个调用（并且不仅仅是这个调用），那么我会在`NotRecommended`下面的方法中介绍它。
2.  您不应该直接测试抽象类。您可能应该使用 Roy Osherove在[单元测试艺术中所说的](http://artofunittesting.com/)**抽象测试类模式**。这使得所有实现都可以测试您的行为。然后，您可以传入一个依赖项。如果您想要该示例甚至是**抽象测试类模式**的简化示例，请告诉我

 **/

```
using Moq.Protected;

...

public void NotRecommended_ProbablyTestingTooMuch_BrittleTestBelow
{
    //If you MUST keep DoSomethingCool virtual
    //var baseMock = new Mock<Base>{CallBase = true};
    var baseMock = new Mock<Base>();
    baseMock.Protected().Setup("OnDoingSomethingCool");

    baseMock.Object.DoSomethingCool();

    baseMock.Protected().Verify("OnDoingSomethingCool", Times.AtLeastOnce());
} 
```**

# jquery - JQuery UI 链接到带有 AjaxContent 的选项卡

> ID：15531228
> 
> 赞同：1
> 
> 时间：2013-03-20T17:56:51.053
> 
> 标签：jquery, jquery-ui, jquery-ui-tabs

我正在使用带有 2 个选项卡（一个普通选项卡和一个 ajax 选项卡）的 JQueryUI，如下所示：

```
<div class="g12 tab">
    <ul>
        <li><a href="#tab-general">GENERAL</a></li>
        <li><a href="/CONTENT/AJAX/">EXTERNAL</a></li>
    </ul>
    <div id="tab-general">CONTENT HERE</div>
</div> 
```

当我需要从外部页面打开第一个选项卡时，我只需输入#tab-general (www.mydomain.com/Page#tab-general)，它就可以正常工作。

如何从直接链接打开 ajax 选项卡？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:16:16.117

如果您使用的是 jQuery .tabs()，那么当您来自 ajax 时请尝试以下操作

```
$('#selectorId').tabs({ selected: 2}); 
```

# c++ - 在 C++ 中将 unsigned int 重新解释为浮点数

> ID：15531232
> 
> 赞同：1
> 
> 时间：2013-03-20T17:56:59.053
> 
> 标签：c++, casting, int

我有一个存储在无符号 __int32 中的浮点表示。我知道您可以重建数字字节移位，就像这个问题的答案中所指示的那样：

[在 C 中将 int 转换为浮点数（无强制转换）](https://stackoverflow.com/questions/12344400/convert-int-to-float-in-c-no-casting)

我想避免移位、乘法和求和，而只是重新解释这些位。我尝试了 IEEE 754 单精度条目的 Wikipedia 示例，但重新解释结果为 0。

这是我的代码：

```
unsigned __int32 integer = 0;   
unsigned __int32 mask = 0;
mask = mask + 1 << 30;
mask = mask + 1 << 29;
mask = mask + 1 << 28;
mask = mask + 1 << 27;
mask = mask + 1 << 26;
mask = mask + 1 << 22;
integer = integer ^ mask;
printf("%ld %d\n", integer, sizeof(__int32));
float* decimal = reinterpret_cast<float*>(&integer);
printf("%f", *decimal);
return 0; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:57:08.903

这里的问题很可能是您违反了严格的别名规则，因为两个不同类型的（非字符）指针指向相同的内存位置。

解决问题的最简单、最直接的方法就是`memcpy`字节（在断言整数和浮点类型的大小相同之后）：

```
float decimal = 0.0f;
memcpy(&decimal, &integer, sizeof(integer)); 
```

# python - 从函数中获取变量到列表中

> ID：15531237
> 
> 赞同：0
> 
> 时间：2013-03-20T17:57:08.050
> 
> 标签：python, json, twitter, rss

我试图让这个问题没有本地化，但由于我对 Python 的了解非常原始，请随时编辑它以使其更清晰！

Twitter 正处于放弃对包括 RSS 在内的 XML 支持的最后阶段，我正在努力通过解析 Twitter 提供的 json 并使用 PyRSS2Gen 获取输出来获得相同的行为。我以这个链接为例：[https ://github.com/dschep/Twitter-user_timeline.rss-proxy/blob/master/timeline_rss_proxy.py](https://github.com/dschep/Twitter-user_timeline.rss-proxy/blob/master/timeline_rss_proxy.py)

我实际上得到了它的工作，但转推的大部分时间都被截断了。但是可以使用`item['retweeted_status']['text']`而不是获取整个推文`item['text']`。我需要获取`item['text']`(^RT @username:) 的正则表达式部分并将其与`item['retweeted_status']['text']`.

所以我创建了一个名为“get_tweet_text”的函数，我想用这个函数的输出填充列表中**标题**和**描述**的值`items`，但是这个函数似乎被忽略了，所以我得到了错误：

```
Traceback (most recent call last):
  File "1.py", line 59, in <module>
    ) for item in feed
  File "/usr/lib/python2.7/dist-packages/PyRSS2Gen.py", line 397, in __init__
    "must define at least one of 'title' or 'description'")
TypeError: must define at least one of 'title' or 'description' 
```

这是完整的代码。我用 X 模糊了我的应用程序和用户键。`sys.argv[1]`指的是要下载其时间线的用户。请随时纠正您可能发现的更多错误:)

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

import sys, re, datetime, urlparse, json, PyRSS2Gen
import oauth2 as oauth

name = sys.argv[1]

consumer = oauth.Consumer(
    'XXXXXXXXXXXXXXXXXXXXXX',
    'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'
)
token = oauth.Token(
    'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX',
    'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'
)
client = oauth.Client(consumer, token)

resp, content = client.request(
    'http://api.twitter.com/1.1/statuses/user_timeline.json?screen_name=%s'
    % name,
    method='GET',
)
feed = json.loads(content)

link_tmpl = 'http://twitter.com/{user}/status/{id}'

def get_tweet_text(item):
#   try:
    text = '%s: %s %s' % (
        name,
        re.search('^RT @\w+:', item['text']).group(0),
        item['retweeted_status']['text']
    )
#   except:
#       text = item['text']

rss = PyRSS2Gen.RSS2(
    title = 'Twitter / {0}'.format(name),
    link = 'http://twitter.com/{0}'.format(
        feed[0]['user']['name'].encode('utf-8')
    ),
    description = feed[0]['user']['description'],

    lastBuildDate = datetime.datetime.now(),

    items = [
        PyRSS2Gen.RSSItem(
            title       = get_tweet_text(item),
            link        = link_tmpl.format(user=name, id=item['id']),
            description = get_tweet_text(item),
            guid        = PyRSS2Gen.Guid(link_tmpl.format(
                user=name, id=item['id']
            )),
            pubDate     = datetime.datetime.strptime(
                item['created_at'][:19] + item['created_at'][25:],
                '%a %b %d %H:%M:%S %Y'
            )
        ) for item in feed
    ]
)

print rss.to_xml() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:00:40.357

你不会从你的`get_tweet_text`函数中返回任何东西。你只需要`return text`最后。

# entity-framework - 实体框架数据库默认插入允许更新

> ID：15531240
> 
> 赞同：3
> 
> 时间：2013-03-20T17:57:13.847
> 
> 标签：entity-framework

有没有办法让实体框架在插入时使用 SQL 默认值，但允许更新到字段。我们有一个实例，其中一个 SQL 表有一个标识列“id”和另一个设置为 ident_current(“table”) 的列。我知道使用默认值插入字段的唯一方法是将字段设置为`DatabaseGenerated(DatabaseGeneratedOption.Computed)`在插入时忽略它。但是，通过拥有该属性，我们无法对列执行更新。它也是一个自引用外键，所以我们不能先插入然后立即更新来解决这个问题。不要问我为什么桌子是这样设计的——就像它之前的设置方式一样，所以我们现在有点坚持。我们的设置的简单图表如下：

域类：

```
Class1 {
     public int id {get;set;}
     [DatabaseGenerated(DatabaseGeneratedOption.Computed)]
     public int id2 {get;set;}
     public string Name {get;set;}
} 
```

SQL（伪）：

```
Table (
    id INT  which is an identity(1,1) column,
    id2 INT NOT NULL with a default value of ident_current("table")
    Name nvarchar(50)
) 
```

我们希望 EF 生成的插入语句是：

```
INSERT INTO Table(Name) VALUES('Name') 
```

更新为：

```
UPDATE table 
SET id2 = *somenumber*, name = 'Name' 
```

非常感谢所有的帮助。如果需要，我们也使用 EF 4.3.1.0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-05T18:16:25.557

没有办法AFAIK。看到[这个](https://data.uservoice.com/forums/72025-entity-framework-feature-suggestions/suggestions/2541076-allow-using-sql-server-2012-sequence-for-generatin)[那个](https://data.uservoice.com/forums/72025-entity-framework-feature-suggestions/suggestions/2929682-support-database-default-values-in-code-first)。_

第一个链接指向有关使用序列作为主键的建议，这似乎是您可能想要做的事情，而不是给定您的示例代码。

第二个链接指向有关默认值的通用处理的建议，目前也不支持，但将是添加对您需要的支持的另一个潜在起点。

# php - 从 php 调用 shell 命令的行为与在 shell 中不同

> ID：15531243
> 
> 赞同：1
> 
> 时间：2013-03-20T17:57:23.057
> 
> 标签：php, shell

我写了这个简单的 shell 脚本：

```
#!/bin/sh
STORAGE_PATH=/tmp/;
export STORAGE_PATH;
cd STORAGE_PATH;
perl /{SOME_PATH}/perl-script.pl; 
```

当我从 shell 调用它时，它可以按预期完美运行。但是从 PHP 中它无限挂起，并且在调试时，我发现它在 Perl 执行期间挂起，这实际上没有任何意义，因为如果它在 shell 中调用它会继续。

我对shebang有什么误解`#!/bin/sh`吗？我也试过`#!/bin/bash`了。

我尝试了 php: `exec`, `system`,的所有变体`shell_exec`，`callthru`但没有任何效果..

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:10:17.077

好吧，我看不出它在 shell 中是如何工作的。

您正在调用，但未定义`/{SOME_PATH}/perl-script.pl`变量。`SOME_PATH`你的意思是`STORAGE_PATH`？另外，您忘记了`$`之前的`{`.

当您使用它时，请检查运行网络服务器的用户是否有权执行这两个脚本。

# activemq - 代理的 ActiveMQ 网络不转发消息

> ID：15531244
> 
> 赞同：6
> 
> 时间：2013-03-20T17:57:24.477
> 
> 标签：activemq, failover

我有两个配置为存储转发网络的 ActiveMQ 代理（A 和 B）。当有一个消费者连接在代理 B 上并且生产者向 A 发送消息时，它们可以完美地将消息从 A 转发到 B。问题是，当消费者被杀死并重新连接到 A 时，B 上的排队消息（它们是从A）不会转发回消费者连接的A。即使我向 B 发送新消息，所有消息都停留在 B 上，直到我重新启动代理。我尝试在代理网络连接器上设置 networkTTL="4" 和 duplex="true"，但它不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-09-16T20:25:35.807

迟到的答案，但希望这会在未来对其他人有所帮助。

消息卡在 B 中是因为默认情况下 AMQ 不允许将消息发送回之前已传递到的代理。在正常情况下，这可以防止消息在类似网格的网络拓扑中循环而不被传递，但在故障转移情况下，它会导致消息卡在一个代理上并且无法到达所有消费者所在的代理。

如果当前代理因为没有消费者连接而处于死胡同，要允许消息返回到代理，您应该使用 replayWhenNoConsumers=true 来允许将卡在 B 上的消息转发回 A。

[http://activemq.apache.org/networks-of](http://activemq.apache.org/networks-of-brokers.html)的“Stuck Messages (version 5.6)”部分描述了该配置选项、您可能希望与其结合使用的一些设置以及使用它时的一些注意事项[-brokers.html](http://activemq.apache.org/networks-of-brokers.html)、[http://tmielke.blogspot.de/2012/03/i-have-messages-on-queue-but-they-dont.html](http://tmielke.blogspot.de/2012/03/i-have-messages-on-queue-but-they-dont.html)和[https://issues.apache.org/jira/浏览/AMQ-4465](https://issues.apache.org/jira/browse/AMQ-4465)。确保您可以忍受这些更改的副作用（例如，跨代理到代理网络连接的其他消息的重复消息传递的可能性）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T06:47:11.407

您能否提供有关代理 A 和 B 的配置的更多信息，以及您要实现的目标？

在我看来，您可以通过设置代理网络（带有 A 和 B）来实现您想要的，生产者只连接到一个，消费者连接到另一个。只要另一个代理对消息发送到的目的地有有效订阅，消息就会自动传输到另一个代理。

如果您不确定它产生的后果（它往往会导致不需要的消息循环），我不建议您更改 networkTTL。

# android - 没有“未知来源”复选框的 Android APK 分发？

> ID：15531245
> 
> 赞同：3
> 
> 时间：2013-03-20T17:57:25.867
> 
> 标签：android, installation, apk

我们正在尝试在 Google Play 之外分发我们的 Android 应用程序。有什么方法可以做到这一点，而无需强制用户通过设置应用程序并选中“允许未知来源”复选框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:23:41.583

> 有什么方法可以做到这一点，而无需强制用户通过设置应用程序并选中“允许未知来源”复选框？

如果他们安装了 Android SDK，他们可以通过 USB 数据线安装您的应用程序。

否则，他们必须选中该复选框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:28:14.083

除了 CommonsWare 的注释，还有另外一种安装方式。如果您可以让制造商签署您的应用程序，或者您可以通过某种方式让他们从他们的应用程序之一安装您的应用程序，那么您可以使用以下权限：

```
android.permission.INSTALL_PACKAGES 
```

但是，Android 不向 3rd 方应用程序提供此功能，因此上述两个确实是您唯一的选择。

# opencv - 如何将图像转换为灰色

> ID：15531249
> 
> 赞同：0
> 
> 时间：2013-03-20T17:57:33.620
> 
> 标签：opencv, xcode4.5

我是 OpenCV 的新手。我在图像转换方面遇到了一些问题。我创建了一个新项目。它还有 2 个文件 Wrapper.h/mm 和 UIImage+OpenCV.h/.mm。以下代码在这里：

```
//UIImage+OpenCV.h
#import <UIKit/UIKit.h>

@interface UIImage (OpenCV)

//cv::Mat to UIImage
+ (UIImage *)imageWithCVMat:(const cv::Mat&)cvMat;
+ (UIImage *)imageWithCVMat:(const cv::Mat&)cvMat
                orientation:(UIImageOrientation)orientation;

- (id)initWithCVMat:(const cv::Mat&)cvMat
        orientation:(UIImageOrientation)orientation;

//UIImage to cv::Mat
- (cv::Mat)CVMat;
- (cv::Mat)CVMat3;  // no alpha channel
- (cv::Mat)CVGrayscaleMat;

@end

//UIImage+OpenCV.mm
#import "UIImage+OpenCV.h"

@implementation UIImage (OpenCV)

-(cv::Mat)CVMat
{
    CGColorSpaceRef colorSpace = CGImageGetColorSpace(self.CGImage);
    CGFloat cols = self.size.width;
    CGFloat rows = self.size.height;

    cv::Mat cvMat(rows, cols, CV_8UC4); // 8 bits per component, 4 channels

    CGContextRef contextRef = CGBitmapContextCreate(cvMat.data,                 // Pointer to  data
                                                    cols,                       // Width of bitmap
                                                    rows,                       // Height of bitmap
                                                    8,                          // Bits per component
                                                    cvMat.step[0],              // Bytes per row
                                                    colorSpace,                 // Colorspace
                                                    kCGImageAlphaNoneSkipLast |
                                                    kCGBitmapByteOrderDefault); // Bitmap info flags

    CGContextDrawImage(contextRef, CGRectMake(0, 0, cols, rows), self.CGImage);
    CGContextRelease(contextRef);

    return cvMat;
}

- (cv::Mat)CVMat3
{
    cv::Mat result = [self CVMat];
    cv::cvtColor(result , result , CV_RGBA2RGB);
    return result;

}

-(cv::Mat)CVGrayscaleMat
{
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceGray();
    CGFloat cols = self.size.width;
    CGFloat rows = self.size.height;

    cv::Mat cvMat(rows, cols, CV_8UC1); // 8 bits per component, 1 channels

    CGContextRef contextRef = CGBitmapContextCreate(cvMat.data,                 // Pointer to data
                                                    cols,                       // Width of bitmap
                                                    rows,                       // Height of bitmap
                                                    8,                          // Bits per component
                                                    cvMat.step[0],              // Bytes per row
                                                    colorSpace,                 // Colorspace
                                                    kCGImageAlphaNone |
                                                    kCGBitmapByteOrderDefault); // Bitmap info flags

    CGContextDrawImage(contextRef, CGRectMake(0, 0, cols, rows), self.CGImage);
    CGContextRelease(contextRef);
    CGColorSpaceRelease(colorSpace);

    return cvMat;
}

+ (UIImage *)imageWithCVMat:(const cv::Mat&)cvMat
{
    return [[UIImage alloc] initWithCVMat:cvMat];
}

- (id)initWithCVMat:(const cv::Mat&)cvMat
{
    NSData *data = [NSData dataWithBytes:cvMat.data length:cvMat.elemSize() * cvMat.total()];
    CGColorSpaceRef colorSpace;

    if (cvMat.elemSize() == 1) {
        colorSpace = CGColorSpaceCreateDeviceGray();
    } else {
        colorSpace = CGColorSpaceCreateDeviceRGB();
    }

    CGDataProviderRef provider = CGDataProviderCreateWithCFData((__bridge CFDataRef)data);

    // Creating CGImage from cv::Mat
    CGImageRef imageRef = CGImageCreate(cvMat.cols,                                 //width
                                        cvMat.rows,                                 //height
                                        8,                                          //bits per component
                                        8 * cvMat.elemSize(),                       //bits per pixel
                                        cvMat.step[0],                              //bytesPerRow
                                        colorSpace,                                 //colorspace
                                        kCGImageAlphaNone|kCGBitmapByteOrderDefault,// bitmap info
                                        provider,                                   //CGDataProviderRef
                                        NULL,                                       //decode
                                        false,                                      //should interpolate
                                        kCGRenderingIntentDefault                   //intent
                                        );

    // Getting UIImage from CGImage
    self = [self initWithCGImage:imageRef];
    CGImageRelease(imageRef);
    CGDataProviderRelease(provider);
    CGColorSpaceRelease(colorSpace);

    return self;
}

@end 
```

上面的代码我在[这里](http://docs.opencv.org/doc/tutorials/ios/image_manipulation/image_manipulation.html#opencviosimagemanipulation)。

```
//Wrapper.h
#import <Foundation/Foundation.h>

@interface CVWrapper : NSObject
+(UIImage*) returnPic: (UIImage*)image;
@end

//Wrapper.mm
#import "CVWrapper.h"
#import "UIImage+OpenCV.h"

@implementation CVWrapper

+(UIImage*)returnPic:(UIImage *)image
{
    UIImage *result = nil;
    if (image)
    {
        cv::Mat matImage = [image CVMat];
        cv::Mat greyMat;                      //It doesn't' work
        cv::cvtColor(matImage, greyMat, 7);  //It doesn't work. In enum of imgproc.hpp COLOR_RGB2GRAY=7
        result = [UIImage imageWithCVMat:greyMat];

    }

    return result;
}

@end 
```

在 ViewController 中，我调用显示图像的函数。我试图理解一个基本概念。如何将图片转换为灰色？我必须在哪里做？

# python - PyPDF2 无法导入 pdf 文件头

> ID：15531250
> 
> 赞同：1
> 
> 时间：2013-03-20T17:57:33.870
> 
> 标签：python, header, pypdf

我使用 PyPDF2 将字符串中的 pdf 文件导入 python。问题是第一页的顶部不想被导入（.getPage(0).extracText() 错过了顶部）。

我想有一个标题属性，但我找不到它的名称，我在互联网上找不到任何信息。

你知道怎么做或我在哪里可以找到信息吗？

# emacs - 在描述函数/描述变量中缺少指向 lisp 源的链接

> ID：15531252
> 
> 赞同：3
> 
> 时间：2013-03-20T17:57:38.683
> 
> 标签：emacs, elisp

我习惯于 describe-function、describe-variable & co 的帮助缓冲区包含指向定义符号的 lisp 源的链接。我得到了我自己的库中定义的符号的链接。我安装了 Emacs 的 C 源代码，对于在那里定义的符号，我还获得了一个链接。但是，对于 Emacs 随附的标准 lisp 库中定义的符号，该链接已消失。我有 Ubuntu，并且安装了 emacs23-el 软件包。

# c++ - 测试向量的所有元素是否相等

> ID：15531258
> 
> 赞同：5
> 
> 时间：2013-03-20T17:58:00.433
> 
> 标签：c++

我想测试一个非空向量是否包含相同的元素。这是最好的方法吗？

```
count(vecSamples.begin()+1, vecSamples.end(), vecSamples.front()) == vecSamples.size()-1; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T18:01:40.977

在 c++11（或[Boost 算法](http://www.boost.org/doc/libs/1_50_0/libs/algorithm/doc/html/algorithm/CXX11.html)）中

```
std::all_of(vecSamples.begin()+1,vecSamples.end(),
          [&](const T & r) {return r==vecSamples.front();}) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T18:10:43.713

正如@john 正确指出的那样，即使前两个元素不同，您的解决方案也会迭代整个容器，这非常浪费。

纯粹的 no-boost 不需要 c++11 的解决方案怎么样？

```
bool allAreEqual = 
  find_if(vecSamples.begin() + 1, 
    vecSamples.end(), 
    bind1st(not_equal_to<int>(), vecSamples.front())) == vecSamples.end(); 
```

在找到的第一个不相等元素处停止。在运行之前确保你的 vecSamples 是非空的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T17:59:45.380

可能不会，因为它总是检查向量的所有元素，即使前两个元素不同。就我个人而言，我只想写一个 for 循环。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-22T23:39:35.017

如果您的向量包含至少一个元素：

```
std::equal(vecSamples.begin() + 1, vecSamples.end(), vecSamples.begin()) 
```

# javascript - 在 Clojurescript 中访问“this”

> ID：15531261
> 
> 赞同：28
> 
> 时间：2013-03-20T17:58:03.460
> 
> 标签：javascript, google-closure, clojurescript

有没有办法访问 clojurescript 中的“this”对象？

当我用锚包装图标并尝试将处理程序附加到锚时，我遇到了事件传播问题[。](https://stackoverflow.com/questions/15530791/in-jquey-how-do-i-pass-an-event-to-a-parent-anchor-if-needed?noredirect=1#comment22001349_15530791)如果无法访问处理程序中的“this”，我会不断地处理内部图标有时会触发事件，而锚点会在其他时候触发。

编辑：

正如下面所建议的，this-as 是这样做的方法。一个例子可能是

```
(defn my-handler
  [e]
  (this-as this
    (let [data-attr (.data ($ this) "my-attr")]
      (log data-attr)))) 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-03-21T12:16:06.730

使用 ClojureScript 的`this-as`宏：[https](https://github.com/clojure/clojurescript/commit/09ff093dc86b455e3090ce3612c5e01f3b5bada6) ://github.com/clojure/clojurescript/commit/09ff093dc86b455e3090ce3612c5e01f3b5bada6 。

# model-view-controller - 与非 TYPO3 表的 Extbase 映射

> ID：15531266
> 
> 赞同：2
> 
> 时间：2013-03-20T17:58:09.963
> 
> 标签：model-view-controller, typo3, extbase

我也有课程和两个非 TYPO3 表。我将非 TYPO3 表定义为没有 uid、pid 等列的表。

**我的两个班：**

1.  Tx_Abc_Domain_Model_Location 类扩展 Tx_Extbase_DomainObject_AbstractEntity
2.  类 Tx_Abc_Domain_Model_Facility 扩展了 Tx_Extbase_DomainObject_AbstractEntity

**我的两个表（带列）：**

1.  地点
    *   邮政编码
    *   城市
    *   设施 ID
2.  设施
    *   设施 ID
    *   姓名

我已经映射了这样的属性：

```
config.tx_extbase.persistence.classes {
  Tx_Abc_Domain_Model_Location.mapping {
    tableName = locations
    columns {
        zipcode.mapOnProperty = zipcode
        city.mapOnProperty = city
        facility_id.mapOnProperty = facility
    }
  }
  Tx_Abc_Domain_Model_Facility.mapping {
    tableName = facilities
    columns {
        facility_id.mapOnProperty = uid
        name.mapOnProperty = name
    }
  }
} 
```

**我的问题：**

我的位置模型的设施属性获得了类型`Tx_Abc_Domain_Model_Facility`，当我通过 LocationRepository 查找位置时，它为我构建了一个包含设施模型的位置模型。

The problem appears, when I the search I am doing returns several results. i.e. the location with the zipcode 12345 has two different facilities (and the table locations got two rows with different facility_ids), then I would expect to get two location models and each of it got the right facility model.

But instead I get the two location models, which have all same facility model inside. They've got all the facility of the first found location.

Even if I change the type of the facility attribute to integer, there are the wrong ids. But if I enable raw query result in repository I get the correct ids.

I get also the correct ids or models, when I add to both tables an uid-column.

**Is there no possibility to map tables without uid column with Extbase models?**

Thanks.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T09:22:59.713

Okay, the answer to my last question is: Yes, there is no possibility to map tables without uid column with Extbase models.

There is an existing ticket on forge: [http://forge.typo3.org/issues/25984](http://forge.typo3.org/issues/25984)

The reason seems to be the hardcoded `$row['uid']` in mapSingleRow() method in Tx_Extbase_Persistence_Mapper_DataMapper class.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-23T08:08:11.243

If it's not alot of tables you have to map, a work-around could be to create views for those tables to just map the uid.

I.e.:

```
CREATE VIEW tx_abc_domain_model_facility AS
    SELECT facility_id AS uid, facilities.* FROM facilities; 
```

# windows-7 - 资源管理器线程使用异常数量的处理器能力，检测“问题”的根源/来源？

> ID：15531269
> 
> 赞同：0
> 
> 时间：2013-03-20T13:32:59.047
> 
> 标签：windows-7, windows, windows-explorer, cpu-usage

我正在分析我正在开发的应用程序，我看到了不寻常的 explorer.exe 处理器使用率，几乎 15%！

这对资源管理器来说非常高，我启动了进程资源管理器，然后我看到了这个：

![在此处输入图像描述](../Images/602914cc84bb9eea1b83e2ad62718c2c.png)

我单击“杀死”，资源管理器工作正常..

每次资源管理器重新启动/启动时都会发生这种情况。我如何检测哪个应用程序或导致该线程启动的原因以及如何阻止它启动？没有它，我的资源管理器工作正常。

我怀疑这是一种病毒，但我的 AV 软件都没有检测到它。

谁能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T05:39:44.197

您有一个 3rd 方组件，它动态创建代码（绿色），此代码使用此函数创建程序快照（红色）：[kernel32.dll!CreateToolhelp32Snapshot](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682489%28v=vs.85%29.aspx)

![在此处输入图像描述](../Images/bf55913aa94ec3260bddeea55936e0a8.png)

使用[AutoRuns](http://technet.microsoft.com/en-us/sysinternals/bb963902.aspx)和[ShellExView](http://www.nirsoft.net/utils/shexview.html)禁用所有 3rd 方工具，直到找到导致 CPU 使用率的代码。

# python - 拦截 D-bus 方法返回

> ID：15531271
> 
> 赞同：2
> 
> 时间：2013-03-20T17:58:16.810
> 
> 标签：python, dbus

我正在尝试编写一个 Python 脚本来拦截对特定接口的 D-bus 方法调用。但是，我还需要拦截相应的方法返回。我了解如何在 Python 中拦截方法调用（使用 add_signal_receiver），但不确定如何拦截方法返回。

下面是我试图拦截的方法调用和返回的示例，它们是使用 dbus-monitor 捕获的。

```
method call sender=:1.32 -> dest=com.nokia.HildonSVNotificationDaemon serial=694 path=/com/nokia/HildonSVNotificationDaemon; interface=com.nokia.HildonSVNotificationDaemon; member=PlayEvent
array [
    dict entry(
        string  "urgency"
        variant byte    1
    )
    dict entry(
        string  "vibra"
        variant string  "PatternIncomingMessage"
    )
    dict entry(
        string  "sound-file"
        variant string  "messaging_and_title_3"
    )
    dict entry(
        string  "category"
        variant string  "sms-message"
    )
    dict entry(
        string  "persistent"
        variant byte    1
    )
    dict entry(
        string  "time"
        variant int64   1363190279
    )
]
string  ":1.25"

method return sender=:1.21 -> dest=1.32 reply_serial=694
int32 <ID VALUE> 
```

# jquery - css背景图像加载后的slideUP div

> ID：15531273
> 
> 赞同：1
> 
> 时间：2013-03-20T17:58:21.720
> 
> 标签：jquery, css, image, background, preload

我有一个页面，我试图实现两件事 - 使用 css、背景图像和 z-index 的 3d 效果 - 使用 Jquery 滑动 div 以使电影类型学分卷起屏幕。

[http://titanstudio.net/about.html](http://titanstudio.net/about.html)

我已经尝试了几个我在各种帖子中找到的 jquery 图像预加载器，但似乎没有一个工作，我假设因为它们是 css 背景图像。我遇到的问题是在第一次加载时，前景图像加载速度不够快（它是一个相当大的 png），并且学分开始在背景图像之上滚动页面。当然，当您重新加载页面时，它工作正常，因为图像被缓存，并且信用文本正确地在背景和前景图像之间向上滚动屏幕。

我的问题：有没有办法延迟信用在屏幕上滚动，直到前景图像加载之后？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:02:50.833

为什么不加这个？里面的代码在页面完全加载后执行。

```
$(window).load(function(){
  //scroll up here
}); 
```

# lua - 如何构建完整的证书名称，包括使用 openssl 的 index.txt 的序列号

> ID：15531274
> 
> 赞同：0
> 
> 时间：2013-03-20T17:58:24.300
> 
> 标签：lua, openssl, pattern-matching

**问题描述：**

我需要构建一个正则表达式/模式来找到一个可以是十进制或十六进制的值

**背景资料：**

我正在尝试构建一个 lua 函数，它将在 index.txt 中查找证书并返回序列号。最终，我需要能够获取完整的证书名称并运行以下命令：

> openssl x509 -noout -in /etc/ssl/cert/myusername.6A756C65654063616E2E77746274732E6E6574.8F.crt -dates

我有构建文件名的逻辑，一直到序列号......在上面的例子中，它是 8F。

下面是 index.txt 文件的样子：

```
R   140320154649Z   150325040807Z   8E  unknown /CN=test@gmail.com/emailAddress=test@gmail.com
V   160324050821Z       8F  unknown /CN=test@yahoo.com/emailAddress=test@yahoo.com
V   160324051723Z       90  unknown /CN=test2@yahoo.com/emailAddress=test2@yahoo.com 
```

序列号是第一个记录中的字段 4，其余记录中的字段 3。根据文档[https://www.openssl.org/docs/apps/x509.html](https://www.openssl.org/docs/apps/x509.html)，序列号可以是十六进制或十进制。我还不太确定如何/谁确定它是十六进制还是十进制（我正在修改使用 openssl 的其他人的代码）......但我想知道是否有办法检查两者。我只会检查未撤销的记录的值......又名。第一列中没有“R”的那些。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:09:00.157

不幸的是，Lua 不支持模式分组，因此您可以将第二个时间戳的模式设为可选。你可以做的是首先检查两个时间戳模式，如果没有找到匹配项（这意味着`match`返回`nil`），重复一个时间戳模式：

```
sn = string.match(line, "^%a%s+%d+Z%s+%d+Z%s+(%x+)")
if not sn then
    sn = string.match(line, "^%a%s+%d+Z%s+(%x+)")
end 
```

请注意，如果您渴望，您可以在一行中完成所有操作：

```
sn = string.match(line, "^%a%s+%d+Z%s+%d+Z%s+(%x+)") or string.match(line, "^%a%s+%d+Z%s+(%x+)") 
```

每组括号捕获内部匹配的内容并添加一个返回值。有关 Lua 中模式的更多信息，请参阅[参考手册](http://www.lua.org/manual/5.2/manual.html#6.4.1)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:15:04.823

```
local cert = {
   'R   140320154649Z   150325040807Z    8E  unknown /CN=test@gmail.com/emailAddress=test@gmail.com',
   'V   160324050821Z       8F  unknown /CN=test@yahoo.com/emailAddress=test@yahoo.com',
   'V   160324051723Z       90  unknown /CN=test2@yahoo.com/emailAddress=test2@yahoo.com'
}

-- for Lua 5.1
for _, crt in ipairs(cert) do
   local n3, n4 = crt:match'^%S+%s+%S+%s+(%S+)%s+(%S+)'
   local serial  = n3:match'^%x+$' or n4:match'^%x+$'
   print(serial)
end

-- for Lua 5.2
for _, crt in ipairs(cert) do
   local serial = crt:match'^%S+%s+%S+.-%f[%S](%x+)%f[%s]'
   print(serial)
end 
```

# ms-access - 无法在 Access 2010 堆栈溢出错误中打开使用 Access 2007 创建的数据库

> ID：15531279
> 
> 赞同：0
> 
> 时间：2013-03-20T17:58:32.860
> 
> 标签：ms-access, ms-access-2007, ms-access-2010, stack-overflow

我创建了一个链接到 MS SQL 2008 后端的访问数据库。每当用户尝试在 Access 2010 机器中使用此数据库时，出现的错误对话框显示为：

> 运行时错误 (28)
> 堆栈空间不足

对话框中唯一可用的选项是 END、DEBUG 和 HELP。
END 什么都不做，DEBUG 带你到开始代码。

尝试了以下方法：

1-使网络文件夹成为受信任的位置相同的错误

2- 禁用信任中心的所有安全检查 SAME ERROR

3-将文件移动到使用 shift 打开的桌面并尝试压缩和修复相同的错误

4- 使用 MDB 格式创建新数据库并复制所有对象错误消失但丢失附件和电子邮件功能。

总之：

在本地或从网络使用 Access 2010 的任何机器上打开 2007 年创建的 accdb 文件时，我收到错误代码，如果我使用 MDB，问题就解决了，但我失去了重要的功能。

# project - 拉力赛查询项目/子项目

> ID：15531288
> 
> 赞同：0
> 
> 时间：2013-03-20T17:58:46.997
> 
> 标签：project, rally

我正在尝试查询工作区中的所有项目，我可以。但是当我尝试查询特定项目时，我得到 0 个结果。

如果我只是查询项目，我会得到一个完整的列表。如果我采用其中一个结果并添加：

```
query: 'Project.Name="Whatever"', 
```

我得到 0 个结果。

完整代码：

```
 //Works
    var queryConfig = {
    type: 'project',
    key: 'projects',
    fetch: 'Name' 
};

rallyDataSource.findAll(queryConfig, showStories); 
```

接着

```
 //Doesn't work
    var queryConfig = {
    type: 'project',
    key: 'projects',
    query: 'Project.Name = "Iron Horse"',
    fetch: 'Name' 
};

rallyDataSource.findAll(queryConfig, showStories); 
```

如果我能弄清楚这一点，我还试图获取该 1 项目的所有子项目的列表。我在这方面也没有成功，但我相信即使这样做我也需要我的第一个查询才能工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:23:26.693

我相信这个查询参数会给你你想要的：

查询：'（名称=“铁马”）'，

# php - PHP - 在 RTF/txt 文件中查找/替换文本

> ID：15531296
> 
> 赞同：1
> 
> 时间：2013-03-20T17:59:11.473
> 
> 标签：php, str-replace

我遇到了查找特定文本并将其替换为替代文本的问题。我在下面仅使用`.rtf`和`.txt`文件测试我的代码。我还确保文件在我的服务器中是可写的。

这是一个偶然的情况，我很好奇我的代码是否错误，或者这只是打开和操作文件的怪异。

```
<?php

$filelocation = '/tmp/demo.txt';
$firstname = 'John';
$lastname = 'Smith';

$output = file_get_contents($filelocation);
$output = str_replace('[[FIRSTNAME]]', $firstname, $output);
$output = str_replace('[[LASTNAME]]', $lastname, $output);
$output = str_replace('[[TODAY]]', date('F j, Y'), $output);

// rewrite file
file_put_contents($filelocation, $output);

?> 
```

因此，在`demo.txt`文件中，我有大约一整页的文本，其中散布着 [[FIRSTNAME]]、[[LASTNAME]] 和 [[TODAY]]。

它与查找/替换有关。到目前为止，[[TODAY]] 总是被正确替换，而名称却没有。

有没有人有同样的问题？

（附带说明，我检查了错误日志，到目前为止，打开文件或写入文件都没有返回 PHP 警告/错误）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:05:46.010

如果没有看到 demo.txt 的内容，很难确定。我的第一个猜测是使用括号作为指针可能会出现问题。我会尝试更改为 RTF 不使用的东西，例如百分号或星号。例如：%%FIRSTNAME%%, **FIRSTNAME**（当然这是假设您可以控制 demo.txt 的内容。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-21T06:44:41.567

我也遇到过这个问题。似乎 Microsoft Word 在标签中插入了格式代码。我在我的技术博客上发表了一篇关于如何解决这个问题的博文。

[http://tech.humlesite.eu/2017/01/13/using-regular-expression-to-merge-database-content-into-rich-text-format-template-documents/](http://tech.humlesite.eu/2017/01/13/using-regular-expression-to-merge-database-content-into-rich-text-format-template-documents/)

PHP 示例如下所示：

```
<?php 

$file = file_get_contents('mergedoc.rtf');

// To temporary get rid of the escape characters...
$mergetext = str_replace("\\", "€€", $file); 

// New seven part regex with default value detection
$regex2 = '/<<((?:€€[a-z0-9]*|\}|\{|\s)*)([a-z0-9.\-\+_æøåÆØÅA-Z]*)((?:€€[a-z0-9]*|\}|\{|\s)*)([a-z0-9.\-\+_æøåÆØÅA-Z]*)((?:€€[a-z0-9]*|\}|\{|\s)*)(?:\s*:(.*?)\s*)?((?:€€[a-z0-9]*|\}|\{|\s)*)>>/';

// Find all the matches in it....
preg_match_all($regex2,$mergetext, $out, PREG_SET_ORDER);

// Lets see the result
var_dump($out); 

foreach ($out as $match) {
    $whole_tag = $match[0]; // The part we actually replace. 
    $start = $match[1]; // The start formatting that has been injected in our tag, if any
    $tag = $match[2]; // The tag word itself. 
    if (($match[4].$match[6]) != "") { //some sec-part tag or default value?
        $end = $match[5]; // The end formatting that might be inserted. 
        if ($end == "") {
            $end = $match[7]; // No end in 5, we try 7\. 
        }
    } else {
        $end = $match[3]; // No second tag or default value, we find end in match-3 
    }

    $secPartTag = $match[4]; // Do we have inserted some formatting inside the tag word too ? 
    if ($secPartTag != "") {
        $tag .= $secPartTag; // Put it together with the tag word. 
    }
    $default_value = $match[6]; 

    // Simple selection of what we do with the tag. 
    switch ($tag) {
        case 'COMPANY_NAME': 
            $txt = "MY MERGE COMPANY EXAMPLE LTD"; 
            break; 
        case 'SOMEOTHERTAG':
            $txt = "SOME OTHER TEXT XX"; 
            break; 
        case 'THISHASDEFAULT':
            $txt = ""; 
            break; 

        default:
            $txt = "NOTAG"; 
    }
    if ($txt == "") {
        $txt = $default_value; 
    }
    // Create RTF Line breaks in text, if any. 
    $txt = str_replace(chr(10), chr(10)."\\line", $txt); 
    // Do the replace in the file. 
    $mergetext = str_replace($whole_tag, $start.$txt.$end, $mergetext); 
}
// Put back the escape characters. 
$file = str_replace("€€", "\\", $mergetext);
// Save to file. Extention .doc makes it open in Word by default. 
file_put_contents("ResultDoc.doc", $file); 

?> 
```

# ms-access - ComboBox 为空/null 会引发错误。如何“重置”字段？

> ID：15531297
> 
> 赞同：1
> 
> 时间：2013-03-20T17:59:14.100
> 
> 标签：ms-access, vba

我的表单中有一个组合框，其中包含一个表格填充列表作为行源。当用户输入该字段，更改某些内容并将其删除以使组合框为空时，我收到错误消息“您尝试将空值分配给不是变体数据类型的变量”。

问题是我的组合框不允许空字符串，但我也无法在组合框中找到在错误之前触发的事件。所以我不能使用 Len 或 IsNull 来捕捉错误。目前我使用这个“解决方法”，但它是非特定的，因为它使用表单而不是组合框的错误事件：

```
Private Sub Form_Error(DataErr As Integer, Response As Integer)
    Me.myField.Undo
    Response = acDataErrContinue
End Sub 
```

有没有更好的方法来处理这个问题？

我找到[了这个](https://stackoverflow.com/questions/9717808/clear-required-not-null-bound-textbox)。但这并没有解决问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:22:14.623

正如 Remou 在评论中指出的那样，错误是在将新值输入组合框后响应您正在执行的操作。检查组合框事件。如果您不介意类型并希望使用空值，则可以将变量更改为 Variant 类型。如果您使用的是字符串或整数等实际数据类型，则使用 NZ() 函数筛选出空值。

例如，如果您想在组合框为空的情况下将空字符串分配给字符串变量，那么您可以执行以下操作：

```
dim s as string
s = nz(me.combobox,"") 
```

至于在错误之前触发 - 在您的代码中的某处，您已经有导致错误的违规代码。你需要找到那个。为了提供更详细和具体的答案，您需要提供更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-23T00:05:26.600

这是一个无证的微软“功能”，旨在让你发疯。那些告诉你“查看你的代码”、“在你的代码中某处”的人并不知道他们在说什么。

两种解决方法。更改表中的基础字段以允许空值，或者，我认为这是最好的方法，将您的组合更改为未绑定控件并在 AfterUpdate 事件中设置基础字段。

# c++ - 将 git 命令挂钩到 Visual Studio 预构建步骤

> ID：15531305
> 
> 赞同：3
> 
> 时间：2013-03-20T17:59:45.490
> 
> 标签：c++, c, visual-studio, git

我使用 git 作为版本控制，我试图将当前提交的 SHA1 挂钩到 Visual Studio 构建中作为定义。

所以基本上我想把命令的输出

```
git rev-parse HEAD 
```

到我可以嵌入输出二进制文件的定义中。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-05T03:08:42.503

坦率地说，我更喜欢 Visual Studio 中的预构建事件而不是 Git 提交后事件。知道您是否从脏存储库构建还有额外的好处。今天就写到这了。以下是从构建到执行的一般步骤：

构建过程有一个预构建脚本，它收集版本和存储库状态信息。在我们的例子中，VC++ 使用 Windows PowerShell`version_info.ps1`脚本。

预构建脚本会生成一个源代码文件，这是代码库的其余部分所期望的。生成的文件包含允许或拒绝运行该版本所需的一切。在我们的例子中，它是一个 C++ 头文件`version.h`。

代码包含检查构建是否合法运行的功能，并根据需要记录和停止该过程。该示例代码位于示例文件的`versionLogAndVet`函数中。`version.cpp`

在运行时，该`versionLogAndVet`功能只允许运行存储库状态/构建配置的允许组合。它还记录版本信息。

[详细信息和代码示例在全文中](http://blog.didenko.com/2013/11/version-inventory.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:06:18.877

使用`post-commit` [githook](https://www.kernel.org/pub/software/scm/git/docs/githooks.html)，您可以将其放入文件中。我*认为*Windows 上的 git 带有一个 bourne shell，因此以下内容可以在提交后挂钩中使用。

```
#!/bin/sh
GIT_SHA_INCLUDE_FILE=foo.h
echo -n '#define GIT_SHA ' > $GIT_SHA_INCLUDE_FILE
git rev-parse HEAD >> $GIT_SHA_INCLUDE_FILE 
```

并将其保存为 .git/hooks/post-commit

该文件应该保持不被跟踪，因为它（几乎）不可能在提交本身中包含提交的哈希。

# .net - 代码与直接查询的命令执行时间

> ID：15531310
> 
> 赞同：0
> 
> 时间：2013-03-20T18:00:04.943
> 
> 标签：.net, sql-server-2008

这很奇怪。一段简单的代码

```
 using(SqlConnection
        {//open connection 
            using(SqlCommand
            {//Specified parameters and SP name
                using(SqlDataReader reader = command.ExecuteReader())
                {
                    if (reader.Read())
                    {
                    // Parse it and return an object.

                        return new MyObject
                                   {
                                      prop1 = (int)reader["column1"]
                                      ...

                                      propN=reader["columnn"].ToString()
                     } 
```

执行最多可能需要 3 分钟，而从 Management Studio 执行相同的 SP 运行时间不到一秒！

此代码在另一台服务器上运行。我还发现，如果从代码中执行，Sql Profiler 会报告数百万次读取，而在 Studio 中执行时读取次数少于 5000。

我不知道为什么会这样。任何帮助表示赞赏。PS 执行计划不是绑定到 SP 的，这意味着使用什么客户端运行它没有区别吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T20:42:56.440

这不是一个真正的答案，但至少它解决了它；）运行 SQL 分析器并捕获执行计划（正如大卫暗示的那样），我发现它们在第一种和第二种情况下有所不同。比我假设的统计/索引可能存在问题 - 优化器的选择非常糟糕。重建索引解决了这个问题，并且两种方式彼此接近（及时）执行。因此，如果您遇到这种情况 - 检查索引碎片和上次更新的统计信息。

# powershell - powershell 备份脚本，每个文件都有错误日志记录

> ID：15531314
> 
> 赞同：0
> 
> 时间：2013-03-20T18:00:24.303
> 
> 标签：powershell, backup

真的需要帮助创建一个备份的脚本，并沿着没有复制的文件射出错误

这是我尝试过的：

创建要传递给的文件路径列表，`copy-item`以期稍后捕获每个文件的错误，然后记录它们：

通过使用，`$list2X`我可以循环浏览每个文件，但`copy-item`会丢失目录结构并将其全部发送到单个文件夹中。所以现在我正在使用`$list2`，稍后我会`copy-item -recurse`复制文件夹：

```
#create list to copy
$list = Get-ChildItem -path $source | Select-Object Fullname
$list2 = $list -replace ("}"),("")
$list2 = $list2 -replace ("@{Fullname=") , ("")

out-file -FilePath g:\backuplog\DirList.txt -InputObject $list2

#create list crosscheck later
$listX = Get-ChildItem -path $source -recurse | Select-Object Fullname
$list2X = $listX -replace ("}"),("")
$list2X = $list2X -replace ("@{Fullname=") , ("")

out-file -FilePath g:\backuplog\FileDirList.txt -InputObject $list2X 
```

在这里，我将通过列表：

```
$error.clear()
Foreach($item in $list2){
 Copy-Item -Path $item -Destination $destination -recurse -force -erroraction Continue 
  }
 out-file -FilePath g:\backuplog\errorsBackup.txt -InputObject $error 
```

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:08:56.267

复杂文件复制或备份脚本的答案几乎总是：“使用 robocopy”。

账单

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T14:29:53.830

好吧，考虑到我的响应时间，我花了很长时间。这是我的复制功能，它记录了大多数错误（网络中断、复制失败等）、复制功能和目标对象。

```
Function backUP{ Param ([string]$destination1 ,$list1)
$destination2 = $destination1
                          #extract new made string for backuplog
                        $index = $destination2.LastIndexOf("\") 
                        $count = $destination2.length - $index
                        $source1 = $destination2.Substring($index, $count)
                        $finalstr2 = $logdrive + $source1

Foreach($item in $list1){

 Copy-Item -Container: $true -Recurse -Force -Path $item -Destination     $destination1     -erroraction Continue 
 if(-not $?)
 {
  write-output "ERROR de copiado : " $error| format-list | out-file  -Append             "$finalstr2\GCI-ERRORS-backup.txt"
      Foreach($erritem in $error){
      write-output "Error Data:" $erritem.TargetObject  | out-file -Append   "$finalstr2\GCI-    ERRORS-backup.txt"
          }
  $error.Clear()
     }
   }
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T06:01:51.993

“[想要将 C:\Scripts 中的所有项目（包括子文件夹）复制到 C:\Test？然后只需使用通配符...](http://technet.microsoft.com/en-us/library/ee156818.aspx) ”

接下来让自己更轻松，并执行以下操作：

```
$files = (Get-ChildItem $path).FullName #Requires PS 3.0
#or
$files = Get-ChildItem $path | % {$_.Fullname}
$files | Out-File $outpath 
```

# matlab - plotyy上的日期刻度标签

> ID：15531315
> 
> 赞同：0
> 
> 时间：2013-03-20T18:00:25.063
> 
> 标签：matlab

我正在尝试使用 plotyy 在同一张图上绘制两个变量。问题是，当我为日期标签配置 x 轴时，它会同时出现日期和另一种数字标签。如何仅设置日期标签？

![在此处输入图像描述](../Images/871b481e802742eabfae6a3c5a0854ab.png)

下面是脚本：

```
 prp_dados = importdata ('c:\experimental\telemetricas_ANA\prp\29070100PARAUAPEBAS_1332013-2032013.txt');

cot_dados = importdata ('c:\experimental\telemetricas_ANA\cota\29070100PARAUAPEBAS_1332013-2032013.txt');

p_date_string = strcat (prp_dados.textdata(2:end,1),{' '}, prp_dados.textdata(2:end,2));
c_date_string = strcat (cot_dados.textdata(2:end,1),{' '}, cot_dados.textdata(2:end,2));
p_xdate = datenum (p_date_string, 'dd/mm/yyyy HH:MM');

plotyy (p_xdate,cot_dados.data,p_xdate,prp_dados.data);

   set(gca,'XTick',p_xdate)
    datetick('x', 'dd-mm-yyyy'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:29:47.393

与其使用 gca 只获取一个句柄，不如尝试使用语法

```
[ax,h1, h2] = plotyy() 
```

然后您可以单独设置每个绘图的属性。

# ruby-on-rails - Rails 迁移 - 根据条件修改行

> ID：15531319
> 
> 赞同：3
> 
> 时间：2013-03-20T18:00:36.810
> 
> 标签：ruby-on-rails, ruby, rails-migrations

我需要使用 RAILS 迁移更新数据库中的表数据。

```
Sample:
Table: Table_A(Col_A(number), Col_B(varchar),...)
Query: UPDATE Table_A SET Col_B = "XXX" where Col_B = "YYY" 
```

使用 RAILS Migrations 执行此操作的最佳方法是什么。我什至不确定 RAILS 迁移是否是更新数据库中数据的方法。任何解释都会有所帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T18:26:04.373

通常最好在 rake 任务中进行此类大数据更新。我通常编写它们，因此它们有两个版本：rake change_lots_of_data:report 和 rake change_lots_of_data:update。'report' 版本只是执行 where 子句并输出将要更改的内容的列表。“更新”版本使用相同的 where 子句，但进行了更改。

这样做的一些优点是：

*   保存迁移以更改数据库结构
*   您可以随时运行“报告”版本，以确保更新正确的记录。
*   对 rake 任务调用的类进行单元测试更容易。
*   如果您需要应用相同的条件再次进行更改，您可以再次运行 rake 任务。通过迁移来做到这一点是可能的，但更棘手。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-20T18:28:26.870

我更喜欢在 rake 任务中进行任何数据库数据更改，这样就可以了

1.  明显的
2.  可重复
3.  以后不会通过`rake db:migrate`

编码：

```
namespace :update do
  desc "Update table A to set Col_B to YYY"
    task :table_a => :environment do
      TableA.where(Col_B: "YYY").update_all(Col_B: "XXX")
    end
  end
end 
```

然后您可以`rake update:table_a`执行更新。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-20T18:13:20.133

这应该在 rake 任务中完成......

```
namespace :onetime do
  task :update_my_data => :environment do
    TableA.where(Col_B: "YYY").update_all(Col_B: "XXX")
  end
end 
```

然后在你部署之后：

`rake onetime:update_my_data`

在我的公司，我们删除了一次性命名空间 rake 任务在生产中运行后的内容。我猜对我们来说只是一个约定。

`update_all`有关该方法 的更多详细信息：http: [//apidock.com/rails/ActiveRecord/Relation/update_all](http://apidock.com/rails/ActiveRecord/Relation/update_all)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T18:03:21.467

你可以这样做：

```
 class YourMigration < ActiveRecord::Migration
   def up    
     execute('UPDATE Table_A SET Col_B = "XXX" where Col_B = "YYY"')
   end

   def down
   end
 end 
```

或者：

```
 class YourMigration < ActiveRecord::Migration
   def up   
     update('UPDATE Table_A SET Col_B = "XXX" where Col_B = "YYY"')
   end

   def down
   end
 end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T18:03:00.417

```
ActiveRecord::Base.connection.execute("update Table_A set Col_B = 'XXX'  where Col_B = 'YYY') 
```

# unit-testing - 如何将 Autofixture (v3) 与 ICustomization、ISpecimenBuilder 一起使用来处理构造函数参数？

> ID：15531321
> 
> 赞同：13
> 
> 时间：2013-03-20T18:00:41.630
> 
> 标签：unit-testing, autofixture

我正在尝试克服一个场景，其中一个类具有一个字符串构造函数参数，该参数不能被 Autofixture 生成的任何旧字符串（Guid-y 外观值）所满足。

在您想简单地通过[Mark Seemann 的 Ploeh 博客文章的基于约定的定制](http://blog.ploeh.dk/2010/10/19/Convention-basedCustomizationswithAutoFixture/)的链接来回答之前，让我说我一直在参考它和他的其他博客文章来进行这个测试，我无法访问经过。

当我单步调试时，我可以看到在某些时候构造函数参数传入了有效值，但测试仍然失败，并显示 Guid-y 颜色值。我认为这与Autofixture 填充“颜色”参数值*和“颜色”属性有关。*是不是我编写了一个解决构造函数参数的 ISpecimenBuilder，但我正在测试公共属性值（两个不同的东西）？

我知道所有这些对于示例来说都是多余的，但我设想了一个更复杂的场景，使用该`Build<T>().With()`方法不会是 DRY。

**失败的测试**

```
 [Fact]
    public void Leaf_Color_Is_Brown()
    {
        // arrange
        var fixture = new Fixture().Customize(new LeafColorCustomization());

        // act
        var leaf = fixture.Create<Leaf>();

        // using .Build<>.With(), test passes
        //var leaf = fixture.Build<Leaf>().With(l => l.Color, "brown").CreateAnonymous();

        // assert
        Assert.True(leaf.Color == "brown");
    } 
```

**SUT**

```
 public class Leaf
    {
        public Leaf(string color)
        {
            if (color != "brown")
                throw new ArgumentException(@"NO LEAF FOR YOU!");

            this.Color = color;
        }
        public string Color { get; set; }
    } 
```

**CompositeCustomization 实现**（我知道此示例中不需要 AutoMoqCustomization()）

```
 public class LeafCustomization : CompositeCustomization
    {
        public LeafCustomization()
            : base(
            new LeafColorCustomization(),
            new AutoMoqCustomization()) { }
    } 
```

**叶特定的 ICustomization**

```
 public class LeafColorCustomization : ICustomization
    {
        public void Customize(IFixture fixture)
        {
            if (fixture == null)
                throw new ArgumentNullException("fixture");

            fixture.Customizations.Add(new LeafBuilder());
        }
    } 
```

**带有颜色名称的字符串构造函数 ISpecimenBuilder**

```
 public class LeafBuilder : ISpecimenBuilder
    {
        public object Create(object request, ISpecimenContext context)
        {
            var pi = request as ParameterInfo;
            if (pi == null)
                return new NoSpecimen(request);

            if (pi.ParameterType != typeof(string) || pi.Name != "color")
                return new NoSpecimen(request);

            return "brown";
        }
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T21:06:54.170

**解决方案 1**：

注册`Color`可写属性不应被分配任何自动值作为后处理的一部分：

```
internal class LeafColorCustomization : ICustomization
{
    public void Customize(IFixture fixture)
    {
        fixture.Customize<Leaf>(c => c
            .Without(x => x.Color));

        fixture.Customizations.Add(new LeafBuilder());
    }
} 
```

**解决方案 2**：

将`Color`属性设为只读：

```
public class Leaf
{
    private readonly string color;

    public Leaf(string color)
    {
        if (color != "brown")
            throw new ArgumentException(@"NO LEAF FOR YOU!");

        this.color = color;
    }

    public string Color
    {
        get { return this.color; }
    }
} 
```

由于该`Color`属性是只读的，AutoFixture 不会为其分配值。

> 上述解决方案也适用于 AutoFixture 2。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-21T14:37:44.240

假设您分别处理属性设置的东西，这里有一个构造函数参数限制`Customization`可以解决问题：

```
class BrownLeavesCustomization : ICustomization
{
    void ICustomization.Customize( IFixture fixture )
    {
        Func<string> notBrownGenerator = fixture.Create<Generator<string>>()
            .SkipWhile( x => x == "Brown" )
            .First;
        fixture.Customizations.Add( 
            ArgumentGeneratorCustomization<Leaf>.ForConstructorArgument(
                "color", 
                notBrownGenerator ) );
    }

    static class ArgumentGeneratorCustomization<T>
    {
        public static ISpecimenBuilder ForConstructorArgument<TArg>( string argumentName, Func<TArg> generator )
        {
            return new ConstructorArgumentGenerator<TArg>( argumentName, generator );
        }

        class ConstructorArgumentGenerator<TArg> : ISpecimenBuilder
        {
            readonly string _argumentName;
            readonly Func<TArg> _generator;

            public ConstructorArgumentGenerator( string argumentName, Func<TArg> generator )
            {
                Assert.Contains( argumentName, from ctor in typeof( T ).GetConstructors() from param in ctor.GetParameters() select param.Name );
                _argumentName = argumentName;
                _generator = generator;
            }

            object ISpecimenBuilder.Create( object request, ISpecimenContext context )
            {
                var pi = request as ParameterInfo;
                if ( pi == null )
                    return new NoSpecimen( request );
                if ( pi.Member.DeclaringType != typeof( T ) )
                    return new NoSpecimen( request );
                if ( pi.Member.MemberType != MemberTypes.Constructor )
                    return new NoSpecimen( request );
                if ( pi.ParameterType != typeof( TArg ) )
                    return new NoSpecimen( request );
                if ( pi.Name != _argumentName )
                    return new NoSpecimen( request );

                return _generator();
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-22T02:32:13.210

解决方案：（基于 Mark Seemann[对此答案](https://stackoverflow.com/a/15534718/533958)的评论）

在 ISpecimenBuilder 实现中同时容纳构造函数参数和 writeable 属性，除了在 LeafColorCustomization 中添加 LeafBuilder 实例之外什么都不做：

```
public class LeafBuilder : ISpecimenBuilder
{
    public object Create(object request, ISpecimenContext context)
    {
        var paramInfo = request as ParameterInfo;
        if (paramInfo != null
            && paramInfo.ParameterType == typeof(string)
            && paramInfo.Name == "color")
        { return "brown"; }

        var propInfo = request as PropertyInfo;
        if (propInfo != null
            && propInfo.PropertyType == typeof(string)
            && propInfo.Name == "Color")
        { return "brown"; }

        return new NoSpecimen(request);
    }
}

internal class LeafColorCustomization : ICustomization
{
    public void Customize(IFixture fixture)
    {
        fixture.Customizations.Add(new LeafBuilder());
    }
} 
```

# python - 从另一个路径导入模块导致 IOERROR:NO such file or directory

> ID：15531325
> 
> 赞同：0
> 
> 时间：2013-03-20T18:00:52.137
> 
> 标签：python

这是我的目录的可视化表示：

![在此处输入图像描述](../Images/9136b8419b14a57a30af1dcce0c85986.png)

这是来自 test1.py 的代码片段

```
....
def foo():
    f=read("./test1.dat","r")
.... 
```

这是test2.py的代码

```
import imp

TEST1 = imp.load_source('test1', '../test1.py')

def test2():
    TEST1.foo() 
```

运行 test2.py

```
cd subdir
python test2.py 
```

得到 IOERROR：没有这样的文件或目录：“./test1.dat”

我的问题是：

如果我不更改目录结构，例如将 test2.py 移动到其父目录，是否可以在模块 test2 中调用模块 test1 时找到正确的文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:04:47.490

这将为您提供已加载模块的路径：

```
import a_module
print a_module.__file__ 
```

获取模块目录：

```
import os, a_module
path = os.path.dirname(a_module.__file__) 
```

综上所述，如果您要查找与另一个模块相关的文件，我会使用这种方法：

来自 test1.py

```
def foo(path):
    f=read(path,"r") 
```

来自 test2.py

```
import os, test1
path = os.path.dirname(test1.__file__)
test1.foo(path + "/test1.dat") 
```

# html - 您将如何使用 HTML/CSS 来“向后”排序列表，以便列表从右到左、自下而上填充？

> ID：15531327
> 
> 赞同：2
> 
> 时间：2013-03-20T18:00:58.333
> 
> 标签：html, css

假设您指定了一些高度为 500 像素的 div。在这个 div 中，你有一个列表 - 可能是 ol 或 ul - 而不是从左到右、从上到下填充它（这可以通过 li 元素上的 display:inline-block 来完成），你想要填充它从右到左，从下到上。

我认为从右到左可以通过 li 元素中的 float:right 之类的方法来完成，但我想知道从下到上？

示例结果（elem1 在 elem2 之前填充等）：

```
-----------------------------------
[elem10][elem9][elem8][elem7][elem6]
[elem5][elem4][elem3][elem2][elem1]
----------------------------------- 
```

（所以这有点像把积木放在一起然后向右滑动。）

我希望我想多了，实际上有一个简单的方法可以做到这一点。

想法赞赏。

PS。我在 HTML5 中看到了 ol 的新 'reversed' 属性，即使这有帮助，我也更愿意避免现在浏览器支持很少的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:59:34.837

仅受 WebKit 支持，但`-webkit-writing-mode: horizontal-bt;`似乎可以工作：http: [//jsfiddle.net/zzXhp/](http://jsfiddle.net/zzXhp/)

它可能还有其他前缀属性。显然，它的支持不是很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T16:53:21.423

只需旋转列表，然后反向旋转 li 的

HTML是

```
<ul class="container">
<li class="inner">one</li>
....
</ul> 
```

CSS是

```
.container {
    left: 46px;
    top: 100px;
    width: 400px;
    height: 400px;
    position: absolute;
    border: 1px solid black;
    background-color: lemonchiffon;
}

.inner {
    background-color: lightsalmon;
    font-size: 20px;
    margin: 20px;
    width: 80px;
    float: left;
}

.container:hover,
.container:hover li {
    -webkit-transform: rotate(180deg);
    -webkit-transition: all 3s;
} 
```

在**[DEMO](http://jsfiddle.net/vals/NV6GS/)**中我做了悬停的效果，只是为了让它更漂亮。真正的代码将没有过渡:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T18:29:25.510

要从右到左显示某些内容（通常是阿拉伯语页面），您应该使用`dir tag`.

`dir="rtl"`： 右到左

```
<ul id="myList" dir="rtl">
    <li>1st</li>
    <li>2nd</li>
    <li>3rd</li>
</ul> 
```

这是一个[JSFIDDLE](http://jsfiddle.net/HAhGX/1/)

一个简单的 JavaScript 来完成整个工作，`rtl`不需要。

```
var list = document.getElementById("myList");
var i = list.childNodes.length;
while (i--)
  list.appendChild(list.childNodes[i]); 
```

这是一个[JSFIDDLE](http://jsfiddle.net/TfUHw/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-20T10:00:35.923

这是从下到上填充并右对齐的解决方案：

```
#mylist {
    position:absolute;
    top:58px;
    right:4%;
    height:40px;// height of max rows you might need - this allows two rows for me
    line-height:1;
    font-size:14px;
    margin:0;
    border: 1px dashed #38e800;
}
#mylist ul {
    position:absolute;
    bottom:0;
    right:0;
    overflow: hidden;
    vertical-align:bottom;
    list-style: none;
    text-align:right;
    margin:0 0 2px 0;
 }
#mylist li {
    display:inline-block;
    padding:0 0 0 18px;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-13T08:24:41.553

我制作了一个较短的、未格式化的@vals 答案版本，归功于他。

的HTML：

```
<ul class="reverse">
   <li>one</li>
   ...
</ul> 
```

CSS：

```
.reverse {
   position: absolute;
   list-style: none;
}

.reverse li {
   margin: 5px;
   float: left;
}

.reverse,
.reverse li {
   -webkit-transform: rotate(180deg);
} 
```

[JSFIDDLE](http://jsfiddle.net/Arg0n/bnnff5a4/1/ "JSFIDDLE")

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-24T09:38:19.050

使用下面的 CSS 从下到上反转：

```
ul { 
    display: flex;
    flex-direction: column-reverse;
} 
```

或使用下面的 CSS 从右到左反转：

```
ul { 
    display: flex;
    flex-direction: row-reverse;
} 
```

# java - 多态对象的序列化

> ID：15531333
> 
> 赞同：1
> 
> 时间：2013-03-20T18:01:25.937
> 
> 标签：java, serialization

我有课`Osoba`（人）和`Zawodnik`（参赛者）

`Contestant`扩展`Person`和`Person`实现`Serializable`。是否也`Constestant`自动实现`Serializable`？我认同。

class的 extension( `ArrayList ekstensja`)`Person`包含扩展 class 的不同类的对象`Person`。`zapiszEkstensje()`类中的方法会`Person`正常工作吗？我认同。

例子：

```
public abstract class Osoba implements Serializable {
/....something..../

    private static ArrayList<Osoba> ekstensja = new ArrayList<Osoba>();

    private void dodajZawodnik(Osoba osoba) {
        ekstensja.add(osoba);
    }

    private void usunZawodnik(Osoba osoba) {
        ekstensja.remove(osoba);
    }

    public static void pokazEkstensje() {
        for (Osoba zawodnik : ekstensja)
            System.out.println(zawodnik + "\n");

    }

    public static void zapiszEkstensje() {
        try {
            ObjectOutputStream outputStream = new ObjectOutputStream(new FileOutputStream("osoba.ser"));                                                
            outputStream.writeObject(ekstensja); 
            outputStream.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    @SuppressWarnings("unchecked")
    public static void wczytajEkstensje(){
        try {
            ObjectInputStream inputStream = new ObjectInputStream(new FileInputStream("osoba.ser"));                                                
            ekstensja = (ArrayList<Osoba>) (inputStream.readObject()); 
            inputStream.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    } 
} 
```

* * *

```
public class Zawodnik extends Osoba  {  }
// DO I NEED TO MAKE THIS CLASS IMPLEMENT SERIALIZABLE TOO? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:13:33.267

根据[Serializable](http://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html)接口的 java doc，可序列化类的所有子类型本身都是可序列化的。

所以，答案是肯定的，如果`Person`实现`Serializable`它的所有子级都将是可序列化的。

# php - PHP按给定日期范围修改数组

> ID：15531334
> 
> 赞同：-4
> 
> 时间：2013-03-20T18:01:34.413
> 
> 标签：php, arrays, date, filter

我有一个用 php 编写的表单，其中包含以下数组和两个变量：startDate 和 endDate。

我想做的是仅显示用户定义的日期范围内的日期。

```
$startDate = "2013-03-08";
$endDate = "2013-03-12";

Array
(
    [0] => 2013-03-06|Lorem|Mom|01:45
    [1] => 2013-03-07|ipsum|Dad|01:00
    [2] => 2013-03-08|dolor|Dad|01:45
    [3] => 2013-03-09|sit|Dad|01:00
    [4] => 2013-03-10|amet|Mom|01:45
    [5] => 2013-03-11|Lorem|Mom|01:45
    [6] => 2013-03-12|ipsum|Mom|01:00
    [7] => 2013-03-13|dolor|Dad|01:45
    [8] => 2013-03-14|sit|Mom|01:00
    [9] => 2013-03-15|amet|Mom|01:45
) 
```

发布表单后，数组将如下所示：

```
Array
(
    [0] => 2013-03-08|dolor|Dad|01:45
    [1] => 2013-03-09|sit|Dad|01:00
    [2] => 2013-03-10|amet|Mom|01:45
    [3] => 2013-03-11|Lorem|Mom|01:45
    [4] => 2013-03-12|ipsum|Mom|01:00
) 
```

实现这一目标的最简单方法是什么？

有什么想法吗？

/珍妮

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:10:28.933

我建议使用一个`array_filter()`函数。

```
$startDate = strtotime('2013-03-08');
$endDate = strtotime('2013-03-12');

$array = array(...); // your input array

$filteredArray = array_filter($array, function($value) use ($startDate, $endDate) {
    $valArray = explode('|', $value);
    $date = strtotime($valArray[0]);
    return ($date >= $startDate && $date <= $endDate);
}); 
```

请注意，以上对 PHP >= 5.3.0 有效。对于旧版本，您必须将匿名函数替换为命名函数并像这样调用它：

```
$startDate = strtotime('2013-03-08');
$endDate = strtotime('2013-03-12');

$array = array(...); // your input array

$filteredArray = array_filter ($array, 'filterArray');

function filterArray ($value) {
    global $startDate;
    global $endDate;
    $valArray = explode('|', $value);
    $date = strtotime($valArray[0]);
    return ($date >= $startDate && $date <= $endDate);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:14:28.273

你可以这样做：

让 $dates 成为您的输入数组

```
$dates = array(
           '0' => '2013-03-06|Lorem|Mom|01:45',
           '1' => '2013-03-07|ipsum|Dad|01:00',
           '2' => '2013-03-08|dolor|Dad|01:45',
           '3' => '2013-03-09|sit|Dad|01:00',
           '4' => '2013-03-10|amet|Mom|01:45',
           '5' => '2013-03-11|Lorem|Mom|01:45',
           '6' => '2013-03-12|ipsum|Mom|01:00',
           '7' => '2013-03-13|dolor|Dad|01:45',
           '8' => '2013-03-14|sit|Mom|01:00',
           '9' => '2013-03-15|amet|Mom|01:45)'
        );

$startDate = "2013-03-08";
$endDate = "2013-03-12";

$new_startDate = strtotime($startDate);
$new_endDate = strtotime($endDate);

$user_dates = array();

foreach ($dates as $date) {
    $date_values = explode('|', $date);
    $current_date_value = $date_values[0];
    $current_date_value = strtotime($current_date_value);

    if ($current_date_value >= $new_startDate && $current_date_value <= $new_endDate) {
        $user_dates[] = $date;
    }
} 
```

`$user_dates`将保留您需要的日期

希望这可以帮助你:)

# java - Jersey Multipart 1.13 和 Glassfish 2.1.1 看起来不兼容

> ID：15531337
> 
> 赞同：0
> 
> 时间：2013-03-20T18:01:41.940
> 
> 标签：java, glassfish, jersey, incompatibility, glassfish-2.x

在 Glassfish 2.1.1 服务器上使用 Jersey Multipart 1.13 部署战争时，随后出现以下错误消息：

> 方法，公共 javax.ws.rs.core.Response no.xx.nn.resources.ConverterResources.post(java.lang.String,java.lang.String,java.io.InputStream)，用资源、类的 POST 注释oo.xx.nn.resources.ConverterResources，未被识别为使用 @HttpMethod 注释的有效 Java 方法。在 com.sun.jersey.server.impl.model.method.ResourceHttpMethod.(ResourceHttpMethod.java:92) 在 com.sun.jersey.server.impl.model.method.ResourceHttpMethod.(ResourceHttpMethod.java:69) 在 com .sun.jersey.server.impl.model.method.ResourceHttpMethod.(ResourceHttpMethod.java:61) 在 com.sun.jersey.server.impl.model.ResourceClass.processMethods(ResourceClass.java:283) 在 com.sun。 jersey.server.impl.model.ResourceClass.(ResourceClass.java:131)

经过反复试验，我发现这属于以下代码：

```
@POST
@Consumes(MediaType.MULTIPART_FORM_DATA)
public Response post(@FormDataParam("providerId") int providerId,
                     @FormDataParam("datasetId") int datasetid,
                     @FormDataParam("file") InputStream file) 
```

更具体地说是`@FormDataParam`参数注释。当移除这些时，战争部署得很好。我试图在没有任何运气的情况下添加`@DefaultValue`到所有 s 中。`@FormDataParam`另外，我尝试添加一个`@Produces`, 也没有任何运气。该错误似乎与当前也没有`@Consumes(..)`任何关系。

我`web.xml`看起来很标准：

```
<servlet>
    <servlet-name>xxxx</servlet-name>
    <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
    <init-param>
        <param-name>com.sun.jersey.config.property.packages</param-name>
        <param-value>oo.xx.nn.resources</param-value>
    </init-param>
    <init-param>
        <param-name>com.sun.jersey.api.json.POJOMappingFeature</param-name>
        <param-value>true</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>xxxx</servlet-name>
    <url-pattern>/zzzz/*</url-pattern>
</servlet-mapping> 
```

我已经包含了所有必需的 Jersey 依赖项，如下所示：

```
<dependency>
    <groupId>com.sun.jersey</groupId>
    <artifactId>jersey-server</artifactId>
    <version>1.13</version>
</dependency>
<dependency>
    <groupId>com.sun.jersey</groupId>
    <artifactId>jersey-servlet</artifactId>
    <version>1.13</version>
</dependency>
<dependency>
    <groupId>com.sun.jersey.contribs</groupId>
    <artifactId>jersey-multipart</artifactId>
    <version>1.13</version>
</dependency> 
```

我也尝试过从 IDEA 部署到 Tomcat6 和 Glassfish 3.1.1，效果很好。在本地和远程的 Java 7 上运行（它不起作用）。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T19:31:17.107

好的，所以我发现了。Glassfish 与旧的 Jersey 依赖项捆绑在一起，因此我必须提供一个 JVM 参数来强制它给我的应用程序一些空间并提供自己的依赖项版本。另外我提供了一个 sun-web.xml。

[http://jersey.java.net/nonav/documentation/latest/glassfish.html](http://jersey.java.net/nonav/documentation/latest/glassfish.html)

# infragistics - 获取/设置 igGrid 组合单元格值

> ID：15531339
> 
> 赞同：2
> 
> 时间：2013-03-20T18:01:50.693
> 
> 标签：infragistics, ignite-ui, iggrid

我有一个 iggrid，它使用 JSON 数据源作为主网格数据和我的一个字段中的组合框。

我已经创建了网格和组合，数据就在那里。当我更改组合值并提交网格时，主网格列值不会改变。我可以通过为列分配默认值然后通过组合框更改它来看到这一点。

我正在研究这个例子。 [http://www.infragistics.com/products/jquery/sample/combo-box/grid-editor](http://www.infragistics.com/products/jquery/sample/combo-box/grid-editor)

组合数据

```
occCodeData = [
  { "ID": "0", "OccCode": "Food" },
  { "ID": "1", "OccCode": "Beverages" },
  { "ID": "2", "OccCode": "Electronics" },
  { "ID": "3", "OccCode": "Cookies" }
]; 
```

我的网格数据存储在从 web api 提取的 javascript 中的 JSON 变量中。我已经使用控制台写入验证了数据是否有效。

有没有人可以使用标准 JSON、JS 和 HTML？这个主要问题是当我更改组合值时，它不会在后台更新我的 JSON 数据。GUI 网格变化很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:26:08.293

当您在网格中进行编辑时，默认情况下该`autoCommit`选项设置为 false（意味着 UI 更新但值不会提交到数据源）。您可以将其更改为 true 以自动提交数据：

```
//Initialize
$(".selector").igGrid({
    autoCommit : true
});

//Get
var commit = $(".selector").igGrid("option", "autoCommit"); 
```

`commit`或者您可以手动调用该方法：

```
$(".selector").igGrid("commit"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:26:13.990

我想到了。我的样本 occCodeData 数据与我的当前值不匹配。

所以我从数据库中提取的默认值是 129，但我的可能值是 0、1、2、3。这导致组合不会更改值，因为它自己的列表中没有匹配项。

# mysql - 在更新语句中部分忽略子句

> ID：15531340
> 
> 赞同：0
> 
> 时间：2013-03-20T18:01:51.830
> 
> 标签：mysql, sql-update

我有这个查询，我在客户端使用它来从几个表中创建一个搜索字段。

```
update xcart.xcart_products_lng_en
left join xcart.xcart_products on xcart.xcart_products.productid = xcart.xcart_products_lng_en.productid
left join xcart.xcart_extra_field_values on xcart.xcart_extra_field_values.productid = xcart.xcart_products.productid 

 set xcart.xcart_products_lng_en.keywords =  CONCAT(product , " ", productcode, " ",
        (select group_concat(xcart.xcart_extra_field_values.value 
        order by `xcart`.`xcart_extra_field_values`.`productid` 
        separator " ") 
    from xcart.xcart_extra_field_values 
    where xcart.xcart_extra_field_values.productid = xcart.xcart_products_lng_en.productid )) 
where value is not null or value not like '' 
```

这可以按预期工作，但是当它获得太多值时它太松了，所以我添加了

```
 fieldid != 11 or fieldid != 10 or fieldid != 12 or fieldid != 18 or fieldid != 19 or
fieldid != 20
    or fieldid != 15 or fieldid != 3 or fieldid != 16 
```

但这被忽略了。有什么我公然错过的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:07:52.173

你应该使用`and`.

```
where value is not null or value not like '' 
```

这不会过滤掉任何东西，因为任何值都会通过该`or`或另一侧的一侧。一个`null`值会通过右手边，因为它不像`''`，并且`''`会通过左手边，因为它不为空。

# javascript - 拉力赛标签云

> ID：15531345
> 
> 赞同：0
> 
> 时间：2013-03-20T18:02:04.957
> 
> 标签：javascript, rally

我在 GitHub ( [https://github.com/RallyCommunity/TagCloud](https://github.com/RallyCommunity/TagCloud) ) 上找到了一些代码，用于在 Rally 中显示 TagCloud。从概念上讲，它看起来很棒，但我似乎无法让它工作，并想知道是否有任何 Rally JavaScript 专家可以快速浏览一下。

我稍微修改了它，因为分析的 URL 不正确（根据文档）并且 API 被硬编码为折旧版本，所以我更新了这些。

我不是 JavaScript 专家。当我运行它时，它没有找到任何针对故事的标签。

当我在 Chrome 调试模式下运行它时，我可以获取 URL 并在我的浏览器中执行它，但它也不会返回任何标签。它带有来自 Analytics 的完整结果响应，但没有标签，而且我知道所选项目中有针对故事的标签。

任何人的任何想法？

```
<!DOCTYPE html>
<html>
<head>
<title>TagCloud</title>

<script type="text/javascript" src="/apps/2.0p/sdk.js"></script>
<script type="text/javascript">
Rally.onReady(function() {
   Ext.define('CustomApp', {
       extend: 'Rally.app.App',
       componentCls: 'app',
       layout: 'border',
       items: [
    {
        title: 'Tag Cloud',
        xtype: 'panel',
        itemId: 'cloud',
        region: 'west',
        width: '30%',
        collapsible: true,
        bodyStyle: 'padding:15px',
        listeners: { 'afterRender': function(el) { setTimeout(function() { el.setLoading(); }, 500);}} // needs a little delay
    },
    {
        title: '<<< Select a tag from the Tag Cloud',
        xtype: 'panel',
        itemId: 'grid',
        region: 'center',
        width: '70%',
        collapsible: false
    }
       ],

       tagMap : [],
       maxFont : 24, // largest desired font size
       minFont : 8,  // and smallest

       _renderTag : function renderHandler(tagLabel) {
    tagLabel.getEl().on('click',this._tagSelected, this);
       },

       // does the actual building of the cloud from 'tagMap'
       _buildCloud: function(app, response) {

        //title: '<<< Select a tag from the Tag Cloud - Building',
        var i, tag;
    for (i=0;i<response.Results.length;i++) {
        tag = response.Results[i];

        if(typeof app.tagMap[tag.ObjectID] !== "undefined") {
        app.tagMap[tag.ObjectID].Name = tag._refObjectName;
        }
    }
    if(response.StartIndex+response.PageSize < response.TotalResultCount) {
        app._queryForTagNames(response.StartIndex+response.PageSize, app, app._buildCloud);
    } else {
        if(app.tagMap.length === 0) {
        tag = new Ext.form.Label({
            id: 'tagNone',
            text: '  No tagged Stories found  '
            });
            app.down('#cloud').add(tag);
        } else {
        var minFrequency = Number.MAX_VALUE;
        var maxFrequency = Number.MIN_VALUE;
        var tuples = [];
        for (var x in app.tagMap) {
            if (app.tagMap.hasOwnProperty(x)) {
            tuples.push([x, app.tagMap[x]]);
            if(app.tagMap[x].count > maxFrequency) {
                maxFrequency = app.tagMap[x].count;
            }
            if(app.tagMap[x].count < minFrequency) {
                minFrequency = app.tagMap[x].count;
            }
            }
        }

        tuples.sort(function(a,b) { a = a[1]; b = b[1]; return a.Name > b.Name ? 1 : a.Name < b.Name ? -1 : 0 ;});

        for (i = 0; i < tuples.length; i++) {
            var ftsize = ((tuples[i][1].count-minFrequency)*(app.maxFont-app.minFont) / (maxFrequency-minFrequency)) + app.minFont;
            tag = new Ext.form.Label({
            id: 'tag'+tuples[i][0],
            text: '  ' + tuples[i][1].Name + '  ',
            overCls: 'link',
            style:"font-size: "+ftsize+"pt;",
            listeners: { scope: app, render: app._renderTag }
            });
            app.down('#cloud').add(tag);
        }
        }
        app.getComponent('cloud').setLoading(false);
    }
       },

       // collects the _queryForTags responses and calls _queryForTagNames when it has them all
       _buildTagMap: function(app, response)  {
    for (var i=0;i<response.Results.length;i++) {
        var ent = response.Results[i];
        for (var j=0; j < ent.Tags.length; j++) {
        var tag = ent.Tags[j];
        var mapent = app.tagMap[tag];
        if(typeof mapent === "undefined") {
            mapent = { count: 1 };
        } else {
            mapent.count++;
        }
        app.tagMap[tag] = mapent;
        }
    }
    if(response.StartIndex+response.PageSize < response.TotalResultCount) {
        app._queryForTags(response.StartIndex+response.PageSize, app, app._buildTagMap);
    } else {
        app._queryForTagNames(0, app, app._buildCloud);
    }
       },

       // get a list of the tags from the Lookback API, iterating if necessary (see _buildTagMap)
       _queryForTags: function(start, app, callback) {
    var params = {
        find: "{'Tags':{'$exists':true}, '__At':'current', '_Type':'HierarchicalRequirement', '_ProjectHierarchy':"+ this.getContext().getProject().ObjectID +" }",
        fields: "['Tags']",
        pagesize: 20000,
        start: start
    };
    Ext.Ajax.request({
        url: 'https://rally1.rallydev.com/analytics/v2.0/service/rally/workspace/'+ this.context.getWorkspace().ObjectID + '/artifact/snapshot/query.js',
        method: 'GET',
        params: params,
        withCredentials: true,
        success: function(response){
        var text = response.responseText;
        var json = Ext.JSON.decode(text);
        callback(app, json);
        }
    });
       },

       // once all the tags have been collected, get a list of the tag names from the WSAPI, iterating if necessary (see _buildCloud)
       _queryForTagNames: function(start, app, callback) {
    Ext.Ajax.request({
        url: 'https://rally1.rallydev.com/slm/webservice/1.41/tag.js',
        method: 'GET',
        params: { fetch: "ObjectID", pagesize: 200, "start": start},
        withCredentials: true,
        success: function(response){
        callback(app, Ext.JSON.decode(response.responseText).QueryResult);
        }
    });
       },

       _queryForStories: function(tagOid) {
    Ext.create('Rally.data.WsapiDataStore', {
        model: 'UserStory',
        autoLoad: true,
        fetch: ['Rank', 'FormattedID', 'Name', 'ScheduleState'],
        filters: [{ 
        property:'Tags',
        operator: '=',
        value: "tag/" + tagOid
        }],
        sorters: [{
        property: 'Rank',
        direction: 'ASC'
        }],
        listeners: {
        load: this._onDataLoaded,
        scope: this
        }
    });
       },

       _tagSelected: function(app, elem) {
    this.getComponent('grid').setLoading();
    this._queryForStories(elem.id.substring(3)); // cheesy, id is "tag"+tagOid, we need the oid
    this.tagName = elem.innerText;
       },

       _onDataLoaded: function(store, data) {
    var records = [], rankIndex = 1;
    Ext.Array.each(data, function(record) {
        records.push({
        Ranking: rankIndex,
        FormattedID: record.get('FormattedID'),
        Name: record.get('Name'),
        State: record.get('ScheduleState')
        });
        rankIndex++;
    });

    var customStore = Ext.create('Rally.data.custom.Store', {
        data: records,
        pageSize: 25
    });

    if(!this.grid) {
        this.grid = this.down('#grid').add({
        xtype: 'rallygrid',
        store: customStore,
        columnCfgs: [
            { text: 'Ranking', dataIndex: 'Ranking' },
            { text: 'ID', dataIndex: 'FormattedID' },
            { text: 'Name', dataIndex: 'Name', flex: 1 },
            { text: 'State', dataIndex: 'State' }
        ]
        });
    } else {
        this.grid.reconfigure(customStore);
    }
    this.getComponent('grid').setTitle('Stories tagged: ' + this.tagName);
    this.getComponent('grid').setLoading(false);
       },

       launch: function() {
    this._queryForTags(0, this, this._buildTagMap);
       }
   });

Rally.launchApp('CustomApp', {
name: 'TagCloud'
});
 });
</script>

<style type="text/css">
  .app {

  }

  .link {
    color: #066792;
    cursor: pointer;
  } </style>
</head>
<body></body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T19:10:12.530

对于最近的 LBAPI 更改，该代码已经过时 - 特别是 _Type 与 _TypeHierarchy 的使用，当然还有 url，正如您已经发现的那样。请拿起更改并试一试。

# magento - Magento：如何显示可配置重复产品的重复配置文件信息

> ID：15531348
> 
> 赞同：2
> 
> 时间：2013-03-20T18:02:27.993
> 
> 标签：magento, magento-1.7, recurring-billing

我创建了一个可配置的产品，它允许用户在产品的重复版本和非重复版本之间进行选择（每个版本都是一个简单的产品）。我遇到的问题是，当用户选择重复选项时，他们不会看到他们会看到的简单重复产品的重复配置信息。如何让 Magento 有条件地为可配置产品显示此信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T02:17:19.220

这是一个可行的解决方案，通过一些幸运的猜测得出。

```
// check to see if the product is configurable
if ( $_product->getTypeID() == 'configurable' ) {
    // get the associated products    
    $associatedProducts = $_product->getTypeInstance()->getUsedProducts();
    // iterate through the products, checking for recurring products
    foreach ( $associatedProducts as $associatedProduct ) {
        if ($associatedProduct->isRecurring()) {
            // get the recurring profile
            $profile = $associatedProduct->getRecurringProfile();
            // echo whichever array members you need
            echo '<p>billed '.$profile['period_frequency'].' time(s) per '.$profile['period_unit'].'</p>';
        }
    }
} 
```

我在这里得到了一些帮助：[http ://www.phptechi.com/how-to-get-associated-child-product.html](http://www.phptechi.com/how-to-get-associated-child-product.html)

然后我只是对`getRecurringProfile()`.

`var_dump($associatedProduct->getRecurrringProfile())`产量：

```
array(13) { 
["start_date_is_editable"]=> string(1) "1" 
["schedule_description"]=> string(0) "" 
["suspension_threshold"]=> string(0) "" 
["bill_failed_later"]=> string(1) "1" ["period_unit"]=> string(5) "month"        
["period_frequency"]=> string(1) "1" ["period_max_cycles"]=> string(0) "" 
["trial_period_unit"]=> string(0) "" ["trial_period_frequency"]=> string(0) "" 
["trial_period_max_cycles"]=> string(0) "" ["trial_billing_amount"]=> string(0) "" 
["init_amount"]=> string(0) "" ["init_may_fail"]=> string(1) "0" 
} 
```

# javascript - Javascript 范围、安全性和扩展

> ID：15531349
> 
> 赞同：0
> 
> 时间：2013-03-20T18:02:28.420
> 
> 标签：javascript, scope, global-variables, leaflet

我已经阅读了很多关于 Javascript 范围的内容，并且已经产生了我想要的功能 - 我想我会发布这个问题以在一个地方澄清如何/为什么。

就我而言，我使用的是 Leaflet——一个用于映射的 javascript 库。

我的第一个问题是“L”是什么。

因此，例如，我可以使用以下代码：

```
current_map = L.map(map_id); 
```

L 代表什么，为什么我可以“通过”它访问功能？

其次，在我的网站上，我有多个不同的地图共享一些通用代码，例如设置地图。

因此，我想开发一些“通用代码”来设置地图并添加标记。

所以我在map_global.js中写了如下代码：

```
 var current_map;

window.setup_map = function(map_id)
{

    if ($("#"+map_id)[0])
    {

        $("#"+map_id).show();

        current_map = L.map(map_id);

    }
} 
```

然后在我的 map_individual.js 文件中，我简单地写：

```
map_setup('map_div'); 
```

我的地图已经设置好了。

我可以这样做，因为通过在定义函数名称中使用 window 我将函数设置在全局范围内。同样，通过在任何函数之外设置变量 current_map 它也是全局的吗？

这是实现此功能的有效/安全/合理的方式吗？

最后，为什么我不能访问 map_individual.js 中的 current_map？

非常感谢。

汤姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:21:50.963

这是一个变量范围的问题。

在概念上将“L”视为名称空间。L 向您公开方法，例如 map、L.map()。

看起来你想公开你的“current_map”变量。在您的 map_global.js 文件中， current_map 当前是一个局部变量 - 因为您使用**var**声明了它。因此，map_global.js 范围之外的任何内容都无法访问 current_map。

如果您想要一种快速而肮脏的方式来访问 map_individual.js 中的 current_map，您可以通过将全局 window.current_map 设置为 L.map(map_id) 来公开它，因此更改 current_map 变量的范围。

这当然会导致污染全局范围，因此您可以探索的一件事是如何实现“模块化”客户端javascript。一个简单的方法是实现你自己的命名空间。例如，在 map_global.js 中，您可以只公开一个“对象” - 您自己的命名空间 - 并将其附加到窗口。如果将这些方法和变量附加到该“对象”，则可以使用命名空间访问 current_map 和 setup_map()，而不是将所有方法和变量直接附加到窗口 - 全局命名空间 - 这可能很快就会失控。

```
 function setup_map(){ ...}

 var current_map; 

 window.my_lib = {
   setup_map = setup_map,
   current_map = current_map
 } 
```

所以**my_lib.setup_map()**和**my_lib.current_map**可以稍后以这种方式访问​​，因为您只使**my_lib**成为全局的。想象一下，如果 my_lib 公开了十几个函数，其想法是这将更有条理，而不是将所有十几个函数附加到窗口 - 全局命名空间。当您拥有具有相同功能的不同文件/“模块”时，这会派上用场。这样，您可以拥有 my_lib.render() 和 client_lib.render()，而不会相互覆盖，并保持这种分离，作为一种降低覆盖全局命名空间中已有内容的风险的方法。

请注意，导入脚本的顺序也很重要！还有一些库，例如 RequireJS、CommonJS，仅举几个例子，它们试图处理整个模块化事物的依赖方面，值得探索。所以小心行事，希望这会有所帮助！

# ios - 从子类访问 Root 类中变量的值

> ID：15531352
> 
> 赞同：0
> 
> 时间：2013-03-20T18:02:30.490
> 
> 标签：ios, xcode, class, variables

我真的想不通这个。我有一个名为 AdditionalMathViewController 的 VC，它向用户显示问题。如果用户回答错误，用户将被定向到另一个 VC，它是 AdditionalMathViewController 的子类，称为不正确的ViewController。

```
#import "ViewController.h"
@interface additionalmathViewController : ViewController{
int currentQuestion;
} 
```

currentQuestion 是一个计数器变量，它增加了用户正确回答问题的所有内容，并且可以显示另一个问题。如果用户把问题弄错了，我想去不正确的ViewController。这是我的代码

```
- (IBAction)SelectA:(id)sender {
if ([self.correctAns isEqualToString:@"A"]) {
       [self showNextQuestion];
}
else{
  [self performSegueWithIdentifier: @"segueToIncorrect" sender:nil];
}
} 
```

如果用户选择 A 并且正确，则显示另一个问题。如果是错误的执行 Segue 到不正确的ViewController

```
#import "additionalmathViewController.h"
@interface IncorrectImageViewController : additionalmathViewController 
```

这里我想从additionalMathViewController中获取currentQuestion的值

```
incorrectImage.image = [UIImage imageNamed:left[currentQuestion]]; 
```

此当前图像不是附加数学视图控制器的值

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:10:30.737

新的视图控制器是一个新的实例，因此不知道前一个实例的值是什么。您需要将 currentQuestion 值传递给`prepareForSegue`方法中的新控制器。

将 currentQuestion 设为属性

```
@interface IncorrectImageViewController
  @property (copy) NSInteger currentQuestion;
.. 
```

然后在 prepareForSegue 中设置目标控制器上的值。

```
@implementation additionalmathViewController

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    IncorrectImageViewController *incorrect = [segue destinationViewController];
    incorrect.currentQuestion = self.currentQuestion;
} 
```

# iptables - 使用 iptables/ebtables 进行 MAC 过滤

> ID：15531354
> 
> 赞同：1
> 
> 时间：2013-03-20T18:02:36.820
> 
> 标签：iptables, ebtables

我试图在我的网络中的一个节点上删除一个 MAC 地址。现在，我尝试了两个工具 iptables 和 ebtables，但都失败了：

*   `iptables -A INPUT -m mac --mac-source 00:0F:EA:91:04:08 -j DROP`导致“iptables：该名称没有链/目标/匹配”。
*   `ebtables -A INPUT -s 00:11:22:33:44:55 -j DROP`导致“致命：找不到模块 ebtables。内核不支持 ebtables '过滤器'表。”

我正在使用内核版本 2.6.32：`uname -r`结果为“2.6.32-042stab049.6.emulab.1”

我怎样才能使（至少一个）它起作用？我已经搜索了有关此故障的信息，但找不到太多信息。如何让内核支持 ebtables 'filter' 表？为什么“没有该名称的链/目标/匹配”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T02:41:27.840

验证您是否可以实际列出 INPUT 链：

```
# iptables -L 
```

希望这应该类似于：

```
Chain INPUT (policy ACCEPT)
target     prot opt source               destination

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination 
```

至于 ebtables，它显然不是你内核的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-03T10:56:43.610

您需要在内核配置中启用 ebtables 选项

```
CONFIG_BRIDGE_NF_EBTABLES=y
CONFIG_BRIDGE_EBT_BROUTE=y
CONFIG_BRIDGE_EBT_T_FILTER=y
CONFIG_BRIDGE_EBT_T_NAT=y
CONFIG_BRIDGE_EBT_802_3=y
CONFIG_BRIDGE_EBT_AMONG=y
CONFIG_BRIDGE_EBT_ARP=y
CONFIG_BRIDGE_EBT_IP=y
CONFIG_BRIDGE_EBT_IP6=y
CONFIG_BRIDGE_EBT_LIMIT=y
CONFIG_BRIDGE_EBT_MARK=y
CONFIG_BRIDGE_EBT_PKTTYPE=y
CONFIG_BRIDGE_EBT_STP=y
CONFIG_BRIDGE_EBT_VLAN=y
CONFIG_BRIDGE_EBT_ARPREPLY=y
CONFIG_BRIDGE_EBT_DNAT=y
CONFIG_BRIDGE_EBT_MARK_T=y
CONFIG_BRIDGE_EBT_REDIRECT=y
CONFIG_BRIDGE_EBT_SNAT=y
CONFIG_BRIDGE_EBT_LOG=y
CONFIG_BRIDGE_EBT_ULOG=y
CONFIG_BRIDGE_EBT_NFLOG=y 
```

然后构建内核并重试。也可能缺少 iptables 相关的东西。

# c++ - 共享列表、多个条件、一个或多个条件变量？

> ID：15531358
> 
> 赞同：4
> 
> 时间：2013-03-20T18:02:52.663
> 
> 标签：c++, multithreading, list, shared, condition-variable

考虑你有一个列表：

```
class CLIENTS
{
public:

    CLIENTS();
    ~CLIENTS();

    bool addClient();
    bool removeClient();
    bool getDataFromClientObj(unsigned int id);
    bool storeDataInClientObj(unsigned int id);
private:

    // vector, that contains all the clients
    boost::ptr_vector<CLIENTOBJ> clients;

    // mutex for the client-list
    boost::mutex mutex;
}; 
```

进一步考虑，getDataFromClientObj() 获取共享锁（互斥锁，私有锁）。除此之外，您还希望能够通过 getDataFromClient() 从客户端获取数据。

如果客户端的队列中根本没有数据，getDataFromClient() 将等待该客户端的条件变量，直到它有新数据要读取。

好吧，这是我的问题：
只要 getDataFromClient(); 等待，（因为这是一个多读取器/单写入器列表），我无法添加新客户端或删除客户端，因为 getDataFromClient() 持有互斥锁。

如果您有一个列表，您将如何准确解决该场景，该列表应是线程安全的 + 等待特定客户端的条件变量 + 在等待客户端时，能够删除或添加列表中的任何客户端？

所以这里再一次是事实：

*   线程安全列表（多读/单写）
*   能够随时添加客户/删除客户
*   能够专门等待每个客户端的（特定）条件（一个客户端可能在他自己的队列中存储了新数据，而另一个没有；然后 getDataFromClient() 将等待直到有新数据被读取）

我认为的问题是，鉴于每个客户端都有一个条件（伪代码：if(clientsqueue.isEmpty() -> wait），必须有多个条件变量（我错了吗？）

更多信息：
操作系统：Windows 7
语言：C++
编译器 VS2010

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:50:25.523

您的设置非常DBish。您有一个由`Clients`该类表示的表，并且每个实例的多个实例`CLIENTOBJ`都充当表的一行，并`id`充当主键。然而，据我了解，每个客户端实际上都是一个数据队列。

数据库使用的模型可以粗略地描述为将对数据的任何访问委托给数据库中的专用活动（线程或进程），并使用 SQL 向其发送命令。同步问题由事务和 SQL 子句处理（如果所寻求的不存在，更新可能不会影响任何行`id`，但该命令不会失败，它只会返回 0 行更新）。在您的情况下，也许一个类似的模型会很有趣：只有一个全局互斥锁来表示事务，每个线程锁定整个数据结构，操作它，然后解锁。但是，这可能不是很有效。

异步等效是让每个命令返回 a`std::future`而不是实际结果。从那时起，线程只需要等待`future`，并在它完成（或因异常而中断）时对其进行操作。

在`Clients`实例中，任何方法调用都转换为 a`future`和 a `promise`。承诺被推送到承诺队列，调用线程要么从方法调用中获取未来，要么立即等待它。

从 DB 进程的角度来看，这是一项连续的工作：您有一个承诺队列，所有其他线程都将与客户端 ID 捆绑在一起的数据推送到该队列中。然后 DB 线程按顺序满足生成的承诺：

*   创建一个新客户
*   删除客户
*   如果是存储，则数据库线程检查是否有任何读取处于待处理状态，并满足它，或者只是将该数据放入客户端队列
*   如果是读取且有数据，则从客户端队列中拉取并交给线程，或者将其推送到客户端的待处理读取队列中，以便稍后在数据可用时满足。

通过上述解决方案，所有的依赖关系都被分离出来了，任务也得到了精简。

您也可以为每个`CLIENTOBJ`. 然后 DB 线程变成了一个分类线程，它简单地将 Promise 分发给每个客户端。每个客户端都拥有给定的未决读取和数据队列`id`，因此在处理 promise 时不涉及锁。

每个队列都必须使用互斥锁保护，这意味着主承诺队列有 1 个互斥锁，每个客户端承诺队列需要 1 个互斥锁，以及与使用这些`Clients`方法的线程一样多的条件变量。

## 更新：

我的回答最初提出以下内容：

> 换句话说，您可以通过与每个非 DB 线程关联的简单条件变量来替换 future/promise 机制（future 和 promise 可能使用 cond. 变量实现，但在这里您可以节省创建和销毁开销）。

但它对`CLIENTS`对象的使用方式做了一些隐含的假设。确实是最安全的一条路`std::future`。

# symfony - 在 Symfony2 中的两个包之间引用 Twig 模板

> ID：15531368
> 
> 赞同：2
> 
> 时间：2013-03-20T18:03:16.863
> 
> 标签：symfony, twig

我无法在下面的代码中工作的唯一一件事是我希望它使用位于调用它的包的文件夹中的 navigation.html.twig 文件。所以在这个例子中它是bundle 2。那么是否可以不对其中的bundle路径进行硬编码？显然我没有在我的代码中对路径进行硬编码，但它不能像这样工作（其他所有操作，它只是对 navigation.html.twig 文件的引用）。

Bundle 1 包含主要的父 HTML/Twig 并调用位于调用此文件的任何包中的 navigation.html.twig 文件：

```
<! inside bundle 1 -->
<!DOCTYPE html>
<head>
<head>
<html>
<body>
<div id="navigation">
{% include 'navigation.html.twig' %}
</div>
<div id="content">
{% block the_content %}
{% endblock %}
</div>
</body>
</html> 
```

捆绑 2 调用捆绑 1：

```
{# inside bundle 2 #}

{% extends "Bundle1:index.html.twig" %}

{% block content %}
This is the content for this page
{% endblock %} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:03:43.087

据我所知，不可能跳过硬编码。但是，如果您将文件移动到`/app/Resources/views/navigation.html.twig`您可以通过以下方式引用它：

```
{% include '::navigation.html.twig' %} 
```

顺便说一句，出于好奇，您为什么不能拥有一个包含共享模板（以及其他文件）的“通用”捆绑包？

# perl - Perl循环不打印字符

> ID：15531370
> 
> 赞同：2
> 
> 时间：2013-03-20T18:03:18.287
> 
> 标签：perl

这个得到了我。

这有效：

```
print "Processing Feed\n";
while ( my @p = $mainex->fetchrow_array ) {
    my $iis = "$pcount";
    print "$iis\n";
    # ... Do Other Stuff Here
    $pcount++;
} 
```

这使：

```
Processing Feed
1
2
3
4
5
6
7
8
9
10
... 
```

这不起作用（从第 4 行删除了 \n）：

```
print "Processing Feed\n";
while ( my @p = $mainex->fetchrow_array ) {
    my $iis = "$pcount";
    print "$iis";
    # ... Do Other Stuff Here
    $pcount++;
} 
```

这只是给出：

```
 Processing Feed 
```

我试图建立一个计数器来输出记录的计数，使用类似的东西：

```
while( Something ){
    print "\b\b\b\b\b\b\b\b\b\b\b";
    print "$count";
    $count++;
    # Do stuff here
} 
```

有什么想法为什么在第二个示例中没有 \n 时没有打印到屏幕上？我以前做过很多次，无法弄清楚为什么它不起作用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T18:07:21.503

打印末尾的换行符触发标准输出的刷新，打印到屏幕上。如果您添加`$|++`到 perl 脚本的顶部，它将为标准输出打开自动刷新，您将看到您的数字。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T18:07:52.863

缓冲 I/O。

当有换行符或缓冲区已满（可能是 512 字节或 4096 字节或其他相当大的数字）时，数据会刷新到屏幕上。

# wcf - WCF 服务 - 自托管服务不起作用

> ID：15531375
> 
> 赞同：2
> 
> 时间：2013-03-20T18:03:40.863
> 
> 标签：wcf

我有一个在 VS 2010 中创建的 WCF 服务应用程序。当我执行它时，我在以下本地 url 中获得了服务页面

![在此处输入图像描述](../Images/0eca30e68b91f949d05d0b039662d071.png)

我创建了另一个自托管控制台应用程序，如下所示。它抛出以下异常

> HTTP 无法注册 URL。您的进程没有对此命名空间的访问权限（有关详细信息，请参阅[http://go.microsoft.com/fwlink/?LinkId=70353](http://go.microsoft.com/fwlink/?LinkId=70353)）。

好吧，我对 49609 端口号没有特别的兴趣。我只是从其他工作服务中复制了它。

现在，我拥有运行 WCF 服务的最低权限。我需要做哪些更改才能使以下代码成功？

注意：我没有机会获得这台机器的管理员权限。

注意：我可以使用任何可以使用的端口号。

```
namespace ConsoleApplication1
{
class Program
{
    static void Main(string[] args)
    {
        string baseAddress = "http://" + Environment.MachineName + ":49609/Service";
        ServiceHost host1 = new ServiceHost(typeof(Service1), new Uri(baseAddress));
        host1.AddServiceEndpoint(typeof(ConsoleApplication1.IService1), new BasicHttpBinding(), baseAddress);
        host1.Open();

    }
    static Binding GetBinding()
    {
        BasicHttpBinding result = new BasicHttpBinding();
        return result;
    }

}

} 
```

**服务**

```
public class Service1 : IService1
{
    public int Add(int n1, int n2)
    {
        return n1 + n2;
    }
}

[ServiceContract]
public interface IService1
{
    [OperationContract]
    int Add(int n1, int n2);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T19:31:20.830

对于控制台应用程序使用 HTTP.sys（这是 WCF 自托管方案使用的）打开传入（侦听）TCP 端口，它们需要具有管理权限，或者对于具有管理权限的某些帐户来保留“命名空间” "（即端口/路径对）供特定帐户（或所有帐户）使用。您提到您无法获得管理员权限，因此您需要在计算机上获得一些管理员以授予您对将使用的某些命名空间的访问权限。

例如，在我的一台机器上，我从来没有以管理员身份运行我的 VS（或者尽我所能，因为某些操作需要它），但是为了启动 WCF 服务，我选择了一个路径（在我的情况下，`http://<my-machine-name>:8000/Service`），我重用该路径作为我的服务的基地址。所以我必须以管理员身份运行下面的命令行：

```
netsh http add urlacl url=http://+:8000/Service user=MYDOMAIN\myusername 
```

在您的情况下，您需要让管理员在框中为您运行类似的命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:10:37.663

以下帖子应该会有所帮助

[http://weblogs.asp.net/joelvarty/archive/2009/01/06/for-wcf-services-hosted-in-non-iis-apps-add-permissions-for-a-user-to-change- -iis-命名空间-reservations.aspx](http://weblogs.asp.net/joelvarty/archive/2009/01/06/for-wcf-services-hosted-in-non-iis-apps-add-permissions-for-a-user-to-change-the-iis-namespace-reservations.aspx)

# wget - 使用 wget 下载本地访问（链接的部分转换）

> ID：15531376
> 
> 赞同：1
> 
> 时间：2013-03-20T18:03:46.840
> 
> 标签：wget

我已经下载了一个使用`wget`下面指定的标志的网站。

```
wget --output-file=german.txt -m -p -k -np german.about.com/ & 
```

（我正在努力提高我的语言技能:)）

问题是它正确地反映了网站，但只有部分链接被转换为本地链接。

一些链接保持不变，即使下载了相应的文件**（我检查过）** ，仍然指向在线文件。

您对为什么会发生这种情况有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T11:54:45.120

我认为这就是`-k`选项的用途。本[教程](http://fosswire.com/post/2008/04/create-a-mirror-of-a-website-with-wget/)中有一些关于它的更多信息。

# java - 如何预填充 GAE 本地数据库

> ID：15531379
> 
> 赞同：1
> 
> 时间：2013-03-20T18:04:09.200
> 
> 标签：java, database, google-app-engine, populate

我正在使用 java 创建一个 Google 应用程序引擎。对于这个应用程序，我想预先填充一些关于数据库的信息（例如：角色、权限等）。我怎样才能在我的本地数据存储上做到这一点？当我上传应用程序时，我该怎么做？似乎有一些 python 工具可以与服务器数据存储一起使用，但不是本地数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:10:12.393

向您的应用程序添加一个 servlet，将您需要的数据保存到数据存储区。然后，只需在首次运行应用程序之前访问 servlet 的 URL。

这是最简单的方法。如果您想在将应用程序上传到 GAE 后使用此方法，请确保添加安全约束，以便只有您可以调用 servlet：

```
 <security-constraint>
    <web-resource-collection>
        <url-pattern>/admin/*</url-pattern>
    </web-resource-collection>
    <auth-constraint>
        <role-name>admin</role-name>
    </auth-constraint>
</security-constraint> 
```

[https://developers.google.com/appengine/docs/java/config/webxml#Security_and_Authentication](https://developers.google.com/appengine/docs/java/config/webxml#Security_and_Authentication)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:12:49.330

您可以使用远程 API 与真实数据存储进行通信。

您编写在本地运行的与数据存储区对话的代码。它的效率相当低，您不想以这种方式传输大量数据，但如果它只是为几个实体设置它，它就可以完成这项工作。

[https://developers.google.com/appengine/docs/java/tools/remoteapi](https://developers.google.com/appengine/docs/java/tools/remoteapi)

# javascript - 单击按钮时隐藏 div

> ID：15531381
> 
> 赞同：2
> 
> 时间：2013-03-20T18:04:15.537
> 
> 标签：javascript, jquery, asp.net, html

当用户点击“评论”按钮时。

```
<input id="SubmitCommentsToInvoice" type="button" value="Comments" onclick="ShowCommentBox('<%: item.DBId %>', '<%: item.LabourOrPlant %>', '<%: item.ActivityDescription %>')" /> 
```

一个文本区域加载，带有一个提交按钮。当用户完成输入数据并单击“提交”时，我希望该框消失。（返回正常屏幕查看）

```
 <div id="dialog" title="Comments"  style="display:none;">   
    <textarea id="BlankBox" type="text" runat="server" rows="7" 
     maxlength="2000" />     
    <input id="SubmitComment" type="button" value="Submit"
                    onclick="SubmitButton()" />  
     </div> 

    function SubmitButton() {
                var commentBoxData = $('#<%=BlankBox.ClientID%>').val();
                WorkItemMgr.CommentBoxForInvoiceUpdates(id, LabouringOrPlanting, commentBoxData, testForSuccess);
            }

            function testForSuccess(CommentSuccessfullyUpdated) 
            {
                if (CommentSuccessfullyUpdated == "TRUE") 
                {
                    //$('#' + IdCommentBox).hide();
                    // $('#<%=BlankBox.ClientID%>').hide(); just hides comment box need to hide entire thing
                    $("#dialog").dialog({ modal: true }).hide();
    //IN HERE I WOULD LIKE TO HIDE THE DIV (MY ATTEMPTS SEEN ABOVE)
                }
                else if (CommentSuccessfullyUpdated == "False") 
                {
                    showLoadingImage.src = "../Images/X.png";
                }
            } 
```

我的尝试隐藏了 textarea，但我想再次隐藏整个 div 并恢复正常的屏幕查看（摆脱 modal:true）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:07:46.027

我不认为这条线正在做你认为它正在做的事情：

```
$("#dialog").dialog({ modal: true }).hide(); 
```

这告诉对话框插件初始化`#dialog`为一个新的对话框（模态），然后告诉 jQuery 隐藏整个事情。如果此时*已经*`#dialog`是模态对话框并且您只想隐藏它，请尝试以下操作：

 *```
$("#dialog").dialog("close"); 
```

这告诉对话框插件隐藏（或关闭）现有对话框。

通常，您希望尽可能使用插件的本机功能，而不是尝试对其应用其他功能。在这种特殊情况下，最好告诉 jQuery UI 对话框隐藏自己，而不是尝试使用 jQuery（它不知道对话框插件）来隐藏 div，因为它不知道是否有任何“特殊”关于那个 div （有，另一个插件正在使用它...... jQuery UI 对话框）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:08:14.180

如果你使用 jQuery ui 对话框，那么你应该使用[close 方法](http://api.jqueryui.com/dialog/#method-close)

```
$("#dialog").dialog('close'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T18:07:24.237

使用 jQuery：

```
$("#div_id").hide(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T18:07:40.537

在 jQuery 中

```
 $('#BlankBox').hide(); 
```

在 JavaScript 中

```
document.getElementById("BlankBox").style.display='none'; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T18:10:14.560

如果您使用的是 jQuery UI 对话框，请尝试：`$("#dialog").dialog({ hide: 1 });`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-20T18:12:09.487

尝试这个：

```
<div id="dialog" title="Comments"  style="display:none;">   
  <textarea id="BlankBox" type="text" runat="server" rows="7" maxlength="2000" />     
  <input id="SubmitComment" type="button" value="Submit"/>
</div> 
```

jQuery 将是：

```
$(function(){
   $('#SubmitComment').click(function(){
      $(this).closest('#dialog').hide();
   });
}); 
```*

# java - 通过子对象中的属性从 Datastore 中检索对象

> ID：15531382
> 
> 赞同：1
> 
> 时间：2013-03-20T18:04:18.460
> 
> 标签：java, google-app-engine, google-cloud-datastore, jdo

我正在使用**JDO在****Google App Engine中创建****Java**网络应用程序。

 ****我有一个具有属性**SessionToken的类****User**。这两个类都是持久的，具有**拥有的一对一**关系。

 ****```
@PersistenceCapable
public class User {    
  @PrimaryKey
  @Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
  private Key key;
  @Persistent
  private SessionToken sessionToken;    
  //getters and setters...
}

@PersistenceCapable
public class SessionToken { 
  @Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
  private Key key;
  @Persistent
  private String token;    
  //getters and setters...
} 
```

现在我想要一种方法来使用 SessionToken 的属性令牌从数据存储区获取用户。我的意思是，我需要这样的东西：

```
Query query = pm.newQuery(User.class);
query.setFilter("sessionToken.token == tokenParam");
query.declareParameters("String tokenParam");
//return retrieved user if any... 
```

但这不起作用，因为查询无法访问子对象中的属性。

它抛出这个异常：

```
javax.jdo.JDOFatalUserException: SELECT FROM com.mockgaeapp.User 
WHERE sessionToken.token == tokenParam PARAMETERS String tokenParam: 
Can only reference properties of a sub-object if the sub-object is embedded. 
```

我能做到的唯一方法是首先获取 SessionToken，然后获取通信用户，例如：

```
//First retrieve the SessionToken...
Query query = pm.newQuery(SessionToken.class);
query.setFilter("token == tokenParam");
query.declareParameters("String tokenParam");
List<SessionToken> tokens = (List<SessionToken>) query.execute(sessionToken);
if (!tokens.isEmpty()) {

  //... then retrieve the User
  query = pm.newQuery(User.class);
  query.setFilter("sessionToken == sessionTokenParam");
  query.declareParameters("String sessionTokenParam");
  List<User> users = (List<User>) query.execute(tokens.get(0));
  //return retireved user if any...
} 
```

我想知道是否有其他方法可以做到这一点，只使用一个查询，或者即使有其他方法......而且我们必须考虑到这个操作将被执行多次......

**编辑**：我发现了一种更简单的方法也有效。在上一个示例中检索到 SessionToken 后，我使用它的密钥检索用户，例如：

```
//... then retrieve the User
user = pm.getObjectById(User.class, tokens.get(0).getKey().getParent());
//return retireved user if any... 
```

这样，我进行密钥查找而不是另一个查询，但无论如何我仍然访问数据存储两次...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T10:40:02.570

一种可能的解决方案是在两个实体类之间建立双向拥有的一对一关系。那么你也能：

1.  `SessionToken`通过查询token获得你想要的。
2.  通过调用获取的适当的getter 方法来获取`SessionToken`父级。`User``SessionToken`

另一种可能的解决方案是遵循“Google App Engine Java Persistence”博客中所述的“跨所有关系执行简单连接”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-29T12:19:39.887

```
Query query = pm.newQuery(User.class);
query.setFilter("sessionToken == tokenParam && tokenParam == 'my_token'");
query.declareParameters(SessionToken.class.getName() + " tokenParam"); 
```

应该管用********

# c# - 访问 Web 服务时未定义无参数构造函数

> ID：15531383
> 
> 赞同：1
> 
> 时间：2013-03-20T18:04:26.887
> 
> 标签：c#, asp.net, asp.net-mvc

无法弄清楚我做错了什么。

控制器代码。

```
public class HomeController : Controller
{
    private readonly SoapWebService _db;

    public HomeController(SoapWebService db)
    {
        _db = db;
    }

    public ActionResult Index()
    {
        return View(_db.GetAllItems("APIKey").ToList());
    }
 } 
```

查看代码

```
@model IEnumerable<ProjectName.ServiceName.ItemName>

@foreach (var item in Model) {
     @Html.DisplayFor(item => item.Title)
} 
```

错误

没有为此对象定义无参数构造函数。

说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详细信息：System.MissingMethodException：没有为此对象定义无参数构造函数。

源错误：

在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:12:43.887

如果不使用依赖注入功能（框架或手动），您的控制器将无法实例化，因为没有无参数构造函数。

在您的情况下，依赖注入器将创建一个实例`SoapWebService`以传递给仅控制器的构造函数。

如果不使用 DI，您将需要一个无参数构造函数来实例化任何依赖项本身：

```
public class HomeController : Controller
{
    private readonly SoapWebService _db;

    public HomeController()
        : this(new SoapWebService()) { }

    public HomeController(SoapWebService db)
    {
        _db = db;
    }

    public ActionResult Index()
    {
        return View(_db.GetAllItems("APIKey").ToList());
    }
 } 
```

# html - CSS使图像居中而不调整大小？

> ID：15531387
> 
> 赞同：2
> 
> 时间：2013-03-20T18:04:38.147
> 
> 标签：html, css

是否有任何 CSS 技巧可以在不调整图像大小的情况下以设定的宽度/高度居中图像？

例如，如果我尝试将以下图像放入 150 x 150 的容器中，它会调整大小。

原来的

![在此处输入图像描述](../Images/5a0de7b6d3c7f9cbc3db2af8df2bbc3c.png)

容器

![在此处输入图像描述](../Images/e131347e8073c2c1a37a7e81a396c1f0.png)

**我正在努力实现这一目标**：

![在此处输入图像描述](../Images/d90ebffe32b83a52893119d3de609f6b.png)

这可以单独使用 CSS 实现吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T18:07:23.033

您可以将其设置为背景图像并使用[`background-position`](https://developer.mozilla.org/en-US/docs/CSS/background-position).

```
#foo {
  width: 150px;
  background-image:url('http://i.stack.imgur.com/BP0dH.jpg');
  height: 150px;
  background-position: center;
} 
```

[演示](http://jsbin.com/aqirin/1/edit)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:08:45.963

你可以尝试这样的事情：html：

```
<div class="container">
<img src='' />
</div> 
```

CSS：

```
.container {
width: 150px;
height: 150px;
position: relative;
overflow: hidden;
}

.container img {
max-height: 150px;
position: absolute;
left: 50%;
margin-left: -75px;
} 
```

# javascript - 在谷歌地图中添加标记数组

> ID：15531390
> 
> 赞同：16
> 
> 时间：2013-03-20T18:04:43.147
> 
> 标签：javascript, google-maps-api-3

我需要一些帮助来在 Google Map 中创建一组标记，以便更高效，而不是一个一个地创建标记。我尝试了以下但它不起作用。有人有建议吗？

```
//create array to store a set of location
var collection = new Array();

//a set of locations stored in array
collection[0] = new google.maps.LatLng(13.742167701649997, 100.50721049308777);
collection[1] = new google.maps.LatLng(13.74428, 100.5404525);
collection[2] = new google.maps.LatLng(13.744108, 100.543098);

var pointMarkerImage = new Array();//store image of marker in array
var pointMarker = new Array();//store marker in array

//create number of markers based on collection.length
function setPoint(){
for(var i=0; i<collection.length; i++){

var pointMarkerImage[i] = new google.maps.MarkerImage('marker.png');
var pointMarker[i] = new google.maps.Marker({
        position: collection[i],
        map: map,
        icon: pointMarkerImage[i],
        animation: google.maps.Animation.BOUNCE,
        title: "collection"+ i 
    });

    google.maps.event.addListener(pointMarker[i], 'click', function()    { 
             window.open("blog/page01.html","_blank","toolbar=yes, location=yes, directories=no, status=no, menubar=yes, scrollbars=yes, resizable=yes, copyhistory=yes")
             };
    );
    }
} 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-03-22T04:23:04.883

这是我的简单代码，它工作正常。当您单击标记时，它将根据该标记的位置分别打开信息窗口。

```
<script>
var locations = [
     ['Title A', 3.180967,101.715546, 1],
     ['Title B', 3.200848,101.616669, 2],
     ['Title C', 3.147372,101.597443, 3],
     ['Title D', 3.19125,101.710052, 4]
];
var map = new google.maps.Map(document.getElementById('map'), {
     zoom: 12,
     center: new google.maps.LatLng(3.171368,101.653404),
     mapTypeId: google.maps.MapTypeId.ROADMAP
});

var infowindow = new google.maps.InfoWindow;

var marker, i;

for (i = 0; i < locations.length; i++) {  
    marker = new google.maps.Marker({
         position: new google.maps.LatLng(locations[i][1], locations[i][2]),
         map: map
    });

    google.maps.event.addListener(marker, 'click', (function(marker, i) {
         return function() {
             infowindow.setContent(locations[i][0]);
             infowindow.open(map, marker);
         }
    })(marker, i));
}
</script>

<div data-role="page" id="map_result">
    <div data-role="header" data-position="fixed"><h1>Multiple Marker</h1></div>
    <div data-role="content" style="padding:0;">
        <div id="map"></div>
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T18:14:16.133

我看到几点：

1）在 for 循环中， var pointM... 应该只是 pointM... 添加 var 使其忽略您在 for 循环之外的集合。

2）你有一个；在破坏事物的功能之后。

尝试这个：

```
//create array to store a set of location
var collection = new Array();

//a set of locations stored in array
collection[0] = new google.maps.LatLng(13.742167701649997, 100.50721049308777);
collection[1] = new google.maps.LatLng(13.74428, 100.5404525);
collection[2] = new google.maps.LatLng(13.744108, 100.543098);

var pointMarkerImage = new Array();//store image of marker in array
var pointMarker = new Array();//store marker in array

//create number of markers based on collection.length
function setPoint(){
  for(var i=0; i<collection.length; i++){

    pointMarkerImage[i] = new google.maps.MarkerImage('marker.png');
    pointMarker[i] = new google.maps.Marker({
            position: collection[i],
            map: map,
            icon: pointMarkerImage[i],
            animation: google.maps.Animation.BOUNCE,
            title: "collection"+ i 
    });

    google.maps.event.addListener(pointMarker[i], 'click', function(){
      window.open("blog/page01.html","_blank","toolbar=yes, location=yes, directories=no, status=no, menubar=yes, scrollbars=yes, resizable=yes, copyhistory=yes");
    }
    );
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-10-22T03:08:16.977

我复制了 Qiqi Abaziz 先生并有所改进。这是完整版

```
<script type="text/javascript">

function initMap() {

    var locations = [
         ['Title A', 3.180967,101.715546],
         ['Title B', 3.200848,101.616669],
         ['Title C', 3.147372,101.597443],
         ['Title D', 3.19125,101.710052]
    ];
    var map = new google.maps.Map(document.getElementById('map'), {
         zoom: 12,
         center: new google.maps.LatLng(3.171368,101.653404),
         mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    var infowindow = new google.maps.InfoWindow;

    var marker, i;

    for (i = 0; i < locations.length; i++) {  
        marker = new google.maps.Marker({
             position: new google.maps.LatLng(locations[i][1], locations[i][2]),
             map: map
        });

        google.maps.event.addListener(marker, 'click', (function(marker, i) {
             return function() {
                 infowindow.setContent(locations[i][0]);
                 infowindow.open(map, marker);
             }
        })(marker, i));
    }
}

</script>

<script async defer
        src="https://maps.googleapis.com/maps/api/js?v=3.exp&key=YOURAPIKEY=initMap">
</script>

<style type="text/css">
  #map { height: 400px;
    margin-left:auto;
    margin-right:auto;
    text-align:left;
    width: 80%;}
</style>

<div id="map"></div> 
```

# asp.net - 如何取消按钮的优先级，使其作为页面的默认按钮“跳过”？

> ID：15531393
> 
> 赞同：1
> 
> 时间：2013-03-20T18:04:47.660
> 
> 标签：asp.net

我有一个复杂的 Web 应用程序，其中包含数百个控件、数十个页面和大约十几个母版页。使用 ContentPlaceHolders，在每个页面的主体中生成不同的表单内容，例如一个页面上的登录提示和另一个页面上的“添加到收藏夹”按钮。

所有这些页面的共同点是搜索栏。当搜索栏位于顶部时，它会在每次按下回车键时捕获回车键。如果我通过一些代码隐藏和javascript将搜索栏移动到主要内容下方，它仅在搜索字段处于焦点时正确捕获输入键。

我想做的是将搜索栏留在页面顶部，但取消优先级，因此当按下回车键时，默认按钮就是页面上的第二个按钮。我的目标是避免将 javascript 添加到可能出现在页面主体中的每个可能的控件中。

**如何取消按钮的优先级，使其作为页面的默认按钮“跳过”？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:24:32.893

最好的方法是采取不同的策略，只需将您想要的按钮指定为页面的默认按钮。

`<form id="aspnetForm" runat="server">`将标签修改为：

`<form id="aspnetForm" runat="server" defaultbutton="NameOfTheButtonYouWant>`

如果您想要一个不同的默认值，具体取决于用户光标所在的位置，则将相关区域包装在 a`<asp:panel>`中，该区域也具有 defaultbutton 属性。

* * *

**从评论更新。**

我唯一的另一个想法可能很难实现。HTML5[规范](http://www.w3.org/TR/html5/constraints.html#implicit-submission)说

> 第一个按树形顺序提交按钮，其表单所有者是该表单元素

是默认值。

因此，如果您可以移动搜索区域，使其位于 HTML 文件的底部，但仍呈现在顶部，那么您*可能*会成功。但是，这将需要对布局进行一些修改才能使其正常工作。

# asp.net-mvc - Infragistics Ignite Excel 库中的动态奇怪问题

> ID：15531396
> 
> 赞同：2
> 
> 时间：2013-03-20T18:04:54.040
> 
> 标签：asp.net-mvc, export-to-excel, infragistics, ignite-ui

我正在使用 Ignite UI 工具集来生成 Excel 电子表格。我有一些在我的应用程序的旧版本中运行的代码（我从旧的 SVN 代码中提取了源代码），但现在我遇到了一个非常奇怪的问题。

我得到的例外是：

```
An exception of type 'Microsoft.CSharp.RuntimeBinder.RuntimeBinderException' 
occurred in Unknown Module. but was not handled in user code

Additional information: 'object' does not contain a definition for 'Fill'

If there is a handler for this exception, the program may be safely continued. 
```

这是调试器的屏幕截图，显示 cell.CellFormat.Fill（我正在尝试设置并获取异常）正在显示在监视窗口中。请注意，单元格本身是一个动态对象。

![调试器截图](../Images/749dbdf6569c8a6f1f9fb114a348dcd5.png)

任何人都知道可能导致这种情况的原因是什么？也许我只是没有足够地处理动态对象，但在我看来，“填充”确实存在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T15:22:58.893

我的问题由 Infragistics 回答，但如果其他人也遇到它，请提供解决方案。

解决方案只是将单元格转换为 WorksheetCell 而不是在 foreach 循环中使用 var ，因此：

```
foreach (WorksheetCell cell in region)
{
    cell.CellFormat.Fill = CellFill.CreateSolidFill(System.Drawing.Color.Gray);
    cell.CellFormat.Font.ColorInfo = new WorkbookColorInfo(System.Drawing.Color.White);
} 
```

我不完全确定为什么会修复它，所以我计划在某个时候深入研究它，并可能在我拥有它时用该信息更新这个答案。

# asp.net-mvc-4 - 从外部 Web 请求通知 SignalR 客户端

> ID：15531397
> 
> 赞同：0
> 
> 时间：2013-03-20T18:05:01.883
> 
> 标签：asp.net-mvc-4, signalr, signalr-hub

我有一个基于 ASP.NET MVC 4 插件的 webapp，其插件包含一个侦听器类，在后台运行以侦听 SQL Server Broker 队列上的消息。当新消息到达时，我想将它们推送给所有连接的客户端。

我创建了一个通知中心，它在从客户端发送到服务器时运行良好，但是我用来向客户端发送更新的代码没有做任何事情。

```
var context = GlobalHost.ConnectionManager.GetHubContext<NotificationHub>();
context.Clients.All.dataUpdated(message.Data); 
```

我试过使用

```
using (var timerScope = AutofacDependencyResolver.Current.ApplicationContainer.BeginLifetimeScope("httpRequest"))
{
    var connMgr = timerScope.Resolve<IConnectionManager>();
    var context = connMgr.GetHubContext<NotificationHub>();
    context.Clients.All.dataUpdated(message.Data);
} 
```

但随后我只收到带有错误消息的 InvalidOperationException：“无法创建请求生命周期范围，因为 HttpContext 不可用。”

可以理解，因为我试图在网络请求之外进行呼叫。

我正在尝试做的事情有可能吗？我已经看到了一些使用 webrequest 连接到自身以发送消息的示例，但我正在寻找一种更清洁的方式，我真的不想使用完整的消息总线。

# emacs - Emacs：尝试使用tramp连接到远程主机时找不到uname

> ID：15531399
> 
> 赞同：1
> 
> 时间：2013-03-20T18:05:06.770
> 
> 标签：emacs, elisp, tramp

我[在 OSX 上使用 emacs 24.3](http://emacsformacosx.com/)，我在使用 tramp 连接到远程主机时遇到了一些麻烦。每次我尝试连接时，都会出现以下错误：

```
Tramp: Opening connection for root@foo.example.com using ssh...
Tramp: Sending command `exec ssh -l root  -e none foo.example.com'

Tramp: Waiting for prompts from remote shell
Tramp: Sending command `exec ssh -l root  -e none foo.example.com'
Tramp: Found remote shell prompt on `foo.example.com'
Tramp: Opening connection for root@foo.example.com using ssh...done
byte-code: `echo \"`uname -sr`\"' does not return a valid Lisp expression: `sh: uname: command not found 
```

此实例中的远程主机是较旧的 Fedora 安装，并且 uname 存在于`/bin/uname`. 我在 Ubuntu 12.10 机器上也遇到了同样的错误，所以我认为这不是远程主机的问题。我尝试了很多不同的方法，包括将值设置`tramp-remote-path`为无济于事。我当前的流浪汉相关配置如下：

```
(require 'tramp)
(setq tramp-default-method "ssh")
(add-to-list 'tramp-remote-path "/bin")
(add-to-list 'tramp-remote-path "/usr/bin")
(add-to-list 'tramp-remote-path "/usr/local/bin") 
```

我将不胜感激任何指示或帮助。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-25T12:43:14.023

在我的情况下，这个问题是由 .emacs 中的一个杂散设置引起的，它改变了 shell 设置。如果您积累了很多设置，我强烈建议您从头开始，而不是尝试调试您的 .emacs 文件。首先确保您可以通过 emacs 之外的 ssh 访问您的主机。一旦工作，运行

```
% emacs -q 
```

从没有配置文件开始。在emacs里面，做

```
(require 'tramp) 
```

并尝试在您的远程主机上打开一个文件

```
C-xC-f /your-host-name:/path/on/your/host/file.name 
```

如果这行得通，就像对我一样，太好了！现在您可以弄清楚 .emacs 中的什么问题导致了问题。查找与子 shell 或tramp 配置变量相关的任何内容，然后从那里开始工作。

如果问题仍然存在，请尝试为流浪汉添加更多诊断

```
(setq tramp-debug-buffer t)
(setq tramp-verbose 10) 
```

并检查输出缓冲区。特别是，试着弄清楚你是否到达了远程主机，或者在客户端被绊倒了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-27T20:56:29.107

在我的例子中，我调用了这个函数，我添加了这个函数来在 emacs 中执行乳胶内容

```
(defun set-exec-path-from-shell-PATH ()
  "Sets the exec-path to the same value used by the user shell"
  (let ((path-from-shell
         (replace-regexp-in-string
          "[[:space:]\n]*$" ""
          (shell-command-to-string "$SHELL -l -c 'echo $PATH'"))))
    (setenv "PATH" path-from-shell)
    (setq exec-path (split-string path-from-shell path-separator)))) 
```

在玩弄了我的 shell 和 homebrew 之后，我弄坏了一些东西，我得到了你描述的错误，所以最后我删除了那个函数，现在我的路径只有以下配置

```
(setenv "PATH" (concat (getenv "PATH") ":/bin"))
(setq exec-path (append exec-path '("/bin"))) 
```

# html - 固定宽度，根据父 div 的高度，以及根据屏幕内容和宽度其余部分的父 div 高度？

> ID：15531400
> 
> 赞同：1
> 
> 时间：2013-03-20T18:05:13.527
> 
> 标签：html, css, height, width

以此为例：

```
<div id="content">
  <div id="leftDiv" style="background:green;"></div>
  <div id="rightDiv">
    <p>Sample content</p>
    <p>Sample content</p>
    <p>Sample content</p>
    <p>Sample content</p>
  </div>
</div>
```

我希望 leftDiv 有一个固定的宽度，比如说 100px，然后右 div 应该使用屏幕的其余部分作为宽度。我希望 leftDiv 高度与 rightDiv 相同或至少为屏幕高度的 100%，并且 leftDiv 的高度与内容对齐。

我在 stackoverflow 的某个地方找到了这段代码，但第一个问题是它使用 % 作为 div 的宽度，第二个是我希望 min-height 是屏幕的 100%：

```
.floatLeft {
  float: left;
}
.child-left,
.child-right {
  width: 50%
}
.child-left {
  background: yellow;
}
.child-right {
  background: none repeat scroll 0 0 green;
  float: right;
  height: 100%;
  position: absolute;
  right: 0;
}
.parent {
  overflow: hidden;
  position: relative;
  width: 100%;
}
```

```
<html>

<head>
  <meta charset=utf-8 />
  <title>JS Bin</title>
  <!--[if IE]>
              <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
            <![endif]-->

</head>

<body>
  <div class="parent">
    <div class="child-left floatLeft">content content content content content content content content content content content content content content content content content content content content content content content content content content content content content content content
      content content content content content content content content content content content content content content content content content content content content content content content content content content content content content content content
      content content content content content content content content content content content content content content content content content content content content content content content content content content content content content content content
      content content content content content content content content content content content content content content content content content content content content content content content content content content content content content content content
      content content content content content content content content content content content content
    </div>

    <div class="child-right floatLeft">content content content content content content content content content content content content content content content content
    </div>
  </div>
</body>

</html>
```

我试着玩了好几个小时，但无法弄清楚。我不能将 child-left 设置为 100px 宽度和 child-right 宽度 auto，即使我将 *,html,body 设置为 100% 高度，我也不能将 min-height 设置为 100%。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:49:32.077

希望这是你正在寻找的..

```
#content {
  display: table;
  width: 100%;
  min-height: 100%;
  /* remove this line if not necessary */
}
#leftDiv,
#rightDiv {
  display: table-cell;
  min-height: 100%;
}
#leftDiv {
  width: 100px;
  background: green;
}
#rightDiv {
  background: cyan;
}
```

```
<html>

<head>

</head>

<body>
  <div id="content">
    <div id="leftDiv"></div>
    <div id="rightDiv">
      <p>Sample content</p>
      <p>Sample content</p>
      <p>Sample content</p>
      <p>Sample content</p>
    </div>
  </div>
</body>

</html>
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:27:33.267

这应该为您解决问题。但是请确保您的内容正确包装，因为我们使用的是溢出：隐藏。溢出：隐藏剪辑内容，甚至不显示其余内容的滚动条。

```
#outer {
  overflow: hidden;
  width: 100%;
}
#left {
  float: left;
  height: 100%;
  background: #fdd;
  width: 100px;
  overflow: auto;
}
#right {
  overflow: hidden;
  height: 100%;
  background: #ddf;
}
```

```
<html>

<head>

</head>

<body>
  <div id="outer">
    <div id="left">
      Left Div
    </div>
    <div id="right">
      Right Div
    </div>
  </div>
</body>

</html>
```

# windows - 在 Windows Azure 辅助角色和 Web 角色中使用 SignalR

> ID：15531401
> 
> 赞同：3
> 
> 时间：2013-03-20T18:05:16.150
> 
> 标签：windows, azure, signalr, azure-web-roles, azure-worker-roles

您是否可以创建一个集线器，您可以从工作角色和 Web 角色向客户端发送消息，或者拥有多个可以向客户端发送消息的不同工作角色？

或者是使用 SignalR 向客户端发送消息的推荐方式，以拥有一个 Web 角色来处理发送给客户端的所有消息，并且您将使用队列将来自所有其他角色的消息发送给客户端。我看到的另一个选项是我将为所有每个工作角色和 Web 角色都有一个集线器，并且您连接到几个不同的集线器？这对我来说似乎是一个不好的方法。

我们托管服务的最终目标是至少有 2 个 Web 角色和 3-5 个工作角色，并且系统是非常受事件驱动的，并且希望在消息发生时将消息推送到 Web 客户端，而不是在事件管道中添加另一个阶段用于向连接的客户端发送消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:48:09.780

您可以让您的 Azure 辅助角色通过 Ajax 或[SignalR .NET 客户端](http://www.asp.net/signalr/overview/signalr-20/hubs-api/hubs-api-guide-net-client)向您的 Web 角色发出请求。然后，您可以让您的 Web 角色代理从您的工作角色发送到您的“正常”（可能是 JS）客户端的消息。您可以使用组或特殊的辅助角色集线器来区分辅助角色客户端和普通客户端。

如果您想代理来自您的工作角色的消息作为 Ajax 响应的一部分，您可能希望查看 using`GetHubContext`以便您可以[从 hub 外部向客户端广播](http://www.asp.net/signalr/overview/signalr-20/hubs-api/hubs-api-guide-server#callfromoutsidehub)。

# c++ - 如何在 C++ 中将 IP 地址（ipv4 和 ipv6）转换为二进制？

> ID：15531402
> 
> 赞同：1
> 
> 时间：2013-03-20T18:05:19.757
> 
> 标签：c++, ip

我有一个代表 IP 地址的字符串，它可以是 ipv4 和 ipv6。

我想要的是将它转换为十进制形式，然后我可以从中获取各个位。

例如，对于由字符串“192.168.0.1”表示的地址，我想得到一个十进制的 3232235521。

最好的办法是使用一些标准库，例如函数[inet_pton](http://www.beej.us/guide/bgnet/output/html/multipage/inet_ntopman.html)会做得很好。但我不知道如何使用它。

[我根据此处](http://linux.die.net/man/7/ip)有关 sockaddr_in 的信息编写了以下代码：

```
 struct sockaddr_in sa;
   char str[INET_ADDRSTRLEN];
   // store this IP address in sa:
   inet_pton(AF_INET, "192.168.0.1", &(sa.sin_addr));
   cout<<"bin by inet_pton"<<sa.sin_addr.s_addr<<endl; 
```

这给了我 553779392。这个数字对应于 1.0.168.192。当然，我可以编写一些函数来以某种方式反转这个数字，但我正在寻找一些将 IP 地址转换为二进制的标准且有效的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:33:02.207

I yanked this code from Beej's Guide to Network Programming:

```
struct sockaddr_in antelope;
char *some_addr;

inet_aton("10.0.0.1", &antelope.sin_addr); // store IP in antelope

some_addr = inet_ntoa(antelope.sin_addr); // return the IP
printf("%s\n", some_addr); // prints "10.0.0.1"

// and this call is the same as the inet_aton() call, above:
antelope.sin_addr.s_addr = inet_addr("10.0.0.1"); 
```

What we have here is an example of moving an ip address back and forth between the type of struct which is generally used for storing address info and a string. The last line of this code is basically what you need. The integer representation of the ip address is being stored in antelope.sin_addr.s_addr. s_addr is just an unsigned long, so it should be exactly what you need. If you were to do this:

```
cout << antelope.sin_addr.s_addr << endl; 
```

you would get the decimal representation of 10.0.0.1

EDIT: I added a comment under your original code to express the issue with the code that you already had, which is basically just an issue with endianness. The code I gave you in this answer might give you the same problem. You need to use htonl() to reverse the byte order.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-23T16:37:57.310

**检索IP 地址的*INTEGER表示：***

我们需要密切关注@2to1mux 帖子中的以下信息。

**IP 地址的整数表示形式存储在 antelope.sin_addr.s_addr 中。**

**s_addr 只是一个无符号长**

例子：

```
struct sockaddr_in antelope;

// Here I had to convert from NSString to c string
inet_pton(AF_INET, [ipAddress UTF8String], &(antelope.sin_addr));

// This line gets the integer value
UInt32 address = antelope.sin_addr.s_addr; 
```

我希望这个额外的帖子能让像我这样的困惑者一目了然。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-27T12:17:49.753

登陆这里，寻找一个优雅的解决方案来测试一个 IP 地址是否在给定的一对 IP 地址之间。这是我在@2to1mux 的解决方案上构建的 2 美分。只需将它们放在一起，以防有人需要一个完整的示例。这可以修改为处理 IPV6 吗？

```
 #include <arpa/inet.h>
    #include <stdio.h>
    #include <stdlib.h>
    #include <string.h>

    size_t ip_to_num(int family, char *IP)
    {
        size_t i = 0;
        struct sockaddr_in antelope;
        inet_pton(family, IP, &(antelope.sin_addr));
        i = ntohl(antelope.sin_addr.s_addr);

        return i;
    }

    void print_num_to_ip(int family, size_t i)
    {
        /* This structure is actually not required here.
            Added just to show how numbers can be transformed into valid socket structures.
        */        
        struct sockaddr_in antelope; 

        memset(&antelope, 0, sizeof(antelope));
        antelope.sin_family = family;
        antelope.sin_port = htons(0);

        antelope.sin_addr.s_addr = htonl(i);
        printf("IP: %zu [%s] \n", i, inet_ntoa(antelope.sin_addr));    
    }

    int main ()
    {
        char IP[INET6_ADDRSTRLEN]="192.168.0.2";
        size_t x = 0;

        x = ip_to_num(AF_INET, IP);

        printf("IP: %zu [%s] \n", x, IP);

        print_num_to_ip(AF_INET, x);

        exit(EXIT_SUCCESS);
    } 
```

# asp.net - asp.net mvc 应用程序中的无扩展临时图像和正确的 IIS 映射

> ID：15531405
> 
> 赞同：0
> 
> 时间：2013-03-20T18:05:31.677
> 
> 标签：asp.net, asp.net-mvc, iis

在 mvc 应用程序中，需要将图像保存在临时文件夹中。当图像路径在 html 文档中解析时，我会收到有关 mime 映射的消息。临时文件被保存为 Temp\b824cc4f-c929-4e8e-9bfd-9a2f332589（无扩展名）。

我在[这里](https://stackoverflow.com/questions/11473632/extensionless-image-file-not-visible-in-iis7-5)找到了一个可能的解决方案，但它似乎增加了另一个部署要求。相关的应用程序配置部分如下：

```
<handlers>
      <remove name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" />
      <remove name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" />
      <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
      <add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
      <add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness64" responseBufferLimit="0" />
      <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
 </handlers> 
```

在应用程序中处理此问题的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:40:50.003

我可以通过将 '*'(image/png) mime 类型添加到临时目录来解决这个问题。我宁愿在应用程序 Web 配置中使用它，而不是将其变成部署要求。

![哑剧类型](../Images/4e04c3896afd28399fe2ad98bbf34a7b.png)

# java - 将货币/货币转换为美分，反之亦然

> ID：15531406
> 
> 赞同：-4
> 
> 时间：2013-03-20T18:05:35.013
> 
> 标签：java

由于圆形问题，我正在尝试将 cent (int) 存储在数据库中。

将双倍货币价值转换为美分的算法是什么，反之亦然？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:09:15.577

如果你有以下`double`值，

```
double allTheMoney = 123.54; // as in $123 + 54 cents 
```

您可以使用美分获得它，

```
int allCents = (int)(allTheMoney * 100);
// or using long
long allCents = Math.round(allTheMoney * 100); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:08:07.960

这既快速又简单：

```
double val = 1.45;
int cents = (int)(val * 100); 
```

或者

```
int cents = (int)Math.round(val*100); 
```

# objective-c - Obj-C：检查线程中是否存在窗口

> ID：15531410
> 
> 赞同：0
> 
> 时间：2013-03-20T18:05:47.483
> 
> 标签：objective-c, nswindow, nsthread

他，当单击主窗口中的按钮时，我以编程方式在线程中创建一个窗口。如果再次单击此按钮，窗口将关闭。美好的。但是当用户通过其关闭按钮关闭窗口时，线程并没有意识到这一点，继续运行。如果用户单击主窗口中的按钮，则线程会尝试关闭窗口并且应用程序会崩溃。所以我需要在线程中检查窗口是否存在。怎么做？谢谢

```
-(void)prefsWindow:(id)sender {
    NSRect frame = NSMakeRect(200, 200, 640, 480);
    NSWindow *pwindow  = [[NSWindow alloc] initWithContentRect:frame
                                                     styleMask:NSTitledWindowMask 
                                                       backing:NSBackingStoreBuffered
                                                         defer:NO];
    [pwindow center];
    [pwindow makeKeyAndOrderFront:NSApp];
    while (prefsA==1) {

        usleep(250000);}
    [pwindow close];
    [NSThread exit];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T18:29:03.457

这段代码有很多问题。

首先，不要从线程创建窗口。除非 NSWindow 被明确记录为线程安全，否则您不能从线程中使用它。

其次，您永远不应该使用 sleep() 进行轮询。

最后，没有理由为这样的窗口创建线程。

# c - 什么稀疏求解器支持对角线存储格式

> ID：15531413
> 
> 赞同：0
> 
> 时间：2013-03-20T18:05:55.117
> 
> 标签：c, sparse-matrix, intel-mkl

我正在使用 C 编写有限差分法程序。刚度矩阵是对称的和带状的。对于它的存储，我想使用稀疏对角存储格式。

有人可以告诉我，哪些求解器可以使用对角存储格式？Intel MKL 的 Paradiso 只使用 CRS 格式，SparseLib 没有，Spooles 似乎也 =(

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T19:02:30.723

稀疏库专注于通用稀疏存储。对于带状矩阵，您可以使用任何标准线性代数库，例如 LAPACK。

# android - 相对布局中的多个列表视图？

> ID：15531417
> 
> 赞同：1
> 
> 时间：2013-03-20T18:06:18.233
> 
> 标签：android, android-layout, listview

我无法为我的提要使用列表视图。我在同一个活动中将两个提要放在彼此之上，一个流新闻，现在我将事件添加到底部，但它无法识别第二个列表视图的 android id ？？？

```
<ListView
        android:id="@android:id/list"
        android:background="@color/red"
        android:layout_toRightOf="@+id/map"
        android:layout_width="260dp"
         android:layout_marginTop="5dp"
        android:layout_marginLeft="10dp"
        android:layout_height="413dp" /> 
```

这第一个列表视图完美运行。

```
<ListView  
        android:id="@+id/android:list1"
        android:background="@color/blue"
        android:layout_toRightOf="@+id/button3"
        android:layout_width="260dp"
        android:layout_marginTop="430dp"
        android:layout_marginLeft="6dp"
        android:layout_height="390dp" /> 
```

这个列表视图不起作用？？我知道它的android id吗？我尝试了几种变化？

```
android:id="@+id/android:list1"
android:id="@android:id/list1"
android:id="@+id/list1" 
```

需要什么帮助吗？我花了几个小时浏览代码，现在我知道它的 id 就是问题所在，因为如果我交换 listview 活动，那么第二个 listview 工作？

```
private class MyTask extends AsyncTask<Void, Void, Void>{

            @Override
            protected Void doInBackground(Void... arg0) {
                try {
                    URL rssUrl = new URL("http:/news.rss");
                    ///URL rssUrl1 = new URL("http://events.rss");

                    SAXParserFactory mySAXParserFactory = SAXParserFactory.newInstance();
                    SAXParser mySAXParser = mySAXParserFactory.newSAXParser();
                    XMLReader myXMLReader = mySAXParser.getXMLReader();
                    RSSHandler myRSSHandler = new RSSHandler();
                    myXMLReader.setContentHandler(myRSSHandler);

                    InputSource myInputSource = new InputSource(rssUrl.openStream());
                    myXMLReader.parse(myInputSource);
                    ///InputSource myInputSource1 = new InputSource(rssUrl1.openStream());
                    ///myXMLReader.parse(myInputSource1);

                    myRssFeed = myRSSHandler.getFeed(); 
                    ///myRssFeed1 = myRSSHandler.getFeed(); 

                } catch (MalformedURLException e) {
                    e.printStackTrace();    
                } catch (ParserConfigurationException e) {
                    e.printStackTrace();    
                } catch (SAXException e) {
                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();    
                }

                return null;
            }

            @Override
            protected void onPostExecute(Void result) {
                if (myRssFeed!=null || myRssFeed1!=null)
                {
                    TextView feedupdate = (TextView)findViewById(R.id.feedupdate);
                    feedupdate.setText(myRssFeed.getupdate());
                    //TextView feedupdate1 = (TextView)findViewById(R.id.feedupdate1);
                    ///feedupdate1.setText(myRssFeed1.getupdate());

                    ArrayAdapter<RSSItem> adapter =
                            new ArrayAdapter<RSSItem>(getApplicationContext(),
                                    android.R.layout.simple_list_item_1,myRssFeed.getList());
                    setListAdapter(adapter);
                    ///ArrayAdapter<RSSItem> adapter1 =
                            //new ArrayAdapter<RSSItem>(getApplicationContext(),
                                    //android.R.layout.simple_list_item_1,myRssFeed1.getList());
                    //setListAdapter(adapter1);

                }else{

                    TextView textEmpty = (TextView)findViewById(android.R.id.empty);
                    textEmpty.setText("No Feed Found");
                }

                super.onPostExecute(result);
            }   

        }   
        @Override
        protected void onListItemClick(ListView l, View v, int position, long id) {

            Uri feedUri = Uri.parse(myRssFeed.getItem(position).getLink());
            Uri feedUri1 = Uri.parse(myRssFeed1.getItem(position).getLink());
            Intent myIntent = new Intent(Intent.ACTION_VIEW, feedUri);
            Intent myIntent1 = new Intent(Intent.ACTION_VIEW, feedUri1);
            startActivity(myIntent);
            startActivity(myIntent1);
        }
    } 
```

* * *

```
public class HomeActivity extends ListActivity {
          static final LatLng TULLAMORE = new LatLng(53.28000, -7.49000);
          static final LatLng MRA = new LatLng(53.274823, -7.492655);
          private GoogleMap map;
          private RSSFeed myRssFeed = null;
          private RSSFeed myRssFeed1 = null;
          @Override

          protected void onCreate(Bundle savedInstanceState) {
            requestWindowFeature(Window.FEATURE_CUSTOM_TITLE);  
            super.onCreate(savedInstanceState);
            setContentView(R.layout.main); 
            getWindow().setFeatureInt(Window.FEATURE_CUSTOM_TITLE, R.layout.window_title);
            new MyTask().execute();

            map = ((MapFragment) getFragmentManager().findFragmentById(R.id.map))
                .getMap();
            Marker tullamore = map.addMarker(new MarkerOptions().position(TULLAMORE)
                .title("Tullamore"));
            Marker mra = map.addMarker(new MarkerOptions()
                .position(MRA)
                .title("-")
                .snippet("Hey :-)")
                .icon(BitmapDescriptorFactory
                    .fromResource(R.drawable.ic_launcher)));

            map.moveCamera(CameraUpdateFactory.newLatLngZoom(TULLAMORE, 70));
            // Zoom in, animating the camera.
            map.animateCamera(CameraUpdateFactory.zoomTo(10), 2000, null);
            map.setMyLocationEnabled(true);
            map.getUiSettings().setZoomControlsEnabled(true);
            map.getUiSettings().setMyLocationButtonEnabled(true);
            map.setTrafficEnabled(true);
            Button button1 = (Button) findViewById(R.id.button1);
            Button button2 = (Button) findViewById(R.id.button2);
            Button button3 = (Button) findViewById(R.id.button3);
            Button button4 = (Button) findViewById(R.id.button4);

            button2.setOnClickListener(new View.OnClickListener() { 
                @Override
                public void onClick(View arg0) {
                    //Starting a new Intent
                    Intent FavouritesScreen = new Intent(getApplicationContext(),FavouritesActivity.class); 
                    startActivity(FavouritesScreen);
                }
                });

            button4.setOnClickListener(new View.OnClickListener() { 
                @Override
                public void onClick(View arg0) {
                    //Starting a new Intent
                    Intent NearbyScreen = new Intent(getApplicationContext(), NearbyActivity.class);    
                    startActivity(NearbyScreen);
                }
                });

            button3.setOnClickListener(new View.OnClickListener() { 
            @Override
            public void onClick(View arg0) {
                //Starting a new Intent
                Intent TourismScreen = new Intent(getApplicationContext(), TourismActivity.class);  
                startActivity(TourismScreen);   
            }
            });

            button1.setOnClickListener(new View.OnClickListener() { 
                @Override
                public void onClick(View arg0) {
                    //Starting a new Intent
                    Intent MapScreen = new Intent(getApplicationContext(), MapActivity.class);  
                    startActivity(MapScreen);   
                }
                });
          }

            @Override
            public boolean onCreateOptionsMenu(Menu menu) {
              getMenuInflater().inflate(R.menu.home, menu);
              return true; 

            }
            private class MyTask extends AsyncTask<Void, Void, Void>{

                @Override
                protected Void doInBackground(Void... arg0) {
                    try {
                        URL rssUrl = new URL("http://www.midlandsireland.ie/news.rss");
                        URL rssUrl1 = new URL("http://feedity.com/midlandsireland-ie/V1pUU1VR.rss");

                        SAXParserFactory mySAXParserFactory = SAXParserFactory.newInstance();
                        SAXParser mySAXParser = mySAXParserFactory.newSAXParser();
                        XMLReader myXMLReader = mySAXParser.getXMLReader();
                        RSSHandler myRSSHandler = new RSSHandler();
                        myXMLReader.setContentHandler(myRSSHandler);

                        InputSource myInputSource = new InputSource(rssUrl.openStream());
                        myXMLReader.parse(myInputSource);
                        InputSource myInputSource1 = new InputSource(rssUrl1.openStream());
                        myXMLReader.parse(myInputSource1);

                        myRssFeed = myRSSHandler.getFeed(); 
                        myRssFeed1 = myRSSHandler.getFeed();    

                    } catch (MalformedURLException e) {
                        e.printStackTrace();    
                    } catch (ParserConfigurationException e) {
                        e.printStackTrace();    
                    } catch (SAXException e) {
                        e.printStackTrace();
                    } catch (IOException e) {
                        e.printStackTrace();    
                    }

                    return null;
                }

                @Override
                protected void onPostExecute(Void result) {
                    if (myRssFeed!=null || myRssFeed1!=null)
                    {
                        TextView feedupdate = (TextView)findViewById(R.id.feedupdate);
                        feedupdate.setText(myRssFeed.getupdate());
                        TextView feedupdate1 = (TextView)findViewById(R.id.feedupdate1);
                        feedupdate1.setText(myRssFeed1.getupdate());
                        ListView newsfeed = (ListView)findViewById(android.R.id.list);
                        ListView eventsfeed = (ListView)findViewById(R.id.list1);

                        ArrayAdapter<RSSItem> adapter =
                                new ArrayAdapter<RSSItem>(getApplicationContext(),
                                        android.R.layout.simple_list_item_1,myRssFeed.getList());                   
                        setListAdapter(adapter);

                    }else{

                        TextView textEmpty = (TextView)findViewById(android.R.id.empty);
                        textEmpty.setText("No Feed Found");
                    }

                    super.onPostExecute(result);
                }   

            }   
            @Override
            protected void onListItemClick(ListView l, View v, int position, long id) {     
                Uri feedUri = Uri.parse(myRssFeed.getItem(position).getLink());
                Intent myIntent = new Intent(Intent.ACTION_VIEW, feedUri);
                startActivity(myIntent);
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:55:26.727

这个标识：

```
android:id="@+id/android:list1"
android:id="@android:id/list1" 
```

SDK 中不存在。id`android:id="@+id/list1"`是有效的，如果你`findViewById(R.id.list1)`在`Activity`（它的内容是带有两个 的布局`ListViews`）中使用，你会发现`ListView`.

此外，正如您的代码所暗示的那样，您似乎正试图将两者`ListViews`作为一个来操纵，这将是完全错误的。在该`onPostExecute()`方法中，您将使用该`setListAdapter()`方法为`ListView`带有 id的适配器设置适配器，并为您将执行`android.R.id.list`的其他适配器：`ListView`

```
ListView second = (ListView) findViewById(R.id.list1);
// set the adapter for this ListView 
```

关于这段代码：

```
 Uri feedUri = Uri.parse(myRssFeed.getItem(position).getLink());
        Uri feedUri1 = Uri.parse(myRssFeed1.getItem(position).getLink());
        Intent myIntent = new Intent(Intent.ACTION_VIEW, feedUri);
        Intent myIntent1 = new Intent(Intent.ACTION_VIEW, feedUri1);
        startActivity(myIntent);
        startActivity(myIntent1); 
```

你想做什么开始两个（？！？！）活动（做什么？！）？

编辑：

```
try {
                URL rssUrl = new URL("http:/news.rss");
                SAXParserFactory mySAXParserFactory = SAXParserFactory.newInstance();
                SAXParser mySAXParser = mySAXParserFactory.newSAXParser();
                XMLReader myXMLReader = mySAXParser.getXMLReader();
                RSSHandler myRSSHandler = new RSSHandler();
                myXMLReader.setContentHandler(myRSSHandler);
                InputSource myInputSource = new InputSource(rssUrl.openStream());
                myXMLReader.parse(myInputSource);
                myRssFeed = myRSSHandler.getFeed(); 

                RSSHandler myRSSHandler1 = new RSSHandler();
                myXMLReader.setContentHandler(myRSSHandler1);

                URL rssUrl1 = new URL("http://events.rss");
                InputSource myInputSource1 = new InputSource(rssUrl1.openStream());
                myXMLReader.parse(myInputSource1);
                myRssFeed1 = myRSSHandler1.getFeed(); 
            } catch (MalformedURLException e) {
                e.printStackTrace();    
            } catch (ParserConfigurationException e) {
                e.printStackTrace();    
            } catch (SAXException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();    
            }

 @Override
        protected void onPostExecute(Void result) {
            if (myRssFeed!=null && myRssFeed1!=null) {
                ArrayAdapter<RSSItem> adapter =
                        new ArrayAdapter<RSSItem>(getApplicationContext(), android.R.layout.simple_list_item_1, myRssFeed.getList());
                setListAdapter(adapter);
                ArrayAdapter<RSSItem> adapter1 =
                       new ArrayAdapter<RSSItem>(getApplicationContext(),            android.R.layout.simple_list_item_1,myRssFeed1.getList());
                ListView lv = (ListView) findViewById(R.id.list1);
                lv.setAdapter(adapter1);
            } else {
             setListAdapter(new ArrayAdapter<RSSItem>(getApplicationContext(),            android.R.layout.simple_list_item_1, new ArrayList<RSSItem>()););
             ArrayAdapter<RSSItem> adapterEmpty1 = 
                       new ArrayAdapter<RSSItem>(getApplicationContext(),            android.R.layout.simple_list_item_1, new ArrayList<RSSItem>());
                ListView lv = (ListView) findViewById(R.id.list1);
                lv.setAdapter(adapterEmpty1);
            }   

        } 
```

# haskell - 如何让 GHC 在上下文中为带有 Typeable 的 GADT 生成 Data.Typeable 实例？

> ID：15531420
> 
> 赞同：7
> 
> 时间：2013-03-20T18:06:28.033
> 
> 标签：haskell, ghc, gadt, derived-instances

假设我有以下代码：

```
{-# LANGUAGE GADTs, DeriveDataTypeable, StandaloneDeriving #-}
import Data.Typeable

class Eq t => OnlyEq t
class (Eq t, Typeable t) => BothEqAndTypeable t

data Wrapper a where
    Wrap :: BothEqAndTypeable a => a -> Wrapper a

deriving instance Eq (Wrapper a)
deriving instance Typeable1 Wrapper 
```

然后，以下实例声明有效，对*没有*约束`t`：

```
instance OnlyEq (Wrapper t) 
```

并做我期望它做的事情。

* * *

但是下面的实例声明不起作用：

```
instance BothEqAndTypeable (Wrapper t) 
```

由于 GHC - 我正在使用 7.6.1 - 抱怨说：

```
No instance for (Typeable t)
  arising from the superclasses of an instance declaration
Possible fix:
  add (Typeable t) to the context of the instance declaration
In the instance declaration for `BothEqAndTypeable (Wrapper t)' 
```

当然，添加`Typeable t`到上下文中是可行的。但是添加以下实例也是如此：

```
instance Typeable (Wrapper t) where
    typeOf (Wrap x) = typeOf1 (Wrap x) `mkAppTy` typeOf x 
```

有没有办法让 GHC 为我编写后一个实例？如果是这样，怎么做？如果不是，为什么不呢？

我希望 GHC 能够`Typeable`从构造函数的上下文中提取约束`Wrap`，就像它对`Eq`约束所做的那样。我认为我的问题归结为 GHC 明确禁止写作`deriving instance Typeable (Wrapper t)`，并且标准`(Typeable1 s, Typeable a) => Typeable (s a)`实例无法“查看内部”`s a`来查找`Typeable a`字典。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T18:50:54.613

# java - 如何从 Android 应用程序通过 JDBC 连接到远程 MySQL 服务器

> ID：15531426
> 
> 赞同：4
> 
> 时间：2013-03-20T18:06:40.967
> 
> 标签：java, android, mysql, jdbc

我想出了如何在 Java 应用程序中连接到我的远程 MySQL 服务器。我很清楚这一点。我已经提供了我的代码和我为做同样的事情而采取的步骤，但来自一个 Android 应用程序。

**问题**我的代码没有连接有什么问题？我在 Java 中使用了类似的过程，并且效果很好。

1）我在项目属性中添加了 mysql-connector.jar 的外部 JAR 文件（我相信我使用的是 5.1）。这很好用，因为我在我的 Java 应用程序中使用它并与之连接。

2) 下面是连接和查询数据库的代码。我省略了查询信息和服务器信息，替换为 < >。显然：P

3）当我在手机上运行应用程序时，我收到以下消息：

com.mysql.jdbc.exceptions.jdbc4.CommunicationsException：通信链接失败。

4）我在Ubuntu服务器上运行wireshark，当它监听mysql端口时只看到SSTP条目。

```
package com.example.test_android;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.Statement;

import android.app.Activity;
import android.os.Bundle;
import android.widget.TextView;

public class MainActivity extends Activity {

    private static final String url = "jdbc:mysql://<server ip>:<sql port#>/<database name>";
    private static final String user = "<username>";
    private static final String pass = "<password>";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

         testDB();

    }//end oncreate method

    public void testDB() {
        TextView tv = (TextView)this.findViewById(R.id.text_view);
        try {
            Class.forName("com.mysql.jdbc.Driver");
            Connection con = DriverManager.getConnection(url, user, pass);
            /* System.out.println("Database connection success"); */

            String result = "Database connection success\n";
            Statement st = con.createStatement();
            ResultSet rs = st.executeQuery("SELECT * FROM <table in database>");
            ResultSetMetaData rsmd = rs.getMetaData();

            while(rs.next()) {
                result += rsmd.getColumnName(1) + ": " + rs.getInt(1) + "\n";
                result += rsmd.getColumnName(2) + ": " + rs.getString(2) + "\n";
                result += rsmd.getColumnName(3) + ": " + rs.getString(3) + "\n";
            }
            tv.setText(result);
        }
        catch(Exception e) {
            e.printStackTrace();
            tv.setText(e.toString());
        }   

    }

}//end class 
```

5）堆栈跟踪：

```
03-20 11:50:46.381: W/SurfaceFlinger(334): id=54501 Removed idx=5 Map Size=4
03-20 11:50:46.381: D/memalloc(334): ion: Freeing buffer base:0x42fb0000 size:1228800 fd:50
03-20 11:50:46.381: D/memalloc(334): ion: Freeing buffer base:0x43107000 size:1228800 fd:11
03-20 11:50:46.381: W/SurfaceFlinger(334): id=54501 Removed idx=-2 Map Size=4
03-20 11:50:46.381: D/memalloc(334): ion: Freeing buffer base:0x43c2d000 size:1228800 fd:53
03-20 11:50:46.381: D/KeyguardViewMediator(648): setHidden false
03-20 11:50:47.302: E/MP-Decision(1366): DOWN Ld:51 Ns:1.100000 Ts:190 rq:1.000000 seq:196.000000
03-20 11:50:47.492: D/STATUSBAR-NetworkController(805): onReceive() - RSSI_CHANGED_ACTION, WIFI_STATE, NETWORK_STATE
03-20 11:50:48.143: E/SMD(330): DCD ON
03-20 11:50:48.603: V/WindowOrientationListener(648): nearestRotation : 0   Angle: 348   tilt: 45
03-20 11:50:50.535: D/STATUSBAR-NetworkController(805): onReceive() - RSSI_CHANGED_ACTION, WIFI_STATE, NETWORK_STATE
03-20 11:50:50.555: E/MP-Decision(1366): UP Ld:50 Nw:1.990000 Tw:140 rq:2.700000 seq:147.000000
03-20 11:50:50.946: W/dalvikvm(23747): VFY: unable to find class referenced in signature (Ljavax/naming/Reference;)
03-20 11:50:50.946: I/dalvikvm(23747): Could not find method javax.naming.Reference.get, referenced from method com.mysql.jdbc.ConnectionPropertiesImpl$ConnectionProperty.initializeFrom
03-20 11:50:50.946: W/dalvikvm(23747): VFY: unable to resolve virtual method 11306: Ljavax/naming/Reference;.get (Ljava/lang/String;)Ljavax/naming/RefAddr;
03-20 11:50:50.946: D/dalvikvm(23747): VFY: replacing opcode 0x6e at 0x0004
03-20 11:50:50.946: W/dalvikvm(23747): VFY: unable to find class referenced in signature (Ljavax/naming/Reference;)
03-20 11:50:50.946: E/dalvikvm(23747): Could not find class 'javax.naming.StringRefAddr', referenced from method com.mysql.jdbc.ConnectionPropertiesImpl$ConnectionProperty.storeTo
03-20 11:50:50.946: W/dalvikvm(23747): VFY: unable to resolve new-instance 944 (Ljavax/naming/StringRefAddr;) in Lcom/mysql/jdbc/ConnectionPropertiesImpl$ConnectionProperty;
03-20 11:50:50.946: D/dalvikvm(23747): VFY: replacing opcode 0x22 at 0x0006
03-20 11:50:50.956: D/dalvikvm(23747): DexOpt: unable to opt direct call 0x2c2c at 0x14 in Lcom/mysql/jdbc/ConnectionPropertiesImpl$ConnectionProperty;.storeTo
03-20 11:50:51.146: E/SMD(330): DCD ON
03-20 11:50:51.476: I/dalvikvm(23747): Could not find method java.lang.management.ManagementFactory.getThreadMXBean, referenced from method com.mysql.jdbc.MysqlIO.appendDeadlockStatusInformation
03-20 11:50:51.476: W/dalvikvm(23747): VFY: unable to resolve static method 10657: Ljava/lang/management/ManagementFactory;.getThreadMXBean ()Ljava/lang/management/ThreadMXBean;
03-20 11:50:51.476: D/dalvikvm(23747): VFY: replacing opcode 0x71 at 0x0079
03-20 11:50:51.576: W/System.err(23747): com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure
03-20 11:50:51.576: W/System.err(23747): The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
03-20 11:50:51.576: W/System.err(23747):    at java.lang.reflect.Constructor.constructNative(Native Method)
03-20 11:50:51.576: W/System.err(23747):    at java.lang.reflect.Constructor.newInstance(Constructor.java:417)
03-20 11:50:51.576: W/System.err(23747):    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
03-20 11:50:51.586: W/System.err(23747):    at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1116)
03-20 11:50:51.586: W/System.err(23747):    at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:344)
03-20 11:50:51.586: W/System.err(23747):    at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2332)
03-20 11:50:51.586: W/System.err(23747):    at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2369)
03-20 11:50:51.586: W/System.err(23747):    at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2153)
03-20 11:50:51.586: W/System.err(23747):    at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:792)
03-20 11:50:51.596: W/System.err(23747):    at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:47)
03-20 11:50:51.596: W/System.err(23747):    at java.lang.reflect.Constructor.constructNative(Native Method)
03-20 11:50:51.596: W/System.err(23747):    at java.lang.reflect.Constructor.newInstance(Constructor.java:417)
03-20 11:50:51.596: W/System.err(23747):    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
03-20 11:50:51.596: W/System.err(23747):    at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:381)
03-20 11:50:51.596: W/System.err(23747):    at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:305)
03-20 11:50:51.606: W/System.err(23747):    at java.sql.DriverManager.getConnection(DriverManager.java:175)
03-20 11:50:51.606: W/System.err(23747):    at java.sql.DriverManager.getConnection(DriverManager.java:209)
03-20 11:50:51.606: W/System.err(23747):    at com.example.test_android.MainActivity.testDB(MainActivity.java:34)
03-20 11:50:51.606: W/System.err(23747):    at com.example.test_android.MainActivity.onCreate(MainActivity.java:24)
03-20 11:50:51.606: W/System.err(23747):    at android.app.Activity.performCreate(Activity.java:4470)
03-20 11:50:51.616: W/System.err(23747):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1053)
03-20 11:50:51.616: W/System.err(23747):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1934)
03-20 11:50:51.616: W/System.err(23747):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1995)
03-20 11:50:51.616: W/System.err(23747):    at android.app.ActivityThread.access$600(ActivityThread.java:128)
03-20 11:50:51.616: W/System.err(23747):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1161)
03-20 11:50:51.616: W/System.err(23747):    at android.os.Handler.dispatchMessage(Handler.java:99)
03-20 11:50:51.626: W/System.err(23747):    at android.os.Looper.loop(Looper.java:137)
03-20 11:50:51.626: W/System.err(23747):    at android.app.ActivityThread.main(ActivityThread.java:4517)
03-20 11:50:51.626: W/System.err(23747):    at java.lang.reflect.Method.invokeNative(Native Method)
03-20 11:50:51.626: W/System.err(23747):    at java.lang.reflect.Method.invoke(Method.java:511)
03-20 11:50:51.626: W/System.err(23747):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:980)
03-20 11:50:51.626: W/System.err(23747):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:747)
03-20 11:50:51.636: W/System.err(23747):    at dalvik.system.NativeStart.main(Native Method)
03-20 11:50:51.636: W/System.err(23747): Caused by: java.net.SocketException: android.os.NetworkOnMainThreadException
03-20 11:50:51.636: W/System.err(23747):    at com.mysql.jdbc.StandardSocketFactory.unwrapExceptionToProperClassAndThrowIt(StandardSocketFactory.java:408)
03-20 11:50:51.636: W/System.err(23747):    at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:269)
03-20 11:50:51.646: W/System.err(23747):    at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:294)
03-20 11:50:51.646: W/System.err(23747):    ... 28 more
03-20 11:50:51.786: W/SurfaceFlinger(334): id=54502(1) createSurface 0x1b75144 (1x1),2 flag=400
03-20 11:50:51.786: D/KeyguardViewMediator(648): setHidden false
03-20 11:50:51.786: D/STATUSBAR-StatusBarManagerService(648): setSystemUiVisibility(0x0)
03-20 11:50:51.786: D/STATUSBAR-StatusBarManagerService(648): manageDisableList what=0x0 pkg=WindowManager.LayoutParams
03-20 11:50:51.867: D/CLIPBOARD(1073): Hide Clipboard dialog at Starting input: finished by someone else... !
03-20 11:50:51.867: I/ClipboardServiceEx(648): mCBPickerDialog enter case. MSG_DISMISS_DIALOG
03-20 11:50:51.867: I/ClipboardServiceEx(648): Send intent for dismiss clipboard dialog inside hideCurrentInputLocked() ! 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T15:58:55.480

有两件事为什么它在这里不起作用

jdbc 无法访问您提供的 url，该 URL 必须可以公开访问，这意味着您的服务器即：SAY xyzw:port

所以需要一个网络人员来释放服务器 ip 上的这个端口并使其公开可用

**警告**

公开打开它会对您的数据库造成威胁，因为任何知道它的人都可以写入它。

**忠告** 永远不要让您的应用程序直接与数据库通信，允许像 jsp、servlets、asp、python 等这样的服务器技术接收您的请求并为您执行此操作。

我希望这会有所帮助。

# vbscript - vbscript 在 hta 上不起作用

> ID：15531427
> 
> 赞同：0
> 
> 时间：2013-03-20T18:06:43.477
> 
> 标签：vbscript, hta

请帮助我试图在我们网络上的另一台计算机上显示一条消息我们不能使用网络发送，因为在 Windows 7 上不存在，我们不能使用 MSG，因为它被禁用，如果我们启用它，GPO 将禁用它。所以我在用户的计算机上有一个显示消息的 vbscript，以及另一个发送要显示的消息的 vbscript。当我使用此代码将消息作为常规 vbscript 发送时，它可以工作

```
Dim strMessage, strComputer, strLocalPath, strFile, objShell 
Dim strRemotePath, objShellApp, strTest, sPSEXEC
strComputer = InputBox("enter computer Name", "create File")
Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate}!\\" & 
strComputer & "\root\cimv2")
Set colComputer = objWMIService.ExecQuery ("Select * from Win32_ComputerSystem")
Set objShell = CreateObject("WScript.Shell")
Set objShellApp = CreateObject("Shell.Application")
currentpath = objShell.CurrentDirectory & "\"
sPSEXEC = currentPath & "psexec.exe"
strFile = """c:\windows\notification.vbs"""
strMessage = InputBox("enter Message", "create File")
strTest = "\\"&strComputer&" " &"cscript.exe"&" "&strFile&" 
"&"/message:"&Chr(34)&strMessage&Chr(34)
WScript.Echo strTest
objShellApp.ShellExecute "cmd.exe","/k "&sPSEXEC&" -s -i -d "&" "&strTest, "","runas",1 
```

但是在 hta 上放置相同的代码它尝试在用户计算机上打开脚本但它在显示消息之前就死了

```
<script Language = VBScript>
On Error Resume Next
Sub WindowsLoad
Dim strMessage, strComputer, strLocalPath, strFile, objShell
Dim strRemotePath, objShellApp, strTest, sPSEXEC    
strComputer = computerName.Value
Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate}!\\" & 
_strComputer & "\root\cimv2")
Set colComputer = objWMIService.ExecQuery ("Select * from Win32_ComputerSystem")
Set objShell = CreateObject("WScript.Shell")
Set objShellAPP = CreateObject("Shell.Application")
currentpath = objShell.CurrentDirectory & "\"
sPSEXEC = currentPath & "psexec.exe"
strFile = """c:\windows\notification.vbs"""
strTest = "\\"&strComputer&" " &"cscript.exe"&" "&strFile&"   
_"&"/message:"&Chr(34)&strMessage&Chr(34)
objShellApp.ShellExecute "cmd.exe","/k "&sPSEXEC&" -s -i -d "&" "&strTest, "", 
_"runas", 1
End Sub
</script>
<Body>
<div>
</div>

Computer Name: <Input align="right" Type = "Text" Name = "computerName">
</br>
</br>
Message: 
</br>
<TEXTAREA NAME="Message" COLS=30 ROWS=6>

</TEXTAREA>
</br>
</br>
<Input Type = "Button" Value = "Send Message" Name = "Run_Button" onClick = "WindowsLoad"><P> 
```

请帮忙？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:37:12.723

First and foremost: a global `On Error Resume Next` is the root of all evil. Do **not** use this unless you know *exactly* what you're doing and how to handle any error that may occur.

That said, your script probably dies, because the VBScript code in the HTA is invalid. If you want to use line continuation, the underscore **must** be at the **end** of the line you want to continue, not at the **beginning** of the continued line:

```
Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate}!\\" & 
_strComputer & "\root\cimv2") 
```

Also you cannot use line continuation **inside** a string:

```
strTest = "\\"&strComputer&" " &"cscript.exe"&" "&strFile&"   
_"&"/message:"&Chr(34)&strMessage&Chr(34) 
```

# javascript - 可移动的 div 代码 - 每次我单击右侧的代码时，它都会自动重新定位到左侧

> ID：15531433
> 
> 赞同：0
> 
> 时间：2013-03-20T18:07:15.567
> 
> 标签：javascript

我有一个 javascript 代码，我已经合并它来控制两个不同的可移动 div id。左边的那个很好，因为起点在左上角；但是，每次我尝试移动页面右侧的页面时，它都会变得混乱。它是javascript代码中的东西吗？我该如何解决？

HTML

```
<div id="fm1" style="left: 0; top: 25px;" onMouseDown="dragStart(event, 'fm1')";>
  <p>Site Editor</p>
<a href="#">Add a page</a>
<a href="#">Change page order</a>
<a href="#">Change colors</a>
</div>

<div id="fm2" style="right: 0; top: 25px;" onMouseDown="dragStart(event, 'fm2')";>
  <p>Page Editor</p>
<a href="#">Change Layout</a>
<a href="#">Change Page Name</a>
<a href="#">Password Protect</a>
</div> 
```

CSS

```
#fm1, #fm2 {
width: 160px;
position: fixed;
background-color: #000;
font-family: Tahoma, Geneva, sans-serif;
font-size: 14px;
text-align: center;
font-weight: bold;
color: #FFF;
cursor: move;
z-index: 999999999;
}
#fm1 a, #fm2 a {
float: left;
display: block;
width: 160px;
height: 25px;
font-weight: bold;
text-align: center;
color: #fff;
background: #000;
border-top: 1px solid #fff;
}
#fm1 a:hover, #fm2 a:hover { background: #1e7c9a; } 
```

javascript

```
 function getID(id)
    {
        return document.getElementById(id);
    }
    // Global object to hold drag information.
    var dragObj = new Object();
    function dragStart(event, id) {
      var x, y;
      dragObj.elNode = getID(id);
      // Get cursor position with respect to the page.
      try {
        x = window.event.clientX + document.documentElement.scrollLeft
          + document.body.scrollLeft;
        y = window.event.clientY + document.documentElement.scrollTop
          + document.body.scrollTop;
      }
      catch (e) {
        x = event.clientX + window.scrollX;
        y = event.clientY + window.scrollY;
      }
    // Save starting positions of cursor and element.
     dragObj.cursorStartX = x;
      dragObj.cursorStartY = y;
      dragObj.elStartLeft  = parseInt(dragObj.elNode.style.left, 10);
      dragObj.elStartTop   = parseInt(dragObj.elNode.style.top,  10);
      if (isNaN(dragObj.elStartLeft)) dragObj.elStartLeft = 0;
      if (isNaN(dragObj.elStartTop))  dragObj.elStartTop  = 0;
      // Capture mousemove and mouseup events on the page
      try {
        document.attachEvent("onmousemove", dragGo);
        document.attachEvent("onmouseup",   dragStop);
        window.event.cancelBubble = true;
        window.event.returnValue = false;
      }
      catch (e) {
        document.addEventListener("mousemove", dragGo,   true);
        document.addEventListener("mouseup",   dragStop, true);
        event.preventDefault();
      }
    }
    function dragGo(event) {
     var x, y;
    // Get cursor position with respect to the page.
    try  {
        x = window.event.clientX + document.documentElement.scrollLeft
          + document.body.scrollLeft;
        y = window.event.clientY + document.documentElement.scrollTop
          + document.body.scrollTop;
      }
      catch (e) {
        x = event.clientX + window.scrollX;
        y = event.clientY + window.scrollY;
      }
      // Move drag element by the same amount the cursor has moved.
      var drLeft = (dragObj.elStartLeft + x - dragObj.cursorStartX);
      var drTop = (dragObj.elStartTop  + y - dragObj.cursorStartY);
      if (drLeft > 0)
      {
         dragObj.elNode.style.left = drLeft  + "px";
      }
      else
      {
        dragObj.elNode.style.left = "0px";
      }
      if (drTop > 0)
      {
         dragObj.elNode.style.top  = drTop + "px";
      }
      else
      {
        dragObj.elNode.style.top  = "0px";
      }
      try {
        window.event.cancelBubble = true;
        window.event.returnValue = false;
      }
      catch(e){
        event.preventDefault();
      }
    }
    function dragStop(event) {
      // Stop capturing mousemove and mouseup events.
      try {
        document.detachEvent("onmousemove", dragGo);
        document.detachEvent("onmouseup",   dragStop);
      }
      catch (e) {
        document.removeEventListener("mousemove", dragGo,   true);
        document.removeEventListener("mouseup",   dragStop, true);
      }
    } 
```

注意：一旦正确的重新定位之一，我就可以完全控制它的移动。我只是不希望它在第一次移动时自动跳转到页面的左侧。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T19:35:28.610

`<div id="fm2" style="right: 0;`

您将 div 定位为`right`，因此`left`未定义且`style.left`为空。

```
 dragObj.elStartLeft  = parseInt(dragObj.elNode.style.left, 10);
  if (isNaN(dragObj.elStartLeft)) dragObj.elStartLeft = 0; 
```

在您的代码中，您只关心`left`它，因为它是未定义的，所以您从 0 开始。

# ruby - PGconn.connect ruby pg gem 中所需哈希的详细信息

> ID：15531440
> 
> 赞同：0
> 
> 时间：2013-03-20T18:07:31.313
> 
> 标签：ruby, postgresql, pg

我想更好地记录我的代码，而不是像下面这样声明：

```
pg_c = PGconn.connect("Main-my_db_lk", 5433, '', '', "report_center", "repozenter", "rp_23_xhg") 
```

我怎么知道这个声明是什么？是否可以像这样指出方法的每个参数：port => 5433, host=> xxx

如何更好地编写连接字符串？什么是空的第三个和第四个参数？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T15:55:14.923

以数组形式连接的参数是：主机、端口、选项、tty、dbname、用户和密码。

第三个参数可以包含一个或多个[运行时选项](http://www.postgresql.org/docs/9.2/static/runtime-config.html)，例如，

```
[1] pry(main)> c = PG.connect( '', '', '-c search_path=public,test', '', 'test' )
=> #<PG::Connection:0x007f9e19c16d30>
[2] pry(main)> c.exec( 'show search_path' ).values
=> [["public,test"]] 
```

第 4 个参数不再使用，但仍然是为了向后兼容。

正如您所建议的，您还可以在连接时传递选项哈希，这更清楚一点：

```
conn = PG.connect( :dbname => 'test', :user => 'postgres' ) 
```

[PG::Connection.new 的 API 文档](http://deveiate.org/code/pg/PG/Connection.html#method-c-new)中列出了可用的密钥。

# delphi - 如何在 Delphi XE2 上实现 uPnP

> ID：15531441
> 
> 赞同：2
> 
> 时间：2013-03-20T18:07:33.720
> 
> 标签：delphi, indy, upnp

我在 Delphi XE2 上使用 indy TidHTTPServer 实现了一个 Http 服务器。该产品主要用于Intranet，但有时也需要从Internet访问。目标客户是小公司，因此 PnP 功能是必须的。

对于内部使用，此服务器使用服务器的当前 IP 并尝试分配端口 8888。

我想在网络上发现一个可以让我请求端口路由的 wandevice。我也不确定端口路由是否是最好的解决方案，我不熟悉这些可能性。但是我更喜欢最广泛可用的可能性，因为我相信并非所有路由器都有完整的选择。

对于这些情况，我正在考虑随 DSL 安装一起提供的常见路由器，如 linksys、tplink 等，在小公司中广泛使用。

如果有已经实现此功能的组件或源代码的链接，那就更好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T18:49:48.677

UPnP Delphi 组件似乎可用

*   [http://www.whitebear.ch/upnp.htm](http://www.whitebear.ch/upnp.htm)（带有源代码、免费软件/捐赠软件）

此处提供了 UPnP 基础知识和源示例链接的描述

*   [http://francois-piette.blogspot.de/2013/02/using-universal-plug-and-play-upnp-with.html](http://francois-piette.blogspot.de/2013/02/using-universal-plug-and-play-upnp-with.html)

关于使用 Indy 发现设备的相关问题：

*   [我可以使用 IdUDPClient 发送 M-SEARCH 请求吗？](https://stackoverflow.com/questions/10909462/can-i-use-idudpclient-to-send-m-search-request)

# mono - MonoDevelop T4 模板中的宏

> ID：15531442
> 
> 赞同：1
> 
> 时间：2013-03-20T18:07:34.640
> 
> 标签：mono, monodevelop, t4

在 MonoDevelop 中运行包含路径宏的 T4 模板时，即 ${ProjectDir}、${TargetFileName}

```
<#@ template debug="false" hostspecific="false" language="C#" #>
<#@ assembly name="${ProjectDir}${OutDir}${TargetFileName}" #>
<#@ import namespace="System" #> 
<#@ import namespace="System.Reflection" #> 
... 
```

MonoDevelop 吐出以下错误：

```
Running generator 'TextTemplatingFileGenerator'
error CS0006: Metadata file `${ProjectDir}${OutDir}${TargetFileName}' could not be found 
```

我试过同时使用花括号和圆括号。我究竟做错了什么？

# css - 如何将元素置于段落旁边的右上角？

> ID：15531443
> 
> 赞同：1
> 
> 时间：2013-03-20T18:07:36.500
> 
> 标签：css, layout

假设我的设置是这样的：

```
<div style="width:200px;">
    <label for="derp">This is an arbitrary paragraph of text that happens to be a label for a form element, in my case.</label>
    <input type="checkbox" name="derp">
</div> 
```

应用于`float: right;`复选框将其定位在右侧，但我需要它通过文本标签向上推到容器的右上角。

我似乎失去了对简单概念的掌握......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:10:03.480

当您浮动一个元素时，它会浮动在它之后的内容旁边，而不是之前。所以切换标签和输入的顺序，它应该可以工作。

# python - 使用 ndb 在 GAE 中出错 - BadQueryError：无法将 FalseNode 转换为谓词

> ID：15531450
> 
> 赞同：14
> 
> 时间：2013-03-20T18:07:52.013
> 
> 标签：python, google-app-engine, app-engine-ndb

我有一个使用 python 在 Google App Engine 上运行的应用程序。模型类从 ndb (google.appengine.ext.ndb) 类扩展而来。

我的一个观点对数据库进行异步调用，或多或少类似于：

```
# ExerciseListLog is a ndb model class
# start_current, end_current are dates
# student_id is a string
# contents is a list of keys

exercise_log_query = ExerciseListLog.query(ndb.AND(ExerciseListLog.creation >= start_current,
    ExerciseListLog.creation < end_current,
    ExerciseListLog.user_id == student_id))
exercise_log_query = exercise_log_query.filter(ExerciseListLog.content.IN(contents))

future = exercise_log_query.count_async()

count = future.get_result() # this throws BadQueryError 
```

这会在 get_result() 上引发错误：BadQueryError: Cannot convert FalseNode to predicate

但只有当我将代码部署到 Google 云时才会发生这种情况。当我在本地运行它时，它工作正常。

我不知道这个错误是什么意思，在谷歌上查找并没有多大帮助。有人知道这里有什么问题吗？

这是来自 GAE 日志的完整堆栈跟踪

```
Traceback (most recent call last):
  File "/base/data/home/apps/s~qmagtest/1.366092357976105290/zen/web/gae/convention.py", line 48, in make_convention
    method(*args, **kwargs)
  File "/base/data/home/apps/s~qmagtest/1.366092357976105290/core/web/qmhandler.py", line 48, in wrapper
    return method(self, *args, **kwargs)
  File "/base/data/home/apps/s~qmagtest/1.366092357976105290/core/user/login/security.py", line 36, in wrapper
    method(self, *args, **kwargs)
  File "/base/data/home/apps/s~qmagtest/1.366092357976105290/core/user/security.py", line 17, in wrapper
    method(self, *args_inner, **kwargs)
  File "/base/data/home/apps/s~qmagtest/1.366092357976105290/plugins/web/desempenho/estatisticas.py", line 127, in class_activities
    school_class.content)
  File "/base/data/home/apps/s~qmagtest/1.366092357976105290/plugins/web/desempenho/estatisticas.py", line 178, in _get_exercise_video_and_total_weekly_series
    exercise_log_count = exercise_count_futures[i].get_result()
  File "/python27_runtime/python27_lib/versions/1/google/appengine/ext/ndb/tasklets.py", line 325, in get_result
    self.check_success()
  File "/python27_runtime/python27_lib/versions/1/google/appengine/ext/ndb/tasklets.py", line 371, in _help_tasklet_along
    value = gen.send(val)
  File "/python27_runtime/python27_lib/versions/1/google/appengine/ext/ndb/query.py", line 1227, in _count_async
    dsquery = self._get_query(conn)
  File "/python27_runtime/python27_lib/versions/1/google/appengine/ext/ndb/query.py", line 873, in _get_query
    filters = filters._to_filter()
  File "/python27_runtime/python27_lib/versions/1/google/appengine/ext/ndb/query.py", line 599, in _to_filter
    for node in self.__nodes
  File "/python27_runtime/python27_lib/versions/1/google/appengine/ext/ndb/query.py", line 600, in <genexpr>
    if isinstance(node, PostFilterNode) == post))
  File "/python27_runtime/python27_lib/versions/1/google/appengine/ext/ndb/query.py", line 425, in _to_filter
    'Cannot convert FalseNode to predicate')
BadQueryError: Cannot convert FalseNode to predicate 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-21T16:22:23.277

我怀疑问题是内容是一个空列表。这几乎是 FalseNode 可能出现的唯一原因。（另一个是在没有参数的情况下调用 AND()。）您对删除这条线的观察证实了我的预感。您可能没想到会发生这种情况，并且在您的本地测试中从未发生过……您可能需要调试该列表中出现的代码。

我同意错误信息可能会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T19:08:24.683

更新：

我发现如果我删除该行：

```
exercise_log_query = exercise_log_query.filter(ExerciseListLog.content.IN(contents)) 
```

然后它将起作用。

因此，该错误与对数据库的异步调用无关。发生这种情况是因为 Google AppEngine 每个查询仅在一个字段中支持不等式过滤器。显然使用“content.IN”算作第二个不等式，这是不允许的。

该错误消息可能会更好。

* * *

更新：

事实证明 Guido 是对的，而我上面的解释是错误的。content.IN 现在正在工作，`contents`它不为空。

# javascript - 使用 Codemirror 的键盘映射防止默认事件发生

> ID：15531453
> 
> 赞同：7
> 
> 时间：2013-03-20T18:07:56.627
> 
> 标签：javascript, codemirror

我试图弄清楚如何防止浏览器在 Codemirror 中显示带有 ctrl-s 或 cmd-s 事件的保存对话框。我可以让 extraKeys 工作，我只是无法避免调用恢复事件。我试过 return false 并且我已经挖掘了文档和示例。有谁知道如何防止默认发生？

这是代码：

```
var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
lineNumbers: true, mode: "text/html",
   extraKeys: {
      "Ctrl-S": function (instance) {
         alert("your mom");
         return false;
      },
      "Cmd-S": function (instance) {
         alert("my mom");
         return false;
      }
   }
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-08-25T18:46:07.143

这是一个古老的问题，解决方案已经在答案中，但是对于正在寻找使用 CodeMirror 实现 Ctrl-S / Cmd-S 的解决方案的任何人，我想有一个更好的解决方案，如[CodeMirrror 文档中所述](http://codemirror.net/doc/manual.html#commands)

```
CodeMirror.commands.save = function() {
    /* Do your stuff */
}; 
```

# scala - 如何将闪存数据从控制器传递到使用 Play 进行查看！框架

> ID：15531455
> 
> 赞同：10
> 
> 时间：2013-03-20T18:08:06.630
> 
> 标签：scala, playframework, playframework-2.0

我一直在玩游戏！到目前为止，学习曲线有一些颠簸。现在我无法将闪存数据从控制器传递到视图，起初我认为这是一项微不足道的任务，或者至少应该如此。

这是我现在拥有的：

我有一个主要布局：application.scala.html

我在布局中有一个视图：login.scala.html

我有我的控制器和方法：UX.authenticate() - 我希望它根据登录尝试的结果（成功与失败）向视图提供闪存数据

这是我的控制器方法中的代码：

```
def authenticate = Action { implicit request =>
        val (email, password) = User.login.bindFromRequest.get
        // Validation
        // -- Make sure nothing is empty
        if(email.isEmpty || password.isEmpty) {
            flash + ("message" -> "Fields cannot be empty") + ("state" -> "error")
            Redirect(routes.UX.login())
        }
        // -- Make sure email address entered is a service email
        val domain = email.split("@")
        if(domain(1) != "example.com" || !"""(\w+)@([\w\.]+)""".r.unapplySeq(email).isDefined) {
            flash + ("message" -> "You are not permitted to access this service") + ("state" -> "error")
            Redirect(routes.UX.login())
        } else {
            // Attempt login
            if(AuthHelper.login(email, password)) {
                // Login successful
                val user = User.findByEmail(email)
                flash + ("message" -> "Login successful") + ("state" -> "success")
                Redirect(routes.UX.manager()).withSession(
                  session + (
                    "user"      -> user.id.toString
                  )
                )
            } else {
                // Bad login
                flash + ("message" -> "Login failed") + ("state" -> "error")
                Redirect(routes.UX.login())
            }
        }
    } 
```

在我的登录视图中，我有一个参数：`@(implicit flash: Flash)`

当我尝试使用闪光灯时，没有出现使用`@flash.get("message")`

理想情况下，我想`@(implicit flash: Flash)`在布局中进行设置，以便我可以从任何控制器刷新数据，它会到达我的视图。但是每当我这样做时，登录视图都会引发错误。

在我现在的登录视图中，我有这个：

```
def login = Action { implicit request =>
        flash + ("message" -> "test")
        Ok(views.html.ux.login(flash))
    } 
```

将闪存数据传递到视图的理想方式是什么，是否有任何示例？Play 中的示例！框架文档没有任何帮助，并且仅限于两个根本不显示与视图交互的示例（在底部找到：[http](http://www.playframework.com/documentation/2.0/ScalaSessionFlash) ://www.playframework.com/documentation/2.0/ScalaSessionFlash ）。

有没有更简单的选择？我究竟做错了什么？如何将闪存数据直接传递到我的布局视图？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T18:54:06.567

如果您查看[Session 和 Flash 范围](http://www.playframework.com/documentation/2.1.0/ScalaSessionFlash)的文档，您将看到以下代码片段：

```
def save = Action {
  Redirect("/home").flashing(
    "success" -> "The item has been created"
  )
} 
```

现在，将其与您对闪光灯范围的使用进行比较：

```
flash + ("message" -> "Login successful") + ("state" -> "success") 
```

这种用法的问题是闪存是不可变的，您无法重新分配它。此外，您在这里的使用实际上是在创建一个新的闪存变量，它只是没有被使用。

如果您将其稍微修改为：

```
implicit val newFlash = flash + ("message" -> "Login successful") + ("state" -> "success")
Redirect(...) 
```

它会奏效的。但是，首选用法是对`.flashing()`结果使用方法。此方法来自 play.api.mvc.WithHeaders，这是一个混入 play.api.mvc.PlainResult 的特征，各种结果方法（Ok、Redirect 等）都继承自该特征。

然后，如文档中所示，您可以访问模板中的 flash 范围：

```
@()(implicit flash: Flash) ... 
@flash.get("success").getOrElse("Welcome!") ... 
```

编辑：啊，好吧。我已经查看了您的示例代码，现在我看到了您要执行的操作。我认为您真正要寻找的是处理表单提交的规范方式。[查看文档中此处](http://www.playframework.com/documentation/2.1.0/ScalaForms)的约束定义，我认为您会发现有更好的方法来完成此操作。本质上，您将希望在`verifying`支持您的表单的元组上使用该方法，以便`bindFromRequest`无法绑定并且可以将验证错误传递回视图：

```
loginForm.bindFromRequest.fold(
  formWithErrors => // binding failure, you retrieve the form containing errors,
    BadRequest(views.html.login(formWithErrors)),
  value => // binding success, you get the actual value 
    Redirect(routes.HomeController.home).flashing("message" -> "Welcome!" + value.firstName)
) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-09T19:51:43.570

想在此讨论中再添加一件事，以帮助人们避免此错误：

```
could not find implicit value for parameter flash: play.api.mvc.Flash 
```

我知道其中很多都是多余的，但最后有一个技术问题占用了我一半的工作日，我觉得我可以帮助人们。附加 .flashing(/* 你的 flash 作用域信息 */)，例如：

```
Redirect(routes.ImageEditApp.renderFormAction(assetId)).
  flashing("error" -> "New filename must be unused and cannot be empty.") 
```

...**确实**定义了您可以在模板中使用的隐式“flash”变量，如果您有一个“基础”模板要处理闪存范围（例如错误），那么基础模板的**单一**使用很容易，因为您已经通过 .flashing() 定义了隐式 flash 变量...这是我的基本模板“包含”之一的示例。

```
@views.html.base("Editing: "+asset.id, scripts = Some(scripts),
  extraNav = Some(nav)) 
```

您不必**将**“flash”变量传递给基本模板。这是一个隐含的。基本模板仍然必须定义它。我的基本模板的参数是这样的：

```
@(title: String, stylesheets: Option[Html] = None,
  scripts: Option[Html] = None,
  extraNav: Option[Html] = None)(content: Html)(implicit flash: Flash) 
```

是的，我知道很多都是不必要的，但这是我复制粘贴的真实世界示例。无论如何，您可能需要**其他模板**来使用您的基本模板，并且您**并不总是使用 .flash()**来加载它们。由于您肯定会使用控制器加载这些，因此如果您忘记使用**隐式请求 =>**为每个操作启动您的操作，例如：

```
def controllerMethodName() = Action { implicit request => 
```

那么“flash”隐式将不会被定义。然后，当该模板尝试包含您的基本模板时，您会感到困惑，因为您没有定义**默认的 flash**隐式变量，而基本模板需要它。因此出现了这个错误。

再一次，修复.. 转到所有控制器方法，并**确保输入隐式请求 =>**！

# c# - WPF Prism 模块错误解决 IUnityContainer

> ID：15531459
> 
> 赞同：2
> 
> 时间：2013-03-20T18:08:14.533
> 
> 标签：c#, wpf, prism, unity-container

我有一个非常基本的 prism 应用程序，我试图将其用作大型项目的开始。我有一个外壳，其中定义了一个名为“MainContent”的区域。项目中有3个模块。一个 MainMenuModule、一个 MovieModule 和一个 TVModule。Movie 和 TV 模块依赖于 MainMenuModule。使用 DirectoryModuleCatalog 加载模块。包含 TVModule 时会出现此问题，更具体地说，当调用 TVModule 的构造函数时会引发异常。下面的构造函数会抛出错误：

```
public TVModule(IUnityContainer container, IRegionManager manager)
{
    _container = container;
    _manager = manager;
} 
```

如果我将构造函数更改为以下内容，则不会出现异常，并且 TVModule 会按预期加载。

```
public TVModule(IRegionManager manager)
{
    _manager = manager;
} 
```

当 Unity 尝试解析 IUnityContainer 时抛出我得到的异常。真正让我困惑的是，MovieModule 的构造器与 TVModule 的构造器完全相同，但可以毫无问题地工作。异常详细信息。

> {“依赖项解析失败，type = \"TVModule.TVModule\", name = \"(none)\"。异常发生时：解析时。异常是：InvalidOperationException - 当前类型，Microsoft.Practices.Unity。 IUnityContainer，是一个接口，不能构造。你是不是缺少类型映射？在异常的时候，容器是：
> 
> Resolving TVModule.TVModule,(none) Resolving parameter \"container\" of constructor TVModule.TVModule(Microsoft.Practices.Unity.IUnityContainer container, Microsoft.Practices.Prism.Regions.IRegionManager manager) Resolving Microsoft.Practices.Unity.IUnityContainer, （没有任何） ”}
> 
> {“当前类型，Microsoft.Practices.Unity.IUnityContainer，是一个接口，无法构造。你是否缺少类型映射？”}

编辑：我已将我的源代码的副本上传到[此处的保管箱](http://dl.dropbox.com/u/56578152/Media.zip)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T12:51:30.023

根据 Wiktor 的建议，我已经删除了将 Unity 容器传递给模块的构造函数。我现在使用服务定位器在需要时访问容器。

```
ServiceLocator.Current.GetInstance<IUnityContainer>(); 
```

# tinymce - TinyMCE 自动添加格式

> ID：15531460
> 
> 赞同：1
> 
> 时间：2013-03-20T18:08:28.540
> 
> 标签：tinymce

我多年来一直在网站中使用tinymce，从未遇到过这个问题。每当我返回时，它都会在我的段落标签前添加以下内容。

我正在使用最新版本：3.5.8

```
<div style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10px; background-color: #ffffff;"> 
```

这是我的脚本代码：

```
<script type="text/javascript" src="jscripts/tiny_mce/tiny_mce.js"></script>
<script type="text/javascript">
    tinyMCE.init({
        mode : "textareas",
        theme : "simple",
        force_p_newlines : true
    });
</script> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:15:18.850

有时只是发布一个问题就会在您的脑海中播下解决方案！

这是我修复它的方法。在 css 文件 javascript/tinymce/themes/simple/skin/default/content.css 我注释掉了：

```
body, td, pre {
font-family: Verdana, Arial, Helvetica, sans-serif;
font-size: 10px;
}

body {
    background-color: #FFFFFF;
} 
```

做到了！

# c# - C# 说当我不打算声明变量时

> ID：15531474
> 
> 赞同：3
> 
> 时间：2013-03-20T18:09:04.400
> 
> 标签：c#, string, variables

给定以下代码：

```
string a = "example";
string b = "blah {0}", a; 
```

我被引导相信使用`{0}`or `{1}`，它会在逗号之后放置任何内容，在这种情况下为 string `a`, so `"example"`。字符串`b`应该是`"blah example"`. 当我这样做时，我收到错误“字符串 a 已声明”。

为什么它认为我在这种情况下声明了一个字符串？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T18:10:43.263

我相信您打算使用[string.Format](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)。这不是暗示（但它会很好）。

```
string b = string.Format("blah {0}", a); 
```

您的代码将翻译如下。当您将其完全展开时，编译器错误很明显。

```
// Given
string a = "example";
string b = "blah {0}", a;

// corresponds to ...
string a; a = "example";
string b; b = "blah {0}";
string a; 
```

[MSDN 局部变量声明](http://msdn.microsoft.com/en-us/library/aa664742%28v=vs.71%29.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-20T18:11:02.123

![在此处输入图像描述](../Images/4e43fb4a5d7f34ab981f2794031df11d.png)

看起来您正在尝试使用[String.Format](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)

```
string b = String.Format("blah {0}", a); 
```

将其视为为您构建字符串的方法。有点像`printf`来自 c/c++

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-20T18:11:11.293

这一行：

```
string b = "blah {0}", a; 
```

用初始值声明`string b`，然后声明`string a`.

当您指定以逗号分隔的多个变量名称时，它会全部声明它们，例如：

```
string a, b, c, d; 
```

您可能打算使用 String.Format()。

```
string b = String.Format("blah {0}", a); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-20T18:11:44.337

您正在重新声明`a`.

在`c#`和许多其他语言中，使用逗号分隔符声明变量是简写。

例子：

```
int x,y,z; // declare three integer variables x y and z 
```

你需要使用`String.Format`

```
string a = "example";        
string b = string.Format("blah {0}", a); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-20T18:40:34.270

您只是将变量重新声明为 Eric。J说。看起来您正在尝试连接两个字符串，因此您可以使用字符串类中的 Format 函数：

```
string a = "example";
string b = string.Format("blah {0}", a); 
```

或者您可以使用运算符 +：

```
string a = "example";
string b = "blah " + a; 
```

祝你好运 ;）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-20T18:10:47.007

这就是你要找的：

```
string b = string.Format("blah {0}", a); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-20T18:11:36.043

`string b = string.Format("blah {0}", a);`

# actionscript-3 - 动作脚本：未找到加载程序

> ID：15531476
> 
> 赞同：0
> 
> 时间：2013-03-20T18:09:10.593
> 
> 标签：actionscript-3, actionscript, flash-cs4

我正在尝试将图像加载到我的舞台上。我使用以下代码：

```
 public function loadImg():void{

        var iLoader:Loader = new Loader();
        iLoader.contentLoaderInfo.addEventListener(ProgressEvent.PROGRESS, onProgressStatus);
        iLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, onLoaderReady);

        var fileRequest:URLRequest = new URLRequest(imgPath+'testimg.JPG');
        iLoader.load(fileRequest);

    }

    public function onProgressStatus(e:ProgressEvent) {   
        trace(e.bytesLoaded, e.bytesTotal); 
    }

    public function onLoaderReady(e:Event) {     
        this.stage.addChild(iLoader); // error is here
    } 
```

但是似乎在 onLoaderReady 中找不到 iLoader：

```
1120: Access of undefined property iLoader. 
```

如何将对象 iLoader 传递给此函数？还是我做错了什么？

提前感谢您的帮助！:D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:23:55.997

从您的代码来看，它看起来像是`iLoader`一个作用域为 function 的变量`loadImg`。您不能在 loadImg 之外通过该名称访问它。

一种解决方法是将您的 iLoader 声明放在更广泛的范围内。在这种情况下，正如 David Mear 所建议的那样，这将超出所有功能。

但是，您应该能够以更优雅的方式绕过它。AS3 中的每个事件都有一个目标属性。在这种情况下，目标应该是您的加载程序。所以在里面`onLoaderReady`，你应该能够做到以下几点：

```
 this.stage.addChild(e.target); 
```

这有可能不起作用 - 因为加载器不再在范围内，它可能会被删除。我相信它会持续足够长的时间让这行代码成功，但现在没有任何测试方法。如果您尝试但失败了，我们将采用大卫的回答，我将删除我的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:15:30.187

请参阅[有关功能范围的此页面](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7f54.html)。函数内部定义的变量只在函数内部可用，所以你只需要在函数外部定义它们：

```
private var iLoader:Loader;

public function loadImg():void{

    iLoader = new Loader();
    //...

} 
```

# mysql - 如何对两个或多个相似的表求和

> ID：15531484
> 
> 赞同：0
> 
> 时间：2013-03-20T18:09:37.930
> 
> 标签：mysql

有什么方法可以对 MySQL 中两个相似表的值求和？

例如，我有以下两个表：

表格1：

```
id | field1 | field2 | ... | fieldN
1  |   5    |   6    | ... |  32
2  |   25   |   5    | ... |  2
...|  ...   |  ...   | ... | ...
N  |   4    |   1    | ... |  30 
```

表 2：

```
id | field1 | field2 | ... | fieldN
1  |   4    |   5    | ... |  4
2  |   2    |   5    | ... |  3
...|  ...   |  ...   | ... | ...
N  |   4    |   5    | ... |  0 
```

我正在考虑在该表上使用 UNION ALL，因为这些表具有相同的字段，然后是每个字段 GROUP BY ID 上的 SUM。

在第一个查询中，我会得到：

```
id | field1 | field2 | ... | fieldN
1  |   5    |   6    | ... |  32
1  |   4    |   5    | ... |  4
2  |   25   |   5    | ... |  2
2  |   2    |   5    | ... |  3
...|  ...   |  ...   | ... | ...
N  |   4    |   1    | ... |  30
N  |   4    |   5    | ... |  0 
```

...最后是总和：

```
id | field1 | field2 | ... | fieldN
1  |   9    |   11   | ... |  38
2  |   27   |   10   | ... |  5
...|  ...   |  ...   | ... | ...
N  |   8    |   6    | ... |  30 
```

有另一种方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:42:33.990

这里有两个选择。

首先是进行连接，假设它们具有相同的 id：

```
select t1.id, (t1.field1 + t2.field1) as Field1, . . .
from t1 join
     t2
     on t1.id = t2.id 
```

当然，您可以将其更改为 a `left outer join`，但是您必须在算术计算中处理 NULL 值。

第二个是你的方法：

```
select id, sum(field1) as Field1, . . .
from ((select t1.*
       from t1
      ) union all
      (select t2.*
       from t2
      )
     ) t
group by id 
```

您所做的在某种程度上是一个偏好问题。我倾向于认为`join`优化会更好（特别是使用正确的索引）。但是，如果两个表中的 id 集不同，`union all`则更容易处理这种情况。

# fancybox - 用 FancyBox 替换 TinyMCE 弹出窗口

> ID：15531485
> 
> 赞同：2
> 
> 时间：2013-03-20T18:09:44.017
> 
> 标签：fancybox, tinymce

我想用 FancyBox 替换 TinyMCE 弹出窗口，我找到了一种[解决方案](http://www.mfranc.com/uncategorized/replacing-tinymce-popup-with-fancybox/)，但我不知道如何编辑我的 editor_plugin.js。这是我的 editor_plugin.js。谢谢你

```
(function(){var d=tinymce.DOM,b=tinymce.dom.Element,a=tinymce.dom.Event,e=tinymce.each,c=tinymce.is;tinymce.create("tinymce.plugins.InlinePopups",{init:function(f,g){f.onBeforeRenderUI.add(function(){f.windowManager=new tinymce.InlineWindowManager(f);d.loadCSS(g+"/skins/"+(f.settings.inlinepopups_skin||"clearlooks2")+"/window.css")})},getInfo:function(){return{longname:"InlinePopups",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/inlinepopups",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.create("tinymce.InlineWindowManager:tinymce.WindowManager",{InlineWindowManager:function(f){var g=this;g.parent(f);g.zIndex=300000;g.count=0;g.windows={}},open:function(s,j){var z=this,i,k="",r=z.editor,g=0,v=0,h,m,o,q,l,x,y,n;s=s||{};j=j||{};if(!s.inline){return z.parent(s,j)}n=z._frontWindow();if(n&&d.get(n.id+"_ifr")){n.focussedElement=d.get(n.id+"_ifr").contentWindow.document.activeElement}if(!s.type){z.bookmark=r.selection.getBookmark(1)}i=d.uniqueId();h=d.getViewPort();s.width=parseInt(s.width||320);s.height=parseInt(s.height||240)+(tinymce.isIE?8:0);s.min_width=parseInt(s.min_width||150);s.min_height=parseInt(s.min_height||100);s.max_width=parseInt(s.max_width||2000);s.max_height=parseInt(s.max_height||2000);s.left=s.left||Math.round(Math.max(h.x,h.x+(h.w/2)-(s.width/2)));s.top=s.top||Math.round(Math.max(h.y,h.y+(h.h/2)-(s.height/2)));s.movable=s.resizable=true;j.mce_width=s.width;j.mce_height=s.height;j.mce_inline=true;j.mce_window_id=i;j.mce_auto_focus=s.auto_focus;z.features=s;z.params=j;z.onOpen.dispatch(z,s,j);if(s.type){k+=" mceModal";if(s.type){k+=" mce"+s.type.substring(0,1).toUpperCase()+s.type.substring(1)}s.resizable=false}if(s.statusbar){k+=" mceStatusbar"}if(s.resizable){k+=" mceResizable"}if(s.minimizable){k+=" mceMinimizable"}if(s.maximizable){k+=" mceMaximizable"}if(s.movable){k+=" mceMovable"}z._addAll(d.doc.body,["div",{id:i,role:"dialog","aria-labelledby":s.type?i+"_content":i+"_title","class":(r.settings.inlinepopups_skin||"clearlooks2")+(tinymce.isIE&&window.getSelection?" ie9":""),style:"width:100px;height:100px"},["div",{id:i+"_wrapper","class":"mceWrapper"+k},["div",{id:i+"_top","class":"mceTop"},["div",{"class":"mceLeft"}],["div",{"class":"mceCenter"}],["div",{"class":"mceRight"}],["span",{id:i+"_title"},s.title||""]],["div",{id:i+"_middle","class":"mceMiddle"},["div",{id:i+"_left","class":"mceLeft",tabindex:"0"}],["span",{id:i+"_content"}],["div",{id:i+"_right","class":"mceRight",tabindex:"0"}]],["div",{id:i+"_bottom","class":"mceBottom"},["div",{"class":"mceLeft"}],["div",{"class":"mceCenter"}],["div",{"class":"mceRight"}],["span",{id:i+"_status"},"Content"]],["a",{"class":"mceMove",tabindex:"-1",href:"javascript:;"}],["a",{"class":"mceMin",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}],["a",{"class":"mceMax",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}],["a",{"class":"mceMed",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}],["a",{"class":"mceClose",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}],["a",{id:i+"_resize_n","class":"mceResize mceResizeN",tabindex:"-1",href:"javascript:;"}],["a",{id:i+"_resize_s","class":"mceResize mceResizeS",tabindex:"-1",href:"javascript:;"}],["a",{id:i+"_resize_w","class":"mceResize mceResizeW",tabindex:"-1",href:"javascript:;"}],["a",{id:i+"_resize_e","class":"mceResize mceResizeE",tabindex:"-1",href:"javascript:;"}],["a",{id:i+"_resize_nw","class":"mceResize mceResizeNW",tabindex:"-1",href:"javascript:;"}],["a",{id:i+"_resize_ne","class":"mceResize mceResizeNE",tabindex:"-1",href:"javascript:;"}],["a",{id:i+"_resize_sw","class":"mceResize mceResizeSW",tabindex:"-1",href:"javascript:;"}],["a",{id:i+"_resize_se","class":"mceResize mceResizeSE",tabindex:"-1",href:"javascript:;"}]]]);d.setStyles(i,{top:-10000,left:-10000});if(tinymce.isGecko){d.setStyle(i,"overflow","auto")}if(!s.type){g+=d.get(i+"_left").clientWidth;g+=d.get(i+"_right").clientWidth;v+=d.get(i+"_top").clientHeight;v+=d.get(i+"_bottom").clientHeight}d.setStyles(i,{top:s.top,left:s.left,width:s.width+g,height:s.height+v});y=s.url||s.file;if(y){if(tinymce.relaxedDomain){y+=(y.indexOf("?")==-1?"?":"&")+"mce_rdomain="+tinymce.relaxedDomain}y=tinymce._addVer(y)}if(!s.type){d.add(i+"_content","iframe",{id:i+"_ifr",src:'javascript:""',frameBorder:0,style:"border:0;width:10px;height:10px"});d.setStyles(i+"_ifr",{width:s.width,height:s.height});d.setAttrib(i+"_ifr","src",y)}else{d.add(i+"_wrapper","a",{id:i+"_ok","class":"mceButton mceOk",href:"javascript:;",onmousedown:"return false;"},"Ok");if(s.type=="confirm"){d.add(i+"_wrapper","a",{"class":"mceButton mceCancel",href:"javascript:;",onmousedown:"return false;"},"Cancel")}d.add(i+"_middle","div",{"class":"mceIcon"});d.setHTML(i+"_content",s.content.replace("\n","<br />"));a.add(i,"keyup",function(f){var p=27;if(f.keyCode===p){s.button_func(false);return a.cancel(f)}});a.add(i,"keydown",function(f){var t,p=9;if(f.keyCode===p){t=d.select("a.mceCancel",i+"_wrapper")[0];if(t&&t!==f.target){t.focus()}else{d.get(i+"_ok").focus()}return a.cancel(f)}})}o=a.add(i,"mousedown",function(t){var u=t.target,f,p;f=z.windows[i];z.focus(i);if(u.nodeName=="A"||u.nodeName=="a"){if(u.className=="mceClose"){z.close(null,i);return a.cancel(t)}else{if(u.className=="mceMax"){f.oldPos=f.element.getXY();f.oldSize=f.element.getSize();p=d.getViewPort();p.w-=2;p.h-=2;f.element.moveTo(p.x,p.y);f.element.resizeTo(p.w,p.h);d.setStyles(i+"_ifr",{width:p.w-f.deltaWidth,height:p.h-f.deltaHeight});d.addClass(i+"_wrapper","mceMaximized")}else{if(u.className=="mceMed"){f.element.moveTo(f.oldPos.x,f.oldPos.y);f.element.resizeTo(f.oldSize.w,f.oldSize.h);f.iframeElement.resizeTo(f.oldSize.w-f.deltaWidth,f.oldSize.h-f.deltaHeight);d.removeClass(i+"_wrapper","mceMaximized")}else{if(u.className=="mceMove"){return z._startDrag(i,t,u.className)}else{if(d.hasClass(u,"mceResize")){return z._startDrag(i,t,u.className.substring(13))}}}}}}});q=a.add(i,"click",function(f){var p=f.target;z.focus(i);if(p.nodeName=="A"||p.nodeName=="a"){switch(p.className){case"mceClose":z.close(null,i);return a.cancel(f);case"mceButton mceOk":case"mceButton mceCancel":s.button_func(p.className=="mceButton mceOk");return a.cancel(f)}}});a.add([i+"_left",i+"_right"],"focus",function(p){var t=d.get(i+"_ifr");if(t){var f=t.contentWindow.document.body;var u=d.select(":input:enabled,*[tabindex=0]",f);if(p.target.id===(i+"_left")){u[u.length-1].focus()}else{u[0].focus()}}else{d.get(i+"_ok").focus()}});x=z.windows[i]={id:i,mousedown_func:o,click_func:q,element:new b(i,{blocker:1,container:r.getContainer()}),iframeElement:new b(i+"_ifr"),features:s,deltaWidth:g,deltaHeight:v};x.iframeElement.on("focus",function(){z.focus(i)});if(z.count==0&&z.editor.getParam("dialog_type","modal")=="modal"){d.add(d.doc.body,"div",{id:"mceModalBlocker","class":(z.editor.settings.inlinepopups_skin||"clearlooks2")+"_modalBlocker",style:{zIndex:z.zIndex-1}});d.show("mceModalBlocker");d.setAttrib(d.doc.body,"aria-hidden","true")}else{d.setStyle("mceModalBlocker","z-index",z.zIndex-1)}if(tinymce.isIE6||/Firefox\/2\./.test(navigator.userAgent)||(tinymce.isIE&&!d.boxModel)){d.setStyles("mceModalBlocker",{position:"absolute",left:h.x,top:h.y,width:h.w-2,height:h.h-2})}d.setAttrib(i,"aria-hidden","false");z.focus(i);z._fixIELayout(i,1);if(d.get(i+"_ok")){d.get(i+"_ok").focus()}z.count++;return x},focus:function(h){var g=this,f;if(f=g.windows[h]){f.zIndex=this.zIndex++;f.element.setStyle("zIndex",f.zIndex);f.element.update();h=h+"_wrapper";d.removeClass(g.lastId,"mceFocus");d.addClass(h,"mceFocus");g.lastId=h;if(f.focussedElement){f.focussedElement.focus()}else{if(d.get(h+"_ok")){d.get(f.id+"_ok").focus()}else{if(d.get(f.id+"_ifr")){d.get(f.id+"_ifr").focus()}}}}},_addAll:function(k,h){var g,l,f=this,j=tinymce.DOM;if(c(h,"string")){k.appendChild(j.doc.createTextNode(h))}else{if(h.length){k=k.appendChild(j.create(h[0],h[1]));for(g=2;g<h.length;g++){f._addAll(k,h[g])}}}},_startDrag:function(v,G,E){var o=this,u,z,C=d.doc,f,l=o.windows[v],h=l.element,y=h.getXY(),x,q,F,g,A,s,r,j,i,m,k,n,B;g={x:0,y:0};A=d.getViewPort();A.w-=2;A.h-=2;j=G.screenX;i=G.screenY;m=k=n=B=0;u=a.add(C,"mouseup",function(p){a.remove(C,"mouseup",u);a.remove(C,"mousemove",z);if(f){f.remove()}h.moveBy(m,k);h.resizeBy(n,B);q=h.getSize();d.setStyles(v+"_ifr",{width:q.w-l.deltaWidth,height:q.h-l.deltaHeight});o._fixIELayout(v,1);return a.cancel(p)});if(E!="Move"){D()}function D(){if(f){return}o._fixIELayout(v,0);d.add(C.body,"div",{id:"mceEventBlocker","class":"mceEventBlocker "+(o.editor.settings.inlinepopups_skin||"clearlooks2"),style:{zIndex:o.zIndex+1}});if(tinymce.isIE6||(tinymce.isIE&&!d.boxModel)){d.setStyles("mceEventBlocker",{position:"absolute",left:A.x,top:A.y,width:A.w-2,height:A.h-2})}f=new b("mceEventBlocker");f.update();x=h.getXY();q=h.getSize();s=g.x+x.x-A.x;r=g.y+x.y-A.y;d.add(f.get(),"div",{id:"mcePlaceHolder","class":"mcePlaceHolder",style:{left:s,top:r,width:q.w,height:q.h}});F=new b("mcePlaceHolder")}z=a.add(C,"mousemove",function(w){var p,H,t;D();p=w.screenX-j;H=w.screenY-i;switch(E){case"ResizeW":m=p;n=0-p;break;case"ResizeE":n=p;break;case"ResizeN":case"ResizeNW":case"ResizeNE":if(E=="ResizeNW"){m=p;n=0-p}else{if(E=="ResizeNE"){n=p}}k=H;B=0-H;break;case"ResizeS":case"ResizeSW":case"ResizeSE":if(E=="ResizeSW"){m=p;n=0-p}else{if(E=="ResizeSE"){n=p}}B=H;break;case"mceMove":m=p;k=H;break}if(n<(t=l.features.min_width-q.w)){if(m!==0){m+=n-t}n=t}if(B<(t=l.features.min_height-q.h)){if(k!==0){k+=B-t}B=t}n=Math.min(n,l.features.max_width-q.w);B=Math.min(B,l.features.max_height-q.h);m=Math.max(m,A.x-(s+A.x));k=Math.max(k,A.y-(r+A.y));m=Math.min(m,(A.w+A.x)-(s+q.w+A.x));k=Math.min(k,(A.h+A.y)-(r+q.h+A.y));if(m+k!==0){if(s+m<0){m=0}if(r+k<0){k=0}F.moveTo(s+m,r+k)}if(n+B!==0){F.resizeTo(q.w+n,q.h+B)}return a.cancel(w)});return a.cancel(G)},resizeBy:function(g,h,i){var f=this.windows[i];if(f){f.element.resizeBy(g,h);f.iframeElement.resizeBy(g,h)}},close:function(i,k){var g=this,f,j=d.doc,h,k;k=g._findId(k||i);if(!g.windows[k]){g.parent(i);return}g.count--;if(g.count==0){d.remove("mceModalBlocker");d.setAttrib(d.doc.body,"aria-hidden","false");g.editor.focus()}if(f=g.windows[k]){g.onClose.dispatch(g);a.remove(j,"mousedown",f.mousedownFunc);a.remove(j,"click",f.clickFunc);a.clear(k);a.clear(k+"_ifr");d.setAttrib(k+"_ifr","src",'javascript:""');f.element.remove();delete g.windows[k];h=g._frontWindow();if(h){g.focus(h.id)}}},_frontWindow:function(){var g,f=0;e(this.windows,function(h){if(h.zIndex>f){g=h;f=h.zIndex}});return g},setTitle:function(f,g){var h;f=this._findId(f);if(h=d.get(f+"_title")){h.innerHTML=d.encode(g)}},alert:function(g,f,j){var i=this,h;h=i.open({title:i,type:"alert",button_func:function(k){if(f){f.call(k||i,k)}i.close(null,h.id)},content:d.encode(i.editor.getLang(g,g)),inline:1,width:400,height:130})},confirm:function(g,f,j){var i=this,h;h=i.open({title:i,type:"confirm",button_func:function(k){if(f){f.call(k||i,k)}i.close(null,h.id)},content:d.encode(i.editor.getLang(g,g)),inline:1,width:400,height:130})},_findId:function(f){var g=this;if(typeof(f)=="string"){return f}e(g.windows,function(h){var i=d.get(h.id+"_ifr");if(i&&f==i.contentWindow){f=h.id;return false}});return f},_fixIELayout:function(i,h){var f,g;if(!tinymce.isIE6){return}e(["n","s","w","e","nw","ne","sw","se"],function(j){var k=d.get(i+"_resize_"+j);d.setStyles(k,{width:h?k.clientWidth:"",height:h?k.clientHeight:"",cursor:d.getStyle(k,"cursor",1)});d.setStyle(i+"_bottom","bottom","-1px");k=0});if(f=this.windows[i]){f.element.hide();f.element.show();e(d.select("div,a",i),function(k,j){if(k.currentStyle.backgroundImage!="none"){g=new Image();g.src=k.currentStyle.backgroundImage.replace(/url\(\"(.+)\"\)/,"$1")}});d.get(i).style.filter=""}}});tinymce.PluginManager.add("inlinepopups",tinymce.plugins.InlinePopups)})(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T10:23:44.523

对于每个 tinymce 插件，都有一个名为`editor_plugin_src.js`您可以编辑的文件。您唯一需要注意的是使用文件`tiny_mce_dev.js`而不是`tiny_mce.js`. Afterr 切换 tinymce 将使用插件的非缩小版本，这在调试时有很大帮助。

# angularjs - angularjs指令中的链接函数参数

> ID：15531487
> 
> 赞同：2
> 
> 时间：2013-03-20T18:10:00.693
> 
> 标签：angularjs, angularjs-directive

我正在尝试添加我在 angularjs 网站（[http://docs.angularjs.org/guide/concepts#directives](http://docs.angularjs.org/guide/concepts#directives)）上找到的 contenteditable 指令。

我的问题是，如果我在控制器中更改 contenteditable div 中的值，则范围值会更新，但 div 中的值不会。我希望能够在我的主控制器中做这样的事情：

```
$scope.content = $scope.content.concat("added text"); 
```

这更新了 $scope.content 但没有更新 contenteditable div。因此，如果我单击 div 进行编辑，我的修改就消失了。

为了使它工作，我必须从我的控制器调用 ctrl.$render 但我找不到任何关于链接函数的第四个参数是什么的文档。

有谁知道这个'ctrl'参数代表什么，如果通过改变一些知道如何解决我的问题:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:34:43.703

[在撰写本文时（2013 年 3 月 20 日），表单页面](http://docs.angularjs.org/guide/forms)中的 Plunker 存在两个问题：

1.  失踪`form-example`。
    HTML 应该是： `<html ng-app="form-example2">`
2.  `contentEditable`应该是`contenteditable`。
    HTML 应该是：`<div contenteditable ng-model="content">Some content</div>`

带有要附加到控制器中的链接的[Plunker](http://plnkr.co/edit/4LAEvoVHqiSjFuuoQDdV?p=preview)`$scope.content`。

# javascript - Javascript 问题：查找匹配项的正则表达式问题

> ID：15531495
> 
> 赞同：1
> 
> 时间：2013-03-20T18:10:19.487
> 
> 标签：javascript, regex

我确定这很简单，我只是看不到它。我一直在寻找示例，尽管它们很简短，但我似乎找不到我的问题。

我希望验证邮政编码字段并使用加拿大邮政编码格式。我找到了一个我希望使用的表达式，它如下所示：

```
var validZIP={
   "US":"^\d{5}([\-]?\d{4})?$",
   "UK":"^(GIR|[A-Z]\d[A-Z\d]??|[A-Z]{2}\d[A-Z\d]??)[ ]??(\d[A-Z]{2})$",
   "CA":"^([ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ])\ {0,1}(\d[ABCEGHJKLMNPRSTVWXYZ]\d)$"
} 
```

请注意`CA`在这种情况下代表加拿大。

我的`onChange`函数调用以下方法（`checkValidPostal(this)`来自输入的 onchange 类）：

```
function checkValidPostal(input)
{
    var re =  new RegExp(validZIP["CA"]);
    var value = input.value.toUpperCase();  
    if (value.match(re))
    {
        input.value = value;
        return true;    
    }
    input.value = "";
    return false;
} 
```

我已经使用以下方法检查了 RegEx 行：

[http://www.regular-expressions.info/javascriptexample.html](http://www.regular-expressions.info/javascriptexample.html)它在该页面上运行良好，但由于某种原因我无法让它在我的上运行！

请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T18:16:24.617

有一个问题：当您使用字符串而不是[正则表达式文字](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Regular_Expressions)时，您缺少一些擒纵机构。

此外，您可能想使用[测试](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp/test)而不是匹配。

你可以这样解决：

```
var validZIP={
   "US": /^\d{5}([\-]?\d{4})?$/,
   "UK": /^(GIR|[A-Z]\d[A-Z\d]??|[A-Z]{2}\d[A-Z\d]??)[ ]??(\d[A-Z]{2})$/,
   "CA": /^([ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ])\ {0,1}(\d[ABCEGHJKLMNPRSTVWXYZ]\d)$/
}

function checkValidPostal(input) {
    var re =  validZIP["CA"];
    var value = input.value.toUpperCase();  
    if (re.test(value)) {
        input.value = value;
        return true;    
    }
    input.value = "";
    return false;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T18:15:41.207

在字符串中，您需要对反斜杠进行双重转义，否则它们已经被字符串转义，并且在 RegEx 构造函数获取字符串时没有剩余的反斜杠。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T18:18:10.963

尝试在 validZIP 中放置模式而不是字符串：

```
var validZIP={
   "US":/^\d{5}([\-]?\d{4})?$/,
   "UK":/^(GIR|[A-Z]\d[A-Z\d]??|[A-Z]{2}\d[A-Z\d]??)[ ]??(\d[A-Z]{2})$/,
   "CA":/^([ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ])\ {0,1}(\d[ABCEGHJKLMNPRSTVWXYZ]\d)$/
} 
```

# c - SQLite：当主数据库有一个打开的准备好的语句时，为什么我不能 DETACH 数据库？

> ID：15531498
> 
> 赞同：5
> 
> 时间：2013-03-20T18:10:29.340
> 
> 标签：c, sqlite

为什么以下代码不起作用：

```
#include <stdio.h>
#include <sqlite3.h>

int main(void)
{
    sqlite3 *pDb;
    sqlite3_stmt *stmt;
    char *errmsg;

    sqlite3_open(":memory:", &pDb);

    sqlite3_exec(pDb, "CREATE TABLE Test(a INTEGER)", NULL, NULL, NULL);
    sqlite3_exec(pDb, "INSERT INTO Test(a) VALUES(1)", NULL, NULL, NULL);

    sqlite3_prepare_v2(pDb, "SELECT * FROM Test", -1, &stmt, NULL);
    sqlite3_step(stmt);

    sqlite3_exec(pDb, "ATTACH 'Test.db' as Other;", NULL, NULL, NULL);

    sqlite3_exec(pDb, "DETACH Other;", NULL, NULL, &errmsg);
    printf("error: %s\n", errmsg);
    return 0;
} 
```

输出：

```
error: database Other is locked 
```

如果我在`sqlite3_reset(stmt)`之后做一个`sqlite3_step(stmt)`，它会起作用。

为什么不相关数据库上的 open 语句会锁定“其他”数据库？我在文档中找不到解释。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T20:43:11.107

[交易文件](http://www.sqlite.org/lang_transaction.html)说：

> 当最后一个活动语句完成时，会自动提交隐式事务（自动启动的事务，而不是由 BEGIN 启动的事务）。一条语句在其准备好的语句被[重置](http://www.sqlite.org/c3ref/reset.html)或[最终确定](http://www.sqlite.org/c3ref/finalize.html)时结束。

事务总是[影响所有附加的数据库](http://www.sqlite.org/atomiccommit.html#multicommit)，因此打开的事务将保持所有数据库锁定。

# java - 在 Java bean 中设置作者和读者字段

> ID：15531501
> 
> 赞同：0
> 
> 时间：2013-03-20T18:10:33.973
> 
> 标签：java, xpages

我有一个 Java bean，它代表了我的 xpage 背后的所有功能。当我保存 xpage 时，会调用一个方法，并将 xpage 数据源作为 DominoDocument 对象传入。我遇到的问题是设置作者和读者字段。我无法获取 Item 对象以使用“item.setAuthors(true);” 使用 DominoDocument 对象，所以我必须获取 Document 对象：

```
(dDoc = DominoDocument passed into the save method via SSJS call to it)

Document doc = dDoc.getDocument(true); 
Vector<String> editors = new Vector<String>();       
editors = getUniqueList(dDoc,editors,"AdditionalEditors") ;  
Item item = doc.replaceItemValue("Authors", editors);  
item.setAuthors(true) ; 
doc.save(); 
```

新文档的第一次保存似乎可以工作，但是随后的保存会创建当前文档的新副本；后端更改未传递到前端文档。是否有另一种方法可以使用 dominoDocument 对象设置作者/读者字段，或者在使用后端文档调用保存后用更改包装 DominoDocument。我确实尝试过 dDoc.restoreWrappedDocument() 但这不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T15:54:46.670

要获得作者和读者字段，您有 2 个选项：

*   将它们添加到表单并为保存操作指定“ComputeWithForm”
*   将代码添加到您设置字段的 querySave 事件。不要在那里保存文档（它是在保存文档之前运行的函数）。

在任何情况下，请确保不要在任何范围内保留对 dDoc 的引用

# blackberry - 如何确定黑莓中 GPS 的状态？

> ID：15531515
> 
> 赞同：2
> 
> 时间：2013-03-20T18:11:05.823
> 
> 标签：blackberry, gps, state, status

我想知道如何确定 GPS 的状态，如果状态不同，`AVAILABLE`我不会创建侦听器来节省电池。

但在执行中，始终输入`else`create the`LocationListener`而不是`if`.

这是我的代码

```
public class UpdateGPS extends Thread{
    public void run(){
        while (true){
            try{
                getGPS();
                sleep(30000); //Update GPS for each 30secs
            }
            catch(Exception e){}
        }
    }
}

public void getGPS() {
    String state = "RUNNING";
    BlackBerryCriteria myCriteria = new BlackBerryCriteria(GPSInfo.GPS_MODE_ASSIST);
    try {           
    locationProvider = LocationProvider.getInstance(myCriteria);
        if (locationProvider != null) {
            if (locationProvider.getState() != locationProvider.AVAILABLE) {
                state= "STOP";
            }
            else {
                locationProvider.setLocationListener(
                      new LocationListenerImplementacion(),valor_reintento, -1, -1);
            }
        }
    }
    catch(Exception e) {}
} 

private class LocationListenerImplementacion implements LocationListener {
    public void locationUpdated(LocationProvider provider,Location location) {
        if (location.isValid()) {
           //GET DATA
        }
        else {}

    public void providerStateChanged(LocationProvider provider, int newState){

    }

} 
```

# rotation - 计算Object3d的孩子的绝对位置/旋转

> ID：15531519
> 
> 赞同：0
> 
> 时间：2013-03-20T18:11:13.890
> 
> 标签：rotation, position, three.js

我有一个移动和旋转的网格，我想向父 Object3D 添加一个绝对定位/旋转的子对象，并且当父元素更改位置或旋转时它应该保持其位置。

```
parent_ = new THREE.Object3D()
parent_.add( new THREE.Mesh(new THREE.CubeGeometry(2, 20, 2), new THREE.MeshNormalMaterial()))
child_ = new THREE.Mesh(new THREE.CubeGeometry(30, 3, 30), new THREE.MeshNormalMaterial())
child_.position.set(1,10,1)
parent_.add(child_)
scene.add(parent_); 
```

[小提琴](http://jsfiddle.net/Tsky4/)

如何从绝对定位/旋转的对象计算相对于父 object3d 的位置/旋转，使其保持绝对位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T01:12:50.767

为了在 Object3D 的局部坐标系和世界坐标系之间进行转换，有方法`worldToLocal`和`localToWorld`，请参见源代码：

[http://github.com/mrdoob/three.js/blob/master/src/core/Object3D.js](http://github.com/mrdoob/three.js/blob/master/src/core/Object3D.js)

详情。

# c++ - QueryPerformanceCounter 返回负数

> ID：15531520
> 
> 赞同：-1
> 
> 时间：2013-03-20T18:11:16.640
> 
> 标签：c++, performancecounter

嘿，我试图计算函数执行所需的时间我这样做是这样的： **Timer.cpp**

```
long long int Timer :: clock1()
{
    QueryPerformanceCounter((LARGE_INTEGER*)&time1);
    return time1;
}
long long int Timer :: clock2()
{
    QueryPerformanceCounter((LARGE_INTEGER*)&time2);
    return time2;
} 
```

**主文件**

```
#include "Timer.h"  //To allow the use of the timer class.

Timer query;

void print()
{
    query.clock1();
    //Loop through the elements in the array.
    for(int index = 0; index < num_elements; index++)
    {
        //Print out the array index and the arrays elements.
        cout <<"Index: " << index << "\tElement: " << m_array[index]<<endl;
    }
    //Prints out the number of elements and the size of the array.
    cout<< "\nNumber of elements: " << num_elements;
    cout<< "\nSize of the array: " << size << "\n";
    query.clock2();
    cout << "\nTime Taken : " << query.time1 - query.time2;
} 
```

谁能告诉我我这样做是否正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:13:25.540

您正在从开始时间减去结束时间。

```
cout << "\nTime Taken : " << query.time1 - query.time2; 
```

应该

```
cout << "\nTime Taken : " << query.time2 - query.time1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:13:39.593

假设我在 10 秒开始做某事，然后在 30 秒结束。花了多长时间？20 秒。要做到这一点，我们会这样做`30 - 10`；即第二次减去第一次。

所以也许你想要：

```
cout << "\nTime Taken : " << (query.time2 - query.time1); 
```

# ajax - 在经典 ASP 中调用外部注销

> ID：15531522
> 
> 赞同：0
> 
> 时间：2013-03-20T18:11:23.720
> 
> 标签：ajax, json, iframe, asp-classic, backend

基本上我正在寻找的是这样的东西；

我在一个调用 .ASPX 文件的经典 asp 站点上有一个链接，该文件又从 Sessions 变量中设置了一堆用户凭据，然后重定向到第三方供应商托管的站点，我知道很脏，但无能为力现在它。

所以过程是；1\. 加载带有 .ASPX 页面链接的经典 asp 页面 2\. 单击链接，发送到 .aspx 页面 3\. .ASPX 设置所需数据和 .Send() 到第三方供应商应用程序

问题是，如果用户没有“注销”第三方站点并以新用户名返回，则第一个用户名凭据保持设置。我想要做的是在用户点击进入第三方供应商应用程序之前在.asp页面上调用供应商应用程序在后台注销页面。我正在考虑使用 iFrame，但 iFrame 仅显示注销页面，它实际上不会执行与其关联的代码。

非常感谢任何帮助，尼克 G

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:03:22.033

无论您按照这些思路提出什么解决方案，只要该第三方供应商意识到他们的站点存在巨大的安全漏洞并决定关闭它，它就会起作用。

例如，**永远**不能通过在页面中注入隐藏的 iframe 来将某人从另一个系统中注销。这是 CSRF 漏洞的一种形式，表明其他站点的安全态势马虎。

我当然会考虑另一种方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:23:31.053

如果您的服务器端代码正确，您的 iframe 方法应该可以工作。不过要记住两件事。

首先，会话变量是特定于域的，因此如果您的页面可通过多个域访问，并且 iframe 的 src 属性与用户访问您网站的起始属性不同，那么您的会话数据将不会被识别。如果一个网址包含“www”而另一个不包含，这甚至可能适用 - 我从未测试过这个

其次，经典的 ASP 文件和 ASP.net 文件不能共享会话变量，您需要为每组页面设置单独的变量集。如果您需要同步这两组，一个常见的技巧是使用 0px x 0px iframe，例如

```
<iframe height="0" width="0" src="dotnetpage.aspx?userid=<%=Session("userid")&loggedin=<%=Session("loggedin")" /> 
```

显然 dotnetpage.aspx 将包含将查询字符串值设置为会话变量的代码，并且您可以让经典页面从 .net 页面接收查询字符串

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T16:31:27.137

我想出了一个使用经典 asp 的更好方法，并且只是将 url 作为一个包含在内，它似乎工作正常。

# biztalk - BizTalk ESB 工具包 2.0 材料 pdf

> ID：15531523
> 
> 赞同：0
> 
> 时间：2013-03-20T18:11:27.683
> 
> 标签：biztalk, biztalk-2010, esb-toolkit-2.0

之前我是按照[(MCTS): Microsoft BizTalk Server 2010 (70-595) 认证指南书](http://www.packtpub.com/mcts-microsoft-biztalk-server-2010-certification-guide/book)来获得 BTS server 2010 的认证，这本书帮助我了解了 BTS 使用的模式和不同的方法。

这次，我也想通过BTS-ESB工具包2.0的认证。

请问有人能建议哪本书会提供更多关于 BTS-ESB 工具包 2.0 基础知识的知识吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T03:14:43.033

您可以关注 BizTalk ESB Toolkit 2.1 学习网站，了解有关 BizTalk ESB Toolkit 2.1 的信息。有很多 ESB Toolkit 资源。

[http://msdn.microsoft.com/en-us/library/ff699598(v=BTS.70).aspx](http://msdn.microsoft.com/en-us/library/ff699598(v=BTS.70).aspx)

[http://msdn.microsoft.com/en-us/biztalk/dd876606.aspx](http://msdn.microsoft.com/en-us/biztalk/dd876606.aspx)

# linux - Linux shell脚本将列读入变量，然后添加属性

> ID：15531525
> 
> 赞同：2
> 
> 时间：2013-03-20T18:11:31.533
> 
> 标签：linux, parsing, shell, variables

我有一个文件 test.txt，如下所示：

```
2092 Mary
103 Tom
1239 Mary
204 Mark
1294 Tom
1092 Mary 
```

我正在尝试创建一个 shell 脚本

1.  读取每一行并将两列中的数据放入变量 var1 和 var2
2.  如果每行中的 var2 相同，则在这些行中添加 var1。
3.  将文件输出到文本文件中。

结果应该是 var2 列中的唯一值。这是我到目前为止所拥有的：

```
#!/bin/sh
#!/usr/bin/sh
cat test.txt| while read line;
do
$var1=$(echo $line| awk -F\; '{print $1}')
$var2=$(echo $line| awk -F\; '{print $2}') 
```

如何在每一行中引用变量然后比较它们？
预期的输出将是：

```
4423 Mary
1397 Tom 
204  Mark 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T19:20:26.897

使用`awk`它很容易：

```
awk '{sum[$2] += $1} END {for (i in sum) printf "%4d %s\n", sum[i], i; }' 
```

如果你想用`bash`4.x（不是 3.x）来做，那么：

```
declare -A sum
while read number name
do
    ((sum[$name] += $number))
done

for name in "${!sum[@]}"
do
    echo ${sum[$name]} $name
done 
```

这里的结构与脚本本质上是同构的`awk`，但在符号上不太方便。它将从标准输入读取，使用名称作为关联数组的索引`sum`。该`${!sum[@]}`符号在手册的[Shell Parameter Expansion](http://www.gnu.org/software/bash/manual/bash.html#Shell-Parameter-Expansion)部分中进行了描述，甚至在[Arrays](http://www.gnu.org/software/bash/manual/bash.html#Arrays)部分中也没有暗示。如果您知道在哪里查找，信息就在那里。

如果你想处理任意数量的输入文件（就像`awk`脚本一样），那么你需要使用`cat`来收集数据：

```
cat "$@" |
{
declare -A sum
while read number name
do
    ((sum[$name] += $number))
done

for name in "${!sum[@]}"
do
    echo ${sum[$name]} $name
done
} 
```

这不是[UUOC](http://catb.org/jargon/html/U/UUOC.html)，因为它不处理任何参数（读取标准输入）、一个参数或多个参数。

对于所有脚本，如果要按数字或名称顺序对输出进行排序，请对脚本的输出应用适当`sort`的：

```
script file1 file2 file3 | sort -k 1,1n     # By sum increasing order
script file1 file2 file3 | sort -k 1,1nr    # By sum decreasing order
script file1 file2 file3 | sort -k 2,2      # By name increasing order
script file1 file2 file3 | sort -k 2,2r     # By name decreasing order 
```

# php - 警告：mysql_select_db() 用户 ''@'localhost' 的访问被拒绝（使用密码：否）

> ID：15531530
> 
> 赞同：4
> 
> 时间：2013-03-20T18:11:50.050
> 
> 标签：php, mysql, mysql-workbench

我对网络开发相当陌生，我需要帮助来找出问题所在。我安装了 MySQL 5.6.10，并且我被赋予了更新一个网站的 src 的任务，该网站目前已经存在了 5 年。没有任何代码发生变化，它适用于其他开发者本地机器。服务器正在运行 5.0.51b，我刚刚降级到 5.5.30，试图让语法错误消失。错误是 SET OPTION SQL_BIG_SELECTS=1 在某个版本中被弃用为 SET SQL_BIG_SELECTS。由于服务器运行的版本，我无法更改语法。所以我选择将版本降到 5.5.30。

降级后我的问题是：

```
Warning: mysql_select_db() [function.mysql-select-db]: Access denied for user
''@'localhost' (using password: NO) in C:\Program Files (x86)\Apache Software
Foundation\Apache2.2\htdocs\****\src\www\include\func\func.db.php on line 47 
```

我将 MySQL Workbench 用于我的连接，没有一个连接或用户有与之关联的密码。我有另一个无法在本地主机上正常运行的项目。我的 vhost 和 host 文件都具有正确的语法以使其正常工作（已通过其他项目验证）。这一切都正常工作，并且昨天能够通过 vhost 调出页面。我从来没有对如何设置拉索引页有任何问题。唯一的问题是 MySQL 版本问题。我能做些什么来解决这个问题？我尝试在工作台中重新创建连接，甚至删除所有实例并重新创建它们。我难住了。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T18:13:58.373

你可以看到这个错误，因为你没有正确连接你的 mysql 数据库。

```
mysql_connect("HOST","USER","PASSWORD") 
```

确保主机、用户名和密码正确

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T18:17:29.907

MySQL是您唯一升级的吗？您升级 PHP 并且现在不再启用 register_globals 的任何机会？如果您将其关闭而您的同事将其打开，这可以解释您所看到的差异。

[http://php.net/manual/en/security.globals.php](http://php.net/manual/en/security.globals.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T18:15:33.127

从我在返回的错误中看到的情况来看，您没有向连接传递用于连接 MySQL 的用户名。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T18:22:00.800

仔细查看您的错误，您会发现它告诉您出了什么问题（通常是错误报告的用途）：

```
Access denied for user
''@'localhost' (using password: NO) 
```

具体来看：

```
''@'localhost'
^^ 
```

您会看到没有指定用户。您需要指定要连接的用户。

```
mysql_connect("HOST","USER","PASSWORD") 
```

这是在一个`mysql_select_db`电话之前。

[MySQL Connect](http://php.net/manual/en/function.mysql-connect.php) 和[MySQL 选择数据库](http://php.net/manual/en/function.mysql-select-db.php)

**注意：**不要升级到 PHP 5.5 for MySQL_* 函数已被弃用。我这样说是因为您不想更改任何代码。

# objective-c - 将参数传递给上下文菜单的选择器方法

> ID：15531531
> 
> 赞同：0
> 
> 时间：2013-03-20T18:11:50.207
> 
> 标签：objective-c, methods, parameters, selector

如何将参数传递给以下选择器？

```
 NSMenuItem *item3 = [[NSMenuItem alloc] initWithTitle:title3 action:@selector(uncheckrow:)  keyEquivalent:@""]; 
```

我想将行号传递给该方法。

谢谢

编辑

我要传递的行是我首先右键单击的表的行。但它可以是任何整数变量..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:35:10.007

Override the menuForEvent: in your tableview's subclass, Take some variable in your controller say 'rowToApply'

```
- (NSMenu*) menuForEvent:(NSEvent*)event
{
    NSPoint point = [self convertPoint:[event locationInWindow] fromView:nil];
    NSInteger row = [self rowAtPoint:point];
    BOOL clickWasOnItem = (row > -1);
        if(clickWasOnItem) {
            controller.rowToApply = [self itemAtRow:row];// Controller can be datasource(or) delegate (or) someObject which can be accessible)
        }
    return [super menuForEvent:event];
} 
```

you can use the rowToApply: in contextualMenu item's action method (uncheckrow:).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:15:58.003

菜单项本身（`item3`您的代码片段）将被发送到该方法，因此您可以通过这种方式识别特定的选定菜单项。您还可以设置 NSMenuItem 的 tag 属性，例如：`[item3 setTag:3]`然后在您的 uncheckrow 方法中，您可以使用`NSInteger row = [sender tag];`

**编辑：对于更新的问题**

如果您想向此方法发送任意整数，则有一些选项，但它们并不是特别优雅。AppKit 将始终将 NSMenuItem 作为发送者发送，因此您需要使整数可用于未选中的 NSMenuItem。`menu`请注意，NSMenuItems 可以通过该方法访问其父 NSMenus 。因此，如果父 NSMenu 本身具有您可以利用的某些属性，则可以使用`[[sender menu] thatProperty]`. 由于您正在显示 NSMenu 以响应右键单击表格的行，因此您可以在显示菜单之前设置属性。我建议继承 NSMenu 以添加您自己的“spawningRowIndex”属性（尽管选择更好的名称）。在显示 NSMenu 设置属性之前，当您收到 uncheckrow 时，您可以使用`[[sender menu] spawningRowIndex]`.

# javascript - 在 processing.js 碰撞检测中减少对象之间的空间

> ID：15531533
> 
> 赞同：0
> 
> 时间：2013-03-20T18:11:52.613
> 
> 标签：javascript, collision-detection, processing, processing.js

我一直在使用 processing.js 进行基本的 Pong 克隆。目前我有一个可以在两个玩家控制的桨之间来回弹跳的球。我的问题是我用于检测球和桨之间碰撞的算法使球反转，但为最右边的桨留下了不切实际的间隙。我用于碰撞检测的方法如下：

```
 /*
     * Collision detection
     */
     void Collide(PongBall ball, Paddle pPaddle)
     {

        float paddleX = pPaddle.x;

        if(ball.directionX == -1)
        {
            //moving backwards
            float paddleFront = pPaddle.x + pPaddle.width + ball.mass/2; 
            float paddleBack = pPaddle.x;

            if( (ball.x <= paddleFront && ball.x >= paddleBack)
               && (ball.y >= pPaddle.y - pPaddle.height - ball.mass)
               && (ball.y <= pPaddle.y + pPaddle.height + ball.mass))
            {
                //contact with paddle
                debugger;
                ball.velocity.x *= -1;
                ball.directionX *= -1;
            }  
        }
        else if(ball.directionX == 1)
        {
            //moving forwards
            float paddleFront = pPaddle.x - pPaddle.width - ball.mass/2; 
            float paddleBack = pPaddle.x;

            if( (ball.x >= paddleFront && ball.x <= paddleBack)
               && (ball.y >= pPaddle.y - pPaddle.height - ball.mass)
               && (ball.y <= pPaddle.y +pPaddle.height + ball.mass))
            {
                debugger;
                ball.velocity.x *= -1;
                ball.directionX *= -1;
            }  
        }
     } 
```

整个代码/示例位于[此处](http://jsfiddle.net/XhPzL/64/)的 jsfiddle 上。

我可以通过删除等来调整计算`paddleBack`最右边桨的值的值`ball.mass/2`，以减轻该值，使碰撞看起来更好，但我想了解，为什么左侧碰撞的计算与那个不同在右侧？先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:37:53.157

我有预感

```
 //moving forwards
        float paddleFront = pPaddle.x - pPaddle.width + ball.mass/2; 
        float paddleBack = pPaddle.x; 
```

而`+ ball.mass/2`不是`- ball.mass/2`有所作为

# c# - 通过变量修改imagebutton的控件

> ID：15531536
> 
> 赞同：-1
> 
> 时间：2013-03-20T18:12:06.947
> 
> 标签：c#, asp.net

我在 c# 的 Web 应用程序中有一组图像按钮，如果满足某个条件，我想将可见状态更改为 true。即，如果我从数据库中获取 ABC，我想让 imagebutton c_ibABC 可见。

谁能告诉我如何通过变量名更改对图像按钮的控制。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:32:11.003

您可以使用该`FindControl`方法，这允许从页面动态获取控件。

```
protected ImageButton FindImageButton(string id)
{
    string fullId = "c_ib" + id;
    return Page.FindControl(fullId) as ImageButton;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:25:06.847

只需将 Visible 属性设置为 true。

```
buttonName.Visible=true; 
```

# vb6 - VB验证文本框输入为二进制数

> ID：15531540
> 
> 赞同：0
> 
> 时间：2013-03-20T18:12:13.343
> 
> 标签：vb6

我正在尝试验证 TextBox 的输入以确保它是二进制数。到目前为止，我所拥有的是：

```
Private Sub Command1_Click()
 Dim b() As Byte
 b = Text1.Text

 If Not IsByte (b) Then
    Text3 = "Wrong input"
    Else
    Text3 = "CRC is generated"
  '  checksum.Text = Text1.Text Xor Text2.Text
   ' Trans(2).Text = (Text1.Text) + (checksum.Text)
 End If 
```

Text1 中的输入应该只接受二进制数，因此只允许`1`or `0`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T20:53:55.687

你可以`Like`在这里使用：

```
Private Sub Command1_Click()
    If Len(Text1.Text) = 0 Or Text1.Text Like "*[!0-1]*" Then
        MsgBox "bad binary string"
    Else
        MsgBox "good binary string"
    End If
End Sub 
```

此模式正在测试“0 到许多任何东西，然后是一个不在 0 到 1 范围内的字符，然后是 0 到许多任何东西”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:21:58.033

即使我找不到检查二进制数据的功能。但是你不能像这样检查吗

```
 If textbox1.text = 1 or textbox1.text = 2 
```

我认为您也可以使用 instr 函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T18:29:31.240

下面是代码。在向此论坛发布任何问题之前，请您先用谷歌搜索一下。

```
'will only allow 0 and 1
Private Sub Text1_KeyPress(KeyAscii As Integer)
 Select Case KeyAscii
    Case vbKey0 To vbKey1
    Case Else
        KeyAscii = 0
    End Select
End Sub

' will validate if its numeric and you can further check for 0 or 1
Private Sub Command1_Click()
        If Not IsNumeric(Text1.Text) Then
            MsgBox "Please enter numbers only.", vbInformation
            'you may also consider erasing it
            Text1.Text = ""
        End If
    End Sub 
```

# python - 我应该挖掘哪些算法/概念来进行作者预测

> ID：15531548
> 
> 赞同：4
> 
> 时间：2013-03-20T18:12:40.063
> 
> 标签：python, machine-learning, classification, prediction

我一直在做一些事情，试图通过使用我自己的数据集来找出专栏的作者。

我打算使用[mlpy](http://mlpy.sourceforge.net/) python 库。它有很好的文档，（大约 100 页 pdf）。我也愿意接受其他图书馆的建议。

问题是，我迷失在数据挖掘和机器学习的概念中。有太多的工作，太多的算法和概念。

我正在询问方向，我应该学习哪些算法/概念，并搜索我的具体问题。

到目前为止，我已经构建了一个类似这样的数据集。

```
| author | feature x | feature y | feature z | some more features |
|--------+-----------+-----------+-----------+--------------------|
| A      |         2 |         4 |         6 | ..                 |
| A      |         1 |         1 |         5 | ..                 |
| B      |        12 |        15 |         9 | ..                 |
| B      |        13 |        13 |        13 | ..                 | 
```

现在，我将获得一个新列并对其进行解析，之后我将拥有该列的所有功能，我的目标是找出该列的作者是谁。

由于我不是 ML 专家，所以我只能考虑获取所有行上的特征之间的距离并选择最接近的那个。但我很确定这不是我应该走的路。

我会很感激任何方向，链接，阅读等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:16:37.317

如果你有足够的训练数据，那么你可以使用 kNN（k-Nearest Neighbor）分类器来达到你的目的。它易于理解，但功能强大。

检查[scikits.ann](http://projects.scipy.org/scikits/wiki/AnnWrapper)以获取可能的实现。

[此处的本教程](http://scikit-learn.org/stable/modules/neighbors.html)可作为 scikits-learn 中的一个很好的参考。

**编辑：**此外，这里是[scikits-learn 的 kNN](http://scikit-learn.org/dev/modules/generated/sklearn.neighbors.KNeighborsClassifier.html)页面。您可以从给定的示例中轻松理解它。

而且， mlpy[似乎也有 kNN](http://mlpy.sourceforge.net/docs/3.0/nonlin_class.html#mlpy.mlpy.KNN)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-22T07:30:30.993

正如其他人所提到的，您可以使用很多算法来进行作者归属。kNN 是一个很好的起点。此外，您可以尝试其他几种算法，例如[逻辑回归](http://en.wikipedia.org/wiki/Logistic_regression)、朴素贝叶斯分类器和神经网络，它们可能会提供更准确的预测。

我也对作者归属和剽窃检测感兴趣。事实上，我已经使用上述技术来进行源代码作者归属。您可以使用以下研究论文了解更多关于这些的信息。

1.  [http://www.ijmlc.org/papers/50-A243.pdf](http://www.ijmlc.org/papers/50-A243.pdf) [基于机器学习的源代码抄袭检测工具]
2.  [http://dl.acm.org/citation.cfm?id=2423074](http://dl.acm.org/citation.cfm?id=2423074)【源码作者识别与无监督特征学习】

此外，如果您打算使用 Python，还可以查看[http://scikit-learn.org/stable/](http://scikit-learn.org/stable/)库。这也是一个综合性的库，带有一个很好的文档。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T19:04:40.153

您可以在 mlpy 上实现多种算法，因此您应该没问题。我同意 Steve L 的说法，即支持向量机很棒，但即使它更容易使用，内部细节也不容易掌握，特别是如果你是 ML 新手。

除了 kNN，您还可以考虑分类树 ( [http://en.wikipedia.org/wiki/Decision_tree_learning](http://en.wikipedia.org/wiki/Decision_tree_learning) ) 和逻辑回归 ( [http://en.wikipedia.org/wiki/Logistic_regression](http://en.wikipedia.org/wiki/Logistic_regression) )。

对于初学者来说，决策树的优势在于可以产生易于理解的输出，因此更易于调试。

另一方面，如果您需要更多数据，逻辑回归可以为您提供良好的结果和很好的扩展性。

我会说，在你的情况下，你会寻找一种算法，在阅读一点后你会觉得使用起来更舒服。大多数时候，它们都非常有能力为您提供非常体面的结果。祝你好运！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-29T13:52:15.590

鉴于您不熟悉 ML，我推荐的前三种算法是：

1- 逻辑回归 2- 朴素贝叶斯 3- 支持向量机

如果您只对预测性能感兴趣，有足够的训练数据并且没有缺失值，您会发现使用更复杂的方法，例如贝叶斯网络，不会导致您的预测性能在统计上显着提高。即使他们这样做了，您也应该从这三种（相对）简单的方法开始，并将它们用作参考基准。

# c# - 如何将画布上绘制的椭圆保存为图像 - Windows RT

> ID：15531551
> 
> 赞同：1
> 
> 时间：2013-03-20T18:12:45.930
> 
> 标签：c#, windows-8, windows-runtime, winrt-xaml

我已经在画布上绘制了椭圆，现在如何将其保存为图像。我知道你不能直接将画布保存为图像，也不能截图。我在 C#/xaml 中工作。下面是我在画布上绘制椭圆的代码。

```
private void canvasDraw_PointerMoved(object sender, PointerRoutedEventArgs e)
    {
        if (drawing)
        {
            PointerPoint current = e.GetCurrentPoint((UIElement)sender);
           // Line line = new Line() { X1 = start.Position.X, Y1 = start.Position.Y, X2 = current.Position.X, Y2 = current.Position.Y };
            //line.Stroke = new SolidColorBrush(Colors.Black);
            Ellipse circle = new Ellipse();
            circle.SetValue(Canvas.LeftProperty, current.Position.X);
            circle.SetValue(Canvas.TopProperty, current.Position.Y);
            circle.Height = 20;
            circle.Width = 20;
            circle.Fill = currentBrush;
            circle.Opacity = 0.7;
            circle.SetValue(Canvas.ZIndexProperty,1);
            canvasDraw.Children.Add(circle);

        }
    } 
```

编辑：我可以使用 InkManager 保存图像。我将每个 Ellipse 存储在 inkmanager 中并调用 SaveAsync 方法，但最后一个问题是图像是黑色的，例如，如果我绘制红色椭圆，则保存的图像有黑色椭圆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-31T11:21:53.387

是的**RenderTargetBitmap**它在 Windows 商店应用程序目标中不可用 8.0

Windows 8.1 API 包括新的**RenderTargetBitmap**类，该类允许使用其 RenderAsync 方法呈现位图。您现在可以使用此方法 [链接](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.media.imaging.rendertargetbitmap.aspx)，尽管它不适用于我需要的 MediaElement :(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:46:39.057

阅读此示例[http://blogs.msdn.com/b/swick/archive/2007/12/02/rendering-ink-and-image-to-a-bitmap-using-wpf.aspx](http://blogs.msdn.com/b/swick/archive/2007/12/02/rendering-ink-and-image-to-a-bitmap-using-wpf.aspx)

网站代码摘录：

```
// render InkCanvas' visual tree to the RenderTargetBitmap
RenderTargetBitmap targetBitmap =
    new RenderTargetBitmap((int)inkCanvas1.ActualWidth,
                           (int)inkCanvas1.ActualHeight,
                           96d, 96d,
                           PixelFormats.Default);
targetBitmap.Render(inkCanvas1);

// add the RenderTargetBitmap to a Bitmapencoder
BmpBitmapEncoder encoder = new BmpBitmapEncoder();
encoder.Frames.Add(BitmapFrame.Create(targetBitmap));

// save file to disk
FileStream fs = File.Open(fileName, FileMode.OpenOrCreate);
encoder.Save(fs); 
```

# functional-programming - FP 语言：从列表中删除空列表

> ID：15531552
> 
> 赞同：0
> 
> 时间：2013-03-20T18:12:55.213
> 
> 标签：functional-programming

假设我有序列`<1,<>,2,<>>`。

我怎么能去删除空列表并得到`<1,2>`？理想情况下，不使用递归或迭代。

谢谢。

PS：我用的是[FP编程语言](http://en.wikipedia.org/wiki/FP_%28programming_language%29)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T15:54:39.773

您可能正在寻找的是[`filter`](http://rosettacode.org/wiki/Filter). 它接受一个谓词并取出不满足它的元素。

由于 FP 语言的语法很奇怪，而且我找不到任何文档，因此我无法提供`filter`. 但总的来说，它可以使用[`fold`](http://en.wikipedia.org/wiki/Fold_%28higher-order_function%29)--`insert`您提供的链接中的 s 来实现。

这就是我的意思（在 Haskell 中）：

```
filter p list = foldr (\x xs -> if p x then x:xs else xs) [] list¹ 
```

如果你不明白，请看[这里](http://rosettacode.org/wiki/Filter)。当你写完`filter`后，你可以这样称呼它

```
newList = filter notEmpty theList 
```

（其中`nonEmpty`是谓词或 lambda）。哦，当然这只是通过使用另一个函数来隐藏递归；在某些时候，你*必须*递归。

¹Haskell 中的 : 运算符是 list consing（将元素附加到头部），而不是函数应用程序。

# numpy - 如何使用启用的 OpenMP 指令重新编译 Numpy

> ID：15531556
> 
> 赞同：1
> 
> 时间：2013-03-20T18:13:19.477
> 
> 标签：numpy, openmp

在[这个回答`Multiprocessing.Pool makes Numpy matrix multiplication slower`](https://stackoverflow.com/a/15415690/380038)作者的回答中，在第二段中建议使用启用的 OpenMP 指令重新编译 Numpy。所以我的问题是：

1.  **你是怎样做的？**
2.  **什么可能是负面影响？**
3.  **你会推荐吗？**

搜索所以我发现以下帖子[OpenMP 和 Python](https://stackoverflow.com/questions/11368486/openmp-and-python)，其中的答案解释了为什么由于 GIL 而在一般 Python 中没有使用 OpenMP。但我认为 Numpy 是一个不同的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:00:34.270

虽然 Python 代码本身很难从并行运行中受益，但 NumPy 并不是用 Python 编写的。实际上，它是一些非常成熟的数值计算库和其他数值算法的 Python 包装器，它们都用 Fortran 和 C 等编译语言实现。其中一些库已经有并行多线程版本（如英特尔 MKL 和 ATLAS，当用于在 NumPy 中提供 BLAS 和 LAPACK 实现）。

这个想法是，在 NumPy 程序中，Python 代码应该只用于驱动计算，而所有繁重的工作都应该在 C 或 Fortran 后端完成。如果您的程序没有将大部分运行时间花在 NumPy 例程中，那么[阿姆达尔定律](http://en.wikipedia.org/wiki/Amdahl%27s_law)将阻止您通过并行 NumPy 获得合理的加速。

为了让 NumPy 支持 OpenMP，您必须拥有支持 OpenMP 的 C 编译器。现在大多数 C 编译器都支持 OpenMP，这包括 GCC、Intel C Compiler、Oracle C Compiler，甚至 Microsoft Visual C Compiler（尽管它停留在一个古老的 OpenMP 版本）。阅读[安装手册](http://www.scipy.org/Installing_SciPy)了解详细说明。

# c++ - c++ 注释中的 // @include 是什么

> ID：15531559
> 
> 赞同：9
> 
> 时间：2013-03-20T18:13:25.610
> 
> 标签：c++, c++11

我看到如下代码

```
// @include
template <typename T>
      .....
// @exclude 
```

其实，我是从[这里](http://code.google.com/p/elements-of-programming-interviews/source/browse/trunk/0-1_knapsack.cpp)看到的。

`@include`/在评论行中是否`@exclude`有特殊含义还是只是作者个人风格？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-20T18:16:11.667

这在标准 C++ 中没有特殊含义，可能是直接解析源文件的某些（文档）工具的一部分。

特别是，这是一本书的代码。作者可能选择了这种语法来描述（并且可能自动提取）书中的内容和没有的内容。

# java - StringBuffer setLength 与子字符串

> ID：15531566
> 
> 赞同：2
> 
> 时间：2013-03-20T18:13:40.860
> 
> 标签：java, string, substring, stringbuilder

在 stringbuilder 中修剪到一个长度。

我应该使用什么？

```
StringBuilder sb = new StringBuilder("203253/62331066                          ");
StringBuilder sb1 = new StringBuilder("203253/62331066                          ");
int newLen = Math.min(sb.length(), ACCT_LENGTH);
sb = new StringBuilder(sb.substring(0, newLen));
sb1.setLength(newLen);
System.out.println(sb);
System.out.println(sb1); 
```

`setLength(newLength)`或`new StringBuilder`与`substring()`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:18:29.147

创建一个新的 StringBuilder 类型违背了使用 StringBuilder 的目的，而不仅仅是一个 String... 即缓冲而不是创建一个新对象。所以我会投票给 setLength()。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T18:34:39.193

`setLength`效率更高，因为它只是更改了一个跟踪 StringBuilder 大小的内部计数器，而不更改任何其他内容（当然假设新长度更小）。

`substring`创建一个新的字符串，这意味着一个数组副本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T18:37:59.233

这取决于你打算做什么。

如果您已经完成`StringBuilder`并且不会重新使用您打算修剪的部分，那么我想不出一个不使用的充分理由`setLength`：它没有内存成本，而不是`substring`创建一个新实例并克隆内部字符数组。

另一方面，如果您打算继续使用初始的内容`StringBuilder`但需要另一个实例来存储子字符串，那么`substring`是更好的选择。

具体来说，在您粘贴的代码中，您将继续使用`sb`还是丢弃它并`sb1`仅使用它？如果是前者，使用`substring`，如果是后者，`setLength`。

# google-apps-script - 将文档内容放入文本框

> ID：15531571
> 
> 赞同：0
> 
> 时间：2013-03-20T18:14:05.837
> 
> 标签：google-apps-script

我正在寻找 Google Word 文档的内容并将其放入文本框中。以下代码吐出错误：

```
function listBoxClick(e) {
  var tapp = UiApp.getActiveApplication();
  var docName = DocsList.find(e.parameter.doclist); //find the document with the same name as what the user clicked on
  var docContents = docName[0].getContentAsString(); //get contents of document
  tapp.getElementById("songboxID").setValue(songfile2); //set the value of the textBox to the contents of the document
  return tapp;
} 
```

这将返回以下错误：

```
Unsupported conversion requested. 
```

我在某处读到我们无法为 Google 文档执行此操作，但我们可以为我们上传的其他非 Google 文档执行此操作。那正确吗？

* * *

这是我不能再发布 5 个小时的答案，因为我是新手并且没有声誉：

在 Serge 的帮助下，这对我有用：

```
function listBoxClick(e) {
  var tapp = UiApp.getActiveApplication();
  var docName = DocsList.find(e.parameter.doclist); //get document name based on what user clicked on in listBox
  var docId = docName[0].getId(); //get document ID
  var content = DocumentApp.openById(docId).getText(); //get contents of document
  tapp.getElementById("songboxID").setValue(content); //set web app's textBox (called songboxID) to match the contents of the document the user clicked on
  return tapp;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:23:42.190

您必须使用`DocumentApp.getText();`来获取文档的文本内容。

在你的代码中它会变成：

```
function listBoxClick(e) {
  var tapp = UiApp.getActiveApplication();
  Logger.log(e.parameter.doclist)
  var docName = DocsList.find(e.parameter.doclist); //find the document with the same name as what the user clicked on
  var docId = docName[0].getId();
  Logger.log(docName[0].getName()+' = '+docId)
  var textContent = DocumentApp.openById(docId).getText();
  Logger.log(textContent)
  tapp.getElementById("songboxID").setValue(textContent); //set the value of the textBox to the contents of the document
  return tapp;
} 
```

* * *

**编辑：**正如您在实验中注意到的那样，`DocsList.find(e.parameter.doclist)`返回的结果出乎您的意料……这仅仅是因为`find`操作员不仅搜索文档名称，还搜索文档内容。

为了解决这个问题，您应该添加一个小例程，根据文档名称检查查找查询的结果，如下所示：

```
var docName = DocsList.find(e.parameter.doclist); //find the document with the same name as what the user clicked on

      for(var d in docName){{
         if(docName[d].getName()==e.parameter.doclist){
         var docId = docName[d].getId();
        }
      } 
```

这将确保您要查找的文档实际上是正确的。

PS：很抱歉没有立即提及……它只是从我的脑海中溜走；-​​)

# android - 如何自定义谷歌地图中信息窗口的 state_pressed 颜色？

> ID：15531578
> 
> 赞同：4
> 
> 时间：2013-03-20T18:14:33.183
> 
> 标签：android, google-maps-android-api-2, infowindow

我正在尝试自定义 Google 地图中 InfoWindow 的 state_pressed 行为。通常，当按下此 InfoWindow 时，它会变为黄色。自定义 InfoWindows 也是如此。但我想把它改成另一种颜色，比如红色、橙色或蓝色。

所以我创建了一个非常简单的自定义信息窗口，如下所示：

```
class MyInfoWindowAdapter implements InfoWindowAdapter {
    private final View myContentsView;

    MyInfoWindowAdapter() {
        myContentsView = getLayoutInflater().inflate(R.layout.popup, null);
    }

    @Override
    public View getInfoContents(Marker marker) {
        return null;
    }

    @Override
    public View getInfoWindow(Marker marker) {
        return getLayoutInflater().inflate(R.layout.popup2, null);
    }
} 
```

popup2 的 xml 只是添加了一个简单的可绘制对象，并在其中添加了一些文本，并使其可点击。可点击与否没有区别。

```
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:text="Test Popup"
    android:background="@drawable/info_window"
    android:clickable="true"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >
</TextView> 
```

最后是drawable：

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_pressed="false">
        <shape android:shape="rectangle">
            <stroke android:width="1dp" android:color="@color/divider" />
            <solid android:color="@color/background_button" />
            <padding android:left="40dip"
                 android:top="10dip"
                 android:right="10dip"
                 android:bottom="40dp"/> 

        </shape>
    </item>
    <item android:state_pressed="true">
        <shape android:shape="rectangle">
            <stroke android:width="1dp" android:color="@color/divider" />
            <solid android:color="@color/background_button_active" />
            <padding android:left="40dip"
                 android:top="10dip"
                 android:right="10dip"
                 android:bottom="40dp"/> 

        </shape>
    </item>
</selector> 
```

这里的选择器是我希望改变 state_pressed 颜色的，但它没有。但是，如果我切换`android.state_pressed`语句（第一个是真的，第二个是假的），那么选择器本身就会起作用，颜色确实会改变。但只有未按下状态发生变化，按下状态仍变为黄色。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T20:13:36.690

您可能想在此处支持此增强功能：[http ://code.google.com/p/gmaps-api-issues/issues/detail?id=4783](http://code.google.com/p/gmaps-api-issues/issues/detail?id=4783)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:21:31.027

用简单的话“你不能”。

因为根据文档“信息窗口不是实时视图，而是将视图呈现为地图上的图像。因此，您在视图上设置的任何侦听器都将被忽略，并且您无法区分不同部分的点击事件视图。建议您不要将交互式组件（例如按钮、复选框或文本输入）放置在自定义信息窗口中。”

**因此，简而言之，除了“OnInfoWindowClickListener”**之外，您无法处理 infowindow 上的任何事件

 **有关更多信息，请查看“ [https://developers.google.com/maps/documentation/android/marker](https://developers.google.com/maps/documentation/android/marker) ”。**

# asp.net-mvc-4 - 实体框架 - 选择特定列

> ID：15531583
> 
> 赞同：1
> 
> 时间：2013-03-20T18:14:43.167
> 
> 标签：asp.net-mvc-4, entity-framework-5

我有一个成功的查询，它将两个表与 where 和 orderby 子句联系起来，但我想添加以仅选择特定列而不是取回所有内容。

第 1 部分当我尝试这样做时，我在 orderby 行上出现语法错误，如果我删除 orderby 行，语法错误将移至 where 行。

错误 3 无法将类型“System.Linq.IOrderedQueryable”隐式转换为“System.Linq.IQueryable”。存在显式转换（您是否缺少演员表？）

```
 IQueryable<VendorProfile> query = _db.VendorProfiles
            .Include("VendorCategories")
            .Include("VendorsSelected")
            .Select(s => new  { s.ProfileID, s.Name, s.CompanyName, s.City, s.State, s.DateCreated, s.VendorsSelected, s.VendorCategories })
            .Where(x => x.VendorsSelected.Select(s => s.UserName).Contains(HttpContext.Current.User.Identity.Name))
            .OrderBy(x => x.DateCreated);

       if (criteria.name != string.Empty)
            query = query.Where(v => v.Name.Contains(criteria.name));
        if (criteria.company != string.Empty)
            query = query.Where(v => v.CompanyName.Contains(criteria.company));
        if (criteria.startDate != null && criteria.endDate != null)
            query = query.Where(v => v.DateCreated > criteria.startDate && v.DateCreated < criteria.endDate);
        if (criteria.categories != null && !criteria.categoryMatchAll)
            query = query.Where(v => criteria.categories.AsQueryable().Any(cat => v.VendorCategories.Select(vendCat => vendCat.CategoryID).Contains(cat)));
        if (criteria.categories != null && criteria.categoryMatchAll)
            query = query.Where(v => criteria.categories.AsQueryable().All(cat => v.VendorCategories.Select(vendCat => vendCat.CategoryID).Contains(cat)));
        if (criteria.minorityType != null)
            query = query.Where(v => v.MinotiryOwned == criteria.minorityType);
        if (criteria.diversityClass != null)
            query = query.Where(v => v.DiversityClassification == criteria.diversityClass);

        return query.ToList(); 
```

第 2 部分我还想知道是否可以将选定的列提取到视图模型类中，所以我厌倦了这个，我在 orderby 行上得到了与上面相同的结果

错误 4 无法将类型“System.Linq.IOrderedQueryable”隐式转换为“System.Linq.IQueryable”。存在显式转换（您是否缺少演员表？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:02:19.700

**回答**

我认为您帮助我偶然发现了类型不匹配的事实。使 IQueryable 类型和选择新类型以及返回类型 SAME 使语法快乐。使用 var 不喜欢。

```
public IEnumerable<BrowseVendorModel> SearchVendors(CustomSearchModel criteria)
{
    IQueryable<BrowseVendorModel> query = _db.VendorProfiles
        .Include("VendorCategories")
        .Include("VendorsSelected")
        .Select(s => new BrowseVendorModel
        {
            ProfileID = s.ProfileID,
            Name = s.Name,
            CompanyName = s.CompanyName,
            City = s.City,
            State = s.State,
            DateCreated = s.DateCreated,
            VendorsSelected = s.VendorsSelected,
            VendorCategories = s.VendorCategories
        })
        .Where(x => x.VendorsSelected.Select(s => s.UserName).Contains(HttpContext.Current.User.Identity.Name))
        .OrderBy(x => x.DateCreated);

    if (criteria.name != string.Empty)
        query = query.Where(v => v.Name.Contains(criteria.name));
    if (criteria.company != string.Empty)
        query = query.Where(v => v.CompanyName.Contains(criteria.company));
    if (criteria.startDate != null && criteria.endDate != null)
        query = query.Where(v => v.DateCreated > criteria.startDate && v.DateCreated < criteria.endDate);
    if (criteria.categories != null && !criteria.categoryMatchAll)
        query = query.Where(v => criteria.categories.AsQueryable().Any(cat => v.VendorCategories.Select(vendCat => vendCat.CategoryID).Contains(cat)));
    if (criteria.categories != null && criteria.categoryMatchAll)
        query = query.Where(v => criteria.categories.AsQueryable().All(cat => v.VendorCategories.Select(vendCat => vendCat.CategoryID).Contains(cat)));
    if (criteria.minorityType != null)
        query = query.Where(v => v.MinotiryOwned == criteria.minorityType);
    if (criteria.diversityClass != null)
        query = query.Where(v => v.DiversityClassification == criteria.diversityClass);

    return query;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T19:30:48.613

第一个示例需要`var`，因为您通过投影到匿名类型来更改查询的形状。第二个示例可以使用`var`，或者`IQueryable<VendorProfileViewModel>`因为您通过投影来更改查询的形状`VendorProfileViewModel`。

# java - javassist 字段检查初始化

> ID：15531585
> 
> 赞同：0
> 
> 时间：2013-03-20T18:14:56.553
> 
> 标签：java, reflection, initialization, field, javassist

我目前正在实现一个注释，它强制字段通过 javassist 遵守条件。我想检查一个字段在读取时是否已初始化......所以，目前，我通过在 VM 通过 a 加载它们时加载它们来获取这些类`Translator.onLoad(ClassPool pool, String className)`，并`ExprEditor`通过覆盖`edit(FieldAccess arg)`方法在每个类上使用 a . 现在，我设法通过在内部运行以下方法来注入代码以检查条件`onLoad`：

```
 private void processFields(FieldsAndMethods data) {
        final FieldsAndMethods copy = data;
        Stack<CtClass> classes = data.getThisClass();
        for(CtClass cc : classes ){
            try {
                cc.instrument(new ExprEditor(){

                @Override
                public void edit(FieldAccess arg) throws CannotCompileException{
                   try{
                        CtField field = arg.getField();
                        if(copy.getFields().contains(field) &&
                           field.hasAnnotation(Assertion.class)){

                            Assertion a =
                                ((Assertion)field.getAnnotation(Assertion.class))   
                            String condition = assertion.value();
                            String fieldName = field.getName();
                            String processCondition = 
                                transformCondition(condition, fieldName);

                            if(arg.isWriter()){

                                String code = "{if(" + evaledCondition + ")" +                                         
                                              "$proceed($$) ;" +
                                              "else throw new " + 
                                              "RuntimeException(\"The assertion " + 
                                                   condition + " is false.\");}";                                                                               
                                arg.replace(code);

            }else if (arg.isReader()){
                                //Here is where I would like to check if the field 
                                //has been initialized... 
            }

                        }catch(ClassNotFoundException e){
                            System.out.println("could not find Annotation " + 
                            Assertion.class.getName() );
                        }catch(NotFoundException e){
                            System.out.println("could not find field " + 
                            arg.getFieldName() );
                        }                                       
                    }
                });
            } catch (CannotCompileException e) {                
                System.out.println("Could not interpret the expression");
                System.out.println(e);
            }
        }       
    }

    private String transformCondition(String condition, String fieldName){
        return condition.replace(fieldName, "$1");      
    } 
```

您能否指出正确的方向以找出字段是否已初始化？请注意，字段可以是原始字段，也可以不是原始字段。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T11:59:18.647

## 假设

我将假设以下内容：

*   通过*字段初始化*，我们谈论的*是 null*的字段。

*   原始类型不能为空，因此无需检查它们。

## 编码

此示例验证适用于静态和非静态字段。

我还在几行中创建了代码字符串，以提高可读性。作为**arg**一个*FieldAccess*对象，您可以编写以下内容：

```
 if (arg.isReader() && !arg.getField().getType().isPrimitive()) {
  String code = "{ java.lang.Object var = $proceed();"
               +  "if(var == null) {"
                   + "java.lang.System.out.println(\"not initialized " + arg.getFieldName() + "\");"
               +  "}"
               + "$_=var;}";
            arg.replace(code);
        } 
```

## 代码说明

如您所见，在这个小示例中，我使用了一些 javassist 标识符，有关此内容的完整参考，请阅读[javassist 官方教程](http://www.csg.is.titech.ac.jp/%7Echiba/javassist/tutorial/tutorial2.html#alter)（我链接到有关代码修改的部分）。

以下是使用的每个标识符的含义：

*   *$proceed()*：在字段访问的情况下，这将返回字段的值。
*   *$_ ：这是在**读取*模式下编辑 FieldAccess 时必需的标识符。此标记保存将用于设置字段的值。

有了这些信息，就很容易理解代码的想法：

1.  将字段值放入名为*var的辅助对象中*
2.  检查字段是否为空，如果是，则打印带有字段名称的警告
3.  使用值设置字段名（它是否为空）；

我想这已经为您指明了正确的方向。但是，如果您需要其他任何东西，请告诉我。

# c++ - 计数器不工作？

> ID：15531590
> 
> 赞同：0
> 
> 时间：2013-03-20T18:15:05.850
> 
> 标签：c++

我正在为家庭作业编写一个程序，该程序根据品牌、租用天数和行驶里程计算租车费率。总体而言，该程序的工作原理是，当提示用户输入要计算的汽车数量时，程序会在超出数量后继续提示用户输入。此外，英里的格式对于输入的第一辆车是正确的，但对于后续的输入会发生变化。

对于这两个问题的任何帮助将不胜感激！

代码：

```
#include <iostream>
#include <string>
#include <sstream>
#include <iomanip>
#include <cmath>

using namespace std;

int main()
{
    // Change the console's background color.
    system ("color F0");

    // Declare the variables.
    char carType;
    string brand, f("Ford"), c("Chevrolet");
    int counter = 0, cars = 0;
    double days, miles, cost_Day, cost_Miles, day_Total;

    cout << "Enter the number of cars you wish to enter: ";
    cin >> cars;
    cin.ignore();

    while (counter <= cars)
    {

        cout << "Enter the car type (F or C): ";
        cin >> carType;
        cin.ignore();
        cout << "Enter the number of days rented: ";
        cin >> days;
        cin.ignore();
        cout << "Enter the number of miles driven: ";
        cin >> miles;
        cin.ignore();

        if (carType == 'F' || carType == 'f')
        {
            cost_Day = days * 40;
            cost_Miles = miles * .35;
            day_Total = cost_Miles + cost_Day;
            brand = f;
        }
        else
        {
            cost_Day = days * 35;
            cost_Miles = miles * .29;
            day_Total = cost_Miles + cost_Day;
            brand = c;
        }

        cout << "\nCar            Days   Miles        Cost\n";
        cout << left << setw(12) << brand << right << setw(6) << days << right << setw(8) << miles 
        << fixed << showpoint << setprecision (2) << setw(8) << right << "$" << day_Total << "\n\n";
        counter++;
    }

        system ("pause");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:24:58.267

你已经从 0 开始数`int counter = 0, cars = 0;`

然后，您计数直到您等于输入的数字（“或等于”位`while (counter <= cars)`）。

作为一个工作示例，如果我想要 3 个条目：

```
Start: counter = 0, cars = 3.
0 <= 3: true
End of first iteration: counter = 1
1 <= 3: true
End of second iteration: counter = 2
2 <= 3: true
End of third iteration: counter = 3
3 <= 3: true (the "or equal" part of this)
End of FORTH iteration: counter = 4
4 <= 3: false -> Stop 
```

我们已经完成了 4 次迭代，而不是 3 次。如果我们只检查“严格小于”( `counter < cars`)，第三次迭代结束时的条件将是错误的，我们会在那里结束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:25:08.000

您的 while 循环的标题应该是：

```
while(counter < cars) 
```

而不是

```
while(counter <= cars) 
```

# java - 导入和包

> ID：15531591
> 
> 赞同：1
> 
> 时间：2013-03-20T18:15:09.050
> 
> 标签：java, packages

我不太确定我做错了什么，在这里。我在一个目录中有两个文件，我们称它们为 FileA.java 和 FileB.java。

FileA.java 的定义如下：

```
package com.domain.package;

import stuff;
import package.FileB;

public class FileA extends Blah implements Listener {
    /* global vars */
    /* methods */
} 
```

FileB.java 是我的数据对象类，因此我想从 FileA.java 引用它：

```
Map<Object, FileB> varname; 
```

沿线使用：

```
varname = new HashMap<Object, FileB>(); 
```

另一方面，FileB.java 的定义如下：

```
package com.domain.package;

import stuff;

public class FileB {
    /* global vars */
    public FileB() {
         /* stuff */
    }
} 
```

为什么我得到：

```
FileA.java:20: package package does not exist
import package.FileB; 
```

? 相反，我该如何让它发挥作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:33:02.310

`package` is a [reserved word](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/_keywords.html), don't use it as part of a package name. If you try to add a package with "package" as part of it in Eclipse, you will get an error message:

```
Invalid package name. 'package' is not a valid Java identifier 
```

Rename the package, then remove the import statement. You don't need to import a file that's in the same package as the one it's referenced in.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:17:10.687

因为这两个文件都在同一个包 ( `com.domain.package`) 中，所以您根本不需要导入`FileB`。您应该可以直接引用它。

此外，请确保两者`FileA`和`FileB`都放在它们的包文件夹中：com/domain/package。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T18:17:22.353

FileB 的包是`com.domain.package`. 您正在尝试`package.FileB`改用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T18:38:44.177

@rgettman 有正确的解决方案。使用编译这两个文件`javac FileA.java FileB.java`解决了这个问题。你也可以使用他的建议：`javac *.java`

# python - SQLAlchemy关系错误与一对多rel

> ID：15531593
> 
> 赞同：1
> 
> 时间：2013-03-20T18:15:13.453
> 
> 标签：python, mysql, sqlalchemy, one-to-many

所以我在 SQLAlchemy (0.8) 中有这种一对多的关系：

```
class Parent(Base):

    __tablename__ = "parents"

    cid = Column(Integer(11), primary_key = True, autoincrement = False)
    uid = Column(Integer(11), ForeignKey('otherTable.uid',
           ondelete = 'CASCADE'), primary_key = True)
    ...

    # Relationship with child
    childs_rel = relationship("Child", backref = 'parents', 
                              cascade = "all, delete-orphan") 
```

和

```
class Child(Base):

    __tablename__ = "childs"

    mid = Column(Integer(11), primary_key = True, autoincrement = False)
    cid = Column(Integer(11), ForeignKey('parents.cid',
           ondelete = 'CASCADE'), primary_key = True)
    uid = Column(Integer(11), ForeignKey('parents.uid',
           ondelete = 'CASCADE'), primary_key = True)
    ... 
```

我可以创建这个数据库，但是当我尝试操作它时，我得到了这个错误：

> sqlalchemy.exc.AmbiguousForeignKeysError：无法确定关系 Parent.childs_rel 上的父/子表之间的连接条件 - 有多个外键路径链接表。指定“foreign_keys”参数，提供那些列的列表，这些列应该被视为包含对父表的外键引用。

我试图在childs_rel中指定'foreign_keys'，但它说Parent的类中没有外键，这是真的......必须在child的类中指定，但根据SQLAlchemy的ORM doc，关系定义在“ “一对多”关系中的一个”...

[http://docs.sqlalchemy.org/en/rel_0_8/orm/relationships.html#one-to-many](http://docs.sqlalchemy.org/en/rel_0_8/orm/relationships.html#one-to-many)

你认为这里发生了什么？多谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T09:45:47.207

我想我知道这里发生了什么：

> 请注意，您不能使用 ForeignKey 对象定义“复合”外键约束，即一组多个父/子列之间的约束。要定义此分组，必须使用 ForeignKeyConstraint 对象并将其应用于表。关联的 ForeignKey 对象是自动创建的。

对不起大家。无论如何谢谢！:D

编辑：这是我为需要它的人提供的解决方案：

```
class Child(Base):

    __tablename__ = "childs"

    mid = Column(Integer(11), primary_key = True, autoincrement = False)
    cid = Column(Integer(11), primary_key = True)
    uid = Column(Integer(11), primary_key = True)

    __table_args__ = (ForeignKeyConstraint([cid, uid], [Parent.cid, Parent.uid]), {}) 
```

# ios - UITextView selectedRange 在使用属性文本属性时返回不正确的值

> ID：15531594
> 
> 赞同：3
> 
> 时间：2013-03-20T18:15:14.750
> 
> 标签：ios, uitextview, nsattributedstring

我有一个通过 UITextView.attributedText 使用 NSAttributedString 的 UITextView。当我调用 UITextView.selectedRange 时，如果文本包含特殊字符，它会给出不正确的值。有人知道如何从具有属性文本的 UITextView 中获取正确的 selectedRange 吗？提前致谢。

# javascript - KnockOutJS 在子订阅上触发父函数

> ID：15531597
> 
> 赞同：1
> 
> 时间：2013-03-20T18:15:24.437
> 
> 标签：javascript, mvvm, knockout.js

我目前正在尝试学习 KnockOutJS。我认为创建一个简单的任务列表应用程序是个好主意。我不想在这里写长文，让我们深入探讨我的问题。我感谢各种帮助 - 我是 KnockOutJS 的新手！

任务声明如下：

```
var Task = function (data) {
    var self = this;

    self.name = ko.observable(data.name);
    self.status = ko.observable(data.status);
    self.priority = ko.observable(data.priority);
} 
```

视图模型看起来像这样

```
var TaskListViewModel = function() {
var self = this;

self.currentTask = ko.observable();
self.currentTask(new Task({ name: "", status: false, priority: new Priority({ name: "", value: 0 }) }));

self.tasksArr = ko.observableArray();

self.tasks = ko.computed(function () {
    return self.tasksArr.slice().sort(self.sortTasks);
}, self);

self.sortTasks = function (l, r) {
    if (l.status() != r.status()) {
        if (l.status()) return 1;
        else return -1;
    }

    return (l.priority().value > r.priority().value) ? 1 : -1;
};

self.priorities = [
    new Priority({ name: "Low", value: 3 }),
    new Priority({ name: "Medium", value: 2 }),
    new Priority({ name: "High", value: 1 })
];

// Adds a task to the list
// also saves updated task list to localstorage
self.addTask = function () {
    self.tasksArr.push(new Task({ name: self.currentTask().name(), status: false, priority: self.currentTask().priority() }));
    self.localStorageSave();

    self.currentTask().name("");
};

// Removes a task to a list
// also saves updated task list to localstorage
self.removeTask = function (task) {
    self.tasksArr.remove(task);
    self.localStorageSave();
};

// Simple test function to check if event is fired.
self.testFunction = function (task) {
    console.log("Test function called");
};

// Saves all tasks to localStorage
self.localStorageSave = function () {
    localStorage.setItem("romaTasks", ko.toJSON(self.tasksArr));
};

// loads saved data from localstorage and parses them correctly.
self.localStorageLoad = function () {
    var parsed = JSON.parse(localStorage.getItem("romaTasks"));
    if (parsed != null) {
        var tTask = null;
        for (var i = 0; i < parsed.length; i++) {
            tTask = new Task({
                name: parsed[i].name,
                status: parsed[i].status,
                priority: new Priority({
                    name: parsed[i].priority.name,
                    value: parsed[i].priority.value
                })
            });
            self.tasksArr.push(tTask);
        }
    }
};
self.localStorageLoad();
} 
```

我想在我的 html 中执行的操作非常简单。我添加的所有任务都保存到 localStorage。如您所见，每次添加和删除元素时都会调用 save 函数。但是我也想在每个任务的状态一改变就保存，但是这里不能用subscribe，比如

```
self.status.subscribe(function() {}); 
```

因为我无法从 Task 类访问 self.tasksArr 。

任何想法？是否有可能以某种方式公开 self.tasksArr ？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T20:08:57.353

尝试这个：

```
self.addTask = function () {
  var myTask = new Task({ name: self.currentTask().name(), status: false, priority: self.currentTask().priority() })
  myTask.status.subscribe(function (newValue) {
    self.localStorageSave();
  });
  self.tasksArr.push(myTask);
  self.localStorageSave();
  self.currentTask().name("");
}; 
```

# java - Struts 和可变后置参数

> ID：15531605
> 
> 赞同：0
> 
> 时间：2013-03-20T18:15:42.777
> 
> 标签：java, struts, paypal-ipn, struts1

我正在尝试将 paypal IPN 与我的 Java Struts Web 应用程序集成。根据贝宝的说法，在所有交易类型中只有 2 个变量通过 IPN 发布，但还有许多其他变量可能会发布。

如果发送的 post 变量不在我的操作表单中，则 struts 将返回有关表单没有属性/设置器的错误。

IPN 有 300 个变量，我真的不想为所有可能的变量设置一个字段。是否可以在 struts 中接受我的 actionForm 可能没有考虑的 post 变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:32:48.380

如果你想使用不在 Struts 表单中的 Post 变量，你应该绕过 struts 表单并使用带有 struts 动作类的简单 html 表单。某些没有 getter setter 的 struts 形式的 post 变量将抛出您指定的异常。所以最好使用 HTML 表单来获得更大的灵活性。当然，我们应该为这种类型的表单编写一些验证功能和其他功能。

我们想说的是，您可以使用带有 struts 动作类的简单 html 表单而不会出现任何问题。我们已经在我们的生产应用程序中完成了这些类型的工作。

谢谢

# .net - 在网页上链接硬盘上的 PDF

> ID：15531607
> 
> 赞同：-1
> 
> 时间：2013-03-20T18:15:44.667
> 
> 标签：.net

我正在运行一个.Net 网站。docroot 位于 C: 驱动器上，系统生成 PDF 到 E: 驱动器上的文件夹。我想在我的网站上有指向 PDF 的链接。E: 驱动器不是 HTTP 驱动器，它只是一个 Windows 驱动器。

1.  有没有一种简单的方法可以链接到 PDF，或者我必须将它们全部移动到 C: 中的 docroot 中？
2.  另外，我需要保护 E: 驱动器和文件夹免受黑客攻击。

我正在寻找一个简单、安全的解决方案。

更新：我找到了这个解决方案。我传递了合同 ID。PDF 的名称基于合同 ID。此代码在我的浏览器中打开 PDF。

```
strPDF0="S" & getFormatwith0(cint(ContractID),3) & ".PDF"
strPDF="E:\FTProot\docs\" & strPDF0
Set FSOobj = Server.CreateObject("Scripting.FileSystemObject")
if FSOobj.FileExists(strPDF) Then 
Response.ContentType = "application/pdf"
'Set file name
Response.AddHeader "Content-Disposition", "inline; filename=" & strPDF0

Set oFileStream = Server.CreateObject("ADODB.Stream")
oFileStream.Open
oFileStream.Type = 1 'Binary
oFileStream.LoadFromFile strPDF

Response.BinaryWrite(oFileStream.Read)

oFileStream.Close
Set oFileStream= Nothing
Else
Response.Write "Contract does not exist"
End if 
Set FSOobj = Nothing 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T19:12:25.690

您不能将文件作为链接发送，因为用户无法访问`e:\myfolder\`

但是，您可以编写一个文件作为响应，如下所示。请确保您设置了适当的读取权限`e:\myfolder\`

```
HttpResponse response = HttpContext.Current.Response;
response.ContentType = "application/pdf";
response.AddHeader("Content-Disposition", "attachment; filename=file.pdf");
response.WriteFile("e:\myfolder\file.pdf");
response.End(); 
```

# c# - WinRT C# - 从子框架更改主框架的内容

> ID：15531609
> 
> 赞同：1
> 
> 时间：2013-03-20T18:16:02.323
> 
> 标签：c#, xaml, windows-8, windows-runtime, winrt-xaml

我的 MainPage.xaml 中有一个 ListView 和 ContentFrame（框架控件）。

例如，如果我将页面 Content.xaml 导航到此 ContentFrame，然后我需要从他的 Content.xaml 调用 Navigate。但是导航必须更改主应用程序框架的内容（它是父母框架）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:12:07.057

在某处保留对根框架的引用 - 例如作为 App 类的静态属性并使用它来调用 Navigate()。或者，您可以沿着视觉树或逻辑树向上走，然后找到下一帧以获取参考。

# ios - 视图不使用自动布局设置动画

> ID：15531612
> 
> 赞同：3
> 
> 时间：2013-03-20T18:16:12.317
> 
> 标签：ios, uiview, uiviewanimation, autolayout

我一直在搜索 SO 并找到了一些相关的帖子，但没有一个（还）解决了我的问题。

我的情节提要中有一个视图设置，通过一个 IBOulet 连接了一个约束。在某个动作后，视图应该向上移动（或向下移动到它的初始位置）。对于我的生活，我无法让它正常工作。在自动布局之前，我运行了这段代码：

```
- (void)animateStarBackground:(NSString *)animationID
                 finished:(NSNumber *)finished
                  context:(void *)context
                   myView:(UIView *)myView
                     xPos:(float)xPos
                     yPos:(float)yPos {

    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:0.2];
    [UIView setAnimationDelay:0.5];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];
    [UIView setAnimationDelegate:self];

    myView.center = CGPointMake(xPos, yPos);

[UIView commitAnimations]; 
```

}

它曾经很好用，但无论如何......我们都知道这在 Autolayout 中不再适用了。所以我将其更改为以下内容：

```
-(void)animateButton:(UIView *)myView {

    [UIView animateWithDuration:8.0f animations:^{
        _viewConstA.constant = 45.0;
        [myView layoutIfNeeded];
    }]; 
```

}

当动作发生时，它不是从故事板中设置的初始位置开始，而是从左上角的 1x1 像素视图开始，并向*下*动画到它的最终静止位置（而不是像我一样向上移动 15 个像素打算）。

现在，如果我取出**[myView layoutIfNeeded];** 部分，该动作将视图定位在正确的位置......但它没有在那里设置动画。它只是在视图出现时立即出现。

第一个屏幕抓取是初始位置。第二次抓取应该是意见的最后休息地。第三是从错误的位置和方向动画的视图。

想法/评论？我到底做错了什么？我认为这很容易......我必须遗漏一些明显的东西。

![在此处输入图像描述](../Images/207b3eb99f12a1d3ad177c7586dd34b6.png)

![在此处输入图像描述](../Images/ef31bb6de94309ead62c415c8ed69886.png)

![在此处输入图像描述](../Images/98c93fb48a3e7e2037b106acd47ba04c.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T04:17:34.547

当我从 调用以下基于块的动画时`viewDidLoad`，它会将帧动画从`CGRectZero`到最终位置。但是，如果我从 调用它`viewDidAppear`，它会按预期工作。

```
- (void)animateMovementByConstraint
{
    [UIView animateWithDuration:0.5
                     animations:^{
                         self.topLayoutConstraint.constant = 100;
                         [self.view layoutIfNeeded];
                     }];
} 
```

（在这个例子中，`topLayoutConstraint`是`IBOutlet`我在 Interface Builder 中为我想要动画的控件上的顶部垂直约束定义的。）

使用自动布局，自从我开始在 中启动动画以来`viewDidAppear`，我没有遇到任何问题。

# php - 修改 WordPress 中的输出 URL 以包含另一个文件夹

> ID：15531620
> 
> 赞同：0
> 
> 时间：2013-03-20T18:16:37.557
> 
> 标签：php, wordpress, supersized

几天来，我一直在为此苦苦挣扎，试图修改可能包含不同文件夹的字符串的每一部分。我在 PhotoArtist 主题中使用 Supersized jQuery 滑块。如果你想在这里看到它的链接：[http](http://www.arjanbaagh.com/testsite/sliders-list/bridal-2013-collection/) ://www.arjanbaagh.com/testsite/sliders-list/bridal-2013-collection/ 。

我想要实现的是修改`$output`字符串以在文件名之前包含不同的文件夹。我正在尝试使用不同的缩略图进行预览。当前，滑块从主预览中拉出图像并动态缩小。这是在页面上显示缩略图的 PHP 代码行：

```
$output .=" thumb : ". "'" . get_template_directory_uri() . "/framework/timthumb/timthumb.php?src=".thumb_link($element['img']) .  "&w=300&h=150'}"; 
```

这将输出以下 URL：

[http://www.arjanbaagh.com/testsite/wp-content/themes/photoartist-parent/framework/timthumb/timthumb.php?src=http://www.arjanbaagh.com/testsite/wp-content/uploads/ 2012/02/image02.jpg&w=300&h=150](http://www.arjanbaagh.com/testsite/wp-content/themes/photoartist-parent/framework/timthumb/timthumb.php?src=http://www.arjanbaagh.com/testsite/wp-content/uploads/2012/02/image02.jpg&w=300&h=150)

我要做的就是更改`$output`字符串，使其在 image02.jpg 之前包含另一个文件夹。例如，我想将 URL 更改为：

[http://www.arjanbaagh.com/testsite/wp-content/themes/photoartist-parent/framework/timthumb/timthumb.php?src=http://www.arjanbaagh.com/testsite/wp-content/uploads/ 2012/02/](http://www.arjanbaagh.com/testsite/wp-content/themes/photoartist-parent/framework/timthumb/timthumb.php?src=http://www.arjanbaagh.com/testsite/wp-content/uploads/2012/02/)新文件夹**/image02.jpg&w=300&h=150**

我尝试修改 $output 字符串中的目录，但我只能更改字符串的开头或结尾。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:30:13.677

在现有`$output`字符串下方添加：

```
/* Set the $output URL to a variable */    
$url = explode('/', $output);

/* Grab the last segment of the URL (image name and parameters) */
$lastSegment = end($url); // image02.jpg&w=300&h=150

/* Grab the first part of the entire original $output URL before the image string */
$partialUrl = explode($lastSegment, $output); // gets first part of url before image02.jpg&w=300&h=150

/* Grab the first returned value from $partialUrl, which is the string before the image name */
$firstHalf = $partialUrl[0]; // http://www.arjanbaagh.com/testsite/wp-content/themes/photoartist-parent/framework/timthumb/timthumb.php?src=http://www.arjanbaagh.com/testsite/wp-content/uploads/2012/02/

/* Add your directory */
$stringToAdd = 'newfolder/';

/* Final $output with your new directory in place */
$output = $firstHalf.$stringToAdd.$lastSegment 
```

# sublimetext2 - Sublime Text 2 - 查找和替换：“区分大小写”与“保留大小写”？

> ID：15531625
> 
> 赞同：7
> 
> 时间：2013-03-20T18:16:45.950
> 
> 标签：sublimetext2

在“查找/替换”对话框中，“区分大小写”和“保留大小写”选项有什么区别？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-20T23:26:42.810

**区分大小写**选项确定将匹配的内容。**保留大小写**选项确定在用替换字符串替换匹配文本时是否保留匹配文本的大小写。

这是一个应该说明这一点的例子。想象一下你有这个：

```
word
Word 
```

如果未选择**区分大小写**并且您查找`word`，则将选择两行中的文本。如果选中，则仅`word`匹配第一个小写字母。

假设我们使用`tapioca`作为替换字符串。如果未选择**保留大小写（并且也不****区分大小写**），则全部替换将为您提供以下结果：

```
tapioca
tapioca 
```

启用Preserve **case**后，它将变为：

```
tapioca
Tapioca 
```

即，第二种`Word`情况将被保留并“应用于”替换字符串。

# iphone - 我的 view.hidden 在 iphone 4 中不起作用

> ID：15531630
> 
> 赞同：-2
> 
> 时间：2013-03-20T18:17:02.227
> 
> 标签：iphone, ios

我`view.hidden`在 iphone 4 中不工作，但在 Iphone 4S 中没问题。我在我的代码中使用 IOS 6.1.3 在两个设备上进行了尝试我有 2 个视图一个在另一个顶部，当第一个视图打开时，另一个视图具有隐藏属性是 YES，因为当我激活第一个视图的按钮时，更改隐藏的属性第二个视图，但第二个视图没有出现，并且按下按钮事件成功

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:25:32.277

如果第一个视图遮挡了第二个视图，则无论 hidden = YES 还是 NO，都不会出现第二个视图。

从情节提要或 xib 检查您的视图层次结构。

# java - Java：如何在文件中搜索关键字？

> ID：15531634
> 
> 赞同：1
> 
> 时间：2013-03-20T18:17:17.827
> 
> 标签：java

我正在尝试编写一个函数，该函数采用关键字并搜索文件列表，然后打印出任何包含该关键字的文件。

到目前为止，我只有一个文件列表和关键字。

```
File[] files = new File("<directory>").listFiles();
Scanner keyword = new Scanner("hello"); 
```

我想现在我需要构建某种形式的循环来遍历文件以查找关键字。任何帮助，即使是易于理解的教程，我们都将不胜感激。

编辑：

这些文件是仅包含一行的文本文件

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:25:40.550

```
File dir = new File("directory"); // directory = target directory.
if(dir.exists()) // Directory exists then proceed.
{ 
  Pattern p = Pattern.compile("keyword"); // keyword = keyword to search in files.
  ArrayList<String> list = new ArrayList<String>(); // list of files.

  for(File f : dir.listFiles())
  {
    if(!f.isFile()) continue;
    try
    {
      FileInputStream fis = new FileInputStream(f);
      byte[] data = new byte[fis.available()];
      fis.read(data);
      String text = new String(data);
      Matcher m = p.matcher(text);
      if(m.find())
      {
        list.add(f.getName()); // add file to found-keyword list.
      }
      fis.close();
    } 
    catch(Exception e)
    {
      System.out.print("\n\t Error processing file : "+f.getName());
    }

  }
  System.out.print("\n\t List : "+list); // list of files containing keyword.
} // IF directory exists then only process.
else
{
  System.out.print("\n Directory doesn't exist.");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T19:01:52.037

如果你想使用扫描器类，这里是你如何扫描一个特定关键字的文件：扫描器只不过是一个迭代器，它扫描提供给它的输入。

```
Scanner s = new Scanner(new File("abc.txt"));
while(s.hasNextLine()){
    //read the file line by line
String nextLine = s.nextLine();
            //check if the next line contains the key word
    if(nextLine.contains("keyword"))
    {
              //whatever you want to do when the keyword is found in the file
               and break after the first occurance is found
             break;
    }
} 
```

# video - HTML 线框/模型的占位符视频

> ID：15531635
> 
> 赞同：2
> 
> 时间：2013-03-20T18:17:21.183
> 
> 标签：video, wireframe, mockups

是否有任何网站托管可用于 HTML 模型的占位符视频？有一些图像（例如[LoremPixum](http://lorempixel.com/)），但我找不到任何视频。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:42:05.937

为此，我认为只需一个简单的 5 秒 .mp4 或 .webm（或两者）视频就可以了。或者您是否需要一个显示“Lorem ipsum”的视频？:-)

# php - ajax调用后如何使用javascript刷新我页面的Div部分

> ID：15531638
> 
> 赞同：0
> 
> 时间：2013-03-20T18:17:26.853
> 
> 标签：php, javascript, ajax

我正在使用 Ajax 提交表单并将数据存储在数据库中。它将数据存储在数据库中，并且无需重新加载页面，它就会发出警告框，显示该内容已被添加。同一页面显示数据库的内容，我需要该部分自动刷新而不重新加载页面，以便它也可以获取刚刚添加的信息。

```
<script type="text/javascript">
function GetXmlHttpObject()
{
    if(window.XMLHttpRequest)
    {
        return new XMLHttpRequest();

    }
    if(window.ActiveXobject)
    {
        return new ActiveXObject("Microsoft.XMLHTTP");
    }
    return null;

}
function submitformwithajax()
{
    var myAjaxPostrequest=new GetXmlHttpObject();

    var coursename=document.getElementsByName('cvalue')[0].value;

    var parameter="cvalue="+coursename;

    myAjaxPostrequest.open("POST", "process/do_course.php", true);
    myAjaxPostrequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    myAjaxPostrequest.send(parameter);
    myAjaxPostrequest.onreadystatechange=function(){
        if(myAjaxPostrequest.readyState==4){
            if(myAjaxPostrequest.status==200){

                if(myAjaxPostrequest.responseText=="true")
                {
                alert("Course Has Been Successfully Added To The Curiculum !");
                 var container = document.getElementById('c');
                var refreshContent = container.innerHTML;
                container.innerHTML = refreshContent;
                }

            }
            else
            document.getElementById("submitcourse").innerHTML="An error has occured making the request";

        }
    }
}
</script> 
```

'c' 是必须重新加载的 div 标签的 ID。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:32:58.953

jQuery would benefit your work a lot, your current code via jQuery would look like

```
function submitformwithajax() {
    var coursename = $("[name=cvalue]").val();

    $.post("process/do_course.php", {cvalue: coursename}, function(response) {
        if (response === "true")
        {
            alert("Course Has Been Successfully Added To The Curiculum !");
            var container = $("#c");
            // Not sure why you're setting the container to the container here    
            container.html(container.html());
        }
        else
            $("#submitcourse").text("An error has occured making the request");
    }, "text");
} 
```

I don't know why you set the text of the container to the text in the container but that may be an issue you are having. If your server response returns the data that needs to be displayed in th area you can use jQuery (or if you really prefer, the DOM) to update the fields or elements (or add as needed) on the fly. If you need to refresh that section based off a GET request, then just make a GET request for the data in the success statement.

I would also recommend using JSON for the return type from the server instead of plain text. A `{"success": true}` will allow you to check `if (response.success)` instead of using string comparison there.

Also, as a final side note, in Javascript you should **always** prefer `===` over `==` as `===` verifies that value and type both match, the downside to this is that in Javascript `1 == "1"` but `1 === "1"` is not true.

**EDIT**

In response to your comment, should you not persue the jQuery route, you can still implement all of that which I have explained here however you'll have to manually parse the response:

```
var resposne = JSON.parse(myAjaxPostRequest.responseText); 
```

From there you can still check `if (response.success)`.

I, personally, recommend showing the students how to do it this long and complex way, and then teaching them how to do it with jQuery. Should any of them pursue a web development career then they will either use jQuery or something very similar in function to it and it's best they learn about these things early on instead of after they get hired. I also suggest JSON returns from the server because it's a more expressive way to return data, instead of just `"true"` (what is true?) you say `{"success": true}` so you can see the request was successful.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:28:48.923

这似乎有点废话：

```
var refreshContent = container.innerHTML;
container.innerHTML = refreshContent; 
```

这样你不刷新，内容完全一样。

我不知道您所说的“数据库内容”到底是什么意思，假设 coursename 是您要添加到 DIV 的内容，那么您必须执行以下操作：

```
container.innerHTML += '<p>'+ coursename +'</p>'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T18:45:16.590

看到您的代码后：您没有用 AJAX 填充该表。我只能给你这个建议。使用 Javascript 动态填充该表。

1.  创建将找到的函数`div#c`。
2.  如果`div#c`有一些孩子，摧毁他们。
3.  创建一个新的元素表。
4.  用新行填充该表。

这就是您可以使用 Ajax 提供的服务器中的数据动态创建表的方法。因此，在从表单发送数据后，您可以调用此函数，您的表将被重新创建。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T18:27:44.467

最简单的方法是从 ajax 调用返回“c”元素的内容，然后用 ajax 调用返回的内容替换“c”的旧内容。

# c# - 如何让 ModelState 在 asp.net mvc web api 上工作？

> ID：15531641
> 
> 赞同：3
> 
> 时间：2013-03-20T18:17:33.513
> 
> 标签：c#, asp.net-mvc, rest, asp.net-web-api, modelstate

这是我第一次使用 asp.net mvc webApi，我有 Post/Put 方法，其中有一个名为 ProductViewModel 的参数。`Required`此 ViewModel 的某些属性具有要验证的数据注释，例如`StringLenght`等...我有这样的 post 方法：

```
public HttpResponseMessage Post([FromBody] ProductViewModel value)
{
   if (ModelState.IsValid)
   {
      // persist data here...

      return Request.CreateResponse(HttpStatusCode.OK);
   }

   return Request.CreateResponse(HttpStatusCode.BadRequest, ModelState.GetErrors());
} 
```

我有`GetErrors()`方法作为扩展来获取`List<>`我的错误并传递给客户端。我的问题是：为什么 ModelState 不起作用？

如果我将 null 传递给我的 ViewModel 的属性，则此验证根本不起作用。 `IsValid`属性总是`true`. 有没有办法解决这个问题并让 ModelState 工作，比如 MVC ？

我的模型如下所示：

```
public class ProductViewModel
{
    [Display(ResourceType = typeof(Resources.Global), Name = "Name")]
    [Required(ErrorMessageResourceType = typeof(Resources.Global), ErrorMessageResourceName = "Required")]
    [StringLength(100, ErrorMessageResourceType = typeof(Resources.Global), ErrorMessageResourceName = "Range")]
    public string Name { get; set; }

    [Display(ResourceType = typeof(Resources.Global), Name = "ShortName")]
    [Required(ErrorMessageResourceType = typeof(Resources.Global), ErrorMessageResourceName = "Required")]
    [StringLength(20, ErrorMessageResourceType = typeof(Resources.Global), ErrorMessageResourceName = "Range")]
    public string ShortName { get; set; }
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:07:00.907

您能否确保将 Content-Type 作为请求的一部分传递？（如果没有传递 content-type，则为特定类型设置默认值，并且模型状态不会有错误......这个错误最近已修复）。

此外，您可以执行以下操作：

```
return Request.CreateErrorResponse(HttpStatusCode.BadRequest, this.ModelState) 
```

# html - phonegap 自动返回上一页

> ID：15531649
> 
> 赞同：0
> 
> 时间：2013-03-20T18:17:54.353
> 
> 标签：html, cordova

我正在使用 phonegap 编写应用程序。我使用 jquery 框架将不同的页面组合成一个页面。当我打开应用程序并填写表格时出现问题，显示下一页。但它很快返回到索引页面。然后我再次填写表格。问题不再出现。如何解决退货问题？

```
<input type="submit" onclick="location.href = '#page1'" value="Submit" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:32:38.123

您应该使用`$.mobile.changePage('#page1');`jquery 移动框架

如文档中所述：

> 以编程方式从一页更改为另一页。当启用这些功能时，此方法在内部用于由于单击链接或提交表单而发生的页面加载和转换。

[http://jquerymobile.com/demos/1.2.1/docs/api/methods.html](http://jquerymobile.com/demos/1.2.1/docs/api/methods.html)

# r - 将“get”应用于向量中的所有元素 - 或 - 使用 r 中的顺序变量

> ID：15531650
> 
> 赞同：2
> 
> 时间：2013-03-20T18:17:56.397
> 
> 标签：r

我有六个矩阵：m1、m2、m3、m4、m5 和 m6。为了一个简单的例子，假设它们看起来像这样：

```
m1<- matrix(1:10, 2, 5)
m2<- matrix(11:20, 2, 5)
m3<- matrix(21:30, 2, 5)
m4<- matrix(31:40, 2, 5)
m5<- matrix(41:50, 2, 5)
m6<- matrix(51:60, 2, 5) 
```

最终，我想将一个函数应用于所有 6 个：

```
f(m1,m2,m3,m4,m5,m6) 
```

因为每次运行脚本时矩阵的数量都会有所不同，所以我正在寻找一种以编程方式执行此操作的方法。我的第一个方法是执行以下功能：

```
paste("m",1:6,sep="") 
```

上面的表达式返回一个字符串：

```
[1] "m1" "m2" "m3" "m4" "m5" "m6" 
```

为了找到值，而不是矩阵的名称，我尝试通过以下函数将“get”添加到组合中：

```
get(paste("m",1:6,sep="")) 
```

但是“get”表达式只返回了 m1 的值，而忽略了我想要的所有其他内容。所以，我开始搞乱 for 循环：

```
for(k in 1:6){
if(k == 1){b<- paste("m",k,sep="")}
else{b<- c(b, paste("m",k,sep=""))}
}

> b
[1] "m1" "m2" "m3" "m4" "m5" "m6" 
```

这是我第一次尝试时得到的相同字符串。因此，以下表达式失败：

```
w<- f(b) 
```

我也试过：

```
w<- f(get(b)) 
```

可以预见的是，R 将 m1 识别为矩阵，但忽略了 B 中的其余项。

我也试过：

```
w<- f(get(b[1:6])) 
```

当我这样做时，我得到与上面相同的结果。

最后，我还尝试将 b 变成一个列表：

```
b<- list(m1,m2,m3,m4,m5,m6) 
```

我曾希望使用 lapply(b, g)，但是该函数（我没有编写并且有义务使用）在放入 lapply 时无法正常工作。

关于如何完成这个看似简单的任务的任何其他想法？我对 R 还比较陌生，所以很可能有一种我不知道的众所周知的方法，但是我在搜索现有文档时一无所获，而且我觉得需要帮助来解决问题是愚蠢的这个小。为论坛的帮助干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:23:33.823

您可能会以错误的方式解决此问题。将您的矩阵放入列表中，然后`lapply`将您的函数放入.`f``list`

```
m1<- matrix(1:10, 2, 5)
m2<- matrix(11:20, 2, 5)
m3<- matrix(21:30, 2, 5)
m4<- matrix(31:40, 2, 5)
m5<- matrix(41:50, 2, 5)
m6<- matrix(51:60, 2, 5)

f<-function(x) sum(x) # A test function
l<-list(m1,m2,m3,m4,m5,m6)
lapply(l,f) 
```

你可能会说这很好，但是当我有数千个矩阵时会发生什么？如何创建该列表？大多数情况下，您可以生成您的`matrices`, 或从头开始将它们读入列表。以下是如何将它们生成为列表：

```
start<-seq(1,51,by=10)
gen<-function(x) matrix(x:(x+9),2,5)
l<-lapply(start,gen) 
```

通常，如果您开始考虑迭代变量名称，那么您做错了。根据我的经验，在大多数编程语言中都是如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T18:46:34.543

将您的矩阵存储在列表中`l = list(m1,m2,m3,m4,m5,m6)`，然后使用`do.call(f, l)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T18:23:07.027

尝试

```
m1 <- matrix(1:4, ncol=2) # some dummy matrices
m2 <- m1*2
m3 <- m2+2
m4 <- m1*3

b <- paste0('m', 1:4)
b

for(i in 1:length(b)) {
 print( get(b[i]) )
  } 
```

或使用`lapply`

```
lapply(b, get) 
```

# django - 使用 Chef 运行 Django syncdb 和迁移

> ID：15531654
> 
> 赞同：0
> 
> 时间：2013-03-20T18:18:13.053
> 
> 标签：django, deployment, chef-infra, fabric

我们正朝着使用 Chef 部署 Django 应用程序的方向发展。我的一个问题是处理以下命令的最佳方法是什么：

```
./manage.py syncdb
./manage.py migrate --noinput
./manage.py collectstatic --noinput 
```

我正在使用[应用程序](https://github.com/opscode-cookbooks/application)说明书。我们通常使用 Fabric 脚本处理这些问题，如果可能的话，我想继续使用 Fabric。有没有关于如何处理这个问题的最佳实践？使用回调，例如`before_restart`执行 Fabric 命令来同步数据库、迁移和收集静态？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:26:51.000

这[本食谱](http://github.com/opscode-cookbooks/application_python)包含一个名为`migration_command`

# c# - 应用设置、用户设置、机器设置

> ID：15531655
> 
> 赞同：0
> 
> 时间：2013-03-20T18:18:13.617
> 
> 标签：c#, configuration, permissions, settings

时不时地，我遇到为 a) 应用程序的用户和 b) 应用程序本身提供配置的问题。

.Net 有自己的设置框架，其中配置基于 XML 存储在`app.settings`文件中（`user.settings`分别）。

说到`user.setting`s，一切都很好。对于使用我的应用程序的每个用户，都会`user.settings`创建自己的应用程序。用户有权在不影响应用程序设置或其他用户配置的情况下更改自己的设置。

但

一般应用程序设置 app.settings 存储在程序集文件夹中，主要是`C:\Program Files\\...`在安装应用程序时。因此，普通用户在没有管理员权限的情况下无法更改任何设置。

还...

有时我不希望设置绑定到特定的应用程序或用户，而是绑定到应用程序当前运行的计算机。就像我不想让计算机的每个用户自己激活应用程序的许可证文件一样。

在 XP 中，有`C:\ProgramData`用于机器设置的隐藏文件夹，但现在在 Windows 7/8 中，似乎常规安装程序在其中创建的每个文件夹都只能在管理员权限下写入。

毕竟如何解决这个荒谬的权限问题？有没有办法让普通用户更改 app.settings，并让每个用户的全局设置与 app.settings 分开，比如 machine.settings？

# html - 导航链接不会变回原始颜色

> ID：15531656
> 
> 赞同：0
> 
> 时间：2013-03-20T18:18:15.003
> 
> 标签：html, css, hyperlink

每当我点击一个链接时，它应该变成绿色，表明你在那个页面上，所有其他链接都应该是蓝色的，直到选择了一个新链接，然后你点击的任何链接都应该是绿色的，而你刚刚的链接at 应该变成蓝色，但到目前为止，即使在选择新页面后，所有链接都将保持绿色。

这是我的 CSS 页面：

```
body{
background-color:#ffffcc;
color:#003300;
font-family:arial,helvetica,sans-serif;
background:url(images/primehorizontal.png);
}
h2{
color:#003366;
}
h3{
color:#006600;
padding-top:10px;
}
dd{
font-style:italic;
font-size:.90em;
line-height:200%;
}
#header{
color:#48751A;
}
.nav{
font-weight:bold;
font-size:1.2em;
}
.contact{
font-weight:bold;
font-size:.90em;
font-family:"Times New Roman",helvetica,serif;
}
#footer{
font-size:.60em;
font-style:italic;
clear:both;
}
#wrapper{
width:80%;
margin-right:auto;
margin-left:auto;
background-color:#ffffcc;
min-width:700px;
padding:0px 0px 20px 30px;
border:1px ridge #00332B;
border-radius:15px;
-webkit-box-shadow: inset -3px -3px 3px 3px #00332B;
-moz-box-shadow: inset -3px -3px 3px 3px #00332B;
box-shadow: inset -3px -3px 3px 3px #00332B;
}
img{
border-style:none;
}
#left{
float:left;
width:150px;
}
#right{
margin-left:180px;
padding: 0 20px 20px 0;
}
#left ul{
list-style-type: none;
margin: 0;
padding-left: 0;
}
#left a{ 
text-decoration: none;
display: block;
text-align: center;
color: #FFFFCC;
border: 3px outset #CCCCCC;
padding: 5px;
}

#left a:visited { background-color: #48751A; }
#left a:link { background-color: #003366; }
#left a:hover { border:3px inset #333333; }

.floatleft{
float:left;
padding:0 20px 20px 0;
}
.clear{
clear:left;
} 
```

这是我的索引页：

```
<!DOCTYPE html>
<html lang="en">

<head>

<title> Prime Properties</title>

<meta charset="utf-8">

<link rel="stylesheet" href="prime.css">

</head>

<body> 

<div id="wrapper">

<h1 id="header"><img src="images/primelogo.gif" alt="prime logo" height="100" width="650"></h1>

<div id="left">

<ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="listings.html">Listings</a></li>
    <li><a href="financing.html">Financing</a></li>
    <li><a href="contact.html">Contact</a></li>
</ul>

</div>

<div id="right">

<p>Prime Properties is prepared to market and sell your property.</p>
<p>The philosophy of Prime Properties is to promote our clients, not ourselves.</p>
<p>We can also help you find the property that meets your needs:</p>

<ul>
    <li>location</li>
    <li>price</li>
    <li>features</li>
</ul> 

<br>

<div class="contact">Prime Properties<br>
3055 Bode Road<br>
Schaumburg, IL 60194<br>
<br>
847-555-5555<br>

<br>

</div>

<div id="footer">

<div class="nav">

<a href="index.html">Home</a>&nbsp;&nbsp;
<a href="listings.html">Listings</a>&nbsp;&nbsp;
<a href="financing.html">Financing</a>&nbsp;&nbsp;
<a href="contact.html">Contact</a>

</div>

Copyright &copy; 2013 Prime Properties

<br>

<a href="mailto:joshua392141@aol.com">joshua392141@aol.com</a>
</div>
</div>
</div>
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T19:15:08.103

首先，完全忘记使用`:visited`。它没有做你认为它应该做的事情。

您可能需要编辑每个页面并为当前链接添加一个选择器。例如，`index.html`看起来像：

```
<a class="current" href="index.html">Home</a>&nbsp;&nbsp;
<a href="listings.html">Listings</a>&nbsp;&nbsp;
<a href="financing.html">Financing</a>&nbsp;&nbsp;
<a href="contact.html">Contact</a> 
```

`Listings.html`看起来像：

```
<a href="index.html">Home</a>&nbsp;&nbsp;
<a class="current" href="listings.html">Listings</a>&nbsp;&nbsp;
<a href="financing.html">Financing</a>&nbsp;&nbsp;
<a href="contact.html">Contact</a> 
```

然后，在您的 CSS 中，您将拥有：

```
a.current { color: green; } 
```

这也可以使用 PHP 或 ASP.NET 等服务器端语言来完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:51:40.670

```
#left a:visited { background-color: #48751A; } 
```

这会使您访问过的链接变为绿色。当您再次关闭该站点时，它仍然在您的浏览器历史记录中，这使得该链接仍然显示为绿色。

如果您希望在关闭页面后颜色再次变回蓝色，您将不得不使用 javascript/jQuery。我不认为你可以单独使用 css/html 来做到这一点。

# jquery - jQuery / CSS 导航，无法让“fnutt”居中

> ID：15531663
> 
> 赞同：0
> 
> 时间：2013-03-20T18:18:40.333
> 
> 标签：jquery, css

我无法解决这个小小的 CSS/jQuery 问题。

我希望菜单下的“fnutt”位于每个菜单的中心，`<li></li>` 我想如果你看看我的 jsfiddle，你就会明白我的意思。

[http://jsfiddle.net/pJjRg/](http://jsfiddle.net/pJjRg/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:40:59.433

您需要进行以下更改：

```
#menu ul li  { 
    position: relative;
    ...
}

.triangle {
    ...
    position:absolute; 
    bottom:-7px; 
    left:50%; 
    margin-left: -8px
} 
```

通过设置`position: relative`父`li`元素，绝对定位`.triangles`现在相对于`li`s 定位。然后只需用`bottom` `left`和定位它们即可`margin`。

[http://jsfiddle.net/pJjRg/21/](http://jsfiddle.net/pJjRg/21/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:27:19.247

您需要更改三角形的位置，因为它因每个菜单项而异。你的 JS 代码没问题。

# java - Java：读取包含文本和二进制数据的文件

> ID：15531664
> 
> 赞同：0
> 
> 时间：2013-03-20T18:18:45.210
> 
> 标签：java, file-io, binary-data

我被要求在工作中实施的新文件格式有问题。

基本上，该文件是一个文本文件，其中包含一堆包含有关 UTC-8 数据信息的标题，然后文件的其余部分是二进制的数字数据。我可以很好地写入数据并将其读回，并且我最近添加了代码来编写标题。问题是我不知道如何读取包含文本和二进制数据的文件。我希望能够读入并处理标头信息（相当广泛），然后能够继续读取二进制数据而无需重新遍历标头。这可能吗？

我目前正在使用 a`FileInputStream`来读取二进制数据，但我不知道如何在数据的开头而不是整个文件的开头开始它。其中一个`FileInputStream`构造函数将 a`FileDescriptor`作为参数，我认为这是我的答案，但我不知道如何从另一个文件读取类中获取一个。我正确地接近这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:24:56.877

您可以通过获取其[通道](http://docs.oracle.com/javase/6/docs/api/javax/imageio/stream/FileCacheImageOutputStream.html)并调用该通道来将 a 重新定位`FileInputStream`到任意点。`getChannel()``position()`

需要注意的是，这个位置会影响流的*所有*消费者。如果您有不同的线程（例如）从同一文件的不同部分读取，则不适合。`FileInputStream`在这种情况下，为每个消费者创建一个单独的。

此外，此技术仅适用于*文件*流，因为可以随机访问底层文件。*套接字、命名管道或其他任何实际上是流*的东西都没有等价物。

# webdriver - 我的代码没有在 webdriver 中运行

> ID：15531666
> 
> 赞同：0
> 
> 时间：2013-03-20T18:18:55.427
> 
> 标签：webdriver

我正在运行一个简单的代码来在 Firefox 浏览器中打开 google.co.uk，但是在 eclipse 中运行代码之后，它只会打开浏览器并停在那里。请帮忙。这是代码-

```
package basic_webdriver;

import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.firefox.FirefoxDriver;

public class Driver_Test {

    public static void main(String[] args) {

        WebDriver driver=new FirefoxDriver();
            driver.get("https://www.google.co.uk/");
                System.out.println(driver.getTitle());
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-01T14:50:41.330

尝试

```
 driver.Navigate().GoToUrl("https://www.google.co.uk/"); 
```

Navigate 函数告诉浏览器导航到某个地方。GoToURL 函数指示浏览器应该导航到特定的 URL。URL 的字符串作为 GoToURL 的参数输入。

以上应该使浏览器导航到特定的 URL。

# android - 如果我使用 Android 4.2.2 API 17 开发我的应用程序，它可以在最旧的版本中运行吗？

> ID：15531669
> 
> 赞同：1
> 
> 时间：2013-03-20T18:19:13.907
> 
> 标签：android

如果我使用 Android 4.2.2 API 17 开发我的应用程序，它可以在最旧的版本中运行，比如运行 android 4.0 的平板电脑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:21:19.140

> 如果我使用 Android 4.2.2 API 17 开发我的应用程序，它可以在最旧的版本中运行

如果您指定 in `Androidmanifest.xml`min 和 target Sdk 版本，则可以在该范围内安装它。

```
<uses-sdk android:minSdkVersion="8" android:targetSdkVersion="17" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:22:22.747

是的，如果您包含以下内容，它将向后兼容旧版本的 Android：

```
"In your AndroidManifest.xml file declare the following (replacing the platform versions      with whatever your app requires):

<!-- Build Target -->
<uses-sdk android:targetSdkVersion="14" android:minSdkVersion="7" />" 
```

[在这里](https://stackoverflow.com/questions/9558638/how-to-code-backward-compatible-new-feature-in-android-sdk)查看答案

# binding - knockout.js 递归绑定

> ID：15531670
> 
> 赞同：5
> 
> 时间：2013-03-20T18:19:13.977
> 
> 标签：binding, knockout.js

我正在尝试用淘汰赛做一些复杂的绑定（至少对于像我这样的新手来说）。

考虑以下数据：

```
var originalData = {
id: 1,
name: "Main",
children: [ { id: 2, name: "bob", children: []}, { id: 3, name: "ted", children: [{id: 5, name:"albert"}, {id: 9, name: "fred"}]} ],
selectedChild:  { id: 2, name: "bob" }
};

<table>
<tr>
    <td data-bind="text: name"></td>
</tr>
<tr data-bind="if: children().length > 0">
    <td>
        <select data-bind="options: children,
            optionsText: function(item){
                return item.name;
                    }, 
            optionsCaption: 'Choose...'"></select>       
    </td>
</tr> 
```

好的，这是最简单的部分。

困难的部分是，每当在列表中选择一个项目时，如果该项目有子项，则下方应出现一个新的选择框。它的数据源将是第一个选择框中所选项目的子项。当然，它可以以任何深度继续下去。

我应该如何通过淘汰赛解决这个问题？

我已经汇总了迄今为止在 jsfiddle 上的示例：http: [//jsfiddle.net/graphicsxp/qXZjM/](http://jsfiddle.net/graphicsxp/qXZjM/)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T20:10:35.623

您可以通过将模板放入`script`标签中来在淘汰赛中使用递归模板。标签中的模板`script`可以引用自己，如下所示：

```
<div data-bind="template: 'personTemplate'"></div>

<script type="text/ko" id="personTemplate">
    <span data-bind="text: name"></span>
    <select data-bind="options: children, optionsText: 'name', optionsCaption: 'Choose',  value: selectedChild"></select>
    <!-- ko if: selectedChild -->
    <div data-bind="template: { name: 'personTemplate', data: selectedChild }"></div>
    <!-- /ko -->
</script> 
```

**这是[小提琴](http://jsfiddle.net/tyrsius/xaBaH/1/)**

* * *

更新：

您可以使用 a`computed`轻松执行此操作，并从视图中删除逻辑（我认为在这种情况下更好），然后将其绑定`if`到它。

```
self.showChildren = ko.computed(function() {
    return self.selectedChild()
        && self.selectedChild().children().length > 0;
}); 
```

如果你想把两者都放在`if`块中，你可以，你只需要包括括号。原因是 observables 是函数。如果您只使用单个引用，则敲除允许您排除它们，但它们需要“深入”到它们的属性。

```
if: selectedChild() && selectedChild().children().length > 0 
```

这是[更新的小提琴](http://jsfiddle.net/tyrsius/xaBaH/2/)

# excel - 图表或 Excel 中的时间戳列表

> ID：15531673
> 
> 赞同：6
> 
> 时间：2013-03-20T18:19:23.103
> 
> 标签：excel

我有一个程序可以在调用进程时将当前时间写入 excel，因此我有一个 excel 文件，其中一列包含 HH(24):MM:SS 格式的超过 5000 个时间戳。我试图在 24 小时内将这些可视化，以便找到该过程最不可能发生的时间。任何人都可以让我开始吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T02:23:27.047

只需选择列中的数据，然后插入 > 图表 - 散点图，只有标记的散点图可能适合。标记彼此越接近（或斜率越浅）应该表明该过程在很短的时间间隔内经常被调用。即较安静的时期是斜坡陡峭的时候。

如果不是一个非常有用的可视化，那么可以计算固定长度间隔的开始次数（创建“箱”）并绘制直方图。“该过程最不可能发生的时间”意味着不仅开始时间而且持续时间可能是相关的。在这种情况下，大约平均持续时间的间隔可能是有用的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-08T13:59:37.783

如果您以 Excel 可以理解的格式为 Excel 提供一列时间戳，它可以将它们映射到一个分数，该分数表示该时间戳距离当天有多远。例如，如果您粘贴“12:00:00”，然后将该单元格格式化为数字，您将得到 0.5。同样从 06:00:00 到 0.25 等。然后可以按照[以下步骤](http://support.microsoft.com/kb/214269 "这些步骤")将这些数字绘制在直方图上。

警告：仅确认这在 Excel 2013 中有效。

# data-warehouse - 书的上下文层次

> ID：15531674
> 
> 赞同：2
> 
> 时间：2013-03-20T18:19:29.140
> 
> 标签：data-warehouse, olap

我有书店的书籍尺寸和`ISBN, title, author, publication year, publisher company`属性。对于时间，很容易看到层次结构，但对于书籍维度，我无法构建层次结构。书籍维度的上下文层次结构是什么？你能帮我吗，因为我对如何构建它有点困惑？

编辑：例如，时间

```
 date < week of the day < month < year
           date < week of the day < year

 as an example, for calendar

           Calendar Year > Calendar Quarter > Calendar Month > Day 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:59:45.790

并非每个维度都需要有层次结构。日期确实有一个明显的自然层次结构（例如世纪-年-月-日），但没有理由书籍“必须”有一个。

如果存在层次结构，它将基于对报表用户有用且在源数据中可用的任何信息。对于图书馆员来说，[杜威十进制](http://en.wikipedia.org/wiki/Dewey_Decimal_Classification)或[国会图书馆](http://en.wikipedia.org/wiki/Library_of_Congress_Classification)分类可能是很好的层次结构，但对于书店来说，它们可能完全无关紧要。

您需要从您的用户那里了解他们希望如何深入了解书籍详细信息并相应地对维度进行建模。也许您的公司已经有一个内部分类系统，或者可能根本没有层次结构，只是在报告中使用的一组属性。

在这里征求意见不太可能有帮助，因为我可以说`Author->PublicationYear->Book`，但你的用户可能会说`Author->Book`或`PublicationYear->Publisher->Author->Book`完全不同的东西。

# wpf - WPF datagrid下拉双向绑定

> ID：15531675
> 
> 赞同：1
> 
> 时间：2013-03-20T18:19:31.370
> 
> 标签：wpf, wpfdatagrid

我试图让 WPF 数据网格（托管在从名为 ControlBase 的基类派生的用户控件中）中的下拉列正确绑定。它最初从对象中很好地填充，当我编辑单元格时会出现一个填充的下拉列表，但是当我离开焦点时，选定的值不会返回到单元格中。

这是我的模型和域对象：

```
 public class ModelBase : INotifyPropertyChanged
 {
   public IList<Person> Persons { get; set; }
 }

 public class UserControlModel : ModelBase
 {
    public ObservableCollection<DatagridRecord> SourceData { get; set; }
 }

 public class Person
 {
   public int Id { get; set; }
   public string Name { get; set; }
 }

 public class DatagridRecord
 {
   public string Name { get; set; }
   public Person ContactPerson { get; set; }
 } 
```

在我的 xaml.cs 中，我通过 Model 属性设置 DataContext：

```
 public UserControlModel _model;
 public UserControlModel Model
 {
  set
  {
    _model = value;
    DataContext = null;
    DataContext = _model;
  }
} 
```

这是我在 xaml 中的 DataGrid 列定义：

```
<DataGridTemplateColumn Header="Person" >
     <DataGridTemplateColumn.CellTemplate>
      <DataTemplate>
        <TextBlock Text="{Binding Path=ContactPerson.Name}"/></DataTemplate>
      </DataGridTemplateColumn.CellTemplate>
      <DataGridTemplateColumn.CellEditingTemplate>
        <DataTemplate>
          <ComboBox ItemsSource="{Binding Path=DataContext.Persons, 
                       RelativeSource={RelativeSource AncestorType={x:Type uch:ControlBase}}}" 
                       DisplayMemberPath="Name" 
                       SelectedValuePath="Id" />
        </DataTemplate>
   </DataGridTemplateColumn.CellEditingTemplate>
 </DataGridTemplateColumn> 
```

我认为将组合框选定值绑定到网格行有问题，但我绕着圈子试图将其连接起来。任何意见，将不胜感激。

科里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:22:39.170

您缺少一个`SelectedItem`或`SelectedValue`绑定：

```
<ComboBox ItemsSource="{Binding Path=DataContext.Persons, 
                       RelativeSource={RelativeSource AncestorType={x:Type uch:ControlBase}}}" 
                       DisplayMemberPath="Name" 
                   --> SelectedItem="{Binding ContactPerson}" <--
                       SelectedValuePath="Id" /> 
```

# mysql - 从 SQL DUMP 导入数据库模式

> ID：15531680
> 
> 赞同：2
> 
> 时间：2013-03-20T18:20:01.720
> 
> 标签：mysql, sql

我有以下具有一堆表和外键的数据库架构，当我尝试导入 sql 转储时，我不断收到以下错误。

```
Can't create table errno 150 
```

我知道它正在尝试创建具有尚未创建的表的依赖关系的表，但我不明白如何在不删除所有外键的情况下导入架构，然后根据 Stack 上给出的答案重新创建它们和谷歌。

必须有一个更简单的方法，大公司有数百张桌子做什么？

我有下面的 sql 语句，任何建议将不胜感激。谢谢

```
#
# Encoding: Unicode (UTF-8)
#

DROP TABLE IF EXISTS `contact_interest`;
DROP TABLE IF EXISTS `contact_seeking`;
DROP TABLE IF EXISTS `interests`;
DROP TABLE IF EXISTS `job_current`;
DROP TABLE IF EXISTS `job_desired`;
DROP TABLE IF EXISTS `job_listings`;
DROP TABLE IF EXISTS `my_contacts`;
DROP TABLE IF EXISTS `profession`;
DROP TABLE IF EXISTS `seeking`;
DROP TABLE IF EXISTS `status`;
DROP TABLE IF EXISTS `zip_code`;

CREATE TABLE `contact_interest` (
  `contact_id` int(10) unsigned NOT NULL,
  `interest_id` int(10) unsigned NOT NULL,
  KEY `mycontacts_contactinterest_fk` (`contact_id`),
  KEY `interests_contactinterest_fk` (`interest_id`),
  CONSTRAINT `mycontacts_contactinterest_fk` FOREIGN KEY (`contact_id`) REFERENCES `my_contacts` (`contact_id`),
  CONSTRAINT `interests_contactinterest_fk` FOREIGN KEY (`interest_id`) REFERENCES `interests` (`interest_id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE `contact_seeking` (
  `contact_id` int(10) unsigned NOT NULL,
  `seeking_id` int(10) unsigned NOT NULL,
  KEY `contactid_contactseeking_fk` (`contact_id`),
  KEY `seeking_contactseeking_fk` (`seeking_id`),
  CONSTRAINT `contactid_contactseeking_fk` FOREIGN KEY (`contact_id`) REFERENCES `my_contacts` (`contact_id`),
  CONSTRAINT `seeking_contactseeking_fk` FOREIGN KEY (`seeking_id`) REFERENCES `seeking` (`seeking_id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE `interests` (
  `interest_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `interest` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`interest_id`)
) ENGINE=InnoDB AUTO_INCREMENT=25 DEFAULT CHARSET=latin1;

CREATE TABLE `job_current` (
  `contact_id` int(10) unsigned NOT NULL,
  `title` varchar(20) DEFAULT NULL,
  `salary` decimal(8,2) DEFAULT NULL,
  `start_date` date DEFAULT NULL,
  KEY `mycontacts_jobcurrent_fk` (`contact_id`),
  CONSTRAINT `mycontacts_jobcurrent_fk` FOREIGN KEY (`contact_id`) REFERENCES `my_contacts` (`contact_id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE `job_desired` (
  `contact_id` int(10) unsigned NOT NULL,
  `title` varchar(20) DEFAULT NULL,
  `salary_low` decimal(8,2) DEFAULT NULL,
  `salary_high` decimal(8,2) DEFAULT NULL,
  `available` date DEFAULT NULL,
  `years_exp` int(11) DEFAULT NULL,
  KEY `mycontacts_jobdesired_fk` (`contact_id`),
  CONSTRAINT `mycontacts_jobdesired_fk` FOREIGN KEY (`contact_id`) REFERENCES `my_contacts` (`contact_id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE `job_listings` (
  `job_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `title` varchar(25) DEFAULT NULL,
  `salary` decimal(8,2) DEFAULT NULL,
  `zip_code` char(5) DEFAULT NULL,
  `description` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`job_id`)
) ENGINE=InnoDB AUTO_INCREMENT=9 DEFAULT CHARSET=latin1;

CREATE TABLE `my_contacts` (
  `contact_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `last_name` varchar(30) DEFAULT NULL,
  `first_name` varchar(20) DEFAULT NULL,
  `phone` char(10) DEFAULT NULL,
  `email` varchar(50) DEFAULT NULL,
  `gender` char(1) DEFAULT NULL,
  `birthday` date DEFAULT NULL,
  `prof_id` int(11) unsigned NOT NULL,
  `status_id` int(10) unsigned NOT NULL,
  `zip_code` char(5) DEFAULT NULL,
  PRIMARY KEY (`contact_id`),
  KEY `profession_mycontacts_fk` (`prof_id`),
  KEY `zipcode_mycontacts_fk` (`zip_code`),
  KEY `status_my_contacts_fk` (`status_id`),
  CONSTRAINT `profession_mycontacts_fk` FOREIGN KEY (`prof_id`) REFERENCES `profession` (`prof_id`),
  CONSTRAINT `status_my_contacts_fk` FOREIGN KEY (`status_id`) REFERENCES `status` (`status_id`),
  CONSTRAINT `zipcode_mycontacts_fk` FOREIGN KEY (`zip_code`) REFERENCES `zip_code` (`zip_code`)
) ENGINE=InnoDB AUTO_INCREMENT=17 DEFAULT CHARSET=latin1;

CREATE TABLE `profession` (
  `prof_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `profession` varchar(30) DEFAULT NULL,
  PRIMARY KEY (`prof_id`)
) ENGINE=InnoDB AUTO_INCREMENT=16 DEFAULT CHARSET=latin1;

CREATE TABLE `seeking` (
  `seeking_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `seeking` varchar(40) DEFAULT NULL,
  PRIMARY KEY (`seeking_id`)
) ENGINE=InnoDB AUTO_INCREMENT=17 DEFAULT CHARSET=latin1;

CREATE TABLE `status` (
  `status_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `status` varchar(30) DEFAULT NULL,
  PRIMARY KEY (`status_id`)
) ENGINE=InnoDB AUTO_INCREMENT=9 DEFAULT CHARSET=latin1;

CREATE TABLE `zip_code` (
  `zip_code` char(5) NOT NULL DEFAULT '',
  `city` varchar(20) DEFAULT NULL,
  `state` char(2) DEFAULT NULL,
  PRIMARY KEY (`zip_code`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:31:36.620

我发现我只需要两行来解决我的问题，我在顶部添加了一个 0，在底部添加了 1，我很好。很抱歉浪费您的时间...

```
SET FOREIGN_KEY_CHECKS = 0;

SET FOREIGN_KEY_CHECKS = 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:35:21.253

最简单的方法是通过这样的命令行来完成：

```
mysql db_name < backup-file.sql 
```

这将在一个事务中执行您的 sql 文件。如果您在一笔交易中执行您的东西，那么您将不会收到外键错误。

# jquery - jQuery UI 疯狂

> ID：15531683
> 
> 赞同：1
> 
> 时间：2013-03-20T18:20:09.793
> 
> 标签：jquery, jquery-ui

我肯定错过了一些简单的事情，因为我是一个相对的菜鸟。帮助表示赞赏！我试图从 JQuery UI 中得到任何东西来工作，但什么都不会。JQuery 和 JQuery UI 都加载没有错误。但我似乎无法成功使用任何 JQuery UI 方法。这是页面顶部的负载：

```
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js'></script>
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js'></script> 
```

这是一个 jsfiddle 作为示例，我只是想在 mouseenter 上切换一个类。 [http://jsfiddle.net/8WTaW/1/](http://jsfiddle.net/8WTaW/1/) 怎么了？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:23:48.120

您需要在代码中将“toggleclass”中的“c”大写。Javascript 是一种区分大小写的语言，因此正确的方法调用将是“toggleClass”：

```
$(function () {
    $('.navs').mouseenter(function () {
        $(this).toggleClass('navshover');
    });
}); 
```

[http://api.jquery.com/toggleClass/](http://api.jquery.com/toggleClass/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T18:21:57.780

大写“C”。

它是

```
$(this).toggleClass('navshover'); 
```

不是

```
$(this).toggleclass('navshover'); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/8WTaW/2/)**

（请注意，对于这个特定的示例，您不需要 jQueryUI。）

# drupal - 如何在drupal文件夹中找到特定页面

> ID：15531685
> 
> 赞同：0
> 
> 时间：2013-03-20T18:20:17.983
> 
> 标签：drupal

伙计们，位于drupal站点中的特定页面在哪里。我在 htdocs 中安装了 drupal。假设我想手动编辑一个页面，在哪里找到它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T06:12:30.880

正如 JarodMS 和 Tim 所提到的，Drupal 是一个内容管理系统。说它是一个数据库驱动的 CMS 会更合适。这意味着您的数据和配置将进入数据库（您在安装时提供）。

因此，假设您从 Drupal 的 UI 创建了一个页面，并且 URL 是
`http://localhost/drupalsite/my-first-page`，
在这里，`my-first-page`是一种`node`（在 Drupal 的术语中）内容类型`page`并存储在数据库中。如果您熟悉面向对象编程，那么将 a`content type`视为一个*类*和`node`它的实例。

如果要查看body的内容，必须在`field_revision_body`table中查看它的数据库；因为 Drupal 不会将驱动器上的数据存储为 PHP（或任何其他）页面。

PS：以后如果您对 Drupal 有任何疑问，建议您在 StackExchange 专用站点 Drupal Answers（网址：[http](http://drupal.stackexchange.com) ://drupal.stackexchange.com ）上提问。您可能会在那里得到快速帮助:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T19:50:03.933

Drupal 是一个 CMS，因此它的内容存储在数据库中： http: [//drupal.org/documentation/understand](http://drupal.org/documentation/understand)

安装后，最好只浏览内容和站点，而不是源代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T19:58:54.823

有关如何在 Drupal 7 站点上编辑页面（节点）的说明。

通过 www.mysite.com/user 登录您的网站。然后转到顶部菜单栏>>点击内容>>

您应该会看到用于编辑或添加内容的视图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-11T17:53:35.000

所有节点、所有用户和用户配置文件、附件以外的所有信息（例如图像）都存储在**数据库**中。

**节点**存储在“node”和“node_revisions”表中。关于书页父母的信息存储在“书”表中。评论存储在“评论”表中。用户存储在“users”和“profile_values”表中。分类法使用几个以“术语”开头的表。

# python - Thread() 中 args 的 2 位参数不起作用

> ID：15531687
> 
> 赞同：0
> 
> 时间：2013-03-20T18:20:21.650
> 
> 标签：python, python-2.7, python-multithreading

在这里，我有我的问题的相关代码片段：

```
from threading import Thread
.
.
.
def do_post(thread_no):
       print "Starting thread no: " + thread_no + "\n"

.
.
.

for i in range(0,MAX_THREADS):
        try:
            t=Thread(target=do_post, args=('%d'%i))
            t.start()

.
. 
```

当 MAX_THREADS > 10 我收到错误消息：`TypeError: do_post() takes exactly 1 argument (2 given)`

如何让它接受 2 位数字？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:23:16.250

您可能想将 a 传递`tuple`给`args`：

```
args=('%d'%i,) 
```

正如您所拥有的那样，您只是传递了一个字符串，该字符串被解压缩成比应有的更多参数。

考虑：

```
def printstuff(*args):
    print args,len(args)

printstuff(*("1"))   #('1',) 1
printstuff(*("10"))  #('1', '0') 2
printstuff(*("10",)) #('10',) 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:26:04.373

`args=(...,)`需要传递一个序列，而不是一个标量值，所以在后面加一个逗号`('%d'%i)`：

```
t = Thread(target=do_post, args=('%d'%i,)) 
```

`('%d'%i)`与字符串相同`'%d'%i`。

`('%d'%i, )`是`'%d'%i`作为其第一个元素的元组。

* * *

但是，顺便说一下，您不必传递线程号。

你可以使用：

```
 name = threading.current_thread().name 
```

反而。

* * *

```
import threading

def worker():
    name = threading.current_thread().name
    print('I am: {n}'.format(n = name))

for i in range(4):
    t = threading.Thread(target=worker)
    t.daemon=True
    t.start()

# I am: Thread-1
# I am: Thread-2
# I am: Thread-3
# I am: Thread-4 
```

* * *

如果您想更改线程的名称，您可以通过`name`参数传递您喜欢的任何字符串。例如，

```
t = threading.Thread(target=worker, name=str(i)) 
```

结果是

```
I am: 0
I am: 1
I am: 2
I am: 3 
```

# javascript - 未捕获的 ReferenceError：未定义 iphoneGallery

> ID：15531688
> 
> 赞同：0
> 
> 时间：2013-03-20T18:20:24.310
> 
> 标签：javascript, jquery, css, jquery-ui, javascript-events

我正在使用两种不同的 js，因为我使用两种不同的布局，一种用于台式机和 iphone....因为对于 iphone，我需要减小立方体大小....立方体大小来自 js....但我我得到两个不同的错误......

[http://jsfiddle.net/YZYp5/24/](http://jsfiddle.net/YZYp5/24/)

有两个不同的js函数一个是

```
$(document).ready(iphoneGallery.init);
$(document).ready(Gallery.init); 
```

未捕获的 ReferenceError：未定义 iphoneGallery

```
$(window).bind('resize', function() {
            location.reload();

            Gallery.setOptions({
                size: 78,
                lightbox: false,
                //animation:  'drop'
                //speed:      500,
                //closeOnEsc: true,
                //slideshow:  false,
                //slideshow_speed: 3000,
                //cube_speed: 1000
            });

        });

        $(window).bind('resize', function() {
            location.reload();

            iphoneGallery.setOptions({
                size: 78,
                lightbox: false,
                //animation:  'drop'
                //speed:      500,
                //closeOnEsc: true,
                //slideshow:  false,
                //slideshow_speed: 3000,
                //cube_speed: 1000
            });

        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:01:32.940

通过始终调用两者

```
$(document).ready(iphoneGallery.init);
$(document).ready(Gallery.init); 
```

您总是尝试初始化 iphoneGallery，即使对于非移动浏览器也是如此。您必须只初始化其中之一，可能取决于屏幕宽度。

此外，您的`iphoneGallery`定义在事件侦听器中，这没有任何意义。

编辑：

我试图修复它，看看这个：http: [//jsfiddle.net/YZYp5/25/](http://jsfiddle.net/YZYp5/25/)

# cuda - CUDA Makefile nvcc 错误

> ID：15531693
> 
> 赞同：1
> 
> 时间：2013-03-20T18:20:40.497
> 
> 标签：cuda, makefile, nvcc

我正在尝试编译一个基本的 CUDA 矩阵乘法程序，但我遇到了这个错误：

```
nvcc    -I. -I/usr/local/cuda/include -c matrixMult1.cu -o matrixMult1.o
make: nvcc: Command not found
make: *** [matrixMult1.o] Error 127 
```

我最初遇到了另一个错误，建议我使用 nvcc，唯一的问题是我对 nvcc 一无所知。有人有想法吗？提前致谢！

生成文件：

```
GCC = nvcc
CUDA_INSTALL_PATH := /usr/local/cuda
INCLUDES := -I. -I$(CUDA_INSTALL_PATH)/include
CUDA_LIBS := -L$(CUDA_INSTALL_PATH)/lib -lcudart

matrixMult1.o:      matrixMult1.cu
            $(GCC)  $(INCLUDES) -c matrixMult1.cu -o $@ 

matrixMult1:        matrixMult1.o
        $(GCC)  -o $@ matrixMult1.o $(CUDA_LIBS)

clean:
        $(RM)   *.o *~ 
```

核心：

```
//********************************************************************
// matrixMul_kernel.cu
//
// Kernel for a basic matrix multiplication program.
//********************************************************************

#ifndef _MATRIXMUL_KERNEL_H_
#define _MATRIXMUL_KERNEL_H_

#include <stdio.h>

/* Thread block size */
#define BLOCK_SIZE 3

#define WA 3
#define HA 3
#define WB 3
#define HB WA
#define WC WB
#define HC HA

/* CUDA Kernel */
__global__ void matrixMul (float * C, float * A, float * B, int wA,
               int wB) {

    /* Two dimensional thread ID */
    int tx = threadIdx.x;
    int ty = threadIdx.y;

    /* Computation holder variable */
    float value = 0;

    /* Loop through row of A and column of B to compute cell of C */
    for (int i = 0; i < wA; ++i) {
    float elementA = A[ty * wA + i];
    float elementB = B[i * wB + tx];
    value += elementA * elementB;
    }

    /* Write the result to C */
    C[ty * wA + tx] = value;
}

#endif 
```

主程序：

```
//********************************************************************
// matrixMult1.c
//
// A basic matrix multiplication program.
//********************************************************************

#include <stdlib.h>
#include <stdio.h>
#include <math.h>
#include <matrixMul_kernel.cu>

#define WA 3
#define HA 3
#define WB 3
#define HB WA
#define WC WB
#define HC HA

void initMatrix(float * matrix, int numIndices);

//*************
// Main Program
//*************
int main(int argc, char** argv) {

    /* Set random seed */
    srand(2013);

    /* Compute memory sizes for matrices A, B, and C */
    unsigned int sizeA = WA * HA;
    unsigned int sizeB = WB * HB;
    unsigned int sizeC = WC * HC;
    unsigned int memoryA = sizeof(float) * sizeA;
    unsigned int memoryB = sizeof(float) * sizeB;
    unsigned int memoryC = sizeof(float) * sizeC;

    /* Allocate memory for matrices A, B, and C */
    float * matrixA = (float *) malloc(memoryA);
    float * matrixB = (float *) malloc(memoryB);
    float * matrixC = (float *) malloc(memoryC);

    /* Initialize matrices A and B */
    initMatrix(matrixA, sizeA);
    initMatrix(matrixB, sizeB);

    /* Print matrix A */
    printf("\nMatrix A:\n");
    for (int i = 0; i < sizeA; i++) {
        printf("%f ", matrixA[i]);

        if (((i + 1) % WA) == 0) {
            printf("\n");
        } else {
            printf(" | ");
        }
    }

    /* Print matrix B */
    printf("\nMatrix B:\n");
    for (int i = 0; i < sizeB; i++) {
        printf("%f ", matrixB[i]);

        if (((i + 1) % WA) == 0) {
            printf("\n");
        } else {
            printf(" | ");
        }
    }

    /* Allocate device memory */
    float* deviceMemA;
    float* deviceMemB;
    float* deviceMemC;
    cudaMalloc((void**) &deviceMemA, memoryA);
    cudaMalloc((void**) &deviceMemB, memoryB);
    cudaMalloc((void**) &deviceMemC, memoryC);

    /* Copy host memory to device */
    cudaMemcpy(deviceMemA, matrixA, memoryA,
           cudaMemcpyHostToDevice);
    cudaMemcpy(deviceMemB, matrixB, memoryB,
           cudaMemcpyHostToDevice);

    dim3 threads(BLOCK_SIZE, BLOCK_SIZE);
    dim3 grid(WC / threads.x, HC / threads.y);

    /* Execute kernel */
    matrixMul<<< grid, threads >>>(deviceMemC, deviceMemA,
                   deviceMemB, WA, WB);

    cudaMemcpy(deviceMemC, matrixC, memoryC,
           cudaMemcpyHostToDevice);

    /* Print matrix C */
    printf("\nMatrix C:\n");
    for (int i = 0; i < sizeC; i++) {
        printf("%f ", matrixC[i]);

        if (((i + 1) % WC) == 0) {
            printf("\n");
        } else {
            printf(" | ");
        }
    }
    printf("\n");

    /* Free up memory */
    free(matrixA);
    free(matrixB);
    free(matrixC);
    cudaFree(deviceMemA);
    cudaFree(deviceMemB);
    cudaFree(deviceMemC);
}

//--------------------------------------------------------------------
// initMatrix - Assigns a random float value to each indice of the
//              matrix.
//
// PRE:  matrix is a pointer to a block of bytes in memory; numIndices
//       is the number of indicies in the matrix being instantiated.
// POST: Each index of the matrix has been instantiated with a random
//       float value.
//--------------------------------------------------------------------
void initMatrix(float * matrix, int numIndices) {

    /*
    Loop through the block of bytes, assigning a random float
    for each index of the matrix
    */
    for (int i = 0; i < numIndices; ++i) {

        /* Assign a random float between 0 and 1 at this byte */
        matrix[i] = rand() / (float)RAND_MAX;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:22:42.623

这个错误：

```
nvcc: Command not found 
```

表示它`nvcc`不在你的 shell 中`PATH`。

要修复它，假设它是`bash`或类似的：

```
PATH=$PATH:/usr/local/cuda/bin
make 
```

...或将其添加到系统或您的用户的个人资料中。

# android - 如何验证 PEM 编码的服务器证书并链接到 Android 受信任的 CA？

> ID：15531694
> 
> 赞同：2
> 
> 时间：2013-03-20T18:20:41.090
> 
> 标签：android, security, validation, ssl, certificate

我正在开发一个在 Android 4.0+ 上运行的企业通信应用程序。这个应用程序有一个用 c/c++ 编写的本机传输层，它管理与 SIP 服务器的 SSL 连接。本机层使用 openSSL 库进行 SSL 连接。

当应用程序打开 SSL 连接时，我需要对服务器证书进行验证。这包括根据可用的根 CA 证书和主机名验证验证证书链。我的问题是（我知道）无法访问 Android 信任存储 CA 证书。我的意思是内置证书（例如 Verisign）和用户安装的受信任 CA。

因此，我很确定我要做的就是将证书链传递给 java 代码（这是已实现且有效的），以便我可以使用 java 安全 API。从本质上讲，我必须开始的是 PEM 格式的证书数组（从服务器接收的链）（如果更好的话，可以是 DER）。

我了解如何将链转换为证书对象并将证书对象转换为 CertPath 对象。看起来可以使用 CertPathValidator 来验证 CertPath。我在正确的轨道上吗？我在这里挂断的点是 CertPathValidator.validate(cp,params) 需要一个 PKIXParameters 对象。反过来，这似乎需要一个密钥库或一组 TrustAnchors。我假设密钥库或 TrustAnchors 集代表用于验证 cp（CertPath）的受信任根 CA，对吗？如果是这样，我如何/在哪里获取 PKIXParameters 构造函数的输入参数？

另一方面，我刚刚开始研究是否可以/应该使用 TrustManager 来验证服务器证书。我想我了解 TrustManager 在使用 HTTPSUrlConnection 时是如何适应和使用的，但是当我开始使用我的 PEM 证书数组时，我还不清楚如何做到这一点。

有人可以指出我正确的方向吗？

谢谢，

*   肯

# java - 将 ViewStub 放在 listView 下面

> ID：15531695
> 
> 赞同：0
> 
> 时间：2013-03-20T18:20:40.763
> 
> 标签：java, android, listview, viewstub

我正在为 Android 2.2（API 级别 8）编程，在我的主视图中，我以一种简化的方式拥有：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/relativeParent"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <TableRow
        android:id="@+id/tableRow2"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

      ...

    </TableRow>

    <ListView
        android:id="@+id/listview"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content">
    </ListView>

        <ViewStub
            android:id="@+id/includeIdForPlayerStub"
            android:layout_alignParentBottom="true"
            android:layout_alignBottom="@+id/listview"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:inflatedId="@+id/playerStubId"
            android:layout="@layout/player_stub" />

</RelativeLayout> 
```

我想把 ViewStub 放在父级的底部，就在列表视图的正下方，但是现在它不起作用。ViewStub 添加的 LinearLayout 位于屏幕底部，但列表位于添加的内容下方，导致列表内容位于下方且不可见/不可访问。查看添加内容下方的滚动条也很明显。

ViewStub 的根视图是：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:gravity="bottom"
    android:layout_gravity="center_horizontal|bottom"
    android:background="@drawable/backrepeat"
    android:baselineAligned="false" >

</LinearLayout> 
```

任何人都知道如何解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:29:25.493

更改项目的顺序，以便首先放置 ViewStub，然后将 ListView 设置为 ViewStub 上方：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/relativeParent"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <TableRow
        android:id="@+id/tableRow2"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

      ...

    </TableRow>

    <ViewStub
        android:id="@+id/includeIdForPlayerStub"
        android:layout_alignParentBottom="true"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:inflatedId="@+id/playerStubId"
        android:layout="@layout/player_stub" />

    <ListView
        android:id="@+id/listview"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@id/includeIdForPlayerStub"
        android:layout_below="@id/tableRow2">
    </ListView>

</RelativeLayout> 
```

# java - ORA-29538: 未安装 Java - PL/SQL 调用 Java 代码

> ID：15531699
> 
> 赞同：0
> 
> 时间：2013-03-20T18:21:29.257
> 
> 标签：java, database, oracle, plsql

我在运行调用 Java 代码的 PL/SQL 代码时遇到问题，这是我的 PL/SQL 代码

```
create or replace function hello return varchar2 as language java name 'Hello.hello() return java.lang.String';

declare
  batman varchar2(5000) := hello;
begin
  DBMS_output.put_line('batman ' || batman);
end; 
```

我的代码只是一个名为“hello”的方法，返回一个字符串，我使用 javac Hello.java 编译 java 文件，但它继续返回相同的错误。

完整的错误堆栈：

```
ORA-29538: Java não instalado
ORA-06512: em "COTRIJAL_TESTE.HELLO", line 1
ORA-06512: em line 2
29538\. 00000 -  "Java not installed"
*Cause:    An attempt was made to use a Java command when Java is not installed.
*Action:   Install Java, or do not use the command. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:24:02.147

Oracle XE 缺少 Java。使用完整版的 Oracle。

# php - GET 请求中的 PHP/JS URL

> ID：15531702
> 
> 赞同：0
> 
> 时间：2013-03-20T18:21:35.013
> 
> 标签：php, javascript, forms, get

这个问题与[StackOverflow 上](https://stackoverflow.com/questions/15254112/how-to-pass-url-in-url-as-get-parameter-using-php)的另一个问题直接相关。

我有同样的问题 - 但我不确定我可以将协议前缀分隔为另一个变量，如上述问题中所建议的那样。我正在使用 GET 操作，发送到使用数据的另一个页面（例如 index.php 上的表单将 GET 提交到 search.php）。

在索引页面上，用户可以键入要提交的数据，包括 URL（例如文本字段和提交按钮）。由于 URL 的性质，我预计会有一些人复制和粘贴 - 因此人们有时可能会包含 http://，无论我是否希望他们这样做。

如果 http: 包含在 GET 请求中（例如 search.php?q= [http://google.com](http://google.com)），那么我会在 search.php 上收到 403 Forbidden 错误 - 这是我遇到问题的地方。

在 JS 之外，有没有办法在将请求发送到 search.php 之前从用户输入中删除或分离协议前缀（如果存在）？EG 在用户点击提交之后但在数据被发送到另一个页面之前？

提前感谢您提供的任何答案或建议！

编辑：我知道我可以使用 urlencode 对 URL 进行编码 - 但可以在实际发送数据/GET 请求之前完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:23:56.333

在 JavaScript 之外？不可以。
但是，当数据发送到 search.php 时，您可以测试 http:// 并将其删除，您不希望它包含它。

# android - 使用 AlarmManager 每天打印一次消息

> ID：15531710
> 
> 赞同：0
> 
> 时间：2013-03-20T18:21:55.067
> 
> 标签：android, android-intent, alarmmanager

我是 android 开发的新手，我想知道如何让应用程序在每天的特定时间执行特定操作。例如，每次到午夜时递增一个计数器。我昨天花了很多时间研究这个，但找不到任何直接的东西。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:26:11.020

对于 AlarmManager 的使用，以下教程非常有帮助

[http://code4reference.com/2012/07/tutorial-on-android-alarmmanager/](http://code4reference.com/2012/07/tutorial-on-android-alarmmanager/)

# ios - 使用静态库和应用程序管理依赖项

> ID：15531712
> 
> 赞同：1
> 
> 时间：2013-03-20T18:21:57.920
> 
> 标签：ios, xcode, dependencies, static-libraries

我正在构建一个将使用自定义 Web API 的应用程序。我想为这个 API 创建一个与应用程序分开的 Objective-C 适配器。我正在考虑将其作为一个静态库。

因此，例如 MyAppAPI 将是一个静态库，而 MyApp 将与该库链接。

MyAppAPI 需要 AFNetworking 才能访问 Web API。但 MyApp 也因为其他原因需要 AFNetworking。

我希望能够通过单元测试独立测试 MyAppAPI。为了测试它，静态库项目需要AFNetworking。但我不希望 AFNetworking 使用 MyAppAPI 进行编译，我希望它是一个外部依赖项。

所以实际上 MyAppAPI 和 MyApp 都依赖于 AFNetworking，我希望能够独立测试 MyAppAPI。

处理这种情况的最佳方法是什么？我可能遗漏了一些明显的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:04:53.487

看看 CocoaPods。他们负责 XCode 项目的依赖管理，并拥有一个中央存储库（包括 AFNetworking）。

在[http://cocoapods.org](http://cocoapods.org)上，您可以找到所有入门信息。

# url - 来自 URL 的 Excel VBA 列表文件

> ID：15531719
> 
> 赞同：0
> 
> 时间：2013-03-20T18:22:09.233
> 
> 标签：url, vba, excel

好的，我将如何记录位于远程服务器上的文件夹中的所有文件，我必须使用 URL 访问这些文件，例如[http://domain.com/folder](http://domain.com/folder)并且在文件夹内有一堆文件我会就像列出到excel中一样。当尝试列出当前 C:\ 上的文件夹中的文件时，有一些函数会执行此操作，但在尝试列出 URL 中的文件时它们不起作用。我不确定这是否可以做到！谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:52:00.443

将服务器目录映射为您机器上的本地驱动器（例如 O:）并使用小型 VBA 程序，例如

```
Sub ServerDir()
Dim Idx As Integer, FN As String, R As Range

    Set R = Selection
    Idx = 1
    ' URL =  http://repository.XXXXX.com/content/dav/Repository/Users/Users-M/mike.d/mike.d-Public/
    ' mapped http://repository.XXXXX.com/content/dav/ to O:\ 
    FN = Dir("O:\Repository\Users\Users-M\mike.d\mike.d-Public\*.ppt")

    Do While FN <> ""
        R(Idx, 1) = FN
        FN = Dir()
        Idx = Idx + 1
    Loop

End Sub 
```

# jquery - jQuery插件：调用回调方法，然后可以根据响应调用插件函数

> ID：15531722
> 
> 赞同：4
> 
> 时间：2013-03-20T18:22:14.317
> 
> 标签：jquery, ajax, plugins, callback

我开始编写 jQuery 插件并将它们与 AJAX 集成。我正在减脂并专注于基础知识：

```
(function($)
{
   function MyPlugin(el, options)
   {
     this.element = $(el);
     this.myInput = false;
     this.options = $.extend(
     {
       onSave:function(){}
     }, options);
     this.initialize();
   }

   $.fn.myPlugin = function(options)
   {
      var control = new MyPlugin(this.get(0), options);
      return control;
   };

   MyPlugin.prototype = 
   {
     initialize:function()
     {
       var me = this;
       //specifics shouldn't really matter
       //it creates some HTML to go inside the element
       //within that HTML is an input, which I can successfully invoke keyup:
       me.myInput.keyup(function(event)
       {
         if(keyPressIsEnter(event)
           me.saveFunction();
       });
     },
     saveFunction:function()
     {
       var value = this.myInput.val();
       this.options.onSave(value);

       //CURRENTLY I CALL SUCCESS ANIMATION
       successAnimation();
     },
     successAnimation:function()
     {
        //do something to the markup within element for success
     },
     failureAnimation:function()
     {
        //do something to the markup within element for failure
     }         
   };
})(jQuery); 
```

假设我有一个 div 并将其设置为使用我的插件，如下所示：

```
$("myDiv").myPlugin({onSave:function(value){myAjaxSaveFunction(value);}); 
```

使用此设置，插件、保存功能和动画都可以正常工作（假设从未出现错误）。但是，myAjaxSaveFunction 是异步的，可能返回成功或失败。我目前在调用成功动画的插件中有保存功能。如果我让 myAjaxSaveFunction 返回真/假，我可以（理论上）在插件中使用该返回值来确定是运行成功还是失败，但如果函数是异步的，则不能。

那么，这种情况通常是如何处理的呢？为了重用，我需要能够将处理数据的函数自定义为可选回调，但我需要插件等待它是否根据函数的结果运行成功/失败动画（这可能是异步的，或者可能不是）。

@Kevin B：你是在暗示这个吗？

```
saveFunction:function()
 {
   var value = this.myInput.val();
   var success = this.options.onSave(value);
   if(success)
      successAnimation();
   else
      failureAnimation();
 }, 
```

在 this.options.onSave 函数执行时，这不会立即落入 if 语句吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T19:09:28.387

我建议允许 onSave 函数返回一个布尔值或一个承诺对象。

```
saveFunction:function()
 {
   var value = this.myInput.val();
   var success = this.options.onSave(value);
   if(success && success.promise)
       success.promise().done(successAnimation).fail(failureAnimation);
   elseif (success)
      successAnimation();
   else
      failureAnimation();
 }, 
```

现在，您可以像这样使用它：

```
$("myDiv").myPlugin({onSave:function(value){return myAjaxSaveFunction(value);});

function myAjaxSaveFunction(value) {
    return $.ajax({...});
} 
```

# django - 使用 Django/Splinter 进行 plupload 的 TDD

> ID：15531728
> 
> 赞同：2
> 
> 时间：2013-03-20T18:22:25.627
> 
> 标签：django, selenium, plupload, django-testing, splinter

[我正在尝试使用plupload](http://www.plupload.com/)队列小部件为上传设置测试。我正在使用[Splinter](http://splinter.cobrateam.info/)进行浏览器内测试，但我找不到实现它的方法。Splinter 有一些附加文件的方法，但前提是它是一个简单的文件字段。另一种方法是单击按钮浏览文件，然后选择文件......但我认为不可能使用 Splinter（或 selenium），是吗？或者通过拖放文件。

有人对自动化这些测试的最佳方法有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T13:12:49.130

可以使用 Selenium-WebDriver 自动执行在 PLUpload 控件上完成的用户操作。请在下面找到 WebDriver C# 代码，该代码单击 Flash 按钮对象并使用键盘事件选择文件，

```
using System;
using System.Windows.Forms;
using OpenQA.Selenium.Firefox;
using OpenQA.Selenium;
using OpenQA.Selenium.Support;
using OpenQA.Selenium.Interactions;
using NUnit.Framework;
namespace BusinessCreation
{
    class PlUpload
    {
        static void Main(string[] args)
        {
               IWebDriver driver = new FirefoxDriver();
               driver.Navigate().GoToUrl("http://www.plupload.com/example_queuewidget.php");
               driver.FindElement(By.XPath("//object[@data='/plupload/js/plupload.flash.swf']")).Click();
               SendKeys.SendWait(@"C:\Users\Public\Pictures\Sample Pictures\Dock.jpg");
               SendKeys.SendWait(@"{Enter}");
         }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-29T10:09:22.237

PlUpload 小部件也有类似的问题。感谢 CheryJose 让我走上正轨。

首先，我必须创建一个小类来找出打开了哪些窗口并将它们作为窗口字典返回。

```
public static IDictionary<string, IntPtr> GetOpenWindows()
{
    IntPtr lShellWindow = GetShellWindow();
    Dictionary<string, IntPtr> lWindows = new Dictionary<string, IntPtr>();
    EnumWindows(delegate(IntPtr hWnd, int lParam)
    {
        if (hWnd == lShellWindow) return true;
        if (!IsWindowVisible(hWnd)) return true;
        int lLength = GetWindowTextLength(hWnd);
        if (lLength == 0) return true;

        StringBuilder lBuilder = new StringBuilder(lLength);
        GetWindowText(hWnd, lBuilder, lLength + 1);
        lWindows[lBuilder.ToString()] = hWnd;
        return true;
    }, 0);

    return lWindows;
}

public delegate bool EnumDelegate(IntPtr hWnd, int lParam);
public delegate bool EnumedWindow(IntPtr handleWindow, ArrayList handles);

[DllImport("USER32.DLL")]
public static extern bool EnumWindows(EnumDelegate enumFunc, int lParam);

[DllImport("USER32.DLL")]
public static extern IntPtr GetShellWindow();

[DllImport("USER32.DLL")]
public static extern int GetWindowText(IntPtr hWnd, StringBuilder lpString, int nMaxCount);

[DllImport("USER32.DLL")]
public static extern int GetWindowTextLength(IntPtr hWnd);

[DllImport("USER32.DLL")]
public static extern bool IsWindowVisible(IntPtr hWnd);

[DllImport("user32.dll")]
public static extern bool SetForegroundWindow(IntPtr hWnd); 
```

在 Selenium 页面代码中，我单击按钮启动 PlUpload 窗口并稍等片刻。（这在代码中没有显示）

然后我使用下面的代码查找所有打开的窗口

```
IDictionary<string, IntPtr> getOpenWindows = GetOpenWindows(); 
```

切换到 PlUpload 窗口（窗口名称因浏览器而异。请注意！）

```
IntPtr hWnd = getOpenWindows["File Upload"];
SetForegroundWindow(hWnd); 
```

输入文件的路径

```
SendKeys.SendWait(filename); 
```

按回车

```
SendKeys.SendWait(@"{Enter}"); 
```

PlUpload 窗口将关闭，因此我们切换回浏览器窗口（在本例中为 Firefox）

```
hWnd = getOpenWindows["Mozilla Firefox"];
SetForegroundWindow(hWnd); 
```

这有几个问题，因为窗口标题会根据所使用的浏览器而有所不同，因此需要考虑到这一点以获得完整的解决方案。此外，当这部分代码正在执行时，不要将任何其他窗口置于前台，因为此窗口将接收“SendKeys”而不是所需的窗口。

# iphone - 切换控制器时标签栏消失

> ID：15531733
> 
> 赞同：0
> 
> 时间：2013-03-20T18:22:41.853
> 
> 标签：iphone, ios, xcode, object, tabbar

这段代码可以完美地切换视图控制器，除了标签栏控制器消失了。
现在我尝试了此代码的许多不同变体

> [self presentViewController:homeNavigationController 动画：没有完成：nil];

但它们似乎都不能正常工作。推送控制器只是将视图冻结到位。关于做什么的任何提示？

```
 - (void)_tabBarItemClicked:(id)item {   
assert([item isKindOfClass:[UIButton class]]);

NSInteger selectedIndex = ((UIButton *)item).tag;

[self setSelectedIndex:selectedIndex];

[self _setSelectedItemAtIndex:selectedIndex];

NSDictionary *userInfo = @{@"index": [NSNumber numberWithInt:selectedIndex]};

[[NSNotificationCenter defaultCenter] postNotificationName:@"tabBarDidSelectItem" object:nil userInfo:userInfo];
if (selectedIndex ==2) {

    HomeViewController *homeViewController = [[HomeViewController alloc] initWithNibName:nil bundle:nil];
    UINavigationController *homeNavigationController = [[UINavigationController alloc] initWithRootViewController:homeViewController];

    [self presentViewController:homeNavigationController animated:NO completion:nil];

}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:26:14.297

您正在以模态方式呈现 homeNavigationController ——您所看到的是模态视图控制器的正常行为，也就是说，它们占据了包括标签栏在内的整个屏幕。如果您想查看标签栏，请不要使用模态演示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T19:44:15.647

我通过以下方式解决了这个问题：

1) 在 AppDelegate 中定义 YourTabBarController 对象

2) 并从 YourTabBarController 的对象中呈现 ViewController 而不是像“自我”一样

```
[appDelegateObj.yourTabBarObj presentViewController:homeNavigationController animated:NO completion:nil];]; 
```

确保您的 Appdelegate 对象已初始化。

# php - li 标签的 isset 函数

> ID：15531737
> 
> 赞同：0
> 
> 时间：2013-03-20T18:23:06.857
> 
> 标签：php

我的编码就像

```
<?php
if (!isset($_SESSION["usr"]))
{
    ?>
    <ul id="top_nav">
        <li ><a href="login.php">Login</a></li>
        <li><a href="#">About us</a></li>
    </ul>
    <?php
}
else
{
    echo '<ul id="top_nav">';
    echo '<li id="logout"><a href="#">Logout</a></li>';
    echo '<li><a href="#">' . $_SESSION["usr"] . '</a></li> </ul>';
}
?> 
```

在 php 中，我想在用户单击注销时销毁会话（我使用过 li）。所以我想检查使用`isset`功能。或任何其他方法然后让我知道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:27:33.677

取消设置会话变量使用`unset($_SESSION['usr'],$usr);`。两个变量都需要解决`register_global`问题。你的代码必须是这样的

```
<?php 
if ($_GET['logout']=='1') unset($_SESSION['usr'],$usr);
if(!isset($_SESSION["usr"])){?>
  <ul id="top_nav">
      <li><a href="login.php">Login</a></li>
      <li><a href="#">About us</a></li>
  </ul>
<?php }else{ ?>
  <ul id="top_nav">
      <li id="logout"><a href="?logout=1">Logout</a></li>
      <li><a href="#"><?=$_SESSION["usr"];?></a></li>
  </ul>
<?php } ?> 
```

# r - 哪个元素是每个子列表的最小值

> ID：15531738
> 
> 赞同：1
> 
> 时间：2013-03-20T18:23:08.803
> 
> 标签：r

我试图找出每个子列表的哪个元素是该特定子列表的最小值。我正在尝试应用该功能的当前数据块是 41 个条目的记录。它们被另一个函数分组，该函数为每个子列表或子组生成索引。元素`1:8`在第一个子组中，以下子组如下： `9:17`, `18:23`, `24:33`, `34:41`。请注意，我将我正在使用的数据称为“ `b1`”，为将 b1 的元素分组为子组而创建的索引是“ `indx`”。我可以像这样使用 sapply 找出每个子组中的最小值：

```
sapply(indx, function(i) min(b1[i]) 
```

但是，我一直在寻找上面提供的每个数字是哪个“b1”元素。我知道我可能需要函数`which()`and `mapply()`，但无法将它放在一起。

可重现的数据：

```
b1 <- sample(1:20,41,T)
starts <- c(1,9,18,24,34)
stops <- c(8,17,23,33,41)
indx <- mapply(seq, from=starts, to=stops) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:28:40.033

基本上是你自己想出来的。

尝试

```
sapply(indx, function(i) which.min(b1[i])) 
```

* * *

## 编辑

我不确定这是否真的是你想要的。上面的答案应该返回每个子组中最小元素*的索引。*

在这种情况下，您可以执行以下操作（可能是多种可能的方法之一）：

```
indices <- 1:length(b1)
sapply(indx, function(i) indices[i][which.min(b1[i])]) 
```

# c# - 检查并从终端 C# 获取用户输入

> ID：15531739
> 
> 赞同：1
> 
> 时间：2013-03-20T18:23:14.097
> 
> 标签：c#, input

我正在尝试从 C# 中的终端获取用户输入，但我只想在用户开始输入时 ReadLine。基本上我现在设置它的方式是我处于一个while循环中，我想检查我是否收到消息或发送它们，但我不想通过调用 ReadLine 和如果他们目前没有要发送的内容，则等待用户发送消息。我的代码看起来像这样：

```
While (true)
{
    // If messages to be received
        // Receive them

    // Check to see if the user is typing input
    if (Console.KeyAvailable)
    {
        string userInput = Console.ReadLine();
        // Do stuff...
    }   

} 
```

基本上发生的事情是它工作得很好，但是用户键入的第一个字母没有显示在终端窗口中，但它确实被 ReadLine 拾取没问题。无论如何我可以让它工作，以便用户可以立即看到他们正在输入的所有内容？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:41:27.647

您可以使用`Console.ReadKey(true);`读取丢失的项目，然后使用 readline 方法读取其他部分，将其附加到您的输入中。

# sql - 高效的 SQL Server 存储过程

> ID：15531743
> 
> 赞同：1
> 
> 时间：2013-03-20T18:23:19.880
> 
> 标签：sql, sql-server, database, sql-server-2008, stored-procedures

我正在使用 SQL Server 2008 并运行以下存储过程，该存储过程需要将 70 mill 表从大约 50 mill 行“清理”到另一个表，即`id_col`is `integer`(primary identity key)

根据我上次运行的结果，它运行良好，但预计会持续约 200 天：

```
SET NOCOUNT ON

    -- define the last ID handled
    DECLARE @LastID integer
    SET @LastID = 0
    declare @tempDate datetime
    set @tempDate = dateadd(dd,-20,getdate())
    -- define the ID to be handled now
    DECLARE @IDToHandle integer
    DECLARE @iCounter integer
    DECLARE @watch1 nvarchar(50)
    DECLARE @watch2 nvarchar(50)
    set @iCounter = 0
    -- select the next  to handle    
    SELECT TOP 1 @IDToHandle = id_col
    FROM MAIN_TABLE
    WHERE id_col> @LastID and DATEDIFF(DD,someDateCol,otherDateCol) < 1
        and datediff(dd,someDateCol,@tempDate) > 0 and (some_other_int_col = 1745 or some_other_int_col = 1548 or some_other_int_col = 4785)
    ORDER BY id_col

    -- as long as we have s......    
    WHILE @IDToHandle IS NOT NULL
    BEGIN
        IF ((select count(1) from SOME_OTHER_TABLE_THAT_CONTAINS_20k_ROWS where some_int_col = @IDToHandle) = 0 and (select count(1) from A_70k_rows_table where some_int_col =@IDToHandle )=0)
        BEGIN
            INSERT INTO SECONDERY_TABLE
            SELECT col1,col2,col3.....
            FROM MAIN_TABLE WHERE id_col = @IDToHandle

            EXEC    [dbo].[DeleteByID] @ID = @IDToHandle --deletes the row from 2 other tables that is related to the MAIN_TABLE and than from the MAIN_TABLE
            set @iCounter = @iCounter +1
        END
        IF (@iCounter % 1000 = 0)
        begin
            set @watch1 = 'iCounter - ' + CAST(@iCounter AS VARCHAR)
            set @watch2 = 'IDToHandle - '+ CAST(@IDToHandle AS VARCHAR)
            raiserror ( @watch1, 10,1) with nowait
            raiserror (@watch2, 10,1) with nowait
        end
        -- set the last  handled to the one we just handled
        SET @LastID = @IDToHandle
        SET @IDToHandle = NULL

        -- select the next  to handle    
        SELECT TOP 1 @IDToHandle = id_col
        FROM MAIN_TABLE
        WHERE id_col> @LastID and DATEDIFF(DD,someDateCol,otherDateCol) < 1
            and datediff(dd,someDateCol,@tempDate) > 0 and (some_other_int_col = 1745 or some_other_int_col = 1548 or some_other_int_col = 4785)
        ORDER BY id_col
    END 
```

欢迎任何改进此过程运行时的想法或方向

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:38:47.200

是的，试试这个：

```
Declare @Ids Table (id int Primary Key not Null)
Insert @Ids(id)
Select id_col
From MAIN_TABLE m
Where someDateCol >= otherDateCol
    And someDateCol < @tempDate -- If there are times in these datetime fields, 
                                -- then you may need to modify this condition.
    And some_other_int_col In (1745, 1548, 4785)
    And Not exists (Select * from SOME_OTHER_TABLE_THAT_CONTAINS_20k_ROWS
                    Where some_int_col = m.id_col)
    And Not Exists (Select * From A_70k_rows_table
                    Where some_int_col = m.id_col)
Select id from @Ids  -- this to confirm above code generates the correct list of Ids
return -- this line to stop (Not do insert/deletes) until you have verified @Ids is correct
-- Once you have verified that above @Ids is correctly populated, 
-- then delete or comment out the select and return lines above so insert runs.

      Begin Transaction
      Delete OT     -- eliminate row-by-row call to second stored proc
      From OtherTable ot
         Join MAIN_TABLE m On m.id_col = ot.FKCol
         Join @Ids i On i.Id = m.id_col 

      Insert SECONDERY_TABLE(col1, col2, etc.)
      Select col1,col2,col3.....
      FROM MAIN_TABLE m Join @Ids i On i.Id = m.id_col 

      Delete m   -- eliminate row-by-row call to second stored proc
      FROM MAIN_TABLE m 
      Join @Ids i On i.Id = m.id_col 

      Commit Transaction 
```

解释。

1.  您有许多不是 SARGable 的过滤条件，即它们会强制对循环的每次迭代进行完整的表扫描，而不是能够使用任何现有索引。在将表列值与其他值进行比较之前，请始终尝试避免将处理逻辑应用于表列值的过滤条件。这消除了查询优化器使用索引的机会。

2.  您一次执行一个插入...最好生成一个需要处理的 PK Id 列表（一次全部），然后在一个语句中一次执行所有插入。

# windows - 每次批量从选择中获取一个随机句子

> ID：15531745
> 
> 赞同：0
> 
> 时间：2013-03-20T18:23:25.897
> 
> 标签：windows, batch-file, cmd

有没有办法做到这一点，而不是每次都说你设置的相同回声，你可以给出一个回声列表，并在每次到达该回声命令时选择一个随机的回声？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:31:31.623

是的。这是一个概念证明。

```
@echo off
setlocal enabledelayedexpansion

set string[0]=This is the first random line.
set string[1]=This is the second random line.
set string[2]=This is the third random line.

set /a idx=%random% * 3 / 32768

echo !string[%idx%]! 
```

这是有关在 Windows 批处理脚本中[生成随机数](https://stackoverflow.com/a/5777608/1683264)的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:32:42.527

```
@echo OFF
SETLOCAL
SET message0=message zero
SET message1=message one
SET message2=message two
SET message3=message three
SET message4=message four

:: running 10 times

FOR /l %%i IN (1,1,10) DO CALL :showme
GOTO :eof

:showme
SET /a select=%RANDOM% %% 5
CALL SET message=%%message%select%%%
ECHO %message%
GOTO :eof 
```

# .net - 如何在服务器上将 PowerPoint 转换为 PDF

> ID：15531746
> 
> 赞同：0
> 
> 时间：2013-03-20T18:23:27.850
> 
> 标签：.net, powerpoint, converter

我正在寻找（努力）将 PowerPoint 文件转换为 PDF 格式的轻量级组件。有 SharePoint 2013 可以做到这一点，但它不适合我的需要，因为需要一些轻量级的东西，而不是 SharePoint 服务器场。

有没有我可以使用的组件，最好像 GhostScript 一样打开？它可以是 .NET 组件或将从命令行执行的 EXE 实用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:32:34.623

使用 Aspose.Slides 库。我已经多次使用它并取得了巨大的成功。
[http://www.aspose.com/.net/powerpoint-component.aspx](http://www.aspose.com/.net/powerpoint-component.aspx)

# html - iPad 会截断横向和纵向的内容

> ID：15531747
> 
> 赞同：1
> 
> 时间：2013-03-20T18:23:29.470
> 
> 标签：html, css, ipad, responsive-design

我在 iPad 上以横向和纵向视图呈现简单页面时遇到问题。

我附上了这个问题的截图。您可以在右上角看到导航元素显示在“截断”的右侧，但图形元素只是随机停止。因此，虽然它在某些方面被切断了，但在其他方面却没有。

我有一个看起来很漂亮的磨坊视口定义：

`<meta name="viewport" content="width=device-width, initial-scale = 1,user-scalable=no,maximum-scale=1.0">`

任何想法为什么会发生这种情况？谢谢-![在此处输入图像描述](../Images/67e916069ba46e232d6fc7d32a125f87.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T20:15:53.140

我很惊讶为什么到现在还没有人回答这个问题！我可以看到问题仍然存在，所以我猜你还没有找到解决方案。

这是 CSS 初学者面临的一个非常基本的错误。溢出在媒体查询中设置为可见，但 body 元素中的嵌套 div 没有此属性。所以背景组件在页眉和页脚中受到限制。链接仍然可见，因为它们具有固定的宽度。您需要使设计更具响应性，这样就不需要溢出：body 元素上的可见，并且 body 正确地嵌套了页面上的所有内容。适当的响应式设计不会遭受这些基本故障的影响。

如果您需要进一步说明，请告诉我。

# java - 使用 log4j 将数据记录到 TextArea 中是否有一种简单的方法可以做到这一点

> ID：15531753
> 
> 赞同：0
> 
> 时间：2013-03-20T18:23:38.490
> 
> 标签：java, log4j

我正在通过 log 4 j 记录器记录消息，我想以某种方式获取此数据流并将其显示在 JTextArea 中以供显示。有什么简单的方法可以做到这一点？

感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:32:15.010

在这里查看解决方案和建议以及[jtextarea-as-listener-for-log4j-logger](https://stackoverflow.com/questions/3349196/jtextarea-as-listener-for-log4j-logger)。我希望它会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:30:45.840

我自己从未尝试过，但最直接的方法是实现`org.apache.log4j.Appender`，因此您的实现的构造函数将接受您想要显示日志条目的 GUI 对象的实例。

# ruby-on-rails - 基于 .count 的条件渲染 - Rails

> ID：15531762
> 
> 赞同：1
> 
> 时间：2013-03-20T18:24:06.273
> 
> 标签：ruby-on-rails, ruby, conditional-statements

我有一个直截了当的问题，我有一个实例变量“@fam_act.count”，它计算一个家庭进行的活动数量。

我在视图中的代码显示

> 已完成 <%= @bal_act.count %> 个活动

目前，如果一个家庭只完成了一项活动，则显示为“已完成 1 项活动”。我想添加一些条件逻辑，以便如果活动等于 1，它将显示“活动”而不是“活动”

类似的东西：如果@bal_act.count == 1 呈现“活动”，否则“活动”

什么是正确的语法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:27:17.467

你可以使用[复数](http://apidock.com/rails/ActionView/Helpers/TextHelper/pluralize)

```
Completed <%= pluralize(@bal_act.count, 'Activity', 'Activities') %> 
```

# indexing - 移动tableViewHeaderView下的字母索引

> ID：15531764
> 
> 赞同：0
> 
> 时间：2013-03-20T18:24:09.963
> 
> 标签：indexing, uitableview

我有一个带有 tableviewheader 的 UITableView，它有一个 2 段 UISegmentedControl。表格视图在右侧有一个按字母顺序排列的索引。索引出现在 tableViewHeader 上。如何移动索引使其不与我的 tableViewHeader 重叠？我在文档中找不到任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:30:58.667

您不能向下移动索引。它总是与您的标题重叠。

# c++ - C++ 错误中的运算符（）重叠和继承

> ID：15531766
> 
> 赞同：1
> 
> 时间：2013-03-20T18:24:23.163
> 
> 标签：c++, inheritance, operator-overloading, operator-keyword

这是我的问题：

## 代码：

## 文件 1.hpp：

```
namespace Output {

class Stringify{ // base class.....
protected:
    size_t              prec;
public:
    std::stringstream   out;
public:
    Stringify(const size_t& _p = 5): prec(_p) {out.precision(prec);}
    virtual ~Stringify(void){}
public:
    std::string operator()(const XYZ& _v){
        out.str("");
        out << "{ " << _v.x() << ", " << _v.y() << ", " << _v.z() << " }";
        return out.str();
    }
    std::string operator()(const XYZ& _v, const bool& _status){
        out << "{ " << _v.x() << ", " << _v.y() << ", " << _v.z() << " }";
        return out.str();
    }
};
} 
```

* * *

其中 XYZ 是一个矢量对象。

## 文件 2.hpp：

```
namespace NODE { 

class Stringify: public Output::Stringify {
public:
    Stringify2(const size_t& _p = 5): Output::Stringify(_p) {}
    virtual ~Stringify2(void){}
public:
    std::string operator()(const VERTEX& _obj){ return "What?";}
};
} 
```

* * *

其中 VERTEX 是另一个具有 XYZ 类型成员值的对象

## 主.cpp：

```
int main(int argc,char * argv[]){
   XYZ  v(1,2,3);
   NODE::Stringify printer;

   cout << printer(v) << endl;
   return 0; 
```

## }

输出是：什么？

什么时候应该：是{1,2,3}

编译没问题，但是据我所知，NODE::Stringify 能够打印 {1,2,3}，因为他的基础对象继承了 XYZ 参数的方法，但它打印了带有参数的方法顶点（什么？）。不需要虚拟词，因为我没有覆盖基类中的方法。

作为信息：我正在使用 Eigen 3.0 库（typedef Eigen::vector3d XYZ）在带有 llvm-gcc-4.2 的 MAC OS 10.8 中编译任何想法？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:30:10.113

您`operator ()`在派生类中*隐藏*了基类的`operator ()`重载（您`Stringify`在示例中命名，但这可能是一个错字，因为构造函数和析构函数被命名为`(~)Stringify2`）。

`using`您可以通过派生类中的声明来解决此问题：

```
namespace NODE {
    class Stringify2 : public Output::Stringify {
    //             ^
    public:
        using Output::Stringify::operator ();
    //  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    //  This should fix the problem

        Stringify2(const size_t& _p = 5): Output::Stringify(_p) {}
        virtual ~Stringify2(void){}
    public:
        std::string operator()(const VERTEX& _obj){ return "What?";}
    };
} 
```

# java - REST Assured - 通用列表反序列化

> ID：15531767
> 
> 赞同：56
> 
> 时间：2013-03-20T18:24:29.353
> 
> 标签：java, arrays, json, deserialization, rest-assured

假设我有一个 Java`Person`类：

```
class Person {
    String name;
    String email;
} 
```

使用 REST Assured，您可以反序列化此 JSON 对象

```
{"name":"Bob", "email":"bob@email.com"} 
```

使用 Java`Person`实例

```
Person bob = given().when().get("person/Bob/").as(Person.class); 
```

如何使用 REST Assured 反序列化这个 JSON 数组

```
[{"name":"Bob", "email":"bob@email.com"}, 
 {"name":"Alice", "email":"alice@email.com"}, 
 {"name":"Jay", "email":"jay@email.com"}] 
```

变成一个`List<Person>`？例如，这会很方便：

```
List<Person> persons = given().when().get("person/").as(...); 
```

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2013-03-22T17:53:13.480

我找到了一种方法来实现我想要的：

```
List<Person> persons = given().when().get("person/").as(Person[].class); 
```

**更新：**使用 Rest-Assured 1.8.1，看起来不再支持强制转换为 List。您需要像这样声明和对象数组：

```
Person[] persons = given().when().get("person/").as(Person[].class); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2016-09-20T08:14:03.273

对于那些发现接受的答案不再起作用的人。

```
 List<Entity> list = new ArrayList<>();
    list = given()
            .contentType(CONTENT_TYPE)
        .when()
            .get(getRestOperationPath())
        .then()
            .extract().body().as(list.getClass()); 
```

希望您了解 getRestOperationPath 正在返回休息操作路径；并且 CONTENT_TYPE 是您的内容类型的占位符（例如 application/json）

upd：检查不同的版本，行为因版本而异，因此您可能想尝试不同的方法

upd2：@Arigion 在评论中指出了**更清洁的解决方案：**

```
to use .extract().body().jsonPath().getList(".", Entity.class); 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2018-10-26T10:17:25.450

要从 JSON API 响应中提取 Java 列表而不是数组，您只需要记住使用`jsonPath`而不是`as`：

```
List<Person> persons = given()
        .when()
        .get("/person")
        .then()
        .extract()
        .body()
        // here's the magic
        .jsonPath().getList(".", Person.class); 
```

您的 json 路径可以指向您希望在您的正文中包含 json 对象列表的任何位置。在这个例子中（并且为你的问题工作）它只是指向 json 根。

sidenode：放心在内部使用jackson进行反序列化（for`.jsonPath`以及`.as`）

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-05-14T15:42:18.247

如果您对使用“expect()”感兴趣，也可以这样做

```
expect().
 body("get(0).firstName", equalTo("Mike")).
when().
 get("person/"); 
```

这是我的情况

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2021-03-24T18:43:16.693

我们现在可以`TypeRef`尽可能多地使用 JsonPath 库：

```
List<Person> persons = given().when().get("person/")
    .as(new TypeRef<List<Person>>() {}); 
```

与[https://github.com/json-path/JsonPath#what-is-returned-when](https://github.com/json-path/JsonPath#what-is-returned-when)一样- 匿名内部类`new TypeRef<List<Person>>() {}`绕过类型擦除并捕获足够的类型信息以使框架可以访问原始类型 -`List`在这种情况下. 内部泛型类型 - `Person`- 是可以在特定情况下进行的安全转换。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2018-05-10T11:57:28.360

如果有人还在找。使用 Java 1.8 和 RestAssured 2.9 解决方案非常简单，并且不会引发“未经检查的警告”。

```
return Arrays.asList(given()
            .when()
            .get("restPath")
            .then()
            .extract()
            .response()
            .body()
            .as(Player[].class)); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-03-14T05:53:39.003

如果您对 JsonPath 不满意，我建议您使用任何使用 GSON 或 Jackson 的 java 序列化/反序列化。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2018-12-16T07:19:19.323

这将很有帮助，适用于当前版本的放心。

```
@Test
    public void apostUser() {
        Map<String,String> user = new HashMap<>();
        user.put("User_Id", "xyx1111");
        user.put("First_Name", "KS");
        user.put("Designation", "DR");

        given()
        .contentType("application/json")
        .body(user)
        .when().post("URI").then()
        .statusCode(200);
    } 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2021-02-03T16:07:29.297

既然你想映射

```
[{"name":"Bob", "email":"bob@email.com"}, 
 {"name":"Alice", "email":"alice@email.com"}, 
 {"name":"Jay", "email":"jay@email.com"}] 
```

到java对象。

现在在调用端点时，您可以直接映射到 Person 列表，如下所示

```
List<Person> personList = given().when().get("person/").as(Person[].class); 
```

注意 Person 类应该保持不变，即不需要对 person 类做任何修改。

```
public class Person{
 String name;
 String email;
} 
```

# php - 无法从 Excel（utf8 格式）获取正确的字符到 PHP

> ID：15531768
> 
> 赞同：4
> 
> 时间：2013-03-20T18:24:31.247
> 
> 标签：php, excel, utf-8, character-encoding

各种字符编码问题都有很多问题和答案，但似乎没有一个能解决我的问题。

我每个月都会收到一个电子表格，需要将其转换为 Prestashop 数据。我仍然通过首先将 .xls 转换为 .csv 来帮助自己，但如果我能一次性完成它会容易得多。

我使用 PHP-ExcelReader 读取以 Unicode (UTF-8) 保存的 .xls 文件。我的问题是，无论我选择什么输出编码，总会有一些字符无法正确显示。

我创建了一个测试页面来准确显示在什么条件下发生了什么： [http ://www.num1.nl/test.php](http://www.num1.nl/test.php)

希望有人能帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:44:45.843

@grahamj42，我知道它没有，但我需要的所有字符都得到了正确处理。只是为了测试设置，更容易显示全范围。

@Captain Payalytic，phpExcel 确实对我有用。现在所有基本字符都得到了正确处理。

现在我只需要弄清楚为什么 phpExcel 将我的数据范围扩展为 1 行。

非常感谢您的提示：）

# android - 通过 wifi 连接接收数据

> ID：15531773
> 
> 赞同：0
> 
> 时间：2013-03-20T18:24:52.303
> 
> 标签：android, connection, wifi

我正在尝试进行以下工作，并想知道是否有可能：

我想将数据从硬件发送到 android 设备。虽然硬件只有以太网连接可用。

如果我要从硬件到路由器建立以太网连接，然后通过 WiFi 从路由器与 android 设备通信，有什么办法可以告诉 android 设备，只从 WiFi 接收数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:30:40.800

使用**IP**协议将允许您通过任何`IP`网络进行通信。

最简单的方法是使用使用服务器/客户端关系进行通信的 TCP 套接字。

我猜您正在使用微控制器（arduino？）如果是这种情况，您可以查看许多 IP 实验室和示例。在硬件上编写服务器代码后，您可以轻松地使用套接字从 android 连接到它，这里是如何将 android 客户端连接到 TCP 服务器的示例。 [TCP客户端教程](http://myandroidsolutions.blogspot.com/2012/07/android-tcp-connection-tutorial.html)

额外链接：

*   [维基百科上的 TCP](http://en.wikipedia.org/wiki/Transmission_Control_Protocol)无需阅读实施细节，只需了解概念即可。
*   [Java All about Sockets](http://docs.oracle.com/javase/tutorial/networking/sockets/index.html)对套接字编程的伟大概述，应该让您准备好在 android 端编写有效的代码。
*   [LAN](http://en.wikipedia.org/wiki/Local_area_network)维基百科关于 LAN 的文章

# javascript - 使用 VS2012 调试时强制刷新 javascripts

> ID：15531782
> 
> 赞同：1
> 
> 时间：2013-03-20T18:25:10.067
> 
> 标签：asp.net, javascript, asp.net, visual-studio-2012

学习如何使用 VS2012 在我的[asp.net](/questions/tagged/asp.net "显示标记为“asp.net”的问题")项目中调试脚本现在，当我开始项目时，我开始收到错误（来自 3rd 方库）

问题是 - 即使我对脚本进行了更改 - 它也没有在浏览器中更新，所以在重新启动时我会弹出相同的错误，`Ctrl+F5`我需要“抓住”一个时刻，当我可以打开带有网站的浏览器窗口时。

我真的想确保当我启动网站时，所有脚本都在缓存中刷新并且我处理最新的副本。

（可选）我想禁用 VS2012 javascript 调试（不知道如何）并开始使用 F12 工具...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:45:27.343

在 Visual Studio 中禁用 JavaScript 调试的一个技巧是打开 Silverlight 调试。两者不能同时运行，因此打开 Silverlight 会禁用 JavaScript。我过去多次使用过这个技巧。

# java - 将字符串添加到 JList 的确切位置，而不是在底部

> ID：15531783
> 
> 赞同：-1
> 
> 时间：2013-03-20T18:25:13.127
> 
> 标签：java, swing, drag-and-drop, jlist, transfer

我有几个 JList 都可以作为 DnD COPY 操作的来源和目的地。它们工作得很好，但一方面 - 元素被添加到列表的底部，而不是我想要的放置目标行。

由于[Oracle BasicDnD 示例](http://docs.oracle.com/javase/tutorialJWS/uiswing/dnd/ex6/BasicDnD.jnlp "Oracle BasicDnD 示例")包含此功能（事实上，它是我能够通过 Google 找到的唯一应用程序），我一直在查看它的[源代码](http://v1.dione.zcu.cz/java/docs/tutorial/uiswing/examples/dnd/BasicDnDProject/src/dnd/BasicDnD.java "BasicDnD 来源")，看看我是否能够适应它。我试图设置 TransferHandler 对象，这是我想我缺少的，但没有出现新的行为。那么，我可能会错过/做错什么（其他）？

**EDIT1：**下面显示了我用于这些列表的类。

```
private class InteractiveJList extends JList implements DragGestureListener, 
DragSourceListener, DropTargetListener {

private final DropTarget dropTarget;
private final DragSource dragSource;
private final boolean    removeElementsOnFail;
private int[]            selectedOnes;

@SuppressWarnings("unchecked")
private InteractiveJList(final ListModel model, 
final boolean _removElementsOnFail) {
    super(model);
    this.dragSource = new DragSource();
    this.dragSource
        .createDefaultDragGestureRecognizer(this, DnDConstants.ACTION_COPY,
this);
this.dropTarget = new DropTarget(this, this);
this.removeElementsOnFail = _removElementsOnFail;
}

@Override
public void dragEnter(final DropTargetDragEvent arg0) {
}

@Override
public void dragExit(final DropTargetEvent arg0) {
}

@Override
public void dragOver(final DropTargetDragEvent arg0) {
}

@Override
public void drop(final DropTargetDropEvent event) {
    if (!this.removeElementsOnFail) {
    event.rejectDrop();
    return;
    }
    final Transferable transferable = event.getTransferable();

    if (transferable.isDataFlavorSupported(DataFlavor.stringFlavor)) {
    String all;
    try {
        all = (String) transferable.getTransferData(DataFlavor.stringFlavor);
    } catch (final UnsupportedFlavorException | IOException ex) {
        event.rejectDrop();
        return;
    }
    event.acceptDrop(DnDConstants.ACTION_COPY);
    final StringTokenizer tokenizer = new StringTokenizer(all, "|");
    while (tokenizer.hasMoreTokens()) {
        ((StringListModel) this.getModel()).addElement(tokenizer.nextToken());
    }
    event.getDropTargetContext().dropComplete(Boolean.TRUE);
    } else {
    event.rejectDrop();
    }
}

@Override
public void dropActionChanged(final DropTargetDragEvent event) {
}

@Override
public void dragEnter(final DragSourceDragEvent arg0) {
}

@Override
public void dragExit(final DragSourceEvent arg0) {
}

@Override
public void dragOver(final DragSourceDragEvent arg0) {
}

@Override
public void dropActionChanged(final DragSourceDragEvent dragSourceEvent) {
}

@Override
public void dragGestureRecognized(final DragGestureEvent dragGestureEvent) {
    final Object listSelectedValue = this.getSelectedValue();
    this.selectedOnes = this.getSelectedIndices();
    final StringBuilder bridge = new StringBuilder();
    for (final int x : this.selectedOnes) {
    bridge.append(this.getModel().getElementAt(x)).append("|");
    }
    if (listSelectedValue != null) {
    final StringSelection stringTransferable =
new StringSelection(bridge.toString()
            .substring(0, bridge.length() - 1));
    this.dragSource.startDrag(dragGestureEvent, DragSource.DefaultCopyDrop,
            stringTransferable, this);
    }
}

@Override
public void dragDropEnd(final DragSourceDropEvent dragSourceDropEvent) {
    if (!dragSourceDropEvent.getDropSuccess()) {
    if (this.removeElementsOnFail) {
        for (final int x : this.selectedOnes) {
        ((StringListModel) this.getModel()).removeElement(x);
        }
    }
    }
}

} 
```

使用构造函数中的布尔标志是因为，对于其中一个列表，如果丢弃操作被拒绝，则必须删除该元素，而不是另一个。这样我就可以处理了。`StringListModel`是[AbstractListModel](http://docs.oracle.com/javase/7/docs/api/javax/swing/AbstractListModel.html "AbstractListModel Java 7 Javadocs")处理字符串列表的扩展。它能够在底部和请求的位置添加元素，清除列表并删除某些元素。它做自己的事情，触发相应的事件，仅此而已。

**EDIT2：**下面显示了我对 MadProgrammer 建议的实施：

```
 private static class UserTransferHandler extends TransferHandler {

private final JList list;

private UserTransferHandler(final JList list) {
    this.list = list;
}

@Override
public boolean canImport(final TransferSupport support) {
    System.out.println("canImport");
    boolean canImport = false;
    if (support.isDataFlavorSupported(UserTransferable.USER_DATA_FLAVOR)) {
    final JList.DropLocation dl = 
(JList.DropLocation) support.getDropLocation();
    if (dl.getIndex() != -1) {
        canImport = true;
    }
    }
    return canImport;
}

@Override
protected void exportDone(final JComponent source, final Transferable data,
final int action) {
    System.out.println("exportDone");
}

@Override
public boolean importData(final TransferSupport support) {
    System.out.println("importData");
    boolean accepted = false;

    if (support.isDrop()) {
    if (support.isDataFlavorSupported(UserTransferable.USER_DATA_FLAVOR)) {

        final JList.DropLocation dl = 
(JList.DropLocation) support.getDropLocation();
        final StringListModel model = (StringListModel) this.list.getModel();
        final int index = dl.getIndex();
        final boolean insert = dl.isInsert();

        final Transferable t = support.getTransferable();
        try {
        final String dropped = (String) t
                .getTransferData(UserTransferable.USER_DATA_FLAVOR);
        if (insert) {
            if (index >= model.getSize()) {
            model.addElement(dropped);
            } else {
            model.addElementAt(dropped, index);
            }
        } else {
            model.addElement(dropped);
        }

        accepted = true;
        } catch (final Exception e) {
        e.printStackTrace();
        }
    }
    }
    return accepted;
}

@Override
public int getSourceActions(final JComponent c) {
    System.out.println("getSourceActions");
    return TransferHandler.COPY_OR_MOVE;
}

@Override
protected Transferable createTransferable(final JComponent c) {
    System.out.println("createTransferable");
    final String value = this.list.getSelectedValue().toString();
    return new UserTransferable(value);
}

}

private static class UserTransferable implements Transferable {

private static final DataFlavor USER_DATA_FLAVOR = 
new DataFlavor(String.class, "String");

private final String            value;

private UserTransferable(final String value) {
    System.out.println("UserTransferable");
    this.value = value;
}

@Override
public DataFlavor[] getTransferDataFlavors() {
    System.out.println("getTransferDataFlavors");
    return new DataFlavor[] { UserTransferable.USER_DATA_FLAVOR };
}

@Override
public boolean isDataFlavorSupported(final DataFlavor flavor) {
    System.out.println("isDataFlavorSupported");
    return UserTransferable.USER_DATA_FLAVOR.equals(flavor);
}

@Override
public Object getTransferData(final DataFlavor flavor) throws 
UnsupportedFlavorException, IOException {
    System.out.println("getTransferData");
    if (!UserTransferable.USER_DATA_FLAVOR.equals(flavor)) {
    throw new UnsupportedFlavorException(flavor);
    }
    return this.value;
}

} 
```

当调用方法时，打印语句可以获取反馈（现在，永远不会）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:05:38.937

这是一个使用（较新）`Transferable`API 的完整工作示例。这是基于您链接的示例。

请注意，我不介意使用`String`s，因为这只会让人们感到困惑，相反，我正在传输对象。

另请注意，我正在使用“移动”API，因此名称将从一个列表移动到另一个列表......

![在此处输入图像描述](../Images/2429ad6f8b3ac0c715070ebd825a5d76.png)

```
import java.awt.*;
import java.awt.event.*;
import java.awt.datatransfer.*;
import java.io.IOException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.*;

public class ComponentAPIDnD {

    public static void main(String[] args) {
        new ComponentAPIDnD();
    }

    public ComponentAPIDnD() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Testing");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new TestPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class TestPane extends JPanel {

        private JList left;
        private JList right;

        public TestPane() {
            setLayout(new GridLayout(0, 2));
            DefaultListModel<User> model = new DefaultListModel<>();
            model.addElement(new User("Rai"));
            model.addElement(new User("Mark"));
            model.addElement(new User("Han"));
            model.addElement(new User("Luke"));
            model.addElement(new User("Ben"));
            model.addElement(new User("Yoda"));
            left = new JList(model);
            left.setCellRenderer(new UserListCellRenderer());
            right = new JList(new DefaultListModel<User>());
            right.setCellRenderer(new UserListCellRenderer());

            left.setName("Left");
            right.setName("Right");

            add(new JScrollPane(left));
            add(new JScrollPane(right));

            left.setTransferHandler(new UserTransferHandler(left));
            right.setTransferHandler(new UserTransferHandler(right));

            left.setDropMode(DropMode.ON_OR_INSERT);
            right.setDropMode(DropMode.ON_OR_INSERT);

            left.setDragEnabled(true);
            right.setDragEnabled(true);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(400, 400);
        }
    }

    public static class UserTransferHandler extends TransferHandler {

        private JList list;

        public UserTransferHandler(JList list) {
            this.list = list;
        }

        @Override
        public boolean canImport(TransferSupport support) {
            boolean canImport = false;
            if (support.isDataFlavorSupported(UserTransferable.USER_DATA_FLAVOR)) {
                JList.DropLocation dl = (JList.DropLocation) support.getDropLocation();
                if (dl.getIndex() != -1) {
                    canImport = true;
                }
            }
            return canImport;
        }

        @Override
        protected void exportDone(JComponent source, Transferable data, int action) {
            try {
                User user = (User) data.getTransferData(UserTransferable.USER_DATA_FLAVOR);
                ((DefaultListModel<User>)list.getModel()).removeElement(user);
            } catch (UnsupportedFlavorException | IOException ex) {
                ex.printStackTrace();
            }
        }

        @Override
        public boolean importData(TransferSupport support) {
            boolean accepted = false;
            if (support.isDrop()) {
                if (support.isDataFlavorSupported(UserTransferable.USER_DATA_FLAVOR)) {

                    JList.DropLocation dl = (JList.DropLocation)support.getDropLocation();
                    DefaultListModel<User> model = (DefaultListModel<User>) list.getModel();
                    int index = dl.getIndex();
                    boolean insert = dl.isInsert();

                    Transferable t = support.getTransferable();
                    try {
                        User dropped = (User) t.getTransferData(UserTransferable.USER_DATA_FLAVOR);
                        System.out.println("Drop " + dropped + " on " + list.getName());
                        if (insert) {
                            if (index >= model.getSize()) {
                                model.addElement(dropped);
                            } else {
                                model.add(index, dropped);
                            }
                        } else {
                            model.addElement(dropped);
                        }

                        accepted = true;
                    } catch (Exception e) {
                        e.printStackTrace();
                    }
                }
            }
            return accepted;
        }

        @Override
        public int getSourceActions(JComponent c) {
            return COPY_OR_MOVE;
        }

        @Override
        protected Transferable createTransferable(JComponent c) {
            User user = (User) list.getSelectedValue();
            return new UserTransferable(user);
        }

    }

    public static class UserTransferable implements Transferable {

        public static final DataFlavor USER_DATA_FLAVOR = new DataFlavor(User.class, "User");

        private User user;

        public UserTransferable(User user) {
            this.user = user;
        }

        @Override
        public DataFlavor[] getTransferDataFlavors() {
            return new DataFlavor[] {USER_DATA_FLAVOR};
        }

        @Override
        public boolean isDataFlavorSupported(DataFlavor flavor) {
            return USER_DATA_FLAVOR.equals(flavor);
        }

        @Override
        public Object getTransferData(DataFlavor flavor) throws UnsupportedFlavorException, IOException {
            Object value = null;
            if (USER_DATA_FLAVOR.equals(flavor)) {
                value = user;
            } else {
                throw new UnsupportedFlavorException(flavor);
            }
            return user;
        }

    }

    public class User {

        private String name;

        public User(String name) {
            this.name = name;
        }

        public String getName() {
            return name;
        }
    }

    public class UserListCellRenderer extends DefaultListCellRenderer {

        @Override
        public Component getListCellRendererComponent(JList<?> list, Object value, int index, boolean isSelected, boolean cellHasFocus) {
            super.getListCellRendererComponent(list, value, index, isSelected, cellHasFocus);

            if (value instanceof User) {

                setText(((User) value).getName());

            }

            return this;
        }
    }
} 
```

# ruby-on-rails-3 - 从表单中的文本字段解析日期时，如何更改 ActiveRecord 期望的格式？

> ID：15531786
> 
> 赞同：15
> 
> 时间：2013-03-20T18:25:17.637
> 
> 标签：ruby-on-rails-3

## 问题

1.  我有一个带有 Date 属性的 Ruby on Rails 模型。
2.  在此模型的表单中，我使用带有 JQuery 日期选择器的单个文本字段来表示此属性（而不是像 Rails 自定义的那样逐年、月和日的下拉菜单）。
3.  datepicker 插入带有`mm/dd/yyyy`格式的日期。
4.  Rails 期待具有`dd/mm/yyyy`格式的日期。

## 例子

*   如果用户选择*March 12th, 2012*，日期选择器 puts `03/12/2012`，Rails 将其解释为*December 3rd, 2012*。
*   如果用户选择*March 20th, 2012*，日期选择器 puts `03/20/2012`，Rails 将其解释为 2012 年第**20 个月**的第 3 天。由于该日期不存在，Rails 将其转换为一个`nil`值（我认为）。

## 问题

解析此日期文本字段时，如何更改 Rails 使用的日期格式？

笔记：

1）我不想更改日期选择器插入文本字段的日期格式，

2) 我不是要在视图中显示我的日期属性。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-25T04:18:20.157

我最初认为这可以通过 Rails 国际化功能来解决，但事实证明我错了。

从 Ruby 1.9 开始，日期解析的标准格式是`dd/mm/yyyy`，以便更好地适应国际用户。更多细节可以在[这个 SO answer](https://stackoverflow.com/a/5373165/1512956)中找到。

该标准在 Rails 中得到维护，`Date.parse`现在用于处理来自表单输入的数据。使用`before_validation`回调不起作用，因为该字段`nil`将由回调方法接收。

现在有两个 gem 处理这个特定问题，即 Rails 中的日期解析不遵循`I18n.locale`. 两者似乎都运作良好。

1.  [**delocalize**](https://github.com/clemens/delocalize)，由 clemens - 似乎已成功应用于相当数量的项目或项目中，并且目前拥有最多的星星。

2.  [**i18n_alchemy**](https://github.com/carlosantoniodasilva/i18n_alchemy) by carlosantoniodasilva - 这个最近发布了。作者是 Rails 核心团队成员，并且在这方面非常活跃。绝对值得一看。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-25T01:34:29.357

由于您不想更改选择器的格式，我建议您对实际模型属性使用隐藏字段。

例如，为模型的日期属性添加一个隐藏字段，假设您像往常一样使用表单构建器：

`f.hidden_field :date`

然后对于选择器文本输入，不要将其绑定到模型的日期属性。假设隐藏字段的 ID 为“modelname_date”，选择器文本输入的 ID 为“date_picker”，请使用以下命令使其工作：

```
$(function(){
  $("#date_picker").datepicker({altField: '#nodelname_date', altFormat: 'dd/mm/yyyy'});
}); 
```

这样，日期选择器将日期显示为“mm/dd/yyyy”，但 Rails 会将日期显示为“dd/mm/yyyy”。

**更新：**

如果您想在 Rails 方面解决这个问题，我建议您使用另一个解决方案：

*   向模型添加虚拟属性：`attr_accessor :bad_format_date`
*   添加一个 before_validation 回调，您可以在其中解析输入日期并将其分配给真实字段：

```
before_validation do
  self.date = Date.strptime(bad_format_date, "%m/%d/%Y")
end 
```

然后对于视图上的表单使用`bad_format_date`但用`date`字段值初始化它（如果它是一个编辑表单）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T18:54:44.740

[及时性](https://github.com/adzap/timeliness)gem使 ruby​​ 日期/时间解析更加可定制，并与 Rails 很好地集成。

由于您使用的是 Rails，因此请务必查看同一个人的[validates_timeliness](https://github.com/adzap/validates_timeliness)项目。它包括 ActiveModel 的所有及时性以及复杂的日期/时间验证方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T03:52:56.173

你可以尝试做这样的事情。

```
$(function(){
 $('#date_picker').datepicker( {
      beforeShowDay: $.datepicker.noWeekends, 
      showOtherMonths: true,
      selectOtherMonths: true,
      dateFormat: 'dd-mm-yy',
      defaultDate: date,
      gotoCurrent: true

}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-15T16:16:49.063

我只是将以下猴子补丁添加到 config/time_formats.rb

```
class Date
  class << self
    alias :euro_parse :_parse
    def _parse(str,comp=false)
      str = str.to_s.strip
      if str == ''
        {}
      elsif str =~ /^(\d{1,2})[-\/](\d{1,2})[-\/](\d{2,4})/
        year,month,day = $3.to_i,$1,$2
        date,*rest = str.split(' ')
        year += (year < 35 ? 2000 : 1900) if year < 100
        euro_parse("#{year}-#{month}-#{day} #{rest.join(' ')}",comp)
      else
        euro_parse(str,comp)
      end  
    end
  end
end 
```

# php - str_replace 任何数字？

> ID：15531788
> 
> 赞同：3
> 
> 时间：2013-03-20T18:25:20.817
> 
> 标签：php, numbers, str-replace

我有一个关于 str_replace 任何数字的小问题......

```
$jud='Briney Spears 12 2009';

$jud=str_replace(array('2007','2008','2009','2010','2011','2012'),'2013',$jud);

$jud=str_replace(array('0'),'',$jud);  
$jud=str_replace(array('1'),'By',$jud);  
$jud=str_replace(array('2'),'Gun',$jud);  
$jud=str_replace(array('3'),'Fast',$jud);

echo $jud ; 
```

结果是

> Briney Spears ByGun GunByFast

有人可以帮忙吗？我正在寻找“ **Briney Spears ByGun 2013** ”​​的结果如何？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:33:54.610

Try replacing the year with some placeholder. For example:

```
$jud = str_replace(array('2007','2008','2009','2010','2011','2012'), '%%YEAR%%', $jud); 
```

Then replace numbers

```
$jud=str_replace(array('0'),'',$jud);
$jud=str_replace(array('1'),'By',$jud);
$jud=str_replace(array('2'),'Gun',$jud);
$jud=str_replace(array('3'),'Fast',$jud); 
```

And then replace placeholder with the year:

```
$jud = str_replace('%%YEAR%%', 2013, $jud); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T18:49:42.487

您可以更改替换顺序（一年后替换）或使用数组方法`str_replace()`

```
$sentence    = 'Britney Spears 12 2009';
$toreplace   = array('2009', '2012');
$replacewith = array('2013', '2013');

echo str_replace($toreplace, $replacewith, $sentence); // Britney Spears 12 2013 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T19:14:23.187

只是为了好玩:)

```
<?php
  $jud = 'Briney Spears 12 2009';
  $rep = array('', 'By', 'Gun', 'Fast');

  echo preg_replace(
    array_merge( array('/20(0[\d]|1[1-2])/'), 
      array_map( function($foo){
        return "/{$foo}(?![\d]{2,})(?!$)/";
      }, array_keys($rep))), 
        array_merge( array('2013'), $rep ), $jud, 1); 
```

[例子](http://ideone.com/Y7A3WP)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T18:29:52.843

我不知道我是否正确理解了你的问题。但你可以这样做：

```
$jud='Briney Spears 12 2009';
$jud=str_replace(" 12 ", " ByGun ", $jud); 
```

例如，这将用 ByGun 替换 12，而不用替换 2012。如果您需要所有月份，您可以将“1”到“12”放在一个数组中。保留前后的空间。

```
$jud=str_replace(array(" 1 "," 2 "," 3 "," 4 "," 5 "," 6 "," 7 "," 8 "," 9 "," 10 "," 11 "," 12 "), " ByGun ", $jud); 
```

然后，像您一样替换年份。

# php - 使用变量的 PHP 复选框验证

> ID：15531789
> 
> 赞同：0
> 
> 时间：2013-03-20T18:25:26.637
> 
> 标签：php, javascript, html

如果没有从 dsiplayed 项目列表中选择项目（来自 txt 文件），我正在尝试对我的代码应用一些验证以产生错误因为复选框是一个变量`<input type='checkbox' name='$partno'>`，所以很难设置一些验证，任何如何实现它的想法都将不胜感激。

```
 <script>
        function validateName()
        {
            var x=document.forms["purchase"]["visitor"].value;
            if (x==null || x=="")
            {
                alert("Visitor name must be entered");
                return false;
            }
        }
    </script>
</head>

<body>

    <h1>Items Available</h1>

    <form name="purchase" action="confirm.php" method="post" onsubmit="return validateName()">
        <table>

            <h3>Visitor Name: <input type='text' name='visitor'></h3>
            <tr><th></th><th></th><th></th><th>Price</th><th>&#10004;</th><th>QTY</th></tr>

            <?php
            if (!($data = file('items.txt'))) {
                echo 'ERROR: Failed to open file! </body></html>';
                exit;
            }
            foreach ($data as $thedata) {
                list($partno, $name, $description, $price, $image) = explode('|', $thedata);
                echo "<tr><td><img src='$image' width='60' height='60' alt='image'></td><td><h3>$name</h3></td><td>&nbsp;&nbsp;&nbsp;&nbsp;$description</td>
                    <td>&nbsp;&nbsp;&nbsp;&nbsp;<b>&pound;$price</b></td><td><input type='checkbox' name='$partno'></td><td><input type='text' size='1' name='qty' value='1'</td></tr>";
            }
            ?> 

        </table> 
```

到目前为止，我已经尝试...

```
function validateName()
    {
        var x=document.forms["purchase"]["$partno"].value;
        if (x==null || x=="")
        {
            alert("Select atleast one item");
            return false; 
```

失败得很惨。

新代码

```
<script>
        function validateName()
        {
            var x=document.getElementById("purchase").value
            if (x==null || x=="")
            {
                alert("Visitor name must be entered");
                return false;
            }
        }
    </script>
</head>

<body>

    <h1>Items Available</h1>

    <form id="purchase" name="purchase" action="confirm.php" method="post" onsubmit="return validateName()">
        <table>

            <h3>Visitor Name: <input type='text' name='visitor'></h3>
            <tr><th></th><th></th><th></th><th>Price</th><th>&#10004;</th><th>QTY</th></tr>

            <?php
            if (!($data = file('items.txt'))) {
                echo 'ERROR: Failed to open file! </body></html>';
                exit;
            }
            foreach ($data as $thedata) {
                list($partno, $name, $description, $price, $image) = explode('|', $thedata);
                echo "<tr><td><img src='$image' width='60' height='60' alt='image'></td><td><h3>$name</h3></td><td>&nbsp;&nbsp;&nbsp;&nbsp;$description</td>
                    <td>&nbsp;&nbsp;&nbsp;&nbsp;<b>&pound;$price</b></td><td><input type='checkbox' name='$partno'></td><td><input type='text' size='1' name='qty' value='1'</td></tr>";
            }
            ?> 

        </table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:59:23.700

首先在 JavaScript 访问它的表单中使用 HTML 属性“id”。

```
<form id="purchase" name="purchase" action="confirm.php" method="post" onsubmit="return validateName()"> 
```

然后使用以下内容访问它：

```
document.getElementById("purchase").value 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T06:43:05.900

这对你来说很好——

```
<h3>Visitor Name: <input type='text' id="name" name='visitor'></h3> 
```

并用于脚本

```
<script>
    function validateName()
    {
        var x = document.getElementById("name").value
        if (x==null || x=="")
        {
            alert("Visitor name must be entered");
            return false;
        }
    }
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T20:06:31.230

如果你想传递 $partno 变量，那么你应该将它作为隐藏传递

```
<input type="hidden" value=$partno">

function validateName()
   {
    var x=document.forms["purchase"]["$partno"].value;
    if (x==null || x=="")
     {
        alert("Select atleast one item");
        return false; 
```

# html - 列表中图像上的文本

> ID：15531790
> 
> 赞同：1
> 
> 时间：2013-03-20T18:25:27.370
> 
> 标签：html, css, html-lists

我正在尝试在列表中和图像上放置一个文本字段（[像这样](http://store.picbg.net/pubpic/2D/E7/ef2988092f8f2de7.png)）

我设法使它在一个列表项上正确，但是当我添加更多时，所有文本字段都卡在第一个图像上（[像这样](http://store.picbg.net/pubpic/9E/54/370193726bd69e54.png)）

这是我的代码：

HTML

```
 <ul class="panel">

        <li>

        <img src="">

            <span class="text-field" class="clearfix">

            <h2>text</h2>

             </span>

        </li> 
          </ul> 
```

CSS

```
 .panel li {display: inline-block; padding-right: 10px;}
          .panel li img{width: 100%;}
          .text-field {position: absolute; top: 212px; left: 0; width: 100%; }
          .text-field h2{color: #fff; background-color: #ff481c; display: inline-block; font-size: 16px; padding: 5px 10px; font-weight: bold; text-transform: uppercase;} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:28:06.043

指定`position: relative`为`.panel li`- 为其`absolute`子级将其顶部/左侧视为`0, 0`

IE

```
.panel li {display: inline-block; padding-right: 10px; position: relative;} 
```

# javascript - KineticJS 创建画布

> ID：15531793
> 
> 赞同：3
> 
> 时间：2013-03-20T18:25:38.747
> 
> 标签：javascript, kineticjs

我是 JavaScript/Canvas 和 KineticJS 的新手。

我知道可以创建这样的画布和舞台 -

```
 <div id="container"></div>
    <script src="http://www.html5canvastutorials.com/libraries/kinetic-v4.3.0-beta2.js"></script>
    <script>
      var stage = new Kinetic.Stage({
        container: 'container',
        width: 578,
        height: 200
      });
    </script> 
```

但是我想知道如果我已经有了一个画布，那么我将如何用它来创建一个舞台呢？所以像这样的事情......

```
<canvas id="myCanvas"></canvas>
<script src="http://www.html5canvastutorials.com/libraries/kinetic-v4.3.0-beta2.js"></script>
<script>
    //How do I create a Kinetic.stage of the #myCanvas?
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:18:49.403

**这个怎么样：**

创造一个新的舞台。

创建一个新层。

创建一个与舞台大小相同的新图像。

将 Image 的图像源设置为 myCanvas。

注意：我没有测试以下代码，但它应该可以工作 +/- 调整。

```
var myCanvasImg=new Kinetic.Image({
      x: 0,
      y: 0,
      image: document.getElementById("myCanvas").getContext("2d").toImageURL(),
      width: stage.getWidth(),
      height: stage.getHeight()
    }); 
```

将图像添加到图层并将图层添加到舞台。

砰……带有 myCanvas 内容的新舞台！

# django - 开发环境中的 NoReverseError 但测试中没有

> ID：15531801
> 
> 赞同：0
> 
> 时间：2013-03-20T18:26:06.823
> 
> 标签：django, django-webtest

我有一个视图 - 下面称为 DevicesListView - 在测试环境（在 Webtest 中）中执行没有问题，但是当我尝试在开发环境中执行相同的视图时，我收到 NoReverseMatch 错误。

**设备/urls.py**

```
from inventory.devices.views import DeviceCheckout
urlpatterns = patterns('',
    # NOTE: these are namespaced as 'devices'

    # ex: /devices
    url(r'^$', 
        DevicesListView.as_view(),
        name='index'),

    # ex: /devices/3/checkout
    url(r'^(?P<pk>\d)/checkout/$',
        DeviceCheckout.as_view(),
        name='checkout'),
) 
```

**视图.py**

```
class DevicesListView(ListView):
    '''Index view for devices.'''
    model = Device
    template_name = 'devices/index.html'
    context_object_name = 'all_devices'
    def get(self, request):
        #  ... 
    def post(self, request):
        """Process the action for the selected devices.
        """
        action = request.POST['action']  # the selected action
        # Get the IDs of the devices that had their checkboxes selected
        selected_pks = [int(v) for v in request.POST.getlist('device_select')]
        # Get the selected Device objects
        selected_devices = Device.objects.filter(pk__in=selected_pks)
        # ... Logic to handle selected action ...
        # redirect to lendee selection page
        device = selected_devices[0]
        if action == 'checkout_selected':
            return redirect('devices:checkout', pk=device.pk)  # throws NoReverseMatch in development
        elif action == 'checkin_selected':
            return redirect('devices:checkin', pk=device.pk)
        return redirect('devices:index') 
```

**webtest_tests.py**

```
from django_webtest import WebTest
from inventory.user.tests.factories import UserFactory
from inventory.devices.tests.factories import DeviceFactory
class TestAUser(WebTest):
    def setUp(self):
        self.user = UserFactory()

    def test_can_checkout_device(self):
        # two devices are already created
        DeviceFactory()
        DeviceFactory()
        # goes to devices page
        res = self.app.get('/devices', user=self.user)
        # checks the first device
        form = res.forms['device_control']
        form.set('device_select', True, index=0)
        # Selects Checkout device
        form.set('action', 'checkout_selected')
        # Submits form
        res = form.submit().follow()
        assert_equal(res.status_code, 200) # PASSES 
```

**设备/index.html**

```
 <form method="post" id="device_control" action="">
    {% csrf_token %}
    <label><span class="action-label">Action:</span>
      <select name="action">
        <option value="" selected="selected">---------</option>
        <option value="checkout_selected">Checkout</option>
        <option value="checkin_selected">Checkin</option>
        <option value="delete_selected">Delete selected</option>
      </select>
    </label>
    <input type="submit" name="_save" class="default btn" value="Go"/>
  </div><!-- end btn-toolbar -->
  <table class='table table-striped'>
    <thead>
      <th>Select</th>
      <th>Name</th>
    </thead>
    <tbody>
    {% for device in all_devices %}
      <tr>   
        <td><input type="checkbox" value="{{ device.pk }}" name='device_select' id="select_device{{ device.pk }}"></td>
        <td>{{ device.name }}</td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
</form> 
```

我得到的模板错误是：

```
NoReverseMatch at /devices/
Reverse for 'checkout' with arguments '()' and keyword arguments '{'pk': 13}' not found. 
```

我已确保同步数据库并重新启动开发服务器。什么会导致测试和开发环境之间出现这种不同的行为？我在 Mac OSX Lion 上使用 Django 1.5。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T21:05:11.837

确实是个愚蠢的错误。问题出在 url 模式正则表达式中。`r'^(?P<pk>\d)/checkout/$'`只捕获 1 位数的 pk。它缺少一个`+`after `\d`。所以应该是：

```
...
# ex: /devices/13/checkout
url(r'^(?P<pk>\d+)/checkout/$',
    DeviceCheckout.as_view(),
    name='checkout'),
... 
```

# c# - 未找到属性的属性

> ID：15531807
> 
> 赞同：2
> 
> 时间：2013-03-20T18:26:17.197
> 
> 标签：c#, reflection

```
[MyAttribute("x")]
public string Z{get;set;}

[MyAttribute("x")]
public void Y()
{

} 
```

它发现方法上的 attr 很好，但属性上的 attr 无法识别。

```
public static bool HasAttribute(this MethodInfo m, Type attrType)
{
    return Attribute.IsDefined(m, attrType);
} 
```

我在调试期间查看了该对象，并查看了它正确列出了 CustomAttributes 中的属性的方法，但是属性上的那个是空的……谁能解释一下？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:35:40.320

您在属性上定义了属性，而不是在属性访问器上。要在 getter 上提供属性，您将使用此语法（我包括了所有 3 个可能的位置，您可以根据其适用性选择在任何组合上添加属性）。

```
[MyAttribute("on PropertyInfo")]
public string Z
{
    [MyAttribute("on getter MethodInfo")] get;
    [MyAttribute("on setter MethodInfo")] set;
} 
```

# sql - 无效的操作员错误oracle

> ID：15531808
> 
> 赞同：0
> 
> 时间：2013-03-20T18:26:20.320
> 
> 标签：sql, oracle

我的来源中有一张桌子。IT 有 2 列 period(varchar) 和 Center(varchar)。中心具有以下值 L150 L180 L352 并且期间具有 NULLS。

我正在尝试运行此查询

```
select TIP.PERIOD
  from SCOTT.TIP
 where (1=1)
       and (
         CASEWHEN TIP.CENTRO IN ('L150','L180','L358')
             THEN TIP.PERIOD = 'C'
             ELSE TIP.PERIOD = 'D'
              END) 
```

但我收到无效的关系运算符错误。可能是什么原因？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:29:01.753

这是错误的

```
CASEWHEN 
```

改变它哟

```
CASE WHEN 

select TIP.PERIOD
   from SCOTT.TIP  where (1=1) and (
   TIP.PERIOD = CASE WHEN TIP.CENTRO IN ('L150','L180','L358')
   THEN TIP.PERIOD = 'C'
   ELSE TIP.PERIOD = 'D'
   end) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:32:53.913

So, tip.period is a null value that you're "defining" during the query?

```
SELECT 
    CASE 
        WHEN TIP.CENTRO IN ('L150','L180','L358')
        THEN 'C'
        ELSE 'D'
    END as period
from scott.tip 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T18:33:53.227

```
select TIP.PERIOD
from SCOTT.TIP  
where 
  TIP.PERIOD = 
    CASE
      WHEN TIP.CENTRO IN ('L150','L180','L358') THEN 'C'
      ELSE 'D'
    end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T18:36:14.230

对于完整的 Oracle 语法，您需要以下内容：

```
select TIP.PERIOD
from SCOTT.TIP
where (1=1) and (
 TIP.PERIOD =
   CASE WHEN TIP.CENTRO IN ('L150','L180','L358') THEN 'C' ELSE 'D' END 
```

# javascript - 如何在 d3 中指定轴刻度线的数量？

> ID：15531818
> 
> 赞同：4
> 
> 时间：2013-03-20T18:27:07.390
> 
> 标签：javascript, svg, d3.js

我在 d3 中创建了一个简单的条形图，并使用 '.ticks(3)' 格式化 y 轴，表示我希望看到 3 个刻度线。但是，根据数据，我有时会看到 3 个刻度线，有时会看到 4 个刻度线。此外，即使我确实得到 3 个刻度线，刻度线也位于轴标签上方的 1/4 左右，然后是 50%，然后是另一个在 3/4。如何强制 d3 设置 3 个轴标签，一个在底部，一个在中间，一个在顶部？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T19:20:39.683

您可以将刻度数组传递给轴，然后轴将在数组中的点处绘制刻度。

这是一些示例代码。创建一个在 0 到 100 之间运行的轴。根据“刻度”数组，刻度标记绘制在 0、50、60 和 100 处。

```
svg = d3.select("svg")

var myScale = d3.scale.linear()
        .domain([0,100])
        .range([0,400]);

var ticks = [0,50,60,100];

var myAxis = d3.svg.axis()
  .scale(myScale)
  .tickValues(ticks);

svg.append("g")
.attr("class", "axis")
.call(myAxis)
.attr("transform","translate(100,100)"); 
```

这是一个交互式示例： [http ://tributary.io/inlet/5207532](http://tributary.io/inlet/5207532)

# search - 谷歌自定义搜索检索所有结果，有可能吗？

> ID：15531822
> 
> 赞同：1
> 
> 时间：2013-03-20T18:27:22.453
> 
> 标签：search, google-custom-search

我开始使用 Google 自定义搜索引擎来检索在线报纸中某些选定单词的临时使用。例如，我看到我的结果提供了总共 22000 条检索到的文章。我试图检索 100 索引之后的页面，但我无法获得任何结果。我也尝试直接在谷歌网页上搜索，但我看到在第 10 页之后我不能再进一步了，所以这只会显示最大的前 1000 个结果。是否有可能检索每一个结果，或者我只能得到其中的一小部分？谢谢

# css - 在图像上浮动文本..如何将其对齐到右侧

> ID：15531825
> 
> 赞同：2
> 
> 时间：2013-03-20T18:27:28.277
> 
> 标签：css

我正在尝试在图像上浮动一些文本（价格）。图像始终具有相同的宽度和高度，但文本的长度可能不同。所以我试图在右侧始终保持相同的空间，并根据需要向左扩展文本。出于某种原因，我无法让它工作。它总是向右扩展开箱即用。有任何想法吗？

这是我的 HTML 代码：

```
<div class="productphoto">
<img src="photo.jpg">
<div class="pricetag">$1959.99</div>
</div> 
```

和CSS：

```
.productphoto { 
   position: relative; 
   width: 100%; /* for IE 6 */
}
.pricetag { 
   position: absolute;
   top: 190px; 
   left: 190px; 
   text-align:right;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:31:34.370

您需要将您的`.pricetag`相对位置放在右侧，而不是左侧：

```
.pricetag { 
   position: absolute;
   top: 190px; 
   right: 10px; /* NOT left: 190px; */ 
   text-align:right;
} 
```

[**演示**](http://jsfiddle.net/VQDWy/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:34:13.790

HTML: Text CSS:

```
.image {
    float: left;
}
.text {
    float: left;
    margin-left: 10px;
} 
```

Example - [http://jsfiddle.net/Hxcgs/](http://jsfiddle.net/Hxcgs/)

# perl - 将“文件名”从文本文件传递到命令行，其中文件的每一行都是文件名

> ID：15531828
> 
> 赞同：4
> 
> 时间：2013-03-20T18:27:41.737
> 
> 标签：perl, git, bash, repository

我正在运行以下代码

```
git log --pretty=format: --numstat -- SOMEFILENAME |
   perl -ane '$i += ($F[0]-$F[1]); END{print "changed: $i\n"}' \
      >> random.txt 
```

它的作用是获取一个名为“SOMEFILENAME”的文件，并将添加和删除行的总和保存到一个名为“random.txt”的文本文件中

我需要在存储库中的每个文件上运行这个程序，并且有很多它们。有什么简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:30:07.530

如果您想要每个文件的总数：

```
git log --pretty=format: --numstat |
   perl -ane'
      $c{$F[2]} += $F[0]-$F[1] if $F[2];
      END { print "$_\t$c{$_}\n" for sort keys %c }
   ' >random.txt 
```

如果你想要一个总数：

```
git log --pretty=format: --numstat |
   perl -ane'
      $c += $F[0]-$F[1];
      END { print "$c\n" }
   ' >random.txt 
```

他们各自的输出是：

```
.gitignore      22
Build.PL        48
CHANGES.txt     0
Changes 25
LICENSE 132
LICENSE.txt     0
MANIFEST        18
MANIFEST.SKIP   9
README.txt      67
TODO.txt        1
lib/feature/qw_comments.pm      129
lib/feature/qw_comments.xs      250
t/00_load.t     13
t/01_basic.t    85
t/02_pragma.t   56
t/03_line_numbers.t     37
t/04_errors.t   177
t/05-unicode.t  39
t/devel-pod-coverage.t  26
t/pod.t 17 
```

和

```
1151 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:44:41.567

而不是使用`find`，您可以使用名称（代表当前目录）`git`为您提供所有文件。`.`有了这个，这是一个使用`awk`打印每个文件的统计信息的版本：

```
git log --pretty=format: --numstat -- . |
awk '
    NF == 3 {changed[$3] += $1 - $2}
    END { for (name in changed) { printf("%s: %d changed\n", name, changed[name]); } }
' 
```

还有一个更短的打印单个整体更改的行：

```
git log --pretty=format: --numstat -- . |
awk '
    NF == 3 {changed += $1 - $2}
    END { printf("%d changed\n", changed); }
' 
```

（这`NF == 3`是为了解释`git`似乎在其输出中打印虚假空行的事实。我没有试图弄清楚是否有更好的`git`命令。）

# iphone - 以编程方式关闭拆分键盘

> ID：15531830
> 
> 赞同：0
> 
> 时间：2013-03-20T18:27:47.717
> 
> 标签：iphone, objective-c, keyboard

有没有办法以编程方式关闭键盘拆分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:35:16.817

据我所知，您无法锁定默认的 iPad 键盘滚动动作。

您可以管理其其他功能，例如键盘类型，还可以创建自定义 uikeyboard。

请查看[这篇](https://stackoverflow.com/questions/2275685/creating-a-custom-uikeyboard-for-iphone)讨论**创建自定义 uikeyboard 的帖子**

但是，请查看此代码并尝试实现您的目标

```
 //The UIWindow that contains the keyboard view - It some situations it will be better to actually
    //iterate through each window to figure out where the keyboard is, but In my applications case
    //I know that the second window has the keyboard so I just reference it directly
    UIWindow* tempWindow = [[[UIApplication sharedApplication] windows] objectAtIndex:1];

    //Because we cant get access to the UIKeyboard throught the SDK we will just use UIView. 
    //UIKeyboard is a subclass of UIView anyways
    UIView* keyboard;

    //Iterate though each view inside of the selected Window
    for(int i = 0; i < [tempWindow.subviews count]; i++)
    {
        //Get a reference of the current view 
        keyboard = [tempWindow.subviews objectAtIndex:i];

        //Check to see if the className of the view we have referenced is \"UIKeyboard\" if so then we found
        //the keyboard view that we were looking for
        if([[keyboard className] isEqualToString:@\"UIKeyboard\"] == YES)
        {
            //Keyboard is now a UIView reference to the UIKeyboard we want. From here we can add a subview
            //to th keyboard like a new button

            //Do what ever you want to do to your keyboard here...
        }
    } 
```

# ruby-on-rails - Rails 路由和控制器模块-命名空间？

> ID：15531834
> 
> 赞同：4
> 
> 时间：2013-03-20T18:28:04.153
> 
> 标签：ruby-on-rails

我无法为我的控制器创建一个模块，并让我的路由指向控制器中的那个模块。

收到此错误：

```
Routing Error
uninitialized constant Api::Fb 
```

所以，这就是我的路线设置方式：

```
namespace :api do
  namespace :fb do
    post :login
    resources :my_lists do
      resources :my_wishes
    end
  end
end 
```

在我的 fb_controller 中，我想包含可以给我这样的路径的模块：

```
/api/fb/my_lists 
```

这是我的一些 fb_controller：

```
class Api::FbController < ApplicationController
  skip_before_filter :authenticate_user!, :only => [:login]

  include MyLists # <-- This is where i want to include the /my_lists
                  # namespace(currently not working, and gives me error 
                  # mentioned above)

  def login
    #loads of logic
  end
end 
```

MyLists.rb 文件（我在其中定义一个模块）与 fb_controller.rb 位于同一目录中。

如何让命名空间指向 fb_controller 内部的模块，例如 /api/fb/my_lists ？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-20T18:40:02.907

您设置的命名空间正在寻找一个看起来像这样的控制器类

`class Api::Fb::MyListsController`

如果你想要一个看起来像的路线，`/api/fb/my_lists`但你仍然想使用`FbController`而不是`MyListsController`你需要设置你的路线看起来像这样

```
namespace :api do
  scope "/fb" do
    resources :my_lists, :controller => 'fb'
  end
end 
```

在我看来，而不是`MyLists`在你的模块中包含一个模块`FbController`似乎有点尴尬。

我可能会做的是有一个`FB`带有通用 FbController 的模块，然后有`MyListsController < FbController`. 无论如何，这超出了您的问题范围。

以上应该可以满足您的需求。

**编辑**

根据您的评论，以及我对您正在尝试执行的操作的假设，这是一个小例子：

**配置/路由.rb**

```
namespace :api do
  scope "/fb" do
    post "login" => "fb#login"
    # some fb controller specific routes
    resources :my_lists
  end
end 
```

**api/fb/fb_controller.rb**

```
class Api::FbController < ApiController
  # some facebook specific logic like authorization and such.
  def login
  end
end 
```

**api/fb/my_lists_controller.rb**

```
class Api::MyListsController < Api::FbController
  def create
    # Here the controller should gather the parameters and call the model's create
  end
end 
```

现在，如果您只想创建一个`MyList`对象，那么您可以直接对模型执行逻辑。另一方面，如果您想要处理更多逻辑，您希望将该逻辑放入一个服务对象中，该服务对象处理 MyList 及其关联的 Wishes 或您的`MyList`模型的创建。不过，我可能会选择服务对象。请注意，服务对象应该是一个类而不是一个模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:43:30.450

在您的示例中，`Fb`它不是名称空间，而是控制器。命名空间调用迫使您的应用程序查找`Fb`不存在的模块。尝试像这样设置您的路线：

```
namespace :api do
  resource :fb do
    post :login
    resources :my_lists do
      resources :my_wishes
    end
  end
end 
```

您可以选择为 API 命名空间定义一个新的基本控制器：

```
# app/controllers/api/base_controller.rb
class Api::BaseController < ApplicationController
end 
```

如果你这样做，你的其他控制器可以从这里继承：

```
# app/controllers/api/fb_controller.rb
class Api::FbController < Api::BaseController
end 
```

运行`rake routes`应该让您了解其他控制器的布局方式。只是一个警告-通常不建议将资源嵌套深度超过 1 层（您最终会遇到复杂的路径，例如`edit_api_fb_my_list_my_wish_path`）。如果你能以更简单的方式来构建它，你可能会更轻松。

# vsto - 访问电子邮件表单的控制事件

> ID：15531836
> 
> 赞同：1
> 
> 时间：2013-03-20T18:28:08.573
> 
> 标签：vsto, office-interop, office-2010

我正在尝试为需要处理控制更改的 Outlook 开发附加组件。

例如，当电子邮件主题更改时，我需要做一些事情。为此，我需要访问主题 texbox 的文本更改事件。

我只是想知道是否有人做过这样的事情？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:40:16.213

检查[PropertyChange 事件](http://msdn.microsoft.com/en-us/library/office/aa171326%28v=office.11%29.aspx)：

> 在更改 Microsoft Outlook 项目的标准属性（例如，主题或收件人）时发生。属性名称被传递给事件，以便您可以确定更改了哪个属性。

# jboss - 配置 Arquillian 以测试 Tomcat 管理的数据源

> ID：15531837
> 
> 赞同：1
> 
> 时间：2013-03-20T18:28:13.343
> 
> 标签：jboss, junit, jboss-arquillian

为方法编写 JUnit 测试用例`findByFK`。此方法从容器管理的数据源获取数据库连接。我正试图在 Arquillian 的帮助下解决它。我对 JUnit 还很陌生，在 Arquillian 工作了 2 小时。
我刚刚添加到我的班级：

```
@RunWith(Arquillian.class) 
```

我还需要做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T09:29:32.137

我强烈建议您查看[Arquillian 网站上的指南](http://arquillian.org/guides/)。它们对您需要了解的所有机制进行了温和的介绍。还有一个是关于测试 jpa 相关逻辑的。

# cxf - 将 CXF Web 服务客户端应用程序部署到 weblogic 9.2 时出错

> ID：15531842
> 
> 赞同：0
> 
> 时间：2013-03-20T18:28:26.527
> 
> 标签：cxf, weblogic9.x

为什么我在将 CXF Web 服务客户端应用程序部署到 weblogic 9.2 时看到这个

```
Caused by NoClassDefFoundError: null
-&gt;&gt;  350 | newInstance0   in java.lang.Class
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|    303 | newInstance    in     &#39;&#39;
|     36 | newInstance .  in javax.xml.ws.spi.FactoryFinder
|     95 | find           in     &#39;&#39;
|     82 | provider . . . in javax.xml.ws.spi.Provider
|     56 | &lt;init&gt;         in javax.xml.ws.Service 
```

使用带有 Java HotSpot(TM) 服务器 VM 版本 1.5.0_10-b03 的 WebLogic Server 运行

部署有 jaxws-rt-2.1.3.jar 和 com/sun/xml/ws/spi/ProviderImpl.class 部署有 cxf-rt-frontend-jaxws-2.1.3.jar 和 org/apache/cxf/jaxws /spi/ProviderImpl

当这些依赖项丢失时，我发现了这个问题，但在这种情况下它们并没有丢失。

我确实使用 WEB-INF/weblogic.xml 部署战争

```
<?xml version="1.0" encoding="UTF-8"?>
    <weblogic-web-app
        xmlns="http://www.bea.com/ns/weblogic/90"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.bea.com/ns/weblogic/90 
        http://www.bea.com/ns/weblogic/90/weblogic-web-app.xsd">
    <container-descriptor>
        <prefer-web-inf-classes>true</prefer-web-inf-classes>
    </container-descriptor>
</weblogic-web-app> 
```

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T19:56:16.147

我在应用程序 WEB-INF 中发现了两个不兼容的 jar，因为它们都实现了类

```
javax.xml.ws.spi.FactoryFinder
javax.xml.ws.spi.Provider
javax.xml.ws.Service 
```

两个冲突的罐子是

```
jaxws-api-2.1.jar
geronimo-jaxws_2.2_spec-1.0.jar 
```

我删除了 jaxws-api-2.1.jar 并能够解决这个问题。

# asp.net-mvc - 构建视图模型的最佳方法是什么？

> ID：15531846
> 
> 赞同：6
> 
> 时间：2013-03-20T18:28:45.720
> 
> 标签：asp.net-mvc, entity-framework, domain-driven-design, viewmodel, repository-pattern

我正在使用带有实体框架的 asp.net mvc 并开始学习 DDD。我正在从事包含调查的项目。这是我的域模型：

```
public class Survey
{
    public int? SurveyID { get; set; }
    public string Name { get; set; }
    public decimal MinAcceptanceScore { get; set; }
    public int UserFailsCount { get; set; }

    public IEnumerable<SurveyQuestion> Questions { get; set; }
    public IEnumerable<Prize> Prizes { get; set; }
    public IEnumerable<SurveyAttempt> UserAttempts { get; set; }
} 
```

我需要针对不同视图进行不同部分的调查，因此我创建了不同的 ViewModel：

```
 public class ShortSurveyViewModel
    {
        public int? SurveyID { get; set; }
        public string Name { get; set; }
        public int UserFailsCount { get; set; }
        public IEnumerable<SurveyAttempt> UserAttempts { get; set; }
    }

    public class ShortSurveyWithPrizesViewModel
    {
        public int? SurveyID { get; set; }
        public string Name { get; set; }
        public int UserFailsCount { get; set; }
        public IEnumerable<SurveyAttempt> UserAttempts { get; set; }
        public IEnumerable<Prize> Prizes { get; set; }
    }

    public class SurveyEditViewModel
    {
        public int? SurveyID { get; set; }
        public string Name { get; set; }
        public decimal MinAcceptanceScore { get; set; }
        public int UserFailsCount { get; set; }

        public IEnumerable<SurveyQuestion> Questions { get; set; }
        public IEnumerable<Prize> Prizes { get; set; }
    } 
```

如果我希望我的调查存储库获取适当视图模型所需的信息，那么构建我的架构的最佳方式是什么？

我看到的不同解决方案：

1.  Repository 可以将 IQueryable 返回到 SurveyService 并且 service 可以返回适当的视图模型，但我犹豫这样做是否正确，因为我认为视图模型应该在 UI 中创建，而不是在服务层中创建。

2.  在我的领域层中创建三个适当的类。但是现在域将依赖于表示，并且每个新视图都应该创建新的域类。

3.  检索完整的域对象并仅映射特定视图所需的属性。这不好，因为在我的示例中，问题只需要一种表示形式，并且可能是大量收集。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T19:16:55.497

领域驱动设计：

*   您应该有一个返回聚合根的存储库 - 在您的情况下`Survey`以及所有没有父级就无法存在的关系`Survey`
*   该存储库将始终加载整个`Survey`类，并且根据您的要求仅加载一些关系（真正教条的 DDD 将始终加载整个聚合，但这对于无状态 Web 来说不是一个好方法）。
*   您的应用程序层（控制器）将向存储库询问`Survey`和选择关系并填充视图模型。

洋葱架构：

*   您将创建一些暴露的存储库`IQueryable<Survey>`- 更糟糕的是，您将使用带有 CRUD 接口的通用存储库
*   您将创建一些服务调用存储库并将 Linq-to-entities 投影构建到您的 DTO 中并将它们返回到应用程序层（控制器）
*   怎么办？您可以直接使用这些 DTO，也可以使用另一组对象作为您的视图模型以及一些与 UI 相关的属性等。显然有问题......

简单的架构：

*   您将直接在控制器中使用注入`IDbSet<Survey>`作为存储库
*   您将直接在控制器中进行 Linq 到实体的投影以填充视图模型

没有最好的办法。它始终与您的目标和期望有关。对于小型应用程序，您可以毫无问题地使用简单的架构。

领域驱动设计更复杂。DDD 中的主要概念是领域实体、值对象及其组合。域实体封装了数据和在这些数据上执行的逻辑。DDD 不适用于部分数据或 DTO - 当您的域实体没有任何逻辑时，您做错了（称为贫血模型）。DDD 中的服务不是应用层和存储库之间的中介。它用于处理与单个域实体无关的业务逻辑（因此不能封装在域实体中）。存储库是从存储中实现聚合并将它们持久保存在存储中所需的基础架构代码。应用程序逻辑（控制器）可以与域实体、服务和基础设施代码进行交互。

我不喜欢洋葱架构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:52:18.470

考虑到您主要关心的是从数据模型中检索到的数据量与视图模型中所需的数据量，我想说对您来说正确的方法是在数据库及其各自的数据模型中构建视图.

这将允许您在任何一次旅行中修剪从数据库中利用的数据量。

尽管数据模型几乎可以模仿视图模型，但这不是问题，它们有两个不同的目的。View Model 是为 View 绑定的——Data Model 知道如何获取和保存数据。构建这些视图将使您能够以最佳方式获取数据 - 同时在这些相同模型中容纳自定义保存逻辑以使它们在必要时可写 - 因此需要数据模型过去将数据从一层移动到下一层。

# xml - 在 Wix 安装程序上添加 .Net Framework 会重复安装程序

> ID：15531850
> 
> 赞同：0
> 
> 时间：2013-03-20T18:29:00.160
> 
> 标签：xml, visual-studio-2010, installation, wix, wix3.5

我正在部署一个简单的`.MSI`安装程序。但是，作为测试，我想把它作为先决条件`Microsoft .Net Framework 4.0`，所以我把这个写在我的`.wixproj`：

```
 <ItemGroup>
      <BootstrapperFile Include=".NETFramework,Version=v4.0">
         <ProductName>.NET Framework 4.0</ProductName>
      </BootstrapperFile>
      <Bootstra pperFile Include="Microsoft.Windows.Installer.4.5">
         <ProductName>Windows Installer 4.5</ProductName>
      </BootstrapperFile>
  </ItemGroup> 
```

和：

```
<Target Name="AfterBuild">
    <GenerateBootstrapper ApplicationFile="InstallTest" ApplicationName="Face Phi Install Test" BootstrapperItems="@(BootstrapperFile)" ComponentsLocation="Relative" CopyComponents="True" OutputPath="$(OutputPath)" Path="C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bootstrapper\" />
</Target> 
```

在我的`.wxs`项目中，我写了这个：

```
<PropertyRef Id="NETFRAMEWORK40FULL"/> 
```

这很好用，我可以`.Net Framework 4.0`作为先决条件，不允许安装继续进行。但是当我生成我的 时`SetupProject`，我可以看到两个安装程序：

![在此处输入图像描述](../Images/259559be81f41b0d231acf880f0b2a9e.png)

1.  `InstallTest.msi`是我在我的`.wxs`项目中生成的。第二个，不知道出处。**我怎样才能只有一个安装程序并将其连接到我的先决条件？**
2.  **如何自动安装 .Net Framework，而不是取消安装？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T17:43:36.980

`setup.exe`由您的构建`GenerateBootstrapper`任务创建，并包含安装您按`BootstrapperFile`元素选择的包的逻辑。但是，这不包括您的 InstallTest.msi。

为此，您需要创建一个引导程序包，它是一个包含 msi 文件和几个 xml 文件的目录结构。看看`C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bootstrapper\Packages`例子。您可以手动设计一个并使用构建任务将其复制到该 Packages 文件夹中。Microsoft 的非正式工具[Bootstrapper Manifest Generator](http://archive.msdn.microsoft.com/bmg/Release/ProjectReleases.aspx?ReleaseId=1567)在设计和复制包时也有帮助，并且可以从构建任务中调用。

一旦你有了一个安装所有包的 setup.exe，你可能希望将所有文件放入一个自解压文件中，例如 WinRAR 或 WinZip。我使用了一个非常基本的 NSIS 安装程序，因为它允许我创建一个具有专业外观的自定义欢迎屏幕。

## 选择

升级到 WiX 3.7 并使用**WiX Bootstrapper**项目（又名 Burn 项目），而不是 Visual Studio 引导程序。缺点是在其系统下安装依赖项的脚本尚未广泛使用，尽管 .NET 的脚本在文档中。[请参阅主题“如何：使用 Burn 安装 .NET Framework”。] Burn 的众多优点之一是它也是一个自解压存档。

# python - 属性还是方法？

> ID：15531852
> 
> 赞同：6
> 
> 时间：2013-03-20T18:29:03.407
> 
> 标签：python, class, methods, attributes

我正在编写一个 python 脚本，它根据两个参数计算各种数量，即球体的长半径和短半径。我突然想到我可以编写一个球体类来做到这一点。但是，我是面向对象设计的新手，想知道您是否更有经验的小伙子可以帮助我。

一个实例分别用参数 a 和 b 为长半径和短半径实例化，所以我设计的类如下：

```
class Spheroid:
  def __init__(self,a,b):
    self.longax  = a
    self.shortax = b 
```

我要计算的数量之一是体积。球体的体积为 4*pi/3 * a * b * b。

我的问题是，我是否在我的类中为此定义了方法或属性？

例如我可以定义一个方法：

```
def Volume(self):
  return 4*pi/3 * self.longax * self.shortax * self.shortax 
```

或者我可以只使用一个属性：

```
self.volume = 4*pi/3 * self.longax * self.shortax * self.shortax 
```

我也可以将它包含在 init 方法中：

```
class Spheroid:
  def __init__(self,a,b):
    self.longax  = a
    self.shortax = b
    self.volume = 4*pi/3 * a * b * b. 
```

哪个更好用，为什么？一般来说，我什么时候使用方法，什么时候使用属性？我通常不会在意，但我有一大堆要实现的东西，我想对 OO 设计有一个想法，以供将来参考。

谢谢

编辑：

在按照 Martijn 的建议实现属性后，我得到了这样的结果：

```
class Spheroid(object):
  def __init__(self,a,b):
    self.shortax = a
    self.longax  = b
    self.alpha=self.longax/self.shortax

    @property
    def volume(self):
        return (4*np.pi/3) * self.shortax * self.shortax * self.longax

    @property
    def epsilon(self):
        return np.sqrt(1-self.alpha**(-2))

    @property
    def geometricaspect(self):
        return 0.5 + np.arcsin(self.epsilon)*0.5*self.alpha/self.epsilon

    @property
    def surfacearea(self):
        return 4*np.pi*self.shortax**2*self.geometricaspect 
```

我实例化了一个实例 s = Spheroid() 但每当我尝试像 s.volume 或 s.epsilon 这样的东西时，我都会得到一个 AttributeError：

AttributeError：“球体”对象没有属性“体积”

我在这里做错了什么？

另外，在我的**初始化**方法中，我使用了 self.alpha = self.longax/self.shortax 而不是 a/b，这有什么区别吗？一种方式更可取吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T18:31:32.840

[您有第三个选择：通过使用属性](http://docs.python.org/3/library/functions.html#property)使其既是属性又是方法：

```
class Spheroid(object):
    def __init__(self, a, b):
        self.long  = a
        self.short = b

    @property
    def volume(self):
        return 4 * pi / 3 * self.long * self.short * self.short 
```

您可以`.volume`像属性一样访问：

```
>>> s = Spheroid(2, 3)
>>> s.volume
75.39822368615503 
```

为了使`property`描述符正常工作，在 Python 2 中，您需要确保您的类继承自`object`; 在 Python 3 中，可以安全地省略基类。

在这种情况下，体积的计算足够便宜，但是属性可以让您*推迟*计算体积，直到您真正需要它。

上面的例子创建了一个只读属性；只定义了一个 getter：

```
>>> s.volume = None
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: can't set attribute 
```

您可以轻松地缓存属性计算的结果：

```
class Spheroid(object):
    _volume = None

    def __init__(self, a, b):
        self.long  = a
        self.short = b

    @property
    def volume(self):
        if self._volume is None:
            self._volume = 4 * pi / 3 * self.long * self.short * self.short
        return self._volume 
```

这样您每个实例只需计算*一次。*`Spheroid`

您使用什么取决于许多因素；您的 API 需要使用起来有多容易，计算体积的频率，将创建*多少*个 Spheroid 实例等。如果您在循环中创建一百万个，但只需要其中少数几个的体积，使用属性而不是在`__init__`.

但是，如果您的班级可以根据音量自行*调整；*比如说，通过自动调整一个半径，那么 a`@property`仍然更有意义：

```
class Spheroid(object):
    def __init__(self, a, b):
        self.long  = a
        self.short = b

    @property
    def volume(self):
        return 4 * pi / 3 * self.long * self.short * self.short

    @volume.setter
    def volume(self, newvolume):
        # adjust the short radius
        self.short = sqrt(newvolume / (4 * pi / 3 * self.long)) 
```

*现在*你有一个球体，当你调整音量时，它会自然地调整它的短属性：

```
>>> s = Spheroid(2, 1)
>>> s.volume
8.377580409572781
>>> s.volume = 75.39822368615503
>>> s.long, s.short
(2, 3.0) 
```

注意：从技术上讲，您在带有符号的对象上访问的*任何内容都是属性；*`.name`包括的方法。出于此答案的目的，我将您`attribute`用作未调用的任何值（不在`()`名称后使用）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T18:32:38.260

你会一直使用这些数据吗？

如果没有，你可以使用一个属性，然后懒惰地计算它......

```
class Spheroid(object):
  def __init__(self,a,b):
    self.longax  = a
    self.shortax = b
    self._volume = None

  @property
  def volume(self):
      if self._volume is None :
           self._volume = 4*pi/3 * self.longax * self.shortax * self.shortax
      return self._volume 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T18:34:44.720

由于以下原因，我会将音量作为一种方法来实现：

1.  它可以从其他属性计算，因此可以节省计算空间（除非这是非常复杂的计算并且您可以考虑缓存它）
2.  它不是对象的自然“特征”，例如对于圆，半径是属性而不是区域（这不是真正的格式定义）
3.  如果您想拥有一系列对象并以多态方式计算每个对象的体积，那么像体积之类的东西是一种抽象方法。

# ruby-on-rails - 乘客在 Apache 上运行失败——无法启动 Web 应用程序

> ID：15531855
> 
> 赞同：0
> 
> 时间：2013-03-20T18:29:06.727
> 
> 标签：ruby-on-rails, ruby, apache, passenger

我有乘客 + apache 的问题，我已经设置了一个虚拟主机...

```
<VirtualHost *:80>
  ServerName www.temazo.es
  PassengerEnabled on
  PassengerAppRoot /home/handra/ruby/temazo
  RailsEnv development
  # !!! Be sure to point DocumentRoot to 'public'!
  DocumentRoot /home/handra/ruby/temazo/public
  ErrorLog /home/handra/ruby/temazo/log/fails
  <Directory /home/handra/ruby/temazo/public>
     # This relaxes Apache security settings.
     AllowOverride all
     # MultiViews must be turned off.
     Options -MultiViews
  </Directory> 
```

现在，如果我转到 www.temazo.es 并单击“关于您的应用程序的环境”，则会返回此错误... [http://www.temazo.es/rails/info/properties](http://www.temazo.es/rails/info/properties)

但是，如果我执行 rails server... 然后我去[http://www.temazo.es:3000/](http://www.temazo.es:3000/)，那效果很好，并返回给我所有的 ruby​​ conf。

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:35:13.003

In your gemfile, you should have this line :

```
# gem 'therubyracer', platforms: :ruby 
```

Uncomment it, and run `bundle install`, then deploy your app again.

You need a javascript runtime installed on your server so the javascript can be compiled and ran.

# doctrine-orm - ZF2 Doctrine2 表单验证 NoObjectExists

> ID：15531856
> 
> 赞同：1
> 
> 时间：2013-03-20T18:29:09.807
> 
> 标签：doctrine-orm, zend-framework2

我正在使用 \DoctrineModule\Validator\NoObjectExists 来验证我的表单提交。但是，就像 ZendDB 适配器一样，我需要排除 FieldX 等于 SomethingX 的所有行。

我怎样才能做到这一点？

这是我的表格，过滤输入：

```
$filter->add(
        $factory->createInput(array(
            'name' => 'example',
            'required' => false,
            'validators' => array(
                array(
                    'name' => '\DoctrineModule\Validator\NoObjectExists',
                    'options' => array(
                        'object_repository' => $this->mainRepository,
                        'fields' => 'example'
                    ),
                ),
            ),
        ))
); 
```

谢谢。

# flash - 带有清除按钮的 Actionscript 绘图

> ID：15531863
> 
> 赞同：0
> 
> 时间：2013-03-20T18:29:33.347
> 
> 标签：flash, button, actionscript, ellipse

我正在学习一本书中 Actionscript 教室的第 4 课示例，但通过在舞台上添加一个 CLEAR 按钮来修改它。

每当我测试所有功能时，我都可以在按钮顶部进行绘制。理想情况下，当用户绘制时，颜色应该位于按钮下方。

在时间轴中，我有背景层、按钮层和动作层。我在下面添加了代码以帮助更快地解决问题。谢谢！

```
package  {

import flash.display.MovieClip;

    public class Ellipse extends MovieClip {

        // constructor
        public function Ellipse(w:Number=40,h:Number=40,color:Number=0xff0000) {
            graphics.beginFill(color);
            graphics.drawEllipse(0, 0, w, h);
            graphics.endFill();
        }

    } // end class Ellipse

} // end package

import flash.events.MouseEvent;

var color:Number;
stage.addEventListener(MouseEvent.MOUSE_DOWN, startDrawing);
stage.addEventListener(MouseEvent.MOUSE_UP, stopDrawing);

function startDrawing(e:MouseEvent):void {
stage.addEventListener(MouseEvent.MOUSE_MOVE, makeShapes);
color = Math.random() * 0xFFFFFF;
}

function stopDrawing(e:MouseEvent):void {
stage.removeEventListener(MouseEvent.MOUSE_MOVE, makeShapes);
}

function makeShapes(e:MouseEvent):void {
var ellipse:Ellipse = new Ellipse(10, 10, color);
stage.addChild(ellipse);
ellipse.x = mouseX;
ellipse.y = mouseY;
}

btnClear.addEventListener(MouseEvent.CLICK, clearBoard);

function clearBoard(e:MouseEvent)
{
    for (var i:int = stage.numChildren-1; i >= 1; i--) {
   stage.removeChildAt (i);
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T21:54:03.633

`addChild`将项目添加到显示列表的顶部，因此当您将椭圆添加到舞台时，您会将它们添加到按钮和电影的前面。也就是说，您的电影（带有按钮）位于索引 0 处，但您的形状添加到索引 1 或更高处。一种解决方案是将它们添加到电影下方，使用`addChildAt`：

```
var shapeIndex:uint = 0;
function makeShapes(e:MouseEvent):void {
    var ellipse:Ellipse = new Ellipse(10, 10, color);
    stage.addChildAt(ellipse, shapeIndex); // add the shape starting at 0, and count up from there
    // this will keep the movie at the top of the stage's display list
    shapeIndex++;
    ellipse.x = mouseX;
    ellipse.y = mouseY;
} 
```

另一种解决方案是首先制作一个容器剪辑，然后将形状添加到此容器剪辑中。这使您可以轻松控制形状出现的位置：

```
var container : Sprite = new Sprite();
stage.addChildAt(container, 0); // add the container to the bottom of the stage
// now we can just easily add our shapes to the container, and they will all be behind the main movie.
function makeShapes(e:MouseEvent):void {
    var ellipse:Ellipse = new Ellipse(10, 10, color);
    container.addChild(ellipse);
    shapeIndex++;
    ellipse.x = mouseX;
    ellipse.y = mouseY;
} 
```

这实际上使其他事情变得更容易，例如清除屏幕。您可以简单地删除并重新创建容器剪辑：

```
function clearBoard(e:MouseEvent)
{
    stage.removeChild(container);
    container = new Sprite();
    stage.addChildAt(container, 0);
} 
```

# sql - PHP 数据库查询 - 按月分组

> ID：15531865
> 
> 赞同：0
> 
> 时间：2013-03-20T18:29:44.297
> 
> 标签：sql, sql-server

根据建议进行编辑：

```
$sql=
    "SELECT SysproCompanyJ.dbo.InvMovements.StockCode,
    SysproCompanyJ.dbo.InvMaster.Description,
    SysproCompanyJ.dbo.InvMovements.TrnYear,
    SysproCompanyJ.dbo.InvMovements.Warehouse,
    SysproCompanyJ.dbo.InvMovements.TrnMonth,
    SysproCompanyJ.dbo.InvMovements.TrnQty,
    SysproCompanyJ.dbo.InvMovements.TrnValue

    FROM SysproCompanyJ.dbo.InvMovements,
         SysproCompanyJ.dbo.InvMaster

    WHERE SysproCompanyJ.dbo.InvMovements.StockCode = SysproCompanyJ.dbo.InvMaster.StockCode
        AND SysproCompanyJ.dbo.InvMovements.Warehouse = 'S2'

    GROUP BY SysproCompanyJ.dbo.InvMovements.TrnMonth"; 
```

示例数据库数据将是：

```
Stockcode |   Description   | TrnYear | Warehouse | TrnMonth | TrnQty | TrnValue
    PN1   | Part Number 1   |   2013  |    S2     |     1    |   100  |  10.00
    PN2   | Part Number 2   |   2013  |    S2     |     1    |   200  | 125.00
    PN3   | Part Number 3   |   2013  |    S2     |     1    |   200  |  60.00
    PN1   | Part Number 1   |   2013  |    S2     |     2    |   300  | 560.00
    PN4   | Part Number 4   |   2013  |    S2     |     2    |   400  |  30.00
    PN5   | Part Number 5   |   2013  |    S2     |     2    |   100  | 230.00 
```

我试图将数据分解为按月分组的单独表，然后有一个变量来按月对总 TrnValue 求和。

当前查询按原样给出以下错误

警告：odbc_exec() [function.odbc-exec]：SQL 错误：[Microsoft][ODBC SQL Server Driver][SQL Server]Column 'SysproCompanyJ.dbo.InvMovements.StockCode' 在选择列表中无效，因为它不包含在内在聚合函数或 GROUP BY 子句中。第 69 行 C:\wamp\www\dacs\S2_2.php 中的 SQLExecDirect 中的 SQL 状态 37000

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T20:16:54.577

您不能在 select 语句中使用列，除非它们位于聚合函数 (min,max,sum,count,...) 中或包含在 Group By 中。

尝试这样的事情：

```
SELECT  SysproCompanyJ.dbo.InvMovements.Warehouse,
        SysproCompanyJ.dbo.InvMovements.TrnYear,
        SysproCompanyJ.dbo.InvMovements.TrnMonth,
        Sum(SysproCompanyJ.dbo.InvMovements.TrnQty) as sum_TrnQty,
        Sum(SysproCompanyJ.dbo.InvMovements.TrnValue) as sum_TrnValue

FROM    SysproCompanyJ.dbo.InvMovements,
        SysproCompanyJ.dbo.InvMaster

WHERE   SysproCompanyJ.dbo.InvMovements.StockCode = SysproCompanyJ.dbo.InvMaster.StockCode
        AND SysproCompanyJ.dbo.InvMovements.Warehouse = 'S2'

GROUP BY SysproCompanyJ.dbo.InvMovements.Warehouse,
        SysproCompanyJ.dbo.InvMovements.TrnYear,
        SysproCompanyJ.dbo.InvMovements.TrnMonth 
```

通常在任何类型的聚合中包含 varchar 列（Stockcode、Description）是没有意义的，并且由于它们是不同的值，因此您可能也不希望它们在 Group By 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:26:21.490

在 SQL 查询中使用`GROUP BY`时，显示的所有字段都应按“分组”或计算（聚合）值。

例如;

```
SELECT city, count(*), avg(price) FROM properties GROUP BY city; 
```

这会产生类似的东西；

```
 City   |  count  |   Avg
 Paris  |  3      |   166.666 
```

将计算每个城市的行数。城市是“分组依据”的一部分。'count(*)' 和 'avg(price)' 是计算列（聚合）。

如果我们要在查询中引入另一列，“城市”；

```
SELECT country, city, count(*), avg(price) FROM properties GROUP BY city; 
```

该查询会出错，因为`country`既不是“分组”也不是计算值。这个错误很合乎逻辑；城市名称在全球范围内不是唯一的（例如“Paris”美国和“Paris”在法国），因此仅按城市分组，数据库无法显示唯一的国家名称。

要解决此问题，请在分组依据中包含“国家”，或将其设为计算字段；

```
SELECT country, city, count(*), avg(price) FROM properties GROUP BY country, city; 
```

将返回按国家分组的结果，然后按城市分组

```
Country   | City   |  count  |   Avg
USA       | Paris  |  1      |   100.000
France    | Paris  |  2      |   200.000 
```

使用国家的计算值；

```
SELECT min(country), city, count(*), avg(price) FROM properties GROUP BY country, city; 
```

将返回按城市分组的结果，以及组中的“第一个”国家：

```
min(Country)| City   |  count  |   Avg
France      | Paris  |  3      |   166.666 
```

这可能不合逻辑；结果显示“法国”，但它包括来自美国巴黎的结果

# swing - JPA+Swing 有没有办法使用单个连接？

> ID：15531866
> 
> 赞同：0
> 
> 时间：2013-03-20T18:29:46.270
> 
> 标签：swing, jpa

我正在将 Oracle Forms 代码的一部分重写为 Java Swing 作为演示（只是为了让 Oracle 人员了解它的外观和感觉）。我宁愿使用 JPA 而不是直接使用 JDBC。

问题是，（与任何 Oracle Forms 应用程序一样，我猜）每个应用程序用户都有一个单独的 Oracle 帐户/模式，并且该程序严重依赖于通过 Oracle 会话绑定包变量来跟踪内容。当他们决定是想要 Web 应用程序还是桌面应用程序时，他们可能不得不做出艰难的决定并切换到不同的模型，但现在我必须打出我已经拿到的牌。

那么 - 有没有办法配置 Hibernate（或任何其他）JPA 以便它与单个 Connection 对象一起工作（并尝试重新连接以防它被丢弃）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T13:49:06.787

在您使用 EclipseLink 时，您有几个选项。一种是使用Oracle代理认证，另一种是给每个EntityManager连接一个用户ID。

见， [http://wiki.eclipse.org/EclipseLink/Examples/JPA/Auditing](http://wiki.eclipse.org/EclipseLink/Examples/JPA/Auditing)

# c - 如何打印指针指向的一定数量的字节（字符）

> ID：15531869
> 
> 赞同：1
> 
> 时间：2013-03-20T18:29:57.793
> 
> 标签：c

我有一个指向 20 字节内存的指针，然后将某些内容复制到内存中

```
u_char* pkt=malloc(20);
memcpy(pkt, somecontent, 20); 
```

我想检查从 pkt 开始的 20 个字节，所以我想打印所有字节，其格式类似于`0xa6` 如何用 C 语言执行此操作

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:31:30.410

尝试[`printf`](http://www.acm.uiuc.edu/webmonkeys/book/c_guide/2.12.html#printf)：

```
int i=0;
for (; i<20; i++)
  printf("0x%.2x ", pkt[i]);
printf("\n"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:34:36.723

以下代码就足够了，

```
int i=0;
u_char  * ptr=pkt;
for (; i<20; i++)
  printf("%x ", ptr++);
printf("\n"); 
```

# php - 在排序中写入帖子错误

> ID：15531870
> 
> 赞同：0
> 
> 时间：2013-03-20T18:29:59.160
> 
> 标签：php, mysql, http-post, user-profile, posting

您好，此代码用于在用户个人资料中写帖子代码正确且没有任何错误，但是在写帖子时我有错误新帖子将是最后一个帖子我的意思是我在排序时出错了如何修复以制作新帖子它的第一篇文章，如 facebook 或任何社交网络

```
<?php
if (isset ($_SESSION['user_login']))
{
    $user = $_SESSION["user_login"];`enter code here`
}
else
{
$user = "";
}
    $date_added = date ("Y-m-d");
    $added_by =$user;
    $user_posted_to = '';   

$post = @$_POST['post'];

if ($post != '')
   {
    $date_added = date ("Y-m-d");
    $added_by = $user;
    $user_posted_to = $user;
    $sqlCommand = "INSERT INTO posts (id,body,date_added,added_by,user_posted_to) VALUES ('','$post','$date_added','$added_by','$user_posted_to')";
    $query = mysql_query ($sqlCommand) or die (mysql_error());

    $getposts = mysql_query("SELECT * FROM posts WHERE user_posted_to ='$user' ") or die(mysql_error());
    while ($row = mysql_fetch_assoc($getposts)) 
                    {
                    $id = $row['id'];
                    $body = $row['body'];   
                    $date_added = $row['date_added'];
                    $added_by = $row['added_by'];
                    $user_posted_to = $row['user_posted_to'];  

                 echo "

                    <div class='posted_by'>
                    Posted by:
                                            <a href='$added_by'>$added_by</a> on $date_added</div>
                                            <br />
                                            <div  style='max-width: 600px;'>
                                            $body<br /><p />
                                            </div></br>
                                            <hr />
                    ";
                    }
   }
else
{

    $getposts = mysql_query("SELECT * FROM posts WHERE user_posted_to ='$user' ") or die(mysql_error());
    while ($row = mysql_fetch_assoc($getposts)) 
                    {
                    $id = $row['id'];
                    $body = $row['body'];   
                    $date_added = $row['date_added'];
                    $added_by = $row['added_by'];
                    $user_posted_to = $row['user_posted_to'];  

                 echo "

                    <div class='posted_by'>
                    Posted by:
                                            <a href='$added_by'>$added_by</a> on $date_added</div>
                                            <br />
                                            <div  style='max-width: 600px;'>
                                            $body<br /><p />
                                            </div></br>
                                            <hr />
                    ";
                    }
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:35:39.943

```
$getposts = mysql_query("
    SELECT * 
    FROM posts 
    WHERE user_posted_to ='$user'
    order by id desc
") or die(mysql_error()); 
```

# java - 为什么我的方法不返回字符串？

> ID：15531871
> 
> 赞同：2
> 
> 时间：2013-03-20T18:29:59.240
> 
> 标签：java, string, return

我正在使用一个程序类来尝试测试我的对象类中的方法以查看它们是否有效。这是一个燃气表读数系统，我正在尝试存钱以偿还客户所欠的部分余额。

我的对象类包括：

```
package GasAccountPracticeOne;

public class GasAccountPracticeOne 

{
    private int intAccRefNo;
    private String strName;
    private String strAddress;
    private double dblBalance = 0;
    private double dblUnits;
    private double dblUnitCost = 0.02;

    public GasAccountPracticeOne(int intNewAccRefNo, String strNewName, String strNewAddress, double dblNewUnits)
    {
        intAccRefNo = intNewAccRefNo;
        strName = strNewName;
        strAddress = strNewAddress;
        dblUnits = dblNewUnits;

    }//end of constructor

    public GasAccountPracticeOne( int intNewAccRefNo, String strNewName, String `strNewAddress)
    {
        intAccRefNo = intNewAccRefNo;
        strName = strNewName;
        strAddress = strNewAddress;

    }//end of overloading contructor

    public String deposit(double dblDepositAmount)
    {
        dblBalance = dblBalance - dblDepositAmount;

        return "Balance updated";
    } 
```

在我的程序课中，我写过：

```
 System.out.println("Enter deposit amount");
        dblDepositAmount=input.nextDouble();
        firstAccount.deposit(dblDepositAmount); 
```

但是在我的存款方法的对象类中，我要求返回一个返回“余额更新”的字符串。

当我运行测试时，没有返回字符串。把我的头从桌子上敲下来——我做了什么可笑的事吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:33:31.337

You did nothing to print your string:

1- use your output and print it:

```
System.out.println("Enter deposit amount");
dblDepositAmount=input.nextDouble();
String myString = firstAccount.deposit(dblDepositAmount); //<-- you store your string somewhere
System.out.println(myString ); // you print your String here

System.out.println(firstAccount.deposit(dblDepositAmount)); // Or you can show it directly 
```

2- You can also make your method print the value

```
public void deposit(double dblDepositAmount)
{
    dblBalance = dblBalance - dblDepositAmount;

    System.out.println("Balance updated");
} 
```

So when you call it, it will print by itself (returning a String value is useless in your case).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:33:28.363

This line of code discards the result of invoking `deposit` method, therefore you do not see that string:

```
firstAccount.deposit(dblDepositAmount); 
```

Try the following instead:

```
System.out.println(firstAccount.deposit(dblDepositAmount)); 
```

# sql - 将表/分区移动到不同的表空间会中断访问所述表/分区的查询吗？

> ID：15531881
> 
> 赞同：1
> 
> 时间：2013-03-20T18:30:26.287
> 
> 标签：sql, oracle, oracle11g

正如标题所说：在访问表/分区时移动（不重命名）表/分区会对访问它的任何查询产生负面影响吗？

例如，假设有一个长期运行的`SELECT COUNT(*) FROM some_table`.
如果我要`ALTER TABLE some_table MOVE TABLESPACE some_other_tablespace`，会`SELECT`失败吗？
它会完成，但结果不正确吗？也许完全是别的东西？

我能找到的唯一信息是在某些情况下将表移动到不同的表空间需要重建索引，但没有人提到任何活动查询会发生什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T19:55:22.523

它可能会失败`ORA-08103: object no longer exists`。

在 Oracle 中，读取器和写入器不会相互阻塞。这意味着 DML 和查询不会相互干扰，不包括一些奇怪的情况，如 UNDO 空间用完。但是移动表空间或任何类型的 ALTER 或其他 DDL 语句不是正常的写入。当您运行 DDL 时，多版本并发控制模型会崩溃，至少对于所涉及的对象而言，并且奇怪的事情开始发生。

测试一个大动作是困难的，但是你可以通过循环大量的小改动和查询来重现这些错误。如果您认为这只是一个理论问题，我已经看到这些错误发生在现实生活中的生产数据库上。

警告：下面是无限循环，因为我无法预测重现此错误需要多长时间。但它通常只需要我几十秒。

```
--Create sample table.
drop table test1 purge;
create table test1(a number, b number)
partition by list(a) (partition p1 values(1), partition p2 values(2))
nologging tablespace users;

--Session 1
begin
  loop
    execute immediate '
      insert /*+ append */ into test1 select mod(level,2)+1, level
      from dual connect by level <= 100000';
    commit;
    execute immediate 'alter table test1 move partition p1 tablespace users';
  end loop;
end;
/       

--Session 2: Read from moved partition
declare
  v_count number;
begin
  loop
    select count(*) into v_count from test1 where a = 1;
  end loop;
end;
/

--Session 3: Read from unmoved partition
declare
  v_count number;
begin
  loop
    select count(*) into v_count from test1 where a = 2;
  end loop;
end;
/ 
```

会话 2 最终将死于：

```
ORA-08103: object no longer exists
ORA-06512: at line 6 
```

会话 3 不会失败，它不会查询已更改的分区。每个分区都有自己的段，并且是一个可能“不再存在”的单独对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-19T23:39:06.853

如果正在访问分区，则分区移动将导致 DML 失败。

我刚刚证明了这一点：-/。

我正在执行大删除并尝试移动分区（更改表移动分区）。
我收到的错误是：ORA-12801：并行查询服务器 P004ORA-08103 中发出错误信号：对象不再存在

# c++ - C++ 枚举类型未正确初始化

> ID：15531890
> 
> 赞同：0
> 
> 时间：2013-03-20T18:30:57.157
> 
> 标签：c++, class, debugging, enums

我的代码中的枚举类型有问题。我有一个迷宫，我用for循环加载和循环，如果char符号等于'*'，我想将我的二维数组枚举设置为“Wall”，而“Clear”是符号是空格。这是我的代码..

包含枚举初始化的头文件：

```
#ifndef TYPE_H
#define TYPE_H

struct coordinate
{
    int row;
    int col;
};
enum SquareType {Wall, Clear, Visited, Path};

#endif 
```

为枚举声明二维数组的头文件：

```
#include <iostream>
#include <cstdlib>
#include <fstream>
using namespace std;

#include "type.h"
const int MAX = 50;
#ifndef MazeClass_H
#define MazeClass_H

class MazeClass
{
    private:
        SquareType Maze[MAX][MAX];
        coordinate      Entrance, Exit;
        int     height, width;
    public:
        MazeClass();
        void    ReadMaze(ifstream&);
        void    DisplayMaze();
        coordinate  GetEntrance();
        coordinate  GetExit();
        void    MarkVisited(coordinate);
        void    MarkPath(coordinate);
        bool    IsWall(int x, int y);
        bool    IsClear(int x, int y);
        bool    IsPath(int x, int y);
        bool    IsVisited(coordinate);
        bool    IsExit(int x, int y);
        bool    IsInMaze(int x, int y);
};
#endif 
```

我的实现文件：注意读取迷宫的功能和显示迷宫的功能，因为这是我的问题区域..

```
#include "MazeClass.h"
#include <iostream>
#include <cstdlib>

MazeClass::MazeClass()
{
}

void MazeClass::ReadMaze(ifstream& myIn)
{
    int x, y;
    char ch;
    myIn >> x;
    myIn >> y;
    height = x;
    width = y;
    myIn >> x;
    myIn >> y;
    Entrance.row = x;
    Entrance.col = y;
    myIn >> x;
    myIn >> y;
    Exit.row = x;
    Exit.col = y;
    myIn.ignore(100, '\n');
    for(int i = 0; i < height; i++)
    {
        for(int k = 0; k < width + 1; k++)
        {
            myIn.get(ch);
            if(ch == ' ')
                Maze[i][k] == Clear;
            else
                Maze[i][k] == Wall;
            cout << ch;
        }
        cout << endl;
    }
}

void MazeClass::DisplayMaze()
{
    char ch;
    for(int i = 0; i < height; i++)
    {
        for(int k = 0; k < width + 1; k++)
        {
            if(Maze[i][k] == Wall)
            {
                ch = '*';
                cout << ch;
            }
            else if(Maze[i][k] == Clear)
            {
                ch = ' ';
                cout << ch;
            }
        }
        cout << endl;
    }
}

coordinate MazeClass::GetEntrance()
{
    return Entrance;
}

coordinate MazeClass::GetExit()
{
    return Exit;
}

bool MazeClass::IsWall(int x, int y)
{
    if(Maze[x][y] == Wall)
        return true;
    else
        return false;
}

bool MazeClass::IsClear(int x, int y)
{
    if(Maze[x][y] == Clear)
        return true;
    else
        return false;
}

bool MazeClass::IsExit(int x, int y)
{
    if(x == Exit.row && y == Exit.col)
        return true;
    else
        return false;
}

bool MazeClass::IsInMaze(int x, int y)
{
    cout << "Height: " << height << " " << "Width: " << width << endl;
    if(x < 0 || x > height || y < 0 || y > width)
        return false;
    else 
        return true;
} 
```

最后我的文件使用这些功能和测试输出：

```
#include "MazeClass.h"
#include<iostream>
#include<fstream>
using namespace std;

int main(int argc,char *argv[])
{
    MazeClass maze;
    ifstream myIn;
    int x,y;
    string filename = argv[1]; // command line arguement stuff

    myIn.open(filename.c_str());
    maze.ReadMaze(myIn); //reads in the maze from a data file
    maze.DisplayMaze();
    cout << "The entrance is at: " << maze.GetEntrance().row << " " << maze.GetEntrance().col << endl;
    cout << "The exit is at: " <<maze.GetExit().row << " " << maze.GetExit().col << endl;

    if(maze.IsWall(1,1) == true) //uses the IsWall method to determine wether it is a wall or not
        cout << "location (1,1) is a wall\n"; 
    else
        cout << "location (1,1) is not a wall\n"; 

    if(maze.IsClear(1,3) == true) //uses the IsClear method to determine wether it is a clear or not
        cout << "location (1,3) is clear\n"; 
    else
        cout << "location (1,3) is not clear\n";

    if(maze.IsInMaze(1,5) == true) //uses the IsInMaze method to determine wether it is a clear or not
        cout << "location (1,5) is in the Maze\n"; 
    else
        cout << "location (1,5) is not in the Maze\n";

    if(maze.IsInMaze(25,35) == true)
        cout << "location (25,35) is in the maze\n";
    else
        cout << "location (25,35) is not in the maze\n";

    myIn.close();

    return 0;
} 
```

问题是......我不断得到大量的输出。我在“阅读迷宫”功能和“显示迷宫”功能中加入了一个 cout，以显示两者之间的区别。

我的输出：

```
****************** *

*     *      ***** *

* ***** ***        *

* ***** *****   ** *

* *             *  *

* *******  *       *

************ *******

*********************
*********************
*********************
*********************
*********************
*********************
*********************
The entrance is at: 0 18
The exit is at: 6 12
location (1,1) is a wall
location (1,3) is not clear
Height: 7 Width: 20
location (1,5) is in the Maze
Height: 7 Width: 20
location (25,35) is not in the maze 
```

这是我正在读取的数据文件：

```
7 20
0 18
6 12
****************** *
*     *      ***** *
* ***** ***        *
* ***** *****   ** *
* *             *  *
* *******  *       *
************ ******* 
```

如您所见，就好像枚举类型总是认为字符是“墙”，而从迷宫的第一个输出来看，它显然不是。有什么建议么？我错过了一些我可能看过的东西吗？任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:32:40.850

在`ReadMaze`：

```
Maze[i][k] == Clear; 
```

这是一个比较。我相信你想要分配：

```
Maze[i][k] = Clear; 
```

对于`Maze[i][k] == Wall;`.

# c# - C# 替换 URL 正则表达式

> ID：15531896
> 
> 赞同：0
> 
> 时间：2013-03-20T18:31:31.247
> 
> 标签：c#, regex, url

我正在尝试从字符串中提取 URL 并稍后使用它来创建超链接。我希望能够执行以下操作： - 确定输入字符串是否包含 URL - 从输入字符串中删除 URL - 将提取的 URL 存储在变量中以备后用

谁能帮我这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:37:34.433

这是识别流行格式的 URL 的绝佳解决方案，例如：

*   www.google.com
*   [http://www.google.com](http://www.google.com)
*   邮寄地址：somebody@google.com
*   某人@google.com
*   www.url-with-querystring.com/?url=has-querystring

使用的正则表达式是：

```
/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)/ 
```

但是，我建议您访问[http://blog.mattheworiordan.com/post/13174566389/url-regular-expression-for-links-with-or-without-the](http://blog.mattheworiordan.com/post/13174566389/url-regular-expression-for-links-with-or-without-the)查看工作示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:47:36.693

用您的输入替换输入

```
 string input = string.Empty;
        var matches = Regex.Matches(input,
                      @"/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[.\!\/\\w]*))?)/");
        List<string> urlList = (matches.Cast<object>().Select(match => match.ToString())).ToList(); 
```

# c# - 互操作 - 将 Excel 图表的范围设置为整行

> ID：15531912
> 
> 赞同：0
> 
> 时间：2013-03-20T18:32:39.050
> 
> 标签：c#, excel, interop

*如何将 excel 互操作图表的源数据设置为几行？*

我有一个`.csv`由我的程序创建的文件，用于显示生成的一些结果。为了简单起见，假设这些结果和图表显示如下：（这正是我想要的样子）

![在此处输入图像描述](../Images/41e1433f45c2de65b7d6a8238c86c7d7.png)

现在我遇到的问题是人数是可变的。所以我真的需要访问整个行数据。

现在，我正在这样做：

```
var range = worksheet.get_range("A1","D3");

xlExcel.ActiveChart.SetSourceData(range); 
```

如果你只有三个，这很好用`Persons`，但我需要访问整行数据。

因此，为了重申我的问题，*如何将图表的源数据设置为几行？*

* * *

我试着看[这里](https://stackoverflow.com/questions/5490903/usedrange-in-excel-column)，但似乎无法使用行而不是列。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:48:36.710

```
var range = worksheet.get_range("A1").CurrentRegion;

xlExcel.ActiveChart.SetSourceData(range); 
```

EDIT: I am assuming that the cells in the data region won't be blank.
To test this,
1) place cursor on cell A1
2) press `F5`
3) click on "Special"
4) choose "Current Region" as option
5) click "OK"

This will select the cells surrounding A1 which are filled, which I believe is what you are looking for.

The translation of that in VBA code points to `CurrentRegion` property. I think, that should work.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:45:18.937

查看选项`Range.EntireRow` 我不是 100% 了解如何将其扩展到包含 3 个整行的单个范围，但实现起来应该不难。

您可以做的另一件事是扫描以获取您需要的实际最大列索引（这是假设名称中保证没有间隙），然后在声明范围时使用该索引。

**添加代码**

```
int c = 2;//column b
while(true)
{
    if (String.IsNullOrEmpty(worksheet.GetRange(1,c).Value2))
    {
        c--;
        break;
    }
    c++;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T18:48:22.453

从 A 到 D 取一列，您确定没有空单元格。

做一些循环来找到该列中的第一个空的，它将在最后一个之后。

```
Range Cell = SHeet.Range["A1"]; //or another column you're sure there's no empty data

int LineOffset = 0;

 while (Cell.Offset[LineOffset, 0].Value != "")  //maybe you should cast the left side to string, not sure.
{
 LineOffset++;
}

int LastLine = LineOffset - 1; 
```

然后你可以得到 Range[Sheet.Cells[1,1], Sheet.Cells[LastLine, 4]]

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T12:28:23.077

Out of the box here, but why not transpose the data? Three columns for Name, Height, Weight. Convert this from an ordinary range to a Table.

当任何公式（包括图表的 SERIES 公式）引用表的列时，它总是引用该列，无论表有多长。添加另一个人（另一行），图表显示添加的人的数据。去掉几个人，图表调整，最后不留空白。

这在我的教程“[使用列表或表格的简单动态图表”](http://peltiertech.com/WordPress/easy-dynamic-charts-lists-tables/)中进行了说明。

# javascript - TinyMCE 图像管理器不起作用

> ID：15531914
> 
> 赞同：1
> 
> 时间：2013-03-20T18:32:41.077
> 
> 标签：javascript, tinymce, wysiwyg, mcimagemanager

我对 TinyMCE imagemanager 有问题，它可以在 Windows（WAMP）上运行，但在 Ubuntu 上我面临以下问题

[http://www.hostingpics.net/viewer.php?id=146581Capturedu20130320192619.png](http://www.hostingpics.net/viewer.php?id=146581Capturedu20130320192619.png)

我该如何解决？

# c# - WPF ComboBox selection change after switching tabs

> ID：15531920
> 
> 赞同：1
> 
> 时间：2013-03-20T18:32:58.493
> 
> 标签：c#, wpf, mvvm, combobox, tabs

I made a project based on nested tabs. the nested tabs are different instance of the same viemModel and the same UI. when I switch between the tabs he comboboxes present in the tabs chenge thei selection depending on the tab that is loosing focus.

I add both the viewmodels and the view of my test project. thank you in advance for your help

main window

```
<Window.Resources>

    <DataTemplate DataType="{x:Type local:IntermediateViewModel}">
        <local:IntermediateView />
    </DataTemplate>

    <DataTemplate x:Key="HeaderedTabItemTemplate">
        <Grid>
            <ContentPresenter
                        Content="{Binding Path=Header, UpdateSourceTrigger=PropertyChanged}" 
                        VerticalAlignment="Center" >
            </ContentPresenter>
        </Grid>
    </DataTemplate>

    <Style x:Key="SimpleTabItemStyle" TargetType="TabItem">
        <Setter Property="Foreground" Value="White"/>
        <Setter Property="FontWeight" Value="Bold"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TabItem}">
                    <Grid>
                        <Border Name="Border" BorderThickness="1" BorderBrush="#555959">
                            <ContentPresenter x:Name="ContentSite" VerticalAlignment="Center" HorizontalAlignment="Center"
                                 ContentSource="Header" Margin="12,2,12,2" RecognizesAccessKey="True" Height ="40" MinWidth ="90"/>
                        </Border>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="#555959" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <DataTemplate x:Key="DefaultTabControlTemplate">
        <TabControl IsSynchronizedWithCurrentItem="True" 
                        BorderThickness="0" 
                        ItemsSource="{Binding}" 
                        ItemTemplate="{StaticResource HeaderedTabItemTemplate}"
                        ItemContainerStyle="{StaticResource SimpleTabItemStyle}"
                        SelectionChanged="TabControl_SelectionChanged"
                        />
    </DataTemplate>

    <!---->

</Window.Resources>

<Grid MinHeight="200" MinWidth="300">
    <Grid.RowDefinitions>
        <RowDefinition Height="260*" />
        <RowDefinition Height="51*" />
    </Grid.RowDefinitions>
    <Border >
        <ContentControl 
            Content="{Binding Path=Workspaces}" 
            ContentTemplate="{DynamicResource DefaultTabControlTemplate}"
             />
    </Border>
    <Button Grid.Row="1" Content="Add" Command="{Binding AddCommand}"/>
</Grid> 
```

view model (create a different istance each time)

```
class MainWindowViewModel : WorkspacesViewModel<IntermediateViewModel>
{
    public MainWindowViewModel()
    {
        this.WorkspacesView.CurrentChanged += new EventHandler(WorkspacesView_CurrentChanged);
    }

    void WorkspacesView_CurrentChanged(object sender, EventArgs e)
    {
    }

    RelayCommand myVar = null;
    public ICommand AddCommand
    {
        get 
        {
            return myVar ?? (myVar = new RelayCommand(param => 
            {
                SetWindow(new IntermediateViewModel("AA" + this.Workspaces.Count) );
            })); 
        }
    } 
```

first level tab

```
 <UserControl.Resources>

    <DataTemplate DataType="{x:Type local:ClassViewModel}">
        <local:ClassView />
    </DataTemplate>
</UserControl.Resources>

<Border>
    <ContentControl Content="{Binding Path=CurrentWorkspace, Mode=OneWay}" Loaded="ContentControl_Loaded" DataContextChanged="ContentControl_DataContextChanged" IsVisibleChanged="ContentControl_IsVisibleChanged" LayoutUpdated="ContentControl_LayoutUpdated" TargetUpdated="ContentControl_TargetUpdated" Unloaded="ContentControl_Unloaded" />
</Border> 
```

first level viewmodel

class IntermediateViewModel : WorkspacesViewModel { public string Header { get; set; }

```
 public IntermediateViewModel(string header)
    {
        Header = header;
        SetWindow(new ClassViewModel(header));
    }
} 
```

nested tab

```
 <UserControl.Resources>
    <CollectionViewSource x:Key="StatusView" Source="{Binding Path=StatusList}"/>
</UserControl.Resources>
<Grid>
    <ComboBox Name="_spl2Status" ItemsSource="{Binding Source={StaticResource StatusView}}"
      SelectedValue="{Binding Path=MyProperty, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
      SelectedValuePath="FL_TYPE"
      DisplayMemberPath="ID_TYPE" Margin="76,12,0,0" Height="40" VerticalAlignment="Top" HorizontalAlignment="Left" Width="146"
               DataContextChanged="_spl2Status_DataContextChanged"
               IsVisibleChanged="_spl2Status_IsVisibleChanged"
               Loaded="_spl2Status_Loaded"
                SelectionChanged="_spl2Status_SelectionChanged"
               >
    </ComboBox>
</Grid> 
```

nested tab view model

```
public enum myTypes
{ 
    tipo0 = 0,
    tipo1 = 1,
    tipo2 = 2,
}

class ClassViewModel : WorkspaceViewModel
{
    public ClassViewModel(string name)
    {
        Name = name;
    }

    public string Name { get; set; }

    private List<IntEnumType> _statusList = null;
    public List<IntEnumType> StatusList
    {
        get
        {
            if (_statusList == null)
                _statusList = new List<IntEnumType>()
                {
                    new IntEnumType((int)myTypes.tipo0, myTypes.tipo0.ToString()),
                    new IntEnumType((int)myTypes.tipo1, myTypes.tipo1.ToString()),
                    new IntEnumType((int)myTypes.tipo2, myTypes.tipo2.ToString()),
                };
            return _statusList;
        }
    }

    private int myVar = 1;
    public int MyProperty
    {
        get 
        {
            return myVar; 
        }
        set 
        {
            if (myVar != value)
            {
                myVar = value;
                OnPropertyChanged(() => MyProperty);
            }
        }
    }
}

public class TabItemStyleSelector : StyleSelector
{
    public Style MainTabItem { get; set; }
    public Style ChildrenTabItem { get; set; }
    public Style SpecificationTabItem { get; set; }

    public override Style SelectStyle(object item, DependencyObject container)
    {
        //if (item is IHome)
        //    return MainTabItem;
        //else if (item is SpecificationItemViewModel)
        //    return SpecificationTabItem;
        //else
            return ChildrenTabItem;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:45:19.320

代码有点难以完全遵循，但我猜问题是只有一个你的实例，`ClassViewModel`它是组合框选择的存储位置`{Binding Path=MyProperty`，所以存储的任何内容都`MyProperty`将反映在所有组合框的实例，无论它们位于何处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-06-29T14:52:14.127

好吧，这有点晚了，但是由于我面临同样的问题，我想分享我的分析。

当您更改选项卡时，您将当前选项卡的 DataContext 更改为您的其他 ViewModel，因此也将您的 ComboBox 的 ItemsSource 更改为。

如果您之前选择的项目 (SelectedItem) 不包含在新的 ItemsSource 中，则 ComboBox 会触发 SelectionChanged-Event 并因此将 SelectedIndex 设置为 -1。

尽管 ComboBox 的这种默认行为可能有意义，但在许多情况下它非常烦人。

我们从 ComboBox 派生了一个自己的类来处理它。但这并不是很令人满意，因为您失去了一些您最可能需要的默认行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-10T20:24:38.157

问题出在您加载的事件处理程序中。

当您切换标签时，您会卸载一个标签并加载一个新标签。

我怀疑你换`MyComboBox.SelectedIndex`了`_spl2Status_Loaded`。

# jquery - jQuery：使用 .each 循环列表

> ID：15531924
> 
> 赞同：1
> 
> 时间：2013-03-20T18:33:07.100
> 
> 标签：jquery, html-lists

我有一个非常简单的列表，其中包含我需要循环的图像。这是脚本：

```
var graphic = $('#banner li');
  graphic.hide();
    cycle = $(graphic).each(function(i,e) {
      while(i-- >= 0){
        $(e).show(300).delay(2000).hide(300)
      }
      if(i===0){cycle()}
    }) 
```

它几乎可以工作..它一次显示所有图像而不是 1 个，但在遍历列表时会删除每个图像。我可以`overflow:hidden;`在我的 CSS 中使用，但我不希望这样。当它达到0时它也不会重复。

请帮忙。对于这样一个简单的任务，我也不想要臃肿的循环插件。谢谢！

**我尝试制作`graphic`一个数组，但我也无法让它工作。

[小提琴](http://jsfiddle.net/nmZGC)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T12:22:30.253

使用以下代码重构了您的逻辑[`.eq`](http://api.jquery.com/eq/)：

```
var graphic = $('#banner li').hide(), //hide and cache list items selector
    i = 0,
    l = graphic.length;
(function cycle() {
    graphic.eq(i++ % l).show(300).delay(2000).hide(300, cycle);
}()); 
```

[**小提琴**](http://jsfiddle.net/nmZGC/3/)

通过将 IIFE 本身作为回调传递，一旦当前迭代的`.hide()`动画完成，我们就会为下一个项目重复显示、延迟和隐藏循环。

您可以`i`在函数末尾增加 并`graphic.hide()`在进入 IIFE 之前调用，有些人可能认为这更具可读性：

```
var graphic = $('#banner li'),
    i = 0,
    l = graphic.length;
graphic.hide();
(function cycle() {
    graphic.eq(i % l).show(300).delay(2000).hide(300, cycle);
    i++;
}()); 
```

以上只是为了便于阅读，它与第一个片段具有相同的效果。

# dart - Matching Unicode letters with RegExp

> ID：15531928
> 
> 赞同：9
> 
> 时间：2013-03-20T18:33:25.920
> 
> 标签：dart

I am in need of matching Unicode letters, similarly to PCRE's `\p{L}`.

Now, since Dart's RegExp class is based on ECMAScript's, it doesn't have the concept of `\p{L}`, sadly.

I'm looking into perhaps constructing a big character class that matches all Unicode letters, but I'm not sure where to start.

So, I want to match *letters* like:

```
foobar
מכון ראות 
```

But the R symbol shouldn't be matched:

```
BlackBerry® 
```

Neither should any ASCII control characters or punctuation marks, etc. Essentially every *letter* in every language Unicode supports, whether it's å, ä, φ or ת, they should match if they are actual letters.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2019-12-02T02:23:17.607

我知道这是一个老问题。但`RegExp`现在支持[unicode 类别](https://www.regular-expressions.info/unicode.html#category)（自 Dart 2.4 起），因此您可以执行以下操作：

```
RegExp alpha = RegExp(r'\p{Letter}', unicode: true);
print(alpha.hasMatch("f")); // true
print(alpha.hasMatch("ת")); // true
print(alpha.hasMatch("®")); // false 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T17:28:17.607

我认为 Dart 库中没有关于将 Unicode 字符分类为字母或非字母的完整信息。您也许可以将主要使用 Intl 库中的东西（尤其是 Bidi）的东西放在一起。我在想，例如，

isLetter(oneCharacterString) => Bidi.endsWithLtr(oneLetterString) || Bidi.endsWithRTL(oneLetterString);

可能会做一个合理的工作。至少那里似乎有许多有效字符的范围。或者您可以根据 _LTR_CHARS 和 _RTL_CHARS 中的信息组合您自己的 RegExp。它明确表示它不是 100% 准确，但适用于大多数实际目的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T04:18:43.077

看起来您将不得不遍历字符串中的符文，然后根据 unicode 范围表检查整数值。

[Golang 有一些代码可以直接从unicode 源](http://www.unicode.org/Public/6.2.0/ucd/UnicodeData.txt)代码生成这些表。请参阅[maketables.go](https://code.google.com/p/go/source/browse/src/pkg/unicode/)以及 golang unicode 包中的一些其他文件。

或者采取惰性选项，并提交一个 Dart 错误，然后等待 Dart 团队实现它；）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-21T21:28:36.130

Dart 或 JS 中尚不支持此功能。

Xregexp JS 库支持生成相当大的字符类正则表达式来支持类似的东西。您可能能够生成正则表达式，打印它并将其剪切并粘贴到您的应用程序中。

# php - PHP 和 preg_match_all 的正则表达式问题

> ID：15531932
> 
> 赞同：1
> 
> 时间：2013-03-20T18:33:35.843
> 
> 标签：php, regex, preg-match-all

大家好，我在使用正则表达式时遇到了问题，当内容中有空格或换行符时，它无法正常工作。

```
$content = "<dt><span>Name:</span></dt>
                      <dd>
                        John
                      </dd>
                      <dt><span>Age:</span></dt>
                      <dd>
                        40
                      </dd>
                      <dt><span>Sex:</span></dt>
                      <dd>
                        Male
                      </dd>"; 
```

我正在使用的正则表达式是

```
preg_match_all('/<dt><span>(.*)<\/span><\/dt><dd>(.*)<\/dd>/',$content, $output); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:41:18.123

不要使用 RegEx 解析 HTML。使用 DOM。如果您确定 HTML 结构，这里有一个示例。

```
$dom = new DOMDocument();
@$dom->loadHTML($content);
$xpath = new DOMXPath($dom);
$spans = $xpath->query('//span');
$dds= $xpath->query('//dd');
for ($i = 0; $i < $spans->length; $i++)
{
    echo $spans->item($i)->nodeValue . $dds->item($i)->nodeValue . '<br>';
} 
```

如果你不确定它的结构，你需要一些更复杂的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:38:13.673

同意你应该使用 DOM。但是你没有考虑到和之间的空格

尝试：

```
preg_match_all('/<dt><span>(.*)<\/span><\/dt>.*<dd>(.*)<\/dd>/',$content, $output); 
```

# android - Android statusbar code deprecated

> ID：15531933
> 
> 赞同：0
> 
> 时间：2013-03-20T18:33:38.300
> 
> 标签：android, notifications, statusbar

Hi mates i'm trying to develop an app which needs to send a notification for the user at certain time. In the internet i found this code but eclipse says that it's deprecated. Do you know which is the proper way to do it with my API? (16)

```
NotificationManager nm = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);

int icon = R.drawable.worldmap2;
CharSequence tickerText = "Hello";
long when = System.currentTimeMillis();
Notification notification = new Notification(icon, tickerText,when);
Context context = getApplicationContext();
CharSequence contentTitle = "My notification";
CharSequence contentText = "Hello World!";
final Intent intent1 = new Intent(context, HttpExampleLimits.class);
PendingIntent pIntent = PendingIntent.getActivity(getApplicationContext(), 0, intent1, 0);
notification.setLatestEventInfo(context, contentTitle,contentText, pIntent);

nm.notify(1, notification); 
```

Thank you very much!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:57:22.373

实现它的最好方法是使用支持库和`NotificationCompat`类。

您可以在官方文档上找到很多示例：http: [//developer.android.com/guide/topics/ui/notifiers/notifications.html](http://developer.android.com/guide/topics/ui/notifiers/notifications.html)

# rest - Zend Framework 2: How can I add in RESTful API a custom http method?

> ID：15531935
> 
> 赞同：0
> 
> 时间：2013-03-20T18:33:45.083
> 
> 标签：rest, zend-framework2

I'm trying to create a custom http method in RESTful API. I was reading the documentation and it is said that you can do it buy adding a simple action in controller and then for example conifg your route with child routes with action => action_name but in the code I have spotted addHttpMethodHandler() method in Zend\Mvc\Controller\AbstractRestfulController.php so in controller construct method I have added:

```
$add = function () {
        return new JsonModel(array(
                'id' => 2222,
        ));
    };

    $this->addHttpMethodHandler('someAction', $add);
    var_dump($this->customHttpMethodsMap); 
```

With the var_dump I can see that this new function is added but I just wonder how can I call it or maybe I'm missing the point.

Regards,

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T02:27:13.777

实际上，我为此写了一篇博客文章，因为我也遇到了很多麻烦。

问题在于，除了在抽象的 restful 控制器中调用 addHttpMethodHandler 之外，您还需要确保 Zend Request 类知道您的 http 方法存在。

这是一个更好解释的链接：[http ://richardbrock1.wordpress.com/2013/03/23/custom-http-methods-in-zf2/](http://richardbrock1.wordpress.com/2013/03/23/custom-http-methods-in-zf2/)

# ruby-on-rails - 根据父模型和子模型的参数获取平均计数

> ID：15531939
> 
> 赞同：0
> 
> 时间：2013-03-20T18:34:01.303
> 
> 标签：ruby-on-rails, ruby, activerecord, ruby-on-rails-3.2

如果一个`User` `has_many` `Items`. 并且可以通过将 items 中的`:published`属性设置为 来发布项目`true`。

如何获得每个**创建项目的****用户**的**平均**已**发布项目**数？

 ****我有一个名为 的项目范围`published`，因此您可以通过以下方式获取所有已发布的项目：

```
@items = Item.published
@items = @user.items.published 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:38:20.377

一种方法是：

```
 avg = Item.published.count.to_f / User.count 
```

**编辑：**

试试这个：

```
 @published_items = User.joins(:items).where('items.published = ?', true)
  avg = @published_items.count.to_f / @published_items.all(:select => 'distinct users.*').count 
```

或者：

```
 avg = Item.published.count.to_f / User.joins(:items).where('items.published = ?', true).all(:select => 'distinct users.*').count 
```****

# c++ - 为什么微软在他们的 C++ 代码中使用这么多宏？

> ID：15531941
> 
> 赞同：6
> 
> 时间：2013-03-20T18:34:10.067
> 
> 标签：c++

Visual Studio 附带的 C++ 标准库实现和 Windows API（Win32 和 MFC）都包含大量宏。

例如，他们将“TRUE”和“FALSE”定义为 1 和 0。并在所有上下文中将 bool 替换为“BOOL”，它是 int 的 typedef。他们甚至没有使用三向逻辑。

还有“min”和“max”宏，可以很容易地用模板替换。

还有大量的定义只是简单地定义为“远”和“近”之类的东西。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-20T18:36:02.277

大部分代码都是以 C 代码开始的，并且可以追溯到 1980 年代。如果它今天是从头开始编写的，那么您可能会期望代码看起来会有所不同。

例如，您选择`BOOL`类型。早在最初构想 Windows API 时，C 中还没有布尔类型。

您提到`MIN`和`MAX`宏并提出模板。好吧，如您所知，C 中没有模板，这些宏甚至可能早于 C++ 模板。

虽然 MFC 是一个 C++ 库，但它位于 Win32 之上，这是一个 C API。因此，MFC 的实现显然必须在其实现中使用该 C API。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-20T18:38:15.967

在 Ye Olden C 时代（MS-DOS），`far`被`near`指针关键字。许多这些库一开始都是用 C 语言编写的：因此，他们没有从头开始重新发明整个标准库，而是使用了一些已经工作的东西，并且已经相当好地工作了。

此外，Windows 本质上主要是一个 C API，而不是 C++ API，因此您可以预期代码中会出现许多东西（如宏、奇怪的定义等）。

# mysql - Group by Count of (Top 5) & Count of (All Other)

> ID：15531942
> 
> 赞同：1
> 
> 时间：2013-03-20T18:34:11.153
> 
> 标签：mysql, grouping, max

I have a query that I need to edit. Currently, it returns 2 columns of data, a case label and the count (or total number of cases) handled during the previous 7 day period starting yesterday. I need to change this output so that only 6 labels are in the output (i.e - always 6 rows of data). These rows need to be the top 5 labels and the sum of the remaining labels as the 6th label (called "Other"). This is because this output is fed to a PHP script that presents the data on a web-based platform.

Finally, to illustrate here is a table of the output I need as well as the query below.

```
+-----------+---------------+  
| CaseLabel | CasesResolved |  
+-----------+---------------+  
| Label1    |            20 |  
| Label2    |            18 |
| Label3    |            10 |
| Label4    |             9 |
| Label5    |             7 |
| Other     |            12 |
+-----------+---------------+ 
```

Thanks in advance for any help! :-)

Running MySQL 5.096

## MySQL Code:

```
SELECT
    deskcases.Labels,
    COUNT(deskcases.Labels)AS CaseCount
FROM
    deskcases
WHERE
    deskcases.Labels NOT LIKE ''
AND deskcases.Labels NOT LIKE '%SPAM%'
AND deskcases.Labels NOT LIKE '%Online Orders%'
AND deskcases.Labels NOT LIKE '%Internal SPAM%'
AND deskcases.`Case Status` LIKE 'Resolved'
AND deskcases.`Resolved At` > CURDATE()- INTERVAL 7 DAY
GROUP BY
    deskcases.Labels
ORDER BY
    CaseCount DESC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T19:03:58.063

在 MySQL 中，表达这一点的最简单方法可能是使用临时表：

```
create temporary table temp as (
    id int not null auto_increment,
    CaseLabel varchar(255),
    CasesResolved int
);

insert into temp(CaseLabel, CasesResolved)
    SELECT deskcases.Labels, COUNT(deskcases.Labels)AS CaseCount
    FROM deskcases
    WHERE deskcases.Labels NOT LIKE ''
          AND deskcases.Labels NOT LIKE '%SPAM%'
          AND deskcases.Labels NOT LIKE '%Online Orders%'
          AND deskcases.Labels NOT LIKE '%Internal SPAM%'
          AND deskcases.`Case Status` LIKE 'Resolved'
          AND deskcases.`Resolved At` > CURDATE()- INTERVAL 7 DAY
    GROUP BY deskcases.Labels
    ORDER BY CaseCount DESC;

select (case when id <= 5 then caselabel else 'Other' end),
       SUM(casesResolved) as CasesResolved
from temp
group by (case when id <= 5 then caselabel else 'Other' end)
order by MAX(id) desc 
```

临时表中的`id`列将行号添加到每一行。在任何其他真实数据库中，您都可以使用该`row_number()`功能，但 MySQL 不支持该功能。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-20T18:42:24.763

一种可能的选择是使用等级变量。

虚拟连接将初始化排名，if 将计数到 6。
所有这些东西都将首先在内部查询中得到解决，产生类似的东西

```
| Label1    |            20 |  
| Label2    |            18 |
| Label3    |            10 |
| Label4    |             9 |
| Label5    |             7 |
| Label6    |            12 |
| Label7    |               |
| ...... 
```

然后，另一个查询会将其折叠到所需的输出中。

```
select if(rank=6,"Other",sub.Labels) as Label, SUM(sub.CaseCount) from (
    SELECT
        if(@Rank < 6,@Rank:= @Rank + 1, @Rank) as Rank
        ,deskcases.Labels
        ,COUNT(deskcases.Labels) AS CaseCount
    FROM
        deskcases
    JOIN (@rank:= 0)
    WHERE
        deskcases.Labels NOT LIKE ''
    AND deskcases.Labels NOT LIKE '%SPAM%'
    AND deskcases.Labels NOT LIKE '%Online Orders%'
    AND deskcases.Labels NOT LIKE '%Internal SPAM%'
    AND deskcases.`Case Status` LIKE 'Resolved'
    AND deskcases.`Resolved At` > CURDATE()- INTERVAL 7 DAY
    GROUP BY
        deskcases.Labels
    ORDER BY
        CaseCount DESC
) sub
group by sub.rank ASC 
```

将最后一行的“其他”替换`labelx`为“其他”。

# php - 表单中的时间戳

> ID：15531944
> 
> 赞同：-7
> 
> 时间：2013-03-20T18:34:14.920
> 
> 标签：php, mysql, datetime

我目前有一个表格，可以将患者信息输入数据库。我需要获取患者到达事故和紧急情况的确切日期/时间，并将该日期时间提交到数据库。

请在下面找到 PHP 代码。我不希望日期/时间显示在表单中，我希望它在患者到达 A&E 时自动插入数据库。如何将日期时间插入数据库？

```
<?php
$arrival = new DateTime();
$arrivalString = $arrival->format("Y-m-d H:i:s");
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:35:47.290

像这样？

```
INSERT INTO theTable (timeColumn) VALUES (NOW()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T18:35:55.313

这只是一个常规的`INSERT`声明。您甚至不需要使用 PHP 的日期时间功能，因为 MySQL 可以为您处理这些。

```
INSERT INTO tablename (arrival_datetime)
VALUES(NOW()) 
```

或者

```
INSERT INTO tablename (arrival_datetime)
VALUES(CURRENT_TIMESTAMP) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T18:56:23.017

如果你想使用 php，你会做类似的事情......

`<input type="hidden" name="datetime" value="<?php echo $arrivalString; ?>" />`

在你的表格里面。

# c# - 如何获得内部列表计数？

> ID：15531945
> 
> 赞同：2
> 
> 时间：2013-03-20T18:34:19.540
> 
> 标签：c#, list

我有一个`List`“bigList”，其中包含一个`List`我的自定义类。因此，如果我的“bigList”中有 20 个列表，我如何获得其中一个内部列表的计数？

```
List<List<myClass>> bigList = new List<List<myClass>>();
for (int i = 0; i < 20; i++)
{
     List<myClass> newList = new List<myClass>();

     for (int i = 0; i < 100; i++)
     {
          newList.Add(myClass);
     }
     bigList.Add(newList);
} 
```

通过这个示例，我如何获取 bigList 中的列表计数？我没有`List`像`ArrayList`我做错的那样工作，因为我只是将列表存储在`ArrayList`然后使用索引来计算列表的数量。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T18:36:38.190

要获取第`i`th 列表的`Count`属性，请执行以下操作：

```
var s = bigList[i].Count; 
```

要获取每个内部列表中的项目总数，请执行以下操作：

```
bigList.Sum(x => x.Count); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T18:36:56.020

```
// To get the number of Lists which bigList holds
bigList.Count();

// To get the number of items in each List of bigList
bigList.Select(x => new {List = x, Count = x.Count()});

// To get the count of all items in all Lists of bigList
bigList.Sum(x => x.Count()); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T18:38:01.970

怎么样：

```
bigList.Sum(smallList => smallList.Count ()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T18:37:08.140

```
foreach (List<myClass> innerList in bigList)
{
     int count = innerList.Count;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-20T18:38:01.230

怎么样：

```
foreach(var innerList in bigList)
    var size = innerList.Count; //use the size variable 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-20T18:38:45.740

```
bigList[0].Count; //accesses the first element of the big list and retrieves the number of elements of that list item 
```

或者，在大列表中每个元素的 foreach 循环中：

```
for (var item in bigList)
{
   Console.WriteLine(item.Count); // print number of elements for every sublist in bigList
} 
```

List/ArrayList 都实现了 IList 接口，因此您可以以相同的方式使用它们。

# javascript - 如何在浏览器中查看 Web 套接字响应？

> ID：15531946
> 
> 赞同：5
> 
> 时间：2013-03-20T18:34:19.860
> 
> 标签：javascript, google-chrome, browser, websocket, google-chrome-devtools

我使用的是谷歌浏览器 24 版

我正在查看一个网站，通过 websocket 调用将数据提取到前端。

我的问题是，“是否可以从浏览器查看 Web 套接字响应？” 有没有这样的工具？

请让我知道，提前谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:36:59.343

是的，这是可能的。查看`Network`开发工具中的窗格并查找显示的行`Switching Protocols`

需要注意的是，您需要**关闭并重新加载**详细信息窗格，因为它*不会*自动刷新（从 Chrome 25 开始）

可能重复：[在 Google Chrome 中调试 WebSocket](https://stackoverflow.com/questions/5751495/debugging-websocket-in-google-chrome)（虽然信息肯定过时，但自​​从发布这些答案后发生了很大变化）

[这非常接近（2013-03-20） http://codetheory.in/websocket-traffic-inspection-in-chrome-developer-tools/](http://codetheory.in/websocket-traffic-inspection-in-chrome-developer-tools/)的“最新”信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:36:44.547

在 Chrome 检查器上，单击`Network`选项卡。

[关联](http://blog.kaazing.com/2012/05/09/inspecting-websocket-traffic-with-chrome-developer-tools/)

# android - Android : Audio call using rtpstream

> ID：15531952
> 
> 赞同：3
> 
> 时间：2013-03-20T18:34:52.167
> 
> 标签：android, sip, audio-streaming, voip, rtp

I want to develop an application that enables the users to do real time audio chatting with each other. I am using rtpstream to implement this. Following is my code. I am using two phones to test my application. The port number to the audio stream is assigned on run-time randomly. This means I have to send the port number from Phone 1 to Phone 2 on run-time to establish a connection.The problem here is that the communication is only one-sided i.e. Phone 1 can talk to Phone 2 but cannot hear Phone 1's reply. What should I do to make it two sided? Also is there any way to assign the port number to audiostream manually? Any help will be appreciated.

```
audioGroup = new AudioGroup();
audioGroup.setMode(AudioGroup.MODE_NORMAL);
audioStream = new AudioStream(InetAddress.getByAddress(MyIP));
PORT = audioStream.getLocalPort();
audioStream.setCodec(AudioCodec.PCMU);
audioStream.setMode(RtpStream.MODE_NORMAL);
audioStream.associate(InetAddress.getByAddress(ReceiverIP), PORT);
audioStream.join(audioGroup);
AudioManager Audio =  (AudioManager) getSystemService(Context.AUDIO_SERVICE);      
Audio.setMode(AudioManager.MODE_IN_COMMUNICATION); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-28T18:31:54.057

正确的方法是首先设置 RTP Stream，然后获取流正在侦听的端口号，然后在 SIP INVITE 的 SDP 部分中发送该端口。看看这个例子[https://github.com/Mobicents/restcomm-android-sdk/tree/master/Examples/JAIN%20SIP](https://github.com/Mobicents/restcomm-android-sdk/tree/master/Examples/JAIN%20SIP)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T07:09:03.617

我正在尝试完成相同的操作，一种可能性是 user1 与 user2 共享他的 ip。两个用户都可以创建一个 audiogroup 和 audiostream 。音频流加入其他用户的音频组。

# c++ - Why doesn't the value in the stack update eventough its a reference

> ID：15531961
> 
> 赞同：1
> 
> 时间：2013-03-20T18:35:23.037
> 
> 标签：c++

I have the following struct and class definition that I'm having an issue with:

```
struct customer{
    string fullname;
    double payment;
};

class Stack{
private:
    int top;
    customer stack[10];
    bool full;
    double sum;
public:
    Stack(){ 
        top=0; 
        full=false;
        double sum=0.0;
    }

    bool isFull(){
        return full;
    }

    void push(customer &c){
        if(!full)
            stack[top++]=c;
        else
            cout << "Stack full!" << endl;
    }

    void pop(){
        if(top>0){
            sum+=stack[--top].payment;
            cout << "Cash status: $" << sum << endl;
        }
        else
            cout << "Stack empty!" << endl;
    }
}; 
```

I run the following code in main:

```
int main(){
    customer c1 = {"Herman", 2.0};
    customer c2 = {"Nisse", 3.0};
    Stack stack = Stack();
    stack.push(c1);
    stack.push(c2);
    c2.payment=10.0;
    cout << c2.payment << endl;
    stack.pop();
    stack.pop();
    return 0;
} 
```

Why doesn't the sum add up to 12? I specified push constructor to be: `void push(customer &c)`. The output from the code is:

```
10
Cash status: $3
Cash status: $5 
```

Should the value in the stack be updated when I update c2.payment to 10?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:43:04.487

您通过引用传递参数，但您在下面的分配是将引用的对象复制到堆栈中。

> 堆栈[顶部++]=c；

这是使用隐式生成的赋值运算符，它复制客户类的每个成员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T19:02:13.143

在将 c2 添加到堆栈之前，您需要更改它的值。

# image - KineticJS 在圆圈内绘制图像

> ID：15531964
> 
> 赞同：0
> 
> 时间：2013-03-20T18:35:29.153
> 
> 标签：image, draw, kineticjs

我正在尝试使用以下方法将图像放置在一个圆圈内：

```
 var gArrow2 = new Image();
        gArrow2.src = '../../Content/images/green_s.png';
        var circle2 = new Kinetic.Circle({
            drawFunc: function(canvas) {
              var context = canvas.getContext();
              context.drawImage(gArrow2, 256, 256, 11, 23);
              context.beginPath();
              context.arc(256, 256, this.getRadius(), 0, 2 * Math.PI, false);
              context.lineWidth = this.getStrokeWidth();
              context.strokeStyle = this.getStroke();
              context.stroke();
            },
            x: 256,
            y: 256,
            radius: 70,
            stroke: '#00ffff',
            strokeWidth: 4,
            opacity: 0.5
        });
        layer2.add(circle2); 
```

这没用！我会很感激你的建议，在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T19:59:19.677

你必须给 gArrow2 时间来加载。您可以通过 gArrow2.onload 执行此操作。

**始终在加载后**放置 gArrow2.src 。

然后将任何使用 gArrow2 的代码放入**onload**函数中。

[编辑添加 layer2.draw()]

我插入你的代码并让它工作。

看起来只需要 layer2.draw();

这是代码和小提琴：http: [//jsfiddle.net/m1erickson/Qgnkx/](http://jsfiddle.net/m1erickson/Qgnkx/)

```
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Prototype</title>
    <script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
    <script src="http://www.html5canvastutorials.com/libraries/kinetic-v4.3.3-beta.js"></script>

<style>
#container{
  border:solid 1px #ccc;
  margin-top: 10px;
}
</style>        
<script>
$(function(){

        var stage = new Kinetic.Stage({
            container: 'container',
            width: 600,
            height: 600
        });
        var layer2 = new Kinetic.Layer();
        stage.add(layer2);

        var gArrow2 = new Image();
        gArrow2.onload=function(){

            var circle2 = new Kinetic.Circle({
                drawFunc: function(canvas) {
                  var context = canvas.getContext();
                  context.drawImage(gArrow2, 256, 256, 11, 23);
                  context.beginPath();
                  context.arc(256, 256, this.getRadius(), 0, 2 * Math.PI, false);
                  context.lineWidth = this.getStrokeWidth();
                  context.strokeStyle = this.getStroke();
                  context.stroke();
                },
                x: 256,
                y: 256,
                radius: 70,
                stroke: '#00ffff',
                strokeWidth: 4,
                opacity: 0.5
            });
            layer2.add(circle2);        
            layer2.draw();
        }
        gArrow2.src = 'http://dl.dropbox.com/u/139992952/stackoverflow/house1.jpg';

}); // end $(function(){});

</script>       
</head>

<body>
    <div id="container"></div>
</body>
</html> 
```

# ios - 在 iOS 上使用基于位置的推送通知

> ID：15531974
> 
> 赞同：8
> 
> 时间：2013-03-20T18:35:56.880
> 
> 标签：ios, push-notification, location-based-service

我正在为一个城市开发一个旅游应用程序，当用户靠近“感兴趣的地方”时，他可以在他的设备上获得推送（本地）。

例如，我会在我的应用程序上添加 100 个 POI，并为每个 POI 发送 100 条消息，以显示用户何时在范围内，例如“您靠近大教堂……”

这种情况可能吗？是否有可能检查用户的位置，例如每 10 分钟即使应用程序被杀死，并且在射程内触发本地推送时？它会消耗多少电池？如果用户关闭 GPS，它会尝试使用 3G/wifi 信号来获取位置吗？

如果是的话，您能否指导我正确阅读有关该主题的内容，也许是一些教程和文章？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-14T15:07:15.400

这确实是可能的。[您可以使用本文](https://stackoverflow.com/questions/6347503/how-do-i-get-a-background-location-update-every-n-minutes-in-my-ios-application)中概述的上述技术。您可以使用 CLLocationManager:: startMonitoringSignificantLocationChanges 扩展此功能，以在应用程序被终止后重新启动侦听位置的过程。根据您的准确性需求，可以对电池寿命进行许多其他优化，例如在用户加速时更频繁地检查等。

我开发了一个[库](http://www.plotprojects.com/getourplugin/)来为您处理这些细节（适用于 Android 和 iOS）。下载包含一个示例应用程序，演示如何使用它。随意检查一下。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T18:40:13.827

是的，这是可能的。您需要在本地应用程序上存储一些“地点”（坐标或地址）。可以通过[反向地理编码](http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MKReverseGeocoder_Class/Reference/Reference.html)器检查与存储“地点”的接近程度。

检查这个[Wonderful SO Question](https://stackoverflow.com/questions/6347503/how-do-i-get-a-background-location-update-every-n-minutes-in-my-ios-application)，与你的非常相似

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-07T20:59:58.070

这对于您的问题可能为时已晚，但对于其他需要它的人来说。地理围栏是一个不错的选择。

这是一个解释什么是地理围栏的视频[http://academy.pulsatehq.com/7-things-about-geofencing](http://academy.pulsatehq.com/7-things-about-geofencing)

如果您使用的是 Ionic 平台，这里是插件的链接 [https://github.com/cowbell/cordova-plugin-geofence](https://github.com/cowbell/cordova-plugin-geofence)

地理围栏将完全解决您的问题。只需在这些旅游景点创建一堆地理围栏，当用户进入这些位置的一定半径内时，用户就会收到通知。

祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T19:03:10.787

当应用程序被杀死时，接收位置更新的具体内容是什么？

但是，在后台时，您可以根据距离和时间设置位置更新。

检查[如何在我的 iOS 应用程序中每 n 分钟获取一次后台位置更新？](https://stackoverflow.com/questions/6347503)

至于 GPS 与 3g/wifi，用户可以允许或不允许应用程序的定位服务。然后，iOS 将处理是否使用 GPS 或手机信号来确定位置。[在此处](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/LocationAwarenessPG/CoreLocation/CoreLocation.html)了解重大变化的位置服务。使用显着变化服务将使用比 GPS 锁定更多的小区定位来确定位置，反之亦然，用于标准定位服务。另请查看定位精度以了解有关节省电池的更多信息。

# python - 根据预定义的文件夹结构查找文件夹

> ID：15531977
> 
> 赞同：0
> 
> 时间：2013-03-20T18:36:03.097
> 
> 标签：python, regex, reverse-engineering

我们设置了一个动态文件夹结构语法，如下所示：

```
:projectRoot:/dev/model/:parentHierarchy:/:assetName:/data/obj
:projectRoot:/dev/model/:parentHierarchy:/:assetName:/data/fbx
:projectRoot:/asset/shots/:parentHierarchy:/animation/:assetName:/scenes
:projectRoot:/asset/shots/:parentHierarchy:/rendering/:assetName:/scenes 
```

其中两个冒号“：”之间的单词是变量。现在基于单个路径，我想检索 projectRoot、parentHierarchy 和assetName。

projectRoot 变量和 parentHierarchy 变量允许存在 1 个或多个文件夹，因此它可以包含子文件夹。assetsName 变量仅限于单个文件夹。这些是我在下面看到的尝试中定义的。

所以假设我传入：

```
C:/Projects/foo/dev/model/props/furniture/couch/data/ 
```

这应该返回：

```
projectRoot = C:/Projects/foo/
parentHierarchy = props/furniture
assetName = couch 
```

然后我们还可以检查规则集中定义的所有路径是否都存在（但这相对容易）：

```
C:/Projects/foo/dev/model/props/furniture/couch/data/obj
C:/Projects/foo/dev/model/props/furniture/couch/data/fbx
C:/Projects/foo/asset/shots/props/furniture/animation/couch/scenes
C:/Projects/foo/asset/shots/props/furniture/rendering/couch/scenes 
```

这是我当前的测试实现：

```
import os
import re

variableRegex = re.compile(":[\w]*:")

def getRules():
    return [":projectRoot:/dev/model/:parentHierarchy:/:assetName:/data/obj",
            ":projectRoot:/dev/model/:parentHierarchy:/:assetName:/data/fbx",
            ":projectRoot:/asset/shots/:parentHierarchy:/animation/:assetName:/scenes",
            ":projectRoot:/dev/model/:parentHierarchy:/:assetName:/data/obj"]

def getVarRules():
    """
        These rules define how many hierarchy depth each variable represents.
        (This is simplified from the actual code I'm working with to ease the example for the question)

        -1 defines that the variable can hold one or more folders (nested folders), thus never zero
        1 defines it will can't have subfolders and will define a single folder
    """
    return {":projectRoot:": -1,
            ":parentHierarchy:": -1,
            ":assetName:": 1}

def reversePath(path, rule):
    """
        Returns the variables within rule by getting them from the path.
        This will only work if the given path is valid for the given rule.

        This is currently a dummy function.
        This is a part where I get stuck. How to slice it up based on the rules?
    """
    varHierarchyDepth = getVarRules()
    return path

def reverseEngineerWorkspaces(path):
    """
        This function should check if the given path is valid for any of the rules.

        Note that static parts (end parts of the rule not defined by a variable) may be omitted from the input path.
        That input path can still be validated (only if the folder exists and contains the required static end as
        subdirectories/files.)
    """
    rules = getRules()
    varHierarchyDepth = getVarRules()

    path = os.path.realpath(path)
    path = path.replace("\\","/")   # force forward slashes so it's similar to our rules definitions.
    path = path.rstrip("/")         # remove any trailing slashes

    for rule in rules:
        # 1.
        # First we check if any of the static parts that are in front of the last variables are present in the path.
        # If not present it certainly isn't the correct path.
        # We skip checking the end static part because we could easily check whether those exist within the current folder
        staticParts = [ part for part in variableRegex.split(rule) if part != "" and part != "/" ]
        if not all([x in path for x in staticParts[:-1]]):
            continue

        if rule.endswith(staticParts[-1]):
            # If this this rule ends with a static part we can use that to check if the given path is fully valid
            # Or if the path concatenated with that static part exists. If so we have a valid path for the rule.
            if path.endswith(staticParts[-1]):
                return reversePath(path, rule)
            else:
                lastPartSubfolders = staticParts[-1].split("/")
                for x in range(len(lastPartSubfolders)):
                    tempPath = os.path.join(path, *lastPartSubfolders[:-x])
                    if os.path.exists(tempPath):
                        return reversePath(tempPath, rule)
        else:
            raise NotImplementedError("There's no implementation for rules without a static end part.")

print reverseEngineerWorkspaces("""C:/Projects/foo/dev/model/props/furniture/couch/data/""")
print reverseEngineerWorkspaces("""C:/Projects/foo/dev/model/props/furniture/couch/data/fbx""")
print reverseEngineerWorkspaces("""C:/Projects/foo/dev/model/props/furniture/couch/data/obj""")
print reverseEngineerWorkspaces("""C:/Projects/foo/asset/shots/props/furniture/animation/couch/scenes""") 
```

目前它只找到由静态部分组成的路径（未检查变量规则，我不确定如何在此处添加）。

并且它不会从遵循规则的任何完整路径中解析出变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T18:45:11.003

我认为您可以使用一个正则表达式完成所有操作：

```
In [24]: re.search(r'(.+)(?:dev/model/|asset/shots/)(.+)/(.+?)(?:/data|/scenes)', path).groups()
Out[24]: ('C:/Projects/foo/', 'props/furniture', 'couch') 
```

# matlab - Matlab GUI，使用静态文本框的输入并使用基本按钮进行转换

> ID：15531981
> 
> 赞同：0
> 
> 时间：2013-03-20T18:36:15.783
> 
> 标签：matlab, user-interface

我正在为 Matlab gui 界面的工作方式而苦苦挣扎。

我不是在寻找答案，只是在寻找更多关于如何做到这一点的指导。

我正在尝试将编辑框中的温度从 F 转换为 C ...所以我认为我需要将方程式放在按钮中。

我想我被困在如何将数字从编辑框传递到按钮以进行转换，然后如何将其传回，然后显示它。这有道理吗？

```
function varargout = ICA09A_TEMPFtoC(varargin)
% ICA09A_TEMPFTOC MATLAB code for ICA09A_TEMPFtoC.fig
%      ICA09A_TEMPFTOC, by itself, creates a new ICA09A_TEMPFTOC or raises the existing
%      singleton*.
%
%      H = ICA09A_TEMPFTOC returns the handle to a new ICA09A_TEMPFTOC or the handle to
%      the existing singleton*.
%
%      ICA09A_TEMPFTOC('CALLBACK',hObject,eventData,handles,...) calls the local
%      function named CALLBACK in ICA09A_TEMPFTOC.M with the given input arguments.
%
%      ICA09A_TEMPFTOC('Property','Value',...) creates a new ICA09A_TEMPFTOC or raises     the
%      existing singleton*.  Starting from the left, property value pairs are
%      applied to the GUI before ICA09A_TEMPFtoC_OpeningFcn gets called.  An
%      unrecognized property name or invalid value makes property application
%      stop.  All inputs are passed to ICA09A_TEMPFtoC_OpeningFcn via varargin.
%
%      *See GUI Options on GUIDE's Tools menu.  Choose "GUI allows only one
%      instance to run (singleton)".
%
% See also: GUIDE, GUIDATA, GUIHANDLES

% Edit the above text to modify the response to help ICA09A_TEMPFtoC

% Last Modified by GUIDE v2.5 20-Mar-2013 13:14:08

% Begin initialization code - DO NOT EDIT
gui_Singleton = 1;
gui_State = struct('gui_Name',       mfilename, ...
                   'gui_Singleton',  gui_Singleton, ...
                   'gui_OpeningFcn', @ICA09A_TEMPFtoC_OpeningFcn, ...
                   'gui_OutputFcn',  @ICA09A_TEMPFtoC_OutputFcn, ...
                   'gui_LayoutFcn',  [] , ...
                   'gui_Callback',   []);
if nargin && ischar(varargin{1})
    gui_State.gui_Callback = str2func(varargin{1});
end

if nargout
    [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
else
     gui_mainfcn(gui_State, varargin{:});
end
% End initialization code - DO NOT EDIT

% --- Executes just before ICA09A_TEMPFtoC is made visible.
function ICA09A_TEMPFtoC_OpeningFcn(hObject, eventdata, handles, varargin)
% This function has no output args, see OutputFcn.
% hObject    handle to figure
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
% varargin   command line arguments to ICA09A_TEMPFtoC (see VARARGIN)

% Choose default command line output for ICA09A_TEMPFtoC
handles.output = hObject;

% Update handles structure
guidata(hObject, handles);

% UIWAIT makes ICA09A_TEMPFtoC wait for user response (see UIRESUME)
% uiwait(handles.figure1);

% --- Outputs from this function are returned to the command line.
function varargout = ICA09A_TEMPFtoC_OutputFcn(hObject, eventdata, handles) 
% varargout  cell array for returning output args (see VARARGOUT);
% hObject    handle to figure
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Get default command line output from handles structure
varargout{1} = handles.output;

% --- Executes on button press in convert_pb.
function convert_pb_Callback(hObject, eventdata, handles)
% hObject    handle to convert_pb (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
InputString = get(handles.convert_pb,'Convert');

InputNumber = str2num(InputString);

Result = (5 / 9) * (InputNumber - 32);

set(handles.result, 'Convert', Result);

function degF_et_Callback(hObject, eventdata, handles)
% hObject    handle to degF_et (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of degF_et as text
%        str2double(get(hObject,'String')) returns contents of degF_et as a double
UserInput = str2double(get(hObject,'String'))

% --- Executes during object creation, after setting all properties.
function degF_et_CreateFcn(hObject, eventdata, handles)
% hObject    handle to degF_et (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
    if ispc && isequal(get(hObject,'BackgroundColor'),          get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end 
```

我应该做些什么来使任何编辑的人都更具可读性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:31:29.823

要获取在文本编辑框中输入的温度，请使用：

```
tempF = get(handles.degF_et,'String'); 
```

这可以从按钮功能中调用。

要更改那里显示的字符串，请使用：

```
set(handles.degF_et,'String','some string'); 
```

# macos - os x 终端命令

> ID：15531983
> 
> 赞同：0
> 
> 时间：2013-03-20T18:36:19.837
> 
> 标签：macos, terminal, file-rename

有谁知道我如何从目录中的所有文件名中删除“@2x~ipad”字符串，这样一个名为：image@2x~ipad.png 的文件将被重命名为：image.png 我需要重命名一个目录中的所有文件某个目录

我可以从终端循环吗？任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:13:23.700

使用 bash（在终端中）：

```
for file in *2x~ipad.png; do
  mv $file ${file%%\@2x~ipad.png}.png
done 
```

# networking - IP分片

> ID：15531985
> 
> 赞同：0
> 
> 时间：2013-03-20T18:36:24.773
> 
> 标签：networking, tcp, ip

我在网上的某个地方遇到了以下语句：“虽然理论上可以在一个片段中保证只有 8 个字节的 L4 信息，但假设完整的 L4 信息可用......”。我不明白如何在一个片段中保证只有 8 个字节的传输，因为 IP 片段不能小于 46 个字节（以太网帧的最小有效负载大小），这包括 20 个字节的 IP 标头和20 字节的 TCP 标头（不考虑可变长度选项），UDP 会更少。

因此，对于第一个 IP 片段，我们总是可以在 tcp 标头中期待 IP 标头，而其他片段将仅携带 IP 标头 + 有效负载。

我相信我遗漏了一些东西，但我仍然无法理解为什么片段中只能保证 8 个字节？如果有人帮助澄清这个问题，我会很感激。谢谢 ！

标记

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T18:46:36.297

想象一下，一个路由器接收到一个 TCP 数据包，其中包含比目标网络的 MTU 多一个字节的数据。它必须在 8 字节边界上拆分，因为[这是 IP 分段规则](https://www.rfc-editor.org/rfc/rfc791#page-8)。

它不会分成两个以上的片段，因为那会很愚蠢。所以它必须在第一个片段中包含至少一个字节的数据。

因此，您可以在 IP 数据报的第一个片段中放置的最小数据字节数是 8。

# php - 将html值分配给php中的变量

> ID：15531986
> 
> 赞同：0
> 
> 时间：2013-03-20T18:36:28.757
> 
> 标签：php, html, global-variables

我遇到了一个我无法弄清楚的问题。我有一个页面，我想添加“已验证”或“未验证”的图像。我的代码如下：

PHP

```
if($listing['priority']==0 {
   $header->set('ver_status,'<img src="images/icon_unverified.png"/>');
} else {
   $header->set('ver_status,'<img src="images/icon_verified.png"/>');
} 
```

HTML

```
<?php echo $ver_status; ?> 
```

出于某种原因，当我在我的网站上运行该页面时，该变量为空。

数据库包含一个列表表，该表包含一个默认值为 0 的优先级字段。除非客户更新信息，自动将优先级字段值更改为 1，否则所有配置文件状态为“未验证”

$header 是分配给模板的变量

0 处的所有优先级代码都应显示未经验证的图像。所有其他 1-5 都显示经过验证的图像。

我在另一个页面上做了这个，效果很好。该代码是：

```
if (config['language'] == 2) {
   $header->set('language_flag','<img src="images/flags/Spanish.png" />');
} else {
   $header->set('language_flag','<img src="images/flags/English.png" />');
} 
```

其中代码 2 是西班牙语，代码 1 是英语。

我的代码中是否缺少一些我没有看到的东西？我没有收到任何错误消息，只是空值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:42:41.453

您的 if 语句中似乎缺少一个右括号。如果直接从您的代码中复制并粘贴，则可能会导致问题 - 它也应该会导致错误消息，但您可能已将其关闭。

如果这只是将代码复制到 SO 中的错字，当然，这是没有帮助的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:48:09.253

该变量为空，因为没有变量。如果您想通过回显变量的值来检索图像，只需键入

```
if($listing['priority']===0){
    $ver_status='<img src="images/icon_unverified.png">';
}else{
    $ver_status='<img src="images/icon_verified.png">';
} 
```

您在代码中所做的是设置对象的键，但是当您尝试获取相同的键时，您没有正确引用它。`echo $header->ver_status`如果您不想使用普通变量，您应该如何检索该值。我建议阅读[http://php.net/manual/en/language.types.object.php](http://php.net/manual/en/language.types.object.php)

请注意，您的代码中也有错字。`t('ver_status,'`是一个开串。
另请注意，除非您使用 XML，否则标记中不需要斜杠。

# c++ - C++优先队列，逻辑错误，想不通

> ID：15531993
> 
> 赞同：0
> 
> 时间：2013-03-20T18:37:05.530
> 
> 标签：c++, priority-queue

我正在用 C++ 实现一个简单的优先级队列。

但是，当它运行时，它会打印出乱码。我是否以某种方式试图在我的代码中访问数组中的无效条目？

下面是代码。

另外，我的“删除”功能是否在某种程度上没有发挥作用？从概念上讲，我是否应该将 null 放入第一个条目并返回刚刚删除的内容？

谢谢。

[优先级.h]

```
#ifndef Priority_h
#define Priority_h

class Priority
{
    public:
        Priority(void);
        Priority(int s);
        ~Priority(void);

        void insert(long value);
        long remove();
        long peekMin();
        bool isEmpty();
        bool isFull();

        int maxSize;
        long queArray [5];
        int nItems; 

    private:

};

#endif 
```

[优先级.cpp]

```
#include <iostream>
#include <string>
#include <sstream>
#include <stack>
#include "Priority.h"

using namespace std;

Priority::Priority(void)
{

}

Priority::Priority(int s)
{
    nItems = 0;
}

Priority::~Priority(void)
{

}

void Priority::insert(long item)    
{
      int j;

      if(nItems==0)                         // if no items,
            {
            queArray[0] = item; nItems++;
            }// insert at 0
      else                                // if items,
         {
         for(j=nItems-1; j=0; j--)         // start at end,
            {
            if( item > queArray[j] )      // if new item larger,
               queArray[j+1] = queArray[j]; // shift upward
            else                          // if smaller,
               break;                     // done shifting
            }  // end for
         queArray[j+1] = item;            // insert it
         nItems++;
         }  // end else (nItems > 0)

}

long Priority::remove()             
{ 
    return queArray[0];
}

long Priority::peekMin()            
{ 
    return queArray[nItems-1]; 
}

bool Priority::isEmpty()         
{ 
    return (nItems==0);
}

bool Priority::isFull()          
{
    return (nItems == maxSize); 
}

int main ()
{
      Priority thePQ; 
      thePQ.insert(30);
      thePQ.insert(50);
      thePQ.insert(10);
      thePQ.insert(40);
      thePQ.insert(20);

      while( !thePQ.isEmpty() )
         {
         long item = thePQ.remove();
         cout << item << " ";  // 10, 20, 30, 40, 50
         }  // end while
      cout << "" << endl;

    system("pause");
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T18:38:33.780

这是一个错误：

```
 for(j=nItems-1; j=0; j--)         // start at end,
                      ^ this is assignment, not comparison. 
```

我也不相信在

```
 queArray[j+1] = item;            // insert it 
```

最后，您的默认构造函数无法初始化`nItems`。

可能还有更多错误，但我会就此停止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T18:40:04.110

尝试在构造函数中初始化队列数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T18:41:54.183

我同意这里的其他答案，但我会补充一点：

您的“删除”方法实际上并没有删除任何东西 - 它只是返回第一个元素 - 但它不会对数组本身做任何事情。

编辑说您的插入方法需要一些工作 - 它可能会或可能不会写入数组的末尾，但它肯定会混淆它在做什么。

# xml - 在 VS 项目的 OutDir 开始时，最初的“.\”有什么作用？

> ID：15531994
> 
> 赞同：1
> 
> 时间：2013-03-20T18:37:06.390
> 
> 标签：xml, visual-studio-2010, visual-c++, path

我打开了一个 VCXPROJ 文件来更改目录路径，并且在`OutDir`XML 参数中，标记了以下内容：

```
<OutDir>.\..\..\..\..\..\Bin\$(PlatformName)\$(MsvcVer)\$(ProjectName)\</OutDir> 
```

我需要把它改成这样，但它有效吗？它是否需要`.\`在路径的开头？这到底是什么意思？

```
<OutDir>Bin\$(PlatformName)\$(MsvcVer)\$(ProjectName)\</OutDir> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T18:38:20.333

`.\`引用当前目录。你不应该需要它。

# ios - 将 NSDictionay 解析为 JSON NSData 的问题

> ID：15531999
> 
> 赞同：-1
> 
> 时间：2013-03-20T18:37:23.057
> 
> 标签：ios, objective-c, json, cocoa-touch, nsdictionary

我们如何将 NSDictionary 转换为 JSON 数据对象？我想将 JSON 数据发送到我的服务器。我正在使用下面的代码，但在 NSDictionary 包含 Array 或进一步的 NSDictionary 时遇到问题。这适用于简单的键值对。

问题：它在以下行失败并设置错误对象。如果我从源 myData 字典中删除数组和字典，这工作正常。

```
NSData *aPostBodyData = [NSJSONSerialization dataWithJSONObject:myData options:0 error:&error];

Where myData looks like:

{
    URI = "www.google.com";
    addOnTestString = "4,3,";
    status =     (
            "In Progress",
            Submitted,
            Delivered
        );
data = 

{
    URI = "www.test.com";
    testString = "43";
    status =     (
            "In Progress",
            Submitted,
            Delivered
        );
}
} 
```

错误跟踪：

![在此处输入图像描述](../Images/184f36711d0f695a67bc1502803c1839.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T19:05:01.767

好的，我只是编写了一个包含您的情况的示例代码，它运行良好。

```
 NSArray * myarray=@[@"a",@"b"];

        NSMutableDictionary * dict=[[NSMutableDictionary alloc] initWithObjects:@[@"a",myarray] forKeys:@[@"str",@"arr" ]];

        NSData * js=[NSJSONSerialization dataWithJSONObject:dict options:NSJSONWritingPrettyPrinted error:nil];

        NSString * jsString=[[NSString alloc] initWithData:js encoding:NSUTF8StringEncoding];

        NSLog(@"%@",jsString); 
```

您收到错误的可能原因可能是；

您的 myData 不在 NSDictionary 或 NSArray 类型中。

或者在将数组添加到字典时，您错过了一点。