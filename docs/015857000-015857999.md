# StackOverflow 问答 15857000-15857999

# css - 为什么 url 标记的事件之间有额外的空间？

> ID：15857001
> 
> 赞同：2
> 
> 时间：2013-04-06T23:00:38.320
> 
> 标签：css, fullcalendar, spacing

我有一个无法克服的全压延间距错误。

这是我的数据中没有链接时我的日历的样子

![在此处输入图像描述](https://i.stack.imgur.com/0ahHg.png)

```
$ticketData[] = array(
                'id' => $ticket->getId(),
                'title' => $title,
                'start' => $ticket->getArrival()->format('Y-m-d'),
                'end' => $ticket->getDeparture()->format('Y-m-d'), 
            ); 
```

现在，当我添加 URL 时：

![在此处输入图像描述](https://i.stack.imgur.com/ZnRfV.png)

这个奇怪的错误发生在其他人身上吗？我真的不知道发生了什么。我添加的唯一行是网址：

```
$ticketData[] = array(
                'id' => $ticket->getId(),
                'title' => $title,
                'start' => $ticket->getArrival()->format('Y-m-d'),
                'end' => $ticket->getDeparture()->format('Y-m-d'), 
                    'url' => $url
            ); 
```

这是我如何调用日历：

```
$('#calendar').fullCalendar({
    editable: false,
    header: {
        left: 'prev,next today',
        center: 'title',
        right: 'month,agendaWeek,agendaDay'
    },
    events: data_url,
    loading: function(bool) {
        if (bool) 
            $('#loading').show();
        else
            $('#loading').hide();
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-23T18:41:59.300

这几乎肯定是一个 CSS 问题。我的猜测是你有填充或边距击中这些链接。

# css - 使用 CSS 绘制文件夹图标

> ID：15857006
> 
> 赞同：2
> 
> 时间：2013-04-06T23:01:15.297
> 
> 标签：css

我正在尝试使用 CSS 绘制一个简单的文件夹图标，这就是我所在的位置：

```
/* CSS */
.container {
  border: solid 1px #000;
  width: 100px;
  height: 100px;
  padding: 5px;
  text-align: center;
}
.folder_tab, .folder {
  margin: 0 auto;
  background-color: #708090;
}
.folder_tab {
  width: 25px;
  height: 5px;
  margin-right: 50%;
  border-radius: 5px 15px 0 0;
}
.folder {
  width: 50px;
  height: 35px;
  border-radius: 0 5px 5px 5px;
  box-shadow: 1px 1px 0 1px #CCCCCC;
}

<!-- HTML -->
<div class="container">
  <div class="folder_tab"></div>
  <div class="folder"></div>
  text
</div> 
```

结果：![在此处输入图像描述](https://i.stack.imgur.com/ZokFk.png)

有没有更简单或更优雅的方法来做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-06T23:36:10.757

如果您想使用 CSS3，这是我的解决方案。

**HTML**

```
<div class="folder"></div> 
```

**CSS**

```
.folder {
    width: 150px;
    height: 105px;
    margin: 0 auto;
    margin-top: 50px;
    position: relative;
    background-color: #708090;
    border-radius: 0 6px 6px 6px;
    box-shadow: 4px 4px 7px rgba(0, 0, 0, 0.59);
}

.folder:before {
    content: '';
    width: 50%;
    height: 12px;
    border-radius: 0 20px 0 0;
    background-color: #708090;
    position: absolute;
    top: -12px;
    left: 0px;
} 
```

**[演示](http://jsfiddle.net/hK4pt/)**（在 Chrome 中测试）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-06T23:41:54.530

这是我的解决方案：

[http://jsfiddle.net/wQdgs/](http://jsfiddle.net/wQdgs/)

## HTML

```
<div>text</div> 
```

## CSS

```
div {
    width: 100px;
    height: 50px;
    padding-top: 50px;
    border: solid 1px #000;
    position: relative;
    text-align: center;
}

div:after {
    content: " ";
    width: 50px;
    height: 35px;
    border-radius: 0 5px 5px 5px;
    box-shadow: 1px 1px 0 1px #CCCCCC;
    display: block;
    background-color: #708090;
    position: absolute;
    top: 15px;
    left: 25px;    
}

div:before {
    content: " ";
    width: 25px;
    height: 5px;
    border-radius: 5px 15px 0 0;
    display: block;
    background-color: #708090;
    position: absolute;
    top: 10px;
    left: 25px;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-16T12:34:32.467

我知道这个线程有点老了，但我问自己是否有一些简单的纯 CSS 和简约 HTML 来更新我使用背景图像作为图标的旧树库，从而跳入了这个问题。

我自己尝试过，我想出了一些符合扁平化设计的东西，今天它正在彻底改变跨设备 UI：

[https://jsfiddle.net/landzup/Lzjadp5r/](https://jsfiddle.net/landzup/Lzjadp5r/)

这只是一个建议或一个起点，但是通过尽可能放大看到页面没有丢失一个像素的分辨率，真是太棒了！（就像矢量图形一样）。

我使用了一个简短的 HTML：

```
<div class="folder">
    <div class="icon"></div>
    Programming
</div> 
```

这是CSS：

```
<style type="text/css">
.folder {
    display: block;
    position: relative;
    top: 0;
    left: 0;
    margin: 18px 0;
    font: 18px helvetica, arial, sans-serif;
    text-indent: 27px;
    line-height: 34px;
}

.folder .icon {
    content: "";
    display: block;
    float: left;
    position: relative;
    top: 0;
    left: 0;
    width: 30px;
    height: 30px;
    border: 2px solid #999;
    background: #ddd;
    -moz-border-radius: 2px; -webkit-border-radius: 2px; -o-border-radius: 2px; border-radius: 2px;
    -moz-transform: scale(1) rotate(0deg) translateX(10px) skewX(10deg);
    -webkit-transform: scale(1) rotate(0deg) translateX(10px) skewX(10deg);
    -o-transform: scale(1) rotate(0deg) translateX(10px) skewX(10deg);
    -ms-transform: scale(1) rotate(0deg) translateX(10px) skewX(10deg);
    transform: scale(1) rotate(0deg) translateX(10px) skewX(10deg);
}

.folder .icon::after {
    content: "";
    display: block;
    position: relative;
    top: 7px;
    left: -6px;
    width: 30px; height: 21px;
    border: 2px solid #999;
    background: #ddd;
    -moz-border-radius: 2px; -webkit-border-radius: 2px; -o-border-radius: 2px; border-radius: 2px;
    -moz-transform: scale(1) rotate(0deg) translateX(10px) skewX(-20deg);
    -webkit-transform: scale(1) rotate(0deg) translateX(10px) skewX(-20deg);
    -o-transform: scale(1) rotate(0deg) translateX(10px) skewX(-20deg);
    -ms-transform: scale(1) rotate(0deg) translateX(10px) skewX(-20deg);
    transform: scale(1) rotate(0deg) translateX(10px) skewX(-20deg);
}
</style> 
```

它使用 CSS 3 转换，因此您应该考虑您的目标受众是否支持其浏览器。这里有 CSS 转换的 CSS 兼容性表：

[http://caniuse.com/#feat=transforms2d](http://caniuse.com/#feat=transforms2d)

# python - 从 Django 1.5 中的 ListView 中删除项目

> ID：15857008
> 
> 赞同：6
> 
> 时间：2013-04-06T23:01:27.467
> 
> 标签：python, django, templates, listview

我有一个 ListView 和一个 DeleteView

```
class MyDeleteView(DeleteView):
    success_url = reverse('list') 
```

我想要删除 ListView 中的项目的选项。如果我接受 DeleteView 中的确认页面，我知道该怎么做，但我不希望 DeleteView 中没有模板。我只想删除该项目并将用户送回。

我想应该是 POST 参数，但是 HTML 应该是什么样子？我想它是这样的：

```
<form method="post" action="/delete/">
    <ul>
        <li>Item1 (<input type="submit" value="Delete" />)</li>
        <li>Item2 (<input type="submit" value="Delete" />)</li>
        <li>Item3 (<input type="submit" value="Delete" />)</li>
    </ul>
</form> 
```

谁能带领我朝着正确的方向前进？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T07:59:03.313

使用 POST，您已经朝着[正确的方向前进。](http://www.w3.org/2001/tag/doc/whenToUseGet.html)

```
<ul>{% for item in object_list %}        
    <li><form method="post" action="{% url 'mydelete' pk=item.pk %}">
          {{item}} (<input type="submit" value="Delete" />)
    </form></li>
{% endif %}</ul> 
```

我不完全确定输入是否可以直接以您尝试遵守的 HTML 规范中的形式出现。所以你可能不得不用一些跨度或容器来表达这个想法。

如果输入提交，没有给你的设计师足够的造型自由，你可以将它们用作`<noscript>`后备并添加一些`<button>`或 javascript: 链接以获得漂亮的版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T23:26:41.053

由于您不想要确认，您可以在您的 deleteview 中覆盖 GET 方法并只使用链接：

```
class MyDeleteView(DeleteView):
    success_url = reverse('list')

    def get(self, *a, **kw):
        return self.delete(*a, **kw) 
```

* * *

```
<ul>
    {% for item in object_list %}
        <li>Item1 (<a href="{% url 'mydelete' pk=item.pk %}">Delete</a>)</li>
    {% endif %}
</ul> 
```

# cmake - CMake 依赖.make 文件为空

> ID：15857011
> 
> 赞同：1
> 
> 时间：2013-04-06T23:02:10.883
> 
> 标签：cmake

我开始使用 CMake 来构建我的 c++ 源文件，当我最初构建时，我看到了一个奇怪的说法：

'cmake ../' 将生成目录结构

'make' 将构建所有

正如预期的那样，任何连续的 make 命令都不会构建任何东西

'cmake ../' 显然什么都不做

'make' 将重建所有

正如预期的那样，任何连续的 make 命令都不会构建任何东西

有我的 CMakelists.txt：

```
cmake_minimum_required(VERSION 2.6)

set(CMAKE_CXX_COMPILER "g++")
set(CMAKE_CXX_FLAGS "-Wall -pipe")

set(var_target CommonBase)
set(var_path_source base)
project(Prj_${var_target})

file(GLOB_RECURSE var_sources ${var_path_source}/*.cpp)
add_library(${var_target} SHARED ${var_sources})

install(TARGETS ${var_target} DESTINATION ${PROJECT_SOURCE_DIR}/install) 
```

看起来更好，首先'cmake ../'命令文件'CMakeFiles/CommonBase.dir/depend.make'为空，随后的make命令将插入文件依赖项列表

我的 CMakelists.txt 有问题吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:26:47.697

这里有几个问题。

问题的实际原因是命令`set(CMAKE_CXX_FLAGS ...)` *之前*的行`project`。

该`project`命令在第一次运行时做了很多工作，实际上清除了这个变量作为副作用。因此，在您第一次运行 CMake 时，编译器标志为空，此后始终包含您`set`要使用的内容。（这只是您第二次运行 CMake，这会导致 make 重新编译所有，而不是 CMake 的后续运行）。

尝试用 s 包装您的`project`电话`message`以查看效果：

```
message("CMAKE_CXX_FLAGS - ${CMAKE_CXX_FLAGS}")
project(Prj_${var_target})
message("CMAKE_CXX_FLAGS - ${CMAKE_CXX_FLAGS}") 
```

删除您的 CMakeCache.txt 文件（在您的构建根目录中），然后`cmake ..`重复运行。

要解决此问题，请将您的`set(CMAKE_CXX_FLAGS ...)`移至`project`命令之后。

第二个问题是不建议`CMAKE_CXX_COMPILER`在 CMakeLists.txt 中设置。查看下面的评论“[在 CMake 中设置默认编译器](https://stackoverflow.com/questions/7081820/setting-default-compiler-in-cmake)”，以及 CMake 的常见问题解答条目的链接[如何使用不同的编译器？](http://www.cmake.org/Wiki/CMake_FAQ#How_do_I_use_a_different_compiler.3F)

# python - Python：为存储在字符串中的链接生成新的 URL

> ID：15857014
> 
> 赞同：3
> 
> 时间：2013-04-06T23:02:52.320
> 
> 标签：python, string, prepend

我有动态生成的包含 HTML 链接的字符串。例如，字符串可能包含：

```
You can visit <a class="hyperlink" href="https://www.stackoverflow.com">Stack Overflow</a> or <a class="hyperlink" href="https://www.reddit.com">Reddit.com</a> for help, or you can visit <a href="hyperlink" href="https://www.google.com">https://www.google.com</a> 
```

我正在尝试查找所有 href 并为它们生成新的 URL，然后将它们插入回字符串中。所以上面的例子，如果成功运行，看起来像：

```
You can visit <a class="hyperlink" href="https://mydomain.com/www.stackoverflow.com">Stack Overflow</a> or <a class="hyperlink" href="https://mydomain.com/reddit.com">Reddit.com</a> for help, or you can visit <a href="hyperlink" href="https://mydomain.com/www.google.com">https://www.google.com</a> 
```

我对 Python 还是很陌生，并且还没有成功地弄清楚如何找到一个 href 并将其值添加到我的“自定义”域中。任何见解将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T23:12:18.677

这是使用正则表达式的理想场所。

```
import re

text = 'You can visit <a class="hyperlink" href="https://www.stackoverflow.com">Stack Overflow</a>'
new_text = re.sub(r'href="http(s)?:\/\/(.+?)"', r'href="https://mydomain.com/\2"', text) 
```

# javascript - 使用 window.location 更改页面

> ID：15857015
> 
> 赞同：0
> 
> 时间：2013-04-06T23:03:04.797
> 
> 标签：javascript, jquery, html

我真的不知道给这个取什么标题。我正在使用 jQuery，因此当用户单击 div 时，它会将它们传输到基于 div 类的页面：

```
window.location = $(this).attr('class'); 
```

假设我从网络服务器（本地主机）连接。第一次点击可能会把我带到

```
localhost/info 
```

如果我点击关于，它会带我到

```
localhost/info/about 
```

我想知道如何让它把我转移到

```
localhost/about 
```

代替

```
localhost/info/about 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T23:07:31.390

首先，`location`是一个对象。虽然分配给它确实有效，但最好分配给`location.href`.

此外，`class`用于此的属性选择是一个错误的选择，因为它非常有限。相反，您应该考虑一个数据属性：

```
<div data-href="/about"></div> 
```

注意`/`属性值中的 。这就是您提出与域相关的请求所需要的。现在你到达那里：

```
location.href = this.getAttribute("data-href"); 
```

PS。每次有人写作`$(this).attr(...)`，就有一只独角兽死去。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T23:07:13.637

您需要使用绝对路径而不是相对路径。为此，您可以`/`在课程前添加一个。

```
window.location = "/" + $(this).attr('class'); 
```

# python - 如何在 Python 中识别不可使用 CTRL +C 中断的代码的原因

> ID：15857017
> 
> 赞同：3
> 
> 时间：2013-04-06T23:03:39.303
> 
> 标签：python, keyboardinterrupt

我正在使用请求来提取一些文件。我注意到在从 5K 到 20K 的大量迭代之后，该程序似乎挂起。我可以说它挂了，因为存储结果的文件夹在几个小时内没有改变。我一直试图通过按 CTRL + C 来中断进程（我正在使用 IDLE），但无济于事。我想中断而不是终止进程，因为重新启动更容易。我终于不得不终止这个过程。我重新启动，它再次运行良好，直到我有相同的症状。我想弄清楚如何诊断问题，但由于我不得不杀死所有东西，所以我不知道从哪里开始。

是否有其他方法可以查看正在发生的事情或更有效地中断该过程？

我一直在假设，如果我可以在不杀戮的情况下中断，我可以查看全局变量，或者做一些其他的事情来弄清楚我的代码挂在哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-09T16:08:28.370

万一还不算太晚：我刚刚遇到了同样的问题并有一些提示

第一件事：在 python 中，大多数等待的 api 是不可中断的（即 Thread.join()、Lock.acquire()...）。查看这些页面以获取更多信息： [http ://snakesthatbite.blogspot.fr/2010/09/cpython-threading-interrupting.html](http://snakesthatbite.blogspot.fr/2010/09/cpython-threading-interrupting.html) [http://docs.python.org/2/library/thread.html](http://docs.python.org/2/library/thread.html)

那么如果一个线程正在等待这样的调用，它就不能被停止。还有一件事要知道：如果一个正常的线程正在运行（或挂起），主程序将无限期地停留，直到所有线程都停止或进程被终止。

为避免这种情况，您可以在调用 Thread.start() 之前使线程成为守护线程：Thread.daemon=True。

第二件事，要找到你的程序挂在哪里，你可以使用调试器启动它，但我更喜欢日志记录，因为日志总是在那里，以防调试迟到。

尝试在每次等待调用之前和之后记录，以查看您的线程已挂起多长时间。要获得高质量的日志，请使用配置了文件处理程序、html 处理程序甚至更好的 syslog 处理程序的 python 日志记录。

# asp.net - 使用媒体查询隐藏表格内容

> ID：15857019
> 
> 赞同：0
> 
> 时间：2013-04-06T23:04:14.080
> 
> 标签：asp.net, html, css, media-queries

我一直在使用媒体查询来使用响应式 CSS，目前我正试图在以 480 像素查看时隐藏某些表格内容。我在名为“hideOnSmall”的 CSS 中创建了一个名为“hideOnSmall”的类，然后将标签添加到“位置”的模板字段中，但我还没有让它真正起作用，所以我一定是做错了什么我已经查找了执行此操作的方法以及所有消息来源让我明白了这一点，但如果有人能发现我遗漏的任何东西，或者我做错了什么。

CSS：

```
 @media (max-width: 480px) {
  .nav-collapse {
    -webkit-transform: translate3d(0, 0, 0);
  }
  .page-header h1 small {
    display: block;
    line-height: 20px;
  }
  input[type="checkbox"],
  input[type="radio"] {
    border: 1px solid #ccc;
  }
  .form-horizontal .control-label {
    float: none;
    width: auto;
    padding-top: 0;
    text-align: left;
  }
  .form-horizontal .controls {
    margin-left: 0;
  }
  .form-horizontal .control-list {
    padding-top: 0;
  }
  .form-horizontal .form-actions {
    padding-left: 10px;
    padding-right: 10px;
  }
  .media .pull-left,
  .media .pull-right {
    float: none;
    display: block;
    margin-bottom: 10px;
  }
  .media-object {
    margin-right: 0;
    margin-left: 0;
  }
  .modal {
    top: 10px;
    left: 10px;
    right: 10px;
  }
  .modal-header .close {
    padding: 10px;
    margin: -10px;
  }
  .carousel-caption {
    position: static;
  }
    .hideOnSmall  {
      display: none !important;
  }
} 
```

HTML

```
<asp:TemplateField HeaderText="Location" SortExpression="locationName" ItemStyle-CssClass="hideOnSmall">
    <EditItemTemplate>
        <asp:DropDownList ID="DropDownLocations" runat="server" DataSourceID="SqlDSLocations" DataTextField="locationName" DataValueField="locationID" SelectedValue='<%# Bind("locationID") %>'></asp:DropDownList>
        <asp:SqlDataSource ID="SqlDSLocations" runat="server" ConnectionString="<%$ ConnectionStrings:ConnectionString %>" SelectCommand="SELECT [locationID], [locationName] FROM [tblLocation]"></asp:SqlDataSource>
    </EditItemTemplate>
    <InsertItemTemplate>
        <asp:TextBox ID="TextBox2" runat="server" Text='<%# Bind("locationName") %>'></asp:TextBox>
    </InsertItemTemplate>
    <ItemTemplate>
        <asp:Label ID="Label2" runat="server" Text='<%# Bind("locationName") %>'></asp:Label>
    </ItemTemplate>
</asp:TemplateField> 
```

# symfony - 注释“@Doctrine\ODM\MongoDB\Mapping\Annotations\Text”不存在，或者无法自动加载。

> ID：15857024
> 
> 赞同：0
> 
> 时间：2013-04-06T23:05:09.150
> 
> 标签：symfony, symfony-2.3

有人可以解释一下我需要做什么来解决这个错误：

[语义错误] 属性 tz\JobsBundle\Document\gui::$description 中的注释“@Doctrine\ODM\MongoDB\Mapping\Annotations\Text”不存在，或者无法自动加载。

# string - 将字符串转换为参数时，Bash 不解析引号

> ID：15857027
> 
> 赞同：15
> 
> 时间：2013-04-06T23:05:18.647
> 
> 标签：string, bash, arguments, spaces, quoting

这是我的问题。在 bash 3 中：

```
$ test='One "This is two" Three'
$ set -- $test
$ echo $2
"This 
```

如何让 bash 理解引号并将 $2 作为`This is two`而不是返回`"This`？不幸的是，我无法更改`test`此示例中调用的变量的构造。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-06T23:44:56.873

发生这种情况的原因是由于 shell 解析命令行的顺序：它解析（并删除）引号和转义，然后替换变量值。当时间`$test`被替换为 时`One "This is two" Three`，引号达到预期效果为时已晚。

执行此操作的简单（但危险）方法是添加另一个级别的解析`eval`：

```
$ test='One "This is two" Three'
$ eval "set -- $test"
$ echo "$2"
This is two 
```

（请注意，`echo`命令中的引号不是必需的，但这是一个很好的一般做法。）

我说这很危险的原因是它不只是返回并重新解析引用的字符串，它会返回并重新解析*所有内容*，可能包括您不希望解释为命令替换的内容。假设你已经设置

```
$ test='One `rm /some/important/file` Three' 
```

...`eval`实际上将运行该`rm`命令。因此，如果您不能指望 的内容`$test`是“安全的”，**请不要使用此构造**。

顺便说一句，做这种事情的正确方法是使用数组：

```
$ test=(One "This is two" Three)
$ set -- "${test[@]}"
$ echo "$2"
This is two 
```

不幸的是，这需要控制变量的创建方式。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-03-29T10:25:13.530

现在我们有了 bash 4，可以在其中执行类似的操作：

```
#!/bin/bash

function qs_parse() { 
    readarray -t "$1" < <( printf "%s" "$2"|xargs -n 1 printf "%s\n" ) 
}

tab='   '  # tabulation here
qs_parse test "One 'This is two' Three -n 'foo${tab}bar'"

printf "%s\n" "${test[0]}"
printf "%s\n" "${test[1]}"
printf "%s\n" "${test[2]}"
printf "%s\n" "${test[3]}"
printf "%s\n" "${test[4]}" 
```

输出，如预期：

```
One
This is two
Three
-n
foo     bar  # tabulation saved 
```

实际上，我不确定，但在较旧的 bash 中可能会这样做：

```
function qs_parse() {
    local i=0
    while IFS='' read -r line || [[ -n "$line" ]]; do
        parsed_str[i]="${line}"
        let i++
    done < <( printf "%s\n" "$1"|xargs -n 1 printf "%s\n" )
}

tab='   ' # tabulation here
qs_parse "One 'This is two' Three -n 'foo${tab}bar'"

printf "%s\n" "${parsed_str[0]}"
printf "%s\n" "${parsed_str[1]}"
printf "%s\n" "${parsed_str[2]}"
printf "%s\n" "${parsed_str[3]}"
printf "%s\n" "${parsed_str[4]}" 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-05-23T03:23:46.663

这个问题的解决方案是使用 xargs (eval free)。
它将双引号字符串保留在一起：

```
$ test='One "This is two" Three'
$ IFS=$'\n' arr=( $(xargs -n1 <<<"$test") )
$ printf '<%s>\n' "${arr[@]}"
<One>
<This is two>
<Three> 
```

当然，您可以使用该数组设置位置参数：

```
$ set -- "${arr[@]}"
$ echo "$2"
This is two 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-26T22:54:48.837

我写了几个本机 bash 函数来做到这一点：[https ://github.com/mblais/bash_ParseFields](https://github.com/mblais/bash_ParseFields)

您可以`ParseFields`像这样使用该功能：

```
$ str='field1 field\ 2 "field 3"'
$ ParseFields -d "$str" a b c d
$ printf "|%s|\n|%s|\n|%s|\n|%s|\n" "$a" "$b" "$c" "$d"
|field1|         
|field 2|
|field 3|
|| 
```

ParseFields的`-d`选项会删除任何周围的引号并解释解析字段中的反斜杠。

还有一个更简单的`ParseField`函数（由 使用`ParseFields`）解析字符串中特定偏移量的单个字段。

请注意，这些函数无法解析*流*，只能解析字符串。IFS 变量还可用于指定除空格之外的字段分隔符。

如果您要求未转义的撇号可能出现在*未引用*的字段中，则需要稍作更改 - 让我知道。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-28T07:18:13.453

```
test='One "This is two" Three'
mapfile -t some_args < <(xargs -n1 <<<"$test")
echo "'${some_args[0]}'" "'${some_args[1]}'" "'${some_args[2]}'" 
```

输出：'一''这是二''三'

# wpf - WPF 使用基本身份验证对 ASP.NET MVC Rest Service 进行身份验证

> ID：15857033
> 
> 赞同：0
> 
> 时间：2013-04-06T23:05:52.367
> 
> 标签：wpf, asp.net-mvc, rest, authentication, service

我正在开发一个使用 ASP.NET MVC（Restful Behavior）的 WPF 应用程序。MVC 应用程序正在使用基本身份验证。那么，如何验证我的 WPF 应用程序以访问 MVC Url？请建议。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T09:16:11.253

您可以使用[`HttpClient`](http://msdn.microsoft.com/en-us/library/system.net.http.httpclient.aspx)：

```
using (var client = new HttpClient())
{
    var username = "john";
    var password = "secret";

    var buffer = Encoding.ASCII.GetBytes(string.Concat(username, ":", password));
    var authHeader = new AuthenticationHeaderValue("Basic", Convert.ToBase64String(buffer));
    client.DefaultRequestHeaders.Authorization = authHeader;
    var task = client.GetAsync("https://example.com/somemethod");
    if (task.Result.StatusCode == HttpStatusCode.Unauthorized)
    {
        Console.WriteLine("wrong credentials");
    }
    else
    {
        task.Result.EnsureSuccessStatusCode();
        Console.WriteLine(task.Result.Content.ReadAsAsync<string>().Result);
    }
} 
```

# shell - 使用正则表达式重命名 shell 脚本

> ID：15857045
> 
> 赞同：0
> 
> 时间：2013-04-06T23:08:37.537
> 
> 标签：shell, loops, for-loop, rename

我正在尝试制作一个小 shell 脚本来重命名所有以`vlc-record*`.

所以基本上我已经用 vlc 播放器做了一些录音，但我不喜欢选择的“标题”，所以我想狙击第一个字符。

例如：

```
vlc-record-2013-01-18-01h14m49s-title_of_the_dj.mp3 
```

我只想将其重命名为：

```
title_of_the_dj.mp3 
```

有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T23:12:19.173

```
#!/bin/sh
for i in vlc-record-*.mp3; do
  echo mv "$i" "${i##*-}"
done 
```

如果您喜欢它生成的命令，请删除该`echo`单词并重新运行脚本。

# eclipse - Hadoop 和 Eclipse 环境

> ID：15857049
> 
> 赞同：1
> 
> 时间：2013-04-06T23:09:17.467
> 
> 标签：eclipse, hadoop

尝试按照[此站点](http://wiki.apache.org/hadoop/EclipseEnvironment)配置 Eclipse 和 Hadoop 。

我成功运行：

```
git clone git://git.apache.org/hadoop-common.git 
```

现在我失败了：

```
mvn install -DskipTests

[INFO] Apache Hadoop Main ................................ SUCCESS [6.688s]
[INFO] Apache Hadoop Project POM ......................... FAILURE [1.548s]
...
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-antrun-plugin:1.6:run (create-testdirs) on project hadoop-project: Error executing ant tasks: /usr/local/hadoop/hadoop-common/hadoop-project/target/antrun/build-main.xml (No such file or directory) -> [Help 1] 
```

原因是我在`.../hadoop-project`. 我的 /hadoop-project 文件夹仅包含一个“src”文件夹，仅此而已。

所以看起来该文件夹没有建立。有任何想法吗？这里是环境：

```
Ubuntu 12.1
Hadoop 1.0.4
Maven 3.0.4 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T13:56:23.180

查询中提到的[站点用于开发 Hadoop](http://wiki.apache.org/hadoop/EclipseEnvironment) **，**而不是用于**使用**Hadoop 开发应用程序。两者是有区别的。

以下是在 Eclipse 中开发/调试 MapReduce 程序的[说明。](http://www.thecloudavenue.com/2012/10/debugging-hadoop-mapreduce-program-in.html)请注意，该过程仅适用于 Linux 操作系统。

# node.js - 首次运行创建快速项目会出现错误

> ID：15857051
> 
> 赞同：0
> 
> 时间：2013-04-06T23:09:31.070
> 
> 标签：node.js, express

我在全球范围内安装了快递。

我创建了一个名为 helloExpress 的新项目，如下所示：

```
express helloExpress -c less 
```

安装所有依赖项：

```
cd helloExpress
sudo npm install 
```

运行应用程序：

```
node app.js 
```

输出错误：

```
/home/dev/projects/helloExpress/app.js:1
s., */,,var expr
      ^

node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
SyntaxError: Unexpected token ,
    at Module._compile (module.js:429:25)
    at Object..js (module.js:459:10)
    at Module.load (module.js:348:32)
    at Function._load (module.js:308:12)
    at Array.0 (module.js:479:10)
    at EventEmitter._tickCallback (node.js:192:41) 
```

查看 app.js 的代码，它看起来像这样：

```
/**, * Module dependencies., */,,var express = require('express'),  , routes = require('./routes'),  , user = require('./routes/user'),  , http = require('http'),  , path = require('path');,,var app = express();// all environments,app.set('port', process.env.PORT || 3000);,app.set('views', __dirname + '/views');,app.set('view engine', 'jade');,app.use(express.favicon());,app.use(express.logger('dev'));,app.use(express.bodyParser());,app.use(express.methodOverride());,app.use(app.router);undefined  app.use(require('less-middleware')({ src: __dirname + '/public' }));,app.use(express.static(path.join(__dirname, 'public')));,,// development only,if ('development' == app.get('env')) {,  app.use(express.errorHandler());,},,app.get('/', routes.index);,app.get('/users', user.list);,,http.createServer(app).listen(app.get('port'), function(){,  console.log('Express server listening on port ' + app.get('port'));,});, 
```

如您所见，无处不在。这是一个已知的错误还是我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T21:58:27.803

正如 Jonathan Lonowski 在评论中所说，我使用的 Node.js 版本太旧了。

我按照本教程安装了更新版本的 Node.js：http: [//slopjong.de/2012/10/31/how-to-install-the-latest-nodejs-in-ubuntu/](http://slopjong.de/2012/10/31/how-to-install-the-latest-nodejs-in-ubuntu/)

# java - 将值从 JSP 发送到 servlet

> ID：15857053
> 
> 赞同：1
> 
> 时间：2013-04-06T23:09:53.610
> 
> 标签：java, forms, jsp, servlets, href

我在 JSP 中有一个对象列表，并希望根据单击的超链接将值发送回 servlet。我的代码如下所示。

```
<body>
    <h1>Choose a Festival</h1>
    <jsp:useBean id="allFestivals" type="java.util.ArrayList" scope="session" />
    <table border ="1">
        <tr>
            <td>Festival Name:</td>
            <td>Location:</td>
            <td>Start Date:</td>
            <td>End Date:</td>
            <td>URL:</td>
            <td>List of Trips to </td>
        </tr>
        <c:forEach items="${allFestivals}" var="allFestivals">
        <tr>      
            <td>${allFestivals.festivalName}</td>
            <td>${allFestivals.location}</td>
            <td>${allFestivals.startDate}</td>
            <td>${allFestivals.endDate}</td>
            <td>${allFestivals.URL}</td>
            <td>
                //THE ISSUE IS IN THIS FORM, I SUPPOSE SYNTAX ISSUE
                <form name="linkChecker" method="get" action="ControllerServlet">
                    <input type = "hidden" value="${allFestivals.ID}" name="festivalProfileLink" /> 
                    <a HREF ="javascript:document.linkChecker.submit()">View Related Trips</a>
                </form>
            </td>
        </tr>
        </c:forEach>
    </table> 

<a href="logout.jsp">Logout</a>

</body> 
```

和 servlet GET 方法：

```
 @Override
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException  {

    String aa = request.getParameter("festivalProfileLink");
    JOptionPane.showMessageDialog(null, aa);
    if("hello".equals(aa)) {
            JOptionPane.showMessageDialog(null, "dfgdfgdf");
    }
 } 
```

目前没有信息（或至少没有价值）被发送到 servlet

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T23:12:35.330

`doGet()`您正在发出 POST 请求，但在尝试中不会得到结果`doPost()`

根据您帖子的编辑编辑答案

对于这种类型的操作 GET 非常适合你可以生成链接

正如[您之前的帖子中](https://stackoverflow.com/questions/15840506/sending-chosen-information-from-jsp-to-a-servlet-when-a-hyper-link-is-clicked)所建议的那样，您应该生成将通过 URL 传递参数的链接

使用这种方法，我怀疑您发布的路径错误，您可以使用 firebug 对其进行调查

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T23:53:45.110

在 Servlet 中使用 JOptionPane 真的很奇怪——而不是只记录一些东西。

# linq - 类型转换一个值并获取一个属性 Linq

> ID：15857064
> 
> 赞同：1
> 
> 时间：2013-04-06T23:11:53.567
> 
> 标签：linq, c#-4.0

我有对象列表，我需要获取列表中所有对象的属性 A。这就是我获取列表中对象属性的方式

```
 ((myClass)(finalProjectList[0])).A 
```

如何将对象键入 myClass 并获取每个对象的属性 A 并将其放入列表中

谢谢，SCP

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T23:14:32.990

您可以使用该[`Enumerable.Cast`](http://msdn.microsoft.com/en-us/library/bb341406.aspx)方法。像这样的东西应该适合你：

```
var As = finalProjectList.Cast<myClass>().Select(x => x.A); 
```

如果您的源列表包含对象的混合集合（即并非所有对象都是 type `myClass`），您应该[`Enumerable.OfType`](http://msdn.microsoft.com/en-us/library/bb360913.aspx)改用：

```
var As = finalProjectList.OfType<myClass>().Select(x => x.A); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T23:15:17.923

也许：

```
var result = finalProjectList.Select(x => ((myClass)x).A).ToList(); 
```

我不知道为什么需要铸造。它闻起来有点。的实际类型是`finalProjectList`什么？上面的代码假设它是实现*generic* `IEnumerable<>`的东西。

如果要跳过不是 type 的元素，请`myClass`改用：

```
var result = finalProjectList.OfType<myClass>().Select(mc => mc.A).ToList(); 
```

# php - 在MongoDB中存储实时数据

> ID：15857069
> 
> 赞同：1
> 
> 时间：2013-04-06T23:12:24.737
> 
> 标签：php, mongodb, arduino, database

我正在使用来自网站的 API 将数据推送到服务器。每次我的 arduino 检测到脉冲时，它都会将其发送到 COSM。通过使用触发器，数据会发送到我的服务器。我最初将数据写入 .txt 文件和 Json 对象，但现在我想开始实现 mongo 以拥有不同的集合。

由于某种原因，当我尝试将其编写为 Mongo 集合时，在添加 Mongo 连接后，数据没有传输到我的服务器。我希望能够直接在 Mongo 中写下信息，避免创建文件。

任何建议都非常受欢迎，这里是代码：

```
<?php

// Creating a data base in Mongodb to store my information from my $jsonFile
$connection = new MongoClient(); //Connect to mongo
$db = $connection -> qandm; // select my DB which is called qandM
$collection = $db -> pulseData;

//Gets all the information from Cosm
$pulse = $_POST['body'];

//access and open a file
//echo $pulse;

//Converts the data into PHP arrays
$pulseObj = json_decode($pulse, true);

//Parse through the specific information from the array and gets each piece of information in an array
$userName = $pulseObj["triggering_datastream"]["id"];
$dataTime= $pulseObj["triggering_datastream"]["at"];
$dataValue= $pulseObj["triggering_datastream"]["value"]["value"];

//Writes all the data coming from COSM
$file = fopen("data.txt", "a+");//a+ give the option to have the cursor at the end to access the file read and write it
    /*  $pulse.="\r\n"; */
fwrite($file, $pulse);//takes incoming data and writes it in the file
fclose($file);

//Opens a new .txt file and writes the values that we selected before into our file
$string = $userName." ".$dataTime." ".$dataValue." \r\n";
//error_log allows me to see in my Apache log server the information that I'm printing
error_log($string);

//Write all the information I parsed in my three variables in a new file
$file2 = fopen("rawData.txt", "a+");
fwrite($file2,$string);
fclose($file2);

//json sample

//Inputs the data from the time and the pulse value into a json object
$json = array("User" => $userName, "timestamp"=> $dataTime, "value"=> $dataValue);

//Opens a new json object
$jsonFile = fopen("data.json", "a+");

//Writes the data of our new arrayed information into the open json object
fwrite($jsonFile, json_encode($json));
fclose($jsonFile);

//A loop to populate
foreach($json as $data){
    $collection->insert($data);

}

//find the data I just stored
$cursor = $collection->find();

//Output it in a UL
echo "<p> My Pulse </p>";

echo '<ul>';
foreach($cursor as $doc){

    echo' <li> My pulse is: '.$doc['value'];

}
 echo '</ul>';

/*$data = "data.txt";
$fh = fopen($data, "w") or die ("can't open file");
$data = json_encode($_POST);
fwrite($fh, $data);
fclose($fh);*/

//print_r($file);

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:28:07.937

这可能是您的问题的根源：

```
//A loop to populate
foreach($json as $data){
    $collection->insert($data);

} 
```

您正在遍历 $json 数组并将值（但不是键）传递给 MongoCollection 的 insert 方法。根据[文档](http://www.php.net/manual/en/mongocollection.insert.php)，此方法需要一个对象或一个数组。根据我对您尝试执行此 foreach 循环的代码的理解，应将其替换为以下内容：

```
$collection->insert($json); 
```

这将创建一个类似于您的数组的 mongo 对象。您的代码当前正尝试将每个数组元素的值作为单独的条目插入。

# javascript - 在画布中获取鼠标位置

> ID：15857071
> 
> 赞同：0
> 
> 时间：2013-04-06T23:12:36.870
> 
> 标签：javascript, html, canvas, mouseevent, mouseover

我正在尝试修改[此效果](http://cssdeck.com/labs/shattering-text-effect-in-canvas)以在我的画布中工作。但是，我似乎无法让鼠标位置正常工作。悬停区域不包含在我的画布中。

这是我如何尝试实现它的 CSSdeck：[http ://cssdeck.com/labs/ukktjtis](http://cssdeck.com/labs/ukktjtis)

影响：

```
function hoverText(){
window.requestAnimFrame = (function(){
    return  window.requestAnimationFrame       || 
        window.webkitRequestAnimationFrame || 
        window.mozRequestAnimationFrame    || 
        window.oRequestAnimationFrame      || 
        window.msRequestAnimationFrame     || 
        function( callback ){
            window.setTimeout(callback, 1000 / 60);
        };
})();

var canvas = document.getElementById("canvas"),
        ctx = canvas.getContext("2d"),
        keyword = "MacroPlay Games",
        imageData,
        density = 3,
        mouse = {},
        hovered = false,
        colors = ["0,120,232", "8,200,255", "30,140,255"],
        minDist = 20,
        bounceFactor = 0.7;

var W = window.innerWidth, H = window.innerHeight;

canvas.width = W;
canvas.height = H;

document.addEventListener("mousemove", function(e) {
    mouse.x = e.pageX-50;
    mouse.y = e.pageY+200;
}, false);

// Particle Object
var Particle = function() {
    this.w = Math.random() * 10.5;
    this.h = Math.random() * 10.5;
    this.x = -W;
    this.y = -H;
    this.free = false;

    this.vy = -5 + parseInt(Math.random() * 10) / 2;
    this.vx = -4 + parseInt(Math.random() * 8);

    // Color
    this.a = Math.random();
    this.color = colors[parseInt(Math.random()*colors.length)];

    this.setPosition = function(x, y) {
        this.x = x;
        this.y = y;
    };

    this.draw = function() {
        ctx.fillStyle = "rgba("+this.color+","+this.a+")";
        ctx.fillRect(this.x, this.y,  this.w,  this.h);
    }
};

var particles = [];

// Draw the text
function drawText() {
    ctx.clearRect(0, 0, W, H);
    ctx.fillStyle = "#000000";
    ctx.font = "100px 'Arial', sans-serif";
    ctx.textAlign = "center";
    ctx.fillText(keyword, W/2, H/2);
}

// Clear the canvas
function clear() {
    ctx.clearRect(0, 0, W, H);
}

// Get pixel positions
function positionParticles() {
    // Get the data
    imageData = ctx.getImageData(0, 0, W, W);
    data = imageData.data;

    // Iterate each row and column
    for (var i = 0; i < imageData.height; i += density) {
        for (var j = 0; j < imageData.width; j += density) {

            // Get the color of the pixel
            var color = data[((j * ( imageData.width * 4)) + (i * 4)) - 1];

            // If the color is black, draw pixels
            if (color == 255) {
                particles.push(new Particle());
                particles[particles.length - 1].setPosition(i, j);
            }
        }
    }
}

drawText();
positionParticles();

// Update
function update() {
    clear();

    for(i = 0; i < particles.length; i++) {
        var p = particles[i];

        if(mouse.x > p.x && mouse.x < p.x + p.w && mouse.y > p.y && mouse.y < p.y + p.h) 
            hovered = true;

        if(hovered == true) {

            var dist = Math.sqrt((p.x - mouse.x)*(p.x - mouse.x) + (p.y - mouse.y)*(p.y - mouse.y));

            if(dist <= minDist)
                p.free = true;

            if(p.free == true) {
                p.y += p.vy;
                p.vy += 0.15;
                p.x += p.vx;

                // Collision Detection
                if(p.y + p.h > H) {
                    p.y = H - p.h;
                    p.vy *= -bounceFactor;

                    // Friction applied when on the floor
                    if(p.vx > 0)
                        p.vx -= 0.1;
                    else 
                        p.vx += 0.1;
                }

                if(p.x + p.w > W) {
                    p.x = W - p.w;
                    p.vx *= -bounceFactor;
                }

                if(p.x < 0) {
                    p.x = 0;
                    p.vx *= -0.5;
                }
            }
        }

        ctx.globalCompositeOperation = "lighter";
        p.draw();
    }
}

(function animloop(){
    requestAnimFrame(animloop);
    update();
})();    
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:56:43.777

**强烈**建议您使用 jquery（或一些 js lib）来避免跨浏览器问题，例如获取鼠标位置。

您可以使用 jquery 在任何浏览器中轻松获取鼠标位置，如下所示：

```
// get the position of the canvas relative to the web page
    var canvasOffset=$("#canvas").offset();
    var offsetX=canvasOffset.left;
    var offsetY=canvasOffset.top;

// then in the mouse handler, get the exact mouse position like this:
    function handleMouseDown(e){
      mouseX=parseInt(e.clientX-offsetX);
      mouseY=parseInt(e.clientY-offsetY);

      // Put your mousedown stuff here

    }

// tell the browser to send mousedown events to the handleMouseDown function
$("#canvas").mousedown(function(e){handleMouseDown(e);}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T09:56:30.973

我个人更喜欢[hammer.js 之](http://eightmedia.github.io/hammer.js/)类的库。我已经将它用于我的所有项目 - 看看它，它非常好。

# asp.net-mvc - 如何通过代码获取当前迁移名称

> ID：15857073
> 
> 赞同：0
> 
> 时间：2013-04-06T23:12:52.783
> 
> 标签：asp.net-mvc, entity-framework

我的 ASP.NET MVC 4，代码优先 EF 应用程序中的代码是否可以检索当前迁移名称？我想在管理员的状态页面上显示迁移名称，作为健全性检查以验证是否已应用预期的迁移。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T18:25:24.673

您可以为此使用`DbMigrator`( [DbMigrator](http://msdn.microsoft.com/en-us/library/system.data.entity.migrations.dbmigrator(v=vs.103).aspx) ) 类。

例如

```
var migrator = new DbMigrator(_configuration);
var pending = migrator.GetPendingMigrations();
var all = migrator.GetLocalMigrations(); 
```

`_configuration`你的`Configuration`班级在哪里`Migraiton`？

您需要进行一些试验 - 看看哪个真正符合您的要求。

> 另外，我建议您制作一个“初始化程序”，而不仅仅是将其添加到代码中。因为它通常是这样完成的，并且是这些事情发生的“自然地点”（你不“叫它”，它“叫你”）。

**检查此链接以获取自定义初始化程序的实现**- 其中包括一些 DbMigrator 代码。
[如何创建初始化程序来创建和迁移 mysql 数据库？](https://stackoverflow.com/questions/15796115/how-to-create-initializer-to-create-and-migrate-mysql-database/15796416#15796416)

# java - Java 崩溃故障排除

> ID：15857076
> 
> 赞同：0
> 
> 时间：2013-04-06T23:13:12.067
> 
> 标签：java, crash, autohotkey, native-code, java-native-interface

我正在使用一种允许我在 java 中运行 AHK 代码的结构，在启动后大约 3-5 分钟后出现错误。我想知道是否有人对我应该在哪里调试有任何建议

```
 #
    # A fatal error has been detected by the Java Runtime Environment:
    #
    #  EXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x61308396, pid=9820, tid=7128
    #
    # JRE version: 7.0_17-b02
    # Java VM: Java HotSpot(TM) Client VM (23.7-b01 mixed mode, sharing windows-x86 )
    # Problematic frame:
    # V  [jvm.dll+0x148396]
    #
    # Failed to write core dump. Minidumps are not enabled by default on client versions of Windows
    #
    # An error report file with more information is saved as:
    # C:\Users\Preston\IdeaProjects\jBot\hs_err_pid9820.log
    #
    # If you would like to submit a bug report, please visit:
    #   http://bugreport.sun.com/bugreport/crash.jsp
    # The crash happened outside the Java Virtual Machine in native code.
    # See problematic frame for where to report the bug.
    # 
```

hs_err_pid9820.log：[http://pastebin.com/T7yhGNti](http://pastebin.com/T7yhGNti)

```
public static boolean control() {
    try {
        NativeCall.init();
        init();
        return true;
    } catch (Throwable t) {
        t.printStackTrace();
        System.out.println("\n" + "Something went wrong...");
        return false;
    }
}

public static void init() {
    IntCall textdll = new IntCall("AutoHotkey.dll", "ahktextdll");
    textdll.executeCall(new Object[]{"", "", ""});
    exec = new IntCall("AutoHotkey.dll", "ahkExec");
}

public static void ahk(String code) {
        exec.executeCall(code);
} 
```

完整源代码： http: [//pastebin.com/ndrnX4a1](http://pastebin.com/ndrnX4a1)

# jquery - 根据屏幕分辨率在javascript中更改CSS类的高度和宽度

> ID：15857077
> 
> 赞同：5
> 
> 时间：2013-04-06T23:13:20.677
> 
> 标签：jquery, screen-resolution

我希望 div 类“内容”的大小根据用户屏幕分辨率的大小而改变。

到目前为止，我已经写了这个 javascript

```
function resize()
{

    if ((screen.width>1024)) { $(".content").style.width = 560 + "px"; $(".content").style.height = 315 + "px" }
    if ((screen.width>1280)) { $(".content").style.width = 640 + "px"; $(".content").style.height = 360 + "px" }
    else { $(".content").style.width = 853 + "px"; $(".content").style.height = 480 + "px" }
}; 
```

显然在html中我有类'.content'

为什么这段代码不起作用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-06T23:19:27.303

您在这里的具体问题是您正在混合使用 jQuery 和原始 javascript。

要使用 jQuery 设置元素的宽度，请使用[width()](http://api.jquery.com/width)或[css()](http://api.jquery.com/css/)方法：

```
$(".content").width(560);
$(".content").css('width',560); 
```

话虽如此，您最好查看浏览器大小，而不是屏幕分辨率。无论我的屏幕大小如何，您的内容不应该响应我的浏览器大小吗？我不会让我的浏览器全屏显示。

最后，查看[css 媒体查询](http://css-tricks.com/css-media-queries/)甚至响应浏览器大小。有很多更好的方法可以做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-07T10:10:35.250

您可以尝试使用 jQuery 和 CSS

```
 function checkWindowSize() {  

    if ( $(window).width() > 1800 ) {  
        $('content').addClass('large');  
    }  
    else {  
        $('content').removeClass('large');  
    }  

}  

$(window).resize(checkWindowSize); 
```

对于 CSS，您需要像这样写出来：

```
#content{  

}  

.large #content{  

} 
```

这是一个教程[来源](http://net.tutsplus.com/tutorials/design-tutorials/quick-tip-different-layouts-for-different-widths/)

# android - Android加速度计，设备平放时发出声音

> ID：15857079
> 
> 赞同：0
> 
> 时间：2013-04-06T23:13:37.333
> 
> 标签：android, audio, accelerometer

我正在尝试构建一个简单的关卡应用程序。我想要的是当设备完全平坦（加速度计的 x，y 值几乎为 0）时，设备会在 5 秒后而不是立即发出哔声。

我正在使用以下代码，但我不知道我必须更改什么才能让声音在 5 秒后始终正常工作，而不是随机或立即工作。有人可以帮助我吗？

```
public void onSensorChanged(SensorEvent event) {
  x = event.values[0];
  y = event.values[1];
  long actualTime = System.currentTimeMillis();
  if(x > -0.1 && x < 0.1 && y > -0.1 && y < 0.1) {
    if(actualTime - lastUpdate >= 5000) {
      return;
    }
    lastUpdate = actualTime;
    try {
      AssetFileDescriptor afd = getAssets().openFd("beep.wav");
      mMediaplayer = new MediaPlayer();
      mMediaplayer.setDataSource(afd.getFileDescriptor(), afd.getStartOffset(), afd.getLength());
      afd.close();
      mMediaplayer.prepare();
      mMediaplayer.start();
      mMediaplayer.setOnCompletionListener(new OnCompletionListener() {
        public void onCompletion(MediaPlayer mp) {
          //mp.setLooping(false);
          mp.stop();
          mp.release();
        }
      });
    } catch(Exception e) {
      e.printStackTrace();
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:15:56.543

我认为 Timer 很适合你。可能是这样的，每次检测到运动时取消计时器并启动新计时器：

在您的活动中定义您的计时器（并确保在您离开活动时取消它）

```
Timer lastTouchedTimer = null; 
```

然后像这样更改您的 onSensorChanged：

```
 public void onSensorChanged(SensorEvent event) {
        float x = event.values[0];
        float y = event.values[1];

        if(x > -0.1 && x < 0.1 && y > -0.1 && y < 0.1) {
            if (lastTouchedTimer == null) {
                lastTouchedTimer = new Timer();
            } else
                lastTouchedTimer.cancel();
            }
            lastTouchedTimer.schedule(new TimerTask() {
                @Override
                public void run() {
                    try {
                        AssetFileDescriptor afd = getAssets().openFd("beep.wav");
                        mMediaplayer = new MediaPlayer();
                        mMediaplayer.setDataSource(afd.getFileDescriptor(), afd.getStartOffset(), afd.getLength());
                        afd.close();
                        mMediaplayer.prepare();
                        mMediaplayer.start();
                        mMediaplayer.setOnCompletionListener(new MediaPlayer.OnCompletionListener() {
                    public void onCompletion(MediaPlayer mp) {
                                //mp.setLooping(false);
                                mp.stop();
                                mp.release();
                            }
                        });
                    } catch(Exception e) {
                        e.printStackTrace();
                    }
                }
            }, 5000);
        }
    } 
```

这是我在示例活动中使用的活动。

```
package com.example.test;

import android.app.Activity;
import android.content.res.AssetFileDescriptor;
import android.hardware.Sensor;
import android.hardware.SensorEvent;
import android.hardware.SensorEventListener;
import android.media.MediaPlayer;
import android.os.Bundle;

import java.util.Timer;
import java.util.TimerTask;

public class MyActivity extends Activity {
    Timer lastTouchedTimer;
    MediaPlayer mMediaplayer;
    /**
     * Called when the activity is first created.
     */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        SensorEventListener newListener = new SensorEventListener() {
            @Override
            public void onSensorChanged(SensorEvent sensorEvent) {
                float x = sensorEvent.values[0];
                float y = sensorEvent.values[1];

                if(x > -0.1 && x < 0.1 && y > -0.1 && y < 0.1) {
                    if (lastTouchedTimer == null) {
                        lastTouchedTimer = new Timer();
                    } else
                        lastTouchedTimer.cancel();
                }
                lastTouchedTimer.schedule(new TimerTask() {
                    @Override
                    public void run() {
                        try {
                            AssetFileDescriptor afd = getAssets().openFd("beep.wav");
                            mMediaplayer = new MediaPlayer();
                            mMediaplayer.setDataSource(afd.getFileDescriptor(), afd.getStartOffset(), afd.getLength());
                            afd.close();
                            mMediaplayer.prepare();
                            mMediaplayer.start();
                            mMediaplayer.setOnCompletionListener(new MediaPlayer.OnCompletionListener() {
                                public void onCompletion(MediaPlayer mp) {
                                    //mp.setLooping(false);
                                    mp.stop();
                                    mp.release();
                                }
                            });
                        } catch(Exception e) {
                            e.printStackTrace();
                        }
                    }
                }, 5000);
            }

            @Override
            public void onAccuracyChanged(Sensor sensor, int i) {
                //To change body of implemented methods use File | Settings | File Templates.
            }
        };
    }
} 
```

它使用一个非常简单的 xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:orientation="vertical"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent"
        >
    <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="Heallo World, MyActivity"
            />
</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T23:18:05.303

使用处理程序。当设备变平时（该代码播放声音）从现在开始向处理程序发布一条延迟消息 5 秒。让处理程序在收到消息时播放声音。

这是“在 Y 秒内做 X”的标准方式。

# shader - 如何结合凹凸贴图法线和真实法线？

> ID：15857080
> 
> 赞同：1
> 
> 时间：2013-04-06T23:13:54.123
> 
> 标签：shader, hlsl, bump-mapping

我正在尝试使用凹凸贴图创建着色器。

我有对象的真实法线，我有凹凸贴图采样法线。我想做的是旋转采样的法线，以便在采样的法线点上“向上”在真实法线的方向上。

我一直在做数学，但我似乎做错了...... Y 在这个世界上。

```
// Vertex shader sends this matrix to the pixel shader
OUT.normal[0] = mul((float3x3)world, normal);
float3 temptan = cross(normal, float3(0, 0, 1));
temptan = normalize(temptan);
OUT.normal[2] = mul((float3x3)world, temptan);
OUT.normal[1] = cross(OUT.normal[0], OUT.normal[2]); calculating binormal (in world space)

// Pixel Shader:
// Get normal from bump texture
float3 normal = tex2D(normalmap, texCoord);
normal = normal * 2 - 1;
// Swap Z and Y, since Z is up on the texture, but Y is up in this world.
float temp = normal[1];
normal[1] = -normal[2];
normal[2] = temp;
// Multiply the sampled normal and the normal-basis matrix together.
normal = mul(normalMat, normal); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-06T23:45:48.297

当您想使用法线贴图（这实际上是“凹凸贴图”的意思）时，您需要两个额外的向量来完成您想要做的事情：*切线*和*副法线*。从几何法线和“凹凸贴图”的纹理空间计算切线和副法线。

[我确实在→我对 StackOverflow 问题“如何计算正切和副法线？”的回答](https://stackoverflow.com/a/5257471/524368)中解释了如何做到这一点。

法线、切线和副法线形成一个坐标系，可表示为 3×3 矩阵。这个矩阵实际上就是将法线贴图转换到模型局部空间所需的旋转矩阵，以便您可以将其用于光照计算。简而言之，你乘以这三个向量的三脚架形成的矩阵。

# javascript - Ember Data - 在对象内部分配一个值

> ID：15857083
> 
> 赞同：0
> 
> 时间：2013-04-06T23:14:10.180
> 
> 标签：javascript, ember.js, handlebars.js

我开始使用 ember 并尝试从 Api 获取一些数据并将其分配给 Emberjs 模型。

我的 api 返回如下内容：

```
 [
    {
        email: 'someemail@domain.com'
        name: {
            firstname: 'first name',
            lastname: 'last name'
        }
    }
    {
        email: 'someemail2@domain.com'
        name: {
            firstname: 'another first name',
            lastname: 'another last name'
        }
    },
    {
        email: 'someemail3@domain.com'
        name: undefined
    }

] 
```

我的代码是：

```
App.Store = DS.Store.extend({
  revision: 12,
});

App.Store.registerAdapter('App.Users', DS.Adapter.extend({
  findAll: function(store, type, id) {
    $.getJSON('https://domain.com/users?callback=?', {
        'auth_token': token
    }).done(function(json){
        store.loadMany(type, json);
    });
  },
}));

App.Store.registerAdapter('App.Users', DS.Adapter.extend({
  findAll: function(store, type, id) {
    $.getJSON('https://domain.com/users?callback=?', {
        'auth_token': token
    }).done(function(json){
        store.loadMany(type, json);
    });
  },
}));

App.Router.map(function() {
    this.route("users", { path: "/users" });
});

App.UsersRoute = Ember.Route.extend({
  model: function() {
    return App.Users.find();
  }
});

App.Users = DS.Model.extend({
    email: DS.attr('string'),
    firstname: DS.attr('string'),
    didLoad: function() {
        console.log('model loaded', this.toJSON());
    }
});

 <script type="text/x-handlebars" data-template-name="users">
    {{#each model}}
        {{email}} - {{firstname}}
    {{/each}}
</script> 
```

显然 firstname 对于数组中的每个对象都是空的。

有谁知道这样做的正确方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T08:50:58.930

您是否尝试过像这样设置您的用户模型：

```
App.Adapter.map('App.User', {
  名称：{嵌入：'总是'}
});

App.User = DS.Model.extend({
  电子邮件：DS.attr('string'),
  名称：DS.belongsTo('App.UserName')
});

App.UserName = DS.Model.extend({
  名字：DS.attr('string'),
  姓氏：DS.attr('string')
});
```

# drupal - 带有面板、分类、节点和 pathauto 的 Drupal 7 内容组织

> ID：15857084
> 
> 赞同：0
> 
> 时间：2013-04-06T23:14:10.947
> 
> 标签：drupal, drupal-taxonomy, pathauto, drupal-nodes

我想知道在drupal 7中组织内容的最可能方式是什么，使用pathauto和taxonomy来获取如下链接：

类别/子类别/节点

其中类别和子类别也可以被视为一个节点（如果您转到 example.com/category 或 example.com/category/subcategory，它将显示一篇文章）

感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T15:14:47.583

只需为节点链接设置如下路径：

```
[node:taxonomy-{yourvocabularyname}:parents:join-path]/[node:taxonomy-{yourvocabularyname}:name]/[node:title] 
```

它将为您提供类别/子类别/节点标题。

但我不明白你要求的第二部分......

# jquery - 防止 jquery 函数在所有具有相同名称的类上运行

> ID：15857087
> 
> 赞同：0
> 
> 时间：2013-04-06T23:14:28.097
> 
> 标签：jquery

我试图运行一个警告框，但只在我点击的元素上。因为我有几个同名的元素。

它适用于我创建的 JSfiddle，但当我在网站上运行它时却没有。然后警报框弹出与我同名的许多元素。

有任何想法吗 ？

```
$('insta').click(function(){alert("alert",this) }) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T23:18:24.377

```
$('.insta').click(function(){alert("alert",this) }) 
```

.insta 表示 CLASS #insta 表示 DIV。

# unix - 删除 FASTA 文件中的换行符

> ID：15857088
> 
> 赞同：11
> 
> 时间：2013-04-06T23:14:30.843
> 
> 标签：unix, awk, newline, bioinformatics, fasta

我有一个 fasta 文件，其中的序列用换行符分解。我想删除换行符。这是我的文件的示例：

```
>accession1
ATGGCCCATG
GGATCCTAGC
>accession2
GATATCCATG
AAACGGCTTA 
```

我想把它转换成这个：

```
>accession1
ATGGCCCATGGGATCCTAGC
>accession2
GATATCCATGAAACGGCTTA 
```

[我在这个网站上](http://seqanswers.com/forums/showthread.php?t=27567)找到了一个潜在的解决方案，如下所示：

```
cat input.fasta | awk '{if (substr($0,1,1)==">"){if (p){print "\n";} print $0} else printf("%s",$0);p++;}END{print "\n"}' > joinedlineoutput.fasta 
```

但是，这会在每个条目之间放置一个额外的换行符，因此文件如下所示：

```
>accession1
ATGGCCCATGGGATCCTAGC

>accession2
GATATCCATGAAACGGCTTA 
```

我是个 awk 菜鸟，但我尝试修改命令。我的猜测是`if (p){print "\n";}`罪魁祸首......可能`print "\n"`是添加两个换行符。我不知道如何只添加一个换行符……这可能很容易，但就像我说的，我是个菜鸟。这是我的（不成功的）解决方案：

```
awk '{if (substr($0,1,1)==">"){print "\n"$0} else printf("%s",$0);p++;}END{print "\n"}' input.fasta > joinedoutput.fasta 
```

但是，这会在文件的开头添加一个空行，因为它总是在打印第一个入藏号之前打印一个新行：

```
{empty line} 
>accession1
ATGGCCCATGGGATCCTAGC
>accession2
GATATCCATGAAACGGCTTA 
```

任何人都有解决方案以正确格式获取我的文件？谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-06T23:22:16.797

这个`awk`程序：

```
% awk '!/^>/ { printf "%s", $0; n = "\n" } 
/^>/ { print n $0; n = "" }
END { printf "%s", n }
' input.fasta 
```

将产生：

```
>accession1
ATGGCCCATGGGATCCTAGC
>accession2
GATATCCATGAAACGGCTTA 
```

### 解释：

在不以 a 开头的行上`>`，打印没有换行符的行并存储换行符（在变量中`n`）以备后用。

在以 开头的行上`>`，打印存储的换行符（如果有）和行。重置`n`，以防这是最后一行。

如果需要，以换行符结尾。

### 笔记：

> 默认情况下，变量被初始化为空字符串。不需要在[awk](/questions/tagged/awk "显示标记为“awk”的问题")中显式“初始化”一个变量，这是您在[c](/questions/tagged/c "显示标记为“c”的问题")和大多数其他传统语言中所做的。

-- [6.1.3.1 在程序中使用变量](http://www.gnu.org/software/gawk/manual/gawk.html#Using-Variables)，[GNU Awk 用户指南](http://www.gnu.org/software/gawk/manual/gawk.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-01-14T10:36:43.537

公认的解决方案很好，但它并不是特别 AWKish。考虑改用这个：

```
 awk '/^>/ { print (NR==1 ? "" : RS) $0; next } { printf "%s", $0 } END { printf RS }' file 
```

解释：

对于以 开头`>`的行，打印该行。如果该行不是文件中的第一行，则使用三元运算符打印前导换行符。对于不以 开头`>`的行，打印没有尾随换行符的行。由于文件中的最后一行不会以 开头`>`，因此请使用该`END`块打印最后一个换行符。

请注意，通过设置空输出记录分隔符、启用默认打印和重新分配以`>`. 尝试：

```
awk -v ORS= '/^>/ { $0 = (NR==1 ? "" : RS) $0 RS } END { printf RS }1' file 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-06T23:45:06.947

还有另一种 awk 单线，应该适用于您的情况。

```
awk '/^>/{print s? s"\n"$0:$0;s="";next}{s=s sprintf("%s",$0)}END{if(s)print s}' file 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-07T01:34:09.880

我会用`sed`这个。使用`GNU sed`：

```
sed ':a; $!N; /^>/!s/\n\([^>]\)/\1/; ta; P; D' file 
```

结果：

```
>accession1
ATGGCCCATGGGATCCTAGC
>accession2
GATATCCATGAAACGGCTTA 
```

解释：

创建一个标签，`a`。如果该行不是文件中的最后一行，则将其附加到模式空间。如果该行不以字符开头`>`，请执行替换`s/\n\([^>]\)/\1/`。如果在读取最后一个输入行后替换成功，则分支到 label `a`。打印到当前模式空间的第一个嵌入换行符。如果模式空间不包含换行符，则开始一个正常的新循环，就像发出了 d 命令一样。否则，删除模式空间中的文本直到第一个换行符，并使用生成的模式空间重新启动循环，而不读取新的输入行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-10-19T05:01:11.897

您可能对 bioawk 感兴趣，它是 awk 的改编版本，用于处理 fasta 文件

```
bioawk -c fastx '{ gsub(/\n/,"",seq); print ">"$name; print $seq }' file.fasta 
```

**注意：** [BioAwk](https://github.com/lh3/bioawk)基于[Brian Kernighan 的 awk](http://www.cs.princeton.edu/~bwk/btl.mirror/)，该 awk 记录在[Al Aho、Brian Kernighan 和 Peter Weinberger 的“The AWK Programming Language”中（Addison-Wesley，1988，ISBN 0-201-07981-X）](https://ia802309.us.archive.org/25/items/pdfy-MgN0H1joIoDVoIC7/The_AWK_Programming_Language.pdf) 。我不确定这个版本是否与[POSIX](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/awk.html#tag_20_06_13_13)兼容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-10-08T16:12:55.743

不要重新发明轮子。如果目标只是删除多行 fasta 文件中的换行符（展开 fasta 文件），请使用任何专门的生物信息学工具，例如[`seqtk`](https://github.com/lh3/seqtk)，如下所示：

```
seqtk seq -l 0 input_file 
```

例子：

```
# Create the input for testing:

cat > test_unwrap_in.fa <<EOF

>seq1 with blanks
ACGT ACGT ACGT
>seq2 with newlines
ACGT

ACGT

ACGT

>seq3 without blanks or newlines
ACGTACGTACGT

EOF

# Unwrap lines:

seqtk seq -l 0 test_unwrap_in.fa > test_unwrap_out.fa

cat test_unwrap_out.fa 
```

输出：

```
>seq1 with blanks
ACGT ACGT ACGT
>seq2 with newlines
ACGTACGTACGT
>seq3 without blanks or newlines
ACGTACGTACGT 
```

要安装`seqtk`，您可以使用例如`conda install seqtk`.

**也可以看看：**

`seqtk`用法：

```
seqtk seq

Usage:   seqtk seq [options] <in.fq>|<in.fa>

Options: ...
         -l INT    number of residues per line; 0 for 2^32-1 [0] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-12-21T12:38:41.217

另一种变化:-)

```
awk '!/>/{printf( "%s", $0);next}
     NR>1{printf( "\n")} 
     END {printf"\n"}
     7' YourFile 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-09-19T19:54:22.557

使用这个 Perl 单行器，它执行在这种情况和类似情况下所需的所有常见重新格式化：删除序列中的换行符和空格（这也解开序列），但不更改序列标题行。请注意，与其他一些答案不同，这可以正确处理文件中的前导和尾随空格/换行符：

```
# Create the input for testing:

cat > test_unwrap_in.fa <<EOF

>seq1 with blanks
ACGT ACGT ACGT
>seq2 with newlines
ACGT

ACGT

ACGT

>seq3 without blanks or newlines
ACGTACGTACGT

EOF

# Reformat with Perl:

perl -ne 'chomp; if ( /^>/ ) { print "\n" if $n; print "$_\n"; $n++; } else { s/\s+//g; print; } END { print "\n"; }' test_unwrap_in.fa > test_unwrap_out.fa 
```

输出：

```
>seq1 with blanks
ACGTACGTACGT
>seq2 with newlines
ACGTACGTACGT
>seq3 without blanks or newlines
ACGTACGTACGT 
```

Perl 单行器使用这些命令行标志：
`-e`：告诉 Perl 查找内联代码，而不是在文件中。
`-n`：一次循环输入一行，`$_`默认情况下将其分配给。

`chomp`：删除输入行分隔符（`\n`在 *NIX 上）。
`if ( /^>/ )`：测试当前行是否为序列标题行。
`$n`：这个变量在开始时是未定义的（假），在看到第一个序列头后为真，在这种情况下我们打印一个额外的换行符。此换行符位于每个序列的末尾，从第一个序列开始。
`END { print "\n"; }`：在最后一个序列之后打印最后一个换行符。
`s/\s+//g; print;`：如果当前行是序列（不是标题），则删除所有空格并在没有终端换行符的情况下打印。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-10-09T23:47:04.190

到目前为止，反响很好。

这是在 Python 中执行此操作的一种有效方法：

```
def read_fasta(fasta):
    with open(fasta, 'r') as fast:
        headers, sequences = [], []
        for line in fast:
            if line.startswith('>'):
                head = line.replace('>','').strip()
                headers.append(head)
                sequences.append('')
            else :
                seq = line.strip()
                if len(seq) > 0:
                    sequences[-1] += seq
    return (headers, sequences)

def write_fasta(headers, sequences, fasta):
    with open(fasta, 'w') as fast:
        for i in range(len(headers)):
            fast.write('>' + headers[i] + '\n' + sequences[i] + '\n') 
```

您可以使用上述函数从 fasta 文件中检索序列/标题而无需换行，操作它们，然后写回 fasta 文件。

```
headers, sequences = read_fasta('input.fasta')
new_headers = do_something(headers)
new_sequences = do_something(sequences)
write_fasta(new_headers, new_sequences, 'input.fasta') 
```

# opengl - OpenGL 光照：一半的三角形没有被点亮

> ID：15857091
> 
> 赞同：1
> 
> 时间：2013-04-06T23:14:37.147
> 
> 标签：opengl, lighting

我正在使用此处描述的行进立方体算法将`http://paulbourke.net/geometry/polygonise/`标量场转换为三角形网格，然后使用 OpenGL 的 GL_TRIANGLES 模式显示网格。但是，我遇到了照明问题。

似乎有一半的三角形根本没有被点亮，而且它以不同的模式发生。

在下面描述的程序中，我将背景设置为红色，正面颜色为绿色，背面颜色为蓝色。有一个位置为 (1.0, 1.0, 1.0, 0.0) 的光源和一个球体以供参考。

[http://i.imgur.com/JutXhbb.png](http://i.imgur.com/JutXhbb.png)

这里是翻转三角形，因为最后两个顶点的绘制顺序被切换：

[http://i.imgur.com/iUgqm3N.png](http://i.imgur.com/iUgqm3N.png) （背面颜色为蓝色）

真正让我困惑的是为什么翻转版本到处都有颜色，而普通版本没有。我想即使我画错了，至少翻转的版本应该反映同样的错误。知道发生了什么吗？

下面是完整的光照初始化代码：

```
glLightModeli(GL_LIGHT_MODEL_TWO_SIDE, GL_TRUE);

GLfloat mat_specular[] = { 1.0, 1.0, 1.0, 1.0 };
GLfloat mat_shininess[] = { 50.0 };
GLfloat light_position[] = { 1.0, 1.0, 1.0, 0.0 };

GLfloat mat_color1[] = { 0.0, 0.0, 1.0, 1.0 };
GLfloat mat_color2[] = { 0.0, 1.0, 0.0, 1.0 };

glMaterialfv(GL_BACK, GL_DIFFUSE, mat_color1);
glMaterialfv(GL_FRONT, GL_DIFFUSE, mat_color2);

glMaterialfv(GL_FRONT, GL_SPECULAR, mat_specular);
glMaterialfv(GL_FRONT, GL_SHININESS, mat_shininess);
glMaterialfv(GL_BACK, GL_SPECULAR, mat_specular);
glMaterialfv(GL_BACK, GL_SHININESS, mat_shininess);

glLightfv(GL_LIGHT0, GL_POSITION, light_position);

glEnable(GL_LIGHTING);
glEnable(GL_LIGHT0);
glEnable(GL_DEPTH_TEST); 
```

# ios - 在 iOS 设备上设置原生 html5 日期和时间选择器的宽度

> ID：15857092
> 
> 赞同：25
> 
> 时间：2013-04-06T23:14:42.080
> 
> 标签：ios, html, css, mobile-safari

我正在使用带有 type=date 和 type=time 的本地日期和时间选择器来处理我正在处理的网站的移动版本。但是，输入字段不尊重我拥有的 css。

桌面：

![桌面](https://i.stack.imgur.com/kyCZm.png)

iOS 设备： ![在此处输入图像描述](https://i.stack.imgur.com/YED8N.png)

本质上，我需要两个日期和时间输入来填充约 50% 的宽度。这是我正在使用的 html 和 css：

```
<div class="arriveWrapper">
            <div class="arriveDateWrapper fieldWrapper">
                <input class="arriveDate" name="arriveDate" type="date" placeholder="What date?" />
            </div>
            <div class="arriveTimeWrapper fieldWrapper">
                <input class="arriveTime" name="arriveTime" type="time" placeholder="What time?" />
            </div>
            <div class="clear"></div>
        </div>

.arriveDateWrapper {
    width: 49%;
    margin-right: 2%;
    float: left;
    position: relative;
}

        .arriveDate {
            width: 100%;
            height: 28px;
            -moz-box-sizing: border-box;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
        }

.arriveTimeWrapper {
    width: 49%;
    float: left;
}

    .arriveTime {
        width: 100%;
        height: 28px;
        -moz-box-sizing: border-box;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
    } 
```

如果有人能告诉我如何在使用本地日期/时间选择器时显示占位符，那也很棒。

谢谢！

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-05-31T08:58:35.400

只需将其添加到您的样式中

```
.arriveDate, .arriveTime  {
  -webkit-appearance: none;
  -moz-appearance: none;
} 
```

这背后的原因是 IOS 设备默认使用 IOS 按钮呈现输入

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-07-20T18:34:54.747

为避免丢失应用于其他输入框的任何样式元素，请使用**textfield**而不是**none**。

```
.arriveDate, .arriveTime  {
  -webkit-appearance: textfield;
  -moz-appearance: textfield;
} 
```

此外，如果您只想让所有日期字段看起来像文本框，但仍然像日期字段一样工作......

```
input[type="date"]
{
    display:block;
    -webkit-appearance: textfield;
    -moz-appearance: textfield;
    min-height: 1.2em;
} 
```

# c++ - C++ 将 HTML 代码显示为网站（CGI 程序）

> ID：15857094
> 
> 赞同：0
> 
> 时间：2013-04-06T23:15:01.967
> 
> 标签：c++, cgi

我希望我能正确解释这一点。但我需要我的 C++ 程序来显示 HTML 网站。我现在拥有的代码只显示文本。我怎样才能使它像网站一样实际显示（使用 HTML 代码）？我将使用上传到服务器的 .exe 文件来显示页面。

```
#include <iostream>
using namespace std;

int main()
{
    cout << "Content-type: text/plain\n\n";
    cout << "<h2>My first CGI program</h2>\n";
    cout << "<h1>This is a test</h1>\n";
    cout << "<h3>Why is this not working</h3>\n";

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T23:44:39.810

您的 HTTP 响应需要状态行，您应该将 mime 类型更改为`text/html`：

```
cout << "HTTP/1.1 200 OK\n";
cout << "Content-Type: text/html\n\n";
cout << "<h2>My first CGI program</h2>\n";
cout << "<h1>This is a test</h1>\n";
cout << "<h3>Why is this not working</h3>\n"; 
```

# jquery - jquery-rails 产生旧的 jquery 版本

> ID：15857095
> 
> 赞同：3
> 
> 时间：2013-04-06T23:15:05.747
> 
> 标签：jquery, ruby-on-rails, gem, asset-pipeline

我正在使用启用了资产管道的 rails 3.2.2、jquery-rails 2.0.3。出于某种原因，需要 jquery 在我的 application.js 文件中生成 jQuery 1.7.2。我想使用最新的 1.9.1。我确保 jquery-rails 是最新的。有很多关于使用旧版本的帖子，但是有人可以解释为什么我不会得到最新版本吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-28T10:25:02.210

你为什么不尝试使用`'jquery-rails-cdn'`宝石呢？它可以解决您的问题，这是一种更好的方法。

[https://github.com/kenn/jquery-rails-cdn](https://github.com/kenn/jquery-rails-cdn)

# c++ - 动态内存使用速度较慢是什么？

> ID：15857099
> 
> 赞同：5
> 
> 时间：2013-04-06T23:15:38.850
> 
> 标签：c++

我知道在堆栈上分配内存比在堆上更快，但为什么堆内存分配更慢？是因为堆栈分配是连续的，因此问题是由于缓存局部性而出现的吗？不是分配后内存的使用情况，是分配的时间比较慢吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T23:32:34.700

撇开缓存问题不谈，CPU 堆栈就是一个堆栈，一个 LIFO 列表/队列。您以与放置它们的顺序完全相反的顺序从中删除东西。您不会通过移除中间的东西来在其中创建孔。这使得它的管理极其简单：

```
memory[--stackpointer] = value; // push
value = memory[stackpointer++]; // pop 
```

或者你可以分配一个大块：

```
stackpointer -= size; // allocate
memset(&memory[stackpointer], 0, size); // use 
```

并同样释放它：

```
stackpointer += size; // free 
```

您的堆 OTOH 没有 LIFO 属性。因此，它必须单独跟踪所有分配的块。这意味着，它必须有某种空闲块列表和已分配块列表，并且它需要在分配时寻找足够大的块，并在释放时寻找指定的块，然后可能会在过程。简单堆栈不需要做任何这些。

仅这一点就是两种分配和解除分配方式之间的显着算法差异。

缓存和将物理内存映射到虚拟地址空间的显式调用也会加起来，但是如果您认为它们在两种情况下是相等的，那么您仍然有一些指令与几十到几百条指令的差异。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-06T23:26:11.230

“更好”可能不是描述它的好方法，但在堆栈上分配内存通常是“更快”，而不是在堆上。您是正确的，是内存分配较慢，而不是之后使用该内存。

堆分配往往较慢的原因是堆管理器需要做额外的工作：他们经常尝试找到一个与您请求的大小非常接近的现有内存块，并且在释放块时，他们通常会检查相邻的内存区域以看看能不能合并。堆栈分配只是将值添加到指针，仅此而已。

# java - 我有 Hibernate 缓存或映射错误吗？

> ID：15857101
> 
> 赞同：1
> 
> 时间：2013-04-06T23:15:52.107
> 
> 标签：java, hibernate, spring-data

我正在使用以下框架：

*   休眠 4.2.0.Final
*   Spring 3.2.2.RELEASE
*   Spring Data Jpa 1.1.0.RELEASE
*   HSQL 2.2.9
*   测试NG 6.1.1

我有 2 个实体：

实体 A：

```
@Entity
@Table( name = "A" )
public class A {

    @Id
    @GeneratedValue( strategy = GenerationType.IDENTITY )
    private Long id;

    @OneToMany( fetch = FetchType.LAZY, cascade = CascadeType.ALL, mappedBy = "a" )
    private Set<B> b = new HashSet<B>();

    //... getter and setter

} 
```

和实体 B：

```
@Entity
@Table( name = "B" )
public class B {

    @Id
    @GeneratedValue( strategy = GenerationType.IDENTITY )
    private Long id;

    @ManyToOne
    @JoinColumn( name = "a_id" )
    private A a;

    //... getter and setter

} 
```

我为他们制作了 Spring Data JPARepositories：

```
@Repository
public interface ARepository
        extends JpaRepository<A, Long> {

}

@Repository
public interface BRepository
        extends JpaRepository<B, Long> {

} 
```

然后我写了一个测试来看看映射是否有效：

```
@TransactionConfiguration( defaultRollback = true )
@ContextConfiguration
public class ARepositoryTest
        extends AbstractTransactionalTestNGSpringContextTests {

    @Inject
    @Setter
    private ARepository aRepository;

    @Inject
    @Setter
    private BRepository bRepository;

    @Test( groups = { "integration" } )
    public void testSaveWithFeed() {

        A a = new A();
        aRepository.saveAndFlush( a );

        B b = new B();
        b.setA( a );
        bRepository.saveAndFlush( b );

        A findOne = aRepository.findOne( a.getId() );
        Assert.assertEquals( 1, findOne.getB().size() );

    }
} 
```

但测试失败：

```
Hibernate: insert into A (id) values (default)
Hibernate: insert into B (id, a_id) values (default, ?)
FAILED: testSaveWithA
java.lang.AssertionError: expected [1] but found [0] 
```

我不明白为什么。映射中是否缺少某些内容，或者我是否必须清除休眠缓存？我看到没有新的选择查询，所以休眠正在缓存 A 对象 - 但它不应该更新从 A 到缓存中 Bs 的引用吗？

作为附加信息，这里是我的 persistence.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence 
        http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
    xmlns="http://java.sun.com/xml/ns/persistence">    
    <persistence-unit name="local" transaction-type="RESOURCE_LOCAL" >
    </persistence-unit>
</persistence> 
```

我的 ARepositoryTest-context.xml

```
<beans xmlns="http://www.springframework.org/schema/beans"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xmlns:jpa="http://www.springframework.org/schema/data/jpa"
 xmlns:context="http://www.springframework.org/schema/context"
 xmlns:jdbc="http://www.springframework.org/schema/jdbc"
 xsi:schemaLocation="http://www.springframework.org/schema/beans
     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
     http://www.springframework.org/schema/context
     http://www.springframework.org/schema/context/spring-context-3.0.xsd
     http://www.springframework.org/schema/data/jpa 
     http://www.springframework.org/schema/data/jpa/spring-jpa.xsd
     http://www.springframework.org/schema/jdbc
 http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd"> 

    <context:annotation-config /> 
    <context:component-scan base-package="my.package"/>

    <import resource="classpath:/SpringBeans.xml"/>

</beans> 
```

和我的 SpringBeans.xml

```
<beans xmlns="http://www.springframework.org/schema/beans"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xmlns:jpa="http://www.springframework.org/schema/data/jpa"
 xmlns:context="http://www.springframework.org/schema/context"
 xmlns:jdbc="http://www.springframework.org/schema/jdbc"
 xsi:schemaLocation="http://www.springframework.org/schema/beans
     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
     http://www.springframework.org/schema/context
     http://www.springframework.org/schema/context/spring-context-3.0.xsd
     http://www.springframework.org/schema/data/jpa 
     http://www.springframework.org/schema/data/jpa/spring-jpa.xsd
     http://www.springframework.org/schema/jdbc
 http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd"> 

    <context:annotation-config /> 

    <jpa:repositories base-package="my.package.dao" />

    <bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
        <property name="entityManagerFactory" ref="entityManagerFactory" />
        <property name="jpaDialect">
            <bean class="org.springframework.orm.jpa.vendor.HibernateJpaDialect" />
        </property>
    </bean>

    <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
      <property name="persistenceUnitName" value="local"/>
      <property name="dataSource" ref="dataSource" />
      <property name="jpaVendorAdapter">
            <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
                <property name="showSql" value="true"/>
                <property name="generateDdl" value="true" />
                <property name="databasePlatform" value="org.hibernate.dialect.HSQLDialect"/>
                <property name="database" value="HSQL" />               
            </bean>
        </property>
        <property name="jpaPropertyMap">
            <map>
                <entry key="hibernate.show_sql" value="true" />
            </map>
        </property>
    </bean>

    <bean class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close" id="dataSource">
        <property name="driverClassName" value="org.hsqldb.jdbcDriver" />
        <property name="url" value="jdbc:hsqldb:file:${user.home}/data;shutdown=true" />
        <property name="username" value="sa" />
        <property name="password" value="" />
    </bean>

    <bean class="org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor"/> 

</beans> 
```

编辑：添加版本号和 xml 文件

* * *

编辑：对于 JB Nizet 回答如果我添加到 A 类

```
public void addB( B b ) {

    this.b.add( b );
} 
```

并调整测试用例

```
@Test( groups = { "integration" } )
public void testSaveWithA() {

    A a = new A();
    aRepository.save( a );

    B b = new B();
    a.addB( b );
    aRepository.saveAndFlush( a );

    A findOne = aRepository.findOne( a.getId() );
    Assert.assertEquals( findOne.getB().size(), 1 );

} 
```

测试通过但在 hsql 文件中，A 和 B 之间没有链接：

```
INSERT INTO A VALUES(1)
INSERT INTO B VALUES(1,NULL) 
```

因此它将无法在其他事务中正确选择它。

如果我在 A 中扩展新的 mMethod

```
public void addB( B b ) {

    this.b.add( b );
    b.setA( this );
} 
```

刷新或提交时发生异常

```
java.lang.StackOverflowError
    at java.util.HashMap$KeyIterator.<init>(HashMap.java:926)
    at java.util.HashMap$KeyIterator.<init>(HashMap.java:926)
    at java.util.HashMap.newKeyIterator(HashMap.java:940)
    at java.util.HashMap$KeySet.iterator(HashMap.java:974)
    at java.util.HashSet.iterator(HashSet.java:170)
    at java.util.AbstractSet.hashCode(AbstractSet.java:122)
    at org.hibernate.collection.internal.PersistentSet.hashCode(PersistentSet.java:429)
    at my.package.A.hashCode(A.java:17)
    at my.package.B.hashCode(B.java:13)
    at java.util.AbstractSet.hashCode(AbstractSet.java:126)
    at org.hibernate.collection.internal.PersistentSet.hashCode(PersistentSet.java:429)
    at my.package.A.hashCode(A.java:17)
    at my.package.B.hashCode(B.java:13)
    ... 
```

Linenumbers A.java:17 和 B.java:13 是放置 Lombok 的 @Data 注释的位置，生成我的 getter 和 setter。

通过使用 Lomboks @EqualsAndHashCode( exclude = { "b" } ) 删除对 lombok 的 hashCode 和 equals / 的依赖关系来解决

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T09:53:37.547

您的测试使用单个会话在单个事务中运行。因此，当您执行 时`aRepository.findOne(a.getId())`，Hibernate 会返回已经在其一级缓存中的 A。而且由于您忘记将 B 添加到 A 中的 B 集合中，因此该集合仍然是空的。

维护对象图的连贯性是您的责任。如果你这样做了`b.setA(a)`，你也应该这样做`a.getBs().add(b)`。最好的办法是把这两个操作封装成`addB(B b)`A中的一个方法，将B加入到集合中并初始化`B.a`。

# c++ - 如何在 C++ 中计算时间？

> ID：15857102
> 
> 赞同：1
> 
> 时间：2013-04-06T23:16:12.730
> 
> 标签：c++, time.h

我试图弄清楚如何在 c++ 中计算时间。我正在制作一个程序，其中每 3 秒发生一次事件，例如打印出“hello”等；

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T23:57:17.843

这是一个使用两个线程的示例，因此您的程序不会`this_thread::sleep_for()`在 C++11 中冻结：

```
#include <iostream>
#include <chrono>
#include <thread>

using namespace std;

void hello()
{
    while(1)
    {
        cout << "Hello" << endl;
        chrono::milliseconds duration( 3000 );
        this_thread::sleep_for( duration );
    }
}

int main()
{
    //start the hello thread
    thread help1(hello);
    //do other stuff in the main thread
    for(int i=0; i <10; i++)
    {
        cout << "Hello2" << endl;
        chrono::milliseconds duration( 3000 );
        this_thread::sleep_for( duration );
    }
    //wait for the other thread to finish in this case wait forever(while(1))
    help1.join();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T23:40:40.627

您可以使用`boost::timer`C++ 计算时间：

```
using boost::timer::cpu_timer;
using boost::timer::cpu_times;
using boost::timer::nanosecond_type;
...
nanosecond_type const three_seconds(3 * 1000000000LL);

cpu_timer timer;

  cpu_times const elapsed_times(timer.elapsed());
  nanosecond_type const elapsed(elapsed_times.system + elapsed_times.user);
  if (elapsed >= three_seconds)
  {
    //more then 3 seconds elapsed
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T23:58:47.773

它取决于您的操作系统/编译器。

案例 1：
如果你有 C++11，那么你可以按照 Chris 的建议使用：
std::this_thread::sleep_for() // 你必须包含头文件线程

案例2：
如果你在windows平台上，那么你也可以使用类似的东西：

```
#include windows.h 
int main () 
{ 
    event 1; 
    Sleep(1000); // number is in milliseconds 1Sec = 1000 MiliSeconds 
    event 2; 
    return 0; 
} 
```

案例3：
在linux平台上你可以简单地使用：
sleep(In seconds);

# c# - LINQ 强制转换 int64 问题

> ID：15857104
> 
> 赞同：3
> 
> 时间：2013-04-06T23:16:34.217
> 
> 标签：c#, linq, linq-to-entities

我需要这个 linq 查询才能工作，但 linq 抱怨 customercontact 和 phone 是 int64s，我还需要连接第二列，但恐怕出于同样的原因这不起作用。如果我添加一个 tostring() 它只是说 linq 无法识别它。

> base {System.SystemException} = {“无法将类型 'System.Int64' 转换为类型 'System.Object'。LINQ to Entities 仅支持转换 EDM 基元或枚举类型。”}

```
var tempCustomers =
                    from c in db.Customers
                    let cc = db.CustomerContacts.FirstOrDefault(x => x.CustomerID == c.CustomerID)
                    select new{cc.CustomerContactID, CustomerValue = c.CustomerName + " &#09;&emsp;&#09; " + cc.Phone}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:16:18.647

此错误来自 LINQ 到实体。这是一种解决方案：

```
var tempCustomers =
    from c in db.Customers.ToArray()
    let cc = db.CustomerContacts
       .FirstOrDefault(x => x.CustomerID == c.CustomerID)
    select new
    {
        cc.CustomerContactID,
        CustomerValue = string.Format("{0} &#09;&emsp;&#09; {0}",
            c.CustomerName, cc.Phone)
    }; 
```

以上将在尝试进行字符串连接之前访问数据库。如果这是不可接受的，请在您的问题中注明。

**为什么它不起作用**

LINQ to Entities 使用延迟 SQL 执行，这意味着您的 LINQ 查询将不会访问数据库，直到您使用 foreach 迭代或`IQueryable`调用类似. 您可以在 LINQ 谓词表达式中使用您想要的任何代码，但如果 LINQ to Entities 无法弄清楚如何将其转换为 SQL，它将在运行时失败。您的代码失败，因为 LINQ to Entities 在运行 SQL 查询时无法弄清楚如何连接 CustomerName、您的自定义字符串和 PhoneNumber。上面的工作是因为它首先从数据库中获取数据，然后在内存中进行字符串连接。`ToList``ToArray``IQueryable`

**更新**

要扩展 @JeffMercado 击败我的更好的解决方案，您真的应该使用导航属性来加入`Customer`和`CustomerContacts`. 这将消除对`let`子句和`First`or`FirstOrDefault`调用的需要：

```
public class Customer
{
    public long CustomerID { get; set; }
    public string CustomerName { get; set; }
    public virtual ICollection<CustomerContact> Contacts { get; set; }
}

public class CustomerContact
{
    public long CustomerContactID { get; set; }
    public long CustomerID { get; set; }
    public virtual Customer Owner { get; set; }
    public long Phone { get; set; } // I agree this should be a string
} 
```

然后，您应该能够像这样查询数据：

```
var query = db.CustomerContacts
    .Include(x => x.Owner) // eager load to avoid multiple separate SQL queries
    .Select(x => new {
        CustomerContactID = x.CustomerContactID,
        CustomerName = x.Owner.CustomerName,
        Phone = x.Phone,
}); 
```

从这里，您可以使用`AsEnumerable`、`ToArray`或`ToList`来执行查询并格式化您的特殊`CustomerValue`属性。

```
var results = query
    .ToArray() // or .AsEnumerable(), or .ToList(), all will execute the SQL query
    .Select(x => new {
        CustomerContactId = x.CustomerContactID,
        CustomerValue = string.Format("{0} &#09;&emsp;&#09; {1}",
            x.CustomerName, x.Phone)
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T00:27:11.937

您可以在查询中执行的操作类型在 EF 中是有限的，转换就是其中之一。您需要将该部分移出查询，然后获取数据然后使用`AsEnumerable()`，以便使用 LINQ to Objects。然后你可以对数据做任何你想做的事情。

```
var query=
    from c in db.Customers
    let cc = c.CustomerContacts.FirstOrDefault() // better to use the navigation properties instead
    select new // select the fields you need
    {
        cc.CustomerContactId,
        c.CustomerName,
        Phone = (long?)cc.Phone, // cc could potentially be null this long must also be nullable
    };
var tempCustomers =
    from x in query.AsEnumerable() // LINQ to Objects
    select new // now you can do what you want to the data
    {
        x.CustomerContactId,
        CustomerValue = x.CustomerName + " &#09;&emsp;&#09; " + x.Phone,
    }; 
```

为了便于阅读，我将它们分成单独的语句，但如果你愿意，你可以将它们组合起来。

# c++ - C++ 对象切片智能指针

> ID：15857109
> 
> 赞同：2
> 
> 时间：2013-04-06T23:18:16.717
> 
> 标签：c++, smart-pointers, derived-class

您好我正在使用以下代码读取从 cv::Mat 派生的 Image 类。然后我想将对象传递给一个函数，在该函数中我将它直接传递给一个指向 cv::Mat 的智能指针向量。这样，我应该避免对象切片。然而事实并非如此。这个例子相对于真实版本有点简化。

```
class Image : public cv::Mat {

public:
    Image(cv::Mat m) : cv::Mat(m)  {}
    Image() : cv::Mat() {}

    std::string labelGen;
    int labelNum;
};

std::shared_ptr<cv::Mat> getImage(char *readPath) {

    std::shared_ptr<Image> i(new Image(cv::imread(readPath, 0)));
    i->labelGen = "String";
    i->labelNum = 5;

    return i;
}

std::vector<std::shared_ptr<cv::Mat>> getVectors() { 

    std::vector<std::shared_ptr<cv::Mat>> v;
    v.push_back(getImage("path/path.jpg"));

    return v;
} 
```

我到底做错了什么；

# javascript - 如何将 Ajax 响应作为可下载文件发送到 Web 浏览器客户端？

> ID：15857110
> 
> 赞同：2
> 
> 时间：2013-04-06T23:18:16.790
> 
> 标签：javascript, jquery, asp.net, ajax, asp.net-mvc-3

我正在使用 MVC 3。我在服务器上的操作方法中创建了一个 csv 文件（称为 GetCSV()）。这是一个 [HttpPost] 操作方法。我想做的是将该 csv 文件作为可下载文件直接发送到网络浏览器。我使用 window.open() 让它工作，但是，这本质上是一个 GET 方法，我需要一些使用 POST 的东西，因为我需要将很多参数传递给它。理想情况下，我想使用 Ajax，因为我可以使用这种方法轻松地将大量参数传回服务器。关于如何使用 Ajax 调用将参数传递给服务器然后以某种方式将响应作为可下载文件打开的任何想法？我会很感激任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T03:23:29.553

我的解决方案是使用 Microsoft 的 MVC 3 Ajax Form 而不是 JQuery 的 Ajax。几个月前，我纯属偶然发现，如果您没有为 MVC Ajax 表单指定“成功”函数，它只会将文件发送到 Web 客户端进行下载。这就是我需要发生的事情。我试过这个，它确实按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T23:42:26.623

您不能使用 javascript（至少以所有浏览器支持的标准方式）或 ajax 将文件保存到本地文件系统。这就是为什么推荐的方法是不使用ajax，通常通过GET。

[但是，您可以通过 jquery 的.param()](http://api.jquery.com/jQuery.param/)将带有参数的 json 对象转换为 URL，如[本答案](https://stackoverflow.com/a/3308876/1373170)所示。

如果您确实想探索 javascript 替代方案，也许您可​​以查看仅由 chrome AFAIK 支持的[FileSystem API 。](http://www.html5rocks.com/en/tutorials/file/filesystem/)

# java - Java Web 服务返回soap 或json

> ID：15857111
> 
> 赞同：0
> 
> 时间：2013-04-06T23:18:19.400
> 
> 标签：java, json, web-services, soap, jax-rs

我需要在 Java 中创建 Web 服务，该方法将返回一些 SOAP 或 JSON 格式的对象。格式取决于调用方法的方式。

例如：

```
http://localhost:8080/webservice/soap
http://localhost:8080/webservice/json 
```

它必须是相同的方法，但返回对象的格式不同。

我知道，这种效果在.NET 中使用 WCF 是可能的，但是在 Java 中可以做到吗？如果是，该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T23:44:46.493

根据我找到/链接的上一个问题的答案，我想说你最好的选择是创建一组包含服务代码“肉”的 MyService 类，并将 SOAP/XML 和 REST/JSON调用您的 MyService API 的胶水。

# mysql - RDBMS 规范化与性能

> ID：15857113
> 
> 赞同：0
> 
> 时间：2013-04-06T23:18:22.993
> 
> 标签：mysql, sql, performance, normalization, acid

我们正在编写一个[MMORPG](http://en.wikipedia.org/wiki/MMORPG)并假设我们有以下表格。这`location_dynamic_objects`是要大量查询和更新的表。如您所见`position_x`，`position_y`列`location_id`和对象类型都是重复的。但是，如果我们规范化并使用连接，我们将为选定的数据应用额外的过滤器。我们计划将所有`location_static_objects`ONCE 发送给客户，因此将它们与`location_dynamic_objects`. 静态对象表示要渲染的不可移动数据，并在位置加载时向客户端发送一次。动态对象代表经常更新的数据，如玩家、火箭、小行星等，并不断发送给客户端，选择取决于客户端的位置和位置。我们的问题是我们应该放弃规范化来实现性能吗？

```
create table location_static_object_types (
  location_static_object_type_id integer auto_increment primary key,
  object_type_name                varchar(16) not null
);
create table location_static_objects (
  location_static_object_id      integer auto_increment primary key,
  location_static_object_type_id integer not null,
  location_id                    integer not null,
  position_x                     integer not null,
  position_y                     integer not null
);
create table location_dynamic_object_types (
  location_dynamic_object_type_id integer auto_increment primary key,
  object_type_name                varchar(16) not null 
);
create table location_dynamic_objects (
  location_dynamic_object_id      integer auto_increment primary key,
  location_dynamic_object_type_id integer not null,
  object_native_id                integer not null,
  location_id                     integer not null,
  position_x                      integer not null,
  position_y                      integer not null
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T05:05:38.487

因为非规范化增加了数据的冗余，所以它增加了总数据量。因此，非规范化很少能提高对数据的写访问（创建和更新）的性能；反之亦然。此外，即使对于读取查询，非规范化也会牺牲一小组查询（通常只有一个）的性能提高，以降低访问非规范化数据的所有其他查询的性能。如果您为外键约束适当地使用了人工主键，并辅以对自然（主）键的相应唯一性约束，如果您看到通过非规范化获得的性能提升，我会感到惊讶。

# python - 蟒蛇，PIL；文本到图像和字体

> ID：15857117
> 
> 赞同：22
> 
> 时间：2013-04-06T23:19:04.220
> 
> 标签：python, image, text, python-imaging-library, bold

我在 Python 和 PIL 下将文本写入图像时遇到问题 - 我可以将文本写入 png 文件，但不是粗体文本。谁能提供一个如何实现这一目标的例子？

我认为最简单的解决方案*可能*是使用文本的粗体变体，但我无法在 Windows/font 文件夹中看到任何提供此内容的内容 - 这是否意味着字体类型具有“粗体属性”，即 T/ F？：
![在 windows 下快速查找粗体字体](https://i.stack.imgur.com/aWtuU.png)

我正在使用的代码：

```
import PIL
from PIL import ImageFont
from PIL import Image
from PIL import ImageDraw

# font = ImageFont.truetype("Arial-Bold.ttf",14)
font = ImageFont.truetype("Arial.ttf",14)
img=Image.new("RGBA", (500,250),(255,255,255))
draw = ImageDraw.Draw(img)
draw.text((0, 0),"This is a test",(0,0,0),font=font)
draw = ImageDraw.Draw(img)
img.save("a_test.png") 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2015-11-15T09:24:08.893

一个简单的方法：

```
font = ImageFont.load_default().font 
```

你也可以在[谷歌上搜索“verdana.ttf”](http://www.fontpalace.com/font-download/Verdana/)并将其下载到与 python 文件相同的目录中：

然后像这样添加它：

```
font = ImageFont.truetype("Verdana.ttf",14) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-06T23:39:09.157

您没有在控制面板中查看实际的字体文件（资源管理器在 Windows/fonts 文件夹中也神奇地变成了字体查看器控制面板），为了您的方便，它们按系列分组。双击系列以查看系列中的字体：

![在此处输入图像描述](https://i.stack.imgur.com/GL4WX.png)

然后右键单击并选择属性以找到文件名：

![在此处输入图像描述](https://i.stack.imgur.com/W5TZV.png)

# c - 为什么我无法创建此文件？

> ID：15857124
> 
> 赞同：0
> 
> 时间：2013-04-06T23:19:40.153
> 
> 标签：c, windows, file-io

这是我的代码示例：

```
int main(int argc, char* argv[])
{
    char* fileName = "%appdata%\\log.log";
    FILE *file;
    file = fopen(fileName, "a+");
    time_t startTime = time(0);
    fputs("Started logging at: ", file);
    fputs(ctime(&startTime), file);
    fclose(file);
    printf("%s", fileName);
    return 0;
} 
```

我的程序开始执行`printf()`语句，并打印：

> %appdata%\log.log

我知道这是 Windows 计算机的可行位置，那么为什么程序无法制作`.log`文件？我应该使用什么解决方法来使其工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T23:24:45.497

```
%appdata% 
```

是一个环境变量，它们不会自动解析，需要使用[getenv](http://linux.die.net/man/3/getenv)函数调用显式检索它们的值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-06T23:30:12.170

该`fopen`调用不知道是什么`%appdata%`，因为它不能神奇地将其转换为路径。[`ExpandEnvironmentStrings`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724265%28v=vs.85%29.aspx)您必须使用该功能自己扩展路径。例如（未经测试）：

```
char dest[MAX_PATH];
ExpandEnvironmentStrings(fileName, dest, MAX_PATH);
file = fopen(dest, "a+"); 
```

# c# - “潜在危险的 request.path”错误随机出现在我的错误日志中，为什么？

> ID：15857126
> 
> 赞同：1
> 
> 时间：2013-04-06T23:19:47.230
> 
> 标签：c#, asp.net-4.5

当我的生产站点出现错误并且每隔几天我收到“System.Web.HttpException：从客户端检测到潜在危险的 Request.Path 值 (:)”时，我正在使用 ELMAH 接收电子邮件。在我的索引页面上。我不确定是什么原因造成的以及如何阻止它。有人对我能做什么有任何建议吗？如果有帮助，我将发布页面的 ASPX 和/或 C# 代码，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-18T22:20:15.977

显然，除了忽略它之外，这个问题没有解决方案。

# wordpress - Wordpress 简码和插入标签 p 和 br

> ID：15857128
> 
> 赞同：0
> 
> 时间：2013-04-06T23:19:55.153
> 
> 标签：wordpress, wordpress-theming, shortcode

我在简码中使用 wordpress 时遇到问题，我使用 return 来显示值，但问题仍然存在，简码显示正常，但其中的 are`<p>`和`<br`> 标签。

**将 xt 的内容放入我的模板中：**

```
<div class="content">

[shortcode_poll="1"]

</div> 
```

我都试过了，问题依旧。我使用了一个插件来删除这些行，但它不起作用。

我也试过

```
 remove_filter( 'the_content', 'wpautop' ); remove_filter( 'the_excerpt', 'wpautop' ); 
```

如果您知道如何解决此问题，请告诉我如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-09T13:04:46.243

降低 wpautop 的优先级可以解决这个问题（或者至少对我有用）。将此添加到主题中的 functions.php 中。

```
remove_filter( 'the_content', 'wpautop' );
add_filter( 'the_content', 'wpautop', 12 ); 
```

# ios - 在 iOS 上测试不同的日历

> ID：15857134
> 
> 赞同：0
> 
> 时间：2013-04-06T23:21:16.033
> 
> 标签：ios, testing, calendar, nscalendar

我有一个严重依赖日期计算的应用程序。我正在使用 NSCalendar 并“以正确的方式”进行所有计算，但除了默认的美国日历之外，我真的没有任何方法可以测试任何其他日历。

如何更改 iOS 上使用的日历？我在哪里可以找到有关日历替代方案的更多信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T23:31:41.670

您可以简单地在您的设备/模拟器上更改它。打开设置 -> 常规 -> 国际。您可以在此处更改日历日期或日历本身的格式。

# php - PHP 正则表达式示例

> ID：15857136
> 
> 赞同：1
> 
> 时间：2013-04-06T23:21:38.223
> 
> 标签：php, regex, preg-match-all, capture-group

我是一个学习PHP的初学者。我正在尝试使用正则表达式的各种组合。我指的是[this](http://weblogtoolscollection.com/regex/regex.php)和[this](http://php.net/manual/en/reference.pcre.pattern.syntax.php)并尝试有关[this](http://www.solmetra.com/scripts/regex/index.php)的示例。

我的疑惑：

1.  为什么`preg_match_all('((a|b)*c)', 'ababc', $arr, PREG_PATTERN_ORDER);`同时给出`ababac`和`a`作为输出。不应该只是`ababac`吗？

2.  假设我正在尝试读取所有可能的输出`$arr`，我该如何做到这一点而不必回显数组的每个元素？目前，我正在使用`foreach`迭代`$arr`. 这是正确的/有更好的方法吗？

3.  为什么要`preg_match_all()`给出一个带有元素的二维数组，`$arr[$i][0]`并且在某些情况`$arr[0][$i]` 下`$i`没有可能的匹配项。有没有办法知道输出将如何存储？

很抱歉在一篇文章中发布了太多问题。请告诉我是否需要更改它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T23:29:21.010

1.  这`(a|b)`是一个捕获的子模式，因此它作为结果数组的一部分返回。您可以使用 使其不捕获`(?:a|b)`，但作为字符类会好得多，`[ab]`.

2.  `foreach`可能是最好的方法。

3.  如 1 中所述，您将在数组中捕获并返回您的子模式。

您可能需要查看[`preg_replace_callback()`](http://php.net/preg-replace-callback)，因为这会将给定的回调（通常是匿名函数）应用于每个匹配项。

# javascript - 在节点 x 处追加子节点？

> ID：15857137
> 
> 赞同：1
> 
> 时间：2013-04-06T23:22:09.077
> 
> 标签：javascript, appendchild

我知道要删除 DOM 树中某个位置的子节点，我可以这样做；

```
this.element.removeChild(this.element.childNodes[index]); 
```

我试图弄清楚是否有一种方法可以像上面那样在节点 x 处附加子节点，但反过来。在伪代码中，它类似于（我认为）；

```
this.element.appendChild(child at node[index])); 
```

谢谢你帮我解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T23:26:42.100

也许您正在寻找[`insertBefore`](https://developer.mozilla.org/en-US/docs/DOM/Node.insertBefore)：

```
this.element.insertBefore(element, this.element.childNodes[index]); 
```

# jquery - 幻灯片放映中显示的图像的透明背景？

> ID：15857140
> 
> 赞同：0
> 
> 时间：2013-04-06T23:22:31.693
> 
> 标签：jquery

因为所有图像都有不同的角度并且都是透明的，所以你可以看到它们都在彼此后面。有没有办法只让顶部图像可见而其余图像被隐藏？我可以隐藏 .js 文件或 .css 中的图像吗？

我仍然希望图像是透明的，现在我刚刚添加了一个背景来隐藏所有图像。

所以我想我怎样才能让幻灯片中的图像保持透明，但不显示它背后的图像。

[http://kennenmen.netai.net/test.php](http://kennenmen.netai.net/test.php)

```
function slideSwitch() {
var $active = $('#slideshow IMG.active');

if ( $active.length == 0 ) $active = $('#slideshow IMG:last');

var $next =  $active.next().length ? $active.next()
    : $('#slideshow IMG:first');

$active.addClass('last-active');

$next.css({opacity: 1.0})
    .addClass('active')
    .animate({opacity: 1.0}, 1000, function() {
        $active.removeClass('active last-active');
    });
}

$(function() {
setInterval( "slideSwitch()", 400 );
});

    <div id="slideshow">
<img src="http://images.lasuni.com/users/5/0/kennen.png" alt="" class="active" />
<img src="http://images.lasuni.com/users/2/0/kennen.png" alt="" />
<img src="http://images.lasuni.com/users/8/0/kennen.png" alt="" />
<img src="http://images.lasuni.com/users/4/0/kennen.png" alt="" />
<img src="http://images.lasuni.com/users/6/0/kennen.png" alt="" />
<img src="http://images.lasuni.com/users/3/0/kennen.png" alt="" />
<img src="http://images.lasuni.com/users/7/0/kennen.png" alt="" />
<img src="http://images.lasuni.com/users/1/0/kennen.png" alt="" />
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T23:43:27.487

```
function slideSwitch() {
    var $active = $('#slideshow img.active');
    if ($active.is(':last')) {
        $active.hide().removeClass('active');
        $('#slideshow img:first').show().addClass('active');
    }else{
        $active.hide().removeClass('active').next().show().addClass('active');
    }
}

$(function () {
    $('#slideshow img').not('.active').hide()
    setInterval(slideSwitch, 400);
}); 
```

[**小提琴**](http://jsfiddle.net/hLvQV/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-19T18:45:58.727

为了避免丢失一张图片，我不得不将最后一个答案的第三行更改为

```
if ($active.is(':nth-last-child(1)')) { 
```

# dart - Dart Web 组件如何获得对其子组件的引用？

> ID：15857141
> 
> 赞同：4
> 
> 时间：2013-04-06T23:22:33.120
> 
> 标签：dart, dart-webui

出于说明的原因，我创建了一个继承自 WebComponent 的名为 FancyOption 的类，该类在单击另一个子元素时更改为由一个子元素中的文本指定的背景颜色。

```
import 'package:web_ui/web_ui.dart';
import 'dart:html';

class FancyOptionComponent extends WebComponent {
  ButtonElement _button;
  TextInputElement _textInput;

  FancyOptionComponent() {
    // obtain reference to button element
    // obtain reference to text element

    // failed attempt
    //_button = this.query('.fancy-option-button');
    // error: Bad state: host element has not been set. (no idea)

    // make the background color of this web component the specified color
    final changeColorFunc = (e) => this.style.backgroundColor = _textInput.value;
    _button.onClick.listen(changeColorFunc);
  }
} 
```

FancyOption HTML：

```
<!DOCTYPE html>

<html>
  <body>
    <element name="x-fancy-option" constructor="FancyOptionComponent" extends="div">
      <template>
        <div>
          <button class='fancy-option-button'>Click me!</button>
          <input class='fancy-option-text' type='text'>
        </div>
      </template>
      <script type="application/dart" src="fancyoption.dart"></script>
    </element>
  </body>
</html> 
```

我在这样的页面上有三个。

```
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    <title>Sample app</title>
    <link rel="stylesheet" href="myapp.css">
    <link rel="components" href="fancyoption.html">
  </head>
  <body>
    <h3>Type a color name into a fancy option textbox, push the button and 
    see what happens!</h3>

    <div is="x-fancy-option" id="fancy-option1"></div>
    <div is="x-fancy-option" id="fancy-option2"></div>
    <div is="x-fancy-option" id="fancy-option3"></div>

    <script type="application/dart" src="myapp.dart"></script>
    <script src="packages/browser/dart.js"></script>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-07T10:38:51.787

只需使用`getShadowRoot()`并查询它：

```
import 'package:web_ui/web_ui.dart';
import 'dart:html';

class FancyOptionComponent extends WebComponent {
  ButtonElement _button;
  TextInputElement _textInput;

  inserted() {
    // obtain references
    _button = getShadowRoot('x-fancy-option').query('.fancy-option-button');
    _textInput = getShadowRoot('x-fancy-option').query('.fancy-option-text');

    // make the background color of this web component the specified color
    final changeColorFunc = (e) => this.style.backgroundColor = _textInput.value;
    _button.onClick.listen(changeColorFunc);
  }
} 
```

其中`x-fancy-option`string 是元素的名称。

注意：我将您的构造函数更改为`inserted()`方法，[这是一个生命周期方法](https://stackoverflow.com/a/13956299/1364206)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-13T17:24:12.800

我知道 _root 已被弃用。推荐 _root 的答案应使用 getShadowRoot() 代替 _root。

# php - 警告：mysqli_stmt::bind_param() 变量数与准备语句中的参数数不匹配

> ID：15857146
> 
> 赞同：1
> 
> 时间：2013-04-06T23:23:00.183
> 
> 标签：php, phpmyadmin

忍受我，我意识到有很多关于这个错误的帖子。但是我浏览了它们，似乎无法找到解决我特定问题的方法。

我试过“isi”、“sss”和“sii”不起作用。不知道该怎么做任何帮助都会很棒。

不太确定在哪里使用 var_dump(); 了解有关我的问题的更多信息。我对 PHP 很陌生，知道这也会有很大帮助。

谢谢你陪我！抱歉有重复的话题。

代码：

```
<tr>
             <form action="Voting_action.php" method="post">
            <td><br />
                <input type="submit" class="buttontable1" value="<?php echo $random; ?>" name="name"/>
            </td>
                </form>
                <form action="Voting_action.php" method="post">
            <td><br />
                <input type="submit" class="buttontable1" value="<?php echo $random3; ?>" name="name"/>
            </td>
                </form>
         </tr>
         <tr>
             <form action="Voting_action.php" method="post">
            <td><br />
                <input type="submit" class="buttontable1" value="<?php echo $random6; ?>" name="name"/>
            </td>
                </form>
                <form action="Voting_action.php" method="post">
            <td><br />
                <input type="submit" class="buttontable1" value="<?php echo $random4; ?>" name="name"/>
            </td>
                </form>
         </tr>
         <tr>
             <form action="Voting_action.php" method="post">
            <td><br />
                <input type="submit" class="buttontable1" value="<?php echo $random5; ?>" name="name"/>
            </td>
                </form>
                <form action="Voting_action.php" method="post">
            <td><br />
                <input type="submit" class="buttontable1" value="<?php echo $random2; ?>" name="name"/>
            </td>
</tr>

<?php
include ('login-home.php');
$mysqli = new mysqli("", "", "", "");
if ($mysqli->connect_error) {
    echo "Failed to connect to MySQL: (" . $mysqli->connect_error . ") " . $mysqli->connect_error;
}

if (!($stmt = $mysqli->prepare("INSERT INTO table(id, name, votes) VALUES (id, '".$_POST['name']."', '".$votes."')"))) {
    echo "Prepare failed: (" . $mysqli->error . ") " . $mysqli->error;
}
$id = 1; 
```

这一行：

```
if (!$stmt->bind_param("isi",$id, $_POST['name'], $votes)) {
    echo "Binding parameters failed: (" . $stmt->error . ") " . $stmt->error;
}

if (!$stmt->execute()) {
    echo "Execute failed: (" . $stmt->error . ") " . $stmt->error;
}
$stmt->close();
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T23:25:35.840

您的查询准备包含零个参数，因为您只是将值转储在那里，完全违背了准备语句的目的。相反，试试这个：

```
 if (!($stmt = $mysqli->prepare("INSERT INTO table(id, name, votes) VALUES (?,?,?)"))) { 
```

然后照常继续。

# r - 如何在 R 中启动默认编辑器？

> ID：15857149
> 
> 赞同：4
> 
> 时间：2013-04-06T23:23:28.960
> 
> 标签：r

就像您可以使用 启动默认浏览器一样`browseURL`，有没有办法启动默认文本编辑器以打开给定文件？就像是

```
editFile("path/to/file.txt") 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-06T23:25:26.490

您正在寻找`file.edit`：

```
file.edit("path/to/file.txt") 
```

# ios - Apple 是否修复了 CoreData + iCloud 同步问题？

> ID：15857154
> 
> 赞同：1
> 
> 时间：2013-04-06T23:24:23.827
> 
> 标签：ios, core-data, sync, icloud

我正在考虑通过跨设备的 iCloud 同步升级我的应用程序。

我目前正在使用 CoreData 来保存数据，这对我来说是最好的方式。我最近读到了许多开发人员在有关 CoreData 的 iCloud 同步方面存在问题。

所以我的问题是：Apple 是否已经解决了跨多个设备的 Core Data 的 iCloud 同步当前问题，还是我应该避免在未来的 iOS 更新之前使用它？

# ios - 在 iOS 中将纯文本文档读入 NSArray？

> ID：15857159
> 
> 赞同：0
> 
> 时间：2013-04-06T23:25:32.320
> 
> 标签：ios, objective-c

我是 iOS 新手，但对 c++ 和 Python 有丰富的经验。我试图弄清楚如何将我计算机上的纯文本文件读入 xcode 中的 NSArray。在 C++ 中，我会这样做：

```
while(istr>>string) myArray.push_back(string); 
```

但是，我需要创建一个本地副本以存储在 iOS 设备上。有没有办法可以打包这些数据，以便将 JUST THE ARRAY 的本地副本存储在设备上？我在想也许用 JSON 序列化或其他东西做点什么。我真的应该把它吸起来并这样做：

```
NSArray myArray = [[NSArray alloc] initWithObjects: @"myInfo", nil]; 
```

我想我只是想要一种更优雅的方式来处理这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T23:37:04.720

我想也许你对这个有点太 C 了。在 C 和 C++ 中，字符串是字节数组。在 ObjC 中，有一个对象。它被称为 NSString，它可能是您应该存储明文的内容。

如果您已经有一个字节数组，它甚至还有一个简单的类方法可以帮助您解决这个问题：

`+(id)stringWithCString:(const char *)cString encoding:(NSStringEncoding)enc`

有关详细信息，请参阅[NSString 文档。](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)

至于将其存储在设备上，有从简单的 ( [`NSUserDefaults`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html)) 到复杂的 ( [Core Data](https://developer.apple.com/technologies/ios/data-management.html) ) 的解决方案，但几乎任何东西都希望纯文本保存在`NSString`.

**编辑：** 这个问题的标题谈到从文件系统中读取字符串。第一步是将文件的字节放入[`NSData`](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSData_Class/Reference/Reference.html)对象中。简单的方法：

`+(id)dataWithContentsOfFile:(NSString *)path`

然后使用以下初始化器从数据中创建一个字符串`NSString`：

`-(id)initWithData:(NSData *)data encoding:(NSStringEncoding)encoding`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T00:23:54.687

我不知道这是否可以帮助您，无论如何，如果您只需要将一组数据存储到文件系统并将其反序列化回 NSArray，那么一种简单的方法是使用 plist。这是一种存储少量数据的便捷方式，没有任何关系（有 Core Data）。主要优点是您可以在其中存储 NSArray、NSDictionary、NSNumber、NSString、NSDate 和 NSData（任何类型的二进制信息），并且它们可以通过一些简单的方法自动序列化和反序列化。

您可以通过这种方式将 NSArray 写入文件：

```
- (BOOL)writeToFile:(NSString *)path atomically:(BOOL)flag 
```

并用这个反序列化它：

```
+ (id)arrayWithContentsOfFile:(NSString *)aPath 
```

如果您只想为您的应用程序提供一些初始数据，例如字符串数组或类似的东西，您可以通过转到 File->New->File 并选择 Resources-> 手动将 plist 添加到您的项目中财产清单，并手工填写。

您可以在[https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/PropertyLists/Introduction/Introduction.html阅读更多内容](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/PropertyLists/Introduction/Introduction.html)

# c# - 由于设置图像错误，Live Tile 无法正常工作？

> ID：15857164
> 
> 赞同：1
> 
> 时间：2013-04-06T23:26:17.253
> 
> 标签：c#, windows-8, notifications, windows-store-apps, live-tile

我的应用程序的 App.xaml.cs 页面包含以下方法。

```
public static void SendLiveTileUpdate(Record rr)
{
    string imageUristring = "ms-appdata:///local/" + rr.Id.ToString() + ".jpg";

    XmlDocument wideTileXml = TileUpdateManager.GetTemplateContent(TileTemplateType.TileWideImageAndText01);

    XmlNodeList wideTileTextAttrib = wideTileXml.GetElementsByTagName("text");
    wideTileTextAttrib[0].InnerText = rr.Name;

    XmlNodeList wideTileImageAttrib = wideTileXml.GetElementsByTagName("image");

    //((XmlElement)wideTileImageAttrib[0]).SetAttribute("src", "ms-appdata:///local/" + rr.Id.ToString() + ".jpg");
    ((XmlElement)wideTileImageAttrib[0]).SetAttribute("src", imageUristring);
    ((XmlElement)wideTileImageAttrib[0]).SetAttribute("alt", "Image");

    //Wide tile Layout done

    XmlDocument sqTileXml = TileUpdateManager.GetTemplateContent(TileTemplateType.TileSquareImage);

    XmlNodeList sqTileImageAttrib = sqTileXml.GetElementsByTagName("image");
    ((XmlElement)sqTileImageAttrib[0]).SetAttribute("src", imageUristring);
    ((XmlElement)sqTileImageAttrib[0]).SetAttribute("alt", "Image");

    IXmlNode node = wideTileXml.ImportNode(sqTileXml.GetElementsByTagName("binding").Item(0), true);
    wideTileXml.GetElementsByTagName("visual").Item(0).AppendChild(node);

    //Square tile set and added to wide tile xml

    TileNotification tileNot = new TileNotification(wideTileXml);

    tileNot.ExpirationTime = DateTime.Now.AddDays(5);

    updater.Update(tileNot);
} 
```

在页面上还有全局变量 updater，它用于在页面初始化时调用`EnableNotificationQueue(true)`（然后稍后更新队列，如图所示）。

问题是当这段代码运行时它不起作用。我推断这与图像有关，因为当图像分配被排除时，实时磁贴更新值为`rr.Id.ToString()`，但包含磁贴永远不会更新。引用的此图像`imageUristring`存在于应用程序本地存储中（并且名称与方法参数的 Id 对应），但它仍然不起作用。有问题的图像小于 200KB，尺寸为 1920x1080。（我认为它们会被缩放以适应瓷砖？）

我究竟做错了什么？如何使用存储在本地存储中的图像更新磁贴？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T02:59:10.687

您的图像必须 <= 1024x1024。来自[http://msdn.microsoft.com/en-us/library/windows/apps/Hh781198.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/Hh781198.aspx)：

> 平铺图像的尺寸必须小于或等于 1024x1024 像素，文件大小必须小于或等于 200 KB，并且类型必须为 .png、.jpg、.jpeg 或 .gif。

# iphone - 无法加载tileset cocos2d

> ID：15857166
> 
> 赞同：0
> 
> 时间：2013-04-06T23:26:36.697
> 
> 标签：iphone, objective-c, cocos2d-iphone

我正在尝试使用 Ray Wenderlich 的教程制作基于图块的 [游戏] ( [http://www.raywenderlich.com/29458/how-to-make-a-tile-based-game-with-cocos2d-2-x](http://www.raywenderlich.com/29458/how-to-make-a-tile-based-game-with-cocos2d-2-x) )

当我尝试加载我的 .tmx 文件时，它告诉我找不到tileset 文件。我调查了这个问题并找到了这个[解决方案]（[https://iphonedevsdk.vanillaforums.com/forum/iphone-sdk-game-development/81383-cocos2d-and-tiled.html](https://iphonedevsdk.vanillaforums.com/forum/iphone-sdk-game-development/81383-cocos2d-and-tiled.html)）

然而，当我查看我的 .tmx 文件时，文件引用只是文件名。瓦片集文件与 .tmx 文件位于同一文件夹中。

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE map SYSTEM "http://mapeditor.org/dtd/1.0/map.dtd">
<map version="1.0" orientation="orthogonal" width="50" height="50" tilewidth="32"   tileheight="32">
 <tileset firstgid="1" name="tmw_desert_spacing" tilewidth="32" tileheight="32" spacing="1" margin="1">
  <image source="tmw_desert_spacing.png" width="265" height="199"/>
 </tileset>
  <layer name="Tile Layer 1" width="50" height="50">
   <data encoding="base64" compression="gzip">
    H4sIAAAAAAAAA+3DAQkAAAwEoUvy/WMux0DBVVNVVVVVVVVVVdXnD6vDAUcQJwAA
   </data>
  </layer>
 </map> 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T01:58:39.620

问题是几件事的结合。尽管我在路径中包含了该文件，但我仍然必须将 .png 添加到项目资源下的构建阶段中的复制包资源中。之后，我不得不更改文件路径以删除路径。之后它起作用了

# android - 解析 JSON，然后将多个字符串添加到 ArrayList

> ID：15857173
> 
> 赞同：0
> 
> 时间：2013-04-06T23:28:16.163
> 
> 标签：android, json, parsing, rest

目前正在开发一个应用程序，该应用程序从搜索中获取结果，解析返回的 JSON 对象，然后将结果片段添加到`ArrayLists`创建的名为`VenueList`.

下面是从服务接收结果并解析 JSON 的方法：

```
 private static List<String> getResultsFromJson(String json) {
    ArrayList<String> resultList = new ArrayList<String>();         
    try {
        JSONObject resultsWrapper = (JSONObject) new JSONTokener(json).nextValue(); 
        JSONArray  results        = resultsWrapper.getJSONArray("results");

        for (int i = 0; i < results.length(); i++) {
            JSONObject result = results.getJSONObject(i);
            resultList.add(result.getString("text")); 

        }
    }
    catch (JSONException e) {
        Log.e(TAG, "Failed to parse JSON.", e);
    }

    return resultList;
} 
```

什么结果变成了一个`List`变量调用`mResults`（澄清：`mResults = getResultsFromJson(restResult);`。然后在以下循环中使用，其中包括将结果放入`ArrayAdapter`用于在 ListFragment 中显示它们的循环中：

```
for (String result : mResults) {    
    VenueList.addVenue(result, "HELLO WORLD"); 
    adapter.add(result);
} 
```

我还将结果添加到一个名为的类中，该类`VenueList`管理结果并使它们可用于多个视图。它基本上只包含多个`ArrayLists`，其中包含搜索中返回的每个场所的不同类型的详细信息。我用来添加场地的`VenueList`方法如下（您可以在上面的 for 循环中看到它）：

```
public static void addVenue(String name, String geo) {
    venueNames.add(name);
    venueGeos.add(geo);
} 
```

我希望该`addVenue`方法能够接受多个参数并更新`VenueList`类。然而，当我`addVenue`在 for 循环中调用该方法时，我只能传递它`String result`（从循环的参数）并且无法弄清楚如何传递它的第二个参数（它也应该来自解析的 JSON `getResultsFromJson`）所以我`"HELLO WORLD"`现在用作占位符。

我意识到`getResultsFromJson`只有一个列表返回。我需要能够从我解析的 JSON 对象中获取多个元素，然后以正确的顺序将它们添加到 VenueList。

所以我的问题是：

1）给定`getResultsFromJson`方法和`for`循环，我该如何使用`addVenue()`设计的方法？如何解析 JSON 中的多个元素，然后将它们同时添加到 VenueList？我计划稍后为其添加更多参数，但我假设如果我可以让它与两个一起工作，我可以让它与四个或五个一起工作。

2）如果不可能，应该如何重新设计`getResultsFromJson`、`for`循环和`addVenue`方法以使其正常工作？

如果您需要更多详细信息或代码，请告诉我 - 很乐意提供。谢谢！

编辑 - 完整的 VenueList 类：

```
public class VenueList {

private static ArrayList<String> venueNames; 
private static ArrayList<String> venueGeos;

public VenueList() {
    venueNames = new ArrayList<String>();
    venueGeos = new ArrayList<String>();
}

public static void addVenue(String name, String geo) { 
    venueNames.add(name);
    venueGeos.add(geo);
}

public static String getVenueName(int position) { 
    return venueNames.get(position);
}

public static String getVenueGeo(int position) {
    return venueGeos.get(position);
}

public static void clearList() {
    venueNames.clear();
    venueGeos.clear();
}

} 
```

说明：我将为要存储的有关场地（电话号码、地址等）的每个数据元素添加额外的 ArrayList

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:27:40.260

1) 我认为 getResultsFromJson(String json) 和 addVenue(String name, String geo) 方法不适合您的需求。

2）我会考虑将方法 getResultsFromJson(String json) 重写为这样的：

```
private static SortedMap<Integer, List<String>> getResultsFromJson(String json) {
    Map<Integer, String> resultMap = new TreeMap<Integer, String>();         

    //...

    return resultMap;
} 
```

您的地图键的数量应该等于您正在提取信息的对象的数量，并且它们中的每一个都将按照您提取它们的正确顺序正确地拥有自己的项目列表。

使用这种方法，您当然可以将逻辑更改为以下内容：

```
// grab your retuned map and get an entrySet, the just iterate trough it
SortedMap<Integer, String> result = returnedMap.entrySet();

for (Entry<Integer, String> result : entrySet) {    
    Integer key = result.getKey(); // use it if you need it
    List<String> yourDesiredItems = result.getValue(); // explicitly shown to know how to get it

    VenueList.addVenue(yourDesiredItems); 
}

public static void addVenue(List<String> yourDesiredItems) {
    // refactor here to iterate the items trough the list and save properly    

    //....
} 
```

**编辑——因为您希望避免中间映射，我假设您不需要从该方法返回任何内容**

首先，我为您提供满足您要求的解决方案，然后我将为您提供一些提示，因为我看到了一些可以简化您的设计的东西。

要直接保存 VenueList 的内容，`getResultsFromJSON`请执行以下操作：

```
private static void getResultsFromJson(String json) {
    try {
        JSONObject resultsWrapper = (JSONObject) new JSONTokener(json).nextValue(); 
        JSONArray  results        = resultsWrapper.getJSONArray("results");

        for (int i = 0; i < results.length(); i++) {
            JSONObject result = results.getJSONObject(i);

            //FOR EXAMPLE HERE IS WHERE YOU NEED TO EXTRACT INFO
            String name = result.getString("name");
            String geo = result.getString("geo");

            // and then...

            VenueList.addVenue(name, geo, ..., etc);
        }
    } catch (JSONException e) {
        Log.e(TAG, "Failed to parse JSON.", e);
    }
} 
```

这意味着您的`addVenue`方法应该知道接收所有需要的参数；正如您所看到的，这只是一种方法（您可以考虑根据您的需求解决问题），但是由于我不知道导致您编写此模型的所有要求，我将指出您可能会考虑的一些事项：

***1.*** *如果类有理由`VenueList`使用所有静态的东西，请考虑这样做：*

```
static{
    venueNames = new ArrayList<String>();
    venueGeos = new ArrayList<String>();
    //....
}

private VenueList(){
} 
```

这样您就不需要每次都获取一个实例，并且在没有先前实例化的情况下也`null pointer exceptions`可以避免`VenueList.addVenue(...)`。

***2.*** *考虑为类中的`ArrayList`每个特征`VenueList`定义一个`model object`，而不是`Venue`像这样定义一个：*

```
public class Venue{
    String name;
    String geo;
    //... etc

    public Venue(){
    }

    // ... getters & setters
} 
```

然后，如果您需要`VenueList`该类，您将只有一个 Venue 对象列表`(List<Venue>)`，这意味着`addVenue`您将首先创建一个全新的`Venue`类实例，并调用每个特性的 setter 方法，而不是调用该方法，例如从我为您提供的解决方法重构 for 循环，您将使用如下内容：

```
List<Venue> myListOfVenues = new ArrayList<Venue>();

for (int i = 0; i < results.length(); i++) {
    JSONObject result = results.getJSONObject(i);

    // THIS WOULD REMAIN THE SAME TO EXTRACT INFO
    String name = result.getString("name");
    String geo = result.getString("geo");

    // and then instead of calling VenueList.addVenue(name, geo, ..., etc)...
    Venue v = new Venue();
    v.setName(name);
    v.setGeo(geo);
    // ...etc

    myListOfVenues.add(v);
}

// Once you're done, set that List to VenueList class
VenueList.setVenueList(myListOfVenues); 
```

所以`VenueList`类现在将有一个单一的属性`List<Venue> venueList;`，并且会在方法上遭受轻微的 tweeks`getVenueName, etc...`并且一切都会更具可读性......我希望这可以帮助你找到另一种方法来解决你的问题，如果我仍然没有表达我的观点，请告诉我我会尽力帮助你...

# django - Django Haystack Whoosh 多语言网站

> ID：15857179
> 
> 赞同：1
> 
> 时间：2013-04-06T23:29:46.200
> 
> 标签：django, django-haystack, whoosh

我在我的 django 项目中使用带有 whoosh 后端的 haystack。我的模型是多语言的模型翻译模块，它为名为 title 的字段创建自动字段，如 title_tr、title_en...

我试图让搜索知道已搜索网络并编写以下行的所选语言，但它不适用于 title_tr、entry_tags_tr 字段...#search_indexes.py

```
from haystack import indexes
from aksak.blog.models import Entry

class EntryIndex(indexes.SearchIndex, indexes.Indexable):
    text = indexes.CharField(model_attr='descr_en', document=True, use_template=True)
    text_tr = indexes.CharField(model_attr='descr_tr')
    title_en = indexes.CharField(model_attr='title_en')
    title_tr = indexes.CharField(model_attr='title_tr')
    tags = indexes.MultiValueField(indexed=True, stored=True, model_attr='entry_tags')

    def get_model(self):
        return Entry

    # haystackCustomQuery.py  !!! IN URLS.PY I AM USING THIS CUSTOM VIEW <-------------

    from django.conf import settings
    from django.utils.translation import get_language
    from haystack.query import SearchQuerySet, DEFAULT_OPERATOR

    class MlSearchQuerySet(SearchQuerySet):
        def filter(self, **kwargs):
            if 'content' in kwargs:
                kwd = kwargs.pop('content')
                currentLngCode = str(get_language())
                lngCode = settings.LANGUAGE_CODE
                if currentLngCode == lngCode: 
                    kwdkey = "text" 
                    kwargs[kwdkey] = kwd
                else:
                    kwdkey = "text_%s" % currentLngCode
                    kwargs[kwdkey] = kwd

            if getattr(settings, 'HAYSTACK_DEFAULT_OPERATOR', DEFAULT_OPERATOR) == 'OR':
               return self.filter_or(**kwargs)
            else:
                return self.filter_and(**kwargs) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-10T15:06:40.430

不确定，但我认为它可能与`model_attr`您的子类的参数有关，这些参数`SearchIndex`没有被 haystack 正确解决。尝试定义一些`prepare_<index_fieldname>`方法。

我包含了我在（德语/英语）项目中使用的完整示例。就像您一样，受[多语言 django 网站上的搜索功能的](https://stackoverflow.com/questions/1531447/search-functionality-on-multi-language-django-site)启发，我得到了当前语言并将其映射到一个`SearchIndex`字段：

```
from django.conf import settings
from modeltranslation.utils import get_language
from modeltranslation.settings import DEFAULT_LANGUAGE
from haystack.query import SearchQuerySet, DEFAULT_OPERATOR

class ModeltranslationSearchQuerySet(SearchQuerySet):
    def filter(self, **kwargs):
        if 'content' in kwargs:
            kwd = kwargs.pop('content')
            lang = get_language()
            if lang != DEFAULT_LANGUAGE:
                kwdkey = "text_%s" % lang
                kwargs[kwdkey] = kwd
            else:
                kwargs['text'] = kwd
        if getattr(settings, 'HAYSTACK_DEFAULT_OPERATOR', DEFAULT_OPERATOR) == 'OR':
            return self.filter_or(**kwargs)
        else:
            return self.filter_and(**kwargs) 
```

本质上`SearchIndex`，每种语言都有一个字段，每个字段都有自己的`prepare_<index_fieldname>`方法。这是我的精简版`search_indexes.py`- 它不是很通用，但可以很好地满足我的简单要求：

```
from haystack import indexes

class ContentIndex(indexes.SearchIndex, indexes.Indexable):
    text = indexes.EdgeNgramField(document=True)  # German (default language)
    text_en = indexes.EdgeNgramField()  # English

    def prepare_text(self, obj):
        return '%s %s' % (obj.title_de, obj.descr_de)

    def prepare_text_en(self, obj):
        return '%s %s' % (obj.title_en, obj.descr_en) 
```

请注意，这里`text`使用的是索引字段而不是`text_de`索引字段，`document=True`因为它是 haystack 的约定（你说得对）。但是在`prepare_<index_fieldname>`方法内部使用了实际的翻译字段名。它也不使用模板，而是简单的字符串连接。

haystack 中包含的泛型`SearchView`（我使用 2.0.0-beta）需要一个`searchquery`参数，因此`ModeltranslationSearchQuerySet`可以像这样直接通过 urls 设置传递（据我所知，你有那个）：

```
from haystack.forms import ModelSearchForm

url(r'^search/$', SearchView(
    searchqueryset=ModeltranslationSearchQuerySet(), form_class=ModelSearchForm)) 
```

最后说明：我有一段时间没有使用该代码，并且模型翻译在当前语言意识方面发生了一些重大变化。对于模型转换> = 0.6，它可能会被简化一点。

# java - 我想知道如何实现java获取和释放以正确实现信号量并发

> ID：15857185
> 
> 赞同：1
> 
> 时间：2013-04-06T23:31:17.807
> 
> 标签：java, concurrency, semaphore

我想知道只有当客户要求邮寄包裹时，工人如何获得秤。即 50 个客户访问邮局（每个客户 1 个线程，最多 50 个），所有这些都是最初创建的。一次只能有 10 位顾客在邮局内。每个客户在创建时都会被随机分配以下任务之一：购买邮票、邮寄信件、邮寄包裹。秤是邮递员邮寄包裹时使用的。只有一个，一次只能使用一个。秤不是一根线。它们只是邮政工作线程使用的资源。我有以下代码：

```
 class Customer extends Thread {

  /* we create the integer iD which is a unique ID number for every worker
     and a boolean notServed which is used in the Customer waiting loop */

  int iD;
  int bG;
  Semaphore sem;
  boolean notServed=true;

  /* Constructor for the Customer */

  public Customer(int i, int b, Semaphore s) {
    iD = i;
     bG = b;
     sem = s;
  }

  public void run() {   
    while (notServed) {  // as long as the worker is not cut 
      try {
      accessSpots.acquire();  //tries to get access to the rooms
      if (numberOfAvailRoom > 0) {  //if there are any free rooms
        System.out.println("Customer " + this.iD + " enter post office ");
          try {
        sleep(1000);
        } catch (InterruptedException ex){ }
          numberOfAvailRoom--;  //room is taken
        sem.release();  //notify the worker that there is a worker
          help.release();
        try {
          workers.acquire();  // now it's this customers turn but we have to wait if the worker is busy
        notServed = false;  // this worker will now leave after the procedure
          if (bG == 1)
            {
                System.out.println("Customer "+this.iD+" ask postal worker to buy stamp");
                buyStamp();
                help.release();
                workers.release();
                try {

                     sleep(1000);
                } catch (InterruptedException ex){ }

            }
            else if (bG == 2)
            {
                System.out.println("Customer "+this.iD+" ask postal worker to mail letter");
                mailLetter();
                help.release();
                workers.release();
                try {

                     sleep(1000);
                } catch (InterruptedException ex){ }

            }

        else if (bG == 3)
        {
            //scale.release();
            System.out.println("Customer "+this.iD+" ask postal worker to mail package");
            //scale.release();
            mailPackage();
            help.release();
            workers.release();
            //scale.release();
            try {

                     sleep(1000);
            } catch (InterruptedException ex){ }

            //bellHops.acquire();
        }
} catch (InterruptedException ex) {}
      }   
      else  {  // there are no free rooms
        //System.out.println("There are no available room. Customer " + this.iD + " has left the workershop.");
        accessSpots.release();  //release the lock on the rooms
        notServed=true; // .
      }
     }
      catch (InterruptedException ex) {}
    }
  }

  /* this method will simulate getting a hair-cut */

  public void buyStamp(){

  System.out.println("Customer " + this.iD+" finished buying stamp" );
    try {
    sleep(1000);
    } catch (InterruptedException ex) {}
     sem.release();
     leave();

  }
  public void mailLetter(){
  //i = a;

  System.out.println("Customer " + this.iD + " finished mailing letter ");
    try {
    sleep(1500);
    } catch (InterruptedException ex) {}
     sem.release();
     leave();

  }

  public void mailPackage(){
  //i = a;
    scale.release();

  System.out.println("Customer " + this.iD + " finished mailing package ");
    try {
    sleep(2000);
    } catch (InterruptedException ex) {}
     sem.release();
     leave();

  }
    public void leave()
    {
        System.out.println("Customer "+this.iD+" left the post office ");
    }

}

/* THE EMPLOYEE THREAD */

class Worker extends Thread {
 int iD;
 Semaphore sem;
 //int bG

  public Worker(int a, Semaphore s) 
  {
    iD = a;
    sem = s;
    //bG = b;
  }

  public void run() {
    while(true) {  // runs in an infinite loop
      try {
      customers.acquire(); // tries to acquire the next avail customer
        accessSpots.release(); // at this time he has been awaken -> want to modify the number of available rooms
      numberOfAvailRoom++; // one room gets free
        int a = numberOfAvailRoom;
        System.out.println("Postal Worker "+this.iD +" serving cutomer ");
      workers.release();  // the worker is ready
      accessSpots.release(); // we don't need the lock on the room anymore
        //help.acquire();
        //scale.acquire();
        this.Scale();
        //scaleRelease();
        //int a = gNum;
      //this.Finished();  //cutting...      
    } catch (InterruptedException ex) {}
    }
  }
     public void Scale(){
     try
     {
        scale.acquire();
     System.out.println("Scale in use by Postal Worker "+this.iD);
      this.scaleRelease();
     }catch (InterruptedException ex){}

    }

    public void scaleRelease(){
    //try
    //{
        //rel.acquire();
     System.out.println("Scale released by Postal Worker "+this.iD);
     //}catch (InterruptedException ex){}
   }   
    public void Finished(){
        System.out.println("Postal Worker "+this.iD+" finished serving customer ");
        //done.release();

  } 
```

}

# python - Python：将 Matplotlib 图添加到 wxFormBuilder 的自动生成的帧输出？

> ID：15857187
> 
> 赞同：0
> 
> 时间：2013-04-06T23:31:28.630
> 
> 标签：python, matplotlib, wxpython, wxformbuilder

学习 Python（作为一个强大的 C# 程序员进入它），对 SciPy 和 Matplotlib 的强大功能感到兴奋，所以我希望在面板中添加一个 matplotlib 图。该面板位于笔记本中，其代码作为 wxFormBuilder 的输出生成（参见“Main_gui.py”文件）。

我遇到的问题是我遇到了一个错误，并且在尝试了许多代码扰动后它仍然存在：

`AttributeError: type object 'MainForm' has no attribute 'page_Data'`

**这是我的文件：**

* * *

“主.py”：

```
import wx

import Main_gui

from numpy import arange, sin, pi

import matplotlib
matplotlib.use('WXAgg')
from matplotlib.backends.backend_wxagg import FigureCanvasWxAgg as FigureCanvas
from matplotlib.figure import Figure

class MainApp( Main_gui.MainForm ):

  # === INITIALIZATION =================================================================================
  def __init__(self, parent):

    #Initialize the main form
    Main_gui.MainForm.__init__( self, parent )

    #Create chart
    self.sizer = self.page_Data.GetSizer()
    self.plot_container = self.page_Data
    self.plotpanel = CreatePlot(self.plot_container)
    self.sizer.Add(self.plotpanel, 1, wx.EXPAND)
    self.plot_container.SetSizer(self.sizer)

class CreatePlot(wx.Panel):

  def __init__(self, parent):

    wx.Panel.__init__(self, parent, -1)

    self.figure = Figure(figsize=(5,4), dpi=100)
    self.axes = self.figure.add_subplot(111)
    t = arange(0.0,3.0,0.01)
    s = sin(2*pi*t)
    self.axes.plot(t,s)

    self.canvas = FigureCanvas(self, -1, self.figure)
    sizer = wx.BoxSizer(wx.VERTICAL)
    sizer.Add(self.canvas, 1, wx.TOP | wx.LEFT | wx.EXPAND)
    Main_gui.MainForm.page_Data.SetSizer(sizer)
    Main_gui.MainForm.page_Data.Fit()

if __name__ == '__main__':

  # === RUN ==========================================================================================
  #Get the wxApp
  app = wx.App(0)
  #Show the form
  MainApp(None).Show()
  #Run
  app.MainLoop() 
```

* * *

“main_gui.py”：

```
# -*- coding: utf-8 -*- 

###########################################################################
## Python code generated with wxFormBuilder (version Oct  8 2012)
## http://www.wxformbuilder.org/
##
## PLEASE DO "NOT" EDIT THIS FILE!
###########################################################################

import wx
import wx.xrc

###########################################################################
## Class MainForm
###########################################################################

class MainForm ( wx.Frame ):

    def __init__( self, parent ):
        wx.Frame.__init__ ( self, parent, id = wx.ID_ANY, title = u"MainForm", pos = wx.DefaultPosition, size = wx.Size( 813,512 ), style = wx.DEFAULT_FRAME_STYLE|wx.TAB_TRAVERSAL )

        self.SetSizeHintsSz( wx.DefaultSize, wx.DefaultSize )

        sizer_Main = wx.BoxSizer( wx.VERTICAL )

        self.m_notebook2 = wx.Notebook( self, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.NB_BOTTOM|wx.NB_FIXEDWIDTH )
        self.page_Connections = wx.Panel( self.m_notebook2, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        flexgrid_Connections = wx.FlexGridSizer( 2, 0, 10, 0 )
        flexgrid_Connections.AddGrowableCol( 0 )
        flexgrid_Connections.AddGrowableRow( 1 )
        flexgrid_Connections.SetFlexibleDirection( wx.BOTH )
        flexgrid_Connections.SetNonFlexibleGrowMode( wx.FLEX_GROWMODE_SPECIFIED )

        sizer1_Connections = wx.StaticBoxSizer( wx.StaticBox( self.page_Connections, wx.ID_ANY, u"Connection" ), wx.VERTICAL )

        sizer1grid_Connections = wx.GridSizer( 0, 3, 0, 0 )

        self.m_staticText3 = wx.StaticText( self.page_Connections, wx.ID_ANY, u"IP Address:", wx.DefaultPosition, wx.DefaultSize, wx.ALIGN_LEFT )
        self.m_staticText3.Wrap( -1 )
        sizer1grid_Connections.Add( self.m_staticText3, 0, wx.ALIGN_CENTER_VERTICAL|wx.ALIGN_RIGHT, 5 )

        self.txt_Connections_IPaddress = wx.TextCtrl( self.page_Connections, wx.ID_ANY, u"10.0.0.3", wx.DefaultPosition, wx.DefaultSize, wx.TE_LEFT )
        self.txt_Connections_IPaddress.SetMaxLength( 15 ) 
        sizer1grid_Connections.Add( self.txt_Connections_IPaddress, 0, wx.ALIGN_CENTER_VERTICAL|wx.ALL, 5 )

        self.btn_Connections_Connect = wx.Button( self.page_Connections, wx.ID_ANY, u"Connect", wx.DefaultPosition, wx.DefaultSize, 0 )
        sizer1grid_Connections.Add( self.btn_Connections_Connect, 0, wx.ALIGN_CENTER_VERTICAL|wx.ALL, 5 )

        sizer1_Connections.Add( sizer1grid_Connections, 0, 0, 5 )

        flexgrid_Connections.Add( sizer1_Connections, 0, wx.EXPAND, 5 )

        sizer2_Connections = wx.StaticBoxSizer( wx.StaticBox( self.page_Connections, wx.ID_ANY, u"Status" ), wx.VERTICAL )

        fgSizer5 = wx.FlexGridSizer( 10, 4, 0, 0 )
        fgSizer5.AddGrowableCol( 2 )
        fgSizer5.SetFlexibleDirection( wx.BOTH )
        fgSizer5.SetNonFlexibleGrowMode( wx.FLEX_GROWMODE_SPECIFIED )

        self.m_staticText5 = wx.StaticText( self.page_Connections, wx.ID_ANY, u"Device Name:", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText5.Wrap( -1 )
        fgSizer5.Add( self.m_staticText5, 0, wx.ALIGN_CENTER_VERTICAL|wx.ALIGN_RIGHT|wx.ALL, 5 )

        self.txt_Connections_DeviceName = wx.TextCtrl( self.page_Connections, wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.DefaultSize, 0 )
        fgSizer5.Add( self.txt_Connections_DeviceName, 0, wx.ALIGN_CENTER_VERTICAL|wx.ALL, 5 )

        self.btn_Connections_RenameDevice = wx.Button( self.page_Connections, wx.ID_ANY, u"Rename", wx.DefaultPosition, wx.DefaultSize, wx.BU_EXACTFIT )
        fgSizer5.Add( self.btn_Connections_RenameDevice, 0, wx.ALIGN_CENTER_VERTICAL|wx.ALL, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        self.m_staticText6 = wx.StaticText( self.page_Connections, wx.ID_ANY, u"ADC Channels:", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText6.Wrap( -1 )
        fgSizer5.Add( self.m_staticText6, 0, wx.ALIGN_CENTER_VERTICAL|wx.ALIGN_RIGHT|wx.ALL, 5 )

        self.txt_Connections_ADCchannels = wx.TextCtrl( self.page_Connections, wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.DefaultSize, 0 )
        fgSizer5.Add( self.txt_Connections_ADCchannels, 0, wx.ALIGN_CENTER_VERTICAL|wx.ALL, 5 )

        self.btn_Connections_SetADC = wx.Button( self.page_Connections, wx.ID_ANY, u"Set", wx.DefaultPosition, wx.DefaultSize, wx.BU_EXACTFIT )
        fgSizer5.Add( self.btn_Connections_SetADC, 0, wx.ALIGN_CENTER_VERTICAL|wx.ALL, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        self.m_staticText15 = wx.StaticText( self.page_Connections, wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText15.Wrap( -1 )
        fgSizer5.Add( self.m_staticText15, 0, wx.ALL, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        self.m_staticText16 = wx.StaticText( self.page_Connections, wx.ID_ANY, u"HVPS:", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText16.Wrap( -1 )
        fgSizer5.Add( self.m_staticText16, 0, wx.ALL, 5 )

        self.m_staticText17 = wx.StaticText( self.page_Connections, wx.ID_ANY, u"Disabled", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText17.Wrap( -1 )
        fgSizer5.Add( self.m_staticText17, 0, wx.ALL, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        self.m_staticText18 = wx.StaticText( self.page_Connections, wx.ID_ANY, u"Setpoint:", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText18.Wrap( -1 )
        fgSizer5.Add( self.m_staticText18, 0, wx.ALL, 5 )

        self.m_staticText19 = wx.StaticText( self.page_Connections, wx.ID_ANY, u"0.00 V", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText19.Wrap( -1 )
        fgSizer5.Add( self.m_staticText19, 0, wx.ALL, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        self.m_staticText20 = wx.StaticText( self.page_Connections, wx.ID_ANY, u"Stabilized Probe:", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText20.Wrap( -1 )
        fgSizer5.Add( self.m_staticText20, 0, wx.ALL, 5 )

        self.m_staticText21 = wx.StaticText( self.page_Connections, wx.ID_ANY, u"False", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText21.Wrap( -1 )
        fgSizer5.Add( self.m_staticText21, 0, wx.ALL, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        self.m_staticText22 = wx.StaticText( self.page_Connections, wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText22.Wrap( -1 )
        fgSizer5.Add( self.m_staticText22, 0, wx.ALL, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        self.m_staticText7 = wx.StaticText( self.page_Connections, wx.ID_ANY, u"Serial Number:", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText7.Wrap( -1 )
        fgSizer5.Add( self.m_staticText7, 0, wx.ALL, 5 )

        self.m_staticText8 = wx.StaticText( self.page_Connections, wx.ID_ANY, u"000000", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText8.Wrap( -1 )
        fgSizer5.Add( self.m_staticText8, 0, wx.ALL, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        self.m_staticText9 = wx.StaticText( self.page_Connections, wx.ID_ANY, u"Telnet:", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText9.Wrap( -1 )
        fgSizer5.Add( self.m_staticText9, 0, wx.ALL, 5 )

        self.m_staticText10 = wx.StaticText( self.page_Connections, wx.ID_ANY, u"Disabled", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText10.Wrap( -1 )
        fgSizer5.Add( self.m_staticText10, 0, wx.ALL, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        self.m_staticText11 = wx.StaticText( self.page_Connections, wx.ID_ANY, u"TFTP:", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText11.Wrap( -1 )
        fgSizer5.Add( self.m_staticText11, 0, wx.ALL, 5 )

        self.m_staticText12 = wx.StaticText( self.page_Connections, wx.ID_ANY, u"Disabled", wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_staticText12.Wrap( -1 )
        fgSizer5.Add( self.m_staticText12, 0, wx.ALL, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        fgSizer5.AddSpacer( ( 0, 0), 1, wx.EXPAND, 5 )

        sizer2_Connections.Add( fgSizer5, 1, wx.EXPAND, 5 )

        flexgrid_Connections.Add( sizer2_Connections, 0, wx.EXPAND, 5 )

        self.page_Connections.SetSizer( flexgrid_Connections )
        self.page_Connections.Layout()
        flexgrid_Connections.Fit( self.page_Connections )
        self.m_notebook2.AddPage( self.page_Connections, u"Connections", False )
        self.page_Acquisition = wx.Panel( self.m_notebook2, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_notebook2.AddPage( self.page_Acquisition, u"Acquisition", False )
        self.page_Data = wx.Panel( self.m_notebook2, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        bSizer3 = wx.BoxSizer( wx.VERTICAL )

        self.page_Data.SetSizer( bSizer3 )
        self.page_Data.Layout()
        bSizer3.Fit( self.page_Data )
        self.m_notebook2.AddPage( self.page_Data, u"Data", True )
        self.page_Calibration = wx.Panel( self.m_notebook2, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_notebook2.AddPage( self.page_Calibration, u"Calibration", False )
        self.page_Analyses = wx.Panel( self.m_notebook2, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_notebook2.AddPage( self.page_Analyses, u"Analyses", False )
        self.page_Locator = wx.Panel( self.m_notebook2, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_notebook2.AddPage( self.page_Locator, u"Locator", False )
        self.page_Hardware = wx.Panel( self.m_notebook2, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_notebook2.AddPage( self.page_Hardware, u"Hardware", False )
        self.page_Log = wx.Panel( self.m_notebook2, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_notebook2.AddPage( self.page_Log, u"Log", False )

        sizer_Main.Add( self.m_notebook2, 1, wx.BOTTOM|wx.EXPAND|wx.TOP, 5 )

        self.SetSizer( sizer_Main )
        self.Layout()

        self.Centre( wx.BOTH )

    def __del__( self ):
        pass 
```

* * *

追溯：

```
Traceback (most recent call last):
  File "<project location>\Main.py", line 56, in <module>
    MainApp(None).Show()
  File "<project location>\Main.py", line 27, in __init__
    self.plotpanel = CreatePlot(self.plot_container)
  File "<project location>\Main.py", line 47, in __init__
    Main_gui.MainForm.page_Data.SetSizer(sizer)
AttributeError: type object 'MainForm' has no attribute 'page_Data'
19:12:12: Debug: ..\..\include\wx/msw/private.h(697): 'UnregisterClass' failed with    error 0x00000584 (class still has open windows.). 
```

* * *

那么，我做错了什么？谢谢！

* * *

### 最近的编辑，感谢 Yoriz：

```
class MainApp( Main_gui.MainForm ):

  # === INITIALIZATION =================================================================================
  def __init__(self, parent):

    #Initialize the main form
    Main_gui.MainForm.__init__( self, parent )

    #Create chart
    self.sizer = self.page_Data.GetSizer()
    self.plot_container = self.page_Data
    self.plotpanel = CreatePlot(self.plot_container)

class CreatePlot(wx.Panel):

  def __init__(self, parent):

    wx.Panel.__init__(self, parent, -1)

    self.figure = Figure(figsize=(5,4), dpi=100)
    self.axes = self.figure.add_subplot(111)
    t = arange(0.0,3.0,0.01)
    s = sin(2*pi*t)
    self.axes.plot(t,s)

    self.canvas = FigureCanvas(parent, -1, self.figure)
    sizer = wx.BoxSizer(wx.VERTICAL)
    sizer.Add(self.canvas, 1, wx.TOP | wx.LEFT | wx.EXPAND)
    parent.SetSizer(sizer)
    parent.Fit() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:29:52.983

看起来在 CreatePlot 类中，您在其末尾进行调用类调用

```
Main_gui.MainForm.page_Data.SetSizer(sizer)
Main_gui.MainForm.page_Data.Fit() 
```

这些需要是访问这些方法的实例调用

我想你可能希望他们成为

```
parent.page_Data.SetSizer(sizer)
parent.page_Data.Fit() 
```

# php - 无法从 PHP MySQL 查询将纬度/经度结果返回到 Javascript JSON

> ID：15857198
> 
> 赞同：0
> 
> 时间：2013-04-06T23:33:22.290
> 
> 标签：php, javascript, json, google-maps

我正在尝试从 PHP/MySQL 查询将纬度和经度的数据库值返回到我的 Javascript 函数，以填充谷歌地图 JSON 请求。

我的 PHP/MySQL 查询脚本 phpsearch2.php 是：

```
<?php
include "base.php";
$name = $_GET["name"];
$query = "SELECT lat, lng FROM markers WHERE name = '".$name."'";
$result = mysql_query($query);
while($row = mysql_fetch_array ($result))     
{
     echo '{';
           echo '"latitude":"'.$row['lat'].'",';
           echo '"longitude":"'.$row['lng'].'",';
     echo '}';    
}
?> 
```

它以这种格式返回一个值：

```
{"latitude":"37.730267","longitude":"-122.498589",} 
```

这是我的计算根函数，当我运行程序时，即使我认为我将它设置为与从 JSON 请求到 phpsearch 的返回结果具有相同的值，我也会收到一条错误消息，说**“原点未定义”** ，我只是不不知道错在哪里。

```
 function calcRoute() {
    var startname = document.getElementById('start').value;
    var endname = document.getElementById('end').value;
    var waypts = [];
    var checkboxArray = document.getElementById('waypoints');
    for (var i = 0; i < checkboxArray.length; i++) {
      if (checkboxArray.options[i].selected == true) {
        waypts.push({
            location:checkboxArray[i].value,
            stopover:true});
      }
    }

$.getJSON("phpsearch2.php", {name : startname}, function (result) {
origin = google.maps.LatLng('result');
});

var end = new google.maps.LatLng('37.738029', '-122.499481');
     var request = {
        origin: origin,
        destination: end,
        waypoints: waypts,
        optimizeWaypoints: true,
        travelMode: google.maps.DirectionsTravelMode.WALKING
    };
        directionsService.route(request, function(response, status) {
    //document.write('<b>'+ start + end + '</b>');
      if (status == google.maps.DirectionsStatus.OK) {
        directionsDisplay.setDirections(response);
        var route = response.routes[0];
        var summaryPanel = document.getElementById('directions_panel');
        summaryPanel.innerHTML = '';
        // For each route, display summary information.
        for (var i = 0; i < route.legs.length; i++) {
          var routeSegment = i + 1;
          summaryPanel.innerHTML += '<b>Time for a Walkabout </b><br>';
          summaryPanel.innerHTML += '<b>From ' + startname + '   </b>';
          summaryPanel.innerHTML += '<b>to ' + endname + '('+ route.legs[i].distance.text +')</b><br>';

      } 
      }
    });
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T23:41:32.197

您将“结果”作为字符串传递。您需要传递结果对象，不带引号：

```
var origin = google.maps.LatLng(result); 
```

请记住 $.getJSON 是异步的。您可能需要将其余 gmaps 代码包装在函数声明中，并在设置 origin*后*在 $.getJSON 回调中调用该函数。否则，在从服务器获取原始数据之前，您仍在尝试使用它。

就像是：

```
$.getJSON("phpsearch2.php", {name : startname}, function (result) {
    var origin = google.maps.LatLng(result);

    // Now that we have our origin, we can initialize the rest
    init(origin);
});

function init(origin) {
   var end = new google.maps.LatLng('37.738029', '-122.499481');
   var request = {
        origin: origin,
   <snip>
} 
```

# google-drive-api - 需要访问 API 以与可变人员列表共享文件夹

> ID：15857199
> 
> 赞同：3
> 
> 时间：2013-04-06T23:33:23.803
> 
> 标签：google-drive-api

我正在使用 VB 2010 创建一些数据采集程序，其中一个请求是我们使用 Google Drive 来存储和共享创建后的 Excel 文件。我已经能够将文件夹保存并同步到我的云端硬盘中，我现在需要能够与可变的电子邮件地址列表共享此文件夹。

这些电子邮件都是“name”@mix.wvu.edu，他们会在实验开始时输入这些，这样当他们保存时，它会自动发送到我的驱动器，然后通过电子邮件发送给学生。

基本上，我需要一些帮助来编写代码以从“我的驱动器”中选择一个文件文件夹，单击“共享”，添加能够编辑文件的人，并在学生单击下面的按钮时发送它们。任何帮助将非常感激！谢谢！

*   [到目前为止我所拥有的 .xlsx 文件的示例代码](https://docs.google.com/a/mix.wvu.edu/file/d/0B_YscePF1YjgRlZxaXltQUhBQnM/edit?usp=sharing)

### 样本数据集

```
 Tension Test
Date:               Apr-06-2013             Load    Extension       Stress  Strain
Time:               15:07                   6       4.5
Specimen Material:  Plexiglass              7       6
Specimen #:         14                      8       7.5
Width:              34                      9       9
Thickness:          3                       10      10.5
Area:               102                     11      12
Gage Length:        3                       12      13.5
Data Rate:          10                      13      15
                                            14      16.5
                                            15      18
                                            16      19.5
                                            17      21
                                            18      22.5
                                            19      24
                                            20      25.5
                                            21      27
                                            22      28.5
                                            23      30
                                            24      31.5
                                            25      33 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T16:44:41.993

如需共享文件，请参阅：[https](https://developers.google.com/drive/manage-sharing) ://developers.google.com/drive/manage-sharing和权限资源：[https ://developers.google.com/drive/v2/reference/permissions](https://developers.google.com/drive/v2/reference/permissions)

如果您有任何具体问题，请询问他们。

# entity-framework - 序列不包含元素：首先是自引用代码

> ID：15857203
> 
> 赞同：0
> 
> 时间：2013-04-06T23:34:06.753
> 
> 标签：entity-framework, code-first

当我尝试对下一个实体进行自我引用时

```
public class Folder
{
    public int Id { get; set; }
    public int?  ParentFolderId { get; set; } // Added property
    public string Name { get; set; }

    public virtual ICollection<Folder> Childrens { get; set; } // Added property
    public virtual ICollection<ArticleTitle> ArticleTitles { get; set; }

}

public class ArticleTitle
{
    public int Id { get; set; }
    public string Title { get; set; }
    public int? FolderId { get; set; }
    public virtual Folder Folder { get; set; }
    public virtual Article Article { get; set; }
} 
```

我添加了一些属性（注释为“添加的属性”）和这行代码：

```
 modelBuilder.Entity<Folder>()
 .HasMany(s => s.Childrens)
 .WithOptional()
 .HasForeignKey(s => s.ParentFolderId); 
```

并得到这个例外：

**序列不包含任何元素**

不是正确的自引用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:06:18.380

这就是您的代码的样子：

```
public class Folder
{
    public int Id { get; set; }
    [ForeignKey("ParentFolder")]
    public int?  ParentFolderId { get; set; }
    public virtual Folder ParentFolder { get; set; }
    public string Name { get; set; }

    public virtual ICollection<Folder> Childrens { get; set; }
    public virtual ICollection<ArticleTitle> ArticleTitles { get; set; }

}
... 
```

我很高兴它有帮助。

# ios - 如何使用 cocoalibspotify 进行音频交叉淡入淡出？

> ID：15857209
> 
> 赞同：7
> 
> 时间：2013-04-06T23:35:06.663
> 
> 标签：ios, spotify, cocoalibspotify-2.0

我想在支持 Spotify 的应用程序中从一首曲目交叉淡入到下一首曲目。两个曲目都是 Spotify 曲目，由于一次只能来自 Spotify 的一个数据流，我怀疑我需要缓冲（我想我可以提前 1.5 倍播放速度）第一首曲目的最后几秒钟，开始流对于轨道二，使用 AudioUnit 淡出一并淡入二。

我已经查看了示例应用程序：Viva - [https://github.com/iKenndac/Viva](https://github.com/iKenndac/Viva) SimplePlayer with EQ - [https://github.com/iKenndac/SimplePlayer-with-EQ](https://github.com/iKenndac/SimplePlayer-with-EQ)并试图让我的想法围绕 SPCircularBuffer，但是我仍然需要帮助。有人可以给我指出另一个例子或帮助指出一个轨道交叉淡入淡出的游戏计划吗？

更新：感谢 iKenndac，我大约 95% 在那里。我将发布到目前为止的内容：

在 SPPlaybackManager.m 中：initWithPlaybackSession:(SPSession *)aSession {

添加：

```
self.audioController2 = [[SPCoreAudioController alloc] init];
self.audioController2.delegate = self; 
```

并且在

```
- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context {

...

self.audioController.audioOutputEnabled = self.playbackSession.isPlaying;

// for crossfade, add

self.audioController2.audioOutputEnabled = self.playbackSession.isPlaying; 
```

并添加了基于 playTrack 的新方法

```
-(void)crossfadeTrack:(SPTrack *)aTrack callback:(SPErrorableOperationCallback)block {
// switch audiocontroller from current to other
if (self.playbackSession.audioDeliveryDelegate == self.audioController)
{
   self.playbackSession.audioDeliveryDelegate = self.audioController2;
   self.audioController2.delegate = self;
   self.audioController.delegate = nil;
}
else
{

   self.playbackSession.audioDeliveryDelegate = self.audioController;
   self.audioController.delegate = self;
   self.audioController2.delegate = nil;
}

if (aTrack.availability != SP_TRACK_AVAILABILITY_AVAILABLE) {
    if (block) block([NSError spotifyErrorWithCode:SP_ERROR_TRACK_NOT_PLAYABLE]);
    self.currentTrack = nil;
}

self.currentTrack = aTrack;
self.trackPosition = 0.0;

[self.playbackSession playTrack:self.currentTrack callback:^(NSError *error) {

    if (!error)
        self.playbackSession.playing = YES;
    else
        self.currentTrack = nil;

    if (block) {
        block(error);
    }
}];
} 
```

这将启动交叉淡入淡出的计时器

crossfadeTimer = [NSTimer scheduledTimerWithTimeInterval: 0.5 目标：自我选择器：@selector (crossfadeCountdown) userInfo: nil repeats: YES];

为了在数据加载到 SPCoreAudioController.m 后继续播放第一首曲目，我更改了目标缓冲区长度：

```
static NSTimeInterval const kTargetBufferLength = 20; 
```

在 SPSession.m 中： end_of_track(sp_session *session) {

我删除了

```
// sess.playing = NO; 
```

我在曲目结束前约 15 秒调用 preloadTrackForPlayback：，然后在 10 秒前调用 crossfadeTrack：。

然后设置 crossfadeCountdownTime = [你想要交叉淡入淡出的秒数]*2;

我在交叉淡入淡出上淡化音量：

```
 - (void) crossfadeCountdown
  {

      [UIAppDelegate.playbackSPManager setVolume:(1- (((float)crossfadeCountdownTime/     (thisCrossfadeSeconds*2.0)) *0.2) )];
    crossfadeCountdownTime -= 0.5;

   if (crossfadeCountdownTime == 1.0)
   {
    NSLog(@"Crossfade countdown done");
    crossfadeCountdownTime = 0;
    [crossfadeTimer invalidate];
    crossfadeTimer = nil;
    [UIAppDelegate.playbackSPManager setVolume:1.0];

   }
 } 
```

我会继续努力，如果我能做得更好，我会更新。再次感谢 iKendac 的及时帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-07T12:10:54.523

我知道没有使用 CocoaLibSpotify 的预先编写的淡入淡出示例。然而，一个（也许不是理想的）游戏计划是：

*   制作两个单独的音频队列。`SPCoreAudioController`是音频队列的封装，因此您应该能够实例化其中的两个。

*   正常播放音乐到一个队列。当你接近轨道的尽头时，调用`SPSession`'s`preloadTrackForPlayback:callback:`方法和下一个轨道让它准备好。

*   当播放曲目的所有音频数据都已交付时，`SPSession`将触发音频委托方法`sessionDidEndPlayback:`。这意味着所有音频数据都已交付。但是，由于 CocoaLibSpotify 会缓冲来自 libspotify 的音频，因此在音频停止之前还有一段时间。

*   此时，开始播放新曲目，但将音频数据转移到第二个音频队列。开始降低第一个队列的音量，同时提高下一个队列的音量。这应该会产生令人愉悦的淡入淡出。

几点建议：

*   在`SPCoreAudioController.m`中，您将找到以下行，它定义了 CocoaLibSpotify 缓冲的音频量（以秒为单位）。如果您想要更大的淡入淡出，则需要增加它。

    ```
    static NSTimeInterval const kTargetBufferLength = 0.5; 
    ```

*   由于您以最大 1.5 倍实际播放速度获得音频数据，因此请注意不要在用户刚刚跳过接近曲目末尾时执行 5 秒交叉淡入淡出。您可能没有足够的音频数据来完成它。

*   好好看看`SPPlaybackManager.m`。这个类是 CocoaLibSpotify 和 Core Audio 之间的接口。它并不太复杂，理解它会让你走得很远。`SPCoreAudioController`并且`SPCircularBuffer`几乎是将音频导入Core Audio的实现细节，您无需了解它们的实现即可实现您想要的。

*   另外，请确保您了解各种代表`SPSession`的情况。音频传递委托只有一项工作——接收音频数据。播放委托获取所有其他播放事件 - 当音频完成传递给音频传递委托等时。没有什么可以阻止一个类同时是两者，但在当前实现中，`SPPlaybackManager`是播放委托，它创建一个实例`SPCoreAudioController`作为音频交付代表。如果您修改`SPPlaybackManager`为拥有两个 Core Audio 控制器并交替使用哪一个作为音频交付委托，那么您应该是黄金。

# javascript - Firefox 上的事件对象

> ID：15857214
> 
> 赞同：4
> 
> 时间：2013-04-06T23:36:36.623
> 
> 标签：javascript, jquery, events, firefox, object

抱歉，这似乎很讨人喜欢......这应该就是为什么 firefox 没有像 Chrome 一样更改他们的代码以完全符合 Event 对象的原因。我已经完成了作业，尝试了 StackOverflow 上给出的几种解决方案，但似乎没有任何效果。我有这个代码：

```
function xpto(e) {
if( !e ) e = window.event;
  var x = e.target||e.srcElement;
alert(x);
    ........
} 
```

调用方式如下：

```
<svg id="graph-svg" onclick="xpto(event)" style="outline: none;" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> 
```

是的......这是一个 svg 元素，我试图点击它。我没有放完整的代码，因为它与问题无关。归根结底，

```
alert(x) 
```

在 Firefox 上总是以未定义的形式发出警报，并且像魅力一样在 Chrome 上工作。我可以在 Firefox 上抓取事件，但“x”总是未定义。

在 DOM 描述的 firefox 中，支持 Event 和 SVG。为了向后兼容，甚至使用“target”和“srcElement”属性定义了事件。

我在 Ubuntu 上使用 Firefox 20 ......有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-07T14:31:00.933

在 d'alar'cop 回复后，我查看了代码，发现在 firefox 中有效的参数不是“event”或“Event”而是“evt”...... Firebug 中的控制台显示了这一点：

```
 function onclick(evt) { xpto(event) } 
```

因此，我意识到处理程序是用“event”而不是原始参数“evt”调用的。然后当它落入处理程序时，“事件”将变为“空”......未定义。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-07T03:07:16.270

很多时候我看到在 HTML 代码中内联的事件处理程序，而不是依赖于更强大的[事件侦听](https://developer.mozilla.org/en-US/docs/DOM/EventTarget.addEventListener)器。

而不是使用`onclick`为什么不将侦听器附加到`SVG`元素？你可以试试这个：

```
var addListener = function (element, event, callback) {
    // We define a cross-browser function
    if (window.addEventListener) {
        // Mozilla/Webkit/Opera
        element.addEventListener(event, callback, false);
    } else {
        // IE
        element.attachEvent('on' + event, callback);
    }
};

// Then we attach the event listener to the SVG element
addListener(document.getElementById('graph-svg'), 'click', function (evt) {
    // Here you can manage the fired event
    alert(evt);
}); 
```

或者，使用 jQuery：

```
$('#graph-svg').on('click', function(evt){
    alert(evt);
}); 
```

你可以用这个[fiddle](http://jsfiddle.net/ragnarokkr/DtkMX/)试试（在 Ubuntu 12.10 上用 FF 20.0 和 Chrome 26 测试过）。

当然，内联处理程序并不总是邪恶的，但很多时候它们不是解决方案，恕我直言。

# java - Peg Solitaire 找不到回溯的解决方案

> ID：15857219
> 
> 赞同：0
> 
> 时间：2013-04-06T23:37:14.460
> 
> 标签：java, recursion, backtracking

我正在为 Java 中的 Peg Solitaire 游戏开发解决方案。但是，我的解决方案似乎无法解决游戏。

我正在使用“标准”版本，所以板子看起来像：

```
{2, 2, 1, 1, 1, 2, 2}
{2, 2, 1, 1, 1, 2, 2}
{1, 1, 1, 1, 1, 1, 1}
{1, 1, 1, 0, 1, 1, 1}
{1, 1, 1, 1, 1, 1, 1}
{2, 2, 1, 1, 1, 2, 2}
{2, 2, 1, 1, 1, 2, 2} 
```

0 是空的，1 是钉子，2 是空的

董事会的期望状态是

```
{2, 2, 0, 0, 0, 2, 2}
{2, 2, 0, 0, 0, 2, 2}
{0, 0, 0, 0, 0, 0, 0}
{0, 0, 0, 1, 0, 0, 0}
{0, 0, 0, 0, 0, 0, 0}
{2, 2, 0, 0, 0, 2, 2}
{2, 2, 0, 0, 0, 2, 2} 
```

我的 solve() 方法是这样工作的：

1.  `x,y`在 a 的位置上移动钉子`direction`（上、下、左或右）
2.  检查板子是否处于所需状态，如果是，则打印板子和所采取的动作并退出程序
3.  检查是否还有一个可以移动的钉子，如果没有则退出该功能
4.  找到第一个可以向一个或多个方向移动的钉子；为那个钉子和它的方向调用solve()。
5.  （如果我们到达这里，第 4 步产生了不希望的棋盘状态）撤消在第 4 步中进行的移动，并使用该挂钩可能进行的下一个可能移动（如果有）调用第 4 步。
6.  返回到步骤 4 以获取在步骤 4 中找到的挂钩之后的下一个可能挂钩。

我已经像这样实现了上述说明：

```
private void play(int xx, int yy, Direction direction) {
    board.move(xx, yy, direction);

    if (board.finished()) {
        board.printBoard();
        System.out.println(moves);
        System.exit(0);
    }

    if (board.noMoreMoves()) {
        return;
    }

    for (int y = 0; y < board.board.length; y++) {
        for (int x = 0; x < board.board[y].length; x++) {
            if (board.containsPeg(x, y)) {
                Direction[] moves = board.getMovesFor(x, y);

                for (Direction move : moves) {
                    if (move != null) {
                        this.moves++;
                        play(x, y, move);

                        if (move.equals(Direction.UP)) {
                            board.undoMove(x, y-2, move);
                        } else if (move.equals(Direction.DOWN)) {
                            board.undoMove(x, y+2, move);
                        } else if (move.equals(Direction.LEFT)) {
                            board.undoMove(x-2, y, move);
                        } else if (move.equals(Direction.RIGHT)) {
                            board.undoMove(x+2, y, move);
                        }
                    }
                }
            }
        }
    }

    return;
} 
```

但是，上述解决方案不会产生所需的电路板状态。我现在这个版本在 eclipse 中运行了一个多小时，没有任何结果。

我已经测试了方法 board.move(x, y, direction)、board.finished()、board.noMoreMoves()、board.containsPeg(x, y)、board.getMovesFor(x, y) 和 board.undoMove (x, y, direction) 是孤立的，它们似乎都按预期运行。

我在这里是否缺少一些东西，无论是在我的实现中还是在一般的递归/回溯中？我很确定该解决方案不需要进行超过**2 亿**次移动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:03:07.733

你需要的是一个调试策略。

使用将输出电路板状态的方法。还要写一个来保存你的电路板的表示，以及一个比较两种状态以查看它们是否相同的方法。

第一种方法失败后的输出，然后在回溯后的不同点，以确保回溯已经回溯到正确的轨道。

还要确保您不会多次跟踪同一个动作。

至于可能的移动次数，不要太确定。人们不会*先验地*认为，在国际象棋的前 10-20 步中，有数十亿种可能的步法，但确实存在。

# asp.net - asp.net 链接标记的语法错误

> ID：15857221
> 
> 赞同：0
> 
> 时间：2013-04-06T23:37:55.713
> 
> 标签：asp.net, css

我正在尝试从文件夹动态加载样式表，但目前它不起作用：

```
<head id="Head1" runat="server">
     <link  type="text/css" rel="styleSheet"  href="http://www.domain.com/users/'<%= UserNameVar%>'/styleSheet.css" />
</head> 
```

`UserNameVar`包含字符串数据。

编辑：这是我将其上传到服务器时的输出。但它没有加载

> ```
> <link type="text/css" rel="styleSheet" href="http://www.domain.com/users/&#39;&lt;%= UserNameVar%>&#39;/styleSheet.css" /></head> 
> ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T23:52:26.597

把所有`href`的价值都放在`<%=`和`%>`

试试这个：

```
<head id="Head1" runat="server">
     <link  type="text/css" rel="styleSheet"  href=<%= "http://www.domain.com/users/" + UserNameVar + "/styleSheet.css />" %>     
</head> 
```

# android - 为什么 Android 最近应用列表显示黑色或透明的屏幕截图？

> ID：15857226
> 
> 赞同：6
> 
> 时间：2013-04-06T23:38:50.680
> 
> 标签：android

为什么我最近的应用程序列表中的应用程序通常会出现空白或透明屏幕？这是主题问题还是最近应用列表中的错误？

![黑色的](https://i.stack.imgur.com/TvpHB.png)![透明的](https://i.stack.imgur.com/JTJEwl.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-07T00:27:31.257

我刚刚检查了自己，我的假设是，当应用程序在其 UI 线程中执行许多任务时，它会发生，因此 Activity 没有“完全创建”。在我的例子中，我打开了 facebook 和 twitter 应用程序并迅速切换到最近的应用程序模式。由于数据没有完全加载，Android 无法显示屏幕截图。Cyril Mottier 写了一篇关于应用初创公司以及如何处理这个非常具体的问题的好文章。你可以在[这里](http://cyrilmottier.com/2013/01/23/android-app-launching-made-gorgeous/)阅读。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-07T00:26:50.237

作为开发人员，您可以覆盖此功能，以便您的应用程序不会显示在最近的应用程序中，或者如果您愿意，您可以使用您选择的位图覆盖正在生成的缩略图。

如果您正在开发一个不需要泄漏数据的银行应用程序，或者您的用户不希望他们的孩子或他们的妻子意外看到其缩略图的 X 级应用程序，这将派上用场。

话虽如此，我刚刚检查了我的 Galaxy Nexus（带有库存的 Android 4.2），并且 chrome 浏览器确实向我显示了我浏览过的最后一页`Recent Applications`的缩略图（即使缩略图来自我浏览时隐身模式）。

所以我想说，在你的情况下，它可能是一个错误：可能是生成缩略图的时间问题，或者也可能是缓存存储限制问题，或者可能是其他一些未知的错误。我不确定你为什么认为这可能是一个主题问题，但我想这也不能排除。

# xcode - Storyboard UIImagePicker 覆盖 UIButton 不会关闭预览

> ID：15857228
> 
> 赞同：0
> 
> 时间：2013-04-06T23:38:54.340
> 
> 标签：xcode, storyboard, uiimagepickercontroller

**更新 2**

`viewDidAppear`执行两次，一次之前和一次之后，覆盖按钮被触摸。解决方法是添加一个条件`viewDidAppear`，将控制权返回给调用类吗？如果是这样，我将不胜感激建议。或者也许执行两次这一事实`viewDidAppear`暗示了另一种修复方法？

**更新 2**

**更新 1**

也许问题是我的用法，`viewDidAppear`如下`viewDidLoad`所示。有人可以帮忙吗？

```
- (void)viewDidAppear:(BOOL)animated
{

    self.overlayViewController = [[BSsetupOverlayViewController alloc] initWithNibName:@"BSsetupOverlayViewController" bundle:nil] ;

    // as a delegate we will be notified when pictures are taken and when to dismiss the image picker
    self.overlayViewController.delegate = self;

    [self showImagePicker:UIImagePickerControllerSourceTypeCamera];

}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.
} 
```

**更新 1**

**更新 0**

也许我不清楚不起作用的版本和起作用的版本之间的区别在于 Storyboard 用于不起作用的版本。为什么`done`按钮在没有 Storyboard 的情况下可以工作，但在覆盖层中只涉及一个 nib 时却不行？

**更新 0**

[此处的 UIButton](https://stackoverflow.com/questions/15623754/camera-overlay-picture/)能够关闭相机预览，但在我的实际应用中，点击 UIButton 只会暂时关闭预览和覆盖屏幕。预览立即返回。我认为问题在于我实现 UIImagePicker 的委托的方式，但我可能错了。

[我在`setup.zip`这里](http://schott.selfip.net/~brian/)创建了一个包含不良行为的示例项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:39:00.020

**正如我在问题的更新 2中提到的那样，**[我将这个问题带到了北亚特兰大 iOS 聚会](http://www.meetup.com/North-Atlanta-iOS-Developers-Group/)上，并建议条件子句可能会解决问题。`BSsetupViewController`Meetup 的创始人 Kurt Niemi 通过编辑课程快速展示了如何做到这一点。

首先，他在界面中添加了一个布尔属性。

```
@property (nonatomic, assign) BOOL alreadyDisplayed; 
```

其次，他在`viewDidAppear`方法中添加了一个子句。

```
if (self.alreadyDisplayed)
{
    self.alreadyDisplayed = FALSE;
    [self dismissViewControllerAnimated:NO completion:nil];
    return;

}

self.alreadyDisplayed = TRUE; 
```

最后，他在该方法中添加了一个稍微不必要的子句`viewDidLoad`。

```
self.alreadyDisplayed = FALSE; 
```

我仍然希望这些步骤是不必要的，但它们似乎有效。

# c++ - 通过循环另一个用于搜索文件的函数来打印文件中的信息 - C++

> ID：15857231
> 
> 赞同：1
> 
> 时间：2013-04-06T23:39:59.807
> 
> 标签：c++, file-io, printing, addressbook

我有这个功能可以扫描我的文件并根据您选择查看的记录打印出预先指定的记录：

```
void addressBook::showRecord(int pickNum) {
  PEOPLE2 p;
  ifstream indata("vectortest.dat", ios::binary);
  if(!indata) {
    cout << "Error opening file for reading " << endl;
    exit(0);
  }
  indata.seekg(pickNum * sizeof(PEOPLE2));
  indata.read(reinterpret_cast <char*> (&p), sizeof(PEOPLE2));
  cout << p.fName2 << " " << p.lName2 << " " << p.Address2 << " " << endl;
} 
```

因此，您只需将 showRecord 弹出到 main 中，然后选择要打印的名称。假设我想查看存储的第二个名称，我会输入

```
newBook->showRecord(1); 
```

一切都很好，花花公子，而且效果很好，但是如果我想走得更远怎么办。因此，我创建了另一个函数，该函数可以使用 showRecord 打印出地址簿中已存储到我的文件中的所有姓名。我试过这个：

```
void addressBook::showAll() {
  ifstream indata("vectortest.dat", ios::binary);
  for(int i = 0; i < indata.end; i++) {
    showRecord(i);
  }
} 
```

它有效，但它只打印出从以前的作业中硬编码到我的 PERSON 结构中的东西：

```
addressBook *newBook = addressBook::newbookInst(); 

PERSON me[] = {{"First" , "Last", "ADDRESS"}, {"John", "Doe", "1234"}}; 
                    newBook->addPerson(me[1]); 

                    newBook->addPerson(me[0]); 
```

这很奇怪，因为当我进入文件本身时，我可以看到所有添加的名称。

那么我该如何使用它才能真正打印出文件中的所有内容，而不仅仅是永久存储的两个条目？

这是我的 addressbook.h 和 addressbook.cpp 代码，以防您需要更好地了解正在发生的事情......

\\addressbook.h////////

```
#ifndef _ADDRESSBOOK
#define _ADDRESSBOOK
#include <fstream>
#include <vector>
#include<string>
using std::string;
#include <iostream>
using namespace std;

using std::istream;
using std::ostream;
namespace CJ
{
const int MAXADDRESS =25;

struct PERSON
{
    string fName;
    string lName;
    string Address;
};
struct PEOPLE2
{
    char fName2[25];
    char lName2[25];
    char Address2[25];
};

class addressBook
{
private:

    vector<PERSON> people;

    int head;
    int tail;

public:

    addressBook();

    addressBook(const PERSON &p);
    addressBook(const PERSON p[], int size);
    addressBook(char *fName, char *lName, char *address);
    bool addPerson(const PERSON &p);
    bool sortcomp(const PERSON& p1, const PERSON& p2);
    bool getPerson(PERSON &p);
    bool findPerson(const string& lastName, PERSON& p);
    bool findPerson(const string& lastName, const string& firstName, PERSON& p);
    void bubbleSort(int *array,int length);
    void printBook();
    void sort();
    void waitKey();
    static addressBook *newbookInst();
    static addressBook *tempNew;
    static PERSON *p();
    static PERSON *temPerson;
    void showRecord(int pickNum);
    void writeRecord();
    void showAll();

    friend ostream &operator << (ostream &, addressBook &);
    addressBook operator =(const string& str);
    addressBook &operator +=(const PERSON &p); 
    addressBook operator [](int x); 

};
}
#endif 
```

\\addressbook.cpp/////

```
#include <iostream>
#include <fstream>
#include <cstdlib>
#include <conio.h>
#include <string>
using std::string;
#include "addressBook.h"
#include "menu.h"
namespace CJ
{
addressBook::addressBook()
    : head(0), tail(-1)
{

}

addressBook::addressBook(const PERSON &p)
    : head(0), tail(-1)
{
    addPerson(p);
}

addressBook::addressBook(const PERSON p[], int size)
    : head(0), tail(-1)
{
    for(int i = 0; i < size; i++)
        addPerson(p[i]);

}

addressBook::addressBook(char *fName, char *lName, char *Address)
    : head(0), tail(-1)
{
    PERSON tmp;
    tmp.fName = fName;
    tmp.lName = lName;
    tmp.Address = Address;
    addPerson(tmp);
}

bool addressBook::addPerson(const PERSON &p)
{
    people.push_back(p);

    if(tail == -1)
        tail++;
    return true; 
}

bool addressBook::getPerson(PERSON &p)
{
    if(tail >=0)
    {
        if(tail >= people.size())
            tail = 0;
        p = people[tail];
        tail++;
        return true;
    }
    return false;
}
bool addressBook::findPerson(const string &lastName, PERSON &p)
{
    for(size_t i = 0; i < people.size(); i++)
    {
        if(people[i].lName == lastName)
        {
            PERSON *p = addressBook::p();
            *p = people[i];
            return true;
        }
    }
    return false;
}
bool addressBook::findPerson(const string &lastName, const string &firstName, PERSON &p)
{
    for(size_t i = 0; i < people.size(); i++)
    {
        if(people[i].lName == lastName && people[i].fName == firstName)
        {
            PERSON *p = addressBook::p();
            *p = people[i];
            return true;
        }
    }
    return false;
}

void addressBook::printBook()
{
    for(size_t i = 0; i < people.size(); i++)
    {       
        std::cout << people[i].fName << "\t" << people[i].lName << "\t" << people[i].Address << std::endl;
    }
}

bool addressBook::sortcomp(const PERSON& p1, const PERSON& p2)
{
    int result = (p1.lName.compare(p2.lName)) ;
    if ( result > 0 )
        return true ;
    if ( result < 0 )
        return false ;
    return (p1.fName.compare(p2.fName)) > 0 ;
}

void addressBook::sort() 
{
    bool didSwap ;
    do
    {
        didSwap = false ;

        for ( unsigned i=1; i<people.size(); ++i )
            if ( sortcomp(people[i-1], people[i]) )
            {
                std::swap(people[i-1], people[i]) ;
                didSwap = true ;
            }

    } while ( didSwap ) ;
}

addressBook &addressBook::operator +=(const PERSON &p)
{
    addPerson(p);
    return *this;
};

addressBook addressBook::operator [](int x)
{
    return people[x];
};

ostream &operator << (ostream &output, addressBook &ab)
{
    PERSON tmp;
    ab.getPerson(tmp);
    output << tmp.fName << " " << tmp.lName << " " << tmp.Address << endl;
    return output;
}

addressBook * addressBook::tempNew = NULL;
addressBook *addressBook::newbookInst()
{
    if(tempNew == NULL)
    {
        tempNew = new addressBook;
    }
    return tempNew;
}

PERSON * addressBook::temPerson = NULL;
PERSON *addressBook::p()
{
    if(temPerson == NULL)
    {
        temPerson = new PERSON;
    }
    return temPerson;
}
bool status;
char lName[50];
char fName[50];

void addressBook::writeRecord()
{

PEOPLE2 temp;
ofstream outFile("vectortest.dat", ios::app);
    if(!outFile)
    {
        cout << "Error opening file for writing " << endl;
        return;
    }

        for (vector<PERSON>::iterator iter = people.begin(), end = people.end(); iter != end; ++iter)
        {
        strncpy(temp.fName2, iter->fName.c_str(), 25);
        strncpy(temp.lName2, iter->lName.c_str(), 25);
        strncpy(temp.Address2, iter->Address.c_str(), 25);
        outFile.write(reinterpret_cast<const char *>(&temp), sizeof(PEOPLE2));
        }       
    outFile.close();
}

void addressBook::showRecord(int pickNum)
{
PEOPLE2 p;

ifstream indata("vectortest.dat", ios::binary);
    if(!indata)
    {
        cout << "Error opening file for reading " << endl;
        exit(0);
    }

    indata.seekg(pickNum * sizeof(PEOPLE2));
    indata.read(reinterpret_cast<char *>(&p), sizeof(PEOPLE2));
    cout << p.fName2 << " " << p.lName2 << " " << p.Address2 << " " << endl;

    indata.close();

}

void addressBook::showAll()
{
ifstream indata("vectortest.dat", ios::binary);

for(int i = 0; i  < indata.end; i ++)
{
    showRecord(i);
}

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T07:45:02.210

我真的不太了解您计划如何使用您的地址簿类的上下文。但是我所做的是将你所拥有的基本结构重新加工成更惯用的 C++。这应该有望帮助指导您在本课程中的未来工作。您遇到问题的文件读取问题已修复。

```
#include <iostream>
#include <iterator>
#include <fstream>
#include <cstdlib>
#include <conio.h>
#include <string>
#include <vector>
#include <algorithm>

const int MAXADDRESS = 25;

struct PEOPLE2
{
    char fName2[25];
    char lName2[25];
    char Address2[25];
};

struct PERSON
{
    PERSON()
    {}
    PERSON(PEOPLE2 p) 
        : fName(p.fName2), lName(p.lName2), Address(p.Address2)
    {}
    PERSON(const std::string& first, const std::string& last, const std::string& add)
        : fName(first), lName(last), Address(add)
    {}
    std::string fName;
    std::string lName;
    std::string Address;
};
// required for std::sort
bool operator< (const PERSON &lhs, const PERSON &rhs)
{
    int result = (lhs.lName.compare(rhs.lName));
    if(result == 0)
        return lhs.fName < rhs.fName;
    return result < 0;
}
// required for os << people
std::ostream& operator<< (std::ostream& os, const PERSON& rhs)
{
    os << rhs.fName << " " << rhs.lName << " " << rhs.Address;
    return os;
}

class addressBook
{
private:
    std::vector<PERSON> people;

public:

    addressBook()
    { }

    addressBook(const PERSON &p)
    {
        addPerson(p);
    }

    template<typename IT>
    addressBook(IT begin, IT end)
    {
        std::copy(begin, end, std::back_inserter(people));
    }

    addressBook(char *fName, char *lName, char *address)
    {
        PERSON tmp;
        tmp.fName = fName;
        tmp.lName = lName;
        tmp.Address = address;
        addPerson(tmp);
    }

    addressBook(const std::string& fileName)
    {
        std::ifstream indata(fileName, std::ios::binary);

        PEOPLE2 p;
        while(true)
        {
            indata.read(reinterpret_cast<char*>(&p), sizeof(PEOPLE2));
            if(indata.fail())
                break;
            people.push_back(p);
        }
    }

    void addPerson(const PERSON &p)
    {
        people.push_back(p);
    }

    bool findPerson(const std::string& lastName, PERSON& p)
    {
        std::find_if(std::begin(people), std::end(people), [&](const PERSON& in)->bool
        {
            if(lastName == in.lName)
            {
                p = in;
                return true;
            }
            return false;
        });
    }

    bool findPerson(const std::string& lastName, const std::string& firstName, PERSON& p)
    {
        std::find_if(std::begin(people), std::end(people), [&](const PERSON& in)->bool
        {
            if(lastName == in.lName && firstName == in.fName)
            {
                p = in;
                return true;
            }
            return false;
        });
    }

    void printBook()
    {
        std::for_each(std::begin(people), std::end(people), [](const PERSON& p)
        {       
            std::cout << p.fName << "\t" << p.lName << "\t" << p.Address << std::endl;
        });
    }

    void sort()
    {
        std::sort(std::begin(people),std::end(people));
    }

    void waitKey();

    void showRecord(int pickNum)
    {
        std::cout << people[pickNum] << std::endl;
    }

    void writeRecord(const std::string& fileName)
    {

        PEOPLE2 temp;
        std::ofstream outFile(fileName, std::ios::app);
        if(!outFile)
        {
            std::cout << "Error opening file for writing " << std::endl;
            return;
        }

        for(auto iter = people.begin(), end = people.end(); iter != end; ++iter)
        {
            strncpy(temp.fName2, iter->fName.c_str(), 25);
            strncpy(temp.lName2, iter->lName.c_str(), 25);
            strncpy(temp.Address2, iter->Address.c_str(), 25);
            outFile.write(reinterpret_cast<const char *>(&temp), sizeof(PEOPLE2));
        }       
    }

    void showAll()
    {
        std::for_each(std::begin(people), std::end(people), [](const PERSON& in)
        {
                std::cout << in << std::endl;
        });
    }

    friend std::ostream &operator << (std::ostream &output, addressBook &ab)
    {
        std::for_each(std::begin(ab.people), std::end(ab.people), [&](const PERSON& in)
        {
            output << in << "\n";
        });
        return output;
    }

    addressBook &operator +=(const PERSON &p)
    {
        addPerson(p);
        return *this;
    };

    PERSON operator [](int x)
    {
        return people[x];
    };

};

std::string fileName = "c:\\temp\\test.rec";
int main()
{
    addressBook ab(fileName);
    ab.sort();
    ab.showAll();

    //addressBook ab;
    //ab.addPerson(PERSON("Mary", "Smith", "1 West Street"));
    //ab.addPerson(PERSON("Joe", "Brown", "2 East Street"));
    //ab.addPerson(PERSON("Harry", "Cooper", "3 South Street"));
    //ab.writeRecord(fileName);
} 
```

# javascript - 单击时交换多个图像，但一次交换一个

> ID：15857232
> 
> 赞同：2
> 
> 时间：2013-04-06T23:40:31.693
> 
> 标签：javascript, jquery

我一直在寻找几天来解决这个问题。

我有/正在尝试做的是在我的主页上显示一些类别。每个类别都可以在点击时“折叠”。到目前为止，折叠部分工作正常，但不是折叠图标的图像交换。

下面的代码我更改了图像并将其交换回来，但无论我单击哪个，它们都只会更改列出的第一个。

head标签中的js：

```
<script type="text/JavaScript">
var q=0;
function swapImage(){
if(q==0){
document.getElementById("tcat_collapse").setAttribute('src','images/collapsecat.gif');
q++;
}
else{
document.getElementById("tcat_collapse").setAttribute('src','images/expandcat.gif');
q--;
}
}
</script> 
```

我正在交换的图像标签：

```
while ($query2->fetch()) {
echo "<tbody><tr><td class='category' colspan='5'>";
echo "<a style=\"float: right\" href=\"#\" onclick=\"toggleItem('catcollapse')\">";
echo "<img class='collapsecat' src='images/collapsecat.gif' border='0' onclick='swapImage();' /></a>"; 
```

我知道这与 getElementByID 部分有关。

这个网站的大部分内容都是用 PHP 完成的，你可以看到它在一个 while 循环中，所以我有几个使用这个折叠功能同时显示。而且我知道 javascript 看起来很难看，但正如我所说，它可以工作，但只有 1 个 ID。

那么，我能做些什么来单独实现每个类别的崩溃，而不必单独编码每个类别呢？我可以传递一个 php 变量作为该脚本的元素 ID 以进行相应更改吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:40:49.463

找到了解决方案。效果非常好：

```
<script type="text/JavaScript">

var namesVec = new Array("collapsecat.gif", "expandcat.gif");
var root ='images/';
function swapImg(ima){
nr = ima.getAttribute('src').split('/');
nr = nr[nr.length-1]

if(nr==namesVec[0]){ima.setAttribute('src',root+namesVec[1]);}
else{ima.setAttribute('src',root+namesVec[0]);}

}
</script> 
```

代码看起来也更好:)

```
while ($query2->fetch()) {
    echo "<tbody><tr><td class='tcat' colspan='5'>";
    echo "<a style=\"float: right\" href=\"#\" onclick=\"toggleItem('collapseobj_forumbit_" . $catid . "')\">";
    echo "<img class='tcat_collapse' src='images/collapsecat.gif' border='0' onclick='swapImg(this)' /></a>"; 
```

由于“swapImg(this)”，允许单独交换多个图像，无论 ID 是什么。

# arduino - 产生带中断的 PWM

> ID：15857235
> 
> 赞同：1
> 
> 时间：2013-04-06T23:41:03.580
> 
> 标签：arduino, microcontroller, pwm

我正在使用[Arduino Mega 2560](http://arduino.cc/en/Main/arduinoBoardMega2560)。我目前遇到的问题是我使用的伺服电机在空闲状态下会发出轻微的噪音。这是因为它不是一个纯粹的信号。如何为微控制器生成带有中断的 PWM？

每次使用中断都会将计数器放在完全相同的位置吗？如果没有，我该如何处理高分辨率伺服？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T08:21:19.167

**如果您确实需要大量 SoftPWM 通道而没有大量 CPU 开销，则可以使用**二进制代码调制。**漂亮而简单的技术。**

 ***   [http://www.batsocks.co.uk/readme/art_bcm_3.htm](http://www.batsocks.co.uk/readme/art_bcm_3.htm)
*   [https://github.com/zookzook/binary-code-modulation](https://github.com/zookzook/binary-code-modulation)

然而，一些专门的伺服库可能是一个更好的解决方案......**

# c++ - 英特尔 TBB concurrent_queue 如何工作？它是否实现了细粒度的并行性？

> ID：15857237
> 
> 赞同：2
> 
> 时间：2013-04-06T23:41:21.367
> 
> 标签：c++, multithreading, parallel-processing, intel, tbb

我是英特尔 TBB 的新手。我正在使用 concurrent_queue 以在我的项目中实现细粒度的并行性。我有几个疑问。这就是我正在实施的方式。

```
 thread_fun(arguments) {
      while(concurrent_queue.try_pop(v))
          operation on v;  //each thread executes its own operation(seperate v for each thread)
   }
   main() {
      for(..)
         concurrent_queue.push(); //fill the queue
      _beginthreadex(..); //create 8 win32 threads and pass concurrent_queue as an argument
   } 
```

1.  我明确提到了线程数。我读到 TBB 将根据处理器核心数创建线程。我怎样才能做到这一点？这样我就不需要使用 _beginthreadex 函数显式创建线程了吗？

2.  我是否通过使用 concurrent_queue 来实现细粒度的并行性？

3.  任务级并行性是什么意思？您如何使用 intel tbb 实现任务级并行性？我正在从队列中弹出元素。弹出操作是否被视为一项任务？这意味着，所有弹出操作都被视为不同的任务。我一次用 8 个线程弹出 8 个元素。这意味着，我正在实现任务级别的并行性。我对么？

4.  如果我将四核处理器上的线程数增加到 32（支持 8 个线程），concurrent_queue 是如何工作的？队列上只有8个线程并发执行还是总共32个线程并发执行？

请帮我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-07T02:33:14.600

TBB 有很多部分。Concurrent_queue 只是一个可以被多个线程安全访问的队列。并发队列不直接属于 TBB 的“细粒度并行”或“任务并行”部分。（虽然这些部分可以*使用*concurrent_queue。）

1.  您可以使用[`tbb::parallel_for`](http://threadingbuildingblocks.org/docs/help/reference/algorithms/parallel_for_func.htm). 请参阅该页面上的示例或[此堆栈溢出问题](https://stackoverflow.com/questions/14495829/tbb-parallel-for-example-c-without-lambda)。当您使用 parallel_for 时，tbb 将负责所有线程的创建，并且还将进行动态负载平衡。

2.  Concurrent_queue 根本不创建任何并行性：它只是允许多个线程安全（并且相对有效地）访问同一个队列。它确保没有竞争条件。在您的示例中，您获得的并发线程数不超过 8 个。实际上：concurrent_queue 正在*序列化*对队列的访问。您的并行性来自您的“对 v 的操作”。对 concurrent_queue 的访问应该被认为是开销。

3.  您在示例中实现了一种基本的任务级并行性。我[从@Mitch Wheat 的 Stack Overflow 答案中找到了对任务和线程之间区别的精彩描述](https://stackoverflow.com/questions/4130194/what-is-the-difference-between-task-and-thread)：

    > 任务是你想做的事情。
    > 
    > 线程可能是执行该任务的许多工作人员之一。

    从技术上讲：任务不能相互阻塞等待。您的任务是您正在执行的“对 v 的操作”。您正在实现任务级并行性。使用类似的东西的优点`tbb::parallel_for`是它（a）自动为您启动线程，（b）尝试自动选择最适合您用户系统上的内核数量的线程数，（c）经过优化以减少将任务分配给线程的开销，并且 (d) 如果您的任务操作长度不相等，也可以进行一些非常酷的动态负载平衡。

4.  让我们区分*并发*和*并行*。你的机器有 8 个硬件线程。因此，您的最大 cpu 并行度为 8。我会使用术语*并发*来表示“如果您拥有一个具有无限数量内核的神奇处理器，您可以实现的最大并行度”。通常，创建的线程数多于内核数的主要原因是您的线程正在执行大量长延迟 i/o 操作。操作系统可以切换到一个额外的线程来做 cpu 工作，而另一个线程正在等待磁盘/网络。

# jakarta-ee - 在 Tomcat 7 中使用 Web 套接字

> ID：15857239
> 
> 赞同：6
> 
> 时间：2013-04-06T23:41:38.197
> 
> 标签：jakarta-ee, maven, websocket, tomcat7

我想使用 web socket，我开始寻找使用 tomcat API 的方法。我目前正在使用 Tomcat 7.0.37。

我尝试按照 tomcat[文档](http://svn.apache.org/viewvc/tomcat/tc7.0.x/trunk/webapps/examples/WEB-INF/classes/websocket/chat/ChatWebSocketServlet.java?revision=1354477&view=markup)中的示例代码进行操作。

我也在项目中使用 maven，所以我将它添加到我的*pom.xml*中：

```
<dependency>
    <groupId>org.apache.tomcat</groupId>
    <artifactId>tomcat-catalina</artifactId>
    <version>7.0.39</version>
    <scope>provided</scope>
</dependency> 
```

首先很奇怪，我在 Eclipse 中收到一条错误消息：

```
private class MyMessageInbound extends MessageInbound 
```

错误消息是“ *MyMessageInbound 类型的层次结构不一致*”，但我仍然能够编译和启动 webapp。

我还在*web.xml*中添加了如下配置：

```
<servlet>
    <servlet-name>wsChat</servlet-name>
    <servlet-class>websocket.chat.ChatWebSocketServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>wsChat</servlet-name>
    <url-pattern>/websocket/chat</url-pattern>
</servlet-mapping> 
```

所以，我可以启动 web 应用程序，但是当我进入聊天页面时，我在聊天板上收到错误消息“*信息：WebSocket 已关闭。* ”。Tomcat日志给我以下消息：

```
SEVERE: Servlet.service() for servlet [wsChat] in context with path [/websocket-tuto] threw exception [L''exécution de la servlet a lancé une exception] with root cause
java.lang.NoSuchMethodError: websocket.chat.ChatWebSocketServlet$MyMessageInbound.<init>(Lwebsocket/chat/ChatWebSocketServlet;Luwebsocket/chat/ChatWebSocketServlet$MyMessageInbound;)V
at websocket.chat.ChatWebSocketServlet.createWebSocketInbound(ChatWebSocketServlet.java:34)
at org.apache.catalina.websocket.WebSocketServlet.doGet(WebSocketServlet.java:121)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:936)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)
at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
at java.lang.Thread.run(Unknown Source) 
```

我认为这里唯一缺少的信息是[聊天页面](http://svn.apache.org/viewvc/tomcat/tc7.0.x/trunk/webapps/examples/websocket/chat.html?revision=1351055&view=markup)的来源。

任何人都看到我做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-08T09:34:46.927

我解决了这个问题！

我试图在命令行上用 Maven 打包项目，并得到这个错误：

```
[ERROR] class file for org.apache.coyote.http11.upgrade.UpgradeInbound not found 
```

由此，我刚刚将以下内容添加到*pom.xml*：

```
<dependency>
    <groupId>org.apache.tomcat</groupId>
    <artifactId>tomcat-coyote</artifactId>
    <version>7.0.39</version>
    <scope>provided</scope>
</dependency> 
```

我希望这将帮助其他人解决同样的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T09:39:46.283

您继承的类 MessageInbound 是否实现了 Servlet 接口？你能提供你的 ChatWebSocketServlet 或 MessageInbound 类的 doGet 实现吗？对不起，您的信息完全不完整...

# php - 如何为获取帖子的这个函数创建一个特定的循环？

> ID：15857241
> 
> 赞同：0
> 
> 时间：2013-04-06T23:41:44.707
> 
> 标签：php, javascript, jquery, html, wordpress

我正在做一些 WordPress 主题。我有一个#novelsslider div。在#novels 内部，我使用此代码获取“小说”类别中的最新三个帖子，在 html div 内部，我使用一些 php 函数获取最新的 3 个帖子并加载 html 3 次浮动到左侧构建一个滑块：

```
<!-- slider -->       
<div id="novelsslider" class="slider">

<? $novels = get_option('of_novels') ?>
<?php query_posts('category_name=$novels&posts_per_page=3'); ?>
<?php while (have_posts()) : the_post(); ?>
    <div class="sliderunit">
        <?php the_post_thumbnail(); ?>
        <div class="novelsslidertitle">
            <div class="arrow-left"></div>
                <a href="<?php the_permalink(); ?>">
                <img class="cross" src="<?php bloginfo('stylesheet_directory'); ?>/images/cross.png"/>
                </a>
                <a href="<?php the_permalink(); ?>">
                    <?php the_title(); ?>
                </a>        
            </div>
        </div>
        <?php endwhile;?>

        <div id="novelsslidebars">
            <input type="submit" value="" class="slidebars" id="novelsslidebtnleft">
            <input type="submit" value="" class="slidebars" id="novelsslidebtnmiddle">
            <input type="submit" value="" class="slidebars" id="novelsslidebtnright">
        </div>

    </div> 
<!-- End novelsslider --> 
```

ow 我有一些箭头.. 我希望它们在单击以获取一组以前的 3 个帖子并加载它们时，我该如何做这样的循环？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-16T10:18:03.163

为此，您可以采用以下任何一种方法：

1-如果您的帖子数量不多，那么您可以预加载它们并存储在默认隐藏的某个容器中，当您单击下一个/上一个按钮时会出现，例如内容滑块，但这是一种不好的方法，而不是推荐的。

2- 使用 AJAX 加载其余帖子，这是一个很好的方法，并且将是纯动态的。查看以下链接以获得想法：

[http://wp.tutsplus.com/tutorials/getting-loopy-ajax-powered-loops-with-jquery-and-wordpress/](http://wp.tutsplus.com/tutorials/getting-loopy-ajax-powered-loops-with-jquery-and-wordpress/)

[Wordpress - 如何通过 AJAX 获取更多帖子？](https://stackoverflow.com/questions/11887760/wordpress-how-can-i-fetch-more-posts-via-ajax)

# ruby-on-rails - onclick 获取正确的数据

> ID：15857246
> 
> 赞同：0
> 
> 时间：2013-04-06T23:42:32.780
> 
> 标签：ruby-on-rails

我有一个名为任务的表的索引视图。在每一行上，我希望用户能够单击编辑或添加附件（添加附件）。

这是代码：

```
 <% @workorder.tasks.each do |task| %>
  <tr>
        <td><%= task.position %></td>
        <td><strong><%= link_to task.taskname, task_path(task) %></strong></td>
        <td>
          <a rel="popover" data-content="<%= task.longdesc %>" data-original-title="Description:"><img src='/images/find.ico' width='20' height='20'></a>
        </td>
        <td><%= task.employee.try(:employee_full_name) %></td>
        <td><%= task.taskstatus.try(:statuscode) %></td>
        <td><%= task.attachments.count %></td>
        <td>
          <a href="#" class="answer" data-type="select" data-pk="1" data-resource="task" data-source="/ratings" data-name="rating_id" data-url="/tasks/<%= task.id %>" data-original-title="Select Rating">
            <% if task.rating_id != nil %>
                <%= textarea_format(task.rating.ratingname) %>
            <% end %>
          </a>
        </td>
        <% if current_user.admin == true %>
            <td><%= link_to 'Edit', edit_task_path(task), :class => 'btn btn-mini btn-success' %></td>
            <td><%= link_to 'Add Attach', new_attachment_path, :class => 'btn btn-mini btn-primary', :onclick =>  flash[:task_id] = task.id %></td>
        <% end %>
  </tr> 
```

添加附件链接到用于添加附件的页面。为了让它正确地附加到特定的任务上，我使用 flash 来继承 task.id。

但是，onclick 总是传递最后一个 task.id 而不是包含该行的 task.id 的每个按钮。

知道我怎么能做到这一点吗？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:37:59.597

我认为您的“添加附件”链接如下所示：

```
 <td>
    <%= link_to 'Add Attach', 
        new_attachment_path(task.id),
       :class => 'btn btn-mini btn-primary'
    %> 
  </td> 
```

这假设您有一个类似于以下内容的路由条目：

```
match "tasks/:id/add_attach" => "tasks#add_attach" , :as=>"new_attachment" 
```

然后在你的 tasks_controller.rb 中：

```
def add_attach
  @task = Task.find(params[:id])
  # I don't know what goes here,  not enough code posted
  @task.save
end 
```

# python - 在安装 Django 期间，为什么我不断收到 ImportError: No module named django？

> ID：15857247
> 
> 赞同：2
> 
> 时间：2013-04-06T23:42:33.063
> 
> 标签：python, django, macos, installation

我只是想使用 django 获得一个“hello world”。我已经将 django 下载到我的桌​​面上，并且我的应用程序文件夹中有带有 Idle 的 python。我已按照[https://www.djangoproject.com/download/](https://www.djangoproject.com/download/)上的说明进行操作，但是当我尝试`import django`空闲时，我得到了`ImportError: No module named django`

我环顾四周并尝试`sys.path`了哪些产量`['', '/Users/nicholastzikas/Documents', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/setuptools-0.6c11-py2.7.egg', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-scriptpackages', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload', '/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages']`

我也见过`PYTHONPATH`几次提到，但我不知道如何使用它。任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:32:04.560

可能安装 django 的路径不在您的`sys.path`. 通常它应该在站点包内。您可以尝试以下方法：

1) 搜索系统上安装 django 的目录。

2）一旦找到它，您可以快速测试是否是问题所在，在IDLE中添加路径，`sys.path.append('/path/to/django/dir')`然后`import django`重试。

3.a）如果可行，您可以手动将路径移动到`'/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages'`例如。

3.b）如果这不起作用，那么可能是 django 文件已损坏（尝试再次安装）或者您安装的 python 和 django 的版本不匹配？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T00:28:12.130

两个建议。首先，如果您在安装 django 后还没有重新启动 IDLE，请尝试退出 IDLE (Command-Q) 并重新启动它。如果这没有帮助，很可能是您无意中将 Django 安装到了另一个 Python 实例，可能是 Apple 提供的系统 Python 之一。再试一次：然后再次退出 IDLE，从一个新的终端 shell 窗口，再次安装 Django，但要确保你使用`/usr/local/bin/python2.7`的是`python`.

# mysql - 没有使用表？

> ID：15857251
> 
> 赞同：-1
> 
> 时间：2013-04-06T23:43:34.853
> 
> 标签：mysql, sql, wamp

我已经使用这段代码一段时间了，现在，经过一些修补，我想我终于让它工作了，然后它给了我这个错误：

> 错误号：1096 未
> 使用表
> SELECT *

这是代码

```
SELECT start.*, posts.did, COUNT(posts.pid)
                            FROM akia_starting_posts AS start
                            JOIN posts
                                ON posts.did = start.did
                            JOIN akia_users AS users
                                ON users.username = start.username 
```

我很确定`*`我`start`正在被使用，所以它在说什么？它不可能是文件中的任何其他代码，因为当我取出这段代码时，它就开始工作了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:35:57.140

尝试在上面有单词 start 的 sql 字符串上添加反引号。首先尝试使用有问题的一个表。

```
SELECT 'start.*' FROM akia_starting_posts as 'start' 
```

如果它有效，那么您可以将它合并到完整的连接中，就像您发布的带有使用的效果一样。

# ruby-on-rails - Rails App 在本地运行，仅在 Heroku 部署后部分运行

> ID：15857252
> 
> 赞同：0
> 
> 时间：2013-04-06T23:43:34.930
> 
> 标签：ruby-on-rails, heroku

我有一个在本地运行良好的 Rails 应用程序，但是一旦我部署到 heroku，一个视图，其中包含应用程序的核心，只是说“我们很抱歉，但出了点问题。”

根据 Heroku 日志，它似乎无法识别模型和控制器名称的“地点”。

我的 gemfile 有用于生产的 PG 和用于开发的 SQLite3。我似乎找不到如何解决它。以下是日志：

```
2013-04-06T14:42:51+00:00 app[web.1]: Started GET "/help" for 72.229.188.61 at 2013-04-06 14:42:51     +0000
2013-04-06T14:42:51+00:00 app[web.1]: Processing by PlacesController#index as HTML
2013-04-06T14:42:51+00:00 app[web.1]: ActiveRecord::StatementInvalid (PG::Error: ERROR:  relation "places" does not exist
2013-04-06T14:42:51+00:00 app[web.1]:                      pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod
2013-04-06T14:42:51+00:00 app[web.1]: Completed 500 Internal Server Error in 215ms
2013-04-06T14:42:51+00:00 app[web.1]: LINE 5:              WHERE a.attrelid = '"places"'::regclass
2013-04-06T14:42:51+00:00 app[web.1]: :             SELECT a.attname, format_type(a.atttypid, a.atttypmod),
2013-04-06T14:42:51+00:00 app[web.1]:              WHERE a.attrelid = '"places"'::regclass
2013-04-06T14:42:51+00:00 app[web.1]: 
2013-04-06T14:42:51+00:00 app[web.1]: 
2013-04-06T14:42:51+00:00 app[web.1]: Started GET "/help" for 72.229.188.61 at 2013-04-06 14:42:51 +0000
2013-04-06T14:42:51+00:00 app[web.1]:               FROM pg_attribute a LEFT JOIN pg_attrdef d
2013-04-06T14:42:51+00:00 app[web.1]:                 ON a.attrelid = d.adrelid AND a.attnum = d.adnum
2013-04-06T14:42:51+00:00 app[web.1]: 
2013-04-06T14:42:51+00:00 app[web.1]:                AND a.attnum > 0 AND NOT a.attisdropped
2013-04-06T14:42:51+00:00 app[web.1]:                                         ^
2013-04-06T14:42:51+00:00 app[web.1]: ):
2013-04-06T14:42:51+00:00 app[web.1]: 
2013-04-06T14:42:51+00:00 app[web.1]: Processing by PlacesController#index as HTML
2013-04-06T14:42:51+00:00 app[web.1]: ):
2013-04-06T14:42:51+00:00 app[web.1]:              ORDER BY a.attnum
2013-04-06T14:42:51+00:00 app[web.1]:   app/controllers/places_controller.rb:3:in `index'
2013-04-06T14:42:51+00:00 app[web.1]:   app/controllers/places_controller.rb:3:in `index'
2013-04-06T14:42:51+00:00 app[web.1]: Completed 500 Internal Server Error in 6ms
2013-04-06T14:42:51+00:00 app[web.1]: 
2013-04-06T14:42:51+00:00 app[web.1]: ActiveRecord::StatementInvalid (PG::Error: ERROR:  relation "places" does not exist
2013-04-06T14:42:51+00:00 app[web.1]: LINE 5:              WHERE a.attrelid = '"places"'::regclass
2013-04-06T14:42:51+00:00 app[web.1]:              WHERE a.attrelid = '"places"'::regclass
2013-04-06T14:42:51+00:00 app[web.1]:              ORDER BY a.attnum
2013-04-06T14:42:51+00:00 app[web.1]:                AND a.attnum > 0 AND NOT a.attisdropped
2013-04-06T14:42:51+00:00 app[web.1]:                                         ^
2013-04-06T14:42:51+00:00 app[web.1]: :             SELECT a.attname, format_type(a.atttypid, a.atttypmod),
2013-04-06T14:42:51+00:00 app[web.1]:                      pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod
2013-04-06T14:42:51+00:00 app[web.1]:               FROM pg_attribute a LEFT JOIN pg_attrdef d
2013-04-06T14:42:51+00:00 app[web.1]:                 ON a.attrelid = d.adrelid AND a.attnum = d.adnum
2013-04-06T14:42:51+00:00 app[web.1]: 
2013-04-06T14:42:51+00:00 heroku[router]: at=info method=GET path=/help host=taskeyo.herokuapp.com fwd="72.229.188.61" dyno=web.1 connect=0ms service=291ms status=500 bytes=643
2013-04-06T14:42:51+00:00 heroku[router]: at=info method=GET path=/help host=taskeyo.herokuapp.com fwd="72.229.188.61" dyno=web.1 connect=1ms service=301ms status=500 bytes=643
2013-04-06T15:52:36+00:00 heroku[web.1]: Stopping all processes with SIGTERM
2013-04-06T15:52:37+00:00 app[web.1]: [2013-04-06 15:52:37] ERROR SignalException: SIGTERM
2013-04-06T15:52:37+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/server.rb:90:in `select'
2013-04-06T15:52:45+00:00 heroku[web.1]: Stopping remaining processes with SIGKILL
2013-04-06T15:52:45+00:00 heroku[web.1]: Error R12 (Exit timeout) -> At least one process failed to exit within 10 seconds of SIGTERM
2013-04-06T15:52:47+00:00 heroku[web.1]: Process exited with status 137
2013-04-06T15:52:47+00:00 heroku[web.1]: State changed from up to down
2013-04-06T15:52:32+00:00 heroku[web.1]: Idling 
```

如果其他人遇到过这个问题并且知道一个很好的解决方法，我将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T06:22:16.987

Heroku 在部署时会为您运行迁移是一个常见的误解——它们不会，即使在初始部署之后，您也总是需要自己执行迁移。`heroku run rake db:migrate`会让你摆脱目前的问题。

# extjs - 在 Extjs 3.3 中，如何在“选择文件”按钮附近添加另一个按钮？

> ID：15857255
> 
> 赞同：3
> 
> 时间：2013-04-06T23:43:52.363
> 
> 标签：extjs, append

我的问题是：我需要支持`select local image files`，而且`preview server side images`我正在使用插件`FileUploadField`。它有一个从本地文件中选择的按钮，如何在它附近添加另一个按钮？

也许这是同一个问题：

如何找到按钮的父组件，并附加另一个子（按钮）？

多谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T18:18:33.900

您可以在像这样呈现字段后添加自定义按钮

```
Ext.onReady(function(){
    var fp = new Ext.ux.form.FileUploadField({
        renderTo : Ext.getBody(),
        emptyText: 'Select an image',
        listeners : {
            afterrender : function(fupload) {
                this.customButton = new Ext.Button({
                    renderTo : Ext.getBody(),
                    cls: 'x-form-file-btn',
                    text : 'some button'
                });
                this.customButton.el.insertAfter(fupload.fileInput);
            }
        }
    });
}); 
```

例子：

[JSFiddle 链接](http://jsfiddle.net/DD2Jv/)

# javascript - 按下选项卡时，如何在获得焦点时取消选择文本框的文本？

> ID：15857260
> 
> 赞同：3
> 
> 时间：2013-04-06T23:44:50.257
> 
> 标签：javascript, jquery, jquery-ui

我有一个连续的一系列文本框，用于输入时间。当用户返回到已经编辑过的文本框时，浏览器会突出显示该文本框中的文本。

1.  当文本框获得焦点时，我将如何取消选择其中的文本，以及
2.  将光标设置在文本框中文本的开头？

我尝试了以下方法，但没有用：

在文本框焦点处理程序中：

```
var html = $("#MyTextArea").val();
$("#MyTextArea").focus().val("").val(html); 
```

为文本框选择处理程序：

```
if (window.getSelection) {
    if (window.getSelection().empty) {  // Chrome
        window.getSelection().empty();
    } else if (window.getSelection().removeAllRanges) {  // Firefox
        window.getSelection().removeAllRanges();
    }
} else if (document.selection && document.selection.empty) {  // IE?
    document.selection.empty();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:06:56.777

我认为问题在于浏览器直到焦点处理程序执行后才会选择文本。您可以尝试使用`setTimeout()`来延迟您的代码，如下所示：

```
$('input').focus(function() {
    var $input = $(this);
    setTimeout(function() {
        setCaretPos($input[0], 0, 0);
    }, 0)
}); 
```

**[jsfiddle 演示](http://jsfiddle.net/john_s/A2ZcT/2/)**

这使用以下方法来设置插入符号位置。

```
function setCaretPos(element, begin, end) {
    if (element.setSelectionRange) {
        element.setSelectionRange(begin, end);
    } else if (element.createTextRange) {
        var range = element.createTextRange();
        range.collapse(true);
        range.moveEnd('character', end);
        range.moveStart('character', begin);
        range.select();
    }
} 
```

如果您决定将焦点放在文本的末尾，您可以使用：

```
var end = $input.val().length;
setCaretPos($input[0], end, end); 
```

信用：

我从[jQuery mask plugin](http://digitalbush.com/projects/masked-input-plugin/)`setCaretPos()`获得了函数的代码。该插件包含一个您可以使用的插件方法。`.caret()`

# neo4j - 关于使用 Neo4j 设计页面查看日志方案的提示？

> ID：15857263
> 
> 赞同：0
> 
> 时间：2013-04-06T23:45:03.983
> 
> 标签：neo4j, graph-databases

我正在尝试为事件日志设计一个方案，该方案使用[Neo4j](http://www.neo4j.org)记录网页上的页面视图流。

我有兴趣找到指向特定页面集合 (URL) 的页面视图流。我正在考虑定义`nodes`为页面查看事件，重要`properties`的包括用户 ID、时间戳等。之间的唯一关系`nodes`是`visit`.

我对 Neo4j 完全陌生。那么这样的设计合理吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T12:53:45.790

如果属性是重复出现的，我也会将它们建模为节点。您甚至可以查看[http://dataablend.be/?p=1516 之](http://datablend.be/?p=1516)类的内容来获取灵感。

# javascript - 一个 jQuery 插件可以对单个 jQuery 对象执行多项操作？

> ID：15857265
> 
> 赞同：2
> 
> 时间：2013-04-06T23:45:14.633
> 
> 标签：javascript, jquery, jquery-plugins

我发现自己对同一个 jQuery 对象做了很多不同的事情。
所以不要做这样的事情：

```
var thing = $("pile_o_selectors");
thing.blah;
thing.blah_2;
//...
thing.blah_n; 
```

甚至更糟

```
$("selectors").blah;
$("selectors").blah_2;
//...
$("selectors").blah_n; 
```

所以，我做了一个小 jQuery 插件来让我这样做：

```
$("selectors").do(function(){
  this.blah;
  this.blah_2;
  this.blah_n;
}); 
```

是否有一个内置的 jQuery 函数已经这样做了？或者甚至是一个已经存在并经过测试和成熟的插件，所以我不必努力确保我的插件在所有情况下都能正常工作？我试着在网上搜索了一下，但我什至不知道该怎么称呼它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T23:55:52.633

不是 100% 确定你想做的那些“事情”是什么，但它们可以简单地被束缚吗？

[http://www.w3schools.com/jquery/jquery_chaining.asp](http://www.w3schools.com/jquery/jquery_chaining.asp)

```
i.e. $("#p1").css("color","red").slideUp(2000).slideDown(2000); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T23:54:52.380

你可以把它们锁起来。例如：

```
$('selector')
    .hide()
    .text("Hello, world!")
    .fadeIn(); 
```

这适用于大多数没有明显返回的方法；在这种情况下，它们会再次返回 jQuery 对象，从而使其成为可能。但是，如果他们需要返回一些东西，那么他们就不能返回 jQuery 对象，并且你不能进一步链接。

# ruby - 加法方法上的 Ruby 语法糖

> ID：15857266
> 
> 赞同：0
> 
> 时间：2013-04-06T23:45:23.387
> 
> 标签：ruby, syntax, syntax-error, addition

快速提问，为什么这不起作用？

```
sum = {}
e = "a"
(sum[e] ||= 0) += 1 
```

我得到（期待`1`）：

```
SyntaxError: unexpected tOP_ASGN, expecting $end
(sum[e] ||= 0) += 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T23:48:33.360

当您执行`(sum[e] ||= 0)`括号时，会导致计算表达式。结果，它将评估为`sum[e]`（例如0）的值，您无法对其进行`+=`操作。它不会`sum[e]`像您期望的那样返回左值/引用。

您可以通过对结果执行相同的操作来验证这一点：

```
irb(main):001:0> 0 += 1
SyntaxError: (irb):1: syntax error, unexpected tOP_ASGN, expecting $end 
```

甚至是这样的：

```
irb(main):004:0> (sum[e]) += 1
SyntaxError: (irb):4: syntax error, unexpected tOP_ASGN, expecting $end 
```

如果出于某种原因您想将其保留在一条线上，您可以执行以下操作：

```
sum[e] ||= 0; sum[e] += 1 
```

正如 dbenhur 提到的，如果您要经常这样做，您还可以为哈希中的所有键设置默认值：

```
sum = Hash.new(0) 
```

将 sum 设置为一个散列，其中每个键在您访问时自动设置为 0。

# java - 可以无限制地保存多个值的二维数组

> ID：15857267
> 
> 赞同：0
> 
> 时间：2013-04-06T23:45:25.697
> 
> 标签：java, arrays, multidimensional-array

我对 java 很陌生，目前正在开发一个不那么简单的 Web 浏览器应用程序，我想在其中记录一个带有 2D 数组设置的永久历史文件，其中 3 列包含“查看日期”、“URL”、“多少以前查看过此 URL 的次数”。

目前我有一个临时解决方案，它只保存“URL”，它也用于使用 ArrayList 的“后退，前进”功能。

```
private List tempHistory = new ArrayList(); 
```

我正在阅读 Java 文档，但我无法组合出一个解决方案，除非我错过了显而易见的，没有像 Python 中那样灵活的 ArrayList 的二维数组？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T23:52:18.780

根据您的描述，听起来您不需要二维数组。你只有一个维度——但是是复杂的数据类型，对吧？

因此，为查看日期、URL和查看次数定义一个`HistoryItem`类或具有属性的东西。`Date``URL``int`

那么你只想要一个`List<HistoryItem> history = new ArrayList<HistoryItem>()`.

我不认为你真的想要一个类似二维数组的东西的原因是它只能保存一种数据类型，而且你显然有几种数据类型在这里工作，比如日期和计数。但是如果你真的想要一个类似表格的抽象，试试 Guava's [Table](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Tables.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T23:52:21.140

不，Java 中没有内置的二维数组类型（除非您使用原始数组）。

您*可以*只使用列表列表 ( `List<List>`) - 但是，我认为使用放入列表中的自定义类型几乎总是更好。在您的情况下，您将创建一个类`HistoryEntry`（包含“查看日期”、URL 等字段），然后使用`List<HistoryEntry>`. 这样，您就可以获得正确类型为您带来的所有好处（类型检查、IDE 中的完成、将方法放入类的能力等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-07T02:40:23.067

那你打算怎么浏览历史呢？如果您想稍后搜索每个 url 的历史记录，那么 ArrayList 方法可能效率不高。

我更喜欢以 URL 为键的 Map。

```
Map<Url,UrlHistory> browseHistory = new HahMap<Url,UrlHistory> (); 
```

UrlHistory 将包含您要与 url 关联的所有字段，例如 no。次页面被访问和所有。

# php - 通过包含在 PHP 中转换 HTML/CSS 网站会损害谷歌排名或影响正确的索引

> ID：15857270
> 
> 赞同：-2
> 
> 时间：2013-04-06T23:46:01.023
> 
> 标签：php, seo

这个问题很简单。我见过一些类似的问题，但不是我需要回答的问题。因此，可以说我拼接了整个站点并使用包含几乎所有内容。导航，关于我们等。这会影响谷歌排名和索引吗？当它通过包含时，谷歌将通过解析 php 来查看该站点，或者将其索引为空白站点。因为大部分内容都在单独的包含文件中。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T23:48:01.567

不，Google 应该看不到您的 php 脚本。

# css - CSS 中心响应 DIV

> ID：15857276
> 
> 赞同：5
> 
> 时间：2013-04-06T23:47:14.417
> 
> 标签：css, fluid-layout

您在图 1 中看到的“图块”（白框）是对用户屏幕的响应。如果屏幕尺寸不够大，它会在右侧留下一个间隙。我想要做的是实现如图 2 所示的结果。这是我迄今为止针对这些特定元素的代码..

**HTML：**

```
<div class="main">
    <div class="inner">
        <div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div><div class="tile"></div>
    </div>
</div> 
```

**CSS：**

```
.main{
    width:100%;
    background: #000;
}

.main .inner{
    margin:10px;
    min-width: 140px;
    background: red;
}

.main .inner .tile{
    margin:10px;
    height: 120px;
    width: 120px;
    background: #fff;
    display: inline-block;
} 
```

**图 1：** ![在此处输入图像描述](https://i.stack.imgur.com/EbRzb.png)

**图 2：** ![在此处输入图像描述](https://i.stack.imgur.com/lCeSa.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-07T01:29:38.770

您可以使用媒体查询来执行此操作，以将`.inner`类的宽度设置为各种浏览器宽度，然后将`margin-left`和`margin-right`属性设置为`auto`使其居中。设置类的`padding-top`and`padding-bottom`属性，`.main`而不是设置类的上下边距`.inner`。使用`padding`on `.inner`class 和`border`on `.tile`class 的组合将瓷砖均匀地`10px`分开。

有关媒体查询的详细说明：[CSS 媒体查询](https://developer.mozilla.org/en/docs/CSS/Media_queries)

[例子](http://jsfiddle.net/axrwkr/eaefL)

css

```
.main{
    width: 100%;
    background: #000;
    padding-top: 10px;
    padding-bottom: 10px;
}

.main .inner{
    padding: 5px;
    font-size: 0px;
    display: table;
    margin-left: auto;
    margin-right: auto;
    background-color: red;
}

.main .inner .tile{
    margin: 0px;
    padding: 0px;
    border: 5px solid red;
    height: 120px;
    width: 120px;
    background: #fff;
    display: inline-block;
} 
```

为每个浏览器宽度设置一个媒体查询，在这个例子中我只增加了 800 像素，但你可以根据需要添加更多。

CSS（续）

```
@media (min-width: 280px) {
    .main .inner{
        width: 130px;
    }
}

@media (min-width: 320px) {
    .main .inner{
        width: 260px;
    }
}

@media (min-width: 480px) {
    .main .inner{
        width: 390px;
    }
}

@media (min-width: 640px) {
    .main .inner{
        width: 520px;
    }
}

@media (min-width: 800px) {
    .main .inner{
        width: 780px;
    }
} 
```

媒体查询用于将宽度设置`.inner`为的倍数，`130px`其中的宽度是`.tile`带有边框的a 的宽度`10px`。

如果要更改图块之间的间距，则需要更改类`border`上的 、类上的 、类上的以及每个媒体查询中指定的 。`.tile``padding``.inner``margin-top``margin-bottom``.main``width`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T23:52:38.900

```
 .main .inner{
  min-width: 140px;
    background: red;
    text-align:center;
    } 
```

添加 text-align:center css 属性 [http://jsfiddle.net/dolours/afKgg/](http://jsfiddle.net/dolours/afKgg/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T23:53:12.423

你可以设置 max-width for`.inner`然后有`text-align: center`for`.main`

# ios - 谷歌地图中的didUpdateUserLocation？

> ID：15857281
> 
> 赞同：2
> 
> 时间：2013-04-06T23:48:32.350
> 
> 标签：ios, mkmapview, mapkit, google-maps-sdk-ios

我正在使用故事板和谷歌地图构建一个 iOS 应用程序。使用iOS6——苹果地图有个方法

-(void)mapView:(MKMapView*)mapView didUpdateUserLocation:(MKUserLocation *)userLocation { }

查看在线文档和 xCode 中的 googleMaps.framework，我没有找到任何类似方法的线索。

我想要做的是当用户到达地图上的标记时 - 让用户知道他们到达了那个目的地。

谷歌地图中是否存在上述方法？和/或我需要做什么来实现我之前所说的。

任何有关此事的指导将不胜感激，在此先感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T03:50:43.497

该类`GMSMapView`有一个`myLocation`属性，您可以在用户位置移动时观察该属性的变化。有关完整详细信息，请参阅此问题：

[关于定位自己，一些问题](https://stackoverflow.com/questions/15266118/about-positioning-myself-some-problems)

另一种研究方法可能是`startMonitoringForRegion:`方法，当用户在区域内移动时（例如，靠近目标标记），您可以使用该方法接收通知：

[http://developer.apple.com/library/ios/#documentation/CoreLocation/Reference/CLLocationManager_Class/CLLocationManager/CLLocationManager.html#//apple_ref/occ/instm/CLLocationManager/startMonitoringForRegion](http://developer.apple.com/library/ios/#documentation/CoreLocation/Reference/CLLocationManager_Class/CLLocationManager/CLLocationManager.html#//apple_ref/occ/instm/CLLocationManager/startMonitoringForRegion)：

# opengl - OpenGL 3D 相机 gluLookAt

> ID：15857283
> 
> 赞同：2
> 
> 时间：2013-04-06T23:48:36.360
> 
> 标签：opengl, 3d, camera, rotation, glulookat

我正在尝试使用 gluLookAt 方法设置 3D 相机。所以我有一个 10x10x10 的立方体，现在我想在那个立方体内移动相机。我有类似的东西：

```
gluLookAt( camera->x,camera->y,camera->z, camera->eyeX, camera->eyeY, camera->eyeZ, 0, 1, 0 ); 
```

现在我正在前进/后退：

```
if(GetKeyState(VK_UP) <0)
               {    
                    camera->x += sin(camera->angleX)*0.1f;
                    camera->eyeX += sin(camera->angleX)*0.1f;               
                    camera->z -= cos(camera->angleX)*0.1f;
                    camera->eyeZ -= cos(camera->angleX)*0.1f;
            } 
```

现在我向左/向右旋转：

```
if(GetKeyState(VK_LEFT) <0)
            {   
                camera->angleX -=0.1f;
                camera->eyeX = sin(camera->angleX) +camera->x;
                camera->eyeZ = -cos(camera->angleX) + camera->z;
            } 
```

这样一切正常，但现在我想在按下 SHIFT 按钮时向上/向下旋转。所以我有这样的事情：

```
if(GetKeyState(VK_SHIFT) <0)
            {   
                if(GetKeyState(VK_UP)<0)
                {
                    camera->angleY +=0.1f;                  
                    camera->eyeY = sin(camera->angleY) +camera->y;                  
                } 
```

实际上发生了一些奇怪的事情。相机一直在上下跳动，并缓慢地向前移动。另外，我想补充一点，当我向上看并向前移动时，相机实际上会到达它看起来的地方。所以基本上情况是这样的：我是一个被困在一个 10x10x10 立方体中的幽灵，可以走到任何我想去的地方。我想移动到右上角？我只是去那里。所以......任何想法我应该改变/添加什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T07:28:35.253

编辑：我从头开始回复，因为我可能对这个主题太熟悉了。

您面临的问题是您的公式基本上不正确：假设“向上”向量（从相机指向上方的向量）始终为 [0 1 0]，您的左/右旋转公式是正确的。 . 如果您还想向上/向下旋转，情况并非如此。而且您向上向下旋转的公式不正确，因为它仅修改 Y 分量并且旋转不起作用。

正确的处理方法是：

*   存储 3 个表示相机位置的变量（如您所做的那样）。让我们称他们为`Px`, `Py`,`Pz`
*   存储 3 个表示相机视图方向的变量（而不是编码相机正在查看的点的 eyeX/Y/Z）。让我们称他们为`Vx`, `Vy`,`Vz`
*   存储 3 个表示相机右矢量（或上矢量，如您所愿）的变量。让我们取正确的向量，并将其称为`Rx`, `Ry`, `Rz`。

或者，您可以有一个很好的“向量”类来表示向量，而不是每次都存储 3 个变量。这是此时的一个细节。

现在，您将相机向前移动的方法变成：

```
Px += Vx;
Py += Vy;
Pz += Vz; 
```

例如，您可以使用[Rodrigues](http://en.wikipedia.org/wiki/Rodrigues%27_rotation_formula)公式进行旋转（希望没有人会向您发射“四元数”魔法词来表达他们的聪明；））。围绕任意轴旋转的一般自包含代码将是：

```
// rotate the vector (vx, vy, vz) around (ax, ay, az) by an angle "angle"

void rotate(double &vx, double &vy, double &vz, double ax, double ay, double az, double angle) {
  double ca = cos(angle);
  double sa = sin(angle);
  double crossx = -vy*az + vz*ay;
  double crossy = -vz*ax + vx*az;
  double crossz = -vx*ay + vy*ax;
  double dot = ax*vx + ay*vy + az*vz;
  double rx = vx*ca + crossx*sa + dot*ax*(1-ca);
  double ry = vy*ca + crossy*sa + dot*ay*(1-ca);
  double rz = vz*ca + crossz*sa + dot*az*(1-ca);
  vx = rx; 
  vy = ry; 
  vz = rz;
} 
```

并确保为您的相机矢量保持标准化坐标。

现在，在按下按钮时专门向上/向下旋转相机：

```
// rotate up:
rotate(Vx, Vy, Vz, Rx, Ry, Rz, some_CONSTANT_angle);
// rotate down:
rotate(Vx, Vy, Vz, Rx, Ry, Rz, - some_CONSTANT_angle); 
```

要向左/向右旋转，您首先需要计算不需要存储的“向上”向量（除非您愿意，但它是多余的），并旋转您的视图方向和右向量：

```
// find up vector using a cross product:
  double Ux = Ry*Vz - Rz*Vy;
  double Uy = Rz*Vx - Rx*Vz;
  double Uz = Rx*Vy - Ry*Vx;

//rotate left
    rotate(Rx, Ry, Rz, Ux, Uy, Uz, some_CONSTANT_angle);
    rotate(Vx, Vy, Vz, Ux, Uy, Uz, some_CONSTANT_angle);
// rotate right
    rotate(Rx, Ry, Rz, Ux, Uy, Uz, - some_CONSTANT_angle);
    rotate(Vx, Vy, Vz, Ux, Uy, Uz, - some_CONSTANT_angle); 
```

设置你的相机矩阵现在变成：

```
 gluLookAt( Px, Py, Pz, Px+Vx, Py+Vy, Pz+Vz, Rx, Ry, Rz); // or is it Ux, Uy, Uz at the end? don't remember. 
```

当然，我没有测试任何这段代码，现在就写了。希望它有效！

# ios - 在运行时查找 Xcode Build 方案名称

> ID：15857285
> 
> 赞同：19
> 
> 时间：2013-04-06T23:49:13.877
> 
> 标签：ios, xcode

有没有办法找出运行时使用的方案？

可能有更好的方法来做到这一点，我正在尝试使用方案名称来设置访问环境（生产与开发）。

目前我`#define ENV @"PROD"`在`App-Prefix.pch`文件中使用它来执行此操作，但是在将 pkg 发送到苹果进行审查时有机会错过这个:(

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2014-10-17T21:22:32.880

我到处寻找答案，因为我真的不喜欢创建额外目标或额外配置集的想法。这两个选项只会造成巨大的配置同步问题。

因此，在破解 Xcode 几个小时后，我得出了以下结论：

**第 1 步**：将键“SchemeName”添加到您的 Info.plist 中，类型为字符串。

**第 2 步**：编辑您的默认方案并在 Build -> Pre-actions 添加一个新的运行脚本，其中包含以下内容：

```
/usr/libexec/PlistBuddy -c "Set :SchemeName \"$SCHEME_NAME\"" "$PROJECT_DIR/$INFOPLIST_FILE" 
```

确保并从“提供构建设置”下选择一个目标。

**第 3 步**：现在*复制*该方案任意多次（管理方案... -> 选择现有方案 -> 单击齿轮图标 -> 复制）例如，您可以创建开发、登台、生产、应用商店等。如果您希望在版本控制中携带这些方案，请不要忘记单击“共享”。

**第 4 步**：在代码中，您可以像这样检索值：

```
NSString *schemeName = [[[NSBundle mainBundle] infoDictionary] valueForKey:@"SchemeName"]; 
```

或者在 Swift 中：

```
let schemeName = Bundle.main.infoDictionary?["SchemeName"] as? String ?? "" 
```

现在，代码可以在运行时正确配置自身。无需处理讨厌的预处理器宏，也无需维护易碎的配置混乱。

更新：根据下面的评论，`$PROJECT_DIR`可能需要根据您的 Info.plist 在项目中的位置删除。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-07T00:00:19.290

在模拟器或设备上运行应用程序时，`DEBUG`会设置变量，允许您从代码中使用它：

```
#ifdef DEBUG
    // Something
#else
    // Something else
#endif 
```

您可以从目标的构建设置中看到此变量：

![](https://i.stack.imgur.com/d88Lb.png)

一旦`Run`配置设置为`Debug`（产品 -> 方案 -> 编辑方案），将设置此变量：

![在此处输入图像描述](https://i.stack.imgur.com/Lgsj1.png)

# svg - 如何创建由非常小的正方形组成的条形图

> ID：15857286
> 
> 赞同：1
> 
> 时间：2013-04-06T23:49:20.170
> 
> 标签：svg, d3.js, nvd3.js

我正在尝试使用 d3 创建一个图表，该图表最终几乎就像条形图。但是，我想通过使用非常小的单个方块来实现这一点。如下图所示，但忽略了周围点缀的随机方块：

[http://i.imgur.com/jYSyhur.jpg](http://i.imgur.com/jYSyhur.jpg)

每个方格代表一个投票（或一组投票，取决于给定日期的投票数），可以有 3 个可能的值，每个值都有不同的蓝色阴影，即浅蓝色、蓝色和深蓝色。

我已经找到的一个示例是[http://bost.ocks.org/mike/miserables/](http://bost.ocks.org/mike/miserables/)但我想将这种样式转换为条形图。

我已经尝试在 HTML 中使用表格和 div 进行标记，但这已经完全失控并最终大大降低了页面加载速度——因此改用 SVG。

任何有关如何解决此问题的想法将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-07T01:53:37.430

您想要做的基础是堆积条形图：[http ://bl.ocks.org/mbostock/3886208](http://bl.ocks.org/mbostock/3886208)

但是，您需要考虑一些事项。y 轴和 x 轴必须成比例，因此您必须仔细考虑：

*   图的大小
*   数据点的数量
*   每个数据点可以具有的最大值

并为每个刻度选择一个高度、宽度和“值” - 每个正方形。

我在这里做了一个演示小提琴：http: [//jsfiddle.net/sa5RK/](http://jsfiddle.net/sa5RK/)

它假设了一些事情（为简单起见！）：

*   每个刻度是一个值
*   设置盒子的高度和宽度

    ```
    var boxheight = 6; 
    ```

*   高度/宽度可以根据框的大小和数据值动态变化

    ```
    var margin = {top: 20, right: 20, bottom: 80, left: 40},
        width = boxheight * data.length;

    var max = d3.max(data, function(d){return d.a + d.b + d.c});
    var height = max * boxheight; 
    ```

我希望这足以让你开始！

另一个对您有帮助的关键是学习如何将每个数据连接选择设置为一个变量，然后在其中选择将允许您访问外部绑定数据。例如。下面，每个数据组（原始数组中的值）-> 具有类型（a、b 或 c）-> 具有矩形

```
var groups = svg.selectAll(".group")
    .data(data)
      .enter().append("g")
        .attr("transform", function(d,i){return "translate(" + x(i) + ", 0)"})
        .attr("class", "group")

var types = groups.selectAll(".type")
    .data(function(d){return d.offsets})
      .enter().append("g")
        .attr("transform", function(d){ return translate(0,y(d.y1))})
        .attr("class", "type")
        .attr("fill", function(d){return color(d.type)})

types.selectAll("rect")
    .data(function(d){return d3.range(0,d.value)})
      .enter().append("rect")
        .attr("height", boxheight-0.5)
        .attr("width", boxheight-0.5)
        .attr("y", function(d){ return boxheight * d }) 
```

# php - 简单的布尔函数

> ID：15857287
> 
> 赞同：0
> 
> 时间：2013-04-06T23:49:58.883
> 
> 标签：php, mysql, boolean

我目前有一个表格，该表格当前显示有关患者的信息并计算他们的等待时间。

我在患者表中有一个布尔值；

```
Name      Type       Value 
Examined  Tinyint(1) 0 
```

我想在表格中为每一行设置一个简单的复选框功能，允许用户选择是否检查了患者；如果选中该框，则该行将从表中消失，但不会从数据库中消失。

我该怎么做呢？

这是我的代码：

```
<?php

$conn = mysqli_connect("localhost","root","") or die ("No connection");
mysqli_select_db($conn, "a&e") or die('Could not select database.');

$query = "SELECT PatientID, Forename, Surname, Gender, Illness, Priority, Arrival_time,NOW() as now,ABS(TIMEDIFF(NOW(), Arrival_time)) as Waiting_Time FROM Patient";
$result = mysqli_query($conn, $query) or die("Invalid query"); 

/**
 * Convert number of seconds into hours, minutes and seconds
 * and return an array containing those values
 *
 * @param integer $seconds Number of seconds to parse
 * @return array
 */
function secondsToTime($seconds)
{
    // extract hours
    $hours = floor($seconds / (60 * 60));

    // extract minutes
    $divisor_for_minutes = $seconds % (60 * 60);
    $minutes = floor($divisor_for_minutes / 60);

    // extract the remaining seconds
    $divisor_for_seconds = $divisor_for_minutes % 60;
    $seconds = ceil($divisor_for_seconds);

    // return the final array
    $obj = array(
        "h" => (int) $hours,
        "m" => (int) $minutes,
        "s" => (int) $seconds,
    );
    return $obj;
}

echo "<table border='1'>
<tr>
<th>PatientID</th>
<th>Forename</th>
<th>Surname</th>
<th>Gender</th>
<th>Illness</th>
<th>Priority</th>
<th>Waiting Time</th>
<th>Examined</th>
</tr>";

while ($row = $result->fetch_object()){

//Select the  expected and discharge time for this patient.
  $query2 = "SELECT Abs(TIMEDIFF(Expected_Time,'00:00:00')) as Expected,Abs(TIMEDIFF(Discharge_Time,'00:00:00')) as Discharge ".
                "FROM priority_time ".
                "WHERE Illness = '".$row->Illness."'".
                    " AND Priority = '".$row->Priority."'".
                ";";

    $result2 = mysqli_query($conn, $query2) or die("Invalid statement: ".$query2);

    $row2 = $result2->fetch_object();
    $expected =  $row2->Expected;

    $discharge  = $row2->Discharge;

    if($expected > $discharge){
        echo "There is a problem with the database consistency, expectedTime must be less than dischargeTime!";
    }
    //Set the patient color.
    if($row->Waiting_Time <  $expected && $row->Waiting_Time <  $discharge){
        echo "<tr>";
    }
    if($row->Waiting_Time >=  $expected && $row->Waiting_Time <  $discharge){
        echo '<tr bgcolor="#FFFF00">';
    }
    if($row->Waiting_Time >  $expected && $row->Waiting_Time >  $discharge){
        echo '<tr bgcolor="#FF0000">';
    }

    //Print patient info
     echo 
      "<td>" . $row->PatientID . "</td>
      <td>" . $row->Forename . "</td>
      <td>" . $row->Surname . "</td>
      <td>" . $row->Gender . "</td>
      <td>" . $row->Illness . "</td>
      <td>" . $row->Priority . "</td>
          <td>" . gmdate("H:i:s", $row->Waiting_Time)." </td>";

    //Close row
    echo "</tr>";

}
echo "</table>";
mysqli_close($conn);
?>
</html> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T09:16:11.533

最好使用 JOIN 从另一个表中添加一些字段要选择检查 Tinyint(1) 0 为零的唯一行，最好使用 WHERE

```
<?php

$conn = mysqli_connect("localhost","root","") or die ("No connection");
mysqli_select_db($conn, "a&e") or die('Could not select database.');

$query = "SELECT PatientID, Forename, Surname, Gender, Illness, Priority, Arrival_time, NOW() as now, ABS(TIMEDIFF(NOW(), Arrival_time)) as Waiting_Time, Abs(TIMEDIFF(Expected_Time,'00:00:00')) as Expected,Abs(TIMEDIFF(Discharge_Time,'00:00:00')) as Discharge FROM Patient
JOIN priority_time USING (Illness, Priority)
WHERE Examined = 0";
$result = mysqli_query($conn, $query) or die("Invalid query"); 

/**
 * Convert number of seconds into hours, minutes and seconds
 * and return an array containing those values
 *
 * @param integer $seconds Number of seconds to parse
 * @return array
 */
function secondsToTime($seconds)
{
    // extract hours
    $hours = floor($seconds / (60 * 60));

    // extract minutes
    $divisor_for_minutes = $seconds % (60 * 60);
    $minutes = floor($divisor_for_minutes / 60);

    // extract the remaining seconds
    $divisor_for_seconds = $divisor_for_minutes % 60;
    $seconds = ceil($divisor_for_seconds);

    // return the final array
    $obj = array(
        "h" => (int) $hours,
        "m" => (int) $minutes,
        "s" => (int) $seconds,
    );
    return $obj;
}

echo "<table border='1'>
<tr>
<th>PatientID</th>
<th>Forename</th>
<th>Surname</th>
<th>Gender</th>
<th>Illness</th>
<th>Priority</th>
<th>Waiting Time</th>
<th>Examined</th>
</tr>";

while ($row = $result->fetch_object()){

    $expected =  $row->Expected;

    $discharge  = $row->Discharge;

    if($expected > $discharge){
        echo "There is a problem with the database consistency, expectedTime must be less than dischargeTime!";
    }
    //Set the patient color.
    if($row->Waiting_Time <  $expected && $row->Waiting_Time <  $discharge){
        echo "<tr>";
    }
    if($row->Waiting_Time >=  $expected && $row->Waiting_Time <  $discharge){
        echo '<tr bgcolor="#FFFF00">';
    }
    if($row->Waiting_Time >  $expected && $row->Waiting_Time >  $discharge){
        echo '<tr bgcolor="#FF0000">';
    }

    //Print patient info
     echo 
      "<td>" . $row->PatientID . "</td>
      <td>" . $row->Forename . "</td>
      <td>" . $row->Surname . "</td>
      <td>" . $row->Gender . "</td>
      <td>" . $row->Illness . "</td>
      <td>" . $row->Priority . "</td>
          <td>" . gmdate("H:i:s", $row->Waiting_Time)." </td>";

    //Close row
    echo "</tr>";

}
echo "</table>";
mysqli_close($conn);
?>
</html> 
```

# java - 使用 oauth2 和日历 api v3 将事件插入到谷歌日历 api 的示例

> ID：15857289
> 
> 赞同：0
> 
> 时间：2013-04-06T23:50:37.707
> 
> 标签：java, google-calendar-api, google-api-java-client

我尝试了很多方法来使用 oauth2 和 calendar Api v3 将事件插入到谷歌日历。但我找不到任何例子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T04:52:41.173

```
public void createEvent(Calendar cal) throws IOException {       

Event event = new Event();
event.setSummary("Event name here");
event.setLocation("event place here");

Date startDate = new Date();
Date endDate = new Date(startDate.getTime() + 3600000);
DateTime start = new DateTime(startDate, TimeZone.getTimeZone("UTC"));
event.setStart(new EventDateTime().setDateTime(start));
DateTime end = new DateTime(endDate, TimeZone.getTimeZone("UTC"));
event.setEnd(new EventDateTime().setDateTime(end));
Event createdEvent = cal.events().insert("primary", event).execute();
System.out.println("Created event id: " + createdEvent.getId());
} 
```

希望此代码段可能对您有所帮助

# c# - 以特定的最大字符数打印一个数字（或字符串）

> ID：15857290
> 
> 赞同：0
> 
> 时间：2013-04-06T23:51:02.080
> 
> 标签：c#, c, string

`printf("%8d", n)`C# 中的数字和字符串是否有等效的 C 语言？

那么我可以以某种方式分配一个特定的大小来打印字符串或数字，如果字符串或数字较小，则会添加额外的空格吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T23:53:19.790

[字符串格式](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)

格式说明符的格式是

```
{ index[,alignment][ :formatString] } 
```

我们可以为索引插入 0，为对齐插入 8，使其与 8 个字符对齐。

```
Console.WriteLine("\"" + string.Format("{0,8}", 1234) + "\"");
Console.WriteLine("\"" + string.Format("{0,15}", 7) + "\""); 
```

这给了我们：

```
"    1234"
"              7" 
```

我们还可以为对齐指定一个负值，这将使字符串左对齐，而不是像以前那样右对齐。

```
string.Format("{0,-10}", 72); 
```

哪个输出

```
"72        " 
```

希望这可以为您解决问题:)

编辑：

正如 chris 所指出的， Console.WriteLine 函数本身采用格式字符串，无需显式调用 string.Format() 。这意味着您可以像这样对齐字符串。

```
Console.WriteLine("\"{0,8}\"", 1234); 
```

格式化我们的字符串并将其写入控制台，所有这些都在一个语句中。

# android - 在复选框android中缩放图像

> ID：15857292
> 
> 赞同：0
> 
> 时间：2013-04-06T23:51:36.463
> 
> 标签：android, view, checkbox

我正在改变尝试为我的 CheckBox 的自定义图像“fitXY”。我按照下面的stackoverflow来了解如何加载自定义图像，问题是完整图像没有出现在复选框中。我正在寻找`android:scaleType="fitXY"`复选框图像，但我无法让它工作。（我无法将该属性添加到 xml 中的复选框）

[更改 Android CheckBox 复选标记的默认颜色](https://stackoverflow.com/questions/11302428/changing-default-color-of-android-checkbox-check-mark)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:44:57.943

它不允许您使用该属性的原因是 scaleType 是 ImageView 的 XMLAttribute，但不是 CheckBox 的 XMLAttribute。你需要想出一个不同的方法。也许您可以将缩放的 ImageView 和您的复选框嵌入到 RelativeLayout 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-25T03:10:28.637

请改用切换按钮。之后，您可以将 drawable 设置为其背景。ToggleButton 和 Checkbox 的方法几乎相同。

# c# - 引用目录？

> ID：15857305
> 
> 赞同：-2
> 
> 时间：2013-04-06T23:53:54.777
> 
> 标签：c#

我正在 C# WPF 中创建一个程序，该程序允许用户在文本框中手动输入目录，以便程序将检索指定目录中的文件并将其列出到另一个文本框中。

我的问题是我不知道如何将文本框中的值分配给目录路径。

我可以在代码中手动指定目录，但是我不确定如何从文本框中分配目录路径...

有任何想法吗？

单击按钮时我的代码如下：

```
 // Makes a reference to a directory.
            DirectoryInfo di = new DirectoryInfo(@"C:\"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T23:56:25.020

```
DirectoryInfo di = new DirectoryInfo(textbox.Text); 
```

那应该行得通。

# ruby-on-rails - 使用 Rails 查找最后一天最喜欢的帖子

> ID：15857306
> 
> 赞同：-1
> 
> 时间：2013-04-06T23:53:55.913
> 
> 标签：ruby-on-rails, database, ruby-on-rails-3

我正在使用 Rails 创建一个应用程序，其中有用户可以喜欢的帖子。我为喜欢创建了一个不同的表，所以我有以下结构。

```
POSTS -> id
      -> title
      -> text
         ...

       belongs_to :user
       has_many :likes

USERS -> id
      -> email
      -> name
         ...

        has_many :posts
        has_many :likes

LIKES -> id
      -> post_id
      -> user_id
         ...

        belongs_to :user 
```

现在，在主页中，我想显示过去 24 小时内最喜欢的帖子，按点赞数排序。我还使用为我的 Post 模型提供分页的 Kaminari gem。

那么，我应该使用什么来获取具有这些参数的帖子？

```
def popular
    @posts = ?
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:14:10.930

我目前在这台计算机上没有我的 rails env，但尝试使用这个：

```
@posts = Post.joins("LEFT OUTER JOIN Likes ON likes.post_id = posts.id 
                     AND likes.created_at >= DATETIME('now', '-1 day')")
                    .group("posts.id").order("COUNT(likes.id) DESC") 
```

# java - Java RecursiveLinkedList 包含方法

> ID：15857307
> 
> 赞同：-3
> 
> 时间：2013-04-06T23:53:58.347
> 
> 标签：java, recursion, contains, singly-linked-list

我正在研究一个简单的linkedList类，这个类的要求之一是使用recurs来实现contains方法、add方法和remove方法。

根据示例，我发现我已经实现了 remove 方法，但是 contains 一直为我抛出错误。

任何人都可以帮助指出我的包含方法有什么问题，谢谢和问候。

```
public class RecursiveLinkedList {

private int value;
private RecursiveLinkedList next;

/*
 * Default Constructor
 * 
 * @param value an absolute int value for the current Node
 * @param next an absolute RecursiveLinkedList value for the current Node
 */
public RecursiveLinkedList(int value, RecursiveLinkedList next) {
    this.value = value;
    this.next = next;
}

/*
 * Constructor Empty, when user supplies an empty for the construcot use 
 * value = - 1 and next = null as input parameters
 * 
 * @param value an absolute int value for the current Node
 * @param next an absolute RecursiveLinkedList value for the current Node
 */
public static final RecursiveLinkedList EMPTY = new RecursiveLinkedList(-1, null) 
{
    public RecursiveLinkedList remove(int n) { return this; };

    public String toString() { return ""; };
};

public RecursiveLinkedList remove(int n) {
    if (value == n){
        return next;
    }
    //Call the remove method of the next Node if the selected Node is not the current node
    return new RecursiveLinkedList(value, next.remove(n));
}

public boolean contains(int n) {
    if (value == n){
        return true;
    }else if(next == null){
        return false;
    }
    return new RecursiveLinkedList(value, next).contains(n);
} 

public String toString() {
    return value + "," + next.toString();
}

public static void main(String[] args) {
    RecursiveLinkedList l = new RecursiveLinkedList(1,
                    new RecursiveLinkedList(2, 
                    new RecursiveLinkedList(2,
                    new RecursiveLinkedList(3, 
                    new RecursiveLinkedList(4, EMPTY)))));
    System.out.println(" Test to String Method : " + l.toString());
    System.out.println(" Test remove method " + l.remove(1).toString());
    System.out.println(" Test contains method " + String.valueOf(l.contains(4)));
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:06:46.483

为了防止`StackOverflowError`你应该改用：

```
public boolean contains(int n) {
    if (value == n){
        return true;
    }else if(next == null){
        return false;
    }
    return next.contains(n);
} 
```

# java - 为什么要定义多个导入？

> ID：15857310
> 
> 赞同：0
> 
> 时间：2013-04-06T23:54:27.037
> 
> 标签：java, import, wildcard

考虑以下导入语句：

导入java.io.*；// 有道理

导入 javax.servlet.*；

导入 javax.servlet.http.*；

是不是我们已经包含了“import javax.servlet *.;” 因此它会自动包含另一个导入语句，即“import javax.servlet.http* .;”？

为什么为 http 明确定义了“import javax.servlet.http.*”？

如果我错了，请澄清并告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T23:57:11.253

不，当您导入某些内容时，您仅导入特定类或导入包以及属于该包的所有类，而不是属于该包的子包的类。

每个包都包含一些相关的类和子包。子包中的类不一定与父包中的类相关。因此，将它们也导入是没有意义的。这样可以避免不必要的导入并保持项目干净。

**示例：**
假设您正在为您的 GUI 应用程序构建一个 View 类，您可能希望将关注点分开，以便您`JComponents`在 View 和`Listeners`Controllers 中拥有关注点。

因此，在您的视图中，您将导入：`import javax.swing.*;`这样您将获得所有`JComponent`类，但由于您的视图中不需要`event`包，因此导入只导入您实际需要的内容是有意义的。即使 tho`swing`和`event`package 有点相关，也不需要导入事件。

因此，当您在 Java 中导入某些内容时，您要么导入整个包`import javax.swing.*;`以及与包相关的所有类，要么导入包的单个类`import javax.swing.JButton;`

您永远不会导入包含所有子包及其子包等的包。因为您很可能不需要所有这些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T00:22:08.713

是的，您确实需要为每个包进行通配符导入。

为什么？就 JLS 而言，“com.example”和“com.example.pkg”是*不相关*的包。JLS 中提到了子包的概念，但没有相关的语义。特别是不在“访问”规则中。 [JLS 7.1](http://docs.oracle.com/javase/specs/jls/se7/html/jls-7.html#jls-7.1)说：

> *“包的分层命名结构旨在方便以常规方式组织相关包，但除了禁止包具有与顶级类型相同的简单名称的子包（§7.6 ) 在该包中声明。*
> 
> *例如，一个包名`oliver`和另一个包名`oliver.twist`之间，或者包名`evelyn.wood`和包之间没有特殊的访问关系`evelyn.waugh`。也就是说，一个名为的包中的代码对包`oliver.twist`中声明的类型的访问并不`oliver`比任何其他包中的代码更好。”*

（并且允许导入许多*不相关*的包的结构会产生不良后果……见下文。）

但为什么？因为这就是语言的设计方式。

但为什么？您需要询问 Java 语言设计团队，他们在 1990 年代初期做出设计决策时的想法是什么。

* * *

但也许我们可以看到如果有一个多包通配符导入会发生什么。

考虑这个包结构，这是一种非常常见的模式：

```
 com.example.weazellib - contains the public API classes for the library
  com.example.weazellib.impl - contains implementation classes that 
                               shouldn't be used by external clients 
```

众所周知，程序员很懒（很多人都懒惰），所以有些程序员可能会这样写：

```
 import com.example.weazellib.**    // hypothetical syntax 
```

他/她现在将在这个类命名空间中同时拥有外部 API 类和内部类，并且很容易*意外地*创建对内部的依赖。

（在你说*“使内部类包私有”*之前......那是行不通的。有一些类`com.example.weazellib`需要能够使用中的类`com.example.weazellib.impl`。如果后者是包私有的，那么前者将无法使用它们。）

相比之下，在 Java 没有导入包“树”的通配符的世界中，您不能*意外地*这样做。您必须*故意*导入`impl`包。这是**一件好事**，而且比为多个包编写通配符导入的“不便”重要得多。

* * *

另一个问题是通配符导入不利于源代码的长期稳定性，而超级通配符会使情况变得更糟。

假设一个程序员决定在他的代码中同时导入`com.example.weazellib`和`com.example.weazellib.impl`是正确的做法......并使用超级通配符来导入两者。并假设他编写代码以使用`com.example.weazellib.impl.ToesImpl`... as `ToesImpl`。

现在考虑如果“weazellib”开发人员添加`com.example.weazellib.impl2`包含替代实现类的第三个包会发生什么......与 ; 中的类具有相同的简单名称`impl`。例如，我们现在有如下类：

```
com.example.weazellib.impl.ToesImpl
com.example.weazellib.impl2.ToesImpl 
```

发生什么了？好吧，现在程序员代码中有一个编译错误。 `ToesImpl`是模棱两可的......*因为超级通配符导入*从以前不存在的包中提取类名的影响。

请注意，常规通配符导入也存在同样的问题。这就是为什么很多人不使用通配符导入的原因。但毫无疑问，超级通配符会使问题变得更糟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-07T00:01:02.077

它在规范中定义了导入的工作方式。

请参阅[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-7.html#jls-7.5)

原因是 javax.servlet 和 javax.servlet.http 是不同的包，import * 只带入包成员。

此外，通配符导入也不是一个好主意，因为它会降低代码的可读性。

# algorithm - 使用 Matlab 或其他工具进行时间序列模拟和逻辑检查

> ID：15857312
> 
> 赞同：0
> 
> 时间：2013-04-06T23:54:33.730
> 
> 标签：algorithm, matlab, visual-c++, data-mining, time-series

1）我有时间序列数据和信号（指标），它们的值随时间变化。

我的问题：

2) 我需要一直进行逻辑检查，例如，如果信号 1 和 2 大约在同一时间发生（等于某个值，例如 = 1），那么我需要知道确切的时间以便检查接下来发生的事情。

3）使事情复杂化，例如，如果信号 3 发生在信号 1 和信号 2 等于 1 之后的某个时间范围内，我想检查其他事情。

4）时间序列很长，需要逐段处理。

请建议如何在不发明轮子的情况下编写它。是否建议使用状态机在 Matlab 中编写？在 C++ 中？，使用线程？

5）Matlab 有没有为这类事情准备好的模拟器？如何以有效的方式定义逻辑条件？

6) 我可以为此使用数据挖掘工具吗？我看到了这个工具列表： [数据挖掘开源工具](https://stackoverflow.com/questions/835754/data-mining-open-source-tools) 不确定从哪里开始。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T03:38:13.400

第二个和第三个问题可以在 Matlab 中这样完成：

```
T = -range; % Assuming that t starts at 0.
for n = 1 : length(t)
    if signal1(n) == 1 && signal2(n) == 1
        T = t(n);
    end
    if t(n) - T < range && signal3(n) == 1
        if % Conditions you want to get checked, could also be put in the previous if statement.
            % Things you want to be executed if these coditions are met.
        end
    end
end 
```

使用像 C++ 这样的较低级别的编程语言会提高它的完成速度。如果数据很长，它还可以通过同时加载每个数组的元素来减少内存使用量。Matlab 有一个名为 Simulink 的模拟器，但它更适合解决更复杂的事情，因为您只是有条件地想做某事。

# php - 在表单集合类型中调用类型类

> ID：15857316
> 
> 赞同：1
> 
> 时间：2013-04-06T23:55:30.463
> 
> 标签：php, symfony

嗨，我的所有问题如下：例如在 AType 类中我做：

```
$builder
    ->add('responses', 'collection', array(
        'type' => new BType())) 
```

我想知道在哪里调用 BType 以帮助在树枝模板中渲染 AType

```
{{ entityA.responses }} 
```

编辑：

查看我在控制器中使用的代码，我创建了新的 B（实体类）对象并将所有内容添加到 arrayCollection 中，最后将该 arrayCollection 传递给 A 类的方法 setBs。我从不使用 BType。

我的控制器的代码：

```
$b1 = new B();
$b2 = new B();

$array = new ArrayCollection();
$array->add($b1);
$array->add($b2);

$a = new A();
$a->setBs($array);

$form = $this->createForm(new AType(), $a) 
```

我想将一些选项传递给 BType 类，这就是为什么我想知道它在哪里被调用。如果还有另一种可能性，那是受欢迎的（我是新手 :)）

# c# - 碰撞精灵不会移动到新位置

> ID：15857320
> 
> 赞同：1
> 
> 时间：2013-04-06T23:56:01.837
> 
> 标签：c#, windows-phone-7, xna

我有一个应用程序，我在屏幕上拖动一艘宇宙飞船避开小行星，并希望飞船在它们的矩形碰撞后返回到原来的位置，但它没有发生。

我不确定出了什么问题...

代码：

```
//Drag Ship

TouchCollection touchLocations = TouchPanel.GetState();

                foreach (TouchLocation touchLocation in touchLocations)
                {
                    Rectangle touchRect = new Rectangle
                    ((int)touchLocation.Position.X, (int)touchLocation.Position.Y, shipRect.Width, shipRect.Height);
                    if (touchLocation.State == TouchLocationState.Pressed
                    && shipRect.Intersects(touchRect))
                    {
                        shipPressed = true;

                    }
                    else if (touchLocation.State == TouchLocationState.Moved && shipPressed)
                    {
                        shipRect.X = touchRect.X - touchRect.Width / 2;
                        shipRect.Y = touchRect.Y - touchRect.Height / 2;
                    }
                    else if (touchLocation.State == TouchLocationState.Released)
                    {
                        shipPressed = false;
                    }
                    else if (lnBtnPlay.Tapped == true)
                    {

                    }

                } 
```

* * *

代码 2：

```
 if (shipRect.Intersects(asteroid1Rect))
                {
                    shipPosition = new Vector2(10, 400);
                 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T08:56:21.887

`shipPressed`除非您真正松开手指，否则永远不会设置为 false。因此，即使你可能与小行星相交，这艘船也会不断地回到你的身边。

一般来说，总是记得在“死亡”时重置一些东西。当你碰撞时清除`shipPressed`回来。`false`

如果即使您的手指没有触摸屏幕，船仍然没有返回，那么您`shipPosition`的`shipRect`. 确保始终保持这两者同步。总是一起更新它们，或者更简洁地说，只保留位置，并存储宽度和高度；您可以使用属性/方法调用轻松地从中生成一个矩形。

# css - 除了文本元素之外的 CSS nowrap？

> ID：15857321
> 
> 赞同：24
> 
> 时间：2013-04-06T23:56:15.077
> 
> 标签：css, html, nowrap

`div`当内容不仅仅是文本（例如几个按钮）时，有没有办法避免包装 a的内容？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-04-06T23:59:14.510

`white-space:nowrap;`应该做的伎俩。

```
#foo {
  white-space:nowrap;
  width: 100px;
}
```

```
<div id="foo">
  <input type="button" value="hello"/>
  <input type="button" value="hello"/>
  <input type="button" value="hello"/>
  <input type="button" value="hello"/>
  <input type="button" value="hello"/>
  <input type="button" value="hello"/>
  <input type="button" value="hello"/>
</div>
```

[演示](http://jsbin.com/ozanuc/1/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T00:02:26.113

您可以在 CSS 中设置这两个属性：

`white-space:nowrap;`和`max-width:something;`

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-04-07T00:00:06.213

您可以使用声明其他内容的静态位置

```
position:absolute; 
```

# javascript - 如何获得他们主页上显示的 qtip 样式？

> ID：15857324
> 
> 赞同：1
> 
> 时间：2013-04-06T23:56:45.620
> 
> 标签：javascript, jquery, qtip, qtip2

刚刚[将此插件](http://craigsworks.com/projects/qtip2/)添加到我的网站。我想要“qtips”，就像您将鼠标悬停在底部附近的大浏览器图标上时所拥有的一样。

我不知道他们用的是什么风格。我目前有这个，但结果不一样：

```
$('a[title]').qtip({
    'position': {
        my: 'bottom center',
        at: 'top center'
    },
    'style': {
        tip: true,
        classes: 'qtip-dark'
    }
}); 
```

有人知道他们在用什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T00:35:34.553

您想使用`qtip-tipsy`而不是`qtip-dark`.

```
$('a[title]').qtip({
    'position': {
        my: 'bottom center',
        at: 'top center'
    },
    'style': {
        tip: true,
        classes: 'qtip-tipsy'
    }
}); 
```

# java - JCheckboxes 到 JScrollPane

> ID：15857325
> 
> 赞同：0
> 
> 时间：2013-04-06T23:57:02.133
> 
> 标签：java, swing, jlist, joptionpane, jcheckbox

有没有办法将 jcheckboxes 添加到 jscrollpane 中？

我有一个复选框数组，我想将它们添加到 Jscrollpane 中，然后我将其添加到 JOptionPane 中。到目前为止，我有这个：

```
Object[] books = new Object[10000];
    books[0] = "Choose books to purchase: ";
    for(int l = 1;l<checkboxes.length;l++)
    {
        books[l] = checkboxes[l];
    }

    JList list = new JList(checkboxes);
    //JTextPane test = new JTextPane();
    //test.add(checkboxes[0]);

    JScrollPane myScrollPane = new JScrollPane(list);
    myScrollPane.setPreferredSize(new Dimension(250,250));

    JOptionPane.showMessageDialog(null, "Choose the books you want to purchase below.\nPlease note that each book has a $5 shipping charge.\nThe books are formatted as Title - Author - Price", "Reminder",JOptionPane.PLAIN_MESSAGE);
    JOptionPane.showMessageDialog(null,myScrollPane,"Book List",JOptionPane.OK_CANCEL_OPTION); 
```

输出没有给我复选框，只是我认为的复选框的指针。如您所见，我尝试将复选框放入 JList 但失败了。

非常感谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T09:38:28.890

您可以将复选框添加到 JPanel，并且 Jpanel 可以显示在 JDialog 而不是 JOptionPane 中。要将复选框添加到 JPanel，您可以查看此链接 [How to use JCheckbox array in JPanel array](https://stackoverflow.com/questions/15732194/how-to-use-jcheckbox-array-in-jpanel-array)

# titanium - 钛 我如何将视图添加到单个上下文中

> ID：15857330
> 
> 赞同：1
> 
> 时间：2013-04-06T23:57:31.753
> 
> 标签：titanium

所以我有一个钛应用程序，我只是阅读了关于单一上下文的信息。（顺便说一句，这里有人应该写一本关于钛编程的书……唯一一本没有真正提到单一上下文或任何新奇的东西。哎呀，让它成为一本电子书。我会买它）

钛文档强调了它们的使用（[http://docs.appcelerator.com/titanium/latest/#!/guide/Coding_Strategies-section-29004891_CodingStrategies-Executioncontexts](http://docs.appcelerator.com/titanium/latest/#!/guide/Coding_Strategies-section-29004891_CodingStrategies-Executioncontexts)），然后礼貌地忘记了如何实现单个上下文！

所以，问题：假设我有 awesomeWidget 页面 - 这只是显示一个按钮，当你点击一个按钮时，会出现一个新屏幕。

aswesomeWidget 页面是通过另一个页面访问的——它不是来自 Titan 应用程序的根目录。

保持单一上下文，如何将按钮创建的视图添加到当前窗口？

我是否：

保持一个指向当前（也是唯一）窗口的全局指针？

将保持当前窗口的变量向下传递给使用它的所有后续页面

别的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T02:51:15.963

首先，Titanium 会为[您保留对当前窗口的引用，所以这个用例很简单](http://docs.appcelerator.com/titanium/latest/#!/api/Titanium.UI-property-currentWindow)。例如：

```
awesomeWidgetButton.addEventListener('click' function(e) {
    var yourView = Ti.UI.createView({...});
    Titanium.UI.currentWindow.add(yourView);
}); 
```

`require`如果你想进一步挖掘，单一上下文的概念与 CommonJS 模块的使用和关键字密切相关。保持单一上下文非常简单，只是永远不要打开`url`填充组件的窗口，并自由使用`require()`关键字。除此之外，跟踪谁指向什么取决于您的想象力，反之亦然，这里有适用的标准模式和[最佳实践](http://javascript.crockford.com)（MVC、Singletons，只是保持简单），就像用任何其他语言进行编码一样。

# c++ - C++：在 C 或 C++ 中以普通文本模式（非二进制）最快地将向量文件写入输出

> ID：15857331
> 
> 赞同：4
> 
> 时间：2013-04-06T23:57:36.620
> 
> 标签：c++, c, file, text, vector

将`std::vector`（或任何连续容器）写入非二进制文件（即文本模式）的最快方法是什么？就我而言，速度很重要，并且向量会不断生成并写入文件。

在二进制模式下，它是相当直接的，因为`std::vector`它在内存中是连续的。请注意，我不想依赖 Boost 序列化。（尽管如果它是最优雅的方式，我可能会被迫这样做......）。我还需要一系列字符来分隔元素（即空格）

这就是我目前正在做的事情（是一个例子），但即使我`<<`为`vector`. 此代码是否有更优化的版本，还是我留下了这个？

```
std::ofstream output(...);
...
template <typename T>
write_vec_to_file (const &std::vector<T> v)
{
    for (auto i: v)
        output << i << " ";
    output << "\n";
} 
```

作为一个附带问题，如果一个人一直打电话`std::cout << ...`，刚开始会有开销`std::cout`吗？我的猜测显然是肯定的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T00:27:21.133

您可以使用[`std::copy`](http://www.cplusplus.com/reference/algorithm/copy/)例如

```
std::vector<int> v = { 1, 2, 3, 4, 5 };
std::copy(v.begin(), v.end(), std::ostream_iterator<int>(std::cout, " ")); 
```

# php - 添加参数时Symfony 2路由错误

> ID：15857346
> 
> 赞同：0
> 
> 时间：2013-04-06T23:59:48.103
> 
> 标签：php, symfony, view, routing, controller

我似乎遇到了我以前从未见过的 Symfony 2 问题（或者更可能我错过了一些非常明显的东西）。

我有一条不带参数且运行良好的路线，连接到控制器并显示正确的视图。然后我更新了路由以采用单个参数，如下所示：

```
# Note routing
    gibbo_dummy_notes_Add:
        pattern:  /notes/add/{notebook}
        defaults: { _controller: GibboDummyBundle:Note:add, notebook: 0}
        requirements:
                _method:  POST|GET 
```

但是，如果我现在尝试访问此路线，则会`notes/add/test`收到错误消息`The controller must return a response (null given). Did you forget to add a return statement somewhere in your controller?`。如果我删除参数，它会完美运行`notes/add`。

此设置与在我的应用程序中使用参数的其余路由完全相同。

控制器中的操作肯定会返回一个响应对象。如果我将 a`die('test');`放在操作的顶部并从 URL 中删除参数，我会到达 die 语句并看到“测试”，但是如果我将参数添加到 URL 会显示错误，因此它显然没有到达我的控制器或包含参数时的操作，但据我所知，路由设置正确，并且我没有得到正常的路由未定义错误，我希望看看 url 是否有问题。

我在开发环境下运行它，我尝试过其他浏览器/清除缓存等。控制器 NoteController 内的操作看起来像

```
public function addAction($notebook)
{

    $pageTitle = 'Note';

    $form = $this->createForm(new NoteType(), null, array(
        'validation_groups' => array('add')
    ));

    $request = $this->getRequest();

    if ($request->isMethod('POST')) {
        $form->bind($request);

        if ($form->isValid()) {

            /** @var $em \Doctrine\ORM\EntityManager */
            $em = $this->getDoctrine()->getManager();

            /** @var $note Note */
            $note = $form->getData();
            $note->setNotebook();

            $em->persist($note);
            $em->flush();

            return $this->redirect($this->generateUrl('gibbo_dummy_note_View'));
        }
    }

    return $this->render('GibboDummyBundle:Note:new.html.twig', array(
        'pageTitle' => $pageTitle,
        'form_add'  => $form->createView(),
        'selected' => 'codebooks'
    ));

} 
```

谁能阐明我可能做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-29T12:37:51.227

请添加`gibbo_dummy_note_View`路由的控制器代码。

最有可能的是，您的重定向以错误的控制器方法结束 - 没有`return`声明的方法

# entity-framework - 使用 EF6 连接到 SQL Server

> ID：15857349
> 
> 赞同：9
> 
> 时间：2013-04-06T23:59:56.197
> 
> 标签：entity-framework, entity-framework-6

在 EF5 之前，为了连接到 SQL Server 2012，我只需要指定一个如下所示的连接字符串：

```
Data Source=.\SqlExpress;Initial Catalog=MyDatabase;Integrated security=True;MultipleActiveResultSets=True 
```

此方法不适用于 EF6，出现异常

> 找不到“System.Data.Odbc”ADO.NET 提供程序的实体框架提供程序。确保提供程序已在应用程序配置文件的“entityFramework”部分中注册

我根本没有使用`app.config`文件，我将上面的连接字符串传递给 MyContext 构造函数。为什么它试图使用 Odbc 提供程序，而不是使用 System.Data.SqlClient？

使用 EF6 代码优先连接到 SQL Server 需要做什么？我确保 EntityFramework.dll 和 EntityFramework.SqlServer.dll 在 Application 文件夹中都可用。我什至在 WPF 项目中添加了 EF6 nuget 包 v6.0.0.1，尽管它不直接使用 EF 库，并确保将自动创建的 App.Config 文件（由 nuget）复制到 Application (Debug) 文件夹 - 仍然没有成功。

我还尝试在代码中手动设置提供者：

```
public class OeeCoachConfiguration : DbConfiguration
{
    public OeeCoachConfiguration()
    {
        SetProviderServices("System.Data.SqlClient",
            System.Data.Entity.SqlServer.SqlProviderServices.Instance);
    }
} 
```

仍然没有成功。我的项目结构如下（简化）：

WPF 项目 - 没有对 EF 的引用（也尝试添加 EF 引用）

ViewModel 类库 - 没有对 EF 的引用

模型类库 - 引用了 EF 库（两个 dll）

数据类库 - 引用了 UI 库（两个 dll）。

我正在使用 CodeFirst 方法，并且此设置对 EF5 没有任何问题。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-08T21:33:45.520

对我来说，这个错误是通过删除 Glimpse.ADO 包解决的

**编辑 2013 年 12 月 20 日**我相信 Glimpse.ADO 包现在支持 EF6，但我还没有测试过。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-23T12:43:27.397

我遇到了同样的问题，我最终尝试了以下方法并且它起作用了（保留 Glimpse EF5 和 Glimpse ADO 包）

在 web.config 中，我添加了现有提供程序行的副本，但将其 invariantName 更改为“System.Data.Odbc”。

```
 <entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework">
      <parameters>
        <parameter value="v11.0" />
      </parameters>
    </defaultConnectionFactory>
    <providers>
      <provider invariantName="System.Data.Odbc" type="System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer" />
      <provider invariantName="System.Data.SqlClient" type="System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer" />
    </providers>
  </entityFramework> 
```

希望这会有所帮助。

乔纳森

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-28T14:13:13.707

是的，对我来说，它是通过删除 Glimpse.ADO 和 Glimpse.EF5 nuget 包来解决的。谢谢你。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-30T10:23:40.710

选项 1：尝试在可执行项目的 app.config 中添加以下内容。

```
<entityFramework>        
    <providers>
      <provider invariantName="System.Data.SqlClient" type="System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer" />
    </providers>
  </entityFramework> 
```

选项 2：如果要使用基于代码的提供程序注册，请遵循[EF6 实体框架提供程序指南](http://msdn.microsoft.com/nl-nl/data/jj730568.aspx)

*   确保 DbConfiguration 与应用程序的 DbContext 位于同一程序集中。

# .net - 如何处理一批任务中的部分成功？

> ID：15857350
> 
> 赞同：8
> 
> 时间：2013-04-07T00:00:04.663
> 
> 标签：.net, error-handling, async-await

我有 3 个应该并行运行的任务。我需要等待所有 3 个，然后继续处理他们的结果。所以像：

```
var results = await Task.WhenAll(task1, task2, task3);
return process(results); 
```

当所有 3 个任务都成功完成时，这工作正常。但是，如果其中一个失败，我会得到一个一直冒泡的异常。这不是我想要的。如果这些任务中的任何一个抛出`InvalidOperationException`我可以继续处理，我只需要该`process`方法可以访问抛出的异常。

我意识到我可以`try...catch`在任务范围内，但这似乎不是一个黑客。除了语义不正确（任务 DID 失败 - 它不应该成功返回）之外，如果我采用这种方法，由于结果可能成功或返回异常，我将不得不返回自定义类型。然而，该`Task<T>`对象已经公开了一个异常通道，所以我宁愿不做双重职责，而只使用已经存在的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-07T00:31:46.833

您可以像下面的示例一样处理这种情况：

```
Task<T>[] tasks  = new Task<T>[] { task1, task2, task3 };

try
{
   await Task.WhenAll(tasks);
}
catch(InvalidOperationException exception) // If you need to handle any other exception do it
{
   // handle it if you wan to 
}

// You can use task1.IsFauled to know if current task failed, 
// and you can use task1.Exception to know why it failed

return process(tasks.Where(t => !t.IsFauled).ToArray()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T00:53:58.307

如果我理解正确，您正在寻找这个？

```
var tasks = new[] { task1, task2, task3 };
try { await Task.WhenAll(tasks); } catch (...) { }
return process(tasks); 
```

# java - HttpURLConnection 错误打开跟踪文件：没有这样的文件或目录

> ID：15857352
> 
> 赞同：1
> 
> 时间：2013-04-07T00:00:09.323
> 
> 标签：java, android, httpurlconnection

我正在尝试连接到一个 url 以获取地理点以在我的 android 应用程序的地图视图中绘制路线。但是，当我尝试连接到 url 以获取积分时出现此错误。

```
URL url = new URL("http://maps.google.com/maps?f=d&hl=en&saddr=59.690289,16.60868&daddr=59.6,16.60868&ie=UTF8&0&om=0&output=kml");
Log.d("log","url: " + url);
HttpURLConnection urlConnection=(HttpURLConnection)url.openConnection();          urlConnection.setRequestMethod("GET");
urlConnection.setDoOutput(true);
urlConnection.setDoInput(true);
urlConnection.connect();
Log.d("log","connected"); 
```

我的清单中有以下内容

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

我正在使用模拟器在 Mac OSX Lion 上的 eclipse 4.2.2 中运行它。

谢谢你的帮助！

**编辑**

抱歉，我遗漏了一些重要信息，这是我清单中的所有权限

```
<uses-permission android:name="com.vogella.android.locationapi.maps.permission.MAPS_RECEIVE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" /> 
```

**编辑 2**

这是完整的错误

```
04-07 00:24:46.842: E/AndroidRuntime(7280): FATAL EXCEPTION: main
04-07 00:24:46.842: E/AndroidRuntime(7280): java.lang.RuntimeException: Unable to start activity ComponentInfo{markustenghamn.sfsfum/markustenghamn.sfsfum.MapHandlerActivity}: android.os.NetworkOnMainThreadException
04-07 00:24:46.842: E/AndroidRuntime(7280):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at android.os.Looper.loop(Looper.java:137)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at android.app.ActivityThread.main(ActivityThread.java:5041)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at java.lang.reflect.Method.invokeNative(Native Method)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at java.lang.reflect.Method.invoke(Method.java:511)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at dalvik.system.NativeStart.main(Native Method)
04-07 00:24:46.842: E/AndroidRuntime(7280): Caused by: android.os.NetworkOnMainThreadException
04-07 00:24:46.842: E/AndroidRuntime(7280):     at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1117)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at java.net.InetAddress.lookupHostByName(InetAddress.java:385)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at java.net.InetAddress.getAllByNameImpl(InetAddress.java:236)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at java.net.InetAddress.getAllByName(InetAddress.java:214)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at libcore.net.http.HttpConnection.<init>(HttpConnection.java:70)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at libcore.net.http.HttpConnection.<init>(HttpConnection.java:50)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at libcore.net.http.HttpConnection$Address.connect(HttpConnection.java:340)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at libcore.net.http.HttpConnectionPool.get(HttpConnectionPool.java:87)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at libcore.net.http.HttpConnection.connect(HttpConnection.java:128)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at libcore.net.http.HttpEngine.openSocketConnection(HttpEngine.java:316)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at libcore.net.http.HttpEngine.connect(HttpEngine.java:311)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at libcore.net.http.HttpEngine.sendSocketRequest(HttpEngine.java:290)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at libcore.net.http.HttpEngine.sendRequest(HttpEngine.java:240)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at libcore.net.http.HttpURLConnectionImpl.connect(HttpURLConnectionImpl.java:81)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at markustenghamn.sfsfum.MapHandlerActivity.DrawPath(MapHandlerActivity.java:166)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at markustenghamn.sfsfum.MapHandlerActivity.callMap(MapHandlerActivity.java:126)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at markustenghamn.sfsfum.MapHandlerActivity.onCreate(MapHandlerActivity.java:89)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at android.app.Activity.performCreate(Activity.java:5104)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
04-07 00:24:46.842: E/AndroidRuntime(7280):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
04-07 00:24:46.842: E/AndroidRuntime(7280):     ... 11 more
04-07 00:24:49.343: E/Trace(7297): error opening trace file: No such file or directory (2) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T00:09:19.550

当您尝试在主应用程序线程上访问 Internet 时，您会遇到此异常。您需要在不同的线程中执行所有网络活动。您可以使用[`AsyncTask`](http://developer.android.com/reference/android/os/AsyncTask.html)来完成此操作。

这样做是为了即使有对网络的阻塞调用，应用程序也会保持响应。您可能还想在[此处](http://developer.android.com/training/articles/perf-anr.html)进一步阅读。

# php - PhpUnit Autoload.php 错误

> ID：15857354
> 
> 赞同：3
> 
> 时间：2013-04-07T00:00:14.993
> 
> 标签：php, phpunit

试图让 PHPUnit 在新安装的 Mac OS X Mountain Lion 上工作。

安装 Pear 并修复各种缺失的 PATH 变量后，我安装了 PHPUnit 包。

但是，当我尝试从命令行运行 phpunit 时，我得到：

```
PHP Fatal error:  require_once(): Failed opening required 'File/Iterator/Autoload.php' (include_path='.;/Users/shill/pear/share/pear') in /User
s/shill/pear/share/pear/PHPUnit/Autoload.php on line 64 
```

第 64 行包含

```
require_once 'File/Iterator/Autoload.php'; 
```

我检查了这个文件是否存在，在 /Users/shill/pear/share/pear

它确实包含一个名为“File/Iterator/Autoload.php”的文件夹——这令人费解。

我检查了 etc/ 中的 php.ini 是否包含指向 Pear 目录的 include_path，看看这是否是问题所在。在这个过程中，我发现 php 抱怨

```
> PHP Warning:  PHP Startup: Unable to load dynamic library
> '/usr/lib/php/extensions/no-debug-non-zts-20090626/php_curl.dll' -
> dlopen(/usr/lib/php/extensions/no-debug-non-zts-20090626/php_curl.dll,
> 9): image not found in Unknown on line 0 
```

然而，在我的 ini 文件中没有这样未注释的行。

我研究了所有这些，看起来这是一个常见问题，但我无法找到解决方法。

# php - PHP Mysql 获取

> ID：15857356
> 
> 赞同：-3
> 
> 时间：2013-04-07T00:00:20.707
> 
> 标签：php, mysql

我的 PHP 不工作。结果我什么也没得到：

我正在尝试从 MySQL 数据库中获取信息。该数据库包含一个表，其中包含四个条目，其中包含以下两行：PinNumber 和 SwitchStatus

这是数据库中的值 PinNumber = 3 SwitchStatus = 0

PinNumber = 5 开关状态 = 0

PinNumber = 6 开关状态 = 0

PinNumber = 9 开关状态 = 0

这是我尝试使用但没有成功的代码：

```
$connect = mysql_connect("localhost", "root", "root");
mysql_select_db("QuickFox");

$fetch = ("SELECT * FROM Switches"));

while($row = mysql_fetch_array($fetch))
{
echo "$row['*']";   
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T00:24:57.137

让我们分解你的代码并分析它。

首先，您的问题是您没有调用`mysql_query`获取将在`mysql_fetch_array`函数中使用的 MySQL 对象。所以你需要实现：

```
$fetch = mysql_query("SELECT * FROM Switches"); 
```

这应该清除您的错误并为您提供结果。现在谈其他事情。你有太多的右括号

```
$fetch = ("SELECT * FROM Switches"));
                                   ^ 
```

但你不需要他们开始。`$fetch = "SELECT * FROM Switches";`是可以接受的。此外，您在获取结果时不需要使用引号

```
echo "$row['*']";
     ^         ^ 
```

的使用`echo $row[];`是可以接受的，或者您可能必须使用

```
echo "{$row[]}";
      ^      ^ 
```

然而，这条线是完全错误的。返回的数组中不会有任何列`*`。是的，您说的是，`SELECT *`但数据库并没有真正返回`*`。您需要使用列返回的名称，如下所示：

```
echo $row['PinNumber']; 
```

**注意**：不要使用 MySQL_* 函数，因为它们自 PHP 5.5 起已被弃用。请改用 MySQLi_* 函数或 PDO。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T00:02:29.520

你需要先[`mysql_query`](http://php.net/mysql_query)打电话`mysql_fetch_array`。

```
$fetch = mysql_query("...");
while ($row = mysql_fetch_array($fetch))
{
    var_dump( $row );
} 
```

请注意，`mysql_*`函数已被弃用，在新代码中我建议改用[PDO](http://www.php.net/manual/en/pdo.construct.php)或[MySQLi](http://www.php.net/manual/en/mysqli.construct.php)（[哪个？](http://www.php.net/manual/en/mysqlinfo.api.choosing.php)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-07T00:02:50.647

```
$fetch = ("SELECT * FROM Switches"));   
 while($row = mysql_fetch_array($fetch))
    {
    echo "$row[*]"; 
    } 
```

尝试更改为：

```
 $fetch = "SELECT * FROM Switches";
 $fetch = mysql_query($fetch);
while($row = mysql_fetch_array($fetch))
{
  echo $row['PinNumber']." = ".$row['SwitchStatus'];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-07T00:14:33.417

```
 mysql_connect("localhost", "root", "root");
  mysql_select_db("QuickFox");

  $fetch = mysql_query("SELECT PinNumber,SwitchStatus FROM Switches");

  while(list($PinNumber,$SwitchStatus) = mysql_fetch_row($fetch)){
    echo "PinNumber = $PinNumber SwitchStatus = $SwitchStatus";   
  } 
```

# javascript - setTimeout 在页面错误的情况下停止工作？

> ID：15857357
> 
> 赞同：1
> 
> 时间：2013-04-07T00:00:22.683
> 
> 标签：javascript, jquery, ajax, playframework

我正在使用 setTimeout 刷新页面，其中 jquery 模板项将被更新。相关代码如下：

```
<script type="text/javascript"> 
         var results = JSON.parse('@svgPath'.replace(/&quot;/g,'"'));  

           window.onload = setupRefresh;

           function setupRefresh() {
             setTimeout("refreshPage();", 300); // milliseconds
            }
          function refreshPage() {

            $("#resultTemplate").tmpl(results, {
                checkLink : function(key) {
                 var linkRes = this.data[key];
                 checkFile(linkRes, callbackFunc); 
                 alert("refreshed?");
                return window.myRet;
                 }
            }).appendTo("#resultList" ); 
            }
    </script> 
```

jQuery模板：

```
<script id="resultTemplate" type="text/x-jquery-tmpl"> 
        <li> 
            {{if  $item.checkLink("link") == 1}}
                  <a href = ${link}>${type}</a> 
            {{else}}
            ${type}
            {{/if}} 
        </li> 
    </script> 
```

当我运行我的应用程序时，似乎如果链接不可用（ajax函数`checkFile(linkRes, callbackFunc);`可能导致404未找到错误，那么计时器似乎停止了。但是我希望计时器继续执行，即`refreshPage`继续被调用。我怎样才能做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:12:16.603

您令人困惑的异步代码和同步代码。您应该将 setTimeout 附加到 ajax 的 onSuccess 和 onFailure 事件的末尾。如您所写，假设 AJAX 调用将返回请求的状态。但是，由于是异步的，它将在从服务器接收到任何内容**之前返回。**

要给出一个简单的答案，即随着时间的推移会重复什么功能，您认为这`setInterval`可以解决您的问题。与执行一次不同，`setInterval`可以提供（有些问题）重复。`setTimeout`

同样，您需要在代码中建立一个模式，该模式将`setTimeout`用作 AJAX 回调中的延续。

# php - 如何在 Symfony2/Twig 中正确地从模板生成 URL

> ID：15857358
> 
> 赞同：26
> 
> 时间：2013-04-07T00:00:23.923
> 
> 标签：php, symfony, twig

我正在使用 Symfony2 并且：

我在 routing.yml 中有这个

```
_welcome:
    resource: "@AcmeBundle/Controller/"
    type:     annotation 
```

我在控制器中使用此方法：

```
/**
 * @Route("/{page}")
 */
public function staticAction($page)
{
    return $this->render('AcmeBundle:Static:'.$page.'.html.twig');
} 
```

要生成公共页面：

```
/home
/contact 
/privacy 
```

但是当我在菜单上创建网址时：

```
<a href="{{ path('_welcome', {'page': 'home'}) }}">Home</a>
<a href="{{ path('_welcome', {'page': 'contact'}) }}">Contact</a>
<a href="{{ path('_welcome', {'page': 'privacy'}) }}">Privacy</a> 
```

我 Symfony 生成这些 url：

```
…./?page=home
…./?page=contact
…./?page=privacy 
```

权利是：

```
/home
/contact
/privacy 
```

我必须做什么？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-04-07T00:08:10.950

您必须在控制器路由注释中添加路由名称，如下所示，

```
/**
 * @Route("/{page}", name="static")
 */
public function staticAction($page)
{
    // ... 
} 
```

然后，您可以使用该名称调用 twig `path`helper，

```
<a href="{{ path('static', {'page': 'home'}) }}">Home</a> 
```

# java - 解析和删除java正则表达式中的特殊字符

> ID：15857360
> 
> 赞同：1
> 
> 时间：2013-04-07T00:01:03.410
> 
> 标签：java, regex

因此，我们正在查看其他一些正则表达式帖子，但在一个实例中我们无法删除特殊情况；特殊字符在单词的开头。

我们的代码中有以下行：

```
String k = s.replaceAll("([a-z]+)[()?:!.,;]*", "$1"); 
```

其中 s 是单数词。例如，当通过分词解析句子“(hi hi hi)”，然后对每个分词执行replaceAll函数时，我们得到以下输出：

```
(hi
hi
hi 
```

我们的正则表达式中缺少什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T00:06:36.113

您可以使用更简单的方法 - 将不需要的字符替换为*空格*：

```
String k = s.replaceAll("[()?:!.,;]+", " "); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T00:08:17.020

位置很重要，因此您还需要在捕获组*之前*匹配排除的字符：

```
String k = s.replaceAll("[()?:!.,;]*([a-z]+)[()?:!.,;]*", "$1"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-07T00:10:44.477

您的替换刚刚删除了 之后的“特殊字符” `[a-z]+`，这就是`(`之前`hi`保留的原因。

如果您知道`s`是一个**单词**，您可以：

```
String k = s.replaceAll("\\W*(\\w+)\\W*", "$1"); 
```

或者

```
String k = s.replaceAll("\\W*", ""); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-12T08:26:14.573

这可以更简单

尝试这个 ：

```
String oldString = "Hi There @#$ What is %#your name?@#$@#$ 0123$$"; 
System.out.println(oldString.replaceAll("[\\p{Punct}\\s\\d]+", " "); 
```

输出：嗨，你叫什么名字 0123

所以它也接受数字。.replaceAll("[\p{Punct}\s\d]+", " "); 将替换所有使用的标点符号，其中包括几乎所有特殊字符。

# ruby-on-rails - Ruby on Rails 教程：使用匹配器重构时 RSpec 测试失败

> ID：15857361
> 
> 赞同：3
> 
> 时间：2013-04-07T00:01:15.660
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rspec, railstutorial.org

我正在阅读[Michael Hartl 的 Rails 教程](http://ruby.railstutorial.org/chapters/sign-in-sign-out#sec-rspec_custom_matchers)，并且在使用匹配器进行重构时无法通过一项 Rspec 测试。

**终端输出**

```
Failures:

  1) Authentication login with invalid information
     Failure/Error: it { should have_error_message('Invalid') }
     NoMethodError:
       undefined method `has_error_message?' for #<Capybara::Session>
     # ./spec/requests/authentication_pages_spec.rb:21:in `block (4 levels) in <top (required)>' 
```

**规范/支持/实用程序.rb**

```
RSpec::Matchers.define :have_error_message do |m|
  match do |page|
    page.should have_selector('div.alert.alert-error', text: m)
  end
end 
```

**规范/请求/authentication_pages_spec.rb**

```
require 'spec_helper'

describe "Authentication" do 

  subject { page }

  describe "login page" do
    before { visit login_path }

    it { should have_selector('h1',    text: 'Login') }
    it { should have_selector('title', text: 'Login') }
  end

  describe "login" do
    before { visit login_path }

    describe "with invalid information" do
      before { click_button "Login" }

      it { should have_selector('title', text: 'Login') }
      it { should have_error_message('Invalid') }
    end

    describe "after visiting after page" do
      before { click_link "Home" }
      it { should_not have_selector('div.alert.alert-error') }
    end

    describe "with valid information" do
      let(:user) { FactoryGirl.create(:user) }
      before { valid_login(user) }

      it { should have_selector('title', text: user.name) }
      it { should have_link('Profile', href: user_path(user)) }
      it { should have_link('Logout', href: logout_path) }
      it { should_not have_link('Login', href: login_path) }

      describe "followed by logout" do
        before { click_link "Logout" }

        it { should have_link('Login') }
      end
    end
  end
end 
```

为什么它抱怨`has_error_message?`没有在任何地方定义的方法？

## 编辑/添加：

**规范/spec_helper.rb**

```
require 'rubygems'
require 'spork'
#uncomment the following line to use spork with the debugger
#require 'spork/ext/ruby-debug'

Spork.prefork do
  # Loading more in this block will cause your tests to run faster. However,
  # if you change any configuration or code from libraries loaded here, you'll
  # need to restart spork for it take effect.
  ENV["RAILS_ENV"] ||= 'test'
  require File.expand_path("../../config/environment", __FILE__)
  require 'rspec/rails'
  require 'rspec/autorun'

  # Requires supporting ruby files with custom matchers and macros, etc,
  # in spec/support/ and its subdirectories.
  Dir[Rails.root.join("spec/support/**/*.rb")].each {|f| require f}

  RSpec.configure do |config|
    # ## Mock Framework
    #
    # If you prefer to use mocha, flexmock or RR, uncomment the appropriate line:
    #
    # config.mock_with :mocha
    # config.mock_with :flexmock
    # config.mock_with :rr
    config.mock_with :rspec

    # Remove this line if you're not using ActiveRecord or ActiveRecord fixtures
    config.fixture_path = "#{::Rails.root}/spec/fixtures"

    # If you're not using ActiveRecord, or you'd prefer not to run each of your
    # examples within a transaction, remove the following line or assign false
    # instead of true.
    config.use_transactional_fixtures = true

    # If true, the base class of anonymous controllers will be inferred
    # automatically. This will be the default behavior in future versions of
    # rspec-rails.
    config.infer_base_class_for_anonymous_controllers = false
  end
end

Spork.each_run do
  # This code will be run each time you run your specs.

end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T00:20:51.073

你在`require`整理你的`spec/support/utilities.rb`文件吗？您可能需要在`spec/spec_helper.rb`文件中使用类似的内容来实际加载定义自定义匹配器的文件：

```
Dir[Rails.root.join("spec/support/**/*.rb")].each {|f| require f} 
```

**更新：**如果您使用的是 Spork，您的`utilities.rb`文件可能会被 Spork 服务器缓存，这意味着您需要重新启动主 Spork 进程，然后 RSpec 才能使用新的匹配器（[请参阅](https://github.com/sporkrb/spork/wiki/Troubleshooting#some-changes-to-files-dont-take-effect-until-i-restart-spork)Spork wiki 上的详细信息）。

[有些人](https://github.com/sporkrb/spork/wiki/Spork.trap_method-Jujitsu#machinist)使用这个技巧来强制 Spork 总是重新加载支持文件：

```
Spork.each_run do
  Dir[Rails.root.join("spec/support/**/*.rb")].each {|f| require f}
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-07T00:55:22.903

如果您使用的是 Capybara 或 RSpec 的更高版本（即不是教程中明确指定的版本），如果我没记错这些自定义匹配器的编写方式需要更改（尽管我可能错了）不过，尝试改变你的方法

```
RSpec::Matchers.define :have_error_message do |m|
  match do |page|
    page.should have_selector('div.alert.alert-error', text: m)
  end
end 
```

到：

```
RSpec::Matchers.define :have_error_message do |m|
  match do |page|
    page.has_selector?('div.alert.alert-error', text: m)
  end
end 
```

然后，这将有望使您能够编写测试，例如：

```
it { should have_error_message("Invalid") }
it { should_not have_error_message("Invalid") } 
```

我有一个类似的问题，我在[这个 StackOverflow Q&A](https://stackoverflow.com/q/13573525/567863)中概述了。

# php - Laravel：如何将请求重定向到控制器功能并同时使用 View::make？

> ID：15857362
> 
> 赞同：1
> 
> 时间：2013-04-07T00:01:32.767
> 
> 标签：php, laravel, laravel-3

```
**Route**
Route::get('admin', function()
{
     return View::make('theme-admin.main');
});

**Controller**
class Admin_Controller extends Base_Controller {

public function action_index()
{
    echo __FUNCTION__;
} 
```

如果我将请求转发给控制器，那么我必须`View::make`在控制器的每个函数中定义。如果我不转发它，它就`action function`不起作用。

我应该将请求转发给控制器并使用`View::make`内部操作功能还是有更好的选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T08:27:42.593

实际上没有必要`View::make`在控制器的每个功能中定义。

例如，您可以执行一个动作，然后重定向到另一个动作，这可以`View::make`.

假设您要创建一个用户，然后以 RESTful 方式显示其个人资料。你可以这样做：

```
# POST /users
public function user_create()
{
    $user = User::create(...);

    // after you have created the user, redirect to its profile
    return Redirect::to_action('users@show', array($user->id));

    // you don't render a view here!
}

# GET /users/1
public function get_show($id)
{
    return View::make('user.show');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-07T17:12:26.500

你可以像这样调用控制器函数

```
$app = app();
$controller = $app->make('App\Http\Controllers\EntryController');
return $controller->callAction('getEntry', $parameters = array()); 
```

或者您可以简单地将请求发送到另一个控制器 url

```
$request = \Request::create(route("entryPiont"), 'POST', array()));
return \Route::dispatch($request); 
```

# ruby-on-rails - 黄瓜上的步骤定义在 Ruby on Rails 上找不到路径

> ID：15857363
> 
> 赞同：2
> 
> 时间：2013-04-07T00:01:39.593
> 
> 标签：ruby-on-rails, routes, cucumber

使用 Ruby on Rails 并且我正在编写步骤定义以便我可以运行 cucumber。但是，我有一个访问页面的一般定义，而黄瓜找不到我给它的路径：

```
Can't find mapping from "the Brainstormy home index page" to a path. 
```

这是步骤定义：

```
Given /^(?:|I )am on (.+)$/ do |page_name|
  visit path_to(page_name)
end 
```

这是场景：

```
Scenario: Sign up for Brainstormy

Given I am on the Brainstormy home index page
When I fill in "firstName" with "John"
And I fill in "lastName" with "Adams"
And I fill in "email" with "jadams@gmail.com"
And I fill in "email2" with "jadams@gmail.com"
And I fill in "password" with "spot1234"
And I fill in "password2" with "spot1234"
And I press "Sign Up"
Then I should be on the profile page 
```

我的路线：

```
home_index        /home/index(.:format)     home#index
root              /                         home#index 
```

我的路线.rb：

```
root :to => 'home#index'
resources :ideas
resources :users

#root :to => redirect('/home/index')
match 'home/index' => 'home#index'
match 'users/new' => 'users#new' 
```

问题是，我没有写定义。我从一个工作应用程序中得到它，基本上反映了他们所做的事情。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T00:20:25.910

查看`path_to`方法内部。这将是从人类可读字符串到 URL 的某种映射。您必须添加一个映射`"Brainstormy home index page"`以转到您想要的任何 URL。如果您需要其他帮助，`path_to`请在帖子中包含该方法。

# java - 无需通过多层传递配置对象即可访问 hadoop 配置设置

> ID：15857367
> 
> 赞同：1
> 
> 时间：2013-04-07T00:02:32.363
> 
> 标签：java, configuration, hadoop, config, system-properties

在我正在处理的 hadoop 项目中，我需要访问 hadoop`Configuration`对象中的设置。但是，我只需要在 reducer 中设置很多很多层，而且我真的不想仅仅为此目的通过这么多构造函数传递`Context`or对象。`Configuration`

有没有一种方法可以在不通过减速器和需要它的实际类之间的所有内容的情况下以某种方式访问​​此设置？

我想到的一个可能的解决方案是在reducer 开始时将配置设置设置为java 系统属性，这样我就可以使用它来访问它，`System.getProperty()`但我想知道是否有任何更简洁的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:17:59.587

如果它们都在同一个 JVM 中，您可以在 reducer 的 setup() 方法中设置一个静态类变量……或任何其他适当的类。

# c# - C# 嵌入式 smtp 服务器

> ID：15857372
> 
> 赞同：1
> 
> 时间：2013-04-07T00:03:34.913
> 
> 标签：c#, .net, smtp

我正在尝试找到为使用 .NET API 接收邮件提供嵌入式轻量级 SMTP 服务器的库。我正在寻找的功能：事件（例如 OnReceived）、基本配置（端口、域）、MIME 解析（便于主题或消息正文检索）。我发现的唯一可行的解​​决方案是 Rnwood.SmtpServer，它不提供 MIME 解析，并且在某些电子邮件上随机崩溃。我还遇到了多种解决方案，例如 Papercut 和 netDumbster，它们用于测试目的，因此没有我需要的一切。有什么我错过的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T12:56:24.117

我最终使用了带有稍微修改的源代码并添加了事件支持的 netDumbster。可在此处获取[https://github.com/Inkp/netDumbster](https://github.com/Inkp/netDumbster)。到目前为止，它一直在工作，没有任何重大问题。不过，它仍然缺少完整的 MIME 解析器。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-09-23T21:29:38.340

Rnwood.SmtpServer + SharpMimeTools。

查看 Rnwood.Smtp4Dev 项目，了解如何使用 SharpMimeTools 库提取所有内容。

# imacros - 无法访问死对象，imacros

> ID：15857373
> 
> 赞同：1
> 
> 时间：2013-04-07T00:04:09.353 标记“现在”
> 
> 标签：imacros

我在使用 imacros 时遇到以下错误

```
 URL GOTO=http://www.tblog.com/blog_admin/addpost.php?view=full
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:post_form ATTR=NAME:ititle CONTENT={{!VAR1}}
TAG POS=1 TYPE=IMG ATTR=ID:mce_editor_0_code
TAB T=2
FRAME F=0
TAG POS=1 TYPE=TEXTAREA FORM=NAME:source ATTR=ID:htmlSource CONTENT={{!VAR8}}
TAG POS=1 TYPE=INPUT:BUTTON FORM=NAME:source ATTR=ID:insert
TAG POS=1 TYPE=INPUT:SUBMIT FORM=NAME:post_form ATTR=NAME:publish&&VALUE:Publish<SP>This<SP>Post! 
```

TypeError：无法访问死对象，行：9（错误代码：-1001）

如果有人可以帮助这里有一些日志记录详细信息帐户：lugartecnologico52 密码：1234

该网站是 tblog.com

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T03:38:44.563

我们需要打开一个空白选项卡来解决此错误。要遵循的步骤

1.  打开标签
2.  添加这些命令 Tab T=2 Tab T=1
3.  运行宏

如有任何疑问，请告诉我

# jquery - 单击jquery插件时垂直滑块推送和滑动内容

> ID：15857376
> 
> 赞同：1
> 
> 时间：2013-04-07T00:04:37.813
> 
> 标签：jquery, plugins, slider

有谁知道 jQuery 插件可以在点击时上下滑动内容并向上或向下推送内容？如果用户单击#nav-1，则向上滑动#slide-1（向下推#slide-2 和/或3），如果用户单击#nav-2，则向上或向下滑动#slide-2（取决于是3 还是1处于活动状态），如果用户单击#nav3，则向上滑动#slide-3。我找不到适用于我的应用程序的应用程序......谢谢

```
 <div id="vertical-slider" class="vertical-slider clearfix">
                <div class="slider-nav">
                    <a href="#" class="slide-1">
                        <span id="nav-1" ></span>
                        <span id="nav-2" class="active"></span>
                        <span id="nav-3"></span>
                    </a>
                </div>

                <div class="slides">
                    <div id="slide-1" class="slide ">
                        <h2>Hi, I'm sdf.</h2>
                        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus mattis, massa vitae ultricies consectetur, tellus erat bibendum felis, vel rhoncus est metus nec mauris. Aliquam id iaculis erat.</p>
                        <p>Phasellus facilisis, turpis feugiat vehicula cursus, mi augue interdum enim, in tincidunt nulla velit vel diam. Nam hendrerit lobortis dolor sit amet imperdiet. Morbi leo risus, lobortis fringilla tempor ut, venenatis vel ipsum. </p>
                    </div>

                    <div id="slide-2" class="slide active">
                        <h2>This is the slide heading</h2>
                        <ul>
                            <li>This is a list item</li>
                            <li>This is a list item</li>
                        </ul>
                        Sample link that <a href="#" title="">goes nowehere</a>.
                    </div>

                    <div id="slide-3" class="slide">
                        <h2>Get in Touch!</h2>

                        <div class="connect-icons clearfix">
                            <div class="row email">
                                <span></span><a href="#">jdoe@asdf</a>
                            </div>
                            <div class="row linkedin">
                                <span></span>Connect via <a href="#" title="LinkedIn">LinkedIn</a>
                            </div>
                            <div class="row phone">
                                <span></span><a href="#">(877) 302-2393</a>
                            </div>
                            <div class="row vcard">
                                <span></span>Download <a href="#">vCard</a>
                            </div>
                            <div class="row fax">
                                <span></span>(877) 302-2300
                            </div>
                            <div class="row pdf">
                                <span></span>Download <a href="#">Bio (pdf)</a>
                            </div>
                            <div class="row twitter">
                                <span></span><a href="#">Twitter</a>
                            </div>
                        </div> 
```

# java - Java 新手并出现错误“无法取消引用 int”

> ID：15857377
> 
> 赞同：5
> 
> 时间：2013-04-07T00:04:53.970
> 
> 标签：java

我是 java 新手，我一直在做这个练习，但一直收到错误：不能取消引用 int。我看到了几个类似的问题，但仍然无法弄清楚我自己的情况。这是完整的代码：

```
package inclass;

class OneInt {
  int n;

  OneInt(int n) {
    this.n = n;
  }

  @Override public boolean equals(Object that) {
    if (that instanceof OneInt) {
        OneInt thatInt = (OneInt) that;
        return n.equals(thatInt.n); // error happens here
    } else {
        return false;
    }
  }

  public static void main(String[] args) {
    Object c = new OneInt(9);
    Object c2 = new OneInt(9);
    System.out.println(c.equals(c2));
    System.out.println(c.equals("doesn't work"));
  } 
} 
```

非常感谢你帮我解决了这个小麻烦。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-07T00:06:41.710

`equals`是一个类的方法。`int`是一个原始的，而不是一个类。只需使用`==`：

```
return n == thatInt.n; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-07T00:06:38.860

要比较`int`s，只需使用`==`运算符：

```
if (n == thatInt.n) 
```

请注意，这`int`不是一个类，因此您*永远不能*将`.`运算符与`int`变量一起使用。

# javascript - 检测对象是否在javascript中更改

> ID：15857378
> 
> 赞同：2
> 
> 时间：2013-04-07T00:05:07.257
> 
> 标签：javascript

我有一个每 1 秒调用一次的函数。

```
var latestObject; //this updated separately, it depends on user input so it may not be different every second
var previousObject;
function Tick(object) {
    if (latestObject !== previousObject) { //Problem is here
        previousObject = latestObject; //or here
        //do stuff with latestObject;
    }
} 
```

但是，当`latestObject`更新它的属性时，变量不会设置为不同的对象。所以 previousObject 和 latestObject 总是相等的，`do stuff`永远不会发生。

我可以：

```
function Tick(object) {
    var latestObjectString = JSON.stringify(latestObject);
    if (latestObjectString !== previousObject) { //Problem is here
        previousObject = latestObjectString; //or here
        //do stuff with latestObject;
    }
} 
```

但是我`JSON.stringify`每秒做一次，这似乎效率低下，特别是因为 latestObject 很大而且很深。

将previousObject 设置为latestObject 的副本不是更好吗，这样当latestObject 上的属性发生更改时，previousObject 保持不变，然后这只发生在对象不同的情况下，而不是每秒发生一次？但是不会有一个`copyOfObject == Object`永远不会发生的问题吗？

（对象主要是属性，但有一些永远不会改变的功能）。

（没有 jQuery）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:06:42.397

## 问题描述

这里的问题确实与这样一个事实有关，即同一个对象被分配给两个不同的变量。即使你在一个地方改变它，另一个地方也会改变它。

这个例子向你展示了真正发生的事情（jsFiddle：http: [//jsfiddle.net/tadeck/4hFC2/](http://jsfiddle.net/tadeck/4hFC2/)）：

```
var objA = {'a':10, 'b': 20};
var objB = objA; // same instance assigned to both names
objB.a = 30; // instance is modified, its "a" property is changed
// now, both objA.a and objB.a show "30", as objA and objB is the same instance 
```

然而，拥有两个不同的对象也不是那么理想，因为比较它们并非易事（这里的证明：http: [//jsfiddle.net/tadeck/GN2m4/](http://jsfiddle.net/tadeck/GN2m4/)）。

## 解决方案编号 1.比较对象

要解决这个问题：

1.  您需要使用两个不同的对象（例如，通过使用类似于 jQuery 的一些解决方案`.extend()`从现有对象构造新对象）。您目前使用不必要的序列化来实现该部分。
2.  您需要以更复杂的方式比较它们（非常通用的解决方案在这里：[https](https://stackoverflow.com/a/1144249/548696) ://stackoverflow.com/a/1144249/548696 ）。

与此相比，您的解决方案可能看起来不那么复杂（至少在代码方面）。我建议使用一些[JS性能测试](http://jsperf.com/)来找出，这更合理。[`JSON.stringify()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/stringify)并不总是本机支持，因此它可能会做同样复杂的事情（并且消耗资源），就像我提到的替代解决方案一样。

## 解决方案编号 2\. 解决检测变化的整体问题

另一种选择是重建您的脚本并使用例如。用于将对象标记为由用户输入更改的标志。这将为您节省每秒处理整个对象的时间，并可能带来巨大的效率提升。

在这种情况下，您需要做的事情是：

1.  每当用户更改对象的某些部分时，在您的用户输入处理程序中设置标志，
2.  或者，您可以首先将特定值与原始对象进行比较（如果用户快速更改它然后恢复更改，只需将该值标记为未更改），
3.  为了限制更改对象的处理，您甚至可以标记哪些属性已更改（因此您只处理这些属性，不处理其他），

要实现此解决方案的一部分，您甚至可以使用[JavaScript setter 和 getter，如 John Resig 所述](http://ejohn.org/blog/javascript-getters-and-setters/)。

但是，正如我所提到的，它可能需要重建您的脚本（我们还没有看到，所以我们不能说它是否有必要或者它可以很容易地应用）。

# osx-mountain-lion - 多个自制软件安装 - 不推荐但最好的解决方案？

> ID：15857379
> 
> 赞同：2
> 
> 时间：2013-04-07T00:05:17.063
> 
> 标签：osx-mountain-lion, homebrew

我在 OSX，10.8.3，广告使用自制软件。我想知道是否可以安装多个实例。我有默认的 /usr/local/ 安装，但希望有一个完全独立的版本，我可以在其中测试包和不同的安装，而不会搞砸我在 /usr/local/ 中的基本安装，效果很好。

我阅读了 wiki 以及有关安装到 ~/(.)homebrew 然后将“brew”符号链接到 /usr/local/ 的所有内容，但我想这会与我在该目录中的当前安装冲突。

我不介意，并意识到我将不得不改变我的项目以使用不同的自制路径，但如果有人这样做并有一些建议，我将不胜感激。

imo 仍然没有很好的方法来清理公式的依赖关系，尽管肯定已经取得了进展。我知道不建议这样做，但我想安装一个“测试”自制软件，我可以在其中安装一两个快速任务所需的各种临时包并删除。我感谢任何和所有的建议，所以如果你有任何可能有帮助的东西，请告诉我。

干杯并感谢 SO 社区！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T04:40:54.913

我建议使用虚拟机作为测试平台，而不是备用自制软件安装路径。VM 设置有几个优点：

*   Homebrew 仍然可以在其首选的、受支持的路径中运行。
*   您可以确切地看到您的公式更改将对“正常”安装产​​生什么影响。
*   您仍然可以安全地使用损坏的、不可重定位的公式。
*   保证文件不会从您的备用路径泄漏并破坏主 Homebrew 安装或其他内容，就像您的公式中有错误一样
*   您可以使用 VM 快照来提供干净的基线，并还原到它们以放弃任何更改或错误。
*   您可以制作*一堆*备用设置，而不仅仅是一两个，而且它们都是独立的。
*   您可以进行最小安装以隔离变量并减少交互。
*   您甚至可以使用其他操作系统版本运行它们。
*   你可以毫无顾忌地处理可怕的低级东西，比如内核扩展。
*   您可以将整台机器交给合作者，这样他们就可以准确地了解您的测试内容所在的上下文。
*   这是学习如何自动化和模块化机器设置和配置的好习惯，它将使您的代码和部署过程更好。
*   等等等等

我将 VM 用于我所有的 Homebrew 开发工作，它*很棒*。我再也不会在没有虚拟机的情况下从事面向部署的工作了。Parallels 很好，恕我直言，完全物有所值，或者您可以免费获得 VirtualBox。

要在实例之间获取您的开发代码，您可以使用`git`或其他版本控制来随机播放它们，或挂载虚拟共享驱动器，或两者兼而有之。

# python - 从文件夹中打开多个 python 文件

> ID：15857380
> 
> 赞同：2
> 
> 时间：2013-04-07T00:05:48.000
> 
> 标签：python, biopython

我正在尝试使用一个包含 9 个文件的文件夹，每个文件都包含不同基因的 FASTA 记录，并删除重复记录。我想设置它，以便使用包含基因的文件夹作为第一个参数调用脚本，并使用新文件夹名称来重写新文件而不重复。但是，如果文件存储在当前目录中名为 results 的文件夹中，则不允许我打开该文件夹中的任何基因文件来处理它们的重复项。我四处搜索，似乎我应该能够使用这样的文件名字符串调用 python 的 open() 函数：

`input_handle = open(f, "r")`

此行不允许我打开文件来读取其内容，我认为这可能与 f 的类型有关，当我调用 type(f) 时显示为 type 'str'

另外，如果我使用完整路径：

`input_handle = open('~/Documents/Research/Scala/hiv-biojava-scala/results/rev.fa', "r")`

它说不存在这样的文件。我检查了我的拼写，我确定该文件确实存在。如果我尝试将其名称称为原始字符串，我也会得到该文件不存在：

`input_handle = open(r'~/Documents/Research/Scala/hiv-biojava-scala/results/rev.fa', "r")`

或者，如果我尝试将其称为以下内容，则表示不存在全局结果：

`input_handle = open(os.path.join(os.curdir,results/f), "r")`

这是完整的代码。如果有人知道问题出在哪里，我将非常感谢您提供的任何帮助。

```
#!/usr/bin/python
import os
import os.path
import sys
import re
from Bio import SeqIO

def processFiles(files) :
    for f in files:
             process(f)

def process(f):
    input_handle = open(f, "r") 
    records = list(SeqIO.parse(input_handle, "fasta"))
    print records 
    i = 0
    while i < len(records)-1:
            temp = records[i]
            next = records[i+1]
            if (next.id == temp.id) :
                    print "duplicate found at " + next.id
                    if (len(next.seq) < len(temp.seq)) :
                            records.pop(i+1)
                    else :
                            records.pop(i)
            i = i + 1

    output_handle = open("out.fa", "w")
    for record in records:
            SeqIO.write(records, output_handle, "fasta")

    input_handle.close()

def main():
    input_folder = sys.argv[1]
    out_folder = sys.argv[2]
    if os.path.exists(out_folder):
            print("Folder %s exists; please specify empty folder or new one" %          out_folder)
            sys.exit(1)
    os.makedirs(out_folder)
    files = os.listdir(input_folder)
    print files
    processFiles(files)     

main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T00:54:33.063

试试`input_handle = open(os.path.join(os.getcwd,results/f), "r")`。`os.curdir`返回`.`请参阅 mail.python.org/pipermail/python-list/2012-September/631864.html。

# c# - 如何在我的方法中传递泛型类，以便此代码可重用

> ID：15857381
> 
> 赞同：0
> 
> 时间：2013-04-07T00:05:50.003
> 
> 标签：c#, generics

每次我需要传递一个新的页面类时我调用的类我必须构建一个新的构造函数，我知道泛型会解决这个问题。有人可以告诉我如何做到这一点吗？

```
 public class CheckUserAuthentication
    {
        private Page1 _p1;   
        private Page2 _p2;

        public CheckUserAuthentication(Page1 p1)
        {
            _p1 = p1;
        }

        public CheckUserAuthentication(Page2 p2)
        {
            _p2 = p2;
        }

  public void AuthenticateUser(out Person person, out Animal animal) 
        {
           If(_p1 != null)
             {
            _p1.Response.Write("writes to P1 page");

             }
            else
             {
             _p2.Response.Write("writes to P2 page");
             }
        }
    } 
```

我的第 1 页的呼叫代码

```
public Page1()
{
    _checkUserAuthentication = new CheckUserAuthentication(this);
}

public CheckUserAuthentication CheckUserAuthentication
{
    get { return _checkUserAuthentication; }
}

CheckUserAuthentication.AuthenticateUser(out person, out animal); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:51:07.000

最好使用接口：

```
public interface IPage {
    public HttpResponse Response { get; set; }
}

public class Page1 : IPage {
}

public class Page2 : IPage {
}

public class CheckuserAuthentication {
    private IPage _page;

    public CheckuserAuthentication(IPage page) {
        _page = page;
    }

    public void AuthenticateUser(out Person person, out Animal animal) {
        _page.Response.Write("Doesn't matter what page it writes to.. it will write to whatever you pass in..");
    }
} 
```

# prolog - 删除列表中的第一个出现 - prolog

> ID：15857382
> 
> 赞同：4
> 
> 时间：2013-04-07T00:05:57.923
> 
> 标签：prolog

我只需要删除列表中的一个事件。其实不管是第一个还是最后一个。需要删除一场比赛。

我无法理解为什么以下内容无法按预期工作。

```
deleteOne(_,[],[]).

deleteOne(Term, [Term|Tail], Result) :- 
    deleteOne(Term, [], [Result|Tail]), !.

deleteOne(Term, [Head|Tail], [Head|TailResult]) :- 
    deleteOne(Term, Tail, TailResult), !. 
```

**输出**

```
41 ?- deleteOne(5,[2,3,1,5,2,3,1],X).
X = [2, 3, 1, 5, 2, 3, 1]. 
```

当我用空字符串或一些随机字符串替换术语时，它会起作用。

```
 deleteOne(Term, [Term|Tail], Result) :- 
    deleteOne("", Tail, Result), !. 
```

**输出**

```
41 ?- deleteOne(5,[2,3,1,5,2,3,1],X).
X = [2, 3, 1, 2, 3, 1]. 
```

但由于许多原因，我认为这不是最好的解决方案。不是针对我当前的问题，而是针对更长的列表。或者如果一个列表包含空字符串 - 不知道这在 Prolog 中是否可行。

为什么第一个示例不起作用？还有哪些其他解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T00:14:21.423

你的第一个不起作用，因为这没有多大意义：

```
deleteOne(Term, [Term|Tail], Result) :- 
    deleteOne(Term, [], [Result|Tail]), !. 
```

这意味着下一个结果必须以当前结果为中心。

更好的解决方案是：

```
delete_one(_, [], []).
delete_one(Term, [Term|Tail], Tail).
delete_one(Term, [Head|Tail], [Head|Result]) :-
  delete_one(Term, Tail, Result). 
```

如果您希望它具有决定性，请在第二个子句上添加一个cut。照原样，它可以这样做：

```
?- delete_one(2, [1, 2, 3, 1, 2, 3], X).
X = [1,3,1,2,3] ? ;
X = [1,2,3,1,3] ? ;
X = [1,2,3,1,2,3] ? ;    
no 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-29T14:39:18.690

要从列表 L 中仅删除第一次出现的项目 X。这里我使用了剪切操作。

```
delete(X,[X|T],T):-!.
delete(X,[Y|T],[Y|T1]):-delete(X,T,T1). 
```

# nlp - 准确度：ANNIE vs Stanford NLP vs OpenNLP with UIMA

> ID：15857384
> 
> 赞同：17
> 
> 时间：2013-04-07T00:06:12.560
> 
> 标签：nlp, stanford-nlp, opennlp, gate, uima

我的工作是计划使用 UIMA 集群来运行文档以提取命名实体等等。据我了解，UIMA 打包的 NLP 组件很少。我已经测试 GATE 有一段时间了，并且对它相当满意。它在普通文本上没问题，但是当我们通过一些有代表性的测试数据运行它时，准确性会下降很多。我们内部拥有的文本数据有时全大写，有时全小写，或在同一文档中混合使用两者。即使使用 ANNIE 的全部大写规则，准确性仍然有很多不足之处。我最近听说过斯坦福 NLP 和 OpenNLP，但还没有时间对它们进行广泛的训练和测试。这两者在准确性方面与 ANNIE 相比如何？他们是否像 GATE 一样与 UIMA 合作？

提前致谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-17T14:27:26.847

对这些系统的性能进行一般估计是不可能/不合理的。正如您所说，在您的测试数据上，准确性会下降。这有几个原因，一个是您的文档的语言特征，另一个是您希望看到的注释的特征。对于每个 NER 任务，Afaik 都有相似但仍然不同的注释指南。

话虽如此，关于您的问题：

ANNIE 是我能找到的唯一一个免费的开源基于规则的 Java NER 系统。它是为新闻文章而写的，我猜它是为 MUC 6 任务而调整的。这对概念证明很有用，但有点过时了。主要优点是您可以在没有任何机器学习、nlp 或一点 java 知识的情况下开始改进它。只需研究 JAPE 并试一试。

OpenNLP、Stanford NLP 等默认带有新闻文章模型，并且性能（仅查看结果，从未在大型语料库上测试它们）比 ANNIE 更好。比起 OpenNLP，我更喜欢斯坦福解析器，我还是只看文档，主要是新闻文章。

在不知道你的文件是什么样子的情况下，我真的不能说更多。您应该决定您的数据是否适合规则，或者您采用机器学习方式并使用 OpenNLP 或斯坦福解析器或[伊利诺伊标记器](http://cogcomp.cs.illinois.edu/page/software_view/NETagger)或其他任何东西。斯坦福解析器似乎更适合仅倾倒您的数据、训练和产生结果，而 OpenNLP 似乎更适合尝试不同的算法、使用参数等。

对于您在 UIMA 上的 GATE 争议，我尝试了这两种方法，并为 GATE 找到了更多病毒社区和更好的文档。不好意思发表个人意见：）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-12-22T15:36:26.310

只是为了回答 UIMA 角度的记录：对于斯坦福 NLP 和 OpenNLP，都可以通过[DKPro Core 项目](https://dkpro.github.io/dkpro-core/)获得出色的 UIMA 分析引擎封装。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-06-05T19:16:13.103

我想再添加一个注释。UIMA 和 GATE 是用于创建自然语言处理 (NLP) 应用程序的两个框架。但是，名称实体识别 (NER) 是一个基本的 NLP 组件，您可以找到独立于 UIMA 和 GATE 的 NER 实现。好消息是你通常可以在 UIMA 和 GATE 中找到一个不错的 NER 包装器。为了清楚起见，让我们看看这个例子：

*   [OpenNLP NER](https://gist.github.com/johnmiedema/4020deea875ce306971e)
*   [GATE 中 OpenNLP NER 的包装器](https://gate.ac.uk/sale/tao/splitch23.html#x28-58200023.25)

*   [UIMA 中 OpenNLP NER 的包装器](https://code.google.com/p/dkpro-core-asl/wiki/ComponentList_1_6_2#Named_Entity_Recognition)

斯坦福 NER 组件也是如此。

回到您的问题，该网站列出了最先进的 NER： [http://www.aclweb.org/aclwiki/index.php?title=Named_Entity_Recognition_(State_of_the_art)](http://www.aclweb.org/aclwiki/index.php?title=Named_Entity_Recognition_(State_of_the_art))

例如，在 MUC-7 比赛中，名为 LTG 的最佳参赛者以 93.39% 的准确率获得了结果。

[http://www.aclweb.org/aclwiki/index.php?title=MUC-7_(State_of_the_art)](http://www.aclweb.org/aclwiki/index.php?title=MUC-7_(State_of_the_art))

请注意，如果您想使用这种状态的实现，您可能会遇到他们的许可证问题。

# ios - MPMusicPlayerController 在 iPod 5g 上是否正常工作？

> ID：15857390
> 
> 赞同：1
> 
> 时间：2013-04-07T00:06:43.887
> 
> 标签：ios, mpmusicplayercontroller

我正在为 iOS 开发一个应用程序，它以两种不同的模式工作，其中一种播放 iPod 库中的音乐，另一种合成声音（例如：纯音）。

为了合成声音，我使用了一个音频单元，所以通过它的回调我可以传递所需的信号。至于必须以特定音量播放声音，我使用 iPodMusicPlayer 设置设备音量。

我看到的问题是应用程序在打开后第一次在iPod Touch 5g上运行时，一旦使用iPodMusicPlayer设置设备的音量，applicationMusicPlayer将不会响应停止。

我想出了以下代码。开机后在iPod Touch 5g上运行，点击停止后音乐不会停止。

```
@implementation ViewController

- (void)viewDidLoad
{
   [super viewDidLoad];

   MPMusicPlayerController *mp = [MPMusicPlayerController iPodMusicPlayer];
   mp.volume = 0.3;
}

- (void)didReceiveMemoryWarning
{
   [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (IBAction)playAction:(id)sender {
   MPMusicPlayerController *mp = [MPMusicPlayerController applicationMusicPlayer];
   MPMediaQuery *query = [MPMediaQuery songsQuery];
   [mp setQueueWithQuery:query];
   [mp play];
}

- (IBAction)stopAction:(id)sender {
   MPMusicPlayerController *mp = [MPMusicPlayerController applicationMusicPlayer];
   [mp stop];
}

@end 
```

PS：也可以通过进入音乐应用程序，退出它（双击home键并从多任务栏退出音乐），最后运行上面的代码来重现问题。

在迄今为止我测试过的其他设备（iPad 第 2 代和第 3 代，iPod Touch 4 代）中，该应用程序运行良好。

提前致谢。

# javascript - 将附加信息传递到事件处理程序

> ID：15857393
> 
> 赞同：1
> 
> 时间：2013-04-07T00:07:10.970
> 
> 标签：javascript, event-handling, jquery

我有一个事件处理程序，当单击选择框中的选项时执行。

```
$('#my-select').live('change', function(evt) {
    ....
}); 
```

有没有办法将 Ctrl 键的状态（按下/未按下）传递给事件处理程序？evt 不包含此信息，因为所有与键相关的属性都未定义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:31:04.143

# `change`事件和用于输入值的键

该`change`事件不是具有关联键的东西。请阅读 jQuery 的`.change()`文档：

> 当元素的值改变时，change 事件被发送到元素。此事件仅限于元素、框和元素。对于选择框、复选框和单选按钮，当用户使用鼠标进行选择时会立即触发该事件，但对于其他元素类型，该事件会延迟到元素失去焦点为止。

这个例子是这样的：

1.  你有一些输入字段。
2.  您在字段中输入“ `some name`”文本。
3.  在进入其他领域之前，您决定将其更改为“ `some test`”，例如。通过按几次退格键，然后导航到下一个字段（例如，通过使用`Tab`键，或通过点击`Next`iOS 键盘等），
4.  当`onchange`您导航到其他字段时（或者更确切地说，一旦字段失去焦点）就会触发事件处理程序，因此有关用于输入值的所有键的信息非常不相关。

# 使用`keypress`事件的解决方案

要解决这个问题，您需要使用`keypress`事件来实现您的解决方案，例如。感谢 jQuery 的[`.keypress()`功能](http://api.jquery.com/keypress/)。在这种情况下，事件对象的`ctrlKey`属性（例如[在此处](http://api.jquery.com/category/events/event-object/)列出）让您了解`Ctrl`密钥的状态。示例用法在这里：[https ://stackoverflow.com/a/4604093/548696](https://stackoverflow.com/a/4604093/548696)

# 用于保存键`keypress`/ `keydown`/`keyup`并继续阅读的演示`change`

可在此处获得：

[http://jsfiddle.net/tadeck/vPu94/](http://jsfiddle.net/tadeck/vPu94/)

该演示清除记录的焦点键，将它们保存在每个`keypress`事件中（您可以轻松地对其进行编辑并测试不同的情况）并在`change`触发事件时读取它们（并在屏幕上输出）（因此当更改的字段离开焦点时）。

# javascript - 如何让 jQuery 在管理区域工作？

> ID：15857397
> 
> 赞同：1
> 
> 时间：2013-04-07T00:07:46.287
> 
> 标签：javascript, jquery, wordpress, twitter-bootstrap, wordpress-theming

我在 WordPress 的主题选项页面中包含了 Twitter Bootstrap，以帮助设置主题选项页面的样式。之前，当我取消注册 jQuery 并添加我自己的版本时，所有代码都`$`在`jQuery`使用`$`. .

不幸的是，您不应该取消注册 jQuery，即使它只在您自己的管理页面上完成。

所以我四处寻找一些仍然`$`在 jQuery 中使用的方法并写了这个：

```
(function($){   
    $(document).ready(function(){
        $('.posts').click(function(){
            if ($(this).attr("id") == "list"){
                $('.sectionLists').show();
            } else {
                $('.sectionLists').hide();
            }
        });
});
})(jQuery); 
```

没有控制台错误 - 在我的代码中，但我的 Twitter Bootstrap Javascript 相关函数都不起作用，例如 Popovers、Tabs 或其他任何类似性质的函数，并且上面的代码甚至不起作用。

但是，如果我将它粘贴到 Chrome 控制台并按 Enter 键，它会正常工作。

这是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:26:58.880

您可能正在尝试在加载 jQuery 之前调用它——这就是它在页面中不起作用但在控制台中起作用的原因。

您是否添加了如下所示的 jQuery 依赖项，如 Codex 中所示[`wp_enqueue_script`](http://codex.wordpress.org/Function_Reference/wp_enqueue_script)？

```
function iamb_inc_bootstrap() {

    wp_register_script(
        'js_bootstrap',
        get_template_directory_uri() . '/bootstrap/js/bootstrap.min.js',
        array('jquery'),
        '20130219',
        true
    );

    wp_enqueue_script('js_bootstrap');
}
add_action('wp_enqueue_scripts', 'iamb_inc_bootstrap'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T01:49:35.837

忽略将脚本和样式表排入队列的[正确方法](http://codex.wordpress.org/Plugin_API/Action_Reference/admin_enqueue_scripts)，我总是这样做：

```
add_action( 'admin_footer', 'wpse_46677_change_menu_item' );

function wpse_46677_change_menu_item()
{
    ?>
        <script type="text/javascript">
            jQuery(document).ready( function($) {
                $( "#menu-appearance" )
                    .find( "li:contains( 'Header' )" )
                    .html( '<a href="themes.php?page=custom-header">My Text</a> ');
            });     
        </script>
    <?php
} 
```

[从[这个 WordPress 答案](https://wordpress.stackexchange.com/a/67972/12615)。]

# java - 将日期文本更改为日期

> ID：15857398
> 
> 赞同：2
> 
> 时间：2013-04-07T00:07:58.760
> 
> 标签：java, android

我想在 Eclipse android 中将我的日期文本（2013 年 4 月 7 日）更改为日期（2013-04-07）

我现在的功能：

```
DateFormat fmtDate = DateFormat.getDateInstance();
Calendar date = Calendar.getInstance();
DatePickerDialog.OnDateSetListener d_start = new DatePickerDialog.OnDateSetListener() {
    public void onDateSet(DatePicker view, int year, int monthOfYear,
            int dayOfMonth) {
        date.set(Calendar.YEAR, year);
        date.set(Calendar.MONTH, monthOfYear);
        date.set(Calendar.DAY_OF_MONTH, dayOfMonth);
        updateLabel();
    }
}; 
private void updateLabel() {
    dateLabel.setText(fmtDate.format(date.getTime())); 
```

}

我如何更改格式日期，如 2013-04-07？我没有太多的想法。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T00:11:05.503

你只需要替换你`fmtDate`的

```
DateFormat fmtDate = new SimpleDateFormat("yyyy-MM-dd") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-07T00:12:33.917

您应该改用 SimpleDateFormatter，所以替换这一行

```
DateFormat fmtDate = DateFormat.getDateInstance(); 
```

和

```
SimpleDateFormat fmtDate =
            new SimpleDateFormat("yyyy-MM-dd"); 
```

有关更多信息，请查看[此页面](http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html)

# ruby - Guard-Less 不会尊重输出参数

> ID：15857399
> 
> 赞同：2
> 
> 时间：2013-04-07T00:08:02.150
> 
> 标签：ruby, sinatra, less, guard

我刚刚启动了我的第一个 Sinatra 应用程序，我正在尝试让[Guard-Less](https://github.com/guard/guard-less)启动并运行。我已经修复了一个[rb-readline 问题](https://github.com/guard/guard/issues/357)，该问题阻止对 .less 文件的更改更新我的 CSS，但我也无法将编译后的 CSS 文件输出到正确的目录中。Guard-Less 说你可以传递一个`:output`选项来保护以确保 CSS 被编译到正确的目录，但我还没有让它工作一次。CSS 只是编译到与 LESS 文件相同的目录。

我正在`foreman start`本地运行该应用程序。

保护文件：

```
# A sample Guardfile
# More info at https://github.com/guard/guard#readme

guard 'less', 
  :all_on_start => true,
  :output => 'public/assets/css' do
  watch(%r{^less/(.+\.less)$})
end 
```

宝石文件：

```
source 'https://rubygems.org'

gem 'sinatra'
gem 'shotgun'
gem 'therubyracer'
gem 'rb-readline'
gem 'less', '~>1.2'
gem 'haml'
gem 'rb-fsevent', '~> 0.9'
gem 'guard-less' 
```

档案：

```
guard: bundle exec guard
web: bundle exec ruby bootstrap.rb -p $PORT 
```

bootstrap.rb 文件：

```
require 'rubygems'  
require 'sinatra/base'
require 'haml'

class MyApp < Sinatra::Base

  get '/' do  
    haml :index
  end

end

MyApp.run! 
```

的输出`guard show`证明该选项正在被识别：

```
$ guard show
+---------+--------+--------+-----------------------+
| Group   | Plugin | Option | Value                 |
+---------+--------+--------+-----------------------+
| Default | Less   | output | "public/assets/css"   |
+---------+--------+--------+-----------------------+ 
```

最糟糕的是，我可以将 .less 文件留在与输出 css 相同的目录中，但这让我很烦，我想让它工作。有任何想法吗？

# javascript - item.text(currenttext+"something") 附加到对象的文本

> ID：15857400
> 
> 赞同：-1
> 
> 时间：2013-04-07T00:08:05.497
> 
> 标签：javascript, jquery

我目前有：

```
item.text(?); 
```

并且可以像这样设置我想要的任何东西：

```
item.text("Lorem Ipsum"); 
```

但我想做类似的事情：

```
item.text(item.text+"something"); 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T00:11:27.833

如果`item`是一个 jQuery 包装的 DOM 元素，你可以这样做：

```
item.text(item.text() + "something"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T00:09:47.120

我相信这个问题是关于 jQuery[`text()`](http://api.jquery.com/text/)方法的，可以这样使用：

```
item.text(function(i, text) {
    return text + "something";
}); 
```

当然你也可以使用`item.text(item.text() + "something")`，但是这种方法比上面给出的要慢。

# vb.net - 读取文本文件的特定部分并在 vb 中解析

> ID：15857404
> 
> 赞同：1
> 
> 时间：2013-04-07T00:08:46.593
> 
> 标签：vb.net

通过读取文本文件，我必须创建几个组合框并为它们动态添加项目。下面是我的示例文本文件，我必须从中解析“Switch for DSO”字符串，然后为此添加一个标签页。标签页名称将是“切换”。在此标签页下，我必须创建一些组合框并为这些框动态添加项目。每个组合框都会有一个标签。标签名称将类似于“粘合剂类型开关”，在标签右侧将添加一个组合框，框的项目将是“胶水”和“软焊”。所以在这个'Switches for DSO'标签页组合框下将被创建，直到它得到字符串'Options for DSO'。任何人都可以给我一个提示。如果你给我一些代码的提示，这对我很有帮助。

## 文本文件示例：

//==================

// DSO- **Tab page1的开关**

//==================

//粘合剂类型开关**-组合框1的标签**

//#DEFINE Glue-**组合框1的项目**

//#DEFINE SoftSolder-**组合框 1 的项**

//应用开关**-组合框2的标签**

//#DEFINE Non-Automotive-**组合框2的项目**

//#DEFINE Automotive-**组合框2 的项**

// Bondpad Material and Process Switch of Chip Bottom-**组合框3的标签**

//#DEFINE Non_Passivated_ChipBottom-**组合框3的项目**

//#DEFINE Copper_Bondpad_ChipBottom-**组合框3的项**

//#DEFINE Alu_Bondpad_Imide_ratio_ChipBottom-**组合框3的项目**

//#DEFINE Alu_Bondpad_Imide_non_ratio_ChipBottom-**组合框3的项目**

//==================

// DSO-**选项卡页面2的选项**

//==================

//交错的 Bondpad 排列**选项- checkbox1 的标签**

//#DEFINE STAGGERED- **checkbox1 值**

//楔形凹凸**选项-复选框2的标签**

//#DEFINE Wedge_on_Bump- **checkbox2 值**

// 芯片技术**- checkbox3 标签**

//#DEFINE SUPPLY1- **checkbox3 值**

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:45:22.833

根据您需要多少不同的选项卡布局，您可以直观地创建选项卡布局，然后在运行时根据需要创建实例，将它们添加到表单（假设为 WinForm）。

或者您可以有一个通用选项卡（也可重复使用），您可以在其中实例化并添加您需要的（模板化）控件，同时设置它们的属性。

你必须编写一堆代码来获得你想要的东西，解析文件并构建tabx。您可能还想看看在 .NET 中创建自定义控件。

# jsf - Richfaces 3.3.3 在页面加载时折叠所有 panelBarItem

> ID：15857406
> 
> 赞同：1
> 
> 时间：2013-04-07T00:09:01.260
> 
> 标签：jsf, richfaces

有谁知道如何在页面加载时不展开任何 panelBarItem？我还不能升级到 Richfaces 4.0，需要对 3.3.3 进行此修复。我尝试使用 panelBar 的 selectedPanel 属性并将其设置为我不渲染但仅渲染列表中的第一个 panelBarItem 的 panelBarItem。有任何想法吗？

```
<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:genx="http://genx.findmespot.com/facelet-taglib"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:t="http://myfaces.apache.org/tomahawk"
      xmlns:sec="http://sourceforge.net/projects/jsf-comp/acegijsf">
    <ui:composition template="#{layoutBean.template}">
        <ui:define name="content">
            <rich:panelBar height="400" width="650">
                <rich:panelBarItem >
                    <f:facet name="label">
                       <h:outputFormat escape="false" value="#{bundle['featureConfig.tracking.header.text']}"/>
                    </f:facet>
                    panel1
                </rich:panelBarItem>
                <rich:panelBarItem>
                    <f:facet name="label">
                       <h:outputFormat escape="false" value="#{bundle['featureConfig.newMovementAlertSettings.header.text']}"/>
                    </f:facet>
                    panel2
                </rich:panelBarItem>
                <rich:panelBarItem>
                    <f:facet name="label">
                       <h:outputFormat escape="false" value="#{bundle['featureConfig.newMovementAlertContacts.header.text']}"/>
                    </f:facet>
                    panel2
                </rich:panelBarItem>
                <rich:panelBarItem>
                    <f:facet name="label">
                       <h:outputFormat escape="false" value="#{bundle['featureConfig.dockMode.header.text']}"/>
                    </f:facet>
                    panel3
                </rich:panelBarItem>
                    <rich:panelBarItem>
                    <f:facet name="label">
                       <h:outputFormat escape="false" value="#{bundle['featureConfig.altitude.header.text']}"/>
                    </f:facet>
                panel4
                </rich:panelBarItem>
            </rich:panelBar>
        </ui:define>
    </ui:composition>
</html> 
```

# ios - 尝试插入非属性值目标 C

> ID：15857408
> 
> 赞同：20
> 
> 时间：2013-04-07T00:09:16.403
> 
> 标签：ios, objective-c, nsmutablearray, nsuserdefaults, property-list

嗨，我正在尝试从餐馆对象创建一个fourates 列表，我的应用程序有一个不同餐馆的列表，我希望用户能够添加最喜欢的餐馆，但此代码不起作用

```
- (IBAction)toggleFav:(id)sender {

    Restaurant *resto = [self restaure];

    NSMutableDictionary *dic = [[NSMutableDictionary alloc] init];
    [dic setObject:resto.price forKey:@"restoPrice"];
    [dic setObject:resto.restaurantId forKey:@"restaurantId"];
    [dic setObject:resto.restoAbout forKey:@"restoAbout"];
    [dic setObject:resto.restoAddress forKey:@"restoAddress"];
    [dic setObject:resto.restoBeverages forKey:@"restoBeverages"];
    [dic setObject:resto.restoCategory forKey:@"restoCategory"];
    [dic setObject:resto.restoEmail forKey:@"restoEmail"];
    [dic setObject:resto.restoLogo forKey:@"restoLogo"];
    [dic setObject:resto.restoName forKey:@"restoName"];
    [dic setObject:resto.restoPhone forKey:@"restoPhone"];
    [dic setObject:resto.restoCity forKey:@"restoCity"];

    NSArray *dicArray = [dic allKeys];

    if([sender isSelected]){
        //...
        [sender setSelected:NO];
        NSMutableArray *array = [[[NSUserDefaults standardUserDefaults] objectForKey:@"restoName"] mutableCopy];
        [array removeObject:dicArray];
        [[NSUserDefaults standardUserDefaults] setObject:array forKey:@"restoName"];

    } else {
        //...
        [sender setSelected:YES];
        NSMutableArray *array = [[[NSUserDefaults standardUserDefaults] objectForKey:@"restoName"] mutableCopy];
        [array addObject:dicArray];
        [[NSUserDefaults standardUserDefaults] setObject:array forKey:@"restoName"];
        [[NSUserDefaults standardUserDefaults] synchronize];

       //NSLog(@"%@",[[NSUserDefaults standardUserDefaults] stringForKey:@"restoName"]);
  }
} 
```

' 类 '__NSCFArray'。请注意，属性列表中的字典和数组也必须只包含属性值。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2014-01-30T09:05:18.560

如果您不想费心确保所有字典值都是属性列表类型，那么您可以简单地将字典转换为 NSData，

```
NSUserDefaults *def = [NSUserDefaults standardUserDefaults];
[def setObject:[NSKeyedArchiver archivedDataWithRootObject:self.myDictionary] forKey:@"MyData"];
[def synchronize]; 
```

并从沙盒返回字典：

```
NSUserDefaults *def = [NSUserDefaults standardUserDefaults];
NSData *data = [def objectForKey:@"MyData"];
NSDictionary *retrievedDictionary = [NSKeyedUnarchiver unarchiveObjectWithData:data];
self.myDictionary = [[NSDictionary alloc] initWithDictionary:retrievedDictionary]; 
```

希望这可以帮助某人。:D

* * *

**附加说明：**如果您要获取可变字典或可变数组，请记住使用“mutableCopy”方法。否则，您无法从检索到的字典/数组中添加或删除对象。例如：

```
NSMutableDictionary *retrievedDictionary = 
[[NSKeyedUnarchiver unarchiveObjectWithData:data] mutableCopy]; 
```

或者

```
NSMutableArray *retrievedArray = 
[[NSKeyedUnarchiver unarchiveObjectWithData:data] mutableCopy]; 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-04-07T00:12:28.290

您只能在 NSUserDefaults 中存储属性列表类型（数组、数据、字符串、数字、日期、字典）或 url。您需要将模型对象转换为这些对象。

# asp.net-mvc-3 - 如何完全删除实体模型和连接

> ID：15857409
> 
> 赞同：1
> 
> 时间：2013-04-07T00:09:19.137
> 
> 标签：asp.net-mvc-3, entity-framework, entity

MVC 3 web 正在 VS2012 Update 1 中构建，连接到 MySQL 数据库。

我像往常一样添加了一个 ado.net 实体模型，一切都很好，直到我意识到自动生成的类没有更新，尽管这个错误应该在 VS Update 1 中得到修复。无论如何，我最终删除了所有实体文件（.context. tt, .designer.cs, .tt & the ed,x.diagram) 我还从 webconfig 中删除了 ' 连接字符串。

然后我重新开始，添加了一个新的 ado.net 实体模型等，但它一直试图在名称的末尾添加一个 1（与最后一个相同），所以我假设仍然有一些对旧实体的引用模型在那里某处。

所有参考文献在哪里，所以我可以删除它们？有没有更好的方法来解决这个问题？我想我可以为实体模型选择一个完全不同的名称，但这似乎很俗气。

哦，还有一件事，我用 nuget 抓住了 EF 5.0，但是在项目引用中，以及所有通过 web 配置，它都引用了 ef 4.4。这可能是问题的一部分吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T03:11:38.143

通常，如果您只有 .NET 4 而没有 .NET 4.5，则将引用 EF 4.4 版。检查您的项目属性并查看您的目标版本

至于末尾带有“1”的连接字符串..这可能是一个愚蠢的问题，但是您是否尝试通过使用“查找”并搜索整个解决方案来查找旧连接字符串的任何引用？

# ruby-on-rails - resque 调度程序作业的奇怪行为

> ID：15857412
> 
> 赞同：2
> 
> 时间：2013-04-07T00:09:28.483
> 
> 标签：ruby-on-rails, resque

所以一些背景，我在这里得到了一些建议：

> [在 Ruby on Rails 中安排事件](https://stackoverflow.com/questions/15710013/scheduling-events-in-ruby-on-rails)

aand 一直在努力实施它。我似乎无法让它工作。这是我的调度程序工作，用于在延迟队列和准备发送队列之间移动我的问题（我已经决定使用电子邮件而不是 SMS）

```
require 'Assignment'
require 'QuestionMailer'
module SchedulerJob
  @delayed_queue = :delayed_queue
  @ready_queue

  def self.perform()
    @delayed_queue.each do |a|
      if(Time.now >= a.question.schedule)
        @ready_queue << a  
        @delayed_queue.delete(a)
      end
    end
    push_questions
  end

  def self.gather()
    assignments = Assignment.find :all
      assignments.each do |a|
      @delayed_queue << a unless @delayed_queue.include? a
    end
  end

  private
  def self.push_questions
    @ready_queue.each do |a|
      QuestionMailer.question(a)
    end
  end

end 
```

每次创建分配时，我都会使用回调 on_create 调用收集方法，然后执行操作实际上是在 resque 运行时发送电子邮件。

不过，我从回调中收到了一个奇怪的错误。 `undefined method `include?' for :delayed_queue:Symbol`

这是分配模型中的代码

```
class Assignment < ActiveRecord::Base
  belongs_to :user
  belongs_to :question
  attr_accessible :title, :body, :user_id, :question_id , :response , :correct
  after_create :queue_assignments

  def grade
    self.correct = (response == self.question.solution) unless response == nil
  end

  def queue_assignments
    SchedulerJob.gather
  end 
```

有什么想法吗？我认为这是我对这些队列如何与 resque-scheduler 一起工作的理解的问题。我假设如果队列是类似列表的对象，那么我可以对它们进行操作，但它似乎是一个符号，而不是像 include 之类的方法。我假设用于向其中添加内容的 << 表示法也是无效的。另外请告知这是否不是处理这种工作调度的方法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:26:01.030

`gather`在将新方法添加到`SchedulerJob`模块后，您可能还没有重新启动 Rails 应用程序。尝试重新启动您的应用程序以解决此问题。

您还可以将包含您的 Resque 工作程序的目录添加到 Rails 的`watchable_dirs`数组中，这样您在开发中对 Resque 工作程序模块所做的更改就不需要重新启动您的应用程序。有关详细信息，请参阅此博客文章：

> [http://wondible.com/2012/01/13/rails-3-2-autoloading-in-theory/](http://wondible.com/2012/01/13/rails-3-2-autoloading-in-theory/)

# c - C中的嵌套结构和指针

> ID：15857413
> 
> 赞同：3
> 
> 时间：2013-04-07T00:09:31.450
> 
> 标签：c, pointers, struct, nested

我花了很长时间试图弄清楚以下程序的问题是什么：

```
typedef struct user {
    char host[40];
    int order;
} user;

typedef struct data {
    user userdat;
} data;

int read_user (char *datname, user *userdat) {
    ...

    fscanf (datin, "%s", &userdat->host);
    fscanf (datin, "%d", &userdat->order);

    //1
    printf ("%d\n", userdat->order);

    ...

}

void init_data (data *dat) {
    init_userdat (&dat->userdat);
}

void init_userdat (user *userdat) {
    *userdat->host = "127.0.0.1";
    userdat->order = 0;
}

int user_print (int i, data *dat) {
    //2
    printf ("%d\n", dat->userdat.order);
}

int main(int argc, char *argv[]) {

    ...
    data dat;
    init_data (&dat);
    read_user (datname, &dat->userdat);
    user_print (&dat);
} 
```

该程序非常简化以突出相关部分。发生的情况是第一个打印语句 (//1) 正确输出了值，而第二个 (//2) 则没有 - 它输出的东西看起来像是一个可能的内存位置。

我尝试了多种访问存储变量的组合，但我就是无法破解它。任何帮助，将不胜感激。

Edit1：修复了代码中的几个非必要错误（与指针或结构无关）

**最后编辑：谢谢大家的帮助。Arun Saha 指出的问题确实存在于原始代码中，现在已修复。但是，打印两个不同字符串的问题仍然存在。您对代码应该编译和工作的保证让我发现了真正的罪魁祸首——我没有正确初始化其他复杂结构的另一部分，这导致了 user.order 变量的覆盖。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T00:15:48.093

以下行没有做它看起来做的事情:-)

```
*userdat->host = "127.0.0.1"; 
```

`userdata->host`是指向`host[40]`数组中第一个字符的指针。上面的语句只会从源字符串（“127.0.0.1”）中复制一个字符。要复制整个字符串，请使用标准库函数`stncpy()`

```
strncpy( & userdata->host[ 0 ], "127.0.0.1", 40 ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T00:32:42.353

在你的`main`函数中，当你调用时`read_user (datname, &dat->userdat);`，我觉得应该有一个编译问题。这实际上应该`read_user (datname, &dat.userdat);`不是`dat`指针，而是对象本身。

有了这个改变和 Arun 之前的建议，我已经尝试了你的程序并且它可以工作。

# regex - DART 中的负后视等价物？

> ID：15857415
> 
> 赞同：2
> 
> 时间：2013-04-07T00:09:55.277
> 
> 标签：regex, dart, negative-lookbehind

有什么方法可以在 Dart 正则表达式中实现相当于负向后看的效果？我需要匹配一个不以特定字符集开头和结尾的字符串。

如果在字符串的开头找到匹配的部分，我无法找到执行此操作而不会失败的正则表达式。消极的lookbehinds 似乎是唯一的答案，但Dart 没有。

这是我想要工作的正则表达式，但它没有：

```
(?<!(Me\.)|[frFR])(text)(?!\w) 
```

它会匹配`.text`or`text=`但不匹配`Me.text`or`FtextABC`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-04-18T14:53:59.363

对于那些需要在 Dart RexExp 中进行后向断言的人，从[2.2.1-dev.1.0](https://github.com/dart-lang/sdk/blob/master/CHANGELOG.md#221-dev10)版本开始，Dart 支持后向断言。所以 OP 的 RegExp 在 Dart 中可以正常工作。

```
RegExp re = new RegExp(r"(?<!(Me\.)|[frFR])(text)(?!\w)");
List<String> tests = ['.text', 'text=', 'Me.text', 'FtextABC'];
for (String t in tests) {
  print('$t: ${re.hasMatch(t)}');
}

/*
prints: 
.text: true
text=: true
Me.text: false
FtextABC: false
*/ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-07T00:30:19.717

你的答案在这里：

[javascript后视模仿](http://blog.stevenlevithan.com/archives/mimic-lookbehind-javascript)

问题是 DART 正则表达式与 Javascript 正则表达式具有完全相同的功能。令许多人感到遗憾的是，Javascript 不支持后视。但是该链接*将*提供答案。

# c++ - C++ 中的递归类型定义

> ID：15857416
> 
> 赞同：2
> 
> 时间：2013-04-07T00:09:59.387
> 
> 标签：c++, boost, vector, variant

我想用 C++ 写一个类型定义，但不知道我想实现的东西是否合法。假设我想做一个 boost 变体类型向量的 typedef，它指向一个 int 或另一个相同类型的向量。那么，这是否合法，编译器会抱怨吗？

```
typedef std::vector<boost::variant<int *, boost::variant<int *, IntBranch*>> IntBranch; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-07T00:16:40.077

您可以`boost::make_recursive_variant`为此目的使用：

```
#include <boost/variant.hpp>

typedef boost::make_recursive_variant<
   int*, 
   std::vector< boost::recursive_variant_ >
>::type IntBranch; 
```

这就是你将如何使用它：

```
#include <vector>

int main()
{
    typedef boost::make_recursive_variant<
       int*, 
       std::vector< boost::recursive_variant_ >
    >::type IntBranch;

    int x = 42;
    IntBranch ib = &x;

    std::vector<IntBranch> v;
    v.push_back(ib);

    IntBranch ib2 = v;

    // ...
} 
```

这是一个[活生生的例子](http://liveworkspace.org/code/4yc7Hy%243644)。

# jquery - 使用 jQuery 预加载和缓存下 x 个图像

> ID：15857417
> 
> 赞同：1
> 
> 时间：2013-04-07T00:10:15.077
> 
> 标签：jquery, image, caching, preload

我需要在当前显示的图像（全屏幻灯片）之后动态预加载和缓存下一个 X 图像。
到目前为止，我已经尝试了所有找到的方法，但浏览器仍然没有缓存。

*注意 #1*：我不知道是否有关系，但在美好的一天，每张照片至少有 2 Mb。

**我如何预加载和缓存图像**

方法**#1**：

```
$('<img/>').attr({
    src: list[url]
}).load(function() {
    alert("I have preloaded your next image.");
}); 
```

方法**#2**：

```
next_img = new Image()
next_img.src=list[url];
next_img.onload=function(){ alert("I have preloaded your next image."); } 
```

方法**#3**：

```
 $('<img/>')[0].src = list[url]; 
```

我在浏览器控制台中看到的是它们确实已加载，因为我也收到了警报通知。

但是在我有我的 jQuery 函数的地方，要更改全屏显示的图像的“src”，控制台会显示再次下载的图片，并且没有提到缓存，正如我也可以通过 3-4 秒的加载图片上面的方法刚刚加载。

**编辑：**

我在所有浏览器中都没有缓存。
所有图片均来自 MaxCDN。

**编辑#2：**

他们的对等位置之一可能存在问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T11:29:18.777

您如何请求并加载图像作为 div 元素的子元素，并从可见屏幕区域绝对定位该 div。

例如：

```
JavaScript:
var arrImages = {}; 
var image = new Image();
var image.onload = function() {
    $('.imageContainerDiv').append(this);
    arrImages[this.src] = this;
}
image.src = imageURL;

Css:
.imageContainerDiv {
    position: absolute;
    width: 0;
    height: 0;
    overflow: hidden;
    top: -1024px;
    left: -1024px;
} 
```

这样，下次您从 arrImages 引用图像时，图像应该从浏览器缓存/内存中提取，因为它已经加载到页面上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-26T10:51:02.283

用不同的 z-index 将图像放在一起怎么样？

喜欢：

```
.image_top {position:absolute; left:0px; top:0px; z-index:100;}
.image {position:absolute; left:0px; top:0px; z-index:0;} 
```

显示的图像：

```
images[0].className  = "image_top"; 
```

# java - 如何检查战舰游戏中的船只是否重叠？对算法感到困惑

> ID：15857418
> 
> 赞同：2
> 
> 时间：2013-04-07T00:10:28.690
> 
> 标签：java, algorithm

我不是一个伟大的程序员，所以我想知道是否有人可以帮助我。在我的战舰游戏中，我有由 Rect 类制成的船，但我需要检查它们是否重叠。这就是我到目前为止所拥有的。

编辑：到底出了什么问题：我有两艘大小为 2 和 5 的船。所以说船 1 有 (0,0)(0,1) 坐标，船 2 有 (0,1) 到 (5,1)。它非常适合在点（0,1）上检查一号船的坐标，但仅此而已。我希望这是有道理的。所以如果我在 (1,1) 上检查 (0,0) 和 (0,1) 它显示没有错误

```
 public boolean contains(Ship ship) {
    int currentX = ship.getX();
    int currentY = ship.getY();
    int testX = xCoord;
    int testY = yCoord;

    if (rotated) {      //if ship is horizontal enter
        for (int j = 0; j < sizeOfShip; j++) {
            for (int k = 0; k < ship.getSize(); k++) {
                if (testX == currentX && testY == currentY) {
                    return false;
                }
                testX++;
            }
            if (ship.rotated)
                currentX++;
            else {
                currentY++;
            }
        }
    }
    //
    if (!rotated) {
        for (int j = 0; j < sizeOfShip; j++) {
            for (int k = 0; k < ship.getSize(); k++) {
                if (testX == currentX && testY == currentY) {
                    return false;
                }
                testY++;
            }
            if (ship.rotated)
                currentX++;
            else {
                currentY++;
            }           }
    }
    return true;

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T00:33:04.230

问题是，例如对于船 (0,1)(5,1)，您需要检查所有值 (0,1)(1,1)(2,1)(3,1)(4,1) (5,1) 与所有其他船的相似值，例如 (0,0)(0,1) （不再，因为它是小船）。

您需要修改您的 for 循环来为您执行此操作。我建议打印出那些 currentX/currentY 值以确保它们正在执行此操作。特别是，我不认为您希望每次迭代都增加 currentX/Y，而是在一个 for 循环中增加 currentX，在另一个循环中增加 currentY。

干杯。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-07T00:51:59.613

我认为问题出在此处（另一个也是如此`if`）：

```
...
    testX++;
 }
 if (ship.rotated)
     currentX++;
 else {
     currentY++;
 }
 ... 
```

我假设`testX`是`this`船舶`x`价值。您*在内*`testX`循环中的每次迭代和外循环中的输入参数值（）中递增。同时，您永远不会重置该值。假设船的长度为 5，输入参数的长度为 2，两者都是水平的。在外部循环的 3 次迭代之后，增加了 6。*`currentX``this``testX`*

 *我认为您想`currentX/Y`在每次内部迭代后交换增量并重置值：

```
for (int j = 0; j < sizeOfShip; j++) {
    for (int k = 0; k < ship.getSize(); k++) {
        if (testX == currentX && testY == currentY) {
            return false;
        }
        if (ship.rotated)
            currentX++;
        else {
            currentY++;
        }
    }
    currentX = ship.getX();
    currentY = ship.getY();
    testX++;
} 
```

这必须为两个`if`s 完成。我不能尝试这个，所以尝试一下，如果我犯了错误，请告诉我。:)

* * *

换个说法。你可以更换

```
}
//
if (!rotated) {
... 
```

和

```
}
else {
... 
```*

# java - 使用字符串在java中定义一个类

> ID：15857422
> 
> 赞同：0
> 
> 时间：2013-04-07T00:11:12.710
> 
> 标签：java

每个人总是立即说 Class.forName，但这不是那个！！！

好的，所以我试图从网站上获取一堆文本并将其编译成一个类。到目前为止，我已经能够从网站上获取文本，但由于某种原因我无法定义它。

请看一下：

主类：（Driver.java）

```
public class Driver {
public static final Pattern packageDeclaration = Pattern.compile("package");

public static void main(String[] args) throws Exception {
    System.out.print("Enter the URL of the main class:  ");
    BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
    String stringURL = br.readLine();
    String text = getURLText(new URL(stringURL));
    ByteClass mainClass = new ByteClass("Main", text.getBytes());
    mainClass.clazz.getMethod("run", null).invoke(mainClass.clazz, null);
}

public static String getURLText(URL url) throws IOException {
    StringBuilder lineGatherer = new StringBuilder();
    BufferedReader in = new BufferedReader(new InputStreamReader(url.openStream()));
    String line;
    while ((line = in.readLine()) != null) {
        lineGatherer.append(line);
    }
    in.close();
    return lineGatherer.toString();
} 
```

}

和 ByteClass.java：

```
public class ByteClass {
private ArrayList<Byte> nonarraybytes = new ArrayList<Byte>();
public byte[] bytes;
public String[] lines;
public Class<?> clazz;

public ByteClass(String name, byte[] bytes) {
    for (byte b : bytes)
        nonarraybytes.add(b);
    bytes = new byte[nonarraybytes.size()];
    for (int i = 0; i < bytes.length; i++)
        bytes[i] = nonarraybytes.get(i);
    clazz = define(name, bytes);
}

protected Class<?> define(String name, byte[] bytes) {
    return new ClassLoader() {
        public Class<?> defineClass(String name, byte[] bytes) {
            return super.defineClass(name, bytes, 0, bytes.length);
        }
    }.defineClass(name, bytes);
} 
```

}

所以，问题来了：

```
Enter the URL of the main class:  https://raw.github.com/JamesNorris/Ablockalypse/master/src/main/java/com/github/JamesNorris/Threading/FakeBeaconThread.java
Exception in thread "main" java.lang.ClassFormatError: Incompatible magic value 1885430635 in class file Main
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(Unknown Source)
    at java.lang.ClassLoader.defineClass(Unknown Source)
    at java.lang.ClassLoader.defineClass(Unknown Source)
    at com.github.ByteClass$1.defineClass(ByteClass.java:134)
    at com.github.ByteClass.define(ByteClass.java:136)
    at com.github.ByteClass.<init>(ByteClass.java:21)
    at com.github.Driver.main(Driver.java:20) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T00:19:10.020

你从来没有真正编译过这个类；您正在尝试加载 Java 源代码 ( `*.java`)，就好像它是一个类文件 ( `*.class`)。

为了解决这个问题，您需要在过程中的某个时间点调用 Java 编译器。最简单的方法是预先编译程序，然后将类文件放在您的网站上，而不是（或除了）源代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-07T00:49:48.290

在某些时候，您必须使用编译器。好消息是您可以使用[Java Compiler API](http://docs.oracle.com/javase/6/docs/api/javax/tools/JavaCompiler.html)从 Java 动态运行编译器。编译后你可以加载类并实例化它或做任何你想做的事情。

这里还有一些旧[教程](http://mike-java.blogspot.cz/2008/03/java-6-compiler-api-tutorial.html)如何做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-07T00:16:19.047

您没有在 InputStream 中获得真正的 java 类，这就是代码抛出错误的原因。尝试记录您从 URL 接收到的输入，这会告诉您出了什么问题。

也看看这个[问题](https://stackoverflow.com/questions/7752945/classloader-magic-values-in-defineclass)，他和你面临同样的问题。

# python - TypeError：在非序列上迭代......在python中

> ID：15857424
> 
> 赞同：1
> 
> 时间：2013-04-07T00:11:35.420
> 
> 标签：python

这是代码，它应该从文件中读取然后生成字典...

```
def get_songs(setlists):
    f = file(setlists)
    d = {}
    next_line = f.readline()
    while (next_line != ""):
        if next_line[0].isdigit():
            concert1 = concert(int(next_line.split("-")[0]) , int(next_line.split("-")[1]) , \
                                       int(next_line.split("-")[2]) , next_line.split("-")[3].strip("\n"))
            for i in f.readline().split('/'):
                d[i.strip(" ").strip("\n").split("(")[0]] = (concert1 if not d.has_key(i.strip(" ").strip("\n").split("(")[0])
                                                            else ([d[i.strip(" ").strip("\n").split("(")[0]] , concert1] if
                                                                  isinstance(d[i.strip(" ").strip("\n").split("(")[0]] , concert)
                                                                  else d[i.strip(" ").strip("\n").split("(")[0]] + [concert1]))
        next_line = f.readline()      
    return d 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T09:00:01.467

目前尚不清楚错误在哪里。我在代码中注意到的一件事是，在`for i in ...`代码之后， d[..] 采用单个值或数组：

```
d[..] = (concert1 
    if cond1 else 
    ([d[..], concert1] if cond2
        else d[..]+concert1) 
```

我会避免将此类表达式内联并执行 if/else 之类的操作：

```
tmp = None
if cond1:
  tmp = concert1
elif cond2:
  tmp = [d[d[i.strip(" ").strip("\n").split("(")[0]] , concert1]
else:
  tmp = d[i.strip(" ").strip("\n").split("(")[0]] + [concert1]

d[i.strip(" ").strip("\n").split("(")[0]] = tmp 
```

我可以看到最后一个`else`有点不正确（？） str + array 将是 str imho？

作为旁注，您可能想要使用正则表达式，而不是所有那些剥离/修剪...

# android - 图像的密度无关（倾角）尺寸变化很大

> ID：15857425
> 
> 赞同：5
> 
> 时间：2013-04-07T00:11:43.023
> 
> 标签：android, performance

我已经完成了我的应用程序的编码，并且正在运行 Lint 以确保解决所有性能问题。

我为 ldpi、mdpi、hdpi 和 xhdpi 创建了图形；但 Lint 告诉我出了点问题：

```
The image btn_homepage_journal.png varies significantly in its density-independent (dip) size across the various density versions: 
drawable-xhdpi\btn_homepage_journal.png: 93x75 dp (186x149 px), 
drawable-hdpi\btn_homepage_journal.png: 76x61 dp (114x92 px), 
drawable-mdpi\btn_homepage_journal.png: 61x49 dp (61x49 px), 
drawable-ldpi\btn_homepage_journal.png: 48x48 dp (36x36 px) 
```

我的 mdpi 测试设备是 Galaxy Ace，我的 xhdpi 测试设备是 Galaxy S3，图形看起来不错。

我不明白这个警告试图告诉我什么：对于我的 186x149 像素的 xhdpi 图像（完全适合我的 xhdpi 布局），93x75 dp 指的是什么？

这是我在每个 dpi 文件夹中使用的图像：

![低密度脂蛋白](https://i.stack.imgur.com/8s2uV.png) ![mdpi](https://i.stack.imgur.com/jdt2y.png) ![hdpi](https://i.stack.imgur.com/xh3aE.png) ![xhdpi](https://i.stack.imgur.com/Y1pJ2.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-07T00:30:51.330

Lint 向您展示了每个图像的密度无关大小，或者如果它必须为您更改大小，基本上 mdpi 大小将是多少。它期望的相对大小是： xhdpi: 200% hdpi: 150% mdpi: 100% ldpi; 75% 所以如果你的 mdpi 图像是 61x49，它会期望你的 ldpi 是那个的 75%，或者 46x37。此外，它会期望您的 xhdpi 为 122x98，而不是您拥有的 186x149。

因此，查看每个数字集 - 左侧基本上表示图像的大小，如果它为 mdpi 显示调整大小。所以理论上这应该是真的：

xhdpi*0.5 == hdpi * 0.667 == mdpi == ldpi*1.33

在实践中，您可以按照自己的方式进行操作，但是您的布局很难相互对应。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-07-02T00:02:03.853

有时代码胜于雄辩：

```
public static void logGfxVarioFromXXHDPI(final int height, final int width) {
    RapidLog.i("GFX","xxxhdpi: (" + (int)(height * (4/3.0))  + "x" + (int)(width * (4/3.0))  + ")");
    RapidLog.i("GFX","xxhdpi: (" + (height)  + "x" + (width)  + ")");
    RapidLog.i("GFX","xhdpi: (" + (int)(height * (2/3.0))  + "x" + (int)(width * (2/3.0))  + ")");
    RapidLog.i("GFX","hdpi: (" + (int)(height * 0.5)  + "x" + (int)(width * 0.5)  + ")");
    RapidLog.i("GFX","mdpi: (" + (int)(height * (1/3.0)) +  "x" + (int)(width * (1/3.0)) + ")");
    RapidLog.i("GFX","ldpi: (" + (int)(height * 0.25)  + "x" + (int)(width * 0.25) + ")");
} 
```

祝你好运

# javascript - Easljs 将过滤器应用于位图

> ID：15857445
> 
> 赞同：2
> 
> 时间：2013-04-07T00:14:44.837
> 
> 标签：javascript, html, createjs

我试图弄清楚如何使用 easljs 为视频源添加过滤器。根据文档，我可以为该`bitmap.filtes`属性设置过滤器。这似乎不起作用。没有错误或任何东西，过滤器根本没有应用。

关于文档的一个混淆是，它提到`cache()`必须在显示对象上调用才能应用过滤器，但对于`bitmap`类，它说不`cache()`应该调用。

下面是我用作测试的代码：

```
var stage = new createjs.Stage('screen');

var video =  document.getElementById('source');
var bitmap = new createjs.Bitmap(video);

bitmap.scaleX = 0.44;
bitmap.scaleY = 0.44;
bitmap.y = 30;

bitmap.filters = [
    new createjs.ColorFilter(0,0,0,1,255,0,0),
    new createjs.BoxBlurFilter(5, 5, 10)
];

stage.addChild(bitmap); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T01:26:53.657

有关位图和过滤器的文档具有误导性 - 我将确保在下一个版本中对其进行更新。

应避免缓存位图，因为它不会提供任何性能优势，您将从缓存容器、形状和文本中获得这些优势。事实上，它甚至会降低性能，因为它会使用额外的内存来存储缓存的版本

但是您必须缓存位图才能对其应用过滤器。将缓存调用添加到您的示例中，它应该可以工作。

对于文档造成的任何混乱，我们深表歉意。

# ruby-on-rails - 使用 rails 渲染页面

> ID：15857448
> 
> 赞同：0
> 
> 时间：2013-04-07T00:15:10.247
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, actioncontroller

我正在尝试在模型程序和学生之间建立“友谊”。我用 has_many 做：通过模型关系。在关系控制器中，我创建了动作，它应该在友谊发生后重定向另一个页面。

因此，在学生展示视图中，我有 link_to 请求友谊。我以为我可以进入学生展示页面，但是当我尝试进入学生展示视图到另一个页面时，它会将我从学生索引重定向。所以我实际上无法进入学生节目，它只是将我重定向到其他页面。

为什么会这样？单击“请求友谊”后，我希望从学生显示视图重定向到其他模型页面。

学生 show.html.erb

```
 <%= link_to "Request friendship with #{@student.name}",
 { :controller => "relationship", :action => "create",
 :id => @student.name },
 :confirm => "Send friend request to #{@student.name}?" %> 
```

路由.rb

```
 match "/students/:id" => "relationships#create" 
```

更新

关系控制器

```
def create
  Relationship.request(@prog, @student)
  flash[:notice] = "Friend request sent."
  redirect_to prog_url
end 
```

耙路线

```
 relationships_create GET    /relationships/create(.:format)   relationships#create
    relationships_destroy GET    /relationships/destroy(.:format)  relationships#destroy
                         /students/:id(.:format)           relationships#create
    relationships GET    /relationships(.:format)          relationships#index
                  POST   /relationships(.:format)          relationships#create
 new_relationship GET    /relationships/new(.:format)      relationships#new
edit_relationship GET    /relationships/:id/edit(.:format) relationships#edit
     relationship GET    /relationships/:id(.:format)      relationships#show
                  PUT    /relationships/:id(.:format)      relationships#update
                  DELETE /relationships/:id(.:format)      relationships#destroy
         students GET    /students(.:format)               students#index
                  POST   /students(.:format)               students#create
      new_student GET    /students/new(.:format)           students#new
     edit_student GET    /students/:id/edit(.:format)      students#edit
          student GET    /students/:id(.:format)           students#show
                  PUT    /students/:id(.:format)           students#update
                  DELETE /students/:id(.:format)           students#destroy
            progs GET    /progs(.:format)                  progs#index
                  POST   /progs(.:format)                  progs#create
         new_prog GET    /progs/new(.:format)              progs#new
        edit_prog GET    /progs/:id/edit(.:format)         progs#edit
             prog GET    /progs/:id(.:format)              progs#show
                  PUT    /progs/:id(.:format)              progs#update
                  DELETE /progs/:id(.:format)              progs#destroy 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T09:05:07.190

不确定我完全理解@prog 应该是什么，但这是要走的路

```
def create
  @student = Student.find_by_id(params[:id])
  @prog = Programme.find_by_id(params[:prog]) #You need to fill this in
  Relationship.request(@prog, @student)
  flash[:notice] = "Friend request sent."
  redirect_to @student # Or @prog, or whatever you'd like
end 
```

*您可能还需要将 prog.id 传递给控制器​​，例如：*

`match "/students/:id/:prog" => "relationships#create"`

并添加

```
<%= link_to "Request friendship with #{@student.name}",
 { :controller => "relationship", :action => "create",
:id => @student.name, :prog => @student.current_programme },
# I don't know how you differ programmes, you'd have to work this one out  
:confirm => "Send friend request to #{@student.name}?" %> 
```

# iphone - SQLite 未正确导入 iOS

> ID：15857449
> 
> 赞同：0
> 
> 时间：2013-04-07T00:15:28.610
> 
> 标签：iphone, objective-c, sqlite, fmdb

看来，当我将 .sqlite3 文件复制到 iOS 并用于`FMDB`访问它时，数据库是空的。我只是将它拖放到 Xcode 中。当我运行时：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *writableDBPath = [documentsDirectory stringByAppendingPathComponent:@"db.sqlite3"];
FMDatabase *db = [FMDatabase databaseWithPath:writableDBPath];

FMResultSet *results = [db executeQuery:@"SELECT * FROM tableName"]; 
```

`results`返回零。看着`[db lastErrorMessage]`，它说我的桌子不存在。当我在命令行中打开 .sqlite 文件（存储在 iPhone 模拟器中的文件）时，我得到一个空数据库。是否有将 SQLite 数据库导入 iOS 的特定方法？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:00:28.620

我看到两个可能的问题：

首先，确保 .sqlite 文件包含在您的项目目标中。在文件导航器中选择您的文件；打开实用程序面板（显示“查看”部分的右侧面板图标），然后查找标题为“目标成员资格”的部分。如果未选中所需目标的框（您可能只有一个），则您的数据库文件不会被复制到包中。

其次，您试图在文档目录中查找数据库。但是，您必须手动将其从捆绑包复制到该目录，然后才能将其作为可写文件打开：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *dbPath = [documentsDirectory stringByAppendingPathComponent:@"db.sqlite3"];

NSURL *dbURL = [NSURL fileURLWithPath:dbPath];

// copy a database from the bundle if not present
// on disk
NSFileManager *fm = [NSFileManager defaultManager];
if (![fm fileExistsAtPath:dbPath]) {
    NSURL *bundlePath = [[NSBundle mainBundle] URLForResource:@"db" withExtension:@"sqlite3"];
    NSError *error = nil;
    if (!bundlePath || ![fm copyItemAtURL:bundlePath toURL:dbURL error:&error]) {
        NSLog(@"error copying database from bundle: %@", error);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-13T06:34:05.540

我认为您也可以使用原始代码。你只需要打开“db”

```
NSArray * paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString * documentDirectory = [paths objectAtIndex:0];
//NSString * documentDirectory = @"/Users/cefitdept/Documents/ImportDB/";

NSString * dbPath = [documentDirectory stringByAppendingPathComponent:@"ImportDB.sqlite"];
FMDatabase * db = [FMDatabase databaseWithPath:dbPath];
if (![db open]) {
    return;
}
FMResultSet * results = [db executeQuery:@"SELECT * FROM main"];
while ([results next]) {
    NSData * data = [results dataForColumn:@"engs"];
    NSString * string = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
} 
```

# c# - 实体框架代码优先：为每个项目创建单独的数据库

> ID：15857454
> 
> 赞同：0
> 
> 时间：2013-04-07T00:16:13.033
> 
> 标签：c#, entity-framework, ef-code-first, structuremap

我正在使用 WPF 和实体框架 CodeFirst 开发应用程序。
一项要求是用户可以为每个新项目创建单独的数据库文件。
数据库上下文：

```
public class TestContext : DbContext, IUnitOfWork
{
    public TestContext()
        : base("TestContext")
    {
    }

    #region Implementation of IUnitOfWork

    public new IDbSet<TEntity> Set<TEntity>() where TEntity : class
    {
        return base.Set<TEntity>();
    }

    #endregion Implementation of IUnitOfWork

    public DbSet<Destination> Destinations { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Configurations.Add(new DestinationMap());
    } 
```

应用配置中定义的连接字符串：

```
<connectionStrings>
    <clear />
    <add name="TestContext" providerName="System.Data.SqlClient" connectionString="Server=.\sqlexpress;Database=databaseName;Integrated Security=True;Connect Timeout=300;MultipleActiveResultSets=true;" />
</connectionStrings> 
```

我使用 StructureMap 在 IUnitOfWork 接口中注入 DbContext 以实现每个请求模式的上下文。这是 StructureMap 配置：

```
ObjectFactory.Initialize(x => x.Scan(scanner =>
{                                       
    x.For<IUnitOfWork>().CacheBy(InstanceScope.Hybrid).Use<SpitfireContext>();
})); 
```

当用户创建新项目时，我尝试更改连接字符串并强制应用程序为新项目创建数据库。

```
public static void ChangeDatabase(Guid guid)
{
    var sqlConnectionStringBuilder =
        new SqlConnectionStringBuilder(ConfigHelper.ActiveConnection);
    sqlConnectionStringBuilder["Database"] = guid.ToString();
    ConfigHelper.ActiveConnection = sqlConnectionStringBuilder.ToString();
    Database.DefaultConnectionFactory =
        new System.Data.Entity.Infrastructure.SqlConnectionFactory(ConfigHelper.ActiveConnectionString());

    Database.SetInitializer(
        new MigrateDatabaseToLatestVersion<TestContext, MigrationConfiguration>());
    using (var context = new TestContext())
    {
        context.Database.Initialize(true);
    }
} 
```

应用程序只是为第一个项目创建数据库，然后尝试迁移预览数据库。
我没有直接在我的代码中创建 DbConext 对象，因此我无法将连接字符串传递给它的构造函数。
你对我的问题有什么建议？
我的代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T23:36:15.853

这是一个棘手的部分 - 更改连接字符串。它有点工作，但有问题。

[昨天我们就此进行了长时间的讨论](https://stackoverflow.com/questions/15856703/is-adding-a-class-that-inherits-from-something-a-violation-of-the-solid-principl/15857842#15857842)。看看我的这篇（和相关的）帖子——它描述了基于类似方法的代码问题的一些背景。

如果需要，我想进一步帮助你 - 但我需要更多信息......

为什么说`I don't create DbConext object directly in my codes so I can't pass connection string to its constructor`？你有`TestContext`- 为什么不通过那里？

另外我不确定是否设置`DefaultConnectionFactory`，我会重新检查。允许设置，但似乎只在应用启动时推荐，不确定。同时查找此链接（它适用于 EF6，但我认为代码类似 - 您可以查找源代码） - [http://msdn.microsoft.com/en-US/data/jj680699](http://msdn.microsoft.com/en-US/data/jj680699)

我们得出的结论是，在这种情况下使用 DbContext 工厂是有益的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T03:07:40.917

会在 DbContext 类上添加一个静态属性来存储数据库的名称（初始目录），然后更改连接字符串以便使用 string.Format 插入数据库名称吗？

然后，您可以在下次创建上下文时随时更改数据库名称，它将指向一个新目标。

# css - Css 居中 - 它随机跳到位

> ID：15857458
> 
> 赞同：0
> 
> 时间：2013-04-07T00:16:35.017
> 
> 标签：css, google-chrome, safari, center, prestashop

我正在为我的网上商店创建一个新网站 - 我有这个 css 问题......

该系统是在 prestashop 平台上制作的，但这是基本的 CSS，所以没关系。

在 CMS 页面上，我在页面居中时遇到问题，我尝试使用 -tag、margin: 0 auto、margin-Left/right auto、100% 宽度等。

问题不在于文本没有居中，而是浏览器没有意识到它，直到您使用检查器更改某些内容或更改浏览器宽度。因此，如果您更新网站，内容会立即到位。

（如果您没有发现问题，请尝试再次按相同的菜单项 - 有时会起作用，有时会不起作用。问题最多的网站是：/betingelser-3、/udtalelser-6 和 /om-os-4 .)

问题仅存在于 Safari 和 Chrome (webkit) 中，在 IE、firefox、Opera 上一切正常。

[http://forsejt.dk/mackabler.dk/content/betingelser-3](http://forsejt.dk/mackabler.dk/content/betingelser-3)

我认为 div 和 css 样式太多了，所以浏览器会超时？如果这可能发生:) 我试过 Macbook pro 15"、Macbook air 13" 和 Mac pro。

有什么Css技巧吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:24:17.453

尝试添加：

```
text-align: center; 
```

到CSS中的#columns。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T00:31:56.130

所以我不太确定这是为什么，但似乎溢出：隐藏在 .row 中是罪魁祸首。尝试删除它或覆盖它，它似乎工作。我的猜测是它会因为某种原因妨碍 webkit 正确计算宽度？

这里还有一些关于类似问题的其他建议：[CSS centering not working with margin auto and overflow hidden](https://stackoverflow.com/questions/10829414/css-centering-not-working-with-margin-auto-and-overflow-hidden)

但在我看来，那里接受的解决方案对您不起作用，因为看起来您的所有浮动都已正确清除。

# php - MySQL搜索/随机行

> ID：15857460
> 
> 赞同：0
> 
> 时间：2013-04-07T00:16:53.487
> 
> 标签：php, mysql, performance, search

希望我能很好地解释这一点！..

我想在 MySQL 表中搜索某些关键字，很酷，没问题，我可以这样做..

但是.. 我想根据这些关键字的良好匹配只返回 1 个随机行。

如果我有一张包含数千行的表格并保持一切都超级快，那么最好的方法是什么。

首先要记住的是返回一个包含 10 个随机行的数组，循环遍历它们，并检查 PHP 中的关键字，然后继续运行，直到找到一个好的匹配项然后停止.. 所以如果在前 10 个中没有找到匹配项它将再次查询数据库..

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:22:09.307

```
SELECT * FROM table WHERE search="word" ORDER BY RAND() LIMIT 1; 
```

# javascript - 如何使用javascript从变量中获取基本url

> ID：15857462
> 
> 赞同：0
> 
> 时间：2013-04-07T00:17:04.393
> 
> 标签：javascript, html

在这个脚本中，我想将 baseURLStatic 定义为 http//:%ALLHOST%

```
document.write("<li id='tab"+x+"' onclick='window.location.assign(\""+baseURLStatic+"/"+year+"/home/"+league_id+"#"+x+"\")'>"+mimicHomePageTabs[x]+"</li>\n"); 
```

我试过这个，但没有奏效

```
document.write("<li id='tab"+x+"' onclick='window.location.assign(\""+http+"//:"+%ALLHOST%+"/"+year+"/home/"+league_id+"#"+x+"\")'>"+mimicHomePageTabs[x]+"</li>\n"); 
```

url 的最终结果是这样的

```
http://%ALLHOST%/%YEAR%/home/%LEAGUEID% 
```

# java - Pelops Java 客户端插入 Cassandra 数据库

> ID：15857465
> 
> 赞同：0
> 
> 时间：2013-04-07T00:18:19.740
> 
> 标签：java, cassandra, pelops

我最近开始使用 Cassandra 数据库。我能够在我的本地机器上设置单节点集群。

现在我正在考虑开始使用`Pelops client`.

以下是我迄今为止创建的键空间和列族-

```
create keyspace my_keyspace with placement_strategy = 'org.apache.cassandra.locator.SimpleStrategy' and strategy_options = {replication_factor:1};
use my_keyspace;
create column family users with column_type = 'Standard' and comparator = 'UTF8Type'; 
```

下面是我到目前为止的代码。我取得了一些进展，因为我得到了一些我能够修复的异常。现在我得到另一个例外

```
public class MyPelops {
    private static final Logger log = Logger.getLogger(MyPelops.class);

    public static void main(String[] args) throws Exception {

        // A comma separated List of Nodes
        String NODES = "localhost";
        // Thrift Connection Pool
        String THRIFT_CONNECTION_POOL = "Test Cluster";
        // Keyspace
        String KEYSPACE = "my_keyspace";
        // Column Family
        String COLUMN_FAMILY = "users";
        Cluster cluster = new Cluster(NODES, 9160);
        Pelops.addPool(THRIFT_CONNECTION_POOL, cluster, KEYSPACE);
        Mutator mutator = Pelops.createMutator(THRIFT_CONNECTION_POOL);
        log.info("- Write Column -");
        mutator.writeColumn(
                COLUMN_FAMILY,
                "Row1",
                new Column().setName(" Name ".getBytes()).setValue(
                        " Test One ".getBytes()));
        mutator.writeColumn(
                COLUMN_FAMILY,
                "Row1",
                new Column().setName(" Work ".getBytes()).setValue(
                        " Engineer ".getBytes()));
        log.info("- Execute -");
        mutator.execute(ConsistencyLevel.ONE);
        Selector selector = Pelops.createSelector(THRIFT_CONNECTION_POOL);
        int columnCount = selector.getColumnCount(COLUMN_FAMILY, "Row1",
                ConsistencyLevel.ONE);
        log.info("- Column Count = " + columnCount);
        List<Column> columnList = selector
                .getColumnsFromRow(COLUMN_FAMILY, "Row1",
                        Selector.newColumnsPredicateAll(true, 10),
                        ConsistencyLevel.ONE);
        log.info("- Size of Column List = " + columnList.size());
        for (Column column : columnList) {
            log.info("- Column: (" + new String(column.getName()) + ","
                    + new String(column.getValue()) + ")");
        }
        log.info("- All Done. Exit -");
        System.exit(0);
    }
} 
```

每当我运行这个程序时，我都会收到这个异常 -

```
Exception in thread "main" org.scale7.cassandra.pelops.exceptions.InvalidRequestException: Column timestamp is required 
```

一旦尝试执行此行，就会出现此异常-

`mutator.execute`线

正如我上面提到的，我也是 Cassandra 数据库和 Pelops 客户端的新手。这是我第一次使用它。任何人都可以通过逐步过程帮助我解决这个问题吗？我在本地机器上运行 Cassandra 1.2.3。

任何一步一步的指导，比如如何在 Cassandra 数据库中插入数据都将有助于我理解 Cassandra 的工作原理。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T14:55:53.430

每个 cassandra 列都是一个 Key-Value-Timestamp 三元组。你没有在你的列中设置时间戳

```
Column c = new Column();
c.setTimestamp(System.currentTimeMillis()); 
```

可以使用客户端的方式创建列，让工作更轻松

```
 mutator.writeColumn(
            COLUMN_FAMILY,
            "Row1",
            mutator.newColumn(" Name ", " Test One ")); 
```

通过这种方式，您可以避免设置时间戳（客户端会为您完成）和在 String 上使用 getBytes()。

问候， 卡罗

# database-design - 键/值对类型表的 Eloquent 最佳实践

> ID：15857469
> 
> 赞同：5
> 
> 时间：2013-04-07T00:19:20.210
> 
> 标签：database-design, orm, laravel, eloquent, laravel-3

我的应用程序是用于企业网站的 CMS。我有一个名为 business_info 的表，如下所示：

```
id  | field         | value
-----------------------------------------
1   | name          | Testing Company
2   | official name | Testing Company LLC
3   | main_location | The Bay Area
4   | year          | 1999
5   | address       | 55 Street Rd
6   | suite         | Unit 5
7   | city          | Anytown
8   | state         | CA
9   | zip           | 55555
10  | tollfree      | 1(888) 555-5555 
```

我认为当前的 Eloquent 模型无法有效地管理这些信息，因此我对其进行了扩展并开始研究一个更有用的模型。我希望能够做类似的事情：

```
$business_info->zip = "66666";
$business_info->save(); 
```

这是我到目前为止所拥有的，但我不确定如何进行：

```
class Business_Info extends Eloquent
{
    public static $table = 'business_info';

    public static function all()
    {
        $business_info_rows = with(new static)->query()->get();
        foreach ($business_info_rows as $business_info_row)
        {
            $business_info[$business_info_row->attributes['field']] = $business_info_row->attributes['value'];
        }
        return $business_info;
    }

    public function __set($key, $value)
    {

    }
} 
```

也许有人可以就如何进行或另一种方法提供一些建议？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T23:57:13.430

您走在正确的轨道上，尤其是在覆盖`__set`魔术方法时。基本上，对于这个特定的模型，您会希望该方法看起来像这样。

```
public function __set($key, $value)
{
    $this->set_attribute('field', $key);
    $this->set_attribute('value', $value);
} 
```

当您执行类似的操作时，它将`field`和列设置为各自的值`value``$business_info->zip = "12345";`

至于获取所有的业务信息，你真的只想返回一个数据数组吗？我可能会为此制定一种新方法并保持原样。但在我看来，你所拥有的一切都很好。

# fuelux - 如何隐藏fuelux数据网格中的列

> ID：15857471
> 
> 赞同：4
> 
> 时间：2013-04-07T00:20:10.420
> 
> 标签：fuelux

我正在尝试创建一个隐藏列，该列将包含行的唯一“id”作为属性，例如“data-id”。因为我似乎无法弄清楚如何检索行后面的数据模型。我正在使用服务器端数据源。

```
columns: [{
  property: 'hiddencolumn',
  label: '',
  hidden: true   <-- ?????
} .. .. ], 
```

在格式化程序中，我使用了一些占位符标签，可能是一个跨度

```
$.each(items, function(index, item) {
  item.hiddencolumn = '<span data-id="' + item.id + '"</span>';
}); 
```

然后我在该行中添加一个点击处理程序，然后获取 data-id 列：

```
$('#MyGrid').on('loaded', function() {
  $('#MyGrid > tbody > tr').click(function() {
    console.log($(this).find('> td > span').attr('data-id'));
  });
}); 
```

它是否正确？或者我应该尝试将 data-id 添加到 tr 标签/行本身？上述概念有效，但我只需要知道如何隐藏该列:)

谢谢

编辑 4 月 14 日 - 这是我为解决这个问题所做的。使用 data-id 并隐藏现有列中的跨度。对我来说，我的模型中有一个“日期”和“ID”字段。我选择将 id 标记到日期字段上。

```
formatter: function(items) {
  $.each(items, function(index, item) {
    item.date = item.date + '<span style="visibility: hidden;" data-id="' + item.id + '"/>';
  });
} 
```

然后像这样检索id（使用jquery）

```
$('#MyGrid').on('loaded', function() {
  $('#MyGrid > tbody > tr').click(function() {
    console.log($(this).find('> td > span').attr('data-id')); // value is here
  });
}); 
```

好的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T00:46:19.070

该`columns`属性仅适用于可见列。所以，听起来你会想要删除它，并在你的格式化程序中`data-id`为你的其他（可见）列之一创建一个带有属性的跨度。如果有任何按钮或其他控件可以作用于行中的项目，我通常会在最后一列中执行此操作。

# android - 如果在检查存在行时表为空，Sqlite 会杀死应用程序吗？

> ID：15857472
> 
> 赞同：0
> 
> 时间：2013-04-07T00:20:11.807
> 
> 标签：android, sqlite

只有当我想检查行是否存在时，我才会面临 Sqlite 的问题。

如果表是空的，那么应用程序应该被 android 杀死并关闭。我试图追踪问题，但我找不到它，我的代码中的问题在哪里？

这是我的 Sql 类中的行检查存在函数：

```
 public boolean clExists( String email )
      {

          Cursor cursor = database.rawQuery("select 1 from "+TABLE_client+" where "+cl_email+"="+email, null);
          boolean exists = (cursor.getCount() > 0) ? true : false;
           cursor.close();
          return exists;

      } 
```

这就是我执行代码的地方（ jsinfo.getString("email") ）从 Json 数组返回的电子邮件字符串并且它不为空

```
datasource.open();
if ( datasource.clExists(jsinfo.getString("email")))
{
    Toast.makeText(Login.this, "exists "+jsinfo.getString("email"), Toast.LENGTH_LONG).show();  
}else
{
    Toast.makeText(Login.this, "not exists "+jsinfo.getString("email"), Toast.LENGTH_LONG).show();
}    
datasource.close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T03:57:44.103

您需要电子邮件之间的文字

```
Cursor cursor = database.rawQuery("select 1 from "+TABLE_client
                                 +" where "+cl_email+"='"+email+"'", null); 
```

# iphone - 在 dealloc 方法中写入文件

> ID：15857475
> 
> 赞同：0
> 
> 时间：2013-04-07T00:20:24.887
> 
> 标签：iphone, ios, objective-c, dealloc

我正在编写一个 iOS 应用程序，其中我的主要“UIViewController”创建了一个模型（NSObject 的子类）。当我使用完模型后，我希望模型将一些数据写入文件。用我的模型的“dealloc”方法编写这个文件对我来说是否合适/正确？我希望这个文件写入总是发生，即使用户退出应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:25:36.557

请不要这样做-dealoc（请参阅[此处](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSObject_Class/Reference/Reference.html#//apple_ref/doc/uid/20000050-dealloc)）方法应该释放内存（并且写入文件/保存与此相反）并且您无法控制何时调用它（也许用户退出应用程序并dealoc一次都没有被调用）。您可以创建一个 costum 方法，当您完成模型对象时调用该方法。如果您想确保在用户退出应用程序时保存数据，请将您的保存方法写入`- (void)applicationDidEnterBackground:(UIApplication *)application`

# android-listview - 当我尝试在列表视图中搜索时出现 NullPointerException

> ID：15857477
> 
> 赞同：1
> 
> 时间：2013-04-07T00:20:31.127
> 
> 标签：android-listview, nullpointerexception, simpleadapter

我有一个带有列表视图和 TextEdit 的活动，用于在该列表视图中进行搜索，当我开始该活动时，所有项目都已加载，但是当我尝试在 EditText 中键入任何单词时，会出现 NullPointerException。

```
 04-06 19:35:23.249: E/AndroidRuntime(8354): FATAL EXCEPTION: main
    04-06 19:35:23.249: E/AndroidRuntime(8354): java.lang.NullPointerException
    04-06 19:35:23.249: E/AndroidRuntime(8354):     at android.widget.SimpleAdapter.getCount(SimpleAdapter.java:93)
    04-06 19:35:23.249: E/AndroidRuntime(8354):     at android.widget.AdapterView.checkFocus(AdapterView.java:689)
    04-06 19:35:23.249: E/AndroidRuntime(8354):     at android.widget.AdapterView$AdapterDataSetObserver.onInvalidated(AdapterView.java:812)
    04-06 19:35:23.249: E/AndroidRuntime(8354):     at android.database.DataSetObservable.notifyInvalidated(DataSetObservable.java:43)
    04-06 19:35:23.249: E/AndroidRuntime(8354):     at android.widget.BaseAdapter.notifyDataSetInvalidated(BaseAdapter.java:54)
    04-06 19:35:23.249: E/AndroidRuntime(8354):     at android.widget.SimpleAdapter$SimpleFilter.publishResults(SimpleAdapter.java:383)
    04-06 19:35:23.249: E/AndroidRuntime(8354):     at android.widget.Filter$ResultsHandler.handleMessage(Filter.java:282)
    04-06 19:35:23.249: E/AndroidRuntime(8354):     at android.os.Handler.dispatchMessage(Handler.java:99)
    04-06 19:35:23.249: E/AndroidRuntime(8354):     at android.os.Looper.loop(Looper.java:130)
    04-06 19:35:23.249: E/AndroidRuntime(8354):     at android.app.ActivityThread.main(ActivityThread.java:3768)
    04-06 19:35:23.249: E/AndroidRuntime(8354):     at java.lang.reflect.Method.invokeNative(Native Method)
    04-06 19:35:23.249: E/AndroidRuntime(8354):     at java.lang.reflect.Method.invoke(Method.java:507)
    04-06 19:35:23.249: E/AndroidRuntime(8354):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:878)
    04-06 19:35:23.249: E/AndroidRuntime(8354):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:636)
    04-06 19:35:23.249: E/AndroidRuntime(8354):     at dalvik.system.NativeStart.main(Native Method) 
```

这是活动代码：

```
 package com.ferresis;

    import java.util.ArrayList;
    import java.util.HashMap;

    import android.app.ListActivity;
    import android.content.ComponentName;
    import android.content.Context;
    import android.content.Intent;
    import android.content.ServiceConnection;
    import android.os.Bundle;
    import android.os.IBinder;
    import android.text.Editable;
    import android.text.TextWatcher;
    import android.util.Log;
    import android.view.Menu;
    import android.view.View;
    import android.widget.AdapterView;
    import android.widget.AdapterView.OnItemClickListener;
    import android.widget.EditText;
    import android.widget.ListView;
    import android.widget.SimpleAdapter;

    import com.ferresis.db.DBAdapter;
    import com.ferresis.db.DBAdapter.LocalBinder;
    import com.ferresis.db.Productos.ProductosColumns;

    public class Act_Productos extends ListActivity {
        final String[] from = {ProductosColumns.CODIGO ,ProductosColumns.DESCRIPCION};
        final int[] to = new int[] {R.id.rowProdutos_Codigo, R.id.rowProdutos_Descripcion};

        DBAdapter dbAdapter;
        Boolean mBound;

        SimpleAdapter ListAdapter;
        @Override
        protected void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_productos);
        }

        @Override
        public boolean onCreateOptionsMenu(Menu menu) {
            // Inflate the menu; this adds items to the action bar if it is present.
            getMenuInflater().inflate(R.menu.act__productos, menu);
            return true;
        }

        @Override
        protected void onStart() {
            super.onStart();
            // Enlazamos con el Servicio
            Intent intent = new Intent(this, DBAdapter.class);
            bindService(intent, mConnection, Context.BIND_AUTO_CREATE);
        }

        @Override
        protected void onStop() {
            super.onStop();
            // Nos desenlazamos del servicio
            if (mBound) {
                unbindService(mConnection);
                mBound = false;
            }
        }

        private ServiceConnection mConnection = new ServiceConnection() {

            @Override
            public void onServiceConnected(ComponentName className, IBinder service) {
                // Enlazamos con LocalService, casteamos el IBinder y obtenemos así
                // la instancia del Servicio
                LocalBinder binder = (LocalBinder) service;
                dbAdapter = binder.getService();
                mBound = true;
                loadProductos();
            }

            @Override
            public void onServiceDisconnected(ComponentName arg0) {
                mBound = false;
            }
        };

        private void loadProductos() {
            ArrayList<Producto> productos = dbAdapter.getAllProductos();

            // Fill List with DATA
            ArrayList<HashMap<String, String>> HProductos = new ArrayList<HashMap<String, String>>();
            for (Producto producto : productos) {

                HashMap<String, String> Data = new HashMap<String, String>();

                Data.put(ProductosColumns._ID, String.valueOf(producto.getID()));
                Data.put(from[0], producto.getCodigo());
                Data.put(from[1], producto.getDescripcion());

                HProductos.add(Data);
            }

            ListAdapter = new SimpleAdapter(this, HProductos,
                    R.layout.row_productos, from, to);
            setListAdapter(ListAdapter);

            EditText etSearchbox=(EditText)findViewById(R.id.txtProducto_Busqueda);
            final ListView lv = getListView();
            lv.setTextFilterEnabled(true);

            etSearchbox.addTextChangedListener(new TextWatcher() {

                @Override
                public void onTextChanged(CharSequence arg0, int arg1, int arg2, int arg3) {
                    // TODO Auto-generated method stub
                    Act_Productos.this.ListAdapter.getFilter().filter(arg0);
                    Log.d("Log","p1");
                }

                @Override
                public void beforeTextChanged(CharSequence arg0, int arg1, int arg2,
                        int arg3) {
                    // TODO Auto-generated method stub

                }

                @Override
                public void afterTextChanged(Editable arg0) {
                    // TODO Auto-generated method stub

                }
            }); 

            lv.setOnItemClickListener(new OnItemClickListener() {
                  public void onItemClick(AdapterView<?> myAdapter, View myView, int myItemInt, long mylng) {
                    //String selectedFromList =(String) ();
                      Intent returnIntent = new Intent();
                      String item = "" + lv.getItemAtPosition(myItemInt);
                      item = item.substring(item.indexOf("=")+1,item.indexOf(","));
                      returnIntent.putExtra("idProducto",item);
                      setResult(RESULT_OK,returnIntent);
                      finish();                             
                  }                 
            });     
        }       

    } 
```

# xpages - Xpage, createForm=false 禁用链接上的 SSJS 事件？

> ID：15857479
> 
> 赞同：2
> 
> 时间：2013-04-07T00:20:44.387
> 
> 标签：xpages, xpages-ssjs

我想在这里澄清一下：我不小心将 createForm 属性设置为 false。然后我期望一个应该打开另一个页面的链接事件不再起作用。这是 SSJS 事件的预期行为，例如当您禁用表单创建时在链接中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-07T05:58:18.720

正如 Per 提到的，所有事件都需要一个表单：如果它们是完全刷新的，那么页面需要一个表单来发布以触发重定向；如果它们是部分刷新，则表单确定 AJAX POST 的内容。

XPages 运行时包括对表单组件的支持，但它不包含在组件面板中（并且无法通过 Designer Preferences 添加），因此将其添加到页面的唯一方法是直接编辑源 XML。例如：

```
<xp:form>
    <xp:link id="exampleLink" text="Example Text">
        <xp:eventHandler event="onclick" submit="true" refreshMode="complete">
            <xp:this.action><![CDATA[#{javascript:// event code}]]></xp:this.action>
        </xp:eventHandler>
    </xp:link>
</xp:form> 
```

这个组件有用有（至少）两个原因：

1.  **它可以提高性能。**如果一个页面包含功能不同的不同区域——换句话说，页面的一个部分中的事件不需要知道页面的任何其他部分中的数据——然后将每个部分包装在一个单独的表单组件中导致每个事件仅发布包含在与触发事件的组件相同的表单中的数据。您的问题表明您设置为时断开的`createForm`链接`false`应该将用户导航到另一个页面；因此，这个事件很可能不需要知道任何字段值，因为用户无论如何都会离开当前页面。如果这是真的，请将此链接包装在其自己的表单中，并将任何字段包装在单独的表单中，并且该链接的执行速度会稍微快一些，因为浏览器不必发布任何字段数据......只是链接本身的标识符。
2.  **它可以提供样式灵活性。**开发人员通常会从不熟悉 Domino 的设计师那里收到预先确定的 CSS，而不是实际的最终用户需求——例如，如果网站设计是外包的，或者必须遵守公司样式指南。当设计师做出某些假设时，这通常会成为紧张的根源，乍一看，这些假设与 Domino 生成的标记不兼容。最常见的示例之一是站点包含搜索功能，因为大多数 Web 开发人员将使用一个表单用于搜索，而将一个单独的同级表单用于任何其他字段。当设计人员或开发人员必须修改设计人员已经开发的样式表以说明围绕所有内容的单个表单标记时，这会增加项目的成本。简而言之，

因此，在许多用例中，实际上最好在 XPage 上使用一个或多个表单组件......只要记住所有数据和事件都必须在一个表单内——无论是通常围绕所有内容的默认表单，还是一个手动包含表单组件——并且表单不能嵌套。您可以根据需要添加任意数量的表单组件，但它们必须是*同级*组件。任何形式都不能包含另一个形式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-07T04:33:31.463

是的，因为您正在执行 HTTP POST 请求并且它们需要一个表单。

您可以将 POST 请求链接转换为 GET 请求链接，而不是删除 SSJS 事件并创建“基本”链接：

```
<xp:link escape="true" text="Link" id="link2" value="/somepage.xsp"></xp:link> 
```

但是如果你需要 SSJS 逻辑，那么你还需要一个表单。

# android - 语音消息的 Android 编码器和文件格式

> ID：15857482
> 
> 赞同：0
> 
> 时间：2013-04-07T00:21:09.187
> 
> 标签：android, audio, recording

我正在开发一个需要向服务器发送短（<60 秒）语音消息的 Android 应用程序。

文件大小非常重要，因为我们不想吃掉数据计划。声音质量很重要，因为信息需要被识别，但它需要的带宽/质量应该比音乐文件少得多。

哪些标准的 Android 音频编码器 ( [http://developer.android.com/reference/android/media/MediaRecorder.AudioEncoder.html](http://developer.android.com/reference/android/media/MediaRecorder.AudioEncoder.html) ) 和文件格式 ( [http://developer.android.com/reference/android/media/ MediaRecorder.OutputFormat.html](http://developer.android.com/reference/android/media/MediaRecorder.OutputFormat.html)）可能最适合这个应用程序？

任何关于比特率等良好起点的提示也将受到欢迎。

我们最终需要能够在 Windows 和 iOS 上播放它们，但如果需要一些后端转换也没关系。似乎没有一个有效的跨平台格式/编码器，所以这就是我们将投入工作的地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T14:58:27.977

AMR 正是针对语音压缩，是最常用于普通电路交换语音呼叫的编解码器。
窄带变体（AMR-NB，8kHz 采样率）仍然是使用最广泛的版本，几乎所有你能找到的手机都应该支持。
宽带变体（AMR-WB，16kHz 采样率）提供更好的质量，如果目标设备支持它并且您可以节省带宽，则它是首选。
AMR 的典型比特率范围约为 6 到 14 kbit/s。
我不确定是否有任何适用于 Windows 的媒体播放器可以直接处理带有 AMR 音频的 .3GP 文件（VLC 可能）。不过，有些转换器可以使用。

HE-AAC (v1) 也可用于语音编码，但[此页面](http://developer.android.com/guide/appendix/media-formats.html)建议 Android 上的编码支持仅限于 Android 4.1 及更高版本。合适的速率可能是 16 kHz / 64 kbps。

# parsing - 使用 powershell 解析报告

> ID：15857486
> 
> 赞同：0
> 
> 时间：2013-04-07T00:21:43.317
> 
> 标签：parsing, powershell

我正在尝试使用 powershell 收集一些统计信息。

我有大约 4,000 份看起来像这样的报告（都在他们自己的 Report.txt 文件中 - 有些有更多字段。我已经对其进行了狙击）：

我想做的（大声思考）是获取每个 [ ] 并将其设为 csv 标题，然后在该标题下添加每个项目。然后我可以对它运行简单的计数语句并提取一些数据。也许有更好/更简单的方法？

这个想法是有一些像：

请求的权限：android.permission.INTERNET 3,562 of 4,000 请求的权限：android.permission.READ_SMS 1 of 4,000 等等...

到目前为止，我已经剥离了字符串，因此它不再有空格和 *.

```
[ Package name ]
 * com.software.application

[ Requested Permissions ]
 * android.permission.INTERNET
 * android.permission.READ_PHONE_STATE
 * android.permission.READ_SMS
 * android.permission.RECEIVE_SMS
 * android.permission.SEND_SMS
 * android.permission.WAKE_LOCK
 * android.permission.WRITE_EXTERNAL_STORAGE
 * com.google.android.c2dm.permission.RECEIVE
 * com.software.application.permission.C2D_MESSAGE

[ Responsible API calls for used Permissions ]
 * android/app/NotificationManager;->notify
 * android/content/Context;->sendBroadcast
 * android/content/Context;->startService
 * android/os/PowerManager$WakeLock;->acquire
 * android/os/PowerManager$WakeLock;->release
 * android/telephony/SmsManager;->sendTextMessage

[ Potentially dangerous Calls ]
 * getSystemService
 * HttpPost
 * sendSMS 
```

当前输出示例：

```
[PotentiallydangerousCalls]
getSystemService
HttpPost
sendSMS 
```

所以现在有点干净了...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T06:38:28.150

如果我有时间，我会放一些代码，但这里有一本路书：

1) 编写一个函数 (CsvToObject)，它获取 csv 文件的路径和名称，并返回一个 PSObject，其中每个 [value] 都有一个属性

*   此函数可以利用`switch ... case`PowerShell 结构和正则表达式和文件使用。

2) 获取每个 *.csv 文件 ( `Get-ChildItem`) ，调用您的函数并将结果输入`Export-CSV`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T16:11:01.660

您当前的输出示例的结构类似于 ini 文件。这篇[关于 ini 文件的 Scripting Guy 帖子](http://blogs.technet.com/b/heyscriptingguy/archive/2011/08/20/use-powershell-to-work-with-any-ini-file.aspx)可能很有用。一些正则表达式帮助[here](https://stackoverflow.com/questions/546433/regular-expression-to-match-outer-brackets)和[here](https://stackoverflow.com/questions/11299893/powershell-regex-check-for-string-between-brackets)。

# c# - 按钮打开 Form2 正在中止主线程（无意）

> ID：15857490
> 
> 赞同：0
> 
> 时间：2013-04-07T00:22:11.053
> 
> 标签：c#, multithreading, winforms, graphics

**已确认的问题：由于某种未知原因，我的砖块图案按钮正在我的退出按钮中运行代码**

```
 private void brickToolStripMenuItem_Click(object sender, EventArgs e)
    {
        //if (f2 != null) return;
        f2 = new Form2();
        f2.ShowDialog();
    }

    private void exitToolStripMenuItem_Click(object sender, EventArgs e)
    {
        myThread.Abort();
        Close();
    } 
```

我正在创建这个破砖游戏，它有一个用于主窗口的线程（包括桨和砖）和一个用于球运动的线程。在我的程序中，如果我单击按钮打开 form2，整个程序就会终止，因为它正在运行另一个按钮的代码。

是否有另一种打开 form2 的方法不会终止我的程序？我尝试了不同类型的 Show `ShowDialog`，在这种情况下，我看到了 form2 四分之一秒。然后整个程序终止。

这是我的 form1 代码的链接。[http://pastebin.com/FB19qd7e](http://pastebin.com/FB19qd7e) Form1 设计器代码： http: [//pastebin.com/RS8VZT5U](http://pastebin.com/RS8VZT5U)

编辑：输出显示这个

> mscorlib.dll 中出现“System.Threading.ThreadAbortException”类型的第一次机会异常 mscorlib.dll 中出现“System.Threading.ThreadAbortException”类型的异常，但未在用户代码中处理

好的，我有三个按钮，一个退出、暂停和砖块（打开 form2）。暂停按钮按预期工作，退出也是如此。但是，如果我单击砖块按钮，由于某种原因，它会从退出按钮运行 Thread.Abort。如果我注释掉退出按钮代码，那么砖块按钮工作得很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-07T14:15:03.230

看起来您已将设计器中的事件连接到`Deactivate`事件处理程序。`Form1``exitToolStripMenuItem_Click`

```
this.Deactivate += new System.EventHandler(this.exitToolStripMenuItem_Click); 
```

`exitToolStripMenuItem_Click`当您的实例`Form1`失去焦点时，这将调用。当您显示`Form2`现有实例的新实例时，`Form1`将不再是活动表单，这将触发对事件处理程序的调用，而事件处理程序又将调用`Abort`.

# android - 优化alertDialog布局？

> ID：15857493
> 
> 赞同：0
> 
> 时间：2013-04-07T00:22:34.933
> 
> 标签：android, android-layout, android-ui, android-alertdialog

我想创建以下适用于每种类型平板电脑的布局。我知道我们可以通过将它们放置在可绘制对象中并对其进行编辑来设置不同的设置，但是是否有替代方法来实现呢？以下是我为所有 7 英寸尺寸的平板电脑创建的意图： ![在此处输入图像描述](https://i.stack.imgur.com/ETQEv.png)

以下是我的xml代码：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
    >
<TextView
    android:id="@+id/widget38"
    android:layout_width="480dp"
    android:layout_height="45dp"
    android:background="@color/White"
    android:text="Reminder"
    android:textSize="20dp"
    android:textColor="@color/Black"
    android:layout_alignParentTop="true"
    android:layout_alignParentLeft="true" />

<TextView
    android:id="@+id/label"
    android:layout_width="476dp"
    android:layout_height="70dp"
    android:layout_alignParentLeft="true"
    android:layout_alignParentRight="true"
    android:layout_below="@+id/widget38"
    android:background="@color/White"
    android:text="DID you have your Pill?"
    android:textColor="@color/Black"
    android:textSize="40dp" />

<Button
    android:id="@+id/yes"
    android:layout_width="224dp"
    android:layout_height="161dp"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:layout_alignRight="@+id/widget38"
    android:layout_below="@+id/label"
    android:background="@color/Green"
    android:text="Yes" />

<Button
    android:id="@+id/no"
    android:layout_width="239dp"
    android:layout_height="161dp"
    android:layout_alignParentBottom="true"
    android:layout_alignParentRight="true"
    android:layout_below="@+id/label"
    android:layout_toRightOf="@+id/widget38"
    android:background="@color/Red"
    android:text="No/Cancel" />

</RelativeLayout> 
```

我创建警报的java代码：

```
Button button=(Button)findViewById(R.id.button1);
        button.setOnClickListener(new View.OnClickListener() {

            @SuppressWarnings("deprecation")
            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub

                View view= getLayoutInflater().inflate(R.layout.custom, null);
                final AlertDialog.Builder builder = new AlertDialog.Builder(MainActivity.this);

                builder.setView(view);
                // set the custom dialog components - text, image and button
                    TextView t=(TextView)view.findViewById(R.id.widget38);
                TextView text = (TextView)view.findViewById(R.id.label);

                Button yesButton = (Button) view.findViewById(R.id.yes);
                Button noButton=(Button)view.findViewById(R.id.no);

                final AlertDialog dialog=builder.create();  

                noButton.setOnClickListener(new OnClickListener() {
                    @Override
                    public void onClick(View v) {
                        dialog.dismiss();
                    }
                });

                yesButton.setOnClickListener(new OnClickListener() {
                    @Override
                    public void onClick(View v) {
                        dialog.dismiss();
                    }
                });

            Display display = getWindowManager().getDefaultDisplay(); 
                int width = display.getWidth();
                int height = display.getHeight();

                dialog.show();
                dialog.getWindow().setLayout(width, height); 
```

根据答案编辑了代码，它在 Eclipse IDE 中正确显示，但是在模拟器上尝试时，它看起来非常不同。无法背诵..请帮助。 ![出现在 nexus 7 模拟器中的输出，但它在 eclipse xml 编辑器中正确显示](https://i.stack.imgur.com/xbdYG.png)

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    >

    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
         >

        <TextView 
            android:id="@+id/ReminderMessage"
          android:layout_width="fill_parent"  
          android:layout_height="match_parent"
            android:background="@color/Aqua"
        android:textColor="@color/Black"
    android:textSize="10dp"
            />

    </RelativeLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="3" 
        android:baselineAligned="false"
        android:layout_alignParentLeft="true"
    android:layout_alignParentRight="true"

        >

        <RelativeLayout
            android:layout_width="0dp"
            android:layout_height="match_parent"
            android:layout_weight="1"
            android:background="#0F0" >

            <Button
                android:id="@+id/yes"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:text="Yes"
            android:background="@color/Green"
            android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/ReminderMessage"

                >
            </Button>

        </RelativeLayout>

        <RelativeLayout
            android:layout_width="0dp"
            android:layout_height="match_parent"
            android:layout_weight="1"
            android:background="#F00" >

            <Button
                android:id="@+id/no"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:text="No/Cancel"
            android:background="@color/Red"
            android:layout_alignParentBottom="true"
    android:layout_alignParentRight="true"
    android:layout_below="@+id/ReminderMessage"
                >
            </Button>

        </RelativeLayout>

    </LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:48:58.873

编辑：修改为显示线性布局的反向加权。

如果您想要不同尺寸的不同外观，layout/layout-large/layout-xlarge 文件夹将是定义特定于不同尺寸范围（例如 7"）的警报的最简单方法。

如果您使用 Eclipse 作为您的 IDE，请选择“所有屏幕”以很好地概述一系列设备。

除此之外，如果您考虑到特定的比率，线性布局是一种根据百分比定义的简单方法。这是您的线性布局（它将保持屏幕尺寸的比例）：

![在此处输入图像描述](https://i.stack.imgur.com/z3Oha.png)

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="3" >

    </RelativeLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1" >

        <RelativeLayout
            android:layout_width="0dp"
            android:layout_height="match_parent"
            android:layout_weight="1"
            android:background="#0F0" >

        </RelativeLayout>

        <RelativeLayout
            android:layout_width="0dp"
            android:layout_height="match_parent"
            android:layout_weight="1"
            android:background="#F00" >

        </RelativeLayout>

    </LinearLayout>

</LinearLayout> 
```

# c# - MVC4 区域路由：默认控制器上的操作方法

> ID：15857494
> 
> 赞同：0
> 
> 时间：2013-04-07T00:23:20.247
> 
> 标签：c#, asp.net-mvc-4

我有一个带有公司区域的 MVC4 应用程序。

给定文件结构：

```
Areas   
\
  Companies
    \
     Controllers
       |
       DefaultController (Contains Index and Edit actions)
       TestController (Contains Index and Test action) 
```

我希望我的 URL 是这样的：

*   /公司
*   /公司/编辑
*   /公司/测试
*   /公司/测试/测试

我的路线设置就像在我的 CompaniesAreaRegistration 课程中一样。

```
context.MapRoute(
    name: "Companies_default",
    url: "Companies/{controller}/{action}/{id}",
    defaults: new { controller = "Default", action = "Index", id = UrlParameter.Optional }
            ); 
```

结果：

*   /公司 - 作品
*   /公司/编辑 - 404
*   /公司/默认/编辑 - 作品
*   /公司/测试 - 作品
*   /公司/测试/测试 - 作品

如何在 URL 中没有“默认”的情况下访问我的 DefaultController.Edit() 操作？

**更新**

根据布拉德的回答，我知道我可以像这样对路径进行硬编码，它会起作用。我真的希望有更多的自动解决方案。我不知道我最终会对某些区域的默认控制器执行多少操作。我不想为每个人创建一条新路线。

这是在 App_Start/RouteConfig.cs 文件中作为 MVC 模板的一部分添加的默认路由。

```
routes.MapRoute(
    name: "Default",
    url: "{controller}/{action}/{id}",
    defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
            ); 
```

如果我在 HomeController 上有一个名为“Test”的操作，我可以使用 URL /Test 执行该操作。我不必添加带有“/Test/{id}”之类的 URL 的新路由即可使其正常工作。它似乎忽略了 URL 的 {controller} 部分并使用默认控制器配置。

当您在区域中执行此操作时，为什么此行为会发生变化？

Area 路由与 Default 路由完全相同，除了 URL 的“Companies/”前缀。

作为测试，我将我的默认路由 URL 更改为`url: "Example/{controller}/{action}/{id}"`，我*仍然*可以通过 URL /Example/Test 访问 HomeController.Test()。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T00:32:20.087

使用：

```
context.MapRoute(
    name: "Companies_Edit",
    url: "Companies/Edit/{id}",
    defaults: new { controller = "Default", action = "Edit", id = UrlParameter.Optional }
); 
```

记住参数是从左到右填充的（不能跳过`{controller}`，只能填充`{action}`。如果要`{controller}`假设，请在 中指定`defaults`）

# matlab - 如何将稀疏矩阵从 MEX 中的 CUSP::csr_matrix 返回到 Matlab？

> ID：15857500
> 
> 赞同：0
> 
> 时间：2013-04-07T00:24:23.640
> 
> 标签：matlab, return, sparse-matrix, mex, cusp-library

我正在开发我的 MEX 文件，用于使用 CUDA 进行稀疏矩阵计算。我正在使用 CUSP 库。我不知道如何将 cusp::csr_matrix 返回到 Matlab。例如，我有

```
cusp::csr_matrix<mwIndex,double,cusp::host_memory> At(m,n,N); 
```

因此，它是 CSR 格式的 At 矩阵，可以说，我已经计算过了。现在，我必须将它返回给 Matlab。像这样的东西：

```
plhs[0] = At; 
```

但是，当然，它不是那样工作的，首先是因为 At 在 GPU 上。我想我应该使用 At.values 和索引方法。但是，如何将它们分配给主机数据？

有人可以建议如何做这一切吗？:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T15:03:59.093

Matlab 也以 CSR 格式存储稀疏矩阵，所以并不复杂。您所要做的就是使用`mxArray *mxCreateSparse(mwSize m, mwSize n, mwSize nzmax, mxComplexity ComplexFlag);`然后设置 pr、ir、jc 数组（使用`mxGetPr`, `mxGetIr`, `mxGetJc`）分配稀疏矩阵。Pr 对应于 cusp 中的 values 数组，ir 对应于 column_indices，jc 对应于 row_offsets。如果矩阵在设备内存中，请使用`cudaMemcpy`with 复制它`cudaMemcpyDeviceToHost`。[这](http://www.gnu.org/software/octave/doc/interpreter/Sparse-Matrices-with-Mex_002dFiles.html)是一些使用稀疏矩阵的示例（它适用于 Octave，但也适用于 Matlab）。

# mysql - MySQL查询将不起作用

> ID：15857503
> 
> 赞同：0
> 
> 时间：2013-04-07T00:24:44.707
> 
> 标签：mysql, sql

我已经尝试运行该查询很长一段时间了，但无论我是否在值上使用引号，“赢”都没有设置为十进制值。

```
UPDATE trans 
   SET `outtrans` = 'test1', 
       `won` = '23.00043' 
  WHERE `intrans`='test1' 
```

如果我将值更改为`outtrans`不同的值，则表示 1 行受影响。然而，如果我对 做同样的事情`won`，它会说 0 行受到影响。

我没有使用任何 API，只是香草 mysql。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:39:10.010

抱歉浪费了你们的时间，结果我试图设置为十进制的表格是 int 而另一列是十进制。感谢所有的努力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T00:36:18.670

正如 Eric 建议的那样，从列名中删除引号。此外，进入表结构并确保将小数列的长度/值设置为小数点后的内容。例如，我刚刚建立了一个测试表来解决这个问题，尽管将列设置为十进制，但默认长度为 10,0，0 表示小数点后不存储数字。我将其更改为 10,4，一切都很好。

# iphone - iOS：首屏显示图片

> ID：15857506
> 
> 赞同：0
> 
> 时间：2013-04-07T00:25:06.877
> 
> 标签：iphone, ios, uiview

对于我的手机应用程序，我想在 3 秒内在第一个屏幕上显示一个图像，并在没有用户操作的情况下切换到主菜单。

**如何执行速度和自动切换视图？**

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:28:33.427

用这个

```
[self performSelector:@selector(loadMainView) withObject:nil afterDelay:3.0]; 
```

使用`loadMainView`您应该开始设置常用视图的方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T00:31:15.597

您想要做的就是启动画面，请参阅[应用程序启动（默认）图像](http://developer.apple.com/library/ios/documentation/iphone/conceptual/iphoneosprogrammingguide/App-RelatedResources/App-RelatedResources.html#//apple_ref/doc/uid/TP40007072-CH6-SW12) 或参考本[指南](http://www.appcoda.com/how-to-add-splash-screen-in-your-ios-app/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-07T00:53:05.663

我通常通过创建一个视图控制器来做到这一点，该控制器在其视图中具有一个 UIImageView 和启动图像。

# 使用模态

您可以通过这种方式将其作为模式视图控制器呈现在您的 rootViewController 之上。在 AppDelegate 中`application:didFinishLaunchingWithOptions:`，您通过调用来呈现模式

```
// rootViewController is the view controller attached to the UIWindow
[rootViewController presentViewController:imageViewController animated:NO completion:nil]; 
```

在 imageViewController 中，您可以这样做：

```
- (void)dismiss {
    // You can animate it or not, depending on your needs
    [self.presentingViewController dismissViewControllerAnimated:YES completion:nil];    
}

- (void)viewDidApper {
    [self performSelector:@selector(dismiss) withObject:nil afterDelay:AMOUNT_OF_TIME];
} 
```

# 作为 UINavigationController 堆栈的第一个控制器

不涉及模态的类似方法是将此视图控制器推送到您的 UINavigationController 中（如果您使用它）

在 AppDelegate 中`application:didFinishLaunchingWithOptions:`，您必须使用类似这样的设置导航控制器的第一个控制器

```
UINavigationController * navController = [[UINavigationController alloc] initWithRootViewController:imageViewController];
self.window.rootViewController = navController;
[self.window makeKeyAndVisible]; 
```

在 imageViewController 中，您可以这样做：

```
- (void)dismiss {
    // Here you should init your nextViewController, the real "home" of the app
    ....

    // Then you can present it. You can animate it or not, depending on your needs.
    // I prefer to replace the whole stack, since user shouldn't go back to the image screen.  
    [self.navigationController setViewControllers:@[nextViewController] animated:YES];    
}

- (void)viewDidApper {
    [self performSelector:@selector(dismiss) withObject:nil afterDelay:AMOUNT_OF_TIME];
} 
```

# asp.net-mvc-3 - DropDownListFor 问题

> ID：15857508
> 
> 赞同：0
> 
> 时间：2013-04-07T00:25:19.663
> 
> 标签：asp.net-mvc-3

我有一个返回列表项的方法。当我尝试用这些项目填充 DropDownList 时，就会出现问题。我每次都得到一个空异常。问题在哪里？

方法：

```
public IEnumerable<SelectListItem> GetItems()
    {
        List<SelectListItem> list = new List<SelectListItem>();

        list.Add(new SelectListItem { Text = "Ptuj", Value = "1" });
        list.Add(new SelectListItem { Text = "Celje", Value = "2" });
        list.Add(new SelectListItem { Text = "Laško", Value = "3" });
        list.Add(new SelectListItem { Text = "Maribor", Value = "4" });
        list.Add(new SelectListItem { Text = "Ljubljana", Value = "5" });
        list.Add(new SelectListItem { Text = "N/A", Value = "6" });

        foreach (SelectListItem item in list)
        {
            yield return item;
        }
    } 
```

看法：

```
@Html.LabelFor(model => model.PlaceOfBirth)
        @Html.DropDownListFor(model => model.PlaceOfBirth, //Exception thrown in this line
        Model.GetItems()) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:10:23.623

我会将该列表更改为 SelectList。您已经在使用 SelectListItems，因此您不妨全力以赴并使用 SelectList。

然后，只需返回 SelectList。您可以将签名返回类型保留为 IEnumerable，因为 SelectList 类实现了该接口（好吧，无论如何它是父类）。

让我用一个例子来详细说明。这是一个模型：

```
public class AModel
{
    public IEnumerable<SelectListItem> places { get; set; }
    public int SelectedValue { get; set; }
} 
```

这是一个索引操作方法：

```
public ActionResult Index()
{
    ViewBag.Message = "Welcome to ASP.NET MVC!";

    AModel model = new AModel{ places = GetItems(), SelectedValue = 0 };

    return View(model);
} 
```

这是您的新 GetItems 方法：

```
public IEnumerable<SelectListItem> GetItems()
{
    List<SelectListItem> list = new List<SelectListItem>();

    list.Add(new SelectListItem { Text = "Ptuj", Value = "1" });
    list.Add(new SelectListItem { Text = "Celje", Value = "2" });
    list.Add(new SelectListItem { Text = "Laško", Value = "3" });
    list.Add(new SelectListItem { Text = "Maribor", Value = "4" });
    list.Add(new SelectListItem { Text = "Ljubljana", Value = "5" });
    list.Add(new SelectListItem { Text = "N/A", Value = "6" });

    SelectList thelist = new SelectList(list, "Value", "Text");

    return thelist;
} 
```

看看你是怎么做的。

**编辑（添加视图）**：

```
 @model AModel

  @{
      ViewBag.Title = "Index";
  }

  <h2>Example</h2>

  Here are the places: @Html.DropDownListFor(m => m.SelectedValue, (SelectList)Model.Places, "Select a place") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T01:25:33.920

看起来您正在视图中调用`GetItems`视图模型/模型的方法。获取物品。不好了 ！不要那样做。

为下拉列表添加一个集合属性到您的视图模型。Viewmodel 只是***POCO***。没有这方面的方法。

```
public class SignUpVM
{
   public string Name{ set;get;}
   public List<SelectListItem> Cities{ set;get;}
   public int PlaceOfBirth {set;get;}
} 
```

现在在您的**GET**操作方法中，创建此视图模型的对象并填充`Cities`集合属性并将其返回给视图。

```
public ActionResult Create()
{
 var vm=new SignUpVM();
 vm.Cities=GetCities();
 return View(vm);
} 
```

假设`GetCities`方法返回`SelectListItem`城市列表。

```
public List<SelectListItem> GetCities()
{
  List<SelectListItem> cityList=new List<SelectListItem>();
  cityList.Add(new SelectListItem { Text = "Ptuj", Value = "1" });
  cityList.Add(new SelectListItem { Text = "Celje", Value = "2" });
  return cityList;
} 
```

现在在我们看来，它是强类型的`SignUpVM`

```
@model SignUpVM
@using(Html.BeginForm())
{
  @Html.DropDownListFor(x=>x.PlaceOfBirth,
                           new SelectList(Model.Cities,"Value","Text"),"select")
  <input type="submit" />
} 
```

当您提交表单时，您将在`PlaceOfBirth`属性中获得所选项目的 ID。

```
[HttpPost]
public ActionResult Create(SignUpVM model)
{
  int placeOfBirthId=model.PlaceOfBirth;
  // TO DO : Save and redirect.
} 
```

# java - Java 字符串参数化

> ID：15857512
> 
> 赞同：0
> 
> 时间：2013-04-07T00:26:08.403
> 
> 标签：java, string, concatenation, string-concatenation, parameterized

在我的一个 java 工具中，我重复创建了一些字符串，其中包含的变量如下所示：

```
for (String value : values) {
    // unrelated code omitted for clarity
    String outputValue = "blah blah blah " + foo + " blah " + bar + " blah";
    // code that writes out the created outputValue
} 
```

我不禁觉得这不是在 created 某种意义上拥有“参数”的最佳方法`String`，因为非参数文本总是相同的。但是，据我了解，使用`String.format`或类似方式插入这些参数实际上比简单的串联效率低。

创建这些参数化字符串是否有更好/更有效（相对于时间而不是内存）的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:28:05.620

> 据我了解，使用 String.format 或类似方法插入这些参数实际上比简单的连接效率低。

你有什么证据支持这一点？鉴于您的应用程序正在做的所有其他事情，您为什么认为值得担心呢？对我来说听起来像是一个微优化。

如果您的需求广泛，我会推荐任何模板解决方案，例如 Velocity。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T00:31:51.840

最有效的方法可能是使用 StringBuilder。

```
StringBuilder builder = new StringBuilder("blah blah blah");
builder.append(yourvalue).append("blah"); 
```

StringBuilder 允许的是避免多个昂贵的字符串连接。当您最终完成时，您只需调用`builder.toString()`以获取最终的字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-07T00:34:38.767

`StringBuffer`使用or来阅读单行代码和超高效难以阅读的代码之间需要权衡取舍`StringBuilder`。所以我认为这个问题没有普遍的答案。取决于什么质量对您更有价值（可读性 -> 可维护性或性能），它被调用多少次，它是否真的是您应用程序的瓶颈等。

这是很好的[总结](https://stackoverflow.com/questions/513600/should-i-use-javas-string-format-if-performance-is-important)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-07T00:36:13.330

`String.format`除了使用或`StringBuilder.append`代替带有 + 的字符串连接（尤其是在循环中）之外，不要尝试对此进行优化。

# ruby - iconv rvm 安装错误

> ID：15857516
> 
> 赞同：3
> 
> 时间：2013-04-07T00:27:03.987
> 
> 标签：ruby, ubuntu, rvm, iconv

当我尝试通过运行安装 iconv 时：`rvm pkg install iconv`失败并出现以下错误：

```
Error running 'autoreconf -is --force',
please read /usr/local/rvm/log/libiconv/autoreconf.log
Configuring libiconv in /usr/local/rvm/src/libiconv-1.13.1.........................
Error running './configure --prefix=/usr/local/rvm/usr --enable-shared',
please read /usr/local/rvm/log/libiconv/configure.log
Compiling libiconv in /usr/local/rvm/src/libiconv-1.13.1..
Error running 'make -j1',
please read /usr/local/rvm/log/libiconv/make.log

Please note that it's required to reinstall all rubies:

    rvm reinstall all --force 
```

在日志中，它说：

```
root@web01:~# cat /usr/local/rvm/log/libiconv/autoreconf.log
configure.ac:134: warning: AC_LANG_CONFTEST: no AC_LANG_SOURCE call detected in body
../../lib/autoconf/lang.m4:194: AC_LANG_CONFTEST is expanded from...
../../lib/autoconf/general.m4:2591: _AC_COMPILE_IFELSE is expanded from...
../../lib/autoconf/general.m4:2607: AC_COMPILE_IFELSE is expanded from...
../../lib/m4sugar/m4sh.m4:606: AS_IF is expanded from...
../../lib/autoconf/general.m4:2032: AC_CACHE_VAL is expanded from...
../../lib/autoconf/general.m4:2053: AC_CACHE_CHECK is expanded from...
configure.ac:134: the top level
configure.ac:134: warning: AC_LANG_CONFTEST: no AC_LANG_SOURCE call detected in body
../../lib/autoconf/lang.m4:194: AC_LANG_CONFTEST is expanded from...
../../lib/autoconf/general.m4:2591: _AC_COMPILE_IFELSE is expanded from...
../../lib/autoconf/general.m4:2607: AC_COMPILE_IFELSE is expanded from...
../../lib/m4sugar/m4sh.m4:606: AS_IF is expanded from...
../../lib/autoconf/general.m4:2032: AC_CACHE_VAL is expanded from...
../../lib/autoconf/general.m4:2053: AC_CACHE_CHECK is expanded from...
configure.ac:134: the top level
libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, `build-aux'.
libtoolize: linking file `build-aux/config.guess'
libtoolize: linking file `build-aux/config.sub'
libtoolize: linking file `build-aux/install-sh'
libtoolize: linking file `build-aux/ltmain.sh'
libtoolize: Consider adding `AC_CONFIG_MACRO_DIR([m4])' to configure.ac and
libtoolize: rerunning libtoolize, to keep the correct libtool macros in-tree.
libtoolize: Consider adding `-I m4' to ACLOCAL_AMFLAGS in Makefile.am.
libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, `../build-aux'.
libtoolize: linking file `../build-aux/config.guess'
libtoolize: linking file `../build-aux/config.sub'
libtoolize: linking file `../build-aux/install-sh'
libtoolize: linking file `../build-aux/ltmain.sh'
libtoolize: Consider adding `AC_CONFIG_MACRO_DIR([m4])' to configure.ac and
libtoolize: rerunning libtoolize, to keep the correct libtool macros in-tree.
libtoolize: Consider adding `-I m4' to ACLOCAL_AMFLAGS in Makefile.am.
autoreconf: configure.ac: AM_GNU_GETTEXT is used, but not AM_GNU_GETTEXT_VERSION
libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, `build-aux'.
libtoolize: linking file `build-aux/config.guess'
libtoolize: linking file `build-aux/config.sub'
libtoolize: linking file `build-aux/install-sh'
libtoolize: linking file `build-aux/ltmain.sh'
libtoolize: Consider adding `AC_CONFIG_MACRO_DIR([m4])' to configure.ac and
libtoolize: rerunning libtoolize, to keep the correct libtool macros in-tree.
libtoolize: Consider adding `-I m4' to ACLOCAL_AMFLAGS in Makefile.am.
configure.ac:134: warning: AC_LANG_CONFTEST: no AC_LANG_SOURCE call detected in body
../../lib/autoconf/lang.m4:194: AC_LANG_CONFTEST is expanded from...
../../lib/autoconf/general.m4:2591: _AC_COMPILE_IFELSE is expanded from...
../../lib/autoconf/general.m4:2607: AC_COMPILE_IFELSE is expanded from...
../../lib/m4sugar/m4sh.m4:606: AS_IF is expanded from...
../../lib/autoconf/general.m4:2032: AC_CACHE_VAL is expanded from...
../../lib/autoconf/general.m4:2053: AC_CACHE_CHECK is expanded from...
configure.ac:134: the top level
configure.ac:134: warning: AC_LANG_CONFTEST: no AC_LANG_SOURCE call detected in body
../../lib/autoconf/lang.m4:194: AC_LANG_CONFTEST is expanded from...
../../lib/autoconf/general.m4:2591: _AC_COMPILE_IFELSE is expanded from...
../../lib/autoconf/general.m4:2607: AC_COMPILE_IFELSE is expanded from...
../../lib/m4sugar/m4sh.m4:606: AS_IF is expanded from...
../../lib/autoconf/general.m4:2032: AC_CACHE_VAL is expanded from...
../../lib/autoconf/general.m4:2053: AC_CACHE_CHECK is expanded from...
configure.ac:134: the top level
configure.ac:151: error: possibly undefined macro: AC_EILSEQ
      If this token and others are legitimate, please use m4_pattern_allow.
      See the Autoconf documentation.
autoreconf: /usr/bin/autoconf failed with exit status: 1 
```

我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-07T00:30:30.000

尝试：

```
rvm get head
rvm --skip-autoreconf pkg install iconv 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-07T01:26:45.957

您不应该使用`rvm pkg`RVM`1.19`自带的`autolibs`- 不推荐使用`pkg`。

Autolibs 将使用包管理器而不是编译来提取 ruby​​ 的依赖项，这将提高 ruby​​ 与系统其他部分的兼容性。

使用`autolibs`很简单：

```
rvm get stable
rvm autolibs enable
rvm install ruby 
```

RVM 将安装依赖项，然后构建您需要的 ruby​​。

# youtube - JW 播放器进入 fancybox -（YouTube 链接到 JW）

> ID：15857518
> 
> 赞同：0
> 
> 时间：2013-04-07T00:27:12.613
> 
> 标签：youtube, fancybox, youtube-api, jwplayer, youtube-javascript-api

我有 JW 播放器的 youtube 链接。一切正常。现在如何将此播放器（此代码）放入fancybox？

```
<div id="player_779">
  <embed type="application/x-shockwave-flash" 
  src="http://teodore.ge/site/content/scripts/mediaplayer/player.swf"
   width="640" height="383"
    style="undefined"  id="player_779"  name="player_779" 
    quality="high"  allowfullscreen="true"
    allowscriptaccess="always" wmode="opaque"
    flashvars="file=http://youtu.be/VHcrPImvWlk&amp;skin=http://teodore.ge/site/content/scripts/mediaplayer/nacht.zip&amp;autostart=true">
    </div>
</div> 
```

请给我一个例子好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:13:14.030

```
 <a  class='video' data-width="600" data-height="345" >link</a>

<script>
      $(".video").fancybox({
        fitToView: false, // to show videos in their own size
        content: '<span></span>', // create temp content
        scrolling: 'no', // don't show scrolling bars in fancybox
        afterLoad: function () {
          // get dimensions from data attributes
          var $width = $(this.element).data('width'); 
          var $height = $(this.element).data('height');
          // replace temp content
          this.content = ' <embed type="application/x-shockwave-flash"  src="http://ww.ge/site/content/scripts/mediaplayer/player.swf" width="640" height="383"    style="undefined"  allowfullscreen="true" allowscriptaccess="always" wmode="opaque" flashvars="file=http://youtu.be/VHcrPImvWlk&amp;skin=http://www.ge/site/content/scripts/mediaplayer/nacht.zip&amp;autostart=true">'; 
        }
      });   
</script> 
```

# sql - 完美使用 BULK INSERT 查询

> ID：15857523
> 
> 赞同：3
> 
> 时间：2013-04-07T00:27:50.727
> 
> 标签：sql, sql-server, sql-server-2005

我使用以下 MS SQL 查询将包含逗号分隔值的文本文件导入 DB：

```
BULK INSERT logs
FROM 'E:\Sample.txt'
WITH
(
FIELDTERMINATOR = ',',
ROWTERMINATOR = '\n'
) 
```

不幸的是，我的 CSV 文本文件中的一个字段包含如下消息：“UDP 端口（234,137）中的问题”，其中包含逗号。因此，数据库将逗号之前的值作为一个字段，并将逗号之后的值插入到下一个字段中（这在逻辑上是不正确的）。结果，后一个字段的合法值在插入表时被丢弃。

希望我的问题得到最好的解释。

有什么解决方案可以克服这个问题并将整个：“UDP 端口（234,137）中的问题”存储到单个字段中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:37:50.407

我更喜欢通过 Microsoft 日志解析器[链接](http://www.microsoft.com/en-us/download/details.aspx?id=24659)运行我的 CSV ，并将其转换为制表符分隔。这样批量插入就可以完美地读取它。

[这是关于使用日志解析器链接](https://www.simple-talk.com/blogs/2010/06/02/using-logparser-part-2/)的一个很好的链接。创建命令以读取 csv 并输出 tsv，然后使用 xp_cmdshell 调用它。

为您省去为各种文件创建格式文件的麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T11:36:02.280

您是否尝试过放置其他字段终止符？

# ember.js - Ember 数据，hasMany 没有更新

> ID：15857527
> 
> 赞同：3
> 
> 时间：2013-04-07T00:28:22.450
> 
> 标签：ember.js, ember-data

不敢相信这么简单的事情给了我这么多的烦恼！无论如何，我有两个模型：

```
App.Basket = DS.Model.extend({
  fruits: DS.hasMany('App.Fruit')
});

App.Fruit = DS.Model.extend({
  basket: DS.belongsTo('App.Basket')
}); 
```

我拿了一个 id: 1 的篮子，并且没有指定任何fruit_ids。然后稍后我取一个篮子id为1的水果。`fruit.get('basket')`返回篮子就好了。但是，`basket.get('fruits')`是空的，它永远不会更新。

在篮子 JSON 中指定 fruit_ids 不是一个可接受的解决方案，因为在实际的真实应用程序中，一个篮子可能有数千到数百万个水果，用户不需要全部获取它们。

我尝试在以下位置添加以下内容`App.Fruit`：

```
didLoad: function() {
  this.get('basket').get('fruits').pushObject(this);
} 
```

这适用于第一次加载。但是，如果 ember-data 尝试再次获取数据，那么您将得到：

`Uncaught Error: Attempted to handle event `loadedData` on <App.Fruit:ember353:3> while in state rootState.loaded.updated.uncommitted. Called with undefined`

更改`didLoad`为：

```
didLoad: function() {
  this.get('basket').get('fruits').pushObject(this);
  this.get('stateManager').send('becameClean');
  this.get('stateManager').send('finishedMaterializing');
} 
```

删除所有错误。但是，即使 ember 尝试重新获取数据（例如，在访问另一条路线并再次返回之后），也不会再次调用 didLoad。

在这上面花了好几个小时，我不明白这么简单的事情怎么会占用我这么多时间。我想做的就是在获取新水果时更新篮子上的 hasMany！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T09:02:17.553

我遇到了 rootState.loaded.updated.uncommitted 的问题。这里的问题是 ember-data 在该状态下没有加载数据事件的处理程序。不幸的是，没有简单的方法来添加事件，但我设法通过复制状态的原始定义所在的闭包来做到这一点。您可以在此处找到更多详细信息

[http://discuss.emberjs.com/t/extending-ember-data-states/838](http://discuss.emberjs.com/t/extending-ember-data-states/838)

工作代码在这里列出：

[https://gist.github.com/pzuraq/5304796](https://gist.github.com/pzuraq/5304796)

我现在与 hasMany 关系有类似的问题，所以我将尝试实现它，看看我是否无法让它工作。如果我这边有任何进展，我会告诉你的。

# makefile - Makefile 操作顺序

> ID：15857528
> 
> 赞同：0
> 
> 时间：2013-04-07T00:28:26.700
> 
> 标签：makefile

我试图弄清楚如何实现[这个](https://stackoverflow.com/a/2394651/574733)Makefile 代码来生成依赖项。

```
depend: .depend

.depend: $(SRCS)
        rm -f ./.depend
        $(CC) $(CFLAGS) -MM $^ >  ./.depend;

include .depend 
```

但是，我必须对其进行修改，以便每次运行 make 时都会重新生成 .depend。我试图通过制作一个调用的虚假目标来实现这一点`rm -f ./.depend`，但是，无论我如何安排事情，它总是在 之后`.depend`和之前运行`include`。另一方面，如果我无论如何都能让`.depend`配方运行，那就更好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-07T15:21:03.047

这种处理依赖关系的方法非常不理想。创建依赖信息的最佳方式是作为编译*的副作用*。它甚至比您现在所做的还要快，因为编译器已经必须计算所有这些信息。

当您编译代码时，您已经知道*该*构建实例需要重新构建目标。构建的副作用，即创建依赖信息，是针对构建的*下一个*实例。GCC 提供了`-MMD -MP`使这项工作正常工作的选项。在此配置中，您绝对不应该提供单独的规则来构建包含的文件（这将破坏一切）。相反，请执行以下操作：

```
SRCS = foo.c bar.c baz.c ...

%.o : %.c
        $(CC) $(CPPFLAGS) $(CFLAGS) -MMD -MP -o $@ -c $<

-include $(SRCS:.c=.d) 
```

使用`-include`这样，如果尚未创建依赖文件，您将不会收到任何错误。就是这样，这就是你所要做的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T11:32:57.200

虽然我同意上述评论，即每次重新生成依赖项没有任何好处，但我也认为首先实现所有这些并不是你的工作。作为一个可靠的构建工具，[makepp](http://makepp.sourceforge.net/)会为您解决这个问题。而且它并不局限于头文件依赖，而是考虑到了所有的东西，就像改变了命令行一样，所以它更正确。

*makepp 还有很多。除了做 GNU make 能做的几乎所有事情，还有很多有用的东西，你甚至可以用一些 Perl 编程来扩展你的 makefile。*

# php - Ajax 基于值创建表单但不会提交

> ID：15857530
> 
> 赞同：0
> 
> 时间：2013-04-07T00:28:47.227
> 
> 标签：php, javascript, ajax, forms, submit

好的，这里是这样的场景：应用程序是用 Ajax 构建的，请求我们需要多少服务？（我没有为此目的验证任何东西，但我应该）

假设我们将五个作为输入，表单返回带有 5 个框和一个提交按钮

```
<script>
    function test(){
        var num = $('#numServ').val();
        var form = "";

        form += "<form name='form2' id='services' method='POST' action='<?php echo $_SERVER['PHP_SELF'];?>'>";
        for(m=0;m<num;m++){
            // alert("<br>Voice le param"+m);
            form += "<br><input type='text' name='services"+m+"' value=''>";
        }
        form += "<input type='submit' name='services' id='btnServices' value='SERVICES'>";

        form += "</form>";
        alert(form);
        $('#generated').append(form)
    }
</script> 
```

这部分有效......但是当我尝试使用 Ajax 提交表单时，该 Ajax 调用的函数被放置在 document.ready 函数中，它不起作用。

```
$('#form2').submit(function(){
    alert("Form Submitted");

    /*
    THE WHOLE CODE COMMENTED OUT IT STILL WON'T WORK
    var result = $(this).serialize();

    alert(result);
    $.ajax({
        url:"./content.php",
        data: result, 
        type: "POST",
        // cache:false,
        dataType:"html",
        success: function(data,jqXHR){$('body').append(data);},
        error: function(){alert('Check Ajax request');},
        complete:function(){alert("Ajax complete");}
    });
    */

    return false;
}); 
```

我已经做了好几天了。任何其他未使用 jquery 构建的表单都可以使用此方法工作，因为表单已经加载到页面上，并且不是由 ajax 即时生成的。

我相信我的问题在于 Ajax 在页面加载后制作表单......即使我对 sumit 表单的 Ajax 调用位于 document.ready 函数的头部。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:43:22.750

jQuery 正在侦听 ID 为 的元素上的提交事件，`form2`但您的表单名为`services`。

此外，看起来您正在动态构建表单，因此提交事件可能不会触发，因为 jQuery 在表单存在之前加载。

如果是这种情况，请尝试使用`$(#[ID of parent element that exists on page load]).on('submit', function() {...});`

## 更新

jQuery .on()[文档](http://api.jquery.com/on/)有很多很好的信息。简短的版本是事件“冒泡” DOM。通过将侦听器添加到页面加载时存在的元素，它可以捕获发生在其子项上的事件。

看起来您正在将表单附加到具有`ID`“生成”的元素......如果页面加载时存在此元素，则以下内容应该有效：

```
$('#generated').on('submit', function() {
    alert("Form Submitted");

    var result = $(this).serialize();

    alert(result);

    $.ajax({
        url:"./content.php",
        data: result, 
        type: "POST",
        // cache:false,
        dataType:"html",
        success: function(data,jqXHR){$('body').append(data);},
        error: function(){alert('Check Ajax request');},
        complete:function(){alert("Ajax complete");}*/
    });

    return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T00:39:32.410

您的 jQuery 正在寻找一个表单，`id='form2'`但您的表单创建功能正在设置`id='services'` 所以 jQuery 没有运行，因为它没有匹配任何内容。

改变：

```
$('#form2').submit(function(){ 
```

到：

```
$('#services').submit(function(){ 
```

# c - C程序不将值传递给方法

> ID：15857531
> 
> 赞同：0
> 
> 时间：2013-04-07T00:28:50.087
> 
> 标签：c, methods

我正在做家庭作业，我遇到了一些奇怪的事情。我有三个文件：Lab3.c、Lab3.h 和 driver.c。driver.c 正在从 Lab3.c 调用一个方法，但未能将值传递给该方法。

```
// code from driver.c
float cyRad, cyHt;
printf("Enter a radius for the cylinder: ");
scanf("%f", &cyRad);
printf("%f\n", cyRad);
printf("Enter a height for the cylinder: ");
scanf("%f", &cyHt);
float cyVol = cylinder(cyRad, cyHt);
printf("Cylinder volume: %f\n", cyVol);

// code from Lab3.c
float cylinder(float radius, float height) 
{
    printf("%f %f %f\n", M_PI, height, radius);
    return M_PI * height * pow(radius, 2);
}

// code from Lab3.h
#ifndef __LAB3_H
#define __LAB3_H

extern void sphere(float radius, float *surface, float *volume);
extern float volCylinder(float radius, float height);
extern double sumFloats(double x[], int numFloats);
extern double sine(float angle);

#endif 
```

这是输出：

```
Enter a radius for the cylinder: 13
13.000000
Enter a height for the cylinder: 45
3.141593 0.000000 0.000000
Cylinder volume: 0.000000 
```

我不知道为什么它没有将值传递给方法`cylinder`。任何和所有的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:39:07.847

调用函数时必须有一个原型在作用域内，否则假定它返回`int`并且它的参数类型是未知的。当将浮点数传递给具有未知参数类型的函数时，它们作为双精度值传递，这将导致函数中的虚假值（行为未定义，因此理论上任何事情都可能发生，尽管实际发生的情况取决于实现，但它不会是你想要的）。

在多文件程序中进行声明的最佳方法是为每个 .c 文件创建一个 .h 文件；.h 文件声明了 .c 文件中定义的函数（和其他全局变量）。然后#include .h 文件到任何使用这些全局变量的文件中......包括伴随的 .c 文件。

# jquery - 从带有模板和函数的 JSON 中剔除 Master/Detail 对象

> ID：15857532
> 
> 赞同：1
> 
> 时间：2013-04-07T00:29:04.347
> 
> 标签：jquery, json, knockout.js

我最近开始使用 Knockout，大多数事情都非常容易。然而，这个让我有点难过，希望有人能提供一些帮助。我正在通过序列化具有 Master/Detail 结构的 JSON 对象来创建我的 Knockout 模型，我怀疑这会导致我的一些问题。我可以绑定/呈现记录的主部分，并且可以使用 foreach 模板绑定和呈现详细信息。但是，在我的场景中，我希望用户从子列表中选择要编辑的详细记录。问题是我无法让选择起作用。我正在触发 click 事件，并且似乎我的详细记录正在传递给我的事件 - 除了我无法读取属性的值。在提琴手看来，通过的对象是事件的函数调用。目前还不确定。所以，这是我的设置

我的 JSON

```
{
"Height":"250",
"Width":"200",
"Speed":"700",
"Pause":"4",
"ShowItems":"1",
"Animation":"fade",
"MousePause":"true",
"IsPaused":"false",
"Direction":"up",
"DataItems":[{
     "OrderId":1,
     "ItemHtml":"This is item 1"
  },{
     "OrderId":2,
     "ItemHtml":"This is item 2"
  },{"
     OrderId":3,
    "ItemHtml":"This is item 3"
  }]
} 
```

用于序列化 JSON 对象的 Javascript

```
var viewModel = {
  vmRotator: ko.mapping.fromJSON(jsonObj)

  //-- THIS IS WHERE I THINK THE PROBLEM IS
  , selectRotatorItem: function (item) {
    //alert(item.OrderId); // THIS DOES NOT WORK
    console.log(item);
  }
}
ko.applyBindings(viewModel);

//-- hookup the click event for templated items
$("#rotatorItems").on("click", ".sel", function () {
  var data = ko.dataFor(this);
  viewModel.selectRotatorItem(data); //-- call to object function
}); 
```

用于显示项目的 HTML，提供单击按钮

```
<table id="rotatorList" width="100%" border="0" cellspacing="0" cellpadding="2">
  <tbody id="rotatorItems" data-bind="template: { foreach: vmRotator.DataItems }">
  <tr>
    <td style="width: 20px;">
      <input type="button" class="sel" value="Select" />
      <span data-bind="text: OrderId"></span>
    </td>
    <td style="width: 90%;" data-bind="text: ItemHtml"></td>
  </tr>
  </tbody>
</table> 
```

最好我能说这一切正常。我的事件正在被调用，但是当我在控制台中查看结果时，它看起来像是函数的文本而不是值。

在函数中：

```
, selectRotatorItem: function (item) {
  //alert(item.OrderId); // THIS DOES NOT WORK
  console.log(item);
} 
```

alert(item.OrderId) 显示：

```
"function d(){if(0<arguments.length){if(!d.equalityComparer||!d.equalityComparer(c,arguments[0]))d.H(),c=arguments[0],d.G();return this}b.r.Wa(d);return c}" 
```

而不是像 1 或 2 这样的数字，它是 Order ID 的值。不知道为什么会这样，但我做错了什么。

我通过查看几个与我正在做的类似的示例将这段代码拼凑在一起。我可能会以完全错误的方式解决这个问题，但我认为我只是缺少一些简单的东西。我敢肯定，那里的一些 Javasctipt 神可以很容易地看到我看不到的东西，所以我很感激你的帮助。

* * *

## 为了回应符文对我最初问题的回答，这是有效的最终版本

用于构建绑定的 Javascript 代码

```
//-- define models: master and detail modesl
var viewRotatorItemModel = {
  'Height': ko.observable(),
  'Width': ko.observable()
};

var viewRotatorModel = {
  'Height': ko.observable(),
  'Width': ko.observable(),
  'Speed': ko.observable(),
  'ShowItems': ko.observable(),
  'Animation': ko.observable(),
  'IsPaused': ko.observable(),
  'Direction': ko.observable(),
  'UseEditor': ko.observable(),
  'HtmlData': ko.observable(),
  'DataItems': {
        create: function (options) {
        return new viewRotatorDataItem(options.data);
      }
    }
};

//-- define objects around models
var viewRotatorDataItem = function (data) {
  var self = this;
  //--> IMPORTANT TO USE fromJS as JSON is already an object
  ko.mapping.fromJS(data, viewRotatorItemModel, self); 
  self.selectItem = function () {
    alert("item with id " + self.OrderId() + " clicked");
  };
};

var ViewModel = function (data) {
    var self = this;
    //--> IMPORTANT TO USE fromJSON as incoming object is JSON text
    ko.mapping.fromJSON(data, viewRotatorModel, self);
};

...
...

//-- create objects when ready
    vmRotator = new ViewModel(jsonObj);
    ko.applyBindings(vmRotator); 
```

用于显示主/明细项目的 HTML

```
<h4>Main Items</h4>
<input type="text" id="wc_Height" data-bind="value: vmRotator.Height" />

<input type="text" id="wc_Width" data-bind="value: vmRotator.Width" />

<h3>Detail Items</h3>
<table id="rotatorList" width="100%" border="0" cellspacing="0" cellpadding="2">
  <tbody id="rotatorItems" data-bind="template: { foreach: vmRotator.DataItems }">
  <tr>
    <td style="width: 20px;"> 
      <input type="button" value="Select" data-bind="click: selectItem" />
      <span data-bind="text: OrderId"></span>
    </td>
    <td style="width: 90%;" data-bind="text: ItemHtml"></td>
  </tr>
</tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T05:07:47.977

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T05:35:10.263

我认为问题是您应该删除#rotatorItems 的jQuery 绑定，并在.sel 按钮上使用'click' 绑定：

请看这个小提琴：

[http://jsfiddle.net/EKXKF/2/](http://jsfiddle.net/EKXKF/2/)

主要变化：

```
<tbody id="rotatorItems" data-bind="foreach: vmRotator.DataItems">
  <tr>
    <td style="width: 20px;">
      <input type="button" class="sel" value="Select" data-bind="click: $root.selectRotatorItem" />
      <span data-bind="text: OrderId"></span>
    </td>
    <td style="width: 90%;" data-bind="text: ItemHtml"></td>
  </tr>
</tbody> 
```

# c# - 使用 JSON.net 错误进行反序列化

> ID：15857534
> 
> 赞同：1
> 
> 时间：2013-04-07T00:29:30.110
> 
> 标签：c#, json, windows-8

挣扎了5个多小时……但可以让它工作。我在一个文本文件中关注了 JSON。

```
[
{"A":[
    {"Mon2Fri":[
    {"StopNameMain" : "Dr. Manix Road", "StopNameSub" : "GAA HQ", "StartingTime" : "0700,0720,0740,0800,0820,0840,0900,0920,0940,1000,1020,1040,1100,1120,1140,1200,1220,1240,1300,1320,1340,1400,1420,1440,1500,1520,1540,1600,1620,1640,1700,1720,1740,1800,1820,1840,1900,1940,2020,2100,2140,2220,2300,2340"},
    {"StopNameMain" : "Upper Salthill Rd", "StopNameSub" : "Diving B'rd", "StartingTime" : "0703,0723,0743,0803,0823,0843,0903,0923,0943,1003,1023,1043,1103,1123,1143,1203,1223,1243,1303,1323,1343,1403,1423,1443,1503,1523,1543,1603,1623,1643,1703,1723,1743,1803,1823,1843,1903,1943,2023,2103,2143,2223,2303,2343"},
    {"StopNameMain" : "Upper Salthill Road", "StopNameSub" : "Waterfront", "StartingTime" : "0707,0727,0747,0807,0827,0847,0907,0927,0947,1007,1027,1047,1107,1127,1147,1207,1227,1247,1307,1327,1347,1407,1427,1447,1507,1527,1547,1607,1627,1647,1707,1727,1747,1807,1827,1847,1907,1947,2027,2107,2147,2227,2307,2347"},
    {"StopNameMain" : "Salthill Road Lwr", "StopNameSub" : "Lios Ealtan", "StartingTime" : "0711,0731,0751,0811,0831,0851,0911,0931,0951,1011,1031,1051,1111,1131,1151,1211,1231,1251,1311,1331,1351,1411,1431,1451,1511,1531,1551,1611,1631,1651,1711,1731,1751,1811,1831,1851,1911,1951,2031,2111,2151,2231,2311,2351"},
    {"StopNameMain" : "Eyre Square", "StopNameSub" : "Stop 9", "StartingTime" : "0720,0740,0800,0820,0840,0900,0920,0940,1000,1020,1040,1100,1120,1140,1200,1220,1240,1300,1320,1340,1400,1420,1440,1500,1520,1540,1600,1620,1640,1700,1720,1740,1800,1820,1840,1900,1920,2000,2040,2120,2200,2240,2320,0000"}]},
    {"Sat":[
    {"StopNameMain" : "Dr. Manix Road", "StopNameSub" : "GAA HQ", "StartingTime" : "0800,0840,0920,0940,1000,1020,1040,1100,1120,1140,1200,1220,1240,1300,1320,1340,1400,1420,1440,1500,1520,1540,1600,1620,1640,1700,1720,1740,1800,1820,1840,1900,1940,2020,2100,2140,2220,2300,2340"},
    {"StopNameMain" : "Upper Salthill Road", "StopNameSub" : "Diving B'rd", "StartingTime" : "0803,0843,0923,0943,1003,1023,1043,1103,1123,1143,1203,1223,1243,1303,1323,1343,1403,1423,1443,1503,1523,1543,1603,1623,1643,1703,1723,1743,1803,1823,1843,1903,1943,2023,2103,2143,2223,2303,2343"},
    {"StopNameMain" : "Upper Salthill Road", "StopNameSub" : "Waterfront", "StartingTime" : "0807,0847,0927,0947,1007,1027,1047,1107,1127,1147,1207,1227,1247,1307,1327,1347,1407,1427,1447,1507,1527,1547,1607,1627,1647,1707,1727,1747,1807,1827,1847,1907,1947,2027,2107,2147,2227,2307,2347"},
    {"StopNameMain" : "Salthill Road Lwr", "StopNameSub" : "Lios Ealtan", "StartingTime" : "0811,0851,0931,0951,1011,1031,1051,1111,1131,1151,1211,1231,1251,1311,1331,1351,1411,1431,1451,1511,1531,1551,1611,1631,1651,1711,1731,1751,1811,1831,1851,1911,1951,2031,2111,2151,2231,2311,2351"},
    {"StopNameMain" : "Eyre Square", "StopNameSub" : "Stop 9", "StartingTime" : "0820,0900,0940,1000,1020,1040,1100,1120,1140,1200,1220,1240,1300,1320,1340,1400,1420,1440,1500,1520,1540,1600,1620,1640,1700,1720,1740,1800,1820,1840,1900,1920,2000,2040,2120,2200,2240,2320,0000"}]},
    {"Sun":[
    {"StopNameMain" : "Dr. Manix Road", "StopNameSub" : "GAA HQ", "StartingTime" : "1020,1100,1140,1220,1300,1340,1420,1500,1540,1620,1700,1740,1820,1900,1940,2020,2100,2140,2220,2300,2340"},
    {"StopNameMain" : "Upper Salthill Road", "StopNameSub" : "Diving B'rd", "StartingTime" : "1023,1103,1143,1223,1303,1343,1423,1503,1543,1623,1703,1743,1823,1903,1943,2023,2103,2143,2223,2303,2343"},
    {"StopNameMain" : "Upper Salthill Road", "StopNameSub" : "Waterfront", "StartingTime" : "1027,1107,1147,1227,1307,1347,1427,1507,1547,1627,1707,1747,1827,1907,1947,2027,2107,2147,2227,2307,2347"},
    {"StopNameMain" : "Salthill Road Lwr", "StopNameSub" : "Lios Ealtan", "StartingTime" : "1031,1111,1151,1231,1311,1351,1431,1511,1551,1631,1711,1751,1831,1911,1951,2031,2111,2151,2231,2311,2351"},
    {"StopNameMain" : "Eyre Square", "StopNameSub" : "Stop 9", "StartingTime" : "1040,1120,1200,1240,1320,1400,1440,1520,1600,1640,1720,1800,1840,1920,2000,2040,2120,2200,2240,2320,0000"}]}
]},
{"B":[
    {"Mon2Fri":[
    {"StopNameMain" : "Eyre Square", "StopNameSub" : "Stop 9", "StartingTime" :                "0640,0700,0720,0740,0800,0820,0840,0900,0920,0940,1000,1020,1040,1100,1120,1140,1200,1220,1240,1300,1320,1340,1400,1420,1440,1500,1520,1540,1600,1620,1640,1700,1720,1740,1800,1820,1840,1900,1920,2000,2040,2120,2200,2240,2320"},
    {"StopNameMain" : "Fr.Griffin Rd", "StopNameSub" : "Fr.Burke Pk", "StartingTime" :         "0644,0704,0724,0744,0804,0824,0844,0904,0924,0944,1004,1024,1044,1104,1124,1144,1204,1224,1244,1304,1324,1344,1404,1424,1444,1504,1524,1544,1604,1624,1644,1704,1724,1744,1804,1824,1844,1904,1924,2004,2044,2124,2204,2244,2324"},
    {"StopNameMain" : "Salthill Rd Lwr", "StopNameSub" : "Lios Ealtan", "StartingTime" :       "0647,0707,0727,0747,0807,0827,0847,0907,0927,0947,1007,1027,1047,1107,1127,1147,1207,1227,1247,1307,1327,1347,1407,1427,1447,1507,1527,1547,1607,1627,1647,1707,1727,1747,1807,1827,1847,1907,1927,2007,2047,2127,2207,2247,2327"},
    {"StopNameMain" : "Upper Salthill Road", "StopNameSub" : "C'ton Kitchen", "StartingTime" : "0652,0712,0732,0752,0812,0832,0852,0912,0932,0952,1012,1032,1052,1112,1132,1152,1212,1232,1252,1312,1332,1352,1412,1432,1452,1512,1532,1552,1612,1632,1652,1712,1732,1752,1812,1832,1852,1912,1932,2012,2052,2132,2212,2252,2332"},
    {"StopNameMain" : "Dr Manix Road", "StopNameSub" : "GAA HQ", "StartingTime" :              "0700,0720,0740,0800,0820,0840,0900,0920,0940,1000,1020,1040,1100,1120,1140,1200,1220,1240,1300,1320,1340,1400,1420,1440,1500,1520,1540,1600,1620,1640,1700,1720,1740,1800,1820,1840,1900,1920,1940,2020,2100,2140,2220,2300,2340"}]},
    {"Sat":[
    {"StopNameMain" : "Eyre Square", "StopNameSub" : "Stop 9", "StartingTime" :                "0740,0820,0900,0940,1000,1020,1040,1100,1120,1140,1200,1220,1240,1300,1320,1340,1400,1420,1440,1500,1520,1540,1600,1620,1640,1700,1720,1740,1800,1820,1840,1900,1920,2000,2040,2120,2200,2240,2320"},
    {"StopNameMain" : "Fr.Griffin Rd", "StopNameSub" : "Fr.Burke Pk", "StartingTime" :         "0744,0824,0904,0944,1004,1024,1044,1104,1124,1144,1204,1224,1244,1304,1324,1344,1404,1424,1444,1504,1524,1544,1604,1624,1644,1704,1724,1744,1804,1824,1844,1904,1924,2004,2044,2124,2204,2244,2324"},
    {"StopNameMain" : "Salthill Rd Lwr", "StopNameSub" : "Lios Ealtan", "StartingTime" :       "0747,0827,0907,0947,1007,1027,1047,1107,1127,1147,1207,1227,1247,1307,1327,1347,1407,1427,1447,1507,1527,1547,1607,1627,1647,1707,1727,1747,1807,1827,1847,1907,1927,2007,2047,2127,2207,2247,2327"},
    {"StopNameMain" : "Upper Salthill Road", "StopNameSub" : "C'ton Kitchen", "StartingTime" : "0752,0832,0912,0952,1012,1032,1052,1112,1132,1152,1212,1232,1252,1312,1332,1352,1412,1432,1452,1512,1532,1552,1612,1632,1652,1712,1732,1752,1812,1832,1852,1912,1932,2012,2052,2132,2212,2252,2332"},
    {"StopNameMain" : "Dr. Manix Road", "StopNameSub" : "GAA HQ", "StartingTime" :             "0800,0840,0920,1000,1020,1040,1100,1120,1140,1200,1220,1240,1300,1320,1340,1400,1420,1440,1500,1520,1540,1600,1620,1640,1700,1720,1740,1800,1820,1840,1900,1920,1940,2020,2100,2140,2220,2300,2340"}]},
    {"Sun":[
    {"StopNameMain" : "Eyre Square", "StopNameSub" : "Stop 9", "StartingTime" :                "1000,1040,1120,1200,1240,1320,1400,1440,1520,1600,1640,1720,1800,1840,1920,2000,2040,2120,2200,2240,2320"},
    {"StopNameMain" : "Fr.Griffin Rd", "StopNameSub" : "Fr.Burke Pk", "StartingTime" :         "1004,1044,1124,1204,1244,1324,1404,1444,1524,1604,1644,1724,1804,1844,1924,2004,2044,2124,2204,2244,2324"},
    {"StopNameMain" : "Salthill Rd Lwr", "StopNameSub" : "Lios Ealtan", "StartingTime" :       "1007,1047,1127,1207,1247,1327,1407,1447,1527,1607,1647,1727,1807,1847,1927,2007,2047,2127,2207,2247,2327"},
    {"StopNameMain" : "Upper Salthill Road", "StopNameSub" : "C'ton Kitchen", "StartingTime" : "1012,1052,1132,1212,1252,1332,1412,1452,1532,1612,1652,1732,1812,1852,1932,2012,2052,2132,2212,2252,2332"},
    {"StopNameMain" : "Dr. Manix Road", "StopNameSub" : "GAA HQ", "StartingTime" :             "1020,1100,1140,1220,1300,1340,1420,1500,1540,1620,1700,1740,1820,1900,1940,2020,2100,2140,2220,2300,2340"}]}
]}
] 
```

我有这个使用 jsoncharp.net 编写的 C# 类

```
public class Mon2Fri
{
    public string[] StopNameMain { get; set; }
    public string[] StopNameSub { get; set; }
    public string[] StartingTime { get; set; }
}

public class Sat
{
    public string[] StopNameMain { get; set; }
    public string[] StopNameSub { get; set; }
    public string[] StartingTime { get; set; }
}

public class Sun
{
    public string[] StopNameMain { get; set; }
    public string[] StopNameSub { get; set; }
    public string[] StartingTime { get; set; }
}

public class A
{
    public List<Mon2Fri> Mon2Fri { get; set; }
    public List<Sat> Sat { get; set; }
    public List<Sun> Sun { get; set; }
}

public class Mon2Fri2
{
    public string[] StopNameMain { get; set; }
    public string[] StopNameSub { get; set; }
    public string[] StartingTime { get; set; }
}

public class Sat2
{
    public string[] StopNameMain { get; set; }
    public string[] StopNameSub { get; set; }
    public string[] StartingTime { get; set; }
}

public class Sun2
{
    public string[] StopNameMain { get; set; }
    public string[] StopNameSub { get; set; }
    public string[] StartingTime { get; set; }
}

public class B
{
    public List<Mon2Fri2> Mon2Fri { get; set; }
    public List<Sat2> Sat { get; set; }
    public List<Sun2> Sun { get; set; }
}

public class RootObject
{
    public List<A> A { get; set; }
    public List<B> B { get; set; }
} 
```

当我尝试使用解析 json

```
List<RootObject> deserializedJSON = await JsonConvert.DeserializeObjectAsync<List<RootObject>>(JsonString); 
```

我得到错误对象

```
{"Object reference not set to an instance of an object."} 
```

如果我尝试使用

```
RootObject deserializedJSON = await JsonConvert.DeserializeObjectAsync<RootObject>(JsonString); 
```

我得到一个错误

```
Cannot deserialize the current JSON array (e.g. [1,2,3]) into type 'GalwayBuses.RootObject' because the type requires a JSON object (e.g. {"name":"value"}) to deserialize correctly.

To fix this error either change the JSON to a JSON object (e.g. {"name":"value"}) or change the deserialized type to an array or a type that implements a collection interface (e.g. ICollection, IList) like List<T> that can be deserialized from a JSON array. JsonArrayAttribute can also be added to the type to force it to deserialize from a JSON array.

Path '', line 1, position 1. 
```

我非常感谢一些帮助。我已经在 stack over flow 上浏览了许多帖子，并使用多个网站检查和验证了 json ......只是无法理解这个......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:07:47.757

终于得到了这个工作......我的一个巨大的疏忽......当我自己阅读json数据时，我意识到了这些问题

相应的类应该是

```
public class Mon2Fri
{
    public string StopNameMain { get; set; }
    public string StopNameSub { get; set; }
    public string StartingTime { get; set; }
}

public class Sat
{
    public string StopNameMain { get; set; }
    public string StopNameSub { get; set; }
    public string StartingTime { get; set; }
}

public class Sun
{
    public string StopNameMain { get; set; }
    public string StopNameSub { get; set; }
    public string StartingTime { get; set; }
}

public class A
{
    public Mon2Fri[] Mon2Fri { get; set; }
    public Sat[] Sat { get; set; }
    public Sun[] Sun { get; set; }
}

public class Mon2Fri2
{
    public string StopNameMain { get; set; }
    public string StopNameSub { get; set; }
    public string StartingTime { get; set; }
}

public class Sat2
{
    public string StopNameMain { get; set; }
    public string StopNameSub { get; set; }
    public string StartingTime { get; set; }
}

public class Sun2
{
    public string StopNameMain { get; set; }
    public string StopNameSub { get; set; }
    public string StartingTime { get; set; }
}

public class B
{
    public Mon2Fri2[] Mon2Fri { get; set; }
    public Sat2[] Sat { get; set; }
    public Sun2[] Sun { get; set; }
}

public class RootObject
{
    public A[] A { get; set; }
    public B[] B { get; set; }
} 
```

然后它使用

```
RootObject[] deserializedJSON = await JsonConvert.DeserializeObjectAsync<RootObject[]>(JsonString); 
```

# javascript - SVG 蛋变形动画

> ID：15857535
> 
> 赞同：4
> 
> 时间：2013-04-07T00:29:44.560
> 
> 标签：javascript, animation, svg, transformation

我想将一个简单的 SVG 路径变形为另一个。我想使用 JavaScript 来控制何时发生这种情况。

这是我创建的 JSFiddle 的链接，作为我正在尝试做的简化示例：http: [//jsfiddle.net/brentmitch/RqRjq/](http://jsfiddle.net/brentmitch/RqRjq/)

这是示例使用的基本代码：

```
function makeEgg() {
    var svgContainer = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
    svgContainer.setAttribute("version", "1.1");
    svgContainer.setAttribute("width", "142.308px");
    svgContainer.setAttribute("height", "142.308px");
    svgContainer.setAttribute("id", "curvecontainer");
    svgContainer.setAttribute("x", "0px");
    svgContainer.setAttribute("y", "0px");
    var eggPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
    eggPath.setAttribute("id", "eggpath");
    eggPath.setAttribute("d", "M126.308,83.154c0,39.297-32.718,56.154-55.154,56.154S16,122.451,16,83.154S50,0,71.154,0S126.308,43.856,126.308,83.154z");
    eggPath.setAttribute("fill", "GoldenRod");
    svgContainer.appendChild(eggPath);
    document.getElementById('svgcontainer').appendChild(svgContainer);
}

function changeToArrow() {
    var animateEggPath = document.createElementNS('http://www.w3.org/2000/svg', 'animate');
    animateEggPath.setAttribute("id", "egganimation");
    animateEggPath.setAttribute("xlink:href", "#eggpath");
    animateEggPath.setAttribute("attributeType", "XML");
    animateEggPath.setAttribute("attributeName", "d");
    animateEggPath.setAttribute("from", "M126.308,83.154c0,39.297-32.718,56.154-55.154,56.154S16,122.451,16,83.154S50,0,71.154,0S126.308,43.856,126.308,83.154z");
    animateEggPath.setAttribute("to", "M126.308,95.154c0,39.297-17.333-28.667-39.769-28.667S16,134.451,16,95.154S50,12,71.154,12   S126.308,55.856,126.308,95.154z");
    animateEggPath.setAttribute("dur", "4s");
    animateEggPath.setAttribute("fill", "freeze");
}

function resetToEgg() {
    var animations = document.getElementById('egganimation');
    document.getElementById('eggpath').removeChild(animations);
} 
```

使用 SVG，它制作了一个鸡蛋，将其变形为一个箭头，然后通过删除动画节点来重置它。我遇到的问题是动画只能在第一次工作。当我尝试重置它并再次运行它时，它不再动画了。它只是立即变成箭头。我必须重新加载/刷新浏览器窗口才能再次制作动画。

我知道 Raphael JavaScript 库非常适合这种动画，但我想做的只是一个简单的变形。我的访问者将主要使用移动设备，所以我想避免加载一个库只是为了做这个简单的动画。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T07:36:37.100

动画在时间线上运行。动画时间基本上从 0 开始，然后当您运行动画时，它会运行到 4 秒。当您删除并重新添加动画时，您不会重置时间线，因此动画从 4 秒开始运行，这是结束点。您可以通过像这样调用 setCurrentTime 来重新启动时间线......

```
function resetToEgg() {
    var animations = document.getElementById('egganimation');
    document.getElementById('eggpath').removeChild(animations);
    curvecontainer.setCurrentTime(0);
    document.getElementById('arrowbutton').style.display = "inline";
    document.getElementById('resetbutton').style.display = "none";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T02:54:26.403

好的，首先代码有点乱，所以我没有花很多时间检查每一行，如果我错过了重要的事情，我会道歉。

因为您对我的初始功能`makeEgg()`让`changeToArrow()`我独自一人。

我从以下位置修改了前两行`resetToEgg()`：

```
var animations = document.getElementById('egganimation');
document.getElementById('eggpath').removeChild(animations); 
```

到

```
var animations = document.getElementById('curvecontainer');
document.getElementById('svgcontainer').removeChild(animations); 
```

这样它就删除了 svg 元素。接下来我添加了，`makeEgg();`以便重置鸡蛋

这是功能齐全的版本[http://jsfiddle.net/berodam/hArrb/](http://jsfiddle.net/berodam/hArrb/)

# php - php获取静态url并获取url部分

> ID：15857536
> 
> 赞同：0
> 
> 时间：2013-04-07T00:29:49.393
> 
> 标签：php

如何获得静态的路由 url，当我使用 $_SERVER["PHPSELF"] 时，它会返回 url 的实际页面，例如

```
/show_products.php 
```

但我的网址是这个

```
http://mysite.com/browse/department/?pid=1&order_by=a_z&filter=1 
```

我想从 url 得到的就是这个

```
 http://mysite.com/browse/department/ 
```

而且我希望能够只获取 url 的部门部分，所以我的问题有两个部分

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:41:15.087

URL 方案和主机名部分必须从请求 URI 单独处理：

```
// in your example, this results in "http://"
$scheme = ($_SERVER['HTTPS'] && $_SERVER['HTTPS'] <> 'off') ? 'https://' : 'http://';
// in your example, this results in "mysite.com"
$hostname = $_SERVER['SERVER_NAME'];
// in your example, this results in "/browse/department/"
$uri = $_SERVER['REQUEST_URI']; 
```

把碎片放在一起：

```
// in your example, this results in "http://mysite.com/browse/department/"
echo $scheme . $hostname . $uri; 
```

阅读有关[`$_SERVER[]`](http://php.net/manual/en/reserved.variables.server.php)数组内各种值的更多信息，或仅输出[`phpinfo()`](http://php.net/phpinfo)以轻松搜索`$_SERVER[]`数组以获取所需的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T00:32:31.483

查看[文档](http://php.net/manual/en/reserved.variables.server.php)`$_SERVER['REQUEST_URI']`以获取“为访问此页面而给出的 URI” 。

请注意，REQUEST_URI 不包括主机名，您需要在 $_SERVER['SERVER_NAME'] 中拼接。

那么 php[`parse_url()`](http://php.net/manual/en/function.parse-url.php)可能是为您提供不同部分的最简单方法，并快速深入了解您想要的内容。一旦您获得了来自 url (/browse/department) 的路径，您就可以在“/”上展开以获取各个路径片段。

见这里：http: [//3v4l.org/6ssAI](http://3v4l.org/6ssAI)

# c# - C++ 模板和 Java/C# 泛型有什么区别，有什么限制？

> ID：15857544
> 
> 赞同：6
> 
> 时间：2013-04-07T00:30:56.307
> 
> 标签：c#, java, c++, generics, template-meta-programming

[我从这里](https://stackoverflow.com/questions/2723397/java-generics-what-is-pecs/)阅读了一篇有趣的文章/线程/讨论，我收到了以下问题：

*   Java/C# 泛型的限制是什么？
*   Java/C# 泛型无法实现的 C++ 模板有哪些可能？

**编辑 1** [Eric Lippert](https://stackoverflow.com/users/88656/eric-lippert)的更多推荐问题

*   有哪些模式可以用 C# 泛型但不能用 C++ 模板？
*   C# 的真正泛型类型和 Java 的类型擦除泛型类型有什么区别？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-07T15:43:37.083

首先，您可能想阅读[我 2009 年关于此主题的文章](http://blogs.msdn.com/b/ericlippert/archive/2009/07/30/generics-are-not-templates.aspx)。

在我看来，C++ 模板和 C# 泛型之间的主要区别在于，C++ 模板实际上*在构建模板时完全重新编译了代码*。C++ 方法的优点和缺点有很多：

*   PRO：您可以有效地创建诸如“类型参数 T 必须具有加法运算符”之类的约束；如果代码包含几个相互添加的 T，那么如果您使用不允许添加的类型参数构造模板，则模板将无法编译。

*   CON：您可能会意外创建未记录的约束，例如“类型参数 T 必须具有加法运算符”。

在 C# 中，您必须*说明*哪些约束对用户有帮助，但您仅限于一小部分可能的约束：接口、基类、值与引用类型和默认构造函数约束，仅此而已。

*   PRO：对于两种不同的结构，语义分析可能完全不同。如果你想要，那太棒了。

*   CON：语义分析对于两种不同的结构可能是完全不同的。如果您不希望这样，那是一个等待发生的错误。

在 C# 中，无论类型构造多少次，语义分析都会执行*一次，因此需要使用**任何*满足约束的类型参数，而不仅仅是实际提供的类型参数。

*   PRO：您只为您需要的结构生成代码。

*   CON：您为您使用的所有结构生成代码。

模板会导致 codegen 变大。在 C# 中，泛型类型的 IL 生成一次，然后在运行时抖动对程序使用的所有类型进行代码生成。*这具有很小的性能成本，但由于抖动实际上只为所有引用类型参数*生成一次代码这一事实而有所缓解。因此，如果您有`List<object>`，`List<string>`然后jitted 代码只生成一次并用于两者。相比之下，两次 jits 代码`List<int>`。`List<short>`

*   PRO：当您使用模板库时，源代码就在那里。

*   缺点：要使用模板库，您必须拥有源代码。

在 C# 中，泛型类型是一等类型。如果将它们放在库中，则可以在任何地方使用该库，而无需发送源代码。

最后：

*   PRO：模板允许模板元编程。

*   CON：模板元编程对于新手来说很难理解。

*   CON：模板系统实际上不允许一些在通用系统中非常简单的类型拓扑。

例如，我想在 C++ 中做这样的事情会很困难：

```
class D<T> 
{
    class S { }
    D<D<T>.S> ds;
} 
```

在 C# 泛型中，没问题。在运行时，该类型只为所有引用类型参数构建*一次。*

但是在 C++ 模板中，当你有 时会发生什么`D<int>`？内部类型构造了一个类型的字段`D<D<int>.S>`，所以我们需要构造那个类型。但是该类型构造了一个类型为`D<D<D<int>.S>.S>`... 的字段，以此类推直到无穷大。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-07T00:30:56.307

## Java/C# 泛型的限制是什么？

Java 泛型是有限的，因为它不可能像在 C++ 中那样做一些技巧。

为了证明[这里](http://en.wikipedia.org/wiki/Policy-based_design)的声明是一个 C++ 示例，该示例无法在 Java 中单独使用模板来重现。

基于策略的编程是一种在编译时将（模板化）类的使用限制为其他（可能的）模板化类继承的方法。

**编译时泛型与运行时泛型有什么大不了的？**

交易是编译器了解类/模板可能的运行时行为的所有信息，因此它可以进行大量优化，而 C#/Java/任何运行时环境/编译器（目前）是不可能的。

另一个好的方面是编译器可以确保模板组合的实例化是有效的，这意味着当程序员想要实例化新对象时，不会像在 Java/C# 中那样发生运行时错误。无效的组合。

**C++ 泛型的缺点是什么？**

缺点是模板的阅读、理解和调试会变得非常复杂。这（也许）是 Java 开发人员不想在语言中拥有这样一个野兽的原因之一。

* * *

## C++ 泛型有什么可能，而 Java/C# 泛型是不可能的？

在 C++ 中可以使用其他模板作为模板参数，这在 C#/Java 中是不可能的，并且允许使用模板元编程之类的优雅技巧。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-07T00:49:19.607

Java 泛型的动机始终是提供类型安全，同时保持向后兼容性。Sun 通过添加类型检查然后在编译过程中擦除泛型类型来实现泛型。代码如：

```
// This applies to JDK 1.5, so I won't use <>.
List<Number> list = new ArrayList<Number>();
list.add(2.0);
list.add(-2);
list.add(new BigDecimal("1.23456789"); 
```

相当于

```
List list = new ArrayList();
Double temp = new Double(2.0); // boxing
if (!temp instanceof Number) throw new ClassCastException();
list.add(temp);
// Similar for -2 and the BigDecimal. 
```

不知道 list 的类型使其进入运行时类，但`instanceof`编译器可能会删除一些 s 以保证安全。

由于编译器不会将泛型类型写入已编译的类文件中，因此上述`list.getClass() == ArrayList.class`情况，不能像 C++ 中那样存在模板特化。`List<Boolean>`不能打包成一个比特序列。所有泛型类型都是类型，不像 C++ 中的模板，例如：

```
template<int length, int time, int mass>
class measurement {...} 
```

它可用于尺寸分析，并防止人们增加区域的长度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-07T00:55:10.927

根据[MSDN](http://msdn.microsoft.com/en-us/library/c6cyy67b.aspx)，C# 泛型和 C++ 模板之间的主要区别是：

*   C# 泛型不提供与 C++ 模板相同的灵活性。例如，不能在 C# 泛型类中调用算术运算符，但可以调用用户定义的运算符。
*   C# 不允许非类型模板参数，例如模板 C {}。
*   C# 不支持显式特化；也就是说，特定类型的模板的自定义实现。
*   C# 不支持部分特化：类型参数子集的自定义实现。
*   C# 不允许将类型参数用作泛型类型的基类。
*   C# 不允许类型参数具有默认类型。
*   在 C# 中，泛型类型参数本身不能是泛型，尽管构造类型可以用作泛型。C++ 确实允许模板参数。

然而，在某些情况下，您可以通过使用扩展方法来解决其中一些问题。

可以使用 C++ 泛型，无论是 C# 泛型还是 Java 泛型：真正的**模板元编程**（编译时图灵完成）。

```
#include <iostream>
template<unsigned U>
struct Fac{ enum { value = U * Fac<U-1>::value};};
template<>
struct Fac<0>{ enum { value = 1};};
template<unsigned U>
struct Fib{ enum {value = (Fib<U-1>::value + Fib<U-2>::value)};};
template<>
struct Fib<0>{ enum {value = 0};};
template<>
struct Fib<1>{ enum {value = 1};};
template<unsigned U>
void show(){
    show<U-1>();
    std::cout << "Fib(" << U << ")=" << Fib<U>::value << "\t" << "Fac(" << U << ")=" << Fac<U>::value << std::endl;
}
template<>
void show<0>(){}

int main(int argc, char** argv){
    show<12>();
} 
```

[http://ideone.com/Gdf3W](http://ideone.com/Gdf3W)

**编辑**

C++ 标准对类型参数没有限制，而[C#](http://msdn.microsoft.com/en-us/library/d5x73970%28VS.80%29.aspx)和[Java](https://stackoverflow.com/q/2081663/303290)有。Boost 有类似的东西（[Boost Concept Check Library](http://www.boost.org/doc/libs/1_36_0/libs/concept_check/concept_check.htm)）。但是从 C++11 开始，您现在可以使用[`<type_traits>`](http://www.cplusplus.com/reference/type_traits/)来获得类似的东西。

# javascript - CSS JQuery Div 相对于窗口大小的起始位置

> ID：15857548
> 
> 赞同：0
> 
> 时间：2013-04-07T00:31:05.113
> 
> 标签：javascript, css

我有一个很长的单页布局。包含所有内容的主容器 div 设计为从靠近页面底部开始（白色框，从底部向外窥视刚好足以看到徽标，然后用户必须滚动查看更多内容）。

问题是不同的屏幕尺寸和不同尺寸的浏览器，主容器 div 从顶部开始的高度不同，当用户第一次到达时显示的比预期的多或少。

我的想法是我需要使用 js 来计算 window.height，减去我想要最初显示的容器的高度，然后将所有这些包装在一个跟踪浏览器大小变化的事件处理程序中。

但是，我是 Jquery 的菜鸟，无法弄清楚。任何示例或可用的教程将引领潮流？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:30:51.820

为此做了一个小提琴：http: [//jsfiddle.net/QQaZp/1/](http://jsfiddle.net/QQaZp/1/)

基本上，设置你想要定位的任何东西（我只是使用了 div，但你应该使用#whateverID）在你的 css 中定位绝对。在 javascript 中加载和调整大小时，只需将 top 属性设置为任何`$(window).height()`值（我从中减去了 50px，所以它稍微向上看）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T02:32:04.047

如果我理解正确，您不需要 JavaScript。将 div 从顶部绝对 100% 定位，然后设置`margin-top`为负值。

CSS：

```
body, html {height: 100%;}

.section-1 {
    margin-top: -60px; /* Whatever value you want peeking out */
    position: absolute;
    top: 100%;
} 
```

在此处查看有效的 JSFiddle：http: [//jsfiddle.net/dsundy/5kt8P/1](http://jsfiddle.net/dsundy/5kt8P/1/)。

# c# - 将数字减 1

> ID：15857550
> 
> 赞同：0
> 
> 时间：2013-04-07T00:31:17.150
> 
> 标签：c#

我有一个枚举

```
enum MyEnum
{
  a=1,
  b=2,
  c=3
} 
```

例如，我为此枚举设置了一个变量

```
MyEnum myEnum = MyEnum.b 
```

然后我在我的代码中将此值减一

所以，

如果一个枚举被设置为 c (3) 它现在将被设置为 b (2)

如果一个枚举被设置为 b (2) 它现在将被设置为 a (1)

我正在寻找的是一种简洁的表达方式

如果一个枚举被设置为 a (1) 它现在将被设置为 c (3)

我想要一种简洁的方式来使这种递减关系循环。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:35:40.977

在这种情况下，简洁与可以理解的完全不同：

```
(MyEnum)((((int)myEnum+1) % 3) + 1) 
```

**解释**

首先，这个表达式将枚举转换为它的整数表示。然后，它减去 1 以将枚举值重新设置为 0，以便模块运算符 ( `%`) 起作用。然后它正在执行您提到的减法运算（-1）。为了避免负操作数，它添加了 3，这在应用模数运算后将不起作用。将这三个操作组合起来与添加 1 相同。然后，​​它执行模块操作，实现您正在寻找的循环属性。然后它重新设置值以再次从 1 开始（通过添加 1），最后将结果数字转换回 MyEnum。

**当枚举具有更多值时会发生什么？**

此表达式假定您的枚举以 3 结尾。如果您想将它用于具有更多项目的枚举，那么您需要使用一些反射，您可能应该将其提取到一个方法中：

```
MyEnum PreviousMyEnum(MyEnum myEnum)
{
    int maxValue = Enum.GetValues(typeof(MyEnum)).Cast<MyEnum>().Max();
    return (MyEnum)((((int)myEnum -2 + maxValue) % maxValue) + 1);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T01:03:26.747

我可能会使用条件。它非常清楚，而且不是特别冗长。

```
myEnum = myEnum==MyEnum.a ? MyEnum.c : (MyEnum)(int)myEnum-1; 
```

使用 Enum.GetValues() 使其通用化很容易。我认为上面的具体例子最清楚地表达了这个想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-07T01:07:51.350

```
int howManyYouWant = 20;

  //just get the enum values...
IEnumerable<MyEnum> someEnums = Enum
  .GetValues(typeof(MyEnum))
  .Cast<MyEnum>();

  //figure out how many times we go through the whole set to meet desired amount
int numberOfRepeats = 1 + (howManyYouWant / someEnums.Count());

IEnumerable<MyEnum> manyEnums = Enumerable
  .Repeat(someEnums.Reverse(), numberOfRepeats)    //repeat the reverse of the set
  .SelectMany(x => x)    //unpack those sets into one set.
  .Take(howManyYouWant);  //and take what you wanted.

foreach(MyEnum x in manyEnums)
{
 ...
} 
```

# asp.net-mvc - 在 ASP.Net MVC 中使用 EF Code-First 将子对象添加到没有显式外键 id 字段的父对象

> ID：15857551
> 
> 赞同：1
> 
> 时间：2013-04-07T00:31:21.503
> 
> 标签：asp.net-mvc, entity-framework, ef-code-first, code-first

我有两个模型类——`Parent`它们`Child`只通过类型化的导航属性链接。

```
public class Parent {
    [Key]
    [Required]
    public int Id { get; set; }

    [Required]
    public string ParentName { get; set; }

    public virtual ICollection<Child> Children { get; set; }
}

public class Child {
    [Key]
    [Required]
    public int Id { get; set; }

    [Required]
    public string ChildName { get; set; }

    [Required]
    public virtual Parent Parent { get; set; }
} 
```

现在我想`Child`使用 ASP.Net MVC 为父级创建一个新的。首先，我需要向用户展示一个视图。我需要以某种方式将父对象键传递给视图。我还想显示 ParentName。我只是`Parent`从数据库中获取对象，创建一个新`Child`对象，将其`Parent`属性设置为获取的`parent`对象。

```
 public ActionResult Create(int parentId) {
        var parent = db.Parents.Find(parentId);
        if (parent == null) {
            return HttpNotFound();
        }
        var child = new Child() { Parent = parent};
        return View(child);
    } 
```

`Create`用户填写表单后，使用 HTTP POST将数据发送到操作。

```
 [HttpPost]
    [ValidateAntiForgeryToken]
    public ActionResult Create(Child child)
    {
        if (ModelState.IsValid)
        {
            //db.Parents.Attach(child.Parent); //Added later
            db.Children.Add(child);
            db.SaveChanges();
            return RedirectToAction("Index", new { parentId = child.Parent.Id });
        }
    } 
```

在这里，我遇到了第一个问题。`child.Parent`不是 null 并且是正确的`child.Parent.Id`，但是 EF 将其丢弃并在数据库中创建了一个新的空父（使用不同的密钥）并将子链接到它。我已通过在添加( )`child.Parent`之前将 附加到数据上下文来解决此问题。`child``db.Parents.Attach(child.Parent)`

但后来我遇到了另一个问题。起初，我的模型类是错误的并且没有`[Required]`属性，因此创建了可为空的数据库表列。我添加了属性，代码停止工作。代码不起作用，因为`ModelState.IsValid`is`false`发生是因为`child.Parent.Name`传递了`child`is `null`。

如何解决将孩子添加到父母的问题？我对以下解决方案感兴趣：

*   使用 EF Code-First 和 ASP.Net MVC
*   不涉及`child.Parent`从数据库中获取只是为了让模型验证器满意。
*   不涉及向`ParentId`模型添加显式外键 ( )。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T02:56:52.253

我认为试图将父母与孩子联系起来有点倒退。通常，您会将孩子附加到父母身上。很可能正在创建新的父级，因为您没有在子模型中包含具有父级 ID 的输入元素。所以当 Child child 是 ModelBound 进入 POST 时， parent id 可能为 null。EF 看到了这一点，并认为您也想创建一个新的父级。

此外，由于您的 parentId 是您的路线的一部分，因此您无需在视图模型中指定它，除非您在视图中对 Html.BeginForm() 执行特殊操作。这意味着，如果您只使用 Html.BeginForm，它将使用您发送到 GET 请求的相同 URL 值进行发布。

**创建方法**

```
public ActionResult Create(int parentId) {
        var parent = db.Parents.Find(parentId);
        if (parent == null) {
            return HttpNotFound();
        }
        return View(new Child());
    }

[HttpPost]
[ValidateAntiForgeryToken]
public ActionResult Create(int parentId, Child child)
{
    if (ModelState.IsValid)
    {
        //Probably not a bad idea to check again...just to be sure.
        //Especially since we are attaching a child to the parent object anyways.
        var parent = db.Parents.Find(parentId);
        if (parent == null) {
            return HttpNotFound();
        }
        parent.Childern.Add(child);
        db.SaveChanges();
        return RedirectToAction("Index", new { parentId = parentid });
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-13T15:57:03.483

[这](http://msdn.microsoft.com/en-us/magazine/dn166926.aspx)是您问题的完整答案的链接。简短的回答是，当您使用断开连接的实体时，EF 不会尊重已设置的实体 ID，并将整个实体图标记为新的（例如已添加）。

我个人不喜欢它，只是重写 SaveChanges()，尽管当你有一个带有 int（或 long）Id 属性的 EnityBase 基类时它的工作原理如下（我觉得这非常方便）

```
public override int SaveChanges()
{
    this.ChangeTracker.Entries()
        .Where(x => x.Entity is EntityBase && x.State == EntityState.Added && ((EntityBase) x.Entity).Id > 0)
        .ForEach(x => x.State = EntityState.Unchanged);
    return base.SaveChanges();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-14T13:36:16.680

认为这应该适用于 Create 方法：

```
public ActionResult Create([Bind(Exclude="Parent")]Child child) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-20T14:50:40.623

```
var dataList = db.Menus.Include(X => X.Icon).ToList();
var ViewModellist = dataList.Join(dataList,
    a => a.ParentMenuId,
    b => b.MenuId,
    (_menu, _parent) => new MenuView
    {
        MenuId = _menu.MenuId,
        Action = _menu.Action,
        Controller = _menu.Controller,
        IsGroup = _menu.IsGroup,
        MenuCaption = _menu.MenuCaption,
        MenuOrder = _menu.MenuOrder,
        ParentMenuId = _menu.ParentMenuId,
        Visibility = _menu.Visibility,
        VisibilityMM = _menu.VisibilityMM,
        PMenuName = _parent.MenuCaption
    }).ToList();

if (PId == 0)
{
    var hierarchyList = ViewModellist.Where(x => x.ParentMenuId == null).OrderBy(x => x.MenuOrder).
   Select(x => new MenuView
   {
       MenuId = x.MenuId,
       Action = x.Action,
       Controller = x.Controller,
       IsGroup = x.IsGroup,
       MenuCaption = x.MenuCaption,
       MenuOrder = x.MenuOrder,
       ParentMenuId = x.ParentMenuId,
       PMenuName = x.PMenuName,
       Visibility = x.Visibility,
       VisibilityMM = x.VisibilityMM,
       ChildList = GetChildMenulist(x.MenuId, ViewModellist)

   }).FirstOrDefault();
    return View(hierarchyList);
}
else
{
    var hierarchyList = ViewModellist.Where(x => x.MenuId == PId).OrderBy(x => x.MenuOrder).
   Select(x => new MenuView
   {
       MenuId = x.MenuId,
       Action = x.Action,
       Controller = x.Controller,
       IsGroup = x.IsGroup,
       MenuCaption = x.MenuCaption,
       MenuOrder = x.MenuOrder,
       ParentMenuId = x.ParentMenuId,
       PMenuName = x.PMenuName,
       Visibility = x.Visibility,
       VisibilityMM = x.VisibilityMM,
       ChildList = GetChildMenulist(x.MenuId, ViewModellist)

   }).FirstOrDefault();
    return PartialView("_Index", hierarchyList);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-20T14:46:10.007

```
 public class Menu
{
    //public Menu()
    //{
    //    {
    //        this.Templates = new HashSet<MenuTemplate>();
    //    }

    //}
    [Key]
    public int MenuId { get; set; }

    [Column("MenuCaption")]
    [Display(Name = "Menu Caption")]
    [StringLength(100)]
    public string MenuCaption { get; set; }

    [Display(Name = "Parent Menu")]
    public int? ParentMenuId { get; set; }
    public virtual Menu ParentMenu { get; set; }
    [Display(Name = "Is Group")]
    public bool IsGroup { get; set; }

    [Display(Name = "Menu Order")]
    public int MenuOrder { get; set; }

    [Display(Name = "Visibility")]
    public bool Visibility { get; set; }
    [Display(Name = "Visibility Main Menu")]
    public bool VisibilityMM { get; set; }
    [Column("Controller")]
    [Display(Name = "Controller")]
    [StringLength(100)]
    public string Controller { get; set; }
    [Column("Action")]
    [Display(Name = "Action")]
    [StringLength(150)]
    public string Action { get; set; }

    [Display(Name = "Icon")]
    public int? IconID { get; set; }
    [ForeignKey("IconID")]
    public virtual Icon Icon { get; set; }

    public virtual ICollection<MenuTemplate> Templates { get; set; }
} 
```

# asp.net-mvc - ASP MVC3 - 获取文件路径

> ID：15857553
> 
> 赞同：1
> 
> 时间：2013-04-07T00:31:27.650
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2, filepath, file-browser

在我们的 ASP MVC3 中，我们需要允许用户导航到我们 LAN 上的共享文件夹并选择他们想要与特定项目关联的文件。我们想维护一个item的副本，所以我们不想做任何上传/下载，我们只想将指定的文件路径作为一个字段存储在SQL表中。最好的方法是什么？现在我可以使用这个助手打开一个文件浏览器窗口并选择文件，但是只有文件名被存储。

```
@Html.TextBoxFor(model => model.Attachments[0].Filepath, new { type = "file" }) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T08:26:09.770

> What is the best method to do this?

You could use a normal input field, not a file field:

```
@Html.TextBoxFor(model => model.Attachments[0].Filepath) 
```

Now the user can copy paste the file path in this field. That's what HTML has to offer you. If it doesn't suit your needs you always have the possibilities of using some client side scripting such as a Flash movie or Silverlight that will be installed on your clients browsers and might require elevated privileges in order to access the file system.

# magento-1.7 - Magento 1.7.2 curl 安装错误——绝望

> ID：15857554
> 
> 赞同：0
> 
> 时间：2013-04-07T00:31:42.147
> 
> 标签：magento-1.7

我正在使用 WampServer Apache 2.2.22 – Mysql 5.5.24 – PHP 5.4.3 XDebug 2.1.2 XDC 1.5 PhpMyadmin 3.4.10.1 SQLBuddy 1.3.3 webGrind 1.0。

错误 1：我收到以下错误。PHP 扩展“curl 必须加载。

所以我去 wamp\bin\php\php5.4.3 并取消注释行扩展=php_curl.dll。重启 wamp 服务器

错误 2：[1]：[http](http://imgur.com/wdmMP2z) : //imgur.com/wdmMP2z PHP Statup 无法加载动态库。c:/wamp/bin/php5.4.3/ext/php_curl.dll 应用程序无法启动，因为它的并排配置不正确。

我试图去这个网站并得到更正的 php [http://www.anindya.com/php-5-4-12-and-5-3-22-x64-64-bit-for-windows/](http://www.anindya.com/php-5-4-12-and-5-3-22-x64-64-bit-for-windows/) 所以我刚刚将其提取并替换为 c:\wamp\bin\php\php5.4.3 还尝试让它覆盖文件夹。都没有奏效。

谢谢你的帮助。

Magento 新手

真挚地，

乔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-17T18:21:50.973

似乎其他人在使用 Magento 1.7.x 和更新版本的 WAMP 时遇到了问题。这里的答案说他们必须回到 WAMP 2.1：

[Magento 1.7 和 Wamp 2.2](https://stackoverflow.com/questions/10685631/magento-1-7-with-wamp-2-2)

我在使用 php 5.4.3 的 Magento 1.6.x 和 WAMP 2.2 中遇到了与 curl 相关的问题——我相信我在成功运行时使用了旧的 php 5.3.10。

编辑：无论如何，对于 magento 1.6.2.0，您需要 WampServer 2.2D 中的 php 5.3.10（不是 E）

# c++ - 重载 << 运算符以打印出自定义异常

> ID：15857556
> 
> 赞同：-1
> 
> 时间：2013-04-07T00:31:49.323
> 
> 标签：c++

我试图找出如何能够写出这样的东西：

```
try{
    throw MyCustomException;
}
catch(const MyCustomException &e){
cout<< e;
} 
```

但是如何定义`overloaded operator <<`这个目的呢？

自定义异常类：

```
class MyCustomException{

public:

MyCustomException(const int& x) {
    stringstream ss;
    ss << x; 

    msg_ = "Invalid index [" + ss.str() + "]";
}

string getMessage() const {
    return (msg_);
}
private:
    string msg_;
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-07T00:38:38.380

老实说，我相信正确的解决方案是**遵循标准约定**并`MyCustomException`从`std::exception`. 然后，您将实现`what()`虚拟成员函数以返回一条消息，并且您最终可以将该字符串通过`operator <<`.

这就是您的异常类的样子：

```
#include <string>
#include <sstream>
#include <stdexcept>

using std::string;
using std::stringstream;

class MyCustomException : public std::exception
{
public:

    MyCustomException(const int& x) {
        stringstream ss;
        ss << x;
        msg_ = "Invalid index [" + ss.str() + "]";
    }

    virtual const char* what() const noexcept {
        return (msg_.c_str());
    }

private:

    string msg_;
}; 
```

以下是您将如何使用它：

```
#include <iostream>

using std::cout;

int main()
{
    try
    {
        throw MyCustomException(42);
    }
    catch(const MyCustomException &e)
    {
        cout << e.what();
    }
} 
```

最后，一个[活生生的例子](http://liveworkspace.org/code/4yc7Hy%243646)。

# php - 使用正则表达式和 DOMDocument 递归处理标记

> ID：15857560
> 
> 赞同：2
> 
> 时间：2013-04-07T00:32:07.513
> 
> 标签：php, regex, domdocument

我一直在努力为我正在开发的 HTML 标记语言的基本文本创建解析器。内联元素标记如下。

```
{*strong*}
{/emphasis/}
{-strikethrough-}
{>small<}
{|code|} 
```

我正在测试的示例字符串是：

```
tëstïng 汉字/漢字 testing {*strông{/ëmphäsïs{-strïkë{|côdë|}-}/}*} {*wôw*} 1, 2, 3 
```

使用`preg_split`我可以将其转换为：

```
$split = preg_split('%(\{.(?:[^{}]+|(?R))+.\})%',
    $str, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE);

array (size=5)
  0 => string 'tëstïng 汉字/漢字 testing ' (length=32)
  1 => string '{*strông{/ëmphäsïs{-strïkë{|côdë|}-}/}*}' (length=48)
  2 => string ' ' (length=1)
  3 => string '{*wôw*}' (length=8)
  4 => string ' 1, 2, 3' (length=8) 
```

然后遍历 and`$dom->createTextNode()`或`$dom->createElement()`+ `$dom->appendChild($dom->createTextNode())`。不幸的是，这在嵌套标记时无济于事。

我只是对递归处理我的标记到 DOMDocument 的有效方法感到困惑。我一直在阅读，我需要编写一个解析器，但找不到我可以遵循的合适教程或代码示例，尤其是在使用 DOMDocument 将它与元素和文本节点创建集成时。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-07T07:12:43.617

嵌套或递归结构通常超出了正则表达式的解析能力，您通常需要更强大的解析器。问题是您需要查找的下一个标记会根据以前的标记发生变化，这不是正则表达式可以处理的（语言不再是正​​则的）。

然而，对于这样一种简单的语言，您不需要具有正式语法的完整解析器生成器——您可以轻松地手动编写一个简单的解析器。你只有一个重要的状态——最后打开的标签。如果您有一个匹配文本的正则表达式、一个新的打开标签或与当前打开标签对应的关闭标签，您可以处理此任务。规则是：

1.  如果匹配文本，请保存文本并继续匹配。
2.  如果匹配打开标签，请保存打开标签，然后继续匹配，直到找到打开标签或相应的关闭标签。
3.  如果您匹配一个关闭标签，请停止查找当前打开的标签并继续匹配最后一个未关闭的标签、文本或另一个打开的标签。

第二步是递归的——每当你找到一个新的打开标签时，你就创建一个新的匹配上下文来寻找相应的关闭标签。

这不是必需的，但通常解析器会生成一个简单的树结构来表示已解析的文本——这被称为抽象语法树。在生成语法所代表的内容之前，通常最好先生成语法树。这使您可以灵活地操作树或产生不同的输出（例如，您可以输出 xml 以外的其他内容。）

这是一个结合了这些想法并解析您的文本的解决方案。（它也将`{{`or识别`}}`为转义序列，表示单个文字`{`或`}`。）

首先是解析器：

```
class ParseError extends RuntimeException {}

function str_to_ast($s, $offset=0, $ast=array(), $opentag=null) {
    if ($opentag) {
        $qot = preg_quote($opentag, '%');
        $re_text_suppl = '[^{'.$qot.']|{{|'.$qot.'[^}]';
        $re_closetag = '|(?<closetag>'.$qot.'\})';
    } else {
        $re_text_suppl = '[^{]|{{';
        $re_closetag = '';
    }
    $re_next = '%
        (?:\{(?P<opentag>[^{\s]))  # match an open tag
              #which is "{" followed by anything other than whitespace or another "{"
        '.$re_closetag.'  # if we have an open tag, match the corresponding close tag, e.g. "-}"
        |(?P<text>(?:'.$re_text_suppl.')+) # match text
            # we allow non-matching close tags to act as text (no escape required)
            # you can change this to produce a parseError instead
        %ux';
    while ($offset < strlen($s)) {
        if (preg_match($re_next, $s, $m, PREG_OFFSET_CAPTURE, $offset)) {
            list($totalmatch, $offset) = $m[0];
            $offset += strlen($totalmatch);
            unset($totalmatch);
            if (isset($m['opentag']) && $m['opentag'][1] !== -1) {
                list($newopen, $_) = $m['opentag'];
                list($subast, $offset) = str_to_ast($s, $offset, array(), $newopen);
                $ast[] = array($newopen, $subast);
            } else if (isset($m['text']) && $m['text'][1] !== -1) {
                list($text, $_) = $m['text'];
                $ast[] = array(null, $text);
            } else if ($opentag && isset($m['closetag']) && $m['closetag'][1] !== -1) {
                return array($ast, $offset);
            } else {
                throw new ParseError("Bug in parser!");
            }
        } else {
            throw new ParseError("Could not parse past offset: $offset");
        }
    }
    return array($ast, $offset);
}

function parse($s) {
    list($ast, $offset) = str_to_ast($s);
    return $ast;
} 
```

`array(null, $string)`这将产生一个抽象语法树，它是一个“节点”列表，其中每个节点都是文本形式的数组，或者`array('-', array(...))`（即类型代码和另一个节点列表）用于标签内的内容。

一旦你有了这棵树，你就可以用它做任何你想做的事情。例如，我们可以递归地遍历它来生成一棵 DOM 树：

```
function ast_to_dom($ast, DOMNode $n = null) {
    if ($n === null) {
        $dd = new DOMDocument('1.0', 'utf-8');
        $dd->xmlStandalone = true;
        $n = $dd->createDocumentFragment();
    } else {
        $dd = $n->ownerDocument;
    }
    // Map of type codes to element names
    $typemap = array(
        '*' => 'strong',
        '/' => 'em',
        '-' => 's',
        '>' => 'small',
        '|' => 'code',
    );

    foreach ($ast as $astnode) {
        list($type, $data) = $astnode;
        if ($type===null) {
            $n->appendChild($dd->createTextNode($data));
        } else {
            $n->appendChild(ast_to_dom($data, $dd->createElement($typemap[$type])));
        }
    }
    return $n;
}

function ast_to_doc($ast) {
    $doc = new DOMDocument('1.0', 'utf-8');
    $doc->xmlStandalone = true;
    $root = $doc->createElement('body');
    $doc->appendChild($root);
    ast_to_dom($ast, $root);
    return $doc;
} 
```

这是一些测试用例更难的测试代码：

```
$sample = "tëstïng 汉字/漢字 {{ testing -} {*strông 
    {/ëmphäsïs {-strïkë *}also strike-}/} also {|côdë|}
    strong *} {*wôw*} 1, 2, 3";
$ast = parse($sample);
echo ast_to_doc($ast)->saveXML(); 
```

这将打印以下内容：

```
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<body>tëstïng 汉字/漢字 {{ testing -} <strong>strông 
    <em>ëmphäsïs <s>strïkë *}also strike</s></em> also <code>côdë</code>
    strong </strong> <strong>wôw</strong> 1, 2, 3</body> 
```

如果您已经有 a`DOMDocument`并且想要向其中添加一些已解析的文本，我建议您创建 a`DOMDocumentFragment`并将其`ast_to_dom`直接传递给，然后将其附加到所需的容器元素中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T02:50:37.973

如果您有一个捕获最外层打开/关闭对的内容的正则表达式，则可以将该捕获的内容包装在等效的 HTML 标记中，然后通过重复相同的正则表达式递归到该新字符串（这将捕获倒数第二对），依此类推。

这种方法的问题是，如果/当一个打开的“标签”没有正确关闭时，整个内容都会丢失，然后你就不能递归进去。

更可靠的方法可能是从头到尾解析文本，当遇到开始标签时，将其及其位置添加到堆栈中。每当遇到结束标记时，如果它与堆栈顶部的开始标记不匹配，则将其忽略，或者如果匹配，则将当前结束标记替换为等效的 HTML 结束标记，并从堆栈顶部弹出开始标记堆栈（并将其替换为记录位置的等效打开 HTML 标记）。

一个简单的解析算法可能是找到你的开始或结束标签的第一个实例（例如使用这个正则表达式`(\{[-*/>|])|(\}[-*/<|])`），然后按上面的方法处理，然后从当前位置重复搜索以找到下一个标签，等等......

# ios - Restkit - 无论如何要在收到 403 响应时设置默认操作？

> ID：15857566
> 
> 赞同：2
> 
> 时间：2013-04-07T00:33:25.153
> 
> 标签：ios, restkit

使用 Restkit，我在 AppDelegate 中设置了 RKObjectManager，一切正常。我想知道是否有某种方法可以为特定响应代码设置默认操作。

例如，用户使用我的 iPhone 应用程序登录到我的 api 并获取 auth_token 以重新使用。如果在任何时候，对于任何请求，我都会收到 403 响应（例如 auth_token 是否过期），我想将 RootViewController 更改为我的登录屏幕。

在我的应用程序中进行设置的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-06-05T09:08:53.537

在 RestKit 0.20 中，您可以注册您的`RKObjectRequestOperation`，因此您可以在其他任何事情之前通过您自己的成功/失败块传递所有请求/响应。

[http://blog.higgsboson.tk/2013/09/03/global-request-management-with-restkit/](http://blog.higgsboson.tk/2013/09/03/global-request-management-with-restkit/)

```
#import "RKObjectRequestOperation.h"

@interface CustomRKObjectRequestOperation : RKObjectRequestOperation

@end

@implementation CustomRKObjectRequestOperation

- (void)setCompletionBlockWithSuccess:(void ( ^ ) ( RKObjectRequestOperation *operation , RKMappingResult *mappingResult ))success failure:(void ( ^ ) ( RKObjectRequestOperation *operation , NSError *error ))failure
{
    [super setCompletionBlockWithSuccess:^void(RKObjectRequestOperation *operation , RKMappingResult *mappingResult) {
        if (success) {
            success(operation, mappingResult);
        }

    }failure:^void(RKObjectRequestOperation *operation , NSError *error) {

        [[NSNotificationCenter defaultCenter] postNotificationName:@"connectionFailure" object:operation];

        if (failure) {
            failure(operation, error);
        }

    }];
} 

@end 
```

然后注册你的子类：

```
[[RKObjectManager sharedManager] registerRequestOperationClass:[CustomRKObjectRequestOperation class]]; 
```

并收听您在上面发送的“connectionFailure”：

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(connectionFailedWithOperation:) name:@"connectionFailure" object:nil]; 
```

在侦听器中（例如您的 AppDelegate 或登录管理器）：

```
- (void)connectionFailedWithOperation:(NSNotification *)notification
{
    RKObjectRequestOperation *operation = (RKObjectRequestOperation *)notification.object;
    if (operation) {

        NSInteger statusCode = operation.HTTPRequestOperation.response.statusCode;

        switch (statusCode) {
            case 0: // No internet connection
            {
            }
                break;
            case  401: // not authenticated
            {
            }
                break;

            default:
            {
            }
                break;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T17:37:18.940

使用 RestKit 0.10 时，您可以使用给定的委托方法`objectLoaderDidLoadUnexpectedResponse`。

```
- (void)objectLoaderDidLoadUnexpectedResponse:(RKObjectLoader *)objectLoader {
    if ([[objectLoader response] statusCode] == 403) {
        // Your action here
    }
} 
```

在 RestKit 0.20 中，您可以将响应描述符用于单个代码或一组代码。

```
RKResponseDescriptor *responseDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:responseMapping 
                                                                                   pathPattern:nil 
                                                                                       keyPath:@"yourKeyPath" 
                                                                                   statusCodes:[NSIndexSet indexSetWithIndex:403]]; 
```

[文档](http://restkit.org/api/0.20.0/Classes/RKObjectManager.html)中的更多状态代码集。

## 更新

当使用 BaseViewController 处理在其他视图控制器之一中发出的请求错误时，您可以设置通知。

*BaseViewController*

```
- (void)viewDidLoad 
{
    // ...

    // Set observer for notification e.g. "requestFailedWith403Error"
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(handle403Error:) name:@"requestFailedWith403Error" object:self];
}

- (void)handle403Error:(NSNotification)notification 
{
    // Code for handling the error 
} 
```

*子视图控制器*

```
- (void)loginToServer 
{
    // ...

    // Set authorization header
    [[RKObjectManager sharedManager].HTTPClient setAuthorizationHeaderWithUsername:@"username" password:@"password"];

    // e.g. POST to server
    [[RKObjectManager sharedManager] postObject:yourObject
                                       path:@"path/toserver"
                                 parameters:nil
                                    success:^(RKObjectRequestOperation *operation, RKMappingResult *mappingResult) {
                                        // Handling success
                                    } failure:^(RKObjectRequestOperation *operation, NSError *error) {
                                        // Handling error with notification
                                        [[NSNotificationCenter defaultCenter] postNotificationName:@"requestFailedWith403Error" object:self];
    }];
} 
```

通过处理错误来优化您的中央配置，您可以再看一下[RestKit Wiki](https://github.com/RestKit/RestKit#centralize-configuration-in-an-object-manager)中给出的示例代码（其中添加了错误映射）。

# javascript - node.js：程序要么意外退出，要么只是挂起

> ID：15857568
> 
> 赞同：9
> 
> 时间：2013-04-07T00:33:37.863
> 
> 标签：javascript, node.js, asynchronous, server-side, node-async

我在 node.js 中编写了一个执行一些网络操作的模块。我写了一个使用这个模块的小脚本（`check`下面的变量）。它看起来像这样：

```
check(obj, function (err, results) {
    // ...
    console.log("Check completed");
}); 
```

现在这是有趣的事情。当此代码作为`mocha`测试的一部分执行时，测试会按预期退出。我看到打印的日志语句并且进程退出。

当代码作为独立节点脚本执行时，会打印日志语句，但进程只是挂起。

当我尝试调试它并使用`--debug-brk`和使用启动程序`node-inspector`时，它会提前退出！我看那`process.on 'exit'`叫。它在模块中的一些内部回调尚未被调用时退出。所以上面的日志语句也没有打印出来。

我现在被卡住了，不确定为什么会这样。有没有人见过类似的行为？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-07T02:28:30.757

当您将它作为脚本运行并在“完成”时挂起时，这意味着节点仍然注册了等待事件的回调。Node 不知道这些事件不会再触发。如果您知道是时候退出，您可以直接调用`process.exit()`，或者您可以显式关闭/取消绑定/断开所有内容（网络连接、数据库连接等）。如果您正确关闭所有内容，则节点应退出。

模块[wtfnode](https://www.npmjs.com/package/wtfnode)（由 Nathan Arthur 提到）或[why-is-node-running](https://www.npmjs.com/package/why-is-node-running)非常有助于跟踪这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-29T21:21:49.773

如果程序意外退出，可能是因为事件循环变空并且没有其他事情可做（因为某些代码忘记发出错误或执行其他操作来保持事件循环继续进行）。在这种情况下，Node 以代码 0 退出，并且您不会收到任何错误消息，因此它可能真的很混乱。

有关发生这种情况的示例，请参阅[https://github.com/archiverjs/node-archiver/issues/457 。](https://github.com/archiverjs/node-archiver/issues/457)

# php - 无法使用格式正确的数据填充 JSON 请求

> ID：15857570
> 
> 赞同：0
> 
> 时间：2013-04-07T00:33:48.233
> 
> 标签：php, javascript, json, google-maps

我正在尝试使用从我的 phpsearch.php 文件返回的数据填充 JSON 请求（此处显示）

```
<?php
include "base.php";
$name = $_GET["name"];
$query = "SELECT lat, lng FROM markers WHERE name = '".$name."'";
$result = mysql_query($query);
$json = array();
while($row = mysql_fetch_array ($result))     
{
  $bus = array(
        'lat' => $row['lat'],
        'lng' => $row['lng']
    );
    array_push($json, $bus);
}
$jsonstring = json_encode($json);
echo $jsonstring;
?> 
```

数据以这种格式显示在控制台中：

```
[{"lat":"37.730267","lng":"-122.498589"}] 
```

路由计算功能在问题的底部，我之前使用过异步 JSON rewquest，但这导致代码在设置原始值之前执行，现在正在设置但看起来不正确

如何确保我的纬度和经度结果采用正确的 JSON 格式？目前 JSON 请求如下所示：

```
 Request URL:https://maps.googleapis.com/maps/api/js/DirectionsService.Route?4b0&5m4&1m3&1m2&1dNaN&2dNaN&5m4&1m3&1m2&1d37.738029&2d-122.499481&6e1&8b1&12sen-GB&100b0&102b0&callback=_xdc_._1rqnjk&token=80599 
```

路线计算代码：

```
 function calcRoute() {
        var startname = document.getElementById('start').value;
        var endname = document.getElementById('end').value;
        var waypts = [];
        var checkboxArray = document.getElementById('waypoints');
        for (var i = 0; i < checkboxArray.length; i++) {
          if (checkboxArray.options[i].selected == true) {
            waypts.push({
                location:checkboxArray[i].value,
                stopover:true});
          }
        }

$.ajax({
    url:'phpsearch2.php', 
    dataType:'html', 
    data:{name:startname},
    async:false,
    success:function (result)
{
    console.log(result)
    origin = new google.maps.LatLng(result[0].lat, result[0].lng);
}});

    var end = new google.maps.LatLng('37.738029', '-122.499481');
    var request = {
            origin: origin,
            destination: end,
            waypoints: waypts,
            optimizeWaypoints: true,
            travelMode: google.maps.DirectionsTravelMode.WALKING
        };

            directionsService.route(request, function(response, status) {
        document.write('<b>'+ origin +'</b>');
          if (status == google.maps.DirectionsStatus.OK) {
            directionsDisplay.setDirections(response);
            var route = response.routes[0];
            var summaryPanel = document.getElementById('directions_panel');
            summaryPanel.innerHTML = '';
            // For each route, display summary information.
            for (var i = 0; i < route.legs.length; i++) {
              var routeSegment = i + 1;
              summaryPanel.innerHTML += '<b>Time for a Walkabout </b><br>';
              summaryPanel.innerHTML += '<b>From ' + startname + '   </b>';
              summaryPanel.innerHTML += '<b>to ' + endname + '('+ route.legs[i].distance.text +')</b><br>';
          } 
          }
        });
     } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:01:58.917

LatLng 构造函数接受两个数字作为参数，您传递给它一个 JSON 对象。获取纬度和经度属性并直接传递数字，如下所示：

```
function (result){
    origin = new google.maps.LatLng(result[0].latitude, result[0].longitude);
} 
```

我在猜测特定属性，您可能想`console.log(result)`查看确切的对象结构。

# windows-phone-7 - 带有 Windows Phone 工具包的多目标 WP7.1/WP8 应用程序 (Panorama / LongListSelector)

> ID：15857571
> 
> 赞同：3
> 
> 时间：2013-04-07T00:33:57.703
> 
> 标签：windows-phone-7, xaml, windows-phone-8, windows-phone, silverlight-toolkit

想知道是否有人知道如何处理这个问题。

在 WP7.1 中，我们可以利用优秀的[Windows Phone Toolkit](http://phone.codeplex.com)来包含一些有用的控件，例如 LongListSelector 和 Panorama。这些是`Microsoft.Phone.Controls.Toolkit`组件的一部分。

在 WP8 中，我们不需要这两个控件的工具包，因为它们是官方`Microsoft.Phone.Controls`程序集的一部分。

我有多个目标我的应用程序，所以我有两个手机项目，WP71 和 WP80，我将 WP80 中的文件链接到 WP71 中的文件。

在我尝试在 XAML 页面中使用 Panorama 或 LongListSelector 控件**之前**，这非常有效。在 WP80 项目中，如果我引用手机工具包的 WP80 DLL，它不包含上述两个控件，因为令人惊讶的是，它们已经存在。

问题是，WP71 需要 XAML 顶部的命名空间声明，并且两个项目的命名空间不同。

**WP71**：

```
xmlns:toolkit="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone.Controls.Toolkit"

<toolkit:Panorama /> 
```

**WP80**：

```
xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"

<phone:Panorama /> 
```

我无法构建项目，因为每个项目都认为如果我只使用一个命名空间是不正确的，因为它们需要指向不同的程序集。

我不认为我可以在我的 XAML 中使用编译常量，否则这将是一个修复。

我的解决方法最初只是在我的 WP80 项目中引用旧的 WP71 DLL。但是其他 3rd 方库绑定了官方 8.0 SDK DLL（在我的例子中是 Caliburn），所以它会导致问题。

我该如何解决这个泡菜？我脑海中唯一的想法是诉诸代码隐藏来创建控件的实例:(有更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T00:59:10.323

不要使用链接，为每个链接创建一个单独的视图。

另一种解决方案可能是`PanoramaEx`在每个相关项目中创建一个控件并从`Panorama`. 然后视图将引用`PanoramaEx`控件，您仍然可以使用指向单个视图的链接。那是如果两个 UI 项目具有相同的命名空间。

编辑：不是命名空间中 WP7 的全景图：

```
 xmlns:controls="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone.Controls" 
```

我确实将我的初始解决方案用于 ProgressBar 和 PerformanceProgressBar，我`ProgressBarEx`在每个 UI 项目中都有一个，WP7 继承自`ProgressBar`，WP8 继承自`PerformanceProgressBar`，然后在我引用的视图中`ProgressBarEx`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-25T11:03:36.633

可能不是最优雅的解决方案，但您可以尝试使用 T4 文件（.tt 文件）来生成两个目标。

```
<#@ template language="C#" hostspecific="true"#>
<#@ output extension=".xaml"#>
<#@ assembly name="EnvDTE" #>
<phone:PhoneApplicationPage
    x:Class="PhoneAppDemo.Pages.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
<# IServiceProvider serviceProvider = (IServiceProvider)Host;
   EnvDTE.DTE dte = (EnvDTE.DTE)serviceProvider.GetService(typeof(EnvDTE.DTE));
   var configName = dte.Solution.SolutionBuild.ActiveConfiguration.Name;
   if (configName == "WP7") { #>
    xmlns:controls="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone.Controls"
<# }else{ #>
    xmlns:controls="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
<# } #>
    >
<# include file="Page.xaml" #>
</phone:PhoneApplicationPage> 
```

在此示例中，页面的内部内容位于“Page.xaml”中。我们只是`<phone:PhoneApplicationPage>`在处理器时根据目标名称（通常是**Debug**和**Release**，但在本例中我们假设有一个目标**WP7**）将其封装。

对于与多目标 Silverlight 应用程序相关的其他内容，您始终可以阅读[维护同一 Silverlight 应用程序的 WP7 和 WP8 版本](https://web.archive.org/web/20140206040639/http://developer.nokia.com/community/wiki/Maintaining_a_WP7_and_WP8_version_of_a_same_Silverlight_application)。

# asp.net-mvc - WP-Cron 的 ASP.NET MVC 版本

> ID：15857578
> 
> 赞同：0
> 
> 时间：2013-04-07T00:34:48.157
> 
> 标签：asp.net-mvc, cron

Wordpress 有一个有趣的插件，叫做`wp-cron`. 它的作用类似于 cron，但不需要设置“真正的”cron。

它的工作方式非常简单：一旦您指定了 cron 频率（例如，每天凌晨 3 点一次），每当有人访问您的站点时，它都会检查是否该执行 cron 任务（上次访问是在 cron 之前，当前访问是后cron），并做到了。

有什么东西（在 NuGet 上？）可以为 ASP.NET MVC（4）做到这一点吗？我无法想象编写起来非常复杂，所以我假设已经有人解决了这个问题。一个快速的谷歌刚刚出现“编写一个 Windows 服务”或“设置*真正的*cron”。

Workflow Foundation 也可以工作，尽管我认为它比你可以实现 wp-cron 风格的工作更多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T02:30:40.490

如果你想安排一些任务，你可以看看[`Quarts.net`](http://quartznet.sourceforge.net/). 它是一个基于这类东西的完整库。如果你想要一些肮脏的东西，[Jeff Atwood](https://blog.stackoverflow.com/2008/07/easy-background-tasks-in-aspnet/)有一个很好的方法（在 StackOverflow 上使用过），它利用了缓存和过期。

# objective-c - 多线程 Objective-C 访问器：GCD 与锁

> ID：15857581
> 
> 赞同：8
> 
> 时间：2013-04-07T00:35:16.087
> 
> 标签：objective-c, multithreading, locking, grand-central-dispatch

我正在争论是否要为多线程访问器迁移到基于 GCD 的模式。多年来，我一直在访问器中使用自定义的基于锁的同步，但我发现了一些信息（[GCD 简介](http://www.mikeash.com/pyblog/friday-qa-2009-08-28-intro-to-grand-central-dispatch-part-i-basics-and-dispatch-queues.html)），并且似乎有基于 GCD 的方法的优点。我希望在这里开始对话，以帮助自己和其他人权衡决定。

模式看起来像：

```
- (id)something
{
    __block id localSomething;
    dispatch_sync(queue, ^{
        localSomething = [something retain];
    });
    return [localSomething autorelease];
}

- (void)setSomething:(id)newSomething
{
    dispatch_async(queue, ^{
        if(newSomething != something)
        {
            [something release];
            something = [newSomething retain];
            [self updateSomethingCaches];
        }
    });
} 
```

在专业方面：您可能会受益于非阻塞写访问；比锁更低的开销（也许？）；从关键代码部分返回之前忘记解锁的安全性；其他的？

缺点：不存在异常处理，因此您必须将其编码到您可能需要它的每个块中。

这种模式是否可能是编写多线程访问器的推荐方法？

是否有为此目的创建调度队列的标准方法？换句话说，权衡粒度的最佳实践？例如，使用锁，锁定每个属性比锁定整个对象更精细。使用调度队列，我可以想象为所有对象创建一个队列会造成性能瓶颈，那么每个对象队列是否合适？显然，答案在很大程度上取决于具体的应用程序，但是否存在已知的性能权衡来帮助衡量该方法的可行性。

任何信息/见解将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-07T01:56:03.203

> 这种模式是否可能是编写多线程访问器的推荐方法？

我猜你是在考虑串行队列的情况下写的，但没有理由这样做。考虑一下：

```
dispatch_queue_t queue = dispatch_queue_create("com.example", DISPATCH_QUEUE_CONCURRENT);

// same thing as your example
- (NSString*)something {
    __block NSString *localSomething;
    dispatch_sync(queue, ^{
        localSomething = _something;
    });
    return localSomething;
}

- (void)setSomething:(NSString*)something {
    dispatch_barrier_async(queue, ^{
        _something = something;
    });
} 
```

它同时读取，但在写入发生时使用调度屏障来禁用并发。GCD 的一大优势是允许并发读取，而不是像 @property (atomic) 那样锁定整个对象。

从客户端的角度来看，这两种异步（dispatch_async、dispatch_barrier_async）都更快，但执行起来却比同步慢，因为它们必须复制块，并且拥有如此小的任务块，复制所花费的时间变得有意义。我宁愿让客户快速返回，所以我可以接受。

# jquery - 同位素/砌体额外高度与图像

> ID：15857582
> 
> 赞同：0
> 
> 时间：2013-04-07T00:35:22.420
> 
> 标签：jquery, jquery-isotope

我已经实现了同位素，但砖石似乎也发生了同样的情况。我的容器是带有图像的 LI。目前我有一个本地图像和来自 instagram 的一些图像，LI 有 bg 颜色，我可以帮助解决问题。图像通过 CSS 将宽度设置为 100%，这使它们具有与父级相同的宽度。我尝试使用 img 标签强制执行此操作。

该网站在这里：[http ://template.markjhandy.com/](http://template.markjhandy.com/)

我目前正在解决这个问题，但我暂时不会推送任何新代码。

谢谢！

# node.js - 如何让 grunt.js 启动一个快速应用程序进行测试

> ID：15857585
> 
> 赞同：8
> 
> 时间：2013-04-07T00:35:32.850
> 
> 标签：node.js, unit-testing, gruntjs

我目前的情况是我使用 grunt 制作我的 express 应用程序的生产版本（最小化并合并所有 js/css，复制所有文件）然后我必须运行一个设置环境变量的脚本（我的应用程序仅在以 TEST 模式运行时提供测试工具），创建一个空的 Mongo 测试数据库，然后在应用程序目录上调用 npm start，然后我必须手动从 Chrome 或 Phantom 运行测试，我想要做的是grunt 设置环境变量并运行服务器，运行测试，然后停止服务器（将来如果一切成功，也可以部署它）。但是，当我尝试在 grunt 中运行应用程序时，它会在完成后立即停止。

我如何 grunt 启动应用程序，等到它启动然后运行测试？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-09T19:21:54.213

如果您检查[grunt-express](https://github.com/blai/grunt-express)，它是通过 grunt 快速执行 Web 服务器任务的插件。

> ### 快速保活
> 
> 请注意，该服务器仅在 grunt 运行时运行。一旦 grunt 的任务完成，Web 服务器就会停止。可以通过在任务列表的末尾附加一个 express-keepalive 任​​务来更改此行为，如下所示
> 
> `grunt.registerTask('myServer', ['express', 'express-keepalive']);`
> 现在，当您运行 grunt myServer 时，您的 express 服务器将保持活动状态，直到您手动终止它。
> 
> 也可以通过运行类似`grunt express express-keepalive`.
> 
> 这种设计使您可以灵活地将 grunt-express 与另一个随后立即运行的任务结合使用，例如 grunt-contrib-qunit 插件 qunit 任务。如果我们强制 express 任务总是异步的，这样的用例就不会再发生了。

指南`grunt-contrib-qunit`包中的用于在无头 PhantomJS 实例中运行 QUnit 单元测试。还要注意最后一行，如果您强制 express 始终异步，那将毫无用处。

的npm[链接](https://npmjs.org/package/grunt-express)。`grunt-express`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T20:23:46.213

我不确定我是否正确理解了您的问题，但这可能会有所帮助：

你知道 Grunt 的异步功能吗？一段时间以来，我使用以下方法来启动（和停止）我的 Express 应用程序。我用它和手表一起使用，所以它在保存时自动重新启动。在这种情况下，您必须将手表的 nospawn 选项设置为 true。

```
var server = null;
grunt.registerTask('server', 'Start server', function() {
  var done = this.async();
  if (server !== null) {
    server.close();
    clearCache();
  }
  var app = require('./my-express-app.js');
  server = http.createServer(app).listen(app.get('port'), function(){
    done();
  });
});

function clearCache() {
  for (key in require.cache) {
    if (key.indexOf(__dirname + '/node_modules/') == -1) {
      delete require.cache[key];
    }
  }
} 
```

由于这个require-cache-hack，它很丑陋。但是，它有效。

# php - PHP/JS 倒计时与服务器时间

> ID：15857587
> 
> 赞同：0
> 
> 时间：2013-04-07T00:35:39.140
> 
> 标签：php, javascript, countdown

我正在研究显示日期倒计时的 php / javascript。这要显示从服务器时间到来的时间。

```
<?php date_default_timezone_set( "Europe/Berlin"); ?>
<script>
  var end = new Date('04/12/2013 9:0 PM');
  var _second = 1000;
  var _minute = _second * 60;
  var _hour = _minute * 60;
  var _day = _hour * 24;
  var timer;

  function showRemaining() {
    var now = <? php echo date('D M d Y H:i:s O') ?> ;
    var distance = end - now;
    if(distance < 0) {
      clearInterval(timer);
      document.getElementById('countdown').innerHTML = 'EXPIRED!';
      return;
    }
    var days = Math.floor(distance / _day);
    var hours = Math.floor((distance % _day) / _hour);
    var minutes = Math.floor((distance % _hour) / _minute);
    var seconds = Math.floor((distance % _minute) / _second);
    document.getElementById('countdown').innerHTML = days + 'd ';
    document.getElementById('countdown').innerHTML += hours + ':';
    document.getElementById('countdown').innerHTML += minutes + ':';
    document.getElementById('countdown').innerHTML += seconds;
  }
  timer = setInterval(showRemaining, 1000);
</script> 
```

我尝试过这种方式但没有任何成功..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:05:32.033

您可以使用以下方法创建正确的日期：

```
var now = new Date(<?php echo time(); ?>); 
```

其他信息请看这里：[JS Date Object](http://www.w3schools.com/jsref/jsref_obj_date.asp)

# c# - 获取最后一个斜线后的内容

> ID：15857589
> 
> 赞同：49
> 
> 时间：2013-04-07T00:35:43.210
> 
> 标签：c#, string-parsing

我的字符串具有以下格式的目录：

```
C://hello//world 
```

我将如何提取最后一个`/`字符 ( `world`) 之后的所有内容？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2013-04-07T00:39:05.283

```
string path = "C://hello//world";
int pos = path.LastIndexOf("/") + 1;
Console.WriteLine(path.Substring(pos, path.Length - pos)); // prints "world" 
```

该`LastIndexOf`方法的执行与 .. 相同，`IndexOf`但从字符串的末尾开始。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2016-02-12T19:51:07.290

`using System.Linq;`

```
var s = "C://hello//world";
var last = s.Split('/').Last(); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-04-07T01:35:10.257

有一个用于处理路径的静态类，称为[`Path`](http://msdn.microsoft.com/en-us/library/system.io.path.aspx).

您可以使用[`Path.GetFileName`](http://msdn.microsoft.com/en-us/library/system.io.path.getfilename.aspx).

或者

您可以使用[`Path.GetFileNameWithoutExtension`](http://msdn.microsoft.com/en-us/library/system.io.path.getfilenamewithoutextension.aspx).

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-01-14T13:57:13.020

试试这个：

```
string worldWithPath = "C://hello//world";
string world = worldWithPath.Substring(worldWithPath.LastIndexOf("/") + 1); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-04-07T01:07:43.533

我建议您查看`System.IO`名称空间，因为您可能想要使用它。DirectoryInfo 和 FileInfo 也可能在这里有用。特别[是 DirectoryInfo 的 Name 属性](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.name.aspx)

```
var directoryName = new DirectoryInfo(path).Name; 
```

# c++ - 将指针数组传递给模板类方法

> ID：15857600
> 
> 赞同：1
> 
> 时间：2013-04-07T00:38:15.197
> 
> 标签：c++, arrays, templates, pointers

简而言之，我有一个模板类 Tree ，它有一个`createTree(Data* arrayData[])`方法。此方法接收指向 Data 类型数据的指针数组：

```
template<class Data>
void Tree<Data>::createTree(Data* arrayData[]) {
    m_indexCreation = 0;
    cout << sizeof(arrayData) / sizeof(int) << endl;
    m_root = createChildTree(arrayData);
} 
```

在我的`main()`函数中，我创建了一个指向字符串对象的指针数组并填充它。然后我尝试将它传递给`createTree()`方法，但在方法内部，数组的大小变为 1。换句话说，方法内部的计数打印“1”。这是我的`main()`：

```
int main() {
    string* tab[20];

    for ( int i = 0 ; i < 20 ; i++ ) {
        if ( i % 3 != 0 ) {
            tab[i] = new string("James Johnson");
        } else {
            tab[i] = NULL;
        }
    }

    Tree<string> tree;
    tree.createTree(tab);

    tree.display(tree.getRoot());
} 
```

我可以毫无问题地在 中打印整个数组的值`main()`，但是在 中`createTree()`，数组以某种方式减小到 1 的大小，单个值为 NULL。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:48:11.553

检查 C 常见问题

[http://c-faq.com/aryptr/aryparmsize.html](http://c-faq.com/aryptr/aryparmsize.html)

> 答：编译器假装数组参数被声明为一个指针（即在示例中为 char *a；参见问题 6.4），并且 sizeof 报告指针的大小。另见问题 1.24 和 7.28。

解决方法。将大小作为参数传递。

```
void Tree<Data>::createTree(Data* arrayData[], int sz)
{
    ...
}

Tree<string> tree;
tree.createTree(tab, sizeof(tab)/sizeof(tab[0])); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T00:50:59.423

当`tab`被发送到函数中时，它将进行数组到指针的转换：

来自 C++ 标准，4.2 [标准转换]

> “NT 数组”或“T 的未知边界数组”类型的左值或右值可以转换为“指向 T 的指针”类型的纯右值。结果是指向数组第一个元素的指针。

因此，您的初始签名将类似于以下内容：

```
Tree<Data>::createTree(Data** arrayData); 
```

如您所见`arrayData`，因为是双指针。使用`sizeof`时，它将返回*指针*的字节数，而不是实际数组的字节数。要解决此问题，您应该通过引用传递数组：

```
template <class Data, unsigned N>
createTree(Data* (&arrayData)[N]); // you can print out N for the size
//                                    but sizeof(x)/sizeof(*x) will still work 
```

或者您可以使用`std::vector`，因为它更容易获得大小：

```
#include <vector>

void Tree<Data>::createTree(std::vector<Data*> arrayData)
{
    std::cout << arrayData.size();
}

int main()
{
    std::vector<std::string> tab;

    for (int i = 0; i < 20; ++i) // shortened for this example
    {
        tab[i] = new std::string("James Johnson");
    }

    ...
} 
```

我认为这是一个更清洁的选择。我希望这会有所帮助。

# css - Twitter Bootstrap 图标栏颜色样式

> ID：15857603
> 
> 赞同：0
> 
> 时间：2013-04-07T00:38:43.500
> 
> 标签：css, firefox, twitter-bootstrap, android-browser

我有一个浅色 Twitter Bootstrap 菜单，但希望在手机和平​​板电脑中切换下拉菜单的按钮变暗。我添加了以下样式。它适用于 Firefox，但样式更改未显示在 Android 中。知道我需要做些什么来使其在大多数浏览器中正确显示吗？

```
<button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse" style="color: #000000; background-color: #121212; 
background-image: linear-gradient(to bottom, #0d0d0d, #1a1a1a);">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:16:25.713

CSS3 背景渐变的使用在浏览器之间是不同的。要确保所有浏览器都支持您的代码，您需要添加供应商前缀。此外，即使使用供应商前缀，不同浏览器的背景渐变代码也是不同的。

我会推荐[ColorZilla](http://www.colorzilla.com/gradient-editor/)，这是跨浏览器背景渐变的绝佳工具。有很多例子，你可以编辑颜色、渐变方向，甚至添加多个渐变。尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T05:44:41.877

自定义 Twitter Bootstrap 元素颜色的最简单方法是使用 LESS。您可以在官方页面自定义它们，下载并在 variables.less 文件中进行操作，或者尝试使用[Bootswatcher](http://bootswatcher.com)等在线工具。

这确保您不必使用所有供应商 CSS3 前缀。

# parsing - 如何格式化要求两个标记相等的语法规则？

> ID：15857604
> 
> 赞同：1
> 
> 时间：2013-04-07T00:38:51.240
> 
> 标签：parsing, yacc

如何编写匹配两个标记的 Yacc 语法？例如：

```
START some_random_id
stuff stuff stuff
END some_random_id 
```

我想要求 some_random_id 在两个地方都匹配以匹配整个块。所以它会是这样的：

```
block <- START ID block_body END ID 
```

附加要求两个 ID 相等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T00:56:21.563

只要`some_random_id`是从任意大小的集合中提取的，这仅与语法规则无关。有一个经典的数学证明。您只能使用检查`id`s 是否相同的解析器操作代码来执行此操作。但这并不是很难。将联合定义`yylval`为具有`id_string`由扫描仪填写的字段。然后你会有类似的东西：

```
%union {
  char *id_string;
  ...
} 
%token <id_string> ID KW_START KW_END 
%%
...
block : KW_START ID stuff KW_END ID  { 
    if (strcmp($2.id_string, $5.id_string) != 0) YYERROR; } 
```

# java - 从使用 JavaScript 即时生成文本的网页中解析 Java 文本

> ID：15857610
> 
> 赞同：0
> 
> 时间：2013-04-07T00:39:20.470
> 
> 标签：java, javascript, parsing, url

我喜欢玩万智牌，而且我还有一个收藏数据库。万智牌系列信息很容易获得，因为我可以直接从打开的 HTML URL 流中解析它，但我现在正尝试从 Star City Games（MTG 供应商）获得卡片的价格。但是，当我查看源代码时，HTML 中没有价格；这一切都是通过 JavaScript 即时完成的。这是一个示例页面供参考：[http ://sales.starcitygames.com/search.php?substring=Snapcaster+Mage&t_all=All&start_date=2010-01-29&end_date=2012-04-22&order_1=finish&limit=25&action=Show%2BDecks&card_qty%5B1 %5D=1&自动=Y](http://sales.starcitygames.com/search.php?substring=Snapcaster+Mage&t_all=All&start_date=2010-01-29&end_date=2012-04-22&order_1=finish&limit=25&action=Show%2BDecks&card_qty%5B1%5D=1&auto=Y)

该网页生成以下 HTML： http: [//pastebin.com/Psrpri8r](http://pastebin.com/Psrpri8r)。我只想能够阅读文本“24.99”。我使用的所有代码都是Java。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:04:40.673

您需要运行 javascript... 尝试[selenium](http://docs.seleniumhq.org/)。

如果您不想学习他，我有一个 Hacky 解决方案（警告：非常复杂）：将页面下载到您的计算机（同时下载所有 .JS 页面），编辑将相关数据发送到您的服务器的 JS 代码。显示它，并[在浏览器中打开此页面](https://stackoverflow.com/questions/602032/getting-java-gui-to-open-a-webpage-in-web-browser)。

# android - 使用 listview setadapter 获取空指针异常

> ID：15857613
> 
> 赞同：0
> 
> 时间：2013-04-07T00:39:33.883
> 
> 标签：android

我搜索了其他主题并得出结论，我的列表视图是空指针异常的原因，但我无论如何都无法修复它。

这是我的 XML 文件

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<ListView
    android:id="@+id/instantme_check_list"
    android:layout_width="wrap_content"
    android:layout_height="match_parent"
    android:layout_weight="2.88" >
</ListView> 
```

省略其余部分以减少混乱，我的代码是

```
public class instantme_check extends Activity {
  InputStream is = null;
  TextView name;
  TextView content;
  EditText entername;
  EditText entercontent;
  private ListView list;
      ...

  name = (TextView) findViewById(R.id.instantme_check_name);
  content = (TextView) findViewById(R.id.instantme_check_message);
  entername = (EditText) findViewById(R.id.instantme_check_entername);
  entercontent = (EditText) findViewById(R.id.instantme_check_entermessage);
  list = (ListView) findViewById(R.id.instantme_check_list);
      ...

  listAdapter4 = new displayadapter4();
  list.setAdapter(listAdapter4); 
```

至于显示适配器类（我已经在代码的其他两个部分中使用了它并且它有效，所以我认为它很好）

```
 public class displayadapter4 extends ArrayAdapter<String> {
    displayadapter4()
    {
        super(instantme_check.this, R.layout.row, R.id.label, course);
    }       
    @Override
    public View getView(int position, View convertView, ViewGroup parent)
    {
        View row = super.getView(position, convertView, parent);
        TextView size1 = (TextView) row.findViewById(R.id.size);
        size1.setText("Subject: " + subject[position]);
        TextView size2 = (TextView) row.findViewById(R.id.size2);
        size2.setText("Message: " + message[position]);
        TextView size3 = (TextView) row.findViewById(R.id.size3);
        size3.setText("From: " + user[position]);

        return(row);        
    }

} 
```

它不断给出空指针异常，尽管我确信我放入 arrayadapter 的数据很好，因为我使用 Log.i 来验证它。

至于我的错误日志

```
 04-07 00:33:10.714: W/dalvikvm(273): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
04-07 00:33:10.734: E/AndroidRuntime(273): FATAL EXCEPTION: main
04-07 00:33:10.734: E/AndroidRuntime(273): java.lang.NullPointerException
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:355)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.widget.ArrayAdapter.getView(ArrayAdapter.java:323)
04-07 00:33:10.734: E/AndroidRuntime(273):  at com.Assist.assistme.instantme_check$displayadapter4.getView(instantme_check.java:172)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.widget.AbsListView.obtainView(AbsListView.java:1315)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.widget.ListView.makeAndAddView(ListView.java:1727)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.widget.ListView.fillDown(ListView.java:652)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.widget.ListView.fillFromTop(ListView.java:709)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.widget.ListView.layoutChildren(ListView.java:1580)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.widget.AbsListView.onLayout(AbsListView.java:1147)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.view.View.layout(View.java:7035)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1249)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1125)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.widget.LinearLayout.onLayout(LinearLayout.java:1042)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.view.View.layout(View.java:7035)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.widget.FrameLayout.onLayout(FrameLayout.java:333)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.view.View.layout(View.java:7035)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1249)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1125)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.widget.LinearLayout.onLayout(LinearLayout.java:1042)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.view.View.layout(View.java:7035)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.widget.FrameLayout.onLayout(FrameLayout.java:333)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.view.View.layout(View.java:7035)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.view.ViewRoot.performTraversals(ViewRoot.java:1045)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.view.ViewRoot.handleMessage(ViewRoot.java:1727)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.os.Looper.loop(Looper.java:123)
04-07 00:33:10.734: E/AndroidRuntime(273):  at android.app.ActivityThread.main(ActivityThread.java:4627)
04-07 00:33:10.734: E/AndroidRuntime(273):  at java.lang.reflect.Method.invokeNative(Native Method)
04-07 00:33:10.734: E/AndroidRuntime(273):  at java.lang.reflect.Method.invoke(Method.java:521)
04-07 00:33:10.734: E/AndroidRuntime(273):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-07 00:33:10.734: E/AndroidRuntime(273):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-07 00:33:10.734: E/AndroidRuntime(273):  at dalvik.system.NativeStart.main(Native Method)
04-07 00:33:12.884: D/dalvikvm(289): GC_EXTERNAL_ALLOC freed 806 objects / 57952 bytes in 66ms 
```

很抱歉这篇文章真的很长。提前致谢。

编辑：row.xml

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" 
    >

    <TextView
        android:id="@+id/label"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Large Text"
        android:textSize="20sp"
        android:textAppearance="?android:attr/textAppearanceLarge" />

    <TextView
        android:id="@+id/size"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text=""
        android:textSize="10sp"
        android:textAppearance="?android:attr/textAppearanceLarge" />

     <TextView
        android:id="@+id/size2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text=" "
        android:textSize="10sp"
        android:textAppearance="?android:attr/textAppearanceLarge" />
       <TextView
        android:id="@+id/size3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text=""
        android:textSize="10sp"
        android:textAppearance="?android:attr/textAppearanceLarge" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:59:57.957

根据您的 LogCat：

```
java.lang.NullPointerException
    at android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:355) 
```

问题是您传递给 ArrayAdapter 的超级构造函数的 View id，这里：

```
super(instantme_check.this, R.layout.row, R.id.label, course); 
```

在您的布局中不存在，您可以通读[源代码](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.3.7_r1/android/widget/ArrayAdapter.java#ArrayAdapter.createViewFromResource%28int%2Candroid.view.View%2Candroid.view.ViewGroup%2Cint%29)以确切了解导致 NullPointerException 的方式和原因。

解决方案很简单：使用不同的 id 或将此 TextView 添加到您的布局中。

# c - MPI 中的问题 -> 地址失败：（无）

> ID：15857614
> 
> 赞同：1
> 
> 时间：2013-04-07T00:40:17.227
> 
> 标签：c, matrix, mpi, null, openmpi

我是 C 和 MPI 的初学者，我正在尝试做一个程序来将 MPI 中的 2 个矩阵相乘。但我不知道我的代码有什么问题。我尝试在 n 行中对矩阵 M1 进行“切片”，然后将其发送到另一个进程，在我进行 Gather 以构建最终矩阵 M3 之后进行乘法和广播矩阵 M2。我做这个：

```
mpirun -n 2 matrix 
```

但我在终端收到错误：

```
[adiel-VirtualBox:07921] *** Process received signal ***
[adiel-VirtualBox:07921] Signal: Segmentation fault (11)
[adiel-VirtualBox:07921] Signal code:  (128)
[adiel-VirtualBox:07921] Failing at address: (nil)
--------------------------------------------------------------------------
mpirun noticed that process rank 0 with PID 7921 on node adiel-VirtualBox exited on signal 0 (Unknown signal 0).
--------------------------------------------------------------------------
2 total processes killed (some possibly by mpirun during cleanup)
mpirun: clean termination accomplished 
```

谁能帮我？

这是我的代码：

```
#include <stdio.h>
#include <stdlib.h>
#include "mpi.h"
//#include "mpe.h"
#include <math.h>

void printMatrix(double *M, int m, int n) {
   int lin, col;
   for (lin=0; lin<m; lin++) {
      for (col=0; col<n; col++)
        printf("%.2f \t", M[(lin*n+col)]);
      printf("\n"); 
   }
}

double* allocateMatrix(int m, int n){
    double* M;
    M = (double *)malloc(m*n*sizeof(double));
    return M;
}

int main( int argc, char *argv[] )
{

    int rank, size;
    int m1,n1,m2,n2;
    int row, col,ctrl,i,k,lines,proc;
    double *M1, *M2, *M3, **vp, *v;

    MPI_Init( &argc, &argv );
    MPI_Comm_rank( MPI_COMM_WORLD, &rank );
    MPI_Comm_size( MPI_COMM_WORLD, &size );

    m1 = m2 = n1 = n2 = 3;

    lines = (int)ceil(n1/size);
    v = (double *)malloc(lines*n1*sizeof(double));

    M2 = allocateMatrix(m2,n2);
    M3 = allocateMatrix(m1,n2);
if(rank==0)
    M1 = allocateMatrix(m1,n1);

    //startin matrix
    for (col = 0; col < n1; col++){
        for (row = 0; row < m1; row++) {
            if(rank==0)
            M1[(row*m1+col)] = 0;
            M2[(row*m2+col)] = 0;
            M3[(row*m1+col)] = 0;
        }
    }
//startin pointers with 0
for(i=0;i<lines*n1;i++)
v[i] = 0;

    //populate
    if(rank == 0){
        for (col = 0; col < n1; col++){
            for (row = 0; row < m1; row++) {
                M1[row*m1+col] = row*3+(col+1);
                M2[(row*m2+col)] = 1;
            }
        }
    }

//---------------------sharing and multiply---------------//

    //slicing M1 and sending to other process
    if(rank == 0){
        proc = size-1;
        //for each line
        for(row = 0;row<m1;row++){
        ctrl = floor(row/lines);            
            //on each column
            for(col=0;col<n1;col++){
                v[(ctrl*n1)+col] = M1[(row*n1)+col];
            }
            if(row%lines == (lines - 1)){
                if(proc!=0){
                    MPI_Send(v,lines*n1,MPI_DOUBLE,proc,1, MPI_COMM_WORLD);
                    proc--;
                    //clearing pointers
                    for(i=0;i<lines*n1;i++)
                        v[i] = 0;
                }
            }
        }
    }

    //MPI_Bcast(m1, m*n, MPI_DOUBLE, 0, MPI_COMM_WORLD); 
    MPI_Bcast(M2, m2*n2, MPI_DOUBLE, 0, MPI_COMM_WORLD); 

    //receiving process
    if(rank!=0)
        MPI_Recv(v,lines*n1,MPI_DOUBLE,0,1,MPI_COMM_WORLD, MPI_STATUS_IGNORE);

            for(row=0;row<lines;row++){
                if(v[row*n1]!=0){
                    for (col = 0; col < n1; col++){
                    double val = 0.0;
                        for(k=0;k<m1;k++){
                            val += v[(row*n1)+k] * M2[(k*n1)+col];
                        }
                        M3[((size-1-rank)*size*n1)+(row*n1)+col] = val;
                    }
                }
            }

    if(rank!=0){    
        for(row = 0; row < lines; row++){
            MPI_Gather(&M3[((size-1-rank)*size*n1)+(row*n1)], n1, MPI_DOUBLE, &M3[((size-1-rank)*size*n1)+(row*n1)], n1, MPI_DOUBLE, 0, MPI_COMM_WORLD); 
        }   
    }

if(rank == 0){  
printf("matrix 1------------------------\n");
printMatrix(M1,m1,n1); 
printf("matrix 2------------------------\n");
printMatrix(M2,m2,n2);
printf("matrix 3------------------------\n");
printMatrix(M3,m1,n2);
}
  MPI_Finalize();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T03:12:25.280

一方面，在广播之前进行所有发送，在广播之后进行所有接收都是自找麻烦。我可以很容易地看到导致 MPI 资源耗尽或死锁失败。在如此小的输入中不应该出现，但无论如何你都应该修复它。之后我会再看一遍。

# mysql - 在使用外键时按层次结构排序的 mySQL 查询

> ID：15857616
> 
> 赞同：0
> 
> 时间：2013-04-07T00:41:24.123
> 
> 标签：mysql, sorting, select, hierarchy

这是我的桌子：

```
course
------
courseId
department
number
section
title 
```

我想做一个查询，它将对它们进行分层排序。按此顺序：

1.  部
2.  数字
3.  部分

所以当我调用这个查询时......

```
SELECT * from `course` SORT BY ??? 
```

如何按多列排序？我用什么代替`???`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:44:18.943

只需按顺序列出它们，用逗号分隔。此外，关键字是`ORDER BY`，而不是`SORT BY`：

```
ORDER BY Department, Number, Section 
```

# java - 更新 JFrame 内容

> ID：15857624
> 
> 赞同：1
> 
> 时间：2013-04-07T00:44:01.977
> 
> 标签：java, swing, jframe, panel, imageicon

如何在单击按钮时更新 JFrame 的内容。我正在构建一个图像查看器，其中将传入一个 photopath 列表，用户必须单击下一个或上一个按钮来回查看图像。如何更改图像并更新 Jframe 下面是我当前的实现。我试图处置当前框架并制作一个新框架，但这不是我要寻找的... package cs213.photoAlbum.simpleview;

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Container;
import java.awt.Dimension;
import java.awt.Image;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.util.*;

import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JSlider;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

import model.photoNode;

public class ImageViewer {

    private JFrame frame = new JFrame("Image Viewer");
    private Container pane = frame.getContentPane();
    private JPanel imgViewPanel = new JPanel();
    JSlider slider = new JSlider(0, 100, 100);
    JLabel percent = new JLabel("100%");

    String imageFile = "";

    private class ImageView extends JScrollPane {

        JPanel panel = new JPanel();
        Dimension originalSize = new Dimension();
        Image originalImage;
        JLabel iconLabel;

        public ImageView(ImageIcon icon) {

            this.originalImage = icon.getImage();

            panel.setLayout(new BorderLayout());
            iconLabel = new JLabel(icon);
            panel.add(iconLabel);

            setViewportView(panel);

            originalSize.width = icon.getIconWidth();
            originalSize.height = icon.getIconHeight();
        }

        public void update() {

            int min = slider.getMinimum();
            int max = slider.getMaximum();
            int span = max - min;
            int value = slider.getValue();
            double multiplier = (double) value / span;
            multiplier = multiplier == 0.0 ? 0.01 : multiplier;
            Image scaled = originalImage.getScaledInstance((int) (originalSize.width * multiplier), (int) (originalSize.height * multiplier), Image.SCALE_FAST);
            iconLabel.setIcon(new ImageIcon(scaled));
        }
    }

    ImageView imageView;

    public ImageViewer(String imgFile, final ArrayList<photoNode> list) {

        frame.addWindowListener(new WindowAdapter() {

            public void windowClosing(WindowEvent e) {

                frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
            }
        });

        createAndShowGUI();

        imageFile = imgFile;

        ImageIcon icon = new ImageIcon(imageFile);
        imageView = new ImageView(icon);

        JPanel panel = new JPanel();
        panel.add(new JLabel("Set Image Size: "));
        panel.add(slider);
        panel.add(percent);

        pane.add(panel, BorderLayout.NORTH);
        imgViewPanel.add(imageView);
        pane.add(imgViewPanel, BorderLayout.CENTER);

        slider.addChangeListener(new ChangeListener() {

            public void stateChanged(ChangeEvent e) {
                if (!slider.getValueIsAdjusting()) {
                    percent.setText(slider.getValue() + "%");
                    imageView.update();
                }
            }
        });

        JButton next = new JButton("Next");
        JButton prev = new JButton("Prev");
        pane.add(next, BorderLayout.EAST);
        pane.add(prev, BorderLayout.WEST);

        next.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent e) {
                // TODO Auto-generated method stub

                imgViewPanel.remove(imageView);

                if (list.size() > 0) {

                    for (int i = 0; i < list.size(); i++) {

                        if (list.get(i).fileName.equalsIgnoreCase(imageFile)) {                         

                            if (i + 1 < list.size()) {

                                //frame.dispose();

                                ImageIcon icon = new ImageIcon(list.get(i + 1).fileName);
                                ImageView imageView = new ImageView(icon);

                                imgViewPanel.add(imageView);
                                pane.add(imgViewPanel, BorderLayout.CENTER);

                                imgViewPanel.revalidate();

                                break;

                            }           

                        }                       
                    }                   
                }   

            }

        });

    }

    private void createAndShowGUI() { // Creating the GUI...

        frame.getContentPane().setBackground(Color.WHITE);

        frame.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
        frame.setTitle("PhotoAlbum55");

        frame.pack();
        frame.setSize(400, 300);
        frame.setLocationRelativeTo(null);
        frame.setResizable(true);
        frame.setVisible(true);

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T00:51:30.253

交换图像的最简单方法是将它们显示为 JLabel 中的 ImageIcon，然后简单地调用`setIcon(...)`JLabel 并传入另一个 ImageIcon。如果图像足够小，您可以创建一组图标，也许是一个`List<Icon>`，然后在按下下一个或上一个按钮时在列表中向后或向前移动。

# c++ - 为什么在这种情况下 g++ 和 clang 会破坏命名空间抽象？

> ID：15857625
> 
> 赞同：4
> 
> 时间：2013-04-07T00:44:15.190
> 
> 标签：c++, namespaces, g++, overloading, clang

这编译：

```
struct str {};

namespace a
{
    void foo(str s) {}
}
namespace b
{
    void foo(str s) {}

    void bar(str s) { foo(s); }
}
int main(int, char**)
{
    return 0;
} 
```

但这不是（结构定义移动到命名空间a内）

```
namespace a
{
    struct str {};

    void foo(str s) {}
}
namespace b
{
    void foo(a::str s) {}

    void bar(a::str s) { foo(s); }
}
int main(int, char**)
{
    return 0;
} 
```

我得到的错误是

```
bad.cpp: In function ‘void b::bar(a::str)’:
bad.cpp:12: error: call of overloaded ‘foo(a::str&)’ is ambiguous
bad.cpp:10: note: candidates are: void b::foo(a::str)
bad.cpp:5: note:                 void a::foo(a::str) 
```

可以合理地预期，因为 a::foo 不在范围内，所以对 foo 的调用只能引用 b::foo。编译失败是否有充分的理由（如果是，那是什么），还是（两个主要编译器的）实现中的缺陷？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-07T00:50:17.760

这是因为名称查找的方式，特别是[**Argument-Dependent Lookup (ADL)**](https://en.wikipedia.org/wiki/Argument-dependent_name_lookup)的工作方式。在决定哪些函数可能是解决您的调用的候选者时，编译器将首先在以下位置查找名称：

1.  函数调用发生的命名空间；
2.  定义参数类型的命名空间。

如果在这些命名空间中没有找到具有该名称的函数，编译器将继续检查进行调用的命名空间的父命名空间。

* * *

那么您问题的示例中发生了什么？

在第一种情况下，是在*全局*`str`命名空间中定义的，并且在那里没有调用函数。但是，在调用发生的命名空间中有一个（）：因此编译器找到了一个有效的名称，名称查找停止，重载解析开始。*`foo()``b`*

 *但是，只有一个候选函数！所以这里的任务很简单：编译器调用`b::foo()`.

另一方面，在第二种情况下，在命名空间`str`中定义`a`，并且在调用时`foo(s)`，编译器将再次查看进行调用的命名空间（ ）和定义`b`参数类型（）的命名空间-`str`这一次，`a`.

所以现在有*两个*名称匹配的函数来解析调用：输入重载解析！唉，这两个功能都一样好（完全匹配，不需要转换）。因此，调用是模棱两可的。*

# azure - 无法从 CloudBlockBlob 向上转换到 CloudBlob

> ID：15857630
> 
> 赞同：3
> 
> 时间：2013-04-07T00:44:25.837
> 
> 标签：azure, f#, azure-storage

我必须在这里遗漏一些明显的东西，但我发现自己无法进行我认为合法的向上转换。我正在尝试将数据上传到 Azure 中的 Blob 存储，并希望使用[CloudBlob.UploadText(string)](http://msdn.microsoft.com/en-us/library/windowsazure/ee772818.aspx)方法。但是，当我访问我的 blob 时，我得到了一个[CloudBlockBlob](http://msdn.microsoft.com/en-us/library/windowsazure/ee758638.aspx)实例，据我所知，它继承自 CloudBlob，并且方法 UploadText 不可访问，所以我尝试`let blob = targetBlob :> CloudBlob`了 - 惨遭失败，并显示消息

```
SmallScript.fsx(28,12): error FS0193: Type constraint mismatch. The type 
    CloudBlockBlob    
is not compatible with type
    CloudBlob    
The type 'CloudBlockBlob' is not compatible with the type 'CloudBlob' 
```

我可以使用 UploadFromStream 上传数据，但 UploadText 对我的目的来说非常方便。谁能帮我看看我错过了什么？

作为记录，如果这有帮助，这里是有效的代码：

```
let credentials = StorageCredentials(accountName, accountKey)
let storageAccount = CloudStorageAccount(credentials, true)
let client = storageAccount.CreateCloudBlobClient()

let containerName = "numerics"
let container = client.GetContainerReference(containerName)
container.CreateIfNotExists() |> ignore

let targetBlobName = "MiniSparseMatrix.csv"
let targetBlob = container.GetBlockBlobReference(targetBlobName)

let fileLocation = @"C:\Users\Mathias\Desktop\TestMatrix.txt"
let stream = System.IO.File.OpenRead(fileLocation)
targetBlob.UploadFromStream(stream)
stream.Close() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-02T13:37:57.027

您是否可能引用多个版本的库？我的猜测是，`CloudBlockBlob`您获得的程序集（版本）与您的代码引用的具有该`CloudBlob`类型的程序集不同。

如果您可以注释掉无法编译的代码并附加调试器，您应该能够通过检查 QuickWatch 窗口中的类型并查看其类型（查看`.GetType().Assembly`并将其与 比较`typeof(CloudBlob).Assembly`）来确认这一点。

# c# - RegisterChannel 错误：“是一种方法，但用作 C# 中的类型”

> ID：15857632
> 
> 赞同：0
> 
> 时间：2013-04-07T00:44:48.510
> 
> 标签：c#, winforms, visual-studio-2010, c#-4.0, c#-3.0

我在 C# 中遇到问题。我正在尝试为迷你市场制作一个项目，我想将它与服务器绑定。

在我们的课程中，我们做了一个小项目，我们创建了一个客户端、一个服务器和一个类作为参考。这些是 C# 中的控制台应用程序。它奏效了。

我现在想在 Windows 窗体应用程序中制作客户端，但问题是我想注册频道时！它向我显示了一个错误。

这是打印屏幕图像：

![在此处输入图像描述](https://i.stack.imgur.com/C2R4l.png)

错误是这样的：

> “System.Runtime.Remoting.Channels.ChannelServices.RegisterChannel(System.Remting.Channels.IChannel)) 是一种‘方法’，但它像‘类型’一样使用

我已经为 Channel 添加了命名空间。我尝试更改 .Net Framework（我尝试了 4.0 Client、4.0、3.5、3.0），但没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T00:52:58.197

花了我一秒钟才看到这一点，但问题是您在方法块之外进行调用。

如果您希望在构造时发生这种情况，那么您需要将代码移动到`Form1()`代码中

```
public Form1()
{
    InitializeComponent();
    HttpChannel chan = new HttpChannel();
    ChannelServices.RegisterChannel(chan);
    //Shitja code
} 
```

如果您`chan`稍后需要该变量，那么您可以这样做：

```
HttpChannel chan;
public Form1()
{
    ...
    chan = new HttpChannel();
    ...
} 
```

此外，自 2.0 以来，[MSDN 已将此方法标记为已过时，以支持具有 2 个参数的重载](http://msdn.microsoft.com/en-us/library/ms223155%28v=vs.110%29.aspx)

# ruby-on-rails - has_many、belong_to 和两者之间的区别

> ID：15857633
> 
> 赞同：1
> 
> 时间：2013-04-07T00:44:52.033
> 
> 标签：ruby-on-rails, database

以下三种情况有什么区别？

```
#Case 1
class User < ActiveRecord::Base
  has_many :comment
end 

class Comment < ActiveRecord::Base
  belong_to :user
end 
```

案例 1 同时具有 has_many 和 belongs_to。

```
#Case 2
class User < ActiveRecord::Base
  has_many :comment
end 

class Comment < ActiveRecord::Base
end 
```

案例 2 只有 has_many。

```
#Case 3
class User < ActiveRecord::Base
end 

class Comment < ActiveRecord::Base
  belong_to :user
end 
```

案例 3 只有belong_to。

既然 has_many 和 belongs_to 都代表一对多的关系，那么我们如何决定应该使用这三个中的哪一个呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T00:49:10.963

它们需要相同的数据库模式。区别仅在于为您定义了哪些方法。

当您添加`has_many :comments`到 时`User`，您可以获得引用 的能力`user.comments`，因此很容易找到特定用户对象的评论（并使用 来创建新的评论`user.comments.build`，等等）。

添加`belongs_to :user`到 时`Comment`，您可以引用`comment.user`，从而找到特定评论对象所属的用户。

这些调用只是创建方便的方法供您在操作模型对象时使用。我建议同时使用两者，因为您可能想要同时使用两者，并且阅读代码的人更清楚这种关系。

# css - 将 CSS 类样式约束为仅应用于给定的 id

> ID：15857635
> 
> 赞同：2
> 
> 时间：2013-04-07T00:45:05.300
> 
> 标签：css, twitter-bootstrap, css-selectors

我正在尝试在同一页面上使用两个 Twitter Bootstrap 导航。我写了一些 CSS 来设置它们的样式。问题是，我希望 css 仅适用于其中一个导航。我尝试使用 css id 来区分两个导航，但无法正确选择选择器。任何人都可以帮忙吗？

这是我正在尝试做的简化版本：http: [//jsfiddle.net/XVReX/](http://jsfiddle.net/XVReX/)

HTML：

```
<div id="something" class="navbar">
    <div class="navbar-inner">
        <div class="container">
            <ul class="nav">
                <li id="selectEventStep"><a>Select Event</a>

                </li>
                <li id="selectPriceStep"><a>Select Price</a>

                </li>
                <li id="confirmSwapStep"><a>Confirm Swap</a>

                </li>
            </ul>
        </div>
    </div>
</div>
<div class="navbar">
    <div class="navbar-inner">
        <div class="container">
            <ul class="nav">
                <li id="selectEventStep"><a>Select Event</a>

                </li>
                <li id="selectPriceStep"><a>Select Price</a>

                </li>
                <li id="confirmSwapStep"><a>Confirm Swap</a>

                </li>
            </ul>
        </div>
    </div>
</div> 
```

CSS：

```
#something.navbar #something.navbar-inner {
    padding: 0;
    background-image: -webkit-linear-gradient(top, #E5665D, #C4564F);
}
#something.navbar #something.nav li a {
    font-weight: bold;
    text-align: center;
    color: #FFE2E0;
    text-shadow: 0 1px 0 #000;
    ;
}
#something.navbar #something.nav li a:hover {
    color: #fff;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:57:14.843

选择器比必要的更复杂，并且语法不正确 - 您可以使用以下命令覆盖 bootstrap.css：

`#something .navbar-inner { }`

`#something .nav li a{ }`

`#something .nav li a:hover { }`

[jsFiddle](http://jsfiddle.net/XVReX/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-08T09:52:34.490

我重写了整个样式表，使用 sass 编译器和正则表达式仅将样式应用于具有类名 .bootstrap 的那些元素，如下所示

```
 audio.bootstrap:not([controls]) {
  display: none;
}
 html.bootstrap {
  font-size: 100%;
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
}
 a.bootstrap:focus {
  outline: thin dotted #333;
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
} 
```

我还没有检查一切，但我认为它工作正常。

**[http://jsfiddle.net/Lc5h6/](http://jsfiddle.net/Lc5h6/)**

# actionscript-3 - Actionscript 3 读取响应内容类型

> ID：15857638
> 
> 赞同：1
> 
> 时间：2013-04-07T00:45:34.823
> 
> 标签：actionscript-3, flash, http, bulkloader, urlloader

是否可以使用 Actionscript 3 中的 URLLoader 类读取 Web 服务器响应的原始内容类型？我们通过 http 接收自我描述消息：

```
HTTP/1.1 200 OK 
Cache-Control: max-age=0, private, must-revalidate
Content-Type: application/x-protobuf; desc="http://domain.herokuapp.com/pb_message.desc"; messageType="SomeApp.YourCustomClass"; delimited=true; charset=utf-8
Date: Sat, 06 Apr 2013 23:16:07 GMT
Etag: "d27199cd1500953f6f4512c76bc58f28"
Server: WEBrick/1.3.1 (Ruby/1.9.2/2011-07-09)
X-Rack-Cache: miss
X-Request-Id: 57e83c24a04a03959eeed4ca0d3ab961
X-Runtime: 0.044153
Content-Length: 13
Connection: keep-alive 
```

上面的示例将对象显示为 protobuf 的类型，desc 属性是对象描述的 url，messageType 是具有相应对象类的应用程序名称。

我希望能够阅读 messageType 参数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T01:30:43.157

您可以通过侦听 URLLoader 上的 HTTPStatusEvent 来检索响应信息：

```
myLoader.addEventListener(HTTPStatusEvent.HTTP_RESPONSE_STATUS, httpHandler);

function httpHandler(event:HTTPStatusEvent):void
{
    for each (var object:Object in event.responseHeaders)
    {
    trace(object.name+" : "+object.value);
    }
} 
```

信息在 event.responseHeaders 中存储为具有名称和值属性的对象数组

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T21:16:04.750

@Lee Burrows 是正确的。但是，这些似乎仅适用于 Air 应用程序。请参阅：[无法在 actionscript 3 中获取 HTTP 响应代码/标头？](https://stackoverflow.com/questions/2277650/unable-to-get-http-response-code-headers-in-actionscript-3)

能够为闪存运行时找到解决方案将是很棒的

# iphone - 从 UIViewController 访问 UIView

> ID：15857640
> 
> 赞同：0
> 
> 时间：2013-04-07T00:46:15.150
> 
> 标签：iphone, ios, objective-c

我已经使用故事板将 UIView 添加到 UIViewController （参见下图）

问题是我无法从 UIView 访问任何内容。我相信这个问题是因为当我初始化 UIView 使用的类时，我正在创建一个新的 VASettingsView 实例，而不是使用已经使用情节提要添加到 UIView 框架的实例：

![白色背景是一个视图控制器（VARendererViewController），蓝色背景是一个UIView（VASettingsView）](https://i.stack.imgur.com/pbGxl.png)

VARendererViewController.m

```
-(void)viewDidLoad{
...
    // Initalise settings subview
    self.settingsInit = [[VASettingsView alloc] init];
    self.settingsInit.delegate = self;
....
}

-(void)update{
        int test = [[self settingsInit] getTest];
        NSLog(@"%d", test);
} 
```

返回 0，应返回 '12345'

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:51:12.047

您是正确的，您不需要`VASettingsView`在`-viewDidLoad`. 被`settingsInit`声明为`IBOutlet`? 您应该能够从`VASettingsView`Interface Builder 中连接到视图控制器中的插座。

`-viewDidLoad`是加载 nib 后调用的方法；届时，您笔尖中连接的所有内容`IBOutlets`都将可供您使用。没有必要创建和设置这些属性。

# java - 为什么我的 java 动画不起作用？

> ID：15857642
> 
> 赞同：0
> 
> 时间：2013-04-07T00:46:33.350
> 
> 标签：java, swing, animation, graphics, colors

当我想让雨滴顺着屏幕向下移动直到它们落到底部然后再做一次时，一切都静止了。我使用了可运行的实现，并有一个重新绘制它的运行方法。有人知道我错过了什么吗？

```
import javax.swing.*;
import java.awt.*;
import java.util.*;

public class Screensaver extends JPanel implements Runnable{
    private final static int FRAME_HEIGHT = 600;
    private final static int FRAME_WIDTH = 600;
    int rainY = 100;
    int rainGo = 1;
    public static void main(String[] args) {
        JFrame frame = new JFrame();
        frame.setSize(FRAME_WIDTH,FRAME_HEIGHT);
        frame.add(new Screensaver());
        frame.setVisible(true);

    }
    public Screensaver(){
        Color background;
        background = new Color(212,202,115);
        setBackground(background);
    }
     protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Color tree;
            Color leaves;
            Color cloud;
            Color rain;
            rain = new Color(0,128,255);
            cloud = new Color(160,160,160);
            leaves = new Color(0,204,0);
            tree = new Color(102,0,0);

            g.setColor(tree);
            //g.drawLine(400, 375, 360, 340);
            g.fillRect(400, 250,80, 320 );
            g.setColor(leaves);
            g.fillOval(340,150 , 200, 160);
            g.setColor(cloud);
            g.fillOval(10,5,550,100);

            Random random = new Random();
            int rainX1 = random.nextInt(500) + 40;
            int rainW1 = random.nextInt(30) + 10;
            int rainX2 = random.nextInt(500) + 40;
            int rainW2 = random.nextInt(30) + 10;
            int rainX3 = random.nextInt(500) + 40;
            int rainW3 = random.nextInt(30) + 10;
            int rainX4 = random.nextInt(500) + 40;
            int rainW4 = random.nextInt(30) + 10;

            g.setColor(rain);
            g.fillOval(rainX1, rainY + rainGo, rainW1, rainW1);
            g.fillOval(rainX2, rainY+ rainGo, rainW2, rainW2);
            g.fillOval(rainX3, rainY+ rainGo, rainW3, rainW3);
            g.fillOval(rainX4, rainY+ rainGo, rainW4, rainW4);

        }
     public void run(){
         while(true){
             changeRain();
             repaint();
         }
     }
     public void changeRain(){
         if(rainY+rainGo< FRAME_HEIGHT){
             rainGo++;
         }
         else{
             rainGo = 1;
         }
     }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T00:54:09.690

简短的回答：你没有开`Thread`​​始你的动画。

完整答案：使用 Swings 并发机制之一，例如用于动画的 Swing Timer。Swing 计时器旨在与 Swing 组件正确交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T00:54:10.103

我在您的代码中没有看到您创建后台线程并启动它的任何地方。线程不只是自己开始。如果您确实走这条路，请考虑`Thread.sleep(...)`在您的 run 方法中添加一个，以使 while 循环稍微暂停一下。最好为您的动画使用 Swing Timer。

# c++ - 从 C++ 中的抽象基类访问派生类的信息

> ID：15857646
> 
> 赞同：2
> 
> 时间：2013-04-07T00:46:50.813
> 
> 标签：c++, inheritance

所以我试图将一些实现接口*的类中的一些通用代码移到抽象基类中。但是，抽象基类需要了解一些派生类想要如何做事的信息，以便准确地确定要做什么。但是，我不完全确定是否应该使用纯虚函数或受保护的成员变量来实现它。

我将举一个简单的例子来描述我正在尝试做的事情。

界面：

```
class SomeInterface
{
public:
    void DoSomething() = 0;
    // ...
}; 
```

我试图使用纯虚函数实现的抽象基类：

```
class AbstractBase : public SomeInterface
{
public:
    virtual void DoSomething()
    {
        for (int i = 0; i < GetNumIterations(); i++)
        {
            // Call implementation in derived classes, for example
            DoSomethingImpl();
        }
    }

protected:
    virtual void DoSomethingImpl() = 0;
    virtual int GetNumIterations() = 0;

}; 
```

派生类：

```
class Derived1 : public AbstractBase
{
protected:
    virtual void DoSomethingImpl()
    {
        // Do actual work.
    }

    virtual int GetNumIterations()
    {
        return 5;
    }
}; 
```

另一个派生类：

```
class Derived2 : public AbstractBase
{
protected:
    virtual void DoSomethingImpl()
    {
        // Do actual work.
    }

    virtual int GetNumIterations()
    {
        return 1;
    }
}; 
```

或者另一种方法是使用受保护的变量：

```
class AbstractBase
{
public:
    virtual void DoSomething()
    {
        for (int i = 0; i < numIterations; i++)
        {
            // Call implementation in derived classes, for example
            DoSomethingImpl();
        }
    }

protected:
    virtual void DoSomethingImpl() = 0;

    int numIterations;

}; 
```

派生的将是：

```
class Derived1 : public AbstractBase
{
public:
    Derived1()
        : numIterations(5)
    {
    }

protected:
    virtual void DoSomethingImpl()
    {
        // Do actual work.
    }
}; 
```

Derived2 也是如此。

我知道有一些与虚拟方法相关的开销（可能微不足道，但仍然如此），并且受保护的变量可能不适合封装，或者它可能被遗忘并未初始化。所以我的问题基本上是，其中哪一个是可取的，为什么，或者我应该完全避免这种情况并尝试以不同的方式处理它？

注意：我的实际代码有点复杂。我还没有实际测试过这段代码是否有效，如果不正确请见谅。

*当我说接口时，我的意思是一个只包含纯虚函数的类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T02:29:15.937

实际上，您尝试做的事情很常见。但是，还有另一种方法可以实现这一点，它明确**定义**了`AbstractBase`. 修改您的示例，它将如下所示：

```
class AbstractBase : public SomeInterface
{
public:
    explicit AbstractBase(int numIterations) : numIterations(numIterations) {}

    virtual void DoSomething()
    {
        for (int i = 0; i < numIterations; i++)
        {
            // Call implementation in derived classes, for example
            DoSomethingImpl();
        }
    }

protected:
    virtual void DoSomethingImpl() = 0;

    // Can omit it, if not needed by derivatives
    int GetNumIterations() { return numIterations; }

private:
    int numIterations;
};

class Derived1 : public AbstractBase
{
public:
    Derived1() : AbstractBase(5) {}

protected:
    virtual void DoSomethingImpl()
    {
        // Do actual work.
    }
};

class Derived2 : public AbstractBase
{
public:
    Derived2() : AbstractBase(1) {}

protected:
    virtual void DoSomethingImpl()
    {
        // Do actual work.
    }
}; 
```

正如您现在可能理解的那样，通过**合同**，我的意思是构造函数，它现在明确地强制派生类`AbstractBase`正确初始化它，因此您永远不会弄乱它。这种方法的**缺点**`Derived1`是它引入了额外的字段，如果这`5`在你的情况下永远不会改变，那么它可能会在许多副本中重复。因此，如果您关心内存占用，那么我不会选择这个。但是，如果`numIterations`可以更改，那么这种方法肯定是建议的 3 种方法中最好的。您所要做的就是将适当的设置器添加到`AbstractBase`.

**注意：**我的方法比您的第二种方法更安全、更好，因为它完全解决了您提到的问题，即**封装漏洞**（实现细节的冗余暴露）和**合同弱点**（当您可能忘记初始化时，`numIterations`因为您不是被迫）。因此，您**不想**在当前情况下使用第二种方法。

您提出的第一种方法也很好。它比我的**优势**是它不会引入任何内存开销。并且只要“迭代次数”没有改变，您就不需要引入一个字段来存储它。结果，您必须`GetNumIterations`在每个衍生产品中重写此方法，但这没关系，因为这是（强）合同（纯虚拟方法）的一部分，您也永远不能弄乱它。

总而言之，如您所见，这两种方法是相互排斥的，只需将它们的优缺点应用于您的特定情况，就很容易决定使用哪一种。

# python - 如何从具有透明背景的 matplotlib 导出绘图？

> ID：15857647
> 
> 赞同：150
> 
> 时间：2013-04-07T00:47:01.627
> 
> 标签：python, matplotlib, plot, transparency

我正在使用 matplotlib 制作一些图表，不幸的是我无法在没有白色背景的情况下导出它们。

![纯白色背景的样本图](https://i.stack.imgur.com/wfysS.png)

换句话说，当我导出这样的图并将其放置在另一个图像的顶部时，白色背景隐藏了它背后的东西，而不是让它显示出来。如何改为导出具有透明背景的图？

* * *

## 回答 #1

> 赞同：239
> 
> 时间：2013-04-07T01:51:44.797

使用带有关键字参数的 matplotlib`savefig`函数`transparent=True`将图像保存为 png 文件。

```
In [30]: x = np.linspace(0,6,31)

In [31]: y = np.exp(-0.5*x) * np.sin(x)

In [32]: plot(x, y, 'bo-')
Out[32]: [<matplotlib.lines.Line2D at 0x3f29750>]            

In [33]: savefig('demo.png', transparent=True) 
```

结果： ![演示.png](https://i.stack.imgur.com/jj5Nf.png)

当然，该图并不能证明透明度。这是使用 ImageMagick`display`命令显示的 PNG 文件的屏幕截图。棋盘图案是通过 PNG 文件的透明部分可见的背景。

![显示截图](https://i.stack.imgur.com/NMfqd.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-07T01:00:36.687

Png 文件可以处理透明度。因此，您可以使用这个问题[Save plot to image file 而不是使用 Matplotlib 显示它](https://stackoverflow.com/questions/9622163/matplotlib-save-plot-to-image-file-instead-of-displaying-it-so-can-be-used-in-b)，以便将您的图形保存为`png`文件。

如果你想让所有白色像素透明，还有另一个问题：[使用 PIL 使所有白色像素透明？](https://stackoverflow.com/questions/765736/using-pil-to-make-all-white-pixels-transparent)

如果你想把整个区域变成透明，那么就有这个问题： 然后使用 PIL 库，就像这个问题[Python PIL: how to make area transparent in PNG?](https://stackoverflow.com/questions/4379978/python-pil-how-to-make-area-transparent-in-png) 以使您的图形透明。

# bash - 在 Mountain Lion 的 shell 中在用户之间移动文件

> ID：15857651
> 
> 赞同：0
> 
> 时间：2013-04-07T00:48:55.823
> 
> 标签：bash, shell, path, directory

我正在研究一组 Bash shell 脚本，并让其中一个脚本检查是否需要更新。如果是这样，它需要将文件从我的计算机复制到其他人。在雪豹中，我可以做类似的事情。

```
account=$(whoami)
cp "/Users/Sleepykrooks/Library/Services/Program" "/Users/$account/Library/Services/Program" 
```

但是对于 Mountain Lion，即使完整路径仍然看起来像这样，使用相同的东西会导致找不到它正在寻找的文件夹或文件的错误。但是，如果您使用类似的东西，它确实有效。

```
cp "/Library/Services/Program" "/Library/Services/Program" 
```

这是我不确定如何使用我的路径将更新的文件复制到另一个用户的路径的地方。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:48:41.283

在 Unix 中复制文件夹时，通常需要该`-R`标志。（参见 cp 联机帮助页）。

```
cp -R "/Users/Sleepykrooks/Library/Services/Program" "/Users/$account/Library/Services/Program" 
```

或者，使用`~`主目录的 BASH 快捷方式：

```
cp -R ~Sleepykrooks/Library/Services/Program ~/Library/Services/Program 
```

通常，您不应触摸Mac 上的`/Library`目录或用户目录。而且，除非你能凝视电视摄像机并以绝对严肃的语气说“*我是专业人士。不要在家里尝试这个*” ，否则你`~/Library`永远不应该触摸下面的任何东西。`/System`

# wpf - 无法将“RuntimePropertyInfo”类型的对象转换为“ListBoxItem”类型

> ID：15857652
> 
> 赞同：0
> 
> 时间：2013-04-07T00:49:00.650
> 
> 标签：wpf, vb.net, xaml, casting, listbox

我有一个奇怪的问题，我无法从 ListBox 中获取项目。我什至尝试使用[此站点](http://msdn.microsoft.com/en-us/library/system.windows.controls.listbox.aspx)中的代码，但在我的情况下它失败并显示一条消息：*无法将类型为“System.Reflection.RuntimePropertyInfo”的对象转换为类型“System.Windows.Controls.ListBoxItem”。*ListBox 绑定到 XAML 中的颜色。

```
xmlns:sys="clr-namespace:System;assembly=mscorlib"
<Window.Resources>
<ObjectDataProvider MethodName="GetType"
                    ObjectType="{x:Type sys:Type}" x:Key="colorsTypeOdp">
    <ObjectDataProvider.MethodParameters>
        <sys:String>System.Windows.Media.Colors, PresentationCore,
                    Version=3.0.0.0, Culture=neutral,
                    PublicKeyToken=31bf3856ad364e35
        </sys:String>
    </ObjectDataProvider.MethodParameters>
</ObjectDataProvider>

<ObjectDataProvider ObjectInstance="{StaticResource colorsTypeOdp}"
                    MethodName="GetProperties" x:Key="colorPropertiesOdp">
</ObjectDataProvider>
</Window.Resources>
<!-- etc -->

<ListBox x:Name="ListBoxColor"
         ItemsSource="{Binding Source={StaticResource colorPropertiesOdp}}"
         ScrollViewer.HorizontalScrollBarVisibility="Disabled"
         ScrollViewer.VerticalScrollBarVisibility="Auto"
         Margin="5" Grid.RowSpan="5" SelectedIndex="113">
    <ListBox.ItemsPanel>
        <ItemsPanelTemplate>
            <WrapPanel Orientation="Vertical" />
        </ItemsPanelTemplate>
    </ListBox.ItemsPanel>
    <ListBox.ItemTemplate>
        <DataTemplate>
            <StackPanel Orientation="Horizontal">
                <Rectangle Fill="{Binding Name}" Stroke="Black" Margin="2"
                           StrokeThickness="1" Height="20" Width="50"/>
                <Label Content="{Binding Name}" />
            </StackPanel>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

```
Private Sub ListBoxColor_SelectionChanged(sender As Object, _
            e As SelectionChangedEventArgs) Handles ListBoxColor.SelectionChanged
        Dim lbsender As ListBox
        Dim li As ListBoxItem

        lbsender = CType(sender, ListBox)
        li = CType(lbsender.SelectedItem, ListBoxItem) 
```

它在最后一行中断。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T02:27:03.430

您的项目是该类`ListBox`的属性。`Colors`您不能将属性转换为 a `ListBoxItem`，因为它不是一个。

试着打电话`ListBox.ContainerFromElement(lbsender.SelectedItem)`。

MSDN 来源：[ContainerFromElement](http://msdn.microsoft.com/en-us/library/aa346420.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T07:38:03.447

列表框中的项目类型为`System.Reflection.PropertyInfo`。所以你需要做这样的事情：

C＃

```
if (ListBoxColor.SelectedItem != null)
{
    var selectedItem = (PropertyInfo)ListBoxColor.SelectedItem;
    var color = (Color)selectedItem.GetValue(null, null);
    Debug.WriteLine(color.ToString());
} 
```

VB.NET

```
If ListBoxColor.SelectedItem IsNot Nothing Then
    Dim selectedItem As PropertyInfo = _
        DirectCast(ListBoxColor.SelectedItem, PropertyInfo)
    Dim color As Color = DirectCast(selectedItem.GetValue(Nothing, Nothing), Color)
    Debug.WriteLine(color.ToString())
End If 
```

# ruby-on-rails - 如何在 rails 3.2.12 中发送（“strftime（'%Y/%m/%d'）”）？

> ID：15857657
> 
> 赞同：0
> 
> 时间：2013-04-07T00:49:24.843
> 
> 标签：ruby-on-rails, ruby, send

我们正在尝试`send` `strftime('%Y/%m/%d')`在我们的 rails 3.2.12 应用程序中使用日期对象。这是我们在 中进行的测试`rails console`：

```
irb(main):014:0> b=User.offset(1).first
  ←[1m←[35mUser Load (1.0ms)←[0m  SELECT "users".* FROM "users" LIMIT 1 OFFSET 1
=> #<User id: 2, login: "wsxl207", name: "?????", email: nil, encrypted_password: "55a48ac66ba164805d91dc5415455cd402e9c8b3a656620136a...", salt: "3ee
e529200bdcad3ed2f16a8749ede6f046130e2705714ab55d...", status: "active", user_type: "employee", input_by_id: 1, created_at: "2012-04-13 16:23:25", upda
ted_at: "2012-08-22 03:15:12">

irb(main):015:0> b.send('created_at').send("strftime('%Y/%m/%d')")
NoMethodError: undefined method `strftime('%Y/%m/%d')' for 2012-04-13 16:23:25 UTC:Time
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.12/lib/active_support/time_with_zone.rb:332:in `method_missing'
        from (irb):15
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.12/lib/rails/commands/console.rb:47:in `start'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.12/lib/rails/commands/console.rb:8:in `start'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.12/lib/rails/commands.rb:41:in `<top (required)>'
        from script/rails:6:in `require'
        from script/rails:6:in `<main>'

irb(main):016:0> b.send('created_at').strftime('%Y/%m/%d')
=> "2012/04/13" 
```

但是我们发现这`send`不适用于 `strftime('%Y/%m/%d')`with `send("strftime('%Y/%m/%d')")`。我们在这里缺少什么？谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T00:51:48.380

`send`将方法名称（理想情况下作为符号，尽管字符串也可以）作为其第一个参数，并将方法调用的参数作为其余参数。所以我想你正在寻找的是：

```
b.send(:created_at).send(:strftime, "%Y/%m/%d") 
```

也就是说，如果您在代码中明确执行此操作，您几乎肯定只想直接调用`created_at`and `strftime`，而不是使用元编程方法`send`。

# html - 引导标签周围的复选框和输入

> ID：15857660
> 
> 赞同：5
> 
> 时间：2013-04-07T00:50:04.627
> 
> 标签：html, css, twitter-bootstrap

我正在制作一个带有与文本输入内联的复选框的表单。以下是我为使其与 bootstrap 相得益彰而做的事情：

```
<label class="checkbox">
  <input type="checkbox" name="keywords" value="__option__">
  <input type="text" name="keywords_other_option" value="" placeholder="Other">
</label> 
```

它看起来不错，但功能并不好。在 Firefox 中，用户无法在文本框中输入内容。有没有一种很好的引导方法可以将复选框和文本输入相互内联？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-07T01:07:12.447

不要将两个`input`元素放在一个`label`元素中。

这是解决此问题的 Twitter Bootstrap 方法：

```
<form class="form-inline">
  <label class="checkbox">
     <input type="checkbox" name="keywords" value="__option__">
  </label>
  <input type="text" name="keywords_other_option" value="" placeholder="Other">
</form> 
```

这是**[演示](http://jsfiddle.net/8tw7v/)**。

[从官方文档](http://twitter.github.io/bootstrap/base-css.html#forms)中查看更多示例。

# c# - 在两个表单之间共享 ZedGraphControl

> ID：15857664
> 
> 赞同：2
> 
> 时间：2013-04-07T00:50:43.983
> 
> 标签：c#, zedgraph

我有以下问题/任务：

我在 Form1 中有一个 Zedgraph。该 zedgraph 在 Form1 中得到更新。现在我想选择将该图取消停靠到新表单（Form2）中。Form1 现在必须能够更新 form2 中的 zedgraph。此外，在我关闭 form2 后，zedgraph 应该返回到原始表单（form1）。

怎么可能做这样的事？可能吗？有什么提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-11-23T06:20:12.480

只需创建两个 zed 图，一个用于主窗体，一个用于其他窗体。Zedgraph 有一个序列来绘制数据。您可以复制它的数据并在第二种形式上绘图。完成此操作后，您可以在主窗体上隐藏 zedgraph。

# javascript - jQuery - 如果屏幕小于指定宽度（响应式）

> ID：15857669
> 
> 赞同：4
> 
> 时间：2013-04-07T00:51:32.510
> 
> 标签：javascript, jquery, responsive

如果页面宽度小于 ，如何弹出警报`1200px`并做出响应？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-07T00:54:56.533

您可以使用[断点](https://github.com/eikes/breakpoints)模块之类的东西。然后设置一个断点以在 1200px 处触发并显示一个对话框，然后添加一个更改布局的 css 类，或者使用直接的 javascript 进行更改。

```
breakpoints(1200, function(oldPoint, newPoint) {
  alert('The screen width just changed');
}); 
```

如果你只想要原生 jQuery：

```
$(window).resize(function() {
  var width = $(window).width();
  if (width < 1200){
    alert('Your screen is too small');
  }
}); 
```

* * *

为了完整起见，这里是 CSS 媒体查询（仍然不处理警报，但可以帮助使网站“响应”）。

```
/* some normal style */
.myclass {
  font-size: 22pt;
}

/* alter the style when the screen's smaller */
@media screen and (max-width: 1200px) {
  .myclass {
    font-size: 18pt;
  }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-05-23T02:01:09.420

对于未来的 Google 员工，2019 年的解决方案是使用 JavaScript 的`window​.match​Media()`. 它在所有主要浏览器和 IE 10 及更高版本中都[受支持。](https://caniuse.com/#feat=matchmedia)

你可以像这样使用它：

```
if (window.matchMedia('(max-width: 1200px)').matches) {
    // functionality for screens smaller than 1200px
} 
```

要使其具有响应性，您只需将其包装在一个`resize`函数中：

```
$(window).resize(function() {
    if (window.matchMedia('(max-width: 1200px)').matches) {
        // functionality for screens smaller than 1200px
    }
}); 
```

这可以说是检查屏幕大小的最简单方法，并且不会使代码膨胀。

查看有关[match​Media](https://developer.mozilla.org/en-US/docs/Web/API/Window/matchMedia)的 Mozilla 文档以了解更多信息，并查看有关以[编程方式测试媒体查询](https://developer.mozilla.org/en-US/docs/Web/CSS/Media_Queries/Testing_media_queries)的更多信息。

# iphone - 选择一次更新按钮图像 iPad 不工作

> ID：15857674
> 
> 赞同：0
> 
> 时间：2013-04-07T00:51:59.537
> 
> 标签：iphone, ios, ipad, core-data

一旦选择了新的，我正在尝试更新我的图像。更新有效，但在编辑期间选择新图像时不会立即显示，我想知道是否有人知道如何修复它。

该应用程序最初是为 iPhone 创建的，此功能运行良好，即使在 iPhone 编辑期间选择新图像，图像也会立即更新，但是当我在 iPad 上使用它时，图像在编辑过程中不会改变，但一旦我完成编辑并返回，我可以看到图像发生了变化。

我正在从开发人员中心制作核心数据配方示例代码以在 iPad 上运行。

这是我用于选择新的 Image PhotoTapped1 按钮的代码，已更改为可与 iPad 一起使用：

```
- (IBAction)photoTapped1 {
if(UI_USER_INTERFACE_IDIOM()== UIUserInterfaceIdiomPhone){
// If in editing state, then display an image picker; if not, create and push a photo view controller.
    if (self.editing) {
        UIImagePickerController *imagePicker = [[UIImagePickerController alloc] init];
        imagePicker.delegate = self;
        [self presentViewController:imagePicker animated:YES completion:nil];
        [imagePicker release];
    } else {
        RecipePhotoViewController *recipePhotoViewController = [[RecipePhotoViewController alloc] init];
        recipePhotoViewController.hidesBottomBarWhenPushed = YES;
        recipePhotoViewController.recipe = recipe;
        [self.navigationController pushViewController:recipePhotoViewController animated:YES];
        [recipePhotoViewController release];
    }
}else{
    if (self.editing){
        UIImagePickerController *imagePicker = [[UIImagePickerController alloc] init];
        imagePicker.delegate = self;
        imagePicker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
        self.popover = [[UIPopoverController alloc] initWithContentViewController:imagePicker];
        [self.popover presentPopoverFromRect:CGRectMake(0, 0, 400, 400) inView:self.view permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES];
        self.popover.delegate = self;
        [popover release];
    }else{
         RecipePhotoViewController *recipePhotoViewController = [[RecipePhotoViewController alloc] init];
         recipePhotoViewController.hidesBottomBarWhenPushed = YES;
         recipePhotoViewController.recipe = recipe;
         [self.navigationController pushViewController:recipePhotoViewController animated:YES];
         [recipePhotoViewController release];
    }}} 
```

这工作正常，图像更新，但不是在编辑期间。在编辑过程中，它会显示一直存在的图像，因此可能会令人困惑，因为使用该应用程序的任何人都无法确定新选择的图像是否已添加或更新。

以下是 imagePickerController 和 updateButton 的代码：

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingImage:(UIImage *)selectedImage editingInfo:(NSDictionary *)editingInfo {

// Delete any existing image.
NSManagedObject *oldImage = recipe.image;
if (oldImage != nil) {
    [recipe.managedObjectContext deleteObject:oldImage];
}

// Create an image object for the new image.
NSManagedObject *image = [NSEntityDescription insertNewObjectForEntityForName:@"Image" inManagedObjectContext:recipe.managedObjectContext];
recipe.image = image;

// Set the image for the image managed object.
[image setValue:selectedImage forKey:@"image"];

// Create a thumbnail version of the image for the recipe object.
CGSize size = selectedImage.size;
CGFloat ratio = 0;
if (size.width > size.height) {
    ratio = 44.0 / size.width;
} else {
    ratio = 44.0 / size.height;
}
CGRect rect = CGRectMake(0.0, 0.0, ratio * size.width, ratio * size.height);

UIGraphicsBeginImageContext(rect.size);
[selectedImage drawInRect:rect];
recipe.thumbnailImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();

[self dismissModalViewControllerAnimated:YES];}
- (void)imagePickerControllerDidCancel:(UIImagePickerController *)picker {
[self dismissViewControllerAnimated:YES completion: nil];
} 
```

这是更新照片按钮：

```
 - (void)updatePhotoButton {
/* How to present the photo button depends on the editing state and whether the     recipe has a thumbnail image.
 * If the recipe has a thumbnail, set the button's highlighted state to the same as the editing state (it's highlighted if editing).
 * If the recipe doesn't have a thumbnail, then: if editing, enable the button and show an image that says "Choose Photo" or similar; if not editing then disable the button and show nothing.  
 */
BOOL editing = self.editing;

if (recipe.thumbnailImage != nil) {
    photoButton.highlighted = editing;
} else {
    photoButton.enabled = editing;

    if (editing) {
        [photoButton setImage:[UIImage imageNamed:@"choosePhoto.png"] forState:UIControlStateNormal];
    } else {
        [photoButton setImage:nil forState:UIControlStateNormal];
    }
}
    } 
```

有谁知道会出现什么问题？我知道 UIImagePickerControll 必须与 UIPopoverController 一起使用才能在 iPad 上工作，但正在更新 -(IBAction)PhotoTapped1 代码。

不知道从这里去哪里。

谢谢你。

更新问题..

PhotoViewController.h

```
@class Recipe;

@interface RecipePhotoViewController : UIViewController {
@private
    Recipe *recipe;
    UIImageView *imageView;
}

@property(nonatomic, retain) Recipe *recipe;
@property(nonatomic, retain) UIImageView *imageView;

@end 
```

RecipePhotoViewController.m

```
#import "RecipePhotoViewController.h"

#import "Recipe.h"

@implementation RecipePhotoViewController

@synthesize recipe;
@synthesize imageView;

- (void)loadView {
self.title = @"Photo";

 imageView = [[UIImageView alloc] initWithFrame:[UIScreen mainScreen].applicationFrame];
 imageView.autoresizingMask = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;
 imageView.contentMode = UIViewContentModeScaleAspectFit;
 imageView.backgroundColor = [UIColor blackColor];

 self.view = imageView;
 }

 - (void)viewWillAppear:(BOOL)animated {
  imageView.image = [recipe.image valueForKey:@"image"];
 }

  - (BOOL)shouldAutorotateToInterfaceOrientation:    (UIInterfaceOrientation)interfaceOrientation {
   return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
   }

- (void)dealloc {
 [imageView release];
 [recipe release];
 [super dealloc];
  }

 @end 
```

这是原始问题的更新数据

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T05:42:36.610

在 iPhone 上没有问题的原因是之前的图像在 iPhone 上不可见，因为您使用的是呈现的视图控制器：图像选择器接管了整个屏幕。另一方面，在 iPad 上，您使用的是弹出框，因此在弹出框后面仍然可以看到主界面。因此，用户能够看到被点击的图像不是出现在主界面中的图像。

但可能会争辩说这没有问题。用户实际上还没有接受图像，直到图像选择器弹出框被解除。你说：

> 在编辑过程中，它会显示一直存在的图像，因此可能会令人困惑，因为使用该应用程序的任何人都无法确定新选择的图像是否已添加或更新。

但是，如果用户在弹出框之外点击以关闭/取消它怎么办？当然，您不希望图像在主界面中发生变化。因此，您反对的行为是正确的：您抱怨主界面中的图像在弹出框实际关闭之前不会更新，而这正是它应该的样子。当用户在弹出框中工作时，弹出框后面发生的事情是无关紧要的。

# mysql - mySQL 使用外键从另一个表中获取条目？

> ID：15857676
> 
> 赞同：1
> 
> 时间：2013-04-07T00:52:13.840
> 
> 标签：mysql, foreign-keys

这是我的表：

```
class
-------
classId
course   //example: CMSC101
semester //example: Spring 2013
profId

professor
---------
profId
lname
fname 
```

我想找到所有姓史密斯的教授教授的所有课程。我基本上想这样做：

```
SELECT * FROM `professor` WHERE lname=`Smith` 
```

然后，获取这些结果并将它们插入其中`???`：

```
SELECT * FROM `class` WHERE profId=`???` 
```

无论如何我可以只用一个查询来做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:25:30.043

这应该有效：

```
SELECT a.* FROM class a, professor b WHERE a.profId = b.profId AND b.lname = 'Smith'; 
```

干杯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T03:55:01.570

我强烈建议您使用 SQL JOINS。学习一次，终生使用。

```
SELECT c.*
FROM class AS c
INNER JOIN professor AS p
  ON (c.profId = p.profId)
WHERE p.lname LIKE 'Smith'; 
```

给你的一些读物：

> [SQL 加入](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)
> [数据库规范化](http://www.w3schools.in/mysql/database-normalization/)

**[更新]**
送给你的小礼物：

![ER图](https://i.stack.imgur.com/P1Ngd.png)

```
SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

DROP SCHEMA IF EXISTS `school` ;
CREATE SCHEMA IF NOT EXISTS `school` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ;
USE `school` ;

-- -----------------------------------------------------
-- Table `school`.`professor`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `school`.`professor` (
  `professorId` INT UNSIGNED NOT NULL AUTO_INCREMENT ,
  `lname` VARCHAR(40) NOT NULL ,
  `fname` VARCHAR(40) NOT NULL ,
  PRIMARY KEY (`professorId`) )
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `school`.`semester`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `school`.`semester` (
  `semesterId` TINYINT UNSIGNED NOT NULL AUTO_INCREMENT ,
  `name` VARCHAR(8) NOT NULL ,
  PRIMARY KEY (`semesterId`) )
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `school`.`course`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `school`.`course` (
  `courseId` TINYINT UNSIGNED NOT NULL AUTO_INCREMENT ,
  `code` VARCHAR(10) NOT NULL ,
  `name` VARCHAR(40) NOT NULL ,
  PRIMARY KEY (`courseId`) ,
  UNIQUE INDEX `code_UNIQUE` (`code` ASC) )
ENGINE = InnoDB;

-- -----------------------------------------------------
-- Table `school`.`class`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `school`.`class` (
  `classId` INT UNSIGNED NOT NULL AUTO_INCREMENT ,
  `courseId` TINYINT UNSIGNED NOT NULL ,
  `semesterId` TINYINT UNSIGNED NOT NULL ,
  `profId` INT UNSIGNED NOT NULL ,
  PRIMARY KEY (`classId`) ,
  INDEX `fk_class_professor_idx` (`profId` ASC) ,
  INDEX `fk_class_semester1_idx` (`semesterId` ASC) ,
  INDEX `fk_class_course1_idx` (`courseId` ASC) ,
  CONSTRAINT `fk_class_professor`
    FOREIGN KEY (`profId` )
    REFERENCES `school`.`professor` (`professorId` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_class_semester1`
    FOREIGN KEY (`semesterId` )
    REFERENCES `school`.`semester` (`semesterId` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_class_course1`
    FOREIGN KEY (`courseId` )
    REFERENCES `school`.`course` (`courseId` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

USE `school` ;

-- -----------------------------------------------------
-- Placeholder table for view `school`.`class_details`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `school`.`class_details` (`class_id` INT, `course_id` INT, `course_code` INT, `course_name` INT, `semester_id` INT, `semester_name` INT, `prof_id` INT, `prof_fname` INT, `prof_lname` INT);

-- -----------------------------------------------------
-- View `school`.`class_details`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `school`.`class_details`;
USE `school`;
CREATE  OR REPLACE VIEW `school`.`class_details` AS
SELECT
  w.classId    AS `class_id`,
  w.courseId   AS `course_id`,
  x.`code`     AS `course_code`,
  x.`name`     AS `course_name`,
  w.semesterId AS `semester_id`,
  y.`name`     AS `semester_name`,
  w.profId     AS `prof_id`,
  z.fname      AS `prof_fname`,
  z.lname      AS `prof_lname`
FROM class AS w
INNER JOIN course AS x
  ON (w.courseId = x.courseId)
INNER JOIN semester AS y
  ON (w.semesterId = y.semesterId)
INNER JOIN professor AS z
  ON (w.profId = z.professorId);

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `school`.`professor`
-- -----------------------------------------------------
START TRANSACTION;
USE `school`;
INSERT INTO `school`.`professor` (`professorId`, `lname`, `fname`) VALUES (1, 'Smith', 'Willard');
INSERT INTO `school`.`professor` (`professorId`, `lname`, `fname`) VALUES (2, 'Burton', 'Tim');

COMMIT;

-- -----------------------------------------------------
-- Data for table `school`.`semester`
-- -----------------------------------------------------
START TRANSACTION;
USE `school`;
INSERT INTO `school`.`semester` (`semesterId`, `name`) VALUES (1, '2011.1');
INSERT INTO `school`.`semester` (`semesterId`, `name`) VALUES (2, '2011.2');
INSERT INTO `school`.`semester` (`semesterId`, `name`) VALUES (3, '2012.1');
INSERT INTO `school`.`semester` (`semesterId`, `name`) VALUES (4, '2012.2');
INSERT INTO `school`.`semester` (`semesterId`, `name`) VALUES (5, '2013.1');
INSERT INTO `school`.`semester` (`semesterId`, `name`) VALUES (6, '2013.2');
INSERT INTO `school`.`semester` (`semesterId`, `name`) VALUES (7, '2014.1');
INSERT INTO `school`.`semester` (`semesterId`, `name`) VALUES (8, '2014.2');

COMMIT;

-- -----------------------------------------------------
-- Data for table `school`.`course`
-- -----------------------------------------------------
START TRANSACTION;
USE `school`;
INSERT INTO `school`.`course` (`courseId`, `code`, `name`) VALUES (1, 'CALC1', 'Calculus 1');
INSERT INTO `school`.`course` (`courseId`, `code`, `name`) VALUES (2, 'CALC2', 'Calculus 2');
INSERT INTO `school`.`course` (`courseId`, `code`, `name`) VALUES (3, 'PHYS1', 'Physics 1');
INSERT INTO `school`.`course` (`courseId`, `code`, `name`) VALUES (4, 'PHYS2', 'Physics 2');

COMMIT;

-- -----------------------------------------------------
-- Data for table `school`.`class`
-- -----------------------------------------------------
START TRANSACTION;
USE `school`;
INSERT INTO `school`.`class` (`classId`, `courseId`, `semesterId`, `profId`) VALUES (1, 1, 3, 1);
INSERT INTO `school`.`class` (`classId`, `courseId`, `semesterId`, `profId`) VALUES (2, 2, 3, 1);
INSERT INTO `school`.`class` (`classId`, `courseId`, `semesterId`, `profId`) VALUES (3, 3, 3, 2);
INSERT INTO `school`.`class` (`classId`, `courseId`, `semesterId`, `profId`) VALUES (4, 4, 3, 2);
INSERT INTO `school`.`class` (`classId`, `courseId`, `semesterId`, `profId`) VALUES (5, 1, 4, 1);
INSERT INTO `school`.`class` (`classId`, `courseId`, `semesterId`, `profId`) VALUES (6, 2, 4, 1);
INSERT INTO `school`.`class` (`classId`, `courseId`, `semesterId`, `profId`) VALUES (7, 3, 4, 2);
INSERT INTO `school`.`class` (`classId`, `courseId`, `semesterId`, `profId`) VALUES (8, 4, 4, 2);

COMMIT;

SELECT * FROM class_details;

SELECT * FROM class_details WHERE prof_lname LIKE 'Smith'; 
```

# c++ - 使用有意义的词来获取元组元素

> ID：15857680
> 
> 赞同：3
> 
> 时间：2013-04-07T00:52:44.327
> 
> 标签：c++, templates, c++11, tuples

例如，我有一个像

```
std::tuple<T0, T1, T2> tp; 
```

我可以通过函数来​​获取它的元素，`std::get()`比如

```
auto e0 = std::get<0>(tp); 
```

我更喜欢使用有意义的索引来访问数字以外的元素。一种方法是定义一个枚举

```
enum MyEnum
{
    WHAT_T0_MEANS = 0,
    WHAT_T1_MEANS = 1,
    WHAT_T2_MEANS = 2
}; 
```

因此我可以使用友好版本的 get like

```
auto e0 = std::get<WHAT_T0_MEANS>(tp); 
```

问题是有时我发现元组中类型的顺序不友好，将其更改为 like `std::tuple<T1, T0, T2>`。但是很容易忘记更改枚举中元素的顺序。一个好方法可能是在类 T0 中定义 T0 的含义或使用 map 来查找 T0 的含义，或者。然后写一些函数来通过T0的意思来获取元素。有什么办法吗？这里 T0 的含义不是枚举元素所必需的。它可以是一种类型或其他任何东西。

如果 T0、T1 和 T2 是不同的类型。像这样的功能

```
T MyGet<T>(tp) 
```

其中 T 可以是 T0、T1 或 T2，都可以。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-07T01:03:34.430

正在进行讨论：

*   [n3584](http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2013/n3584.html)按类型访问元组字段的措辞
*   在 isocpp 论坛上[https://groups.google.com/a/isocpp.org/forum/?hl=en&fromgroups=#!topic/std-proposals/N-kIXNrkTUk](https://groups.google.com/a/isocpp.org/forum/?hl=en&fromgroups=#!topic/std-proposals/N-kIXNrkTUk)

现在，您可以使用带有 Fusion Map 之类的标记元素：

```
#include <boost/fusion/include/map.hpp>
#include <boost/fusion/include/at_key.hpp>
using namespace boost::fusion;

typedef map<
   pair<struct what_t1_means, int>
 , pair<struct what_t2_means, int> >
map_type;

int main()
{
    map_type m { 42, -42 };

    auto i1 = at_key<what_t1_means>(m);
    auto i2 = at_key<what_t2_means>(m);
} 
```

我选择使用`int`两次，以强调“键类型”与“元组”类型是分开的。

**[在http://liveworkspace.org/code/4CxV4T$0](http://liveworkspace.org/code/4CxV4T$0)**上现场观看

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-07T04:04:40.617

```
#include <type_traits>
#include <cstddef>
#include <tuple>
using std::size_t;
/* 
```

构建单个`type_list`. 然后构建`tuple`from said `type_list`，并得到类似的索引。

基本元编程样板：

```
*/    
template<typename... Ts>
struct type_list {};
template<typename T, typename list, typename=void>
struct index_of;
template<typename T, typename T0, typename...Ts>
struct index_of<T, type_list<T0, Ts...>, typename std::enable_if<
  std::is_same<T, T0>::value
>::type>: std::integral_constant< size_t, 0 >{};
template<typename T, typename T0, typename...Ts>
struct index_of<T, type_list<T0, Ts...>, typename std::enable_if<
  !std::is_same<T, T0>::value
>::type>: std::integral_constant< size_t, index_of<T, type_list<Ts...>>::value+1 >{};

template<template<typename...>class target, typename source>
struct copy_types;
template<template<typename...>class target, template<typename...>class src, typename... Ts>
struct copy_types<target, src<Ts...>> {
  typedef target<Ts...> type;
};
template<template<typename...>class target, typename source>
using CopyTypes = typename copy_types<target, source>::type;
/* 
```

现在我们创建一个类型列表，并使用它来定义我们的元组和一个`get`函数：

```
*/
typedef type_list<int, double, char> my_types;
typedef CopyTypes< std::tuple, my_types > my_tuple;
template<typename T>
T& get_type( my_tuple& t ) {
  return std::get< index_of<T, my_types>::value >(t);
}
template<typename T>
T const& get_type( my_tuple const& t ) {
  return std::get< index_of<T, my_types>::value >(t);
}
/* 
```

如果我们想要标记类型，我们可以使用`boost::mpl`，或者像这样快速滚动：

```
*/
template<typename Tag, typename T>
struct tagged_type {
  typedef Tag tag;
  typedef T type;
};

template< typename tagged_type >
using GetType = typename tagged_type::type;
template< typename tagged_type >
using GetTag = typename tagged_type::tag;

template< template<typename...> class target, typename tagged_list >
struct copy_tagged_types;

template< template<typename...> class target, typename... tagged_Ts >
struct copy_tagged_types< target, type_list<tagged_Ts...> >:
  copy_types< target, type_list< GetType<tagged_Ts>... > >
{};

template< template<typename...> class target, typename tagged_list >
using CopyTaggedTypes = typename copy_tagged_types< target, tagged_list >::type;

template< typename Tag, typename tagged_list >
struct get_tag_index;

template< typename Tag, typename...Tagged_Ts >
struct get_tag_index< Tag, type_list< Tagged_Ts...> >:
  index_of< Tag, type_list< GetTag<Tagged_Ts>... > > {};
/* 
```

现在我们有了标记模板元编程库的基础知识。

使用将类似于：

```
*/
typedef type_list<
  tagged_type<struct bob, int>,
  tagged_type<struct alice, int>
> my_tagged_types;

typedef CopyTaggedTypes< std::tuple, my_tagged_types > my_tuple2;

template<typename Tag>
auto get_tag( my_tuple2& tup )
  ->decltype(std::get< get_tag_index< Tag, my_tagged_types >::value >( tup ))
{
  return std::get< get_tag_index< Tag, my_tagged_types >::value >( tup );
}
template<typename Tag>
auto get_tag( my_tuple2 const& tup )
  ->decltype(std::get< get_tag_index< Tag, my_tagged_types >::value >( tup ))
{
  return std::get< get_tag_index< Tag, my_tagged_types >::value >( tup );
}
/* 
```

这基本上是“自己动手`boost::mpl`”的情况。:)[这里的例子](http://liveworkspace.org/code/1p9wHk%2415)

```
*/
int main() {
   my_tuple t1;
   get_type<char>(t1) = 'a'; 
   my_tuple2 t2;
   get_tag<bob>(t2) = 7;
} 
```

# objective-c - UIWebView 启用/禁用后退/前进按钮

> ID：15857681
> 
> 赞同：0
> 
> 时间：2013-04-07T00:52:45.620
> 
> 标签：objective-c, ipad, uiwebview, uiwebviewdelegate

在 iPad 上，启用和禁用后退/前进按钮时，我遇到了奇怪的情况。当 web 视图开始并完成加载时，我会根据 canGoBack 和 canGoForward 检查启用/禁用它们。但大多数时候，按钮在不应该启用时启用，在不应该启用时禁用。就像在谷歌上一样，如果我输入一些东西，不会调用任何代表，因此按钮被禁用。在 Safari 中，它们的后退/前进按钮会发生变化。如果我去谷歌上的一个页面，然后返回两次，我又回到了第一页，我的后退按钮仍然打开。有没有办法知道何时返回页面完成加载（似乎它没有调用返回的委托？）或知道 canGoBack 和 canGoForward 何时更改 YES/NO？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T13:13:50.117

委托方法 – webViewDidStartLoad: 和 – webViewDidFinishLoad: 有时不会被调用，例如在谷歌搜索中。但我发现 - webView:shouldStartLoadWithRequest:navigationType: 被调用，所以我现在可以从该方法更改按钮和页面标题。

# javascript - Javascript：关于如何定义新数据类型的一些指导方针是什么？

> ID：15857682
> 
> 赞同：9
> 
> 时间：2013-04-07T00:52:51.393
> 
> 标签：javascript, types

假设您正在创建数据类型并公开其行为。

你能举一些你什么时候使用的例子：

*   一个功能和新的：

    ```
    // define new data type
    var CustomDataType= function(){ 
                          this.a='whatever';
                          this.doX= function(){/*some code*/};
                        }

    // create a new instance of our custom data type
    var obj= new customDataType(); 
    ```

*   对象文字和 Object.create：

    ```
    // define new data type
    var customDataType = {
                           a: 'whatever',
                           doX: function(){/*some code*/}
                         }

    // create a new instance of our custom data type
    var obj= Object.create(customDataType); 
    ```

*   构建对象的函数：

    ```
    function customDataTypeFactory(options){
      return {
               a: 'whatever',
               doX: function(){/*some code*/}
             }
    };

    // create a new instance of our custom data type
    var obj= customDataTypeFactory(options); 
    ```

我觉得这可以被标记为重复：`new`vs `Object.create`，但我的主要兴趣不是讨论哪个更好，而是要知道是否有特定的用例应该优先于其他用例。

我已经阅读了许多有关相关问题的帖子和 Crockford 的书：Javascript：好的部分。到目前为止，我已经得出结论，这是一个偏好问题，强硬的 Crockford 的建议对我产生了很大的共鸣：“尽量避免危险和不必要的功能”......我说的是`new`.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-07T05:47:41.883

我将从我通常定义类的方式开始：

```
function CustomDataType(a)
{
  this.a = a;
  this.b = 2;
}
CustomDataType.prototype = {
  doX : function () {}
};
var obj = new CustomDataType(1); 
```

我在构造函数中分配变量是因为`F.prototype = { a : [1,2,3]; }`存在问题，除非在构造函数中重新初始化属性（对于所有非原始类型都有问题），否则数组将在实例之间共享。当属性以某种方式依赖于构造函数的参数时，也需要它。我在原型中声明了方法，以便它们在所有实例之间共享，如果您使用继承，则意味着您可以进行超级调用，这也会导致更少的内存使用，因为该方法只需分配一次（尽管这可能不是一个大问题）。

我从来没有使用过`Object.create`，除非你喜欢一些疯狂的动态黑客，否则我认为没有任何理由这样做。

每当感觉没有必要为对象创建单独的类时，我都会使用对象文字，例如，如果它是方法的参数（因此调用者不必显式实例化某些东西），或者如果它是一些不应访问的内部值由其他任何人。

您的工厂本质上与对象文字相同。我想如果您需要创建一些 jsonesque 结构并设置一些默认值，它会很有用。

我不明白为什么`new`会是危险的或不必要的，他是在什么情况下这么说的？

但我认为很多都归结为品味。保持一致，不要使事情复杂化。

# jquery - 为什么我的条件 jquery 脚本只工作一次？

> ID：15857695
> 
> 赞同：1
> 
> 时间：2013-04-07T00:54:54.493
> 
> 标签：jquery, jquery-on

我可以点击`tr`它，它会选中复选框。然后，我可以再次单击`tr`它，它将取消选中该复选框。但是，如果我尝试`tr`第三次（或更多）单击相同的内容，则该脚本将不再有效。我已经尝试了这个脚本的几个版本，`prop()`而不是使用 ``attr()，但它仍然表现出相同的行为。为什么？

HTML：

```
<tr onclick="checkBox('ID')" id="recordID">
    <td>
        <input type="checkbox" name="myRecords[]" id="myRecordsID" value="ID">
    </td>
</tr> 
```

jQuery：

```
function checkBox(ID) {
    $(document).on("click",'#record'+ID,function(){
        $(document).on("click",'input#myRecords'+ID,function(e){
            e.stopPropagation();
        });
        var ischecked = $('input#myRecords'+ID).is(":checked");
        if(ischecked) {
            $('input#myRecords'+ID).removeAttr("checked");
        } else {
            $('input#myRecords'+ID).attr("checked", "checked");
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:17:26.880

我相信你的问题源于两件事：

1.  有嵌套的监听器
2.  永久性误报

HTML：

```
<tr id="recordID"> <!-- remove the onclick, you are already listening for it -->
    <td>
        <input type="checkbox" name="myRecords[]" id="myRecordsID" value="ID" />
    </td>
</tr> 
```

jQuery：

```
function checkBox(ID) {
    // move this listener outside so it does not require a click to activate
    $(document).on("click",'input#myRecords'+ID, function(e){
        e.stopPropagation();
    });
    $(document).on("click",'#record'+ID,function(){
        var ischecked = $('input#myRecords'+ID).is(":checked");
        if(ischecked) {
            // use .prop, while your method will check and uncheck the box
            // it will not work properly with jquery's .is(":checked");
            // eventually resulting in a permanent false positive
            $('input#myRecords'+ID).prop('checked', false);
        } else {
            $('input#myRecords'+ID).prop('checked', true)
        }
    });
};
checkBox('ID'); // activates listeners 
```

[http://jsfiddle.net/fresheyeball/K8L57/](http://jsfiddle.net/fresheyeball/K8L57/)

* * *

如果我在写这个[http://jsfiddle.net/fresheyeball/3qped/](http://jsfiddle.net/fresheyeball/3qped/)

HTML：

```
<tr class="record">
    <td>
        <input type="checkbox" name="myRecords[]" value="ID" />
    </td>
</tr> 
```

jQuery：

```
$('.record').on('click',function(){
    var checkBox = $(this).find('input');
    checkBox.prop('checked', !checkBox.prop('checked'));
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T01:36:10.183

有嵌套代码，我想知道您应用 on() jquery 函数的方式是否正确。

可以简化为：

```
 <table>
    <tr id="recordID12" class="myRecordEntry">
        <td>
            <input type="checkbox" name="myRecords[]" id="myRecordsID12" value="ID">
        </td>
    </tr>
    <tr id="recordID15" class="myRecordEntry">
        <td>
            <input type="checkbox" name="myRecords[]" id="myRecordsID15" value="ID">
        </td>
    </tr>
</table>

$(document).ready(function () {
    $(".myRecordEntry").click(function (e) {
        var id = e.currentTarget.id;
        var idnr = id.match(/\d+/g);
        var chk = $("#myRecordsID" + idnr).is(":checked");
        if (chk == false) {
            $("#myRecordsID" + idnr).prop("checked", true);
        } else {
            $("#myRecordsID" + idnr).prop("checked", false);
        }
    });
}); 
```

小提琴：http: [//jsfiddle.net/djwave28/p8Sr8/4/](http://jsfiddle.net/djwave28/p8Sr8/4/)

**编辑：** 您想要的可能会使用您的记录集合生成多行，因此表行可能具有不同的 ID。我已经使代码适应这种需要。

# ios - 仅保存一个 UILabel 值

> ID：15857698
> 
> 赞同：0
> 
> 时间：2013-04-07T00:55:04.947
> 
> 标签：ios, objective-c

我创建了一个简单的应用程序，它由 2 个 UILabel 和一个按钮组成，用于将它们的值相加。我`NSUserdefaults`在退出应用程序/点击后退按钮/应用程序崩溃等时保存标签的值。我在选择将两个值相加的按钮时调用此保存函数。

我遇到的问题是只有一个 UILabel 值被保存，另一个没有。我已经尝试了各种调整，但无法深入了解它。

这是我的 h 文件代码：

```
#import <UIKit/UIKit.h>

int dcounter;
int dtotaler;
int enteramount;

@interface durood : UIViewController {

    IBOutlet UILabel *dcount;
    IBOutlet UILabel *dtotal;
    IBOutlet UITextField *numberTextField;

}

-(IBAction)addtotal1; 
```

这是我的 m 文件中的代码：

```
-(IBAction)addtotal1;{

    float x = ([dcount.text floatValue]);
    float y = ([dtotal.text floatValue]);
    [dtotal setText:[NSString stringWithFormat:@"%g", x + y]];
    dcounter=0;
    dcount.text = [NSString stringWithFormat:@"%i",dcounter];
    NSUserDefaults *userDefaults=[NSUserDefaults standardUserDefaults];
    [userDefaults setObject:[NSString stringWithFormat:@"%i",dtotaler] forKey:@"saveDtotal"];
    [userDefaults setObject:[NSString stringWithFormat:@"%d",dcounter] forKey:@"saveDcount"];
    [userDefaults synchronize];

-(void)saveDcount
{
    NSUserDefaults *userDefaults=[NSUserDefaults standardUserDefaults];
    [userDefaults setObject:[NSString stringWithFormat:@"%d",dcounter] forKey:@"saveDcount"];
    [userDefaults setObject:[NSString stringWithFormat:@"%d",dtotaler] forKey:@"saveDtotal"];
    [userDefaults synchronize];

}

- (void)viewDidLoad
{
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(saveDcount) name:UIApplicationDidEnterBackgroundNotification object:nil];

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(saveDcount) name:UIApplicationWillTerminateNotification object:nil];

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(saveDtotal) name:UIApplicationDidEnterBackgroundNotification object:nil];

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(saveDtotal)   name:UIApplicationWillTerminateNotification object:nil];

    NSUserDefaults *userDefaults=[NSUserDefaults standardUserDefaults];
    NSString *dcountString= [userDefaults objectForKey:@"saveDcount"];
    NSLog(@"Your Dcount: %@",dcount);
    NSString *dtotalString= [userDefaults objectForKey:@"saveDtotal"];
    NSLog(@"Your Dtotal: %@",dtotal);

    //checking if data in user defaults is not empty
    if(dcountString.length>0)
    {
        dcounter=[dcountString intValue];
        dcount.text = [NSString stringWithFormat:@"%d",dcounter];

    }
    else
    {
        //for first time
        dcounter=0;
        dcount.text=@"0";
    }

    if(dtotalString.length>0)
    {
        dtotaler=[dtotalString intValue];
        dtotal.text = [NSString stringWithFormat:@"%d",dtotaler];
    }
    else
    {
        //for first time
        dtotaler=0;
        dtotal.text=@"0";
    }
} 
```

未保存的 UILabel / 字符串是“dtotal”。

任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T02:21:18.690

我找到了解决方案。

```
-(IBAction)addtotal1;{

float x = ([dcount.text floatValue]);
float y = ([dtotal.text floatValue]);
dtotaler = x + y;
dtotal.text = [NSString stringWithFormat:@"%d",dtotaler];
dcounter=0;
dcount.text = [NSString stringWithFormat:@"%i",dcounter];
NSUserDefaults *userDefaults=[NSUserDefaults standardUserDefaults];
[userDefaults setObject:[NSString stringWithFormat:@"%d",dtotaler] forKey:@"saveDtotal"];
[userDefaults setObject:[NSString stringWithFormat:@"%d",dcounter] forKey:@"saveDcount"];
[userDefaults synchronize]; 
```

感谢大家的意见。

# java - If 语句中的二维数组

> ID：15857706
> 
> 赞同：1
> 
> 时间：2013-04-07T00:56:14.210
> 
> 标签：java, arrays, methods, compiler-errors, boolean

我在 Java 中创建了一个存储座位号（行、列）的二维数组。我已经初始化了数组，以便所有值都以 0 开始，如果稍后使用另一种方法 Sit 占用座位，则该坐标处的值是 1。

这是初始化：

```
int[][] seatlist= new int[FIRSTCLASS/3][3];           

for (int i=0; i<= FIRSTCLASS/3; i++) 
     {  
        for (int j=0; j<3; j++) 
      { 
         seatlist[i][j]=0;

       }
    } 
```

这是我的方法：

```
public boolean canSit(int seatrow, int seatcolumn)
{ 
    if(seatlist[seatrow-1][seatcolumn-1]==0) 
    { 
        return true;
    } 
    else 
        return false; 
} 
```

当我尝试编译时，我在 if 语句行上不断收到“需要数组，但找到 int”错误。我无法确定问题 - 任何人都可以帮忙吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:00:55.660

试试这个。

```
Integer[][] seatlist= new Integer[FIRSTCLASS/3][3]; 
```

或者

```
int[FIRSTCLASS/3][3] seatlist; 
```

# node.js - Node.js 集群 + 集体

> ID：15857708
> 
> 赞同：0
> 
> 时间：2013-04-07T00:56:20.610
> 
> 标签：node.js, tcp

我已将问题提交到 [github repo](https://github.com/arch1t3ct/collective.js/issues/3)，以便在那里进行跟踪！

我正在运行一个集群应用程序，它可以在具有 N 个内核的机器上。假设我在本地运行 2 个应用程序实例进行测试，实际上模拟了 2 个不同的盒子。因此，使用该模块的 N 台机器上的 N 个内核`cluster`（实际上，N 台机器是静态的，例如，仅在 AWS 负载均衡器后面 2 个）。

1.  如何为此正确配置[collective.js](https://github.com/arch1t3ct/collective.js) “all_hosts”选项？我会`process.id`以某种方式与 IP 一起使用吗？

运行代码片段将类似于 2 个 bash 终端：

*1号航站楼*：

`coffee cluster1`

*2号航站楼*：

`coffee cluster2`

*注意：下面的代码有效，但实际上*并不有效，因为我不太清楚配置；每次我记录数据时，它都是特定于流程的。

**cluster1.coffee**：

```
cluster = require 'cluster'
numCPUs = require('os').cpus().length

if cluster.isMaster

  i = 0 
  cluster.setupMaster 
    exec: './server1'

  console.log "App 1 clustering with: #{numCPUs} clusters"

  while i < numCPUs
    cluster.fork()
    i++

  cluster.on 'fork', (worker) ->
    console.log 'Forked App 1 server worker ' + worker.process.pid 
```

**server1.coffee**：

```
Collective = require 'collective'

all_hosts = [
    host: 'localhost', port: 8124 # Wrong
]

collective = new Collective(
  host: 'localhost'
  port: 8124
, all_hosts, (collective) ->

)

collectiveUpsert = () ->

  num = Math.floor((Math.random()*10000)+1)

  data = 
    num: num

  console.log process.pid + ' sees current num as: ' + JSON.stringify(collective.get('foo.bar'))
  console.log process.pid + ' setting num to: ' + JSON.stringify(data)

  collective.set 'foo.bar', data

setInterval (->
  collectiveUpsert()
), 5 * 1000 
```

**cluster2.coffee**：

```
cluster = require 'cluster'
numCPUs = require('os').cpus().length

if cluster.isMaster

  i = 0 
  cluster.setupMaster 
    exec: './server2'

  console.log "App 2 clustering with: #{numCPUs} clusters"

  while i < numCPUs
    cluster.fork()
    i++

  cluster.on 'fork', (worker) ->
    console.log 'Forked App 2 server worker ' + worker.process.pid 
```

**server2.coffee**：

```
Collective = require 'collective'

all_hosts = [
    host: 'localhost', port: 8124 # Wrong
]

collective = new Collective(
  host: 'localhost'
  port: 8124
, all_hosts, (collective) ->

)

collectiveUpsert = () ->

  num = Math.floor((Math.random()*10000)+1)

  data = 
    num: num

  console.log process.pid + ' sees current num as: ' + JSON.stringify(collective.get('foo.bar'))
  console.log process.pid + ' setting num to: ' + JSON.stringify(data)

  collective.set 'foo.bar', data

setInterval (->
  collectiveUpsert()
), 5 * 1000 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T09:19:12.847

为了在和/或多个服务器上使用[collective.js](https://github.com/arch1t3ct/collective.js)，`cluster`您需要在每个Node.js 子进程上启动它。将其视为一个`http`模块，您必须在每个子/从属设备上创建侦听器，而不是在主设备上创建侦听器（[http://nodejs.org/api/cluster.html#cluster_cluster](http://nodejs.org/api/cluster.html#cluster_cluster)）。按照类似的逻辑，对于collective.js，你应该做这样的事情（单服务器）：

```
if (cluster.isMaster) {
    // fork n children
} else {
    var current_host = {host: "localhost", port: 10000};
    current_host.port += cluster.worker.id; // this is incremented for every new process.

    var all_hosts = [
        {"host": "localhost", "port": 10001},
        {"host": "localhost", "port": 10002},
        {"host": "localhost", "port": 10003},
        {"host": "localhost", "port": 10004},
        {"host": "localhost", "port": 10005},
        {"host": "localhost", "port": 10006}
        // must be the same amount as is the child process count.
    ];

    var collective = new modules.collective(current_host, all_hosts, function (collective) {
        // Do your usual stuff. Start http listener, etc...
    });
} 
```

如果您想在不同的服务器上使用它，您应该将*localhost*修改为您的 IP 地址并确保端口正确增加。

[有关任何其他信息，您可以在test/index.js](https://github.com/arch1t3ct/collective.js/blob/master/test/index.js)查看粗略测试

希望有帮助！如果您需要任何进一步的帮助 - 请询问。

PS 诚然，这种方式比较繁琐，需要更清晰的解释。我希望在不久的将来找出一个更清洁、更容易的初始化过程。除此之外，澄清自述文件并提供一些完整的示例。

# php - 有可能把它放在一个循环中吗？

> ID：15857710
> 
> 赞同：0
> 
> 时间：2013-04-07T00:56:34.417
> 
> 标签：php, loops, mysqli

有没有可能把它放在一个循环中？

```
if (!empty($_POST["textDE"])) {
    $mysqli = $connect->prepare("INSERT INTO `l10n-strings` (`translationID`, `languageCode`, `text`) VALUES (?, ?, ?)");
    $mysqli->bind_param('iss', $l10id, $languageCodeDE, $textDE);
    $mysqli->execute();
}

if (!empty($_POST["textEN"])) {
    $mysqli = $connect->prepare("INSERT INTO `l10n-strings` (`translationID`, `languageCode`, `text`) VALUES (?, ?, ?)");
    $mysqli->bind_param('iss', $l10id, $languageCodeEN, $textEN);
    $mysqli->execute();
}

if (!empty($_POST["textES"])) {
    $mysqli = $connect->prepare("INSERT INTO `l10n-strings` (`translationID`, `languageCode`, `text`) VALUES (?, ?, ?)");
    $mysqli->bind_param('iss', $l10id, $languageCodeES, $textES);
    $mysqli->execute();
}

if (!empty($_POST["textFR"])) {
    $mysqli = $connect->prepare("INSERT INTO `l10n-strings` (`translationID`, `languageCode`, `text`) VALUES (?, ?, ?)");
    $mysqli->bind_param('iss', $l10id, $languageCodeFR, $textFR);
    $mysqli->execute();
}

if (!empty($_POST["textIT"])) {
    $mysqli = $connect->prepare("INSERT INTO `l10n-strings` (`translationID`, `languageCode`, `text`) VALUES (?, ?, ?)");
    $mysqli->bind_param('iss', $l10id, $languageCodeIT, $textIT);
    $mysqli->execute();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T01:02:05.190

```
$languages = array('DE', 'EN', 'ES', 'FR', 'IT');

foreach ($languages as $lang) {
    $langKey = 'text' . $lang;
    if (!empty($_POST[$langKey])) {
        $mysqli = $connect->prepare(
            "INSERT INTO `l10n-strings` (`translationID`, `languageCode`, `text`) ".
            "VALUES (?, ?, ?)"
        );
        $mysqli->bind_param(
            'iss',
            $l10id,
            ${'languageCode'.$lang},
            ${$langKey}
        );
        $mysqli->execute();
    }
} 
```

[变量变量](http://php.net/manual/en/language.variables.variable.php)通过查找数组使这更容易。

还要[在你的 PHP 配置中禁用注册全局变量](http://www.php.net/ini.core.php#ini.register-globals)，这是一个安全问题。

# c++ - 使用哪种 STL 结构？

> ID：15857713
> 
> 赞同：0
> 
> 时间：2013-04-07T00:57:16.807
> 
> 标签：c++, stl, containers

我需要一个解决方案，它将存储一个非唯一的键值对。我不想重复键（空间效率），我想专注于查找速度（插入新数据的效率不太重要）。我将在这里使用 std::multimap 。但我将不得不查找符合某些范围标准的键。

最复杂的例子：键是字符串，值不重要。我想找出所有值，哪些键以“Lol”开头。或者我想找出所有值，哪些键“介于”“bar”和“foo”之间。

我可以用多图来做吗？我的第二个想法是使用排序向量，它将指向值向量。像这样的东西：

```
std::vector<std::string, std::vector<T>> sorted_vec; 
```

然后我可以轻松满足搜索条件。但我真的很关心查找的性能。这是一个正确的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T03:28:50.757

是的，您可以使用 std::multimap。为了完成您的范围基查询，您可以在头文件算法中使用两种算法 std::lower_bound 和 std::upper_bound 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T02:46:45.920

> 或者我想找出所有值，哪些键“介于”“bar”和“foo”之间。

如果你有 Boost，我建议使用[boost::flat_map](http://www.boost.org/doc/libs/1_53_0/doc/html/boost/container/flat_map.html)（它只是标头库）——它[在](https://stackoverflow.com/a/13105343/1762344). 通常，由于更好的紧凑性/局部性，它比**std::map具有更好的查找。**

否则使用

```
vector<pair<string,value>>
or
vector<pair<string,vector<value>>> //(for re-use of keys)
// instead of pair, you may use just struct if you concerned with lexicographical compare 
```

加上[std::sort](http://en.cppreference.com/w/cpp/algorithm/sort)

加上 std:: [equal_range](http://en.cppreference.com/w/cpp/algorithm/equal_range) / [lower_bound](http://en.cppreference.com/w/cpp/algorithm/lower_bound)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-07T02:51:50.960

您应该使用[Patricia trie](http://en.wikipedia.org/wiki/Radix_tree)。

[libstdc++ 中](http://gcc.gnu.org/onlinedocs/libstdc++/ext/pb_ds/trie_based_containers.html)有一个，尽管它是非标准的。

如果您要坚持使用标准容器，我认为您的排序矢量解决方案是最好的。

# javascript - 是否可以为显示在画布上的图像创建淡入效果？

> ID：15857717
> 
> 赞同：0
> 
> 时间：2013-04-07T00:57:37.940
> 
> 标签：javascript, jquery, html, canvas, html5-canvas

当用户与画布上的对象交互时，我有一个图像（箭头）。此图像（箭头）告诉用户将对象拖动到哪个方向。是否可以为图像创建淡入效果？

这是代码

```
 var curvedArrow = new Image();
    curvedArrow.src = "img/curvedArrow.png";
// curvedArrow.onload = function() {
        context.drawImage(curvedArrow, 15, 45, 35, 30);
//  }; 
```

注意：我在没有 onload 的情况下调用 drawImage()，因为如果我在 onload 中调用 drawImage，图像不会显示在画布上

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:05:11.400

`src`在侦听器之后设置`.onload`，这样它无论如何都会触发。

```
 var curvedArrow = new Image();
   curvedArrow.addEventListener('load', function() {
        context.drawImage(curvedArrow, 15, 45, 35, 30);
   });
   curvedArrow.src = "img/curvedArrow.png"; 
```

然后您可以使用间隔和[globalAlpha](http://www.html5canvastutorials.com/advanced/html5-canvas-global-alpha-tutorial/)淡入图像：

```
 var curvedArrow = new Image();
   curvedArrow.addEventListener('load', function() {
        context.globalAlpha = 0;
        var imgFadeInter = setInterval(function(){
           clearContext(); // a function that clears the canvas
           context.globalAlpha += 0.01;
           context.drawImage(curvedArrow, 15, 45, 35, 30);
           if(context.globalAlpha == 1){ 
               clearInterval(imgFadeInter); 
           }
        }, 16); // 16ms because jQuery says so         
   });
   curvedArrow.src = "img/curvedArrow.png"; 
```

# r - 按标签子集 igraph 图

> ID：15857718
> 
> 赞同：16
> 
> 时间：2013-04-07T00:57:40.913
> 
> 标签：r, igraph

我正在尝试通过边缘特征（如其标签）对 igraph 图进行子集化。在可重现的示例中，我无耻地从另一个帖子中窃取了一些修改，我希望能够将最好的朋友关系 (BF) 与家庭关系 (FAM) 分开：

```
edges <- matrix(c(103, 86, 24, 103, 103, 2, 92, 103, 87, 103, 103, 101, 103, 44), ncol=2, byrow=T)
g <- graph(as.vector(t(edges)))
E(g)[c(2:4,7)]$label<-"FAM"
E(g)[c(1,5,6)]$label<-"BF" 
```

到目前为止，我能做的最好的事情是显示具有一种领带的边缘：

```
E(g)[E(g)$label=="BF"]
V(g)[E(g)$label=="BF"] 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-04-07T17:10:05.133

怎么样：

```
gfam <- subgraph.edges(graph=g, eids=which(E(g)$label=="FAM"), delete.vertices = TRUE)
gbf <- subgraph.edges(graph=g, eids=which(E(g)$label=="BF"), delete.vertices = TRUE) 
```

igraph/网络分析教程/无耻插件的建议： http: [//sna.stanford.edu/rlabs.php](http://sna.stanford.edu/rlabs.php)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-04-07T18:04:35.637

我建议您阅读`?V`并`?E`了解如何选择边和顶点。您的问题的一个非常紧凑且可读的解决方案是

```
subgraph.edges(g, E(g)[label=="FAM"])
subgraph.edges(g, E(g)[label=="BF"]) 
```

如果顶点没有指定标签的入射边，这也会删除顶点。详情请参阅`?subgraph.edges`。

# c++ - 重载新的类

> ID：15857720
> 
> 赞同：2
> 
> 时间：2013-04-07T00:57:47.273
> 
> 标签：c++, memory-management

我可以在 MyClass 的头文件中声明如下：

```
void* operator new(size_t size) throw(bad_alloc); 
```

并在 MyClass 源文件中定义：

```
void* MyClass::operator new(size_t size) throw(bad_alloc)
{
    cout << "overloading new" << endl;
    return (::operator new(size));
} 
```

并使用它：

```
MyClass *m = new MyClass(); 
```

所以我的问题是 - 在上面的代码行中我们使用重载的 new 运算符 - 我看不到我们将 size_t 类型的 size 参数传递给重载的 new 运算符？然而在重载 new 运算符的定义中它需要它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-07T01:13:10.310

**简短回答** 根据使用 new 运算符创建的对象的大小，从编译器推断出大小。

**例子**

```
struct Example {
    int X;
    int Y;
}

Example *A = new Example(); 
```

将调用参数大小等于 8（x64 系统上为 16）的新运算符/函数，它也可以或多或少取决于对齐方式。

新调用将从编译器转换如下（如果构造函数中没有使用异常并且编译器决定优化不需要的 catch 块的捕获）：

```
Example *A = (Example*)Example::new(sizeof(Example));
A->A(); // call constructor 
```

# c++ - 将 char32_t 打印到控制台

> ID：15857721
> 
> 赞同：3
> 
> 时间：2013-04-07T00:57:59.693
> 
> 标签：c++, unicode, c++11, utf-32

如何在 C++11 中将( `cout`/ / ...) char32_t 打印到控制台？`wcout`

以下代码打印十六进制值：

```
u32string s2 = U"Добрый день";
for(auto x:s2){
    wcout<<(char32_t)x<<endl;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-07T01:29:38.503

首先，我认为除了and之外不`wcout`应该打印任何字符。也不是。`char``wchar_t``char32_t`

这是一个打印 individual 的示例程序`wchar_t's`：

```
#include <iostream>

using namespace std;

int main()
{
  wcout << (wchar_t)0x41 << endl;
  return 0;
} 
```

输出（[ideone](http://ideone.com/8zMKg0)）：

```
A 
```

目前，即使在主要操作系统中，也不可能在控制台中获得一致的 Unicode 输出。`cout`通过, `wcout`,`printf()`等简单的Unicode 文本输出`wprintf()`在没有重大黑客攻击的情况下无法在 Windows 上运行。在 Windows 控制台中获取可读的 Unicode 文本的问题在于拥有并且能够选择正确的 Unicode 字体。Windows 的控制台在这方面非常糟糕。请参阅[我的这个答案](https://stackoverflow.com/a/12652946/968261)并点击其中的链接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-06-19T22:44:41.647

# mysql - 我的 SQL Count() 0 只有 1 个表

> ID：15857724
> 
> 赞同：0
> 
> 时间：2013-04-07T00:58:30.560
> 
> 标签：mysql

因此，我已经看到使用多个表完成了此操作，但对如何使用多个表感到困惑。我想选择锦标赛中正确参赛的数量。这有效，除非用户没有正确。然后它返回 NULL。我希望它返回 0。

```
Table-tournament_entries

Column  
=============       
id      
tournament_id           
game_id 
user_id 
username    
prediction      
correct 
```

这是我运行的查询，我希望返回所有用户，即使是那些没有正确回答问题的用户。

```
SELECT 
  tournament_id, username, user_id, COUNT(`prediction`)
FROM 
  tournament_entries
WHERE 
  correct = 1 AND tournament_id = 1
GROUP BY 
  username
ORDER BY 
  COUNT(`prediction`) DESC
LIMIT 0,10 
```

编辑：对不起所有的混乱，所以当我运行我的查询时，我得到了这个

```
username    user_id     CorrectAns
mj          455              10
charlie     1                8
bill        2                8
doug        51               7 
```

但也有未显示的用户获得了 0 的权利。当我运行建议的查询时，我会收到问题的数量。

```
username    user_id     CorrectAns
mj          455              16
charlie     1                16
bill        2                16
doug        51               16
sydney      452              16
Joe         218              16 
```

如果您注意到 sydney 和 joe 不在第一个输出中，而是在第二个输出中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:03:24.373

使用此查询：

```
$query ="SELECT tournament_id, username, user_id, COALESCE(COUNT(`prediction`),0) as cpred
FROM tournament_entries
WHERE tournament_id = 1
GROUP BY username
ORDER BY cpred DESC
LIMIT 0,10" 
```

[`COALESCE`](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#function_coalesce)将返回给它的第一个非空参数。

干杯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T01:26:37.513

根据您对另一个答案的评论，我认为您真正要寻找的是这样的（尽管如果没有样本数据和输出很难确定）：

```
SELECT 
  username, user_id, Sum(correct) As TotalCorrect
FROM 
  tournament_entries
WHERE 
  tournament_id = 1
GROUP BY 
  username, user_id
ORDER BY 
  TotalCorrect DESC
LIMIT 0,10 
```

# wpf - 选择禁用的 ListBox 项时显示禁用的原因

> ID：15857725
> 
> 赞同：0
> 
> 时间：2013-04-07T00:58:31.757
> 
> 标签：wpf, listbox, wpf-4.5

我有一个`ListBox`不应选择的项目，因为它们已被禁用。我通过绑定`IsEnabled`禁用该项目的属性来实现这一点。但是，我需要能够显示一个弹出窗口，显示当用户单击禁用项目时它被禁用的原因。完成这样的事情的最佳实践是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T13:29:53.323

你可以这样做：

在 listBox 上方创建一个隐藏的透明控件。当列表框变得不可见时，使此控件可见。在此控件上注册到 MouseDown，它将显示弹出窗口等...

# c - 静态变量和线程 (C)

> ID：15857732
> 
> 赞同：15
> 
> 时间：2013-04-07T00:59:47.047
> 
> 标签：c, multithreading, concurrency, static, mutual-exclusion

我知道在 C 中的函数内声明一个静态变量意味着该变量在函数调用之间保持其状态。*在线程的上下文中，这会导致变量在多个线程上保持其状态，还是在每个线程之间*具有单独的状态？

这是我正在努力回答的过去的纸质考试问题：

> **以下 C 函数旨在用于为其调用者分配唯一标识符 (UID)：**
> 
> ```
> get_uid() 
> {
> static int i = 0;
> return i++;
> } 
> ```
> 
> **解释 get_uid() 在被多个线程调用的环境中以何种方式可能无法正常工作。使用特定的示例场景，详细说明为什么以及如何可能会发生这种不正确的行为。**

目前我假设每个线程都有一个单独的变量状态，但我不确定这是否正确，或者答案是否更多地与缺乏互斥有关。如果是这样的话，那么在这个例子中如何实现信号量呢？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-07T01:08:17.717

您的假设（线程有自己的副本）不正确。代码的主要问题是当多个线程调用该函数时`get_uid()`，可能存在 关于哪些线程递增并获取可能不唯一的 ID的*竞争条件。*`i`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-07T01:18:36.860

一个进程的所有线程共享相同的地址空间。由于`i`是一个静态变量，它有一个固定的地址。它的“状态”只是该地址的内存内容，由所有线程共享。

后缀`++`运算符递增其参数并在递增之前产生参数的值。这些完成的顺序没有定义。一种可能的实现是

```
copy i to R1
copy R1 to R2
increment R2
copy R2 to i
return R1 
```

如果有多个线程在运行，它们可以同时或穿插执行这些指令。为自己制定获得各种结果的序列。（请注意，每个线程都有自己的寄存器状态，即使对于在同一 CPU 上运行的线程也是如此，因为在切换线程时会保存和恢复寄存器。）

这种根据不同线程中操作的不确定顺序而产生不同结果的情况称为*竞争条件*，因为不同线程之间存在“竞争”，即哪个线程先执行哪个操作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-07T01:03:21.983

不，如果你想要一个值取决于使用它的线程的变量，你应该看看[Thread Local Storage。](http://en.wikipedia.org/wiki/Thread-local_storage)

一个静态变量，你可以想象它真的像一个完全全局的变量。真的很相似。所以它由知道其地址的整个系统共享。

**编辑**：同样作为评论提醒它，如果您将此实现保留为静态变量，竞争条件可能会使该值`i`同时由多个线程递增，这意味着您不知道该值将由函数调用返回。在这种情况下，您应该通过所谓的同步对象（如[互斥锁](http://en.wikipedia.org/wiki/Mutual_exclusion)或[临界区](http://en.wikipedia.org/wiki/Critical_sections)）来保护访问。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-07T01:04:09.817

由于这看起来像家庭作业，我将只回答其中的一部分，即每个线程将共享相同的`i`. IOW，线程没有自己的副本。我将把互斥位留给你。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-07T01:14:29.753

每个线程将共享相同的静态变量，这很可能是一个全局变量。某些线程可能具有错误值的情况是竞争条件（增量不是在一次执行中完成，而是在 3 个汇编指令中完成，加载、增量、存储）。阅读此处，链接中的图表很好地解释了它。

[比赛条件](http://kloobok.com/index.php?option=com_content&view=article&id=114&Itemid=165)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-08-06T21:10:07.753

如果您使用 gcc，则可以使用[atomic 内置](https://gcc.gnu.org/onlinedocs/gcc/_005f_005fatomic-Builtins.html)函数。我不确定其他编译器有什么可用的。

```
int get_uid() 
{
    static int i = 0;
    return __atomic_fetch_add(&i, 1, __ATOMIC_SEQ_CST);
} 
```

这将确保变量一次不能被多个线程操作。

# function - PHP - 调用未定义的方法数据库::real_escape_string()

> ID：15857733
> 
> 赞同：0
> 
> 时间：2013-04-07T00:59:48.747
> 
> 标签：function, call, undefined

我已经搜索并尝试了 Stakeoverflow 向我提出的所有建议，但没有一个对我有用。我有 2 个 php 文件（add_new_page.php、sanitise.php）我在“sanitise.php”函数“escape”上收到此错误。

> PHP - 调用未定义的方法数据库::real_escape_string()

我似乎无法找出我在函数转义中做错了什么。任何帮助将不胜感激。我的最后期限非常接近，我需要尽快完成这项工作。以下是我的 2 个工作文件的代码。

**数据库连接**

```
$db = new database($db_host, $db_user, $db_pass, $db_name); 
```

**add_new_page.php**

```
require_once "../classes/classes.php"; 
if(isset($_POST["txtpagetitle"])){
    $txtpagetitle = $_POST["txtpagetitle"];
    $txtbrowsertitle = $_POST["txtbrowsertitle"];
    $txtpagecontent = $_POST["txtpagecontent"];

    $txtpagetitle       = trimmer($txtpagetitle);
    $txtbrowsertitle    = trimmer($txtbrowsertitle);
    $txtbrowsertitle    = trimmer($txtbrowsertitle);

    $txtpagetitle       = escape($txtpagetitle, $db);//Calling escape function
    $txtbrowsertitle    = escape($txtbrowsertitle, $db);//Calling escape function
    $txtbrowsertitle    = escape($txtbrowsertitle, $db);//Calling escape function

    $txtpagetitle_required = required($txtpagetitle);
    $txtbrowsertitle_required = required($txtbrowsertitle);

        if($txtpagetitle_required == false){
            echo "Page Title is required...";
            return false;
        }       
} 
```

**清理.php**

```
// Escape all characeters - I' am getting the error here...
    function escape($field){
        global $db;
        return $db->real_escape_string($field);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:10:35.520

“数据库”类型不包含名为“real_escape_string”的函数。我有一个理论，你正在使用它，因为你已经习惯了 MySQLi，它有一个函数 $db->real_escape_string()。也许您的（或编写它的人）“数据库”类具有不同名称的等效函数。否则，$db 中没有 real_escape_string 函数可以调用。

# mysql - mySQL ORDER BY 使用外键

> ID：15857735
> 
> 赞同：1
> 
> 时间：2013-04-07T01:00:11.577
> 
> 标签：mysql, foreign-keys

我本质上想通过外键条目的列对特定的查询结果进行排序。这是我的表：

```
class
------
classId
profId    //Points to a profId from professor table
courseId  //Points to a specific courseId from course table
semId     //Points to a specific semId from semester table

professor
---------
profId
first   //first name
last    //last name

course
------
courseId
department //The `CMSC` in CMSC101
number    //The `101` in CMSC101
title    

semester
--------
semId
season  //example: Spring, Summer, Fall
year 
```

我希望它们按层次排序，但也按类列的列中的外键排序。所以，我会`SELECT`从所有条目`class`中按以下顺序对它们进行排序：

1.  课程 -> 部门
2.  课程 -> 号码
3.  课程 -> 部分
4.  教授->最后
5.  教授->第一
6.  学期 -> 年
7.  学期 -> 季节

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T01:11:16.780

啊，这比之前发布的问题更有意义。您首先需要将所有表连接在一起，然后您可以排序：

```
SELECT
  Course.Department,
  Course.Number,
  Course.Section,
  Professor.Last,
  Professor.First,
  Semester.Year,
  Semester.Season
FROM Class
INNER JOIN Course ON Class.CourseID = Course.CourseID
INNER JOIN Professor ON Class.ProfID = Professor.ProfID
INNER JOIN Semester ON Class.SemID = Semester.SemID
ORDER BY
  Course.Department,
  Course.Number,
  Course.Section,
  Professor.Last,
  Professor.First,
  Semester.Year,
  Semester.Season 
```

这些列不必*在*列表中`SELECT`以便您按它们排序，但在大多数情况下，将它们包含在其中是有意义的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-07T01:13:28.117

假设在所有表上连接，为什么不只是

按 COL1、COL2、...COLN 排序

执行联接时，您将有权访问每个联接表中的所有列。示例： [http ://sqlfiddle.com/#!2/30e14/1](http://sqlfiddle.com/#!2/30e14/1)

# mysql - 使用索引或触发器来确保唯一性

> ID：15857738
> 
> 赞同：0
> 
> 时间：2013-04-07T01:00:37.023
> 
> 标签：mysql, sql

我有一个表，其中包含 3 个主键（我们称它们为 FirstName、SecondName、VersionID）和一个数据列（EmailAddress）。

我想确保在插入数据时，数据列对于前两列中的任何一列都是唯一的。

即，任何电子邮件地址对于 FirstName、SecondName 的任何组合都是唯一的。然而，同一个 EmailAddress 的多个值可以具有相同的 FirstName 和 SecondName 但不同的 versionID。

我最初的想法是在这些列上创建一个索引以确保唯一性，但我无法完全弄清楚如何做到这一点......然后我考虑了触发器，但我不确定如何构建它们。

什么是最有效的方法，我将如何进行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:09:27.190

```
# firstname, secondname & emailaddress together must be unique
ALTER TABLE mytable
ADD CONSTRAINT ux_email_firstname_secondname_versionid
UNIQUE (firstname, secondname, emailaddress);

# emailaddress and versionid together must be unique
ALTER TABLE mytable
ADD CONTRAINT ex_emailaddress_versionid
UNIQUE (emailaddress, versionid); 
```

类似的东西使三列的组合独一无二，但如果一个变化它不再是一个相似的匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T01:09:59.873

多个唯一约束：

```
ALTER TABLE your_table
  ADD CONSTRAINT constraint_name_name UNIQUE (FirstName, SecondName, versionID , EmailAddress) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-07T01:50:12.967

对于你所说的，我会抛出任何关于触发器的想法。根据您上面的评论，您只需要对电子邮件地址进行唯一约束。

```
ALTER TABLE Table_Name
  ADD CONSTRAINT constraint_name UNIQUE (EmailAddress) 
```

我建议不要这样做，因为用户可能输入错误的电子邮件地址，这会阻止其他用户正确输入他们的电子邮件地址。

最好的办法是使用@TheEwook 编写的查询：

> 多个唯一约束：
> 
> ALTER TABLE your_table ADD CONSTRAINT constraint_name_name UNIQUE (FirstName, SecondName, versionID , EmailAddress) 共享|编辑

如果您担心有 2 个用户尝试使用相同的电子邮件地址，那么您可能希望在插入时通过检查每个用户的最大版本来处理该问题，并将该电子邮件与插入的电子邮件进行比较.

# vim - 在 macvim 中触发全屏模式

> ID：15857743
> 
> 赞同：2
> 
> 时间：2013-04-07T01:01:53.587
> 
> 标签：vim, triggers, fullscreen, macvim

在 MacVim 中自动进入全屏模式时，我想设置一些属性。例如切换行号、设置列等。

是否可以在 MacVim 中触发全屏模式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T01:11:16.077

不幸的是，没有全屏[autocmd](http://vimdoc.sourceforge.net/htmldoc/autocmd.html#autocommand-events)。我过去为这类事情所做的就是拥有一个`ToggleFullScreen()`按我想要的方式设置事物的功能，并在我再次切换时撤消它们。我通常会为这类事情设置一个映射，或者至少是一个名称较短的命令。

# python - 用python解析代码

> ID：15857746
> 
> 赞同：0
> 
> 时间：2013-04-07T01:02:54.140
> 
> 标签：python, regex, parsing, fortran

我对python真的很陌生。所以请原谅我说的任何愚蠢的话

我有一个脚本，它逐行遍历 aa fortran 模块，然后在每一行上执行一个 .split() 并将其保存到一个数组中。但是 .split() 不包括换行符，无论如何我可以让它做到这一点。

另外，我的代码在 fortran 模块中的编写方式，大部分是

```
integer x, & !comment
        y, & !comment 
        z    !comment 
```

我不想包含任何评论文本。我只想要模块中的变量列表。无论如何使用 .split() 或正则表达式来实现这一点。也许只将子字符串带到 & 后跟逗号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:17:47.680

这样做的方法可能是使用缓冲区。

```
>>> s = """Some code with\n newlines and other stuff\n"""
>>> from StringIO import StringIO
>>> buffer = StringIO(s)
>>> list(buffer)
['Some code with\n', ' newlines and other stuff\n']
>>> 
```

*注意*：在 Python 3.x 中，替换`from StringIO import StringIO`为`from io import StringIO`.

# 然而...

我猜您正在使用 Python`file`对象从单独的文件中读取 FORTRAN 代码。`file`对象已经表现得像缓冲区。假设文件`whatever.f95`包含文本`Some code with\n newlines and other stuff\n`。然后你可以简单地做：

```
with open('whatever.f95') as f:
    print list(f) 
```

哪个会打印

```
['Some code with\n', ' newlines and other stuff\n'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T10:04:46.790

由于您使用的是“！” 要开始评论，我假设您使用的是 Fortran 90 或更高版本。

您可以使用正则表达式来查找变量声明。

这是一个查找`integer`变量的简单示例：

```
In [1]: import re

In [2]: integer_re = re.compile('[ ]*integer[^:]*::\s+(.+)')

In [3]: progtext = '''  program average

  ! Read in some numbers and take the average
  ! As written, if there are no data points, an average of zero is returned
  ! While this may not be desired behavior, it keeps this example simple

  implicit none

  real, dimension(:), allocatable :: points
  integer                         :: number_of_points
  real                            :: average_points=0., positive_average=0., negative_average=0.

  write (*,*) "Input number of points to average:"
  read  (*,*) number_of_points

  allocate (points(number_of_points))

  write (*,*) "Enter the points to average:"
  read  (*,*) points

  ! Take the average by summing points and dividing by number_of_points
  if (number_of_points > 0) average_points = sum(points) / number_of_points

  ! Now form average over positive and negative points only
  if (count(points > 0.) > 0) then
     positive_average = sum(points, points > 0.) / count(points > 0.)
  end if

  if (count(points < 0.) > 0) then
     negative_average = sum(points, points < 0.) / count(points < 0.)
  end if

  deallocate (points)

  ! Print result to terminal
  write (*,'(a,g12.4)') 'Average = ', average_points
  write (*,'(a,g12.4)') 'Average of positive points = ', positive_average
  write (*,'(a,g12.4)') 'Average of negative points = ', negative_average

  end program average'''

In [4]: integer_re = re.compile('[ ]*integer[^:]*::\s+(.+)')

In [5]: integer_re.findall(progtext)
Out[5]: ['number_of_points'] 
```

其他类型也可以这样做，例如 real：

```
In [6]: real_re = re.compile('[ ]*real[^:]*::\s+(.*)')

In [7]: real_re.findall(progtext)
Out[7]: ['average_points=0., positive_average=0., negative_average=0.'] 
```

您可以优化正则表达式以删除初始化程序并仅获取变量名称。但是拆分可能更容易。

```
In [8]: real_re.findall(progtext)[0].split()
Out[8]: ['average_points=0.,', 'positive_average=0.,', 'negative_average=0.'] 
```

或者您可以使用另一个正则表达式：

```
In [9]: re.findall('([a-z_]+)', real_re.findall(progtext)[0])
Out[9]: ['average_points', 'positive_average', 'negative_average'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-07T01:24:04.663

首先从 fortran 脚本中获取所有行的数组：

```
with open(fortran_script) as f:
    script = [i.strip() for i in f] 
```

这将为您提供所需的数组，每行（去掉'\n'）作为一个单独的元素。

然后，删除评论：

```
for i, line in enumerate(script):
        script[i] = line[:line.find('!')] if '!' in line else line 
```

这将执行以下操作： --> 遍历每一行，并测试它是否包含注释；--> 如果有注释，则截断该行以仅包含前面的命令

--- 编辑有人指出（见下面的评论）这不允许出现'！' 字符串内。为此，我们需要单独解析每一行并维护我们所处的“状态”的内存（即`is_literal`）：

```
output = []
def parse_fortran(script, output):
    for line in script:

        # flag to maintain state is_literal
        is_literal = False

        line_out = ''
        for c in line:

            # enter is_literal state if ' or " found
            if c == '"' or "'":
                is_literal = not is_literal

            # break to next line as soon as comment is reached
            elif c == '!' and not is_literal: 
                break

            # otherwise, add the statement to the output
            line_out += c
        output.append(line_out) 
```

希望这可以帮助

# node.js - 如何从流星访问 node.js 的文件系统？

> ID：15857749
> 
> 赞同：0
> 
> 时间：2013-04-07T01:03:18.773
> 
> 标签：node.js, meteor, fs

我对流星和 node.js 真的很陌生，我认为它真的很棒！

所以我遇到的问题是我无法从流星访问节点的文件系统模块。在 stackoverflow 上，其他用户报告说他们使用

```
var require = __meteor_bootstrap__.require;
var fs = require('fs'); 
```

但是，当我调用它时，我收到此错误：

> 类型错误：未定义不是函数

我遵循了[这个问题的答案](https://stackoverflow.com/questions/10437783/access-node-js-file-system-module-in-meteor)，我不知道从这里做什么。我确保上面的代码位于服务器的启动部分。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-07T03:47:33.823

从 Meteor 0.6.0 开始，它将是：

```
var fs = Npm.require("fs"); 
```

# android - Android：“TextView 不支持文本选择。动作模式已取消”

> ID：15857755
> 
> 赞同：13
> 
> 时间：2013-04-07T01:03:35.947
> 
> 标签：android

“TextView 不支持文本选择。操作模式已取消。”

当我尝试在 Android 的 PopupWindow 中的 EditText 中调出上下文菜单时出现此错误。选择标记也不起作用。

这个问题被问了很多次，但一直没有答案：

[如何在 PopupWindow 中启用 EditText 的选择标记？](https://stackoverflow.com/questions/8035159/how-to-enable-selection-markers-for-edittext-in-popupwindow)

[PopupWindow 不会在 EditText 长按上触发系统上下文对话框](https://stackoverflow.com/questions/13248581/popupwindow-not-triggering-sytem-context-dialog-on-edittext-long-press)

我只是处理同样问题的另一个人。有任何想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2016-01-26T12:23:31.773

我检查了大约一小时，我找到了解决方案：setwidth = wrapcontent（它正在与我一起工作）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-07T01:07:38.963

如果`TextView`，你试过`textView.setTextIsSelectable(true);` 或者如果`EditText`，`editText.setSelectAllOnFocus(true);`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-20T00:29:48.223

我相信这是一个 Android 错误，我只是这样报告它：[https ://code.google.com/p/android/issues/detail?id=62508](https://code.google.com/p/android/issues/detail?id=62508)

我们将看看谷歌是否同意。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-11-07T08:46:10.967

尝试

```
et.setTextIsSelectable(true);
et.setFocusable(true);
et.setFocusableInTouchMode(true); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-04-26T12:28:55.890

检查你是否有

`android:focusable="false"`或者

`android:focusableInTouchMode="false"`在您的`xml`布局中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-08T12:20:03.780

我用[DialogFragment](http://developer.android.com/reference/android/app/DialogFragment.html)替换了 PopupWindow ，这解决了我的问题。你也可以试试。另外，我观察到 DialogFragment 更稳定，我推荐它而不是 PopupWindow。我在使用 PopupWindow 时遇到了多个问题，这些问题在我开始使用 DialogFragment 时得到了修复。

我没有设置 selectAllOnFocus 属性。

# laravel - 如何在 Laravel 4 中模拟 Auth 类？

> ID：15857756
> 
> 赞同：3
> 
> 时间：2013-04-07T01:03:41.557
> 
> 标签：laravel, laravel-4

我试图让我的`AuthController`测试。我首先注入 Auth 类，以便在测试中模拟它：

```
public function __construct(Auth $auth)
{
    $this->auth = $auth;
} 
```

然后我稍后在检查登录是否成功时使用注入的类：

```
public function postLogin()
{
    // instead of Auth::attempt(Input::all())
    if ($this->auth->attempt(Input::all()) {
        return 'you are logged in!';
    } else {
        return 'login failed!';
    }
} 
```

当我提交我的登录表单时，我收到一个`Auth::attempt`未定义方法的错误：

```
FatalErrorException: Error: Call to undefined method Illuminate\Support\Facades\Auth::attempt() ... 
```

我究竟做错了什么？我在模型中看到了这种[精确的技术](http://www.youtube.com/watch?feature=player_detailpage&v=ajoFwWwSHTI#t=824s)，但显然它不适用于 Auth 类。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-07-11T20:22:10.357

当您使用`Auth`类时，您可以使用以下方法模拟它：

```
Auth::shouldReceive('attempt')->once()->andReturn(true) 
```

这样你`facade`就会被嘲笑！

希望能帮助到你！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-07T03:57:00.153

好吧，你可能在这里做错了......

# tl;博士

定义一个模拟身份验证适配器并配置身份验证以在测试中使用*它。*在控制器中使用 Auth 的静态方法就可以了。

# 为什么这有效...

Auth 包[实现了一个驱动程序（又名适配器）模式](http://laravel.com/docs/auth/config#driver)，其中 Auth 类充当整个包的依赖管理器和单例接口。与其尝试将模拟 Auth 实例注入控制器，不如实现模拟 Auth 适配器（如默认的 Eloquent 和 Fluent 适配器）。还可以尝试[将您的 Auth 配置为在测试中使用 In-Memory Adapter](http://laravel.com/docs/session/config#memory)。从手册页（对于懒惰的人）*强调*我的：

> 内存中的会话
> 
> “内存”会话驱动程序只使用一个简单的数组来存储当前请求的会话数据。**该驱动程序非常适合对您的应用程序进行单元测试，因为没有任何内容写入磁盘。**它不应该被用作“真正的”会话驱动程序。

内存适配器只是一个内存数组，由于您的测试与您的被测系统 (SUT) 共享线程，您可以从测试代码中自由检查会话内容，以验证身份验证的副作用并发布-条件。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-03-22T07:36:11.560

太棒了，我们可以为所有测试用例移动到 TestCase 类，我们可以给一个名字，像这样：

```
public function loginWithFakeUser()
{
      $user = new User([
        'id' => 1,
        'name' => 'yish'
      ]);

      $this->be($user);
} 
```

当我们需要经过身份验证的用户时，我们可以调用 loginWithFakeUser 来伪装用户。

这肯定会奏效。

谢谢，

# php - 加载 pdo_firebird.dll

> ID：15857757
> 
> 赞同：2
> 
> 时间：2013-04-07T01:03:46.660
> 
> 标签：php, windows, apache, pdo, firebird

我想运行 PHP 扩展，以便能够连接到 firebird 数据库。在 php.ini 中启用了行 extension=pdo_firebird.dll，并且该文件存在于其他扩展名的位置 - 在 /ext 目录中。每次我重新启动 Apache（和 PHP）时，我都看不到 phpinfo() 中加载的扩展。为什么？我正在使用 PHP 5.4 在 Windows 8 上运行 Apache 2.2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T06:49:14.197

您必须安装 fbclient 2.5.x 还请在 php.ini 中启用 php 错误报告

display_startup_errors 以便您可以看到 pdo_firebird.dll 的实际加载错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-22T00:26:08.043

将 fbclient.dll 和 gds32.dll 复制到 apache/bin/ 目录并重启 apache。这对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-12T21:09:38.090

就我而言，我设法解决了以下步骤：

第 1 步 - 确保您的 Firebird 安装正确，我使用的是 Firebird 2.5.2

第 2 步 - 转到 php 所在的文件夹。就我而言，它是： `C:\wamp64\bin\php\php7.0.10\`

第 3 步 - 打开`php.ini`文件并取消注释以下行：

评论前的例子：

`;extension = php_interbase.dll`

`;extension = php_pdo_firebird.dll`

取消注释后的示例：

`extension = php_interbase.dll`

`extension = php_pdo_firebird.dll`

保存，关闭文件，然后重新启动 apache。

如果它不起作用，请抓住接下来的步骤：

将以下 dll 复制`(fbclient.dll and gds32.dll)`到 apache 的 bin 文件夹中： `C:\wamp64\bin\apache\apache2.4.23\bin`

如果您没有这些 dll，您可以转到 Firebird 安装文件夹并从那里获取它。在我的情况下，完整的路径是这样的： `C:\Program Files\Firebird\Firebird_2_5\bin\fbclient.dll`

如果您没有看到此目录，您可以通过以下链接下载它们：

*   [https://www.azdll.net/files/fbclient-dll.html](https://www.azdll.net/files/fbclient-dll.html)
*   [https://www.azdll.net/files/gds32-dl​​l.html](https://www.azdll.net/files/gds32-dll.html)

然后只需复制到上面提到的目录，然后重新启动apache。

我建议使用管理器，因为它更容易并解决了一些问题。我在这里使用 Wampserver - 版本 3.0.6 - 64bit

对于最小的工作

# android - 从活动中删除片段

> ID：15857760
> 
> 赞同：42
> 
> 时间：2013-04-07T01:04:25.340
> 
> 标签：android

```
FragmantClass rSum = new FragmantClass();
getSupportFragmentManager().beginTransaction().remove(rSum).commit(); 
```

当我加载切换另一个片段时，我正在尝试删除此片段。上面的片段不会被删除。这是我调用来切换片段的方法。

```
public void switchContent(Fragment fragment) {
    FragmantClass rSum = new FragmantClass();
    getSupportFragmentManager().beginTransaction().remove(rSum).commit();
    mContent = fragment;
    getSupportFragmentManager()
        .beginTransaction()
        .replace(R.id.content_frame, fragment)
        .commit();
    getSlidingMenu().showContent();
} 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-04-07T01:52:23.550

```
getSupportFragmentManager().beginTransaction().
remove(getSupportFragmentManager().findFragmentById(R.id.frame)).commit(); 
```

试试这个，它应该工作。

```
public void switchContent(Fragment fragment) {
    getSupportFragmentManager().beginTransaction().
    remove(getSupportFragmentManager().findFragmentById(R.id.frame)).commit();
    mContent = fragment;
    getSupportFragmentManager()
        .beginTransaction()
        .replace(R.id.content_frame, fragment)
        .commit();
    getSlidingMenu().showContent();
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-03-22T16:24:40.683

就我个人而言，我以这种方式添加和删除片段：

```
 if(getSupportFragmentManager().findFragmentById(R.id.container) != null) {
        getSupportFragmentManager()
                .beginTransaction().
                remove(getSupportFragmentManager().findFragmentById(R.id.container)).commit();
    }
    getSupportFragmentManager()
            .beginTransaction()
            .replace(R.id.container, fragment)
            .commit(); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-09-23T18:58:35.517

这是一个非常简单的解决方案`SupportFragmentManager`。`FragmentManager`不是很方便，但仍然有效：

```
List<Fragment> fragmentList = getSupportFragmentManager().getFragments();
// You might have to access all the fragments by their tag,
// in which case just follow the line below to remove the fragment
if (fragmentList == null) {
    // code that handles no existing fragments
}

for (Fragment frag : fragmentList )
{
   // To save any of the fragments, add this check
   // a tag can be added as a third parameter to the fragment when you commit it
   if (frag.getTag().equals("<tag-name")) {
      continue;
   }

   getSupportFragmentManager().beginTransaction().remove(frag).commit();
} 
```

或者，如果您被迫使用它（但不推荐）：

```
.commitAllowingStateLoss(); 
```

如果您多次从视图中删除所有片段，您可能会考虑检查当前片段是否为 null 或`isDetached()`or ，`isRemoving()`或者您可能会得到一个`NullPointerExceptions`.

**更新 6-9-15：**的文档现在`getSupportFragmentManger().getFragments()`显然是[隐藏](https://code.google.com/p/doclava/wiki/JavadocTags#@hide)的，但在我的代码中仍然可以正常工作。这是文档的屏幕截图：

![在此处输入图像描述](https://i.stack.imgur.com/uyiu1.png)

**更新 8-3-15**：如果您不使用片段的支持库，很遗憾没有`getFragments()`可用的库，但仍有一些更不方便的选项。

1.  在创建时给每个`fragment`a`tag`或`id`，并遍历它们以`fragment`根据需要处理每个。
2.  创建一个侦听器`onAttachListener`，以便每次将新`fragment`的附加到 时`activity`，您可以存储它`fragment`，然后遍历该数据结构以`fragment`根据需要处理每个。

当不使用`getSupportFragmentManager()`, 来处理您需要使用的事务时`getFragmentManager()`。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-03-03T03:57:05.567

更简单的，你可以用一个空的fragment替换主要内容，这样就只看主要的activity了。

```
getFragmentManager()
.beginTransaction()
.replace(main_content,new Fragment())
.commit(); 
```

# port - Vagrant，VirtualBox - 找不到适配器？

> ID：15857766
> 
> 赞同：4
> 
> 时间：2013-04-07T01:05:00.810
> 
> 标签：port, virtualbox, vagrant, forwarding

输入“vagrant up”时获取以下日志转储。已经尝试过在 VirtualBox 上没有任何混乱，也尝试过手动添加端口转发规则（主机 IP 127.0.0.1，主机端口 2222，来宾端口 22）。

```
"Bringing machine 'polecat' up with 'virtualbox' provider...
[polecat] Setting the name of the VM...
[polecat] Clearing any previously set forwarded ports...
[polecat] Creating shared folders metadata...
[polecat] Clearing any previously set network interfaces...
[polecat] Preparing network interfaces based on configuration...
[polecat] Forwarding ports...
[polecat] -- 22 => 2222 (adapter 1)
The adapter to attach a forwarded port to was not found. Please
verify that the given adapter is setup on the machine as a NAT
interface.

Host port: 2222
Guest port: 22
Adapter: 1" 
```

谁能解释一下我到底该怎么做才能解决这个问题？遗憾的是，谷歌搜索并没有被证明是有用的，我项目中的其他用户似乎只是自动完成了这项工作！

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-08T11:58:18.433

VirtualBox 4.2.0 也有同样的问题。经过一段时间的研究，我将 VirtualBox 升级到了 4.2.10 版本。这为我解决了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-23T05:56:02.257

我有同样的问题，升级Vbox后它工作了！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-07T03:20:55.380

嗯，所以你要做的是转发端口，如果你想自动转发，你必须打开 NAT 服务让其他软件转发端口，但要做到这一点，你需要获得 root 和 ssh 访问权限' r bt hh2，您可以使用此网站 PsiDOC.com 来完成。但是，如果您不想做所有这些事情，您可以只在您的路由器上进行端口转发，并在您的 VirtualBox 上使用用户桥接适配器，但请记住，即使对于虚拟机，HH2 也总是创建单独的 ips。如果您在端口转发方面遇到任何问题，您可以使用 DMZ 功能[http://scr.hu/165/l26k8](http://scr.hu/165/l26k8)

# php - 使用数据文件恢复数据库

> ID：15857768
> 
> 赞同：1
> 
> 时间：2013-04-07T01:05:18.143
> 
> 标签：php, apache, wamp, database-backups

当我重新安装 apache 时，已经覆盖了 wamp bin 目录中的数据文件夹。有什么方法可以从以前的 apache 中检索我的数据。我有我的备份，它是一个“.data”文件。我要如何恢复它？请急需帮助。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T16:58:28.177

尝试使用此处解释的文件恢复程序：http: [//lifehacker.com/393084/how-to-recover-deleted-files-with-free-software](http://lifehacker.com/393084/how-to-recover-deleted-files-with-free-software) 只要您没有保存文件，您应该能够恢复它们。然后你必须把它们放回它们所属的地方。如果对文件结构没有很好的理解，这可能会很困难，而且由于您没有指定哪个数据库，因此我无法在这方面为您提供任何进一步的帮助。祝你好运！

# parsing - python文件解析查询

> ID：15857773
> 
> 赞同：-1
> 
> 时间：2013-04-07T01:06:03.193
> 
> 标签：parsing

我正在尝试解析一个文本文件，以便在三列中，第二列（高）和第三列（低）值转到两个不同的空字符串。但不幸的是，即使我尝试了无数次，我也无法让它工作。我的文本文件看起来像这样

```
Boston July Temperatures
-------------------------

Day High Low
------------

1 91 70
2 84 69
3 86 68
4 84 68
5 83 70
6 80 68
7 86 73
8 89 71
9 84 67
10 83 65 
```

这是我迄今为止尝试过的代码。

```
low_Temp=[]
high_Temp=[]
inFile = open('julyTemps.txt')
for line in inFile.readlines():
    fields = line.strip(' ')
    if len(fields) < 3 or not fields[0].isdigit():
        pass
    else:
        low_Temp.append(fields[2])
        high_Temp.append(fields[1])
print low_Temp
print high_Temp 
```

最后，我的目标是计算这些值之间的差异并绘制不同天数的差异。如果我能弄清楚为什么我在空向量中没有得到正确的值，我想我可以做那部分。

有人可以解释一下我做错了什么。提前致谢....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:11:16.287

您需要确保以通用模式打开文件，以考虑不同的行尾：

```
 inFile = open('julyTemps.txt', 'rU') # read universal 
```

然后，您的一般方法看起来不错。遍历文件对象而不是使用 readlines 更好，但是：

```
for line in inFile:
    line = line.strip() # remove newline characters
    fields = line.split(' ')

    if len(fields) == 3:
         _, high, low = fields
         high_Temp.append(float(high))
         low_Temp.append(float(low)) 
```

您当前的方法（或我在上面发布的方法）遇到的确切问题是什么？

# java - 拍照并保存到 SD 而不损失质量

> ID：15857777
> 
> 赞同：1
> 
> 时间：2013-04-07T01:06:53.560
> 
> 标签：java, android, camera, compression, photo

我有那个应用程序可以拍照并将其存储到 SD 卡中，但是我拍摄的每张照片都非常压缩且质量非常低。我以全质量压缩它，所以我不确定它为什么要这样做。有什么建议么？这是代码：

```
protected void takePhoto()
{
    Intent intent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
    startActivityForResult(intent, 0); 
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data){
    super.onActivityResult(requestCode, resultCode, data);
    currPhoto = (ImageView) findViewById(R.id.imageView1);

    if (requestCode== 0 && resultCode == Activity.RESULT_OK){
        Bitmap x = (Bitmap) data.getExtras().get("data");
        currPhoto.setImageBitmap(x);
        ContentValues values = new ContentValues();
        values.put(Images.Media.MIME_TYPE, "image/jpeg");
        Uri uri = getContentResolver().insert(Media.EXTERNAL_CONTENT_URI, values);
        OutputStream outstream;
        try {
            outstream = getContentResolver().openOutputStream(uri);

        x.compress(Bitmap.CompressFormat.JPEG, 90, outstream);
        outstream.close();
        } catch (FileNotFoundException e) {
            //
        }catch (IOException e){
            //
        }
    }
} 
```

编辑：事实上，它似乎只将缩略图保存到 SD。

![例子](https://i.stack.imgur.com/5bJhd.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:29:51.927

从[文档](http://developer.android.com/reference/android/provider/MediaStore.html#ACTION_IMAGE_CAPTURE)中：

> 公共静态最终字符串`ACTION_IMAGE_CAPTURE`
> 
> 在`API level 3`标准 Intent 操作中添加，可以发送该操作以让相机应用程序捕获图像并返回它。
> 
> 调用者可以传递一个额外的`EXTRA_OUTPUT`来控制这个图像将被写入哪里。如果`EXTRA_OUTPUT`不存在，则在额外字段中将小尺寸图像作为 Bitmap 对象返回。这对于只需要小图像的应用程序很有用。**如果 `EXTRA_OUTPUT`存在 ，则将全尺寸图像写入 的 Uri 值`EXTRA_OUTPUT`。**

# nosql - Cassandra 数据库中的 commitLog 和 SSTables

> ID：15857779
> 
> 赞同：17
> 
> 时间：2013-04-07T01:07:27.877
> 
> 标签：nosql, cassandra

我最近开始使用 Cassandra 数据库。我已经安装`single node cluster`在我的本地盒子中。我正在与`Cassandra 1.2.3`.

我正在阅读互联网上的文章，我发现了这一行 -

> Cassandra 写入首先写入提交日志（为了持久性），然后写入内存中的表结构，称为 memtable。一旦写入提交日志和内存，写入即成功，因此写入时磁盘 I/O 非常少。写入在内存中批量写入，并定期写入磁盘到称为 SSTable（排序字符串表）的持久表结构。

因此，为了理解以上几行，我编写了一个简单的程序，该程序将使用`Pelops client`. 我能够在 Cassandra 数据库中插入数据。

现在我想看看我的数据是如何写入的`commit log`以及它在哪里`commit log file`？还有如何`SSTables`生成的，我可以在我的本地盒子中找到它的位置以及它包含的内容。

我想看看这两个文件，以便我能更多地了解 Cassandra 在幕后是如何工作的。

在我的 cassandra.yaml 文件中，我有这样的东西

```
# directories where Cassandra should store data on disk.
data_file_directories:
    - S:\Apache Cassandra\apache-cassandra-1.2.3\storage\data

# commit log
commitlog_directory: S:\Apache Cassandra\apache-cassandra-1.2.3\storage\commitlog

# saved caches
saved_caches_directory: S:\Apache Cassandra\apache-cassandra-1.2.3\storage\savedcaches 
```

但是当我打开commitLog时，首先它有很多数据，所以我的notepad++无法正确打开它，如果它被打开，由于某些编码或什么，我无法正确看到。在我的数据文件夹中，我什么也找不到？

这意味着这个文件夹对我来说是空的-

```
S:\Apache Cassandra\apache-cassandra-1.2.3\storage\data\my_keyspace\users 
```

我在这里有什么遗漏吗？谁能解释我如何阅读 commitLog 和 SSTables 文件以及在哪里可以找到这两个文件？以及每当我写入 Cassandra 数据库时，幕后究竟发生了什么。

**更新：-**

我用来插入 Cassandra 数据库的代码-

```
public class MyPelops {

    private static final Logger log = Logger.getLogger(MyPelops.class);

    public static void main(String[] args) throws Exception {

        // -------------------------------------------------------------
        // -- Nodes, Pool, Keyspace, Column Family ---------------------
        // -------------------------------------------------------------

        // A comma separated List of Nodes
        String NODES = "localhost";

        // Thrift Connection Pool
        String THRIFT_CONNECTION_POOL = "Test Cluster";

        // Keyspace
        String KEYSPACE = "my_keyspace";

        // Column Family
        String COLUMN_FAMILY = "users";

        // -------------------------------------------------------------
        // -- Cluster --------------------------------------------------
        // -------------------------------------------------------------

        Cluster cluster = new Cluster(NODES, 9160);

        Pelops.addPool(THRIFT_CONNECTION_POOL, cluster, KEYSPACE);

        // -------------------------------------------------------------
        // -- Mutator --------------------------------------------------
        // -------------------------------------------------------------

        Mutator mutator = Pelops.createMutator(THRIFT_CONNECTION_POOL);

        log.info("- Write Column -");

        mutator.writeColumn(
                COLUMN_FAMILY,
                "Row1",
                new Column().setName(" Name ".getBytes()).setValue(" Test One ".getBytes()).setTimestamp(new Date().getTime()));

        mutator.writeColumn(
                COLUMN_FAMILY,
                "Row1",
                new Column().setName(" Work ".getBytes()).setValue(" Engineer ".getBytes()).setTimestamp(new Date().getTime()));

        log.info("- Execute -");
        mutator.execute(ConsistencyLevel.ONE);

        // -------------------------------------------------------------
        // -- Selector -------------------------------------------------
        // -------------------------------------------------------------

        Selector selector = Pelops.createSelector(THRIFT_CONNECTION_POOL);

        int columnCount = selector.getColumnCount(COLUMN_FAMILY, "Row1",
                ConsistencyLevel.ONE);
        System.out.println("- Column Count = " + columnCount);

        List<Column> columnList = selector
                .getColumnsFromRow(COLUMN_FAMILY, "Row1",
                        Selector.newColumnsPredicateAll(true, 10),
                        ConsistencyLevel.ONE);
        System.out.println("- Size of Column List = " + columnList.size());

        for (Column column : columnList) {
            System.out.println("- Column: (" + new String(column.getName()) + ","
                    + new String(column.getValue()) + ")");
        }

        System.out.println("- All Done. Exit -");
        System.exit(0);
    }

} 
```

我创建的键空间和列族-

```
create keyspace my_keyspace with placement_strategy = 'org.apache.cassandra.locator.SimpleStrategy' and strategy_options = {replication_factor:1};
use my_keyspace;
create column family users with column_type = 'Standard' and comparator = 'UTF8Type'; 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-04-07T06:53:19.353

你的理解几乎就在那里。但是，缺少一些细节。

所以以结构化的方式解释事物，cassandra写操作生命周期分为这几个步骤

*   提交日志写入
*   内存表写入
*   稳定写入

Cassandra 写入首先写入提交日志（为了持久性），然后写入内存中的表结构，称为 memtable。一旦写入提交日志和内存，就说写入成功，因此写入时磁盘 I/O 非常少。当 memtable 空间用完时，即当 key 的数量超过一定限制（默认为 128）或达到持续时间（集群时钟）时，它被存储到 sstable、不可变空间中（这种机制称为**Flushing**）。在 SSTable 上完成写入后，您可以在数据文件夹中看到相应的数据，在您的情况下是`S:\Apache Cassandra\apache-cassandra-1.2.3\storage\data`. 每个 SSTable 主要由 2 个文件组成 - 索引文件和数据文件

*   索引文件包含 - Bloom filter 和 Key-Offset 对

    *   布隆过滤器：布隆过滤器是一种节省空间的概率数据结构，用于测试元素是否是集合的成员。假阳性是可能的，但假阴性是不可能的。Cassandra 在执行键查找时使用布隆过滤器来节省 IO：每个 SSTable 都有一个与之关联的布隆过滤器，Cassandra 在进行任何磁盘查找之前都会对其进行检查，从而几乎可以免费查询不存在的键
    *   （键，偏移）对（指向数据文件）
*   数据文件包含实际的列数据

关于提交日志文件，这些是 Cassandra 本质上维护的加密文件，您无法正确查看任何内容。

**更新：**

Memtable 是一个内存缓存，内容存储为键/列（数据按键排序）。每个列族都有一个单独的 Memtable 并从键中检索列数据。所以现在我希望你清楚地了解这个事实，为什么我们不能在我们的磁盘中找到它们。

在您的情况下，您的 memtable 未满，因为 memtable 阈值尚未漂白但不会导致冲洗。[您可以在此处](http://wiki.apache.org/cassandra/MemtableThresholds)了解有关 MemtableThresholds的更多信息，但建议不要触摸该 Dial。

**SSTable结构：**

*   您的数据文件夹
    *   键空间
        *   CF
            *   压缩信息数据库
            *   数据.db
            *   过滤器.db
            *   索引数据库
            *   统计数据.db
            *   snapshots //如果拍摄了快照

有关详细信息，请参阅[sstable](http://wiki.apache.org/cassandra/ArchitectureSSTable)

# javascript - CSRF 禁止在我的注册表单上显示，不知道为什么

> ID：15857784
> 
> 赞同：5
> 
> 时间：2013-04-07T01:07:49.870
> 
> 标签：javascript, node.js, csrf

我在我的`Express v3`应用程序上设置了 CSRF，我有这样的：

```
app.use(express.session({
  secret: "gdagadgagd",
  cookie: {
    httpOnly: true,
    path : '/',
    maxAge: 1000*60*60*24*30*12
  }
}));
app.use(express.csrf());
app.use(function(req, res, next) {
  res.locals.token = req.session._csrf;
  next();
}) 
```

在我的页面上，令牌显示为：

```
<input type="hidden" name="_csrf" value="E3afFADF3913-fadFK31"> 
```

但是当我尝试在我的网页上注册时，我收到了这个错误：

```
Error: Forbidden
    at Object.exports.error (/Users/account/Desktop/nodeapp/node_modules/express/node_modules/connect/lib/utils.js:55:13)
    at Object.handle (/Users/account/Desktop/nodeapp/node_modules/express/node_modules/connect/lib/middleware/csrf.js:54:41)
    at next (/Users/account/Desktop/nodeapp/node_modules/express/node_modules/connect/lib/proto.js:190:15)
    at next (/Users/account/Desktop/nodeapp/node_modules/express/node_modules/connect/lib/middleware/session.js:313:9)
    at /Users/account/Desktop/nodeapp/node_modules/express/node_modules/connect/lib/middleware/session.js:337:9
    at /Users/account/Desktop/nodeapp/node_modules/express/node_modules/connect/lib/middleware/session/memory.js:50:9
    at process._tickCallback (node.js:415:13) 
```

我使用 Jade 作为我的模板引擎，这就是我所拥有的：

```
input(type='hidden', name='_csrf', value=token) 
```

我直接在 localhost:3000 访问网页，但我不确定为什么我被禁止注册帐户。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-21T12:09:47.943

您应该使用[bodyParser](http://expressjs.com/api.html#req.body)中间件，让服务器知道`_csrf`已通过。

`app.use(express.bodyParser());`之前插入`app.use(express.csrf());`。

# java - 井字游戏项目，使用图像而不是字母“X”和“O”

> ID：15857789
> 
> 赞同：0
> 
> 时间：2013-04-07T01:08:29.630
> 
> 标签：java

所以现在，这是井字游戏项目，这是计算机对玩家的游戏。在这个游戏项目中，我使用字母“X”和“O”作为十字符号和圆圈符号。它工作正常，没有错误。

现在我正在考虑使用图像而不是字母 X 和 O。请给我建议如何使用图片。我不是在寻找代码，只是给我建议，我应该添加或替换什么。

下面的代码是tic tac toe的代码

```
import java.awt.*;
import java.awt.event.*;
import java.util.Random;

import javax.swing.*;

public class TicTacToe implements ActionListener {
    /*Instance Variables*/
    static int[][] winCombinations = new int[][] {
            {1, 2, 3}, {4, 5, 6}, {7, 8, 9}, //horizontal wins
            {1, 4, 7}, {2, 5, 8}, {3, 6, 9}, //vertical wins
            {1, 5, 9}, {3, 5, 7}             //diagonal wins
        };
    static JFrame window = new JFrame("Tic-Tac-Toe");
    static JButton buttons[] = new JButton[10];
    static int count = 0;
    static  String letter;
    static boolean win = false;
    static  String myImage =  "X";
    static  String Image = "O";

    public TicTacToe(){
        /*Create Window*/
        window.setPreferredSize(new Dimension(300,300));
        window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        window.setLayout(new GridLayout(3,3));

        /*Add Buttons To The Window*/
        for(int i = 1; i<=9; i++)
        {
            buttons[i] = new JButton();
            window.add(buttons[i]);

            buttons[i].addActionListener(this);
        }

        /*Make The Window Visible*/
        window.setVisible(true);
        window.pack();
    }

    public void actionPerformed(ActionEvent a) 
    {
        /*Write the letter to the button and deactivate it*/
        for(int i = 1; i<= 9; i++){

            if(a.getSource() == buttons[i]){
                buttons[i].setText(myImage);
                buttons[i].setEnabled(false);
            }
        }

        count++;        
        AI();

    }

    public void AI(){
        count++;

         if(buttons[1].getText().equals(myImage) && buttons[2].getText().equals(myImage) && buttons[3].getText().equals("")){
            buttons[3].setText(Image);
            buttons[3].setEnabled(false);
        } else if(buttons[4].getText().equals(myImage) && buttons[5].getText().equals(myImage) && buttons[6].getText().equals("")){
            buttons[6].setText(Image);
            buttons[6].setEnabled(false);                
        } else if(buttons[7].getText().equals(myImage) && buttons[8].getText().equals(myImage) && buttons[9].getText().equals("")){
            buttons[9].setText(Image);
            buttons[9].setEnabled(false);                
        } 

        else if(buttons[2].getText().equals(myImage) && buttons[3].getText().equals(myImage) && buttons[1].getText().equals("")){
            buttons[1].setText(Image);
            buttons[1].setEnabled(false);                
        } else if(buttons[5].getText().equals(myImage) && buttons[6].getText().equals(myImage) && buttons[4].getText().equals("")){
        buttons[4].setText(Image);
        buttons[4].setEnabled(false);                
        } else if(buttons[8].getText().equals(myImage) && buttons[9].getText().equals(myImage) && buttons[7].getText().equals("")){
            buttons[7].setText(Image);
            buttons[7].setEnabled(false);                
        }

        else if(buttons[1].getText().equals(myImage) && buttons[3].getText().equals(myImage) && buttons[2].getText().equals("")){
            buttons[2].setText(Image);
            buttons[2].setEnabled(false);                
        } else if(buttons[4].getText().equals(myImage) && buttons[6].getText().equals(myImage) && buttons[5].getText().equals("")){
            buttons[5].setText(Image);
            buttons[5].setEnabled(false);                
        } else if(buttons[7].getText().equals(myImage) && buttons[9].getText().equals(myImage) && buttons[8].getText().equals("")){
            buttons[8].setText(Image);
            buttons[8].setEnabled(false);                
        }

        else if(buttons[1].getText().equals(myImage) && buttons[4].getText().equals(myImage) && buttons[7].getText().equals("")){
            buttons[7].setText(Image);
            buttons[7].setEnabled(false);                
        } else if(buttons[2].getText().equals(myImage) && buttons[5].getText().equals(myImage) && buttons[8].getText().equals("")){
            buttons[8].setText(Image);
            buttons[8].setEnabled(false);                
        } else if(buttons[3].getText().equals(myImage) && buttons[6].getText().equals(myImage) && buttons[9].getText().equals("")){
            buttons[9].setText(Image);
            buttons[9].setEnabled(false);                
        }

        else if(buttons[4].getText().equals(myImage) && buttons[7].getText().equals(myImage) && buttons[1].getText().equals("")){
            buttons[1].setText(Image);
            buttons[1].setEnabled(false);                
        } else if(buttons[5].getText().equals(myImage) && buttons[8].getText().equals(myImage) && buttons[2].getText().equals("")){
            buttons[2].setText(Image);
            buttons[2].setEnabled(false);                
        } else if(buttons[6].getText().equals(myImage) && buttons[9].getText().equals(myImage) && buttons[3].getText().equals("")){
            buttons[3].setText(Image);
            buttons[3].setEnabled(false);                
        }

        else if(buttons[1].getText().equals(myImage) && buttons[7].getText().equals(myImage) && buttons[4].getText().equals("")){
            buttons[4].setText(Image);
            buttons[4].setEnabled(false);                
        } else if(buttons[2].getText().equals(myImage) && buttons[8].getText().equals(myImage) && buttons[5].getText().equals("")){
            buttons[5].setText(Image);
            buttons[5].setEnabled(false);                
        } else if(buttons[3].getText().equals(myImage) && buttons[9].getText().equals(myImage) && buttons[6].getText().equals("")){
            buttons[6].setText(Image);
            buttons[6].setEnabled(false);                
        }

        else if(buttons[1].getText().equals(myImage) && buttons[5].getText().equals(myImage) && buttons[9].getText().equals("")){
            buttons[9].setText(Image);
            buttons[9].setEnabled(false);                
        } else if(buttons[5].getText().equals(myImage) && buttons[9].getText().equals(myImage) && buttons[1].getText().equals("")){
            buttons[1].setText(Image);
            buttons[1].setEnabled(false);                
        } else if(buttons[1].getText().equals(myImage) && buttons[9].getText().equals(myImage) && buttons[5].getText().equals("")){
            buttons[5].setText(Image);
            buttons[5].setEnabled(false);                
        }

        else if(buttons[3].getText().equals(myImage) && buttons[5].getText().equals(myImage) && buttons[7].getText().equals("")){
            buttons[7].setText(Image);
            buttons[7].setEnabled(false);                
        } else if(buttons[7].getText().equals(myImage) && buttons[5].getText().equals(myImage) && buttons[3].getText().equals("")){
            buttons[3].setText(Image);
            buttons[3].setEnabled(false);                
        } else if(buttons[7].getText().equals(myImage) && buttons[3].getText().equals(myImage) && buttons[5].getText().equals("")){
            buttons[5].setText(Image);
            buttons[5].setEnabled(false);                
        }

        else if(buttons[1].getText().equals(myImage) && buttons[5].getText().equals(Image) && buttons[9].getText().equals(myImage)) {
            buttons[6].setText(Image);
            buttons[6].setEnabled(false);            
        }    

        else if(buttons[3].getText().equals(myImage) && buttons[5].getText().equals(Image) && buttons[7].getText().equals(myImage)) {
            buttons[4].setText(Image);
            buttons[4].setEnabled(false);            
        }

        else if(buttons[5].getText().equals("")){
            buttons[5].setText(Image);
            buttons[5].setEnabled(false);                
        }

        else if(buttons[1].getText().equals("")){
            buttons[1].setText(Image);
            buttons[1].setEnabled(false);                
        }
        else {
            if(count >= 9)
                checkWin();
            else
                RandomMove();
        }

        checkWin();

    }

    public void RandomMove(){
        Random x = new Random();
        int y = 1 + x.nextInt(9);
        if(buttons[y].getText().equals(Image) || buttons[y].getText().equals(myImage)){
            RandomMove();
        } else {
            buttons[y].setText(Image);
            buttons[y].setEnabled(false);
        }
    }

    public void checkWin(){ 

        /*Determine who won*/
        for(int i=0; i<=7; i++){
            if( buttons[winCombinations[i][0]].getText().equals(buttons[winCombinations[i][1]].getText()) && 
                buttons[winCombinations[i][1]].getText().equals(buttons[winCombinations[i][2]].getText()) && 
                !buttons[winCombinations[i][0]].getText().equals("")) {
                win = true;
            }
        }

        if(count % 2 == 0)
            letter = Image;
        else
            letter = myImage;

        /*Show a dialog when game is over*/
        if(win == true){
            JOptionPane.showMessageDialog(null, letter + " wins!");
            System.exit(0);
        } else if(count >= 9 && win == false){
            JOptionPane.showMessageDialog(null, "The game was tie!");
            System.exit(0);
        }
    }
    public static void main(String[] args)
    {
        new TicTacToe();
    }
} 
```

# ios - iOS 中的 Netflix 样式 UIScrollView

> ID：15857790
> 
> 赞同：0
> 
> 时间：2013-04-07T01:08:30.007
> 
> 标签：ios, objective-c, uitableview, user-interface, uiscrollview

我是 iOS 新手，但我有丰富的 C++ 经验。我正在开发一个有趣的小游戏，我计划与 gamecenter 一起使用，但现在我正在尝试设置我的 GUI。这是我想要创建的图片： ![在此处输入图像描述](https://i.stack.imgur.com/iXXct.jpg)

从本质上讲，玩家有一手大约 7 张牌，他们可以在屏幕底部滑动这些牌。我希望它一次捕捉一张卡片，而不仅仅是惯性滚动，我希望他们能够点击一张卡片来播放它。你认为这是可行的吗？顺便说一句，我目前有存储为 PNG/矢量的自定义卡片，我在上面放置自定义文本以生成卡片。是否可以在 iOS 中创建自定义滚动视图对象，这些对象使用我的自定义背景模板化并从字符串、指定的文本大小和字体生成？（尺寸 48 黑尔维提卡）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T02:50:26.273

我想我会用持有卡片的 UICollectionView 来解决这个问题，并为手势实现手势识别器。这里有处理“snap-to”的代码：

[在 UICollectionView 中停止滚动](https://stackoverflow.com/questions/13749401/stopping-the-scroll-in-a-uicollectionview)

屏幕的顶部将是同一视图控制器中的不同视图，因此您将在 vc 中实现手势识别器来处理平移（用于滑动）和点击。

这看起来很简单。集合视图通常需要单击以指示单元格的选择；您需要禁用集合视图上的选择，以防止它使用选择点击的单元格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T05:42:03.697

对于您问题的第二部分，我建议您查看处理 Bezier 路径成像的 CAShapeLayer。基础层类 CALayer 还具有设置圆角半径的属性，这将非常适合您的卡片。

在 iOS 上，Core Animation 层是进入视图的成像组件，可以直接使用和操作，但通过完整视图提供事件处理。要在 UIViews 中使用自定义 CALayer 类，您需要重写 layerClass 方法以返回您希望视图使用的 CALayer 类。图层可以嵌套和/或堆叠在视图中，例如，您可以在一个视图中将 CATextLayer 堆叠在 CAShapeLayer 之上，该 CALayer 的内容已设置为 PNG 图像。然而，我怀疑 CATextLayer 会给你你想要的卡片布局控制，所以你最终可能会在形状层中渲染字形。

[Core Animation Programming](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreAnimation_guide/SettingUpLayerObjects/SettingUpLayerObjects.html) Guide 值得一读。

# highcharts - 使用 HighCharts 是否可以将列组中 1 列的线点居中？

> ID：15857791
> 
> 赞同：0
> 
> 时间：2013-04-07T01:08:40.883
> 
> 标签：highcharts

在此 HighCharts 图表中，您可以看到 3 列分组上的一条线。该行的数据与第三列的数据相同。

我想在每个列组中显示以第三列为中心的线点。有没有办法用 HighCharts 做到这一点？

![HighCharts 柱形图和折线图](https://i.stack.imgur.com/FoeWF.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T16:55:20.240

我能找到的最简单的方法是给线系列一个`pointStart`向右移动的值。

```
 {
            type: 'line',
            name: 'Joe\'s Line',
            data: [4, 3, 3, 9, 1],
            marker: {
                lineWidth: 2,
                lineColor: Highcharts.getOptions().colors[3],
                fillColor: 'white'
            },
            pointStart: 0.20 //force it to start further right.
        } 
```

[在这里](http://jsfiddle.net/t2Qqa/)拉小提琴。

![在此处输入图像描述](https://i.stack.imgur.com/Ckgcr.png)

# python - 如何在 Python 3 中从字节缓冲区构造内存中的 TarFile 对象？

> ID：15857792
> 
> 赞同：37
> 
> 时间：2013-04-07T01:08:44.680
> 
> 标签：python, file, python-3.x, tar, tarfile

是否可以使用包含 tar 数据的缓冲区在内存中创建 TarFile 对象，而无需将 TarFile 写入磁盘并再次打开它？我们得到通过套接字发送的字节。

像这样的东西：

```
import tarfile
byte_array = client.read_bytes()
tar = tarfile.open(byte_array) # how to do this?
# use "tar" as a regular TarFile object
for member in tar.getmembers():
    f = tar.extractfile(member)
    print(f) 
```

注意：这样做的原因之一是我们最终希望能够同时使用多个线程执行此操作，因此如果两个线程尝试同时执行此操作，则可能会覆盖使用临时文件。

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-04-07T02:30:36.477

[IO 模块](http://docs.python.org/3/library/io.html)中的 BytesIO()正是您需要的。

```
import tarfile, io
byte_array = client.read_bytes()
file_like_object = io.BytesIO(byte_array)
tar = tarfile.open(fileobj=file_like_object)
# use "tar" as a regular TarFile object
for member in tar.getmembers():
    f = tar.extractfile(member)
    print(f) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-07T02:17:47.883

当然，像这样：

```
import io

io_bytes = io.BytesIO(byte_array)

tar = tarfile.open(fileobj=io_bytes, mode='r') 
```

（调整`mode`以适合您的 tar 文件的格式，例如可能是 `mode='r:gz' 等）

# css - 带有 1px 边框的浮动网格 - 在 IE9 中，在某些浏览器宽度下，水平边框会消失

> ID：15857793
> 
> 赞同：0
> 
> 时间：2013-04-07T01:08:56.447
> 
> 标签：css, grid

我创建了一个浮动图像网格，其中图像设置为 100%，并且它们之间有 1px 的边框。这个问题似乎只发生在 IE9 中……如果你慢慢调整浏览器的大小，你会到达水平边框消失的地步。这是测试：http: [//zerostatic.com/float_grid/](http://zerostatic.com/float_grid/)

CSS：

```
*{
  margin: 0;
  padding: 0;
  border: 0;
}
ul{
    width:100%;
}
li{
    list-style:none;
    float:left;
    width:33.333333333%;
}
.li-inner{
    border:1px solid red;
    margin-left: -1px;
    margin-top: -1px;
}
img{
    width:100%;
} 
```

HTML：

```
 <ul>
         <li>
            <div class="li-inner">
              <a href="#" class="full-image"><img src="http://www.zerostatic.com/01.jpg" alt=""></a>
            </div>
        </li>
            <li>
            <div class="li-inner">
              <a href="#" class="full-image"><img src="http://www.zerostatic.com/01.jpg" alt=""></a>
            </div>
        </li>
         <li>
            <div class="li-inner">
              <a href="#" class="full-image"><img src="http://www.zerostatic.com/01.jpg" alt=""></a>
            </div>
        </li>
         <li>
            <div class="li-inner">
              <a href="#" class="full-image"><img src="http://www.zerostatic.com/01.jpg" alt=""></a>
            </div>
        </li>
         <li>
            <div class="li-inner">
              <a href="#" class="full-image"><img src="http://www.zerostatic.com/01.jpg" alt=""></a>
            </div>
        </li>
         <li>
            <div class="li-inner">
              <a href="#" class="full-image"><img src="http://www.zerostatic.com/01.jpg" alt=""></a>
            </div>
        </li>
         <li>
            <div class="li-inner">
              <a href="#" class="full-image"><img src="http://www.zerostatic.com/01.jpg" alt=""></a>
            </div>
        </li>
         <li>
            <div class="li-inner">
              <a href="#" class="full-image"><img src="http://www.zerostatic.com/01.jpg" alt=""></a>
            </div>
        </li>
        <li>
            <div class="li-inner">
              <a href="#" class="full-image"><img src="http://www.zerostatic.com/01.jpg" alt=""></a>
            </div>
        </li>
    </ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T11:06:54.717

您的问题有两个方面：

1.  首先，您没有为该页面使用任何类型的 CSS 重置。这意味着您要对每个单独的浏览器进行大量猜测。那里有无数的 CSS 重置，它们都工作正常。我建议您从这三个中进行选择：[Iain MacDonand 的 Strppd](http://iainspad.com/strppd-css/)、[Eric Meyer 的 Reset](http://meyerweb.com/eric/tools/css/reset/)或[HTML5 Starter Pack](http://sickdesigner.com/resources/HTML5-starter-pack/index.html)中的 reset，它基本上是一个扩展的 HTML5 版本的 Strppd
2.  其次，是的，在计算非整数值时，IE 有点厚，这就是为什么我建议使用非常有用的 box-sizing 技术，如[Paul Irish短文中所述](http://paulirish.com/2012/box-sizing-border-box-ftw/)

# filter - iptables 状态

> ID：15857795
> 
> 赞同：0
> 
> 时间：2013-04-07T01:09:08.647
> 
> 标签：filter, firewall, iptables

我试图阻止外部网络为 TCP 和 UDP 启动到我的内部网络的连接。我的想法是使用--state。我不确定不同州的手册页是什么意思。

“新的意思是数据包已经开始了一个新的连接，或者与一个在两个方向上都没有看到数据包的连接相关联”手册页

NEW 是否跟踪握手？如在

client1 -SYN-> client2 NEW
client1 <-SYN,ACK- client2 NEW
client1 -ACK-> client2 ESTABLISHED

-或者-

client1 -SYN-> client2 NEW
client1 <-SYN,ACK- client2 NEW
client1 -ACK-> client2 NEW
client1 <-DATA- client2 ESTABLISHED

用于 UDP

client1 -MSG1-> client2 NEW
client1 <-MSG2- client2 NEW
client1 -MSG3-> client2 ESTABLISHED

-或者-

client1 -MSG1-> client2 NEW
client1 <-MSG2- client2 ESTABLISHED

这会阻止传入的新连接但让新的传出连接通过吗？

```
-A FORWARD -p tcp -m state --state NEW ! -s 192.168.1.0/24 -j DROP
-A FORWARD -p tcp -m state --state ESTABLISHED ! -s 192.168.1.0/24 -j DROP
-A FORWARD -p tcp -m state --state NEW,ESTABLISHED -s 192.168.1.0/24 -j ACCEPT 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T02:12:54.663

我还没有测试过 UDP，但是对于 TCP，一旦发送了 SYN 数据包，连接就变成了 ESTABLISHED 所以

client1 -SYN-> client2 NEW
client1 <-SYN-ACK- client2 ESTABLISHED

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-17T11:20:37.313

```
client1 -SYN-> client2 NEW
client1 <-SYN,ACK- client2 ESTABLISH
client1 -ACK-> client2 ESTABLISHED 
```

SYN,ACK 时要小心，应该是 ESTABLISHED 状态，如果是 SYN,ACK 并且是新连接，一般是攻击。

你也应该添加 RELATED 状态。

好吧，如果你当前的机器有 192.168.1.0/24 的 ip，它会在创建传出连接时被阻止

我的建议是这样的：

```
$IPTABLES -A INPUT -p tcp -s 192.168.1.0/24 --tcp-flags SYN,ACK SYN,ACK -m state --state NEW -j REJECT --reject-with tcp-reset 
$IPTABLES -A INPUT -p tcp -s 192.168.1.0/24 ! --syn -m state --state NEW -j DROP
$IPTABLES -A allowed -p TCP -s 192.168.1.0/24 --syn -j ACCEPT
$IPTABLES -A allowed -p TCP -s 192.168.1.0/24 -m state --state ESTABLISHED,RELATED -j ACCEPT
$IPTABLES -A allowed -p TCP -s 192.168.1.0/24 -j DROP 
```

# python - Python中的公元前日期

> ID：15857797
> 
> 赞同：28
> 
> 时间：2013-04-07T01:09:25.293
> 
> 标签：python, date

我打算用 Python 构建一个需要广泛处理 BC 日期的应用程序（在数据库中存储和检索，进行计算）。大多数日期将具有各种不确定性，例如“大约公元前 2000 年”。

我知道 Python 的日期时间库只处理公元 1 年的日期。

到目前为止，我只找到[了 FlexiDate](https://github.com/okfn/datautil/blob/master/datautil/date.py)。还有其他选择吗？

**编辑：**最好的方法可能是将它们存储为字符串（将 String 作为基本数据类型），并且 - 正如建议的那样 - 有一个自定义的 datetime 类，它可以对它产生一些数字意义。对于大多数人来说，日期似乎只包含一年。有一些有趣的问题需要解决，例如“公元前 500 年早期”、“公元前 1600 年和公元前 1500 年之间”、“公元前 1800 年之前”。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-11-08T22:43:07.513

天文学家和航空航天工程师必须处理 BC 日期和连续的时间线，这就是您搜索的谷歌上下文。

[Astropy](http://www.astropy.org/)的[`Time`](http://docs.astropy.org/en/stable/api/astropy.time.Time.html)课程将为您工作（甚至比您希望的更精确和完整）。`pip install astropy`你正在路上。

如果你自己动手，你应该复习[瓦拉多关于日期的章节](https://rads.stackoverflow.com/amzn/click/com/1881883140)中的一些公式。将日期从儒略历转换为公历等需要很多晦涩的软糖因素。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-07T08:33:05.773

这是一个有趣的问题，这样的类还不存在似乎很奇怪（重新@joel Cornett评论）如果你只工作几年，它会简化你的类来处理整数而不是日历日期 - 你可以使用字典文本描述（公元前10年）和整数值（-10）编辑：我用谷歌搜索了这个：

[http://code.activestate.com/lists/python-list/623672/](http://code.activestate.com/lists/python-list/623672/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-04-01T00:25:54.540

NASA Spice 函数通过多种格式的转换非常好地处理 BC。在这些示例中`begin_date`，`end_date`包含与输入日期相对应的 J2000 纪元之后的 TDB 秒数：

```
import spiceypy as spice

# load a leap second kernel
spicey.furnsh("path/to/leap/second/kernel/naif0012.tls")

begin_date = spice.str2et('13201 B.C. 05-06 00:00')
end_date = spice.str2et('17191 A.D. 03-15 00:00') 
```

[str2et() 的](https://naif.jpl.nasa.gov/pub/naif/toolkit_docs/FORTRAN/spicelib/str2et.html)文档、 [输入格式文档](https://naif.jpl.nasa.gov/pub/naif/toolkit_docs/FORTRAN/spicelib/tpartv.html)以及 [Leapsecond 内核文件](https://naif.jpl.nasa.gov/pub/naif/generic_kernels/lsk/)可通过 NASA Spice 主页获得。

从 datetime 或其他时间方法转换为 spice 很简单：

```
if indate.year < 0.0:
    spice_indate = str(indate.year) + ' B.C. ' + sindate[-17:]
    spice_indate = str(spice_indate)[1:]
else: 
    spice_indate = str(indate.year) + ' A.D. ' + sindate[-17:]

'2018 B.C. 03-31 19:33:38.44' 
```

其他功能包括：TIMOUT、TPARSE 都在 J2000 纪元秒之间转换。

这些函数在 python 中通过[spiceypy](https://github.com/AndrewAnnex/SpiceyPy)可用，例如通过安装`pip3 install spiceypy`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-03-25T20:53:20.087

这是一个老问题，但我也有同样的问题，发现[这篇文章宣布了 datautil](http://rufuspollock.org/2009/06/18/flexible-dates-in-python/)，它旨在处理如下日期：

> *   遥远的过去和未来的日期，包括 BC/BCE 日期
> *   各种格式的日期：1890 年 1 月、1890 年 1 月、1890 年 12 月 1 日、1890 年春季等
> *   不同精度的日期：例如 1890、1890-01（即 1890 年 1 月）、1890-01-02
> *   不精确的日期：c1890、1890?、fl 1890 等

安装只是

`pip install datautil`

到目前为止，我只探索了几分钟，但注意到它不接受 str 作为参数（仅 unicode）并且它实现了自己的日期类（Flexidate，'ISO8601 的略微扩展版本'），这是排序也许有用。

```
>>> from datautil.date import parse
>>> parse('Jan 1890')

error: 'str' object has no attribute 'read'

>>> fd = parse(u'Jan 1890')
<class 'datautil.date.FlexiDate'> 1890-01

fd.as_datetime()
>>> datetime.datetime(1890, 1, 1, 0, 0)

>>> bc = parse(u'2000BC')
<class 'datautil.date.FlexiDate'> -2000 
```

可惜...

```
>>> bc.as_datetime()
ValueError: year is out of range 
```

对我来说不幸的是，我正在寻找可以处理带有“ [circa](http://en.wikipedia.org/wiki/Circa) ”（c.，ca，ca.，circ。或 cca。）的日期的东西。

```
>>> ca = parse(u'ca 1900')
<class 'datautil.date.FlexiDate'>  [UNPARSED: ca 1900] 
```

哦，好吧-我想我总是可以发送拉取请求；-)

# javascript - 使用 razor 构建弹出式工具提示菜单

> ID：15857800
> 
> 赞同：0
> 
> 时间：2013-04-07T01:10:23.407
> 
> 标签：javascript, asp.net, html

我在动态生成此下拉菜单时遇到问题。如果我没有动态地制作它，这会起作用。

正在工作，`@t.Id`并且每次在循环中都不同。我很确定这是错误的第一行，因为我以前使用`id=""`过这种方式。

```
<b><a href="#" onmouseover="tooltip.pop(this, '#tagsdiv@(t.Id)')">tagged</a></b>

<div style="display: none;">
    <div id="tagsdiv@(t.Id)">
        <span class="menu">hhhh<br />
            nnnn
            @for( int i = 0; i < t.tTags.Count; i++ ) {
                <b>@Html.ActionLink( t.tTags[i], "TagDetail", "Forums", new { tag = t.tTags[i], page = 0 }, null )</b>
            }
        </span>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:44:35.690

更有效地调试 Razor（或任何服务器端代码渲染标记）的提示：

1.  查看呈现的 HTML！这是正确的吗？
2.  删除样式/脚本，直到您确定服务器正在呈现您想要的值。
3.  向控制器添加断点以确保将数据传递给视图。您的渲染逻辑可能没问题。

也就是说，您的代码似乎工作正常。我收集了一些数据：

```
@{ var t = new { Id = 1234, tTags = new List<string> { "foo", "bar", "baz" } }; }

<b><a href="#" onmouseover="tooltip.pop(this, '#tagsdiv@(t.Id)')">tagged</a></b>

<div style="display: none;">
    <div id="tagsdiv@(t.Id)">
        <span class="menu">
                @for( int i = 0; i < t.tTags.Count; i++ ) {
                    <b>@Html.ActionLink( t.tTags[i], "TagDetail", "Forums", new { tag = t.tTags[i], page = 0 }, null )</b>
                }
        </span>
    </div>
</div> 
```

这产生：

```
<b><a href="#" onmouseover="tooltip.pop(this, '#tagsdiv1234')">tagged</a></b>

<div style="display:none;">
     <div id="tagsdiv1234">
        <span class="menu"> 
            <b><a href="">foo</a></b>
            <b><a href="">bar</a></b>
            <b><a href="">baz</a></b>
        </span>
    </div>
</div> 
```

这里真正看起来不对的一件事是`'#tagsdiv1234'`. 您确定您的工具提示需要*包含*CSS/jQuery ID 选择器（“#”）的 ID 吗？

另一件突出的事情是您的工具提示容器被外部`div`设置为`display:none`. ID 的元素将始终隐藏，因为它的父元素是隐藏的，即使工具提示代码试图显示它也是如此。

另一种可能性是您的 ID 在[元素标识符](https://stackoverflow.com/questions/70579/what-are-valid-values-for-the-id-attribute-in-html)中包含非法字符。

# jquery - 如何导航到略高于锚标记的位置？

> ID：15857802
> 
> 赞同：6
> 
> 时间：2013-04-07T01:10:35.330
> 
> 标签：jquery, ruby-on-rails, twitter-bootstrap, navigation, anchor

我知道如何导航到页面上的给定锚标记 - 我要做的是链接到目标锚上方 30-40 像素的页面部分。原因是我有一个引导导航，如果我直接喜欢带有锚点的页面部分，它最终会覆盖部分相关内容。

目前我有这个链接：

```
%a{:href => root_path + "#how_it_works"} How It Works 
```

并在它链接到的页面上：

```
.span12#how_it_works 
```

关于如何获取链接以导航到略高于 .span12#how_it_works 的页面部分的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:57:59.630

您可以通过在 CSS 中添加一些额外的填充来解决此问题，但最可靠的方法是使用 javascript：

```
$('a[href="#how_it_works"]').on('click',function(e){
  // prevent normal scrolling action
  e.preventDefault();
  // grab the target url from the anchor's ``href``
  var target = $(this.hash);
  target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
     if (target.length) {
           window.scrollTo(0, target.offset().top - 50); // <-- our offset in px adjust as necessary
      return false;
  }
}); 
```

这是[codepen](http://codepen.io/anon/pen/iyzfD)。

这使用了 Chris Coyier 的[平滑滚动脚本](http://css-tricks.com/snippets/jquery/smooth-scrolling/)的修改版本。我已经从滚动中删除了“平滑度”，但是您可以通过像这样为滚动顶部设置动画来添加它：

```
 if (target.length) {
     $('html,body').animate({
         scrollTop: target.offset().top + 20
    }, 1000);
    return false;
   } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T03:34:43.690

这对你有用吗？
[现场示例](http://fiddle.jshell.net/panchroma/d5L3g/show)
[jsFiddle](http://jsfiddle.net/panchroma/d5L3g/)

我在锚点上添加了一个顶部填充：
**CSS**

```
a.anchor{
background-color:pink;
padding-top:30px;
display:block;
margin-top:-30px; /* if you want to cancel out the padding-top */
} 
```

**HTML**

```
 <a href="#section1">section1</a><br>
  <a href="#section2">section2</a><br>
  <a href="#section3">section3</a><br>
  <a href="#section4">section4</a><br>  
  ....  
  <a name="section1" class="anchor">section1</a>  
  etc 
```

**编辑**
重新阅读您的问题，如果问题是因为您使用带有附加导航栏的引导程序并且您的某些页面内容隐藏在导航栏下方，则更简单的解决方案是在页面正文顶部添加填充以移动页面内容较低。

如果您需要在网站的每个页面上执行此操作，请使用：
**CSS**

```
body {
padding-top:40px;
} 
```

如果您只需要清除选定页面上的导航栏，请在有问题的页面上的 body 标记中添加一个类，并仅针对那些特定页面，例如
**HTML**

```
<body class="welcome">  
.... 
```

**CSS**

```
 body.welcome {
padding-top:40px;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-28T22:59:56.023

我有一个好主意来欺骗你的浏览器。不需要javascript。

创建一个 div 标签，给它一个名字。让 div 为空。然后在 CSS 中使用定位将其向上移动多远。

```
position: relative;
top: -165px; 
```

你可以根据你想要的位置来玩相对或绝对位置。

然后只需将该 div 标签作为锚标签。

```
<div class="anchor_placement" id="anchor"></div> 
```

当你去锚点时，它会去任何 div 标签所在的地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-07T01:58:49.127

你试过 jQuery scrollTo 插件吗？似乎这已被用于一些调整来做你想做的事。在此处查看场景/答案[Jquery ScrollTo 问题](https://stackoverflow.com/questions/10412259/jquery-scrollto-issue)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-01T18:37:53.523

Gu3miles - 这对我来说非常有效 - 我正在使用带有持久导航栏的锚。

```
.anchorplace{position: relative;
top: -74px; }

<div class="anchorplace" id="challenge"></div> 
```

# f# - F# 中的全局状态和异步工作流

> ID：15857807
> 
> 赞同：6
> 
> 时间：2013-04-07T01:11:01.467
> 
> 标签：f#

用于说明 F# 中的异步工作流的一个常见示例是并行检索多个网页。一个这样的例子在：[http](http://en.wikibooks.org/wiki/F_Sharp_Programming/Async_Workflows) ://en.wikibooks.org/wiki/F_Sharp_Programming/Async_Workflows此处显示的代码以防链接将来更改：

```
open System.Text.RegularExpressions
open System.Net

let download url =
    let webclient = new System.Net.WebClient()
    webclient.DownloadString(url : string)

let extractLinks html = Regex.Matches(html, @"http://\S+")

let downloadAndExtractLinks url =
    let links = (url |> download |> extractLinks)
    url, links.Count

let urls =
     [@"http://www.craigslist.com/";
     @"http://www.msn.com/";
     @"http://en.wikibooks.org/wiki/Main_Page";
     @"http://www.wordpress.com/";
     @"http://news.google.com/";]

let pmap f l =
    seq { for a in l -> async { return f a } }
    |> Async.Parallel
    |> Async.Run

let testSynchronous() = List.map downloadAndExtractLinks urls
let testAsynchronous() = pmap downloadAndExtractLinks urls

let time msg f =
    let stopwatch = System.Diagnostics.Stopwatch.StartNew()
    let temp = f()
    stopwatch.Stop()
    printfn "(%f ms) %s: %A" stopwatch.Elapsed.TotalMilliseconds msg temp

let main() =
    printfn "Start..."
    time "Synchronous" testSynchronous
    time "Asynchronous" testAsynchronous
    printfn "Done."

main() 
```

我想知道的是应该如何处理全局状态的变化，例如网络连接丢失？有没有一种优雅的方式来做到这一点？

可以在进行 Async.Parallel 调用之前检查网络的状态，但在执行期间状态可能会发生变化。假设一个人想要做的是暂停执行，直到网络再次可用而不是失败，有没有一种功能性的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-07T13:39:41.300

首先，该示例存在一个问题——它用于*并行*`Async.Parallel`运行多个操作，但操作本身并未实现为异步，因此这不会避免阻塞线程池中过多的线程。

 ***异步。**为了使代码完全异步，`download`and`downloadAndExtractLinks`函数也应该是异步的，这样你就可以`AsyncDownloadString`使用`WebClient`:

```
let asyncDownload url = async {
    let webclient = new System.Net.WebClient()
    return! webclient.AsyncDownloadString(System.Uri(url : string)) }

let asyncDownloadAndExtractLinks url = async {
    let! html = asyncDownload url
    let links = extractLinks html
    return url, links.Count }

let pmap f l =
    seq { for a in l -> async { return! f a } }
    |> Async.Parallel
    |> Async.RunSynchronously 
```

**重试。**现在，回答这个问题 - 没有用于处理网络故障等错误的内置机制，因此您需要自己实现这个逻辑。什么是正确的方法取决于您的情况。一种常见的方法是重试该操作一定次数并仅在它不成功时抛出异常，例如 10 次。您可以将其编写为采用其他异步工作流程的原语：

```
let rec asyncRetry times op = async {
  try
    return! op
  with e ->
    if times <= 1 then return (reraise e)
    else return! asyncRetry (times - 1) op } 
```

然后您可以更改 main 函数来构建一个重试下载 10 次的工作流：

```
let testAsynchronous() = 
  pmap (asyncRetry 10 downloadAndExtractLinks) urls 
```

**共享状态。**另一个问题是`Async.Parallel`只有在所有下载完成后才会返回（如果有一个错误的网站，您将不得不等待）。如果您想在结果返回时显示结果，您将需要更复杂的东西。

一个很好的方法是使用 F# 代理 - 创建一个代理来存储目前获得的结果并可以处理两条消息 - 一个添加新结果，另一个返回当前状态。然后您可以启动多个将结果发送到代理的异步任务，并且在单独的异步工作流中，您可以使用轮询来检查当前状态（例如更新用户界面）。

我写了一个[关于代理的 MSDN 系列](http://msdn.microsoft.com/en-us/library/hh273081.aspx)，还为 developerFusion 写了[两篇](http://www.developerfusion.com/article/139804/an-introduction-to-f-agents/) [文章](http://www.developerfusion.com/article/140677/writing-concurrent-applications-using-f-agents/)，其中包含大量使用 F# 代理的代码示例。*

# haskell - 如何在 Haskell 中使用线程安全的共享变量

> ID：15857808
> 
> 赞同：8
> 
> 时间：2013-04-07T01:11:02.760
> 
> 标签：haskell, concurrency, thread-safety, atomic

`IORef`s、`MVar`s 和`TVar`s 可用于在并发上下文中包装共享变量。我已经研究了并发 haskell 一段时间，现在我遇到了一些问题。在stackoverflow上搜索并阅读了一些相关问题后，我的问题并没有完全解决。

1.  根据`IORef` [文档](http://www.haskell.org/ghc/docs/7.4-latest/html/libraries/base-4.5.1.0/Data-IORef.html#v%3aatomicModifyIORef)“将原子性扩展到多个 IORef 是有问题的”，有人可以帮助解释为什么单个`IORef`是安全的但多个`IORef`s 是有问题的？
2.  `modifyMVar`是“异常安全的，但只有在此 MVar 没有其他生产者时才具有原子性”。请参阅`MVar`的[文档](http://www.haskell.org/ghc/docs/7.4-latest/html/libraries/base-4.5.1.0/Control-Concurrent-MVar.html#v%3amodifyMVar)。源代码显示`modifyMVar`它只按顺序组成 a `getMVar`，`putMVar`表明如果有另一个生产者，它是线程安全的。但是如果没有生产者并且所有线程都以“ `takeMVar`then `putMVar`”方式运行，那么简单地使用它是线程安全的`modifyMVar`吗？

为了给出具体情况，我将展示实际问题。我有一些永远不会为空的共享变量，我希望它们是可变状态，因此一些线程可以同时修改这些变量。

好的，看起来`TVar`一切都清楚地解决了。但我对此并不满意，我渴望得到上述问题的答案。任何帮助表示赞赏。

-------------- 回复：@GabrielGonzalez BFS 接口代码 ------

下面的代码是我使用状态单子的 BFS 接口。

```
{-# LANGUAGE TypeFamilies, FlexibleContexts #-}

module Data.Graph.Par.Class where

import Data.Ix
import Data.Monoid
import Control.Concurrent
import Control.Concurrent.MVar
import Control.Monad
import Control.Monad.Trans.State

class (Ix (Vertex g), Ord (Edge g), Ord (Path g)) => ParGraph g where
  type Vertex g :: *
  type Edge g :: * 
  -- type Path g :: *           -- useless
  type VertexProperty g :: *
  type EdgeProperty g :: *
  edges :: g a -> IO [Edge g]
  vertexes :: g a -> IO [Vertex g]
  adjacencies :: g a -> Vertex g -> IO [Vertex g]
  vertexProperty :: Vertex g -> g a -> IO (VertexProperty g)
  edgeProperty :: Edge g -> g a -> IO (EdgeProperty g)
  atomicModifyVertexProperty :: (VertexProperty g -> IO (VertexProperty g)) -> 
                                Vertex g -> g a -> IO (g a) -- fixed 

spanForest :: ParGraph g => [Vertex g] -> StateT (g a) IO ()
spanForest roots = parallelise (map spanTree roots) -- parallel version

spanForestSeq :: ParGraph g => [Vertex g] -> StateT (g a) IO ()
spanForestSeq roots = forM_ roots spanTree -- sequencial version

spanTree :: ParGraph g => Vertex g -> StateT (g a) IO ()
spanTree root = spanTreeOneStep root >>= \res -> case res of
  [] -> return ()
  adjs -> spanForestSeq adjs

spanTreeOneStep :: ParGraph g => Vertex g -> StateT (g a) IO [Vertex g]
spanTreeOneStep v = StateT $ \g -> adjacencies g v >>= \adjs -> return (adjs, g)

parallelise :: (ParGraph g, Monoid b) => [StateT (g a) IO b] -> StateT (g a) IO b
parallelise [] = return mempty
parallelise ss = syncGraphOp $ map forkGraphOp ss

forkGraphOp :: (ParGraph g, Monoid b) => StateT (g a) IO b -> StateT (g a) IO (MVar b)
forkGraphOp t = do 
  s <- get
  mv <- mapStateT (forkHelper s) t
  return mv
  where
    forkHelper s x = do
      mv <- newEmptyMVar
      forkIO $ x >>= \(b, s) -> putMVar mv b
      return (mv, s)

syncGraphOp :: (ParGraph g, Monoid b) => [StateT (g a) IO (MVar b)] -> StateT (g a) IO b
syncGraphOp [] = return mempty
syncGraphOp ss = collectMVars ss >>= waitResults
  where
    collectMVars [] = return []
    collectMVars (x:xs) = do
      mvx <- x
      mvxs <- collectMVars xs
      return (mvx:mvxs)
    waitResults mvs = StateT $ \g -> forM mvs takeMVar >>= \res -> return ((mconcat res), g) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-07T01:37:55.713

1.  现代处理器提供了一个比较和交换指令，可以原子地修改单个指针。我希望如果你追得够深，你会发现这条指令是用来实现的`atomicModifyIORef`。因此很容易提供对单个指针的原子访问。但是，由于没有对多个指针的此类硬件支持，因此无论您需要什么，都必须在软件中完成。这通常涉及在所有线程中发明和手动执行协议——这很复杂且容易出错。

2.  是的，如果所有线程都同意只使用“单`takeMVar`后单`putMVar`”的行为，那么`modifyMVar`是安全的。

# python - XML 设计 OpenErp

> ID：15857814
> 
> 赞同：0
> 
> 时间：2013-04-07T01:11:25.193
> 
> 标签：python, xml, view, module, openerp

我的模块 certificados.py 有一个 xml，.py 模块如下：

```
class certificados(osv.osv):

_name = 'certificados.certificados'

_columns = {
            'Item' : fields.integer('Item'), 'Registro Numero' : fields.integer('Registro Numero'),
            'Fecha de Emision': fields.date('Fecha de Emision', required=True, select=True),
            'Fecha de Solicitud': fields.date('Fecha de Solicitud', required=True, select=True),
            'Fecha del Documento': fields.date('Fecha del Documento', required=True, select=True),
            'Vigencia' : fields.integer('Vigencia'), 
            'Codigo Arancelario' : fields.integer('Codigo Arancelario'),
            'cert_ids' : fields.one2many('purchase.requisition.line','requisition_id','Products to Purchase',states={'done': [('readonly', True)]}),
            'Descripcion Arancelaria' : fields.char('Descripcion Arancelaria', size=42, required = True, translate = True), 
            'Especificaciones Tecnicas' : fields.char('Especificaciones Tecnicas', size=60, required = True, translate = True), 
            'Cantidad' : fields.float('Cantidad'), 'Unidad de Medida': fields.many2one('product.uom', 'Unidad de Medida'),
            'Precio Unitario Declarado' : fields.float('Precio Unitario Declarado'), 'Moneda' : fields.many2one('res.currency', 'Moneda'),
            'Valor En Divisas' : fields.float('Valor En Divisas'),
            'Cantidad Consumida' : fields.float('Cantidad Consumida'), 'Cantidad Disponible' : fields.float('Cantidad Disponible'),
            'notas' : fields.text('Notas'),
            }
certificados() 
```

我正在尝试对该模块进行一些设计，使其显示为采购申请，我的意思不仅仅是记录，还有一些“工作表”和“h1”以及类似的“笔记本”之类的东西，我的模块的代码在它的“形式”部分是形式：

```
 <record id="student_certificados_form" model="ir.ui.view">
    <field name="name">certificados.result.form</field>
    <field name="model">certificados.certificados</field>
    <field name="type">form</field>
    <field name="arch" type="xml">
        <form string="Introducir los datos" >
            <field name="Codigo Arancelario" />
                    <field name="Descripcion Arancelaria" />
                    <field name="Especificaciones Tecnicas" />
                    <field name="Cantidad" /><field name="Unidad de Medida" />
                    <field name="Precio Unitario Declarado" /><field name="Moneda" />
                    <field name="Valor En Divisas" /><field name="Moneda" />
                    <field name="Cantidad Consumida" />
                    <field name="Cantidad Disponible" />
            </form>
    </field>
</record> 
```

我做了一些修改，但我不知道错误在哪里，修改后的版本是这样的：

```
<record id="student_certificados_form" model="ir.ui.view">
    <field name="name">certificados.result.form</field>
    <field name="model">certificados.certificados</field>
    <field name="arch" type="xml">
        <form string="Introducir los datos" version="7.0">
        <sheet>
            <div class="oe_edit_only">
                <label for="Registro Numero" class="oe_inline"/>
            </div>
            <h1>
                <field name="Registro Numero" class="oe_inline"/>

            </h1>
            <group>
                <group>
                    <field name="Fecha de Emision"/>
                    <field name="Fecha de Solicitud"/>
                </group>
                <group>
                    <field name="Fecha del Documento"/>
                    <field name="Vigencia"/>
                 </group>
            </group>
            <notebook>
            <page string="Certificados">
                    <field name="
                        <tree string="certificados_certificados_tree" editable="bottom">
                            <field name="Item" />
                            <field name="Codigo Arancelario" />
                            <field name="Descripcion Arancelaria" />
                            <field name="Especificaciones Tecnicas" />
                            <field name="Precio Unitario Declarado" />
                            <field name="Valor En Divisas" />
                            <field name="Cantidad Consumida" />
                            <field name="Cantidad Disponible" />
                        </tree>
                        <form string="Certificados" version="7.0">
                            <group>
                                <field name="Codigo Arancelario" />
                                <field name="Especificaciones Tecnicas"/>
                                <field name="Valor En Divisas" />
                            </group>
                        </form>

                <separator string="Certificados"/>
                <field name="Item" readonly="1">
                <tree string="Certificados" >
                    <field name="Codigo Arancelario" />
                    <field name="Descripcion Arancelaria" />
                    <field name="Especificaciones Tecnicas" />
                    <field name="Cantidad" /><field name="Unidad de Medida" />
                    <field name="Precio Unitario Declarado" /><field name="Moneda" />
                    <field name="Valor En Divisas" /><field name="Moneda" />
                    <field name="Cantidad Consumida" />
                    <field name="Cantidad Disponible" />
                </tree>
                </field>
            </page>
        </notebook>
    </sheet>
                 <div class="oe_chatter">
          <field name="message_follower_ids" widget="mail_followers"/>
          <field name="message_ids" widget="mail_thread"/>
        </div> 

            </form>
    </field>
</record> 
```

我知道这里有一些错字，但找不到，它给了我无效的 XML 架构，这通常被称为 xml 字段中的不匹配。

有人可以告诉我错误在哪里吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-06T10:21:57.603

即使将您的字段名称从“Codigo Arancelario”改进为“Codigo_Arancelario”，您仍然会收到来自上述代码的错误。我可以分析，可能是您忘记了，或者您不知道对于“one2many”字段类型，必须有many2one 字段将该对象引用到另一个对象。

```
Here in your module's scenario, You have to define many2one field in purchase.requisition.line for 'cert_ids'. 

Try This :

instead of 'cert_ids' , use this one over there

'cert_ids' : fields.one2many('purchase.requisition.line','cert_requisition_id','Products to Purchase',states={'done': [('readonly', True)]}),

And after that add an object, in your .py file i.e

class purchase_requisition_line(osv.Model):
    _inherit = 'purchase.requisition.line'
    _columns = {
        'cert_requisition_id': fields.many2one('certificados.certificados', 'Products to Purchase')
    }
purchase_requisition_line()

Hope this will Solve your Error. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T05:45:34.550

py 文件中的字段定义可能存在问题。

您正在定义这样的字段：`'Codigo Arancelario' : fields.integer('Codigo Arancelario')`，但它必须是这样`'Codigo_Arancelario' : fields.integer('Codigo Arancelario')`的。这就是您面临错误的原因。

所以改变你在 py 和 xml 中的字段定义，然后尝试一下。

我希望它会工作。

# python - Python SVG 解析器

> ID：15857818
> 
> 赞同：31
> 
> 时间：2013-04-07T01:12:36.373
> 
> 标签：python, xml, svg, xml-parsing, cnc

我想使用 python 解析 SVG 文件以提取坐标/路径（我相信这列在“路径”ID 下，特别是 d="..."/>）。该数据最终将用于驱动 2 轴 CNC。

我在 SO 和 Google 上搜索了可以返回此类路径字符串的库，以便我可以进一步解析它，但无济于事。有这样的图书馆吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-04-07T01:17:26.350

忽略变换，您可以从 SVG 中提取路径字符串，如下所示：

```
from xml.dom import minidom

doc = minidom.parse(svg_file)  # parseString also exists
path_strings = [path.getAttribute('d') for path
                in doc.getElementsByTagName('path')]
doc.unlink() 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-07-10T21:51:27.143

获取 d-string 可以使用[svgpathtools](https://pypi.python.org/pypi/svgpathtools/)在一两行中完成。

```
from svgpathtools import svg2paths
paths, attributes = svg2paths('some_svg_file.svg') 
```

*路径*是 svgpathtools 路径对象的列表（仅包含曲线信息，没有颜色、样式等）。 *attributes*是存储每个路径的属性的相应字典对象的列表。

比如说，打印出 d-strings 然后......

```
for k, v in enumerate(attributes):
    print(v['d'])  # print d-string of k-th path in SVG 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2019-07-06T11:44:17.117

问题是关于提取路径字符串，但最终需要线条绘制命令。根据minidom的回答，我添加了用svg.path解析路径来生成画线坐标：

```
#!/usr/bin/python3
# requires svg.path, install it like this: pip3 install svg.path

# converts a list of path elements of a SVG file to simple line drawing commands
from svg.path import parse_path
from svg.path.path import Line
from xml.dom import minidom

# read the SVG file
doc = minidom.parse('test.svg')
path_strings = [path.getAttribute('d') for path
                in doc.getElementsByTagName('path')]
doc.unlink()

# print the line draw commands
for path_string in path_strings:
    path = parse_path(path_string)
    for e in path:
        if isinstance(e, Line):
            x0 = e.start.real
            y0 = e.start.imag
            x1 = e.end.real
            y1 = e.end.imag
            print("(%.2f, %.2f) - (%.2f, %.2f)" % (x0, y0, x1, y1)) 
```

# java - java.lang.Integer.parseInt 使用最高位的十六进制字符串失败

> ID：15857823
> 
> 赞同：1
> 
> 时间：2013-04-07T01:13:17.773
> 
> 标签：java, scala, number-formatting, numberformatexception

我很惊讶以下从 32 位整数到十六进制字符串的向前向后转换失败：

```
Integer.parseInt(-2028332484.toHexString, 16) 
```

给出：

```
java.lang.NumberFormatException: For input string: "871a1a3c" 
```

显然一种解决方法是

```
java.lang.Long.parseLong(-2028332484.toHexString, 16).toInt 
```

但我想知道是否没有更好的（可能是更多的 Scala'ish）解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T05:48:04.753

Java 已经[在这里](https://stackoverflow.com/questions/845230/java-negative-int-to-hex-and-back-fails)回答了。

不幸的是，在 scala AFAIK 中没有针对这种转换的额外处理。

Scala 定义在`RichInt`：

```
def toHexString: String = java.lang.Integer.toHexString(self) 
```

并在`StringLike`：

```
def toInt: Int         = java.lang.Integer.parseInt(toString) 
```

除了`import java.lang.{Long => JLong}`和使用`JLong`我不知道比你的更scala-ish的解决方案。

# php - PDO 不适用于 CakePHP 安装

> ID：15857824
> 
> 赞同：1
> 
> 时间：2013-04-07T01:13:17.733
> 
> 标签：php, cakephp, pdo, mamp

我正在配置一个 cakePHP 应用程序，但该应用程序似乎没有成功连接到数据库，我收到以下错误：

```
Cake is NOT able to connect to the database.

Database connection "Mysql" is missing, or could not be created. 
```

我将其重命名为`database.php.default`，`database.php`代码如下：

```
class DATABASE_CONFIG {

    public $default = array(
        'datasource' => 'Database/Mysql',
        'persistent' => false,
        'host' => 'localhost:8889',
        'login' => 'root',
        'password' => 'root',
        'database' => 'cakephpdb',
        'prefix' => '',
        'encoding' => 'utf8',
    );
} 
```

实际上，我知道 CakePHP 使用 PDO 驱动程序连接到 DB，所以我尝试运行一个单独的文件来测试 PDO 是真还是假：

```
<?php

var_dump( extension_loaded('pdo_mysql') );

?> 
```

这是错误的：

```
bool(false) 
```

我试图在`php.ini`文件中启用 PDO：

```
extension=php_pdo_mysql.so 
```

重新启动 MAMP，但 cakePHP 应用程序仍然出现相同的错误。我错过了什么吗？您如何确保在您的案例中启用 PDO？提前谢谢。

***编辑：***

运行 phpinfo() 时，未启用 PDO_MySQL： ![在此处输入图像描述](https://i.stack.imgur.com/hPmA8.png)

根据 phpinfo() 输出，php.ini 路径如下：

```
/Applications/MAMP/bin/php/php5.4.10/conf 
```

![在此处输入图像描述](https://i.stack.imgur.com/lXsFh.png)

所以我尝试`php.ini`在该路径编辑文件，这是相关设置：

```
 extension=imap.so
    extension=yaz.so
    extension=mcrypt.so
    extension=gettext.so
    extension=pgsql.so
    extension=pdo_pgsql.so
    extension=pdo_mysql.so

pdo_mysql.default_socket=/tmp/mysql.sock

mysql.default_socket = /tmp/mysql.sock 
```

另外，我尝试在 php 脚本中测试数据库连接：

```
try {
    $dbh = new PDO('mysql:host=localhost;dbname=db_name', 'localhost', 'root');
    echo '<br /> success';
} catch (PDOException $e) {
    print "Error !: " . $e->getMessage() . "<br/>";

    die();
} 
```

而且我总是出现以下错误：

```
Error !: could not find driver 
```

所以`PDO_Mysql`驱动程序没有加载，这从 phpinfo() 输出中很清楚。出来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-27T09:58:18.270

您确认是否更新了正确的 php.ini？对于 XAMPP，有一个 php.ini 用于控制台，另一个用于 Web 服务器。您可能正在更新不正确的。

# mysql - 如何计算每个项目的多个特定值？

> ID：15857825
> 
> 赞同：-1
> 
> 时间：2013-04-07T01:13:20.547
> 
> 标签：mysql, date, count, multiple-columns

我正在尝试创建一个查询，该查询将按描述对项目进行分组，然后计算过去 3 个月的项目，每个月都有自己的列。最终，我试图实现以下目标：

```
    +-------------+------------+------------+--------- ------------+
    | 说明 | 本月 | 上个月 | 上个月 |
    +-------------+------------+------------+--------- ------------+
    | 项目_1 | 4 | 3 | 5 |
    | 项目_2 | 3 | 0 | 2 |
    | 项目_3 | 1 | 3 | 5 |
    +-------------+------------+------------+--------- ------------+

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:32:11.763

```
SELECT
    "Description",
    SUM(
      CASE
        WHEN "Date" > NOW() THEN 0
        WHEN "Date" > NOW() - INTERVAL 1 MONTH THEN 1
        ELSE 0
      END CASE
    ) AS "This month",
    SUM(
      CASE
        WHEN "Date" > NOW() - INTERVAL 1 MONTH THEN 0
        WHEN "Date" > NOW() - INTERVAL 2 MONTH THEN 1
        ELSE 0
      END CASE
    ) AS "Last month",
    SUM(
      CASE
        WHEN "Date" > NOW() - INTERVAL 2 MONTH THEN 0
        WHEN "Date" > NOW() - INTERVAL 3 MONTH THEN 1
        ELSE 0
      END CASE
    ) AS "The previous month"
FROM Items
WHERE "Date" > NOW() - INTERVAL 3 MONTH
GROUP BY "Description" 
```

# java - 从类中读取字节

> ID：15857827
> 
> 赞同：0
> 
> 时间：2013-04-07T01:13:29.310
> 
> 标签：java, reflection, classloader, urlclassloader

我正在尝试从文件系统上的路径中获取一个类，并从中获取字节。我已经尝试过下面的内容，但没有成功。现在应该只打印出名称。如果有人对如何做我正在做的事情有任何想法，请告诉我。它甚至可能比这更容易......

```
public class Driver {
public static void main(String[] args) throws Exception {
    BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
    System.out.print("Enter the path of the class:  ");
    String from = br.readLine();
    System.out.print("Enter the path to save the .txt file (with bytes):  ");
    String to = br.readLine();
    Class clazz = getClassFromPath(from);
    System.out.println("Loaded <" + clazz.getName() + "> successfully!");
}

public static Class<?> getClassFromPath(String path) {
    try {
        File file = new File(path);
        URL[] urls = {new URL(path)};
        URLClassLoader cl = URLClassLoader.newInstance(urls);
        if (!file.isDirectory() && file.getName().endsWith(".class")) {
            String className = file.getName().substring(0, file.getName().length() - 6);
            className = className.replace('/', '.');
            Class c = cl.loadClass(className);
            return c;
        }
        for (File f : file.listFiles()) {
            if (f.isDirectory() || !f.getName().endsWith(".class")) {
                continue;
            }
            String className = f.getName().substring(0, f.getName().length() - 6);
            className = className.replace('/', '.');
            Class c = cl.loadClass(className);
            return c;
        }
    } catch (MalformedURLException e) {
        e.printStackTrace();
    } catch (ClassNotFoundException e) {
        e.printStackTrace();
    }
    return null;
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T01:52:28.903

我很确定你可以尝试这样的事情：

```
InputStream stream = clazz.getClassLoader().getResourceAsStream(classAsPath); 
```

其中**classAsPath**是您在方法**getClassFromPath上实际执行的操作**

然后你可能想使用 Apache Commons-io 使用**IOUtils.toByteArray() 之类的东西将 InputStream 读入 byte[]**

# ios - 如何从不同的视图控制器访问模型对象

> ID：15857830
> 
> 赞同：0
> 
> 时间：2013-04-07T01:14:46.530
> 
> 标签：ios, objective-c

我不确定我是否采取了正确的方法，但我想从不同的视图控制器访问我的购物车类模型。我的第一种方法是在每个 viewController 中初始化一个 Cart * 对象，但我想我最终得到了多个购物车对象，而我想要的只是一个可以全局访问的对象。经过搜索，我想出了一种看起来更好的不同方法，但还没有运气。

我有一个按钮，应该将交易添加到购物车。但是当我尝试添加它时，该方法没有被调用。这是我设置它的方式。

在我的购物车类中，我有一个 NSMutableArray 来保存我的交易。

在我的 viewController 中，我设置了 Cart *cart 类型的属性并像这样初始化

```
@property (strong, nonatomic) Cart *cart; 
```

...

```
-(id)initWithModel:(Cart *)cart {
    self = [super init];

    if(self){
        self.cart = cart;

    }

    return self;
} 
```

然后我的按钮方法是这样的

```
-(IBAction)addDealToCart {

    NSLog(@"The Cart has %i items", [self.cart qtyOfItemsInCart]);

    NSLog(@"Added the Deal to the Cart");

    [self.cart addDealsToCart:self.deal];

    NSLog(@"The Cart now has %i items", [self.cart qtyOfItemsInCart]);

    self.deal.qtyInCart = self.deal.qtyInCart + 1;
    NSLog(@"the deal has %i items in the Cart", self.deal.qtyInCart);

} 
```

在这一行中 addDealsToCart:deal 永远不会被调用。

这是我的购物车类中的 addDealsToCart:deal 方法

```
-(void)addDealsToCart:(Deals *)deal {
    [self.cartContents addObject:deal];
    NSLog(@"the deal was added to the cart %@",deal);
} 
```

任何帮助都会很棒。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:21:53.607

如果不进行整个重新架构，为什么不将购物车对象传递给每个视图控制器？我个人不会走您的描述暗示的单身路线。

更新（示例）：

```
UIViewController *yourNextVC = [[YourNextVC alloc] init];
yourNextVC.cart = self.cart //The current cart in your current vc, passing it along.
[self presentViewController:yourNextVC animated:YES completion:nil]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T02:40:15.390

我你只想要一个 Cart 变量通过应用程序，如果你愿意，你可以在 appDelegate 中拥有它

```
@property (strong, nonatomic) Cart *cart; 
```

而且取出很简单

```
AppDelegate *appDelegateObject=(AppDelegate*)[[UIApplication shareApplication] delegate];
appDelegateObject.cart.qtyOfItemsInCart= 1; //initialize where you want. 
```

像这样在另一个视图控制器中取出：

```
 AppDelegate *appDelegateObject=(AppDelegate*)[[UIApplication shareApplication] delegate];
  NSLog(@"cart value: %d,appDelegateObject.cart.qtyOfItemsInCart); 
```

# sql-server - 将数据库架构隐藏到 SQL Server 中的登录名/用户

> ID：15857834
> 
> 赞同：1
> 
> 时间：2013-04-07T01:15:11.453
> 
> 标签：sql-server, visual-studio, database-schema

在 SQL Server 数据库中有：

*   2个模式：`dbo`和`customized_schema`
*   2 个用户：`sa`和`standard_user`

在架构下，`[customized_schema]`有具有我的标准应用程序的自定义功能的实体。

我想要拒绝用户`standard_user`使用模式customized_schema，但我想要的甚至是隐藏表、视图、函数和存储过程中的代码的结构。

我试过这个但不起作用：

```
DENY UPDATE ON SCHEMA::[customized_schema] TO [standard_user]
GO
DENY TAKE OWNERSHIP ON SCHEMA::[customized_schema] TO [standard_user]
GO
DENY CONTROL ON SCHEMA::[customized_schema] TO [standard_user]
GO
DENY EXECUTE ON SCHEMA::[customized_schema] TO [standard_user]
GO
DENY DELETE ON SCHEMA::[customized_schema] TO [standard_user]
GO
DENY INSERT ON SCHEMA::[customized_schema] TO [standard_user]
GO
DENY ALTER ON SCHEMA::[customized_schema] TO [standard_user]
GO
DENY REFERENCES ON SCHEMA::[customized_schema] TO [standard_user]
GO
DENY SELECT ON SCHEMA::[customized_schema] TO [standard_user]
GO
DENY VIEW DEFINITION ON SCHEMA::[customized_schema] TO [standard_user]
GO
DENY VIEW CHANGE TRACKING ON SCHEMA::[customized_schema] TO [standard_user]
GO 
```

我想比较数据库（使用 Visual Studio 2012 SSDT）并使用 部署更改`standard_user`，期望忽略客户功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T15:09:30.547

DbDefence 可以隐藏架构、表结构等。据我所知，它们使用 SQL Server 的未记录功能。没有办法以有记录的方式做到这一点。DBDefence 对于小于 200 Mb 的数据库是免费的

# c - 使用 makefile 编译头文件依赖项

> ID：15857837
> 
> 赞同：4
> 
> 时间：2013-04-07T01:15:53.473
> 
> 标签：c, gcc, makefile, gnu

我正在用 C 编程语言编写一个 UDP 客户端服务器应用程序；我想在依赖项发生变化时自动编译 2 个源文件和 3 个头文件，所以我决定使用 make 实用程序。

makefile 目标称为**“编辑”**：

```
 edit : server_UDP.o  client_UDP.o \
            gcc -o edit server_UDP.o  client_UDP.o \

    client_UDP.o : client_UDP.c cliHeader_UDP.h  wrapHeader.h
            gcc -c client_UDP.c

    server_UDP.o : server_UDP.c servHeader_UDP.h  wrapHeader.h
            gcc -c  server_UDP.c 
```

当我更改 wrapHeader.h 中的几行代码时，它不会触发重新编译。

当 wrapHeader.h 发生更改以重新编译 server_UDP 和 client_UDP 时，如何修改编辑 makefile 规则？

****注意**：wrapHeader.h 是主标题

**cliHeader_UDP.h：包括“wrapHeader.h”**

**servHeader_UDP.h：包括“wrapHeader.h”**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T01:28:24.867

我认为你想要的是制作依赖文件。

您可以使用“-MMD -MP”参数指定编译器为您生成依赖文件，这会在与源文件相同的文件夹中创建一个与源文件同名但扩展名为 *.d 的新文件.

依赖文件包含代码所依赖的所有头文件，如果它使用的头文件被修改，这将导致 GNU make 编译您的源文件。

启用 makefile 的示例依赖文件：

```
# Makefile

CC   := gcc
LD   := g++

# The output executable.
BIN   := program

# Toolchain arguments.
CFLAGS    := 
CXXFLAGS  := $(CFLAGS)
LDFLAGS   := 

# Project sources.
C_SOURCE_FILES := mysourcefile1.c src/myothersrc.c
C_OBJECT_FILES := $(patsubst %.c,%.o,$(C_SOURCE_FILES))

# The dependency file names.
DEPS := $(C_OBJECT_FILES:.o=.d)

all: $(BIN)

clean:
    $(RM) $(C_OBJECT_FILES) $(DEPS) $(BIN)

rebuild: clean all

$(BIN): $(C_OBJECT_FILES)
    $(LD) $(C_OBJECT_FILES) $(LDFLAGS) -o $@

%.o: %.c
    $(CC) -c -MMD -MP $< -o $@ $(CFLAGS)

# Let make read the dependency files and handle them.
-include $(DEPS) 
```

这应该适用于您的情况：

```
SOURCES := server_UDP.c client_UDP.c
OBJECTS := $(patsubst %.c,%.o,$(SOURCES))

DEPS := $(OBJECTS:.o=.d)

edit: $(OBJECTS)
    gcc -o edit $(OBJECTS)

%.o: %.c
    gcc -c $< -o $@

-include $(DEPS) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T10:29:37.237

您没有说 edit.c 包含您的两个特定标题，但我想它必须，如果它链接到对象。

这正是[makepp](http://makepp.sourceforge.net/)发挥其优势之一的场景：如果您遵循约定，对于`.o`需要链接的每个文件，都有一个相应名称的 include 语句（在您的情况下是`client_UDP.h`& `server_UDP.h`），那么 makepp 将计算所有内容除了将头文件检测为依赖项之外，它还可以自行输出。

这甚至可以递归地工作，因此如果您有一个`wrapHeader.c`（其中没有相应的 include 语句`edit.c`），它将被自动编译和链接。

所以你**不需要 makefile**。但是如果你想避免`makepp edit`每次都调用，那么你可以创建一个单行

```
edit: 
```

如果您有更复杂的要求，您只需要学习 make 语法。但是，如果您这样做，则没有限制。除了做 GNU make 能做的几乎所有事情，还有很多有用的东西，你甚至可以用一些 Perl 编程来扩展你的 makefile。

# python - 在python多处理中修改对象

> ID：15857838
> 
> 赞同：19
> 
> 时间：2013-04-07T01:15:59.190
> 
> 标签：python, parallel-processing, multiprocessing

我有大量自定义对象，我需要对其执行独立（可并行）任务，包括修改对象参数。我尝试过同时使用 Manager().dict 和“sharedmemory”，但两者都不起作用。例如：

```
import numpy as np
import multiprocessing as mp
import sharedmem as shm

class Tester:

    num = 0.0
    name = 'none'
    def __init__(self,tnum=num, tname=name):
        self.num  = tnum
        self.name = tname

    def __str__(self):
        return '%f %s' % (self.num, self.name)

def mod(test, nn):
    test.num = np.random.randn()
    test.name = nn

if __name__ == '__main__':

    num = 10

    tests = np.empty(num, dtype=object)
    for it in range(num):
        tests[it] = Tester(tnum=it*1.0)

    sh_tests = shm.empty(num, dtype=object)
    for it in range(num):
        sh_tests[it] = tests[it]
        print sh_tests[it]

    print '\n'
    workers = [ mp.Process(target=mod, args=(test, 'some') ) for test in sh_tests ]

    for work in workers: work.start()

    for work in workers: work.join()

    for test in sh_tests: print test 
```

打印出来：

```
0.000000 none
1.000000 none
2.000000 none
3.000000 none
4.000000 none
5.000000 none
6.000000 none
7.000000 none
8.000000 none
9.000000 none

0.000000 none
1.000000 none
2.000000 none
3.000000 none
4.000000 none
5.000000 none
6.000000 none
7.000000 none
8.000000 none
9.000000 none 
```

即对象没有被修改。

我怎样才能达到预期的行为？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-07T03:24:43.543

问题在于，当对象被传递给工作进程时，它们会被pickle打包，然后运送到另一个进程，在那里它们被解包并处理。您的对象并没有像克隆的那样传递给其他进程。您不返回对象，因此克隆的对象被愉快地修改，然后被丢弃。

看起来这不能直接完成（[Python：可能在 2 个单独的进程之间共享内存数据](https://stackoverflow.com/questions/1268252/python-possible-to-share-in-memory-data-between-2-separate-processes/1269055#1269055)）。

您可以做的是返回修改后的对象。

```
import numpy as np
import multiprocessing as mp

class Tester:

    num = 0.0
    name = 'none'
    def __init__(self,tnum=num, tname=name):
        self.num  = tnum
        self.name = tname

    def __str__(self):
        return '%f %s' % (self.num, self.name)

def mod(test, nn, out_queue):
    print test.num
    test.num = np.random.randn()
    print test.num
    test.name = nn
    out_queue.put(test)

if __name__ == '__main__':       
    num = 10
    out_queue = mp.Queue()
    tests = np.empty(num, dtype=object)
    for it in range(num):
        tests[it] = Tester(tnum=it*1.0)

    print '\n'
    workers = [ mp.Process(target=mod, args=(test, 'some', out_queue) ) for test in tests ]

    for work in workers: work.start()

    for work in workers: work.join()

    res_lst = []
    for j in range(len(workers)):
        res_lst.append(out_queue.get())

    for test in res_lst: print test 
```

这确实导致了一个有趣的观察，即因为生成的进程是相同的，它们都以相同的随机数种子开始，因此它们*都*生成相同的“随机”数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-07T04:35:06.603

您的代码不会尝试修改共享内存。它只是克隆单个对象。

`dtype=object`表示由于[@tcaswell 提供的链接](https://stackoverflow.com/questions/1268252/python-possible-to-share-in-memory-data-between-2-separate-processes/1269055#1269055)`sharedmem`中列出的原因而无法工作：

> 共享包含指向其他对象的引用/指针的对象图基本上是不可行的

对于可以使用共享内存的普通（值）类型，请参阅[在共享内存中使用 numpy 数组进行多处理](https://stackoverflow.com/questions/7894791/use-numpy-array-in-shared-memory-for-multiprocessing)。

该`manager`方法也应该有效（它只是复制周围的对象）：

```
import random
from multiprocessing import Pool, Manager

class Tester(object):
    def __init__(self, num=0.0, name='none'):
        self.num  = num
        self.name = name

    def __repr__(self):
        return '%s(%r, %r)' % (self.__class__.__name__, self.num, self.name)

def init(L):
    global tests
    tests = L

def modify(i_t_nn):
    i, t, nn = i_t_nn
    t.num += random.normalvariate(mu=0, sigma=1) # modify private copy
    t.name = nn
    tests[i] = t # copy back
    return i

def main():
    num_processes = num = 10 #note: num_processes and num may differ
    manager = Manager()
    tests = manager.list([Tester(num=i) for i in range(num)])
    print(tests[:2])

    args = ((i, t, 'some') for i, t in enumerate(tests))
    pool = Pool(processes=num_processes, initializer=init, initargs=(tests,))
    for i in pool.imap_unordered(modify, args):
        print("done %d" % i)
    pool.close()
    pool.join()
    print(tests[:2])

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-07T04:27:11.350

我没有看到您将 shm 引用传递给子进程，所以我看不到它们所做的工作如何被写回共享内存。也许我在这里遗漏了一些东西。

或者，您是否考虑[过 numpy.memmap](http://docs.scipy.org/doc/numpy/reference/generated/numpy.memmap.html)？（顺便说一句：tcaswell，这里提到的模块似乎是：[numpy-sharedmem](https://bitbucket.org/cleemesser/numpy-sharedmem/src)）。

此外，您可能还想阅读 Sturla Molden 的[Using Python, multiprocessing and NumPy/SciPy for parallel](http://folk.uio.no/sturlamo/python/multiprocessing-tutorial.pdf) numeric Computing (PDF)，如 unutbu 对 [StackOverflow:How do I pass large numpy arrays between python subprocesses without save to disk?] 的回答中所推荐的，以及（[如何在 python 子进程之间传递大型 numpy 数组而不保存到磁盘？](https://stackoverflow.com/questions/5033799/how-do-i-pass-large-numpy-arrays-between-python-subprocesses-without-saving-to-d/5036766#5036766)）。和 Joe Kington 的[StackOverflow：NumPy 与多处理和 mmap](https://stackoverflow.com/a/9975475/149076)。

这些可能比直接相关更具启发性。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-02-07T00:09:50.610

因为你不能在进程之间共享 Python 对象，`multiprocessing`所以如果你有重要的对象，任何使用的实现都将是低效的，因为你必须复制对象才能共享数据。

如果你愿意尝试不同的方法，你可以试试 Ray ( [docs](https://ray.readthedocs.io/en/latest/) )！它是一个可以轻松编写并行和分布式 Python 的框架。简而言之，它使您能够并行启动 Python 函数，类似于`multiprocessing`，但它也更加灵活，因为 Ray 进程可以共享内存。这是您用 Ray 编写的脚本，使用“参与者”（共享对象）的概念：

```
# You can install Ray with pip.
import ray

import numpy as np

# Add this line to signify that you want to share Tester objects
# (called "actors" in Ray) between processes.
@ray.remote
class Tester(object):

    num = 0.0
    name = 'none'
    def __init__(self,tnum=num, tname=name):
        self.num  = tnum
        self.name = tname

    def __str__(self):
        return '%f %s' % (self.num, self.name)

    # Convert mod to be a method of the Tester object.
    def mod(self, nn):
        self.num = np.random.randn()
        self.name = nn

if __name__ == '__main__':

    # Start Ray. This allows you to create shared Testers (called "actors").
    ray.init()

    num = 10

    tests = np.empty(num, dtype=object)
    for it in range(num):
        # Create a shared Tester object (an "actor").
        tests[it] = Tester.remote(tnum=it*1.0)

    # Do some parallel work.
    for test in tests:
        test.mod.remote('some')

    # Compute the __str__ representations of each Tester in parallel.
    test_str_futures = [test.__str__.remote() for test in tests]
    # Get and print the __str__ return values. `ray.get` will block
    # until the return values are ready.
    test_strs = ray.get(test_str_futures)
    for test_str in test_strs:
        print(test_str) 
```

# c++ - 未找到 c++ 时间戳标识符

> ID：15857839
> 
> 赞同：-2
> 
> 时间：2013-04-07T01:16:09.347
> 
> 标签：c++, cgi

我正在尝试获取时间戳以显示系统提供的日期和时间。'time、'asctime' 和 'localtime' 出现错误 - 找不到标识符。我认为这应该是一个简单的解决方法，但我是一个新手程序员并且无法解决问题。谢谢！

```
#include <iostream>
using namespace std;

    int main()
    {
        cout << "Content-type: text/html\n\n";
        cout << "<center><h1>TEST</h1>\n";

        return 0;

        time_t tTime = time(NULL);
    printf("Today is : %s\n", asctime(localtime(&tTime)));
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T01:21:38.990

你忘了添加`#include <time.h>`吗？

# python - 新手？：这是一个变量，函数还是什么？

> ID：15857845
> 
> 赞同：2
> 
> 时间：2013-04-07T01:17:01.107
> 
> 标签：python, function, variables

我是 python 新手，正在尝试编写一个利用多个值进行自动化过程的方程。这些是种群常数。例如，

```
Pop1Stnd=78784000 

Pop2Stnd=150486000

Pop3Stnd=45364000 
```

这是否足以以目前的形式在脚本顶部声明，即（我正在使用 arcpy）在 import arcpy、set.env.workspace 等下方。

如果没有，我需要以其他方式声明吗？也许

```
def Pop1Stnd=78784000 
```

最后，现在的措辞是函数、变量还是什么？非常感谢，大卫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T01:19:13.220

是的，第一种方法是如何声明一个变量并且非常好，但是通常在声明一个常量时，样式要求使用所有大写字母，例如：

```
POP1STND = 78784000 
```

第二种方式：

```
def Pop1Stnd=78784000 
```

将用于定义函数，尽管语法不正确/不完整。它会是这样的：

```
def pop_function("paramaters go here"):
    "do some stuff here" 
```

# java - 执行方法后如何在switch case中返回主菜单？

> ID：15857846
> 
> 赞同：0
> 
> 时间：2013-04-07T01:17:24.503
> 
> 标签：java

如何在所选方法执行后让菜单再次显示？

我有菜单选项打印到控制台。然后它接受用户输入（1 - 6），根据方法调用，然后*应该*返回菜单供用户再次从菜单中选择。

选择的方法执行后，程序就结束了。

```
public static void main (String[] arg) {

    Scanner kbd = new Scanner(System.in);

    String mainMenu = ("Select a choice from the menu: \n" 
            + "1\. Add new DVD entry\n" 
            + "2\. Look Up DVD Entry\n"
            + "3\. Display DVDs By Category\n" 
            + "4\. Remove DVD Entry\n"
            + "5\. Save Data\n" 
            + "6\. Exit");

    System.out.println(mainMenu);

    menuChoice = kbd.nextInt();

    while (menuChoice < 1 || menuChoice > 6) {
        System.out.print("\nError! Incorrect choice.\n");
        System.out.println(mainMenu);
        menuChoice = kbd.nextInt();
    }

    switch (menuChoice) {
    case 1: {
        // method code
        }
        else {
            // method code
            return;
        }
    }

    case 2: {
        // method code
        return;
    }

    case 3: {
        // method code
        return;
    }

    case 4: {
        // method code
        return;
    }   

    case 5: {
        // method code
        return;
    }

    case 6: {
        // method code
        System.exit(0);
        return;
    }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-07T01:21:47.727

使用 do while

```
do
{
    System.out.println(mainMenu);

    menuChoice = kbd.nextInt();

   ... switch/case ...
   ... remove the return statements from your cases.

} while (menuChoice != 6); 
```

您还必须`return`从您`case`的 s. 否则它将返回主目录。将它们替换为`break`;

这就是开关盒需要的方式

```
switch (menuChoice) 
{
    case 1: 
        Do what you want. 
        break;
    case 2:
        ...
        break;
    default:
        ...
        break;
} 
```

您通常不需要`{`或`if`在开关盒内。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T01:21:37.120

将您的代码包装在里面

```
 while(menuChoice != 6) 
    { 
      ... 
    } 
```

# vb.net - 在控制台应用程序中通过空格创建单词的所有组合

> ID：15857849
> 
> 赞同：1
> 
> 时间：2013-04-07T01:17:27.213
> 
> 标签：vb.net, console

我正在尝试对此进行试验，[http](http://gyazo.com/8190a3c98a520bbeb77335e05ea5a636) ://gyazo.com/8190a3c98a520bbeb77335e05ea5a636 （一个视觉基本控制台应用程序）。我希望它允许用户输入这样的单词，并让控制台以所有可能的间隔组合回复它，所以：

假设我正在使用 TEST 这个词，例如，它将像这样间隔创建：

```
T EST
T E ST
T E S T
TE ST
TES T
T ES T 
```

依此类推……（比如每个组合都可以用多个空格隔开或不隔开）

这可以通过控制台应用程序实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:54:49.857

数数时，从最低位开始。您从该数字从零开始计数，直到达到该数字的最大值，如下所示：`0, 1, 2, 3, 4, 5, 6, 7, 8, 9`. 然后，一旦达到最高值，您必须添加第二个数字（例如`10`）。`10 - 19`然后，在再次增加第二个数字（例如 20）之前，再次从最低位到最高位（例如 ）。这样，一旦达到`999`，您将在一个三位数的数字中列出所有可能的值组合。

当以二进制计数时，它的工作方式相同，但每个数字的最大值是一个，所以你可以像这样从最低位开始计数`0, 1`：然后你必须添加第二个数字并再次计数：`10, 11`。然后您需要添加第三个数字（例如`100`）并在前两个上再次执行所有操作。当您到达 时`111`，您将在一个三位二进制数中列出所有可能的 1 和 0 组合。

因此，如果您将每个字母之间的空格视为二进制数中的一个数字，其中 0 表示没有空格，1 表示有空格，那么您所要做的就是从 0 向上计数到二进制中的最大值与单词长度相同的位数减去 1。因此，例如，对于单词`TEST`，计数将如下所示：

*   `000`=`TEST`
*   `001`=`TES T`
*   `010`=`TE ST`
*   `011`=`TE S T`
*   `100`=`T EST`
*   ...

# java - 我的代码创建并发修改异常

> ID：15857850
> 
> 赞同：-1
> 
> 时间：2013-04-07T01:17:31.700
> 
> 标签：java, exception, concurrency

我有一个 void，当它被调用时，它会发送一个并发修改异常。我不明白为什么我一直得到它，即使我没有看到正在执行任何并发修改。

```
public static void destroyPlayingGame() {
    for (CastleWarBarricade npc : playingGame.barricades) {
         playingGame.removeBarricade(CastleWars.SARADOMIN, npc);
         playingGame.removeBarricade(CastleWars.ZAMORAK, npc);
    }
    for (WorldObject object : playingGame.spawnedObjects)
        World.destroySpawnedObject(object, false);
    for (CastleWarBarricade npc : playingGame.barricades)
        npc.finish();

    playingGame.spawnedObjects.clear();
    playingGame.barricades.clear();
    playingGame.cancel();
    playingGame = null;
    refreshAllPlayersTime();
    leavePlayersSafely();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T01:24:27.557

并发修改必须发生在循环中的方法调用之一中。例如，可以从集合`removeBarricade`中移除`npc`对象。`playingGame.barricades`这是一个并发修改。

> 那我该怎么做呢？

更改`removeBarricade`使其不会从集合中删除对象，然后改为执行以下操作：

```
for (Iterator<CastleWarBarricade> it = playingGame.barricades.iterator();
     it.hasNext(); ) {
     CastleWarBarricade npc = it.next();
     if (playingGame.removeBarricade(CastleWars.SARADOMIN, npc) ||
         playingGame.removeBarricade(CastleWars.ZAMORAK, npc)) {
         it.remove();
     }
} 
```

或者，构建要删除的东西的集合，并`removeAll`在循环结束后通过调用删除它们！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T01:21:32.913

基本上，您不能在 for-each 语句中修改 Collection

```
for (CastleWarBarricade npc : playingGame.barricades) {...} 
```

在上述声明中修改您的游戏收藏是非法的

**更新**

您可以有多种选择。

你可以使用`for-next`循环...

```
for (int index = 0; index < playingGame.barricades.size(); index++) {
    CastleWarBarricade npc = playingGame.barricades.get(index);
    playingGame.removeBarricade(CastleWars.SARADOMIN, npc);
    playingGame.removeBarricade(CastleWars.ZAMORAK, npc);
} 
```

您可以将原始集合转换为数组并使用`for-each`

```
CastleWarBarricade[] values = playingGame.barricades.toArray(new CastleWarBarricade[playingGame.barricades.size]);
for (CastleWarBarricade npc : values) {
    playingGame.removeBarricade(CastleWars.SARADOMIN, npc);
    playingGame.removeBarricade(CastleWars.ZAMORAK, npc);
} 
```

# android - AlarmManager 重复请求

> ID：15857856
> 
> 赞同：0
> 
> 时间：2013-04-07T01:18:49.523
> 
> 标签：android

有3个班。服务类，执行类，接收类

首先，服务类在“执行类”中执行Amethod

“执行类”中的代码是

```
Amethod(){
    Intent intent = new Intent();
            intent.setAction("MY_ACTION");
            PendingIntent pi = PendingIntent.getBroadcast( context, 0, intent, PendingIntent.FLAG_CANCEL_CURRENT );
            AlarmManager am = (AlarmManager)context.getSystemService( Context.ALARM_SERVICE );  
            am.cancel(pi);
            if(true){//to repaet every 10 sec.  
            am.set( AlarmManager.RTC_WAKEUP,10000, pi );
    }
} 
```

这个动作将发送给接收者。

```
if(action.equals("MY_ACTION")){
            Log.d("test","test");
            Amethod(); 
```

我想这个“方法”将每 10 秒调用一次。但它每 10 毫秒重复一次，也许方法被调用和调用。

为什么这样有效？请告诉我哪个代码是我的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:32:22.903

如果你想要一个重复的闹钟，不要这样设置每个闹钟。第一次使用 setRepeating，之后会继续。

# matlab - 取稀疏矩阵每一列中所有非零元素的乘积

> ID：15857858
> 
> 赞同：2
> 
> 时间：2013-04-07T01:19:00.643
> 
> 标签：matlab, octave, vectorization, sparse-matrix, multiplication

是否有一种很好的向量化方法来获取八度音阶（或matlab）中稀疏矩阵每一列中所有非零元素的乘积（返回乘积的行向量）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-07T01:28:22.217

我会`find`结合`accumarray`：

```
%# create a random sparse array
s = sprand(4,4,0.6);

%# find the nonzero values
[rowIdx,colIdx,values] = find(s);

%# calculate product
product = accumarray(colIdx,values,[],@prod) 
```

* * *

一些替代方案（可能效率较低；您可能想要对它们进行概要分析）

```
%# simply set the zero-elements to 1, then apply prod
%# may lead to memory issues
s(s==0) = 1;
product = prod(s,1); 
```

.

```
%# do "manual" accumarray
[rowIdx,colIdx,values] = find(s);

product = zeros(1,size(s,2));
uCols = unique(colIdx);

for col = uCols(:)'
    product(col) = prod(values(colIdx==col));
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T20:57:06.100

我找到了解决这个问题的另一种方法，但在最坏的情况下它可能会更慢并且不太精确：

只需记录所有非零元素的对数，然后对列求和。然后取结果向量的 exp：

```
function [r] = prodnz(m)
    nzinds = find(m != 0);
    vals = full(m(nzinds));
    vals = log(vals);
    m(nzinds) = vals;
    s = full(sum(m));
    r = exp(s);
endfunction 
```

# linux - 如何使用 Linux 命令（sed？）删除文件中的特定行？

> ID：15857865
> 
> 赞同：0
> 
> 时间：2013-04-07T01:20:15.880
> 
> 标签：linux, sed

我有一个包含矩阵的文件。例如，我有：

```
1 a  2  b
2 b  5  b
3 d  4  b
4 b  7  b 
```

`sed`我知道使用命令删除带有特定字符串的特定行很容易。但是，如果我只想删除第二个字段的值为 b 的那些行（即第二行和第四行）怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-07T01:28:00.110

您可以在 sed 中使用正则表达式。

```
sed -i 's/^[0-9]\s+b.*//g' xxx_file 
```

或者

```
sed -i '/^[0-9]\s+b.*/d' xxx_file 
```

“-i”参数将直接修改文件的内容，您可以删除“-i”并根据需要将结果输出到其他文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T01:48:35.767

awk：

```
cat yourfile.txt | awk '{if($2!="b"){print;}}' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-07T11:04:34.150

awk 工作正常，只需使用如下代码：

```
awk '{if ($2 != "b") print $0;}' file 
```

如果你想获得更多关于 的用法`awk`，就`man`这样吧！

# android - android:cacheColorHint="#00000000" 不适用于 我正在使用 ExpandableListView，当展开和滚动时，滚动完成时它会变黑一秒钟。我使用了“android:cacheColorHint="#00000000" 但它似乎不适用于可扩展的列表视图。代码是： <ExpandableListView android:id="@+id/an 问问题 问问题 2013-04-07T01:20:31.570 1826 次 This question shows research effort; it is useful and clear 4 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我正在使用 ExpandableListView，当展开和滚动时，滚动完成时它会变黑一秒钟。我使用了“android:cacheColorHint="#00000000" 但它似乎不适用于可扩展的列表视图。代码是： <ExpandableListView android:id="@+id/android:list" android:layout_width="fill_parent" android:layout_height="wrap_content" android:layout_marginBottom="55dp" android:divider="@color/color_negro" android:listSelector="@android:color/transparent" android:cacheColorHint="#00000000" android:childDivider="@color/color_negro" android:descendantFocusability="afterDescendants" android:background="@null"> </ExpandableListView> 并绘制每个孩子： public View newChildView(boolean isLastChild, ViewGroup parent) { if(layoutInflater == null){ layoutInflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE); } return layoutInflater.inflate(R.layout.row_personas, null, false); } row_personas.xml 的代码： <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" android:layout_width="fill_parent" android:layout_height="fill_parent" android:orientation="vertical" > <LinearLayout android:layout_width="fill_parent" android:layout_height="wrap_content" android:orientation="horizontal" android:background="@layout/custom_text_view_apellido" android:layout_marginLeft="20dp" android:layout_marginRight="15dp" > <TextView android:id="@+id/rowApellido" android:layout_width="wrap_content" android:layout_height="wrap_content" android:textColor="@color/color_negro" android:textSize="14sp" android:paddingLeft="10dp" android:paddingTop="0dp" android:paddingRight="4dp" android:paddingBottom="5dp" android:typeface="sans" android:maxLength="20" > </TextView> <TextView android:id="@+id/rowNombres" android:layout_height="wrap_content" android:layout_width="fill_parent" android:textSize="14sp" android:textColor="@color/color_negro" android:paddingBottom="5dp" android:layout_marginRight="5dp" android:maxLength="20" android:singleLine="true" android:typeface="sans" android:paddingTop="0dp" > </TextView> </LinearLayout> <LinearLayout android:layout_width="fill_parent" android:layout_height="wrap_content" android:orientation="horizontal" android:layout_marginLeft="20dp" android:layout_marginRight="15dp"> <ImageView android:id="@+id/photo" android:layout_height="34dp" android:layout_width="41dp" android:layout_marginTop="2dp" android:layout_marginRight="2dp" /> <LinearLayout android:layout_width="fill_parent" android:layout_height="wrap_content" android:orientation="vertical"> <TextView android:id="@+id/rowDatoRelevante" android:layout_width="fill_parent" android:layout_height="wrap_content" android:textStyle="bold" android:textColor="@color/color_gris_oscuro" android:textSize="12sp" android:paddingLeft="15dp" android:paddingTop="1dp" android:paddingBottom="1dp" android:background="@layout/custom_text_view_categoria" android:gravity="left" android:layout_marginRight="25dp" android:singleLine="true"> </TextView> <TextView android:id="@+id/rowDatoRelevante2" android:layout_width="fill_parent" android:layout_height="wrap_content" android:textStyle="italic" android:textColor="@color/color_gris_oscuro" android:textSize="12sp" android:paddingLeft="15dp" android:background="@layout/custom_text_view_categoria_desc" android:gravity="left" android:layout_marginRight="55dp" android:singleLine="true"> </TextView> </LinearLayout> </LinearLayout> </LinearLayout> 如果有人可以帮助我...谢谢！！！！！！！ 使用事件源时检测客户端断开连接 我正在尝试为 Yesod 中的一个网站构建一个聊天功能，我希望它有一个所有已连接用户的列表。我想最好的方法是将该人添加到连接上的用户列表中，并在他们离开时将其删除。如果保持连接打开，似乎响应应该阻塞，所以我天真地写了 getReceiveR :: Handler () getReceiveR = do App chan <- getYesod req <- waiRequest res <- lift $ eventSourceAppChan chan req sendWaiResponse res liftIO $ putStrLn "client disconnected" <-- Note this 但它当然不起作用，因为 sendWaiResponse 短路了。 有什么方法可以检测客户端何时断开连接？ 编辑：我正在使用本教程的一个非常修改的版本来测试这个概念。 androidbackgroundscrollexpandablelistview 4 2 回答 2 This answer is useful 3 我解决了我的问题！！！我以这种方式更改了 ExpandableListView 的声明： <ExpandableListView android:id="@+id/android:list" android:layout_width="fill_parent" android:layout_height="wrap_content" android:layout_marginBottom="55dp" android:scrollbarAlwaysDrawVerticalTrack="true" android:divider="@android:color/black" android:childDivider="@android:color/transparent" android:listSelector="@android:color/transparent" android:cacheColorHint="@android:color/transparent" android:background="@android:color/transparent"> </ExpandableListView> 我认为问题在于将黑色分配给“android：childDivider”。我希望能帮助这个人！ 于 2013-04-13T01:07:50.947 回答 This answer is useful 0 我可以通过绘制一个9 补丁 png并将其设置为childDivider. 我的 9 补丁 png 高两个像素：第一行设置为所需的分隔线颜色，第二行 - 可拉伸 - 透明。 于 2013-12-04T13:13:20.860 回答 Related 1 android - ViewPager 在更改最低 SDK 版本时在同一设备上运行速度较慢 1 paypal - 忽略某些 SetExpressCheckout 参数的 PayPal Express Check Out Recurring Payments 1 ruby-on-rails - ruby on rails form_for 自引用模型 1 sql - sql根据单元格值创建表 1 c - MMAP 中的 ENODEV 错误 1 iphone - 通过 Twitter API v1.1 搜索通用推文 1 windows-phone-8 - 使用情节提要 Windows phone 8 制作动画 4 java - 如何将主题设置为 ProgressDialog？ 0 ios - 辞职响应者时 UITextField 重新定位 1 ios - xcode 上的 ponydebugger ，代码片段未显示 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：15857866
> 
> 赞同：4
> 
> 时间：
> 
> 标签：android, background, scroll, expandablelistview

我正在使用 ExpandableListView，当展开和滚动时，滚动完成时它会变黑一秒钟。我使用了“android:cacheColorHint="#00000000" 但它似乎不适用于可扩展的列表视图。代码是：

```
 <ExpandableListView android:id="@+id/android:list"
        android:layout_width="fill_parent" android:layout_height="wrap_content"
        android:layout_marginBottom="55dp" android:divider="@color/color_negro"
        android:listSelector="@android:color/transparent"
        android:cacheColorHint="#00000000" android:childDivider="@color/color_negro"
        android:descendantFocusability="afterDescendants" android:background="@null">
    </ExpandableListView> 
```

并绘制每个孩子：

```
 public View newChildView(boolean isLastChild, ViewGroup parent) {
                if(layoutInflater == null){
                    layoutInflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                }
                return layoutInflater.inflate(R.layout.row_personas, null, false);
            } 
```

row_personas.xml 的代码：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent" android:layout_height="fill_parent"
android:orientation="vertical" >

<LinearLayout android:layout_width="fill_parent"
android:layout_height="wrap_content" android:orientation="horizontal"
android:background="@layout/custom_text_view_apellido"
android:layout_marginLeft="20dp" android:layout_marginRight="15dp"
>

<TextView android:id="@+id/rowApellido" android:layout_width="wrap_content"
android:layout_height="wrap_content" android:textColor="@color/color_negro"
android:textSize="14sp" android:paddingLeft="10dp"
android:paddingTop="0dp" android:paddingRight="4dp"
android:paddingBottom="5dp" android:typeface="sans"
android:maxLength="20" >
</TextView>

<TextView android:id="@+id/rowNombres" android:layout_height="wrap_content"
android:layout_width="fill_parent" android:textSize="14sp"
android:textColor="@color/color_negro" android:paddingBottom="5dp"
android:layout_marginRight="5dp" android:maxLength="20"
android:singleLine="true" android:typeface="sans" android:paddingTop="0dp" >
</TextView>

</LinearLayout>

<LinearLayout android:layout_width="fill_parent"
android:layout_height="wrap_content" android:orientation="horizontal"
android:layout_marginLeft="20dp" android:layout_marginRight="15dp">

<ImageView android:id="@+id/photo" android:layout_height="34dp"
android:layout_width="41dp" android:layout_marginTop="2dp"
android:layout_marginRight="2dp" />

<LinearLayout android:layout_width="fill_parent"
android:layout_height="wrap_content" android:orientation="vertical">

<TextView android:id="@+id/rowDatoRelevante"
android:layout_width="fill_parent" android:layout_height="wrap_content"
android:textStyle="bold" android:textColor="@color/color_gris_oscuro"
android:textSize="12sp" android:paddingLeft="15dp"
android:paddingTop="1dp" android:paddingBottom="1dp"
android:background="@layout/custom_text_view_categoria"
android:gravity="left" android:layout_marginRight="25dp"
android:singleLine="true">
</TextView>

<TextView android:id="@+id/rowDatoRelevante2"
android:layout_width="fill_parent" android:layout_height="wrap_content"
android:textStyle="italic" android:textColor="@color/color_gris_oscuro"
android:textSize="12sp" android:paddingLeft="15dp"
android:background="@layout/custom_text_view_categoria_desc"
android:gravity="left" android:layout_marginRight="55dp"
android:singleLine="true">
</TextView>
</LinearLayout>
</LinearLayout>

</LinearLayout> 
```

如果有人可以帮助我...谢谢！！！！！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T01:07:50.947

我解决了我的问题！！！我以这种方式更改了 ExpandableListView 的声明：

```
<ExpandableListView android:id="@+id/android:list"
android:layout_width="fill_parent" android:layout_height="wrap_content"
android:layout_marginBottom="55dp"
android:scrollbarAlwaysDrawVerticalTrack="true" android:divider="@android:color/black"
android:childDivider="@android:color/transparent"
android:listSelector="@android:color/transparent"
android:cacheColorHint="@android:color/transparent"
android:background="@android:color/transparent">
</ExpandableListView> 
```

我认为问题在于将黑色分配给“android：childDivider”。我希望能帮助这个人！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-04T13:13:20.860

我可以通过绘制一个*9 补丁 png*并将其设置为`childDivider`. 我的 9 补丁 png 高两个像素：第一行设置为所需的分隔线颜色，第二行 - 可拉伸 - 透明。

# ruby-on-rails - Rails 应用程序中的 Enqueue_at(..) 错误。Resque 调度程序引发 NoQueueError

> ID：15857868
> 
> 赞同：2
> 
> 时间：2013-04-07T01:20:59.413
> 
> 标签：ruby-on-rails, resque

我在尝试使用 ResqueScheduler enqueue_at 时不断收到此错误

```
QuestionsController#create 中的 Resque::NoQueueError
作业必须放在队列中。

```

这是调用它的类：注意 after_create 回调。

在 Questions 控制器中引发错误的原因是因为有一个回调 `on_create` ，`Question`反过来，它会`Assignment`为用户创建一个。

这是这篇文章的后续问题：

[resque 调度程序作业的奇怪行为](https://stackoverflow.com/questions/15857412/strange-behavior-with-a-resque-scheduler-job)

我尝试按照此视频中给出的示例进行操作： [http ://railscasts.com/episodes/271-resque?view=comments](http://railscasts.com/episodes/271-resque?view=comments)

. . .以及阅读我在 Resque 调度程序上可以在线找到的所有内容（包括他们的文档：[https](https://github.com/bvandenbos/resque-scheduler) ://github.com/bvandenbos/resque-scheduler ）

我有理由相信我做对了，此时我很沮丧。这似乎是一个非常罕见的在线错误，几乎没有文档。

```
    需要“scheduler_job”
    类分配 ActiveRecord::Base
      属于_to：用户
      属于_to：问题
      attr_accessible :title, :body, :user_id, :question_id , :response , :correct
      after_create :queue_assignments
      before_destroy :remove_from_queue

      默认等级
        self.correct = (response == self.question.solution) 除非 response == nil
      结尾

      def queue_assignments
        Resque.enqueue_at(self.question.schedule , SchedulerJob , :id => self.id)
      结尾
      def remove_from_queue
        Resque.remove_delayed(SchedulerJob, :id => self.id)
      结尾
      def sendAlertEmail
        QuestionMailer.question(self)
      结尾
      def as_json(options={})
        {
          ：正确 => 正确，
          :created_at => created_at,
          :id => id,
          :question_id => question_id,
          ：响应=>响应，
          :updated_at => updated_at,
          :user_id => user_id,
          :question => self.question
        }
      结尾
    结尾

```

这是工作：

```
    需要“分配”
    需要“问题邮件”
    # 当我把它改成一个类时这也不起作用
    模块调度器作业

      #this 也不适用于 :ready_queue 但我不知道有什么区别
      @ready_queue = "ready_queue"
      def self.perform(id)
        @assignment=assignment.find_by_id(id)
        @assignment.sendAlertEmail
      结尾

    结尾

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-07T02:31:14.793

好的，经过大量的故障排除并将我的头撞到墙上，我终于让它工作了。

实例变量必须命名为`@queue`。问题是我正在命名它`@ready_queue`。我猜resque调度程序需要这个。反正。它现在似乎正在工作。到下一个错误。

# uml - 用例场景

> ID：15857869
> 
> 赞同：0
> 
> 时间：2013-04-07T01:21:18.073
> 
> 标签：uml, use-case

在注册用例场景中，用户通过唯一电子邮件代码确认注册是否属于注册用例场景的一部分？

1.  系统会向用户发送确认电子邮件以激活其帐户。

2.  显示用户的屏幕消息。

3.  用户通过电子邮件代码激活他们的帐户。

4.  用例结束。

3 是用例场景的一部分吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:28:45.893

*编辑：对不起，我之前没有很好地阅读这个问题。*

答案是**否定**的。您的图表应该包括您的系统提供的*服务*或*功能*，因此它应该包括用例**注册**。此过程的内部步骤不包含在此类图中。为此，您将使用序列图，例如...

来自[developer.com](http://www.developer.com/design/article.php/2109801/Creating-Use-Case-Diagrams.htm)：

*   **用例**：用例图中的用例是系统中不同业务功能的可视化表示。这里的关键术语是“独特的业务功能”。要选择业务流程作为建模为用例的可能候选者，您需要确保业务流程本质上是离散的。作为识别用例的第一步，您应该在问题陈述中列出离散的业务功能。这些业务功能中的每一个都可以归类为一个潜在的用例。请记住，识别用例是一种发现，而不是一种创造。随着业务功能变得更加清晰，底层用例变得更加明显。

# python - 如何正确显示http头中的中文信息？

> ID：15857870
> 
> 赞同：0
> 
> 时间：2013-04-07T01:21:20.980
> 
> 标签：python, html, header, codec

例如，一个Get请求后，Server返回如下信息：

```
HTTP/1.1 200 OK 
Date: Mon, 19 Jan 2009 06:37:47 GMT 
Server: IBM_HTTP_Server/6.0.2 Apache/2.0.47 (Unix) 
Content-Disposition: attachment; filename=MPLS TE Switching%E6%96%B9%E6%A1%88%E7%99%BD%E7%9A%AE%E4%B9%A6.pdf 
Content-Length: 1444670 
Content-Type: application/octet-stream 
Content-Language: zh-CN 
```

MPLS TE Switching%E6%96%B9%E6%A1%88%E7%99%BD%E7%9A%AE%E4%B9%A6.pdf是中文字符串文件名，应该是怎么转换才能正常显示? 我所做的是使用：

```
filename.decode("iso-8859-1") 
```

但它没有用！

# java - 另一个字符串的子字符串会阻止父字符串被垃圾收集吗？

> ID：15857883
> 
> 赞同：1
> 
> 时间：2013-04-07T01:23:42.253
> 
> 标签：java, garbage-collection

```
String samplel = "ToBeGarbageCollected";
String sample2 = samplel.substring(0, 1);
samplel = null; 
```

我知道子字符串内部会保留原始字符串的引用。

但是通过明确定义`samplel`as `null`，sample1 和 sample2 是否可用于垃圾收集？

我记得在某处看到如果父对象显式设置为`null`所有子值都可用于垃圾收集。这对上述情况有好处吗？我只是好奇这是否是父子关系场景？如果没有，这会导致`sample1`或`sample2`可用于垃圾收集吗？

```
String samplel = "ToBeGarbageCollected";
String sample2 = new String(samplel .substring(0, 1));
samplel  = null; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-07T01:43:42.340

首先要说的是垃圾收集不会立即发生。因此，分配`null`给任何东西都不会/不会*导致*垃圾收集。*可能会*导致对象变得*无法访问*......这将使其成为未来 GC 运行中垃圾收集的潜在候选对象。

* * *

现在到你的具体例子。

**重要提示：**以下*仅*适用于较旧的 JVM；即 Java 7 更新 5 及更早版本。在 Java 7 更新 6 中，它们进行了更改`String.substring()`，以便目标字符串和生成的子字符串不共享支持数组。这消除了`substring`.

* * *

该`substring`方法不会在新字符串中引用原始字符串。它实际上所做的是保存对原始字符串支持数组的引用；即保存字符的数组。

但是话虽如此，分配`null`给`samplel`并不足以使整个原始字符串的状态不可达。原始字符串的*整个*后备数组将保持可访问性......这意味着它不会成为垃圾收集的候选者。

但还有另一个并发症。您设置`sample1`为 String 文字，并且表示 String 文字的 String 对象*始终*是可访问的（除非整个类被卸载！）

> 但是通过将 samplel 显式定义为 null，sample1 和 sample2 是否可用于垃圾回收？

原始`sample1`对象将保持完全可访问，并且`sample2`除非该变量超出范围，否则将保持可访问。

如果`sample1`不是文字并且没有其他参考，那么答案会有所不同。该`sample1`对象将无法访问，但其支持数组仍可通过`sample2`.

* * *

在您的第二个示例中，复制子字符串会导致创建一个新字符串。并且保证新字符串不会与原始字符串和临时子字符串共享后备数组。在这种情况下，分配`null`是不必要的。

> 现在 sample1 和 sample2 都可用于垃圾收集吗？

`sample1`对于字面量的情况，答案与上述相同。

如果`sample1`不是文字并且没有其他对它的引用，那么`sample1`临时子字符串现在将无法访问。

* * *

> 我只想知道 String 构造函数在哪里有帮助。

理论上会的。

在实践中，这取决于当 GC 最终开始查找时引用是否仍然可以访问......以及所讨论的字符串是否足够大并且足够多以对内存使用产生重大影响。

*在实践中，通常*不满足该前提条件，并且创建这样的新字符串*通常*无济于事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-07T01:41:18.457

请记住，在 Java`String`中是不可变的。在这种情况下，`sample1`将被丢弃，但从`sample2`不指向`sample1`：它指向 JVM 中一个单独保存的不可变字符串，该字符串最迟在`substring`被调用时创建。

当您设置`sample1`为 null 时，它指向的内存可用于垃圾回收（假设没有其他字符串具有相同的值，并且没有其他变量指向该位置）。当您使用`new`关键字（或通过分配原语隐式这样做）时，会在堆上分配新内存（通常；同样，字符串是不可变的并共享相同的内存）。如果没有指针（读取：任何命名变量）指向给定的内存位置，则它可用于垃圾收集。

请记住：在没有对对象的引用的任何情况下，它都可用于垃圾收集。对象不是由分配给它们的变量名定义的，而是在内存中的位置，变量名充当这些对象的指针（引用）。字符串有些不同，因为它们是不可变的，并且 JVM 可能会出于与对它们的引用无关的原因选择不进行垃圾收集。

# ruby-on-rails - Ruby on Rails：返回 nil 的地方

> ID：15857884
> 
> 赞同：1
> 
> 时间：2013-04-07T01:23:45.473
> 
> 标签：ruby-on-rails, ruby, model

在我的应用程序中，我正在获取某个类别，并根据它们的名称过滤关联的项目。下面的代码应该很清楚：

```
categories = Category.where(:id => params[:category_id]).includes(:items).where("lower(items.name) like ?", "%#{params[:keywords].downcase}%") 
```

但是，如果名称过滤器排除了所有项目，则`categories`where 返回的对象为 nil。这是预期的行为吗？即使项目存在与否，我如何获得类别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:32:04.087

最简单的方法可能是拆分查询：

```
@category = Category.find(params[:category_id])
@items = @category.items.where("lower(items.name) like ?", "%#{params[:keywords].downcase}%") 
```

根据您的代码，它似乎`category_id`只引用了 1 个类别，因此我将其更改为单数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T06:01:31.347

您应该考虑对 items 表执行 OUTER JOIN，这将为您提供类别，无论它们的项目是否符合名称过滤器。

# java - 选择未填充从其他表映射的值的选项

> ID：15857892
> 
> 赞同：1
> 
> 时间：2013-04-07T01:25:09.130
> 
> 标签：java, playframework, playframework-2.0

我有两个模型之间的映射，`Movie`并且`Place`. 当我现在创建一个从`movieForm`并填写一个已经创建`Movie`并打开的视图时，`movieForm`会填充一个包含所有文本字段和选择的视图，除了映射`Place`到`Movie`. 在下面的示例中，在视图的“选择”中选择了正确的类别，但未选择该地点。

可能是什么问题？我该如何解决这个问题？

* * *

### 电影模特

```
@Entity
public class Movie extends Model {

    @Id
    public Long id;
    ...
    @Required
    @Formats.NonEmpty
    public EnumCategorie categorie = EnumCategorie.FILM;
    @ManyToOne
    public Place place;

    ...
} 
```

### 放置模型

```
@Entity
public class Place extends Model {
    @Id
    public String name;
    ...
} 
```

### 控制器

```
public class Movies extends Controller {
    public static Result edit(Long id) {
        Movie movie = Movie.find.byId(id);
        Form<Movie> movieForm = form(Movie.class).fill(movie);
        return ok(movieCreate.render(movieForm,
                placeForm, "edit"));
    } 
```

### 风景

```
@form(routes.Movies.save(option)) {
        <fieldset>
        ...
        @select(movieForm("categorie"),
            options(Movie.categories),
            '_label -> "Categories", '_default -> "-- Choose a categorie --",
            '_showConstraints -> false,
            'class -> "controls")
        @select(movieForm("place"),
            options(Place.places),
            '_label -> "Places", '_default -> "-- Choose a place --",
            '_showConstraints -> false,
            'class -> "controls")
        ...
        </fieldset> 
```

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T02:31:51.060

我猜你错过了`Place.java`模型上的这行代码。该模型可能如下所示：

### 放置模型

```
@Entity
public class Place extends Model {
   @Id
   public String name;

   ... // the rest of fields

   // Sample of all Places data as value of select option in views
   public static List<String> places() {
      List<String> all = new ArrayList<>();
      all.add("INA"); // Place.name = "INA"
      all.add("BEL"); // Place.name = "BEL"
      all.add("KOR"); // Place.name = "KOR"
      return all;
   }

   // You missed this 
   public String toString() {
      return name; // return Place.name
   }
} 
```

* * *

好的，现在这就是解释。让我们在以下位置查看您的视图代码：

```
@select(movieForm("place"), options(Place.places), ...) 
```

唯一适用于以下`options(...)`数据类型（取自 play2 源）：

```
def apply(options: (String, String)*) = ...
def apply(options: Map[String, String]) = ...
def apply(options: java.util.Map[String, String]) = ...
def apply(options: List[String]) = ...
def apply(options: java.util.List[String]) = ... 
```

因为你在`Movie`类上的 place 字段是`Place`对象而不是`String`对象，所以它应该表示为`String`. 您可以定义它的方式是覆盖对象`toString()`上的方法`Place`，因此它将`Place.name`值（模型**的 ID** ）表示为`Place`视图中选择选项的值（指使用 填充的数据`Place.places()`）。

希望这可以帮助解决您的问题。

* * *

### 更新

如果我们选择不覆盖模型上的方法，我们还可以执行以下操作`toString()`：

```
`@select(movieForm("place.name"), options(Place.places), ...)` 
```

`movieForm("place.name")`可用于`Place`直接绑定具有对应输入值的 ID 值的对象。[这个相关的问题](https://stackoverflow.com/questions/11802566/binding-form-request-with-manytoone-field-on-play-framework-2)可以作为这个解决方案的参考。

# vb.net - 在继续代码 VB.net 之前等待 0.5 秒

> ID：15857893
> 
> 赞同：27
> 
> 时间：2013-04-07T01:25:09.947
> 
> 标签：vb.net, wait

我有一个代码，我希望它在中间某个地方等待，然后再继续。在 WebBrowser1.Document.Window.DomWindow.execscript("checkPasswordConfirm();","JavaScript") 之后，我希望它等待 0.5 秒，然后执行其余代码。

```
 WebBrowser1.Document.Window.DomWindow.execscript("checkPasswordConfirm();","JavaScript")

    Dim allelements As HtmlElementCollection = WebBrowser1.Document.All
    For Each webpageelement As HtmlElement In allelements
        If webpageelement.InnerText = "Sign Up" Then
            webpageelement.InvokeMember("click")
        End If
    Next 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-04-07T10:01:13.980

您需要使用[System.Threading.Thread.Sleep(number of milliseconds)](http://msdn.microsoft.com/en-us/library/d00bd51t.aspx)。

```
WebBrowser1.Document.Window.DomWindow.execscript("checkPasswordConfirm();","JavaScript")

Threading.Thread.Sleep(500) ' 500 milliseconds = 0.5 seconds

Dim allelements As HtmlElementCollection = WebBrowser1.Document.All
For Each webpageelement As HtmlElement In allelements
    If webpageelement.InnerText = "Sign Up" Then
        webpageelement.InvokeMember("click")
    End If
Next 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-04-01T17:36:30.120

这个问题很老，但这是另一个答案，因为它对其他人有用：

**thread.sleep**不是一个好的等待方法，因为通常它会冻结软件直到完成它的时间，这个函数更好：

```
 Imports VB = Microsoft.VisualBasic

   Public Sub wait(ByVal seconds As Single)
     Static start As Single
     start = VB.Timer()
     Do While VB.Timer() < start + seconds
       System.Windows.Forms.Application.DoEvents()
     Loop
   End Sub 
```

上述功能会等待特定时间而不冻结软件，但会增加 CPU 使用率。

此功能不仅不会冻结软件，而且不会增加 CPU 使用率：

```
 Private Sub wait(ByVal seconds As Integer)
     For i As Integer = 0 To seconds * 100
       System.Threading.Thread.Sleep(10)
       Application.DoEvents()
     Next
   End Sub 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-11-18T19:18:00.803

```
Imports VB = Microsoft.VisualBasic

Public Sub wait(ByVal seconds As Single)
    Static start As Single
    start = VB.Timer()
    Do While VB.Timer() < start + seconds
        System.Windows.Forms.Application.DoEvents()
    Loop
End Sub 
```

%20+ 高 CPU 使用率 + 无延迟

```
Private Sub wait(ByVal seconds As Integer)
    For i As Integer = 0 To seconds * 100
        System.Threading.Thread.Sleep(10)
        Application.DoEvents()
    Next
End Sub 
```

%0.1 cpu 使用率 + 高延迟

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-07T02:00:57.917

做一个计时器，当它滴答作响时，它会激活你想要的任何代码。确保计时器代码的第一行是：

```
timer.enabled = false 
```

用您命名的计时器替换计时器。

然后在您的代码中使用它：

```
 WebBrowser1.Document.Window.DomWindow.execscript("checkPasswordConfirm();","JavaScript")
timer.enabled = true
Dim allelements As HtmlElementCollection = WebBrowser1.Document.All
For Each webpageelement As HtmlElement In allelements
    If webpageelement.InnerText = "Sign Up" Then
        webpageelement.InvokeMember("click")
    End If
Next 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-02T10:29:34.677

建议的代码有缺陷：

```
Imports VB = Microsoft.VisualBasic

Public Sub wait(ByVal seconds As Single)
    Static start As Single
    start = VB.Timer()
    Do While VB.Timer() < start + seconds
        System.Windows.Forms.Application.DoEvents()
    Loop
End Sub 
```

VB.Timer() 返回自午夜以来的秒数。如果在午夜之前调用它，则休息时间将接近一整天。我建议如下：

```
Private Sub Wait(ByVal Seconds As Double, Optional ByRef BreakCondition As Boolean = False)
    Dim l_WaitUntil As Date
    l_WaitUntil = Now.AddSeconds(Seconds)
    Do Until Now > l_WaitUntil
        If BreakCondition Then Exit Do
        DoEvents()
    Loop
End Sub 
```

当调用 DoEvents 时应该取消等待循环时，可以将 BreakCondition 设置为 true，这可以从循环外部完成。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-03T08:15:19.453

```
Static tStart As Single, tEnd As Single, myInterval As Integer
myInterval = 5 ' seconds
tStart = VB.Timer()
tEnd = myInterval + VB.Timer()
Do While tEnd > tStart
    Application.DoEvents()
    tStart = VB.Timer()
Loop 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-09-08T19:46:01.513

在继续下一步之前检查浏览器的就绪状态，我得到了更好的结果。在浏览器具有“完整”就绪状态之前，这将什么都不做

```
Do While WebBrowser1.ReadyState <> 4
''' put anything here. 
Loop 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-04-28T19:04:03.487

问题`Threading.Thread.SLeep(2000)`在于它首先在我的 VB.Net 程序中执行。这个

```
Imports VB = Microsoft.VisualBasic

Public Sub wait(ByVal seconds As Single)
    Static start As Single
    start = VB.Timer()
    Do While VB.Timer() < start + seconds
        System.Windows.Forms.Application.DoEvents()
    Loop
End Sub 
```

完美地工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-08-05T17:56:53.657

另一种方法是使用[System.Threading.ManualResetEvent](https://docs.microsoft.com/en-us/dotnet/api/system.threading.manualresetevent?view=netframework-4.8)

```
dim SecondsToWait as integer = 5
Dim Waiter As New ManualResetEvent(False)
Waiter.WaitOne(SecondsToWait * 1000) 'to get it into milliseconds 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2020-11-27T00:50:44.827

在 Web 应用程序中，计时器将是最好的方法。

仅供参考，在桌面应用程序中，我在异步方法中使用它。

```
... 
Await Task.Run(Sub()
    System.Threading.Thread.Sleep(5000)
End Sub)
... 
```

它对我有用，重要的是它不会冻结整个屏幕。但这又是在桌面上，我在 Web 应用程序中尝试它确实冻结了。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2014-06-24T15:52:14.617

VB.net 4.0 框架代码：

`Threading.Thread.Sleep(5000)`

整数以毫秒为单位（1 秒 = 1000 毫秒）

我确实测试过它并且它有效

# php - 从外部 smtp 服务器发送电子邮件

> ID：15857900
> 
> 赞同：0
> 
> 时间：2013-04-07T01:26:38.040
> 
> 标签：php, smtp

我正在尝试使用下面的 php 脚本从外部服务器发送邮件：

```
<?php
$recipient="dwqchen@gmail.com"; 
$subject="Website to customer";
$message="Customer Name: ".$_POST['name']."\r\n";
$message.="Customer Email: ".$_POST['email']."\r\n";
$message.="Customer Message: ".$_POST['msg']."\r\n"; 
$mailheader="From: <maria@comcast.net> \r\n";
$mailheader.="Reply to ".$_POST['email'];
mail($recipient, $subject, $message, $headers);
?>
<!DOCTYPE html>
<html>
<head>
<title>Sending mail from website to Customer</title>
</head>
<body>
<p>Thanks, <strong><?php echo $_POST['name']; ?></strong>, for your message.</p>
<p>Your email address: <strong><?php echo $_POST['email']; ?></strong></p>
<p>Your message: <br/><?php echo $_POST['msg']; ?></p>
</body>
<html> 
```

我收到以下错误消息：

警告：mail() [function.mail]：“sendmail_from”未在 php.ini 中设置或自定义“From:”标头在 C:\Program Files (x86)\Apache Software Foundation\Apache2.2\htdocs\sendmail 中丢失。第 9 行的 php

我的 php.ini 设置为：

```
[mail function]
; For Win32 only.
SMTP = smtp.comcast.net
smtp_port = 25

; For Win32 only.
;sendmail_from = maria@comcast.net 
```

谁能告诉我我该怎么办？谢谢。

# c++ - 如何仅测试字母的 u32string（使用语言环境）

> ID：15857901
> 
> 赞同：1
> 
> 时间：2013-04-07T01:26:44.047
> 
> 标签：c++, unicode, c++11, utf

我正在编写一个编译器（用于我自己的编程语言），我希望允许用户使用 Unicode 字母类别中的任何字符来定义标识符（现代语言，如[Go](http://golang.org/)已经允许这样的语法）。我已经阅读了很多关于 C++11 中字符编码的内容，并且根据我发现的所有信息，使用 utf32 编码会很好（在词法分析器中迭代速度很快，并且它比 utf8 有更好的支持在 C++ 中）。

在 C++ 中有`isalpha`函数。我如何测试`wchar32_t`它是否是字母（在任何语言中归类为“字母”的 Unicode 代码点）？

甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T14:41:40.423

使用[ICU](http://icu-project.org)遍历字符串并检查是否满足适当的 Unicode 属性。下面是一个用 C 语言检查 UTF-8 命令行参数是否是有效标识符的示例：

```
#include <stdint.h>
#include <stdlib.h>
#include <string.h>

#include <unicode/uchar.h>
#include <unicode/utf8.h>

int main(int argc, char **argv) {
  if (argc != 2) return EXIT_FAILURE;
  const char *const str = argv[1];
  int32_t off = 0;
  // U8_NEXT has a bug causing length < 0 to not work for characters in [U+0080, U+07FF]
  const size_t actual_len = strlen(str);
  if (actual_len > INT32_MAX) return EXIT_FAILURE;
  const int32_t len = actual_len;
  if (!len) return EXIT_FAILURE;
  UChar32 ch = -1;
  U8_NEXT(str, off, len, ch);
  if (ch < 0 || !u_isIDStart(ch)) return EXIT_FAILURE;
  while (off < len) {
    U8_NEXT(str, off, len, ch);
    if (ch < 0 || !u_isIDPart(ch)) return EXIT_FAILURE;
  }
} 
```

[请注意，这里的 ICU 使用 Java 定义，这与UAX #31](http://www.unicode.org/reports/tr31/)中的定义略有不同。在实际应用程序中，您可能还希望之前标准化为 NFC。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T14:12:54.613

[ICU](http://site.icu-project.org/)项目`isaplha`中有一个。我认为你可以使用它。

# magento - 为以编程方式导入的产品图像设置显示顺序

> ID：15857904
> 
> 赞同：1
> 
> 时间：2013-04-07T01:26:58.007
> 
> 标签：magento, magento-1.7

在我测试 magento 期间，我已经能够通过读取 XML 将产品导入商店。我的 XML 还包含与产品相关联的图像 URL 数组。我阅读了每个图像属性中的 URL，下载它并将其移动到 media/import 文件夹中。然后我将每个图像与产品相关联

```
foreach($mediaArray as $imageType => $fileName)
{
    try {
         $product->addImageToMediaGallery($fileName, $imageType, false, false);
    } catch (Exception $e) {
         echo $e->getMessage();
    }
} 
```

我想要解决的一件事是确定图像的排序顺序，哪一个是页面加载时显示的默认图像。有没有办法以编程方式说我希望这个文件成为第一个显示的图像？在页面加载时显示的 magento 并不是最好的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T14:37:57.223

下面的代码允许您导入图像并设置位置。它将根据数组中图像的顺序设置位置，因此如果这不是必需的，则您需要更改该位置，但希望这至少能让您了解如何完成。

```
$sku = $product->getSku();
$media = Mage::getModel('catalog/product_attribute_media_api');

$position = 1;
foreach($mediaArray as $fileName) {

    if (file_exists($fileName)) { // assuming $fileName is full path not just the file name
        $pathInfo = pathinfo($fileName);

        switch($pathInfo['extension']){
            case 'png':
                $mimeType = 'image/png';
                break;
            case 'jpg':
                $mimeType = 'image/jpeg';
                break;
            case 'gif':
                $mimeType = 'image/gif';
                break;
        }

        $types = ($position == 1) ? array('image', 'small_image', 'thumbnail') : array();
        $newImage = array(
            'file' => array(
                'content' => base64_encode($fileName),
                'mime' => $mimeType,
                'name' => basename($fileName),
                ),
            'label' => 'whatever', // change this. 
            'position' => $position,
            'types' => $types,
            'exclude' => 0,
        );

        $media->create($sku, $newImage);
        // OR (if you would rather use the product entity ID):
        // $media->create($productId, $newImage, null, 'id');
        $position++;
    } else {
        // image not found
    }
} 
```

# ruby-on-rails - 检查用户是否仍在同一页面上

> ID：15857909
> 
> 赞同：1
> 
> 时间：2013-04-07T01:27:53.897
> 
> 标签：ruby-on-rails, session

您如何检查用户是否仍在同一页面上？

如果任何用户阅读同一篇文章的时间超过五分钟，我想标记一篇文章。为此，我需要检查两次：当他第一次阅读帖子时，以及 5 分钟过去后。现在，我正在考虑做..

1.  在读者`session[post_id]`第一次阅读帖子时给他一个。
2.  用于`delayed_job`查看 5 分钟后用户是否仍有会话。如果他这样做，我标记`post`
3.  每当他回到帖子列表时，我都会检查他是否有任何帖子`session[post_id]`并将其删除。

这个逻辑有意义吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T01:36:55.390

我会使用 javascript 来触发请求：

```
<script>
  $(document).on('ready', function(){
    this.setTimeout(function(){
      $.post("/posts/update/#{@post.id}", {marked: true})
    }, 1000*60*60*5)
  })
</script> 
```

# asp.net-mvc-4 - 带有 ViewModel 和业务逻辑验证的 ASP.NET MVC FluentValidation

> ID：15857910
> 
> 赞同：2
> 
> 时间：2013-04-07T01:27:56.533
> 
> 标签：asp.net-mvc-4, business-logic, fluentvalidation, modelstate

我正在探索使用 FluentValidation，因为它似乎是一个优雅的 API，用于在模型绑定时验证我的 ViewModel。我正在寻找有关如何使用此库以及从我的业务（服务）层正确集中验证并将其提升到视图的意见，而无需使用 2 种不同的方法来添加模型状态错误。

我愿意使用完全不同的 API，但本质上是想解决这个分支验证策略。

[旁注：我尝试的一件事是将我的业务方法移动到我的 FluentValidation 的自定义 RsvpViewModelValidator 类中并使用 .Must 方法，但在那里隐藏该调用似乎是错误的，因为如果我需要实际使用我的 Customer 对象，我将拥有重新查询它，因为它超出了范围]

示例代码：

```
[HttpPost]
public ActionResult AcceptInvitation(RsvpViewModel model)
{
    //FluentValidation has happened on my RsvpViewModel already to check that 
    //RsvpCode is not null or whitespace
    if(ModelState.IsValid)
    {
        //now I want to see if that code matches a customer in my database.
        //returns null if not, Customer object if existing
        customer = _customerService.GetByRsvpCode(model.RsvpCode);
        if(customer == null)
        {
            //is there a better approach to this?  I don't like that I'm
            //splitting up the validation but struggling up to come up with a 
            //better way.
            ModelState.AddModelError("RsvpCode", 
                string.Format("No customer was found for rsvp code {0}", 
                              model.RsvpCode);

            return View(model);
        }

        return this.RedirectToAction(c => c.CustomerDetail());
    }

    //FluentValidation failed so should just display message about RsvpCode 
    //being required
    return View(model);
}

[HttpGet]
public ActionResult CustomerDetail()
{
     //do work.  implementation not important for this question.
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T03:07:31.953

为了结束这个问题（并使其可以接受）并总结评论：

业务/流程逻辑和验证逻辑是两个实体。除非验证与数据库相关联（例如检查唯一条目），否则没有理由将验证分组到一个位置。有些人负责模型中的信息，确保信息没有任何无效，有些人负责处理验证值在系统中的使用方式。考虑一下属性获取器/设置器与具有这些属性的方法中使用的逻辑。

话虽如此，分离流程（检查、错误处理等——任何与 UI 无关的）都可以在服务层中完成，这也倾向于保持应用程序[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)。然后动作只负责调用和呈现，而不是执行实际的工作单元。（另外，如果您的应用程序中的各种操作使用类似的逻辑，则检查都在一个位置，而不是在操作之间放在一起。（我记得检查客户表中是否有一个条目吗？））

此外，通过将其分解为层，您可以保持关注点的模块化和可测试性。（接受 RSVP 不依赖于 UI 中的操作，但现在它是服务中的一个方法，可以由该 UI 或移动应用程序调用）。

至于冒泡错误，我通常有一个跨越每一层的基本异常，然后我可以根据目的对其进行扩展。您可以很容易地使用枚举、布尔值、`out`参数或简单的布尔值（Rsvp 要么被接受，要么不被接受）。这仅取决于用户纠正问题所需的响应有多有限，或者可能更改工作流程以使错误不是问题或用户需要纠正的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T03:01:56.337

您可以在流畅的验证中拥有整个验证逻辑：

```
public class RsvpViewValidator : AbstractValidator<RsvpViewModel>
{
    private readonly ICustomerService _customerService = new CustomerService();
    public RsvpViewValidator()
    {
        RuleFor(x => x.RsvpCode)
            .NotEmpty()
            .Must(BeAssociatedWithCustomer)
            .WithMessage("No customer was found for rsvp code {0}", x => x.RsvpCode)
    }

    private bool BeAssociatedWithCustomer(string rsvpCode)
    {
        var customer = _customerService.GetByRsvpCode(rsvpCode);
        return (customer == null) ? false : true;
    }
} 
```

# php - 由于 SSL 错误，无法 HTML 抓取网站

> ID：15857912
> 
> 赞同：1
> 
> 时间：2013-04-07T01:28:00.877
> 
> 标签：php, curl, openssl, web-scraping

我正在研究一个抓取脚本。它适用于大多数网站，但我无法访问特定的 SSL 网站。

这是我的代码：

```
if (!extension_loaded('openssl')){
    // not occurring
}

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'https://www.chase.com/');
curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_ANY);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_HEADER, 1);

$result = curl_exec($ch);

if($result === false)
{
    $err = curl_error($ch);
    //$err = SSL read: error:00000000:lib(0):func(0):reason(0), errno 10054
} 
```

`$result`总是`FALSE`，并显示此错误消息：

```
SSL read: error:00000000:lib(0):func(0):reason(0), errno 10054 
```

但它适用于其他具有 SSL 的网站。我还检查了`phpinfo()`，cURL 和 OpenSSL 处于活动状态。我正在使用 WAMP，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T01:49:14.717

您需要设置一个用户代理。我测试了有和没有，它解决了这个问题。Chase 似乎希望在请求中提供 UA。

所以添加这个：

```
curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows; U; MSIE 9.0; WIndows NT 9.0; en-US)'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-04T15:04:20.833

我通过使用以下 PHP 库解决了问题。

[https://github.com/rmccue/Requests](https://github.com/rmccue/Requests)

[在基于 Linux 的服务器上使用此库代码，可能无法在 xampp 或 wamp 上运行]

# amazon-web-services - 能够从 Amazon S3 下载，而不仅仅是流文件

> ID：15857915
> 
> 赞同：2
> 
> 时间：2013-04-07T01:28:33.897
> 
> 标签：amazon-web-services, amazon-s3

我有存储我所有文件的 Amazon S3。目前，我的用户可以转到可以流式传输但不能下载音频和视频文件的链接。如何通过 Amazon S3 或 Amazon CloudFront 建立一个链接，允许某人下载 MP3 文件或类似的东西？

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T22:09:48.740

您必须将文件的内容标头设置为浏览器能够理解的媒体类型以外的内容。例如：

```
Content-Disposition: attachment; filename=FILENAME.EXT
Content-Type: application/octet-stream 
```

如果您想要同时拥有这两种功能（显示/查看能力和下载能力）并且过去必须通过 EC2 或其他烦人的方式代理文件下载，这曾经是一个大问题。现在 S3 内置了它：

[http://docs.aws.amazon.com/AmazonS3/latest/API/RESTObjectGET.html](http://docs.aws.amazon.com/AmazonS3/latest/API/RESTObjectGET.html)

> 您可以使用下表中列出的查询参数覆盖一组响应标头的值。这些响应标头值仅在请求成功时发送，即在返回状态码 200 OK 时发送。您可以使用这些参数覆盖的标头集是 Amazon S3 在您创建对象时接受的标头的子集。您可以为 GET 响应覆盖的响应标头是 Content-Type、Content-Language、Expires、Cache-Control、Content-Disposition 和 Content-Encoding。要覆盖 GET 响应中的这些标头值，请使用下表中描述的请求参数。（以上链接）

# libreoffice - 使用 pyUno 将文本写入 Libre/OpenOffice Writer

> ID：15857919
> 
> 赞同：0
> 
> 时间：2013-04-07T01:29:18.527
> 
> 标签：libreoffice, openoffice-writer, uno, pyuno

我正在尝试将一些文本从 Python 导出到我根据[这些](http://lucasmanual.com/mywiki/OpenOffice)说明创建的 Libre/OpenOffice Writer 文档中。

例如，使用

```
cursor.setPropertyValue("CharHeight", 20)
cursor.setPropertyValue("CharWeight", 150)
document.Text.insertString(cursor, "This Is Heading One", 0) 
```

我可以使一行文本看起来像一个标题，但它只是文本而不是实际的标题。我必须修改哪些属性值才能生成为 TOC 选取的标题行？

一般来说，属性的文档在哪里，一般如何浏览 Writer 文档？我很难挖掘任何东西！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T09:53:18.677

我想这对[stackoverflow](https://stackoverflow.com/questions/15857919/using-pyuno-to-write-text-into-libre-openoffice-writer)并没有引起太大的兴趣:) 在 LibreOffice 的论坛中也没有。

[幸运的是，OpenOffice 的人们提供了一些很好的建议，这里](http://forum.openoffice.org/en/forum/viewtopic.php?t=61222)有一个包含上述问题和更多问题的线程。我将在那里继续讨论文档创建的各个方面。

# c++ - BluetoothSelectDevices 是否包含 MS 错误？

> ID：15857920
> 
> 赞同：2
> 
> 时间：2013-04-07T01:29:33.450
> 
> 标签：c++, winapi, bluetooth, visual-c++-2008

因此，我将应用程序中不可预测的崩溃范围缩小到了**BluetoothSelectDevices**函数。它应该允许用户选择设备。

```
#include <windows.h>
#include <Bthsdpdef.h>
#include <BluetoothAPIs.h>
#pragma comment(lib, "bthprops")
#pragma comment(lib, "user32")

bool getDevice(void)
{
    BLUETOOTH_SELECT_DEVICE_PARAMS btsdp = { sizeof(btsdp) };

    btsdp.hwndParent = NULL; // hDlg; // "set to NULL for no parent."
    btsdp.fShowUnknown = TRUE;
//  btsdp.fAddNewDeviceWizard = TRUE;
    btsdp.fShowAuthenticated = TRUE;

    BOOL b = BluetoothSelectDevices( &btsdp );
    if ( b )
    {
//         BLUETOOTH_DEVICE_INFO * pbtdi = btsdp.pDevices;
//         for ( ULONG cDevice = 0; cDevice < btsdp.cNumDevices; cDevice ++ )
//         {
//             if ( pbtdi->fAuthenticated || pbtdi->fRemembered )
//             {
//                 //
//                 //  TODO:      Do something usefull with the device info
//                 //
//             }
//
//             pbtdi = (BLUETOOTH_DEVICE_INFO *) ((LPBYTE)pbtdi + pbtdi->dwSize);
//         }

        BluetoothSelectDevicesFree( &btsdp );
    }
    else
    {
        if (GetLastError() != ERROR_CANCELLED)
            MessageBox(NULL, "BluetoothSelectDevices failed.", "Error", MB_OK);
        return false;
    }

    return true;
}
int main(void){for (int i = 0; i < 10 && getDevice(); i++);return 0;} 
```

它最终会遇到访问冲突，尽管它可能会完美运行一段时间（这就是为什么我把它放在一个循环中以便于测试。）

经过一番挫折后，我转到“BluetoothAPIs.h”文件并按照微软的建议几乎逐字复制了上面的代码！我什至注释掉了不重要的部分。在VC9下编译行很简单：“cl /ZI /RTCcsu main.cpp”

也许有人可以建议我做错了什么？

调试器没有帮助。它只是在 0x6CD1DCD9 处显示内核中的故障。像我在下面所做的那样明确设置所有参数没有区别。

```
memset(&btsdp, 0, sizeof(btsdp));
btsdp.dwSize = sizeof(BLUETOOTH_SELECT_DEVICE_PARAMS);
btsdp.cNumOfClasses = 0; // search for all devices
btsdp.prgClassOfDevices = NULL;
btsdp.pszInfo = L"Select Device..";
btsdp.hwndParent = NULL;
btsdp.fForceAuthentication = FALSE;
btsdp.fShowAuthenticated = TRUE;
btsdp.fShowRemembered = TRUE;
btsdp.fShowUnknown = TRUE;
btsdp.fAddNewDeviceWizard = FALSE;
btsdp.fSkipServicesPage = FALSE;
btsdp.pfnDeviceCallback = NULL; // no callback
btsdp.pvParam = NULL;
btsdp.cNumDevices = 0; // no limit
btsdp.pDevices = NULL; 
```

提前致谢。

# html - 为什么我的导航栏没有突出显示？

> ID：15857921
> 
> 赞同：0
> 
> 时间：2013-04-07T01:29:35.613
> 
> 标签：html, css, menu, blocking, menubar

为什么第一个菜单不突出显示，或者最后两个菜单突出显示。我相当肯定它与图像有关，但如果确实如此，我不知道如何修复它。

我的 HTML：

```
 <link type="text/css" rel="stylesheet" href="Practise.css"/>
    <title>Practise</title>     
    </head>
    <img src="404SQN logo.png" width="1250" class="logo"/>
<nav>
    <ul>
        <li><a href="#">Home</a></li>
        <li class="drop">
            <a href="#">About Us</a>
            <div class="dropdownContain">
                <div class="dropOut">
                    <div class="triangle"></div>
                    <ul>
                        <li>About 404SQN</li>
                        <li>About AAFC</li>
                        <li>What to Expect</li>
                        <li>Discipline</li>
                    </ul>
                </div>
            </div>
        </li>
        <li><a href="#">News</a></li>
        <li><a href="#">Gallery</a></li>
        <li><a href="#">Tutorials</a></li>
        <li><a href="#">Requests</a></li>
        <li><a href="#">Downloads</a></li>
        <li><a href="#">Contacts Us</a></li>
    </ul> 
```

还有我的 CSS：

```
 html, body, div, span, applet, object, iframe,h1, h2, h3, h4, h5, h6, p, blockquote, pre,a, abbr, acronym, address, big, cite, code,del, dfn, em, font, img, ins, kbd, q, s, samp,small, strike, strong, sub, sup, tt, var,b, u, i, center,dl, dt, dd, ol, ul, li,fieldset, form, label, legend,table, caption, tbody, tfoot, thead, tr, th, td {margin: 0;padding: 0;border: 0;outline: 0;font-size: 100%;vertical-align: baseline;background: transparent;}body {line-height: 1;}ol, ul {list-style: none;}blockquote, q {quotes: none;}blockquote:before, blockquote:after,q:before, q:after {content: '';content: none;} /* remember to define focus styles! */ :focus {outline: 0;} /* remember to highlight inserts somehow! */ins {text-decoration: none;}del {text-decoration: line-through;} /* tables still need 'cellspacing="0"' in the markup */ table {border-collapse: collapse;border-spacing: 0;}

    .logo {
    float: left;
    position: absolute;
    left: -27.5em;
    top: -22em;
    z-index: -1;
}
    /*---------- BODY --------------------------------*/

    body {
    text-align: center;
    background: #e0e0e0;
    padding-bottom: 200px;
    z-index: 1;
}

       a {
    text-decoration: none;
}

/*---------- Wrapper --------------------*/

nav {
    width: 95%;
    height: 4em;
    background: #003C82;
    border-radius: 10px;
    margin: auto;
    position: relative;
    top: 6em;
}

ul {
    text-align: center;
    margin: auto;
}

ul li {
margin-top: -0.5em;
    font-family:‘Trebuchet MS’, Helvetica, sans-serif;
    cursor: pointer;
    -webkit-transition: padding .05s linear;
    -moz-transition: padding .05s linear;
    -ms-transition: padding .05s linear;
    -o-transition: padding .05s linear;
    transition: padding .05s linear;
}
ul li.drop {
    position: relative;
}
ul > li {
    display: inline-block;
}
ul li a {
    line-height: 80px;
    padding: 0 20px;
    height: 80px;
    color: #777;
    -webkit-transition: all .1s ease-out;
    -moz-transition: all .1s ease-out;
    -ms-transition: all .1s ease-out;
    -o-transition: all .1s ease-out;
    transition: all .1s ease-out;
}
ul li a:hover {
    color: #eee;
}

.dropOut .triangle {
    width: 0;
    height: 0;
    position: absolute;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-bottom: 8px solid white;
    top: -8px;
    left: 50%;
    margin-left: -8px;
}
.dropdownContain {
    width: 160px;
    position: absolute;
    z-index: 2;
    left: 50%;
    margin-left: -80px; /* half of width */
    top: -400px;
}
.dropOut {
    width: 160px;
    background: white;
    float: left;
    position: relative;
    margin-top: 0px;
    opacity: 0;
    -webkit-border-radius: 4px;
    -moz-border-radius: 4px;
    border-radius: 4px;
    -webkit-box-shadow: 0 1px 6px rgba(0,0,0,.15);
    -moz-box-shadow: 0 1px 6px rgba(0,0,0,.15);
    box-shadow: 0 1px 6px rgba(0,0,0,.15);
    -webkit-transition: all .1s ease-out;
    -moz-transition: all .1s ease-out;
    -ms-transition: all .1s ease-out;
    -o-transition: all .1s ease-out;
    transition: all .1s ease-out;
}

.dropOut ul {
    float: left;
    padding: 10px 0;
}
.dropOut ul li {
    text-align: left;
    float: left;
    width: 125px;
    padding: 12px 0 10px 15px;
    margin: 0px 10px;
    color: #777;
    -webkit-border-radius: 4px;
    -moz-border-radius: 4px;
    border-radius: 4px;
    -webkit-transition: background .1s ease-out;
    -moz-transition: background .1s ease-out;
    -ms-transition: background .1s ease-out;
    -o-transition: background .1s ease-out;
    transition: background .1s ease-out;
}

.dropOut ul li:hover {
    background: #f6f6f6;
}

ul li:hover a { color: white; }
ul li:hover .dropdownContain { top: 65px; }
ul li:hover .underline { border-bottom-color: #777; }
ul li:hover .dropOut { opacity: 1; margin-top: 8px; }

/*Search Bar Starts Here*/
#tw-form-outer {
float: right;
position: absolute;
right: 1.8em;
top: 1em;

}
#tw-form{
margin-top: 1em;
font-family: ‘Trebuchet MS’, Helvetica, sans-serif;
-moz-border-radius: 4px;
-webkit-border-radius: 4px;
border: #aaa 1px solid;
background: #DDDDDD;
background: -moz-linear-gradient(top, #C4C4C4 0%, #EAEAEA 0%, #D3D3D3 100%); /* firefox */
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#C4C4C4), color-stop(0%,#EAEAEA), color-stop(100%,#D3D3D3)); /* webkit */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#C4C4C4', endColorstr='#D3D3D3',GradientType=0 ); /* ie */
width: 83%;
float: left;
padding: 0 4px;
border-top-left-radius: 4px 4px;
border-top-right-radius: 4px 4px;
border-bottom-right-radius: 4px 4px;
border-bottom-left-radius: 4px 4px;
}
#tw-form #tw-input-text{
width: 80%;
float: left;
border: 0;
background: #DDDDDD;
background: -moz-linear-gradient(top, #C4C4C4 0%, #EAEAEA 0%, #D3D3D3 100%); /* firefox */
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#C4C4C4), color-stop(0%,#EAEAEA), color-stop(100%,#D3D3D3)); /* webkit */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#C4C4C4', endColorstr='#D3D3D3',GradientType=0 ); /* ie */
color: #777;
line-height: 100%;
font-size: 0.8em;
font-family: font-family: ‘Trebuchet MS’, Helvetica, sans-serif;
margin-top:3px;margin-bottom:3px;
height:20px;
}
#tw-form #tw-input-text:focus{
outline:none;
color:#333;
}
#tw-form #tw-input-submit{
background: url(search-zoom-icon.png) no-repeat 10px 5px;
border: 0;
float: left;
width: 22px;
z-index: 100;
cursor: pointer;
}
/*Search Bar Ends Here*/
#socialicons {

    position: relative;
    float: right;
    right: 13.5em;

}
.logo {
    float: left;
    position: absolute;
    left: -27.5em;
    top: -22em;
    z-index: 9000;
} 
```

所以“关于我们”菜单应该下拉，当我在一个文件中单独尝试它时，它可以完美运行，但是一旦我添加了图像，它就会停止工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:33:05.433

您的图像在您的内容之上 将徽标更改`z-index`为 0 以将其发送到后面

```
.logo {
    float: left;
    position: absolute;
    left: -27.5em;
    top: -22em;
    z-index: 0;
} 
```

这是后面发送的图像的[小提琴](http://jsfiddle.net/dLSLD/)

# php - 当数据库上的日期格式为“2013 年 4 月 5 日”时，比较 PHP 上的两个日期

> ID：15857933
> 
> 赞同：0
> 
> 时间：2013-04-07T01:31:33.623
> 
> 标签：php, database, date

大家好，我坚持这一点：我想删除过去数据库中的记录。我只想考虑月份和日期。例如，如果数据库记录是（这是在 DB 上的格式）“2013 年 4 月 5 日”，我需要将其与今天的“2013 年 4 月 6 日”日期进行比较。在这种情况下，此记录将被删除。我见过使用 UNIX 时间戳的示例，但没有使用日期（'M j Y'）的格式。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T01:37:50.533

在数据库中存储日期的更好方法是使用 DATE 或 DATETIME 格式。SQL 允许您从这些类型中获取所需的所有信息。但是这样的请求应该可以工作。

你最终可以用正则表达式来做，但它会很重......

但是您可以在 PHP 中执行此操作，获取所有结果，然后浏览它们并使用类似的东西比较日期`strtotime`，然后删除每个 ID。仍然非常繁重，但比在 SQL 请求中更容易实现。但是，如果您可以更改 SQL 架构，那仍然会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T02:58:12.330

我会尝试的方法是使用[strtotime()](http://de.php.net/manual/en/function.strtotime.php)将英文文本字符串转换为 unix 时间戳，然后将新时间戳与当前日期进行比较。这是一些描述该方法的php伪代码。

```
$threshold_to_deletion = numbers of days old a record is allowed to be;
$is_it_yesterday = 0;
$current_date = new DateTime();
$current_date->getTimestamp();

if ( !($is_it_yesterday = strtotime($str_from_db)) === false ) {
    $date_interval = date_diff($is_it_yesterday, $current_date);
    if( $date_interval >= $threshold_to_deletion ) {
        Do stuff here to delete
    }
} else {
    echo "DB string is not a valid date: $str_from_db";
} 
```

请注意它没有完成或测试，它只是在那里松散地描述它是如何完成的。我希望这有帮助。

蒂姆·杜马斯

[www.mpact-media.com](http://www.mpact-media.com)

# c - 2 位饱和计数器的模式历史表

> ID：15857934
> 
> 赞同：1
> 
> 时间：2013-04-07T01:31:35.590
> 
> 标签：c, branch, counter, prediction

我目前正在处理的问题是编写一个 gshare 模拟器，该模拟器接受分支指令地址和 2 位饱和计数器的已采用/未采用指令。意思是，我的输入看起来像这样：

0ffd7a78 1

我编写的 2 位饱和计数器程序正确计算了错误预测的数量以及错误预测率。我了解 2 位饱和计数器背后的逻辑。但是，我很难理解 gshare 模拟器的概念，在我的例子中，它使用 BHSR（分支历史移位寄存器），它由一个可变位索引与来自最低有效位的位数进行异或运算的指令地址。据我了解，BHSR 包含最后 n 次出现，用于索引模式历史表。模式历史表中的每个条目都包含其自己的 2 位饱和计数器，用于给出预测。我已经为此工作/考虑了几个小时，也许我只是想多了。如何实现我的 2 位饱和计数器来制作一个包含多个 2 位饱和计数器的表来填充模式历史表？这是我第一次在这里提问，所以我希望我遵循正确的格式。我的 2 位饱和计数器程序代码在这里：

```
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <string.h>

#define RECORDS 4000000

int main(int argc, char *argv[]){

int bitIndex = atoi(argv[1]);       //The argument entered by the user, defines bit index
int numEntries;         //Number of entries as determined by bit index
numEntries = pow(2, bitIndex);
int bht[numEntries];            //Integer array that holds the Branch History Table
int count;              //Used to clear out the Branch History Table

//Loop through the entire Branch History Table and make sure all cells are set to 0.
for(count = 0; count < numEntries; count++){
    bht[count] = 0;
}

int i;                  //Set up our counter
int mispredict = 0;         //Tells the number of mispredicts
int predict = 0;            //Tells the number of correct predictions

//Branch Prediction Record
char hexAddress[8];         //Address in branch prediction record stored as a string
int direction;              //The 0 or 1 will tell us whether to go up or down in a state change

for(i = 0; i < RECORDS; i++){
    scanf("%s %d", hexAddress, &direction);
    //printf("The address is %s\nThe direction is %d\n", hexAddress, direction);

    //BEGIN NUMBER CONVERSION

    //LOOKING FOR LEAST SIGNIFICANT BITS (bitIndex)
    //CONVERT HEX ADDRESS TO BINARY

    char originalHexAddress[8];
    strcpy(originalHexAddress, hexAddress); //Preserve the original address
    int j;                  //Counter for this internal loop
    char binaryString[32] = {""};       //Sets up a "string" for the binary conversion

    //Loop through the hex address and turn each component into its binary counterpart
    for(j = 0; j < 8; j++){
            if(hexAddress[j] == '0'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "0000");
                }
                else{
                    strcat(binaryString, "0000");
                }
        }                   
                if(hexAddress[j] == '1'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "0001");
                }
                else{
                    strcat(binaryString, "0001");
                }
        }
        if(hexAddress[j] == '2'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "0010");
                }
                else{
                    strcat(binaryString, "0010");
                }
        }
                if(hexAddress[j] == '3'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "0011");
                }
                else{
                    strcat(binaryString, "0011");
                }
        }
                if(hexAddress[j] == '4'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "0100");
                }
                else{
                    strcat(binaryString, "0100");
                }
        }
                if(hexAddress[j] == '5'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "0101");
                }
                else{
                    strcat(binaryString, "0101");
                }
        }
                if(hexAddress[j] == '6'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "0110");
                }
                else{
                    strcat(binaryString, "0110");
                }
        }
                if(hexAddress[j] == '7'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "0111");
                }
                else{
                    strcat(binaryString, "0111");
                }
        }
                if(hexAddress[j] == '8'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "1000");
                }
                else{
                    strcat(binaryString, "1000");
                }
        }
                if(hexAddress[j] == '9'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "1001");
                }
                else{
                    strcat(binaryString, "1001");
                }
        }
                if(hexAddress[j] == 'A'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "1010");
                }
                else{
                    strcat(binaryString, "1010");
                }
        }
                if(hexAddress[j] == 'B'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "1011");
                }
                else{
                    strcat(binaryString, "1011");
                }
        }
                if(hexAddress[j] == 'C'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "1100");
                }
                else{
                    strcat(binaryString, "1100");
                }
        }
                if(hexAddress[j] == 'D'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "1101");
                }
                else{
                    strcat(binaryString, "1101");
                }
        }
                if(hexAddress[j] == 'E'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "1110");
                }
                else{
                    strcat(binaryString, "1110");
                }
        }
                if(hexAddress[j] == 'F'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "1111");
                }
                else{
                    strcat(binaryString, "1111");
                }
        }
                if(hexAddress[j] == 'a'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "1010");
                }
                else{
                    strcat(binaryString, "1010");
                }
        }
                if(hexAddress[j] == 'b'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "1011");
                }
                else{
                    strcat(binaryString, "1011");
                }
        }
                if(hexAddress[j] == 'c'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "1100");
                }
                else{
                    strcat(binaryString, "1100");
                }
        }
                if(hexAddress[j] == 'd'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "1101");
                }
                else{
                    strcat(binaryString, "1101");
                }
        }
                if(hexAddress[j] == 'e'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "1110");
                }
                else{
                    strcat(binaryString, "1110");
                }
        }
                if(hexAddress[j] == 'f'){
                if(binaryString[0] == '\0'){
                    strcpy(binaryString, "1111");
                }
                else{
                    strcat(binaryString, "1111");
                }
        }
        }
    //printf("The binary string representation of %s is:\n%s\n", originalHexAddress, binaryString);

    //Now we must convert the appropriate binary component into it's decimal representation
    //CONVERT FROM BINARY TO DECIMAL

    //First, must get to the end based on our bit index
    int decimal = 0;
    int stringpos;

    //Loop starts at the appropriate value in the binary string and converts it to a decimal using bit shifting
    for(stringpos = (32 - bitIndex); stringpos < strlen(binaryString); stringpos++){
            decimal = decimal << 1;  
            if(binaryString[stringpos] == '1'){
            decimal += 1;
        }

    }
    //printf("The decimal value based off your bit index is %d\n", decimal);

    //END NUMBER CONVERSION

    //BEGIN WORK IN BHT

    /*
    LOGIC NOTE
    If the state is 0 or 1, predict NOT TAKEN
    If the state is 2 or 3, predict TAKEN
    If prediction is correct, then note it.
    If prediction is not correct, mark it as MISPREDICT.
    */

    //2-BIT SATURATING COUNTER

    //Based off our bit index, we will go to a specific cell in the table for each address
    //bht[decimal] represents which state we are currently in - 0, 1, 2, or 3
    //while(direction){
        switch (direction){
            //Lower state until saturate at 0
            case 0:
                //If state is 0 or 1, CORRECT PREDICTION, state will become 0
                if((bht[decimal] == 0) || (bht[decimal] == 1)){
                    bht[decimal] = 0;   //Keep or move to state 0
                    predict++;      //CORRECT PREDICTION
                    //printf("Stayed in state 0.\n");
                }
                //If state is 2, MISPREDICT, lower to state 1
                else if((bht[decimal] == 2)){
                    bht[decimal] = 1;   //Move to state 1
                    mispredict++;       //MISPREDICT
                    //printf("Lowered to state %d\n", state);
                }
                //If state is 3, MISPREDICT, lower to state 2
                else if((bht[decimal] == 3)){
                    bht[decimal] = 2;   //Move to state 2
                    mispredict++;       //MISPREDICT
                }
                break;

            //Increase state until saturate at 3
            case 1:
                //If state is 0, MISPREDICT, increase to state 1
                if((bht[decimal] == 0)){
                    bht[decimal] = 1;   //Move to state 1
                    mispredict++;       //MISPREDICT
                    //printf("Stayed in state 3.\n");
                }
                //If state is 1, MISPREDICT, increase to state 2
                else if((bht[decimal] == 1)){
                    bht[decimal] = 2;   //Move to state 2
                    mispredict++;       //MISPREDICT
                    //printf("Increased to state %d\n", state);
                }
                //If state is 2 or 3, CORRECT PREDICTION, state will become 3
                else if((bht[decimal] == 2) || (bht[decimal] == 3)){
                    bht[decimal] = 3;   //Keep or move to state 3
                    predict++;      //CORRECT PREDICTION
                }
                break;
        }

    //}
    //printf("Number of entries: %d\nPredicts: %d\nMispredicts: %d\n", numEntries, predict, mispredict);    
    //printf("The state is %d\n", bht[decimal]);
}
//Calculate rate
double rate;
rate = (((double)mispredict / 4000000) * 100);
printf("%d entries (%d-bit index): mispredicts = %d, rate = %.2lf%%\n", numEntries, bitIndex, mispredict, rate);

return 0;
} 
```

注意：我知道我可以简化到二进制的转换并节省大量空间，但在我编写该代码时，我只是在寻找一种让它工作的方法，确实如此。我觉得没有必要回去尝试修改它，所以请原谅长度。

# haskell - 使用事件源时检测客户端断开连接

> ID：15857944
> 
> 赞同：3
> 
> 时间：2013-04-07T01:32:54.340
> 
> 标签：haskell, yesod, server-sent-events

我正在尝试为 Yesod 中的一个网站构建一个聊天功能，我希望它有一个所有已连接用户的列表。我想最好的方法是将该人添加到连接上的用户列表中，并在他们离开时将其删除。如果保持连接打开，似乎响应应该阻塞，所以我天真地写了

```
getReceiveR :: Handler ()
getReceiveR = do
  App chan <- getYesod
  req <- waiRequest
  res <- lift $ eventSourceAppChan chan req
  sendWaiResponse res
  liftIO $ putStrLn "client disconnected" <-- Note this 
```

但它当然不起作用，因为 sendWaiResponse 短路了。

有什么方法可以检测客户端何时断开连接？

编辑：我正在使用[本教程](https://github.com/yesodweb/yesod/wiki/Basic-ServerEvent-example)的一个非常修改的版本来测试这个概念。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T04:14:46.437

我无法确定是否真正运行代码，但这可行吗？

```
import Control.Monad.Trans.Resource

getReceiveR :: Handler ()
getReceiveR = do
  App chan <- getYesod
  req <- waiRequest
  res <- lift $ eventSourceAppChan chan req
  register . liftIO $ putStrLn "client disconnected"
  sendWaiResponse res 
```

# java - 如何将 int 值从一个类传递到另一个类？

> ID：15857947
> 
> 赞同：0
> 
> 时间：2013-04-07T01:33:11.503
> 
> 标签：java, android

我不敢相信我有这么多麻烦。我的游戏活动中有这个变量：

```
public static int numberOfPointsA; 
```

在另一个活动中

```
public static int numberOfPointsB; 
```

现在我需要将这些值传递给另一个活动，我应该汇总这些值并将结果设置为 textView。由于这些是我尝试的公共静态变量：

```
public static int totalScore = ClassA.numberOfPointsA + ClassB.numberOfPointsB;

textView.setText("" + totalScore); 
```

但这行不通。所以我故意尝试：

在游戏类A中：

```
Intent intent = new Intent(this, Menu.class);
                intent.putExtra("foobar", numberOfPointsA);
                startActivity(intent); 
```

在菜单类中：

```
Intent intent = getIntent();
    int numberOfPointsA = intent.getIntExtra("foobar", 0); 
```

但这也行不通。如果我放在活动范围内，活动一开始它就会崩溃。如果我将它放在 onCreate 方法中，我就可以再使用我的 int 变量了，我在 onCreate 方法中不需要它，我在其他地方需要它。

那么如何在游戏类中设置我的变量，传递给菜单类，将其保存在那里，然后让它等到我完成我的游戏类 B 并对那个变量做同样的事情，然后合计这两个变量并将其成功设置为文本视图？

菜单活动：

公共类 Izbor 扩展 Activity 实现 OnClickListener{

```
private int asocijacijeUkupno = 0;
private int thUkupno = 0;

int ukupanBrojPoena = asocijacijeUkupno + thUkupno;

Button toploHladno, asocijacije, cigle, spojnice, nazad, poeniTH, poeniAso, poeniCigle, poeniSpojnice, poeniUkupno;
TextView naslov;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    asocijacijeUkupno = getIntent().getIntExtra("RUNNING_TOTAL", 0);
    thUkupno = getIntent().getIntExtra("RUNNING_TOTAL2", 0);

    setContentView(R.layout.izbor);

    addListenerOnButton();

}

private void addListenerOnButton() {

    naslov = (TextView) findViewById(R.id.tvIzborNaslov);
    toploHladno = (Button) findViewById(R.id.bIzbor1);
    asocijacije = (Button) findViewById(R.id.bIzbor2);
    cigle = (Button) findViewById(R.id.bIzbor3);
    spojnice = (Button) findViewById(R.id.bIzbor4);
    nazad = (Button) findViewById(R.id.bIzborNazad);
    poeniTH = (Button) findViewById(R.id.bPoeniTH);
    poeniAso = (Button) findViewById(R.id.bPoeniAso);
    poeniCigle = (Button) findViewById(R.id.bPoeniCigle);
    poeniSpojnice = (Button) findViewById(R.id.bPoeniSpojnice);
    poeniUkupno = (Button) findViewById(R.id.bPoeniUkupno);

    toploHladno.setOnClickListener(this);
    asocijacije.setOnClickListener(this);
    cigle.setOnClickListener(this);
    spojnice.setOnClickListener(this);
    nazad.setOnClickListener(this);

}

@Override
protected void onStart() {
    super.onStart();

    if(asocijacijeUkupno != 0){
    poeniAso.setText("" + asocijacijeUkupno);
    }else{
        poeniAso.setText("");
    }
    if(thUkupno != 0){
    poeniTH.setText("" + thUkupno);
    }else{
        poeniTH.setText("");
    }
    if(ukupanBrojPoena != 0){
    poeniUkupno.setText("" + ukupanBrojPoena);
    }else{
        poeniUkupno.setText("");
    }
}

public void onClick(View v) {
    switch(v.getId()){
    case R.id.bIzbor1:
        if(music == true){
            buttonClicks.start();
                }
        startActivity(new Intent("rs.androidaplikacije.toplo_hladno.TOPLOHLADNO"));
        break;
    case R.id.bIzbor2:
        if(music == true){
            buttonClicks.start();
                }
        startActivity(new Intent("rs.androidaplikacije.toplo_hladno.ASOCIJACIJE"));
        break;
    case R.id.bIzbor3:
        if(music == true){
            buttonClicks.start();
                }

        break;
    case R.id.bIzbor4:
        if(music == true){
            buttonClicks.start();
                }

        break;
    case R.id.bIzborNazad:
        if(music == true){
            buttonBack.start();
                }
        finish();
        break;
    }

} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-10T17:39:30.580

我没有完全明白你一直想说的话，但我得到的是你想在 FirstActivity 中创建一个变量，将其值发送给 SecondActivity，然后将它们的总和传递给 ResultActivity，如果是这样，那么你就去吧

```
//First Activity
public class FirstActivity extends Activity{
    int firstValue;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        firstValue = 10;
    }
    public sendValueToSecondActivity(View view){
        Intent intent = new Intent(this, SecondActivity.class);
        intent.putExtra("firstValue", firstValue);
        startActivity(intent);
    }
}

//Second Activity
public class SecondActivity extends Activity{
    int sumOfFirstAndSecond;
    int secondValue;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        secondValue = 20;

    }
    public sendValueToSecondActivity(View view){
        sumOfFirstAndSecond = getIntent().getIntExtra("firstValue") + secondValue;
        Intent intent = new Intent(this, ResultActivity.class);
        intent.putExtra("sumOfFirstAndSecond", sumOfFirstAndSecond);
        startActivity(intent);
    }
}

//Result Activity
public class ResultActivity extends Activity{
    TextView textView;
    int result;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        secondValue = 20;
        textView = (TextView) findViewById(R.id.textView);
    }
    public setResultToTextView(View view){
        result = getIntent().getIntExtra("sumOfFirstAndSecond");
        textView.setText(""+result);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T02:12:17.530

以下是一个非常基本的示例，使用两个活动来传递`int`。

第一个活动，您从以下内容开始：

```
public class FirstActivity extends Activity {
    private int mTotal = 0;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
        //.... onCreate code, layout stuff etc....    
    }

    // this is tied to a View onClick call
    public void moveToSecondAct(View view) {
        Intent intent = new Intent();
        intent.putExtra("RUNNING_TOTAL",mTotal);
        intent.setClass(this, SecondActivity.class);
        //... any other options like ...
        intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        // start the second Activity
        startActivity(intent);
    }
} 
```

第二个 Activity 示例类似于：

```
public class SecondActivity extends Activity {
    private int mTotal = 0;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
        mTotal = getIntent().getIntExtra("RUNNING_TOTAL", 0);
        //.... onCreate code, layout stuff etc....

        Log.i("Running total is:"+ mTotal);
        // update the total on the TextView
        TextView tv = (TextView) findViewById(R.id.poeniUkupno);
        tv.setText("Total: "+ mTotal);
    }
} 
```

编辑：尝试进行一些更改以帮助使事情更清晰

# c++ - C++ 固定大小的链表

> ID：15857949
> 
> 赞同：2
> 
> 时间：2013-04-07T01:33:35.830
> 
> 标签：c++, list

**非重复：**

*   [哪个 STL C++ 容器用于固定大小的列表？](https://stackoverflow.com/questions/5559730/which-stl-c-container-to-use-for-a-fixed-size-list)（具体用例）
*   [std::list 固定大小](https://stackoverflow.com/questions/3907607/stdlist-fixed-size)（见下文）

**动机：**

分配发生一次（在构造函数中），释放发生一次（在析构函数中）。

O(1) 在列表中的任何位置插入和删除元素，*而无需处理内存管理的开销*。这对于基于数组的实现是不可能的。

是否有使用标准库实现此功能的简单方法？在 Boost 中有这样的实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:43:07.107

我认为最简单的方法是拥有 2 个数据结构。固定大小并用于“分配”的数组/向量。您只需从数组中获取一个元素以创建一个节点并将其插入到您的列表中。像这样的东西似乎满足你的要求：

```
struct node {
    node *prev;
    node *next;
    int value;
};

node storage[N];
node *storage_ptr = storage; 
```

然后创建一个新节点：

```
if(node == &[storage + N]) {
    /* out of space */
}

node *new_node = *storage_ptr++;
// insert new_node into linked list 
```

这是固定大小，一次分配，当`storage`超出范围时，节点将被销毁。

至于有效地从列表中删除项目，它是可行的，但稍微复杂一些。我将有一个用于“已删除”节点的二级链表。从主列表中删除 a`node`时，将其插入“已删除”列表的末尾/开头。

分配时，先检查已删除的列表，然后再进入`storage`数组。如果是`NULL`use `storage`，否则，将其从列表中删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T09:09:41.010

当我读到那篇文章时，我首先想到的是使用不同分配器的方法，即预先分配给定数量的元素以避免分配代价的方法。虽然我不熟悉定义分配器，但如果你发现我会对结果感兴趣。

没有它，这是一种不同的方法。我自己保存了`template ...`这些东西，但我想如果你需要的话，你可以自己做。

```
typedef std::list<...> list_t;

struct fslist: private list_t
{
    // reuse some parts from the baseclass
    using list_t::iterator;
    using list_t::const_iterator;
    using list_t::begin;
    using list_t::end;
    using list_t::empty;
    using list_t::size;

    void reserve(size_t n)
    {
        size_t s = size();
        // TODO: Do what std::vector does when reserving less than the size.
        if(n < s)
            return;
        m_free_list.resize(n - s);
    }

    void push_back(element_type const& e)
    {
        reserve_one();
        m_free_list.front() = e;
        splice(end(), m_free_list, m_free_list.begin());
    }

    void erase(iterator it)
    {
        m_free_list.splice(m_free_list.begin(), *this, it);
    }

private:
    // make sure we have space for another element
    void reserve_one()
    {
        if(m_free_list.empty())
            throw std::bad_alloc();
    }
    list_t m_free_list;
}; 
```

这是不完整的，但它应该让你开始。另请注意， splice() 未公开，因为将元素移入或移入不同的列表会改变大小和容量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-22T12:05:40.717

我最终为此编写了一个名为rigid_list 的模板。它远未完成，但它是一个开始：

[https://github.com/eltomito/rigid_list](https://github.com/eltomito/rigid_list)

（受 Ulrich Eckhardt 回答的启发）

# html - 如何在 CSS/HTML 中创建一个简单的社交分享下拉菜单

> ID：15857952
> 
> 赞同：0
> 
> 时间：2013-04-07T01:34:42.113
> 
> 标签：html, css

如何创建一个简单的 HTML/CSS 社交共享菜单，类似于[http://bitquill.com/](http://bitquill.com/)上每篇文章底部的菜单- （我知道这是我的网站，但我没有编写共享菜单的代码。我正在使用 Squarespace 模板并且喜欢他们的共享菜单并希望在其他地方重新创建它。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T01:39:07.843

您必须使用每个站点的 API 来获取按钮/徽章。例如，您必须查看 Facebook 赞按钮的文档：[https](https://developers.facebook.com/docs/reference/plugins/like/) ://developers.facebook.com/docs/reference/plugins/like/并以这种方式获取代码。

创建菜单：

使用 a 创建一个共享按钮`div`，然后在其后放置另一个`div`，即菜单。风格随你喜欢。然后，制作菜单`display: none`- 这将隐藏它。使用 JS 将按钮的点击事件绑定到显示菜单的函数：

**HTML**

```
<div class="share">Share</div>
<div class="menu">
    <ul>
        <li>Facebook</li>
        <li>Twitter</li>
        <li>Stack</li>
    </ul>
</div> 
```

**CSS**

```
.menu {
    display: none;
} 
```

**JS**

```
$('body').on('click', function (e) {
    if (e.target.className !== 'share')
        $('.menu').css('display', 'none');
    else 
        $('.menu').css('display', 'block');
}); 
```

* * *

因此，您的整个 HTML 文件应如下所示：

```
<html>
<head>
    <style>
    .menu {
        display: none;
    }
    </style>
</head>
<body>
    <div class="share">Share</div>
    <div class="menu">
        <ul>
            <li>Facebook</li>
            <li>Twitter</li>
            <li>Stack</li>
        </ul>
    </div>
    <!-- This is the jQuery -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>
    $('body').on('click', function (e) {
        if (e.target.className !== 'share')
            $('.menu').css('display', 'none');
        else 
            $('.menu').css('display', 'block');
    });
    </script>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T01:53:32.883

这是一个简单的例子。您设置了一个容器 div（必须具有位置：相对）和菜单 div（具有定位：绝对）。页面加载时使用 jQuery 隐藏菜单 div。当用户单击 Share 时，将显示 div。

您从 Facebook 获得的 API 代码将放置在包含 Facebook 占位符文本的 div 中。

要详细了解示例中的菜单是如何实现的，请使用 Chrome 打开页面。右键单击“共享”并转到“检查元素”。

```
<script type="text/javascript">
    $(document).ready(function () {
        //Initally hide social-menu div
        $("#social-menu").hide();

        //When social-button is pressed, show social-menu
        $("#social-button").click(function () {
            $("#social-menu").show();
        });
    }); 
```

```
<div id="social-button" >Share</div>          
    <div id="social-container" style="position:relative;">
    <div id="social-menu" style="position:absolute;top:0px;bottom:0px;z-index:10" >
        <div>Facbook</div>
        <div>Google +</div>
    </div>
</div> 
```

# python - 如何将一个位置参数包含到 argparse 互斥组中？

> ID：15857953
> 
> 赞同：6
> 
> 时间：2013-04-07T01:35:06.443
> 
> 标签：python, argparse

我知道将多个位置参数放到一个相互排斥的组中是没有意义的，因为你不能说谁是谁。但我需要在其中包含一个位置参数。

我需要的：

```
$ myprogram -h
usage: myprogram [-h] [--delete value | --update value | value] 
```

其中位置`value`是默认操作（“--include”的种类）。（`myprogram`没有参数也必须有效）。

我的第一次尝试（这不起作用）：

```
parser = ArgumentParser()
group = parser.add_mutually_exclusive_group()
group.add_argument('--delete', metavar='value')
group.add_argument('--update', metavar='value')
group.add_argument('value') 
```

那可能吗？

* * *

第二次尝试：

```
parser = ArgumentParser()
group = parser.add_mutually_exclusive_group()
group.add_argument('--delete', action='store_true')
group.add_argument('--update', action='store_true')
group.add_argument('--insert', action='store_true', default=True)
group.add_argument('value') 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-07T15:49:50.317

我会做一些不同的事情：

```
parser = ArgumentParser()
group = parser.add_mutually_exclusive_group()
group.set_defaults(mode='insert')
group.add_argument('--delete', action='store_const', dest='mode', const='delete')
group.add_argument('--update', action='store_const', dest='mode', const='update')
group.add_argument('--insert', action='store_const', dest='mode', const='insert')
parser.add_argument('value', nargs='?')
args = parser.parse_args() 
```

如果您还想让`program --delete`（没有`value`选项）失败，请添加

```
if args.mode != 'insert' and args.value:
    parser.error("can't {} without a value argument".format(args.mode)) 
```

请注意，这意味着`program --insert`（没有`value`）仍然有效。`mode`您可以通过使用默认值be `None`，使用 进行上述检查`args.mode is not None`，然后执行`if args.mode is None: args.mode = 'insert'`或类似操作来避免这种情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-07T01:51:45.157

您的语法更清楚地描述为：

```
myprogram {--insert|--update|--delete} value 
```

其中`--insert`默认为 True 和 value 是必需的。

`argparse`可以让你觉得你想要的语法必须符合它的模型，比如

```
if args.insert and (args.update or args.delete):
    parser.print_help() 
```

更明显。

**添加以回应评论：**

这是伪代码（意思是我没有测试它），它显示了我将如何实现它：

```
parser.add_argument('--insert', action='store_true')
parser.add_argument('--update', action='store_true')
parser.add_argument('--delete', action='store_true')
parser.add_argument('value')
args = parser.parse_args(sys.argv)
if ((args.insert and args.delete) or
    (args.insert and args.update) or
    (args.update and args.delete)):
    # can't pick more than one, complain and quit 
elif not (args.update or args.delete):
    # they specified no action so assume insert
    args.insert = True

# now one and only one of insert/update/delete is
# True and args.value contains the argument 
```

我希望这能让事情更清楚。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-09T05:14:51.013

使位置参数可选（使用“？”）

```
parser = ArgumentParser()
group = parser.add_mutually_exclusive_group()
group.add_argument('--delete', metavar='value')
group.add_argument('--update', metavar='value')
group.add_argument('value', nargs='?') 
```

用法是：

```
usage: ipython [-h] [--delete value | --update value | value] 
```

# java - 防止多个异步调用同时进行而不阻塞

> ID：15857960
> 
> 赞同：4
> 
> 时间：2013-04-07T01:36:26.620
> 
> 标签：java, design-patterns, concurrency

这基本上是我的问题：

```
while (true) {
  if (previous 'doWorkAsync' method is not still in flight) {
    doWorkAsync()  // this returns immediately
  }
  wait set amount of time
} 
```

我想到了几个解决方案：

1.  阻塞直到 doWorkAsync() 完成。出于几个原因，这对我来说是不可取的。它（可能）导致在“等待一些设定的时间”行中等待的时间比我真正需要的时间长（例如，如果 doWorkAsync 需要 5 秒，而设定的等待时间为 10 秒，这将导致 15 秒在通话之间等待，这不是我想要的）。当然，我可以通过等待更少的时间来解释这一点，但不知何故，它只是感觉很笨拙。它也不必要地捆绑了这个线程。该线程无需等待此任务返回，而是可以处理其他工作，例如进行配置更新，以便下次调用 doWorkAsync() 获得新数据。

2.  使用门控机制。想到的最简单的实现是一个布尔值，在调用 doWorkAsync() 之前设置，并在 doWorkAsync() 完成时取消设置。这基本上就是我现在正在做的事情，但我不确定它是否是反模式？

#2 是正确的方法，还是有更好的方法来解决这个问题？

**编辑**：如果有帮助， doWorkAsync() 返回一个 ListenableFuture （番石榴）。

最初的问题可能不是 100% 清楚。这是症结所在。如果异步请求在给定超时之前完成，则此代码将始终有效。但是，如果异步任务需要 SET_AMOUNT_OF_TIME + epsilon 才能完成，那么这段代码将在必要时休眠两倍，这是我试图避免的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T02:01:45.507

最简单的方法是使用Java 中已有的`wait`和方法。`notifyAll`您需要做的就是使用一个`AtomicBoolean`作为标志并阻止它，直到另一个`Thread`告诉您某些事情发生了变化。

这与您的方法之间的区别在于，阻塞线程不执行任何操作，而轮询线程使用 CPU 时间。

`Thread`这是一个使用两个s的简单示例- `Runnable`" `First`" 已提交并等待`done`直到`Runnable`" `Second`" 通知它已更改标志。

```
public class App {

    private static final AtomicBoolean done = new AtomicBoolean(false);

    private static final class First implements Runnable {

        @Override
        public void run() {
            while (!done.get()) {
                System.out.println("Waiting.");
                synchronized (done) {
                    try {
                        done.wait();
                    } catch (InterruptedException ex) {
                        return;
                    }
                }
            }
            System.out.println("Done!");
        }
    }

    private static final class Second implements Runnable {

        @Override
        public void run() {
            try {
                Thread.sleep(1000);
            } catch (InterruptedException ex) {
                return;
            }
            done.set(true);
            synchronized (done) {
                done.notifyAll();
            }
        }
    }

    public static void main(String[] args) throws InterruptedException {
        final ExecutorService executorService = Executors.newFixedThreadPool(2);

        executorService.submit(new First());
        Thread.sleep(1000);
        executorService.submit(new Second());
        executorService.shutdown();

    }
} 
```

这些`sleep`调用只是为了表明可以执行任意长度的任务，显然它们不是必需的。

需要注意的是，*每次*`First`进入循环时都会打印“等待” ，如果您运行代码，它只会打印一次。第二件事要注意的是，它会立即对标志的变化做出反应，因为它被告知唤醒并在标志改变时重新检查。*`First`*

 *我已经`return`在`InterruptedException`块中使用过，您可能想要使用`Thread.currentThread().interrupt()`它，这样如果进程被虚假中断，它就不会死掉。

更高级的方法是使用`Lock`和`Condition`

```
public class App {

    private static final Lock lock = new ReentrantLock();
    private static final Condition condition = lock.newCondition();

    private static final class First implements Runnable {

        @Override
        public void run() {
            lock.lock();
            System.out.println("Waiting");
            try {
                condition.await();
            } catch (InterruptedException ex) {
                return;
            } finally {
                lock.unlock();
            }
            System.out.println("Done!");
        }
    }

    private static final class Second implements Runnable {

        @Override
        public void run() {
            lock.lock();
            try {
                Thread.sleep(1000);
                condition.signalAll();
            } catch (InterruptedException ex) {
                return;
            } finally {
                lock.unlock();
            }
        }
    }

    public static void main(String[] args) throws InterruptedException {
        final ExecutorService executorService = Executors.newFixedThreadPool(2);

        executorService.submit(new First());
        Thread.sleep(1000);
        executorService.submit(new Second());
        executorService.shutdown();

    }
} 
```

在这种情况下，`First`立即`Lock`调用`await`. `Condition`释放锁并阻止`Condition`.

`Second`然后获取对the 的锁`Lock`并调用which awake 。`signalAll``Condition``First`

`First`然后重新获取锁并继续执行，打印“完成！”。

**编辑**

OP希望以`doWorkAsync`指定的时间段调用该方法，如果该方法花费的时间少于该时间段，则该过程必须等待。如果该方法需要更长的时间，则应立即再次调用该方法。

任务需要在一定时间后停止。

该方法在任何时候都不应同时运行一次以上。

最简单的方法是从 a 调用该方法`ScheduledExecutorService`，该`Runnable`方法将包装该方法并调用- 阻塞调度`get`的`Future`执行程序，直到它完成。

这保证了*至少* `WAIT_TIME_BETWEEN_CALLS_SECS`延迟调用该方法。

然后安排另一个任务，在设定的时间后杀死第一个任务。

```
final ScheduledExecutorService scheduledExecutorService = Executors.newSingleThreadScheduledExecutor();
final Future<?> taskHandle = scheduledExecutorService.scheduleAtFixedRate(new Runnable() {
    @Override
    public void run() {
        final ListenableFuture<Void> lf = doWorkAsync();
        try {
            doWorkAsync().get();
        } catch (InterruptedException ex) {
            Thread.currentThread().interrupt();
        } catch (ExecutionException ex) {
            throw new RuntimeException(ex);
        }
    }
}, 0, WAIT_TIME_BETWEEN_CALLS_SECS, TimeUnit.SECONDS);
scheduledExecutorService.schedule(new Runnable() {
    @Override
    public void run() {
        taskHandle.cancel(false);
    }
}, TOTAL_TIME_SECS, TimeUnit.SECONDS); 
```

最好的解决方案是`Runnable`在 a上调​​用 raw`ScheduledExecutorService`而不是在另一个 executor 上调用它并在`ListenableFuture`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T01:51:01.170

想想你正在寻找的是[反应堆模式](http://www.dre.vanderbilt.edu/~schmidt/PDF/reactor-siemens.pdf)。

您是否有理由不希望这些东西同时运行？如果你想做的是链接它们，你可以使用 Futures。[Akka](http://akka.io)有可组合的期货和可映射的期货。*

# serialization - 序列化是否允许享元设计模式？

> ID：15857964
> 
> 赞同：2
> 
> 时间：2013-04-07T01:37:00.077
> 
> 标签：serialization, flyweight-pattern

我正在使用一个复杂的对象设计，我使用享元模式来限制类的多个实例之间的某些非静态变量。如果两个对象（享元信息和包含它的类）都是可序列化的，并且这些卡的列表从 wcf 服务传输到客户端，则客户端是否维护模式（即多个实例的享元信息只有一个副本高级别的）？我将在下面给出一个小代码示例，以防我不能很好地解释自己。

```
public class Flyweight
{
    public Image image;
}

public class SmallObject
{
    public Flyweight fly;
} 
```

其中一个列表包含 50 多个 SmallObject，但使用享元模式仅为每种单独类型的对象创建足够的图像。它不能是静态变量，因为由于设计限制，有不同类型的 SmallObjects 不能用子类表示。我需要知道的是客户是否收到 50 多个离散的享元对象，或者保持模式并且他只收到每种类型的 1 个享元。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-11T01:18:17.607

模式未保持。您需要使用 [OnDeserialized] 手动重新构建所需的引用。

# java - 对象数据库关系数据库

> ID：15857966
> 
> 赞同：-1
> 
> 时间：2013-04-07T01:37:13.480
> 
> 标签：java, object

使用 Objectdb 开发这个关系数据库。有人可以帮助修复此代码。我正在做一个关系数据库来显示学生成绩结果。对此很陌生，所以我在某个地方出错了..

```
package Student;

import java.io.Serializable;
import java.sql.Date;

import javax.persistence.*;

@Entity
    public class students implements Serializable {
    private static final long serialVersionUID = 1L;

    @studentid @GeneratedValue
    private long id;
  } 
@embeddable
    public class Student {
    int studentid;
    String firstname;
    String surname;
    char gender;
    Date dob;
    String address1;
    String address2;
    String address3;
    char postcode;
    int phonenumber;
    int courseid;

    }

@Entity 
public class courses implements Serializable {
        @EmbeddedId Course id;
        :
}

@Embeddable
    public class course {
    int courseid;    
    string coursename;
    date coursestartdate;
    date courseenddate;
    }

@entity 
    public class moduledetails implements Serializable {
    private static final long serialVersionUID = 1L;

    @moduleId @GeneratedValue
    private long id;
}
@Embeddable
    public class module {
    int moduleid;    
    String modulename;
    int courseid;

    int lectureid;
    }

@entity 
    public class lecturedetails implements Serializable {
    private static final long serialVersionUID = 1L;

    @lectureId @GeneratedValue
    private long id;
}
@Embeddable
    public class lecture {
    int lectureid;    
    String lecturename;
    String lecturedepartment;
    }

@entity 
    public class resultdetails implements Serializable {
    private static final long serialVersionUID = 1L;

    @studentId @GeneratedValue
    private long id;

@Embeddable
    public class result<Varchar> {
    int studentid;    
    int courseid;
    int moduleid;
    Varchar modulename;
    char grade;
    }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T08:59:41.580

注解@studentid、@moduleId 和@lectureId 无效。使用@Id。

# cakephp - CakePHP - 尝试使用模型 SaveMany( ) 构建多个 SQL 插入

> ID：15857975
> 
> 赞同：0
> 
> 时间：2013-04-07T01:38:15.760
> 
> 标签：cakephp

我正在使用 cakephp 2.3.0。我有一个场景，我需要在表中插入数据，但我需要根据需要插入数据的用户数量进行多次插入。如果我在 中有一个值`$userIds array`，或者在 中有超过 1 个值`$userIds array`，则表中只插入一行。即，如果我在数组中有两个值，我希望在我的表中插入两行。

我不知道如何正确地使用不同的值构建我的 $message 数组`$userIds array`。在下面的示例输出中，值 5 被 3 覆盖，而 3 被值 4 覆盖。

当我在 $userIds 数组中有 2 个或更多值时，我通过调试语句确认 for 循环在数组中的每次循环都正确循环。

下面是调试语句的输出：

> \app\Controller\ActivitiesController.php（第 134 行）
> 
> '5'
> 
> \app\Controller\ActivitiesController.php（第 134 行）
> 
> '3'
> 
> \app\Controller\ActivitiesController.php（第 134 行）
> 
> '4'
> 
> \app\Controller\ActivitiesController.php（第 136 行）

```
array(
'Message' => array(
    'message' => 'The activity has been deleted.',
    'user_id' => '4'
    )
) 
```

以下是我的控制器中的代码片段：

```
$this->Activity->Message->create();

foreach ($userIds as $ids) {
    $message = array(
        'Message' => array(
            'message' => 'The activity has been deleted.',
            'user_id' => $ids                                       
        )
    );

    debug($ids);                        
}
debug($message);
$this->Activity->Message->saveMany($message); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T02:58:21.360

您每次都重置您的数组，而不是向其中添加一个元素。所以尝试像这样改变你的 foreach

```
$message = array();
foreach ($userIds as $ids) {
    $message[] = array(
                    'Message' => array(
                        'message' => 'The activity has been deleted.',
                        'user_id' => $ids                                       
                    )
                );

    debug($ids);                        
} 
```

# c# - 接口和类之间的区别

> ID：15857982
> 
> 赞同：15
> 
> 时间：2013-04-07T01:40:07.843
> 
> 标签：c#, class, interface

正如标题所述，我想知道使用这样的类之间的区别

```
public class Account
{
    public string Username { get; set; }
    public string Password { get; set; }
} 
```

并像这样使用和界面

```
public class Account : IAccount
{
    public string Username { get; set; }
    public string Password { get; set; }
}

public interface IAccount
{
    string Username { get; set; }
    string Password { get; set; }
} 
```

我真的很困惑，因为我发现接口没用，因为我可以用它做的所有事情只能使用 Class 来完成，因此，我需要有人为我澄清事情。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-07T01:46:15.203

接口是一种*契约*：它指定实现接口的类*必须*具有的成员（方法和属性）。但是因为它只是一个合约，它的任何成员都没有实现。一个类可以实现零个、一个或多个接口。

相比之下：一个*类*是一个......嗯......对象类（如分类学）。例如，an`Animal`是一类生物，a`Giraffe`是一类动物。继承表达了这种关系： an`Giraffe` *是一个* `Animal`when`Giraffe`继承自`Animal`。它可以做任何动物可以做的事情，甚至更多。它可以为其成员提供实现，并且在 .NET 中，一个类将完全继承自另一个类（`Object`除非另有说明）。

所以，如果你想表达你的类遵守一个或多个契约：使用*接口*。但是，您无法提供实现。如果你想表达你的类*是*什么，扩展一个基类。在这种情况下，您可以提供一个实现，但您只能扩展*一个*基类。

* * *

举一个具体的例子：

链表、数组列表、堆栈和字典有一些共同点：它们代表元素的集合。但是它们的实现完全不同。他们唯一的共同点是他们遵守的合同：`ICollection`. 这意味着你的类可以要求一个集合，*任何集合*：任何实现的东西`ICollection`，不管它的实现。

另一方面：汽车、摩托车和卡车也有共同点：它们都是轮式车辆。但他们有更多的共同点：他们都有一个马达，他们都旋转轮胎前进。本质上，它们是`Vehicle`对象类的成员，并且可以共享（部分）它们的实现。但是，虽然 a`Truck`可能是 a`Vehicle` *和*a `CargoCarrier`，但您不能在 C# 中表达这一点。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-04-07T01:46:04.523

基本上：

> 接口提供`contract`指定如何与对象对话，但不提供该对象如何处理该请求的细节（除了参数和返回类型等）

和：

> 一个类（尤其是抽象类）提供了如何与对象对话的信息，但在某些情况下提供了实际的实现（考虑覆盖基类的方法）。

接口允许您定义对象之间的通用通信形式，而无需关心它们如何做事的细节。

一个例子是记录：

```
public interface ILog
{
   void WriteMessage(string message);
}

public class ConsoleLogger : ILog
{
   public void WriteMessage(string message)
   {
      Console.WriteLine(message);
   }
}

public class MessageBoxLogger : ILog
{
   public void WriteMessage(string message)
   {
      MessageBox.Show(message);
   }
}

public void DoSomethingInteresting(ILog logger)
{
   logger.WriteMessage("I'm doing something interesting!");
} 
```

因为两者都`ConsoleLogger`实现`MessageBoxLogger`了`ILog`接口（`WriteMessage`方法），代码的任何部分都可以在`ILog`不需要知道它实际做了什么的情况下，他们只关心它做**了什么**——在这种情况下，写一条日志消息。

所以在上面的代码中，要么 a`ConsoleLogger`要么`MessageBoxLogger`可以提供给`DoSomethingInteresting`它根本不重要，因为`ILog`“知道”如何与该对象交谈。

# javascript - 还有另一种编写函数声明的方法吗？

> ID：15857983
> 
> 赞同：0
> 
> 时间：2013-04-07T01:40:20.020
> 
> 标签：javascript

*在声明 dbr之后*写 dbr.onsuccess 对我来说似乎很奇怪。

```
var dbr = window.indexedDB.open("Matrix");
dbr.onsuccess = function(myEvent) {} 
```

问：是否有另一种方式来编写第 2 行（不是 Rube Goldberg）？也许是这样的：

```
function dbr.onsuccess(myEvent) {
} 
```

我只是关心事情的顺序。*对我来说，在创建 dbr后*为其分配 onsuccess 函数似乎为时已晚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:46:29.630

```
var dbr = window.indexedDB.open("Matrix"); 
```

是一个异步请求。

异步请求在后台运行，并且在函数完成之前不会运行它们的回调。因此，所有其他分配都将在任何回调函数运行之前发生。

indexedDB 正在返回一个接口对象，以便您可以准确定义这些回调函数是什么。你可以把它想象成你提出请求

> 嘿我要开矩阵

并得到回复说

> 嘿，我正在处理这个，这是一个对象。当我完成它时，请列出你想要发生的事情。

然后，当它完成打开操作（并且当前函数上下文已完成运行）时，它将查看该对象并相应地运行。

的返回值`open`不是函数的真实结果，它只是一个返回的对象，告诉你该做什么。这类似于[promise/deferred](http://blog.parse.com/2013/01/29/whats-so-great-about-javascript-promises/)的做事方式，不同于普通的JS回调模型。

这：

```
function dbr.onsuccess(myEvent) {
} 
```

不是有效的语法。在对象本身被定义之前，您不能在对象上定义属性，并且 javascript 不支持属性的函数声明。它们仅用于顶级对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T01:46:37.007

```
dbr.onsuccess = function(myEvent) {} 
```

这在技术上是一个函数表达式，因为它是`onsuccess`对`dbr`.

因此，当您问是否有不止一种方法来编写函数声明时，从技术上讲，答案是否定的。

函数声明只有一种形式：

```
function foo() {} 
```

您建议的将函数声明为对象属性的语法很有趣，但这个想法的一个问题是函数提升。您可能已经知道，函数（包括它们的定义）在范围内的任何地方都可用，甚至是前面的代码。举个例子：

```
foo.bar();
var foo = getFoo();
function foo.bar() {} 
```

由于函数提升，`foo.bar`应该在第 1 行可用。但由于变量提升，`foo`已*声明*但尚未*定义*。第 1 行`foo`的值为`undefined`并且如果您尝试调用 function 将导致 TypeError `foo.bar`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-07T18:54:47.233

我想你可以说：

```
var dbr = window.indexedDB.open("Matrix").onsuccess = function(myEvent) {} 
```

# java - 如何在不创建实际对象的情况下访问已经运行的类实例

> ID：15857984
> 
> 赞同：1
> 
> 时间：2013-04-07T01:40:26.663
> 
> 标签：java, multithreading, class, instance, runnable

我对 Java GUI 有疑问。这很难解释，但我会尽力而为。我有 2 个 GUI 类，一个是 I 类，另一个是 G 类。 I 类是从 main 方法启动的。在 I 类中有一个 G 类的字段（实例）。原因是 I 类收集重要信息并将其传递给 G 类的实例。当在 I 类中按下按钮时，将 I 类框架可见性设置为 false 和类 G 的实例为 true（显示 G 接口）。这里的问题是我希望能够在 G 中创建一个侦听器，将 I 的可见性设置回 true ，从而显示先前编辑的窗口。我有一个处理所有帧并创建一个新实例的解决方案，但这只显示了一个新的已清除 I 实例。以下是一些代码片段：

第一类：

领域：

```
private JFileChooser j;
private FileFilter filter;
private GUI g;  //<--- it is initialized shortly after.
private Font masterFont;
private JFrame frame;
private JButton done;

private JButton browse1;
private JButton browse2;..... 
```

设置 G 可见和 I 不可见：

```
class Done implements ActionListener {

    @Override
    public void actionPerformed(ActionEvent e) {

        for (int i = 0; i < 9; i++) {
            System.out.println(array[i]);
        }

        g.setArray(array);
        System.out.println(array);
        setText();
        frame.setVisible(false);
        g.setVisible(true);
        g.setVisible2(false);
        if (g.clear.isSelected()) {
            frame.setVisible(true);
        }

    } 
```

G 类：注意，在这里我无法创建 I 的实例，因为我不断收到 Stack Overflow 错误。

硬重置：这个只是在处理其余的时候创建新实例（可能是浪费，因为 I 的旧实例没有正确关闭）

```
private class Reset implements ActionListener {
    @Override
        public void actionPerformed(ActionEvent arg0) {
            frame.dispose();
            frame2.dispose();

            Runnable runnable = new Runnable() {
                @Override
            public void run() {
                Intro g = new Intro();
                g.setVisible(true);

            }
        };
        EventQueue.invokeLater(runnable);
    }
} 
```

我希望能够在不创建任何新实例的情况下访问 I 的“已运行”实例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T02:24:29.037

您可以将对“I”的引用传递给“G”（通过构造函数或设置器）并使用它`actionPerformed`来将可见性设置为真。如果您只有一个“I”实例，另一种方法是创建一个静态引用，您可以从“G”引用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T02:32:27.843

一种解决方案是让 G 类持有对 I 的引用。

```
public class G
{
    private I i;
    // ... other stuff

    public G(I i)
    {
        this.i = i;
    }
} 
```

并在必要时隐藏自身并显示“I”GUI 窗口（或其他任何内容）。如果类“I”是（拥有）“G”的父级（您发布的代码似乎就是这种情况），我会选择这个解决方案。您是最能确定是否是这种情况的人，但一个简单的例子是您是否有一个主窗口和一些对话框窗口（在这种情况下将充当子窗口）。如果他们都是平等的公民（都属于某个第三类），我将传递对该类的引用，并在显示或隐藏“I”和“G”时对其进行管理。

如果您确定只需要一个类的实例，另一种解决方案是使用单例设计模式。我没有足够的经验来判断它是好是坏，但我已经看到很多对这种设计模式的消极态度，因此请谨慎使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-07T02:40:36.673

您可以从传递给 ActionListener 的 actionPerformed 方法的 ActionEvent 对象获取当前顶级窗口。获取导致调用监听器的源对象，`getSource()`然后`SwingUtilities.getWindowAncestor()`在源上调用以获取 Window（JFrame、JDialog 或任何可能的名称）。

# ruby-on-rails - Rails 生产环境

> ID：15857985
> 
> 赞同：0
> 
> 时间：2013-04-07T01:40:54.023
> 
> 标签：ruby-on-rails, security, production-environment

我是 Rails 新手，一直在网上搜索部署指南 - 它非常分散。我看到一些建议部署为启用 sudo 的用户。出于安全原因，我在想您会创建一个没有 sudo 权限的用户来运行该应用程序。它需要它自己的 RVM 和捆绑器主目录，但拥有 sudo 权限似乎是多余的并且存在安全风险。我都是手动完成的，因为它是一个棘手的 beta 级应用程序，部署它还不是很简单，所以 capistrano 在这一点上只是一个混淆层。

我使用 Thin 作为服务器，Nginx 作为代理，redis 和 Postgres 作为数据库。发条和sidekiq也是如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:51:37.217

如果您是 Rails 新手，我建议您在第一次部署时使用一些简单的方法。 [Heroku](http://www.heroku.com)允许您通过简单地向其存储库执行 git push 来部署应用程序。他们处理使您的应用程序在 Internet 上可用所需的所有步骤。最重要的是，只要您不需要大量资源，它就是免费的。

[EngineYard](http://www.engineyard.com)是另一种托管解决方案，在灵活性（和成本）方面很容易部署到 Heroku 并从 Heroku 升级。

一旦您对部署生产应用程序感到满意，您就可以考虑使用自己的服务器并使用 capistrano 进行最终的定制。

我的生产网站在这两种环境中都运行，而且我还不需要麻烦迁移到我自己的托管服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T01:55:14.907

即使对于一个小项目，Capistrano 似乎也需要做很多工作，但如果您希望应用程序不断增长（因此部署的复杂性会增加），那么无论如何都值得进行设置。

我个人喜欢将特定于发行版的可用 Ruby（和 gem）分离到特定于应用程序的 RVM 部署的想法。此外，要求 bundler 管理 gem 依赖项并确保合规性是非常宝贵的。我不建议为该用户启用 sudo；它会将整个堆栈从 HTTP 请求公开到根级别的操作系统控制。应用程序不需要管理访问权限，部署脚本可能需要。

# c++ - int (*ip)[4] 和 int ip[4] 的区别？

> ID：15857986
> 
> 赞同：-5
> 
> 时间：2013-04-07T01:41:10.937
> 
> 标签：c++, arrays

`int (*ip)[4]`C++和`int ip[4]`C++之间有什么区别吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-07T01:46:17.177

> `int (*ip)[4]`C++和`int ip[4]`C++之间有什么区别吗？

是的，`int (*a)[4]`是一个指向 4 个整数数组的指针，而`int b[4]`是一个 4 个整数数组。请注意，这`a`不是一个数组，它只是一个指针。这是一个例子：

```
int main()
{
    int a[5] = {2, 3, 6, 8, 10};
    int (*b)[5] = &a; // assign the address of the array to the pointer

    b[2] = 4; // dereferences the pointer and assigns a[2] to 4
} 
```

另一个区别是您可以将指向数组的指针作为参数传递给函数，而无需进行数组到指针的转换。

```
void f( int (*array)[5] ); // must have a size of 5

int main()
{
    int a[10],
        b[5];

    f(&a); // NO
    f(&b); // Okay
} 
```

您可以通过使用对数组的*引用*来避免传递地址。它与普通引用具有相同的语义，因此您可以在签名中简单地替换`*`为 with 。`&`而你会改为`f(a)`and `f(b)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T02:10:12.167

`int (*ip)[4]`with之间的区别与 say和`int ip[4]`之间的区别相同。一般来说，它与任何类型之间的区别相同。即前者声明了某种类型的*对象*，而后者声明了一个*指向该*类型对象的指针。`int i``int *i``T t``T *t``T`*`T`*`T`**

 **从语法上看并不明显，但确实如此。为了进一步说明，这些您的原始声明

```
int (*ip1)[4];
int ip2[4]; 
```

可以替换为以下序列

```
typedef int FourIntsArray[4];

FourIntsArray *ip1; // <- same as `int (*ip1)[4]`
FourIntsArray ip2;  // <- same as `int ip2[4]` 
```

后面的声明与您的原始声明完全相同。**

# vector - three.js 和五彩纸屑

> ID：15857990
> 
> 赞同：0
> 
> 时间：2013-04-07T01:41:51.353
> 
> 标签：vector, three.js

我正在尝试制作五彩纸屑爆炸，但我在将五彩纸屑投射出去时遇到了问题。我的想法是向各个方向（1 秒）快速向外爆炸，然后五彩纸屑飘到地上。我确定我的数学是错误的，因为我没有让它扩展。

我采用了three.js 代码并制作了一些模组：

[http://givememypatientinfo.com/ParticleBlocksConfetti.html](http://givememypatientinfo.com/ParticleBlocksConfetti.html)

欢迎任何建议。我是 three.js 的菜鸟……但我喜欢图书馆！

代码：

```
 var container, stats;
        var camera, controls, scene, projector, renderer;
        var objects = [], plane;
        var vel = 1;
        var vel2 = 0.01;
        var accel = .3;
        var accel2 = -.9;
        var force = 1;

        var frame = 0;

        var mouse = new THREE.Vector2(),
        offset = new THREE.Vector3(),
        INTERSECTED, SELECTED;

        init();
        animate();

        function init() {

            container = document.createElement( 'div' );
            document.body.appendChild( container );

            camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 1, 10000 );
            camera.position.z = 1000;

            /*//controls = new THREE.TrackballControls( camera );
            controls.rotateSpeed = 1.0;
            controls.zoomSpeed = 1.2;
            controls.panSpeed = 0.8;
            controls.noZoom = false;
            controls.noPan = false;
            controls.staticMoving = true;
            controls.dynamicDampingFactor = 0.3;*/

            scene = new THREE.Scene();

            scene.add( new THREE.AmbientLight( 0x505050 ) );

            var light = new THREE.SpotLight( 0xffffff, 1.5 );
            light.position.set( 0, 500, 2000 );
            light.castShadow = true;

            light.shadowCameraNear = 200;
            light.shadowCameraFar = camera.far;
            light.shadowCameraFov = 50;

            light.shadowBias = -0.00022;
            light.shadowDarkness = 0.5;

            light.shadowMapWidth = 2048;
            light.shadowMapHeight = 2048;

            scene.add( light );

            var geometry = new THREE.CubeGeometry( 40, 40, 40 );

            //make confetti for particle system 
            for ( var i = 0; i < 100; i ++ ) {

                var object = new THREE.Mesh( geometry, new THREE.MeshLambertMaterial( { color: Math.random() * 0xffffff } ) );

                //object.material.ambient = object.material.color;

                /*object.position.x = Math.random() * 500 - 100;
                object.position.y = Math.random() * 500 - 100;
                object.position.z = 300;*/

                object.position.x = Math.random() * 100 - 100;
                object.position.y = Math.random() * 100 - 100;
                object.position.z = 300;

                object.rotation.x = Math.random() * 2 * Math.PI;
                object.rotation.y = Math.random() * 2 * Math.PI;
                object.rotation.z = Math.random() * 2 * Math.PI;

                object.scale.x = .1;
                object.scale.y = Math.random() * .8 + .1;
                object.scale.z = Math.random() * .5 + .1;

                object.castShadow = false;
                object.receiveShadow = true;

                scene.add( object );

                objects.push( object );
            }

            plane = new THREE.Mesh( new THREE.PlaneGeometry( 2000, 2000, 8, 8 ), new THREE.MeshBasicMaterial( { color: 0x000000, opacity: 0.25, transparent: true, wireframe: true } ) );
            plane.visible = false;
            scene.add( plane );

            projector = new THREE.Projector();

            renderer = new THREE.WebGLRenderer( { antialias: true } );
            renderer.sortObjects = false;
            renderer.setSize( window.innerWidth, window.innerHeight );

            renderer.shadowMapEnabled = true;
            renderer.shadowMapType = THREE.PCFShadowMap;

            container.appendChild( renderer.domElement );

            var info = document.createElement( 'div' );
            info.style.position = 'absolute';
            info.style.top = '10px';
            info.style.width = '100%';
            info.style.textAlign = 'center';
            info.innerHTML = '<a href="http://threejs.org" target="_blank">three.js</a> webgl - draggable cubes';
            container.appendChild( info );

        }

    function animate_particles(frame) {
    //will update each particle     
  if (frame < 50){
      var pCount = objects.length-1;    

    if (frame < 40){
         vel += accel*2;
    }else {
         vel = vel + accel2;
    }

    while(pCount > -1) {
        if (frame < 30){
            objects[pCount].position.y += vel;
        }else{
             objects[pCount].position.y -= vel;
        }

        //objects[pCount].rotation.x += Math.random()*.7;
        //objects[pCount].rotation.z += Math.random()*.01;
        //objects[pCount].rotation.y += Math.random()*.01;

        pCount--;

        }
    }
}

        function animate() {

            requestAnimationFrame( animate );
            animate_particles(frame);
            render();
            //stats.update();

        }

        function render() {

            renderer.render( scene, camera );
            frame++;
        }

    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T11:35:16.583

这可能是您试图归档的内容。我稍微修改了您的代码并评论了更改。基本上我只是添加了一个随机方向向量，对其进行归一化并为粒子添加了一个随机速度。在 animate_particles 函数中，我以随机速度沿随机方向矢量移动五彩纸屑。

```
 var container, stats;
    var camera, controls, scene, projector, renderer;
    var objects = [], plane;
    var vel = 1;
    var vel2 = 0.01;
    var accel = .3;
    var accel2 = -.9;
    var force = 1;

    var frame = 0;

    var mouse = new THREE.Vector2(),
    offset = new THREE.Vector3(),
    INTERSECTED, SELECTED;

    init();
    animate();

    function init() {

        container = document.createElement( 'div' );
        document.body.appendChild( container );

        camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 1, 10000 );
        camera.position.z = 1000;

        /*//controls = new THREE.TrackballControls( camera );
        controls.rotateSpeed = 1.0;
        controls.zoomSpeed = 1.2;
        controls.panSpeed = 0.8;
        controls.noZoom = false;
        controls.noPan = false;
        controls.staticMoving = true;
        controls.dynamicDampingFactor = 0.3;*/

        scene = new THREE.Scene();

        scene.add( new THREE.AmbientLight( 0x505050 ) );

        var light = new THREE.SpotLight( 0xffffff, 1.5 );
        light.position.set( 0, 500, 2000 );
        light.castShadow = true;

        light.shadowCameraNear = 200;
        light.shadowCameraFar = camera.far;
        light.shadowCameraFov = 50;

        light.shadowBias = -0.00022;
        light.shadowDarkness = 0.5;

        light.shadowMapWidth = 2048;
        light.shadowMapHeight = 2048;

        scene.add( light );

        var geometry = new THREE.CubeGeometry( 40, 40, 40 );

        //make confetti for particle system 
        for ( var i = 0; i < 100; i ++ ) {

            var object = new THREE.Mesh( geometry, new THREE.MeshLambertMaterial( { color: Math.random() * 0xffffff } ) );

            //object.material.ambient = object.material.color;

            /*object.position.x = Math.random() * 500 - 100;
            object.position.y = Math.random() * 500 - 100;
            object.position.z = 300;*/

            object.position.x = Math.random() * 100 - 100;
            object.position.y = Math.random() * 100 - 100;
            object.position.z = 300;

            object.rotation.x = Math.random() * 2 * Math.PI;
            object.rotation.y = Math.random() * 2 * Math.PI;
            object.rotation.z = Math.random() * 2 * Math.PI;

            object.scale.x = .1;
            object.scale.y = Math.random() * .8 + .1;
            object.scale.z = Math.random() * .5 + .1;

            // give every "particle" a random expanding direction vector and normalize it to receive a length of 1.
            object.directionVector = new THREE.Vector3( Math.random() - .5, Math.random() - .5, Math.random() - .5 )
            object.directionVector.normalize();

            // and a random expanding Speed
            object.expandingSpeed = Math.random() * 100;

            object.castShadow = false;
            object.receiveShadow = true;

            scene.add( object );

            objects.push( object );
        }

        plane = new THREE.Mesh( new THREE.PlaneGeometry( 2000, 2000, 8, 8 ), new THREE.MeshBasicMaterial( { color: 0x000000, opacity: 0.25, transparent: true, wireframe: true } ) );
        plane.visible = false;
        scene.add( plane );

        projector = new THREE.Projector();

        renderer = new THREE.WebGLRenderer( { antialias: true } );
        renderer.sortObjects = false;
        renderer.setSize( window.innerWidth, window.innerHeight );

        renderer.shadowMapEnabled = true;
        renderer.shadowMapType = THREE.PCFShadowMap;

        container.appendChild( renderer.domElement );

        var info = document.createElement( 'div' );
        info.style.position = 'absolute';
        info.style.top = '10px';
        info.style.width = '100%';
        info.style.textAlign = 'center';
        info.innerHTML = '<a href="http://threejs.org" target="_blank">three.js</a> webgl - draggable cubes';
        container.appendChild( info );

    }

    function animate_particles(frame) {
    //will update each particle     
    if (frame < 50){
      var pCount = objects.length-1;    

    if (frame < 40){
         vel += accel*2;
    }else {
         vel = vel + accel2;
    }

    while(pCount > -1) {
        if (frame < 30){
            // commented that out. not sure why you put it there.
            //objects[pCount].position.y += vel;

            // move objects along random direction vector at the individual random speed. 
            objects[pCount].position.x += objects[pCount].directionVector.x * objects[pCount].expandingSpeed;
            objects[pCount].position.y += objects[pCount].directionVector.y * objects[pCount].expandingSpeed;
            objects[pCount].position.z += objects[pCount].directionVector.z * objects[pCount].expandingSpeed;
        }else{
             objects[pCount].position.y -= vel;
        }

        //objects[pCount].rotation.x += Math.random()*.7;
        //objects[pCount].rotation.z += Math.random()*.01;
        //objects[pCount].rotation.y += Math.random()*.01;

        pCount--;

        }
    }
}

    function animate() {

        requestAnimationFrame( animate );
        animate_particles(frame);
        render();
        //stats.update();

    }

    function render() {

        renderer.render( scene, camera );
        frame++;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-31T06:17:58.893

我刚刚制作了一个用 THREE.js 创建五彩纸屑效果的插件：[https ://github.com/mrgoonie/three.confetti.explosion.js](https://github.com/mrgoonie/three.confetti.explosion.js)

事情会更容易：

```
var confetti = new ExplosionConfetti({
    rate: 1, // percent of explosion in every tick - smaller is fewer - be careful, larger than 10 may crash your browser!
    amount: 200, // max amount particle of an explosion
    radius: 800, // max radius of an explosion
    areaWidth: 500, // width of the area 
    areaHeight: 500, // height of the area 
    fallingHeight: 500, // start exploding from Y position
    fallingSpeed: 1, // max falling speed
    colors: [0xffffff, 0xff0000, 0xffff00] // random colors
});
scene.add( confetti.object ); 
```

干杯，

# unity3d - Unity 以螺旋运动方式接近物体

> ID：15857991
> 
> 赞同：0
> 
> 时间：2013-04-07T01:42:07.057
> 
> 标签：unity3d, geometry, gameobject

在 Unity 中，我可以使用简单的方法处理围绕对象的圆周运动

```
transform.RotateAround(GameObject.Find("CubeTest").transform.position, Vector3.up, 20000*Time.deltaTime); 
```

但是，我希望以圆周运动运动的物体在轨道上接近这个物体。不完全确定如何在不搞砸的情况下做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T14:18:29.110

```
GameObject cube = GameObject.Find("CubeTest");    
transform.LookAt(cube.transform);
transform.Translate(transform.forward * Time.deltaTime * approachSpeed);
transform.RotateAround(cube.transform.position, Vector3.up,20000*Time.deltaTime); 
```

我想这可以如你所愿吗？它逐渐向旋转点移动，然后旋转，呈现出恶化的轨道。

# android - 在自定义视图中显示 Action 的 Toast

> ID：15857992
> 
> 赞同：2
> 
> 时间：2013-04-07T01:42:39.820
> 
> 标签：android, actionbarsherlock

我需要创建一个自定义视图来在 Sherlock ActionBar 中设置一个额外的 Action。这是xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:gravity="right"
    android:orientation="horizontal" >

    <ImageButton
        android:id="@+id/edit"
        style="@style/Widget.Sherlock.ActionButton"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/ic_edit" />

</LinearLayout> 
```

这是代码：

```
LayoutParams lp = new LayoutParams(LayoutParams.WRAP_CONTENT,
            LayoutParams.WRAP_CONTENT, Gravity.RIGHT
                    | Gravity.CENTER_VERTICAL);

ActionBar actionbar = getSherlockActivity().getSupportActionBar();

actionbar.setCustomView(getSherlockActivity().getLayoutInflater()
            .inflate(R.layout.top_sample_detail, null), lp);
actionbar.setDisplayOptions(ActionBar.DISPLAY_HOME_AS_UP
            | ActionBar.DISPLAY_SHOW_HOME | ActionBar.DISPLAY_SHOW_CUSTOM
            | ActionBar.DISPLAY_SHOW_TITLE); 
```

我可以通过定位轻松找到`edit`按钮`actionbar.getCustomView().findViewById(R.id.edit)`，但这不是问题。我想知道是否有默认的自动方式在长按后在 Toast 中显示按钮的名称，就像它是非自定义视图中的操作一样。

## tl;博士

总结一下：**是否有一个属性/方法/属性可以设置为`ImageButton`，以使其表现为一个操作项并`Toast`在长按时显示一个，就像操作项一样？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-18T12:54:43.757

我想出了一个类似的问题（[**这是**](https://stackoverflow.com/questions/20595248/how-to-add-a-clickable-events-action-item-to-actionbarsherlock?noredirect=1#comment30926971_20595248)关于它的帖子），我想到了两种可能的解决方案：

1.  以某种方式扩展 ActionMenuItemView，并使其布局包含它需要的内容，但禁止显示视图。将您自己的布局添加到它的布局中。这是一个相当混乱的解决方案。

2.  在操作项的视图上使用 setOnLongClickListener，并调用为 ActionMenuItemView::onLongClick 调用的相同代码。这实际上是我在我创建的帖子上写的（[**这里**](https://stackoverflow.com/a/20658848/878126)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T02:01:30.413

我认为您可以将项目添加到菜单 xml 并将 showAsAction 设置为“始终”，而不是执行所有这些操作。

# algorithm - 无向图中的连通分量数

> ID：15857994
> 
> 赞同：5
> 
> 时间：2013-04-07T01:42:46.460
> 
> 标签：algorithm, data-structures, graph

我正在讨论一些图形算法（**这不是家庭作业；我只是在复习算法和数据结构**）并且我有一个问题。假设我有以下无向图：

```
var graph = {
    9: [19, 26],
    13: [19, 5],
    17: [],
    26: [11, 18],
    18: [9],
    19: [],
    23: [24],
    24: [],
    11: [],
    18: []
}; 
```

该图基本上如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/A6kof.png)

该图中有多少个连通分量？从图表上看，似乎有 3 个组件。*但是，如果我实际上实现了该算法（迭代每个顶点，如果*该顶点未被发现，则使用该顶点作为起点执行bfs。此外，bfs 会将它遇到的任何顶点标记为已发现）。

如果我从 开始`9`，我最终会发现以下节点：`[19, 26, 11, 18]`. 但是，`13`没有被发现，因为它不在`19`的邻接列表中。但是，`19`在`13`的邻接列表中。这就是为什么我最终得到了一个额外的组件。

它是否正确？实际上是否有 4 个单独的组件，如果是，我对连接组件的理解是否错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-07T01:45:48.980

问题是对于**无向**图的邻接表表示，你必须要么

(1) 使用对称邻接表，即在放入新边时`ab`，添加`b`到`adjlist[a]` **，**反之亦然

或者

(2) 每次寻找边的存在时，遍历所有顶点的邻接表。

由于（2）效率极低，您通常会选择（1）。这也是一般使用的 adj 列表的约定。如果我看到您的 adj 列表，我会假设该图是定向的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-07T01:46:15.280

您可以更改邻接列表表示，您的表示是“有向的”，但您的图片是无向的。对于边（a，b）图{a：[b]，b：[a]}

# c# - 为 ListViewItem 应用默认样式，同时使用自定义行为

> ID：15857995
> 
> 赞同：0
> 
> 时间：2013-04-07T01:42:52.183
> 
> 标签：c#, wpf, listview, attachedbehaviors

我正在使用自定义行为将列表视图项滚动到 ListView 的当前可见视图中：

[mvvm 如何使列表视图自动滚动到列表视图中的新项目](https://stackoverflow.com/questions/3317194/mvvm-how-to-make-a-list-view-auto-scroll-to-a-new-item-in-a-list-view)

```
<UserControl.Resources>
    <Style x:Key="ListBoxItemContainerStyle" TargetType="{x:Type ListBoxItem}"
        BasedOn="{StaticResource {x:Type ListBoxItem}}">
        <Setter Property="localBehaviors:ListBoxItemBehavior.IsBroughtIntoViewWhenSelected" Value="true"/>
    </Style>
</UserControl.Resources>

<!-- using Caliburn.Micro's conventions to bind ItemsSource -->
<ListView x:Name="Items" ItemContainerStyle="{StaticResource ListBoxItemContainerStyle}"
    <ListView.View>
        <GridView>
            <GridViewColumn Header="Column #1" DisplayMemberBinding="{Binding ValueOfColumnOne}" />
            <!-- the rest of columns are defined here using DisplayMemberBinding or GridViewColumn.CellTemplate -->
        </GridView
    </ListView.View>
</ListView> 
```

问题是，正如这个问题中所描述的那样，列表视图项目失去了它们的显示定义（我猜是模板）：

[应用 ItemContainerStyle 时 ListView 失去 GridView 显示](https://stackoverflow.com/questions/10922112/listview-losing-gridview-display-when-applying-itemcontainerstyle)

但是，我不想重新定义 ListViewItem 的模板；即我想使用默认值，由 WPF 提供。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T20:01:10.803

你不能只使用 ScrollIntoView 吗？然后集中注意力。

```
listview.ScrollIntoView(listviewitem);
listviewitem.Focus(); 
```

# php - PHP 最大执行时间？

> ID：15857997
> 
> 赞同：-1
> 
> 时间：2013-04-07T01:43:07.467
> 
> 标签：php, execution

我可能在这段代码中遗漏了一些东西，似乎是某种循环问题，这是代码，我不知道发生了什么：

```
 function clearBoard() {
        //initialize board with a . in each cell
        global $board, $boardData;

        for ($row = 0; $row < $boardData["height"]; $row++) {
            for ($col = 0; $col < $boardData["width"]; $col++) {
                $board[$row][$col] = ".";
            } //end col for loop
        } //end row for loop
    } //end clearBoard 
```

非常感谢

亚历克斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T01:49:10.100

该代码没有先天问题。它以非常合理的方式完成了显而易见的事情。如果花费的时间太长，那么网格就太大了。就这么简单。

话虽如此，有一种方法可以加快速度：使用[`array_fill`](http://www.php.net/array_fill)：

```
function clearBoard() {
    global $board, $boardData;
    $board = array_fill(0, $boardData["height"],
        array_fill(0, $boardData["width"], "."));
} 
```

`array_fill`据我所知，是用 C 实现的，应该比 PHP 快。