# StackOverflow 问答 12734000-12734999

# design-patterns - 域代码请求它需要的数据是否被认为是一种不好的做法？

> ID：12734000
> 
> 赞同：0
> 
> 时间：2012-10-04T18:58:21.890
> 
> 标签：design-patterns, domain-driven-design, repository-pattern

*域实体*不应包含与持久性相关的代码，因此它们应该是*Persistence Ignorant* **PI**

*领域模型* **DM**感兴趣的数据可以通过*领域实体*的*导航属性*或上层（即*UI 层*或*服务层）传递给***DM**。

 ***但我还假设，在特定*域实体*必须动态决定它需要什么数据的情况下，该*实体*通过诸如*Repository*之类的组件请求该数据是完全可以接受的。

如果这个*Repository与**持久层*完全解耦，那么我们的*实体*就没有违反**PI**，因为它仍然不知道它是如何获取数据的，它只知道它通过从*Repository*请求数据来获取数据：

```
class Customer
{
       public string InterestedWhatOtherCustomerOrdered( ... )
       {
                ...
                var orders = repository.Find...;
                ...
        }
       ...
} 
```

因此，为什么*域代码*也能够从*存储库*请求它需要的数据而不是仅仅从上层或导航属性接收它被认为是一种不好的做法？

也就是说，即使根据*Fowler*（*关于 Data Mapper 的 PEAA 章节），也可以从**Data Mapper*中提取*域代码*所需的任何方法到*接口类*中，然后*域代码*可以使用该接口类。

**回复塞巴斯蒂安·古德：**

1)

> 这个想法是你的域模型不应该关心数据来自哪里的细节。

但是，如果域实体遵守 PI 规则，那么我们可以说他们不知道数据实际来自何处的详细信息。

> 2）您仍然必须决定如何加载该数据，但是您让“应用程序服务”（通常）担心它。

a）假设*现实世界的实体*确实具有搜索特定数据的功能，您是否仍会认为请求数据的*域实体*存在问题（我很抱歉，我知道很难回答这样的一般性问题）？

b) 最重要的是，我很难理解*应用程序服务层如何能够预见**域实体*可能需要处理的所有不同类型的数据。

也就是说，不让*应用层服务*单独负责加载数据意味着我们随时更改*域实体*的内部逻辑（例如，现在该*实体* 需要不同类型的数据）也意味着我们必须更改*应用程序服务*因此，他们现在将向*实体*提供新类型的数据而不是旧数据？！

**回复 Eulerfx：**

1)

一个）`The application service can provide not only data, but a mechanism for retrieving data as well, in cases where it is better to place logic for determining the exact instance of data needed in the domain`

因此，如果最好放置逻辑以确定域中所需的确切数据实例，我应该封装对*服务***S**内的*存储库*的访问，然后将**S**作为参数传递给*域实体*的方法？因此，在我们的示例中，我应该封装对内部服务的访问，然后作为参数传递给： ******`OrderRepository``ordersSelectorService``ordersSelectorService``Customer.InterestedWhatOtherCustomerOrdered`******

 ******```
class Customer
{
       public string InterestedWhatOtherCustomerOrdered(OrdersSelectorService ordersSelectorService)
       {
                ...
                var orders = ordersSelectorService.Select...;
                ...
        }
        ...
}

class CustomerService
{
  OrdersSelectorService ordersSelectorService;
  CustomerRepository customerRepository;

  public void ()
  {
        var customer = this.customerRepository.Get...;
                ...

        customer.InterestedWhatOtherCustomerOrdered(ordersSelectorService);
                ...

  }
} 
```

`OrderRepository`b）如果这确实是您的建议，那么除了简单地作为参数传递给之外，还有其他好处（除了您已经提到的那些）`Customer.InterestedWhatOtherCustomerOrdered`：

```
class Customer
{
       public string InterestedWhatOtherCustomerOrdered(CustomerRepository orderRepository)
       {
                ...
                var orders = orderRepository.Select...;
                ...
       }
       ...
} 
```

2）以下问题只是为了确保我完全正确地理解了您的帖子：

`So if a specific behavior requires access to some service, have the application service provide an abstraction of that service as an argument to the corresponding behavior method. This way, the dependency upon the service is explicitly stated in the method signature.`

a）通过“*特定行为*”您指的是*域实体*（即`Customer`）？！

b）我不确定您所说的“*应用服务提供该服务的抽象作为参数*”是什么意思。也许我们不应该提供*服务* **S**本身（即`OrderRepository`）作为方法（即`Customer.InterestedWhatOtherCustomerOrdered`）的参数，而应该让一些*类* **C**（即`OrdersSelectorService`）封装**S**，然后将**C**作为参数传递给方法？

c）我假设**C**（封装**S** <--参见**b）**问题的类）应该始终是*应用程序服务*，并且**S**应该始终由**C**封装（除非**S**已经是*应用程序服务*）？如果是，为什么？

d)

> 这样，对服务的依赖在方法签名中明确说明。

通过*依赖**方法签名*中明确说明的服务，我们可以获得什么好处？只有我们可以立即知道方法在做什么而不需要检查方法的代码？

3) 有点跑题了，但是当我们将行为**B**作为方法**M** ( ) 的参数注入到类**C**中时就会出现这种情况，那么我们不称它为*依赖注入*，而是通过*构造函数*或*设置器将***B**注入到**C**中( )，那么我们称之为*依赖注入*。这是为什么？**`C.M(B b);`*******`B b=new B();C c=new C(b);`*********

 ***********对 Eulerfx 的第二次回复：**

1)

> 1ab) ... 另一种选择是使用 lambda 而不是 OrdersSelectorService。

我假设您的意思是，我们应该在*Customer.InterestedWhatOtherCustomerOrdered*中使用*Linq-to-Entities*（严重依赖*lambda*）而不是传递`OrdersSelectorService`给？但据我所知，这将违反*持久性无知*规则（请参阅我以前的[帖子](https://stackoverflow.com/questions/12715150/does-the-following-code-violate-persistence-ignorance-rule)）`Customer.InterestedWhatOtherCustomerOrdered`

 ***2)

> 2c) 不，C 应该只是一个包含所需方法的接口。服务 S 可以实现该接口，也可以即时提供一个实现。

啊哈，我误以为你在建议**C**应该是*Application service*。无论如何，**C**应该住在哪里？它应该打包在*Application Services 程序集中*还是*域模型程序集中*？

3)

> 2d) ... 在方法签名中声明依赖项而不是类本身的构造函数的好处是...另一个好处是您的域类不需要成为 IoC 容器的依赖关系图的一部分 - 使得事情更简单。

*对IoC*还不太了解，因此我必须问一下，*域类*究竟是如何成为*IoC 依赖图*的一部分的？换句话说，是否必须在*IoC 的配置层*中指定此*域类*（我认为该层仅用于指定依赖项的*接口与依赖项*的实际*实现*之间的映射，因此我假设*依赖类*甚至不是在这一层内提到）或......？

 ***4）我并不是要引起任何麻烦或暗示你们中的一个人是错的（你们俩都已经解释了为什么你喜欢你的设计），但我想确保我完全理解你的帖子。实际上，您的推荐与*nwang0*的建议相反（即，如果你们两个都推荐相同的东西，那么我的理解能力需要一些修复 :o ）？！

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T20:32:28.997

这个想法是你的域模型不应该关心数据来自哪里的细节。您仍然必须决定如何加载该数据，但是您让您的“应用程序服务”（通常）担心它。通过这种方式，他们可以管理数据持久性、缓存、安全性等无数复杂问题，而您的域对象则担心它们的域逻辑。

或者，另一个令人信服的论点是它违反了单一责任原则。现在你的领域对象负责搞清楚它自己的逻辑，以及搞清楚如何请求它的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T22:24:31.547

域对象依赖 Repository 对象并没有错。实际上，Repository 对象属于领域模型，Repository 接口应该与其他领域对象打包在一起。

然而，保持存储库接口抽象并且不耦合到它们的具体实现方式是至关重要的。即你的 OrderRepository 应该有一个语义和使用规范的集合。这篇文章有一些构建/使用存储库的好例子。[http://thinkinginobjects.com/2012/08/26/dont-use-dao-use-repository/](http://thinkinginobjects.com/2012/08/26/dont-use-dao-use-repository/)

另一方面，我认为从上层接收值是一个不太好的解决方案，假设上层是应用服务层。

在您的示例中，您有：

```
var orders = repository.Find...; 
```

在现实生活中，您需要将一些信息传递到存储库以查找相关订单。我在这里举一个例子：

```
var orders = repository.FindByDate(productIdThisCustomerLike); 
```

我假设 productIdThisCustomerLike 是客户的私有字段。

在 Customer 对象中创建 Repository.Find 并传入一些本地信息是很自然的。如果我们选择在应用服务层调用repository.Find，我们需要从客户那里提取产品ID信息。它会破坏封装，因此是一个邪恶的解决方案。

**回复您的评论：**

1.  无需使用服务包装存储库。我认为让域对象依赖于服务对象是一种不好的做法，因为服务层依赖于域模型层，而不是相反。如果您需要对返回的订单列表进行一些后期处理（如过滤、分组或合并），请在您的 Customer 和 OrderRepository 之间引入另一个域对象，并将其命名为域对象，而不是服务。

2.  这取决于您的用例。如果 Customer.InterestedWhatOtherCustomerOrdered 由您的服务层直接调用，则可以从服务层传入 Repository 引用。但是，如果它被另一个域对象（例如 ShoppingCart）调用，相同的方法将强制 ShoppingCart 知道 OrderRepository 只是为了给它 Customer。一般来说，我更喜欢让域对象保留对他们需要的存储库的引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-06T00:44:23.633

域对象请求他们需要的数据并不是不好的做法，但是将存储库依赖项直接注入实体通常被认为是不好的做法。造成这种情况的一个原因是，现在您的域对象成为依赖关系图的一部分，这是一种不必要的复杂性。此外，存储库通常带有环境依赖项，例如事务和工作单元。这增加了复杂性并使关于域逻辑的推理更加困难。

相反，正如 Sebastian Good 所指定的，最好让应用程序服务提供实体所需的数据。应用程序服务是注入存储库和其他[网关](http://martinfowler.com/eaaCatalog/gateway.html)的好地方。应用程序服务不仅可以提供数据，而且还可以提供一种检索数据的机制，以便更好地放置逻辑以确定域中所需的确切数据实例。例如，看看这个[问题](https://stackoverflow.com/questions/12677396/domain-driven-design-services-and-validations/12679271#12679271)。因此，如果特定行为需要访问某些服务，则让应用程序服务提供该服务的抽象作为相应行为方法的参数。这样，对服务的依赖在方法签名中明确说明。

**更新**

1ab) 是的，这是正确的。另一种选择是使用 lambda 而不是`OrdersSelectorService`. 如果 lambda 在您的语言中不可用，那么它应该是一个接口。优于传递的好处`OrderRepository`是基于[接口隔离原则](http://en.wikipedia.org/wiki/Interface_segregation_principle)，其目标是减少不必要的耦合。Customer 上的行为不太可能需要 OrderRepository 上的所有方法，而是需要特定的函数，因此请明确说明。

2a）是的，我所指的行为是`Customer`实体上的行为，这只是类上的方法之一。

2b) 是的，原因见 1ab。

2c) 不，**C**应该只是一个包含所需方法的接口。服务**S**可以实现该接口，也可以即时提供一个实现。

2d) 是的。这是支持依赖注入而不是服务位置的论点的一部分。相对于类本身的构造函数而言，在方法签名中声明依赖关系的一个好处是，该服务通常只需要一个方法，并且使其成为类的成员是一种浪费。另一个好处是您的域类不需要成为 IoC 容器的依赖关系图的一部分 - 使事情变得更简单。

3）我会同时调用依赖注入（DI）。DI 旨在对比服务位置，其中类构造函数或方法将负责通过服务定位器获取所需的服务。

**更新 2**

1) 这是一个 C# 代码示例：

```
// this is is the repository, but it doesn't have to be an interface, just some class encapsulating data access
interface IOrderRepository
{
  Order Get(string id);
  void Add(Order order);
  IEnumerable<Order> GetOrdersBySomeCriteria(SomeCriteria criteria);
}

class Customer
{
   // the selector parameter is a lambda.
   public string InterestedWhatOtherCustomerOrdered(Func<SomeCriteria, IEnumerable<Order>> selector)
   {
      // do stuff with selector lambda
   }
}

// this is the app service
class CustomerApplicationService
{
  readonly IOrderRepository orderRepository;

  public void DoSomething()
  {
     var customer = this.customerRepository.Get ...;

     // the app service passes lambda which in turn points to repository.
     var result = customer.InterestedWhatOtherCustomerOrdered(criteria => this.orderRepository.GetOrdersBySomeCriteria(criteria));

  }
} 
```

这不违反持久性无知并且非常解耦。方法上的 lambda 参数`InterestedWhatOtherCustomerOrdered`准确地指定了该方法需要什么——仅此而已。它并不关心该功能是如何提供的，它就是这样。

2) 在 lamda 的情况下，C 并不真正存在于任何地方，因为它是由 lambda 完整指定的。但是，如果您要使用接口，例如`IOrderSelector`，则需要在存在 Customer 聚合的地方声明该接口。它可以由 直接实现`OrderRepository`，或者您可以拥有一个[适配器](http://en.wikipedia.org/wiki/Adapter_pattern)类。

3) 我提到 IoC 的原因是因为另一种方法是在类的构造函数中声明对顺序选择器的依赖`Customer`。然后，每当创建该类的新实例时，就需要注入该依赖项（顺序选择器）。`Customer`一种方法是在类被实例化的地方使用 IoC 容器。这是有问题的原因是因为现在您必须确保无论您在何处实例化`Customer`该类都可以访问 IoC 容器。这也是责任错位，因为创建客户与订单选择器无关，只有一个行为需要它。

4）我想这是哲学的不同。由于上述原因以及其他原因，我不喜欢让域对象引用存储库。总的来说，如果您浏览 SO 或博客等，通常会不赞成。存储库接口确实在域中声明，但这并不意味着它们应该直接从域实体中引用。************************

# c# - 我正在尝试在 WP7 中从我的数据库中访问一个项目并输出它

> ID：12734002
> 
> 赞同：0
> 
> 时间：2012-10-04T18:58:39.237
> 
> 标签：c#, silverlight, windows-phone-7, sql-server-ce, observablecollection

我为我的应用程序创建了一个数据库，它使用了一个 sdf 数据库。当我查询数据库并将其放入 ObservableCollection 时，我得到了信息，但如何访问其中的元素？有什么帮助吗？

```
var mathItemsInDB = from Math_Info math in mathDB.Math_Information
                            where math.mathID == 0 select math;

        Math_Info_Items = new ObservableCollection<Math_Info>(mathItemsInDB);

        base.OnNavigatedTo(e);
    }

    private void displayProblem()
    {   
        //here i would like to display the mathproblem fetched from the db and not an already created array
        this.MathProblem.Text = mathProblems[problemNumber];    //displays the mathproblem/equation
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T23:22:04.233

我没试过，但是`mathProblems.ElementAt()`？

# java - AWTAutoShutdown 线程停止 VM

> ID：12734005
> 
> 赞同：2
> 
> 时间：2012-10-04T18:58:52.473
> 
> 标签：java, swing

我正在处理一个遗留项目，其中有人使用摆动计时器线程来执行一些服务器调度任务。这段代码不是一个swing应用程序，它是服务器端的java。我知道这不是一个好主意，并且知道可以接受的方法来做同样的事情。问题是，我看到在空载时每隔几分钟就会出现一些长时间的 VM 暂停。启用详细 gc，我确定它不是垃圾收集。当我在其中一个暂停期间执行线程转储时，我会在下面得到这个转储。知道此 AWTAutoShutdown 是否会导致此暂停，或者当它执行如下所示的 activateBlockerThread 时它在做什么？

```
"AWT-Shutdown" prio=10 tid=0x00007fed5802d000 nid=0x2ef1 in Object.wait() [0x00007fed53e5d000]
java.lang.Thread.State: WAITING (on object monitor)
at java.lang.Object.wait(Native Method)
- waiting on <0x000000031e910b90> (a java.lang.Object)
at java.lang.Object.wait(Object.java:485)
at sun.awt.AWTAutoShutdown.run(Unknown Source)
- locked <0x000000031e910b90> (a java.lang.Object)
at java.lang.Thread.run(Unknown Source)

"TimerQueue" daemon prio=10 tid=0x00007fed58597000 nid=0x2a56 in Object.wait() [0x00007fed54737000]
java.lang.Thread.State: BLOCKED (on object monitor)
   at java.lang.Object.wait(Native Method)
   - waiting on <0x000000031e910b90> (a java.lang.Object)
   at java.lang.Object.wait(Object.java:485)
   at sun.awt.AWTAutoShutdown.activateBlockerThread(Unknown Source)
   at sun.awt.AWTAutoShutdown.notifyThreadBusy(Unknown Source)
   - locked <0x000000031e910b90> (a java.lang.Object)
   - locked <0x000000031e9a60c8> (a java.lang.Object)
   at java.awt.EventQueue.postEvent(Unknown Source)
   at java.awt.EventQueue.postEventPrivate(Unknown Source)
   - locked <0x000000031e90eb90> (a java.awt.EventQueue)
   at java.awt.EventQueue.postEvent(Unknown Source)
   at java.awt.EventQueue.invokeLater(Unknown Source)
   at javax.swing.SwingUtilities.invokeLater(Unknown Source)
   at javax.swing.Timer$1.run(Unknown Source)
   at javax.swing.Timer$1.run(Unknown Source)
   at java.security.AccessController.doPrivileged(Native Method)
   at javax.swing.Timer.post(Unknown Source)
   - locked <0x000000031e9af7e0> (a javax.swing.Timer)
   at javax.swing.TimerQueue.postExpiredTimers(Unknown Source)
   - locked <0x000000031e90ce60> (a javax.swing.TimerQueue)
   at javax.swing.TimerQueue.run(Unknown Source)
   - locked <0x000000031e90ce60> (a javax.swing.TimerQueue)
   at java.lang.Thread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:30:01.657

看来您可能遇到了通知问题。TimerQueue 线程应该在 AWT-Shutdown 线程启动后唤醒（AWTAutShutdown.run 方法向监视器发出 AWTAutShutdown.activateBlockerThread 方法正在等待的信号）。如果您的应用程序长时间冻结并且这些线程没有取得进展，那么 TimerQueue 线程似乎没有及时接收到信号。

但是，由于您的应用程序*不是*swing/awt 应用程序，我看不出这会如何影响应用程序中的其他任何内容。

# python - 将 NULL 传递给 Cython 中的包装 C 函数

> ID：12734013
> 
> 赞同：3
> 
> 时间：2012-10-04T18:59:15.330
> 
> 标签：python, cython

我有一个用 Cython 包装的函数：

```
cdef extern  from "myheader.h":
   int c_my_func (const_char *a, const_char* b) 
```

还有一个暴露给 Python 的函数：

```
def my_func(a, b):
    c_my_func(a, b) 
```

该函数`c_my_func`接受 NULL 作为参数`a`和`b`。当我从口译员那里调用它时：

```
my_func(None, None) 
```

它抛出异常：

```
TypeError: expected string or Unicode object, NoneType found 
```

如何让这个函数接受`None`并传递`NULL`给`c_my_func`? 我不想手动检查`None`然后传递NULL。我还尝试在 的 cdef 上使用默认参数，`c_my_func`但它不起作用。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-04T19:16:06.613

您可以在[Cython 常见问题解答](https://github.com/cython/cython/wiki/FAQ#user-content-what-is-the-difference-between-pyobject-and-object)中找到答案。

> `None`与任何 C 类型都不兼容。为了适应这一点，默认行为是具有 cdefed 参数的函数也接受`None`。
> 
> 1.  如果要考虑`None`无效输入，则需要编写代码来检查它，并引发适当的异常。

`None`解决方案是在编写时手动检查并传递 NULL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T19:23:24.923

只需为您的 c 函数调用构建一个包装函数。它适用于任意数量的参数。

```
def c_func_call(c_func, *args):
   c_func(*[x if x is not None else NULL for x in args]) 
```

您的示例中的用法：

```
def my_func(a, b):
    c_func_call(c_my_func, a, b) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-03T18:07:20.037

`not None`像这样使用怎么样

```
def widen_shrubbery(Shrubbery sh not None, extra_width):
    sh.width = sh.width + extra_width 
```

暴露[在这里](http://docs.cython.org/src/userguide/extension_types.html#extension-types-and-none)。

# string - 如何添加到目标 c 中的可变字符串？

> ID：12734015
> 
> 赞同：3
> 
> 时间：2012-10-04T18:59:34.607
> 
> 标签：string, character, add, mutable

在没有深入了解实际程序的细节的情况下，我想获取一个现有的字符串并向其添加更多字符（或字符串）。如果这是在java中完成的，它会是这样的

字符串 x=“你好”

x= x + "世界";

我目前有我的字符串试图这样做。我声明的字符串被称为_whatiscorrect，它现在是一个空字符串，在这个例子中，我想获取现有的字符串并添加一个“o”。

_whatiscorrect = [_whatiscorrect stringByAppendingString:@"o"]; // 在字符串中放置一个 o

我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:32:32.017

你有正确的想法。只需这样做：

```
NSMutableString * _whatiscorrect = [[NSMutableString alloc] initWithString: @".."];
[_whatiscorrect appendString:@"o"]; 
```

# java - 使用 JMeter 测试 JSF 应用程序 - ViewState 问题

> ID：12734017
> 
> 赞同：13
> 
> 时间：2012-10-04T18:59:44.073
> 
> 标签：java, jsf, viewstate, jmeter, load-testing

我整天都在尝试对我的 JSF 应用程序运行 JMeter 测试。我知道`ViewState`，但这似乎是一个非常简单的问题。我准备了正则表达式提取器：

```
Reference Name: jsfViewState
Regular expression: id=\"javax.faces.ViewState\" value=\"(.+?)\"
Template $1$
Match No. 1 
```

![常规 Exp 提取器](../Images/8777ab1dd34d773bc1f2803be9c6cfaa.png)

以下采样器是使用代理和录制创建的。

第一个请求`/TourJSF/pages/protected/admin/addTourPage.xhtml`。这是`GET`将从中提取 ViewState 的请求。

![第一个 GET](../Images/79e751e721a659ff70b8c7e624e36368.png)

`POST`请求在`/TourJSF/pages/protected/admin/addTourPage.xhtml`哪里。`${jsfViewStete}`被传入`javax.faces.ViewState`

![jsfViewState 已通过](../Images/2e90d363a3033227b14af5b01129cfe6.png)

第二个`GET`请求，现在在这种情况下非常重要。

![第二次获取](../Images/31c18028de675def07b731275da8d3f4.png)

结果：

首先`GET`。在右边我们可以看到 ViewState 的值。

![第一个 GET 结果](../Images/57205aeeed45baf733f41795b476d9b8.png)

`Debug Sampler`这表明 jsfViewState 值是正确的。我们可以将其与之前的屏幕进行比较。

![调试采样器](../Images/88a7414c6bc791bd73bdd881973bf560.png)

```
javax.faces.application.ViewExpiredException: viewId:/pages/protected/admin/addTourPage.xhtml - View /pages/protected/admin/addTourPage.xhtml could not be restored. 
```

![ViewExpiredException addTourPage.xhtml 无法恢复](../Images/e2a415ff031aa74975ff28a71f3ed712.png)

我发现了一些关于这个问题的博客和主题，但其中许多都没有解决。如果需要，我可以放置这些主题的链接。我真的很困惑……

问题出在哪里？也许有什么

*   `jsessionid`?
*   `HTTP Header Manager`在每个`HTTP Request`？我删除`HTTP Header Manager`了，但没有任何改变。
*   JSF应用程序的东西？当我将 context-param 添加`com.sun.faces.enableRestoreView11Compatibility`到`web.xml`中时，没有`ViewExpiredException`但返回页面的内容不正确。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-04T19:30:20.657

你不是缺少一个 Cookie 管理器吗？

看：

*   [http://jmeter.apache.org/usermanual/component_reference.html#HTTP_Cookie_Manager](http://jmeter.apache.org/usermanual/component_reference.html#HTTP_Cookie_Manager)

另请阅读：

*   [http://wiki.apache.org/myfaces/PerformanceTestingWithJMeter](http://wiki.apache.org/myfaces/PerformanceTestingWithJMeter)

# php - php日期和mysql时间戳比较

> ID：12734020
> 
> 赞同：1
> 
> 时间：2012-10-04T18:59:49.737
> 
> 标签：php, mysql

当我从 php 获得的只是日期时，如何从使用时间戳的 db 字段中进行选择？

```
$date = 2012-10-03; 
```

就像是：

```
"select value from table where completed_date = $date" 
```

只有 completed_date 的值实际上类似于 "2012-10-03 02:16:10" 我真正想要的是与 $date 同一天的所有值，并且查询几乎忽略时间戳的时间方面对于这个查询。那可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:32:03.867

鉴于您提供的日期已经是有效的 mysql 日期戳，它可以很简单：

```
SELECT ... WHERE DATE(completed_date)='2012-10-03' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T19:02:08.317

你需要尝试这样的事情，

```
"select value from table where completed_date like '$date%'" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T19:01:53.983

使用 DATE_FORMAT 格式化 mysql 日期：

```
"select value from table where DATE_FORMAT(completed_date,'%Y-%m-%d') = $date" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T19:02:42.327

如果您的数据库字段是 Unix 时间戳，您将[在此处](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_from-unixtime)`FROM_UNIXTIME`使用详细信息。

如果您的数据库字段 ( `col`) 是`datetime`类型，您将`SELECT ... WHERE col LIKE '2012-10-03%'`.

如果您的数据库字段 ( `col`) 是`date`类型，您将`SELECT ... WHERE col = '2012-10-03'`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-04T19:04:14.513

如果`completed_date`是时间戳字段，而不是 varchar，那么您可以执行以下操作：

```
"SELECT value FROM table WHERE completed_date>=? AND completed_date<?" 
```

并在参数中绑定：

```
$date="2012-10-03";
$start=date("Y-m-d G:i:s",strtotime($date));
$end =date("Y-m-d G:i:s",strtotime($date.' +1day')); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-04T19:09:44.560

我喜欢 coder1984 的答案，因为它不需要更改架构。但是，如果这是您通常要查询数据的方式，我建议您在数据库中添加一个日期字段。

# salesforce - 如何使用 Salesforce API 获取对象的“真实”LastModifiedDate

> ID：12734021
> 
> 赞同：0
> 
> 时间：2012-10-04T18:59:49.897
> 
> 标签：salesforce, apex-code, last-modified, force.com

我在 Salesforce 中有一个自定义对象，用户经常在 Salesforce 在线环境中访问和编辑该对象。让我们称它们为**RootObjects**以保持简单。

我正在尝试使用 Salesforce API检索**RootObjects的“LastModifiedDate”。**目标是确定用户上次编辑它们的时间，但是，我遇到了障碍。

这些对象与其他自定义对象具有查找关系。让我们调用这些**LinkedObjects**。当我使用 Salesforce API 插入**LinkedObject**时，它似乎会影响**RootObjects**的 LastModifiedDate ，即使我没有直接编辑它们**RootObject**。

这导致了一个问题，即我无法确定用户上次编辑某些内容的时间与插入新的相关对象的时间。

是否有另一个我可以使用的仅报告“真实”上次修改日期的系统字段？此时，我正在考虑创建一个自定义日期字段，该字段在保存对象时使用触发器进行更新，但是，如有必要，我想避免这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T15:15:23.210

正如许多评论者所怀疑的那样，有一个工作流程正在修改对象。我将使用将更新自定义日期/时间字段的“保存”工作流程。感谢所有的建议！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-04T21:17:24.220

尝试使用 ModifiedById 字段。

# regex - 如何验证字符串是否也在shell脚本中以空格开头和结尾？

> ID：12734027
> 
> 赞同：3
> 
> 时间：2012-10-04T19:00:22.403
> 
> 标签：regex, linux, bash, shell

如何验证字符串是否也以一个或多个空格开头和结尾？

```
if [[ $username =~ [^0-9A-Za-z]+ ]] 
```

（基本上输入应该是字母数字，任何地方都没有空格，即使在开头或结尾，也没有逗号、下划线、连字符等）

不幸的是，上面的正则表达式不匹配前导空格和尾随空格，但它匹配中间的空格？

如果没有 awk，sed，有什么方法可以修复上述正则表达式以匹配前导和尾随空格？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T22:15:21.763

引用 Bash 正则表达式可能会很棘手：不得引用正则表达式元字符，但是，由于空格在 shell 中很重要，因此必须引用空格。此正则表达式匹配以空格开头和结尾的字符串：

```
[[ $s =~ ^" ".*" "$ ]] && echo y 
```

要测试字符串是否包含空格，请执行以下操作之一：

```
[[ $s =~ [[:space:]] ]] && echo y
[[ $s == *" "* ]] && echo y 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T19:30:04.787

这应该有效：

```
if [[ $username =~ "^ [^0-9A-Za-z]+ $" ]] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T19:34:02.967

> （基本上输入应该是字母数字，任何地方都没有空格，即使在开头或结尾，也没有逗号、下划线、连字符等）

呃，除非我错过了什么……

```
if ! [[ $username =~ ^[0-9a-zA-Z]+$ ]] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-05T18:05:37.667

谢谢@Glenn`if [[ $username =~ [^0-9A-Za-z]+ ]]`这是我原来的正则表达式，我希望用户只输入字母数字（不应接受所有其他字符，包括空格、下划线等）。我在无限while循环中使用读取并仅在有效输入时终止。

正则表达式匹配所有非字母数字，甚至与预期之间有空格的字符串，但它不匹配带有前导和尾随空格的条目（我认为是这样）。

然后我意识到它不是正则表达式，而是自动修剪前导和尾随空格的“读取”命令，所以当涉及到正则表达式时，变量本身已被修剪。

**“解决这个问题的诀窍是重新定义您的 IFS（内部字段分隔符）变量。默认情况下，IFS 设置为空格、制表符和换行符来分隔读取命令的单词。”** 从这个博客得到这个

[http://fahdshariff.blogspot.in/2008/06/read-file-without-trimming-leading.html](http://fahdshariff.blogspot.in/2008/06/read-file-without-trimming-leading.html)，我已经相应地修复了我的脚本。

感谢您跟进并解释详细信息！

# css - 流体布局。2列。当浏览器窗口变窄时，使一个在另一个之前变窄

> ID：12734030
> 
> 赞同：0
> 
> 时间：2012-10-04T19:00:30.380
> 
> 标签：css, layout, user-agent, fluid-layout, two-columns

考虑以下布局：

有 2 列具有它们的`min-width`和`max-width`设置（每列不同）。当用户代理变窄时，右列开始变窄，而左列保持初始宽度。在右列位于其 之后`min-width`，左列开始变得更窄，直到它也位于其`min-width`。

是否可以仅使用 CSS 来实现此效果？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:09:41.143

[如果您使用媒体查询](http://www.w3.org/TR/css3-mediaqueries/)，这将是可能的。

在基本样式的左列上放置一个静态宽度。然后在某个屏幕宽度处激活的媒体查询中，例如：`@media all and (max-device-width: 460px), (max-width: 460px)`，给它一个更小的`min-width`.

“特定屏幕宽度”应该是您的右列达到其最小宽度的屏幕宽度。

此处示例：http: [//jsbin.com/ivodam/1/edit](http://jsbin.com/ivodam/1/edit)

# wcf - 没有 .svc 扩展名的 WCF 终结点地址

> ID：12734031
> 
> 赞同：2
> 
> 时间：2012-10-04T19:00:38.350
> 
> 标签：wcf, configuration, iis-7.5

我已经启动并运行了 WCF 服务，但今天我想如果我从真实地址中删除 .svc 扩展名并以这种方式访问​​我的服务会怎样？net.tcp://serveraddress/services/service 我但是一旦我更改了配置文件程序就没有启动。此程序和服务是使用 .NET 4.0 开发的，WCF 4 广告服务本身托管在 IIS 7.5 中

是否可以在将服务托管在 IIS 中时以这种方式访问​​服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:12:38.697

这可能是 IIS 中的处理程序的问题。我还使用无扩展的 WCF 服务，并修改了我的 web.config 文件以使其工作。将此添加到您的 web.config 以查看它是否有帮助：

```
<system.webServer>
<modules runAllManagedModulesForAllRequests="true">
  <remove name="UrlRoutingModule" />
  <add name="UrlRoutingModule" type="System.Web.Routing.UrlRoutingModule, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
</modules>

<handlers> 
<remove name="svc-Integrated-4.0" />
<add name="svc-Integrated-4.0" path="*" verb="*" type="System.ServiceModel.Activation.ServiceHttpHandlerFactory, System.ServiceModel.Activation, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" resourceType="Unspecified" requireAccess="Script" preCondition="integratedMode,runtimeVersionv4.0" />
      <add 
        name="UrlRoutingHandler" 
        preCondition="integratedMode" 
        verb="*" path="UrlRouting.axd" 
        type="System.Web.HttpForbiddenHandler, System.Web,  
          Version=2.0.0.0, Culture=neutral,  
          PublicKeyToken=b03f5f7f11d50a3a"/> 
    </handlers> 
</system.webServer> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-01T10:21:43.743

我已经托管了没有 svc 文件的 WCF 服务。我在 Global.asax 文件的 Application_Start 方法中将 ServiceRoute 添加到 RouteTable。

```
protected void Application_Start(object sender, EventArgs e)
{
    RouteTable.Routes.Add(new ServiceRoute("AdminDataService", new WebServiceHostFactory(), typeof(AdminService)));
    RouteTable.Routes.Add(new ServiceRoute("AuthenticationService", new WebServiceHostFactory(), typeof(AuthenticationService)));
} 
```

# iphone - iOS：UIScroll View - 防止在视图触摸时滚动

> ID：12734034
> 
> 赞同：0
> 
> 时间：2012-10-04T19:00:51.880
> 
> 标签：iphone, ios, uiview, uiscrollview, event-handling

我正在尝试响应对 UIScrollView 中视图的触摸。我设法通过子类化 UIScrollView 将标准触摸转发到我的子视图，但是如果我按下视图，然后滚动，然后松开，则不会调用“touchesEnded”方法，因此视图仍然突出显示。

我想纠正这种行为。

我试图遵循本指南以防止在点击视图时滚动：

[http://www.musicalgeometry.com/?p=1404](http://www.musicalgeometry.com/?p=1404)

一个步骤涉及将 CGRect 属性设置为视图的框架。当我尝试这样做时，它说我的子视图的框架是（0,0,0,0）。这是在 -viewDidLoad 中，所以到那时应该已经加载了视图。

-viewDidLoad：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    [scrollView setScrollEnabled:YES];
    [scrollView setDelaysContentTouches:NO];

    //Here I attempt to get the frame of my subview, but it gives me
    //(0,0,0,0)
    scrollView.subViewRect=locPhoneView.frame;

    locImageView.image=locImage;
    locNameLabel.text=locName;
    locAddressLabel.text=locAddress;
    locPhoneLabel.text=locPhone;
    monHoursLabel.text=[NSString stringWithFormat:@"Mon:     %@",[locHours objectAtIndex:0]];
    tueHoursLabel.text=[NSString stringWithFormat:@"Tue:      %@",[locHours objectAtIndex:1]];
    wedHoursLabel.text=[NSString stringWithFormat:@"Wed:     %@",[locHours objectAtIndex:2]];
    thuHoursLabel.text=[NSString stringWithFormat:@"Thu:      %@",[locHours objectAtIndex:3]];
    friHoursLabel.text=[NSString stringWithFormat:@"Fri:        %@",[locHours objectAtIndex:4]];
    satHoursLabel.text=[NSString stringWithFormat:@"Sat:       %@",[locHours objectAtIndex:5]];
    sunHoursLabel.text=[NSString stringWithFormat:@"Sun:      %@",[locHours objectAtIndex:6]];
    closedSundayLabel.text=[locHours objectAtIndex:7];
} 
```

这是我的“接触”方法。

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
    UITouch *touch = [touches anyObject];
    if(touch.view==locPhoneView){
        locPhoneView.backgroundColor=[ColorUtility colorWithHexString:@"83d3f0"];
    }
    if(touch.view==locAddressView){
        locAddressView.backgroundColor=[ColorUtility colorWithHexString:@"83d3f0"];
    }
}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event{
    UITouch *touch = [touches anyObject];
    if(touch.view==locPhoneView){
        locPhoneView.backgroundColor=[UIColor whiteColor];
    }
    if(touch.view==locAddressView){
        locAddressView.backgroundColor=[UIColor whiteColor];
    }

}
- (void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event{

}
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event{

} 
```

所以我想我正在寻找两个可能的答案：

1.  如何让 locPhoneView.frame 给我正确的尺寸？

2.  如果做不到这一点，有没有办法确保调用“touchesEnded”方法，即使在触摸的开始和结束之间有滚动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:41:50.583

我不确定你的问题到底是什么，但看起来像 scrollViewDidScroll: 或 scrollViewDidEndDragging: 或 scrollViewDidEndDecelerating: 这样的 ScrollView 代表可能会对你有所帮助。请参阅[响应滚动和拖动](http://developer.apple.com/library/ios/#Documentation/UIKit/Reference/UIScrollViewDelegate_Protocol/Reference/UIScrollViewDelegate.html)。

基本上要处理滚动视图内的触摸，您需要将触摸重定向到下一个响应者，即您的视图控制器。

# c# - .net c# asp.net 使部分文本框文本加粗

> ID：12734039
> 
> 赞同：2
> 
> 时间：2012-10-04T19:01:32.147
> 
> 标签：c#, javascript, asp.net, .net

我有一个 .NET C#/Aspx Web 应用程序，用户在其中填写字段并将生成的表单通过电子邮件发送出去。我要求允许用户突出显示文本，然后将该文本设为粗体或彩色或两者兼而有之。

我在网上做了一些搜索，发现 javascript 可能是最好的选择。但是，当脚本插入 html 标记时 - 它不会在文本框中呈现。我知道这是 asp.net 文本框的限制，但无论如何都存在这个问题？

```
<script type="text/javascript"> 

function formatText(tag) {
    var selectedText = document.selection.createRange().text;

    if (selectedText != "") {
        var newText = "<" + tag + ">" + selectedText + "</" + tag + ">";
        document.selection.createRange().text = newText;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-04T19:03:34.543

您需要像[ckeditor](http://ckeditor.com/)这样的富文本编辑器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T19:08:50.567

而是重新发明轮子，看看富文本编辑器，例如[TinyMCE](http://www.tinymce.com/)，您可以将其剥离，因此用户只有粗体或斜体等选项。

可以在此处找到如何创建简单示例的更多信息：

[创建一个非常简单的 TinyMCE 所见即所得编辑器](http://www.tinymce.com/wiki.php/%22For_Dummies%22)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-05T04:36:17.877

无法在 Textbox.Go 中完成任何 RichTextEditor。（CKEDITOR 或 CLEEDITOR）

# javascript - 在“生效日期”一年后设置输入文本字段“到期日期”

> ID：12734041
> 
> 赞同：0
> 
> 时间：2012-10-04T19:01:39.060
> 
> 标签：javascript, jquery

我有两个输入文本字段，一个“生效日期”和一个“到期日期”。我使用 jquerytool 的 dateinput 函数作为日期选择器。

问题：选择“生效日期”时，我希望“到期日期”为“生效日期”一年后，并将该值设置为“到期日期”文本输入字段。

我似乎无法让这一切正常工作......

```
<script>

$(document).ready(function() {

  $(":date").dateinput({
    format: 'mmmm dd, yyyy', // the format for example: 'October 04, 2012'
  });

function expiration (){
  // date calculations here?...
  ...
  document.getElementById('expiration').value = expirationDate;

}
</script>

<input type="date" name="effective" id="effective" onChange="expiration()" />

<input type="date" name="expiration" id="expiration" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:29:15.840

```
<script>

function expiration (){
  // date calculations here...
  var effectiveDate = document.getElementById('effective').value;

  var expirationDate = new Date(effectiveDate);

  expirationDate.setDate(expirationDate.getDate()+365);

  document.getElementById('expiration').value = expirationDate;

}
</script> 
```

# ruby-on-rails - 如何使用 PayPal 向商家请求和发送付款（自适应付款？）

> ID：12734043
> 
> 赞同：2
> 
> 时间：2012-10-04T19:01:42.297
> 
> 标签：ruby-on-rails, paypal, payment, activemerchant, paypal-adaptive-payments

我们有一个使用 Rails 开发的网站（我们使用 Active Merchant 从用户那里收款）。

现在我们有了一个新要求：允许我们的用户向我们索取钱款，并让我们通过 PayPal 自动向他们汇款。

当然，我们会实现一些业务逻辑来确保只允许某些用户这样做。

但是界面应该很简单。登录用户输入 PayPal 帐户电子邮件地址和他希望我们提供的金额（包括货币）。然后我们将通过 PayPal 将钱汇给他。

我们不需要验证用户输入的电子邮件地址是否与现有的 PayPal 帐户相关联，因为系统会提示接收电子邮件的人创建一个帐户以通过 PayPal 收款。

我看过 PayPal Adaptive Payment 和 Mass Payment。我们的要求非常简单，我们不需要向多个收件人汇款、链式支付等功能。

我们的主要要求是自动完成。换句话说，我们不希望每次有人向我们索款时都必须手动输入我们的 PayPal 帐户密码。这可能吗？

哪个 PayPal API 最适合我们的要求？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T23:19:51.940

我真的认为 Mass Pay 是你最好的选择。它将允许您自动汇款并减少您支付的费用金额（费用是汇款金额的百分比，但每位收款人的上限为 1 美元）。

自适应支付将是另一种解决方案，但费用更高。

# wordpress - /wp-admin/ 工作，但由于 .htaccess 设置混乱，没有其他永久链接工作

> ID：12734047
> 
> 赞同：0
> 
> 时间：2012-10-04T19:01:46.917
> 
> 标签：wordpress, apache, .htaccess, permalinks

我需要将主页重定向到 index.html 和 /business 到 /business/index.html 所以我修改了默认情况下由 WordPress 编写的重写规则：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.html$ - [L]
RewriteRule ^business/ - [L]
RewriteRule ^index\.php$ - [L]
RewriteRule ^$ /index.html [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress 
```

如果我删除我的规则永久链接再次工作，但我真的需要这些规则... /wp-admin 仍然可以正常工作。

有人有想法么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:13:38.490

为什么要搞乱`.htaccess`重写规则？

您可以在默认的 wordpress`php`页面上简单地使用它：

```
Header('Location: index.html'); 
```

# javascript - 美国的javascript时区脚本如何进行夏令时

> ID：12734048
> 
> 赞同：1
> 
> 时间：2012-10-04T19:01:46.730
> 
> 标签：javascript, time, timezone-offset

我有一个工作脚本，我将它推送到我们组织中每个人的 IE 收藏夹列表（见下文）。根据办公室在公司的地理位置，它们会被路由到 4 个 URL 中的 1 个。

```
<html>
<body>

<script language="JavaScript">
var today = new Date();
var offset = (today.getTimezoneOffset() / 60) + 1;
if (offset == 5) document.location.href = "url=EASTERNtime.com";
else if (offset == 6) document.location.href = "url=CENTRALtime.com";
else if (offset == 7) document.location.href = "url=MOUNTAINtime.com";
else if (offset == 8) document.location.href = "url=pacifictime.com";
else document.location.href = "url=pickyourowntimezone.com";

</script>
</body>
</html> 
```

我想知道夏令时将如何影响我的剧本，因为我知道我们在亚利桑那州设有办事处，但他们不认识它。我需要对我的脚本进行哪些更改以确保人们仍然被正确路由？我在想类似的东西..

如果日期在 3 月 11 日和 11 月 4 日之间，则运行此...如果不是...运行此...

那有意义吗？还是我什至需要担心这一点，当他们的时钟改变或不改变时，一切都会自行解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:13:50.260

我的日期扩展具有识别 DST 的方法：

[http://depressedpress.com/javascript-extensions/dp_dateextensions/](http://depressedpress.com/javascript-extensions/dp_dateextensions/)

如果日期在本地 DST 范围内，*dateinstance* .isDST() 方法将返回“true”，否则返回“false”。

但总体思路既简单又令人毛骨悚然（因为这实际上只是一个愚蠢的猜测）。基本上在使用 DST（或类似方案）以及定义任何开始和结束日期的任何地方，1 月 1 日之间的时区偏移将与 7 月 1 日不同。添加一些代码以纪念南半球让每个人都倒退和错误的事实（我的孩子！）一个简单的函数来确定任何特定日期（以及在我的扩展中使用的那个）是：

```
 // isDST 
        // Returns "true" if the date appears to fall within the local area's Daylight Saving Time (or similar scheme), returns false if the date does not (or it appears that the region doesn't observe DST).
Date.prototype.isDST = function() { 

        // Generate test dates
    var Jan1 = new Date(this.getFullYear(), 0);
    var Jul1 = new Date(this.getFullYear(), 6);

        // DST in the Northern hemisphere is "fall back"
    if ( Jan1.getTimezoneOffset() > Jul1.getTimezoneOffset() && this.getTimezoneOffset() != Jan1.getTimezoneOffset() ){
        return true;
    };
        // DST in Southern hemisphere is "leap ahead"
    if ( Jan1.getTimezoneOffset() < Jul1.getTimezoneOffset() && this.getTimezoneOffset() != Jul1.getTimezoneOffset()){
        return true;
    };
        // We're not in DST 
    return false;
}; 
```

使用 TZ 数据库的解决方案更健壮，因为它们可以确定正在使用哪个时区 - 但在确定时间是否在 DST 时通常同样无能为力（因为开始和结束时间的规则通常在不断变化）。

对于您的需要，我认为上面的代码应该可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:10:35.873

[http://www.pageloom.com/automatic-timezone-detection-with-javascript](http://www.pageloom.com/automatic-timezone-detection-with-javascript)上有一个非常强大的时区检测脚本。未缩小的代码可在[https://bitbucket.org/pellepim/jstimezonedetect/src/e265c8eddec7/detect_timezone.js](https://bitbucket.org/pellepim/jstimezonedetect/src/e265c8eddec7/detect_timezone.js)获得。

# mysql - 将不同格式的字符串转换为日期

> ID：12734054
> 
> 赞同：3
> 
> 时间：2012-10-04T19:02:08.363
> 
> 标签：mysql, sql, date-conversion

我有一个带有字符串列（*varchar(200)*）的表，其中包含不同格式的日期。例如

```
may 24 1983 12:00AM
1981-01-13 00:00:00
1979-01-13 00:00:00:123 
```

我想将此列转换为日期以提取年份。我该怎么办？我使用了 STR_TO_DATE 但效果不佳。我必须为每种不同的格式使用 SUBSTRING 吗？

MySQL 版本 5.0.95

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T20:03:33.827

[在手册页](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)上有一个检测有效日期的技巧。您可以使用它来确定`STR_TO_DATE`格式是否有效。

```
select foo,
    case when length(date(str_to_date(foo,"%Y-%m-%d %H:%i:%S"))) is not null then str_to_date(foo,"%Y-%m-%d %H:%i:%S")
        when length(date(str_to_date(foo,"%b %d %Y %h:%i%p"))) is not null then str_to_date(foo,"%b %d %Y %h:%i%p")
    end as newdate
from my_table 
```

为您期望的每个人提供一种格式。疯狂地测试。

祝你好运。

（哦，恭喜您尝试清理错误的架构！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:51:09.303

我会尝试使用服务器端语言（可能是 PHP）来执行此操作，并使用它`strotime`来生成漂亮的日期。

否则，我看到的唯一其他选择是开始编写`CASE`s 以读取可能的格式，并使用`DATE_FORMAT`. 也许是这样的：

*伪代码*（案例 may 24 1983 12:00AM）

```
CASE
    WHEN col (after first space is some digit) 
        AND (after second space is 4 digits)
        AND (after third space has 'AM' or 'PM')
    THEN
        DATE_FORMAT(col, '%....') 
```

您也可以尝试使用`REGEXP`to 进行模式匹配。

# linqpad - LinqPad“编辑数据”功能不适用于单行结果

> ID：12734055
> 
> 赞同：1
> 
> 时间：2012-10-04T19:02:08.667
> 
> 标签：linqpad

在编辑多于一行的值时，DataGrid 的“编辑数据”功能可以正常工作。在这种情况下，结果会显示在表格中，并且可以编辑每一行的单元格。但是，如果导航（通过超链接）到只有一行的表，则视图会从表变为更多的属性表视图，只有两列：属性和值。在这种模式下，唯一允许编辑的是布尔字段（显示为复选框）和字符串。所有其他数值都给出以下错误：

“System.String”类型的对象不能转换为“System.Int32”类型（或“System.Double”等）。

这只是测试版的一个缺点还是我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T08:55:44.260

这是一个错误，刚刚在[最新的 beta](http://www.linqpad.net/beta.aspx)中修复。

# asp.net-mvc-3 - 使用自定义 MemberShipProvider 发布到 IIS7 会出现错误

> ID：12734062
> 
> 赞同：0
> 
> 时间：2012-10-04T19:02:39.647
> 
> 标签：asp.net-mvc-3, iis-7, web-config, asp.net-membership

我已经用 MVC3、.Net 4.0 建立了一个网站，我正试图让它在我的测试服务器上工作。服务器是win2008 r2的默认安装。

在测试和调试（使用 ASP.Net 开发服务器）时，该站点运行良好。当我将站点发布到我的服务器时，站点工作正常，直到我在登录表单上按提交。我得到的错误在下面找到。

配置错误

说明：处理服务此请求所需的配置文件期间发生错误。请查看下面的具体错误详细信息并适当地修改您的配置文件。

```
Parser Error Message: Schema specified is not valid. Errors: 
(0,0) : warning 0005: Could not find schema information for the attribute 'Namespace'.
(0,0) : warning 0005: Could not find schema information for the attribute 'Provider'.
(0,0) : warning 0005: Could not find schema information for the attribute 'ProviderManifestToken'.
(0,0) : warning 0005: Could not find schema information for the attribute 'Alias'.
(0,0) : error 0010: The element Schema in namespace http:// schemas.microsoft.com/ado/2009/11/edm/ssdl was unexpected for the root element. The expected Schema in one of the following namespaces: http:// schemas.microsoft.com/ado/2006/04/edm/ssdl, http:// schemas.microsoft.com/ado/2009/02/edm/ssdl. 
```

源错误：

```
Line 36:       <providers>
Line 37:         <clear/>
Line 38:         <add name="CovleUserProvider" type="FileUpload.Models.CovleMembershipProvider" connectionStringName="UserInfo" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" applicationName="/"/>
Line 39:       </providers>
Line 40:     </membership> 
```

源文件：C:\inetpub\wwwroot\web.config 行：38

一些附带信息：成员资格提供者的名称和命名空间是正确的（它在开发机器上工作），成员资格提供者是 Web 项目的一部分，但它引用了来自其他项目的 dll。所有参考资料都在 bin 文件夹中。

我尝试过的：信任级别已满。我不应该在 web.config 中引用我自己的程序集（据我可以从在线资源中得知）

谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:49:27.537

你的好像`aspnet_SchemaVersions`是空的，这是它应该是什么样子的截图

![在此处输入图像描述](../Images/8c965aebfc6768b2028d460d507d35bf.png)

PS这个问题也可以帮助你[ASP.NET Membership Error](https://stackoverflow.com/questions/916787/asp-net-membership-error)

# c# - 调用弹出窗口的`.ShowDialog()`时WPF应用程序关闭

> ID：12734066
> 
> 赞同：2
> 
> 时间：2012-10-04T19:02:44.677
> 
> 标签：c#, wpf

首先我想解释一下我要做什么：我正在开发一个学习应用程序来向学生展示一些卡片。我的`CardPack`课程是一组卡片。

为了获得卡包的许可，我想从用户那里获取一个 ID，然后我创建了一个窗口来从用户那里获取 RegisterKey。这是我的`GetRegisterKey("CardPackName")`方法：

```
 public static string GetRegisterKey(string name)
    {
        GetRegisterKey grk = new GetRegisterKey(name);
        grk.ShowDialog();
        return grk.Key;
    } 
```

但是`grk.ShowDialog();`运行程序后会退出，我不知道为什么！**有人可以帮我解决这个问题吗？！？**

* * *

**更新**

我试图创建一个新的`GetRegisterKey`in`Windows_loaded`事件实例，`MainWindows`我打电话给`grk.ShowDialog()`它，它工作正常，程序没有关闭。我不知道我的问题的根源是什么！

但我发现问题不是`GetRegisterKey`从那时起我会从问题中删除它的代码。

**更新2**

我在行中设置了一个断点`return grk.Key;`来检查它是否运行但它没有运行并且程序关闭了！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-04T19:24:20.417

请参阅 Application.ShutDownMode，

[http://msdn.microsoft.com/en-us/library/system.windows.application.shutdownmode.aspx](http://msdn.microsoft.com/en-us/library/system.windows.application.shutdownmode.aspx)

只有当应用程序的 Shutdown 方法被调用时，应用程序才会停止运行。关闭可以隐式或显式发生，由 ShutdownMode 属性的值指定。

如果将 ShutdownMode 设置为 OnLastWindowClose，Windows Presentation Foundation (WPF) 会在应用程序中的最后一个窗口关闭时隐式调用 Shutdown，即使当前实例化的任何窗口都设置为主窗口（请参阅 MainWindow）。

OnMainWindowClose 的 ShutdownMode 会导致 Windows Presentation Foundation (WPF) 在 MainWindow 关闭时隐式调用 Shutdown，即使当前打开了其他窗口也是如此。

某些应用程序的生命周期可能不依赖于主窗口或最后一个窗口何时关闭，或者可能根本不依赖于窗口。对于这些场景，您需要将 ShutdownMode 属性设置为 OnExplicitShutdown，这需要显式调用 Shutdown 方法来停止应用程序。否则，应用程序将继续在后台运行。

ShutdownMode 可以从 XAML 以声明方式配置，也可以从代码以编程方式配置。

此属性仅在创建 Application 对象的线程中可用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T05:03:28.057

您可以订阅 App.xaml.cs 中的以下事件以进行调试吗？它将帮助您检查堆栈跟踪并查找是否有任何未处理的异常导致此问题。

```
 public partial class App : Application
{
    public App()
    {
        this.DispatcherUnhandledException += new DispatcherUnhandledExceptionEventHandler(App_DispatcherUnhandledException);
        this.Exit += new ExitEventHandler(App_Exit);
    }

    void App_Exit(object sender, ExitEventArgs e)
    {
        //Check stack trace.
    }

    void App_DispatcherUnhandledException(object sender, DispatcherUnhandledExceptionEventArgs e)
    {
        //Check if this event handler get executed and from where control is coming to this method.
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T17:02:14.913

我不知道你是怎么打开`GetRegistryKey`窗户的，但这是我的想法。您可以`StartupUri="MainWindow.xaml"`从`App.xaml`文件中设置，也可以通过编写自己的 Main 方法并调用来禁用它`application.Run(new MainWindow())`。但是，无论哪种情况，您都会`MainWindow`打开并阻止您的注册表窗口。

所以，我猜你在上课`GetRegistryKey`之前以某种方式创建了你的窗口`MainWindow`。据我所知，应用程序声称第一个创建的窗口是它的主窗口。因此，您需要`Application.Current.MainWindow`在关闭之前进行设置。

# ruby-on-rails-3 - 在 Rails 中管理大型多语言文本块

> ID：12734072
> 
> 赞同：1
> 
> 时间：2012-10-04T19:02:57.740
> 
> 标签：ruby-on-rails-3, internationalization, content-management

在我的 Rails 应用程序中，我有许多页面，其中主要包含一些带有静态内容的段落。该应用程序也是多语言的。所以我尝试了默认方法：使用 i18n yml 文件，但是文本字符串太长，维护它们太麻烦。

所以现在我只是为每种语言创建了单独的视图。但是有些页面的结构变得稍微复杂一些，因此将结构复制到每个特定语言的视图文件中并不是一个好主意。

我查看了舒适的墨西哥沙发，但似乎迫使我朝着与当前解决方案相同的方向前进：将结构复制到页面的每个翻译变体。问题似乎是它并不是真正设计用于包含一些红宝石的页面。

总结一下，似乎我最好使用一种解决方案，它可以让我更好地管理我的 i18n yml 文件。也许可以在一页中查看一个视图的所有翻译，让我更轻松地编辑文本块。有这样的解决方案吗？或者您会建议其他类型的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-06T07:53:28.470

Have you looked at [http://www.localeapp.com](http://www.localeapp.com) ?

Disclaimer : I co-founded Locale.

# regex - 需要扩展正则表达式以支持“{}”

> ID：12734074
> 
> 赞同：1
> 
> 时间：2012-10-04T19:02:57.947
> 
> 标签：regex

我有以下正则表达式：

```
({(?!d})(?!{)(?<!{{)[^}]+}) 
```

它在花括号“{}”内匹配任何数字/字符串，我需要将其扩展为也匹配两个花括号之间的不匹配字符串/空格，如下所示

```
 {} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:07:16.293

你不只是将+（一个或多个）更改为*（零个或多个）吗？

`({(?!d})(?!{)(?<!{{)[^}]*})`

# c - 我可以将长 #include 指令分成两行吗？

> ID：12734075
> 
> 赞同：20
> 
> 时间：2012-10-04T19:03:02.423
> 
> 标签：c, include, c-preprocessor, stringification

我希望有一种方法可以将 #include 指令拆分为两行，这样我的代码就可以符合每行 80 个字符的要求，尽管需要很长的包含路径。

除了扩展编译器的搜索路径之外，我该如何管理呢？有没有办法将我很长的路径字符串分成两行？

“#define”宏扩展显然发生在#include 扩展之后，所以这些不起作用：

```
#define BIGPATH "..."
#include BIGPATH ## "/foo.c"
#include "BIGPATH/foo.c"
#include BIGPATH"/foo.c" 
```

我也试过

```
#include "foo" ##
         "bar" 
```

和

```
#include "foo" \
         "bar" 
```

无济于事。也许我想要的不可能？帮助我，stackoverflow kenobi，你是我唯一的希望。

**答案**：在下面建议的答案的基础上，这实际上对我有用：

```
#define STRINGIFY(x) #x
#define PATH(path) STRINGIFY(/my/very/long/path)
#include PATH(foo.h)
#undef PATH
#undef STRINGIFY 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-04T19:20:47.563

我不喜欢这个想法，我只是想提一下这种可能性。最好的方法是按照 Daniel Fischer 提到的方式进行。这个解决方案有点古怪，在所有情况下都不起作用，但在这里编译：

```
#define PATH(FILE) </path/to/FILE>
#include PATH(file.h) 
```

仅举一些明显的限制：

*   这些包含的搜索路径不是“本地”
*   FILE 不得包含“，”（相当少见）
*   PATH 定义仍然可以超过 80 个字符

随意添加到此列表中。

**编辑**
只是为了更好的可读性，我将以我的示例风格在下面发布来自 Jonathans 评论的解决方案：

```
#define STRINGIFY(x) #x 
#define PATH(FILE) STRINGIFY(/path/to/FILE) 
#include PATH(foo.h) 
```

这个版本缓解了版本的“局部性问题” `#include <>`，因为它映射到`#include ""`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-04T19:15:46.920

这是为我编译的（我基于我回忆 Boost.PP 的工作方式）：

```
#define a() <vec\
tor>

#include a()

int main() {
  std::vector<int> x;
} 
```

只需更改`<vector>`为您的完整路径 - 我认为您不能以您需要的方式连接字符串 in `#include`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-04T19:19:12.277

使用另一个具有短名称的头文件来存储具有长名称的头文件。因此，所有超过 80 个字符的标题都不在您格式良好的代码中。

```
//short_name.h
#include "really_really_long_include_name.h"

//code
#include "short_name.h" 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-04T19:31:56.037

所有预处理指令都由换行符终止。include 指令是以下形式之一：

```
# include < h-char-sequence> new-line
# include " q-char-sequence" new-line
# include pp-tokens new-line 
```

您的最后一个示例将导致等效于`#include "foo" "bar"`被执行，因为尽管转义的新行删除将在指令执行之前发生，但字符串连接会在之后发生。这与包含指令的最终有效形式相匹配。

但是，这种形式的结果是后面的任何宏名称`include`都将被替换。你的没有任何宏。如果生成的指令与正常的两种形式中的任何一种都不匹配，则行为未定义。

> 如果所有替换后产生的指令与前两种形式之一不匹配，则行为未定义

该标准对存在多个字符串文字的情况有一个特定的注释：

> 请注意，相邻的字符串文字不会连接成单个字符串文字（请参阅 2.2 中的翻译阶段）；因此，导致两个字符串文字的扩展是无效指令。

这就是为什么该示例不起作用的原因。然而，这确实意味着我们可以依靠宏扩展来生成有效的文件名。例如：

```
#define LONG_PATH(file) <foo/bar/baz/file>
#include LONG_PATH(file.h) 
```

或者：

```
#define STRINGIZE(x) #x
#define LONG_PATH(file) STRINGIZE(foo/bar/baz/file)
#include LONG_PATH(file.h) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-04T19:11:53.617

不，你不能，预处理器要求包含文件名是单个预处理标记。您需要修复您正在使用的包含搜索路径，或者放宽每行 80 个字符的要求。

# javascript - 谷歌地图在手机上显示错误

> ID：12734082
> 
> 赞同：1
> 
> 时间：2012-10-04T19:03:23.433
> 
> 标签：javascript, jquery, google-maps, jquery-mobile

这是标记设计问题的后续问题。
[地图在移动设备上显示错误（使用 JQuery 移动设备）](https://stackoverflow.com/questions/7089882/maps-displayed-wrong-on-mobile-using-jquery-mobile?rq=1)
我是 javascript 和 jquery 的新手，无法将上面链接中的 Mark Design 问题答案中提供的解决方案应用于我自己的谷歌地图脚本。我正在做与 Mark Design 对这个文件所做的几乎相同的事情：http: [//skool411.info/m/Hawaii-2.html](http://skool411.info/m/Hawaii-2.html)
在移动设备上，地图无法正确显示，并且执行与图片中显示的相同的事情上面发布的标记设计。有人可以告诉我如何应用“pageshow”和“resize”吗？我还尝试关闭 ajax，但这对我不起作用： [http ://skool411.info/m/Hawaii-1.html](http://skool411.info/m/Hawaii-1.html)
我很可能不知道如何正确地做到这一点。如果有人可以告诉我如何关闭 ajax，那也很棒。非常感谢您提前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T21:48:08.753

你有一些错误，`calcRoute()`因为你没有`directionsService`在这个上下文中。

首先，让我们放在`map`“`Loc1`全局”上下文中：

```
var map;
var Loc1; 
```

使用建议问题的解决方案，需要在显示页面时创建地图：

```
$('#mapPage').live('pageshow',
        function(event, ui) {
            var mapOptions = {
                zoom : 7,
                mapTypeId : google.maps.MapTypeId.ROADMAP,
                center : Loc1
            };

            map = new google.maps.Map(document.getElementById('map_canvas'),
                    mapOptions);
        }); 
```

初始化函数：

```
function initialize(Hlat1, Hlng1, Hlat2, Hlng2) {
    Loc1 = new google.maps.LatLng(Hlat1, Hlng1);

    var $content = $("#mapPage div:jqmData(role=content)");
    $content.height(screen.height);
    $.mobile.changePage($("#mapPage"));

    calcRoute(Hlat1, Hlng1, Hlat2, Hlng2);
} 
```

最后，计算路线：

```
function calcRoute(Hlat1, Hlng1, Hlat2, Hlng2) {
    var rendererOptions = {
        draggable : true
    };
    var directionsDisplay = new google.maps.DirectionsRenderer(rendererOptions);
    var directionsService = new google.maps.DirectionsService();

    var request = {
        origin : new google.maps.LatLng(Hlat1, Hlng1),
        destination : new google.maps.LatLng(Hlat2, Hlng2),
        travelMode : google.maps.DirectionsTravelMode.DRIVING
    };

    directionsService.route(request, function(response, status) {
        if (status == google.maps.DirectionsStatus.OK) {
            directionsDisplay.setDirections(response);
            directionsDisplay.setMap(map);
        }
    });
} 
```

**[这](http://pastebin.com/RDKtiS7N)**是完整的代码。

希望这可以帮助。

# c# - 将 JSON 对象传递给 MVC 控制器时 string.empty 转换为 null

> ID：12734083
> 
> 赞同：35
> 
> 时间：2012-10-04T19:03:23.213
> 
> 标签：c#, javascript, jquery, asp.net-mvc

我正在将一个对象从客户端传递到服务器。在此过程中，表示为 string.empty 的对象的属性将被转换为 null。我想知道当对象类型支持 string.empty 时如何防止这种情况。

![在此处输入图像描述](../Images/b73a692fba6c856c7d340f6a0ac13076.png)

```
console.log("DataToPost:", dataToPost);

$.ajax({
    type: "POST",
    contentType: 'application/json'
    url: "../../csweb/Orders/SaveOrderDetails/",
    data: dataToPost,
    success: function (result) {
        console.log(result);
    },
    error: function (e) {
        console.error(e);
    }
}); 
```

![在此处输入图像描述](../Images/00ad25403e809e2dd0c4715e1037870e.png)

我的模型包括可为空的 DateTime 对象。我不能在服务器上强制所有 null 为 string.empty。

我正在使用 AutoMapper，所以我不想在服务器上单独检查属性。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-10-04T19:21:32.117

这是一个将空字符串绑定到`null`s 的 MVC 特性。

此逻辑由[ModelMetadata.ConvertEmptyStringToNull](http://msdn.microsoft.com/en-us/library/system.web.mvc.modelmetadata.convertemptystringtonull%28v=vs.108%29.aspx)使用的属性控制`DefaultModelBinder`。

您可以`ConvertEmptyStringToNull`使用`DisplayFormat`属性设置

```
public class OrderDetailsModel
{
    [DisplayFormat(ConvertEmptyStringToNull = false)]
    public string Comment { get; set; }

    //...
} 
```

但是，如果您不想注释所有属性，您可以创建一个自定义模型绑定器，并将其设置为 false：

```
public class EmptyStringModelBinder : DefaultModelBinder 
{
    public override object BindModel(ControllerContext controllerContext,
                                     ModelBindingContext bindingContext)
    {
        bindingContext.ModelMetadata.ConvertEmptyStringToNull = false;
        Binders = new ModelBinderDictionary() { DefaultBinder = this };
        return base.BindModel(controllerContext, bindingContext);
    }
} 
```

您可以在操作中使用[ModelBinderAttribute](http://msdn.microsoft.com/en-us/library/system.web.mvc.modelbinderattribute%28v=vs.108%29.aspx)：

```
public ActionResult SaveOrderDetails([ModelBinder(typeof(EmptyStringModelBinder))] 
       OrderDetailsModel orderDetailsModel)
{
} 
```

或者您可以在 Global.asax 中将其设置为全局默认 ModelBinder：

```
ModelBinders.Binders.DefaultBinder = new EmptyStringModelBinder(); 
```

[您可以在此处](http://brianreiter.org/2010/09/16/asp-net-mvc-2-0-undocumented-model-string-property-breaking-change/)阅读有关此功能的更多信息。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-12-01T14:39:48.713

与其像一些答案所建议的那样创建修改 ModelMetadata 的 ModelBinder，更简洁的替代方法是提供自定义 ModelMetadataProvider。

```
public class EmptyStringDataAnnotationsModelMetadataProvider : System.Web.Mvc.DataAnnotationsModelMetadataProvider 
{
    protected override ModelMetadata CreateMetadata(IEnumerable<Attribute> attributes, Type containerType, Func<object> modelAccessor, Type modelType, string propertyName)
    {
        var modelMetadata = base.CreateMetadata(attributes, containerType, modelAccessor, modelType, propertyName);
        modelMetadata.ConvertEmptyStringToNull = false;
        return modelMetadata;
    }
} 
```

然后在 Application_Start()

```
ModelMetadataProviders.Current = new EmptyStringDataAnnotationsModelMetadataProvider(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-10-10T18:29:52.303

接受的答案对我使用 MVC4 不起作用。但是，以下解决方法确实可以，我认为它会对其他人有所帮助。

```
public class CustomModelBinder : DefaultModelBinder
{
    public bool ConvertEmptyStringToNull { get; set; }

    public CustomModelBinder ()
    {
    }

    public CustomModelBinder (bool convertEmptyStringToNull)
    {
        this.ConvertEmptyStringToNull = convertEmptyStringToNull;
    }

    protected override bool OnModelUpdating(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        // this little bit is required to override the ConvertEmptyStringToNull functionality that we do not want!

        foreach (string propertyKey in bindingContext.PropertyMetadata.Keys)
        {
            if(bindingContext.PropertyMetadata[propertyKey] != null)
                    bindingContext.PropertyMetadata[propertyKey].ConvertEmptyStringToNull = this.ConvertEmptyStringToNull;
        }
        return base.OnModelUpdating(controllerContext, bindingContext);
    }

} 
```

这将解决 MVC4+ 下的问题。似乎 bindingContext.ModelMetadata.ConvertEmptyStringToNull 被完全忽略了，这是因为该设置存在于每个被绑定的属性的 PropertyMetadata 对象中。PropertyMetadata 在 BindProperty() 中重新创建，因此如果您在该方法调用之前设置它，它将被覆盖，除非它作为被绑定对象的属性上的属性存在（例如 [DisplayFormat(ConvertEmptyStringToNull=false)]）。没有人愿意在每处房产上都这样做，因为那很愚蠢。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T19:16:45.677

问题是当字符串为空时，AutoMapper 将可空值变为空值。另一个问题的答案是我认为可以满足您的需求：[Automapper null string to empty](https://stackoverflow.com/questions/7641298/automapper-null-string-to-empty)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-04T19:21:27.660

使用 发布数据时`$.ajax`，`null`不是`data`选项属性的可能值。如果您使用 http 调试器查看请求，您会看到它已转换为空字符串。

所以我猜你的 MVC 控制器正在应用相反的转换。

我在 ajax 应用程序中解决此问题的方法是我不使用`data`选项`$.ajax()`，但我将 JSON 中的所有内容序列化并将其放入数据选项的单个字段“数据”中。像这样你没有空值的问题。当然，你必须在服务器端反序列化。

# c#-4.0 - 使用 BouncyCastle 进行 Rijndael 解密 产生损坏的数据开头和结尾，但其余数据完美解密

> ID：12734084
> 
> 赞同：0
> 
> 时间：2012-10-04T19:03:23.697
> 
> 标签：c#-4.0, cryptography, aes, bouncycastle

我正在尝试使用 bouncycastle 库加密和解密数据，在解密数据后，数据的第一个信息块已损坏，就好像它未能成功解密并且最后一个块完全丢失一样。我是 bouncycastle 库的新手，我一直在互联网上搜索，试图使用 PKCS7Padding 在 CBC 模式下找到 AES 加密的合理实现，但我无法找到太多文档。提供的任何帮助将不胜感激，我还要注意我是学生而不是专业开发人员。谢谢。

```
`public class RijndaelCBC
{
    private int _keySize;
    private byte[] _passphrase;

    public byte[] _iv { get; private set; }

    private IBlockCipher blockCipher;
    private PaddedBufferedBlockCipher aesCipher;
    private ParametersWithIV _param;

    public RijndaelCBC(int KeySize, string Passphrase)
    {
        if (Passphrase.Length < KeySize / 8)
            Passphrase = Passphrase.PadRight(KeySize / 8, '0');
        if (Passphrase.Length > KeySize)
            Passphrase = Passphrase.Substring(0, KeySize / 8);

        _passphrase = System.Convert.FromBase64String(Passphrase);
        Array.Resize(ref _passphrase, KeySize / 8);
        _keySize = KeySize;

        Random rnd = new Random();
        _iv = new byte[_keySize / 8];
        for (int t = 0; t < _keySize / 8; t++)
            rnd.Next();
        rnd.NextBytes(_iv);

        if (_keySize != 128 && _keySize != 192 && _keySize != 256)
            throw new Exception(string.Format("Invalid key size of {0} provided, cannot continue with the process.", _keySize));
    }

    public RijndaelCBC(int KeySize, string Passphrase, byte[] iv)
    {
        if (Passphrase.Length < KeySize / 8)
            Passphrase = Passphrase.PadRight(KeySize / 8, '0');
        if (Passphrase.Length > KeySize)
            Passphrase = Passphrase.Substring(0, KeySize / 8);

        _passphrase = System.Convert.FromBase64String(Passphrase);
        Array.Resize(ref _passphrase, KeySize / 8);
        _keySize = KeySize;
        _iv = iv;
        if (_keySize != 128 && _keySize != 192 && _keySize != 256)
            throw new Exception(string.Format("Invalid key size of {0} provided, cannot continue with the process.", _keySize));
    }

    public byte[] Encrypt(byte[] data)
    {
        try
        {
            blockCipher = new CbcBlockCipher(new RijndaelEngine(_keySize));
            _param = new ParametersWithIV(new KeyParameter(_passphrase), _iv);
            blockCipher.Init(true, _param);

            aesCipher = new PaddedBufferedBlockCipher(blockCipher, new Pkcs7Padding());
            byte[] cipherTextBlock = null; 
            int blockSize = aesCipher.GetBlockSize();
            List<byte> output = new List<byte>();
            int outputLen = 0;
            int chunkPosition = 0;
            for (chunkPosition = 0; chunkPosition < data.Length; chunkPosition += blockSize)
            {
                byte[] dataToProcess = new byte[blockSize];
                int chunkSize = (data.Length - chunkPosition) < blockSize ? (data.Length - chunkPosition) : blockSize;
                Buffer.BlockCopy(data, chunkPosition, dataToProcess, 0, chunkSize);

                cipherTextBlock = new byte[blockSize];
                outputLen = aesCipher.ProcessBytes(dataToProcess, 0, chunkSize, cipherTextBlock, 0);
                output.AddRange(cipherTextBlock);
            }
            try
            {
                if(chunkPosition < data.Length &&
                    chunkPosition + blockSize > data.Length)
                {
                    byte[] dataToProcess = new byte[blockSize];
                    int chunkSize = (chunkPosition + blockSize) - data.Length;
                    Buffer.BlockCopy(data, chunkPosition, dataToProcess, 0, chunkSize);
                    aesCipher.DoFinal(cipherTextBlock, 0);
                    output.AddRange(cipherTextBlock);
                }
            }
            catch (CryptoException ex)
            {}
            return output.ToArray();
        }
        catch (System.Exception ex)
        { }
        return null;
    }

    public byte[] Decrypt(byte[] data)
    {
        try
        {
            blockCipher = new CbcBlockCipher(new RijndaelEngine(_keySize));
            _param = new ParametersWithIV(new KeyParameter(_passphrase), _iv);
            blockCipher.Init(false, _param);

            aesCipher = new PaddedBufferedBlockCipher(blockCipher, new Pkcs7Padding());
            byte[] cipherTextBlock = null;   
            int blockSize = aesCipher.GetBlockSize();
            List<byte> output = new List<byte>();
            int outputLen = 0;
            int chunkPosition = 0;
            for (chunkPosition = 0; chunkPosition < data.Length; chunkPosition += blockSize)
            {
                byte[] dataToProcess = new byte[blockSize];
                int chunkSize = (data.Length - chunkPosition) < blockSize ? (data.Length - chunkPosition) : blockSize;
                Buffer.BlockCopy(data, chunkPosition, dataToProcess, 0, chunkSize);
                cipherTextBlock = new byte[blockSize];

                outputLen = aesCipher.ProcessBytes(dataToProcess, 0, chunkSize, cipherTextBlock, 0);
                output.AddRange(cipherTextBlock);
            }
            try
            {
                if (chunkPosition < data.Length &&
                    chunkPosition + blockSize > data.Length)
                {
                    byte[] dataToProcess = new byte[blockSize];
                    int chunkSize = (chunkPosition + blockSize) - data.Length;
                    Buffer.BlockCopy(data, chunkPosition, dataToProcess, 0, chunkSize);
                    aesCipher.DoFinal(cipherTextBlock, 0);
                    output.AddRange(cipherTextBlock);
                }
            }
            catch (CryptoException ex)
            { }
            return output.ToArray();
        }
        catch (System.Exception ex)
        { }
        return null;
    }
}` 
```

**输出示例：数据的开头应该是：**

生产版本发布

**但最终结果为：** [¨dZJÊ)uól)È±ýº—ÑÚ~VE'·ðúœ×ñð ersion Releases

**并且数据结尾应为：** 对于此类产品，英特尔不承担任何责任，并且英特尔不承担与英特尔产品的销售和/或使用相关的任何明示或暗示的保证，包括与特定用途的适用性、适销性相关的责任或保证或侵犯任何专利、版权或其他知识产权。英特尔产品不适用于医疗、救生或维持生命的应用。

**但最终结果为：** 对于此类产品，英特尔不承担任何责任，并且英特尔不承担与英特尔产品的销售和/或使用相关的任何明示或暗示的保证，包括责任或保证

**我试图加密和解密一个例子，但是最后数据丢失了，一开始数据没有正确解密，但文件的其余部分 52KB 是完美的。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T19:33:41.827

这段代码有几个问题，但导致您的解密问题的一个是您对 IV 的使用。您在加密期间生成一个随机 IV（很好），但随后您将其丢弃。然后，您在解密期间生成不同的随机 IV，这是不正确的。您需要使用与加密相同的 IV 进行解密。您通常将 IV 与密文一起传递（通常在密文之前是最简单的）。

您的密钥生成也不正确。据我所知，您期望使用 Base-64 编码的“密码短语”。然后你在密钥长度处将其切断，或者用 0 填充它。这是非常不安全的。您基本上是将 AES-256 转换为 AES-50 左右。它看起来是加密的，但实际上它有一个很小的密钥空间并且可以被暴力破解。

将人工输入的密码转换为 AES 密钥的正确方法是使用称为 PBKDF2 的算法。我对 bouncycastle 不是特别熟悉，也不知道他们为 PBKDF2 使用的提供商是什么。请参阅[PBKDF2 with bouncycastle in Java](https://stackoverflow.com/questions/8674018/pbkdf2-with-bouncycastle-in-java)了解更多 bouncycastle 特定的详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-09T19:13:37.813

为了使代码正常工作，我最终所做的是将填充的分组密码更改为缓冲分组密码，不确定这样做是否有任何负面影响，但我包含了代码以防万一有人需要它，因为这很难在 C# 中查找 bouncycastle 的示例

```
public class RijndaelCBC
{
    private int _keyBitSize;
    public byte[] _iv { get; private set; }

    private BufferedBlockCipher cipher;
    private KeyParameter key;
    private ParametersWithIV IVkey;

    public RijndaelCBC(int KeySize, byte[] salt, string Passphrase)
    {
    _keyBitSize = KeySize;

        Random rnd = new Random();

        _iv = new byte[_keyBitSize / 8];
        for (int t = 0; t < _keyBitSize / 8; t++)
            rnd.Next();
        rnd.NextBytes(_iv);

        PbeParametersGenerator generator = new Pkcs5S2ParametersGenerator();
        generator.Init(PbeParametersGenerator.Pkcs5PasswordToUtf8Bytes((Passphrase).ToCharArray()), salt, 1000);
        key = (KeyParameter)generator.GenerateDerivedParameters("AES", _keyBitSize);
    }

    public RijndaelCBC(int KeySize, byte[] salt, string Passphrase, byte[] iv)
    {
        _iv = iv;

        PbeParametersGenerator generator = new Pkcs5S2ParametersGenerator();
        generator.Init(PbeParametersGenerator.Pkcs5PasswordToUtf8Bytes((Passphrase).ToCharArray()), salt, 1000);
        key = (KeyParameter)generator.GenerateDerivedParameters("AES", _keyBitSize);
    }

    public byte[] Encrypt(byte[] data)
    {
        IBlockCipher theCipher = null;
        theCipher = new RijndaelEngine(_keyBitSize);
        cipher = new PaddedBufferedBlockCipher(new CbcBlockCipher(theCipher));
        IVkey = new ParametersWithIV(key, _iv);
        cipher.Init(true, IVkey);

        int size = cipher.GetOutputSize(data.Length);
        byte[] result = new byte[size];
        int olen = cipher.ProcessBytes(data, 0, data.Length, result, 0);
        olen += cipher.DoFinal(result, olen);

        if (olen < size)
        {
            byte[] tmp = new byte[olen];
            Array.Copy(result, 0, tmp, 0, olen);
            result = tmp;
        }

        return result;
    }

    public byte[] Decrypt(byte[] data)
    {
        IBlockCipher theCipher = null;
        theCipher = new RijndaelEngine(_keyBitSize);
        cipher = new PaddedBufferedBlockCipher(new CbcBlockCipher(theCipher));
        IVkey = new ParametersWithIV(key, _iv);
        cipher.Init(false, IVkey);

        int size = cipher.GetOutputSize(data.Length);
        byte[] result = new byte[size];
        int olen = cipher.ProcessBytes(data, 0, data.Length, result, 0);
        olen += cipher.DoFinal(result, olen);

        if (olen < size)
        {
            byte[] tmp = new byte[olen];
            Array.Copy(result, 0, tmp, 0, olen);
            result = tmp;
        }

        return result;
    }
} 
```

关于上面提到的类的初始化问题，第一个构造函数使用随机数据生成IV，可用于加密，生成所述IV后，您可以通过访问_iv属性获得IV。或者，您可以在加密和/或解密期间使用第二类构造函数传递 IV。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-05T08:33:55.480

那么，您没有正确获取第一个块的原因必须是 IV 值或缓冲区处理问题。最后一个可能比您预期的更合乎逻辑，因为您使用`DoFinal`了错误的方式，所以缺少结尾。您为其提供输入缓冲区而不是输出缓冲区。

# objective-c - 如何在 RubyMotion 中检索密码字段的子视图？

> ID：12734101
> 
> 赞同：0
> 
> 时间：2012-10-04T19:04:25.950
> 
> 标签：objective-c, ios, authentication, rubymotion

做这样的事情：

```
TAG_EMAIL_TEXT_FIELD = 2
TAG_PASSWORD_TEXT_FIELD = 3

button.when(UIControlEventTouchUpInside) do
      email_field = retrieve_subview_with_tag(self, TAG_EMAIL_TEXT_FIELD)
      password_field = retrieve_subview_with_tag(self, TAG_PASSWORD_TEXT_FIELD) 
```

当我在模拟器中输入密码时，它显示为纯文本。

我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T07:33:03.020

不确定您使用什么 gem 来创建表单，我会使用[formotion](http://clayallsopp.github.com/formotion/)来执行此操作，这将使登录表单的创建和管理非常简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T22:17:09.023

我意识到我必须做些什么。

我需要通过 Xcode 的故事板在密码字段上添加一个受保护的标志。那是为我做的。

# java - 找不到从方法“class_name_x”引用的类“class_name_x $2”。

> ID：12734102
> 
> 赞同：0
> 
> 时间：2012-10-04T19:04:30.017
> 
> 标签：java, android, eclipse, android-logcat

在错误文本中，类名相同，唯一改变的是第一个类名的末尾添加了 de '$2'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:16:56.827

`class_name_x`您从构造函数调用内部定义的第二个匿名类的方法，其后缀`class_name_x`由 JVM 显示。`.<init>`

看看这个问题[Java - get the current class name?](https://stackoverflow.com/questions/6271417/java-get-the-current-class-name)

# android - 使用 Metadata.xml 重命名公共事件

> ID：12734107
> 
> 赞同：1
> 
> 时间：2012-10-04T19:04:51.230
> 
> 标签：android, xamarin.android, xamarin

我正在尝试按照[本](http://docs.xamarin.com/android/advanced_topics/Java_Integration_Overview/Binding_a_Java_Library_%28.jar%29)文档绑定要与 Mono for Android 一起使用的 Java 库 (.jar)。编译项目导致 1 个错误：

> 'MoveAnimation.MoveAnimation'：成员名称不能与其封闭类型相同。

我了解错误及其发生的原因，但我似乎无法在 Metadata.xml 文件中找到正确的 xpath 来重命名事件。

我试过了：

```
<attr path="/api/package[@name='com.namespace.android']/class[@name='MoveAnimation']/event[@name='MoveAnimation']" name="managedName">MoveAnimationEvent</attr>
<attr path="/api/package[@name='com.namespace.android']/class[@name='MoveAnimation.MoveAnimation']" name="managedName">MoveAnimationEvent</attr> 
```

和许多其他组合。

重命名事件的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-16T03:01:00.897

`obj\bin\Debug\Generated`您可以通过查看构建后文件夹中生成的托管可调用包装器来查看任何方法或属性的完整路径。每个类成员都装饰有一个注释，该注释给出了元素的确切路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-26T13:13:56.953

这是我为解决问题所做的

类的新名称

这将更改类的名称，因此您的属性名称可以保持不变。

这里有一些更有用的信息。

[http://holisticware.net/HolisticWare/Know-How/development/Mobile/android/mono-for-android-monodroid/binding-projects.aspx](http://holisticware.net/HolisticWare/Know-How/development/Mobile/android/mono-for-android-monodroid/binding-projects.aspx)

# android - RESULT_ERROR_NULL_PDU 如果文本太长？

> ID：12734119
> 
> 赞同：2
> 
> 时间：2012-10-04T19:05:42.590
> 
> 标签：android, text, sms

我使用此代码以编程方式发送消息。如果文本太长，我会得到“Null Pdu”。如果太短，则成功发送。怎么了？什么是空 pdu？你能修好吗？谢谢4你的帮助..（对不起英语不好）

```
public void onReceive(Context arg0, Intent arg1) {
    switch (getResultCode())
    {
        case Activity.RESULT_OK:
            Toast.makeText(getBaseContext(), "SMS sent", 
                    Toast.LENGTH_SHORT).show();
            break;
        case SmsManager.RESULT_ERROR_GENERIC_FAILURE:
            Toast.makeText(getBaseContext(), "Generic failure", 
                    Toast.LENGTH_SHORT).show();
            break;
        case SmsManager.RESULT_ERROR_NO_SERVICE:
            Toast.makeText(getBaseContext(), "No service", 
                    Toast.LENGTH_SHORT).show();
            break;
        case SmsManager.RESULT_ERROR_NULL_PDU:
            Toast.makeText(getBaseContext(), "Null PDU", 
                    Toast.LENGTH_SHORT).show();
            break;
        case SmsManager.RESULT_ERROR_RADIO_OFF:
            Toast.makeText(getBaseContext(), "Radio off", 
                    Toast.LENGTH_SHORT).show();
            break;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-17T16:22:57.307

您必须将所有文本分成几部分，以便它们适合几条短信。或以彩信形式发送

# c# - 演化图 ZedGraph

> ID：12734121
> 
> 赞同：0
> 
> 时间：2012-10-04T19:05:52.350
> 
> 标签：c#, zedgraph

我有一个在时间 t 返回图形的 PointPairList 的方法，但我想用它来绘制一个“移动”图形，“移动”是指图形应该及时演变，有没有人知道我如何可以做到这一点。我尝试使用 RollingPointPairList，但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T07:08:57.060

进化是什么意思？您想随着时间的推移向曲线添加点，还是要更改曲线已有的点的位置？对于第一个选项，我使用计时器和 DrawPoint 方法作为向曲线添加点的处理程序。第二个选项可能更复杂一点，我没有尝试改变一个点的坐标，但也许它是可能的......在最坏的情况下你将不得不删除你的旧点并绘制新点......无论如何这里是一部分我的代码添加一个点（实际上有很多点，因为我正在使用超过 1 条曲线）

```
tmr.Interval = 6;
tmr.Tick += new EventHandler(tmr_Tick);
tmrActive = true;
tmr.Start();
void tmr_Tick(object sender, EventArgs e)
{
   DrawPoint(zedGraphControl1, points, num);   //points is an PointPair array of length num with the new points that i want to add to my Curves(1 point for each Curve)      
   zedGraphControl1.AxisChange();
   zedGraphControl1.Refresh();
   if (Start.Enabled == false) Freeze.Enabled = true;
}
private void DrawPoint(ZedGraphControl zgc, PointPair[] p, int num)
    {
        GraphPane myPane = zgc.GraphPane;

        if (myPane.CurveList.Count < num)
        {
            DrawCurves(zgc, num);
        }
        for (int i = 0; i < num; i++)
        {
            myPane.CurveList[i].AddPoint(p[i]);
        }
        actPos = p[0].X;
        mResize(zgc, actPos);
    } 
```

# jquery - jeditable 回调有空值 //OR// 单击保存按钮后如何显示编辑的文本？

> ID：12734124
> 
> 赞同：2
> 
> 时间：2012-10-04T19:06:06.370
> 
> 标签：jquery, jeditable

我有以下代码附加并在 HTML 表中的 div 元素上正确启动可编辑。该表是通过 ajax 调用生成的。我可以使用可编辑来更新后端，但它没有更新正在编辑的 HTML 表格单元格？为此，我必须重新运行 ajax 查询以使用来自后端的新值重新显示表。所以我的问题本质上是在成功提交后显示新值。

为了解决我的问题，我想到了使用回调函数，但我发现控制台日志中回调函数的值和设置为空...

我该如何解决我的问题？

```
$(".edit_area").editable('/cgi-bin/mycgiscript.cgi', {
event       : 'dblclick',       //or dblclick
type        : 'textarea',
rows        : 2,
cols        : 30,
cancel      : 'Cancel',
submit      : 'Save',
indicator   : '<img src="images/indicator.gif">',
placeholder : 'Double Click to enter text',
tooltip     : 'Double Click to edit...',
name        : 'name',
id      : 'id',
callback    : function(value, settings) {
console.log('value='+value);
console.log('settings='+settings);
console.log('callback executed='+value);
return(value);
}
}); 
```

我使用了回调，因为在“保存”编辑后的文本之后。编辑的文本不会显示在 HTML 页面上。它已正确保存在后端数据库中。我重新运行了显示来自后端服务器的更新信息的 ajax 调用...

editable 附加到从 ajax 调用生成的 html 表中的 div。如果有帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T21:08:11.680

已解决：它的工作方式是：函数的ajax调用必须返回一些东西，您可以使用回调函数对其进行解析。所以一旦我的 ajax 调用开始吐出数据。我很好。

全部发送。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-16T20:58:09.337

是的。您的 AJAX 函数必须返回一个字符串，该字符串将用于您刚刚编辑的文本区域。

当我使用它时，我的 AJAX 调用返回两件事，一个成功/失败标志和返回消息。我在某处显示返回消息以通知用户操作是否成功。然后我使用回调函数来实际更新我的目标文本区域。

# node.js - Node.js Passport 反序列化用户返回 20 多个相同的用户

> ID：12734129
> 
> 赞同：0
> 
> 时间：2012-10-04T19:06:26.807
> 
> 标签：node.js, facebook, parse-platform, passport.js

一切似乎都有效。[Parse.com](http://www.parse.com)的请求检查用户是否存在并创建或检索它。我有两个主要问题。首先，当`deserializeUser`函数被调用时，它返回 20 个相同的用户，并且`findUser`函数应该返回这 20 个用户。另外，我无法访问`req.user`

```
 passport.serializeUser(function(user, done) {

            done(null, user.objectId);
    });

    passport.deserializeUser(function(uid, done) {

            console.log(uid)
            // This outputs the ObjectId 20 TIMES!! ??

            Parse.findUser(uid,function(error,user){

                done(null, user);
            })
    });

    // CONFIGURATION
    app.configure(function() {
            app.use(express.bodyParser()); //read
            app.use(express.cookieParser()); //read
        app.use(express.session({ secret: process.env.SESSION_SECRET || 'abcde' }));
        app.use(passport.initialize());
        app.use(passport.session());
            app.use(app.router);
            app.use(express.static(__dirname + '/static'))
    });

    passport.use(new FacebookStrategy({
            clientID: process.env.FACEBOOK_APP_ID || 'app_id',
            clientSecret: process.env.FACEBOOK_SECRET || 'fb_secret',
        callbackURL: "http://localhost:5000/auth/facebook/callback"
        },
        function(accessToken, refreshToken, profile, done) {

            process.nextTick(function() {
                    _parse.user(accessToken, profile,function(parseUser){
                        //this returns the user.....

                    return done(null, parseUser);
                    })
            })
        })
    )
    app.get('/auth/facebook',
        passport.authenticate('facebook',{scope:'email'}),
            function(req, res){
                // The request will be redirected to Facebook ....
    });

    app.get('/auth/facebook/callback',
        passport.authenticate('facebook', { failureRedirect: '/login' }),
            function(req, res) {

                    console.log(req.user)
                    // this works! ...
                res.redirect('/browse');
    });

    app.get('/browse',function(req,res){
            console.log(req.user)
            // this is works too ...

            res.render('browse.jade',{title:'Browse',classes:'browse'})
    })

    app.get('/logout', function(req, res){
        req.logout();
        res.redirect('/login');
    }); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-05T15:09:29.637

我怀疑您正在加载一个包含 20 个不同资源的页面，并且每次调用都是针对其中一个资源的单个请求。

将`app.use(express.static(__dirname + '/static'))`中间件移动到中间件堆栈的顶部。由于这些资源是静态和公共的，因此不需要解析正文、cookie 或加载会话。

# css - 如何让自己变小？

> ID：12734131
> 
> 赞同：0
> 
> 时间：2012-10-04T19:06:30.700
> 
> 标签：css

![在此处输入图像描述](../Images/3afb46eed92587f46c162afcc3b60a08.png)

如何让 td(highlighted) 变小？我尝试将 witdh 设置为 50px 但不能显示更小的宽度

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:23:45.490

如果你应用`table-layout:fixed`到表格，那么确定单元格宽度的算法会变得更加直接，并且每列中的每个单元格都将根据该列中的第一个单元格进行设置，这将遵循你为宽度设置的值属性更严格。

否则，浏览器会通过更复杂的算法来确定单元格宽度，该算法会考虑单元格内容的宽度。

有关此属性的更多信息，请参见：[http ://www.w3.org/wiki/CSS/Properties/table-layout。](http://www.w3.org/wiki/CSS/Properties/table-layout)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:13:09.773

由于您使用的是表格，如果您希望整列为 50px，则需要将每行中的每个 td 分配为 50px，否则该列将与最宽的 td 一样宽。

# php - 如何缓存 Gravatar 头像？

> ID：12734137
> 
> 赞同：-1
> 
> 时间：2012-10-04T19:06:41.823
> 
> 标签：php

如何缓存 gravatar 头像以加快加载速度？

目前我只是使用直接链接：
`<img src="http://www.gravatar.com/avatar/' . md5( strtolower( trim( "privat@marktopper.dk" ) ) ) . '" alt="" class="comment-avatar"/>`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T19:09:25.753

你可以在你的服务器上使用 curl 来获取 gravatars 并自己缓存它们，但我确信 gravatar.com 也会缓存它们，客户端浏览器也是如此，所以我认为你不会获得太多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T21:46:56.747

我已经写下了一些在本地缓存 gravatar 图像的函数，请参见示例。

请在测试前将此行更改`$gravatar_email = "default@email.com";`为您的 gravatar 默认电子邮件。

此行也`$your_domain = "http://www.simplestudio.rs";`到您的域。

这条线`$local_file = "images/users/" . $email . "." . $type;`到您的本地路径。

```
<?php

function img_type($get_img) {

    $type_img = explode("\n", $get_img);
    $type_img = $type_img[0];
    $type_img = strtolower($type_img);
    $type_img = preg_replace("/[^A-Za-z0-9]/","",$type_img);

    $ftypes = array("png","jpg","jpeg","gif","bmp");

    $ftype = "";
    foreach($ftypes as $ft) {

        $locate_type = strpos($type_img, $ft);
        if($locate_type > -1) {

            $ftype = $ft;
            break;

        }

    }

    return $ftype;

}

function user_img($email, $size, $days_to_cache) {

    $email = strtolower(trim($email));

    $your_domain = "http://www.simplestudio.rs";
    $default_user_img = $your_domain . "/yard/gravatar/images/users/default_user.png";

    $gravatar_img = "http://www.gravatar.com/avatar/" . md5($email) . "?s=" . $size . "&d=" . $default_user_img;

    $now_day = date("Ymd");

    global $now_minus_one;
    $period_to_chk = " -" . $days_to_cache . " day";
    $now_minus_one = date('Ymd', strtotime($now_day . $period_to_chk));

    $get_img = file_get_contents($gravatar_img);

    $type = img_type($get_img);

    $local_file = "images/users/" . $email . "." . $type;

    if (file_exists($local_file)) {

        global $file_date;
        $file_date = date("Ymd", filemtime($local_file));

        if($now_minus_one >= $file_date) {

            $get_img = file_get_contents($gravatar_img);

            $open_file = fopen($local_file, 'w') or die("can't open file");
            $data = $get_img;
            fwrite($open_file, $data);
            fclose($open_file);

            $user_img = $local_file;

        }
        else {

            $user_img = $local_file;

        }

    }
    else {

        $open_file = fopen($local_file, 'w') or die("can't open file");
        $data = $get_img;
        fwrite($open_file, $data);
        fclose($open_file);

        $user_img = $local_file;

    }

    return $user_img;

}

if(isset($_REQUEST['gravatar_email'])) {

    $gravatar_email = $_REQUEST['gravatar_email'];

}
else {

    $gravatar_email = "default@email.com";

}

$img = user_img($gravatar_email, "64", "1");

?>

<html>
<head>
</head>
<body>

    <img src="<?php print $img; ?>" alt="" class="comment-avatar"/>

</body>
</html> 
```

**这是在行动：**
[http ://simplestudio.rs/yard/gravatar/gravatar.php](http://simplestudio.rs/yard/gravatar/gravatar.php)

*   您可以在 URL 中传递电子邮件参数，只需添加 ?gravatar_email=some@mail.com

**这是保存图像的地方：http:**
[//simplestudio.rs/yard/gravatar/images/users/](http://simplestudio.rs/yard/gravatar/images/users/)

那么逻辑是什么？您调用通过电子邮件地址获取 gravatar 的函数，它会检查该 gravatar 是否已被缓存。
如果不是，只需在本地保存文件并将该路径返回给您。
如果它已经保存，它会检查该文件是否早于 1 天（这可在函数参数 - 第 3 个参数中配置），如果它更旧，它会更新 gravatar，否则它会提供旧的本地文件。
此外，当您调用该函数时，您可以配置您需要的 gravatar 大小，为了测试，我放了 64px ...
还有一个故障转移 img 定义的变量`$default_user_img`，如果用户没有 gravatar，那么您的本地故障转移 img 将是默认值拥有总是好的...

我认为，如果您以这种方式缓存来自 gravatar 的图像，从长远来看，它会更快。
无论如何，您将在本地缓存图像，这总是很好的，原因有很多......

*   我花了一些时间来写这篇文章，希望对您有所帮助:)

# .net-3.5 - 迁移期间使用 fluorine fx borken 的网站

> ID：12734141
> 
> 赞同：0
> 
> 时间：2012-10-04T19:06:55.287
> 
> 标签：.net-3.5, windows-server-2008, iis-7.5, fluorinefx

我们有 asp.net 网站在从 win2k3 迁移到 win2k8r2 后开始出现以下错误

> (mx.messaging.messages::ErrorMessage)#0 body = (Object)#1 clientId = (null) correlationId = "4D9A6C96-03CB-3175-FFB4-2CF0D4C4D6FE"destination = "" extendedData = (null) faultCode = "Client .Error.MessageSend" faultDetail = "Channel.Connect.Failed 错误 NetConnection.Call.BadVersion: : url: 'http://subdomain.domain.org/fluorinefx/gateway.aspx'" faultString = "发送失败" headers = ( Object)#2 messageId = "90010FA4-E69E-3705-8D29-2CF0D65E957B" rootCause = (mx.messaging.events::ChannelFaultEvent)#3 bubbles = false cancelable = false channel = (mx.messaging.channels::AMFChannel)# 4 认证 = 假 channelSets = (Array)#5 [0] (mx.messaging::ChannelSet)#6 已验证 = false channelIds = (Array)#7 [0] "my-amf" channels = (Array)#8 [0] (mx.messaging.channels::AMFChannel)#4 clustered = false connected = false currentChannel = (mx.messaging.channels::AMFChannel)#4 initialDestinationId = (null) messageAgents = (Array)#9 [0] (mx.rpc::AsyncRequest)#10 authenticated = false autoConnect = true channelSet = (mx.消息::ChannelSet)#6 clientId = (null) connected = false defaultHeaders = (null) destination = "fluorine" id = "D967EE11-9117-DE39-E544-2CEF7130B37A"reconnectAttempts = 0 reconnectInterval = 0 requestTimeout = -1 subtopic = "" [1] (mx.rpc::AsyncRequest)#11 authenticated = false autoConnect = true channelSet = (mx.messaging::ChannelSet)#6 clientId = (null) connected = false defaultHeaders = (null) destination = "fluorine" id = "B1282969-F54C-B538-E4B1-2CF0D4C3CB73" reconnectAttempts = 0 reconnectInterval = 0 requestTimeout = -1 subtopic = "" connected = false connectTimeout = -1 enableSmallMessages = true端点 = "http://subdomain.domain。org/fluorinefx/gateway.aspx" failoverURIs = (Array)#12 id = "my-amf" mpiEnabled = false netConnection = (flash.net::NetConnection)#13 client = (mx.messaging.channels::AMFChannel)# 4 connected = false objectEncoding = 3 proxyType = "none" uri = "http://subdomain.domain.org/fluorinefx/gateway.aspx" piggybackingEnabled = false polling = false pollingEnabled = true pollingInterval = 3000 protocol = "http" reconnecting =假recordMessageSizes =假recordMessageTimes =假requestTimeout = -1 uri =“http://subdomain.domain.org/fluorinefx/gateway.aspx” url =“http://subdomain.domain.org/fluorinefx/gateway.aspx”useSmallMessages = false channelId = "my-amf" connected = false currentTarget = (mx.messaging.channels::AMFChannel)#4 eventPhase = 2 faultCode = "Channel.Connect.Failed" faultDetail = "NetConnection.Call.BadVersion: : url : 'http://subdomain.domain.org/fluorinefx/gateway.aspx'" faultString = "error" reconnecting = false denied = false rootCause = (Object)#14 code = "NetConnection.Call.BadVersion" description = "" details = "" level = "error" target = (mx.messaging.channels::AMFChannel)#4 type = "channelFault" 时间戳 = 0 timeToLive = 0connected = false currentTarget = (mx.messaging.channels::AMFChannel)#4 eventPhase = 2 faultCode = "Channel.Connect.Failed" faultDetail = "NetConnection.Call.BadVersion: : url: 'http://subdomain.domain. org/fluorinefx/gateway.aspx'" faultString = "error" reconnecting = false denied = false rootCause = (Object)#14 code = "NetConnection.Call.BadVersion" description = "" details = "" level = "error" target = (mx.messaging.channels::AMFChannel)#4 type = "channelFault" 时间戳 = 0 timeToLive = 0connected = false currentTarget = (mx.messaging.channels::AMFChannel)#4 eventPhase = 2 faultCode = "Channel.Connect.Failed" faultDetail = "NetConnection.Call.BadVersion: : url: 'http://subdomain.domain. org/fluorinefx/gateway.aspx'" faultString = "error" reconnecting = false denied = false rootCause = (Object)#14 code = "NetConnection.Call.BadVersion" description = "" details = "" level = "error" target = (mx.messaging.channels::AMFChannel)#4 type = "channelFault" 时间戳 = 0 timeToLive = 0Call.BadVersion: : url: 'http://subdomain.domain.org/fluorinefx/gateway.aspx'" faultString = "error" reconnecting = false denied = false rootCause = (Object)#14 code = "NetConnection.Call. BadVersion" 描述 = "" 详细信息 = "" 级别 = "错误" 目标 = (mx.messaging.channels::AMFChannel)#4 类型 = "channelFault" 时间戳 = 0 timeToLive = 0Call.BadVersion: : url: 'http://subdomain.domain.org/fluorinefx/gateway.aspx'" faultString = "error" reconnecting = false denied = false rootCause = (Object)#14 code = "NetConnection.Call. BadVersion" 描述 = "" 详细信息 = "" 级别 = "错误" 目标 = (mx.messaging.channels::AMFChannel)#4 类型 = "channelFault" 时间戳 = 0 timeToLive = 0目标 = (mx.messaging.channels::AMFChannel)#4 类型 = "channelFault" 时间戳 = 0 timeToLive = 0目标 = (mx.messaging.channels::AMFChannel)#4 类型 = "channelFault" 时间戳 = 0 timeToLive = 0

以下是旧服务器的配置信息

win2k3r2 64 位 iis6 Fluroine fx(1.0.0.15) 如添加删除程序 Fluroine fx windows 服务未安装中所示。FluorineFx.dll 1.0.0.15（存在于我网站的 bin 文件夹中） FluorineFx.ServiceBrowser.dll 1.0.0.15（存在于我网站的 bin 文件夹中）

以下是旧服务器的配置信息

win2k8r2 64 位 iis7.5 Fluroine fx(1.0.0.15) 如添加删除程序 Fluroine fx windows service installed(fluorinefx.exe (1.0.0.13)) 所示。FluorineFx.dll 1.0.0.15（存在于我网站的 bin 文件夹中） FluorineFx.ServiceBrowser.dll 1.0.0.15（存在于我网站的 bin 文件夹中） 站点有自己的应用程序池。应用程序池允许 32 位应用程序。空闲超时为 0

在新旧服务器的目录中都有一个“fluorinefx”文件夹，其中包含 gateway.aspx 和 console.aspx 文件。

这是 console.aspx.cs 文件的内容

使用系统；使用 System.Data；使用 System.Configuration；使用 System.Collections；使用 System.Web；使用 System.Web.Security；使用 System.Web.UI；使用 System.Web.UI.WebControls；使用 System.Web.UI.WebControls.WebParts；使用 System.Web.UI.HtmlControls；

公共部分类控制台：System.Web.UI.Page { protected void Page_Load(object sender, EventArgs e) { Response.Redirect("Fluorine.aspx"); }

```
#region Web Form Designer generated code
override protected void OnInit(EventArgs e)
{
    //
    // CODEGEN: This call is required by the ASP.NET Web Form Designer.
    //
    InitializeComponent();
    base.OnInit(e);
}

/// <summary>
/// Required method for Designer support - do not modify
/// the contents of this method with the code editor.
/// </summary>
private void InitializeComponent()
{    
    this.Load += new System.EventHandler(this.Page_Load);

}
#endregion 
```

}

这是“gateway.aspx.cs”文件的内容

使用系统；使用 System.Data；使用 System.Configuration；使用 System.Collections；使用 System.Web；使用 System.Web.Security；使用 System.Web.UI；使用 System.Web.UI.WebControls；使用 System.Web.UI.WebControls.WebParts；使用 System.Web.UI.HtmlControls；

公共部分类网关：System.Web.UI.Page { protected void Page_Load(object sender, EventArgs e) {

```
} 
```

这是我的 crossdomain.xml 文件

```
<cross-domain-policy> <site-control permitted-cross-domain-policies="master-only"/> <allow-access-from domain="*"/> </cross-domain-policy> 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T11:13:08.250

修复。原来我所要做的就是让应用程序池以经典模式而不是集成模式运行。问题已解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:13:54.950

这是 |c:\websites\subdomain.domain.org\websiteroot\web-inf\flex" 文件夹中的 service-config.xml 文件的内容 --> -->

```
<!-- Custom authentication -->
<security>
    <!-- A security constraint requires that a user is authorized before accessing a destination.
    Here you can declare security constraints globally. When several destinations 
    use the same security settings, you should define one security constraint in the 
    security section of the services configuration file and refer to it in each destination.                
    -->
    <!-- 
    <security-constraint id="privileged-users">
        <auth-method>Custom</auth-method>
        <roles>
            <role>admin</role>
            <role>privilegeduser</role>
        </roles>
    </security-constraint>    
     -->

    <!--    
    Custom login command, to check a user's credentials and log a principal into the application server
    A login command must implement the com.TheSilentGroup.Fluorine.Messaging.Security.ILoginCommand interface
    or inherit from com.TheSilentGroup.Fluorine.Messaging.Security.GenericLoginCommand.

    You can use a login command without security constraints defined.
    -->
    <!-- 
    <login-command class="FluorineFx.Security.GenericLoginCommand" server="asp.net"/>
     -->
</security>

<channels>
    <channel-definition id="my-amf" class="mx.messaging.channels.AMFChannel">
        <endpoint uri="http://{server.name}:{server.port}/{context.root}/fluorinefx/Gateway.aspx" class="flex.messaging.endpoints.AMFEndpoint"/>
        <properties>
            <!-- <legacy-collection>true</legacy-collection> -->
        </properties>
    </channel-definition>
    <!--
    <channel-definition id="my-rtmp" class="mx.messaging.channels.RTMPChannel">
        <endpoint uri="rtmp://{server.name}:2037" class="flex.messaging.endpoints.RTMPEndpoint"/>
        <properties>
            <idle-timeout-minutes>20</idle-timeout-minutes>
        </properties>
    </channel-definition>
    -->
</channels> 
```

# c# - C# 正则表达式验证

> ID：12734144
> 
> 赞同：2
> 
> 时间：2012-10-04T19:07:15.863
> 
> 标签：c#, expression

有人可以帮我验证一下吗（正则表达式匹配缺点的新手）。
而不是问这个问题，我正在写这个：

```
Regex rgx = new Regex (@"^{3}[a-zA-Z0-9](\d{5})|{3}[a-zA-Z0-9](\d{9})$" 
```

谁能告诉我好不好...

我要匹配的帐户是：

```
1\. BAA89345  (8 chars)
2\. 12345678  (8 chars)
3\. 123456789112 (12 chars) 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:12:12.647

是具有 3 个字符的值，然后是始终以三个开头的数字......它可以以小于或大于三个开头。如果可以的话，这些数字之前的最小和最大字符是什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T19:13:42.267

您需要将量词放在它们应该量化的字符之后。此外，字符类需要用方括号括起来。这应该有效：

```
@"^(?:[a-zA-Z0-9]{3}|\d{3}\d{4})\d{5}$" 
```

有几个很好的自动化正则表达式测试器。您可能想查看[regexpal](http://regexpal.com/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T19:15:20.253

尽管这可能是一个完全有效的匹配，但我建议将其重写为：

> ^([a-zA-Z]{3}\d{5}|\d{8}|\d{12})$

这需要字符串匹配以下之一：

*   `[a-zA-Z]{3}\d{5}`三个字母和五个数字
*   `\d{8}`8 位数字或
*   `\d{12}`十二位数。

也更容易阅读...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-04T19:10:55.700

您可以使用正则表达式测试器。网上有很多免费的。[我的 Regex Tester](http://myregextester.com/)是我目前最喜欢的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-04T19:16:10.203

我不是 100% 达成您的目标，但我可以立即看到一些问题。

1.  当您列出要匹配的可接受字符时，例如 with `a-zA-Z0-9`，您需要将其放在括号内，例如在开头`[a-zA-Z0-9]` 使用 a将否定包含的字符，例如 `[^a-zA-Z0-9]`^`

2.  单词字符可以匹配like `\w`，相当于`[a-zA-Z0-9_]`.

3.  量词需要出现在匹配表达式的末尾。因此，`{3}[a-zA-Z0-9]`您需要编写而不是`[a-zA-Z0-9]{3}`（假设您要匹配匹配的字符的三个实例`[a-zA-Z0-9]`

# javascript - “onmouseover”关键字 xss 的 ASP 经典过滤器

> ID：12734155
> 
> 赞同：0
> 
> 时间：2012-10-04T19:07:53.913
> 
> 标签：javascript, asp-classic, xss

这是互联网上的一个冗余问题，但没有简单的答案。我知道我不会简单地通过过滤来摆脱所有 XSS，但我想从它开始。我目前正在使用用 JScript（不是通常的 VBScript）编写的服务器代码处理 ASP Classic 项目。我们发现我们容易受到一些 XSS 攻击。一个很难摆脱，因为我不是 javascript 大师。当您使用如下 URL 时，攻击成功。

> [http://mysite/default.asp?NumVol=%20onmouseover=%22alert%28document.cookie%29%22%20style=%22font-size:999999999999px;%22%20href=](http://www.google.com)

我尝试了 HTMLEncode，NumVol 参数字符串上的替换方法......但它仍然显示 cookie。我正在寻找的只是一个小的替换方法、一个正则表达式或任何简单的东西来管理那个特定的情况。

这是一个旧的生产应用程序，他们不想花太多时间在上面。只是一些安全基础知识。我们现在绝对不会安装依赖 .NET（如 OWASP）的库来解决这个问题，因为我们很快就会在 .NET 中重建应用程序。

**编辑**

这是我尝试过的示例代码。您可以看到我使用 HTMLEncole 加上一些带有“替换”的过滤器。"%" 字符在那里，但它不起作用，因为 onmouseover 是写的。我需要的是 Javacript 中的一个语法示例（regex 或 someting），我可以在这种情况下应用。

```
var sPage = "" + Request.ServerVariables ( "SCRIPT_NAME" );
var NumVol = Request.QueryString("NumVol");
var comp = Request.QueryString("comp")
var nav = Request.QueryString("nav");
var NoEle = Request.QueryString("NoEle");
var NoCons = Request.QueryString("NoCons");

if (Lg=="en")  {
    var pageSourceValid = Server.HTMLEncode(sPage + "?Lg=fr");
    Response.Write("<a href=");
        if ((NumVol+"" != "undefined") && (NumVol+"" != "")) {
            pageSourceValid += "&NumVol=" + NumVol.replace(/\<|\>|\"|\'|\%|\;|\(|\)|\&|\+|\-/g,"");
        }
        if ((nav+"" != "undefined") && (nav+"" != "")) {
            pageSourceValid += "&nav=" + nav.replace(/\<|\>|\"|\'|\%|\;|\(|\)|\&|\+|\-/g,"") + "";
        }
        if ((comp+"" != "undefined") && (comp+"" != "")) {
            pageSourceValid += "&comp=" + comp.replace(/\<|\>|\"|\'|\%|\;|\(|\)|\&|\+|\-/g,"") + "";
        }
        if ((NoEle+"" != "undefined") && (NoEle+"" != "")) {
            pageSourceValid += "&NoEle=" + NoEle.replace(/\<|\>|\"|\'|\%|\;|\(|\)|\&|\+|\-/g,"") + "";
        }
        if ((NoCons+"" != "undefined") && (NoCons+"" != "")) {
            pageSourceValid += "&NoCons=" + NoCons.replace(/\<|\>|\"|\'|\%|\;|\(|\)|\&|\+|\-/g,"") + "";
        }

Response.Write(Server.HTMLEncode(pageSourceValid));
Response.Write (" class=lienBanniere>");
Response.Write ("Français");
Response.Write ("</a>"); 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T05:52:18.770

输出值时使用 html 属性转义和 html 转义。

[https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet](https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet)

# cocoa - 自定义 NSMangedObject 访问器崩溃 NSOutlineView

> ID：12734158
> 
> 赞同：0
> 
> 时间：2012-10-04T19:08:12.640
> 
> 标签：cocoa, core-data, nsmanagedobject, nsarraycontroller, nsoutlineview

我认为这是 Core Data 中的一个错误，但在我提交错误报告之前，我想确定这不仅仅是我愚蠢。

我设置了一个 NSOutlineView 来访问 5 个不同的核心数据实体的数据。每个实体的数据都通过不同的 NSArrayController 访问，该 NSArrayController 绑定到实体及其“ManagedObjectContext”。然后我让 NSOutlineViewDataSource 方法根据展开的实体返回正确的 NSString 对象。

注意：实体在其他地方被声明为带有实体名称的 NSArray。

```
- (id)outlineView:(NSOutlineView *)outlineView child:(NSInteger)index
       ofItem:(id)item {

if(nil == item) {
    return [entities objectAtIndex:index];
}
NSInteger entityIdx = [entities indexOfObject:item];
if (entityIdx == NSNotFound) {
    return @"";
}
id returnObject = @"";
switch (entityIdx) {
    case 0: {
        Person *person  = [[peopleArrayController arrangedObjects] objectAtIndex:index];
        returnObject = person.fullName;
        break;
    }
    case 1: {
        Media *media = [[mediaArrayController arrangedObjects] objectAtIndex:index];
        returnObject = media.imageTitle;
        break;
    }
    case 2: {
        Note *note  = [[notesArrayController arrangedObjects] objectAtIndex:index];
        returnObject = note.noteDescription;
        break;
    }
    case 3: {
        Source *source = [[sourcesArrayController arrangedObjects] objectAtIndex:index];
        returnObject = source.title;
        break;
    }
    case 4: {
        Repository *repo = [[repostioriesArrayController arrangedObjects] objectAtIndex:index];
        returnObject = repo.name;
        break;
    }
    default:
        break;
}

return returnObject; 
```

}

Person 实体属性 fullName 和 Media 实体属性 imageTitle 是自定义访问器。

```
- (NSString *)fullName {
[self willAccessValueForKey:@"surName"];
[self willAccessValueForKey:@"givenName"];
NSString *firstName = [self valueForKey:@"givenName"];
NSString *lastName = [self valueForKey:@"surName"];
NSString *string = [NSString stringWithFormat:@"%@ %@", (firstName) ? firstName : @"", (lastName) ? lastName : @""];
[self didAccessValueForKey:@"surName"];
[self didAccessValueForKey:@"givenName"];
return string; 
```

}

```
- (id) imageTitle {
[self willAccessValueForKey:@"path"];
id title = [[self valueForKey:@"path"] lastPathComponent];
[self didAccessValueForKey:@"path"];
return title; 
```

}

当我尝试扩展 Person 或 Media 实体时程序崩溃了，但当我扩展其他实体时却没有。我将崩溃追踪到 [NSCell _setContents:][NSObject(NSObject) doesNotRecognizeSelector:]

我将返回的 Media 属性更改为标准的 Core Data 访问器属性@“path”，当我展开 Media 实体时程序停止崩溃。所以问题肯定与自定义访问器有关。

仅供参考 - 我检查以确保实体设置为使用 NSManagedObject 类。

除了错误，谁能给我一个崩溃的原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T18:31:37.503

我通过改变方法解决了这个问题

`- (id)outlineView:(NSOutlineView *)outlineView child:(NSInteger)index ofItem:(id)item`

返回托管对象

```
case 1: {
        Media *media = [[mediaArrayController arrangedObjects] objectAtIndex:index];
        returnObject = media;
        break;
    } 
```

然后我有方法 `- (id)outlineView:(NSOutlineView *)outlineView objectValueForTableColumn:(NSTableColumn *)tableColumn byItem:(id)item`

返回字符串

```
 if ([item isKindOfClass:[Media  class]]) {
    Media *media = (Media *)item;
    return media.imageTitle;
} 
```

# ubuntu - 如何在 Ubuntu 12.04 中使用 Boehm 垃圾收集器

> ID：12734161
> 
> 赞同：1
> 
> 时间：2012-10-04T19:08:25.950
> 
> 标签：ubuntu, ubuntu-12.04, ubuntu-10.04, boehm-gc

考虑程序：

```
#include <gc/gc.h>
int main() {
  void* p = GC_MALLOC(15);
} 
```

在 Ubuntu 10.04 LTS 下编译 ( `gcc -lgc test.c`)。在 12.04 LTS 下：

```
/tmp/cc7GcTfU.o: In function `main':
main.c:(.text+0xe): undefined reference to `GC_malloc'
collect2: ld returned 1 exit status 
```

看起来在 10.04 和 12.04 之间，他们已经更改了库而不是在 malloc 替换中编译。或者这就是我认为这个`libgc1c2`包裹的描述所说的：

```
[...] However, it does not work as a drop-in malloc(3) replacement. 
```

有没有一种简单的方法来解决这个问题？（比如说，比手动重新编译 libgc 更简单...）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-06T01:01:26.590

回答我自己的问题：实际上，Boehm GC 库的工作方式仍与 12.04 中的相同。问题是GCC没有！GCC 已经开始默认为，如果它位于行`--as-needed`首，它将完全下降。`-lgc`这是一个非常大的变化！！

解决方案是移到`-lgc`最后：

```
gcc test.c -lgc 
```

或添加：

```
gcc -Wl,--as-needed -lgc test.c 
```

# android - 在 Android 应用中保存照片时出现 RuntimeException？

> ID：12734164
> 
> 赞同：0
> 
> 时间：2012-10-04T19:08:38.797
> 
> 标签：android, android-camera, runtimeexception

我试过这段代码：

```
public class pantalla8 extends Activity {

    private static final int CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE = 100;
    private Uri fileUri;
    public static final int MEDIA_TYPE_IMAGE = 1;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.camera);

        final Button camera = (Button) findViewById(R.id.boton12);
        camera.setOnClickListener(new OnClickListener(){
            public void onClick(View arg0){
                Intent cameraIntent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
                fileUri = getOutputMediaFileUri(MEDIA_TYPE_IMAGE);
                cameraIntent.putExtra(MediaStore.EXTRA_OUTPUT, fileUri);
                startActivityForResult(cameraIntent, CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE);
            }
        });
    }

    private static Uri getOutputMediaFileUri(int type){
          return Uri.fromFile(getOutputMediaFile(type));
    }

    private static File getOutputMediaFile(int type){
        String state = Environment.getExternalStorageState();

        if (Environment.MEDIA_MOUNTED.equals(state)) {
            File mediaStorageDir = new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES), "MyCameraApp");
            if (! mediaStorageDir.exists()){
                if (! mediaStorageDir.mkdirs()){
                    Log.d("MyCameraApp", "failed to create directory");
                    return null;
                }
            }

            String timeStamp = new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date());
            File mediaFile;
            if (type == MEDIA_TYPE_IMAGE){
                mediaFile = new File(mediaStorageDir.getPath() + File.separator +
                "IMG_"+ timeStamp + ".jpg");
            } else {
                return null;
            }

            return mediaFile;
        } else {
            return null;
        }
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        if (requestCode == CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE) {
            if (resultCode == RESULT_OK) {
                Toast.makeText(this, "Image saved to:\n" +
                         data.getData(), Toast.LENGTH_LONG).show();
            } else if (resultCode == RESULT_CANCELED) {
                Toast.makeText(this, "Cancelado", Toast.LENGTH_SHORT).show();
            } else {
                Toast.makeText(this, "Falla", Toast.LENGTH_SHORT).show();
            }
        }
    }
} 
```

MyCameraApp 文件已正确创建，照片已正确存储在此目录中，但出现运行时异常：

```
10-04 14:22:16.398: E/AndroidRuntime(6952): FATAL EXCEPTION: main
10-04 14:22:16.398: E/AndroidRuntime(6952): java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=100, result=-1, data=null} to activity {tian.proto/tian.proto.pantalla8}: java.lang.NullPointerException
10-04 14:22:16.398: E/AndroidRuntime(6952):     at android.app.ActivityThread.deliverResults(ActivityThread.java:2536)
10-04 14:22:16.398: E/AndroidRuntime(6952):     at android.app.ActivityThread.handleSendResult(ActivityThread.java:2578)
10-04 14:22:16.398: E/AndroidRuntime(6952):     at android.app.ActivityThread.access$2000(ActivityThread.java:117)
10-04 14:22:16.398: E/AndroidRuntime(6952):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:965)
10-04 14:22:16.398: E/AndroidRuntime(6952):     at android.os.Handler.dispatchMessage(Handler.java:99)
10-04 14:22:16.398: E/AndroidRuntime(6952):     at android.os.Looper.loop(Looper.java:130)
10-04 14:22:16.398: E/AndroidRuntime(6952):     at android.app.ActivityThread.main(ActivityThread.java:3687)
10-04 14:22:16.398: E/AndroidRuntime(6952):     at java.lang.reflect.Method.invokeNative(Native Method)
10-04 14:22:16.398: E/AndroidRuntime(6952):     at java.lang.reflect.Method.invoke(Method.java:507)
10-04 14:22:16.398: E/AndroidRuntime(6952):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
10-04 14:22:16.398: E/AndroidRuntime(6952):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
10-04 14:22:16.398: E/AndroidRuntime(6952):     at dalvik.system.NativeStart.main(Native Method)
10-04 14:22:16.398: E/AndroidRuntime(6952): Caused by: java.lang.NullPointerException
10-04 14:22:16.398: E/AndroidRuntime(6952):     at tian.proto.pantalla8.onActivityResult(pantalla8.java:95)
10-04 14:22:16.398: E/AndroidRuntime(6952):     at android.app.Activity.dispatchActivityResult(Activity.java:3908)
10-04 14:22:16.398: E/AndroidRuntime(6952):     at android.app.ActivityThread.deliverResults(ActivityThread.java:2532)
10-04 14:22:16.398: E/AndroidRuntime(6952):     ... 11 more 
```

我不知道为什么......谁能告诉我我做错了什么？我应该尝试在 AsyncTask 线程中调用相机意图吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:16:45.807

确保使用断点和调试，但是您所做的唯一对象调用`onActivityResult`是`data.getData()`所以我猜数据为空。

# python - 如何在 Python 2.7 中动态构造函数的内容？

> ID：12734167
> 
> 赞同：3
> 
> 时间：2012-10-04T19:08:47.743
> 
> 标签：python, function

我遇到了许多文章，但并没有完全解决我正在尝试做的事情。我希望这不是一个重复的问题。

我正在编写一个 Python 脚本，它与我的 PC 之外的几个现实世界的对象交互。我编写了包含与这些对象交互所需的函数的类。我还成功编写了一个函数，它在风格上不是非常面向对象，它实例化这些类的实例，从中获取数据，并将其全部保存到 CSV 文件中。这一切都很好。我被绊倒的地方是试图使函数更具适应性，这样我就不必每次想添加另一个类实例或从预先存在的实例获取不同的数据点时都重新编写它。

我正在尝试的方法是创建一个列表，其中包含类实例的名称和特定的函数名称，以从这些实例中获取数据。然后我将此列表传递给另一个函数。理想情况下，这个其他函数将为我的 CSV 文件创建一个标题（以便可以更轻松地解释数据），然后继续收集数据。

伪代码：

```
inst1 = my_class_1()
inst2 = my_class_2()
filename = 'fubar.csv'
control_list = ['inst1', 'value1', 'inst2', 'value']

my_fucntion(filename, control_list):
# Code to create a header for CSV file in the form inst1-value1, inst2-value2
# Loop to control the number of times to grab data
    # Code which iterates control_list and builds up things like inst1.value1(), inst2.value2(),
    # etc. and then appends the results to a list
    # write results list to filename 
```

如果我将 control_list 的所有元素作为字符串传递到我的函数中，我可以轻松地为结果文件生成标题，但我不知道如何获取这些字符串并生成类似的`inst1.value1()`内容，以便 Python 可以访问我的类中的函数。我认为，如果我创建列表，就像`[inst1.value1(), inst2.value2()]`我可以从我的类中获取数据一样，但我无法弄清楚如何以这种方式创建我的头文件。

如果我上面概述的方法不起作用，我愿意接受其他方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T11:28:19.383

借助 oops 概念，您可以轻松完成这项工作，而无需使用其他 python 预定义函数。

类 MyClass(object): def **init** (self, value1): self.value1 = value1

inst = MyClass("示例")

获取属性 inst.value1 的值

设置属性 inst.value1 = "hello" 的值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T19:33:26.347

我认为您正在寻找以下[`getattr`](http://docs.python.org/library/functions.html#getattr)功能：

```
class MyClass(object):
    def __init__(self, value1):
        self.value1 = value1

instance = MyClass("example")
fieldname = "value1"
fieldvalue = getattr(inst1, fieldname)
# fieldvalue == "example" 
```

使用`getattr`并且`setattr`您可以编写代码来操作您将其名称作为参数传递给函数的字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T19:25:35.817

我最近有一个类似的问题，并用来`namedtuple`解决它。

```
value1 = 'value of 1'
value2 = 'value of 2'
ControlList = namedtuple("ControlList", "inst1, inst2"))
controllist = ControlList(value1, value2)

>>> print controllist.inst1
... 'value of 1'
>>> print controllist.inst2
... 'value of 2' 
```

value1 和 value2 不必是字符串，它们甚至可以是实例化或非实例化的类。

以这种方式编写 ControlList 的好处是，您始终可以扩展您的控制列表，并且它不会破坏依赖于 ControlList 具有特定长度或在特定位置具有特定值的函数。您始终可以通过 .method 绑定访问 ControlList 中的项目，并且`ControlList.method`如果您想避免弄乱代码，可以在内部为您的函数设置别名。

# php - 从数值数组中查找和删除特定项目

> ID：12734169
> 
> 赞同：0
> 
> 时间：2012-10-04T19:08:51.487
> 
> 标签：php, arrays, if-statement

```
$list = array('red', 'blue', 'white', 'green', 'black', 'orange', 'brown', 'violet', 'magenta'); 
```

在执行 var_dump($list) 之前，如何删除具有键 [3] 和值为“orange”的项目，然后删除没有这些项目的 var_dump($list)？

（必须使用“if”语句 - 学校作业）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:11:55.503

```
foreach ($list as $key => &$value)
{
    if ($value == 'orange' || $key == 3)
    {
        unset($list[$key])
    }

    echo $value . "\n";
} 
```

你试过什么？解决问题将帮助您成为更好的程序员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:14:49.550

无循环

```
 $list = array('red', 'blue', 'white', 'green', 'black', 'orange', 'brown', 'violet', 'magenta'); 
    unset($list[3]);
    unset($list[array_search('orange', $list)]);
    var_dump($list); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T19:42:39.110

该问题可以使用上面的 foreach 来解决，或者您可以使用只需要使用“if”语句的条件。

结合上面的两个答案将提供更有效的解决方案：

```
unset($list[3]);
if (($key = array_search('orange', $list)) !== false)
    unset($list[$key]);
print_r($list); 
```

unset 只是从数组中删除该元素。我会得到'orange'的$key，如果它存在，然后取消设置，最后打印数组。

# google-maps - 谷歌地图 api v3 白色覆盖

> ID：12734171
> 
> 赞同：0
> 
> 时间：2012-10-04T19:09:02.690
> 
> 标签：google-maps, google-maps-api-3

我最近开始使用 Google Map API，并在自己的网页中尝试了[hello world 示例。](https://developers.google.com/maps/documentation/javascript/tutorial#HelloWorld)我的代码与原始代码的唯一区别是我在 javascript 代码中显示 map 元素，如下所示：

```
 function showMap () {
        container = document.getElementById("id_container");
        container.innerHTML = "<div id=\"map_canvas\"><\/div>";
        var mapOptions = {
            center: new google.maps.LatLng(-34.397, 150.644),
            zoom: 8,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
    } 
```

在外部 css 文件中，我通过 #map_canvas 的固定值定义了宽度和高度。

但我没有得到预期的结果。地图显示了大约 1 秒钟，然后变成了全白（见下图）。当我放大地图时，我可以看到它在闪烁。我在谷歌上搜索过，但没有得到任何解决方案，我什至不知道问题出在哪里。有没有人遇到过同样的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-06T01:40:09.963

## 经过几天的尝试，我知道发生了什么——

我将所有 div 的背景属性设置为白色。虽然我将地图 div 的背景重置为“无”，但它不起作用。唯一的解决方案是避免任何可能给它一个非“无”背景的定义，例如“div {background-color: white;}”。

但是，您可以随意设置其父标签的背景颜色。

# asp.net - 用参数渲染ascx控件并在asp.net中插入html？

> ID：12734172
> 
> 赞同：0
> 
> 时间：2012-10-04T19:09:07.197
> 
> 标签：asp.net, ascx

如何将 ascx 控件替换为 html 中的字符串标记？

我想创建一个动态 html 模板。

这是我的html

```
<div id="Detail_Container">

   <div>Gallery 1</div>

    <load_gallery>G6</load_gallery>

   <div>Gallery 2</div>

   <load_gallery>G7</load_gallery>

</div> 
```

我对此进行了尝试：控件正在渲染，但我的图像未加载到控件中。

```
 StringBuilder sb = new StringBuilder();
            HtmlTextWriter textWriter = new HtmlTextWriter(new StringWriter(sb));
            UserControl objControl = (UserControl)LoadControl(inControlPath);
            objControl.GalleryId = "G5";

            if (objControl != null)
                objControl.RenderControl(textWriter);

            string controlstr = tw.ToString(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:17:05.413

您不能只将用户控件作为字符串添加到 html，因为它是在服务器上呈现和处理的。但是您可以在您的页面上放置一个占位符，然后将控件添加到此 Palaceholder。

以下是如何在运行时加载和添加用户控件的示例代码：

```
 //here I am loading usercontrol from ascx file...
  WfGenericFormUserControl genControl = (WfGenericFormUserControl)LoadControl("~/UserControls/WfGenericFormUserControl.ascx");

  //FormPlaceHolder is placeholder inside target page
  FormPlaceHolder.Controls.Add(genControl); 
```

GenControl 控件现在将显示在页面上。

# c# - 什么是 C# 相当于 C 中的 strstr()？

> ID：12734174
> 
> 赞同：3
> 
> 时间：2012-10-04T19:09:15.830
> 
> 标签：c#, c

首先，有一个问题标题几乎完全匹配我的问题（[在 C# 中等效的 strstr()](https://stackoverflow.com/questions/3536958/strstr-equivalent-in-c-sharp)），但他指的是一种方法来进行 byte[] 比较版本。

我正在寻找一个字符串比较，它输出 str1 中第一次出现 str2 的索引，但找不到它！

```
string s1 = ("BetYouCantFooFind");
string s2 = ("Foo");

int idx = strstrC#(s1,s2); 
```

肯定有等价物吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-04T19:10:27.353

我想你正在寻找[`IndexOf`](http://msdn.microsoft.com/en-us/library/k8b1470s.aspx)：

```
int idx = s1.IndexOf(s2); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-04T19:11:51.547

```
var s1 = "BetYouCantFooFind";
var s2 = "Foo";
var idx = s1.IndexOf(s2); // Returns -1 if not found 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-04T19:11:24.360

```
 Console.WriteLine("BoboTheClown".IndexOf("boT")); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-06-30T23:49:12.930

我刚刚注意到这篇旧帖子，并想扩展答案。如果您不关心在 C 中使用时的情况，`memicmp`或者以这种方式在 C# 中`stricmp`扩展。`IndexOf`

```
int idx = s1.IndexOf(s2, StringComparison.OrdinalIgnoreCase); 
```

# wix - 有没有办法从 WiX 中的回滚自定义操作启动 Explorer？

> ID：12734175
> 
> 赞同：1
> 
> 时间：2012-10-04T19:09:16.870
> 
> 标签：wix, windows-installer

由于某些依赖关系，我们在部分安装过程中关闭了 Windows 资源管理器。作为紧急安全措施，如果我们失败，我想确保用户有一个外壳。我以为我想做一个带有 'Execute="rollback"' 的 34 类自定义操作，但我似乎不够聪明来制作 CA。

这是我所拥有的：

```
<CustomAction Id="RestartExplorer"     
   ExeCommand="explorer.exe"
   Execute="rollback"
   Impersonate="yes"
   Return="asyncNoWait"/> 
```

我知道我缺少一个目录元素，但我不知道如何指定一种与平台无关的方式来指定 %windir%\system32。使用环境变量或脚本不是一种选择。

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T22:57:31.020

我从来没有在安装过程中试图杀死 Explorer。不是自动重启吗？如果在安装时它重新启动怎么办？

[否则，如果我这样做了，我会使用QuietExec 自定义操作](http://wix.sourceforge.net/manual-wix3/qtexec.htm)启动它。

您还希望在 InstallFinalize 之后立即将其作为自定义操作启动。注意我没有说提交，因为可以禁用回滚并且提交不会执行。

SystemFolder[属性](http://msdn.microsoft.com/en-us/library/windows/desktop/aa372055%28v=vs.85%29.aspx)也是您正在寻找的。确保在 32 位和 64 位机器上进行测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:30:29.780

在我能想到的任何情况下，杀死探险家都是错误的。我没有重新启动资源管理器，而是修复了我们的 shell 扩展中的错误；）谢谢你的帮助

# ruby - 如何在 Mongo/Mongomatic 中进行原子更新？

> ID：12734176
> 
> 赞同：1
> 
> 时间：2012-10-04T19:09:16.510
> 
> 标签：ruby, mongodb

我很难弄清楚如何使用带有 Mongomatic 的原子“$set”运算符来更新 MongoDB 文档。我很确定这是我遇到问题的 Mongo 标准/更新语言，而不是 Mongomatic，但我愿意被证明是错误的。

带有独立、可运行脚本的要点的链接在这里：[https ://gist.github.com/3835672](https://gist.github.com/3835672)

我开始创建一个如下所示的文档：

```
{"videos":[{"video_id":"video1"},{"video_id":"video2"}],"_id":{"$oid": "506ddd53a114604ce3000001"}} 
```

我可以使用使用 Mongomatic 实例化的模型获取该文档：

```
video_group = VideoGroup.find_one('videos.video_id' => 'video1') 
```

然后我试图通过这样做来设置一个“视图”字段：

```
video_group.update!({ 'videos.video_id' => 'video1' }, '$set' => { 'videos.$.views' => 123 }) 
```

这就是 Mongo 爆炸的地方，出现以下错误：

```
can't append to array using string field name [$] 
```

我知道这是 StackOverflow 上一个非常常见的问题。我普遍理解问题是位置运算符没有得到任何匹配。但是，即使阅读了数十条回复，我仍然无法弄清楚如何以一种有效的方式表达这种说法。

我刚开始使用错误的数据结构吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T22:13:17.000

事实上，这是一个单数问题。您需要将选项 {:multi => true} 传递给底层 mongo ruby​​ 驱动程序，并包括您的标准以及发送到 mongodb 的更新的特定 _id，而不是作为可选参数的一部分。看起来像 mongomatic 中的错误。这是我用来找到它的 ruby​​ 调试器记录：[https ://gist.github.com/3836797](https://gist.github.com/3836797)

请注意，我对您发布的文件进行了更改，`debugger`在第 41 行之前添加了一行，并将第 42-44 行更改为：

```
video_group.update!({ 'videos.video_id' => 'video1', :multi => true }, '$set' => {
  'videos.$.views' => 123,
}) 
```

# python - 确定列表是否按降序排列

> ID：12734178
> 
> 赞同：12
> 
> 时间：2012-10-04T19:09:22.347
> 
> 标签：python

我正在尝试编写一个函数来测试列表是否按降序排列。这是我到目前为止所拥有的，但它似乎并不适用于所有列表。

我使用了列表`[9,8,5,1,4,3,2]`，它返回了`'true'`.

我似乎无法弄清楚我的错误在哪里。

```
def ordertest(A):
    n = len(A)
    for i in range(n):
        if A[i] >= A[i+1]:
            return 'true'
        else:
            return 'false' 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-10-04T19:12:16.697

您可以使用[生成器表达式](http://www.youtube.com/watch?v=t85uBptTDYY&list=UUAuqj5Bs5mTTl1mIVDmuAlw&index=1&feature=plcp)和[内置函数轻松完成](http://docs.python.org/release/3.1.5/library/functions.html#all)[此`all()`](http://docs.python.org/release/3.1.5/library/functions.html#all)操作：

```
all(earlier >= later for earlier, later in zip(seq, seq[1:])) 
```

例如：

```
>>> seq = [9, 8, 5, 1, 4, 3, 2] 
>>> all(earlier >= later for earlier, later in zip(seq, seq[1:]))
False
>>> seq = [9, 8, 5, 4, 3, 2] 
>>> all(earlier >= later for earlier, later in zip(seq, seq[1:]))
True 
```

这应该很好而且很快，因为它可以很好地避免 python 端循环、短路（如果你`itertools.izip()`在 2.x 中使用），并且很好、清晰和可读（例如，避免循环遍历索引）。

请注意，所有迭代器（不仅仅是序列）的通用解决方案也是可能的：

```
first, second = itertools.tee(iterable)
next(second)
all(earlier >= later for earlier, later in zip(first, second)) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-04T19:11:19.527

你应该做反向检查（一旦你得到`A[i] < A[i+1]`，返回 false

```
def ordertest(A):
    for i in range( len(A) - 1 ):
        if A[i] < A[i+1]:
            return False
        return True 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-04T19:24:53.773

这是执行此测试的简洁方法，该方法使用`all()`：

```
def ordertest(A):
    return all(A[i] >= A[i+1] for i in range(len(A)-1)) 
```

例子：

```
>>> ordertest([9,8,5,1,4,3,2])
False
>>> ordertest([9,8,5,4,3,2,1])
True 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-10-04T19:12:00.817

我最初建议 using [`sorted`](http://docs.python.org/library/functions.html#sorted)，有人向我指出[它可能](https://stackoverflow.com/questions/12734178/python-function-to-determine-is-a-list-is-in-decending-order#comment17200504_12734223)比您的迭代效率低。

```
>>> l = [3, 1, 2]
>>> l == sorted(l, reverse=True)
False
>>> l = [3, 2, 1]
>>> l == sorted(l, reverse=True)
True 
```

所以我[对接受的答案进行了](https://stackoverflow.com/a/12734211/722332)基准测试，我的，[Lattyware 的生成器解决方案](https://stackoverflow.com/a/12734228/722332)，和[`itertools.izip`](http://docs.python.org/library/itertools.html#itertools.izip). 我特意使用了一个我认为有利于我的`sorted`解决方案的案例：一个仅在最后无序的列表。这些基准测试是在旧 OpenBSD 机器上的 Python 2.7.1 上执行的。

**排序的.py**

```
import time
l = list(reversed(range(99998) + [99999, 99998]))
start = time.time()
for count in range(100):
    l == sorted(l)
end = time.time()
print('elapsed: {}'.format(end - start)) 
```

**步行.py**

```
import time
def ordertest(l):
    for i in range(len(l) - 1):
        if l[i] < l[i+1]:
            return False
    return True
l = list(reversed(range(99998) + [99999, 99998]))
start = time.time()
for count in range(100):
    ordertest(l)
end = time.time()
print('elapsed: {}'.format(end - start)) 
```

**生成器.py**

```
import time
l = list(reversed(range(99998) + [99999, 99998]))
start = time.time()
for count in range(100):
    all(earlier >= later for earlier, later in zip(l, l[1:]))
end = time.time()
print('elapsed: {}'.format(end - start)) 
```

**压缩包**

```
import itertools
import time
l = list(reversed(range(99998) + [99999, 99998]))
start = time.time()
for count in range(100):
    all(earlier >= later for earlier, later in itertools.izip(l, l[1:]))
end = time.time()
print('elapsed: {}'.format(end - start)) 
```

结果：

```
$ python sorted.py
elapsed: 1.0896859169
$ python walk.py
elapsed: 0.641126155853
$ python generator.py
elapsed: 4.79061508179
$ python izip.py
elapsed: 0.363445997238 
```

正如对此答案的评论中所指出的那样，生成器表达式可能会通过`zip`制作列表的副本而变慢。使用`izip`节拍所有。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-10-04T19:13:34.980

您可以迭代输入，而不是使用索引：

```
def ordertest(iterable):
    it = iter(iterable)
    prev = next(it)
    for e in it:
        if e > prev:
            return False
        prev = e
    return True 
```

请注意，返回字符串`'true'`和`'false'`. 相反，您可以使用 Python 的内置[booleans](http://docs.python.org/library/stdtypes.html#boolean-values)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-04T19:11:44.670

你想做的是

```
n=len(A)
for i in range(n - 1):
    if A[i]<=A[i+1]:
        return 'false'
return 'true 
```

尝试在你的脑海中执行你的代码。在第一次迭代中，如果 A[i] 大于 A[i + 1] 则返回 true，否则返回 false。你永远不会在你的名单上走得更远。

好的解决方案是测试您的状况，如果随时为假，则返回假。但如果它是正确的，这并不意味着列表的其余部分是，并且您想要测试您的每个值。

当你测试 A[i + 1] 时，你不想在列表的末尾，而是在`n - 1`它的项目。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-09-05T04:58:11.507

```
n=len(l)
c=0
for i in range(n - 1):
    if l[i]<l[i+1]:
        c+=1
    if c==1:
        break
if(c==1):
    return False
return True 
```

要检查没有任何错误并检查是否太正确，最好使用计数器进行此功能。一旦循环运行并且迭代变为 1，它就不再需要搜索了。它将返回 false 否则为 true。谢谢！

# c# - 将计时器添加到 Kinect Click 函数 C#

> ID：12734182
> 
> 赞同：0
> 
> 时间：2012-10-04T19:09:36.000
> 
> 标签：c#, kinect

我在不使用任何手势的情况下为 Kinect 创建了一个点击功能.. 它很简单而且可以工作.. 但是我希望该功能等待.. 我的计数器似乎没有工作.. 我想要做的是.. 如果我的手在按钮上让我们说超过 3 秒.. 然后返回 true .. 有什么方法可以做到吗？计数器似乎不起作用

```
 public bool KinectClick(int x,int y)
            {

                if ((x >= position.X && x <= position.X +position.Width) && (y >= position.Y && y <= position.Y + position.Height))
               {
                 //  time.Start();
                   int counter = 0;

                   while (true)
                   {
                       counter++;

                       if (counter >= 8000)
                       {
                           return true;
                           counter = 0;

                       }
                   }

               } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:21:24.290

我使用 DispatcherTimer 来完成你想要做的同样的事情。一个简单的表格可能看起来像这样：

```
private DispatcherTimer hitTestTimer = new DispatcherTimer();
private int timerCount = 5;

public MyConstructor() {
  hitTestTimer.Tick += OnHitTestTimerTick;
  hitTestTimer.Interval = new TimeSpan(0, 0, 1);
}

private void OnHitTestTimerTick(object sender, EventArgs e)
{
  if (timerCount > 1)
  {
    timerCount--;
  }
  else
  {
    // CLICK!
  }
} 
```

您可以添加在您首次进入对象时切换的标志，并检查以验证自上次计时器滴答以来您是否（或尚未）离开该对象。

# javascript - 确定两个日期之间经过的时间

> ID：12734184
> 
> 赞同：1
> 
> 时间：2012-10-04T19:09:41.173
> 
> 标签：javascript

我正在尝试使用 javascript 确定两个日期之间经过的时间。例如：“我在 2008 年 1 月 5 日凌晨 3 点戒烟，我戒烟已经过去了多少年、几个月和几小时？”。

所以我的想法是：

1.  获取“退出”日期
2.  获取当前日期
3.  转换为时间（毫秒）
4.  找出差异
5.  使用差异创建新日期
6.  从该日期提取年、月等

好吧，它表现得很奇怪，我无法指出原因。有什么见解吗？

```
//create custom test date
var d1 = new Date(2012, 8, 28, 13, 14, 0, 0);
//create current date
var d2 = new Date();
//get date times (ms)
var d1Time = (d1.getTime());
var d2Time = (d2.getTime());
//calculate the difference in date times
var diff = d2 - d1;
//create a new date using the time differences (starts at Jan 1, 1970)
var dDiff = new Date();
dDiff.setTime(diff);
//chop off 1970 and get year, month, day, and hour
var years = dDiff.getFullYear() - 1970;
var months = dDiff.getMonth();
var days = dDiff.getDate();
var hours = dDiff.getHours(); 
```

[您可以在这个临时主机](http://pastehtml.com/view/cdu6voso4.html)上看到它的运行情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:26:03.313

这将不准确，因为它没有考虑闰日。除此之外，它工作正常，我没有看到任何问题。时差约为6.5天。考虑到时区和 0 是 1 月 1 日这一事实，我看到的值符合预期。

准确的解决方案是

*   将时差转换为天
*   减去自指定日期以来经过的闰年数
*   剩下的除以 365 得到天数
*   创建一个包含每个月的天数的数组（不考虑闰日）并循环遍历经过的月份，减去已完成月份的天数。迭代次数将是您的月数
*   剩下的就是你的天数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:12:37.640

你为什么不只是做数学来计算值？你在 Date 中输入的`dDiff.setTime(diff);`内容对你来说毫无意义。这只是给你`diff`从纪元开始的日期毫秒。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T19:33:37.677

各种注释：

*   `new Date(2012, 8, 28, 13, 14, 0, 0);`是 2012 年 9 月 28 日 13:14:00（如果你愿意，不是 8 月）
*   `new Date(0)`由于使用夏令时的做法，返回值不是常数。
*   `dDiff.getMonth();`1 月返回 0，2 月返回 1，以此类推。
*   日期的开始（1970 年 1 月 1 日）以差异开头，`1`因此您应该减去它。

我认为第二点是你的错误。

根据你的算法，试试这个：

```
// create date in UTC
//create custom test date
var dlocaltime = new Date(2012, 8, 28, 13, 14, 0, 0);
var d1 = new Date(dlocaltime.getUTCFullYear(),dlocaltime.getUTCMonth(), dlocaltime.getUTCDate(), dlocaltime.getUTCHours(),dlocaltime.getUTCMinutes(),dlocaltime.getUTCSeconds());
//create current date
var now = new Date();
var d2 = new Date(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate(),  now.getUTCHours(), now.getUTCMinutes(), now.getUTCSeconds());
console.log(d1);
console.log(d2);
//get date times (ms)
var d1Time = (d1.getTime());
var d2Time = (d2.getTime());

//calculate the difference in date times
var diff = d2 - d1;
//create a new date using the time differences (starts at Jan 1, 1970)
var dDiff = new Date();
dDiff.setTime(diff);
//chop off 1970 and get year, month, day, and hour
var years = dDiff.getUTCFullYear() - 1970;
var months = dDiff.getUTCMonth();
var days = dDiff.getUTCDate()-1; // the date of new Date(0) begin with 1 
var hours = dDiff.getUTCHours();
var minutes = dDiff.getUTCMinutes();
var seconds = dDiff.getUTCSeconds();
console.log("Years:"+years);
console.log("months:"+months);
console.log("days:"+days);
console.log("hours:"+hours);
console.log("minutes:"+minutes);
console.log("seconds:"+seconds); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T19:17:32.860

更改部分代码可能会解决您的问题。[jsfiddle](http://jsfiddle.net/NkKpP/)

```
var start = new Date(0); // pivote point of date.
var years = dDiff.getFullYear() - start.getFullYear();
var months = dDiff.getMonth() -  start.getMonth();
var days = dDiff.getDate() -  start.getDate();
var hours = dDiff.getHours() - start.getHours();;
console.log(years, months, days, hours);​ 
```

但是你必须根据那里的价值来操纵这些价值（它们可能是负面的）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-04T19:17:38.970

`Date`表示一个特定的时间点，而不是两个日期之间的时间跨度。`dDiff`您正在通过设置自 unix 纪元以来经过的毫秒数来创建新日期。

一旦经过了几毫秒，就应该通过除法来提取所需的信息。[看到这个问题](https://stackoverflow.com/questions/8211744/convert-milliseconds-or-seconds-into-human-readable-form)。

我可以推荐看看[Moment.js](http://momentjs.com/)吗？

# c# - 找到字符串后拆分大型 XML 文件

> ID：12734191
> 
> 赞同：2
> 
> 时间：2012-10-04T19:10:06.940
> 
> 标签：c#, xml, string

是）我有的：

一个大型 XML 文件，内容价值近 100 万行。内容示例：

```
<etc35yh3 etc="numbers" etc234="a" etc345="date"><something><some more something></some more something></something></etc123>
<etc123 etc="numbers" etc234="a" etc345="date"><something><some more something></some more something></something></etc123>
<etc15y etc="numbers" etc234="a" etc345="date"><something><some more something></some more something></something></etc123> 
```

^ 重复 900k 左右行（内容当然会改变）

我需要的：

在 XML 文件中搜索`"<etc123"`. 一旦找到，将该行连同它下面的所有行一起移动（写入）到一个单独的 XML 文件中。

是否建议对搜索部分使用诸如 File.ReadAllLines 之类的方法？对于写作部分，你们会推荐什么。据我所知，逐行不是一种选择，因为它需要很长时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T19:21:19.870

为了完全放弃搜索字符串上方的内容，我不会使用 File.ReadAllLines，因为它会将整个文件加载到内存中。尝试 File.Open 并将其包装在 StreamReader 中。在 StreamReader.ReadLine 上循环，然后开始写入新的 StreamWriter，或者对底层文件流进行字节复制。

下面列出了如何单独使用 StreamWriter/StreamReader 的示例。

```
//load the input file
//open with read and sharing
using (FileStream fsInput = new FileStream("input.txt", 
    FileMode.Open, FileAccess.Read, FileShare.Read)) 
{
    //use streamreader to search for start
    var srInput = new StreamReader(fsInput);
    string searchString = "two";
    string cSearch = null;
    bool found = false;
    while ((cSearch = srInput.ReadLine()) != null)
    {
        if (cSearch.StartsWith(searchString, StringComparison.CurrentCultureIgnoreCase)
        {
            found = true;
            break;
        }
    }
    if (!found)
        throw new Exception("Searched string not found.");

    //we have the data, write to a new file
    using (StreamWriter sw = new StreamWriter(
        new FileStream("out.txt", FileMode.OpenOrCreate, //create or overwrite
            FileAccess.Write, FileShare.None))) // write only, no sharing
    {
        //write the line that we found in the search
        sw.WriteLine(cSearch);

        string cline = null;
        while ((cline = srInput.ReadLine()) != null)
            sw.WriteLine(cline);
    }
}

//both files are closed and complete 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T19:20:36.830

您可以使用 LINQ2XML 进行复制

```
XElement doc=XElement.Load("yourXML.xml");
XDocument newDoc=new XDocument();

foreach(XElement elm in doc.DescendantsAndSelf("etc123"))
{
newDoc.Add(elm);
}

newDoc.Save("yourOutputXML.xml"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T19:27:31.617

你可以一次做一行......如果检查每一行的内容，则不会使用 read 来结束。

```
FileInfo file = new FileInfo("MyHugeXML.xml");
FileInfo outFile = new FileInfo("ResultFile.xml");

using(FileStream write = outFile.Create())
using(StreamReader sr = file.OpenRead())
{
    bool foundit = false;
    string line;
    while((line = sr.ReadLine()) != null)
    {
        if(foundit)
        {
            write.WriteLine(line);
        }
        else if (line.Contains("<etc123"))
        {
            foundit = true;
        }
    }
} 
```

请注意，根据您的要求，此方法可能无法生成有效的 XML。

# php - 试图通过 ob_start 和 ob_end_clean 抑制邮件库回声

> ID：12734195
> 
> 赞同：0
> 
> 时间：2012-10-04T19:10:23.390
> 
> 标签：php

REF：[PHP：抑制函数内的输出？](https://stackoverflow.com/questions/486181/php-suppress-output-within-a-function)

使用上面链接中建议的方法，我试图抑制 PHPMAILER 中邮件功能的输出。但似乎它抑制了邮件本身。通过邮件库抑制回声的替代方法是什么，以便可以实现单个 echo $returnValue ？

```
ob_start();
    include('mail.php');   //<< USING PHPMAILER 
ob_end_clean();

echo $returnValue 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:13:09.150

ob_end_clean 丢弃任何被缓冲的东西。如果要输出缓冲区中捕获的内容，则需要

```
$output = ob_get_clean();
echo $output; 
```

话虽如此，输出缓冲不会影响发送电子邮件，因为这纯粹是在后台完成的，不受缓冲的影响。ob_*() 缓冲仅捕获脚本的输出，例如来自 echo/print 调用的任何内容。mail() 本身不使用其中任何一个来生成/发送邮件。

# php - 无法仅使用大附件实例化邮件功能

> ID：12734197
> 
> 赞同：0
> 
> 时间：2012-10-04T19:10:31.517
> 
> 标签：php, phpmailer

我的 PHPMailer 类有问题。有一个带有文件上传功能的表单。文件上传正常，没有错误。但我从脚本中得到以下输出：

> 无法实例化邮件功能。无法向*** @ *** .com发送消息

这只发生在超过几兆字节的附件中。我的 php.ini 配置很好：

> post_max_size = 50M
> 
> upload_max_filesize = 50M

当我得到这个值低于实际上传大小时，页面就会刷新，没有任何反应。使用以下值，文件被上传并存储在临时文件夹中，但不能作为附件发送。

任何帮助将不胜感激

PS 我可以毫无问题地发送带有 1 MB 附件的电子邮件

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T19:26:32.267

好的，回答我自己的问题。很抱歉浪费了任何人的时间。首先，查看 /var/log/mail.log 发现了这一行

> 10 月 4 日 20:15:39 s16271040 postfix/sendmail[13663]：致命： ***@*** .com(33)：消息文件太大

现在这更有意义了。

我们转到 /etc/postfix/main.cf 并将以下行添加到文件末尾

> message_size_limit = 20480000

我们对文件附件有 20MB 的限制，万岁 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-26T15:25:13.200

我遇到了类似的问题，即 exim 拒绝大于 ~700KB 的电子邮件。

您不能总是在共享服务器上编辑邮件配置文件。我使用的解决方案是使用我的 ISP 的 SMTP 服务器来发送电子邮件。

1) 创建一个电子邮件地址或使用现有的电子邮件地址并记下所有设置，包括：

*   SMTP 服务器主机名和端口
*   是否需要身份验证才能发送电子邮件
*   如果上述情况属实，则提供凭据

2）不要乱`class-phpmailer.php`用一个名为“WP Mail SMTP”的wordpress插件，它：

> 重新配置`wp_mail()`功能以使用 SMTP 而不是`mail()`并创建一个选项页面来管理设置。

安装插件后，在插件设置页面中输入步骤 1 中的信息。

# ruby - 我如何知道我的 Facebook 应用程序是否已被我不认识的其他管理员安装到某个页面？

> ID：12734205
> 
> 赞同：0
> 
> 时间：2012-10-04T19:10:56.017
> 
> 标签：ruby, facebook, facebook-graph-api, facebook-opengraph, facebook-apps

我让用户使用 FB.ui（方法 => 'page_tab'）在他们的粉丝页面上安装我的应用程序。

当他们安装它时，我调用 OpenGraph 来检索已安装应用程序的每个页面的元数据 (graph.facebook.com/{page_id})。这给了我一个属性“has_added_app”，通过它我知道哪些页面安装了我的应用程序。

问题是：如果同一页面的另一个管理员（不是我的用户）在同一页面中安装了该应用程序......我怎么知道？'has_added_app' 标志会设置为 true 吗？

在这种情况下，它会产生误导，因为我的用户没有“has_added_app”（它是另一个用户）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:21:47.517

为什么需要这样检查？在`signed_request`页面选项卡应用程序的每个页面加载时发送到您的应用程序将包含`page`对象中的页面 ID - 除非页面没有人访问选项卡，否则您将能够快速构建安装应用程序的页面列表

# asp.net-mvc - 来自数据库的 ASP.NET MVC 多级菜单

> ID：12734208
> 
> 赞同：0
> 
> 时间：2012-10-04T19:11:07.610
> 
> 标签：asp.net-mvc, linq, razor

我有一个名为 Categories 的表，它包含以下字段： Id | 姓名 | ParentId //父id实际上是一个自引用

所以从 _Layout.cshtml 调用名为 MainMenu.cshtml 的局部视图

_Layout.cshtml

```
 @Html.Partial("MainMenu") 
```

我怎样才能将模型发送到主菜单，我知道部分过载，我也可以发送模型。我试图以一种不破坏 MVC 架构的优雅方式解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:53:22.613

我猜每个页面的菜单没有什么不同，那么为什么在每个视图中调用 partial 并将 MenuModel 传递给每个视图呢？

相反，使用`@Html.Action("Menu")`.

有一个从数据库中检索菜单项的操作。使用实体框架，您可以在数据库中拥有以下类：

```
public class MenuModel{
public List<MenuItemModel> Items{get;set;}
}

public class MenuItemModel{
public int Id {get;set;}
public string Name {get;set;}
// If there are no childs the object will be null.
public List<MenuItemModel> Childs {get;set;}
} 
```

您检索该类，然后将其传递给 HtmlHelper 扩展方法，或者只是 cshtml 文件中检索 MenuModel 对象并显示它的辅助函数。

使用**递归函数**的逻辑很简单：打印当前项目。如果有孩子 -> 为内部项目创建一个表/容器，并在容器内部为每个子函数调用相同的函数。

# c# - .NET 服务容器没有序列化

> ID：12734209
> 
> 赞同：-1
> 
> 时间：2012-10-04T19:11:09.270
> 
> 标签：c#, .net, wcf

我正在寻找 .NET 的框架/容器，它将允许我在运行时创建、使用服务（从这个词的真正意义上 - 不是“Web”服务），所有调用和数据传输都在 .NET 中 - 没有序列化为 SOAP 或通过 HTTP（即像 WCF 一样）。

外面有这样的东西吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:53:52.437

如果您尝试将数据传输到当前正在执行的 AppDomain 之外，则会进行某种序列化，但您可以控制它是什么。

WCF 允许二进制、SOAP 和自定义序列化程序。就通信方式而言，您仍然有很多选择，WCF 将原生支持命名管道、TCP、HTTP 以及自定义选项。如果您在单台机器上运行，Named Pipes 可能符合您的要求，因为它使用可以产生高吞吐量、低延迟 IPC 的共享内存。

但是，如果您不需要分离 AppDomain，请考虑使用 IOC 容器，例如 Unity ( [http://msdn.microsoft.com/en-us/library/dd203104.aspx](http://msdn.microsoft.com/en-us/library/dd203104.aspx) ) 或任何其他选项：[https： //stackoverflow.com/questions/2515124/whats-the-simplest-ioc-container-for-c](https://stackoverflow.com/questions/2515124/whats-the-simplest-ioc-container-for-c)。IOC 容器将让您实例化您的“服务”并在不知道如何实例化对象的情况下调用它。它可以提供 WCF 和其他 Web 服务所必需的一些相同的解耦优势。

tl; dr：如果使用两个进程，总会有序列化。尝试 IOC 以避免这种性能损失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T19:16:44.950

WCF 并不限制您使用 SOAP over HTTP——这是一个常见的误解。您可以将 WCF 与许多不同的底层[端点](http://en.wikipedia.org/wiki/Windows_Communication_Foundation#endpoints)一起使用。

WCF 是几乎每个人都使用这种类型的东西的方式——无论是那个还是 .NET Remoting，但是你不会再看到很多 .NET Remoting 了。

# android - 如何在首选项中使用 QuietlyCoding 中的 NumberPicker？

> ID：12734221
> 
> 赞同：0
> 
> 时间：2012-10-04T19:11:56.563
> 
> 标签：android, dialog

我正在尝试使用 QuietlyCoding NumberPicker，因为我没有找到任何其他但我无法让它工作。我将库作为项目导入，然后将其添加到我的项目中：

**偏好活动：**

```
public class MainPrefs extends PreferenceActivity{

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        PreferenceManager preferenceManager = getPreferenceManager();
        preferenceManager.setSharedPreferencesMode(MODE_PRIVATE);
        preferenceManager.setSharedPreferencesName("numberPicker.preferences");

        this.addPreferencesFromResource(R.xml.main_preferences);

        this.findPreference("SMSSentLimit").setOnPreferenceChangeListener(new OnPreferenceChangeListener(){
            @Override
            public boolean onPreferenceChange(Preference preference, Object newValue) {
                TrackerService.updateStats(Long.decode(newValue.toString()));
                return true;
            }
        });
    }

} 
```

**main_preference.xml**

```
<PreferenceCategory android:title="General" >
    <EditTextPreference
        android:defaultValue="0"
        android:title="@string/SMSSentLimitTitle"
        android:key="SMSSentLimit"
        android:summary="@string/SMSSentLimitSummary" 
        android:inputType="number" />
    <com.michaelnovakjr.numberpicker.NumberPickerPreference
        android:key="demo.preference"
        android:title="Sample Number Picker"
        android:summary="Number picker as a preference"
        picker:defaultValue="15"
        picker:startRange="-50"
        picker:endRange="50" />
</PreferenceCategory> 
```

我不能以这种方式编译我的项目，要编译我的项目，我必须以这种方式编辑我的 .xml：

```
 <com.michaelnovakjr.numberpicker.NumberPickerPreference
        android:key="demo.preference"
        android:title="Sample Number Picker"
        android:summary="Number picker as a preference" /> 
```

删除 defaultValue、startRange 和 endRange，这样我的项目就被编译了，我可以看到我的偏好，但是当我点击它时，我会强制关闭，因为我没有定义这些值。为什么我可以添加这个值？有人在这个图书馆工作过吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:34:28.847

您需要在首选项 xml 文件的顶层添加库属性的架构。它应该看起来像这样 - 第二/第三行是重要的。

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:picker="http://schemas.android.com/apk/res/[com.yourpackagename]">
    <PreferenceCategory android:title="General" >
        <EditTextPreference
            android:defaultValue="0"
            android:title="@string/SMSSentLimitTitle"
            android:key="SMSSentLimit"
            android:summary="@string/SMSSentLimitSummary" 
            android:inputType="number" />
        <com.michaelnovakjr.numberpicker.NumberPickerPreference
            android:key="demo.preference"
            android:title="Sample Number Picker"
            android:summary="Number picker as a preference"
            picker:defaultValue="15"
            picker:startRange="-50"
            picker:endRange="50" />
    </PreferenceCategory>
</PreferenceScreen> 
```

# html - 没有表格布局的表格的液体调整大小行为：已修复？

> ID：12734222
> 
> 赞同：3
> 
> 时间：2012-10-04T19:11:59.210
> 
> 标签：html, css, html-table, ellipsis

对于我无法解决的一些风格问题，我真的可以使用一些帮助：

**设想：**

在 Web 应用程序中，我有一个表格，可以显示条目列表。其中两列可以占用更长的内容，使用“overflow:hidden;”和应用“text-overflow:ellipsis”将其截断以显示。所有表格单元格的内容都包含在跨度中，以便我可以在填充表格时应用动画。一切都好。

现在我想将表格布局从以前的固定样式更改为更具流动性的行为。

在我为表格列设置固定宽度之前。对于除两列之外的所有列，我保持固定宽度，即使对于省略号样式的切分列之一也是如此。另一个获得 100% 的宽度，以便表格占用整个可用容器，从而提供液体样式（“始终使用整个屏幕”）。该列显示其内容以及一些用于根据需要填充的空格。

**期望的行为：**

我希望当窗口大小减小时表格会缩小。这显然应该通过将列的宽度设置为 100% 来实现，因为它是唯一没有固定长度的列。该部分仅在单元格内容适合时才起作用。一旦窗口变窄，内容*不再*适合，浏览器就会应用滚动条。这不是我想要的。相反，我希望省略号样式规则切割单元格内容，以便表格实际上变得更小，可能达到最小宽度。

**测试用例：**

HTML：

```
<div>
<table>
<tr>
  <td class="c1"><span class="ellipsis">Alfreds Futterkiste</span></td>
  <td class="c2"><span class="ellipsis">Maria Anders</span></td>
  <td class="c3"><span class="ellipsis">Germany</span></td>
</tr>
<tr>
  <td class="c1"><span class="ellipsis">Laughing Bacchus Winecellars</span></td>
  <td class="c2"><span class="ellipsis">Yoshi Tannamuri</span></td>
  <td class="c3"><span class="ellipsis">Canada</span></td>
</tr>
<tr class="alt">
  <td class="c1"><span class="ellipsis">Königlich Essen</span></td>
  <td class="c2"><span class="ellipsis">Philip Cramer</span></td>
  <td class="c3"><span class="ellipsis">Germany</span></td>
</tr>
</table>
</div>​ 
```

CSS：

```
table{table-layout:fixed;width:100%;border:solid gray 1px;}
/*table{table-layout:auto;width:100%;border:solid gray 1px;}*/
tr{}
td{}
td.c1{width:100%;}
td.c2{width:6em;}
td.c3{width:4em;}

/* formatting the clipped output */
.ellipsis{display:block;overflow:hidden;white-space:nowrap;text-overflow: ellipsis;width:inherit;}

/* just for the test case */
div{display:block;width:90%;margin:1em;background-color:silver;}
span{padding:2px;width:inherit;} 
```

我为你准备了一个测试用例的小提琴供你玩：http: [//jsfiddle.net/UgYFs/3/](http://jsfiddle.net/UgYFs/3/)

当您减小窗口宽度（或左下角“结果”隔间的宽度）时，您可以看到事情是如何工作的。这是我想要的行为。

**问题：（**因此这个问题......）

这仅适用于“table-layout:fixed;”。有一定道理，但是有一些原因使此选项不可用：在实际应用程序中，表行是动态插入的。这不适用于固定布局，至少光学结果完全不同（这也是有道理的）。因此，无论我喜欢与否，我*认为*我必须使用“table-style:table”（默认值）。您可以通过取消注释第二行来切换到 CSS 隔间中的那个，从而更改表格布局。您会看到行为发生了变化。

**我的问题：**

有没有办法将两者结合起来：

*   获得所描述和演示的所需行为
*   在没有固定布局的情况下填充表格（可能稍后切换布局）？

直到现在我都没有成功。但我只是所有这些时尚网络东西的血腥初学者......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T10:21:32.777

是的，因为没有人知道我尝试了一种不同的方法来解决我所问的问题。我想结束这个问题，所以我发布了结果，即使它不是我在这里提出的问题的解决方案......

我成功地修改了应用程序的其余部分，即使`table-layout: fixed;`设置了表格，表格的归档方式也可以动态工作。这允许我使用标准的 css 表格规则来保持该单列的宽度灵活，但长度仍然有限​​，因为现在整个表格的宽度可以从容器中派生。

# vim - Vim 中的多选

> ID：12734233
> 
> 赞同：14
> 
> 时间：2012-10-04T19:12:31.267
> 
> 标签：vim, sublimetext2

我可以`Vim`在`Sublime text 2`命令中选择多个相同的单词`ctrl+D`，然后编辑选定的单词吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-12-23T22:51:39.907

是的！看看这个：[vim-multiple-cursors](https://github.com/terryma/vim-multiple-cursors)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T19:14:52.847

不，你不能，但[有人正在努力](http://www.reddit.com/r/vim/comments/10xn0m/markmultiple_for_vim_didnt_exist_so_ive_created_it/)。

# macos - Bash“如果 ping 然后其他”我的其他不起作用

> ID：12734238
> 
> 赞同：1
> 
> 时间：2012-10-04T19:12:53.173
> 
> 标签：macos, bash

我有一个 bash 脚本，它应该根据我是否可以 ping 我的网络地址来工作。在某些情况下，此脚本在我的网络之外运行，在这种情况下，我不希望它运行。所以我把这个放在一起

```
if ping -c 1 xxx.xxx.x.x > /dev/null; then 
```

当它在网络中时，“then”语句工作得很好。但是，每当我关闭无线网卡并断开以太网电缆以测试“else”时，我的 else 语句永远不会被执行。我应该用另一种方式来写这个吗？

这是完整的脚本；

```
#!/bin/bash

computerid=`/usr/sbin/scutil --get LocalHostName`

# Standard parameters
domain="xxx.xxxxxxx.xxx"                            # fully qualified DNS name of Active Directory Domain
udn="xxxxxx"                                            # username of a privileged network user
password="xxxxxx"                                           # password of a privileged network user
ou="OU=MacOS,DC=xxx,DC=xxxxxxx,DC=xxx"              # Distinguished name of container for the computer

# Advanced options
alldomains="enable"                 # 'enable' or 'disable' automatic multi-domain authentication
localhome="enable"                  # 'enable' or 'disable' force home directory to local drive
protocol="smb"                              # 'afp' or 'smb' change how home is mounted from server
mobile="enable"                         # 'enable' or 'disable' mobile account support for offline logon
mobileconfirm="disable"             # 'enable' or 'disable' warn the user that a mobile acct will be created
useuncpath="enable"                 # 'enable' or 'disable' use AD SMBHome attribute to determine the home dir
user_shell="/bin/bash"              # e.g., /bin/bash or "none"
preferred="-preferred xxx.xxxxxx.xxx"       # Use the specified server for all Directory lookups and authentication
# (e.g. "-nopreferred" or "-preferred ad.server.edu")
admingroups="xxx\domain admins,xxx\enterprise admins,xxx\teacher98,xxx\ADManagement - Computers,xxx\admin employees"        # These comma-separated AD groups may administer the machine (e.g. "" or "APPLE\mac admins")

### End of configuration

# Delay the login window by unloading the com.apple.loginwindow
# LaunchDaemon in /System/Library/LaunchDaemons/

launchctl unload -w /System/Library/LaunchDaemons/com.apple.loginwindow.plist

## Wait until all network services are up.
sleep 10

# Check to see if we're in the district
if ping -c 1 xxx.xxx.x.x > /dev/null; then

    #make sure time is set correctly
    ntpdate -u time.xxxxxxx.xxx

    # Activate the AD plugin
    defaults write /Library/Preferences/DirectoryService/DirectoryService "Active Directory" "Active"
    plutil -convert xml1 /Library/Preferences/DirectoryService/DirectoryService.plist
    sleep 5

    # Remove computer from OU
    dsconfigad -f -r -u xxxxxx -p xxxxxx
    sleep 5

    # Bind to AD
    dsconfigad -f -a $computerid -domain $domain -u $udn -p "$password" -ou "$ou"

    # Configure advanced AD plugin options
    if [ "$admingroups" = "" ]; then
        dsconfigad -nogroups
    else
        dsconfigad -groups "$admingroups"
    fi

    dsconfigad -alldomains $alldomains -localhome $localhome -protocol $protocol \
        -mobile $mobile -mobileconfirm $mobileconfirm -useuncpath $useuncpath \
        -shell $user_shell $preferred

    # Restart DirectoryService (necessary to reload AD plugin activation settings)
    killall DirectoryService

    # Add the AD node to the search path
    if [ "$alldomains" = "enable" ]; then
        csp="/Active Directory/All Domains"
    else
        csp="/Active Directory/$domain"
    fi

    # This works in a pinch if the above code does not
    defaults write /Library/Preferences/DirectoryService/SearchNodeConfig "Search Node Custom Path Array" -array "/Active Directory/All Domains"
    defaults write /Library/Preferences/DirectoryService/SearchNodeConfig "Search Policy" -int 4
    defaults write /Library/Preferences/DirectoryService/ContactsNodeConfig "Search Node Custom Path Array" -array "/Active Directory/All Domains"
    defaults write /Library/Preferences/DirectoryService/ContactsNodeConfig "Search Policy" -int 4

    plutil -convert xml1 /Library/Preferences/DirectoryService/SearchNodeConfig.plist

    ## Remove the script and launchd job. Be sure to delete the script. 
    rm /Library/LaunchDaemons/com.xxxx.adbind.plist
    rm /usr/local/bin/adbind.bash
    launchctl unload -w /Library/LaunchDaemons/com.xxxx.adbind.plist

    # Remove the loginwindow delay by loading the com.apple.loginwindow   
    # LaunchDaemon in /System/Library/LaunchDaemons/

    launchctl load -wF /System/Library/LaunchDaemons/com.apple.loginwindow.plist

    exit 0

else

    echo "District not Available Quitting"

    # Remove the loginwindow delay by loading the com.apple.loginwindow   
    # LaunchDaemon in /System/Library/LaunchDaemons/

    launchctl load -wF /System/Library/LaunchDaemons/com.apple.loginwindow.plist

fi

exit 1 
```

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:24:41.553

您可能需要使用超时 (-W) `man ping`

# javascript - 为什么这个 JavaScript 函数不会触发？

> ID：12734249
> 
> 赞同：2
> 
> 时间：2012-10-04T19:13:35.040
> 
> 标签：javascript

我写了一个小哈希更改对象，它会在更改时提醒 url 哈希：

```
(function() {

    function hashChange() {
        this.previousHash;
        this.initialize();
    }

    hashChange.prototype.initialize = function() {
        this.setInterval = window.setInterval(this.checkHashChange, 0);
    }

    hasChange.prototype.uponHashChange = function(hash) {
        alert('I executed!');
        var hashValue = hash.split('#')[1];
        alert(hashValue);
    }

    hashChange.prototype.checkHashChange = function() {
        var hash = window.location.hash;
        if(hash && hash !== this.previousHash) {
            this.previousHash = hash;
            this.uponHashChange(hash); // <---- doesn't execute
        }
    }

    var hashChange = new hashChange();

})(); 
```

但是这个：

```
this.uponHashChange(hash); 
```

永远不会被处决。为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T19:18:43.263

```
this.setInterval = window.setInterval(this.checkHashChange, 0); 
```

这条线不会完全按照你的意思做。`this.checkHashChange`将失去其与其当前`this`（将是一个`hashChange`实例）的绑定，而是将在`window`对象的上下文中调用。

您需要将其显式绑定到正确的上下文对象：

```
var self = this;
this.setInterval = window.setInterval(function() { self.checkHashChange() }, 0); 
```

Matt Greer 建议`Function.bind`，这将使它更简洁并且可能更具可读性：

```
this.setInterval = window.setInterval(checkHashChange.bind(this), 0); 
```

不幸的是，`Function.bind`尚未在浏览器中得到广泛支持。

# ruby - 方法中变量引用的简单 Ruby 谜题

> ID：12734258
> 
> 赞同：1
> 
> 时间：2012-10-04T19:14:24.340
> 
> 标签：ruby

为什么这个方法返回 1 而不是死于无限递归？

```
def foo
  foo ||= 1
end

foo # => 1 
```

重写了以下方式它确实死了：

```
def foo
  foo.nil? ? 1 : foo
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T19:15:25.673

在第一种情况下，`foo ||= 1`指的是局部变量。当您对裸字进行赋值时，Ruby 总是会创建一个局部变量，这就是为什么`self.foo = ...`如果您想调用定义为`def foo=(value)`. `||=`毕竟，运算符只是一个花哨的赋值运算符。

在第二种情况下，没有赋值，所以当它命中时`foo.nil?`，Ruby 将裸词解释`foo`为方法调用，然后就崩溃了。

# .net - .NET 对象创建是“从无到有”吗？

> ID：12734263
> 
> 赞同：11
> 
> 时间：2012-10-04T19:14:47.210
> 
> 标签：.net

我正在阅读[基于原型的](http://en.wikipedia.org/wiki/Prototype-based)语言，我想到了这个疑问：

.NET Object Creation *ex nihilo*（“从无到有”）是否允许从头开始创建新对象？或者，.NET 对象创建是基于从现有对象（即[Object](http://msdn.microsoft.com/en-us/library/system.object.aspx)）的克隆作为新对象创建的克隆原型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:20:04.680

.Net 中最基本的对象没有用户数据，只有一些内部平台有关其类型和实际数据在内存中位置的信息。从用户（开发人员）的角度来看，他们“只是存在”，他们只是在“身份”上有所不同。他们的课程不能以任何方式扩展。我认为克隆任何东西没有任何意义。

更复杂的对象是从某物派生出来的，最终是从基础对象派生出来的。.Net 中没有复制构造和深度复制语义，因此在非基本对象级别，克隆任何东西仍然没有意义。

在元数据级别，每个对象都携带有关它属于哪个类的信息。元信息是共享的，同一类的所有对象都指向共享的元信息。克隆任何东西仍然没有意义。

因此，如果对象创建是以原型克隆方式完成的，我会感到非常惊讶。我不能绝对肯定地知道，但我敢打赌它不是。我也很确定对象创建只是分配小内存块，并且可能在其标头内设置一些指针。

如果有人 * *ngen* * s 一些代码并将其反汇编以查看 new() 运算符的工作原理，那当然是可验证的 :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T19:43:03.943

C# 不是基于原型的。您不需要现有对象的实例来创建新对象，也不可能像 javascript 那样“扩展”对象。

因此，原则上，所有对象都是从无中创建的。

# java - C 代码到 Java——字符操作

> ID：12734269
> 
> 赞同：1
> 
> 时间：2012-10-04T19:14:55.323
> 
> 标签：java, c, pointers, char

我需要用Java写这个。

虽然我知道如何读取文件，但我对“buff”输出是什么感兴趣，开头的长度是多少？

```
char              *buff;
unsigned char     *aux;

while(fgets (buff+2, length, fin)){
    len = strlen (buff + 2) + 2;
    aux = (unsigned char *) &len;
    buff[1] = aux[0];
    buff[0] = aux[1];
    ...
    send (sd, buff, len, 0);

} 
```

但我不明白这一点：

```
aux = (unsigned char *) &len;
buff[1] = aux[0];
buff[0] = aux[1]; 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:37:50.173

这段代码：

```
aux = (unsigned char *) &len;
buff[1] = aux[0];
buff[0] = aux[1]; 
```

创建存储在 中的整数值的字节数组视图`len`。在 Java 中，你不能做完全相同的事情，但你可以通过几种方式得到你想要的。最简单的就是位屏蔽和移位：

```
int len = ...;
byte[] buff = ...;
byte[0] = (byte) (len & 0xff);
byte[1] = (byte) ((len >> 8) & 0xff); 
```

另一种可能性是使用 a [`ByteBuffer`](http://docs.oracle.com/javase/6/docs/api/java/nio/ByteBuffer.html)，但对于这样一个简单的操作来说，这似乎有点过分了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:18:46.403

`buff`似乎是用于从文件中读取数据的缓冲区。看起来程序假设`len`最多只有两个 (sizeof(unsigned char)) 字节长。因此，它通过将 的地址解析`len`为an来打包 的最低两个字节，从而抓取 的最低两个字节并将它们粘贴到 的最低两个字节中。`buf[1:0]``len``unsigned char *``len``buff`

# c# - 打印不带预览的 ReportViewer

> ID：12734277
> 
> 赞同：6
> 
> 时间：2012-10-04T19:15:25.553
> 
> 标签：c#, mysql, reportviewer

我正在使用 Visual Studio 2010 C# Windows Forms Application + MySql 我有一个 100% 工作的报表查看器。reportviewer 充满了我的数据库的数据，它显示我点击按钮打印并打印......但是，我的客户不想点击这个按钮，他想自动打印。当我调用 ReportViewer 时，它会自行打印，无需单击按钮即可。谁能告诉我我是怎么做到的？

我从工具箱中尝试了 reportviewer1.print 和 PrintDocument。但我不知道如何正确使用这些。

感谢关注！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-20T14:41:54.270

我遇到了同样的问题，这是我使用的代码，它的工作原理就像一个魅力！

```
using System;
using System.IO;
using System.Text;
using System.Globalization;
using System.Drawing;
using System.Drawing.Imaging;
using System.Drawing.Printing;
using Microsoft.Reporting.WinForms;
using System.Collections.Generic;
using System.Collections.Specialized;
using System.Diagnostics;
using System.ComponentModel;
using System.Data;
using System.Linq;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace NewLabelPrinter
{
    /// <summary>
    /// The ReportPrintDocument will print all of the pages of a ServerReport or LocalReport.
    /// The pages are rendered when the print document is constructed.  Once constructed,
    /// call Print() on this class to begin printing.
    /// </summary>
    class AutoPrintCls : PrintDocument
    {
        private PageSettings m_pageSettings;
        private int m_currentPage;
        private List<Stream> m_pages = new List<Stream>();

        public AutoPrintCls(ServerReport serverReport)
            : this((Report)serverReport)
        {
            RenderAllServerReportPages(serverReport);
        }

        public AutoPrintCls(LocalReport localReport)
            : this((Report)localReport)
        {
            RenderAllLocalReportPages(localReport);
        }

        private AutoPrintCls(Report report)
        {
            // Set the page settings to the default defined in the report
            ReportPageSettings reportPageSettings = report.GetDefaultPageSettings();

            // The page settings object will use the default printer unless
            // PageSettings.PrinterSettings is changed.  This assumes there
            // is a default printer.
            m_pageSettings = new PageSettings();
            m_pageSettings.PaperSize = reportPageSettings.PaperSize;
            m_pageSettings.Margins = reportPageSettings.Margins;
        }

        protected override void Dispose(bool disposing)
        {
            base.Dispose(disposing);

            if (disposing)
            {
                foreach (Stream s in m_pages)
                {
                    s.Dispose();
                }

                m_pages.Clear();
            }
        }

        protected override void OnBeginPrint(PrintEventArgs e)
        {
            base.OnBeginPrint(e);

            m_currentPage = 0;
        }

        protected override void OnPrintPage(PrintPageEventArgs e)
        {
            base.OnPrintPage(e);

            Stream pageToPrint = m_pages[m_currentPage];
            pageToPrint.Position = 0;

            // Load each page into a Metafile to draw it.
            using (Metafile pageMetaFile = new Metafile(pageToPrint))
            {
                Rectangle adjustedRect = new Rectangle(
                        e.PageBounds.Left - (int)e.PageSettings.HardMarginX,
                        e.PageBounds.Top - (int)e.PageSettings.HardMarginY,
                        e.PageBounds.Width,
                        e.PageBounds.Height);

                // Draw a white background for the report
                e.Graphics.FillRectangle(Brushes.White, adjustedRect);

                // Draw the report content
                e.Graphics.DrawImage(pageMetaFile, adjustedRect);

                // Prepare for next page.  Make sure we haven't hit the end.
                m_currentPage++;
                e.HasMorePages = m_currentPage < m_pages.Count;
            }
        }

        protected override void OnQueryPageSettings(QueryPageSettingsEventArgs e)
        {
            e.PageSettings = (PageSettings)m_pageSettings.Clone();
        }

        private void RenderAllServerReportPages(ServerReport serverReport)
        {
            try
            {
                string deviceInfo = CreateEMFDeviceInfo();

                // Generating Image renderer pages one at a time can be expensive.  In order
                // to generate page 2, the server would need to recalculate page 1 and throw it
                // away.  Using PersistStreams causes the server to generate all the pages in
                // the background but return as soon as page 1 is complete.
                NameValueCollection firstPageParameters = new NameValueCollection();
                firstPageParameters.Add("rs:PersistStreams", "True");

                // GetNextStream returns the next page in the sequence from the background process
                // started by PersistStreams.
                NameValueCollection nonFirstPageParameters = new NameValueCollection();
                nonFirstPageParameters.Add("rs:GetNextStream", "True");

                string mimeType;
                string fileExtension;

                Stream pageStream = serverReport.Render("IMAGE", deviceInfo, firstPageParameters, out mimeType, out fileExtension);

                // The server returns an empty stream when moving beyond the last page.
                while (pageStream.Length > 0)
                {
                    m_pages.Add(pageStream);

                    pageStream = serverReport.Render("IMAGE", deviceInfo, nonFirstPageParameters, out mimeType, out fileExtension);
                }
            }
            catch (Exception e)
            {
                MessageBox.Show("possible missing information ::  " + e);
            }
        }

        private void RenderAllLocalReportPages(LocalReport localReport)
        {
            try
            {
                string deviceInfo = CreateEMFDeviceInfo();

                Warning[] warnings;

                localReport.Render("IMAGE", deviceInfo, LocalReportCreateStreamCallback, out warnings);
            }
            catch (Exception e)
            {
                MessageBox.Show("error :: " + e);
            }
        }

        private Stream LocalReportCreateStreamCallback(
            string name,
            string extension,
            Encoding encoding,
            string mimeType,
            bool willSeek)
        {
            MemoryStream stream = new MemoryStream();
            m_pages.Add(stream);

            return stream;
        }

        private string CreateEMFDeviceInfo()
        {
            PaperSize paperSize = m_pageSettings.PaperSize;
            Margins margins = m_pageSettings.Margins;

            // The device info string defines the page range to print as well as the size of the page.
            // A start and end page of 0 means generate all pages.
            return string.Format(
                CultureInfo.InvariantCulture,
                "<DeviceInfo><OutputFormat>emf</OutputFormat><StartPage>0</StartPage><EndPage>0</EndPage><MarginTop>{0}</MarginTop><MarginLeft>{1}</MarginLeft><MarginRight>{2}</MarginRight><MarginBottom>{3}</MarginBottom><PageHeight>{4}</PageHeight><PageWidth>{5}</PageWidth></DeviceInfo>",
                ToInches(margins.Top),
                ToInches(margins.Left),
                ToInches(margins.Right),
                ToInches(margins.Bottom),
                ToInches(paperSize.Height),
                ToInches(paperSize.Width));
        }

        private static string ToInches(int hundrethsOfInch)
        {
            double inches = hundrethsOfInch / 100.0;
            return inches.ToString(CultureInfo.InvariantCulture) + "in";
        }
    }
} 
```

该课程的设置非常适合您的需要，那么您需要做的就是：

```
private void AutoPrint()
    {
        AutoPrintCls autoprintme = new AutoPrintCls(reportViewer1.LocalReport);
        autoprintme.Print();
    } 
```

嘿，它会打印出来。只需将其附加到代码中的 A 方法（可能在报告加载之后。）并且您的设置很好！

选项：（未测试）

正如发现的那样，它会打印到默认打印机上，要更改打印机，您可以执行以下操作：

```
if (printDialog.ShowDialog() == DialogResult.OK) 
{
    m_pageSettings .PrinterSettings.PrinterName = printDialog.PrinterSettings.PrinterName;
} 
```

虽然没有测试，因为我不再有任何源代码来测试它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T20:01:02.967

如果我的水晶报表答案不适合你，你也可以试试[这个页面](http://blogs.msdn.com/b/brianhartman/archive/2009/02/27/manually-printing-a-report.aspx)。同样，我还没有测试过它，也不能确定它是否有效，但它看起来像是一种完全不同的方法，它可能有效。如果没有，那么不幸的是，我不会提供任何帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T19:54:00.257

这就是我们使用 Crystal Reports 的方式。

```
 ReportDocument rd = new ReportDocument();
            // Insert code to run the report here

            // This gets the user's default printer to print to.
            PrintDialog prt = new PrintDialog();
            rd.PrintOptions.PrinterName = prt.PrinterSettings.PrinterName; 
            // This does the printing.
            rd.PrintToPrinter(copies, true, 1, 1000); 
```

我认为你的等价物`PrintOptions.PrinterName`是`ReportViewer.PrinterSettings`，但我怀疑你真正需要的是等价于`PrintToPrinter()`，我在简短的外观中没有看到。

# php - 如何使用 SimpleXmlElement 将输入元素写入 xml 文件？

> ID：12734279
> 
> 赞同：0
> 
> 时间：2012-10-04T19:15:33.957
> 
> 标签：php

这就是我现在正在使用的：

```
//variable assignment that create strings from text input element
$xmlUsernameStr = $xmlDetail->userString();

//this is the function used above
public function userString(){
    return $user;//this is the variable that holds username on input element
}

//assignments in php script 
$sxml = new SimpleXmlElement(file_get_contents('details.xml'));
$xmlDetailTag = new SimpleXMLElement('<detail></detail>');  

//details.xml contains:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<details>
<detail></detail>
</details>

//create another child 'user' within parent 'detail' 
$aUserTag = $sxml->detail->addChild('user'); 
```

那么，如果我所拥有的是正确的，那么实际写入 xml 的内容是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T20:02:43.653

```
$xml = simplexml_load_file('details.xml');
$xml->addChild('details')->addChild('detail', $xmlUsernameStr );
file_put_contents('details.xml', $xml->asXML()); 
```

# jquery - jQuery 函数重复，在重新附加事件处理程序后，因为显示了新的 html

> ID：12734281
> 
> 赞同：0
> 
> 时间：2012-10-04T19:15:43.847
> 
> 标签：jquery, html

所以我正在执行一个`$.post()`从访问 SQLite 数据库的 php 脚本返回的一些 html 代码

我需要将单击事件附加到显示页面何时加载新 html 的编辑按钮，因此我在之后附加单击事件，`.empty().html()`如果用户通过提交数据来编辑记录，它会再次`$.post()`重新刷新屏幕并显示新数据，所以我再次附加点击事件处理程序，因为如果我不这样做，页面上的编辑按钮将不再工作，因为当第一次附加“.click()”时它们不存在

但是，当我这样做并编辑多条记录时，它会运行多次（我每次执行时都会提醒记录 ID，`$.post()`并且它执行的次数与我单击的编辑次数相同，我已经看到有关如何`.live()`导致此问题的帖子和人们建议绑定点击这是我正在做的，所以我看不到发生了什么......这是代码

```
$(".edit").click(function(e){
    e.preventDefault();
    $realTipID=this.id;
    $.post("ajax.php",{action:'getTip',tipID:$realTipID},function(data){
            $("#editTip_div").css("display","block");
            $("#editText").empty().val(unEscapeSpecialChars(data));//puts the data that is currently in the DB into a textarea to be editted
            $("#edit_tip").click(function(e){
            $.post("ajax.php",{action:'editTip',tipID:$realTipID,editText:escapeSpecialChars($("#editText").val())},function(data){

            if (data=="1")  {//check tosee that the update of the SQL table worked
                e.preventDefault();//tried this because someone suggested it in another StackOverflow post
                $(".edit").unbind('click');//and this
                $realTipID='';
                $("#editText").val('');
                $("#editTip_div").css("display","none");
                $('.result[id|='+$issueID+']').click();//refreshes the <div> with the content, includes this $(".edit").click() event 
            if (data=="0")  {//or failed
                alert("record not written, could be that there are quotes in the text, please remove, quotes, apostraphes, and ticks (`) as they will cause the line to fail"); 
            }

                                                        });
        });
        $("#cancel_edit").click(function()  {
            $("#editText").val('');
            $("#editTip_div").css("display","none");
                                                                });
        });

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:17:30.720

听起来您在同一个元素上设置了多个事件处理程序。这有帮助吗？编辑：对不起，那应该是：

```
$(".edit").unbind().click(function(e){ 
```

编辑自：

```
$("#cancel_edit").unbind().click(function() 
```

# .net - 使用单独的应用程序作为 asmx Web 服务

> ID：12734283
> 
> 赞同：2
> 
> 时间：2012-10-04T19:15:46.123
> 
> 标签：.net, vb.net, web-services, entity-framework

我在实习期间被要求使用实体框架创建 Web 服务。他们告诉我首先创建一个单独的应用程序，以后可以将其集成到主应用程序中。如果我制作了单独的应用程序，如何将其集成到现有应用程序中？

我环顾四周，看起来每个人都只是在应用程序本身内部创建 Web 服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:36:37.293

没门。你的假设是遥遥无期。Web 服务最初设计为作为服务从远程调用。.NET 大量使用 asmx 是同一个应用程序来简化 AJAX 调用，这就是为什么你经常看到这些。

只需托管一个 Web 服务并在您的应用程序中调用它。它比你想象的要简单。[首先尝试从http://webservicex.net/ws/default.aspx](http://webservicex.net/ws/default.aspx)
调用一些 Web 服务，然后创建一个您自己的 Web 服务以方便您。

# android - Android PayPal Mobile Express CheckOut Library -- 如何加载示例

> ID：12734288
> 
> 赞同：0
> 
> 时间：2012-10-04T19:16:15.993
> 
> 标签：android, paypal

我没有开发经验，但我想了解 PayPal MECL 的工作原理。我下载了 SDK（和 eclipse），Paypal MECL SDK 有一个示例文件夹，其结构如下：

```
[folder] Assets
[folder] Bin
[folder] Res
[folder] Src
[file] Paypal_MECL.jar
[file].classpath
[file].project
[file] AndroidManifest.xml
[file] default.properties 
```

我将如何在 Eclipse 中加载它以查看示例？有人能指出我正确的方向吗？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-26T19:18:50.023

因为这是在线充值程序，所以您只需下载 MECL paypal 并创建一个沙盒帐户，您就可以获得应用程序 ID 和收件人邮件。所以只需将应用程序 ID 和收件人邮件放入其中。

# python - python unittest的奇怪问题

> ID：12734289
> 
> 赞同：0
> 
> 时间：2012-10-04T19:16:18.863
> 
> 标签：python, unit-testing

以下超级简单的单元测试在python2.7下运行良好，但在2.6中出现以下错误“no method runTest()”，这是为什么呢？

谢谢！杨

```
myuser@myhost /tmp $ python26 -m unittest a.AA
Traceback (most recent call last):
  File "/usr/lib64/python2.6/runpy.py", line 122, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib64/python2.6/runpy.py", line 34, in _run_code
    exec code in run_globals
  File "/usr/lib64/python2.6/unittest.py", line 874, in <module>
    main(module=None)
  File "/usr/lib64/python2.6/unittest.py", line 815, in __init__
    self.parseArgs(argv)
  File "/usr/lib64/python2.6/unittest.py", line 842, in parseArgs
    self.createTests()
  File "/usr/lib64/python2.6/unittest.py", line 848, in createTests
    self.module)
  File "/usr/lib64/python2.6/unittest.py", line 612, in loadTestsFromNames
    suites = [self.loadTestsFromName(name, module) for name in names]
  File "/usr/lib64/python2.6/unittest.py", line 597, in loadTestsFromName
    test = obj()
  File "/usr/lib64/python2.6/unittest.py", line 215, in __init__
    (self.__class__, methodName)
ValueError: no such test method in <class 'a.AA'>: runTest
myuser@myhost /tmp $ vi a.py
myuser@myhost /tmp $ cat a.py
import unittest

class AA(unittest.TestCase):
    pass 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T06:45:24.923

它适用于 2.7 而不是 2.6 的原因可以在[文档](http://docs.python.org/library/unittest.html#command-line-interface)中找到。

它说

> 在 2.7 版中更改：在早期版本中，只能运行单个测试方法，而不能运行模块或类。

您正在尝试运行整个班级的所有测试`AA`。你不能在 2.6 中这样做。您可以`unittest.main()`在代码底部调用 并通过命令行从命令行运行脚本`python a.py`。

```
$ cat a.py
import unittest

class AA(unittest.TestCase):
    def test_something(self):
        self.assertEqual(1, 1)

unittest.main()

$ python -V
Python 2.6.1
$ python a.py
.
----------------------------------------------------------------------
Ran 1 test in 0.000s

OK 
```

您可能还需要保护调用以`unittest.main()`确保仅当您从命令行运行此文件时才调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:22:30.870

You have to overwrite [runTest](http://docs.python.org/release/2.6.6/library/unittest.html#organizing-test-code) function in your class.

Or functions named test_something, wich unittest understands as test functions. This is helpful when you want to execute a conscequent number of tests, because you can provide setUp and tearDown, which are functions that are called before each test, to create classes or stuff that you need in your test.

# jquery - 使用 Jquery .prop() 或 .data() 时获取正确的 URL

> ID：12734293
> 
> 赞同：0
> 
> 时间：2012-10-04T19:16:37.990
> 
> 标签：jquery, twitter-bootstrap, modal-dialog, href

[使用Bootstrap 图像库](https://github.com/blueimp/Bootstrap-Image-Gallery)时，我试图在模式弹出窗口中获取图像的 url 。由于图像是动态加载的，因此我需要获取该图像的 url 才能共享它。使用此代码，我得到“未定义”作为我的结果：

```
 $('#modal-gallery').on('load', function () {
    var modalData = $(this).data('modal'),
    // The current, associated link element:
    linkElement = modalData.$links[modalData.options.index],
    url = $(linkElement).prop('href');      
  $(".info").html("<a href='http://www.addthis.com/bookmark.php' class='addthis_button_compact' addthis:url='" + url + "'>" + "</a>");
   //addthis code   
   addthis.toolbox('.info');
  }); 
```

如果我使用此代码，我会得到一个 href，但它的格式是“slides/image.jpg”而不是“http://www.example.com/slides/image.jpg”

```
 $('#modal-gallery').on('load', function () {
  var modalData = $(this).data('modal'),
    // The current, associated link element:
    linkElement = modalData.$links[modalData.options.index],
    url = $(linkElement).data("href");      
  $(".info").html("<a href='http://www.addthis.com/bookmark.php' class='addthis_button_compact' addthis:url='" + url + "'>" + "</a>");
addthis.toolbox('.info');
 }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:47:19.877

如果您查看图像的 src*属性*而不是其属性，您将获得完整的 url：

简单的例子：

```
$("#pic").get(0).src 
```

同样的原则也适用于锚标签。要获取他们指向的绝对 URL：

```
$("#link").get(0).href 
```

# android - GCM：java.lang.NoClassDefFoundError：com.google.android.gcm.GCMRegistrar

> ID：12734303
> 
> 赞同：2
> 
> 时间：2012-10-04T19:16:57.560
> 
> 标签：android, eclipse, eclipse-juno

请帮忙，我整天都在解决这个问题，并使用了在网上找到的所有可能的解决方案。

要求：使用juno eclipse，ADT 20 我曾与商业GCM合作，我使用Android开发者的演示做了一个更复杂的项目（http://developer.android.com/guide/google/gcm/demo.html）而且我意识到我的应用程序在 Crask 每个调用类 GCMRegistrar 中。

因此，我创建了一个最小的练习，如果我解锁所有内容，它将起作用。

```
import com.google.android.gcm.GCMRegistrar;

    public class Manda extends Activity {

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_manda);

        crash --->  GCMRegistrar.checkDevice(this);

            // while developing the app, then uncomment it when it's ready.

            GCMRegistrar.checkManifest(this);

        } 
```

我附上了我添加 gcm.jar 库的最小练习的屏幕截图，我做了所有我发现的事情。

我是新用户，无法发布 img，但我放了一个 bropbox 的公共链接 [https://www.dropbox.com/s/dyi0y4sppz4rcq3/img%20GCM%20problem.zip](https://www.dropbox.com/s/dyi0y4sppz4rcq3/img%20GCM%20problem.zip)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:22:41.970

如 Google 的文档中所述，您必须将 AndroidManifast.xml 文件添加到以下内容：

```
<service android:name="YOUR.PACKAGE.NAME.GCMIntentService" />

<receiver
            android:name="com.google.android.gcm.GCMBroadcastReceiver"
            android:permission="com.google.android.c2dm.permission.SEND" >
            <intent-filter>
                <action android:name="com.google.android.c2dm.intent.RECEIVE" />
                <action android:name="com.google.android.c2dm.intent.REGISTRATION" />

                <category android:name="YOUR_CATEGORY_NAME" />
            </intent-filter>
        </receiver> 
```

确保将 IntentService 类放在正确的包中。

另外，您是如何将 gcm.jar 添加到您的项目中的？您需要在项目中创建一个“libs”文件夹并将 jar 放在那里

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-29T10:51:21.607

**解决方案1：**

1.  检查您是否已将**gcm.jar**文件放入**libs**而**不是 lib 文件夹中。**

**解决方案2：**

大多数情况下这是问题。请按照以下步骤解决问题：

1.  右键单击**项目**->**构建路径**->**配置构建路径**然后**订购和导出**
2.  现在检查**Android Private Libraries**。**复选框**应该检查**所需的库。**
3.  刷新，清洁并运行..给你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-29T15:15:17.177

问题是我的模拟器没有 Google API（Google Inc）。如果您使用的是 android 模拟器，则必须使用 Google APIs (Google Inc) 创建模拟器。

# sql - 为什么会出现外键约束错误

> ID：12734310
> 
> 赞同：3
> 
> 时间：2012-10-04T19:17:31.253
> 
> 标签：sql, sql-server, sql-server-2012

我正在尝试使用 sql server 2012 在表中插入值，但出现此错误：

```
The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Fabricante". 
The conflict occurred in database 
"practica", table "dbo.Fabricantes", column 'Codigo'. 
```

我只有两张桌子。

这是我用来创建表格的代码

```
create table Fabricantes(
Codigo int identity primary key,
Nombre nvarchar (100) not null)

create table Articulos(
Codigo int identity primary key,
Nombre nvarchar (100) not null,
Precio int,
Fabricante int,
constraint FK_Fabricante foreign key
(Codigo) references Fabricantes (Codigo)) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T19:23:34.113

如果您尝试将表中不存在`INSERT`的值放入表中，那么您将收到错误消息。`Articulos``Fabricantes`

由于您在该`Codigo`字段上有一个外键，因此您必须在`Fabricantes`.

查看[非工作演示](http://sqlfiddle.com/#!6/5acfc/1)。此演示显示表`Codigo`中不存在值，`Fabricantes`因此它会引发错误消息。这是一个[工作演示](http://sqlfiddle.com/#!6/15171/1)，显示该值首先在表中。

我认为你需要重做表格，无论如何。

```
create table Fabricantes
(
  Codigo int identity primary key,
  Nombre nvarchar (100) not null
);

create table Articulos
(
  Codigo int primary key,
  Nombre nvarchar (100) not null,
  Precio int,
  Fabricante int,
  constraint FK_Fabricante foreign key
  (Codigo) references Fabricantes (Codigo)
); 
```

您最初有`Articulos`一个带有`identity`集合的表，但是由于您将该字段作为外键，我认为您不应该`identity`在该表上使用该字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T20:10:01.397

我认为您的错误是错误的外键。根据表格的外观，您应该像这样将 Articulo.Fabricante 引用到 Fabricante.Codigo：

```
create table Fabricantes(
Codigo int identity primary key,
Nombre nvarchar (100) not null)

create table Articulos(
Codigo int identity primary key,
Nombre nvarchar (100) not null,
Precio int,
Fabricante int,
constraint FK_Fabricante foreign key
(Fabricante) references Fabricantes (Codigo)) 
```

# mysql - 如何配置 mysql 在长时间运行的查询中不超时？

> ID：12734316
> 
> 赞同：0
> 
> 时间：2012-10-04T19:17:39.893
> 
> 标签：mysql, hibernate, my.cnf

我有一个强烈的查询，它是从 java/hibernate 应用程序发出的，它在 3-4 分钟后超时。哪些 my.cnf 配置控制该行为？或者，如何通过 hibernate 进行配置？为什么查询需要这么长时间超出了这个问题的范围。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:38:27.563

您可能会遇到 InnoDB 锁超时，需要调整`innodb_lock_wait_timeout`参数以确保不会因为持有锁太久而中断查询。

查询也可能仍在运行，但启动它的 Web 进程已超时。如果`SHOW PROCESSLIST`事后可以看到长时间运行的查询，则需要调整 Web 服务器请求超时。

# c# - 我们可以将代码从一个命名空间继承到另一个命名空间吗

> ID：12734317
> 
> 赞同：-2
> 
> 时间：2012-10-04T19:17:42.307
> 
> 标签：c#, inheritance, namespaces

假设我有一个命名空间`first_namespace`，其中我有一个名为`first_class`该类的类我有一个名为`first_function`. 我还有一个我在主方法中`second_namespace`有一个类，我创建了一个对象`second_class``second_class`

```
second_class sc = new second_class();
//now I wont be able to call firt_function by using the object sc 
```

但是如果我在第一个命名空间中创建第一类的对象，如下所示：

```
first_class fc = new first_class();
fc.first_function();//it works 
```

所以我的问题是：我们可以称之为继承吗？如果不是那我怎么称呼它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:21:07.867

是的，您可以继承和命名空间是完全独立的概念。

继承允许您从任何非密封对象派生子类。

命名空间只是用于逻辑定位和分组代码的概念容器。

希望这可以帮助

马修

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:34:33.210

C# 中的任何方法都属于一个类（或结构）。您只能在正确类类型的对象（也称为该类型的实例）上调用该方法。

这不是继承。方法属于特定类型的对象（因此不存在于其他类型的对象上）是**面向对象编程**的一部分。

# c++ - 将矩形 Qt 按钮更改为圆形

> ID：12734319
> 
> 赞同：11
> 
> 时间：2012-10-04T19:18:07.270
> 
> 标签：c++, qt, qt-designer

我正在尝试在 Qt 中创建一个圆形按钮。`QPushButton`在设计器中创建了一个带有单个按钮的简单表单。我正在尝试使用`setMask()`. 一旦`setMask()`应用，按钮就会消失。是否需要创建自定义小部件来制作圆形按钮？

```
#include "mainwindow.h"
#include "ui_mainwindow.h"
#include <QMessageBox>
#include <QtGui/QPushButton>

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);

    ui->pushButton->setText("Test Text");
    ui->pushButton->setFixedHeight(200);
    ui->pushButton->setFixedWidth(200);

    //Set Starting point of region 5 pixels inside , make region width & height
    //values same and less than button size so that we obtain a pure-round shape

    QRegion* region = new QRegion(*(new QRect(ui->pushButton->x()+5,ui->pushButton->y()+5,190,190)),QRegion::Ellipse);
    ui->pushButton->setMask(*region);
    ui->pushButton->show();

}

MainWindow::~MainWindow()
{
    delete ui;
}

void MainWindow::on_pushButton_clicked()
{
    QMessageBox msgbox;
    msgbox.setText("Text was set");
    msgbox.show();

} 
```

注意：如果在代码中创建按钮并在窗口显示之前将其应用于窗口，则显示该按钮。我想使用 Qt Designer 的 WYSIWIG 功能，而不是在代码中创建整个表单。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-04T19:56:12.530

它变得不可见，但这是因为您没有以正确点为中心的椭圆。

**QWidget::setMask** "*仅导致窗口小部件中与区域重叠的部分可见。如果该区域包括窗口小部件的 rect() 之外的像素，则该区域中的窗口系统控件可能可见也可能不可见，具体取决于平台*”。

试试这个代码，你会看到：

```
MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);
    ui->pushButton->setText("Test Text");
    ui->pushButton->setFixedHeight(200);
    ui->pushButton->setFixedWidth(200);
    QRect rect(0,0,190,190);
    qDebug() << rect.size();
    qDebug() << ui->pushButton->size();
    QRegion region(rect, QRegion::Ellipse);
    qDebug() << region.boundingRect().size();
    ui->pushButton->setMask(region);
} 
```

附言。为什么要设置两次按钮的高度？我假设这是一个错字，你的意思是宽度。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-10-04T19:32:37.923

我认为最简单的解决方案是使用样式表。

像这样：

```
 background-color: white;
 border-style: solid;
 border-width:1px;
 border-radius:50px;
 border-color: red;
 max-width:100px;
 max-height:100px;
 min-width:100px;
 min-height:100px; 
```

另请参阅[示例](http://qt-project.org/doc/qt-5/stylesheet-examples.html#customizing-qpushbutton)和[参考](http://qt-project.org/doc/qt-5/stylesheet-reference.html)。

请注意，您必须为按钮创建完整的样式，因为标准样式将不适用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-24T15:12:21.630

这将完美地尝试这个 -

```
QPushButton {
color: #333;
border: 2px solid #555;
border-radius: 20px;
border-style: outset;
background: qradialgradient(
cx: 0.3, cy: -0.4, fx: 0.3, fy: -0.4,
radius: 1.35, stop: 0 #fff, stop: 1 #888
);
padding: 5px;
}

QPushButton:hover {
background: qradialgradient(
cx: 0.3, cy: -0.4, fx: 0.3, fy: -0.4,
radius: 1.35, stop: 0 #fff, stop: 1 #bbb
);
} 
```

# python - pyPandas：加入/追加/连接两个数据帧的混乱

> ID：12734320
> 
> 赞同：0
> 
> 时间：2012-10-04T19:18:13.493
> 
> 标签：python, join, dataframe, pandas, concat

我有两个数据框：一个有 12 个列，另一个有 9 个，它们都有 624 行。我想将它们并排加入，从而产生具有相同 624 行数的 21 cols 数据框。我想保留行顺序。观察到两个数据框都按“名称”列和“L1”列的降序排列。我已经尝试了几件事来通过axis = 1忽略索引加入它们。我所拥有的只是一个行数翻倍和一堆 NAN 的数据框。我也尝试连接和追加，但没有成功。任何帮助表示赞赏。

```
n        Name  Position  ObsHET  PredHET  HWpval  %Geno  FamTrio  MendErr    MAF Alleles Rating
48  rs17818182  32945574   0.153    0.141  1.0000   98.9       29        0  0.076     G:T    NaN
45  rs17818176  32944041   0.033    0.033  1.0000  100.0       30        0  0.017     G:T    NaN
133  rs17818104  32879319   0.136    0.126  1.0000   98.9       29        0  0.068     T:C    NaN
105  rs17818087  32863970   0.241    0.307  0.2037   96.7       29        1  0.190     T:C    NaN
165  rs17818021  32794604   0.302    0.329  0.7637   85.6       20        0  0.208     A:C    NaN

           L1        L2      D   LOD     r2  CIlow  CIhi   Dist T-int
31331  rs17818182  rs640249  0.423  0.27  0.012   0.04  0.80  66596     -
31328  rs17818176  rs640249  1.000  0.21  0.014   0.05  0.97  65063     -
29083  rs17818104  rs640249  1.000  3.01  0.092   0.51  1.00    341     -
27571  rs17818087  rs640249  0.143  0.14  0.006   0.01  0.44  15008     -
14857  rs17818021  rs640249  0.311  0.68  0.033   0.06  0.57  84374     - 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T23:13:55.347

一种替代方法是合并“名称”和“L1”：

```
In [36]: df
Out[36]: 
   a         b         c
0  k -0.787279  1.431643
1  m  1.278970  2.294351
2  n  0.793787 -2.337330

In [37]: df2
Out[37]: 
   x         y         z
2  k -2.419514  1.178166
3  m -0.827535 -0.113485
4  n  0.135814 -0.612922

In [38]: df.merge(df2, left_on='a', right_on='x')
Out[38]: 
   a         b         c  x         y         z
0  k -0.787279  1.431643  k -2.419514  1.178166
1  m  1.278970  2.294351  m -0.827535 -0.113485
2  n  0.793787 -2.337330  n  0.135814 -0.612922 
```

另一种是在调用合并之前先调用 DataFrame.reset_index ：

```
In [50]: df.reset_index().merge(df2.reset_index(), left_index=True, right_index=True)
Out[50]: 
   index_x  a         b         c  index_y  x         y         z
0        0  k -0.787279  1.431643        2  k -2.419514  1.178166
1        1  m  1.278970  2.294351        3  m -0.827535 -0.113485
2        2  n  0.793787 -2.337330        4  n  0.135814 -0.612922 
```

# java - 在将列表项添加到 ListView 之前，如何以编程方式设置列表项中的字体大小？

> ID：12734322
> 
> 赞同：2
> 
> 时间：2012-10-04T19:18:14.703
> 
> 标签：java, android, listview, text-size

我对如何更改列表中文本的大小然后将其添加到 ListView 感兴趣。我正在使用带有自定义布局的 list_item 。问题是如何在文本进入 ListView 之前设置文本的大小。我希望能得到你的帮助。

**list_item.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    xmlns:android1="http://schemas.android.com/apk/res/android">

<LinearLayout
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    >

    <TextView
        android:id="@+id/shop_name"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="1"
        />

    <TextView
        android:id="@+id/shop_address"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="2"
        />

</LinearLayout>

</LinearLayout> 
```

**day_list_events.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    android:layout_gravity="center"
    android:id="@+id/layout"
    >

<TextView 
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:id="@+id/day_and_data"
    android:text="Перелік клієнтів на сьогоднішній день."
    android:textStyle="bold"
    />

<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:id="@+id/help_info"
    android:text="(Щоб отримати інформацію про клієнта та оформити замовлення - натисніть на відповідного клієнта у списку)"
    android:textColor="#A0A0A0"
    />

<ListView
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:id="@+id/day_list_event"
    >

</ListView>

</LinearLayout> 
```

**DayListEventsActivity.java**

```
import java.util.ArrayList;
import java.util.HashMap;

import android.app.Activity;
import android.content.Context;
import android.content.SharedPreferences;
import android.content.res.Resources;
import android.os.Bundle;
import android.view.Window;
import android.widget.ListView;
import android.widget.SimpleAdapter;

public class DayListEventsActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    this.requestWindowFeature(Window.FEATURE_NO_TITLE);
    super.onCreate(savedInstanceState);
    setContentView(R.layout.day_list_events);
    sharedPreferences = getSharedPreferences("impInfo", Context.MODE_PRIVATE);
    Resources res = this.getResources();
    ArrayList<HashMap<String, String>> dayShopsInfo = new ArrayList<HashMap<String, String>>();
    String[] shopName = res.getStringArray(R.array.shop_name);
    String[] shopAddress = res.getStringArray(R.array.shop_address);        
    for(int i = 0; i < shopName.length; i++){
        HashMap<String, String> dayShopsInfoCont = new HashMap<String, String>();
        dayShopsInfoCont.put(KEY_SHOP_NAME, shopName[i]);
        dayShopsInfoCont.put(KEY_SHOP_ADDRESS, shopAddress[i]);
        System.out.println(i+" "+shopName[i]+" "+shopAddress[i]);
        dayShopsInfo.add(dayShopsInfoCont);         
    }
    ListView shopList = (ListView)findViewById(R.id.day_list_event);
    SimpleAdapter shopListAdapter = new SimpleAdapter(this,
            dayShopsInfo,
            R.layout.list_item,
            new String[]{KEY_SHOP_NAME, KEY_SHOP_ADDRESS},
            new int[]{R.id.shop_name, R.id.shop_address});
    shopList.setAdapter(shopListAdapter);
    shopList.setChoiceMode(ListView.CHOICE_MODE_SINGLE);
}

private final String KEY_SHOP_NAME = "shop name";
private final String KEY_SHOP_ADDRESS = "shop address";
private SharedPreferences sharedPreferences;
} 
```

**更新（解决方案）。**

```
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import android.app.Activity;
import android.content.Context;
import android.content.SharedPreferences;
import android.content.res.Resources;
import android.os.Bundle;
import android.view.View;
import android.view.ViewGroup;
import android.view.Window;
import android.widget.ListView;
import android.widget.SimpleAdapter;
import android.widget.TextView;

public class DayListEventsActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    this.requestWindowFeature(Window.FEATURE_NO_TITLE);
    super.onCreate(savedInstanceState);
    setContentView(R.layout.day_list_events);
    sharedPreferences = getSharedPreferences("impInfo", Context.MODE_PRIVATE);
    Resources res = this.getResources();
    ArrayList<HashMap<String, String>> dayShopsInfo = new ArrayList<HashMap<String, String>>();
    String[] shopName = res.getStringArray(R.array.shop_name);
    String[] shopAddress = res.getStringArray(R.array.shop_address);        
    for(int i = 0; i < shopName.length; i++){
        HashMap<String, String> dayShopsInfoCont = new HashMap<String, String>();
        dayShopsInfoCont.put(KEY_SHOP_NAME, shopName[i]);
        dayShopsInfoCont.put(KEY_SHOP_ADDRESS, shopAddress[i]);
        System.out.println(i+" "+shopName[i]+" "+shopAddress[i]);
        dayShopsInfo.add(dayShopsInfoCont);         
    }
    ListView shopList = (ListView)findViewById(R.id.day_list_event);
    MySimpleAdapter shopListAdapter = new MySimpleAdapter(this,
            dayShopsInfo,
            R.layout.list_item,
            new String[]{KEY_SHOP_NAME, KEY_SHOP_ADDRESS},
            new int[]{R.id.shop_name, R.id.shop_address});
    shopList.setAdapter(shopListAdapter);
    shopList.setChoiceMode(ListView.CHOICE_MODE_SINGLE);
}

public class MySimpleAdapter extends SimpleAdapter{

    public MySimpleAdapter(Context context,
                            List<? extends Map<String, ?>> data,
                            int resource,
                            String[] from, int[] to) {
        super(context, data, resource, from, to);           
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent){
        View returnView = super.getView(position, convertView, parent);
        TextView shopName = (TextView)returnView.findViewById(R.id.shop_name);
        shopName.setTextSize(20.0f);
        return returnView;
    }

}

private final String KEY_SHOP_NAME = "shop name";
private final String KEY_SHOP_ADDRESS = "shop address";
private SharedPreferences sharedPreferences;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T19:31:13.690

只需在 , 的`getView()`方法中执行此操作`Adapter`即可设置`font`大小。

`tv.setTextSize(20.0f);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T19:24:41.853

如果您使用 xml 来设置布局，`list_item`那么`TextView`您可以像这样更改文本的大小：

```
<TextView  
    android:id="@+id/text_id"
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content" 
    android:textSize="20sp" /> // This is a size of your text 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T19:26:12.560

没有“文本大小”您可以更改 TextView 内的文本大小：添加：

```
 android:textSize="16sp" 
```

到您的 XML 或者您可以通过适配器中的 getView() 方法中的代码来完成：

```
YOUR_TEXTVIEW.setTextSize(16); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-15T15:51:15.723

我知道这可能有点晚了，但是我注意到每个人都在他们的答案中忘记了一些东西。方法 setTextSize 需要 2 个参数作为输入。第二个如果浮点数是您想要的大小的数字。第一个是 TypedValue 常量，用于指定数字的含义，即：像素、倾角、sp 等……所以对于设置为 18sp 的 setTextSize，它看起来像这样：

```
TextView yourTextView = (TextView)findViewById(R.id.yourTextViewId);
yourTextView.setTextSize(TypedValue.COMPLEX_UNIT_SP,18) 
```

您可以在 ArrayAdapter 的 getView 中执行此操作。希望这可以帮助其他正在寻找答案并偶然发现这个答案的人。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-05T08:17:52.297

试试这个

```
TextView textView = (TextView) findViewById (R.id.yourTextViewId);
textView.setTextSize(18); 
```

# c++ - 新分配堆内存的初始内容（VS2010）

> ID：12734325
> 
> 赞同：0
> 
> 时间：2012-10-04T19:18:29.983
> 
> 标签：c++, multithreading, visual-c++

下面是一个简单的 VC++ 程序片段，该程序在 Visual Studio 10 上运行，支持线程构建块（开源 4.1）。

我从示例中编译并运行了一个程序，并且惊讶地看到来自 cout 的 new 运算符的输出。

```
int main() {
  string str[N] = { string("a"), string("b") };
  for (size_t i = 2; i < N; ++i) str[i] = str[i-1]+str[i-2];
  string &to_scan = str[N-1];
  size_t num_elem = to_scan.size();

  size_t *max = new size_t[num_elem];
  size_t *pos = new size_t[num_elem];
  cout <<"*max : " << *max<< ", "<<"*pos :"<<*pos<<endl;
......
...... 
```

cout 输出如下所示：

*最大值：3452816845，*位置：3452816845

**令我惊讶的是在这两种情况下 max 和 pos 的值相同。**

这可能是由于库中新运算符的一些重载吗？

或者

这是要报告的错误吗？

或者

这只是巧合吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:35:38.363

堆上新分配空间的内容是未定义的，因为它不会被 operator new 为标准类型初始化。该值转换为十六进制的 0xCDCDCDCD，我猜由于某种原因，整个堆区域都充满了这种模式。

更多细节：

*   您在堆上分配了两个 size_t 类型的数组。由于 size_t 是 unsigned int 的 typedef，因此 opreator new 只会在堆上分配空间（就像 malloc 那样），但不会调用任何构造函数或以任何方式初始化内存。
*   分配的数组被分配给 size_t 类型的指针，然后指向数组的第一个元素。
*   cout 语句正在打印指针指向的内存的内容（因为指针被取消引用），其中包含之前存储在那里的任何内容。

# c - 字符矩阵作为参数发送

> ID：12734326
> 
> 赞同：0
> 
> 时间：2012-10-04T19:18:36.560
> 
> 标签：c, pointers

如果我创建一个

字符 [100][100];

并发送到函数 void func(char** a); 它说 char ( *)[100] 不能转换为 char **。

我想象一个 char [100][100] 就像一个指向指针的指针。我错了吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:20:39.883

是的，你确实错了。a`char[100][100]`是 (array of 100 `char`) 的数组，当将其传递给函数时，它被转换为指向 (array of 100 `char`) a 的指针`char (*)[100]`。当作为函数参数传递时，数组到指针的转换只影响数组的最外层。

您可以将函数声明为采用该类型的参数，

```
void func(char (*)[100]); 
```

如果您将始终传递具有 100 列的数组，或者如果您想保留函数的类型，则必须传递不同的参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T19:41:01.993

您可以保持简单并像这样声明它：

```
void func(char a[100][100]); 
```

如果您的系统支持可变长度数组，您可以执行以下操作：

```
void func(int nRows, int nCols, char a[nRows][nCols]); 
```

第二种方法允许您将任何大小的二维数组传递给函数。

# mysql - 来自 information_schema 的约束细节（更新级联，删除限制）

> ID：12734331
> 
> 赞同：7
> 
> 时间：2012-10-04T19:18:46.217
> 
> 标签：mysql, foreign-keys, constraints, information-schema

我需要的关于数据库的几乎所有信息，都可以在 information_schema 中找到

这次我需要**通过单个查询读取数据库中所有外键的**详细信息，我在 information_schema.key_Column_usage 中找到了所有内容，但找不到`constraints like on delete, on update`

我可以`show create table`为所有单独的桌子做。但是有没有办法通过这样的选择查询来获取这些详细信息？

```
SELECT CONSTRAINT_NAME, TABLE_NAME,COLUMN_NAME, REFERENCED_TABLE_NAME, 
REFERENCED_COLUMN_NAME FROM information_schema.`KEY_COLUMN_USAGE` WHERE 
table_schema = 'mydbname' AND referenced_column_name IS NOT NULL 
```

它做得很好，但只是缺少一些约束，比如`on delete, on update`我怎样才能获得这些值，以便我可以在单个查询中获取有关外键的所有信息？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-01-22T14:47:06.977

`UPDATE_RULE``DELETE_RULE`是你要的东西

这有点太晚了，但它可以帮助其他人，这里是解决方案：

```
SELECT tb1.CONSTRAINT_NAME, tb1.TABLE_NAME, tb1.COLUMN_NAME,
tb1.REFERENCED_TABLE_NAME, tb1.REFERENCED_COLUMN_NAME, tb2.MATCH_OPTION,

tb2.UPDATE_RULE, tb2.DELETE_RULE

FROM information_schema.`KEY_COLUMN_USAGE` AS tb1
INNER JOIN information_schema.REFERENTIAL_CONSTRAINTS AS tb2 ON
tb1.CONSTRAINT_NAME = tb2.CONSTRAINT_NAME
WHERE table_schema = 'sfa' AND referenced_column_name IS NOT NULL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-05T20:49:59.497

**更新**从`information_schema.REFERENTIAL_CONSTRAINTS`表中**添加 mysql 5.1** [mysql-5.1](https://docs.oracle.com/cd/E19078-01/mysql/mysql-refman-5.1/)我们可以获得有关所有约束的信息**。接受的答案将解决方案作为查询提供。

**早前**[mysql-5.0](https://docs.oracle.com/cd/E19078-01/mysql/mysql-refman-5.0/) 等 mysql 5.1 之前，我们无法获取此信息，只能`show create table`用于单个表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T20:03:02.563

如果您正在寻找 (primary|foreign|unique) 键：

[http://dev.mysql.com/doc/refman/5.5/en/table-constraints-table.html](http://dev.mysql.com/doc/refman/5.5/en/table-constraints-table.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-09T09:27:04.313

现在，您可以在表 INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS 中找到外键约束的详细信息

[http://dev.mysql.com/doc/refman/5.5/en/referential-constraints-table.html](http://dev.mysql.com/doc/refman/5.5/en/referential-constraints-table.html)

# entity-framework-5 - 来自数据库的 Entity Framework 5 更新模型不生成表类

> ID：12734333
> 
> 赞同：16
> 
> 时间：2012-10-04T19:19:02.677
> 
> 标签：entity-framework-5

我在 VS2012 中使用 EF5，数据库优先方法。

当我将一个新表 X 添加到设计图面时，该表显示，然后我保存并编译没有错误。但是，从未生成任何类 X（在解决方案资源管理器中的 MyModel.tt 下）。

如果我右键单击 MyModel.tt 并选择“运行自定义工具”，则会生成类。

这种行为与我在 EF4 和 VS 2010 中所经历的不同，其中类是自动生成的。

1.  我可以更改此行为以便自动生成表类吗？
2.  为什么表的类不自动生成？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-04T21:29:27.713

这是 VS2012 中的一个错误。更多细节在这里：[http ://entityframework.codeplex.com/workitem/453](http://entityframework.codeplex.com/workitem/453)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T06:01:15.367

这已在今天发布的 VS 2012 Update 1 中修复。您可以从以下网址获取它：http: [//www.microsoft.com/visualstudio/eng/downloads#d-visual-studio-2012-update](http://www.microsoft.com/visualstudio/eng/downloads#d-visual-studio-2012-update)

# java - 如何在编译期间逐步调试注释处理器？

> ID：12734335
> 
> 赞同：10
> 
> 时间：2012-10-04T19:19:19.903
> 
> 标签：java, debugging, maven, ant, annotation-processing

我有一个注释处理器，用于保留策略 = SOURCE 的注释。

我不知道如何逐步调试它。

*   我在运行 mvn install、compile or package 或 ant javac 时发出了打印语句、记录器信息，并且我在编译日志中看到了它们的 sysout。

*   但是，我不知道如何在 Eclipse 中逐步调试处理器。我的意思是，你如何逐步调试编译时间？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-11-06T21:49:57.787

最近的一个选项是使用[http://github.com/google/compile-testing](http://github.com/google/compile-testing)之类的东西，它允许您针对任意注释处理器调用编译作业，您可以设置断点、逐步执行等。

```
@Test public void testStuff() {
  // Create a source file to process, or load one from disk.
  JavaFileObject file = JavaFileObjects.fromSourceLines("test.Foo",
    "package test;",
    "",
    "import bar.*;",
    "",
    "@MyAnnotation(blah=false)",
    "interface TestInterface {",
    "  Bar someBar();",
    "}",

  // assert conditions following a compilation in the context of MyProcessor.
  assert_().about(javaSource()).that(file)
      .processedWith(new MyProcessor())
      .failsToCompile()
      .withErrorContaining("some error message").in(file).onLine(5);
} 
```

此测试预计您会收到一些错误消息，因为在测试数据源中错误地声明了 @MyAnnotation。如果此断言失败，您可以在 IDE 中以调试模式运行它，在 MyProcessor 中设置断点，并在调试期间使用完整的编译器环境进行单步调试。

*对于处理器中的特定方法的*单元测试，您还可以使用名为 CompilationRule 的 @Rule，您可以从中获取 Elements 和 Types 实用程序类，以便以更独立的方式测试编译器中的特定逻辑。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-04T20:49:26.587

您必须使用调试配置从 Eclipse 调用 Java 编译器（您需要从“调试配置...”菜单选项手动创建配置。

在 JDK 1.6 或更高版本下调用 Java 编译器的“正确”方法是使用[javax.tools中的](http://docs.oracle.com/javase/6/docs/api/javax/tools/package-summary.html)[JavaCompiler](http://docs.oracle.com/javase/6/docs/api/javax/tools/JavaCompiler.html)接口，您可以从[ToolProvider](http://docs.oracle.com/javase/6/docs/api/javax/tools/ToolProvider.html)获得该接口（我包括了所有链接，因为您有大量的类/包文档应该读）。

“快速而肮脏”的方式（*应该*有效，但我不保证）是调用`com.sun.tools.javac.Main.main()`，将您的正常命令行参数传递给它。为此，您需要`tools.jar`在您的类路径中（在 中找到它`$JAVA_HOME/lib`）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-29T14:05:38.507

注解处理在编译过程中进行，因此无法正常调试。如果你想在你的项目上下文中调试它，你可以使用 Eclipse 远程调试，同时让 Gradle 或 Maven 处于调试模式。然后您可以在注释处理器的文件中放置断点。

请参阅[在任何项目中调试注释处理器](https://blog.xmartlabs.com/2016/03/28/Debugging-an-Annotator-Processor-in-your-project/)。

免责声明：我写了这篇文章。

# c - 多播绑定 - 地址已在使用中

> ID：12734338
> 
> 赞同：1
> 
> 时间：2012-10-04T19:19:31.910
> 
> 标签：c, linux, bind, multicast

我尝试在我的应用程序中绑定多播端口。以前代码总是有效，但在这个服务器上它（经常，但不总是）失败......

错误消息是`Address already in use`，我不太明白，因为可以绑定来自多个应用程序（甚至来自同一个应用程序）的相同地址......

什么可能导致这种情况？我知道有人会要求它，所以这里是代码：

```
int fd = socket(PF_INET, SOCK_DGRAM, 0);
/* yes, that's a valid socket, verified.... */

u_int val = 1;
if(setsockopt(fd, SOL_SOCKET, SO_REUSEADDR, &val, sizeof(val)) < 0) {
    perror("Reusing ADDR failed");
    exit(1);
}

struct sockaddr_in saddr;
saddr.sin_family = PF_INET;
saddr.sin_addr.s_addr = inet_addr(multicast_group_ip);
saddr.sin_port = htons(port);
/* yes, valid multicast ip address and port, verified */

if(bind(fd, (struct sockaddr *) &saddr, sizeof(struct sockaddr_in)) == -1)
    //FAILS.... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-11-23T15:49:32.887

您实际上可以将多个数据报套接字绑定到同一个多播组和端口。但是，所有这些套接字都应该设置 SO_REUSEADDR 选项。根据您的代码，您似乎正在这样做，但听起来您的服务器上有另一个进程已将套接字绑定到相同的多播组和端口，而没有设置该选项。解决方案是确保此特定服务器上将套接字绑定到该多播组和端口的所有进程都设置 SO_REUSEADDR 选项。

编辑：
为了回应您上面最近的评论，您可以实际重现此问题的一种方法是创建两个简单的多播侦听程序，它们都将数据报套接字绑定到相同的端口和组。让其中一个程序设置 SO_REUSEADDR 选项，而不是另一个。运行没有设置 SO_REUSEADDR 的程序，您应该会看到多播数据通过。在离开这个程序的同时，运行第二个设置了 SO_REUSEADDR 的程序，您应该看到它不会在第一个程序仍在接收它时接收任何多播数据（这应该会复制您最初描述的问题）。

最后关闭两个程序，然后修改第一个程序设置SO_REUSEADDR，重复上述步骤。您现在应该看到两个程序都接收到多播流量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:22:27.980

一个进程可能有多个打开的套接字`host:port`，不可能有多个进程正在侦听（即绑定）同一个`host:port`.

也许，您之前的服务器进程实例未被杀死。

~~Wug 提到的另一个选项是您尝试绑定到低于 1024 的端口而不是 root。低端口 1-1024 的范围是为有效 UID == 0 的应用程序保留的，例如，由 root 启动。~~似乎是错误的假设，因为在这种情况下你会得到不同的错误，而不是`already in use`.

# php - 如何创建使用对象上下文的运行时函数？

> ID：12734340
> 
> 赞同：3
> 
> 时间：2012-10-04T19:19:45.187
> 
> 标签：php, object, dynamic, methods, lambda

我有一个类，我有一个动态创建的函数（通过“create_function”创建），但我找不到方法告诉 PHP 我希望仅为这个类创建这个函数（类函数），因此新的函数无法访问对象属性。看看下面的代码：

```
class Test {
  private $var=1;

  function __construct() {
      call_user_func(create_function('', 'echo $this->var;'));
  }
}

new Test; 
```

这会引发错误“致命错误：不在 D:\WWW\index.php(7) 的对象上下文中使用 $this：第 1 行运行时创建的函数”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T19:24:40.813

你可能想要[`runkit_method_add`](http://bg2.php.net/manual/en/function.runkit-method-add.php)，不是`create_function`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T19:25:15.513

从 php 5.4 开始，匿名函数也在`$this`其上下文中。在魔术`_call`方法的帮助下，可以将闭包作为方法添加到类中，而无需额外的代码：

```
class Test
{
  private $var = 1;

  function __construct()
  {
    $this->sayVar = function() { echo $this->var; };
  }

  public function __call( $method, $args )
  {
    if ( property_exists( $this, $method ) ) {
      if ( is_callable( $this->$method ) ) {
        return call_user_func_array( $this->$method, $args );
      }
    }
  }

}

$test = new Test();
$test->sayVar(); // echos 1 
```

# php - 使用 curl 时如何保护 cookie？

> ID：12734341
> 
> 赞同：1
> 
> 时间：2012-10-04T19:19:48.010
> 
> 标签：php, curl, session-cookies

我在我网站的产品页面上创建了一个库存检查器。它由一个 AJAX 提交按钮组成，单击该按钮时，将使用以下 curl 函数检索产品的库存：

```
function inventory($sku) {
  $url = 'http://www.example.com/product/' . $sku;
  $curl = curl_init($url);
  $referer = 'http://www.google.com/search';
  curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
  curl_setopt($curl, CURLOPT_COOKIEFILE, '/cookie.txt'); 
  curl_setopt($curl, CURLOPT_REFERER, $referer);
  curl_setopt($curl, CURLOPT_FOLLOWLOCATION, false);
  curl_setopt($curl, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US)AppleWebKit/534.10 (KHTML, like Gecko) Chrome/8.0.552.224 Safari/534.10');
  $html = curl_exec($curl);
  curl_close($curl);
...
} 
```

我要连接的 url 是我的供应商网站，它要求我登录才能访问他们的库存页面。这些页面只能通过 http 访问。我复制了供应商站点发送的 cookie，并将过期日期设置为 0。cookie 包含一个 ASP.NET SessionId。

我有办法保护 cookie 吗？如果不是，那么有人劫持 cookie 并在我的登录名下访问我的供应商网站是多么容易。据我了解，中间人攻击必须来自我的服务器和我的供应商服务器之间的某个人。这个对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:26:31.697

第一步，`https://`用于您的 ajax 调用。除非您在供应商的服务器上有能够解密自定义加密的代码（假设您对您的 cookie 数组进行 JSON 编码，然后使用 mcrypt 对其进行加密 - 然后在供应商站点上解密并重建），否则您将受制于供应商端的 RESTful API。如果他们不需要 SSL，那么您就是一种 SOL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:27:54.497

保护任何 HTTP 流量的最简单方法是使用 HTTPS。通过将整个内容包装在 SSL 中，在不解密请求的情况下唯一可见的是请求的域名。

如果他们只允许通过 HTTP 访问它，也许您应该与他们讨论投资 SSL 证书......即使它是自签名证书（这样做提供加密，但不验证身份另一端的服务器，因此大多数浏览器都会认为它不安全，即使流量仍然是加密的）。如果您的供应商只提供 HTTP，他们就会让自己受到攻击，尤其是在涉及任何类型的会话 id 的情况下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T21:45:31.707

您真的是指您通过 HTTP 而不是 HTTPS 访问您的库存供应商吗？

如果是这样，那么无论如何您都无法使用 cookie，因为整个通信是不安全的，并且可以随意嗅探或拦截 - 如果您担心这一点，就没有任何帮助。

另一方面，cookie 本身通常由服务器设置，并且有两个可用选项：1）httponly 2）安全。

1) httponly 告诉浏览器不要让这个 cookie 对 Javascript 可用，而只是在下一个请求时通过 HTTP 将它发送回来，直到它过期。

2)secure 告诉浏览器不要通过未加密的通信发送cookie，即只通过HTTPS 发送，而不是HTTP。

你的 curl 是浏览器。你的 curl 没有 javascript，所以第一个选项没用。即使这样，您的 curl 也必须知道应该设置哪个 cookie，并且您可以轻松地忽略服务器不希望将其提供给 Javascript。

仅当您对其进行编程时，您的 curl 才会发回 cookie。如果您认为使用不安全的通道是个好主意，那么安全标志不会阻止您这样做，但它不会为 cookie 本身增加安全性。

Cookie 值在通信双方始终未加密。通过使用 HTTPS 添加了唯一的针对嗅探的安全性。有关 cookie 选项的任何其他内容只是为了保护浏览器的行为，以降低 cookie 被不应该知道的第三方知道的风险。

发回 cookie 时，没有可以添加的选项。

# ios - facebook phonegap 插件未出现在 xcode 中

> ID：12734346
> 
> 赞同：2
> 
> 时间：2012-10-04T19:20:08.250
> 
> 标签：ios, xcode, facebook, cordova

想第一次用 xcode 和 phonegap 做点什么。因为我在做很多 Facebook 应用程序，所以我想用 Facebook 登录构建一个原生 iOS 应用程序。

遵循此处的步骤：[https ://github.com/davejohnson/phonegap-plugin-facebook-connect](https://github.com/davejohnson/phonegap-plugin-facebook-connect)

有问题，插件不显示。

我将它复制到我项目的插件文件夹中：http: [//i.stack.imgur.com/ueYk0.png](http://i.stack.imgur.com/ueYk0.png)

但它现在在 Xcode 中显示为项目结构中的黄色文件夹或文件。

认为这是合乎逻辑的，我收到以下错误：

```
["org.apache.cordova.facebook.Connect2","org.apache.cordova.facebook.Connect","init",["471175846247043"]]
2012-10-04 21:10:19.015 HelloWorld[5476:c07] CDVPlugin class FacebookConnectPlugin (pluginName: org.apache.cordova.facebook.Connect) does not exist.
2012-10-04 21:10:19.017 HelloWorld[5476:c07] ERROR: Plugin 'org.apache.cordova.facebook.Connect' not found, or is not a CDVPlugin. Check your plugin mapping in Cordova.plist.
2012-10-04 21:10:19.018 HelloWorld[5476:c07] FAILED pluginJSON = ["org.apache.cordova.facebook.Connect3","org.apache.cordova.facebook.Connect","getLoginStatus",[]]
2012-10-04 21:10:23.571 HelloWorld[5476:c07] CDVPlugin class FacebookConnectPlugin (pluginName: org.apache.cordova.facebook.Connect) does not exist.
2012-10-04 21:10:23.573 HelloWorld[5476:c07] ERROR: Plugin 'org.apache.cordova.facebook.Connect' not found, or is not a CDVPlugin. Check your plugin mapping in Cordova.plist.
2012-10-04 21:10:23.575 HelloWorld[5476:c07] FAILED pluginJSON = ["org.apache.cordova.facebook.Connect4","org.apache.cordova.facebook.Connect","login",["email"]] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T11:43:00.733

您只是缺少属性列表配置。根据 README 说明执行以下操作：

在项目导航器中找到 Cordova.plist 文件，展开“插件”子树，并添加一个新条目。对于键，添加 org.apache.cordova.facebook.Connect，其值为 FacebookConnectPlugin

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:30:27.567

确保将条目添加到 Cordova.plist。“org.apache.cordova.facebook.Connect”作为键，FacebookConnectPlugin 作为值。

然后，确保您已经创建了一个 Facebook 应用程序并将您的捆绑包 ID 放入 Native IOS 应用程序部分。不要忘记也启用登录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-02T17:19:01.940

我必须恢复到它才能工作：

```
<plugin name="org.apache.cordova.facebook.Connect" value="FacebookConnectPlugin" /> 
```

我想使用它，但我收到了您提到的错误消息：

```
<feature name="org.apache.cordova.facebook.Connect">
    <param name="ios-package" value="FacebookConnectPlugin" />
</feature> 
```

# c# - 网格视图中交替行的颜色

> ID：12734349
> 
> 赞同：1
> 
> 时间：2012-10-04T19:20:17.670
> 
> 标签：c#, asp.net, migration

我正在使用 C# 环境，我测试了以下代码，它在 Visual Basic .Net 下工作：

```
Private Sub GridView1_RowCreated(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles GridView1.RowDataBound  
    if e.Row.RowType = DataControlRowType.DataRow then

        Dim RowNum as Integer
        RowNum = e.Row.RowIndex

        if RowNum mod 2 = 1 then
            e.Row.Attributes.Add("onmouseout", "this.style.backgroundColor='#DDDDDD'")
        else
            e.Row.Attributes.Add("onmouseout", "this.style.backgroundColor='#FFFFFF'")
        end if

        e.Row.Attributes.Add("onmouseover", "this.style.backgroundColor='DeepSkyBlue'")
        e.Row.Attributes("onclick") = Me.Page.ClientScript.GetPostBackClientHyperlink(Me.GridView1, "Select$" & e.Row.RowIndex) 
    End If
End Sub 
```

因此，我尝试将其转换为 C# 语言，但无法正常工作。

1.  C# 中没有“句柄”选项

2.  不知何故，“ `e.Row.Attributes("onclick")`”在 VB 中有效，但在 C# 中无效

    ```
    private void GridView1_RowCreated(object sender, System.Web.UI.WebControls.GridViewRowEventArgs e)
    {
        if (e.Row.RowType == DataControlRowType.DataRow)
        {
            int RowNum = e.Row.RowIndex;
            if (RowNum % 2 == 1)
            {
                e.Row.Attributes.Add("onmouseout", "this.style.backgroundColor='#DDDDDD'");
            }
            else
            {
                e.Row.Attributes.Add("onmouseout", "this.style.backgroundColor='#FFFFFF'");
            }

            e.Row.Attributes.Add("onmouseover", "this.style.backgroundColor='DeepSkyBlue'");
            e.Row.Attributes("onclick") = this.Page.ClientScript.GetPostBackClientHyperlink(this.GridView1, "Select$" & e.Row.RowIndex);
        }
    } 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:29:00.393

将其更改为：

```
e.Row.Attributes["onclick"] = this.Page.ClientScript.GetPostBackClientHyperlink(this.GridView1, "Select$" + e.Row.RowIndex); 
```

在 C# 中，数组是用括号而不是括号调用的。此外，我们使用加号而不是 & 号来连接字符串。

您也可以这样做（以匹配其正上方的代码）：

```
e.Row.Attributes.add("onclick", this.Page.ClientScript.GetPostBackClientHyperlink(this.GridView1, "Select$" + e.Row.RowIndex)); 
```

# java - 传递给数组时使用文本文件的扫描仪 i/o 问题

> ID：12734356
> 
> 赞同：1
> 
> 时间：2012-10-04T19:20:40.727
> 
> 标签：java, arrays, object, io

实际代码用于将值编码为数组中每个对象的属性。但是，它仅使用最后一行的信息来填充每个值。

```
Scanner data = new Scanner(new DataInputStream(new FileInputStream("trucklist.txt")));
for (int i = 0; i < maxSize; i++) 
{   for(;data.hasNext();)
    {
        t[i].setVin(data.next());
        t[i].setMake(data.next());
        t[i].setModel(data.next());
        t[i].setColor(data.next());
        t[i].setYear(data.next());
        t[i].setBaySize(data.nextDouble());
        t[i].setCabSize(data.nextDouble());

        addElement(t[i]);
    }
} 
```

哪里`trucklist.txt`是：

```
12x4578w Ford F-150 Black 2005 17.2 6.8
12x4589w Ford F-150 Blue 2005 17.2 6.8
12x4587f Ford F-250 Black 2007 60.8 9.5
12x4589z Ford F-150x White 2005 15.4 10.2 
```

数组元素仅由每个元素的最后一组属性填充。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:25:58.787

由于这是当前写入的，`i`因此在仍有数据要读取时不会增加。试试这个：

```
for (int i = 0; i < maxSize && data.hasNext(); ++i) {
    // set attributes of t[i]
    addElement(t[i]);
} 
```

作为旁注，此例程**非常**依赖于格式正确的数据文件，如果数据格式错误，将抛出未经检查的异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:40:03.593

**-** `FileInputStream`够用了，这里**不用**用`DataInputStream`。

**-**使用 a `Collection`than总是更好`array`，因为它更灵活。

**请参阅此工作代码：**

```
public class Test {

    public static void main(String[] args) {

        File f = new File("D:\\text.txt");  ///-----Change the Path here-----///

        ArrayList<String> arList = new ArrayList<String>();

        try {
            Scanner scan = new Scanner(new FileInputStream(f));
            while (scan.hasNextLine()) {

                 arList.add(scan.nextLine());
            }
        } catch (FileNotFoundException e) {

            e.printStackTrace();
        }

        for(String s : arList){
        System.out.println(s);
        }

    }
} 
```

# sql-server - 尝试确定磁盘上表的真实大小时如何解释 sp_spaceused() 结果？

> ID：12734360
> 
> 赞同：0
> 
> 时间：2012-10-04T19:20:53.447
> 
> 标签：sql-server, sql-server-2008

我正在尝试根据 SQL Server 2008 中的一些当前数据库表大小进行一些容量规划。这里的目标是根据“过去的天气”确定我将来可能需要多少磁盘存储空间。

我在 sp_spaceused() 的 MSDN 文档页面中没有看到任何关于如何准确解释一个表的结果的内容。 [http://msdn.microsoft.com/en-us/library/ms188776.aspx](http://msdn.microsoft.com/en-us/library/ms188776.aspx)

是否只是求和的问题：保留 + 数据 + index_size + 未使用？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:32:59.503

我记得，它是：

```
reserved = ( data + index_size + unused ) 
```

# html - Typo3 - 在 RTE 中启用微数据属性 itemprop、itemscope 和 itemtype

> ID：12734364
> 
> 赞同：1
> 
> 时间：2012-10-04T19:21:15.130
> 
> 标签：html, typo3, rich-text-editor, microdata, rte

要在 RTE 中启用[微数据](http://en.wikipedia.org/wiki/Microdata_%28HTML%29)，我认为我必须在根页面 TSconfig 中为 RTE 配置中的每个标签添加属性。

有很多例子，如何为标签添加属性，例如 xml:lang：

```
RTE.default.proc {
  entryHTMLparser_db = 1
  entryHTMLparser_db.allowTags < RTE.default.proc.allowTags
  entryHTMLparser_db.tags.div.allowedAttribs = xml:lang
} 
```

这工作得很好。

但是当我尝试将它用于 itemprop、itemscope 和 itemtype 时：

```
RTE.default.proc {
  entryHTMLparser_db = 1
  entryHTMLparser_db.allowTags < RTE.default.proc.allowTags
  entryHTMLparser_db.tags.div.allowedAttribs = itemprop, itemscope, itemtype
} 
```

它不工作。有人知道如何在 RTE 中添加微数据属性吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T11:18:16.697

@pcampe 您是说 TYPO3 4.7 规范吗？[http://wiki.typo3.org/TYPO3_4.7#HTML5_frontend_rendering](http://wiki.typo3.org/TYPO3_4.7#HTML5_frontend_rendering)

我要启用微数据属性的站点是 Typo3 4.5 LTS。所以我认为不可能在 Typo3 < 4.7 中使用微数据？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T01:15:19.147

你把这个输入到`tsconfig`? 这对我来说似乎工作得很好。您将需要`itemscope="itemscope"`在`div`标签上指定属性。

# c++ - 如何在 C++ 中生成 0 到 4 之间的随机数？

> ID：12734374
> 
> 赞同：0
> 
> 时间：2012-10-04T19:22:00.077
> 
> 标签：c++, random

> **可能重复：**
> [如何从一个范围内生成一个随机数 - C](https://stackoverflow.com/questions/2509679/how-to-generate-a-random-number-from-within-a-range-c)

我想生成一个介于 0 和 4 之间的随机数。我怎样才能在 C++ 中做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-04T19:23:13.817

您可以调用`std::rand()`，使用模运算符将范围限制为所需的范围。

```
std::rand()%5 
```

您还可以查看新的 C++11[随机数生成实用程序](http://en.cppreference.com/w/cpp/numeric/random)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T19:37:43.633

为了完整起见，我向您展示了使用新`random`工具的 C++11 解决方案：

```
#include <random>
#include <ctime> 

int main() {
    std::minstd_rand generator(std::time(0)); 
    std::uniform_int_distribution<> dist(0, 4);
    int nextRandomInt = dist(generator);
    return 0;
} 
```

# vim - 需要一些帮助来编写自定义动作

> ID：12734386
> 
> 赞同：1
> 
> 时间：2012-10-04T19:22:40.923
> 
> 标签：vim

我想要一个动作跳到代码块的末尾。我写了一个函数，我正在尝试对其进行映射，但它不起作用。这是我所做的：

```
onoremap <silent> } :set opfunc=MovementToEdgeOfBlock(1)<cr>g@ 
```

如果我只是这样做：

```
nnoremap <silent> } :call MovementToEdgeOfBlock(1)<cr> 
```

然后该功能按预期工作。但我更需要它作为其他命令的动作。那么我做错了什么？

这是函数本身（我不认为问题出在函数中，但无论如何）：

```
function! MovementToEdgeOfBlock(direction)
    let startLine=line(".")
    function! HowManyTabs(line)
        let i=0
        while a:line[i]==#"\t"
            let i+=1
        endwhile
        return i
    endfunction
    let startLineTabs = HowManyTabs(getline("."))
    echom startLineTabs " tabs"
    if a:direction==1
        let tabs=HowManyTabs(getline(line('.')+1))
    else
        let tabs=HowManyTabs(getline(line('.')-1))
    endif
    while tabs>startLineTabs
        if a:direction==1
            execute "normal! j"
        else
            execute "normal! k"
        endif
        let tabs=HowManyTabs(getline(line('.')))
    endwhile
endfunction 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T21:08:23.457

您是否`:h 'opfunc'`仔细阅读，包括`:h g@`那里引用的内容？它与您想要实现的目标完全无关。更多，`g@`从未打算在操作员挂起模式下工作。更重要的是，`'opfunc'`选项接受一个函数名，而不是像你试图传递它的表达式，并传递这个函数一个字符串参数。

您应该首先尝试为操作符挂起模式创建与在正常模式下使用的*完全相同的映射。*如果这不起作用，请尝试使用`<expr>`映射：我会将您的函数编写如下：

```
" Do not redefine function each time ToEdgeOfBlock is called,
" put the definition in global scope: There is no way to have 
" a local function in any case.
" The following does exactly the same thing your one used to do (except 
" that I moved getline() here), but faster
function! s:HowManyTabs(lnr)
    return len(matchstr(getline(a:lnr), "^\t*"))
endfunction
function! s:ToEdgeOfBlock(direction)
    let startlnr=line('.')
    let startlinetabs=s:HowManyTabs(startlnr)
    let shift=(a:direction ? 1 : -1)
    let nextlnr=startlnr+shift
    while s:HowManyTabs(nextlnr)>startlinetabs && 1<=nextlnr && nextlnr<=line('$')
        let nextlnr+=shift
    endwhile
    return nextlnr.'gg'
endfunction
noremap <expr> } <SID>ToEdgeOfBlock(1) 
```

我的版本还允许您使用`<C-o>`.

# sql-server - 如何根据插入日期插入

> ID：12734393
> 
> 赞同：2
> 
> 时间：2012-10-04T19:23:00.900
> 
> 标签：sql-server

我有一个表 tbl1（帐户，last_contact_date，insert_date）。我定义的主键是 account 和 last_contact_date。例如

```
account    last_contact_date    insert_date
0001       09/01/2012           10/01/2012
0001       09/02/2012           10/02/2012 
```

现在我有一条新记录，它来自另一个临时表#tmp(account, last_contact_date)。根据last_contact_date或insert_date，我将有条件地插入： (1)如果插入日期是同一天，我将用最大last_contact_date更新帐户；

```
(0001, 09/01/2012, 10/02/2012) --no
(0001, 09/02/2012, 10/02/2012) --no
(0001, 09/03/2012, 10/02/2012) --update 
```

（2）如果插入日期是前一天，什么都不做（我知道这永远不会发生）

```
(0001, 09/01/2012, 10/01/2012) --no
(0001, 09/02/2012, 10/01/2012) --no
(0001, 09/03/2012, 10/01/2012) --no 
```

(3) 如果插入日期是第二天或更晚，我将插入一条新记录，最大 last_contact_date。

```
(0001, 09/01/2012, 10/03/2012) --no
(0001, 09/02/2012, 10/03/2012) --no
(0001, 09/03/2012, 10/03/2012) --insert 
```

谁能帮我写这个查询？我真的没有主意了。

更新：我最终使用游标编写上述逻辑。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:48:44.650

您需要一个 IF 来处理这种情况，如下所示（假设您在变量中有当前帐户和 insert_date：

```
-- First try to update
UPDATE tbl1 SET <whatever you need to update>
WHERE account = @account AND insert_date = @insert_date
    AND last_contact_date = 
        (SELECT MAX(last_contact_date) FROM tbl1
         WHERE account = @account AND insert_date = @insert_date)

-- Update failed because no matching record was found?
IF @@ROWCOUNT = 0
BEGIN
    INSERT <new record>
END 
```

如果多个进程/线程同时执行此操作，您可能会违反主键，因为没有一个找到记录，然后都尝试插入。您需要将此代码放入 SERIALIZABLE Transaction 以防止这种情况或使用其他一些逻辑锁定机制。

# jquery - 对不同页面上的颜色框使用不同的 CSS 样式？

> ID：12734395
> 
> 赞同：2
> 
> 时间：2012-10-04T19:23:09.057
> 
> 标签：jquery, css, colorbox

我在一个站点上使用 Colorbox（用于弹出窗口的 js 库）。在某些页面上，我需要对颜色框和/或其部分使用不同的外观（例如关闭框，使用不同的 png 文件）。

由于 js 库会动态生成弹出 div 的代码，那么在不复制任何代码的情况下，为网站上的不同页面处理不同“外观”的最有效方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:28:00.033

虽然它即时生成 HTML，但它仍然使用与其他所有内容相同的 CSS。因此，只需使用所需的 css 添加所需的页面`<style>`标签，这将覆盖默认样式或准备几个 css 文件，其中 css 规则覆盖默认样式，您将在需要时将其附加到您的页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T20:06:56.897

您可以考虑的一件事是颜色框本身没有 CSS，而是在其自己的页面中弹出内容并通过 ajax 调用它。将特定弹出窗口的所有 CSS 都放在其自己的页面中。我以前用过这种方法。颜色框文件中唯一需要的 CSS 是背景颜色/透明度/图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T19:31:00.830

给`<body>`一个`id`与文件名相同的an，例如`<body id="index">`and `<body id="about_us">`，而不是在文件中添加样式，`colorbox.css`例如

```
body#index wrapper gallery
{
 background-color: #foo;
} 
```

我使用[slimbox](http://www.digitalia.be/software/slimbox2)并按照上述方式进行操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T19:35:29.657

我不认为你需要一个单独的 CSS 文件。

让我们在第一页说你的颜色框在

```
<div class="divA">

    // Color Box 1
</div>

<div class="divB">

    // Color BoX 1
</div> 
```

你可以在 colorBox 类之前添加这个类来完成你的工作。

```
.divA  colorbox-class
{
    // Your Style Color Box 1
}

.divB  colorbox-class
{
    // Your Style Color Box 2
} 
```

# linux - Kannel分步安装教程

> ID：12734400
> 
> 赞同：2
> 
> 时间：2012-10-04T19:23:25.777
> 
> 标签：linux, ubuntu, sms, gateway, kannel

我一直在尝试安装 Kannel 开源网关，以便在我的计算机上发送免费短信。但是我从来没有通过阅读官方网站上的指南来使它工作。所以我重新开始，对我能得到的所有信息感兴趣。

*   我需要什么硬件？
*   我可以在 Ubuntu 12.04 上安装它吗？
*   有人可以发布一个好的教程的链接，或者在这里写一个关于逐步安装 Kannel 的链接。

编辑：此外，将不胜感激使用 php 脚本发送短信的示例。

**提前致谢 ：）**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-04T19:56:37.457

我很担心你“在我的电脑上发送**免费**短信”的想法。

虽然 Kannel 可用于从您的计算机发送 SMS，但您将需要其中之一：

*   GSM 调制解调器（[什么是 GMS 调制解调器](http://www.nowsms.com/faq/what-is-a-gsm-modem)）
*   [与 Kannel 一起作为 SMSC 工作](http://www.kannel.org/compatibility.shtml)的电话
*   SMSC（短消息服务中心。负责存储和转发消息的系统）的帐户。

SMSC 可能会向您收取服务费用。使用 GSM 调制解调器或电话意味着您拥有有效的 SIM 卡，并与付费手机套餐相关联。无论哪种方式，你都会付钱给某人。

[这里](https://launchpad.net/ubuntu/precise/+source/kannel)有适用于 Ubuntu 12.04 的软件包。

这是一个[很好的教程](http://thuannvn.blogspot.ca/2009/01/setting-up-configuring-and-using-kannel.html)，关于从源代码安装 Kannel 并使用 GSM 调制解调器对其进行配置。

# cocos2d-iphone - 增强现实和 Cocos3D

> ID：12734401
> 
> 赞同：0
> 
> 时间：2012-10-04T19:23:28.397
> 
> 标签：cocos2d-iphone, augmented-reality, cocos3d

我是 Cocos3d 的初学者。我使用 Cocos3D 项目模板创建了一个 cocos3d 项目。当我移动我的相机时，我希望 CC3MeshNode 会消失（它也在屏幕外，只有在相机移动到特定位置时才会出现）。我还设置了 shouldAutotargetCamera 和 shouldTrackTarget 是 YES 但它没有用。CC3MeshNode 总是出现在屏幕中心。如果你有 Cocos3D 的经验，请帮我解决。十分感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T16:49:28.110

if I understood your problem correctly, you should do steps like these:

1.  set up your scene (add CC3MeshNode into it)
2.  set `viewController.isOverlayingDeviceCamera = YES;` (this is line from cocos3d template from AppDelegate class)
3.  start to update your CC3Camera in scene with data from accelerometer. You could see my question (and answer) [here](https://stackoverflow.com/questions/11578304/cocos3d-and-augmented-reality) on how to do that. The "update:" method is CC3Scene's one.

Hope that would help!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-11T11:49:56.767

在 CC3Scene 中，onOpen 方法注释行 [self.activeCamera moveWithDuration: 3.0 toShowAllOf: self withPadding: 0.5f]。那么你的 meshNode 将不在屏幕中心。

# ios - UIImagePickerController cameraOverlayView 不适用于 iPhone 5？

> ID：12734407
> 
> 赞同：1
> 
> 时间：2012-10-04T19:23:51.553
> 
> 标签：ios, uiimagepickercontroller, iphone-5, camera-overlay

当 iPhone 5 出来时，我的自定义 cameraOverlay 不再排列以覆盖默认的相机快门和取消按钮。

我添加了一些代码来检测手机的硬件版本，并将 iPhone 5 的控件向下移动了一点。

好吧，现在那些自定义按钮不再接收点击事件，而是通过相机的按钮。为什么？

对于实验控制，我使用相同的代码重新定位 iPhone 4S 上的按钮（它们都运行 iOS 6）。因此，附上的两张图片使用相同的确切代码，但有一个常数（像素偏移）的差异。

在 4s 上，我的自定义按钮接收点击事件。在 5 上，点击事件属于相机的控件。这是一个错误吗？它确实看起来像。我希望其他人遇到同样的问题。

![在此处输入图像描述](../Images/3009bfc74fe5fbf7cbfad60798dc287d.png) ![在此处输入图像描述](../Images/5b3ceb9c2f3fdca02bf9684c3b33dab8.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T17:34:15.630

我的按钮没有接收事件时遇到问题，通过在 MainWindow.xib 上选择“启动时全屏”解决了这个问题。希望这可以帮助。

# ios - 将点击点转换为 GPUImageView 中的焦点兴趣点

> ID：12734409
> 
> 赞同：0
> 
> 时间：2012-10-04T19:24:01.720
> 
> 标签：ios, avcapturesession, gpuimage

我正在使用 GPUImage 框架进行实时照片编辑。

我有这样的结构： - GPUImageStillCamera -- GPUImageCropFilter --- 其他视觉过滤器 ---- GPUImageView

我想将点从 GPUImageView 转换为 GPUImageStillCamera 坐标中的点，因为它需要设置焦点。

我的裁剪过滤器初始化：

```
cropFilter = [[GPUImageCropFilter alloc] initWithCropRegion:CGRectMake(0.06f, 0.0f, 0.9, 1.0f)]; 
```

GPUImageView 填充模式是默认的。

你有什么想法或样品吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-30T04:53:46.717

// 获取兴趣点

```
CGPoint viewCoordinates=[gestureRecognizer locationInView:self.view];
CGSize frameSize=self.view.frame.size;
CGPoint  pointOfInterest = CGPointMake(viewCoordinates.y / frameSize.height, 1.f - (viewCoordinates.x / frameSize.width)); 
```

可能会有所帮助

# javascript - JavaScript 从对象数组中删除单个条目

> ID：12734421
> 
> 赞同：0
> 
> 时间：2012-10-04T19:24:52.187
> 
> 标签：javascript, arrays

我有这样的结构：

```
var arr = [
    {
        title: 'anchorman'
    },
    {
        title: 'happy gilmore'
    },
    {
        title: 'anchorman'
    }
] 
```

现在我要怎么做才能得到这样的数组：

```
var arr = [
        {
            title: 'anchorman'
        }
] 
```

因此，它不仅会删除唯一的条目，还会留下一个重复的条目。

到目前为止我有这个，但它并不好！

```
var ref;
      for(var i in movies) {
        ref = movies[i].title;
        if(this.titles.indexOf(ref) == -1) {
            movies.splice(i, 1);
        } else {
            this.titles.push(ref);  
        }
      } 
```

其中 'movies' 是这个问题中的第一个数组，而 this.titles 只是一个空数组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:30:45.307

以下代码将创建具有所需结果的新数组：[jsfiddle](http://jsfiddle.net/9FY24/)

```
 var arr = [
    {
        title: 'anchorman'
    },
    {
        title: 'happy gilmore'
    },
    {
        title: 'anchorman'
    }
];

var temp = {}, newArr = [];
for(var k =0;k< arr.length; k++){
    if(temp[arr[k].title]){
        newArr.push(arr[k]);
    }

temp[arr[k].title] = true;
}
arr = newArr;
//console.log(newArr);​ 
```

# sql - 经典 ASP：在与请求的名称或序号对应的集合中找不到项目

> ID：12734428
> 
> 赞同：0
> 
> 时间：2012-10-04T19:25:15.560
> 
> 标签：sql, asp-classic

在我正在处理的经典 ASP 站点中，我需要获取当前站点所有者的 ID，以便将 Excel 中的电子邮件列表导出给该用户。我在我的 SQL 行上收到主题中提到的错误。我尝试任何方式都无法获得ID。当我在数据库中输入一个与 ID 对应的数字时，数据就可以正常提取了。我不知道该怎么做才能完成`WHERE ID =`这项工作

```
<%
Set rs = Server.CreateObject("ADODB.RecordSet")
SQL = "SELECT ID, storeNumber, siteOwner FROM OrderOwners WHERE ID = " & rs("ID")
rs.Open SQL, conn, AdOpenStatic, AdLockPessimistic
If NOT rs.EOF then
    %>
        <textbox value="<% = rs("ID") %>"><% = rs("storeNumber") & " - " & rs("siteOwner") %></textbox>
    <%
End If
rs.Close
Set rs = Nothing
conn.Close
Set conn = Nothing
%> 
```

我不太确定该怎么做，因为我通常不使用经典的 asp，而且这个网站是很久很久以前写的。

当我在 SQL Server 中使用该 SQL 语句并将 rs("ID") 替换为 '1' 时，该语句运行得很好。有人能帮助我吗？我找不到任何似乎有帮助的东西。

更新的 SQL 到

```
 SQL = "SELECT ID, storeNumber, siteOwner FROM OrderOwners WHERE ID = ? 
```

但现在我有错误

```
[Microsoft][ODBC SQL Server Driver]COUNT field incorrect or syntax error 
```

在第 19 行，即

```
rs.Open SQL, conn, AdOpenStatic, AdLockPessimistic 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T19:28:17.647

这些行不起作用：

```
Set rs = Server.CreateObject("ADODB.RecordSet") 
SQL = "SELECT ID, storeNumber, siteOwner FROM OrderOwners WHERE ID = " & rs("ID") 
```

这些行失败了，因为您只是通过在其上方的行中`rs("ID")`进行设置而将其清除`rs`。

您需要将尝试检索信息的 ID 传递给 SQL 查询。如果这是一个公共站点，请小心，就像您通过查询字符串传递 ID 一样，您可能容易受到 SQL 注入攻击。

# jquery - jquery附加到带有图像的html然后删除它不显示

> ID：12734429
> 
> 赞同：0
> 
> 时间：2012-10-04T19:25:19.897
> 
> 标签：jquery, append

嘿，我想让我的 jquery 代码在下面工作：

```
function submitContactUs() {
    if ($('#cf-name-txt').val() == '' || $('#cf-name-txt').val().charAt(0) == '*') {
        $('#cf-name-txt').append("<img src=\"img/attention.png\" width=\"16\" height=\"16\" style=\"position:absolute; left: -7px; top: 7px;\" />");
    }       
} 
```

HTML代码是这样的：

```
<div id="contactus-name">
    <input type="text" id="cf-name-txt" style="width: 200px;" class="formBoxesContact" value="*Your Name">
</div> 
```

它可以将图像添加到上面的 html 代码的末尾，但它不显示？在萤火虫中看起来像这样：

![萤火虫](../Images/e1bfc0c7e71d230e4530a458ffa00001.png)

我在做什么使它不显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:27:57.063

您正在尝试在输入中显示图像。尝试使用样式可编辑的 div 或其他东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T19:28:42.063

试试这个

```
$('#cf-name-txt').after("<img src=\"img/attention.png\" width=\"16\" height=\"16\" style=\"position:absolute; left: -7px; top: 7px;\" />"); 
```

或者

```
$("<img src=\"img/attention.png\" width=\"16\" height=\"16\" style=\"position:absolute; left: -7px; top: 7px;\" />").insertAfter($('#cf-name-txt')); 
```

您正在尝试将图像附加到输入..尝试在输入标记之后附加..

`.after()`应该管用

**编辑**

```
if( !$('#cf-name-txt').next('img').length)
$('#cf-name-txt').after("<img src=\"img/attention.png\" width=\"16\" height=\"16\" style=\"position:absolute; left: -7px; top: 7px;\" />");​ 
```

[小提琴](http://jsfiddle.net/sushanth009/xp5sE/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T19:32:14.313

您可能想在输入*之后*插入图像，而不是在其中。为此，请使用 jQuery 的`after`函数，而不是`append`.

作为替代方案，您可以使用 CSS 类在输入旁边添加图像，并在 javascript 中保留嵌入的 HTML。

在你的 CSS 上：

```
input.attention:after {
  content: url('img/attention.png');
} 
```

然后，在javascript上：

```
function submitContactUs() {
  if ($('#cf-name-txt').val() == '' || $('#cf-name-txt').val().charAt(0) == '*') {
      $('#cf-name-txt').addClass("attention");
    }       
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-04T19:32:53.367

似乎（从您的图像名称来看）您基本上想要在提交表单并且尚未输入字段时显示“注意”图像。

正如其他帖子所说，您不能将图像放在`<input>`标签内，但这并不意味着您不能在标签内出现图像。

这样做的方法是`background`设置`input`. 因此，要使用 jQuery 执行此操作，请使用；

```
$('#cf-name-txt').addClass('alert-icon'); 
```

然后有css

```
input.alert-icon{ background: url(img/attention.png) no-repeat right center; } 
```

然后，您可以使用样式，也可以在用户将焦点设置在输入上时删除该类。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-04T19:36:45.103

输入字段不能包含元素（以及几乎任何东西）。使用 $('#cf-name-txt').before(""); 添加图像和 $("#cf-name-txt-img").remove() 删除它。

或者更好的是，将图像放入带有样式 display:none 的 HTML 中，然后打开它来更改 display:block 中的样式

```
 <div id="contactus-name">
    <img src="img/attention.png" id="cf-name-txt-img" width="16" height="16" style="position:absolute; left: -7px; top: 7px; display:none" />
    <input type="text" id="cf-name-txt" style="width: 200px;" class="formBoxesContact" value="*Your Name">
   </div> 
```

并使用 $("#cf-name-txt-img").show() 显示它， $("#cf-name-txt-img").hide() 删除它。

在你的情况下：

```
function submitContactUs() {
    var $img = $("#cf-name-txt-img");
    if ($('#cf-name-txt').val() == '' || $('#cf-name-txt').val().charAt(0) == '*') {
       $img.show();
    } else {
       $img.hide();
    }

} 
```

# c++ - 如何在 C++ 中使用多重集插入一对

> ID：12734431
> 
> 赞同：4
> 
> 时间：2012-10-04T19:25:31.830
> 
> 标签：c++, std-pair, multiset

我想在多重集中插入​​一个整数值和一对。

所以我将其声明为：

```
multiset < int, pair < int, int> > mp;
int m,n,p; 
```

要插入 multiset 我试过这个：

```
mp.insert(make_pair(m, make_pair(n,p))); // Compile time error 
```

但它给出了编译时错误......有人可以建议正确的方法来实现它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-04T19:30:03.530

该类型`multiset<int,pair<int,int>>`正在尝试创建一个多重集，其中 Key 是`int`并且 Compare 是`pair<int,int>`。这是荒谬的。您要么想使用

```
multiset<pair<int,pair<int,int>>> 
```

或者你想使用

```
multiset<tuple<int,int,int>> 
```

前一种类型 ( `pair<int,pair<int,int>>`) 匹配您用来插入集合 ( `make_pair(m, make_pair(n,p))`) 的表达式。如果你使用后者，你会想要`make_tuple(m,n,p)`.

# css - 如何使用 CSS 缩放具有视口大小的文本？

> ID：12734435
> 
> 赞同：0
> 
> 时间：2012-10-04T19:25:48.560
> 
> 标签：css

我试图让我的登陆页面上的文本大小与视口大小成线性比例。如果您查看我的网站[http://alexanderwhill.com/site2/](http://alexanderwhill.com/site2/)，您会明白我在说什么。我希望字体大小能够流畅地缩放而不是溢出。这甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:33:23.320

这就是[媒体查询](https://developer.mozilla.org/en-US/docs/CSS/Media_queries)的用途。

简单示例：http: [//jsbin.com/ivodam/3/edit](http://jsbin.com/ivodam/3/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:36:16.427

在 css 中使用 % 来表示流动性

```
 #maincontent h1 {
    font-size: 50%; /* your desired % */
    letter-spacing: 1px;
    line-height: 260px;
 } 
```

或者您可以使用[媒体查询](http://www.w3.org/TR/css3-mediaqueries/)，您需要指定/知道视口尺寸的范围。

# c# - WPF ComboBox - change selection in bound field's setter - ComboBox selection not updated

> ID：12734442
> 
> 赞同：1
> 
> 时间：2012-10-04T19:26:19.880
> 
> 标签：c#, wpf, data-binding, combobox

I have a ComboBox's SelectedItem property bound to an object's field. It uses TwoWay binding, which works fine in most cases; when it loads up, the dropdown's selection is set from the field's getter, and manually changing the selection calls the field's setter.

However, sometimes I want to display a confirmation dialog. If the user clicks "No", I want the value to stay the same. Here is my code:

```
public A Afield
{
    get { return _afield; }
    set
    {
        SetA(value);
    }
}
public void SetA(LocationConfiguration value, bool prompt = true)
{
    if (/*selection would cause irreversible changes*/)
    {
        if (prompt)
        {
            MessageBoxResult result = Microsoft.Windows.Controls.MessageBox.Show(
                    "bla bla bla",
                    "bla",
                    MessageBoxButton.YesNo,
                    MessageBoxImage.Warning);
            if (result != MessageBoxResult.Yes)
                return;
        }
        PerformIrreversibleChanges()
    }
    _afield = value;
    NotifyPropertyChanged("Afield");
} 
```

Everything in the codebehind works perfectly. If the user accepts, the changes are made. If the user presses "No", _afield is not modified. Other controls bound to this property show the correct value.

However, the ComboBox display does NOT revert to the value of _afield. It stays as whatever they selected, even if they rejected the change. For some reason it seems like it doesn't set the item of the combobox until after the property is set. At that point it displays what the user selected, not the correct value that persists in the codebehind.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:59:59.743

我设法修复它，但解决方案并不漂亮。除了绑定之外，我现在还有一个用于 SelectionChanged 事件的处理程序，它将选择更改回它应有的状态。这是代码：

```
private void cbox_Abox_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    foreach (ComboBoxItem cbi in cbox_Abox.Items)
        if ((string)cbi.Content == BoundObject.Afield.ToString())
            cbox_Abox.SelectedItem = cbi;
} 
```

现在，每当我手动选择 ComboBox 值时，它都会通过绑定将值写入对象（就像之前所做的那样），然后使用此处理程序将值从对象复制回 ComboBox。

出于某种原因，在此处使用 PropertyChanged 事件不会更新组合框，这就是我必须显式调用 ComboBox.SelectedIndex 的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:33:32.960

您需要重新设置它，因为双向绑定，您的属性将在选择更改后立即更新，因此如果用户取消更改，您需要将其重置为上一个值。您可以查看事件 args 的 RemovedItems 属性以获取先前的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T20:11:57.840

或者，如果用户按下“否​​”，您可以保存以前的值并将其保留为备用

```
 private A previousAfield;
 public A Afield
 {
    get { return _afield; }
    set
    {
       previousAfield = _afield;
       SetA(value);
    }
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T20:08:09.697

让 SetA 返回一个布尔值

```
set
{
     if (value == _afield) return;         
     if (SetA(value)) _afield = value;
     NotifyPropertyChanged("Afield");
} 
```

# javascript - Setting timeout jQuery.load()

> ID：12734444
> 
> 赞同：4
> 
> 时间：2012-10-04T19:26:27.257
> 
> 标签：javascript, jquery, ajax, load

I have an event that when clicked initiates a jQuery load(). The load passes several MB of POST data. I am getting aborted errors. How can I set the timeout?

```
 toggleModalLoading();
 $("#ele").load('http://site.com/script.php',{
               'data' : postData },
                function(e) {
                      toggleModalLoading();
                }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T19:28:53.897

`.load()`调用实际上只是一个方便的简写。您可以在调用之前[设置全局 ajax 选项。](http://api.jquery.com/jQuery.ajaxSetup/)`.load()`如果这不可行，您将不得不使用[较低级别的 API](http://api.jquery.com/jQuery.ajax/)。无论哪种方式，您都需要`timeout`ajax 选项：

```
$.ajax('http://site.com/script.php', {
   data: postData,
   timeout: 1000, // 1000 ms
   success: function (data) {
       $('#ele').html(data);
       toggleModalLoading();
   } 
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T19:29:15.807

设置 Ajax 调用的超时时间。

```
$.ajaxSetup({
    timeout: 30000
}); 
```

如果服务器导致它停止，请查看 php ini 文件中的设置。

# scala - 为什么 scala 有时需要在匿名函数中命名的参数？

> ID：12734450
> 
> 赞同：3
> 
> 时间：2012-10-04T19:26:44.707
> 
> 标签：scala

我不明白为什么 scala 有时需要我将 args 命名为 anon fns：

```
scala> case class Person(name: String)
defined class Person

scala> def reverseString(s: String) = s.reverse
reverseString: (s: String)String

scala> val p = Some(Person("foo"))
p: Some[Person] = Some(Person(foo))

scala> p map { reverseString(_.name) }
<console>:12: error: missing parameter type for expanded function ((x$1) => x$1.name)
              p map { reverseString(_.name) }

// why does it only work when I name the argument? I'm not even telling it the type.
scala> p map { p => reverseString(p.name) }
res9: Option[String] = Some(oof)

// and shouldn't this fail too?
scala> p map { _.name.reverse }
res13: Option[String] = Some(oof) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T19:33:41.233

答案在错误消息中，但神秘的是：

```
(x$1) => x$1.name 
```

等等，什么？你想要`x$1 => reverseString(x$1.name)`。

所以现在您确切地看到出了什么问题：它假定函数*在*括号内（即`reverseString`您想将函数传递给`reverseString`）。通过显式命名变量，您可以向它证明它是错误的。

（它给出了这条消息，因为一旦它假设`reverseString`应该传递一个函数，它就不知道该函数的类型，因为它`reverseString`实际上想要一个字符串，而不是一个函数。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:31:58.123

我相信这就是所谓的类型推断。此外， _ 只是一个占位符。（您已经将 p 定义为 Some[Person] 类型，因此编译器足够聪明，可以在按照您的方式使用时弄清楚）

# php - preg_match 验证

> ID：12734452
> 
> 赞同：0
> 
> 时间：2012-10-04T19:26:58.897
> 
> 标签：php, validation, preg-match

我有一个表格，提交后，我想确保以下内容：

1.  在输入字段中键入的任何内容的开头都以`mod_`
2.  之后`mod_`，只能使用字母数字字符。

对于第一阶段，我做到了这一点：

```
if (preg_match('/^mod_/', $str)) {
        //script goes here
} 
```

但是对于第二阶段，我不完全确定是否是最好的方法/作品：

```
if (preg_match('/^mod_/[A-Za-z0-9]$/', $str)) {
        //script goes here
} 
```

我可能在第二阶段犯了一个错误`preg_match()`，但是，如果我没有，请有人告诉我我使用的内容是否正常，否则可以做些什么来改进它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T19:28:37.647

这应该这样做：

```
if (preg_match('/^mod_[A-Za-z0-9]+$/', $str)) { 
```

`+`我在前面添加的意思`$`是“匹配前一个事物 1 次或多次”。在这种情况下，即 1 个或多个 ASCII 字符或数字。

# xcode - 当 clipstobounds = 没有额外的分隔符出现在 UITableview 的边界之下时

> ID：12734456
> 
> 赞同：2
> 
> 时间：2012-10-04T19:27:16.610
> 
> 标签：xcode, ios6

如果以前有人问过这个问题，我提前道歉，但我似乎找不到满意的答案。我在 UIView 中间有一个普通的 UITableview。它比视图小得多，因此我使用以下代码在表格中添加了阴影：

```
tableView.layer.shadowColor = [UIColor blackColor].CGColor;
tableView.layer.shadowOpacity = 0.6;
tableView.layer.shadowRadius = 5;
tableView.layer.shadowOffset = CGSizeMake(0,3);
tableView.layer.masksToBounds = NO;
tableView.clipsToBounds = NO; 
```

clipsToBounds 似乎是将阴影放入其中的神奇设置。不幸的是，它还具有在我的 UITableview 的边界之下和外部绘制分隔线的神奇效果。

如果我添加一个空页脚，那么表格外的分隔符就会消失，但它们也会从没有数据的单元格中的表格中消失。即使表格为空，我也真的想保留分隔线以产生“规则垫”效果。我认为这应该是一个简单的设置，但在我的研究中还没有出现。任何见解将不胜感激。

# python - 如何在 python 中访问 xml 节点中的链接数据？

> ID：12734458
> 
> 赞同：0
> 
> 时间：2012-10-04T19:27:21.780
> 
> 标签：python, xml, nodes

我以 xml 格式返回了以下类型的数据（返回了许多房间；这是我返回的数据的一个示例）：

```
<?xml version="1.0" encoding="UTF-8"?>
<rooms>
    <total-results>1</total-results>
    <items-per-page>1</items-per-page>
    <start-index>0</start-index>
    <room>
        <id>xxxxxxxx</id>
        <etag>5</etag>
        <link rel="http://schemas.com.mysite.building" title="building" href="https://mysite.me.myschool.edu:8443/ess/scheduleapi/v1/buildings/yyyyyyyyy"/>
        <name>1.306</name>
        <status>active</status>
        <link rel="self" title="self" href="https://mysite.me.myschool.edu:8443/ess/scheduleapi/v1/rooms/aaaaaaaaa">
    </room>
</rooms> 
```

如果 nodeType == node.TEXT_NODE，我似乎可以访问数据（所以我可以看到我有 1.306 房间）。此外，我似乎能够访问 nodeName*链接*，但我真的需要知道那个房间是否在我可接受的建筑物之一中，所以我需要能够到达该行的其余部分以查看 yyyyyyyyy。有人可以建议吗？

好的，@vezult，这是我最终使用 ElementTree 提出的（工作代码！），正如你所建议的。这可能不是最pythonic（或ElementTree-ic？）的方式，但它似乎有效。我很高兴现在可以访问我的 xml 中的每一个片段的 .tag、.attrib 和 .text。我欢迎任何关于如何使它变得更好的建议。

```
# We start out knowing our room name and our building id.  However, the same room can exist in many buildings.
# Examine the rooms we've received and get the id of the one with our name that is also in our building.

# Query the API for a list of rooms, getting u back.

request = build_request(resourceUrl)
u = urllib2.urlopen(request.to_url())
mydata = u.read()

root = ElementTree.fromstring(mydata)
print 'tree root', root.tag, root.attrib, root.text
for child in root:
    if child.tag == 'room':   
        for child2 in child:
            # the id tag comes before the name tag, so hold on to it
            if child2.tag == "id":
                hold_id = child2.text
            # the building link comes before the room name, so hold on to it
            if child2.tag == 'link':                            # if this is a link
                if "building" in child2.attrib['href']:         # and it's a building link
                    hold_link_data = child2.attrib['href']
            if child2.tag == 'name':
                if (out_bldg in hold_link_data and  # the building link we're looking at has our building in it  
                    (in_rm == child2.text)):        # and this room name is our room name
                    out_rm = hold_id
                    break  # get out of for-loop 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T19:52:48.830

您没有提供您正在使用的库的指示，所以我假设您使用的是标准 python`ElementTree`模块。在这种情况下，请执行以下操作：

```
from xml.etree import ElementTree

tree = ElementTree.fromstring("""<?xml version="1.0" encoding="UTF-8"?>
<rooms>
    <total-results>1</total-results>
    <items-per-page>1</items-per-page>
    <start-index>0</start-index>
    <room>
        <id>xxxxxxxx</id>
        <etag>5</etag>
        <link rel="http://schemas.com.mysite.building" title="building" href="https://mysite.me.myschool.edu:8443/ess/scheduleapi/v1/buildings/yyyyyyyyy" />
        <name>1.306</name>
        <status>active</status>
        <link rel="self" title="self" href="https://mysite.me.myschool.edu:8443/ess/scheduleapi/v1/rooms/aaaaaaaaa" />
    </room>
</rooms>
""")

# Select the first link element in the example XML
for node in tree.findall('./room/link[@title="building"]'):
    # the 'attrib' attribute is a dictionary containing the node attributes
    print node.attrib['href'] 
```

# c# - 我可以通过 VS Studio 2010 中的 Resources.resx 设置语言环境吗？

> ID：12734462
> 
> 赞同：0
> 
> 时间：2012-10-04T19:27:29.857
> 
> 标签：c#, visual-studio-2010, locale

Resources.resx 引用了文化等。是否可以在 resources.resx 中设置默认的英语语言环境。

我尝试在 Resources.Designer.cs 文件中设置cultureinfo。但它确实让我。有没有其他方法可以设置，是否可以让我的应用程序以英文列出所有输出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:29:31.620

您可以使用 NeutralResourcesLanguage 属性在 AssemblyInfo.cs 中设置默认语言环境。

例如

```
[assembly: NeutralResourcesLanguage("en-US")] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T19:29:35.177

您可以使用设置当前线程的文化

```
Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US"); 
```

# c# - 强制 Expression<> 计算局部变量

> ID：12734464
> 
> 赞同：4
> 
> 时间：2012-10-04T19:27:47.057
> 
> 标签：c#, .net, lambda, expression-trees

我在 LinqPad 中有类似的东西

```
void Main()
{
    var t1 = DateTimeOffset.Parse("10/1/2012");

    int? n1 = 1;

    Expression<Func<Sample,bool>> x1 = ud => 
        (ud.Date == t1 && ud.Number == n1);

    x1.ToString().Dump();
}

class Sample
{
    public int? Number{set;get;}
    public DateTimeOffset Date{set;get;}
} 
```

它输出

> ud => ((ud.Date == value(UserQuery+<> *c_DisplayClass0).t1) AndAlso (ud.Number == value(UserQuery+<>c* _DisplayClass0).n1))

是否有任何可能的方法来保留变量但让它输出如下内容：

> ud => ((ud.Date == Parse("10/1/2012")) AndAlso (ud.Number == Convert(1)))

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-04T19:47:44.127

开始了; 先输出：

```
ud => ((ud.Date == 10/01/2012 00:00:00 +00:00) AndAlso (ud.Number == 1)) 
```

这将永远不会输出`Parse(...)`，因为您的表达式*不包含*解析：当您将其放入 lambda 时，您已经对其进行了评估。

另请注意，这处理一级捕获的变量。对于更复杂（嵌套）的捕获上下文，您必须递归地从捕获类中获取值：

```
using System;
using System.Linq.Expressions;
using System.Reflection;
using System.Runtime.CompilerServices;
static class Program
{
    static void Main()
    {
        var t1 = DateTimeOffset.Parse("10/1/2012");

        int? n1 = 1;

        Expression<Func<Sample, bool>> x1 = ud =>
            (ud.Date == t1 && ud.Number == n1);

        var sanitized = (Expression<Func<Sample, bool>>)
            new Literalizer().Visit(x1);

        Console.WriteLine(sanitized.ToString());
    }
}

class Literalizer : ExpressionVisitor
{
    protected override Expression VisitMember(MemberExpression node)
    {
        if(node.Member.DeclaringType.IsDefined(typeof(CompilerGeneratedAttribute), false)
            && node.Expression.NodeType == ExpressionType.Constant)
        {
            object target = ((ConstantExpression)node.Expression).Value, value;
            switch (node.Member.MemberType)
            {
                case MemberTypes.Property:
                    value = ((PropertyInfo)node.Member).GetValue(target, null);
                    break;
                case MemberTypes.Field:
                    value = ((FieldInfo)node.Member).GetValue(target);
                    break;
                default:
                    value = target = null;
                    break;
            }
            if (target != null) return Expression.Constant(value, node.Type);
        }
        return base.VisitMember(node);
    }
}

class Sample
{
    public int? Number{set;get;}
    public DateTimeOffset Date{set;get;}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-03T21:48:01.753

*如果*您可以依赖*Microsoft 的 .NET Framework/CoreFX 的实现细节，该细节*将**在**未来某个时间中断，请查看下面的剧透框中的内容：

> 有[Expression.DebugView 属性](https://github.com/dotnet/corefx/blob/a485910430c2aa5681ad77cbfc8a1d31e741345f/src/System.Linq.Expressions/src/System/Linq/Expressions/Expression.cs#L214-L230)。你需要做一些事情，比如通过反射找到它。
> 它是[使用 ExpressionVisitor 实现的，就像](https://github.com/dotnet/corefx/blob/29c3e9d5ea3c175c149ce20e2afe3945c3f13ec7/src/System.Linq.Expressions/src/System/Linq/Expressions/DebugViewWriter.cs#L15)[Marc Gravell 对这个问题的回答中](https://stackoverflow.com/a/12734764/2392683)所做的那样。

我要再次强调这一点：这是私有财产。

# iphone - 将数组中 indexpath.row 中的 NSString 格式化为货币格式

> ID：12734478
> 
> 赞同：0
> 
> 时间：2012-10-04T19:28:35.043
> 
> 标签：iphone

您好我正在尝试将 indexPath.row 中的字符串转换为货币格式的数组。下面是我的代码。但是当我在手机上运行时，lbl 中什么也没有出现——它是空白的。帮助表示赞赏！谢谢！！

```
 NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
        [formatter setNumberStyle:NSNumberFormatterCurrencyStyle];
        NSString *groupingSeparator = [[NSLocale currentLocale] objectForKey:NSLocaleGroupingSeparator];
        [formatter setGroupingSeparator:groupingSeparator];
        [formatter setGroupingSize:3];
        [formatter setAlwaysShowsDecimalSeparator:NO];
        [formatter setMaximumFractionDigits:0]; //No decimal showings - to show 2 decimal digits enter 2 instead of 0
        [formatter setUsesGroupingSeparator:YES];

        totalnoformat = [[NSNumber alloc]init];
        totalSCformat = [[NSString alloc]init];

        totalnoformat = [total objectAtIndex:indexPath.row];
        totalSCformat = [formatter stringFromNumber:totalnoformat];

        cell.amountlbl.text = totalSCformat; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T22:41:01.527

您的代码有几个您可能想要清理的问题。这里有一些建议。

1.  您的数字格式化程序不应在内部初始化， `cellForRowAtIndexPath:`因为它会在每次初始化或出列新单元格时创建一个。使格式化程序成为视图控制器的属性，并在`viewDidLoad`.

2.  您对 alloc/init 的调用：

    ```
    totalnoformat = [[NSNumber alloc]init];
    totalSCformat = [[NSString alloc]init]; 
    ```

    是不必要的。你应该删除那些。

3.  您应该确保您的`total`数组已正确初始化，并且这些值实际上已添加到其中。在此行设置断点：

    ```
    totalnoformat = [total objectAtIndex:indexPath.row]; 
    ```

    当它中断时，将鼠标指针悬停在`total`变量上，看看调试器说它的内存地址是什么。如果它是 0x0000，那么它是 nil 并且没有被初始化。将鼠标悬停在变量上的相同技术也会告诉您数组中有多少项。

4.  看来您已经创建了一个自定义单元格。这样做有几个潜在的问题。您需要确保您的自定义单元格的类设置为您的自定义单元格类名称。您还必须确保已将您的`amountlbl`财产连接到插座，否则设置其文本将无济于事。

5.  如果其他方法都不起作用，则可能是您的数字格式化程序存在问题。注释掉您设置的所有格式化程序属性并尝试像这样的最小化：

    ```
    NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
    [formatter setNumberStyle:NSNumberFormatterCurrencyStyle]; 
    ```

    然后尝试使用这样的静态数字设置您的单元格文本：

    ```
    cell.amountlbl.text = [formatter stringFromNumber:
                                            [NSNumber numberWithFloat:4.75]]; 
    ```

# javascript - 将 Apple 元标记用于全屏 Web 应用程序

> ID：12734481
> 
> 赞同：10
> 
> 时间：2012-10-04T19:28:48.530
> 
> 标签：javascript, ios, web-applications, safari, mobile-safari

我正在尝试使用

```
<meta name="apple-mobile-web-app-capable" content="yes"> 
```

标签让 iOS Safari 显示没有浏览器内容的页面；至少，这是我*认为*它应该为我做的。（[Apple 文档](http://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html)没有详细介绍。）

到目前为止，我无法让它做任何事情。[这是一个 JSBin 示例。](http://jsbin.com/esanac/2) 无论`<meta>`有无标签，页面都会出现在 iPod Touch 和 iPad 2 上，浏览器内容位于顶部（小屏幕底部）。

为了影响浏览器，还有其他事情需要发生吗？还是我对它应该如何工作的期望不正确？（请注意，通过 weinre，我检查了“windows.navigator.standalone”标志，它似乎是`false`。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-04T19:32:48.363

只有当用户将指向您的应用程序的链接添加到他们的主屏幕时，这才符合您的要求。

对于浏览器内的情况，一种常见的方法是添加一个调用`window.scroll(0,1)`，将浏览器的内容从屏幕顶部移开。（没有办法清除底部的东西。）

此外，您可能希望标签表明您不想缩放：

```
<meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, user-scalable=no, maximum-scale=1, minimum-scale=1" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T19:34:08.483

元标记的作用是当您在浏览器中查看页面时，它会添加一个选项以将您的页面添加到主屏幕。当您通过主屏幕快捷方式打开页面时，它将处于全屏状态，并且 navigator.standalone 将设置为 true。这就是人们在谈到全屏模式时所指的内容。

# c# - 从表单应用程序打开 WPF 设置窗口

> ID：12734483
> 
> 赞同：0
> 
> 时间：2012-10-04T19:28:53.770
> 
> 标签：c#, wpf, user-interface, static

> **可能重复：**
> [WPF UI 关闭时的通知](https://stackoverflow.com/questions/12696649/notification-when-wpf-ui-closes)

我以前问过一个非常相似的问题，但我没有得到任何有用的回答。我希望那里有人可以帮助我。

我有一个现有的托盘应用程序被编程为 Windows 窗体应用程序。我有一个编程为 WPF 的现有设置表单。

托盘应用程序需要能够： * 打开设置应用程序 n 次，一次只打开一个实例 * 当用户关闭设置应用程序时接收通知。

Settings App 使用 ResourceDictionary，我认为这意味着它必须从 App.xaml 启动。

我可以使用以下代码打开设置窗口一次并在托盘关闭时通知托盘，但我无法再次打开它。

```
 if (gui == null)
        {
            //shell = new mainWindow();
            //shell.CloseEvent += settings_FormClosed;

            gui = new App();
            //gui.ShutdownMode = ShutdownMode.OnExplicitShutdown;
            gui.MainWindow = shell;
            gui.InitializeComponent();
            //gui.Run();
            gui.Exit += new System.Windows.ExitEventHandler(settings_FormClosed);

            IsUIOpen = true;
        } 
```

如果我取消注释上面的行，我可以拦截关闭事件，并将可见性设置为隐藏。下次用户选择设置时，我可以将其设置回可见。但是，第一次打开 Settings 时，它不会触发 Exit 事件，并且 shell 没有获取所有 ReferenceDictionary（或无法访问它），因此窗口无法正确显示。

有没有办法从应用程序运行 WPF，并访问 MainWindow（它通常似乎为 null，并且不是我自己的窗口的类型），以便可以将自定义侦听器添加到 mainWindow？

或者，有没有办法处理静态应用程序，以便我可以在下次用户单击设置时重新实例化它。

我知道必须有某种方法可以让 WPF 与 Win Forms 配合得很好。感谢所有试图提供帮助的人。这一直让我很头疼。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:43:59.043

由于您的设置是一个应用程序，我将使用 Winforms 应用程序中的 System.Diagnostics.Process 来启动您的 WPF 设置应用程序。由于您将设置作为应用程序启动，而不是尝试将其作为窗口调用，因此您的样式将被加载。此外，您可以使用 Process 的 WaitForExit() 或 WaitForExit(int) 方法等待设置应用程序完成，仅在设置应用程序完成时将控制权交还给 Winforms 应用程序。这也可用作“设置”应用关闭时请求的通知。

这是一个快速的代码片段：

**如果打开设置 WPF 应用程序：**

```
Process myProcess = new Process();
myProcess.StartInfo.UseShellExecute = false;
myProcess.StartInfo.FileName = "C:\\mysettingsapp\\mysettingsapp.exe"; // replace with path to your settings app
myProcess.StartInfo.CreateNoWindow = false;
myProcess.Start();
// the process is started, now wait for it to finish
myProcess.WaitForExit();  // use WaitForExit(int) to establish a timeout 
```

通过在主线程上调用 WaitForExit，WinForms 应用程序被阻塞，等待设置应用程序完成。这将防止用户打开多个设置窗口。我没有看到 Winforms 应用程序的非阻塞要求。所以如果你不能阻止，我可以想出另一种方法。

**更新** 获取执行程序集的路径：

```
 string path = System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().GetName().CodeBase ); 
```

# sql - 如何以某种方式对这些 SQL 结果进行排序？

> ID：12734486
> 
> 赞同：3
> 
> 时间：2012-10-04T19:29:06.640
> 
> 标签：sql, postgresql, sqlalchemy

我正在制作一种活动日历应用程序。用户主页上显示了两种类型的事件：

1.  附近的活动 - 预定日期在未来 3 天内或过去 1 小时内的活动。
2.  正常事件 - 没有计划日期或计划日期超过未来 3 天的事件。

这是**事件**表：`id, user_id, content, occurs_at, created_at`

目前，我按创建日期排序显示这些事件，以首先显示新添加的内容。

我想要的是首先显示所有附近的事件并按计划日期排序，然后显示正常事件并按创建日期排序。我认为它可以提供更好的用户体验，但我不知道如何去做。

**更新**

结束了这个查询，这是几个答案的组合。

`ORDER BY COALESCE(occurs_at > :min_time AND occurs_at < :max_time, 0) DESC, occurs_at ASC, created_at DESC`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:36:14.477

`order by`子句可以包含任意逻辑，而不仅仅是字段名称，因此，在伪代码中，您可以

```
SELECT ...
...
ORDER BY (date_diff(occurs_at, now) <= '3 days'), occurs_at DESC, created_at DESC 
```

第一个子句将接下来 3 天内发生的所有事件强制排在列表顶部。然后第二个子句按降序排列，然后其他所有内容都按 created_at 日期排序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T20:23:18.720

正如@MarcB 提到的，您可以按表达式排序，尽管对于 PostgreSQL，表达式看起来有些不同；

```
SELECT * FROM Events
ORDER BY CASE WHEN (occurs_at - '3 days'::interval) < CURRENT_TIMESTAMP 
         THEN occurs_at
         ELSE '9999-01-01'::timestamp
         END, created_at; 
```

[SQLfiddle 演示](http://sqlfiddle.com/#!12/f8580/1)。

请注意，“9999-01-01”在某种程度上是一个任意选择的遥远未来的日期，如果有人知道“maxdate”的 PostgreSQL 常量，我会感兴趣:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-04T21:55:38.650

### 详细格式

更容易解释/理解。

```
WITH x AS (
   SELECT *
        , COALESCE(occurs_at <= (now() + interval '3 days'), FALSE) AS nearby
   FROM   events
   WHERE  occurs_at >= now() - interval '1 hour' -- exclude older events
      OR  occurs_at IS NULL
   )      -- CTE is not strictly necessary, just to make ORDER BY clearer
SELECT *
FROM   x
ORDER  BY
       nearby DESC
     , CASE WHEN nearby THEN occurs_at ELSE created_at END 
```

它没有在问题中明确定义，但提到的“无计划日期”让我认为`occurs_at`可以是`NULL`. 所以使用[`COALESCE`](http://www.postgresql.org/docs/current/interactive/functions-conditional.html#FUNCTIONS-COALESCE-NVL-IFNULL), or`FALSE`和`NULL`会以不同的方式排序。

*   首先，`nearby`在 CTE 中计算order by `x`。
*   接下来，按相应的日期（`occurs_at`或`created_at`）排序。
    *   `occurs_`at 不能`NULL`用于`nearby`事件。
    *   我假设是从一开始`created_at`就定义的。`NOT NULL`否则，您将不得不决定将`NULL`值放在哪里。

此处的其他答案建议在将其与常数进行比较之前根据列计算值，这可能会导致性能非常**差**。例子：

```
date_diff(d,occurs_at, now) <= 3  -- date_diff is also tSQL, not Postgres 
```

*如果可以避免，请不*要这样做。它强制 Postgres 为每一行计算一个值，并且无法使用普通索引。[最近密切相关](https://stackoverflow.com/a/12681313/939860)的答案中的更多信息。

### 简单版

短一点，快一点。

```
SELECT *
FROM   events
WHERE  occurs_at >= now() - interval '1h'
   OR  occurs_at IS NULL
ORDER  BY
       COALESCE( occurs_at <= (now()::date + 3), FALSE) DESC
     , CASE WHEN occurs_at <= (now()::date + 3)
            THEN occurs_at ELSE created_at END; 
```

我采用了@Joachim 的 sqlfiddle，简化了设置，添加了缺失的案例（未安排，过去发生过）并针对它运行我的查询：
**[-> sqlfiddle](http://sqlfiddle.com/#!12/a45bc/4)**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-04T19:40:43.900

我会通过一个字段来扩展您的 SELECT 子句，以确定它是否在“附近”（及时，而不是地点）

```
SELECT
id, user_id, content, occurs_at, created_at,
case when date_diff(d,occurs_at, now) <= 3 then 1 else 0 end as isNearby
... 
```

但我不确定你的语法，这是针对 MS SQL Server

# c# - 如何在 Sharepoint 2010 中返回新上传文档的文档 ID？

> ID：12734492
> 
> 赞同：1
> 
> 时间：2012-10-04T19:29:30.650
> 
> 标签：c#, web-services, sharepoint, sharepoint-2010

我已经激活了 Document ID 服务，并且能够使用此处找到的示例将文件上传到 Sharepoint 库：

[http://www.hoffsays.com/2012/05/02/upload-a-file-to-sharepoint-2010-using-c-and-the-sharepoint-web-service/](http://www.hoffsays.com/2012/05/02/upload-a-file-to-sharepoint-2010-using-c-and-the-sharepoint-web-service/)

但我不确定如何以编程方式返回 C# 中新上传文档的文档 ID。请问有谁能在这方面帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:43:05.853

您可以使用**SiteData.GetURLSegments**方法。

来自[Sharepoint StackExchange，在这里](https://sharepoint.stackexchange.com/a/18123/6151)。

# magento - 具有自定义角色的用户无法访问 Magento 管理界面中的自定义菜单项

> ID：12734494
> 
> 赞同：5
> 
> 时间：2012-10-04T19:29:42.123
> 
> 标签：magento, menu, admin, acl

我为 Magento 管理界面定义了一个自定义菜单项，其中包含几个子项。

当具有管理员角色的用户登录到管理界面时，这可以很好地工作。管理员可以查看所有子项目，还可以访问项目链接到的页面。这些页面中的每一个都以网格形式显示数据库表的内容。

但是当我尝试使用自定义角色时会出现问题。自定义角色可以访问菜单项及其子项。现在，当我使用具有此自定义角色的用户登录管理界面时，用户可以按预期看到所有菜单项，但是对于两个子项，用户在单击子项时会收到拒绝访问消息。

这是 config.xml 中的 acl 和菜单条目。

```
...
    <adminhtml>
        <acl>
            <resources>
                <admin>
                    <children>                      
                        <deliveryservice translate="title">
                            <title>Deliveryservice</title>
                            <sort_order>300</sort_order>
                            <children>
                                <holiday translate="title" module="deliveryservice">
                                    <title>Holidays</title>
                                    <sort_order>5</sort_order>
                                </holiday>
                                <holidayset translate="title" module="deliveryservice">
                                    <title>Holidaysets</title>
                                    <sort_order>10</sort_order>
                                </holidayset>
                                <openinghour translate="title" module="deliveryservice">
                                    <title>Openinghours</title>
                                    <sort_order>20</sort_order>
                                </openinghour>
                                <delivery_address translate="title" module="deliveryservice">
                                    <title>Delivery Areas</title>
                                    <sort_order>30</sort_order>
                                </delivery_address>
                                <minimum_order_value translate="title" module="deliveryservice">
                                    <title>Minimum order value</title>
                                    <sort_order>40</sort_order>
                                </minimum_order_value>
                                <key_value_store  translate="title" module="deliveryservice">
                                    <title>Key Value Store</title>
                                    <sort_order>50</sort_order>
                                </key_value_store>
                                 <ratings  translate="title" module="deliveryservice">
                                    <title>Bewertungen</title>
                                    <sort_order>60</sort_order>
                                </ratings>
                            </children>
                        </deliveryservice>
                    </children>
                </admin>
            </resources>
        </acl>
        <menu>
            <deliveryservice translate="title">
                <title>Deliveryservice</title>
                <sort_order>300</sort_order>
                <children>
                    <holiday translate="title" module="deliveryservice">
                        <title>Holidays</title>
                        <sort_order>5</sort_order>
                        <action>adminhtml/holiday/</action>
                    </holiday>
                    <holidayset translate="title" module="deliveryservice">
                        <title>Holidaysets</title>
                        <sort_order>10</sort_order>
                        <action>adminhtml/holidayset/</action>
                    </holidayset>
                    <openinghour translate="title" module="deliveryservice">
                        <title>Openinghours</title>
                        <sort_order>20</sort_order>
                        <action>adminhtml/openinghour/</action>
                    </openinghour>
                    <delivery_address translate="title" module="deliveryservice">
                        <title>Delivery Areas</title>
                        <sort_order>30</sort_order>
                        <action>adminhtml/deliveryaddress/</action>
                    </delivery_address>
                    <minimum_order_value translate="title" module="deliveryservice">
                        <title>Minimum Order Values</title>
                        <sort_order>40</sort_order>
                        <action>adminhtml/minimumordervalue/</action>
                    </minimum_order_value>
                    <key_value_store  translate="title" module="deliveryservice">
                        <title>Key Value Store</title>
                        <sort_order>50</sort_order>
                        <action>adminhtml/keyvaluestore/</action>
                    </key_value_store>
                    <ratings  translate="title" module="deliveryservice">
                        <title>Bewertungen</title>
                        <sort_order>60</sort_order>
                        <action>adminhtml/ratings/</action>
                    </ratings>
                </children>
            </deliveryservice>
        </menu>
    </adminhtml>
      ... 
```

菜单项 minimum_order_value 和 key_value_store 出现问题。

我不明白为什么管理员可以访问所有页面但不同的角色不能。有什么想法可能是这里的问题吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-05T11:19:36.153

好的，我解决了这个问题。

它与与子菜单项关联的控制器类和子菜单项标签的名称有关。

每个控制器都有一个`_isAllowed()`方法来检查用户查看页面的权限。

例如

```
protected function _isAllowed(){
    return Mage::getSingleton('admin/session')->isAllowed('deliveryservice/holidayset');
} 
```

在此方法中，用于调用 isAllowed() 方法的参数的最后一部分（斜线后面）必须等于 config.xml 中 acl 和菜单条目的子菜单项的标记名称。

所以对于这个例子，子菜单标签的名字必须是 `<holidayset ...`

对于我的两个控制器，标签名称和参数不相等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-04T20:37:40.613

有太多因素可以肯定地说 - 最快的解决方案是自己调试。

看看`_buildMenuArray' in`app/code/core/Mage/Adminhtml/Block/Page/Menu.php`。在那里的某个地方你应该看到一个 foreach 循环，它开始像这样

```
 foreach ($parent->children() as $childName => $child) {
        if (1 == $child->disabled) {
            continue;
        }

        $aclResource = 'admin/' . ($child->resource ? (string)$child->resource : $path . $childName);
        if (!$this->_checkAcl($aclResource)) {
            continue;
        }

        if ($child->depends && !$this->_checkDepends($child->depends)) {
            continue;
        } 
```

这是为构建管理导航的块构建菜单信息数组的循环。如果`continue`触发了这些保护子句中的任何一个，Magento 将跳过呈现特定菜单。我建议检查`_checkAcl`此特定菜单的方法失败的原因。我的猜测（基于对您帖子的浏览）是您缺少未呈现的子菜单的 ACL 角色。

祝你好运！

# ruby-on-rails - 使用不在 github 存储库中的 database.yaml 文件与 Heroku 一起部署

> ID：12734495
> 
> 赞同：0
> 
> 时间：2012-10-04T19:29:44.997
> 
> 标签：ruby-on-rails, security, heroku, github

推送到 Github 时，我想 .gitignore 我的 database.yaml 文件，这样我就不会公开我的生产数据库密码。但是当应用程序在生产中运行时，我需要 Heroku 可以使用该密码。

我可以在 heroku 中设置环境变量，但这让我觉得不安全。任何能够进入我的计算机的人都可以在终端中运行一个命令并显示密码变量。

在处理 Github 和 Heroku 时，是否可以编写代码指定在推送到 github 时应忽略某些文件，但在推送到 heroku 时不应忽略？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:36:04.210

一旦有人可以访问您的主机，它基本上就结束了。如果有人可以访问您的盒子，则任何一种方法、环境变量或 database.yml 文件仍然可以检索。

我建议在 Heroku 中使用环境变量来存储您的数据库凭据。如您所知，您永远不应该将生产凭证签入任何存储库。

# knockout.js - 淘汰赛，何时使用 ko.computed

> ID：12734502
> 
> 赞同：3
> 
> 时间：2012-10-04T19:30:03.233
> 
> 标签：knockout.js

我对 ko.computed 感到很困惑。不确定何时使用它。我有 2 个陈述。你能向我解释一下有什么区别以及何时使用它们吗？

```
self.fullName = ko.computed(function() {
    return self.firstName() + " " + self.lastName();
});

self.fullName = function() {
    return self.firstName() + " " + self.lastName();
}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T19:34:54.383

对于显示全名，这些选项中的任何一个都将导致相同的结果。使计算与函数更好的区别在于您可以分配读写子函数。这样，您可以使用计算值而不是单独的函数来更改 observables。

在[小提琴](http://jsfiddle.net/Rynan/E4wAC/)中，你可以看到如果你改变了名字或姓氏，两者都会改变。但是，如果您更改计算的名字或姓氏，它也会更改该名称和函数。

此外，请参阅[计算文档](http://knockoutjs.com/documentation/computedObservables.html)以获取更多示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:46:35.023

不同之处在于，当您使用 ko.computed 时，如果您绑定到 fullName，fullName 将在 firstName 或 lastName 更改时自动更新。如果没有 ko.computed，您必须自己完成这项工作。

# c++ - 修改参数不参考

> ID：12734505
> 
> 赞同：0
> 
> 时间：2012-10-04T19:30:14.317
> 
> 标签：c++

我正在使用一个外部库，并且我有一个从另一个类继承的类和下一个函数

**void IOCallback::Open(const char* 文件名, bool isOpen)**

我需要修改布尔值，我不能修改代码来像参考一样使用它。

无论如何我可以做到这一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T19:40:33.760

> 我需要修改布尔值，我不能修改代码来像参考一样使用它。

如果你的意思是这样...

```
bool b = false;
IOCallback callback;
callback.Open(filepath, b);
if(b) {  // <- will never actually evaluate to anything but false
    // do something
} 
```

......那么，好吧，你不能。该函数接收其参数的副本。您可以在函数内自由修改参数，但您无法以调用者能够看到所述修改的方式进行修改。

我质疑这个请求背后的原因。如果您编写了代码，那么您可以修改它或添加另一个重载版本来执行您需要的操作。如果您没有编写代码并且无法修改它，那么它从一开始就没有打算改变它的参数，那么可以获得什么？

# html - 如何在 Visual Studio 之外开发 Windows 8 Metro 风格的 JS 应用程序？

> ID：12734512
> 
> 赞同：5
> 
> 时间：2012-10-04T19:30:35.050
> 
> 标签：html, windows-8, microsoft-metro, visual-studio-2012, winjs

我在虚拟机上运行 Windows 8。

事实上，我想在本地开发（而不是在 VM 上）。

**有没有办法在浏览器中而不是通过 Visual Studio 运行 JS 应用程序？**

如果我在浏览器中运行 default.htm，会发生以下情况： ![在此处输入图像描述](../Images/9dfe8c00c7b5142a36b78dc326d03150.png)

注意以 // 和 / 开头的文件名。删除了“/”并且我已经复制了 SDK，所以所有文件都可以在本地使用：

```
c:\Program Files (x86)\Microsoft SDKs\Windows\v8.0\ExtensionSDKs\Microsoft.WinJS.1.0\1.0\DesignTime\CommonConfiguration\neutral\Microsoft.WinJS.1.0\ 
```

在这种情况下，我收到以下一组错误：

![在此处输入图像描述](../Images/8aa92e797de907fa9f6d8c499b3b1acf.png)

我怀疑缺少其他一些文件，请参阅示例项目的解决方案资源管理器： ![在此处输入图像描述](../Images/279f44556ffe6001f379cde745d05c9c.png)

我越来越对**两个 base.js**文件感到困惑。我想要做的就是**开发 Windows 8 JS 应用程序，就像**在浏览器中的常规 web 应用程序一样。这可能会为我和许多其他开发人员节省大量时间，而不必通过 Visual Studio 运行。

这是文章 - [http://msdn.microsoft.com/en-us/library/windows/apps/Hh781229(v=win.10).aspx](http://msdn.microsoft.com/en-us/library/windows/apps/Hh781229(v=win.10).aspx) - 如何加载文件资源（使用 JavaScript 和 HTML 的 Windows 商店应用程序） - 但这对我没有多大帮助。任何建议表示赞赏:)

澄清一下：我想发布到 Windows 8 商店。仅**用于开发**我想使用浏览器。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T20:03:20.370

将无法在浏览器中运行 Windows 8 应用程序。它们依赖于许多仅由 WinRT 提供的东西。WinRT 框架仅适用于在模拟器中运行的应用程序或在 Windows 的 Windows 应用程序端运行的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T22:50:17.607

[http://dougseven.com/2011/10/24/language-choice-in-windows-8-is-not-about-portability/](http://dougseven.com/2011/10/24/language-choice-in-windows-8-is-not-about-portability/)

> 如果没有与 WinJS 或 WinRT 紧密耦合，一些 JavaScript 可能是可重用的。但就是这样。使该应用程序正常工作的大部分因素都依赖于 WinRT，因此它不可移植——WinRT 仅在 Windows 8 上运行。

很难接受，我不能直接在浏览器中运行 Win8 JS 应用程序 :(

# android - 在 Eclipse 中编译示例 JNI 代码

> ID：12734513
> 
> 赞同：1
> 
> 时间：2012-10-04T19:30:36.347
> 
> 标签：android, eclipse, android-ndk, java-native-interface

我在编译 Windows 7 上 Eclipse 中的 android-ndk-r8b 附带的一些示例 C 代码（hello-jni.c）时遇到了一些重大困难。我按照这里的说明进行操作[http://mhandroid.wordpress.com/ 2011/01/23/using-eclipse-for-android-cc-development/](http://mhandroid.wordpress.com/2011/01/23/using-eclipse-for-android-cc-development/) （在第 7 步中，我更改`ndk-build`为`bash -c ndk-build`使其正确运行）。Eclipse 吐出以下错误：

```
12:23:44 **** Incremental Build of configuration Default for project MyAndroidProject ****
bash -c ndk-build 
Install        : libhello-jni.so => libs/armeabi/libhello-jni.so
/cygdrive/c/make-3.82/install: line 1: Installation: command not found
/cygdrive/c/make-3.82/install: line 2: AndroidManifest.xml: command not found
/cygdrive/c/make-3.82/install: line 4: syntax error near unexpected token `C'
/cygdrive/c/make-3.82/install: line 4: `Copyright (C) 1994, 1995, 1996, 1999, 2000, 2001, 2002, 2004 Free'
make: *** [libs/armeabi/libhello-jni.so] Error 2
/cygdrive/c/android-ndk-r8b/build/core/build-binary.mk:418: recipe for target `libs/armeabi/libhello-jni.so' failed

12:23:45 Build Finished (took 1s.82ms) 
```

我很确定我包含了所有必要的文件和目录并正确设置了 PATH 环境变量（在 Windows 中），但我不知道为什么它一直给我这个错误。

编辑：忘了提到我能够在 Cygwin（最新版本）shell 中成功编译代码。我只想知道是否有办法使用 Eclipse (Juno)、ADT v20 来做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T20:25:08.247

您应该遵循[ADT 说明](http://tools.android.com/recent/usingthendkplugin)。

一般来说，NDK r8b 自带了**make**的预构建版本，完全可以在没有**cygwin**的情况下使用。对于这种情况，它具有 **ndk-build.cmd**。

# wordpress - Wordpress MU: www. to the http://

> ID：12734514
> 
> 赞同：0
> 
> 时间：2012-10-04T19:30:43.200
> 
> 标签：wordpress, .htaccess, wildcard

In my .htaccess what would I have to put in it to basically create a wildcard so if anyone accesses `www.*.domain.co.nz` it will redirect to `http://*.domain.co.nz`.

I can get it working for one domain but then I clicked what about the others.

At this stage I have an `index.html` being a hold page but I would also like to be able to access wordpress's `index.php`

I am using the standard MU `.htaccess`

```
RewriteEngine On
Options +FollowSymlinks
RewriteBase /
RewriteRule ^index\.php$ - [L]

# uploaded files
RewriteRule ^files/(.+) wp-includes/ms-files.php?file=$1 [L]

RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]
RewriteRule . index.php [L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T20:54:22.063

你有没有尝试过：

```
RewriteCond %{HTTP_HOST} ^(www\.)(.*)$ [NC]
RewriteRule ^(.*)$ http://%2/$1 [L,R=301] 
```

您需要将其放在`RewriteBase /`您的 htaccess 文件中。

# jquery-validate - Why my selectbox custom jquery validation not working?

> ID：12734515
> 
> 赞同：0
> 
> 时间：2012-10-04T19:30:44.067
> 
> 标签：jquery-validate, drop-down-menu

I want to validate my selectboxes and I tried different approaches.

I don't want allow user to use default value = "Please select".

Validation is working only on first time, but when I'm submitting the form validation is passing.

My HTML select:

```
 <select id="website_category" name="website[category]" class="selectBox" style="display: none; "><option value="">--- please select ---</option>
       <option value="Banking">Banking</option>
       <option value="Computers">Computers</option> 
```

< Coupons <

Here is my code:

```
 jQuery.validator.addMethod("notEqual", function(value, element, param) {
   return value != param;
  }, "Please select something");
  ...
  'website[category]': {
              notEqual: "--- please select ---"
        }, 
```

also tried

```
 required:true 
```

Here is what I get. When I choose default value gives me:

![](../Images/f1dfa1690d096b23bc0ff012d5f73caa.png)

but when I submit validation is passing:

![](../Images/fe676e07a2cf91d887d2d84e28768a66.png)

WHY it is happening like that ? Can someone suggest right solution ?

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-05T10:09:43.783

最好的方法是将其设置为禁用，如下所示：

```
<select id="website_category">
 <option value="-1" disabled selected="selected">---please select---</option>
  ....
</select> 
```

然后您检查客户端和服务器端的值 -1 以确保安全。

一旦用户更改了选择，您就不能再次选择该选项。这也强制执行错误检查。

# python - Json 转储 dict 会引发 TypeError：键必须是字符串

> ID：12734517
> 
> 赞同：20
> 
> 时间：2012-10-04T19:30:48.857
> 
> 标签：python, json, simplejson

我正在尝试`dict`使用以下方式将以下内容转换为 JSON `json.dumps`：

```
 {
     'post_engaged': 36,
     'post_impressions': 491,
     'post_story': 23,
     'comment_count': 6,
     'created_time': '03:02 AM, Sep 30, 2012',
     'message': 'Specialities of Shaktis and Pandavas. \n While having power, why there isn\\u2019t',
     < built - in function id > : '471662059541196',
     'status_type': 'status',
     'likes_count': 22
 } {
     'post_engaged': 24,
     'text': '30 Sept 2012 Avyakt Murlli ( Dual Voice )',
     'post_story': 8,
     'comment_count': 3,
     'link': 'http:\\/\\/www.youtube.com\\/watch?v=VGmFj8g7JFA&feature=youtube_gdata_player',
     'post_impressions': 307,
     'created_time': '03:04 AM, Sep 30, 2012',
     'message': 'Not available',
     < built - in function id > : '529439300404155',
     'status_type': 'video',
     'likes_count': 7
 } {
     'post_engaged': 37,
     'post_impressions': 447,
     'post_story': 22,
     'comment_count': 4,
     'created_time': '03:11 AM, Sep 30, 2012',
     'message': '30-09-12 \\u092a\\u094d\\u0930\\u093e\\u0924:\\u092e\\u0941\\u0930\\u0932\\u0940 \\u0913\\u0',
     < built - in function id > : '471643246209744',
     'status_type': 'status',
     'likes_count': 20
 } {
     'post_engaged': 36,
     'post_impressions': 423,
     'post_story': 22,
     'comment_count': 0,
     'created_time': '03:04 AM, Sep 29, 2012',
     'message': 'Essence: Sweet children, whenever you have time, earn the true income. Staying i',
     < built - in function id > : '471274672913268',
     'status_type': 'status',
     'likes_count': 20
 } {
     'post_engaged': 16,
     'text': 'Essence Of Murli 29-09-2012',
     'post_story': 5,
     'comment_count': 2,
     'link': 'http:\\/\\/www.youtube.com\\/watch?v=i6OgmbRsJpg&feature=youtube_gdata_player',
     'post_impressions': 291,
     'created_time': '03:04 AM, Sep 29, 2012',
     'message': 'Not available',
     < built - in function id > : '213046588825668',
     'status_type': 'video',
     'likes_count': 5
 } 
```

但它引导我

```
TypeError : keys must be a string 
```

该错误可能是由于 dict 包含，`keys`例如：

```
 <built-in function id>: '213046588825668' 
```

有人可以指导我，我应该如何从字典中删除这些元素？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-04T19:38:12.610

您可以尝试像这样清理它：

```
for key in mydict.keys():
  if type(key) is not str:
    try:
      mydict[str(key)] = mydict[key]
    except:
      try:
        mydict[repr(key)] = mydict[key]
      except:
        pass
    del mydict[key] 
```

这将尝试将任何不是字符串的键转换为字符串。任何无法转换为字符串或表示为字符串的键都将被删除。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-06-26T21:31:49.033

修改上面接受的答案，我写了一个函数来处理任意深度的字典：

```
def stringify_keys(d):
    """Convert a dict's keys to strings if they are not."""
    for key in d.keys():

        # check inner dict
        if isinstance(d[key], dict):
            value = stringify_keys(d[key])
        else:
            value = d[key]

        # convert nonstring to string if needed
        if not isinstance(key, str):
            try:
                d[str(key)] = value
            except Exception:
                try:
                    d[repr(key)] = value
                except Exception:
                    raise

            # delete old key
            del d[key]
    return d 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2019-09-18T15:01:06.700

我知道这是一个老问题，它已经有一个公认的答案，但可惜的是，公认的答案是完全错误的。

The real issue here is that the code that generates the dict uses the builtin `id` function as key instead of the literal string `"id"`. So the simple, obvious **and only correct** solution is to fix this bug at the source : check the code that generates the dict, and replace `id` with `"id"`.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-09-18T14:36:18.870

也许这会有所帮助：

```
your_dict = {("a", "b"):[1,2,3,4]}
# save
with open("file.json","w") as f:
    f.write(json.dumps(list(your_dict.items())))

# load
with open("file.json","r") as f:
    your_dict = dict([tuple((tuple(x[0]), x[1])) for x in json.loads(f.read())]) 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2019-03-19T11:10:45.457

例如，诺兰康纳威的回答给出了这个结果

> {“b'opening_hours'”：{“b'1_from_hour'”：720，“b'1_to_hour'”：1440，“b'1_break_from_hour'”：1440，“b'1_break_to_hour'”：1440，“b'2_from_hour' “：720，“b'2_to_hour'”：1440，“b'2_break_from_hour'”：1440，“b'2_break_to_hour'”：1440，“b'3_from_hour'”：720，“b'3_to_hour'”：1440，“ b'3_break_from_hour'"：1440，"b'3_break_to_hour'"：1440，"b'4_from_hour'"：720，"b'4_to_hour'"：1440，"b'4_break_from_hour'"：1440，"b'4_break_to_hour'" ：1440，“b'5_from_hour'”：720，“b'5_to_hour'”：1440，“b'5_break_from_hour'”：1440，“b'5_break_to_hour'”：1440，“b'6_from_hour'”：720，“b'6_to_hour'”：1440，“b'6_break_from_hour'”：1440，“b'6_break_to_hour'”：1440 ，“b'7_from_hour'”：720，“b'7_to_hour'”：1440，“b'7_break_from_hour'”：1440，“b'7_break_to_hour'”：1440}}1440}}1440}}

而这个修正版

```
import time
import re
import json
from phpserialize import *

class Helpers:
   def stringify_keys(self,d):
    """Convert a dict's keys to strings if they are not."""
    for key in d.keys():
        # check inner dict
        if isinstance(d[key], dict):
            value = Helpers().stringify_keys(d[key])
        else:
            value = d[key]
        # convert nonstring to string if needed
        if not isinstance(key, str):
            try:
                d[key.decode("utf-8")] = value
            except Exception:
                try:
                    d[repr(key)] = value
                except Exception:
                    raise

            # delete old key
            del d[key]
    return d 
```

会给这个更干净的版本..

> {“opening_hours”：{“1_from_hour”：720，“1_to_hour”：1440，“1_break_from_hour”：1440，“1_break_to_hour”：1440，“2_from_hour”：720，“2_to_hour”：1440，“2_break_from_hour”：1440，“2_break_to_hour “：1440，“3_from_hour”：720，“3_to_hour”：1440，“3_break_from_hour”：1440，“3_break_to_hour”：1440，“4_from_hour”：720，“4_to_hour”：1440，“4_break_from_hour”：1440，“4_break_to_hour”： 1440，“5_from_hour”：720，“5_to_hour”：1440，“5_break_from_hour”：1440，“5_break_to_hour”：1440，“6_from_hour”：720，“6_to_hour”：1440，“6_break_from_hour”：1440，“6_break_to_hour”：1440， “7_from_hour”：720，“7_to_hour”：1440，“7_break_from_hour”：1440，“7_break_to_hour”：1440}}

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2019-08-19T02:09:16.650

理想情况下，您希望清理数据，以便符合 JSON 支持的数据类型。

如果您只是想在序列化时从字典中抑制/或删除这些元素，您可以使用[`skipkeys`参数](https://docs.python.org/3.5/library/json.html#json.dumps)，描述可以在[`json.dump`部分中找到](https://docs.python.org/3.5/library/json.html#json.dump)

> 如果 skipkeys 为 true（默认值：False），则将跳过非基本类型（str、int、float、bool、None）的 dict 键，而不是引发 TypeError。

```
json.dumps(obj, skipkeys=True) 
```

这个解决方案更简洁，允许标准库为您处理错误的密钥。

**警告：您必须完全理解使用这种极端方法的含义，因为这将导致不合规数据类型（如 JSON 键）的数据丢失。**

* * *

## 回答 #7

> 赞同：-7
> 
> 时间：2015-09-17T20:30:10.013

也许这会帮助下一个人：

```
strjson = json.dumps(str(dic).replace("'",'"')) 
```

# android - Why do I get null as array element?

> ID：12734518
> 
> 赞同：0
> 
> 时间：2012-10-04T19:30:53.710
> 
> 标签：android, sharedpreferences

I have found a great [tutorial](http://www.sherif.mobi/2012/05/string-arrays-and-object-arrays-in.html) about storing arrays in SharedPreferences. Every time I add one item to an array, I store it in SharedPreferences, but when loading the array I get null for all values. Size of the array is increased by 1 every time, but the elements are stored as null. Why?

```
String tname[] = new String[loadArray(t_name, this).length + 1];
for (int i=0; i<tname.length; i++)
{
    Log.i("tname[" + i + "]", tname[i] + "");  //null
}
tname[tname.length-1] = et_name;  //this is a string which is not null
saveArray(tname, t_name, NewSchedule.this);

public boolean saveArray(String[] array, String arrayName, Context mContext) {   
        SharedPreferences prefs = mContext.getSharedPreferences("sp_name", 0);  
        SharedPreferences.Editor editor = prefs.edit();  
        editor.putInt(arrayName +"_size", array.length);  
        for(int i=0;i<array.length;i++)  
            editor.putString(arrayName + "_" + i, array[i]);  
        return editor.commit();  
    } 

    public String[] loadArray(String arrayName, Context mContext) {  
        SharedPreferences prefs = mContext.getSharedPreferences("sp_name", 0);  
        int size = prefs.getInt(arrayName + "_size", 0);  
        String array[] = new String[size];  
        for(int i=0;i<size;i++)  
            array[i] = prefs.getString(arrayName + "_" + i, null);  
        return array;  
    } 
```

Am I using the found code the right way?

****SOLUTION based ony 10s' answer:**

```
String tname[] = new String[loadArray(t_name, this).length + 1];
String[] prevPrefs = loadArray(t_name, this);
for(int i=0; i<prevPrefs.length; i++) {
   tname[i] = prevPrefs[i];  //0th element will be null, as well as e.g. the 4th when there are 3 elements
}
for (int i=0; i<tname.length; i++)
{
    if (tname[i] == null) {  //so we put the new value in place of the null
        tname[i] = et_name;
    }
}

//Arraylists are much handier than arrays
if (arr_names.size() > 0) arr_names.clear(); //first clear all elements
for (int i=0; i<tname.length; i++) {
   if (tname[i] != null) arr_names.add(tname[i]);
}
for (int i=0; i<arr_names.size(); i++) {
    if (arr_names.get(i) == null) {
        arr_names.remove(i);
        }
}

String[] tname2 = new String[arr_names.size()]; //create new array
for (int i=0; i<tname2.length; i++)  //popluate new array
{
    tname2[i] = arr_names.get(i);
}

saveArray(tname2, t_name, NewSchedule.this); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:22:25.753

问题在这里：

```
String tname[] = new String[loadArray(t_name, this).length + 1]; 
```

此行不会创建一个填充有值的数组：`loadArray(t_name, this).length + 1`实际上返回一个数字。这一切实际上被翻译为：

```
String tname[]= new String[5]; 
```

它实际上创建了一个具有空值的新字符串数组。

`prevPrefs[]`解决方案：然后您应该在从您的方法加载的临时项目中进行迭代，`loadArray()`并将它们添加`tname[]`如下：

```
String[] prevPrefs = loadArray(t_name, this);
for(int i=0; i<prevPrefs.length; i++) {
   tname[i] = prevPrefs[i];
} 
```

然后你会用前一个的值填充数组，你可以像你已经做的那样将新值添加到最后一个空点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T20:09:17.207

这一行是绝对错误的：

```
String tname[] = new String[loadArray(t_name, this).length + 1]; 
```

这一行说 -> 从首选项加载数组，然后立即将新内存分配给 tname

因此，您将始终在 tname 成员中获得 null 。

您应该在从首选项加载数组本身之前获取数组大小，创建数组（根据大小），然后才从首选项中复制数组字符串

<<<<< 编辑 >>>>>>

```
 String tname[] = loadArray(t_name, this); // only load the array, don't need "new String[]"

    for (int i=0; i<tname.length; i++)
    {
        Log.i("tname[" + i + "]", tname[i] + "");  //null
    }

    tname[tname.length-1] = et_name;  //this is a string which is not null
    saveArray(tname, t_name, MainActivity.this);

  public String[] loadArray(String arrayName, Context mContext)
  {
    SharedPreferences prefs = mContext.getSharedPreferences("sp_name", 0);
    int size = prefs.getInt(arrayName + "_size", 0);
    String array[] = new String[size + 1]; // +1 for storing the next value that should be saved
    for (int i = 0; i < size; i++)
        array[i] = prefs.getString(arrayName + "_" + i, null);
    return array;
  } 
```

# flash - FlashFirebug inspector can't find swfs

> ID：12734520
> 
> 赞同：0
> 
> 时间：2012-10-04T19:31:08.973
> 
> 标签：flash, firebug

I'm trying to debug a page with multiple swfs on it. However, when I go to the FlashFirebug inspector and have it scan for swf files, it turns up nothing. But, if I look on the right hand panel, under SWFs, it seems to have found all of them perfectly. Also, the console and every other part of flash firebug seems to be able to find and work with these swfs just fine.

How can I get the inspector to find the swfs that the rest of the add-on can?

Here's what I'm running this on:

*   Firefox 15.0.1
*   Firebug 1.10.3
*   FlashFirebug 4.49
*   Flash 11.4.402.265 Debug version for Mac
*   Mac OSX Mountain Lion (10.8.2)

I've tried this on some other sites and was able to use the inspector just fine, so I know it does work. Also, since I work on this site, I know that the swfs are as3 files.

Thanks for any advice you can give

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T18:01:23.200

FlashFirebug 的作者在这里，将包含这些无法检测的 SWF 的站点发送给我（使用联系表）。我假设你肯定知道他们是 AS3。因为检查器仅适用于 AS3 SWF。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:29:05.697

真的没有答案，但同样的事情发生在我身上： http: [//www.adobe.com/products/flash.html](http://www.adobe.com/products/flash.html)

neroli.swf、fonts.swf 和 shareScreen.swf 出现在右侧的“SWF”选项卡下，但检查器显示“单击此处扫描 AS3 SWF 文件”。并单击后：“在此页面上未检测到 AS3 SWF 文件。” 这发生在我自己的本地应用程序上，检查员有时也会工作（但大多数情况下不起作用）。FF16.0.2、WinXP64、Firebug 1.10.6 FlashFirebug 4.55。

o-minds 网站上的论坛也不错。

# ios - 在 iOS Phonegap 应用程序上序列化文件传输

> ID：12734529
> 
> 赞同：0
> 
> 时间：2012-10-04T19:32:01.947
> 
> 标签：ios, cordova, serialization, file-transfer

我有一个适用于 iOS 的 phonegap 应用程序，它从服务器下载图像和 pdf 文件，因为它们必须在本地可用。

我使用 jQuery 解析以查找我需要下载的资产列表，然后使用 Phonegap API 启动 FileTransfer，如下所示：

```
// assets is an array that has all pdf and image urls to be downloaded.
assets.map(downloadFile);

function downloadFile(file_url){
    console.log('Downloading file:'+file_url);
    var fileTransfer = new FileTransfer();

    fileTransfer.download(
        file_url,
        get_local_file_path(file_url),
        download_success,
        function(error) {
            stopspin();
            console.log('ERROR downloading: '+ error.source);
            $('#notify-user').html('Downloading failed. <a href="#" onclick="checkLatestIssue()">Try again?</a>')
        }
    );
} 
```

现在，资产每次最多可以有 50 个。我可以看到所有文件传输请求都会立即发送，有时，一些文件传输请求会超时，从而使我无法通过本地资源渲染下载。

有没有办法可以通过大约 5 次并行下载来连续下载所有这些问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-02T01:52:02.283

我在我的应用程序上所做的是创建一个需要下载的文件的全局数组，然后启动从数组前面抓取第一个元素并下载它的代码。完成后，它会检查数组中是否还有要处理的项目，如果是，则重新开始该过程。如果没有，它将完成下载并继续执行应用程序接下来需要执行的任何操作。

为我们的文件创建一个空白数组以供下载 `data_to_process = [];`

将图像和视频添加到从 API 返回的数组形式“结果”中

```
// add images to array
$.each( result.images_to_download, function( index, value ) {

    index = index + 1;
    data_to_process.push(
        {
            "type":     "images",
            "filename": value,
            "msg":      "Downloading image "+index+" of "+result.images_to_download.length+"..."
        }
    );
});

// add videos to array
$.each( result.videos_to_download, function( index, value ) {

index = index + 1;
data_to_process.push(
    {
        "type":     "videos",
        "filename": value,
        "msg":      "Downloading video "+index+" of "+result.videos_to_download.length+"..."
    }
);
}); 
```

这是处理文件的代码注意：这里有一些不需要的代码，我用来根据文件的内容将文件放在某些目录中，更新下载进度的百分比指示器等：

```
// values for percentages
start_data_length = data_to_process.length;
current_iteration = 0;

// set writing to false
writing = false;

// what we do after each iteration in the data array
var finish_processing = function() {

    // increment iteration count
    current_iteration++;

    // set percent value
    var percent = current_iteration / start_data_length * 100;
    percent = Math.round( percent );
    $('#update_percent').html( percent );

    // remove from array after process
    data_to_process.splice( 0, 1 );

    // set writing back to false so we can start another iteration
    writing = false;
}

// checks if we need to process the next part of the array or not
var check_to_process = function() {

    // console.log('checking if we need to process');

    // if we still have items in the array to process
    if ( data_to_process.length > 0 ) {

        // if we're currently not working on an item
        if ( writing === false ) {

            // process next item in array
            process_download_data();

        } else {

            // not ready yet, wait .5 seconds and check again
            // console.log('busy - waiting to process');
            setTimeout( check_to_process, 500 );
        }

    } else {

        // console.log('nothing left to process');
    }
}

// processes the downloaded data
var process_download_data = function() {

    // set writing to true
    writing = true;

    // current item to process is first item in array
    var current_item = data_to_process[0];

    if ( current_item.msg ) {
        $('#update_item').html(current_item.msg);
    } else {
        $('#update_item').html('Processing update data...');
    }
    // console.log( 'processing this: '+ current_item.filename );

    // if something didn't work right..
    var broke = function(error) {

        // console.log( 'error' );
        // console.log( error );

        // cycle to next item in array
        finish_processing();
    }

    // get the directory of current item's "type"
    var get_directory = function( fileSystem ) { 
        fileSystem.root.getDirectory( current_item.type, {create:true,exclusive:false}, get_file, broke ); 
    } 

    // get the file
    var get_file = function( dirEntry ){

        // if texts
        if ( current_item.type == 'texts' ) {

            dirEntry.getFile( current_item.filename+".txt", {create: true, exclusive: false}, create_text_writer, broke); 

        // if images
        } else if ( current_item.type == 'images' ) {

            var localFileName = current_item.filename.substring(current_item.filename.lastIndexOf('/')+1);

            dirEntry.getFile( localFileName, {create: true, exclusive: false}, create_file_writer, broke);

        // if videos
        } else if ( current_item.type == 'videos' ) {

            var localFileName = current_item.filename.substring(current_item.filename.lastIndexOf('/')+1);

            dirEntry.getFile( localFileName, {create: true, exclusive: false}, create_file_writer, broke);

        // if audios
        } else if ( current_item.type == 'resources' ) {

            var localFileName = current_item.filename.substring(current_item.filename.lastIndexOf('/')+1);

            dirEntry.getFile( localFileName, {create: true, exclusive: false}, create_file_writer, broke);

        // if audios
        } else if ( current_item.type == 'audios' ) {

            var localFileName = current_item.filename.substring(current_item.filename.lastIndexOf('/')+1);

            dirEntry.getFile( localFileName, {create: true, exclusive: false}, create_file_writer, broke);
        }
    } 

    // write to file using filetransfer
    var create_file_writer = function( fileEntry ) {

        if ( current_item.remove === true ) {

            fileEntry.remove( function(entry) {

                // what to do when image is deleted
                finish_processing();

            },broke);

        } else {

            var localPath = fileEntry.fullPath;

            // console.log('Writing to: '+localPath+' from: '+current_item.filename);

            var ft = new FileTransfer();

            ft.download( current_item.filename, localPath, function(entry) {

                // what to do when image is downloaded
                finish_processing();

            },broke);
        }
    }

    // create writer for "texts" type
    var create_text_writer = function( fileEntry ) { 
        fileEntry.createWriter( write_text_file, broke ); 
    } 

    // write to file for "texts" type
    var write_text_file = function( writer ) {

        // write new contents
        writer.write( current_item.data );

        // add item where it needs to be in the document
        if ( current_item.append === true ) {

            $('#'+current_item.marker).nextAll().remove();

            // appending
            // console.log('Appending data to: #'+current_item.id);
            $('#'+current_item.id).append( current_item.data );

        } else {

            // adding
            // console.log('Adding data to: #'+current_item.id);
            $('#'+current_item.id).html( current_item.data );
        }

        // console.log('finished writing: '+current_item.filename);

        finish_processing();
    }

    // request persistent filesystem
    window.requestFileSystem( LocalFileSystem.PERSISTENT, 0, get_directory, broke );

    // check if we need to process the next item yet
    check_to_process();
}

// process data from the update
process_download_data(); 
```

# iis - 如何让 IIS 压缩 .svg 文件？

> ID：12734534
> 
> 赞同：11
> 
> 时间：2012-10-04T19:32:25.477
> 
> 标签：iis, optimization, compression, gzip

我正在尝试在 web.config 中完成此操作：

```
<staticContent>
  <mimeMap fileExtension=".svg" mimeType="image/svg+xml" />
</staticContent>
<httpCompression>
    <staticTypes>
        <add mimeType="image/svg+xml" enabled="true"/>
    </staticTypes>
</httpCompression>
<urlCompression doStaticCompression="true" doDynamicCompression="true"/> 
```

但`Content-Encoding: gzip`永远不会出现在响应标头中。不过，压缩对于 CSS 等其他类型也很有效。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-10-10T12:27:12.933

@Dominique Alexandre 指出了一个解决方案，该解决方案显示了如何编辑 applicationHost.config 文件，它工作得很好。

我只是想添加如何使用 IIS 管理器 GUI 执行此操作。

转到 IIS 管理器 > YOUR_SERVER > 在管理部分 > 配置编辑器 > 展开 system.webServer > httpCompression > dynamicTypes

然后添加您想要额外压缩的 mime 类型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-27T15:36:36.030

您需要在 IIS 中将其作为较低级别的 SVG 打开。这篇文章有答案：[https ://stackoverflow.com/a/23940235/15233](https://stackoverflow.com/a/23940235/15233)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-24T14:21:05.823

在我的情况下，`image/svg+xml`它已经被列为 mime 类型，`<staticTypes>`但它仍然无法正常工作。一时兴起，我还添加了 mime 类型`<dynamicTypes>`并解决了问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-03T12:48:56.000

改变mime-type真的不好。

请参阅这篇文章，了解如何实现一个自定义的 httpmodule，它会在几行代码中为您执行 gzipping。

[http://laubplusco.net/gzip-svg-files-asp-net/](http://laubplusco.net/gzip-svg-files-asp-net/)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-05-11T15:31:51.637

**不相关，请参阅 Dominique Alexandre 解决方案**

好吧，没有人有答案。所以我会在这里发布我的临时解决方法。

我将 mime 类型更改为 text/xml，所以它被 IIS GZipped：

```
<mimeMap fileExtension=".svg" mimeType="text/xml" /> 
```

# ios - 在 iOS6 + PhoneGap 中流式传输音频

> ID：12734536
> 
> 赞同：0
> 
> 时间：2012-10-04T19:32:32.047
> 
> 标签：ios, cordova, ios6

我正在开发一个记录和播放音频的应用程序（使用 Cordova 2.1.0）。基本上有一个音频资源列表和一个`<audio>`标签。用户点击列表中的一项，远程服务器上音频文件的 URL 将添加到标签中，然后播放。起初，这很好用。

还有一个按钮允许用户使用 Cordova 的`Media`对象录制新的音频。媒体被录制，使用 AudioEncode 插件编码到 AAC，然后上传。列表会用新的音频文件刷新。这一切也都按预期工作。

现在，在使用 Media 对象后，我尝试播放任何音频文件，但都失败了。（但是，我没有使用 Media 播放音频。我实际上使用的是 Sencha Touch 的`Audio.play()`）。

在 iOS 5 中，整个过程始终按预期工作。升级到 iOS 6 后，录制新音频后将无法播放音频。有没有人遇到过类似的问题？有解决方案或解决方法吗？

**更新：**我最近注意到，如果在录制（`Media.play()`）之后播放音频，然后上传，它不会干扰后续的音频流。但是，如果用户录制了音频，然后上传而不播放，则从那时起所有音频流都会中断。

这是音频正常播放时控制台显示的内容：

```
[MPAVController] Autoplay: Enabling autoplay
[MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 0, on player: 1)
[MPAVController] Autoplay: Enabling autoplay
[MPCloudAssetDownloadController] Prioritization requested for media item ID: 0
[MPAVController] Autoplay: Enabling autoplay
[MPAVController] Autoplay: Enabling autoplay
[MPCloudAssetDownloadController] Prioritization requested for media item ID: 0
[MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 0, on player: 1)
[MPAVController] Autoplay: Disabling autoplay for route change
[MPAVController] Autoplay: Disabling autoplay
[MPAVController] Autoplay: Enabling autoplay
[MPAVController] Autoplay: _streamLikelyToKeepUp: 0 -> 1
[MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 0, on player: 1)
(Plays audio here)
[MPAVController] Autoplay: Disabling autoplay
[MPAVController] Autoplay: Disabling autoplay for pause
[MPAVController] Autoplay: Disabling autoplay
[MPAVController] Autoplay: _streamLikelyToKeepUp: 1 -> 1 
```

这是控制台在失败时显示的内容：

```
[MPAVController] Autoplay: Enabling autoplay
[MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 0, on player: 1)
[MPAVController] Autoplay: Disabling autoplay for pause
[MPAVController] Autoplay: Disabling autoplay
[MPAVController] Autoplay: Enabling autoplay
[MPCloudAssetDownloadController] Prioritization requested for media item ID: 0
[MPAVController] Autoplay: Enabling autoplay
[MPAVController] Autoplay: Enabling autoplay
[MPCloudAssetDownloadController] Prioritization requested for media item ID: 0
[MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 0, on player: 1)
[MPAVController] Autoplay: Enabling autoplay
[MPAVController] Autoplay: _streamLikelyToKeepUp: 0 -> 1
[MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 0, on player: 1)
[MPAVController] Autoplay: Disabling autoplay for pause
[MPAVController] Autoplay: Disabling autoplay 
```

# node.js - Expressjs Creud 数据库与 mongolab

> ID：12734540
> 
> 赞同：0
> 
> 时间：2012-10-04T19:32:42.723
> 
> 标签：node.js, express, mlab

我试图找到一个正常工作的 crud w expressjs 示例和一个它没有过时的数据库。

真的让我说为什么我不回去 w rails ....

我搜索了网络论坛手册视频没有运气.....那很难它是 expressjs 数据库集成？

任何人都可以与社区分享一个快速的 mongolab 示例 crud ??

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T20:50:41.563

将所有数据库内容放入一个单独的文件中是一个很好的做法，该文件可以在不同的项目中轻松重用。您`db.js`可能如下所示：

```
var mongoose = require('mongoose');

var db = mongoose.createConnection("mongodb://<db_user>:<db_password>@ds0<db_port>.mongolab.com:<db_port>/<db_name>");

var playerSchema = new mongoose.Schema({
  name: String,
  tournament: String
});

exports.Player = db.model("player", playerSchema); 
```

您只需将 <> 字段替换为您的凭据。然后在你的主要`app.js`创建一个用于创建新玩家的路线（`POST`方法）。

```
var routes = require('./routes');
app.post("/", routes.createPlayer); 
```

最后在你的`routes.js`

```
var db = require('./db');
exports.createPlayer = function(req, res) {
  var player = new db.Player();
  player.name = req.body.player_name;
  player.tournament = req.body.tournament;
  player.save(function(err) {
    if (err) {
      console.log(err);
    }
    res.redirect("/" + player._id);
  });
}; 
```

其他方法（`PUT`->`UPDATE`和-> ）`DEL`也是如此。对于并且您必须覆盖客户端表单中的方法（服务器端由中间件自动完成）：`GET``READ``DEL``PUT``methodOverride`

```
<input type="hidden" name="_method" value="delete"/> 
```

要使用重定向，请将以下内容添加到您的`app.js`

```
app.get("/:player_id", routes.showPlayer) 
```

和你的`routes.js`

```
exports.showPlayer = function(req, res) {
  res.send('Details about Player ' + req.params.player_id)
} 
```

玩得开心创建您的应用程序！

# json - 使用 rest Sharp 对 json rest 服务输出进行反序列化的问题

> ID：12734544
> 
> 赞同：1
> 
> 时间：2012-10-04T19:32:51.017
> 
> 标签：json, restsharp

我的休息服务返回下面的 JSON，但由于某种原因，休息锐利没有将响应正确地反现实化为对象。谁能看到这里发生了什么？“响应”对象正在设置，但其中的“存储”数组/列表始终设置为空。

[我在http://www.stum.de/2009/12/22/using-restsharp-to-consume-restful-web-services/](http://www.stum.de/2009/12/22/using-restsharp-to-consume-restful-web-services/)尝试了 Michael stum 的文章，并对下面的代码进行了一些修改，似乎无法理解正确的。有任何想法吗？

JSON：

```
{
"stores": [
{
"name": "Group Health"
},
{
"name": "QFC - Seattle/Rainier #849"
}
]
} 
```

* * *

我需要使用 Rest Sharp 将其反现实化为一个对象，以便我可以在客户端中使用这些数据。我的班级定义如下

```
public class store
{
public string name{get;set;}
}
public class Result
{
public store[] stores;
} 
```

我使用下面的行来取消实现其余响应

```
var response = client.Execute<Result>(request); 
```

还尝试了如下结果定义，结果相同。

```
public class Result
{
public List<store> stores;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T16:13:05.980

Result 类中的成员“stores”应该是一个属性：

```
public class Result
{
    public List<store> stores { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-30T16:22:43.013

使用动态数据类型去实现。

```
var response = _client.Execute<dynamic>(request); 
```

# java - ":" 在 for() 函数中

> ID：12734550
> 
> 赞同：4
> 
> 时间：2012-10-04T19:33:22.960
> 
> 标签：java

我正在做一个涉及董事会的任务。基本代码给了我们修改，但是我不明白`:`for()的参数中的什么意思。它是否通过所有板（`ArrayList`）？

```
private ArrayList<MovingElement> moveElems = new ArrayList<MovingElement>();

for (MovingElement mElement : moveElems) {
    mElement.step();
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-04T19:34:21.390

这是一种特殊形式的`for`循环，用于遍历数组和 any [`Iterable`](http://docs.oracle.com/javase/6/docs/api/java/lang/Iterable.html)，其中包括 any [`Collection`](http://docs.oracle.com/javase/6/docs/api/java/util/Collection.html)。

这被称为*for-each*循环，如：*for each element of a list*。

阅读：`for (MovingElement mElement : moveElems)`as _for each `MovingElement`in the collection `moveElems_`。

请参阅：[For-Each 循环](http://docs.oracle.com/javase/1.5.0/docs/guide/language/foreach.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-04T19:34:12.833

这是[`for-each`](http://docs.oracle.com/javase/1.5.0/docs/guide/language/foreach.html)Java中的循环。

对于`Arraylist`（或）数组中的每个元素。

该元素将被分配给作用域为 for 循环的 MovingElement mElement。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-04T19:36:37.237

可以这样想：

```
for (MovingElement mElement : moveElems) {
    // translates into English like this: 
    // for EACH MovingElement object in the ArrayList moveElems, 
    // do the following code:
    mElement.step();
} 
```

它是一个 for each 循环。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-04T19:39:29.210

这是一个简单的 foreach 循环，它将遍历给定数组中的每个元素。

在这种情况下，MovingElement 将是数组的类型，mElement 将是当前元素，moveElems 将是实际数组。

“：”仅在两个部分之间分隔

因此，在您的情况下，循环将遍历 ArrayList 中的每个元素并使用它的 step() 方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-04T19:35:33.133

这在 Java 中称为 foreach 或增强的 for 循环。char将`':'`迭代变量类型/名称与要遍历的对象分开。

这是一个解释其使用的小[教程](https://blogs.oracle.com/CoreJavaTechTips/entry/using_enhanced_for_loops_with)，知道它是在 Java 语言的 1.5 版中引入的，这很有用。它是语法糖，可以通过使用标准 for 循环和/或使用迭代器来实现相同的迭代行为。

foreach 循环可用于遍历数组中的元素，或遍历实现[Iterable](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Iterable.html)接口的对象（通常是集合）。

仅供参考，foreach 语句在 Java 语言规范的第[14.14.2节中定义。](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.14.2)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-04T19:37:27.970

这是 Java 的“for each”语法。它或多或少等同于：

```
Iterator<MovingElement> iter = moveElems.iterator();
while (iter.hasNext()) {
    iter.next().step();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-04T19:38:16.300

For-each 循环旨在简化最常见的迭代形式，其中迭代器或索引仅用于迭代，而不用于任何其他类型的操作。

[http://docs.oracle.com/javase/1.5.0/docs/guide/language/foreach.html](http://docs.oracle.com/javase/1.5.0/docs/guide/language/foreach.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-04T19:44:16.510

**-**你刚刚遇到的是一个被称为扩展 for-loop 或更着名的 for-each 循环。

`for( DataType variable : Iterable )`

**例如：**

`for( String variable : arr )`

`arr` **-**可以是字符串类型的数组或集合（即 Iterables）

`s` **-**将在每次迭代中获取 arr 的每个值并将其分配给 s

# sql - 在 where 子句中计数时出现错误“ORA-00920：无效的关系运算符”

> ID：12734563
> 
> 赞同：0
> 
> 时间：2012-10-04T19:34:19.403
> 
> 标签：sql, oracle10g

这是员工与依赖关系。我无法仅显示拥有多个受抚养人的员工。emp_no 555555 不应该存在的行。

```
 SELECT emp_no, emp_name, dep_emp_no, dep_name, dep_relationship, trunc(MONTHS_BETWEEN(current_date, dep_date_of_birth)/12) "Age"
 FROM DEPENDENT d JOIN employee e ON e.emp_no=d.dep_emp_no
WHERE dep_date_of_birth=(SELECT MIN(DEP_DATE_OF_BIRTH) FROM DEPENDENT dd WHERE d.dep_emp_no=dd.dep_emp_no)

 EMP_NO EMP_NAME                       DEP_EM DEP_NAME             DEP_RELATI        Age
 ------ ------------------------------ ------ -------------------- ---------- ----------
 444444 Hickman, Ron                   444444 Amy                  DAUGHTER           22
 555555 Moore, Wayne                   555555 Sharon               SPOUSE             65
 111111 Li, Anna                       111111 Chris                SON                 8 
```

这就是给我错误的原因：

```
 SELECT emp_no, 
        emp_name, 
        dep_emp_no, 
        dep_name, 
        dep_relationship, 
        trunc(MONTHS_BETWEEN(current_date, dep_date_of_birth)/12) "Age"
   FROM DEPENDENT d 
   JOIN employee e ON e.emp_no=d.dep_emp_no
  WHERE dep_date_of_birth=(SELECT MIN(DEP_DATE_OF_BIRTH) 
                             FROM DEPENDENT dd 
                            WHERE d.dep_emp_no=dd.dep_emp_no)
 and where DEP_EMP_NO exists (select count(dep_emp_no) 
                                from dependent 
                              having count(dep_emp_no)>1 
                            group by dep_emp_no); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:39:37.040

计数中缺少一个`and where DEP_EMP_NO`太多和一个条件。以下应该工作。

```
SELECT emp_no, 
       emp_name, 
       dep_emp_no, 
       dep_name, 
       dep_relationship, 
       trunc(MONTHS_BETWEEN(current_date, dep_date_of_birth)/12) "Age"
  FROM DEPENDENT d 
  JOIN employee e ON e.emp_no=d.dep_emp_no
 WHERE dep_date_of_birth=(SELECT MIN(DEP_DATE_OF_BIRTH) 
                            FROM DEPENDENT dd 
                           WHERE d.dep_emp_no=dd.dep_emp_no)
  and  exists (select count(dep_emp_no) 
                           from dependent d2 
                           where d.dep_emp_no=d2.dep_emp_no
                           group by dep_emp_no
                           having count(dep_emp_no)>1 ); 
```

# java - 如何在 Eclise 中添加 ACM 库？

> ID：12734566
> 
> 赞同：3
> 
> 时间：2012-10-04T19:34:24.397
> 
> 标签：java, acm-java-libraries

我正在上 CS 入门课程，与 Eclipse 相比，Dr.Java 的功能确实有限。如何添加 ACM.jar 文件以在 Eclipse 中使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:52:34.417

看看下面的视频教程，它是关于 ACM 的。在最初的几分钟里，它谈到了将它添加到 eclipse 中。 [http://www.youtube.com/watch?v=PoyGznP8Ehk](http://www.youtube.com/watch?v=PoyGznP8Ehk)

要不然

[在 Eclipse 中导入库？](https://stackoverflow.com/questions/4962559/import-libraries-in-eclipse)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:36:59.783

将其复制到项目目录。右键单击 jar - 选择构建路径，然后单击添加到构建路径。

您现在可以从类中的 jar 导入类。

# php - 如何检查两个 assoc php 数组的值是否相等？

> ID：12734575
> 
> 赞同：-1
> 
> 时间：2012-10-04T19:35:05.500
> 
> 标签：php, arrays

> **可能重复：**
> [php比较两个关联数组](https://stackoverflow.com/questions/10266148/php-compare-two-associative-arrays)

我有两个 PHP 数组

```
$arr1 = array ([0] => apple, [1] => banana);
$arr2 = array ([banana] => banana, [apple] => apple); 
```

在我的网络应用程序中，我不知道这些数组中的顺序是什么以及有多少元素。此外，一个数组使用数字作为键，而另一个数组使用键 = 值。

如何检查 $arr1 的值是否等于 $arr2 的值？

非常感谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:38:23.103

使用[array_values](http://php.net/array_values)将两个数组的所有值提取到数字键数组中。然后进行一些排序/唯一性以确保所有内容的顺序相同并进行相等测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T19:39:32.883

因为他们有不同的钥匙

```
$arr1 = array (0 => "apple", 1 => "banana");
$arr2 = array ("banana" => "banana", "apple" => "apple"); 
```

您可以使用`array_diff`

```
if(!array_diff($arr1, $arr2))
{
    // They are the same 
} 
```

您可以使用`array_intersect`

```
if(count($arr1) == count(array_intersect($arr1, $arr2)))
{
      // They are the same ;
} 
```

你可以使用数组`array_filter`

```
if(array_filter($arr2,function($var)use($arr1){return !in_array($var,$arr1);}))
{
     // They are the same ;
} 
```

您可以使用`array_values`

```
$arr2 = array_values($arr2);
sort($arr1);sort($arr2); //sort to make sure they are in the same position 

if($arr1 === $arr2)
{
    // They are the same
} 
```

# regex - 从 ifconfig 解析接口

> ID：12734577
> 
> 赞同：4
> 
> 时间：2012-10-04T19:35:20.180
> 
> 标签：regex, sed, grep

我正在尝试以这种形式从命令行获取网络接口列表：

```
"wlan0","eth0","lo" 
```

我不需要按特殊顺序购买它们。

我可以做这个：

```
wlan0,eth0,lo 
```

使用这个超级非优化命令，经过大量搜索并且我认为我已经达到了我的极限：

```
ifconfig -a | grep -E '' | sed -n 's/^\([^ ]\+\).*/\1/p' | tr -d '\n' | sed s/:/,/g | sed 's/.$//' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T19:53:21.427

我会把这个加到一堆。在第一个 sed 中添加引号，然后用粘贴加入行。

```
ifconfig -a | sed -n 's/^\([^ ]\+\).*/"\1"/p' | paste -sd "," 
```

这比 tr 好，因为没有尾随逗号。

更好的是，由于 ifconfig -a 输出不能真正指望保持一致，请检查 /sys/class/net

```
ls /sys/class/net | sed -e 's/^\(.*\)$/"\1"/' | paste -sd "," 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T19:47:03.457

怎么样：

```
ifconfig -a | sed -e '/^ /d;/^$/d;s/\([^ ]*\) .*/"\1"/' | tr '\n' ',' 
```

我们正在执行三个命令：

1.  `/^ /d`此命令检查行是否以空格开头。如果是，“d”将其删除（并转到下一行而不执行剩余的命令）。
2.  `/^$/d`此命令删除空行
3.  `s/\([^ ]*\) .*/"\1"/`当上述命令失败时（即，现在我们有一行不为空*且不*以空格开头）时会执行此命令。它所做的是尽可能多地捕获不是空格的字符，然后匹配从空格到行尾的所有字符。替换字符串包含特殊的`\1`“变量”，其中包含捕获的字符串（即接口名称）。我们还将它包含在引号之间。

在 sed 命令之后，我们有双引号之间的接口，但每行一个。为了解决这个问题，我们使用`tr '\n' ','`逗号替换换行符。

希望这会有所帮助=)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-04T19:51:09.393

```
ifconfig -a | awk '/^[^[[:space:]]/{a[NR]=$1} END{count=asort(a,b);for(i=1;i<count;i++){printf "\"%s\",", b[i]}; printf "\"%s\"\n", b[count]}' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-04T20:01:56.013

在`Perl`外壳中：

```
ifconfig |
perl -ane '
    END{print "\042", join("\042,\042", @a), "\042\n"}
    $a[$c++] = $1 if /^(\w+)/; 
' 
```

如果您使用，请尝试以下操作`bash`：

```
x=( $(ifconfig | grep -o '^[[:alnum:]]\+') )

for ((i=0; i<${#x[@]} -1; i++)); do
    printf '"%s",' ${x[i]}
done

printf '"%s"\n' ${x[-1]} 
```

基于 Tom McClure 之一，但没有解析 ls ：

```
printf '"%s"\n' $(
    printf '%s\n' /sys/class/net/* | cut -d '/' -f 5
) | paste -sd "," 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-04T19:54:37.160

如果有，最好解析文件系统中的相应节点`/sys`，但请尝试

```
ifconfig -a |
awk '/^[^ ]/ { printf ("%s\"%s\"", s, $1); s="," }' 
```

如果接口名称字段有尾随冒号，您可以使用`awk -F:`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-05T01:01:25.277

**`GNU find`使用and的一种方法`/sys/class/net/`：**

```
find /sys/class/net/ ! -type d -printf "\"%f\"," | sed 's/,$/\n/' 
```

**一种方式解析`ifconfig -a`：**

```
ifconfig -a | sed -ne '/^[^ ]/ { s/^\([^ ]\+\).*/"\1"/; H }' -e '$ { g; s/\n//; s/\n/,/g; p }' 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-01-02T05:11:21.503

如果您只想要一个接口列表，这应该可以工作：

```
echo $(ifconfig | sed -n '/^[[:alnum:]]*:/s/:.*//p') 
```

如果您确实需要项目之间的逗号，那么您可以添加以下管道：

```
| sed 's/ /,/g' 
```

如果你真的想要双引号和逗号，那么你可以添加以下管道：

```
| sed -e 's/ /","/g' -e 's/.*/"&"/' 
```

# azure - 将错误记录到 Azure VM？

> ID：12734578
> 
> 赞同：0
> 
> 时间：2012-10-04T19:35:22.090
> 
> 标签：azure

我正在转储我的 Web 应用程序尝试捕获异常错误跟踪消息到网络服务器上的 C:\Temp 文件夹但是当我的 Web 应用程序在 azure 上时，我希望在 azure VM c:\Temp 文件夹中看到它们，但是我收到一条错误消息，说访问路径 C:\temp denied 。如何将错误日志写入文本文件并保存到 azure VM 的 C:\Temp ？或者这在 azure 上是不可能的？任何替代解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:44:29.347

您使用的是 Azure Web 角色、Azure Virtual Mashines 还是 Azure 网站？我假设 Azure Web 角色（又名云服务）。

如果是这种情况，您需要为 WebRole使用[本地存储资源。](http://msdn.microsoft.com/en-us/library/windowsazure/ee758708.aspx)然后，您可以使用[Windows Azure 诊断程序](http://msdn.microsoft.com/en-us/library/windowsazure/hh411551.aspx)偶尔将您的日志传输到 Blob 存储。Diagnostics.Wadcfg 需要的部分是`<DataSources>`元素，它的子元素`<DirectoryConfiguration>`可以有一个类型为 的子元素`<LocalResource>`。前者将具有`name`指向您为 WebRole 配置的本地存储资源的属性。

如果是虚拟机的情况 - 您应该没有任何问题，因为您拥有完全的管理员访问权限，并且您可以在该机器上配置 ACL 的任何方面。

如果是 Azure 网站 - 不要写入 C:\TEMP，而是为 Web 应用程序文件夹创建一个本地文件夹，然后在其中写入`Server.MapPath("~/local.logs/somelog.txt");`

# vb.net - vb中的菜单条保存选项

> ID：12734586
> 
> 赞同：-2
> 
> 时间：2012-10-04T19:35:43.713
> 
> 标签：vb.net, save

我做了一个菜单条，我需要知道如何使我必须保存的选项实际保存。

我使用`Me.Close`关闭选项，我只需要知道如何保存。

感谢！

* * *

来自评论

这就是我所拥有的......虽然保存显然是错误的。

```
Private Sub SaveToolStripMenuItem_Click(sender As System.Object, e As System.EventArgs) Handles SaveToolStripMenuItem.Click 
    SaveToolStripMenuItem.DropDownItems("Save").Enabled = False 
End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T19:49:44.603

```
Private Sub SaveToolStripMenuItem_Click(sender As System.Object, e As System.EventArgs) Handles SaveToolStripMenuItem.Click
    Using writer As StreamWriter = New StreamWriter("book_list.txt", True)
        For Each line As String In ListBox1.Items
            writer.WriteLine(line)
        Next
    End Using
End Sub 
```

假设你`ListBox`被称为`ListBox1`

# scala - 设计问题：尝试使用 Scala 类型边界避免代码重复

> ID：12734591
> 
> 赞同：1
> 
> 时间：2012-10-04T19:36:12.057
> 
> 标签：scala, design-patterns, code-duplication

我是 Scala 的新手，我正在尝试使用类型边界来避免以下代码中的代码重复（从不相关的东西中清除）：

```
trait StandardStep1[-I1] {
  def next_step(i:I1):StandardStep2
}

trait StandardStep2

trait UniqueStep1[-I1] extends StandardStep1[I1] {
  def next_step(i:I1):UniqueStep2
}

trait UniqueStep2 extends StandardStep2

class DoubleStandardStep1[-IL,-IR](left:StandardStep1[IL], right:StandardStep1[IR]) extends StandardStep1[(IL,IR)] {
  def next_step(i:(IL,IR)) = {
    val (i_left, i_right) = i
    val new_left = left.next_step(i_left)
    val new_right = right.next_step(i_right)
    new DoubleStandardStep2(new_left, new_right)
  }
}

class DoubleStandardStep2(left:StandardStep2, right:StandardStep2) extends StandardStep2

class DoubleUniqueStep1[-IL,-IR](left:UniqueStep1[IL], right:UniqueStep1[IR]) extends UniqueStep1[(IL,IR)] {
  def next_step(i:(IL,IR)) = {
    val (i_left, i_right) = i
    val new_left = left.next_step(i_left)
    val new_right = right.next_step(i_right)
    new DoubleUniqueStep2(new_left, new_right)
  }
}

class DoubleUniqueStep2(left:UniqueStep2, right:UniqueStep2) extends UniqueStep2 
```

解释：

`StandardStep1`表示某个状态机中的一个步骤，并且有一个针对给定输入`next_step`给出 a 的操作。`StandardStep2`

`UniqueStep1`是一种特殊类型，当它被调用时会`StandardStep1`给出一个- 显然必须从中继承。`UniqueStep2``next_step``UniqueStep2``StandardStep2`

现在我必须编写一个*DoubleStep*包装器：`DoubleStandardStep1`包装太`StandardStep1`s，并在调用`DoubleStandardStep2`它时返回 a `next_step`。 `DoubleUniqueStep1`做同样的事情，但它返回一个`DoubleUniqueStep2`.

*DoubleStep*s' 的实现`next_step`有一个明显的代码重复：它们都将输入拆分为`i_left`并以相同的方式`i_right`调用它们的包装步骤。`next_step`

*我想知道如何通过创建一个通用抽象DoubleStep1*来完成这部分代码，从而消除这种代码重复：

```
object DoubleStepHelper {
  def next_step_args[IL,IR,SL <: StandardStep1[IL],SR <: StandardStep1[IR]](left:SL,right:SR)(i:(IL,IR)) = { 
    val (i_left, i_right) = i
    val new_left = left.next_step(i_left)
    val new_right = right.next_step(i_right)
    (new_left, new_right)
  }
}

class DoubleStandardStep1[-IL,-IR](left:StandardStep1[IL], right:StandardStep1[IR]) extends StandardStep1[(IL,IR)] {
  def next_step(i:(IL,IR)) = {
    ((l,r) => new DoubleStandardStep2(l,r)).tupled(DoubleStepHelper.next_step_args(left,right)(i))
  }
}

class DoubleStandardStep2(left:StandardStep2, right:StandardStep2) extends StandardStep2

class DoubleUniqueStep1[-IL,-IR](left:UniqueStep1[IL], right:UniqueStep1[IR]) extends UniqueStep1[(IL,IR)] {
  def next_step(i:(IL,IR)) = {
    ((l,r) => new DoubleUniqueStep2(l,r)).tupled(DoubleStepHelper.next_step_args(left,right)(i))
  }
}

class DoubleUniqueStep2(left:UniqueStep2, right:UniqueStep2) extends UniqueStep2 
```

尝试编译此代码（scala 2.9.2）失败并显示以下消息：

```
类型不匹配;
 找到：（this.StandardStep2，this.StandardStep2）
 必需：（this.UniqueStep2，this.UniqueStep2）
    ((l,r) => new DoubleUniqueStep2(l,r)).tupled(DoubleStepHelper.next_step_args(left,right)(i))
                                                                                            ^

```

我假设发生这种情况是因为`DoubleStepHelper.next_step_args`假设返回一个`(StandardStep2, StandardStep2)`值，当我们想用**`DoubleUniqueStep2`**.

你能想出解决这个问题的方法吗？如何告诉编译器`DoubleStepHelper`next_step_args 可能返回一个`(UniqueStep2, UniqueStep2)`if`SL`并`SR`继承自`UniqueStep1`？

一个不错的功能可能是能够将结果类型定义为*(SL.next_step, SR.next_step)*`next_step_args`之类的东西，这意味着它的返回类型是根据 和 中特定函数 ( *next_step* )的返回类型构建的。**`SL``SR`**

 **“视图”边界可以以任何方式解决它吗？

我可以使用*asInstanceOf*强制转换，但这看起来很难看。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T01:29:43.007

我找到了一个不错的解决方案。我创建`AbstractStep1`并`AbstractDoubleStep1`在其中将以下步骤的类型作为类型参数给出。

然后我可以从这个类继承下一步是`StandardStep2`or的情况`UniqueStep2`。

所以这里是代码：

```
trait AbstractStep1[-I,+S2] {
  def next_step(i:I):S2
}

trait StandardStep1[-I] extends AbstractStep1[I,StandardStep2]

trait StandardStep2

trait UniqueStep1[-I] extends AbstractStep1[I,UniqueStep2] with StandardStep1[I]

trait UniqueStep2 extends StandardStep2

abstract class AbstractDoubleStep1[-IL,-IR,-S2L <: StandardStep2,-S2R <: StandardStep2,+S2](left:AbstractStep1[IL,S2L],right:AbstractStep1[IR,S2R]) extends AbstractStep1[(IL,IR),S2] {
  def wrapper(l:S2L,r:S2R):S2

  def next_step(i:(IL,IR)):S2 = {
    val (i_left, i_right) = i
    val new_left = left.next_step(i_left)
    val new_right = right.next_step(i_right)
    wrapper(new_left, new_right)
  }
}

class DoubleStandardStep1[-IL,-IR](left:StandardStep1[IL], right:StandardStep1[IR]) extends AbstractDoubleStep1[IL,IR,StandardStep2,StandardStep2,DoubleStandardStep2](left,right) {
  def wrapper(l:StandardStep2,r:StandardStep2) = {
    new DoubleStandardStep2(l,r)
  }
}

class DoubleStandardStep2(left:StandardStep2, right:StandardStep2) extends StandardStep2

class DoubleUniqueStep1[-IL,-IR](left:UniqueStep1[IL], right:UniqueStep1[IR]) extends AbstractDoubleStep1[IL,IR,UniqueStep2,UniqueStep2,DoubleUniqueStep2](left,right) {
  def wrapper(l:UniqueStep2,r:UniqueStep2) = {
    new DoubleUniqueStep2(l,r)
  }
}

class DoubleUniqueStep2(left:UniqueStep2, right:UniqueStep2) extends UniqueStep2 
```

我认为也可以转换`AbstractDoubleStep1`为*triat*而不是*abstract class*，这将使其在 mixin 继承中更有用，但这对我来说目前并不重要。**

# python - 在主目录中安装 cheetah

> ID：12734598
> 
> 赞同：1
> 
> 时间：2012-10-04T19:36:32.743
> 
> 标签：python, templates, cheetah

我正在尝试在我的主目录中安装 Cheetah 模板引擎。我有一个学校网站帐户，但没有 root 访问权限。我将我的 python 路径更改为我正在安装的目录，但它试图将 cheetah-compile 放在 /usr/bin 中，我当然没有权限。我怎样才能解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-05T01:50:22.053

Cheetah 使用[distutils](http://docs.python.org/install/index.html)进行安装，所以这实际上是一个非常简单的问题。从猎豹官网下载后，解压，进入生成目录，使用

```
python setup.py install --user 
```

这将安装在您具有写入权限的用户站点包目录中。确切的位置取决于您的平台，但观察输出，它会告诉您。

另一个不错的副作用是用户站点包将在您的 sys.path 中，因此 Python 将能够找到它。

# css - IE 中的 DNS 移动和混乱的 CSS

> ID：12734607
> 
> 赞同：0
> 
> 时间：2012-10-04T19:37:02.963
> 
> 标签：css

所以，在我将 DNS 迁移到 godaddy 之前，这个站点在 Internet Explorer 中运行良好。这里是网站.. [http://csdassociates.com/](http://csdassociates.com/) ...关于为什么这将不再正确对齐的任何建议？

当您将 DNS 移动到文件时会发生什么，我无法理解。两周前我的这个工作还不错，并在那里测试了所有的 CSS，看起来还不错。现在，突然之间，它好像没有阅读我的任何 CSS，但我可以看到它正在阅读它。这部分没有真正的大错误。我的 CSS 这么糟糕吗？它在 IE 中不起作用？

是我为 IE 创建新样式表的唯一解决方案吗……或者我可以在我当前的 CSS 中添加一些修饰吗？如果您在 Chrome 上检查它，它可以正常运行。这可能是我的 Jquery 的问题吗？如果您发现这个问题不好，请随时投反对票，我很绝望，正在寻找想要帮助我的人。

我的 jsFiddle：http: [//jsfiddle.net/kA9Tt/](http://jsfiddle.net/kA9Tt/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:43:00.463

DNS 更改对任何特定文件都没有影响。由于您的页面加载正常，因此您的 DNS 设置正确。

如果您的页面在我的浏览器 (Firefox) 上加载正常。你用的是哪个版本的IE？

顺便说一句，在 JSFiddle 中粘贴代码时不要使用相对路径`css/960.css`，除非您设置了基本 href

```
<base href="http://csdassociates.com/"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:43:39.863

当您需要严格时，DOCTYPE 是过渡的。这意味着 IE 默认处于 Quirks 模式。用这个：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"> 
```

# android - 不使用 Fragment 时从 MainActivity 调用 ListFragment 函数

> ID：12734609
> 
> 赞同：1
> 
> 时间：2012-10-04T19:37:06.957
> 
> 标签：android, android-fragments, android-activity, android-listfragment

我不确定这个标题是否有意义，很难解释我想要什么，但我会试一试。

我必须分段，ListFragment 和 MyFragment。如果设备是纵向的，即两个片段不能一起显示在屏幕上，则只显示 LisFragment。我有一个名为 MyActivity 的活动，它托管片段并显示相关设备方向的相关片段。

然后，用户可以按下按钮以使用 startActivityForResult 执行搜索，然后调用 MyActivity 中的函数以实际执行所需的操作。

如果手机处于横向状态，即两个片段都可见，则它成功地从 PasswordList 片段中调用该函数。但是，如果手机是纵向的，则 ListFragment 为空，因此不会调用该函数。下面是我遇到问题的代码

```
public void performSearch(ArrayList<Spanned> passwords) {
    PasswordList passwordList = (PasswordList)getFragmentManager().findFragmentById(R.id.passwordListFragment);
    passwordList.performingSearch = true;
    passwordList.performSearch(passwords);
} 
```

PasswordList 是我上面所说的 ListFragment，当手机处于横向时 passwordList 工作并且我可以执行 performSearch 功能。如果手机是纵向的，即使 ListFragment 正在显示，它也会返回 Null，因此无法执行 performSearch。

如何以任何一种方式执行 performSearch 功能。感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T20:15:11.107

自从我做 Android 以来已经有一段时间了，但我相信由于片段实际上没有显示，在你的情况下，它现在不存在。我相信每次切换方向时，都会重新绘制视图等。

这个函数在另一个片段中，无论如何你可以将它提取到另一个类中吗？在我之前的一个 android 项目中，我使用了两个片段，但对于手机/小型设备，我只是将它转发到托管第二个片段的 FragmentActivity（我使用了兼容库）。在表格版本中，第二个片段被显示。

它不是超级优雅，而且有些陈旧，但我的项目是开源的，如果你想看看的话，请访问 www.github.com/zerkz。

# visual-studio-2012 - 如何能够（从代码）覆盖 Visual Studio 2012 中的窗口标题？

> ID：12734610
> 
> 赞同：1
> 
> 时间：2012-10-04T19:37:06.980
> 
> 标签：visual-studio-2012, add-in

我编写了一个用于 vs 2005、2008 和 2010 的加载项，在其中我根据一些环境信息（和其他内容）设置标题。我基本上是通过 SetWindowsHookEx 拦截 WM_SETTEXT 消息，并在“主窗口”（当 alt-tabbing 或悬停在任务栏上时修复文本）和使用类名的“编辑器窗口”上使用 SetWindowText IDEOwner”（这修复了实际 Visual Studio 窗口的标题）

但是在 vs 2012 中没有“IDEOwner”，这意味着这种方式不能用于设置“编辑器窗口”的标题（“主窗口”仍然有效。

如果有人知道我如何访问和覆盖这个编辑器窗口标题，我会很高兴。

谢谢，

亨里克

# backbone.js - ExpressJs 和 BackboneJs 模板

> ID：12734611
> 
> 赞同：0
> 
> 时间：2012-10-04T19:37:07.723
> 
> 标签：backbone.js, express

现在在我的应用程序的索引页面上，我正在添加我需要的所有模板文件：

```
<script id="example" type="text/template">
// Bunch of Awesome Code
</script> 
```

现在这工作正常，但是在一个文件中处理所有这些模板文件开始变得很痛苦。有没有办法将这些文件放在许多文件中，然后在构建时将它们连接在一起？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:54:57.493

[在http://blog.millermedeiros.com/node-js-as-a-build-script/](http://blog.millermedeiros.com/node-js-as-a-build-script/)上有一篇不错的文章，解释了如何使用 node.js 创建一个构建脚本来整合和缩小文件。

# django - Django 调度程序的问题

> ID：12734615
> 
> 赞同：1
> 
> 时间：2012-10-04T19:37:36.337
> 
> 标签：django, dispatcher

我在 URL 调度方面遇到了一些问题。这是我的规则：

```
urlpatterns += patterns('proxy.views',
    (r'^$', 'proxyviews.index'),
    (r'^go/(?P<url>\S+)', 'proxyviews.go'),
    (r'^proxy/(\S+)$', 'proxyviews.proxy'),
) 
```

如果我给它下一个 URL：“http://myproxy.com/go/http://foo.bar”，它将是“http://myproxy.com/go/http:/foo.bar”——在“go/http:”之后加一个斜线。我不确定这里有什么问题。你有什么想法？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:46:29.450

实际上，在您的网址中，您提供的是原始字符串，因此“\”仅表示“\”。为了更好地工作，请使用[url encode](http://meyerweb.com/eric/tools/dencoder/)。

例如，而不是

> [http://myproxy.com/go/http://foo.bar](http://myproxy.com/go/http://foo.bar)

你应该给 url 作为

> [http://myproxy.com/go/http%3A%2F%2Ffoo.bar](http://myproxy.com/go/http%3A%2F%2Ffoo.bar)

此外，您还应该编码“％”，这样更好

> [http://myproxy.com/go/http%253A%252F%252Ffoo.bar](http://myproxy.com/go/http%253A%252F%252Ffoo.bar)

谢谢

# android - 如何导出使用调试证书签名的 apk？

> ID：12734619
> 
> 赞同：6
> 
> 时间：2012-10-04T19:38:00.800
> 
> 标签：android, eclipse, apk

Eclipse 中的 Android 工具菜单只允许我导出未签名的 apk，或使用我的发行证书签名的 apk。我需要 Eclipse 在调试我的 Android 应用程序时创建的 debug-certificate-signed apk。

它在哪里？

提前致谢...

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-04T19:40:10.517

已编译的 APK（带有调试密钥）位于 Eclipse 项目的 /bin 文件夹中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:50:42.627

我在 SDK 文档中找到了完整的详细信息（包括密码）：http: [//developer.android.com/tools/publishing/app-signing.html#debugmode](http://developer.android.com/tools/publishing/app-signing.html#debugmode)

# nosql - 您如何指定行或文档 ID Riak 或任何键值数据存储？

> ID：12734629
> 
> 赞同：0
> 
> 时间：2012-10-04T19:38:54.847
> 
> 标签：nosql, riak, rowid, unique-id

我刚刚参加了关于 Riak 简介的网络研讨会。它并没有说太多关于架构设计的内容，只是一页。这就是我所关注的。所以让我问一个问题。

假设我们有一个名为 Customer 的存储桶，其客户编号为：“123”。该客户具有以下属性（键：值对）：姓名：“Joey Brown”，出生日期：“1980 年 1 月 1 日”，邮政编码：“12345”，客户类型：“零售” 成为客户的日期：“1 /1/2005”购买频率：“5”</p>

JSON 可以是：

{ “姓名”：“Gunther Boss”，“出生日期”：“1980 年 1 月 1 日”，“邮政编码”：“12345”，“客户类型”：“零售”“成为客户的日期”：“1/ 1/2005”，“购买频率”：“5”</p>

}

Riak 怎么知道这些属性都属于 Customer 123？那个客户编号是 ID？我们如何为整行指定 id？

Cassandra 使用以下内容：

RowId + 列族 + 列限定符 + 时间戳 + 值（或有效负载）。（RowId + Column Family + Column Qualifier + Timestamp 提供唯一性）。关键是 Column family + Column Qualifier

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T20:07:09.953

Riak 是一个键值存储，没有列的概念。它只存储由单个键标识的二进制数据（自然可以是字符串或 JSON 文档以及其他内容）。

在此示例中，您可能会将客户数据作为 JSON 文档存储在键“123”下，即客户编号。

# android - Android 4.0.4 WebView 中的 HTML 文件在服务器上修改时不会更改

> ID：12734633
> 
> 赞同：0
> 
> 时间：2012-10-04T19:39:25.857
> 
> 标签：android, html, webview

在服务器上修改 html 文件时，所做的更改会显示在 Android 版本 2.2 和 Android 版本 2.3.3 中，但不会显示在 Android 版本 4.0.4 中。例如，显示旧文本而不是新文本。

我的代码是：

```
public class MywebviewActivity extends Activity {

public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);

this.getWindow().requestFeature(Window.FEATURE_PROGRESS);
setContentView(R.layout.mywebview);
final Activity MywebviewActivity = this;        
  // Makes Progress bar Visible
  getWindow().setFeatureInt(Window.FEATURE_PROGRESS, Window.PROGRESS_VISIBILITY_ON);
  android.webkit.WebView wv = 
  (android.webkit.WebView)this.findViewById(R.id.myWebView); 
  wv.setWebChromeClient(new WebChromeClient() {     
  public void onProgressChanged(WebView view, int progress)   
  {
   //Make the bar disappear after URL is loaded, and changes string to Loading...
      MywebviewActivity.setTitle("Loading...");
      MywebviewActivity.setProgress(progress * 100); //Make the bar disappear after URL      is loaded

  // Return the app name after finish loading
  if(progress == 100)
      MywebviewActivity.setTitle(R.string.web_app_name);
    }
  });

  wv.setScrollBarStyle(View.SCROLLBARS_INSIDE_OVERLAY);
  wv.getSettings().setJavaScriptEnabled(true);
  wv.setHorizontalScrollBarEnabled(false);
  wv.loadUrl("http://mypagename.com/android/server/app/ver10/page1.html");

}

public void onBackPressed() {
android.os.Process.killProcess(android.os.Process.myPid());
return;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:59:38.383

在加载 WebView 之前尝试清除缓存：

```
...
android.webkit.WebView wv = (android.webkit.WebView)this.findViewById(R.id.myWebView);
wv.clearCache(true);
wv.setWebChromeClient(new WebChromeClient() {
... 
```

[http://developer.android.com/reference/android/webkit/WebView.html#clearCache(boolean](http://developer.android.com/reference/android/webkit/WebView.html#clearCache(boolean) )

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T20:13:36.233

尝试在`WebViewSettings`不缓存数据中设置一个属性：

```
wv.getSettings().setCacheMode(WebSettings.LOAD_NO_CACHE); 
```

# iphone - Facebook 好友选择器未在 SDK 3.1 中选择好友

> ID：12734635
> 
> 赞同：-1
> 
> 时间：2012-10-04T19:39:32.140
> 
> 标签：iphone, objective-c, ios, facebook

我正在创建一个想要列出 facebook 朋友的应用程序。为此，我做了以下事情。

```
- (void)viewDidLoad
{        
    arrayFriends=[[NSMutableArray alloc]init];
    [super viewDidLoad];
    if (!FBSession.activeSession.isOpen) {
        // if the session is closed, then we open it here, and establish a handler for state changes
        [FBSession.activeSession openWithCompletionHandler:^(FBSession *session,
                                                             FBSessionState state,
                                                             NSError *error) {
            switch (state) {
                case FBSessionStateClosedLoginFailed:
                {
                    UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:@"Error"
                                                                        message:error.localizedDescription
                                                                       delegate:nil
                                                              cancelButtonTitle:@"OK"
                                                              otherButtonTitles:nil];
                    [alertView show];
                }
                    break;
                default:
                    break;
            }
        }];
    }       
}

-(void)viewWillAppear:(BOOL)animated
{
    if (self.friendPickerController == nil) {
        // Create friend picker, and get data loaded into it.
        self.friendPickerController = [[FBFriendPickerViewController alloc] init];
        self.friendPickerController.title = @"Pick Friends";
        self.friendPickerController.delegate = self;
    }

    [self.friendPickerController loadData];
    [self.friendPickerController clearSelection];
    [self.friendPickerController.view setFrame:CGRectMake(0, 77, 320, 383)];
    [self.view addSubview:self.friendPickerController.view];
    // iOS 5.0+ apps should use [UIViewController presentViewController:animated:completion:]

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-05T06:28:08.553

![带有朋友列表的视图控制器](../Images/6665b7ad53a8a37db3ec5e136a024188.png) 您可以获得像这张图片一样的朋友列表，您需要在 viewWillAppear:method 中添加以下代码

```
 if (self.friendPickerController == nil) {
    // Create friend picker, and get data loaded into it.
    self.friendPickerController = [[FBFriendPickerViewController alloc] init];
    self.friendPickerController.title = @"Pick Friends";
    self.friendPickerController.delegate = self;
}

[self.friendPickerController loadData];
[self.friendPickerController clearSelection];

[self presentModalViewController:self.friendPickerController animated:YES]; 
```

对于完成和取消按钮操作，我们应该分别调用以下方法，

```
- (void)facebookViewControllerDoneWasPressed:(id)sender{
  //code goes here
}
- (void)facebookViewControllerCancelWasPressed:(id)sender{
 [self dismissModalViewControllerAnimated:YES];
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-12-14T06:01:23.580

您需要考虑的几件事在 iSpark 用作源材料的教程中没有解释（他们的 2013 年评论者之一可能希望他们知道）：

1.  出现在朋友选择器中的用户只是自己安装了应用程序的用户。这是较新的，可能在原始帖子发布时不适用。
2.  您需要用户的 user_friends 权限才能查看任何朋友。

更多内容：[Facebook iOS 选择好友表空白](https://stackoverflow.com/questions/15314154/facebook-ios-select-friends-table-blank)

# objective-c - iOS6 和 UITableView 中的屏幕外 UITextView

> ID：12734638
> 
> 赞同：3
> 
> 时间：2012-10-04T19:39:33.990
> 
> 标签：objective-c, ios, uitextfield, uitableview, ios6

我有一个 UITableViewController，每个单元格中都有一个 UITextField。当用户在一个字段中点击返回时，它会自动将下一个字段设置为第一响应者并滚动表格以显示该字段，如下所示：

```
- (BOOL) textFieldShouldReturn:(UITextField *)textField 
{  
    UITextField *nextTextField=nil;
    NSInteger row;
    NSInteger section;

    if(textField == self.txtFieldA) 
    {
        nextTextField = self.txtFieldB;
        row=1; section=0;
    }
    else if(textField == self.txtFieldB) 
    {
        nextTextField = self.txtFieldC;
        row=2; section=0;
    }
    else 
    {
        [textField resignFirstResponder];
    }

    if(nextTextField) 
    {        
        NSIndexPath *indexPath = [NSIndexPath indexPathForRow:row inSection:section];
        [nextTextField becomeFirstResponder];

        [self.tableView scrollToRowAtIndexPath:indexPath atScrollPosition:UITableViewScrollPositionBottom animated:YES];      
    }
} 
```

当您选择一个文本字段（例如 txtFieldA），向下滚动表格以使 txtFieldB 不可见，然后按 Enter 键时，问题就出现了。它在 iOS5 上按预期工作（txtFieldB 成为新的第一响应者）。但是，在 iOS6 上却没有。它滚动到表格中的正确位置，但 txtFieldB 并没有成为第一响应者（我不确定是什么——当我在导航控制器上点击“返回”时，键盘仍然可见）。

当我点击“返回”时，不会触发 txtFieldB 的 didBeginEditing。如果我延迟`[nextTextField becomeFirstResponder]`一秒钟左右（直到滚动动画完成，这使得 nextTextField 可见）它按预期工作，但这样做似乎很笨拙且不太顺利，所以我宁愿了解出了什么问题，也不愿实现类似的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T12:39:43.233

在我对这个问题的解决方案中，我将 UITableViewCell 子类化为一个文本字段单元格。在该文本字段单元格中，我覆盖了`-setSelected:animated:`.

```
- (void)setSelected:(BOOL)selected animated:(BOOL)animated
{
    [super setSelected:selected animated:animated];

    if (selected) {
        [self.textField becomeFirstResponder];
    }
} 
```

回到我的视图控制器，当我想前进到下一个字段时，我只需选择它所在的行。

```
- (IBAction)advanceToNextTextField
{
    NSIndexPath *indexPath = [self nextIndexPathFromIndexPath:self.indexPathOfActiveField];

    [self.tableView selectRowAtIndexPath:indexPath
                                animated:YES scrollPosition:UITableViewScrollPositionNone];
    [self.tableView scrollToRowAtIndexPath:indexPath
                          atScrollPosition:UITableViewScrollPositionNone animated:YES];
} 
```

这使得处理返回键变得容易。

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField
{
    switch (textField.returnKeyType) {
        case UIReturnKeyNext: [self advanceToNextTextField]; break;
        case UIReturnKeyDone: [self resignFirstResponder]; break;
        default:              break;
    }

    return YES;
} 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-21T18:08:18.173

在我的同事 Charles 的帮助下，找到了解决这个问题的方法（谢谢！）。我还尝试了 Jeffrey Thomas 的解决方案（及其变体），但没有成功：如果其表格单元格不在屏幕上，则文本字段不会成为第一响应者，正如 Ogel 所描述的那样。我寻找的`UITableViewDelegate`方法可以提醒我何时完成 tableview 动画并延迟调用文本字段的`setSelected:`方法，直到那时，没有运气。然后他指给我看

```
- (void)scrollViewDidEndScrollingAnimation:(UIScrollView *)scrollView 
```

当它完成滚动以响应表格视图方法时，它也由表格视图触发（`UITableViewDelegate`符合）`UIScrollViewDelegate`

```
- (void)scrollToRowAtIndexPath:(NSIndexPath *)indexPath atScrollPosition:(UITableViewScrollPosition)scrollPosition animated:(BOOL)animated 
```

因此，关键是计算您打算在下一个/上一个方法中选择的行的索引路径（就像在 Jeffrey Thomas 的`- (IBAction)advanceToNextTextField`方法中一样），但不要选择它，只需滚动到它，并为其设置一个 ivar：

```
[_table scrollToRowAtIndexPath:nextIndexPath atScrollPosition:UITableViewScrollPositionMiddle animated:YES];
_selectIndexPathOnAnimationEnd = nextIndexPath; 
```

然后在滚动视图委托方法中，在表格视图完成滚动到该索引路径后选择该行：

```
- (void)scrollViewDidEndScrollingAnimation:(UIScrollView *)scrollView {
    if(_selectIndexPathOnAnimationEnd != nil) {
        [_table selectRowAtIndexPath:_selectIndexPathOnAnimationEnd animated:NO scrollPosition:UITableViewScrollPositionMiddle];
        _selectIndexPathOnAnimationEnd = nil;
    }
} 
```

此时文本字段可以成为第一响应者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T23:16:17.710

我还有一个在 iOS 6 之前运行良好的现有项目。我的通用应用程序使用 a`UITableView`在键盘工具栏上创建一个带有“下一个”和“上一个”按钮的表单（类似于 Safari）。`UITableViewCell`该表显示包含文本字段的子类的实例。下一个/上一个功能也包含 - 所以最后一个字段的“下一个”将焦点返回到表单的顶部。

不幸的是，Jeffrey Thomas 的解决方案并不适合我。如果一个单元格不在屏幕上，则提前选择和滚动方法ToNextField 方法适用于单元格本身。在该`setSelected`方法中，文本字段的视图层次结构是正确的：`UITextField`-> `UITableViewCellContentView`-> `UITableViewCell`subclass -> `UITableView`。

但是，**`becomeFirstResponder`**调用仍然无法激活字段的编辑模式、 fire`textFieldDidBeginEditing`等。键盘仍然可见，但不影响现在可见的单元格。

目前，我能够绕过这个问题的唯一方法是先**滚动而不使用动画**：

```
[self.tableView scrollToRowAtIndexPath:indexPath atScrollPosition:UITableViewScrollPositionNone animated:NO];
[self.tableView selectRowAtIndexPath:indexPath animated:YES scrollPosition:UITableViewScrollPositionNone]; 
```

就像 Ned 在操作中的延迟技术一样，这确保了当应用程序要求它响应时文本字段是可见的。否则，它似乎`becomeFirstResponder`在动画期间和文本字段（完全）可见之前触发。显然，iOS 6 中的一些变化对第一响应者消息和可见性更加严格！

可悲的是，当从一个场地移动到另一个场地时，这会失去漂亮的流畅动画。假设这不仅仅是 iOS 6.0 中的一个错误，我计划在`UITableView`未来不再用作表单。

# c# - 在关闭程序时提示用户保存之间减少代码重复的优雅方法？

> ID：12734642
> 
> 赞同：1
> 
> 时间：2012-10-04T19:40:03.637
> 
> 标签：c#, refactoring, code-duplication

退出程序时，如果程序员处理`FormClosing`事件，如果有未保存的数据，程序员可以提示保存对话框，询问他们是否要保存、不保存或取消操作。

如果在 FormClosing 事件中命中`Cancel`，则取消你设置的操作`e.Cancel = true;`。这可以。但是，在菜单中，如果用户点击`Exit`按钮，那么应该会发生同样的事情，`e.Cancel = true;`只是不应该这样做，`return;`因为它处理的是菜单项`Click`事件而不是`FormClosing`事件。

现在我几乎已经复制了代码，并且想知道是否有一种方法可以处理这个问题，以避免以一种优雅且易于理解的方式重复。

```
private void FrmEditorFormClosing(object sender, FormClosingEventArgs e)
{
    if (NeedsToSave)
    {
        DialogResult saveChangesDialog = 
MessageBox.Show("There are unsaved changes. Save now?", 
"Xml Editor", MessageBoxButtons.YesNoCancel, MessageBoxIcon.Question);

        if (saveChangesDialog == DialogResult.Yes)
        {
            Save();
        }
        else if (saveChangesDialog == DialogResult.Cancel)
        {
            e.Cancel = true; // Only difference
        }
    }
}

private void ExitToolStripMenuItemClick(object sender, EventArgs e)
{
    if (NeedsToSave)
    {
        DialogResult saveChangesDialog = 
MessageBox.Show("There are unsaved changes. Save now?", 
"Xml Editor", MessageBoxButtons.YesNoCancel, MessageBoxIcon.Question);

        if (saveChangesDialog == DialogResult.Yes)
        {
            Save();
        }
        else if (saveChangesDialog == DialogResult.Cancel)
        {
            return; // Only difference
        }
    }

    Close();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T19:52:38.580

你不应该这样做。在您的菜单单击处理程序中调用 Close 应该会触发 FormClosing 事件，您可以在那里取消它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T19:43:04.313

将通用代码放在返回*布尔值*的方法中，以指示是否发生了保存

```
private bool PromptSave()
{
    if (NeedsToSave)
    {
        DialogResult saveChangesDialog = 
            MessageBox.Show("There are unsaved changes. Save now?", "Xml Editor",
            MessageBoxButtons.YesNoCancel, MessageBoxIcon.Question);

        if (saveChangesDialog == DialogResult.Yes)
        {
            Save();
            return true;
        }
        else if (saveChangesDialog == DialogResult.Cancel)
        {
            return false;
        }
    }
    else
    {
        return false;
    }
} 
```

使用该返回值设置*e.Cancel*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T19:43:24.977

将其分成一个返回布尔值的不同函数。像这样的东西：

```
bool ConfirmSave()
{
    if (NeedsToSave)
    {
        DialogResult saveChangesDialog = MessageBox.Show("There are unsaved changes. Save now?", "Xml Editor",
                                                            MessageBoxButtons.YesNoCancel, MessageBoxIcon.Question);

        if (saveChangesDialog == DialogResult.Yes)
        {
            Save();
            return true;
        }
        else if (saveChangesDialog == DialogResult.Cancel)
        {
            return false; 
        }
    }
} 
```

可以从发生关闭事件的任何地方调用此函数，并且您可以相应地处理结果。

```
private void FrmEditorFormClosing(object sender, FormClosingEventArgs e)
{
    if(!ConfirmSave())
    {
        e.Cancel = true;
    }   
}

private void ExitToolStripMenuItemClick(object sender, EventArgs e)
{
    ConfirmSave();

    Close();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T19:53:07.283

这应该非常接近

```
private void ExitToolStripMenuItemClick(object sender, EventArgs e)
{
  if (DoSaveOnExit())
    Save();
  else
    return;
}  

private void FrmEditorFormClosing(object sender, FormClosingEventArgs e)
{
   if (DoSaveOnExit())
    Save();
   else
    e.Cancel = true;             
}
private bool DoSaveOnExit()
{
  if (NeedsToSave)
  {
     DialogResult saveChangesDialog = MessageBox.Show("T", "Xml Editor",
     MessageBoxButtons.YesNoCancel, MessageBoxIcon.Question);

    if (saveChangesDialog == DialogResult.Yes)
    {
        return true;
    }
    else if (saveChangesDialog == DialogResult.Cancel)
    {
        return false;
    }

} 
```

# php - 仅更新提供的字段

> ID：12734646
> 
> 赞同：0
> 
> 时间：2012-10-04T19:40:31.467
> 
> 标签：php, mysql

我有这个：

```
if(isset($_POST["Submit"])) {
$updatequery = @mysql_query("UPDATE users SET FirstName='".$_POST['firstname']."', LastName='".$_POST['lastname']."', Address='".$_POST['address']."', City='".$_POST['city']."', PostalCode='".$_POST['postalcode']."', HomePhone='".$_POST['homephone']."', AltPhone='".$_POST['altphone']."', HomeWebsite='".$_POST['homewebsite']."', EmailAddress='".$_POST['email']."', Paypal='".$_POST['paypal']."', Alertpay='".$_POST['alertpay']."', Payoneer='".$_POST['payoneer']."' WHERE Username = '".$_SESSION['Username']."'");</i> 
```

现在不幸的是，当用户更新他们的信息（这是一个个人资料页面）时，它会更新所有内容，这意味着如果我将 Paypal 电子邮件留空（因为我已经在那里），它会更新 Paypal 电子邮件为空。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:43:44.027

循环遍历字段，动态构建`UPDATE`语句。

注意用户*擦除*值的极端情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:47:56.890

```
$sql = '';
if( !empty($_POST['email']) )  //if value is not empty, then update        
      $sql = ", EmailAddress = '{$_POST['email']}'"; 
```

然后在查询中，

```
 if(isset($_POST["Submit"])) {
 $updatequery = @mysql_query("UPDATE users SET FirstName='".$_POST['firstname']."',     LastName='".$_POST['lastname']."', Address='".$_POST['address']."', City='".$_POST['city']."', PostalCode='".$_POST['postalcode']."', HomePhone='".$_POST['homephone']."', AltPhone='".$_POST['altphone']."', HomeWebsite='".$_POST['homewebsite']."' $sql , ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T19:48:34.220

就像 marc_b 说的：提防 SQL 注入攻击。然后你可以做这样的事情：

```
UPDATE users 
SET FirstName = case when '$firstname' = '' then FirstName else '$firstname' end, 
    LastName = ...
WHERE Username = $username 
```

避免用空值覆盖值

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T20:22:43.053

请注意，**这是一个非常基本的示例，我不建议在实时环境中使用**它，但它应该让您朝着正确的方向前进：-

首先，创建一个将列名映射到`$_POST`变量的数组，例如：

```
$array = array(
  'FirstName' => 'firstname',
  'LastName' => 'lastname',
  'Address' => 'address',
  'City' => 'city'
); 
```

接下来，遍历您新创建`$array`的并检查该值是否存在于您的`$_POST`数组中，如下所示：

```
 $data = array();
  foreach ($array as $key => $value) {
    if (isset($_POST[$value]) && !empty($_POST[$value]) {
      $data[] = $key . '="' . mysql_real_escape_string($_POST[$value]) . '"';
    }
  } 
```

注意`$data`已经创建的数组，它存储`column = "value"`数据。然后，您可以将`$data`数组内爆到您的 SQL 字符串中：

```
if (!empty($data)) {
  $strSQL = 'UPDATE tbl_name SET ' . implode(', ', $data) . ' WHERE Username = "' . $_SESSION['Username'] . '"';
} 
```

哪个会输出（带有一些虚构的`$_POST`数据）：

```
UPDATE tbl_name SET FirstName="John", LastName="Doe", Address="Some Street", City="Somewhere" 
```

**重申一下，我不建议您按原样使用此代码。您必须事先验证和清理用户输入！**

# ajax - 使用别名时，Chrome 中的会话已过期或失效

> ID：12734650
> 
> 赞同：1
> 
> 时间：2012-10-04T19:40:54.963
> 
> 标签：ajax, google-chrome, session, icefaces

我有一个使用部署在 WebSphere 6 上的 IceFaces 1.8.2 构建的 Web 应用程序。

1.  当我尝试使用服务器 IP 地址或主机名（例如通过调用 10.250.46.80:8080/myApplication 或 host.domain.com:8080/myApplication）访问它时，一切正常。
2.  当我尝试通过别名（例如 www.myapplication.com）访问它时，应用程序加载欢迎页面，毫无问题地重定向到 jspx 页面，但是我看到它继续加载一些东西几秒钟，然后我收到一个 http 错误 500 说：

```
Error Message: javax.faces.FacesException: javax.faces.FacesException: Problem in renderResponse: User session has expired or it was invalidated.
Error Code: 500
Target Servlet: Persistent Faces Servlet
Error Stack:
java.lang.Exception: javax.faces.FacesException: javax.faces.FacesException: Problem in renderResponse: User session has expired or it was invalidated.
     at com.icesoft.faces.context.View.servePage(View.java:153)
     at com.icesoft.faces.webapp.http.core.SingleViewServer.service(SingleViewServer.java:52)
...
...
     at com.icesoft.faces.context.View$2$1.respond(View.java:49)
     at com.icesoft.faces.webapp.http.servlet.ServletRequestResponse.respondWith(ServletRequestResponse.java:201)
     at com.icesoft.faces.context.View$2.serve(View.java:78)
     at com.icesoft.faces.context.View.servePage(View.java:150)
     ... 44 more 
```

我尝试打开同步更新，应用程序不再崩溃，但我注意到 Ajax 功能都没有像 ValueChange 侦听器那样工作。当我更改下拉列表中的值（部分提交）时，浏览器开始加载某些内容，然后我再次收到错误 500。

仅当使用 Google Chrome 作为浏览器时才会发生这种情况。它不会发生在 IE、Opera、Firefox 或 Safari 中。

我尝试在 Chrome 控制台中手动调用发送接收更新的 Ajax 请求，但响应是 <session-expired/> 在 Firefox 中我得到了正常内容。

我尝试了一些随机的东西，比如对齐标题，但由于 Chrome 阻止修改大多数标题，我无法真正尝试将它们与 Firefox 的标题对齐来测试它。

有人经历过类似的事情吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-30T11:26:22.170

使用别名时（我不知道确切的命名：url 重写/转发？​​虚拟主机/代理传递？）会导致转发/重定向，请确保浏览器默认情况下不会在您的页面中插入包含别名的内容，或者您可能会陷入无限循环。

我的情况的解决方案是我插入了自己的网站图标图像，因此 Chrome 不会插入默认图像。

# c# - 第一次构建 ViewModel

> ID：12734653
> 
> 赞同：1
> 
> 时间：2012-10-04T19:41:03.417
> 
> 标签：c#, xaml, mvvm

我正在尝试为我正在处理的程序找出 ViewModel。我以前没有这样做过。`Switch`这是需要的对象的部分类定义`ViewModel`和我目前拥有的 XAML。我知道 XAML 需要更多。

现在我正在做代码隐藏，在`SwitchBrowser`打开窗口之前用数据填充窗口。我知道将 an 绑定`ObservableCollection`到 XAML 会更容易。

我可以将对象存储在一个`CiscoSwitch`对象中`ObservableCollection`并直接绑定到`Switch`对象的属性吗？

如果是这样，我可以执行类似将XAML 中的on 设置为 on 的操作`ItemsSource`吗？现在我在代码隐藏中使用 foreach 来填充. `ModulesTreeview``ModulesList``CiscoSwitch``ModulesTreeView`

或者，我会创建一个`ObservableCollection`of `SwitchModules`，然后创建另一个 for `VSANs`，等等？

```
 public partial class CiscoSwitch
{
    #region baseswitchclassproperties
    private string _SwitchName = String.Empty;
    public string switchName{ get{return _SwitchName;} set{_SwitchName=value;} }        private string _SWVersion = String.Empty;
    public  string swVersion{ get{return _SWVersion;} set{_SWVersion=value;} }
    private string _SwitchModel = String.Empty;
    public string switchModel { get{return _SwitchModel;} set{_SwitchModel=value;} }
    private string _SerialNumber = String.Empty;
    public string SerialNumber { get { return _SerialNumber; } set { _SerialNumber = value; } }
    private string _SwitchWWPN = string.Empty;
    public string SwitchWWPN { get { return _SwitchWWPN; } set { _SwitchWWPN = value; } }
    public Dictionary<int, SwitchModule> ModuleList = new Dictionary<int, SwitchModule>();
    public Dictionary <int, CiscoVSAN> VSANList = new Dictionary<int, CiscoVSAN>();
    protected EthernetPort _ManagementPort = new EthernetPort();
    public string IPAddress{ set{_ManagementPort.IPAddress=value;} get{return _ManagementPort.IPAddress;} }

    public string LastDataCaptureDate = null;
    public Dictionary<int, PortChannel> PortChanelList = new Dictionary<int, PortChannel>();
    public Dictionary<String, FCIPPort> FCIPPortList = new Dictionary<string, FCIPPort>();
    public InterVSANTopology IVRTopology =  null; //new InterVSANTopology();

    public Dictionary<int, List<CiscoSwitch>> NeighborsList = new Dictionary<int, List<CiscoSwitch>>();
    public Dictionary<string, string> DeviceAliases = new Dictionary<string, string>();
    public Dictionary<string, FCPort> FlogiDatabase = new Dictionary<string, FCPort>();
    #endregion
} 
```

XAML：

```
<Window.Resources>
    <Style TargetType="{x:Type TreeViewItem}" x:Key="ModuleStyle">
        <Setter Property="Foreground" Value="Blue"/>
        <Setter Property="FontSize" Value="12"/>
    </Style>

    <Style TargetType="{x:Type TreeViewItem}" x:Key="RedModuleStyle" BasedOn="{StaticResource ModuleStyle}">
        <Setter Property="Foreground" Value="Red"/>
    </Style>

</Window.Resources>
<Grid Margin="0,0,-211.4,-168">
    <StackPanel HorizontalAlignment="Stretch" Name="StackPanel1" VerticalAlignment="Stretch" Width="Auto" Margin="0,0,188.6,114">
        <StackPanel.Resources> 
            <Style TargetType="{x:Type Label}" x:Key="LabelStyle">
                <Setter Property="Foreground" Value="Blue"/>
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="FontWeight" Value="Bold"/>
            </Style>
        </StackPanel.Resources>
        <Label Content="Switch Name:" Name="Label1" Height="25" HorizontalAlignment="Left"/>
        <Label Content="Software Version:" Name="Label2" HorizontalAlignment="Left" />
        <Label Content="Model Number:" Name="Label3" HorizontalAlignment="left"/>
        <Label Content="IP Address:" Name="Label4" HorizontalAlignment="left"></Label>
        <Label Content="Serial Number:" Name="Label5" HorizontalAlignment="Left"></Label>
        <Label Content="Show Tech Taken:" Name="Label6" HorizontalAlignment="left"/>
    </StackPanel>
    <StackPanel Margin="105,0,15.6,114">
        <StackPanel.Resources>
            <Style TargetType="{x:Type Label}" x:Key="LabelStyle">
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="FontWeight" Value="Bold"/>
            </Style>
        </StackPanel.Resources>
        <Label Content="Name" Name="SwitchNameLabel" HorizontalAlignment="left"/>
        <Label Content="Version" Name="VersionLabel" HorizontalAlignment="left"/>
        <Label Content="Model" Name="ModelNumberLabel" HorizontalAlignment="Left"/>
        <Label Content="IP" Name="IPAddressLabel" HorizontalAlignment="Left"/>
        <Label Content="Serial" Name="SerialLabel" HorizontalAlignment="Left"/>
            <Label Content="ST" Name="ShowTechLabel" HorizontalAlignment="Left"/>

    </StackPanel>
    <StackPanel HorizontalAlignment="Left" Height="Auto" Margin="0,156,0,0" VerticalAlignment="Top" Width="256" >
        <TreeView Name="ModulesTreeView" Height="auto" Background="GhostWhite" BorderThickness="0"/>

    </StackPanel>

</Grid> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T07:30:22.780

您对创建单曲的第一个想法`ObservableCollection<CiscoSwitch>`是正确的方法。这是一个更简化的示例，您可以将其扩展到您的特定需求。

```
public class Person
{
    public string Name { get; set; }
    public string Address { get; set; }
} 
```

假设在我们的 ViewModel 中有一个`ObservableCollection<Person>`被调用的`People`.

```
<ListBox ItemsSource="{Binding Path=People}">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Path=Name}" />
                <TextBlock Text="{Binding Path=Address}" />
            </StackPanel>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

这是一个过于简单的示例，但我认为您应该能够将其扩展到您的需要。希望这可以帮助！

# c++ - 具有枚举规范的模板模板类在 MSVC++ 编译器上失败：C3201

> ID：12734658
> 
> 赞同：10
> 
> 时间：2012-10-04T19:41:38.520
> 
> 标签：c++, templates, visual-c++, c++11, template-templates

# 代码

这是我的问题的[SSCCE](http://sscce.org/)示例：

```
// My Library, which I want to take in the user's enum and a template class which they put per-enum specialized code
template <typename TEnum, template <TEnum> class EnumStruct>
struct LibraryT { /* Library stuff */ };

// User Defined Enum and Associated Template (which gets specialized later)
namespace MyEnum {
    enum Enum {
        Value1 /*, ... */
    };
};

template <MyEnum::Enum>
struct MyEnumTemplate {};

template <>
struct MyEnumTemplate<MyEnum::Value1> { /* specialized code here */ };

// Then the user wants to use the library:
typedef LibraryT<MyEnum::Enum, MyEnumTemplate> MyLibrary;

int main() {
    MyLibrary library;
} 
```

[**编辑**：更改`LibraryT<MyEnum::Enum, MyEnumTemplate>`为`LibraryT<typename MyEnum::Enum, MyEnumTemplate>`无效]

# 错误

我想要的功能是能够创建一个基于枚举和一个由该枚举专门化的类的库。以上是我的第一次尝试。我相信它是 100% C++，并且 GCC 支持我并说这一切都有效。但是，我希望它使用 MSVC++ 编译器进行编译，但它拒绝：

```
error C3201: the template parameter list for class template 'MyEnumTemplate' 
  does not match the template parameter list for template parameter 'EnumStruct' 
```

# 问题

有什么方法可以使 MSVC++ 编译器 [**编辑**：MSVC++ 11 编译器 (VS 2012)] 像我的代码一样？通过一些附加规范或不同的方法？

# 可能的（但不希望的）解决方案

将枚举类型硬编码为某种整数类型（基础类型）。然后没有问题。但是后来我的库在积分而不是枚举类型上运行（不受欢迎，但有效）

```
// My Library, which I want to take in the user's enum and a template class which they put per-enum specialized code
typedef unsigned long IntegralType; // **ADDED**

template <template <IntegralType> class EnumStruct> // **CHANGED**
struct LibraryT { /* Library stuff */ };

// User Defined Enum and Associated Template (which gets specialized later)
namespace MyEnum {
    enum Enum {
        Value1 /*, ... */
    };
};

template <IntegralType> // **CHANGED**
struct MyEnumTemplate {};

template <>
struct MyEnumTemplate<MyEnum::Value1> {};

// Then the user wants to use the library:
typedef LibraryT<MyEnumTemplate> MyLibrary; // **CHANGED**

int main() {
    MyLibrary library;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T21:30:58.357

这是 Visual C++ 编译器中的一个已知错误。有关详细信息，请参阅 Microsoft Connect 上的以下错误（repro 略有不同，但问题实际上是相同的）：

> [C++ 编译器错误 - 不能在嵌套模板声明中使用模板参数](http://connect.microsoft.com/VisualStudio/feedback/details/655445/c-compiler-bug-cannot-use-template-parameters-inside-nested-template-declaration)

推荐的解决方法是对模板模板参数的模板参数使用整数类型，这是您在“可能（但不希望）的解决方案”中所做的。

# typescript - 类型化的函数数组

> ID：12734660
> 
> 赞同：81
> 
> 时间：2012-10-04T19:41:45.120
> 
> 标签：typescript

我正在努力弄清楚是否可以在 TypeScript 中声明一个静态类型的函数数组。

例如，我可以这样做：

```
foo: (data:string) => void = function (data) {}; 
```

但是如果我想让 foo 成为一个函数数组，它接受一个字符串并且什么都不返回，我该怎么做呢？

```
foo: (data:string) => void [] = []; 
```

不起作用，因为 TypeScript 认为它是一个接受字符串并返回 void 数组的函数，而且它似乎不喜欢我试图将函数包装在括号中。

有任何想法吗？

**回答**：感谢下面的 mohamed，这是一个在 TypeScript Playground 中工作的示例：

```
class whatever {
public foo: { (data: string): void; }[] = [];

    dofoo() {
        for (var i=0; i < this.foo.length; i++) {
             this.foo[i]("test");
        }
    }
}

var d = new whatever();

d.foo.push(function(bar){alert(bar)})
d.foo.push(function(bar){alert(bar.length.toString())})

d.dofoo(); 
```

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2012-10-04T19:55:42.667

您可以在[语言规范](http://www.typescriptlang.org/Content/TypeScript%20Language%20Specification.docx)第 3.6.4 节中找到它：

```
foo: { (data: string): void; } [] 
```

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2017-04-23T15:28:41.807

使用粗箭头键入函数数组的其他（更新，更易读）方法：

```
let foo: Array<(data: string) => void>;
let bar: ((data: string) => void)[]; 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2020-03-01T12:36:44.087

或者`foo: ((data: string) => void)[]`

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-02-01T21:06:52.457

如果你想在 TypeScript 中声明一个可调用函数数组，你可以声明一个类型：

```
type Bar = (
  (data: string) => void
); 
```

然后使用它：

```
const foo: Bar[] = [];

const fooFn = (data: string) => console.log(data);
foo.push(fooFn);
foo.forEach((fooFn: Bar) => fooFn("Something"); 
```

# android - 意图不是从通知开始的

> ID：12734661
> 
> 赞同：0
> 
> 时间：2012-10-04T19:41:46.870
> 
> 标签：android

我尝试从通知中触发意图：

```
CharSequence tickerText = "ServiceTicker"; // context.getString(R.string.service_ticker_registered_text);
long when = System.currentTimeMillis();

Builder nb = new NotificationCompat.Builder(context);
nb.setTicker(tickerText);
nb.setWhen(when);
Intent notificationIntent = new Intent(context, AccountRegistrationChanged.class);

notificationIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
PendingIntent contentIntent = PendingIntent.getActivity(context, 0, notificationIntent, PendingIntent.FLAG_UPDATE_CURRENT);

RegistrationNotification contentView = new RegistrationNotification(context.getPackageName());
contentView.clearRegistrations();
if(!Compatibility.isCompatible(9)) {
    contentView.setTextsColor(notificationPrimaryTextColor);
}
contentView.addAccountInfos(context, activeAccountsInfos);

nb.setOngoing(true);
nb.setOnlyAlertOnce(true);
nb.setContentIntent(contentIntent);
nb.setContent(contentView);

Notification notification = nb.build();
notification.flags |= Notification.FLAG_NO_CLEAR;
// We have to re-write content view because getNotification setLatestEventInfo implicitly
notification.contentView = contentView;
Log.e(THIS_FILE, "==============notification:" + notification + " contentView:" + contentView + " notificationIntent:" + notificationIntent + " contentIntent" + contentIntent + " context:" + context + " nb:" + nb);

if (showNumbers) {
    // This only affects android 2.3 and lower
    notification.number = activeAccountsInfos.size();
}
startForegroundCompat(REGISTER_NOTIF_ID, notification);

private void startForegroundCompat(int id, Notification notification) {
    // If we have the new startForeground API, then use it.
    if (mStartForeground != null) {
        Log.e(THIS_FILE, "mStartForeground");

        mStartForegroundArgs[0] = Integer.valueOf(id);
        mStartForegroundArgs[1] = notification;
        invokeMethod(mStartForeground, mStartForegroundArgs);
        return;
    }
    Log.e(THIS_FILE, "invokeMethod");

    // Fall back on the old API.
    mSetForegroundArgs[0] = Boolean.TRUE;
    invokeMethod(mSetForeground, mSetForegroundArgs);
    notificationManager.notify(id, notification);
} 
```

最后我在日志中，正确创建了所有意图和视图：

10-04 22:38:49.344：电子/通知（7415）：

> =============通知：通知（振动=空，声音=空，默认值=0x0）内容视图：com.csipsimple.widgets.RegistrationNotification@44eb3ff8 notificationIntent：Intent { flg=0x10000000 cmp= com.callsfreecalls.android/.AccountRegistrationChanged } contentIntentPendingIntent{44eb3fe8: android.os.BinderProxy@44f08f98} 上下文:com.csipsimple.service.SipService@44e9c328 nb:android.support.v4.app.NotificationCompat$Builder@44eb3e30 10-04 22:38:49.344：E/通知（7415）：mStartForeground
> 
> 10-04 22:38:49.344：E/通知（7415）：mStartForeground

但什么也没发生，这段代码：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Log.e(THIS_FILE, "AccountRegistrationChanged");

    setContentView(R.layout.activity_account_registration_changed);
} 
```

未在 Activity/AccountRegistrationChanged 中启动...

这是 Activity 的清单：

```
<activity
    android:name=".AccountRegistrationChanged"
    android:label="@string/title_activity_account_registration_changed" >
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />

        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter> 
```

有什么建议吗？也许我必须发射更多东西来推送通知开始意图？目前我只需要从另一个活动中激活一些元素，但是带有处理程序的代码（如下所述）导致未知错误，调试中没有任何解释：

```
SipProfileState ps = activeAccountsInfos.get(i);
Message msg = new Message();
Bundle b = new Bundle();
b.putString("regState",String.valueOf(ps.getStatusCode()));
msg.setData(b);
PhonePadActivity.getUareceiverhandler().sendMessage(msg); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:00:10.843

也许[`onNewIntent()`](http://developer.android.com/reference/android/app/Activity.html#onNewIntent%28android.content.Intent%29)您的`AccountRegistrationChanged`活动方法被触发而不是`onCreate()`. `AccountRegistrationChanged`在您收到通知之前是否已经创建了活动？

# python - Python pnoise 返回 0：为什么会这样？

> ID：12734664
> 
> 赞同：3
> 
> 时间：2012-10-04T19:41:53.900
> 
> 标签：python, floating-point, perlin-noise

我正在尝试使用Python 的[噪声](http://pypi.python.org/pypi/noise/)模块生成 2D [Perlin 噪声。](http://freespace.virgin.net/hugo.elias/models/m_perlin.htm)我试图遵循[示例](http://code.google.com/p/caseman/source/browse/trunk/noise/examples/2dtexture.py?r=616)。 该函数只需要一个和输入：`pnoise2()`
`x``y`

```
noise2(x, y, octaves=1, persistence=0.5, repeatx=1024, repeaty=1024, base=0.0) 
```

然而，无论我传入什么，函数总是返回`0.0`. 怎么来的？我错过了什么？

[编辑：2012 年 5 月 10 日]

其他一些[示例](https://gamedev.stackexchange.com/questions/29044/how-can-i-generate-random-lakes-and-rivers-in-my-game)有效，代码很简单：

```
import sys
from noise import pnoise2
import random
random.seed()
octaves = random.random()
freq = 16.0 * octaves
for y in range(30):
    for x in range(40):
        n = int(pnoise2(x/freq, y / freq, 1)*10+3)
        if n>=1:
            n=1
        else:
            n=0
        print n,
    print 
```

所以，由于我不知道`* 0.5`or `+ 0.5`or `* 10+3`etc. 值是什么，我尝试了自己，同时排除了其中一些值。在上面的示例中，`random.random()`返回一个浮点数，例如`0.7806`等，然后将其乘以`16.0`得到频率。*注意：这已经让我感到困惑，因为八度音阶，我认为应该是一个整数，因为它告诉了连续噪声函数的数量（还要注意它是一个整数`1`，作为函数中的第三个值传入`pnoise2()`）。*无论如何，在函数中，来自 的一些整数`range()`然后除以`frequency`，现在大约`13.88`：

```
>>> pnoise2(1/13.88, 1/13.88, 1)
0.06868855153353493
>>> pnoise2(0.07, 0.06, 1)
0.06691436186932441
>>> pnoise2(3.07, 3.04, 1)
0.06642476158741428 
>>> pnoise2(3.00, 2.03, 1)                                                   
0.02999223154495647 
```

但话又说回来：

```
>>> pnoise2(3.0, 2.0, 1)                                                   
0.0
>>> pnoise2(1.0, 2.0, 1)                                                     
0.0
>>> pnoise2(4.0, 5.0, 1)
0.0 
```

所以我得出结论`x` **or** `y`必须有小数才能使函数返回`0.0`.

现在在这之后，**我的问题是我不明白为什么**。有人可以启发我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-05T05:59:35.890

如我的评论中所述，您需要在 和 之间传递x和`float`y 的函数值。`0.0``1.0`

这可能会作为错误提交 - 如果 x 或 y 大于 1.0，则`ValueError`可以提出适当的问题。那可能会阻止你问这个问题！

这是特定于实现的，但这只是一种允许您以您想要/需要的任何分辨率获得结果的方式。

考虑一下这个库的作者是否强制 x 和 y 的最大值为 100，并要求您使用整数。突然之间，噪声实际上是`100x100`网格上的单元噪声，因为您永远无法读取任何中间值。使用浮点数允许用户在他们需要的任何细节级别上获得结果。

这种细节存在的事实是柏林噪声所固有的。请参阅以下注释中的倒数第二点（取自源代码）：

```
 """Perlin simplex noise generator

    Adapted from Stefan Gustavson's Java implementation described here:

    http://staffwww.itn.liu.se/~stegu/simplexnoise/simplexnoise.pdf

    To summarize:

    In 2001, Ken Perlin presented 'simplex noise', a replacement for his classic
    noise algorithm.  Classic 'Perlin noise' won him an academy award and has
    become an ubiquitous procedural primitive for computer graphics over the
    years, but in hindsight it has quite a few limitations.  Ken Perlin himself
    designed simplex noise specifically to overcome those limitations, and he
    spent a lot of good thinking on it. Therefore, it is a better idea than his
    original algorithm. A few of the more prominent advantages are: 

    * Simplex noise has a lower computational complexity and requires fewer
      multiplications. 
    * Simplex noise scales to higher dimensions (4D, 5D and up) with much less
      computational cost, the complexity is O(N) for N dimensions instead of 
      the O(2^N) of classic Noise. 
    * Simplex noise has no noticeable directional artifacts.  Simplex noise has 
      a well-defined and continuous gradient everywhere that can be computed 
      quite cheaply. 
    * Simplex noise is easy to implement in hardware. 
    """ 
```

# javascript - 为旧版本的非 IE 浏览器编写兼容性代码

> ID：12734665
> 
> 赞同：6
> 
> 时间：2012-10-04T19:41:55.193
> 
> 标签：javascript, html, web-applications, cross-browser

我想知道专业的 HTML/CSS/JS 开发人员是否担心与不是最新的 Firefox、Chrome 或 Opera 的兼容性？我对浏览器的体验是它们只是自动更新，并且没有像 IE 这样的版本系统，您可以在其中获得与新操作系统版本相关的主要版本。

那么人们是否担心他们的代码与旧版本的 Firefox 兼容，或者人们是否只是假设如果有人在使用他们的网站，这意味着他们已经连接到互联网，因此如果他们选择使用最新版本的非 IE 浏览器用一个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T21:39:46.733

我建议您访问[http://caniuse.com/](http://caniuse.com/)。

该站点为所有常见浏览器的版本提供了非常全面的浏览器支持表，可以追溯到很长一段时间（当然，只要任何人都需要担心）。

这就是 CanIUse.com 将为您做的第一件事：它会告诉您每个主要浏览器功能，哪些浏览器版本支持该功能。这可以帮助您决定是否在您的站点中使用该功能。

其次，他们还拥有最新的浏览器使用统计信息。这会告诉您每个浏览器的每个版本，有多少百分比的网络用户正在使用该特定浏览器/版本。这可以帮助您决定支持哪些浏览器版本。例如，如果 IE6 拥有 1% 的浏览器市场，您可能会认为用户数量太少，因此支持它的额外麻烦不值得付出努力。这同样适用于其他浏览器。

更一般地说，主要的非 IE 浏览器：

*   Chrome 一直都有自动更新功能。几乎每个人都将使用最新版本，或者最坏的情况是落后一个版本。任何使用超过几个月大的版本的人都是异常的。
*   对于最新用户来说，Firefox 现在与 Chrome 处于相同的位置。然而，他们也有一个长期支持版本（目前为 FFv10），该版本不经常更新。你需要支持这一点。此外，具有自动更新功能之前版本的用户可能尚未升级。FF3.6 和 FF4 用户仍然很少，但数量可观。不过，由于现在的升级，大多数其他版本已经几乎消失了。
*   Opera 也很擅长保持自己的最新状态，而且似乎大多数 Opera 用户自己也很注意这一点，因此您通常不必担心旧版本的 Opera。
*   Safari 是您可能需要留意旧版本的地方。Safari 的问题是，较新的版本并不总是支持较旧的硬件或操作系统，因此使用稍微过时的 Macbook 的用户发现他们无法升级到最新的 Safari。因此，仍有相当多的 Safari 版本在那里运行。但请查看 CanIUse 统计数据，以获得更清晰的版本细分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T19:45:48.177

这是个有趣的问题。我们确实担心浏览器版本，但主要是 IE。我不知道“假设”当前的 FireFox、Chrome 或 Safari 浏览器是否安全，但可能是因为我们从这些浏览器获得的流量足够小，以至于我们根本听不到。另外，我可能会四处走动，但它们似乎不那么敏感 rev-to-rev - 更能容忍基于标准的布局。希望，无论如何。

不确定这是否回答了您的问题，但您所描述的是我们所做的，有点无意:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-04T20:14:55.280

我能想到的主要原因是 WindowsXP（约 30% 的全球用户）不支持 IE9，而 Win7（幸运的是）不支持 IE8。两者之间有很大很大的差距。

任何版本的 FF、Chrome 或 Opera 的要求是：显示器、互联网连接、电力。

^(我保留了一台旧笔记本电脑进行测试，使用的是)Firefox 3、Chrome 的 10 版和 Safari 的 3.1 版。你猜怎么了？它们***都***支持`border-radius`, `rgba`, `opacity`... 最糟糕的是，您需要供应商前缀。尝试`rgba`在 IE8 中模拟文本，你会发疯的。

简而言之，在旧版本的非 IE 浏览器中只留下了最新的功能。对于那些我已经需要 IE9 的后备，所以......

如果您编写一个与 IE9 兼容的网站，它*可能会*在旧版本的其他浏览器上运行良好。它也可以在 IE8 上运行？答对了！

* * *

[PS 这是对 Microsoft 的AlphaImageLoader 过滤器](http://msdn.microsoft.com/en-us/library/ms532969.aspx)规范的第一条评论：

> 对任何微软支持人员的问题，如果完整（审查），为什么您仍然提供网络浏览器？学会更快地更新我的意思是耶稣为什么要花这么长时间才能完全符合 html5 你有 5 个编码器吗？

它的日期是……九月九**二千**。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T20:37:12.750

我经营一个以内容为导向的网站，我的图表为王。

我让我的网站在 Firefox、Chrome 和 Safari 上看起来很漂亮。我确保它在 IE 7 和 8 上看起来足够好。对于 IE6，我只关心有人可以/使用/它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-04T20:42:23.280

没有。没有人关心旧的非 ie 浏览器，除非这是一些糟糕的企业事情，您必须支持客户端，因为他们的技术支持与 Firefox 2 相关联。

除非您有非常具体的理由，否则您也不应该在意。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-04T20:58:22.227

它会因您的目标市场而异。一般建议不能代替这里的具体知识。如果您运行一个公共站点，请查看您的访问日志或分析，以了解实际连接的浏览器版本。如果您分发本地应用程序，则需要调查您的客户，这有点困难。我假设您没有进行内部开发，从那时起您的 IT 部门应该能够准确地告诉您期望的版本。

我在一个本地企业 Web 应用程序上工作。对于 IE，我们的目标是 8、9 和 10。我们可以不支持 6 和 7，因为它们可以在所有版本的 Windows 上升级到 8。对于 Firefox，我们使用最新的主线和[企业支持](https://www.mozilla.org/en-US/firefox/organizations/)版本进行测试。我们的客户几乎不使用 Chrome 和 Safari，因此我们只测试它们的最新主线版本。

IE 以外的浏览器往往更能容忍新标记，即使在旧版本中也是如此。最需要注意的是 CSS 属性上的供应商前缀。即使当前版本使用标准属性，您也可以获得对旧版本的支持，只需添加前缀即可。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-04T21:16:25.893

我的大部分开发工作都是在 Chrome Beta 中进行的，几个月前，我的经理在我 20 岁时在 Chrome 19 中尝试了我的页面，她遇到了一个问题，因为我在旧版本中遇到了一个错误。那时我在 BrowserStack 有一个帐户。

# php - 显示从 Mysql 填充的下拉选择表单中的选择

> ID：12734669
> 
> 赞同：1
> 
> 时间：2012-10-04T19:42:14.230
> 
> 标签：php, mysql

在这里难倒编程新手。

几个月前我开始学习 PHP（用一点 HTML）。

一直在尝试创建一个从 Mysql 填充的下拉选择表单。正如您将在下面的代码中看到的那样，我想我已经做到了（如果您注意到代码中的任何“错误”，请告诉我）。

我的问题是显示/回显选定的选项/值。无论我从下拉列表中选择并提交什么，都只会显示第一项（在本例中：阿拉巴马州——stateid 为 1）。

我尝试了各种我在网上看到的东西，但似乎没有任何效果。

有很多调用 javascript 的建议，但就像我说的，我对编程完全陌生，所以 - 一次只使用一种语言。在跳到其他语言之前，我想很好地掌握 php。

当然这可以用 php 解决，对吗？

顺便说一句，最终目标是创建多个（大约 3 或 4 个）渐进式下拉表单（州、县、市）。所以，如果你愿意放纵我，我也想学习如何将选定的值（例如状态）传递给下一个查询/下拉列表。

我现在可以接受一堆带有提交按钮的下拉菜单。我最终会学习javascript。

但是试图弄清楚如何显示选定的状态让我发疯了。

非常感谢您的帮助/信息。

“状态”表

```
CREATE TABLE States (
stateid int NOT NULL AUTO_INCREMENT PRIMARY KEY,
state_name varchar(25) NOT NULL
)
ENGINE=INNODB,
DEFAULT CHARACTER SET utf8; 
```

从 DATABSE 填充的选择/选项——“pick_state.php”：

```
$con = mysql_connect("localhost", "testx", "testx") or die('Could not connect to server');
mysql_select_db("US", $con) or die('Could not connect to database');

$stateid = $_GET['stateid'];
$state_name = $GET['state_name'];

$query = "SELECT stateid,state_name FROM States";

$result = mysql_query($query) or die(mysql_error());

$row = mysql_fetch_array($result, MYSQL_ASSOC) or die(mysql_error());

$stateid = $row['stateid'];
$state_name = $row['state_name'];

echo "Chosen state is: $state_name"; 
```

处理文件——“show_state.php”：

```
<?php

$con = mysql_connect("localhost", "test", "test") or die('Could not connect to server');
mysql_select_db("US", $con) or die('Could not connect to database');

echo "<form action=\"show_state.php\" method=\"get\">\n";

echo "<select name=\"state_name\">\n";

$query="SELECT stateid,state_name FROM States";

// ALSO : $query = "SELECT * FROM States "; --Does not work either//

$result=mysql_query($query);

      while($row=mysql_fetch_array($result,MYSQL_ASSOC))

      {
          $stateid = $row['stateid'];
          $state_name= $row['state_name'];
          echo "<option value=\"$stateid\">$state_name</option>";
      }

      echo "</select>\n";
      echo "<input name=\"submit\" type=\"submit\" id=\"stateid\" value=\"submit\" />\n";
      echo "</form> \n";

 ?> 
```

无论我选择并提交什么，以下页面始终只显示桌子上的第一项：阿拉巴马州

页面显示：“选择的州是：阿拉巴马州”

URL 当我选择并提交阿肯色州时：

/show_state.php?state_name=4&submit=submit

这是否意味着它正在检索正确的、选择/提交的 stateid（在这种情况下：4 --Arkansas' 声明）但只是不“呼应”州名？

在 show_state.php 上尝试了以下操作

```
$query = "SELECT stateid,state_name FROM States WHERE state_name = $state_name"; 
```

页面显示：空白

```
$query = "SELECT stateid,state_name FROM States WHERE stateid= $stateid"; 
```

页面显示：“您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，以获取正确的语法，以便在第 1 行的 '' 附近使用”

```
if(isset($makeid)) 
```

页面显示：`"Query was empty"`

```
if(isset ($_GET['makeid'])) 
```

页面显示：`"Your Car is a "`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:59:48.590

这行代码将始终打印数据库返回的第一个状态：

```
$state_name = $row['state_name']; 
```

您需要像这样更改您的查询：

```
$query = "SELECT stateid,state_name FROM States where stateid=$state_name"; 
```

这为您显示了一个空白页，因为您已经写了这个：

```
$state_name = $GET['state_name']; 
```

这`$_GET`不是`$GET`。所以将此行更改为：

```
$state_name = $_GET['state_name']; 
```

现在它应该运行良好:)

## 笔记：

1.  [始终使用mysqli_real_escape_string](http://www.php.net/manual/en/mysqli.real-escape-string.php)清理用户输入
2.  不要使用[php 文档中建议的 *](http://php.net/manual/en/function.mysql-real-escape-string.php) *mysql* *family 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T20:04:55.950

`$_GET['state_name']`将不起作用，因为您没有该名称的表单字段。采用：

```
if (isset($_GET['stateid'])) {
  query = "SELECT state_name FROM States WHERE stateid= " . sprintf("%d", $_GET['stateid']);
  $result=mysql_query($query) or die "Query error:".mysql_error();
  if (mysql_num_rows($result)) {
    $row=mysql_fetch_array($result,MYSQL_ASSOC);
    $state_name = $row['state_name'];
} else {
  $state_name = 'unselected';
} 
```

要使选定状态默认显示在菜单中，请更改：

```
echo "<option value=\"$stateid\">$state_name</option>"; 
```

到：

```
echo "<option value=\"$stateid\" . ($stateid == $_GET['stateid']) ? "SELECTED" : "") . ">$state_name</option>"; 
```

# python - 干净的 Python 安装上的“Hello World”程序中的异常

> ID：12734670
> 
> 赞同：-1
> 
> 时间：2012-10-04T19:42:18.410
> 
> 标签：python, python-3.x

最近我在 Windows 7 上安装了 python，但它的效果不如它在 Linux Ubuntu 上的效果。我写了一个简单的程序，它仍然给我一个错误：

```
>>>print("HelloWorld")
'mbcs' codec can't encode characters in position 0--1: invalid character 
```

![Python 错误](../Images/932c2232ac7aee81b62829c027a72c66.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:57:27.530

您最有可能有一些文本编辑器未显示的标题。[以 BOM](http://en.wikipedia.org/wiki/Byte_order_mark)为例。检查您的编辑器设置以摆脱此标题。

# probability - 从 Z3 中的一组令人满意的任务中统一采样

> ID：12734672
> 
> 赞同：1
> 
> 时间：2012-10-04T19:42:22.027
> 
> 标签：probability, z3, smt, theorem-proving

有没有办法使用 Z3 定理证明器从一组令人满意的作业中均匀采样？如果不是，那么最接近 Z3 且具有此功能的系统是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T12:15:55.187

没有直接的方法可以让 Z3 统一为您做样本。

这是一个有趣的问题。例如，这取决于您使用什么理论来理解制服的含义。

[FORMULA](http://research.microsoft.com/en-us/um/redmond/projects/formula/)工具在Z3 之上以一种考虑了一些理论属性的方式实现了随机抽样。

# javascript - JavaScript innerHTML 问题

> ID：12734676
> 
> 赞同：0
> 
> 时间：2012-10-04T19:42:26.633
> 
> 标签：javascript, dom

我有一段代码将 div 标签的内部 HTML 更改为状态消息，这包含在 try 方法中，唯一的问题是状态保持可见大约 3 秒然后消失。我想这是由于 try 方法，有什么办法可以阻止它？

```
<script> 
        function goCouch(form){

            var xmlHttp = false; 
                try {
                    var couchURL = form.inputbox.value;

                    xmlHttp = new XMLHttpRequest();
                    xmlHttp.open( "GET", "http://" + couchURL + ":5984", false );
                    xmlHttp.send( null );
                    var couchWelcome = xmlHttp.responseText;
                    var requestedServerStatus = xmlHttp.status;

                    var status = document.getElementById("status")
                    status.innerHTML = couchWelcome;

                    //alert(requestedServerStatus);
                    //alert(couchWelcome); 
                } catch (failed) {
                  xmlHttp = false;
                }

                if (!xmlHttp){
                  //alert("Don't panic, but I can't connect to that server.");
                }
            }
        </script>

<div id="mainContent">

            <form action="" method="get" id="myform">
                Enter your database URL<br>
                <input type="url" name="inputbox" value="">
                <input type="submit" name="button" value="Go" onclick="goCouch(this.form)"></p>
            </form>

            <div id="status"></div>
        </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:59:33.300

您的 onClick 处理程序附加到表单的提交按钮。

由于您不返回 false，或者以其他方式阻止默认事件操作，我认为发生的事情是这样的：

*   单击按钮，onClick 处理程序开始运行
*   处理程序执行同步 XHR 请求，从服务器获取响应，并更新 div。
*   控制权传回浏览器，浏览器继续*提交表单*
*   由于表单动作是“”，浏览器实际上是重新加载页面
*   重新加载页面时，消息消失了。

要解决此问题，请将“ `return false`”添加到 goCouch 函数的末尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T20:00:15.937

您的提交按钮将提交表单，这将导致页面重新加载。如果您`return false`在函数末尾添加 a ，则`gotToCouch`不应发生提交（对此不是 100% 确定）。

除此之外，您正在执行 ajax 请求，但您没有使用回调函数来获取结果，而是强制请求同步......这可能不会导致任何问题，但会停止浏览器，直到请求得到响应，只是说......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-05T13:27:34.467

我只想改变你的按钮类型。

```
<input type="button" name="button" value="Go" onclick="goCouch(this.form)"> 
```

如果您确实需要最终提交您的表单，您可以`form.submit()`在 javascript 中执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T20:33:27.793

为了防止默认操作，您可以使用该功能

```
event.preventDefault() 
```

# c# - c# 在 WCF 运行时创建动态类/属性

> ID：12734677
> 
> 赞同：1
> 
> 时间：2012-10-04T19:42:31.393
> 
> 标签：c#, wcf, silverlight, list, reflection

这些是我需要写的方法：

```
List<Test> test = new List<Test>();
public List<Test> GetData(int ReportId)
     {
       StringBuilder qr = new StringBuilder();
       StringBuilder SQL = new StringBuilder();
       DataTable dt;

    qr.AppendLine(" select SQL");
    qr.AppendLine(" from  V_REPORT_SQL f");
    qr.AppendLine(String.Format(" where REPORT_ID = '{0}'", ReportId));

   dt = DataManager.GetDatadt(qr);
      foreach (DataRow dr in dt.Rows)
         {
           SQL.Append(dr[0].DBStr());
         }

        dt = DataManager.GetData(SQL);
        foreach (DataRow dr in dt.Rows)
         {
        Test t = new Test()
        {
         can i dynamically create and iterate over the properties and assign the datarow? 
        };

        test.Add(t);
    }
    return test;

    } 
```

//这是数据合约

```
 [DataContract]
    public class Test
    {  
    } 
```

**表 V_Report_SQL**

```
reportid | SQL
1        | select id,Name from table1
2        | select acctid,Name,date from table2
3        | select Name,location,date,XX,XX,XX from table3 
```

我要解决的问题是我发送reportid 以动态获取sql，然后传递sql 并获取DataTable 中的数据。现在我需要将其发送为`list<Test>`. 我可以动态地为类测试创建属性吗？例如 ：

```
 for report id 1

     [DataMember]
     public int Id { get; set; }

     [DataMember]
     public string Name { get; set; }

     for report id 2 

     [DataMember]
     public int acctid { get; set; }

     [DataMember]
     public string Name { get; set; }

     [DataMember]
     public DateTime date { get; set; } 
```

使用该服务的客户端应用程序是在 silverlight 4 上构建的。

如果我不清楚，请告诉我，我可以更新它。我不确定我选择解决的路线。有没有其他方法可以解决这个问题。

**更新：**

我已经更新了，我不再使用动态，不确定这条路线会解决。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T16:21:31.257

我认为您的意图是崇高的，但实际上您将创建一个不断变化的 Web 服务。谁会使用它？如果我是你，我会返回以下对象之一：

1.  二维字符串表（第一行将是一系列标题，其余的将分别存储值）
2.  一维字符串表（属性名称 - 属性值对）
3.  字符串（CSV 文件的平面内容）
4.  二进制 CSV
5.  您必须在客户端爬取的动态 XML

假设您只关心文本值，我显然可能是错误的，但由于您使用的是报告表，我认为这种情况很有可能发生。

希望这会有所帮助，Piotr

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T19:47:06.773

通常，尝试在 Web 服务中使用特定于平台的类型是个坏主意。例如，您不会期望 Java 能够理解`DataTable`类型。

我怀疑您在尝试返回`dynamic`对象时会遇到同样的问题。这甚至不能用服务的 WSDL 来描述，所以我怀疑任何调用者都知道如何处理这样的返回值。

事实上，我什至不知道该服务如何序列化这样的事情。

# c - Linux 上的 ASLR 限制

> ID：12734679
> 
> 赞同：3
> 
> 时间：2012-10-04T19:42:40.487
> 
> 标签：c, linux, linux-kernel, aslr

我试图通过在 process.c 中修改 arch_align_stack() 来“改进”我自己的 x86 32 位机器上的 ASLR，方法是将第二个参数增加到模：

```
if (!(current->personality & ADDR_NO_RANDOMIZE) && randomize_va_space)
    sp -= get_random_int() % 8192;
return sp & ~0xf; 
```

但是我很快发现，过多地篡改它会导致内核恐慌。而且我怀疑它会使系统变得不稳定，即使只是对其进行了一些篡改（它很可能靠运气存活了一段时间？）。

这促使我问了一个关于为什么会发生这种情况的问题（原始问题[为什么堆栈必须是页面对齐的？](https://stackoverflow.com/questions/11958092/why-does-the-stack-have-to-be-page-aligned)）。显然这是因为（如用户“mpe”所述）默认堆栈大小为 8 kiB，即 8192 字节。那么通过扩展增加内核中的堆栈大小，这个参数（8192）应该可以增加吗？还提到堆栈本身的位置可以是随机的。

帕克斯会这样做吗？如果不是，那为什么不呢？

内核中如何/在哪里指定堆栈大小？这对于 32 位和 64 位有什么不同吗？

32位和64位之间有什么区别吗？64 位仍然使用 process.c 来处理这些东西吗？我看到在 process_64.c 中似乎没有与此代码等效的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-07T17:35:39.373

即使在香草内核中，堆栈的位置也是随机的。请注意，函数`load_elf_binary()` [调用](http://lxr.linux.no/linux+v3.6/fs/binfmt_elf.c#L727) [`randomize_stack_top()`](http://lxr.linux.no/linux+v3.6/fs/binfmt_elf.c#L538)会随机化堆栈的位置。该函数是 Linux 堆栈 ASLR 的主要部分。

可以在[此处](http://xorl.wordpress.com/2011/01/16/linux-kernel-aslr-implementation/)找到对 Linux 内核中 ASLR 的良好描述。您可能主要对*Stack Randomization*部分感兴趣。

其实主要目的`arch_align_stack()`是通过超线程或类似技术提高 CPU 上的缓存性能。此外，没有选择值 8129 是因为堆栈大小（内核堆栈大小确实是 8K，但这个函数是随机化用户堆栈地址）而是因为 Intel 的建议。看到[这个](https://lkml.org/lkml/2007/8/27/91)和[这个](https://lkml.org/lkml/2006/7/25/62)。

`THREAD_SIZE`指定内核堆栈大小，x86-32 和 x86-64 都是 8K，如此处[所述](http://lxr.linux.no/linux+v3.6/Documentation/x86/x86_64/kernel-stacks)。用户堆栈大小不是固定的，因为堆栈可能会增长，除非它受到用户的限制。

`arch/x86/kernel/process.c`包含 32 位和 64 位通用的代码。`arch/x86/kernel/process_64.c`这就是为什么（或`arch/x86/kernel/process_32.c`）中没有等效代码的原因。

# image-processing - 从照片裁剪和 OCR 标签

> ID：12734680
> 
> 赞同：0
> 
> 时间：2012-10-04T19:42:41.030
> 
> 标签：image-processing, ocr, tesseract

我需要对标签中的一些特定信息进行 OCR，这些标签大多是已知布局。数据来源是照片，我知道这可能很棘手。数据可以是条形码（简单）、短文本（大部分是已知单词，随着时间的推移可以随着时间的推移而学习）和数字（设置格式和长度）。

我做了一些研究，似乎 Tesseract 可以在多个平台上做我想做的事，但我有几个问题。

1）我如何只裁剪相关标签。很久以前，我为大学课程做了一些非常基本的信号处理。我想这不是太难。有什么好的图书馆吗？

2）由于我知道布局，有没有办法为每个所需的特定值按部分 OCR 标记？

3）关于预处理图片的任何其他提示？

4) Tesseract 是适合这项工作的工具吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T15:22:52.163

我之前没有处理过 Tesseract。但是，我们使用了另一个名为leadtools 的第三方工具包。该工具包可以识别条形码、文本和数字，然后将结果保存为文档格式。它可以满足您的要求，因为它提供了在您要识别的文本周围绘制特定区域的方法，并且它具有一些预处理图像的方法。此外，它还提供了自动查找文件中要进行 OCR 的区域的功能。有关更多信息，您可以查看本[教程](http://www.leadtools.com/help/leadtools/v175/dh/to/leadtools.topics.forms.ocr~fo.topics.ocrtutorialaddingandpaintingzones.html)

# c# - 在不丢失当前单元格焦点的情况下更新 DataGridView

> ID：12734681
> 
> 赞同：0
> 
> 时间：2012-10-04T19:42:43.140
> 
> 标签：c#, .net, winforms, wcf

我的程序分为两部分：

1.  Windows 窗体中的客户端。
2.  使用 WCF 在远程 Web 服务器 (IIS) 上创建的服务器。

客户端将在同一时间用于我的许多不同用户。

我的客户端中有很多 DataGridView。这些 DataGridView 绑定到 Web 服务提供的（不同的）通用对象列表。

我需要经常刷新那些 DataGridView 的内容。我在客户端上使用了一个调用刷新方法的计时器。

但我的问题是：如果我使用 Invalidate()，只会更新当前显示行的内容；如果另一个用户删除或添加一个新对象（行），当前用户将看不到它。如果我通过重新绑定数据来刷新数据，则当前选择会丢失...想象一下如果用户正在更新数据，那将是一场噩梦...（是的，我可以在用户编辑单元格时停止计时器并在用户完成他的操作时重新启动变化，但我希望找到更好的方法！）。

有人看到过这样的问题吗？有人有建议吗？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:10:23.277

你所描述的是一个分布式系统。您需要为此类软件实现锁定和同步。当然你可以把它排除在外，但你的结果将是废话。

1.  Datagridview 应该只用于阅读。
2.  编辑行应在 DGV 之外完成。（如果所有对象都不同，那么你会玩得很开心）
3.  锁定消息应该发送到服务器，服务器会对此进行跟踪。
4.  锁定的对象应该可以被其他用户读取。不写。
5.  需要存在锁定对象的超时。

很抱歉把这个丢给你，但你的问题比你想象的要大得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T23:49:15.377

同意@WozzeC 的回答。数据库锁定是首选解决方案。

但是，如果您不能使用锁定并且不介意对数据库进行更多访问，则可以通过向正在更新的表中添加一列来模拟锁定，将每行中的列设置为某个唯一的会话 ID或当该用户尝试更新/修改该行时的用户 ID。

这需要在用户选择要修改的行时访问数据库，但这具有检查该行是否仍然存在于数据库中的额外好处（即，它没有在几秒钟前被另一个用户删除）。

当然，由于这不是真正的数据库锁定，因此您必须担心用户会话终止（即，他们的 PC 崩溃）而没有释放他正在修改的行。向表中添加了“结帐”时间戳列，允许您允许用户的锁定在一段合理的时间（例如，20 分钟）后超时。

同样，这种方法也不是没有问题，但它可能会给你足够的你想要达到的目标。

**附录**

如果您无法将列添加到正在修改的表中，则可能必须添加存储用户伪锁的全新表。当然，这意味着所有修改表的应用程序都必须配合并且也使用伪锁表。

# javascript - InsertBefore 排序表中的行

> ID：12734682
> 
> 赞同：1
> 
> 时间：2012-10-04T19:42:43.507
> 
> 标签：javascript

我有表，我需要按可用索引（仅 VanilaJS 而不是 jQuery）对第列进行排序（排序）。我该怎么做？请参阅示例[http://jsfiddle.net/mcqueen/AXF2Y/3/](http://jsfiddle.net/mcqueen/AXF2Y/3/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:04:15.830

我会这样做：

```
var positions = [1, 4, 2, 0, 5, 3],
    tr = document.getElementById('table-id').tHead.rows[0],
    cells = [].slice.call(tr.cells);

positions.forEach(function(pos, i) {
    tr.insertBefore(cells[pos], tr.cells[i]);
}); 
```

[http://jsfiddle.net/ybr6E/](http://jsfiddle.net/ybr6E/)

有助于从 NodeList 中创建一个数组，因为 NodeList 在您更改 DOM 时会更新。

# c# - 复杂的绑定

> ID：12734691
> 
> 赞同：0
> 
> 时间：2012-10-04T19:43:13.690
> 
> 标签：c#, wpf, data-binding

我正在尝试做一个简单的项目，其中我有一个类，它的一个属性是一个结构。此结构包含一个值。所以我想将一个标签内容绑定到这个值。我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:54:58.867

要添加到上面 AkSki 的答案...

如果您使用双向绑定（读取和写入）或单向源（只写）绑定到结构，它不会像您预期的那样工作。

结构总是按值传递，它们不是按引用传递。这意味着当 WPF 在后台传递它们时，它们将被复制为新值，而不是通过它们的引用传递。这意味着 WPF 将写入副本，而不是原始结构。

执行双向或单向源绑定的唯一方法是绑定到类。

如果您只需要将此结构值显示为只读，请按照上面 AlSki 的回答。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:53:33.453

您需要声明一个 DependencyProperty 以将您的值公开给 WPF 系统。请参阅[依赖属性概述](http://msdn.microsoft.com/en-us/library/ms752914.aspx)。可能值得在类上声明依赖属性并从结构中提取值。

如果您现有的 datat 对象只是用于您的后端数据（或模型），您可能还需要考虑在此之前使用另一个类来暴露给 WPF，这个新类通常称为 ViewModel。查看[MSDN 上的 Josh Smith MVVM](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)以获得很好的解释。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T19:57:47.173

它只是工作。这是一个例子：

风景 ：

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition/>
        </Grid.RowDefinitions>

        <Label Content="{Binding FinalDestination.X}"/>
        <Label Grid.Row="1" Content="{Binding FinalDestination.Y}"/>
    </Grid>
</Window> 
```

视图模型：

```
using System.Windows;

namespace WpfApplication1
{
    public class ViewModel
    {
        public Point FinalDestination { get; private set; }

        public ViewModel()
        {
            FinalDestination = new Point(8, 8);
        }
    }
} 
```

视图的代码隐藏：

```
namespace WpfApplication1
{
    public partial class MainWindow
    {
        public MainWindow()
        {
            InitializeComponent();

            DataContext = new ViewModel();
        }
    }
} 
```

注意：我已经在 .NET 4.5 上的 Visual Studio 2012 中快速构建了这个，但我很确定它适用于旧技术

# java - 使用 ui:include 时 DragDrop 对象为空

> ID：12734693
> 
> 赞同：1
> 
> 时间：2012-10-04T19:43:23.653
> 
> 标签：java, jsf-2, drag-and-drop, richfaces

我在 Richfaces4 和 JSF2 中使用拖放组件。

当我在目标面板中拖放动作（第一个面板）时，一切正常。但是当我尝试将对象（第二个面板）拖放到目标面板时。我得到以下异常：

**例外**

```
debug[16:27:48.572]: Server returned responseText: <?xml version='1.0' encoding='UTF-8'?> <partial-response><error><error-name>class java.lang.NullPointerException</error-name><error-message><![CDATA[]]></error-message></error></partial-response>
info [16:27:48.574]: Element error
<error><error-name>class java.lang.NullPointerException</error-name><error-message><![CDATA[]]></error-message></error>
debug[16:27:48.574]: richfaces.queue: ajax submit error
debug[16:27:48.575]: richfaces.queue: Nothing to submit
error[16:27:48.576]: Received 'error@serverError' event from <div id=dropForm:list:0:j_idt42 class=rf-ind-drag ui-draggable ...>
error[16:27:48.577]: [200] class java.lang.NullPointerException: 
```

**源面板**

```
<rich:panel id="Object">

    <h:dataTable value="#{dropBean.objects}" var="object">
        <h:column>
        <a4j:outputPanel layout="block">
             <rich:dragSource type="#{dropBean.objectType}" dragValue="#{object}" />
             <h:outputText value="#{object}"></h:outputText>
        </a4j:outputPanel>
        </h:column>
        </h:dataTable>
</rich:panel> 
```

**目标面板 1**

```
<h:panelGrid columns="4">
    <rich:panel styleClass="idPanel" >
    <rich:panel>
    <rich:dropTarget acceptedTypes="ACTION" dropListener="#{dropBean.processDrop}" render="editPanel" />
    <rich:tooltip value="Drop here an Action..." />
    <a4j:outputPanel>
    <h:outputText value="#{dropBean.currentLine.action}"></h:outputText>
        </a4j:outputPanel>
    </rich:panel>
    <ui:include src="#{dropBean.pageByAction}" />
    <a4j:commandButton styleClass="opButtons" value="Add Step" action="#{dropBean.saveLine}" render="editPanel" />
</h:panelGrid> 
```

`<ui:include src="#{dropBean.pageByAction}" />`根据我在第一个目标面板中放置的操作，该行会获得正确的页面。

这是包含页面的示例（目标面板 2）：

**目标面板 2**

```
<h:panelGrid columns="3">
     <rich:panel styleClass="itemPanel" bodyClass="itemPanelBody">
     <rich:dropTarget acceptedTypes="OBJECT" dropListener="#{dropBean.processDrop}" render="@form" />
     <rich:tooltip value="Drop here an Object..." />
     <a4j:outputPanel>
     <h:outputText value="#{dropBean.currentLine.object}" />
     </a4j:outputPanel>
     </rich:panel>
</h:panelGrid> 
```

如果我删除`<ui:include src="#{dropBean.pageByAction}" />`并直接插入代码，则删除操作可以正常工作。但是通过这种方式，面板不是动态的。我需要根据我选择的操作生成面板。

我已经尝试过但不起作用的其他事情：

1.  插入 render="@form" "formName" "@all" 试图渲染所有页面。
2.  更改其他组件的数据表，例如 rich:list 和 rich:dataGrid
3.  在放置目标组件中使用立即。

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T14:31:43.243

我已经解决了强制页面刷新的问题。

**当我将对象拖放到目标面板中时，会调用 Backing bean 中的方法。**

```
public void processDrop(DropEvent event) {

    //process event (not relevant code)

    FacesContext context = FacesContext.getCurrentInstance();
    String viewId = context.getViewRoot().getViewId();
    ViewHandler handler = context.getApplication().getViewHandler();
    UIViewRoot root = handler.createView(context, viewId);
    root.setViewId(viewId);
    context.setViewRoot(root);
} 
```

我确信这不是**最好的解决方案**，我仍然要求更好的解决方案。同时，我会坚持下去。

如果有人有更好的解决方案，请告诉我。

# python - 在 Tornado 中将自定义 gen.Tasks 放在哪里？

> ID：12734697
> 
> 赞同：0
> 
> 时间：2012-10-04T19:43:40.610
> 
> 标签：python, asynchronous, tornado

我试图`while`在 Tornado 中运行一个循环，同时保持 WebSocketHandler 处于打开状态。我试图实现gen.Task：

```
class WSHandler(tornado.websocket.WebSocketHandler):
    count = db.my_collection.count() - 1
    cursor = coll.find(tailable=True, await_data=True, skip=count)

    (...)

    @asynchronous
    @gen.engine
    def run(self):
        doc = yield gen.Task(curse)
        self.render(doc)

    def curse(self):
        while WSHandler.cursor.alive:
        try:
            doc = WSHandler.cursor.next()
            return doc

    def render(doc)
        for c in WSHandler.connections:
            c['id'].write_message(doc) 
```

所以，除了保持`WebSocket`开放，`WSHandler`还有这些其他的自定义功能。我需要运行一个常量循环（`curse(self)`）来跟踪 mongodb 的光标 - 并且是异步的，所以它不会阻塞`WebSocketHandler`.

我的设置错了吗？我应该把这些功能放在其他地方吗？（在哪里？）我怎样才能运行无限`while loop`并同时保持开放`WebSocketHandler`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T06:42:49.617

看起来您正在使用 PyMongo，[它会阻止](http://api.mongodb.org/python/1.7/faq.html#how-can-i-use-pymongo-with-an-asynchronous-socket-library-like-twisted). `while`循环也阻塞；把它放在 a`gen.Task`无论如何都没有帮助。`gen.Task`只是回调的糖；它基本上是另一种写作方式：

```
def run(self):
    doc = self.curse(callback=self.render)
    self.render(doc)

def curse(self, callback=None):
    while self.cursor.alive:
        doc = self.cursor.next()
        callback(doc) 
```

Tornado 已经是一个无限的 while 循环；你不能在 Tornado 应用程序中真正拥有另一个，你也不应该。您可以做的是使用异步数据库客户端（例如 asyncmongo），它应该允许您简单地：

```
cursor = coll.find(tailable=True, callback=render, ...) 
```

并在收到文档时触发您的回调方法。

# java - 无法调整硒网格 2 节点上的窗口大小

> ID：12734703
> 
> 赞同：1
> 
> 时间：2012-10-04T19:44:04.103
> 
> 标签：java, selenium, grid, webdriver

我无法调整我的 selenium 网格 2 节点上的 Firefox 窗口大小。我的节点在 ubuntu 12.04 和 firefox 15 上运行。我目前正在使用 selenium-server-standalone-2.25.0.jar。

它适用于我的本地机器（没有硒网格），其中 Firefox 调整到我的窗口大小，但不适用于我的虚拟机（我运行节点的地方）。我使用这种方法来最大化窗口：

```
driver.manage().window().maximize(); 
```

我也尝试过这种方法，但它也不起作用：

```
((JavascriptExecutor)driver).executeScript("window.resizeTo(1920,1080)"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T07:05:27.370

尝试使用这个：

```
WebDriver driver = ((WebDriverBackedSelenium) selenium).getWrappedDriver();
driver.manage().window().setPosition(new Point(0, 0));
driver.manage().window().setSize(new Dimension(1920, 1080)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-22T21:09:51.833

Selenium 具有修改窗口尺寸的能力：

```
driver.manage().window()
            .setSize(new Dimension(width, height)); 
```

确保在使用 .maximize 或 .setSize 修改窗口大小之前获取 URL。

```
driver.get(url);
driver.manage().window().maximize(); 
```

如果您没有从这些建议中看到改进，我建议您逐步调试脚本。如果它通过窗口大小调整命令而没有错误或其他奇怪的行为，那么我真的会被难住。

# c++ - 本地数据库的密码解决方案，在客户端和服务器之间传递

> ID：12734705
> 
> 赞同：1
> 
> 时间：2012-10-04T19:44:13.257
> 
> 标签：c++, security, passwords, sql-server-ce

我一直在做一个项目，该项目使用在需要离线工作的客户端和存储信息数据库的服务器之间发送的 sqlce 数据库，该数据库受密码保护。

困难的部分是，我们有一个业务需求，即用户在报告sqlce数据库中的信息之前不必更新到最新版本，甚至可能落后于最新版本的客户端和可能更新的几代服务器访问数据库中上报信息所需的密码。

我们当前的解决方案是在源代码中、客户端和服务器上使用相同的静态密码，并保持它们相同以实现向后兼容性。

**我的问题是关于在客户端和服务器之间同步密码并保持对旧数据库的向后兼容性或能够从数据库中获取一些参数以查看应该匹配的密码的安全方法。**

我们目前使用 sql ce 3.1 和 C++。欢迎使用其他技术（SQLight？C#？Java？）中相同问题的解决方案，因为我认为该问题可以应用于其他项目。

我希望我的问题很清楚，并且那里有很多答案，如果有什么我需要澄清的就问我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:52:11.063

您需要通过密钥交换进行公钥加密。我们有一个支持这一点的安全服务器（带有 SOAP 接口的 Java 程序）。有满足此要求的商业产品——您必须将它们集成到您的系统中。密码永远不应该像那样到处都是硬编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T19:52:34.757

我建议用户，每个登录 SQL 的用户在数据库中都有自己的用户，因此它可以维护自己的密码。您作为在用户会话之外执行某些操作的代码，可以使用存储在配置文件中的可配置连接字符串来管理您的密码，并且由于某些工具用户可以更新它，因此例如管理员可以随时更改他/她的密码数据库和您的代码可以正常工作。另一方面，如果您有服务器/客户端设计，那么服务器可以使用可信连接并通过登录用户维护其安全性，并且永远不需要将密码保存在代码中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-05T13:38:04.363

所以有几件事。
1）永远不要在源代码中硬编码密码，像我这样的人会找到它们。
2）服务器不应访问客户端数据库，客户端应始终向服务器报告。

现在有了这些信息，我将重新构建我的设置，使其符合以下原则：

每个客户都会发送每日、每周或您用来获取报告的任何时间指标。这缓解了有关密码管理的任何问题。同样通过这样做，服务器可以保留允许客户端的白名单，这可以防止未经授权或无效的客户端向主服务器报告。现在使用它并不重要，因为服务器肯定不关心客户端落后多远，并且您的消息传递结构不应该改变那么多。如果是这样，您可能应该强制客户端更新。

# javascript - 查找 HTML 表中是否存在列

> ID：12734708
> 
> 赞同：-1
> 
> 时间：2012-10-04T19:44:20.280
> 
> 标签：javascript, jquery

如何使用 JQuery 检查 HTML 表中是否存在列。

我正在我的服务器端创建一个动态表，需要检查 HTML 表中是否存在列并基于此执行回调。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T19:46:56.040

如果您可以动态创建 HTML 表格，则可以将 id 或类附加到每一列。

你可以得到特定元素的数量：`$('element').size();` 所以你可以检查这是否等于零。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:46:26.070

为什么不在服务器返回列后给每个人一个 id 然后只做一个

```
$("#idhere") 
```

# node.js - 在 node.js 编程中，如何处理回调不触发的场景？

> ID：12734712
> 
> 赞同：3
> 
> 时间：2012-10-04T19:44:38.330
> 
> 标签：node.js

node.js 中一个常用的异步函数调用习惯用法是这样使用回调函数：

```
library.doSomething(params, function(err,result) {
    if (err) {
        ... handle error, retry etc
    } else {
        ... process results, be happy!
    }
}); 
```

太好了 - 你调用一些东西，然后处理结果或错误。不幸的是，排除了第三个选项......您调用的代码永远不会执行您的回调。处理回调永远不会被调用的可能性的最佳方法是什么？

很多时候，特别是如果您正在编写一个依赖于网络的库，您需要保证您将调用一次且仅一次传递给您的任何回调。考虑到这一点，这样的模式看起来像是要走的路：

```
// set a timout
var failed = false, callbackFailure = setTimeout(function() {
    ... handle failure, call further pending callbacks with a timeout error
    failed = true;
},30000);

library.doSomething(params, function(err,result) {
    if (!failed) {
        clearTimeout(callbackFailure);
        if (err) {
            ... handle error, retry etc
        } else {
            ... process results, be happy again!
        }
    }
}); 
```

任何你期望触发的回调实际上都会触发，这似乎是一个信仰问题，我相信所有程序员都遇到过回调根本无法执行的场景——宇宙射线、太阳黑子、网络故障、错误第三方库，或者...*喘不过气来*...您自己的代码中的错误。

像我的代码示例这样的东西实际上是一个很好的实践，还是 node.js 社区已经找到了更好的方法来处理它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T09:52:12.180

不看 paddle 似乎很容易为编写或调试错误的代码创建回调执行保险。

像这样的函数：

```
// requireCB:
//   timeout - milliseconds before insurance gets used
//   cb - callback function to invoke normally or when insurance expires
function requireCB(timeout, cb) {
    var timeoutTimer;
    var canBeCalled = false;
    var myCB = function () {
        if (timeoutTimer) { clearTimeout(timeoutTimer); timeoutTimer = 0; }
        if (canBeCalled) { canBeCalled = false; cb.apply(this, arguments); }
    };
    timeoutTimer = setTimeout(function () { myCB(new Error('timed out')) }, timeout);
    canBeCalled = true;
    return myCB;
} 
```

我们创建可以像这样使用的保险小部件：

```
var rcb = requireCB(100, function (err, data1, data2) {
    console.log('called, err =', err, ', data1 =', data1, ', data2 =', data2);
});
functionExpectedToInvokeCallback(rcb); 
```

或者在一个实际可立即运行的示例中：

```
var rcb = requireCB(100, function (err, data) {  // set insurance for 0.1 seconds
    console.log('called, err =', err, ', data =', data);
});
setTimeout(function () { rcb(undefined, 'sheep') }, 1000);  // set normal callback in 1 second 
```

翻转超时值以不触发保险。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T22:33:56.757

我不确定它去了哪里，但是这里突然出现了一个答案，并带有指向[https://github.com/andyet/paddle](https://github.com/andyet/paddle)的链接消失了- 一个旨在提供回调执行“保险”的小型库。至少它表明我不是第一个对这个问题挠头的人。

从文档中有一个轶事在一定程度上验证了这个问题：

> 众所周知，Node.js 有一个 http 客户端，但如果响应太快，有时 HTTP 请求不会发生回调。如果我想确保我的 http 客户端回调发生。

他们给出的示例比我的示例稍微复杂一些，并且可以处理基于事件的回调，使代码能够定期“签入”作为中间活动，如 ondata 处理程序触发，然后在停止或超时时触发错误。

```
setTimeout(function() {
    paddle.stop();
}, 12000);

var req = http.get(options, function(res) {
    var http_insurance = paddle.insure(function(res) {
        console.log("The request never had body events!");
        console.log('STATUS: ' + res.statusCode);
        console.log('HEADERS: ' + JSON.stringify(res.headers));
    }, 9, [res]);
    res.setEncoding('utf8');
    res.on('data', function (chunk) {
        console.log('BODY: ' + chunk);
        http_insurance.check_in();
    });
});
req.end(); 
```

我在这里回答我自己的问题，但我仍然有兴趣查看是否存在任何其他实现、库或模式来解决相同的问题。

# jquery - jQuery AJAX 错误处理（HTTP 状态码）

> ID：12734714
> 
> 赞同：33
> 
> 时间：2012-10-04T19:44:47.507
> 
> 标签：jquery, ajax, error-handling

我们有一个 API，它使用正确的 HTTP 状态代码来处理错误，并使用 JSON 编码的响应和适当的`Content-Type`标头进行响应。我的情况是当它遇到 HTTP 错误状态时`jQuery.ajax()`触发回调，而不是回调，所以即使我们有一个可理解的 JSON 响应，我们也不得不求助于这样的事情：`error``success`

```
$.ajax({
    // ...
    success: function(response) {
        if (response.success) {
            console.log('Success!');
            console.log(response.data);
        } else {
            console.log('Failure!');
            console.log(response.error);
        }
    },
    error: function(xhr, status, text) {
        var response = $.parseJSON(xhr.responseText);

        console.log('Failure!');

        if (response) {
            console.log(response.error);
        } else {
            // This would mean an invalid response from the server - maybe the site went down or whatever...
        }
    }
}); 
```

`jQuery.ajax()`有没有比在每次调用的两个位置进行相同的错误处理更好的范例？它不是很干燥，而且我确信在这些情况下我错过了一些关于良好错误处理实践的东西。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-10-04T20:18:41.437

查看[`jQuery.ajaxError()`](http://api.jquery.com/ajaxError/)

它捕获全局 Ajax 错误，您可以通过多种方式处理这些错误：

```
if (jqXHR.status == 500) {
  // Server side error
} else if (jqXHR.status == 404) {
  // Not found
} else if {
    ... 
```

或者，您可以自己创建一个全局错误处理程序对象并选择是否调用它：

```
function handleAjaxError(jqXHR, textStatus, errorThrown) {
    // do something
}

$.ajax({
    ...
    success: function() { ... },
    error: handleAjaxError
}); 
```

# tsql - 有没有办法将 WMI 数据导入 T-SQL

> ID：12734719
> 
> 赞同：2
> 
> 时间：2012-10-04T19:45:03.460
> 
> 标签：tsql, wmi, monitor, wmi-query

以下是示例 VBScript 中用于通过 WMI 接口获取 Biztalk 挂起实例的类似 SQL 的命令。

```
select * from MSBTS_serviceinstance where ServiceStatus=4 
```

MSBTS_serviceinstance 不是一个表，它是一个 WMI 类，定义如下：http: [//msdn.microsoft.com/en-us/library/aa560069%28v=BTS.70%29.aspx](http://msdn.microsoft.com/en-us/library/aa560069%28v=BTS.70%29.aspx)

它在 VBScript 中使用如下：

```
 sQuery  = "select * from MSBTS_serviceinstance where ServiceStatus=4 and ErrorId ='" & sErrorCode & "'"   
  Set intSet = GetObject("Winmgmts:!root\MicrosoftBizTalkServer").ExecQuery(sQuery)
  ' then you have to loop through the results 
```

有没有办法直接从 T-SQL 运行类似的命令。如果我可以从 T-SQL 获取这些数据并将其存储在一个表中，那么我就不必编写 C# 或 VBScript 程序，我们的 DBA 也可以理解并帮助维护代码。这是为了监控和创建警报；到目前为止，这主要由 SQL 代理作业完成。[几周或几个月后，我们可能会使用猎户座的太阳风进行更多监测，但我需要尽快创建快速警报。]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-12-14T22:13:56.227

据我所知，没有办法*直接*从 T-SQL 中“查询”WMI 类。要运行 WMI 查询，您需要利用 WMI 基础结构，这通常由 .Net Framework 应用程序、脚本语言等完成。但是，您可以从 T-SQL *间接访问 WMI。*

在我们开始之前，先说几句话`xp_cmdshell`。我既不提倡也不反对扩展存储过程的启用和使用。该答案仅显示了特定用例的可能性。可以启用`xp_cmdshell`吗？[自己决定](https://www.google.com/search?q=risks%20of%20xp_cmdshell)。

如果尚未启用，[请启用`xp_cmdshell`](https://msdn.microsoft.com/en-us/library/ms190693.aspx). 我们`WMIC.exe`将按如下方式运行，并将输出作为原始“XML”捕获到临时表。之后，我们将获取“XML 数据”并将其转换为强类型的实际 XML 数据，并将其分解。我们在结果集中取回强类型数据，`Win32_Process`类的每个字段对应一列。

参考： [SQL Server 内部的 WMI 查询...排序](http://itsalljustelectrons.blogspot.com/2015/12/wmi-queries-from-within-sql-server.html)

```
CREATE TABLE #WMIC (
    ID INT IDENTITY PRIMARY KEY,
    CmdOutput VARCHAR(1000)
)

INSERT INTO #WMIC (CmdOutput)
EXECUTE master..xp_cmdshell 'WMIC.exe MSBTS_serviceinstance get Name,ServiceName,ServiceStatus,SuspendTime /FORMAT:RAWXML'

DECLARE @Cmd VARCHAR(MAX) = ''
DECLARE @Xml XML

SELECT @Cmd = @Cmd + COALESCE(w.CmdOutput, '') 
FROM #WMIC w
ORDER BY w.ID

SET @Xml = CAST(@Cmd AS XML)

SELECT
    Name = BT_Service.value('(PROPERTY[@NAME="Name"]/VALUE)[1]', 'VARCHAR(512)'),
    ServiceName = BT_Service.value('(PROPERTY[@NAME="ServiceName"]/VALUE)[1]', 'VARCHAR(512)'),
    ServiceStatus = BT_Service.value('(PROPERTY[@NAME="ServiceStatus"]/VALUE)[1]', 'INT'),
    SuspendTime = BT_Service.value('(PROPERTY[@NAME="SuspendTime"]/VALUE)[1]', 'DATETIME')
FROM @Xml.nodes('/COMMAND/RESULTS/CIM/INSTANCE') AS WmiTbl(BT_Service)
WHERE BT_Service.value('(PROPERTY[@NAME="ServiceStatus"]/VALUE)[1]', 'INT') = 4

DROP TABLE #WMIC 
```

**笔记：**

1.  我没有安装 BizTalk 的服务器，所以我无法测试/验证上面的代码。区分大小写可能存在一些问题……毕竟是 XML。
2.  完成后不要忘记禁用`xp_cmdshell`！

# c# - 为什么日期格式 dd/MM/yy 也显示时间？

> ID：12734720
> 
> 赞同：0
> 
> 时间：2012-10-04T19:45:09.063
> 
> 标签：c#, .net

我想使用“dd/MM/yy”，但它也显示时间。

怎么可能？

例如“dd MMMM, yyyy”不会显示任何时间。

谢谢！！！

代码

```
 var completeDate = DateTime.Now.ToString("dd/MM/yy"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:49:42.733

实际上，根据[MSDN](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx) ，如果您不想要时间格式，您可以使用标准格式“d” 。如果您查看他们的[标准日期和时间格式](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx)，您会发现还有一种方法可以更改文化信息以获得您想要的。

```
var completeDate = DateTime.Now.ToString("d"); 
```

编辑添加：

要回答为什么你的斜杠不起作用的问题... [““/”自定义格式说明符表示日期分隔符，用于区分年、月和日。从 DateTimeFormatInfoDateSeparator 中检索适当的本地化日期分隔符当前或指定区域性的属性。如果在没有其他自定义格式说明符的情况下使用“/”格式说明符，则将其解释为标准日期和时间格式说明符并引发 FormatException。有关使用单个格式说明符的更多信息，请参阅在本主题后面使用单个自定义格式说明符。”](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx#dateSeparator)

```
DateTime thisDate = new DateTime(2008, 3, 15);
CultureInfo culture = new CultureInfo("en-US");      
Console.WriteLine(thisDate.ToString("d", culture));  // Displays 15/3/2008 
```

编辑以解决评论：要回答有关您为什么要获得时间格式的问题，是您计算机上的默认文化信息与您输入的格式字符串不匹配。我找不到原因，但我也这样做不知道您的计算机设置为哪种文化。发生这种情况时，它可能会默认返回到一般的 ShortTime 格式，或“g”，它也包括时间，并且是你在执行 DateTime.ToString() 时得到的，但它应该抛出一个 FormatException。

我将最后一部分添加为一种实际答案，尽管我发现当我花时间获得对实际回答的参考时，这个问题毫无价值......如果这就是某人想要的，那么他们不应该问需要答案的问题像这样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T20:36:52.380

这是另一种选择。它不包括时间，将所有内容都放在一行中......并让您在格式字符串中保留斜杠。

```
string a = String.Format("{0:MM/dd/yy}", DateTime.Now); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T22:05:24.980

如果您不想要时间字符串，为什么不直接使用`DateTime.Today.ToString("dd/MM/yy")`

# java - 字符串替换方法不替换字符

> ID：12734721
> 
> 赞同：83
> 
> 时间：2012-10-04T19:45:12.810
> 
> 标签：java, string, replace

我有一个作为字符串传入的句子，我正在替换单词“and”，我想用“”替换它。它并没有用空格替换“和”这个词。下面是我的逻辑的一个例子。当我调试这个时，逻辑确实落入了 sentence.replace 中。

```
String sentence = "Define, Measure, Analyze, Design and Verify"
if (sentence.contains("and")){
    sentence.replace("and", " ");
} 
```

有什么我在这里想念的吗。

* * *

## 回答 #1

> 赞同：176
> 
> 时间：2012-10-04T19:46:08.317

> 当我调试这个时，逻辑确实落入了 sentence.replace 中。

是的，然后你丢弃返回值。

Java 中的字符串是不可变的 - 当您调用 时`replace`，它不会更改*现有*字符串的内容 - 它会返回一个带有修改的*新字符串。*所以你要：

```
sentence = sentence.replace("and", " "); 
```

这适用于 String (等)中的*所有方法。**它们都不会*更改字符串的内容。`substring``toLowerCase`

 *请注意，您实际上并不需要在条件中执行此操作 - 毕竟，如果句子*不*包含`"and"`，则执行替换没有害处：

```
String sentence = "Define, Measure, Analyze, Design and Verify";
sentence = sentence.replace("and", " "); 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2012-10-04T19:47:29.300

字符串是*不可变*的，这意味着它们的内容不能改变。当你打电话给你时，你`replace(this,that)`会得到一个全新的字符串。如果要保留此新副本，则需要将其分配给变量。您可以覆盖旧参考（`sentence = sentence.replace(this,that)`如下所示的 la 或新参考：

```
public class Test{

    public static void main(String[] args) {

        String sentence = "Define, Measure, Analyze, Design and Verify";

        String replaced = sentence.replace("and", "");
        System.out.println(replaced);

    }
} 
```

顺便说一句，请注意我已经删除了`contains()`支票，因为这是一个不必要的电话。如果它不包含它，则替换将无法进行任何替换。如果您要替换的内容与您正在检查的实际条件不同，您只需要包含方法。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-10-04T19:46:21.410

您没有对 . 的返回值做任何事情`replace`。您需要分配方法的结果，即新的`String`：

```
sentence = sentence.replace("and", " "); 
```

A`String`在 java 中是不可变的。方法如`replace`返回一个新的`String`.

您的`contains`测试是不必要的：`replace`如果没有要替换的文本实例，*则不会执行任何操作。*

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-10-04T19:46:21.720

您应该重新分配替换的结果，如下所示：

```
 sentence = sentence.replace("and", " "); 
```

请注意，`String`该类是[不可变](https://en.wikipedia.org/wiki/Immutable_object)的，这意味着它的*所有*方法都返回一个新字符串并且永远不会就地修改原始字符串，因此在实例中调用方法的结果`String`必须分配给变量或立即用于更改生效。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-05-05T02:21:36.373

```
package com.tulu.ds;

public class EmailSecurity {
    public static void main(String[] args) {
        System.out.println(returnSecuredEmailID("sample717@gmail.com"));
    }
    private static String returnSecuredEmailID(String email){
        String str=email.substring(1, email.lastIndexOf("@")-1);
        return email.replaceAll(email.substring(1, email.lastIndexOf("@")-1),replacewith(str.length(),"*"));
    }
    private static String replacewith(int length,String replace) {
        String finalStr="";
        for(int i=0;i<length;i++){
            finalStr+=replace;
        }
        return finalStr;
    }   
} 
```*

# javascript - 如何检查 contenteditable div 中光标下的文本是否为“粗体”

> ID：12734722
> 
> 赞同：6
> 
> 时间：2012-10-04T19:45:24.787
> 
> 标签：javascript, html, contenteditable

> **可能重复：**
> [识别网页中所选文本是否为粗体](https://stackoverflow.com/questions/3404618/identify-whether-the-selected-text-in-a-web-page-is-bold-nor-not)

我创建了一个内容可编辑的 div，这很简单。

我还在 div 的顶部添加了一个控件来加粗和取消加粗文本。

现在，我想根据光标下文本的粗体状态设置按钮的样式 - 即：如果光标下的文本是粗体，我希望粗体图标具有边框“插入”......如果它是不粗体，我希望粗体图标没有边框。

如何检查光标下元素的样式？

链接到现在的代码：http: [//jsfiddle.net/aCp7M/](http://jsfiddle.net/aCp7M/)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-04T20:35:56.283

你在这里：http: [//jsfiddle.net/vvCzD/](http://jsfiddle.net/vvCzD/)

用于`document.queryCommandValue("Bold")`检查插入符号位置的文本是否为粗体等。[此处](http://msdn.microsoft.com/en-us/library/ie/ms533049%28v=vs.85%29.aspx)描述了所有可能的命令标识符。

* * *

**UPD：** 正如 Tim 下面所述，获取类似布尔属性的正确方法是`queryCommandState`.

# c# - 在单元测试项目中获取具有属性的程序集

> ID：12734724
> 
> 赞同：2
> 
> 时间：2012-10-04T19:45:30.803
> 
> 标签：c#, unit-testing, reflection

是否可以获得应用了自定义属性的所有引用程序集（在单元测试项目中）。我在成功运行的应用程序中使用以下代码：

```
var assemblies = System.Web.Compilation.BuildManager.GetReferencedAssemblies().Cast<Assembly>().Where(a => a.GetCustomAttributes(false).OfType<AssemblyCategoryAttribute>().Any()).ToList(); 
```

但是 System.Web.Compilation.BuildManager 在我的测试项目中不起作用，所以我尝试了：

```
Assembly.GetExecutingAssembly().GetReferencedAssemblies().Select(a => Assembly.ReflectionOnlyLoad(a.FullName).Where(a => a.GetCustomAttributes(false).OfType<AssemblyCategoryAttribute>().Any()).ToList(); 
```

但这引发了错误：

> 反射通过 ReflectionOnlyGetType 加载的类型的自定义属性是非法的（请参阅 Assembly.ReflectionOnly）——请改用 CustomAttributeData。

如果有人能告诉我如何做到这一点，我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T20:12:10.717

由于您正在获取当前正在执行的程序集的引用程序集，因此没有理由进行仅反射加载。 `ReflectionOnlyLoad`用于当您想要查看程序集但不实际执行它们时。由于当前正在执行的程序集正在引用这些程序集，因此很可能已经或将要加载到执行上下文中。

试着做：

```
Assembly
    .GetExecutingAssembly()
    .GetReferencedAssemblies()
    .Select(a => Assembly.Load(a.FullName))
    .Where(a => a.
            .GetCustomAttributes(false)
            .OfType<AssemblyCategoryAttribute>()
            .Any())
    .ToList(); 
```

或者更好：

```
Assembly
    .GetExecutingAssembly()
    .GetReferencedAssemblies()
    .Select(Assembly.Load)
    .Where(a => a.IsDefined(typeof(AssemblyCategoryAttribute), false))
    .ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T19:48:44.277

查看[**CustomAttributeData 类**](http://msdn.microsoft.com/en-us/library/system.reflection.customattributedata.aspx)

提供对加载到仅反射上下文中的程序集、模块、类型、成员和参数的自定义属性数据的访问。

那里有一个示例 c# 代码

```
public static void Main()
{
    Assembly asm = Assembly.ReflectionOnlyLoad("Source");
    Type t = asm.GetType("Test");
    MethodInfo m = t.GetMethod("TestMethod");
    ParameterInfo[] p = m.GetParameters();

    Console.WriteLine("\r\nAttributes for assembly: '{0}'", asm);
    ShowAttributeData(CustomAttributeData.GetCustomAttributes(asm));
    Console.WriteLine("\r\nAttributes for type: '{0}'", t);
    ShowAttributeData(CustomAttributeData.GetCustomAttributes(t));
    Console.WriteLine("\r\nAttributes for member: '{0}'", m);
    ShowAttributeData(CustomAttributeData.GetCustomAttributes(m));
    Console.WriteLine("\r\nAttributes for parameter: '{0}'", p);
    ShowAttributeData(CustomAttributeData.GetCustomAttributes(p[0]));
} 
```

在你的情况下是这样的（我自己没有尝试代码）：

```
var assemblies = Assembly.GetExecutingAssembly()
    .GetReferencedAssemblies()
    .Select(a => Assembly.ReflectionOnlyLoad(a.FullName))
    .Select(a => new 
      { Asm = a, 
        CustomAttributeDataList = CustomAttributeData.GetCustomAttributes(a)
      })
    .Where(x => x.CustomAttributeDataList.Any(y => y.AttributeType ==           
         type(AssemblyCategoryAttribute)))
    .Select(x => x.Asm)
    .ToList(); 
```

# c++ - 获取用户友好的文件类型描述的跨平台方式

> ID：12734727
> 
> 赞同：0
> 
> 时间：2012-10-04T19:45:45.560
> 
> 标签：c++, windows, macos, qt

获取用户友好的文件描述的跨平台方法是什么？

例子：

1.  foo.pdf -> "可移植文档格式 (PDF)
2.  bar.doc -> "Microsoft Word 文档"

指向库或适当系统 API 的指针将不胜感激。

首选 Qt/C++ 解决方案，但一切都很好。

目标平台是 Windows 和 Mac OS X。如果可能的话，我希望描述与在 Explorer 或 Finder 中找到的内容相匹配（而不是自己维护扩展映射 -> 描述）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:02:17.887

我认为您可以从 Qt 中获得的最接近的是[QFileInfo](http://qt-project.org/doc/qt-4.8/QFileInfo.html)。

Windows 通过可以通过 Qt 的[QSettings](http://qt-project.org/doc/qt-4.8/qsettings.html)访问的注册表跟踪映射。但仅从[简短的研究](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/630ed1d9-73f1-4cc0-bc84-04f29cffc13b/)来看，模仿 Explorer 的映射可能有点棘手。

您还可以使用[QDesktopServices::openUrl()](http://qt-project.org/doc/qt-4.8/qdesktopservices.html#openUrl)使用默认处理程序启动文件。

我还没有研究过 OSX 如何或在何处跟踪文件类型描述信息。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T20:26:05.820

GNU File 命令是为 Linux 和 OSX 内置的，并且有一个适用于 Windows 的版本（[http://gnuwin32.sourceforge.net/packages/file.htm](http://gnuwin32.sourceforge.net/packages/file.htm)）。

> File 测试每个参数以尝试对其进行分类。共有三组测试，按此顺序执行：文件系统测试、幻数测试和语言测试。第一个成功的测试会导致打印文件类型。打印的类型通常包含以下文字之一：文本（文件仅包含打印字符和一些常见的控制字符，并且可能在 ASCII 终端上可以安全阅读）、可执行文件（文件包含以表格形式编译程序的结果）某些 UNIX 内核或其他内核可以理解），或者数据意味着其他任何东西（数据通常是“二进制”或不可打印的）。已知包含二进制数据的文件格式（核心文件、tar 档案）除外。

您可以使用 QProcess 调用文件命令并显示返回的信息。

输出看起来像：

```
$ file document.pdf
document.pdf: PDF document, version 1.5
$ file test.txt
test.txt: ASCII text, with CRLF, CR, LF line terminators 
```

# c# - Hyper-V RequestStateChange 返回未记录的值

> ID：12734729
> 
> 赞同：0
> 
> 时间：2012-10-04T19:45:56.837
> 
> 标签：c#, hyper-v

我正在尝试使用 C# 的 System.Management API 以编程方式启动 Hyper-V VM。我在创建和配置 VM 方面取得了巨大成功，但事实证明，启动 VM 是难以捉摸的。

我得到一个 Msvm_ComputerSystem 对象，使用辅助方法执行 WQL 查询：

```
ManagementObject compSys = WMIHelpers.GetMsvm_ComputerSystem(scope, vmName); 
```

更改 VM 状态的方法是（据称）“RequestStateChange”，我能够获取参数对象并设置它们：

```
ManagementBaseObject callParams = compSys.GetMethodParameters("RequestStateChange");
callParams["RequestedState"] = WMIHelpers.RequestedState.Enabled; 
```

但是，当我调用该方法时，我的返回值为 1，这是未记录的：

```
ManagementBaseObject result = vsServ.InvokeMethod("RequestStateChange", callParams, null);

if(result["ReturnValue"] == 1)
{
    System.Console.WriteLine("WTF?!?");
} 
```

我不知道我在这里做错了什么，或者为什么我会得到这个未记录的返回值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T08:49:35.693

我建议阅读下面的链接，因为我在尝试从 c# 启动 hyper-v 时发现这很有帮助

[http://msdn.microsoft.com/en-us/library/cc723874(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/cc723874(v=vs.85).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-08T21:04:42.017

这个问题有点老了，但我遇到了同样的问题并找到了解决方案。

作为参考，MSDN 中 WMIv1 的文章命名为 cc______，而 W​​MIv2 的文章命名为 hh______

[WMIv1](http://msdn.microsoft.com/en-us/library/cc723874(v=vs.85).aspx) [WMIv2](https://msdn.microsoft.com/en-us/library/hh850279(v=vs.85).aspx)

出现此错误的原因是因为我通过代码创建了我的 VM，并且默认情况下 Msvm_ComputerSystem 的 AvailableRequestedStates 为空值。随后，当调用 RequestStateChange 时，它​​返回一个 1，这是未记录的。

要解决此问题，请在调用 RequestStateChange 之前使用所有可用状态填充 Msvm_ComputerSystem：

```
UInt16[] availableRequestedStates = { 2, 3, 4, 6, 7, 8, 9, 10, 11 };
compSystem["AvailableRequestedStates"] = availableRequestedStates;
compSystem.Put();

ManagementBaseObject inParams = compSystem.GetMethodParameters("RequestStateChange");
inParams["RequestedState"] = 2;
ManagementBaseObject result = compSystem.InvokeMethod("RequestStateChange", inParams, null); 
```

# vim - Vim 用随机生成的数字替换正则表达式

> ID：12734733
> 
> 赞同：16
> 
> 时间：2012-10-04T19:46:09.897
> 
> 标签：vim

是否可以在 Vim 中用随机生成的数字替换正则表达式？对于与正则表达式匹配的每个模式，要替换的（随机）数字应该不同。这是我需要的一个例子。

输入文件：

```
<a>XYZ</a>
<a>XYZ</a>
<a>XYZ</a>
<a>XYZ</a> 
```

用随机数替换 XYZ 后，输出可能是：

```
<a>599</a>  
<a>14253</a>    
<a>1718</a>
<a>3064</a> 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-10-04T20:04:36.427

如果你不介意在你的 vim 中使用一点 perl，你可以使用

```
:%! perl -pne 's/XYZ/int(rand 1000)/ge' 
```

编辑：根据@hobbes3 的建议，更新为允许在给定行上进行无限替换，所以

```
XYZ XYZ
XYZ XYZ XYZ 
XYZ XYZ XYZ XYZ XYZ XYZ
XYZ XYZ 
```

变成类似的东西

```
86 988
677 477 394 
199 821 193 649 502 471
732 208 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-04T19:59:52.367

试试这个：将下面的代码放到一个缓冲区中，然后获取它（`:source %`）。

```
let rnd = localtime() % 0x10000 

function! Random() 
  let g:rnd = (g:rnd * 31421 + 6927) % 0x10000 
  return g:rnd 
endfun 

function! Choose(n) " 0 n within 
  return (Random() * a:n) / 0x10000 
endfun 
```

然后你可以这样做：

```
:s_\(<a>\).*\(</a>\)_\1\=Choose(line('.')*100).\2_ 
```

# ruby-on-rails - Rails 3 链式关联和范围

> ID：12734735
> 
> 赞同：0
> 
> 时间：2012-10-04T19:46:13.240
> 
> 标签：ruby-on-rails, ruby, activerecord

我有`Project`和`Entry`作为模型。项目可以有很多条目，而条目只属于一个项目。条目有日期。

一项报告要求是显示具有特定月份条目的项目。我已经成功地使用范围来实现这一点，即`Project.with_entries.on(param_the_month)`.

问题是我现在只想显示该月的条目，按项目分组。如果我这样做`projects.each do |p|`，则查询条目 ( `p.entries`)，返回的条目是所有月份的，而不仅仅是我指定的月份。

虽然这是一个明显的结果，但 Rails 中有没有一种方法可以使用我原来的链式作用域简单地返回该月的条目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:52:45.313

**编辑**：我确实误解了:)

采取 2：您可以跨模型合并范围。因此，如果您可以创建一个`where`-type 范围`Entry`以从给定月份中选择条目，那么您可以尝试类似

```
Project.with_entries.on(param_the_month).merge(Entry.on(param_the_month)) 
```

我已经`on`通过与您的范围类比来称呼它`Project`-没有看到您的数据模型，我无法确切地说明如何实现它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T19:51:14.710

`has-many`关联也接受范围，因此您可以`projects.entries.your_scope`过滤它们。缺点是这将需要对每个项目进行另一个数据库查询，这可能会很慢，具体取决于数据库的大小。

另一种不需要额外查询的方法是获取已过滤的条目，然后向上获取项目：

```
entries = Entry.my_conditions.includes(:project)
entries_by_project = entries.group_by(&:project) 
```

现在您有一个哈希，其键是项目，而值只是该项目中通过您的条件的条目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T19:51:34.383

您可以将包含添加到您的范围中，这样它就不会再次查询这些记录，它会在您使用项目范围时立即加载它们。

```
scope :my_scope, includes(:entries).where( :active => true ) 
```

# php - 如何高效返回数据库数据

> ID：12734742
> 
> 赞同：0
> 
> 时间：2012-10-04T19:46:24.900
> 
> 标签：php, javascript, jquery

我正在尝试通过来自服务器的 ajax 调用传递大量数据。

我有

```
foreach ($results as $field){

    $data[]=$fieldName=array('ID'=> $field['ID'], 'Text'=> $field['Text']...and so much more);

} 
```

我需要显示字段名称 ( `ID`) 和数据 ( `$field['ID'`])。有没有更快的方法来做到这一点，而无需在我的数组中手动​​添加这么多字段？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:49:00.593

您可以在查询中仅选择您真正需要的字段，例如

```
SELECT field1, field2, field3 ... 
```

代替

```
SELECT * 
```

然后你可以简单地做

```
while($row = fetch_from_db($result)) {
   $data[] = $row;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:49:52.833

这不等于：

```
foreach ($results as $field){
    $data[] = $field;
} 
```

如果它是一个期望 JSON 的 AJAX 请求，那么只需在一个函数调用中对整个内容进行编码：

```
json_encode($results); 
```

# python - 当模块同名时导入python包

> ID：12734744
> 
> 赞同：4
> 
> 时间：2012-10-04T19:46:29.433
> 
> 标签：python, module, namespaces

我有一个模块`blah.time`，我在其中围绕正常的时间和日期操作进行一些健全性检查和包装功能：

```
import time

def sleep(n):
    time.sleep(n) 
```

当我调用时`sleep`，它只会引发最大递归错误。我猜命名空间是错误的，所以我尝试使用`import time as _time`，但我仍然得到同样的错误。

如何`time`从我自己的模块中引用系统模块以防止此命名空间冲突？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-04T19:51:23.077

添加`from __future__ import absolute_import`为文件的第一行。

这将强制所有导入都是绝对的，而不是相对的。因此`import time`将导入标准模块，以导入您将使用的本地模块`from . import foobar`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T19:51:56.277

我会阅读[http://docs.python.org/whatsnew/2.5.html#pep-328-absolute-and-relative-imports](http://docs.python.org/whatsnew/2.5.html#pep-328-absolute-and-relative-imports)然后使用`from __future__ import absolute_import`.

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T20:00:28.333

发生的事情是您的`time`模块正在遮蔽系统`time`模块。解决此问题的最简单方法是将模块重命名为`time`.

# java - Android - 添加 DateSlider 对话框以查看

> ID：12734747
> 
> 赞同：0
> 
> 时间：2012-10-04T19:46:48.223
> 
> 标签：java, android, view, dialog, datepicker

我是 android 新手，我正在使用[http://code.google.com/p/android-dateslider/](http://code.google.com/p/android-dateslider/)组件，我想将它直接添加到我的视图中，而不是在弹出对话框中。

这意味着我将在视图顶部有对话框滑块，通过滑动它会有一些关于下面选定日期的附加信息。

有没有办法做到这一点，或者我仅限于使用对话框形式。（我知道对于 datepicker，我可以使用 xml 声明视图中的位置，但我真的很喜欢使用 datepinner，因为它很棒:)）

编辑：//

我通过以下方式通过xml声明尝试了它：

```
 <com.googlecode.android.widgets.DateSlider.SliderContainer
        xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:app="http://schemas.android.com/apk/res-auto"
        android:id="@+id/dateSliderContainer"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/button1">

        <com.googlecode.android.widgets.DateSlider.ScrollLayout
            style="@style/Scroller"
            app:childWidth="90dp"
            app:labelerClass="com.googlecode.android.widgets.DateSlider.labeler.MonthYearLabeler"
            app:labelerFormat="%tb %tY" >
        </com.googlecode.android.widgets.DateSlider.ScrollLayout>

        <com.googlecode.android.widgets.DateSlider.ScrollLayout
            style="@style/Scroller"
            app:childWidth="45dp"
            app:labelerClass="com.googlecode.android.widgets.DateSlider.labeler.DayDateLabeler"
            app:labelerFormat="%td %ta" >
        </com.googlecode.android.widgets.DateSlider.ScrollLayout>

        <include layout="@layout/dialogbuttons" />
    </com.googlecode.android.widgets.DateSlider.SliderContainer> 
```

当我启动应用程序时，我可以看到日期滑块，但是当我触摸它时，应用程序崩溃：应用程序意外停止。抛出此异常：

```
10-05 20:04:59.995: E/AndroidRuntime(428): FATAL EXCEPTION: main
10-05 20:04:59.995: E/AndroidRuntime(428): java.lang.NullPointerException
10-05 20:04:59.995: E/AndroidRuntime(428):  at com.googlecode.android.widgets.DateSlider.SliderContainer$1.onScroll(SliderContainer.java:38)
10-05 20:04:59.995: E/AndroidRuntime(428):  at com.googlecode.android.widgets.DateSlider.ScrollLayout.reScrollTo(ScrollLayout.java:402)
10-05 20:04:59.995: E/AndroidRuntime(428):  at com.googlecode.android.widgets.DateSlider.ScrollLayout.onTouchEvent(ScrollLayout.java:488)
10-05 20:04:59.995: E/AndroidRuntime(428):  at android.view.View.dispatchTouchEvent(View.java:3885)
10-05 20:04:59.995: E/AndroidRuntime(428):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:903)
10-05 20:04:59.995: E/AndroidRuntime(428):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:942)
10-05 20:04:59.995: E/AndroidRuntime(428):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:942)
10-05 20:04:59.995: E/AndroidRuntime(428):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:942)
10-05 20:04:59.995: E/AndroidRuntime(428):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:942)
10-05 20:04:59.995: E/AndroidRuntime(428):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:942)
10-05 20:04:59.995: E/AndroidRuntime(428):  at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1691)
10-05 20:04:59.995: E/AndroidRuntime(428):  at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1125)
10-05 20:04:59.995: E/AndroidRuntime(428):  at android.app.Activity.dispatchTouchEvent(Activity.java:2096)
10-05 20:04:59.995: E/AndroidRuntime(428):  at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1675)
10-05 20:04:59.995: E/AndroidRuntime(428):  at android.view.ViewRoot.deliverPointerEvent(ViewRoot.java:2194)
10-05 20:04:59.995: E/AndroidRuntime(428):  at android.view.ViewRoot.handleMessage(ViewRoot.java:1878)
10-05 20:04:59.995: E/AndroidRuntime(428):  at android.os.Handler.dispatchMessage(Handler.java:99)
10-05 20:04:59.995: E/AndroidRuntime(428):  at android.os.Looper.loop(Looper.java:130)
10-05 20:04:59.995: E/AndroidRuntime(428):  at android.app.ActivityThread.main(ActivityThread.java:3683)
10-05 20:04:59.995: E/AndroidRuntime(428):  at java.lang.reflect.Method.invokeNative(Native Method)
10-05 20:04:59.995: E/AndroidRuntime(428):  at java.lang.reflect.Method.invoke(Method.java:507)
10-05 20:04:59.995: E/AndroidRuntime(428):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
10-05 20:04:59.995: E/AndroidRuntime(428):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
10-05 20:04:59.995: E/AndroidRuntime(428):  at dalvik.system.NativeStart.main(Native Method) 
```

所以我想应该创建 SliderContainer 实例......但是在哪里？

# python - python中的字段继承访问

> ID：12734748
> 
> 赞同：3
> 
> 时间：2012-10-04T19:46:51.307
> 
> 标签：python, oop, inheritance

我有继承的问题。

这是我的主要程序：

```
def main(argv):
  rfp = reqboxfileparserng() # Inherits from reqboxfileparser()
  rfp.importsdir = './data/'
  if rfp.parsingasutf8_win():
    rfp.parsefile("./data/LRCv12.txt") 
```

以下是课程：

```
class reqboxfileparser():
  def __init__(self):
    ... removed code ...
    # Init mmap
    self.file = None
    self.f = None

  def parsefile(self, filename):
    # Public
    self.filename = filename

    # Init mmap
    self.file = codecs.open(filename, encoding='utf-8', mode='r') # open(filename, 'r')
    self.f = mmap.mmap(self.file.fileno(), 0, access=mmap.ACCESS_READ)
    self.f.seek(0) # rewind

    # Parsing stuff
    self.getfunlist()
    self.vlog(VERB_MED, "len(fun) = %d" % (len(self.funlist)))
    self.getfundict()
    self.vlog(VERB_MED, "fundict = %s" % (self.fundict))
... rest of reqboxfileparser() class code removed ...

class reqboxfileparserng(reqboxfileparser, object):
  def __init__(self):
    # Public
    reqboxfileparser.__init__(self)
    self.fundict = {}
    self.importsdir = ''

  def getfunlist(self):
    """
    Overrided method to load from a CSV file
    """
    self.funlist = []

    fh = open(self.importsdir + 'in-uc-objects.csv', 'rb')
    f = csv.reader(fh, delimiter=',')
  ... rest of the code removed, it works fine ...

  def getfundict(self):
    """
    Fills the fundict property with a dict where each element is indexed
    by the fun name and each value is an object from the model
    """
    self.__fundict = {}

    beginloc = self.bodystartloc()

    # PROBLEM!

    finalloc = super(reqboxfileparser, self).f.size() - 1
    ... rest of the code removed ... 
```

如您所见，我有两个类，第一个是 reqboxfileparser()，第二个是继承自第一个的 reqboxfileparserng()。

在主程序上我调用方法： parsefile("./data/LRCv12.txt") [not overrided] 后来在第二个类上调用 getfunddict() [overrided]，但是当我尝试访问 f.size()它总是以 TypeError 失败：必须是类型，而不是 classobj。

自从我不开发具有继承的类以来已经有一段时间了，但如果我没记错的话，这些概念是正确的。我是 Python 的新手。

请问有什么帮助吗？

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-04T20:07:32.917

这里有两个问题：

# 超级类和老式类：

`class reqboxfileparser():`不继承自`object`，因此，`super(reqboxfileparser, self)`总是会产生错误：

`TypeError: must be type, not classobj`.

# 继承类中不正确的超级调用：

您正在做`super(reqboxfileparser, self)`，但您将继承的类 ( `reqboxfileparser`) 作为第一个参数传递，而不是继承类。

因此，Python 会尝试找到一个`reqboxfileparser`继承自该类的类，该类实现了您正在寻找的内容：`f`.

但这不是你想要的：你想要的是`reqboxfileparserng`那个实现的祖先`f`；那将是`reqboxfileparser`。

请[查看文档](http://docs.python.org/library/functions.html#super)以了解最常见的`super`调用语法。

# 您的解决方案

您现在可能已经猜到您应该使用它`super(reqboxfileparserng, self)`。

另外，您应该始终使用[新式类](http://docs.python.org/glossary.html#term-new-style-class)（但仅此一项并不能解决您的问题，您会收到一个不同的错误，抱怨`AttributeError: 'super' object has no attribute 'f'`，这将是`True`， as`object`不提供`f`）。

# 最后一件事...

但是在这里，您还有最后一期！

您试图引用`f`哪个是子类实例的属性。当您使用调用时，此属性不存在，`super`因为它不存在于父类的类定义中，而父类定义是`super`调用将使用的。（在`__init__`方法中）

我不会更详细地说明为什么这对 super 很重要，但这个想法基本上`super`只用于在类级别定义的东西。通常，方法是，因此它们是`super`调用的绝佳候选者。

这是一个描述我的意思的例子：

```
class reqboxfileparser():
    g = 'THIS IS G'

    def __init__(self):
        self.f = 'THIS IS F'
        self.g = 'THIS IS NEW G'

    def get_g(self):
        return self.g

class reqboxfileparserng(reqboxfileparser, object):
    def __init__(self):
        reqboxfileparser.__init__(self)

    def getfundict(self):
        print super(reqboxfileparserng, self).g # Prints "THIS IS G"
        print super(reqboxfileparserng, self).get_g() # Prints "THIS IS NEW G"
        print super(reqboxfileparserng, self).f # This raises an AttributeError

if __name__ == '__main__':
    o = reqboxfileparserng()
    o.getfundict() 
```

总的来说，`super`调用与 using 非常相似`ParentClass.stuff`，只是它更好地处理了多重继承，因此应该使用它。

您可以在这里看到，`reqboxfileparser.f`会引发`AttributeError`.

* * *

脚注：a`classobj`是旧式类，a`type`是新式类。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T21:15:21.790

您缺少的一点是*当前*类`f`的一个属性。它是继承的：当您调用 时，代码设置为. 因此，要从子类访问它，您只需执行，就像任何其他属性一样。*`super(...).__init__()``f``self``self.f`*

 *任何属性或方法都是如此。您只需要`super`在您的子类实际覆盖某些内容时使用，并且您需要调用超类的版本。因此，无需调用 super 即可访问`parsefile`，例如：`self.parsefile()`就可以了。*

# c# - 如何将 app.config 添加到 Visual Studio 2012 Web Express lib 项目？

> ID：12734750
> 
> 赞同：3
> 
> 时间：2012-10-04T19:46:54.043
> 
> 标签：c#, .net, visual-studio

如何将配置文件添加到 Visual Studio 2012 Web Express 库项目？

我尝试按照[msdn 说明](http://msdn.microsoft.com/en-us/library/ms184658.aspx)进行操作，但我没有`Application Configuration File`模板。我尝试在项目的属性中查找以指定配置文件，但无处可寻。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T19:50:22.217

*库*通常没有配置文件。当应用程序加载时，它加载的配置将是与该*应用程序*相关联的配置，而不是其中的库。

您*可以*为库创建应用程序配置文件，并显式加载它们——但这有点麻烦。考虑直接在 API 中公开配置，并允许*使用*库的应用程序适当地提供配置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T19:51:01.437

在 ASP.NET 中，它被称为“Web 应用程序文件”，该文件被命名为“web.config”。

# java - jGit - 如何将所有文件添加到暂存区

> ID：12734760
> 
> 赞同：20
> 
> 时间：2012-10-04T19:47:10.900
> 
> 标签：java, git, jgit

我尝试了很多方法来用 jGit 克隆一个 repo（它有效）。然后，我在存储库中编写了一些存档，并尝试添加所有（a`git add *`或类似的`git add -A`东西）.. 但它不起作用。简单文件不会添加到暂存区。

我的代码是这样的：

```
 FileRepositoryBuilder builder = new FileRepositoryBuilder();
    Repository repository = builder.setGitDir(new File(folder))
            .readEnvironment().findGitDir().setup().build();
    CloneCommand clone = Git.cloneRepository();
    clone.setBare(false).setCloneAllBranches(true);
    clone.setDirectory(f).setURI("git@192.168.2.43:test.git");
    try {
        clone.call();
    } catch (GitAPIException e) {
        e.printStackTrace();
    }
    Files.write("testing it...", new File(folder + "/test2.txt"),
            Charsets.UTF_8);
    Git g = new Git(repository);
    g.add().addFilepattern("*").call(); 
```

我究竟做错了什么？谢谢。

* * *

尝试使用 addFilePattern(".") 时出现异常：

```
Exception in thread "main" org.eclipse.jgit.errors.NoWorkTreeException: Bare Repository has neither a working tree, nor an index
    at org.eclipse.jgit.lib.Repository.getIndexFile(Repository.java:850)
    at org.eclipse.jgit.dircache.DirCache.lock(DirCache.java:264)
    at org.eclipse.jgit.lib.Repository.lockDirCache(Repository.java:906)
    at org.eclipse.jgit.api.AddCommand.call(AddCommand.java:138)
    at net.ciphersec.git.GitTests.main(GitTests.java:110) 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-04T20:32:06.510

一种简单的调试方法是查看[JGit repo](https://github.com/eclipse/jgit)中的[AddCommand](https://github.com/eclipse/jgit/blob/master/org.eclipse.jgit/src/org/eclipse/jgit/api/AddCommand.java)测试：[`AddCommandTest.java`](https://github.com/eclipse/jgit/blob/master/org.eclipse.jgit.test/tst/org/eclipse/jgit/api/AddCommandTest.java)

您会看到，为了添加所有文件，`*`从不使用模式“”，但使用“ `.`”。
它用于名为...的测试函数中[`testAddWholeRepo()`](https://github.com/eclipse/jgit/blob/master/org.eclipse.jgit.test/tst/org/eclipse/jgit/api/AddCommandTest.java#L436-L456)（！）

```
git.add().addFilepattern(".").call(); 
```

例外：

```
Exception in thread "main" org.eclipse.jgit.errors.NoWorkTreeException: 
Bare Repository has neither a working tree, nor an index 
```

非常明确：您需要在非裸仓库中添加文件。

查看[测试方法`testCloneRepository()`](https://github.com/eclipse/jgit/blob/master/org.eclipse.jgit.test/tst/org/eclipse/jgit/api/CloneCommandTest.java#L106-132)与自己的克隆进行比较，看看是否有任何差异。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-11-16T00:50:51.230

我有一种情况，我必须将文件 f1 从当前目录移动到另一个名为“temp”的目录。移动文件后，调用 git.add().addFilePattern(".").call() 以一种奇怪的方式行事，因为 git status 给出了以下结果：

```
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

    new file:   temp/f1.html

Changes not staged for commit:
  (use "git add/rm <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

    deleted:    f1.html 
```

它认识到创建了一个新文件 temp/f1 但没有检测到该文件首先被删除。这可能是因为移动文件可以看到如下

*   删除/剪切文件 f1
*   创建一个名为 temp 的文件夹
*   创建/粘贴文件 f1

然后我遇到了`setUpdate(true)`寻找已经被跟踪的文件的更新，并且不会暂存新文件。（查看 java-doc 了解更多信息）

所以我不得不将我的代码更改为两行，以便 git 识别添加和修改的文件（包括删除）：

```
git.add().addFilepattern(".").call();
git.add().setUpdate(true).addFilepattern(".").call(); 
```

git status 现在给出了预期的结果：

```
renamed:    f1.hml -> temp/f1.html 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-16T14:21:41.490

可能是通配符，我刚刚阅读了 add 命令的 javadoc，看起来您发送目录的名称是为了添加其内容而不是通配符：

```
addFilepattern

public AddCommand addFilepattern(String filepattern) 
```

参数：`filepattern`- 要从中添加内容的文件。**还可以给出一个前导目录名称（例如要添加的 dir`dir/file1`和`dir/file2`**）以递归**地添加目录中的所有文件。****尚不支持****Fileglob（例如）。`*.c`**

# c# - 禁止或至少检测 Excel 形状移动

> ID：12734763
> 
> 赞同：0
> 
> 时间：2012-10-04T19:47:43.427
> 
> 标签：c#, .net, excel, office-interop, shape

我正在尝试构建一个与 Micrososft Excel 互操作的小型应用程序（2007 如果重要的话）。我的应用程序将启动并连接到 Excel 实例并（以编程方式）将一个或多个形状放置在工作表上。

我需要禁止用户移动和/或调整这些形状的大小。我可以保护工作表，但我需要允许用户编辑单元格内容并调整行和/或列的大小。

有什么办法可以做到这一点？

如果我至少不能禁止，我可以检测形状的移动/调整大小事件并在拖动结束时以编程方式将它们放回原处吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T20:12:27.247

您实际上可以在不锁定单元格内容的情况下保护工作表，也无需修改单元格属性以指示它们已解锁。

我以前没有使用过 Interop，但这是 VBA 中的代码。这允许修改内容，调整行和列，但不进行形状操作。我相信您或其他人可以轻松翻译它，因为它只是带有参数的工作表的 Protect 方法。

```
Worksheet.Protect DrawingObjects:=True, Contents:=False, AllowFormattingColumns:=True, _
    AllowFormattingRows:=True, AllowInsertingColumns:=True, AllowInsertingRows :=True 
```

# javascript - 如何从网站发送 Javascript/HTML？

> ID：12734769
> 
> 赞同：0
> 
> 时间：2012-10-04T19:48:07.803
> 
> 标签：javascript, forms, email

我们正在测试 Zendesk 软件试用版，并且想知道是否可以自定义请求提交表单。基本上开箱即用，我们可以更改表单上的字段，但我们需要更多自定义，因此我们正在尝试创建自己的表单并将其用作小部件。

基本上我正在尝试一个非常简单的形式：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN""http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"> 

<html xmlns='http://www.w3.org/1999/xhtml'>   
<head>      
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>      
    <title>Form Page: sampleform</title>   
</head>
<body>
    <h1>Sample form page</h1> 

        <form id='sampleform' method='post' action='' >
        <p>Name: <input type='text' name='Name' /></p>    
        <p>Email: <input type='text' name='Email' /></p>
        <p><input type='submit' name='Submit' value='Submit' /></p>
    </form> 
</body>
</html> 
```

但是现在我很困惑如何发送这个表单......基本上我知道表单标签中需要一个方法和动作，但我会用什么作为动作？由于 Zendesk 不是我们的软件，有没有办法我仍然可以使用他们的后端脚本来提交表单？基本上表格会被发送到 support@company.com 所以即使我不使用 Zendesk 的后端脚本，我可以创建自己的发送表格请求到 support@company.com 吗？？？

有什么想法可以做到这一点吗？多谢你们！

编辑：---------2012 年 10 月 10 日-------------

好的，经过进一步研究并按照诺亚所说的，我创建了一个这样的 PHP 来提交我的表单数据。我还修改了原始表格，如下所示...

--PHP 脚本 PHP 邮件发件人

```
 if (!preg_match("/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/", $email)) {
        echo "<h4>Invalid email address</h4>";
        echo "<a href='javascript:history.back(1);'>Back</a>";
    } elseif ($subject == "") {
        echo "<h4>No subject</h4>";
        echo "<a href='javascript:history.back(1);'>Back</a>";
    } elseif (mail($to,$subject,$description)) {
        echo "<h4>Thank you for your email</h4>";
    } else {
        echo "<h4>Can't send email to $email</h4>";
    }
?>
</body>
</html> 
```

--HTML 表单

```
<html xmlns='http://www.w3.org/1999/xhtml'>   
<head>      
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>      
    <title>Form Page: Support</title>   
</head>
<body>
    <h1>Support Form Page</h1> 

    <form id='supportform' method='POST' action='supportMail.php' ></p>   
            <p>Subject: <input type='text' name='subject' /></p>    
            <p>Email: <input type='text' name='email' /></p>
            <p>Description: <input type='text' name='description' /></p>
            <p><input type='submit' name='submit' value='Submit' /></p>
    </form> 
</body>
</html> 
```

不，我可能是一个完整的菜鸟，但我应该把 PHP 脚本放在哪里以及如何在表单中引用它？我知道它在操作部分，但我需要包含 URL 还是仅包含脚本名称。

让我感到困惑的是，表单所在的网站和脚本位于不同的服务器上......脚本所在的服务器是 Windows 服务器......我将 PHP 安装到 Windows 服务器上，但我没有了解我需要将脚本放在哪里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T21:06:55.580

你需要一个 PHP 文件来发送数据。

**HTML**

```
<form id='sampleform' method='post' action='file.php' > // make sure the 'action' is equal to the name of the PHP file 
        <p>Name: <input type='text' name='Name' /></p>    
        <p>Email: <input type='text' name='Email' /></p>
        <p><input type='submit' name='Submit' value='Submit' /></p>
</form> 
```

**PHP**

```
$name = $_POST['name']; // name that is submitted from the form
$email = $_POST['email']; // email that is submitted from the form

// mail function so yo can email information to someone with data that was submitted through the form 
mail('[enter the TO email here]','[Enter the subject here]','[enter the email message here]'); 
```

# android - 扩展一个 actionBar-ActionView 并显示一个新的 Fragment

> ID：12734770
> 
> 赞同：1
> 
> 时间：2012-10-04T19:48:16.600
> 
> 标签：android, android-fragments, android-actionbar, actionbarsherlock, actionview

几次尝试在#android-dev（irc）中提出这个问题并进行了数小时的搜索，但我仍然没有解决这个问题的方法。

我目前正在研究我的 android 音乐播放器中的搜索功能。我正在使用令人惊叹的 ActionBarSherlock 为较旧的 android 版本提供支持。

我的问题如下：当用户点击搜索菜单/动作按钮时，点击动作的actionView应该被展开，并且应该显示一个新的片段（searchFragment）而不是当前活动的片段。但是，当我尝试这样做时，actionView 不会扩展。

我尝试在不添加 SearchFragment 的情况下扩展 actionView，在这种情况下，actionView 会扩展。然而，这种组合似乎是不可能的。

这是我的代码：

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    if (item != null) {
        if (item.getItemId() == R.id.collectionactivity_search_menu_button) {
            item.expandActionView();
            mTabsAdapter.replace(new SearchFragment(), false);
            return true;
        }
    }
    return false;
}

/**
 * Replaces the view pager fragment at specified position.
 */
public void replace(int position, Fragment newFragment, boolean isBackAction) {
    // Get currently active fragment.
    ArrayList<Fragment> fragmentsStack = mFragments.get(position);
    Fragment currentFragment = fragmentsStack.get(fragmentsStack.size() - 1);
    if (currentFragment == null) {
        return;
    }
    // Replace the fragment using a transaction.
    this.startUpdate(mViewPager);
    FragmentTransaction ft = mFragmentManager.beginTransaction();
    ft.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
    ft.attach(newFragment).remove(currentFragment).commit();
    if (isBackAction == true)
        fragmentsStack.remove(currentFragment);
    else
        fragmentsStack.add(newFragment);
    this.notifyDataSetChanged();
    this.finishUpdate(mViewPager);
} 
```

mTabsAdapter.replace(...) 方法将当前显示的片段替换为第一个参数中的片段。此外，片段被添加到自定义 backStack。在扩展视图之前或之后替换片段没有任何区别。

希望有人能够帮助我:)提前谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T20:23:07.927

您是否尝试过将您的操作视图 android:showAsAction 设置为 collapseActionView？这样您就不必管理展开/关闭操作。如果这不起作用，你可以用另一种方式处理它，你设置一个扩展侦听器并在你的动作视图开始扩展时替换你的片段

```
item.setOnActionExpandListener(new OnActionExpandListener() {
    @Override
    public boolean onMenuItemActionCollapse(MenuItem item) {
        // Do something when collapsed
        return true;  // Return true to collapse action view
    }

    @Override
    public boolean onMenuItemActionExpand(MenuItem item) {
       mTabsAdapter.replace(new SearchFragment(), false);
        return true;  // Return true to expand action view
    }
}); 
```

记得返回true让actionview展开

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T13:46:18.850

我发现问题是由什么引起的。

我的 mTab​​sAdapter.replace(..) 方法正在调用 notifyDataSetChanged();。所以每次我替换片段时，都会调用 onPrepareOptionsMenu，导致搜索操作按钮被删除并再次添加，从而导致 actionView 被折叠。

对此的解决方案是修复我的 onPrepareOptionsMenu，因此每当调用 onPrepareOptionsMenu 并且之前已展开 actionView 时，actionView 将再次展开。

# apache - 如何拒绝大量传入的 http 帖子

> ID：12734775
> 
> 赞同：0
> 
> 时间：2012-10-04T19:48:47.590
> 
> 标签：apache, http

是否可以拒绝异常繁重的 http POST 请求。

例如，如果只有一个 html 格式的文本框，大小为 200 个字符，但我通过 wget 等工具模拟 http post 请求并针对该参数发送大量文本，那么代理服务器（比如 Apache）是否可以拒绝此类请求

# c - pthread中函数的参数数量

> ID：12734777
> 
> 赞同：2
> 
> 时间：2012-10-04T19:48:51.390
> 
> 标签：c, pthreads

在 pthread 的 hello world 示例中指出：

```
#include <pthread.h>
#include <stdio.h>

void * print_hello(void *arg)
{
  printf("Hello world!\n");
  return NULL;
}

int main(int argc, char **argv)
{
  pthread_t thr;
  if(pthread_create(&thr, NULL, &print_hello, NULL))
  {
    printf("Could not create thread\n");
    return -1;
  }

  if(pthread_join(thr, NULL))
  {
    printf("Could not join thread\n");
    return -1;
  }
  return 0;
} 
```

如您所见`print_hello`，`pthread_create()`没有参数，但是在定义中，它看起来像`void * print_hello(void *arg)`

这意味着什么？

现在假设我有这个实现

```
void * print_hello(int a, void *);
int main(int argc, char **argv)
{
  pthread_t thr;
  int a = 10;
  if(pthread_create(&thr, NULL, &print_hello(a), NULL))
  {
    printf("Could not create thread\n");
    return -1;
  }
  ....
  return 0;
}
void * print_hello(int a, void *arg)
{
  printf("Hello world and %d!\n", a);
  return NULL;
} 
```

现在我得到这个错误：

```
too few arguments to function print_hello 
```

那么我该如何解决呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T19:53:42.743

`pthread`将一个类型的参数传递`void *`给线程函数，因此您可以将指针传递给您想要的任何类型的数据作为`pthread_create`函数的第四个参数，请查看下面修复代码的示例。

```
void * print_hello(void *);
int main(int argc, char **argv)
{
    pthread_t thr;
    int a = 10;
    if(pthread_create(&thr, NULL, &print_hello, (void *)&a))
    {
        printf("Could not create thread\n");
        return -1;
    }
    ....
    return 0;
}

void * print_hello(void *arg)
{
    int a = (int)*arg;
    printf("Hello world and %d!\n", a);
    return NULL;
} 
```

# c# - MVC .NET 在强类型视图中从模型集合创建下拉列表

> ID：12734782
> 
> 赞同：10
> 
> 时间：2012-10-04T19:49:09.143
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-2

所以我有一个用这样的集合输入的视图：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<IList<DTO.OrganizationDTO>>" %> 
```

OrganizationDTO 如下所示：

```
public OrganizationDTO
{
    int orgID { get; set; }
    string orgName { get; set; }
} 
```

我只是想使用 HTML 帮助器从 OrganizationDTO 的集合中创建一个下拉列表，但对于我的生活，我无法弄清楚！我会以错误的方式解决这个问题吗？

我应该使用 foreach 循环来创建选择框吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-04T20:22:37.033

我做了一个小例子，像你这样的模型：

```
public class OrganizationDTO
{
    public int orgID { get; set; }
    public string orgName { get; set; }
} 
```

和一个控制器，如：

```
public class Default1Controller : Controller
{
    //
    // GET: /Default1/

    public ActionResult Index()
    {
        IList<OrganizationDTO> list = new List<OrganizationDTO>();
        for (int i = 0; i < 10; i++)
        {
            list.Add(new OrganizationDTO { orgID = i, orgName = "Org " + i });
        }

        return View(list);
    }

} 
```

在视图中：

```
<%= Html.DropDownListFor(m => m.First().orgID, new SelectList(Model.AsEnumerable(), "orgId","orgName")) %> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-04T20:20:04.050

试试这个：

```
<%= Html.DropDownList("SomeName", new SelectList(Model, "orgID", "orgName"), "Please select Organization") %> 
```

# c# - 如何在后面的代码中创建 runat 服务器 DIV？ASP.NET 和 C#

> ID：12734786
> 
> 赞同：0
> 
> 时间：2012-10-04T19:49:31.530
> 
> 标签：c#, asp.net

我正在根据我的 C# 代码后面的数据库记录创建多个 DIV。我怎样才能让它们运行在服务器上？

提前致谢 ..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-04T19:54:18.417

创建并添加[ASP.NET`Panels`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.panel.aspx)。

编码

```
<asp:Panel id="abc" runat="server"> 
```

与您执行以下操作完全相同：

```
<div id="abc" runat="server"> 
```

它们呈现相同的内容，但它是 Panel 最常用的其他**WebControl**的功能，并且 Panel Web 控件在代码隐藏下为您提供更多控制，因为它公开了更多属性。

如果要访问服务器端的 a `DIV`，还可以添加`runat="server"`. 它将被创建为`HtmlGenericControl`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-04T19:54:38.923

这不是必需的，只需创建一个`HtmlGenericControl`并将其添加到控件集合中：

```
HtmlGenericControl div = HtmlGenericControl("div")
div.Id = "myid";
this.Controls.Add(div); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T19:57:54.100

使用自定义控件来提取数据并按照您的意愿呈现。有点像这样：

```
public class MyDivControl : System.Web.UI.Control
{
    private System.Data.DataTable tblMyResults;
    protected override void Render(System.Web.UI.HtmlTextWriter writer)
    {
        // Get your Data (or do it on Page_Load if you'll need it more than once
        if (tblMyResults != null && tblMyResults.Rows.Count > 0)
        {
            int iIndex = 0;
            foreach (System.Data.DataRow rItem in tblMyResults.Rows)
            {
                writer.WriteLine("<div id=\"{0}_{1}\">", this.ClientID, iIndex++);
                //Whatever content you want here using your rows.
                writer.WriteLine("</div>");
            }
        }
    }
} 
```

然后只需将控件放在您希望它呈现的页面上。

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="default.aspx.cs" Inherits="Solution.Web.Presentation.pub._default" MasterPageFile="~/ui/master/main.master" %>
<%@ Register TagPrefix="custom" Namespace="MyNameSpace" Assembly="MyProjectAssembly" %>
<asp:Content runat="server" ContentPlaceHolderID="cntMain">

<custom:MyDivControl runat="server" />

</asp:Content> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T19:54:48.113

您可以使用中继器控制

```
<asp:Repeater ID="Repeater1" runat="server">
    <ItemTemplate>
      <div id="box<%# Eval("ID")%>" runat="server"></div>
    </ItemTemplate>
</asp:Repeater> 
```

并从代码隐藏中绑定数据

# maven - maven deploy:deploy-file 失败（409 Conflict），但工件上传成功

> ID：12734788
> 
> 赞同：43
> 
> 时间：2012-10-04T19:49:39.830
> 
> 标签：maven, deployment

> ### 笔记：
> 
> 我现在意识到 jar 已放入我的存储库中，但 pom.xml 没有。现在，我有另一个项目，其中 pom.xml 未能得到提升，但 jar 被放置在存储库中。
> 
> 然而，另一个项目， pom.xml 和 jar 都被放置在存储库中。

* * *

我在 Jenkins 有一个项目，我使用提升插件通过`deploy:deploy-file`目标在 Maven 中部署我的工件。

这适用于我在 Maven 中拥有的其他几个项目，但对于这个项目却失败了。有趣的是文件（但不是 pom.xml）无论如何都会上传。我已经通过从我们的 Maven 存储库中删除工件，然后运行促销来验证这一点。升级后，工件在我们的存储库中。

这是我得到的日志。尽我所能打破超长的线条：

```
[workspace] $ /bin/bash -xe /opt/tomcat/apache-tomcat-7.0.27/temp/hudson7357923598740079329.sh
+ FILE_LOC=/mnt/jenkins/builds/metricsdb-trunk/21/archive/target/archive
+ mvn deploy:deploy-file
    -Dversion=0.8.0
    -Dfile=/mnt/jenkins/builds/metricsdb-trunk/21/archive/target/archive/metricsdb-etl.jar
    -DpomFile=/mnt/jenkins/builds/metricsdb-trunk/21/archive/target/archive/pom.xml
    -Durl=http://repo.vegicorp.com/artifactory/ext-release-local -DrepositoryId=VegiCorp
[INFO] Scanning for projects...
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building Command Line Spring Batch Module 0.8.0.CI-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-deploy-plugin:2.7:deploy-file (default-cli) @ metricsdb-etl ---
Uploading: http://repo.vegicorp.com/artifactory/ext-release-local/com/vegicorp/batch/metricsdb/metricsdb-etl/0.8.0/metricsdb-etl-0.8.0.jar
2/38 KB   
4/38 KB   
[...]

Uploaded: http://repo.vegicorp.com/artifactory/ext-release-local/com/vegicorp/batch/metricsdb/metricsdb-etl/0.8.0/metricsdb-etl-0.8.0.jar (38 KB at 202.2 KB/sec)
Uploading: http://repo.vegicorp.com/artifactory/ext-release-local/com/vegicorp/batch/metricsdb/metricsdb-etl/0.8.0/metricsdb-etl-0.8.0.pom
2/7 KB     
4/7 KB   
[...]

[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1.243s
[INFO] Finished at: Thu Oct 04 14:38:52 CDT 2012
[INFO] Final Memory: 4M/119M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-deploy-plugin:2.7:deploy-file
    (default-cli) on project metricsdb-etl: Failed to deploy artifacts:
    Could not transfer artifact com.vegicorp.batch.metricsdb:metricsdb-etl:pom:0.8.0 from/to
    VegiCorp (http://repo.vegicorp.com/artifactory/ext-release-local):
    Failed to transfer file: http://repo.vegicorp.com/artifactory/ext-release-local/com/vegicorp/batch/metricsdb/metricsdb-etl/0.8.0/metricsdb-etl-0.8.0.pom.
    Return code is: 409, ReasonPhrase:Conflict. -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException
failed build hudson.tasks.Shell@24a6e7f9 SUCCESS
Finished: FAILURE 
```

带有调试标志 (-X) 的输出位于[Pastebin](http://pastebin.com/4KEkswbA)中。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-10-05T19:49:32.810

我发现了问题。其实有两个问题：

*   我只有发布存储库设置，并且我试图在发布存储库中保存快照版本。Artifactory 设置为仅允许发布存储库中的发布。这可以在 Artifactory 设置中修改，但我决定不这样做。

*   我`pom.xml`的版本与我尝试保存的版本不同。例如，pom.xml 表示版本 2.0，我试图将版本保存为 2.0.2。出于这个原因，Artifactory 拒绝了 pom（但不是 jar）。

我发现 Artifactory 设置（每个存储库）询问是否“抑制 POM 一致性检查”。选中此框将允许我将版本设置为一个，但让 pom 说另一个。

我还必须修改我的 Maven“settings.xml”文件以允许发布和快照存储库。我还必须修改我的快照存储库的 URL。

我们只使用了一段时间的 Ivy（它没有*快照*概念），所以我们只是把东西放在发布存储库中。这是一个 Maven 项目，开发者在 POM 中将版本标记为 SNAPSHOT。

不幸的是，Maven 文档很差，而且仍然没有任何关于 Maven 的好书。更糟糕的是，错误消息简直太糟糕了。“ *409, ReasonPhrase:Conflict. -> [Help 1]* ”是什么意思？

并不是说 Ivy 的文档要好得多，但是[Ant in Action](https://rads.stackoverflow.com/amzn/click/com/193239480X)有一些关于使用 Ivy 的优秀章节。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2015-04-22T01:57:25.997

如果要发布到存储库，请确保将其`-SNAPSHOT`作为版本的一部分`snapshot`。

并删除`-SNAPSHOT`以防您将其发布到非快照存储库。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-12-11T09:48:24.270

我也面临这个问题，我发现原因是父项目没有部署在快照存储库中。我在父文件夹中运行 mvn deploy ，问题就解决了。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-10-30T11:53:28.667

是的....相同错误的多个原因。可能会帮助某人

```
1\. Login as Admin to Artifactory
2\. Configuration -> Repositories
3\. Edit the Local Repository ---> Suppress POM Consistency Checks 
```

这解决了我的问题....不确定。正确的做法与否？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-10-22T08:28:44.153

也有那个错误信息。对我来说，问题是服务器的设置是只接受发布，而不是快照。从 pom 中删除 SNAPSHOT 后，它工作正常。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-04-11T19:39:52.530

我也遇到了这个问题，结果发现我们在我试图部署到的存储库上设置了包含/排除规则，而我的部署与这些规则不匹配。

我的解决方案是将部署指向以 **/* 作为包含规则的新存储库（以及来自我的其他存储库的模式作为排除规则以保持它们分开）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-02-28T19:47:44.287

在我的情况下，与 jar 文件（外部，在同一目录中）关联的 POM 文件对自身有依赖性。这是来自第三方的离线压缩仓库，我需要加载到工件中。

我修改了 POM 文件，删除了自依赖并确保包信息正确。然后工件部署没有问题。向供应商发送电子邮件，以便他们可以修复他们的构建。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-11-20T10:45:56.280

我一直遇到同样的问题。（TL；DR：解决方案见最后一行）

在从 jenkins 部署到 Artifactory 的过程中，有时（很神奇！）会出现 409 - 冲突错误，并在 Artifactory 日志中显示以下错误消息：

[警告] (oaeUploadServiceImpl:239) - 发送 HTTP 错误代码 409：校验和策略“LocalRepoChecksumPolicy:CLIENT”拒绝了工件“gradle-integration:com.redacted.java/fooProject/123/foo-123.jar”。Checksums info: ChecksumsInfo{checksums={SHA-1=ChecksumInfo{type=SHA-1, original='da39a3ee5e6b4b0d3255bfef95601890afd80709', actual='1459689f0be058f4ecef7e6fe3576f1550a8afda'}, MD5=ChecksumInfo{type=MD5, original='d41d8cd98f00b204e9800998ecf8427e', actual=' 14c7a498de028d6eb5882b3c698bc456'}}}。

训练有素的眼睛可能会注意到：MD5# d41d8cd98f00b204e9800998ecf8427e 是空文件或字符串的校验和。

这意味着必须发生以下情况：在发布文件夹中准备工件的复制作业尚未完成，因此在计算校验和时文件为空。

但是，当部署发生时，文件在那里，Artifactory 现在收到一个不正确的校验和，并正确拒绝该文件，错误代码为 409。

解决方案（很简单）：在开始部署作业之前确保 100% 的文件确实存在（添加暂停或适当的逻辑）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-03-29T15:57:33.693

您的远程仓库上的空间很可能已满。在进行所有技术和浪费时间之前验证这一点。浪费了 2-3 小时，认为这是一个逻辑问题。

# android - android在gridview中获取单击项目的位置

> ID：12734793
> 
> 赞同：10
> 
> 时间：2012-10-04T19:49:45.523
> 
> 标签：android, gridview, android-widget, android-gridview

正如我们所知，使用 android 网格视图，我们可以执行以下操作并在单击项目时收到通知：

```
gridview.setOnItemClickListener(new AdapterView.OnItemClickListener() {
    public void onItemClick(AdapterView<?> parent, View v, int position, long id) {
    Toast.makeText(PopularCapitActivity.this, "" + position, Toast.LENGTH_SHORT).show();
    }
}); 
```

我们也知道，如果网格中的单元格包含一个可点击的项目，比如一个按钮，上面的内容不会被触发。

所以目前我有一个网格视图，每个单元格都有自己的按钮，所以现在当用户点击按钮时，它将根据按钮所在的单元格有自己的操作，我的问题是，我如何访问单元格位置在按钮处理程序中？

谢谢

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-10-04T19:57:15.013

假设您正在为 GridVIew 使用自定义适配器，在 getView 方法中，您可以简单地将标签添加到包含传递给 getView 的位置的 Button 对象：

```
button.setTag(new Integer(position)); 
```

然后，在 onClickListener 方法中，使用传入的视图（按钮），您可以执行以下操作：

```
Integer position = (Integer)view.getTag(); 
```

然后从那里处理位置值。

**编辑：** 看来最好的做法是：

```
button.setTag(Integer.valueOf(position)); 
```

而不是使用 Integer 构造函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-02-11T17:06:25.497

```
gridView.setOnItemClickListener(new AdapterView.OnItemClickListener() 
{
    @Override
    public void onItemClick(AdapterView<?> parent, View view, int position, long id)
    {
        String a = String.valueOf(position);
        Toast.makeText(getApplicationContext(), a, Toast.LENGTH_SHORT).show();
    }
}); 
```

# javascript - Chrome中多选列表上的jQuery设置prop（“selected”，true）仅适用一次

> ID：12734794
> 
> 赞同：5
> 
> 时间：2012-10-04T19:49:47.233
> 
> 标签：javascript, jquery, google-chrome, scroll, multi-select

当尝试将选择列表选项设置为选中以**将选择列表滚动到该选项**时，它适用于除 Chrome 之外的所有浏览器。在 Chrome**中它可以工作一次**，但连续的时间在 Chrome 中不起作用。如何确保在选择列表中设置选项的选定属性会将该选项滚动到视图中？

这是我的问题的一个例子 - [http://jsfiddle.net/Z2rQG/](http://jsfiddle.net/Z2rQG/)

我用来在列表中选择一个选项以将其滚动到查看的代码如下：

```
(function ($) {
    $.fn.scrollToOption = function (option) {
        var _option = $(option, this);
        // if option is in list
        if(_option) {
            // store the selection state
            var isSelected = _option.is(":selected");

            _option.prop("selected", true); // scroll to the option
            _option.prop("selected", isSelected);  // restore the selection state
        }
        return this;
    };
})(jQuery); 
```

**编辑：**我还尝试了[scrollTo](http://archive.plugins.jquery.com/project/ScrollTo) jQuery 插件，它在 Chrome 中效果不佳。这是一个例子 - [http://jsfiddle.net/kavun/TW4XK/](http://jsfiddle.net/kavun/TW4XK/)

**编辑：**这是我想要做的一个更清晰的例子。从选择列表中选择两个选项，然后将列表滚动到最后选择的选项。这适用于除 Chrome 和 Safari 之外的所有浏览器。在 Chrome 中，第一个选择滚动到选项，但第二个`$('#select option[value=""].prop('selected', true);` **不滚动列表**- [http://jsfiddle.net/kavun/uhnZH/](http://jsfiddle.net/kavun/uhnZH/)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-08T15:14:04.113

Browser behaviour is inconsistent with regard to which option is scrolled into view when multiple options are selected. 但是，使用其`selected`属性选择选项并设置元素的`selectedIndex`属性`<select>`似乎可以确保选择在所有主要浏览器中滚动到正确的位置。使用它，您可以获得正确的垂直滚动，选择所需的选项，然后手动滚动选择。

Opera 似乎并不完全支持`scrollTop`选择元素，因此该解决方案在 Opera 中不起作用。

演示：http: [//jsfiddle.net/uhnZH/10/](http://jsfiddle.net/uhnZH/10/)

代码：

```
function selectAndScrollToOption(select, option) {
    $select = $(select);

    // Store the currently selected options
    var $selectedOptions = $select.find("option:selected");

    // Select the new option using its selected property and selectedIndex.
    // This seems to make the select scroll to the desired place in all major
    // browsers
    option.selected = true; // Required for old IE
    select.selectedIndex = option.index;

    // Measure the vertical scrolling
    var scrollTop = $select.scrollTop();

    // Re-select the original options
    $selectedOptions.prop("selected", true);

    // Scroll to the correct place
    $select.scrollTop(scrollTop);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-05T19:38:57.067

如果您的目标只是滚动到下拉列表中的一个值，您可以简单地使用`val` [，如更新的小提琴中所示](http://jsfiddle.net/TW4XK/2/)：

```
$('#selectList').val(51); 
```

这将适用于任何浏览器。

如果您尝试根据下拉列表中的值滚动到页面上的某个元素，则必须提供一个示例，让我们更接近您想要的内容，以便我们解决该特定场景。

# telerik - 从后面的报表代码访问数据源字段

> ID：12734797
> 
> 赞同：0
> 
> 时间：2012-10-04T19:49:55.450
> 
> 标签：telerik, telerik-reporting

我想以编程方式访问Telerik 报告对象中的`Fields`集合。`ObjectDataSource`

我确实在 Telerik 报告的设计部分注意到，您可以使用 Edit Expression 窗口访问 Value 中的字段集合。

例子：

```
= Fields.MyFieldName 
```

我将如何使用报告代码隐藏文件中的 C# 代码完成此任务？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-24T23:28:11.173

我有同样的问题。这就是我解决它的方法，尽管我相信应该有一个更简单的方法。

首先，我为详细信息部分 itemdatabinding 创建了一个方法：

```
private void detail_ItemDataBinding(object sender, EventArgs e)
    {
        Telerik.Reporting.Processing.DetailSection section = (sender as Telerik.Reporting.Processing.DetailSection);
        object id = section.DataObject["Data Field You want to access"];
        Variable Name = id.ToString();
    } 
```

您现在可以在代码隐藏中的任何位置使用该变量。注意：数据字段必须出现在您的详细信息部分。在我的情况下，我不需要它显示，所以我只是做了'Visible = false'。

这对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-28T04:17:13.410

将数据绑定到您自己的数据到您的变量

```
string ItemCode = "a";
 string ItemDesc = "aa" 
```

然后绑定到数据源

```
var Output = new
            {              
                ItemCode = a.ItemCode,
                ItemDesc = a.ItemDesc,                    
            };

            this.DataSource = Output; 
```

所有这些都在代码后面。然后移动到设计部分并修改您的文本框，如下所示。

```
= Fields.ItemCode 
= Fields.ItemDesc 
```

# php - 使用codeigniter处理多个输入字段？

> ID：12734801
> 
> 赞同：0
> 
> 时间：2012-10-04T19:50:24.680
> 
> 标签：php, codeigniter, input

我遇到的问题是我的电子商务脚本允许人们将产品添加到他们的商店。但是，这些产品可以有变体......例如颜色，并且这些变体可以有选项，例如黑色、白色和蓝色。我遇到的问题是我如何确定他们输入了多少选项。最终，如果他们单击“添加选项”，我将有一个 javascript 函数添加一个新的输入字段，但现在我只创建了 3 个输入字段，如下所示：

```
Variant Title:<input type="text" name="variant_title"><br>
Variant Option: <input type="text" name="variant_option_1"><br>
Variant Option: <input type="text" name="variant_option_2"><br>
Variant Option: <input type="text" name="variant_option_3"><br> 
```

现在我不知道该怎么做是遍历所有的variant_options，如果它们不为空，则将它们添加到数据库中。我不想用名称对其进行硬编码，因为我不知道他们将为每个变体选择多少选项。

我试过这样做：

```
$i = 1;
            while($this->input->post('variant_option_$i') != '')
            {
                $variant_options[] = $this->post->input('variant_option_$i');
                $i++;
            } 
```

但这似乎不起作用，因为变体标题已添加到数据库中，但选项却没有。

我唯一需要解决的问题是如何一次真正地抓取这些字段。我在想一个 foreach 循环，但我不确定。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:53:33.683

我会改用一组输入字段：

```
Variant Title:<input type="text" name="variant_title"><br>
Variant Option: <input type="text" name="variant_option[]"><br>
Variant Option: <input type="text" name="variant_option[]"><br>
Variant Option: <input type="text" name="variant_option[]"><br> 
```

然后检查以下值：

```
if (is_array($this->input->post('variant_option')):
   foreach ($this->input->post('variant_option') as $value):
       $variant_options[] = $value; // loop through...
   endforeach;
endif; 
```

# android - 如何在编译期间强制“./configure”停止使用-pthread？

> ID：12734804
> 
> 赞同：3
> 
> 时间：2012-10-04T19:50:37.227
> 
> 标签：android, compilation, compiler-errors, configure

我正在尝试为 Android 交叉编译一些东西，它具有 pthread 支持，但在编译和链接时不使用 -pthread。如果您尝试使用 -pthread，则使用交叉编译器的编译将失败。

当尝试通过首先使用“配置”工具来交叉编译某些东西时，它会一直尝试使用 -pthread 来执行“检查 gethostbyname”之类的操作，因此我的配置失败：

```
configure:21229: checking for gethostbyname
configure:21229: /mnt/hgfs/Documents/thesis/android-wmon/core/android-wireshark/agcc \
     -o conftest -D_U_="__attribute__((unused))" -g -O2 -Wall -W -Wextra \
     -Wdeclaration-after-statement -Wendif-labels -Wpointer-arith \
     -Wno-pointer-sign -Warray-bounds -Wcast-align -Wformat-security \
     -fexcess-precision=fast -I/usr/local/include -pthread \
     -I/usr/include/glib-2.0 -I/usr/lib/x86_64-linux-gnu/glib-2.0/include \
     -I/usr/local/include  -Wl,--as-needed -L/usr/local/lib conftest.c  >&5
arm-eabi-gcc: error: unrecognized option '-pthread' 
```

我找不到它从哪里拿起这个标志，以及如何让它停止这样做。我在任何地方的配置中都看不到它，所以它必须是动态生成的。我似乎无法找到它在哪里执行此操作，因此我可以将它从它存储在配置中的任何变量中删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:06:29.383

好吧，这是一个 hack，但似乎您可以在 CFLAGS 尝试链接测试之前对其进行操作：

```
ac_fn_c_try_link ()
{
        CFLAGS="${CFLAGS/-pthread/}" 
```

...在“配置”中

# python - 远程：gitzilla 缺少/不完整的 bugzilla conf（没有 bugzilla_url）错误

> ID：12734807
> 
> 赞同：2
> 
> 时间：2012-10-04T19:50:51.670
> 
> 标签：python, bugzilla, pybugz

我在远程中央存储库服务器上的 /ect/gitzillarc 上设置了 gitzilla 配置文件，具有所有读写权限。文件代码配置内容如下

```
[/home/gituser/repositories/git-main/git-main.git/.git]
bugzilla_url: https://repo.example.com/bugzilla/
bugzilla_user: sboppana@example.com
bugzilla_password: s123
user_config: deny
allowed_bug_states: NEW, ASSIGNED, REOPENED
logfile: /var/log/gitzilla.log
loglevel: info`

python at 2.6.5
pybugz at 0.9.3 (tried with 0.8.0 also)
Gitzilla at gera-gitzilla-gitzilla-2.0-19-geceeaca.tar.gz 
```

我收到错误“远程：缺少/不完整的 bugzilla conf (no bugzilla_url)”与 git push 当然 bugzilla_url 值在我的配置文件中具有真实名称而不是示例名称。

尝试了很多，但无法让它工作。感谢所有的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-09T10:59:13.107

添加**xmlrpc.cgi**和 bugzilla URL 应该可以解决这个问题。这是 Pybugz 中问题的解决方法。

例如，如果您的 bugzilla URL`https://repo.example.com/bugzilla/`尝试使用`https://repo.example.com/bugzilla/xmlrpc.cgi`This 应该可以。

# ruby - Ruby 套接字编程中的标准套接字超时（秒）是多少？

> ID：12734811
> 
> 赞同：3
> 
> 时间：2012-10-04T19:51:09.173
> 
> 标签：ruby, sockets, tcp, stream, timeout

我正在编写一个 Ruby 客户端，它将打开 tcp 套接字和流数据。

如果我无法在 20 秒内打开套接字，我将触发超时错误。

```
begin
  Timeout::timeout(20) { socket = open_socket(host, port) }
rescue Errno::ECONNREFUSED
  puts "Failed to connect to server"
rescue Timeout::Error
  puts "Timeout error occurred while connecting to the server"
end 
```

我的 open_socket 方法如下。

```
def open_socket(host,port)
  TCPSocket.new(host,port)
end 
```

代码工作正常。我的问题是

1.  套接字编程中的标准超时（以秒为单位）是多少？
2.  是否可以根据我们的需要设置超时秒数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T04:38:14.047

这正是你的做法。超时的默认值为 10 秒。

超时（秒）{ ...}

如果块执行在超时期限过去之前成功终止，则执行块并返回 true，否则立即终止块的执行并引发 TimeoutError 异常。

```
require 'timeout'
status = timeout(5) {
# something that may take time
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T21:10:07.270

我发现 2 篇文章似乎确认超时为 20 秒：

*   在[Windows中](https://stackoverflow.com/questions/3464551/shortening-socket-timeout-using-timeouttimeoutn-does-not-seem-to-work-for-me)
*   在[Linux](http://www.sekuda.com/overriding_the_default_linux_kernel_20_second_tcp_socket_connect_timeout)中（不是特定于 ruby​​ 的）

第二篇文章似乎暗示超时期限由操作系统定义。

你的第二个问题我没有答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-05T05:38:27.140

在 Linux 上，可以使用 setsockopt/getsocktopt 访问发送/接收超时。

执行 man 7 socket 并查找 SO_RCVTIMEO 和 SO_SNDTIMEO 选项。setsockopt/getsockopt 在 Ruby 中的套接字对象上可用。

# scala - 编译器说我没有为 Set 指定类型（类型不匹配）

> ID：12734813
> 
> 赞同：3
> 
> 时间：2012-10-04T19:51:19.813
> 
> 标签：scala, scala-collections

我是 scala 学习集合的新学习者。我想将我的参数添加到集合中，然后从函数中返回它。

```
def singleElementSet(elem: Int): Set ={
    var newSet = Set()
    newSet+= elem
  } 
```

我试过这个，但它给了我这样的错误：

```
type Set takes type parameters
- type Set takes type parameters 
```

和

为元素

```
type mismatch;  found   : elem.type (with underlying type Int)  required: Nothing 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T19:55:50.330

在您的示例中，您必须通过 Set[Int] 定义 Set 在其中包含的内容。创建新 Set 时，您必须像这样指定它的类型：

```
val newSet = Set.empty[Int] 
```

或使用以下内容初始化 Set：

```
val newSet = Set(1) 
```

但是，您可能必须使用 var 或可变 Set 来完成很多工作。例如，您的代码应如下所示：

```
var newSet = Set.empty[Int]
def singleElementSet(elem: Int): Set[Int] = {
    newSet+= elem
} 
```

（不能在每次调用方法时都将 Set 定义为空 Set，否则结果不会累加）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-07T23:37:17.437

我想你想要的是

```
def singleElementSet(elem: Int): Set[Int] = {
    val newSet = Set.empty[Int]
    newSet + elem
} 
```

或者你可以直接创建集合

```
def singleElementSet(elem: Int) = Set(elem) 
```

# java - 在 Java 中使用 RegEx 提取括号之间的参数

> ID：12734814
> 
> 赞同：2
> 
> 时间：2012-10-04T19:51:22.073
> 
> 标签：java, regex, regex-lookarounds

我正在编写一个实用程序来从 JSP 中提取头文件的名称。我逐行阅读 JSP 并找到我需要的行没有问题。我在提取使用正则表达式所需的特定文本时遇到问题。在查看了许多类似的问题后，我遇到了障碍。

我将从内部匹配的字符串的一个示例是：

```
<jsp:include page="<%=Pages.getString(\"MY_HEADER\")%>" flush="true"></jsp:include> 
```

对于这个例子，我只需要 MY_HEADER。任何时候我有这个标签：

```
<%=Pages.getString 
```

我需要介于两者之间的东西：

```
<%=Pages.getString(\"  and this: )%> 
```

这是我目前拥有的（我可能会添加它不起作用）：

```
String currentLine;
while ((currentLine = fileReader.readLine()) != null)
{
Pattern pattern = Pattern.compile("<%=Pages\\.getString\\(\\\\\"([^\\\\]*)"); 
Matcher matcher = pattern.matcher(currentLine); 
while(matcher.find()) {
System.out.println(matcher.group(1).toString());                           
}} 
```

我需要能够使用 Java RegEx API 和正则表达式来提取这些标头名称。

非常感谢您对此问题的任何帮助。谢谢！

编辑：

解决了这个问题，谢天谢地。棘手的部分是，在获得正确的正则表达式之后，必须考虑到我提供给正则表达式的字符串*总是*有两个“/”字符（ (/"MY_HEADER"/) ）需要在模式中被转义。

这是有效的（感谢帮助;-)）：

```
Pattern pattern = Pattern.compile("<%=Pages\\.getString\\(\\\\\"([^\\\\\"]*)"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T19:57:39.653

这应该可以解决问题：

```
<%=Pages\\.getString\\(\\\\\"([^\\\\]*) 
```

是的，这是一个可怕的反斜杠数量。`matcher.group(1)`应该返回 MY_HEADER。它从 开始`\"`并匹配所有内容，直到下一个`\`（我假设这里将在`\")%>`。）

当然，如果您的目标文本包含反斜杠 ( `\`)，这将不起作用。但是您并没有表明您会寻找类似的东西`<%=Pages.getString(\"Fun!\Yay!\")%>`——这个正则表达式只会返回`Fun!`并忽略其余部分。

**编辑**

您的测试用例失败的原因是因为您使用了以下测试字符串：

```
String currentLine = "<%=Pages.getString(\"MY_HEADER\")%>"; 
```

这相当于从文件中读取它并看到：

```
<%=Pages.getString("MY_HEADER")%> 
```

请注意缺少任何`\`. 您需要改用它：

```
String sCurrentLine = "<%=Pages.getString(\\\"MY_HEADER\\\")%>"; 
```

这相当于你想要的。

这是有效的测试代码：

```
String currentLine = "<%=Pages.getString(\\\"MY_HEADER\\\")%>"; 
Pattern pattern = Pattern.compile("<%=Pages\\.getString\\(\\\\\"([^\\\\]*)"); 
Matcher matcher = pattern.matcher(currentLine); 
while(matcher.find()) {
    System.out.println(matcher.group(1).toString()); 
} 
```

# css - 多行链接

> ID：12734820
> 
> 赞同：0
> 
> 时间：2012-10-04T19:51:56.430
> 
> 标签：css, hyperlink

它并不像你想象的那么基本。看看这张照片：![](../Images/3b786db74342b2b0f8e54148254e338a.png)

现在您可以看到链接超出了内容框。普通文本会跳到下一行，但链接和长词不会。对此有任何修复吗？放置在那里的文本是通过 PHP 放置的，只是说。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T19:57:24.140

你可以用它`word-break: break-all`来分解像这样的很长的词。

您还可以使用以下属性[截断字符串：](http://css-tricks.com/snippets/css/truncate-string-with-ellipsis/)

```
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis; 
```

两者的例子：http: [//jsbin.com/uzoyag/2/edit](http://jsbin.com/uzoyag/2/edit)

# c# - 比较列表 有多个条件

> ID：12734821
> 
> 赞同：0
> 
> 时间：2012-10-04T19:51:58.213
> 
> 标签：c#, asp.net, linq

我有两个`List<String[]>`（字符串数组列表），我想在某些条件下将内容相互匹配，因此最终结果将返回 true 或 false。

```
List<string> TestA= {"A001","A002","A003","B001","B001","C003","D000","E001"};

List<string> TestB= {"A001","A002","A003","B999","C003"}; 
```

我想为以下条件编写一个函数。

1.  如果 TestA 的所有项目都与 TestB 匹配（在 TestA 中相同的项目可以多次 [ex. B001]）==> 返回 true
2.  如果 TestB 包含任何具有数字 999 [Ex B999] 的项目，则无需循环在 testA 中以 B 开头的项目（此设置为 true）并且 TestA 的循环从 C003 开始​​ [在这种情况下，我认为我们需要删除所有项目如果 ListB 包含 B999，则来自 ListA 的 B]。继续.. 循环运行 TestA 项目 C003。这与 TestB 中的项目匹配再次设置为 true 现在对于 D000 不匹配 ListB 中的项目现在最终 bool 设置为 false 并中断。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:21:01.290

这是使用 LINQ 所需的全部内容：

```
// Condition 2:
// Get the characters of in list B that contains the "999" string. 
var badOnes = ListB.Where(s=>s.Contains("999").Select(s=>s[0])

// If there is any forbidden characters remove them from List A
if (badOnes.Length > 0)
{
    ListA.RemoveAll(x => x[0] == badOnes.Exists(c => c == x));
}

// Condition 1:
if (ListA.Distinct().Intersect(ListB).Length == ListA.Distinct().Length)
{
    return true;
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T20:28:58.547

不确定我是否理解，但请检查：

```
var filter = 
    from b in TestB
    where b.Contains("999")
    select b.Replace("999", "");

var cleaned = 
    from a in TestA
    where !filter.Any(f => a.StartsWith(f))
    select a;

var check = cleaned.Distinct()
                   .Except(TestB).Any(); 
```

**编辑**

根据您的进一步说明，我了解您的前缀可能不止一个字母，因此我编辑了答案。

# visual-studio-2010 - VS2010 原生多目标

> ID：12734822
> 
> 赞同：1
> 
> 时间：2012-10-04T19:52:03.620
> 
> 标签：visual-studio-2010, multitargeting, multi-targeting

我的 Win7 开发机器上安装了 VS2005、VS2008 和 VS2010。我有一个使用 3rd 方 DLL 的特定项目，当 EXE 项目由 VS2010 构建时（在针对 v100 或 v90 工具集时），它在 LoadLibrary() 调用期间出现异常。当直接由 VS2005 或 VS2008 构建时，它可以完美运行.

根据李绍（微软）2009年的博客文章：

[http://blogs.msdn.com/b/vcblog/archive/2009/12/08/c-native-multi-targeting.aspx](http://blogs.msdn.com/b/vcblog/archive/2009/12/08/c-native-multi-targeting.aspx)

我应该能够打开 VS2010 项目并将平台工具集从 v100 更改为 v90，然后 VS2010 将实际使用 VS2008 编译器、头文件和库来构建程序。如果是，那么它就不是“正确”的，因为当以这种方式构建项目时，DLL 将不会加载。我尝试查看构建日志以验证使用了哪个编译器，但我的日志中没有路径或版本号，所以这是失败的。

这是一个直接写入 Win32Apis 的纯 C（不是 C++，不是 MFC，不是 .NET）项目。有什么办法可以让这个工作，还是我只是为单个项目使用不同的编译器（在整个系统的 100 多个项目中）？

帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:45:29.923

看看水仙花：[http ://daffodil.codeplex.com/](http://daffodil.codeplex.com/)

安装 Daffodil 后，您将能够使用 VS 2010 使用旧版本的库构建项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T19:58:35.487

我想我已经解决了。看起来，虽然 VS2010 会愉快地运行 VS2008 编译器、链接器等。VS2010**不会**让项目单独运行。当项目导入到 VS2010 时，命令行中添加了一些新的默认设置，显然，其中至少有一个与 VS2008 有足够的不同，导致我正在使用的 DLL 无法加载。

**当我将数据执行保护 (DEP)**的高级链接器设置从是（默认）更改为否时，我的程序又开始工作了！事实上，我什至不再需要使用 v90 工具集进行编译——整个问题是由**/NXCOMPAT**链接器命令行开关的新默认值引起的。**/NXCOMPAT**开关甚至没有在 VS2005 IDE（创建项目的地方）的项目设置中引用，而是运行“链接/？” 在 VC8 bin 文件夹中显示该开关是已知的，默认值为**NO**。

太糟糕了，Visual Studio IDE 不包含在新版本中已**更改的项目正在使用的默认设置列表。**如果这太难了，导入器应该使用旧的默认值指定更改的设置，否则项目导入不正确，不是吗？

# .net - 如何在图表控件中显示 EMGU 直方图？

> ID：12734824
> 
> 赞同：0
> 
> 时间：2012-10-04T19:52:10.750
> 
> 标签：.net, opencv, charts, histogram, emgucv

我有以下代码示例：

```
 //creating histogram using emgu cv c#
    //Create a grayscale image
      Image<Gray, Byte> img = new Image<Gray, byte>(400, 400);
    // Fill image with random values
      img.SetRandUniform(new MCvScalar(), new MCvScalar(255));
    // Create and initialize histogram
      DenseHistogram hist = new DenseHistogram(256, new RangeF(0.0f, 255.0f));
    // Histogram Computing
      hist.Calculate<Byte>(new Image<Gray, byte>[] { img }, true, null); 
```

计算直方图后，我想在图表控件中显示结果。

有人可以提供实现这一点的想法/示例代码吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T07:22:56.500

HistogramBox 控件让您自动显示图像直方图。

按照[emgu 说明](http://www.emgu.com/wiki/index.php/Add_ImageBox_Control)获取可以拖放到表单上的整个控件列表。然后它只是几个方法调用。

```
histogramBox.GenerateHistograms(img,bin); //bin = 256 in your example

histogramBox2.Refresh(); 
```

# javascript - 使用带有 javascript 的 html 表单搜索数组元素

> ID：12734825
> 
> 赞同：1
> 
> 时间：2012-10-04T19:52:17.270
> 
> 标签：javascript, arrays, for-loop

我在下面的代码中尝试做的是创建一个搜索表单，当搜索输入与任何数组元素匹配时，会弹出一个警报。截至目前，它不起作用。我认为问题是我不确定如何在 if 语句的第一行写出逻辑。

```
<form>
<input type="text" id="formInput"></input>
<input type = "button" id="search"></input>

</form>

<script>

var search = document.getElementById("search");
var formInput = document.getElementById("formInput").value;

var data = ["yay"];

search.onclick = function(){

for (i=0; i<data.length; i++){

    if (data[i] === formInput) {
      alert(data[i]);
    }   
      else{ alert("not working yet");   }
}
};

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:59:21.383

将获取输入的行移到 onclick 函数中：

```
<form>
 <input type="text" id="formInput"></input>
 <input type="button" id="search"></input>
</form>
<script>
 var search = document.getElementById("search");
 var data = ["yay"];

 search.onclick = function() {
    var formInput = document.getElementById("formInput").value;

    for (i=0; i<data.length; i++){
       if (data[i] == formInput) {
          alert(data[i]);
       } else {
          alert("not working yet");
       }
    }
 };
</script> 
```

目前，它只在页面加载时（在用户有机会输入任何内容之前）读取表单输入一次。如果您将该行放在`onclick`函数中，那么它会在搜索数组之前检查输入。

# python - python中的类似linq的求和函数

> ID：12734839
> 
> 赞同：2
> 
> 时间：2012-10-04T19:53:16.023
> 
> 标签：python, linq

在我用 c# 编程一段时间后，我开始用 python 编程，并且在 c# 中我经常使用以下操作：

```
list.sum(x => x * 2); 
```

其中`list`包含某种数字。
python中有这样的东西吗？例如我想这样做：

```
>> arr = range(1,10)
>> linq_like_sum(lambda x :  x**2 , arr) 
```

并得到 arr 的平方和。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T19:54:11.857

只需使用生成器表达式：

```
lst = [1, 2, 3, 4, 5]
sum(x*x for x in lst)

> 55 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-04T19:54:25.957

尝试使用内置的生成器表达式`sum()`：

```
sum(x ** 2 for x in arr) 
```

# node.js - 在 Express/Jade 视图中访问当前请求

> ID：12734850
> 
> 赞同：19
> 
> 时间：2012-10-04T19:53:59.780
> 
> 标签：node.js, express, pug

我有一个布局 Jade 视图，它有一个通过无序列表提供的菜单，我想将其设置为`<li>`在`<li class="active">...</li>`浏览器中呈现当前页面时。

我假设我必须访问当前请求以确定何时在`<li>`

我找不到任何有关如何执行此操作的示例，因此希望有人可以提供帮助

谢谢

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-10-04T20:26:38.577

在您的路线中调用 res.render() 之前尝试此操作：

```
res.locals.path = req.path;
res.render('/page'); 
```

或者

```
res.render('/page', { path: req.path }); 
```

然后，您将不得不在您的视图中执行一堆 if/else 语句（如上述解决方案所示）。

```
- if(currentUrl === '/')
    li(class='active')
        a(href='/') Current Driver Standings
- else
    li
        a(href='/') Current Driver Standings 
```

但是，我更喜欢在客户端执行此操作，以使我的模板文件尽可能多地避免逻辑：

在页面模板文件中（这是ejs，不知道如何在jade中回显）：

```
<body data-path="<%= path %>"> 
```

然后使用 jQuery，您可以从 body 中获取路径并附加一个活动类：

```
$(function(){
    var path = $('body').attr('data-path');
    $('nav li a[href='+path+']').parents('li').addClass('active');
}); 
```

**更新：**您也可以只使用`var path = window.location.pathname`而不是将其保存到属性`body`

```
//no need to save path to <body> tag first:

$(function(){
    var path = window.location.pathname;
    $('nav li a[href='+path+']').parents('li').addClass('active');
}); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-18T15:47:20.897

这是一种更简洁的方法，服务器端：

在您的`routes.js`（或任何地方）定义代表您的导航的对象数组，如下所示：

```
var navLinks = [
  { label: 'Home', key: 'home', path: '' },
  { label: 'About', key: 'about', path: '/about' },
  { label: 'Contact', key: 'contact', path: '/contact' }
] 
```

将变量传递`navLinks`给您的视图，以及您想要突出显示的项目的键：

```
res.render('home', { title: 'Welcome!', section: 'home', navLinks: navLinks }); 
```

您还可以将`navLinks`变量添加到`app.locals`并节省您自己始终必须将其显式提供给视图。

然后在您的翡翠模板中循环链接数组并将活动类设置在其键与提供的部分匹配的类上：

```
ul(class='nav nav-list')
  - navLinks.forEach(function(link){
    - var isActive = (link.key == section ? 'active' : '')
    li(class=isActive)
      a(href=link.path)= link.label
  - }) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-10T10:09:16.183

在你的路由文件中传递 req.originalUrl。例如：在你的 /routes/about.js

```
router.get('/', function(req, res) {
 res.render('about', { 
  url: req.originalUrl
 });
}); 
```

然后，在你的玉模板上写下 if else 条件

```
 if(url==='/about-us')
     li(class='active')
      a(href='about-us') About Us
    else
     li
      a(href='about-us') About Us 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-04-07T15:21:56.520

您可以在 app.js 中使用全局变量，例如：

```
// Global vars
app.use( function ( req, res, next ) {

    // rest of your code ...

    res.locals.current_url = req.path;

    // rest of your code ...

	  next();

} );

// then in your .jade file:
```

```
ul.navbar-nav.mr-auto
    li(class="nav-item #{ current_url === '/page1' ? 'active' : ''}")
         a.nav-link(href='/page1') Page1
```

像这样，您可以在您的视图文件中全局使用“current_url”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-04T20:12:17.337

我想出了这个可行的方法，但是我不确定它是否是最佳实践。请让我知道任何一种方式：

```
response.render("current/currentSchedule", {
                title: "Current Race Schedule",
                currentUrl: req.path,
            });

ul(class='nav nav-list')
    li(class='nav-header') Current Season
    - if(currentUrl === '/')
        li(class='active')
            a(href='/') Current Driver Standings
    - else
        li
            a(href='/') Current Driver Standings
    - if(currentUrl === '/constructor-standings')
        li(class='active')
            a(href='/constructor-standings') Current Constructor Standings
    - else
        li
            a(href='/constructor-standings') Current Constructor Standings
    - if(currentUrl === '/current-schedule')
        li(class='active')
            a(href='/current-schedule') Current Race Schedule
    - else
        li
            a(href='/current-schedule') Current Race Schedule 
```

# error-handling - 在哪里可以找到 Windows 运行时的 COM 错误代码？

> ID：12734853
> 
> 赞同：0
> 
> 时间：2012-10-04T19:54:16.133
> 
> 标签：error-handling, windows-runtime

由于在使用 Windows 运行时时我们必须处理 COM 错误代码（HRESULT 值），所以我想知道在哪里可以找到有关错误代码的信息。我当然试过谷歌，但只找到了桌面应用程序的代码（http://msdn.microsoft.com/en-us/library/windows/desktop/dd542642%28v=vs.85%29.aspx）。可能相同，但 Windows 运行时肯定会在该列表中添加错误代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T20:17:14.970

您链接到的文档（[“COM 错误代码”](http://msdn.microsoft.com/en-us/library/dd542642.aspx)）应包含所有标准 HRESULT 值。请注意，也有可能显示为 HRESULT的[系统错误代码。](http://msdn.microsoft.com/en-us/library/ms681381.aspx)

标头中也定义了标准的 HRESULT 和错误代码`<winerror.h>`，它是 Windows SDK 的一部分（此标头还定义了`HRESULT_FROM_WIN32`函数，可用于将系统错误代码转换为等效的 HRESULT。

请注意，其他组件（例如第三方组件）可能会使用其他 HRESULT。每个组件都应该记录它使用了哪些 HRESULT 值以及它们的含义。

# javascript - 为什么我们不在 window.onload 中使用 ()？

> ID：12734863
> 
> 赞同：0
> 
> 时间：2012-10-04T19:54:55.400
> 
> 标签：javascript, function

在此代码的末尾（[完整代码在这里](http://pastehtml.com/view/cdub7qdxd.html)）

```
function addSongs() {
    var song1 = document.getElementById("song1");
    var song2 = document.getElementById("song2");
    var song3 = document.getElementById("song3");

    song1.innerHTML = "Blue Suede Strings, by Elvis Pagely";
    song2.innerHTML = "Great Objects on Fire, by Jerry JSON Lewis";
    song3.innerHTML = "I Code the Line, by Johnny JavaScript";
}
window.onload = addSongs; 
```

您将看到 addSongs 没有与 () 一起使用。

如果我将其更改为

```
window.onload = addSongs(); 
```

它不起作用。为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-04T19:57:09.053

当您拥有 时`addSongs()`，它会告诉 Javascript 立即执行该函数并将该调用的返回值分配给 onload 处理程序。

如果没有`()`，它会告诉 JS 引擎将函数本身分配给 onload。

例如，如果你有类似的东西

```
function x() {
   return 'hello';
}

// immediately assigns "hello" to the onload
window.onload = x(); 
```

这和做的一样

```
window.onload = 'hello'; 
```

并且在某些时候，每当触发 onload 处理程序时，JS 引擎都会尝试执行一个名为“hello”的函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T20:01:38.150

`addSongs`是一个函数，您可以将其分配给一个变量（即，在本例中为`window.onload`）。另一方面，`addSongs()`正在*调用*该函数，因此您将设置`window.onload`为返回的任何内容`addSongs()`。在这种情况下，这没什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T20:39:05.000

就像我们分配 int a = 5; 因为我们现在知道 a 是一个 int 并且我们可以为它分配一个整数值，就像类似 window.onload 是一个函数，你可以认为它是函数类型的数据类型，因此我们可以分配

```
window.onload=function(){ .. some code ... } 
```

或者我们可以使用

```
function abc(){ ... some code ...}
window.onload=abc; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T19:57:03.310

当您使用 addSongs() 时，它会立即执行它，而不是在调用它时。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-04T20:00:54.560

因为你设置`onload`为等于函数。

如果您调用该函数，那么您将设置`onload`为等于`return`该函数的值（在本例中为`undefined`）。

此外，您无法控制何时`onload/onready/onclick/etc`开火。这才是重点。您要求浏览器在其中一件事情发生时触发该功能 - 而不是之前。

# java - 有没有办法让 Android 布局在 Activity 中将尺寸重置为 Layouts/ImageView？

> ID：12734868
> 
> 赞同：0
> 
> 时间：2012-10-04T19:55:08.907
> 
> 标签：java, android, android-layout, orientation

当我启动一个活动时，它会使用一个为 fill_parent 的 ImageView 填充屏幕，因此该视图将使用我的示例填充屏幕，分别给出 600 和 940 的 X 和 Y 值。

当我更改屏幕的方向时，获取高度和宽度似乎返回相同的值。

我可以拥有它，这样当我旋转时，它会调整 ImageViews 的尺寸吗？

我正在查看 onConfigurationChanged() 到我放置代码的位置，但是当我使用

```
 DisplayMetrics dm = new DisplayMetrics();
 getManager().getDefaultDisplay().getMetrics(dm); 
```

它将返回全屏尺寸，而不是适用的画布。

我将如何使 ImageView 正确调整自身大小。

相关 XML 数据：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >
    <ImageView
        android:id="@+id/imageViewer"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:scaleType="matrix"
        android:src="@drawable/accept" />
</LinearLayout> 
```

**编辑：**我可以在方向更改时重新加载活动并通过保存的实例保存数据.....如果我的想法正确，那将完成它，但我不想重新启动活动，因为我真的认为不需要这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T20:12:43.430

您可以为此使用 OrientationEventListener，并在处理程序中为方向事件设置您想要的图像高度和宽度，例如，您可以扩展 OrientationEventListener，然后使用：

`public abstract void onOrientationChanged (int orientation)`

注意：当设备的方向发生变化时，会调用上一个方法。方向参数以度为单位，取值范围为 0 到 359。方向为 0 度，当设备处于自然位置时，90 度，左侧在顶部，180 度，倒置，270 度右侧是顶部。当设备接近平坦且无法确定方向时，返回 ORIENTATION_UNKNOWN。

在那里你可以编辑 ImageView 的高度和宽度。祝你好运：）

# java - 将 xstream 与 mysql 一起使用

> ID：12734870
> 
> 赞同：1
> 
> 时间：2012-10-04T19:55:22.120
> 
> 标签：java, database, xstream

我正在尝试使用 xStream 并将 mysql 值获取到 *.xml 文件。但是当我用下面的代码尝试这个时，它只是将第一个对象写入一个 xml 文件，然后除了第一个对象之外不添加任何东西。使用 xstream.toXML 或其他东西有问题吗？

```
 ResultSet kayit = st.executeQuery("select * from otel");
 XStream xstream = new XStream();
 FileWriter xmlFile = new FileWriter("D:\\OTEL.xml");
 while (kayit.next()) {
  Oteldata o = new Oteldata();
  o.name = kayit.getString("otelisim");
  o.room = kayit.getString("oteloda");
  o.konte = kayit.getString("otelkonte");
  String xml = xstream.toXML(o);
  xmlFile.write("<?xml version=\"1.0\"?>\n");
  xmlFile.write(xml + "\n");
  xmlFile.close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:43:49.020

您似乎开始了 while 循环，检索对象，使用 xstream.toXML(o)，然后进行写入，然后关闭写入文件。没有显示您的写循环的关闭。

尝试：

```
ResultSet kayit = st.executeQuery("select * from otel");
XStream xstream = new XStream();
FileWriter xmlFile = new FileWriter("D:\\OTEL.xml");
xmlFile.write("<?xml version=\"1.0\"?>\n");
while (kayit.next()) {
    Oteldata o = new Oteldata();
    o.name = kayit.getString("otelisim");
    o.room = kayit.getString("oteloda");
    o.konte = kayit.getString("otelkonte");
    String xml = xstream.toXML(o);
    xmlFile.write(xml + "\n");
}
xmlFile.close(); 
```

在循环之前为第一行执行初始写入，然后执行循环写入每个对象，关闭循环，然后关闭文件

# css - IE中的丑陋文字

> ID：12734871
> 
> 赞同：0
> 
> 时间：2012-10-04T19:55:24.493
> 
> 标签：css

我有一个使用以下 CSS 的 CSS 水平菜单列表：

```
#navigation li {
list-style: none;
display: block;
float: left;
width: 10em;
height: 2em;
text-align: center;
padding: .5em 0 0 0;
margin: 0;
border-left: .0625em solid #FFF;
border-right: .1em solid #CCC;
text-shadow: .0625em .0625em .0625em #ffffff;
filter: dropshadow(color=#ffffff, offx=1, offy=1); 
```

在 Safari、Chrome、Opera 和 Firefox 中，一切看起来都很棒，但 IE 却导致了问题（惊喜！）。文字看起来块状和毁容。我的假设是我对文本阴影做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T23:40:38.647

```
filter:DropShadow(Color=#ffffff, OffX=1, OffY=1) 
```

此外，在应用文字阴影时，还必须设置背景颜色，因为没有背景颜色，阴影会很难看

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T16:35:03.497

你没有做错任何事。在 IE 中应用阴影滤镜会关闭元素的抗锯齿功能。这是一个已知问题。

这是一个人想出的一个hacky解决方法...... [http://learningtheworld.eu/2010/ms-box-shadow/](http://learningtheworld.eu/2010/ms-box-shadow/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T20:02:25.743

我认为`dropshadow`css需要像`filter:DropShadow(Color=#ffffff, OffX=1, OffY=1)`

# selenium - 海狸鼠截图

> ID：12734873
> 
> 赞同：4
> 
> 时间：2012-10-04T19:55:36.473
> 
> 标签：selenium, nunit, screenshot, coypu

在场景结束时，如果失败，我想拍照。以下代码不起作用：

```
[AfterScenario]
public void AfterScenario()
{
    if(ScenarioContext.Current.TestError != null)
    {
     WebBrowser.Driver.CaptureScreenShot(ScenarioContext.Current.ScenarioInfo.Title);
    }
} 
```

我认为这可能是因为我使用 Coypu（已包裹硒）启动浏览器。驱动程序没有实现“captureScreenShot”方法。所以我的问题是：当我使用 coypu 启动浏览器时，如何在场景之后截取屏幕截图？

启动浏览器的代码如下：

```
sessionConfiguration.Driver = typeof (SeleniumWebDriver);
sessionConfiguration.Browser = Drivers.Browser.Firefox; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T15:16:12.857

正如你所说，目前 Coypu 还没有实现这一点。原因是到目前为止我根本不需要截屏，直到现在也没有人问过。

要访问本机驱动程序（在您的情况下为 WebDriver），`BrowserSession.Native`您可以使用 WebDriver 的 GetScreenshot 方法。这最终会看起来像这样（免责声明：未经测试）：

```
var driver = (ITakesScreenshot) coypuBrowserSession.Native;

var screenshot = driver.GetScreenshot();

screenshot.SaveAsFile("c://screenshot.png", System.Drawing.Imaging.ImageFormat.Png); 
```

[我](https://github.com/featurist/coypu/issues/30)在 github 上为您打开了一个问题，将其添加到 Coypu 的 BrowserWindow API

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-13T13:13:14.823

这现在在 Coypu 中原生可用。您可以在此处找到文档：

[https://github.com/featurist/coypu#screenshots](https://github.com/featurist/coypu#screenshots)

# php - 查询树的项目数

> ID：12734879
> 
> 赞同：2
> 
> 时间：2012-10-04T19:56:02.930
> 
> 标签：php, mysql, sql, count, hierarchy

假设我有一张这样的表：

```
CREATE TABLE IF NOT EXISTS `node_list` (
    `nid` int(11) NOT NULL AUTO_INCREMENT,
    `parent` int(11)
        COMMENT \'Node`s parent (nid).\',
    PRIMARY KEY (`nid`)
) 
```

对于给定的节点 ID，我想计算其所有后代的数量。然而：

```
SELECT COUNT(*) FROM `node_list` WHERE `parent`=? 
```

仅返回直接子级的计数。`for`在没有混乱循环的情况下这样做的好方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:42:21.437

鉴于这些限制，没有办法。在这种情况下，您要么检索*所有*树并构建一个“山”客户端，要么执行递归查询，无论在特定情况下性能如何。

**通过具有固定数量的层次结构级别**的附加约束，您可以使用多个 JOIN 来执行此操作。

在一般情况下，有几个结构修改可以克服这些限制。在实践中，您放宽了“这是我的表结构”的约束，允许添加额外的字段。

例如，您可以用一个`left_id`值来补充节点结构，并确保在深度优先访问树时所有节点 ID 都是按顺序排列的：

```
1 --- 2 -+- 3 -+- 4
         |     |
         |     +- 5
         +- 6 --- 7 
```

在这种情况下，节点 3 将存储值“5”，节点 6 将存储值“7”，节点 2 也将存储值“7”。*每个节点将其子节点的 LeftID 与其自己的 ID 之间的最大值存储在 LeftID 中*。

所以无子节点的 LeftID 等于它们的 ID。节点 1 的 LeftID 为 7，因为 LeftID 为 2，它是从 6 得到的。

在这种情况下，如果序列中没有空洞，则很容易*计算节点；*一个节点的所有后代都是那些 ID 在起始节点的 ID 和它的 LeftID 之间的节点；叶子通过 LeftID 等于 ID 来识别。

所以“从节点 id 17 下降的所有叶子”将是

SELECT child.* FROM table AS parent JOIN table AS child ON (child.id > parent.id AND child.id <= parent.leftid ) /* Descendant */ WHERE child.id = child.leftid /* Leaf */ AND parent.id = 17; /*父母 17 岁

如果您希望能够进行修剪和分支，则这种结构很难维护，因为您需要重新编号从修剪点到分支点之间的所有节点，以及移动的节点。

如果您只对计数感兴趣，另一种可能性是保留一个儿童计数器。这可以通过迭代更新它来维护，选择所有叶子并将它们的计数器设置为 0（您通过 LEFT JOIN 识别叶子）；然后所有那些有 NULL 计数器的父母有非 NULL 计数器的孩子，将他们的计数器更新`SUM()`为孩子的计数器加上`COUNT()`孩子自己的计数器；并继续直到更新的行数变为零，因为所有节点都有非 NULL 计数器。在修剪和分支之后，您只需将所有计数器设置为 NULL 并重复。

最后一种方法需要为每个层次结构级别进行反射连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T20:03:42.700

再挖一点...

```
With Nodes As 
( 
Select s.nid, s.parent
From nodelist s
Where s.nid = @ParentID 
Union All 
Select s2.nid, s2.parent
From nodelist s2
    Join Nodes
        On Nodes.nid = s2.parent 
) 
Select Count(*)
From Nodes 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-01T06:22:30.807

```
$tree = array();
$tree[0][1] = 'Electronics';    
$tree[0][0][1] = 'Mobile';  
$tree[0][0][0][2] = 'Samsung';  
$tree[0][0][0][0][3] = ' Toppings Flip Cover for Samsung Galaxy S6';    
$tree[0][0][0][0][0][4] = 'Maac Online Flip Cover for Samsung Galaxy S6';   
$tree[0][0][0][0][0][0][5] = 'Shine Flip Cover for Samsung Galaxy S6';  
$tree[0][0][0][0][0][0][0][6] = 'SNE Flip Cover for Samsung Galaxy S6';

print_r($tree); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-04T20:40:54.827

对于具有已知最大层数的层次结构，您可以使用级联连接执行单个查询以查找记录计数。如果层数大于三层或四层，这可能不漂亮，但应该可以。

```
select count(*)
from node_list n1
outer join node_list n2 on n2.parent = n1.nid
outer join node_list n3 on n3.parent = n2.nid
outer join node_list n4 on n4.parent = n3.nid 
```

...依此类推，您可以根据需要设置多个级别。尽量不要太多，否则性能可能会受到影响。

在现实世界中，大多数等级系统的深度实际上是相当有限的。即使它们在理论上是无限的。例如，站点菜单可能允许无限级别的结构，但超过三到四个就很难使用。是否对嵌套施加限制取决于您，但这可能会使事情变得更容易。

但是，如果您确实有一个开放式层次结构，您不知道它可以走多远，或者如果上述查询太慢，那么您将需要一个循环。该循环是在 MySQL 存储过程中还是在 PHP 中都无关紧要。您将需要一种方式或另一种方式的循环。不过，它当然不需要`for`你担心的循环混乱。

我会用递归 PHP 函数来做。也许是这样的：

```
function countDescendants($db, $nid) {
    $total = 0;
    $query = "select nid from Nodes where parent = ".(int)$nid;
    $res = $db->query($query);
    foreach($res as $data) {
        $total += countDescendants($db, $data['nid']);
    }
    $total += $res->num_rows;
    return $total;
} 
```

然后你可以调用它并用一行代码得到你的答案：

```
$number_of_descendants = countDescendants($starting_nid); 
```

一个相当简单的递归函数（我假设您正在使用`mysqli`您的数据库，并且您的连接已经排序以传递给函数）。

当然，如果你有一个非常大的层次结构，或者你要多次查询它，它可能会有点慢，但有一些方法可以通过改进我给出的这个基本示例来加速它。例如，您可以使用准备好的语句查询，并使用不同的 nid 值填充相同的语句：这将节省大部分数据库工作。但是对于小层次结构的简单使用，上面的代码应该没问题。

使用这些技术中的任何一个的一个大缺陷是，如果您的节点结构中有一个循环——即，一个节点具有它自己的一个后代作为它的父 ID。这种情况会导致上述 PHP 代码出现无限循环，并且在嵌套连接 SQL 查询的情况下会导致记录计数严重倾斜。无论哪种情况，如果您的系统可能出现这种情况，您将需要针对它编写代码。但这确实使事情复杂化，所以我不会在这里讨论它。

希望有帮助。

（注意：上面的代码未经测试：我直接将其输入答案而没有运行它；如果有任何错别字，我们深表歉意）

# objective-c - UIImageView 增加特定区域的亮度

> ID：12734882
> 
> 赞同：2
> 
> 时间：2012-10-04T19:56:14.997
> 
> 标签：objective-c, ios, xcode, uiimageview, uiimage

如何增加 UIImageView 特定区域的亮度，例如：我有一个带有图像的图像视图。我想增加该图像特定椭圆区域的图像亮度。我知道如何增加整个图像的亮度，但不知道特定的椭圆区域。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:08:54.773

您可以添加一个黑色`UIView`并在其上应用特定的 alpha（这将控制您希望您的视图有多暗）并将蒙版层附加到此具有椭圆的视图。对于被遮盖的视图部分，它会更亮。

`Quartzcore`使用图层/蒙版时需要导入框架。蒙版是您的视图层 ( `[yourView layer].mask`) 的属性。

# c# - .aspx 文件中的 Visual Studio 2010 缩进在启动新代码块后中断

> ID：12734883
> 
> 赞同：0
> 
> 时间：2012-10-04T19:56:24.333
> 
> 标签：c#, asp.net, visual-studio-2010, formatting

我有一段 C# 代码，我想在其中编写一些 HTML：

```
if ( someCondition ) {
    %><span>its_important_my_span_has_no_spaces_around_it</span><%
}

int x = 0;
// ... 
```

但是在 Visual Studio 2010 中，在 <% 之后，我按 Enter 并得到

```
if ( someCondition ) {
    %><span>its_important_my_span_has_no_spaces_around_it</span><%
                                                                     }

                                                                     int x = 0;
                                                                     // ... 
```

它甚至会自动以这种方式重新格式化（例如，当我键入分号时）。

我一直在 HTML 和 C# 中的“**选项**” > **“文本编辑器”**区域中寻找要打开或关闭的内容，但我不知所措。

我究竟做错了什么？

**编辑：**

如果我首先突出显示**}**并重新键入它，它会将其放在正确的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:07:17.913

这将永远是一个 PITA。简单的方法来处理它。在您按下 Enter（或任何自动格式化的操作）后立即按 Alt+Backspace 并继续。

或者，您可以转到您的文本编辑器选项并删除 C# 的所有自动格式设置，但我认为您不会想要这样做，因为这将适用于您的所有代码隐藏文件。

# python - Scapy - 不存在的属性/字段返回值

> ID：12734886
> 
> 赞同：1
> 
> 时间：2012-10-04T19:56:38.210
> 
> 标签：python, scapy

我一直在编写自己的协议，`Scapy`并且在计算长度字段时遇到了问题（[请参阅此处](https://stackoverflow.com/questions/12413822/scapy-variable-length-field-covering-multiple-fields)）。我在位域定义的长度层中遇到的另一个问题是，如果我调用返回未定义层中的长度字段，它将返回一个值。如果我调用`hasattr(pckt[layer], 'field')`，它将返回“true”，表示属性/字段存在。这对我来说没有任何意义，因为图层定义如下所示：

```
class Layer(Packet):
   name = "Layer"
   fields_desc = [ BitField("Padding", 15, 4),
           BitField("Digit", 0, 4) ] 
```

如您所见，定义的唯一属性/字段是`Padding`和`Digit`。 `Length`没有定义，那么为什么`Scapy`返回一个整数和`true`我正在执行的两个调用？

# ios - 开始编辑时清除 UITextView 上的文本

> ID：12734888
> 
> 赞同：2
> 
> 时间：2012-10-04T19:56:41.827
> 
> 标签：ios, ios5, uitextview

在 UIViewController 上，我放置了一个可编辑的 UITextView，其中包含一些要在加载时显示的文本说“一些评论”。我的要求是，当我在文本视图内单击时，应清除预定义的文本，即文本视图应为空白，并且不应再在其上显示“一些评论”文本。

我使用 textViewDidBeginEditing 如下，但没有击中方法本身：

```
- (void)textViewDidBeginEditing:(UITextView *)textView
{
    textView.text = @"";
} 
```

我是否需要为此引发任何事件，或者我需要定义其他任何内容以使程序在用户在文本视图内单击时点击该方法。

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T20:01:28.553

通过将其连接到文件的所有者，在 .Xib 文件中设置 UITextView 的委托。

```
 myTextView.delegate = self; 
```

# c# - 如何访问在Gridview的页脚模板中定义的“命令名”？

> ID：12734893
> 
> 赞同：0
> 
> 时间：2012-10-04T19:56:46.153
> 
> 标签：c#, asp.net, gridview, .net-2.0, rowcommand

所以我有一个网格视图，在 FooterTemplate 中我为按钮添加定义了一个命令名。这里的代码：

```
 <asp:TemplateField>
                                    <HeaderStyle Font-Size="XX-Small" Font-Names="Verdana" Font-Bold="True" VerticalAlign="Top"></HeaderStyle>
                                    <FooterTemplate><asp:LinkButton CommandName="Insert" Text="Add credit" ID="btnAdd" OnClick="btnAdd_Click" Runat="server" Font-Size="XX-Small  "
                                            Font-Names="Verdana" Font-Bold="True" ForeColor="#5BB1E6" Width="7%"></asp:LinkButton>
                                    </FooterTemplate>
                                </asp:TemplateField> 
```

就像这个“添加”按钮一样，我还有另一个名为“编辑”的按钮，我想将所有这些按钮的 SQL 语句放在一个函数中。我想做这样的事情：

```
protected bool AddNewCredit()

        if (e.Commandname == "Insert")
    {
    Do This}
    if (e.Commandename == "Edit")
    {
    Do this
    } 
```

等等。问题是当我尝试访问 e.rowcommand 时，它没有在 e 之后捕获命令名。

感谢帮助实现我的目标，即能够在函数中读取 e.commandname 的值。非常感谢大家:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:16:00.230

将其更改为：

```
<asp:LinkButton CommandName="Insert" Text="Add credit" ID="btnAdd" OnCommand="btnAdd_Click" Runat="server" Font-Size="XX-Small  "
                                        Font-Names="Verdana" Font-Bold="True" ForeColor="#5BB1E6" Width="7%"></asp:LinkButton> 
```

然后将您的 btnAdd_Click 函数更改为：

```
public void btnAdd_Click(object sender, CommandEventArgs e)
{
    string sCommandName = e.CommandName;
} 
```

如果要捕获 CommandName 和 CommandArgument，则需要使用 OnCommand 事件，而不是 OnClick。

# jquery - Bootstrap CSS 不适用于使用 JQuery 动态添加的新 HTML

> ID：12734894
> 
> 赞同：8
> 
> 时间：2012-10-04T19:56:49.950
> 
> 标签：jquery, html, css, twitter-bootstrap

我正在使用 Bootstrap 来设置我的网页样式，它几乎可以完美运行，但是当我尝试使用 $.append() 将新的 html 添加到页面时。那么新的 html 不会获得默认的引导样式。这是我的相关html：

```
 <div id="lines">
        <div id="line1">
            <input type="tel" class="Numbers" id="Number1" />
            <input type="tel" class="Numbers" id="Number2" />
            <input type="tel" class="Numbers" id="Number3" />
            <input type="tel" class="Numbers" id="Number4" />
            <input type="tel" class="Numbers" id="Number5" />
            <input type="tel" class="Numbers" id="Number6" />
            <input type="tel" class="Numbers" id="StrongNumber1" style="background-color:cyan"/>
            <button class="btn btn-primary addbtns" id="btnAdd1" onclick="addLine()">+</button>
            <button class="btn btn-primary addbtns" id="btnMinus1" disabled="disabled">-</button>
        </div>
    </div> 
```

这是我的 JQuery：

```
function addLine() {
$('#btnAdd' + lineCounter).attr('disabled', 'true');
$('#btnMinus' + lineCounter).attr('disabled', 'true');

++lineCounter;

var line = "<div id='line" + lineCounter + "'>" +
                "<input type='tel' class='Numbers' id='Number" + lineCounter + "' />" +
                "<input type='tel' class='Numbers' id='Number" + lineCounter + "' />" +
                "<input type='tel' class='Numbers' id='Number" + lineCounter + "' />" +
                "<input type='tel' class='Numbers' id='Number" + lineCounter + "' />" +
                "<input type='tel' class='Numbers' id='Number" + lineCounter + "' />" +
                "<input type='tel' class='Numbers' id='Number" + lineCounter + "' />" +
                "<input type='tel' class='Numbers StrongNumber' id='StrongNumber" + lineCounter + "' style='background-color:cyan' />" +
                "<button class='btn btn-primary addbtns' id='btnAdd" + lineCounter + "' onclick='addLine()'>+</button>" +
                "<button class='btn btn-primary addbtns' id='btnMinus" + lineCounter + "' onclick='removeLine()'>-</button>" +
            "</div>";
$('#lines').append(line).fadeIn('slow');
} 
```

* * *

编辑：好的，我试图用最简单的页面和一个简单的附加来重现这个错误。还像@Sherbrow 建议的那样将 JS ' 切换为 " ，但它仍然无法正常工作..

这是我的 HTML：

```
<html xmlns="http://www.w3.org/1999/xhtml">
<link href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css" rel="stylesheet">
<link href="test.css" rel="stylesheet"/>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script src="test.js"></script>
<head></head>
<body dir="rtl">
<div id="lines">
        <div id="line1">
            <input type="tel" class="Numbers" id="Number1" />
            <input type="tel" class="Numbers" id="Number2" />
            <input type="tel" class="Numbers" id="Number3" />
            <input type="tel" class="Numbers" id="Number4" />
            <input type="tel" class="Numbers" id="Number5" />
            <input type="tel" class="Numbers" id="Number6" />
            <input type="tel" class="Numbers" id="StrongNumber1" style="background-color:cyan"/>
            <button class="btn btn-primary addbtns" id="btnAdd1" onclick="addLine()">+</button>
            <button class="btn btn-primary addbtns" id="btnMinus1" disabled="disabled">-</button>
        </div>
    </div>
</body>
</html> 
```

我的CSS：

```
body
{
    background-color:#E46C0B;
    text-align:center;
}
.Numbers
{
    width: 16px;
} 
```

我的 JavaScript：

```
var lineCounter=1;
function addLine() {
$('#btnAdd' + lineCounter).attr('disabled', 'true');
$('#btnMinus' + lineCounter).attr('disabled', 'true');

++lineCounter;

var line = '<div id="line' + lineCounter + '">' +
                '<input type="tel" class="Numbers" id="Number' + lineCounter + '1" />'   +
                '<input type="tel" class="Numbers" id="Number' + lineCounter + '2" />' +
                '<input type="tel" class="Numbers" id="Number' + lineCounter + '3" />' +
                '<input type="tel" class="Numbers" id="Number' + lineCounter + '4" />' +
                '<input type="tel" class="Numbers" id="Number' + lineCounter + '5" />' +
                '<input type="tel" class="Numbers" id="Number' + lineCounter + '6" />' +
                '<input type="tel" class="Numbers StrongNumber" id="StrongNumber"' +  lineCounter + '" style="background-color:cyan" />' +
                '<button class="btn btn-primary addbtns" id="btnAdd"' + lineCounter + '" onclick="addLine()">+</button>' +
                '<button class="btn btn-primary addbtns" id="btnMinus"' + lineCounter + '" onclick="removeLine()">-</button>' +
            '</div>';
$('#lines').append(line);
} 
```

我究竟做错了什么？

感谢您的回答:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T13:44:52.843

CSS 不应该应用于新创建的 DOM 元素。然而，这可能发生在 JavaScript 上。

无论是否真的解决了问题，您的代码中都有一些需要更改的地方：

*   ID 只能使用一次。类可以重用。请将您的`line`和`lines`ID 更改为类，以便您可以创建多个元素并将它们全部设置在一个保护伞下。
*   不要担心 " 或 '。只要 "s close " 和 ' close 's，JavaScript 都可以正常工作。
*   我注意到您正在设置输入框的宽度。确保尚未`min-width`指定。

如果这些建议不起作用，请创建一个[JSFiddle](http://jsfiddle.com)以便我们重现问题。

# ruby-on-rails - active_admin 中没有路由匹配 [PUT] 错误

> ID：12734896
> 
> 赞同：0
> 
> 时间：2012-10-04T19:56:54.820
> 
> 标签：ruby-on-rails, routing

在 active_admin partials 创建了一个表单输入：

```
<%= semantic_nested_form_for @item, :url => admin_items_path(@item) do |f| %>
  <fieldset class="inputs">
    <ol>
      <%= f.input :category %></br>
      <%= f.input :title  %>
      <%= f.input :photo1 %>
      <%= f.input :photo2 %>
    </ol>
  </fieldset>
  <%= f.fields_for :ItemColors do |i| %>
    <fieldset class="inputs">
      <ol>
        <%= i.input :DetailColor %>
        <%= i.input :size,  :input_html => { :size => "10" } %>
        <%= i.link_to_remove "remove" %>
      </ol>
    </fieldset>
  <% end %>
  <%= f.link_to_add "add", :ItemColors %>
  <%= f.actions %>
<% end %> 
```

创建一个新项目，好的创建并抛出新项目，但如果我更新现有项目被路由到当这样的路径存在时发生错误：

```
No route matches [PUT] "/admin/items.150" #150 is item_id 
```

耙路线：

```
batch_action_admin_items POST   /admin/items/batch_action(.:format)   admin/items#batch_action
admin_items GET                 /admin/items(.:format)                admin/items#index
POST                            /admin/items(.:format)                admin/items#create
new_admin_item GET              /admin/items/new(.:format)            admin/items#new
edit_admin_item GET             /admin/items/:id/edit(.:format)       admin/items#edit
admin_item GET                  /admin/items/:id(.:format)            admin/items#show
PUT                             /admin/items/:id(.:format)            admin/items#update
DELETE                          /admin/items/:id(.:format)            admin/items#destroy 
```

帮助解决这个问题

**UPD**

我发现了错误，但还不知道如何修复它

升级是一个请求：

```
PUT "/admin/items.150" 
```

但应该：

```
PUT "/admin/items/150" 
```

我不明白地址出现在哪里“。”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:06:18.433

您的表单正在提交数据，`:method => POST`而您的路线正在预期`PUT`，`POST`仅匹配

```
POST /admin/items(.:format) admin/items#create 
```

所以它认为你的 ID 是一个`.:format`参数。并因此失败。您需要将表单 :method 更改为`PUT`而不是`POST`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T20:08:03.760

你应该能够做到这一点：

```
<%= semantic_nested_form_for [:admin, @item] do |f| %> 
```

正如@cdesrosiers 指出的那样，`No route matches [GET] "/items/152"`您随后得到的错误可能是因为您`@item`在控制器`create`和`update`操作中重定向到，而实际上您需要这样做：

```
redirect_to admin_item_path(@item) 
```

# c# - 自定义 XML 文件的应用程序设置、加载和错误处理

> ID：12734899
> 
> 赞同：0
> 
> 时间：2012-10-04T19:57:02.517
> 
> 标签：c#, .net, xml

我正在开发一个遗留应用程序，该应用程序使用静态类来存储从自定义 XML 文件中读取的设置。但是，作为对模块的轻微升级的一部分，客户希望在运行时查看缺少哪些字段。
考虑以下 Settings.xml 文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<appSettings>
    <configuration>
        <API>
            <log>
                <type>09</type>
                <location>C:\Test\Test.log</filename>
            </log>
        </API>
    </configuration>
</appSettings> 
```

当前使用 XMLReader 将设置读入静态类（如下所示）：

```
 using (XmlTextReader xmlReader = new XmlTextReader("Settings.xml"))
        {
            xmlReader.ReadToFollowing("API");
            xmlReader.ReadToFollowing("log");
            xmlReader.ReadToFollowing("type");
            this.logtype = xmlReader.ReadElementContentAsString(); 
        //snip...
        } 
```

相同的代码用于读取每个设置。一定有更好的方法。有什么方法可以将 XML 值读入每个相应的属性，如果它为空则生成错误？
我正在尝试这样设计静态设置类：

```
public static class Settings
    {
        private static string logtype

        public static string LogType
        {
            get
            { return logtype; }

            set
            { logtype = value; }
        }
    } 
```

然后使用类似下面的东西来“抓取”这些值：

```
public static void initSettings()
        {
            appSettings.LogType = read the configuration\API\log\type field from xml;
        } 
```

我很确定我只是在属性构造函数中检查空字符，但是我将如何执行 initSettings 方法的“从 xml 读取 configuration\API\log\type 字段”部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T03:28:35.453

使用 LINQ2XML ..它**很酷**

```
XELement doc=XElement.Load("yourXML.xml");

var LogList=doc.Descendants("configuration").Descendants("API").Descendants("log")
.Select(x=>
new
{
type=x.Element("type").Value;
location=x.Element("location").Value;
}
); 
```

现在您可以使用 for-each 循环访问 logList 中的每个日志

```
foreach(var log in logList)
{
Console.WriteLine(log.type);
Console.WriteLine(log.location);
} 
```

你也可以检查它是否为空

```
if(log.type==""){//its empty} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T20:30:01.563

您可以使用 XMLDocument / XPath。像这样的东西：

```
XmlDocument doc = new XmlDocument();
doc.Load("Settings.xml");
appSettings.LogType = doc.SelectSingleNode("/appSettings/configuration/API/log/type").InnerText; 
```

其实我更喜欢使用序列化。也许标准序列化一个[YAXLib](http://www.codeproject.com/Articles/34045/Yet-Another-XML-Serialization-Library-for-the-NET#deser)，它提供了一些有用的错误处理。

编辑：对我来说，它正在使用 InnerText。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-05T01:15:54.423

我个人更喜欢使用 XmlNodeList。

```
XmlDocument xmlDoc = new XmlDocument();
xmlDoc.Load("Settings.xml");
// Get element from xml.
XmlNodeList type = xmlDoc.GetElementsByTagName("type");
// The following line assumes that there is only 1 type entry
appSettings.LogType = type[0].InnerText; 
```

如果您想获取多个条目，只需添加一个 for 语句即可。

```
for (int i = 0; i < type.Count; i++)
{
    // Do stuff
    appSettings.LogType = type[i].InnerText;
} 
```

# linux - 启用了 MAP_FIXED 标志的 nmap EPERM 错误

> ID：12734909
> 
> 赞同：2
> 
> 时间：2012-10-04T19:57:32.310
> 
> 标签：linux, mmap

我有一个简单的 mmap 程序，它在两台 linux 机器上的行为不同：

> 猫交流

```
 #include <sys/types.h>
   #include <sys/stat.h>
   #include <fcntl.h>
   #include <errno.h>

   #include <sys/mman.h>
   #include <err.h>
   #include <stdio.h>
   #include <stdlib.h>
   #include <string.h>
   #include <unistd.h>

   int
   main(void)
   {
           int fd = -1;
           char *A, *zero;

           if ((fd = open("./a.out", O_RDONLY, 0)) == -1)
                   exit(1);

           A = mmap(NULL, 65536, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, fd, 0);

           if (A == MAP_FAILED)
              printf("error %d, errno=%d\n", A, errno);
           else
               printf("OK %d\n", A);
           return (EXIT_SUCCESS);
   } 
```

在一台机器`mmap`上成功返回，但在另一台机器上打印错误（errno 为 1）。

结果的相关差异`strace`是：

好一个：

```
(2.6.9-78.ELsmp #1 SMP Wed Jul 9 15:46:26 EDT 2008 x86_64 x86_64 x86_64 GNU/Linux)
open("./a.out", O_RDONLY)               = 3
mmap(NULL, 65536, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0) = 0 
```

失败之一：

```
( 2.6.18-194.26.1.el5 #1 SMP Fri Oct 29 14:21:16 EDT 2010 x86_64 x86_64 x86_64 GNU/Linux)
open("./a.out", O_RDONLY)               = 3
mmap(NULL, 65536, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0) = -1 EPERM (Operation not permitted) 
```

在失败的那个中，如果我去掉 MAP_FIXED 标志，mmap 就会成功。似乎失败的进程没有可用于映射的内存空间 [0, 65535]。

我不知道在哪里寻找这个问题？不同行为和失败的原因可能是什么？或者更具体地说，如果我猜测故障是由于不可用 [0,65535] 造成的，那么可能是什么原因导致一台机器可用而另一台机器不可用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-05-06T14:38:02.740

您已指定`MAP_FIXED`地址为零。默认情况下，在最新版本的 Linux 上，并且可以在一些早期版本上进行配置，禁止在低虚拟地址进行映射，以防止利用内核空指针取消引用错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-31T00:00:59.893

根据手册页 mmap MAP_FIXED `[Doesn't] interpret addr as a hint: place the mapping at exactly that address.`。[addr]ess 在您的示例中为 NULL（第一个 mmap 参数）。

NULL 几乎总是映射到零页，因此 EPERM 可能是预期的响应。

它之前的工作案例可能是一个错误（A 是否映射到包含文件内容的零页面？）

# android - 如何在操作栏环境中处理菜单按钮单击

> ID：12734912
> 
> 赞同：1
> 
> 时间：2012-10-04T19:57:43.537
> 
> 标签：android, android-layout, android-actionbar, android-menu, design-guidelines

与新[指南](http://developer.android.com/guide/topics/ui/actionbar.html)相关，我将标准菜单替换为操作栏。由于设计一致，我想在所有可以使用操作栏的设备上使用操作栏。但是有很多设备支持操作栏并且仍然有一个菜单按钮。如何处理这些设备？如果用户单击菜单按钮并且没有任何反应，我认为在某种程度上感觉不对。我知道，我可以捕捉到按钮的点击，但那该怎么办呢？对此点击有何反应？是否有一些方法/通常的方式将用户的注意力指向操作栏？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T20:04:35.450

当用户单击菜单按钮时，您的所有操作项（包括溢出项）都会出现。它已经照顾好了。

菜单选项将从底部弹出，就像使用旧式菜单一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T20:06:48.423

如果您有溢出菜单项，则菜单按钮将打开溢出菜单。如果你不这样做，那么是的，菜单按钮什么也不做。我不认为这种行为对用户来说很奇怪——有很多应用程序没有菜单。否则，我想您可以让您的操作栏或菜单项短暂闪烁不同的颜色。但这绝不是标准。

# c# - 有没有办法在 MSTest 失败后运行代码，并且只有在它失败后才运行代码

> ID：12734916
> 
> 赞同：0
> 
> 时间：2012-10-04T19:57:55.100
> 
> 标签：c#, mstest, coded-ui-tests

我已经创建了编码的 UI 测试，我想在测试失败后关闭并重新打开应用程序。现在我已经设置了我的测试，以便它在所有测试开始时运行应用程序，因为打开应用程序需要很长时间，而且我不希望或不需要在每次测试之前只打开其中一个。然而，现在，如果应用程序抛出错误，我的所有其他测试都会在不应该失败的情况下失败。有谁知道在我的一个测试失败后运行代码的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T21:24:12.697

您可以`TestContext.CurrentTestOutcome`在方法中使用属性`[TestCleanup]`来确定测试执行的结果。

您可能希望将此`[TestCleanup]`方法移至父类以使其可重用。

# ruby-on-rails - Rails：两级路由呈现根页面

> ID：12734917
> 
> 赞同：0
> 
> 时间：2012-10-04T19:58:01.050
> 
> 标签：ruby-on-rails, ruby, routes

我在创建通往我的应用程序的路线时遇到了一些问题，请帮助我:)

谁能向我解释为什么两级路由会呈现我的根页面，无论该路由是否真的存在。

让我举例说明：

我有路线： `match '/p/novo' => 'user_roles#new', :as => :new_urole`

我希望`user_roles`调用方法中的新方法，但它没有发生。而不是它，我的根页面被渲染并且日志显示：

> 在 2012-10-04 16:50:23 -0300 开始 GET "/p/novo" for 127.0.0.1 由 HomeController#index 处理为 HTML

如果我从路线中删除“/novo”，一切正常！

谁能帮我？

编辑：我不知道为什么，但是我将路由放在链接到我的根的路由上方并且它有效

我的`rake:routes` **工作**

```
 /auth/:provider/callback(.:format)                               session#create
        login_erro  /login/erro(.:format)                                            session#failure
            logout  /logout(.:format)                                                session#destroy
         new_urole  /p/novo(.:format)                                                user_roles#new
             event  /evento/:day/:month/:year/:url_name(.:format)                    events#show
                    /evento/:day/:month/:year/:url_name/confirmar_presenca(.:format) events#confirm_presence
painel_de_controle  /painel_de_controle(.:format)                                    users#control_panel
        city_index  /:state/:city(.:format)                                          home#index
              root  /                                                                home#index 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T20:10:44.093

new_urole 不是 GET 路由，它可能是 POST 或 PUT 路由。这就是它不匹配的原因，您的请求是 GET，所以它一直下降到第一个匹配的 GET 路由根。

您需要更改您的表单 :method 以匹配您的路由方法，POST 或 PUT。

# java - 如何在android中将图像按钮添加到gridview

> ID：12734921
> 
> 赞同：0
> 
> 时间：2012-10-04T19:58:42.200
> 
> 标签：java, android, gridview, imagebutton

我不知道如何将图像按钮添加到我的网格视图中。我必须为每个图像按钮执行单独的代码，因为它们做的事情完全不同。我该怎么做？

我最终改用了表格布局

代码：

```
package com.mysoftware.mysoftwareos.launcher;

import android.app.Activity;
import android.os.Bundle;
import android.view.KeyEvent;
import android.view.View;
import android.view.View.OnClickListener;

public class MainActivity extends Activity implements OnClickListener {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        //Import views

        //Setup onClickListener for the buttons

        //Setup GridView
    }

    @Override
    public boolean onKeyDown(int KeyCode, KeyEvent event) {
        if ((KeyCode == KeyEvent.KEYCODE_BACK)) {
        //Do nothing to prevent the back button to kill the launcher
        return true;
        }
    return super.onKeyDown(KeyCode, event);
    }

    public void onClick(View src) {
        switch(src.getId()) {
        }
    }
} 
```

xml:

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/mainLayout"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="#FF8090A0" >

<GridView
    android:id="@+id/appsGridView"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:numColumns="3" >
</GridView>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T22:16:03.950

gridview 有一个可以使用的 onitemclickedlistener，但是如果按钮应该做不同的事情，并且您不是从某种数据存储加载，那么您可能无论如何都不需要 gridview。几年前查看 Roman Nurik 的 DashboardLayout。您可以在 XML 或代码中将 ImageButtons 添加到它。如果您添加代码，您可以为每个按钮分配一个匿名的 onClickListener。如果您在 XML 中执行此操作，则可以将 onClick 属性设置为活动中的方法。

# java - GWT：当按钮在面板中时，如何仅触发按钮单击事件？

> ID：12734922
> 
> 赞同：0
> 
> 时间：2012-10-04T19:59:03.313
> 
> 标签：java, gwt

我在水平面板中有一个按钮。按钮和面板都有点击处理程序。

当我单击按钮时，我只希望按钮单击处理程序工作而不是面板之一，但它会触发两者。

如何避免触发面板点击处理程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:14:54.757

只需调用`event.stopPropagation()`您的点击处理程序。有关示例，请参见[此处](https://stackoverflow.com/questions/2662877/gwt-click-event-document)的答案。

# c# - 在提交到 TFS 之前强制进行代码分析

> ID：12734927
> 
> 赞同：3
> 
> 时间：2012-10-04T19:59:27.780
> 
> 标签：c#, visual-studio, tfs, static-analysis

我想强制我的所有团队成员在将 C# 源代码提交到 TFS 之前对其执行代码分析。在这个分析中，我想要代码质量（样式和可能的错误）。

我找到了 CodeRush、ReSharper，但它们非常昂贵。我也找到了 FXCop，但它只适用于 DLL 和 EXE 文件。我支持 StyleCop，但我找不到将其集成到 TFS 的方法，并且警告消息中没有“严重性”。

你知道任何具有这种功能的工具吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T20:29:11.597

假设您可以确保所有项目都为您的组织配置了正确的代码分析规则集，您可以将构建定义设置为“执行代码分析”为“始终”。

![执行代码分析](../Images/f6c407501162ad7e9aa9fc2a1ada26a2.png)

您可以在 Build Process Template 中添加对 StyleCop 的支持。查看[TFS 构建扩展](http://tfsbuildextensions.codeplex.com/wikipage?title=How%20to%20integrate%20the%20extensions%20into%20a%20build%20template&referringTitle=Documentation)以获取更多信息。

此外，在 TFS 2010+ 中，您可以使用门控签入（如[Bob](https://stackoverflow.com/users/279516/bob-horn)所说）来防止开发人员破坏您的构建。

# wcf - 反序列化消息队列的问题（已修改）

> ID：12734931
> 
> 赞同：1
> 
> 时间：2012-10-04T19:59:37.337
> 
> 标签：wcf, asp-classic, msmq

我正在用 MSMQ 做一个 WCF 服务，该服务发送一个 Person 类的实例，这个实例是来自队列的消息的内容。当 mansaje 被发送到队列时，以一种不保留为 XML 结构的方式序列化，否则作为消息中的二进制序列化。我想知道如何序列化消息，使其不是二进制的，可以反序列化为 xml 或反序列化二进制消息。

```
00 01 00 01 04 02 23 6E ......#n
65 74 2E 6D 73 6D 71 3A et.msmq:
2F 2F 6C 6F 63 61 6C 68 //localh
6F 73 74 2F 70 72 69 76 ost/priv
61 74 65 2F 6D 69 63 6F ate/mico
6C 61 03 07 56 02 0B 01 la..V...
73 04 0B 01 61 06 56 08 s...a.V.
44 0A 1E 00 82 99 36 68 D...??6h
74 74 70 3A 2F 2F 74 65 ttp://te
6D 70 75 72 69 2E 6F 72 mpuri.or
67 2F 49 50 72 6F 63 65 g/IProce
73 61 72 52 65 67 69 73 sarRegis
74 72 6F 73 2F 50 72 6F tros/Pro
63 65 73 61 72 52 65 67 cesarReg
69 73 74 72 6F 44 0C 1E istroD..
00 82 99 23 6E 65 74 2E .??#net.
6D 73 6D 71 3A 2F 2F 6C msmq://l
6F 63 61 6C 68 6F 73 74 ocalhost
2F 70 72 69 76 61 74 65 /private
2F 6D 69 63 6F 6C 61 01 /micola.
56 0E 40 10 50 72 6F 63 V.@.Proc
65 73 61 72 52 65 67 69 esarRegi
73 74 72 6F 08 13 68 74 stro..ht
74 70 3A 2F 2F 74 65 6D tp://tem
70 75 72 69 2E 6F 72 67 puri.org
2F 09 01 69 29 68 74 74 /..i)htt
70 3A 2F 2F 77 77 77 2E p://www.
77 33 2E 6F 72 67 2F 32 w3.org/2
30 30 31 2F 58 4D 4C 53 001/XMLS
63 68 65 6D 61 2D 69 6E chema-in
73 74 61 6E 63 65 40 08 stance@.
5F 70 65 72 73 6F 6E 61 _persona
40 06 43 65 64 75 6C 61 @.Cedula
99 07 31 32 33 34 35 36 ?.123456
37 40 06 4E 6F 6D 62 72 7@.Nombr
65 99 06 52 6F 62 65 72 e?.Rober
74 40 0E 50 72 69 6D 65 t@.Prime
72 41 70 65 6C 6C 69 64 rApellid
6F 99 07 53 70 65 6E 63 o?.Spenc
65 72 40 0F 53 65 67 75 er@.Segu
6E 64 6F 41 70 65 6C 6C ndoApell
69 64 6F 99 04 48 61 6C ido?.Hal
6C 40 09 44 69 72 65 63 l@.Direc
63 69 6F 6E 99 15 55 6E cion?.Un
69 74 65 64 20 53 74 61 ited Sta
74 65 2C 20 46 6C 6F 72 te, Flor
69 64 61 01 01 01 01    ida.... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T20:45:10.263

在配置文件中，您可以指定用于服务的序列化格式。

```
<service name="YourService">
    <endpoint address="msmq.formatname:DIRECT=OS:.\private$\yourMsmq"
              binding="msmqIntegrationBinding"
              bindingConfiguration="XmlBinding"
              contract="YourContract" />

</service>

<msmqIntegrationBinding>
    <binding serializationFormat="Xml" 
             name="XmlBinding" 
             durable="false" 
             exactlyOnce="false">
    </binding>
</msmqIntegrationBinding> 
```

这是可能的其他值的列表[MsmqMessageSerializationFormat Enumeration](http://msdn.microsoft.com/en-us/library/system.servicemodel.msmqintegration.msmqmessageserializationformat.aspx)

`I would like to know how to serialize the message so that it is not in binary and can be deserialized as xml or deserialize the message in binary.`

如果您询问如何确保客户端和服务器序列化为相同的格式，则需要确保所有客户端和服务器的绑定配置都设置为使用相同的`serializationFormat`. 如果客户端传入二进制序列化队列消息并且服务器设置为使用 Xml 格式，则会出现错误。

# oracle-xe - 在不同所有者之间添加 FOREIGN KEY CONSTRAINT

> ID：12734935
> 
> 赞同：1
> 
> 时间：2012-10-04T19:59:53.650
> 
> 标签：oracle-xe

我以 SYSTEM 用户身份登录 Oracle XE 实例。当我尝试运行创建用户、表和约束的脚本时，`ORA-01031`出现错误。脚本如下：

```
CREATE USER AA IDENTIFIED BY AA DEFAULT TABLESPACE users TEMPORARY TABLESPACE temp;
CREATE USER BB IDENTIFIED BY BB DEFAULT TABLESPACE users TEMPORARY TABLESPACE temp;
GRANT ALL PRIVILEGES TO AA WITH ADMIN OPTION;
GRANT ALL PRIVILEGES TO BB WITH ADMIN OPTION;
...
CREATE TABLE ...
CREATE INDEX ...
...
ALTER TABLE "BB"."B_TABLE" ADD CONSTRAINT "FK_BB_AA" FOREIGN KEY ("AA_ID")
  REFERENCES "AA"."A_TABLE" ("ID") ENABLE; -- this line report the error 
```

不能在 Oracle XE 上添加这个约束吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T01:32:03.997

首先，绝不应该出现您授予`ALL PRIVILEGES`用户权限的情况，尤其是不授予用户权限的情况`WITH ADMIN OPTION`。这只是管理安全性的一种糟糕方式。在任何近似真实系统的情况下，您都希望确定实际需要哪些权限并仅授予这些权限。

其次，为了让架构中的外键`BB`引用 中的父表`AA`，`BB`必须`REFERENCE`对 中的父表具有特权`AA`。由于没有`REFERENCE ANY TABLE`系统权限，您需要`BB`在创建表之后但在创建外键之前授予`REFERENCE`权限。`AA.A_TABLE`

```
GRANT REFERENCES ON aa.a_table TO bb; 
```

# php - 如何将 jQuery 表单插件与 Symfony2 结合使用

> ID：12734937
> 
> 赞同：0
> 
> 时间：2012-10-04T19:59:57.530
> 
> 标签：php, jquery, file-upload, symfony

使用 Symfony2 和 jQuery 我正在尝试开发一个包含多个字段的表单，其中一个`input type="file"`

我被推荐使用[这个框架：jQuery Form Plugin](http://malsup.com/jquery/form/#faq)

它正在工作：我在控制器中的 PHP 操作中接收到所有字段，包括键入的文件。

有没有人将它与 Symfony2 结合起来。换句话说：我如何处理从表单中获得的内容以将文件保存在文件系统中？

我想实现类似于[Symfony 中正式记录的内容](http://symfony.com/doc/2.0/cookbook/doctrine/file_uploads.html)。但是……怎么办？

如果我走 $this->get('request') -> get("form_image")，我会得到文件的名称。从那时起，我知道如何处理数据库内容，但我需要知道如何处理物理文件本身（如何将其保存到文件系统中）。

有什么线索吗？

提前致谢

[http://symfony.com/doc/2.0/cookbook/doctrine/file_uploads.html](http://symfony.com/doc/2.0/cookbook/doctrine/file_uploads.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T08:09:00.850

如果您只有文件名但没有文件，请尝试`<form>`在 twig 模板中制作标签，如下所示：

```
<form action="#" method="post" {{ form_enctype(form) }}> 
```

我认为你错过了`enctype`表单只发送没有文件的帖子数据。

## 更新

如果你有 enctype 告诉我你得到了什么：

```
// retrieves an instance of UploadedFile identified by foo
$request->files->get('form_image'); 
```

来自文档：[http ://symfony.com/doc/2.0/book/http_fundamentals.html#requests-and-responses-in-symfony](http://symfony.com/doc/2.0/book/http_fundamentals.html#requests-and-responses-in-symfony)

# javascript - 删除匹配的数组中的项目

> ID：12734939
> 
> 赞同：0
> 
> 时间：2012-10-04T20:00:04.450
> 
> 标签：javascript, node.js

我有大量的评论。假设评论看起来像这样：

```
{
  _id: [ObjectID],
  parentid: [ObjectID],
  ...
} 
```

我有一个从数据库中检索到的所有评论的大型数组：

```
comments = [comment1, comment2, comment3] 
```

为了得到任意评论的回复，我有一个这样的辅助函数：

```
function getReplies(comment, replies) {
  return replies.filter(function(reply) {
    return reply.parentid === comment._id
  }
} 
```

`getReplies`然而，当许多评论已经被处理（每个只有一个父）或评论只有 1 个回复或根本没有回复（在评论线程中更深）时，这个函数将始终检查整个数组，这让我感到不安。

这是过度优化，但我想知道你们将如何解决这个问题。除非有更优雅的解决方案，否则我认为我不会更改此功能。您将如何构建此帮助程序，以便它不会不必要地处理相同的评论两次？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:32:15.240

我将处理整个评论列表一次，以构建从comment._id 到回复列表的查找表。假设 comment._id 有一个合理的 toString() 表示，这样的东西应该可以工作：

```
var commentIdToReplies = {};
comments.forEach(function(comment) {
  if (comment.parentid) {
    var replies = commentIdToReplies[comment.parentid];
    if (!replies) {
      replies = [];
      commentIdToReplies[comment.parentid] = replies;
    }
    // Or just the _id if desired
    replies.push(comment);
  }
});
// now you can get the replies using:
// commentIdToReplies[comment._id] 
```

如果从 commentIdToReplies 返回 undefined，则意味着该评论没有回复。

这种方法在每次都必须扫描整个列表的时间与使用更多内存来维护查找表之间进行权衡。

# c# - 在 WCF 响应中排除服务合同命名空间

> ID：12734941
> 
> 赞同：0
> 
> 时间：2012-10-04T20:00:09.310
> 
> 标签：c#, wcf

我正在使用记忆中最令人沮丧的第三方工具。当前问题：

如果我没有在 ServiceContract 属性中提供命名空间（我猜它与 WSDL 如何分解/引用 xsd 文件有关），它无法从我的 Web 服务中读取 WSDL，但如果我确实提供了命名空间，它无法处理返回的 XML，因为当响应的根中有 xmlns 属性时它会失败。

我认为这是一个远景，但有没有办法告诉 WCF 不要在生成的 Http Response 元素中使用命名空间？？？

谢谢。

**编辑添加示例**

我现在得到的（在 ServiceContract 属性中提供命名空间时）：

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<HttpPostResponse xmlns="http://mynamespace.com">
  <HttpPostResult>
    <STAT xmlns="" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <RESPONSE _SEQUENCE_ID="1" _VERSION="1.0" _DATE="10/04/2012 12:03:21">
        <STATUS _TYPE="FAILURE" _PRODUCT_CODE="1">
          <ERROR _CODE="9002" _DESC="Bad code.  Bad code!"/>
        </STATUS>
      </RESPONSE>
    </STAT>
  </HttpPostResult>
</HttpPostResponse> 
```

只有在根目录中没有 xmlns 属性，我想要的是相同的：

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<HttpPostResponse>
... 
```

我“瞎了眼”，因为我基本上无法控制第三方应用程序，所以我试图找到解决方法以符合它所理解的内容。

# asp.net-mvc - SessionProvider 的 Couchbase 存储桶与 Memcached 存储桶

> ID：12734944
> 
> 赞同：3
> 
> 时间：2012-10-04T20:00:16.297
> 
> 标签：asp.net-mvc, session, couchbase

我了解到 Asp.Net 的默认 sessionprovider 不是分布式应用程序的好习惯。所以我决定将 asp.net 的 sessionprovider 更改为 couchbase。但是当我尝试选择数据桶时，我不确定使用哪个。我知道 Couchbase 是一个持久的 no-sql 数据库，而 memcached 是一个缓存服务器。

使用 couchbase bucket 而不是 memcached bucket 的优缺点是什么，反之亦然？

我正在使用 couchbase 2.0 和[https://github.com/couchbaselabs/couchbase-aspnet](https://github.com/couchbaselabs/couchbase-aspnet)库将 couchbase 转换为 sessionprovider。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-08T15:23:41.607

无论是使用 Couchbase 存储桶还是 Memcached 存储桶，您都会体验到类似的优势。即使使用 Couchbase 存储桶，文档也存储在 RAM 中。文档也先写入 RAM，然后异步写入磁盘。所以性能应该是相似的。与其他进程外会话状态解决方案（例如，SQL Server）相比，Couchbase 的性能应该要好得多。

除了性能之外，（正如@DB_Chick 指出的那样）您将具有在节点故障时能够重新创建会话的优势，因为数据不会随服务器而死（假设启用了复制）。

如果您将 Couchbase 存储桶与 Couchbase Server 2.0 一起使用，您将获得能够针对会话数据编写 map/reduce 视图的额外优势（如果您存储 JSON 数据结构，则最简单）。有了视图，您可以很容易地问“我有多少活动会话？”

最后，您的会话数据仍将随 Couchbase 存储桶过期。当您在会话数据上设置到期时，Couchbase 会在定期安排的后台清理作业期间或在到期后检索该项目时将该项目标记为删除。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-05T09:00:46.577

Couchbase 存储桶支持所有特定于 Couchbase 的功能，包括在线重新平衡（用于扩展集群）、持久性和复制以及故障转移。这是推荐的存储桶类型。

memcached 存储桶旨在仅支持核心 memcached 协议作为内存缓存。因此，支持和功能仅限于与独立 memcached 实现相同的功能。

更多信息在这里： http: [//www.couchbase.com/docs/couchbase-manual-2.0/couchbase-introduction-architecture-buckets.html](http://www.couchbase.com/docs/couchbase-manual-2.0/couchbase-introduction-architecture-buckets.html)

# c - 什么是无效的初始化程序？它在我的代码中的什么位置，我该如何纠正它？

> ID：12734946
> 
> 赞同：0
> 
> 时间：2012-10-04T20:00:16.290
> 
> 标签：c, initializer

我在[compilr.com](http://compilr.com)上运行我的代码，并使用 C 作为我的语言。我正在尝试制作一个简单的游戏，其中您有一个库存并以 100 美元开始。你通过秘密地为其他玩家做工作来赚钱。但是，我收到一条错误消息，上面写着“初始化程序无效”。这是什么，我该如何解决？这是我的代码：

```
#include<stdio.h>

int main()
{
    int player_cash[][3] = 100;
    int player[3];
    int job[][100] = {
        "Text me the address of player1",
        "I'll donate $100 to the your funds, if you steal the gold from player2 for me"
    };
            if (player_cash[1] > 5);
                do job[0]
        else if(player_cash[1]<5);

        return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T20:10:26.953

```
 int player_cash[][3] = 100; 
```

您声明一个二维整数数组，然后尝试使用单个整数对其进行初始化。正确的语法是

```
 int player_cash[][3] = 
 { 
   {100}
 }; 
```

虽然`int player_cash[][3] = { 100 };`也可以正常工作，但在风格上不太正确。

```
int job[][100] = { "Text me 
```

int 是整数，它们不是字符串。所以那个代码甚至没有意义。

此外，请养成在 if 语句后始终使用 {} 的习惯。

```
if (player_cash[1] > 5);
 do job[0] 
```

由于分号，将被视为您已写

```
if (player_cash[1] > 5)
{}
do job[0] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T20:03:26.950

对于初学者来说，`player_cash`是一个二维数组的声明。您尝试从整数文字初始化它。这行不通。你的意思是简单地声明一个`int`？如果您只想存储一个数量，则不需要数组甚至二维数组。

您的声明也是如此，`int job[][100]`但在这里您尝试使用字符串文字对其进行初始化。

在尝试编写 C 代码之前，您真的应该阅读一本书。仅仅敲出对你来说看起来像 C 代码的东西不会让你有任何收获。

# vba - Excel VBA：迭代范围参数并更改单元格值

> ID：12734949
> 
> 赞同：5
> 
> 时间：2012-10-04T20:00:27.280
> 
> 标签：vba, excel

我相信我想做的很简单。我想遍历 Range 参数并更改该范围内每个单元格的值。

```
Function test(thisRange As Range)
    For Each c In thisRange.Cells
         c.Value = 1
    Next
End Function 
```

以上是我想做的一个简单示例，但似乎不起作用。当我调试它时，Excel 似乎在遇到`c.Value = 1`. 为什么这不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T20:07:36.630

这对我有用

```
Option Explicit

Sub Sample()
    Dim ret
    ret = test(Sheets("Sheet1").Range("A1:A15"))
End Sub

Function test(thisRange As Range)
    Dim c As Range
    For Each c In thisRange.Cells
         c.Value = 1
    Next
End Function 
```

顺便说一句，我们不需要使用函数。函数用于返回一个值。尝试这个

```
Option Explicit

Sub Sample()
    test Sheets("Sheet1").Range("A1:A15")
End Sub

Sub test(thisRange As Range)
    Dim c As Range
    For Each c In thisRange.Cells
         c.Value = 1
    Next
End Sub 
```

# c# - WP7 / Xaml 从其中心旋转图像

> ID：12734951
> 
> 赞同：2
> 
> 时间：2012-10-04T20:00:30.583
> 
> 标签：c#, windows-phone-7, xaml

我有一个应该在切换时旋转的图像，但它会以 u 形移动。换句话说，它以一个角度路径移动，即 180 度。

如何将图像旋转 180 度？

下面是透明的图像，您可以将其保存以查看它： ![我想旋转的图像](../Images/db57f4d8eee4790c0c3dbe0cf80b23df.png) 我有一个 longlistselector 当用户选项卡在箭头图像上时，它将打开包含文本的文本块，并且图像必须旋转 180 即箭头必须向上指向运动就像 wphone7 主屏幕上的箭头一样。

我的页面资源

```
<phone:PhoneApplicationPage.Resources>
        <local:ValueConverterBoolToVis x:Key="ValueConverterBoolToVis" />

        <Style TargetType="ToggleButton" x:Key="FlipButton">

            <Setter Property="Template">
                <Setter.Value>

                    <ControlTemplate TargetType="ToggleButton">
                        <Grid>
                            <VisualStateManager.VisualStateGroups>

                                <VisualStateGroup x:Name="CheckStates">
                                    <VisualState x:Name="Checked">

                                        <Storyboard>
                                            <DoubleAnimation Duration="0:0:5"   Storyboard.TargetName="rotate"  Storyboard.TargetProperty="(RotateTransform.Angle)" To="180" />

                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Unchecked">
                                        <Storyboard>
                                            <DoubleAnimation Duration="0:0:5"   Storyboard.TargetName="rotate" Storyboard.TargetProperty="(RotateTransform.Angle)" To="0" />
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <!--RenderTransformOrigin="0.5,0.5"-->
                            <ContentPresenter  Content="{TemplateBinding Content}">
                                <ContentPresenter.RenderTransform>

                                    <RotateTransform x:Name="rotate" CenterX="0.5" CenterY="0.5" />

                                </ContentPresenter.RenderTransform>
                            </ContentPresenter>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- The template for the list header. This will scroll as a part of the list. -->
        <DataTemplate x:Key="citiesListHeader">
            <Border Background="Purple">
                <TextBlock Text="Cities Header" />
            </Border>
        </DataTemplate>
        <DataTemplate x:Key="citiesListFooter">
            <Border Background="Green">
                <TextBlock Text="Cities Footer" />
            </Border>
        </DataTemplate>

        <!-- The template for city items -->
        <DataTemplate x:Key="citiesItemTemplate">
            <StackPanel Grid.Column="1"  VerticalAlignment="Top">               
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition  />
                        <ColumnDefinition  />
                        <ColumnDefinition  />                                              
                    </Grid.ColumnDefinitions>    
                    <Grid.RowDefinitions>                   
                        <RowDefinition/>
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Column="0" Height="50" Tap="ProgLngGropus_Tap" Text="{Binding Name}" FontSize="26"  Margin="12,-5,12,6"/>                   
                    <ToggleButton Grid.Column="2" x:Name="MyToggleButton" Style="{StaticResource FlipButton}">
                        <ToggleButton.Content>
                            <Image Grid.Column="2" Margin="0,-10,-33,0" Height="40" Width="40" x:Name="ArrowDownImg"  Source="/Images/appbar.arrow.down.circle.rest.png" />                            
                        </ToggleButton.Content>
                    </ToggleButton>
                    <TextBlock TextWrapping="Wrap" Text="{Binding Lang}" Grid.Column="0" Grid.Row="1" x:Name="Desc"
                       Foreground="Orange" Visibility="{Binding ElementName=MyToggleButton,
                        Path=IsChecked, Converter={StaticResource ValueConverterBoolToVis}}">                        
                    </TextBlock>

                </Grid>

            </StackPanel>
        </DataTemplate>      
    <DataTemplate x:Key="groupHeaderTemplate">
        <Border Background="YellowGreen" Margin="6">
            <TextBlock Text="{Binding Title}" FontSize="40" Foreground="Black"/>
        </Border>
    </DataTemplate>

    <DataTemplate x:Key="groupItemTemplate" >
        <Border Background="YellowGreen" Width="99" Height="99" Margin="6">
            <TextBlock Text="{Binding Title}" FontSize="40" Foreground="Black"/>
        </Border>
    </DataTemplate>
    </phone:PhoneApplicationPage.Resources> 
```

还有我的网格

```
<Grid x:Name="LayoutRoot" Background="Transparent">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!--TitlePanel contains the name of the application and page title-->
        <StackPanel x:Name="TitlePanel" Grid.Row="0" Margin="12,17,0,28">
            <TextBlock x:Name="ApplicationTitle" Text="g" Style="{StaticResource PhoneTextNormalStyle}"/>
            <TextBlock x:Name="PageTitle" Text="g" Margin="9,-7,0,0" Style="{StaticResource PhoneTextTitle1Style}"/>
        </StackPanel>

        <!--ContentPanel - place additional content here-->
        <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">

            <toolkit:LongListSelector x:Name="Gropus" Background="Transparent"

                                  ItemTemplate="{StaticResource citiesItemTemplate}" 
                                  GroupHeaderTemplate="{StaticResource groupHeaderTemplate}" 
                                  GroupItemTemplate="{StaticResource groupItemTemplate}" >
                <toolkit:LongListSelector.GroupItemsPanel>
                    <ItemsPanelTemplate>
                        <toolkit:WrapPanel/>
                    </ItemsPanelTemplate>
                </toolkit:LongListSelector.GroupItemsPanel>
            </toolkit:LongListSelector>

        </Grid>
    </Grid> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T20:16:11.550

好的，所以你实际上有一些事情发生在这里让你失望。看来您的 Margin 将摆脱您正在旋转的 TransformOrigin 作为该对象的中心（因此为什么您要偏离中心旋转。）

您可以调整您的 RenderTransformOrigin（您目前已将其中断并注释掉）来弥补这一点，以重新对齐您的对象中心。或者你可以修复你奇怪的边距和任何其他推动你想要旋转的对象的部分。

希望这可以帮助。如果您想了解更多信息，请详细说明。（即；张贴您的图片，清楚地说明您的目标，并且可以提供更准确的示例。:)

# java - 如何将 Unity 集成到 Android Activity 中

> ID：12734953
> 
> 赞同：9
> 
> 时间：2012-10-04T20:00:42.770
> 
> 标签：java, android, android-ndk, unity3d

这是我第一次使用 Unity，我想将它集成到现有的 Android 应用程序中。

根据我的阅读，您需要将您的 Android 项目打包成一个 jar 文件。由于您不能在 jar 中包含资源文件夹，我如何处理我的应用程序的所有资源？该应用程序还使用 ActionBarSherlock 和 ViewPagerIndicator 库，它们也有自己的资源。

我基本上只需要一种方法来单击 Android 上的按钮并弹出一个包含 Unity 内容的 Activity。我希望应用程序的其余部分是原生 Android 代码。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-05T20:04:39.223

我想到了。我遵循[这些指示](http://www.rbcafe.com/Softwares/Unity/Documentation/Manual/Android-Integrating%20Unity%20With%20Eclipse.html)，但不断收到各种错误消息，包括 ClassNotFound 异常。

事实证明，ADT 17 处理 .jar 文件的方式打破了这种将 Unity 集成到 Eclipse 中的方法。经过数小时的搜索，这是我想出的解决方法：

与其将 classes.jar 添加到构建路径，不如将 classes.jar 文件复制到`/lib`项目目录中，一切都应该正常工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-20T06:44:48.030

您好以下是要遵循的步骤

1.  使用 android pro 创建一个统一项目。

    2.  开放团结。转到 Unity 中的文件-> 构建设置并为项目创建构建。
    3.  转到您的项目位置/临时/。
    4.  有一个名为 Staging area 的文件夹。
    5.  将此文件夹复制到其他位置。重命名此文件夹。例如测试统一。
    6.  现在去 Eclipse 从现有代码创建一个新项目。去 test-unity 并选择它。新项目已创建。
    7.  右键单击项目并选择属性。
    8.  从左侧选项卡列表中选择 android。并检查右侧面板上的库。应用更改。
    9.  现在在 android 中创建新项目，命名为 test-android。
    10.  包名称必须与您在 unity 中使用的相同。
    11.  右键单击项目。转到android并添加库。您将看到统一项目名称。选择它。unity 项目作为库添加到 test-android 项目中。
    12.  现在将统一项目中的资产文件夹复制到eclipse中以测试android项目。
    13.  同时将 libs->armeabi-v7a 统一复制到 libs 文件夹中。
    14.  现在转到统一安装目录。就我而言（ C:\Program Files (x86)\Unity\Editor\Data\PlaybackEngines\androiddevelopmentplayer\bin）。将 classes.jar 复制到 test-android 项目中的 libs 文件夹中。可选的-。复制 classes.jar 后，如果在测试 android 项目的 android-dependencies 文件夹中看不到 classes.jar，请转到 test-android 的构建并包含此 jar 文件。
    15.  现在在 test-android 项目中打开 main activity.class 并粘贴这一行

    导入 com.unity3d.player.UnityPlayerActivity；

    16.  现在用 UnityPlayerActivity 替换 Activity 如下

    公共类 MainActivity 扩展 UnityPlayerActivity

    17.  注释 setContentview(R.layout.main) 行。
    18.  现在运行您的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-14T19:42:41.567

在某些使用原生平台技术（如 Android/Java 和 iOS/Objective C）的场景中，开发人员希望在他们的应用程序/游戏中包含由 Unity 提供支持的功能（通常用于 3D/2D 实时渲染），如 AR 体验、与 3D 模型的交互，2D小游戏。

> 您现在可以将由 Unity（从 Unity 2019.3.a2 开始）提供支持的功能直接插入到您的原生移动应用程序中。这些功能包括但不限于 3D 或 2D 实时渲染功能，例如增强现实、2D 迷你游戏或 3D 模型。
> 
> 您可以将 Unity 运行时组件和您的内容集成到本机平台项目中。Unity 运行时库公开控件以管理何时以及如何在本机应用程序中加载/激活/卸载。

**前置要求：**

*   安卓工作室 3.4.2+
*   Unity 版本 2019.3.0b4+

**限制**

虽然我们测试了许多将 Unity 作为原生应用程序托管的库的场景，但 Unity 不再控制运行时的生命周期，因此我们不能保证它在所有可能的用例中都能正常工作。

例如：

*   Unity 作为库仅支持全屏渲染，不支持在部分屏幕上渲染。
*   不支持加载多个 Unity 运行时实例。
*   您可能需要调整第 3 方插件（本机或托管）才能正常工作。

**这个怎么运作**

总体构建过程还是一样的，Unity 创建了 iOS Xcode 和 Android Gradle 项目，但是为了启用这个功能，我们更改了生成的 iOS Xcode 和 Android Gradle 项目，它们现在具有以下结构：

*   包含所有源代码和插件的库部分（iOS 框架和 Android 存档 (AAR) 文件）
*   一个瘦启动器部分，包括应用程序表示数据和运行库

**集成 Unity 作为原生 Android 应用程序中的库** 逐步解释如何在需要时将 Android 库部分包含到原生应用程序中。

示例：[集成 Unity 作为原生 Android 应用程序中的库](https://forum.unity.com/threads/integration-unity-as-a-library-in-native-android-app-version-2.751712/)

**集成 Unity 作为本机 iOS 应用程序中的库** 逐步解释如何在需要时将 iOS 库部分包含到本机应用程序中。

示例：[集成 Unity 作为原生 iOS 应用程序中的库](https://forum.unity.com/threads/integration-unity-as-a-library-in-native-ios-app.685219/)

[示例项目源代码](https://github.com/Unity-Technologies/uaal-example)

# java - 在 java 中使用 printf 并在 eclipse 中读取错误时遇到困难

> ID：12734954
> 
> 赞同：0
> 
> 时间：2012-10-04T20:00:46.340
> 
> 标签：java, printf

```
public class TryMyMath {

    public static void main(String args[])
    {

        double num = Math.E;
        printTable(num);
    }// end main

    public static void printTable(double num){
        int n = 1;

        for(n = 1;n <= 10; n++)
        {
            num = Math.pow(num, n);
            System.out.printf("%d %lf", n, num);
        }
        round100th(num);

    }
    public static double round100th(double num)
    {
        return Math.round(num*100.)/100.0 ;
    } // end round100th

} 
```

我在 java 中使用 printf 时遇到了这个问题，所以这是我在使用 printf 时遇到的错误

```
Exception in thread "main" java.util.UnknownFormatConversionException: Conversion = 'l'
  at java.util.Formatter$FormatSpecifier.conversion(Unknown Source)
  at java.util.Formatter$FormatSpecifier.<init>(Unknown Source)
  at java.util.Formatter.parse(Unknown Source)
  at java.util.Formatter.format(Unknown Source)
  at java.io.PrintStream.format(Unknown Source)
  at java.io.PrintStream.printf(Unknown Source)
  at TryMyMath.printTable(TryMyMath.java:15)
  at TryMyMath.main(TryMyMath.java:7) 
```

当我取出 printf 语句时没有任何错误，我是否没有以正确的方式使用 printf，它应该在 java 中使用？

而且我是java和eclipse的新手，所以我不知道这些错误是什么意思。

所以这是我得到的输出

1 2.7182822 7.3890563 403.4287934 26489122129.8434375 13041808783936237000000000000000000000000000000000000.0000006 无穷17 无穷8 无穷9

输出只到 n = 3 我看不出 for 循环有什么问题 为什么会发生这种情况？

nvm 我看到它有什么问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:04:21.210

应该是`System.out.printf("%d %f", n, num)`。在这里`l`毫无意义。

此外，您的`round100th(num);`电话无效 - 您是否尝试将数字打印到小数点后两位？你可以这样做：

```
System.out.printf("%d %.2f", n, num) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T20:05:07.277

请参阅[String Formatter Conversions](http://docs.oracle.com/javase/6/docs/api/java/util/Formatter.html#syntax)，没有`%l`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T20:04:34.683

我对此并不积极，但我相信你只需要使用 java

> System.out.printf(n + " " + num)

不过已经有一段时间了，所以你需要检查一下。如果我错了，请告诉我。我不想留下不正确的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T20:05:17.817

尝试：

```
System.out.printf("%d %f", n, num); 
```

[格式在 JavaDocs 中有很好的](http://docs.oracle.com/javase/7/docs/api/java/util/Formatter.html#syntax)描述。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-04T20:06:14.017

问题在于这一行：

> System.out.printf("%d %lf", n, num);

%lf 不合适。你是说%1f吗？请注意，前者有一个小写的“L”，而后者有一个“1”。用 1 试试，它应该可以工作。

# javascript - onclick 按钮在 Firefox 中不起作用

> ID：12734955
> 
> 赞同：0
> 
> 时间：2012-10-04T20:00:53.043
> 
> 标签：javascript, html, css

我有这个代码：

```
<H4>
<b>
<span style="color:blue;cursor:pointer" onclick="showImage(6)">test</span>
</b>
</H4>
<BR> 
```

这是我的 JavaScript 代码：

```
function showImage(id){
    if(id==4){
        $("image4").style.display   =   ''; 
        $("image5").style.display   =   'none';
        $("image6").style.display   =   'none';
    }else if(id==5){
        $("image4").style.display   =   'none'; 
        $("image6").style.display   =   'none';
        $("image5").style.display   =   ''; 
    }else{
        $("image4").style.display   =   'none'; 
        $("image6").style.display   =   '';
        $("image5").style.display   =   'none'; 
    } 
```

我的`onclick`按钮在 Firefox 中不起作用，您能帮帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T20:32:15.237

你可以试试这个

```
function showImage(id){
    if(id==4){
        $("image4").css( 'display',  'block'); 
        $("image5").css( 'display',  'none');
        $("image6").css( 'display',  'none');
    }else if(id==5){
        $("image4").css( 'display',  'none'); 
        $("image6").css(  'display', 'none');
        $("image5").css(  'display', 'block'); 
    }else{
        $("image4").css( 'display',  'none'); 
        $("image6").css( 'display',  'block');
        $("image5").css( 'display',  'none'); 
    } 
```

# python - 用 Python 访问远程服务器上的 Windows 共享驱动器

> ID：12734961
> 
> 赞同：3
> 
> 时间：2012-10-04T20:01:23.313
> 
> 标签：python, windows, shared-directory

这似乎是一个简单的问题，但我无法弄清楚。

我在远程服务器上设置了一个共享文件夹，以便该文件夹在 Windows 资源管理器中显示如下：\\server-name\shared-directory。我可以通过 Windows 资源管理器远程读取该文件夹并远程写入该文件夹。但是，当我尝试通过 python 脚本访问该文件时，我说该目录不存在。

我拥有服务器的管理权限，并允许自己访问共享驱动器（我通过 Windows 资源管理器复制文件验证了这一点）。

在python中，我按如下方式访问驱动器（尽管我尝试了几种不同的方法但没有成功）：

```
os.access('\\\\server-name\\path-to-shared-directory', os.W_OK) 
```

关于我可能做错了什么的任何建议？

编辑：

在回答问题时，我实际上是在尝试使用脚本复制文件，os.access 只是用于查看目录是否具有写访问权限。我使用的复制代码如下：

```
def copy_folder(src, dest):
    if not os.access(dest, os.W_OK):
        return(False)
    cmd = ['xcopy', '/E', '/J', '/Y', '/I', src, dest]

    p = subprocess.Popen(args=cmd, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=True)

    out, err = p.communicate()

    print 'out: %s' % out
    print 'err: %s' % err

    return(True)

copy_folder(my_source_directory, '\\\\server-name\\path-to-shared-directory') 
```

这将返回“无效的驱动器规范”作为错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T21:40:57.773

通过您已经尝试使用的 UNC 路径访问文件应该没有问题，但我建议对其进行格式化以帮助转义：

```
src  = r'C:\path\to\source'
dest = r'\\server-name\path-to-shared-directory' 
```

你不需要`stdin`：

```
p = subprocess.Popen(cmd, 
        stdout=subprocess.PIPE, 
        stderr=subprocess.PIPE, 
        shell=True) 
```

通常，您可以在 python 中对路径使用正斜杠，但由于您调用的是 shell 命令，因此仍然需要反斜杠。

# c# - c# - vcvars32 在尝试将类编译成 dll 时出错

> ID：12734964
> 
> 赞同：0
> 
> 时间：2012-10-04T20:01:33.733
> 
> 标签：c#, asp.net, visual-studio, dll, compilation

我正在尝试使用 vcvars32 将 ac# 类（myClass，它实现 ImyInterface）编译成 dll。

我收到错误 CS0246：找不到类型或命名空间名称“ImyInterface”（您是否缺少 using 指令或程序集引用？）。

有人遇到过这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T20:06:04.163

注意：这不是`vcvars32`这里失败的；这是 C# 编译器给出的错误。您可能已经运行`vcvars32`以设置您的环境，但这是非常不同的。

> 有人遇到过这个问题吗？

仅在尝试引用 C# 编译器不知道的类型时。正如错误消息所说，检查您的`using`指令（以确保您正在导入您需要的所有命名空间）和您的程序集引用（以确保您有对包含 的程序集的引用`ImyInterface`）。

还要检查您的拼写 -`ImyInterface`通常是`IMyInterface`，并且 C# 区分大小写。

如果`ImyInterface`在您引用的现有库中不存在 - 换句话说，如果您尝试将该接口构建到同一个程序集中 - 那么您需要在命令中包含包含接口声明的源文件线。

这就是我们可以说的所有内容，没有关于接口在哪里、它在什么命名空间、你的类在什么命名空间等的更多信息。

# javascript - AngularJS - 链接后修改html元素

> ID：12734970
> 
> 赞同：1
> 
> 时间：2012-10-04T20:02:04.037
> 
> 标签：javascript, model-view-controller, angularjs

我的应用程序根据来自 Web 服务的数据生成动态表单。

例如，Web 服务可能返回：[{Name:'Age',DataType:'Number'},{Name:'PhoneNumber',DataType:'Phone'}]

在 html 中，字段列表是这样绑定的：

```
<div ng-repeat="v in model.Variables">
    <input type="text" ng-model="v.Value" dynamic-variable="{{v.DataType}}" />
</div> 
```

DynamicVariable 是我的指令，它监视 attrs.DynamicVariable 上的更改（链接期间值将更改），并根据类型执行自定义操作（例如，对于“电话”数据类型，它将掩码应用于输入元素）。

如果类型是“数字”，那么我必须将现有元素包装在一些跨度中，以便创建具有一些附加功能的数字控件。

```
var minusButton = '<button type="button" class="button number-down">-</button>';
var wrapper = '<span class="number input margin-right"></span>';
var plusButton = '<button type="button" class="button number-up">+</button>';
element.attr('size', '3');
element.wrap(wrapper);
element.before(minusButton);
element.after(plusButton); 
```

然而，这似乎破坏了模型绑定——一旦元素被包裹在更多的 html 中，就不再发生与模型的绑定。同样， element.replaceWith() 方法也会破坏绑定。

知道为什么会发生这种情况，或者可能有什么解决方法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T00:19:12.723

我会使用角度指令来帮助我，而不是实现我自己的动态 dom 视图。在这个例子中，`ng-switch`可能有用。

[http://plnkr.co/edit/VykyIo](http://plnkr.co/edit/VykyIo)

# objective-c - 在objective-c中排序服装尺寸

> ID：12734972
> 
> 赞同：3
> 
> 时间：2012-10-04T20:02:08.747
> 
> 标签：objective-c, nsarray

我有一个 NSArray，其值 XS、S、M、L、XL、XXL 以随机顺序排列。

我将如何在 Objective-C 中正确排序？

我查看了这段代码作为起点，但我的运气为零：

[通过引用 C# 对列表进行排序](https://stackoverflow.com/questions/9358635/sort-a-list-by-reference-c-sharp)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T22:04:54.757

为此，您可以创建一个包含正确顺序的值的参考数组，然后根据每个元素出现在参考数组中的索引对输入数组进行排序。到白衣：

```
NSArray *reference = @[ @"XS", @"S", @"M", @"L", @"XL", @"XXL" ];
NSArray *inputArray = @[ @"S", @"M", @"L", @"L", @"M", @"S", @"XXL", @"S" ];

NSArray *sortedArray = [inputArray sortedArrayUsingComparator:
    ^NSComparisonResult(id a, id b) {
    NSUInteger aindex = [reference indexOfObject:a];
    NSUInteger bindex = [reference indexOfObject:b];
    if (aindex > bindex)
        return (NSComparisonResult)NSOrderedDescending;
    if (aindex < bindex)
        return (NSComparisonResult)NSOrderedAscending;
    return (NSComparisonResult)NSOrderedSame;
}];
NSLog(@"%@", sortedArray); 
```

这行得通，但它的缺点是调用`indexOfObject:`的频率比我们想要的多得多。如果我们假设`sortedArrayUsingComparator`使用[快速排序](http://en.wikipedia.org/wiki/Quicksort)，那么我们正在查看 O(N*logN) 比较，每个比较调用`indexOfObject:`两次。`indexOfObject:`依次在 O(N) 时间内运行。那么总的来说，不好。

有几种方法可以改善这一点。例如，您可以使用[decorate-sort-undecorate](http://en.wikipedia.org/wiki/Schwartzian_transform)成语。在这里，您预先计算数组元素的排序键（在本例中为参考数组索引），用它们装饰数组元素，使用它们进行排序，然后将它们剥离。

*在这种情况下，将*值转换为引用数组中的索引（而不是修饰它们），然后再转换回来（而不是不修饰）会更容易。不过同样的想法。这是它的外观：

```
// First get the indices
NSMutableArray *indices = [NSMutableArray arrayWithCapacity:[inputArray count]];
for (id elem in inputArray) {
    [indices addObject:@([reference indexOfObject:elem])];
}

// Then sort the list of indices
[indices sortUsingDescriptors:@[[NSSortDescriptor sortDescriptorWithKey:@"self" 
                                                              ascending:YES]]];

// Finally, translate indices back to source elements
NSMutableArray *results = [NSMutableArray arrayWithCapacity:[inputArray count]];
for (NSNumber *index in indices) {
    [results addObject:reference[[index unsignedIntegerValue]]];
}

NSLog(@"%@", results); 
```

您可以解决它的另一种方法是将引用数组改为引用字典，并将值（“XS”、“S”等）映射到它们的排序顺序（0、1...）。这实际上与我的第一个解决方案相同，但参考数组索引已预先计算并存储在字典中。与`indexOfObject:`在 O(N) 时间内运行的 不同，通过其键查找字典值在 O(1) 时间内运行。

在对象字面量出现之前，这将是难以想象的丑陋，但现在它非常优雅。对于小型参考集，这将是我的首选。

```
NSDictionary *reference = @{ 
    @"XS":  @0, 
    @"S":   @1, 
    @"M":   @2,
    @"L":   @3,
    @"XL":  @4,
    @"XXL": @5
};

NSArray *inputArray = @[ @"S", @"M", @"L", @"L", @"M", @"S", @"XXL", @"S" ];

NSArray *sortedArray = [inputArray sortedArrayUsingComparator:
    ^NSComparisonResult(id a, id b) {
    return [reference[a] compare:reference[b]];
}];
NSLog(@"%@", sortedArray); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T20:32:07.860

如果您创建一个有序集以充当“参考”订单，那么您可以使用该`NSMutableSet`方法`intersectSet:`从您的数组中创建一个有序列表：

**编辑** [David Rönnqvist](https://stackoverflow.com/users/608157/david-ronnqvist)刚刚提出了一个很好的观点。需要检查相同“大小”的多个实例。

```
//This is my "reference" set, declared only once in my class
NSOrderedSet *reference = [NSOrderedSet orderedSetWithObjects:@"XS",@"S",@"M",@"L",@"XL", nil];

//This is the array I'm trying to sort, which may or may not contain all the sizes
NSArray *randomArray = [NSArray arrayWithObjects:@"XL", @"XS", @"M", @"XS", nil];

//Create a mutable ordered set from my reference
NSMutableOrderedSet *ordered = [NSMutableOrderedSet orderedSetWithOrderedSet:reference];

//Interset with the array
[ordered intersectSet:[NSSet setWithArray:randomArray]];

//Look for multiple instances of the same size
NSMutableArray *result = [NSMutableArray array];

for (NSString *sortedSize in ordered){

    for (NSString *randomSize in randomArray){
        if ([randomSize isEqualToString:sortedSize]){
            [result addObject:randomSize];
        }
    }
} 
```

我从上面得到的结果是一个数组，其中包含：

`@"XS", @"XS", @"M", @"XL"`

如果您要创建一个执行此操作的方法，您还可以将计数与`ordered`您正在排序的数组进行比较，如果它们相等，则不要打扰迭代。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T20:25:49.917

我认为一个简单的方法是使用 sortedArrayUsingComparator 方法：

```
- (NSArray *)sortedArrayUsingComparator:(NSComparator)cmpt 
```

您的代码将如下所示：

```
 NSArray * randomArray = [NSArray arrayWithObjects: @"S", @"L", @"M", @"L", @"XL", @"M", nil];

 NSMutableDictionary *dictionary = [[ NSMutableDictionary alloc]
                                         init];
 [ dictionary setObject: [NSNumber numberWithInt:1] forKey:@"S"];
 [ dictionary setObject: [NSNumber numberWithInt:2] forKey:@"M"];
 [ dictionary setObject: [NSNumber numberWithInt:3] forKey:@"L"];
 [ dictionary setObject: [NSNumber numberWithInt:4] forKey:@"XL"];

 NSArray *sortedArray = [randomArray sortedArrayUsingComparator: 
    ^(id obj1, id obj2) {

        NSNumber *value1 = [dictionary objectForKey:obj1];
        NSNumber *value2 = [dictionary objectForKey:obj2];

        return [value1 compare:value2];
    }];

   for (NSString *item in sortedArray)
   {
       NSLog(@"%@", item);
   } 
```

这将打印到控制台：S M M L L XL

如您所见，`enum`我没有使用 C# 解决方案中提到的方法，而是使用包含的 NSDictionnary，`NSNumber`因此我可以直接使用块`compare`中的方法`comparison`。

# spring-mvc - applicationContext.xml 内部发生了什么

> ID：12734978
> 
> 赞同：0
> 
> 时间：2012-10-04T20:02:31.133
> 
> 标签：spring-mvc, jersey, entitymanager

有人能解释一下以下`applicationContext.xml`文件在做什么吗？对于更多的上下文，我从[http://persistentdesigns.com/wp/jersey-spring-and-jpa/](http://persistentdesigns.com/wp/jersey-spring-and-jpa/)得到它。

我的一些问题（不是详尽的，因为我真的不太了解）：

*   For`id="dataSource"`是`dataSource`关键字还是我要使用的数据源的名称？例如，如果我的数据源的名称是实际 learningRestDS，我是否替换`dataSource`为`learningRestDS`？

*   为什么是数据源类名`org.springframework.jdbc.datasource.DriverManagerDataSource`而不是`com.mysql.jdbc.jdbc2.optional.MysqlDataSource`？

applicationConext.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
xmlns:aop="http://www.springframework.org/schema/aop" xmlns:context="http://www.springframework.org/schema/context"
xmlns:jee="http://www.springframework.org/schema/jee" xmlns:tx="http://www.springframework.org/schema/tx"
xsi:schemaLocation="
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd
        http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-2.5.xsd
        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd">
   <!--  Scan for both Jersey Rest Annotations a -->
   <context:component-scan base-package="com.persistent.rest,com.persistent.service,com.persistent.service.jpa"/>
   <context:annotation-config />
   <tx:annotation-driven />
   <bean id="dataSource"
    class="org.springframework.jdbc.datasource.DriverManagerDataSource"
    p:driverClassName="com.mysql.jdbc.Driver" p:url="jdbc:mysql://localhost:3306/jpa"
    p:username="user" p:password="password" />

<bean id="entityManagerFactory"
    class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"
    p:dataSource-ref="dataSource" p:jpaVendorAdapter-ref="jpaAdapter">
    <property name="loadTimeWeaver">
        <bean
            class="org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver" />
    </property>
</bean>
<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager"
    p:entityManagerFactory-ref="entityManagerFactory" />
<bean id="jpaAdapter"
    class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"
    p:database="MYSQL" p:showSql="true" /> 
```

更新：错误：

```
SEVERE: Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'personService':
Injection of persistence methods failed;
nested exception is org.springframework.beans.factory.BeanCreationException: 
Error creating bean with name 'entityManagerFactory' defined in class path resource [applicationContext.xml]:
Invocation of init method failed; nested exception is java.lang.AbstractMethodError: 
org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo.getValidationMode()Ljavax/persistence/ValidationMode; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:12:16.567

`"dataSource"`是您稍后用来引用该 bean 的任意 bean 名称 (ID)：

```
p:dataSource-ref="dataSource" 
```

如果您的数据源已命名`"learningRestDS"`，您将使用：

```
p:dataSource-ref="learningRestDS" 
```

`p:dataSource-ref`是属性的名称（`DriverManagerDataSource`您将`setDataSource()`在该类上找到将用于注入的方法`learningRestDS`。

* * *

定义数据源时，您可以自由使用任何实现`DataSource`接口的类（抽象的力量）。此 XML 的作者选择使用 [`DriverManagerDataSource`](http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/jdbc/datasource/DriverManagerDataSource.html)而不是`MysqlDataSource`. 只要他们都遵守合同，他们就会工作^得一样好。`DataSource`

有许多其他可能的实现`DataSource`，例如[dbcp](/questions/tagged/dbcp "显示标记为“dbcp”的问题")和[c3p0](/questions/tagged/c3p0 "显示标记为“c3p0”的问题")连接池库。它们的优点是它们可以与所有 JDBC 驱动程序/数据库一起使用。

¹实际上`DriverManagerDataSource`应该只用于测试，因为它的性能很差，但从功能的角度来看，它和其他任何`DataSource`.

* * *

更新以回答您的意见。您正在查看：

```
Invalid property 'driverClassName' of bean class [com.mysql.jdbc.jdbc2.optional.MysqlDataSource]: No property 'driverClassName' found 
```

这意味着 Spring 尝试将一些东西注入到没有这样的属性（setter）的属性中`driverClassName`。[`MysqlDataSource`](http://www.docjar.com/docs/api/com/mysql/jdbc/jdbc2/optional/MysqlDataSource.html)这也意味着您引用的应用程序上下文 XML 文件不完整/不一致/不正确，正如您所使用的那样`DriverManagerDataSource`。`driverClassName`如果使用 MySQL 数据源，请确保这是 Spring 使用的文件并删除属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T20:15:50.010

“dataSource”的 id 只是与 Java bean 实例关联的名称。您可以将其更改为您想要的任何内容，只要您还更新任何指向它的 ref="" 属性即可。

org.springframework.jdbc.datasource.DriverManagerDataSource 类是一个帮助类，它封装了通常与手动实例化 JDBC 连接相关的所有代码。因此，从这个意义上说，您可以将其视为包装器。它采用您提供的属性，即驱动程序类和 url，并使用它们来实例化新连接。

话虽如此，只要 com.mysql.jdbc.jdbc2.optional.MysqlDataSource 实现 java.sql.DataSource 接口，您就可以将其用作替代品。

在生产环境中，您可能会将其替换为池数据源，甚至是 JNDI 配置的连接池。有很多选择，你不会只使用 Spring 的 DriverManagerDataSource。

# c# - 调用带参数的方法时出现本机回调错误

> ID：12734982
> 
> 赞同：1
> 
> 时间：2012-10-04T20:02:41.757
> 
> 标签：c#, c++, callback

我正在尝试使用以下代码对我的 C# 应用程序进行一些本机回调：

C＃ ：

```
public delegate void MyCallback(int i );
[DllImport("core.dll")]
public extern static void set(MyCallback cb);
public static void callmemaybe(int i)
{
    Console.Write(i);
}
[DllImport("lgcoree.dll")]
public extern static void Post();
static void Main()
{
    set(callmemaybe);
    Post();
} 
```

C++：

```
void (*callback)(int) ;
extern "C" __declspec(dllexport) void __cdecl set( void (*cb)(int)  )
{
callback = cb;
}
extern "C" __declspec(dllexport) void __cdecl  Post()
{
callback(1);
} 
```

当我执行此代码时，在 callmemaybe 方法执行后立即出现此错误：'ESP 的值未在函数调用中正确保存。这通常是使用一个调用对流声明的函数调用一个使用不同调用对流声明的函数指针的结果'

但是，当我从 callmemaybe 函数中删除参数并调整代码（从委托和导出函数中删除参数）时，它可以完美运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T20:12:13.550

Post() 和 set() 将 __cdecl 作为它们的调用对流，因此您可能必须指定它：

```
[DllImport("core.dll", CallingConvention=CallingConvention.Cdecl)]
public extern static void set(MyCallback cb); 
```

您可能还需要为委托执行此操作，具体取决于 Post() 的期望：

```
[UnmanagedFunctionPointer(CallingConvention.Cdecl)]
public delegate void MyCallback(int); 
```

希望这可以帮助。

# ruby-on-rails - 为什么我在 Heroku 上的演示应用程序只显示“Welcome Aboard”页面

> ID：12734984
> 
> 赞同：0
> 
> 时间：2012-10-04T20:02:51.347
> 
> 标签：ruby-on-rails

**注意：**我花了一个上午仔细检查了关于这个主题的类似问题，但没有帮助。

**我的问题**

我正在关注 Michael Hartl 的 Ruby-on-Rails 教程。第一个演示应用程序运行良好。它显示“Welcome Aboard”，当我添加 /users 时，它会运行演示应用程序。我将它推送到 Heroku，它在那里运行，但只显示 Welcome Aboard 页面。添加 /users 得到“您要查找的页面不存在。”。我没有改变任何路线。看来我现在应该可以在 Heroku 上查看我的演示应用程序了。我很惊讶，因为教程非常详尽。

**进一步的实验**

我删除了`public/index.html`。并将其从 git 中删除并提交并使用`git status`. 当我尝试打开时，`localhost/3000`我得到了预期的“路由错误”。当我添加 /users 时，演示应用程序按预期工作。我没有更改 routes.rb。教程中没有指示我这样做。

现在我推送到 Heroku 并在那里打开我的应用程序，我现在得到“您要查找的页面不存在”。这似乎是对的。就好像我`localhost/3000`在本地运行时打开的一样。但是当我在 Heroku 添加 '/users' 时，我仍然会收到页面错误。我需要添加路线吗？教程中没有提到这一点（或者我忽略了一些东西）。

感谢这位 Rails 新手的帮助。

**更多信息**

我确实添加了一个指向`users/index`它的路由，现在我的 localhost 版本可以直接向应用程序打开，而无需手动添加`users`到 URL。但是当完全提交并推送到heroku时，我仍然会收到页面错误。

这是 rake 路由的输出：

```
~/Documents/demo_app: rake routes
users       GET    /users(.:format)          users#index
            POST   /users(.:format)          users#create
new_user    GET    /users/new(.:format)      users#new
edit_user   GET    /users/:id/edit(.:format) users#edit
user        GET    /users/:id(.:format)      users#show
            PUT    /users/:id(.:format)      users#update
            DELETE /users/:id(.:format)      users#destroy
root                                         users#index 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T06:01:48.247

尝试这个

```
heroku run rake db:create
heroku run rake db:migrate 
```

运行您的应用程序

```
# in your terminal write
heroku logs -e production 
```

它将在您的终端中显示错误，以便您轻松理解。

# vhdl - 在结构化的 VHDL ROM 中，我怎样才能有多个字线驱动输出？

> ID：12734987
> 
> 赞同：2
> 
> 时间：2012-10-04T20:03:09.533
> 
> 标签：vhdl, xilinx, synthesis

我正在为我的一类用结构化 VHDL 编写 ROM。该设计采用 6 位地址并通过 6 到 64 二进制解码器运行它。每个解码器输出启用或禁用由三态反相器组成的单个 6 位字线。每个位的字线位输入要么是“1”，要么是“0”。最重要的是，每个字线都写入*相同*的输出向量。

当我检查 Xilinx 9.2 中的语法时，它很好，但是当我合成时，我得到了这个错误：

```
ERROR:Xst:528 - Multi-source in Unit <ufm6bit> on signal <N0>
Sources are: 
   Output signal of BUFT instance <rom/word63rom/tri0/Z>
   Output signal of BUFT instance <rom/word62rom/tri0/Z> 
   Output signal of BUFT instance <rom/word...rom/tri0/Z> 
   Output signal of BUFT instance <rom/word00rom/tri0/Z> 
```

我使用了一个程序来编写解码器 VHDL，因此端口映射太大而无法放在这里（如果需要，可以将其放在 pastebin 上）。字线如下所示：

```
entity tribuffer6 is
  PORT (
    A : in  std_logic_vector(5 downto 0);
    E : in  std_logic;
    Z : out std_logic_vector(5 downto 0));
end tribuffer6; 
```

它使用的 6 个 tribuffers 如下所示：

```
entity tribuffer is
  Port ( A : in  std_logic;
         E : in  std_logic;
         Z : out std_logic);
end tribuffer;

architecture Behav of tribuffer is
begin

  z <= not a after 120 ps when e = '1' else
         'Z' after 120 ps;

end Behav; 
```

最后，字线是这样绑起来的：

```
SIGNAL dataline : std_logic_vector(5 downto 0);

word00rom : tribuffer6 PORT MAP (
                         A=>"000000",
                         Z=>dataline,
                         E=>word00en );
word01rom : tribuffer6 PORT MAP (
                         A=>"000000",
                         Z=>dataline,
                         E=>word01en ); 
```

从错误中可以明显看出，VHDL 对在那条线上有多个驱动程序不满意，但是我无法制作 64 个缓冲区向量并将它们链接在一起来阻止检查。64 层深的 OR 树也不实用。我该怎么做才能让 VHDL 能够接受这个？

更新：我应该澄清一些事情。Xilinx 9.2 是课程的必需品，因为它是免费的，而且我的大学很便宜。唯一的基本门（and,or,not,nand,tristate）可以是行为的，其他一切都必须是结构的。这是我用 C 语言生成 VHDL 的 ROM，因为否则会需要大量输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T12:31:15.533

如果您希望合成它，那么您最好只为 OR-tree 编写代码。

我知道没有（当前）设备会对内部三态感到满意。合成器要么会窒息（就像你的那样），要么将它（或多或少无声地）转换为你的多路复用器树。

看到这个线程：

[http://forums.xilinx.com/t5/Spartan-Family-FPGAs/What-is-BUFT-in-this-RTL/td-p/111838](http://forums.xilinx.com/t5/Spartan-Family-FPGAs/What-is-BUFT-in-this-RTL/td-p/111838)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-05T09:22:07.320

由于您使用的是 std_logic_vector 而不是 std_ulogic_vector，因此多个源驱动“数据线”信号是合法的。它是有效的 VHDL，应该可以在仿真中正常工作。我想这足以让任务获得批准。

FPGA 通常没有内部三态缓冲器。也就是说，在您尝试合成的 FPGA 中没有值“Z”的概念。（但是，它们通常在引脚上有三态缓冲器，因此可以将输出引脚驱动到“Z”。）这就是您的综合失败的原因。如果您可以访问 ASIC 的综合工具（例如 Synopsys 设计编译器），您可以尝试使用它，这很可能会奏效。

另请注意，对于 FPGA 和 ASIC，显式延迟（等待、之后）是不可综合的。

# prolog - 确定一个句子是否是序言中的回文

> ID：12734993
> 
> 赞同：2
> 
> 时间：2012-10-04T20:03:50.073
> 
> 标签：prolog, palindrome

我正在尝试编写一个程序来确定一个句子是否是回文。这是我到目前为止所拥有的：

```
palindrome :- write('Sentence: '),
    read(Word),
    name(Word,List),
    palCheck(List).

palCheck(List) :- reverse(List,List).

reverse(L1,L2) :- rev(L1,[],L2).
rev([],L,L).
rev([H|L],L2,L3) :- rev(L,[H|L2],L3). 
```

我遇到的问题是当我到达空格或大写字母时。我最终想要的是能够编写 DoD dod 并让它通过。我曾尝试使用 downcase_atom(X,Y)，但在将其用作句子时遇到了麻烦，这不是原子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T20:13:42.017

read/1 以一种特殊的方式起作用：它是一个非常强大的原语，能够完全解析 Prolog 语法。但是空间使输入格式不正确。然后用引号将文字括起来，或使用其他一些输入原语：请参阅您的 Prolog 手册！

```
?- palindrome('DoD DoD'). 
```

在 SWI-Prolog 中，此查询进行检查：

```
?- current_stream(_,read,S), read_line_to_codes(S,Cs), maplist(to_lower,Cs,Ls), reverse(Ls,Ls).
|: AbcCBA
S = <stream>(0x7fae7b1088e0),
Cs = [65, 98, 99, 67, 66, 65],
Ls = [97, 98, 99, 99, 98, 97] . 
```

# javascript - 自动隐藏地址栏不起作用

> ID：12734996
> 
> 赞同：0
> 
> 时间：2012-10-04T20:03:54.027
> 
> 标签：javascript, redirect, extjs, sencha-touch-2

我使用以下配置打包了一个 Sencha Touch 2 应用程序。

```
viewport: {
  autoMaximize: true
}, 
```

它工作正常，地址栏不可见。现在我正在尝试从另一个网页（桌面网页）重定向到移动网页。此自动隐藏功能不起作用。

我从网页重定向到移动页面，例如：

```
<script>window.location = 'mobile/index.html' </script> 
```

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T00:52:16.823

将视口的最小高度设置为高于设备高度的值，并检查这是否有帮助。如果是这样，请使用 javascript 将视口最小高度设置为 window.innerHeight 以针对不同的移动平台正确设置。

# c# - Crystal Reports - 在 C# 中，与 Number 类型有什么可比性？

> ID：12734999
> 
> 赞同：0
> 
> 时间：2012-10-04T20:04:07.770
> 
> 标签：c#, types, crystal-reports, size

在我支持的应用程序中，我正在调试一个问题，当报告中显示从数据库返回的值时，偶尔会发生“算术运算导致溢出”异常。我相信所呈现的值来自数据库作为 C# 小数。

但是，在我们的报告中，显示字段具有 Number 类型。我在这里读到[，根据转换考虑](http://msdn.microsoft.com/en-us/library/system.decimal.aspx)，当转换为无法处理返回值大小的较小类型（例如浮点数或双精度值）时，可能会出现溢出异常。

可悲的是，Google 在这方面让我失望了——搜索“Crystal Reports Number 数据类型大小”产生的结果模糊不清，没有告诉我任何有关 Crystal Reports 数字数据类型的信息。

所以，我在这里提出一个问题——Crystal Reports Number 与 C# 数字类型有什么关系？或者它们有关系吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T21:27:33.347

根据以下相关答案，Crystal Reports“数字”类型可能存储为 varchar 或 nvarchar：[Crystal Reports 2008 Column 中的最小值和最大值](https://stackoverflow.com/a/476414/161052)；我不知道你的情况是否属实。我同意搜索 CR 数据类型很困难，我无法找到有关 CR 如何存储数据或有关其存储的数字的精度和比例的信息的适当文档。

[小数](http://msdn.microsoft.com/en-us/library/364x0z75%28v=vs.80%29.aspx)的精度为 28-29 位有效数字，.MaxValue 常量为 79,228,162,514,264,337,593,543,950,335。我想（希望！）这足以满足您的需求，但问题可能是 CR 具有或多或少的精度，即使某些值不一定超出范围，但它们对于目的地的精度过高处理。

例如，请参阅[这个关于 Oracle 到小数问题的问题](https://stackoverflow.com/q/1906361/161052)。[这个问题](https://stackoverflow.com/q/3501006/161052)中还出现了一个有趣的案例，即从一个大的十进制值中减去 0.5 。

如您所见，数据类型之间的转换有时会令人沮丧。您可能希望在生成报告之前尝试使用较小的数据类型，例如[double](http://msdn.microsoft.com/en-us/library/678hzkk9.aspx)。