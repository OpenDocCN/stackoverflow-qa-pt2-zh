# StackOverflow 问答 13406000-13406999

# listview - WinJS - 不断更新列表视图

> ID：13406000
> 
> 赞同：1
> 
> 时间：2012-11-15T20:52:19.263
> 
> 标签：listview, windows-8, winjs

不太清楚如何表达我遇到的这个问题，所以我希望这是有道理的。

我想创建一个列表视图，并设置了所有数据绑定并创建了一个模板等，因此它可以很好地显示数据，但是我显示的每个列表视图图块上的元素之一是实时时钟。问题实际上是如何在不重绘整个列表视图的情况下更新所有列表视图对象。

我目前唯一的工作方法是每秒更新绑定到它的数据，以及我想显示的时间，这有效，但它重绘了整个列表视图。这很昂贵，并且会触发动画（可以取消，但不能完全监听动画开始事件）

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:25:22.203

一种方法是为您的列表视图使用 JavaScript 模板。像往常一样将数据绑定到列表视图，但向数据模型添加一个名为时钟的属性。对于要呈现时钟的数据项，将其值设置为 true。不是在 HTML 中定义模板，而是在 JavaScript 中定义模板（您可以在此处查看如何执行此操作 - [http://msdn.microsoft.com/en-us/library/windows/apps/jj585523.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/jj585523.aspx)）在 JavaScript 模板中然后，您可以添加一些逻辑来确定图块是否应该是基于绑定属性的时钟以及是否创建时钟模板：

```
function itemTemplateFunction(itemPromise) {

        return itemPromise.then(function (item) {

            if (item.data.clock == true) {
                //TODO: Append HTML and JS for your clock object
                //TODO: Perhaps set up a setInterval timer to tick your clock along.

            }
            else {
                //TODO Add the regular template Code, example below
                var div = document.createElement("div");

                var img = document.createElement("img");
                img.src = item.data.picture;
                img.alt = item.data.title;
                div.appendChild(img);

                var childDiv = document.createElement("div");

                var title = document.createElement("h4");
                title.innerText = item.data.title;
                childDiv.appendChild(title);

                var desc = document.createElement("h6");
                desc.innerText = item.data.text;
                childDiv.appendChild(desc);

                div.appendChild(childDiv);

                return div;

            }
        })
    }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T00:16:29.337

给定对您的数据对象的访问权限（我假设您在想要这样做的时候仍然拥有），一个模板，例如：

```
<div data-win-control="WinJS.Binding.Template" id="yourTemplate">
    <div data-win-bind="textContent: timestamp"></div>
</div> 
```

在您希望更改项目的时钟时，通过它们并更新`timestamp`属性，列表视图将更新。例如

```
var item = getItemToUpdateFromSomewhere();
item.timestmap = "2 O'clock"; 
```

# orchardcms - Orchard 基于过滤的下拉选择创建投影或搜索

> ID：13406004
> 
> 赞同：9
> 
> 时间：2012-11-15T20:52:37.300
> 
> 标签：orchardcms

我认为，我有一个简单的功能，我正在尝试将其添加到我的 Orchard (1.6) 网站，但我找不到任何有关如何操作的教程或说明。我有一个名为“Office”的自定义类型，每个办公室都有一个名为“State”的自定义字段，指示办公室所在的州。我实际上将我的办公室设计为代码中的自定义部分，其中包含特定属性，例如 State，但我“想”这就像我通过管理界面将状态添加为 Office 内容部分的字段一样。

现在，我可以创建一个基本投影来显示所有办公室，并使用“具有办公室类型的内容”的简单过滤器来显示所有办公室。但是，我现在要做的是在页面顶部有一个下拉列表，上面写着“**过滤方式：[-SELECT STATE-]** ”，其中包含所有 50 个状态的列表。当用户选择一个州时，页面应该刷新并只显示该州的办公室。

这就是我卡住的地方。我应该通过代码执行此操作，还是可以通过管理 UI 执行此操作？如果通过代码，我是否应该在 Orchard.Search 模块之后对其进行建模（我试图这样做，但我完全迷失了）。如果我可以通过 UI 做到这一点，我是否使用投影？如果是这样，我是否必须创建 50 个单独的投影（每个州一个）？创建和维护这似乎非常耗时。

任何帮助是极大的赞赏！

[仅供参考，http: //ktowneric.com/listings/search](http://ktowneric.com/listings/search)上的网站（使用 Orchard）与我正在寻找的非常相似，开发人员说他使用了预测，但我似乎无法弄清楚他是如何做到的它。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-16T02:32:27.450

你绝对可以使用投影。如果您在引用的页面上使用搜索功能时注意到，输入将形成查询字符串值。您可以使用标记从查询字符串中获取值以在投影过滤器中使用。例如，如果您使用您所说的字段，那么您只需为该字段添加一个过滤器，并在值字段中使用 {Request.QueryString:State}。或者，将“State”替换为您用于查询字符串值的任何键。

这解决了您的投影问题。您将需要构建一个看起来像这样的搜索表单......

```
<form action="/search-results" method="Get">
  <select name="State">
     <option value="OH">Ohio</option>
     ...all the states...
  </select>
  <input type="submit" value="Search" />
</form> 
```

“/search-results”可以是投影页面或任何具有投影小部件的内容。您可以将表单构建为可以放置在某处的小部件，或者出于测试目的，您可以将此 html 粘贴到 html 小部件中进行试用。

# mongodb - 将 Standalone 转换为 Replica Set，不起作用

> ID：13406012
> 
> 赞同：4
> 
> 时间：2012-11-15T20:52:54.057
> 
> 标签：mongodb

我需要将独立集转换为副本集

我正在使用以下文档：

[http://docs.mongodb.org/manual/tutorial/convert-standalone-to-replica-set/](http://docs.mongodb.org/manual/tutorial/convert-standalone-to-replica-set/)

执行以下操作后：

```
mongod --port 27017 --replSet rs0 
```

在终端中显示以下内容

```
Thu Nov 15 10:07:57 [rsStart] trying to contact MY_HOST.local:27017 
Thu Nov 15 10:07:57 [rsStart] couldn't connect to MY_HOST.local:27017: 
couldn't connect to server MY_HOST.local:27017 
Thu Nov 15 10:07:57 [rsStart] replSet can't get local.system.replset 
config from self or any seed (yet) 
```

在 mongo shell 中，rs.initiate() 和 rs.status() 的命令结果如下：

```
> rs.initiate() 

{ 
        "startupStatus" : 4, 
        "info" : "rs0", 
        "errmsg" : "all members and seeds must be reachable to initiate set", 
        "ok" : 0 
} 
>  rs.status() 

{ 
        "startupStatus" : 4, 
        "errmsg" : "can't currently get local.system.replset config from self 
or any seed (EMPTYUNREACHABLE)", 
        "ok" : 0 
} 
```

请我需要帮助并告诉我我做错了什么或我错过了什么

感谢您的关注

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T23:14:01.530

看起来您的 mongod 已经认为它是副本集的一部分。如果您运行“rs.status()”，您可能会看到不止一个主机。此外，mongod 认为它拥有的主机名需要可解析回自身。不要在副本集配置中使用“localhost”作为主机名。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-04-18T19:55:34.980

看看这是你能做的，我在独立电脑上做了同样的事情

1.创建 3 个将存储数据的目录，例如 - c:/data/rep1、c:/data/rep2、c:/data/rep3

2.关闭所有以前的mongodb实例

3.通过命令提示符执行以下操作（如果设置了您的路径），否则转到 mongod 所在的文件夹

命令提示符

```
/>mongod -port 27001 -dbpath -c:/data/rep1 -replSet replication 
```

新的命令提示符

```
/>mongod -port 27002 -dbpath -c:/data/rep2 -replSet replication 
```

新的命令提示符

```
/>mongod -port 27003 -dbpath -c:/data/rep3 -replSet replication 
```

现在通过另一个命令提示符连接到任何 mongod

```
/>mongo -port 27001 
```

然后我们需要编写副本集的配置

```
cfg={_id:"replication",members:[{_id:1,host:"localhost:27001"},   
    {_id:2,host:"localhost:27002"},{_id:3,host:"localhost:27003"}] }

rs.initiate(cfg) 
```

复制将开始

```
rs.status() 
```

# android - getDecorView().getWidth() 在orientationChange 上返回不正确的值

> ID：13406015
> 
> 赞同：0
> 
> 时间：2012-11-15T20:53:07.243
> 
> 标签：android

我`getDecorView().getWidth()`用来确定我的 UI 中某些元素的大小。是的，我知道这是一种 hacky 方法，但我发现它是确定屏幕实际可用宽度的唯一可靠方法（例如，减去屏幕右侧可见的导航栏在 Kindle Fire HD 上横屏）。问题是当设备的方向发生变化时，立即调用此方法会导致值不正确。稍后调用相同的方法（通过发布延迟的可运行）返回正确的值，但这种方法有点像 hack 上的 hack。有没有办法找出装饰视图何时“准备好”向我返回正确的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:45:27.703

我相信，尽管如果您使用活动的 runOnUiThread 在 UI 线程上运行您的请求，我愿意犯错，它应该做您想做的事情，但事情只能在 UI 线程上按顺序发生，因此此调用将排队等待动画完成。

```
runOnUiThread(new Runnable() {
    @Override
    public void run() {
        //code that needs to run on UI thread
    }
}); 
```

# function - 如何在MATLAB中进行向量的多重赋值？

> ID：13406018
> 
> 赞同：-1
> 
> 时间：2012-11-15T20:53:15.883
> 
> 标签：function, matlab, vector, arguments, formula

请我需要你的帮助。`x=[2,4] y=[5,6] z=[2,1]` 我有 3 个带有我想说的值的向量，`[u,v,c]=[x,y,z]` 我想使用（强制性）这个公式：[u,v,c]=??? 例如，我可以说：`a=[x,y,z]` 但这对于我们的任务是不允许的。我尝试了很多次，但 Matlab 说（参数太多）。请帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:15:42.167

使用`deal`，它匹配输入和输出列表：

```
>> [u,v,c] = deal(x,y,z)

u =
     2     4
v =
     5     6
c =
     2     1 
```

# javascript - 哪些控制台命令会将 JavaScript 项目构建到 .appx Windows 8 Metro 应用程序中？

> ID：13406019
> 
> 赞同：3
> 
> 时间：2012-11-15T20:53:18.020
> 
> 标签：javascript, visual-studio, command-line, microsoft-metro

我讨厌 IDE，有没有办法使用 Make 从源代码构建 Metro 应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:16:13.897

MSBuild 可以直接构建 Visual Studio 项目 (* *.csproj* ) 或代码文件：

```
msbuild Project.csproj /t:Rebuild 
```

它与 Visual Studio 和/或 .NET Framework 一起安装，可以在以下位置找到（取决于您的框架版本）：

```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe 
```

我还仔细检查了我们的 Windows 2008 Web 服务器（它*没有*安装 Visual Studio，但安装*了*.NET 4），它也有 MSBuild.exe，所以你甚至不需要 VS。

我相信您需要运行*Publish*目标才能在构建项目后实际创建 appx 包：

```
msbuild myproject.sln /target:Publish /p:configuration=release /p:platform=win32 
```

MSBuild 非常强大，可以使用 .NET 代码进行扩展，并附带旨在执行各种操作的任务。网上有大量的教程，[但这](http://blogs.msdn.com/b/visualstudio/archive/2010/02/25/the-visual-studio-blog.aspx)一个可能很好上手。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T23:19:25.887

> 应用打包程序 (MakeAppx.exe) 从磁盘上的文件创建应用包或将应用包中的文件提取到磁盘。它包含在适用于 Windows 8 的 Microsoft Visual Studio Express 2012 和适用于 Windows 8 的 Windows 软件开发工具包 (SDK) 中。

请参阅[MSDN 上的这篇文章](http://msdn.microsoft.com/en-us/library/windows/desktop/hh446767%28v=vs.85%29.aspx)，但我必须警告您……上次我试图在没有 IDE 的情况下对其进行签名让我*很*头疼。

# c# - Monotouch 按钮鼠标悬停

> ID：13406020
> 
> 赞同：1
> 
> 时间：2012-11-15T20:53:29.577
> 
> 标签：c#, .net, user-interface, xamarin.ios, uikit

我是 MonoTouch 的新手，需要一些关于如何监听按钮的简单 MouseOver 事件的指针。目标是有一个按钮网格，并在通过这些按钮时跟踪移动。实际上它根本不必是按钮，只是我可以操纵和显示字母的东西。

例如，如果您正在运行 Windows，请查看 WordRoom for Windows 8/WP7。

任何指针都会很好！:)

编辑：我在 WP7 中拥有的是一个使用 XAML 的 UserControl，我在其上绘制矩形。然后我收听 ManipulationStarted-event 以了解何时滑动它。这就是我想要的。我正在寻找的结果在这个视频中：

[http://www.youtube.com/watch?v=13IczvA7Ipo](http://www.youtube.com/watch?v=13IczvA7Ipo)

请注意，这不是为了推广游戏，而是为了获得如何在 MonoTouch 中进行相同操作的基本技术解决方案。是的，我写了 WordRoom，所以它不会被抄袭。:)

谢谢

约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T06:22:40.403

如果派生自`UIView`可以覆盖方法`TouchesBegan`，`TouchesMoved`并且`TouchesEnded`.

这是一个示例`TouchesBegan`

```
 public override void TouchesBegan (NSSet touches, UIEvent evt)
    {
        base.TouchesBegan (touches, evt);

        UITouch touch = touches.AnyObject as UITouch;

        if (touch != null && touch.View != this) {
            var rp = touch.LocationInView (touch.View);
            var p = new PointF(touch.View.Frame.X + rp.X, touch.View.Frame.Y + rp.Y);

            // Do your stuff
        }
    } 
```

另一种选择是使用 GestureRecognizer：

[在 MonoTouch 中使用 UIGestureRecognizer](http://dan.clarke.name/2012/08/using-uigesturerecognizer-in-monotouch/)

[通用手势识别器](https://gist.github.com/1453770)

# objective-c - NSMutableArray 实现

> ID：13406022
> 
> 赞同：0
> 
> 时间：2012-11-15T20:53:40.040
> 
> 标签：objective-c, nsmutablearray

NSMutableArray 是如何实现的？

如果有许多 NSMutableArray 对可变数组的引用，例如源数组，并且这些指向数组中的每一个对对象进行不同的排序，是对象复制到每个数组中还是对象指针只是在内部重新排列？

如果源数组使用新对象更新，NSMutableArray 指针是否会自动将条目添加到其内部引用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:57:54.770

准确解析您所询问的场景有点困难，但`NS(Mutable)Array`包含一个对象引用列表。它不会复制您添加到其中的对象，只是保留一个指针。如果这些对象可以更改，并且您从数组外部更改它们，那将反映在您从数组中读回的内容中。

```
NSMutableArray * arr = [NSMutableArray array];
NSMutableArray * child = [NSMutableArray array];
[child addObject:@5];
[arr addObject:child];
[child addObject:@6];
NSLog(@"%@", arr[0]);
> [5, 6] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:01:41.120

它只存储指针。这意味着如果 NSMutableArray 存储不可变对象，那么您可以确定它们不会更改其状态，但如果它具有可变对象，则任何引用对象的状态都可能随时更改。
确切地说，我不知道它是如何实现的，但我会说一个指向 id 的指针。它分配内存，然后在需要的索引处更新 id：

```
id* pointers;
< Allocation>
pointers[i]= newObjectPointer; 
```

# php - 如何将表单参数传递给 jquery 变量并显示它的结果？

> ID：13406035
> 
> 赞同：-4
> 
> 时间：2012-11-15T20:54:22.493
> 
> 标签：php, jquery, forms, youtube, playlist

我不喜欢编程，所以我很难找到工作。我设法想出了一个有效的 jquery，它通过它的 ID 拉出一个 youtube 播放列表并显示它。

保存播放列表的代码是

```
var playListURL = 'http://gdata.youtube.com/feeds/api/playlists/PL60038DE2D1B1A21C?v=2&max-results=5&alt=json&callback=?'; 
```

这是完整的代码.... [http://jsfiddle.net/tqWxc/814/](http://jsfiddle.net/tqWxc/814/)

每次我需要提取不同的播放列表时，我都需要手动编辑代码并更改播放列表 ID。我想要做的是创建一个表单，用户在其中放置播放列表 ID -> 提交 -> 显示播放列表内容

我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:05:55.157

您不想使用表单，因为这会提交页面，并且您基本上会丢失输入的值。相反，您可能希望在元素（在本例中为 a ）上创建一个单击处理程序，`button`并在用户单击该按钮时进行监听。一旦他们这样做了，您就想要获取输入框中的值并将其推送到您的 ajax 调用的 URL 字符串中。您还可以添加一些错误检查逻辑，但下面是一个简单的**[示例](http://jsfiddle.net/ChaseWest/eZPKb/)**：

**HTML：**

```
<input></input>
<button>submit</button>​ 
```

**jQuery：**

```
$(document).ready(function(){
    var playlistId = "";

    $("button").on("click", function(){
      playlistId = $("input").val();
      var playlistURL = 'http://gdata.youtube.com/feeds/api/playlists/' + playlistId + '?v=2&max-results=5&alt=json&callback=?';
       console.log(playlistURL) 
      //make your ajax call with platListURL
    });
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:59:35.803

只需为播放列表在该字符串中的位置创建一个变量。

```
var playlistID = '12345';
var playListURL = 'http://gdata.youtube.com/feeds/api/playlists/' + playlistID + '?v=2&max-results=5&alt=json&callback=?'; 
```

# extjs4 - Extjs4，哪个（什么）是创建渲染到 html 元素的 Extjs 对象的更好方法

> ID：13406039
> 
> 赞同：0
> 
> 时间：2012-11-15T20:54:38.023
> 
> 标签：extjs4

```
<div id="wrap">
    <table id="listTable"></table>
</div> 
```

情况1）

```
Ext.onReady(function () {
    Ext.define("testClass", {
        extend: 'Ext.panel.Panel',
        title: 'Hello',
        layout: 'fit',
        items: { html: 'AAAA' },
        renderTo : 'listTable'
    }, function () {
        var cls = new testClass();
    });
});// end onReady 
```

案例#2)

```
Ext.onReady(function () {

    Ext.create('Ext.panel.Panel', {
        title: 'Hello',
        layout: 'fit',
        items: { html: 'AAAA' },
        renderTo: 'listTable'
    });
});// end onReady 
```

还是你有更好的主意？请给我建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:35:23.977

第二个是正确的。如果你只打算使用一次，为什么还要定义一个类呢？

# java - JNLP文件中允许离线和更新标签有什么区别

> ID：13406041
> 
> 赞同：3
> 
> 时间：2012-11-15T20:54:44.600
> 
> 标签：java, jakarta-ee, jnlp

我正在使用 java web start 作为我的应用程序的标准部署技术。我想知道允许离线和更新标签有什么区别。

`offline-allowed`表示当客户端系统与网络断开时，应用程序可以运行

`<update check="background" policy="prompt-update">`:- 意味着在后台检查更新时启动应用程序，并询问用户是否要下载更新版本或启动缓存版本。

我对允许离线感到困惑，这是否意味着允许离线检查用户计算机是否连接到部署应用程序以进行更新的服务器，或者它只是检查正常的互联网连接。

如果有人`both`在他们的 jnlp 文件中使用 tag 会有什么影响。

总的来说，我希望我的应用程序在后台检查更新[使用桌面快捷方式而不是浏览器链接，我不想每次都使用浏览器访问应用程序]并在更新可用时询问，但它也应该允许启动应用程序无论托管 jnlp 文件的服务器是否可用。

仅供参考：我的应用程序需要连接到 Internet 以进行其他操作，但我不能保证托管 jnlp 和其他应用程序 jar 文件的服务器的可用性。

如果您有任何建议或问题，请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:04:54.093

当您第一次启动 JNLP 文件时，它会将应用程序（在 JNLP xml 文件中定义）安装到 JVM（控制面板 -> Java -> 常规 -> 视图）。

`update check="background"`配置允许您将版本与服务器同步并在服务器有新版本时安装新版本。如果您没有与服务器的连接 - 什么都不会发生。

> 如果有人`both`在他们的 jnlp 文件中使用 tag 会有什么影响。

第二个会受到影响。

这是 JNLP 示例：

```
<?xml version="1.0" encoding="UTF-8"?>
<jnlp spec="1.0+" codebase="http://172.20.0.69:8080/DemoMonitoring/web/" href="monitoring_webstart.jnlp">
<information>
    <title>Demo monitor 172.20.0.69</title>
    <vendor>Demo</vendor>
    <homepage href="http://www.Demo.com"/>
    <description>Demo Monitoring System</description>
    <description kind="short">Demo Monitoring System User Interface.</description>
    <icon href="./images/ne_app_icon_64.png"/>
    <icon kind="splash" href="./images/splash.jpg"/>
    <icon kind="shortcut" href="./images/ne_app_icon_32.png"/>

    <offline-allowed/>
    <shortcut online="false">
        <desktop/>
        <menu submenu="Prabinas">
            <menu submenu="Product Managing System"/>
        </menu>
    </shortcut>

</information>
<security>
    <all-permissions/>
</security>

<resources>
    <!-- Application Resources -->
    <j2se version="1.6+"
          href="http://java.sun.com/products/autodl/j2se"/>
    <jar href="DemoMonitoringPrototype.jar"  main="true" />
    <jar href="lib/log4j-1.2.8.jar" download="eager" />
    <jar href="lib/commons-logging-1.1.1.jar"/>
    <jar href="lib/gson-1.7.1.jar"/>
    <jar href="lib/xpp3_min-1.1.4c.jar"/>
    <jar href="lib/xstream-1.3.1.jar"/>
    <jar href="lib/httpclient-4.1.1.jar"/>
    <jar href="lib/httpcore-4.1.1.jar"/>
    <jar href="lib/DemoMonitorCommon.jar"/>

</resources>
<application-desc name="Prototype" main-class="com.demo.monitor.root.MainRun" width="500" height="500">           
  </application-desc>
 <update check="background" policy="prompt-update"/> 
</jnlp> 
```

# kendo-ui - 剑道 ui web 的主题构建器

> ID：13406044
> 
> 赞同：1
> 
> 时间：2012-11-15T20:54:59.877
> 
> 标签：kendo-ui

我看到有一个用于剑道 UI 移动的主题构建器。有没有像网格这样的网络产品？我在网站上找不到一个。我希望使用一个 css 文件来更改所有 Web 小部件的外观。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:10:35.250

[KendoUI Web Theme Builder](http://demos.kendoui.com/themebuilder/web.html)

[KendoUI Web Theme Builder Documentation](http://docs.kendoui.com/getting-started/themebuilder#using-the-themebuilder-on-your-own-pages)

It looks like you have to bookmark the theme builder and then open it on a page that has KendoUI controls on it.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T14:56:19.757

kendo UI 团队现在已经修复了 web 的主题生成器。只需转到主题构建器部分并选择网络，它将启动一个网络工具，让您为小部件设置主题。

# wpf - 如何在两个 WPF 窗口之间传输自定义对象

> ID：13406049
> 
> 赞同：0
> 
> 时间：2012-11-15T20:55:31.860
> 
> 标签：wpf

我是 WPF 的新手，任何建议都将不胜感激。

我有一个 WPF 应用程序。当用户单击主窗口的“NEXT”按钮时，它将连接到远程数据库。如果 db 连接成功，将显示第二个窗口并从数据库中读取更多信息并显示一些内容。我使用类 SQLRead 来完成数据库连接工作。

```
public class SQLRead
{
    public string sql;
    SqlConnection conn;
    SqlCommand cmd;
    public int counter, length, dIndex, cdIndex, sdIndex;
    public int[,] data;
    public char[,] cdata;
    public string[,] sdata;

    public SQLRead()
    {
        sql = ""; counter = 0; length = 0;
        dIndex = 0; cdIndex = 0; sdIndex = 0;
    }

    public void NewConnection()
    {
        //if (conn != null) conn.Close();
        conn = new SqlConnection(
            @"Data Source = TheServer\TheInstance
              Integrated Security = SSPI;");
        cmd = new SqlCommand(sql, conn);
        cmd.CommandTimeout = 120;
        cmd.CommandType = CommandType.Text;
    }

    public void Connect()
    {
        conn.Open();
    }

    public void Disconnect()
    {
        conn.Close();
    } 
```

我的问题是如何将 SQLRead 实例转移到第二个窗口？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:24:17.523

为什么不创建一个应用程序范围的共享变量来插入 Sqlread 对象？然后您可以从应用程序中的任何位置访问它：

```
class Application
{
    internal static SQLRead sharedSQLRead { get; set; }
} 
```

在主窗口中：

```
Application.sharedSQLRead = new SQLRead(); 
```

在第二个窗口中：

```
Application.sharedSQLRead.doWhatever(); 
```

这似乎比传递参考更容易......

# javascript - execCommand 没有选择？

> ID：13406057
> 
> 赞同：3
> 
> 时间：2012-11-15T20:55:41.677
> 
> 标签：javascript, jquery, html, contenteditable, execcommand

我有以下 div：

```
<div contenteditable="true" unselectable="off" id="foo"> 
```

在这个 div 中，我想让特定数量的单词在用户每次输入时看起来都是**粗体的。**因此，我有以下更改监听器：

```
$('#foo').live('focus', function() {
   before = $(this).html();
}).live('blur keyup paste', function() { 
   if (before != $(this).html()) { $(this).trigger('change'); }
});

$('#foo').live('change', function() {
   // make certain words bold
   document.execCommand ('bold', false, null); // doesn't work
}); 
```

我尝试使用*document.execCommand()*但它仅在我选择要**加粗**的文本时才有效。但我不想选择文本，因为用户不知道应该**加粗**的单词。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:01:06.693

如果不先选择它，您不能使用 execCommand 来加粗文本。

我不明白您到底在做什么，但是如果您知道要加粗的单词，只需`<strong>your word</strong>`在编辑器 html 中使用 js 替换它们即可。

# java - Android，如何模糊/玻璃/霜当前活动

> ID：13406060
> 
> 赞同：19
> 
> 时间：2012-11-15T20:55:57.847
> 
> 标签：java, android, user-interface, android-activity, background

基本上

在一个活动中，我有一个 ListView。当我选择一个项目时，一个透明的活动会以一个小框的形式打开。当此框出现时，您仍然可以查看之前的活动屏幕，

我想弄清楚的是如何像[这里](http://xniikk.deviantart.com/art/One-V-Panels-336032755)链接的图像一样模糊以前的屏幕（忽略 UI，只看模糊的草地区域）。

这怎么可能？

谢谢你的任何建议。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-11-15T21:52:14.553

对于 API < 14，您可以使用 flag `WindowManager.LayoutParams.FLAG_BLUR_BEHIND`，但它已被弃用，并且更高的 API 不再支持内置模糊

但是，您可以使用常规视图或叠加层来执行此操作。你想做的是：

*   `Bitmap`从您的活动的整体布局创建一个（[例如，请参见此处](https://stackoverflow.com/a/7200559/752320)）
*   用任何你想要的方法模糊那个位图（[这里有几个例子](https://stackoverflow.com/q/2067955/752320)）
*   `View`在涵盖所有内容的布局中添加（或取消隐藏）a 。将 bkg 设置为模糊位图
*   打开您的对话框/透明活动
*   当它关闭时，请删除`View`，或者`setVisibility(GONE)`如果您将再次使用它。

# jvectormap - jVectorMap 着色在某些国家/地区失败

> ID：13406062
> 
> 赞同：3
> 
> 时间：2012-11-15T20:56:05.877
> 
> 标签：jvectormap

我正在使用 jVectorMap 通过着色显示国家/地区值（即，国家/地区根据其值具有不同的颜色）。一切正常，除非某些国家/地区包含在数据集中。那么这些国家就不会像应该的那样被着色（事实上，它们根本不会被着色）。

我已将巴林 (BH) 和新加坡 (SG) 确定为破坏地图的两个国家/城邦。看起来这些国家似乎不包括在地图上。他们不在那里，我并不感到惊讶。但是，我希望地图不会失败。

JavaScript 错误`'this.elements[...].element' is null or not an object`在于以下内容（请参阅下面代码中有关失败的注释）。

```
jvm.DataSeries.prototype={
    //...
    setValues:function(e){
        var t=Number.MIN_VALUE,n=Number.MAX_VALUE,r,i,s={};
        if(!this.params.min||!this.params.max){
            for(i in e)
                r=parseFloat(e[i]),r>t&&(t=e[i]),r<n&&(n=r);
            this.params.min||this.scale.setMin(n),this.params.max||this.scale.setMax(t),this.params.min=n,this.params.max=t
        }
        for(i in e)
            //FAILS ON THE FOLLOWING LINE
            r=parseFloat(e[i]),r?s[i]=this.scale.getValue(r):s[i]=this.elements[i].element.style.initial[this.params.attribute];
        this.setAttributes(s),this.values=e
    },
    //...
}, 
```

有没有办法解决这个问题？我宁愿**不**更改 jVectorMap 代码，或者必须在我的 Java 代码中执行以下操作：

```
if (!countryCode.equals("BH") && !countryCode.equals("SG")) {
    countryValues.put(countryCode, countryValue);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T02:20:59.273

如果您想确保您的数据仅包含地图中的国家/地区代码，您可以在为地图设置数据之前使用地图国家/地区代码作为过滤条件过滤数据。

您可以定义一种方法，在该方法中传递数据，遍历每个项目并删除地图路径中不存在国家代码的条目：

```
function filterDataForMap(data, mapName){
    var filteredData = {};
    $.each(data,function(key, value){
       //Only add when the key (country code) exists in the map
       if(jvm.WorldMap.maps[mapName].paths[key]!==undefined) {
          filteredData[key] = value;        
       }                
    });
    return filteredData;
} 
```

应用于地图的创建：

```
$('#map').vectorMap({
        map: 'world_mill_en',
        series: {
          regions: [
            {
              scale: colorScale,
              attribute: 'fill',
              normalizeFunction: 'polynomial',
              values: filterDataForMap(mapData, 'world_mill_en') //filter data
            }]
        }
 }); 
```

# load-balancing - 分片和负载均衡器：它是如何工作的？

> ID：13406064
> 
> 赞同：4
> 
> 时间：2012-11-15T20:56:11.020
> 
> 标签：load-balancing, sharding, high-availability

我想我对一些概念感到困惑，这就是为什么我请你帮我解决这个问题：

我们有一个被许多用户（公司）使用的大型网络应用程序，它部署在用户场所。但是现在我们要进行 saas，所以为了设置应用程序的行为，我们正在做一些调整。

为了处理我们的用户，我们的工作方式如下：我们将为每个用户提供一个数据库。当然，我们需要负载平衡，因为我们需要很多服务器，所以我提出了一个“分片”架构。我的想法是让 Web 服务器彼此完全独立。因此，我们将所有用户数据拆分为 10 台服务器。因此，当用户登录时，实际上他将连接到例如服务器 4。实际上，为了保持可用性，每台服务器中的一个将是一个由两台服务器组成的小型集群 - 三台服务器，它们的数据库在它们之间进行复制。我们在每个“集群”中使用内存缓存。我们甚至可以在这个级别进行负载平衡，我们只是认为我们不需要它，因为数据/用户已经被分割了。

一些问题：

1.  这是分片吗？请注意，每个集群都服务于给定的一组用户，并且集群之间没有关系。我们在每个集群中没有一个带有联合数据库的主数据库，而是相同的数据库结构，只是它在服务器之间拆分。

2.  我如何在用户第一次到达时重定向用户（未经过身份验证）？不是在这里应用负载平衡吗？但是如果用户数据在服务器之间拆分？我一直在想，在这里我们会有一个“公共/身份验证集群”来处理未经身份验证的用户，即网站的“公共”部分。并且根据一个非常简单的 memcache db，它会将用户重定向到他们的数据所在的相应集群。如果是这样的话 ..

3.  我如何重定向它们？我看到的唯一方法是将它们发送到[此处](https://stackoverflow.com/questions/215347/sharding-sic-the-web-tier-in-order-to-prevent-a-load-balancer-bottleneck)解释的内容。只是我不想要 server123.mysite.com。

我认为“公共/身份验证集群”设计得不好。因为我有 2-3 台服务器仅用于为所有用户提供主站点（在身份验证之前），而在后面我有 5-6 个集群，其中一些可能正在睡觉。或相反：我有一个负载很重的集群，而公共集群正在睡觉，因为它的唯一任务是显示主页并处理重定向到登录过程。

如果这一切奏效，

4.  这个结构好吗？请假设每个用户都很重（事实上，我们不仅有一个 php 正在运行，还有 .NET 和其他服务在运行，等等）。我不认为这是一种矫枉过正的做法，而只是一种处理多个用户的结构。你有其他想法吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-07T19:09:55.443

基本上我会说，是的，这是分片。

为了避免需要对哪个用户住在哪个集群上有一些“全局”知识（因此您提到了一个 memcache 数据库），您可以使用某种（一致的）散列。

要将用户重定向到正确的集群而不需要单独的主机名，您可以在成功验证后向客户端发送一个 cookie，其中包含用户集群的标识符。负载均衡器可以评估 cookie，以将所有进一步的请求转发到正确的集群。这是负载平衡中“会话持久性”的常见做法。

我认为负载平衡一词仅适用于确实有多个（活动/活动）服务器是为一个用户提供请求的有效候选者。

# php - 使用 simplexml_load，我如何遍历 RSS 提要中的多个对象并仅提取某些数据？

> ID：13406067
> 
> 赞同：1
> 
> 时间：2012-11-15T20:56:30.247
> 
> 标签：php, object, load, simplexml

如何遍历 RSS 提要中的多个对象（见下文）并使用 simplexml_load 对象处理仅获取两个不同数组中的`title`和？`videoid`

包含类似变量的对象的相关 RSS 提要：

```
object(SimpleXMLElement)[1]
 public 'id' => string 'tag:youtube.com,2008:videos' (length=27)
public 'updated' => string '2012-11-15T19:57:00.097Z' (length=24)
public 'category' => 
object(SimpleXMLElement)[2]
  public '@attributes' => 
    array
      'scheme' => string 'http://schemas.google.com/g/2005#kind' (length=37)
      'term' => string 'http://gdata.youtube.com/schemas/2007#video' (length=43)
public 'title' => string 'Videos matching: mitar miric opasnica' (length=37)
public 'logo' => string 'http://www.youtube.com/img/pic_youtubelogo_123x63.gif'   
(length=53)
public 'link' => 
array
  0 => 
    object(SimpleXMLElement)[3]
      public '@attributes' => 
        array
          ...
  1 => 
    object(SimpleXMLElement)[4]
      public '@attributes' => 
        array
          ...
  2 => 
    object(SimpleXMLElement)[5]
      public '@attributes' => 
        array
          ...
  3 => 
    object(SimpleXMLElement)[6]
      public '@attributes' => 
        array
          ...
  4 => 
    object(SimpleXMLElement)[7]
      public '@attributes' => 
        array
          ...
  5 => 
    object(SimpleXMLElement)[8]
      public '@attributes' => 
        array
          ...
public 'author' => 
object(SimpleXMLElement)[9]
  public 'name' => string 'YouTube' (length=7)
  public 'uri' => string 'http://www.youtube.com/' (length=23)
public 'generator' => string 'YouTube data API' (length=16)
public 'entry' => 
 array
  0 => 
    object(SimpleXMLElement)[10]
      public 'id' => string 'tag:youtube.com,2008:video:iCm1ohCJHhk' (length=38)
      public 'published' => string '2008-11-28T00:20:17.000Z' (length=24)
      public 'updated' => string '2011-11-14T10:56:22.000Z' (length=24)
      public 'category' => 
        array
          ...
      public 'title' => string 'Mitar Miric & Zilhad XXL Band - Opasnica' (length=40)
      public 'content' => 
        object(SimpleXMLElement)[18]
          ...
      public 'link' => 
        array
          ...
      public 'author' => 
        object(SimpleXMLElement)[24]
          ...
  1 => 
    object(SimpleXMLElement)[11]
      public 'id' => string 'tag:youtube.com,2008:video:O3Wsm3GbQcg' (length=38)
      public 'published' => string '2008-06-07T21:03:43.000Z' (length=24)
      public 'updated' => string '2012-09-26T11:09:20.000Z' (length=24)
      public 'category' => 
        array
          ...
      public 'title' => string 'Mitar Miric - Za Koga Cuvas (DM SAT)' (length=36)
      public 'content' => 
        object(SimpleXMLElement)[27]
          ...
      public 'link' => 
        array
          ...
      public 'author' => 
        object(SimpleXMLElement)[34]
          ...
  2 => 
    object(SimpleXMLElement)[12]
      public 'id' => string 'tag:youtube.com,2008:video:rv5VVJajGsw' (length=38)
      public 'published' => string '2007-09-09T23:04:02.000Z' (length=24)
      public 'updated' => string '2012-11-12T12:51:23.000Z' (length=24)
      public 'category' => 
        array
          ...
      public 'title' => string 'Mitar Miric - Ja ne zivim ovde' (length=30)
      public 'content' => 
        object(SimpleXMLElement)[37]
          ...
      public 'link' => 
        array
          ...
      public 'author' => 
        object(SimpleXMLElement)[44]
          ...
  3 => 
    object(SimpleXMLElement)[13]
      public 'id' => string 'tag:youtube.com,2008:video:lfi15eLXzuc' (length=38)
      public 'published' => string '2006-04-14T23:45:01.000Z' (length=24)
      public 'updated' => string '2012-11-04T16:37:57.000Z' (length=24)
      public 'category' => 
        array
          ...
      public 'title' => string 'Mitar Miric - Opasnica (by Iggyy)' (length=33)
      public 'content' => 
        object(SimpleXMLElement)[47]
          ...
      public 'link' => 
        array
          ...
      public 'author' => 
        object(SimpleXMLElement)[53]
          ...
  4 => 
    object(SimpleXMLElement)[14]
      public 'id' => string 'tag:youtube.com,2008:video:ctM4mHsGx-0' (length=38)
      public 'published' => string '2011-07-26T23:28:06.000Z' (length=24)
      public 'updated' => string '2012-07-07T22:27:19.000Z' (length=24)
      public 'category' => 
        array
          ...
      public 'title' => string 'Cvaka Cvak - Palis Palis Mene' (length=29)
      public 'content' => 
        object(SimpleXMLElement)[56]
          ...
      public 'link' => 
        array
          ...
      public 'author' => 
        object(SimpleXMLElement)[63]
          ...
  5 => 
    object(SimpleXMLElement)[15]
      public 'id' => string 'tag:youtube.com,2008:video:LqAtJcWAyJ8' (length=38)
      public 'published' => string '2008-07-10T10:39:13.000Z' (length=24)
      public 'updated' => string '2012-04-22T11:05:28.000Z' (length=24)
      public 'category' => 
        array
          ...
      public 'title' => string 'OPASNICE!!!!!' (length=13)
      public 'content' => 
        object(SimpleXMLElement)[66]
          ...
      public 'link' => 
        array
          ...
      public 'author' => 
        object(SimpleXMLElement)[72]
          ... 
```

# delphi - Delphi 5迁移 - 无法找到文件

> ID：13406076
> 
> 赞同：0
> 
> 时间：2012-11-15T20:57:16.713
> 
> 标签：delphi, delphi-xe3

我正在将我的 Delphi 5 应用程序迁移到 Delphi XE3。我对 XE3 完全陌生。

在编译应用程序时，我收到错误“未声明的标识符 Interace_Info”。

代码如下：

abc.inc：

```
Interace_Info = packed record
iflag: ulong;
end; 
```

.

```
Unit unit2
type
ulong: DWORD;
{$include abc.inc}
end. 
```

.

```
Unit unit1
uses unit2;
type
Tlocal= array[0..10] of Interace_Info; 
```

其中 Interace_Info 在“abc.inc”文件中声明。

我无法通过按 Ctrl+鼠标左键打开使用部分中提到的任何文件。我收到错误“无法找到文件'winapi.unit2.pas'”。

解决方案是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:14:14.870

正如所评论的，您的代码不能是真正的代码。

我正在发布这个，我现在用 Delphi XE3 编译没有任何问题。

文件：abc.inc

```
type
  Interace_Info = packed record
    iflag: ulong;
  end; 
```

文件：Unit2.pas

```
unit Unit2;

interface
uses winapi.Windows;

{$include abc.inc}

implementation

end. 
```

文件：Unit1.pas

```
unit Unit1;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes,  Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls;

type
  TForm1 = class(TForm)
    Button1: TButton;
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation
uses Unit2;

type
  TLocal = array[0..10] of Interace_Info;

{$R *.dfm}

procedure TForm1.Button1Click(Sender: TObject);
var
  ALocal: TLocal;
begin
  ALocal[0].iflag := 0;
  ShowMessage(IntToStr(ALocal[0].iflag));
end;

end. 
```

它编译和运行没有任何问题。

# c# - C# 应用程序启动时显示多个表单

> ID：13406077
> 
> 赞同：6
> 
> 时间：2012-11-15T20:57:23.577
> 
> 标签：c#, winforms

我的 C# 应用程序中有 3 个表单——Form1、Form2 和 Form3。目前，当我的应用程序启动时，它会加载 Form1。我希望在应用程序启动时打开所有三个表单。

我试过这样做 `Program.cs`：

```
static void Main()
{     
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    Application.Run(new Form1());
    Application.Run(new Form2());
} 
```

但 Form2 仅在 Form1 关闭后显示。

应用程序启动后，如何使所有 3 个表单同时显示？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-15T21:26:00.697

通常，让您的应用程序执行默认操作以外的其他操作（打开表单，等待它关闭，然后退出）的正确方法是创建一个继承自[`ApplicationContext`](http://msdn.microsoft.com/en-us/library/system.windows.forms.applicationcontext.aspx). 然后你将你的类的一个实例传递给该`Application.Run`方法。当应用程序应该关闭时，请`ExitThread()`从您的班级中调用。

在这种情况下，您可以在应用程序加载时创建三个表单的实例，并为它们的`Closed`事件注册一个处理程序。当每个表单关闭时，处理程序将检查是否还有其他表单仍然打开，如果没有则关闭应用程序。

[MSDN](https://msdn.microsoft.com/en-us/library/system.windows.forms.applicationcontext(v=vs.110).aspx#Anchor_7)上的示例做了两件事：

1.  打开多个表单并在它们全部关闭时退出应用程序
2.  关闭每个表单时保存表单的最后大小和位置。

一个更简单的示例，仅在关闭所有表单后关闭应用程序：

```
class MyApplicationContext : ApplicationContext {
    private void onFormClosed(object sender, EventArgs e) {
        if (Application.OpenForms.Count == 0) {
            ExitThread();
        }
    }

    public MyApplicationContext() {
        //If WinForms exposed a global event that fires whenever a new Form is created,
        //we could use that event to register for the form's `FormClosed` event.
        //Without such a global event, we have to register each Form when it is created
        //This means that any forms created outside of the ApplicationContext will not prevent the 
        //application close.

        var forms = new List<Form>() {
            new Form1(),
            new Form2(),
            new Form3()
        };
        foreach (var form in forms) {
            form.FormClosed += onFormClosed;
        }

        //to show all the forms on start
        //can be included in the previous foreach
        foreach (var form in forms) {
            form.Show();
        }

        //to show only the first form on start
        //forms[0].Show();
    }
} 
```

然后，您的`Program`课程如下所示：

```
static class Program {
    [STAThread]
    static void Main() {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new MyApplicationContext());
    }
} 
```

应用程序关闭逻辑显然可以自定义 - 任何表单仍然打开，或者只有这三种类型中的一种，或者只有前三个实例（这需要持有对前三个实例的引用，可能在 a 中`List<Form>`）。

回复：每个表单创建的全局事件——[这](http://www.codeproject.com/Articles/8774/Application-Event-Handler-for-WinForms)看起来很有希望。

[这里](https://stackoverflow.com/a/13407161/111794)有一个类似的例子。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-15T20:59:43.530

[`Form.Load`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.load.aspx)从 的事件开始其他形式`Form1`。

```
private void Form1_Load(object sender, EventArgs e)
{
    Form2 form2 = new Form2();
    form2.Show();
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-08-12T20:18:31.013

我通过稍微修改 Zev Spitz 的答案找到了我的解决方案。

注意：此版本仅启动表单列表中指定的第一个表单。

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Windows.Forms;

class MyApplicationContext : ApplicationContext
{
    public List<Form> Forms = new List<Form>() {
        new Form1()
    };

    private List<Form> FormCollectionToList(FormCollection fc)
    {
        List<Form> ff = new List<Form>();
        foreach (Form f in fc)
        {
            ff.Add(f);
        }
        return ff;
    }

    private void onFormClosed(object sender, EventArgs e)
    {
        Forms = FormCollectionToList(Application.OpenForms);
        if (Forms.Count == 0)
        {
            ExitThread();
        }
        foreach (var form in Forms)
        {
            form.FormClosed -= onFormClosed;
            form.FormClosed += onFormClosed;
        }
    }

    public MyApplicationContext()
    {
        if (Forms.Count == 0)
        {
            Process.GetCurrentProcess().Kill();
        }
        Forms[0].FormClosed += onFormClosed;
        Forms[0].Show();
    }
} 
```

这个版本启动了所有这些。

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Windows.Forms;

class MyApplicationContext : ApplicationContext
{
    public List<Form> Forms = new List<Form>() {
        new Form1()
    };

    private List<Form> FormCollectionToList(FormCollection fc)
    {
        List<Form> ff = new List<Form>();
        foreach (Form f in fc)
        {
            ff.Add(f);
        }
        return ff;
    }

    private void onFormClosed(object sender, EventArgs e)
    {
        Forms = FormCollectionToList(Application.OpenForms);
        if (Forms.Count == 0)
        {
            ExitThread();
        }
        foreach (var form in Forms)
        {
            form.FormClosed -= onFormClosed;
            form.FormClosed += onFormClosed;
        }
    }

    public MyApplicationContext()
    {
        if (Forms.Count == 0)
        {
            Process.GetCurrentProcess().Kill();
        }
        foreach (var form in Forms)
        {
            form.FormClosed += onFormClosed;
            form.Show();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-15T21:08:52.257

您也可以使用 3 个选项卡和一个表单而不是 3 个表单

# java - Java Properties.load() - 如何切换键值对？

> ID：13406078
> 
> 赞同：0
> 
> 时间：2012-11-15T20:57:26.417
> 
> 标签：java, properties

我需要从文件中读取属性对象，但是我需要切换键和值对，即我需要键成为属性值，反之亦然。我也不能只在我正在阅读的文件上更改它。有什么想法可以做到这一点吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:02:23.253

您可以创建第二个`Properties`对象，遍历您刚刚阅读的所有内容，调用`put(entry.getValue(), entry.getKey())`并拥有它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-15T21:05:13.017

寻找这个[Properties.store()](http://docs.oracle.com/javase/6/docs/api/java/util/Properties.html#store%28java.io.Writer,%20java.lang.String%29)

# jquery - 如何结合 jQuery UI 的可拖动、可放置和可调整大小？

> ID：13406079
> 
> 赞同：1
> 
> 时间：2012-11-15T20:57:29.023
> 
> 标签：jquery, jquery-ui, jquery-ui-draggable, jquery-ui-resizable, jquery-ui-droppable

我正在尝试结合所有这三个插件，但我在将 resizeable() 添加到删除的项目时遇到了一些问题。

我有#container1，其中包含可以删除并克隆到#container2 中的项目。放入#container2 后，克隆的项目应该可以拖动到#container2 并能够调整大小。拖放效果很好，但是当我添加 $canvasElement.resizable() 时，拖放的元素得到宽度和高度 = 0px。

$（函数（）{

```
$("#container1 img").draggable({
    helper: 'clone',
    cursor: 'move'
});

$("#container2").droppable({
    accept: 'img',
    drop: function (event, ui) {
        var $canvas = $(this);
        if (!ui.draggable.hasClass('canvas-element')) {
            var $canvasElement = ui.draggable.clone();
            $canvasElement.addClass('canvas-element');
            $canvasElement.resizable();
            $canvasElement.draggable({
                containment: '#container2'
            });
            $canvas.append($canvasElement);
            $canvasElement.css({
                left: (ui.position.left),
                top: (ui.position.top),
                position: 'absolute'
            });
        }
    }
}); 
```

});

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T14:40:47.240

看看这个[JQFAQ.com](http://jqfaq.com/how-to-combine-jquery-ui-draggable-droppable-and-resizable/)主题，这将帮助您结合 ui-draggable、droppable 和 resizable。还有更多示例常见问题解答。

# mysql - MySQL 将一个表中的值连接到另一个表的记录中

> ID：13406080
> 
> 赞同：3
> 
> 时间：2012-11-15T20:57:33.657
> 
> 标签：mysql

我有三个表（多对多关系）：`items`、`items_to_tags`和`tags`。`items`和`tags`表具有唯一的 ID 列，并且表`items_to_tags`具有列`item_id`和`tag_id`。有没有办法从`items`和`tags`表中选择所有结果，但所有结果都合并到同一条记录中？

例如，如果我有这些数据：

*   `items`：

    ```
    id     name
    1      'item1'
    2      'item2' 
    ```

*   `tags`：

    ```
    id     name
    1      'tag1'
    2      'tag2'
    3      'tag3' 
    ```

*   `items_to_tags`：

    ```
    item_id    tag_id
    1          1
    1          2
    1          3
    2          3 
    ```

查询的结果应该是：

```
item_id   item_name   tags
1         'item1'     'tag1,tag2,tag3' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T21:05:18.673

您可以使用 MySQL [`GROUP_CONCAT()`](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)：

```
select i.id,
  i.name,
  group_concat(t.name SEPARATOR ', ') tags
from items i
left join items_to_tags it
  on i.id = it.item_id
left join tags t
  on it.tag_id = t.id
group by i.id, i.name 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/dca9d/9)

结果：

```
| ID |  NAME |             TAGS |
---------------------------------
|  1 | item1 | tag1, tag2, tag3 |
|  2 | item2 |             tag3 | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:00:25.403

这可以使用 MySQL 的[GROUP_CONCAT](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)来完成。

# java - 这段代码有什么问题？霍夫曼编码

> ID：13406082
> 
> 赞同：1
> 
> 时间：2012-11-15T20:57:50.743
> 
> 标签：java, algorithm, map, huffman-code

在这段代码中，我试图将字符串拆分为字符并将每个字符放入映射中。如果同一个字符多次出现，我会在其上放置一个计数器并将其放回地图中，增加整数（频率）。

```
public class FrequencyMap {
   public static Map<Character, Integer> generateMap(String s){
       HashMap<Character, Integer> myMap = new HashMap<Character, Integer>();
       //generate a map of frequencies of the characters in s
       //need to break the string down into individual characters, sort them
       //in there frequencies then place them in map
       for(int i = 0; i < s.length(); i++){
           //break string into characters
           //need to determine how many characters make up the string, can do this by 
           //putting a counter on each letter that appears when the string is being 
           //broken down, if a letter reoccurs increment the counter by one.
           s.substring(i);
           char ch = s.charAt(i);
           myMap.put(ch, i);
           //calculating the occurence of a character in a string.
           if(myMap.containsKey(ch)){                   
               myMap.put(ch, myMap.get(i) + 1);                   
                  }//end of if statement
           }//end of for loop          
           return myMap;
       }//end of public generateMap()
   }//end of FrequencyMap 
```

这里是主要的

```
 public static void main(String args[]){

       String str = "missisippi";

       Map frequencyMap = FrequencyMap.generateMap(str);
       HuffmanTree tree = new HuffmanTree(frequencyMap);
       Map<Character, String> encodingMap = tree.getEncodingMap();

       String encoded = tree.encode(str, encodingMap);
       System.out.println(encoded);     
   }//end of main 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:08:32.693

好吧，有几件事...

字符串是不可变的！！

```
s.substring(i); 
```

真的应该

```
s = s.substring(i); 
```

虽然我仍然不太确定这到底是什么意思。

* * *

第二..

这些行没有意义

```
myMap.put(ch, i);

if(myMap.containsKey(ch)){                   
    myMap.put(ch, myMap.get(i) + 1);                   
} 
```

您刚刚添加了密钥`ch`，然后您立即询问地图是否包含`ch`- 这总是正确的。

我认为您可能打算将`if`- 语句*放在首位*并放入-子句。哦，可能应该是。`myMap.put(ch, **1**)``else``myMap.get(i)``myMap.get(ch)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:09:11.553

您正在使用字符位置初始化计数器：

```
myMap.put(ch, i); 
```

你想在哪里：

```
myMap.put(ch, 1); 
```

您还想在初始化计数器*之前*检查映射中是否存在已经存在的字符，增加它的计数器（使用`get(ch)`not `get(i)`），给出：

```
 char ch = s.charAt(i);
    //calculating the occurence of a character in a string.
    if (myMap.containsKey(ch)){                   
        myMap.put(ch, myMap.get(ch) + 1);
    } else {
        myMap.put(ch, 1);
    }//end of if statement 
```

# c# - GridView 中的 ASP.NET 编辑和删除问题

> ID：13406086
> 
> 赞同：1
> 
> 时间：2012-11-15T20:57:55.917
> 
> 标签：c#, asp.net, sql-server, gridview

我创建了具有插入、编辑和删除功能的 GridView。插入很好，但不是删除和编辑。当我单击删除时，它应该是自动删除行，但它永远不会发生，因为它仍然存在。第二个问题与编辑相同，我单击编辑，然后在此处更改某些内容，然后单击更新，单击后没有任何更改，并且 GridView 中的数据仍然相同。我确定我错过了一些小东西......请帮忙！

这里是 HTML 背后的 C# 代码，

```
protected void GridViewServer_RowEditing(object sender, GridViewEditEventArgs e)
    {
        GridViewServer.EditIndex = e.NewEditIndex;
        BindGridView();          

    }

    protected void GridViewServer_RowCancelingEdit(object sender, GridViewCancelEditEventArgs e)
    {
        GridViewServer.EditIndex = -1;
        BindGridView();           
    }

    protected void GridViewServer_RowDeleting(object sender, GridViewDeleteEventArgs e)
    {           
        GridViewRow _row = GridViewServer.Rows[e.RowIndex];
        Label servername = (Label)_row.FindControl("lblServerName");

        SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["Database_Shared_NotebookConnectionString"].ConnectionString);
        SqlCommand cmd = new SqlCommand("delete from tblServer where ServerName = '" + servername + "'", conn);
        cmd.CommandType = CommandType.Text;
        conn.Open();
        cmd.ExecuteNonQuery();

        GridViewServer.EditIndex = -1;
        BindGridView();
        conn.Close();

    }

    protected void GridViewServer_RowUpdating(object sender, GridViewUpdateEventArgs e)
    {

        GridViewRow _row = GridViewServer.Rows[e.RowIndex];
        Label servername = (Label)_row.FindControl("lblServerName");
        SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["Database_Shared_NotebookConnectionString"].ConnectionString);
        SqlCommand cmd = new SqlCommand("update tblServer set ClusterName = @ClusterName, Architecture = @Architecture, Database_Type = @DataType, Restriction = @Restriction, Business_Continuity_Plan = @BCP, Tenant_Code = @TenantCode where ClusterName =  '" + servername + "'", conn);
        cmd.CommandType = CommandType.Text;
        //cmd.Parameters.AddWithValue("@ServerName", ((Label)_row.FindControl("lblServerName")).Text);
        cmd.Parameters.AddWithValue("@ClusterName", ((DropDownList)_row.FindControl("DropDownClusterName")).Text);
        cmd.Parameters.AddWithValue("@Architecture", ((DropDownList)_row.FindControl("DropDownArchitecture")).Text);
        cmd.Parameters.AddWithValue("@DataType", ((DropDownList)_row.FindControl("DropDownDataType")).Text);
        cmd.Parameters.AddWithValue("@Restriction", ((DropDownList)_row.FindControl("DropDownRestriction")).Text);
        cmd.Parameters.AddWithValue("@BCP", ((TextBox)_row.FindControl("txtBCP")).Text);
        cmd.Parameters.AddWithValue("@TenantCode", ((TextBox)_row.FindControl("txtTenantCode")).Text);

        conn.Open();
        cmd.ExecuteNonQuery();

        GridViewServer.EditIndex = -1;
        BindGridView();
        conn.Close();

    } 
```

和

```
public void BindGridView()
    {
        SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["Database_Shared_NotebookConnectionString"].ConnectionString);

        conn.Open();

        string sqlquery = ("SELECT * FROM tblServer");

        SqlCommand command = new SqlCommand(sqlquery, conn);

        SqlDataAdapter adp = new SqlDataAdapter(command);

        DataSet ds = new DataSet();

        adp.Fill(ds);

        GridViewServer.DataSource = ds.Tables[0];

        GridViewServer.DataBind();
    } 
```

如果您需要查看 GridView HTML 代码，

```
<asp:GridView ID="GridViewServer" runat="server" AllowPaging="True" AllowSorting="True" AutoGenerateColumns="False" BackColor="White" BorderColor="#CCCCCC" BorderStyle="None" BorderWidth="1px" CellPadding="3" DataKeyNames="ServerName" GridLines="None" ShowFooter="True" onrowcancelingedit="GridViewServer_RowCancelingEdit" 
        onrowdeleting="GridViewServer_RowDeleting" onrowediting="GridViewServer_RowEditing" 
        onrowupdating="GridViewServer_RowUpdating">
        <Columns>               
            <asp:TemplateField HeaderText="ServerName" SortExpression="ServerName">
                <ItemTemplate>
                    <asp:Label ID="lblServerName" runat="server" Text='<%# Eval("ServerName") %>'></asp:Label>
                </ItemTemplate>
                <EditItemTemplate>
                    <asp:Label ID="txtServerName" runat="server" Text='<%# Eval("ServerName") %>'></asp:Label>
                </EditItemTemplate>
                <FooterTemplate>
                    <asp:TextBox ID="txtServerName" runat="server"></asp:TextBox>
                    <asp:RequiredFieldValidator ID="rfvServerName" runat="server" ControlToValidate="txtServerName" ErrorMessage="Required" ForeColor="Red"></asp:RequiredFieldValidator>
                </FooterTemplate>
            </asp:TemplateField>
            <asp:TemplateField HeaderText="ClusterName" SortExpression="ClusterName">
                <ItemTemplate>
                    <asp:Label ID="lblClusterName" runat="server" Text='<%# Eval("ClusterName") %>'></asp:Label>
                </ItemTemplate>
                <EditItemTemplate>
                    <asp:DropDownList ID="DropDownClusterName" runat="server" AutoPostBack="True" DataSourceID="ClusterName" DataTextField="ClusterName" DataValueField="ClusterName">
                    </asp:DropDownList>
                </EditItemTemplate>
                <FooterTemplate>
                    <asp:DropDownList ID="DropDownClusterName" runat="server" DataSourceID="ClusterName" DataTextField="ClusterName" DataValueField="ClusterName">
                    </asp:DropDownList>
                    <asp:SqlDataSource ID="ClusterName" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [ClusterName] FROM [tblCluster]"></asp:SqlDataSource>                       
                </FooterTemplate>
            </asp:TemplateField>
            <asp:TemplateField HeaderText="Architecture" SortExpression="Architecture">
                <ItemTemplate>
                    <asp:Label ID="lblArchitecture" runat="server" Text='<%# Eval("Architecture") %>'></asp:Label>
                </ItemTemplate>
                <EditItemTemplate>
                    <asp:DropDownList ID="DropDownArchitecture" runat="server">
                        <asp:ListItem Selected="True"></asp:ListItem>
                        <asp:ListItem>BSN EAP</asp:ListItem>
                        <asp:ListItem>BSN NEA</asp:ListItem>
                        <asp:ListItem>BSNConnect.com</asp:ListItem>
                        <asp:ListItem>BSNDMZ.COM</asp:ListItem>
                        <asp:ListItem>Dow EAP</asp:ListItem>
                        <asp:ListItem>Dow NEA</asp:ListItem>
                     </asp:DropDownList>
                </EditItemTemplate>
                <FooterTemplate>
                    <asp:DropDownList ID="DropDownArchitecture" runat="server">
                        <asp:ListItem Selected="True"></asp:ListItem>
                        <asp:ListItem>BSN EAP</asp:ListItem>
                        <asp:ListItem>BSN NEA</asp:ListItem>
                        <asp:ListItem>BSNConnect.com</asp:ListItem>
                        <asp:ListItem>BSNDMZ.COM</asp:ListItem>
                        <asp:ListItem>Dow EAP</asp:ListItem>
                        <asp:ListItem>Dow NEA</asp:ListItem>
                     </asp:DropDownList>
                     <asp:RequiredFieldValidator ID="rfvArchitecture" runat="server" ControlToValidate="DropDownArchitecture" ErrorMessage="Required" ForeColor="Red"></asp:RequiredFieldValidator>
                 </FooterTemplate>
             </asp:TemplateField>
            <asp:TemplateField HeaderText="Database_Type" SortExpression="Database_Type">
                <ItemTemplate>
                    <asp:Label ID="lblDatabaseType" runat="server" Text='<%# Eval("Database_Type") %>'></asp:Label>
                </ItemTemplate>
                <EditItemTemplate>
                    <asp:DropDownList ID="DropDownDataType" runat="server" >
                        <asp:ListItem Selected="True"></asp:ListItem>
                        <asp:ListItem>Oracle</asp:ListItem>
                        <asp:ListItem>SQL Server</asp:ListItem>
                     </asp:DropDownList>
                </EditItemTemplate>
                <FooterTemplate>
                     <asp:DropDownList ID="DropDownDataType" runat="server" AutoPostBack="True">
                        <asp:ListItem Selected="True"></asp:ListItem>
                        <asp:ListItem>Oracle</asp:ListItem>
                        <asp:ListItem>SQL Server</asp:ListItem>
                     </asp:DropDownList>
                     <asp:RequiredFieldValidator ID="rfvDatabaseType" runat="server" ControlToValidate="DropDownDataType" ErrorMessage="Required" ForeColor="Red"></asp:RequiredFieldValidator>
                 </FooterTemplate>
             </asp:TemplateField>
            <asp:TemplateField HeaderText="Life_Cycle_Stage" SortExpression="Life_Cycle_Stage">
                <ItemTemplate>
                    <asp:Label ID="lblLCS" runat="server" Text='<%# Eval("Life_Cycle_Stage") %>'></asp:Label>
                </ItemTemplate>
                <EditItemTemplate>
                    <asp:DropDownList ID="DropDownLCS" runat="server">
                        <asp:ListItem Selected="True"></asp:ListItem>
                        <asp:ListItem>Dev</asp:ListItem>
                        <asp:ListItem>Prod</asp:ListItem>
                        <asp:ListItem>Test</asp:ListItem>
                     </asp:DropDownList>
                </EditItemTemplate>
                <FooterTemplate>
                     <asp:DropDownList ID="DropDownLCS" runat="server">
                        <asp:ListItem Selected="True"></asp:ListItem>
                        <asp:ListItem>Dev</asp:ListItem>
                        <asp:ListItem>Prod</asp:ListItem>
                        <asp:ListItem>Test</asp:ListItem>
                     </asp:DropDownList>
                     <asp:RequiredFieldValidator ID="rfvLCS" runat="server" ControlToValidate="DropDownLCS" ErrorMessage="Required" ForeColor="Red"></asp:RequiredFieldValidator>
                 </FooterTemplate>
             </asp:TemplateField>
            <asp:TemplateField HeaderText="Restriction" SortExpression="Restriction">
                <ItemTemplate>
                    <asp:Label ID="lblRestriction" runat="server" Text='<%# Eval("Restriction") %>'></asp:Label>
                </ItemTemplate>
                <EditItemTemplate>
                    <asp:DropDownList ID="DropDownRestriction" runat="server">
                        <asp:ListItem Selected="True"></asp:ListItem>
                        <asp:ListItem>Export Controlled</asp:ListItem>
                        <asp:ListItem>SOX Critical</asp:ListItem>
                        <asp:ListItem>Standard</asp:ListItem>
                     </asp:DropDownList>
                </EditItemTemplate>
                <FooterTemplate>
                     <asp:DropDownList ID="DropDownRestriction" runat="server">
                        <asp:ListItem Selected="True"></asp:ListItem>
                        <asp:ListItem>Export Controlled</asp:ListItem>
                        <asp:ListItem>SOX Critical</asp:ListItem>
                        <asp:ListItem>Standard</asp:ListItem>
                     </asp:DropDownList>
                     <asp:RequiredFieldValidator ID="rfvRestriction" runat="server" ControlToValidate="DropDownRestriction" ErrorMessage="Required" ForeColor="Red"></asp:RequiredFieldValidator>
                 </FooterTemplate>
             </asp:TemplateField>
            <asp:TemplateField HeaderText="Business_Continuity_Plan" SortExpression="Business_Continuity_Plan">
                <ItemTemplate>
                    <asp:Label ID="lblBCP" runat="server" Text='<%# Eval("Business_Continuity_Plan") %>'></asp:Label>
                </ItemTemplate>
                <EditItemTemplate>
                    <asp:TextBox ID="txtBCP" runat="server" Text='<%# Eval("Business_Continuity_Plan") %>'></asp:TextBox>
                </EditItemTemplate>
                <FooterTemplate>
                     <asp:TextBox ID="txtBCP" runat="server"></asp:TextBox>
                     <asp:RequiredFieldValidator ID="rfvBCP" runat="server" ControlToValidate="txtBCP" ErrorMessage="Required" ForeColor="Red"></asp:RequiredFieldValidator>
                 </FooterTemplate>
             </asp:TemplateField>
            <asp:TemplateField HeaderText="Tenant_Code" SortExpression="Tenant_Code">
                <ItemTemplate>
                    <asp:Label ID="lblTenantCode" runat="server" Text='<%# Eval("Tenant_Code") %>'></asp:Label>
                </ItemTemplate>
                <EditItemTemplate>
                    <asp:TextBox ID="txtTenantCode" runat="server" Text='<%# Eval("Tenant_Code") %>'></asp:TextBox>
                </EditItemTemplate>
                <FooterTemplate>
                     <asp:TextBox ID="txtTenantCode" runat="server"></asp:TextBox>
                     <asp:RequiredFieldValidator ID="rfvTenantCode" runat="server" ControlToValidate="txtTenantCode" ErrorMessage="Required" ForeColor="Red"></asp:RequiredFieldValidator>
                 </FooterTemplate>
             </asp:TemplateField>
            <asp:CommandField ShowDeleteButton="True" ShowEditButton="True" CausesValidation="false" />
            <asp:TemplateField HeaderText="" SortExpression="Insert">                  
                <FooterTemplate>
                    <asp:LinkButton ID="lnkInsert" runat="server" Text ="Insert" OnClick="lnkInsert_Click"></asp:LinkButton>
                    </FooterTemplate>
            </asp:TemplateField>
        </Columns>
        <FooterStyle BackColor="White" ForeColor="#000066" />
        <HeaderStyle BackColor="#006699" Font-Bold="True" ForeColor="White" />
        <PagerStyle BackColor="White" ForeColor="#000066" HorizontalAlign="Left" />
        <EditRowStyle BackColor="White" />
        <RowStyle ForeColor="#000066" />
        <SelectedRowStyle BackColor="#669999" Font-Bold="True" ForeColor="White" />
        <SortedAscendingCellStyle BackColor="#F1F1F1" />
        <SortedAscendingHeaderStyle BackColor="#007DBB" />
        <SortedDescendingCellStyle BackColor="#CAC9C9" />
        <SortedDescendingHeaderStyle BackColor="#00547E" />
    </asp:GridView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:02:58.527

您正在使用`Label`而不是`Label.Text`属性。

所以你正在编辑/删除 0 行。代码应该是：

```
 SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["Database_Shared_NotebookConnectionString"].ConnectionString);
    SqlCommand cmd = new SqlCommand("delete from tblServer where ServerName = '" + servername.Text + "'", conn); 
```

和

```
 SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["Database_Shared_NotebookConnectionString"].ConnectionString);
    SqlCommand cmd = new SqlCommand("update tblServer set ClusterName = @ClusterName, Architecture = @Architecture, Database_Type = @DataType, Restriction = @Restriction, Business_Continuity_Plan = @BCP, Tenant_Code = @TenantCode where ClusterName =  '" + servername.Text + "'", conn); 
```

请注意`servername.Text`已修改。

# android - 如何在 appInventor 中用另一个文本（字符串）替换部分文本（字符串）？

> ID：13406088
> 
> 赞同：0
> 
> 时间：2012-11-15T20:58:06.370
> 
> 标签：android, app-inventor

我正在使用 appInventor 开发应用程序。如何用另一个文本字符串替换部分文本字符串。这应该很简单。如果我使用 Perl，我会这样做：

```
$my_str =~ s/abc/xyz/; 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:14:41.053

we are talking about **App Inventor**...

you could use the [replace all](http://appinventor.mit.edu/explore/content/text-blocks.html#replace%20all) block

> **replace all**
> 
> Returns a new text string obtained by replacing all occurrences of the substring with the replacement.

![enter image description here](../Images/047e7aa9da487e2b1d236a047b0a1366.png)

in case this is not what you are looking for, just take a look at the other [text blocks](http://appinventor.mit.edu/explore/content/text-blocks.html)

# c++ - 手动添加对 Lua (CryEngine) 的 IDE 支持

> ID：13406097
> 
> 赞同：1
> 
> 时间：2012-11-15T20:59:11.937
> 
> 标签：c++, autocomplete, ide, lua, cryengine

你们现在都对其他语言（例如 c++）提供了基本的 IDE 支持。你编写一个带有成员函数的类。如果尝试在您的代码中使用它并按下 ctrl + 空格，您将在菜单中查看所有这些成员函数。

现在 CryEngine 有一个 Lua api（scriptbinds？），但没有 IDE 支持它。

是否可以使用 cryengine API 提供选择的 IDE 并获得完整的 IDE 支持？我从来没有做过类似的事情，不知道我应该从哪里开始，我希望你能给我一些指导。

更新：

也许我应该添加我的想法。例如，如果您有一个 java IDE 并且包含了一个外部 jar 文件，您将可以访问其内容并且 IDE 将支持它（自动完成等）。不应该用 cryengine 和 lua 做同样的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:09:36.733

几乎每个 IDE 都提供了一些方法来合并自定义 API。例如，Eclipse (Koneki LDT) 提供了一种添加自定义 API 的方法（如其[用户帮助](http://wiki.eclipse.org/Koneki/LDT/Technical_Discussions/User_Assistance)文档中所述）。我一直在研究的[ZeroBrane Studio IDE还提供了一种合并自定义 API 的方法（](http://studio.zerobrane.com/) [IDE 附带了十几个](https://github.com/pkulchenko/ZeroBraneStudio/tree/master/api/lua)用于各种引擎的 API）。

# java - Android中的java JSON和字符串

> ID：13406104
> 
> 赞同：0
> 
> 时间：2012-11-15T20:59:35.850
> 
> 标签：java, android, json

我正在通过android中的php查询数据库。这是我的相关代码

```
String result = null;
InputStream is = null;
StringBuilder sb = null;

is = entity.getContent();

BufferedReader reader = new BufferedReader(new InputStreamReader(is,"UTF-8"));
sb = new StringBuilder();
String line = null;
while ((line = reader.readLine()) != null)
{
   sb.append(line + "\n");
}
is.close();
result = sb.toString();    
JSONArray jArray = new JSONArray(result); 
```

这是我要解析的链接和返回的数据。

[https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=-33.8670522%2C151.1957362&radius=500&types=food&name=harbour&sensor=false&key=AIzaSyCX8PnG_dSJvCMmQPN1Zjbpi_RcokyiOss](https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=-33.8670522%2C151.1957362&radius=500&types=food&name=harbour&sensor=false&key=AIzaSyCX8PnG_dSJvCMmQPN1Zjbpi_RcokyiOss)

一切都很顺利，直到最后一个声明。当我尝试打印出结果的长度时，它的长度是正确的。但是，如果我尝试使用打印结果

```
Log.e ("ERROR", result); 
```

和 adb logcat 查看输出，它被截断了。因此，如果将截断的字符串结果传递给 JSONArray，它肯定会崩溃。它总是在“Pyrmont Bay Wh”之后被截断，它比返回值低了大约 4048 个字符。所以猜我的问题是为什么变量“结果”被截断。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T04:06:25.743

Logcat 截断长字符串。

```
$ adb logcat -g
/dev/log/main: ring buffer is 64Kb (63Kb consumed), max entry is 5120b, max payload is 4076b 
```

[您可以做的一件事是按照此 SO 帖子](https://stackoverflow.com/a/7606118/1309304)中的建议将字符串拆分为可打印的块：

```
 int maxLogSize = 1000;
    for(int i = 0; i <= veryLongString.length() / maxLogSize; i++) {
        int start = i * maxLogSize;
        int end = (i+1) * maxLogSize;
        end = end > veryLongString.length() ? veryLongString.length() : end;
        Log.v(TAG, veryLongString.substring(start, end));
    } 
```

# python - 允许在方法签名中使用标记“类”作为命名参数

> ID：13406107
> 
> 赞同：2
> 
> 时间：2012-11-15T20:59:41.143
> 
> 标签：python, python-2.7, flask

我有一个 python 文件，其中填充了`h1`和`img`和之类的函数，`strong`用于样式文本。这些函数中的每一个定义如下：

```
def _wrapTag(tag, text, **attributes):
    out = _createTag(tag, **attributes)
    out += text
    out += "</" + tag + ">"
    return out

def _createTag(tag, **attributes):
    out = "<" + tag
    if attributes:
        for attr, value in attributes:
            out += " " + attr + "=\"" + value + "\""
    out += ">"
    return out

def h2(text, **attributes):
    return _wrapTag("h2", text, **attributes) 
```

在理想的世界中，要`div`使用 class创建一个，但`modal`我会调用它是一个受限制的关键字。有没有办法绕过这个而不添加特殊情况？`div(content, class="modal")``class``_createTag`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T21:06:56.380

[PEP 8](http://www.python.org/dev/peps/pep-0008/)标准处理方法是添加尾随下划线：

*   single_trailing_underscore_：按惯例使用，以避免与 Python 关键字冲突，例如

`Tkinter.Toplevel(master, class_='ClassName')`

这是一种常见的解决方法，不会让任何人感到惊讶。您可以在您的代码中实现它，例如：

```
def _createTag(tag, **attributes):
    out = "<" + tag
    if attributes:
        for attr, value in attributes.items():
            out += " " + attr.rstrip('_') + "=\"" + value + "\""
    out += ">"
    return out 
```

以便它自动从任何和所有属性中删除额外的下划线。然后你可以打电话：

```
>>> h2('contents', class_='myh2tag', id_='contenttag')
'<h2 class="myh2tag" id="contenttag">contents</h2>' 
```

并解决两个单独的 Python 命名空间冲突，而不将其中任何一个作为特殊情况处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:01:12.887

不，Python 关键字不能用作标识符，仅此而已。在这类事情中，通常的解决方案是`class_`用作名称。它需要特殊的外壳，但没有办法绕过它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T21:35:40.927

```
_createTag(tag, **{"class": 1}) 
```

使用此语法，您可以将任何内容传递给 **attributes。无需更改功能中的代码。

# python - x 时间范围内的时间（24 小时时间格式）

> ID：13406109
> 
> 赞同：0
> 
> 时间：2012-11-15T20:59:49.207
> 
> 标签：python, time, frame, strftime

获取给定时间范围内的时间的最佳实践。

**当前时间**：22:00
**时间范围**（轮班开始、结束时间）：

```
00:00 - 08:00
04:00 - 12:00
08:00 - 16:00
12:00 - 20:00
16:00 - 00:00
20:00 - 04:00 
```

使用逻辑：

```
if currentHour >= startHour and currentHour <= endHour:
    ... 
```

真的不起作用，因为如果时间是 22:00，它不会少于 04:00。使用 OR 也将不起作用，因为那时 22 将超过 00:00，这是不对的。

啊，我不知道是缺乏咖啡因还是什么，但我就是无法理解它......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:06:11.483

你必须记住，如果 endHour < startHour，它实际上是在不同的一天，即。比它说的晚 24 小时。同样，如果一个小时在这个范围内，它可能是在任何一天，所以如果它是 < startHour，它可能是在第二天。

```
if currentHour < startHour:
   currentHour += 24
if endHour < startHour:
   endHour += 24

if currentHour >= startHour and currentHour <= endHour:
   //...code 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:03:12.113

如果 00:00 是时间范围的结束，则设为 24:00。这将解决使您的`if`陈述以预期的方式工作。

**我的坏**：这样做

`if currentHour >= startHour and currentHour <= endHour or currentHour <= startHour and currentHour >= endHour :`

编辑：这会生成以下内容，

```
print cur, start, end, logic1, logic2
23 8 0 False False
23 20 12 False False
23 0 20 False False
23 12 4 False False
23 8 16 False False
23 16 8 False False 
```

# javascript - 创建弹出窗口

> ID：13406113
> 
> 赞同：-1
> 
> 时间：2012-11-15T20:59:53.977
> 
> 标签：javascript, jquery, asp.net-mvc-3, jquery-ui

我有一个从发布的表单返回的结果列表。结果是标准的联系信息：姓名、地址、城市、州、邮编等。有一个隐藏字段是数据库的主键。

用户可以选择浏览此人员表并单击一行以获取更多详细信息。我希望这是一个弹出窗口，但无法弄清楚。

这是我尝试过的。

```
$(document).ready(function () {

   $('tr.myRow').click(function () {
     var test = $(this).find('td.hidden').html();
     $.ajax(
     {
        url: '@Url.Action("Details", "Record")',
        type: 'POST',
        data: { recordID: test }
     });
   });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:04:53.933

正如评论中提到的，您只需`success`在代码中添加一个函数并在那里弹出窗口。

我只使用了一个存根，以防你想使用模态或任何你喜欢的东西。

```
$(document).ready(function () {

   $('tr.myRow').click(function () {
     var test = $(this).find('td.hidden').html();
     $.ajax(
     {
        url: '@Url.Action("Details", "Record")',
        type: 'POST',
        data: { recordID: test },
        success: function(data) {
            //popup code here
        }
     });
   });
}); 
```

# maven - 来自命令行的具有分类器快照依赖项的 Maven 发布插件

> ID：13406118
> 
> 赞同：5
> 
> 时间：2012-11-15T21:00:05.287
> 
> 标签：maven, command-line, maven-release-plugin

我正在尝试以批处理模式从命令行运行 maven 发布插件，用于一个多模块项目，该项目具有使用分类器部署到 maven 存储库的依赖项。

release:prepare 在不处于批处理模式时可以正常工作，并提示所有未解决的快照依赖项，包括带有分类器的快照依赖项，并且发布成功完成。

当我查看 release.properties 文件时，我看到...

**常规依赖项**标识为

```
project.rel.groupIdXYZ:artifactIdXYZ=2.0.3.4
project.dev.groupIdXYZ:artifactIdXYZ=2.0.3.4-SNAPSHOT 
```

**分类器依赖项**标识为

```
dependency.groupIdABC:artifactIdABC.release=2.0.3.4
dependency.groupIdABC:artifactIdABC.development=2.0.3.4-SNAPSHOT 
```

没有实际的分类器 ID。

现在我通过命令行尝试它，例如...

```
mvn --batch-mode -P release,nexus -Dtag=rm2.0.3.4 -Dproject.rel.groupIdXYZ:artifactIdXYZ=2.0.3.4 -Dproject.dev.groupIdXYZ:artifactIdXYZ=2.0.3.4-SNAPSHOT -Ddependency.groupIdABC:artifactIdABC.development=2.0.3.4-SNAPSHOT -Ddependency.groupIdABC:artifactIdABC.release=2.0.3.4 -DreleaseVersion=2.0.3.4 -DdevelopmentVersion=2.0.3.4-SNAPSHOT -DdryRun=true release:prepare 
```

并得到

```
Can't release project due to non released dependencies :
groupIdABC:artifactIdABC:jar:classifierIdABC:2.0.3.3-SNAPSHOT:compile 
```

我已经验证分类器工件在我的本地 maven 存储库中，我们的公司中央 maven 存储库中。我尝试将分类器工件指定为

```
-Dproject.rel.groupIdABC:artifactIdABC:jar:classifierIdABC=2.0.3.4 
```

仍然是同样的错误。

任何能够从命令行运行它的指针将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-11T22:56:28.863

maven-release-plugin 要求所有依赖版本都是非 SNAPSHOT ......原因很明显。必须是最终版本。

如果您知道您的依赖项确实有可用的非 SNAPSHOT 版本，（您之前发布过它们），那么您可以使用 versions-maven-plugin 自动更新 pom.xml

```
mvn versions:use-latest-versions -DallowSnapshots=false -Dincludes=com.my.* 
```

并防止发布插件抱怨对 pom.xml 的未提交更改...

```
 mvn release:prepare ... -DcheckModificationExcludeList=pom.xml 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-30T10:48:32.820

如果将`allowTimestampedSnapshots`属性设置为`true`怎么办？它仍然抛出错误吗？

# types - 是否可以检查 Poly ML 中的值是否具有特定类型？

> ID：13406121
> 
> 赞同：0
> 
> 时间：2012-11-15T21:00:20.263
> 
> 标签：types, boolean, ml, polyml

在 Poly ML 中，如果 x 的类型为 'a，您将如何编写一个返回“true”的函数，如果不是，则返回 false？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T10:58:16.270

我可能误解了您的问题，但听起来您错过了[静态类型语言](https://stackoverflow.com/questions/2690544/what-is-the-difference-between-a-strongly-typed-language-and-a-statically-typed)的全部要点。

这意味着您不能使用其他类型的参数调用函数，而不是声明的类型。解释器/编译器将拒绝其他任何内容。

一个可以满足您需求的功能是：

```
> fun foo _ = true
val foo = fn : 'a -> bool 
```

# html - 用户代理的奇数开关

> ID：13406123
> 
> 赞同：1
> 
> 时间：2012-11-15T21:00:26.907
> 
> 标签：html, windows, internet-explorer, webserver, user-agent

我正在阅读我的学习管理系统的日志。我发现两条看起来很奇怪的线。

```
2012-11-14 16:10:31 0.0.0.0 "<PERSON NAME>/<CITY>/<COMPANY>" do.<ADDRESS>.ru - GET /pics/mm_item_sel.gif - - - - - "Mozilla/4.0+(compatible;+MSIE+8.0;+Windows+NT+5.1;+Trident/4.0;+Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1)+;+.NET+CLR+2.0.50727;+.NET+CLR+3.0.4506.2152;+.NET+CLR+3.5.30729;+InfoPath.2)"

2012-11-14 16:10:32 0.0.0.0 "<PERSON NAME>/<CITY>/<COMPANY>" do.<ADDRESS>.ru - GET /view_doc.html?doc_id=5300698214580765893&object_id=5808787579917258666&course_id=5766800087662725234&mode=learning_proc - - - - - "Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+5.1;+Trident/4.0;+Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+SV1)+;+.NET+CLR+2.0.50727;+.NET+CLR+3.0.4506.2152;+.NET+CLR+3.5.30729;+InfoPath.2)" 
```

我已经删除了名字和姓氏，但是当来自同一计算机的同一帐户的同一个人与 LMS 交谈时会生成这两行。奇怪的是，用户代理的描述看起来完全一样，除了第一种情况是 MSIE 8.0 和第二种情况是 MSIE 7.0。

怎么可能？这是某种错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:03:20.467

访问者很可能使用的是 IE8 并打开了兼容模式，这会将用户代理更改为 IE7。用户代理的`Trident`部分仅由 IE8+ 发送，这会将其泄露。

这里详细讨论了[如何区分 IE7 和以 IE7 兼容模式运行的浏览器](https://stackoverflow.com/questions/10213639/differentiate-ie7-browser-and-browser-in-ie7-compatibility-mode)。

# node.js - Node.js：无法让 socket.io 与 express 一起工作，在脚本文件上得到 404

> ID：13406124
> 
> 赞同：2
> 
> 时间：2012-11-15T21:00:30.380
> 
> 标签：node.js, express, socket.io

我正在尝试使用 express 为与 socket.io 通信的 express 提供静态页面。我不断地遇到问题。我做了很多事情，用谷歌搜索了很多次，我不敢相信我还没有找到具体问题的答案。我一直跑到向您展示服务器或向您展示客户端的地方，而不是与它通信的其他地方。或两者兼而有之，但不是快递。当我将 express 加入混合时，我开始得到 404，我移动我的 socket.io 客户端脚本，但似乎仍然无法让它工作。这就是我现在所处的位置，尽管这是我的第 20 个配置。

服务器：

```
var express = require('express');
var app = express();
var http = require('http');
var server = http.createServer(app);
var io = require('socket.io').listen(server);

app.configure(function () {
    app.use(express.static('html'));
});

app.listen(8080);

io.sockets.on('connection', function (socket) {
    console.log('A socket connected!');
}); 
```

客户：

```
<script src="/socket.io/socket.io.js"></script>
<script>
  var socket = io.connect('http://localhost:8080');
  socket.send('testing');
</script> 
```

我尝试将 src 更改为 /html/socket.io.js（并将所有必要的文件从 dist 目录复制到 /html），尝试在 html 目录中创建脚本目录，尝试链接到 socket.io 的 cdn，然后我继续获得404。我知道这是我搞砸的愚蠢和简单的事情，我只是无法为我的生活弄明白。谢谢！

编辑：我现在要做的就是提供 index.html 页面并在看到连接时打印到服务器控制台。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-15T21:45:01.517

看看[这里](http://socket.io/#how-to-use)的例子。我通过更改`app.listen`为`server.listen`. 我认为socket.io设置的路由是http服务器特有的，没有使用express路由机制。

# backbone.js - 将项目添加到集合后主干和车把呈现问题

> ID：13406126
> 
> 赞同：1
> 
> 时间：2012-11-15T21:00:45.830
> 
> 标签：backbone.js, handlebars.js

我是主干和handlebars.js 的新手。我正在尝试以编程方式将新项目添加到集合中，并且我希望主干使用 Render 来呈现集合。

我究竟做错了什么？

```
var Item = Backbone.Model.extend({
    defaults: {
    }
});

var List = Backbone.Collection.extend({
    model: Item
});

var ListView = Backbone.View.extend({
    el: $('BODY'), // el attaches to existing element
    initialize: function () {
        _.bindAll(this, 'render'); // every function that uses 'this' as the current object should be in here

        this.collection = new List();
        this.render();
    },
    render: function () {
        var template = Handlebars.compile($('#screenshot_template').html());
        $(this.el).html(template({
            row: this.collection
        }));
        return this;
    }

});

var listView = new ListView();
window.screenshots = listView;
window.screenshots.collection.add({
    myurl: 'http://placehold.it/350x150'
}); 
```

我的车把模板如下所示：

```
<script id="screenshot_template" type="text/x-handlebars-template">
    {{#each row}}
    <div><img src="{{this.myurl}}"></div>
    {{/each }}
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:06:46.320

向您的视图添加一个侦听器，以便它知道集合何时触发 add 事件 - 通常在您的视图的初始化函数中完成：

```
this.collection.on('add', this.render); 
```

显然，您需要在实例化集合后添加它。

# opengl - 如何让 Nifty GUI 使用我的坐标系？

> ID：13406131
> 
> 赞同：1
> 
> 时间：2012-11-15T21:01:11.860
> 
> 标签：opengl, lwjgl, nifty-gui

由于各种原因，我喜欢让 openGL 使用像素以外的坐标，这可以通过以下方式轻松设置：

```
Display.setDisplayMode(new DisplayMode(800, 600));
GLU.gluOrtho2D(0f,32f,0f,24f); 
```

然而，现在我已经开始尝试将 Nifty GUI 集成到我的应用程序中，这种坐标比例正在引起问题。也就是说，Nifty 似乎认为 openGL 使用像素作为单位，因此将一切渲染为巨大。有没有什么办法解决这一问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:17:27.700

为什么不只是按照 NiftyGUI 想要的方式（像素坐标）做事，而*只是*在渲染 NiftyGUI 时。这表示：

```
gl.glMatrixMode(gl.GL_PROJECTION_MATRIX);
GLU.gluOrtho2D(0f,32f,0f,24f);
//Render my stuff
gl.glMatrixMode(gl.GL_PROJECTION_MATRIX);
gl.glLoadIdentity();
GLU.gluOrtho2D(0f,width,0f,height);
//Render with NiftyGUI. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:16:03.363

You made the classic OpenGL newbie mistake: One time state setting.

OpenGL is not initialized. You re-set every state as you go and as you need it. Do in your case it's completely in order to set the *projection* matrix to a pixel mapping ortho projection whenever needed and to something else when using Nifty.

# java - 用于简单乒乓球游戏的人工智能/电脑播放器

> ID：13406133
> 
> 赞同：0
> 
> 时间：2012-11-15T21:01:18.003
> 
> 标签：java

好的，我刚写完我的乒乓球游戏，但现在我想要一个 AI 供玩家对抗。我试过这样做，当 NPC padel 的位置超过球的 Y 坐标时，它会移动到正确的区域以尝试阻挡球。这是我的 padel 类的代码：

```
 import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;

public class Padel implements KeyListener{
    private Ball ball = new Ball();
    private boolean LeftPlayerUp=false;
    private boolean LeftPlayerDown=false;
    private boolean RightPlayerUp=false;
    private boolean RightPlayerDown=false;
    public int RightLocation=200;
    public int LeftLocation=200;

    public void keyPressed(KeyEvent e){
        int KeyPressed = e.getKeyCode();

        if (KeyPressed== KeyEvent.VK_W){
            LeftPlayerUp=true;
        }
        else if (KeyPressed==KeyEvent.VK_S){
            LeftPlayerDown=true;
        }
    }
    public void keyReleased(KeyEvent e){
        int KeyReleased = e.getKeyCode();

        if (KeyReleased== KeyEvent.VK_W){
            LeftPlayerUp=false;
        }
        else if (KeyReleased==KeyEvent.VK_S){
            LeftPlayerDown=false;
        }
    }
    public void ShouldLeftMove(){
        if(LeftPlayerUp==true){
            if(LeftLocation==50){}
            else{
                LeftLocation-=2;
            }
        }
        else if(LeftPlayerDown==true){
            if(LeftLocation==Main.Height-190){}
            else{
            LeftLocation+=2;
            }
        }
    }   
    public void ShouldRightMove(){
        if(ball.BallLocationY>=RightLocation){
            RightPlayerUp=false;
            RightPlayerDown=true;
        }else{
            RightPlayerUp=true;
            RightPlayerDown=false;
        }
        if(RightPlayerUp==true){
            if(RightLocation==50){}
            else{
            RightLocation-=2;
            }
        }
        else if(RightPlayerDown==true){
            if(RightLocation==Main.Height-190){}
            else{
            RightLocation+=2;
            }
        }
    }   
    //This just needs to be here :P
    public void keyTyped(KeyEvent e) {}
} 
```

使用此代码，padel 将移动到右侧屏幕下方约 2/3 处，然后停止移动，spaz 消失。我究竟做错了什么？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:20:20.127

我还没有发现您的确切问题，并且只有一小段代码我无法运行它并查看问题，但我确实有一些建议给您。

首先，在您检查限制的任何地方，您都要检查确切的条件。如果该位置以某种方式被设置为奇数值，或者以某种方式超出限制，您的限制代码将无法处理它。我建议，而不是

```
 if(LeftPlayerUp==true){
        if(LeftLocation==50){}
        else{
            LeftLocation-=2;
        }
    } 
```

你应该使用

```
 if (LeftPlayerUp) {
        if (LeftLocation <= 50) {
            LeftLocation = 50;
        }
        else {
            LeftLocation-=2;
        }
    } 
```

这样，如果 LeftLocation 得到了一个被破坏的疯狂值，它将被简单地纠正。在您检查限制的任何地方都使用此模式。

我的另一点建议是，您的计算机播放器算法非常简单。它没有考虑球的移动方向。如果球在右桨上方，但向下移动，也许右桨不应该移动......现在，你不希望电脑玩家一直完美地玩，因为这对玩家来说不会很有趣只能输的人；但你应该从一个完美的电脑播放器开始。最好的方法是计算球将穿过右桨线的位置。您的游戏知道球的当前位置，以及球向右和向上/向下移动的速度，因此您的游戏可以预测球的去向；您甚至可以模拟球的整个轨迹，包括反弹，并准确计算球的去向。然后让电脑玩家将桨移向那个位置。一旦你有完美的计算机 AI 工作，然后添加随机错误，或者简化它（比如去掉处理反弹的代码；也许打败 AI 的方法总是把球从墙上弹下来！）。

祝好运并玩得开心点。

# java - Netty 解析文件流？

> ID：13406146
> 
> 赞同：0
> 
> 时间：2012-11-15T21:02:30.197
> 
> 标签：java, netty, java-7

我要求同一主机上的两个特定进程通过仅附加文件进行通信。一个过程生产，另一个过程消耗。在进入第二个进程（至少是磁盘的操作系统缓存）之前，对象流**必须命中磁盘。**

我想使用 Netty 来解析文件中的对象流。有没有办法将 Netty 附加到文件中？

出于延迟考虑，**我宁愿它不涉及计时器。**拦截没问题。

（如果这有什么不同，我正在使用 JDK-7）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T20:48:39.637

Java 7 中有一些新特性可能对您有用：

*   通过将[APPEND](http://docs.oracle.com/javase/7/docs/api/java/nio/file/StandardOpenOption.html#APPEND)作为参数传递给 [Files.newOutputStream(...)](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#newOutputStream%28java.nio.file.Path,%20java.nio.file.OpenOption...%29)您可以写入现有文件。
*   另一个新增功能是[WatchService](http://docs.oracle.com/javase/7/docs/api/java/nio/file/WatchService.html)，可用于侦听库中的事件更改，如[Oracle 的 Java 教程](http://docs.oracle.com/javase/tutorial/essential/io/notification.html)中所述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T20:28:14.637

Netty 用于套接字。如果您需要使用文件，我想 Apache Camel 更合适：

*   [http://camel.apache.org/](http://camel.apache.org/)
*   [http://camel.apache.org/file2.html](http://camel.apache.org/file2.html)
*   [http://camel.apache.org/stream.html](http://camel.apache.org/stream.html)

# bash - tee 没有把输出放到文件中

> ID：13406147
> 
> 赞同：0
> 
> 时间：2012-11-15T21:02:37.140
> 
> 标签：bash, ubuntu, selenium-grid, tee

我试图使用 php 文件来运行测试并获得结果。PHP中的内容如下所示：

```
<html>
<body style="background-color:#CCCCFF;">
<h1>Result of SimplePolicyTest:</h1>
<?php
$filename='results_'.date('Y-m-d_H-i-s').'_simple-policy.php';
$path='/var/www/qa/automation/results/';
$destination=$path.$filename;
$cmd='/var/www/selenium/projects/QA\ Automation/grid/./SimplePolicyTest | tee -a '.$destination;
echo $cmd;
system($cmd);
?>
</body>
</html> 
```

bash 文件中的内容是启动硒测试。但结果是我在页面上完成测试后得到了测试结果。但是，在应有的位置找不到所需的文件。我现在也在起诉系统。有什么方法可以使寻呼机实时输出？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T06:23:22.977

几点建议：

1.  您想在主文件中包含输出结果 php 文件吗？
2.  你可以看看php 中的[popen](http://php.net/manual/en/function.popen.php)函数。该功能允许您直接捕获命令的标准输出。无需将`tee`其添加到另一个文件然后包含它。
3.  如果您可以访问系统上的 bash，请尝试直接在 bash 上运行该命令，以验证它是否确实输出了某些内容。
4.  尝试在本地安装 php 并使用更简单的命令进行调试，看看是否`|`可以在`system`.

# java - 将数据从 Java RESTful 服务器推送到 Android 手机以获取通知

> ID：13406149
> 
> 赞同：1
> 
> 时间：2012-11-15T21:02:42.050
> 
> 标签：java, android, rest, notifications, push

我一直在研究从服务器获取电话推送通知的最简单方法是什么，到目前为止，我发现了 C2DM、TCP 套接字连接和 SMS 消息传递。

我的主要问题是告诉我的 Java RESTful 服务连接到 mysql 数据库时哪个最简单。基本上，我的意图是使用传感器在每次触发时将数据写入我的数据库，一旦将这些数据放入数据库，我希望将其作为推送通知发送到我的 Android 手机。

如果有人能指出我正确的方向，那就太好了，我有一个几周后要完成的项目，所以我需要从一个我知道可行的方向开始，而不是通过反复试验来测试这些技术。我也在为 JellyBean 开发。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:14:52.763

那么你最好的选择当然是 GCM（新的和改进的 C2DM）。[您可以在此处](http://developer.android.com/guide/google/gcm/gs.html)找到有关开始使用您的 Android 项目的详细信息

作为您的服务器实现，以下是 google 文档的一些有用部分： [Server API stuff](http://developer.android.com/guide/google/gcm/gcm.html#send-msg) and [Sample Server Implementation](http://developer.android.com/guide/google/gcm/demo.html#server-setup)和 [A PHP Example](https://stackoverflow.com/questions/11242743/gcm-with-php-google-cloud-messaging)

根据您的服务器端语言是什么，这可能会有所帮助。如果不让我知道，我可以举更多例子

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:08:38.093

我总是使用 C2DM，我对此很满意。由于 c2dm 集成在 android 中，我认为您无法找到基于 android 的解决方案，其电池消耗和发送字节数更少。它也很容易集成。该解决方案的缺点是，它仅适用于 android，但这不应该是重点，因为对于其他平台还有其他好的和简单的解决方案，并且实现开销很小，因为 c2dm 解决方案很容易集成。

# c# - 字符串未被识别为使用 C# 的有效日期时间

> ID：13406153
> 
> 赞同：1
> 
> 时间：2012-11-15T21:03:03.463
> 
> 标签：c#, asp.net

我已经在线尝试了所有可能的解决方案，但无法弄清楚为什么我仍然收到此错误“字符串未被识别为有效日期时间”有趣的是我正在转换 2 个日期时间，一个是我的 gridview 中的单元格 3 和另一个是单元格 7，但单元格 3 工作正常，但单元格 7 不想转换，它们都是相同的数据类型！！。我从我的 sql server 表中提取这些数据，数据类型是 varchar，但格式应该是 mm/dd/yyyy。
我已经尝试过这种方法，但没有奏效：

```
foreach (GridViewRow gr in GridView1.Rows)
        {

            CheckBox cb = (CheckBox)gr.FindControl("chkItem");
            if (cb.Checked)
            {

                DateTime ExpectedSubDate = DateTime.Parse(gr.Cells[3].Text);
                DateTime strTargetDate = DateTime.ParseExact(gr.Cells[7].Text, "MM/DD/YYYY HH:MM:SS TT", System.Globalization.CultureInfo.InvariantCulture); 
```

我也尝试过这种方法，但也没有用

```
DateTime strTargetDate = DateTime.Parse(gr.Cells[7].Text); 
```

我也尝试过这种方式，但也没有用：

```
DateTime strTargetDate = DateTime.ParseExact(gr.Cells[7].Text, "MM/DD/YYYY", System.Globalization.CultureInfo.InvariantCulture); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T21:07:05.880

格式字符串区分大小写，否则它无法知道您希望它在哪里解析为月或分钟。

对于日期和时间，例如`"11/15/2012 02:26:35 PM"`：

```
DateTime strTargetDate = DateTime.ParseExact(gr.Cells[7].Text, "MM/dd/yyyy hh:mm:ss tt", System.Globalization.CultureInfo.InvariantCulture); 
```

只是一个日期，例如`"11/15/2012"`：

```
DateTime strTargetDate = DateTime.ParseExact(gr.Cells[7].Text, "MM/dd/yyyy", System.Globalization.CultureInfo.InvariantCulture); 
```

参考：[自定义日期和时间格式字符串](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:08:26.470

您的格式字符串不正确。格式字符串区分大小写。

mm = 分钟
dd = 天
MM = 月
yyyy = 年

应该是这样的：

```
CultureInfo usa = CultureInfo.GetCultureInfo("en-US");
DateTime strTargetDate = DateTime.ParseExact(gr.Cells[7].Text, "MM/dd/yyyy", usa ); 
```

您仍然可以使用 InvariantCulture，但 mm/dd/yyyy 日期格式确实是美国独有的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T21:11:27.813

看看这里的例子

[http://msdn.microsoft.com/en-us/library/ey1cdcx8.aspx](http://msdn.microsoft.com/en-us/library/ey1cdcx8.aspx)

[http://msdn.microsoft.com/en-us/library/kc8s65zs.aspx](http://msdn.microsoft.com/en-us/library/kc8s65zs.aspx)

一个直接的字符串解析是自找麻烦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T21:39:25.410

您的 GridView 中是否有任何隐藏列？如果是这样，您的列索引可能会关闭，并且您可能会提取错误的数据。尝试在代码中的失败日期解析处设置断点并检查`gr.Cells[7].Text`立即窗口中的值，以确保提取正确的文本。

# javascript - 如何根据视口大小和字体在页面中划分文本

> ID：13406159
> 
> 赞同：2
> 
> 时间：2012-11-15T21:03:20.960
> 
> 标签：javascript, jquery, css, fonts

这有点棘手。基本上，我有一个水平滑块，用于浏览通过 Ajax 实时填充的页面（预加载了节流器、静默预加载等，因此一切都很好）。

像 Facebook 广告牌一样工作，如果有人记得 FB 黑客杯，但略有不同。所以我根据视口计算块的大小，得到 boxSizeX 和 boxSizeY。

现在服务器提供 X 个单词的文本。渲染使用 13px 字体大小的等宽字体。和 1 em 的行高，所以又是 13 px。基本上，我现在正试图将文本块分成完全适合 boxSizeX 和 boxSizeY 的块，而不会将单词分成两半，在最后两个单词之前结束句子（非常欢迎更多关于我应该注意的建议，因为我不想错过任何东西）。

整个计算在 JS 中完成，尽管 boxSize 可以在对文本进行初始调用时提供给服务器，因此密集计算在服务器端完成。你最好怎么做？我几乎不知道要注意什么、浏览器渲染问题、字体等。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-15T13:44:14.837

如果我正确理解您的问题，对于等宽字体，将字符串分成相等的两半并检查损坏的单词将是第一步——对吗？

这是一个基本的工作检查，用于将字符串分成两半，将拆分的单词添加到前半部分，从后半部分删除它们，从拆分字符串的后半部分删除任何前导空格，并以两个字符串返回结果：

```
let str = "Works like Facebook Billboarding, if anyone remembers the FB hacker cup, yet slightly different. So I compute the size of the block based on the viewport and I get boxSizeX and boxSizeY.";
let halfway = Math.round(str.length/2);
let first_half = str.slice(0, halfway);
let second_half = str.slice(halfway);
let broken_word = second_half.indexOf(" ");
let orphan = (second_half.slice(0, broken_word));
first_half = first_half.concat(orphan);
second_half = second_half.slice(broken_word).trim()
console.log(first_half + " --halfway split here-- " + second_half) 
```

您需要检查结尾`first_half`或开头`second_half`是否是空格，在这种情况下没有断字，因此您只需`broken_word`在该测试中运行。

再做一些工作，您可以使用正则表达式并反转字符串，在字符串前半部分的最后一个句号之前获取两个单词：

```
const backwards = first_half.split("").reverse().join("");
z = (backwards.match(/(\.\S+\s\S+)/)[0]);
end_sentence = z.split("").reverse().join("");
console.log(end_sentence); 
```

从那里您可以`backwards.indexOf(".")`在 end_sentence 结束后使用或拆分 first_half，然后对字符串的前半部分进行切片和连接以获得所需的结果。

# authentication - 带有身份验证请求的 nginx webdav 服务器

> ID：13406166
> 
> 赞同：-1
> 
> 时间：2012-11-15T21:03:53.467
> 
> 标签：authentication, nginx, webdav

我的 nginx.conf：

```
location ~ ^/api/(.*)$ {
  alias /home/username/apidav/$remote_user/$1;

  client_body_temp_path       /var/www/path/;
  client_max_body_size        50m;
  dav_methods                 PUT DELETE MKCOL;# COPY MOVE;
  create_full_put_path        on;
  dav_access                  user:rw  group:rw  all:r;
  dav_ext_methods             PROPFIND OPTIONS;
  auth_request /api_auth;
}

location /api_auth {
  internal;
  proxy_pass http://www.domain.ru/accounts/api_auth/;
  proxy_pass_request_body off;
  proxy_set_header Content-Length "";
  proxy_set_header X-Original-URI $request_uri;
} 
```

curl -T test.txt 'http://gert:passwd@www.domain.ru/api/' curl: (56) Recv failure: Connection reset by peer？

为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:50:20.067

问题已解决：[https](https://serverfault.com/questions/449195/nginx-webdav-server-with-auth-request) ://serverfault.com/questions/449195/nginx-webdav-server-with-auth-request 。感[谢马克西姆杜宁](https://serverfault.com/users/132187/maxim-dounin)。

# mysql - 选择相对于现在的日期（）

> ID：13406168
> 
> 赞同：6
> 
> 时间：2012-11-15T21:03:57.243
> 
> 标签：mysql, sql

我正在尝试查找结束日期在现在 30 天内的所有结果。我正在尝试的查询是：

```
SELECT * FROM title WHERE sales_end-date < now() + 30 days 
```

我将如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-15T21:06:09.737

采用`INTERVAL`

```
SELECT * 
  FROM title 
 WHERE sales_end-date < DATE_ADD(CURRENT_TIMESTAMP, INTERVAL 30 day) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-24T01:08:00.673

为了准确回答您的问题，现在使用该功能，您唯一缺少的就是 INTERVAL 一词！（并从天中删除 s）

```
SELECT * 
FROM title 
WHERE sales_end-date < now() + INTERVAL 30 DAY; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-11T17:43:20.683

对于那些在 SnowFlake 上使用 SQL 的人来说，关键部分是：

```
WHERE sales_end-date < dateadd('day', 30, current_timestamp()) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T21:10:57.007

试试这个：

```
SELECT * FROM title WHERE sales_end-date < (TO_DAYS(NOW() +30)) 
```

# php - 如何在 wordpress 管理员中禁用 1/2 列屏幕布局单选按钮

> ID：13406169
> 
> 赞同：2
> 
> 时间：2012-11-15T21:04:25.640
> 
> 标签：php, wordpress

我想隐藏出现在 wordpress 管理员自定义页面上的 1/2 列单选按钮，我应该怎么做？（好的，我可以用 javascript 来做，我要求的是原生 wordpress 解决方案）

这就是我说的收音机

![在此处输入图像描述](../Images/29494da7efefd9b43750eba6929f1b69.png)

这是页面的标记

```
<div class="wrap">

    <?php screen_icon(); ?>

    <h2><?php echo $title; ?></h2>

    <div id="poststuff">

        <form method="post" action="" enctype="multipart/form-data">
            <?php wp_nonce_field( 'closedpostboxes', 'closedpostboxesnonce', false ); ?>
            <?php wp_nonce_field( 'meta-box-order', 'meta-box-order-nonce', false ); ?>

            <div >
                <div class="column-1-ai1ec timely">
                    <?php do_meta_boxes( $settings_page, 'left', null ); ?>
                    <?php
                        // Show the submit button only in the settings page and not in the Feeds page.
                        if ( $calendar_settings ) {
                            submit_button( esc_attr__( 'Update Settings', AI1EC_PLUGIN_NAME ), 'primary', 'ai1ec_save_settings' );
                        }
                    ?>
                </div>
                <div class="column-2-ai1ec timely"><?php do_meta_boxes( $settings_page, 'right', null ); ?></div>
            </div>
        </form>

    </div><!-- #poststuff --> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:21:19.273

过滤器！即，对于`screen_layout_columns`和`get_user_option_screen_layout_post`。一定要喜欢那些记录不充分的钩子。

试试这个：

```
function force_single_column_layout( $columns ) {
    $columns['post'] = 1;
    return $columns;
}
add_filter( 'screen_layout_columns', 'force_single_column_layout' );

function force_single_column_layout_post() {
    return 1;
}
add_filter( 'get_user_option_screen_layout_post', 'force_single_column_layout_post' ); 
```

# xcode - 如何在基于选项卡的应用程序上添加新选项卡？

> ID：13406174
> 
> 赞同：0
> 
> 时间：2012-11-15T21:04:36.110
> 
> 标签：xcode

我正在尝试设计一个 iOS 应用程序，并且想知道如何为我的应用程序创建一个新的选项卡/视图？

或者，如果这样做更简单，我有一个带有选项卡的视图控制器，我怎么能将它连接到我的主视图控制器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:20:45.577

> Or, if this is simpler to do, I have a view controller with a tab on it, how could I connect it to my main view controller?

If you are in Storyboard, hold down the control key and drag with the mouse from the UITabBarController (the one without a view on it, just kinda a transparent grey background) to the UIViewController (has a solid white background color by default) you want to hook up. Release the mouse click, and choose "view controllers" (under "Relationship Segue"). That will automatically add the tab bar to your new UIViewController and add a new icon in your UITabBarController.

# kml - KML 打开图片，谷歌地球

> ID：13406175
> 
> 赞同：4
> 
> 时间：2012-11-15T21:04:38.420
> 
> 标签：kml, google-earth

我正在玩 KML 一点。我正在创建一个在单击时显示图像的地标。当我右键单击图像时，有一个打开它的选项，但 Google 地球无法打开图像。有没有办法让谷歌地球打开它？KML 使用图像的相对路径，并且以这种方式在气球中显示图像没有问题，但是当我单击“打开图像”选项时，它无法打开。如果有人有任何帮助，我将不胜感激。谢谢！

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2" xmlns:gx="http://www.google.com/kml/ext/2.2" xmlns:kml="http://www.opengis.net/kml/2.2" xmlns:atom="http://www.w3.org/2005/Atom">
<Document>
<name>Photos.kml</name>
<Folder>
    <name>Photos</name>

    <Style id="Photo">
        <IconStyle>
            <Icon>
                <href>http://www.google.com/mapfiles/arrow.png</href>
            </Icon>
            <scale>.7</scale> 
        </IconStyle>
    </Style>

    <Placemark>
        <name>IMG_0988.JPG</name>

        <description><![CDATA[<div align="center"><table width="500"><tr><td colspan="2"><center><img src="pics/IMG_0988.jpg" width="500" height="373"></td></tr></table></div>]]></description>

        <styleUrl>#Photo</styleUrl>

        <Point>
            <coordinates>13.18733333,60.66783333000001,0</coordinates>
        </Point>

        <Style>
            <IconStyle>
                <heading>90</heading>
            </IconStyle>
        </Style>

    </Placemark>
</Folder>
</Document>
</kml> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:59:02.857

建议您也使用相同的图像 URL包装`<img>`标签。`<a href="">..</a>`如果您右键单击气球中的图像，Google 地球将为您提供一些附加选项：打开链接、在新窗口中打开、复制链接。

Open Image 可以在 GE 7.0 中使用测试图像。*无论您是否在工具/选项/常规*下选中了“*在外部浏览器中显示网络结果*”选项，结果可能会有所不同。

 *```
<description>
    <![CDATA[<div align="center"><table width="500"><tr><td>
    <a href="pics/IMG_0988.jpg"><img src="pics/IMG_0988.jpg" width="500" height="373"></a>
    </td></tr></table></div>]]>
</description> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-17T08:51:37.060

我不知道这是否正是您的问题，但我刚刚发现了一个非常令人沮丧的 Google 地球怪癖，它与在描述元素中嵌入指向全尺寸图像的链接有关。

基本上，即使文件具有大写扩展名，Google 地球似乎也需要小写扩展名（例如 jpg 而不是 JPG）才能显示在气泡中。

右键单击打开图像适用于两种大写。

例如，我有一个名为“2015_03_27 G11/IMG_8320.JPG”的文件，我想用地标显示：

似乎在 Windows 上工作：

```
<Placemark>
    <name>IMG_8320.JPG</name>
    <description>&lt;img src='2015_03_27 G11/IMG_8320.jpg' width='600' height='450'/&gt;</description>
    <styleUrl>#defaultStyle1</styleUrl>
    <Style>
        <IconStyle>
            <Icon>
                <href>kml-thumbs/thumb-2015_03_27_G11-IMG_8320.JPG</href>
            </Icon>
        </IconStyle>
    </Style>
    <Point>
        <altitudeMode>absolute</altitudeMode>
        <coordinates>10.705401,104.773769,27</coordinates>
    </Point>
</Placemark> 
```

不工作（至少在 Windows 上）

```
<Placemark>
    <name>IMG_8320.JPG</name>
    <description>&lt;img src='2015_03_27 G11/IMG_8320.JPG' width='600' height='450'/&gt;</description>
    <styleUrl>#defaultStyle1</styleUrl>
    <Style>
        <IconStyle>
            <Icon>
                <href>kml-thumbs/thumb-2015_03_27_G11-IMG_8320.JPG</href>
            </Icon>
        </IconStyle>
    </Style>
    <Point>
        <altitudeMode>absolute</altitudeMode>
        <coordinates>10.705401,104.773769,27</coordinates>
    </Point>
</Placemark> 
```*

# c - 删除 C 结构中指针的常量

> ID：13406178
> 
> 赞同：1
> 
> 时间：2012-11-15T21:04:57.203
> 
> 标签：c, pointers, gcc, macros, constants

所以我需要从 C 中的一些变量中删除常量（我知道我在做什么）。所以我写了一个小宏 ( `UNCONST`)，它可以让我为 const 值分配一个新值。这对于像`int`. 但这不适用于指针。`UNCONST`所以我不能在没有得到编译器警告的情况下使用我的宏让指针指向不同的位置。

这里有一个小测试程序`unconst.c`：

```
#include <stdio.h>

#define UNCONST(type, var, assign) do { \
  type* ptr = (type*)&(var); \
  *ptr = (assign); \
} while(0)

struct mystruct {
  int value;
  char *buffer;
};

int main() {
  // this works just fine when we have an int
  const struct mystruct structure;
  UNCONST(int, structure.value, 6);
  printf("structure.value = %i\n", structure.value);

  // but it doesn't when we have an char *
  char *string = "string";
  UNCONST(char *, structure.buffer, string);
  printf("structure.buffer = %s\n", structure.buffer);

  // this doesn't work either, because whole struct is const, not the pointer.
  structure.buffer = string;
  printf("structure.buffer = %s\n", structure.buffer);
} 
```

编译和执行

```
$ LANG=en gcc -o unconst unconst.c
unconst.c: In function ‘main’:
unconst.c:21:3: warning: assignment discards ‘const’ qualifier from pointer target type [enabled by default]
unconst.c:25:3: error: assignment of member ‘buffer’ in read-only object 
```

有没有办法优化我的宏，所以这个警告不会出现？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T21:10:00.503

问题在：

```
const char *string1 = "string1";
UNCONST(char *, string1, string2); 
```

是`string1`不是真的 const，它可以被赋值，而是指向一个 const 字符数组。

实际上，做：

```
string1 = string2; 
```

编译就好了。

另一件事是如果你想复制数组。然后我会这样写你的宏：

```
#define UNCONST(type, var) (*(type*)&(var)) 
```

所以：

```
UNCONST(int, i) = 42; 
```

要复制字符数组，您可以执行以下操作：

```
strcpy(UNCONST(char**,string1), string2); 
```

脚注：实际上我发现这个宏没用：我发现：

```
*(int*)&i = 42; 
```

像这种操作一样繁琐。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:14:37.570

如果 string1 应该是一个 const 指针（而不是一个指向 const 数据的非 const 指针），那么这样写：

```
char * const ptr = "foo"; 
```

或者

```
const char * const ptr = "foo"; 
```

如果您正确声明了指针，也许（我还没有测试过）您的 UCONST 宏会按预期工作。

# java - Java：将日历转换为字符串并返回的最简单方法

> ID：13406179
> 
> 赞同：3
> 
> 时间：2012-11-15T21:05:00.027
> 
> 标签：java

我的应用程序使用的 API 只接受`Map<String, String>`. 因此，所有对象都必须转换为这种形式，然后才能传递给 API。

这对于诸如 etc 之类的简单类来说是非常微不足道的`Boolean, BigDecimal`。但事实证明，它对于转换`Calendar`对象有些问题。

我不太熟悉 Java 中日历/日期等的所有细微差别，因此希望能提供一些关于将日历转换为字符串然后再返回的建议。

当我的应用程序收到请求时，它已经构建了日历。然后它必须将其转换为字符串 (1)，将其传递给 API (2)，然后将其转换回另一端的日历 (3)。

所以我控制着 1 和 3，而不是 2。

基于此，转换为字符串然后再转换为字符串的最简单方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-15T21:08:07.093

可能最好的办法是使用`Calendar.getTimeInMillis()`，将其存储`String`为该值的版本，`long`然后`Calendar.getInstance().setTimeInMillis(Long.parseLong(Map.get(strIndex)))`取回日历。

# android - 如何获取本地 IP 并在 TextView 中显示？

> ID：13406180
> 
> 赞同：1
> 
> 时间：2012-11-15T21:05:01.823
> 
> 标签：android, networking, textview, ip

花了很多时间寻找方法（通过谷歌和这个网站），但我找不到正确的代码来写入 TextView 自己的 android ip 地址。

我尝试了很多代码，但没有一个运行。

获取android的IP地址并将其放入TextView的正确方法是什么？

谢谢。

```
public class MainActivity extends Activity {

private TextView textView1;
private String tag;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    textView1 =(TextView)findViewById(R.id.textView1);
    getLocalIpAddress();
    String ip = getLocalIpAddress();
    textView1.setText("IP:"+ip);
}

public String getLocalIpAddress()
{
    try 
    {
        for (Enumeration<NetworkInterface> en = NetworkInterface.getNetworkInterfaces(); en.hasMoreElements();)
        {
            NetworkInterface intf = en.nextElement();
            for (Enumeration<InetAddress> enumIpAddr = intf.getInetAddresses(); enumIpAddr.hasMoreElements();)
            {
                InetAddress inetAddress = enumIpAddr.nextElement();
                if (!inetAddress.isLoopbackAddress()) 
                {
                    return inetAddress.getHostAddress().toString();
                }
            }
        }
    } 
    catch (SocketException ex)
    {
        Log.e(tag, ex.toString());
    }
    return "";
} 
```

}

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="19dp"
    android:text="TextView" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:08:53.537

```
TextView tv = (TextView) findViewById(R.id.tv);
WifiManager wim= (WifiManager) getSystemService(WIFI_SERVICE);
List<WifiConfiguration> l =  wim.getConfiguredNetworks(); 
WifiConfiguration wc = l.get(0); 
tv.append("\n"+ Formatter.formatIpAddress(wim.getConnectionInfo().getIpAddress())); 
```

AndroidManifest.xml 权限：

```
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
```

或者您可以使用此代码（不使用 Formatter）：

```
public String getLocalIpAddress()
{
    try 
    {
        for (Enumeration<NetworkInterface> en = NetworkInterface.getNetworkInterfaces(); en.hasMoreElements();)
        {
            NetworkInterface intf = en.nextElement();
            for (Enumeration<InetAddress> enumIpAddr = intf.getInetAddresses(); enumIpAddr.hasMoreElements();)
            {
                InetAddress inetAddress = enumIpAddr.nextElement();
                if (!inetAddress.isLoopbackAddress()) 
                {
                    return inetAddress.getHostAddress().toString();
                }
            }
        }
    } 
    catch (SocketException ex)
    {
        Log.e(tag, ex.toString());
    }
    return "";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-15T21:38:01.470

尝试这个

```
 String IP;
  WifiManager wim= (WifiManager) getSystemService(WIFI_SERVICE);
  List<WifiConfiguration> l =  wim.getConfiguredNetworks(); 
  WifiConfiguration wc = l.get(0);
  IP=Formatter.formatIpAddress(wim.getConnectionInfo().getIpAddress());
  tv.setText(IP); 
```

# javascript - 将 URL 信息从父 iframe 转发到子 iframe

> ID：13406182
> 
> 赞同：2
> 
> 时间：2012-11-15T21:05:02.977
> 
> 标签：javascript, html, url, redirect, iframe

我需要想出一种方法将阻止信息从我们学校的互联网过滤器转发到我们学校的内部网络服务器。最后一页将只是一个普通的 html 页面，但中间有一个 iframe，允许教员登录以覆盖互联网过滤器。

当过滤器第一次阻止页面时，它会将用户发送到 `http://extranet.test.org/blocked.html?URL=http://test.8e6.net/&IP=4.4.4.4&CAT=GPORN&USER=IPGROUP`Where 之后的所有内容？是 iframe 必须在其 URL 末尾包含的信息。

在父页面的 html 中，我如何指定 iframe 应该`http://google.com/block.html`与父页面之后的内容一起使用`?`？所以最后 iframe 应该是`http://google.com/block.html?URL=http://test.8e6.net/&IP=4.4.4.4&CAT=GPORN&USER=IPGROUP`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:40:15.280

换句话说，您可以使用 JavaScript 创建一个 iframe，其中包含来自父页面的查询字符串。

奇怪的是，在 JavaScript 中，查询字符串在 中`window.location.search`，并且包含`?`字符。这意味着您可以使用以下代码将其复制到 iframe 中：

```
​&lt;iframe id="bypass-login"/>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​
<script>
  loginIframe = document.getElementById("bypass-login");
  loginIframe.src="http://google.com/block.html" + window.location.search​;
</script> 
```

# dynamics-crm-2011 - 什么设置了电子邮件的实际结束日期？

> ID：13406186
> 
> 赞同：1
> 
> 时间：2012-11-15T21:05:15.570
> 
> 标签：dynamics-crm-2011, outlook-addin

填充 CRM 2011 电子邮件记录的实际结束日期字段的内容是什么？

以下是来自 CRM 2011 数据库的实际电子邮件记录字段：

```
Created On          | Modified On         | Actual End
2012-11-15 19:46:00 | 2012-11-15 19:46:01 | 2012-11-15 22:46:57
2012-11-15 18:31:04 | 2012-11-15 18:31:04 | 2012-11-15 22:46:57
2012-11-15 16:47:48 | 2012-11-15 16:47:48 | 2012-11-15 22:29:22 
```

问题是实际结束日期立即设置为未来几个小时加上看似随机的分钟数。我会理解由于 +/- GMT 造成的时间差异，但我看不到任何依据。另请注意，前两封电子邮件是在不同时间发送的，但实际结束时间完全相同。在前两条记录的情况下，用户发送了一条，然后我在 1 个多小时后发送了另一条。

请注意，没有任何工作流程可以修改这些电子邮件或任何其他工作。我还确认两个 Outlook 客户端的本地时间设置正确，并且服务器上的时间也是正确的。显然，该字段填充了某些内容，但尚不清楚那是什么或它如何计算该时间，也不清楚为什么它与其他日期字段不同。

服务器是汇总 8，Outlook 汇总 11。

谁能告诉我这是如何工作的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:53:21.600

Microsoft Dynamics CRM 电子邮件实体的实际结束属性由电子邮件消息中的 ReceivedOn 日期值填充。

另外，请注意，由于错误，actualend 属性上的时区可能是错误的。但是它已在[这些修补程序之一中修复](http://support.microsoft.com/kb/949256)

# powershell - Powershell 是 Windows 开发人员必备的技能吗？比如 Bash/Borne 是 Linux/UNIX 开发人员的必备技能吗？

> ID：13406187
> 
> 赞同：6
> 
> 时间：2012-11-15T21:05:15.930
> 
> 标签：powershell

鉴于 UNIX 类型环境中的开发人员需要基本的 shell 命令和脚本（我说的是圆形、小型商店、devops 类型），Powershell 是否等同于 Windows？

我有一台 Windows 7 机器在工作，但我在 UNIX 环境中进行所有开发，无论是在 Mac 上还是在带有 VMWare 的 Linux 客户机上。我*本身*不是系统管理员，但我在这里和那里填写。UNIX 中的 Grep、sed、awk、文件结构、网络等都已经根深蒂固。我多年来一直在使用这些工具。几十年，甚至。

我最近一直在 Windows 机器上闲逛。我的习惯是下拉到命令行来完成工作，而不是通常与 Windows 使用相关的所有指向和单击狂热。但是对于Powershell，我完全迷失了。对我来说没有任何意义。

值得学习吗？这甚至是 Windows 人的工作方式吗？这一切会突然改变吗？成为 Powershell 大师有优势吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T21:23:02.810

我相信是这样。PowerShell 是Windows Server 2012*的*管理界面，几乎所有这些都已移植回 2008R2 和 Win7（Windows Management Framework 3.0）。

有很多人反对过渡到 PowerShell，但 MS 已经下令这是前进的方向。最终用户不会经常使用它，就像使用命令提示符一样，但开发人员和管理员绝对需要了解它。

成为 PowerShell 大师的优势？与使用 BAT/CMD 脚本或 Windows 脚本宿主 (VBScript/JScript) 相比，您可以更轻松地自动化更多的 Windows。远程管理/访问非常简单，旨在让您从一个中心位置管理大量机器。

我发现自己在 PowerShell 中执行了很多以前跳到 Visual Studio 的任务，因为它上手速度更快，让我可以在命令行上快速原型化，并且内置了很多 cmdlet 来执行任务我通常需要写十几行 C# 来完成。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-15T21:12:16.703

我相信它可以和 Bash 一样强大，但是所有的命令名称和语法都不同。查看这篇文章，它将一些常见的 UNIX 命令与 powershell 等效命令进行了比较。

[http://windows-powershell-scripts.blogspot.com/2009/06/unix-equivalents-in-powershell.html](http://windows-powershell-scripts.blogspot.com/2009/06/unix-equivalents-in-powershell.html)

随着我开始更多地使用powershell，我发现它绝对值得学习。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T21:19:45.080

我的 2 美分：

我是一名全职系统管理员、一名开发者自由职业者和一名充满激情的摄影师。对于我的系统管理员工作，我经常使用 powershell。作为一名开发人员，有时也作为一名摄影师（用于管理我的照片！）。在我的工作环境中，有 6 个全职开发人员（.net），没有人知道 powershell（有些人永远不知道是什么）。Powershell 和 bash 一样确实是一个强大的 shell，最大的区别在于它基于 .net 框架，并且可以处理对象而不仅仅是字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T21:31:28.413

PowerShell 无法与 Unix 控制台环境相提并论，方法非常不同......

在 win 上，您可以使用本机 vbs 获得一些脚本，但包含的工具非常有限，也许您可​​以使用 gnuwin32 在 windows env 上尝试一些基本的 unix 工具。

根据我使用win7的经验，我可以告诉你powershell仅适用于windows产品，如exchange、active directory等，但尝试像unix shell一样使用它非常令人沮丧，你不能......（你可以'不要从像 linux 这样的 Windows 上的内核更改实时状态标志）

我现在正在使用简单的 windows shell 和 python 来获得一些我从 Unix 系统中错过的高级开发人员功能......但还不够......

# java - Base64 编码与 Ascii85 编码

> ID：13406189
> 
> 赞同：16
> 
> 时间：2012-11-15T21:05:25.073
> 
> 标签：java, json, base64, ascii85

我的工作项目是使用[Jackson JSON](http://jackson.codehaus.org)序列化程序将一堆 Java 对象转换为字符串，以便将它们发送到 REST 服务。

其中一些对象包含敏感数据，因此我编写了自定义序列化程序来将这些对象序列化为 JSON 字符串，然后 gzip 压缩它们，然后使用`AES`;加密它们。

这会将字符串转换为字节数组，因此我在编解码器中使用[Base64](http://en.wikipedia.org/wiki/Base64)编码`Apache commons`器将字节数组转换为字符串。REST 接口后面的自定义反序列化器反转了这个过程：

`base64 decode -> decrypt -> decompress -> deserialize using default Jackson deserializer.`

`Base64`编码会增加输出的大小（序列化中的 gzip 步骤旨在帮助改善这种增加），所以我检查了谷歌，看看是否有更有效的替代方案，这导致我找到了[之前](https://stackoverflow.com/questions/1777309/alternative-to-base64-encoding)的 stackoverflow 线程，该线程将[Ascii85](http://en.wikipedia.org/wiki/Ascii85)编码为更有效的替代方案 -

`Base64`输出大小增加 33%，输出大小`Ascii85`增加 25%。

我发现了一些 Java Ascii85 实现，例如 Apache pdfbox，但我对使用编码有点谨慎 - 似乎几乎没有人在使用或实现它，这可能只是意味着 Base64 有更多的惯性，或者这可能意味着Ascii85 有一些奇怪的问题。

有人对这个主题了解更多吗？Ascii85 是否有任何问题意味着我应该改用 Base64？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-15T21:35:46.010

Base64更*常见*。在大多数情况下，大小的差异实际上并不*那么*显着，如果您在 HTTP 级别（将压缩 base64）而不是*在*您的有效负载中添加，您很可能会发现差异完全消失了。

> Ascii85 是否有任何问题意味着我应该改用 Base64？

我强烈建议使用 base64，因为它*更*广泛。这几乎是将二进制数据表示为文本的规范方式（当然，除非您想使用十六进制）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-04-02T14:45:42.557

ASCII85 是一种很好的编码，可以用来节省额外的空间。但它会输出许多字符，如果通过 HTTP 天真地发送这些字符就需要转义。Base64 编码有一个变体，可以通过 HTTP 发送而无需任何转义。

这是一个 javascript ASCII85 编码器，以防有人需要尝试：

```
// By Steve Hanov. Released to the public domain.
function encodeAscii85(input) {
  var output = "<~";
  var chr1, chr2, chr3, chr4, chr, enc1, enc2, enc3, enc4, enc5;
  var i = 0;

  while (i < input.length) {
    // Access past the end of the string is intentional.
    chr1 = input.charCodeAt(i++);
    chr2 = input.charCodeAt(i++);
    chr3 = input.charCodeAt(i++);
    chr4 = input.charCodeAt(i++);

    chr = ((chr1 << 24) | (chr2 << 16) | (chr3 << 8) | chr4) >>> 0;

    enc1 = (chr / (85 * 85 * 85 * 85) | 0) % 85 + 33;
    enc2 = (chr / (85 * 85 * 85) | 0) % 85 + 33;
    enc3 = (chr / (85 * 85) | 0 ) % 85 + 33;
    enc4 = (chr / 85 | 0) % 85 + 33;
    enc5 = chr % 85 + 33;

    output += String.fromCharCode(enc1) +
      String.fromCharCode(enc2);
    if (!isNaN(chr2)) {
      output += String.fromCharCode(enc3);
      if (!isNaN(chr3)) {
        output += String.fromCharCode(enc4);
        if (!isNaN(chr4)) {
          output += String.fromCharCode(enc5);
        }
      }
    }
  }

  output += "~>";

  return output;
}
```

```
<input onKeyUp="result.innerHTML = encodeAscii85(this.value)" placeholder="write text here" type="text">
<p id="result"></p>
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-07-31T08:11:38.813

这是 JavaScript 中匹配的 ASCII85 AKA Base85 解码器（用于用户[Qwerty](https://stackoverflow.com/questions/13406189/base64-encoding-vs-ascii85-encoding/29415858?noredirect=1#comment50285880_29415858)）：

```
function decode_ascii85(a) {
  var c, d, e, f, g, h = String, l = "length", w = 255, x = "charCodeAt", y = "slice", z = "replace";
  for ("<~" === a[y](0, 2) && "~>" === a[y](-2), a = a[y](2, -2)[z](/\s/g, "")[z]("z", "!!!!!"), 
  c = "uuuuu"[y](a[l] % 5 || 5), a += c, e = [], f = 0, g = a[l]; g > f; f += 5) d = 52200625 * (a[x](f) - 33) + 614125 * (a[x](f + 1) - 33) + 7225 * (a[x](f + 2) - 33) + 85 * (a[x](f + 3) - 33) + (a[x](f + 4) - 33), 
  e.push(w & d >> 24, w & d >> 16, w & d >> 8, w & d);
  return function(a, b) {
    for (var c = b; c > 0; c--) a.pop();
  }(e, c[l]), h.fromCharCode.apply(h, e);
}
```

```
<input onKeyUp="result.innerHTML = decode_ascii85(this.value)" placeholder="insert encoded string here" type="text">
<p id="result"></p>
example: <xmp><~<+oue+DGm>@3BW*D/a<&+EV19F<L~></xmp>
```

# kohana-orm - 多对多关系中的 Kohana ORM 商店计数

> ID：13406190
> 
> 赞同：0
> 
> 时间：2012-11-15T21:05:26.110
> 
> 标签：kohana-orm, kohana-3.2

我正在使用 Kohana 3.2 和 Kohana ORM 构建一个应用程序。

该应用程序具有系统。系统包含组件。一个系统可能包含多个组件，但也可能包含多个相同类型的组件。例如 System_A 可能有 10 个 Component_Y 和 3 个 Component_Z

因此，除了在我的数据透视表中只有两个 belongs_to 字段之外，我还想存储计数。

如果我只使用 has-many-through 我将无法访问计数。如果没有 ORM，我只需将计数加入 SQL 中的组件，因为系统 + 组件组合的计数是唯一的，因此当我在某个系统的上下文中访问对象时，我可以访问组件的计数。

在 Kohana ORM 中如何最好地解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T16:06:44.933

我以这种方式部分解决了它：

```
protected $_has_many = array(
        'omvormer' => array(
            'model' => 'omvormer', 
            'through' => 'systeemomvormer'
        ),
        'systeemomvormer' => array(
            'model' => 'systeemomvormer',
        )
    ); 
```

我已将数据透视表`systeemomvormer`单独添加到`systeem`.

我现在可以这样做：

```
$so = ORM::factory("systeemomvormer");
$so->where('systeem_id', '=', $systeem_id);
$so->where('omvormer_id', '=', $omvormer_id);
$result = $so->find();
$result->aantal = $omvormer_count; 
```

但它实际上仍然只是一个部分解决方案，因为我无法`update()`得到结果。Kohana 说没有加载结果。然而，这超出了这个问题的范围，我将为此提出一个新问题。

这也很有帮助：http: [//forum.kohanaframework.org/discussion/7247/kohana-3-orm-save-for-update-a-many-to-many/p1](http://forum.kohanaframework.org/discussion/7247/kohana-3-orm-save-for-update-a-many-to-many/p1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T07:28:21.910

要在联结表中存储比两个键更多的数据，您需要为它创建一个模型。

所以，

```
system _has_many system_component
component _has_many system_component
system_component _belongs_to component
system_component _belongs_to system 
```

但是，如果您这样做，您可能不需要存储计数。相反，您可以执行以下操作：

```
$system->components->count_all(); 
```

然后，访问它们：

```
foreach($system->components->find_all() as $component)
  echo $component->component->name; 
```

# c# - 工厂模式，返回一个泛型类并有一个参数

> ID：13406196
> 
> 赞同：2
> 
> 时间：2012-11-15T21:05:55.680
> 
> 标签：c#, .net, design-patterns, factory-pattern

我有这个工厂模式的实现

```
public interface IFactory<T>
{
    T GetObject();
}

public class Factory<T> : IFactory<T> where T : new()
{
    public T GetObject()
    {
        return new T();
    }
} 
```

但我想`GetObject`返回一个泛型类的实例`Repository<Customer>`（`Repository implement IRepository`）并且工厂有一个参数（ISession 类型）

结果应该是：

```
IRepository<ICustomer> myRepo = new Factory<ICustomer>(session); 
```

我怎样才能做到这一点 ？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:08:23.087

考虑使用一个无参数的构造函数，以及一些接受参数的初始化函数。除了不能通过您的工厂传递参数之外，请考虑您想要反序列化对象的情况。它们应该被构造，然后参数应该被一个一个地填充。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:25:22.273

有必要这么通用吗？为什么不这样？

```
public interface IFactory<T>
{
    IRepository<T> Create(ISession session);
}

public class RepositoryFactory<T> : IFactory<T> where T : new()
{
    public IRepository<T> Create(ISession session)
    {
        return new IRepository<T>();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T14:40:37.977

我不确定你是否真的需要那种级别的泛型，但你可以使用泛型流利的工厂方法，而不是来自构造函数的初始化函数。

```
 var CustomerGeneric = GenericFluentFactory<Customer, WebSession>
                        .Init(new Customer(), new WebSession())
                        .Create();

public static class GenericFluentFactory<T, U>
{
    public static IGenericFactory<T, U> Init(T entity, U session)
    {
        return new GenericFactory<T, U>(entity, session);
    }        
}

public class GenericFactory<T, U> : IGenericFactory<T, U>
{
    T entity;
    U session;

    public GenericFactory(T entity, U session)
    {
        this.entity = entity;
        this.session = session;
    }

    public T Create()
    {
        return this.entity;
    }
} 
```

# java - 获取用于 MethodInvocation 的实际类而不是声明类

> ID：13406205
> 
> 赞同：4
> 
> 时间：2012-11-15T21:06:19.610
> 
> 标签：java, reflection

我正在研究一个 Web 应用程序以解决一些问题。该应用程序使用 Tomcat、Jersey 和 Guice。其中一个问题发生在用于授权目的的 MethodInterceptor 中。这是方法，修剪到相关部分：

```
public Object invoke(MethodInvocation invoc) throws Throwable {
    // ...

    //Check that the annotation actually exists
    if(! invoc.getMethod().getDeclaringClass().isAnnotationPresent(Tool.class))
    {
        throw new BaseException("...");
    }

    // ...
} 
```

现在的问题是一些“面向网络”的方法是从父类继承的，而没有在子类中被覆盖。如果我正确理解 getDeclaringClass() ，在这种情况下它将返回*父*类，但我们真正想要的是子类。一些测试似乎证实了这一点——如果我覆盖子类中的方法一切都很好，但如果我不进行覆盖，则会引发异常。

那么，给定一个 MethodInvocation 对象，有没有办法将其追溯到实例化的“实际”类，而不是声明该方法的类？还是需要其他一些方法？最坏的情况是，我可以根据需要对每个方法进行注释，而不是对类进行注释。

抱歉，如果这是一个冗长的问题，可以轻松回答 - 我的 Java 相当生疏。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-15T21:46:33.717

很简单，需要`getThis().getClass()`在 MethodInvocation 上使用，而不是`getMethod().getDeclaringClass()`：

```
 if(! invoc.getThis().getClass().isAnnotationPresent(Tool.class))
    {
        throw new BaseException("...");
    } 
```

虽然在我的例子中，Guice 通过放入一个自动生成的子类（例如，一个以“$$EnhancerByGuice...”结尾的类名来解决这个问题，可以通过将一个向上移动一个来修复`getSuperclass()`：

```
 if(! invoc.getThis().getClass().getSuperclass().isAnnotationPresent(Tool.class))
    {
        throw new BaseException("...");
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:27:44.837

看起来答案是否定的。我创建了简单的测试来检查它：

```
 class Run implements Runnable {
        @Override
        public void run() {
        }
    }
    class Run2 extends Run{}
    Method method = Run2.class.getMethods()[0];
    System.out.println(method); 
```

正如我们在调试窗口方法中看到的那样，没有 Run2 类的任何信息：

![调试窗口中的方法](../Images/2aa365bdf072b8e50c319fdcf4f02bde.png)

我想最好使用带有注释的实际方法，而不是在调用这些方法的实际类实例上。

# amazon-web-services - 在 boto 中获取 SQS 消息状态

> ID：13406209
> 
> 赞同：2
> 
> 时间：2012-11-15T21:06:35.287
> 
> 标签：amazon-web-services, boto, amazon-sqs

我有一个 SQS 生产者和很多消费者。知道生产者是否可以判断*特定消息*是否已被消费者删除将非常有帮助。有没有办法做到这一点？我目前正在使用 boto 2.6.0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T15:22:51.317

据我所知，SQS 没有提供任何消息被删除时的通知机制。因此，我认为如果您想知道消息何时被删除，您必须通过保存消息 ID 的数据库并让消费者告诉您他们已删除的任何消息的消息 ID 来单独跟踪该消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T22:18:40.667

据我所知，您无法跟踪队列中的消息。根据您的目标，您可以尝试以下操作：

**监控**

将作业的结果写入日志文件，并可能使用类似[logstash](http://logstash.net/)和[Kibana](http://kibana.org/)的东西。如果你有创意，你甚至可以直接将东西放入 ElasticSearch 或 SimpleDB 之类的东西中。

**打回来**

接收器可以向处理器或任何其他进程触发任何类型的“回调”，以更新例如数据库或缓存中的某个消息状态。

您必须记住，这意味着当您扩大接收器时，您的处理器也必须扩大。还要留意你的索引，确保你的状态更新“写”很快。

# javascript - 动态 crm 4.0 查找字段 onload() 查询

> ID：13406210
> 
> 赞同：2
> 
> 时间：2012-11-15T21:06:36.223
> 
> 标签：javascript, dynamics-crm, dynamics-crm-4

我有一个带有查阅字段的帐户实体，该字段`schoolLookupId`引用自定义实体`new_schools`。查找字段仅显示学校的名称。我希望能够使用`onload()`帐户表单的事件处理程序执行的操作是运行一些 javascript 代码，该代码将查询实体的`new_phonenumber`属性`new_schools`以查看它是否与我提供的值匹配让我们说`var x = "1234"`，如果匹配则`schoolLookupId`相应地更新与找到的电话号码对应的学校名称。即使用已经存在的电话号码更新查找字段，**而无需**创建全新的查找值。

我可以使用获取查找字段的属性

```
var name = crmForm.all.schoolLookupid.DataValue[0].name
var id = crmForm.all.schoolLookupid.DataValue[0].id
var typename = crmForm.all.schoolLookupid.DataValue[0].typename 
```

但我不知道如何检索、比较查找字段后面的数据，并相应地更新查找字段。

您的帮助一如既往是无价的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T10:11:01.013

尝试将此代码放在加载事件中：

```
 var xml = "" +  
    "<?xml version=\"1.0\" encoding=\"utf-8\"?>" +  
    "<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\">" +  
    GenerateAuthenticationHeader() +  
    " <soap:Body>" +  
    " <RetrieveMultiple xmlns=\"http://schemas.microsoft.com/crm/2007/WebServices\">" +  
    " <query xmlns:q1=\"http://schemas.microsoft.com/crm/2006/Query\" xsi:type=\"q1:QueryExpression\">" +  
    "        <q1:EntityName>new_schools</q1:EntityName>" + 
    "        <q1:ColumnSet xsi:type=\"q1:ColumnSet\">" + 
    "          <q1:Attributes>" + 
    "            <q1:Attribute>new_schoolsid</q1:Attribute>" + 
    "          </q1:Attributes>" + 
    "        </q1:ColumnSet>" + 
    "        <q1:Distinct>false</q1:Distinct>" + 
    "        <q1:Criteria>" + 
    "          <q1:FilterOperator>And</q1:FilterOperator>" + 
    "          <q1:Conditions>" + 
    "            <q1:Condition>" + 
    "              <q1:AttributeName>new_phonenumber</q1:AttributeName>" + 
    "              <q1:Operator>Equal</q1:Operator>" + 
    "              <q1:Values>" + 
    "                <q1:Value xsi:type=\"xsd:string\">"+crmForm.all.new_phonenumber.DataValue+"</q1:Value>" + 
    "              </q1:Values>" + 
    "            </q1:Condition>" +
    "          </q1:Conditions>" + 
    "        </q1:Criteria>" + 
    " </query>" +  
    " </RetrieveMultiple>" +  
    " </soap:Body>" +  
    "</soap:Envelope>" +  
    "";  

    var xmlHttpRequest = new ActiveXObject("Msxml2.XMLHTTP");
    xmlHttpRequest.Open("POST", "http://"+window.location.hostname+":"+window.location.port+"/mscrmservices/2007/crmservice.asmx", false);
    xmlHttpRequest.setRequestHeader("SOAPAction"," http://schemas.microsoft.com/crm/2007/WebServices/RetrieveMultiple");  
    xmlHttpRequest.setRequestHeader("Content-Type", "text/xml; charset=utf-8");  
    xmlHttpRequest.setRequestHeader("Content-Length", xml.length);  
    xmlHttpRequest.send(xml);  

    var resultXml = xmlHttpRequest.responseXML;

    if (_resultXml.xml.search('<q1:new_schoolsid')>0)
    {
        var val = xmlDoc.getElementsByTagName("q1:new_schoolsid")[0].childNodes[0].nodeValue;

        var lookupitem = new Array(); 
        lookupitem[0] = new LookupControlItem(val , typecode, name); 
        crmForm.all.schoolLookupid.DataValue = lookupitem ; 
    }
} 
```

我不尝试这段代码要小心。使用此代码作为指南。

希望这可以帮助。如果我回答了您的问题，请将回复标记为答案并投票为有帮助。

# javascript - 忽略溢出中的元素：自动元素

> ID：13406211
> 
> 赞同：0
> 
> 时间：2012-11-15T21:06:38.050
> 
> 标签：javascript, html, css

我在下面有一个 HTML 结构：

```
<div style="overflow:auto;" id="wrap">
    <div id="text">content</div>
    <div id="a"> </div>
</div> 
```

是否可以让溢出仅考虑#text 的大小而忽略#a，即使#a 进一步溢出？我不能将#a 放在 wrap DIV 之外。如果这是唯一的选择，我可以使用 javascript。

编辑：这是我所拥有的一个示例，以更清楚地显示我要问的内容：http: [//jsfiddle.net/mAHMb/](http://jsfiddle.net/mAHMb/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T01:55:52.760

也许这会有所帮助？：

请尝试添加`overflow-y:auto;`到#text，然后设置其高度，删除#wrap 高度，您应该能够滚动#text 而无需滚动#a。

这是 jsfiddle 示例：http: [//jsfiddle.net/R4QWP/](http://jsfiddle.net/R4QWP/)

# javascript - tinymce 核心功能操作

> ID：13406214
> 
> 赞同：0
> 
> 时间：2012-11-15T21:06:49.173
> 
> 标签：javascript, tinymce

tinymce 在输入新行时会自动继承前一行的格式。

示例：在 TinyMCE 的原始 HTML 编辑器中键入以下内容。

```
<p><span class="test">first</span></a> 
```

现在翻回所见即所得的编辑器，你会看到“第一”这个词。现在在编辑器中，如果您单击“first”一词的末尾并按回车键，然后键入“second”，然后查看生成的 HTML，您将看到

```
<p><span class="test">first</span></a>
<p><span class="test">second</span></a> 
```

我想要它，所以你会看到：

```
<p><span class="test">first</span></a>
<p>first</a> 
```

有没有人有任何想法来实现这一目标？我已经这样做了6个小时，我正要跳出窗外。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:23:39.730

我在 WordPress 中使用 TinyMCE 编辑器，没有遇到这个问题。你在哪里使用编辑器？

在 WordPress 中查看 TinyMCE 高级设置，我只有

`Stop removing the <p> and <br /> tags when saving and show them in the HTML editor`检查。您的 TinyMCE 是如何配置的？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T23:59:48.360

我想到了。在初始化时将“keep_styles”设置为 false。

# wpf - 如何扩展 Caliburn.Micro 中的数据绑定约定？

> ID：13406217
> 
> 赞同：1
> 
> 时间：2012-11-15T21:07:01.313
> 
> 标签：wpf, caliburn.micro

我想扩展 Caliburn.Micro 以便它自动将 Enable 控件附加到 VM 上的属性。

假设我有一个`textBox`名为`"MyText"`的视图。CM 自动将其绑定到`MyText`VM 上的属性。我想扩展它，所以如果我在 VM 中定义一个名为`"MyTextEnable"`的`Enable`属性，`MyText`CM 会自动绑定到它的属性。

我怎样才能做到这一点？是否有示例代码显示如何扩展 CM 约定？我在文档中找不到任何帮助。我需要一个示例项目来展示如何扩展它。

# webforms - ASPNET 4.5 WebForms ModelBinding 不适用于 DropDownList

> ID：13406223
> 
> 赞同：3
> 
> 时间：2012-11-15T21:07:38.657
> 
> 标签：webforms

我试图在 ASPNET 4.5 Webforms 中使用新的 ModelBinding 功能但没有成功。

由于某种原因，Contact.ContactType 在提交表单后仍然为空。

模型：

```
public class Contact
{
    public int ContactId { set; get; }
    public string Name { set; get; }
    public string Phone { set; get; }

    public ContactType ContactType { set; get; }
}

public class ContactType 
{
    public int ContactTypeId { set; get; }
    public string Description { set; get; }

public virtual ICollection<Contact> Contacts { set; get; }
} 
```

ASPX：

```
<asp:FormView ID="FormView1" runat="server"
    ItemType="Models.Contact" DataKeyNames="ContactId" 
     DefaultMode="Insert" InsertMethod="InsertContact" >
    <InsertItemTemplate>
        <ul>
            <li>
                <label>Name</label>
                <asp:DynamicControl runat="server" id="Name" DataField="Name" Mode="Insert" />
            </li>
            <li>
                <label>Phone</label>
                <asp:DynamicControl runat="server" id="Phone" DataField="Phone" Mode="Insert"  />
            </li>
            <li>
                <label>Contact Type</label>
                <asp:DropDownList ID="ContactType" runat="server" AppendDataBoundItems="true"
                    ItemType="Models.ContactType" SelectMethod="GetContactTypes"
                    DataTextField="Description" DataValueField="ContactTypeId">
                    <asp:ListItem Value="0" Text="Select"></asp:ListItem>
                </asp:DropDownList>
            </li>
            <li>
                <asp:LinkButton ID="LinkButton1" runat="server"
                    CommandName="Insert" Text="Insert" >

                </asp:LinkButton>
            </li>
        </ul>
    </InsertItemTemplate>
</asp:FormView> 
```

ASPX.CS：

```
public void InsertContact(Contact contact)
    {
        if (ModelState.IsValid)
        {
            // Save changes here
        }
    } 
```

如何在下拉列表/列表框中成功使用 ModelBinding？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T19:37:24.853

您可以在 getcontacttypes 中返回字典，然后使用：

```
 <asp:DropDownList ID="ContactType" runat="server" AppendDataBoundItems="true"
       SelectMethod="GetContactTypes"
      DataTextField="Value" DataValueField="Key"
      SelectedValue="<%# BindItem.ContactTypeId%>"
      >
      <asp:ListItem Value="0" Text="Select"></asp:ListItem>
    </asp:DropDownList> 
```

SelectedValue="<%# BindItem.ContactTypeId%>" 很重要

# asp.net - 文件已使用 system.io.file.copy 存在

> ID：13406225
> 
> 赞同：0
> 
> 时间：2012-11-15T21:07:43.530
> 
> 标签：asp.net, file, copy

我正在使用 System.IO.File.Copy 将文件从服务器 A 复制到服务器 B。当文件存在时，这很好接受我收到错误“文件已存在”。我尝试使用 if file.exsist 来捕获它，但什么也没有。

这是我的代码。

```
'Save files to disk
 FileUpload1.SaveAs(Server.MapPath("../pdf/audits/" & FileName))
 'Local Server
 Dim localPath As String = "\\server01\folder1$\pdf\audits\"
 'Remote Server
 Dim remotePath As String = "\\server02\folder2$\pdf\audits\"
 System.IO.File.Copy(localPath + FileName, remotePath + FileName) 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:12:15.933

如果您只是像这样修改您的复制操作，它应该可以工作。最后一个参数将覆盖文件。

```
System.IO.File.Copy(localPath + FileName, remotePath + FileName, True); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:11:11.103

如果它已经存在，还有第三个参数要覆盖

```
System.IO.File.Copy(fileName, destName, overwrite); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T21:26:25.607

如果你有大文件，你不会想每次都覆盖它们。尝试修复检查以查看文件是否存在。像这样的东西（C#）：

```
var localPath = @"C:\";
var remotePath = @"\\server\folder\";
var fileName = "test.txt";

if (!new System.IO.FileInfo(remotePath + fileName).Exists)
{
    System.IO.File.Copy(localPath + fileName, remotePath + fileName);
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-15T22:25:54.877

```
 I got it working with help from RLG.  

       'Save files to disk
        FileUpload1.SaveAs(Server.MapPath("../pdf/audits" & FileName))
        'SIGAR Public CMS
        Dim localPath As String = "\\hqdadev01\sigar_cms$\pdf\audits\"
        'SIGAR Dev
        Dim remotePath As String = "\\hqdadev02\sigar_public$\pdf\audits\" 
```

添加了这个来检查。

```
 If Not New System.IO.FileInfo(remotePath + FileName).Exists Then
        File.Copy(localPath + FileName, remotePath + FileName, overwrite)
    End If 
```

# ruby - Rails 应用程序中的 NoMethodError

> ID：13406228
> 
> 赞同：0
> 
> 时间：2012-11-15T21:08:12.133
> 
> 标签：ruby, ruby-on-rails-3, ruby-on-rails-3.2

我是 Rails 新手（使用 3.2.9）并且得到一个 NoMethodError 我不知道如何修复。有人可以帮忙吗？

```
A NoMethodError occurred in trade_plans#update:

undefined method `[]' for false:FalseClass
app/models/trade_plan.rb:96:in `symbol_is_valid' 
```

这是 trade_plan.rb 中的第 96 行：

```
if(data[:last_trade_price_only] == "N/A" || data[:last_trade_price_only].blank?) 
```

任何想法为什么会发生此错误以及如何解决它？

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:19:53.163

这可能是因为您的局部变量`data`具有值`false`而不是`Hash`.

由于您试图调用`[]`对象上的方法`false`，因此它会引发一个`NoMethodError`因为`false`不响应`[]`。

# linux - 在现代编译器中编译狡猾的 Fortran 77 代码

> ID：13406229
> 
> 赞同：4
> 
> 时间：2012-11-15T21:08:14.947
> 
> 标签：linux, ubuntu, fortran

我正在尝试编译一个用 Fortran 77 编写的软件。我应该指出，我对 Fortran 知之甚少，并且真的不想开始修改该软件的代码 - 特别是因为我不确定该软件的许可是什么，我不知道我是否能够重新分发我的修改版本。

代码在 OS X 和 Windows 上使用 g77 编译器编译良好，该编译器（相当容易）可用于这些系统。但是，我无法让它在我的 Ubuntu 发行版上运行，因为我似乎无法再为 Ubuntu 获取 g77，如果我尝试安装它的旧版本，它似乎会破坏我的整个 GCC 安装。我已经尝试使用 gfortran 和 g95 编译代码，但它不适用于以下任何一个：

*   该代码使用实变量作为循环索引（是的，我知道，这是个坏主意）。g95 支持这个`-freal-loops`选项，但 gfortran 不支持。
*   该代码使用实变量来索引数组，gfortran 将支持（带有警告），但 g95 不支持。

谁能建议一种使用现代且易于使用的编译器（例如 g95 或 gfortran）来编译具​​有这两个“狡猾”功能的代码的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T20:29:18.157

将参数传递`-std=legacy`给 gfortran。F95 中删除的功能，如实际循环和数组索引，应该在旧模式下编译（可能带有警告）。

# iphone - ios导航栏背景图片

> ID：13406231
> 
> 赞同：0
> 
> 时间：2012-11-15T21:08:22.180
> 
> 标签：iphone, ios, uinavigationbar

我有以下代码应该在我的导航栏上设置背景图像。

```
 if ([self.navigationController.navigationBar respondsToSelector:@selector(setBackgroundImage:forBarMetrics:)] )
    {
        [self.navigationController.navigationBar setBackgroundImage:[UIImage imageNamed:@"navigation-bar-background"] forBarMetrics:UIBarMetricsDefault];
    }
    else
        NSLog(@"WTF"); 
```

它适用于 iPad，但不适用于 iPhone，在 iPhone 上它记录 WTF ..... 没有 if 语句的相同结果。我的 iPhone 是运行 ios 6.0 的 iPhone 4，iPad 是运行 ios 6.0 的 iPad 2

任何帮助表示赞赏。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T08:11:18.207

你可以试试这个替代的旧方法

```
@implementation UINavigationBar (CustomImage)

- (void)drawRect:(CGRect)rect {
   UIImage *image = [UIImage imageNamed: @"navigation-bar-background.png"];
   [image drawInRect:CGRectMake(0, 0, self.frame.size.width, self.frame.size.height)];
}

@end 
```

# java - 如何在 pom.xml 中设置类路径？

> ID：13406233
> 
> 赞同：6
> 
> 时间：2012-11-15T21:08:29.857
> 
> 标签：java, maven, log4j, pom.xml

使用 运行测试时`maven`，我想在我的屏幕上看到输出。

将文件`log4j.xml`放入我的项目目录（src/test/resources/cfg/）后，我更新`pom`了包含

```
235             <plugin>
236                 <groupId>org.apache.maven.plugins</groupId>
237                 <artifactId>maven-surefire-plugin</artifactId>
238                 <configuration>
239                     <skipTests>false</skipTests>
240                     <excludes>
241                         <exclude>**/*$*.java</exclude>
242                     </excludes>
243                         <systemProperties>
244                            <property>
245                               <name>-Dlog4j.configuration</name>
246                               <value>file:src/test/resources/cfg/log4j.xml</value>
247                            </property>
248                         </systemProperties>
249                     <additionalClasspathElements>
250                         <additionalClasspathElement>src/test/resources/cfg/</additionalClasspathElement>
251                     </additionalClasspathElements>
252                 </configuration>
253             </plugin> 
```

以上不起作用。测试运行时，我仍然看到以下消息

```
log4j:WARN Please initialize the log4j system properly. 
```

为了记录，以下是log4j

```
 1 <?xml version="1.0" encoding="UTF-8" ?>
  2 <!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">
  3 
  4 <log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">
  5   <appender name="console" class="org.apache.log4j.ConsoleAppender">
  6     <param name="Target" value="System.out"/>
  7     <layout class="org.apache.log4j.PatternLayout">
  8       <param name="ConversionPattern" value="%-5p %c{1} - %m%n"/>
  9     </layout>
 10   </appender>
 11 
 12   <root>
 13     <priority value ="debug" />
 14     <appender-ref ref="console" />
 15   </root>
 16 
 17 </log4j:configuration> 
```

**请问我错过了什么？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-15T21:19:20.663

我有几点意见。首先，我建议您将任何与测试相关的 log4j、logback 配置文件直接放在 src/test/resources 中。这样它们总是被添加到类路径中并且它只是工作。

但是，如果您需要将文件放在 src/test/resources/cfg 并希望使用类路径元素，请注意[文档的建议](http://maven.apache.org/plugins/maven-surefire-plugin/examples/configuring-classpath.html)

> 但是，如果必须，您可以使用 additionalClasspathElements 元素将自定义资源/jar 添加到您的类路径。这将被视为绝对文件系统路径，因此您可能需要使用 ${basedir} 或其他结合相对路径的属性。

所以试试：

```
<additionalClasspathElement>${basedir}/src/test/resources/cfg/</additionalClasspathElement> 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-11-15T21:18:17.990

`log4j:WARN Please initialize the log4j system properly.`

如果您不需要使用 log4j，则无需关心此消息。

但是，如果你需要log4j，请在下面添加以下`<dependency>`标签`<dependencies>`

```
<dependency>
   <groupId>log4j</groupId>
   <artifactId>log4j</artifactId>
   <version>1.2.16</version>
</dependency> 
```

# ruby - 构建 Ruby 的正则表达式

> ID：13406234
> 
> 赞同：-1
> 
> 时间：2012-11-15T21:08:32.023
> 
> 标签：ruby, regex

我需要一些关于如何执行以下操作的指导。假设我在 s= {"name":testName,"age":20} 下面有这个字符串

我应该如何在 ruby​​ 中构造我的正则表达式，以便我能够获得“testName”提前谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:10:52.773

您拥有的数据是一个 JSON 字符串。您不应使用正则表达式对其进行解析，而应将其解析为对象，然后访问该`name`属性。

我不是 Ruby 开发人员，但如果你有[JSON gem](https://stackoverflow.com/questions/5410682/parsing-a-json-string-in-ruby) ，你可以这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:13:17.897

我同意 Jason 关于使用 JSON 的观点，但如果你真的不能……

```
1.9.3p194 > s= '{"name":testName,"age":20}'
 => "{\"name\":testName,\"age\":20}" 
1.9.3p194 > s =~ /"name":(.*?)(,"|})/
 => 1 
1.9.3p194 > puts $1
testName 
```

请注意，这是邪恶和错误的，可能会伤害小猫……使用 JSON 来拯救小猫。

# excel - VBA 选择下拉列表中的每个选项

> ID：13406238
> 
> 赞同：3
> 
> 时间：2012-11-15T21:08:35.423
> 
> 标签：excel, vba

更新代码和问题：此表模块中的当前代码如下：

```
Private Sub Worksheet_Change(ByVal Target As Range)
     If Not Intersect(Target, Range("B2:B2")) Is Nothing Then
          Application.Run "MonthlyRead"
     End If
End Sub

Sub MPrintAll()
     Dim c As String
     Dim MonthlyList As Range
     Set MonthlyList = Worksheets("Monthly").Range("MonthlyList").Cells
     For Each cell In MonthlyList
         Range("b2").Value = cell.Value
         ActiveWorkbook.Worksheets("Monthly").PrintOut
     Next cell
End Sub 
```

我一直在单步执行代码，试图找出问题出现在哪里。当我在 "Range("b2").Value = cell.Value" 之后按 F8 时，它会立即转到工作表的第一行代码，完全跳过打印命令。此外，它会删除命名范围中的第一个值，而不是将其复制粘贴到单元格 B2。

作为参考，下面是上面第一个例程调用的 Module1 中的代码：

```
 Sub MonthlyRead()
         Call MEFTPS
         Call MUCT6
    End Sub
    Sub MEFTPS()
         If Range("a2").Value = "EFTPS Package" Then
              Call MShow
              Else: Call MHide
         End If
    End Sub
    Sub MHide()
        Rows("20:20").Select
        Selection.EntireRow.Hidden = True
        Rows("31:31").Select
        Selection.EntireRow.Hidden = True
        Rows("42:42").Select
        Selection.EntireRow.Hidden = True
        Rows("53:53").Select
        Selection.EntireRow.Hidden = True
        Range("B2").Select
    End Sub
    Sub MShow()
        Rows("20:20").Select
        Selection.EntireRow.Hidden = False
        Rows("31:31").Select
        Selection.EntireRow.Hidden = False
        Rows("42:42").Select
        Selection.EntireRow.Hidden = False
        Rows("53:53").Select
        Selection.EntireRow.Hidden = False
        Range("B2").Select
    End Sub
    Sub MUCT6()
        If Range("g3").Value = "Y" Then
             Call UCT6MShow
             Else: Call UCT6MHide
        End If
    End Sub
    Sub UCT6MHide()
        Rows("19:19").Select
        Selection.EntireRow.Hidden = True
        Rows("30:30").Select
        Selection.EntireRow.Hidden = True
        Rows("41:41").Select
        Selection.EntireRow.Hidden = True
        Rows("52:52").Select
        Selection.EntireRow.Hidden = True
        Range("B2").Select
    End Sub
    Sub UCT6MShow()
        Rows("19:19").Select
        Selection.EntireRow.Hidden = False
        Rows("30:30").Select
        Selection.EntireRow.Hidden = False
        Rows("41:41").Select
        Selection.EntireRow.Hidden = False
        Rows("52:52").Select
        Selection.EntireRow.Hidden = False
        Range("B2").Select
    End Sub 
```

* * *

我正在使用一个动态工作表，该工作表根据页面顶部的数据验证下拉列表中的选择填充个性化的付款计划。下拉列表中有大约 300 个选项。然后打印这些时间表，以验证从其他 2 个程序获得的信息，所有这些程序都必须在一天内打印、复印、扫描、打包和邮寄。

我正在寻找可以从列表的开头到结尾依次从下拉列表中选择每个客户端名称的 VBA 代码。该列表是从另一个名为“QtrlyList”的工作表上的命名范围填充的。

我有一些非常简单的代码，这是行不通的。

```
 Sub PrintAll()
        For Each cell In QtrlyList
            Worksheets("Normal").PrintOut
        Next cell
    End Sub 
```

每当我尝试运行代码时，都会收到“类型不匹配”错误。我相当肯定这是来自“cell”或“QtrlyList”。我只是不确定如何解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:53:38.347

像这样的东西可能对你有用（未经测试）

```
Sub PrintAll()

    Dim wb as Workbook, cell as Range

    Set Wb = ActiveWorkbook 'or ThisWorkBook if the code is in your reporting workbook 

    For Each cell In wb.Sheets("SheetNameHere").Range("QtrlyList").Cells
        With wb.Worksheets("Normal")
            'you want to set the value of whichever cell has the drop-down
           .Range("D2")).value=cell.Value
           DoEvents 'allow sheet to pick up changed value
           .PrintOut
        End with
    Next cell

End Sub 
```

# sql-server - 从选择创建一个新表？

> ID：13406245
> 
> 赞同：0
> 
> 时间：2012-11-15T21:08:58.303
> 
> 标签：sql-server

我正在尝试从选择中创建一个新表，但它不起作用。这是我的语法

```
select *
into newtable
from oldtable
where oldtable.number=2 
```

然后，当我尝试使用它时

```
select * from newtable 
```

它告诉我 newtable 是一个无效对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T02:46:18.223

您在正确的数据库中，而不是在主数据库中吗？

试试这个：

```
USE [your database name]
GO

SELECT *
INTO newtable
FROM oldtable
WHERE [number] = 2 
```

如果 newtable 有红色下划线，您仍然可以从中进行选择。下划线仅表示未缓存表名。您可以通过按 CTRL+SHIFT+R 重建 IntelliSense，下划线将消失。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T03:07:49.513

试试这个：

```
insert into newtable
select *
from oldtable
where oldtable.number=2 
```

# regex - URL Guesser 正则表达式优化

> ID：13406246
> 
> 赞同：0
> 
> 时间：2012-11-15T21:09:00.900
> 
> 标签：regex, url, coffeescript

我写了一个相当庞大的正则表达式以在`coffee-script`项目中使用。它旨在获取大量用户文本（消息、帖子、散文）并在其中找到所有潜在的 URL，尽可能贪婪。

```
urlGrabber = ///
  (\s|^)                              # Start after a whitespace or string[0]
  ([a-zA-Z]+\://)?                    # Captures any protocol (just not //)
  (\w+:\w+@)?                         # Username:Password
  ([a-zA-Z\d-]|[a-zA-Z\d-]\.)*        # Subdomains
  [a-zA-Z\d-]{2,}                     # Domain name
  \.                                  # THE DOT
  ([a-zA-Z]{2,4}(:\d+)?)              # Domain Extension with Port
  ([/\?\#][\S/]*)*                    # Some Request, greedy capture
  \b                                  # Last word boundary
  /?                                  # Optional trailing Slash
///g 
```

我遇到了字符串问题，例如`abc.mno.st.u.xvy`where`abs.mno.st`被解析为字符串。这根本不应该被捕获。被捕获的`as.ds.d.`地方也是如此。`as.ds`

谁能解释为什么会发生这种情况和/或帮助解决该问题所需的更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:35:21.853

使用正则表达式模式

```
(?:\s+|^)                                                   # leading spaces
([a-zA-Z]+://|)                                             # protocol
(\w+:\w+@|)                                                 # username:password@
((?:[a-zA-Z\d]+(?:-[a-zA-Z\d]+)*\.)*)                       # subdomain(s)
([a-zA-Z\d]+(?:[a-zA-Z\d]|-(?=[a-zA-Z\d]))*[a-zA-Z\d])      # domain
(\.[a-zA-Z]{2,4})                                           # .top-level-domain
(:\d+|)                                                     # :port
(/\S*|)                                                     # rest of url
(?!\S) 
```

**注意：**子域和域不能以开头和结尾，`-`也不应该有双精度`--`（除非您想支持[Punnycode](http://en.wikipedia.org/wiki/Punycode) for [IDN 域名](http://en.wikipedia.org/wiki/Internationalized_domain_name)）。

# java - 文档。 .isAlive() fails in some browsers I have some java script to check if applet is finished loading before I load the rest of the page. It has worked for years, and now seems to be failing in Firefox 16 and IE 7\. It works 问问题 问问题 2012-11-15T21:09:01.260 509 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I have some java script to check if applet is finished loading before I load the rest of the page. It has worked for years, and now seems to be failing in Firefox 16 and IE 7\. It works in IE 8 Any suggestions on why it has broken and what might fix it?<applet name="env" archive="portal-applet-envir.jar" code="com/deleted/AppletEnvironment.class" height="1" mayscript="true" width="1"></applet>

|  |

You are initialising your counters with the character position: myMap.put(ch, i); where you want: myMap.put(ch, 1); You also want to check the map for an already existing character before you initialise the counter, incrementing the counter of it does (using get(ch) not get(i)), giving: char ch = s.charAt(i); //calculating the occurence of a character in a string. if (myMap.containsKey(ch)){ myMap.put(ch, myMap.get(ch) + 1); } else { myMap.put(ch, 1); }//end of if statement javajavascriptapplet 4 1 回答 1 This answer is useful 1 当document.env.isActive()在小程序初始化之前调用时，FF 会注册一个“没有这样的方法”错误并退出该函数。在调试这些东西时检查错误控制台是值得的。 同样可疑的是 1x1 的小程序大小。有些工具旨在保护用户，这些工具将删除“可疑的小”HTML 元素。 此版本适用于 FF。在 IE 和 FF 中尝试并报告回来。<applet name="env" archive="http://pscode.org/lib/mime.jar" code="org.pscode.mime.MimeType" height="100" mayscript="true" width="600"></applet>

|  |

于 2012-11-16T14:49:50.470 回答 Related 2 php - 你将如何实现私有图像？ 8 c - 用c语言声明没有初始大小的数组 4 java - 将 Java 文件包含到 Coldfusion 中 2 ruby - 如何将一个哈希的键与另一个相交并过滤掉匹配的值？ 5 sql - 如何提高 SQL Server 中日期时间筛选的性能？ 4 c - c语言中的多线程环境 1 ffmpeg - FFMPEG - 显示转换所用的时间 0 eclipse - 没有找到处理 Execution compile-protoc 的市场条目 2 ios - 使用我自己的图像后缀时 iOS 错误的图像大小 4 scala - Scala，虚数的简单表示法（数字） Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：13406247
> 
> 赞同：0
> 
> 时间：
> 
> 标签：java, javascript, applet

I have some java script to check if applet is finished loading before I load the rest of the page. It has worked for years, and now seems to be failing in Firefox 16 and IE 7\. It works in IE 8

Any suggestions on why it has broken and what might fix it?

```
<applet name="env" archive="portal-applet-envir.jar" code="com/deleted/AppletEnvironment.class" height="1" mayscript="true" width="1">
</applet>
<table width="98%" align="center"><tr><td>
<script language="javascript">
function waituntilok() {
   if (document.env.isActive()) {
     doit();
  }
  else {
      var ct = 0;
      while (! document.env.isActive())
      {
      }
     doit();
   }
}
[....]
waituntilok();
</script>
</td></tr></table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T14:49:50.470

当`document.env.isActive()`在小程序初始化之前调用时，FF 会注册一个“没有这样的方法”错误并退出该函数。在调试这些东西时检查错误控制台是值得的。

同样可疑的是 1x1 的小程序大小。有些工具旨在保护用户，这些工具将删除“可疑的小”HTML 元素。

此版本适用于 FF。在 IE 和 FF 中尝试并报告回来。

```
<html>
<body>
<applet
    name="env"
    archive="http://pscode.org/lib/mime.jar"
    code="org.pscode.mime.MimeType"
    height="100"
    mayscript="true"
    width="600">
</applet>
<table width="98%" align="center">
<tr>
<td>
<script language="javascript">
function waituntilok() {
    if (document) {
        alert('document');
    }
    if (document.env) {
        alert('document.env');
    }
    if (document.env.isActive()) {
        doit();
    } else {
        var ct = 0;
        while (! document.env.isActive())
        {
        }
        doit();
    }
}

function doit() {
    alert('Just Do It!');
}

setTimeout('waituntilok()', 15000);
</script>
</td>
</tr>
</table>
</body>
</html> 
```

# ruby-on-rails - 如何让 devise_async 与 Cucumber 一起工作？

> ID：13406248
> 
> 赞同：5
> 
> 时间：2012-11-15T21:09:02.030
> 
> 标签：ruby-on-rails, devise, cucumber

我已经按照自述文件中的[devise_async](https://github.com/mhfs/devise-async)说明进行操作，并且正在滚动 Devise 2.1.2 和延迟作业。在我的黄瓜测试中，作为注册过程的一部分，我不再收到确认电子邮件。作为测试的一部分，我应该做些什么吗？我已经通过在我的测试环境中设置以下内容来设置延迟作业以跳过测试的实际延迟。

```
Delayed::Worker.delay_jobs = false 
```

但即使将此设置为 true，它仍然会失败，尽管速度更慢。如果我删除 devise_async gem 和相关行，一切都会重新焕发生机。

谢谢，格雷姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T00:59:41.033

新版本的 devise-async 会在记录提交到数据库后触发电子邮件。使用 RSpec，默认情况下每个测试都包装在一个事务中。黄瓜也一样吗？在这种情况下，您需要关闭这些测试事务。

这是我用于 RSpec 的内容：http: [//www.denniskuczynski.com/2012/06/22/changeing-individual-test-configuration-based-on-passed-in-options.html](http://www.denniskuczynski.com/2012/06/22/changing-individual-test-configuration-based-on-passed-in-options.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-04T14:39:15.673

您可以关闭黄瓜环境中的事务

看看如何使用：

[https://github.com/cucumber/cucumber/wiki/Browsers-and-Transactions](https://github.com/cucumber/cucumber/wiki/Browsers-and-Transactions)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T17:12:33.303

您是否尝试使用 Delayed::Worker.new.work_off 方法？不确定它是否适用于 Devise async，但它以前适用于我检查电子邮件。

使用此步骤

```
Given /^Jobs are being dispatched$/ do
  Delayed::Worker.new.work_off 
end 
```

并在测试电子邮件之前运行此步骤？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-11T11:04:43.447

如果您将 devise-async 与 sidekiq 一起使用，正如这里的一些评论者所问的那样，解决方案是让测试内联运行工作人员：

```
require 'sidekiq/testing'
Sidekiq::Testing.inline! 
```

见[https://github.com/mperham/sidekiq/wiki/Testing](https://github.com/mperham/sidekiq/wiki/Testing)

# jquery - jQuery将元素滚动到底部

> ID：13406250
> 
> 赞同：9
> 
> 时间：2012-11-15T21:09:12.723
> 
> 标签：jquery, scroll

我在网上能找到的所有信息都告诉我如何将页面滚动到底部或某个元素。

如何使用 jQuery 将样式为“overflow:auto”的特定 div 滚动到底部？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-15T21:10:47.723

是的：

```
$("#container").scrollTop($("#elementToScrollTo").position().top);​ 
```

如果你想顺利进行：

```
$("#container").animate({
    scrollTop: $("#elementToScrollTo").position().top
}, 1000); 
```

在这里，有一个小提琴：http: [//jsfiddle.net/adrianonantua/nxHE8/](http://jsfiddle.net/adrianonantua/nxHE8/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-15T21:16:27.177

*[演示](http://jsbin.com/akivas/1/edit)*

```
var scr = $('#box')[0].scrollHeight;
$('#box').animate({scrollTop: scr},2000); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-29T10:09:54.210

您可以滚动顶部，减去窗口高度并添加元素高度。您的滚动条应该正好到达元素的底部：

```
$( 'body' ).animate( {
    scrollTop: $( '#element' + currentElementId ).offset().top 
    + $( '#element' + currentElementId ).height() 
    - $( window ).height()
}, 1000 ); 
```

# html - Limited range HTML colour picker

> ID：13406252
> 
> 赞同：0
> 
> 时间：2012-11-15T21:09:20.960
> 
> 标签：html, colors

I need to create a colour picker for a site which wouldn't be a problem, but I want to essentially have a slider that picks colours from this range:

![enter image description here](../Images/da0af0c01cebc7b62e29eb76388d41d4.png)

How would I go about this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:25:58.827

我可以想象类似的事情。它可能会使用一些（很多）调整，但这就是它的要点：

```
<!DOCTYPE HTML>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title></title>
    <style type="text/css">
        #color_picker {
            background: #e8f230; /* Old browsers */
            background: -moz-linear-gradient(left, hsla(63,88%,57%,1) 0%, hsla(0,0%,0%,1) 100%); /* FF3.6+ */
            background: -webkit-gradient(linear, left top, right top, color-stop(0%,hsla(63,88%,57%,1)), color-stop(100%,hsla(0,0%,0%,1))); /* Chrome,Safari4+ */
            background: -webkit-linear-gradient(left, hsla(63,88%,57%,1) 0%,hsla(0,0%,0%,1) 100%); /* Chrome10+,Safari5.1+ */
            background: -o-linear-gradient(left, hsla(63,88%,57%,1) 0%,hsla(0,0%,0%,1) 100%); /* Opera 11.10+ */
            background: -ms-linear-gradient(left, hsla(63,88%,57%,1) 0%,hsla(0,0%,0%,1) 100%); /* IE10+ */
            background: linear-gradient(to right, hsla(63,88%,57%,1) 0%,hsla(0,0%,0%,1) 100%); /* W3C */
            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#e8f230', endColorstr='#000000',GradientType=1 ); /* IE6-9 */
            height: 30px;
        }
    </style>
</head>
<body>

<div id="color_picker"></div>

<div id="target">Test</div>

<script>
    var picker = color_picker;
    var result = target;
    picker.onclick = function(e) {
        console.log(e);
        result.style.backgroundColor = "hsl(63, 88%, " + (50 - ((e.offsetX/picker.clientWidth) * 50)) + "%)";
    }
</script>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:14:17.993

If you want straight HTML, you could use the `MAP` tag and pass the relevant value using HTML-GET... Otherwise, a bit of JavaScript perhaps?

Have you actually looked around for existing code?

Here's something: [http://www.w3schools.com/tags/ref_colorpicker.asp](http://www.w3schools.com/tags/ref_colorpicker.asp)

* * *

From comments:

> w3schools is a wrong and misleading site. You shouldn't use it as reference for any sort of language. For PHP, there's the PHP Manual, for JavaScript, there's Mozilla Developer Network (or MDN). See w3fools.com to further understand why you should never use w3schools.

Fair enough. It was simply an example. It's faster to find source code on google than to press the "Ask Question" button on stackoverflow. Here's another: [http://jscolor.com/](http://jscolor.com/) with directly linked LGPL source code. Modify to suit your purposes.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T21:14:45.133

If you can transfer this image into CANVAS, you can pick the color from here.

See:

[Looking for a jQuery plugin to pick a color from an image?](https://stackoverflow.com/questions/8345739/looking-for-a-jquery-plugin-to-pick-a-color-from-an-image)

# javascript - JSF - outputFormat 尝试将参数解析为数字

> ID：13406256
> 
> 赞同：1
> 
> 时间：2012-11-15T21:09:42.863
> 
> 标签：javascript, jsf, localization

尝试使用具有本地化功能的 primefaces 日历。我考虑将 javascript 属性数组添加到相应的语言环境消息属性文件中。

[http://code.google.com/p/primefaces/wiki/PrimeFacesLocales](http://code.google.com/p/primefaces/wiki/PrimeFacesLocales)

```
primefacesLocale=PrimeFaces.locales['de'] = \u007B closeText: 'Schlie\u00DFen', prevText: 'Zur\u00FCck', nextText: 'Weiter', {0} weekHeader: 'Woche', firstDay: 1, isRTL: false, showMonthAfterYear: false, yearSuffix: '', timeOnlyTitle: 'Nur Zeit', timeText: 'Zeit', hourText: 'Stunde', minuteText: 'Minute', secondText: 'Sekunde', currentText: 'Aktuelles Datum', ampm: false, month: 'Monat', week: 'Woche', day: 'Tag', allDayText: 'Ganzer Tag'\u007D; 
```

像这样使用它：

```
<script type="text/javascript">
    <h:outputFormat value="#{msg.primefacesLocale}" escape="false">
        <f:param value="test"/>
    </h:outputFormat>
</script> 
```

*月份和工作日名称应通过 el 函数检索，`test`值仅用于测试*

结果是：

```
java.lang.IllegalArgumentException: can't parse argument number:  closeText: 'Schließen'
    at java.text.MessageFormat.makeFormat(MessageFormat.java:1420)
    at java.text.MessageFormat.applyPattern(MessageFormat.java:479)
    at java.text.MessageFormat.<init>(MessageFormat.java:381)
    at com.sun.faces.renderkit.html_basic.OutputMessageRenderer.encodeEnd(OutputMessageRenderer.java:113) 
```

这里有什么问题？

**编辑：**

使用：`<h:outputText value="#{msg.primefacesLocale}" escape="false">`工作正常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:26:15.860

[`MessageFormat`API](http://docs.oracle.com/javase/6/docs/api/java/text/MessageFormat.html)有一些特殊字符。和。_ `{`_ and表示格式参数索引的开始和结束。这是一个转义字符（就像在字符串中一样）。`}``'``{``}``'``\`

`\u007B`你一开始在那里的那个代表`{`. 实际上应该是用 包围来逃脱的`'`。`\u007D`代表.的结尾也是如此`}`。

```
primefacesLocale=PrimeFaces.locales['de'] = '\u007B' closeText: 'Schlie\u00DFen', prevText: 'Zur\u00FCck', nextText: 'Weiter', {0} weekHeader: 'Woche', firstDay: 1, isRTL: false, showMonthAfterYear: false, yearSuffix: '', timeOnlyTitle: 'Nur Zeit', timeText: 'Zeit', hourText: 'Stunde', minuteText: 'Minute', secondText: 'Sekunde', currentText: 'Aktuelles Datum', ampm: false, month: 'Monat', week: 'Woche', day: 'Tag', allDayText: 'Ganzer Tag''\u007D'; 
```

顺便说一句，您也可以将这些`{`和`}`普通香草放在字符串中。

```
primefacesLocale=PrimeFaces.locales['de'] = '{' closeText: 'Schlie\u00DFen', prevText: 'Zur\u00FCck', nextText: 'Weiter', {0} weekHeader: 'Woche', firstDay: 1, isRTL: false, showMonthAfterYear: false, yearSuffix: '', timeOnlyTitle: 'Nur Zeit', timeText: 'Zeit', hourText: 'Stunde', minuteText: 'Minute', secondText: 'Sekunde', currentText: 'Aktuelles Datum', ampm: false, month: 'Monat', week: 'Woche', day: 'Tag', allDayText: 'Ganzer Tag''}'; 
```

注意：如前所述，`'`是一个转义字符，如果要按原样表示，请使用其中两个。

```
primefacesLocale=PrimeFaces.locales['de'] = '{' closeText: ''Schlie\u00DFen'', prevText: ''Zur\u00FCck'', nextText: ''Weiter'', {0} weekHeader: ''Woche'', firstDay: 1, isRTL: false, showMonthAfterYear: false, yearSuffix: '''', timeOnlyTitle: ''Nur Zeit'', timeText: ''Zeit'', hourText: ''Stunde'', minuteText: ''Minute'', secondText: ''Sekunde'', currentText: ''Aktuelles Datum'', ampm: false, month: ''Monat'', week: ''Woche'', day: ''Tag'', allDayText: ''Ganzer Tag'''}'; 
```

然而，这又是无效的 JSON。字符串键和值应该用双引号引起来（尽管大多数 webbrowsers 都在这个范围内）。

# c# - WebAPI route 404's when there is a trailing space in the URL

> ID：13406265
> 
> 赞同：11
> 
> 时间：2012-11-15T21:10:10.790
> 
> 标签：c#, asp.net, routing, asp.net-web-api, asp.net-mvc-routing

With the default web api route

```
config.Routes.MapHttpRoute(
            name: "API Default",
            routeTemplate: "api/{controller}/{id}",
            defaults: new
                      {
                          id = RouteParameter.Optional
                      }
            ); 
```

and a controller

```
public class TestController : ApiController
{
    [HttpGet]
    public HttpResponseMessage Get(string id)
    {
        return Request.CreateResponse(HttpStatusCode.OK, id);
    }
} 
```

A request to `'api/test/1'`

returns `1`

If for some reason you send a request to `'api/test/1%20'`

the route 404's.

Now this example may seem silly since browsers trim trailing spaces, but

for a route like `'api/{controller}/{id}/{extrastuff}'`

the space in `'1 '` would convert to `'1%20'` and the request will 404 on the route not being found.

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-11-15T21:47:40.043

您的问题与 WebAPI 本身无关，而是 Asp.Net 如何处理某些特定的 url。而 Asp.Net 以非常偏执的方式处理这些 url，所以你需要告诉它[放松](http://msdn.microsoft.com/en-us/library/system.web.configuration.httpruntimesection.relaxedurltofilesystemmapping.aspx)。

将此行添加到您的 web.config 下`system.web`：

```
<httpRuntime relaxedUrlToFileSystemMapping="true" /> 
```

您可以阅读有关此主题的更多信息：

*   [将 Con（COM1、LPT1、NUL 等）放回您的 URL](http://haacked.com/archive/2010/04/29/allowing-reserved-filenames-in-URLs.aspx)

同样在SO上：

*   [“没有找到您要查的资源。” url 末尾有“点”时出错](https://stackoverflow.com/questions/429963/the-resource-cannot-be-found-error-when-there-is-a-dot-at-the-end-of-the-ur/5272936#5272936)
*   [以 %20 结尾的 URL 存在问题](https://stackoverflow.com/questions/1126735/problem-with-a-url-that-ends-with-20)（它描述了不同的上下文，所以我认为这不是真正的重复）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-15T12:57:12.893

将此添加到处理程序

```
 <add name="ExtensionlessUrlHandler-Integrated-4.0-ForApi"
     path="api/*"
     verb="*"
     type="System.Web.Handlers.TransferRequestHandler"
     preCondition="integratedMode,runtimeVersionv4.0" />
    </handlers>
  </system.webServer> 
```

# java - Java Large number of transaction object caching

> ID：13406267
> 
> 赞同：2
> 
> 时间：2012-11-15T21:10:31.690
> 
> 标签：java, caching

I am looking for best solution for caching large amount of simple transactional pojo structure in memory. Transactions happen at oracle database on 3-4 tables by external application. Another application is kind of Business Intelligence type, which based on transactions in database evaluates updated pojos(mapped to table) and applies various business rules.

Hibernate solution relies on transactions on same server; where as in our case transactions happen some where else, and not sure cached objects can be queried.

Question:

1.  Is there oracle jdbc API that would trigger update event on java side?
2.  Which Caching solution would support #1,
3.  Is cached objects can be queried?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-16T00:53:39.523

Oracle 数据库支持 Java 触发器，因此理论上您可以自己实现类似的东西，请参阅[本指南](http://docs.oracle.com/cd/F49540_01/DOC/java.815/a64686/04_call2.htm)。理论上，您的 Java 触发器可以调用您正在使用的任何分布式缓存解决方案的客户端库，以更新或驱逐过时的条目。

Oracle 也有自己的缓存解决方案，称为[Coherence](http://www.oracle.com/technetwork/middleware/coherence/overview/index.html)。它可能内置了这样的集成，或者至少值得一试。搜索“java 分布式缓存”以获取一些替代方案。

据我所知，Hibernate 不支持对存储在其缓存中的对象的查询。

但是，如果您单独缓存整个对象集合，那么有一些库可以让您对这些集合执行类似 SQL 的查询：

*   [LambdaJ](http://code.google.com/p/lambdaj/) - 支持高级查询，但速度不快
*   [CQEngine](http://code.google.com/p/cqengine/) - 支持典型查询，速度极快

顺便说一句，我是 CQEngine 的作者。我喜欢这两个库。但请原谅我对自己的轻微偏见:)

# c# - FluentValidation 使用数据库的唯一名称验证

> ID：13406270
> 
> 赞同：34
> 
> 时间：2012-11-15T21:10:43.743
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-4, fluentvalidation

我有具有名称字段的*类别*模型，并且每个类别名称都必须是唯一的。我已经进行了验证，当我尝试创建新类别时它可以工作，但在尝试编辑它时出现问题。现在它只是检查名称是否存在，当然当我尝试编辑同一类别时它会检查。

模型

```
[Validator(typeof(CategoryValidator))]
public class Category
{
    public int ID { get; set; }
    public string Name { get; set; }
    virtual public ICollection<Image> Images { get; set; }
}

public class CategoryValidator : AbstractValidator<Category>
{
    public CategoryValidator()
    {
        RuleFor(x => x.Name).NotEmpty().WithMessage("Category name is required.").Must(UniqueName).WithMessage("This category name already exists.");
    }

    private bool UniqueName(string name)
    {
        ProjecteDataContext _db = new ProjecteDataContext();
        var category = _db.Categories.Where(x => x.Name.ToLower() == name.ToLower()).SingleOrDefault();

        if (category == null) return true;
        return false;
    }
} 
```

如您所见，我有`UniqueName(string name)`功能，但是如何传递 ID 或其中的整个模型，以便我可以检查它是否与我正在尝试编辑的模型相同，然后通过。我怎么能通过类似的东西`UniqueName(string name, int? id)`？我今天才发现 FluentValidation，但我不知道。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-11-15T21:22:45.783

[谓词验证器（又名 Must）](https://fluentvalidation.net/custom-validators#predicate-validator)有一个重载，它接受带有两个参数（已验证对象和属性值）的谓词。在您的情况下，谓词将具有 type `Func<Category, string, bool>`。因此，只需将`Category`参数添加到您的唯一名称验证方法中：

```
private bool UniqueName(Category category, string name)
{
        ProjecteDataContext _db = new ProjecteDataContext();
        var dbCategory = _db.Categories
                            .Where(x => x.Name.ToLower() == name.ToLower())
                            .SingleOrDefault();

        if (dbCategory == null) 
            return true;

        return dbCategory.ID == category.ID;
} 
```

# javascript - RequireJS 未定义的别名变量

> ID：13406275
> 
> 赞同：1
> 
> 时间：2012-11-15T21:10:53.570
> 
> 标签：javascript, requirejs

因为我需要来自服务器端的重要设置，所以我需要将主文件放在 HTML 文件中。但我现在的问题是别名文件仍然加载，但不能作为变量使用。（也不在 app.js 文件或其他定义的文件中。）所以当我这样做时：（见 HTML 页面的底部）

```
require([
  'jquery'
   'app'
], function($, App) {
   alert($);
   App.initialize();
}); 
```

警报将显示一个未定义的变量，但是当我查看加载的文件时。jQuery 文件已加载。（下划线和主干变量也有同样的问题，但 app 变量没有，只有别名有问题。）你知道如何解决这个问题吗？

```
<html>
<head>
<title>Domain.net</title>

<link rel="stylesheet" href="css/reset.css" />
<link rel="stylesheet" href="css/style.css" />
<script src="js/lib/modernizr.js"></script>

<script src="js/lib/require.js"></script>
<script type="text/javascript">
// Require.js allows us to configure shortcut alias
require.config({
    baseUrl: "js",
    paths: {
        jquery: 'lib/jquery',
        underscore: 'lib/underscore',
        backbone: 'lib/backbone',
        templates: '../templates'
    }
});

define('config', function() {
    return {
        /** My serverside config */
    }
});

//Load the App
require([
    'jquery',
    'app'
], function($, App) {
    alert($);
    App.initialize();
});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:42:00.083

我不确定您使用的是什么版本的 jQuery，但如果不是 1.7 或更高版本，则默认情况下将不支持 amd，这可以解释您为什么会得到`undefined`. 在这种情况下，最好的解决方案是更新它。

或者，尝试在您的配置中添加一个[shim ：](http://requirejs.org/docs/api.html#config-shim)`exports: jQuery`

```
require.config({
    baseUrl: "js",
    paths: {
        jquery: 'lib/jquery',
        underscore: 'lib/underscore',
        backbone: 'lib/backbone',
        templates: '../templates'
    },
    shim: {
        jquery: {
            exports: 'jQuery'
        }
    }
}); 
```

另请注意，您设置服务器端配置的方式容易出现竞争条件，请参阅此[答案](https://stackoverflow.com/questions/9916073/how-to-load-bootstrapped-models-in-backbone-js-while-using-amd-require-js/13160285#13160285)。

# javascript - 如何在 iframe 内容更改时获取它的高度？

> ID：13406279
> 
> 赞同：0
> 
> 时间：2012-11-15T21:11:09.997
> 
> 标签：javascript, jquery, html, css, css-position

我有一个从我的网站加载到页面中的 iframe，我需要根据 iframe 内容的高度将其定位到页面的中心，并且我使用的代码没有任何问题，除了如果内容变小，iframe 内容的高度将永远不会返回低于它的值（如果这有意义的话）。

**js 识别内容高度何时增长，但不识别何时缩小。**

例如，如果我有一个 400px 高的页面，然后某些内容动态更改为 420px，我的代码将识别它是 420px 高，但如果它更改为 350px，例如，我的代码**仍将其视为 420px高**。我该如何解决？

代码：

```
function place()
{
    var w = $(window).width();
    w-=1000;
    w/=2;
    if(w<12)
    w = 12;
    $("#div").css("left",""+w+"px");
    $("#closeDiv").css("left",""+(w-12)+"px");

    var h = $(window).height();
    var ifh = document.getElementById("inner").contentWindow.document.body.scrollHeight;
    document.title = ifh;
    h -= ifh;
    h /= 2;
    if(h < 20)
    h = 20;
    $("#div").css("top",""+h+"px");
    $("#div").css("height",""+ifh+"px");
    $("#closeDiv").css("top",""+(h-12)+"px");
} 
```

文档标题继续显示 420px，即使我知道内容小于那个。同样的问题发生在`.offsetHeight`.

谢谢你的帮助！

**解决方案更新**

好的，所以我在我标记为解决问题的答案中使用了代码，因为我确实使用了它，它帮助我解决了这个问题值得称赞，但这里涉及的实际问题是我有 iframe 的高度设置为容器盒的 100%；一旦我将其设置为 99%，就解决了问题。不知道为什么……但是嘿！

感谢您所有的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:16:52.887

尝试类似：

```
var iHeight;
if ($("iframe").length > 0) iHeight = $($("iframe")[0].contentDocument || $("iframe")[0].contentWindow.document).height(); 
```

虽然好的老式 ele 调用应该可以工作：

```
var iHeight;
if ($("iframe").length > 0) iHeight = $("iframe").height(); 
```

# primefaces - Primefaces 和 liferay：单选不起作用

> ID：13406280
> 
> 赞同：3
> 
> 时间：2012-11-15T21:11:10.793
> 
> 标签：primefaces, liferay

我正在按照[http://www.primefaces.org/showcase/ui/datatableRowSelectionSingle.jsf给出的示例](http://www.primefaces.org/showcase/ui/datatableRowSelectionSingle.jsf)

我将它用作 Liferay 中的一个 portlet。这是我的代码：

**的HTML：**

```
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui">

    <h:form id="form">

        <h:panelGrid columns="1" cellpadding="10" width="100%">

            <p:dataTable id="campaignTable" var="data"
                value="#{campaign.allCampaigns}" selectionMode="single"
                rowKey="#{data.campaignId}" selection="#{campaign.selectedCampaign}">

                <f:facet name="header">  
                    <p:commandButton type="button" value="Create Campaign" icon="ui-icon-document" update=":form:createForm" onclick="createDialog.show()" />

                </f:facet>

                <p:column sortBy="#{data.campaignId}">
                    <f:facet name="header">ID</f:facet>
                    <h:outputText value="#{data.campaignId}" />
                </p:column>

                <p:column sortBy="#{data.carrier}">
                    <f:facet name="header">Carrier</f:facet>
                    <h:outputText value="#{data.carrier}" />
                </p:column>

                <p:column sortBy="#{data.shortCode}">
                    <f:facet name="header">Short Code</f:facet>
                    <h:outputText value="#{data.shortCode}" />
                </p:column>

                <p:column sortBy="#{data.sendType}">
                    <f:facet name="header">Send Type</f:facet>
                    <h:outputText value="#{data.sendType}" />
                </p:column>

                <p:column sortBy="#{data.startDate}">
                    <f:facet name="header">Start Date</f:facet>
                    <h:outputText value="#{data.startDate.time}">
                        <f:convertDateTime pattern="MM/dd/yyyy hh:mm a" />
                    </h:outputText>
                </p:column>

                <p:column sortBy="#{data.endDate}">
                    <f:facet name="header">End Date</f:facet>
                    <h:outputText value="#{data.endDate.time}">
                        <f:convertDateTime pattern="MM/dd/yyyy hh:mm a" />
                    </h:outputText>
                </p:column>

                <p:column sortBy="#{data.messageText}">
                    <f:facet name="header">Text Message</f:facet>
                    <h:outputText value="#{data.messageText}" />
                </p:column>

                <p:column sortBy="#{data.serviceId}">
                    <f:facet name="header">Service ID</f:facet>
                    <h:outputText value="#{data.serviceId}" />
                </p:column>

                <p:column sortBy="#{data.responseKeyword}">
                    <f:facet name="header">Response Keyword</f:facet>
                    <h:outputText value="#{data.responseKeyword}" />
                </p:column>

            </p:dataTable>
        </h:panelGrid>

        <p:dialog id="createDialog" header="Create Campaign" widgetVar="createDialog">

            <h:panelGrid id="createForm" columns="2" cellpadding="5">
                <h:outputLabel for="campaignId" value="Campaign ID:" />
                <p:inputText value="#{campaign.selectedCampaign.campaignId}" id="campaignId" required="true" label="Campaign ID" />

                <h:outputLabel for="startDate" value="Start Date:" />
                <p:inputText value="#{campaign.selectedCampaign.startDate}" id="startDate" required="true" label="Start Date" />

                <f:facet name="footer">
                    <p:commandButton id="createCampaignButton" value="Create" update=":growl" actionListener="#{campaign.createCampaign()}" />
                </f:facet>
            </h:panelGrid>
        </p:dialog>

    </h:form>

</ui:composition> 
```

**和支持bean：**

```
@ManagedBean
@ViewScoped
public class Campaign implements Serializable {

    private List<CampaignBean> allCampaigns;
    private CampaignBean selectedCampaign;

    public Campaign() {
        MyProxy proxy = new MyProxy();
        try {
            CampaignsResponse response = proxy.getAllCampaigns();
            if (response != null) {
                setAllCampaigns(new ArrayList<CampaignBean>(Arrays
                        .asList(response.getCampaigns())));
            }
        } catch (RemoteException e) {
            FacesContext context = FacesContext.getCurrentInstance();
            context.addMessage(null, new FacesMessage("Error",
                    "Problem listing campaigns"));
        }
    }

    public void createCampaign() {

    }

    /* Getters and Setters */
    public List<CampaignBean> getAllCampaigns() {
        return allCampaigns;
    }

    public void setAllCampaigns(List<CampaignBean> allCampaigns) {
        this.allCampaigns = allCampaigns;
    }

    public CampaignBean getSelectedCampaign() {
        return selectedCampaign;
    }

    public void setSelectedCampaign(CampaignBean selectedCampaign) {
        this.selectedCampaign = selectedCampaign;
    }

} 
```

表单未填充选定的行值！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T16:52:52.077

我终于弄清楚了问题所在。整个表格位于“TabView”组件内。我使用了错误的选择器，而不是使用`update=":form:createForm"`我应该使用`update=":tabView:form:createForm"`并删除`type="button"`声明。

# mysql - 将 MySql 中的结果集导出为制表符分隔文件。带有逗号的字符串在字符串周围加上引号，为什么？

> ID：13406281
> 
> 赞同：1
> 
> 时间：2012-11-15T21:11:12.993
> 
> 标签：mysql, excel, export-to-excel

我正在从 MySQL 结果集中进行导出，当我在 Notepad++ 中打开它时，我在 .txt 文件中发现的是，有些字段看起来像这样，`Top Side Panel w/ Bracket, Left`现在看起来像这样`"Top Side Panel w/ Bracket, Left"`，带有额外的引号。

这只发生在带有逗号的字段上。所以它不会出现在同一字段中的记录上，例如：`Rear Baffle`

您如何从 MySQL Query Browser 1.2.17 进行正确的制表符分隔导出，我们没有获得添加的数据！？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:04:39.677

我建议使用[phpMyAdmin](http://www.phpmyadmin.net/home_page/index.php)。它提供了一个导出工具，可以为 MS Excel 导出 csv。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-25T16:03:09.860

您可以使用 MySQL 的 SELECT INTO OUTFILE 语法为您提供一种原生的 MySQL 方式来生成 CSV 或 TSV 文件。此命令使您可以完全控制如何描绘和转义字段。有关文档，请参阅下面的链接。

[http://dev.mysql.com/doc/refman/5.5/en/select-into.html](http://dev.mysql.com/doc/refman/5.5/en/select-into.html)

# python - 我在哪里用 pyshp 附加点值

> ID：13406282
> 
> 赞同：0
> 
> 时间：2012-11-15T21:11:14.553
> 
> 标签：python, loops, point, shapefile

我想使用`shapefile`available through生成一个带有五个点的 .shp `pyshp`。但是，当我遍历我的列表时，我只得到最后一个值。这是有道理的，因为我没有将任何点附加到空列表（例如`new_shp = []`）

```
import shapefile as sf
import os

filename2 = 'test/point10'
lis = [(33.21, -122.15, 'france'), (35.31, -122.15, 'germany'), (35.41, -123.15, 'Hawaii'), (30.51, -122.15, 'Philippines'),(32.30, -122.15, 'Texas')]
for l in lis:
    w = sf.Writer(sf.POINT)
    w.point(l[0], l[1])
    w.field('location')
    w.record(l[2], 'Point')
    w.save(filename2)

# create the PRJ file
prj = open("%s.prj" % filename2, "w")
epsg = 'GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433]]'
prj.write(epsg)
prj.close() 
```

我假设我必须在 for 循环中的某处附加所有点，但我不明白如何实际附加它。我如何有效地循环`lis`获取所有五个点的 .shp 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:59:46.220

要附加到保存文件，我只需要重新排列一些术语。不需要创建空的附加列表。

```
import shapefile as sf
import os

filename2 = 'test/point16'

lis = [(33.21, -122.15, 'france'), (35.31, -122.15, 'germany'), (35.41, -123.15, 'Hawaii'), (30.51, -122.15, 'Philippines'),(32.30, -122.15, 'Texas')]

w = sf.Writer(sf.POINT)
w.field('location')

for l in lis:
    w.point(l[0], l[1])
    w.record(l[2], 'Point')
w.save(filename2)

# create the PRJ file
prj = open("%s.prj" % filename2, "w")
epsg = 'GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433]]'
prj.write(epsg)
prj.close() 
```

# sql - 需要查询以查找可能有 4、5 或 6 个连续数字的行

> ID：13406283
> 
> 赞同：2
> 
> 时间：2012-11-15T21:11:19.853
> 
> 标签：sql

试图提出一个查询，该查询将查找包含 4、5 或 6 个连续数字的行。

例如：表 MyNumbers 包含从 1 到 52 的 6 列数字组合。

克洛姆名称是：nbr1 nbr2 nbr3 nbr4 nbr5 nbr6

第一行包含： 1 5 43 50 51 52

第二行包含：41 42 43 44 45 52 <----- 五个连续数字

第三行包含：8 14 38 39 42 50

第四行包含：1 2 3 4 15 29 <----- 四个连续数字

第五行包含：8 14 24 36 48 51

第六行包含： 1 2 3 4 5 6 <----- 六个连续数字

需要提出一个查询，该查询将基于包含该行中有 4 个或更多连续数字的结果集来查找第 2、4 和 6 行。

我创建了一个数据库，其中包含 52 个（1 到 52）中的 6 个数字的所有可能组合。我想做的是消除具有四个或更多连续数字的行。所以我不确定上面是否能解决问题。对于那些询问的人，我使用的是 sql server 2008 R2。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:20:54.463

Assuming the numbers are always increasing, and not repeating

```
select *
  from mynumbers
 where nbr4 - nbr1 = 3
    or nbr5 - nbr2 = 3
    or nbr6 - nbr3 = 3 
```

I took the liberty of simplifying it to the fact that for a series of 6 consecutive numbers, there must already be a series of 4 consecutive numbers.

# c# - MFC中是否有类似DataGridView的控件

> ID：13406285
> 
> 赞同：0
> 
> 时间：2012-11-15T21:11:31.243
> 
> 标签：c#, c++, .net, winforms, mfc

我想使用 VS 2010 在 MFC 中创建一个数据库应用程序，我想知道 MFC 中是否有任何 [.NET Winforms] DataGridView Like 控件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:17:33.183

您可以查看此[链接](http://msdn.microsoft.com/en-us/library/b1kyh79x.aspx)以了解如何从 WinForms 控件创建 MFC 控件。[这里](http://www.codeproject.com/Questions/122771/DataGridView-VS2008-MFC)也是关于这个问题的讨论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:18:45.190

据我所知，微软没有内置解决方案。你需要自己动手。有一些预先构建的解决方案，但我从未尝试过。

[https://www.google.com/search?q=MFC+datagrid&aq=f&oq=MFC+datagrid](https://www.google.com/search?q=MFC+datagrid&aq=f&oq=MFC+datagrid)

# wpf - 如何设置具有 RelativeSource Self 绑定的文本框的默认文本

> ID：13406286
> 
> 赞同：1
> 
> 时间：2012-11-15T21:11:31.303
> 
> 标签：wpf, xaml, binding

在初始页面加载时，我正在设置它以便表单准备好输入新记录。对于一些自定义数据验证器，我将绑定设置为自身。我的问题是如何将默认文本设置为？

```
<TextBox>
    <TextBox.Text>
        <Binding RelativeSource="{RelativeSource Self}"
                 Path="Text"
                 UpdateSourceTrigger="LostFocus" >
            <Binding.ValidationRules>
                <validators:MyCustomValidators />
            </Binding.ValidationRules>
        </Binding>
    </TextBox.Text>
</TextBox> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T21:13:57.073

Add an event handler on the Loaded or Initialized event, and set the Text there.

```
<TextBox Loaded="TextBox_Loaded_1">
    <TextBox.Text>
        <Binding RelativeSource="{RelativeSource Self}"
                 Path="Text"
                 UpdateSourceTrigger="LostFocus" >
            <Binding.ValidationRules>
                <validators:MyCustomValidators />
            </Binding.ValidationRules>
        </Binding>
    </TextBox.Text>
</TextBox> 
```

And in the code behind :

```
private void TextBox_Loaded_1(object sender, RoutedEventArgs e)
{
    ((TextBox)sender).Text = "Default text";
} 
```

**EDIT:**

XAML only solution :

```
<TextBox>
    <TextBox.Style>
        <Style TargetType="TextBox">
            <Setter Property="Text" Value="Default text" />
        </Style>
    </TextBox.Style>
    <TextBox.Text>
        <Binding RelativeSource="{RelativeSource Self}"
                 Path="Text"
                 UpdateSourceTrigger="LostFocus" >
            <Binding.ValidationRules>
                <validators:MyCustomValidators />
            </Binding.ValidationRules>
        </Binding>
    </TextBox.Text>
</TextBox> 
```

# ios - iOS PopOver 与 Webview

> ID：13406289
> 
> 赞同：1
> 
> 时间：2012-11-15T21:11:40.870
> 
> 标签：ios, webview, popover

我正在尝试构建一个显示 webView 的弹出窗口。到目前为止，我有一个按钮，按下时会生成一个弹出窗口，但不会显示 web 视图。使用 NSlog，我可以看到 viewDidLoad 方法正在触发。这是我到目前为止的代码：

在 popover.h 文件中：@interface PopUpViewController : UIViewController

@property（强，非原子）IBOutlet UIWebView *liveTimingPopUp;

@结尾

在 popover.m 文件中：

```
#import "PopUpViewController.h"

@interface PopUpViewController ()

@end

@implementation PopUpViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    [self loadWebView];

}

- (void) loadWebView
{
    // Do any additional setup after loading the view.
    NSString *fullURL = @"www.google.com";
    NSURL *url = [NSURL URLWithString:fullURL];
    NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];
    [_liveTimingPopUp loadRequest:requestObj];
    [self loadView];

    NSLog(@"PopUpView Fired");
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end 
```

在包含生成弹出框 .h 文件的按钮的控制视图中：

```
#import <UIKit/UIKit.h>

@interface SecondViewController : UIViewController
{
    UIInterfaceOrientation intOr;
    //  APICallsViewController *pendingApiCallsController;

}
@property (strong, nonatomic) IBOutlet UIWebView *liveVideoPage;
- (IBAction)liveTimingButton:(id)sender;
@property (strong, retain) UIPopoverController *popOver; //declare UIPopOver so that you have an object to work with

-(void) loadVideo;
@end 
```

在包含生成 popover .m 文件的按钮的控制视图中：

```
#import "SecondViewController.h"
#import "PopUpViewController.h"

@interface SecondViewController ()

@end

@implementation SecondViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    [self loadVideo];

}

- (void) loadVideo
{
    NSString *fullURL = @"http://192.168.130.230:1935/live/camera.stream/playlist.m3u8";
    NSURL *url = [NSURL URLWithString:fullURL];
    NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];
    [_liveVideoPage loadRequest:requestObj];
}

-(void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
    intOr = self.interfaceOrientation;
    if (intOr == UIInterfaceOrientationPortrait)
    {
        NSLog(@"portrait");

        _liveVideoPage.frame = CGRectMake(10, 100, 600, 550);
    }
    else
    {
        NSLog(@"landscape");

        _liveVideoPage.frame = CGRectMake(200, 100, 600, 550);
    }
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (IBAction)liveTimingButton:(id)sender
{
    if ([_popOver isPopoverVisible]) {
        [_popOver dismissPopoverAnimated:YES];
    }

    else
    {
    PopUpViewController *PUVC = [[PopUpViewController alloc]init];//instantiate ViewController for popOver's content
    _popOver = [[UIPopoverController alloc] /* create Popover*/initWithContentViewController:PUVC]; //fills popover with PopUpViewController
    _popOver.popoverContentSize = CGSizeMake(800, 250);
    [_popOver presentPopoverFromBarButtonItem:sender permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES]; //specifies where the popover is coming from...the liveTiming Bar button
    }
}
@end 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:25:03.257

webview应该从哪里来？VC 没有通过 xib 名称.. 所以出口永远不会下注

# python - python 正则表达式-只有一个元音，但没有其他元音

> ID：13406293
> 
> 赞同：0
> 
> 时间：2012-11-15T21:12:02.553
> 
> 标签：python, regex, for-loop

给定下面的字符串，

```
sentences = "He is a student. She is a teacher. They're students, indeed. Babies sleep much. Tell me the truth. Bell--push it!" 
```

我如何打印“句子”中只包含一个“e”但没有其他元音的单词？所以，基本上，我想要以下内容：

他她告诉我

我下面的代码没有给我想要的东西：

```
for word in sentences.split():
    if re.search(r"\b[^AEIOUaeiou]*[Ee][^AEIOUaeiou]*\b", word):
        print word 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:18:19.120

您已经在拆分单词，因此在正则表达式中使用锚点（而不是单词边界）：

```
>>> for word in sentences.split():
...     if re.search(r"^[^AEIOUaeiou]*[Ee][^AEIOUaeiou]*$", word):
...         print word
He
She
Tell
me
the
>>> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:01:28.697

除非您要使用“仅正则表达式”解决方案，否则其他一些选项可能是：

```
others = set('aiouAIOU')
[w for w in re.split(r"[^\w']", sentence) if w.count('e') == 1 and not others & set(w)] 
```

这将返回匹配单词的列表。这使我得到了下面一个更易读的版本，我可能更愿意在维护情况下遇到它，因为它更容易看到（和调整）分解句子的不同步骤和离散的业务规则：

```
for word in re.split(r"[^\w']", sentence):
    if word.count('e') == 1 and not others & set(word):
        print word 
```

# c# - 将多行文本粘贴到单行文本框中

> ID：13406294
> 
> 赞同：1
> 
> 时间：2012-11-15T21:12:11.067
> 
> 标签：c#, .net, winforms

我有一个单行文本框，当我从多行的记事本中复制一些文本并将它们粘贴到我的文本框中时，只出现第一行文本（这很明显）但是我该如何更改它以便线条在粘贴时自动连接并用空格分隔。我看到我需要修改 textbox_changed 事件，但这会影响该文本框中发生的所有事情，而不仅仅是粘贴事件。您能否为我提供一些代码来处理粘贴事件并忽略所有其他事件.. 谢谢 :)

```
winforms
mouse paste event 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T22:00:21.853

[这](http://www.vcskicks.com/clipboard-textbox.php)是你要找的吗？

*剪贴板事件 C# 中的文本框有许多有用的事件来指示何时采取了某些操作。例如，.NET 文本框有一个事件来指示文本何时更改或用户何时按下键。这些事件允许 C# 开发人员编写与文本框交互的干净代码。遵循相同的原则，我们可以手动实现由剪贴板动作触发的事件，即在文本框中剪切、复制或粘贴文本。.NET Framework 不附带这些事件，但它们并不难实现。2011 年 7 月 5 日更新：增加了对禁止复制、剪切和粘贴事件的支持。自定义文本框 要实现自定义事件，我们将不得不创建自己的文本框用户控件。用户控件将继承 Textbox 类，因为我们想要 .NET 文本框的所有默认行为。创建自定义用户控件还将让我们覆盖 WndProc 函数，该函数处理传递给控件的消息。通过重写该函数，我们可以在允许控件处理它们之前检测消息，例如何时剪切、复制或粘贴文本。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:14:03.963

if you are using .asp webforms you need to change the text mode in your textbox

to SOMETHING LIKE THIS `TextMode="MultiLine" Columns="50" Rows="5"`

in Winforms

```
 textBox1.Multiline = true; 
```

# asp.net - .NET 获得 ThreadStateException

> ID：13406296
> 
> 赞同：1
> 
> 时间：2012-11-15T21:12:13.613
> 
> 标签：asp.net, .net, vb.net

您好，我在以下行出现错误：

```
If Not System.Windows.Clipboard.GetDataObject Is Nothing Then 
```

我相信它在 C# 中看起来像这样

```
if (System.Windows.Clipboard.GetDataObject!=null) { 
```

错误是：

“ThreadStateException：当前线程必须设置为单线程单元 (STA) 模式，然后才能进行 OLE 调用。”

谁能告诉我如何解决这个问题？网上的一些建议提到`<STAThread()> _`了在“main”方法上添加，但是，这是一个 ASP.NET 控制器方法，我尝试在它上面添加它，但没有帮助。有人有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:19:07.110

ASP.NET 并没有真正与 STAThread 相处。

您需要一个额外的任务调度程序以在 STA 模式下运行线程以从操作系统访问您想要的内容

看看[这篇文章](http://blogs.msdn.com/b/pfxteam/archive/2010/04/07/9990421.aspx)，它让我有了这样的想法。

另外，请记住，对您的页面的多个请求可能会搞砸事情，因为您正在与操作系统的剪贴板（在另一个 COM 上下文中运行）进行交互，并发可能存在风险。

你想完成什么，也许有更好的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:22:12.510

不要忘记阅读最后的笔记。

[http://www.telerik.com/community/forums/community-forums/interesting-resources/using-clipboard-class-in-asp-net.aspx](http://www.telerik.com/community/forums/community-forums/interesting-resources/using-clipboard-class-in-asp-net.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T21:24:41.980

这似乎是由 /bin 目录中的过期 dll 引起的。你试过清除它吗？

[http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/2411f889-8e30-4a6d-9e28-8a46e66c0fdb/](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/2411f889-8e30-4a6d-9e28-8a46e66c0fdb/)

[http://www.devnewsgroups.net/windowsforms/t36723-current-thread-must-set-single-thread-apartment-sta.aspx](http://www.devnewsgroups.net/windowsforms/t36723-current-thread-must-set-single-thread-apartment-sta.aspx)

此外，您可以在 Single Apartment Mode 中显式启动一个新线程

```
imports System.Threading

 dim newThread As New Thread(new ThreadStart(AddressOf ThreadMethod))
 newThread.SetApartmentState(ApartmentState.STA);
 newThread.Start();

 'and elsewhere
 Public Sub ThreadMethod()
     If Not System.Windows.Clipboard.GetDataObject Is Nothing Then
        'stuff
     End if
 End Sub 
```

# select - 如何处理 SELECT 查询中列出的备注字段，在 foxpro 9 中？

> ID：13406300
> 
> 赞同：2
> 
> 时间：2012-11-15T21:12:40.510
> 
> 标签：select, foxpro, visual-foxpro

我有一个查询，我需要使用 DISTINCT 关键字，问题是我在选择中的一个字段是 MEMO 类型（因为它的内容很大所以需要这样......）。

```
SELECT distinct customerid, commentdate, commenttext.... 
```

在 FOXPRO 9 中不被接受，因为 commenttext 字段是 f 类型的 Memo！任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:22:18.303

您有几个选择，具体取决于您的需要：

1) 从查询中省略备注字段。2) 使用表达式将备注字段转换为字符。例如，左（评论文本，254）。

您是否真的也尝试将 distinct 应用于备忘录字段？你在这里的实际目标是什么？

添马舰

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:21:16.450

Wrap the memo field in the `SELECT` statement in a function such as `ALLTRIM`.

`SELECT distinct customerid, commentdate, ALLTRIM(commenttext)....`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T14:00:58.347

另一种选择是使用 PHDBase 之类的东西，它是 Visual Foxpro 的文本搜索索引器。它允许对字符列和备注字段进行索引和搜索。而且速度非常快。

# python - 网络资产 - 排除捆绑中的文件

> ID：13406301
> 
> 赞同：1
> 
> 时间：2012-11-15T21:12:44.887
> 
> 标签：python, web-applications, webassets

我有一个目录，想像 Ant 一样排除一些文件，这可以通过网络资产实现吗？

或者如果 bundle 可以采用列表或元组，这似乎不是这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T05:34:35.510

构造`Bundle`函数签名看起来像这样（来自[github 的源代码](https://github.com/miracle2k/webassets/blob/master/src/webassets/bundle.py#L48)）：

```
def __init__(self, *contents, **options): 
```

这意味着可以将内容指定为一系列位置参数，如[文档中的示例所示](http://elsdoerfer.name/files/docs/webassets/bundles.html#bundles)：

```
Bundle('common/inheritance.js', 'portal/js/common.js',
   'portal/js/plot.js', 'portal/js/ticker.js',
   filters='jsmin',
   output='gen/packed.js') 
```

但这也意味着您可以使用 Python 的能力[unpack argument lists](http://docs.python.org/2/tutorial/controlflow.html#unpacking-argument-lists)。从该页面：

> 当参数已经在列表或元组中但需要为需要单独位置参数的函数调用解包时，会发生相反的情况。例如，内置 range() 函数需要单独的开始和停止参数。如果它们不能单独使用，请使用 *-operator 编写函数调用以将参数从列表或元组中解包出来

因此，您可以轻松地将上面的示例编写为：

```
files = ['common/inheritance.js', 'portal/js/common.js', 
         'portal/js/plot.js', 'portal/js/ticker.js']
Bundle(*files, filters='jsmin', output='gen/packed.js') 
```

当然，您可以在捆绑之前将列表过滤/切片/切块以符合您的心意。

# c# - 是否可以编写一个修改用户界面颜色的outlook插件？

> ID：13406306
> 
> 赞同：0
> 
> 时间：2012-11-15T21:12:54.130
> 
> 标签：c#, .net, outlook

我想编写一个 Outlook 插件，当用户打开来自公司外部发件人的电子邮件时，它会更改 Outlook 窗口的颜色。

有人可以告诉如何更改 Outlook 窗口的颜色吗？另外，我需要使用 MAPI 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:17:42.770

就你而言，这是不可能的。

自 2007 年以来，Outlook UI 的颜色由用户的颜色偏好定义（蓝色、银色或黑色，或 2013 年：白色、灰色、深灰色）。没有提供允许加载项更改此设置的 API，更不用说基于每个窗口了。

假设可以将代码注入 Outlook 进程并劫持窗口绘制方法，但这需要您具备大量的逆向工程技能。

# java - 如何使用 iqengines api 将图片加载到服务器

> ID：13406307
> 
> 赞同：1
> 
> 时间：2012-11-15T21:12:58.560
> 
> 标签：java, android, image-recognition

我正在尝试使用 IQ 引擎识别图片，但无法上传图片。有没有人练习使用这个 api 或任何其他来识别图片？我尝试加载位图，使用 Base64，加载图片链接，但并不总是得到 img - 此字段是必需的。最后一个代码示例是

```
 public void postData() {
    // Create a new HttpClient and Post Header
    HttpClient httpclient = new DefaultHttpClient();
    HttpContext localContext = new BasicHttpContext();
    HttpPost httppost = new HttpPost("http://api.iqengines.com/v1.2/query/");
    MultipartEntity entity = new MultipartEntity(
            HttpMultipartMode.BROWSER_COMPATIBLE);

    File file = new File(path);

    try {
        // Add your data

        String time = myTime();
        String m = "api_key" + apiKey + "img" + file.getPath() + "json1"
                + "time_stamp" + time;

        try {
            sign = HmacSha1Signature.calculateRFC2104HMAC(m, secret);
        } catch (InvalidKeyException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (SignatureException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (NoSuchAlgorithmException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
        entity.addPart("api_key", new StringBody(apiKey));
        entity.addPart("api_sig", new StringBody(sign));
        entity.addPart("time_stamp", new StringBody(time));
        entity.addPart("json", new StringBody("1"));
        entity.addPart("img", new FileBody(file));
        httppost.setEntity(entity);

        // Execute HTTP Post Request
        HttpResponse response = httpclient.execute(httppost);

        HttpEntity entity1 = response.getEntity();
        String result = EntityUtils.toString(entity1);
        tv.setText(result);
    } catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
    } catch (IOException e) {
        // TODO Auto-generated catch block
    }
} 
```

谁能告诉它必须是什么，或者给出android上任何其他免费api图像识别的工作示例？

# html - css button right property ignored

> ID：13406309
> 
> 赞同：1
> 
> 时间：2012-11-15T21:13:36.637
> 
> 标签：html, css, firefox

I'm trying to stretch a button across a variable width space so that the ends are anchored to its container edges using the left and right properties like this:

```
<button style="position: absolute; left: 0px; right: 0px;">Test</button> 
```

This works as expected in Chrome, IE, and Safari. The button stretches across the width of the browser window. However, in FireFox/SeaMonkey and Opera, the right property is ignored and the button is just wide enough to hold the caption. Why is that?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:43:34.980

看起来唯一的解决方法是绝对定位一个带有按钮的 div，设置为 100% 宽度。像这样：

```
<body>
  <div style="width: 600px; height: 600px; position: relative;">
    <div style="position: absolute; left: 0px; right: 0px;">
      <button style="width:100%;">Test</button>
    </div>
  </div>
</body> 
```

[这是一个与http://jsbin.com/aweleq/2/edit](http://jsbin.com/aweleq/2/edit)一起玩的实时工作示例

这是一个已知的错误[https://bugzilla.mozilla.org/show_bug.cgi?id=471763](https://bugzilla.mozilla.org/show_bug.cgi?id=471763)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T07:31:35.300

这里的基本问题是是否`<button>`是替换元素。替换元素和非替换元素的规则不同；比较[http://www.w3.org/TR/CSS21/visudet.html#abs-non-replaced-width](http://www.w3.org/TR/CSS21/visudet.html#abs-non-replaced-width)和[http://www.w3.org/TR/CSS21/visudet.html#abs-replaced-width](http://www.w3.org/TR/CSS21/visudet.html#abs-replaced-width)

看起来 Firefox 和 Opera`<button>`在这里被视为替换元素，而您的 IE 和 WebKit 版本则没有。不幸的是，没有任何东西真正定义这个元素是否是一个被替换的元素。

但请注意，WebKit 通常会将规范的这一部分弄错，即使对于肯定是替换元素的东西也是如此。见[https://bugs.webkit.org/show_bug.cgi?id=81863](https://bugs.webkit.org/show_bug.cgi?id=81863)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T21:56:00.953

为什么不在按钮的父元素中定义左右空间并将按钮本身设置为 100% 宽度。我觉得是不是很蠢。

```
<div>
    <button>Test</button>
<div> 
```

```
div {
    padding-left: 40px;
    padding-right: 60px;
}

button {
     width: 100%;
}​ 
```

如果需要，您还可以将它们设置为相对/绝对位置。

​</p>

# c# - Configuration-specific exclude from build for Content items

> ID：13406312
> 
> 赞同：1
> 
> 时间：2012-11-15T21:13:40.863
> 
> 标签：c#, visual-studio-2012, windows-phone

Windows Phone 8, C# project. I have some content files that go into my app package as resources (build type "Content"). Depending on build configuration (Debug vs. Release), I want to exclude some of them from the build process. Can I? There's nothing in the properties window to that effect. However, in C++ projects I can do that to individual source files...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T02:22:19.763

您也可以进入 .csproj 文件并手动编辑它。在那里，您可以为此设置各种属性。即，将此添加到您只想应用于特定构建的任何内容中：
Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' "

示例：
<Content Include="Assets\ReleaseImage.png" Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' " />
<Content Include="Assets\DebugImage.png" Condition= " '$(配置)|$(平台)' == '调试|AnyCPU' " />

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:25:02.563

不是最简单的，但您可以在命令行上运行构建后事件并使用宏来帮助您。

宏 - $(ConfigurationName) 将帮助您进行调试。

[后期构建文档](http://msdn.microsoft.com/en-us/library/ke5z92ks.aspx)

[有用的宏](http://msdn.microsoft.com/en-us/library/42x5kfw4.aspx)

# tfs - TFS Limit Devs from Createing Folders

> ID：13406315
> 
> 赞同：1
> 
> 时间：2012-11-15T21:13:57.527
> 
> 标签：tfs

Source Control at my client's is a mess. Each developer or team decides where in the source code structure they are going to add a project's root folder and the name of that folder. There is no consistancy, and the number of projects (both viable and dead) make it nearly impossible to discern where your desired project is located and whether or not it is a "live" version. I know from experience that there is not enough discipline for an "on your honor" policy of location and naming standards as a solution.

So, I want to create a permissions based "Policy" whereby the dev/dev team needs to come to an administrator to have an appropriately located and named folder created for the root of their project. Once created, the dev/dev team will be assigned rights to created folders underneath the root of their project folder.

However, I am not seeing an appropriate right from the Folder/Properties/Security dialog to allow/deny the ability to create a sub-folder, so I'm not certain how this could be done.

Ideas? Has anyone faced a similar challenge and how did you deal with it in TFS?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:45:38.123

我唯一能想到的是一个[自定义签入策略](http://msdn.microsoft.com/en-us/library/bb668980.aspx)，如果任何待处理的更改是文件夹（可能允许删除/合并状态），除非您的用户名在一组列表中。

我不确定您将如何授予访问权限，也许让某人“批准”创建文件夹，或者将更改提供给搁置集中的“批准”用户并让他们为您签入。

# grails - grails run-app 为域类抛出 NoClassDefFoundError

> ID：13406318
> 
> 赞同：0
> 
> 时间：2012-11-15T21:14:04.967
> 
> 标签：grails, noclassdeffounderror

我正在尝试运行从另一个开发人员继承的 Grails 应用程序。它只有一个域类，我们称之为`foopackage.DomainObject`. 当我编译它时，`.class`会出现一个文件，`target/classes`正如我所期望的那样。但是，当我尝试时`grails run-app`，我得到

```
org.springframework.beans.factory.BeanCreationException: Error 
creating bean with name 'pluginManager' defined in ServletContext 
resource [/WEB-INF/applicationContext.xml]: Invocation of init method 
failed; nested exception is java.lang.NoClassDefFoundError: Could not 
initialize class foopackage.DomainObject 
```

起初我认为这可能是因为`DomainObject`试图在一个损坏的静态初始化程序中与一个不存在的数据库通信，所以我将它减少到只是

```
package foopackage

class DomainObject {} 
```

我仍然得到同样的错误。也许有一些潜在的配置/GORM 问题，但它没有出现在`--stacktrace`. 有什么提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T00:53:09.667

好吧，事实证明它毕竟是静态初始化程序，当我认为我已经排除了我正在编辑错误的文件时。

# class - Python: outside function applying changes to a class object's unique namespace

> ID：13406327
> 
> 赞同：1
> 
> 时间：2012-11-15T21:14:41.863
> 
> 标签：class, namespaces, python-2.6

My question is how to program in Python (2.6) a function that uses a namespace of an object, while the function is defined outside the object/class. In addition, that function should only change the variables in the object's namespace; it should not take over the namespace (because with multiple objects they will all use the same namespace).

My reason for pursuing this, is because I wish to write a very small class, where during construction all necessary functions for future use are already given and subsequent function calls (`self.__call__`) on the object itself can be directly applied.

I realize that this idea is not very pythonic (as they say), and I have thought of various other solutions (such as putting the functions in another class and connecting them), but I can't help but feel that each of these solutions is a lot more work than I would think makes sense.

One simple way that accomplishes what I want is the following:

```
class A:
    def __init__(self, some_dict, func_a):
        self.memory = some_dict
        self.__call__ = func_a

def test_func(obj, some_input):
    if some_input in obj.memory :
        return obj.memory[some_input]
    else :
        obj.memory[some_input] = 0\. # some default value
        return 0.

first_object = A({}, test_func)
print first_object(first_object, '3') 
```

This will work fine, but what aches me is that when I make function calls to the object, I will also have to give the object itself (see the last line). I hope to be able make calls as such:

```
print first_object('3') 
```

So far, my ideas were unsuccesful to avoid this (e.g. copying the function method and link its namespace by `self.__call__.memory = self.memory`). I wish to find something to change the `def __init__` part to 'adopt' a function and link their namespaces.

I have rigorously searched for an answer on the internet, but a definite solution has not yet been found. The following [http://www.velocityreviews.com/forums/t738476-inserting-class-namespace-into-method-scope.html](http://www.velocityreviews.com/forums/t738476-inserting-class-namespace-into-method-scope.html) seeks the same, but is also not succesfull.

Anyone have a solution to tackle this?

# javascript - How do I hide all lists other than the selected list?

> ID：13406328
> 
> 赞同：1
> 
> 时间：2012-11-15T21:14:42.533
> 
> 标签：javascript, jquery, html, html-lists

I'm trying to create a sortable list with jQuery UI, My code appears to work, but I want to add a drop down to each list to set an active for the clicked list.

How do I change this so, when selected, the selected sublist should be shown and the others should be hidden?

Relevant [JSFiddle](http://jsfiddle.net/lgtsfiddler/AuRe9/2/).

Relevant HTML:

```
<!doctype html>
 <html lang="en">
<head>
    <meta charset="utf-8" />
    <title>jQuery UI Sortable - Default functionality</title>
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.9.1/themes/base/jquery-ui.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.js"></script>
    <script src="http://code.jquery.com/ui/1.9.1/jquery-ui.js"></script>
</head>
<body>

<ul id="sortable">
<li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>
   <a href="#">Item 1</a>
            <ul class="subnav">
                <li><a href="#">Sub Item 1</a></li>
                <li><a href="#">Sub Item 2</a></li>
                <li><a href="#">Sub Item 3</a></li>
            </ul>

</li>
    <li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 3</li>
    <li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 4</li>
    <li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 5</li>

</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-01T14:31:11.180

`.ui-sortable-helper`开始拖动`li`元素时添加该类。因此，使用这个简单的 css，您只能在拖动元素时显示子类：

```
#sortable .subnav {display: none;}
#sortable>li.ui-sortable-helper .subnav {display: block;} 
```

查看[更新的小提琴](http://jsfiddle.net/AuRe9/13/)

# javascript - jquery选择具有类的父类的第一个孩子

> ID：13406332
> 
> 赞同：32
> 
> 时间：2012-11-15T21:14:51.217
> 
> 标签：javascript, jquery, jquery-selectors

出于以下目的，我如何仅选择具有特定类的父类的特定类的第一个孩子`clone()`？

```
<div class="sector_order">

    <div class="line_item_wrapper">
    SELECT THIS DIV
    </div>

    <div class="line_item_wrapper">
    NOT THIS DIV
    </div>

</div> 
```

我正在尝试这样：

```
var form1 = $(this)
    .parents('.sector_order')
    .children('.line_item_wrapper')
    .children().clone(true) 
```

并使用 class 获取两个内部 div `line_item_wrapper`，但是当我尝试使用此添加时，我得到一个空对象：

```
children('.line_item_wrapper :first') 
```

谢谢！

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-11-15T21:35:02.220

你的问题是你的选择器是错误的，在几个方面：

`parents()`返回与传递给方法的选择器匹配的一个、两个或多个元素；将自己限制为使用第一个匹配的元素`closest()`（返回一个或不返回与传入选择器匹配的元素）。

您第一次使用该`children()`方法会返回两个元素，因为它们*都*匹配提供的选择器并且具有 ; 类`line_item_wrapper`。您需要明确说明您想要两者中的哪一个，您可以使用`:first`选择器（或`first()`方法）或`:first-child`选择器。

对该方法的第二次调用会找到与选择器匹配的第一个元素的子元素，这*似乎*`children()`是您不想要的。

 *无论如何，如果您必须使用父级（从同一个`$(this)`元素开始）：

```
var form1 = $(this).closest('.sector_order').find('.line_item_wrapper:first').clone(true); 
```

或者：

```
var form1 = $(this).closest('.sector_order').find('.line_item_wrapper').first().clone(true); 
```

或者：

```
var form1 = $(this).closest('.sector_order').find('.line_item_wrapper:first-child').clone(true); 
```

或者，坦率地说，一种更简单的方法（但这确实省去了父类名检查）：

```
var form1 = $(this).prevAll('.line_item_wrapper:last'); 
```

或者：

```
var form1 = $(this).siblings('.line_item_wrapper').eq(0); 
```

参考：

*   [`closest()`](http://api.jquery.com/closest/).
*   [`eq()`](http://api.jquery.com/eq/).
*   [`find()`](http://api.jquery.com/find/).
*   [`:first`](http://api.jquery.com/first-selector/).
*   [`:first-child`](http://api.jquery.com/first-child-selector/).
*   [`first()`](http://api.jquery.com/first/).
*   [`:last`](http://api.jquery.com/last-selector/).
*   [`parents()`](http://api.jquery.com/parents/).
*   [`prevAll()`](http://api.jquery.com/prevAll/).
*   [`siblings()`](http://api.jquery.com/siblings/).

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-15T21:17:16.677

您将无效的选择器传递给`children()`. 代替

```
.children('.line_item_wrapper :first') 
```

尝试

```
.children('.line_item_wrapper').first() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-15T21:17:34.377

采用`:first-child`

```
var form1 = $(this).closest('.sector_order').find(':first-child'); 
```

或者`.first()`

```
var form1 = $(this).closest('.sector_order').find('.line_item_wrapper').first(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-15T21:15:59.660

试试这个：

```
var $firstDiv = $(".sector_order > .line_item_wrapper:eq(0)"); 
```

`sector_order`这将使您成为 class的第一个直系后代`line_item_wrapper`。

[**示例小提琴**](http://jsfiddle.net/2G4GY/)*

# css - Styling body element in fullscreen?

> ID：13406334
> 
> 赞同：9
> 
> 时间：2012-11-15T21:14:58.717
> 
> 标签：css, html, fullscreen

My site has a tiling background image applied, which can be seen behind photos as they transition (most photos fill the background). Have a look here: [http://new.element17.com](http://new.element17.com).

When viewed in fullscreen, though (using the button in the top-right in Chrome/Mozilla), this background image disappears and the background is then just `#fff`. How can I style this?

Based on some reading, I've tried the following:

```
body:-webkit-full-screen {background-image:url(../images/olive.jpg);}
body:-moz-full-screen {background-image:url(../images/olive.jpg);}
body:-ms-full-screen {background-image:url(../images/olive.jpg);}
body:-o-full-screen {background-image:url(../images/olive.jpg);}
body:full-screen {background-image:url(../images/olive.jpg);} 
```

But this doesn't result in any change. Any ideas?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-22T01:52:25.303

我很确定如果您让某个元素进入全屏模式，而不是在文档对象上执行此操作，那么您可以从那里开始设置样式。

您需要在`requestFullScreen`要制作全屏的元素上触发该方法。在这种情况下，它是根`html`元素。这是我在需要时拼凑起来的方法：

```
function enter_full_screen(){
    elem    = document.getElementsByTagName('html')[0];
    calls   = ['requestFullScreen','webkitRequestFullScreen','mozRequestFullScreen'];

    for(var i = 0; i < calls.length; i++){
        if(elem[calls[i]]){
            elem[calls[i]]();
            return;
        }
    }
} 
```

然后样式将变为：

```
:-webkit-full-screen body {background-image:url(../images/olive.jpg);}
:-moz-full-screen body {background-image:url(../images/olive.jpg);}
:full-screen body {background-image:url(../images/olive.jpg);} 
```

我整理了一个快速示例页面，展示了这一点：[示例](https://dl.dropbox.com/u/6291374/scratch/2012-11-22.html)（只需使用退出键退出全屏 - 我没有使用退出按钮）

另外，根据[MDN docs](https://developer.mozilla.org/en-US/docs/DOM/Using_fullscreen_mode) on fullscreen mode，没有IE版本支持全屏模式，Opera使用无前缀版本触发，但不支持伪类。如果您想完全支持 Opera，您可能需要考虑在进入全屏时手动向`html`or元素添加一个类，并在退出时将其删除。`body`

另一个有趣[的事实：文档](https://developer.mozilla.org/en-US/docs/CSS/:fullscreen#Browser_notes)说 Gecko 和 Webkit 使用（前缀）`:full-screen`作为伪类，但实际的 W3C 提案使用`:fullscreen`- 单词之间没有破折号。为了安全起见，我都用过...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T01:28:51.577

我想得到你想要的，添加你的背景，`#slideshow`因为这是`div`全屏时的容器。

```
#slideshow {
    background: url("../images/olive.jpg") repeat scroll 0 0 transparent;
} 
```

# objective-c - XCode - UIScrollView Paging Not Showing SubView (Auto Layout?)

> ID：13406335
> 
> 赞同：1
> 
> 时间：2012-11-15T21:15:13.920
> 
> 标签：objective-c, ios, xcode, uiscrollview, autolayout

I had made a previous project that used UIScrollView with Paging, but with this new project, I have been banging my head over this and can't get it working. I think the problem may possibly lay with AutoLayout. At first I couldn't get the paging motion to even work until I realized that all the initialization has to be done in viewDidAppear instead of ViewDidLoad.

Now that I have the action of paging done, the subView don't load! It will just push the current view I setup in Storyboard out of the way and just shows the blank background.

Note that the code here is almost identical to the my previous project, yet I can't get the 2nd view (page 2) to show up.

Here is some of the code:

```
- (void)viewDidAppear:(BOOL)animated{
self.scrollView.delegate = self;
// view controllers are created lazily
// in the meantime, load the array with placeholders which will be replaced on demand
NSMutableArray *controllers = [[NSMutableArray alloc] init];
for (unsigned i = 0; i < kNumberOfPages; i++)
{
    [controllers addObject:[NSNull null]];
}
self.viewControllers = controllers;

// a page is the width of the scroll view
scrollView.pagingEnabled = YES;
scrollView.contentSize = CGSizeMake(scrollView.frame.size.width * kNumberOfPages, (scrollView.frame.size.height - 50));
scrollView.showsHorizontalScrollIndicator = NO;
scrollView.showsVerticalScrollIndicator = NO;
scrollView.scrollsToTop = NO;
scrollView.delegate = self;

pageControl.numberOfPages = kNumberOfPages;
pageControl.currentPage = 0;

// pages are created on demand
// load the visible page
// load the page on either side to avoid flashes when the user starts scrolling
//
[self loadScrollViewWithPage:1];
}

- (void)loadScrollViewWithPage:(int)page
{
if (page <= 0)
    return;
if (page >= kNumberOfPages)
    return;

PageOneViewController *controller = [viewControllers objectAtIndex:1];

if ((NSNull *)controller == [NSNull null])
{
    if(page == 1)
    {

        controller = [[PageOneViewController alloc] initWithRequestNumber: @"100" forID:self.idNumberFromLogin];
        [viewControllers replaceObjectAtIndex:page withObject:controller];
        CGRect frame = scrollView.frame;
        frame.origin.x = frame.size.width * 1;
        frame.origin.y = 0;
        controller.view.frame = frame;
        [scrollView addSubview:controller.view];
    }
}

} 
```

In the PageOneViewController

```
 - (id)initWithRequestNumber:(NSString *)requestID forID: (NSString *) employeeID
{

   if (self = [super initWithNibName:@"OpenRequestCommView" bundle:nil])
   {

   }

   return self;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T01:11:27.490

您可能在情节提要上启用了自动布局。

您可以通过在情节提要中选择文件检查器并取消选中“使用自动布局”来禁用自动布局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-12T13:29:30.870

您需要将此代码放入您的 .m

```
#define IS_WIDESCREEN ( fabs( ( double )[ [ UIScreen mainScreen ] bounds ].size.height - ( double )568 ) < DBL_EPSILON ) 
```

后

为此更新您的代码

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    if (IS_WIDESCREEN) {

        self.meuScroll.frame = CGRectMake(0, 0, 320, 468);

    } else {

        self.meuScroll.frame = CGRectMake(0, 0, 320, 380);

    }
}

- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];
    if (IS_WIDESCREEN) {

        self.meuScroll.contentSize = CGSizeMake(320, 468);

    } else {

        self.meuScroll.contentSize = CGSizeMake(320, 380);

    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-18T07:09:56.790

上述问题中的代码是基于 Apple 提供的使用 UIScrollView 进行分页的示例代码构建的。我在我的应用程序中使用了相同的代码，并花了几个小时阅读教程、堆栈溢出问题和示例代码，但没有什么可以解决其滚动视图的自动布局问题。事实证明，您只需要在返回 scrollView 作为控制器视图的方法中添加一行代码。（这是示例代码中的 PhoneContentController 类）

```
- (UIView *)view
{
    [self.scrollView setTranslatesAutoresizingMaskIntoConstraints:YES];
    return self.scrollView;
} 
```

# silverlight - WP7 Linq-to-sql query with relation not working

> ID：13406336
> 
> 赞同：1
> 
> 时间：2012-11-15T21:15:24.887
> 
> 标签：silverlight, windows-phone-7, linq-to-sql, relation

i have 2 tables: Item and Category with fields (pseudo code):

```
Item
----------
int ItemId
Category Category
(etc...)

Category
----------
string Name
bool IsSelected
(etc...) 
```

I would like to retrieve from DB all Items where category has flag IsSelected = true.

For testing first I create Items:

```
Category category = new Category() { Name = "test_name", IsSelected = true };
db.CategoriesTable.InsertOnSubmit(category);
db.SubmitChanges();
for(int i = 0; i < 10; i++) {
    Item item = new Item() { Category = category };
    db.ItemsTable.InsertOnSubmit(item);
}
db.SubmitChanges(); 
```

Now I have 10 Items with category with IsSelected = true.

When I want to retrieve all Items with category with IsSelected == true, I write:

```
Array<Item> items = ItemsTable.Where(f => f.Category.IsSelected).ToArray(); 
```

And I expected 10 items, but I got only 1 item - the first one! Why? I checked data in table and every item has the same category, so I guess that query is wrong...

# ruby-on-rails-3 - RMagick - 在不泄漏内存的情况下创建缩略图的正确方法

> ID：13406343
> 
> 赞同：0
> 
> 时间：2012-11-15T21:15:47.003
> 
> 标签：ruby-on-rails-3, passenger, rmagick

我正在使用 RMagick 在 Rails 3 应用程序（在乘客上运行）中进行一些相当简单的图像处理。尽管使用了破坏，但我在尝试控制相关的内存泄漏时却遇到了可怕的经历！方法。需要注意的重要一点是，传入的图像可能是透明的 PNG，我希望它们在白色背景上，而不是 RMagick 使用的默认黑色。其他可能是 PDF，在这种情况下，我想使用第一页。

当前调整 3.6MB JPEG 的大小会导致 110MB 内存泄漏。

那么，是否有人能够查看我的样本并可能发现我出错的地方：

```
 path = 'some/path'
    page_id = "0" 
    in_doc_o = nil
    begin
      in_doc_o = ImageList.new(path+"[#{page_id}]")
      # Create a white background layer
      in_doc_temp = in_doc_o.new_image(in_doc_o.first.columns, in_doc_o.first.rows) { self.background_color = "white" } 
      in_doc = in_doc_o.reverse.flatten_images
      in_doc.format = "jpg"
    rescue
      # Something went wrong so create a dummy 'error' image
      in_doc = ImageList.new("public/images/doc.jpg"+"[#{page_id}]")
    end

    in_doc.change_geometry!('600x200>') { |cols, rows, img| img.resize!(cols, rows) }

    out_blob = in_doc.to_blob() { self.quality = 60 }
    res = save_to_special_storage_device(out_blob)
    mime_type = in_doc.mime_type

    begin        
      in_doc.each {|img| img.destroy!}
    rescue=>e
      Rails.logger.info "rescued attempting destroy on in_doc image list #{e.inspect}"
    end
    begin        
      in_doc_o.each {|img| img.destroy!}
    rescue=>e
      Rails.logger.info "rescued attempting destroy on in_doc_o image list #{e.inspect}"
    end        
    begin
      in_doc.destroy!          
      in_doc_o.destroy! unless in_doc_o.nil?
      in_doc = nil          
      in_doc_o = nil
      in_doc_temp.destroy! if in_doc_temp
      in_doc_temp = nil
    rescue
      Rails.logger.info "rescued attempting image cleanups"
    end
    GC.start 
```

我猜我可以通过预先识别PNG而不是创建空白的白色图像来节省一些问题，但代价是更多的代码，但在测试中我仍然泄漏60MB，这表明我想解决一个基本问题.

奇怪的是，如果我用大约相同大小的另一张图像重新运行测试，内存使用量第二次不会显着增加（幸运的是）。

任何合理的想法都会受到赞赏，尤其是考虑到我可以节省多少内存。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:42:40.353

试试 minimagic，它是为解决您遇到的问题而编写的。

对于大多数任务，[此处链接的 minimagic gem](https://github.com/minimagic/minimagick)就足够了。它运行 ImageMagick 的命令行工具，这意味着一个新进程被创建，它运行，然后停止，释放内存。我们用 MiniMagic 取代了 RMagic，我们的记忆问题已经成为过去。

# java - The Grinder agent fails to communicate with Console with more than a few workers

> ID：13406345
> 
> 赞同：4
> 
> 时间：2012-11-15T21:15:52.213
> 
> 标签：java, jython, load-testing, grinder

I've just started playing with the Grinder (love it!) but have encountered some curious behavior, as follows:

I had been using 5 workers to parse tweet text and send them to the URL I am load testing. Grinder was working without a hitch but I noticed that Python urlencode was failing on some of the unicode or latin encoded stuff (i.e. some threads were dying an untimely death as a result).

I thought, since Jython is really Java under the hood, that I would try using java.net.URLEncoder on suspect strings and see how it behaved.

So at the top of my Jython script I added

```
from java.net import URLEncoder 
```

and wrapped the python urlencode in a try/catch which fell back on UrlEncoder.encode(myString,'UTF-8')

And it seemed to work flawlessly when I tested it using one worker. But once I upped the number of workers above 2 or 3, the workers would start, but then fail to communicate with Console, throwing the following error after an unreasonably long load time:

```
2012-11-15 15:59:04,287 ERROR worker-bootstrap: Error running worker process
net.grinder.communication.CommunicationException: Exception whilst sending message
    at net.grinder.communication.AbstractSender.send(AbstractSender.java:57) ~[grinder-core-3.11.jar:na]
    at net.grinder.communication.QueuedSenderDecorator.flush(QueuedSenderDecorator.java:60) ~[grinder-core-3.11.jar:na]
    at net.grinder.engine.process.GrinderProcess.sendStatusMessage(GrinderProcess.java:638) ~[grinder-core-3.11.jar:na]
    at net.grinder.engine.process.GrinderProcess.run(GrinderProcess.java:430) ~[grinder-core-3.11.jar:na]
    at net.grinder.engine.process.WorkerProcessEntryPoint.run(WorkerProcessEntryPoint.java:86) [grinder-core-3.11.jar:na]
    at net.grinder.engine.process.WorkerProcessEntryPoint.main(WorkerProcessEntryPoint.java:59) [grinder-core-3.11.jar:na]
Caused by: java.net.SocketException: Broken pipe
    at java.net.SocketOutputStream.socketWrite0(Native Method) ~[na:1.6.0_37]
    at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92) ~[na:1.6.0_37]
    at java.net.SocketOutputStream.write(SocketOutputStream.java:136) ~[na:1.6.0_37]
    at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65) ~[na:1.6.0_37]
    at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123) ~[na:1.6.0_37]
    at java.io.ObjectOutputStream$BlockDataOutputStream.flush(ObjectOutputStream.java:1793) ~[na:1.6.0_37]
    at java.io.ObjectOutputStream.flush(ObjectOutputStream.java:699) ~[na:1.6.0_37]
    at net.grinder.communication.AbstractSender.writeMessageToStream(AbstractSender.java:90) ~[grinder-core-3.11.jar:na]
    at net.grinder.communication.StreamSender.writeMessage(StreamSender.java:70) ~[grinder-core-3.11.jar:na]
    at net.grinder.communication.AbstractSender.send(AbstractSender.java:53) ~[grinder-core-3.11.jar:na]
    ... 5 common frames omitted 
```

This looks essentially like a timeout to me (broken pipe, implying I guess that either Console got tired of listening or Agent got tired of trying to connect). But I'm not sure why. (Nor am I sure how I feel about seeing the word "whilst" in an exception. Strewth, Hacker! Didst thou ne'er see sinister leaks of memory? )

As far as the code problem at hand, I can do better then the (currently implemented) default behavior of Python urlencode - I do know a few tricks for improving on this but they tend to get messy and I'm kind of guessing that some of them are not going to work in Jython.

But I'm curious on a general level here. Java URLEncode works just fine - on 3 workers or fewer -- so why should it fail given more workers?

Guesses:

Am I running out of system resources?

*   Horrors - is each worker creating its *own* JVM?

    Well, checked, and yes, it is, as it turns out. but this didn't stop things previously. why now? I have 2 processors in my mac - I would think if this were the problem, we should fail at 3 workers, but, nope. 4 or 5, yep.

Is using native Java libraries in Jython, for some reason, NOT a good idea?

Insights appreciated.

Thanks JB

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-01T05:41:46.510

我不确定这是否适用于您的情况，但请尝试像这样运行磨床代理。

```
java net.grinder.Grinder -daemon 2 
```

该命令的作用是，当磨床无法连接到控制台或由于某种原因失去连接时，它会休眠一段时间并运行尝试重新连接。我有预感，这可能会解决你的问题。

这方面的文档非常少，但这是我得到这个的来源。

[http://grinder.sourceforge.net/g3/agents-and-workers.html](http://grinder.sourceforge.net/g3/agents-and-workers.html)

# objective-c - 有没有办法将数据从块保存到ios obj-c中的属性或外部对象

> ID：13406346
> 
> 赞同：0
> 
> 时间：2012-11-15T21:15:58.397
> 
> 标签：objective-c, ios, ios5, ios4

我为异步 http 请求处理设计了一个类“AsyncHttpRequest”，并且类初始化程序将一个块作为参数。

该块是从“AsyncHttpRequest”类的以下委托实现中调用的：

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection {

   NSDictionary *dict = [NSJSONSerialization
        JSONObjectWithData:_dataResponseData //1
                   options:kNilOptions
                     error:&error];

   myBlock(dict); 
```

}

我正在从视图控制器创建上述类的实例，如下所示

```
- (void)viewDidLoad {
    [super viewDidLoad];
__block NSDictionary *myDic; 

AsyncHttpRequest *r = [[AsyncHttpRequest alloc] initWithUrl:urlStr withBlock:^(NSDictionary *d){

        NSLog(@"List = %@",d);  //Its working
        NSDictionary *locDic = [[NSDictionary alloc] initWithDictionary:d]; 
         // the above is working

        myDic = d; //not working

        myDic = [[NSDictionary alloc] initWithDictionary:locDic]; 
            // The above code is not working..   
     }];
} 
```

它给出以下错误：错误：地址不包含指向目标文件中的部分的部分

有没有办法将数据从块保存到 obj-c 中的属性或外部对象？

谢谢....我在过去 3 个小时里一直在尝试这个，但没有得到任何解决方案。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:06:08.407

我认为它有可能在`myDic`被使用之前被释放。

这是我的推理，`-[AsyncHttpRequest initWithUrl:withBlock:]`捕获块，但`myDic`不保留。在将来的某个时候，该`connectionDidFinishLoading`方法被调用，但到那时该`myDic`变量现在已经超出范围，因为它已被释放。

说得通？

如果是这种情况，那么可能的解决方案可能包括：

*   `myDic`在将其传递给方法之前保留`-[AsyncHttpRequest initWithUrl:withBlock:]`。注意：`myDic`应该是一个实例变量/
*   在 上创建一个`NSDictionary`属性`AsyncHttpRequest`并将该属性设置为`myDic`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:26:35.203

我找到了解决方案。

如果从委托方法实现中调用块，则它给出错误。

在我的例子中，

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection { 
   ............
   ....... 
   myBlock(...);
 } 
```

是 NSURLConnectionDataDelegate 的一个实现，我已经从上述方法内部调用了 block 函数。

它给出了意想不到的结果，即在块函数之外声明的任何变量或对象（属性或实例变量）都不能从块内访问。例如，

```
__block NSDictionary *myDic; 

AsyncHttpRequest *r = [[AsyncHttpRequest alloc] initWithUrl:urlStr withBlock:^(NSDictionary *d){
    NSLog(@"List = %@",d);  //Its working
    NSLog(@"List = %@",myDic); //not working

 }]; 
```

在上面的代码中，myDic 在块外声明，访问它会产生运行时错误。

有人在不理解我的问题的情况下否决了我的问题，如果有人说对了，我将非常感激。

谢谢....

# sql - SQL Server : select from a table containing &

> ID：13406350
> 
> 赞同：0
> 
> 时间：2012-11-15T21:16:08.147
> 
> 标签：sql, sql-server, vb.net, ampersand

I'm unable to select from a table that contains & (ampersand). I'm querying the SQL Server database using VB.NET, the exception it throws is

> *incorrect syntax near '&'*

Here's the code I'm using:

```
Using Com As New SqlCommand("SELECT * FROM Appointments&Results", Conn)
Using RDR = Com.ExecuteReader()
    If RDR.HasRows Then
        Do While RDR.Read
        'Get values here
        Loop
    End If
End Using
End Using 
```

And here are queries that I've tried:

```
SELECT * FROM `Appointments&Results`
SELECT * FROM 'Appointments&Results'
SELECT * FROM `Appointments&&Results`
SELECT * FROM `Appointments&amp;Results` 
```

Any ideas?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-15T21:17:29.260

```
SELECT * FROM [Appointments&Results] 
```

这回答了你的问题。

**我的**问题是，世界上谁用 & 号 ( `&`) 命名了这个表？！

# c++ - segfault on removal from first node in linked list

> ID：13406353
> 
> 赞同：0
> 
> 时间：2012-11-15T21:16:20.857
> 
> 标签：c++, linked-list

The remove function for my singly linked chain does not work when I remove the very first node. Say I have {33,40,50} when I try and remove 33 i get a segfault, but the other two work fine. I think I just need some fresh eyes to see what i messed up in my remove function.

remove function

```
bool Set::remove(int X)
{
        bool Flag = false;
        Node * Prev = Head;
        Node * Curr = Head->Succ;
        //unsigned Z = 0;

        while(Curr->Item != X)
        {
                Prev = Curr;
                Curr = Curr->Succ;
        }
        Prev->Succ =Curr->Succ;
        delete Curr;
        Num--;
        Flag = true;
        return Flag;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:20:36.340

I think its because you start with `Curr = Head->Succ` which is already past 33(`Curr->item` is 40). You are also never checking to see if its at the end of the list. So you're accessing memory that is out of bounds.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:21:03.073

You should check whether you went through the end of the list.

And you should start on the first element rather than the second (which, in this case, causes you to go through the list and try to continue further).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T21:21:49.943

You are starting the search at the wrong place:

Change from:

```
 Node * Prev = Head;
    Node * Curr = Head->Succ; 
```

to:

```
 Node * Prev = null;
    Node * Curr = Head; 
```

But the real problem for segfault is that you haven't considered the scenario for a terminating condition if the specified element is not found in your linked list.

You might implement a terminating condition as follows:

```
bool Set::remove(int X)
{
        Node * Prev = Head;
        Node * Curr = Head->Succ;
        while(Curr->Item != X)
        {
                Prev = Curr;
                Curr = Curr->Succ;
                if ( null == Curr ) {
                    // If you've reached the end of your
                    // linked list and haven't found the item
                    // yet, give up looking and return
                    return false;
                }
        }
        Prev->Succ =Curr->Succ;
        delete Curr;
        Num--;
        return true;
} 
```

Note: I also cleaned up your code a bit to remove `bool Flag` as it's unnecessary.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-15T21:22:27.073

您的 Curr 变量从**SECOND**位置开始。Head 指向第一个位置，而 Curr 指向 head 指向两个的位置（这是第二个！）。这会产生无限循环并使程序崩溃。从这个开始`curr`而`head`不是这个

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-15T21:24:59.573

Curr 被初始化：

```
Node * Curr = Head->Succ; 
```

意思是当你做

```
while(Curr->Item != X) 
```

您正在跳过“头”值。由于 Curr->Item 永远不会是 33（头值），因此您将继续使用 Succ，直到最终到达列表末尾的 NULL 指针。您没有在 while 中检查是否已到达列表末尾，因此在执行时会出现分段错误

```
Curr->Item != X
OR
Curr = Curr->Succ; 
```

尝试初始化：

```
Node * Curr = Head; 
```

# script-fu - 使用从 PHP 调用的 script-fu 将 .XCF 转换为 .PNG

> ID：13406358
> 
> 赞同：0
> 
> 时间：2012-11-15T21:16:46.973
> 
> 标签：script-fu, xcf

我想在 PHP 脚本中将许多 .XCF 图像转换为 .PNG 图像。（展平图层、保留透明度并遵守图层可见性设置）。

看来您可以在命令行模式下调用 GIMP 并使用它的 script-fu 语言来执行此操作。我找到了类似问题的各种答案，但是解决方案中有很多事情要做，我可以弄清楚如何正确运行它们并将它们适应 PHP。

这是我尝试使用的示例 - 它应该在目录中找到所有 .XCF 文件并将它们转换为 PNG。

```
 $execStg = ' "C:\Program Files\GIMP 2\bin\gimp-2.8.exe" -n -i -b - <<eof (let*="" (="" (file\'s="" (cadr="" (file-glob="" "*.xcf"="" 1)))="" (filename="" "")="" (image="" 0)="" (layer="" )="" (while="" (pair?="" file\'s)="" (set!="" image="" (car="" (gimp-file-load="" run-noninteractive="" file\'s))))="" layer="" (gimp-image-merge-visible-layers="" clip-to-image)))="" filename="" (string-append="" (substring="" 0="" (-="" (string-length="" file\'s))="" 4))="" ".png"))="" (gimp-file-save="" filename)="" (gimp-image-delete="" image)="" file\'s="" (cdr="" (gimp-quit="" eof<="" pre=""> ';
        exec($execStg, $results); 
```

[http://www.gimptalk.com/index.php?/topic/46715-batch-convert-xcf-to-png/page_p_354668#entry354668 *_* _](http://www.gimptalk.com/index.php?/topic/46715-batch-convert-xcf-to-png/page__p__354668#entry354668)

我无法让它工作（我也尝试在 DOS 框中运行该命令）。

我真正想做的是调整这个脚本，这样我就可以指定许多要转换为 png 的文件名。任何人都可以帮我调整上述脚本（或提供等效的东西）。

（如果整个脚本包含在我的 PHP 文件中，而不是在其他位置（例如 GIMP 的插件文件夹中）包含其他位，我更愿意。）

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-26T12:32:56.107

我在这里得到了答案（fu-script）......

[http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=22276#p92700](http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=22276#p92700)

# rest - 默认 JSON 到对象映射不起作用

> ID：13406362
> 
> 赞同：2
> 
> 时间：2012-11-15T21:16:55.180
> 
> 标签：rest, spring-mvc

我想执行 JSON 消息的 POST 并希望转换为 Employee Object。JSON 消息是 `{"employee":{"id":2231,"name":"jeffarry2231","niNumber":"SN10KTL"}}` .

员工对象

```
public class Employee {
    private Long id;
    private String name;
    private String niNumber;
    ...
} 
```

员工控制器

```
@Controller
public class EmployeeController {

   @RequestMapping(value = "/employee/add/", method = RequestMethod.POST)
    public void addEmployee(Employee employee){
       System.out.println(employee.getName());
    }
} 
```

发布请求的 RestTemplate 是

```
@Test
public void postMethod() {
    RestTemplate restTemplate = new RestTemplate();
    String jsonEmployee = "{'id':2231,'name':'jeffarry2231','niNumber':'SN10KTL'}}";

    HttpHeaders headers = new HttpHeaders();
    headers.setAccept(newArrayList(MediaType.APPLICATION_JSON));
    HttpEntity<String> requestEntity = new HttpEntity<String>(jsonEmployee, headers);
    restTemplate.exchange("http://localhost:8080/employee/add/", POST, requestEntity, String.class);
} 
```

applicationContext.xml 有

```
<mvc:annotation-driven/> 
```

我希望 MappingJacksonHttpMessageConverter 默认使用，但它似乎没有转换，不确定我在这里缺少什么！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T02:57:03.383

尝试添加`@RequestBody`注释：

```
@RequestMapping(value = "/employee/add/", method = RequestMethod.POST)
public void addEmployee(@RequestBody Employee employee){
   System.out.println(employee.getName());
} 
```

# c# - Visual Studio 中工厂设计模式的问题

> ID：13406369
> 
> 赞同：-1
> 
> 时间：2012-11-15T21:17:06.847
> 
> 标签：c#, visual-studio-2010, factory-pattern

我在实现工厂设计模式时遇到了麻烦。我查看了 [http://dotnet.dzone.com/articles/design-patterns-c-factory](http://dotnet.dzone.com/articles/design-patterns-c-factory)，它非常接近我的设计，因为它是我不久前发现的第一个好例子。
我看了 [Abstract Factory Design Pattern](https://stackoverflow.com/questions/27294/abstract-factory-design-pattern)，但我的设计非常不同，我无法决定是否需要它。

现在，这就是它的样子。以前比较简单，和我的 CR5、interface、factory、CB_spec、El 等在同一个 Visual Studio 项目中。我必须按照设计讨论和 CR6 等分开的需要来移动东西。现在我遇到了一些编译问题，我不知道该怎么办。见下文。我的问题是关于下面的两个编译问题。

我的 iCR Visual Studio 项目：

```
 public interface iCR
    {
        int CB_IO_Init(int slaveIndex);
        int WritePortReady();
        int WritePortBusy();
        void initCRData(byte[] writeBuffer, byte[] statusBuffer, int SlaveIndex, USB_Comm.CB cb, int cr_Type);
        int ProcessTWriting(ref Byte[] writeDat, ref Byte[] statusDat, ref Byte[] dataDumpWriteCheck);
        void Failure(String message);
        void Success(String message);

    } 
```

我的 CR_Factory Visual Studio 项目

```
namespace CR_Factory
{

public class Cr
{

}  

public class CRFactory
{
    public enum CRType
    {
        CR0,
        CR1,
        CR3,
        CR4,
        CR5,
        CR6
    }

    public CRFactory()
    {
    }

    public iCR GetCR(CRType type) 
    {
        iCR cr = null;
        switch (type)
        {
            case CRType.CR5:
                cr = new CR5(); //**compile error..Cannot implicitly convert type ‘CR5’ to iCR’. An explicit conversion exists (are you missing a cast?)
                break;
            case CRType.CR6:
                //not done yet
                break;
            default:
                throw new ArgumentException(string.Format("A CR of type {0} cannot be found", Enum.GetName(typeof(CRType), type)));
        }
        return cr;
    }

    public CRType DetermineCR_Type(int type)
    {
        switch (type)
        {
            case 0:
                return CRType.CR0;
            //break;
            case 1:
                return CRType.CR1;
            case 3:
                return CRType.CR3;
            case 4:
                return CRType.CR4;
            case 5:
                return CRType.CR5;
            case 6:
                return CRType.CR6;
            default:
                throw new ArgumentException(string.Format("A type of type {0} cannot be found", type));

        }
    }

    }
} 
```

我的 CR5 Visual Studio 项目中有很多类，但现在我只是向您展示工厂中提到的部分。稍后我将创建一个 CR6 VS 项目等：

```
public class CR5 : iCR
{        

    CB_703 cb_specific = null;

    //constructor
    public CR5()
    {
        cb_specific = new CB_703(SlaveIndex);
    }

    public int CB_IO_Init(int SlaveIndex)
    {
        int result = -534;
        result = cb_specific.IO_Init(SlaveIndex);
        return result;
    }
.
.
.
} 
```

我有另一个 Visual Studio 项目（实际上是几个）实例化工厂并获取适当的类型。我们称它为 El：

```
namespace CrWr
{

public partial class PControl : UserControl
{
    //setup 

    //constructor
    public PControl()
    {

    }

    /// <summary>
    /// Get the P Control for chosen dll
    /// </summary>
    public Control GetPControl(USB_Comm.CB cbInstance, string dllSelected, THandlerApplication.Temp.TEMP[] temp, string dll, SC.SC.S_C c0)
    {
        cb = cbInstance;
        createControls();
        itsDll = dll;
        tArr = temp;
        cert = c0;

        CR_Factory.CRFactory factory = new CR_Factory.CRFactory();
        CRFactory.CRType type = factory.DetermineCR_Type(cr_Type);
        try
        {
            cr = factory.GetCR(type); //**compile error GetCR is not supported by the language
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.InnerException);
        }
        return this;
    }

private void OnP()
    {
        int result = -536;

        while (rL)
        {
            result = cr.CB_IO_Init(SlaveIndex); 
            if (result == 0)
            {
                …
            }
        }

.
.
.
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:32:15.773

我的猜测是您的各种项目正在引用不同版本的 .Net 运行时或平台配置文件。我的怀疑是你的 CR5 项目是要检查的。工厂正在返回消费者的目标框架无法使用的对象。（即 CR5 是 .Net 4，而 Factory/Consumer 是 .Net 3.5/2 或 ClientProfile - 尽管最后一个可能有效，但我并没有真正混淆不同的项目类型。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T18:07:13.023

问题最终是我在接口参数和 CR5 项目中都引用了同一个类。由于它是循环的，因此会导致奇怪的编译错误。这发生在我搬家准备工厂使用 CR6 类时。

# ruby - 检查 ruby 脚本挂起的原因

> ID：13406370
> 
> 赞同：8
> 
> 时间：2012-11-15T21:17:06.670
> 
> 标签：ruby, debugging, rspec, capybara, capybara-webkit

有时我的规范可能会挂起，我必须终止相应的 ruby​​ 进程。当我运行使用 capybara 和 webkit 驱动程序编写的集成规范时，这很常见。

是否可以检查给定的 ruby​​ 进程并查看它挂在哪里？哪个方法、操作、文件、行号等。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-08-01T20:04:06.213

### tl;博士

使用`gdb`（例如 Linux）：

*   `echo 'call (void)rb_backtrace()' | gdb -p $(pgrep -f ruby)`

或使用`lldb`（例如 OS X）：

*   `echo 'call (void)rb_backtrace()' | lldb -p $(pgrep -f ruby)`

* * *

您可以使用调试库来调试 Ruby 脚本。

如果脚本是从 shell 执行的，这可以通过将脚本的第一行 ( [shebang](https://en.wikipedia.org/wiki/Shebang_(Unix)) ) 更改为：

```
#!/usr/bin/env ruby -rdebug 
```

或将其运行为：

```
ruby -rdebug my_script.rb 
```

加载调试器后，您可以设置一些断点，也可以通过键入`c`来运行应用程序以继续执行。

然后调试器会自动中断任何异常（例如`Ctrl+C`）或断点（例如包含 的行`debugger`）。

然后每次显示调试器控制台时，您可以选择：

*   `c`继续（到下一个异常、断点或行：）`debugger`，
*   `n`对于下一行，
*   `w`/`where`显示帧/调用堆栈，
*   `l`显示当前代码，
*   `cat`显示捕捉点。
*   `h`更多帮助。

另请参阅：[使用 ruby​​-debug 进行调试](http://bashdb.sourceforge.net/ruby-debug.html)，[ruby-debug gem 的快捷键](http://cheat.errtheblog.com/s/rdebug)。

这种方法的缺点是没有魔术按钮来按需启动调试器，除了在脚本中引发异常之外，它将显示不同的代码块而不是挂起一个。

这里有一些其他的想法：

*   将`debugger`语句添加到您的代码中，启动调试器并逐步进行。
*   请改用[Pry](http://pryrepl.org/)调试器（请参阅：[GitHub](https://github.com/pry/pry)）。

    通过安装：`gem install pry`，运行为：`pry`或添加为`require 'pry'`。

*   尝试可以附加到当前正在运行的进程的[`lldb`](http://lldb.llvm.org/)调试器（旨在替换）。`gdb`

    示例（替换`PID`为您的进程 ID）：

    ```
    $ lldb -p PID
    (lldb) bt all
    * thread #1: tid = 0x11d68a, 0x00007fff86c71716 libsystem_kernel.dylib`__psynch_cvwait + 10
      * frame #0: 0x00007fff86c71716 libsystem_kernel.dylib`__psynch_cvwait + 10
        frame #1: 0x00007fff838a9c3b libsystem_pthread.dylib`_pthread_cond_wait + 727
        frame #2: 0x0000000100241aad libruby.2.0.0.dylib`native_cond_wait + 29 
    ```

    另一个显示实时运行 ruby​​ 脚本的回溯示例（在其 tty 上）：

    ```
    echo 'call (void)rb_backtrace()' | lldb -p $(pgrep -f ruby) 
    ```

*   或者使用`gdb`（您可以通过以下方式扩展它：[`gdb.rb`](https://github.com/tmm1/gdb.rb)可以向您显示 ruby​​ 对象）。

    1.  通过以下方式安装：`sudo apt-get install gdb python-dev ncurses-dev && gem install gdb.rb`
    2.  在 Unix/OS X 上，按下`Ctrl+T`挂起进程以检查 PID 和正在做什么（或通过 检查`ps wuax | grep ruby`）。
    3.  通过以下方式附加到该过程：`gdb -p PID`。

    另请参阅：[使用 gdb 检查挂起的 Ruby 进程](http://kueda.net/blog/2013/01/31/using-gdb-to-inspect-a-hung-ruby-process/)、 Ruby 的[GDB 包装器](http://weblog.jamisbuck.org/2006/9/25/gdb-wrapper-for-ruby)和[检查实时 Ruby 进程](http://weblog.jamisbuck.org/2006/9/22/inspecting-a-live-ruby-process)。

*   其他可以提供帮助的库/工具包括：[debugger](https://rubygems.org/gems/debugger)、[crash-watch](https://github.com/FooBarWidget/crash-watch)、[memprof](https://github.com/ice799/memprof)、[rack-perftools_profiler](https://github.com/bhb/rack-perftools_profiler)。

如果没有任何帮助，您可以简单地尝试：`strace`(Linux) / `dtruss`(OS X) 使用以下语法：

```
sudo strace -fp <PID>
sudo dtruss -fp <PID> 
```

或者[`ltrace`](http://linux.die.net/man/1/ltrace)可以跟踪库调用而不是`strace`系统调用。

如果您认为这是网络问题，请使用`tcpdump`.

也可以看看：

*   [如何调试 Ruby 脚本？](https://stackoverflow.com/q/3955688/55075)
*   [如何配置 ruby​​ 以在 Ctrl-C (SIGINT) 上进入调试器？](https://stackoverflow.com/q/15278134/55075)
*   [如何使用键盘闯入运行 rails 应用程序的 ruby​​-debug？](https://stackoverflow.com/q/8750280/55075)
*   [有没有办法使用击键来调用 pry ruby​​ gem？](https://stackoverflow.com/q/26384563/55075)
*   [调试卡住的 Ruby 进程 - 在你杀死之前做什么 -9](https://blog.newrelic.com/2013/04/29/debugging-stuck-ruby-processes-what-to-do-before-you-kill-9/)
*   [用于调试运行 Ruby 进程](http://spin.atomicobject.com/2013/08/19/debug-ruby-processes/)和[调试 Ruby 工具的工具](https://www.bignerdranch.com/blog/debugging-ruby-tools/)
*   [调试 Rails 应用程序](http://guides.rubyonrails.org/debugging_rails_applications.html)
*   [在 Unix 上处理冻结进程的正确方法](http://old.blog.phusion.nl/2012/09/21/the-right-way-to-deal-with-frozen-processes-on-unix/)
*   Sergii Boiko[在 Unix 中调试 Ruby 应用程序](http://www.scribd.com/doc/31915761/Ruby-Debugging-at-Unix)
*   在 JumpstartLab[使用 Ruby 调试器进行调试](http://tutorials.jumpstartlab.com/topics/debugging/debugger.html)
*   [ruby-debug 在 30 秒内（我们不需要任何臭 GUI！）](http://pivotallabs.com/ruby-debug-in-30-seconds-we-don-t-need-no-stinkin-gui/)
*   [如何调试卡住的 Ruby 进程](http://dalibornasevic.com/posts/54-how-to-debug-stuck-ruby-processes)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T05:45:23.833

我也遇到了这个问题，并将其追溯到特定页面上的 ShareThis javascript 小部件。您可能会或可能不会使用它，但真正的问题可能是它挂起，因为页面上的某些东西导致了一个永远不会完成的外部请求。Capybara-webkit 会知道原始请求，但是如果这段代码本身发出请求，capybara-webkit 将永远不会知道它，如果最后一个请求挂起，说等待响应，capybara-webkit 也会...

对您来说，使用 webkit-debug 运行测试并查看发出的最后一个请求。对我来说，我看到了以下内容：

```
 1 requests remaining 
    Page finished with true 
    Received 200 from "http://w.sharethis.com/share4x/js/st.60709d5fdf0c137e879e64f41b8a6606.js" 
    0 requests remaining 
    Started request to "http://w.sharethis.com/share4x/css/share.470030190b6a6bdc89365fcc74d3bf55.css" 
    Received 200 from "http://w.sharethis.com/share4x/css/share.470030190b6a6bdc89365fcc74d3bf55.css" 
    0 requests remaining 
```

这让我在我的代码库中搜索 ShareThis。我在该代码周围放置了一个 if(Rails.env.test?) 块，瞧，我在做生意。这是一个糟糕的解决方法，必须将测试环境的条件放入您的代码库中......但它让我从这个愚蠢的问题中继续前进......

希望这可以帮助。

# data-binding - Windows 8 列表框数据绑定

> ID：13406373
> 
> 赞同：0
> 
> 时间：2012-11-15T21:17:14.423
> 
> 标签：data-binding, windows-8, listbox

我有一个列表框，我正在尝试使用“metro”应用程序进行数据绑定。这是我的xml：

```
 <ListBox x:Name="ImagesList" Margin="40" Grid.Row="1">
        <DataTemplate>
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Key}" />
            </StackPanel>
        </DataTemplate>
    </ListBox> 
```

我创建了一个来源：

```
 List<KeyValuePair<string, string>> items = 
            new List<KeyValuePair<string, string>>();

        items.Add(new KeyValuePair<string, string>("a", "a"));
        items.Add(new KeyValuePair<string, string>("b", "b"));
        items.Add(new KeyValuePair<string, string>("c", "c"));
        this.ImagesList.ItemsSource = items; 
```

我希望这会在我的应用程序 a、b 和 c 中创建一个文本列表

然而，相反，我为我绑定的每个元素获得了以下文本：

```
System.Runtime.InteropServices.CLRKeyBaluePairOmpl'2[System.String, System.String] 
```

看起来它正在显示我正在绑定的类型的全名......我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:59:05.123

您需要将 a 分配`Converter`给`Binding`.

将转换器作为 XAML 资源

```
<src:KeyValueConverter:Key="KeyConverter"/> 
```

将绑定转换器添加到文本源

```
Text="{Binding Path=ItemsList, Converter={StaticResource KeyConverter}}" 
```

示例转换器代码

```
public class KeyValueConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        var kvp = (KeyValuePair)value;
        return kvp.Key;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T07:28:08.627

我的 Xaml 也是错误的，它应该是：

```
 <ListBox x:Name="ImagesList" Margin="40" Grid.Row="1">
        <ListBox.ItemTemplate>
            <DataTemplate>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{Binding Value}" />
                </StackPanel>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox> 
```

# c - PowerPC 的 GCC C/C++ 交叉分析实现问题

> ID：13406377
> 
> 赞同：0
> 
> 时间：2012-11-15T21:17:27.953
> 
> 标签：c, gcc, profiling, powerpc, ecos

我正在尝试实现 gcc 分析。

我正在使用带有 PowerPC 的嵌入式环境 eCos。我用 C 编程。

当我使用开关编译和链接时`-pg`，我发现符号`_mcount`未定义。

我意识到我需要实现这个功能，因为它是特定于目标的。

对功能有什么要求`_mcount`？

我是否正确，它必须保存和恢复所有寄存器？是否有任何特殊寄存器必须与标准 32 一起保存和恢复？

我看到评论说`_mcount`必须在禁用中断的情况下调用，或者`_mcount`在记录调用树数据之前禁用中断？

我的 PowerPC 是 8245。这是 603e 系列处理器。

我正在使用作为 powerpc-eabi 的交叉编译器构建的 GCC 4.6.1。

这是 gcc 生成的 _mcount 调用示例。正在分析的函数的第一条指令是显示的第一行：

```
100b40:       7c 08 02 a6     mflr    r0
100b44:       3d 80 00 23     lis     r12,35
100b48:       90 01 00 04     stw     r0,4(r1)
100b4c:       38 0c 82 a8     addi    r0,r12,-32088
100b50:       48 05 19 25     bl      152474 <_mcount>
100b54:       94 21 ff 88     stwu    r1,-120(r1)
100b58:       7c 08 02 a6     mflr    r0
100b5c:       90 01 00 7c     stw     r0,124(r1)
100b60:       93 e1 00 74     stw     r31,116(r1)
100b64:       7c 3f 0b 78     mr      r31,r1 
```

编译器开关创建的代码`-pg`执行以下操作。

*   `mflr r0`1) 调用者的地址用两条指令和存储在堆栈中`stw r0,4(r1)`。
*   2) 刚才输入的函数的地址和`r0`两个指令一起`lis r12,35`存入`addi r0,r12,-32088`。

因此当`_mcount`被调用时`r0`包含输入的函数地址，`4(r1)`包含调用者的程序计数器。这对信息被存储并用于创建调用图。

我通过阅读 gcc 源代码 gcc/libffi/src/powerpc/asm.h 找到了这些信息。

我仍然不确定`_mcount`预期会返回什么。看来它必须恢复LR，所以`_mcount`不能使用`blr`，它必须恢复LR`(4)r1`并使用跳转指令而不是`blr`返回到之后的指令`bl _mcount`。这有意义吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-22T17:15:24.623

`_mcount`现在已签入 eCos RTOS 存储库的 for PowerPC 实现：

[http://ecos.sourceware.org/cgi-bin/cvsweb.cgi/ecos/packages/hal/powerpc/arch/current/src/mcount.S?cvsroot=ecos](http://ecos.sourceware.org/cgi-bin/cvsweb.cgi/ecos/packages/hal/powerpc/arch/current/src/mcount.S?cvsroot=ecos)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:40:39.353

这不是一个完整的解决方案，但下面的汇编代码将为 PowerPC 创建一个虚拟 _mcount。

该代码可用于解析`_mcount`外部，但没有记录调用图数据。此代码由 gcc 文件建议`\gcc\testsuite\gcc.target\powerpc\ppc-abi-2.c`，函数`my_mcount()`

```
 .text                
    .globl  _mcount
_mcount:
    # Move LR to CTR and return via CTR
    mflr r0
    mtctr r0
    lwz r0,4(r1)
    mtlr r0
    bctr 
```

# php - 我可以用 HTML5 做一个购买系统还是需要 PHP？

> ID：13406380
> 
> 赞同：-2
> 
> 时间：2012-11-15T21:17:31.583
> 
> 标签：php, database, html, web-applications

使用 HTML5 执行以下操作是否正确：

1.  选择颜色基础

2.  选择颜色上衣

3.  选择颜色细节

4.  购买

我需要使用 PHP 和 MySQL 吗？或者我可以只使用 HTML5 和数据库吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:24:21.090

取决于您的购买解决方案。如果您使用的是第三方应用程序（PayPal、Google Checkout 等），那么您可以在没有 PHP/mySQL 的情况下使用 HTML5 开发前端并链接到适当的支付网关/商家。

您将需要 PHP/mySQL 来进行自己的付款处理、动态产品列表、产品管理等。

**谷歌结帐集成**

[https://checkout.google.com/seller/integrate_buynow.html](https://checkout.google.com/seller/integrate_buynow.html)

**贝宝集成**

[https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/howto_overview](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/howto_overview)

# c++ - 使用 C++ boost::split 拆分字符串而不拆分引用的文本

> ID：13406387
> 
> 赞同：6
> 
> 时间：2012-11-15T21:17:52.413
> 
> 标签：c++, boost, split

我在用

```
boost::split(strs, r_strCommandLine, boost::is_any_of("\t ")); 
```

将字符串吐入标记以解析简单脚本。到现在为止还挺好。但是，对于以下字符串

```
command_name first_argument "Second argument which is a quoted string." 
```

我希望我的代币是

```
strs[0] = command_name
strs[1] = first_argument
strs[2] = "Second argument which is a quoted string." 
```

当然，我可以在标记的开头和结尾搜索引号字符，并使用“”分隔以引号开头的标记和以引号结尾的标记之间的标记以重新创建带引号的字符串，但我想知道如果有更有效/优雅的方式来做到这一点。有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-15T21:42:23.030

使用示例[`boost::tokenizer`](http://www.boost.org/doc/libs/1_52_0/libs/tokenizer)：

```
#include <string>
#include <iostream>
using std::cout;
using std::string;

#include <boost/tokenizer.hpp>
using boost::tokenizer;
using boost::escaped_list_separator;

typedef tokenizer<escaped_list_separator<char> > so_tokenizer;

int main()
{
    string s("command_name first_argument "
             "\"Second argument which is a quoted string.\"");

    so_tokenizer tok(s, escaped_list_separator<char>('\\', ' ', '\"'));
    for(so_tokenizer::iterator beg=tok.begin(); beg!=tok.end(); ++beg)
    {
        cout << *beg << "\n";
    }

    return 0;
} 
```

输出：

```
命令名
first_argument
第二个参数是带引号的字符串。

```

[请参阅https://ideone.com/gwCpug](https://ideone.com/gwCpug)上的演示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:37:58.490

我不确定这个解决方案是否可移植（我们违反了 const 条件`bool operator() (char ch) const`），但它可以工作。

这个解决方案在理论上很有趣，我不会在实际项目中使用它。

```
#include <boost/algorithm/string/split.hpp>
#include <string>
#include <vector>
#include <iostream>

class split_q {
public:
    split_q() : in_q(false) {}
    bool operator() (char ch) const
    {
        if (ch == '\"') in_q = !in_q;
        return !in_q && ch == ' ';
    }

private:
    mutable bool in_q;

};

int main(int argc, char* argv[])
{
    std::string in = "command_name first_argument \"Second argument which is a quoted string.\" additional_argument";
    std::vector<std::string> res;
    boost::algorithm::split(res, in, split_q());

    for (size_t i = 0; i < res.size(); ++i)
        std::cout << res[i] << std::endl;

    return 0;
} 
```

结果：

```
command_name
first_argument
"Second argument which is a quoted string."
additional_argument 
```

# expressionengine - ExpressionEngine：多站点管理器和单独的控制面板，限制控制面板功能

> ID：13406388
> 
> 赞同：1
> 
> 时间：2012-11-15T21:17:55.740
> 
> 标签：expressionengine

1.  我正在测试 MSM。是否可以从其域中为各个站点提供其自己的控制面板访问权限？如果 EE 安装在 domain1.com 并管理 domain2.com，我希望 domain2.com 有自己的控制面板（意思是，用户不需要去 domain1.com 来管理 domain2.com）。

2.  有没有办法限制用户在控制面板中可以访问的内容？例如，也许我不希望用户添加频道或触摸模板。有没有办法限制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T02:10:36.157

1.  是的。它没有详细记录，但[在此处的用户指南中进行了概述](http://expressionengine.com/user_guide/cp/sites/domainsetup.html#multiple-site-manager)。

2.  是的，每个成员组都设置了访问限制。您可以选择各种访问权限，包括他们是否可以管理频道、模板甚至是用于条目管理的特定频道分配。如果您需要进一步细化控制面板菜单，再次在每个成员组级别上，我强烈建议您查看与 MSM 兼容的[Zoo Flexible Admin](http://devot-ee.com/add-ons/zoo-flexible-admin)。

# grid - Kendo - 网格 - 聚合页脚列对齐

> ID：13406389
> 
> 赞同：0
> 
> 时间：2012-11-15T21:18:05.723
> 
> 标签：grid, alignment, aggregate, show-hide, kendo-ui

我有一个剑道网格，它有一个页脚模板来显示聚合数据。聚合数据最初与其列对齐（就像它应该的那样）。但是，如果我隐藏一列并且列具有不同的宽度，则聚合数据会与其列不对齐。这是小提琴：http: [//jsfiddle.net/uQG2J/1/](http://jsfiddle.net/uQG2J/1/)

这是代码：

```
var grid = $("#grid").kendoGrid({
dataSource: {
    data: [
        {"foo": 10, "bar": 10, "moo":5},
        {"foo": 20, "bar": 30, "moo":8},
    ],   
    aggregate: [
       {field: "moo", aggregate: "sum"}
    ]
},
columns: [
    {
        field: "foo",
        width: 20
    },
    {
        field: "bar",
        width: 80            
    },       
    {
        field: "moo",
        footerTemplate: "Sum: #=sum# ",
        width: 40           
    }

]   
}).data("kendoGrid");

grid.hideColumn("foo");
grid.refresh(); 
```

隐藏另一列后如何将聚合数据与其列对齐？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T00:19:47.860

为避免这种情况，请以百分比为单位设置列的宽度。

例如

```
var grid = $("#grid").kendoGrid({
    dataSource: {
        data: [
            {"foo": 10, "bar": 10, "moo":5},
            {"foo": 20, "bar": 30, "moo":8},
        ],    
        aggregate: [
           {field: "moo", aggregate: "sum"}
        ]
    },
    columns: [
        {
            field: "foo",
            width: "20%"
        },
        {
            field: "bar",
            width: "20%"
        },        
        {
            field: "moo",
            footerTemplate: "Sum: #=sum# ",
            width: "60%"
        }

    ]   
}).data("kendoGrid");

//grid.hideColumn("foo");
grid.refresh(); 
```

这是一个更新的[jsfiddle](http://jsfiddle.net/uQG2J/2/)。

# wordpress - 从自定义 CMS 迁移到 Wordpress

> ID：13406392
> 
> 赞同：1
> 
> 时间：2012-11-15T21:18:20.253
> 
> 标签：wordpress, content-management-system, web-scraping, migrate

我目前有一个在旧的自定义 CMS 引擎上运行的现有网站，我想将我的网站迁移到 wordpress。我主要关心的是迁移到 wordpress 后的 404 链接。如何从现有网站收集所有内部链接，以便我知道要迁移到 wordpress 的内容而不会失败？有没有一种简单快捷的方法来做到这一点？我有很多页面（100+）需要手动移植（剪切和粘贴）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:35:50.627

您可以使用 Wget 获取整个网站并从日志文件中获取所有 url。

当您在 WordPress 中创建内容时，您可以选择页面的 url（称为“slug”）。

如果您可以通过编程方式从当前站点获取内容，则可以使用 XML-RPC 协议将现有页面插入到 wordpress。这样您就可以输入带有内容的 slug 并可能保持 url 不变。

另一种选择是使用重定向插件，例如 REDIRECT，尽管这对于 100 个页面来说可能工作量太大。

如前一个答案所述，您可以自己编程重定向，使用 wordpress 很容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:22:08.927

您应该能够以编程方式完成所有这些工作。对于这样的操作，WordPress 非常容易编程。您需要查看要导入的内容：标题、内容等，+ 永久链接。永久链接是帖子的 URL。您实际上可以将其保存在 WordPress 中的帖子中，因此如果此信息存储在您的旧 CMS 中，您应该不会有任何问题。您可以沿途完美地转移它。举个例子，一些从 Drupal 到 WordPress 的迁移插件将帖子导入 WordPress 并保留它们在 Drupal 中的 URL：所以这确实是可能的。

在这种情况下，您的测试用例很简单：从您的旧 CMS 中导出一篇文章，并尝试使用其数据在 WordPress 中创建一个新文章。全部使用 PHP 脚本。我相信你会成功的。如果你这样做了，只需循环浏览所有旧帖子，它就会飞起来。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-07-03T21:38:19.213

首先，您应该将源页面别名迁移到 Wordpress post slug，它位于 wp_posts 表（post_name 字段）中。如果这没问题，Wordpress 将毫无问题地重定向它。你也可以试试gConverter。

# c# - 使用 EF 实体显示自定义视图

> ID：13406393
> 
> 赞同：4
> 
> 时间：2012-11-15T21:18:42.683
> 
> 标签：c#, entity-framework

我正在尝试构建一个相当简单的 winform 应用程序来从几个不同的系统加载类似的数据，然后在不同的视图/报告中显示数据。我第一次使用实体框架，我不确定这些“报告”视图如何适合 ORM 框架。

该模型非常基础，一个名为**Trade**的基本抽象类被实现为具有系统特定数据的几个具体类。我明白这一点，如果用户想要查看其他字段（感谢这个 SO [question](https://stackoverflow.com/questions/3669760/iqueryable-oftypet-where-t-is-a-runtime-type)），我可以在显示为基类或具体实现（例如 SystemATrade ）的数据网格中显示所有交易。

```
public abstract class BaseTrade
{
    [Key, Column(Order=0)]
    public string SourceSystem { get; set; }
    [Key, Column(Order = 1)]
    public string TradeID {get; set;}

    public DateTime TradeDate { get; set; }
    public string Buy_Sell { get; set; }
    public decimal Quantity { get; set; }
    public decimal Price { get; set; }
}

public partial class SystemATrade : Trade
{
    public string Field1 { get; set; }
    public string Field2 { get; set; }
}

public partial class SystemBTrade : Trade
{
    public string Field3 { get; set; }
    public string Field4 { get; set; }
}

public class TradeComplianceContext : DbContext
{
    public DbSet<BaseTrade> Trades { get; set; }

    public TradeComplianceContext() { }

} 
```

现在我想添加一些自定义视图，例如在 TradeDate 和 Quantity 上的自加入交易，以显示与此类似的相关交易：

```
_context = new TradeComplianceContext();
var query = from t1 in _context.Trades
    join t2 in _context.Trades on
    new
    {
        Quantity = t1.Quantity,
        TradeDate = t1.TradeDate
    } equals
    new
    {
        Quantity = t2.Quantity,
        TradeDate = t2.TradeDate
    }
    where
    t1.Buy_Sell.Equals("P") && t2.Buy_Sell.Equals("S")
    select new
    {
        t1.SourceSystem,
        t1.TradeDate,
        t1.Quantity,
        t1.TradeID,
        t1.Price,
        t1.TraderID,
        t1.TraderName,
        T2_TradeID = t2.TradeID,
        T2_Price = t2.Price,
        T2_TraderID = t2.TraderID,
        T2_TraderName = t2.TraderName
    };

return query.ToList(); 
```

该代码当前存在于我的业务逻辑层中，并向 UI 层返回一个列表，该 UI 层将该列表分配给 DataGrid.DataSource。它有效，但似乎不正确。是否首选为嵌入在 linq 查询中的匿名类型创建 POCO 并将此逻辑移至 DAL？这是否可以通过 EDMX 文件完成，并且可以与 CodeFirst POCO 并行吗？

次要：如果可能的话，如果用户希望将报告视为 SystemATrade 而不仅仅是 BaseTrade，我愿意做一个类似于 BaseTrade/SystemATrade 的多态报告，并包含额外的继承字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T19:20:24.850

你能解释一下为什么查询返回的数据不正确吗？这将有助于指出问题。是的，您可以创建一个 POCO 以使其更易于维护，但如果查询中存在缺陷，创建 POCO 并不能修复它。

# assembly - 从 ARM7 嵌套子程序返回

> ID：13406396
> 
> 赞同：0
> 
> 时间：2012-11-15T21:18:55.363
> 
> 标签：assembly, arm, instruction-set, arm7

好的，我正在尝试在 ARM7 Assembly 中实现选择排序算法。它从数组的最后一个元素开始，一直到第一个元素。它适用于第一次交换，但在继续之前退出。我和我的教授谈过，他说要使用堆栈变量，这样 lr 就不会被覆盖等，但我仍然不明白该怎么做。我已经搜索了执行此操作的方法，但似乎找不到任何我理解如何在我的代码中实现的内容。

我的代码如下：（a1是指向长度为a2的char数组的指针。两者都是通过C传入的）

```
sort2:
    stmdb    sp!, {v1-v8, lr}          @ Copy registers to stack
    mov      v1, a2                    @store number of elements in v1,v2 (a2 is passed in via C)
    mov      v2, a2
    sub      v1, v1,#1                 @subtract 1 from a2 to get number last element in array
    sub      v2, v1,#1                 @subtract 1 from v1 to get element just below last element
    bl       loop2
    ldmia    sp!, {v1-v8, pc}

loop2:
    ldrb     v4, [a1,v1]               @store value of last element in array a1(passed in via C) into r4 
    ldrb     v5, [a1,v2]               @store value of next to last element in array a1(passed in via C) into r4 
    cmp      v4, v5
    blt      swap2                     @if last element is less than current element a[v2], swap them
    cmp      v2, #0                    @if v2 = 0, we cycled through one iteration
    subeq    v1, v1,#1                 @so now move on to a[v1-1] element in array                   
    moveq    v2, v1                    @if v2 = 0, move the value of v1 into v2
    sub      v2, v2,#1                 @subtract 1 from v2 to get element below a[v1]
    cmp      v1, #0                    @if v1 = 0, were done
    bne      loop2
    mov      pc, lr                    @return to sort2

swap2:
    mov      v8, lr                    @store return address in v8
    ldrb     v6, [a1,v2]               @store value of a[v2] into v6
    strb     v4, [a1,v2]               @store v4 into a[v2]
    strb     v6, [a1,v1]               @store value of v6 into a[v1]
    mov      lr, v8                    @falls through and exits here instead of returning to loop2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T02:12:19.267

已经有几个地方可以从子程序返回。

当您输入 时`sort2`，您会在堆栈中保存一些寄存器：

```
stmdb    sp!, {v1-v8, lr}          @ Copy registers to stack 
```

当你离开时`sort2`，你会从堆栈中恢复一些寄存器：

```
ldmia    sp!, {v1-v8, pc} 
```

当你离开时`loop2`，你会做类似的事情：

```
mov      pc, lr                    @return to sort2 
```

仔细看看。注意到那里的模式了吗？离开`swap2`应该有类似的东西。

现在，`loop2`据说调用了另一个函数：`swap2`. 为了支持调用其他函数，调用函数应该保存一些寄存器，就像这样`sort2`做一样。叶函数（不调用其他函数的函数）不需要保存调用者保存的寄存器。此外，正如@PeteFordham 已删除的答案所指出的那样：`blt`=*小于*;的分支 `bllt`=*小于 的分支和链接*。

# php - 格式化 MySQL 查询结果

> ID：13406398
> 
> 赞同：0
> 
> 时间：2012-11-15T21:19:01.587
> 
> 标签：php, mysql

让我从我对 php/mysql 还很陌生的事实开始。

我正在尝试构建一个系统，该系统可用于记录为客户完成的工作，以跟踪工作编号、客户名称、设备、日期和分配给任务的员工。

我有一个表格设置来处理员工的分配，但我似乎无法弄清楚如何按照我想要的方式格式化结果。

几天内可能有多个员工被分配到同一个工作。所以我设置了一个像这样的表：

```
job_ID  |  employee_name  |  date_worked  |  hours_worked
  1     |      Dave       |   2010-1-2    |     4.5
  1     |      Dave       |   2010-1-3    |     4.0
  1     |      Mike       |   2010-1-2    |     6.0
  2     |      Bill       |   2011-5-7    |     8.0
  2     |      Bill       |   2011-5-8    |     6.5
  2     |      Dave       |   2011-5-7    |     4.0
  2     |      Dave       |   2011-5-8    |     4.5 
```

我希望对结果进行的输出如下：

```
 Job # = 1
    Employee  |  2010-1-2  |  2010-1-3  | 
      Dave    |     4.5    |     4.0    |
      Mike    |     6.0    |      0     |

    Job # = 2
    Employee  |  2011-5-7  |  2011-5-8  | 
      Bill    |     8.0    |     6.5    |
      Dave    |     4.0    |     4.5    | 
```

任何人都可以提供建议吗？

*编辑*

好的，所以我想我遗漏了一些信息。

我有一个用于保存记录的表（job_list）。

该表记录了job_id、客户、设备、位置、调用日期、响应日期、完成日期等。

然后我有一个表 (employee_list)，它按 id 和 name 列出所有员工。

我之前发布的表格背后的想法是成为一张只记录谁在哪里、在哪一天以及持续了多长时间的表格。

我已将我发布的表格修改为具有employee_id。

我想在 php 中显示结果，看起来像我发布的输出。我只是不知道该怎么做。

我还能提供哪些其他信息？抱歉我对我需要发布的内容缺乏了解：-/

如果我的方法非常糟糕，我确实说过我对此还是新手......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:22:41.983

这基本上是一个`PIVOT`，但 MySQL 没有`PIVOT`函数，因此您需要使用聚合函数和`CASE`语句来复制它。如果您知道要转换查询的所有值将与此类似：

```
select employee_name,
  sum(case when date_worked = '2010-01-02' then hours_worked else 0 end) `2010-01-02`,
  sum(case when date_worked = '2010-01-03' then hours_worked else 0 end) `2010-01-03`
from yourtable
group by employee_name 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/29dfd/1)

结果是：

```
| EMPLOYEE_NAME | 2010-01-02 | 2010-01-03 |
-------------------------------------------
|          Bill |          0 |          0 |
|          Dave |        4.5 |          4 |
|          Mike |          6 |          0 | 
```

如果您有未知数量的值，则可以使用准备好的语句动态生成：

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'sum(case when date_worked = ''',
      date_worked,
      ''' then hours_worked else 0 end) AS `',
      date_worked, '`'
    )
  ) INTO @sql
FROM yourtable;

SET @sql = CONCAT('SELECT employee_name, ', @sql, ' 
                  FROM yourtable 
                   GROUP BY employee_name');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/9dabb/2)

两者都会产生相同的结果。

# jquery - jQuery UI 小部件覆盖方法

> ID：13406399
> 
> 赞同：2
> 
> 时间：2012-11-15T21:19:02.567
> 
> 标签：jquery, jquery-ui, jquery-ui-widget-factory

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-17T22:49:18.663

这是一个相当古老的问题，但其他人可能有同样的问题。

正如评论中所说，您可以将默认事件处理程序函数定义为可以轻松覆盖的选项：

```
$.widget("ui.mywidget", {

    // Default option
    options: {
        'myevent': function() {
            alert('test1');
        }
    },

    // Public 'myevent' function
    myevent: function() {
        if($.isFunction(this.options.myevent))
            this.options.myevent();
    }
});

// Override the default 'myevent' option
$('#placeHolder').mywidget({
    myevent: function() {
        alert('test2');
    }            
});

$('#placeHolder').mywidget('myevent'); 
```

我更新了你`[jsFiddle](http://jsfiddle.net/jtAdV/4/)`的说明。

# shopify - Sending activation emails when creating new customers in Shopify API

> ID：13406400
> 
> 赞同：1
> 
> 时间：2012-11-15T21:19:03.520
> 
> 标签：shopify

I want to be able to create an inactive customer in the API (/admin/customers.json) and have the "Customer Account Activation email template" sent to the new user. In the API docs (I'm using the the example for "Create a new customer with send_email_invite"), it refers to sending this option in the payload:

"send_email_invite": true

When I use this, the customer is sent an email based on the "Customer Account Welcome email template", which is what someone is supposed to get after they have already activated their account. How do I get the message with the activation link ("Customer Account Activation email template") sent instead? Thanks.

# c# - Is it possible to compile a schematron schema into a Biztalk assembly

> ID：13406412
> 
> 赞同：2
> 
> 时间：2012-11-15T21:19:49.133
> 
> 标签：c#, .net, xsd, biztalk, schematron

Is it possible to create schematron assemblies, the same way we can compile .xsd schemas into assemblies and deploy to a Biztalk, or other application (using the BTSCompile build action)?

For example we have a regular assembly that was built from the HL7v3 schemas and I have an app that loads the Schema as an XmlSchema from the assembly and uses it to validate XML against. It works fine in this case.

Here's a the basic idea of what I'm talking about:

```
 public static XmlSchema LoadSchema(System.Type schemaType)
    {
        if (schemaType == null)
        {
            throw new NullReferenceException("schemaType cannot be null. Pass a valid object type.");
        }

        XmlSchema schema = new XmlSchema();

        try
        {
            // Grabbing an Assembly that is loaded for the type we're after.
            Assembly schemaAssembly = Assembly.GetAssembly(schemaType);
            foreach (Type type in schemaAssembly.GetTypes())
            {
                if (typeof(SchemaBase).IsAssignableFrom(type) && !type.IsNested && type.Name == schemaType.Name)
                {
                    schema = (Activator.CreateInstance(type) as SchemaBase).Schema;
                    break;
                }
            }
        }
        catch (Exception ex)
        {
            throw new Exception("Could not Load Schema assembly.", ex);
        }

        return schema;
    } 
```

However, if I try to do the same for a Schematron I cannot get it to compile using the BTSCompile Build Action which is what I'm assuming is required to be able to "see" the schemas within the assembly.

The Schematron file I'm using is basically this for now:

```
 <?xml version="1.0" encoding="utf-8"?>
<schema xmlns="http://www.ascc.net/xml/schematron" xmlns:sch="http://www.ascc.net/xml/schematron" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="http://www.ascc.net/xml/schematron http://www.ascc.net/xml/schematron/schematron1-5.xsd" xmlns:hl7="urn:hl7-org:v3">

<title>Schematron Rule Definitions</title>
<ns uri="urn:hl7-org:v3" prefix="hl7"/>
<ns uri="http://www.w3.org/2001/XMLSchema-instance" prefix="xsi"/>
<!-- Rules that pertain to multiple sections of the CDA -->
<pattern name="Header - Test">
    <rule context="/">
        <assert test="hl7:ClinicalDocument">
            ClinicalDocument must be the root node with the namespace urn:hl7-org:v3.
        </assert>
    </rule>
    </pattern>
</schema> 
```

The error I'm receiving when trying to compile is:

`The root element of a W3C XML Schema should be <schema> and its namespace should be 'http://www.w3.org/2001/XMLSchema'.`

So, then when I do what it of course says:

`The 'title' element is not supported in this context`

because they aren't valid xml schema elements. So now my question is this: is there a way to do what I'm trying to do here? I'm not very proficient with XML Schemas, so it may be something simple I'm overlooking.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T20:23:53.607

您可以通过使用 xs:annotation 元素将 schematron 规则嵌入 XML 架构中（就像 Microsoft 为[BizTalk 平面文件架构](http://msdn.microsoft.com/en-us/library/ms942182%28v=bts.10%29.aspx)所做的那样）。这将允许您将 schematron 规则编译到 BizTalk 程序集中。可以在[这篇较早的 MSDN 文章](http://msdn.microsoft.com/en-us/library/aa468554.aspx#schematron_topic3)中找到示例架构。

但是，BizTalk 将忽略注释。如果您想使用这些规则，您需要告诉 BizTalk 如何做到这一点。

您可以编写一个自定义管道组件来进行 schematron 验证，可能依赖于[Schematron.net 库](http://sourceforge.net/projects/dotnetopensrc/)。或者您可以使用开源管道组件，例如[BizTalk 的 Schematron XmlValidator 管道组件](http://schematronvalidator.codeplex.com/)（我自己没有使用过）。如果您想编写一个验证整个 xml 文档的管道组件（而不是像默认的 XML 验证组件那样仅在第一个错误上失败），请查看 Saravana Kumar 的[博客文章](http://blogs.biztalk360.com/extended-xmlvalidation-pipeline-component/)。

# iphone - iPhone App confirm identity to device

> ID：13406414
> 
> 赞同：1
> 
> 时间：2012-11-15T21:20:03.877
> 
> 标签：iphone, ios

I work at a museum that offers members access to our museum via an iPhone App. I'm looking for a way to avoid the member having to also present supplemental identification to confirm they are indeed the member. I originally thought I could query the phone's number and compare to the phone we have on file, but there is no accepted way to access the phone number directly through the SDK. Anyone else have a method to pre-validate a app user? Username/password validation is not what I'm looking for. I need something that isn't readily dissemanable/shareable.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:09:15.983

这就是 PassKit 的设计目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:25:37.033

您可以使用电子邮件地址验证：当您打开应用程序时，让用户输入与他们的博物馆帐户关联的电子邮件地址，或者请求他们允许查看他们的地址簿并找出他们的电子邮件地址是什么。当他们点击发送时，在服务器端数据库中保存一个条目，其中包含该用户的电子邮件地址的哈希（如果不需要，请不要存储地址！）以及您使用[NSUUID](http://developer.apple.com/library/mac/#documentation/Foundation/Reference/NSUUID_Class/Reference/Reference.html)为该 iPhone 生成的 UUID 。然后向该用户发送一封电子邮件进行确认，当他们打开电子邮件中的链接时，将他们在数据库中的条目标记为已批准。

该手机将始终能够登录，并且当它们从备份恢复时，凭据应转移到新手机。

# android - Protect files from being accessed outside the app itself

> ID：13406415
> 
> 赞同：3
> 
> 时间：2012-11-15T21:20:08.790
> 
> 标签：android

I am developing an android application, where I download pdf files. So I create a file called `NameProject` where I put all downloaded pdfs. I can access this file via my application and also via other application like File Manager. The android file system is open so I need to protect downloaded files from being accessed outside the app itself.

Can I do that? If yes, any ideas will be appreciated.

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:31:34.467

这里不是安卓专家。因此，我不知道如何在不同的应用程序之间保护文件。但无论如何，如果设备是植根的，那么即使是那个也无关紧要。

虽然这不是我宽恕或实践的事情，但你唯一的希望是默默无闻的安全。我的意思是，当您将这些文件放到应用程序文件系统空间时，使用加密模式并加密文件。确保在您的应用程序中有一个解密算法。在这里，我假设这些将是只读文件，因为您提到了 PDF。如果没有，即如果最终用户能够编辑和保存它们，那么您的应用程序中也需要加密功能。

我想你明白了我要去哪里的要点，有了这个。

1.  最终用户启动应用程序并选择要显示的文件
2.  应用程序将该文件解密为临时名称
3.  一个。（可选）用户编辑并保存文件
4.  湾。（可选）应用程序加密文件并将其保存为原始名称
5.  应用程序删除临时的、未加密的文件

根据这一点的重要性，无法在应用程序之外访问，对您来说，您可能希望将此逻辑包装到另一组条件和针对它们的措施中。

但毕竟，坚定的头脑可以而且最终会找到破解它们的方法。特别是如果您将应用程序发布到野外，即互联网。在受控的企业环境部署中，您有更好的机会通过企业政策等将它们保密更长时间。但是，最终，这是徒劳的。它只会为你争取一些时间。多少时间，是唯一的问题。

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:32:31.517

下载文件到应用程序内部存储目录（/data/data/ *packagename*），没有root权限是不能访问的。但是只保留必要的文件，因为许多手机的内部存储器都很小。

```
File appdir = context.getDir("mydir", Context.MODE_PRIVATE); 
```

`File fileWithinAppDir = new File(appdir, "appfile");`

# javascript - 检查 window.close 是否还重定向到另一个 URL/主机

> ID：13406418
> 
> 赞同：6
> 
> 时间：2012-11-15T21:20:28.920
> 
> 标签：javascript, html

我有代码来检查窗口是否关闭。如果我留在同一页面上，它会起作用。
使用 Internet Explorer，如果我单击一个链接，然后重定向到另一个站点，即使 WINDOW 实际上从未关闭，window.closed 也会返回 true。

我正在这样做：

```
w = window.open("mypage.html");

var t = setInterval(function() { 
  if (!w) {  alert('a'); } 
  if (w.closed) { alert('b'); } 
   if (!w || w.closed) { 
     clearInterval(t); hide('mainShadow'); 
   }
}, 800); 
```

在“mypage.html”中，有一个指向另一个站点的链接。当去另一边时， w.closed 返回`true`。

IE中是否有真正检查窗口是否关闭的好方法。
合同并不真正满意，因为窗口从未真正关闭。

此代码适用于 Chrome，不适用于 IE9

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T16:14:08.593

> 合同并不真正满意，因为窗口从未真正关闭。

这似乎是混乱的根源。JavaScript-in-a-browser 中的`window`对象是指显示某个浏览器窗口中包含的文档的窗口，但它并不指浏览器自己看到的那个窗口。单个浏览器窗口也不是与单个`window`实例相关联的情况。所以一个`window`实例可以关闭，因为它不再显示。这是准确的，因为`window`严格来说，该元素不是关于`window`作为窗口外部视图的浏览器实体，而不是关于作为`window`包含代码的文档看到的窗口的内部视图的 JavaScript 对象。

简短的版本是我不相信有一种方法可以从网页中执行此操作，因为可见性的外部范围，即`window`对象，并不指您要操作的实际对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T02:23:18.903

由于同源策略，您无法阻止此功能。但是，您可以使用 window.opener.someFunction() 每 100 毫秒调用一次父窗口中的函数。如果父窗口在 500 毫秒后没有收到消息，那么它可以假定它打开的窗口已关闭。您可以尝试使用 window.postMessage 进行类似操作，但它在 IE 中不起作用。

# c++ - 如何访问存储在列表中的对象

> ID：13406422
> 
> 赞同：0
> 
> 时间：2012-11-15T21:20:47.963
> 
> 标签：c++, list, object

我如何访问存储在列表中的对象。我不想使用向量或`#include <list>`. 任何见解都值得赞赏。谢谢！这是我的类定义：

```
class UnsortedType  // UnsortedType.h   
{
    private:                
        int length, currentPos;
        book info[MAX_ITEMS];

    public:             
        UnsortedType();
        bool IsFull()  const ;
        int  LengthIs()  const ;  // returns length of list
        void RetrieveItem(book& item, bool& found);
        void InsertItem(book item); // adds objects to the list
        void DeleteItem(book item); // deletes objects in the list
        void ResetList(); // resets list to default length -1
        void GetNextItem(book& item); // gets the next object in the list

}; 
```

存储在此列表中的是书籍对象。这些对象中包含标题、作者、价格等...我的问题是如何访问每个对象，一旦它们存储在列表中。我希望能够比较存储在列表中的对象的属性。例如每本书的价格。

```
//main
#include <iostream>
#include "Book.h"
#include "textbook.h"
#include "Name.h"
#include "unsorted.h"

using namespace std;

int main()
{

    book b1("The Exception to the Rulers", "Amy", "Goodman", "Hyperion", 342, "1-4013-0131", 21.95,'N');
    book b2("Who moved my cheese", "Spencer", "Johnson", "Red Tree", 95, "0-399-14446-3", 19.99,  'H');
    book b3("Hellbound Hearts", "Neil", "Gaiman", "Dark Harvest", 326, "978-1-4391-4090-1", 16.00, 'F');

    UnsortedType L1; // creating a list "L1" 

    L1.InsertItem(b1); // populating the list with the first book
    L1.InsertItem(b2); // populating the list with the second book
    L1.InsertItem(b3); // populating the list with the third book

    return 0;
} 
```

这些是 book.h 中的函数

```
// book.h
enum RelationType
{
    LESS, EQUAL, GREATER
};

class book
{
private: 
    string title; 
    Name aurthor; 
    string publisher; 
    string ISBN; 
    int pages; 
    float price; 
    char code; 

public:
    RelationType ComparedTo(book) const;
    class negativeNumber{};
    void setTitle(string);
    void setAurthor(string f, string l);
    void setPublisher(string);
    void setISBN(string);
    void setPages(int);
    void setPrice(float);
    void setCode(char);
    string getTitle();
    Name getAurthor();
    string getPublisher();
    string getISBN();
    int getPages();
    float getPrice();
    char getCode();
    void PrintBook();
    book(); //default constructor
    book(string, string, string, string, int, string, float, char); //constructor with args
    ~book(); //Destructor
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:31:22.313

```
Book& UnsortedType::operator[](const int i))
{
  //check if array is in bounds
  return info[i];
} 
```

这将允许您使用未排序的 L1[3] 类访问书籍对象；

或者在您的情况下，这是一个访问每个对象并确定书籍最低价格的示例：

```
double UnsortedType::FindLow()
{
    double low = 9999;      //used to store lowest value
    for(int i = 0; i < length; i++) //loop through array
    {
        if(info[i].price < low) //if the price of this book is lower than the current lowest
            low = info[i].price;
                //set low to new low
    }
    return low;
} 
```

# launchd - Osascript - syntax error when run from daemon (LiveCode app)

> ID：13406425
> 
> 赞同：4
> 
> 时间：2012-11-15T21:21:00.350
> 
> 标签：launchd, osascript, livecode

I have a LiveCode app that, as part of a larger purpose, checks to see what the name of the "frontmost" application (i.e. the name in the menu bar). I am having LiveCode run this through the shell:

```
osascript -e 'tell application "System Events" to return name of every process whose frontmost is true' 
```

It works fine when the app runs as a normal process, but when it is started by launchctl as a daemon, it doesn't work. I get the error

> 61:68: Syntax error: expected classname but found identifier (-2741).

Like I said, it only happens when the app is running as a daemon. Any ideas why?

btw: OS X 10.7.4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-15T11:15:35.507

确保脚本的所有者是 system 或 root 而不是您。您可以使用 chown 命令行实用程序来执行此操作（这包含在 Mac OS X 中）。10.7 及更高版本对权限相当挑剔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T09:05:00.810

不知道这是否仍然是一个问题，但如果它是一个相当微不足道的外部编写.. 基于此的东西：

```
for (NSRunningApplication *currApp in [[NSWorkspace sharedWorkspace] runningApplications]) {
        if ([currApp isActive]) {
             // return whatever property you want here
        }
    } 
```

# android - Can't send non English Words to Select Statement

> ID：13406428
> 
> 赞同：1
> 
> 时间：2012-11-15T21:21:09.870
> 
> 标签：android, database, sqlite

```
SQLiteDatabase myDatabase = openOrCreateDatabase("SMDB", MODE_PRIVATE, null);
Cursor c = myDatabase.rawQuery("SELECT PName FROM tbl_staff WHERE PMajor LIKE '%" + selectedItemFromSpin + "%'", null);
c.moveToFirst(); 
```

This is my code, now this code works fine when I pass an English Word for selectedItemFromSpin variable but when I send a non English word like "نوشته مثال" then app crashes and says a message with button named force to quit.

I appreciate if anyone helps.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-06T07:33:31.487

cursor = db.rawQuery(query, new String[]{"%"+selectionArgs[0]+"%","%"+selectionArgs[2]+ "%"});

# c# - 是 Thread.Sleep(Timeout.Infinite); 比 while(true){} 更高效？

> ID：13406435
> 
> 赞同：38
> 
> 时间：2012-11-15T21:21:33.760
> 
> 标签：c#, console-application

我有一个控制台应用程序，我希望在监听事件的同时始终保持打开状态。我已经测试`Thread.Sleep(Timeout.Infinite);`并且`while (true) { }`两者都允许在保持控制台应用程序打开的同时引发事件。有一个我应该使用的吗？如果线程正在休眠，有什么我不应该做的，比如修改类范围内声明的静态集合？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-15T21:26:42.050

我建议使用`ManualResetEvent`（或其他`WaitHandle`），并调用[ManualResetEvent.WaitOne](http://msdn.microsoft.com/en-us/library/58195swd.aspx)。

这将具有与永远睡眠类似的效果，除了它为您提供了一种在需要时（通过调用事件）*退出*无限“块”的干净方式。[`Set()`](http://msdn.microsoft.com/en-us/library/system.threading.eventwaithandle.set.aspx)

使用`while(true)`会消耗 CPU 周期，所以这绝对是要避免的。

> 有什么我不应该做的，比如修改在类范围内声明的静态集合？

一般来说，没有。由于您的线程将被阻止，因此使用共享数据不应该有任何同步问题（前提是集合中的项目没有特定要求，例如必须在具有适当同步上下文的线程上使用的用户界面元素.)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2019-09-09T11:24:41.573

从**C# 7.1**开始，您可以使*Main*方法异步。*这意味着您可以将Main*方法作为*Task*异步挂起，而不是使用忙等待或线程锁定睡眠。这样，运行*Main*的线程就不会被锁定。并且`Cts.Cancel()`，您可以轻松释放主任务以退出应用程序（不允许其他线程/任务完成工作）。

```
static readonly CancellationTokenSource Cts = new CancellationTokenSource();
static async Task Main(string[] args)
{
    /* your code here */

    // Task running Main is efficiently suspended (no CPU use) forever until Cts activated with Program.Cts.Cancel(); (thread-safe) from anywhere.
    await Task.Delay(Timeout.Infinite, Cts.Token).ConfigureAwait(false);
} 
```

从**2020 年开始，C# 9.0 开始**，整个`Program.cs`文件内容实际上看起来就像这样：

```
using System.Threading;
using System.Threading.Tasks;

CancellationTokenSource Cts = new();

/* your code here */

// Task running Main is efficiently suspended (no CPU use) forever until
// Cts activated with Program.Cts.Cancel(); (thread-safe) from anywhere.
await Task.Delay(Timeout.Infinite, Cts.Token).ConfigureAwait(false); 
```

如果无限睡眠取消是该案例的正常代码流，则可以尝试捕获 TaskCanceledException（当您尝试等待/与其他任务同步时，请不要使用`Task.Delay` *inf-sleep*，try-catch 效率较低并且会混淆队友；使用其他任务合作机制）：

```
try
{
    await Task.Delay(Timeout.Infinite, Cts.Token).ConfigureAwait(false);
}
catch(TaskCanceledException) { /* Ignored */ } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-15T21:27:14.477

我认为电话

```
while (true) { ... } 
```

是计算密集型的，因为线程永远不会停止，whearas

```
Thread.Sleep(Timeout.Infinite); 
```

实际上在 OS 本机调度程序的帮助下使线程进入睡眠状态。然后线程实际上停止了，所以我想它对计算的要求不高。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-15T21:23:49.493

不像`while(true)...`,`Thread.Sleep`不使用 CPU 周期，所以从这个意义上说，睡眠效率更高。通常，强烈建议不要在[自旋锁](http://en.wikipedia.org/wiki/Spinlock)之外使用[忙等待。](http://en.wikipedia.org/wiki/Busy_waiting)

> 如果线程正在休眠，有什么我不应该做的吗？

由于您的线程在进入时被阻止`Thread.Sleep`，因此您希望对其资源做的任何事情都是公平的游戏。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-15T21:26:20.727

**是**的， 在以更智能的方式工作时`while(true)`消耗 CPU ：该函数将当前执行上下文置于睡眠状态；它通过调用系统调用来调用内核睡眠函数，该函数以原子方式 (a) 设置唤醒计时器 (b) 将当前进程标记为睡眠 (c) 等待直到唤醒计时器触发或发生中断 `sleep()``sleep()`

如果调用`sleep()`，CPU 可以做其他工作。

`sleep()`这就是有用的原因之一。

一个有用的链接 -[使用睡眠时要小心](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686298%28v=vs.85%29.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-11-04T10:56:05.900

> 调用 Thread.Sleep 方法会导致当前线程在您传递给该方法的毫秒数或时间间隔内立即阻塞，并将其时间片的剩余部分交给另一个线程。

[https://docs.microsoft.com/en-us/dotnet/standard/threading/pausing-and-resuming-threads?redirectedfrom=MSDN#the-threadsleep-method](https://docs.microsoft.com/en-us/dotnet/standard/threading/pausing-and-resuming-threads?redirectedfrom=MSDN#the-threadsleep-method)

# ipad - FlexSlider 标题 ipad 问题

> ID：13406446
> 
> 赞同：1
> 
> 时间：2012-11-15T21:22:19.583
> 
> 标签：ipad, anchor, caption, flexslider

好的，这让我难过。[我在这个网站](http://fabricomagazine.com)上有一个 FlexSlider 的实现

在我桌面上的每个浏览器中，一切似乎都运行良好，甚至是 safari。

我遇到的问题似乎是特定于 iPad 的。

出于某种原因，无论我添加多少张幻灯片，在 iPad 上，标题锚始终链接到同一个帖子（添加的第一张幻灯片/标题）。移动幻灯片时文本会发生变化，但锚链接保持不变。我尝试禁用我的样式，认为它可能是一些狡猾的 CSS，但不，同样的问题仍然存在。

这个问题只在 iPad 上很明显（也许 iPhone 也是如此？）但我不知道如何解决这个问题。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T19:30:54.007

我遇到了同样的问题，在移动设备（iPhone/iPad）上，最后一张幻灯片的链接变成了所有幻灯片的链接。

我没有找到解决方案，但将“动画”属性设置为“滑动”而不是“淡入淡出”对我有用，直到有更好的修复。

# html - 使 HTML 表格足够宽以适应内容

> ID：13406447
> 
> 赞同：3
> 
> 时间：2012-11-15T21:22:23.577
> 
> 标签：html, css, width, css-tables

我运行了一个生成 HTML 页面的脚本，但我无法正确格式化生成的表格。需要制作一个尽可能宽的表格。目前，我必须指定一个特定的宽度（1500 像素），以便每个单元格的内容不会换行到下一行。这是一个例子：

```
With width set to 1500px:
+-----------------------------+------------------------------+
|Contents of my cell          | Contents of other cell       |
+-----------------------------+------------------------------+

With width set to 100%:
+-------------------+--------------------+
|Contents of my     |Contents of other   |
|cell               |cell                |
+-------------------+--------------------+ 
```

理想情况下，我的文本不会换行（例如，当宽度设置为 1500 像素时）但不必设置静态表格宽度。有时，表格可能需要比 1500 更宽（或更小），所以我希望宽度尽可能动态。

这是我目前正在使用的 CSS：

```
<style type="text/css">
h1 {
    text-shadow: rgba(255, 255, 255, 0.796875) 0px 1px 0px;
    font-family: Georgia,"Times New Roman","Bitstream Charter",Times,serif;
    font-weight: normal;
    padding: 7px 7px 8px;
    text-align: left;
    line-height: 1.3em;
    font-size: 24px;
}
table {
    border: 1px solid #DFDFDF;
    background-color: #F9F9F9;-moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    border-radius: 3px;
    font-family: Arial,"Bitstream Vera Sans",Helvetica,Verdana,sans-serif;
    color: #333;
    width: 1500px;
}
th {
    text-shadow: rgba(255, 255, 255, 0.796875) 0px 1px 0px;
    font-family: Georgia,"Times New Roman","Bitstream Charter",Times,serif;
    font-weight: normal;
    padding: 7px 7px 8px;
    text-align: left;
    line-height: 1.3em;
    font-size: 14px;
    color: #555;
}
td {
    font-size: 12px;
    padding: 4px 7px 2px;
    vertical-align: bottom;
    border-right: 1px solid #DFDFDF;
}
</style> 
```

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T21:28:12.593

如果您试图让它永远不会换行，请尝试 white-space:nowrap 并从您的表格中删除宽度。

```
td {
    font-size: 12px;
    padding: 4px 7px 2px;
    vertical-align: bottom;
    border-right: 1px solid #DFDFDF;
    white-space:nowrap;
} 
```

# c# - .NET RegEx 用标签替换转义字符

> ID：13406451
> 
> 赞同：0
> 
> 时间：2012-11-15T21:22:32.137
> 
> 标签：c#, .net, regex

我有一些来自旧数据库的文本。文本格式如下：

> 这是文本的第一部分#this 应该用粗体格式化#这应该是普通文本然后#this 应该再次用粗体格式化#等等。

正如您在上面看到的，我需要找到 # 符号内的所有组，并在它们周围设置一个`<b></b>`或`<strong></strong>`标记。我怎样才能在 C# 中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:25:43.397

```
string input = @"This is the first part of the text #this should be formatted in bold# this should be normal text and then #this should be formatted in bold again# and so on.";
var output = Regex.Replace(input, @"#(.+?)#", "<b>$1</b>"); 
```

# php - JSON 在输入 URL 时无效，但在复制和粘贴时有效

> ID：13406453
> 
> 赞同：0
> 
> 时间：2012-11-15T21:22:34.557
> 
> 标签：php, javascript, json, windows-8

我正在尝试为 Windows 8 应用程序验证 JSON 的以下 URL。问题是下面的代码运行它不会绑定到提供的列表框。我知道代码有效，并将其单选到我创建的 JSON 中。

```
 new WinJS.Binding.List(json.results); 
```

本网站上看到的 JSON 在网站上显示为有效...

```
https://example.com/app/example.php 
```

..如果我将 URL 复制并粘贴到 JSON valadator 中，例如 jsonlint.com，我得到：

```
Parse error on line 1 <\!DOCTYPEhtmlPUBLIC" ^ Expecting '{', '[' 
```

..但是当我复制并粘贴代码时，URL 是有效的。

我知道这是一个简单的解决方案，但我无法让它为我的生活工作。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:29:35.127

问题是 URL 没有返回正确的 JSON 响应。它返回一个 HTML 响应，其中包含格式化代码块中的 JSON。因此，虽然复制和粘贴它会起作用，但您的代码将看到包装它的所有 HTML 并中断（因为它是无效的）。

如果这是您控制的 API，则需要`Content-type`在 PHP 脚本 ( `header('Content-type: application/json')`) 中设置标头，并且只返回 JSON 字符串，根本不返回任何 HTML 代码。

如果不是，最好的办法是获取 URL，然后从响应中删除所有 HTML，以便解析剩余的 JSON。DOM 解析库可能会帮助您做到这一点。

编辑：看来响应现在（或已经）正确，并且在[http://jsonlint.com](http://jsonlint.com)上验证良好。

# eclipse - Eclipse - 控制台视图在缺少的屏幕上

> ID：13406457
> 
> 赞同：1
> 
> 时间：2012-11-15T21:22:45.417
> 
> 标签：eclipse

我有 2 个屏幕。我将控制台视图（连同其他视图）放在辅助屏幕上。现在我在 Eclipse 运行时删除了另一个屏幕。现在我无法访问辅助视图上的那些视图。当我尝试从窗口菜单打开它们时，我看不到它们。试图在它们聚焦时按 Escape，但现在当我打开它们时，我看到一个空白的分离窗口，里面什么都没有......

在戴尔笔记本电脑上运行 Windows

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T21:24:40.700

你有没有尝试过重新审视你的观点？

# php - 为什么通过 ASP 页面访问时 SQL Server 上的列名不区分大小写，但通过 PHP mssql 模块访问时区分大小写？

> ID：13406461
> 
> 赞同：0
> 
> 时间：2012-11-15T21:23:04.800
> 
> 标签：php, sql-server

为什么通过 ASP 页面访问时 SQL Server 上的列名不区分大小写，但通过 PHP mssql 模块访问时区分大小写？

例如，我们有一个带有大量 ASP 页面的 IIS 服务器来访问我们的 SQL Server。从数据库中检索到的表中的列名都是不区分大小写的。您可以将它们全部输入大写或小写或混合任何您想要的内容，然后它们会回来。

但是，我们有一个运行 Ubuntu（最新版本）的 Linux 服务器，其中包含完全更新的 Apache2 和 PHP5，使用 mssql 模块完全修补和更新以连接到 sql 服务器，但是 .. 所有列名都区分大小写。

当数据库管理员更改 VIEW 并且存储过程现在以大写而不是像昨天那样返回小写时，这会带来问题。

有没有办法调整 mssql 模块？

这是我的设置：

```
MSSQL Support   enabled
Active Persistent Links 0
Active Links    1
Library version FreeTDS

Directive   Local Value Master Value
mssql.allow_persistent  On  On
mssql.batchsize 0   0
mssql.charset   no value    no value
mssql.compatability_mode    Off Off
mssql.connect_timeout   5   5
mssql.datetimeconvert   On  On
mssql.max_links Unlimited   Unlimited
mssql.max_persistent    Unlimited   Unlimited
mssql.max_procs Unlimited   Unlimited
mssql.min_error_severity    10  10
mssql.min_message_severity  10  10
mssql.secure_connection Off Off
mssql.textlimit Server default  Server default
mssql.textsize  Server default  Server default
mssql.timeout   60  60 
```

# java - 在类块中声明和实例化

> ID：13406462
> 
> 赞同：0
> 
> 时间：2012-11-15T21:23:10.737
> 
> 标签：java, object, block

在类块中：

而不是像这样制作一个对象（在这种情况下是一个简单的字符串）：

```
public String one = "Hello!"; 
```

我想这样做：

```
String one;
one = "Hello!"; 
```

但*编译器*抛出：

```
error: <identifier> expected 
```

为什么？为什么第二个必须在方法内？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:25:37.917

看起来这应该在某种构造函数中......无论哪种方式，您都必须将它放在方法或构造函数（或其他代码块）中。这只是 Java 语法的规则之一。

```
public String one;

public MyClass() {
    one = "hello";
} 
```

如果你创造了这个领域`static`，你可以拥有

```
public static String one;

static {
    one = "hello";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:24:08.573

很有可能是

```
one = "Hello!" 
```

位于类块中。该语句必须出现在代码块内——即；方法、构造函数或静态初始化程序。例如：

```
void myMethod() {
    String one;
    one = "Hello!";
} 
```

非声明性语句不能出现在类块中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T21:24:10.013

该`one = "Hello!";`行需要在方法内。

# python - Python+SUDS：请求作为编码字符串（base64）

> ID：13406464
> 
> 赞同：0
> 
> 时间：2012-11-15T21:23:12.983
> 
> 标签：python, xml, base64, suds

我正在尝试在 Python 中创建一个客户端，它将与 Web 服务（NuSoap）进行通信。标识数据和查询以 XML 格式作为编码字符串 (base64) 发送。这个 XML 是：

```
<CV3Data version="2.0">
  <request>
    <authenticate>
      <user>m*****</user>
      <pass>m******</pass>
      <serviceID>b*******0</serviceID>
    </authenticate>
    <requests>
      <reqProducts>
        <reqProductRange start="9294" end="9296"/>
      </reqProducts>
    </requests>
  </request>
</CV3Data> 
```

这个 Web 服务有这个 wsdl：

```
<definitions xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="https://service.commercev3.com/CV3Data.xsd" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns="http://schemas.xmlsoap.org/wsdl/" targetNamespace="https://service.commercev3.com/CV3Data.xsd">
 <types>
  <xsd:schema targetNamespace="https://service.commercev3.com/CV3Data.xsd">
   <xsd:import namespace="http://schemas.xmlsoap.org/soap/encoding/"/>
   <xsd:import namespace="http://schemas.xmlsoap.org/wsdl/"/>
  </xsd:schema>
 </types>    
 <message name="CV3DataRequest">
  <part name="data" type="xsd:base64Binary"/>
 </message>
 <message name="CV3DataResponse">
  <part name="return" type="xsd:base64Binary"/>
 </message>
 <portType name="CV3Data.xsdPortType">
  <operation name="CV3Data">
   <input message="tns:CV3DataRequest"/>
   <output message="tns:CV3DataResponse"/>
  </operation>
 </portType>
 <binding name="CV3Data.xsdBinding" type="tns:CV3Data.xsdPortType">
  <soap:binding style="rpc" transport="http://schemas.xmlsoap.org/soap/http"/>
  <operation name="CV3Data">
   <soap:operation soapAction="http://service.commercev3.com/index.php/CV3Data" style="rpc"/>
   <input>
    <soap:body use="encoded" namespace="http://soapinterop.org/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
   </input>
   <output>
    <soap:body use="encoded" namespace="http://soapinterop.org/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
   </output>
  </operation>
 </binding>
 <service name="CV3Data.xsd">
  <port name="CV3Data.xsdPort" binding="tns:CV3Data.xsdBinding">
   <soap:address location="http://service.commercev3.com/index.php"/>
  </port>
 </service>
</definitions> 
```

我需要阅读 CV3Data。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T22:12:32.173

要阅读“编码”的 XML，您必须“解码”它。:D

我有一个使用带有 EWS 的 suds 的项目，我需要在其中下载附件。EWS 在 Base64Binary 中返回附件，所以我只使用 base64 中的 b64decode 来完成它。像这样的东西应该适合你：

```
from base64 import b64decode

encoded_xml = NuSoapMethodToGetBase64EncodedXMLString()
decoded_xml = b64decode(CV3Data) 
```

# ios - 超越您自己的应用程序的 UI 测试自动化？

> ID：13406465
> 
> 赞同：4
> 
> 时间：2012-11-15T21:23:13.653
> 
> 标签：ios, automated-tests, ui-automation, ios-ui-automation

是否有一些框架可以控制整个模拟器（不仅可以在您自己的应用程序内部进行测试，还可以在其他应用程序中进行测试）？

我读到：

*   [UI自动化](http://developer.apple.com/library/ios/#documentation/DeveloperTools/Reference/UIAutomationRef/_index.html)
*   [iOS 测试工作室](http://www.telerik.com/automated-testing-tools/ios-testing.aspx)
*   [猴话](http://www.gorillalogic.com/testing-tools/monkeytalk/documentation)
*   [用户界面规范](http://code.google.com/p/uispec/)

但是，据我了解，它们都只允许在您自己的应用程序中进行测试。

我知道我的要求非常不寻常（考虑到 iOS 的多任务处理非常有限）。但是，我想编写一些测试，这将驱动模拟器通过多个应用程序并测试一切正常。

一个附加说明。当我说“控制模拟器”时，我的意思是能够发送一些点击/输入内容并检查控制状态。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T20:48:00.233

茄子可能是你所追求的那种东西：

[https://www.testplant.com/products/eggplant/mobile/](https://www.testplant.com/products/eggplant/mobile/)

我从未使用过它，但我已经看到了它的演示。它通过*查看*屏幕来工作，因此它可以单击您指定的区域，查看结果是否看起来像您所说的那样，等等。

# iphone - 使用通知传递字符串，然后传递给类

> ID：13406466
> 
> 赞同：0
> 
> 时间：2012-11-15T21:23:26.253
> 
> 标签：iphone, subclass, userinfo, nscfstring

我有一个问题，我为 ipad 应用程序工作，在主视图的这个应用程序中，我有一个自定义 uitableviewcontroller 的实例，在行单击时，我发布了一个传递对象并运行方法的通知

```
- (void) drawWebView:(id) sender {

    NSDictionary *dict = [[sender userInfo] copy];
    self.objTesto = [dict objectForKey:@"Testo"];
    self.txtWeb = self.objTesto.testo;

    //[self setWebView:self.txtWeb];
    [self.textWebView loadRequest:[self creaFileHTML:text]];
} 
```

当我在我的类的 webview 上设置加载请求时，如果我使用 setWebView 方法创建 uiwebview 的子类：使用简单的 NSLog()

```
[self setWebView:self.txtWeb];
//[self.textWebView loadRequest:[self creaFileHTML:text]]; 
```

我收到此错误：

> 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[__NSCFString userInfo]：无法识别的选择器发送到实例 0xee3a1e0”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:49:03.847

要么错误的东西作为参数传递，要么你有内存管理问题。您需要找出一个字符串是如何被要求提供它的`userInfo`.

如果您更改参数声明并在您的方案中打开僵尸，应该清楚发生了什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:21:05.843

问题是我启动了错误的课程（我有两个类似的课程）-愚蠢的错误-.-对不起！

# animation - 在 Raphael 2 中沿路径设置动画？

> ID：13406470
> 
> 赞同：1
> 
> 时间：2012-11-15T21:23:52.057
> 
> 标签：animation, path, raphael, vector-graphics

使用一些自定义属性，单个路径的简单动画非常简单：

```
(function() {
  Raphael.fn.addGuides = function() {
    this.ca.guide = function(g) {
      return {
        guide: g
      };
    };
    this.ca.along = function(percent) {
      var box = this.getBBox( false );
      var g = this.attr("guide");
      var len = g.getTotalLength();
      var point = g.getPointAtLength(percent * len);
      var t = {
        transform: "...t" + [point.x - box.x, point.y - box.y]
  };
  return t;
    };
  };
})();

var paper = Raphael("container", 600, 600);

paper.addGuides();

var circ1 = paper.circle(50, 50, 40);
var circ2 = paper.circle(150, 50, 40);
var circ3 = paper.circle(250, 50, 40);
var circ4 = paper.circle(350, 50, 40);

var redarc = "M200,100 c 22-7,37,5,38,9";
var redarcpath = paper.path(redarc).attr({'stroke-width': '2', 'stroke': 'red'});

circ3.attr({guide : redarcpath, along : 1})
         .animate({along : 0}, 2000, "linear"); 
```

见：http: [//jsfiddle.net/p6Q3x/1/](http://jsfiddle.net/p6Q3x/1/)

但是当你`animate`在一个集合上调用这个相同的方法时，集合内元素的相对定位会被折叠。例如，这个“目标”的同心圆都在集合边界框的左上角堆叠在一起：

```
paper.setStart();
var inner = paper.circle(50, 250, 15);
var middle = paper.circle(50, 250, 30);
var outer = paper.circle(50, 250, 45);
var target = paper.setFinish();

var redarc = "M200,100 c 22-7,37,5,38,9";
var redarcpath = paper.path(redarc).attr({'stroke-width': '2', 'stroke': 'red'});

// basic animation of target on red arc collapses the shapes
target.attr({guide : redarcpath, along : 1})
         .animate({along : 0}, 2000, "linear"); 
```

见：http: [//jsfiddle.net/p6Q3x/3/](http://jsfiddle.net/p6Q3x/3/)

这很奇怪，因为该`along`方法中的小写相对“t”表明将保留相对定位。但不是。所以我开始克隆集合中每个元素的运动路径，并根据集合边界框中“子”路径的相对位置，对每个克隆路径应用不同的变换。但即使这样还不够，因为当路径用于动画时，变换矩阵会被忽略。因此，每个转换后的运动路径都必须“展平”回原始路径数据。我在这里使用了[Timo 的函数](https://stackoverflow.com/questions/8350254/how-to-apply-transform-matrix-to-path-coordinates-in-raphael-js-2/13210938#comment18168941_13210938)来进行展平部分：

```
function animateSet(set, pathToFollow) {
    var setBBox = set.getBBox(false);

    set.forEach(function (el) {
        var pathBBox = el.getBBox( false );

        // get the difference between the element's BBox
        // and its "parent" set's BBox coordinates
        var offset = "...t" + [pathBBox.x - setBBox.x, pathBBox.y - setBBox.y];

        // use offset to create a new, unique, displaced motion path
        var transformedPath = pathToFollow.clone()
                                          .hide()
                                          .transform(offset);

        // flatten that transformation back into raw path data
        var flatPathString = flatten_transformations(transformedPath, normalize_path, to_relative, dec);

        // and make a new Raphael path array out of that flattened data
        var shiftedPath = paper.path(flatPathString).hide();

        el.attr({guide : shiftedPath, along : 1})
          .animate({along : 0}, 2000, "linear", function() {
              transformedPath.remove(); // wipe out temporary motion paths
              shiftedPath.remove(); // when animation completes
        });
    });
} 
```

好消息是它有效！[http://jsfiddle.net/p6Q3x/](http://jsfiddle.net/p6Q3x/)

但这感觉*真的很*丑陋、臃肿、呆滞。我不敢相信这需要如此复杂。任何人都可以向新手推荐一种更简单、更清洁、更有效的方法吗？我的感觉是，需要为集合重写沿方法，以便集合的成员每个都有自己的边界框，但我不知道如何准确地做到这一点。非常感谢所有帮助。

# objective-c - 未设置对象属性

> ID：13406476
> 
> 赞同：0
> 
> 时间：2012-11-15T21:24:34.460
> 
> 标签：objective-c, arrays, macos

我有这个解析字符串的简短方法。

```
NSMutableArray *aircraftMutableArray;
- (void)parseAircraftRotations:(NSString*)inText
    {
    aircraftMutableArray = [NSMutableArray array];
    NSArray *inTextArray = [inText componentsSeparatedByString:@"\n"];

    for (NSString*line in inTextArray)
    {
        if ([line length] > 0)
        {
            if ([[line substringToIndex:1] isEqualToString:@"-"])
            {
                aircraft = [[AirCraft alloc] init];
                [aircraft setRegistration:[line substringFromIndex:1]];
                [aircraftMutableArray addObject:aircraft];
                aircraft = nil;
            }
        }
    }

    for (AirCraft *ac in aircraftMutableArray)
    {
        NSLog(@"%@", [ac registration]);
    }
} 
```

我现在的问题是 NSLog 打印出正确的行数，但 [ac registration] 在每一行上都是空的。请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:42:15.007

问题是 Aircraft 对象的属性是这样定义的

```
@property (nonatomic, weak) NSString *registration; 
```

应该很强

```
@property (nonatomic, strong) NSString *registration; 
```

# python - sqlalchemy：为什么我不能更新到 func.now()，但可以使用 'now()'？

> ID：13406480
> 
> 赞同：10
> 
> 时间：2012-11-15T21:24:46.720
> 
> 标签：python, sql, database, datetime, sqlalchemy

...当我尝试执行如下所示的查询时：

```
Session().query(MyMappedClass).update({MyMappedClass.time:func.now()}) 
```

我得到：

```
InvalidRequestError: Could not evaluate current criteria in Python. Specify 'fetch' or False for the synchronize_session parameter. 
```

但如果我这样做：

```
Session().query(MyMappedClass).update({MyMappedClass.time:'now()'}) 
```

...有用。有谁知道为什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-18T19:46:34.280

这在[update() 的文档中进行了解释](http://docs.sqlalchemy.org/en/latest/orm/query.html#sqlalchemy.orm.query.Query.update.params.synchronize_session)

> synchronize_session –</p>
> 
> 选择更新会话中对象属性的策略。有效值为：
> 
> False - 不同步会话。一旦会话过期，这个选项是最有效的并且是最可靠的，这通常发生在 commit() 之后，或者显式使用 expire_all()。在到期之前，更新的对象可能仍保留在会话中，其属性值过时，这可能会导致结果混乱。
> 
> 'fetch' - 在更新之前执行选择查询以查找与更新查询匹配的对象。更新的属性在匹配的对象上过期。
> 
> 'evaluate' - 直接在会话中的对象上评估 Python 中的查询条件。如果未实施标准评估，则会引发异常。

update() 默认情况下希望刷新缓存在 Session 中的那些对象，而无需进行数据库往返。 `func.now()`是一个 SQL 函数，需要此往返行程才能继续。发送字符串`"now()"`不是您想要的，因为这会将字段的值设置为字符串“now()”，并且实际上不会使用 SQL 时间函数。您应该将 synchronize_session=False 传递给 update()。

# php - 爆炸字符串获取第一个句子第一个图像

> ID：13406483
> 
> 赞同：0
> 
> 时间：2012-11-15T21:24:55.473
> 
> 标签：php, html, regex, string

> **可能的重复：**
> [用于 PHP 的强大、成熟的 HTML 解析器](https://stackoverflow.com/questions/292926/robust-mature-html-parser-for-php)

我正在尝试获取字符串的第一句话和第一个图像 html 实例。

```
$description = preg_split('/<img/', $item->description,null,PREG_SPLIT_DELIM_CAPTURE); 
```

我能够返回一个数组，但它正在`<img`从它的值中删除所需的值。我尝试过使用标志，但无法获得我正在寻找的需要包含分隔符本身的返回。我知道要抓住第一句话，我应该能够按句点或`&nbsp;`

细绳：

```
<p>First sentence here comes.&nbsp; Second sentence here it is.&nbsp; One more sentence.&nbsp;&nbsp;</p> <img alt="amj" src="https://domain.com/images7.jpg" /> <img alt="Ea" src="http://domain.com/images3.jpg" /> <img alt="amj" src="https://domain.com/images7.jpg" /> <img alt="amj" src="https://domain.com/images7.jpg" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:39:27.273

获取第一句话非常简单。您只需要使用 和 的混合物，`strpos`如下`substr`所示。至于获取第一个图像标签，您可以使用`preg_match`表达式来做到这一点。

```
$first_sentence = substr($item->description, 0, strpos($item->description, )) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:44:33.067

1) 第一句话

```
echo substr($item->description, 0, strpos('.', $item->description)); 
```

2) 图像

```
preg_match('#<img[^>]*>#',$item->description , $img);
echo $img[0]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T08:42:38.783

如果您使用，则`PREG_SPLIT_DELIM_CAPTURE`需要在与[`preg_split`](http://php.net/preg_split).

在您当前的模式中：

```
/<img/ 
```

有东西可以捕捉，这就是为什么你看到它被移除（[Demo](http://eval.in/3555)）：

```
Array
(
    [0] => <p>First sentence here comes.&nbsp; Second sentence here it is.&nbsp; One more sentence.&nbsp;&nbsp;</p> 
    [1] =>  alt="amj" src="https://domain.com/images7.jpg" /> 
    [2] =>  alt="Ea" src="http://domain.com/images3.jpg" /> 
    [3] =>  alt="amj" src="https://domain.com/images7.jpg" /> 
    [4] =>  alt="amj" src="https://domain.com/images7.jpg" />
) 
```

但是，如果您从中创建捕获，它将被捕获：

```
/(<img)/ 
```

结果（[演示](http://eval.in/3556)）：

```
Array
(
    [0] => <p>First sentence here comes.&nbsp; Second sentence here it is.&nbsp; One more sentence.&nbsp;&nbsp;</p> 
    [1] => <img
    [2] =>  alt="amj" src="https://domain.com/images7.jpg" /> 
    [3] => <img
    [4] =>  alt="Ea" src="http://domain.com/images3.jpg" /> 
    [5] => <img
    [6] =>  alt="amj" src="https://domain.com/images7.jpg" /> 
    [7] => <img
    [8] =>  alt="amj" src="https://domain.com/images7.jpg" />
) 
```

如您所见，`preg_split`它是否已记录在案，并且会在每次捕获第一个捕获 supgroup时添加*另一个拆分（它只会占用第一个）。*然后，您可能需要将其扩展到完整标签，例如，在其他类似 html-like-string-regex 的问题中已经概述了该标签（像往常一样受到正则表达式的限制，因此责怪您使用 preg_* 函数而不是 HTML如果遇到问题，解析器，而不是模式本身：

```
/(<img [^>]*>)/ 
```

结果（[演示](http://eval.in/3553)）：

```
Array
(
    [0] => <p>First sentence here comes.&nbsp; Second sentence here it is.&nbsp; One more sentence.&nbsp;&nbsp;</p> 
    [1] => <img alt="amj" src="https://domain.com/images7.jpg" />
    [2] =>  
    [3] => <img alt="Ea" src="http://domain.com/images3.jpg" />
    [4] =>  
    [5] => <img alt="amj" src="https://domain.com/images7.jpg" />
    [6] =>  
    [7] => <img alt="amj" src="https://domain.com/images7.jpg" />
    [8] => 
) 
```

通过使用标准的 HTML 解析器，您可以使您的代码更加稳定。

# git - 在 Aptana 3 中关闭文件缓存

> ID：13406487
> 
> 赞同：1
> 
> 时间：2012-11-15T21:25:04.990
> 
> 标签：git, caching, aptana, aptana3

Aptana 3 正在缓存我的文件，这很痛苦。这是我在不同的组合中第三次安装 Aptana，也是我第一次遇到这个问题。

例子：

我打开 application.tpl 并编辑它，然后保存。我通过 git application.tpl 覆盖，当我打开它时，它是我的旧版本，而不是新的被覆盖的版本。我可以将 application.tpl 复制到 application 2.tpl，打开它，编辑它，保存它。删除 application.tpl。将应用程序 2.tpl 重命名为 application.tpl。瞧，Aptana 会打开旧版本的 application.tpl。

这是一个巨大的问题。

额外信息：我没有使用 git 插件，我使用的是 git 终端。这是 Macbook Pro 上的 Aptana 3 的 Mac 版本。我在一台笔记本电脑上也有一个 Windows 版本，它不这样做，我在 iMac 上还有另一个 Mac Aptana 3，它也不这样做。我只在 Macbook pro 上使用 git，所以我认为这可能是 Aptana 中的一个错误，可能与不使用 git 插件有关......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:57:51.573

如果您使用的是使用 Eclipse 3.7 平台的最新版本的 Aptana Studio，您`Preferences-> General -> Workspace`可以选择。确保它们都被选中。`Refresh using native hooks or polling``Refresh on Access`

# jquery - 每个元素的返回值

> ID：13406488
> 
> 赞同：0
> 
> 时间：2012-11-15T21:25:07.780
> 
> 标签：jquery

我是 jQuery 的新手，我在让这个东西正常工作时遇到了一些麻烦。

```
<ul id="mediaGallery">
    <li><a href="#">https://www.youtube.com/watch?v=YVw7eJ0vGfM</a></li>
    <li><a href="#">https://www.youtube.com/watch?v=LW0k4eOEJ4U</a></li>
    <li><a href="#">https://www.youtube.com/watch?v=_SM7jtNOTXg</a></li>
</ul> 
```

这个想法是获取 url 的最后一部分（例如：**YVw7eJ0vGfM**），清空`<a>`元素并将其替换为 an`<img>`并在图像的 src 路径的末尾返回 url 的最后一部分以显示缩略图youtube 视频动态。

```
//get the content of the <a> element
var video_href = $('#mediaGallery li a').html();

//get the last part of the url
var id_video = video_href.substr(video_href.length - 16);

//predifined img html whith the id of the video
var img_path = $('<img src="http://img.youtube.com/vi/'+id_video+'/0.jpg" />');

//empty the <a> element
$('#mediaGallery li a').empty();

//insert the img var
$('#mediaGallery li a').append(img_path); 
```

问题是只有第一个视频 id 被返回并粘贴到 all 中`<a>`。

我怎样才能返回每个视频 ID 而不仅仅是第一个？

任何帮助将不胜
感激谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:28:06.790

将其包装在 $.each 中：

```
$('li a','#mediaGallery').each(function() {
    var me = $(this),
        id = me.html().substr(video_href.length - 16);
    me.empty().append($('<img />').attr('src', 'http://img.youtube.com/vi/'+id+'/0.jpg')
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:29:17.460

如果视频在id后面还有其他参数怎么办？我建议您在与 each 迭代的每个链接上使用简单的正则表达式提取[id](http://api.jquery.com/each/)。

```
$('#mediaGallery li a').each( function() {
  var id = /\?v=(\w+)/.exec( $(this).text() )[1];
  ...
}); 
```

这应该可以帮助您走上正确的道路。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T21:31:26.263

用一个`$.each loop`

```
$('#mediaGallery li a').each(function(){
    var video_href = $(this).html();
    var id_video = video_href.split("=")[1];

    var img_path = $('<img src="http://img.youtube.com/vi/'+id_video+'/0.jpg" />');

    $(this).empty().html(img_path);

}); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/UZrNW/)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T21:28:58.187

您需要使用每个循环：

```
 $("#mediaGallery li a").each(function() {
    //get the content of the <a> element
        var video_href = $(this).html();

        //get the last part of the url
        var id_video = video_href.substr(video_href.length - 16);

        //predifined img html whith the id of the video
        var img_path = $('<img src="http://img.youtube.com/vi/'+id_video+'/0.jpg" />');

        //empty the <a> element
        $(this).empty();

        //insert the img var
        $(this).append(img_path);
    } 
```

# php - 由于 html 表单中的验证，PHP 文件不会运行

> ID：13406489
> 
> 赞同：0
> 
> 时间：2012-11-15T21:25:08.607
> 
> 标签：php

当我有自定义验证时，当我点击提交时，我无法运行我的 php 文件。当我在下拉框中选择其他时，会出现一个文本框。一旦我点击提交，它将不会运行我的 php 文件。如果我在没有此自定义验证的情况下在下拉列表中选择一个值，我的 php 文件将运行。

```
<body>
<form action="form-to-email.php" method="post" name="LeaveRequestPart1" id="LeaveRequestPart1">
    <table class="LeaveRequestPart1" align="center">

<tr>
    <td colspan="2"><font color="red">*</font>
        <label>Type of Leave</label>
            <select name="TypeOfLeave" id="TypeOfLeave" onchange =
           "if(this.value=='Other'{this.form['Other'].style.visibility='visible'}else {this.form['Other'].style.visibility='hidden'};">
                <option value="N/A"></option>                       
                        <option value="Vacation">Vacation</option>
                        <option value="Illness">Illness</option>
                        <option value="FamilyIllness">Family Illness</option>
                        <option value="Bereavement">Bereavement</option>
                        <option value="PersonalWithPay">Personal - with pay</option>
                        <option value="PersonalWithoutPay">Personal - without pay</option>
                        <option value="JuryDuty">Jury Duty</option>
                        <option value="Military">Military</option>
                        <option value="Pallbearer">Pallbearer</option>
                        <option value="Professional" id="Professional">Professional</option>
                        <option value="Routine" id="Routine">Routine - overnight</option>

                <option value="Other">Other</option>
            </select> 
            <input type="text" name="Other" id="Other" style="visibility:hidden;" />
    </td>
</tr>
        </table>
</form>
</body>

</html> 
```

PHP 代码

```
<?php
if(!isset($_POST['submit']))
{
//This page should not be accessed directly. Need to submit the form.
echo "Form Error; You need to submit the form. ";
}

//Form Variables
$ID = $_POST['ID'];
$Name = $_POST['Name'];
$CampusLocation = $_POST['CampusLocation'];
$TypeOfRequest = $_POST['TypeOfRequest'];
$TypeOfLeave = $_POST['TypeOfLeave'];
$Other = $_POST['Other'];

   //Validate first
   if(IsInjected($SEmail))
   {
       echo "Bad email value!";
       exit;
    }

if(IsInjected($YEmail))
    {
        echo "Bad email value!";
        exit;
    }

$Email_subject = "Leave Request Submitted";

//Start of Email body. Do not remobe BODY commands
$Email_body = <<<BODY

Employee ID: $ID
Name: $Name
Campus: $CampusLocation
Type of Request: $TypeOfRequest
Type of Leave: $TypeOfLeave
Other Type of Leave: $Other

Employee CCC email address: $YEmail@cccneb.edu
BODY;
//End of Email body

// single email address 

$to = "$SEmail@cccneb.edu";
$to2 = "$YEmail@cccneb.edu";

// multiple recipients
//$to  = 'YEmail@cccneb.edu' 

//Email From & Reply
$headers = "From: $to2 \r\n";
$headers .= "Reply-To: $to2 \r\n";

//Send the email!
mail($to,$Email_subject,$Email_body,$headers);

//done. redirect to thank-you page.
header('Location: form-end.html');

// Function to validate against any email injection attempts
function IsInjected($str)
{
    $injections = array('(\n+)',
          '(\r+)',
          '(\t+)',
          '(%0A+)',
          '(%0D+)',
          '(%08+)',
          '(%09+)'
          );
  $inject = join('|', $injections);
  $inject = "/$inject/i";
  if(preg_match($inject,$str))
      {
          return true;
      }
  else
      {
          return false;
      }
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:41:47.957

检查页面是否抛出任何 javascript 错误。我可以在您的事件中看到一个错误`onChange`- 缺少右括号`if`。尝试

```
<select name="TypeOfLeave" id="TypeOfLeave" 
    onchange="
        if(this.value == 'Other') {
            this.form['Other'].style.visibility = 'visible';
        } else {
            this.form['Other'].style.visibility = 'hidden';
        }"> 
```

如果你也可以使用三元

```
onchange="this.form['Other'].style.visibility = (this.value == 'Other') ? 'visible': 'hidden';" 
```

# javascript - 如何在指令的链接函数中测试行为

> ID：13406491
> 
> 赞同：48
> 
> 时间：2012-11-15T21:25:11.103
> 
> 标签：javascript, angularjs, jasmine

在我的一些指令中，我将函数添加到范围以处理特定于指令的逻辑。例如：

```
link: function(scope, element, attrs) {
         scope.doStuff = function() {
            //do a bunch of stuff I want to test
         }        
      } 
```

我该如何测试该功能？我搜索了如何测试指令，但[我发现](https://stackoverflow.com/questions/12755421/how-to-test-angularjs-directives)更多的是关于测试元素的更改。我当然可以在每次测试之前编译我的指令，但这每次都会清除我的范围。我想在我的范围更改中测试该函数作为属性。

有没有办法获取从指令定义返回的对象？然后我可以直接调用链接函数并测试作用域上定义的每个函数的行为。有没有更好的方法来完成这一切？

我正在使用 Jasmine 运行我的测试，并且我想在`describe`函数中设置我的范围，所以我可以`it`为相同的范围数据设置多个函数。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-11-16T15:59:56.427

基本上，不是测试链接函数本身，而是以编程方式测试指令的结果。你要做的就是将指令写成一个字符串，然后用`$compile`角度处理它。然后你测试输出以确保一切都正确连接。

Angular 的源代码充满了如何做到这一点的好例子……例如[Angular 对 ngRepeat 指令的测试](https://github.com/angular/angular.js/blob/master/test/ng/directive/ngRepeatSpec.js)

您可以看到他们正在做的是设置指令，更改范围（在这种情况下`$rootScope`）确保它被`$digest`编辑，然后测试它输出的 DOM 以确保一切都正确连接。如果指令正在改变它，您还可以测试范围内的内容。

[ngClick 的测试](https://github.com/angular/angular.js/blob/master/test/ng/directive/ngClickSpec.js)也很有趣，因为它显示了对浏览器交互的测试以及它对范围的影响。

为了完整起见，这里有一个来自 ngClick 测试的片段，我认为它很好地总结了测试指令：

```
 it('should get called on a click', inject(function($rootScope, $compile) {
   element = $compile('<div ng-click="clicked = true"></div>')($rootScope);
   $rootScope.$digest();
   expect($rootScope.clicked).toBeFalsy();

   browserTrigger(element, 'click');
   expect($rootScope.clicked).toEqual(true);
 })); 
```

所以在你的`scope.doStuff`函数的情况下，我不会测试它在*做什么*，就像我会测试它在范围内影响的任何东西，然后它会影响 DOM 元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-03T21:59:39.810

如果需要，可以直接对指令的链接方法进行单元测试。请参阅 angular-ice 模块的单元测试器：“测试指令配置”

[http://bverbist.github.io/angular-ice/#/unitTester](http://bverbist.github.io/angular-ice/#/unitTester)

示例用法：[https ://github.com/bverbist/angular-ice/blob/master/app/components/icebank/bank-account-number-directive_link_test.js](https://github.com/bverbist/angular-ice/blob/master/app/components/icebank/bank-account-number-directive_link_test.js)

在您的情况下，您可以保留对传递给指令链接方法的范围对象的引用，然后您可以直接在该范围上测试 doStuff 函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-28T23:44:36.617

我以不同的方式解决了这个问题。

如果您的指令中有一个非常简单的链接函数并且您不需要第三个参数（**attrs**），只需摆脱链接函数并为指令分配一个**控制器**。

```
app.directive('loadIndicator', function() {
  return {
    restrict: 'E',
    replace: true,
    templateUrl: 'blahblah/indicator.html',
    controller: 'LoadIndicatorController'
  };
}); 
```

就像您在指令的链接函数中拥有范围和元素的参数一样，这两个参数可以作为**$scope**和**$element**注入到易于测试的控制器中。

如果您能够创建控制器并对这些控制器进行单元测试，那么这将非常容易做到。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-05T18:02:47.623

正如对@sqlexception 的评论回复中所述。您只需要真正掌握指令的范围，这并不难。你不想做的是修改你的代码以满足你的测试，因为它应该是相反的。

要获得指令的范围，只需像这样编译：

`var element = $compile(<directive's html>).($scope)`

where`$scope`用`$scope = $rootScrope.$new()`. 现在我们可以通过做得到隔离范围`element.scope()`

我最近刚刚写了一篇关于这个的简短博客文章，在这里找到了用 plunker[测试链接函数](http://brilliantbritz.com/2015/02/04/getting-the-isolate-scope-of-a-directive/) 来提供帮助：

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-12T17:05:51.110

```
 it('should get called on a click', inject(function($rootScope, $compile) {
   var scope = $rootScope.$new();
   element = $compile('<div ng-click="doIt()"></div>')(scope);
   scope.$digest();
   expect(scope.$$childHead.doIt()).toBeDefined();
 })); 
```

使用这个 $$childHead 是我解决同样问题的方法，这样我可以覆盖在我的测试中没有被调用的函数。

# ruby-on-rails - 错误运行 capistrano

> ID：13406492
> 
> 赞同：0
> 
> 时间：2012-11-15T21:25:12.240
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, capistrano

这是我第一次使用 capistrano，我收到以下错误

```
*** [deploy:update_code] rolling back
  * executing "rm -rf /home/deployer/apps/cf/releases/20121115211351; true"
    servers: ["208.68.37.172"]
    [208.68.37.172] executing command
    command finished in 9420ms
failed: "sh -c 'cd /home/deployer/apps/cf/releases/20121115211351 && bundle install --gemfile /home/deployer/apps/cf/releases/20121115211351/Gemfile --path /home/deployer/apps/cf/shared/bundle --deployment --quiet --without development test'" on 208.68.37.172 
```

我什至不明白错误信息。任何帮助解决这个问题。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:28:24.573

意思是如果未能在主机 208.68.37.172 上运行该命令。这个命令：

```
sh -c 'cd /home/deployer/apps/cf/releases/20121115211351 && bundle install --gemfile /home/deployer/apps/cf/releases/20121115211351/Gemfile --path /home/deployer/apps/cf/shared/bundle --deployment --quiet --without development test'" 
```

如果它没有为您提供任何其他信息，您可以调整配置以`--quiet`从 bundle 命令中删除以获得更多输出，或者在服务器上手动运行它以查看发生了什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:52:04.760

关于 capistrano 要了解的一点是，它主要通过 ssh 远程运行命令，因此您可以通过尝试类似的方式来中断给定的命令`ssh someuser@somehost somecommand`，其中“somecommand”是失败的行。为了更接近问题，首先 ssh 进入主机，然后运行命令（例如`sh -c 'cd /home/deployer'`是 command `cd /home/deployer`），如果没有返回错误`&&`将成功，并尝试运行下一个`bundle install ...`

capistrano 错误的最常见原因是用户没有足够的权限，尽管在您的情况下，如果您失败了，`bundle install`您是否在本地使用 RVM - 如果是这样，它是否设置在部署服务器上？

# c# - 部分视图的远程服务器上的 503 错误

> ID：13406493
> 
> 赞同：1
> 
> 时间：2012-11-15T21:25:15.020
> 
> 标签：c#, asp.net-mvc-4

我遇到了一个与我正在尝试设置的小型 Intranet 应用程序相关的令人费解的问题。

我使用 Windows Auth 在 IIS 中运行它。一切都在正常运行，除了这一件事。

在我的设置页面上，我有一个“用户管理员”列表，他们批准或拒绝其他用户提交的内容。我进行了这样的设置，以便我可以从网站本身中添加或删除管理员。在 VS2010 中，这在我的本地机器上一切正常，但是，我尝试推送到我的开发测试服务器并遇到了一个问题：*每当我单击“添加管理员”链接时，服务器在 javascript 控制台中返回 503 错误尝试点击“设置/UserAdminRow”时。*

这让我感到困惑，因为它在本地运行良好，并且该站点的其余部分运行良好。我的任何日志中都没有错误（为此应用程序设置的自定义日志、Windows 事件日志等）。

这是设置页面的 Razor 代码和 javascript。

```
<ul id="adminEditor" style="list-style-type: none">
    @foreach (string userAdmin in Model.UserAdmins)
    {
        Html.RenderPartial("UserAdminsEditor", userAdmin);
    }
</ul>
<a id="addAnother">@StringTable.GetString("AddAdmin")</a>     

<script type="text/javascript" language="javascript">
<!--
$("#addAnother").click(function () {
    $.get('Settings/UserAdminRow', function (template) {
        $("#adminEditor").append(template);
    });
});
-->   
</script> 
```

这就是它的要求：

```
public ActionResult UserAdminRow()
{
     return PartialView("UserAdminsEditor");    
} 
```

这是“UserAdminsEditor”剃须刀代码。

```
@model string

<li style="padding-bottom: 15px">
@using (Html.BeginCollectionItem("UserAdmins"))
{
    @Html.TextBoxFor(model => model)

    <a href="#" onclick="$(this).parent().remove();">@StringTable.GetString("Remove")</a>
}

</li> 
```

`BeginCollectionItem`是对我在这里找到的扩展方法的引用：http: [//ivanz.com/2011/06/16/editing-variable-length-reorderable-collections-in-asp-net-mvc-part-1/](http://ivanz.com/2011/06/16/editing-variable-length-reorderable-collections-in-asp-net-mvc-part-1/)

有什么建议么？我完全被难住了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:57:45.863

对此进行简单修复。将呼叫中的 url`$.get`从“Settings/UserAdminRow”更改为“./Settings/UserAdminRow/”，它工作正常。我需要做的就是添加句点。

# url - mod_rewrite 重定向到 php 文件

> ID：13406495
> 
> 赞同：1
> 
> 时间：2012-11-15T21:25:27.967
> 
> 标签：url, mod-rewrite, redirect, profile

我想要：www.example.com/username

重定向到：www.example.com/user.php?id=username

尝试使用我发现的这个 mod_rewrite 规则： RewriteRule ^user/([az]+)/?$ user.php?id=$1

我对此进行了很多研究，但仍然无法使其正常工作。我开始认为某处存在冲突……我不知道。我迷路了。

```
 <VirtualHost 111.111.111.111.:443>
    ServerAdmin webmaster@localhost
    ServerName example.com
    ServerAlias www.example.com

    DocumentRoot /home/public

    <Directory /home/public>
            Options -Indexes FollowSymLinks MultiViews
            AllowOverride None
            Order allow,deny
            allow from all
    </Directory>

    RewriteEngine On
    RewriteRule ^user/([a-z]+)/?$ user.php?id=$1

     ErrorLog /var/log/apache2/error.log

    # Possible values include: debug, info, notice, warn, error, crit,
    # alert, emerg.
    LogLevel warn

     CustomLog /var/log/apache2/access.log combined

<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond %{REQUEST_METHOD} ^(TRACE|TRACK)
RewriteRule .* - [F]
</IfModule>

</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:33:52.287

除了 mod_rewrite，您可以使用**.htaccess**将 404 重定向到一个 .php 文件，该文件以类似于 $_GET 的方式处理 URI。`$_SERVER['REQUEST_URI']`并且`preg_match()`应该有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:37:49.693

```
RewriteEngine on
RewriteRule ^user/([^/\.]+)/?$ /user.php?id=$1 [L] 
```

这将导致所有 /user/username 被重定向到 user.php?id=username。然后，您可以签入您的 PHP：

```
if (isset($_GET['user'])) {
  // Check if the username exists.
  // SELECT ... FROM users WHERE username = ..
} 
```

# wordpress - wordpress上传过程中的文件重命名功能

> ID：13406501
> 
> 赞同：1
> 
> 时间：2012-11-15T21:25:37.610
> 
> 标签：wordpress

我有一个脚本，可以从预定义的数组中自动加载帖子，并将图像作为特色图像从本地机器上的物理路径上传。

当我将文件复制到上传目录时，我使用路径和文件名，如下所示：

```
$upload_dir['path'].'/'.$new_post_id.$filename 
```

这样，如果我多次上传apple.jpg，该文件将被命名为1apple.jpg、2apple.jpg等，并且不会被覆盖。

但是，我想使用 Wordpress 原生函数来检查和重命名文件。在 wordpress 上传中，如果您多次上传 apple.jpg，它会在扩展名前添加一个新数字，如下所示：apple1.jpg、apple2.jpg 等，并且数字部分不是基于帖子的。

我想知道您是否可以将我指向 wordpress 中执行此检查并创建新文件名的函数，以便我可以使用 wordpress 本机函数来命名我上传的文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T20:32:17.877

我找到了答案：wp_unique_filename()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T01:02:48.813

您需要过滤功能[`wp_unique_post_slug()`](http://core.trac.wordpress.org/browser/tags/3.4.2/wp-includes/post.php#L2834)。

如[WPSE](https://wordpress.stackexchange.com/q/73983/12615)中所述。

# php - PHP 验证输入表单

> ID：13406503
> 
> 赞同：-1
> 
> 时间：2012-11-15T21:25:41.837
> 
> 标签：php, validation, function-parameter

我正在制作输入表单，目前正在验证代码。我从博客中遇到了这个验证代码，它看起来很整洁。有人知道如何将此代码实现为表单吗？任何帮助表示赞赏。

```
function field_validator($field_descr, $field_data, $field_type, $min_length="", $max_length="", $field_required=1) {
    # array for storing error messages
    global $messages;

    # first, if no data and field is not required, just return now:
    if(!$field_data && !$field_required){ return; }
     # initialize a flag variable - used to flag whether data is valid or not
    $field_ok=false;
     # this is the regexp for email validation:
    $email_regexp="^([a-zA-Z0-9_-.]+)@(([[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.)|"
    $email_regexp.="(([a-zA-Z0-9-]+.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(]?)$";
     # a hash array of "types of data" pointing to "regexps" used to validate the data:
    $data_types=array(
        "email"=>$email_regexp,
        "digit"=>"^[0-9]$",
        "number"=>"^[0-9]+$",
        "alpha"=>"^[a-zA-Z]+$",
        "alpha_space"=>"^[a-zA-Z ]+$",
        "alphanumeric"=>"^[a-zA-Z0-9]+$",
        "alphanumeric_space"=>"^[a-zA-Z0-9 ]+$",
        "string"=>""
    );

    # check for required fields
    if ($field_required && empty($field_data)) {
        $messages[] = "$field_descr is a required field.";
        return;
    }

    # if field type is a string, no need to check regexp:
    if ($field_type == "string") {
        $field_ok = true;
    } else {
        # Check the field data against the regexp pattern:
        $field_ok = ereg($data_types[$field_type], $field_data);
    }

    # if field data is bad, add message:
    if (!$field_ok) {
        $messages[] = "Please enter a valid $field_descr.";
        return;
    }

    # field data min length checking:
    if ($field_ok && $min_length) {
        if (strlen($field_data) $max_length) {
            $messages[] = "$field_descr is invalid, it should be less than $max_length characters.";
            return;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:37:06.170

尝试使用Jquery ...

```
<form id="regForm" name="regForm" method="post" action="insert.php">
    <label for="Fname">Name </label>
    <input id="_Fname" name= "Fname" value=''/>
    <input id="_Lname" name= "Lname" value=''/>
    <input id="saveForm" type="submit" name="submit" value="Submit" />
</form> 
```

js文件会是这样的..

```
(function($,W,D)
{
    var JQUERY4U = {};

    JQUERY4U.UTIL =
    {
        setupFormValidation: function()
        {
            //form validation rules
            $("#regForm").validate({
        rules: {
                    Fname:{ 
            required: true,
            minlength: 3
            },
                    Lname:{ 
            required: true,
            minlength: 3
            },
            },
            messages: {
                    Fname:{ 
            required: "Please enter your firstname",
            minlength: "name must b 3 character long"
            },
                    Lname: { 
            required: "Please enter your lastname",
            minlength: "name must b 3 character long"
            }
    }
    $(D).ready(function($) {
        JQUERY4U.UTIL.setupFormValidation();
     });
})(jQuery, window, document); 
```

# javascript - chrome 活动标签 url 传递给 php 文件

> ID：13406511
> 
> 赞同：1
> 
> 时间：2012-11-15T21:26:19.097
> 
> 标签：javascript, google-chrome, tabs, google-chrome-extension

我正在为 Chrome 制作扩展程序，我需要将活动选项卡的 url 传递给带有 php 代码的文件。我的 manifest.json 代码：

```
{  "name": "demo", 
   "version": "1.0",
   "manifest_version": 2,
   "description": "Making your first Google Chrome extension.",
   "browser_action": {
       "default_icon": "icon.png",
       "default_popup": "chrome.html"
   },
   "permissions": [
       "http://www.mysite.com/",
   "tabs"
   ]
} 
```

和 AJAX 代码：

```
window.onload = function() {
var XHR = new XMLHttpRequest;
chrome.tabs.query({active:true,currentWindow:true},
      function(tab){tabUrl = tab.url;});
XHR.open('GET', 'http://www.mysite.com/chrome/chrome.php?tab='+tabUrl+'', true);
XHR.onreadystatechange = function () {
  if (4 == this.readyState) {
    var status = this.status;
    if (400 > status) {
      var responseText = this.responseText;
      if (responseText) {
        document.getElementById('resultado').innerHTML = responseText;
      }
    }
  }
};
XHR.send();
} 
```

感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T20:12:33.700

我认为你应该这样做，因为在你的代码中，因为 tabs.query 是异步的，当 XHR.send(); 执行 tabUrl 尚未设置。

```
window.onload = function() {
  var XHR = new XMLHttpRequest;
  chrome.tabs.query({
    active: true,
    currentWindow: true
  }, function(tab) {

    tabUrl = tab.url;
    XHR.open('GET', 'http://www.mysite.com/chrome/chrome.php?tab=' + tabUrl + '', true);
    XHR.onreadystatechange = function() {
      if(4 == this.readyState) {
        var status = this.status;
        if(400 > status) {
          var responseText = this.responseText;
          if(responseText) {
            document.getElementById('resultado').innerHTML = responseText;
          }
        }
      }
    };
    XHR.send();

  });

} 
```

# groovy - GPars forkOffChild 异常处理

> ID：13406515
> 
> 赞同：1
> 
> 时间：2012-11-15T21:26:32.553
> 
> 标签：groovy, gpars

我正在使用 GPars 的 fork/join。当我在调用 forkOffChild 后抛出异常时，它会被掩埋。

例如：

```
def myRecursiveClosure = { boolean top ->
    try {
        if (!top) {
            throw new RuntimeException('child had a problem')
        } else {
            forkOffChild(false)
        }
    } catch (Exception exc) {
        println 'Exception handled internally'
        throw exc
    }
}

try {
     GParsPool.withPool {
         GParsPool.runForkJoin(true, myRecursiveClosure)
    }
} catch (Exception exc) {
     println 'Exception handled externally'
     throw exc
} 
```

在这里，我设置了一个标志，因此我知道闭包已被递归调用。然后，我抛出一个异常，它被“内部”捕获，但重新抛出从未被“外部”捕获。所以我不知道分叉的孩子失败了。

我也尝试了异常处理程序，但它似乎也没有被调用。

这是预期的行为，还是我做错了什么？有什么策略可以帮助解决这个问题吗？我不能让孩子默默地失败。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T10:45:09.563

这里重要的部分是 forkOffChild() 不会等待孩子运行。它只是安排它执行。因此，您不能指望 forkOffChild() 方法会传播来自子级的异常，因为它们很可能在父级从 forkOffChild() 方法返回后很久才发生。

然而，通常情况下，父母对子计算的结果感兴趣，因此它在分叉后的某个时候使用 getChildrenResults() 方法收集结果。这将为您返回计算值列表或重新引发潜在异常。

此代码段显示了获得预期行为的最小更改：

```
 try {
        if (!top) {
            throw new RuntimeException('child had a problem')
        } else {
            forkOffChild(false)
            println childrenResults
        }
    } catch (Exception exc) {
        println 'Exception handled internally'
        throw exc
    } 
```

# linux - Shell 的交错脚本

> ID：13406518
> 
> 赞同：1
> 
> 时间：2012-11-15T21:26:47.840
> 
> 标签：linux, shell

我需要编写一个脚本来交错两个不同文件的内容。例如，执行 './inter2files file1 file2' 会给我：

文件 1 线 1 文件 2
* 线 1 文件 1 线
2 文件 2 * 线
2

我到目前为止的代码是：

```
exec 30< file1
exec 40< file2
read line1 <& 30 
read line2 <& 40
echo $line1 
echo $line2 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:36:43.073

你可以这样做`paste`：

```
paste -d "\n" file1 file2 > output_file 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T18:33:14.023

用 Perl 脚本解决了这个问题

```
#!/usr/bin/perl

do { open($fh[$_], "<$ARGV[$_]") or die("'$ARGV[$_]' does not exist") } for (0..$#ARGV);

for ($i=0;;$i++) {
    $j=$#ARGV+1;

    $fh = $fh[$i%$j];
    if ( $_ = <$fh> ) {
            print $_;
    } else {
            $end |= 2**($i%$j);
    }

    if($end == (2**($j))-1) {
            last;
    }
}

close($_) for(@fh); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:00:41.137

```
declare -a f1=(`cat file1`)
declare -a f2=(`cat file2`)
count=`echo ${#f1[@]}` # Number of elements in the array
#### assuming the line counts are the same between file1 and file2
i=0
while [ ${i} -le ${count} ]
do
  echo ${f1[${i}]}"   "${f2[${i}]}
  (( i=${i}+1 ))
done 
```

由于数组声明使用内存空间，如果您的文件很大，这可能会导致您出现不可预知的行为，但如果您一次只处理几百行有价值的文件，这种方法应该有效。

# sql - 在收入数据上显示不同的日期期间

> ID：13406521
> 
> 赞同：0
> 
> 时间：2012-11-15T21:26:50.500
> 
> 标签：sql

我有以下查询，它显示如下数据：

```
Income Type This Month  Last Month  This Year   Last Year
1           179640.00   179640.00   179640.00   179640.00
2           12424440.00 12424440.00 12424440.00 12424440.00

Select
  Income_Type As [Income Type],
  Sum(Income_Amount) As [This Month],
  Sum(Income_Amount) As [Last Month],
  Sum(Income_Amount) As [This Year],
  Sum(Income_Amount) As [Last Year]
From Income I
Left Join Finance_Types FT On I.Income_Type = FT.Type_ID
Group By
Income_Type 
```

收入表有一个收入日期，它是一个日期时间列。

如果可能的话，我正在努力弄清楚如何在一个查询中使用正确的总和提取“本月”、“上个月”、“今年”、“去年”的数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:31:37.557

使用日期函数：

```
SUM(CASE WHEN YEAR(yourdatefield) = YEAR(GetDate()) - 1 THEN Income_Amount ELSE 0 END) AS 'Last Year' 
```

如果是最后一年，该案例语句仅返回 Income_Amount，因此您将仅汇总这些金额。

如果您不使用 SQL Server，则语法可能会有所不同。

# java - Java while循环问题

> ID：13406522
> 
> 赞同：2
> 
> 时间：2012-11-15T21:26:53.143
> 
> 标签：java, while-loop

我有一个没有执行的while循环。我不相信有无限循环或启动问题，但有吗？我找不到我的逻辑错误！

```
public class Test
{
    public static void main (String [] args)
    {
        int i = 1;
        int j = 1;
        while  ((i < 10) && (j*j != 25));
        { 
           i++;  
           ++j;
           System.out.println( i * j );
        }   
    }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-15T21:27:50.113

删除while循环后的分号

```
public static void main (String [] args)
{
     int i = 1;
     int j = 1;
     while  ((i < 10) && (j*j != 25)) //Semicolon removed from here
     { 
        i++;  
        ++j;
        System.out.println( i * j );
     }   
} 
```

如果没有用大括号括起来，则直接出现在循环声明之后的任何语句都被视为整个块。

IE

```
if( true ) 
    System.out.println( "hello" );
    System.out.println( "world" ); 
```

被视为

```
if( true ) {
     System.out.println( "hello" );
}
System.out.println( "world" ); 
```

单个分号被视为[空语句](http://wiki.answers.com/Q/In_java_what_is_empty_statement.Explain_its_usefulness)，因此构成了整个循环体。

# vb.net - 更好地使用 Validating 或 Leave 事件来验证文本框数据？

> ID：13406528
> 
> 赞同：7
> 
> 时间：2012-11-15T21:27:29.430
> 
> 标签：vb.net, validation, textbox

在为 VB .NET 文本框编写验证逻辑时，最好使用哪个事件处理程序：**Validating**还是**Leave**？

据我了解，它们都是同时发生的。但是，根据这篇文章：[MSDN: Control.Leave Event](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.leave.aspx)，Leave 事件发生在验证事件之前。这最初会让我觉得我宁愿使用 Leave 事件，因为它首先发生。

但是，为了代码可读性，将所有验证代码放在 Validating 事件中是有意义的。

那么，就效率和行业标准而言，哪个是更好的选择？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-15T21:50:38.310

您应该**始终**使用 Validating 事件，它是为了支持验证而设计的。如果不阻止焦点更改，那么至少对于 CausesValidation 属性。您在对话框的“取消”按钮上设置为 False。当用户决定关闭对话框时，验证任何内容都没有意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T21:42:15.360

该`Validating`事件是为验证而设计的。如果文本无效，设置 e.Cancel = True，焦点停留在文本框上。`Leave`只是一个通知。

# c++ - 如何在 Debian 上获取 GCC/++4.6 或更新版本

> ID：13406529
> 
> 赞同：0
> 
> 时间：2012-11-15T21:27:31.610
> 
> 标签：c++, linux, gcc, debian

--version 在 Debian Squeeze 上显示为 4.4。今天我离开了 Ubuntu，因为它根本不稳定（每天大约 50++ 个错误）而且速度很慢。而且我不喜欢 Unity。Debian很棒。可靠、快速且 Gnome 2 还可以。我参与了一个大型 c++ 项目，并大量使用了 c++0x 特性。

**我的问题是：如何在 Debian 上获得至少 gcc 4.6？**

运行混合系统是没有选择的。我的意思是更改 sources.list 并升级。由于 Gnome 3，完全升级是不可能的。我将不得不等待 Debian MATE。但不知何故，这必须完成......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:34:08.020

您可以通过测试安装某些软件包，而其他软件包保持稳定。请参阅debian wiki 中的[APT 首选项](http://wiki.debian.org/AptPreferences)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T06:43:02.160

您可以构建[GCC 4.7](http://gcc.gnu.org/gcc-4.7/)（来自其 FSF 源 tar 球）。这可能会很痛苦（这实际上取决于您的技能），并且可能需要几个小时的 CPU。在编译它之前，安装所有必需的依赖项（也许通过从它们的源代码编译它们），并仔细阅读[GCC 安装](http://gcc.gnu.org/install/)文档几次。

^(我不确定您避免将 Debian/testing 与 Debian/stable 混合使用是否正确。我很高兴在我所有的台式机和笔记本电脑上使用 Debian/unstable，所以我得到了最新发布的 GCC。)

当您从 FSF 源代码 tarball 构建 GCC 4.7.2 时，不要忘记*在源代码树之外*构建。仔细阅读配置选项（`--program-suffix=-4.7`例如，您可能需要）。不要忘记在你的 GCC中启用插件（with `--enable-plugin`at time）。`..../configure`您可能会对[MELT](http://gcc-melt.org/)感兴趣，这是一种扩展 GCC 的领域特定语言，实现为 [meta-] 插件。

如果你不喜欢 Gnome3——我明白——你可以尝试另一个基于 Debian 的发行版，比如[Linux Mint](http://linuxmint.com/)，或者干脆使用 XFCE 作为你的桌面。

# actionscript-3 - ActionScript:ArrayCollection 声明

> ID：13406533
> 
> 赞同：1
> 
> 时间：2012-11-15T21:27:48.277
> 
> 标签：actionscript-3, apache-flex, flex3

我是 ActionScript 和 Flex 的新手。我需要学习使用 Flex 和 ActionScript 开发的应用程序。我看到了一个 ArrayCollection 声明：

```
    [可绑定]
    public var someThing:ArrayCollection = new ArrayCollection([[]]);

```

那个声明是什么意思。它是多维的吗？它是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:41:54.447

这将是一个 ArrayCollection，它是一个 Array 的包装器，基本上为您提供排序和过滤功能（和其他方法）。构造函数可选地接受一个数组作为参数，[] 是一个没有元素的新数组。[[]] 是一个包含一个元素的数组，它是一个没有元素的数组。所以这就是说创建一个新的 ArrayCollection，它的源作为一个数组，而该数组又包含一个空数组元素。不知道他们为什么要这样做，但这就是它的作用。

总而言之，您可以在 AS3 中声明和实例化一个数组，例如：

```
var myArray:Array = []; 
```

或者

```
var myArray:Array = new Array(); 
```

要添加，因为我相信 ECMAScript 也是特定的，您可以使用 {} 类似地实例化一个对象。如：

```
var myObj:Object = {}; 
```

或者

```
var myObj:Object = new Object(); 
```

这些站点中的任何一个都是 AS3 的良好参考资料：

[http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118a9b90204-7ee5.html#WS5b3ccc516d4fbf351e63e3d118a9b90204-7ee1](http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118a9b90204-7ee5.html#WS5b3ccc516d4fbf351e63e3d118a9b90204-7ee1)

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Array.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Array.html)

当我第一次开始使用 Flex（具有 HTML/JS、C、C++ 和 Java 的背景）时，我发现这些视频非常有用（如果并非总是 100% 正确/最新，它们解释了总体概念）： [http://www.adobe.com/devnet/flex/videotraining.html](http://www.adobe.com/devnet/flex/videotraining.html)

# javascript - Jquery Complex 环绕未包含的项目组

> ID：13406537
> 
> 赞同：2
> 
> 时间：2012-11-15T21:27:59.657
> 
> 标签：javascript, jquery, wrapall

我正在尝试获取一组标题和列表，并单独包含它们，以便我可以设置它们的样式。IE：

```
<h2>Title 1</h2>
<ul>
  <li>Item 1</li>
  <li>Item 2</li>
  <li>Item 3</li>
</ul>
<h2>Title 2</h2>
<ul>
  <li>Item 1</li>
  <li>Item 2</li>
  <li>Item 3</li>
</ul>
```

我尝试使用`.before()`and在标签之前`.after`添加一个，并在每次之后关闭它，但是我发现 jquery 会自动清理并关闭标签。所以我猜我需要使用只是不确定如何将标题和列表组合在一起。`div``h2``ul``wrap()`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T21:32:00.597

利用

```
$('h2').each(function(){
   var self = $(this);
   self.add( self.next() ).wrapAll('<div/>');
}); 
```

演示在[http://jsfiddle.net/gaby/e4f9h/](http://jsfiddle.net/gaby/e4f9h/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:33:29.247

您想要创建一个包含这两个元素的 jQuery 集合。为此，您将选择 h2 元素。您将需要找到[`next()`](http://api.jquery.com/next/)一个 ul 元素。将它们链接起来后，您将[`wrapAll()`](http://api.jquery.com/wrapAll/)使用包含的 div。

```
$("h2").each( function(){
   var h2 = $(this);
   h2.add(h2.next("ul")).wrapAll('<div class="madWrapper"></div>');             
});​​​​​​ 
```

[jsFiddle](http://jsfiddle.net/FPL2u/)

# c# - 显示 foreach 循环的每个结果

> ID：13406538
> 
> 赞同：0
> 
> 时间：2012-11-15T21:28:03.263
> 
> 标签：c#, datetime, datagridview, foreach

我创建了一个`<List>DateTime`名为 GetDataRange 的类，以便用户可以在两个特定日期之间获得天数。

然后我想在数据网格视图的列中显示天数。我使用了一个foreach循环，这个循环会导致问题。问题是它不会在列中显示所有天，因为我想在其他日历中显示所有天。查看代码：

```
for (int i = 0; i < dtEnd.Subtract(dtStart).Days; i++)
        {
            TimeSpan counter = new TimeSpan(i, 0, 0, 0);

            string s1 = "10/9/2012";
            string s2 = "11/10/2012";
            d1 = Convert.ToDateTime(s1);
            d2 = Convert.ToDateTime(s2);

            foreach (DateTime item in GetDateRange(d1, d2))
            {
                s = item.ToShortDateString();
            }

            PersianCalendar p = new PersianCalendar();
            DateTime date = Convert.ToDateTime(s);
            int day = p.GetDayOfMonth(date);
            int month = p.GetMonth(date);
            int year = p.GetYear(date);
            string dt = string.Format("{0}/{1}/{2}", year, month, day);
            dataGridView1.Columns.Add(string.Format("col{0}", i), string.Format("{0} {1}", (dtStart + counter).DayOfWeek.ToString(), dt));

        } 
```

由于那个 foreach 循环，它只会显示一天。DayOfWeek 运行良好，但问题是在 foreach 循环中显示天数，它只会显示一天。

**更新**

string dt 只显示一天，其他日子不会显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T09:16:00.373

你不能那样做。因为每次在循环中你都会覆盖这个值。你能在新行中显示日期吗？

尝试这个 ：

```
for (int i = 0; i < dtEnd.Subtract(dtStart).Days; i++)
        {
            TimeSpan counter = new TimeSpan(i, 0, 0, 0);                                       
           dataGridView1.Columns.Add(string.Format("col{0}", i), string.Format("{0}", (dtStart + counter).DayOfWeek.ToString()));
        } 
```

然后为此添加新行：

```
 d1 = dtStart;
        d2 = dtEnd;
        foreach (DateTime item in GetDateRange(d1, d2))
        {
            int day = p.GetDayOfMonth(item);
            int month = p.GetMonth(item);
            int year = p.GetYear(item);
            string dt1 = string.Format("{0}/{1}/{2}", year, month, day);
            listBox1.Items.Add(dt1);

        }
        dataGridView1.Rows.Add();
        for (int i = 0; i < dataGridView1.Columns.Count; i++)
        {
            try
            {
                dataGridView1.Rows[0].Cells[i].Value = listBox1.Items[i];
            }
            catch (Exception)
            {

            }

        } 
```

# macos - 如何安装用户特定的 Perl 实例？

> ID：13406544
> 
> 赞同：-2
> 
> 时间：2012-11-15T21:28:25.683
> 
> 标签：macos, perl

我的背景是以 Windows 为中心的，我不知道如何安装我自己的“用户副本” `perl`，我可以在其中添加模块等。OS X 已经有自己的“系统 perl”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T21:34:46.757

我[`perlbrew`](http://search.cpan.org/perldoc?perlbrew)用来安装我自己的 Perl 实例。`cpan Module::Name`将安装模块。

必须先安装带有可选命令行工具包的 XCode，以提供构建`perl`. （谢谢弗里多！）

# android - 选项卡、活动和嵌套片段

> ID：13406547
> 
> 赞同：4
> 
> 时间：2012-11-15T21:28:36.893
> 
> 标签：android, android-layout, android-fragments, android-tabs, android-support-library

我正在启动一个新应用程序，需要一组选项卡。在每个选项卡中，我需要多个屏幕，每个屏幕都有自己的后台堆栈（客户端需要）。这是我的意思的快速图表：

```
Tab 1
   |
   |_Screen1a --> Screen1b --> Screen1c
Tab 2
   |
   |_Screen2a -->Screen2b
Tab 3
   |
   |_Screen3a --> Screen3b --> Screen3c --> Screen3d
...etc 
```

现在，我在使用 FragmentActivity 作为选项卡主机活动之前已经完成了这项工作。然后，每个选项卡都是一个 FragmentActivity，其中包含每个 Fragment。我的意思是：

```
FragmentActivity
    FragmentActivity1
       |
       |_Fragment1 --> Fragment2 --> Fragment3
    FragmentActivity2
       |
       |_Fragment4 --> Fragment5
    FragmentActivity3
       |
       |_Fragment6 --> Fragment7 --> Fragment8 --> Fragment9
    ...etc 
```

现在，随着 4.2 SDK 的发布和 Support Library 的新修订，出现了嵌套片段。这允许您将一个片段放入另一个片段中（我假设您可以继续嵌套，虽然还没有测试过）。我正在考虑切换到使用嵌套片段，因为我目前在我的 Tab 主机活动中使用不推荐使用的方法。从本质上讲，我将在具有单个主机活动的片段中实现我的应用程序的整个流程。

在性能问题或内存问题等方面是否有任何下降？或者我应该使用我之前完成的实现并使用不推荐使用的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T01:36:08.570

嵌套片段可以帮助解决您的问题，我已经尝试过这个实现。但是不要将子 Activity(intent) 添加到 TabHost 的 TabSpec 中。所有子活动都应替换为片段。但在我的选择中，我认为这种实现并不好。因为 Android 有一个返回键，所以导航会有点连线。并且按返回键通常会将用户返回到上一个屏幕。但是这个标签的东西会弄乱后面的导航。

# c++ - 混合添加颜色而不是仅仅替换？

> ID：13406548
> 
> 赞同：0
> 
> 时间：2012-11-15T21:28:39.560
> 
> 标签：c++, opengl

有没有办法在绘图时在像素上添加颜色值（而不是设置）？

我的伪代码例如：

```
//DrawPixel( int x, int y, Color color ); - Puts pixel to color buffer with specific place.
DrawPixel( 0, 0, Red );
DrawPixel( 0, 0, Green ); 
```

在我执行这段代码之后，`0,0`像素的颜色是`Red+Green`. （黄色）我不仅仅谈论绘制像素或混合。OpenGL中有没有办法让它完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:42:10.430

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T23:38:40.473

除了 Aki Suihkonen 的回答，您可能还需要调用 glEnable(GL_BLEND) 来打开混合。你说它目前只是替换听起来你已经关闭混合的颜色。

假设您已正确初始化 glew，当 OpenGL 调用抛出异常，说明您正在尝试调用 0x00000000 时，这意味着该 API 在您的 OpenGL 版本中不可用，因此请确保您为您的 OpenGL 版本使用正确的函数。

# java - 为什么我的 java gui 第一次移动时会“跳”？

> ID：13406549
> 
> 赞同：0
> 
> 时间：2012-11-15T21:28:49.403
> 
> 标签：java, linux, swing, user-interface, x11

我有一个简单的 java gui（下面的代码），由于某种原因，当我第一次尝试移动或调整它的大小时，它会“跳”回原来的位置。所以基本上我必须移动 gui 两次才能让它移动一次，因为当我第一次释放鼠标时，它会迅速回到最初出现的位置。

```
import javax.swing.*;

public class JFrameTester {

  public static void main(String[] args) {

    JFrame f = new JFrame("A JFrame");
    f.setSize(250, 250);
    f.setLocation(300,200);
    f.getContentPane().add(new JTextArea(10, 40));    
    //f.pack();    
    f.setVisible(true);
    //f.validate();
  }

} 
```

我正在**使用 java 1.6 在 GNU Linux 上**运行。我正在将显示导出回我的 Windows 机器，并想知道它是否与 X11 转发有关，因为当我在 Windows 中运行 gui 时它没有显示这种行为。但是，当我在 Fedora Linux 机器（使用 java 1.7）上运行这个 gui 时，它根本不会显示这种行为 - 无论是否导出显示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T06:56:56.057

几个问题显而易见：

*   *仅*在[事件调度线程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html)上构造和操作 Swing GUI 对象。如果不这样做，就会产生一种竞争条件，在不同的平台或网络延迟暴露之前，这种竞争条件可能会变得模糊不清。

*   使用`pack()`，“导致`Window`其大小以适合其子组件的首选大小和布局。” 否则会导致`Container`在移动或调整大小时验证无效。当过早可见的组件移动到定义的位置时，它们似乎“跳跃”。

*   进行影响初始外观`setVisible()`的*最后一个*操作。

以下示例结合了这些建议：

```
import java.awt.EventQueue;
import javax.swing.*;

public class JFrameTester {

    public static void main(String[] args) {

        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                JFrame f = new JFrame("A JFrame");
                f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                f.add(new JScrollPane(new JTextArea(10, 40)));
                f.pack();
                f.setLocationByPlatform(true);
                f.setVisible(true);
            }
        });
    }
} 
```

# nservicebus - 缩放托管在 azure worker 角色和消息顺序中的 NServicebus

> ID：13406552
> 
> 赞同：0
> 
> 时间：2012-11-15T21:29:01.383
> 
> 标签：nservicebus, azure-worker-roles

我有一个使用 AzureMessageQueue 作为传输的 Azure 辅助角色托管的 NServiceBus 端点。我很确定我将在 azure 中配置多个实例来运行辅助角色。我也有一些订单很重要的消息。

这是我的问题。有没有办法通过这种类型的设置来控制顺序（azure worker 角色向外扩展）？

我应该看传奇吗？像下面描述的技术（使用 bus.send(object[] messages) 重载）将在这个模型中工作，我猜，但这只有在由于天蓝色队列的大小限制而有一些消息时才是理想的.

[http://mikaelkoskinen.net/post/NServiceBus-In-order-message-processing.aspx](http://mikaelkoskinen.net/post/NServiceBus-In-order-message-processing.aspx)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T13:27:36.337

Bus.Send in batch 会有所帮助，如果消息足够小，从消息队列配置读取批量大小也会有所帮助，您可以通过这种方式明确控制消息的顺序。批量发送将多个消息实例放在同一个物理队列消息中，而批量读取将一次性从队列中拉出多条物理消息并在节点上按顺序处理它们。

另一种选择是同步消息处理程序中的读取，使用 blob 上的租约。请参阅 nsb timeoutmanager 的代码，了解如何使用它们进行同步，或查看 steve marx 的有关该主题的博客文章。[http://blog.smarx.com/posts/managing-concurrency-in-windows-azure-with-leases](http://blog.smarx.com/posts/managing-concurrency-in-windows-azure-with-leases)

但请注意，azure 消息队列本身不保证订单，这是尽最大努力。如果要保证传输级别的顺序，则需要使用启用了消息排序的 Azure 服务总线队列。

亲切的问候，伊夫

# css - CSS：针对兄弟姐妹但位置未知

> ID：13406555
> 
> 赞同：2
> 
> 时间：2012-11-15T21:29:29.487
> 
> 标签：css

好的，尽管我不完全确定是否可行，但我一直在尝试仅使用 CSS 来解决这个问题，所以在我求助于 JavaScript 之前，我需要在这里问一下。

我需要以以下列表中`column-title`第一个类的同级为目标：`<li>`

```
<ul>
    <li class="column-title">Item 1</li>
    <li>Item 2</li>
    <li>Item 3</li>
    <li class="column-title">Item 4</li>
    <li>Item 5</li>
</ul> 
```

考虑兄弟姐妹可以在***任何***位置，例如：

（第五名）

```
<ul>
    <li class="column-title">Item 1</li>
    <li>Item 2</li>
    <li>Item 3</li>
    <li>Item 4</li>
    <li class="column-title">Item 5</li>
</ul> 
```

（第三名）

```
<ul>
    <li class="column-title">Item 1</li>
    <li>Item 2</li>
    <li class="column-title">Item 3</li>
    <li>Item 4</li>
    <li>Item 5</li>
</ul> 
```

我不认为这仅使用 CSS 是可能的，对吧？

谢谢。

***编辑 -***

哦，男孩，我找到了解决方案：

使用**兄弟组合器：~**

```
.column-title ~ .column-title { background:#ddd; } 
```

这样，该属性将应用于第一个`.column-title`li 的任何同级。

PS。*我在crowjonah*发布他的帖子的同时找到了答案。无论如何，我选择了他的答案作为*选择的答案。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T21:35:12.537

您可以尝试半支持的[“通用兄弟组合器”](http://www.w3.org/TR/selectors/#general-sibling-combinators)，`~`. 就像是：

```
li.column-title ~ li.column-title {color: red;} 
```

这是[一个基本的小提琴](http://jsfiddle.net/Scmju/)，显示它正在完成。

然后你可能需要一个像[这样](http://code.google.com/p/ie7-js/)的垫片来支持 IE7，如果那是你的小巷的话。

看到您的更新，您应该知道，为了获得最佳结果，如果您从兄弟姐妹规则中排除 li.column-title 的第一个实例，您应该指定`:first-child`：

```
ul li.column-title:first-child {color: blue;}
ul li.column-title:first-child ~ li.column-title {color: red;}​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T21:39:29.277

如何使用非过滤器：

这是一个要演示的[jsfiddle](http://jsfiddle.net/B3WwP/)。

```
ul>li.column-title:not(:first-child) {
  color: red;
}​ 
```

由于是css3，pre IE9不支持

# javascript - 包含 DIV 的显示宽度

> ID：13406558
> 
> 赞同：2
> 
> 时间：2012-11-15T21:29:37.667
> 
> 标签：javascript, jquery, responsive-design

我正在设置一种“调试”页面，其中包含许多具有不同比例宽度（以百分比设置）的独特 DIV。
我希望每个 div 都包含将显示包含 div 的宽度（以像素为单位）的文本，并实时响应视口的大小调整。

我是 jQuery 的新手，发现自己能够使用以下方法显示元素的宽度：

```
$('.show_width').html($(this).width());​​ 
```

但是，我显然做错了什么，因为这只适用于一次 - 而不是在每个唯一的 div 上。此外，我想`"Width: ___px"`为每个 div 添加类似的内容。

任何帮助深表感谢。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:32:49.823

你需要使用 $.each 来循环遍历元素

```
 $(document).ready(function () {
     getWidths();
     $(window).resize(function() {
         getWidths();            
     });

     function getWidths() {
         $('.show_width').each(function() {
           $(this).html("");
           $(this).html($(this).html() + "<br />Width: " + $(this).width() + "px");
        });
     }
  });​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:34:44.523

如果我明白了，请使用调整大小事件回调函数：

```
 $(window).resize(function(){
         $('.show_width').each(function() {
             $(this).html($(this).width()+' * '+$(this).height());​
          }​
    }); 
```

# datagridview - C# WinForms：无法访问 dispose 对象

> ID：13406560
> 
> 赞同：4
> 
> 时间：2012-11-15T21:29:56.267
> 
> 标签：datagridview, datagridviewcolumn, objectdisposedexception

我有一个数据网格视图。此 datagridview 具有自定义 datagridview 列以及其他类似 datagridviewtextbox 列。第三方控件托管在每个单元中。因此，在设计 datagridview 时，在自定义单元格上，除非您处于单元格的编辑模式，否则无法显示内容。因此，为了实现要显示的单元格内容，我重写了paint方法，以便在单元格不处于编辑模式时对其进行绘制。要在单元格中绘制的图像是在paint方法中获得的，我使用如下块：

```
using (Bitmap bitmap = new Bitmap())
{
   ...
} 
```

此外，为了在 Windows 窗体 datagridview 单元格中托管控件，我有一个实现 IDataGridViewEditingControl 的类。

```
public class a : third-party-component, IDataGridViewEditingControl
{
} 
```

在应用程序的某个时刻，它崩溃说无法访问已处置的对象。在代码中，我没有对任何对象进行任何处理，所以我不明白这一点。

从堆栈看来，错误似乎是在上面指示的类中引发的，但它没有明确指出在哪里。

我确信这是由 Windows 窗体 datagridview 单元格中托管的控件引起的。关于可能是什么问题的任何想法？

或者它可能与datagridviewtextboxcolumns有关？以下错误：

```
Cannot access a disposed object.
Object name: 'DataGridViewTextBoxEditingControl'.
Stack Trace:
   at System.Windows.Forms.Control.CreateHandle()
   at System.Windows.Forms.TextBoxBase.CreateHandle()
   at System.Windows.Forms.Control.get_Handle()
   at System.Windows.Forms.Control.GetSafeHandle(IWin32Window window)
   at System.Windows.Forms.ToolTip.Hide(IWin32Window win)
   at System.Windows.Forms.ToolTip.HideAllToolTips()
   at System.Windows.Forms.ToolTip.BaseFormDeactivate(Object sender, EventArgs e)
   at System.EventHandler.Invoke(Object sender, EventArgs e)
   at System.Windows.Forms.Form.OnDeactivate(EventArgs e)
   at Crownwood.DotNetMagic.Forms.WindowChrome.OnDeactivate(EventArgs e)
   at System.Windows.Forms.Form.set_Active(Boolean value)
   at System.Windows.Forms.Form.WmActivate(Message& m)
   at System.Windows.Forms.Form.WndProc(Message& m)
   at Crownwood.DotNetMagic.Forms.WindowChrome.WndProc(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
   at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-03T07:17:53.923

看来您尚未处置为工具提示创建的对象。确保您已在相应控件的 (IDataGridViewEditingControl) 处置方法中处置了 ToolTip 的创建对象。

`protected override void Dispose(bool disposing) { if (disposing) { if (Tip != null) { Tip.Active = false; Tip.Dispose(); Tip = null; } } base.Dispose(disposing); }`

# sql-server - 我在哪里可以找到各种 SQL DB 数据类型之间的细节/差异？

> ID：13406566
> 
> 赞同：-3
> 
> 时间：2012-11-15T21:30:32.170
> 
> 标签：sql-server, azure-sql-database

我在这里找到了 SQL DB（以前称为 Azure DB）的数据类型列表：

[http://msdn.microsoft.com/en-us/library/windowsazure/ee336233.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/ee336233.aspx)

...但没有关于每种数据类型的确切含义。例如，我需要知道：

```
Since there is no Boolean type, what should I use in lieu of bool in SQL DB?

What is the difference between *datetime* and *datetime2* in SQL DB?

What is the difference between *datetime* (and *datetime2*) and *timestamp* in SQL DB?

What is the *sysname* datatype in SQL DB? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T09:25:19.667

你所有的问题都是 SQL Server 问题，Azure 和非 Azure 的答案没有区别。

在任何版本的 SQL Server 中都没有 BOOLEAN 类型。有[“BIT”数据类型](http://msdn.microsoft.com/en-us/library/ms177603.aspx)，它映射到 .NET BOOL 数据类型。

[DateTime2](http://msdn.microsoft.com/en-us/library/bb677335.aspx)比SQL Server（分别为 Windows Azure SQL 数据库）中的[DateTime](http://msdn.microsoft.com/en-us/library/ms187819.aspx) （1/100 秒）数据类型更精确（高达 1/100000 秒）。

DateTime/DateTime2 是映射到 DateTime .NET 类型的 SQL Server 数据类型，而[时间戳是自动生成的数字序列，在每次行更新时自动递增，](http://msdn.microsoft.com/en-us/library/ms182776%28v=SQL.90%29.aspx)用于 SQL Server/数据感知应用程序中的行版本控制和并发管理

什么是 sysname - [SQL Server 中的 SYSNAME 数据类型是什么？](https://stackoverflow.com/questions/5720212/what-is-sysname-data-type-in-sql-server)

在此处提问之前，请多尝试互联网搜索引擎。并请提出具体问题！

正如其他用户已经标记的那样 - 您的问题中没有任何 AZURE。

# java - Jackson 使用枚举键、POJO 值反序列化为 Map

> ID：13406568
> 
> 赞同：12
> 
> 时间：2012-11-15T21:30:37.933
> 
> 标签：java, json, serialization, jackson, jsonserializer

我正在尝试使用 Jackson 将 JSON 反序列化为 Java POJO。在不泄露机密信息的情况下，以下是 ObjectMapper 的反序列化失败时的示例堆栈跟踪：

```
org.codehaus.jackson.map.JsonMappingException: Can not construct Map key of type com.example.MyEnum from String "coins": not a valid representation: Can not construct Map key of type com.example.MyEnum from String "coins": not one of values for Enum class 
```

我的 JSON 看起来像这样：

```
"foo": {
    "coins": null,
    ...
} 
```

我想反序列化的类有这个字段：

```
private Map<MyEnum, MyPojo> foo; 
```

我的枚举类型如下所示：

```
public enum MyEnum {
    COINS("coins"),
    ...
} 
```

我确实意识到我正在尝试反序列化一个空值。但我相信这仍然有效：反序列化的结果应该等同于拥有一个 Map with `foo.put(MyEnum.COINS, null)`，这确实是一条有效的 Java 指令。非常感谢您的帮助，在此先感谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-16T00:53:19.663

除了提出的一种好的解决方案（工厂方法）之外，还有另外两种方法：

*   如果 'MyEnum.toString()' 会返回 "coins"，你可以让 Jackson 使用 "toString()" 而不是 "name()" with`ObjectMapper.enable(DeserializationFeature.READ_ENUMS_USING_TO_STRING)`
*   您可以添加一些其他方法来返回要使用的 id，并使用`@JsonValue`注释标记该方法（您实际上也可以使用它`toString()`，而不是启用上述功能）——如果存在该注释，则该方法返回的值用作ID。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-15T22:06:57.910

GRR！弄清楚了。

对我来说，解决方案是在我的枚举中创建一个带有注释的静态方法，该方法`@JsonCreator`基于 String 参数创建枚举的实例。它看起来像这样：

```
@JsonCreator
public static MyEnum create(String str) {
    // code to return an enum based on the String parameter
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-15T22:11:40.893

在您的枚举类中提供一个静态工厂方法，该方法通过字符串构造枚举并使用@JsonCreator 对其进行注释：

```
@JsonCreator
public static MyEnum fromValue(String v) {
    for (MyEnum myEnum : values()) {
        if (myEnum.text.equals(v)) {
            return myEnum;
        }
    }
    throw new IllegalArgumentException("invalid string value passed: " + v);
} 
```

# amazon-ec2 - 计划每周从正在运行的实例创建 AMI？

> ID：13406572
> 
> 赞同：4
> 
> 时间：2012-11-15T21:31:03.010
> 
> 标签：amazon-ec2

我在 Amazon 的 EC2 上运行的服务器很少，我想每周备份一次映像（创建 AMI）（替换旧映像）。有什么办法可以自动化吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:57:27.083

您应该能够使用[命令行工具](http://docs.amazonwebservices.com/AWSEC2/latest/CommandLineReference/ApiReference-cmd-CreateImage.html)来创建 ami。类似的东西`ec2-create-image -n "<image name here>" <your instancId here>`。把它放在每周安排的 cron 条目中，你就完成了。您应该能够使用[此问题](https://stackoverflow.com/questions/625644/find-out-the-instance-id-from-within-an-ec2-machine)的答案以编程方式确定您的实例 ID 是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-15T16:58:51.893

您现在可以使用[AWS Lambda 自动创建 AMI](https://www.webdigi.co.uk/blog/2017/aws-instance-automated-ami-creation-deletion-system/)。整个设置应在大约 10 分钟内完成，并按照您喜欢的时间表进行。

# regex - Cakephp 2.1 Router::connect /* 除了一些动作

> ID：13406573
> 
> 赞同：0
> 
> 时间：2012-11-15T21:31:04.597
> 
> 标签：regex, cakephp

我想知道是否有可能在下一行出现类似的内容，但排除某些操作。因为我想要管理、添加、删除……去相应的操作而不是显示操作。我知道通过预先明确指定这些规则是可能的，但如果你有很多这些规则，它在路由器文件中看起来并不好。

```
 Router::connect('/paginas/manage', array('controller' => 'paginas', 'action' => 'manage')); 
 ...
 Router::connect('/paginas/*', array('controller' => 'paginas', 'action' => 'display')); 
```

所以目的是删除第一行......

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:21:02.437

在您的 PaginasController 中执行类似的操作，这基本上是我认为的 PagesController。： ....

```
public function display(){
// Assuming default behavior of cakephp here
...
if (!empty($path[0])) {
    $page = $path[0];
    if(
        method_exists($this, $page) &&
        !in_array(
            $page,
            array(
                // Methods that never should be executed in this controller are going in here
            )
        )
    ){
        $this->{$page}();
    }
}
} 
```

这将在控制器中执行特定方法。您可以将其退出那里以使其之后停止工作。这可能有点危险，因为它也可以访问 AppController 的父方法。

您还需要其中两个 Router::connect() 规则的另一种方式在此处描述：http: [//api.cakephp.org/class/router#method-Routerconnect](http://api.cakephp.org/class/router#method-Routerconnect)

```
Router::connect(
  'paginas/:action/*',
  array(),
  array('paginas' => '(manage|add|delete)')
); 
```

这个先上，后一个。**从未测试过！**

虽然我不明白为什么应该有编辑页面的公共方法。使用这些将它们与其余部分分开：http: [//book.cakephp.org/2.0/en/development/routing.html#prefix-routing](http://book.cakephp.org/2.0/en/development/routing.html#prefix-routing)

我建议，如果您尝试按照我的想法执行此操作，则不要开始使用 PagesController 为页面编写管理。“Pages”在 cake 中或多或少是一个保留词，使用这些词可能会遇到大麻烦（曾经写过一个“File”插件，包括“File”模型。浪费时间，好像从 cake1.2 或 1.3 开始实际上是一个“文件”类来处理文件操作）。创建一些新的东西，如“ContentPage”或其他任何东西。那你就省钱了。这一段可能没用，因为您的控制器甚至没有命名为“页面”，但我讨厌删除长的，所以它保留，以防您需要此信息一次。

此外，我建议不要更改编程语言，这意味着，您要么使用英语或西班牙语，要么使用其他语言，但不能同时使用这两种语言，或者更糟。你可以为你的路线命名任何你想要的名字，但类名可能应该保留在英文中，因为 cake 也是。

问候 func0der

# ios - 在 Storyboard 中获取子视图的帧

> ID：13406574
> 
> 赞同：4
> 
> 时间：2012-11-15T21:31:11.723
> 
> 标签：ios, xcode, uistoryboard

我只想（现在）在视图控制器的实例化上获取子视图的尺寸。

[这是我能找到的上[一个问题](https://stackoverflow.com/questions/13389750/how-to-get-subviews-frames-early-in-initialization-process)的简单案例。我试图弄清楚为什么 Storyboards 中场景的子视图的行为不符合我的预期，也就是说：就像 XIB 一样 - 我只想在实际绘制到屏幕上之前获取子视图的尺寸]

为了将问题浓缩为一个新的、干净的项目，我这样做：

*   创建一个新的单视图项目，选中“使用情节提要”
*   将单个 UIView 添加到默认现有的`MainStoryboard_iPad.storyboard`（并将其背景更改为绿色以使其更容易看到 - 除了缩小一些尺寸之外，这是我从拖到场景中的默认 UIView 所做的唯一更改）
*   选项-单击`ViewController.h`导航器中的文件以将其显示在故事板框架下方的自己的框架中，并在`@interface`指令下方插入一对大括号
*   从 Storyboard 中的 UIView 控制单击并拖动到`ViewController.h`并告诉它命名插座`firstViewFirstSubView`

所以我们现在有`ViewController.h`：

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController
{
    IBOutlet UIView *firstViewFirstSubView;
}
@end 
```

然后，我将此方法添加到 ViewController.m：

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

    NSLog(@"View Controller will appear. firstViewFirstSubView: %@ ", firstViewFirstSubView);
    NSLog(@"subView's dimmensions: %f by %f at %f, %f", firstViewFirstSubView.frame.size.width,
      firstViewFirstSubView.frame.size.height,
      firstViewFirstSubView.frame.origin.x,
      firstViewFirstSubView.frame.origin.y);
} 
```

此时，我希望能够获得 UIView 子视图的尺寸。不过，我得到了全 0：

```
2012-11-15 15:21:00.743 StoryboardViewBounds[11132:c07] View Controller will appear. firstViewFirstSubView: <UIView: 0x9379730; frame = (0 0; 0 0); autoresize = TM+BM; layer = <CALayer: 0x9378e40>> 
2012-11-15 15:21:00.744 StoryboardViewBounds[11132:c07] subView's dimmensions: 0.000000 by 0.000000 at 0.000000, 0.000000 
```

我究竟做错了什么？看起来这应该很简单，所以我想我一定错过了一些简单的东西，无论是在 Storyboard 编辑器中抛出正确的开关还是实现 Storyboard 需要的方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-29T15:03:08.007

有一个我不得不解决的相关问题，希望可以为其他人节省一天的调试时间：

我在情节提要中发现：

1.  **`segue-push`**不会导致s**被**`subView`布置在`-viewDidLayoutSubviews`（*它们被布置在之前的某个其他时间`-viewDidAppear`*）。
    **而**...
2.  **`segue-modal`**并`[navController.storyboard presentViewController:]` **确实**导致`subViews`在`-viewDidLayoutSubviews`.

解决方案是放在`[self.mySubView layoutSubviews]`' `viewController`s`-viewDidLayoutSubviews`方法内，以便手动加载`subView`s 内`mySubView`。

我的情况是我有一个自定义渐变按钮，它没有正确初始化它的视觉外观。
该按钮包含在`scrollView`包含`CustomView`自定义渐变按钮的 a 中。
所以，基本上......一个视图内的按钮`scrollView`。

该应用程序以加载`UINavigationController`其他一些内容开始。包含一个按钮，当按下该按钮时，将启动情节提要到. （*这是通过控制从按钮拖动到故事板中安排的**）*。`ViewController1`
`ViewController1`**`segue-push`**`ViewController2`
*`ViewController1``ViewController2`*

`ViewController2`包含`scrollview`// 。`customView`_ 在's中，我初始化了一个自定义渐变按钮，它拥有自己的**.h/.m**文件。有一个以图形方式配置它并需要初始化按钮的/属性的方法。**但是**... in 's的帧为 0,0,0,0。`customButton`
`ViewController2``-viewDidLayoutSubviews``customButton` **`GradientButton.m``initLayers``bounds``frame`
 **`ViewController2``-viewDidLayoutSubviews``self.customButton`****

 ****## 几点注意事项：

1.  是的，我`[super viewDidLayoutSubviews]`在开头打电话`-viewDidLayoutSubviews`。
2.  唯一布置在的视图`-viewDidLayoutSubviews`是`self.view`(`ViewController2`的初始视图，在 Storyboard 的连接面板中连接。*在我的情况下 -`self.view`是 a`scrollView`* )。

## 解决：

1.  在中`ViewController2`，我`self.bottomView`为包含`self.customButton`.
2.  在`ViewController2`'s `-viewDidLayoutSubviews`，我打电话给`[self.bottomView layoutSubviews]`
    *   这将导致`customButton`' 框架/边界被正确设置。
3.  接下来，我调用`[self.customButton initLayers]`which 现在可以正确初始化我的自定义渐变按钮。

关于`ViewController2`'`-viewDidLayoutSubviews:`调用的一些注意事项`[self.view layoutSubviews]`会导致`bottomView`' 的框架被初始化，但不是`customButton`' 的框架。
就视图层次结构而言，`-layoutSubviews`仅适用于这些`subView`s 中的 s，`self.view`而不适用于这些 s 中的任何`subView`s `subView`。
这似乎只是 storyboard 的情况**`segue-push`**。

故事板**`segue-modal`**和程序`[navController presentViewController]`似乎都在调用时正确初始化了视图层次结构的所有级别（所有“ `subView`s of `subView`s”）`-viewDidLayoutSubviews`。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-15T22:24:43.983

这些维度是在调用时计算和设置的`layoutSubviews`，这发生在`viewWillAppear`. 在`layoutSubviews`UIVIew 上调用后，您可以获得尺寸。

看看在你的视图控制器中实现这个方法：`viewDidLayoutSubviews`。此时，您应该能够获得子视图的尺寸。请注意，此调用从 iOS 5.0 开始可用，但由于您参考了故事板，我假设您无论如何都在使用故事板或更高版本。

```
- (void)viewDidLayoutSubviews
{
    [super viewDidLayoutSubviews];

    NSLog(@"View Controller did layout subviews. firstViewFirstSubView: %@ ", firstViewFirstSubView);
    NSLog(@"subView's dimmensions: %f by %f at %f, %f", firstViewFirstSubView.frame.size.width,
      firstViewFirstSubView.frame.size.height,
      firstViewFirstSubView.frame.origin.x,
      firstViewFirstSubView.frame.origin.y);
} 
```****

# c# - Lightswitch / silverlight 从数据网格列标题中删除字形

> ID：13406577
> 
> 赞同：1
> 
> 时间：2012-11-15T21:31:20.587
> 
> 标签：c#, asp.net, silverlight, visual-studio-lightswitch

我是 lightswitch 和 silverlight 的新手（在 SL v1.0 上奔向山丘，但与现在所有的一切一样）

我已经看到了一些使用 XAML 和 silverlight 的示例，以及一些使用 datagridview 的示例，我遇到的问题是我正在使用 lightswitch，因此没有 XAML :(

我必须修复并解决处理网格排序和重置排序顺序的问题（并且对此有一个 LS 已知问题）但是现在当用户点击重置按钮并且排序被重置时，它绑定好了一切都很好，我只需要从列标题中删除字形。我可以访问网格并且可以遍历列，但目前不知道如何执行此操作....

谢谢

# wordpress - WordPress 插件类中的自引用

> ID：13406580
> 
> 赞同：1
> 
> 时间：2012-11-15T21:31:24.417
> 
> 标签：wordpress, oop

按照这篇文章中的建议：[php 类作为 wordpress 中的插件](https://stackoverflow.com/questions/8668458/php-class-as-a-plugin-in-wordpress)

我创建了一个辅助类以与其他插件一起使用。在类文件中，我有一个激活类的声明，例如：

```
function test_init() {

    $test = new Test();

} // End of test_init() 
```

我可以通过执行以下操作来访问此类中的函数：

```
Test::my_function(); 
```

但是，我在相互引用此类中的函数时遇到了问题。例如：

```
function my_function() {

    Test::other_func();

} 
```

在这种情况下，我收到错误消息：“函数名称必须是字符串”

我试过 $this->other_func，它返回错误：“Class_Using_The_Test_Class 中没有函数“other_func”。

我试过 self::other_func，它返回错误：“函数名必须是字符串”

我尝试使用 call_user_func() 并得到：“call_user_func() 期望参数 1 是有效的回调”

我如何在这个类中调用另一个函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T02:00:52.610

您实际上不需要**激活**课程。我举个例子。

假设这段代码存在于`helper-class.php`：

```
<?php

class Helper_Class {

    // Note: those are double underscores before the word 'construct'.
    function __construct() {

        // initialize/call things here.
        $this->init(); // this is how you call class functions.
    }

    function init() {
        // do some monkey-business

        return;
    }

    // we'll call this function from our other class.
    function some_function() {
        // do the fancy whizbang.
    }
}

?> 
```

现在，在你的其他类文件中，你可以有这样的**东西：**

```
<?php

// give ourselves access to the helper class.
require_once 'helper-class.php';

class Main_Class {

    // Note: those are double underscores before the word 'construct'.
    function __construct() {
        $this->init();
    }

    function init() {
        // classes can't be used until an object of that class is created.
        $helper_class_object = new Helper_Class;

        // now I can call functions in my helper class.
        $helper_class_object->some_function();

        return;
    }

}

?> 
```

我希望这对您的情况有所帮助。只需询问您是否需要进一步说明。:)

# java - 为什么按需填充集合上的迭代器为空？

> ID：13406582
> 
> 赞同：1
> 
> 时间：2012-11-15T21:31:26.033
> 
> 标签：java, tomcat, iterator

我有以下代码：

```
for (String helpId : helpTipFragCache.getKeys())
{
    List<HelpTopicFrag> value = helpTipFragCache.getValue(helpId);
    helpTipFrags.put(helpId, value);
} 
```

helpTipFragCache 有一个机制来加载缓存，如果需要的值是空的。getKeys() 方法触发 this 并在调用 this 时加载缓存。但是在上述情况下，我看到了不同的行为。

我首先快速调试它以查看缓存是否确实在填充（在 Eclipse 中）。我走了过去，从未进入 for 循环（由于一个空的迭代器）。

然后我再次调试它（使用相同的代码）并进入 getKeys() 并在那里分析整个过程。然后它做了它应该做的一切，迭代器有值可以迭代，并且控制台中很平静。

我已通过更改代码来解决此问题：

```
Set<String> helpIds = helpTipFragCache.getKeys();
helpIds = helpTipFragCache.getKeys();
for (String helpId : helpIds)
{
    List<HelpTopicFrag> value = helpTipFragCache.getValue(helpId);
    helpTipFrags.put(helpId, value);
} 
```

显然调试触发了一些初始化或行为不同的东西，有谁知道是什么原因造成的？基本上，从返回的集合创建迭代器会发生什么？

其他一些相关信息：

*   此代码在服务器启动时执行（tomcat）
*   从包含的 jar 执行时，此代码的行为与预期不同，但在同一代码库中时会如此
*   该集合是一个集合

**编辑**

附加代码：

```
public Set<String> getKeys() throws Exception
    {
        if (CACHE_TYPE.LOAD_ALL == cacheType)
        {
            //Fake a getValue call to make sure the cache is loaded
            getValue("");
        }
        return Collections.unmodifiableSet(cache.keySet());
    }

public final T getValue(String key, Object... singleValueArgs) throws Exception
{
    T retVal = null;
    if (notCaching())
    {
        if (cacheType == CACHE_TYPE.MODIFY_EXISTING_CACHE_AS_YOU_GO)
        {
            retVal = getSingleValue(key, null, singleValueArgs);
        }
        else
        {
            retVal = getSingleValue(key, singleValueArgs);
        }
    }
    else
    {
        synchronized (cache)
        {
            if (needToLoadCache())
            {
                logger.debug("Need to load cache: " +  getCacheName());
                if (cacheType != CACHE_TYPE.MODIFY_EXISTING_CACHE_AS_YOU_GO)
                {
                    Map<String, T> newCache = null;
                    if (cacheType != CACHE_TYPE.MODIFY_EXISTING_CACHE)
                    {
                        newCache = getNewCache();
                    }
                    else
                    {
                        newCache = cache;
                    }
                    loadCache(newCache);
                    cache = newCache;
                }
                lastUpdatedInMillis = System.currentTimeMillis();
                forceLoadCache = false;
            }
        }
        ...//code in here does not execute for this example, simply gets a value that is already in the cache
    }

    return retVal;
} 
```

回到原来的类（之前的代码是从哪里发布的）：

```
 @Override
    protected void loadCache(
            Map<String, List<HelpTopicFrag>>    newCache)
    throws Exception
    {
        Map<String, List<HelpTopicFrag>> _helpTipFrags = helpDAO.getHelpTopicFrags(getAppName(), _searchIds);
        addDisplayModeToFrags(_helpTipFrags);
        newCache.putAll(_helpTipFrags);
    } 
```

上面，进行了数据库调用以获取要放入缓存的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:35:44.183

答案

`Basically, what is happening to create the iterator from the returned collection?`

您的情况下的`for`循环`Set`被视为[Iterable](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Iterable.html)并使用通过调用[Iterable.iterator()获得的](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Iterable.html#iterator%28%29)[Iterator](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Iterator.html)。

```
Set as = ...;

for (A a : as) {
    doSth ();
} 
```

基本上相当于

```
Set as = ...;

Iterator hidden = as.iterator ();
while (hidden.hasNext ()) {
    a = hidden.next ();
    doSth ();
} 
```

# grails - Gorm 没有加入

> ID：13406593
> 
> 赞同：0
> 
> 时间：2012-11-15T21:32:25.007
> 
> 标签：grails, grails-orm

我正在尝试构建我称为组的类的层次结构。域相当简单：

```
class SubGroup implements Serializable {
    Group child
    Group parent

    static mapping = {
        id composite: ['child', 'parent']
    }
}

class Group implements Serializable {           
    int groupId
    String key
    String title

    static mapping = {
        id name: 'groupId'
    }
} 
```

基本上我想建立一个团体父母及其相关孩子的地图。所以我遍历每条记录（如果有更简洁的方式来查询地图，我很高兴听到它）并为它创建地图条目。

```
Map hierarchy = [:]
SubGroup.list().each { relation ->
    if (!hierarchy[relation.parent]) {
        hierarchy[relation.parent] = new HashSet()
    }

    hierarchy[relation.parent] << relation.child
} 
```

我认为hibernate会使用一些简单的查询来做这样的事情：

```
select * from sub_group s, group c, group p 
where s.child_id = c.group_id and s.parent_id = p.group_id 
```

但它没有做连接。它正在对子组进行查询，然后对组表进行 n 次查询（N+1 选择问题）。啊。我听说在 2.0 中休眠[查询缓存](http://comments.gmane.org/gmane.comp.lang.groovy.grails.user/125400)有问题，所以我禁用了它。我尝试为父列和子列添加**lazy: false**和**fetch: join**到我的 SubGroup 域类，但没有成功。我尝试将**(fetch: [child: 'eager'])**作为参数添加到 list 方法。它不会进行连接。我错过了什么吗？老实说，它甚至不需要进行连接，因为我只访问 groupId 外键属性，尽管稍后我将需要 key 和 title 属性。

当然，我可以将子属性和父属性设置为整数，并在我需要其余数据时进行自己的查询，或者我可以使用 HQL 和其他一些方法将其限制为单个查询，但似乎 GORM 应该为我做这件事。谢谢你的帮助。
问候，

吉姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:04:09.843

似乎我可以在不为每个孩子和父母进行选择调用的情况下让它工作的唯一方法是改为执行 HQL 查询，而不是使用 list 方法，如下所示：

```
Map hierarchy = [:]
def subGroups = SubGroup.executeQuery("SELECT s.parent, s.child FROM SubGroup s")
subGroups.each { relation ->
    if (!hierarchy[relation[0]]) {
        hierarchy[relation[0]] = new HashSet()
    }

    hierarchy[relation[0]] << relation[1]
} 
```

因此，我实际上只使用 SubGroup 域类来定义关系。我想我应该能够通过某种映射来做到这一点，但我不知道怎么做。

# apache - 在未知的其他子域下重定向 www 子域？

> ID：13406597
> 
> 赞同：1
> 
> 时间：2012-11-15T21:32:45.560
> 
> 标签：apache, .htaccess

基本上我的问题就是这样：[将 www.subdomain.example.com 重定向到 subdomain.example.com](https://stackoverflow.com/questions/2909600/redirecting-www-subdomain-example-com-to-subdomain-example-com)

我们给所有用户一个`myusername.ourdomain.com`链接，问题是当有人试图访问`www.myusername.ourdomain.com`我们的通配符 ssl 时被破坏，服务器通常会抛出错误。

所以我提供的链接中的答案显示了如何重定向单个`www.apachedefined.mydomain.com`我想知道如何使用相同的逻辑来做`www.thiscanbeanything.mydomain.com`。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T18:21:14.730

`www.*.mydomain.com`尝试将这些规则添加到虚拟主机文档根目录中的 htaccess 文件的最顶部：

```
RewriteEngine On
RewriteCond %{HTTPS} on
RewriteCond %{HTTP_HOST} ^www\.([^.]+)\.mydomain\.com$ [NC]
RewriteRule ^(.*)$ https://%1.mydomain.com/$1 [L,R=301] 
```

# makefile - 如何将 MonoDevelop 构建配置传递给 Makefile？

> ID：13406598
> 
> 赞同：2
> 
> 时间：2012-11-15T21:32:49.187
> 
> 标签：makefile, monodevelop, buildconfiguration

MonoDevelop 支持 Makefile 集成。
但是我如何从 Makefile 内部知道当前的构建配置（调试/发布）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-28T15:10:19.160

是的，您需要转到您的项目，右键单击 BUILD 下的 OPTIONS 选择 CUSTOM COMMANDS 然后添加构建命令“make”

你可以为“make clean”做同样的事情

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T13:09:58.287

显然，你不能那样做。嗯，好吧。

# arrays - SAS：动态设置变量名

> ID：13406602
> 
> 赞同：0
> 
> 时间：2012-11-15T21:33:06.627
> 
> 标签：arrays, sas

在这段 SAS 数据步骤代码中，我从一个名为 TEST_Table 的 SQL 查询中设置了一个表。此表包含多个列，包括标题为 PREFIX_1 到 PREFIX_20 的大部分列。每列以 PREFIX_ 开头，然后是从 1 到 20 的递增数字。

我想做的是迭代循环遍历每一列并分析该列的值。

下面是我正在尝试的一个例子。如您所见，我想创建一个在每次迭代中增加的变量，然后我使用该计数值作为我正在检查的变量名称的一部分。

```
data TEST_Data;
  set TEST_Table;
  retain changing_number;

  changing_number=1;
  do while(changing_number<=20);    
    if PREFIX_changing_number='BAD_IDENTIFIER' then do;
      PREFIX_changing_number='This is a bad part';
    end;
  end;  

run; 
```

在 SAS 中执行此操作的最佳方法是什么？我知道我可以通过简单地从 1 到 20 分别检查每个值来做到这一点。

```
if PREFIX_1 = 'BAD_IDENTIFIER' then do;
  PREFIX_1 = 'This is a bad part';
end;
if PREFIX_2 = ... 
```

但这真的很令人讨厌，因为稍后我将对一组超过 40 列做同样的事情。

想法？

# 解决方案

```
data TEST_Data;
    set TEST_Table;

    array SC $ SC1-SC20;

    do i=1 to dim(SC);    
      if SC{i}='xxx' then do;
         SC{i}="bad part";
      end;   
    end;  
run; 
```

感谢您推荐数组 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:36:05.573

您需要在 SAS 中查找数组处理。简而言之，您可以执行以下操作：

```
data TEST_Data;
  set TEST_Table;
  *retain changing_number; Remove this - even in your code it does nothing useful;
  array prefixes prefix:; *one of a number of ways to do this;
  changing_number=1;
  do while(changing_number<=20);    
    if prefixes[changing_number]='BAD_IDENTIFIER' then do;
       prefixes[changing_number]='This is a bad part';
    end;
  end;  

run; 
```

稍微好一点的循环是：

```
do changing_number = 1 to dim(prefixes);
... loop ...
end; 
```

因为这一切都是一步完成的，而且它对数组元素的数量很灵活（dim = 数组中的元素数量）。

# ruby-on-rails - Ruby/Rails 中的 IP 范围到 CIDR？

> ID：13406603
> 
> 赞同：7
> 
> 时间：2012-11-15T21:33:07.923
> 
> 标签：ruby-on-rails, ruby, ip, ip-address, cidr

我想做两件事：将 IP 地址输入转换为 CIDR 以下是一些示例输入：

```
1.1.1.1    
192.168.*.* #=> 192.168.0-255.0-255
192.168.1.2-20
1.1.1-10.1-100 
```

检查给定的 IP 地址是否属于任何 CIDR。这一定是一个非常快速的查询，因为它是我的网络应用程序中非常常见的查找。我正在考虑做这样的事情：

```
def matches?(request)
  valid = @ips.select {|cidr| cidr.contains?(request.remote_ip) }
  !valid.empty?
end 
```

我认为将 IP 范围转换为 CIDR 将使查找速度比我们现在所做的更快，这会将 IP 分解为整数八位字节。然后，我们索引前两组八位字节以部分匹配 IP。另一种选择可能是将所有内容转换为整数并以这种方式进行比较。我会用这样的东西转换成整数，`IPAddr.new("1.1.1.1").to_i`但是我需要为每个范围存储一个上限和下限 IP，而不仅仅是一个 CIDR。

如果我忽略了任何主流方法、流行的 gem 或 repo，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-15T22:36:17.470

好吧，要获得范围的 CIDR 表示法，您需要一个 IP 和网络位数（根据网络掩码计算）。

要枚举给定范围的地址，您可以使用`NetAddr`(< 2.x) gem。

```
p NetAddr::CIDR.create('192.168.1.0/24').enumerate
  => ['192.168.1.0', '192.168.1.1', '192.168.1.2'... '192.168.1.255'] 
```

您还可以即时计算来自网络掩码的位：

```
mask_int = NetAddr.netmask_to_i('255.255.255.0')
p NetAddr.mask_to_bits(mask_int)
  => 24 
```

并基于两个 IP 创建一个范围：

```
lower = NetAddr::CIDR.create('192.168.1.1')
upper = NetAddr::CIDR.create('192.168.1.10')
p NetAddr.range(lower, upper)
  => ['192.168.1.2', '192.168.1.3'... '192.168.1.9'] 
```

因此，现在您可以创建 CIDR 范围，您可以检查 IP 是否是其中的一部分：

```
cidr = NetAddr::CIDR.create('192.168.1.0/24')
p cidr.contains?('192.168.1.10')
  => true 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-15T22:22:54.383

我怀疑你需要的一切都在 IPAddr 中。我用它来查看远程 IP 是否来自专用网络：

```
['127.0.0.0/8', '10.0.0.0/8', '172.16.0.0/12', '192.168.0.0/16', '192.168.10.0/8'
].none?{|block| IPAddr.new(block) === request.remote_ip} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-11-04T15:01:25.697

Maybe I'm misunderstanding the question, but it seems that one aspect of this question has not been addressed, that is, converting a range of ip addresses to one or more CIDR entries.

I use the following approach to lookup suspicious ip activity on my firewall, and if it is in a country that I'm not interested in allowing access (you know who you are) I use whois to lookup the address range, and then calculate the merged CIDRs as follows,

```
whois xxx.yyy.zzz.123
# find address range for this ip
range="xxx.yyy.zzz.0-xxx.yyy.zzz.255".split(/\s*-\s*/)
lower=range[0]
upper=range[1]
ip_net_range = NetAddr.range(lower, upper, :Inclusive => true, :Objectify => true)  
cidrs = NetAddr.merge(ip_net_range, :Objectify => true) 
```

This is a example on an internal network, but it is trivial to extend to a public ip block,

```
whois 192.168.1.3
range="192.168.0.0 - 192.168.255.255".split(/\s*-\s*/)
upper=range[0]
lower=range[1]
ip_net_range = NetAddr.range(lower, upper, :Inclusive => true, :Objectify => true)
cidrs = NetAddr.merge(ip_net_range, :Objectify => true)
p cidrs
[192.168.0.0/16] 
```

Then I can pass that CIDR to my firewall software (shorewall) to have it dynamically drop that cidr(s).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-15T21:01:30.567

您可以使用[NetAddr (> 2.xx) gem](https://rubygems.org/gems/netaddr/)。

使用 parse 类方法从其字符串表示创建 IPv4Net 对象。如果未指定，它将默认为 /32 网络掩码。

```
private_ips = NetAddr::IPv4Net.parse('192.168.0.0/16') 
```

现在您使用 rel 方法来确定与另一个 IPv4Net 对象的关系。例如，如果我们想知道 '2.3.4.5/31' 是否属于`private_ips`

```
private_ips.rel(NetAddr::IPv4Net.parse('2.3.4.5/31')).eql?(1) || private_ips.rel(NetAddr::IPv4Net.parse('2.3.4.5/31')).eql?(0)
=> false

private_ips.rel(NetAddr::IPv4Net.parse('192.168.0.0/31')).eql?(1) || private_ips.rel(NetAddr::IPv4Net.parse('192.168.0.0/31')).eql?(0)
=> true 
```

注意： rel 方法确定与另一个 IPv4Net 的关系。回报：

*   如果此 IPv4Net 是其他的超网，则为 1。
*   如果两者相等，则为 0。
*   -1 如果此 IPv4Net 是其他的子网。
*   如果网络不相关，则为零。

[Gem 文档链接](https://www.rubydoc.info/gems/netaddr/2.0.3/NetAddr)

# r - R，从数据框中获得每个类别的顶部？

> ID：13406604
> 
> 赞同：1
> 
> 时间：2012-11-15T21:33:16.817
> 
> 标签：r, plyr

我有以下数据框

```
id,category,value
A,21,0.89
B,21,0.73
C,21,0.61
D,12,0.95
E,12,0.58
F,12,0.44
G,23,0.33 
```

请注意，它们已经按每个 (id,category) 中的值排序。我想做的是从每个 (id,category) 中获取顶部并创建一个字符串，然后是每个 (id,category) 中的第二个，依此类推。所以对于上面的例子，它看起来像

```
A,D,G,B,E,C,F 
```

有没有办法在 R 中轻松做到这一点？还是我最好依靠 Perl 脚本来做到这一点？

非常感谢提前

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T21:47:24.617

这似乎可行，但我确信我们可以稍微简化它，特别是如果您能够放宽您的订购要求：

```
library(plyr)
d <- read.table(text = "id,category,value
 A,21,0.89
 B,21,0.73
 C,21,0.61
 D,12,0.95
 E,12,0.58
 F,12,0.44
 G,23,0.33",sep = ',',header = TRUE)
d <- ddply(d,.(category),transform,r = seq_along(category))
d <- arrange(d,id)
> paste(d$id[order(d$r)],collapse = ",")
[1] "A,D,G,B,E,C,F" 
```

这个版本可能对排序更健壮，并且避免了**plyr**：

```
d$r <- unlist(sapply(rle(d$category)$lengths,seq_len))
d$s <- 1:nrow(d)
with(d,paste(id[order(r,s)],collapse = ",")) 
```

# php - Yii CDbCommandBuilder 查询

> ID：13406607
> 
> 赞同：0
> 
> 时间：2012-11-15T21:33:24.377
> 
> 标签：php, postgresql, join, yii

我正在尝试使用 CDbCommandBuilder 在 Yii 中执行查询，以便将结果集保存在数组中。

问题是我不明白如何将我的 SQL (pgsql) 转换为 Yii CDbCommandBuilder 语法。主要是我的问题是嵌套连接。

查询：

```
SELECT  p.id
                up.id as fid,
                sum(CASE
                        WHEN v1.count>v2.count THEN v2.count
                            ELSE v1.count
                        END
                ) as res
        FROM product as v1
        INNER JOIN (
            SELECT p_id, count
            FROM product
            WHERE user_id = {$user_id}) as v2 on v1.p_id = v2.p_id and v1.user_id <> {$user_id}
        RIGHT JOIN users as p on p.id = v1.user_id
        INNER JOIN uf on uf.friend_id = p.id and uf.user_id = {$user_id} and is_active = true
        INNER JOIN up on up.user_id = p.id and is_active = true
        GROUP BY p.id, up.id
        ORDER BY res desc 
```

任何人都可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:51:19.390

```
$sql = "SELECT  p.id
                up.id as fid,
                sum(CASE
                        WHEN v1.count>v2.count THEN v2.count
                            ELSE v1.count
                        END
                ) as res
        FROM product as v1
        INNER JOIN (
            SELECT p_id, count
            FROM product
            WHERE user_id = :user_id) as v2 on v1.p_id = v2.p_id and v1.user_id <> :user_id
        RIGHT JOIN users as p on p.id = v1.user_id
        INNER JOIN uf on uf.friend_id = p.id and uf.user_id = :user_id and is_active = true
        INNER JOIN up on up.user_id = p.id and is_active = true
        GROUP BY p.id, up.id
        ORDER BY res desc";

$params = array(':user_id' => $user_id);
$aArrayOfRows = Yii::app()->db->createCommand($sql)->queryAll(true, $params); 
```

# twitter-bootstrap - 如果用户在手机或平板电脑上查看，有没有办法让他们选择查看桌面版本？

> ID：13406610
> 
> 赞同：2
> 
> 时间：2012-11-15T21:33:30.080
> 
> 标签：twitter-bootstrap, responsive-design

我知道 TB 应该根据设备提供优化的内容版本，但我确实喜欢让用户控制他们如何查看网站的想法（即，如果他们愿意，可以选择查看桌面版本）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-28T04:55:08.037

如果单击桌面视图链接或基于用户代理，您可以加载不同的 CSS（无媒体查询）。

如果你想有一个查看桌面版本的链接，你可以附加一个 GET/URL 变量，使你的网站在没有媒体查询 CSS 或只有几个大宽度媒体查询的情况下加载。

如果您想利用 Chrome/Android 浏览器中的“请求桌面站点”功能来提供桌面版本，则需要走用户代理路线。

例如 1\. 检查移动端的用户代理 2\. 如果不是移动端，不要加载媒体查询 CSS 3\. 如果是移动端，加载媒体查询 CSS 以启用响应式布局

这确实剥夺了响应式布局适应不同尺寸显示器或非移动替代设备的能力，仅针对移动设备呈现响应式。

无论哪种方式，您都需要一些逻辑来处理 CSS 切换。如果使用 URL 变量来控制桌面视图，您可以使用 JavaScript 片段轻松完成此操作。用户代理嗅探有点丑陋，最好使用您的本机编程语言完成。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-15T21:52:12.377

简短的回答是否定的。Twitter bootstrap 是围绕一个流体/响应式网格构建的，该网格可以缩放到您正在查看网站的设备的大小。

为了实现您想要的，您将构建一个单独的移动版网站，并在移动设备上引导用户，并在页面底部提供一个选项来查看完整的网站。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-03-26T16:40:06.847

有一种更简单的方法可以强制使用桌面版本。你只需要给 body-tag 一个最小宽度。

例如：

```
 body {
   min-width: 1100px;
} 
```

就这样！玩得开心！

# c# - 使用大型 switch 语句将数据分配给属性......有没有更动态的方法来做到这一点？

> ID：13406612
> 
> 赞同：2
> 
> 时间：2012-11-15T21:33:33.100
> 
> 标签：c#, reflection, refactoring

所以我从数据库中提取了一些信息，我需要将它映射到我的模型的属性。我的第一次尝试产生了一个大的 switch 语句，它遵循一个明显的模式。我想知道这个脆弱的代码是否可以以更动态的方式表达。

```
foreach (AttributeValue attributeValue in attributeValues)
{
    string label = attributes.First(a => a.ID == attributeValue.AttributeID).Name;
    switch (attributeValue.AttributeName)
    {
        case "TaskSequence":
            TaskSequenceLabel = label;
            break;
        case "TaskStatus":
            TaskStatusLabel = label;
            break;
        case "InstallChangeNumber":
            InstallChangeNumberLabel = label;
            break;
        case "InstallChangeStart":
            InstallChangeStartLabel = label;
            break;
        case "InstallChangeEnd":
            InstallChangeEndLabel = label;
            break;
        case "SubmittedDateTime":
            SubmittedDateTimeLabel = label;
            break;
        case "InstalledDateTime":
            InstalledDateTimeLabel = label;
            break;
    }
} 
```

基本上我在想的是“将标签映射到具有标签值+“标签”的属性”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:42:51.867

你可以通过反射来做到这一点：

```
foreach (AttributeValue attributeValue in attributeValues)
{
    string label = attributes.First(a => a.ID == attributeValue.AttributeID).Name;
    string propertyName = attributeValue.AttributeName + "Label";
    PropertyInfo pi = GetType().GetProperty(propertyName, BindingFlags.Public | BindingFlags.Instance);
    // check for null, if it is possible that property not exists
    pi.SetValue(this, label, null);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T21:50:20.720

您可以将标签存储在字典中，并通过其各自的键检索您需要的标签。这可以看作是*Strategy Pattern*的一个非常简单的实现。

```
var labels = new Dictionary<string, Label>();
labels.Add("TaskSequence", TaskSequenceLabel);
labels.Add("TaskStatus", TaskStatusLabel);
// etc.

attributeValues.ForEach(value => {
    string label = attributes.First(a => a.ID == value.AttributeID).Name;
    labels[value.AttributeName] = label;
}); 
```

如果您在多个地方需要它，您可以将其重构为自己的类：

```
public class MyLabels
{
    public Dictionary<string, Label> _labels =
                  new Dictionary<string< Label>();

    public MyLabels() {
        _labels.Add("TaskSequence", TaskSequenceLabel);
        _labels.Add("TaskStatus", TaskStatusLabel);
        // etc.
    }

    public Label Named(string name) {
        return _labels[name];
    }
}

// Usage:
var labels = new MyLabels();
attributeValues.ForEach(value => {
    string label = attributes.First(a => a.ID == value.AttributeID).Name;
    labels.Named(value.AttributeName) = label;
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-15T21:50:48.473

仅反射的解决方案当然可以解决问题。

但是，我会评估自定义属性的使用，您可以使用它来装饰感兴趣的成员。您可以使用它来指定您当前打开的属性名称。

对我来说，这似乎是一个比仅使用反射更强大的解决方案，因为它独立于`TaskSequence`->`TaskSequenceLabel`基于约定的映射。

使用仅反射的方法，如果有人更改 的名称`TaskSequence`，弄清楚为什么事情不再起作用可能比必要的更困难。然而，如果你有一个属性，你根本不在乎。当然，如果数据库中的字段名称发生更改，您*会很在意。*

编辑

让我添加一些代码来澄清一下（实际上是伪代码，我这里没有 Visual Studio 的副本）。我将假设它是您要填充的属性。

```
// here's the custom attribute. Ok, should probably be sealed and bla bla bla.

public class MapToAttribute : Attribute {
  readonly string _fieldName;

  public MapToAttribute(string fieldName) {
    _fieldName = fieldName;
  }
}

// here's your model
public class SomeModel {
  [MapTo("TaskSequence")]
  public int TaskSequence { get; set; }
}

// here's how you figure out which property have the MapTo attribute
from p in typeof(SomeModel).GetProperties() where p.IsDefined(typeof(MapToAttribute)) 
```

其余的留给读者练习。`PropertyInfo.SetValue`和朋友。

# asp.net - 1个控件上的双RegularExpressionValidators，仍然回发吗？

> ID：13406619
> 
> 赞同：0
> 
> 时间：2012-11-15T21:33:50.450
> 
> 标签：asp.net, regex, vb.net, web-applications

我的 asp.net 页面上有 3 个过滤器文本框。每个文本框都分配有 2 个正则表达式验证器，1 个用于数字，1 个用于 alpha。它正确检测到验证，但是当我按下搜索按钮时，即使出现验证工具提示（显示过滤器无效），它仍会回发。有什么想法为什么它“忽略”验证并无论如何发回？这是我对 3 个控件及其验证的定义。

```
<td>
                <asp:TextBox ID="txtAcctFilter" runat="server" BackColor="#FF6600" TabIndex="1">Enter Account No</asp:TextBox>
                <asp:RegularExpressionValidator ID="revAcctFilter" runat="server" Text="*" ControlToValidate="txtAcctFilter"
                    ToolTip="Enter Valid Account" ValidationExpression="^\d*$" ValidationGroup="Numeric"></asp:RegularExpressionValidator>
                <asp:RegularExpressionValidator ID="revAcctFilter2" runat="server" ControlToValidate="txtAcctFilter"
                    ValidationExpression="^Enter Account No$" ValidationGroup="Alpha"></asp:RegularExpressionValidator>
            </td>
            <td>
                <asp:TextBox ID="txtYearFilter" runat="server" BackColor="#FF6600" TabIndex="2"> Enter Year</asp:TextBox>
                <asp:RegularExpressionValidator ID="RevYearFilter" runat="server" Text="*" ControlToValidate="txtYearFilter"
                    ToolTip="Enter Valid Year" ValidationExpression="^20\d{2}$" ValidationGroup="Numeric"></asp:RegularExpressionValidator>
                <asp:RegularExpressionValidator ID="RevYearFilter2" runat="server" ControlToValidate="txtYearFilter"
                    ValidationExpression="^Enter Year$" ValidationGroup="Alpha"></asp:RegularExpressionValidator>
            </td>
            <td>
                <asp:TextBox ID="txtMonthFilter" runat="server" BackColor="#FF6600" TabIndex="3">Enter Month</asp:TextBox>
                <asp:RegularExpressionValidator ID="RevMonthFilter" runat="server" Text="*" ControlToValidate="txtMonthFilter"
                    ToolTip="Enter Valid Month" ValidationExpression="^(1[0-2]|0?[1-9])$" ValidationGroup="Numeric"></asp:RegularExpressionValidator>
                <asp:RegularExpressionValidator ID="RevMonthFilter2" runat="server" ControlToValidate="txtMonthFilter"
                    ValidationExpression="^Enter Month$" ValidationGroup="Alpha"></asp:RegularExpressionValidator>
            </td> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:07:16.617

如果`CausesValidation`未在您的搜索按钮上设置，则可能会发生这种情况。你可以检查一下。

顺便说一句，如果您希望每个文本框的内容满足两个相互矛盾的正则表达式，您可能永远无法提交，因为它们不能同时满足（空字符串除外）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T15:05:22.040

ValidationExpression="^Enter Account No$|^\d+$" 是正确答案。我不得不为 | 的每一侧使用 ^ $ 标签。使其验证双方。这让我可以回到只有一种表达方式。我还为每个控件添加了原因验证以防止回发。到目前为止它的工作:)

# objective-c - 如何用一个顶点数组绘制不连续的线

> ID：13406621
> 
> 赞同：0
> 
> 时间：2012-11-15T21:33:50.413
> 
> 标签：objective-c, ios, graphics, opengl-es

我想在 opengl es 中使用 gldrawarray 绘制一个由 33 个数字组成的顶点数组，即 3D 中的 11 个点。而且我还想将点添加到顶点数组中 33*n，所以我需要使用包含超过 11 个点的顶点数组中的每 11 个点来绘制许多相同的形状。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:42:40.077

使用[`first`and`count`参数](http://www.khronos.org/opengles/sdk/docs/man/xhtml/glDrawArrays.xml)发出多个绘制调用，每个对象一个：

```
int verticesPerObject = 11;
for(int i = 0; i < totalVerticesInArray; i += verticesPerObject)
{
    glDrawArrays(GL_LINE_LOOP, i, verticesPerObject);
} 
```

# xcode - 如何在 Mountain Lion 上使用旧版本的 Xcode 进行构建？

> ID：13406624
> 
> 赞同：0
> 
> 时间：2012-11-15T21:34:13.173
> 
> 标签：xcode, xcode4, osx-mountain-lion, xcode3to4

我刚刚从 Snow Leopard 升级到 Mountain Lion，我正在尝试使用旧版本的 Xcode 3.2.6 构建一个项目。我跑了`sudo xcode-select --switch /Developer`，但现在当我尝试用 构建我的项目时`xcodebuild`，我得到 了

```
xcrun: Error: failed to exec real xcrun. (No such file or directory) 
```

它在 IDE 中构建得很好。我怎样才能让它再次从 CLI 构建？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:16:40.777

我让它工作了。我必须在构建脚本中指定完整路径`/Developer/usr/bin/xcodebuild`。

# audio - 如何从 H.264 帧和音频帧的集合创建 mp4 文件？

> ID：13406625
> 
> 赞同：2
> 
> 时间：2012-11-15T21:34:17.737
> 
> 标签：audio, video, h.264, mp4

我有一个程序可以捕获 H.264 编码的视频和音频并将其存储到专有格式文件中。我需要能够将该视频和音频导出为 mp4 文件。我更喜欢 C#，但如有必要，我会使用 C++。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T12:52:22.283

要生成 MPEG-4 Part 14`.MP4`文件，您需要一个多路复用器。有多种多路复用器可供选择：

*   [FFmpeg（libav 格式）](http://ffmpeg.org/pipermail/ffmpeg-user/2011-November/002967.html)
*   [DirectShow 过滤器（来自GDCL](http://www.gdcl.co.uk/mpeg4/index.htm)的免费和开源，商业）
*   [Windows 7+ Media Foundation 文件接收器](http://msdn.microsoft.com/en-us/library/windows/desktop/dd757763%28v=vs.85%29.aspx)

API 和复杂性可能会有所不同，因为一些多路复用器预计将成为管道的一部分，它们不是完全独立的类。您可能想查看各自的示例（也许还有许可协议），看看什么最适合您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T07:23:03.330

看看 libmp4v2。使用起来相当简单。。

[http://code.google.com/p/mp4v2/](http://code.google.com/p/mp4v2/)

# xml - 爬取 WP8 商店

> ID：13406626
> 
> 赞同：2
> 
> 时间：2012-11-15T21:34:31.747
> 
> 标签：xml, windows-phone-8

去年，我为一个客户编写了一个 CMS，允许他们在 Windows Phone Marketplace 中搜索 WP 7.5 应用程序，并将它们添加到他们拥有的应用程序的列表中。为了完成搜索，我使用了 Zest XML 提要来获取搜索数据。

例如：

```
http://catalog.zune.net/v3.2/en-US/apps?q=Spotify&clientType=WinMobile%207.1&store=zest 
```

调用上述代码将返回一个 XML 响应，我的代码将解析该响应以在 CMS 中显示结果。

这一切都很好，但现在 Windows Phone 8 已经发布，我必须更新我的 CMS 以允许我们的客户搜索 WP8 应用程序。问题是我不能简单地将上面 URL 中的 clientType 更改为 WinMobile 8.0。这样做无论如何都不会返回任何结果。我也不能省略 clientType 参数，因为这会导致它抛出错误。

**所以我的问题是：是否可以使用上述方法在 Windows Phone 商店中搜索 WP8 应用程序？**

由于 Windows Phone 8 太新了，我很难找到任何有关为 8.0 应用程序执行此操作的信息。7和7.5很多。Zest 提要完全有可能还不支持 8.0 查询，但我希望有人知道如何做到这一点。

保持原样（仅搜索 WP 7.5 应用程序）不是一个选项，因为有些应用程序仅适用于 7.5 而不是 8，反之亦然。例如，如果您搜索 7.5 应用程序（来自上面的示例 URL），就会出现 Spotify，但如果您搜索 8.0 应用程序（[http://www.windowsphone.com/en-us/store/search? q=spotify](http://www.windowsphone.com/en-us/store/search?q=spotify)）。

任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T08:28:29.247

这应该很简单，只需安装 WP8 SDK，启动模拟器并启动某种网络嗅探器，如 Fiddler。
然后在模拟器中浏览 Windows Phone 商店，嗅探器应该会捕获所有请求，包括您正在寻找的地址，当然，除非现在在 WP8 上使用加密或 SSL 来浏览 Windows Phone 商店。

# android - Android BackupAgent 不工作

> ID：13406630
> 
> 赞同：3
> 
> 时间：2012-11-15T21:34:50.503
> 
> 标签：android, android-preferences, android-backup-service

我正在尝试让 BackupAgent 正常工作，但无法正常工作。这是我的示例代码：

布局只是一个 TextView 和一个 Button。

主要活动：

```
...     
public static final String PREF_NAME = "TestPref";
    private static final String TEST_KEY = "TEST";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    final SharedPreferences pref = getApplicationContext()
            .getSharedPreferences(PREF_NAME, MODE_PRIVATE);

    if (pref.getString(TEST_KEY, "").length() == 0) {
        pref.edit().putString(TEST_KEY, "new Date())
                .commit();
        new BackupManager(getApplicationContext()).dataChanged();
    }

    Button button = (Button) findViewById(R.id.button1);
    button.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            TextView tv = (TextView) findViewById(R.id.textView1);
            if ("START_VALUE".equalsIgnoreCase(tv.getText().toString())) {
                tv.setText(pref.getString(TEST_KEY, ""));
            }
        }
    });
} 
```

BackupHelper 只是我在这里可用的：http: [//developer.android.com/reference/android/app/backup/SharedPreferencesBackupHelper.html](http://developer.android.com/reference/android/app/backup/SharedPreferencesBackupHelper.html) 我用我使用的那个调整了 pref 文件的名称。

在我添加的清单中 `android:backupAgent="TheBackupAgent"`（应用程序标签）和备份元数据

```
 <meta-data android:name="com.google.android.backup.api_key"
          android:value="{registered_key}" /> 
```

所以它真的是一个非常简单的应用程序。

我现在正在执行以下操作：

1）启动应用程序

2）Textview在xml文件中用“START_VALUE”初始化，所以我按下按钮并显示pref-value

3）我从控制台运行“adb shell bmgr run”以立即运行备份

4）我运行“adb卸载com.foo.backuptest”

5）我运行“adb install com.foo.backuptest”

现在值（时间戳）未从云中恢复。生成一个新的。

我的错误在哪里？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-09T22:16:35.970

您的清单文件需要包含以下内容才能打开备份：

```
android:allowBackup="true"
android:backupAgent="TheBackupAgent" 
```

你的手机备份设置呢？确保选中“备份我的数据”和“自动恢复”，并且您输入了有效的备份帐户电子邮件 ID。

要了解 Google 备份数据的时间和频率，请查看此链接： [Android 备份服务 - 备份时间和频率？](https://stackoverflow.com/questions/15049004/android-backup-service-when-and-how-often-to-backup)

根据这个Tester（我刚才也进行了备份频率测试）：[https ://advancedweb.hu/2014/12/09/practical_measurement_of_the_android_backup_manager/](https://advancedweb.hu/2014/12/09/practical_measurement_of_the_android_backup_manager/)

备份管理器服务每小时响应一次（我在测试中也证明了这一点），只要在自上次数据备份请求后的一小时之间调用至少一个 DataChanged()

要使用命令行进行快速测试，请尝试以下命令：

确保启用数据备份： adb shell bmgr enable true

请求数据备份： adb shell bmgr backup your.package.name

启动数据备份： adb shell bmgr run

要卸载您的应用程序： adb uninstall your.package.name

然后安装您的应用程序： adb install your.package.name

# python - 尝试在 macbook pro 上安装 matplotlib

> ID：13406631
> 
> 赞同：0
> 
> 时间：2012-11-15T21:34:54.137
> 
> 标签：python, macos, matplotlib

我需要将[matplotlib](http://matplotlib.org/)用于学校项目，但无法将其安装在我的 Mac 上。我下载了它的一个版本，但是当我尝试导入它时它不起作用。我有 mac os x 10.5.8，想知道是否有人可以推荐我在哪里可以找到合适的软件包。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:41:21.433

我永远无法让它以正确的方式工作，所以我通过 GitHub 完成了。

打开终端并执行：

```
git clone https://github.com/matplotlib/matplotlib.git 
```

然后更改到它将自动创建的文件夹（位于您的主文件夹中）并执行以下操作：

```
python setup.py build 
```

然后

```
python setup.py install 
```

对于其中的一些，您可能不得不 sudo 。

# javascript - 客户端浏览器的 Socket.IO 检测有时会失败

> ID：13406632
> 
> 赞同：2
> 
> 时间：2012-11-15T21:34:54.343
> 
> 标签：javascript, node.js, websocket, socket.io, real-time

我正在开发一个使用 Node.js 和 Socket.IO 的实时跟踪应用程序。在目标站点上的[跟踪代码中，我有一些代码可以抓取浏览器的用户代理字符串并将其发送回服务器。](https://github.com/aaronjwood/viper/blob/master/README.md)这通常可以正常工作，但有几次此数据设置为未定义（[这就是它发生的地方](https://github.com/aaronjwood/viper/blob/7b72dd0bfdedd46874e2c7f3f866b2f088feaf07/server.js#L58)）。

目前，我在服务器上只有一个巨大的 try/catch 块，因此在运行我定义的用于检测它是什么浏览器的方法时它不会崩溃（[它在尝试运行 match() 方法时会崩溃](https://github.com/aaronjwood/viper/blob/7b72dd0bfdedd46874e2c7f3f866b2f088feaf07/class/Util.js#L5)）。我假设这发生在机器人或其他没有用户代理或已被篡改的浏览器中。我错了吗？还有其他原因吗？

Socket.IO 是否为浏览器检测提供任何东西？无论哪种方式，我都知道我需要使浏览器检测功能更加强大，但我只是让这个项目起步。

如果没有更好的方法来做到这一点，我是否最好只检查发送到服务器的数据是否未定义并将其视为“其他”浏览器？

![在此处输入图像描述](../Images/c287c116ce48fc985b3bd37b97886abe.png)

看到总连接数和总浏览器数的差异了吗？目前，相差 100 多一点。如果没有发生此浏览器跟踪问题，数字应该完全相同（因为每个连接都会有浏览器、分辨率、操作系统和 URL）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T12:55:15.093

我对 socket.io 不是很熟悉，但看起来您可以在`socket.handshake.headers`（[Socket.io 的 Wiki – Authorizing](https://github.com/LearnBoost/socket.io/wiki/Authorizing)）中获取请求标头。我不知道哪些浏览器运行 JavaScript 但没有`navigator.userAgent`设置，但也许他们会发送 User-Agent HTTP Header？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-18T06:27:28.117

This actually had nothing to do with bots or tampered data like I thought it did. My problem was due to a rare race condition where the client would connect to the server but disconnect before sending the data to the server (the "beacon" event I have set up is where the client sends the data and the server receives it). So when the client went to disconnect, my server would look up the client but would return a undefined result because the data was never sent and stored in the first place. A rewarding experience but what a pain!

# html - 每隔一页加载图像返回 412（前提条件失败）

> ID：13406633
> 
> 赞同：0
> 
> 时间：2012-11-15T21:34:59.887
> 
> 标签：html, local-storage

我使用 HTML 5 LocalStorage 来存储一些包含图像的 HTML。当我使用此代码从该缓存中提取时：

```
$('#mydiv').append(localStorage.getItem('html_cache')).fadeIn(); 
```

它第一次工作正常，没有错误。如果我点击重新加载，我会收到此错误：

> 获取[https://pbs.twimg.com/media/A7w5LkHCMAAft1N.jpg:thumb](https://pbs.twimg.com/media/A7w5LkHCMAAft1N.jpg:thumb) 412（前提条件失败）

显然，第二页加载时有些不同，但我似乎无法弄清楚是什么。当我检查源代码时，它对我来说看起来完全一样。

我不熟悉 412 错误。任何想法是这里发生了什么或我如何追踪它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T02:13:03.783

这是 Twitter 方面的一个问题。有几个人报告了它，他们最终修复了它。我不再收到错误消息。

更多信息：[http ://dev.twitter.com/discussions/12747](http://dev.twitter.com/discussions/12747)

# asp.net - 更新 tableadapter 抛出错误输入字符串的格式不正确

> ID：13406636
> 
> 赞同：0
> 
> 时间：2012-11-15T21:35:08.663
> 
> 标签：asp.net, debugging, exception, formatting, tableadapter

当我打电话

```
TA.Update(row) 
```

我收到以下错误，但我不知道如何调试它。有没有办法确定导致问题的确切字段？

“/”应用程序中的服务器错误。

输入字符串的格式不正确。

说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详细信息：System.FormatException：输入字符串的格式不正确。

源错误：

第 7381 行：Global.System.ComponentModel.Design.HelpKeywordAttribute("vs.data.TableAdapter")> _ 第 7382 行：公共重载可重写函数更新（ByVal dataRow As Global.System.Data.DataRow）作为整数第 7383 行：返回给我.Adapter.Update(New Global.System.Data.DataRow() {dataRow}) 第 7384 行：结束函数第 7385 行：

源文件：C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET Files\root\aebf90fc\865092c3\App_Code.6h2d5goz.23.vb 行：7383

堆栈跟踪：

[FormatException: 输入字符串格式不正确。] System.Number.StringToNumber(String str, NumberStyles options, NumberBuffer& number, NumberFormatInfo info, Boolean parseDecimal) +14365689 System.Number.ParseInt32(String s, NumberStyles style, NumberFormatInfo info ) +305 System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider) +859 System.Data.SqlClient.SqlParameter.CoerceValue(Object value, MetaType destinationType, Boolean& coercedToDataFeed, Boolean& typeChanged, Boolean allowStreaming) +1809

[FormatException：无法将参数值从字符串转换为 Int32。] System.Data.Common.DbDataAdapter.UpdatedRowStatusErrors(RowUpdatedEventArgs rowUpdatedEvent, BatchCommandInfo[] batchCommands, Int32 commandCount) +2290668 System.Data.Common.DbDataAdapter.UpdatedRowStatus(RowUpdatedEventArgs rowUpdatedEvent, BatchCommandInfo[] batchCommands, Int32 commandCount) +75 System.Data.Common.DbDataAdapter.Update(DataRow[] dataRows, DataTableMapping tableMapping) +3479 System.Data.Common.DbDataAdapter.Update(DataRow[] dataRows) +319 adsTableAdapters C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET Files\root\aebf90fc\865092c3\App_Code.6h2d5goz.23.vb:7383 中的 .adsTableAdapter.Update(DataRow dataRow) editad.lbSaveLocation_Click(Object发件人，EventArgs e) 在 C:\Dropbox\inetpub\zz\editad.aspx.vb:765 System.Web 中。UI.WebControls.LinkBut​​ton.RaisePostBackEvent（字符串 eventArgument）+153 System.Web.UI.Page.ProcessRequestMain（布尔 includeStagesBeforeAsyncPoint，布尔 includeStagesAfterAsyncPoint）+3804

尝试像这样添加对错误的检查，但没有发生错误：

```
Try
        If TA.Update(row) = 1 Then

        End If
    Catch ex As Exception
        Dim arr As Array = row.Table.GetErrors()
        'arr.length=1 here
        If arr.Length > 0 Then
            lblStatus.Text = row.Table.GetErrors(0).ToString
'the value of row.Table.GetErrors(0).ToString is "ads+adsRow"
        End If            
    End Try 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:40:25.573

[这个异常](http://msdn.microsoft.com/en-us/library/system.formatexception%28v=vs.110%29.aspx)可能有很多原因（fe `int.Parse("abc")`）。

您可以在 Visual Studio 中调试器的[**快速监视窗口**](http://msdn.microsoft.com/en-us/library/cyzbs7s2.aspx)中执行该行。然后您可以通过以下方式检索`rows`包含所有行错误的内容[`DataTable.GetErrors`](http://msdn.microsoft.com/en-us/library/system.data.datatable.geterrors.aspx)：

```
row.Table.GetErrors() 
```

然后你就可以检查这些行了。看看[`DataRow.RowError`](http://msdn.microsoft.com/en-us/library/system.data.datarow.rowerror.aspx)物业。在那里，您将找到导致异常的详细错误和列。

全部在快速监视窗口中，否则您无法调试该异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T17:43:11.740

发现了问题。我通过手动设置表适配器的所有列来调试它，所以我知道所有格式正确的值。问题还是出现了。在 SQL Profiler 中，我没有看到任何更新命令通过，因此没有任何东西传递给数据库。解决方案：在表适配器的自动生成更新命令中，更新参数被称为@Original_id。我重命名为@id，它起作用了：S

# plasticscm - 我可以使用 Plastic 命令行实用程序创建选择器文件吗？

> ID：13406640
> 
> 赞同：0
> 
> 时间：2012-11-15T21:35:21.120
> 
> 标签：plasticscm

我正在尝试编写一个批处理文件供我的开发人员运行以设置工作区。批处理文件将使用 Plastic 的命令行实用程序`cm.exe`.

当我在 Plastic 客户端 GUI 中创建工作区时，有一个组合框允许我选择存储库。这会生成一个`plastic.workspace`文件，以及一个`plastic.selector`包含对所选存储库的引用的文件。

但是，当我使用命令行实用程序创建工作区时，我必须指定一个现有的选择器：

`cm mkwk MyWorkspace c:\MyWorkspacePath --selector=my.selector`

或在提示时编辑选择器：

`cm mkwk MyWorkspace c:\MyWorkspacePath --selector`

理想情况下，我希望能够做类似的事情

`cm mkwk MyWorkspace c:\MyWorkspacePath MyRepository@MyServer:8888`

并以与 GUI 相同的方式生成文件。

有没有办法使用 来做到这一点`cm.exe`，还是我必须事先编写所有选择器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T08:57:14.167

尽管没有记录，但您可以发出带有“--repository”参数的“mkwk”命令。例如：

```
cm mkwk code c:\code --repository=code@localhost:8087 
```

希望能帮助到你！

# java - 尝试使用外部 .jar 在 Android 中不起作用

> ID：13406643
> 
> 赞同：0
> 
> 时间：2012-11-15T21:35:26.220
> 
> 标签：java, android, jar, logcat

我正在尝试让一个小型 aac 无线电流在 android 应用程序中播放。我正在尝试使用[http://code.google.com/p/aacdecoder-android/](http://code.google.com/p/aacdecoder-android/)但我对 code.google.com 的运气从来没有太好，因为我发现很多项目很难使用。

我下载了 zip，我想我在我的项目属性中正确设置了它。

当我尝试运行代码行来播放文件时，出现此错误：

```
11-15 16:28:25.750: E/AndroidRuntime(3626): Caused by: java.lang.UnsatisfiedLinkError: Couldn't load aacdecoder: findLibrary returned null 
```

我使用的代码是这样的：

```
import com.spoledge.aacdecoder.AACPlayer;
...
AACPlayer aacPlayer = new AACPlayer();
aacPlayer.playAsync( "http://..." ); 
```

有任何想法吗？我不认为它与 aacdecoder 项目本身有关，我认为我实际上设置不正确。我在日食中没有任何红线。想法？

![在此处输入图像描述](../Images/046388ea63332f3e235e66c481fa3105.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:00:37.767

似乎您忘记了复制`*.so`（本机库），因为我刚刚创建了新项目，添加`*.jar`到**Java 构建路径**（您已经这样做了）并且它播放流很好。我的代码：

```
@Override
protected void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(new Button(this));

    AACPlayer aacPlayer = new AACPlayer();
    aacPlayer.playAsync( "http://http.yourmuze.com:8000/play/paradise/h.aac" );
} 
```

并且不要忘记添加权限：

```
<uses-permission android:name="android.permission.INTERNET"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:00:09.957

尝试查看这些链接，他们有类似的问题

*   [Android - '无法加载 Foo：findLibrary 返回 null'](https://stackoverflow.com/questions/11760284/android-couldnt-load-foo-findlibrary-returned-null)

*   [Android NDK java.lang.UnsatisfiedLinkError: findLibrary 返回 null](https://stackoverflow.com/questions/9037966/android-ndk-java-lang-unsatisfiedlinkerror-findlibrary-returned-null)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-15T21:37:03.673

确保它位于 /lib 文件夹和构建路径的项目属性中。并确保其列出的顺序高于/src。

# c - 如何从 char 缓冲区读取无符号长短

> ID：13406647
> 
> 赞同：1
> 
> 时间：2012-11-15T21:35:42.797
> 
> 标签：c

编辑：我不确定这段代码是否符合我的想法。有人可以告诉我如何测试它吗？即我的主函数中的缓冲区应该是什么样的？我假设缓冲区具有以下顺序类型（16 位）、长度（32 位）的两个字段的数据。我假设缓冲区是从文件中读取的，并且每个字段都用空格分隔。这些字段以网络字节顺序存储，当我阅读它们时，我必须将它们转换回主机字节顺序。

我期望代码将从文件中读取内容（应该按网络字节顺序）并按主机字节顺序显示内容。我对类型转换以及文件中的网络字节顺序有点困惑，所以我不知道要使用什么值来测试它。另外，我不确定我的代码是否正确编写，做这种事情或对这种转换有更多了解的人可以告诉我我的代码是否正确吗？

这是代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

void printRecords(char *buffer)
{
     unsigned int recordType;
     unsigned long recordLength;
     char *data;
     char *index;

     if (!buffer)
         printf("Empty buffer\n");

     while(*buffer)
     {
        memcpy(&recordType,(const void *) buffer,2);
        buffer += 3;

        recordType = ntohs(recordType);
        printf("Record type normal: %u\n",recordType);

        memcpy(&recordLength,(const void *) buffer,4);
        buffer += 5;
        recordLength = ntohl(recordLength);
        printf("Record Length normal: %l\n",recordLength);

        break;
     }
}

void main()
{
     char * buffer = "0000000000000001 00000000000000000000000000000001";
     printRecords(buffer);

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:45:15.563

```
char *buffer = malloc(sizeof(buf)); 
```

sizeof 表示“buf 类型的大小”，即指向 char 的指针的大小；你可能想要

```
malloc(strlen(buf) + 1); /* 1 for trailing '\0' */ 
```

那么您将字节的值误认为是它们转换为字符串的值：“256”是字节“2”，后跟字节“5”和“6”——“2”不等于 2，“5”不等于到 5 等等。你正在谈论的 256 是 00000001 00000000 （尝试将字节转储到标准输出，你会看到）。

此外，recordType 应该是 uint16_t 类型，而不是无符号的——你永远不会太偏执。

编辑： atoi 采用指向 char 的指针，如

```
atoi("123") 
```

不是指向 int 的指针！

# r - ggplot2 | 如何绘制 x、y、color=group、facets=Drug~ 的平均线。不能让它看起来正确

> ID：13406654
> 
> 赞同：0
> 
> 时间：2012-11-15T20:35:27.717
> 
> 标签：r, ggplot2

我有一个包含三个因素（`Group`=Between；`Drug`=Within；`Session`=Within）和一个响应变量（`DEs2mPre`）的数据集。我可以使用绘制多面箱线图

```
qplot(Session, DEs2mPre, data = Dummy.Data, colour = Drug, facets=Group~., -geom="boxplot") 
```

我有三个组和两个级别的药物，所以我得到了很好的 3X2 图表，每个组有 3 个单独的图表，每个图表的会话中有两个级别的药物。但是，我希望看到的不是箱线图，而是在每个会话上连接均值的线。当我将 geom 更改为 时`geom="line"`，我得到一堆线条，看起来像是数据集中每个主题的线条，而不是数据的分组（平均）可视化，就像您使用`lineplot.CI`（`sciplot`包）看到的那样。

有没有办法做到这一点`ggplot2`？

抱歉，我无法添加图表，因为我没有足够的“声誉点”。

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:52:31.117

`ggplot`由于默认情况下连接所有数据点，因此您会得到一团乱线。您需要告诉`ggplot`使用每个组的平均值。适当的论点是`stat = "summary"`和`fun.y = "mean"`。

```
qplot(Session, DEs2mPre, data = Dummy.Data, colour = Drug, facets = Group~.,
      stat = "summary", fun.y = "mean", geom = "line") 
```

# c - 在结构（C）中为ptr赋值

> ID：13406657
> 
> 赞同：1
> 
> 时间：2012-11-15T21:36:08.583
> 
> 标签：c

我在 .h 文件中声明了一个结构，如下所示：

```
struct node{
char* string;
} 
```

我打算创建一个结构，例如，具有一个成员，一个名为 string 的字符指针。

现在，我计算出字符串有多长，然后 malloc 一个适当大小的数组，并用它来输入。

```
char* test;
test = (char*) malloc( n * sizeof(char) ); 
```

据我所知，这已经创建了字符指针测试，并将其分配给我刚刚 malloc 的数组的头部。然后我继续将每个数组槽分配给用户输入的字符，然后我将其读回 - 这一切都可以编译并正常工作。当我尝试将此字符指针分配给传递给此结构的结构节点中的字符指针时，我的问题出现了，如下所示：

```
int f1( struct node* new ){ 
```

所以我尝试将结构中的指针分配给指向数组的指针的值，如下所示：

```
new->string = test; 
```

但我有段错误。

对我来说，这似乎是我将 char* 分配给期望 char* 的东西，所以这应该可以正常工作......我可能错过了一些愚蠢的东西，但有人有方向指向我吗？非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:44:11.613

检查你的调用者`f1()`并确保你的参数是**有效**的。

这将起作用：

```
struct node *you = malloc(sizeof(struct node));
if (you)
{
    f1(you);
    free(you);
} 
```

就像这样：

```
struct node me;
f1(&me); 
```

**这行不通**

```
struct node *me;
int f1(me); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:24:24.930

需要注意的一些观察结果：

1.  `sizeof(char)`根据定义是一个。

2.  推荐的调用方式`malloc`是一种避免强制转换以及获取 sizeof 以从分配的指针推断类型的方法。（见下文）

3.  避免使用诸如`new`标识符之类的名称（尽可能）。

4.  完成后记得给里面`free`的`string`成员`node`。

要详细说明＃2，请参见下文 -

```
struct MyType *foo;
foo = malloc( n * sizeof *foo ); /* allocate n elements where n > 0 */ 
```

出于某种原因，如果您选择 foo 为其他类型，则该`malloc`调用将减少您担心的一行。此外，如果您忘记包含 stdlib.h，编译器会通知您。

# java - Linux bash：java.net.ConnectException：连接被拒绝

> ID：13406660
> 
> 赞同：1
> 
> 时间：2012-11-15T21:36:21.577
> 
> 标签：java, linux

我有一个`Read`从 URL 读取文件的 java 程序，如下所示： `file://myhost/system.log`

在 Windows 上，我使用以下命令：

`java Read "file://myhost/system.log"`

它完美无瑕。

但是在 Linux 上，当我尝试使用相同的命令时，它给了我这个错误：

```
Exception in thread "main" java.net.ConnectException: Connection refused
        at java.net.PlainSocketImpl.socketConnect(Native Method)
        at java.net.AbstractPlainSocketImpl.doConnect(Unknown Source)
        at java.net.AbstractPlainSocketImpl.connectToAddress(Unknown Source)
        at java.net.AbstractPlainSocketImpl.connect(Unknown Source)
        at java.net.Socket.connect(Unknown Source)
        at java.net.Socket.connect(Unknown Source)
        at sun.net.ftp.impl.FtpClient.doConnect(Unknown Source)
        at sun.net.ftp.impl.FtpClient.tryConnect(Unknown Source)
        at sun.net.ftp.impl.FtpClient.connect(Unknown Source)
        at sun.net.ftp.impl.FtpClient.connect(Unknown Source)
        at sun.net.www.protocol.ftp.FtpURLConnection.connect(Unknown Source)
        at sun.net.www.protocol.ftp.FtpURLConnection.getInputStream(Unknown Source)
        at java.net.URL.openStream(Unknown Source)
        at read.readInput(ReadHTML.java:53)
        at read.readInput.main(ReadHTML.java:76) 
```

有任何想法吗？

**更新**：我想我发现了问题： `myhost`没有安装在 Linux 机器上，因此它无法通过使用连接到它`file://...`

感谢所有的答案，伙计们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:40:17.850

这是因为您的程序（通过`file`在 Linux 操作系统上使用 URL）正在尝试打开与 URL 中指定的主机的 FTP 连接。FTP连接建立失败。

这可能是由于各种问题。尝试直接用 ftp 连接：

`ftp myhost`

而且我猜它也会失败。您是否安装并运行了 FTP 服务器？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:40:45.953

可能的原因之一可能是 hosts.allow 没有您的机器的条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T21:49:37.117

我怀疑你只需要第三个/。文件 uris 的正确语法是 file://[path]，但 [path] 应该以 / 开头。

# ruby-on-rails - 使用 rake 任务和 Nokogiri 将 XML 提要保存到数据库时出现导入错误

> ID：13406661
> 
> 赞同：0
> 
> 时间：2012-11-15T21:36:27.270
> 
> 标签：ruby-on-rails, ruby, database, nokogiri

我编写了一个 rake 任务来将 XML 提要导入我的 ActiveRecord 模型，但遇到了一些麻烦 - XML 提要不会发布任何空列，这会破坏我的迁移工具。如何设计我的导入器以使其跳过空白字段？

我的进口商看起来像这样

```
desc "Import XML Feed into Items Database v20121116" 
task :new_import_items => :environment do

require 'nokogiri'
require 'open-uri'

doc = Nokogiri::XML(File.open("#{Rails.root}/lib/tasks/datafeed.xml"))

actions = doc.xpath("/merchantProductFeed/merchant/prod") 

actions.each do |action|

a = Item.where("affiliate_product_id = ?", action.css("pId").text).first

if a != nil

  a.update_attributes(

    :brand => action.at('brandName').text, 
    :description => action.at('desc').text, 
    :regular_price => action.at('buynow').text,

    .... 
```

假设“desc”在 xml 提要中不可用。我希望我的代码在这种情况下忽略“desc”。

错误信息是无用的：

```
undefined method `text' for nil:NilClass 
```

但它与文本方法无关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:23:54.563

您可以使用[try 方法](http://api.rubyonrails.org/classes/Object.html#method-i-try)：

```
if a != nil
  a.update_attributes(
    :brand => action.at('brandName').try(:text), 
    :description => action.at('desc').try(:text), 
    :regular_price => action.at('buynow').try(:text),

    .... 
```

医生说：

> 如果接收对象是 nil 对象或 NilClass：将**不会**引发 NoMethodError 异常，而是返回 nil。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T02:04:49.337

我会在 Nokogiri 查询中查找文本：

```
if a != nil
  a.update_attributes(
    :brand => action.at('brandName/text()'), 
    :description => action.at('desc/text()'), 
    :regular_price => action.at('buynow/text()'),

    ... 
```

如果元素不存在，这不会引发异常。

# jquery - 文本在圆圈边界内换行，文本垂直和水平居中

> ID：13406662
> 
> 赞同：0
> 
> 时间：2012-11-15T21:36:30.440
> 
> 标签：jquery, html, css, text, geometry

我们爱圈子！我需要帮助将文本放在一个圆圈内，并让文本行环绕在圆圈的边缘。

我在这里有两种不同的、不足的尝试：http: [//chrislaursen.com/papertwin/band/](http://chrislaursen.com/papertwin/band/)

第一个使用 jquery 插件 TextMorph：[http](http://nicodmf.github.com/TextMorph/en.html) ://nicodmf.github.com/TextMorph/en.html 。这将文本很好地包裹在圆圈内，但我不知道如何垂直居中。

我页面上的第二个圆圈只是使用填充将文本保留在圆圈内。这是一个简单的 css 解决方案，它不会将文本置于所需的圆形中。

我认为解决方案涉及修改第一个圆圈中使用的插件以使文本垂直居中，但我不知道该怎么做。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T23:27:55.787

其他解决方案没有通用化，所以我想我会尝试制作一个更具算法性的解决方案。如果您查看[TextMorph](https://raw.github.com/nicodmf/TextMorph/master/Source/jquery.TextMorph.js)的代码，您会看到`.content`元素（包含文本）的`margin-top`属性设置为负值`total-height - lineheight`（这些都是您在初始化 TextMorph 对象时设置的）。包含您的文字的`<div>`文字通常会出现在您的圆圈（或其他形状）下方，因此它被“备份”到位。为了使文本完美居中，我们需要做的就是“备份”它以使其居中。

下面的代码首先将`.content`'s设置`margin-top`为圆高度的 1/2。这使文本出现在圆圈的下半部分。然后它逐渐调整`margin-top`of`.content`直到它*几乎*居中（参见代码中的注释）。它考虑到文本的高度（以像素为单位）可能会发生变化，具体取决于字体、字体大小、浏览器渲染等。

片段：

```
$('.content').css('text-align', 'justify');
topMargin = 0 - $('#circle').height() / 2;
$('.content').css('margin-top', topMargin + 'px');

make_vertical_center = function() {
    var heightAbove, offset;

    topMargin -= lineHeight / 4; // more precision, but also more increments as this approaches 1

    $('.content').css('margin-top', topMargin + 'px');

    heightAbove = Math.abs(($('#circle').height() - $('.content').height()) / 2);
    offset = Math.abs($('#circle').offset().top - $('.content').offset().top);

    if (offset - heightAbove > 0) {
        make_vertical_center();
    }
};

make_vertical_center(); 
```

看看[这一切的小提琴](http://jsfiddle.net/beej/qS5HP/16/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:03:54.780

这**远**不是最好的解决方案，它更像是一个快速修复，但它有效（见[这里](http://jsfiddle.net/LuJpa/1/)）。

```
$(function() {
    var pad = new Array(75).join("&nbsp;");
    $('#circle').prepend(pad);

    var circle = new TextMorph(document.getElementById('circle'), {
        width: 500,
        height: 500,
        lineHeight: 15
    });
}); 
```

这个想法是用空格前缀填充文本，以便它被“推”下来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:28:23.447

我所做的是用“p”标签将“div”中的文本包裹起来。然后我尝试了这[6 种方法](http://www.vanseodesign.com/css/vertical-centering/) ，当它在块元素中时如何垂直对齐 div 中的文本（如“p”标签）。

我已经尝试了其中一些 - 您可以选择最适合您需求的一种。您可能需要一些 CSS 调整（稍微更改样式），但这里重要的是如何使这些东西正常工作的想法。

这就是我所做的：

```
<div style="margin-top: -499px;" class="content"><p style="
    position: absolute;
    top: 100px;
    left: 0;
    right: 0;
    bottom: 0;
    width: 60%;
    height: 30%;
    margin: auto;
    margin-top: 20%;
">Bro­ok­lyn’s syn­th gro­up Pa­per­twin (Max Dec­ker, Fran­cis Car­di­nale, Nic­k Sho­pa, Jus­tin Mic­he­al Mil­ler) was fo­un­ded in 2009\. It­s de­but EP “Por­ce­la­in,” re­le­a­sed in 2011, of­fer­s a dar­k, re­veren­t vi­si­on of new wa­ve, em­bra­cin­g it­s hig­h e­ner­gy whi­le drif­tin­g in­to a ter­ri­tory of dre­am­s an­d hal­f-lig­ht. The qu­ar­tet is set to re­le­a­se it­s se­con­d EP, “Pe­ru,” this sprin­g.</p></div> 
```

注意应用于“p”元素的css。

# azure - 如何允许未知用户访问我的 SQL (Azure) DB？

> ID：13406663
> 
> 赞同：71
> 
> 时间：2012-11-15T21:36:34.730
> 
> 标签：azure, azure-sql-database

显然，必须明确指定（白名单）允许访问 SQL Azure DB 的 IP 地址。不过，我希望拥有 N-gazillion* 用户来访问这些表以获取特定于他们的数据。

*   自大/自大妄想

这些是否需要首先向我提供他们的 IP 地址，以便我可以将其添加为有效条目，或者是否有编程方式或其他解决方法？

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2012-11-15T21:43:10.243

建议让某种中间件访问数据库，而不是直接访问您的客户。

但是，如果您希望任何 IP 都能够连接到数据库，只需将此条目添加到防火墙列表中：

Azure 门户 -> 数据库 -> 服务器 -> 配置并添加以下规则：

![在此处输入图像描述](../Images/118925a62057d077821b856c4dae979a.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-15T21:43:45.063

您的用户将如何通过 Web 应用程序（前端）或直接访问数据库（我假设您不会让用户直接访问您的数据库？），如果它通过 Web 应用程序（表示层），那么您所需要的一切todo 是授予对表示层/服务层的此 IP 地址的访问权限（如果托管在 Azure 中，则在其旁边）。

SQL DB Azure 有两种访问限制（更多信息在这里）“ [Windows Azure SQL 数据库防火墙](http://msdn.microsoft.com/en-us/library/windowsazure/ee621782.aspx)”

*   服务器级防火墙规则：
*   数据库级防火墙规则

您可以打开所有 IP 地址 0.0.0.0 - 255.255.255.255（不是很安全），或者根据上述数据库防火墙规则提出更细粒度的策略。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-12-28T12:20:14.933

唯一的方法是通过 SQL 查询。Azure 仅显示仅在门户上可见的防火墙服务器规则，但在数据库级别上，唯一的方法是通过 SQL。

```
-- Enable Allconnections.  
EXECUTE sp_set_database_firewall_rule N'Allow All', '0.0.0.0', '255.255.255.255'; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-18T07:16:16.997

```
Login to azure Portal

    select your database subscription

        click on Tools

                Now there is option 'Open in VisualStudio' (click on it)

                    You can see "Configure Firewall" click on it.

        Add you new IP.

Done :) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-15T21:42:51.667

如果您让他们直接与您的数据库对话（例如通过 SSMS），您需要输入他们的 IP（或者您可以将整个范围列入白名单）。通常他们会通过您自己的 API 使用您的数据库，然后不需要将他们的 IP 地址列入白名单。

# c# - 如何设置标签的格式？

> ID：13406667
> 
> 赞同：0
> 
> 时间：2012-11-15T21:36:58.237
> 
> 标签：c#, graph, axis-labels, teechart

所以，我正在尝试绘制图表，我在 Tchart 中有 3 条快线，看起来图表是正确的，但是我需要用轴标签设置一些东西，我得到的是这个，[我的带有 x 标签的图表作为 0 0 0 0 1 1 1 1 ] [http://s8.postimage.org/t7tappekl/image.png](http://s8.postimage.org/t7tappekl/image.png)

[我想要这样的东西]

[http://s7.postimage.org/amltkb917/untitled.png](http://s7.postimage.org/amltkb917/untitled.png) 而我想要得到的是这样的东西，实际的 x 标签就是这些。X 标签是秒。我已经尝试为系列和图表标签设置 valueformat。它不起作用，

我该怎么做？而且我正在尝试缩放和向上滚动 y 轴以设置焦点，如图像 2\. y 图始终从 0 开始，但最初有什么方法可以将焦点设置在起点 ie81

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T11:02:25.480

您可以使用所谓的 Increment 属性为底部轴标签设置所需的增量，例如：

```
 tChart1.Axes.Bottom.Increment = 0.1; 
```

要更改轴范围，您可以使用 SetMinMax 或 Minimum 和 Maximum 属性：

```
 tChart1.Axes.Left.SetMinMax(50, 100); 
```

或者

```
 tChart1.Axes.Left.AutomaticMinimum = false;
  tChart1.Axes.Left.Minimum = 50;
  tChart1.Axes.Left.AutomaticMaximum = false;
  tChart1.Axes.Left.Maximum = 100; 
```

最后，您可以更改图表视图透视图，更改以下一些属性：

```
 tChart1.Aspect.View3D = true;
  tChart1.Aspect.Orthogonal = false;
  tChart1.Aspect.Chart3DPercent = 50;
  tChart1.Aspect.Elevation = 0;
  tChart1.Aspect.Rotation = 345;
  tChart1.Aspect.Perspective = 50; 
```

顺便说一句，您将在教程 4 中找到有关轴设置的更多信息。教程可以在 TeeChart 的程序组中找到。

# c# - c# 用于在会话状态中存储值的类生成

> ID：13406669
> 
> 赞同：1
> 
> 时间：2012-11-15T21:37:03.767
> 
> 标签：c#, .net, t4

我想要的是一个类（或一个列表或其他什么），我可以在其中说：

```
String ClientName;
String DealerID; 
```

它会为我生成代码

```
public static string ClientName
{
    get
    {
        object obj = HttpContext.Current.Session["clientName"];

        if (obj != null)
        {
            return (string)obj;
        }

        return null;
    }

    set
    {
        HttpContext.Current.Session["clientName"] = value;
    }
} 
```

一种方法可能是使用反射，但我不知道如何。
另一种解决方案可能是使用类型化的数据集，但我也不知道如何。
另一种方法可能是使用 T4 模板，但我不知道如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:27:27.807

您可以创建[代码片段](http://msdn.microsoft.com/en-us/library/ms165394.aspx)。将此代码保存到文件`propsession.snippet`并将文件放入目录`%USERPROFILE%\Documents\Visual Studio 2012\Code Snippets\Visual Basic\My Code Snippets`

```
<?xml version="1.0" encoding="utf-8"?>
<CodeSnippets xmlns="http://schemas.microsoft.com/VisualStudio/2005/CodeSnippet">
  <CodeSnippet Format="1.0.0">
    <Header>
      <SnippetTypes>
        <SnippetType>Expansion</SnippetType>
      </SnippetTypes>
      <Title>propsession</Title>
      <Author>Lazy</Author>
      <Description>Code snippet for creating property stored in session</Description>
      <HelpUrl></HelpUrl>
      <Shortcut>propsession</Shortcut>
    </Header>
    <Snippet>
      <Declarations>
        <Literal Editable="true">
          <ID>type</ID>
          <ToolTip>Property type</ToolTip>
          <Default>string</Default>
          <Function>
          </Function>
        </Literal>
        <Literal Editable="true">
          <ID>Name</ID>
          <ToolTip>Property name</ToolTip>
          <Default>Name</Default>
          <Function>
          </Function>
        </Literal>
        <Literal Editable="true">
          <ID>key</ID>
          <ToolTip>Key</ToolTip>
          <Default>key</Default>
          <Function>
          </Function>
        </Literal>
      </Declarations>
      <Code Language="csharp"><![CDATA[public static $type$ $Name$
{
    get
    {
        object obj = HttpContext.Current.Session["$key$"];

        if (obj != null)        
            return ($type$)obj;        

        return null;
    }

    set { HttpContext.Current.Session["$key$"] = value;  }
}]]></Code>
    </Snippet>
  </CodeSnippet>
</CodeSnippets> 
```

开始`propsession`在 Visual Studio 中输入，然后选择此代码段。它将插入用于在会话中存储属性值的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T09:47:58.990

T4 样品：

```
<#
    // Here is the model
    Model = new []
        {
            P ("string", "ClientName"),
            P ("string", "DealerID"),
        };
#>

<#
    // Here is the "view", this can be extracted into a ttinclude file and reused
#>
namespace MyNameSpace
{
    using System.Web;

    partial class SessionState
    {
<#
    foreach (var propertyDefinition in Model)
    {
#>
        public static <#=propertyDefinition.Type#> <#=propertyDefinition.Name#>
        {
            get
            {
                object obj = HttpContext.Current.Session["<#=propertyDefinition.SessionName#>"];

                if (obj != null)
                {
                    return (<#=propertyDefinition.Type#>)obj;
                }

                return null;
            }

            set
            {
                HttpContext.Current.Session["<#=propertyDefinition.SessionName#>"] = value;
            }
        }    
<#
    }
#>
    }
}
<#+

    PropertyDefinition[] Model = new PropertyDefinition[0];

    class PropertyDefinition
    {
        public string Type;
        public string Name;

        public string SessionName
        {
            get
            {
                var name = Name ?? "";
                if (name.Length == 0)
                {
                    return name;
                }

                return char.ToLower(name[0]) + name.Substring(1);

            }
        }
    }

    static PropertyDefinition P (string type, string name)
    {
        return new PropertyDefinition
        {
            Type = type ?? "<NoType>",
            Name = name ?? "<NoName>",
        };
    }

#> 
```

它生成以下代码：

```
namespace MyNameSpace
{
    using System.Web;

    partial class SessionState
    {
            public static string ClientName
        {
            get
            {
                object obj = HttpContext.Current.Session["clientName"];

                if (obj != null)
                {
                    return (string)obj;
                }

                return null;
            }

            set
            {
                HttpContext.Current.Session["clientName"] = value;
            }
        }    
            public static string DealerID
        {
            get
            {
                object obj = HttpContext.Current.Session["dealerID"];

                if (obj != null)
                {
                    return (string)obj;
                }

                return null;
            }

            set
            {
                HttpContext.Current.Session["dealerID"] = value;
            }
        }    
        }
} 
```

如果您提取“视图”，模型文件将如下所示：

```
<#
    // Here is the model
    Model = new []
        {
            P ("string", "ClientName"),
            P ("string", "DealerID"),
        };
#>

<#@ include file="$(SolutionDir)\GenerateSessionState.ttinclude"#> 
```

*关于 CodeSnippets 与 T4*

有时认为 CodeSnippets（和 Resharper 代码模板）等同于 T4。他们不是。

CodeSnippets（和其他）促进了代码冗余，基本上是带有额外工具支持的 CopyPaste 编程。

T4（或 CodeSmith）是元编程工具，可帮助您减少您维护的代码中的代码冗余（它们可能会生成冗余代码，但您不需要维护该代码）。

围绕 CodeSnippets 的思想实验；您已经广泛使用了一个片段，但您意识到它生成的代码存在问题。

你如何解决它？您必须找到所有使用代码段的实例并调整代码但遇到问题；您如何找到所有实例？当有人修改片段代码时，您如何合并更改？

使用 T4 或 CodeSmith 等元编程工具，您可以修复模板并重新生成代码。

这就是为什么每次有人提到代码片段时我都会在内心深处死去。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T15:31:34.223

我为 CodeSmith Tools 工作，您可以使用[CodeSmith Generator](http://www.codesmithtools.com/product/generator)轻松完成这项工作。我们有一个名为[ActiveSnippets](http://docs.codesmithtools.com/display/Generator/Using+ActiveSnippets)的功能。您可以通过注册模板来创建新的 ActiveSnippet。我花了大约 30 秒来创建完成此任务的以下模板：

```
<%@ Template Language="C#" TargetLanguage="C#" Description="http://stackoverflow.com/questions/13406669/c-sharp-class-generation-for-storing-values-in-the-session-state" %>
<%@ Property Name="PropertyName" Default="SomeValue" Type="System.String" %>
<%@ Property Name="SystemType" Default="string" Type="System.String" %>

public static <%= SystemType %> <%= PropertyName %>
{
    get
    {
        object obj = HttpContext.Current.Session["<%= PropertyName %>"];
        if (obj != null)
        {
            return (string)obj;
        }

        return null;
    }

    set
    {
        HttpContext.Current.Session["<%= PropertyName %>"] = value;
    }
} 
```

要使用 ActiveSnippet，您需要使用上面的内容创建一个新模板，并按照上面链接中的步骤注册 ActiveSnippet（EG，MySnippetName）。然后只需在 Visual Studio 的代码文档内的新行中输入 MySnippetName ClientName String，然后按两次 control+e 即可执行代码段。生成的代码将输出到您键入 MySnippetName ClientName String 的文档窗口，

如果您有任何问题，请告诉我们！

PS，您会发现我们拥有比 T4 更好的模板语法/API、集成故事和模板编辑器（他们从我们这里偷了一堆 :)。此外，与片段不同，生成器模板可以从任何元数据（数据库/xml ......）呈现任何基于文本的内容，并使用任何 .NET API，包括第三方库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T21:47:39.800

MS 有一个关于如何使用 T4 模板的视频：http: [//msdn.microsoft.com/en-us/vstudio/cc308634.aspx](http://msdn.microsoft.com/en-us/vstudio/cc308634.aspx)

# ruby - 我的 rakefile 做错了什么？

> ID：13406678
> 
> 赞同：4
> 
> 时间：2012-11-15T21:38:06.710
> 
> 标签：ruby, rake, testunit

这是我的 rakefile 中唯一的内容。

```
Rake::TestTask.new do |t|
  t.libs << "test"
  t.test_files = FileList['test/test*.rb']
  t.verbose = true
end 
```

当我运行 rake 时，我得到的输出是

```
uninitialized constant Rake::TestTask 
```

我究竟做错了什么？我希望我的 rake 文件运行我指定的所有单元测试。任何输入都会有所帮助。谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-15T21:41:45.320

如果你`require 'rake/testtask'`在文件的顶部会发生什么？

# java - 随机读取数组

> ID：13406679
> 
> 赞同：0
> 
> 时间：2012-11-15T21:38:43.463
> 
> 标签：java

我有一个程序，我不会随机读取 ARRAY 我没有程序错误但是在输出期间我有空值你能给我解决方案吗？

```
import java.io.FileInputStream;
import java.util.Properties;
import java.util.Random;
import javax.swing.JOptionPane;

public class ReadDB {
    public static void main(String[] args) {

        Properties prob = new Properties();
        String word [] = new String [20] ;
        try{
            prob.load( new FileInputStream("words.txt"));
        }catch(Exception e){
        }
        for(int i=1; i<6; i++){         
            String temp = prob.getProperty(""+i);
            word[i] = temp;
            Random ran = new Random ();

            String Val = word[ran.nextInt(word.length)];

            System.out.println(Val);

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T21:40:51.810

您的数组长度为 20，您只填充 5 个值`for(int i=1; i<6; i++){`：这解释了空值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T21:43:57.280

1.  您的数组大小为 20，但您的循环只有 5 次迭代。
2.  您的循环从错误的索引开始（部分相关）
3.  `word`在实际完成填充数据之前，您正在对数组进行随机轮询：

将其更改为：

```
for(int i=1; i<6; i++){         
    String temp = prob.getProperty(""+i);
    word[i] = temp;
    Random ran = new Random ();
    String Val = word[ran.nextInt(word.length)];
    System.out.println(Val);
} 
```

至：

```
for(int i=0; i<20; i++){         
    String temp = prob.getProperty(""+i);
    word[i] = temp;
}

for(int i=0; i<20; i++){
    Random ran = new Random ();
    String Val = word[ran.nextInt(word.length)];
    System.out.println(Val);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T21:43:08.203

您的输出可能为 null，因为`prob.getProperty`为随机选择的索引的键返回 null，但更可能的问题是随机生成的索引超出了正在填充的 5 个值的范围。

两个建议：

1.  永远不要忽略异常。最有可能的`prob`是由于异常而无法加载。相反，打印异常：`e.printStackTrace()`.

2.  确保加载的预期属性实际上具有填充`words`数组时假设存在的键 1-5。

# android - 如何更改 ListView 项目的背景颜色？

> ID：13406680
> 
> 赞同：1
> 
> 时间：2012-11-15T21:38:58.647
> 
> 标签：android

有以下方法：

```
 @Override
    public void mark() {
        ImageView image=(ImageView)view.findViewById(R.id.listItemRepeatingTypeImage);
        image.setBackgroundColor(Color.RED);
        image.invalidate();
        Log.e("event", "mark");
        view.setBackgroundColor(Color.GREEN);
        view.invalidate();
    } 
```

如您所见，我尝试更改 View 和 ImageView 的背景颜色（视图是 ListView 的一项）。这个事件变成了，但是没有新的背景。我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:09:25.423

尝试将此样式应用于您的 ListView：

```
<style name="List">
    <item name="android:layout_width">fill_parent</item>
    <item name="android:layout_height">fill_parent</item>
    <item name="android:background">#FFFFFF</item>
    <item name="android:dividerHeight">1dp</item>
    <item name="android:divider">#CCCCCC</item>
    <item name="android:cacheColorHint">#FFFFFF</item>
    <item name="android:listSelector">#00000000</item>
</style> 
```

在你的 xml 布局中：

```
<ListView 
    android:id="@+id/listView"
    style="@style/List"
    android:paddingTop="1dp"/> 
```

# python - 如何将用户输入的命令作为海龟命令执行？

> ID：13406683
> 
> 赞同：0
> 
> 时间：2012-11-15T21:39:19.773
> 
> 标签：python, input, command, turtle-graphics

我需要能够向用户询问乌龟命令，例如 forward(90) 并将其作为乌龟命令执行，例如 turtle.forward(90) 并重复直到用户退出。到目前为止，我有：

```
def turtle_input(prompt):
"""Loop to ask for user input and execute as a turtle command"""
import turtle
while True:
    t = input('Enter a turtle command: ')
    if t in ['Quit' , 'quit', 'q', 'Q']:
        break
    turtle.(t)     
return prompt 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:41:15.977

执行任意代码通常不是一个好主意，因为它是一个巨大的安全漏洞，但这里有一种方法：

```
eval('turtle.{0}'.format(t)) 
```

这不是一个好主意，因为考虑用户可以传入的以下字符串：

```
t = 'forward(90) or __import__("os").system("rm -rf ~")' 
```

突然之间，您的主目录开始被删除——哎呀。

* * *

一个稍微不那么健壮但更安全的解决方案可能是自己使用`ast.literal_eval`和解析字符串：

```
import ast

#...
funcname,args = t.split('(',1)
args = ast_literal_eval('('+args)
if hasattr(args,'__iter__'):
    getattr(turtle,funcname)(*args)
else:
    getattr(turtle,funcname)(args) 
```

# java - 服务器请求时如何显示html页面？

> ID：13406684
> 
> 赞同：0
> 
> 时间：2012-11-15T21:39:19.253
> 
> 标签：java, html, httpurlconnection

我在显示 html 页面表单 localhost 时遇到问题。这是我的方法，但我只是进入`System.out.println("IN !")`循环（eclipse 控制台）。当我`http://localhost:1600/myWebPage.html`在浏览器中输入地址时，什么也没发生。我想知道如何在键入后在浏览器中显示网页或仅显示一些文本`http://localhost:1600/myWebPage.html`。这条路正确吗？

```
public class ServerWWW {

    //localhost:1600/

    public static void main(String[] args) {

        int portServerWww = 1600;
        ServerSocket ss = null;

        try {
            ss = new ServerSocket(portServerWww);
            System.out.println("Server WWW waiting .....");

            while(true) {
                Socket s = ss.accept(); // block
                new ServiceWWW (s).start();
            }
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            if (ss != null) {
                try {
                    ss.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }
    }
}

class ServiceWWW extends Thread {

        private Socket s = null;
        private int counter;

        public ObslugaWWW(Socket s) {
            this.s = s;
        }

     public void run(){
        try {

           System.out.println("IN !"); //Loop
           URL url = new URL("http://localhost:1600/myWebPage.html");
           HttpURLConnection yc = (HttpURLConnection)url.openConnection();
           yc.setRequestMethod("GET");
           yc.setDoOutput(true);
           yc.connect();

           BufferedReader rd  = new BufferedReader(new InputStreamReader(yc.getInputStream()));
           StringBuilder sb = new StringBuilder();
           String line = "OK";

           while ((line = rd.readLine()) != null){
              sb.append(line + '\n');
           }

           System.out.println(sb.toString());

           yc.disconnect();

           } catch (MalformedURLException e) {
              e.printStackTrace();
           } catch (IOException e) {
           // TODO Auto-generated catch block
              e.printStackTrace();
           }

        }
} 
```

# php - jQuery AJAX 调用 PHP 控制器

> ID：13406690
> 
> 赞同：3
> 
> 时间：2012-11-15T21:39:33.763
> 
> 标签：php, jquery, html, ajax, codeigniter

我通过 jQuery 调用控制器（Codeigniter）。我的 dataString 变量包含一个简单的字符串，我试图将其传递给我的控制器，因此我可以将它传递给模型。但是，我收到一个错误，表明我的 $test_var 未定义。我究竟做错了什么？

```
$('a.test').click(function (event) {

    dataString = $(this).attr('name'); 
        $.ajax({
        type:"POST",
        url:"<?php echo base_url(); ?>controller_name/",
        data:dataString,
        success:function (data) {
        alert('test');
        }

    });
    event.preventDefault();
}); 
```

**控制器**

* * *

> $test_var= $this->input->post('dataString');

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:41:18.633

尝试使用名称=值对：

```
$('a.test').click(function (event) {

    dataString = $(this).attr('name'); 
        $.ajax({
        type:"POST",
        url:"<?php echo base_url(); ?>controller_name/",
        data:'dataString='+dataString,
        success:function (data) {
        alert('test');
        }

    });
    event.preventDefault();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T08:42:24.407

你也可以做这样的事情，这是一种替代语法

```
$('a.test').click(function (event) {
    dataString = $(this).attr('name'); 
    $.ajax({
        type:"POST",
        url:"<?php echo base_url(); ?>controller_name/",
        data:{'dataString':dataString},
        success:function (data) {
        alert('test');
        }
    });
    event.preventDefault();
}); 
```

在你的控制器中`$test_var= $this->input->post('dataString');`

或者就像在香草 php 中一样

```
$test_var = $_POST['dataString']; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-24T19:22:11.283

使用像这样的数据数据选项：{名称：“约翰”，位置：“波士顿”}更多细节请检查[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# wpf - 从 ListBoxItems 中删除控件突出显示，但不删除子控件

> ID：13406697
> 
> 赞同：0
> 
> 时间：2012-11-15T21:39:57.947
> 
> 标签：wpf, xaml, styles

我正在使用 ListBox 来显示项目列表：PictureOrders。我为 ListBox 的项目应用了 DataTemplate。

我想设置列表框的样式，以便当鼠标悬停在列表框中的任何项目上时不会突出显示这些项目，并且列表框中的选定项目也不会突出显示。

因此，我在 ListBox 的资源中使用了以下内容：

```
 <ListBox.Resources>
            <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Transparent"  />
            <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="Transparent" />
   </ListBox.Resources> 
```

但是，现在 ListBox 中的 ComboBoxes 不再具有突出显示的颜色，这会带来一些问题。

我有以下课程：

```
Public Class PictureOrder
   Public Property OrderName As String
   Public Property NumberOfPictures As Integer
   Public Property QualityOfPictures As Integer
   Public Property Comments As String
End Class

Public Class PictureOrders
   Public Property PictureOrders As ObjectModel.ObservableCollection(Of PictureOrder)

   Public Sub New()
    PictureOrders = New ObjectModel.ObservableCollection(Of PictureOrder)
    For i As Integer = 1 To 11 '
        Dim picOrder As New PictureOrder With {.OrderName = String.Format("Picture Order # {0}", i.ToString),
                                               .NumberOfPictures = 50,
                                               .QualityOfPictures = 10,
                                               .Comments = String.Format("Picture Order # {0} Comments", i.ToString)}
        PictureOrders.Add(picOrder)
    Next
   End Sub
End Class 
```

这是我当前的 XAML：

```
<Window x:Class="Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Picture Orders" Height="600" Width="600"
xmlns:myProj="clr-namespace:TryingWPF">
<Window.Resources>
    <x:Array x:Key="NumberOfPicturesOptions" Type="sys:Int32"
             xmlns:sys="clr-namespace:System;assembly=mscorlib">
        <sys:Int32>10</sys:Int32>
        <sys:Int32>15</sys:Int32>
        <sys:Int32>20</sys:Int32>
        <sys:Int32>25</sys:Int32>
        <sys:Int32>50</sys:Int32>
        <sys:Int32>100</sys:Int32>
        <sys:Int32>150</sys:Int32>
    </x:Array>
    <x:Array x:Key="QualityOfPicturesOptions" Type="sys:Int32"
              xmlns:sys="clr-namespace:System;assembly=mscorlib">
        <sys:Int32>5</sys:Int32>
        <sys:Int32>6</sys:Int32>
        <sys:Int32>7</sys:Int32>
        <sys:Int32>8</sys:Int32>
        <sys:Int32>9</sys:Int32>
        <sys:Int32>10</sys:Int32>
    </x:Array>
    <myProj:PictureOrders x:Key="Orders" />
</Window.Resources>
<ListBox x:Name="OrderListings" DataContext="{StaticResource Orders}" ItemsSource="{Binding PictureOrders}"  SelectedIndex="0">
    <ListBox.Resources>
        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Transparent"  />
        <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="Transparent" />
    </ListBox.Resources>
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Expander x:Name="PhotoOrderExpander"
                      Content="{Binding}" 
                      Header="{Binding OrderName}"
                      IsExpanded="{Binding Path=IsSelected, RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}}">
                <Expander.ContentTemplate>
                    <DataTemplate>
                        <DockPanel Margin="25,5">
                            <DockPanel DockPanel.Dock="Top">
                                <Label VerticalAlignment="Top" Content="Order Name" />
                                <TextBox Text="{Binding OrderName, ValidatesOnExceptions=True}" VerticalAlignment="Top" MaxLength="50"/>
                            </DockPanel>
                            <DockPanel DockPanel.Dock="Top">
                                <Label Content="NumberOfPictures" />
                                <ComboBox ItemsSource="{Binding Source={StaticResource NumberOfPicturesOptions}}" 
                                          SelectedItem="{Binding Path=NumberOfPictures, ValidatesOnExceptions=True}" />
                            </DockPanel>
                            <DockPanel DockPanel.Dock="Top">
                                <Label Content="Quality Of Pictures" />
                                <ComboBox ItemsSource="{StaticResource QualityOfPicturesOptions}" 
                                          SelectedItem="{Binding Path=QualityOfPictures, ValidatesOnExceptions=True}" />
                            </DockPanel>
                            <DockPanel DockPanel.Dock="Top">
                                <Label Content="Comments" />
                                <TextBox Text="{Binding Comments}" />
                            </DockPanel>
                        </DockPanel>
                    </DataTemplate>
                </Expander.ContentTemplate>
            </Expander>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T22:18:09.590

您可以将`SolidColorBrush`资源设置为仅针对`ListBoxItem`.

由于`ComboBoxItem`继承自`ListBoxItem`，ComboBox 仍然会受到影响，因此还需要创建一个样式`ComboBoxItem`来应用默认颜色。

```
<ListBox.Resources>
    <Style TargetType="ListBoxItem">
        <Style.Resources>
            <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="Transparent" />
            <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Transparent" />
        </Style.Resources>
    </Style>

    <Style TargetType="ComboBoxItem">
        <Style.Resources>
            <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="{x:Static SystemColors.HighlightColor}"/>
             <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="{x:Static SystemColors.ControlColor}"/>
        </Style.Resources>
    </Style>
</ListBox.Resources> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T19:48:06.857

经过多次不同的尝试来解决这个问题，我终于找到了一个可行的解决方案。

我为 ListBoxItem 创建了一个样式，它设置了 TemplateControl 并为 MouseOver、Selected 和 UnSelected 状态设置了 VisualStates。

这是该问题的 XAML 代码解决方案：

```
 <Window.Resources>

    <Style TargetType="ListBoxItem" x:Key="ListBoxWithNoSelection">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ListBoxItem">
                    <Border x:Name="LayoutRoot" 
                        BorderBrush="{TemplateBinding BorderBrush}" 
                        BorderThickness="{TemplateBinding BorderThickness}" 
                        Background="{TemplateBinding Background}" 
                        HorizontalAlignment="{TemplateBinding HorizontalAlignment}" 
                        VerticalAlignment="{TemplateBinding VerticalAlignment}">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal" />
                                <VisualState x:Name="MouseOver" />
                                <VisualState x:Name="Disabled" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="SelectionStates">
                                <VisualState x:Name="Unselected" />
                                <VisualState x:Name="Selected" />
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>

                        <ContentControl x:Name="ContentContainer"
                                        ContentTemplate="{TemplateBinding ContentTemplate}" 
                                        Content="{TemplateBinding Content}" Foreground="{TemplateBinding Foreground}" 
                                        HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                        Margin="{TemplateBinding Padding}" 
                                        VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"/>

                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <x:Array x:Key="NumberOfPicturesOptions" Type="sys:Int32"
             xmlns:sys="clr-namespace:System;assembly=mscorlib">
        <sys:Int32>10</sys:Int32>
        <sys:Int32>15</sys:Int32>
        <sys:Int32>20</sys:Int32>
        <sys:Int32>25</sys:Int32>
        <sys:Int32>50</sys:Int32>
        <sys:Int32>100</sys:Int32>
        <sys:Int32>150</sys:Int32>
    </x:Array>
    <x:Array x:Key="QualityOfPicturesOptions" Type="sys:Int32"
              xmlns:sys="clr-namespace:System;assembly=mscorlib">
        <sys:Int32>5</sys:Int32>
        <sys:Int32>6</sys:Int32>
        <sys:Int32>7</sys:Int32>
        <sys:Int32>8</sys:Int32>
        <sys:Int32>9</sys:Int32>
        <sys:Int32>10</sys:Int32>
    </x:Array>
    <myProj:PictureOrders x:Key="Orders" />
</Window.Resources>

<ListBox x:Name="OrderListings" DataContext="{StaticResource Orders}" 
         ItemsSource="{Binding PictureOrders}"  
         SelectedIndex="0"
         ItemContainerStyle="{StaticResource ListBoxWithNoSelection}">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Expander x:Name="PhotoOrderExpander"
                      Content="{Binding}" 
                      Header="{Binding OrderName}"
                      IsExpanded="{Binding Path=IsSelected, RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}}">
                <Expander.ContentTemplate>
                    <DataTemplate>
                        <DockPanel Margin="25,5">
                            <DockPanel DockPanel.Dock="Top">
                                <Label VerticalAlignment="Top" Content="Order Name" />
                                <TextBox Text="{Binding OrderName, ValidatesOnExceptions=True}" VerticalAlignment="Top" MaxLength="50"/>
                            </DockPanel>
                            <DockPanel DockPanel.Dock="Top">
                                <Label Content="NumberOfPictures" />
                                <ComboBox ItemsSource="{Binding Source={StaticResource NumberOfPicturesOptions}}" 
                                          SelectedItem="{Binding Path=NumberOfPictures, ValidatesOnExceptions=True}" />
                            </DockPanel>
                            <DockPanel DockPanel.Dock="Top">
                                <Label Content="Quality Of Pictures" />
                                <ComboBox ItemsSource="{StaticResource QualityOfPicturesOptions}" 
                                          SelectedItem="{Binding Path=QualityOfPictures, ValidatesOnExceptions=True}" />
                            </DockPanel>
                            <DockPanel DockPanel.Dock="Top">
                                <Label Content="Comments" />
                                <TextBox Text="{Binding Comments}" />
                            </DockPanel>
                        </DockPanel>
                    </DataTemplate>
                </Expander.ContentTemplate>
            </Expander>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

-弗林尼

# objective-c - 一个 .h 文件的目标 C - 2 .m 文件？

> ID：13406699
> 
> 赞同：2
> 
> 时间：2012-11-15T21:40:13.110
> 
> 标签：objective-c, file, header

我的问题是，我会知道如何将 2 个 .m 文件用于一个对象类，也用于一个标头（.h）

我有一个包含 20000 多行的大方法，并且我愿意，该方法在 .m 文件中独立，而其他方法在另一个 .m 文件中独立。我已经完成了，但我得到了错误，这些方法不在一个 .m 文件中。我收到链接错误，但如果我删除第二个 .m 文件，我可以删除链接错误。

是否可以为一个标题创建 2 个 .m 文件？

如果是，请告诉我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:50:39.973

> 我有一个 20000+ 行的大方法

好吧，这就是你的问题。这就是你需要解决的问题。将事情分成两个实现文件会分散注意力。这是你的主要问题。几乎没有任何情况下这不是一种糟糕的做事方式。

方法最多应该有几十行。如果您发现自己编写的方法比这更长，则需要将功能分解成更小的部分。创建较小的方法来完成部分工作，然后从原始方法中调用这些方法。

类不应该是这个大小。如果您正在创建一个包含超过几千行代码的文件，那么这是一个巨大的警告信号，表明一个类负责过多的功能。您应该将功能分解为几个类，每个类负责一个关键功能。

> 我收到链接错误

如果你将这样的句子发布到 Stack Overflow，它应该伴随着你得到的实际错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:49:00.167

您可以使过长的方法成为该类的类别：

MyClass.h：

```
@interface MyClass
@property ...
-(void) method;
...
@end

@interface MyClass (BigMethod)
-(void) bigMethod;
@end 
```

我的班级.m：

```
@implementation MyClass
-(void) method
{
    ...
}
...
@end 
```

大方法.m

```
@implementation MyClass (BigMethod)
-(void) bigMethod
{
    ...
}
@end 
```

但是，20k 行方法是荒谬的。你真的应该重构它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T21:46:53.800

你有几种方法：

1.  您可以将您的方法分为 2 个不同的类别：

    ```
    //-- MyClass1.m
    @implementation MyClass (part1)

    @end

    //-- MyClass2.m
    @implementation MyClass (part2)

    @end 
    ```

    出于对称原因，我定义了 2 个类别；当然，您还需要类的“基础” `@implementation`（即，没有类别说明符）；您可以选择是否定义“基础”和`extension`类别，或“基础”和两个类别等...

2.  或者您可以尝试在第一个文件中包含第二个`.m`文件：

    ```
     //-- MyClass1.m
        @implementation MyClass

        <first part>

        #include "MyClass2.m"

        @end 
    ```

两者都应该工作。

更不用说重构你的类的可能性了，这将是最好的选择。

# python - 使用 Django 和 Tastypie 在 POST 请求后发送电子邮件

> ID：13406706
> 
> 赞同：0
> 
> 时间：2012-11-15T21:40:43.993
> 
> 标签：python, django, tastypie

我正在使用 Tastypie 为 Django 项目创建 API。我想做的是在 POST 请求后向凭证资源发送电子邮件（创建新凭证）。有谁知道这个问题的最佳解决方案是什么？

我不确定如何拦截请求并处理它。想到的一个解决方案是覆盖模型的构造函数并在创建实例时发送电子邮件！我不知道这是否是个好主意。

这个问题的答案似乎是一个可能的解决方案：[Adding to the "constructor" of a django model](https://stackoverflow.com/questions/9415616/adding-to-the-constructor-of-a-django-model)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:25:59.257

在 Django 信号中使用 post_save。[https://docs.djangoproject.com/en/dev/topics/signals/](https://docs.djangoproject.com/en/dev/topics/signals/)

您可以检查**created**参数以了解是否需要发送电子邮件。

# android - 如何以编程方式确定 TextView 中文本的颜色？

> ID：13406707
> 
> 赞同：2
> 
> 时间：2012-11-15T21:40:44.070
> 
> 标签：android, textview

基本上作为标题中的问题。如何检查 TextView 中文本的实际颜色是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:46:06.180

你可以简单地使用

```
mTextView.getCurrentTextColor(); 
```

有关更多信息，请参阅[Android 开发人员指南](http://developer.android.com/reference/android/widget/TextView.html#getCurrentTextColor%28%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:46:01.750

您可以使用

getResources().getColor(R.color.idname);

检查此链接以获取更多信息：

[http://sree.cc/google/android/defining-custom-colors-using-xml-in-android](http://sree.cc/google/android/defining-custom-colors-using-xml-in-android)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T21:46:53.357

```
textView.getCurrentTextColor(); 
```

# core-data - 核心数据 - 与对象（一个）和 UIImages（很多）的一对多关系，存储和获取

> ID：13406710
> 
> 赞同：0
> 
> 时间：2012-11-15T21:40:53.150
> 
> 标签：core-data, uiimage, one-to-many, fetch, nsmanagedobject

我的目标是构建一个应用程序，其对象为： - 请求（包含唯一 ID、客户姓名、电话、电子邮件、请求信息的简要摘要、图像列表（存储在 NSMutable 数组中）

我的核心数据包含：

*   要求
*   图片

![请求对象](../Images/0b2871fd6397082a8038e03a80d77bda.png) ![图像对象](../Images/ffd549dc8db7e49a67cf0d014b4e8958.png)

对于我的请求对象，我有：

```
#import <Foundation/Foundation.h>

@interface BAPRequest : NSObject
@property (nonatomic, retain) NSString *requestID;
@property (nonatomic, retain) NSString *name;
@property (nonatomic, retain) NSString *email;
@property (nonatomic, retain) NSString *phone;
@property (nonatomic, retain) NSString *detail;
@property (nonatomic, retain) NSMutableArray *images;
@property (nonatomic, retain) NSDate *requestDate;
@property (nonatomic) BOOL isSent;

- (void)fetchImages;
@end 
```

和 .m 文件：

```
#import "BAPAppDelegate.h"
#import "BAPRequest.h"

@implementation BAPRequest
@synthesize name, email, phone, detail;
@synthesize images;
@synthesize requestDate;
@synthesize isSent;
@synthesize requestID;

- (id)init{
  self = [super init];
  if(self != nil){
    self.isSent = false;
    self.requestID = [[NSProcessInfo processInfo] globallyUniqueString];
    self.images = [[NSMutableArray alloc] init];
  }
  return self;
}

- (void)fetchImages{
  //get delegation
  BAPAppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];

  NSManagedObjectContext *context = [appDelegate managedObjectContext];

  NSError *error;

  //init request
  NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];

  //load the entity description
  NSEntityDescription *entityDescription = [NSEntityDescription entityForName:@"Image"
                                                       inManagedObjectContext:context];
  //set the request query
  [fetchRequest setEntity:entityDescription];

  //set predicate to request to ask select specific entity with the matching line num
  NSPredicate *pred = [NSPredicate predicateWithFormat:@"(requestId == %@)", self.requestID];
  [fetchRequest setPredicate:pred];

  //exec the command to find the object(table) from core database
  NSArray * imageList = [context executeFetchRequest:fetchRequest error:&error];
  for (NSManagedObject *imageObject in imageList){
    [self.images addObject: [UIImage imageWithData:[imageObject valueForKey:@"content"]]];
  }

}
@end 
```

为了获取所有请求，我也这样做：

```
- (void)removeRequest:(BAPRequest*)request{
    //get delegation
    BAPAppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];

    NSManagedObjectContext *context = [appDelegate managedObjectContext];

    NSError *error;

    //init request
    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];

    //load the entity description
    NSEntityDescription *entityDescription = [NSEntityDescription entityForName:@"Request"
                                                         inManagedObjectContext:context];
    //set the request query
    [fetchRequest setEntity:entityDescription];

    //set predicate to request to ask select specific entity with the matching line num
    NSLog(@"request id is %@", request.requestID);
    NSPredicate *pred = [NSPredicate predicateWithFormat:@"(requestId LIKE %@)", request.requestID];
    [fetchRequest setPredicate:pred];

    //exec the command to find the object(table) from core database
    NSArray *objects = [context executeFetchRequest:fetchRequest error:&error];

    //if this object doesn't exist in the database, it must be something wrong
    if (objects == nil) {
      NSLog(@"There was an error !");
      NSLog(@"Error Info: %@", error);
    }

    //if object exist in database, take the first search object, and deletes it
    if ([objects count] > 0){
      NSManagedObject *theRequest = [objects objectAtIndex:0];
      [context deleteObject:theRequest];
    }

    [context save:&error];

    /*
    //delete existing images relates to this request first
    entityDescription = [NSEntityDescription entityForName:@"Image"
                                    inManagedObjectContext:context];
    pred = [NSPredicate predicateWithFormat:@"(self.request == %@)", request];
    [fetchRequest setPredicate:pred];
    NSArray * imageList = [context executeFetchRequest:fetchRequest error:&error];
    for (NSManagedObject *removeImageObject in imageList){
      [context deleteObject:removeImageObject];
    }
     */
  }

  #pragma mark - Convert Core Data Object to Request Object

  #pragma mark - Core Data Methods
  - (NSMutableArray *)getRequests{
    //get app delegate
    BAPAppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];

    //get object context that's created for us
    NSManagedObjectContext *context = [appDelegate managedObjectContext];

    //define the entities we want load to description
    NSEntityDescription *entityDescription = [NSEntityDescription entityForName:@"Request"
                                                   inManagedObjectContext:context];

    //init request and set search query to the request
    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    [fetchRequest setEntity:entityDescription];

    NSError *error;
    //get objects(table) though request
    NSArray *objects = [context executeFetchRequest:fetchRequest error:&error];

    if (objects == nil){
      NSLog(@"There was an error !");
      //error handling there
      NSLog(@"Error Info: %@", error);
    }

    NSMutableArray *requests = [[NSMutableArray alloc] init];
    for (NSManagedObject *requestObj in objects){
      BAPRequest *request = [[BAPRequest alloc] init];
      request.requestID = [requestObj valueForKey:@"requestId"];
      request.name = [requestObj valueForKey:@"name"];
      request.email = [requestObj valueForKey:@"email"];
      request.phone = [requestObj valueForKey:@"phone"];
      request.detail = [requestObj valueForKey:@"detail"];
      request.requestDate = [requestObj valueForKey:@"requestDate"];
      request.isSent =  [[requestObj valueForKey:@"isSent"] boolValue];

      [request fetchImages];

      [requests addObject: requestObj];
    }

    return requests; //return the requests
  }

  - (void)saveRequest:(BAPRequest *)request{
    request.requestDate = [NSDate date];

    //get delegation
    BAPAppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];

    NSManagedObjectContext *context = [appDelegate managedObjectContext];

    NSError *error;

    BAPRequest  *theRequest = [NSEntityDescription insertNewObjectForEntityForName:@"Request"
                                                 inManagedObjectContext:context];

    //set the request obejct basics
    [theRequest setValue:request.requestID forKey:@"requestId"];
    [theRequest setValue:request.name forKey:@"name"];
    [theRequest setValue:request.email forKey:@"email"];
    [theRequest setValue:request.phone forKey:@"phone"];
    [theRequest setValue:request.detail forKey:@"detail"];
    [theRequest setValue:request.requestDate forKey:@"requestDate"];
    [theRequest setValue:[NSNumber numberWithBool:request.isSent ] forKey:@"isSent"];

    //also save its requests
    for (UIImage *img in request.images) {
      //init image object
      UIImage *newImage=[NSEntityDescription insertNewObjectForEntityForName:@"Image" inManagedObjectContext:context];
      [newImage setValue:request.requestID forKey:@"requestId"];
      [newImage setValue:UIImagePNGRepresentation(img) forKey:@"content"];
    }

    [context save:&error];  //save the object
  }
  @end 
```

我的问题是：

我想它根本不获取图像。即使他们在 getRequests 方法中获取图像，当我尝试将请求传递到其他地方时，它仍然会遇到很多问题：

*   布尔值未正确加载
*   图像为零（即使在获取时已加载）

原因是（我可能是错的）当我将这些请求对象（BAPRequest*）存储到 NSArray 并将其传递给表视图时，当我从数组（例如 [myArray objectAtIndex:0]）加载它们时，它们是仍然是**NSManagedObject**。我试图在核心数据实体选项中给出一个类名来制作 BAPRequest 的请求（核心数据）对象类，但它一直说我必须继承 NSManagedObject，其中子类化 NSManagedObject 是不可能的：

我不能这样做：

```
BAPRequest: NSManagedObject 
```

XCode 不喜欢它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T14:30:35.457

看看[发电机](http://rentzsch.github.com/mogenerator/)。这是一个关于如何使用它的教程：[http](http://raptureinvenice.com/getting-started-with-mogenerator/) ://raptureinvenice.com/getting-started-with-mogenerator/ 。它会为你省去很多麻烦。

# jquery - 在单击按钮之前显示 Jquery 弹出消息？

> ID：13406711
> 
> 赞同：0
> 
> 时间：2012-11-15T21:40:57.160
> 
> 标签：jquery, modal-dialog, bpopup

您好，我有[此代码](http://jsfiddle.net/uRVaf/)，但由于某种原因，在单击按钮之前会显示该消息。我不知道为什么会这样。我是新手，所以我一直在尝试不同的东西，但它不能正常工作。我也不知道如何将它定位在不同的地方。代码假设是这样的

```
$('element_to_pop_up').bPopup({
            follow: [false, false], //x, y
            position: [150, 400] //x, y
        }); 
```

但是当我把它放在那里时，它根本不起作用。

* * *

HTML：

```
<button id="my-button">POP IT UP</button>
<!-- Element to pop up -->
<div id="element_to_pop_up">
  <div id="popup" style="left: 424.5px; position: fixed; top: 133.5px; z-index: 9999; display: block;">
        <span class="button bClose"><span>X</span></span>
        If you can't get it up use<br>
        <span>bPopup</span>
    </div>
</div> 
```

CSS：

```
#popup {

    background-color: white;
    border-radius: 10px 10px 10px 10px;
    box-shadow: 0 0 25px 5px #999;
    color: #111;
    display: none;
    min-width: 450px;
    padding: 25px;

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:43:06.987

嗯，你在内`display: block;`联 css 中有：

```
 <div id="popup" 
 style="left: 424.5px; position: fixed; top: 133.5px; z-index: 9999; **display: block**;"> 
```

这会覆盖样式表中的样式，给您带来麻烦。您只想删除它：

```
<div id="popup" 
 style="left: 424.5px; position: fixed; top: 133.5px; z-index: 9999;"> 
```

* * *

### 解释：

您在弹出窗口属性`display: block;`上的 css 内部。`style`

你需要**删除**它，然后`display: none`你真正的 CSS 将在它应该出现的地方启动。

演示：http: [//jsfiddle.net/uRVaf/4/](http://jsfiddle.net/uRVaf/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:52:27.070

你可以使用类似`onclick`或的东西`onsubmit`；

```
<input type="button" name="button" value = "submit" onclick="POPup()"  /> 
```

你的javascript代码会喜欢

```
<script type="text/javascript">

function POPup(){
//.... your pop up code goes here
}
</script> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-15T21:48:26.107

将此添加到您的CSS

```
#element_to_pop_up {display:none;} 
```

这是小提琴

[**小提琴**](http://jsfiddle.net/videsignz/QTXZE/)

# c# - 在不同线程上更新 UI 的正确方法

> ID：13406730
> 
> 赞同：6
> 
> 时间：2012-11-15T21:42:10.340
> 
> 标签：c#, winforms, user-interface, asynchronous

所以我有一个简单的类来更新我的标签，它可以被不同的线程访问并报告我的应用程序的进度。它工作正常，但是在关闭此应用程序时，此代码总是会引发有关尝试访问已处置的内容的错误。

```
private delegate void SetLabelTextDelegate(string str1, string str2);
public void SetLabelText(string str1, string str2)
{
    if (this.label1.InvokeRequired || this.label2.InvokeRequired)
    {
        this.Invoke(new SetLabelTextDelegate(SetLabelText), new object[] { str1, str2});
        return;
    }
    this.label1.Text = (str1 == string.Empty) ? this.label1.Text : str1;
    this.label2.Text = (str2 == string.Empty) ? this.label2.Text : str2;
} 
```

这不是解决这个问题的正确方法吗？是否需要添加一些内容以确保它在应用程序关闭时不会尝试在 UI 上执行更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:55:39.583

您收到的 ObjectDisposedException 很可能是由于在调用（在队列中）尚未完成时让表单关闭。您要么需要允许 Invokes 在允许表单关闭之前完成，要么必须处理 ObjectDisposedException。

看：

*   [ObjectDisposedException 调用 Form 的 Invoke 时，它​​尚未被处置](https://stackoverflow.com/questions/12428764/objectdisposedexception-on-call-to-forms-invoke-when-it-hasnt-been-disposed)

# linq - MVC LINQ 查询以使用一对多和多对一表填充模型

> ID：13406733
> 
> 赞同：0
> 
> 时间：2012-11-15T21:42:21.173
> 
> 标签：linq, asp.net-mvc-4, entity-framework-5

给定域表结构，我试图让我的模型填充。

我有一个存储供应商的主表，每个供应商都可以从主类别查找表中选择一对多的类别。供应商选择存储在另一个表中，该表仅存储 VendorID 和 CategoryID 以在它们之间进行链接。

我可以编写查询（如下）以包含类别表，但我只能显示 categoryID 而不是类别名称。

```
 public VendorProfile GetVendor(String id)
    {
        Guid pid = Guid.Parse(id);
        var view = _db.VendorProfiles.Include("VendorCategories").Single(v => v.ProfileID == pid);
        return view;
    } 
```

我试图在查询中包含查找表（如下），但这会产生运行时错误。

```
 public VendorProfile GetVendor(String id)
    {
        Guid pid = Guid.Parse(id);
        var view = _db.VendorProfiles.Include("VendorCategories").Include("ProductServiceCategory").Single(v => v.ProfileID == pid);
        return view;
    } 
```

指定的包含路径无效。EntityType 'VendorProfilesIntranet.VendorProfile' 没有声明名为 'ProductServiceCategory' 的导航属性。

Category 表确实具有导航属性。我不知道如何将相同的导航属性添加到主表，因为它没有任何 FK 到查找表。

更新：

@Gert 这个符号确实有效！

```
_db.VendorProfiles.Include("VendorCategories.ProductServiceCategory").Single(v => v.ProfileID == pid); 
```

但是，我现在显示的只是选择的类别项目。我希望获得完整的类别列表并检查已选择的类别。我正在使用滚动复选框列表。

```
 <div class="scroll_checkboxes">
        <ul>
        @foreach (var c in Model.VendorCategories)
        {
           <li>
               <input type="checkbox" name="categories" value="@c.ID" /> @c.ProductServiceCategory.CategoryName
           </li>
        }
        </ul>
        @Html.ValidationMessage("Please check at least one Product/Service category")
    </div> 
```

更新2：

可能有更好的解决方案，但对于任何陷入类似情况的人来说，这行得通

```
 <div class="scroll_checkboxes">
        <ul>
        @foreach (var c in ViewBag.Categories)
        {
           <li>
               @foreach(var vc in Model.VendorCategories)
               {
                   if(c.Id == vc.CategoryID)
                   {
                        <input type="checkbox" name="categories" checked="checked" value="@c.Id" /> @vc.ProductServiceCategory.CategoryName
                       <br />
                   }
                   else
                   {
                        <input type="checkbox" name="categories" value="@c.Id" /> @vc.ProductServiceCategory.CategoryName
                        <br />
                   }
               }
           </li>
        }
        </ul>
        @Html.ValidationMessage("Please check at least one Product/Service category")
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:00:00.590

你可以做

```
_db.VendorProfiles.Include("VendorCategories.ProductServiceCategory") 
```

在结果集中同时包含 the`VendorCategories`和它们`ProductServiceCategory`的 s。

顺便说一句，如果您使用[`DbExtensions.Include`](http://msdn.microsoft.com/en-us/library/gg671236%28v=vs.103%29.aspx)智能感知来帮助您找到正确的包含路径。

# jquery - 初始化 jquery tablesorter 插件

> ID：13406734
> 
> 赞同：0
> 
> 时间：2012-11-15T21:42:21.907
> 
> 标签：jquery, tablesorter

这是我第一次尝试使用 jquery 库，所以我不确定如何初始化 tablesort 插件。我在没有外部 .js 文件的情况下尝试这样做，以便我知道我的 html 和 javascript 之间的链接不是问题。我还包含了一个单独的 js 函数，以便我知道正在加载 jquery 库。当我单击链接时，我会收到 Hello World！警报。我已经阅读并观看了大约 5 个教程，这些教程很好地解释了如何做到这一点，并且每次我在尝试对表格进行排序时都没有得到任何回应。同样，为简单起见，我将 html 文件、jquery 库和 tablesorter 文件放在同一个文件夹中。（见下图）

这是我的代码：

```
<html>                                                                  
<head>                                                                  
<script type="text/javascript" src="jquery-1.8.2.min.js" </script>
<script type="text/javascript" src="jquery.tablesorter.min.js"></script>

<script type="text/javascript">                                         
    $(document).ready(function() {
        $("a").click(function() {
            alert("Hello world!");
            });
        });

         $(document).ready(function(){
            $("#large").tablesorter();
         });
</script> 
 </head>                                                                 
 <body>   
 <a href="http://localhost/fortesting.html">Link</a>

<table id="large" cellspacing="0">
<thead>

    <tr>
        <th>Email</th>
        <th>Id</th>
        <th>Phone</th>
        <th>Total</th>
        <th>Ip</th>
        <th>Url</th>
        <th>Time</th>
        <th>ISO Date</th>
        <th>UK Date</th>
    </tr>
</thead>    
<tbody>
    <tr>

        <td>devo@flexomat.com</td>
        <td>66672</td>
        <td>941-964-8535</td>
        <td>$2482.79</td>
        <td>172.78.200.124</td>
        <td>http://gmail.com</td>
        <td>15:10</td>
        <td>1988/12/14</td>
        <td>14/12/1988</td>
    </tr>

    <tr>
        <td>henry@mountdev.net</td>
        <td>35889</td>
        <td>941-964-9543</td>
        <td>$2776.09</td>
        <td>119.232.182.142</td>
        <td>http://www.gmail.com</td>
        <td>3:54</td>
        <td>1974/1/19</td>
        <td>19/1/1974</td>
    </tr>

    <tr>
        <td>christian@reno.gov</td>
        <td>60021</td>
        <td>941-964-5617</td>
        <td>$2743.41</td>
        <td>167.209.64.181</td>
        <td>http://www.dotnet.ca</td>
        <td>10:58</td>
        <td>2000/3/25</td>
        <td>25/3/2000</td>
     </tr>
   </tbody>
 </table>
</body>
</html> 
```

有人能看到我的错误可能在哪里吗？据我所知，这与链接到我的 jquery 库的 jquery.tablesorter.min.js 文件有关，但正如我之前提到的，我遵循了多个教程，结果没有任何变化。我在 IE9 和 Firefox 中都尝试过。谢谢参观。

![我的文件夹的照片](../Images/0947c138ffa0544a1d1f9f578bea26c9.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:57:14.167

`>`您在此处的代码中缺少 a ：

```
<script type="text/javascript" src="jquery-1.8.2.min.js" </script>
<script type="text/javascript" src="jquery.tablesorter.min.js"></script> 
```

它仍然有效的原因是因为它忽略`</script`了整个下一行直到`</script>`，所以基本上它变成了：

```
<script type="text/javascript" src="jquery-1.8.2.min.js"></script> 
```

意味着 tablesorter.js 没有被加载。

不过，您应该仍然遇到`tablesorter is undefined`错误。

# php - preg_match php 错误 - 未找到结束分隔符 '^'

> ID：13406746
> 
> 赞同：2
> 
> 时间：2012-11-15T21:43:17.853
> 
> 标签：php, regex

> **可能重复：**
> [php 正则表达式在中找不到结束分隔符 '^'](https://stackoverflow.com/questions/4634993/php-regular-expressions-no-ending-delimiter-found-in)

代码如下：

```
if(preg_match($exp, $value)){
   return "";           
} 
```

*   的值为`$exp`：`^[0-9]*$`
*   的值为`$value`：`7`

输出给出：

> 警告：preg_match() [function.preg-match]：在 /... 中找不到结束分隔符 '^'

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:47:37.607

`$exp`应该类似于`/^[0-9]*$/`它以您想要的方式工作。它假设`^`是你的正则表达式分隔符，因为它是第一个字符 - 你希望你的第一个字符是别的东西。有关详细信息，请参阅[preg_match 手册条目](http://php.net/preg_match)。

# android - 如何处理 Android 活动中的 SQLiteException？

> ID：13406749
> 
> 赞同：3
> 
> 时间：2012-11-15T21:43:30.090
> 
> 标签：android, sqlite, exception-handling, android-activity, android-contentprovider

我正在研究如何处理 Android 中的异常。

在`update()`记事本内容提供程序的示例代码中的函数中，它调用`getWriteableDatabase()`，这可能会引发`SQLiteException`.

我注意到该`NoteEditor` `Activity` `saveNote()`函数具有以下代码：

```
// Commit all of our changes to persistent storage. When the update completes
// the content provider will notify the cursor of the change, which will
// cause the UI to be updated.
try {
   getContentResolver().update(mUri, values, null, null);
 } catch (NullPointerException e) {
     Log.e(TAG, e.getMessage());
 } 
```

如果发生了`SQLiteException`会发生什么？我希望能够在 中捕获此异常`Activity`并向用户显示适当的消息（通过吐司或类似的东西）。

我想我可以通过为`SQLiteException`. 但是，我在 Google 文档中阅读了以下信息：

> “请记住，Android 系统必须能够跨进程边界传递异常。Android 可以针对以下可能对处理查询错误有用的异常执行此操作：
> 
> **IllegalArgumentException**（如果您的提供者收到 >invalid content URI，您可以选择抛出此异常）
> 
> **空指针异常**"

所以我现在很困惑——我能不能抓住`SQLiteException`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T01:35:48.137

只要有可能，您应该在发生异常的类或组件中捕获异常。使用某种广播机制或返回值语义来报告跨进程的错误。

诚然，这是一个棘手的情况。有人说，如果 ContentProvider 中出现 SQLite（或其他 Exception），提供者应该向上传播异常，而不是在 Cursor 中返回 null。但是，这通常不适用于跨进程！另一方面，返回 null 不会给你很多信息。

一组有限的异常[确实会遍历进程边界](https://stackoverflow.com/a/12012173)，但 SQLiteException 不在其中——它们仍然可能有用/合适。

# vim - 基于缓冲区名称的 Vim 完成

> ID：13406751
> 
> 赞同：8
> 
> 时间：2012-11-15T21:43:43.083
> 
> 标签：vim, autocomplete

在 Vim 中，我经常发现自己想要完成在单独缓冲区中编辑的文件的文件名。

假设我打开了两个缓冲区：foo.cpp 和 bar.h。在 foo.cpp 我需要#include "bar.h"。我想做这样的事情：

foo.cpp

```
#include "b<complete filename to bar.h> 
```

根据 Vim 文档，我可以使用 CTRL+x CTRL+f 来完成文件名，但这似乎依赖于 Vim 具有与 bar.h 的父目录等效的 CWD。这并不总是可能的。

鉴于我在单独的缓冲区中打开了 bar.h，是否可以根据缓冲区名称自动完成？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-16T13:16:00.337

好主意; 将候选者限制在加载的缓冲区中会减少候选者列表，并且还允许在文件路径中的任何位置进行匹配。

为此，必须实现自定义插入模式完成。可以通过从到遍历`bufname()`所有缓冲区号来检索文件名。我刚刚将它实现为[BufNameComplete 插件](http://www.vim.org/scripts/script.php?script_id=4313)。我希望这适合您（和我的）的需求。`1``bufnr('$')`

# php - 调用两个js函数并且不打印消息

> ID：13406753
> 
> 赞同：1
> 
> 时间：2012-11-15T21:43:44.627
> 
> 标签：php, javascript, sql, ajax, dom

我在 ajax 中有问题，它没有打印我想要的消息。让我们解释一下。在 php 代码中，我有一个输入标签：

```
<input type="submit" id="login_button_add" name="submit" value="Add" 
onclick="add_building(); showbuildings( );" /> 
```

这两个js函数是：

```
function add_building(){
    var str1=document.getElementById("building_name").value;
    if (window.XMLHttpRequest)
    {// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    }
    else
    {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
    if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
        document.getElementById("txtHint10").innerHTML=xmlhttp.responseText;}
    }
    xmlhttp.open("GET","add_building.php?q="+str1,true);
    xmlhttp.send();
} 
```

在`add_building.php`我在数据库中添加一行并打印消息。查询工作正常，但它不会在我的页面中打印带有我在我的 html 代码中的 id 的消息。我认为问题在于我调用了第二个 js 函数。因为当我`add_building()`单独打电话时，它可以完美运行（打印消息）。

的php代码`add_building.php`是：

```
$q=$_GET["q"];

if ($q!==''){
$link= mysqli_connect(...);

mysqli_set_charset($link, "utf8");
$sql="SELECT * FROM buildings WHERE name='$q'";
$result = mysqli_query($link,$sql);

if (!mysqli_num_rows($result)){
mysqli_set_charset($link, "utf8");
$sql="INSERT INTO buildings VALUES ('','$q','')";
$result =mysqli_query($link,$sql);
echo "The building added successfully.";
}
else {echo 'Building name exists. Try a different.';}

@ db_close($link);
}
else{echo 'Please insert a name.';} 
```

另一个js函数是：

```
function showbuildings(str)
{
    if (str=="")
    {
        document.getElementById("show_buildings_js").innerHTML="";
        return;
    } 
    if (window.XMLHttpRequest)
    {// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    }
    else
    {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            document.getElementById("show_buildings_js").innerHTML=xmlhttp.responseText;
        }
    }
    xmlhttp.open("GET","showbds.php?q=",true);
    xmlhttp.send();
} 
```

在这个函数中，我在我的页面中打印表格。这很好用。

问题是来自的消息`add_building.php`不打印`id='txtHint10'`，尽管所有其他人都在`add_building.php`工作。我认为问题在于我调用了第二个 js 函数并且我有两个 xmlhttp.responseText。因为当我`add_building()`单独调用 js 函数时，它可以完美运行并打印消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:50:41.220

问题是您正在`xmlhttp`使用第二个 javascript 函数覆盖您的变量。结果是只执行来自第二个函数的回调。

为了使这两个函数彼此独立工作，您需要使用不同的变量名或在每个函数中本地声明它们`var xmlhttp;`（更清洁的解决方案）。

请注意，javascript 中变量的范围是全局的，除非您`var`在函数中声明它使用。

# c# - C# 对象比较

> ID：13406756
> 
> 赞同：2
> 
> 时间：2012-11-15T21:44:01.600
> 
> 标签：c#

在 C# 中，有没有办法重载比较运算符，例如`==`,`=<`或`>`在用户定义的对象上？

类似于你可以写`"string"=="string"`而不是`"string".Equals("string")`

我知道您可以定义 CompareTo 和 Equals 函数，但我想知道是否有快捷方式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T21:45:32.503

`==`您可以通过在所需的中实现具有以下签名的函数来覆盖 C# 中的运算符`class`：

`public static bool operator ==(YourClass a, YourClass b) { }`

这同样适用于`<=`和`>`运算符。

通过覆盖，`==`您还必须覆盖`!=`，并且建议重载`Equals`and`GetHashcode`函数。

有关更多信息，请阅读：

[运算符重载教程](http://msdn.microsoft.com/en-us/library/aa288467%28v=vs.71%29.aspx)

[重载 Equals() 和运算符 == 的指南（C# 编程指南）](http://msdn.microsoft.com/en-us/library/ms173147%28v=vs.80%29.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-15T21:51:41.300

简单的例子：

```
class Foo
{
    public int Id { get; set; }

    public static bool operator ==(Foo first, Foo second)
    {
        return first.Id == second.Id;
    }

    public static bool operator !=(Foo first, Foo second)
    {
        return first.Id != second.Id;
    }
} 
```

您还应该覆盖 Equals 和 GetHashCode

# flash - Flash 播放器会话不会在关闭气球时停止

> ID：13406757
> 
> 赞同：1
> 
> 时间：2012-11-15T21:44:01.540
> 
> 标签：flash, video, google-maps-api-3, video-player

我做了一个全屏地图网站。在一些有趣的地方，有一些气球作为地标打开。

*   这些是 Java 气球，称为`InfoWindows`.
*   在某些 InfoWindows 中有`YouTUBE`Flash 视频。
*   这些视频是 Java InfoWindow 中的 flash 元素。

当气球关闭时，我不知道如何告诉 Flash 会话停止。如果我不停止 Flash 播放，通过暂停点击，歌曲//视频继续运行并下载。因此，如果我打开四个或十个 InfoWindows，然后使用 esc 键或 X 按钮关闭它们，我就会下载并播放十个视频。

有没有办法告诉闪烁它就足够了？我使用 Google API 和 ZhMaps 作为 Joomla 组件。该网站是：[Foto video mappa dell ?isola del Giglio](http://www.gigliotube.it)

我在该信息窗口的选项卡中插入的示例：

```
<table style="height: 250px; width: 320px;" valign="middle" border="0" align="center">
    <tbody>
        <tr>
            <td>
            <object width="320" height="180" data="http://www.youtube-nocookie.com/v/JZkfA9lejC0?version=3&amp;hl=en_US" type="application/x-shockwave-flash">
                <param name="movie" value="http://www.youtube-nocookie.com/v/JZkfA9lejC0?version=3&amp;hl=en_US" />
                <param name="allowFullScreen" value="true" />
                <param name="allowscriptaccess" value="always" />
            </object>
            </td>
        </tr>
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T08:57:54.393

Flash 是历史，（谢天谢地！）;-)。尝试改用[**YouTube 的 HTML5 播放器**](https://developers.google.com/youtube/youtube_player_demo)：

# javascript - 如何打开我想在其中运行 javascript 的 Ghost 本地 html 文件？

> ID：13406759
> 
> 赞同：1
> 
> 时间：2012-11-15T21:44:20.320
> 
> 标签：javascript, python, python-2.7, ghost.py

如何打开我想在其中运行 javascript 的 Ghost 本地 html 文件？我只知道如何从互联网上的教程中做到这一点。

```
from ghost import Ghost
ghost = Ghost()
page, extra_resources = ghost.open(url) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:13:48.740

而不是 url 提供本地位置。

例子：`page, extra_resources = ghost.open('/home/dan/index.html')`

# c# - 异步 ServiceStack Web 服务调用后回调以更新 GUI

> ID：13406761
> 
> 赞同：2
> 
> 时间：2012-11-15T21:44:25.203
> 
> 标签：c#, wpf, delegates, callback, servicestack

`ListBox`一旦对 Web 服务的异步调用成功返回，我需要在我的 GUI 中刷新 a 。这并不像将 Web 服务调用的结果转储到 an 中那么简单，`ObservableCollection`因为结果实际上是放入索引的，并且在任何给定时间`Dictionary`仅显示前 1000 个结果。`ListBox`

我有代码可以挑选出前 1000 个结果并刷新`ListBox`显示，我只需要在结果成功返回后想办法调用它。

```
this.client.GetAsync<RepositoryResponse>(string.Format
    ("/repository?Dto={0}", reader.Dto.ToJson()),
    r => ReadSuccessCallback(r),
    (r, x) => ReadErrorCallback(r, x)); 
```

此代码在与进行 GUI 更新的窗口不同的对话框中执行。我在关闭一个对话框时将此称为异步获取，并希望`ListBox`在原始窗口中刷新。我尝试`Action`在方法中传递一个要执行的对象`ReadSuccessCallback`，它正确执行，但给我一个错误，说`Items`背后的集合`ListBox`属于不同的线程，并且无法更改。

`ListBox`只有在`GetAsync`成功返回后，我才能获得 1000 个项目的新块（并刷新 的显示）？有什么方法可以确保`ReadSuccessCallback`在我的 GUI 运行的同一线程中执行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:13:03.930

这是一种老派，但它应该工作。将有问题的操作放入[后台工作人员](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)DoWork 事件中，您显示的客户端调用更改为同步调用，*因为它现在在自己的线程*中，将结果数据传递给 RunWorkerCompleted 事件，然后处理所需的此时列表框对于 GUI 线程是安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T23:40:13.113

如果你想更新 UI 控件，你应该在 UI 线程上调用回调。[这是一篇很好的文章，展示了使用WPF Dispatcher](http://www.switchonthecode.com/tutorials/working-with-the-wpf-dispatcher)执行此操作的不同方法。

因此，其中一种方法是执行以下操作：

```
this.client.GetAsync<RepositoryResponse>(string.Format
("/repository?Dto={0}", reader.Dto.ToJson()),
r => {
    myListBox.Dispatcher.Invoke(
        System.Windows.Threading.DispatcherPriority.Normal, () => {
           //populate results int myListBox
        }); 
},
(r, x) => ReadErrorCallback(r, x)); 
```

# javascript - 使用 Rails 创建一个 PowerPoint 演示文稿

> ID：13406767
> 
> 赞同：5
> 
> 时间：2012-11-15T21:44:55.397
> 
> 标签：javascript, ruby-on-rails, ruby, web, powerpoint

我的情况是，我必须以编程方式构建 PowerPoint 演示文稿并通过 Web 应用程序提供生成的 ppt 文件，最好使用 Rails、JavaScript 或 Ruby。这可能吗？如果是这样，如何以及使用哪些工具？

我对如何最好地解决这个问题的任何建议持开放态度。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-09-19T22:57:15.160

这颗红宝石似乎比当前接受的答案中提到的更成熟。

[https://github.com/pythonicrubyist/powerpoint](https://github.com/pythonicrubyist/powerpoint) [http://rubygems.org/gems/powerpoint](http://rubygems.org/gems/powerpoint)

```
require 'powerpoint'

@deck = Powerpoint::Presentation.new

# Creating an introduction slide:
title = 'Bicycle Of the Mind'
subtitle = 'created by Steve Jobs'
@deck.add_intro title, subtitle

# Creating a text-only slide:
# Title must be a string.
# Content must be an array of strings that will be displayed as bullet items.
title = 'Why Mac?'
content = ['Its cool!', 'Its light.']
@deck.add_textual_slide title, content

# Creating an image Slide:
# It will contain a title as string.
# and an embeded image
title = 'Everyone loves Macs:'
image_path = 'samples/images/sample_gif.gif'
@deck.add_pictorial_slide title, image_path

# Specifying coordinates and image size for an embeded image.
# x and y values define the position of the image on the slide.
# cx and cy define the width and height of the image.
# x, y, cx, cy are in points. Each pixel is 12700 points.
# coordinates parameter is optional.
coords = {x: 124200, y: 3356451, cx: 2895600, cy: 1013460}
@deck.add_pictorial_slide title, image_path, coords

# Saving the pptx file to the current directory.
@deck.save('test.pptx') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-15T22:43:57.020

[http://tomasvarsavsky.com/2009/04/04/simple-word-document-template-using-ruby-and-xml/](http://tomasvarsavsky.com/2009/04/04/simple-word-document-templating-using-ruby-and-xml/)

如果您可以创建模板并填充值，请考虑这种方法。

> Office Open XML 文件格式
> 
> 新的 Office 文件格式（.docx、.xlsx、.pptx 文件）基本上是 XML 文件的压缩集合。我们专注于 Word 文件 (.docx)，但这种方法也适用于任何其他类型的文件。格式规范有几千页。如果没有专门构建的库来处理格式的所有复杂性，从头开始生成文件将是一项艰巨的任务。相反，我们在 Word 中起草模板并放置标记来告诉我们的模板引擎在哪里插入值。我们创建了引用数据值的文档属性，并将这些作为字段添加到文档中应该插入值的位置。例如，我们可以有如下字段：

```
label_tag #{data[:user].name}
label_tag #{data[:user].address}
label_tag #{data[:booking].number}
label_tag #{data[:booking].items.collect{|i| i.name}.join(‘,’)} 
```

否则，有一个尝试（三年前上传的 WIP，我不希望它完成，但应该有助于创建一种创建幻灯片的方法）创建 PowerPoint 幻灯片。这是代码示例

[https://github.com/jpoz/rubypoint/blob/master/lib/rubypoint/presentation.rb](https://github.com/jpoz/rubypoint/blob/master/lib/rubypoint/presentation.rb)

```
def new_slide
  RubyPoint::Slide.new(self)
end 
```

# ios - iOS UIScrollView 总是反弹回来

> ID：13406768
> 
> 赞同：0
> 
> 时间：2012-11-15T21:44:56.400
> 
> 标签：ios, uiscrollview

我正在尝试制作一个基本的概念证明应用程序。它使用内部带有 UIImageView 的 UIScrollView。

我设置了图像，然后设置了 UIScrollView 的 contentSize，但我似乎仍然无法滚动，它总是弹回开始。有谁知道我可能会错过什么？

PS。缩放工作正常。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.

    [self.picture setImage:nil];
    [self.picture setImage:self.image];

    self.scroll.contentSize = self.picture.frame.size;
}

- (void)scrollViewDidEndZooming:(UIScrollView *)scrollView withView:(UIView *)view atScale:(float)scale
{

}

- (UIView *)viewForZoomingInScrollView:(UIScrollView *)scrollView
{
    return self.picture;
} 
```

大家好，好的，我已经弄清楚除了下面的修复之外的问题。只要我关闭情节提要中的自动布局选项，它就会起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:12:17.537

当您在 a 上设置图像时`UIImageView`，它的框架不会更新为新图像的大小。您要做的是调用以下命令来更新框架框架`picture`以匹配图像的大小。

```
[self.picture sizeToFit]; 
```

附带说明一下，在更改图像之前，您不需要在 imageView 上将图像设置为 nil。

# php - 如何允许 'okina 字符通过 preg_replace() 中的范围？

> ID：13406774
> 
> 赞同：0
> 
> 时间：2012-11-15T21:45:02.597
> 
> 标签：php, preg-replace, special-characters

我需要通过以下代码允许['okina字符](http://www.fileformat.info/info/unicode/char/02bb/index.htm)

```
<?php $char = preg_replace('/[\x00-\x08\x0B\x0C\x0E-\x1F\x80-\xFF]/u', '', $char); ?> 
```

我试图找到一个关于范围如何在这里工作以及如何从没有运气的范围中挑选出一个字母的清晰解释。我怎么做？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:35:38.003

您所指的字符是修饰符字母转逗号 (U+02BB)，在 Unicode 标准中被描述为“在夏威夷正字法中用作 ʻokina（声门塞音）”。有人可能会说它是最正确的 `okina，但它肯定不是唯一用于此目的的字符。'okina 经常写成右单引号' U+2019、左单引号' U+2018、（Ascii）撇号' U+0027 或重音符号' U+0060。

但考虑到 U+02BB，它可以用 PHP 正则表达式编写为`\x{02bb}`. 有关该符号的说明，请参阅[如何在 PHP 中用 '*' 替换不在 [0x5E10, 0x7F35] 范围内的字符？](https://stackoverflow.com/questions/2728070/how-do-i-replace-characters-not-in-range-0x5e10-0x7f35-with-in-php/2728372#2728372)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:53:05.783

由于您的正则表达式仅阻止长度为一字节或更短的“某些”字符，因此不可能阻止 okina 字符，因为它是一个两字节字符。所以，我建议你试试这个正则表达式：

```
<?php $char = preg_replace('/[\x00-\x08\x0B\x0C\x0E-\x1F]/u', '', $char); ?> 
```

并允许所有字符 x80-xFF 通过，看看是否可以解决您的问题。

如果是这样，则可能是您与 okina 混淆的“左单引号”（西方字符集中的 x91）。

# css - CSS中的直接线性变换

> ID：13406778
> 
> 赞同：9
> 
> 时间：2012-11-15T21:45:20.943
> 
> 标签：css, css-transforms

是否可以在 CSS 中进行 DLT？如果是这样，这是如何实现的？我想不出一种方法来使用`transform: matrix`...如果这是不可能的，那么另一种方法是什么？

我想要达到的特殊效果是以类似于 Safari 的方式来布置 div：![在此处输入图像描述](../Images/43675a37998925fbb000d6f31b1914e6.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T15:52:21.850

这是对您的要求的非常粗略且非通用的答案。[http://jsfiddle.net/3t5SM/](http://jsfiddle.net/3t5SM/) 您可以轻松地对其进行扩展以获得更好的通用解决方案。

在我的 CSS 中，

```
#id1, #id4, #id7{        
 -webkit-transform: rotateY(40deg);
}
#id3, #id6, #id9{        
 -webkit-transform: rotateY(-40deg);
}
#id2, #id5, #id8{        
 -webkit-transform: scale(0.94);
} 
```

基本思想是为每一列创建一个样式（这里我称之为 id，但同样，最好为每一列设置一个样式并将列定义为`.left`、`.middle`、`.right`等）

如果我有时间详细介绍，我今晚会更新我的帖子:)

* * *

编辑：作为承诺，这里有一个更好的版本。现在它更加通用，并且根据窗口的大小，您将获得正确数量的立方体。它仍然远非完美（您可以使用立方体的大小以获得更好的深度感），但总的来说，您会发现它是可能的，甚至是动态的 :) 这里是小提琴：[http:// jsfiddle.net/P84qd/4/](http://jsfiddle.net/P84qd/4/)

深入了解 javascript 的详细信息：

```
function dispatch(){
    var sizeOfImg = 150;
    var windowWith = document.body.offsetWidth;
    var widthRest = windowWith%sizeOfImg;
    var nbSquareRow = Math.floor(windowWith/sizeOfImg);
    dlt(nbSquareRow);
    var marginVal = widthRest/(nbSquareRow+1);
    var lineout = document.getElementById('lineout');
    lineout.style.paddingLeft = marginVal+'px';
    lineout.style.paddingTop = marginVal+'px';
    var square = document.getElementsByTagName('div');
    for(var i=0, length = square.length;i<length; i++){
        if(square[i].className === 'square'){
            square[i].style.marginRight = marginVal+'px'; 
            square[i].style.marginBottom = marginVal+'px';        
        }       
    }
}

dispatch();
window.onresize = function(e){dispatch();};

function dlt(nbSquareRow){
    var maxRotatDeg = 40;
    var isEven=true;
    if(nbSquareRow%2 == 0){
        var unityRotatDeg = maxRotatDeg/(nbSquareRow/2);
    }else{
        var unityRotatDeg = maxRotatDeg/((nbSquareRow-1)/2);
        isEven = false;
    }
    var middle = Math.floor(nbSquareRow/2);
    var mySquares = document.getElementsByTagName('div');
    for(var j=0, sqleng = mySquares.length;j<sqleng; j++){
        if(mySquares[j].className == 'square'){
            var colNumb = (parseInt(mySquares[j].id)-1)%nbSquareRow;
            var myMultiplier = (middle-colNumb);
            if(isEven && myMultiplier<=0){
                myMultiplier--;
            }
            mySquares[j].style.webkitTransform = 'rotateY('+(unityRotatDeg*myMultiplier)+'deg)';
        }
    }
} 
```

该`dispatch`函数是一个简单的函数，它将在您的网页上以相等的边距（上、左、右、下）分布正方形。我从[1](https://stackoverflow.com/questions/13396736/how-to-give-all-divs-same-amount-of-space-on-each-side/13399866#13399866 "另一个stackoverflow问题")拿走了它。该`dlt`函数计算列数并定义每列的旋转量（在我的示例中，最大旋转值为 40）。其余代码纯粹是一些数学检查，以使其正常工作。

为了获得更好的结果，您应该使用每个正方形的大小，但要小心，因为该`dispatch`函数还需要知道正方形的大小来计算每行允许显示多少个正方形。我会让你玩得开心;) ​</p>

# c++ - 填充对向量

> ID：13406790
> 
> 赞同：15
> 
> 时间：2012-11-15T21:46:12.980
> 
> 标签：c++, stl

我想用 8 对填充一个向量。每对代表一匹马在国际象棋游戏中的 x 和 y 坐标移动。目前我正在这样做

```
vector<pair<int,int>> moves;

pair<int,int> aPair;
aPair.first = -2;
aPair.second = -1;
moves.push_back(aPair);
aPair.first = -2;
aPair.second = 1;
moves.push_back(aPair);
aPair.first = -1;
aPair.second = -2;
moves.push_back(aPair);
aPair.first = -1;
aPair.second = 2;
moves.push_back(aPair);
aPair.first = 1;
aPair.second = -2;
moves.push_back(aPair);
aPair.first = 1;
aPair.second = 2;
moves.push_back(aPair);
aPair.first = 2;
aPair.second = -1;
moves[6].push_back(aPair);
aPair.first = 2;
aPair.second = 1;
moves.push_back(aPair); 
```

我这样做是为了了解 Std 库。这似乎是解决这个问题的一种非常低效的方法。

有人有更优雅的解决方案吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-15T21:52:43.277

如果你有 C++11（否则你不能写`>>`），你可以使用以下：

```
vector<pair<int,int>> moves = {
  {-2, -1},
  {-2,  1},
  {-1, -2},
  {-1,  2},
  { 1, -2},
  { 1,  2},
  { 2, -1},
  { 2,  1}
}; 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-15T23:08:35.303

循环救援：

```
for(int k = 0; k < 2; k++)
    for(int i = -1; i < 2; i += 2)
        for(int j = -1; j < 2; j+= 2)
            result.push_back(make_pair(i * (k+1), j * (((k + 1) % 2) + 1))); 
```

输出：http: [//ideone.com/2B0F9b](http://ideone.com/2B0F9b)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-11-15T21:58:48.937

在 C++98/03 中：

```
moves.push_back(std::make_pair(-2, -1)); 
```

在 C++11 中：

```
moves.emplace_back(-2, -1); 
```

或者在 C++11 中：

```
std::vector<std::pair<int, int>> moves = { { -2, -1}, ... }; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-11-15T21:54:12.810

如果您没有 C++11，您可以使用[make_pair](http://en.cppreference.com/w/cpp/utility/pair/make_pair)，为向量预分配空间而不使用 Reserve 初始化元素，然后使用 push_back 而不进行新的分配。

例如：

```
vector<pair<int,int> > moves;
moves.reserve(8);
moves.push_back(make_pair(-2, -1));
    // and so on 
```

即使你有 C++11，如果你需要动态计算元素而不是硬编码它们，这种技术也很有用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-15T21:54:50.490

试试看：

```
vector<pair<int,int>> moves{{-2, -1}, {2, 1}, {-1, -2}, {-1, 2},
                            {1, -2},  {1, 2}, {2, -1},  {2, 1}}; 
```

[初始化列表](http://en.cppreference.com/w/cpp/utility/initializer_list)与统一初始化一起在 C++11 中提供了强大的功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-15T22:01:23.340

这是做同样事情的另一种方法。

```
template <class VectorClass>
class CreateVector
{
public:
    typedef typename VectorClass::value_type value_type;
    CreateVector(const value_type& value)
    {
        mVector.push_back(value);
    }

    CreateVector& operator()(const value_type& value)
    {
        mVector.push_back(value);
        return *this;
    }

    inline operator VectorClass() const
    {
        return mVector;
    }
private:
    VectorClass mVector;
}; 
```

用法：

```
vector<pair<int,int>> moves = CreateVector<vector<pair<int,int> > >
(make_pair(1,2))
(make_pair(2,3))
(make_pair(3,4))
(make_pair(4,5)); 
```

编辑：如果您不使用 C++11，这将是一种方法。否则，我建议按照@ipc 建议的方式进行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-15T23:50:35.333

如果您使用的是 C++11，您可能需要考虑使用 std::array 而不是 std::vector。与普通数组一样，std 数组具有固定数量的元素，如果您事先知道使用了多少数据，则在概念上更有意义。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-31T08:26:25.400

希望有一个更易读的带有循环的版本：

```
vector<pair<int, int>> result;
for(int moveX=1; moveX<=2; moveX++)
{
    for(int signX=-1; signX<=1; signX+=2)
    {
        for(int signY=-1; signY<=1; signY+=2)
        {
            result.push_back(make_pair(moveX*signX, (3-moveX)*signY));
        }
    }
} 
```

[完整程序](http://ideone.com/jotOFT)产生以下向量：

```
{-1, -2},
{-1, 2},
{1, -2},
{1, 2},
{-2, -1},
{-2, 1},
{2, -1},
{2, 1}, 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2020-08-13T21:23:51.507

```
> vector<pair<int,int>>x; pair<int,int>y;
> 
> for(int i=0;i<3;i++){
>     cin>>y.first;
>     cin>>y.second;
>     x.push_back(y); } for(int i=0;i<3;i++){
>     cout<<x[i].first<<" "<<x[i].second<<endl; } 
```

这就是我们应该如何添加 cin 语句。

# angularjs - AngularJS 中的模块和命名空间/名称冲突

> ID：13406791
> 
> 赞同：49
> 
> 时间：2012-11-15T21:46:18.613
> 
> 标签：angularjs, namespaces, collision, angularjs-module

考虑以下 jfiddle [http://jsfiddle.net/bchapman26/9uUBU/29/](http://jsfiddle.net/bchapman26/9uUBU/29/)

```
//angular.js example for factory vs service
var app = angular.module('myApp', ['module1', 'module2']);

var service1module = angular.module('module1', []);

service1module.factory('myService', function() {
    return {
        sayHello: function(text) {
            return "Service1 says \"Hello " + text + "\"";
        },
        sayGoodbye: function(text) {
            return "Service1 says \"Goodbye " + text + "\"";
        }
    };
});

var service2module = angular.module('module2', []);

service2module.factory('myService', function() {
    return {
        sayHello: function(text) {
            return "Service2 says \"Hello " + text + "\"";
        },
        sayGoodbye: function(text) {
            return "Service2 says \"Goodbye " + text + "\"";
        }
    };
});

function HelloCtrl($scope, myService) {
    $scope.fromService1 = myService.sayHello("World");
}

function GoodbyeCtrl($scope, myService) {
    $scope.fromService2 = myService.sayGoodbye("World");
}​ 
```

我有 2 个模块（模块 1 和模块 2）。module1 和 module2 都定义了一个名为 myService 的服务。当两个模块都导入 myApp 时，这似乎会在 Angular 中的 myService 上产生名称冲突。AngularJs 似乎只是使用了第二个服务定义，而没有警告您可能存在的问题。

非常大的项目（或者只是重用一般的模块）会有名称冲突的风险，这可能很难调试。

有没有办法用模块名称为名称添加前缀，以免发生名称冲突？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-11-06T18:38:53.303

到目前为止，AngularJS 模块不提供任何类型的命名空间来防止不同模块中的对象之间的冲突。原因是 AngularJS 应用程序有一个注入器，它保存所有对象的名称，而不考虑模块名称。

[AngularJS 开发者指南](http://docs.angularjs.org/guide/di)说：

> 为了管理依赖创建的职责，每个 Angular 应用程序都有一个注入器。注入器是一个服务定位器，负责构建和查找依赖项。

正如您所提到的，将模块注入主/应用程序模块时可能会导致讨厌的错误。当碰撞发生时，它们是沉默的，获胜者由最后注入的模块决定。

所以不，没有避免这些碰撞的内置方法。也许这将在未来发生。对于更容易出现此问题的大型应用程序，您说得对，命名约定是您的最佳工具。考虑属于模块或功能区域的对象是否可以使用短前缀。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-19T21:03:21.930

您可以通过使用约定命名模块来避免这种情况，以便它们始终是唯一的。

一种方法是看看其他语言是如何做到的。例如，在 Java 中，类的“全名”基于文件名和它所在的文件夹。例如，如果在 MyArtStuff 文件夹中有一个名为 Bitmap.java 的 Java 文件，则类的全名将成为 MyArtStuff.Bitmap

结果 AngularJS 允许您将点 (.) 作为模块名称的一部分，因此您基本上可以使用名称约定。

例如，如果开发人员在脚本“MainPage\Module1.js”中创建了一个名为“ModuleA”的模块，他们应该将其模块命名为“MainPage.Module1.ModuleA”。因为每个路径和文件名在您的应用程序中都是唯一的，所以您的模块名称将是唯一的。

你只需要让你的开发人员遵循这个约定。

请注意，正如 Rockallite 指出的那样，这对于在多个模块中具有相同名称的服务、控制器等没有帮助。但是您可以使用类似的方法来产生结果，并为这些元素的名称加上前缀。

理想情况下，AngularJS 应该有命名空间，并且在未来它可能会。在那之前，我们能做的最好的事情就是做开发人员在命名空间被发明之前 40 多年一直在做的事情，并尽我们所能为我们的元素添加前缀。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-07T16:45:38.137

`namespacing`不幸的是，*AngularJS*中没有。一种解决方案是使用一个`prefix`（另一种解决方案可能是[这个](https://stackoverflow.com/questions/18571301/angularjs-multiple-ng-app-within-a-page/50720181#50720181)！）。请参见以下示例：

```
// root app
const rootApp = angular.module('root-app', ['app1', 'app2']);

// app 1
const app1 = angular.module('app1', []);
app1.controller('app1.main', function($scope) {
  $scope.msg = 'App1';
});

// app2
const app2 = angular.module('app2', []);
app1.controller('app2.main', function($scope) {
  $scope.msg = 'App2';
})
```

```
<!-- angularjs@1.7.0 -->
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.0/angular.min.js"></script>

<!-- root app -->
<div ng-app="root-app">

  <!-- app 1 -->
  <div ng-controller="app1.main">
    {{msg}}
  </div>

  <!-- app 2 -->
  <div ng-controller="app2.main">
    {{msg}}
  </div>

</div>
```

* * *

## 回答 #4

> 赞同：-8
> 
> 时间：2012-11-16T00:00:45.857

在您希望服务来自的模块上定义您的控制器。

`service2Module.controller("ServiceTwoCtrl", function(myService, $scope) {});`

# android - 从非活动类访问 SQLite db

> ID：13406794
> 
> 赞同：0
> 
> 时间：2012-11-15T21:46:49.183
> 
> 标签：android, sqlite, baseadapter

我有三个班，

活动 - 使用我的 single_list_item.xml SQLiteOpenHelper 显示列表视图 - 我目前正在这里运行我的查询。

我的活动和我的 SQLiteOpenHelper 很好地交谈。但是我不确定如何从我的第三堂课运行查询

BaseAdapter - 这个不在我的清单中，并且以我目前的技能，我无法从这个访问数据库 - 就像我通常从活动类中所做的那样。

我想根据查询中的值在我的 single_list_item.xml 中隐藏一个文本视图（查询只返回 0 或 1）。我可以通过定义 tv.setVisibility(View.GONE) 等轻松隐藏或静态显示它。但我希望这个取决于用户设置是否处于活动状态。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:52:37.587

一种常见的方法是创建一个单例，它首先使用 Context 进行初始化。它包含 SQLiteDatabase，并具有您在应用程序中使用的所有数据特定方法。

因此，从您的 BaseAdapter，您调用 MyDBSingleton.getInstance().getData()

请确保，单例类保留一个 ApplicationContext，而不是对 Activity/Service 的引用，因为这可能导致泄漏......

# javascript - Rails 资产管道如何链接到生产中的特定 .js 文件

> ID：13406797
> 
> 赞同：2
> 
> 时间：2012-11-15T21:47:10.860
> 
> 标签：javascript, ruby-on-rails-3, asset-pipeline

所以我有一个视图，它基本上加载到给定的 .js 文件中，它在本地主机上运行良好，但是当我将它推送到 heroku 时，它就死了。

基本上在我定义的控制器中

> @script = '/assets/script_name.js?body=1'

在我看来

> %script{:src => @script, :type => "text/javascript"}

这会在开发中加载正确的脚本，但在生产中找不到它们

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:56:15.097

在您的控制器中...

```
@script = view_context.asset_path('script_name.js') 
```

如果是我，我会这样做：

控制器：`@script = 'script_name'`

看法：`= javascript_include_tag @script`

# image - 简单的 onclick javascript 滚动条

> ID：13406799
> 
> 赞同：0
> 
> 时间：2012-11-15T21:47:15.137
> 
> 标签：image, scroll

我对目前正在开发的网站有疑问。它在页脚中有一个简单的图像滚动条。问题是如何使用简单的 javascript 使其滚动？我不想要任何花哨的插件，因为它不是那么高级的滚动条。我附上了一张图片。感谢所有花时间回答的人。

![页脚上的滚动条](../Images/ce9d92f42c3424af252272aa93c4aa21.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-01T15:55:48.233

您可以从这里开始：[http ://symmetrycode.com/javascript-horizo​​ntal-scroll-website/](http://symmetrycode.com/javascript-horizontal-scroll-website/)

告诉我它是否不起作用。

# java - 如何在 jxpath 中使用 text()

> ID：13406801
> 
> 赞同：0
> 
> 时间：2012-11-15T21:47:27.477
> 
> 标签：java, text, xpath, jxpath

你能得到一个 jxpath 元素的 text() 还是它不起作用？

给出了一些不错的 xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<AXISWeb xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="AXISWeb.xsd">
    <Action>
    <Transaction>PingPOS</Transaction>
    <PingPOS>
        <PingStep>To POS</PingStep> 
        <PingDate>2012-11-15</PingDate> 
        <PingTime>16:35:57</PingTime> 
    </PingPOS>
    <PingPOS>
        <PingStep>POS.PROCESSOR18</PingStep> 
        <PingDate>2012-11-15</PingDate> 
        <PingTime>16:35:57</PingTime> 
    </PingPOS>
    <PingPOS>
        <PingStep>From POS</PingStep> 
        <PingDate>2012-11-15</PingDate> 
        <PingTime>16:35:57</PingTime> 
    </PingPOS>
</Action>
</AXISWeb> 
```

//不起作用：

```
jxpc.getValue("/AXISWeb/Action/PingPOS[1]/PingStep/text()"); 
```

//不起作用：

```
jxpc.getValue("/action/pingPOS[1]/PingStep/text()"); 
```

//不起作用：

```
jxpc.getValue("/action/pingPOS[1]/PingStep[text()]"); 
```

我知道我可以从使用中获取文本

```
jxpc.getValue("/action/pingPOS[1]/PingStep"); 
```

但这不是重点。不应该`text()`工作吗？我找不到任何例子......

PS 大小写和大小写也很挑剔。你能以某种方式关闭它吗？

谢谢，-G

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:59:53.073

`/AXISWeb/Action/PingPOS[1]/PingStep/text()`是您文档的有效 XPath

但是，从我从 jxpath 的用户指南中可以看到（注意：我根本不知道 jxpath），已经应该返回节点的文本内容，所以你根本`getValue()`不需要使用 XPath `text()`.

因此，您可以使用以下内容：

```
jxpc.getValue("/AXISWeb/Action/PingPOS[1]/PingStep"); 
```

摘自[用户指南](http://commons.apache.org/jxpath/users-guide.html)：

> 考虑以下 XML 文档：
> 
> ```
> <?xml version="1.0" ?>
> <address>
>   <street>Orchard Road</street>
> </address> 
> ```
> 
> 使用相同的 XPath，,`getValue("/address/street")`将返回字符串`"Orchard Road"`，而 `selectSingleNode("/address/street")`- 元素类型的对象（DOM 或 JDOM，取决于所使用的解析器的类型）。返回的 Element 当然是`<street>Orchard Road</street>`.

现在关于标签名称不区分大小写的查询，如果您使用的是 XPath 2，您可以使用`lower-case()`，`node()`但不建议这样做，您最好使用正确的名称。

```
/*[lower-case(node())='axisweb']/*[lower-case(node())='action']/... 
```

或者如果使用 XPath 1，您可以使用`translate()`，但它会变得更糟：

```
/*[translate(node(),'ABCDEFGHIJKLMNOPQRSTUVWXYZ','abcdefghijklmnopqrstuvwxyz') = 'axisweb']/*[translate(node(),'ABCDEFGHIJKLMNOPQRSTUVWXYZ','abcdefghijklmnopqrstuvwxyz') = 'action']/... 
```

总而言之，尽量确保你使用正确的查询，你知道它是区分大小写的，所以最好注意它。就像您在 Java 中所做的那样，`foo`并且`fOo`不是相同的变量。

* * *

**编辑：**

正如我所说，XML 和 XPath 是区分大小写的，因此`pingStep`无法匹配`PingStep`，请使用正确的名称来查找它。

关于`text()`，它是 XPath 1.0 的一部分，XPath 2 不需要使用它。JXPath`getValue()`已经在`text()`为您进行调用。如果你想自己做，你将不得不使用`selectSingleNode("//whatever/text()")`它将返回一个`Object`类型`TextElement`（取决于底层解析器）。

综上所述，该方法`JXPathContext.getValue()`已经为您完成了选择节点文本内容的工作，因此您无需自己完成并显式调用 XPath 的`text()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T20:32:03.690

从我在方法 .getTextContent() 为您完成工作之前回答的帖子中。评估 Xpath 时无需使用“text()”。

例子 ：

```
Document doc = DocumentBuilderFactory.newInstance().newDocumentBuilder().parse(new File("D:\\Loic_Workspace\\Test2\\res\\test.xml"));

    System.out.println(doc.getElementsByTagName("retCode").item(0).getTextContent()); 
```

如果没有，您将获得标签和值。如果你想做更多，看看[这个](http://docs.oracle.com/javase/1.4.2/docs/api/org/w3c/dom/Node.html)

# php - 遍历php中的数组

> ID：13406802
> 
> 赞同：0
> 
> 时间：2012-11-15T21:47:28.703
> 
> 标签：php, arrays, associative-array

> **可能重复：**
> [循环数组数组](https://stackoverflow.com/questions/8055123/loop-an-array-of-array)

所以我知道如何遍历偶数键 => 值（关联）的数组，但是我有一个奇怪的数组，我需要遍历它并打印出值：

```
$object_array = array(
    'type' => 'I am type',
    array(
        'property' => 'value',
        'property_2' => 'value_2'
    )
); 
```

我认为我能做的是：

```
foreach($object as $key=>$vlaue){
   //what now?
} 
```

所以你可以看到我迷路了，我如何穿过下一个阵列？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-15T21:51:39.957

你可以试试：

```
function traverse($array) {
   foreach ($array as $key => $value) {
      if (is_array($value)) {
         traverse($array);
         continue;
      }
      echo $value;
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:50:15.357

尝试：

```
foreach($object_array as $value) {
  if(!is_array($value))
   echo $value;
   else {
    foreach($value as $m)
    echo $m; 
  }
 } 
```

[foreach 手册](http://php.net/manual/en/control-structures.foreach.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T21:51:37.377

在你的 for 循环中，你可以这样做：

```
if(is_array($object[$key]))
    //process inner array here 
```

这取决于你的数组有多深，如果你有数组数组的数组......等等，不同的方法会更好，但如果你只有一个级别，这是一种非常简单的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T21:53:01.810

```
foreach($object as $key=>$value){
    if( is_array($value) ) {
        foreach($value as $key2=>$value2) {
            //stuff happens
        }
    } else {
        //other stuff
    ]
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-15T21:53:14.727

好吧，你可以这样做：

```
foreach($object_array as $key=>$value)
{
    if(is_array($value) {
        foreach($value as $k=>$v) {
            echo $k." - ".$v;
        }
    } else {
        echo $key." - ".$value;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-15T21:54:29.803

一个替代方案[`array_walk_recursive()`](http://php.net/manual/en/function.array-walk-recursive.php)：

```
function mydebug($value, $key) {
    echo $key . ' => ' . $value . PHP_EOL;
}

array_walk_recursive($object_array, 'mydebug'); 
```

如果您使用这些值做一些简单的事情（例如，只是`echo`ing），则很方便。

# jquery - 将数组发送到 AJAX

> ID：13406808
> 
> 赞同：0
> 
> 时间：2012-11-15T21:47:43.103
> 
> 标签：jquery, asp.net, ajax, json

我需要能够在我的 ASP.NET 应用程序中通过 AJAX 将字符串数组和字符串数组的数组传递给 Web 服务。但我不断得到

```
{"Message":"Invalid object passed in, : or } expected. (16): { basicInfo:\"[\"TESTCO\",\"TESTCO\",\"PO BOX 0\",\"My City\",\"MyState\",\"My Zip\",\"MyPhone\",\"TEST1 -  TEST, TEST3 - TEST, \",\"11/15/2012\",\"16:36\",\"myname\",\"1202160021\"]\"}","StackTrace":"   at System.Web.Script.Serialization.JavaScriptObjectDeserializer.DeserializeDictionary(Int32 depth)\r\n   at System.Web.Script.Serialization.JavaScriptObjectDeserializer.DeserializeInternal(Int32 depth)\r\n   at System.Web.Script.Serialization.JavaScriptObjectDeserializer.BasicDeserialize(String input, Int32 depthLimit, JavaScriptSerializer serializer)\r\n   at System.Web.Script.Serialization.JavaScriptSerializer.Deserialize[T](String input)\r\n   at System.Web.Script.Services.RestHandler.ExecuteWebServiceCall(HttpContext context, WebServiceMethodData methodData)","ExceptionType":"System.ArgumentException"} 
```

我对 JSON 和序列化以及所有这些都不是很了解。所以我真的不知道我做错了什么。

```
var cvwOther = new Array();
var equipAssign = new Array();
var qAndA = new Array();
var binfo = new Array(storeinfo[2], storeinfo[6], storeinfo[7], storeinfo[8], storeinfo[9],
                              storeinfo[10], storeinfo[11], storeinfo[12], getToday(), getNow(), userinfo[0], call);

function submitCVW(call) {
      db.transaction(function (tx) {
                    tx.executeSql("Select * From CVWOther Where CallNumber=?", [call], function (tx, result) {
                        var i = 0;
                        $.each(result.rows, function () {
                            cvwOther[i] = result.rows.item(i);
                            i++;
                        });
                    }, onSQLError);
                    tx.executeSql("Select * From EquipAssign Where CallNumber=?", [call], function (tx, result) {
                        var i = 0;
                        $.each(result.rows, function () {
                            equipAssign[i] = result.rows.item(i);
                            i++;
                        });
                    }, onSQLError);
                    tx.executeSql("Select * From CVW Where CallNumber=?", [call], function (tx, result) {
                        var i = 0;
                        $.each(result.rows, function () {
                            qAndA[i] = result.rows.item(i);
                            i++;
                        });

                        $.ajax({
                            type: "POST",
                            dataType: "json",
                            contentType: "application/json",
                            url: "MyService.asmx/CVW",
                            data: '{ basicInfo:"' + JSON.stringify(bInfo) + '", cvwOther:"' + JSON.stringify(cvwOther) + '"}',
                            success: function(data) {
                            },
                            error: function(xhr, status, error) {
                                var err = eval("(" + xhr.responseText + ")");
                                alert(err.Message);
                            }
                        });
                    }, onSQLError);
                });
            } 
```

Web 方法签名

```
[WebMethod]
public void SubmitCVW(string[] basicInfo, string[][] cvwOther) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T00:05:25.473

JSON 和 javascript 文字之间的主要区别在于您的对象属性名称需要被引用：

```
{
    "attr_1" : "whatever", // VALID JSON
    attr_2 : "something"   // INVALID JSON
} 
```

`JSON.stringify()`话虽如此，当您拥有可用的方法时，绝对没有理由需要构建 JSON 字符串。相反，构建您想要编码的数据，然后`stringify()`在其上使用该方法。

```
// Why do this ...
data: '{ basicInfo:"' + JSON.stringify(bInfo) + '", cvwOther:"' + JSON.stringify(cvwOther) + '"}',

// ... when you can do this?
data: JSON.stringify( {basicInfo:bInfo, cvwOther:cvwOther} ); 
```

# opengl - 优化 OpenGL：VAO 与着色器组织

> ID：13406816
> 
> 赞同：2
> 
> 时间：2012-11-15T21:48:19.607
> 
> 标签：opengl, optimization, 3d, glsl, shader

我正在编写一些代码，将一些 3D 模型绘制到屏幕上，最终用于某种 3D 世界。每个模型中都可以包含使用不同着色器进行渲染的网格。在使事情高效运行方面，我知道您应该尽量减少 OpenGL 调用，即那些切换 VAO 和那些切换着色器的调用，因为它们应该有很多开销。

在我的实现中，每个模型都将其几何结构组织成一个 VAO。VAO 可以具有材质设置不同的网格，但不一定是着色器。

**我的问题**：最好是绑定一个 VAO 并一次性完全渲染它，如果需要的话切换着色器，或者绑定一个着色器并运行使用该问题的所有（子集）VAO。第一个是冗余绑定着色器，第二个是冗余绑定 VAO，那么**最小化着色器绑定调用还是 VAO 绑定调用更好？**

我意识到这是相当开放的，似乎它可能取决于应用程序，但是我也很想知道如何找出 gl 操作成本（开销？依赖项？），或者我如何弄清楚它们，因为这将提供必要的信息，以针对任何情况构建适当的响应。此外，如果有更好的方法来组织我的项目，我们将不胜感激。

# jquery - Django 将层次结构建模为邻接列表或嵌套集 - 最佳方式（带过滤）

> ID：13406818
> 
> 赞同：1
> 
> 时间：2012-11-15T21:48:33.910
> 
> 标签：jquery, django, jqgrid, adjacency-list

我的 django 应用程序在数据库中存储了一些分层数据，如下所示：

```
 class Foo(Model):
     # ... fields
     parent = ForeignKey('self', null = True) 
```

现在，为了在 jqGrid Tree 中显示该树数据，我需要将该数据转换为邻接列表或嵌套集，因为 jqGrid 支持这两种方法。

我编写了构建邻接列表的简单函数，如下所示（伪代码）

```
list=[]
def build_list(parent = None, level = 0)
    data = Foo.objects.select_related().filter(parent=parent).annotate(sub_count = Count('foo'))
    for x in objects:
        obj = {
        'name': x.name,
        'id': x.pk,
        'level': level,
        'isLeaf': x.sub_count == 0
        }
    list.append(obj)
    if x.sub_count > 0:
        build_list(x.pk, level + 1) 
```

但是，随着记录数量的增加，我担心这种递归。

有没有更好的方法来做到这一点？

PS。我**无法**更改模型的架构（定义），因为应用程序（和其他服务）的其他部分依赖于当前结构。

PS。2\. 后面的数据库是 Postgres，但如果可能的话，我希望解决方案保持 db-agnostic

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T10:04:03.700

有一种算法用于在 SQL 数据库中存储分层数据。它被称为**修改前序树遍历**。您可以阅读[在数据库中存储分层数据一](http://www.sitepoint.com/hierarchical-data-database/)文了解详细信息。它将允许您在一个查询中选择子树的所有项目。

对于 Django，有一个实现它的应用程序 -[`django-mptt`](https://github.com/django-mptt/django-mptt/)

实际上，您将需要修改数据库，但这将包括添加两个数字列，因此您可以保留`parent`所有其他字段不变

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T22:25:00.777

您可以使用 BFS 来避免内存问题：

未经测试的代码：

```
def example_bfs():
    roots = Foo.objects.filter(parent=None).annotate(sub_count = Count('foo'))
    q = []
    q = list(roots)
    tree = []
    if q:
        iter = q.pop(0)
    else:
        return tree
    while iter:
        dict = {}
        objs = []
        childs = Foo.objects.filter(parent = iter).annotate(sub_count = Count('foo'))
        for x in childs:
            obj ={}
            objs.append(obj)
        dict[iter] = objs
        tree.append(dict)
        q += list(childs)
        level += 1 
        try:
            iter = q.pop(0)
        except:
            return tree
    return tree 
```

# sql - 查询零件的所有可能子零件

> ID：13406819
> 
> 赞同：0
> 
> 时间：2012-11-15T21:48:37.083
> 
> 标签：sql, ms-access

我在 Access 数据库中有两个表，一个包含部分和子部分，另一个用于存储这些部分之间的关​​系。零件关系表有一个用于父零件的字段和另一个用于子零件的字段。使用这两个表，我可以拥有带有子部件的子部件、关联多个父部件的子部件，以及（显然）带有多个子部件的父部件。

我希望能够做的是，仅使用一条 SQL 语句，即可调出单个父部件的所有子部件（及其所有子部件）。有没有办法做到这一点，而不限制查询可以绘制的子部分的深度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:50:41.970

据我所知，您必须在 VBA 中执行此操作。

此外，如果您现有的零件表中有一个“parentPartID”，您可能只有一个表。如果没有父级，则值为 null。

# css - 在 div 中居中嵌入 pdf

> ID：13406823
> 
> 赞同：1
> 
> 时间：2012-11-15T21:48:58.527
> 
> 标签：css

在 div 中居中嵌入 pdf 有点麻烦。

这是我的 HTML 代码片段。

```
<div id="splash">
    <div class="post">
    <h2>Heading </h2>
        <p><embed src="images/dop.pdf" ALIGN=CENTER width="820" height="375"></p>
    </div>
</div> 
```

这是我的 style.css 文件中的相关 CSS：

```
#splash {
padding: 40px;
position: relative;
background: #FFF;
margin: 20px 0 0 0;
height: 300px;
width: 1100px;
box-shadow: 0px 0px 5px 0px rgba(0,0,0,0.25);
}

.post {

margin-left: auto ;
margin-right: auto ;
}

p {
margin-bottom: 1.75em;
margin-left: auto ;
margin-right: auto ;    
} 
```

据我所知，将 margin-left 和 margin-right 设置为 auto 应该将`post`类或`<p>`标签中的 div 中的内容居中。那么为什么 .pdf 留在左边呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:50:49.097

给你`<div class="post">`一个明确的宽度。

例如：

```
.post {
width: 820px;
margin-left: auto ;
margin-right: auto ;
} 
```

仅当宽度小于父元素的 100% 时，将左右边距设置为 auto 才有效。否则，作为块元素， div 将扩展到最大可能的宽度。另请注意，它`ALIGN=CENTER`已过时且已弃用，不应使用。

**[jsFiddle 示例](http://jsfiddle.net/j08691/YYL7C/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:58:17.610

内部`<div>`( `post`) 需要一个`width`. 否则它将填充 100% 的周围元素 ( `splash`)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T21:59:10.883

如果您的元素具有 100% 的宽度，则将两侧边距设置为 auto 不会做任何事情，就像所有`div`s 默认情况下所做的那样。如果指定宽度，则*剩余*的水平空间将被左右边距平均分割。例子：

```
.post { width: 500px; margin-left: auto; margin-right: auto; } 
```

请注意，`p`出于同样的原因，您的自动边距可能无法正常工作；您可能会删除该规范。

# ios - 这些设置在 Interface Builder 中有什么作用？

> ID：13406828
> 
> 赞同：2
> 
> 时间：2012-11-15T21:49:13.473
> 
> 标签：ios, xcode, interface-builder

![有问题的设置](../Images/a4366f40ec17da37fae20d0ca070f245.png)

这是一个`UIButton`专门的。我知道对齐选项与 中的标签有关`UIButton`，但是“内容”设置有什么作用？它们似乎对应于类的`setEnabled:`, `setSelected:`,`setHighlighted:`方法`UIButton`，但是单击 Highlighted 或 Selected 似乎不会改变按钮在界面构建器之外的行为。此外，让按钮始终显示为突出显示或选中的用例是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-21T21:44:41.900

这些方法有几个实际用途。作为@MHUMobileInc。指出，它可以用于像扫雷这样的游戏。它还可以让您将按钮用作一种开关，其中选定的按钮为“ON”，未选定的版本为“OFF”。Apple 似乎希望开发人员回避这一点，并使用 UISwitches 或自定义视图。但是，Apple[在其某些应用程序中确实自相矛盾](http://uxcritique.tumblr.com)。

这些设置设置了 UIButton的*初始*`viewDidLoad`状态 - 因此，如果您将其设置为未选中或未突出显示，则在运行应用程序时将不会在屏幕上看到此 Interface Builder 设置。如果您想确保保留这些设置，在代码 ( `viewDidLoad`) 中而不是在 Interface Builder 中这样说可能更容易。

不要过多地使用这些设置可能更容易。它们可能会导致您（开发人员）、从事该项目的其他程序员（如果有）和用户感到困惑。在工作时使用内置的 UIKit 视图，并在没有最适合这种情况的情况下创建自己的子类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-22T00:22:07.283

上半部分处理视图内内容的对齐方式。例如，如果您有一个较大的 UIButton，其图像小于按钮的边界，则默认情况下，图像将在按钮内垂直和水平居中。但是，如果您希望图像拥抱左/右/上/下，您可以使用这些选项设置对齐方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-22T01:51:29.740

所有这些控件都与 UIControl 相关，而不是 UIButton，如该屏幕截图中的标题所示。

对齐是指`contentHorizontalAlignment`和`contentVerticalAlignment`。许多控件从`sizeThatFits:`. 例如，`UISwitch`对象具有固定大小，而`UISlider`对象具有固定高度。如果将框架分配给与这些固定尺寸不对应的控件对象，则这些属性将确定应在该框架中的何处绘制控件界面。的实例`UIButton`确实填充了它们的框架，因此`UIButton`类以不同的方式解释这些属性以应用于按钮的内容，但属性本身并不特定于`UIButton`类。

同样`selected`，`highlighted`和`enabled`属性由`UIControl`not定义`UIButton`，并非所有子类都`UIControl`使用它们。

# jquery - 使用 AJAX 将数据返回到变量中

> ID：13406840
> 
> 赞同：0
> 
> 时间：2012-11-15T21:49:52.237
> 
> 标签：jquery, ajax, json

我有一个简单的 AJAX 调用，它正在查询 Twitter API 以返回 URL 被推文的次数。我正在尝试将该返回值与来自其他社交网络的类似 AJAX 调用一起设置。然后我想将所有值加在一起以获得将在 HTML 页面中使用的“共享”总数。

这是我正在尝试使用我的代码：

```
var twitter = $.ajax({
        dataType: 'jsonp',
        url: 'http://cdn.api.twitter.com/1/urls/count.json',
        data: { url: shareUrl},
        async: 'false',
        success: function(data) {
            return data.count;
        }
    }); 
```

我的目标是运行一个简单的数学函数，如下所示：

```
var total = twitter + facebook; 
```

然后将该总数输出到 DOM 元素。

当我运行 console.log(twitter); 我得到了一个对象的就绪状态，但是如果我在成功函数中运行计数的 console.log，我得到的数字是正确的。因为这将是一个非常轻量级的页面集'async: false'希望它会返回值然后继续下一个函数。但无论我尝试什么，我都无法从 AJAX 函数中获得价值。我哪里出错了或者我需要修改什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:00:26.400

这是在 jQuery 中使用延迟的完美示例。使用 deferreds，您可以创建将在一系列异步操作完成后调用的回调（而不仅仅是通常的回调）。

然后您可以计算来自“内部”回调的结果总数

编辑：现在没有全局变量更优雅！

```
function Twitter() {
   var dfd = $.Deferred();
   $.ajax({
      ...
      success: function(data) {
         dfd.resolve(data.count);
      }
   });
   return dfd.promise();
}

function Facebook() {
   var dfd = $.Deferred();
   $.ajax({
      ...
      success: function(data) {
         dfd.resolve(data.count);
      }
   });
   return dfd.promise();
}

$.when(Twitter(), Facebook()).then(function(twitter, facebook) {
   alert('The total is ' + (twitter+facebook));
} 
```

# for-loop - 为什么在重新排列 doc 文件段落时出现 Array Index Out Of Bound 异常？

> ID：13406842
> 
> 赞同：0
> 
> 时间：2012-11-15T21:49:57.103
> 
> 标签：for-loop, ms-word, doc, indexoutofboundsexception

这是一个代码片段。它给出了arrayindexoutofboundexception。不知道为什么？

```
import java.io.File;
import java.io.FileInputStream;
import org.apache.poi.hwpf.HWPFDocument;
import org.apache.poi.hwpf.extractor.WordExtractor;
import org.apache.poi.xslf.usermodel.XSLFTextParagraph;

public class wordcount 
{
public static void main(String[] args) throws Exception
{

        File file = new File("E:\\myFiles\\abc.doc");
        FileInputStream fis=new FileInputStream(file.getAbsolutePath());
        HWPFDocument document=new HWPFDocument(fis);
        WordExtractor extractor = new WordExtractor(document);
        String [] fileData = extractor.getParagraphText();

        for (int i = 0; i < fileData.length; i++)
            {  

               // System.out.println(fileData[i].toString());
                String[] paraword = fileData[i].toString().split(" ");
               // out.println(paraword.length);

                if(paraword[i].length() == 0 )
                {
                    System.out.println("\n");
                }
                else if(paraword[i].length() > 0 && paraword[i].length() < 12)
                {
                    for(int k=0 ; k < paraword[i].length()-1 ; k++)
                    {
                       System.out.println(paraword[k].toString());
                    }
                }
                else if(paraword[i].length() >= 12  )
                {
                    for(int k=0 ; k < 12 ; k++)
                    {
                       System.out.println(paraword[k].toString());
                    }
                }

               System.out.println("\n");

            }

}
} 
```

这是 abc.doc 文件的图像

![这是 abc.doc](../Images/df2159bd1fdb78e9f6ee2b922c2434a2.png)

注意：预期的输出将打印在 java 控制台上。

并且输出将在每行中包含 12 个单词。但是在执行第一行之后，就会发生错误。

任何帮助，将不胜感激

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:51:49.510

老实说，我不熟悉 apache.org API，但仅通过查看您的逻辑，您似乎想要替换以下每个实例：

`paraword[i].length()`

和：

```
paraword.length 
```

因为看起来您想检查段落中有多少单词，而不是段落的第一个单词有多长。如果我错了，请纠正我，但我认为这会解决你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T16:48:49.343

这是正确的代码片段

```
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import org.apache.poi.hwpf.HWPFDocument;
import org.apache.poi.hwpf.extractor.WordExtractor;

public class ExtractWordDocument
{
public String myString() throws IOException
  {
      File file = new File("PATH FOR THE .doc FILE");
        FileInputStream fis=new FileInputStream(file.getAbsolutePath());
        HWPFDocument document=new HWPFDocument(fis);
        WordExtractor extractor = new WordExtractor(document);
        String [] fileData = extractor.getParagraphText();

        ArrayList<Object> EntireDoc = new ArrayList<>();

        for (int i = 0; i < fileData.length; i++)
            {  
                String[] paraword = fileData[i].toString().split("\\s+");
                if(paraword.length == 0 )
                    {EntireDoc.add("\n");}
                else if(paraword.length > 0 && paraword.length < 12)
                    {
                    for(int k=0 ; k < paraword.length ; k++)
                        {EntireDoc.add(paraword[k].toString()+" ");}
                    }
                else if(paraword.length > 12  )
                    {
                    java.util.List<String> arrAsList = Arrays.asList(paraword);
                    String formatedString = arrAsList.toString()
                                             .replace(",", "")  //remove the commas
                                             .replace("[", "")   //remove the right bracket
                                             .replace("]", ""); //remove the left bracket

                     StringBuilder sb = new StringBuilder(formatedString);
                     int i1 = 0;
                     while ((i1 = sb.indexOf(" ", i1 + 75)) != -1)
                        {sb.replace(i1, i1 + 1, "\n");}
                     EntireDoc.add(sb.toString());
                    }

               EntireDoc.add("\n");
             }

            String formatedString = EntireDoc.toString()
                                             .replace(",", "")  //remove the commas
                                             .replace("[", "")   //remove the right bracket
                                             .replace("]", ""); //remove the left bracket

        return formatedString;
  }

public static void main(String[] args)
{
    try{
    System.out.print(new ExtractWordDocument().myString());
    }
    catch(IOException ioe){System.out.print(ioe);}

}

} 
```

注意：此代码不会在每行打印 12 个单词，而是在每行打印 75 个字符。

# ruby-on-rails - 在 rails 3 上使用 link_to 的更好方法

> ID：13406847
> 
> 赞同：0
> 
> 时间：2012-11-15T21:50:14.220
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我需要使用这个 gem [https://github.com/potatosalad/mongoid-data_table](https://github.com/potatosalad/mongoid-data_table)。

这是我的模型代码：

```
class Admin
  include Mongoid::Document
  include Mongoid::Timestamps::Created
  include Mongoid::DataTable
  #datatableblock
  ## data_table ##
  data_table_options.merge!({
    :fields => %w(id email created_at role actions),
    :searchable => %w(email role),
    :dataset => lambda do |admin|
      {
        0 => "<%= check_box_tag \"admin_ids[]\", admin._id, false, :class => \"check\" %>",
        1 => admin.id,
        2 => "<%= link_to(admin.email, admin_admin_path(admin._id)) %>",
        3 => admin.created_at,
        4 => admin.role,
        5 => "<%= link_to(I18n.t('admin.actions.show'), admin_admin_path(admin._id)) %> - <%= link_to(I18n.t('admin.actions.edit'), edit_admin_admin_path(admin._id)) %> - <%= link_to I18n.t('admin.actions.delete'), admin_admin_path(admin._id)%>",
        :DT_RowId => admin._id
      }
    end
  })
end 
```

我知道这个动作可能违反了模型-视图-控制器架构的某些原则。

我需要使用`link_to`和 ruby​​ on rails 代码在每列中生成正确的内容。

**那么我的问题是：如何在不违反MVC原则的情况下以更好的方式做到这一点？**

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:16:01.777

如果它要破坏 MVC，也许最好的办法是将它放入 /lib 文件夹中的一个模块中，并将其作为包含而不是与其余代码内联加载。这也将有助于为您的模型承担一项责任。也许是这样的？

```
class Admin
  include Admin::CustomDatatable
end

module Admin
  module CustomDataTable
    data_table_options.merge!({
      :fields => %w(id email created_at role actions),
      :searchable => %w(email role),
       :dataset => lambda do |admin|
         {
           0 => "<%= check_box_tag \"admin_ids[]\", admin._id, false, :class => \"check\" %>",
           1 => admin.id,
           2 => "<%= link_to(admin.email, admin_admin_path(admin._id)) %>",
           3 => admin.created_at,
           4 => admin.role,
           5 => "<%= link_to(I18n.t('admin.actions.show'), admin_admin_path(admin._id)) %> - <%= link_to(I18n.t('admin.actions.edit'), edit_admin_admin_path(admin._id)) %> - <%= link_to I18n.t('admin.actions.delete'), admin_admin_path(admin._id)%>",
    :DT_RowId => admin._id
         }
      end
    })
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T09:29:19.840

该 gem 是一个专门的用例，如果您不想向应用程序添加另一个类或层，它可能是合适的，但它确实违反了 MVC。

该 gem 尝试做的正确实现（imo）是[Presenter Pattern](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93presenter#Pattern_description)。

Rails 有很多 gem 实现了相同的功能。基本上，这段代码应该在自定义类中，而不是在模型文件中。

观看Ryan Bates 的[这个 railscast](http://railscasts.com/episodes/340-datatables)以清楚地了解如何在没有任何宝石的情况下做到这一点，更重要的是在 MVC 中添加演示者。

当您将演示器、装饰器或其他设计模式与 MVC 结合使用时，它们不应该也不通常违反核心架构。

# html - 如何让这个动态链接打开新标签？

> ID：13406850
> 
> 赞同：0
> 
> 时间：2012-11-15T21:50:33.733
> 
> 标签：html, hyperlink

```
 <a style="text-decoration:underline;" href="https://mydomain.com/register/<?php echo $locat?>">CONTINUE BROWSING &raquo;</a> 
```

嘿伙计们，我有 3 种不同的注册用户类型，它们都进入了我的“付款页面”，在那里我显示了 3 个不同的包..

我有其中一个继续浏览链接，但如果用户点击他们无法返回，因为唯一令牌过期......

我希望这个链接在他们点击它时打开一个新的标签或页面在线，但是当我尝试这样做时，它一直在页面上导致错误。/

任何提示，对于这个简单的问题，我很抱歉，但我很感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:52:51.473

```
<a target="_blank" href="https://yourwebsite.com/">link name</a> 
```

或者您可以使用并在文档加载后将`<a rel="ext" href="external website>link name</a>`脚本添加`target="_blank"`到所有锚点。`rel="ext"`

例子：

```
<script type="text/javascript" src="jquery-1.8.2.min.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    $(document).find('a[rel="ext"]').attr("target", "_blank");
  });
</script>
...
<body>
   <a rel="ext" href="some website">some name</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-17T00:32:31.597

如果再次单击链接，使用 `<a target="blank" href="yourlink">link name</a>` 因为`blank`而不是`_blank`将强制浏览器打开相同的选项卡，这对我来说非常好。所以试试看

# python - 'int' 对象在调用函数时不可调用

> ID：13406859
> 
> 赞同：1
> 
> 时间：2012-11-15T21:51:00.997
> 
> 标签：python, int, callable, dice

我是一名业余程序员，正在开发控制台骰子滚轮，比传统的滚轮要复杂得多。到目前为止，我在使用此功能时遇到了问题：

```
 def multiRoll(dice, amount):
        total = 0
        rolls = []
    for roll in range(amount):
        rolls += roll(dice)
    total = sum(rolls)
    return total, rolls 
```

它*旨在*从描述骰子种类（4、6、8 面等）的字典中获取单个条目及其索引和掷骰子的时间。然后它会根据需要掷骰子，然后将每个结果添加到一个列表中，稍后将对其进行汇总。

但显然通量出错了，当它到达这条线时：

```
 rolls += roll(dice) 
```

我得到**'int' object is not callable**。

你能告诉我如何克服这个吗？

如果你对 roll() 函数有任何疑问，这里是：

```
def roll(dice):
    if dice < 1:
            print "I found a problem when trying to roll a d%d" % (dice)
            return "Failed"
    else:
            return randrange(1, dice) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:53:09.353

```
for roll in range(amount):
        rolls += roll(dice) 
```

不是使用您的`roll(dice)`函数，而是使用循环的`roll`变量。`for`您应该将循环的变量更改为：

```
for number in range(amount):
    rolls += roll(dice) 
```

或类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:53:17.163

您已重新分配`roll`到

```
for roll in range(amount):
        rolls += roll(dice) 
```

用另一个变量名替换它：

```
for r in range(amount):
        rolls += roll(dice) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T21:54:20.230

在此行中：

```
for roll in range(amount):
    rolls += roll(dice) 
```

您正在创建一个名为的局部变量`roll`，它会覆盖`roll`您在程序中定义的函数。
您需要做的是更改函数名称或局部变量名称，以使它们不相同。

# php - PDO_MYSQL：一般错误 2014

> ID：13406862
> 
> 赞同：2
> 
> 时间：2012-11-15T21:51:19.923
> 
> 标签：php, mysql, pdo

我正在从普通的 mysql_* 迁移到 PDO（是的，我知道日历上是 2012 年）。
我正在编写一个简单的包装类，以便有机会在我的网站上执行 $f=$db->FetchAll("SELECT * FROM...") 之类的操作。这就是我正在做的事情：

```
 public function Query($q, $errmessage="", $params=array()) {
    try {
    $stmt=$this->connect->prepare($q);
    if (is_array($params) && count($params)>0) {
    $stmt->execute($params);
    } else {
    $stmt->execute();
    }
    return $stmt;
    } catch(PDOException $e) {
    die($errmessage.": ".$e->GetMessage());
    }
    }

   public function Fetch($q, $arraylist=0) {
    if (!is_object($q)) { // Assuming it's a raw query
    $stmt=$this->Query($q, "Unable to process the query for fetching");
    } else $result=$q;
    $f=$stmt->Fetch();
    return $f;
} 
```

这会引发“一般错误 2014”异常。
任何帮助表示赞赏。
谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:57:29.647

`2014`不是年份，是错误代码。下次尝试[谷歌搜索错误。](https://www.google.ca/search?q=pdo%20%22general%20error%202014%22)

> $pdo->query("INSERT INTO `test`(some) VALUES ('1111111111111111'), ('1111111111111'); -- 我是一条 SQL 评论，删除我将解决这个问题");
> 
> 因为 ”;” 这是一个多语句，执行两个查询，而第二个只是一个注释。可以使用 PDOStatement->nextRowset 访问第二个“结果”。[[资源]](https://bugs.php.net/bug.php?id=47504)

或者：

> 在花了几个小时试图找出我们在新服务器上出现此错误的原因之后，在相同的代码在其他服务器上运行良好之后，我们发现问题出在我们的 Web 服务器上运行的旧 MySQL*客户端*库和最新版本MySQL*服务器*运行在数据库服务器的盒子上。[[资源]](http://php.net/manual/en/ref.pdo-mysql.php)

# ruby-on-rails - Capistrano：每个角色一个任务，每个服务器多个角色

> ID：13406872
> 
> 赞同：2
> 
> 时间：2012-11-15T21:52:06.600
> 
> 标签：ruby-on-rails, capistrano

我有一个有两个角色的服务器：

```
server "server1.example.com", :web, :worker 
```

以及每个角色不同的任务：

```
task :start, roles: :web do
  # start the webapp...
end

task :start, roles: :worker do
  # start the worker...
end 
```

在此示例中，我希望两个任务都在 server1.example.com 上运行，但似乎只执行了第一个任务。

我意识到我可以将这两项任务结合起来，但这种方式似乎更具前瞻性。

有没有办法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-11T19:29:22.757

你试过了吗：

```
role :worker, 'my_server'
role :web, 'my_server', :primary => true 
```

它不是很好的答案，但请尝试一下。

# python - 在python中将字典字典写入csv

> ID：13406875
> 
> 赞同：3
> 
> 时间：2012-11-15T21:52:25.513
> 
> 标签：python, csv, dictionary

我有一本字典，我想写到 csv 中。我的字典看起来像：

```
dict={
    object1:
        {
            time1:[value1,value2],
            time2:[value3,value4]
        },
    object2:
        {
            time1:[value5,value6],time2[value7,value8]
        }
    } 
```

我希望它写成：

**对象1**

时间1，价值1，价值2

时间 2，值 3，值 4

**对象2**

时间1，价值5，价值6

时间 2，值 7，值 8

到目前为止，我只能弄清楚如何使用以下代码将键/值对写出 csv：

```
writer = csv.writer(open('test.csv','wb'))
for key, value in Dict.items():
    writer.writerow([key,value]) 
```

所以它看起来像：

```
objcet1,{
    time1:[value1,value2],time2:[value3,value4]
}

objcet2,{
    time1:[value5,value6],time2:[value7,value8]
} 
```

我尝试使用仅编写外部键（标记为 object1 和 object2 的键）

```
writer = csv.writer(open('test.csv','wb'))
for key, value in Dict.key():
    writer.writerow([key]) 
```

但它只是写出一个空白文件。我想如果我能弄清楚如何自己写外键，我就可以随心所欲地写出 csv。有没有人有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-11-01T22:51:57.463

我个人推荐使用 Excel，我一直在处理 .csv 文件，但最终使用了 .xlsx。

```
import xlsxwriter
workbook = xlsxwriter.Workbook('File.xlsx')
worksheet = workbook.add_worksheet()                            
row = 0
col = 0
for key in dictionary.keys():
    row += 1
    worksheet.write(row, col, key)
    for item in dictionary[key]:
        worksheet.write(row, col + 1, item)
        worksheet.write(row, col + 2, dictionary[key][item][0])
        row += 1

workbook.close() 
```

在那里您可以更改列和行增量，以便获得所需的 Excel 表。您甚至可以在之后从 Excel 将其导出为 .csv 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T22:08:19.783

尝试这个：

```
import csv

writer = csv.writer(open('test.csv','wb'))
d={'object1':{'time1':['value1','value2'],'time2':['value3','value4']},
   'object2':{'time1':['value5','value6'],'time2':['value7','value8']}}
for key, value in d.iteritems():
    ln = [key]
    for ik, iv in value.iteritems():
        ln.append(ik)
        ln.extend([v for v in iv])
    writer.writerow(ln) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T22:01:31.510

您预期的输出格式看起来非常令人惊讶，并且看起来不像是合理的 csv 格式。

但是，这将导致您似乎正在寻找什么：

```
>>> mydict = {'object1':{'time1':['value1','value2'],'time 2':['value3','value4']},'object2':{'time1':['value5','value6'],'time2':['value7','value8']}}

>>> print "\n".join(["%s %s " % (k, " ".join([", ".join([k1]+v1) for (k1,v1) in v.iteritems()])) for (k,v) in mydict.iteritems()])

object1 time1, value1, value2 time2, value3, value4 
object2 time1, value5, value6 time2, value7, value8 
```

# java - 使用 ARCReader 从 arc 文件（commoncrawl 数据集）中读取

> ID：13406877
> 
> 赞同：1
> 
> 时间：2012-11-15T21:52:26.367
> 
> 标签：java, web-crawler, heritrix

好吧，这个问题听起来可能很愚蠢，但我做了几个小时的研究来找到解决方案，但如果有人知道，我做不到，那太好了！！！

我成功读取了 arc 文件（来自 commoncrawl 数据集）。随着`arcHeader.getUrl();`我得到所有的网址。但是我不明白，是否存在来自该特定 URL 的“传出”链接，如果存在，如何获取这些链接？

[PS] 通过“传出”，我的意思是，在整个页面中，它包含哪个 URL，例如广告、内容等。该 commoncrawl arc 文件是否包含，如果是，如何获取这些？

提前致谢！

编辑：我解决了这个问题，阅读了 HTML 内容并得到了所有！没那么难！

# jquery - 任何滑块交叉淡入淡出不起作用

> ID：13406884
> 
> 赞同：1
> 
> 时间：2012-11-15T21:52:52.720
> 
> 标签：jquery, fade, anythingslider

我正在为客户站点使用 AnySlider。最新版本的任何滑块 (1.8.x) 现在应该会交叉淡入幻灯片。但由于某种原因，它只是不工作。它仍然像旧版本一样：淡出幻灯片，然后弹出新幻灯片。非常令人沮丧。我猜这一定是我的某些设置不正确，但对于我的生活，我无法分辨是什么。头发。拉。出去。

我的初始化代码是：

```
 $('#slider').anythingSlider({
    mode                : 'fade',
    resizeContents      : false,
    delay               : 6000, 
    resumeDelay         : 5000,
    navigationSize      : 5,
    buildStartStop      : false,
    hashTags            : false,
    autoPlay            : true
    }); 
```

您可以在这里查看测试站点：http: [//mlkchapel.dandelion-patch.com/test.html](http://mlkchapel.dandelion-patch.com/test.html)

关于交叉淡入淡出为什么不起作用的任何想法？我很感激任何见解！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T15:01:49.570

在 github 存储库中报告了类似的[问题。](https://github.com/CSS-Tricks/AnythingSlider/issues/447)基本上，当滑块包含在具有背景颜色/图像的定位（相对或绝对）元素中时，就会出现此问题。

只需更改css中的这两行即可修复它。

```
.anythingSlider .fade .activePage { z-index: 1; }
.anythingSlider .fade .panel { z-index: 0; } 
```

`.panel`以前是用`-1`z-index设置的。

# java - 使用 Hibernate 作为库

> ID：13406887
> 
> 赞同：2
> 
> 时间：2012-11-15T21:53:03.390
> 
> 标签：java, hibernate, hibernate.cfg.xml

我有一个 jar 库，其中包含一些带有持久性注释的类。我的 jar 库中不需要 hibernate.cfg.xml，所以我在导入 jar 的目标项目中创建 hibernate.cfg.xml。我猜这个 hibernate.cfg.xml 使用像 any.hbm.xml 一样的配置文件，在 jar 中指定类（ any.hbm.xml 存在于 jar 库）库中（我猜这个解决方案`<mapping resource="any.hbm.xml"/>`在目标项目的 hibernate.cfg.xml 中）。如何为jar库编写any.hbm.xml以及如何在hibernate.cfg.xml中使用它？

我写这个any.hbm.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC
"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
    <mapping class="com.test.Vehicle"/>
    <mapping class="com.test.driver"/>  
</hibernate-mapping> 
```

和这个错误：

```
Caused by: org.hibernate.InvalidMappingException: Unable to read XML
    at org.hibernate.internal.util.xml.MappingReader.readMappingDocument(MappingReader.java:109)
    at org.hibernate.cfg.Configuration.add(Configuration.java:478)
    at org.hibernate.cfg.Configuration.add(Configuration.java:474)
    at org.hibernate.cfg.Configuration.add(Configuration.java:647)
    at org.hibernate.cfg.Configuration.addResource(Configuration.java:730)
    at org.hibernate.cfg.Configuration.parseMappingElement(Configuration.java:2109)
    at org.hibernate.cfg.Configuration.parseSessionFactory(Configuration.java:2081)
    at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:2061)
    at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:2014)
    at org.hibernate.cfg.Configuration.configure(Configuration.java:1929)
    at org.hibernate.cfg.Configuration.configure(Configuration.java:1908)
    at ir.mersada.db.HibernateUtil.<clinit>(HibernateUtil.java:22)
    ... 1 more
Caused by: org.xml.sax.SAXParseException; lineNumber: 6; columnNumber: 50; Element type "mapping" must be declared.
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:198)
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.error(ErrorHandlerWrapper.java:134)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:437)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:368)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:325)
    at com.sun.org.apache.xerces.internal.impl.dtd.XMLDTDValidator.handleStartElement(XMLDTDValidator.java:1906)
    at com.sun.org.apache.xerces.internal.impl.dtd.XMLDTDValidator.emptyElement(XMLDTDValidator.java:763)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanStartElement(XMLNSDocumentScannerImpl.java:353)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2717)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:607)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(XMLNSDocumentScannerImpl.java:116)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:489)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:835)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:764)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:123)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1210)
    at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:568)
    at org.dom4j.io.SAXReader.read(SAXReader.java:465)
    at org.hibernate.internal.util.xml.MappingReader.readMappingDocument(MappingReader.java:78)
    ... 12 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T22:18:06.200

我认为persistence.xml 是一个更好的选择。

```
<persistence xsi:schemaLocation="http://java.sun.com/xml/ns/persistence  http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd" version="1.0">
    <persistence-unit name="UNIT_NAME" transaction-type="RESOURCE_LOCAL">
        <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
        <class>com.test.Vehicle</class> 
        <class>com.test.driver</class>
        <properties/>
    </persistence-unit>
</persistence> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T10:08:08.853

SaxParser 给出了明确的答案：映射元素无效。

但我很困惑。如果您使用注释并且项目中不需要 cfg.xml，那么如果您不使用 cfg.xml，那么简单的方法。

# slickgrid - 有没有办法使用 SlickGrid 强制刷新单行？

> ID：13406893
> 
> 赞同：5
> 
> 时间：2012-11-15T21:53:22.203
> 
> 标签：slickgrid

我将惊人的[SlickGrid](https://github.com/mleibman/SlickGrid)配置为异步访问数据并将用户更改异步发布回服务器。一般而言，服务器可能会根据用户的更改修改一行的几个字段。因此，在更新行后，我希望 SlickGrid 仅刷新该行而不更改视图的其余部分。

有谁知道如何做到这一点？

在我的例子中，服务器上更改的字段是与数据库触发器更新的记录相关联的时间戳。如果时间戳过期，则用户拥有旧的数据副本，如果他们提交更改，则可能会覆盖新副本。由于我找不到触发刷新的方法，用户无法在不刷新浏览器窗口的情况下修改自己的更改（强制完全刷新）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-19T10:52:13.820

您应该可以使用 `grid.invalidateRow()`and来执行此操作`grid.render()`。SlickGrid 将重新渲染受影响的行（假设它们显示在当前可见的视口中）而不刷新整个页面。

```
// Mark row 42 as changed and re-render the display
grid.invalidateRow(42);
grid.render(); 
```

例如，请查看[SlickGrid 示例 14](http://mleibman.github.com/SlickGrid/examples/example14-highlighting.html)。（单击“*开始模拟*”按钮以查看它的实际效果）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-17T17:23:01.287

```
function updateSlickgrid() {
    dataView.setItems(tableName); 
    grid.invalidate();
} 
```

**注意**：**tableName**可以是数组或 id 等。我更喜欢将所有 slickgrid 数据存储在**数组**ex`tableName = [];`

在 slickgrid 中显示数据时继续使用上述功能

# google-apps-script - 用脚本替换单元格的公式

> ID：13406894
> 
> 赞同：0
> 
> 时间：2012-11-15T21:53:30.697
> 
> 标签：google-apps-script

我正在尝试替换电子表格单元格 D3 中公式的某些部分，但我似乎做不到。D3 中的公式很长，但我只需要将 searchtext 变量替换为 replacetext 变量即可。有任何想法吗？这是我的代码。

```
function dashboards(){ 

var ss1 = SpreadsheetApp.getActiveSpreadsheet();
var origSheet1 = ss1.getSheetByName('Daily');
var searchtext = Browser.inputBox("Enter search text");
var replacetext = Browser.inputBox("Enter replace text");
var form = origSheet1.getRange("D3").getFormulaR1C1();
form.indexof(searchtext);
var updated = form.replace(searchtext, replacetext);
form.setFormula(updated);} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:12:17.640

你不远了。问题在于`form`，下面是一个字符串，而不是对您的 Range 的引用。

```
var form = origSheet1.getRange("D3").getFormulaR1C1(); 
```

你可以通过插入看到这个

```
Logger.log(form + "; type: " + typeof form); //String 
```

在该行之后并检查脚本编辑器中的日志。

你只需要改变

```
form.setFormula(updated); 
```

到

```
origSheet1.getRange("D3").setFormulaR1C1(updated); 
```

更新实际范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T22:13:36.247

复制下面的代码并通过脚本管理器或菜单项运行它。

它适用于所选范围的任何内容，无论是单个单元格还是延伸到多行和多列。

它会弹出一条 toast 消息，告诉您该过程何时完成，但它会使 UiInstance 保持打开状态，以防您想要进行更多替换。

您可以保持打开状态并在多个选择的公式中执行多个搜索/替换，或者在不同的工作表上执行相同的搜索。

```
function handySRF() { // script composed by ailish@ahrosters.com
  var ss = SpreadsheetApp.getActive();
  var app = UiApp.createApplication().setHeight(200).setWidth(270).setTitle('Search and Replace In Formulas');

  var panel = app.createAbsolutePanel().setId('panel').setHeight(198).setWidth(268)
      .setStyleAttribute('background', 'lightCyan');

  var lblSearch = app.createLabel('Search for:').setId('lblSearch');
  var txtSearch = app.createTextBox().setId('txtSearch').setName('txtSearch');

  var lblReplace = app.createLabel('Replace with:').setId('lblReplace');
  var txtReplace = app.createTextBox().setId('txtReplace').setName('txtReplace');

  var handler = app.createServerHandler('btnStartSearch'); 
  var btnStartSearch = app.createButton('Start Search').addClickHandler(handler)
      .setStyleAttribute('background', 'lightGreen');
  handler.addCallbackElement(panel);

  var handler2 = app.createServerHandler('btnCloseWindow'); 
  var btnCloseWindow = app.createButton('Close Window').addClickHandler(handler2)
      .setStyleAttribute('background', 'lightYellow');
  handler2.addCallbackElement(panel);

  panel.add(lblSearch, 10, 6)
  panel.add(txtSearch, 10, 33)
  panel.add(lblReplace, 10, 75)
  panel.add(txtReplace, 10, 100)
  panel.add(btnStartSearch, 10, 151)
  panel.add(btnCloseWindow, 130, 151)
  app.add(panel);
  ss.show(app);
};

function btnStartSearch(e) {
  var ss = SpreadsheetApp.getActive();
  var app = UiApp.getActiveApplication();

  var search = e.parameter.txtSearch;
  var replace = e.parameter.txtReplace;

  var rows = ss.getActiveSelection();
  var numRows = rows.getNumRows();
  var formulas = rows.getFormulas();
  var newFormulas = [];

  for (var i = 0; i <= numRows - 1; i++) {
    var oldData = formulas[i];
    var newData = [];
    for (var j=0; j<oldData.length; ++j) {
        var item = oldData[j].replace(new RegExp(search, "g"), replace);
        newData.push(item);
    }
    newFormulas.push(newData);
  }
  rows.setFormulas(newFormulas);
  var str = 'Finished replacing ' + search + ' with ' + replace;
  ss.toast(str, '', 2);
};

function btnCloseWindow(e) {
  var ss = SpreadsheetApp.getActive();
  var app = UiApp.getActiveApplication();
  app.close();
  return app;
}; 
```

# c# - Windows 窗体应用程序中的任务并行库代码冻结 - 可作为 Windows 控制台应用程序正常工作

> ID：13406901
> 
> 赞同：6
> 
> 时间：2012-11-15T21:54:28.963
> 
> 标签：c#, winforms, task-parallel-library, .net-4.5, ping

这个问题是我之前提出的问题的后续问题：

[如何使用 C# 并行执行多个“Ping”](https://stackoverflow.com/questions/13405848/how-to-perform-multiple-pings-in-parallel-using-c-sharp)

我能够让接受的答案（Windows 控制台应用程序）工作，但是当我尝试在 Windows 窗体应用程序中运行代码时，以下代码将冻结在包含`Task.WaitAll(pingTasks.ToArray())`. 这是我要运行的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.Net.NetworkInformation;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {

            List<String> addresses = new List<string>();

            for (Int32 i = 0; i < 10; ++i) addresses.Add("microsoft.com");

            List<Task<PingReply>> pingTasks = new List<Task<PingReply>>();
            foreach (var address in addresses)
            {
                pingTasks.Add(PingAsync(address));
            }

            //Wait for all the tasks to complete
            Task.WaitAll(pingTasks.ToArray());

            //Now you can iterate over your list of pingTasks
            foreach (var pingTask in pingTasks)
            {
                //pingTask.Result is whatever type T was declared in PingAsync
                textBox1.Text += Convert.ToString(pingTask.Result.RoundtripTime) + Environment.NewLine;

            }

        }

        private Task<PingReply> PingAsync(string address)
        {
            var tcs = new TaskCompletionSource<PingReply>();
            Ping ping = new Ping();
            ping.PingCompleted += (obj, sender) =>
            {
                tcs.SetResult(sender.Reply);
            };
            ping.SendAsync(address, new object());
            return tcs.Task;
        }

    }

} 
```

有没有人知道它为什么会冻结？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-15T21:56:33.713

它冻结`WaitAll`了，因为等待所有任务，并且您在 UI 线程中，所以这阻塞了 UI 线程。阻塞 UI 线程会冻结您的应用程序。

由于您使用的是 C# 5.0，因此您想要做的是`await Task.WhenAll(...)`。（您还需要将该事件处理程序标记为`async`它的定义。）您不需要更改代码的任何其他方面。那会很好用。

`await`实际上不会在任务中“等待”。它会做的是，当它到达等待时，它将连接到您正在执行的任务`await`（在这种情况下，当所有），并在该继续中运行该方法的其余部分。然后，在连接该延续之后，它将结束该方法并返回给调用者。这意味着 UI 线程不会被阻塞，因为此单击事件将立即结束。

（根据要求）如果您想使用 C# 4.0 解决这个问题，那么我们需要`WhenAll`从头开始编写，因为它是在 5.0 中添加的。这是我刚刚掀起的。它可能不如库实现那么有效，但它应该可以工作。

```
public static Task WhenAll(IEnumerable<Task> tasks)
{
    var tcs = new TaskCompletionSource<object>();
    List<Task> taskList = tasks.ToList();

    int remainingTasks = taskList.Count;

    foreach (Task t in taskList)
    {
        t.ContinueWith(_ =>
        {
            if (t.IsCanceled)
            {
                tcs.TrySetCanceled();
            }
            else if (t.IsFaulted)
            {
                tcs.TrySetException(t.Exception);
            }
            else //competed successfully
            {
                if (Interlocked.Decrement(ref remainingTasks) == 0)
                    tcs.TrySetResult(null);
            }
        });
    }

    return tcs.Task;
} 
```

这是基于svick 评论中[此建议的另一个选项。](https://stackoverflow.com/questions/13406901/task-parallel-library-code-freezes-in-a-windows-forms-application-works-fine-a/13406927#comment18357275_13406927)

```
public static Task WhenAll(IEnumerable<Task> tasks)
{
    return Task.Factory.ContinueWhenAll(tasks.ToArray(), _ => { });
} 
```

现在我们有了，`WhenAll`我们只需要使用它，以及延续，而不是`await`. 而不是`WaitAll`你会使用：

```
MyClass.WhenAll(pingTasks)
    .ContinueWith(t =>
    {
        foreach (var pingTask in pingTasks)
        {
            //pingTask.Result is whatever type T was declared in PingAsync
            textBox1.Text += Convert.ToString(pingTask.Result.RoundtripTime) + Environment.NewLine;
        }
    }, CancellationToken.None,
    TaskContinuationOptions.None,
    //this is so that it runs in the UI thread, which we need
    TaskScheduler.FromCurrentSynchronizationContext()); 
```

现在您明白为什么 5.0 选项更漂亮了，这也是一个相当简单的用例。

# java - Java同步块内的意外状态

> ID：13406909
> 
> 赞同：1
> 
> 时间：2012-11-15T21:54:45.003
> 
> 标签：java, thread-safety, openam

在我正在调查的一些开源代码中，我遇到了以下情况。它使用了一个同步块，它执行以下操作：

1.  将私有布尔实例变量 hasListener 设置为 true
2.  调用一个方法，该方法使用一个大的 try 块来执行一些 wait() 操作，该块将任何异常存储在实例变量中
3.  将 hasListener 设置为 false
4.  抛出以前存储的任何异常

在同一个类中还有另一个类似的方法，它做的事情完全相同。

从理论上讲，这应该确保 hasListener 只有在您输入时才为假。然而*不知何故*，一个异常被抛出底部（见注释标记//？），因为它进入方法并且 hasListener 为真。我检查了没有其他地方设置了hasListener，默认值为false。是否有任何可以想象的情况，在 waitFirstMessage() 的底部抛出异常会阻止变量被设置回 false？还有其他可能的情况吗？

从日志来看，似乎发生了一个合法的异常（“超过了完成操作的时间”），并且从那时起异常（//？）经常被抛出。

```
protected void waitFirstMessage (int msgId) throws LDAPException {
    synchronized (this) {
        if (!hasListener) {
            hasListener = true;
            while ((request != null) && (request.id == msgId) &&
                (m_exception == null) && (response == null)) {
                waitForMessage();
            }        
            hasListener = false;
            // Network exception occurred ?
            if (m_exception != null) {
                LDAPException ex = m_exception;
                m_exception = null;
                throw ex;
            }
        } else {
            //?
            throw new LDAPException();
        }
    }
}

 private void waitForMessage () throws LDAPException {
    try {
        if (request.timeToComplete > 0) {
            long timeToWait = request.timeToComplete -
                System.currentTimeMillis();
            if (timeToWait > 0) {
                wait(timeToWait);
                if (notified) {
                    notified = false;
                } else if (request.timeToComplete < System.currentTimeMillis()) {
                    // Spurious wakeup before timeout.
                    return;
                } else {
                    request = null;
                    m_exception = new LDAPException(
                        "Time to complete operation exceeded",
                        LDAPException.LDAP_TIMEOUT);
                }
            } else {
                request = null;
                m_exception = new LDAPException(
                    "Time to complete operation exceeded",
                    LDAPException.LDAP_TIMEOUT);
            }
        } else {
            wait();
            notified = false;
        }
    } catch (InterruptedException e) {
        m_exception = new LDAPInterruptedException("Interrupted LDAP operation");
    } catch (Exception e) {
      m_exception = new LDAPException("Unexpected exception while waiting for response",
          LDAPException.OTHER, e.getMessage());
    }
} 
```

**编辑**

好的，事实证明我的问题是不正确的。当前在生产中运行的日志来自的版本比我正在查看的代码稍早，并且有人已经清楚地解决了这个问题。在以前的版本中，该*方法*`waitForMessage()`抛出异常。这些是中断的，然后永远不会被设置为假。宇宙再次变得有意义。*`waitFirstMessage(int msgId)``hasListener`*

 *非常感谢您的回复。现在我需要将此修复程序投入生产！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:08:49.553

`hasListener``waitForMessage`在抛出的情况下将设置为 true 。由于`waitForMessage`捕获所有异常，恕我直言，这可能只是在抛出不是异常（其他一些`Throwable`）的东西，或者在`m_exception`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:05:47.547

如果`waitForMessage`通过抛出异常突然完成，`hasListener = false`将无法到达。如果这段代码是为了确保它`hasListener = false`被执行，它应该把它放在一个`finally`块中。*

# java - 从 Java Servlet 执行 MySQL 命令

> ID：13406910
> 
> 赞同：0
> 
> 时间：2012-11-15T21:54:45.707
> 
> 标签：java, mysql, xml, jsp, servlets

我试图让我的 servlet 输出用户输入的 SQL 命令的结果。现在，servlet 正确检测到命令何时不包含“SELECT”、“INSERT”或“DELETE”，并输出错误消息。命令有效时，不输出任何内容。我知道这意味着我的问题可能发生在我试图连接到数据库的地方，或者我试图将输出打印到“out”的地方。

数据库Servlet.java

```
import javax.servlet.*;
import javax.servlet.http.*;
import java.io.*;
import java.sql.*;

@SuppressWarnings("serial")
public class databaseServlet extends HttpServlet {
    private Connection conn;
    private Statement statement;

    public void init(ServletConfig config) throws ServletException {
        try {
            Class.forName(config.getInitParameter("databaseDriver"));
            conn = DriverManager.getConnection(
                    config.getInitParameter("databaseName"),
                    config.getInitParameter("username"),
                    config.getInitParameter("password"));
            statement = conn.createStatement();
        }
        catch (Exception e) {
            e.printStackTrace();
        }
    }

    protected void doGet (HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType("text/html");
        PrintWriter out = response.getWriter();

        out.println("<xml version = \"1.0\"?>");
        out.println("<!DOCTYPE html PUBLIC \"-//W3C//DTD " +
            "XHTML 1.0 Strict//EN\" \"http://www.w3.org" +
            "/TR/xhtml1/DTD/xhtml1-strict.dtd\">");
        out.println("<html xmlns = \"http://www.w3.org/1999/xhtml\">");
        out.println("<head>");
        out.println("<title>MySQL Servlet</title>");
        out.println("<style type='text/css'>");
        out.println("body{background-color: blue}");
        out.println("</style>");
        out.println("</head>");
        out.println("<body>");

        String query = request.getParameter("query");

        if (query.toLowerCase().contains("select")) {
            //SELECT Queries
            try {
                ResultSet resultSet = statement.executeQuery(query);
                ResultSetMetaData metaData = resultSet.getMetaData();
                int numberOfColumns = metaData.getColumnCount();
                for(int i = 1; i<= numberOfColumns; i++){
                    out.printf("%20s\t", metaData.getColumnName(i));
                }
                out.println();

                while (resultSet.next()){
                    for (int i = 1; i <= numberOfColumns; i++){
                        out.printf("%20s\t", resultSet.getObject(i));
                    }
                    out.println();
                 }
            }
            catch (Exception f) {
                f.printStackTrace();
            }
        }
        else if (query.toLowerCase().contains("delete") || query.toLowerCase().contains("insert")) {
            //DELETE and INSERT commands
            try {
                conn.prepareStatement(query).executeUpdate(query);
                out.println("\t\t Database has been updated!");
            }
            catch (Exception l){
                l.printStackTrace();
            }
        }
        else {
            //Not a valid response
            out.println("\t\t Not a valid command or query!");
        }

        out.println("</body>");
        out.println("</html>");
        out.close();
    }
} 
```

dbServlet.jsp

```
<?xml version = "1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- dbServlet.html -->
<html xmlns = "http://www.w3.org/1999/xhtml">
<head>
    <title>MySQL Servlet</title>
    <style type="text/css">
        body{background-color: green;}
    </style>
</head>
<body>
    <h1>Hello World!</h1>
    <h2>This is the MySQL Servlet</h2>
    <form action = "/database/database" method = "get">
    <p>
        <label>Enter your query and click the button to invoke a MySQL Servlet
            <input type = "text" name = "query" />
            <input type = "submit" value = "Run MySQL Servlet" />
        </label>
    </p>
    </form>
</body>
</html> 
```

我认为另一个潜在的故障点可能是我的数据库文件的路径，该文件在我的 web.xml 文件中初始化。我在网上找到的一个例子包括端口，但我想知道是否应该删除端口号。有人知道 MySQL 使用的默认端口吗？

这是我从下面的 xml 文件中谈论的特定行：jdbc:mysql://localhost:3309/project4

web.xml

```
<web-app xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd" version="2.4">
  <!-- General description of the web application -->
  <display-name>
    MySQL Servlet
  </display-name>
  <description>
    This web application allows the user to connect to a database, sumbit queries, and make changes.
  </description>
  <!-- Servlet definitions -->
  <servlet>
    <servlet-name>database</servlet-name>
    <description>
        A servlet that handles SQL commands submitted by the user.
    </description>
    <servlet-class>
        databaseServlet
    </servlet-class>
    <init-param>
        <param-name>databaseDriver</param-name>
        <param-value>com.mysql.jdbc.Driver</param-value>
    </init-param>
    <init-param>
        <param-name>databaseName</param-name>
        <param-value>jdbc:mysql://localhost:3309/project4</param-value>
    </init-param>
    <init-param>
        <param-name>username</param-name>
        <param-value>root</param-value>
    </init-param>
    <init-param>
        <param-name>password</param-name>
        <param-value>pass</param-value>
    </init-param>
  </servlet>
  <servlet-mapping>
    <servlet-name>database</servlet-name>
    <url-pattern>/database</url-pattern>
  </servlet-mapping>
</web-app> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:41:09.240

我使用的是 3309 端口，需要使用 3306 端口。

问题

```
jdbc:mysql://localhost:3309/project4 
```

解决方案

```
jdbc:mysql://localhost:3306/project4 
```

# javascript - 地理位置未捕获类型错误：无法读取未定义的属性“坐标”

> ID：13406914
> 
> 赞同：4
> 
> 时间：2012-11-15T21:55:00.303
> 
> 标签：javascript, google-maps, geolocation

我正在搞乱带有地理位置的 Google Maps API。一切都按预期工作，但是我在控制台中不断收到此错误：

`Uncaught TypeError: Cannot read property 'coords' of undefined`

这是我的地理检查：

```
// Does this browser support geolocation?
if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(initialize, locationError);
} else {
    showError("Your browser does not support Geolocation!");
} 
```

我的成功处理程序：

```
function initialize(position) {
    var lat = position.coords.latitude;
    var lon = position.coords.longitude;
    var acc = position.coords.accuracy;

    // Debugging
    console.log(position.coords);
    console.log("Accuracy: "+acc+"\nLatitude: "+lat+"\nLongitude: "+lon);

    // Google Maps API
    var myLatlng = new google.maps.LatLng(lat,lon);
    var mapOptions = {
        center: new google.maps.LatLng(lat, lon),
        zoom: 12,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
    var marker = new google.maps.Marker({
        position: myLatlng,
        map: map,
        title:"Hello World!"
    });
} 
```

然后我在我的身体标签中初始化地图`<body id="map" onload="initialize()">`

地图渲染得很好，一切都按预期工作。当我登录`position.coords`到我的控制台时，我得到了一个干净的读数。为什么我不断收到此错误？

谷歌和 SO 搜索没有结果......

干杯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T21:58:56.373

加载文档时，将调用不带参数的初始化方法。这就是你得到错误的原因。

试试这种方式：

```
function initCoords() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(initialize, locationError);
  } else {
    showError("Your browser does not support Geolocation!");
  }
} 
```

并在您的 html 代码中：

`<body id="map" onload="initCoords()">`

保持`initialize`功能不变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:58:51.233

错误可能在这里

```
<body id="map" onload="initialize()"> 
```

您正在调用没有参数的初始化函数。因此“位置”参数未定义

```
function initialize(position) {
    var lat = position.coords.latitude; 
```

就好像你打电话

```
var lat = undefined.coords.latitude 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-14T12:21:25.043

如果您在使用地图对象之前在cordova/phonegap 中的谷歌地图上遇到错误，请确保存在谷歌地图html data-lat 和data-long 属性。

这是一个示例，

> <div class="widget uib_w_20 maps-size d-margins" data-uib="media/google_maps" data-ver="0" data-rpath="null" data-zoom="8" id="google-maps " 数据中心自动="真" 数据拉特="41.309697" 数据长="-72.9370447">

没有 data-lat 和 data-long 以及作为 web 应用程序进行测试，将在谷歌地图初始化期间失败

# apache-flex - 在 Flex 中开发多语言应用程序的更好方法

> ID：13406915
> 
> 赞同：1
> 
> 时间：2012-11-15T21:55:00.610
> 
> 标签：apache-flex, localization, internationalization, multilingual

我打算在 Flex 中创建一个多语言应用程序。我的方法是这样的：拥有一个包含应用程序中所有短语的 XML...

```
<mx:Script>
<![CDATA[
public var selectedLanguage : String = "spanish";
public var language : xml =
    <xml>
      <message id="<<hashcode of the string in english>>" english="hello world" spanish="hola mundo" french="bonjour tout le monde"/>
      <message id="<<hashcode of the string in english>>" english="good bye every body" spanish="adios a todos" french="tout le monde au revoir"/>
    </xml>;

//Then a function to make the translation:
public function translate(msg:String):String{
    //Maybe not a hashCodeFunction but some function to return an unique code for every string
    var hashcode : int = hashCodeFunction(msg);
    var translation : String = language.message.(@id==hashcode)[selectedLanguage];
    if(translation==null) return msg;
    return translation;
}
]]>
</mx:Script>

<mx:Button label="translate('hello world')"/> 
```

好吧，xml 可以以不同的方式构造，但我想要的是创建所有标签，如“翻译（'some text'）”，因为我认为这样在程序员时更好，并且在开发过程结束时创建一个“预处理器”，它将在源代码中查找所有字符串，如“translate（'some text'）”并提取“some text”，然后计算哈希码并将其附加到 xml，当 xml 准备就绪时该应用程序将是多语言的。

我想知道是否有人有另一种分享方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T03:13:15.313

Adobe 为文本和图像的本地化和国际化实施[资源包](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/resources/ResourceBundle.html)。

可以指定编译器选项以包括语言环境：

```
-locale=en_US,ja_JP,fr_FR 
```

然后，可以检索特定于语言环境的属性，例如：

```
<s:Label text="{resourceManager.getString('bundleName', 'key')}" /> 
```

参考：

*   [Adobe 本地化简介](http://help.adobe.com/en_US/flex/using/WS19f279b149e7481c-1c03f02c12bd00c4763-8000.html)
*   [Flex 4 本地化快速入门](http://devgirl.org/2011/03/15/flex-4-localization/)
*   [Flex 资源包简介](http://dispatchevent.org/roger/introduction-to-flex-resource-bundles/)
*   [在一个 .swc 文件中本地化具有多种语言的 Flex 库](http://didierburton.net/blog/2008/07/23/localizing-a-flex-library-with-multiple-languages-in-one-swc-file/)

# php - 比较和隐藏

> ID：13406916
> 
> 赞同：0
> 
> 时间：2012-11-15T21:55:04.677
> 
> 标签：php, mysql

我在页面上有一个下拉菜单，在用户将内容添加到数据库后，我不希望从 dorpdown 菜单中添加的特定值再次显示在列表中。我不想从下拉表中删除该特定值。你的帮助会做的。

下面是我的代码：

```
 <?php
$query = "SELECT * FROM vreg_no order by vreg desc";
$rs = mysql_query($query);
while($row = mysql_fetch_assoc($rs))
{{
$_SESSION['svregx'] = $row['vreg'];
}}
?>
<select name="svreg" class="bodytxt" id="svreg">
<option>Select Vehicle #</option>
<?php
$query = "SELECT * FROM vreg_no order by vreg desc";
$rs = mysql_query($query);
while($row = mysql_fetch_assoc($rs))
{{
$vreg = $row['vreg'];
if($_SESSION['svregx'] == $vreg){
//do nothing
}
elseif($_SESSION['svregx'] != $vreg){
echo"<option value='$vreg'>$vreg</option>";
}else{}
}}
?>
</select> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:59:14.423

您正在执行相同的查询两次。

第一个应该是这样的：

```
$query = "SELECT * FROM vreg_no WHERE user_id = YOUR_USER_ID"; 
```

或者可能是取决于您的数据库结构的连接。

您可以将所有值添加到数组中，并使用类似`in_array`的方法来检查某个用户是否存在此值。

您应该转储已弃用的`mysql_*`函数并切换到 PDO 或 mysqli 中带有绑定变量的准备好的语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:05:37.463

如果问题不是产生重复的用户生成内容，那不只是发出 DISTINCT 查询的问题吗？

```
$query = "SELECT DISTINCT vreg FROM vreg_no order by vreg desc"; 
```

# grails - Grails 2.1.1 和 Spring Security Core 插件

> ID：13406921
> 
> 赞同：0
> 
> 时间：2012-11-15T21:55:34.587
> 
> 标签：grails, spring-security

我一直注意到我正在关注的很多教程都使用了这个：

```
def springSecurityService 
```

并且由于我只想通过当前登录的用户获取记录，因此我使用：

```
def user = params.id ? User.findByUserId(params.id) : User.get(springSecurityService.principal.id) 
```

而且在我的引导程序中，我想创建一个用户名和密码，例如

`def user = new User( username: username, password: springSecurityService.encodePassword("tops3kr17"), enabled: true)`

但是我注意到没有创建密码，并且 Spring Source Tools 没有找到方法 .principal.id 或 .encodePassword （它们在 STS 中保持下划线）并且希望在点击 CTL+SPACE 时使用带有大写 S 的 SpringSecurityService （和没有完成 .principal.id 或 .encodePassword）。

所以我有点迷茫，因为教程似乎已经过时了

那么我怎样才能用当前支持的方法来做我所描述的呢？还是我错过了一些非常简单的东西？:)

```
class BootStrap {
def springSecurityService

def init = { servletContext ->

    def demo = [
        'jack' : [ fullName: 'Jack Demo Salesman'],
        'jill' : [ fullName: 'Jill Demo Saleswoman']]

    def now = new Date()
    def random = new Random()

    def userRole = SecRole.findByAuthority("ROLE_SALES") ?: new SecRole(authority: "ROLE_SALES").save()
    def adminRole = SecRole.findByAuthority("ROLE_ADMIN") ?: new SecRole(authority: "ROLE_ADMIN").save()

    def users = User.list() ?: []
    if (!users) {
        demo.each { username, password, userAttrs ->
            def user = new User(
                username: username,
                password: springSecurityService.encodePassword('secret'),
                enabled: true)
            if (user.validate()) {
                println "DEBUG: Creating user ${username}..."
                println "DEBUG: and their password is ${password}"
                user.save(flush:true)

                SecUserSecRole.create user, userRole
                users << user
            }
            else {
                println("\n\n\nError in account bootstrap for ${username}!\n\n\n")
                user.errors.each {err -> 
                    println err
                }
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:22:32.213

使用注入的 SpringSecurityService 实例是正确的方法。

```
def springSecurityService

def foo() {
   springSecurityService.principal
   springSecurityService.encodePassword('fdsfads')
   ....
} 
```

如果 IDE 无法识别它，则说明您的 IDE 存在问题。

# android - 如何开发在android中调整字体大小的选项？

> ID：13406926
> 
> 赞同：2
> 
> 时间：2012-11-15T21:56:28.380
> 
> 标签：android, android-widget

我想知道如何开发一个底栏来显示根据用户选择增加/减少字体大小的选项。

问题是我一直在考虑创建一个布局（作为页脚）以使其在开始时不可见，因此当用户触摸屏幕时，我想向他们展示带有这些选项的底部布局。这可能吗？

我该怎么做？意味着我一直在考虑使用 EditText#getTextSize() 并在每次用户按下该选项时调整字体大小。我不确定这是否是开发类似东西的正确方法。

你介意建议我怎么做吗？

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:04:48.217

我不确定您所说的“底栏”是什么意思。你是说菜单吗？如果可能的话，我建议让它成为一个菜单选项。（也只有 +/- 和可能的最大/最小字体大小选项。因为如果您不检查诸如“#$@2211”之类的东西，让用户输入诸如“32”之类的字体可能会很糟糕）

我不推荐隐形布局，因为它只会在视觉上看起来是空的，就像它缺少一些东西一样。（并非所有设备都会为应用程序提供默认黑色背景，因此颜色也可能不适合您的应用程序）

```
//if regular font
TextView tv = (TextView) findViewById(R.id.activity_textview_size_options);
tv.setTextSize(getResources().getDimension(R.dimen.font_size_regular)); 
```

# android - 在 ListFragment 的 onListItemClick 方法中出现 CastClassException 错误

> ID：13406928
> 
> 赞同：0
> 
> 时间：2012-11-15T21:56:33.763
> 
> 标签：android, android-listfragment

我有一个扩展 ListFragment 的类，我正在使用支持库。在类的 onListItemClick 方法中，我有这一行：

```
@Override
public void onListItemClick(ListView l, View v, int position, long id) {
    String item = (String) ((Fragment) getListAdapter().getItem(position)).getString(1);
    DetailFrag frag = (DetailFrag) getFragmentManager().findFragmentById(R.id.frag_stitchdetail);
    if (frag != null && frag.isInLayout()) {
        frag.setText(item);
    }
} 
```

其中 position 是传递给 onListItemClick 方法的参数。对于我正在构建的示例应用程序，它在运行时的值为 0，因为列表中只有一项。此行引发以下错误：

java.lang.CastClassException: android.content.ContentResolver$CursorWrapperInner 不能转换为 java.lang.String

我已经用谷歌搜索了这个并在stackoverflow上进行了搜索，但是我没有看到任何可以提示我为什么不能将它转换为字符串的东西。有人知道吗？谢谢！

我的 ContentProvider 查询代码：

```
@Override
public Cursor query(Uri uri, String[] projection, String selection,
        String[] selectionArgs, String sortOrder) {
    SQLiteQueryBuilder queryBuilder = new SQLiteQueryBuilder();
    queryBuilder.setTables(STITCHTABLE_BASEPATH);
    int uriType = sURIMatcher.match(uri);
    switch (uriType)
    {
    case STITCHES_ID:
        queryBuilder.appendWhere(SQLData.KEY_ROWID + "=" + uri.getLastPathSegment());
        break;
    case STITCHES:
        //no filter
        break;
    default:
        throw new IllegalArgumentException("Unknown URI");
    }
    Cursor cursor = queryBuilder.query(mDB.getReadableDatabase(), projection, selection, selectionArgs, null, null, sortOrder);
    cursor.setNotificationUri(getContext().getContentResolver(), uri);
    return cursor;
} 
```

我的 ListFragment 中 CursorLoader 的代码：

```
@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);

    Intent myData = getActivity().getIntent();
    Bundle info = myData.getExtras();

    String[] dataColumns = { "stitchname" };
    int[] viewIDs = { R.id.stitchlist1 };
    mAdapter = new SimpleCursorAdapter(getActivity(), R.layout.stitchlist, null, dataColumns, viewIDs, 0);
    setListAdapter(mAdapter);
    getLoaderManager().initLoader(0, info, (LoaderCallbacks<Cursor>) this); 

}
@Override
public Loader<Cursor> onCreateLoader(int id, Bundle args) {
    String selection = "stitchlevel=?";
    String[] selectionArgs = new String[] {args.getString("Level")};
    return (Loader<Cursor>) new CursorLoader(getActivity(), STITCHES_URI,
            PROJECTION, selection, selectionArgs, null);    
}
@Override
public void onLoadFinished(Loader<Cursor> loader, Cursor cursor) {
        mAdapter.swapCursor((android.database.Cursor) cursor);      
} 
```

# sql - nvarchar 不是可识别的游标选项

> ID：13406930
> 
> 赞同：19
> 
> 时间：2012-11-15T21:56:42.290
> 
> 标签：sql, tsql

我正在运行一些 sql，它从临时表中获取信息并将其放入永久表中。我是从 3 年前写的分步指南中得到的，写它的人早已不在。它声明在这里使用这个 sql。

```
declare @Password nvarchar(100); 
set @Password ='rewards';
if not exists(select 1 from sys.openkeys where key_name = 'Sym_UserPassData' 
and database_name = db_name())  OPEN SYMMETRIC KEY Sym_UserPassData DECRYPTION BY
CERTIFICATE UserPassTables with password='asbpass71509new';
INSERT INTO [User] (Username, [Password], AllowChange, ForceChange, FullName,
SalesRep, OpenLink, UserProfileID, LastUpdatedBy,UserEmail) 
(SELECT Username,EncryptByKey(Key_GUID('Sym_UserPassData'),@Password), 
AllowChange, ForceChange, FullName, SalesRep, [OpenLink ], UserProfileID,    
LastUpdateBy, UserEmail FROM TempUsers) 
```

然后它说以下

如果每一行的密码都是唯一的，则取 set @Password = 'Password'; 关闭并将@Password 替换为[Password]。

所以起初我只是改变了第二行所以它说

```
declare @Password nvarchar(100);
set [Password]
... 
```

但这给了我密码列的错误，所以我将其更改为：

```
declare [Password] nvarchar(100); 
set [Password]
if not exists(select 1 from sys.openkeys where key_name = 'Sym_UserPassData' 
and database_name = db_name())  OPEN SYMMETRIC KEY Sym_UserPassData DECRYPTION BY
CERTIFICATE UserPassTables with password='asbpass71509new';
INSERT INTO [User] (Username, [Password], AllowChange, ForceChange, FullName,
SalesRep, OpenLink, UserProfileID, LastUpdatedBy,UserEmail) 
(SELECT Username,EncryptByKey(Key_GUID('Sym_UserPassData'),[Password]), 
AllowChange, ForceChange, FullName, SalesRep, [OpenLink ], UserProfileID,    
LastUpdateBy, UserEmail FROM TempUsers) 
```

这就是给我错误的原因：

```
 nvarchar is not a recognized cursor option 
```

有谁知道我错过了什么？如果我能提供任何其他信息，我会尽我所能。

感谢任何能够提供帮助的人。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-15T22:05:55.753

您必须`@`在名称前使用符号声明变量。所以这是正确的：

```
declare @Password nvarchar(100); 
set @Password ='rewards'; 
```

这是不正确的：

```
declare [Password] nvarchar(100); 
set [Password] ='rewards'; 
```

我认为问题在于您的变量声明。见这篇文章：[http ://www.databasejournal.com/features/mssql/article.php/3087431/T-SQL-Programming-Part-1---Defining-Variables-and-IFELSE-logic.htm](http://www.databasejournal.com/features/mssql/article.php/3087431/T-SQL-Programming-Part-1---Defining-Variables-and-IFELSE-logic.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T22:36:50.670

如果 [Password] 是 TempUsers 中的一列，则可能是这个意思。

```
if not exists(select 1 from sys.openkeys where key_name = 'Sym_UserPassData' 
and database_name = db_name())  OPEN SYMMETRIC KEY Sym_UserPassData DECRYPTION BY
CERTIFICATE UserPassTables with password='asbpass71509new';
INSERT INTO [User] (Username, [Password], AllowChange, ForceChange, FullName,
SalesRep, OpenLink, UserProfileID, LastUpdatedBy,UserEmail) 
(SELECT Username,EncryptByKey(Key_GUID('Sym_UserPassData'),[Password]), 
AllowChange, ForceChange, FullName, SalesRep, [OpenLink ], UserProfileID,    
LastUpdateBy, UserEmail FROM TempUsers) 
```

# java - 的用法？在准备好的语句中

> ID：13406932
> 
> 赞同：4
> 
> 时间：2012-11-15T21:56:46.560
> 
> 标签：java, sql, prepared-statement

> **可能重复：**
> [不能在 JDBC 准备语句中使用 Like 查询？](https://stackoverflow.com/questions/2857164/cannot-use-a-like-query-in-a-jdbc-prepared-statement)

是否可以准备这样的 SQL 语句：

```
SELECT COUNT(?) FROM TABLE WHERE COLUMUN_1 LIKE '%?%' 
```

在 Java 中，

```
preparedStmt.setString(1, "COLUMN_2");
preparedStmt.setString(2, "FORD"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:05:08.617

没有。作为一般规则，您只能对值使用占位符，而不能使用表名和列名等标识符。

# iphone - iOS 6 - 从自动布局中免除 ViewController

> ID：13406935
> 
> 赞同：1
> 
> 时间：2012-11-15T21:57:02.420
> 
> 标签：iphone, ios, ios6, autolayout

在 Storyboard 中，您现在可以启用 AutoLayout，这是一个不错的功能，但我希望暂时没有它的 ViewController。

这可能吗？或者它是一个完整的项目还是没有任何功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:13:36.703

```
Edited for correctness 
```

您可以逐个故事板将其关闭或使用单独的 xib。

要在情节提要上关闭它：

1.  在 Storyboard 中选择一个视图控制器
2.  在实用程序视图（右侧面板）中选择“文件检查器”
3.  向下滚动并取消勾选“使用自动布局”

然后，您可以为那些不想使用自动布局的视图控制器使用不同的故事板。当然，这并不理想，但可能。

# asp.net - ASP.NET 调试重定向到无效的 url

> ID：13406936
> 
> 赞同：0
> 
> 时间：2012-11-15T21:57:04.910
> 
> 标签：asp.net, visual-studio-2010, debugging

我正在尝试调试我的应用程序，但找不到正确的 URL。

在 Visual Studio 2010 中单击 F5（开始调试）后，我在系统托盘通知窗口中看到以下内容：

```
ASP.NET Development Server  
http://localhost:1392/zz 
```

但是在打开的 Chrome 浏览器地址中，URL 是：

```
http://www.localhost/zz/editad.aspx 
```

我看到一条通知：糟糕！谷歌浏览器找不到 www.localhost

如果我手动将地址更改为

```
http://localhost:1392/zz 
```

它再次重定向回

```
http://www.localhost/zz/editad.aspx again 
```

所以我似乎无法调试我的网站。

我让 hostsman 使用以下 URL 运行：

```
# localhost name resolution is handled within DNS itself.
#   127.0.0.1       localhost
#   ::1             localhost
192.168.0.10    www.zorgbeurs.nl
192.168.0.10    zorgbeurs.nl 
```

不确定这是否重要，但在我的 web.config 中我有。作为重写规则：

```
<rule name="edit ad">?/?
<match url="^account/edit-ad/([0-9]+)?/??(/[a-zA-Z0-9-]+)?$" />
<action type="Rewrite" url="editad.aspx?id={R:1}" />
</rule> 
```

并防止未经授权的访问：

```
<location path="editad.aspx">
    <system.web>
        <authorization>
            <deny users="?" />
        </authorization>
    </system.web>
</location> 
```

我该怎么做才能调试？

# real-time - 跟踪 URL 上的实时访问者

> ID：13406939
> 
> 赞同：2
> 
> 时间：2012-11-15T21:57:12.200
> 
> 标签：real-time, google-analytics-api

谷歌分析提供特定页面/网址的“实时”活跃访问者数量。我认为他们不会通过 API 公开这一点。是否有人知道我可以使用一种工具来跟踪我网站上特定页面的实时活跃访问者？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-05T17:47:20.583

Now, Google has launched new API- Google Real Time API, which provides this facility. with this you can extract similar data.

try : [https://developers.google.com/analytics/devguides/reporting/realtime/v3/devguide](https://developers.google.com/analytics/devguides/reporting/realtime/v3/devguide)

# c# - C# 查找图像中的边界区域

> ID：13406942
> 
> 赞同：2
> 
> 时间：2012-11-15T21:57:14.133
> 
> 标签：c#, ocr

我正在为我的一个课程开发一个 OCR 程序，并且我正在尝试在文本中找到圆形封闭区域来对字符进行分类。单词已经被骨架化了。例如，在这张图片中：http: [//i.imgur.com/VLHJp.jpg](http://i.imgur.com/VLHJp.jpg)

我想在 E 中找到圆形 O 甚至半圆的位置。我尝试将像素转换为数组，然后遍历所有白色像素，找到闭合路径，但这不起作用. 但是，我可能没有正确实现这一点。还有其他解决方案吗？提前致谢。

编辑：

不幸的是，我不能使用 Tesseract 或其他 OCR 程序，因为我必须为我的大学课程开发自己的程序。我使用 AForge 库完成了许多任务，例如骨架化，并想在那里使用圆形检测或形状检测类，但这些形状太钝了，无法使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:20:49.097

查找封闭区域的方法之一是使用洪水填充算法。假设图像边缘的一个像素（例如 0,0）不能在一个封闭的区域中从那里开始并溢出。然后您可以消除该洪水中的所有像素。

处理图像中的其他像素（不属于您的一组边界像素）并进行泛洪。这些洪水是“封闭的”，如果您愿意，如果它们到达图像的边缘，您可以消除它们。每次泛洪都应采用合理数量的像素，因此该算法可以很快消除像素。

在你的情况下，我建议你需要设置一个最小区域（像素数）来排除噪音。

# android - osmdroid MapView IconOverlay - 有没有办法改变图标的 大小？

> ID：13406948
> 
> 赞同：4
> 
> 时间：2012-11-15T21:57:35.803
> 
> 标签：android, google-maps, android-mapview, osmdroid, openstreetmap

在我的应用程序中，我有一张由 GoogleMaps “支持”的地图，但有时需要离线使用地图，所以我决定添加对 osmdroid 的支持。通过对我之前的代码进行一些调整，我设法让它发挥了 GoogleMaps 的所有功能。

现在我的问题.. 在 GoogleMaps 的 mapView 中，图标如下图所示：

![谷歌地图图标](../Images/7507e56b8720de27dd1849c12bee4595.png)

但是在 OSM 的 mapView 中，图标非常大而且模糊：

![OSM 图标](../Images/9aa4d80d85550dc92425139a9d4d62fa.png)

我试图减小图像（* .png 对象）的大小以查看是否是问题所在，但图标仍然很大且模糊，我的猜测是 osmdroid 出于某种原因将图标缩放到预定大小，是有没有办法改变它？

我已经搜索了几个小时，但还没有找到任何有用的东西，所以我决定在这里试试运气。谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T17:25:16.920

我的一个朋友偶然发现了答案， [第 331 期](http://code.google.com/p/osmdroid/issues/detail?id=331 "第 331 期")

这个问题在修订中得到了解决，这就是我所做的：

得到：

*   [ItemizedIconOverlay.java](http://code.google.com/p/osmdroid/source/browse/trunk/osmdroid-android/src/main/java/org/osmdroid/views/overlay/ItemizedIconOverlay.java "ItemizedIconOverlay.java")
*   [ItemizedOverlya.java](http://code.google.com/p/osmdroid/source/browse/trunk/osmdroid-android/src/main/java/org/osmdroid/views/overlay/ItemizedOverlay.java "ItemizedOverlya.java")

然后将它们添加到您的项目中，然后扩展/使用这些文件而不是 osmdroid 的库文件。有了这个，我设法让图标看起来像谷歌地图中的图标（除了阴影，但这不是我真正想要的）

![固定 OSM 图标](../Images/fa27bf1d5fc43d21934821e5d0a8fc30.png)

# sql - 将数字格式化为包括分隔符的货币值

> ID：13406949
> 
> 赞同：1
> 
> 时间：2012-11-15T21:57:47.377
> 
> 标签：sql, sql-server, tsql

我需要一些关于 sql 转换的帮助。我收到的这部分查询：

```
'$' + replace(cast((CAST(p.Price1 AS decimal(10,2)) * cast(isnull(p.Multiplier,1) as decimal(10,2))) as varchar), '.0000', '') 
```

基本上，它最终是一个看起来像这样的 varchar：`$26980`

我需要在千和百万标记处插入一个逗号（如果适用）。所以在这种情况下，`$26,980`

无需重写整个内容的最简单方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:24:05.320

如果你真的必须在 TSQL 中做，你可以使用`CONVERT()`，但是这种东西真的不属于数据库：

```
declare @m money = 12345678
-- with decimal places
select '$' + convert(varchar, @m, 1)
-- without decimal places
select '$' + replace(convert(varchar, @m, 1), '.00', '') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T00:40:17.657

在客户端执行此操作。话虽如此，这个例子应该告诉你方法。

```
with p(price1, multiplier) as (select 1234.5, 10)
select '$' + replace(cast((CAST(p.Price1 AS decimal(10,2)) * cast(isnull(p.Multiplier,1) as decimal(10,2))) as varchar), '.0000', ''),
       '$' + parsename(convert(varchar,cast(p.price1*isnull(p.Multiplier,1) as money),1),2)
from p 
```

关键在最后一个表达式

```
'$' + parsename(convert(varchar,cast(p.price1*isnull(p.Multiplier,1) as money),1),2) 
```

注意：如果`p.price1`它的精度高于小数（10,2），那么您可能还必须在表达式中强制转换它以产生忠实的翻译，因为原始`CAST(p.Priced1 as decimal(10,2))`将执行舍入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T22:31:59.580

你可以把它变成一个函数，它只返回 50 个字符。

```
DECLARE @input VARCHAR(50)
SELECT @input = '123123123.00'
SELECT @input = CASE WHEN CHARINDEX('.', @input) > offset +1
                      THEN STUFF(@input, CHARINDEX('.', @input) - offset, 0, ',') 
                      ELSE @input END
FROM (SELECT 3 offset UNION SELECT 7 UNION SELECT 12 UNION SELECT 18 UNION SELECT 25 UNION SELECT 33 UNION SELECT 42) b
PRINT @input 
```

每个位置的偏移量增加 +1，因为它假设您已经为之前的位置插入了逗号。

# c# - DirectorySearcher FindOne() 初始执行延迟

> ID：13406955
> 
> 赞同：6
> 
> 时间：2012-11-15T21:58:29.330
> 
> 标签：c#, ldap, directoryservices

我看到在执行 DirectorySearcher FindOne() 和我看到的第一个网络数据包发送到 LDAP 服务器之间存在 2-5 秒的初始延迟。初始执​​行后，后续执行会立即完成约 45 秒。在那段快速执行之后，下一次执行将被延迟，并且所有后续执行都将立即完成。似乎正在进行某种缓存，但我无法找到任何资源来确认或描述导致初始延迟的原因。

我们在客户端 Windows 2008 服务器上注意到了这一点，然后在我们自己的 Windows 2008 和 Windows 7 机器上进行了复制。

这是我的简单 .NET 4.0 C# 应用程序的样子。延迟发生在“Started”和“Finished”消息之间。

知道为什么在初始 FindOne() 执行时会出现这种延迟吗？任何帮助深表感谢！

```
using System;
using System.Collections.Generic;
using System.Text;

using System.DirectoryServices;

namespace LdapTest
{
class Program
{
    static void Main(string[] args)
    {
        string[] fetchAttributes;
        fetchAttributes = new string[] { "{string[0]}" };

        using (DirectoryEntry searchRoot = new DirectoryEntry("LDAP://localserver/ou=lab,dc=ourdomain,dc=com", "cn=binduser,ou=Services,dc=ourdomain,dc=com", "Password", AuthenticationTypes.ReadonlyServer))
        {
            using (DirectorySearcher searcher = new DirectorySearcher(searchRoot, "(sAMAccountName=UserName)", fetchAttributes, SearchScope.Subtree))
            {
                Console.WriteLine("Started");
                SearchResult result = searcher.FindOne();
                Console.WriteLine("Finished");
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T14:24:35.970

根据[LDAP ADsPath MSDN 文章](http://msdn.microsoft.com/en-us/library/windows/desktop/aa746384%28v=vs.85%29.aspx)`ServerBind`，如果您的绑定 LDAP 路径指向服务器，则应指定该标志以避免不必要的网络流量。它还建议提供服务器的完整 DNS 名称。此外，该`ReadonlyServer`标志在指向服务器时毫无意义。所以我的第一个建议是将`ReadonlyServer`标志替换为`ServerBind`（最好给出完整的 DNS 名称），或删除字符串的服务器部分（在您的示例中，将其设为 LDAP://ou=lab,dc=ourdomain,dc=com或 LDAP://ourdomain.com/ou=lab,dc=ourdomain,dc=com)。

要查看的另一件事是您通过专有名称提供用户名。如果您查看 DirectoryEntry 使用的核心 API [IADsOpenDSObject::OpenDSObject](http://msdn.microsoft.com/en-us/library/windows/desktop/aa706065%28v=vs.85%29.aspx)，它要求 lpReserved 标志 [ `AuthenticationTypes`DirectoryEntry 中的参数] 为零 [ `None`] 或在传递用户名的专有名称时包含 ADS_USE_SSL [ `SecureSocketsLayer`] 标志。请注意，该`SecureSocketsLayer`标志要求 Active Directory 需要安装证书服务器才能使用此标志。您可能希望以不同的格式传递用户名。

最后，[这个 MDSN 页面](http://msdn.microsoft.com/en-us/library/windows/desktop/aa772323%28v=vs.85%29.aspx)说，没有任何身份验证标志，用户名和密码是明文发送的。您应该添加`Secure`标志。

# c# - 自托管 WCF 服务的跨域访问？

> ID：13406959
> 
> 赞同：2
> 
> 时间：2012-11-15T21:58:45.667
> 
> 标签：c#, wpf, wcf-security

我开发了一个 WPF 应用程序，它与一组位于同一域下的自托管 WCF 服务进行通信，并且我在配置文件中使用了以下设置。

```
<security mode="Transport">
        <transport clientCredentialType="Windows" protectionLevel="EncryptAndSign" />
        <message clientCredentialType="Windows" />
      </security> 
```

我将服务托管在不同域的服务器上。我可以通过将安全模式设置为“无”来实现通信，这并不理想。

是否有任何其他设置可以用于跨域通信，或者我必须使用一些受信任的证书？如果有人可以指导我，我会很高兴，因为谷歌上的所有搜索都将我定向到 Silverlight 应用程序 +Crossdomain.xml+WCF，但我没有看到跨域环境中 WPF 的任何组合。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T00:52:32.460

当这两台计算机不属于同一域时，无法在 WPF 客户端和 WCF 服务器之间共享 Windows 凭据。对于传输级别和消息级别的安全性，您可以使用证书来建立跨域信任，但是是的，这需要必须签署这些证书并让签署机构在客户端上受信任。

当您控制 WPF 客户端计算机并可以在客户端的受信任的根证书颁发机构中安装您的 CA 证书时，您可以使用自签名证书完成此操作。如果您不能让所有 WPF 客户端都安装您的 CA 证书，则您必须获得商业签名的证书。

# gwt - 检测 CTRL 点击 PushButton

> ID：13406964
> 
> 赞同：1
> 
> 时间：2012-11-15T21:59:04.890
> 
> 标签：gwt

我想检测单击按钮时何时`CRTL`按下键。`ClickEvent.isControlKeyDown()`和方法都在`ClickEvent.getNativeEvent().getCtrlKey()`添加到 PushButton 的单击处理程序上返回 false，无论是否`CTRL`按下键。

单击 PushButton 时，如何检测是否`CTRL`按下了键？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T11:23:52.393

你不能用一个`MouseDownHandler`like in

```
PushButton button = new PushButton("push");
button.addMouseDownHandler(new MouseDownHandler() {

    @Override
    public void onMouseDown(MouseDownEvent event) {
        if (event.isControlKeyDown()) {
            Window.alert("test");
        }
    }
}); 
```

猜猜应该可以。

# codeigniter - 表达式引擎模块表和数据排序

> ID：13406966
> 
> 赞同：2
> 
> 时间：2012-11-15T21:59:04.703
> 
> 标签：codeigniter, datatables, expressionengine

我目前正在开发一个自定义模块插件，我希望能够在我的控制面板管理员的表格上使用排序和过滤。我正在使用 EE 表类和表单助手。我正在尝试按照[此处的文档](http://expressionengine.com/user_guide/development/usage/table.html#example-improving-usability-for-large-amounts-of-data)进行设置，但是当我调用时尝试在我的类中调用“_datasource”方法时出现此错误

```
Fatal error: Call to undefined method Content_publish::_datasource() in /home/public_html/system/expressionengine/libraries/EE_Table.php on line 162 
```

我觉得这是一个范围问题，但是在表类 '$this->EE->table->datasource()' 方法中，您应该只传递一个带有数据源函数名称的字符串值，这就是我正在做。

我似乎不是唯一一个遇到这个问题的人。[此 EE 讨论论坛线程](http://expressionengine.com/forums/viewthread/228443/)上有更多详细信息和代码示例

文档不是很清楚。我还尝试查看 EE 自己的评论模块，看看我是否能弄清楚，但没有运气。有人有这方面的经验吗？

这是我正在调用的方法：

```
$data = $this->EE->table->datasource('_datasource'); 
```

这是我在课堂上的职责：

```
function _datasource()
{
     // ....
     // $query comes from DB result set code above.
     // I have omitted it here for brevity

    $datarows = array();
    foreach ($query->result_array() as $key => $row)
    {
    $datarows[] = array(
        'entry_id'          => $row['entry_id'],
        'date'   => date('Y-m-d',$row['entry_date']),
        'author'          => $row['screen_name'],
        'payment'         => $payment_amount,
        'status'             => $status,
        'title'          => $edit_href.$row['title']."</a>"
      );
    }

    return $datarows;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T10:58:36.320

I've been having issues too and have a mixed solution of generate() and datasource working. Here it is here:

In my mcp file:

```
public function index()
{
    $this->EE->cp->set_variable('cp_page_title', lang('my_module_name'));
    $data = $this->EE->table->datasource('_datasource');

    return $this->EE->load->view('index', $data, TRUE);
}

public function _datasource()
{
    $headers = array(
        'name'  => array('header' => 'Name'),
        'color' => array('header' => 'Color'),
        'size'  => array('header' => 'Size')
    );

    $rows = array(
        array('name' => 'Fred', 'color' => 'Blue',  'size' => 'Small'),
        array('name' => 'Mary', 'color' => 'Red',   'size' => 'Large'),
        array('name' => 'John', 'color' => 'Green', 'size' => 'Medium'),
    );

    return array(
        'rows' => $rows,
        'headers' => $headers
    );
} 
```

In my index view file:

```
$this->table->set_columns($headers);
$this->table->set_data($rows);
echo $this->table->generate(); 
```

Seems to be working at the moment and I've not tried pagination yet, but sorting works.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T02:59:39.567

Your `datasource` callback function must be on your `Module_mcp` class (looking at your forum thread you are trying to use it on a plugin which would explain the error).

If you want to put the datasource method on a different class, then just add this line right before you call `datasource()` to trick the table library into using the correct class:

```
// ensure table callbacks use this class rather than our MCP file
$this->EE->_mcp_reference =& $this;
$data = $this->EE->table->datasource('_datasource'); 
```

The `table` and `form_validation` libraries are the only two which use the special `_mcp_reference` variable, so I can't see any side effects to changing it, and have successfully done this in at least two modules.

On a side note, if you want a good example of how to use the built in tablesorter, take a look at `system/expressionengine/controllers/cp/members.php`. The documentation is pretty bad, but the source code always tells the truth :)

# javascript - 用于视觉工作室的 javascript 智能感知

> ID：13406970
> 
> 赞同：0
> 
> 时间：2012-11-15T21:59:10.530
> 
> 标签：javascript, visual-studio-2010

我想知道是否有任何方法可以在 Visual Studio 中获取 JavaScript Intellisense。

它在 Intellisense 中只提供一点帮助。我正在为 jQuery 编写代码。

```
function moverowup(row_img_btn_id) {
    $rowObj = $('#' + row_img_btn_id);
    var row = $rowObj.parents('tr:first');
    $prevRow = row.prev();
    if ($prevRow.is(".headerRow")) {
        // do nothing
    }
    else
        row.insertBefore(row.prev());
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:03:52.830

可能有其他方法可以做到这一点，但我在这里找到了一个
[http://blog.craigtp.co.uk/post/Javascript-jQuery-Intellisense-in-Visual-Studio-2012.aspx](http://blog.craigtp.co.uk/post/Javascript-jQuery-Intellisense-in-Visual-Studio-2012.aspx)
[http://msdn.microsoft。 com/en-us/library/hh874692.aspx](http://msdn.microsoft.com/en-us/library/hh874692.aspx)

# registry - 如何在 WSO2 产品中将一些注册表资源从一个租户移动到另一个租户？

> ID：13406977
> 
> 赞同：1
> 
> 时间：2012-11-15T21:59:52.603
> 
> 标签：registry, wso2, wso2esb, multi-tenant

我想将存储在一个租户中的一些注册表内容移动到 ESB 4.5.0 中的另一个租户。

所以我决定在 WSO2 Developer Studio 2.1.0 中使用 WSO2 注册表浏览器，但我不知道我该怎么做。我可以访问所有资源，并且尝试导出/导入但没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T07:45:47.737

如果要将注册表资源从一个租户移动到另一个租户，推荐的方法是使用注册表[签入客户端](http://docs.wso2.org/wiki/display/Governance452/Running+Check-in+Client)。

目前这仅随 G-Reg 提供，但您可以通过将 checkin-client.jar 和脚本复制到服务器中的相关位置（即 ESB）来使用此功能

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T08:55:28.877

您可以做的最简单的方法是，当您创建租户 ESB 在“wso2esb-ESB4.5.0/repository/tenants”位置创建目录结构时。如果您创建 2 个租户，则会在上述位置创建两个目录。如果要将在一个租户中创建的所有内容复制到其他租户，则必须复制“*ESB4.5.0/repository/tenants/tenant1”中的所有目录并将其粘贴到“ESB4.5.0/repository/tenants”中的新租户目录/tenant2”位置。

# c++ - volatile 和 virtual 成员如何影响 C++ 合成的 move 构造函数？

> ID：13406987
> 
> 赞同：10
> 
> 时间：2012-11-15T22:00:20.610
> 
> 标签：c++, c++11, g++, move-constructor

看下面的代码：

```
struct node
{

  node();
  //node(const node&);    //#1
  //node(node&&);         //#2

  virtual                 //#3
  ~node ();

  node*
  volatile                //#4
  next;

};

int main()
{

  node m(node());         //#5
  node n=node();          //#6
} 
```

使用 gcc-4.6.1 编译时会产生以下错误：

```
g++ -g --std=c++0x   -c -o node.o node.cc
node.cc: In constructor node::node(node&&):
node.cc:3:8: error: expression node::next has side-effects
node.cc: In function int main():
node.cc:18:14: note: synthesized method node::node(node&&) first required here 
```

据我了解，编译器无法在第 6 行创建默认移动或复制构造函数，如果我取消注释第 1 行或第 2 行，它编译得很好，这很清楚。该代码在没有 c++0x 选项的情况下编译良好，因此该错误与默认移动构造函数有关。

但是，节点类中的什么阻止了创建默认移动构造函数？如果我评论任何第 3 行或第 4 行（即使析构函数为非虚拟或使数据成员为非易失性）它会再次编译，那么这两者的组合是否使其无法编译？

另一个难题，第 5 行不会导致编译错误，与第 6 行有什么不同？都是gcc特有的吗？还是 gcc-4.6.1？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-15T22:35:33.137

> `[C++11: 12.8/9]:` **如果类的定义`X`没有显式声明移动构造函数，当且仅当**
> 
> *   `X`没有用户声明的复制构造函数，
> *   `X`没有用户声明的复制赋值运算符，
> *   `X`没有用户声明的移动赋值运算符，
> *   **`X`没有用户声明的析构函数**，并且
> *   移动构造函数不会被隐式定义为已删除。
> 
> [*注意：*当移动构造函数没有被隐式声明或显式提供时，否则会调用移动构造函数的表达式可能会调用复制构造函数。——尾注]

这就是为什么你的#3 打破了综合。

此外，还[不清楚](https://stackoverflow.com/questions/13407737/are-volatile-data-members-trivially-copyable)[volatile 类型（包括 your `node* volatile`）是否可以简单地复制](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3159.html#496)；可以得出结论，[无论它们是否是实现定义的](https://groups.google.com/forum/?fromgroups=#!topic/comp.std.c++/5cWxmw71ktI)，在您的情况下，它们似乎不是。

至少，[GCC](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=48118)在 v4.7 中故意让它停止工作，并提议将其向后移植到 v4.6.1，我只能假设继续进行......

因此，鉴于以下情况：

> `[C++11: 12.8/11]:`隐式声明的复制/移动构造函数是其类的内联公共成员。**如果有，则****类的默认复制/移动构造函数`X`定义为已删除（8.4.3）`X`**：
> 
> *   具有非平凡对应构造函数的变体成员，并且`X`是类联合类，类类型`M`（或其数组）的非静态数据成员，由于重载决议（13.3）而无法复制/移动，如应用于`M`'s相应的构造函数，导致歧义或从默认构造函数中删除或无法访问的函数，
> *   `B`无法复制/移动的直接或虚拟基类，因为应用于`B`的相应构造函数的重载决议（13.3）会导致歧义或从默认构造函数中删除或无法访问的函数，
> *   具有从默认构造函数中删除或不可访问的析构函数的类型的任何直接或虚拟基类或非静态数据成员，
> *   对于复制构造函数，右值引用类型的非静态数据成员，或
> *   **对于移动构造函数，非静态数据成员**或直接或虚拟基类**，其类型不具有移动构造函数且不可轻易复制**。

...这就是为什么你的#4 也打破了综合，独立于#3。

至于 #5，这实际上根本不是 a 的声明`node`，而是一个名为的函数的声明`m`——这就是为什么它没有重现与 a 的构造相关的症状`node`（这被称为[最令人烦恼的 Parse](http://en.wikipedia.org/wiki/Most_vexing_parse)）。

# expect - Expect 中的 -i 标志有什么作用？

> ID：13406988
> 
> 赞同：1
> 
> 时间：2012-11-15T22:00:24.700
> 
> 标签：expect, flags

我正在解析一个早已离开的前同事留给我的一些 tcl 脚本，并试图在不必真正学习 tcl 的情况下理解它们（也许其他时间）。我有一些脚本编写经验，但没有使用 tcl，所以我想我已经掌握了大部分，但我想知道是否有人可以告诉我“-i”标志的作用，例如：

```
expect {
    -i $tbs -re "(.*)\n" { 
```

或者

```
send -i $ftp "put /dev/acq/$data $data\r" 
```

这通常在 expect{} 块中找到，但我不知道这是否相关。

谢谢您的帮助，

马里奥

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:08:33.817

这是特定于期望的，而不是体裁中的 tcl （所以它是您应该参考的期望手册页）。

对于`expect`和`send`命令，`-i`标志是相似的：它指定一个特定的 spawn_id（子进程）来使用，而不是默认值。

```
expect

[...]

By default, patterns are matched against output from the  current
process,  however  the -i flag declares the output from the named
spawn_id list be matched against any following  patterns  (up  to
the  next  -i). 
```

和

```
send

[...]

The -i flag declares  that  the  string  be  sent  to  the  named
spawn_id. 
```

# asp.net-mvc - 在 ASP.NET MVC 中与 Portable Area 共享布局

> ID：13406993
> 
> 赞同：2
> 
> 时间：2012-11-15T22:00:44.507
> 
> 标签：asp.net-mvc

我的应用程序旨在将便携式区域用于功能模块。但是这些模块中的每一个都必须使用根项目中的 _LayoutBase。这些模块的布局设置为 Layout = "~/Views/Shared/_LayoutBase.cshtml"; _LayoutBase中引用的css和脚本在访问时没有加载

http://localhost/RootWeb/module1/account/login

知道如何解决这个问题。任何帮助是极大的赞赏

*   乔治

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T17:54:29.773

我刚刚处理了这类问题，这是我们的解决方法：

为您的模块打开 _ViewStart.cshtml 并更改为：

```
@{
    this.Layout = "~/Areas/<YourModuleName>/Views/Shared/_Layout.cshtml";

} 
```

为您的模块打开 _Layout.cshtml 并更新它（将其设置为根应用程序的 _Layout）：

```
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
} 
```

此外，关于 CSS/脚本问题，您有几个选项：

1.  更新对上述区域的所有引用；"~/Content/style.css" ==> "/AreaName/Content/style.css" （对于 JS 文件也是如此）
2.  将 CSS/JS 添加到根包配置和布局中，确保它从那里加载。请记住将所有其他必需的资产也移动到根目录，否则您将丢失图像等。

# asana - 无法设置due_on=null

> ID：13406995
> 
> 赞同：2
> 
> 时间：2012-11-15T22:00:49.413
> 
> 标签：asana

我正在尝试使用以下请求从任务中删除截止日期：

```
curl --request PUT -u <KEY>: https://app.asana.com/api/1.0/tasks/<TASKID> -d "due_on=null" 
```

并收到

```
{"errors":[{"message":"due_on: Day must be in yyyy-mm-dd format, not: null"}]} 
```

正确的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T20:30:33.297

（我在 Asana 工作）

这应该可以工作 - 它似乎是一个错误。这应该在我们今天的推送中修复（2012 年 11 月 20 日）。感谢您报告问题！

通常，在 API 中有一些字段可以取`null`JSON 中的值。当您使用 form-urlencoded 参数而不是 JSON 内容类型时，没有任何值具有特定类型 - 它们都以字符串形式出现。在某些地方，我们并不一致将字符串`"null"`视为`null`有意义的真实值，例如截止日期。

# c# - 获取对提交 Ajax.BeginForm 的表单的引用？

> ID：13406996
> 
> 赞同：0
> 
> 时间：2012-11-15T22:00:51.667
> 
> 标签：c#, ajax, asp.net-mvc

我正在像这样使用 Ajax.BeginForm：

```
@using (Ajax.BeginForm("PostAction", null, new AjaxOptions { HttpMethod = "post", UpdateTargetId = "TargetID", OnComplete = "OnComplete" }, new { @class = "" })) 
```

在 javascript 方法`OnComplete`中如何找到提交的表单？（甚至是目标ID）

我需要访问表单容器的数据属性。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:27:45.873

您可以使用类似 thsi 的方式将表单的 id 或名称发送到您的 javascript

```
@using (Ajax.BeginForm("PostAction", null, new AjaxOptions { HttpMethod = "post", UpdateTargetId = "TargetID", OnComplete = "OnComplete(xhr, status, 'form1')" }, new { @class = "" })) 
```

javascript

```
function OnComplete(xhr, status, formName) {

    alert('Submited Form is  ' + formName);
} 
```