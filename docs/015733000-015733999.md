# StackOverflow 问答 15733000-15733999

# php - 这是 AJAX 的 UML 序列图 - 使用 JS 和 PHP 进行数据库查询对吗？

> ID：15733003
> 
> 赞同：3
> 
> 时间：2013-03-31T18:36:15.413
> 
> 标签：php, jquery, ajax, uml, sequence-diagram

我有以下 Web 应用程序的 UML 图。它是一个基于 Web 的分析工具，用户可以在 GUI 中执行请求以从数据库中获取一些值。这些值是通过 AJAX 请求加载的。

首先，用户单击按钮以执行基于 jQuery 的 KPI 值请求。带有 PHP 的网络服务器在 sqlite 数据库上执行 sql 查询，然后 GUI 更新浏览器中的图表。

这个图正确吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T19:40:39.793

只是“是”是一个可以接受的答案吗？如果不是，我会说：'是的，图表没问题' :)

# sql - 如何从表中选择最新的行？

> ID：15733005
> 
> 赞同：0
> 
> 时间：2013-03-31T18:36:15.980
> 
> 标签：sql, sql-server

SQL Server 中有一个查询：

```
SELECT  
    Segment_ID = Segment_ID.Segment_ID,
    GEOMETRY::STGeomFromText(Track.Track.STAsText(),4326) as the_geom,
    a.NumAll,
    a.AverageDailyIntens,
    a.AverageDailyIntensCar,
    a.Loading   
FROM dbo.Segment_ID
RIGHT JOIN Road  ON Segment_ID.Road_ID = Road.Road_ID
LEFT JOIN Track ON Segment_ID.Segment_ID = Track.Segment_ID
outer apply (select top 1 Intensity.NumAll,Intensity.AverageDailyIntens,Intensity.AverageDailyIntensCar,Intensity.Loading   
from Intensity 
         where Segment_ID.Segment_ID = Intensity.Segment_ID
         ORDER BY Intensity.NumAll) a 
```

它工作正常，但不是我想要的。它给了我第一排`Intensity`，`Segment_ID.Segment_ID = Intensity.Segment_ID`但我想拿最新排。

在表中`Intensity`，我有日期列，日期如下`2009-02-20 15:00:00.000`。
我怎样才能`Segment_ID`用最新的日期排到需要的位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T18:48:38.723

尝试更改`ORDER BY`子句以按日期列降序排序：

```
outer apply (
   select top 1
          Intensity.NumAll
        , Intensity.AverageDailyIntens
        , Intensity.AverageDailyIntensCar
        , Intensity.Loading   
   from Intensity 
   where  Segment_ID.Segment_ID = Intensity.Segment_ID
   ORDER BY Intensity.your_date_field DESC
   ) a 
```

# javascript - AJAX 在 IE 中返回错误的字符集

> ID：15733007
> 
> 赞同：1
> 
> 时间：2013-03-31T18:36:21.190
> 
> 标签：javascript, jquery, ajax, encoding, iso-8859-1

**我正在尝试做的事情**

我在 index.html 页面上使用 $.get() 来获取位于同一服务器上的 otherpage.html 的内容，然后将其显示`DIV`在 index.html 页面上。两个页面都包含一些重音字符（想想西班牙语、法语和德语），并用`iso-8859-1`.

由于这两个页面都是使用第 3 方“所见即所得 html 创作工具”生成的，因此我无法更改页面的编码，也无法控制服务器的设置方式。我只能添加我的 JS 代码。

**那么出了什么问题呢？**

它在 Chrome、Firefox、Safari 和 Opera 中都能完美运行。但是，IE10/9/8/7 返回乱码。我得到空方格`` instead of`ö `,`å `and`ä`。我已经搜索了所有 Stackoverflow（ISO-8859-1 似乎引起了很多头痛），我的代码包括大多数在标题等中强制编码的提示。没有成功:(

**好的，向我们展示您的代码！**

我在两台服务器上设置了测试用例：[test one](http://goo.gl/5C6zE)和[test two](https://dl.dropbox.com/u/11433463/stack/index.html)。代码如下：

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
<title>the first page</title>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" charset="iso-8859-1">
function GetData() {

$.ajaxSetup({
    beforeSend: function(jqXHR) {
            jqXHR.overrideMimeType('text/html; charset=iso-8859-1')
            jqXHR.setRequestHeader('Accept','text/html; charset=iso-8859-1');
    },
    timeout:5000,
    contentType: 'text/html; charset=iso-8859-1',
    dataType: 'html',
    mimeType: 'text/html; charset=iso-8859-1',
    processData: false
})

$.post( 'otherpage.html' )
 .done( function(pagedata) { 
    console.log(pagedata)
    $('#result').html(pagedata);
 })
 .fail( function() { 
    $('#result').html('Request failed');
 })

}
</script>
</head>
<body>
<input type="submit" value="Get data" onclick="GetData()">
<div id="intro">Some characters: ö--å--ä.</div>
<div id="result">Click "Get data".</div>
</body>
</html> 
```

其他页面.html

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
<title>the other page</title>
</head>
<body>
<div>Hälsyt högg lått Xöööööööööz Zååååååååååååy Kääääääääääännn </div>
</body>
</html> 
```

**所以你的问题是……？**

我应该在 Javascript 中做什么以确保文本在 IE10/9/8/7 中正确显示？我感谢任何建设性的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T18:49:36.717

IE 搞砸了 ISO-8859-1 编码。尝试使用`almost`类似于 ISO-8859-1 的 ISO-8859-15 编码。如果这没有帮助，请尝试在 IE 回调的 onsubmit 处理程序中设置 document.charset="ISO-8859-1" （对于其他浏览器，`<form accept-charset="ISO-8859-1">`应该可以解决问题

PS我还没有运行提供的代码。

# scala - 如何在 Scala IDE / Eclipse 中使用 TestNG 插件运行 Scala 测试？

> ID：15733008
> 
> 赞同：0
> 
> 时间：2013-03-31T18:36:26.590
> 
> 标签：scala, eclipse-plugin, testng, scala-ide, typesafe-stack

我正在使用[Typesafe Scala IDE](http://www.typesafe.com/stack/downloads/scala-ide) 3.0.0 和 TestNG 6.8.1 插件。我真正想念的是可以右键单击 Scala 文件，然后选择“Run As”和“TestNG Test”以在 IDE 中启动测试。此功能适用于基于 Java 的 TestNG 测试，但不适用于用 Scala 编写的测试。

愚蠢的例子：

```
import org.testng.annotations.Test
import org.testng.Assert

class MyTest {
  @Test
  def doSomeTesting() {
    Assert.assertEquals(true, false)
  }
} 
```

我也在使用 Maven 和 Surefire 插件，当我运行“mvn test”时，测试被拾取并很好地执行。所以我假设 Eclipse 插件无法识别 Scala 文件是 TestNG 测试。有没有办法让 TestNG 插件与 Scala 测试一起工作？任何工作配置都可以提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-03T16:04:00.647

我遇到了你描述的同样的问题。而不是*运行*菜单，您应该使用相关的快捷方式。也就是说**⌘ + ⌥ + X**然后**N**用于 Mac 用户，**Ctrl + Alt + X**然后**N**用于其他用户。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-13T17:04:51.637

可以（并且应该）在单独的插件中提供对 TestNG 的支持。我注意到已经有一个[用于 TestNG 的 Eclipse 插件](https://github.com/cbeust/testng-eclipse/)，您是否尝试安装它并查看它是否有效？

如果您的 Scala 包位于正确的位置（包声明与源文件的物理位置匹配），它应该可以正常工作。

# c# - 使用 C# 和 SQL Server 读取和聚合数千个文件

> ID：15733013
> 
> 赞同：0
> 
> 时间：2013-03-31T18:36:44.297
> 
> 标签：c#, sql-server, sqlite, tsql

我有很多文件放在随机文件共享上。我必须将它们复制到我的 SQL Server 2008 数据库中并总结所有要点。将文件从网络复制到 C# 到数据库的开销使得这个过程很慢，而且我有数千个非常大的文件要处理。

文件 1 示例

```
Player | Points
---------------
Bean   | 10
Ender  | 15 
```

文件 2 示例

```
Player | Points
---------------
Ender  | 20
Peter  | 5 
```

结果

```
Player | Points
---------------
Bean   | 10
Ender  | 35
Peter  | 5 
```

当前方法：使用C#，将每个文件读入数据库并合并到主表中。

```
MERGE INTO Points as Target
USING Source as Source
 ON Target.Player = Source.Player
WHEN MATCHED THEN
  UPDATE SET Target.Points = Target.Points + Source.Points
WHEN NOT MATCHED THEN 
  INSERT (Player, Points) VALUES (Source.Player, Source.Points); 
```

这种方法很好，但我正在寻找改进的想法（有点慢）。

建议的解决方案：

将每个文件读入 SQLite 数据库（基于读取，这应该非常快），将整个数据库批量加载到我的 SQL Server 数据库中并在那里进行所有处理。我应该能够为每个玩家分配一个排名，从而加快分组速度，因为我不是基于文本列进行比较。提议的解决方案的缺点是它不能在多个线程上工作。

**将所有这些文件放入数据库并聚合它们的最快方法是什么？**

**编辑：**关于我忘记提及的文件的更多背景信息

*   这些文件位于多台服务器上
*   我需要将这项任务的“影响”降到最低——所以不要安装应用程序
*   文件可能*很大*- 每个文件多达 1gb，因此不能在内存中执行任何操作
*   有数千个文件需要处理

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T18:46:34.057

因此，如果您不能/不想在包含这些文件的各个服务器上运行代码来启动解析操作，并且传输它们的 gigs 和 gigs 很慢，那么这是否是多线程的可能无关紧要 - 性能您过程中的瓶颈是文件传输。

所以做一些假设：

1.  有一个主服务器，只有它可以工作。

2.  它可以立即（如果很慢）访问所有必要的文件共享，可以通过简单的路径访问，并且您知道这些路径。

3.  主计分服务器上有一个本地数据库来存储玩家得分。

如果您可以像传输一个文件一样快地传输多个文件，我会编写执行以下操作的代码：

1.  收集需要聚合的文件列表——这至少应该是一个小而便宜的列表。将它们收集到一个[ConcurrentBag](http://msdn.microsoft.com/en-us/library/dd381779.aspx)中。

2.  启动尽可能多的任务，因为机器上的带宽将允许您运行复制操作。您需要进行测试以确定这是什么。

3.  每个 Task 都将 ConcurrentBag 作为参数。它从一个运行 TryTake() 的循环开始，直到它成功 - 一旦它成功地从包中删除了一个文件路径，它就开始直接从文件位置读取并解析，将每个用户的分数添加到该用户当前在本地数据库中的任何内容中。

4.  一旦任务完成对文件的处理，它就会继续尝试从 ConcurrentBag 获取下一个文件路径，依此类推。

5.  最终，所有文件路径都已处理完毕，任务结束。

所以代码大致是：

```
public void Start()
{
    var bag = new ConcurrentBag<string>();

    for(var i = 0; i < COPY_OPERATIONS; i++)
    {
        Task.Factory.StartNew(() =>
        {
            StartCopy(bag);
        });
    }
}

public void StartCopy(ConcurrentBag<string> bag)
{
    while (true)
    {
        // Loop until the bag is available to hand us a path to work on
        string path = null;
        while (!bag.IsEmpty && !bag.TryTake(out path))
        {}

        // Access the file via a stream and begin parsing it, dumping scores to the db
    }
} 
```

通过流式传输，您可以使复制操作保持全速运行（实际上，操作系统很可能会为您提前读取一点，以真正确保您最大限度地提高复制速度），并且仍然避免因这些文件的大小而破坏内存。

通过不使用多个中间步骤，您可以跳过传输和考虑所有数据的重复成本 - 这样您只需执行一次。

通过使用上述方法，您可以轻松计算最佳复制操作数。

您可以在此处进行一些优化，使其易于重新启动，例如让所有线程接收到一个信号以停止他们正在做的事情并在数据库中记录他们正在处理的文件，他们现在正在处理的文件，以及行他们离开了。您可以让他们以很小的性能成本不断地将这些值写入数据库，以使其防崩溃（通过将行号和分数写入单个事务的一部分）。

* * *

## 原始答案

您忘记在问题中指定这一点，但这些分散的文件似乎记录了玩家在一组网络服务器上玩游戏的得分？

这听起来像是一个令人尴尬的并行问题。与其从每台机器上复制大量文件，不如编写一个可以在所有机器上运行的简单应用程序并将其分发给它们？它只是将机器上的积分相加，然后通过网络向每个玩家发送一个数字和玩家 ID，从而解决网络缓慢的问题。

如果这是一项持续的任务，您可以为总和加上时间戳，这样您就不会重复计算同一点，只需定期批量运行即可。

我会将网络服务器应用程序编写为一个简单的网络应用程序，它只响应一个 IP（您最初要在其上执行所有操作的主计数服务器），并响应请求，在本地运行计数并以总和响应。这样，主服务器只需将请求发送到所有分数服务器，并等待它们发回它们的总和。完毕。

您可以通过将总和数据存储在内存中作为将播放器 id 映射到总和的字典来保持客户端应用程序非常简单 - 无需 SQL。

计数软件还可以在 RAM 中完成所有操作，然后将其全部转储到 SQL Server，以节省时间。

有趣的问题。

# c# - 添加用户控件

> ID：15733014
> 
> 赞同：3
> 
> 时间：2013-03-31T18:36:53.537
> 
> 标签：c#, .net, datagridview

我正在寻找将用户控件添加到`datagridview`单元格的技巧，并找到了以下代码。我只是复制粘贴代码，但是当我尝试添加时，`CustomColumn`我得到了错误。

这样我尝试将`CustomColumn`列添加到网格。

```
private void button1_Click(object sender, EventArgs e)
{
    CustomColumn cc=new CustomColumn();
    dataGridView1.Columns.Add(cc);
    dataGridView1.Rows.Add("");
}

public class CustomColumn : DataGridViewColumn {
    public CustomColumn() : base(new CustomeCell()) { }
    public override DataGridViewCell CellTemplate
    {
        get
        {
            return base.CellTemplate;
        }
        set
        {
            // Ensure that the cell used for the template is a CalendarCell.
            if (value != null &&
                !value.GetType().IsAssignableFrom(typeof(CustomeCell)))
            {
                throw new InvalidCastException("It should be a custom Cell");
            }
            base.CellTemplate = value;
        }
    }        
}
public class CustomeCell : DataGridViewCell
{
    public CustomeCell() : base() { }
    public override Type ValueType
    {
        get
        {
            return typeof(CustomUserControl);
        }
    }
    protected override void Paint(Graphics graphics, Rectangle clipBounds, Rectangle cellBounds, int rowIndex, DataGridViewElementStates cellState, object value, object formattedValue, string errorText, DataGridViewCellStyle cellStyle, DataGridViewAdvancedBorderStyle advancedBorderStyle, DataGridViewPaintParts paintParts)
    {
        CustomUserControl ctrl = (CustomUserControl)value;
        Bitmap img = new Bitmap(cellBounds.Width, cellBounds.Height);
        ctrl.DrawToBitmap(img, new Rectangle(0, 0, ctrl.Width, ctrl.Height));
        graphics.DrawImage(img, cellBounds.Location);
    }
    protected override void OnClick(DataGridViewCellEventArgs e)
    {
        List<InfoObject> objs = this.DataGridView.DataSource as List<InfoObject>;
        if (objs != null) 
        {
            if (e.RowIndex >= 0 && e.RowIndex < objs.Count) {
                CustomUserControl ctrl = objs[e.RowIndex].Ctrl;
                // Take any action - I will just change the color for now.
                ctrl.BackColor = Color.Red;
                ctrl.Refresh();
                this.DataGridView.InvalidateCell(e.ColumnIndex, e.RowIndex);
            }    
        }
    }
} 
```

请告诉我如何使用上面的代码添加自定义列。我创建了一个用户控件和名称，`CustomUserControl`但没有运气。谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-01T07:11:24.927

发布了一个名为 ColVis 的 DataTables 新插件。ColVis 将在表格旁边设置一个按钮，激活该按钮后将显示表格中的列列表，最终用户可以选择显示或隐藏列。

试试 datatables.net/release-datatables/extras/ColVis/

下载（将提取的文件夹放入 DataTables 发行版中的“extras”文件夹中）：datatables.net/releases/ColVis-1.0.1.zip

[http://yellowpages.sulekha.com](http://yellowpages.sulekha.com)

# javascript - 使用 jQuery 获取测验中使用的最后一个值

> ID：15733029
> 
> 赞同：1
> 
> 时间：2013-03-31T18:38:04.033
> 
> 标签：javascript, html, jquery, dhtml

我正在尝试进行动态测验以学习 Javascript/jQuery/html 和 CSS。我被卡住了，因为我刚刚添加了一个后退按钮，使用这个后退按钮，用户可以返回查看他的最后一个答案并更改它，如果最后一个答案被正确回答，`score--;`但如果没有正确回答，它不会重置任何值，以免人们得到无限的分数。我真正的问题是我正在使用一个`lastValue`变量来存储最后一个选中的单选按钮，所以当你返回时它可以比较，但是如果你返回一次它就可以很好地工作，然后`lastValue`不会更新，所以行为很奇怪。这是我用来比较值的一段代码：

```
function backQuestion(){
    if (number == 9){
        $('#myForm').css('display', 'inline-block');
        $('#question').css('display', 'block');
        $('#next').css('display', 'inline-block');
        $('#score').css('display', 'none');
    }

    if(number > 0){
        number --;
        addQuestionAndAnswers();
        if (lastValue == allQuestions[number].answer){
            score --;
            console.log('your score after going back is: ' + score);
            console.log('the last value is: ' + lastValue);
            console.log('this is the value of number: ' + number);
        }else{
            //lastValue = 
            console.log('your score after going back is: ' + score);
            console.log('the last value is: ' + lastValue);
            console.log('this is the value of number: ' + number);
        }
    }

} 
```

我还留下了 js fiddle 演示，以便您可以检查其余的代码和变量。当我写这篇文章时，我只是想将响应的值存储在一个数组中，然后每个响应都回答我可以将该值存储在数组中，然后当您按下按钮时，您可以获得该值以便进行比较，那么如果再次回答答案，您可以删除该值。我不确定这是否是一种复杂的方式；如果有人能告诉我或建议我一个简单的方法，我将不胜感激！

js小提琴：http: [//jsfiddle.net/xtatanx/Wn8Qg/2/](http://jsfiddle.net/xtatanx/Wn8Qg/2/)

js小提琴结果全屏：http: [//jsfiddle.net/xtatanx/Wn8Qg/2/embedded/result/](http://jsfiddle.net/xtatanx/Wn8Qg/2/embedded/result/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T22:39:20.530

我建议存储所有答案，如下所示：

[http://jsfiddle.net/Wn8Qg/4/](http://jsfiddle.net/Wn8Qg/4/)

```
$(ready);

function ready(){
    var allQuestions =
    [
        {
            question: "Whats my real name?",
            choices: ["Jhonnatan", "Alberto", "Tatan","Jaime"],
            answer: 0
        },

        {
            question: "Who is Colombia's president?",
            choices: ["Alvaro Uribe", "Andres Pastrana", "Juan Manuel Santos","Tatan"],
            answer: 2
        },

        {
            question: "My favorite super heroe?",
            choices: ["Batman", "Flash", "Tatan","Javascript"],
            answer: 3
        },

        {
            question: "Wich sports do i practice?",
            choices: ["Climbing", "Swimming", "Programming","Running"],
            answer: 0
        },

        {
            question: "Whats my dad's name?",
            choices: ["Alberto", "Jorge", "Javier","Jose"],
            answer: 1
        },

        {
            question: "Whats my favorite color?",
            choices: ["Red", "Purple", "Blue","All"],
            answer: 2
        },

        {
            question: "My favorite alcoholic drink",
            choices: ["Vodka", "Aguardiente", "Rum","Tekila"],
            answer: 3
        },

        {
            question: "Whats my favorite kind of music?",
            choices: ["Hardcore", "Reggaeton", "Salsa","Programming"],
            answer: 0
        },

        {
            question: "How many qestions has this quiz??",
            choices: ["20", "8", "10","12"],
            answer: 2
        },

        {
            question: "My favorite programming lenguage?",
            choices: ["Ruby", "Arduino", "Python","Javascript"],
            answer: 3
        }
    ];

    var score = 0;
    var number = 0;
    var question = $('#question');
    var choice1 = $('#answer0');
    var choice2 = $('#answer1');
    var choice3 = $('#answer2');
    var choice4 = $('#answer3');
    var next = $('#next');
    var back = $('#back');
    var currentQuestion = $('#current-question');

    var answers = new Array(allQuestions.length);

    next.click(on_click_next);
    back.click(on_click_back);

    populate();

    function populate() {
        currentQuestion.text(number + 1);

        question.text(allQuestions[number].question);

        choice1.text(allQuestions[number].choices[0]);
        choice2.text(allQuestions[number].choices[1]);
        choice3.text(allQuestions[number].choices[2]);
        choice4.text(allQuestions[number].choices[3]);

        $(":radio").prop('checked', false);

        if (answers[number] !== null)
            $(":radio").eq(answers[number]).prop('checked', true);
    }

    function on_click_next(){
        if($(":radio:checked").length == 1)
        {
            answers[number] = $(":radio:checked").val();

            number++;

            if (number < allQuestions.length) {
                populate();
            } else {
                displayResult();
            }
        }else{
            alert('please select an answer before proceed');
        }

        function displayResult(){
            var score = get_score();
            currentQuestion.text(allQuestions.length);

            $('#question, #alternatives').hide();
            $('#next').hide();
            $('#score').show();
            $('#score').text('Your score is: ' + score + 'pts');
        }
    }

    function get_score()
    {
        var result = 0;
        for(var i = 0; i < answers.length; i++)
            if (allQuestions[i].answer == answers[i])
                result++;

        return result;
    }

    function on_click_back()
    {
        if (number == allQuestions.length)
        {
            $('#question, #alternatives').show();
            $('#next').show();
            $('#score').hide();

            number--;

            populate();
        }
        else
        {
          if(number > 0)
          {
              number--;
              populate();
          }
       }
    }
} 
```

# java - 我在 java 中收到此运行时错误：java.util.NoSuchElementException，我不知道如何修复它

> ID：15733032
> 
> 赞同：0
> 
> 时间：2013-03-31T18:38:07.793
> 
> 标签：java, runtime-error

我正在用java创建一个井字游戏来完成家庭作业。我有一个名为 TicTacToe 的父类和一个名为 humanVsHuman 的派生类。

下面的方法写在派生类中。它提示用户输入他们想要输入棋子的位置（X 或 O），然后从父类调用两个方法：一个将 X 或 O 存储在一个名为 setGb() 的多维数组中，另一个显示带有名为 displayBoard() 的新棋子的棋盘。

这是方法：

```
private void playGame() {
    Scanner keyboard = new Scanner (System.in);
    int row, col;
    System.out.println("When playing, enter the row and column position for your X or O piece separated by a space.");
    do{
        System.out.print(player1 + ", Enter X position: ");
        row = keyboard.nextInt();
        col = keyboard.nextInt();
        setGb(row, col, 'X');
        displayBoard();

        System.out.print(player2 + ", Enter O position: ");
        row = keyboard.nextInt();
        col = keyboard.nextInt();
        setGb (row, col, 'O');
        displayBoard();
        keyboard.close();
    } while (!gameOver());
} 
```

我收到以下运行时错误：

```
When playing, enter the row and column position for your X or O piece separated by a space.
Deena, Enter X position: Exception in thread "main" java.util.NoSuchElementException
    at java.util.Scanner.throwFor(Unknown Source)
    at java.util.Scanner.next(Unknown Source)
    at java.util.Scanner.nextInt(Unknown Source)
    at java.util.Scanner.nextInt(Unknown Source)
    at Assignment7C.HumanVsHuman.playGame(HumanVsHuman.java:38)
    at Assignment7C.HumanVsHuman.repeatGame(HumanVsHuman.java:28)
    at Assignment7C.HumanVsHuman.game(HumanVsHuman.java:14)
    at Assignment7C.TicTacToeTest.main(TicTacToeTest.java:10) 
```

一旦显示输入位置的提示并且在我能够输入位置之前，我就会收到错误消息。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T18:47:01.483

移出`keyboard.close()`循环。`Scanner`在游戏结束之前，您不想关闭。这不会解决您的问题中的异常，但无论如何您都需要这样做以避免您将面临的下一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T17:18:19.093

您是否尝试从您的 while 循环中删除以下代码并查看它是否有效。

```
 keyboard.close(); 
```

或者您可以将其添加到循环之外。

# javascript - 也提交的表单重置

> ID：15733034
> 
> 赞同：0
> 
> 时间：2013-03-31T18:38:15.253
> 
> 标签：javascript, html

我有以下内容：

```
<form id="form-lecturerInfo-setup">
...
<input type="submit" value="Submit" />
<input type="reset" value="Reset" />
</form>

<script>                
$('#form-lecturerInfo-setup').submit(function(event){
...
});
</script> 
```

提交表单后，我将其数据序列化并将它们提交到数据库。当重置被击中时，表单输入将恢复为它们之前包含的内容（正常）。

我想要做的是，当单击重置时，会发生默认行为（如前所述），但我也希望提交行为发生，以便将旧表单信息重新提交到数据库。

可行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T18:40:08.820

将事件处理程序绑定到重置按钮。让它调用`reset()`表单对象的方法，然后调用它的`submit()`方法。

# assembly - 将整数转换为二进制/十进制的 MIPS 函数？

> ID：15733037
> 
> 赞同：1
> 
> 时间：2013-03-31T18:38:28.967
> 
> 标签：assembly, binary, decimal, converter, mips

我正在编写一个 MIPS 汇编程序，我试图找出一种方法，只使用一个带有两个参数的函数以十进制或二进制显示给定整数。该函数有两个参数：一个整数和一个基数（“2”或“10”）。除了这个功能，我不想编辑任何东西。

谁能帮我创建这样的功能？我无法理解使用汇编语言执行此操作所需的逻辑。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-10T19:19:51.797

我在网上搜索并在[这里](https://www.daniweb.com/programming/software-development/threads/72982/converting-decimal-value-to-binary-mips)找到了解决方案。它在我的代码中有效，我建议您尝试一下。

全部功劳归于编写和发布代码的[RubyBEW 。](https://www.daniweb.com/members/282148/rustybew)

让我知道这是否有帮助

# cordova - Phonegap Icenium 图像显示错误的方式

> ID：15733053
> 
> 赞同：1
> 
> 时间：2013-03-31T18:40:17.673
> 
> 标签：cordova, camera

我用相机拍了一张照片，但是当我将图像数据设置为图像元素的 src 时，它会出现在它的一侧。我将它上传到服务器并正确显示。我怀疑这是我正在做的愚蠢的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-11T23:17:15.190

有一个方向设置 navigator.camera.getPicture(onPhotoDataSuccess, onPhotoDataFail, { quality: 50, correctOrientation: true, targetWidth: 750, targetHeight: 750 }); 小心设置宽度，因为它让我的手机在试图定位内存中的原始图像时崩溃了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-02T18:57:32.983

将使用 iOS 设备（如 iPhone）创建的照片上传到 Windows 系统时，您似乎遇到了一个众所周知的问题。

原因是照片方向 EXIF 数据在 Apple 系统和 Windows 之间的**解释不同。**

这个已知问题已在[多个线程](https://stackoverflow.com/questions/6222053/problem-reading-jpeg-metadata-orientation)中进行了讨论。

就像 user1102550 建议的那样，`correctOrientation: true`在方法中设置属性`getPicture()`应该可以工作。这也在[这篇文章](https://stackoverflow.com/questions/9353629/images-turning-sideways-upside-down-after-being-uploaded-via-phonegap-ios)中进一步讨论。

# ios - iOS：使用异步

> ID：15733055
> 
> 赞同：0
> 
> 时间：2013-03-31T18:40:18.693
> 
> 标签：ios, asynchronous, nsurlconnection

我目前有一个带有 2 张桌子的屏幕。我正在同步获取数据并将其放在屏幕上。代码类似于：viewController.m

```
DBAccess_Error_T = [getList:a byCompanyID:1];
DBAccess_Error_T = [getList:b byCompanyID:2];
[self putListAOnScreen];
[self putListBOnScreen]; 
```

数据库访问.m

```
+ (DBAccess_Error_T)getList:(NSMutableArray*)a byCompanyID:(NSInteger)cID
{
    // Pack this up in JSON form
    [self queryDB:postData];
    // Unpack and put it into variable a
}

+ (id)queryDB:(id)post
{
    // Send request
    // Get back data
} 
```

我现在正试图将其切换为异步，我正在苦苦挣扎。即使有网站教程和文档也很难。

由于我所有的数据库实用程序都位于与 viewController 不同的文件中，因此我不确定如何使用 didReceiveData 和 didReceiveResponse 处理程序。另外，由于我有 2 个数组来填充我的 2 个表，我如何区分 didReceiveData 中的差异？

相反，我现在要做的是使用 sendAsynchronousRequest，但似乎我需要为每个发送函数创建一个解包函数......让我知道我是否离开这里......它看起来像：

viewController.m 保持不变

```
DBAccess.m
+ (DBAccess_Error_T)getList:(NSMutableArray*)a byCompanyID:(NSInteger)cID
{
    NSDictionary *post = /*blah blah*/
    [self queryDB:post output:(a)];
}

+ (id)queryDB:(id)post output:(id)output
{ 
    NSError *error;
    NSData *jsonPayload = [NSJSONSerialization dataWithJSONObject:post options:NSJSONWritingPrettyPrinted error:&error];

    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url   
                                         cachePolicy:NSURLRequestUseProtocolCachePolicy
                                         timeoutInterval:60.0];
    [theRequest setHTTPMethod:@"POST"];
    [theRequest setHTTPBody:jsonPayload]; 

    [NSURLConnection sendAsynchronousRequest:request
                                       queue:[[NSOperationQueue alloc] init]
                           completionHandler:^(NSURLResponse *response,
                                               NSData *data,
                                               NSError *error)
     {
         if ([data length] >0 && error == nil)
         {
             [self unpackDataForList:output data:data]; // This function needs to be different depending on which function called queryDB...the data will be unpacked in a different way
         }
    }
}

+ (void)unpackDataForList:(id)output data:(NSData*)data
{
    // Do my unpacking here and stick it into 'output'.
} 
```

如何调用不同的 unpackData 函数？函数指针是正确的方法吗？这种方法是否可行？任何提示将非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T20:32:35.197

你看过 ASIHTTPRequest 吗？通过允许您使用积木，它使您的生活变得更加轻松。以下是如何发出异步请求的示例：

```
- (IBAction)grabURLInBackground:(id)sender
{
   NSURL *url = [NSURL URLWithString:@"http://allseeing-i.com"];
   __block ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];
   [request setCompletionBlock:^{
      // Use when fetching text data
      NSString *responseString = [request responseString];

      // Use when fetching binary data
      NSData *responseData = [request responseData];
   }];
   [request setFailedBlock:^{
      NSError *error = [request error];
   }];
   [request startAsynchronous];
} 
```

您可以在这里找到更多信息：

[http://allseeing-i.com/ASIHTTPRequest/](http://allseeing-i.com/ASIHTTPRequest/)

# ruby-on-rails - 是否应该为关联嵌套路由？

> ID：15733058
> 
> 赞同：2
> 
> 时间：2013-03-31T18:40:38.600
> 
> 标签：ruby-on-rails, routes

`User`我在和`Occupation`（用户`has_many :occupations`）之间有一个一对多的关联。在路由文件中，我做了：

```
resources :users do 
   resources :occupations 
end 
```

将职业路线嵌套在用户内部。玩弄 AJAX 请求，我意识到不嵌套职业路线对我来说更容易，如下所示：

```
resources :users

resources :occupations 
```

我的问题是，如果没有嵌套路由，我是否会以任何方式失去（性能、功能）？

**更新：**除了丢失 users/1/occupations 路由。我知道如果我不嵌套路线，我就不会得到那个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:00:13.690

我不会担心性能（如果有的话，嵌套路由可能会稍微慢一些），只需设计对您的应用程序最有意义的路由。

# java - Java扫描仪无法识别文件名？

> ID：15733060
> 
> 赞同：1
> 
> 时间：2013-03-31T18:40:53.603
> 
> 标签：java, parsing

我正在编写一个解析器，它从文本文件中删除所有标点符号，并将单词放在一个 Map 中，该 Map 将每个单词与其在文件中出现的次数相关联。我使用扫描仪读取 txt 文件，但它读取的是文件名而不是实际文件。例如：

```
 parse("./src/filename.txt") 
```

读作“srcfilenametxt”并与值 1 相关联。不幸的是，我不能包含更多代码，因为这是用于类分配。如何让它正确读取文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T18:46:52.360

如果`Scanner`是用字符串参数构造的，它会扫描字符串，而不是字符串命名的文件。你需要这样的一行：

```
Scanner in = new Scanner(new File("./src/filename.txt")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T18:44:47.307

使用 bufferedreader 读取文件

```
BufferedReader br = new BufferedReader(new FileReader("filename.txt")); 
```

# android - 为什么更新后App与平板不兼容

> ID：15733070
> 
> 赞同：8
> 
> 时间：2013-03-31T18:41:26.643
> 
> 标签：android, google-play

我有一个应用程序已经可用了 2 年多，只要平板电脑出现就支持平板电脑。我有一个用于平板电脑测试的 Asus Transformer 平板电脑。在我进行更新之前，该应用程序与平板设备兼容。对于我最近的一组更改，我在 Android Manifest 文件中唯一更改的是应用版本号和应用版本字符串。其他一切都和以前完全一样。但是，更新后，当我在 Google Play 中搜索该应用时，该应用没有出现。当我在平板电脑的浏览器中查看该应用程序时，它显示“您的设备与此版本不兼容”。

在没有修改权限的情况下，这个新版本究竟如何与平板电脑不兼容？当我查看我的应用程序时，在 Android 开发者控制台内部，它说支持 2,673 台设备，并且说排除了 0 台设备（没错，零台设备）。好吧，如果这是真的，我怎么可能收到不兼容的消息？此外，当我查看支持的设备列表时，我的华硕平板电脑也会在其中列出。

请注意，应用程序大小仅为 1.19 MB，我实际上有 2 个可执行文件用于同一个应用程序，但另一个可执行文件专门用于 Android 1.5 及更低版本，其版本代码为 0300800，因此它低于可执行文件的版本代码支持 Android 1.6 及更高版本（使用兼容性包）。

此外，当使用 ADB 连接到我的计算机时，我可以将应用程序直接加载到平板电脑上。我什至意识到这个问题现在发生的唯一原因是因为我收到了几个平板电脑用户的电子邮件，他们说他们收到的信息与我相同，只是他们使用的平板电脑不同。

这是我的清单文件（同样，除了版本号之外它没有变化）：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="my_package"
  android:versionCode="0400921"
  android:versionName="9.2.1"
  android:installLocation="auto">
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
<uses-permission android:name="com.android.vending.CHECK_LICENSE" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<supports-screens android:anyDensity="true"/>
<application android:icon="@drawable/icon" android:label="@string/app_name">
    <activity android:name=".App"
              android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

<activity android:name=".Activity1" android:label="Activity1"></activity>
<more activities>

</application>
<uses-sdk android:minSdkVersion="4" android:targetSdkVersion="8" /> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-25T17:34:58.567

我联系了谷歌，他们调查了这个问题。有一系列问题。首先，他们说切换到新的开发者控制台起了作用，因为旧的开发者控制台更加宽松。他们说我的旧清单文件在旧的 Devloper 控制台中工作，但从技术上讲，旧的清单文件实际上并没有指定平板电脑的信息。

因此，我将清单文件更新为此，现在使用平板电脑的用户可以在 Google Play 中访问该应用程序：

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<uses-sdk android:minSdkVersion="4" android:targetSdkVersion="10" />

<compatible-screens>
     <screen android:screenSize="large" android:screenDensity="480" />
     <screen android:screenSize="xlarge" android:screenDensity="480" />

    <screen android:screenSize="small" android:screenDensity="ldpi" /> 
    <screen android:screenSize="small" android:screenDensity="mdpi" /> 
    <screen android:screenSize="small" android:screenDensity="hdpi" /> 
    <screen android:screenSize="small" android:screenDensity="xhdpi"/>

    <!--all normal size screens -->
    <screen android:screenSize="normal" android:screenDensity="ldpi" />
    <screen android:screenSize="normal" android:screenDensity="mdpi" />
    <screen android:screenSize="normal" android:screenDensity="hdpi" />
    <screen android:screenSize="normal" android:screenDensity="xhdpi" />

    <!-- all large size screens -->
    <screen android:screenSize="large" android:screenDensity="ldpi" />
    <screen android:screenSize="large" android:screenDensity="mdpi" />
    <screen android:screenSize="large" android:screenDensity="hdpi" />
    <screen android:screenSize="large" android:screenDensity="xhdpi" />

    <!-- all xlarge size screens -->
    <screen android:screenSize="xlarge" android:screenDensity="ldpi" />
    <screen android:screenSize="xlarge" android:screenDensity="mdpi" />
    <screen android:screenSize="xlarge" android:screenDensity="hdpi" />
    <screen android:screenSize="xlarge" android:screenDensity="xhdpi" />

    <!-- Special case for Nexus 7 -->
    <screen android:screenSize="large" android:screenDensity="213" />

</compatible-screens>

    <application android:icon="@drawable/icon" android:label="@string/app_name">
        <activity android:name=".App"
                  android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

    <activity android:name=".Activity1" android:label="Activity1"></activity>
        </application>

</manifest> 
```

此外，他们说使用支持屏幕而不是兼容屏幕以扩展兼容性。

# php - $_FILES 为空，文件上传时卷曲

> ID：15733074
> 
> 赞同：3
> 
> 时间：2013-03-31T18:41:44.713
> 
> 标签：php, wordpress, curl

我一直在用头撞墙。我觉得我的问题真的很愚蠢，但我就是不知道是什么。

我有一个代理脚本，它处理一切（POST 数据和上传）。

当我在后端服务器上 print_r($_FILES) 时，它是一个空数组，并且 $_POST 包含文件路径。

```
$ch = curl_init();
$options = array( 
    CURLOPT_HEADER => 1, 
    CURLOPT_HTTPHEADER => array( 
        "Host: {$host}", 
        "Cache-Control: no-cache"
    ), 
    CURLOPT_RETURNTRANSFER => true, 
    CURLOPT_SSL_VERIFYHOST => false, 
    CURLOPT_SSL_VERIFYPEER => 0, 
    CURLOPT_URL => "http://{$this->config->ipAddress}{$url}", 
    CURLOPT_FOLLOWLOCATION => false, 
    CURLOPT_COOKIE => $cookie_string, 
    CURLOPT_USERAGENT => $_SERVER["HTTP_USER_AGENT"]
);

if (! empty($_POST)) {
    if (! empty($_FILES)) {
        //$options[CURLOPT_HTTPHEADER][] = "Content-type: multipart/form-data";

        $files = "";
        foreach ($_FILES as $fid => $file) {
            $files .= "{$fid}=@" . $file["tmp_name"] . ";type={$file["type"]};name={$file["name"]}&";
        }
    }

    $postString = (! empty($files) ? $files : '') . http_build_query($_POST);
    $options[CURLOPT_POST] = 1;
    $options[CURLOPT_POSTFIELDS] = $postString;
}

curl_setopt_array($ch, $options);
$output = curl_exec($ch);
$info = curl_getinfo($ch);
curl_close($ch); 
```

我使用 http_build_query 而不是仅仅提供一个数组的原因是因为我们会遇到一个多维数组。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-01T09:53:49.413

我愿意打赌您的表单 enctype 不是“multipart/form-data”b/c，您不会将帖子字符串作为数组传递。

*   [http://php.net/manual/en/function.curl-setopt.php](http://php.net/manual/en/function.curl-setopt.php)搜索下面的“CURLOPT_POSTFIELDS”是该页面的摘录。

“如果 value 是一个数组，Content-Type 标头将设置为 multipart/form-data。从 PHP 5.2.0 开始，如果文件以 @ 前缀传递给此选项，则 value 必须是一个数组。”

您可以通过设置 curl 选项“curl_setopt($ch, CURLOPT_VERBOSE, TRUE);”然后“print_r(curl_getinfo($ch));”来了解 curl 的情况。在“curl_exec($ch);”之后 它将输出有关请求和响应的所有信息。

# java - 路径为动态时打开jsp页面

> ID：15733075
> 
> 赞同：1
> 
> 时间：2013-03-31T18:41:51.013
> 
> 标签：java, jsp, tomcat7, servlet-3.0

我有一个需要打开的 jsp 页面（带有相应的 servlet），无论指定什么路径。例如，我的 jsp 是 webapps/test/index.jsp 它应该以 http://localhost/[path] 的形式打开，其中路径是任意字符串。

eglocalhost/xxxx 和 localhost/yyyy 应该打开同一个 webapps/test/index.jsp。

我正在使用 Tomcat 7.0 和 Servlet 3.0。

这可以通过tomcat或servlet配置来实现吗？有哪些选项可以做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T19:07:59.867

您可以`/*`通过在您的`web.xml`：

```
(...)

<servlet>
  <servlet-name>index-view</servlet-name>
  <jsp-file>/test/index.jsp</jsp-file>
</servlet>

<servlet-mapping>
  <servlet-name>index-view</servlet-name>
  <url-pattern>/*</url-pattern>
</servlet-mapping>

(...) 
```

有关 Oracle 页面的更多信息：（[链接）](http://docs.oracle.com/cd/E11035_01/wls100/webapp/configurejsp.html#wp157809)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T02:47:36.747

您可以创建一个 servletfilter，并在该过滤器中使用 requestDispatcher.forward 方法将请求转发到目标页面。您可以使用获取请求的 url

```
String url = ((HttpServletRequest) request).getRequestURL().toString(); 
```

并使用转发该请求

```
request.getServletContext().getRequestDispatcher(newUrl)
                    .forward(request, response); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-01T06:52:01.323

我认为您应该检查项目的配置文件，确保 servlet 映射在 web.xml 中正确且唯一。

# python - 非常奇怪的 Web-Scraping 问题：发布请求的行为不符合预期

> ID：15733078
> 
> 赞同：11
> 
> 时间：2013-03-31T18:42:02.877
> 
> 标签：python, web-scraping, urllib2, mechanize

我正在尝试以编程方式将一些数据提交到我们公司管理页面上的表单，而不是手动完成。

我编写了许多其他工具来抓取该网站并操纵数据。但是，由于某种原因，这个特殊的问题给我带来了**很多**麻烦。

## 使用浏览器浏览：

以下是我试图抓取和发布数据的页面。请注意，这些页面通常显示在 js shadowboxes 中，但是，它在禁用 Javascript 的情况下运行良好，所以我假设 javascript 不是关于刮板问题的问题。

*（注意，由于这是一个公司页面，我已经填写了我已经用垃圾标题替换了所有表单字段，因此，例如，客户编号完全是虚构的）*

*另外，由于它是用户名/密码墙后面的公司页面，我无法提供网站进行测试，所以我尝试在这篇文章中注入尽可能多的细节！*

主要入口点在这里：

![在此处输入图像描述](https://i.stack.imgur.com/xrcKp.png)

在此页面中，我单击`"Add New form"`，这将在新标签中打开下一页（因为禁用了 javascript）。

![在此处输入图像描述](https://i.stack.imgur.com/6ilkF.png)

在这个页面上，我填写了一个小表格，点击提交，然后进入下一页显示成功消息。

![在此处输入图像描述](https://i.stack.imgur.com/HTb1b.png)

应该很简单吧？

## 代码尝试1：机械化

```
import mechanize
import base64
import cookielib

br = mechanize.Browser()

username = 'USERNAME'
password = 'PASSWORD'
br.addheaders.append(('Authorization', 
    'Basic %s' % base64.encodestring('%s:%s' % (username, password))))
br.addheaders = [('User-agent', 
    'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.22 (KHTML,'
    ' like Gecko) Chrome/25.0.1364.172 Safari/537.22')]

br.open('www.our_company_page.com/adm/add_forms.php')

links = [link for link in br.links()]

# Follow "Add a form" Link
response = br.follow_link(links[0]) 

br.select_form(nr=0)
br.form.set_all_readonly(False)
br.form['formNumber'] = "FROM_PYTHON"
br.form['RevisionNumber'] = ['20']
br.form['FormType'] = ['H(num)']

response = br.submit()

print response.read() #Shows the exact same page! >:( 
```

因此，如您所见，我尝试复制在浏览器中执行的步骤。我加载初始`/adm/forms`页面，点击第一个链接，即`Add a Form`，填写表格，然后单击`submit`按钮。但这就是问题所在。mechanize 返回的响应是与表单完全相同的页面。没有错误消息，没有成功消息，当我手动检查我们的管理页面时，没有进行任何更改。

## 检查网络活动

沮丧的是，我打开 Chrome 浏览器，看着网络选项卡，因为我在浏览器中手动提交并提交了表单。

提交表单后，这是网络活动：

![在此处输入图像描述](https://i.stack.imgur.com/gFsbw.png)

对我来说似乎很简单。有一个`post`，然后是一个`get`用于 css 文件，另一个`get`用于 jquery 库。还有另一个`get`用于某种图像，但我不知道那是什么。

### 检查 POST 请求的详细信息：

![在此处输入图像描述](https://i.stack.imgur.com/uDrW6.png)

在搜索了一些关于抓取问题的 Google 搜索后，我看到了一个建议，即服务器可能需要某个标头，我应该简单地复制在 POST 请求中生成的所有内容，然后慢慢删除标头，直到我弄清楚哪个是重要的一。所以我就这么做了，复制了“网络”选项卡中的每一点信息，并停留在我的发布请求中。

## 代码尝试2：Urllib

我在用 . 找出所有标题内容时遇到了一些麻烦`Mechanize`，所以我切换到了 urllib2。

```
import urllib
import urllib2
import base64 

url = 'www.our_company_page.com/adm/add_forms.php'
values = {
    'SID':'', #Hidden field
    'FormNumber':'FROM_PYTHON1030PM',
    'RevisionNumber':'5',
    'FormType':'H(num)',
    'fsubmit':'Save Page'
    }
username = 'USERNAME'
password = 'PASSWORD'

headers = { 
    'Accept' : 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
    'Accept-Charset' : 'ISO-8859-1,utf-8;q=0.7,*;q=0.3',
    'Accept-Encoding' : 'gzip,deflate,sdch',
    'Accept-Language' : 'en-US,en;q=0.8',
    'User-Agent' :  'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)', 
    'Authorization': 'Basic %s' % base64.encodestring('%s:%s' % (username, password)),
    'Cache-Control' : 'max-age=0',
    'Connection' : 'keep-alive',
    'Content-Type' : 'application/x-www-form-urlencoded',
    'Cookie' : 'ID=201399',
    'Host' : 'our_company_page.com',
    'Origin' : 'http://our_company_page.com',
    'Referer' : 'http://our_company_page.com/adm/add_form.php',
    'User-Agent' : 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.31 (KHTML, ' 
            'like Gecko) Chrome/26.0.1410.43 Safari/537.31'
    }

data = urllib.urlencode(values)
req = urllib2.Request(url, data, headers)
response = urllib2.urlopen(req)
print response.read() 
```

如您所见，我将 Chrome 网络选项卡中的标头添加到`urllib2`.

Mechainze 版本的另一个变化是我现在`add_form.php`通过将相关 cookie 添加到我的请求中来直接访问该页面。

但是，即使尽我所能复制，我仍然遇到完全相同的问题：响应与我开始时完全相同的页面 - 没有错误，没有成功消息，服务器上没有更改，只是返回到空白表单。

## 最后一步：绝望中，我安装了 WireShark

是时候做一些流量嗅探了。我决心在这个神奇的帖子请求中看到 WTF 正在进行！

我下载、安装并启动 Wireshark。我过滤`http`，然后首先在浏览器中手动提交表单，然后运行我的代码并尝试以编程方式提交表单。

这是网络流量：

## 浏览器：

![在此处输入图像描述](https://i.stack.imgur.com/MbRPB.png)

## Python：

![在此处输入图像描述](https://i.stack.imgur.com/HJFeL.png)

除了标题的顺序略有不同（这很重要）之外，它们看起来完全一样！

所以这就是我完全困惑的地方，为什么一个`post`请求（据我所知）几乎与浏览器发出的请求相同，但没有在服务器上进行任何更改。

有没有人遇到过这样的事情？我错过了一些明显的东西吗？这里发生了什么？

* * *

## 编辑

根据 Ric 的建议，我`POST`准确地复制了数据。我直接从 Chrome 的“网络源”选项卡复制它。

修改后的代码如下

```
data = 'SegmentID=&Segment=FROMPYTHON&SegmentPosition=1&SegmentContains=Sections&fsubmit=Save+Page'
req = urllib2.Request(url, data, headers)
response = urllib2.urlopen(req)
print response.read() 
```

我唯一改变的是`Segment`从`FROMBROWSER`to的值`FROMPYTHON`。

不幸的是，这仍然会产生相同的结果。响应是相同的页面，我从开始。

# 更新

* * *

## 工作，但没有解决

我查看了`requests`库，使用他们的 API 重复了我的工作，并且神奇地它起作用了！POST实际上通过了。问题仍然存在：*为什么*！？我再次用wireshark拍摄了另一个快照，据我所知，它与浏览器发出的POST完全相同。

## 编码

```
def post(eventID, name, pos, containsID):

    segmentContains = ["Sections", "Products"]
    url = 'http://my_site.com/adm/add_page.php'
    cookies = dict(EventID=str(eventID))
    payload = { "SegmentID" : "",
                "FormNumber" : name,
                "RevisionNumber" : str(pos),
                "FormType" : containsID,
                "fsubmit" : "Save Page"
            }

    r = requests.post(
            url, 
            auth=(auth.username, auth.password),
            allow_redirects=True,
            cookies=cookies,
            data=payload) 
```

## Wireshark 输出

* * *

### 要求

![在此处输入图像描述](https://i.stack.imgur.com/BSKCH.png)

### 浏览器

![在此处输入图像描述](https://i.stack.imgur.com/w8LkT.png)

因此，总结一下问题的当前状态。它有效，但我什么都没有真正改变。我不知道为什么使用 Mechanize 和 urllib2 的尝试都失败了。发生了什么让`requests`POST 真正通过？

# 编辑——Wing Tang Wong 建议：

根据`Wing Tand Wongs`建议，我创建了一个 cookie 处理程序，并将其附加到`urllib.opener`. 因此，不再在标头中手动发送 cookie —— 事实上，我现在根本没有分配任何东西。

我首先连接到带有表单链接的 adm 页面，而不是立即连接到表单。

```
'http://my_web_page.com/adm/segments.php?&n=201399' 
```

这会将`ID`cookie 提供给我的`urllib` `cookieJar`. 从这一点开始，我点击链接到包含表单的页面，然后像往常一样尝试提交给它。

### 完整代码：

```
url = 'http://my_web_page.com/adm/segments.php?&n=201399'
post_url = 'http://my_web_page.com/adm/add_page.php'
values = {
    'SegmentID':'',
    'Segment':'FROM_PYTHON1030PM',
    'SegmentPosition':'5',
    'SegmentContains':'Products',
    'fsubmit':'Save Page'
    }
username = auth.username
password = auth.password

headers = { 
    'Accept' : 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
    'Accept-Charset' : 'ISO-8859-1,utf-8;q=0.7,*;q=0.3',
    'Accept-Encoding' : 'gzip,deflate,sdch',
    'Accept-Language' : 'en-US,en;q=0.8',
    'User-Agent' :  'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)', 
    'Authorization': 'Basic %s' % base64.encodestring('%s:%s' % (username, password)),
    'Cache-Control' : 'max-age=0',
    'Connection' : 'keep-alive',
    'Content-Type' : 'application/x-www-form-urlencoded',
    'Host' : 'mt_site.com',
    'Origin' : 'http://my_site.com',
    'Referer' : 'http://my_site.com/adm/add_page.php',
    'User-Agent' : 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.43 Safari/537.31'
    }

COOKIEFILE = 'cookies.lwp'
cj = cookielib.LWPCookieJar()

if os.path.isfile(COOKIEFILE):
    cj.load(COOKIEFILE)

opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))
urllib2.install_opener(opener)

data = urllib.urlencode(values)
req = urllib2.Request(url, headers=headers)
handle = urllib2.urlopen(req)

req = urllib2.Request(post_url, data, headers)
handle = urllib2.urlopen(req)

print handle.info()
print handle.read()
print
if cj:
    print 'These are the cookies we have received so far :'
    for index, cookie in enumerate(cj):
        print index, '  :  ', cookie
    cj.save(COOKIEFILE) 
```

和以前一样。服务器上不会进行任何更改。为了验证 cookie 确实存在，我在提交表单后将它们打印到控制台，它给出了输出：

```
These are the cookies we have received so far :
<Cookie EventID=201399 for my_site.com/adm> 
```

因此，cookie 就在那里，并且已与请求一起发送.. 所以仍然不确定发生了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T23:47:08.677

阅读并重新阅读您的帖子，其他人会回答几次。我的想法：

当您在 mechanize 和 urllib2 中实现时，看起来 cookie 被硬编码到标头响应中。这很可能会导致表单将您踢出局。

当您切换到使用网络浏览器并使用 python 'requests' 库时，cookie 和会话处理正在幕后处理。

我相信，如果您更改代码以考虑 cookie 和会话状态，即。假设在开始时有一个自动会话，站点的 cookie 为空且没有会话数据，但在会话期间正确跟踪和管理它，它应该可以工作。

简单的复制和替换标题数据是行不通的，一个正确编码的网站应该会让你回到开头。

在没有看到网站后端代码的情况下，以上是我的观察。Cookie 和会话数据是罪魁祸首。

编辑：

找到这个链接： [http ://docs.python-requests.org/en/latest/](http://docs.python-requests.org/en/latest/)

其中描述了使用身份验证/等访问站点。身份验证的格式类似于您使用的 Requests 实现。它们链接到一个 urllib2 实现的 git 源，它执行相同的操作，我注意到身份验证位与您执行身份验证位的方式不同：

[https://gist.github.com/kennethreitz/973705](https://gist.github.com/kennethreitz/973705)

从页面：

```
password_manager = urllib2.HTTPPasswordMgrWithDefaultRealm()
password_manager.add_password(None, gh_url, 'user', 'pass')

auth_manager = urllib2.HTTPBasicAuthHandler(password_manager)
opener = urllib2.build_opener(auth_manager) 
```

我想知道您是否更改了为 urllib2 实现实现身份验证位的方式，它会起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T20:13:05.197

我认为 PHP 脚本出错并且没有显示任何内容，因为您的表单数据并不完全相同。尝试将发布请求复制为完全相同，包括所有值。我看到浏览器的 Wireshark 屏幕截图上基于行的文本数据包含参数，例如 SegmentPosition 为 0，但在您的 Python 屏幕截图中没有 SegmentPosition 的值。浏览器和 Python 请求之间的某些参数（例如 Segment）的格式似乎不同，这可能会在尝试解析它时导致错误。

# android - 收到后删除短信android没有延迟

> ID：15733084
> 
> 赞同：7
> 
> 时间：2013-03-31T18:42:24.563
> 
> 标签：android, sms

我有一些代码可以以编程方式删除 Android SMS 消息，但是当我尝试在 onReceive 中删除它时，不会删除任何 SMS。

删除短信的示例代码

```
try {
    // mLogger.logInfo("Deleting SMS from inbox");
    Uri uriSms = Uri.parse("content://sms/inbox");
    Cursor c = context.getContentResolver().query(
        uriSms, new String[] { "_id", "thread_id", "address", "person",
        "date", "body" }, null, null, null);

    if (c != null && c.moveToFirst()) {
        do {
            long id = c.getLong(0);
            long threadId = c.getLong(1);
            String address = c.getString(2);
            String body = c.getString(5);

            if (message.equals(body) && address.equals(number)) {
                // mLogger.logInfo("Deleting SMS with id: " + threadId);
                context.getContentResolver().delete(Uri.parse("content://sms/" + id), null, null);
            }
        } while (c.moveToNext());
    }
} catch (Exception e) {
    // mLogger.logError("Could not delete SMS from inbox: " +
    // e.getMessage());
} 
```

当我把它粘贴进去时`onReceived`，新的短信不会被删除。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-31T21:03:11.783

您需要为清单文件添加权限并增加SMS **Receiver**类的**优先级**

 **```
<receiver android:name=".SMSReceiver" > 
    <intent-filter android:priority="1000"> 
        <action android:name="android.provider.Telephony.SMS_RECEIVED" /> 
    </intent-filter> 
</receiver> 
```

这是因为它会在任何操作系统级别的操作（如保存短信、通知、短信声音等）之前调用 SMSReceiver。

然后在 SMSReceiver **onReceive()**中，您需要添加**abortBroadcast()**以中止任何进一步的广播

```
public void onReceive(Context context, Intent intent) {
  abortBroadcast();
} 
```

就这样

干杯

阿尤什·沙阿

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-14T05:03:04.970

`sms`您必须删除`Smsid`

```
getContentResolver().delete(Uri.parse("content://sms/" + smsid), null, null); 
```**

# node.js - NodeJS 服务器上的独立服务

> ID：15733085
> 
> 赞同：0
> 
> 时间：2013-03-31T18:42:36.890
> 
> 标签：node.js, express

我想知道如何构建我的 NodeJS 服务器。我想将我网站上提出的服务分开，以便将来安装集群并拥有许多服务器（每台服务器都允许执行一项特殊任务）。

**例子 ：**

1.  拥有一个项目的“主”服务器：ExpressJS 和数据库
2.  有一个项目的“通信服务器”：聊天+论坛
3.  其他项目：用于复杂计算（生成图表/统计/电子邮件）

你能解释一下这种复杂网站的不同方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T11:03:07.620

正如 Benjamin Gruenbaym 所说，建筑属于别处。

如果您想知道如何在单个服务器上设置应用程序，请记住一些事项。

1.  NodeJS 在单个进程中运行，因此理想情况下它应该占用 CPU 的 1 个核心。如果您在同一台服务器上运行数据库，那是另一个核心。因此，如果它有足够数量的内核，那么在同一台服务器上托管所有节点应用程序可能会很好。
2.  要在同一台机器上运行两个不同的 Node 进程，您只需一个接一个地启动它们，但要确保它们侦听不同的端口。
3.  为确保以后可以横向扩展应用程序，在相互识别服务时使用域名而不是 IP 地址非常重要。所以 nodeJS 应用程序应该知道数据库是 mydatabase.mycompany.com，而不是 192.168.1.10 或任何其他 IP 地址。这将允许您稍后将数据库移动到另一个网络地址或使用负载平衡器。

# .net - ProcessStartInfo 的 UseShellExecute 和 CreateNoWindow 有什么区别？

> ID：15733086
> 
> 赞同：4
> 
> 时间：2013-03-31T18:42:37.887
> 
> 标签：.net, process, windows-shell

如果我要编写一个控制台应用程序来启动另一个控制台应用程序作为新进程，并使用默认的“UseShellExecute”和“CreateNoWindow”值，结果是控制台应用程序窗口旁边会出现一个新的命令行窗口：

```
 UseShellExecute=true and CreateNoWindow=false 
```

现在，如果我要使用以下内容，将不会创建新窗口，但已启动进程的输出将出现在启动它的应用程序的窗口上：

```
 UseShellExecute=false and CreateNoWindow=false 
```

如果我要使用以下内容，则不会创建新窗口，启动进程的输出也不会出现在启动它的应用程序的窗口上：

```
 UseShellExecute=false and CreateNoWindow=true 
```

但是好像UseShellExecute=true时“CreateNoWindow”没有任何作用，那么UseShellExecute=true时“CreateNoWindow”起什么作用呢？仅当作为新进程启动的应用程序是 Forms 应用程序时才适用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-31T21:04:27.670

它没有任何作用。规则是 CreateNoWindow 仅在以下情况下才会生效：

1.  您使用 UseShellExecute = false 以便使用 CreateProcess() winapi 启动程序
2.  您启动的程序是控制台模式应用程序。

如果应用程序是创建自己的窗口的本机 Windows GUI 应用程序，那么您可以要求它不使用 WindowStyle = ProcessWindowStyle.Hidden 创建可见窗口。然而，有很多程序忽略了这个请求。他们应该，阻止它的唯一方法是通过任务管理器。下一个合理的选择是 ProcessWindowStyle.Minimized

# c# - 如何将具有 bool Contains(T) 方法的 T 描述为接口？

> ID：15733095
> 
> 赞同：2
> 
> 时间：2013-03-31T18:43:45.600
> 
> 标签：c#, .net, interface

我希望有一个行为接口，类似于`string.Contains`说有一个代表 RabbitMq 标签之类的东西的类。说有`'1.222.3331.1'`并在上面说`.Contains(`122为`)`假，`.Contains(`1为`)`真。

我试过了：

```
 interface ITag
    {
        bool Contains(ITag tag);
    } 
```

然而，它的实施将仅限`Contains`于`ITag`提供以下内容：

```
 class Tag : ITag
    {
        public bool Contains(ITag tag)
        {
            throw new NotImplementedException();
        }
    } 
```

虽然我想拥有例如：

```
 class Tag : ITag
    {
        public string s;
        public bool Contains(Tag other)
        {
            return s.Contains(other.s);
        }
    } 
```

我想知道我将什么描述为可实现的接口以及如何实现，是否有任何现成的 .Net 接口可以实现`.Contains`？

我当然可以

```
 interface ITag<T>
    {
        bool Contains(T tag);
    } 
```

而不是用类似的东西来实现它：

```
 class Tag : ITag<Tag>
    {
        public Tag(string tag)
        {
            Content = tag;
        }

        public string Content { get; private set; }

        public bool Contains(Tag other)
        {
            return other != null 
                && other.Content != null
                && Content.Contains(other.Content);
        }
    } 
```

然而，我需要制作所有使用`ITag<T>`Generic 的接口，而这是不需要的。有非通用的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T18:53:48.533

以下将编译：

```
interface ITag<in TTag> where TTag : ITag<TTag>
{
    bool Contains(TTag tag);
}

class Tag : ITag<Tag> 
{
    public bool Contains(Tag t)
    {
        return false;
    }
} 
```

也就是说，与仅使用具体类型相比，整个构造并不是很有用，因为您始终需要将其包含在变量声明中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-31T20:05:45.933

您可以创建两个接口`ITag`和`ITag<T>`，其中通用接口扩展了非通用接口，如下所示：

```
public interface ITag
{
    bool Contains(ITag tag);
}

public interface ITag<T> : ITag
    where T : ITag<T>
{
    bool Contains(T tag);
} 
```

然后在一个实现的类中，`ITag<T>`我会做这样的事情：

```
public class Foo : ITag<Foo>
{
    public bool Contains(Foo tag) ...

    bool ITag.Contains(ITag tag)
    {
        Foo other = tag as Foo;
        if (other == null)
            return false;

        return Contains(other);
    }
} 
```

# php - 通用数据库连接

> ID：15733097
> 
> 赞同：0
> 
> 时间：2013-03-31T18:43:47.843
> 
> 标签：php, sql

我正在构建会话处理机制，其中我使用了几个 sql 查询。这些查询是硬编码的，以后用户不应更改其中的任何内容。

我应该使用什么类型的 sql 连接？

如果用户将安装另一个数据库等，通常的 mysql 连接将不起作用。

用户在配置文件中定义了他的数据库类型，但是，我想我不会对它们的所有类型进行查询。

我该如何处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T18:51:13.363

使用 PDO -> [http://www.php.net/manual/en/pdo.connections.php](http://www.php.net/manual/en/pdo.connections.php)

在这个例子中：

```
 $dbh = new PDO('mysql:host=localhost;dbname=test', $user, $pass); 
```

使用变量 $database_dirver 更改 mysql，以便用户将其填满。

```
 $dbh = new PDO(''. $database_driver .':host=localhost;dbname=test', $user, $pass); 
```

# mysql - MySQL 错误代码 1005，errno 105

> ID：15733098
> 
> 赞同：-1
> 
> 时间：2013-03-31T18:43:48.470
> 
> 标签：mysql, mysql-workbench

我在 MySQL Workbench 中设计了 DB - 通过 EER 模型。

错误日志： http: [//pastebin.com/iMJP5aRT](http://pastebin.com/iMJP5aRT)

还有我的 SQL 代码： http: [//pastebin.com/QzZvd164](http://pastebin.com/QzZvd164)

我的模型：www55.zippyshare.com/v/52649774/file.html

**它出什么问题了？这很奇怪，因为它是在 MySQL Workbench 中创建的，而不是我自己创建的。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:02:42.477

您没有引用主键！（表患者）：

```
REFERENCES `lekarze`.`visits` (`idpatients` ) 
```

和（在餐桌访问中）

```
PRIMARY KEY (`idvisits`) ) 
```

不匹配。

您没有引用访问表的主键。

最好的，雅尼斯

# php - json php 5.3.23 centos 5 json

> ID：15733100
> 
> 赞同：0
> 
> 时间：2013-03-31T18:44:02.633
> 
> 标签：php, json, centos

我在尝试安装和配置 json 时遇到问题。

我现在的错误是>

```
# PHP warning: PHP Startup: Unable to load dynamic library '/usr/lib64/php/modules/json.so' - /usr/lib64/php/modules/json.so: undefined symbol:ZVAL_DELREF in unknown on line 0 -bash: PHP: command not found
#PHP depracated: Directive safe mode is depracated in PHP 5.3 and greater in unknown on line 0 
```

我遵循了这些指示 -

1.  下载json包

    `# wget http://pecl.php.net/get/json-1.2.0.tgz`

2.  解压并转到新创建的目录

    `# tar -zxf json-1.2.0.tgz` `# cd json-1.2.0`

3.  创建配置文件并配置json

    `# phpize` `# ./configure`

4.  创建安装文件并安装

    `# make` `# make install`

完成后会在`/usr/lib64/php/modules/`目录下创建json.so，需要被php配置目录调用

```
# cd /etc/php.d 
# echo “extension=json.so” >> json.ini 
```

一切似乎都很好，但现在我在转圈。谁能建议我应该从哪里开始寻找或研究来纠正这个问题？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:03:52.720

如果您在使用 json_encode 或 json_decode 函数时遇到错误？如果他们工作正常。然后你可以完全忽略安装pecl json。由于 json 是 php 5.3 核心的一部分。您无需安装它。[在这种情况下可以忽略php json](http://www.php.net/manual/en/json.requirements.php)启动错误。

# java - 如何将 Play Framework 2.x 模块的托管代码添加到 Eclipse 依赖项？

> ID：15733101
> 
> 赞同：0
> 
> 时间：2013-03-31T18:44:10.563
> 
> 标签：java, scala, playframework, playframework-2.0

我使用 eclipsify 为我的应用程序制作了一个 Eclipse 项目。然后我将代码添加`appHome/target/scala-2.9.1/src_managed/main`到依赖列表中，除了调用模块的代码外，一切正常。看来我错过了一些属于他们的课程。我在哪里可以找到它们？Play 将这些模块生成的代码放在什么地方？

我目前正在运行 Play 2.0.2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T14:42:50.080

何塞！您不应更改目标文件夹中的任何代码。此文件夹是从您的源文件夹自动生成的。因此，只需尝试从项目中删除目标文件夹，然后再次使用 compile 和 eclipsify。希望它会有所帮助。

# iphone - 在购买时隐藏横幅？

> ID：15733102
> 
> 赞同：0
> 
> 时间：2013-03-31T18:44:15.320
> 
> 标签：iphone, ios, xcode, ipad

购买时，我正在努力隐藏横幅视图。

我有 2 个不同的版本，一个是 Admob 横幅 (bannerView_)，另一个实际上是我称之为 _adView 的视图，它们共享同一个地方，但根据查看的内容旋转。

反正Admob横幅隐藏没问题，但_adView没有，这里是隐藏代码；

```
-(void)removeBanner:(NSNotification *) notify {
    NSLog(@"Removing:");
    if ([MKStoreManager isFeaturePurchased:@"com.fredsworld.ubercool.removeads"]) {
        [bannerView_ setHidden:YES];
        [_adView setHidden:YES];

        NSLog(@"Removed:");
    }
} 
```

基本上是在购买时运行，所以它会立即更新屏幕，

在 viewDidLoad 中调用它的 _adView 代码是；

```
 CGFloat y = self.view.frame.size.height - 50.0;
        TapForTapAdView *adView = [[TapForTapAdView alloc] initWithFrame: CGRectMake(0, y, 320, 50) delegate: self];
        [self.view addSubview: adView]; 
```

我已经合成了 adView 并将其创建为一个对象，但仍然没有任何乐趣，购买时它并没有消失。

虽然，它确实有效，就像你关闭应用程序，然后重新打开一样，它已经消失了，但显然我希望它在购买后立即消失。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T00:42:53.590

通过删除第 2 行的 TapForTapAdView *adView 并简单地更改为 self.adView =

# java - 如何检查是否从 TextView 中删除了一行或多行？

> ID：15733111
> 
> 赞同：0
> 
> 时间：2013-03-31T18:45:10.817
> 
> 标签：java, android, textview

我正在制作一个 ide 并使用 TextView 根据我的 EditText 的行数显示行号。我可以添加新行但如何检查是否已删除行并减少 TextView 的行数？

```
et.setOnKeyListener(new OnKeyListener() {

@Override
public boolean onKey(View v, int keyCode, KeyEvent event) {
    if ((event.getAction() == KeyEvent.ACTION_DOWN) &&
        (keyCode == KeyEvent.KEYCODE_ENTER)) {
        lines++;
        lineNumbers.append(lines+"\n");            
    }
    return false;
} 
```

});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:49:57.720

这完成了工作。

```
private void openFile(final File aFile) {
        String nullChk = et.getText().toString();
        exists = true;

        if (!changed || nullChk.matches("")) {
            try {
                currentFile = aFile;
                et.setText(new Scanner(currentFile).useDelimiter("\\Z").next());
                lineNumbers.setText("");
                lines = 1;

                for (int i = 1; i < et.getLineCount(); i++) {
                    lineNumbers.append(lines + "\n");
                    lines++;
            ...
}

et.setOnKeyListener(new OnKeyListener() {

            @Override
            public boolean onKey(View v, int keyCode, KeyEvent event) {
                if ((event.getAction() == KeyEvent.ACTION_DOWN)
                        && (keyCode == KeyEvent.KEYCODE_ENTER)) {
                    lines++;
                    lineNumbers.append(lines + "\n");
                }
                if ((event.getAction() == KeyEvent.ACTION_DOWN)
                        && (keyCode == KeyEvent.KEYCODE_DEL)) {
                    lineNumbers.setText("");
                    lines = 0;

                    for (int i = 1; i < et.getLineCount(); i++) {
                        lines++;
                        lineNumbers.append(lines + "\n");
                    }
                }
                return false;
            }
        }); 
```

# c++ - 在 C++ 中实现蛮力

> ID：15733115
> 
> 赞同：-1
> 
> 时间：2013-03-31T18:45:47.847
> 
> 标签：c++, brute-force, array-algorithms

我有一个问题涉及优化包含 2 名玩家的游戏。所以我们有一个有许多边和一些顶点的无向连通图。每个玩家都必须删除边，如果一个顶点被孤立，他的分数会增加一，然后你必须删除另一条边。该图以所谓的“邻接矩阵”表示。对于数组中的每个顶点，两个顶点之间都有一个连接例如，如果我们有一个三角形，我们有以下数组：

0 1 1 第一行

1 0 1 第二行

1 1 0 第三排

行对应于顶点，列对应于它与其他顶点的可能连接。我们被分配使用递归函数来应用蛮力。我花了很多心思来编写这个函数的代码。我实现了一些代码并编译并运行它。我完全不知道为什么它不起作用。我的这个功能的代码：

```
 class Matrix {
        public:
    int berekenZet (bool** array, bool player);
    int berekenScore (bool** array, int rij, int kolom);
    bool checkRij (bool** array, int rij);
    void setGetal (int nummer) {getal = nummer;};
    Matrix ();

private:
    int getal;

    int maxScoreA;
    int huidigScore;
    int maxverschil;
    int maxScoreB;
    int tellerHuidig; 
```

矩阵::矩阵() {

```
 huidigScore = 0;
maxScoreA = 0;
maxScoreB = 0; 
```

}

```
 bool Matrix::checkRij (bool** array, int rij) {

            for (int i=0; i<getal; i++) {
    if (array[rij][i] == true)
        return false;
  }
  return true; 
```

}

```
 int Matrix::berekenScore (bool** Array, int rij, int kolom) {
if (checkRij (Array, rij) == true )
    huidigScore ++;
if (checkRij (Array, kolom) == true) 
    huidigScore ++;
return huidigScore; 
```

}

```
 int Matrix::berekenZet (bool** array, bool player) {
  int score = 0;
  int bestescore = -5;
  int slechtstescore = 5;
  int something;
  something = 0;

  for(int i = 0; i < getal; i++){
  for(int j = i + 1; j <getal; j++){
  huidigScore = 0;

  if(array[i][j]){
    something++;
    array[i][j] = false;
    array[j][i] = false;
    score = 0;
    if(player == true){
      score = score + berekenScore(array, i ,j ); 
      }
    else{
      score = score - berekenScore(array, i, j);
      }
      cout << "player" << player << endl;
      cout << "score" << score << endl;

    if(huidigScore == 0)
      score = score + berekenZet(array, !player);
    else
      score = score + berekenZet(array, player);

    if(player == true && score > bestescore)
      bestescore = score; 
    else if(player == false && score < slechtstescore)
      slechtstescore = score;

      array[i][j] == true;
      array[j][i] == true;

  } //if
}//for
}//for 

if(player == true && something != 0){
cout << "bestescore" << bestescore << endl;
return bestescore;
}//  if outside of double for loop
else if(player == false && something != 0){
cout << "slechtstescore" << slechtstescore << endl;
return slechtstescore;
} // else if outside of double for loop  

else if(something = 0){
cout << "bestescore" << bestescore << endl;         
return 0;

}  // determine whether array was empty when function was called 
```

bestescore 和 slechtstescore 是荷兰语的最佳和最差分数。berekenScore 调整删除边后获得的点数并将其保存在 huidigScore 中。所以基本上是 0、1 或 2。

我在 int main 中调用这个函数：

```
cout << "Aantal takken: " << takken << endl;

a = matrix.berekenZet(Array, player); 
```

我使用以下邻接矩阵运行它：

5

0 1 1 1 1
1 0 1 0 0
1 1 0 0 0
1 0 0 0 0
1 0 0 0 0

它只输出“score”5次，所以它似乎忽略了函数中的for循环，bestescore曾经设置为几百万值，然后设置为5。我不是一个很有经验的程序员，所以我可能只是错过了什么..??

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:03:48.583

在您的示例中，您只有 5 条边，因此 score 仅输出五次。嵌套循环

> for(int i = 0; i < getal; i++)
> for(int j = i + 1; j < getal; j++)

迭代所有可能的边，条件 if(array[i][j]) 过滤掉真正的边，所以循环只会执行 |E| 次。

此外，在您设置的循环中

> ```
> array[i][j] = false;
> array[j][i] = false; 
> ```

接着

> ```
> array[i][j] == true;
> array[j][i] == true; 
> ```

因此一次只删除一个边缘。您可能需要一个同时删除多个边缘的循环来获得蛮力实现。

编辑：您似乎没有在每次通话时都重置 huidigScore 。我建议按如下方式更改您的辅助函数：

> ```
> int Matrix::berekenScore (bool** Array, int rij, int kolom) 
> {
> int huidigScore = 0; 
> if (checkRij (Array, rij) == true )
>   huidigScore ++; 
> if (checkRij (Array, kolom) == true) 
>   huidigScore ++; 
> return huidigScore;
> } 
> ```

上述函数将 huidigScore 作为私有变量。现在，而不是下面的代码片段：

> ```
> if(player == true){
>   score = score + berekenScore(array, i ,j ); 
>   }
> else{
>   score = score - berekenScore(array, i, j);
>   }
>   cout << "player" << player << endl;
>   cout << "score" << score << endl; 
> ```

你可以有

> ```
> int huidigScore = berekenScore(array, i ,j )
> if(player == true){
>   score = score + huidigScore; 
>   }
> else{
>   score = score - huidigScore;
>   }
>   cout << "player" << player << endl;
>   cout << "score" << score << endl; 
> ```

一般建议：尽可能避免使用公共变量。它们使程序的推理和调试复杂化。

# ruby-on-rails - 'rails server' 启动两次，都关闭。黄瓜仍然有效

> ID：15733117
> 
> 赞同：0
> 
> 时间：2013-03-31T18:45:57.440
> 
> 标签：ruby-on-rails, webserver, thin

我的 Rails 应用程序无法在开发模式下启动。它似乎在生产和测试模式下都有效。这是我运行“rails server”时得到的结果：

```
Thin web server (v1.5.1 codename Straight Razor)
Maximum connections set to 1024
Listening on 0.0.0.0:51960, CTRL+C to stop
Booting Thin
Rails 3.2.11 application starting in development on http://0.0.0.0:3000
Call with -d to detach
Ctrl-C to shutdown server
Thin web server (v1.5.1 codename Straight Razor)
Maximum connections set to 1024
Listening on 0.0.0.0:3000, CTRL+C to stop
Exiting 
```

我发现的一个线索是，每次调用 rails 之前似乎都开始变薄了。例如，当我调用 rails 控制台时会发生以下情况：

```
Thin web server (v1.5.1 codename Straight Razor)
Maximum connections set to 1024
Listening on 0.0.0.0:52262, CTRL+C to stop
Loading development environment (Rails 3.2.11) 
```

此错误已出现在两台不同的计算机上。第一个（macbook）我只是将 github 存储库克隆到一个新文件夹中并从那里启动它，修复一些东西（如何？不确定）。第二台计算机 (iMac) 对此没有响应。

我正在使用 ruby​​ 1.9.3、rails 3.2 和 Thin 1.5.1。

更神秘的是，从我的 gemfile 中删除 thin 并不能修复错误。Rails 仍然使用 Thin 启动。在我的项目的其余部分中，我找不到对 Thin 的直接引用。

请原谅我对 Rails 和 Web 服务器内部的相对无知。关于可能导致这种情况的任何想法？

PS我知道[这个SO问题](https://stackoverflow.com/questions/10604664/rails-3-2-and-thin)并且那里的解决方案对我不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T21:19:56.100

我发现了原因。我在开发和测试中都在运行 gem 'fake_braintree'。它仅在测试中运行。当它运行时，它会启动一个与我要运行的瘦服务器冲突的瘦服务器。

# vb6 - WebBrowser.Navigate 每 X 分钟刷新一次

> ID：15733126
> 
> 赞同：0
> 
> 时间：2013-03-31T18:46:33.703
> 
> 标签：vb6, browser, browser-refresh

我正在使用 VB6 制作一个应用程序，其中使用此代码启动 WebBrowser 窗口，它每 3 分钟刷新一次页面

```
 Private Sub Form_Load()
 WebBrowser1.Navigate ("http://www.google.com")
 End Sub

  Private Sub T_Timer()

 'Increment minute count
  FireCount = FireCount + 1

  If FireCount = 3 Then
'Reset to 0 for next time
 FireCount = 0
 WebBrowser1.Refresh ("http://www.google.com")
'Refresh web browser
  End If
 End Sub 
```

但它给了我一个警告说编译错误：错误的数字或参数或无效的属性分配。谁能帮我找出我的错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T20:18:15.660

假设 WebBrowser1 是一个 WebBrowser 控件，则您错误地调用了**Refresh()**方法。**WebBrowser.Refresh()**不带参数：

```
'Refresh web browser
WebBrowser1.Refresh 
```

来自[MSDN](http://msdn.microsoft.com/en-us/library/aa232695%28v=vs.60%29.aspx)：

> **参数数量错误或属性分配无效（错误 450）**
> 
> 过程的参数数量必须与过程定义中的参数数量相匹配。

您还可以注意到，当编译失败时，VB6 IDE 会将焦点设置到有问题的行。与错误描述一起考虑，此信息通常足以查明简单的语法错误。

# html - 用于下拉选择的 jQuery 方程

> ID：15733130
> 
> 赞同：0
> 
> 时间：2013-03-31T18:46:52.887
> 
> 标签：html, ajax, jquery

好的，基本上我有一个 jquery 对话框，在那个对话框中它会问一些问题，例如，你打算留在校园里吗，你是州内/州外的学生，你打算参加多少年. 根据用户的选择，我希望它根据下拉列表将成本加总为 (tutuion + Room & Board) * 年的值。

这是我到目前为止所拥有的..

```
if ( bValid ) {
        $( "#users tbody" ).append( "<tr>" +
            "<td>" + username.val() + "</td>" +
            "<td>" + $('#studenttut>option:selected').val() + "</td>" +
            "<td>" + $('#campusrb>option:selected').val() + "</td>" +
            "<td>" + $('#yearsatten>option:selected').val() + "</td>" +
        "</tr>" );
        $( this ).dialog( "close" );
      }
    }, 
```

这些是我在 jquery 中的值，我可以输入一个简单的公式来计算大学的总费用吗？谢谢，麻烦您了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T18:51:39.747

如果要在 javascript 中添加许多值，则必须使用 parseint()

例子： `total = parseInt(student.opt1)+parseInt(student.opt2);`

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseInt](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseInt)

# php - 通过单击另一个页面来填充文本字段

> ID：15733131
> 
> 赞同：0
> 
> 时间：2013-03-31T18:46:58.033
> 
> 标签：php, html, hyperlink

我有两页。当我单击第一页上的链接时，它会填充第二页上的文本字段（从“来自”获取值）。我的第一页代码 abc.php ：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<body>
<p><strong>From</strong> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>&nbsp;Subject</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>Reply</strong></p>
<p>biri&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deneme girdi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#">click</a></p>
</body>
</html> 
```

这是第二页 kum.php ：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<body>
<form id="form1" name="form1" method="post" action="">
  <label>
    <input type="text" name="hum" id="hum" />
  </label>
</form>
</body>
</html> 
```

我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:51:57.150

您可以获取用户来自的网址`$_SERVER['HTTP_REFERER'];`

`<input type="text" name="hum" id="hum"`
`<?php if ($_SERVER['HTTP_REFERER'] == "http://examplepage.com/start/"){?> value="hi" <?php } ?> />`
（未经测试，只是为了让您了解如何使用它）

# c++ - C ++将颜色值字符串转换为int

> ID：15733136
> 
> 赞同：2
> 
> 时间：2013-03-31T18:47:28.170
> 
> 标签：c++, colors, int

我试图通过读取文件来转换颜色代码，检索颜色代码并将其存储为字符串。这行得通，但是当我试图简单地将它转换为 int 时，它不起作用 - 当我执行 cout 时总是得到 0。

```
string value = "0xFFFFFF";
unsigned int colorValue = atoi(value.c_str());
cout << colorValue << endl; 
```

如您所见，我得到的颜色是 0xFFFFFF，但将其转换为 int 只会给我 0。有人可以告诉我我缺少什么或我做错了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T18:52:22.973

我建议使用字符串流：

```
std::string value = "0xFFFFFF";
unsigned int colorValue;
std::stringstream sstream;
sstream << std::hex << value;
sstream >> colorValue;
cout << colorValue << endl; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T18:53:27.140

正如@BartekBanachewicz 所说，`atoi()`这不是 C++ 的方式。利用 C++ 流的强大功能并使用`std::istringstream`它来为您完成。看到[这个](http://www.daniweb.com/software-development/cpp/code/217375/converting-a-numerical-value-to-a-string-and-vice-versa)。

摘录：

```
template <typename DataType>
DataType convertFromString(std::string MyString)
{
    DataType retValue;
    std::stringstream stream;
    stream << std::hex << MyString; // Credit to @elusive :)
    stream >> retValue;
    return retValue;
} 
```

# actionscript-3 - 游戏中菜单的 addEventListener 和 gotoAndStop 出现错误

> ID：15733139
> 
> 赞同：0
> 
> 时间：2013-03-31T18:47:56.663
> 
> 标签：actionscript-3, flash, menu, addeventlistener, submenu

我是 Flash as3 的新手。今天，我正在尝试在游戏中编写一个菜单，该菜单将引用游戏的开始屏幕来显示游戏的按钮。

在此开始屏幕中，有一个按钮可以链接回菜单。它不起作用。我得到这个，

错误：

```
TypeError: Error #1009: Cannot access a property or method of a null object reference.
    at SuperSpill_fla::MainTimeline/frame1() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:12:42.877

在我看来，唯一可能发生的事情是 mus 不再存在。这表明代码在 mus 不再出现在舞台上的框架中运行。

我希望在大多数版本的 Flash Player 中，帧不会在 goToAndStop 和下一行之间完全呈现，但我的建议是交换这些行的顺序或将其更改为

```
event.currentTarget.removeEventListener(MouseEvent.CLICK, musSpill) 
```

# c - 外部全局变量的动态分配

> ID：15733142
> 
> 赞同：0
> 
> 时间：2013-03-31T18:48:13.763
> 
> 标签：c, memory, extern

我在一个共享库中有一个全局变量，其中包含一个`int*`.

当我尝试为其分配内存时，从我的程序内部，我收到一个`double free or memory corruption error`from `glibc`. 有趣的是，在最新版本的 glibc 上不会发生这种情况。

代码是这样的：

`typedef struct{ int a; int b; mytype_t *t; } A`

在图书馆我有 `A *a;`

在代码中 `a = malloc ( sizeof ( A ) ); a->t = malloc ( sizeof( *t) );`

第一个 malloc 工作正常，只有当我做第二个时我才有问题。当我尝试释放 a->list 时，上述错误就出现了。`a`在 a->list 之前没有被释放。

谢谢你。

`**EDIT**`

我已经解决了这个问题，但我真的不知道为什么。我使用 calloc 而不是 malloc 而不是`malloc( sizeof(*t) )`，我使用`calloc ( sizeof ( mytype_t ) )`;

# java - 从数组中的关键字中搜索字符串

> ID：15733143
> 
> 赞同：1
> 
> 时间：2013-03-31T18:48:16.850
> 
> 标签：java, arrays

我不明白为什么这不起作用？我正在尝试从字符串中的数组中查找关键字，并在控制台中打印数组的索引号。我已经尝试了带有和不带有布尔值“true”的“if”语句

```
public class Testing 
{
    public static void main(String[] args)
    {
    String[] keywords = new String[5];
    keywords[0] = "boat";
    keywords[1] = "car";
    String myString = "the banana car";

          for(int a = 0; a <= keywords.length; ++a)

          {

             if(myString.contains(keywords[a])== true)
                {

                System.out.println(myString.indexOf(keywords[a]));
                }
             else
                {
                System.out.println("Those keywords are not in that string"); 
                }

           }
     }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-31T18:52:49.853

```
String[] keywords = new String[5];////////////here you have array with 5 element
    keywords[0] = "boat";
    keywords[1] = "car";
//////////you just full index 0 and index 1 
```

**然后你 for 循环关键字**的长度

 **```
for (int a = 0; a <keywords.length; a++) 
//////keywords.length=5 , index 0 and index 1 have a value but the other index is empty 
```

**所以 ：**

*   您需要填写关键字数组：

    ```
     keywords[0] = "boat";
     keywords[1] = "car";
     keywords[2] = //////////;
     keywords[3] = //////////;
     keywords[4] = ///////; 
    ```

*   或使长度= 2：

    ```
    String[] keywords = new String[2]; 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T18:53:55.547

您已将 String 数组声明为包含 5 个元素，因此缺少 3 个额外元素

```
String[] keywords = new String[5];
    keywords[0] = "boat";
    keywords[1] = "car"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-31T18:54:01.610

`a <= keywords.length`应该是`a < keywords.length`，如果您声明它的大小为*5*以具有*5 个*元素（从 0 到 4），则应该填充该数组。

数组在*Java*中为零，所以如果你有长度为**n**的数组，那么索引是从**0**到**n-1**（总和为*n*）

另一个重要的事情：

在`if(myString.contains(keywords[a])== true)`中，`== true`是多余的，因为`myString.contains(keywords[a])`返回*true*或*false*，在这里您只想检查它。因此，删除`== true`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-31T18:54:30.757

你还没有初始化你的所有元素`keywords`，因此你会得到一个`NullPointerException`

如果您只想检查初始化的前两个元素，请将 for 循环更改为以下内容：

```
for (int a = 0; a <= 1; ++a) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-31T18:57:38.783

这个程序：

```
public class Testing {

   public static void main( String[] args ) {
      String[] keywords = new String[]{ "boat", "car" }; // Only 2 not 5
      String myString = "the banana car";
      for( String keyword : keywords ) {
         int index = myString.indexOf( keyword );
         if( index > -1 ) {
            System.out.println(
               "Keyword '" + keyword + "' is in the string '" +
               myString + "' at position " + index ); 
         }
         else
         {
            System.out.println( "Keyword '" + keyword +
               "' is not in the string '" + myString + "'" ); 
         }
      }
   }
} 
```

输出：

```
Keyword 'boat' is not in the string 'the banana car'
Keyword 'car' is in the string 'the banana car' at position 11 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-31T18:55:09.980

```
public static void main(String[] args) {
    String[] keywords = {"boat", "car"};
    String myString = "the banana car";
    for(int i = 0; i < keywords.length; i++) {
        System.out.println(myString.contains(keywords[i]) ? myString.indexOf(keywords[i]) : "Those keywords are not in that string");

    }
} 
```

..应该管用**

# ruby - Ruby SQL Server 和 Do 块

> ID：15733145
> 
> 赞同：0
> 
> 时间：2013-03-31T18:48:37.837
> 
> 标签：ruby, sql-server, tiny-tds

我有以下代码：

```
sql = "select Board_Name AS 'Board Name', COUNT(Board_Name) AS 'Count' from dbo.TABLE  GROUP BY Board_Name"
result = client.execute(sql)
result.each do |row|
  binfo = [ label: row['Board Name'], value: row['Count'] ]
  send_event('ticketsbyboard', { items: binfo })
end 
```

我试图将所有传递给 send_event 的行作为一个数组，而不是一次只有一行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:00:01.703

试试地图：

```
binfo = result.map do |row|
  { label: row['Board Name'], value: row['Count'] }
end
send_event('ticketsbyboard', { items: binfo }) 
```

如果您的`result`对象不直接响应`map`，只需使用`result.to_a.map`

# ruby - 如何在我的 gemspec 中使用来自 github 的依赖项？

> ID：15733148
> 
> 赞同：13
> 
> 时间：2013-03-31T18:48:54.363
> 
> 标签：ruby, gemfile, gemspecs

我的 Gemfile 目前有以下内容：

```
gem 'voteable_mongo'#,       :github => 'kamilski81/voteable_mongo' 
```

我将我的模型迁移到 .gemspec 中，但我不确定这在我的 gemspec 中会是什么样子。我目前有：

```
s.add_dependency "voteable_mongo" 
```

但这最终使用了错误的依赖项（我克隆的原始依赖项）我想使用我的依赖项。我如何将我的 gemspec 依赖项指向我的 github 存储库？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-31T19:59:38.593

如[gem 规范](http://docs.rubygems.org/read/chapter/20#dependencies)中所述，您通过提供的 gem 列表`add_dependency`将用于确保在安装过程中已将它们安装在系统中（即`gem install`），因此`git`选项没有意义，因为这不会触发任何依赖项的任何附加安装（就像这样`Bundler`做）。

总而言之：不可能在一个`.gemspec`

# hadoop - 输入输出参数错误Hadoop

> ID：15733151
> 
> 赞同：0
> 
> 时间：2013-03-31T18:49:05.050
> 
> 标签：hadoop, mapreduce

我有一个映射器，它的输入/输出参数是：
（LongWritable，Text，WordPair，IntWritable）
和输入/输出参数的reducer是：
（WordPair，IntWritable，WordPair，DoubleWritable）

我已将 JobConf 设置为：
conf.setOutputKeyClass(WordPair.class);
conf.setOutputValueClass(DoubleWritable.class);
conf.setMapOutputValueClass(IntWritable.class);
conf.setOutputFormat(TextOutputFormat.class);

但我收到错误消息：
-Java IOException DoubleWritable is not a class
-Map Job Failed

在进入减速器阶段之前，这项工作也失败了。我的这部分配置是否正确？我相信我在这里与参数做了一些不匹配。

我需要提供更多信息吗？我正在做相对频率问题，我需要从 Double 类型的减速器值输出，并且我使用的是 Old Api。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T20:59:20.170

我已经弄清楚了这个问题，我知道我正在回答我自己的问题，但这只是因为我想让其他人知道他们是否有同样的问题。

这个问题来了，因为我已经提到我的组合器类与reducer类相同，但是根据这个问题mapper的输入/输出与reducer的输入/输出不同，而组合器应该具有与mapper相同的输入/输出。

所以我删除了我设置组合器的行，它工作正常。

# c# - MVC3项目中标准ninject和ninject.web.mvc之间的区别？

> ID：15733159
> 
> 赞同：3
> 
> 时间：2013-03-31T18:50:07.820
> 
> 标签：c#, asp.net-mvc-3, ninject, ninject.web.mvc

我了解 Ninject 的一些功能，并且能够将其用于 IoC。

当我使用 NuGet 向 VS2010 中的项目添加对 Ninject 的引用时，我在列表中看到了其他 Ninject 扩展。特别是 Ninject.MVC3。同样在扩展名下的 Ninject 网站上 ( [http://www.ninject.org/extensions.html](http://www.ninject.org/extensions.html) ) 我看到了 Ninject.Web.Mvc。

如果我正在创建 MVC3 应用程序，我需要使用 Ninject 的这个扩展吗？我对带有类/接口的 IoC 的 Ninject 的基本使用是否需要标准库之外的任何东西？

MVC3 项目中的 Ninject 和 Ninject.MVC3/Ninject.Web.Mvc 有什么区别？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-31T19:12:33.597

`ninject.web.mvc`是 ASP MVC (3) 应用程序的 ninject（核心）补充。基本上 - 当你想在 ASP MVC 项目中使用 Ninject 时，你应该使用它。

从[文档](https://github.com/ninject/ninject.web.mvc/wiki/MVC3)中：

> 此扩展允许 Ninject 核心和 ASP.NET MVC 项目之间的集成。要使用它，只需让您的 HttpApplication（通常在 Global.asax.cs 中）扩展 NinjectHttpApplication：

MVC 3 扩展包含将 DI 组合根连接到 MVC 应用程序的关键方法 - 这意味着 Ninject 将负责实例化您的控制器，该控制器依赖于其他组件（Ninjects '覆盖' 的使用`DefaultControllerFactory`只能创建具有无参数构造函数的控制器）。

*在文档中提到了两种方法，[如何做到这一点](https://github.com/ninject/ninject.web.mvc/wiki/Setting-up-an-MVC3-application)：扩展`NinjectHttpApliaction`in`global.asax`或使用文件夹`NinjectWebCommon`内的类。`App_Start`*

还有[ninject.web.common](https://github.com/ninject/ninject.web.common/wiki)扩展名，这是`ninject.web.mvc`. 它包含例如 的定义`InRequestScope`。

# c++ - C++ 错误：“unordered_map”未命名类型

> ID：15733163
> 
> 赞同：15
> 
> 时间：2013-03-31T18:50:24.700
> 
> 标签：c++, types, unordered-map

据我所知，我所做的一切都是正确的，并且我收到了错误消息：

```
error: 'unordered_map' does not name a type
error: 'mymap' does not name a type 
```

在我的代码中，我有：

```
#include <unordered_map>

using namespace std;

//global variable
unordered_map<string,int> mymap;
mymap.reserve(7000);

void main {
  return;
} 
```

我看不出这里可能缺少什么......

编辑：当我将我的声明更新为

```
std::tr1::unordered_map<string,int> mymap; 
```

我能够消除第一个错误，但是当我尝试保留时，我仍然收到第二个错误消息。

EDIT2：如下所述，reserve 必须进入 main 并且我需要用 flag 编译

```
-std=c++0x 
```

但是，似乎仍然存在与 unordered_map 相关的错误，即：

```
error: 'class std::tr1::unordered_map<std::basic_string<char>, int>' has no member named 'reserve' 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-31T19:02:28.840

编译`g++ -std=c++11`（我的 gcc 版本是`gcc 4.7.2`）和

```
#include <unordered_map>
#include <string>

using namespace std;

//global variable
unordered_map<string,int> mymap;

int main() {
  mymap.reserve(7000); // <-- try putting it here
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-01-05T09:49:02.913

> 如果您想支持`<unordered_map>`早于 c++11 的版本
> `#include<tr1/unordered_map>`，请使用以下形式声明您的地图：-`std::tr1::unordered_map<type1, type2> mymap`
> 这将使用技术报告 1 扩展来实现向后兼容性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-31T19:06:38.490

你不能`execute arbitrary expressions at global scope`，所以你应该把

```
mymap.reserve(7000); 
```

里面主要。

这也适用于其他 STL 容器，例如 map 和 vector。

# asp.net-mvc - 使用多个数组选择重新绑定 MVC 模型

> ID：15733165
> 
> 赞同：1
> 
> 时间：2013-03-31T18:50:49.973
> 
> 标签：asp.net-mvc, model-binding

我已经阅读了一些关于 post-redirect-get 设计模式的内容，但我不确定它是否适合我的目的，因为我拥有的是一个 MVC 网站，它的设计看起来像一个应用程序，我在页面上有多个下拉菜单在我的控制器中全部绑定到一个整数数组，如下所示：

```
 [HttpPost]
    public ViewResult ResponseForm(PartyInvites.Models.GuestResponse response, int[] SelectedCustomer)
    {

       return View(response); // works but resets all my selected dropdowns
       // return View(); // gives an error that it can't rebind items in view

    } 
```

我的观点：

```
@foreach (Schedule sched in Model.Schedules)
        {
@Html.DropDownList("MySelectedCustomer", new SelectList(sched.Customers, "Id", "FirstName"), "Select A Customer", new { @class = "SelectedCustomer" })

} 
```

客人反应：

```
public class GuestResponse
    {
        [Required(ErrorMessage = "You must enter your name")]
        public string Name { get; set; }
        public string SomeString = "someString";
        public string Email { get; set; }
        public string Phone { get; set; }
        public bool? WillAttend { get; set; }
        public int SelectedSchedule = 0;
        public int SelectedCustomer = 0;

        public List<Schedule> Schedules
        {
            get
            {
                return new List<Schedule>() { new Schedule() { ScheduleName = "party1", ScheduleId = 1 }, new Schedule() { ScheduleId = 2, ScheduleName = "party2" } };
            }
            set
            {
                Schedules = value;
            }
        }
    } 
```

SelectCustomer 属性是 GuestResponse 类的属性。所有的下拉列表都是绑定的，如果我更改了一些，它们会很好地绑定到 int[] SelectedCustomer 集合。但是我想返回我的视图（所以它本质上什么都不做）但这会将所有下拉列表重置为其原始状态，因为响应从未完全绑定，因为有多个下拉列表并且 MVC 无法对其进行模型绑定。这样做的最佳方法是什么，可以这么说来保持状态？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T19:16:36.600

处理此问题的正确方法是使用视图模型，而不是将域模型传递给视图。

但是，如果您不想遵循良好的做法，您可以生成这样的下拉列表作为解决方法：

```
for (int i = 0; i < Model.Schedules.Count; i++)
{
    @Html.DropDownList(
        "MySelectedCustomer[" + i + "]", 
        new SelectList(
            Model.Schedules[i].Customers, 
            "Id", 
            "FirstName", 
            Request["MySelectedCustomer[" + i + "]"]
        ), 
        "Select A Customer", 
        new { @class = "SelectedCustomer" }
    )
} 
```

正确的方法是`int[] SelectedCustomers`在你的视图模型上有一个类型的属性，并使用 DropDownListFor 帮助器的强类型版本：

```
for (int i = 0; i < Model.Schedules.Count; i++)
{
    @Html.DropDownListFor(
        x => x.SelectedCustomers, 
        Model.Schedules[i].AvailableCustomers, 
        "Select A Customer", 
        new { @class = "SelectedCustomer" }
    )
} 
```

并且您的 POST 控制器操作显然会将您定义为参数的视图模型：

```
[HttpPost]
public ViewResult ResponseForm(GuestResponseViewModel model)
{
    // The model.SelectedCustomers collection will contain the ids of the selected
    // customers in the dropdowns

    return View(model);
} 
```

而且由于您提到了 Redirect-After-Post 设计模式，这确实是要使用的正确模式。如果成功，您应该重定向到 GET 操作：

```
[HttpPost]
public ViewResult ResponseForm(GuestResponseViewModel model)
{
    if (!ModelState.IsValid)
    {
        // the model is invalid => redisplay the view so that the user can fix
        // the errors
        return View(model);
    }

    // at this stage the model is valid => you could update your database with the selected
    // values and redirect to some other controller action which in turn will fetch the values
    // from the database and correctly rebind the model
    GuestResponse domainModel = Mapper.Map<GuestResponseViewModel, GuestResponse>(model);
    repository.Update(domainModel);

    return RedirectToAction("Index");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T19:24:43.520

注意：我首先要解决为什么它没有绑定任何东西，但这并没有解决数组问题，我稍后会谈到。大多数人在使用 MVC 时出错的地方在于他们没有利用 MVC 的内置特性来处理这些情况。他们坚持做foreach的和手动渲染的东西，但没有考虑到集合状态。

重置值的原因是因为您使用的是`Html.DropDownList()`而不是`Html.DropDownListFor()`，并且您将发布的属性名称重命名为与模型属性名称不同的名称。

您可以简单地将其更改为：

```
@Html.DropDownList("SelectedCustomer", // note the removal of "My"
    new SelectList(sched.Customers, "Id", "FirstName"), 
    "Select A Customer", new { @class = "SelectedCustomer" }) 
```

但是，如果您刚刚使用强类型版本，您就不会遇到这个问题，并且不会让您非常头疼。

```
@Html.DropDownListFor(x => x.SelectedCustomer, 
    new SelectList(sched.Customers, "Id", "FirstName"), 
    "Select A Customer", new { @class = "SelectedCustomer" }) 
```

至于数组，您应该使用一个 EditorTemplate 作为 Schedules，并且在该 EditorTemplate 中您只需创建您的 html，就好像它是一个单独的项目一样。Editor/DisplayTemplates 的优点在于它们会自动处理集合。

在 Views/Controller 文件夹中创建一个名为 EditorTemplates 的文件夹。在该文件夹中，创建一个名为 Schedule.cshtml 的空文件（假设 Schedules 是一个 List 或 Schedule 数组）。在那里，您有代码来呈现单个计划。

编辑：

达林提出了一个很好的观点。我将对模型进行一些小改动，并将 Selected 属性添加到 Schedule 和 GuestResponse，然后您可以使用 Linq 返回选定的计划，这会简化事情。

编辑2：

您描述的问题与您显示的代码之间存在一些冲突。我建议你弄清楚你想要做什么，因为你的代码并没有真正反映一个可行的模型。

# php - 我应该如何使用 AJAX 执行我的 php 代码？

> ID：15733167
> 
> 赞同：-1
> 
> 时间：2013-03-31T18:51:18.250
> 
> 标签：php, javascript, ajax

我已经用 JavaScript 写下了条件，如果它是向下箭头，那么我想更新数据库，而目前它没有落入 javascript 条件并在服务器级别更新数据库。任何帮助将不胜感激。

代码：

```
<script language="javascript">
    $(document).ready(function() {

        totalgames=<?= $totalgames ?>;

        //scoress = 0;
        previous_s=0;

        for(xx=totalgames; xx>=1; xx--){

            score_ele = 'scores'+xx;
            tdid_ele = 'tdid'+xx;
            var tdd = document.getElementById(tdid_ele);
            var scoress = document.getElementById(score_ele);

            if(previous_s == 0){
                tdd.innerHTML = "<img src='images/bullet.png'/>";
            }else{
                if(parseFloat(previous_s) > parseFloat(scoress.value)){
                    tdd.innerHTML = "<img src='images/arrow_up.png'/>";
                }else if(parseFloat(previous_s) < parseFloat(scoress.value)){
                    tdd.innerHTML = "<img src='images/arrow_down.png'/>";
                    <?php
                        //Selecting from table teams
                        $sql_sel_amnt = "Select * from teams where t_name='".$t_name."'";
                        $result_sel = $db1->getResult($sql_sel_amnt);
                        $row_sel = mysql_fetch_assoc($result_sel);

                        //Selecting from table profitnloss
                        $sql_pnl = "Select * from profitnloss where t_name='".$t_name."' and username='".$abc."'";
                        $result_pnl = $db1->getResult($sql_pnl);
                        $row_pnl = mysql_fetch_assoc($result_pnl);

                        $transact_money = $row_pnl['pnl_amount'];
                        $pnl_results = $row_pnl['pnl'];

                        $profit = 0;
                        $loss = 0;

                        $transact_money = explode("|", $transact_money);
                        $pnl_results = explode("|", $pnl_results);
                        for($i=0; $i<count($transact_money); $i++){
                            if($pnl_results[$i]=='P'){
                                $profit = $profit + $transact_money[$i];
                            }else{
                                $loss = $loss + $transact_money[$i];
                            }//end if
                        }//end for..
                        $money_results_total = $profit - $loss;

                        $pnl_date = date("d-m-Y H:i:s");
                        $pnl_amount = $row_sel['c_amount'];//total amount lost
                        $t_amount = $money_results_total + $row_pnl['t_amount'] + $pnl_amount;

                        $noofplayers = mysql_num_rows($result_sel)-1;//total no of players
                        $company_share = 17;//charity percentage
                        $company_share_amnt = $company_share*$pnl_amount/100;
                        $pnl_amount_remaining = $pnl_amount - $company_share_amnt;
                        $charity = substr($row_sel['charity'], 0, 2);//charity percentage
                        $charity_amount = $charity*$pnl_amount_remaining/100;

                        $sharing_amount = $pnl_amount-$charity_amount-$company_share_amnt;
                        $pnl_profit = round($sharing_amount/$noofplayers, 2);

                        echo "noofplayers=> ".$noofplayers.", company_share=> ".$company_share.", company_share_amnt=> ".$company_share_amnt.", charity=> ".$charity."%, charity_amount=> ".$charity_amount.", sharing_amount=> ".$sharing_amount.", pnl_profit=> ".$pnl_profit;

                        $sql_updt_loss = "UPDATE profitnloss SET game_date = '".$serial_date."', pnl_date = CONCAT(pnl_date, '$pnl_date|'), pnl_amount = CONCAT(pnl_amount, '$pnl_amount|'), pnl = CONCAT(pnl, 'Loss|'), t_amount='".$t_amount."' where username='".$abc."' and t_name='".$t_name."'";
                        //echo $updt_pnl;
                        //$result_loss = $db1->getResult($sql_updt_loss);

                        $sql_updt_profit = "UPDATE profitnloss SET pnl_date = CONCAT(pnl_date, '$pnl_date|'), pnl_amount = CONCAT(pnl_amount, '$pnl_profit|'), pnl = CONCAT(pnl, 'Profit|') where username not like'".$abc."' and t_name='".$t_name."'";
                        //echo $updt_pnl;
                        //$result_profit = $db1->getResult($sql_updt_profit);
                    ?>
                }else if(parseFloat(previous_s) == parseFloat(scoress.value)){
                    tdd.innerHTML = "<img src='images/bullet.png'/>";
                }//end if
            }//end if 0..
            previous_s = document.getElementById(score_ele).value;

        }//end for

    })//emd document ready..
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T02:11:45.213

您应该使用 ajax 执行 PHP 代码的方式是将服务器端代码移动到一个单独的文件中，您在 ajax 请求中调用 apon，即 url。

一个例子是使用 jQuery。

```
$.ajax({
    type: "POST",
    url: "some.php",
    data: { name: "John", location: "Boston" }
}).done(function( msg ) {
    alert( "Data Saved: " + msg );
}); 
```

该文档位于[此处](http://api.jquery.com/jQuery.ajax/)

您发送在数据中执行 PHP 代码所需的信息。然后根据您选择的类型`$_POST`或`$_GET`根据您选择的类型访问它们。

如果您不打算使用 jQuery，可以查看此处：[AJAX 入门 - 通过 PHP 更新表单](https://stackoverflow.com/questions/10801082/getting-started-with-ajax-updating-form-via-php)。

[下面是一些使用 ajax 的好习惯](http://www.ibm.com/developerworks/library/wa-aj-5best/)

# c# - C++ 和 C# 库和类

> ID：15733168
> 
> 赞同：-1
> 
> 时间：2013-03-31T18:51:31.803
> 
> 标签：c#, c++, dll

我可以使用 C++ 库和类以 C# 语言构建程序吗？如果可以，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T18:54:50.850

您可以使用[`P/Invoke`](http://msdn.microsoft.com/en-us/library/aa288468%28v=vs.71%29.aspx)从托管代码调用非托管代码。`puts`这是调用非托管函数的示例：

```
using System;
using System.Runtime.InteropServices;

class Program
{
    [DllImport("msvcrt.dll")]
    public static extern int puts([MarshalAs(UnmanagedType.LPStr)] string m);
    [DllImport("msvcrt.dll")]
    internal static extern int _flushall();

    public static void Main() 
    {
        puts("Hello World!");
        _flushall();
    }
} 
```

这里的想法在于声明一个托管包装器，该包装器将匹配您要调用的非托管方法的签名。请注意方法是如何用`extern`关键字标记的，并用`DllImport`指示其实现位置的属性进行修饰。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T18:57:24.727

绝对可以！

如果您有一个预先存在的库 @Darin 所指的机制可以自动完成。通过[www.swig.org](http://www.swig.org)

# c++ - Cplusplus cin 分裂

> ID：15733169
> 
> 赞同：0
> 
> 时间：2013-03-31T18:51:34.703
> 
> 标签：c++, input, stream, cin

我有以下代码：

```
int main()
{
string input = "";
std::vector<int> board = create_board();
print_board(board);

std::stringstream stream;

cout << "Please enter two numbers: ";
getline(cin, input);
stream << input;
cout << stream << endl << endl; 
```

我想要做的是从用户那里得到两个数字，以字符串的形式用空格分隔。将它们转换为整数，并将这两个整数存储在一个数组中，以便在程序中进一步使用。（我正在用 C++ 为学校编写游戏内存）。有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-31T18:56:04.653

你快完成了。

```
stream << input;
int tmp1, tmp2;
if(stream >> tmp1 >> tmp2)
    cout << tmp1 << " "<< tmp2<< endl;
else
   // there is error. 
```

应该这样做。

# sql-server - 如何知道我的数据库中最常用的程序？

> ID：15733170
> 
> 赞同：2
> 
> 时间：2013-03-31T18:51:39.017
> 
> 标签：sql-server

我完成了我的项目，使用了很多程序，现在我找到了最常用的程序和平均执行时间。

这样我就知道我需要先调整哪些程序？

有什么方法可以获取特定数据库的过程执行历史记录？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-31T18:57:57.397

相信您可以使用 sys.dm_exec_query_stats 动态管理视图。此视图中有两列名为 execution_count 和 total_worker_time 可以帮助您。

execution_count 给出了有问题的存储过程自上次重新编译以来执行的总次数。

total_worker_time 给出了自上次重新编译以来执行此存储过程所花费的总 CPU 时间（以毫秒为单位）。

这是一个 MSDN 链接：http: [//msdn.microsoft.com/en-us/library/ms189741.aspx](http://msdn.microsoft.com/en-us/library/ms189741.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:21:01.677

您可以使用它`dm_exec_cached_plans`来查找已编译到查询计划中的存储过程。该函数`dm_exec_query_plan`可用于检索`object id`计划，然后可以将其转换为过程的名称：

```
select  object_name(qp.objectid)
,       cp.usecounts
from    sys.dm_exec_cached_plans cp
cross apply
        sys.dm_exec_query_plan(cp.plan_handle) qp
where   cp.objtype = 'Proc'
order by
        cp.usecounts desc 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-31T18:57:49.603

我认为您想为此检查[***SQL Server Profiler***](http://blog.sqlauthority.com/2009/08/03/sql-server-introduction-to-sql-server-2008-profiler-2/)。您也可以在 MSDN 和其他地方查看详细信息。

但是，在生产服务器中使用它之前，您需要记住： `Profiler adds too much overhead to production server`. 因此，首先检查您的网站何时点击次数较少，然后继续。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-31T18:58:00.710

这就是[SQL Server Profiler](http://msdn.microsoft.com/en-us/library/ms181091.aspx)的用途。有了它，您可以跟踪查询运行次数、执行时间等。

# javascript - jQuery和Js函数语法混合

> ID：15733172
> 
> 赞同：0
> 
> 时间：2013-03-31T18:51:40.860
> 
> 标签：javascript, jquery, function

我对以下内容有小问题。这只是整个代码的一个片段，它通常通过 setInterval(time,function); 运行。命令，但我想通过使用“下一步”按钮来替换自动滑动图片，为什么我不能只使用 jQuery 并将其粘贴到

```
$("#nextBtn").click(nextSlide); 
```

命令 ？我的按钮出现但没有事件。难道是我将jQuery命令放在JS中

```
function onLoadWindow(e) {} 
```

而不是 jQuery 的

```
$(document).ready(function() {}) 
```

我最近刚学完 JS 的基础知识，不久之后就开始了 jQ，所以我仍然是这两个方面的初学者，但之前有一些 Java 编程经验。我对将语法混合在一起有点陌生。非常感谢您的帮助！=)

编辑：用完整代码替换代码片段。我尝试通过删除不需要的内容（例如几个标签和相关样式）来略读它。但现在看来我什至无法让 div 按钮将文本发送到控制台，所以我很确定某处存在明显的“noob”错误，对不起“浪费”人们的时间..

```
<!DOCTYPE html>
  <html>
           <head>
        <meta charset="UTF-8">
        <title>JS Slideshow</title>

        <script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.js"></script>

        <style type="text/css">

            .slide {
                height:200px;
                width:320px;
                position:absolute;
                opacity:0;
            }

            img {
                width:100%;
                height:100%;
            }   

            #slideshow {
                position:relative;
            }

            .active {
                opacity:1;
                transition:opacity 1s;
            }

            #nextBtn {
                display:block;
                float:left;
                height:25px;
                width:40px;
                background-color:black;
                margin-top:210px;
            }

        </style>

        <script type="text/javascript">

            window.addEventListener("load",onLoadWindow);

            var active_slide;
            var slides;

            function onLoadWindow(e) {
                var slideShow=document.getElementById("slideshow");
                slides=slideShow.getElementsByTagName("div");
                active_slide=0;

                slides[0].classList.add("active");

                //setInterval(nextSlide,10000);
                $("nextBtn").click(nextSlide);

            }

            function nextSlide () {
                slides[active_slide].classList.remove("active");
                active_slide++;

                active_slide%=3;  

                slides[active_slide].classList.add("active");
            }

        </script>

    </head>

    <body>
        <div id="slideshow">

            <div class="slide">
                <img src="IMG/bridge.jpg" alt="" title="" />
            </div>

            <div class="slide">
                <img src="IMG/leaf.jpg" alt="" title="" />
            </div>

            <div class="slide">
                <img src="IMG/road.jpg" alt="" title="" />
            </div>
</div>
    <div id="nextBtn"></div>

    </body>

</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T19:57:10.807

它确实只是一个缺少的哈希符号来正确引用 Id .. 感谢所有人，当然还有 VeXii 指出它 x)

# autohotkey - 如何让程序快捷方式图标与程序一起打开脚本？

> ID：15733173
> 
> 赞同：0
> 
> 时间：2013-03-31T18:51:41.070
> 
> 标签：autohotkey

当我使用程序的快捷方式图标打开该程序时，我希望打开一个适用于特定程序的脚本。我尝试将路径粘贴到图标属性中的目标行中，但这不起作用。我需要做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T20:41:30.177

我认为我读到您想创建一个看起来像原始应用程序启动图标的图标，单击该图标时，确实会启动原始应用程序并运行一些额外的 ahk 代码。您可以创建一个`Shortcut`或`Link`ahk 脚本来启动您的应用程序（运行，c:\path\yourapp.exe）并执行其他任务（WinWaitActive，您的应用程序）等。在`link`ahk 脚本中（不适用于真正的 ahk 脚本，仅与`lnk`文件）您可以选择属性（右键单击）并将图标更改为您想要的任何图标（通常您可以通过指向 .exe 来使用原始应用程序的图标（而不是从标准 shell32.dll 中选择图标） . 因此，通过选择新图标，例如 c:/program files/officexx/word.exe ，您的 AHK 脚本将获得图标，就好像它是单词启动图标。希望能回答您的问题。

在脚本的开头，但是在您执行运行命令后，您将计时器

```
Run, abc.exe
SetTitleMatchMode, 2
Sleep, 1000 ; Give the app some time to run before you start the test
SetTimer, CloseScript, 1000
Return

CloseScript:
IfWinExist, place the windows title here....
    Return
ExitApp 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-21T12:55:41.733

这是我用 AutoHotKey 做的第一件事。我想要一个我经常使用的程序的“包装器”脚本，当我在单击链接时按 F4 键时，它可以让我使用脚本 GUI 表单选择不同的程序选项。只需单击链接即可正常启动程序。吃掉你的心，微软。

在链接的 Start-In 属性中，我放置了实际程序的目录，我的脚本从链接的 target 属性中的脚本命令行参数中获取程序名称和其他详细信息。

# linux - 将复杂的文本文件解析为一行字段名和第二行值

> ID：15733176
> 
> 赞同：0
> 
> 时间：2013-03-31T18:51:51.187
> 
> 标签：linux, parsing

我正在尝试解析一个文本文件，该文件的行主要包含文本和一个数字（每行开头带有“#”）。文件的第二部分由具有多个数字的行组成，所有数字都与单个结构相关。由于我需要为数百个案例组合这些输出文件，如果我可以将这些文件中的每一个处理成一行数据，那将是非常有帮助的。我在使用 bash/perl/awk 的组合时遇到了麻烦。谁能建议我可以做到这一点的方法？（下面的示例文件）。

谢谢您的考虑。

最好的祝愿，

-S

```
# Title Segmentation Statistics
#
# generating_program mri_segstats
# cvs_version $Id: mri_segstats.c,v 1.75.2.9 2013/02/16 00:09:33 greve Exp $
# cmdline mri_segstats --seg mri/aseg.mgz --sum stats/aseg.stats --pv mri/norm.mgz --empty --brainmask mri/brainmask.mgz --brain-vol-from-seg --excludeid 0 --excl-ctxgmwm --supratent --subcortgray --in mri/norm.mgz --in-intensity-name norm --in-intensity-units MR --etiv --surf-wm-vol --surf-ctx-vol --totalgray --euler --ctab /mnt/glusterfs/salsoman/freesurfer/ASegStatsLUT.txt --subject WCA_0162_T1_FS
# sysname  Linux
# hostname barley15.stanford.edu
# machine  x86_64
# user     salsoman
# anatomy_type volume
#
# SUBJECTS_DIR /mnt/glusterfs/salsoman/output/FS
# subjectname WCA_0162_T1_FS
# Measure BrainSeg, BrainSegVol, Brain Segmentation Volume, 1089921.000000, mm^3
# Measure BrainSegNotVent, BrainSegVolNotVent, Brain Segmentation Volume Without Ventricles, 993734.000000, mm^3
# Measure BrainSegNotVentSurf, BrainSegVolNotVentSurf, Brain Segmentation Volume Without Ventricles from Surf, 993214.631437, mm^3
# Measure lhCortex, lhCortexVol, Left hemisphere cortical gray matter volume, 240339.518738, mm^3
# Measure rhCortex, rhCortexVol, Right hemisphere cortical gray matter volume, 236468.599276, mm^3
# Measure Cortex, CortexVol, Total cortical gray matter volume, 476808.118013, mm^3
# Measure lhCorticalWhiteMatter, lhCorticalWhiteMatterVol, Left hemisphere cortical white matter volume, 191135.667925, mm^3
# Measure rhCorticalWhiteMatter, rhCorticalWhiteMatterVol, Right hemisphere cortical white matter volume, 180013.845498, mm^3
# Measure CorticalWhiteMatter, CorticalWhiteMatterVol, Total cortical white matter volume, 371149.513423, mm^3
# Measure SubCortGray, SubCortGrayVol, Subcortical gray matter volume, 52383.000000, mm^3
# Measure TotalGray, TotalGrayVol, Total gray matter volume, 604954.118013, mm^3
# Measure SupraTentorial, SupraTentorialVol, Supratentorial volume, 991108.631437, mm^3
# Measure SupraTentorialNotVent, SupraTentorialVolNotVent, Supratentorial volume, 902611.631437, mm^3
# Measure SupraTentorialNotVentVox, SupraTentorialVolNotVentVox, Supratentorial volume voxel count, 900542.000000, mm^3
# Measure Mask, MaskVol, Mask Volume, 1694747.000000, mm^3
# Measure BrainSegVol-to-eTIV, BrainSegVol-to-eTIV, Ratio of BrainSegVol to eTIV, 0.624390, unitless
# Measure MaskVol-to-eTIV, MaskVol-to-eTIV, Ratio of MaskVol to eTIV, 0.970881, unitless
# Measure lhSurfaceHoles, lhSurfaceHoles, Number of defect holes in lh surfaces prior to fixing, 239, unitless
# Measure rhSurfaceHoles, rhSurfaceHoles, Number of defect holes in rh surfaces prior to fixing, 227, unitless
# Measure SurfaceHoles, SurfaceHoles, Total number of defect holes in surfaces prior to fixing, 466, unitless
# Measure EstimatedTotalIntraCranialVol, eTIV, Estimated Total Intracranial Volume, 1745576.756023, mm^3
# SegVolFile mri/aseg.mgz
# SegVolFileTimeStamp  2013/03/27 19:34:08
# ColorTable /mnt/glusterfs/salsoman/freesurfer/ASegStatsLUT.txt
# ColorTableTimeStamp 2013/02/25 22:23:16
# InVolFile  mri/norm.mgz
# InVolFileTimeStamp  2013/03/27 14:00:28
# InVolFrame 0
# PVVolFile  mri/norm.mgz
# PVVolFileTimeStamp  2013/03/27 14:00:28
# Excluding Cortical Gray and White Matter
# ExcludeSegId 0 2 3 41 42
# VoxelVolume_mm3 1
# TableCol  1 ColHeader Index
# TableCol  1 FieldName Index
# TableCol  1 Units     NA
# TableCol  2 ColHeader SegId
# TableCol  2 FieldName Segmentation Id
# TableCol  2 Units     NA
# TableCol  3 ColHeader NVoxels
# TableCol  3 FieldName Number of Voxels
# TableCol  3 Units     unitless
# TableCol  4 ColHeader Volume_mm3
# TableCol  4 FieldName Volume
# TableCol  4 Units     mm^3
# TableCol  5 ColHeader StructName
# TableCol  5 FieldName Structure Name
# TableCol  5 Units     NA
# TableCol  6 ColHeader normMean
# TableCol  6 FieldName Intensity normMean
# TableCol  6 Units     MR
# TableCol  7 ColHeader normStdDev
# TableCol  7 FieldName Itensity normStdDev
# TableCol  7 Units     MR
# TableCol  8 ColHeader normMin
# TableCol  8 FieldName Intensity normMin
# TableCol  8 Units     MR
# TableCol  9 ColHeader normMax
# TableCol  9 FieldName Intensity normMax
# TableCol  9 Units     MR
# TableCol 10 ColHeader normRange
# TableCol 10 FieldName Intensity normRange
# TableCol 10 Units     MR
# NRows 45
# NTableCols 10
# ColHeaders  Index SegId NVoxels Volume_mm3 StructName normMean normStdDev normMin normMax normRange
  1   4     41962    41962.4  Left-Lateral-Ventricle            22.0753    10.2057     3.0000    94.0000    91.0000
  2   5      2150     2149.7  Left-Inf-Lat-Vent                 37.5636    16.3886     5.0000    89.0000    84.0000
  3   7      8273     8273.3  Left-Cerebellum-White-Matter      88.0903    11.6908    21.0000   123.0000   102.0000
  4   8     35427    35427.4  Left-Cerebellum-Cortex            56.4255    12.5475     2.0000    92.0000    90.0000
  5  10      6087     6086.7  Left-Thalamus-Proper              92.2098    11.7928    50.0000   124.0000    74.0000
  6  11      5101     5100.7  Left-Caudate                      75.0335     9.9708    29.0000   100.0000    71.0000
  7  12      4773     4773.0  Left-Putamen                      75.7113     6.2195    48.0000    95.0000    47.0000
  8  13      1178     1177.6  Left-Pallidum                     86.3354     6.2568    59.0000   104.0000    45.0000
  9  14      2973     2973.1  3rd-Ventricle                     27.5508    11.3394     9.0000    77.0000    68.0000
 10  15      2403     2403.0  4th-Ventricle                     26.8237    11.9581     6.0000    79.0000    73.0000
 11  16     18347    18347.2  Brain-Stem                        82.1731    12.0144    15.0000   116.0000   101.0000
 12  17      3824     3824.2  Left-Hippocampus                  66.7333     8.6661    26.0000   100.0000    74.0000
 13  18      2087     2087.1  Left-Amygdala                     63.9856     7.2932    37.0000    91.0000    54.0000
 14  24      2094     2094.0  CSF                               36.2929    14.6972    12.0000    90.0000    78.0000
 15  26       340      340.0  Left-Accumbens-area               69.8967     8.7139    37.0000    87.0000    50.0000
 16  28      2969     2969.5  Left-VentralDC                    94.9737    13.6527    44.0000   122.0000    78.0000
 17  30        76       75.9  Left-vessel                       58.3205    11.6736    27.0000    80.0000    53.0000
 18  31      1103     1102.6  Left-choroid-plexus               51.7182    16.3692    12.0000   100.0000    88.0000
 19  43     38108    38108.2  Right-Lateral-Ventricle           20.2269    10.2570     0.0000    92.0000    92.0000
 20  44      2165     2165.0  Right-Inf-Lat-Vent                30.2048    13.6808     0.0000    80.0000    80.0000
 21  46      9715     9715.4  Right-Cerebellum-White-Matter     86.9395     8.3909    25.0000   115.0000    90.0000
 22  47     41688    41688.2  Right-Cerebellum-Cortex           57.5291    10.3208     9.0000    91.0000    82.0000
 23  49      4769     4769.3  Right-Thalamus-Proper             82.0576    12.2446    18.0000   106.0000    88.0000
 24  50      4587     4587.1  Right-Caudate                     69.9613    12.7863    11.0000   103.0000    92.0000
 25  51      4694     4694.4  Right-Putamen                     69.9372     7.9141    48.0000    91.0000    43.0000
 26  52      1407     1406.8  Right-Pallidum                    88.0501     5.7841    57.0000   105.0000    48.0000
 27  53      3160     3159.6  Right-Hippocampus                 63.3511     8.9283    17.0000    95.0000    78.0000
 28  54      1877     1877.4  Right-Amygdala                    57.3686     8.5163    20.0000    83.0000    63.0000
 29  58       376      376.0  Right-Accumbens-area              70.4901     9.9104    41.0000    96.0000    55.0000
 30  60      2973     2972.7  Right-VentralDC                   89.6143    14.1755    29.0000   120.0000    91.0000
 31  62       105      105.1  Right-vessel                      50.1458    12.1126    21.0000    78.0000    57.0000
 32  63      2843     2842.7  Right-choroid-plexus              46.3759    13.8319     6.0000   115.0000   109.0000
 33  72        68       67.9  5th-Ventricle                     42.4444    11.2861    26.0000    83.0000    57.0000
 34  77     25325    25325.0  WM-hypointensities                71.8650    16.2379     5.0000   112.0000   107.0000
 35  78         0        0.0  Left-WM-hypointensities            0.0000     0.0000     0.0000     0.0000     0.0000
 36  79         0        0.0  Right-WM-hypointensities           0.0000     0.0000     0.0000     0.0000     0.0000
 37  80       153      153.1  non-WM-hypointensities            50.4551    16.1478    18.0000    88.0000    70.0000
 38  81         0        0.0  Left-non-WM-hypointensities        0.0000     0.0000     0.0000     0.0000     0.0000
 39  82         0        0.0  Right-non-WM-hypointensities       0.0000     0.0000     0.0000     0.0000     0.0000
 40  85       350      349.6  Optic-Chiasm                      66.0833    15.7641    24.0000   102.0000    78.0000
 41 251       806      805.6  CC_Posterior                     119.2646    18.1322    57.0000   150.0000    93.0000
 42 252       252      251.7  CC_Mid_Posterior                 109.1685    16.3862    51.0000   150.0000    99.0000
 43 253       295      295.4  CC_Central                       113.3418    16.2739    77.0000   140.0000    63.0000
 44 254       294      293.7  CC_Mid_Anterior                  115.1645    17.9396    72.0000   149.0000    77.0000
 45 255       657      657.4  CC_Anterior                      124.1047    22.5045    54.0000   166.0000   112.0000 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:59:44.833

您是否尝试过[Talend Open Studio/数据集成](http://www.talend.com/products/data-integration)？TOS 能够自动执行此类复杂的转换。数据转换作业的最终可执行文件将是一个 jar 文件，您可以轻松地从 shell 脚本调用该文件。虽然开始使用 TOS 需要一些时间，但它非常强大。该产品已获得 GPL v2 许可，并且拥有相当活跃的[社区](http://www.talendforge.org/forum/)。

当然，你可以编写一些 awk/sed/perl 狂欢，你会得到一个结果，但在你的情况下，通过如此复杂的转换，这可能变得非常不可读和不可维护。

HTH，迈克尔

# vb.net - 更新许多下拉列表的 selectedindex

> ID：15733177
> 
> 赞同：0
> 
> 时间：2013-03-31T18:51:56.097
> 
> 标签：vb.net

我有一个包含 6 个类别下拉列表的页面，然后是 5 个部分中的一系列问题，每个部分都有一个答案下拉列表。

类别下拉列表之一的答案使问题的 2 个部分没有实际意义。

因此，为了使该页面有用，我想将这两个部分中问题的答案更新为“否”。这已经是下拉列表中的一个选项，我只需要使用该答案更新所有相关列表。

编辑：我还需要提到，问题是通过转发器创建的，并且基于其他参数。因此，我不一定知道创建的下拉列表的名称/ID。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:03:44.283

如果你使用 a `ComboBox`，你可以设置它的`SelectedIndex`或它的`Text`属性。

```
Public Sub Button1_Click()
    ComboBox1.SelectedIndex = 1 'or you might be able to use 0
    'or
    ComboBox1.Text = "No"
End Sub 
```

# python - 在 Python 中键入错误写入文件

> ID：15733178
> 
> 赞同：0
> 
> 时间：2013-03-31T18:51:59.527
> 
> 标签：python, python-2.7, urllib

我正在编写一个 Python 脚本，以在对网页进行更改时通知我，并将页面的当前状态存储到文件中，以便在重新启动后无缝恢复。代码如下：

```
import urllib
url="http://example.com"
filepath="/path/to/file.txt"
try:
    html=open(filepath,"r").read() # Restores imported code from previous session
except:
    html="" # Blanks variable on first run of the script
while True:
    imported=urllib.urlopen(url)
    if imported!=html:
    # Alert me
    html=imported
    open(filepath,"w").write(html)
# Time delay before next iteration 
```

运行脚本返回：

```
Traceback (most recent call last):
  File "April_Fools.py", line 20, in <module>
    open(filepath,"w").write(html)
TypeError: expected a character buffer object

------------------
(program exited with code: 1)
Press return to continue 
```

我不知道这意味着什么。我对 Python 比较陌生。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T18:53:25.133

`urllib.urlopen`不返回字符串，而是将响应作为类似文件的对象返回。您需要*阅读*该回复：

```
html = imported.read() 
```

只有*这样*，`html`您才能将字符串写入文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:19:23.030

顺便说一句， using`open(filename).read()`不[被认为是好的样式](https://stackoverflow.com/questions/1373660/file-open-is-this-bad-python-style)，因为您从不关闭文件。写作也是如此。尝试使用[上下文管理器](http://docs.python.org/2/reference/datamodel.html#context-managers)：

```
try:
    with open(filepath,"r") as htmlfile:
        html = htmlfile.read()
except:
    html="" 
```

当您离开该块时，该`with`块将自动关闭文件。

# windows - 连续 2 个函数调用有何不同？

> ID：15733179
> 
> 赞同：1
> 
> 时间：2013-03-31T18:52:07.290
> 
> 标签：windows, stack, cpu-registers

假设您查看具有以下代码的进程的堆栈和寄存器...

```
...
void Test()
{
     for (int i = 0; i < 10; i++)
     {
          OneRunDontKnow();
     }
}
... 
```

当进程执行循环时，您会准确地查看堆栈两次，并且两次都`OneRunDontKnow`位于堆栈的顶部。

您能否以某种方式知道是否`OneRunDontKnow`从堆栈中弹出然后再次推入，或者它是否从未弹出？

编辑：`OneRunDontKnow`可以有任何签名（它也可以带参数或返回值）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:05:50.580

可能最好的方法是查看您的汇编代码。 `OneRunDontKnow()`没有参数，所以堆栈上唯一的东西就是指令指针和其他堆栈帧的东西，但没有参数。所以在反汇编中找到`OneRunDontKnow()`应该调用的地方，看看代码里面的( , `PUSH`, etc) 是什么类型的。`JMP``LOOP_``LOOP``LOOPE`

# c++ - cuda中的count3非常慢

> ID：15733182
> 
> 赞同：0
> 
> 时间：2013-03-31T18:52:10.710
> 
> 标签：c++, c, cuda, gpu

我在 CUDA 中编写了一个小程序，计算 C 数组中有多少个 3 并打印出来。

```
#include <stdio.h>
#include <assert.h>
#include <cuda.h>
#include <cstdlib>

__global__ void incrementArrayOnDevice(int *a, int N, int *count)
{
    int id = blockIdx.x * blockDim.x + threadIdx.x;

    //__shared__ int s_a[512]; // one for each thread
    //s_a[threadIdx.x] = a[id];

    if( id < N )
    {
        //if( s_a[threadIdx.x] == 3 )
        if( a[id] == 3 )
        {
            atomicAdd(count, 1);
        }
    }
}

int main(void)
{
    int *a_h;   // host memory
    int *a_d;   // device memory

    int N = 16777216;

    // allocate array on host
    a_h = (int*)malloc(sizeof(int) * N);
    for(int i = 0; i < N; ++i)
        a_h[i] = (i % 3 == 0 ? 3 : 1);

    // allocate arrays on device
    cudaMalloc(&a_d, sizeof(int) * N);

    // copy data from host to device
    cudaMemcpy(a_d, a_h, sizeof(int) * N, cudaMemcpyHostToDevice);

    // do calculation on device
    int blockSize = 512;
    int nBlocks = N / blockSize + (N % blockSize == 0 ? 0 : 1);
    printf("number of blocks: %d\n", nBlocks);

    int count;
    int *devCount;
    cudaMalloc(&devCount, sizeof(int));
    cudaMemset(devCount, 0, sizeof(int));

    incrementArrayOnDevice<<<nBlocks, blockSize>>> (a_d, N, devCount);

    // retrieve result from device
    cudaMemcpy(&count, devCount, sizeof(int), cudaMemcpyDeviceToHost);

    printf("%d\n", count);

    free(a_h);
    cudaFree(a_d);
    cudaFree(devCount);
} 
```

我得到的结果是：real 0m3.025s user 0m2.989s sys 0m0.029s

当我在具有 4 个线程的 CPU 上运行它时，我得到： real 0m0.101s user 0m0.100s sys 0m0.024s

请注意，GPU 是旧的——我不知道确切的型号，因为我没有 root 访问权限，但它运行的 OpenGL 版本是 1.2，使用 MESA 驱动程序。

难道我做错了什么？我该怎么做才能让它运行得更快？

注意：我尝试为每个块使用存储桶（因此每个块的 atomicAdd()s 会减少），但我得到了完全相同的性能。我还尝试将分配给该块的 512 个整数复制到共享内存块（您可以在评论中看到它）并且时间再次相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T16:29:03.130

这是对您的问题“我该怎么做才能让它运行得更快？”的回答。正如我在评论中提到的，时序方法（可能）存在问题，我对提高速度的主要建议是使用“经典并行减少”算法。以下代码实现了更好的（在我看来）时序测量，并将您的内核转换为缩减风格的内核：

```
#include <stdio.h>
#include <assert.h>
#include <cstdlib>

#define N (1<<24)
#define nTPB 512
#define NBLOCKS 32

__global__ void incrementArrayOnDevice(int *a, int n, int *count)
{
  __shared__ int lcnt[nTPB];
  int id = blockIdx.x * blockDim.x + threadIdx.x;
  int lcount = 0;
  while (id < n) {
    if (a[id] == 3) lcount++;
    id += gridDim.x * blockDim.x;
    }
  lcnt[threadIdx.x] = lcount;
  __syncthreads();
  int stride = blockDim.x;
  while(stride > 1) {
    // assume blockDim.x is a power of 2
    stride >>= 1;
    if (threadIdx.x < stride) lcnt[threadIdx.x] += lcnt[threadIdx.x + stride];
    __syncthreads();
    }
  if (threadIdx.x == 0) atomicAdd(count, lcnt[0]);
}

int main(void)
{
    int *a_h;   // host memory
    int *a_d;   // device memory
    cudaEvent_t gstart1,gstart2,gstop1,gstop2,cstart,cstop;
    float etg1, etg2, etc;

    cudaEventCreate(&gstart1);
    cudaEventCreate(&gstart2);
    cudaEventCreate(&gstop1);
    cudaEventCreate(&gstop2);
    cudaEventCreate(&cstart);
    cudaEventCreate(&cstop);

    // allocate array on host
    a_h = (int*)malloc(sizeof(int) * N);
    for(int i = 0; i < N; ++i)
        a_h[i] = (i % 3 == 0 ? 3 : 1);

    // allocate arrays on device
    cudaMalloc(&a_d, sizeof(int) * N);

    int blockSize = nTPB;
    int nBlocks = NBLOCKS;
    printf("number of blocks: %d\n", nBlocks);

    int count;
    int *devCount;
    cudaMalloc(&devCount, sizeof(int));
    cudaMemset(devCount, 0, sizeof(int));

    // copy data from host to device
    cudaEventRecord(gstart1);
    cudaMemcpy(a_d, a_h, sizeof(int) * N, cudaMemcpyHostToDevice);
    cudaMemset(devCount, 0, sizeof(int));
    cudaEventRecord(gstart2);
    // do calculation on device

    incrementArrayOnDevice<<<nBlocks, blockSize>>> (a_d, N, devCount);
    cudaEventRecord(gstop2);

    // retrieve result from device
    cudaMemcpy(&count, devCount, sizeof(int), cudaMemcpyDeviceToHost);
    cudaEventRecord(gstop1);

    printf("GPU count = %d\n", count);
    int hostCount = 0;
    cudaEventRecord(cstart);
    for (int i=0; i < N; i++)
      if (a_h[i] == 3) hostCount++;
    cudaEventRecord(cstop);

    printf("CPU count = %d\n", hostCount);
    cudaEventSynchronize(cstop);
    cudaEventElapsedTime(&etg1, gstart1, gstop1);
    cudaEventElapsedTime(&etg2, gstart2, gstop2);
    cudaEventElapsedTime(&etc, cstart, cstop);

    printf("GPU total time   = %fs\n", (etg1/(float)1000) );
    printf("GPU compute time = %fs\n", (etg2/(float)1000));
    printf("CPU time         = %fs\n", (etc/(float)1000));
    free(a_h);
    cudaFree(a_d);
    cudaFree(devCount);
} 
```

当我在相当快的 GPU（Quadro 5000，比 Tesla M2050 慢一点）上运行它时，我得到以下信息：

```
number of blocks: 32
GPU count = 5592406
CPU count = 5592406
GPU total time   = 0.025714s
GPU compute time = 0.000793s
CPU time         = 0.017332s 
```

我们看到 GPU 在计算部分比这种（简单的、单线程的）CPU 实现要快得多。当我们加入传输数据的成本时，GPU 版本速度较慢，但​​不是慢 30 倍。

相比之下，当我为你的原始算法计时时，我得到了这样的数字：

```
GPU total time   = 0.118131s
GPU compute time = 0.093213s 
```

我的系统配置是 Xeon X5560 CPU、RHEL 5.5、CUDA 5.0、Quadro5000 GPU。

# php - 无法在 IIS 上设置 upload_tmp_dir

> ID：15733183
> 
> 赞同：4
> 
> 时间：2013-03-31T18:52:13.883
> 
> 标签：php, iis, file-upload, configuration

所以我试图`php upload_tmp_dir`在 IIS 机器上设置设置。

我更改了设置，`php.ini`但`phpinfo()`仍显示默认文件夹。我检查了`IIS_IUSRS`谁拥有写、读、修改等权限。

我还运行它来检查新文件夹是否可写：

```
$filename = 'C:\inetpub\temp\uploads';
if (is_writable($filename)) {
    echo $filename . ' is writable';
} else {
    echo $filename . ' is not writable';
} 
```

我更改了该`max_file_uploads`值以测试正在加载的 PHP 配置是否是最新的，并且确实是。

我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-02T23:46:56.093

结果发现`php.ini`配置文件中有重复的条目`upload_tmp_dir`，最后一个是默认文件夹`c:\windows\temp`。我评论说出发了，现在一切都很好。

这个[线程](https://serverfault.com/questions/128017/php-ignores-upload-tmp-dir)让我检查一下。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-11-20T00:46:28.257

如果你看向文件的底部，你会发现这个。

```
[WebPIChanges]
error_log=C:\Windows\temp\PHP54_errors.log
upload_tmp_dir=C:\Windows\temp
session.save_path=C:\Windows\temp
cgi.force_redirect=0
cgi.fix_pathinfo=1
fastcgi.impersonate=1
fastcgi.logging=0
max_execution_time=300
date.timezone=America/New_York
extension_dir="C:\Program Files (x86)\PHP\v5.4\ext\" 
```

也可以在这里选择临时目录或将其注释掉。

# java - Java int += 双语法惊喜

> ID：15733184
> 
> 赞同：9
> 
> 时间：2013-03-31T18:52:20.073
> 
> 标签：java, syntax, operators, int

我遇到了以下令人惊讶的行：

```
int x = 7;
x += 0.5; 
```

显然是合法的语法！添加之后，x 仍然是 7，所以 double 被强制转换为 int 并向下舍入为 0，但这是在代码中没有任何显式强制转换的情况下完成的。其他人对此感到惊讶吗？这里的理由是什么？

编辑以澄清我的问题：任何人都可以给出这个决定的充分理由吗？要求在其他任何地方进行显式强制转换，这让我觉得这是一个糟糕的决定，但是在语言中有一个地方可以让你默默地丢弃数据。我错过了什么吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-31T18:55:15.570

```
x += 0.5; 
```

相当于：

```
x = (int) (x + 0.5) 
```

一般来说：

`x += y`相当于`x = (type of x) (x + y)`

* * *

见[15.26.2。复合赋值运算符](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.26.2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T18:55:04.007

`x += 0.5;`是一样的`x = (int) (x + 0.5);`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T18:56:20.250

这是因为***复合赋值运算符进行了隐式转换***（自动转换）：所以

```
x+=0.5 => x =(int)(x + 0.5) => x = (int)(7.5) => x = 7 
```

# r - R 控制台中的上一个命令

> ID：15733185
> 
> 赞同：3
> 
> 时间：2013-03-31T18:52:21.037
> 
> 标签：r, console, editor

我想在我的 R 控制台中检索以某个字符开头的上一个命令。例如，我可以只按向上键来获取最后一个命令。但是，我想要`xyz`以例如开头的最后一个命令。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-31T18:58:51.433

如果您使用的是 linux 发行版，则可以按 ctrl+R 开始输入，然后按 ctrl+R 切换搜索匹配项。

您也可以这样做，history(pattern="^xyz")，但这需要额外的副本。

# processing - 无法在导出的处理应用程序中读取和写入同一文件

> ID：15733187
> 
> 赞同：0
> 
> 时间：2013-03-31T18:52:23.377
> 
> 标签：processing, datastore

我正在使用一个外部`.txt`文件来保存递增的名称索引，以便每当有人在我的应用程序中“拍照”时（即`image_1.jpg`，`image_2.jpg`等）。我正在尝试将数据保存在外部，以便用户在每次运行程序时都不会覆盖他们的图片。但是，由于 Processing 打包其内容以进行导出的方式，我不能同时读取和写入同一个文件。它读取位于应用程序包内容中的相应文件，但是，当它尝试写入该文件时，它会在与应用程序本身相同的目录中创建一个新文件夹，并改为写入一个具有相同名称的新文件。

本质上，它读取正确的文件，但拒绝写入，而是复制并写入该文件。该应用程序运行良好，但每次打开它并拍照时，都会覆盖已有的图像。

我尝试将“写入”位置命名为与导出的应用程序将数据文件夹存储在包内容（`Contents/Resources/Java/data/assets`）中的位置相同的链接，但这会在与应用程序相同的文件中创建此目录的副本。

`../storage/pictureNumber.txt`当我导出应用程序时，我还尝试通过将读取代码更改为然后将此文件放在应用程序本身旁边来排除我试图从我的数据文件夹中读取/写入的文件。当我这样做时，应用程序根本不会启动，因为它正在寻找自己的数据文件夹进行存储并且拒绝使用`../`. 有没有人在导出的处理 .app 中同时读取和写入同一个文件？

这是处理文件加载和保存的类的代码：

```
class Camera {
    PImage cameraImage;
    int cameraPadding = 10;
    int cameraWidth = 60;
    int opacity = 0;
    int flashDecrementer = 50; //higher number means quicker flash
    int pictureName;

    Camera() {
        String[] pictureIndex = loadStrings("assets/pictureNumber.txt");
        pictureName = int(pictureIndex[0]);
        cameraImage = loadImage("assets/camera.jpg");
        String _pictureName = "" + char(pictureName); 
        println(pictureName); 
    }

    void display(float mx, float my) {
        image(cameraImage, cameraPadding, cameraPadding,
              cameraWidth, cameraWidth-cameraWidth/5);
    }

    boolean isOver(float mx, float my) {
        if (mx >= cameraPadding &&
            mx <= cameraPadding+cameraWidth &&
            my >= cameraPadding &&
            my <= cameraPadding+cameraWidth-cameraWidth/5) {
            return true;
        }
        else {
            return false;
        }
    }

    void captureImage() {
        save("pictures/"+lines.picturePrefix+"_"+pictureName+".jpg");
        pictureName++;
        String _null = "";
        // String _tempPictureName = _null.valueOf(pictureName);
        String[] _pictureName = {_null.valueOf(pictureName)}; 
        saveStrings("assets/pictureNumber.txt", _pictureName);
        println(_pictureName);
    }

    void flash() {
        fill(255, opacity);
        rect(0,0,width,height);
        opacity -= flashDecrementer;
        if(opacity <= 0) opacity = 0;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T03:27:02.293

经过大量搜索后，我发现您必须使用 savePath() 才能从 project.jar 之外的目录中读取。相机类构造函数现在看起来像这样：

```
path = savePath("storage");
println(path);
String[] pictureIndex = loadStrings(path+"/pictureNumber.txt");
pictureName = int(pictureIndex[0]);
cameraImage = loadImage("assets/camera.jpg");
String _pictureName = ""+char(pictureName); 
```

一切正常！

# jquery - 如果元素不包含具有特定 css 的元素

> ID：15733191
> 
> 赞同：-1
> 
> 时间：2013-03-31T18:52:53.527
> 
> 标签：jquery, html, css

如果元素不包含某个元素，我有一个 jQuery 脚本来隐藏它：

```
<script type="text/javascript"> 
$(document).ready(function(){
    $("div.main div p").not(":has(span)").css("display","none");
});
</script>

<div class="main">
    <div>
        <p>Hello <span>OK</span></p>
        <p>Hi</p>
    </div>
    <div>
        <p>Yo</p>
    </div>
</div> 
```

该脚本将隐藏`<p>Hi</p>`和`<p>Yo</p>`文本。

如何检查下的 div 是否`div.main`不包含包含的`<p>`元素`<span>`，或者以其他方式：如果`<p>`div 下的所有元素都设置为`display:none`？...并将这些 div 设置为`display:none`.

所以 HTML 输出将是：

```
<div>
    <p>Hello <span>OK</span></p>
    <p style="display:none">Hi</p>
</div>
<div style="display:none">
    <p style="display:none">Yo</p>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:07:13.690

一种方法是遍历 div 并检查它们是否包含任何具有跨度的 p 元素。像下面这样的东西会起作用：

```
$("div.main div").each(function(){
  if($(this).find("p:has(span)").length == 0){
    $(this).hide();
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T19:13:13.860

我认为你可以更简单地做到这一点：

```
$("div.main div p:not(:has(span)), div.main div:not(:has(p>span))").hide(); 
```

jsFiddle 演示：http: [//jsfiddle.net/pdBbU/1/](http://jsfiddle.net/pdBbU/1/)

# jquery - 如何设置 div 的高度匹配响应内容？

> ID：15733192
> 
> 赞同：2
> 
> 时间：2013-03-31T18:52:56.033
> 
> 标签：jquery, html, height, responsive-design

我尝试执行以下操作：
单击重新调整与 div 内容高度匹配的 div 高度（内容通过“overflow:hidden”隐藏）
div 的内容是响应式的（意味着如果窗口宽度改变了 div 内容高度变化，也是。

单击更改 div (.video) 高度以匹配 div 内容 (.video-container) 高度：

```
$('.video').click(function()
{
    $(this).animate(
    {
        height:$('.video .video-container').height()
    });
}); 
```

这很好用，但是如果我调整窗口大小，.video-container 的高度会发生变化，我需要再调整 .video 的大小。

这是我已经得到的一切：

视频：

```
<div class="video">
    <div class="video-container">
        <div class="flowplayer">
            <video preload='none'>
                <source type="video/mp4" src="video.mp4"/>
            </video>
        </div>
    </div>
</div> 
```

javascript:

```
$(document).ready(function()
{
    $('.video').click(function()
    { 
        $(this).animate(
        {
            height:$('.video .video-container').height()
        }); 
    }); 
```

链接已删除 - （找到解决方案，现在一切正常）

如果您单击它扩展的第一个黑色容器，之后您会注意到，如果您重新调整浏览器的大小，视频会变小，但容器会保持大。我希望这能澄清问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:45:59.077

根据您发布的新信息，我想出了这个：

**新**小提琴示例：http: [//jsfiddle.net/YSqAX/4/](http://jsfiddle.net/YSqAX/4/)

我使用了调整大小插件，因为原生 jquery`resize`不会检测元素何时调整大小。

[Ben Alman jquery 调整大小插件](http://benalman.com/projects/jquery-resize-plugin/)

```
//animate height
$.fn.animateHeight = function (container) {
    var thisHeight = $(container).map(function (i, e) {
        return $(e).height();
    }).get();

    return this.animate({
        height: thisHeight
    });
};

$(".video").on("click", function () {
    $(this).animateHeight(".video-container");
});

$(".video").resize(function (e) {
    $(this).animateHeight(".video-container");
}); 
```

# php - BCrypt 在哪里使用 2x 前缀？

> ID：15733196
> 
> 赞同：29
> 
> 时间：2013-03-31T18:53:24.967
> 
> 标签：php, bcrypt, crypt

问题是同一个标题，$2x$ 在 BCrypt 中用在哪里？

下面的场景对吗？

`$2a$`当服务器 PHP 版本较早时，我们已经有一组带有前缀哈希的密码`5.3.7`。现在我们将 PHP 升级到`5.3.7+`，现在我们必须首先用`$2x$`算法验证以前的密码，然后用`$2y$`前缀重新哈希密码。这是正确的？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2016-03-25T17:54:27.710

# BCrypt 变种

**$2$**

BCrypt 是由 OpenBSD 人设计的。它旨在散列密码以存储在 OpenBSD 密码文件中。散列密码与前缀一起存储，以识别所使用的算法。BCrypt 得到了前缀`$2$`。

这与其他算法前缀形成对比：

*   `$1$`: MD5
*   `$3$`: NTHASH
*   `$5$`: SHA-256
*   `$6$`: SHA-512
*   `$7$`: 加密

**$2a$**

最初的 BCrypt 规范没有定义如何处理非 ASCII 字符，或者如何处理空终止符。对规范进行了修订，以指定在散列字符串时：

*   字符串必须是 UTF-8 编码的
*   必须包含空终止符

**$2x$, $2y$** *（2011 年 6 月）*

在[crypt_blowfish中发现了一个错误](https://pear.php.net/package/Crypt_Blowfish), BCrypt 的 PHP 实现。这是第 8 位设置的错误处理字符。

他们建议系统管理员更新他们现有的密码数据库，用 替换`$2a$`，`$2x$`以表明这些哈希是错误的（并且需要使用旧的损坏算法）。他们还提出了让 crypt_blowfish`$2y$`为固定算法生成的哈希值发出的想法。没有其他人，包括规范的 OpenBSD，采用`2x`/的想法`2y`。[此版本标记仅限于 crypt_blowfish](http://seclists.org/oss-sec/2011/q2/632).

版本**$2x$**和**$2y$**并不比**$2a$** “更好”或“更强” 。它们是 BCrypt 的一种特殊错误实现的残余。

**$2b$** *（2014 年 2 月）*

在 BCrypt 的 OpenBSD 实现中发现了一个错误。他们将字符串的长度存储在一个`unsigned char`. 如果密码长度超过 255 个字符，它将溢出并在 255 处换行。

BCrypt 是为 OpenBSD 创建的。当他们的库中出现错误时*，*他们决定修改版本是可以的。*这意味着如果您想保持最新的“他们的”*规范，其他所有人都需要效仿。

*   [http://undeadly.org/cgi?action=article&sid=20140224132743](http://undeadly.org/cgi?action=article&sid=20140224132743)
*   [http://marc.info/?l=openbsd-misc&m=139320023202696](http://marc.info/?l=openbsd-misc&m=139320023202696)

版本**$2b$**并不比**$2a$** “更好”或“更强” 。它是 BCrypt 的一个特殊错误实现的残余。但是由于 BCrypt 规范地属于 OpenBSD，他们可以将版本标记更改为他们想要的任何内容。

*2a*、*2x*、*2y*和*2b*之间没有区别。如果你正确地编写了你的​​实现，它们都会输出相同的结果。

*如果您从一开始就做正确的事（将字符串存储在 utf8 中并散列空终止符），那么： 2*、*2a*、*2x*、*2y*和*2b*之间没有区别。如果你正确地编写了你的​​实现，它们都会输出相同的结果。

唯一需要关心 2x 和 2y 的人是那些你可能一直在使用**crypt_blowfish**的人。唯一需要关心**2b**的人是那些可能一直在运行 OpenBSD 的人。

所有其他正确的实现都是相同且正确的。

# ios - ios - 如何正确设置 AdHoc 构建的配置和代码签名以在设备上进行测试？

> ID：15733199
> 
> 赞同：1
> 
> 时间：2013-03-31T18:53:34.490
> 
> 标签：ios, xcode, ios5, ios6, ad-hoc-distribution

我添加了一个名为“Alex 配置”的开发配置文件并将我的设备添加到其中。

然后我添加了一个名为“Ad hoc profile”的分发配置文件，只是因为我打算将它用于测试。然后我将我的设备添加到其中。

然后对于代码签名，我使用了这两个。

然后我使用“另存为 AdHoc 构建”功能归档并保存了 .ipa 文件。

但是当我将应用程序放在设备上时，我收到了这个错误：

```
Mar 31 12:04:30 ancient-phone lsd[12249] <Warning>: Attempting to store identifiers file
Mar 31 12:04:30 ancient-phone installd[12247] <Error>: 0x2ffac000 MobileInstallationInstall_Server: Staging: 0.44s; Waiting: 0.00s; Installation: 1.26s; LS Sync: 0.05s; Overall: 1.95s
Mar 31 12:04:31 ancient-phone installd[12247] <Error>: 0x2ffac000 filter_attributes: Info.plist keys requested via MobileInstallationLookup/Browse in client Xcode (via mobile_installation_proxy) were not found in MobileInstallation's cache. Please file a bug requesting that these keys be added: <CFBasicHash 0x1e6368c0 [0x39b4f100]>{type = mutable set, count = 18,
    entries =>
        0 : <CFString 0x39b3b9f4 [0x39b4f100]>{contents = "CFBundlePackageType"}
        1 : <CFString 0x1e6275d0 [0x39b4f100]>{contents = "BuildMachineOSBuild"}
        2 : <CFString 0x39b3ca44 [0x39b4f100]>{contents = "CFBundleResourceSpecification"}
        3 : <CFString 0x1e630980 [0x39b4f100]>{contents = "DTPlatformBuild"}
        4 : <CFString 0x39b39794 [0x39b4f100]>{contents = "DTCompiler"}
        5 : <CFString 0x39b3b564 [0x39b4f100]>{contents = "CFBundleSignature"}
        6 : <CFString 0x39b3c224 [0x39b4f100]>{contents = "DTSDKName"}
        7 : <CFString 0x1e53f9c0 [0x39b4f100]>{contents = "NSBundleResolvedPath"}
        8 : <CFString 0x39b38eb4 [0x39b4f100]>{contents = "UISupportedInterfaceOrientations"}
        10 : <CFString 0x39b40e84 [0x39b4f100]>{contents = "DTXcode"}
        13 : <CFString 0x39b40eb4 [0x39b4f100]>{contents = "CFBundleInfoDictionaryVersion"}
        16 : <CFString 0x39b3e304 [0x39b4f100]>{contents = "CFBundleSupportedPlatforms"}
        17 : <CFString 0x1e549610 [0x39b4f100]>{contents = "DTXcodeBuild"}
        18 : <CFString 0x1e62bdd0 [0x39b4f100]>{contents = "UIStatusBarTintParameters"}
        19 : <CFString 0x39b3ce54 [0x39b4f100]>{contents = "DTPlatformVersion"}
        20 : <CFString 0x39b3fbf4 [0x39b4f100]>{contents = "DTPlatformName"}
        21 : <CFString 0x39b40c84 [0x39b4f100]>{contents = "CFBundleDevelopmentRegion"}
        22 : <CFString 0x1e62bac0 [0x39b4f100]>{contents = "DTSDKBuild"}
    } 
```

我怀疑我可能误解了我必须制作的所有配置文件和所有代码签名。

我描述的过程中的某些事情听起来不对吗？我是否应该刚刚将设备添加到我的原始配置文件中？

# ruby-on-rails - 命令“rails server”上的 Ruby on rails 错误

> ID：15733201
> 
> 赞同：0
> 
> 时间：2013-03-31T18:53:37.540
> 
> 标签：ruby-on-rails, windows, sqlite, ruby-on-rails-3.2

我已经按照 github 上的所有步骤和 Ruby on rails 安装的官方文档进行了操作。我已经为 sqlite3 安装了 gem。另外，我已将 sqlite 的 dll 和 def 文件以及 .exe 文件复制到 Ruby/bin 我然后创建了一个名为 myapp 的示例应用程序并尝试通过命令“rails server”启动服务器

**它给出了以下错误：**

```
F:/Ruby200/lib/ruby/gems/2.0.0/gems/sqlite3-1.3.7-x86-mingw32/lib/sqlite3.rb:6:i
n `require': cannot load such file -- sqlite3/sqlite3_native (LoadError)
        from F:/Ruby200/lib/ruby/gems/2.0.0/gems/sqlite3-1.3.7-x86-mingw32/lib/s
qlite3.rb:6:in `rescue in <top (required)>'
        from F:/Ruby200/lib/ruby/gems/2.0.0/gems/sqlite3-1.3.7-x86-mingw32/lib/s
qlite3.rb:2:in `<top (required)>'
        from F:/Ruby200/lib/ruby/gems/2.0.0/gems/bundler-1.3.4/lib/bundler/runti
me.rb:72:in `require'
        from F:/Ruby200/lib/ruby/gems/2.0.0/gems/bundler-1.3.4/lib/bundler/runti
me.rb:72:in `block (2 levels) in require'
        from F:/Ruby200/lib/ruby/gems/2.0.0/gems/bundler-1.3.4/lib/bundler/runti
me.rb:70:in `each'
        from F:/Ruby200/lib/ruby/gems/2.0.0/gems/bundler-1.3.4/lib/bundler/runti
me.rb:70:in `block in require'
        from F:/Ruby200/lib/ruby/gems/2.0.0/gems/bundler-1.3.4/lib/bundler/runti
me.rb:59:in `each'
        from F:/Ruby200/lib/ruby/gems/2.0.0/gems/bundler-1.3.4/lib/bundler/runti
me.rb:59:in `require'
        from F:/Ruby200/lib/ruby/gems/2.0.0/gems/bundler-1.3.4/lib/bundler.rb:13
2:in `require'
        from F:/myapp/config/application.rb:7:in `<top (required)>'
        from F:/Ruby200/lib/ruby/gems/2.0.0/gems/railties-3.2.13/lib/rails/comma
nds.rb:24:in `require'
        from F:/Ruby200/lib/ruby/gems/2.0.0/gems/railties-3.2.13/lib/rails/comma
nds.rb:24:in `<top (required)>'
        from script/rails:6:in `require'
        from script/rails:6:in `<main>' 
```

**这是“捆绑列表”命令的输出：**

```
F:\myapp>bundle list
Gems included by the bund
  * actionmailer (3.2.13)
  * actionpack (3.2.13)
  * activemodel (3.2.13)
  * activerecord (3.2.13)
  * activeresource (3.2.1
  * activesupport (3.2.13
  * arel (3.0.2)
  * builder (3.0.4)
  * bundler (1.3.4)
  * coffee-rails (3.2.2)
  * coffee-script (2.2.0)
  * coffee-script-source
  * erubis (2.7.0)
  * execjs (1.4.0)
  * hike (1.2.1)
  * i18n (0.6.1)
  * journey (1.0.4)
  * jquery-rails (2.2.1)
  * json (1.7.7)
  * mail (2.5.3)
  * mime-types (1.22)
  * multi_json (1.7.2)
  * polyglot (0.3.3)
  * rack (1.4.5)
  * rack-cache (1.2)
  * rack-ssl (1.3.3)
  * rack-test (0.6.2)
  * rails (3.2.13)
  * railties (3.2.13)
  * rake (10.0.4)
  * rdoc (3.12.2)
  * sass (3.2.7)
  * sass-rails (3.2.6)
  * sprockets (2.2.2)
  * sqlite3 (1.3.7)
  * thor (0.18.1)
  * tilt (1.3.6)
  * treetop (1.4.12)
  * tzinfo (0.3.37)
  * uglifier (1.3.0) 
```

请帮助我..我很想在 RoR 中创建 webapps，但我遇到了这些错误。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T23:38:16.323

[从http://www.sqlite.org/download.html](http://www.sqlite.org/download.html)下载所需的可执行文件和 dll提取到您的 ruby​​ 的 bin (f:\Ruby200\bin)

* * *

如果您检查 sqlite3 的源代码：

```
# support multiple ruby version (fat binaries under windows)
begin
  RUBY_VERSION =~ /(\d+\.\d+)/
  require "sqlite3/#{$1}/sqlite3_native"
rescue LoadError
  require 'sqlite3/sqlite3_native'
end 
```

**您的应用程序在require 'sqlite3/sqlite3_native'**上中断，您可以执行 irb 并尝试加载该文件，它应该会失败，修复它，并且您的应用程序应该可以毫无问题地运行。

确保在 %PATH% 上包含 ruby​​ 二进制文件的路径，这样当您执行**require 'sqlite3/sqlite3_native'**时，它实际上具有该文件的有效路径。

您也可以尝试添加 boot.rb 文件：

```
$LOAD_PATH.unshift('F:/Ruby200/bin') 
```

所以应用程序，当您需要具有相对路径**sqlite3/sqlite3_native**的文件时，它实际上可以找到该文件。

一旦您能够加载该文件，它应该可以工作或利用分段错误（它的窗口：P）

# android - 如何将我的菜单系统移植到没有物理菜单按钮的设备上，例如 Nexus？

> ID：15733202
> 
> 赞同：2
> 
> 时间：2013-03-31T18:53:37.913
> 
> 标签：android, android-actionbar, android-menu

所以我意识到我已经浪费了很多时间来构建一个依赖于带有物理菜单按钮的设备的菜单系统，它适用于所有设备 bar Nexus。

是的，鉴于我一直在使用典型的`onCreateOptionsMenu(Menu menu), onPrepareOptionsMenu(Menu menu) and onOptionsItemSelected(MenuItem item)` 方法。与您一样，使用通常的 XML 菜单布局。如何过渡到没有菜单按钮的设备？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T18:55:30.397

我会推荐[ActionBarSherlock。](http://actionbarsherlock.com/)它与旧版本的 Android 向后兼容，并且“操作栏”是您想要放置菜单或常用选项的地方。

# html - 如何在菜单的列中显示一些选项

> ID：15733203
> 
> 赞同：0
> 
> 时间：2013-03-31T18:53:45.907
> 
> 标签：html, css, menu

我想在这个网站上做一个菜单：[http](http://www.accenture.com/us-en/pages/index.aspx) ://www.accenture.com/us-en/pages/index.aspx ex。外包。可以使用 css 和 html 来做到这一点。我不能用列创建“li”或“ul”。

我的代码

```
<body>

<style type="text/css">#cssmenu{
    border:none;
    border:0px;
    margin:0px;
    padding:0px;
    font-family:verdana,geneva,arial,helvetica,sans-serif;
    font-size:12px;
    font-weight:bold;
    color:8e8e8e;
    }
#cssmenu ul{
    background:url(menu_assets/images/menu-bg.gif) top left repeat-x;
    height:43px;
    list-style:none;
    margin:0;
    padding:0;
    }
    #cssmenu li{
        float:left;
        padding:0px 8px 0px 8px;
        }
    #cssmenu li a{
        color:#666666;
        display:block;
        font-weight:bold;
        line-height:43px;
        padding:0px 25px;
        text-align:center;
        text-decoration:none;
        }
        #cssmenu li a:hover{
            color:#000000;
            text-decoration:underline;
            }
    #cssmenu li ul{
        background:#e0e0e0;
        border-left:1px solid #0079b2;
        border-right:1px solid #0079b2;
        border-bottom:1px solid #0079b2;
        display:none;
        height:auto;
        filter:alpha(opacity=95);
        opacity:0.95;
        position:absolute;
        width:600px;
        /*top:1em;
        /*left:0;*/
        }
    #cssmenu li:hover ul{
        display:block;
        }
    #cssmenu li li {
        display:block;
        float:none;
        padding:0px;
        width:225px;
        }
    #cssmenu li ul a{
        display:block;
        font-size:12px;
        font-style:normal;
        padding:0px 10px 0px 15px;
        text-align:left;
        }
        #cssmenu li ul a:hover{
            background:#949494;
            color:#000000;
            opacity:1.0;
            filter:alpha(opacity=100);
            }
    #cssmenu p{
        clear:left;
        }   
    #cssmenu .active > a{
        background:url(menu_assets/images/current-bg.gif) top left repeat-x;
        color:#ffffff;
        }
    #cssmenu .active > a:hover {
        color:#ffffff;
        }
        </style>
<div id='cssmenu'>
<ul>
   <li class='active'><a href='index.html'><span>Home</span></a></li>
   <li class='has-sub'><a href='#'><span>Products</span></a>
      <ul>
         <li><a href='#'><span>Product 1</span></a></li>
         <li><a href='#'><span>Product 2</span></a></li>
         <li><a href='#'><span>Product 3</span></a></li>
         <li><a href='#'><span>Product 3</span></a></li>
         <li class='last'><a href='#'><span>Product 4</span></a></li>
      </ul>
   </li>
   <li><a href='#'><span>About</span></a></li>
   <li class='last'><a href='#'><span>Contact</span></a></li>
</ul>
</div>
<div style="clear:both; margin: 0 0 30px 0;">&nbsp;</div>

</body> 
```

当然我在网上搜索，但我找不到解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T00:16:44.627

**特定的选择器**

首先，当您使用类似`#cssmenu ul`or的 CSS 规则`#cssmenu li`时，该 CSS 规则将应用于主菜单和子菜单的 HTML 标签。某些样式可能会应用于不需要应用的元素。为避免这种可能的混淆，请`>`在更多 CSS 选择器中使用子组合器。例如：

```
#cssmenu > ul {...}           // Only applied to main menu
#cssmenu > ul > li {...}      // Only applied to main menu li tags
#cssmenu > ul > li > a {...}  // Only applied to main menu links

#cssmenu ul ul {...}       // No confusion here, since menu isn't 3 levels deep
#cssmenu ul ul li {...}    // No confusion here, only applied to submenu li tags
#cssmenu ul ul li a {...}  // No confusion here, only applied to submenu links 
```

**浮动菜单项**

其次，如果您正在模仿[埃森哲菜单](http://www.accenture.com/us-en/pages/index.aspx)，在页面右侧显示可变宽度菜单项的最快方法是将菜单项向左浮动，同时将整个菜单向右浮动。

```
#cssmenu > ul      { float: right; ... }
#cssmenu > ul > li { float: left; ... }
...
<ul>
   <li class='active'><a href='index.html'><span>Home</span></a></li>
   <li class='has-sub'><a href='#'><span>Products</span></a> ... </li>
   <li><a href='#'><span>About</span></a></li>
   <li class='last'><a href='#'><span>Contact</span></a></li>
</ul> 
```

有时将父母和孩子朝相反的方向浮动是有问题的。如果这样做有任何问题，最安全的选择是将菜单项浮动到右侧。在这种情况下，为了让它们以正确的顺序显示，您必须颠倒 HTML 源代码中菜单项的顺序。

```
#cssmenu > ul > li { float: right; ... }
...
<ul>
   <li class='last'><a href='#'><span>Contact</span></a></li>
   <li><a href='#'><span>About</span></a></li>
   <li class='has-sub'><a href='#'><span>Products</span></a> ... </li>
   <li class='active'><a href='index.html'><span>Home</span></a></li>
</ul> 
```

# search - Python - CSV 模块，从文件中获取信息

> ID：15733206
> 
> 赞同：0
> 
> 时间：2013-03-31T18:53:54.820
> 
> 标签：search, csv, iteration

情况如下：

我遇到的第一个问题是从 CSV 文件中获取信息。我正在编写代码的目的是获取有关 ZCTA（邮政编码）的大量信息，用于许多不同的群组（目前正在使用六个，但该代码旨在灵活地拥有任意数量的队列）。一个文件包含按队列划分的每个 ZCTA 的人口。另一个文件包含每个 ZCTA 的每个队列的“病例”（观察到的癌症病例）的数量。另一个文件有每个队列的粗略率，爱荷华州（本研究的重点），人们可以“预期”看到癌症人数的比率，对于一个人口，按队列。还有几个其他文件，但这些是重点，因为这是我的问题所在。

我的代码最初所做的是读取人口文件并通过 ZCTA 获取每个队列的人口。每个 ZCTA 和信息都存储在一个列表中，然后存储在一个列表列表（嵌套）中，其中包含所有 ZCTA。代码然后得到粗略的费率。然后，粗率乘以每个 ZCTA 的适当队列，并与每个 ZCTA 内的所有其他队列相加，以获得每个 ZCTA 的我们可以预期看到患有癌症的总人数。人口也被总结了。此信息存储在另一个列表中，以及包含所有 ZCTA 的列表中。该信息将成为重点（所有 ZCTA 的列表，每个 ZCTA 都包含总人口和预期病例总数）。

所以，问题是我需要获取这个新获得的列表并获取每个队列的 OBSERVED 病例数，将它们加在一起，将其附加到适当的 ZCTA 并将其写入新文件。我已经实现了可以很好地执行此操作的代码，除了底部 22 个左右的 ZCTA 没有获得观察到的案例数量。我不知道是代码还是什么，但它适用于所有其他 906，但没有得到底部的 22。

读者可以在以下位置找到我讨论过的文件（观察到的案例文件和输出文件）的示例数据：[Gist](https://gist.github.com/FortyLashes/c90608c3e938587ebd11)

这是我正在使用的代码：

```
`expectedcsv = open('ExpectedCases.csv', 'w',  newline= '')
expectedwriter = csv.writer(expectedcsv, delimiter = ',')
expectedHeader = ['zcta', 'expected', 'pop', 'observed']
thecasesreader = csv.reader(thecasescsv, delimiter = ',')
for zcta in zctaPop:
   caseCounter = 0
   thecasescsv = open('NewCaseFile.csv', 'r', newline = '')
   thecasesreader = csv.reader(thecasescsv, delimiter = ',')
   for case in thecasesreader:
      if case[0] == zcta[0]:
         for i in range(3, len(case)):
            caseCounter += int(case[i])
   zcta.append(caseCounter)
   expectedwriter.writerow(zcta)
expectedcsv.close()
thecasescsv.close()` 
```

我还想提出的其他一点是，稍后在代码中，所有这些的实际目的是为每个网格点创建一个 SMR 过滤器。网格点有些随意，它们被放置在整个爱荷华州（通过坐标）。SMR 是观察到的病例数除以预期病例数。阈值，即特定过滤器的预期案例数量由用户设置。因此，如果用户想要在 150 个预期案例（对于每个网格点）上创建过滤器，则代码会遍历每个 ZCTA，对预期案例求和，直到找到超过 150 个。到最后一个 ZCTA 的距离是过滤器的“半径”。

为此，我构建了一个距离矩阵（从每个网格点到每个 ZCTA 的距离），然后对其进行排序，最接近最远。由于文件的大小（2300 X 930），我必须逐行读取该文件并从其他文件中获取所有信息。所以，从最近的 ZCTA 开始，我得到人口、预期病例和观察病例（上面讨论了这个文件的问题），并将这些分别添加到各自的计数器（一个用于人口，一个用于观察，一个用于预期） . 然后它转到下一个最接近的 ZCTA 并执行相同的操作，直到超过阈值。

这里的问题是我无法使用 CSV 模块来读取这些文件，因为我已经从另一个文件中读取并且索引会丢失。所以，我不得不只使用常规`filename.read()`的，然后需要对`maketrans`and进行一些有趣的使用`.translate`。我不确定它是否有效或效果很好。一切似乎都很好，但是如果没有解决上述问题，就无法判断。我已经包含了下面的代码，但想知道是否有人有更好的想法/建议？

```
`expectedCSV = open('ExpectedCases.csv', 'r', newline = '')
 table = str.maketrans('\r', ' ')
 content = expectedCSV.read()
 expectedCSV.close()
 content = content.translate(table)
 content = content.split(sep = '\n')
 newContent = []
 for item in content:
     newContent.append((item.split(sep= ',')))
 content = ' '
 for item in newContent:
     if item[0] == currentZcta:
          expectedTotal += (float(item[1]))
          totalPop += (float(item[2]))
          totalObservedCount += (float(item[3]))` 
```

此外，我不知道如何将方法着色为蓝色，变量着色为红色，就像该站点的一些更出色的用户所做的那样。我会非常有兴趣学习如何在以后的帖子中做到这一点。

如果有人需要更多信息或任何澄清以帮助回答/制定解决方案，请务必询问！感谢您花时间阅读！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:06:17.817

所以，我最终通过计算观察值以及预期和人口来“解决”这个问题，方法是打开每个计算的 ZCTA 的文件。这并没有真正解决我正在处理的问题，而是找到了解决方法。我有点失望，更多的人没有看到和/或回应这一点。如果有人想出实际问题的答案，请务必在此处发布。-麦克风

# php - 仅在满足字段时才发送表单（获取）数据（不是验证）

> ID：15733210
> 
> 赞同：1
> 
> 时间：2013-03-31T18:54:03.463
> 
> 标签：php, javascript, html

我有一个表格，就是这个

```
<form method="get" action="<?php bloginfo('url'); ?>">
   <input name="date-beginning" type="text" class="datepicker" />
   <input name="date-end" type="text" class="datepicker" />
   <input name="s" type="text" />
   <input type="submit" value="Ok" class="botao-pequeno botao-pequeno-input" />
</form> 
```

好吧，当用户发送所有字段时，我们得到以下响应： [http ://myblogurl.com/?s=example&date-beginning=05/05/05&date-end=07/07/07](http://myblogurl.com/?s=example&date-beginning=05/05/05&date-end=07/07/07)

如果他没有填写，例如`date-beginning`我们得到的字段[http://myblogurl.com/?s=example&date-beginning=&date-end=07/07/07](http://myblogurl.com/?s=example&date-beginning=&date-end=07/07/07)

我想要的是，如果他不填写该字段，例如`date-beginning`，仍然会发送表单，但不会发送变量，例如：[http ://myblogurl.com/?s=example&date-end= 07/07/07](http://myblogurl.com/?s=example&date-end=07/07/07)

有没有办法做到这一点？如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T19:02:04.147

```
var form = document.forms[0];
form.addEventListener('submit', function(){
    var a = document.getElementsByName('date-beginning')[0];
    if(a.value === '')
        a.disabled = true;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T19:21:59.633

karaxuna 的 anwser 工作。我只是将它改编为jQuery，如果有人感兴趣，这是代码

```
$("#the-form").submit(function() {
        if($('#the-field').val() === ''){
            $('#the-field').attr('disabled',true);
        }
        if($('#the-other-field').val() === ''){
            $('#the-other-field').attr('disabled',true);
        }
    }); 
```

# c# - C# UdpSocket在发送后开始接收，在几个包后停止接收

> ID：15733218
> 
> 赞同：0
> 
> 时间：2013-03-31T18:54:56.577
> 
> 标签：c#, udp, multicast, beginreceive

我正在尝试通过 UdpSocket 从多播地址接收数据。在我通过套接字发送数据之前，套接字不接收数据。发送后，我可以收到几个包裹，然后我必须再次发送，才能收到更多包裹。同时从其他主机发送的包丢失。我认为，这不是像这里这样的防火墙问题：[C# UDP Socket 在发送数据之前不会接收数据，](https://stackoverflow.com/q/5111716/1489968)因为 whireshark 接收所有包。有人可以向我解释这种行为吗？

```
class Program
{
    private static UdpClient _mdnsSocket;
    private static IPEndPoint _mdnsGroup;
    private static IPEndPoint _localEp;

    static void Main(string[] args)
    {
        var interfaces = NetworkInterface.GetAllNetworkInterfaces()
                                         .Where(i => i.OperationalStatus == OperationalStatus.Up)
                                         .ToArray();

        for (int i = 0; i < interfaces.Length; ++i)
        {
            var interf = interfaces[i];
            Console.WriteLine("{0}) Name: {1}", i, interf.Name);
        }
        Console.WriteLine();

        do
        {
            int i;
            Console.Write("Interface: ");
            var line = Console.ReadLine();
            if (int.TryParse(line, out i) && i < interfaces.Length)
            {
                var addr = interfaces[i].GetIPProperties()
                                        .UnicastAddresses.FirstOrDefault(a => a.Address.AddressFamily == AddressFamily.InterNetwork);
                if (addr != null)
                {
                    _localEp = new IPEndPoint(addr.Address, 5353);
                    Console.WriteLine("Choosen IP: {0}", _localEp);
                }
            }
        } while (_localEp == null);

        _mdnsGroup = new IPEndPoint(IPAddress.Parse("224.0.0.251"), 5353);
        _mdnsSocket = new UdpClient();
        _mdnsSocket.Client.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReuseAddress, true);
        _mdnsSocket.ExclusiveAddressUse = false;
        _mdnsSocket.Client.Bind(_localEp);
        _mdnsSocket.JoinMulticastGroup(_mdnsGroup.Address, _localEp.Address);
        BeginReceive();

        Console.WriteLine("1 to switch to multicast mode (default)");
        Console.WriteLine("2 to switch to unicast mode");
        Console.WriteLine("s for sending a message");
        Console.WriteLine("ESC for exit");

        ConsoleKey key;
        IPEndPoint ip = _mdnsGroup;
        IPEndPoint unicastip = null;
        var mode = "multicast";

        do
        {
            Console.Write("1/2/s/ESC: ");
            key = Console.ReadKey().Key;
            Console.WriteLine();

            switch (key)
            {
                case ConsoleKey.D1:
                    ip = _mdnsGroup;
                    Console.WriteLine("Switched to multicast mode");
                    mode = "multicast";
                    break;

                case ConsoleKey.D2:
                    Console.Write("Enter new IP (leave empty to use {0}):", unicastip);
                    var input = Console.ReadLine();
                    if (string.IsNullOrEmpty(input))
                    {
                        if (unicastip == null)
                        {
                            Console.WriteLine("error: no last ip!");
                            break;
                        }
                        ip = unicastip;
                        Console.WriteLine("Switched to unicast mode");
                        mode = "unicast";
                    }
                    else
                    {
                        unicastip = new IPEndPoint(IPAddress.Parse(input), 5353);
                        ip = unicastip;
                        Console.WriteLine("Switched to unicast mode");
                        mode = "unicast";
                    }
                    break;

                case ConsoleKey.S:
                    var msg = string.Format("Hello from PC via {0}", mode);
                    var bytes = Encoding.ASCII.GetBytes(msg);

                    Console.WriteLine("Sending to {0}", ip);
                    _mdnsSocket.Send(bytes, bytes.Length, ip);
                    break;
            }
        } while (key != ConsoleKey.Escape);
        _mdnsSocket.Close();
    }

    private static void BeginReceive()
    {
        Console.WriteLine("BeginReceive");
        _mdnsSocket.BeginReceive(ReceiveCallback, _mdnsSocket);
    }

    private static void ReceiveCallback(IAsyncResult ar)
    {            
        try
        {
            var ep = new IPEndPoint(IPAddress.Any, _mdnsGroup.Port);
            var data = _mdnsSocket.EndReceive(ar, ref ep);

            var message = Encoding.ASCII.GetString(data);
            Console.WriteLine(message);
        }
        finally
        {
            BeginReceive();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T10:32:37.910

毕竟，这似乎是一个防火墙问题。当我明确允许端口 5353 上的传入 UPD 时，它正在工作*（为什么允许相应程序的所有传入 UPD 流量不起作用）*。我现在用所谓的[打孔](http://en.wikipedia.org/wiki/Hole_punching)机制解释问题中描述的行为。当我错的时候请纠正我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-28T10:08:51.347

同样的问题，但防火墙没有解决它。我正在使用 Windows 10 PRO。

我发现了另一个不受欢迎的效果：没有接收到广播消息，但直接接收 IP 消息。

我发现的唯一解决方法是添加一个计时器，该计时器每 10 秒在广播中发送一个空字节数组，因此通信保持得足够好。问题是总是有无用的消息传输到网络，不是那么重，但远非最佳。

关闭套接字并重新启动也可以解决问题，但速度较慢，并且会强制 GC 运行。

我在 Unity (Mono) 和 Visual Studio 应用程序上使用相同的 UDP 类，但这种“效果”只发生在 Unity 应用程序下。这只发生在 IPV4 套接字上，IPV6 套接字似乎永远不会停止监听。

我确信这是新操作系统中的某种“停止使用 IPV4 广播”功能，因为 Windows 7 运行良好。

希望能帮助到你。

# python - python list vote(['G', 'G', 'N', 'G', 'C'])

> ID：15733220
> 
> 赞同：-1
> 
> 时间：2013-03-31T18:55:09.823
> 
> 标签：python

```
vote(['G', 'G', 'N', 'G', 'C']) 
```

我想得到这个结果：`('G', [1, 3, 0, 1])`

```
g_count = 0
n_count = 0
l_count = 0
c_count = 0
for i in range(len(ballots)):
    if ballots[i] == 'G':
        g_count += 1
    elif ballots[i] =='N':
        n_count += 1
    elif ballots[i] == 'L':
        l_count +=1
    else:
        c_count += 1

return [n_count,g_count,l_count,c_count] 
```

我如何获得前面的“G”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T18:59:34.580

像这样的东西：

```
In [9]: from collections import Counter

In [15]: def vote(lis):
   ....:     c=Counter(lis)
   ....:     return c.most_common()[0][0],[c[x] for x in "NGLC"]
   ....: 

In [16]: vote(['G', 'G', 'N', 'G', 'C'])
Out[16]: ('G', [1, 3, 0, 1])

In [17]: vote(['G', 'G', 'N', 'G', 'C','L','L'])
Out[17]: ('G', [1, 3, 2, 1])

In [18]: vote(['G', 'L', 'N', 'G', 'C','L','L'])
Out[18]: ('L', [1, 2, 3, 1]) 
```

这里`c.most_common()`返回`[('G', 3), ('C', 1), ('N', 1)]`，从这里就可以得到了`'G'`。

# javascript - 如何将 javascript 变量添加到 HTML 图像 src 标记

> ID：15733227
> 
> 赞同：5
> 
> 时间：2013-03-31T18:55:49.763
> 
> 标签：javascript, jquery, html, image, random

我**知道**这个答案就在这里，但我一直找不到它（或者至少在我看到它时*认出它！）。*我是 jquery 的相对菜鸟，所以请多多包涵。

# 问题：

我有 20 张图片，命名为**1.png** 到**20.png**。我希望每次用户单击按钮时随机显示不同的图像。

# 什么工作：

我生成随机数的 javascript 代码如下所示：

```
var randomImage = 1 + Math.floor(Math.random() * 20); 
```

# 什么不是...

我想要做的是将结果作为图像的名称传递给我的 HTML 文档，因此它的内容如下：

```
 <img id="randImg" class="img_answer" src="randomImage.png"> 
```

我尝试连接，但似乎无法解决这个问题。我是否需要创建一个影响 img ID 或类的函数？谁能指出我最干净的方法来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-31T18:58:15.090

```
var randomImage = 1 + Math.floor(Math.random() * 20);    
var imgName = randomImage+".png";
$("#randImg").attr("src",imgName); 
```

演示：http: [//jsfiddle.net/a9Ltw/](http://jsfiddle.net/a9Ltw/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-31T19:09:37.377

拼写一下以帮助教学：

在你的页面上，你会有这样的东西：

```
<img id=randomImage /> 
```

并且可能在头部隐藏图像，直到您选择要加载的图像，这个：

```
<style>
#randomImage {
    width: 400px; height: 200px; /* or whatever the dimensions are */
    visibility: hidden;
}
</style> 
```

然后在你的 Javascript 中：

```
var ordinal = 1 + Math.floor(Math.random() * 20);
$('#randomImage').css('visibility', 'visible').attr('src', ordinal + '.png'); 
```

所以 HTML 布局了 img 标签，一些早期的 CSS 设置它的尺寸并将其隐藏，因此在某些浏览器中没有丑陋的破碎图像图标等 - 只是一个空白区域。

然后最终 Javascript 加载并运行，确定一个随机序数。Javascript 的第二行调用 jquery 使 img 可见并将其 src 属性设置为随机图像。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-31T19:23:48.987

```
$(document).ready(function() {
    var randomImage = 1 + Math.floor(Math.random() * 20),    
                img = randomImage + ".png";

    $("#randImg").attr("src", img);
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-31T18:58:27.353

只需在`img`标签中添加一些默认图像以防止在用户禁用 JavaScript 时不显示任何内容，然后在 jQuery 中使用`$("#randImg").attr("src", randomImage + ".png");`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-16T21:19:33.187

```
var thesoruce = "http://localhost:8080/content/dam/admin/" + id ;

 g_fb.find('p').append('<img src= '+thesoruce +'  height="250px" width="600px">'); 
```

# mysql - MySQL左连接和缺失行

> ID：15733228
> 
> 赞同：-1
> 
> 时间：2013-03-31T18:55:51.267
> 
> 标签：mysql

那么有没有办法制作类似的东西：

# 表格1

```
id -> PK
table1_id -> FK

id | name | table1_id
1,'test',NULL
2,'test2',NULL
3,'sub_val1',1
4,'sub_val2',1

select a.name
     , b.name 
from table1 a 
left join table1 b 
   on a.id=b.table1_id 
where a.table1_id is null; 
```

这将返回如下内容：

```
test,sub_val1
test,sub_val2
test2,NULL 
```

我希望它返回如下内容：

```
test,NULL
test,sub_val1
test,sub_val2
test2,NULL 
```

有办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:09:16.517

我唯一想到的是：

```
select
    a.name,
    b.name
from
    table1 a
inner join
    table1 b on a.id = b.table1_id
where
    a.table1_id is null
union all
    select name, null from table1 where table1_id is null 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T19:09:38.477

我只是在猜测，但也许这就是你想要的：

```
select a.name as first_name
     , b.name as second_name
from table1 a 
left join table1 b 
   on a.id=b.table1_id 
where a.table1_id is null
union
select name as first_name
     , null as second_name
from table1  
where table1_id is null
order by first_name, second_name 
```

您可能需要在第二个操作 (UNION) 中指定第二列的定义。

# php - php mysql 错误

> ID：15733229
> 
> 赞同：0
> 
> 时间：2013-03-31T18:55:51.833
> 
> 标签：php, jquery, mysql, ajax, json

我正在创建一个评论发布系统，允许用户使用 php mysql jquery 和 ajax 以及使用 Json 编写评论，但是当我插入 Json 并使用 firedebug 调试系统时出现问题，我收到错误消息： **SyntaxError: JSON.parse : 意想不到的角色**谁能帮我解决这个错误

这是我使用 Json 的代码@line 42

```
$(document).ready(function() {
//this will fire whene the page will completly been loaded 
$('#comment-post-btn').click(function(){

     comment_post_btn_click();
    });
});

function comment_post_btn_click()
{
// text within the text area
  var _comment = $('#comment-post-text').val();
  var _userId = $('#userId').val();
  var _userName = $('#userName').val();

  if(_comment.length > 0 && _userId != null )
  {
      // proceed with the ajax callback
      $('#comment-post-text').css('border', '1px solid #e1e1e1');

        $.post("ajax/comment_insert.php",
           {
             task : "comment_insert",
             userId :_userId,
             comment :_comment
           }
           )

            .error(

                   function(data)
                   {
                      console.log("Error" );

                   })

                .success(

                    function(data)
                   {
                      comment_insert(jQuery.parseJSON(data));
                      console.log("Response text:  " + data )
                   }
           );
     console.log(_comment + " UserName: " +  _userName  + " User id: " + _userId );
  }
  else
  {
      $('#comment-post-text').css('border', '1px solid #ff0000');
      console.log("the text area was empty");
  }

   // remove the text from the textarea
   $('#comment-post-text').val("");

}

function comment_insert(data)
{
    var t = '';
t+= '<li class="comment-holder" id="'+data.comment_id+'">';
t+=     '<div class="user-img">';
t+=         '<img src="'+data.profile_img+'" class="user-img-pic" />';
t+=     '</div>';
t+=  '<div class="comment-body">';
t+=     '<h3 class="username-field">'+data.userName+'</h3>';
t+=      '<div class="comment-text">'+data.comment+'</div>';
t+=  '</div>';

t+=  '<div class="comment-buttons-holder">';
t+=         '<ul>';
t+=            '<li class="delete-btn">X</li>';
t+=          '</ul>';
t+=  '</div>';
t+='</li>';

$('.comments-holder-ul').prepend(t);
} 
```

# comment_insert.php

```
<?php

  if(isset($_POST['task']) && $_POST['task'] == 'comment_insert')
  {
      require_once("db_connect.php");

     $userId = (int)$_POST['userId'];
     $comment = addslashes( str_replace( "\n", "<br>", $_POST['comment']));

     $std = new stdClass();
     $std->comment_id = 24;
     $std->userId = $userId;
     $std->comment = $comment;
     $std->userName = "georges matta";
     $std->profile_img = "images/default_img.jpg";

     require_once("comments.php");

     if(class_exists('Comments'))
     {
         $commentInfo = Comments::insert($comment.$userId);

         if($commentInfo!=null)
         {

         }
     }

     **echo json_encode($std);**

  }
  else
  {
      header("Location: /");
  }

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:11:05.353

两件事情。1.查看你解析的数据是否有一些无效字符。

1.  如果您正在获取 JSON 对象的集合并尝试解析它们并绑定它们，您应该查看 JSON 对象并将其绑定到视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-24T07:28:44.323

```
 if(class_exists('Comments'))
     {
         $commentInfo = Comments::insert($comment,$userId);

         if($commentInfo!=null)
         {

         }
     } 
```

我认为 Insert 函数接受 2 个变量，例如`comment`and`userid` 但是你提到的一个变量为`$comment.$userid`

我认为这是更改后执行代码后的问题`. as ,`

# r - 控制文本对齐

> ID：15733237
> 
> 赞同：2
> 
> 时间：2013-03-31T18:56:26.457
> 
> 标签：r

我正在尝试为另一个以空格分隔的程序创建输入文件。我将多个列的内容粘贴在一起，当数字具有不同的长度时出现问题，因为在 R 中似乎是默认的右对齐。例如：

```
row_id       monthly_spend
 123            4.55
 567           24.64
 678          123.09 
```

变成：

```
row_id:123 monthly_spend:  4.55
row_id:567 monthly_spend: 24.64
row_id:678 monthly_spend:123.09 
```

而我需要的是：

```
row_id:123 monthly_spend:4.55
row_id:567 monthly_spend:24.64
row_id:678 monthly_spend:123.09 
```

我正在使用的代码来自这个问题[here](https://stackoverflow.com/questions/11940573/r-convert-data-frame-to-input-file-improve-performance)，看起来像这样：

```
paste(row_id, monthly_spend, sep=":", collapse=" ") 
```

我已经尝试将列格式化为数字或整数而没有任何更改。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:06:45.883

如果您将向量放入 data.frame （如果它们还没有），您可以使用：

```
apply(sapply(names(myDF),  function(x)
    paste(x, myDF[, x], sep=":")  ), 1, paste, collapse=" ")

#  [1] "row_id:123 monthly_spend:4.55"  
#  [2] "row_id:567 monthly_spend:24.64" 
#  [3] "row_id:678 monthly_spend:123.09" 
```

或者：

```
do.call(paste, lapply(names(myDF), function(x) paste0(x, ":", myDF[, x]))) 
```

`sprintf`也是一种选择。你有很多方法去做

使用的样本数据：

```
myDF <- read.table(header=TRUE, text=
"row_id       monthly_spend
123            4.55
567           24.64
678          123.09") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:07:46.010

假设数据框被称为 df

```
 write.table(as.data.frame(sapply(1:ncol(df),FUN=function(x)paste(rep(colnames(df)[x],nrow(df)),df[,x],sep=":"))),"someFileName",row.names=FALSE,col.names=FALSE,sep=" "); 
```

相当于以下子步骤：

```
# generating the column separated records
df_cp<-sapply(1:ncol(df),FUN=function(x)paste(rep(colnames(df)[x],nrow(df)),df[,x],sep=":"));
### casting to data frame
df_cp<-as.data.frame(df_cp);
### writing out to disk
write.table(df_cp,"someFileName",row.names=FALSE,col.names=FALSE,sep=" "); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-31T19:09:24.467

使用您的数据片段：

```
df <- read.table(text = "row_id       monthly_spend
 123            4.55
 567           24.64
 678          123.09", header = TRUE) 
```

我们可以`paste`一起使用`format`with 函数`trim = TRUE`来处理你不想要的空间：

```
with(df, paste("row_id:", row_id,
               "monthly_spend:", format(monthly_spend, trim = TRUE))) 
```

这使：

```
> with(df, paste("row_id:", row_id,
+                 "monthly_spend:", format(monthly_spend, trim = TRUE)))
[1] "row_id: 123 monthly_spend: 4.55"   "row_id: 567 monthly_spend: 24.64" 
[3] "row_id: 678 monthly_spend: 123.09" 
```

如果您在写入文件之前需要在数据框中使用它，请使用：

```
newdf <- with(df, data.frame(foo = paste("row_id:", row_id,
                                         "monthly_spend:",
                                         format(monthly_spend, trim = TRUE))))
newdf

> newdf
                                foo
1   row_id: 123 monthly_spend: 4.55
2  row_id: 567 monthly_spend: 24.64
3 row_id: 678 monthly_spend: 123.09 
```

当您将其写出时，列将根据您的需要调整。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-31T19:11:14.873

这是一个通用答案（任意数量的变量），假设您的数据位于 data.frame 中`dat`：

```
x <- mapply(names(dat), dat, FUN = paste, sep = ":")
write.table(x, file = stdout(),
               quote = FALSE, row.names = FALSE, col.names = FALSE) 
```

您可以`stdout()`用文件名替换。

# angularjs - 与 AngularJS 一起使用时，Breeze 是否需要 jQuery？

> ID：15733240
> 
> 赞同：0
> 
> 时间：2013-03-31T18:56:40.290
> 
> 标签：angularjs, breeze

我对使用微风感到困惑。我查看了文档，但没有看到答案。

当我将 Breeze 与 ASP MVC4 和 AngularJS 一起使用时，我是否还需要加载 jQuery 脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T16:47:28.493

**[更新答案 2013 年 10 月 15 日]**

（固定日期）

从 Breeze 1.4.4 开始，我们现在支持使用 $http 的 angular ajax 适配器。有关详细信息，请参阅 1.4.4 发行说明。*所以 JQuery 不再是必需的。*

* * *

Breeze 使用 JQuery 提供其默认的 ajax 支持，独立于 Angular。这是由brief.jquery.ajax 适配器提供的并且是可插入的。这意味着您可以使用 JQuery 或提供替代的 ajax 适配器。Breeze 的 Angular 支持都可以使用。

但是，开箱即用的 JQuery 是必需的。

在接下来的几个月里，我们很可能会提供一个替代的 ajax 适配器，它使用 Angular 的 ajax 实现。请注意，发生这种情况时，无需更改任何代码，除了将微风配置为使用备用适配器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-12T15:33:21.277

如[自定义 AJAX](http://www.breezejs.com/documentation/customizing-ajax)中所述，您可以将 Breeze 配置为使用 Angular 的`$http`服务而不是 jQuery，如下所示：

```
breeze.config.initializeAdapterInstance('ajax', 'angular').setHttp($http); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-05T06:52:46.353

不，只要这样做：

```
breeze.config.initializeAdapterInstance("ajax", "angular"); 
```

# windows-phone-8 - HTML解析单个表格/不是所有数据都被解析？

> ID：15733245
> 
> 赞同：0
> 
> 时间：2013-03-31T18:57:01.460
> 
> 标签：windows-phone-8, html-parsing, html-agility-pack

当谈到 Windows Phone 8 开发时，我相当陌生，我一直在玩弄一些东西作为我正在开发的应用程序的一部分。

现在我正在尝试从诸如 RuneScape 07 高分之类的网站解析信息 - [http://services.runescape.com/m=hiscore_oldschool/hiscorepersonal.ws?user1=zezima](http://services.runescape.com/m=hiscore_oldschool/hiscorepersonal.ws?user1=zezima)

我正在使用 HTML Agility Pack，并且能够解析*一些*数据（直到 Woodcutting），但是通过的任何内容都没有出现？（这取决于我的 ListBox 的大小吗？）

理想情况下，我希望能够单独解析表信息，而不是像这样在一个块中解析：

```
public MainPage()
    {
        InitializeComponent();
        HtmlWeb.LoadAsync("http://services.runescape.com/m=hiscore_oldschool/hiscorepersonal.ws?user1=zezima", DownLoadCompleted);
    }

    void DownLoadCompleted(object sender, HtmlDocumentLoadCompleted e)
    {
        if(e.Error == null)
        {
            HtmlDocument doc = e.Document;
            if (doc != null)
            {
                var result = doc.DocumentNode.SelectNodes("//div[@id='contentHiscores']");
               foreach (var htmlNode in result)
               {
                   lBox.Items.Add(htmlNode.InnerText);
               }
            }
        } 
```

但是如果我尝试访问一个单独的表，比如这个使用

```
var result = doc.DocumentNode.SelectNodes("//div[@id='contentHiscores']/table/tbody/tr[5]/td[2]"); 
```

我得到一个 NullReferenceException。

这是可能的还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T06:32:05.197

您可能依靠 FireBug 或 Chrome 等开发工具来确定您所追求的节点的 XPATH。

你真的不能这样做，因为这些工具给出的 XPATH 对应于内存中的 HTML DOM，而 Html Agility Pack 只知道服务器发回的原始 HTML。

您需要做的是查看发回的内容（或者只是查看源代码）。例如，您会看到没有 TBODY 元素。所以你想找到任何有区别的东西，例如使用[XPATH 轴。](http://www.w3schools.com/xpath/xpath_axes.asp)

这是一个似乎有效的代码：

```
// get all TD nodes with ALIGN attribute set to left
foreach (var node in doc.DocumentNode.SelectNodes("//div[@id='contentHiscores']//td[@align='left']"))
{
    var item = lBox.Items.Add(node.InnerText.Trim());
    // use an 'XPATH axe': get all sibling TD nodes with ALIGN attribute set to 'right'
    foreach (var sibling in node.SelectNodes("following-sibling::td[@align='right']"))
    {
        item.SubItems.Add(sibling.InnerText.Trim());
    }
} 
```

# php - PHP - 检查服务器是否离线并且在 XAMPP 中不显示警告

> ID：15733262
> 
> 赞同：2
> 
> 时间：2013-03-31T18:58:40.107
> 
> 标签：php, xampp, fsockopen

我目前正在使用以下 php 代码检查服务器（在本例中为 192.168.1.135）是否在线：

```
<?php 
$fp = fsockopen("192.168.1.135", 443, $errno, $errstr, 0.4); //(line 47)
if (!$fp) {
  echo "OFFLINE";
}
else{
 echo "ONLINE";
}
?> 
```

我使用 XAMPP 在我自己的服务器 192.168.1.130 上有此代码（当然在 LAN 上）

因此，如果此服务器处于脱机状态，则输出将是：

```
Warning: fsockopen(): in C:\xampp\htdocs\index.php on line 47
OFFLINE 
```

它应该只是“离线”。如何在没有警告的情况下仅显示 OFFLINE？

我认为 XAMPP 会在服务器关闭时向我发送警告。但我应该怎么做才能不显示警告？我在 XAMPP 中找不到此设置，有人知道吗？

如果不是，即使服务器关闭（离线），我应该如何正确处理第 47 行？

当服务器在线时，这将完美地工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-31T19:00:20.107

使用[静默运算符](http://php.net/manual/en/language.operators.errorcontrol.php) `@`来抑制警告：

```
$fp = @fsockopen("192.168.1.135", 443, $errno, $errstr, 0.4); //(line 47) 
```

* * *

旁注：如您所见，`@`操作员按您的要求取消了警告。不过要小心。诸如“没有到主机的路由”之类的消息也将被抑制。（大多数情况下，如果**您的**网络连接不可用）因此您无法确定服务器是否处于脱机状态。`$errmsg`如果`fsockopen()`看不到原因，您应该另外输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:06:13.430

试试这个脚本

```
$fp = fsockopen("192.168.1.135", 443, $errno, $errstr, 0.4);
if (!$fp) {
    echo "$errstr ($errno)<br />\n";
} else {
    $out = "GET / HTTP/1.1\r\n";
    $out .= "Host: 192.168.1.135\r\n";
    $out .= "Connection: Close\r\n\r\n";
    fwrite($fp, $out);
    while (!feof($fp)) {
        echo fgets($fp, 128);
    }
    fclose($fp);
} 
```

# java - 项目的 Swing 与 Web 应用程序 (HTML)

> ID：15733263
> 
> 赞同：2
> 
> 时间：2013-03-31T18:58:43.487
> 
> 标签：java, html, swing, web-applications

我们目前即将开始一个新项目，并正在决定使用哪种技术，有人问我为什么应该选择 HTML 而不是 Swing。

虽然我对 Swing 的范围和经验非常有限，但我提出了以下一些或多或少粗略提及的要点。目前只提到了一个挥杆优势，如果有更多关于 web 应用程序和挥杆优势的点可以添加，我们将不胜感激。

如果有人能验证我提到的点是否正确，如果不正确，应该如何纠正，以及提及可以添加的更多点，那也很棒。

WEBAPP优势

1.  Html 是语义结构化的
2.  使用 HTML（使用 CSS）时可以分离表示层。（据我在 Swing 中看到的 JFrame.setSize 之类的东西被嵌入到代码中，因此没有以任何方式分离）
3.  Swing 仅在桌面 AFAIK 上运行，而 HTML webapp 可以在任何平台上运行，此外还有各种框架允许在需要时将 webapp 创建为可执行文件，例如 APPJS
4.  可能有更多基于 webapp (HTML) 的开发人员，而不是知道什么时候会进行未来维护的开发人员
5.  有大量的框架（主要是 JS），并且更多地支持 webapps 而不是 Swing 应用程序
6.  此外，如果应用程序基于服务器客户端架构，则 Web 应用程序只需部署在一台服务器上
7.  Swing 应用程序需要在客户端计算机上安装 java

摇摆优势

1.  与为 web 应用程序开发此功能相比，Swing 应用程序将能够被编程为离线使用，而开发工作要少得多

请注意，这些只是我提出的一些观点，问题的目的是添加更多观点，以了解我们可能在应用程序中采用哪种技术，而不是哪种技术更优越。

问候， 米琳达

# haskell - GHCi 中的模式匹配

> ID：15733266
> 
> 赞同：10
> 
> 时间：2013-03-31T18:59:23.837
> 
> 标签：haskell

在学校练习

我有这个功能

```
bar :: Float -> Float -> Float
bar x 0 = 0
bar 0 y = 0
bar x y = x * y 
```

我在 GHC 中输入为

```
let bar x 0 = 0; bar 0 y = 0; bar x y = x * y 
```

并评估

```
bar foo 0
bar 0 foo 
```

我被要求修改 bar 以使用 '|' 所以我想做类似的事情：

```
let bar x y = | x 0 = 0 | 0 y = 0 | x y = x * y 
```

但是在ghci中我得到了

```
parse error on input '=' 
```

我怎样才能在 GHCi 中做到这一点？使用模式匹配 ('|') 的事实会改变什么吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-31T19:41:08.873

查看使用守卫的语法：

```
bar x y | x == 0     = 0
        | y == 0     = 0
        | otherwise  = x * y 
```

写在 GHCi 中的一行：

```
let bar x y | x == 0 = 0 | y == 0 = 0 | otherwise = x * y 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-03-31T22:49:25.700

**使用文件**

不要将代码直接输入到 ghci 中，除非它真的是单行代码。

将您的代码保存在名为 PatternMatch.hs 的文本文件中，然后通过键入将其加载到 ghci 中。

```
:l PatternMatch.hs 
```

然后如果您进行更改（并保存），您可以通过键入重新加载 ghci 中的文件

```
:r 
```

或者，您可以在它们所在的练习之后命名您的文件，或者如果它确实是一次性代码，则只需一个可重用的 Temp.hs。

通过将内容保存在文本文件中，您可以更轻松地对其进行编辑和重用。

**模块**

稍后您将使用适当的模块将相关功能收集在一起，以便将它们导入其他程序。例如，你可以有

```
module UsefulStuff where

pamf = flip fmap 
```

保存在一个名为 UsefulStuff.hs 的文件中，然后保存在另一个文件中，您可以

```
import UsefulStuff 
```

然后使用 UsefulStuff 那里的功能。

模块对于你现在正在做的事情来说太过分了，但是获得编辑、保存、重新编译、测试、重复的工作流程，你会省去很多努力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-24T03:10:48.030

`:set +m`GHCi 允许通过输入解释器进行多行输入。有关详细信息，请参阅[多行输入部分](https://downloads.haskell.org/%7Eghc/7.4.1/docs/html/users_guide/interactive-evaluation.html#ghci-multiline)。

这是一个演示它的示例：

```
GHCi, version 8.8.3: https://www.haskell.org/ghc/  :? for help
Prelude> :set +m
Prelude> { incList [] = []
Prelude| ; incList (x:xs) = x+1:incList xs
Prelude| }
Prelude> incList [40, 41, 42]
[41,42,43]
Prelude> 
```

# android - Android：意图解析并确保 BroadcastReceiver 已注册/确实接收

> ID：15733283
> 
> 赞同：2
> 
> 时间：2013-03-31T19:01:03.127
> 
> 标签：android, android-intent, broadcastreceiver, intentfilter

基于复选框首选项，我启用了一堆接收器并向他们广播，以便他们为自己安排一堆警报。 **编辑：**接收器都设置警报并等待来自 AlarmManager 的广播（从`onReceive`发布的内容中可以清楚地看出）。

### 设置活动

```
@Override
public boolean onPreferenceChange(Preference preference, Object newValue) {
    if (newValue instanceof Boolean) {
        boolean enable = (Boolean) newValue;
        Monitor.enableMonitoring(getApplicationContext(), enable);
        return true;
    }
    return false;
} 
```

### Monitor.enableMonitoring

```
public static void enableMonitoring(Context ctx, boolean enable) {
    Resources resources = ctx.getResources();
    CharSequence ac_setup_alarm = resources
            .getText(R.string.intent_action_setup_alarm);
    CharSequence ac_cancel_alarm = resources
            .getText(R.string.intent_action_cancel_alarm);
    // if only I could do the above in a static way someclass once and for all
    Intent i = new Intent("" + (enable ? ac_setup_alarm : ac_cancel_alarm));
    if (enable) {
        Log.d(_tag, "enable receivers / setup alarms int : " + i);
        _enableDisableReceivers(ctx, enable); // enable == true
        ctx.sendBroadcast(i);
    } else {
        Log.d(_tag, "cancel alarms / disable receivers int : " + i);
        ctx.sendBroadcast(i);
        _enableDisableReceivers(ctx, enable); // enable != true (will disable)
    }
} 
```

### 问题

1.  为什么

    `Intent i = new Intent("" + (enable ? ac_setup_alarm : ac_cancel_alarm));`不会收到

    `Intent i = new Intent("" + (enable ? ac_setup_alarm : ac_cancel_alarm), Uri.EMPTY, ctx, BatteryMonitoringReceiver.class);`会按预期收到吗？
    显现 ：

    ```
    <receiver
        android:name="di.k23b.hw3.receivers.BatteryMonitoringReceiver"
        android:enabled="false" >
        <intent-filter>
            <action android:name="@string/intent_action_setup_alarm" />
            <action android:name="@string/intent_action_cancel_alarm" />
            <action android:name="@string/intent_action_monitor" />
        </intent-filter>
    </receiver> 
    ```

    我希望隐式意图传播到注册的接收者 - 为什么我必须使这些隐式意图显式？我希望这很容易回答 - 我只是忽略了/没有在文档中得到一些东西:)

2.  `_enableDisableReceivers(ctx, true);`在我广播 Intent 之前，我是否需要确保调用实际上会启用接收器？`_enableDisableReceivers(ctx, false);`同样，在我调用禁用接收器之前，我是否必须等到收到意图？如果是，我应该怎么做？

3.  （我得到的第一个答案[是奖励）不能将 LocalBroadcastManager 与 AlarmaManager 一起使用](https://stackoverflow.com/q/12113103/281545)- 使用引导接收器？（我觉得不是）

为了完整性：

```
private static void _enableDisableReceivers(Context ctx, boolean enable) {
    Log.d(_tag, "enable/disable receivers");
    for (Class<? extends BaseReceiver> receiver : RECEIVERS)
        BaseReceiver.enable(ctx, enable, receiver);
} 
```

在哪里 ：

```
public static void enable(Context context, boolean enable,
        Class<? extends BaseReceiver> receiver) {
    PackageManager pacman = context.getPackageManager();
    final ComponentName componentName = new ComponentName(context, receiver);
    Log.d(_tag, componentName.toString());
    final int state = (enable) ? PackageManager.COMPONENT_ENABLED_STATE_ENABLED
            : PackageManager.COMPONENT_ENABLED_STATE_DISABLED;
    pacman.setComponentEnabledSetting(componentName, state,
            PackageManager.DONT_KILL_APP);
    Log.d(_tag,
            "pacman :" + pacman.getComponentEnabledSetting(componentName));
} 
```

对于令人难以置信的完整性（BaseMonitoringReceiver）：

```
@Override
final public void onReceive(Context context, Intent intent) {
    // FIXME : possible NPE below ?
    final String action = intent.getAction(); // can intent==null ?
    Log.w(TAG, "" + action);
    resources = context.getResources();
    ac_setup_alarm = resources.getText(R.string.intent_action_setup_alarm);
    ac_cancel_alarm = resources
            .getText(R.string.intent_action_cancel_alarm);
    ac_monitor = resources.getText(R.string.intent_action_monitor);
    if (ac_setup_alarm.equals(action) || ac_cancel_alarm.equals(action)) {
        monitoringIntent = new Intent(context, this.getClass());
        monitoringIntent.setPackage(RECEIVERS_PACKAGE_NAME);// TODO: needed?
        final boolean enable = ac_setup_alarm.equals(action);
        setupAlarm(context, enable);
    } else if (ac_monitor.equals(action)) {
        // monitoring - got broadcast from ALARM
        Class<? extends WakefulIntentService> serviceClass = getService();
        WakefulIntentService.sendWakefulWork(context, serviceClass);
    } else {
        Log.w(TAG, "Received bogus intent : " + intent);
        return;
    }
} 
```

子类（如`BatteryMonitoringReceiver`清单中的）只是覆盖`getService()`- 整洁不？通知`onReceive`为最终通知。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T01:32:54.750

这不是一个答案 - 只是想问一些不适合评论的问题。

你在做什么——只是让一个接收器足够长的时间来发送一个意图——对我来说看起来很不寻常。你确定那是你想做的吗？我习惯于为系统意图启用/禁用接收器，而不是为自定义意图启用/禁用接收器。

关于 Q#2，为什么会出现尝试减少启用接收器的窗口的问题？为什么在发送意图之前不启用接收器，然后在收到意图之后才禁用它？

我假设所有这些都发生在同一个过程中——听起来就是这样。而且，如果是这样的话，为什么还要在清单中声明你的接收者呢？您还可以考虑切换到 LocalBroadcastManager。

编辑：

问题 3。您怀疑无法将 LBM 与警报管理器一起使用。看到[这个帖子](https://stackoverflow.com/questions/12113103/can-i-use-alarmmanager-with-localbroadcastmanager-on-android)。

# mvvm - 使用 MVVM 和 Caliburn.Micro 显示 MessageDialog

> ID：15733284
> 
> 赞同：1
> 
> 时间：2013-03-31T19:01:12.650
> 
> 标签：mvvm, windows-8, windows-store-apps, caliburn.micro

如果视图中的某些字段在单击按钮进行导航时为空白，我需要向用户显示 MessageDialog。我可以很好地处理来自视图模型的输入字段验证，我只是不确定如何从视图模型调用 messagedialgo.showasync 方法并将其显示在视图上。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T07:49:08.080

我看到了 Caliburn.Micro 的示例和库源。`IWindowManager`接口仅适用于 WPF 和 Silverlight。对于 WinRT，示例包含此帮助程序类。

```
using System;
using Windows.UI.Popups;

namespace Caliburn.Micro.WinRT.Sample.Results
{
    public class MessageDialogResult : ResultBase
    {
        private readonly string _content;
        private readonly string _title;

        public MessageDialogResult(string content, string title)
        {
            _content = content;
            _title = title;
        }

        public async override void Execute(ActionExecutionContext context)
        {
            var dialog = new MessageDialog(_content, _title);

            await dialog.ShowAsync();

            OnCompleted();
        }
    }
} 
```

可以像这样从视图模型中调用它

`new MessageDialogResult("content", "title");`

请参阅 CodePlex 上的代码

[CoroutineViewModel.cs](http://caliburnmicro.codeplex.com/SourceControl/changeset/view/ae616b84192450d079cf8b6fb91f0d8b8cda4e6a#samples/Caliburn.Micro.HelloWinRT/Caliburn.Micro.HelloWinRT/ViewModels/CoroutineViewModel.cs)

[MessageDialogResult.cs](http://caliburnmicro.codeplex.com/SourceControl/changeset/view/ae616b84192450d079cf8b6fb91f0d8b8cda4e6a#samples/Caliburn.Micro.HelloWinRT/Caliburn.Micro.HelloWinRT/Results/MessageDialogResult.cs)

# android - Android 自定义 gui 组件？

> ID：15733285
> 
> 赞同：0
> 
> 时间：2013-03-31T19:01:29.207
> 
> 标签：android, android-library, android-gui

我正在寻找一个 android gui 库，其中包含更多可以在我的应用程序中使用的组件。

例子：

微控制器将电机的转速（通过蓝牙）发送到我的智能手机。我想使用我的智能手机在类似进度条的元素中显示收到的 rpm。但是正常的进度条看起来很难看，我必须要progressbar.setClickable(false); .

正如我之前所说，我正在搜索具有更多 gui 元素的库（可选：我可以自己修改、自定义外观）

你们中有人知道这样的图书馆吗？

感谢到目前为止。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T21:56:54.097

If you're just concerned about the external appearance of your GUI elements, I don't think there's any support for *different* UI elements than the ones provided. However, have you looked into a universal [`Theme` and style for your application](http://developer.android.com/guide/topics/ui/themes.html)?

Here are some excerpts from that document:

> A style is a collection of properties that specify the look and format for a View or window. A style can specify properties such as height, padding, font color, font size, background color, and much more. A style is defined in an XML resource that is separate from the XML that specifies the layout.
> 
> A theme is a style applied to an entire Activity or application, rather than an individual View (as in the example above). When a style is applied as a theme, every View in the Activity or application will apply each style property that it supports. For example, you can apply the same CodeFont style as a theme for an Activity and then all text inside that Activity will have green monospace font.

Here are some resources which talk about themes:

*   [Mobile Orchard Article](http://mobileorchard.com/android-app-development-using-themes-and-styles-in-android/)
*   [Android Engineer Article](http://www.androidengineer.com/2010/06/using-themes-in-android-applications.html)

Let me know if that's what you wanted. Themes give you almost *infinite possibilities* to modify outwards appearance.

# c++ - 模板的复制构造函数

> ID：15733288
> 
> 赞同：0
> 
> 时间：2013-03-31T19:01:59.303
> 
> 标签：c++, templates, g++, copy-constructor

复制构造函数在以下代码中失败。为了清楚起见，我已经剪掉了代码

```
#include <iostream>
#include <stdio.h>
#include <assert.h>

namespace my {
    template <class T>
    class Sptr {
    private:
        //some kind of pointer
            //one to current obj
        T* obj;
.
.
.
    public:
.
.
.

        Sptr(const Sptr &);

        template <typename U> 
        Sptr(const Sptr<U> &);

.
.
.
};//Class ends

    template <typename T>
    template <typename U> 
    Sptr<T>::Sptr(U* u) {
        //do something
    }

    template <typename T>
    Sptr<T>::Sptr(const Sptr<T> &copyObj) {
        //do copy constructor stuff
    }
.
.
.
}

using namespace std;
using namespace my;
/* Basic Tests 1 ================================================================================ */
size_t AllocatedSpace;

class Base1 {
    protected:
        Base1() : derived_destructor_called(false) {
            printf("Base1::Base1()\n");
        }
    private:
        Base1(const Base1 &); // Disallow.
        Base1 &operator=(const Base1 &); // Disallow.
    public:
        virtual ~Base1() {
            printf("Base1::~Base1()\n");
            assert(derived_destructor_called);
        }
    protected:
        bool derived_destructor_called;
};

class Derived : public Base1 {
        friend void basic_tests_1();
    private:
        Derived() {}
        Derived(const Derived &); // Disallow.
        Derived &operator=(const Derived &); // Disallow.
    public:
        ~Derived() {
            printf("Derived::~Derived()\n");
            derived_destructor_called = true;
        }
        int value;
}; 
```

此测试代码行产生错误`Sptr<Base1> sp3(sp);`

```
void basic_tests_1() {

    //size_t base = AllocatedSpace;

    // Test deleting through original class.
    {
        // Base1 assigned from Sptr<Derived>.
        {
            Sptr<Base1> sp2;
            {
                Sptr<Derived> sp(new Derived);
                // Test template copy constructor.
                Sptr<Base1> sp3(sp);
                sp2 = sp;
                sp2 = sp2;
            }
        }
    }
} 
```

错误：

```
/tmp/ccKrn1xG.o: In function `basic_tests_1()':
Sptr.cpp:(.text+0x81): undefined reference to `my::Sptr<Base1>::Sptr<Derived>(my::Sptr<Derived> const&)'
collect2: error: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T19:14:00.333

你已经在类中声明了这个构造函数：

```
 template <typename U> 
    Sptr(const Sptr<U> &); 
```

但是您没有显示定义。错误消息说您从未定义过它。我的猜测是错误信息是正确的。尝试修复它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:14:22.903

您没有所需构造函数的定义，只有声明：

```
 template <typename U> 
    Sptr(const Sptr<U> &); 
```

您需要在类定义中内联或在外部定义它，如下所示：

```
template <typename T>
template <typename U> 
Sptr<T>::Sptr(const Sptr<U> &u) {
    // do something
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T19:15:47.763

难道不应该

> ```
> template <typename T>
> template <typename U> 
> Sptr<T>::Sptr(const U& u) {
>     //do something
> } 
> ```

代替

> ```
> template <typename T>
> template <typename U> 
> Sptr<T>::Sptr(U* u) {
>     //do something
> } 
> ```

# prolog - 数的因数

> ID：15733290
> 
> 赞同：4
> 
> 时间：2013-03-31T19:02:07.873
> 
> 标签：prolog, factors

所以我对 Prolog 比较陌生，虽然这个问题在许多其他语言中很容易，但我遇到了很多麻烦。我想为数字 N 生成一个因子列表。我已经建立了一个谓词，告诉我一个数字是否是一个因子：

```
% A divides B
% A is a factor of B
divides(A,B) :- A =\= 0, (B mod A) =:= 0.

% special case where 1 // 2 would be 0
factors(1,[1]) :- !.

% general case
factors(N,L):- N > 0, factor_list(1, N, L).
factor_list(S,E,L) :- S =< E // 2, f_list(S,E,L).

f_list(S,E,[])    :- S > E // 2, !.
f_list(S,E,[S|T]) :- divides(S,E), !, S1 is S+1, f_list(S1, E, T).
f_list(S,E,L)     :- S1 is S+1, f_list(S1,E,L). 
```

任何帮助，将不胜感激。

**编辑**

我几乎改变了我的整个解决方案，但由于某种原因`factors(9, [1])`，当我只想返回 true 时，谓词如 return `factors(9, [1,3])`true。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:24:04.157

原因`factors(9,[1])`如下：尝试实例化（即统一）的时机已关闭：

```
f_list(S,E,[])    :- S > E // 2, !.
f_list(S,E,[S|T]) :- divides(S,E), !, S1 is S+1, f_list(S1, E, T).
f_list(S,E,L)     :- S1 is S+1, f_list(S1,E,L).

%%  flist(1,9,[1]) -> (2nd clause) divides(1,9), S1 is 2, f_list(2,9,[]).
%%  flist(2,9,[])  -> (3rd clause) S1 is 3, f_list(3,9,[]).
%% ... 
%%  flist(5,9,[])  -> (1st clause) 5 > 9 // 2, !. 
```

因为您预先指定`[1]`了 ，所以当它达到 3 时，尾部是`[]`并且与第二个子句的匹配由此被阻止，尽管它*会*由于 . 而成功`divides/2`。

解决方案是将统一从子句的头部移到正文中，并且仅在适当的时间而不是更早地进行：

```
f_list(S,E,L) :- S > E // 2, !, L=[].
f_list(S,E,L) :- divides(S,E), !, L=[S|T], S1 is S+1, f_list(S1, E, T).
f_list(S,E,L) :- S1 is S+1, f_list(S1,E,L). 
```

上面通常是用 if-else 结构编写的：

```
f_list(S,E,L) :- 
  ( S > E // 2   -> L=[]
  ; divides(S,E) -> L=[S|T], S1 is S+1, f_list(S1, E, T)
  ;                          S1 is S+1, f_list(S1, E, L)
  ). 
```

您也可以将主要谓词简化为

```
%% is not defined for N =< 0
factors(N,L):- 
  (  N =:= 1 -> L=[1]
  ;  N >= 2  -> f_list(1,N,L) 
  ). 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-07T23:10:14.950

就个人而言，我使用了一个看起来更简单的解决方案：

```
factors(1,[1]):- true, !.
factors(X,[Factor1|T]):- X > 0,
 between(2,X,Factor1), 
 NewX is X // Factor1, (X mod Factor1) =:= 0,
 factors(NewX,T), !. 
```

这个只接受一个有序的因素列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-20T15:25:06.920

这是一个简单的基于枚举的过程。

```
factors(M, [1 | L]):- factors(M, 2, L).
factors(M, X, L):- 
   residue(M, X, M1), 
   ((M==M1, L=L1); (M1 < M, L=[X|L1])),
   ((M1=1, L1=[]); (M1 > X, X1 is X+1, factors(M1, X1, L1))).

residue(M, X, M1):-
  ((M < X, M1=M);
   (M >=X, MX is M mod X, 
     (MX=0, MM is M/X, residue(MM, X, M1);
      MX > 0, M1=M))). 
```

# django - Django：用另一个表单替换表单字段

> ID：15733291
> 
> 赞同：0
> 
> 时间：2013-03-31T19:02:17.320
> 
> 标签：django, django-forms

有没有一种简单的方法可以用另一个表单替换 Django 中的表单字段？具体来说，我在两个模型之间存在一对一的关系，如果我可以定义一个字段以实际定义为另一种形式，那就太好了，如下所示：

```
class FirstModelForm(forms.ModelForm):
    class Meta:
        model = FirstModel

class SecondModelForm(forms.ModelForm):
    second = forms.InnerForm(form=FirstModelForm)
    class Meta:
        model = SecondModel 
```

有任何想法吗？还是我应该自己编写并提交给 Django 代码库？;-)

# asp.net - EntityKey 属性只能在属性的当前值为 null 时使用 n 层 Web 应用程序设置

> ID：15733292
> 
> 赞同：1
> 
> 时间：2013-03-31T19:02:25.693
> 
> 标签：asp.net, entity-framework

我正在使用带有 ObjectDataSource 的实体框架的 n 层 Web 应用程序。在我的 Web 应用程序中，存在具有多对一或零关系的 Complains & WorkOrder 实体。

添加 WorkOrder 后，用户可以选择针对哪个投诉。这就是我试图做的。

```
<asp:DetailsView ID="DVComplain" runat="server" 
        DefaultMode="Insert" AutoGenerateInsertButton="True" 
        AutoGenerateRows="False" DataSourceID="ODSAddWorkOrder" 
        oniteminserting="DetailsView1_ItemInserting" >
        <Fields>
            <asp:TemplateField HeaderText="Complain">
               <InsertItemTemplate>
                   <asp:DropDownList ID="DDLComplain" runat="server" DataTextField="ComplainID" 
                       DataValueField="ComplainID" DataSourceID="EDSComplains" 
                       oninit="DDLComplain_Init">
                   </asp:DropDownList>
                   <asp:CheckBox ID="CBIsWOOfComplain" runat="server" 
                       oninit="CBIsWOOfComplain_Init" />
                   <asp:EntityDataSource ID="EDSComplains" runat="server" 
                       ConnectionString="name=MMEntities" DefaultContainerName="MMEntities" 
                       EnableFlattening="False" EntitySetName="ComplainMasters" 
                       EntityTypeFilter="ComplainMaster" Select="it.[ComplainID]" OrderBy="it.ComplainID">
                   </asp:EntityDataSource>
               </InsertItemTemplate>
            </asp:TemplateField>
            <asp:BoundField HeaderText="WOGeneratedDate" DataField="WOGeneratedDate" DataFormatString="yyyy-MM-dd" />
            .......
        </Fields>
    </asp:DetailsView>

   <asp:ObjectDataSource ID="ODSAddWorkOrder" runat="server"
        DataObjectTypeName="MiantenanceManager.DAL.WorkOrder" TypeName="MiantenanceManager.BLL.WorkOrderBL"
        InsertMethod="addWorkOrder">
    </asp:ObjectDataSource> 
```

并将以下代码添加到 DetailView ItemInserting 方法中。

```
 protected void DVWorkOrder_ItemInserting(object sender, DetailsViewInsertEventArgs e)
            {
                if (_CBIsWOOfComplain.Checked)
                {
                    using (complainBL)
                    {                    
                        e.Values["Complain"] = complainBL.getComplianByID(_DDLComplains.SelectedValue);
                    }
                }
            } 
```

注意：complainBL 实现了 IDispose。在 WorkOrederBL 调用中，它调用 WorkOrderRepository 类，该类调用以下方法，该方法引发主题中提到的异常。

context.WorkOrder.AddObject(workOrder); context.SaveChanges();

我该如何克服这个问题。我的方法错了吗？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:36:25.220

您收到此错误的原因是 AddObject 用于添加新对象。具有实体键的对象表示数据库中的现有行。这假设您正在为您的表使用数据库生成的密钥。

有不同的方法可以修复它，例如：

*   选项 1：从数据库中获取记录，更新该记录上的字段，然后保存更改。
*   选项 2：使用实体键创建一个新对象，将其附加到已修改状态的上下文中，然后保存更改。

# css - 为什么负右边距不起作用？

> ID：15733294
> 
> 赞同：39
> 
> 时间：2013-03-31T19:02:28.053
> 
> 标签：css

既然元素`margin-left: -10px`的边缘与它的父元素的边缘相交，为什么不会发生同样的情况`margin-right: -10px`呢？

[例子](http://jsfiddle.net/c9ZHr/1/)

```
div {
  background: red;
  width: 200px;
  height: 100px;
}

p {
  background: blue;
  width: 100%;
}

.left {
  margin-left: -10px;
}

.right {
  margin-right: -10px;
}
```

```
<div>
  <p class="left">Hello</p>
</div>
<div>
  <p class="right">Hello</p>
</div>
```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-04-01T00:15:14.250

好消息是**负利润确实有效**！

要查看工作中的负边距，请考虑以下代码片段：

```
.wrapper {
  outline: 1px solid blue;
  padding: 40px;
}

.content {
  outline: 1px solid red;
  background-color: #D8D8D8;
}

.content p {
  outline: 1px dotted blue;
  background-color: rgba(255, 255, 0, 0.3);
  margin: 0 0 0 0;
  text-align: justify;
}

.content p.lefty {
  margin-left: -20px;
}

.content p.righty {
  margin-right: -20px;
}
```

```
<div class="wrapper">
  <div class="content">
    <p>Lorem ipsum dolor sit amet, ...</p>
    <p class="lefty">Sed ipsum ante, dictum vel rhoncus id, ...</p>
    <p class="righty">Curabitur aliquam tristique mattis...</p>
  </div>
</div>
```

我将`outline`'s 添加到所有`div`'s 和`p`'s 以显示内容框的扩展。

第一段的边距为零，我将一段向左偏移，另一段向右偏移。

如果您有足够的内容来填充段落的宽度（或者如果您显示大纲），您将看到文本框在框外流动`content`。您还可以从段落中看到`outline`文本确实向左和向右延伸。

但是，要看到右边的效果，您需要足够的内容来填充段落的整个宽度，或者您需要在子元素上设置背景颜色或轮廓。

如果您开始固定宽度和高度，在 上`content`，您将看到其他效果，例如在 外面流动的段落`content`。

研究这个简单的代码结构说明了 CSS 盒子模型的许多方面，花一些时间研究它是很有启发性的。

小提琴参考：http: [//jsfiddle.net/audetwebdesign/2SKjM/](http://jsfiddle.net/audetwebdesign/2SKjM/)

如果从 中删除填充`wrapper`，您可能不会注意到右边距偏移，因为元素将扩展到填充父容器的整个宽度或页面宽度，具体取决于 HTML/CSS 的具体细节。

**为什么我的例子没有显示效果！！！？？？**

在您的示例中，您没有看到效果，因为您`p`通过指定 固定了元素的宽度`width: 100%`，这指示段落采用父容器的宽度（在您的示例中为 200px）。

`100%`如果您对宽度从to进行简单更改`auto`：

```
p {
    background: blue;
    width: auto;
} 
```

你会看到你的第二段就在你预期的右边。

**注意：Outline vs Border** 另外，请注意红色框是由于`outline`，它将文本框包含在 中`content`，即使文本框延伸到父 ( `content`) 元素之外也是如此。结果，`outline`框可以比`border`相应元素的框大得多。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-31T19:05:28.647

这是因为默认情况下元素的布局是从左到右而不是从右到左。当你正确时`float`，你会看到相反的效果。`<p>`

[jsFiddle](http://jsfiddle.net/Tyriar/Ctn7r/2/)

```
.right {
    margin-right: -10px;
    float:right;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-01T04:26:59.150

简单地说，只需更改此 css ：

```
p {
    background: blue;
    width: 100%;
} 
```

至：

```
p {
    background: blue;
    display: block;
} 
```

这里的演示：http: [//jsfiddle.net/pVKNz/](http://jsfiddle.net/pVKNz/)

如果你想制作类似的移动元素，请使用这个 css：

```
.left {
    margin-left: -10px;
    margin-right:10px;
}

.right {
    margin-right: -10px;
    margin-left:10px;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-30T07:52:58.917

如果有人想给flex box负边距，

请考虑**justify-content: space-between。**

**HTML**

```
<div class="parent">
  <div class="child">  
  </div>
  <div class="child negative-margin">
  </div>
</div> 
```

**CSS**

```
.parent {
  box-sizing: border-box;
  /* please concentrate on flex, space-between */
  display: flex;
  justify-content: space-between;
  background-color: blue;
  width: 500px;
  height: 200px;
  border: 5px solid red;
}
.child {
  box-sizing: border-box;
  display: inline-block;
  width: 50%;
  background-color: yellow;
}
.negative-margin {
  background-color: cyan;
  margin-right: -250px;
} 
```

# c# - XNA - Mouse.Left Button 在更新中多次执行

> ID：15733298
> 
> 赞同：7
> 
> 时间：2013-03-31T19:02:46.570
> 
> 标签：c#, input, xna, xna-4.0

我正在制作井字游戏。我需要检查玩家是否点击了他们已经点击过的方块。

问题是第一次点击本身显示错误。我的更新代码是：

```
 MouseState mouse = Mouse.GetState();
    int x, y;
    int go = 0;
    if (mouse.LeftButton == ButtonState.Pressed)
    {
        showerror = 0;
        gamestate = 1;
        x = mouse.X;
        y = mouse.Y;
        int getx = x / squaresize;
        int gety = y / squaresize;
        for (int i = 0; i < 3; i++)
        {
            if (go == 1)
            {
                break;
            }
            for (int j = 0; j < 3; j++)
            {
                if (getx == i && gety == j)
                {
                    if (storex[i, j] == 0)
                    {
                       showerror = 1;
                    }
                    go = 1;
                    if (showerror != 1)
                    {
                        loc = i;
                        loc2 = j;
                        storex[i, j] = 0;
                        break;
                    }
                }
            }
        }
    } 
```

`showerror`每当单击左键时设置为 0。我的矩阵是用于存储信息的 3x3 矩阵。如果它是 0 意味着它已经被点击了。所以在循环中我检查是否`store[i,j] == 0`设置`showerror`为 1。现在在绘图函数中我调用了 showerror

```
spriteBatch.Begin();
if (showerror == 1)
{
    spriteBatch.Draw(invalid, new Rectangle(25, 280, 105, 19), Color.White);                                        
}
spriteBatch.End(); 
```

问题是每当我点击空白方块时，它会变成十字但会显示错误。请帮帮我

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-31T22:05:28.857

**怎么修：**

添加一个新的全局变量来存储前一帧的鼠标状态：

```
MouseState oldMouseState; 
```

在更新方法的最开始（或结束）处，添加以下内容，

```
oldMouseState = mouse; 
```

并更换

```
if (mouse.LeftButton == ButtonState.Pressed) 
```

和

```
if (mouse.LeftButton == ButtonState.Pressed && oldMouseState.LeftButton == ButtonState.Released) 
```

它的作用是检查您是否单击了一次，然后释放键然后按下，因为有时您可能会按住键多个帧。

**回顾一下：**

通过`oldMouseState`在更新之前设置`currentMouseState`（或者在你完成之后），你保证`oldMouseState`将落后一帧`currentMouseState`。使用它，您可以检查按钮是否在前一帧中，但不再是，并相应地处理输入。扩展它的一个好主意是编写一些扩展方法，如`IsHolding()`,`IsClicking()`等。

在简单的代码中：

```
private MouseState oldMouseState, currentMouseState;
protected override void Update(GameTime gameTime)
{
     oldMouseState = currentMouseState;
     currentMouseState = Mouse.GetState();
     //TODO: Update your code here
} 
```

# php - 在我的 php 页面上禁用重新加载和 f5

> ID：15733302
> 
> 赞同：5
> 
> 时间：2013-03-31T19:03:10.487
> 
> 标签：php, javascript, jquery, timer

我在我的 php 页面上使用了一个计时器，但是当一些刷新页面时，计时器从开始开始。我想在我的 php 页面上禁用 f5 或重新加载选项。

提前致谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-09-23T14:30:37.917

我测试它并且它有效。

```
function disable_f5(e)
{
  if ((e.which || e.keyCode) == 116)
  {
      e.preventDefault();
  }
}

$(document).ready(function(){
    $(document).bind("keydown", disable_f5);    
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-31T19:07:45.400

做不到——这种行为是由最终用户控制的，这是正确的！

您可以做的最接近的事情是在窗口关闭或刷新时显示警告，用户可以决定注意您的警告并坚持当前页面，或者忽略您的请求并关闭/刷新。

请参阅此处：[浏览器窗口意外关闭时发出警报](https://stackoverflow.com/questions/1244535/alert-when-browser-window-closed-accidentally)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-31T19:07:21.047

无法禁用此类浏览器功能。如果某个页面禁用了您的 F5 键，您愿意吗？我对此表示怀疑。如果您尝试在这里实现某种安全性，我建议您查看适当的服务器端验证方法。

# android - android中多个DPI和SIZE屏幕的布局

> ID：15733303
> 
> 赞同：0
> 
> 时间：2013-03-31T19:03:15.197
> 
> 标签：android

我如何在 res 库中为不同的屏幕（DPI 和 SIZE）引用布局？

我可以在 re 文件夹中执行此操作吗：

```
layout-mdpi-xlarge
layout-mdpi-normal
layout-xhdpi-large 
```

等等...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:10:29.307

[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

您可以通过详细浏览链接找到问题的答案。

**请参阅使用配置限定符**下的主题，尤其是表 1 下的部分。

```
res/layout/my_layout.xml             // layout for normal screen size ("default")
res/layout-small/my_layout.xml       // layout for small screen size
res/layout-large/my_layout.xml       // layout for large screen size
res/layout-xlarge/my_layout.xml      // layout for extra large screen size
res/layout-xlarge-land/my_layout.xml // layout for extra large in landscape orientation 
```

对于可绘制对象。

```
 res/drawable-mdpi/my_icon.png        // bitmap for medium density
 res/drawable-hdpi/my_icon.png        // bitmap for high density
 res/drawable-xhdpi/my_icon.png       // bitmap for extra high density 
```

# lightbox2 - 灯箱工作正常但不显示滚动条

> ID：15733304
> 
> 赞同：0
> 
> 时间：2013-03-31T19:03:17.170
> 
> 标签：lightbox2

我正在使用`lightbox2`，但它在打开时隐藏了我的页面滚动条，关闭滚动条后它保持隐藏。我已经检查了css，如果我的博客有问题，请告诉我。

我已经尝试了所有浏览器，但所有浏览器都发生了同样的情况。

[链接到我的页面有问题，你可以检查这个...2](http://beautiesfromworld.blogspot.in/2013/03/amazing-aquarium.html)

请帮帮我。。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:50:25.413

更改您的 css .. 每当您单击名为 CSS_LIGHTBOX_FIXED_FRAME 的图像类时，已将其添加到 html 标记中，并且该类具有以下 css

```
html.CSS_LIGHTBOX_FIXED_FRAME {
height: 100%;
margin: 0;
overflow: hidden !important;
width: 100%;
} 
```

从上方删除溢出：隐藏部分，您将返回滚动条

# macos - iTerm2：删除行？

> ID：15733312
> 
> 赞同：113
> 
> 时间：2013-03-31T19:03:52.183
> 
> 标签：macos, terminal, iterm2

我正在尝试将（退格）映射到**iTerm2**`⌘+Delete`中的行首（就像它在浏览器和文本编辑器中一样），但我无法找到它的工作转义码。我根据我[在 Wikipedia](http://en.wikipedia.org/wiki/ANSI_escape_code)中阅读的内容尝试了 1K( ) 。它只是打印一个“K”。**`^[1K`**

 **编辑：我发现`Ctrl+U`. 现在来了解如何映射它。也许十六进制代码 21（U 是第 21 个字母），所以 0x15？

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2013-03-31T19:31:51.647

我得到了它。我不知道为什么 iTerm2 中的十六进制代码映射会产生相关的 Ctrl+键映射，但确实如此。也不知道 0x00 是什么意思，因为它没有像预期的那样分配给 A。（尽管我确实相信 Unix 有自己的处理空字节的约定——例如，我们`xargs`接受了空字节分隔格式`find`——如果我们可以将它绑定到 iTerm2 的热键，那就太好了）

我能够发现 Ctrl+U 几乎可以完成我想要的任务（它会删除整行而不是只删除光标之前的内容，但是无论如何...... Ctrl+Y 作为奖励可以将其全部恢复）。然后我好奇地看到我有十六进制代码`0x1`并分别`0x5`映射到`^A`和`^E`，对于我的 Cmd+Left 和 Cmd+Right... 所以`0x15`是`^U`！

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2018-12-05T05:58:02.163

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2015-09-01T20:29:26.180

将十六进制代码映射`0x15`到`⌘</kbd> + `←Delete` in most shells deletes the entire line (content to the left and right of the cursor). While sometimes not as compatible, I find that mapping:`

`⌘</kbd>+`←Delete` to Send Hex Codes:`

`0x18 0x7f`

执行所需的功能。如果您正在运行 ZSH，您可能还需要将其添加到您的 .zshrc 文件中：

```
$ echo 'bindkey "^X\\x7f" backward-kill-line' >> ~/.zshrc 
```

默认情况下，ZSH 不会映射`backward-kill-line`到任何东西。

此外，您还可以通过映射删除光标右侧的所有内容：

`⌘</kbd>+`fn`+`←Delete` or `⌘</kbd>+`Delete→</kbd> to Send Hex Codes:```

`0x0b`

**[我在这里](https://stackoverflow.com/questions/6205157/iterm2-how-to-get-jump-to-beginning-end-of-line-in-bash-shell/29403520#29403520)写了一份综合指南，将 OSX 的大部分标准键绑定添加到您的终端**

* * *

## 回答 #4

> 赞同：48
> 
> 时间：2018-09-09T17:05:54.780

在 OSX 中，⌥+⌫ 和⌘+⌫ 分别是删除一个单词和删除一行的快捷键。⌘+ ← 和 ⌘+ → 用于转到行的开头和结尾。默认情况下，iTerm2不是这样配置的，网上有很多误导性的指南。以下是我发现在我的机器上工作的内容。

1.  打开首选项 (⌘+,) 并转到“键”选项卡。
2.  添加一个全局快捷键，然后输入你的快捷键
3.  在操作下拉列表中，选择发送十六进制代码

十六进制代码...

1.  删除一个字：0x17。
2.  删除一行：0x15。
3.  移动到行首：0x01。
4.  移动到行尾：0x05。只需打开一个新选项卡，它应该可以工作！

为了清楚起见，这是一个屏幕截图： ![替代文字](https://coderwall-assets-0.s3.amazonaws.com/uploads/picture/file/2677/Screen_Shot_2014-03-01_at_3.08.41_PM.png "iterm2 键")

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2013-06-19T14:36:48.787

我希望[这](https://felipecsl.com/2012/06/05/protip-delete-words-on-iterm2-mac-osx.html)可以帮助你

地图⌥ <-删除以发送十六进制代码：0x1B 0x08

我已经测试过了，它是正确的。

* * *

18.09.2013 更新

这删除了一个单词，而不是一行。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-12-17T17:47:35.813

正如所指出的那样`^U`删除该行。您可以使用[Better Touch Tool](http://www.bettertouchtool.net/)轻松地重新映射命令。

它还具有很酷的自动化、鼠标、键盘和键盘映射功能。还包括智能边框的窗口功能。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-12-12T21:38:50.790

On iTerm2 you can set the exact same shortcuts of your OS. In this case, as the default shortcut to delete a line on Mac OS is `⌘+Delete` (backspace), you can do so.

To set the default keybindings of iTerm you have to:

1.  Go to Preferences (or `⌘+,`)
2.  Profiles
3.  Keys
4.  Key Mappings
5.  Presets...
6.  Select the "Natural text editing" option**

# c# - SQLException: 无效的列名

> ID：15733314
> 
> 赞同：3
> 
> 时间：2013-03-31T19:03:54.003
> 
> 标签：c#, sql, entity-framework

我最近使用 EF Reverse Engineer Code First 将现有数据库转换为代码。在完善了大部分结果之后，我开始编写测试。我目前遇到的错误是尝试访问名为“Element_ElementCode”的列名，但是不存在这样的列。
为了确定这一点，我对我的整个项目进行了搜索，以避免意外声明它的可能性。

```
Find all "Element_ElementCode", Subfolders, Find Results 1, Entire Solution, ""
Matching lines: 0    Matching files: 0    Total files searched: 120 
```

确切的错误如下：

```
System.Data.SqlClient.SqlException: Invalid column name 'Element_ElementCode'. 
```

无效的列名“Element_ElementCode”重复了 10-15 次，并且堆栈跟踪没有提供任何线索。

当执行包含检索数据并对其执行一些断言的表达式的测试时，会发生此异常。

```
var doos = (dbContext.Elementen.Where(d => d.ElementCode == "DOOS9001")).FirstOrDefault(); 
```

这是 SQL Server 本身的查询结果： ![在此处输入图像描述](https://i.stack.imgur.com/1WsM2.jpg)

`Element`（内部`Element.cs`）具有以下字段：

```
ElementCode
Doelgroep
Type
Omschrijving
Titel 
```

元素映射如下：

```
public class ElementenMap : EntityTypeConfiguration<Element> {
        public ElementenMap() {

            // Primary Key
            this.HasKey(t => t.ElementCode);

            // Properties
            this.Property(t => t.ElementCode)
                .IsRequired()
                .HasMaxLength(255);

            this.Property(t => t.Type)
                .HasMaxLength(31);

            this.Property(t => t.Doelgroep)
                .HasMaxLength(255);

            this.Property(t => t.Omschrijving)
                .HasMaxLength(255);

            this.Property(t => t.Titel)
                .HasMaxLength(255);

            // Table & Column Mappings
            this.ToTable("Elementen");
            this.Property(t => t.ElementCode).HasColumnName("ElementCode");
            this.Property(t => t.Type).HasColumnName("Type");
            this.Property(t => t.Doelgroep).HasColumnName("Doelgroep");
            this.Property(t => t.Omschrijving).HasColumnName("Omschrijving");
            this.Property(t => t.Titel).HasColumnName("Titel");

            // Relationships
            this.HasMany(t => t.Kernwoorden)
                .WithRequired(t => t.Element)
                .Map(m => m.ToTable("Kernwoorden"));
        }
    } 
```

此外：我确定该数据库已被访问，因为对同一数据库内不同表的其他测试成功。

我试图提供尽可能多的相关信息，如果我忘记了来源，请告诉我。为什么它试图访问名为 的列`Element_ElementCode`？这可能是我忘记关闭的约定（我已经不得不关闭 PluralizingTableNameConvention）？

我应该寻找什么方向？

编辑：

**克恩伍德.cs**

```
public class Kernwoord {
        public string ElementCode { get; set; }

        public string KernwoordString { get; set; }

        public virtual Element Element { get; set; }
    } 
```

**元素.cs**

```
public partial class Element {
        public Element() {
            this.LeertrajectElementen = new List<LeertrajectElement>();
            this.Kernwoorden = new List<Kernwoord>();
        }

        public string ElementCode { get; set; }

        public string Type { get; set; }

        public string Doelgroep { get; set; }

        public string Omschrijving { get; set; }

        public string Titel { get; set; }

        public virtual Casus Casus { get; set; }

        public virtual Document Document { get; set; }

        public virtual Doos Doos { get; set; }

        public virtual ICollection<LeertrajectElement> LeertrajectElementen { get; set; }

        public virtual StellingenSpel StellingenSpel { get; set; }

        public virtual ICollection<Kernwoord> Kernwoorden { get; set; }
    } 
```

**LeertrajectElementenMap.cs 片段：**

```
 this.HasRequired(t => t.Element)
     .WithMany(t => t.LeertrajectElementen)
     .HasForeignKey(d => d.ElementCode); 
```

编辑：

通过修复现有的继承问题解决了该问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T19:34:48.347

您没有指定关系的外键列名称。它应该是：

```
this.HasMany(t => t.Kernwoorden)
    .WithRequired(t => t.Element)
    .Map(m => m.MapKey("ElementCode")); // FK column name in Kernwoorden table 
```

或者，如果您在类中有外键*属性* ：`ElementCode``Kernwoorden`

```
this.HasMany(t => t.Kernwoorden)
    .WithRequired(t => t.Element)
    .HasForeignKey(t => t.ElementCode); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T19:26:53.840

关于类型有一个约定。

例如，如果您有一个客户，而该客户只有一个地址，并且该地址有一个邮政编码。

然后它将生成一个带有字段 Adress_Postcode 的表 Customer。

在您的情况下，您的类名和表名不同，因此它将元素类型放入表 Elementen。

# c - Linux 上的精确进程间计时器

> ID：15733316
> 
> 赞同：4
> 
> 时间：2013-03-31T19:04:09.873
> 
> 标签：c, linux, gcc, system-clock

我想测量发送方进程和消费者之间的*ping时间。*
两个进程都在同一个物理主机上运行，​​Linux 64 位。

我目前正在使用`clock_gettime(CLOCK_REALTIME, &cur_ts);`. 我基本上捕获当前时间戳`cur_ts`并将其发送到消费者进程；一旦在另一端收到它，我就会`clock_gettime(CLOCK_REALTIME, &cur_ts);`在第二个过程中再次调用并减去两次。

此过程是否准确测量两个进程之间的*ping ？*我应该使用不同的东西吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T19:20:53.473

### 是的

您正在使用正确的界面。这是现代 Loonix 中可用的 Posix 指定的 HRT（高分辨率计时器），您使用的是规范标准。

对于 ping 分辨率，它可能无关紧要，但可以`CLOCK_MONOTONIC,`特别用于短时间间隔。在其他条件下，`CLOCK_REALTIME`可能更准确。但是，这些时钟的确切含义并没有被 Posix 指定，而且在 Linux 上，我相信它们都会受到 NTP 调整的影响。至少对于长时间的间隔来说，这是一件好事。

在 Linux 上，要在不调整 NTP 的情况下访问底层硬件时钟，您必须取消 Posix 保留并使用`CLOCK_MONOTONIC_RAW.`

[http://pubs.opengroup.org/onlinepubs/9699919799/functions/clock_gettime.html](http://pubs.opengroup.org/onlinepubs/9699919799/functions/clock_gettime.html)

# interface - 用于远程客户端的 Intellij Idea EJB 库

> ID：15733317
> 
> 赞同：2
> 
> 时间：2013-03-31T19:04:10.800
> 
> 标签：interface, intellij-idea, ejb

如何为远程客户端创建带有远程接口（例如会话 Bean）的 jar。我尝试使用工件进行实验，但在工件中 - 我可以创建 jar 并包含带有 bean 类和接口的整个输出目录。- 或包含将在没有包目录的 jar 根目录中的接口文件我想做的很简单，在本教程中的 Netbeans [https://netbeans.org/kb/docs/javaee/entappclient.html](https://netbeans.org/kb/docs/javaee/entappclient.html)在“创建 Java类库”章节。请帮我在 Idea 中为远程客户端创建 jar。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T11:39:02.670

您可以使用工件编辑器中“输出布局”树中的“创建目录”按钮在 jar 中创建所需的包，然后将“n”类文件拖放到该包中。但是，最好将需要打包到 jar 中的类提取到单独的模块中，并将该模块作为一个整体添加到工件中。这样，您可以确保这些类没有 jar 中未包含的依赖项，并且还可以在构建工件时指示 IDEA 编译这些类。请注意，提取模块并不意味着您需要将这些类物理移动到单独的目录中。如果所有这些类都位于单个包下，您可以创建一个模块，其源根指向相应的包并指定“包前缀”

# javascript - Javascript 在生成的 HTML 中，但没有一个 javascript 工作

> ID：15733318
> 
> 赞同：1
> 
> 时间：2013-03-31T19:04:11.613
> 
> 标签：javascript, ruby-on-rails

我在一个 rails 3.2 应用程序中，我正在使用 gem for skroller [https://github.com/Prinzhorn/skrollr](https://github.com/Prinzhorn/skrollr)

我的 application.js 需要 skroller

```
//= require jquery-1.9.1.min
//= require jquery_ujs
//= require jquery.numeric
//= require skrollr 
```

...我生成的 html 包含预期的 javascript

```
<script src="/assets/skrollr.js?body=1" type="text/javascript"></script> 
```

gem 应该允许您使用 html5 标签来创建一些滚动效果，他们给出的示例是

```
 <div data-0="background-color:rgb(255,0,0);" data-500="background-color:rgb(0,0,255);">
      WOOOT
    </div> 
```

我将它放在视图中进行测试，但即使生成了正确的脚本，它也无法正常工作，我不知道为什么

我的假设是，既然它正在生成，那么它与我如何设置视图或 application.js 无关......寻求任何帮助，谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T19:21:18.613

您需要告诉 skrollr 进行自我初始化。

添加

```
<script type="text/javascript">
$(function() {
    skrollr.init();
});
</script> 
```

加载外部文件后的某个地方。

这里也有许多可供您选择的选项。见：[https ://github.com/Prinzhorn/skrollr#skrollrinitoptions](https://github.com/Prinzhorn/skrollr#skrollrinitoptions)

# java - 没有 gl_LightSource[0] 的照明

> ID：15733319
> 
> 赞同：0
> 
> 时间：2013-03-31T19:04:13.520
> 
> 标签：java, opengl, graphics, glsl, lwjgl

`gl_LightSource[0].position.xyz`写入时相当于什么`GLSL`？换句话说，我将如何采用`vec3`（或`vec4`）`GLSL`并对其应用 OpenGL 适用的相同转换`gl_LightSource[0].position`？有`mat4`我可以用的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T19:09:57.770

你可以做任何你喜欢的事情。这就是着色器的好处。为自己定义一套描述灯光的制服。它的位置可以在您想要的任何空间中，您只需要以某种方式应用正确的转换即可。

着色器都是关于自由选择的，你可以做任何最适合你的事情。固定功能 OpenGL 在眼睛/视图空间中进行照明计算，即在模型视图变换之后。为此，它会在您调用`glLightfv(GL_LIGHT…, GL_POSITION, …)`. 然后在绘制几何图形时，在应用模型视图变换之后，在视图空间中执行光照计算。

# c# - 找不到通过 Activator 创建的对象类型

> ID：15733321
> 
> 赞同：1
> 
> 时间：2013-03-31T19:04:24.670
> 
> 标签：c#, dynamic

我使用以下语法创建了一个对象：

```
var newMessage = Activator.CreateInstance(client.Key); 
```

它似乎创建了一个正确类型的对象并允许设置对象属性。但是，当我将对象传递给带有签名的方法时：

```
public void Publish<T>(T messageBody) 
```

T 定义的 Type 是 object。

我该如何解决这个问题？我无法更改方法签名 - 它来自库 - 我需要能够在运行时创建对象而不事先知道它们的类型。

**更新**

我尝试执行的功能与发送（发布）消息有关。通常我会注册一个消息处理程序，例如：

```
RegisterHandler<MyMessage> (m => do something with message ); 
```

然后可以打电话

```
Publish<MyMessage> (message) 
```

最终将在处理程序处结束。这很酷并且工作正常。

我想要做的是插入一个中介作为交换并将消息发布到多个处理程序。我知道我可以使用其他东西来为我做这件事，例如 RabbitMQ，但我希望能够通过对当前代码进行小的修改来实现它。

所以我有一个注册订阅的方法：

```
 public virtual void registerSubscription<T1,T2>()
    {
        if (handlerMap.ContainsKey(typeof(T2)))
        {
            throw new ArgumentException("Message handler has already been registered for type: " +typeof(T2).Name);
        }
        if (!handlerMap.ContainsValue(typeof(T1)))
        {                              
            mqHost.RegisterHandler<T1> (m => distributeMessage(m) );
        }
        handlerMap[typeof(T2)] = typeof(T1);
    } 
```

我用两个类调用该方法，一个基类和一个继承基类的类：

```
public class MyMessage
{
    public string name {get;set;}
}

public class MyMessage2:MyMessage{} 
```

这一点效果很好，我得到了一张处理程序的地图。当我做下一点，distributeMessage 方法时，问题就来了。

```
var match = handlerMap.Where(i => i.Value == message.Body.GetType());
foreach (var client in match)
{
    var newMessage = Activator.CreateInstance(client.Key);
    newMessage.PopulateWith(message.Body);                
    messageProducer.Publish(createMessage(newMessage));                
} 
```

messageProducer.publish 具有签名：

```
public void Publish<T>(T messageBody) 
```

我不能（轻松）修改它 - 它是图书馆的一部分。我可以调用另一种方法：

```
public void Publish<T>(IMessage<T> message) 
```

但我看不出这会更容易，因为我必须创建一个仍然需要 .

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-31T20:00:47.363

给定调用 Activator 时知道的类型信息，您可以使用一些反射来尝试创建 Publish 的通用方法。如果我误解了您要执行的操作，请询问，我可以修改此代码。

```
object newObject = Activator.CreateInstance(myType);

var publishMethod = typeof(MessageProducer).GetMethod("Publish");
var publishMethodWithCorrectType = publishMethod.MakeGenericMethod(new Type[] { myType });

publishMethodWithCorrectType.Invoke(messageProducer, new object[]{newObject}); 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:06:23.553

尝试这样做：

```
var newMessage = (MyType)Activator.CreateInstance(client.Key); 
```

ps MyType 是基本类型或接口...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T19:15:54.660

您还需要`Publish<T>`通过反射调用该方法才能继续沿着这条路线前进。

另一个建议是`class`根据类型使对象的类通用`client.Key`，然后在该类中实现 Publish 方法 - 实现将知道是什么`T`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-31T20:00:44.973

找到另一个问题的[答案](https://stackoverflow.com/a/420969/1804544)

并实现了这个：

```
 typeof(MessageExchange)
   .GetMethod("createMessage",BindingFlags.Static | BindingFlags.NonPublic)
   .MakeGenericMethod(newMessage.GetType())
   .Invoke(null, new object[] { newMessage }); 
```

我现在得到了正确的类型。

# scala - 防御函数、不变量、最小噪声

> ID：15733323
> 
> 赞同：2
> 
> 时间：2013-03-31T19:04:35.487
> 
> 标签：scala, scalaz

我喜欢使用`require`, `assert`,`assume`和 ensure 来记录给定函数的前置条件和后置条件，但我也开始`scalaz.Validation`主要用于执行需要执行的检查。但是，最近，我对使用`PartialFunction`（可能与`Validation`）来记录前置条件最感兴趣。就像是：

```
case class Summary(user: String, at: DateTime, ....)

val restricted_add: PartialFunction[(Summary, Summary), Summary] = {
  case (s1: Summary, s2: Summary) if s1.user != s2.user && s1.at == s2.at =>    

} 
```

具有用于捕获匹配错误并将其转换为验证失败的实用程序功能（例如`restricted_add.lift(_).toSucess("Cannot add.")`）。不知何故，上面的 case 子句似乎没有`For`with嘈杂`scalaz.Validation`。但我觉得我在反对这种语言。我没有使用`def`'s 自然语法来定义参数，这样一个函数的每个客户端在调用它时都必须使用一个实用函数，我将捕获异常并将它们转换为验证，而不是仅使用验证或仅使用例外。

通过代码记录这些前提条件的最不嘈杂、最实用的方法是什么？`Validation`返回函数、`require`语句`PartialFunction`、其他...？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T08:37:10.500

正如@RandallSchulz 已经说过的，在代码中隐式记录先决条件仅适用于您的私有/内部方法，而不适用于您的公共 API。如果您正在编写公共方法，您还应该记录方法文档中的先决条件，也许还有使用示例，如果它们违反直觉的话。

* * *

话虽如此，在我看来，Scala 中**噪音最小**和**功能最强大**的方式并不相同。这是因为`require` [不能被认为是功能性](https://stackoverflow.com/questions/10703232/why-is-the-raising-of-an-exception-a-side-effect)的，因为如果不满足条件，它会抛出异常，这将在某处被捕获，从而更改控制流并因此产生副作用。

尽管如此，我认为这`require`是迄今为止指定先决条件的最不嘈杂的方式：

```
def non_func(x:Int, y:Int):Int = {
    require(x >= 0 && y >= 0)
    x + y
} 
```

我不完全确定检查先决条件的最实用方法，但我认为使用模式匹配并返回一个`Option`可以被认为是功能性的，但比`require`：

```
def func(x:Int, y:Int):Option[Int] = (x,y) match {
    case (x, y) if x >= 0 && y >= 0 => Some(x + y)
    case _ => None
} 
```

使用 Option 的好处是你可以[对那个狗屎](https://stackoverflow.com/questions/8559537/where-does-the-flatmap-that-s-idiomatic-expression-in-scala-come-from) （scnr）进行平面映射：

```
val xs = List((1,2), (0,0), (-1,0), (-1,-1), (3,4))
xs.flatMap(x => func(x._1, x._2)) # => List(3, 0, 7) 
```

单独的可能是一个足够好的理由来添加更多的噪音，`require`因为它使您能够更简洁地使用许多标准 Scala 库。

关于偏函数，您基本上是在回答您自己的问题，因为您说使用和定义它更麻烦。不过，我对 Scalaz 没有任何经验，因此我无法将“纯 scala”方法与任何人可能使用 Scalaz 做的任何事情进行比较。

# wpf - 流文档和数据绑定

> ID：15733324
> 
> 赞同：0
> 
> 时间：2013-03-31T19:04:53.407
> 
> 标签：wpf, data-binding, flowdocument

在彻底阅读有关 flowdocuments 的文档（在 WPF 中）之后，似乎 flowdocument 不容易支持数据绑定。请说这不是真的！我有一个使用 Expression Blend 中的示例数据的列表框，并将一个文本块插入到流文档中。文本块（文本属性）被数据绑定到列表框中的字符串数据。运行项目后，我希望文本块文本随着列表框选择的变化而变化，但没有任何反应。数据绑定不起作用。使数据绑定与 flowdocument 一起工作的最简单方法是什么？

这是 XAML。

```
<Window
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
x:Class="WpfApplication1.MainWindow"
x:Name="Window"
Title="MainWindow"
Width="640" Height="480">
<Window.Resources>
    <DataTemplate x:Key="ItemTemplate">
        <StackPanel>
            <TextBlock Text="{Binding Property1}"/>
            </StackPanel>
    </DataTemplate>
</Window.Resources>

<Grid x:Name="LayoutRoot" DataContext="{Binding Source={StaticResource SampleDataSource}}">
    <FlowDocumentScrollViewer Margin="120,64,256,126">
        <FlowDocument>
            <Paragraph><Run Text="Only A Test"/><InlineUIContainer>
                    <TextBlock TextWrapping="Wrap" Text="{Binding Collection[0].Property1}" Height="56" Width="112"/>
                </InlineUIContainer></Paragraph>
        </FlowDocument>
    </FlowDocumentScrollViewer>
    <ListBox ItemTemplate="{DynamicResource ItemTemplate}" ItemsSource="{Binding Collection}" Margin="0,83.847,52,62.153" HorizontalAlignment="Right" Width="200"/>
</Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-07-28T08:58:50.190

根据2009 年 4 月的[Microsoft 文档](https://msdn.microsoft.com/en-us/magazine/dd569761.aspx)，这是不可能的：

> 虽然流文档有很多很棒的特性，但是如果您的文档是从动态数据生成的，那么您就有一个问题：流文档中不支持数据绑定。流文档元素（Section、Table、Run、Paragraph 等）是依赖对象，但不定义任何允许您动态更改或生成内容的依赖属性。

# solr - 将与 jboss 的连接限制为某些 IP 地址

> ID：15733327
> 
> 赞同：2
> 
> 时间：2013-03-31T19:05:23.833
> 
> 标签：solr, jboss, jboss7.x, solr4, jboss-eap-6

我们在我们的应用程序中使用 Apache Solr 来提供搜索功能。我们正在将 solr.war 文件与我们的应用程序一起部署到 jboss。然而，现在每个人都可以从 jboss_host/solr URL 访问 solr。

我们如何防止 /solr/ 被所有 IP 地址访问？我们希望限制某些 IP 地址，即 jboss_host 和其他几个管理 API 主机。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T14:54:16.060

你可以使用过滤器：

```
org.apache.catalina.filters.RemoteAddrFilter 
```

像这样：

```
<filter>
  <filter-name>Remote Address Filter</filter-name>
  <filter-class>org.apache.catalina.filters.RemoteAddrFilter</filter-class>
  <init-param>
    <param-name>allow</param-name>
    <param-value>127\.\d+\.\d+\.\d+|::1|0:0:0:0:0:0:0:1</param-value>
  </init-param>
</filter>
<filter-mapping>
  <filter-name>Remote Address Filter</filter-name>
  <url-pattern>/*</url-pattern>
</filter-mapping> 
```

# android - 在 TextView 中设置 Roboto 字体 - xml

> ID：15733341
> 
> 赞同：17
> 
> 时间：2013-03-31T19:06:38.180
> 
> 标签：android, textview

我找到了几篇关于这个主题的帖子，但是所有这些主题要么`setTypeFace()`在对象上使用方法设置字体，要么创建一个将字体设置为和`TextView`的自定义类。据我从 API-Level 11(?) 或其他方面了解，我们可以通过某种方式将 TypeFace 设置为 xml 属性。像这样：`Roboto``extends` `TextView`

```
 <TextView
      android:id="@+id/profileHeader"
      android:layout_width="100dp"
      android:layout_height="100dp"
      android:typeface="roboto"
      android:text="Hello, world">
   </TextView> 
```

这样做的正确方法是什么？如果应用程序在低于 API 级别 11（？）的设备上运行，是否可以进行回退，例如：

```
 android:typeface="roboto|monospace|serif" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-09-27T18:35:41.190

看看[RobotoTextView](https://github.com/johnkil/Android-RobotoTextView)项目。适用于 Android 1.5，您可以使用 XML 属性设置字体。它还包括其他视图，如 RobotoButton、RobotoCheckbox 等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-13T10:43:42.667

我没有看到可以将外部字体定义为 xml 属性的方法。您应该将字体存储在资产中并调用：

```
tv.setTypeface( Typeface.createFromAsset( context.getAssets(), roboto.ttf ) ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-02T12:57:22.313

您不能直接从这样的资产中设置字体，您必须在 onCreate 中执行以下操作。这将使您想做同样的事情。

```
TextView tvTextView = (TextView) findViewById(R.id.textView1);
Typeface typeface = Typeface.createFromAsset(getAssets(),"Roboto.ttf");
tvTextView.setTypeface(typeface); 
```

希望对你有所帮助。:D

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-28T13:05:37.817

该`android:typeface`属性只有几个有效选项（根据 Android 文档）...

*   普通的
*   无
*   衬线
*   等宽

如果您需要在旧设备的应用程序中使用 Roboto 字体，则需要将 Roboto TTF 文件包含到您的项目中。

使用这些字体最明显的方法是使用`setTypeface()`TextView 的方法，但如果您想改为在 XML 中指定它，则必须创建自定义 TextView 并为自定义 TextView 创建自己的 styleable 属性。

[这个话题遍布整个互联网](http://www.google.com/search?btnG=1&pws=0&q=android+custom+typeface+xml)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-27T18:05:09.007

对于 JellyBean (4.1) 及更高版本，您可以使用[此 StackOverflow 主题](https://stackoverflow.com/questions/12128331/how-to-change-fontfamily-of-textview-in-android)中提供的方法。它将优雅地回退到旧设备中的 sans。如果您必须回退到等宽或衬线，请声明一个文件夹 layout-v16，您在其中使用您选择的字体，即“sans-serif-condensed”，并在默认文件夹中使用“monospace”或“serif”字体。如果您想回退到非默认字体，您可以通过编程方式检查 android 版本并选择适当的操作，即：

```
if (Build.VERSION.SDK_INT <= Build.VERSION_CODES.ICE_CREAM_SANDWICH_MR1) {
    TextView textView = (TextView) findViewById(R.id.textView_id);
    Typeface myFont = Typeface.createFromAsset(getAssets(),"RobotoCondensed.ttf");
    textView.setTypeface(myFont);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-02-14T16:17:14.813

这是为将来遇到与我相同的问题的人准备的。在加载多行时，设置字体往往会占用大量内存。将以下两个代码一起使用，实际上可以使其顺利运行。我从 stackoverflow 得到了解决方案，但他们的答案没有一起列出。

```
public class RobotoTextView extends TextView {

Context context;

public RobotoTextView(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
    this.context = context;
}

public RobotoTextView(Context context, AttributeSet attrs) {
    super(context, attrs);
    this.context = context;
}

public RobotoTextView(Context context) {
    super(context);
    this.context = context;
}

public void setTypeface(Typeface tf, int style) {
    if (!isInEditMode()) {
        if (style == Typeface.NORMAL) {
            super.setTypeface(TypeFaceProvider.getTypeFace(getContext(), "fonts/Roboto-Light.ttf"));
        } else if (style == Typeface.ITALIC) {
            super.setTypeface(TypeFaceProvider.getTypeFace(getContext(), "fonts/Roboto-LightItalic.ttf"));
        } else if (style == Typeface.BOLD) {
            super.setTypeface(TypeFaceProvider.getTypeFace(getContext(), "fonts/Roboto-Bold.ttf"));
        } else if (style == Typeface.BOLD_ITALIC) {
            super.setTypeface(TypeFaceProvider.getTypeFace(getContext(), "fonts/Roboto-BoldItalic.ttf"));
        }

    }
}

public class TypeFaceProvider {

private static Hashtable<String, Typeface> sTypeFaces = new Hashtable<String, Typeface>(
        4);

public static Typeface getTypeFace(Context context, String fileName) {
    Typeface tempTypeface = sTypeFaces.get(fileName);

    if (tempTypeface == null) {
        tempTypeface = Typeface.createFromAsset(context.getAssets(),
                fileName);
        sTypeFaces.put(fileName, tempTypeface);
    }

    return tempTypeface;
}
} 
```

# styles - 哪种大括号样式更好？

> ID：15733344
> 
> 赞同：-1
> 
> 时间：2013-03-31T19:06:44.400
> 
> 标签：styles, braces

我有点困惑哪种牙套样式更好？
这个？

```
if ( a > b)  
{  
    c = d;  
} 
```

还是这个？

```
if ( a > b) {  
    c = d;  
} 
```

我使用第一种是因为我认为它易于阅读，但我发现似乎很多专家（或经验丰富的程序员）喜欢使用第二种风格，第二种看起来更专业（不是吗？）。我知道这两种风格都可以，但在您看来，哪一种更适合程序员？你的理由？十分感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T19:09:25.177

做任何适合你的事情，除非你在一个团队中编程。在这种情况下，请遵循您都同意的任何编码风格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:09:18.017

我个人使用第二个，但大多数 IDE 的自动格式化程序将使用第一个。但这只是很小的区别...我怀疑有人会真正关心。

# javascript - 在特定点插入字符但保留标签？

> ID：15733349
> 
> 赞同：7
> 
> 时间：2013-03-31T19:07:09.507
> 
> 标签：javascript, jquery

## 更新#2

好的，接下来会进行更多测试。当我使用人造垫片时，看起来代码工作正常，但正则表达式最终失败。具体来说，以下场景有效：

1.  `a`选择标签上方或下方的单词
2.  `a`您只选择标签正上方或正下方的一行
3.  `a`您在标签上方/下方选择了多行
4.  `a`您在任何标签下方选择了多行

以下场景不起作用：

3.  您选择标签上方的行/多行，然后选择标签`a`下方的行/多行`a`

当它“不起作用”时会发生什么，它会`a`从 DOM 中删除标签间隔。这可能是正则表达式的问题......

**基本上**`a`，当您选择标签周围的文本时，它会失败。

* * *

## 更新：

我不需要将每一行包装在一个`p`标签中，我可以使用一个内联元素，例如一个`a`、、`span`或`label`标签，`display:inline-block`以及一个高度 + 宽度作为一个新的行元素 ( `<br />`)。这应该使修改代码更容易，因为唯一需要更改的部分是我在边界之间获取文本的位置。我应该只需要更改那部分 ,`selectedText.textContent`来检索也在边界内的 HTML，而不仅仅是文本。

* * *

我正在创建一个要求用户选择文本的 Phonegap。但是，我需要对文本选择进行精细控制，并且不能再将整个文本内容放入`pre`样式`p`标记中。相反，我需要用类似的东西来表示一个换行符`<a class="space"></a>`，以便可以准确地突出显示正确的单词。当我的文字看起来像这样时：

```
<p class="text">This is line one

Line two

Line three
</p> 
```

还有`.text{ white-space:pre-wrap }`，下面的代码允许我选择单词，然后用`span`元素包裹文本以显示文本被突出显示：

```
$("p").on("copy", highlight);

function highlight() {
    var text = window.getSelection().toString();
    var selection = window.getSelection().getRangeAt(0);
    var selectedText = selection.extractContents();
    var span = $("<span class='highlight'>" + selectedText.textContent + "</span>");
    selection.insertNode(span[0]);
    if (selectedText.childNodes[1] != undefined) {
        $(selectedText.childNodes[1]).remove();
    }
    var txt = $('.text').html();
    $('.text').html(txt.replace(/<\/span>(?:\s)*<span class="highlight">/g, ''));
    $(".output ul").html("");
    $(".text .highlight").each(function () {
        $(".output ul").append("<li>" + $(this).text() + "</li>");
    });
    clearSelection();
}

function clearSelection() {
    if (document.selection) {
        document.selection.empty();
    } else if (window.getSelection) {
        window.getSelection().removeAllRanges();
    }
} 
```

此代码运行良好，但在每行由间隔标记分隔时就不行了。新文本如下所示：

```
<p class="text">
    Line one
    <a class="space"></a>
    Line two
    <a class="space"></a>
    Line three
</p> 
```

当我修改上面的代码以使用由 表示的新行时`<a class="space"></a>`，代码失败。它只检索选择的文本，而不是 HTML ( `selectedText.textContent`)。我不确定正则表达式是否也会因`a`元素充当新行而失败。该`a`元素可以是`span`or`label`或任何通常内联定位的元素，以欺骗 iOS 允许我选择字母而不是块元素。

无论如何要更改代码以保留新的行元素？

## jsFiddle：http: [//jsfiddle.net/charlescarver/39TZ9/3/](http://jsfiddle.net/charlescarver/39TZ9/2/)

### 所需的输出应如下所示：

如果突出显示文本“第一行”：

```
<p class="text">
    <span class="highlight">Line one</span>
    <a class="space"></a>
    Line two
    <a class="space"></a>
    Line three
</p> 
```

如果突出显示文本“第一行第二行”：

```
<p class="text">
    <span class="highlight">Line one
    <a class="space"></a>
    Line two</span>
    <a class="space"></a>
    Line three
</p> 
```

当然，不同的部分和单个字母也可以并且将被突出显示，而不是整行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T22:19:06.523

这是一个支持您要求的所有功能的解决方案：

**HTML**：

```
<p class="text">
    First Line
    <a class="space"></a>
    <a class="space"></a>
    Second Line
    <span class="space"></span>
    Third Line
    <label class="space"></label>
    Forth Line
</p>
<ul class="output"></ul> 
```

**CSS**：

```
.space {
    display: inline-block;
    width: 100%;
}
.highlighting {
    background-color: green;
} 
```

**JavaScript**：

```
var text,
    output,
    unwrapContents,
    mergeElements,
    clearSelection,
    clearHighlighting,
    mergeHighlighting,
    handleCopy;

unwrapContents = function unwrapContents(element) {
    while(element.firstChild !== null) {
        element.parentNode.insertBefore(element.firstChild, element);
    }
    element.parentNode.removeChild(element);
};

mergeElements = function mergeElements(startElement, endElement) {
    var currentElement;
    endElement = endElement.nextSibling;
    while((currentElement = startElement.nextSibling) !== endElement) {
        startElement.appendChild(currentElement);
    }
};

clearSelection = function clearSelection() {
    if (document.selection) {
        document.selection.empty();
    } else if (window.getSelection) {
        window.getSelection().removeAllRanges();
    }
};

clearHighlighting = function clearHighlighting(target, exception) {
    $('.highlighting', target).each(function(index, highlighting) {
        if(highlighting !== exception) {
            unwrapContents(highlighting);
        }
    });
    target.normalize();
};

mergeHighlighting = function mergeHighlighting() {
    var i, j;
    // Remove internal highlights
    $('.highlighting', text).filter(function() {
        return this.parentNode.className === 'highlighting';
    }).each(function(index, highlighting) {
        unwrapContents(highlighting);
    });
    text.normalize();
    // Merge adjacent highlights
    first:
    for(i=0; i<text.childNodes.length-1; i++) {
        if(text.childNodes[i].className === 'highlighting') {
            for(j=i+1; j<text.childNodes.length; j++) {
                if(text.childNodes[j].className === 'highlighting') {
                    mergeElements(text.childNodes[i], text.childNodes[j--]);
                    unwrapContents(text.childNodes[i].lastChild);
                } else {
                    switch(text.childNodes[j].nodeType) {
                        case 1:
                            if(text.childNodes[j].className !== 'space') {
                                continue first;
                            }
                            break;
                        case 3:
                            if(text.childNodes[j].textContent.trim() !== '') {
                                continue first;
                            }
                            break;
                    }
                }
            }
        }
    }
};

handleCopy = function handleCopy() {
    var range,
        highlighting,
        item;

    // Highlighting
    range = window.getSelection().getRangeAt(0);
    highlighting = document.createElement('span');
    highlighting.className = 'highlighting';
    highlighting.appendChild(range.cloneContents());
    range.deleteContents();
    range.insertNode(highlighting);

    // Output
    item = document.createElement('li');
    item.innerHTML = highlighting.innerHTML;
    clearHighlighting(item);
    output.appendChild(item);

    // Cleanup
    mergeHighlighting();
    clearSelection();
};

$(function(){
    text = $('.text')[0];
    output = $('.output')[0];
    $(text).on('copy', handleCopy);
}); 
```

这是一个工作示例[http://jsbin.com/efohit/3/edit](http://jsbin.com/efohit/3/edit)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-03T05:57:48.687

好吧，我想出了*一个*解决方案，也很简单。

如果`.text`看起来像这样：

```
<p class="text">Line one
<a class="space"></a>Line two
<a class="space"></a>Line three</p> 
```

使用上面的确切标记和换行符，我可以找到每个`\n`并用间隔元素替换它。

```
if (textStr.indexOf("\n") >= 0) {
    textStr = textStr.replace(/\n/g, "\n<a class='space'></a>");
} 
```

这根本不是通用的，如果有多个换行符，如果标签不同等都会失败。所以，我鼓励任何有更好方法的人回答这个问题！不可能那么难，我想通了。

# ios - 在 usertrackingmodefollowwithheading (iOS 6) 中显示随地图旋转的指南针图像

> ID：15733350
> 
> 赞同：2
> 
> 时间：2013-03-31T19:07:09.867
> 
> 标签：ios, rotation, mkmapview, compass-geolocation, heading

在 Apple 的 Maps 应用程序中，当`UserTrackingModeFollowWithHeading`启用时，会有一个指南针图像显示南北方向，并随着地图的旋转而旋转。我已`UserTrackingModeFollowWithHeading`在我的应用程序中启用，并且还想显示这样的指南针图像。

我试图添加一个`UIImageView`带有指南针图像的子视图，`MKMapView`但图像不随地图旋转。有没有办法让它随着地图的旋转而旋转？

我知道我可以使用 UpdatedHeading 手动旋转地图并使用地图旋转指南针图像。这行得通。但我宁愿使用 Apple 的 UserTrackingModeFollowWithHeading。我尝试一起使用`UserTrackingModeFollowWithHeading`and `UpdatedHeading`（我在 UpdatedHeading 中手动旋转指南针图像）但这会导致问题；由于同时使用这两个功能的一些冲突，应用程序在一分钟左右后崩溃。

非常感谢您的帮助。我正在使用 Monotouch 6.2（但可以在提供给 Monotouch 的响应中翻译任何 Objective C 代码）。

# python - 如何写入文本文件中的特定行

> ID：15733363
> 
> 赞同：0
> 
> 时间：2013-03-31T19:08:29.043
> 
> 标签：python, file-io, text-files

我希望我不会重新发布（我之前做过研究），但我需要一点帮助。

所以我会尽可能地解释这个问题。

我有一个文本文件，在其中我有这种格式的信息：

```
a 10
b 11
c 12 
```

我阅读了这个文件并将其转换为一个字典，其中第一列作为键，第二列作为值。

现在我试图做相反的事情，我需要能够用相同格式的修改值写回文件，键用空格分隔，然后是相应的值。

我为什么要这样做？

好吧，所有值都应该可以由用户使用该程序进行更改。因此，当决定更改这些值时，我需要将它们写回文本文件。

这就是问题所在，我只是不知道该怎么做。

我该怎么做呢？

我有我当前的代码来读取这里的值：

```
T_Dictionary = {}
    with open(r"C:\NetSendClient\files\nsed.txt",newline = "") as f:
        reader = csv.reader(f, delimiter=" ")
        T_Dictionary = dict(reader) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:17:33.933

像这样的东西：

```
def txtf_exp2(xlist):
    print("\n", xlist)
    t = open("mytxt.txt", "w+")

    # combines a list of lists into a list
    ylist = []
    for i in range(len(xlist)):
        newstr = xlist[i][0] + "\n"
        ylist.append(newstr)
        newstr = str(xlist[i][1]) + "\n"
        ylist.append(newstr)

    t.writelines(ylist)
    t.seek(0)
    print(t.read())
    t.close()

def txtf_exp3(xlist):
    # does the same as the function above but is simpler
    print("\n", xlist)
    t = open("mytext.txt", "w+")
    for i in range(len(xlist)):
        t.write(xlist[i][0] + "\n" + str(xlist[i][1]) + "\n")
    t.seek(0)
    print(t.read())
    t.close() 
```

您必须进行一些更改，但这与您尝试做的非常相似。米

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T19:30:36.947

好的，假设字典被称为 A 并且文件是 text.txt 我会这样做：

```
W=""

for i in A:    # for each key in the dictionary
    W+="{0} {1}\n".format(i,A[i])     # Append to W a dictionary key , a space , the value corresponding to that key and start a new line

with open("text.txt","w") as O:
    O.write(W) 
```

如果我明白你在问什么。
但是使用此方法会在文件末尾留下一个空行，但可以删除替换

```
O.write(W) 
```

和

```
O.write(W[0:-1]) 
```

我希望它有帮助

# javascript - 使用 Javascript 的跨浏览器（IE8-）getComputedStyle？

> ID：15733365
> 
> 赞同：23
> 
> 时间：2013-03-31T19:08:44.943
> 
> 标签：javascript, internet-explorer, cross-browser, styles

由于**IE8**不支持`getComputedStyle`，我们只能使用`currentStyle`。但是，它不会返回某些属性的真实“计算”值。

例如：

```
<style type="text/css">
#div {/* no properties are defined here */}
</style> 
```

```
<div id="div">div</div> 
```

```
// returns "medium" instead of 0px
document.getElementById('div').currentStyle.borderLeftWidth

// returns "auto" instead of 0px
document.getElementById('div').currentStyle.marginLeft

// returns "undefined" instead of 1
document.getElementById('div').currentStyle.opacity 
```

有没有人在不使用 jQuery 或其他 Javascript 库的情况下为所有属性提供跨浏览器解决方案？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-03-30T13:35:47.500

这是一个获取计算样式的跨浏览器函数...

```
getStyle = function (el, prop) {
    if (typeof getComputedStyle !== 'undefined') {
        return getComputedStyle(el, null).getPropertyValue(prop);
    } else {
        return el.currentStyle[prop];
    }
} 
```

您可以将其作为实用程序存储在对象中，或者仅按提供的方式使用它。这是一个示例演示！

```
// Create paragraph element and append some text to it
var p = document.createElement('p');
p.appendChild(document.createTextNode('something for fun'));

// Append element to the body
document.getElementsByTagName('body')[0].appendChild(p);

// Set hex color to this element
p.style.color = '#999';

// alert element's color using getStyle function
alert(getStyle(p, 'color')); 
```

**检查此演示**以查看它的实际效果：

```
getStyle = function(el, prop) {
  if (getComputedStyle !== 'undefined') {
    return getComputedStyle(el, null).getPropertyValue(prop);
  } else {
    return el.currentStyle[prop];
  }
}

// Create paragraph element and append some text to it
var p = document.createElement('p');
p.appendChild(document.createTextNode('something for fun'));

// Append element to the body
document.getElementsByTagName('body')[0].appendChild(p);

// Set hex color to this element
p.style.color = '#999';

// alert element's color using getStyle function
console.log(getStyle(p, 'color'));
```

```
p {
  color: red;
}
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-12-10T08:24:47.683

您不想使用 jquery，但没有什么可以阻止您查看代码并查看它们是如何处理它的 :-)

在 jquery 代码中，有一个关于[此评论](http://erik.eae.net/archives/2007/07/27/18.54.15/#comment-102291)的参考，这似乎很重要（另请阅读整篇文章）。这是应该处理您的问题的jquery代码：

```
else if ( document.documentElement.currentStyle ) {
    curCSS = function( elem, name ) {
        var left, rsLeft,
            ret = elem.currentStyle && elem.currentStyle[ name ],
        style = elem.style;

    // Avoid setting ret to empty string here
    // so we don't default to auto
    if ( ret == null && style && style[ name ] ) {
        ret = style[ name ];
    }

    // From the awesome hack by Dean Edwards
    // http://erik.eae.net/archives/2007/07/27/18.54.15/#comment-102291

    // If we're not dealing with a regular pixel number
    // but a number that has a weird ending, we need to convert it to pixels
    // but not position css attributes, as those are proportional to the parent element instead
    // and we can't measure the parent instead because it might trigger a "stacking dolls" problem
    if ( rnumnonpx.test( ret ) && !rposition.test( name ) ) {

        // Remember the original values
        left = style.left;
        rsLeft = elem.runtimeStyle && elem.runtimeStyle.left;

        // Put in the new values to get a computed value out
        if ( rsLeft ) {
            elem.runtimeStyle.left = elem.currentStyle.left;
        }
        style.left = name === "fontSize" ? "1em" : ret;
        ret = style.pixelLeft + "px";

        // Revert the changed values
        style.left = left;
        if ( rsLeft ) {
            elem.runtimeStyle.left = rsLeft;
        }
    }

    return ret === "" ? "auto" : ret;
};
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-03-13T12:18:08.477

代替 ：

```
getComputedStyle !== 'undefined' 
```

它应该是 ：

```
typeof getComputedStyle !== 'undefined' 
```

否则它永远不会起作用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-12-18T22:33:39.197

这不适用于所有样式，但适用于尺寸（这是我需要的）。

无需尝试猜测应用了哪些样式，只需使用类似盒子的元素的四个边中的每一个的像素位置来计算尺寸。这也适用于 IE 5 和 FF 3。

```
height = elem.getBoundingClientRect().bottom - elem.getBoundingClientRect().top;
width = elem.getBoundingClientRect().right - elem.getBoundingClientRect().left; 
```

另请参阅：[getBoundingClientRect 很棒](http://ejohn.org/blog/getboundingclientrect-is-awesome/)

如果这仍然对您不起作用，请查看我为计算盒子的内部宽度而放在一起的[这个小提琴。](http://jsfiddle.net/netinept/ctHh3/46/)它使用以下内容作为 getComputedStyle 的 shim：

```
/**
 * getComputedStyle function for IE8
 * borrowed from:
 * http://missouristate.info/scripts/2013/common.js
 */
"getComputedStyle" in window || function() {
  function c(a, b, g, e) {
    var h = b[g];
    b = parseFloat(h);
    h = h.split(/\d/)[0];
    e = null !== e ? e : /%|em/.test(h) && a.parentElement ? c(a.parentElement, a.parentElement.currentStyle, "fontSize", null) : 16;
    a = "fontSize" == g ? e : /width/i.test(g) ? a.clientWidth : a.clientHeight;
    return "em" == h ? b * e : "in" == h ? 96 * b : "pt" == h ? 96 * b / 72 : "%" == h ? b / 100 * a : b;
  }
  function a(a, c) {
    var b = "border" == c ? "Width" : "", e = c + "Top" + b, h = c + "Right" + b, l = c + "Bottom" + b, b = c + "Left" + b;
    a[c] = (a[e] == a[h] == a[l] == a[b] ? [a[e]] : a[e] == a[l] && a[b] == a[h] ? [a[e], a[h]] : a[b] == a[h] ? [a[e], a[h], a[l]] : [a[e], a[h], a[l], a[b]]).join(" ");
  }
  function b(b) {
    var d, g = b.currentStyle, e = c(b, g, "fontSize", null);
    for (d in g) {
      /width|height|margin.|padding.|border.+W/.test(d) && "auto" !== this[d] ? this[d] = c(b, g, d, e) + "px" : "styleFloat" === d ? this["float"] = g[d] : this[d] = g[d];
    }
    a(this, "margin");
    a(this, "padding");
    a(this, "border");
    this.fontSize = e + "px";
    return this;
  }
  b.prototype = {};
  window.getComputedStyle = function(a) {
    return new b(a);
  };
}(); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-12-28T03:10:49.997

*这对于编辑来说太大了，所以它是一个答案，但它没有为手头的问题提供完整的答案。*

* * *

[Gabriel 的回答](https://stackoverflow.com/a/22744598/1218980)失败，属性类似于`"backgroundColor"`或`"background-color"`取决于浏览器版本，因为`.getPropertyValue`需要 CSS 属性名称并`el.currentStyle[prop]`需要驼峰式版本。

这是一个固定版本，它总是需要驼峰版本：

```
function getStyle(el, prop) {
    return (typeof getComputedStyle !== 'undefined' ?
        getComputedStyle(el, null) :
        el.currentStyle
    )[prop]; // avoid getPropertyValue altogether
} 
```

# c - 使用 shmget 读取垃圾

> ID：15733366
> 
> 赞同：1
> 
> 时间：2013-03-31T19:08:47.490
> 
> 标签：c, segmentation-fault, shared-memory, garbage

我创建了两个进程。其中一个创建共享内存块，另一个尝试读取它。这段代码没有编译错误，但不知何故 Process 2 表现得很奇怪。

过程1：

```
#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/shm.h>
#include <sys/sem.h>
#include <unistd.h>
#include <errno.h>
#include <string.h>
#include <signal.h>
#define nDEVICES 3
#define DEVICE_NAME_LIMIT 20
typedef struct d_list 
{
    char d_name[DEVICE_NAME_LIMIT];
    int d_id;

}device_mapping;
int main()
{
    key_t shared_memkey_D=ftok(".", 'D');
    int shared_memid_D=shmget(shared_memkey_D, nDEVICES*sizeof(device_mapping), 0777|IPC_CREAT|IPC_EXCL);
    device_mapping *DEVICES = (device_mapping*)shmat(shared_memid_D,0,0);

    strcpy(DEVICES[0].d_name, "DISK");
    strcpy(DEVICES[1].d_name, "PORT");
    strcpy(DEVICES[2].d_name, "PRINTER");
    DEVICES[0].d_id=1;
    DEVICES[1].d_id=3;
    DEVICES[2].d_id=2;
} 
```

过程2：

```
#include <stdio.h>
#include <errno.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/shm.h>
#include <sys/sem.h>
#include <signal.h>
#define nDEVICES 3
#define DEVICE_NAME_LIMIT 20
typedef struct d_list 
{
    char d_name[DEVICE_NAME_LIMIT];
    int d_id;

}device_mapping;

int main()
{

    key_t shared_memkey_D=ftok(".", 'D');
    int shared_memid_D=shmget(shared_memkey_D, nDEVICES*sizeof(device_mapping), 0777);
    device_mapping *DEVICES = (device_mapping*)shmat(shared_memid_D,0,0);
    int i=0;
    for (i=0; i<nDEVICES; i++)
        printf("%s\t%d\n", DEVICES[i].d_name, DEVICES[i].d_id);

} 
```

进程 2 正在读取所有垃圾，经过几次尝试后我无法弄清楚出了什么问题。请帮忙。

**编辑**：

我在这里复制了错误的程序。我已经进行了更正。它仍然给我垃圾。

*过程 2 打印以下内容：*

磁盘 11038

?FG+ 3

@?FG+ 2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T19:14:40.543

```
/* process 1 */
typedef struct d_list 
{
  char d_name[DEVICE_NAME_LIMIT];
  int d_id;
}device_mapping; 
```

和

```
/* process 2 */
typedef struct d_list 
{
  char * d_name;
  int d_id;
}device_mapping; 
```

不**一样**。

将进程 2 的定义更改`device_mapping`为与进程 1 相同，使用字符数组但使用字符指针。

进程 1`d_name`使用`DEVICE_NAME_LIMIT`字节，进程 2`d_name`使用 4 字节（32 位）或 8 字节（64 位）。

* * *

我会将通用结构定义放入一个共享的头文件中，该文件包含在两个进程的源中。

# java - 线程安全的 Java 池，带有 INSTANT READ

> ID：15733368
> 
> 赞同：0
> 
> 时间：2013-03-31T19:09:04.797
> 
> 标签：java, multithreading, thread-safety

要编写一个功能齐全的 Java 对象池，使用 READ/WRITE 锁并不是什么大问题。我看到的问题是 READ 操作必须等到存储监视器（或类似的东西，取决于模型）被释放，这真的减慢了它。

因此，应满足以下要求：

1.  READ（或 GET）操作应该是 INSTANT - 使用一些键，应该立即返回对象的最新版本，而不需要等待任何锁。

2.  WRITE (CREATE/UPDATE) - 可能被排队，合理地延迟时间，可能等待一些存储锁。

任何代码示例？

* * *

我没有找到直接针对该问题的问题。

它出现在一些讨论中，但我找不到一个完全致力于在 Java 中创建这样一个池的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T09:51:35.310

在这种情况下，您可以简单地使用 volatile 变量来避免在读取器端锁定并使用`synchronized`方法保持写入独占。`volatile`几乎不会增加读取开销，但写入会有点慢。根据预期的吞吐量和读/写比率，这可能是一个很好的解决方案。

```
class Cache {
    private volatile Map<K, V> cache; //Assuming map is the right data structure

    public V get(K key) {
        return cache.get(key);
    }

    //synchronized writes for exclusive access
    public synchronized void put(K key, V value) {
        Map<K, V> copy = new HashMap<> (cache);
        V value = copy.put(key, value);
        //volatile guarantees that this will be visible from the getter
        cache = copy;
        return value;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-24T16:00:55.747

Here is a totally-lock-free Java object pool solution. FYI

[http://daviddengcn.blogspot.com/2015/02/a-lock-free-java-object-pool.html](http://daviddengcn.blogspot.com/2015/02/a-lock-free-java-object-pool.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-01T09:17:55.427

当对数据结构的修改花费太长时间（无论出于何种原因）时，简单地等待和写锁定结构将不会成功。您只是无法预见何时有足够的时间在不阻塞任何读取的情况下执行修改。

您唯一能做的（尝试做的）就是将写操作中的时间减少到最低限度。正如@assylias 所说， CopyOnWrite* 通过在写入操作时克隆数据结构来做到这一点，并在操作完成时自动激活修改后的结构。

这样，读锁将花费克隆操作的持续时间加上切换引用的时间。您可以将其缩小到数据结构的一小部分：如果仅对象中的状态发生更改，则可以修改该对象的副本，然后将更复杂的数据结构中的引用更改为该副本。

另一种方法是在读取操作之前或之前进行复制。无论如何，您通常都会通过数据结构的 API 返回对象的副本，因此只需“缓存”该副本并在修改期间让读者访问缓存的副本。这也是数据库缓存所做的。

这取决于您的型号，什么最适合您。如果您对可以轻松复制的数据的写入很少，则 CopyOnWrite 可能会执行得最好。如果您将有大量写入，您可能最好提供结构的单个“读取”/缓存状态并不时切换它。

```
AtomicReference<Some> datastructure = ...; 

//copy on write

synchronized /*one writer*/ void change(Object modification) 
throws CloneNotSupportedException {
   Object copy = datastructure.clone();
   apply(copy, modification);
   datastructure.set(copy);  
}

Object search(Object select) {
   return datastructure.get().search(select);
}

// copy for read

AtomicReference<Some> cached = new AtomicReference<Some>(datastructure.get().clone());

synchronized void change(Object modification) {
    apply(datastructure, modification);
    cached.set(datastructure);
}

Object search(Object select) {
    return cached.get().search(select);
} 
```

对于这两种操作，读取时无需等待 .. 但需要切换参考。

# android - 如何像 TabBar 一样将 Action Bar Sherlock 设置到底部？

> ID：15733369
> 
> 赞同：-1
> 
> 时间：2013-03-31T19:09:07.693
> 
> 标签：android, actionbarsherlock

我没有找到任何可以这样做的参数。我尝试了 abs__dimens.xml，但似乎我需要其他东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:48:11.743

你不能这样做，除非你想创建它的自定义实现，完全修改它。除此之外：ActionBar 应该位于屏幕的顶部，为用户提供一个“锚点”，以便他可以在应用程序中导航。

# php - 如何在 WordPress 中的每条评论上方实现这个随机数生成器？

> ID：15733372
> 
> 赞同：0
> 
> 时间：2013-03-31T19:09:17.093
> 
> 标签：php, wordpress, random

我在这里有一个随机数生成器，但我无法让它在所有 WordPress 评论中运行。我得到：

```
Fatal error: Cannot redeclare class Random in [mysite]/functions.php on line 148 
```

这是随机数生成器的功能：

```
/**
 * Generate random images for the forum games function
 */
function random_forum_games() {

class Random {
    // random seed
    private static $RSeed = 0;

    // set seed
    public static function seed($s = 0) {
        self::$RSeed = abs(intval($s)) % 9999999 + 1;
        self::num();
    }

    // generate random number
    public static function num($min = 0, $max = 9999999) {
        if (self::$RSeed == 0) self::seed(mt_rand());
        self::$RSeed = (self::$RSeed * 125) % 2796203;
        return self::$RSeed % ($max - $min + 1) + $min;
    }
}

    // set seed
    Random::seed(42);
    // echo 10 numbers between 1 and 10
    for ($i = 0; $i < 1; $i++) {
        echo Random::num(1, 10) . '<br />';
    }
}
add_action( 'forum_games', 'random_forum_games'  ); 
```

为了在每条评论上方调用该函数，在我的评论模板中，我有：

```
<?php do_action ( 'forum_games' ); ?> 
```

我知道为什么我做错了，但我并不是真正的“程序员”。我来这里是为了一些简单的帮助，无论是一行代码还是一个链接，可以告诉我该做什么而无需尝试教我 PHP。我没有时间学习PHP，所以请多多关照。如果没有简单的解决方案，那么您不必回答。

我并不是要听起来防御，但我以前被程序员拒绝过。并非每个需要运行某些东西的人都有时间或技能来学习每一个细节。你不要指望每一个给家人做饭的人都会学习如何打猎或制作杀虫剂，所以请不要因为我不会 PHP 而拒绝我。如果你愿意，只需将我链接到不试图教我从头开始编码的东西。我正在尽我所能做自己的工作，我只要求支持的花絮，所以请不要无礼。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:25:49.997

您没有在函数内定义类。它应该在函数外部定义，然后您可以（如果需要）在函数内部对其进行**实例**化，例如

```
class rand {
   ...
}

function get_rand() {
    $r = new rand();
} 
```

或者更好的是，您只需在类中有一个 get_rand() 方法：

```
class rand() {
   function get_rand() {
      ...
   }
}

$r = new rand();
echo $r->get_rand(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:27:07.940

您似乎不止一次声明了该函数。也许它被包含了不止一次，或者你不止一次地调用这个类。尝试将类移出函数，如果它在包含文件中，则仅使用 include_once 将其包含一次，而不是包含。

至于不友好的人……有些是，那又怎样。大多数人都很友好，乐于助人......只要确保您提供有关您的问题的详细信息（代码+使其可重复的方式）并表明您付出了努力，您会没事的:)

# path - 为什么相对路径在 CMS 中不起作用？

> ID：15733385
> 
> 赞同：0
> 
> 时间：2013-03-31T19:10:22.040
> 
> 标签：path, content-management-system, relative-path

为什么相对路径在使用“可编辑”类标记的流行基本内容管理系统中不起作用？奇怪的是，每次我在 CMS 中编辑页面时，我的所有样式和 jS 都会因为我的相对路径而被杀死。幕后发生了什么？他们是否在复制我的页面？虽然这似乎仍然不能完全解释它，因为前向相对路径，例如

`/css/style.css`仍然会工作，

但相对路径向后退，例如

```
../css/style.css 
```

将不再工作。

即使他们制作了副本，他们也有 FTP 访问权限，而且他们似乎应该能够跟踪相对路径……相反，他们需要一个绝对路径或根相对路径。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-12T16:57:32.593

相对路径在超现实中运行良好，但如果您的页面包含包含文件，则路径可能会“中断”，具体取决于包含它的页面所在的位置。

无论如何，您可以在 Surreal 中轻松调整 URL 格式：

```
<div class="editable" data-urls="absolute">
    ...
</div> 
```

更多详细信息在文档中： http: [//www.surrealcms.dev/docs/url-formatting](http://www.surrealcms.dev/docs/url-formatting)

# c++ - 在 C++ 中传递派生类时无法初始化仿函数对象

> ID：15733390
> 
> 赞同：3
> 
> 时间：2013-03-31T19:10:42.277
> 
> 标签：c++, functor

这个问题源于我[在这里](https://stackoverflow.com/questions/15513453/cant-initialize-map-of-method-pointers-in-c)问过的一个问题。我不能使用任何外部库或 C++ 11 规范。这意味着我不能使用 std::bind、std::function、boost::bind、boost::function 等。我必须自己编写。问题如下：

考虑代码：

**编辑**

这是一个完整的程序，可按要求显示问题：

```
#include <map>
#include <iostream>

class Command {    
public:
    virtual void executeCommand() = 0;
};

class Functor {
public:
    virtual Command * operator()()=0; 
};

template <class T> class Function : public Functor {
private:
    Command * (T::*fptr); 
    T* obj;                  
public:
    Function(T* obj, Command * (T::*fptr)()):obj(obj),
        fptr(fptr) {}

    virtual Command * operator()(){
        (*obj.*fptr)();   
    }            
};

class Addition:public Command {
public:
    virtual void executeCommand(){
        int x;
        int y;
        x + y;
    }
};

class CommandFactory {
public:
    virtual Addition * createAdditionCommand() = 0;
};

class StackCommandFactory: public CommandFactory {
private:
    Addition * add;
public:
    StackCommandFactory():add(new Addition()) {}

    virtual Addition * createAdditionCommand(){
         return add;
    }
};

void Foo(CommandFactory & fact) {
    Function<CommandFactory> bar(&fact,&CommandFactory::createAdditionCommand);
}

int main() {
    StackCommandFactory fact;
    Foo(fact);
    return 0;
} 
```

它给出的错误是`"no instance of constructor "Function<T>::Function [with T=CommandFactory] matches the argument list, argument types are: (CommandFactory *, Addition * (CommandFactory::*)())`

我认为它在抱怨，因为我将它传递给派生类型。我必须使用对抽象类的指针/引用，因为`fact`以后可能不是 StackCommandFactory。

我不能说：

```
void Foo(CommandFactory & fact){
      Function<CommandFactory> spf(&fact,&fact.createAdditionCommand); //error C2276

} 
```

因为那时我收到错误 C2276 说（在我链接到的问题中）`'&' : illegal operation on bound member function expression.`

所以明确我的问题是：“我如何初始化这个函子对象，以便我可以将它与上述接口一起使用？”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:37:52.573

您需要对 bar 实例的第二个参数进行显式转换：

```
Function<CommandFactory> bar(&fact,
  reinterpretet_cast<Command *(CommandFactory::*)()>(&CommandFactory::createAdditionCommand)); 
```

此外，您缺少以下方法指针属性的括号`Function`：

```
Command * (T::*fptr)(); 
```

此错误可能会阻止您找到上述解决方案。

您还缺少那里的`return`关键字`operator()`（由于我的函数式编程习惯，我经常犯这个错误）：

```
virtual Command * operator()(){
   return  (obj->*fptr)();
} 
```

* * *

您可以通过使返回类型成为模板参数来避免强制转换：

```
template <class T, typename D> 
class Function : public Functor {
private:
    D * (T::*fptr); 
    T* obj;
public:
    Function(T* obj, D * (T::*fptr)()): obj(obj),  fptr(fptr){}
    virtual Command * operator()(){
        return (obj->*fptr)();
    }            
};

void Foo(CommandFactory & fact){
    Function<CommandFactory, Addition> bar(&fact, &CommandFactory::createAdditionCommand);
} 
```

请注意，我毕竟没有模板化`Functor`。虽然起初对我来说这似乎是一个好主意，但它使事情变得更加复杂。如果您也想制作`Functor`模板，则返回类型必须完全相同，您不能在它们之间使用继承关系，除非您将它们都设为`Function`模板的参数。根据经验，每当你偶然发现这样的模板问题时，请记住，模板的核心就像 C 宏，它是一种重写机制，它将模板分别扩展为真正的 C++ 类型（函数或类）。你可以这样描述问题：

```
template <typename T, typename D>
class Function : public Functor<D> { /* ... */ }; 
```

将扩大到

```
class Function<CommandFactory, Addition> : public Functor<Addition> {
    /* ... */
}; 
```

`Functor<Addition>` 并且`Functor<Command>`根本没有任何关系；这是两个不同的类别。

如果 C++ 模板确实带有有界多态性的概念（如在 Java 或 C# 中），那么它可能可以以接近您的意图的方式编写它。

我建议：

*   保持`Functor`一个简单的类，暂时使代码更易于使用，并且
*   如果以后需要，尝试使用该新功能重构一个工作版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T01:33:59.403

这是对我原始答案的修改，似乎可以满足您的需要，而无需使用 C++11 或 boost 中的任何仿函数。

```
#include <vector>
#include <map>
#include <string>

struct Command {};
struct Subtract : Command {};
struct Add : Command {};

class CommandFactory
{
  public:

    virtual Subtract * createSubtractionCommand() = 0;
    virtual Add * createAdditionCommand() = 0;
};

class StackCommandFactory : public CommandFactory
{
  public:

    virtual Subtract * createSubtractionCommand(void);
    virtual Add * createAdditionCommand(void);

    Subtract * sub;
    Add * add;
};

Subtract * StackCommandFactory::createSubtractionCommand(void) { return sub; }
Add * StackCommandFactory::createAdditionCommand(void) { return add; }

class CommandGetterImpl
{
  public:
    virtual CommandGetterImpl* clone() const=0;
    virtual Command* get()=0;
    virtual ~CommandGetterImpl() {};
};

class CommandGetter
{
  public:
  Command* get() { return impl_->get(); }
  ~CommandGetter() { delete impl_; }
  CommandGetter( const CommandGetter & other ) : impl_(other.impl_?other.impl_->clone():NULL) {}
  CommandGetter& operator=( const CommandGetter & other ) {
     if (&other!=this) impl_= other.impl_?other.impl_->clone():NULL;
     return *this;
  }
  CommandGetter() : impl_(NULL) {}
  CommandGetter( CommandGetterImpl * impl ) : impl_(impl) {}
  CommandGetterImpl * impl_;
};

class Parser
{
  public:
    Parser (CommandFactory & fact);

    std::map<std::string, CommandGetter > operations; 
};

template<typename MEMFN, typename OBJ >
class MemFnCommandGetterImpl : public CommandGetterImpl
{
  public:
  MemFnCommandGetterImpl(MEMFN memfn, OBJ *obj) : memfn_(memfn), obj_(obj) {}
  MemFnCommandGetterImpl* clone() const { return new MemFnCommandGetterImpl( memfn_, obj_) ; }
  Command* get() { return (obj_->*memfn_)(); }
  MEMFN memfn_;
  OBJ * obj_;
};

template< typename MEMFN, typename OBJ >
CommandGetter my_bind( MEMFN memfn, OBJ * obj )
{
  return CommandGetter( new MemFnCommandGetterImpl<MEMFN,OBJ>(memfn,obj) );
};

Parser::Parser(CommandFactory & fact)
{
  operations["+"] = my_bind(&CommandFactory::createAdditionCommand, &fact);
  operations["-"] = my_bind(&CommandFactory::createSubtractionCommand, &fact);
}

#include <iostream>
int main()
{
  Add add;
  Subtract sub;

  StackCommandFactory command_factory;
  command_factory.add = &add;
  command_factory.sub= &sub;
  Parser parser(command_factory);

  std::cout<<"&add = "<<&add<<std::endl;
  std::cout<<"Add = " <<  parser.operations["+"].get() <<std::endl;
  std::cout<<"&sub = "<<&sub<<std::endl;
  std::cout<<"Sub = " <<  parser.operations["-"].get() <<std::endl;

  return 0;
} 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-03-31T23:09:39.723

一般来说，使用成员函数指针而不是`std::function`. 更普遍，

```
typedef std::function<void()> Command;
typedef std::function<Command()> Functor; 
```

实际上，您的代码中绝对不需要任何成员函数指针。

# jquery - jQuery删除了所有元素？

> ID：15733392
> 
> 赞同：-3
> 
> 时间：2013-03-31T19:10:48.200
> 
> 标签：jquery, removeclass

我有这个功能

```
$("tr#phaseRow"+data[2]).remove(); 
```

如何测试我是否删除了所有元素 tr？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:11:59.453

你可以检查一下`$('tr').length==0`。

但更喜欢使用`$('#someId')`over `$('tr#someId')`：这会更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:12:17.440

您可以测试是否所有 tr 元素都已被删除，如下所示：

```
if ($('tr').length === 0) {
  alert('No tr elements left'); 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-31T19:13:15.267

一个很好的测试方法是使用[http://www.jsfiddle.com](http://www.jsfiddle.com)。去那里，用一个 DOM 设置一些示例`html`来模拟你当前的 DOM，确保`jQuery 1.9`从左上角的下拉列表中包含你的当前版本，将你的脚本放在该`javascript`部分中，然后单击运行。这将允许您测试您的 javascript (jQuery) 代码。

要在代码中执行此操作，您可以执行以下操作：

```
$("tr#phaseRow"+data[2]).remove();
if( $("tr#phaseRow"+data[2]).length > 0 ){
 /* elements not removed */ 
}//although it is unlikely your elements will remain 
```

# javascript - 非滚动png图像作为标题

> ID：15733393
> 
> 赞同：2
> 
> 时间：2013-03-31T19:10:53.193
> 
> 标签：javascript, html, header, png, non-scrolling

我在网上搜索了大约 6 个小时，但找不到我需要的东西，所以我认为是时候向专业人士询问了。我有一个带有一些透明点的 png 图像。我不想将此图像作为页面的标题，当有人滚动页面时，图像会停留在顶部，而页面会滚动到图像后面。我找到了一些非滚动标题 div 的示例，但在我的情况下，我希望看到页面滚动到图像中的 transprant 点。这甚至可能吗？所以是的，有人可以告诉我如何或指导我学习教程或示例吗？

一些简单的html让我的问题更清楚：

```
<!DOCTYPE HTML>
<html>
<head>
</head>
<body>
<a href="mypage" target="top"><img src="myimage.png"></a>
<div id="content">
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<p>sometext</p>
<div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T19:21:19.780

使您的图像在您想要透视的地方透明。这将在图形软件中完成。然后设置您的锚点，该锚点以易于索引的方式保存图像，例如使用 id。

```
<a id="transparentHeader" href="mypage" target="top"><img src="myimage.png"></a> 
```

然后设置css，使锚点“固定”到页面顶部。

```
#transparentHeader{
 z-index:999;
 position:fixed;
 top: 0px;
 left:0px;/*not centered*/
 /* margin: 0 auto; centered */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:21:02.993

看看这是否适合你。

```
<div class="header">Some data</div>

.header
{
position:fixed;
top:10px;
} 
```

# algorithm - 关于解决滑动瓷砖难题的方法

> ID：15733394
> 
> 赞同：1
> 
> 时间：2013-03-31T19:10:56.043
> 
> 标签：algorithm, dynamic-programming, procedural-programming

我已经开始阅读 V Anton Spraul 的“像程序员一样思考”。这是问题。

书中提到的火车技术适用于其中的示例。我正在尝试编写火车方法来解决滑动瓷砖问题。

假设我正在研究完整问题的子集，对于下面的一组图块（如书中的示例所示），提到的方法可以正常工作。

```
6 8 .

5 4 7 
```

我们逆时针移动，直到我们在第一行按顺序获得 4、5、6，然后在空白处滑动 8 以使所有内容按顺序排列。

但是对于以下，我找不到任何合适的方法

```
. 8 6

7 4 5 
```

是否有可能存在无法解决难题的排列？

谢谢，

/多发性硬化症

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T19:12:59.987

是的，事实上有些谜题是无法解决的。找出答案的方法是尝试一次解决两个难题：一个是原始难题，一个是两个瓷砖交换的原始难题。当您解决了一个难题时，您就知道另一个难题无法解决。

# c - 我可以为同一台服务器创建 2 个套接字吗？

> ID：15733399
> 
> 赞同：0
> 
> 时间：2013-03-31T19:11:15.320
> 
> 标签：c, network-programming

我可以在同一台客户端计算机上创建 2 个 UDP 套接字（但将在 2 个不同的线程中使用）以连接到服务器吗？一个线程向服务器发送数据报，另一个线程从服务器接收数据报。这些步骤是否正确：

1.  为服务器的给定地址和 UDP 端口创建一个 sockaddr_in。
2.  创建一个套接字并将其连接到服务器的 sockaddr_in。这是发送套接字。
3.  创建另一个套接字，分配一个端口并将端口号发送到服务器。

谢谢你。

# spring - 转发 Spring HTTP 请求

> ID：15733402
> 
> 赞同：3
> 
> 时间：2013-03-31T19:11:30.947
> 
> 标签：spring, forward

我有一个使用 Spring WebMVC 编写的宁静 Web 服务，主要用于编排其他服务。在某些情况下，这些服务位于同一台服务器上，在某些情况下则不在同一台服务器上。我有一些请求（GET 和 POST）将直接传递到另一个服务。有没有办法在不知道请求中数据的情况下盲目地转发来自特定 URL 请求的所有 GET 和 POST 数据？

理想情况下，我想说所有的请求`http://server1/myService/user/...`都应该转发到`http://server2/user/...`所有的 GET 和 POST 参数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T17:41:21.443

对于同一服务器上的服务，如果它们由同一个 Spring MVC 应用程序提供服务，则可以使用[RedirectViews 和/或“redirect:”前缀](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html#mvc-redirecting)。

对于另一台服务器上的人，我能想到的最好的办法是使用 servlet 过滤器，类似于这篇文章建议的方法：[spring mvc redirect path and all children to another domain](https://stackoverflow.com/questions/10568808/spring-mvc-redirect-path-and-all-children-to-another-domain)

# php - 使用 PHP PDO 调用 MySQL 存储过程

> ID：15733403
> 
> 赞同：2
> 
> 时间：2013-03-31T19:11:36.043
> 
> 标签：php, mysql, stored-procedures, pdo

试图掌握 MySQL/PHP 中的存储过程。SP 在 MySQL 控制台上运行良好。

但是尝试在 PHP 中调用它，我得到以下信息：

`Fatal error: Cannot pass parameter 2 by reference in /home/dir/public_html/system/classes/account.class on line 92`

```
try {
  $dsn = 'mysql:dbname=db_name;host=localhost';
  $dbh = new PDO($dsn, 'usrName', 'password');
} catch (PDOException $e) {
  echo 'Connection failed: ' . $e->getMessage();
}

$stmt = $dbh->prepare("CALL db_name.stprNewUser(?,@statusValue)");
//$stmt->bindParam(1, 'user@googlemail.com', PDO::PARAM_STR); // <<LINE 92 DID NOT WORK
$stmt->bindValue(1, 'user@googlemail.com', PDO::PARAM_STR); // <<LINE 92 DID WORK

$stmt->execute(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T19:14:28.017

来自[PDO 标签维基](https://stackoverflow.com/tags/pdo/info)：

> 如果您不知道是否需要 bindValue() 或 bindParam()，请选择前者。bindValue() 不那么模棱两可，副作用也更小。

# wix - 使用 WiX 或 Inno Setup 捆绑安装多个 MSI 文件

> ID：15733405
> 
> 赞同：4
> 
> 时间：2013-03-31T19:11:47.010
> 
> 标签：wix, windows-installer, inno-setup, distutils, cx-freeze

我使用 cx-freeze 为 Python 应用程序创建 MSI 安装程序。我们称它为应用程序“A”。这取决于另一个应用程序“B”。我希望我的“A”安装程序包含并运行“B”的 MSI 安装程序。如何使用 Inno Setup 或 WiX 工具集创建引导/链接安装程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-01T15:53:19.127

这是一个基本的 Inno Setup 脚本，它将两个 MSI 安装捆绑到一个安装程序中。由于安装程序仅用于安装 MSI 文件，因此不需要应用程序目录。要避免创建应用程序目录，请使用“CreateAppDir=no”。（感谢 TLama！）

```
[Setup]
AppName=My Bundle Installer
AppVersion=0.1
DefaultDirName={pf}\MyCo\MyBundle
DefaultGroupName=My Bundle Group
Uninstallable=no
CreateAppDir=no

[Files]
Source: "A.msi"; DestDir: "{tmp}"
Source: "B.msi"; DestDir: "{tmp}"

[Run]
Filename: "msiexec.exe"; Parameters: "/i ""{tmp}\A.msi"""
Filename: "msiexec.exe"; Parameters: "/i ""{tmp}\B.msi""" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-31T22:39:04.070

您需要使用引导程序/链接器。例如，[WiX 工具集](http://wixtoolset.org)提供了一个称为 a 的概念`Bundle`，可以将多个包组合到一个安装中。

# c# - 为什么要在字典中使用不可变值？

> ID：15733406
> 
> 赞同：5
> 
> 时间：2013-03-31T19:11:50.700
> 
> 标签：c#, .net, linq, collections, dictionary

[问题“多值字典](https://stackoverflow.com/questions/569903/multi-value-dictionary)”的多个答案建议使用不可变的类，如`TValue`Class [`Dictionary<TKey, TValue>`](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)。

接受[的 Jon Skeet 的答案](https://stackoverflow.com/a/569920/2031316)提出了一个`Pair`具有只读属性的类和[@teedyay 的](https://stackoverflow.com/a/569921/2031316)使用不可变的答案[`Tuple`](http://msdn.microsoft.com/en-us/library/system.tuple.aspx)。

这种方法的基本原理（或可能的好处）是什么？

和附带问题：如果各自的属性 First 和 Second 无论如何都没有设置器，
为什么[要使 TFirst 和 TSecond 只读：](https://stackoverflow.com/a/569920/200449)

```
private readonly TFirst first;
private readonly TSecond second;

public TFirst First
{
   get { return first; }
}

public TSecond Second
{
   get { return second; }
} 
```

**更新：**
我正在使用带有自定义类的字典来获取其中的值。
并且值正在更新。
我使它们不可变的可能原因（好处）是什么？

我看到这[`Lookup<TKey, TElement> Class`](http://msdn.microsoft.com/en-us/library/bb460184.aspx)也是不可变的，并认为我错过了使用 LINQ 查询的一些好处（？）
如果是这样，你能给我举个例子，我错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-31T21:21:36.747

基本上，根据我的经验，不变性使各种事情更容易阅读。例如，Java`Calendar`和`Date`类的一大痛点是它们的可变性。很容易忘记它们是可变的，在构造函数中获取*引用*的副本，然后发现其他东西会改变您引用的对象。因此，即使没有任何东西会改变对象，您也开始采取防御性副本*……*这一切都变得非常烦人。

当然，可变性是有时间的——但在许多情况下，不变性更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:22:17.160

第二个问题的答案是成员变量在没有`readonly`关键字的情况下仍然是可设置的 - 仅在类本身内，但它仍然是可能的。

顺便说一句，这门课似乎是`struct`.

# android - 如何制作一个什么都不做也无处可去的状态栏通知？

> ID：15733407
> 
> 赞同：1
> 
> 时间：2013-03-31T19:11:58.830
> 
> 标签：android, notifications

我已经有一个适用于 Android 的状态栏通知，但要创建它，我必须设置一个 Activity 才能打开它。我不想打开*任何*活动；但是，这个小项目根本不需要接口。

```
mNotificationManager = (NotificationManager) aContext
        .getApplicationContext().getSystemService(
                Context.NOTIFICATION_SERVICE);

// Create the pending intent, which is basically NOW.
PendingIntent contentIntent = PendingIntent
        .getActivity(aContext, 1, new Intent(aContext, BlankActivity.class),
                PendingIntent.FLAG_CANCEL_CURRENT);

// Create notification
notificationBuilder = new NotificationCompat.Builder(aContext)
        .setContentIntent(contentIntent)
        .setSmallIcon(R.drawable.ic_launcher) // required for launch
        .setTicker("Downloading video...") // required for launch
        .setWhen(System.currentTimeMillis()) // should be set for now.
        .setContent(remoteView); 
```

`BlankActivity`听起来就是这样——一个没有内容并在打开时关闭的活动。但它仍然显示在最近打开的窗口列表中。我无法将其设置为 null。

有没有办法完全避免为状态通知设置意图？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-31T19:17:00.697

`PendingIntent`在那种情况下你不需要。只是设置它可能会`null`有所`setContentIntent()` 帮助。

另一种方法可以是

```
PendingIntent contentIntent = PendingIntent.getActivity(aContext(),0,new Intent(),PendingIntent.FLAG_CANCEL_CURRENT); 
```

试试这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-12T09:35:08.317

将其设置为 null 不适用于需要设置意图的 SDK 2.3 等早期版本，否则 android 将在接收器开始时阻塞，并出现异常：`java.lang.RuntimeException: Unable to start receiver com.movistar.android.mimovistar.widgets.WidgetIntentReceiver: java.lang.IllegalArgumentException: contentIntent required` [请参阅这篇文章](https://stackoverflow.com/questions/21317792/receiver-throws-illegalargument-exception)

# ios - 在 iOS 应用程序中从睡眠模式返回时不显示 UIAlertView

> ID：15733416
> 
> 赞同：1
> 
> 时间：2013-03-31T19:12:36.003
> 
> 标签：ios, alert, sleep-mode

当按下 Home 按钮或锁定按钮或显示通知中心时，我的应用程序有时必须显示 UIAlertView。

我从 applicationWillResignActive 委托的方法中显示警报，当按下主页按钮或显示通知中心时一切正常。但是如果按下的按钮是锁定按钮（开/关按钮），就会出现问题。

在这种情况下，当我返回应用程序时不会显示警报（如果我使用主页按钮，它就在那里）。我在执行的其他 AppDelegate 方法中没有做任何其他事情。此外，当我显示新警报（应用程序中的任何警报）时，在我关闭新警报后会显示我返回时未显示的警报。

请问，有人能帮帮我吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T03:42:29.860

# 简单，给我代表答案：

当应用程序进入后台时，应用程序被暂停。此过程的一部分是关闭打开的警报视图。

* * *

## 我实际上知道我在说什么 答案：

这背后的逻辑是，当用户在显示警报时点击主页按钮时，他们可能会寻找有关如何回答警报的信息。然而，当按下*睡眠*按钮时，用户已经完全停止使用该设备。Apple 知道，如果他们在 3 小时后再次解锁设备并看到类似的`Confirm Deletion`内容，他们将完全不知道自己刚刚在做什么以及现在要做什么。

众所周知，这会导致一种严重的情况，称为我现在应该做什么在世界上。这种情况的症状包括点击屏幕底部的圆形按钮，然后按住您的应用程序图标直到它抖动。然后他们点击了小“x”按钮。这对开发人员的口袋不利。

# mysql - 是否可以将数据从csv合并到mysql？

> ID：15733418
> 
> 赞同：1
> 
> 时间：2013-03-31T19:12:44.677
> 
> 标签：mysql

我有一个包含电子邮件 + 街道地址的 csv 文件。我已经使用具有相同电子邮件的用户安装了 wordpress，并且我想将街道地址导入 user_meta 表中的各个用户。

我怎样才能做到这一点？想到的一种愚蠢的方法是使用文本编辑器搜索和替换来创建一个巨大的插入查询列表。

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:14:02.680

您可以使用

```
LOAD DATA INFILE your_file.csv
INTO your_table 
```

参考：[加载数据 - MySQL](http://dev.mysql.com/doc/refman/5.0/es/load-data.html)

# php - 从对象中选择随机项目

> ID：15733425
> 
> 赞同：2
> 
> 时间：2013-03-31T19:13:51.833
> 
> 标签：php, zend-framework

我有一个这样的ini文件：

```
[hints]
menu.0 = "Hint: Dropping a element on parent element will move the selected element at the end of list!"
menu.1 = "Hint: Use Menu elements to beautify your navigator!"
menu.2 = "Hint: Pages in red means they are draft pages. Adding them to your menu means that your visitors can not see the page!" 
```

并使用 Zend_Config_Ini 读取 ini 文件：

```
self::$hints = new Zend_Config_Ini(APPLICATION_PATH . '/configs/hints.ini',
                                      'hints'); 
```

上的输出`var_dump(self::$hints->menu);`是：

```
object(Zend_Config)[63]
  protected '_allowModifications' => boolean false
  protected '_index' => int 0
  protected '_count' => int 3
  protected '_data' => 
    array (size=3)
      0 => string 'Hint: Dropping a element on parent element will move the selected element at the end of list!' (length=93)
      1 => string 'Hint: Use Menu elements to beautify your navigator!' (length=51)
      2 => string 'Hint: Pages in red means they are draft pages. Adding them to your menu means that your visitors can not see the page!' (length=118)
  protected '_skipNextIteration' => null
  protected '_loadedSection' => null
  protected '_extends' => 
    array (size=0)
      empty
  protected '_loadFileErrorStr' => null 
```

我需要帮助从该对象中随机挑选一个项目并显示它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T19:16:03.530

这个 PHP 函数对你很有用：

```
array_rand(); 
```

参考：[PHP.net 中的 array_rand()](http://php.net/manual/en/function.array-rand.php)

由于它是一个对象，因此您之前可以执行以下操作：

```
$arr = (array)$object; 
```

[如https://stackoverflow.com/a/1897695/2228023](https://stackoverflow.com/a/1897695/2228023)中所建议

# r - 将类型“语言”转换为“表达式”

> ID：15733426
> 
> 赞同：3
> 
> 时间：2013-03-31T19:13:59.847
> 
> 标签：r, plot, expression, curve, coercion

我是 R 新手，我经常对不存在或不需要其他语言的数据结构感到困惑。

目前，我正在尝试将“语言”类型的对象转换为“表达式”，以便我可以绘制它。

首先，我创建要绘制的函数：

```
> model <- nls(y~a+b*exp(x*z),start = list(a=1, b = -.5, z = -.8),data=results)  
> modelsym <- substitute(a+b*exp(z*x), list(a=coef(model[1],b=coef(model)[2],z=coef(model)[3])) 
```

该函数属于“语言”类型：

```
> modelsym  
0.958945264470923 + -0.463676594301167 * exp(-0.155697065390677 * x)  
> typeof(modelsym)  
[1] "language" 
```

如果我尝试绘制这条曲线：

```
> curve(modelsym)  
Error in eval(expr, envir, enclos) : could not find function "modelsym" 
```

但是，如果我复制并粘贴它可以正常工作：

```
> curve(0.958945264470923 + -0.463676594301167 * exp(-0.155697065390677 * x))  
**[plot appears here]** 
```

我试过`as(modelsym,expression)`无济于事。

我怎样才能将我的对象转换`modelsym`为一个`expression`以绘制它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T19:40:45.347

这不是一个完整的解决方案，但我已经接近：

```
do.call(curve, list(expr = modelsym)) 
```

`curve`它实质上为您安排调用，`expr`参数设置为`modelsym`.

您尝试失败的原因是第一行`curve`是

```
sexpr <- substitute(expr) 
```

当传递一个包含语句的对象（实际上是任何对象）时，它会给出这个结果：

```
Browse[2]> sexpr
modelsym
Browse[2]> is.call(sexpr)
[1] FALSE
Browse[2]> is.expression(sexpr)
[1] FALSE 
```

这两个测试`curve`用于查看输入是否可以接受。

无论你传递什么，`curve`它都必须是一个实际的语句，而不是一个包含语句的调用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-01T12:40:48.817

另一种攻击计划是使用预测：

```
model <- nls(y~a+b*exp(x*z),start = list(a=1, b = -.5, z = -.8),data=results)

modelf <- function(x) predict(model, newdata = data.frame(x = x))
plot(modelf)
curve(modelf) 
```

# java - 使用多个线程递增和递减单个共享变量

> ID：15733434
> 
> 赞同：1
> 
> 时间：2013-03-31T19:14:34.187
> 
> 标签：java, multithreading, concurrency, bluej

使用单个共享变量递增和递减多个线程时，如何确保线程以同步方式计数并且不跳过任何值。

我创建了一个单独的类，其中我有 3 种不同的方法，一种用于递增，另一种用于递减，最后一种用于返回值。它们也都是同步的。

结果显示了一个示例：

*   这是 Thread_4 迭代：500 中的 -108
    这是 Thread_5 迭代：500 中的 291
    这是 Thread_4 迭代：500 中的 -109
    这是 Thread_4 迭代：500 中的 -110

如您所见，线程正在递减，但随后会跳转到“291”，这在我使用共享变量时不应该发生。

****** *** ** *** ** *** ** *** ** *** *******编辑****** ** *** ********

 **代码：- 共享变量类

```
public class shareVar extends Thread
{
    private static int sharedVariable = 0;

    public synchronized static void increment(){
        sharedVariable++;
    }

    public synchronized static void decrement(){
        sharedVariable--;
    }

    public  static int value(){
        return sharedVariable;
    }
} 
```

----- 递增类

```
sVar incrementVal = new sVar();

public synchronized void display(){

    for(int countVal = 0; countVal<=max; countVal++ ){
            incrementVal.increment();
            System.out.println("This is " + threadName + " iteration: " + incrementVal.value() + " of " + max);
            //this.yield();
    }
    System.out.println("*THIS " + threadName + " IS FINISH " 
                                    + "INCREMENTING *");

}

public void run(){

    display();
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-31T19:20:57.060

考虑使用[`AtomicInteger`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicInteger.html)：

```
public class Foo
{
    private AtomicInteger counter = new AtomicInteger(0);

    public void increment()
    {
        counter.incrementAndGet();
    }

    public void decrement()
    {
        counter.decrementAndGet();
    }

    public int getValue()
    {
        return counter.get();
    }
} 
```

* * *

或使用同步方法：

```
public class Foo
{
    private volatile int counter;

    public synchronized void increment()
    {
        counter++;
    }

    public synchronized void decrement()
    {
        counter--;
    }

    public int getValue()
    {
        return counter;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T20:12:34.133

不确定我是否正确理解了您的问题，但您的输出看起来只是因为另一个线程（Thread_4）在 Thread_5 输出它之前开始处理该值。

每次迭代都会进行许多操作（简化列表，实际上不止这些）：

1.  递增/递减
2.  获取当前值
3.  创建输出字符串
4.  输出输出字符串

另一个线程可能会在这些操作中的任何一个之间轮流。因此，可能是 Thread_5 做了它所做的事情，然后其他线程开始轮流，并且仅在一段时间后 Thread_5 才输出结果。

如果要按顺序输出新值，则需要在同步块内输出当前值，即。递增/递减方法。**

# python - 函数和返回

> ID：15733435
> 
> 赞同：0
> 
> 时间：2013-03-31T19:14:39.230
> 
> 标签：python, function, return, call

我是 python 新手，我被分配为一家假设的酒店编写发票程序。尝试调用函数以获取其返回值时，我遇到了困难。我真的很难过，我真的可以使用帮助。实现代码将与程序的描述一起跟随，这样就可以知道究竟是什么错误。

```
Invoice 
```

PCCC皇宫酒店

埃迪的帐单

入住天数：2

房费 $675.00

上网费用 $29.85

电视收费 $8.85

总费用 $703.70

地方税 $24.63

```
Total Due   $728.33 
```

感谢您使用 PCCC 皇宫酒店。希望能再次见到你。

要求： • 按照课堂上的说明，在代码中以注释的形式包含相关信息。• 使用不同的函数来处理每个 o 房间类型 o 互联网接入使用 o 电视使用 • 互联网和电视使用可能会被拒绝，在这种情况下，费用将为 0.00 美元 • 所有费率都定义为内部的本地常数功能 • 每个功能都有一个菜单，显示可供选择的选项 • 每个功能返回该选项产生的费用 • 当地税率为 3.5%，定义为当地常数

问题是： Traceback（最近一次通话最后一次）：文件“C：/Python33/hotel.py”，第 28 行，在 print("Room Charges:", roomcost()) NameError: name 'roomcost' is not defined

代码：

```
def main():
input = int , 2
costofinternet = costofinternet
costoftv = costoftv

customername = input("The Customer Name Please: ")
visitdays = input("Enter the Number of Days in the Hotel: ")

room = input("Rooms Used \n1 - Single Room - One Bed \n2 - Family Room - Doulble Bed \n3 -      Suite \n Enter Choice 1, 2, or 3: ") 
```

房间费用（）

```
internet = input("Would You like Internet: ")
if internet == 'Y':
internettype = input("Internet Access Usage \n1 - Wireless \n2 - Wired \nEnter Choices 0, 1, or 2: ")

television = input("Would You like to use the TV: ")
if television == 'Y':
tvtype = input("TV Usage \n1 - Cable \n2 - Basic Channels \nEnter Choice 0, 1, or 2: ")

print("\t\t\t\t\t\t Invoice")
print("\t\tPCCC Palace Hotel")
print(customername, "'s Billing Statement")
print("Number of Days in Hotel: ", visitdays)
print("Room Charges: ", roomcost)
print("Internet Charges: ", costofinternet)
print("Television Charges: ", costoftv)
totalcharge = print("Total Charges: ", roomcost + costofinternet + costoftv)
localtaxes = print("Local Taxes: ", ((roomcost + costofinternet + costoftv) * .035))
print("\t\tTotal Due\t\t\t", totalcharge + localtaxes)
print("\t\tThank You For Using PCCC Palace Hotel. Hope To See You Again.")

def roomcost():
cost = []
if room == '1':
    cost == 225
if room == '2':
    cost == 325
if room == '3':
    cost == 550
return(cost)

def internet():
costofinternet = []
if internettype == '0':
    costofinternet == 0
if internettype == '1':
    costofinternet == 9.95
if internettype == '2':
    costofinternet == 5.95
return(costofinternet)

def tv():
costoftv = []
if tvtype == '0':
    costoftv == 0
if tvtype == '1':
    costoftv == 9.95
if tvtype == '2':
    costoftv == 2.95
return(costoftv) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:21:15.007

roomcost 是一个函数，因此您需要使用 () 运算符以及其他函数调用来调用它：

```
print("Room Charges: ", roomcost())
print("Internet Charges: ", costofinternet())
print("Television Charges: ", costoftv()) 
```

# highcharts - 网格/Highcharts 中的视觉错误

> ID：15733437
> 
> 赞同：0
> 
> 时间：2013-03-31T19:14:45.947
> 
> 标签：highcharts

在此示例中，隐藏所有系列，然后显示最后一个系列 (Serie3)：网格显示错误。

[http://jsfiddle.net/fernandoherlo/4bEuL/5/](http://jsfiddle.net/fernandoherlo/4bEuL/5/)

`<div id="graf" style="min-width: 400px; height: 600px; margin: 0 auto"></div>` 但是如果我改变 div 容器的 高度： `<div id="graf" style="min-width: 400px; height: 400px; margin: 0 auto"></div>`

然后工作正常！

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T07:44:31.073

当左侧 y 轴不再绘制任何数字时，这看起来像是重绘图表的错误，这会改变其宽度。您可以通过设置最小值和最大值来解决此问题，即使该轴没有显示系列，也会强制它显示轴标签

```
yAxis: [{
        minorTickInterval: 'auto',
        min: 0,
        max:3100,
    }, { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T11:32:30.917

它看起来像一个错误，所以我在这里向我们的开发人员报告：[https ://github.com/highslide-software/highcharts.com/issues/1667](https://github.com/highslide-software/highcharts.com/issues/1667)

# php - 从 MySQL 数据库中选择单个字段以比较变量

> ID：15733441
> 
> 赞同：0
> 
> 时间：2013-03-31T19:15:30.907
> 
> 标签：php, mysql

我需要从数据库中的“groups”表中获取“groupLeader”字段并将其存储在一个变量中，然后与当前登录的用户名进行比较，但出现错误：

> 警告：mysql_numrows() 期望参数 1 是资源，在第 31 行的 /home/content/00/7923300/html/uber/tasks.php 中给出的对象

我目前拥有的代码是这样的：

```
$sq = "SELECT * FROM groups WHERE groupID='".$groupID."'";
$result=$db->query($sq);
$num=mysql_numrows($result);
$i=0;
while ($i < $num) {
    $gLeader=  mysql_result($result, $i, 'groupLeader');
    $i++;
}
if($_COOKIE['$username'] == $gLeader) {
    echo "User is leader.";
} 
```

如果这看起来是一个相当简单的要求，请原谅我。我是 php 新手并使用数据库。

编辑：忘了提到第 31 行是包含

```
$num=mysql_numrows($result); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:19:41.310

您可能需要使用 PHP 的 mysql_query 或您的框架行号方法。

```
 $result = mysql_query($sq); 
```

也许

```
 $db->number_of_rows($sq); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T19:21:41.230

这里的问题是，由于未知原因，查询没有正确执行。这就是为什么它将***False***返回到`$result`，这实际上不是资源。

利用：

```
$sq = "SELECT * FROM groups WHERE groupID='".$groupID."'";
$result = mysqli_query($connection, $sq); 
```

或者

```
$result = mysql_query($sq); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T19:23:14.580

大部分代码都是多余且毫无意义的。如果您想要的只是单行中的单个字段，则不要这样做`SELECT *`，也不要使用循环。

```
$sql = "SELECT groupLeader FROM ..."
$result = mysql_query($sql) or die(mysql_error());
if (mysql_num_rows($result) > 0) {
   $row = mysql_fetch_assoc($reuslt);
   if ($row['groupLeader'] == $_COOKIE['username']) {
       ...
   }
} 
```

但是，请注意 mysql_*() 函数复合体在 PHP 中已正式弃用，不应再使用。考虑改用 mysqli，这通常是兼容的，或者更好的是，改用 PDO。

# java - 使用 libGDX 绘制填充多边形

> ID：15733442
> 
> 赞同：8
> 
> 时间：2013-03-31T19:15:34.250
> 
> 标签：java, libgdx

我想用 libGDX 绘制一些（填充的）多边形。它不应该填充图形/纹理。我只有多边形的顶点（闭合路径）并尝试使用网格进行可视化，但在某些时候这不是最好的解决方案，我认为。

我的矩形代码是：

```
private Mesh mesh;

@Override
public void create() {
    if (mesh == null) {
        mesh = new Mesh(
            true, 4, 0, 
            new VertexAttribute(Usage.Position, 3, "a_position")
        );
        mesh.setVertices(new float[] { 
            -0.5f, -0.5f, 0
            0.5f, -0.5f, 0,
            -0.5f, 0.5f, 0,
            0.5f, 0.5f, 0 
        });     
    }
}

// ...

@Override
public void render() {
    Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT);
    mesh.render(GL10.GL_TRIANGLE_STRIP, 0, 4);
} 
```

有没有更简单的方法来绘制填充多边形的功能或东西？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2014-09-06T17:05:08.787

由于最近更新了 LibGDX，@Rus 答案正在使用已弃用的函数。但是，我对他/她的以下新更新版本表示赞赏：

```
PolygonSprite poly;
PolygonSpriteBatch polyBatch = new PolygonSpriteBatch(); // To assign at the beginning
Texture textureSolid;

// Creating the color filling (but textures would work the same way)
Pixmap pix = new Pixmap(1, 1, Pixmap.Format.RGBA8888);
pix.setColor(0xDEADBEFF); // DE is red, AD is green and BE is blue.
pix.fill();
textureSolid = new Texture(pix);
PolygonRegion polyReg = new PolygonRegion(new TextureRegion(textureSolid),
  new float[] {      // Four vertices
    0, 0,            // Vertex 0         3--2
    100, 0,          // Vertex 1         | /|
    100, 100,        // Vertex 2         |/ |
    0, 100           // Vertex 3         0--1
}, new short[] {
    0, 1, 2,         // Two triangles using vertex indices.
    0, 2, 3          // Take care of the counter-clockwise direction. 
});
poly = new PolygonSprite(polyReg);
poly.setOrigin(a, b);
polyBatch = new PolygonSpriteBatch(); 
```

如果您的多边形不是凸面，则对于良好的三角测量算法，请参阅 Toussaint (1991) 的几乎线性耳夹算法

> [简单多边形的高效三角剖分，Godfried Toussaint，1991](http://scholar.google.ch/scholar?hl=fr&q=Efficient%20triangulation%20of%20simple%20polygons%2C%20Godfried%20Toussaint%2C%201991&btnG=&lr=)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-12T15:31:21.040

这是一个绘制 2D 凹多边形的 libGDX 示例。

定义类成员`PolygonSprite` `PolygonSpriteBatch`

```
PolygonSprite poly;
PolygonSpriteBatch polyBatch;
Texture textureSolid; 
```

创建实例，使用红色像素作为解决方法的 1x1 大小的纹理。坐标数组 (x, y) 用于多边形的初始化。

```
ctor() {
    textureSolid = makeTextureBox(1, 0xFFFF0000, 0, 0); 
    float a = 100;
    float b = 100;
    PolygonRegion polyReg = new PolygonRegion(new TextureRegion(textureSolid),
      new float[] {
        a*0, b*0,
        a*0, b*2,
        a*3, b*2,
        a*3, b*0,
        a*2, b*0,
        a*2, b*1,
        a*1, b*1,
        a*1, b*0,
    });
    poly = new PolygonSprite(polyReg);
    poly.setOrigin(a, b);
    polyBatch = new PolygonSpriteBatch();
} 
```

绘制和旋转多边形

```
void draw() {
    super.draw();
    polyBatch.begin();
    poly.draw(polyBatch);
    polyBatch.end();
    poly.rotate(1.1f);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-19T01:28:29.933

我相信这个`ShapeRenderer`类现在有一个用于顶点定义多边形的多边形方法：

[`ShapeRenderer.polygon()`](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/glutils/ShapeRenderer.html#polygon%28float%5B%5D%29)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-01T04:48:07.843

您可以使用[API通过 Libgdx 绘制简单](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/glutils/ShapeRenderer.html)[的`ShapeRenderer`](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/glutils/ShapeRenderer.html)纯色形状。

您给出的代码也是绘制纯色多边形的合理方法。它比 灵活得多`ShapeRenderer`，但要复杂得多。您需要使用`glColor4f`设置颜色，或`Usage.Color`为每个顶点添加属性。有关第一种方法的更多详细信息，请参见[SubMeshColorTest 示例](https://code.google.com/p/libgdx-users/source/browse/demos-3-tier-main/src/com/gdxuser/demos/SubMeshColorTest.java?r=789be290e6a786b47ea1801205db7b29dddc9c8e)[，](https://code.google.com/p/libgdx/wiki/MeshColorTexture)有关第二种方法的详细信息，请参见 MeshColorTexture 示例。

另一个需要考虑的选择是使用精灵纹理。如果您只对简单的纯色对象感兴趣，您可以使用非常简单的单一颜色的 1x1 纹理，并让系统将其拉伸到整个精灵。许多 Libgdx 和底层硬件都针对渲染纹理进行了优化，因此即使您没有真正利用纹理内容，您也会发现它更易于使用。（您甚至可以使用 1x1 白色纹理，然后使用[`SpriteBatch`](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g2d/SpriteBatch.html)with[`setColor`](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g2d/SpriteBatch.html#setColor%28com.badlogic.gdx.graphics.Color%29)和[`draw()`](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/g2d/SpriteBatch.html#draw%28com.badlogic.gdx.graphics.Texture,%20float,%20float,%20float,%20float%29) 轻松绘制不同颜色的矩形。）

您也可以混合和匹配各种方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-25T18:54:15.460

使用三角测量算法，然后将所有三角形绘制为 GL_TRIANGLE_STRIP [http://www.personal.psu.edu/cxc11/AERSP560/DELAUNEY/13_Two_algorithms_Delauney.pdf](http://www.personal.psu.edu/cxc11/AERSP560/DELAUNEY/13_Two_algorithms_Delauney.pdf)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-09-21T19:30:15.807

只是想与您分享我的相关解决方案，即**使用 scene2d 实现和绘制 walkZone**。我基本上不得不把其他人帖子的不同建议放在一起：

**1) 步行区：**

```
import com.badlogic.gdx.graphics.Pixmap;
import com.badlogic.gdx.graphics.Texture;
import com.badlogic.gdx.graphics.g2d.PolygonRegion;
import com.badlogic.gdx.graphics.g2d.TextureRegion;
import com.badlogic.gdx.math.EarClippingTriangulator;
import com.badlogic.gdx.math.Polygon;
import com.mygdx.game.MyGame;

public class WalkZone extends Polygon {
private PolygonRegion polygonRegion = null;
public WalkZone(float[] vertices) {
    super(vertices);
    if (MyGame.DEBUG) {
        Pixmap pix = new Pixmap(1, 1, Pixmap.Format.RGBA8888);
        pix.setColor(0x00FF00AA);
        pix.fill();
        polygonRegion = new PolygonRegion(new TextureRegion(new Texture(pix)),
                vertices, new EarClippingTriangulator().computeTriangles(vertices).toArray());
        }
    }

    public PolygonRegion getPolygonRegion() {
        return polygonRegion;
    }
} 
```

**2) `Screen`:**

然后，您可以在所需的位置添加一个侦听器`Stage`：

```
myStage.addListener(new InputListener() {
        @Override
        public boolean touchDown(InputEvent event, float x, float y, int pointer, int button) {
            if (walkZone.contains(x, y)) player.walkTo(x, y);
            // or even directly: player.addAction(moveTo ...
            return super.touchDown(event, x, y, pointer, button);
        }
    }); 
```

**3) 实施：**

传递给 te WZ 构造函数的数组是一组 x,y,x,y... 点。如果你逆时针放置它们，它可以工作（我没有检查其他方式，也不知道它是如何工作的）；例如，这会生成一个 100x100 的正方形：

```
yourScreen.walkZone = new WalkZone(new int[]{0, 0, 100, 0, 100, 100, 0, 100}); 
```

在我的项目中，它就像一个魅力，即使是非常复杂的多边形。希望能帮助到你！！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-29T19:47:45.947

大多数答案都建议进行三角测量，这很好，但您也可以使用模板缓冲区来完成。它处理凸多边形和凹多边形。如果您的多边形变化很大，这可能是一个更好的解决方案，因为否则您必须每帧都进行三角测量。此外，此解决方案可以正确处理自相交的多边形，但`EarClippingTriangulator`事实并非如此。

```
FloatArray vertices = ... // The polygon x,y pairs.
Color color = ... // The color to draw the polygon.

ShapeRenderer shapes = ...
ImmediateModeRenderer renderer = shapes.getRenderer();

Gdx.gl.glClearStencil(0);
Gdx.gl.glClear(GL20.GL_STENCIL_BUFFER_BIT);
Gdx.gl.glEnable(GL20.GL_STENCIL_TEST);
Gdx.gl.glStencilFunc(GL20.GL_NEVER, 0, 1);
Gdx.gl.glStencilOp(GL20.GL_INVERT, GL20.GL_INVERT, GL20.GL_INVERT);
Gdx.gl.glColorMask(false, false, false, false);

renderer.begin(shapes.getProjectionMatrix(), GL20.GL_TRIANGLE_FAN);
renderer.vertex(vertices.get(0), vertices.get(1), 0);
for (int i = 2, n = vertices.size; i < n; i += 2)
    renderer.vertex(vertices.get(i), vertices.get(i + 1), 0);
renderer.end();

Gdx.gl.glColorMask(true, true, true, true);
Gdx.gl.glStencilOp(GL20.GL_ZERO, GL20.GL_ZERO, GL20.GL_ZERO);
Gdx.gl.glStencilFunc(GL20.GL_EQUAL, 1, 1);

Gdx.gl.glEnable(GL20.GL_BLEND);
shapes.setColor(color);
shapes.begin(ShapeType.Filled);
shapes.rect(-9999999, -9999999, 9999999 * 2, 9999999 * 2);
shapes.end();

Gdx.gl.glDisable(GL20.GL_STENCIL_TEST); 
```

要使用模板缓冲区，您必须在应用启动时指定模板缓冲区的位数。例如，这里是使用 LWJGL2 后端的方法：

```
 LwjglApplicationConfiguration config = new LwjglApplicationConfiguration();
    config.stencil = 8;
    new LwjglApplication(new YourApp(), config); 
```

有关此技术的更多信息，请尝试以下链接之一：

*   [http://commaexcess.com/articles/7/concave-polygon-triangulation-shortcut](http://commaexcess.com/articles/7/concave-polygon-triangulation-shortcut)
*   [http://glprogramming.com/red/chapter14.html#name13](http://glprogramming.com/red/chapter14.html#name13)
*   [http://what-when-how.com/opengl-programming-guide/drawing-filled-concave-polygons-using-the-stencil-buffer-opengl-programming/](http://what-when-how.com/opengl-programming-guide/drawing-filled-concave-polygons-using-the-stencil-buffer-opengl-programming/)

# c# - 保留 TreeNode 参考可以吗？

> ID：15733443
> 
> 赞同：1
> 
> 时间：2013-03-31T19:15:42.920
> 
> 标签：c#, .net, winforms, treeview

默认情况下，当在 TreeViews 中以设计器模式创建 TreeNodes 时，Visual Studio 不会在类级别保留对 TreeNodes 的引用。

我发现对于一些我经常访问的节点，引用它们比通过它们的 Name 属性访问它们要容易得多，因为它更容易键入。

但是，我想知道这种方法是否有一些缺点？就我而言，只要应用程序仍在运行，这些 TreeNodes 就会保持活动状态，所以我的猜测是保持这样的引用不会造成伤害，但只是检查一下，有趣的是我找不到任何类似的问题或文本......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:20:20.363

我认为您可以保留参考资料而不会出现任何问题。记住一旦它们过时就更新参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T19:21:32.893

从技术上讲，它保留对每个节点的引用，否则您将根本无法访问它们，它们将被垃圾收集。如果您计划调用节点而不是其他节点，我想创建另一个引用是可以的。然后，您将有 2 个对该节点的引用。

# android - 通过蓝牙发送序列化对象时出现 StreamCorruptedException

> ID：15733449
> 
> 赞同：3
> 
> 时间：2013-03-31T19:16:10.580
> 
> 标签：android, bluetooth, inputstream, outputstream, serializable

我有一个序列化类，我需要通过蓝牙作为对象发送，并且还实现了 Runnable。因此，我首先设置了一些变量，然后将其作为对象发送给另一台 Android 设备执行，然后将其结果设置为变量，并将结果发送回其中一个变量中的相同对象。我一直在使用以下两种方法来序列化我的对象并在通过我的 BluetoothSocket 的 OutputStream 发送它们之前获取一个 ByteArray，并反序列化该 ByteArray 以取回我的对象​​。

```
public static byte[] serializeObject(Object o) throws IOException { 
    ByteArrayOutputStream bos = new ByteArrayOutputStream(); 

    ObjectOutput out = new ObjectOutputStream(bos);
    out.writeObject(o);  
    out.flush();
    out.close();

    // Get the bytes of the serialized object 
    byte[] buf = bos.toByteArray(); 

    return buf; 
} 

public static Object deserializeObject(byte[] b) throws OptionalDataException, ClassNotFoundException, IOException { 
    ByteArrayInputStream bis = new ByteArrayInputStream(b);

    ObjectInputStream in = new ObjectInputStream(bis); 
    Object object = in.readObject(); 
    in.close(); 

    return object; 
} 
```

我仍然从这两种方法中得到相同的错误，所以我尝试将它与我用来通过 BluetoothSocket 的 OutputStream 发送我的 ByteArray 的方法合并，如下所示。

```
public void sendObject(Object obj) throws IOException{
    ByteArrayOutputStream bos = new ByteArrayOutputStream() ; 
    ObjectOutputStream out = new ObjectOutputStream( bos );
    out.writeObject(obj); 
    out.flush();
    out.close();

    byte[] buf = bos.toByteArray();
    sendByteArray(buf);
}
public void sendByteArray(byte[] buffer, int offset, int count) throws IOException{
    bluetoothSocket.getOutputStream().write(buffer, offset, count);
}

public Object getObject() throws IOException, ClassNotFoundException{
    byte[] buffer = new byte[10240];
    Object obj = null;
    if(bluetoothSocket.getInputStream().available() > 0){
        bluetoothSocket.getInputStream().read(buffer);

        ByteArrayInputStream b = new ByteArrayInputStream(buffer);
        ObjectInputStream o = new ObjectInputStream(b);
        obj = o.readObject();
    }
    return obj;
} 
```

最后，在接收设备上反序列化对象时，我得到了同样的错误，如下所示。

```
java.io.StreamCorruptedException
at java.io.ObjectInputStream.readStreamHeader (ObjectInputStream.java:2102)
at java.io.ObjectInputStream.<init>(ObjectInputStream.java:372)
and so on... 
```

有人可以帮忙吗？我很绝望，这已经让我死了好几个星期，我需要几天后才能工作。:S

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T06:52:38.373

根据[这个](https://forums.oracle.com/forums/thread.jspa?threadID=1149812&tstart=45&start=0)和 [这个](https://stackoverflow.com/questions/2393179/streamcorruptedexception-invalid-type-code-ac)线程：

您应该在套接字的整个生命周期内使用 single`ObjectOutputStream`和`ObjectInputStream` ，并且不要在套接字上使用任何其他流。

其次，用于`ObjectOutputStream.reset()`清除以前的值。

让我知道这个是否奏效 ！

# scala - Play 2.0 forkjoin 线程数高

> ID：15733450
> 
> 赞同：1
> 
> 时间：2013-03-31T19:16:10.977
> 
> 标签：scala, asynchronous, playframework-2.0

我目前正在评估异步场景中的 play 2.0 框架。我做了如下实验：

```
def test = Action {
  val futureResponse: Future[play.libs.WS.Response] = scala.concurrent.Future {
    val remoteCall = WS.url("http://127.0.0.1:8080/slowweb/SlowServlet1").get();
    remoteCall.get(); 
  }
  Async {
    futureResponse.map(response => Ok("Got result: " + response.getBody()))
  }
} 
```

“:8080/slowweb/SlowServlet1”是模拟慢速web服务调用，需要2s才能返回。

然后我对端点“：9000/test”运行jmeter。我观察到以下行为：如果我在 jmeter 中运行 50 个线程，则 forkjoin 池大小为 50；如果我在 jmeter 中运行 200 个线程，则 forkjoin 池大小为 200。

在我看来，线程池大小与并发请求大小相同。我期望的是，如果使用异步方法，线程池的大小应该会小得多。

我做错了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:26:46.820

我不知道它是否与您的错误有关，但您的代码可以简化为：

```
def test = Action {
   Async {
     val futureResponse: Future[play.libs.WS.Response] = 
        WS.url("http://127.0.0.1:8080/slowweb/SlowServlet1").get();

     futureResponse.map(response => Ok("Got result: " + response.getBody()))
   }
} 
```

# php - 从数据库中填充选择字段

> ID：15733454
> 
> 赞同：3
> 
> 时间：2013-03-31T19:16:51.770
> 
> 标签：php, database, loops, select, echo

我正在尝试`select`用 PHP 填充一个字段。问题是我无法弄清楚如何显示它们，因为我得到了数据库中值匹配的那个出现两次，因为我将它作为选定的回显，然后循环它所有的结果。如何只显示`selected`与字段值匹配的字段值，然后显示所有与所选字段值不匹配的字段？

**表类别**

```
cat_id  cat_name
1       soccer
2       baseball
3       basketball 
```

**表文章**

```
art_id art_cat_id
1      1 
```

**PHP/HTML**

```
<select name="category">
<?php
    $sql = "SELECT cat_id cat_name, art_id, art_cat_id 
            FROM categories LEFT JOIN articles
            ON categories.cat_id = articles.art_cat_id
            WHERE art_id = 1";
    $result = query($sql);

    if($result===false) {
        echo("Query Fail");
    }
    else {
        ?>
        <option value="<?php echo $data['art_cat_id'] ?>" selected="selected"><?php echo $data['cat_name'] ?></option>
        <?php
        while( $data = mysqli_fetch_array($result)) {

        ?>     
        <option value="<?php echo $data['cat_id'] ?>"><?php echo $data['cat_name'] ?></option>
        <?php
        }
    }
    ?>
</select> 
```

**它返回了什么**

```
<select name="category">
    <option value="1" selected="selected">soccer</option>
    <option value="1">soccer</option>
    <option value="2">baseball</option>
    <option value="3">basketball</option>
</select> 
```

**我在寻找什么**

```
<select name="category">
    <option value="1" selected="selected">soccer</option>
    <option value="2">baseball</option>
    <option value="3">basketball</option>
</select> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T19:25:09.707

如果值与第一个匹配，则跳过该行。

一个片段：

```
 ?>
    <option value="<?php echo $data['art_cat_id'] ?>" selected="selected"><?php echo $data['cat_name'] ?></option>
    <?php
    while( $data = mysqli_fetch_array($result)) {
        if ($data['art_cat_id'] == $data['cat_id']) continue;
    ?>     
    <option value="<?php echo $data['cat_id'] ?>"><?php echo $data['cat_name'] ?></option>
    <?php
    } 
```

# php - 简单的 MySQL 查询 16 秒长

> ID：15733455
> 
> 赞同：0
> 
> 时间：2013-03-31T19:16:58.663
> 
> 标签：php, mysql, linux

我正在运行一个 8gb 内存、四核、SSD 云服务器。

根据 New Relic 的说法，大多数数据库查询速度很快，但一个查询只更新一列一行最多需要 16 秒。

我的查询是：

```
UPDATE user SET ad=$currentAdSet WHERE ckey='$_COOKIE[ckey]' 
```

我正在使用`mysql_query("")`php 函数来执行查询。

Mu`user`表大约有 43000 行，结构简单。

为什么这个查询需要这么长时间？有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T19:18:26.970

尝试添加索引`ckey`并再次检查时间。我会建议一些关于索引的阅读。

顺便说一句，直接使用 cookie 值可能会导致 SQL 注入

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-31T19:19:19.093

您可以尝试使用`EXPLAIN`. 然后，根据您看到的瓶颈，使用索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T19:26:46.070

确保**ckey**已编入索引，如果不需要，**广告**未编入索引。

第一个将允许更快地选择记录，第二个更快的更新

希望这可以帮助

# ruby-on-rails - 与 sql 相比，rails 范围慢

> ID：15733457
> 
> 赞同：1
> 
> 时间：2013-03-31T19:17:02.740
> 
> 标签：ruby-on-rails, scopes

我使用 find_by_sql 并在一秒钟内给我回复：

```
Report.find_by_sql("SELECT min(reports.time) FROM reports WHERE unit_id = '#{Unit.find(3007).id}' AND driver_id = '#{Driver.find(2).id}' AND time >= '#{beginning}' AND time <= '#{ending}'")
  Unit Load (111.1ms)  SELECT "units".* FROM "units" WHERE "units"."id" = $1 LIMIT 1  [["id", 3007]]
  Driver Load (98.0ms)  SELECT "drivers".* FROM "drivers" WHERE "drivers"."id" = $1 LIMIT 1  [["id", 2]]
  Report Load (59.6ms)  SELECT min(reports.time) FROM reports WHERE unit_id = '3007' AND driver_id = '2' AND time >= '2013-03-01 00:00:00 UTC
' AND time <= '2013-03-31 23:59:59 UTC'
 => [#<Report >] 
```

然后我尝试使用具有 activerecord 关系方法的范围来构建相同的查询：

```
 scope :start_driver_time, lambda { |unit, driver, start_time, end_time|
    where("unit_id = ? AND
          driver_id = ? AND        
          time >= ? AND
          time <= ?",
          unit.id, driver.id, start_time, end_time)
    .order("time asc")
    .minimum(:time)
  }

1.9.3p0 :012 > Report.start_driver_time(Unit.find(3007), Driver.find(2), beginning, ending)
  Unit Load (48.4ms)  SELECT "units".* FROM "units" WHERE "units"."id" = $1 LIMIT 1  [["id", 3007]]
  Driver Load (46.5ms)  SELECT "drivers".* FROM "drivers" WHERE "drivers"."id" = $1 LIMIT 1  [["id", 2]]
   (49.3ms)  SELECT MIN("reports"."time") AS min_id FROM "reports" WHERE (unit_id = 3007 AND
 driver_id = 2 AND 
 time >= '2013-03-01 00:00:00.000000' AND
 time <= '2013-03-31 23:59:59.999999') 
```

但 45 分钟后查询仍在运行。

当我按下 control + c 这是输出：

```
^C  Report Load (30484.0ms)  SELECT "reports".* FROM "reports" 
ActiveRecord::StatementInvalid: IRB::Abort: abort then interrupt!: SELECT "reports".* FROM "reports" 
    from /Users/johnmerlino/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb.rb:88:in `irb_abort'
    from /Users/johnmerlino/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb.rb:257:in `signal_handle'
    from /Users/johnmerlino/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb.rb:65:in `block in start'
    from /Users/johnmerlino/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.5/lib/active_record/connection_adapters/postgresql_adapter.rb:1151:in `call'
    from /Users/johnmerlino/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.5/lib/active_record/connection_adapters/postgresql_adapter.rb:1151:in `async_exec'
    from /Users/johnmerlino/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.5/lib/active_record/connection_adapters/postgresql_adapter.rb:1151:in `exec_no_cache'
    from /Users/johnmerlino/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.5/lib/active_record/connection_adapters/postgresql_adapter.rb:664:in `block in exec_query'
    from /Users/johnmerlino/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.5/lib/active_record/connection_adapters/abstract_adapter.rb:280:in `block in log'
    from /Users/johnmerlino/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.2.5/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
    from /Users/johnmerlino/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.5/lib/active_record/connection_adapters/abstract_adapter.rb:275:in `log'
    from /Users/johnmerlino/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.5/lib/active_record/connection_adapters/postgresql_adapter.rb:663:in `exec_query'
    from /Users/johnmerlino/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.5/lib/active_record/connection_adapters/postgresql_adapter.rb:1246:in `select'
    from /Users/johnmerlino/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.5/lib/active_record/connection_adapters/abstract/database_statements.rb:18:in `select_all'
    from /Users/johnmerlino/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.5/lib/active_record/connection_adapters/abstract/query_cache.rb:63:in `select_all'
    from /Users/johnmerlino/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.5/lib/active_record/querying.rb:38:in `block in find_by_sql'
    from /Users/johnmerlino/.rvm/gems/ruby-1.9.3-p0/gems/activerecord-3.2.5/lib/active_record/explain.rb:40:in `logging_query_plan'
... 12 levels...
    from /Users/johnmerlino/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb.rb:273:in `signal_status'
    from /Users/johnmerlino/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb.rb:156:in `block in eval_input'
    from /Users/johnmerlino/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb/ruby-lex.rb:243:in `block (2 levels) in each_top_level_statement'
    from /Users/johnmerlino/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb/ruby-lex.rb:229:in `loop'
    from /Users/johnmerlino/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb/ruby-lex.rb:229:in `block in each_top_level_statement'
    from /Users/johnmerlino/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb/ruby-lex.rb:228:in `catch'
    from /Users/johnmerlino/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb/ruby-lex.rb:228:in `each_top_level_statement'
    from /Users/johnmerlino/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb.rb:155:in `eval_input'
    from /Users/johnmerlino/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb.rb:70:in `block in start'
    from /Users/johnmerlino/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb.rb:69:in `catch'
    from /Users/johnmerlino/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/irb.rb:69:in `start'
    from /Users/johnmerlino/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.5/lib/rails/commands/console.rb:47:in `start'
    from /Users/johnmerlino/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.5/lib/rails/commands/console.rb:8:in `start'
    from /Users/johnmerlino/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.2.5/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>'Maybe IRB bug! 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:59:12.887

我认为范围通常意味着返回模型的自定义子集/连接，这可能会导致`SELECT "reports".* FROM "reports"`其他人完成后的查询。由于看起来您使用的是 Rails 3 或更高版本，因此我将使用类方法替换范围（[Rails 指南](http://guides.rubyonrails.org/active_record_querying.html#scopes)说“使用类方法是接受范围参数的首选方法。”）。

# java - 使用 JRadioButtons 或 JCheckBoxes 时 JMenu 消失

> ID：15733458
> 
> 赞同：2
> 
> 时间：2013-03-31T19:17:09.767
> 
> 标签：java, swing, jcheckbox, jradiobutton, jmenubar

我创建了一个带有 Pizza JMenu 的 JMenuBar。JMenu 有 3 个 JRadioButtons 和 2 个 JCheckBoxes，它们会在 menuItems 滚动时出现。问题是当我单击 JRadioButton 或 JCheckBox 时，整个菜单都会消失。是否有特定的方法或任何其他方式可以阻止这种情况发生？

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

public class MenuExamplePizza extends JFrame
{
    private JMenuBar menuBar;
    private JMenu menu, sizeMenu, extrasMenu, helpMenu;
    private JMenuItem menuItem;private JRadioButtonMenuItem smallrbMenuItem, medrbMenuItem, largerbMenuItem;
    private JCheckBoxMenuItem peppchMenuItem, anchMenuItem;

public MenuExamplePizza()                                                               // Default Constructor
{
   menuBar = new JMenuBar();                                                                        //Create the menu bar

    menu = new JMenu("Pizza");                                                                      //Build the first menu
    menu.setMnemonic('P');
    menu.getAccessibleContext().setAccessibleDescription("The only menu in this program that has menu items");
    menuBar.add(menu);

    menuItem = new JMenuItem("Total");
    menuItem.setMnemonic('T');
    menuItem.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_T, ActionEvent.CTRL_MASK));
    menuItem.getAccessibleContext().setAccessibleDescription("This doesn't really do anything");
    menu.add(menuItem);
    menu.addSeparator();

    sizeMenu = new JMenu("Size");
    sizeMenu.setMnemonic('S');
    ButtonGroup group = new ButtonGroup();
    smallrbMenuItem = new JRadioButtonMenuItem("Small");
    group.add(smallrbMenuItem);
    sizeMenu.add(smallrbMenuItem);
    medrbMenuItem = new JRadioButtonMenuItem("Medium");
    group.add(medrbMenuItem);
    sizeMenu.add(medrbMenuItem);
    largerbMenuItem = new JRadioButtonMenuItem("Large");
    group.add(largerbMenuItem);
    sizeMenu.add(largerbMenuItem);
    menu.add(sizeMenu);

    extrasMenu = new JMenu("Extras");
    extrasMenu.setMnemonic('E');
    peppchMenuItem = new JCheckBoxMenuItem("Pepperoni");
    extrasMenu.add(peppchMenuItem);
    anchMenuItem = new JCheckBoxMenuItem("Anchovies");
    extrasMenu.add(anchMenuItem);
    menu.add(extrasMenu);

    menu.addSeparator();                                                                        // a group of radio button menu items                                                                       

    menuItem = new JMenuItem("Exit");
    menuItem.setMnemonic('x');
    menuItem.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_X, ActionEvent.CTRL_MASK));
    menuItem.getAccessibleContext().setAccessibleDescription("This doesn't really do anything");
    menu.add(menuItem);

    helpMenu = new JMenu("Help");                                                           //Build second menu in the menu bar.

    menuBar.add(menu);
    menuBar.add(helpMenu);
    add(menuBar);
    setJMenuBar(menuBar);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T20:25:38.720

查看[保持菜单打开](http://tips4java.wordpress.com/2010/09/12/keeping-menus-open/)，看看它是否符合您的要求。

# jquery - 使用 jQuery 选择动态创建的元素

> ID：15733459
> 
> 赞同：4
> 
> 时间：2013-03-31T19:17:10.113
> 
> 标签：jquery, html, getjson

试图解决这个问题，我想我知道问题所在，但我不知道如何解决它。当我的页面首次加载时，我使用 JSON 文件在页面上提供一些链接，使用 $.getJSON 动态创建它们并为它们提供 ID。我的代码是（这只是我现在感兴趣的一点，我当然关闭了函数）：

```
 $(function() {

        $.getJSON("data.json", function(data) {
            var navOutput = "";
            for (var key in data.navigation) {
                navOutput += '<li><a id="' + key + '">' + data.navigation[key] + '</a></li>'; // Create list items with ID 'key'
            }
            $("#mainNav").html(navOutput); 
```

页面上的一切都很好。在 $.getJSON 函数之外，我试图将事件侦听器分配给其中一个动态创建的 ID，例如：

```
$("#cast").click(function() {
    alert("Testing");
}); //click function 
```

这似乎不起作用。对此可能有一个简单的答案，但我无法弄清楚。如果我将事件处理程序分配给在 HTML 中创建的页面上的 ID，它会起作用，因此它与这些动态 ID 有关。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-31T19:19:43.443

改变

```
$("#cast").click(function() {
    alert("Testing");
}); 
```

到

```
$("body").on("click","#cast",function(e) {
    alert("Testing");
}); 
```

您需要使用`on`而不是设置处理程序`click`。它的进步`live()`。它允许您将处理程序附加到动态加载的元素。`click`将仅在 dom 就绪时附加，即最初加载页面时。

# java - 如何在java中更改输入对话框的大小？

> ID：15733462
> 
> 赞同：-1
> 
> 时间：2013-03-31T19:17:37.147
> 
> 标签：java

我想更改输入对话框的大小及其位置。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:22:28.467

答案与任何 Swing GUI 相同：

*   使用使用适当布局并且可以覆盖的 JPanel 填充您的 JDialog 或 JOptionPane `getPreferredSize()`。
*   位置可以通过`setLocation(...)`或`setLocationRelativeTo(...)`,
*   all 在调用之前调用`pack()`（如果是 JDialog）和`setVisible(true)`.

# matlab - 使用 datenum 导致不显示两个字符串

> ID：15733463
> 
> 赞同：0
> 
> 时间：2013-03-31T19:17:40.380
> 
> 标签：matlab

**1.如何正确读取此数据以便正确解析日期？** 我正在尝试连接从文件中读取的字符串，但我得到的输出混淆了。输出是 x 轴。此外，x 轴的间距有数字而不是我想要的字符串。该文件有 4 列，日期、时间、温度和值。日期为“01.01.2013”​​，时间为“09:08:02”

另外，如果我只想使用第一列（带日期），我该怎么做？因为使用 datenum(mydata{1}) 结果“无法解析日期 01.01.2013”

```
...
mydata = textscan(fid, '%s %s %f %f', 'delimiter',';', 'HeaderLines',1);
date={};
temp={};
..
date{1}=datenum( strcat(mydata{1},{' '},mydata{2}) );
... 
```

**2\. 如何校正坐标轴刻度？**

然后我尝试使用 plotyy 绘制数据并希望 x 轴成为日期，但我得到了两个不同的轴标签。

这是我正在使用的代码：

```
temp = mydata{4};
plotyy(date,temp,date,2*temp);
datetick('x','mmm.dd,yyyy'); 
```

这是生成的图像：

![在此处输入图像描述](https://i.stack.imgur.com/tpYGR.png)

- - - - - - - -更新 - - - - - - - - - - - - - - - - - -----

这是代码：

```
fid = fopen('test2.txt','r');
mydata = textscan(fid, '%s %s %f %f', 'delimiter',';', 'HeaderLines',1);
fclose(fid);

date=datenum( strcat(mydata{1},{' '},mydata{2}),'mmm.dd,yyyy HH:MM:SS' );
temperature=mydata{3};
value=mydata{4};

[AX,H1,H2]=plotyy(date,temperature,date,value,'plot'); 
set(get(AX(1),'Ylabel'),'String','Temperatures');
set(get(AX(2),'Ylabel'),'String','Value');

set(H1,'LineStyle','--');
set(H2,'LineStyle',':');
datetick(AX(1),'x','mmm.dd,yyyy');

title('Temperatures - Values');
xlabel('Date') 
```

和文件

```
Date;Time;Temp;value
Jan.01,2013; 11:00:00;20;10                         
Feb.08,2013; 12:00:00;23;11
Mar.04,2013; 04:02:00;24;15
Apr.10,2013; 08:04:00;28;20
May.10,2013; 12:05:00;32;30
Jun.04,2013; 10:06:0;33;27 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T22:12:38.693

**1.解析输入**

您收到“无法解析”错误，因为您也没有包含格式字符串 (formatIn)。请参阅[datenum](http://www.mathworks.com/help/matlab/ref/datenum.html)的文档。

如果您只想将第一列转换为日期，则如下所示：

```
date=datenum(mydata{1},'mm.dd.yyyy'); 
```

如果要转换第一列和第二列，请尝试：

```
 date=datenum( strcat(mydata{1},{' '},mydata{2}),'mm.dd.yyyy HH:MM:SS'); 
```

这是我正在运行的整个代码，它似乎有效。请注意，我的数据文件中没有标题行。

```
% data.txt
% 01.01,2013; 11:00:47;10;20
% 01.02,2013; 11:00:57;10;40

fid = fopen('data.txt');
mydata = textscan(fid, '%s %s %f %f', 'delimiter',';');
date=datenum( strcat(mydata{1},{' '},mydata{2}),'mm.dd,yyyy HH:MM:SS'); 
```

**2\. 得到正确的图**

plotyy 命令有两种不同的 x-ticks。通过以您所做的方式设置 datetick，您只更改其中一个。相反，将第一个 x-tick 更改为 date tick 并将第二个 x-ticks 设置为空。

```
temp = mydata{4};
[AX,H1,H2] = plotyy(date,temp,date,2*temp);
datetick(AX(1),'x','mmm.dd,yyyy');
set(AX(2),'XTick',[]) 
```

# hadoop - 挂载点权限变更HDFS

> ID：15733464
> 
> 赞同：1
> 
> 时间：2013-03-31T19:18:02.807
> 
> 标签：hadoop, hdfs, fuse

如何更改挂载点的所有权（使用 HDFS-FUSE 进行挂载）？

`chown -R user:user mount-point`不起作用（我的意思是它不会改变所有权）。

我的尝试：

```
[hduser@ocs /]$ ls -ltrhd hdfs1 
drwxr-xr-x 1 root root 4.0K Mar 31 22:05 hdfs1

[hduser@ocs /]$ chown -R eucalyptus:eucalyptus hdfs1

[hduser@ocs /]$ ls -ltrhd hdfs1

drwxr-xr-x 1 root root 4.0K Mar 31 22:05 hdfs1

[hduser@ocs /]$ 
```

# html - CSS3 flex 属性不起作用？

> ID：15733466
> 
> 赞同：2
> 
> 时间：2013-03-31T19:18:15.203
> 
> 标签：html, css, layout, flexbox

我无法理解 2009 年推出的新 flex-model。

市长的语法发生了三处变化，对吧？我一直在阅读本教程，我认为它是最新的。 [http://css-tricks.com/using-flexbox/](http://css-tricks.com/using-flexbox/)

它在 chrome 中看起来不错，但似乎不适用于 Firefox。这个概念很简单，我有一个包含三篇文章的内容框，一篇文章左侧包含图片，一篇文章主要内容（详细信息）居中且中间灵活，右侧是一个概览窗格。

如果我理解正确，这个 CSS 文件应该水平排列它们，同时展开细节框。Netbeans 告诉我“flex: 1”是一个未知属性。我究竟做错了什么？

```
#content { /*Eigenlijke tekst/artikels*/
    /* Oude chome, Android, Opera, IOS & safari syntax */
    display: -webkit-box;
    -webkit-box-orient: horizontal;

    /* Oude firefox syntax */
    display: -moz-box;
    -moz-box-orient: horizontal;

    /* Microsoft moet weer speciaal doen (IE) */
    display: -ms-flexbox;
    -ms-flex-orient: horizontal;

    /* Nieuwe chome syntax */
    display: -webkit-flex;
    -webkit-flex-direction: row;

    /* Nieuwste syntax */
    display: flex;
}

article {
    border: 1px solid black;
}
article[id="picture"] {
    width: 150px;
    padding: 10px;
    margin-left: -20px;
}
#content > article[id="details"] {
    -webkit-box-flex: 1;
    -moz-box-flex: 1;
    -webkit-flex: 1;
    -ms-flex: 1;
    flex: 1;
    margin-left: 10px;
    margin-right: 10px;
    padding: 10px;
}
article[id="overview"] {
    width: 225px;
    padding: 10px;
} 
```

这是 HTML 语法：

```
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
        <!--<![endif]-->
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>JSP Page</title>
        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/main.css">
        <link rel="stylesheet" href="css/detailpages.css">
        <jsp:useBean id="al" scope="application" class="beans.actionlisteners" />
        <script src="js/vendor/modernizr-2.6.2.min.js"></script>
    </head>
    <body>
        <div id="page_wrapper">
            <jsp:include page="header.jsp" />
            <jsp:include page="navigation.jsp" />
            <div id="content_wrapper">
                <section id="content">
                    <article id="foto">
                        <img src="img/festivals/rock_werchter_2013.png"
                             alt="Rock Werchter 2013 - afbeelding" width="140px"
                             draggable="true" ondragstart="<% al.dragstart(); %>"
                             />
                        Foto:&nbsp;&nbsp;
                    </article>
                    <article id="details">
                        <header>
                            <h2>Header van details</h2>
                        </header>
                            <p>Gegevens van festival</p>
                        <footer>
                            <h3>footer van details</h3>
                        </footer>
                    </article>
                    <article id="overzicht">
                        <header>
                            <h2>Lijsten</h2>
                        </header>
                            <p>Festivallijst & toevoegen</p>
                        <footer>
                            <h3>borderfactory dinges</h3>
                        </footer>
                    </article>
                </section>
            </div>
            <hr style="width: auto; margin-left: 20px; margin-right: 20px;" />
            <jsp:include page="footer.jsp" />
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T21:49:52.860

Firefox 实现 2009 规范 ( `display: box`) 有很多错误。当一个元素成为一个*弹性容器*时，它应该表现得像一个与周围元素相关的块元素。Firefox 实现更像是一个表格元素，因为它会缩小到其子元素的大小。添加显式宽度通常可以解决问题：

```
#content {
  width: 100%;
} 
```

# asp.net - SQL JOIN + WHERE

> ID：15733467
> 
> 赞同：2
> 
> 时间：2013-03-31T19:18:23.623
> 
> 标签：asp.net, sql, ms-access, join

**您需要了解的背景：** 我有两个表 - 一个名为“userprofiles”，一个名为“comments” - 在“comments”表中有一个名为“CommentUser”的查找字段，它链接到“userprofiles”中的一个字段称为“旅行者姓名”。

用户的头像图像路径（即 /Account/UserProfileAvatar/[TravellerName].jpg）可在名为“UserAvatar”的字段下的“userprofiles”表中找到。

gridview 本身使用带有 asp:Image 的 TemplateField，使用 Eval 和 Database 字段。我的意图是评论部分显示这 4 个数据字段：

1.  用户头像
2.  用户名（'CommentUser'）
3.  标语
4.  评论正文

我对第 2-4 点很好，但第 1 点是你们进来的地方。

客户端代码如下所示：

> ```
> <%-- Comments Box --%>
>  <asp:GridView ID="GridView2" runat="server" AutoGenerateColumns="False" 
>     DataSourceID="CommentsDataSource" Height="167px" Width="325px">
>     <Columns>
>       <asp:TemplateField HeaderText="Comments">
>         <ItemTemplate>
>         <div style="background-color:Silver">
>         <div class="avatar-frame">
>         <asp:Image runat="server" ImageUrl='<%# Eval("UserAvatar") %>'/>
>         </div>
>         <h1><%# Eval("TagLine")%></h1>
>         <h2><%# Eval("CommentUser")%></h2>
>         <p><%# Eval("CommentBody")%></p>
>         </div>
>         </ItemTemplate>
>         <AlternatingItemTemplate>
>         <div style="background-color:White">
>         <div class="avatar-frame">
>        <asp:Image ID="Image1" runat="server" ImageUrl='<%# Eval("UserAvatar") %>'/>
>         </div>
>         <h1><%# Eval("TagLine")%></h1>
>         <h2><%# Eval("CommentUser")%></h2>
>         <p><%# Eval("CommentBody")%></p>
>         </div>
>         </AlternatingItemTemplate>
> 
>         </asp:TemplateField>
>     </Columns>
> 
> </asp:GridView>
> 
> <asp:SqlDataSource ID="CommentsDataSource" runat="server" 
>     ConnectionString="<%$ ConnectionStrings:BookMeetConnString %>" 
>     ProviderName="<%$ ConnectionStrings:BookMeetConnString.ProviderName %>" 
>     SelectCommand="SELECT comments.CommentUser, comments.TagLine, comments.CommentBody, comments.BookID, userprofiles.TravellerName,
>   userprofiles.AvatarURL FROM userprofiles INNER JOIN comments ON
>   userprofiles.[TravellerName] = comments.[CommentUser] WHERE ([BookID]= ?)">
>     <SelectParameters>
>         <asp:QueryStringParameter Name="?" QueryStringField="ID" />
>     </SelectParameters>
> </asp:SqlDataSource>
> <%-- End of Comments Box --%> 
> ```

正如你所看到的，我对查询做了一些散列（我有一个粗略的想法，我需要做一个 JOIN，但我对 SQL 中的 JOIN 一无所知）。

我的查询的逻辑结构如下：

1.  SELECT comments.CommentUser、comments.TagLine、comments.CommentBody **（这些是评论表中需要的文本字段）**
2.  从“userprofiles”中检索每个发表评论的用户的 UserAvatar
3.  仅显示该特定 bookid 的评论（SQL 查询的最后部分将是**WHERE ([BookID] = ?)**

我希望你明白我所设想的查询是什么？

**编辑：** “BookID”的数据类型是*访问查找*（通过查找向导创建）。所有表都是通过 Microsoft Access 创建的。就字段的实际数据类型而言，据我所知，Access 会自动将“数字”数据类型分配给所有查找。查找查询本身是从表“comments”中的“BookID”到“booklist”表中的“ID”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T00:52:12.223

我不熟悉 ASP.Net 语法，但您实际提取的数据似乎有些混乱。

这是您的 SQL 查询：

```
 SELECT comments.CommentUser,
         comments.TagLine,
         comments.CommentBody,
         comments.BookID,
         userprofiles.TravellerName,
         userprofiles.AvatarURL
  FROM   userprofiles
         INNER JOIN comments
           ON userprofiles.[TravellerName] = comments.[CommentUser]
  WHERE  ([BookID] = ?) 
```

然而，要获取头像 URL，您可以使用：

```
ImageUrl='<%# Eval("UserAvatar") %> 
```

并不是：

```
ImageUrl='<%# Eval("AvatarURL") %> 
```

那么，它是什么？`UserAvatar`还是`AvatarURL`？

# html - CSS、HTML - 为什么 THIS CONTENT 在打印我的页面时会出现页面标题标签 (...) 的内容？

> ID：15733470
> 
> 赞同：0
> 
> 时间：2013-03-31T19:18:46.073
> 
> 标签：html, css, printing, title

我正在编写一个使用 HTML、CSS、jQuery 和一些 PHP 在我的本地主机上运行的页面。我使用单独的样式表进行打印。现在在打印预览中，页面标题标签的内容

```
<html><head><title>THIS CONTENT</title>... 
```

出现在页面上 - 如何摆脱它？

提前谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T09:09:48.700

我插入

```
title { display: none; } 
```

进入 print.css，现在它可以工作了。谢谢你的时间，伙计们，没想到会有 CSS 格式的标题元素。

（我如何支持 Jukka 的评论？它让我重新审视 CSS 思想并帮助我解决了这个问题。@Jukka：来自赫尔辛基的问候）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T19:22:43.353

尝试`text/html`从 PHP 发送标头。在将其他任何内容输出到浏览器之前，将以下内容添加到文件的**开头：**

```
<?php header("Content-Type: text/html"); ?> 
```

# c++ - 使用 MKL 函数在 C++ 中初始化数组是个好主意吗？

> ID：15733473
> 
> 赞同：2
> 
> 时间：2013-03-31T19:19:11.903
> 
> 标签：c++, initialization, intel-mkl

我想知道在 C++ 中将数组初始化为零是否是个好主意，如下所示：

```
const int n = 100;
double* x = new double[n];
cblas_dscal(n,0.0,x,1); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-16T13:36:17.900

不需要额外调用 mkl 函数。做就是了：

```
const int n = 100;
double* x = new double[n](); 
```

这是一个 C++ 功能，在此处进行了更详细的[说明](https://stackoverflow.com/a/2204380/1038318)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-10T10:37:09.940

更好的是使用向量，它可以让您将初始值指定为可选参数（默认为 0）

`std::vector<double> x(n, 0.0);`

# c++ - 如何删除单例对象

> ID：15733482
> 
> 赞同：4
> 
> 时间：2013-03-31T19:19:45.923
> 
> 标签：c++, design-patterns, singleton

假设这种单例模式的实现（当然我们应该避免单例：这只是个问题），我一直在考虑创建静态对象。它是由`new`操作员在堆上创建的，当然，但是它是如何销毁的呢？在下面的例子中我们有一个泄漏，那么**应该如何实现静态单例对象的删除**呢？是否应该采用`please_delete()`公共接口，以便可以调用`myC->please_delete()`或有其他方法来实现这一点？

```
class CC{
public:
    static CC* cObj(){
        if(c_ptr==NULL){
            c_ptr=new CC();
            return c_ptr;
        }else return c_ptr;
    }
    int getValue(){return value_;}
    void setValue(int val){value_=val;}
    ~CC(){cout<<"~CC";}
private:
    CC():value_(12345){cout<<"CC";}
    static CC* c_ptr;
    int value_;
};
// Allocating and initializing CC's
// static data member.  The pointer is being
// allocated - not the object itself.
CC *CC::c_ptr = 0;

int main(){
    //Singleton pattern
    CC* myC = CC::cObj();
    cout<<myC->getValue();
    return 0;
} 
```

> 输出：CC12345
> 
> 运行成功（总时间：67ms）

我注意到确实我们总是可以在其中声明单例静态实例`shared_ptr`，`boost::shared_ptr<CC> bCptr(CC::cObj());`但是单例模式根本没有提到删除对象的问题，所以也许存在其他方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-31T19:24:56.177

单例设计模式的一部分是它是坚不可摧的。

编辑：

关于可破坏性，有两种单例：

1.  可破坏的（当应用程序执行时它们会死掉）
2.  坚不可摧（机器损坏时它们会死）

无论哪种方式，如果构建得当，一旦创建了单例实例，它就会保留下来。这是对 Singleton 设计模式的主要批评之一。

以下是一些解决模式可破坏性方面的参考资料。

[http://nicolabonelli.wordpress.com/2009/06/04/singleton-a-mirage-of-perfect/](http://nicolabonelli.wordpress.com/2009/06/04/singleton-a-mirage-of-perfection/) [http://www10.informatik.uni-erlangen.de/Teaching/Courses/SS2009/CPP/altmann。 PDF](http://www10.informatik.uni-erlangen.de/Teaching/Courses/SS2009/CPP/altmann.pdf) [http://sourcemaking.com/design_patterns/singleton](http://sourcemaking.com/design_patterns/singleton) [http://sourcemaking.com/design_patterns/to_kill_a_singleton](http://sourcemaking.com/design_patterns/to_kill_a_singleton)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-31T19:31:54.390

经典的单例模式没有描述删除方面。

但是，如果我必须这样做，我会从一个简单的方法开始，如下所示（它不是万无一失的）：

1) 类似于创建/检索单例对象的静态方法，比如`createObject()`，有一个静态方法用于破坏单例对象，比如`destructObject()`

2）有一个计数器，用于统计系统中当前对象的数量；

*   它从 0 开始
*   随叫随到`createObject()`，它递增 1
*   在`deleteObject()`调用时，它减 1。
    *   如果达到 0，则`delete`调用 以*实际*破坏对象

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-31T20:52:29.573

我更喜欢不使用指针。

```
class Single
{
private:
   Single();

public:
   Single& Instance()
   {
      static Single the_instance;
      Return the_instance;
   }
}; 
```

这个单例将从`Instance()`被调用的时间一直存在，直到应用程序退出并执行静态对象的销毁。在这种情况下，将调用单例对象的析构函数。

实际上，即使在原始示例中使用指针时，内存也会在应用程序退出时由操作系统回收。但是在这种情况下，*不会*调用对象的析构函数。

# vim - 例如，从 vim 复制到 stackoverflow

> ID：15733483
> 
> 赞同：2
> 
> 时间：2013-03-31T19:20:10.367
> 
> 标签：vim, ubuntu-12.04

我一直在尝试`crtl + V`选择所有文本行，然后使用`"+y`and`"*y`但是当我尝试粘贴到论坛时这似乎不起作用。

此外，我去过[这篇文章](https://stackoverflow.com/questions/1562350/copy-and-paste-from-external-source)并尝试使用未命名的剪贴板选项更改 Vims /.vimrc，但这也没有奏效。

我怎样才能从 Vim 复制到论坛帖子而无需`shift + crl + c`删除行号？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-31T20:19:39.497

1.  确保您使用的是正确的 Vim 版本。大多数（如果不是全部）Linux 发行版上的默认 Vim 是一个“小”版本，除了其他有趣的特性外，它缺乏剪贴板支持。您可以通过在终端模拟器中运行此命令来验证这一点：

    ```
    $ vim --version | grep clipboard 
    ```

    功能前面的A`+`表示它是内置的，a`-`表示该功能缺失。

2.  如果你的 Vim 不支持剪贴板，你应该考虑将它升级到合适的版本。在基于 debian 的系统上，这通常使用以下命令完成：

    ```
    $ sudo apt-get install vim-gnome 
    ```

    此时，您应该能够使用`"+y`和试验`:h 'clipboard`.

然而，这只有在你的 Vim 在本地运行时才有效。如果你在远程机器上使用 Vim，你不能让远程 Vim 与本地剪贴板对话，除非你`-X`在连接时使用标志来启用带有各种副作用和要求的“X11 转发”。

# c# - 复制控件时如何复制与控件关联的事件？

> ID：15733495
> 
> 赞同：2
> 
> 时间：2013-03-31T19:21:16.430
> 
> 标签：c#, winforms, visual-studio-2010

当我需要重新排列控件按钮的位置时，我使用复制/剪切和粘贴，但我失去了事件的关联，需要手动重新分配。

有没有办法在不丢失它们的情况下做到这一点？

例如，我剪下一个按钮并将其粘贴到别处。它已经关联了 bt_ClickEventFunction，但是在粘贴它时，它会丢失它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T19:23:16.220

您可以将它们拖到表单上以更改它们的位置，您不需要对它们进行粘贴和粘贴。

Copy&Paste 使用新名称和 Text 创建另一个控件，而 Cut&Paste 从设计器中删除所有内容，然后按原样重新生成控件，但没有用于添加事件的行。我认为这是因为事件处理程序的代码位于设计器创建的文件之外的文件中，并且当您剪切控件时，事件处理程序不会从代码中删除，因为它也可以是其他一些控件的事件处理程序. 因此，在粘贴时，设计器实际上只创建了新控件，就像您从工具箱中拖动它时一样，而是从已剪切的控件中设置属性。

**编辑**根据您的评论进行编辑。您甚至可以使用 TabPages 进行拖放。您需要将其拖动为带有箭头的小矩形，如图所示：

![在此处输入图像描述](https://i.stack.imgur.com/HWZDs.png)

并且您可以将它拖到另一个 TabControl，在这种情况下，TabPage 将保留所有“关联”事件处理程序。 ![在此处输入图像描述](https://i.stack.imgur.com/zj4GM.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-28T17:34:29.373

要将所有事件过程恢复到各自的控件，请转到窗体的 VBA 代码窗口，然后剪切、复制和粘贴整个模块。您可以按 Ctrl+A、Ctrl+X 和 Ctrl+V 来执行此操作。

# java - Java类，在类构造函数中设置值的最佳实践是什么？

> ID：15733499
> 
> 赞同：-2
> 
> 时间：2013-03-31T19:21:28.527
> 
> 标签：java

例如我有一堂课

第一类：

```
public class car{
private Color carColor;
public car(Color carColor)
{
    this.carColor = carColor;
}

public void setColor(Color carColor)
{
    this.carColor = carColor;
}
} 
```

类2：

```
public class car{
    private Color carColor;
    public car(Color carColor)
    {
        setColor(carColor);
    }

    public void setColor(Color carColor)
    {
        this.carColor = carColor;
    }
} 
```

哪个构造函数将是 Java 编码的最佳实践，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T19:22:52.937

第一种方式更直观，出现频率更高。即像这样：

```
public car(Color carColor)
{
    this.carColor = carColor;
} 
```

它更具可读性。但两者都是平等的，所以这是一个风格问题。

也看到这个：[我应该在构造函数内还是在构造函数外初始化变量](https://stackoverflow.com/questions/3918578/should-i-initialize-variable-within-constructor-or-outside-constructor)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-31T19:24:28.123

我会使用第一个选项，因为您可以在`setColor()`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-31T19:24:02.887

我想是Class1。Getter 和 Setter 方法通常是必需的，但构造器的工作是初始化该对象的变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-31T19:24:15.060

如果我在设置变量之前有很多计算需要对变量进行，我会在一个单独的方法中进行，否则我会选择第一种方法。

```
public car(Color carColor)
{
    setColor(carColor);
}

public void setColor(Color carColor)
{
    Color res;
    //Many calculations
    //..
    //..
    //finally 
    this.carColor = res;
} 
```

但如果我只想设置它，我会很简单：

```
public car(Color carColor)
{
    this.carColor = carColor;
} 
```

# php - 使用 Instagram API 为用户创建“赞”

> ID：15733503
> 
> 赞同：2
> 
> 时间：2013-03-31T19:21:39.307
> 
> 标签：php, javascript, api, curl, instagram

所以，我正在使用 Instagram API，但我不知道如何为登录用户创建一个赞（在照片上）。所以我的演示应用程序当前正在显示用户的提要，它正在请求代表该用户喜欢和评论的权限。我正在使用 PHP 和 Curl 来实现这一点，我在互联网上找到了一些指南：

```
<?php 
  if($_GET['code']) {
  $code = $_GET['code'];
  $url = "https://api.instagram.com/oauth/access_token";
  $access_token_parameters = array(
    'client_id'                =>     '*MY_CLIENT_ID*',
    'client_secret'            =>     '*MY_CLIENT_SECRET*',
    'grant_type'               =>     'authorization_code',
    'redirect_uri'             =>     '*MY_REDIRECT_URI*',
    'code'                     =>     $code
        );

    $curl = curl_init($url);    // we init curl by passing the url
    curl_setopt($curl,CURLOPT_POST,true);   // to send a POST request
    curl_setopt($curl,CURLOPT_POSTFIELDS,$access_token_parameters);   // indicate the data to send
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);   // to return the transfer as a string of the return value of curl_exec() instead of outputting it out directly.
    curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);   // to stop cURL from verifying the peer's certificate.
    $result = curl_exec($curl);   // to perform the curl session
    curl_close($curl);   // to close the curl session

    $arr = json_decode($result,true);

    $pictureURL = 'https://api.instagram.com/v1/users/self/feed?access_token='.$arr['access_token'];

    // to get the user's photos
    $curl = curl_init($pictureURL);
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);
    $pictures = curl_exec($curl);
    curl_close($curl);

    $pics = json_decode($pictures,true);

    // display the url of the last image in standard resolution

    for($i = 0; $i < 17; $i++) {
    $id = $pics['data'][$i]['id'];

    $lowres_pic = $pics['data'][$i]['images']['low_resolution']['url'];

    $username = $pics['data'][$i]['user']['username'];
    $profile_pic = $pics['data'][$i]['user']['profile_picture'];

    $created_time = $pics['data'][$i]['created_time'];
    $created_time = date('d. M - h:i', $created_time);

    $insta_header = '<div class="insta_header"><div class="insta_header_pic"><img src="'.$profile_pic.'" height="30px" width="30px"/></div><div class="insta_header_name">'.$username.'</div><div class="insta_header_date">'.$created_time.'</div></div>';
    $insta_main = '<div class="insta_main"><img src="'.$lowres_pic.'" /></div>';
    $insta_footer = '<div class="insta_footer"><div class="insta_footer_like"><button onClick="insta_like(\''.$id.'\')"> Like </button></div><div class="insta_footer_comment"><form onSubmit="return insta_comment(\''.$id.'\')"><input type="text" id="'.$id.'" value="Comment" /></form></div></div>';

    echo '<div class="insta_content">'. $insta_header . $insta_main . $insta_footer .'</div>';
    }

  }
 ?> 
```

现在，这可能是一个愚蠢的问题，但我如何代表用户对特定照片点赞呢？我习惯于使用 JavaScript 来处理这类事情，因此我设置了带有 JS 函数（不存在）的 Like-button。但由于 Instagram 一直在使用 Curl 和 PHP，我猜我必须在这里做同样的事情？我没有使用 Curl 的经验，也不明白它是如何工作的。如果有人也可以给我一个提示，那就太好了。但首先，喜欢。如果可以用 JS 做到这一点，我会很高兴。如果没有，请告诉我如何使用 PHP 和 Curl。

[这是 Instagram 开发者网站的链接，其中包含您应该向http://instagram.com/developer/endpoints/likes/](http://instagram.com/developer/endpoints/likes/)发送 POST 请求的 URL 。

如果你不忙，如果你能告诉我如何代表用户发表评论，我会很高兴:)

提前致谢。

*   亚历山大。

# hadoop - 为什么我每次都需要 source bash_profile

> ID：15733508
> 
> 赞同：37
> 
> 时间：2013-03-31T19:22:10.233
> 
> 标签：hadoop, .bash-profile

我已经安装了 Hadoop，每次我想运行它时，首先我必须这样做：

```
source ~/.bash_profile 
```

否则它不会识别命令`hadoop`

这是为什么？

我在 OSX 10.8

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-03-31T20:41:43.643

现在我们已经缩小了问题的范围：

1.  在命令行运行`ps -p $$`以确定您实际上正在使用 bash shell。
2.  意识到您在 zsh 中，这意味着您应该在`.zshrc`.
3.  将违规行从`.bash_profile`to复制到`.zsh`，或
4.  ~~修改您`.zshrc`的直接来源您的`.bash_profile`.~~

更新：执行@TC1 在评论中提到的操作，并将特定于 shell 的代码保留在每个 shell 自己的配置文件中，并且从这些配置文件中，仅与源 shell 无关的代码。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2020-03-05T15:45:22.243

在 Mac Catalina 上，我只需要在终端上打开“首选项”并将“打开的 shell”从“默认”更改为“命令（完整路径）”，默认路径为“/bin/zsh”。`touch ~/.zshrc`，如果该文件尚不存在，则将您的内容从“.bash_profile”复制/粘贴到“.zshrc”文件中。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2021-02-18T07:41:33.233

`bash_profile.sh`适用于`bash`外壳。如果您的默认 shell 不是`bash`，并且如果您的默认 shell 是其他 shell，`zsh`那么您必须手动加载`.bash_profile`using `source ~/.bash_profile`.

您始终可以将默认外壳更改为`bash`外壳，以便`.bash_profile`自动加载文件。

为了自动加载`.bash_profile`，您可以`bash`使用以下命令更新您的默认 shell`chsh -s /bin/bash`

> `cat /etc/shells`将列出机器中可用的默认 shell

[![在此处输入图像描述](https://i.stack.imgur.com/eq0zP.png)](https://i.stack.imgur.com/eq0zP.png)

> `echo $SHELL`将显示您机器中当前活动的 shell

[![在此处输入图像描述](https://i.stack.imgur.com/3NWy0.png)](https://i.stack.imgur.com/3NWy0.png)

> 要将活动 shell 更改为不同的 shell，请使用`chsh -s /bin/bash`. 然后`echo $SHELL`验证外壳是否已更改。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2020-06-08T16:49:49.600

终端 -> 首选项 -> 配置文件 -> 外壳 -> 运行命令：source ~/.bash_profile

勾选在 shell 内运行。

完成所有这些后，只需注销并检查天气一切是否正常

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-04-09T20:35:27.560

我尝试了批准的答案。更改 .zshrc 文件适用于我的一台机器。但是对于另一个，当我运行 ps -p $$ 时，它是命令下的 -sh。我更改了 bash 和 zsh 文件，这次它们都不适合我。

所以我发现了这个 [https://www.gnu.org/software/bash/manual/html_node/Bash-Startup-Files.html](https://www.gnu.org/software/bash/manual/html_node/Bash-Startup-Files.html)

它提到“当 Bash 作为交互式登录 shell 或作为带有 --login 选项的非交互式 shell 调用时，它首先从文件 /etc/profile 中读取并执行命令，如果该文件存在的话。”

所以我去了那个文件 /etc/profile 并在那个文件中添加了“source ~/.bashrc”。然后它可以工作，因为每次打开终端时，它都会运行该 /etc/profile 文件中的命令。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-21T17:07:15.467

不确定这是否是最好的解决方案，但它有效。

`sudo nano /etc/bashrc`并改变它，重新启动终端，它终于用命令记住了。试过`~/.bash_profile`但`~/.bashrc`没有成功，只是没有采购它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-10-14T19:41:36.940

转到“首选项/配置文件”，然后在右侧窗口中查找“shell”。

如果您的“启动运行命令”尚未打开，则一旦进入。单击该框将其打开，然后在命令部分中键入：

（如果你做了一个`.zsh`文件）

```
source .zsh ; clear 
```

（如果你做了一个`.bash_profile`）

```
source .bash_profile ; clear 
```

这样做`; clear`

将您的终端清除到新页面，以便您看不到终端显示：

```
“Last login: etc 
User@user-Mac ~ % source .zsh 
```

如果你按我说的那样输入命令，你应该得到这个：

```
User@user-Mac ~ % 
```

这样，您将看到一个清晰的页面，没有多余的内容。还要确保您的`.zsh`或`.bash_profile`别名正常工作，请键入以下命令以查看您的自定义别名列表：

```
Alias 
```

我喜欢做的一个别名是

```
alias LL=“ls -la” 
```

这将显示一棵树或您所在的目录以及隐藏文件。

# c# - unity 3d 碰撞时相机抖动

> ID：15733509
> 
> 赞同：2
> 
> 时间：2013-03-31T19:22:14.087
> 
> 标签：c#, camera, unity3d

[http://answers.unity3d.com/questions/212189/camera-shake.html](http://answers.unity3d.com/questions/212189/camera-shake.html) 我已经按照上面的问题答案尝试让相机抖动适用于我的第一人称相机。但我试图修改它，使相机从一个看不见的碰撞盒中抖动。

到目前为止，我的相机抖动脚本看起来像这样；

```
public bool Shaking; 
private float ShakeDecay;
private float ShakeIntensity;   
private Vector3 OriginalPos;
private Quaternion OriginalRot;

void Start()
{
Shaking = false;   
}

void OnTriggerEnter(Collider collision)
{
if(collision.gameObject.name == "ShakeTrigger")
{
    DoShake();  
    Debug.Log("The camera trigger has hit");
}
}

void Update () 
{
if(ShakeIntensity > 0)
{
    transform.position = OriginalPos + Random.insideUnitSphere * ShakeIntensity;
    transform.rotation = new Quaternion(OriginalRot.x + Random.Range(-ShakeIntensity, ShakeIntensity)*.2f,
                              OriginalRot.y + Random.Range(-ShakeIntensity, ShakeIntensity)*.2f,
                              OriginalRot.z + Random.Range(-ShakeIntensity, ShakeIntensity)*.2f,
                              OriginalRot.w + Random.Range(-ShakeIntensity,     ShakeIntensity)*.2f);

   ShakeIntensity -= ShakeDecay;
}
else if (Shaking)
{
   Shaking = false;  
}

}

void OnGUI() {

 if (GUI.Button(new Rect(10, 200, 50, 30), "Shake"))
   DoShake();
   //Debug.Log("Shake");

}     

public void DoShake()
{
OriginalPos = transform.position;
OriginalRot = transform.rotation;

ShakeIntensity = 0.3f;
ShakeDecay = 0.02f;
Shaking = true;
} 
```

我知道代码可以通过 gui 按钮 100% 工作。此脚本附加到第一人称控制器上的相机。游戏中有一个带有 ShakeTrigger 标签的不可见碰撞框。但是，调试日志根本没有被调用，我不确定为什么。

如果有人需要更多信息，请告诉我。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T06:28:00.557

如果脚本附加到您的相机，则 OnTriggerEnter 正在查看相机以进行触发调用，而不是碰撞框。

您可以做的一件事是将 OnTriggerEnter 粘贴到新脚本中并将其放入碰撞框中。然后让它按照以下方式执行 SendMessage：

`GameObject.Find("Camera").SendMessage("DoShake");`

编辑：回答 Jerdak 的问题。

下面的代码将在 TriggerBox 内：

```
void Start()
{
    ...   
}

void OnTriggerEnter(Collider collision)
{
    if(collision.gameObject.name == "ShakeTrigger")
{
    GameObject.Find("Camera").SendMessage("DoShake");  
    Debug.Log("The camera trigger has hit");
}
}... 
```

这将在相机内：

```
void Start()
{
    ...  
}

public void DoShake()
{
    OriginalPos = transform.position;
    OriginalRot = transform.rotation;

    ShakeIntensity = 0.3f;
    ShakeDecay = 0.02f;
    Shaking = true;
}... 
```

这样，triggerbox 负责检测触发器，并且只有在正确类型的物体通过它时才会向相机发送消息。然后相机负责进行抖动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-03-18T15:59:54.047

要在碰撞或触发时摇动您的相机，您需要首先制作您的摇动功能，您也可以从其他脚本调用该功能

就像是

```
public class ShakeCamera : MonoBehavior
{
    public bool canShake;

    private void Update()
    {
       if(canShake)
       DoShake()
    }
    public void DoShake()
    {
        // Shake Logic
    }
    public void StartShake()
    {
       canShake = true;
    }
    public void StopShake()
    {
       canShake = false;
    }
} 
```

每当您触发目标对象时，您都可以从其他脚本中调用它

```
 public class TriggerScript: MonoBehavior
        {
            public ShakeCamera shakeCamera;

            private void Start()
            {
                shakeCamera = FindObjectOfType<ShakeCamera>();
            }

            void OnTriggerEnter(Collider collision)
            {
                 if(collision.gameObject.tag == "targetTag")// Change Tag accroding to your requirement
                    {

                        cameraShake.StartShake();
                    } 
             }
            void OnTriggerExit(Collider collision)
            {
                 if(collision.gameObject.tag == "targetTag")// Change Tag accroding to your requirement
                    {
                        cameraShake.StopShake();
                    } 
             }
        } 
```

我正在为您附上一个参考视频，它可能会帮助您更好地抖动相机。希望对您有所帮助。

你可以参考我制作的这个视频[https://youtu.be/9X_JXexwfR4](https://youtu.be/9X_JXexwfR4)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-08-25T18:30:56.090

如果您已设置刚体，则将插值从无更改为插值。

# r - R可以在不进行频率计数的情况下绘制直方图吗？我的数据已经包含 (item, count) 对

> ID：15733513
> 
> 赞同：2
> 
> 时间：2013-03-31T19:22:19.280
> 
> 标签：r, histogram, frequency

我从 R hist() 看到的所有示例都以原始数据列表开始，并且在 R 中计算频率。我的数据不是原始数据，它已经被计算和分箱，例如 A、34 B、15 C、82 D , 22

R 可以从该形式的数据开始并从中绘制直方图，*而无需*对我进行频率计数吗？谢谢 - 埃德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T19:49:32.957

您**可以**通过在适当命名的位置使用您的值将类分配`histogram`给您的数据，然后使用 来做到这一点`plot.histogram`，但是由于您首先拥有的不是一组分级样本，因此您没有适合到真实的直方图。正如 Tyler 评论的那样，只需做一个条形图并将您的数据类别名称分配给 x 轴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-10T18:20:30.503

CRAN 上的新[HistogramTools](http://cran.r-project.org/web/packages/HistogramTools/)包包含一个私有函数`.BuildHistogram`，它正是这样做的。它需要一个断点列表和一个计数列表（断点必须比计数大 1），并返回一个有效的 R 直方图对象，其中中点、密度和其他对象组件设置正确，因此您可以使用标准 R 绘制结果对象功能。

```
install.packages("HistogramTools")
library(HistogramTools)
myhist <- HistogramTools:::.BuildHistogram(1:6, 1:5)
plot(myhist) 
```

# iphone - 将 Facebook 帖子导入 iPhone 应用程序

> ID：15733516
> 
> 赞同：0
> 
> 时间：2013-03-31T19:22:38.280
> 
> 标签：iphone, xcode, facebook, fbconnect

我是 Xcode 的新手，想知道是否有人可以帮助我将 facebook 粉丝页面帖子导入 iphone 应用程序？导入帖子时，应用程序的用户应该能够对任何帖子点赞/评论。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:32:27.857

首先，您应该查看 Facebook 提供的无缝运行的 iOS SDK。

[脸书 iOS SDK](https://developers.facebook.com/ios/)

您将通过图形 api 请求在此处找到您想要的内容。 [Facebook iOS SDK 请求](https://developers.facebook.com/docs/reference/iossdk/request/)

如果您需要它，我可以为您提供更多指导，但这不是必需的；-)

# r - 在 R 中“循环”的有效方法

> ID：15733518
> 
> 赞同：3
> 
> 时间：2013-03-31T19:22:43.467
> 
> 标签：r

我是 R 新手，我有这个问题。我知道我可以做一个循环，但我想看看是否有 R-ic 方法可以做到这一点。

我有一列中的值从 100 到 1000 的数据框。我想生成一个值数小于 500、600、700、...、1000 的表。

我知道该怎么做：

```
x = seq(100, 1000, by=10)
y = seq(500, 1000, by=100)
sum(x<y[1]) 
```

我需要做类似的事情：

```
sum(x<y) 
```

这将返回一个带有计数的向量。

我试图寻找类似的问题，但这是一个非常不具体的问题，我找不到答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T19:28:05.517

由于 ，您可以使用`lapply`例如。

```
unlist(lapply(y, function(i) sum(x<i))) 
```

循环是 R 惯用的方式。它基本上是一个循环，但没有副作用。

**编辑**

我更喜欢`table`在这里使用，以及评论中建议的 R-ish `sapply`:)

```
sapply(y, function(i) table(x<i))
      [,1] [,2] [,3] [,4] [,5] [,6]
FALSE   51   41   31   21   11    1
TRUE    40   50   60   70   80   90 
```

**编辑**

您还可以使用`vapply`更安全的方法，因为您按照@flodel 的建议指定了 retun 的类型：

```
 vapply(y, function(i) sum(x<i), integer(1L)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:32:21.893

试试这个

```
 sapply(y,FUN=function(iter) sum(x < iter)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-31T19:41:30.317

怎么样：

```
colSums(outer(x, y, '<'))
[1] 40 50 60 70 80 90 
```

# c - Klibc：了解为 _IO_file_pvt 结构完成的内存分配

> ID：15733519
> 
> 赞同：2
> 
> 时间：2013-03-31T19:22:44.553
> 
> 标签：c, memory-management, linux-kernel, stdio, libc

在`klibc`C标准库的实现中。该`FILE`结构定义如下：

```
struct _IO_file {
    int _IO_fileno;     /* Underlying file descriptor */
    _Bool _IO_eof;      /* End of file flag */
    _Bool _IO_error;    /* Error flag */
};
typedef struct _IO_file FILE;

struct _IO_file_pvt {
    struct _IO_file pub;    /* Data exported to inlines */
    struct _IO_file_pvt *prev, *next;
    char *buf;      /* Buffer */
    char *data;     /* Location of input data in buffer */
    unsigned int ibytes;    /* Input data bytes in buffer */
    unsigned int obytes;    /* Output data bytes in buffer */
    unsigned int bufsiz;    /* Total size of buffer */
    enum _IO_bufmode bufmode; /* Type of buffering */
}; 
```

为此结构完成的分配：

```
struct _IO_file_pvt *f;
const size_t bufoffs =
    (sizeof *f + 4*sizeof(void *) - 1) &
    ~(4*sizeof(void *) - 1);

f = zalloc(bufoffs + BUFSIZ + _IO_UNGET_SLOP); 
```

`BUFSIZ`16K和`_IO_UNGET_SLOP`32在哪里。

该`buf`字段指向结构本身之后的地址，这就是为什么在分配期间需要额外的`BUFSIZ + _IO_UNGET_SLOP`地址。

我不明白为什么`bufoffs`要这样定义。还`sizeof *f`不够吗？

我在 32 位和 64 位机器上测试了这个表达式。`sizeof *f`分别为 40 和 56 字节。`bufoffs`是 48 和 64 字节。这意味着它在两种情况下都增加了 8 个字节。我怀疑这是出于内存对齐的目的，但我不确定。即使它是，为什么需要它？

# php - 写入文本文档时添加了不需要的新行

> ID：15733521
> 
> 赞同：-1
> 
> 时间：2013-03-31T19:23:09.413
> 
> 标签：php

我只是想对从*matrix.txt*文件中读取的矩阵执行简单的排序算法，然后将排序后的矩阵附加回文件中。

问题是不需要的新行被写入文本文件。我还尝试与`echo`我在文本文件中编写的相同内容并行，但`echo`打印一切正常。

```
 // .. reading the file and sorting the matrix ..

    // Write the sorted matrix back to the text file
    $handle = @fopen("matrix.txt", "a");
    if ($handle) {
    fwrite($handle, PHP_EOL . PHP_EOL . "Sorted matrix:" . PHP_EOL);
    for ($i = 0; $i < $n; $i++) {
        for ($j = 0; $j < $m; $j++) {
            echo $matrix[$i][$j] . " ";
            fwrite($handle, $matrix[$i][$j] . " ");         
        }
        fwrite($handle, PHP_EOL);
        echo "<br>";
    }
    fclose($handle);
} 
```

*matrix.txt*文件内容：

```
1 2 5 2 5 8 12 323 1 4
8 32 2 1 3 82 2 8 4 2
1 2 5 2 5 8 12 323 1 4
8 32 2 1 3 82 2 8 4 2 
```

在 Web 浏览器中，它与排序良好的矩阵相呼应，每一行都是单独的；但是，在文本文件中，附加了以下内容：

```
Matrix sorted using selection sort:
1 1 2 2 4
 5 5 8 12 323 
1 2 2 2
 3 4 8 8 32 82 
1 1 2 2 4
 5 5 8 12 323 
1 2 2 2 3 4 8 8 32 82 
```

任何线索可能导致这种情况？提前致谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T19:26:07.530

问题不在于您发布的代码；它在您提供的输入矩阵中。请注意，每个额外的换行符都对应于过去位于行尾的项目，最后一行除外。那是因为当您阅读该行时，每行的最后一个换行符都包含在内，并且`explode`（我想您正在使用）不知道将其删除。您可以`trim`在爆炸之前简单地修复此问题，或者专门删除`\r`和`\n`字符。

# python - 过滤一个 numpy 网格网格

> ID：15733530
> 
> 赞同：3
> 
> 时间：2013-03-31T19:23:55.657
> 
> 标签：python, multidimensional-array, numpy, filter

我想过滤一个 numpy meshgrid 的值：

```
X,Y = np.mgrid[-10:10,-10:10] 
```

在这种情况下，我想删除所有坐标`x**2 + y**2 <= 2`。但是，当我尝试直接过滤数组时，例如

```
filter(lambda x,y: x**2 + y**2 >= 2, np.meshgrid[-10:10,-10:10]) 
```

我收到错误，因为我没有正确处理数组的结构。

任何正确执行此操作的提示将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T03:00:47.990

`numpy.where`通过单独过滤每个数组，但在`where`条件中引用两者，我能够使用 实现我需要的结果：

```
X,Y = np.mgrid[-10:10,-10:10]
X,Y = np.where(X**2 + Y**2 > 2, X, 0), np.where(X**2 + Y**2 > 2, Y, 0) 
```

这会产生新的二维数组，这是我对 matplotlib 所需要的。感谢所有花时间看这个问题的人！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-31T19:37:42.047

```
X,Y = np.mgrid[-10:10,-10:10]
idx = (X**2 + Y**2 > 2)
X, Y = X[idx], Y[idx] 
```

问题是您不再拥有 2D 数组，这可能是 matplotlib 之类的问题。

* * *

看到您自己的答案，并且您基本上想用`0`不满足条件的条目替换，这样做可能会更清洁，更有效：

```
idx = X**2 + Y**2 > 2
X[~idx] = 0
Y[~idx] = 0 
```

# r - 在没有变换的情况下在 ggplot2 中指定带刻度的中断数？

> ID：15733531
> 
> 赞同：11
> 
> 时间：2013-03-31T19:24:00.990
> 
> 标签：r, ggplot2

如果我希望我的数据轴有更多的中断但没有对值进行转换，我该如何在 ggplot2 中做到这一点？例如：

```
... + scale_x_continuous(breaks=scales.trans_breaks("log2", function(x) 2^x, n=8),   limits=limits) 
```

如果您希望转换数据并且该`n=`参数可让您说出中断次数，则可以使用。如何在不转换数据的情况下指定中断？你只是给它一个身份功能吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-31T20:23:16.987

我不希望根据数据中的计算给出明确的刻度，因此我希望 ggplot2 仅在给定限制和刻度数的情况下为我选择刻度线。这段代码对我有用：

```
 library(scales)
 scale_x_continuous(breaks = trans_breaks(identity, identity, n = numticks)) 
```

`breaks = ...`当然，您始终可以像 agstudy 所写的那样明确设置刻度线。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-31T19:59:36.270

你可以给出`scale_x_continuous`一个这样的中断向量：

```
n=5
breaks = seq(min(dat$x),max(dat$x), length.out = n)
m + scale_x_continuous(breaks=breaks) 
```

# security - JRE中的黑名单文件是什么

> ID：15733533
> 
> 赞同：1
> 
> 时间：2013-03-31T19:24:05.283
> 
> 标签：security, java

我下载了 JRE，在 jre/lib/security/ 里面，有一个名为 blacklist 的文件。内容如下：

```
# JNLPAppletLauncher applet-launcher.jar  
SHA1-Digest-Manifest: 5Bo5/eg892hQ9mgbUW56iDmsp1k= 

# 7066583
SHA1-Digest-Manifest: x17xGEFzBRXY2pLtXiIbp8J7U9M=  
SHA1-Digest-Manifest: ya6YNTzMCFYUO4lwhmz9OWhhIz8=  
SHA1-Digest-Manifest: YwuPyF/KMcxcQhgxilzNybFM2+8=  

# 7066809
SHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g=  
SHA1-Digest-Manifest: lTYCkD1wm5uDcp2G2PNPcADG/ds=  
SHA1-Digest-Manifest: GKwQJtblDEuSVf3LdC1ojpUJRGg=  

# 7186931
SHA1-Digest-Manifest: 0CUppG7J6IL8xHqPCnA377Koahw=  
SHA1-Digest-Manifest: 3aJU1qSK6IYmt5MSh2IIIj5G1XE=  
SHA1-Digest-Manifest: 8F4F0TXA4ureZbfEXWIFm76QGg4=  
SHA1-Digest-Manifest: B1NaDg834Bgg+VE9Ca+tDZOd2BI=  
SHA1-Digest-Manifest: bOoQga+XxC3j0HiP552+fYCdswo=  
SHA1-Digest-Manifest: C4mtepHAyIKiAjjqOm6xYMo8TkM=   
SHA1-Digest-Manifest: cDXEH+bR01R8QVxL+KFKYqFgsR0=  
SHA1-Digest-Manifest: cO2ccW2cckTvpR0HVgQa362PyHI=  
SHA1-Digest-Manifest: D/TyRle6Sl+CDuBFmdOPy03ERaw=  
SHA1-Digest-Manifest: eJfWm86yHp2Oz5U8WrMKbpv6GGA=  
SHA1-Digest-Manifest: g3mA5HqcRBlKaUVQsapnKhOSEas=   
SHA1-Digest-Manifest: HSPXCvBNG/PaSXg8thDGqSeZlR8=  
SHA1-Digest-Manifest: iMHjGyv5gEnTi8uj68yzalml8XQ=  
SHA1-Digest-Manifest: jd5MvBoWh7aHiUa1v15lqXVQ9y4=  
SHA1-Digest-Manifest: L0l3WOuMNWujmXo5+O/GtmGyyYk=  
SHA1-Digest-Manifest: l4meuozuSFLkTZTS6xW3sixdlBI=   
SHA1-Digest-Manifest: l93uYyDZGyynzYTknp31yyuNivU=   
SHA1-Digest-Manifest: lbhLWSopUIqPQ08UVIA927Y7jZQ=  
SHA1-Digest-Manifest: nv5+0eBNHpRIsB9D6TmEbWoNCTs=  
SHA1-Digest-Manifest: obWCTaz3uOZwDBDZUsbrrTKoDig=  
SHA1-Digest-Manifest: odqJCMnKdgvQLOCAMSWEj1EPQTc=  
SHA1-Digest-Manifest: OfQZHjo8GK14bHD4z4dDIp4ZFjE=    
SHA1-Digest-Manifest: PVAkXuUCgiDQI19GPrw01Vz4rGQ=  
SHA1-Digest-Manifest: Q9HXbUcSCjhwkgpk5NNVG/sArVA=  
SHA1-Digest-Manifest: qMVUh9i3yJcTKpuZYSFZH9dspqE=    
SHA1-Digest-Manifest: TFYT30IirbYk89l/uKykM6g2cVQ=    
SHA1-Digest-Manifest: trhKo6XiSGxRrS//rCL9e3Ca6D4=    
SHA1-Digest-Manifest: uWffvhFaWVw3lrER/SJH7Hl4yFg=  
SHA1-Digest-Manifest: vSd+kv1p+3jrVK9FjDCBJcoy5us=  
SHA1-Digest-Manifest: WX77FlRyFyeUriu+xi/PE1uLALU=  
SHA1-Digest-Manifest: WyqHV02O4PYZkcbidH4HKlp/8hY=  
SHA1-Digest-Manifest: Y82nn7CFTu1XAOCDjemWwyPLssg=  

# 8002218
SHA1-Digest-Manifest: saJIx2dYM4ac+paV09g7hyvF7rs=  
SHA1-Digest-Manifest: hYV/Hs2xEIHeidB+9ZVjAtTBr/g= 
```

谁能告诉我这个文件是干什么用的。我确信它与安全性有关，但是我无法弄清楚，也无法从谷歌中找到任何东西。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T13:38:20.223

请看这里的解释[http://docs.oracle.com/javase/7/docs/technotes/guides/security/blacklistfeature.html](http://docs.oracle.com/javase/7/docs/technotes/guides/security/blacklistfeature.html)

# javascript - 如何更改 Box2D.js 的调试绘制可视化位置？

> ID：15733535
> 
> 赞同：3
> 
> 时间：2013-03-31T19:24:09.740
> 
> 标签：javascript, debugging, box2d, game-physics, physics-engine

我正在创造比屏幕更大的世界的游戏。所以我需要根据可视化移动Debug Draw。在 Flash 端口中存档此问题，我们通常会移动用作 Debug Draw 目标的 DisplayObject，但在 Box2D Debug Draw 的 javascript 端口中缺乏这种可能性？或者我想念什么？

我使用了 Box2DFlash 2.1a [https://code.google.com/p/box2dweb/的](https://code.google.com/p/box2dweb/)**box2dweb** javascript 端口。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-02T22:51:16.223

只需使用画布上下文 2d 的功能：

context.translate(canvasOffset.x, canvasOffset.y); context.scale（规模，规模）；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-30T09:22:46.223

如果您想从绝对值（即来自原始位置而不是最后一帧位置的值）转换上下文，则需要保存和恢复上下文，因此您具有相同的翻译来源。您可能还需要 clearRect 来清除将要绘制的区域。

```
context.save();
context.clearRect(0, 0, debugCanvas.width, debugCanvas.height);
context.translate(canvasOffset.x, canvasOffset.y);
world.DrawDebugData();
context.restore(); 
```

# git - 可以推送到heroku，但推送到git时被拒绝

> ID：15733541
> 
> 赞同：2
> 
> 时间：2013-03-31T19:24:38.157
> 
> 标签：git, heroku

我在 Github 上托管了一个 git repo，我已经向其中推送了许多提交。但是，今天尝试执行此操作时`git push`出现此错误：

```
$ git push
Permission denied (publickey).
fatal: The remote end hung up unexpectedly 
```

现在，在告诉我这是许多其他“git push 权限被拒绝”问题的欺骗之前，请注意我能够成功部署到 Heroku：

```
$ git push heroku

......

-----> Launching... done, v19
   http://hidden-inlet-6102.herokuapp.com deployed to Heroku

To git@heroku.suggestion-box-app:hidden-inlet-6102.git
6e69075..243b0c8  master -> master 
```

我怎么能推送到 Heroku 但不能推送到 Github？自上次成功推送提交以来，我认为我没有对 repo 进行任何更改。

我尝试（重新？）-添加 SSH 密钥，但在尝试推送时仍然出现相同的错误：

```
$ ssh-add
Identity added: /Users/Anders/.ssh/id_rsa (/Users/Anders/.ssh/id_rsa)
$ git push
Permission denied (publickey).
fatal: The remote end hung up unexpectedly 
```

任何有关我如何解决此问题的建议将不胜感激。

以下是一些可能有助于解决此问题的附加参考信息。提前感谢您的帮助！

```
 $ ssh -vT git@github.com
    OpenSSH_5.6p1, OpenSSL 0.9.8r 8 Feb 2011
    debug1: Reading configuration data /Users/Anders/.ssh/config
    debug1: Reading configuration data /etc/ssh_config
    debug1: Applying options for *
    debug1: Connecting to github.com [207.97.227.239] port 22.
    debug1: Connection established.
    debug1: identity file /Users/Anders/.ssh/id_rsa type 1
    debug1: identity file /Users/Anders/.ssh/id_rsa-cert type -1
    debug1: identity file /Users/Anders/.ssh/id_dsa type -1
    debug1: identity file /Users/Anders/.ssh/id_dsa-cert type -1
    debug1: Remote protocol version 2.0, remote software version OpenSSH_5.5p1 Debian-6+squeeze1+github9
    debug1: match: OpenSSH_5.5p1 Debian-6+squeeze1+github9 pat OpenSSH*
    debug1: Enabling compatibility mode for protocol 2.0
    debug1: Local version string SSH-2.0-OpenSSH_5.6
    debug1: SSH2_MSG_KEXINIT sent
    debug1: SSH2_MSG_KEXINIT received
    debug1: kex: server->client aes128-ctr hmac-md5 none
    debug1: kex: client->server aes128-ctr hmac-md5 none
    debug1: SSH2_MSG_KEX_DH_GEX_REQUEST(1024<1024<8192) sent
    debug1: expecting SSH2_MSG_KEX_DH_GEX_GROUP
    debug1: SSH2_MSG_KEX_DH_GEX_INIT sent
    debug1: expecting SSH2_MSG_KEX_DH_GEX_REPLY
    debug1: Host 'github.com' is known and matches the RSA host key.
    debug1: Found key in /Users/Anders/.ssh/known_hosts:1
    debug1: ssh_rsa_verify: signature correct
    debug1: SSH2_MSG_NEWKEYS sent
    debug1: expecting SSH2_MSG_NEWKEYS
    debug1: SSH2_MSG_NEWKEYS received
    debug1: Roaming not allowed by server
    debug1: SSH2_MSG_SERVICE_REQUEST sent
    debug1: SSH2_MSG_SERVICE_ACCEPT received
    debug1: Authentications that can continue: publickey
    debug1: Next authentication method: publickey
    debug1: Offering RSA public key: /Users/Anders/.ssh/id_rsa
    debug1: Authentications that can continue: publickey
    debug1: Trying private key: /Users/Anders/.ssh/id_dsa
    debug1: No more authentication methods to try.
    Permission denied (publickey). 
```

我正在跟踪的存储库：

```
$ git remote -v
heroku  git@heroku.suggestion-box-app:hidden-inlet-6102.git (fetch)
heroku  git@heroku.suggestion-box-app:hidden-inlet-6102.git (push)
origin  git@github.com:andersr/suggestion-box-app.git (fetch)
origin  git@github.com:andersr/suggestion-box-app.git (push) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T12:45:14.447

[遵循@Ric](https://stackoverflow.com/users/2089625/ric)的建议并使用[这些说明](https://help.github.com/articles/generating-ssh-keys)重新添加了我的公钥，从而解决了问题。感谢大家的帮助！

# python - 字典：打印字典中从最大值到最小值的整个列表

> ID：15733542
> 
> 赞同：0
> 
> 时间：2013-03-31T19:24:40.543
> 
> 标签：python, dictionary, max, key-value

大家好，我有一个关于根据字典中的项目数打印最大值到最小值的问题。

我需要一个完整的密钥**列表**，上面印有密钥旁边显示的次数。

基于这两个列表：

```
Teams = ['Boston Americans','World Series Not Played in 1904','New York Giants',
         'Chicago White Sox','Chicago Cubs','Chicago Cubs','Pittsburgh Pirates',
         'Philadelphia Athletics']

 Year = [1903,1904,1905,1906,1907,1908,1909,1910] 
```

如何根据每个团队拥有的项目数量打印以下内容：

```
D = {Teams,Year} 
```

我忘了提到我正在从 txt 文件中读取这个。

**更新**

```
def Team_data(team,year):
      D = defaultdict(list)
      for team,year in zip(team,year):
          D[team].append(year)
      pprint(D)
return D 
```

然后它将返回：

```
D = {'Boston Americans':1903,'World Series Not Played in 1904':1904, 
 'New York Giants':1905,'Chicago White Sox': 1906,'Chicago Cubs': 1907,
 'Chicago Cubs':1908,'Pittsburgh Pirates':1909,'Philadelphia Athletics':1910}

Team_max = [] 
```

打印时，我在列表中得到以下内容

```
Chicago Cubs, 2
Boston Americans, 1
World Series Not Played in 1904, 1
New York Giants, 1
Chicago White Sox, 1
Pittsburgh Pirates, 1
Philadelphia Athletics, 1 
```

我正试图从制作

团队 = 关键和年份 = 价值
`Chicago Cubs:[1907,1908]`

团队 = 键和显示次数 = 值
`Chicago Cubs:[2]`

我根据阅读的内容尝试使用以下内容：

```
def Team_data_max(D):
    key = D.keys()
    value = D.values()
    team_max = []
    team_max = sorted(D, key=lambda key: len(D[key]))
    print(team_max)
    #Print 1 Key based and 1 max number of items in dictionary
    #Chicago Cubs, 2 
```

或者这个

```
 team_max = []
    team_max = max(((k, len(v)) for k, v in D.items()), key=lambda x: x[1])
    print(Series_max)
    #Print the entire key list least to greatest without a number which is what I need
    #based on the items list 
```

然后这个

```
 s = []
    s = [k for k in D.keys() if len(D.get(k))==max([len(n) for n in D.values()])]
    print(s)
    #print max key without number
    #Chicago Cubs 
```

虽然我在第二个函数中更接近了，但我只需要这个数字。关于如何解决这个问题的任何想法？任何想法或指导表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:08:06.513

你的意思是这样的吗？

```
from collections import defaultdict
Teams = ['Boston Americans','World Series Not Played in 1904','New York Giants',
         'Chicago White Sox','Chicago Cubs','Chicago Cubs','Pittsburgh Pirates',
         'Philadelphia Athletics']

Year = [1903,1904,1905,1906,1907,1908,1909,1910]
d=defaultdict(list)
for x,y in zip(Teams,Year):
    d[x].append(y)

for k,v in sorted(d.items(),key=lambda y:len(y[-1]),reverse=True):
    print "{0} {1}".format(k,",".join(map(str,v))) 
```

**输出：**

```
Chicago Cubs 1907,1908
Chicago White Sox 1906
New York Giants 1905
World Series Not Played in 1904 1904
Philadelphia Athletics 1910
Pittsburgh Pirates 1909
Boston Americans 1903 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T20:31:27.080

不太确定你想在这里做什么。也许读一点听写？重复键-> 允许？这是我如何理解您的问题的解决方案：

```
Teams = ['Boston Americans','World Series Not Played in 1904','New York Giants',
         'Chicago White Sox','Chicago Cubs','Chicago Cubs','Pittsburgh Pirates',
         'Philadelphia Athletics']
Year = [1903,1904,1905,1906,1907,1908,1909,1910]

l = zip(Teams, Year)
d = {}
for e in l:
    if e[0] not in d:
        d[e[0]] = [e[1]]
    else:
        d[e[0]].append(e[1])

#Max Item
s = sorted(d.items(), key=lambda x: len(x[1]))[-1]
print("%s - %s" % (s[0], len(s[1])))

# Entire list
for k, v in sorted(d.items(), key=lambda x: -len(x[1])):
    print("%s - %s" % (k, len(v))) 
```

如果您之后确实需要 dict，这是一个解决方案。请注意，排序将芝加哥按上面生成的列表长度放在最后一个位置。然后通过 [-1] 获取最后一项。

# python - time.time() 溢出/翻转

> ID：15733544
> 
> 赞同：4
> 
> 时间：2013-03-31T19:24:45.117
> 
> 标签：python, time

所以我在我的 python 模块中使用 time.time() 来跟踪执行时间并在超时时充当 while 循环转义。

我的问题是 time.time() 何时翻转/溢出。或者是吗？我还没有完全理解 python 数据类型，所以我不确定它可以持续增长多远。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T19:36:42.450

这将是一段时间。[以epoch](http://en.wikipedia.org/wiki/Epoch_%28reference_date%29#Computing)`time.time()`的形式返回以秒为单位的时间。在 UNIX 机器上，纪元通常是 1970-1-1。IIRC，Windows 上的时代是 1601-1-1。`float`

根据`sys.float_info`：

```
In [2]: sys.float_info
Out[2]: sys.float_info(max=1.7976931348623157e+308, max_exp=1024, max_10_exp=308, min=2.2250738585072014e-308, min_exp=-1021, min_10_exp=-307, dig=15, mant_dig=53, epsilon=2.220446049250313e-16, radix=2, rounds=1) 
```

所以我们有

```
In [3]: 1.7976931348623157e+308/(3600*24*365.0)
Out[3]: 5.700447535712569e+300 
```

翻车前几年。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-27T16:18:54.310

使用 time.clock() 会更准确。

# google-app-engine - ndb 模型的 _post_put_hook 什么时候有与自己不同的未来？

> ID：15733546
> 
> 赞同：6
> 
> 时间：2013-03-31T19:24:57.347
> 
> 标签：google-app-engine, app-engine-ndb

Google App Engine 的 ndb 提供了一个[`_post_put_hook(self, future)`](https://developers.google.com/appengine/docs/python/ndb/modelclass#Model__post_put_hook)，记录如下：

> 在 put() 之后运行的钩子

为了更好地理解这个钩子，我想知道什么时候`self`会与`future`论证的结果不同。

[模型挂钩](https://developers.google.com/appengine/docs/python/ndb/entities#hooks)文档提供：

> 如果你使用带有异步 API 的后挂钩，挂钩会通过调用 check_result()、get_result() 或产生（在 tasklet 中）异步方法的未来来触发。Post hook 不检查 RPC 是否成功；无论失败，钩子都会运行。
> 
> 所有 post-hook 在调用签名的末尾都有一个 Future 参数。此 Future 对象保存操作的结果。您可以在此 Future 上调用 get_result() 来检索结果；您可以确定 get_result() 不会阻塞，因为 Future 在调用钩子时已经完成。

但是，当我`put`像这样异步调用时：

```
from google.appengine.ext import ndb

class MyModel(ndb.Model):
   xyz = ndb.StringProperty()

   def _post_put_hook(self, future):
      print "self.xyz: {}, future.xyz: {}".format(
             self.xyz, future.get_result().get().xyz))

m = MyModel()
f = m.put_async()
f.wait()

m.xyz = 'abc'
f = m.put_async()
f.wait() 
```

输出：

```
self.xyz: None, future.xyz: None
self.xyz: abc, future.xyz: abc 
```

在“put_async”的上下文中，我认为人们可能合理地期望 是`self`修改前的模型，而`future`是现在保存的模型。否则，不清楚`future`在`put`上下文中会有什么目的。

在 a 的上下文中什么时候会`self`和不同？来这里的目的是什么？`future``put``future`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-01T13:17:26.437

我相信答案在描述中：

> Post hook 不检查 RPC 是否成功；**无论失败，钩子都会运行**。

未来可以包含在执行`put()`. 您可以使用此知识通过使用挂钩来处理放置失败的情况。例如，如果您`_post_put_hook`负责根据模型的属性递增关联的 SUM 聚合模型，它可以先检查是否`put`成功，然后再尝试递增关联的 SUM 聚合模型。只要 RPC 没有失败，我不相信它的价值`self`并将永远不同。`future.get_result().get()`

总是有可能另一个请求在此请求之后`put`但在`_post_put_hook`执行之前更新了模型，其中`future.get_result().get(use_cache=False)`可能返回不同的值。

# html - 定义列表的 CSS 样式

> ID：15733548
> 
> 赞同：0
> 
> 时间：2013-03-31T19:25:15.073
> 
> 标签：html, css

我有一个标题/值列表。我在想一个定义列表是要走的路。我希望标题和定义在同一行，并且我不希望标题彼此具有相同的宽度，但每个标题的宽度都取决于标题中的文本量。我还希望定义保留在它们的块内，而不是在标题下流血。最后，我希望它可以与 IE7 及更高版本一起使用。

好的，我想出了以下 HTML/CSS，它几乎可以工作。[我在http://jsfiddle.net/s45Kd/](http://jsfiddle.net/s45Kd/)上有一个实时示例，因为我不知道如何在 stackoverflow 窗口中添加 CSS（可能吗？）。两个问题。

首先，即使定义中没有任何空格（即“电子邮件”），我如何强制定义中断？

其次，为什么长定义最终会在标题下流血（即“某些文本”）？

虽然我会很感激“只是这样做”，但我更多的是寻找为什么会发生这种情况，以便我更好地理解。

谢谢

```
<style type="text/css">
    dl,dt,dd {padding:0;margin:0;}
    dl {width:200px;border:1px dashed black;}
    dt {float:left;font-weight:bolder; padding-right:5px; border:1px dashed red;}
    dd {border:1px dashed blue;}
</style> 
<dl>
    <dt>First Name:</dt><dd>Bob</dd>
    <dt>Last Name:</dt><dd>Johnson</dd>
    <dt>Email:</dt><dd>bob.johnson@stackoverflow.com</dd>
    <dt>Phone Number:</dt><dd>(555) 555-1212</dd>
    <dt>Some Text:</dt><dd>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</dd>
    <dt>Birthday</dt><dd>January 1st</dd>
</dl> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-31T19:31:41.273

首先，可以通过设置来解决自动换行：

```
word-wrap: break-word; 
```

对于第二个，关键是同时设置`overflow: hidden;`和`dt`元素`dd`，同时仍然只浮动`dt`.

这个 jsFiddle 中的演示：http: [//jsfiddle.net/fLPej/108/](http://jsfiddle.net/fLPej/108/)

# android - 如何同时捕获相机图像缩略图和完整图像

> ID：15733549
> 
> 赞同：3
> 
> 时间：2013-03-31T19:25:15.690
> 
> 标签：android, image, camera, save, capture

看起来在相机图像捕捉中，一个人只能捕捉缩略图或完整图像，但不能同时捕捉两者，因为

```
 public void startCamera() {
 ...
    camera.putExtra("output", imageUri); (step 1)
 ... 
```

需要先声明

```
 ...
 startActivityForResult(camera, IMAGE_CAPTURE); (step 2)
 ...
    Bundle extras = camera.getExtras();
    mImageBitmap = (Bitmap) extras.get("data");
    imageView.setImageBitmap(mImageBitmap);
 ... 
```

但是一旦“onActivityResult”返回，完整的图像已经保存到 imageUri 并且缓冲区被清除。但是要捕获所拍摄图像的缩略图，需要在“startActivityForResult”之后执行代码。问题是在步骤 2 中保存图像后，图像缓冲区被清除。要捕获图像缩略图，需要跳过在步骤 1 中保存完整图像，以便在步骤 2 中捕获缩略图图像。

我可以使用替代方法来保存完整图像，将完整图像重新加载到位图中，将图像缩放为缩略图大小并重新保存图像，但这似乎是多余的。知道我是否可以一次性完成这两项工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T21:39:52.390

查看 MediaStore.Images.Thumbnails，特别是 getThumbnail（靠近底部）：http: [//developer.android.com/reference/android/provider/MediaStore.Images.Thumbnails.html](http://developer.android.com/reference/android/provider/MediaStore.Images.Thumbnails.html)。

如果这不起作用，是的，您必须自己手动重新缩放并保存缩略图。

# javascript - 动态选择选项列表重置为第一个值

> ID：15733550
> 
> 赞同：0
> 
> 时间：2013-03-31T19:25:19.753
> 
> 标签：javascript, option

我有一个动态填充的`<select>`列表，其中第一个选项是在页面首次加载时由 HTML 和 PHP 创建的，但是当您下拉时，javascript 会填充附加选项的列表。但是，当我选择一个选项并移除焦点时，它会重置为原始选择的选项。我很确定我正在做的事情没有得救，但我不知道如何解决它。

这是 HTML，可以正常工作：

```
<select name="select1" id="select1" onfocus= "checkSelect(this.value)">
<option value ="XXX">XXX</option>
</select> 
```

该`checkSelect()`函数做了很多事情，但随后以如下方式结束：

```
//do a bunch of stuff, ending in populating the 'legal' array. 

document.input_form.select1.options.length=1; 
//which I think is actually redundant

for (i=0; i < legal.length; i++)
    {
        document.input_form.select1.options[i+1]=new 
        Option(legal[i], legal[i], false, false);
    } 
```

我是否遗漏了使该选项保留在页面上的必要内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:59:02.027

我能想到这种行为的唯一原因将被`select1`包装到 unclosed tag`<label>`中，例如：

```
<label>label <!--may be missing </label> here -->
    <select name="select1" id="select1" onfocus="checkSelect(this.value)">      
        <option value ="XXX">XXX</option>
    </select> <!--may be missing </label> here --> 
```

# javascript - 使用带有ajax内容的fancybox时如何防止外部滚动？

> ID：15733554
> 
> 赞同：1
> 
> 时间：2013-03-31T19:25:26.203
> 
> 标签：javascript, jquery, html, fancybox, fancybox-2

我正在使用[fancyBox](https://github.com/fancyapps/fancyBox)将 Ajax 内容加载为：

```
<a href="/example.html" class="fancybox fancybox.ajax">Example</a>

<script>
$(document).ready(function() {
    $('.fancybox').fancybox();
});
</script> 
```

该文档说，如果您设置，您可以防止外部滚动：

```
scrollOutside = false 
```

但这在加载 ajax 内容时不起作用。

当fancyBox可见时，如何防止fancyBox外部的滚动不出现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:32:25.300

尝试这个：

```
 $(document).ready(function() {
    $('.fancybox').fancybox({
        scrollOutside: false
    });
}); 
```

# python - 在 Python 中检查用户错误

> ID：15733555
> 
> 赞同：0
> 
> 时间：2013-03-31T19:25:39.403
> 
> 标签：python, if-statement, for-loop, while-loop

我正在尝试分析用户输入并且只允许输入整数。我已经成功地只允许在一定范围内使用 100 的面额，但我无法弄清楚如何提示用户在输入随机字符串时重新输入数据。尝试使用“try”命令只会导致程序卡住：

```
while True:
  try:
    bet=int(raw_input('Place your bets please:'))
  except ValueError:
    print 'l2type'
#The following receives a betting amount from the user, and then assesses whether it is a legal bet or not. If not, the user is prompted to enter a legal bet.
while True:
 if bet%100==0 and 100<=bet<=20000:
    print bet,"Your bet has been accepted, can you make a million?"
    break
 else:
    print bet,"Please enter a legal bet. The table minimum is 100, with a maximum of 20000 in increments of 100."
    bet = input('Place your bets please:') 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T19:32:25.087

您有拒绝非整数输入的正确方法，但如果您的用户输入有效输入，您需要跳出循环。使用 break 语句：

```
while True:
    try:
        bet=int(raw_input('Place your bets please:'))
        break # we only get here if the input was parsed successfully
    except ValueError:
        print 'l2type' 
```

您可能还想在循环内移动范围检查。如果超出范围的输入自然不会导致异常，请使用 if 语句确保仅在输入完全有效时才执行“break”。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-31T20:31:09.707

我更喜欢我的递归版本：

```
def ask_bet(prompt):
    bet = raw_input(prompt)

    # Validation. If the input is invalid, call itself recursively.
    try:
        bet = int(bet)
    except ValueError:
        return ask_bet('Huh? ')
    if bet % 100 != 0:
        return ask_bet('Huh? ')
    if not 100 <= bet <= 20000:
        return ask_bet('Huh? ')

    # The input is fine so return it.
    return bet

ask_bet("Place your bets please: ") 
```

在我看来，这比 while 循环更干净、更容易阅读。在第一次迭代之后，您不必担心什么是属性值？添加新的验证规则也很简单。

一般来说，我尽量避免使用 while 循环来支持递归版本。当然，并非一直如此，因为它更慢并且堆栈不是无限的。

# java - Java - BufferedImage - 每次迭代后清除屏幕

> ID：15733556
> 
> 赞同：3
> 
> 时间：2013-03-31T19:25:49.573
> 
> 标签：java, bufferedimage

我在透明背景上绘图，但在每个循环中，我希望清除屏幕，而不是从以前的屏幕上绘图。

有没有办法在 Java 中擦除绘图屏幕？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-31T19:28:08.580

您可能正在寻找[`Graphics#clearRect()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/awt/Graphics.html#clearRect(int,%20int,%20int,%20int)). 不过，您可能需要将表面背景设置为透明颜色：

```
graphics.setBackground(new Color(255, 255, 255, 0)); 
```

# python - Python OrderedDict 不保持元素顺序

> ID：15733558
> 
> 赞同：50
> 
> 时间：2013-03-31T19:25:51.267
> 
> 标签：python, python-2.7, ordereddictionary

我正在尝试创建一个 OrderedDict 对象，但我一创建它，元素就变得混乱了。

这就是我所做的：

```
from collections import OrderedDict
od = OrderedDict({(0,0):[2],(0,1):[1,9],(0,2):[1,5,9]}) 
```

元素不会按照我指定的顺序

```
od
OrderedDict([((0, 1), [1, 9]), ((0, 0), [2]), ((0, 2), [1, 5, 9])]) 
```

docs.python.org 没有示例，我无法弄清楚为什么订单会变得混乱。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2013-03-31T19:27:29.490

您的问题是您正在构建 a`dict`以将初始数据提供给`OrderedDict`- 这`dict` *不*存储任何订单，因此订单在到达`OrderedDict`.

解决方案是从有序数据类型构建 - 最简单的是 a `list`of `tuple`s：

```
>>> from collections import OrderedDict
>>> od = OrderedDict([((0, 0), [2]), ((0, 1), [1, 9]), ((0, 2), [1, 5, 9])])
>>> od
OrderedDict([((0, 0), [2]), ((0, 1), [1, 9]), ((0, 2), [1, 5, 9])]) 
```

值得注意的是，这就是为什么`OrderedDict`使用它为字符串表示的语法 - 字符串表示应该尝试成为有效的 Python 代码以尽可能重现对象，这就是输出使用元组列表而不是 dict 的原因。

编辑：[从 Python 3.6 开始，`kwargs`是 ordered](https://docs.python.org/3/whatsnew/3.6.html#pep-468-preserving-keyword-argument-order)，因此您可以使用关键字参数，前提是您使用的是最新的 Python 版本。

[从 3.7](https://docs.python.org/3.7/whatsnew/3.7.html)开始，对于 s 也是如此`dict`（在 3.6 中适用于 CPython，但语言规范没有指定它，因此`OrderedDict`仍需要 using 以实现兼容性）。这意味着如果您可以假设 3.7+ 环境，您通常可以完全放弃，或者如果您需要特定功能（例如：为了平等）`OrderedDict`，则从常规构建一个。`dict`

# database - redis 的正确用例

> ID：15733565
> 
> 赞同：1
> 
> 时间：2013-03-31T19:26:46.583
> 
> 标签：database, node.js, web-applications, nosql, redis

我对 noSQL 完全陌生，并且只真正涉足过 SQL。但是我可以清楚地看到 noSQL 将更适合我的应用程序数据，因为它不适合传统的表模型。

但是我担心我会花时间来实施和理解一个解决方案，该解决方案后来证明不适合我的应用程序，并且无法按照我的假设工作。

我倾向于[redis——](http://redis.io/)尽管我对它的阅读内容并不了解。我需要知道它是否能够完成我想要它做的事情，它对于我想做的事情是否是一个不错的选择，以及在冒险使用它之前我是否应该知道任何有用的东西，或者这将简化我的流程。**我的应用程序是用 javaScript 编写的，由 node.js 提供支持。**

这是我需要的数据库中的内容：

**快速存储实时数据**，我想存储用户所做的每一个动作。考虑到我的应用程序需要高水平的用户参与，这将是一个源源不断的信息流。我读过 redis 是一个非常快的内存数据库。

**可靠性**——这是我听说redis有弱点的一个领域，人们说它的持久性不应该用于敏感数据。是否可以可靠地将用户的数据卸载到磁盘并在他们下次返回时重新加载？这样的操作是快还是慢（我知道这取决于数据 - 但你会亲自执行这样的操作吗，因为我不知道会发生什么？） - 也许将 redis 信息存储在 SQL 中会更好用户完成修改后的数据库？

扩展可靠性案例，假设我有以下关键：

`user:id:appData`

是否可以在`user:1:appData`不影响`user:2:appData`或任何其他的情况下删除所有内容`user:id:appData`？

**并发 -** redis 可以同时处理许多用户的写入吗？怎么查询？

感谢您的时间。

# php - 将敏感图像保存在数据库或网络目录中？

> ID：15733580
> 
> 赞同：0
> 
> 时间：2013-03-31T19:28:38.987
> 
> 标签：php, mysql, database, image, security

我正在为客户开发一个在线照片证明系统，客户被赋予密码并且必须登录才能查看他们的相册。有些图像可能是敏感/裸照，其他人不应该看到。但如果黑客非常聪明，他/她可以直接输入 URL。但是话又说回来，他必须知道图像的每个名称和确切的文件夹结构......服务器已设置好，因此您必须知道确切的 url。您无权查看文件夹结构/文件树。我无法覆盖 .htaccess 文件。

这是一个安全风险，应该让我将图像存储在 mySQL 数据库中，而不是将文件保存到目录中？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:34:05.047

为永远的 img id 在数据库中放置标志，即 1 用于公共 2 用于成人，因此如果用户在上传时检查它的成人内容，则在数据库中插入标志“2”。因此，之后，检查请求的图像是否具有标志 1，如果为 false，则检查 $_SESSION 是否填充了用户所有者的标志，如果是外国人会话 - 不显示内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T19:34:48.573

创建一个长的随机字符串并将其保存到用户对应的位置。然后将很难通过检查凭据来暴力破解和限制用户的前端访问

# java - 将字符串转换为文本 (Java Hadoop)

> ID：15733581
> 
> 赞同：6
> 
> 时间：2013-03-31T19:28:40.197
> 
> 标签：java, string, text, hadoop

我有以下问题：

我想拆分从文件中获取的文本值。

值格式为“12,23”

我想取变量 a=12 中的第一个值和变量 b=23 中的第二个值。

我使用 String.split(","); 要做到这一点。问题是我想在 Text 变量中分配这些值。

我尝试了以下方法，但它不起作用

```
Text text=(Text) a; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-31T19:32:28.257

使用构造函数[`Text(String string)`](http://hadoop.apache.org/docs/current/api/org/apache/hadoop/io/Text.html#Text%28java.lang.String%29)：

```
String s = "12,23";
String[] array = s.split(",");
Text t1 = new Text(array[0]);
Text t2 = new Text(array[1]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:33:52.720

你在分裂的正确轨道上。

```
String s;
Text a, b;
s = "12,23";
String[] tokens = s.split(",");
a = new Text(tokens[0]);
b = new Text(tokens[1]); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-01T10:18:25.340

创建两个文本变量：

```
Text a = new Text();
Text b = new Text(); 
```

...然后将值拆分为：

`String columns[]=value.toString().split("\\\,");`

最后将文本变量的值设置为：

```
a.set(columns[0]);
b.set(columns[1]); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-31T19:37:08.847

尝试一下

```
Text text=a.ToString(); 
```

看到同样的问题和答案

[在 Google App-Engine JAVA 中将文本转换为字符串，反之亦然](https://stackoverflow.com/questions/2819896/converting-text-to-string-and-vise-versa-in-google-app-engine-java)

# iphone - 表格视图混合了图像

> ID：15733584
> 
> 赞同：1
> 
> 时间：2013-03-31T19:29:09.593
> 
> 标签：iphone, ios, uitableview, sdwebimage

我使用[SDWebImage](https://github.com/rs/SDWebImage)在 TableView 中加载和显示异步图像。但有时当我快速上下滚动时，它会混合所有图像并将其显示在其他行中。这是我的 cellForRowAtIndexPath：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";

    CustomTableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {

        cell = [[CustomTableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];

    } 

// Configure the cell.

MWFeedItem *item = [itemsToDisplay objectAtIndex:indexPath.row];

if (item) {

        // Parse out Image URL for cell

        if (cell.imageView.image == nil) {

        NSError *error = NULL;

        NSRegularExpression *regexImage = [NSRegularExpression regularExpressionWithPattern:@"(<img\\s[\\s\\S]*?src\\s*?=\\s*?['\"](.*?)['\"][\\s\\S]*?>)+?"

                                                                               options:NSRegularExpressionCaseInsensitive

                                                                                error:&error];
        [regexImage enumerateMatchesInString:item.content

                                options:0

                                  range:NSMakeRange(0, [item.content length])

                             usingBlock:^(NSTextCheckingResult *result, NSMatchingFlags flags, BOOL *stop) {

                                 NSString *src = [item.content substringWithRange:[result rangeAtIndex:2]];

                                 NSLog(@"img src: %@", src);

                                 [cell.imageView setImageWithURL:[NSURL URLWithString:src]];

                             }];}

        if (cell.imageView.image  == nil) {

            cell.imageView.image = [UIImage imageNamed:@"video.png"];

}

    return cell;

} 
```

我不知道出了什么问题，但我认为是因为我解析单元格中的图像并且速度不够快，所以它一次又一次地开始。你能告诉我如何解决这个问题吗

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-31T20:08:49.377

我相信，高级别的答案是，当您滚动时，您会在完成将图像放入其中之前重用单元格。*无论如何，当我*在代码中看到它时，这就是它的意思。

我不使用 SDWebImage 并且我不确切知道 setImageWithURL 变体是什么，但是 github 网页有一个使用方法，说你可以给它一个完成块以在图像获取完成时执行（成功或失败）。因此，您需要检查，当您最终获得图像但在将其放入 UITableViewCell 之前，该单元格是否仍分配给与您开始获取图像时相同的 indexPath。由于 setImageWithURL 似乎总是设置图像，因此您必须放置一个临时 UIImageView 而不是直接在单元格中。我查看的文档有一个带有 placeHolderImage: 和 completed: 的方法调用：使用它你会做类似的事情（代码未经过编译器检查）：

```
// before you go off to get the image, save the indexPath of the cell
NSIndexPath *originalIndexPath = indexPath;
UIImageView *tempImageView;
[tempImageView setImageWithURL:[NSURL URLWithString : [NSURL URLWithString:src]]
           placeholderImage:[UIImage imageNamed:@"placeholder.png"]
                  completed:^(UIImage *image, NSError *error, SDImageCacheType cacheType) {
    // completion block
    // You probably want to check that it really succeeded, but if it did
    // Now you have an image in the image parameter and probably in tempImageView.
    // Check to see if the cell is still at the original indexPath
    // If so, put the image in.
    // If not, the row was scrolled out of sight and the cell has been reused
    // so just drop the image on the floor -- it is no longer useful
    NSIndexPath *currentIndexPath = [self.tableview indexPathForCell:cell]
    if ([currentIndexPath isEqual originalIndexPath]) {
        cell.imageView.image = image;
        // or perhaps: cell.imageView.image = tempImageView.image;
    }
}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T20:53:17.630

更改单元格标识符

```
static NSString *CellIdentifier = @"Cell"; 
```

到

```
NSString *CellIdentifier = [NSString stringWithFormat:@"Cell%i",indexPath.row]; 
```

# javascript - 在完全加载之前不要显示社交按钮（通过 jquery 加载）

> ID：15733586
> 
> 赞同：0
> 
> 时间：2013-03-31T19:29:29.043
> 
> 标签：javascript, jquery, css, wordpress, social

在我的 wordpress 网站中，我使用聚集在酒吧中的社交按钮。

当通过 jquery-ajax 更新内容时，这些按钮会动态更新。

```
function update_social(str)
{
            $(".dd_outer").fadeOut("slow");     
            UpdateLikeButton(str);
        UpdateTweetButton(str);
        UpdatePlus1Button(str);

            $(".dd_outer").fadeIn('slow')

} 
```

其中`str`参数是帖子的ID。并且`dd_outer`是浮动条的包装 div。`update_social`当我调用负责通过 AJAX 动态加载帖子内容的函数时，我正在调用它。

一切都像魅力一样，但问题是，有时在社交按钮完全加载之前，栏就会消失。在加载所有按钮之前，如何使总栏不出现？

想`FadeIn`了`FadeOut`就够了。感谢您的帮助。

**编辑：**

```
function UpdateLikeButton(str)
        {
            var elem = $(document.createElement("fb:like"));
            elem.attr("href", "http://www.bag.com/Arabic/Arra2issia/"+str+"/");
            elem.attr("send", "false");
            elem.attr("layout", "box_count");
            elem.attr("show_faces", "false");
            $("#zzzz").empty().append(elem);
            FB.XFBML.parse($("#zzzz").get(0));
        }           

function UpdateTweetButton(str)
        {

            var elem3 = $(document.createElement("a"));
            elem3.attr("class", "twitter-share-button");
            elem3.attr("href","http://twitter.com/share");
            elem3.attr("data-url","http://www.bagh.com/"+str+"/");
            elem3.attr("data-counturl","http://www.bagh.com/"+str+"/");
            elem3.attr("data-count", "vertical");
            elem3.attr("data-via", "#");
            elem3.attr("data-text",str);
            elem3.attr("data-lang","en");
            $("#tweet").empty().append(elem3);

            $.getScript("http://platform.twitter.com/widgets.js",function(){
            twttr.widgets.load();

            });
        }   

 function UpdatePlus1Button(str)
        {
            var elem4 = $(document.createElement("g:plusone"));

            elem4.attr("href","http://www.bagh.com/"+str+"/");
            elem4.attr("size", "tall");

            $("#plus1").empty().append(elem4);

            $.getScript("https://apis.google.com/js/plusone.js");
        } 
```

原始按钮：

```
 <div id="zzzz" ><fb:like href="<?php the_permalink();?>" send="false" show_faces="false" layout="box_count"></fb:like></div>

<div id="plus1"><g:plusone size='tall' href='<?php the_permalink();?>'></g:plusone></div>

<div id="tweet"><a href="http://twitter.com/share" class="twitter-share-button" data-url="<?php the_permalink();?>" data-counturl="<?php the_permalink();?>" data-count="vertical" data-via="#" data-text="<?php the_ID();?>" data-lang="en"></a></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:35:11.353

我认为您可能需要在 fadeOut 函数的回调中调用代码，以便它在栏淡出之前不会运行...尝试

```
function update_social(str)
{
  $(".dd_outer").fadeOut("slow");

   UpdateLikeButton(str);
   UpdateTweetButton(str);
   UpdatePlus1Button(str);

   //Make fadeIn wait 1 second before running to allow button functions to complete
   setTimeout(function(){
     $(".dd_outer").fadeIn('slow');
   },1000);

}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:58:43.370

像这样添加`return`你的`functions`：

```
function UpdateTweetButton(str)
        {
            var elem3 = $(document.createElement("a"));
            elem3.attr("class", "twitter-share-button");
            elem3.attr("href","http://twitter.com/share");
            elem3.attr("data-url","http://website/"+str+"/");
            elem3.attr("data-counturl","http://website/"+str+"/");
            elem3.attr("data-count", "vertical");
            elem3.attr("data-via", "#");
            elem3.attr("data-text",str);
            elem3.attr("data-lang","en");
            $("#tweet").empty().append(elem3);

     return $.getScript("http://platform.twitter.com/widgets.js",function(){
            twttr.widgets.load();
            });
        }   

 function UpdatePlus1Button(str)
        {
            var elem4 = $(document.createElement("g:plusone"));
            elem4.attr("href","http://website/"+str+"/");
            elem4.attr("size", "tall");
            $("#plus1").empty().append(elem4);
     return $.getScript("https://apis.google.com/js/plusone.js");
        } 
```

像这样称呼他们：

```
function update_social(str)
{
          $(".dd_outer").fadeOut("slow");     
            UpdateLikeButton(str);
          $.when(UpdateTweetButton(str), UpdatePlus1Button(str)).done(function(){
             $(".dd_outer").fadeIn('slow');
          });
} 
```

# java - 销毁 Jframe 对象

> ID：15733587
> 
> 赞同：6
> 
> 时间：2013-03-31T19:29:30.100
> 
> 标签：java, swing, jframe

我如何销毁 Jframe 对象（就像不应该留下任何引用一样），因为我正在为 iTunes 之类的应用程序实现多用户登录系统，以便用户可以添加歌曲删除歌曲。我有 3 帧 loginFrame、adminFrame、nonAdminFrame .. loginFrame = 登录启动 nonAdminFrame 处理添加删除歌曲的地方 正在处理登录，因为我有数据文件夹，其中 .txt 文件用于写入包含歌曲的用户对象info 类型的链表。我登录的方式我查看了数据文件夹，看看是否有名为 user1.txt 文件的 .txt 文件，它会将所有数据加载到 nonadminFrame ... 问题是登录无法正常工作，因为它引用了旧的 nonAdminFrame以前的用户数据仍然存在的地方......

我有 3 个类或 3 个 JFrame。主类是 loginFrame。我获取登录信息并查看用户是管理员还是非管理员，然后通过创建新的 adminFrame() 对象或 nonAdminFrame() 对象来显示管理员或 nonadminFrame，然后我设置 loginFrame.setVisible(false); 问题在于所有 iTunes 库的东西都发生在 nonAdminFrame 上。我有 JTree 来显示该用户的所有歌曲，一旦点击注销，我使用 frame.dispose() 处理 nonAdmin 框架，但如果我再次登录，再次创建 nonadminFrame() 对象，我会看到旧用户的数据在JTree那个问题...

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-31T19:36:12.043

您的 user1.txt 文件中是否有办法注意到该用户是否是管理员？你的问题不是很清楚，但你应该能够做这样的事情：

```
JFrame frame = new JFrame();
frame.dispose(); 
```

编译器将逐字处理此帧并使用垃圾收集器自动清理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-31T19:52:36.827

这也做同样的事情：

```
frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE); 
```

根据以下文章，这还将释放框架使用的任何资源：http: [//docs.oracle.com/javase/tutorial/uiswing/components/frame.html](http://docs.oracle.com/javase/tutorial/uiswing/components/frame.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-31T21:26:59.163

[如此处](https://stackoverflow.com/a/6310284/230513)所示，您无法*完全*回收已处理帧的内存。相反，创建一个具有单个面板的单个框架，用于[`CardLayout`](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)显示登录、管理和用户面板。一个例子可以在[这里](https://stackoverflow.com/a/5655843/230513)看到。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-11-28T20:24:53.453

像其他人说这应该工作

```
JFrame frame = new JFrame();
frame.dispose(); 
```

但是如果您使用单例模式并将 jframe 声明为类成员

```
private static jFrame myframe = null ... singleton pattern...
... 
```

你必须添加这个

```
myframe.dispose();
myframe = null; 
```

# java - 使用虚拟方法表在 C 中动态调度

> ID：15733590
> 
> 赞同：7
> 
> 时间：2013-03-31T19:29:49.937
> 
> 标签：java, c, polymorphism, vtable, dynamic-dispatch

我希望找到在 C 中实现动态调度的提示（最好是通过很好的例子）。

我正在学习 C，作为实践，我想使用动态调度虚拟方法表将 Java 转换为 C。

例如我有一个java代码：

```
abstract class Foo {
    public abstract int val(); 
    public abstract Boolean error();
}

class Fail extends Foo {
    public int val(){ return 0;}
    public Boolean error(){return true;}
}

class IntFoo extends Foo {
    int v;
    public IntFoo(int value){this.value=v;}
    public int val(){ return v;}
    public Boolean error(){return False;}
} 
```

我可以翻译一些基本的东西，比如：

```
typedef struct Foo{
    void(**vtable);
}Foo;

typedef struct Fail{
    void(**vtable);
    struct Foo inherited;
}Fail;

typedef struct IntFoo{
    void(**vtable);
    struct Foo inherited;
}IntFoo; 
```

我在尝试完成此操作时遇到困难，因为我不知道：

1.  如何在 c 中定义这些方法。
2.  设置这些方法的地址，`vtable`以便编译器识别要调用的正确方法。
3.  还有什么要定义以使其工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-31T20:23:50.153

没有简单的方法可以做到这一点。不过，您可以手动执行 C++ 编译器正在执行的操作。在您的情况下，这将如下所示：

```
typedef struct vtable_Fail
{
    int  (*val)(struct Fail *this_pointer);
    bool (*error)(struct Fail *this_pointer);
} vtable_Fail;

typedef struct vtable_IntFoo
{
    int  (*val)(struct IntFoo *this_pointer);
    bool (*error)(struct IntFoo *this_pointer);
} vtable_IntFoo;

int Fail_val(struct Fail *this_pointer)
{
    return 0;
}

...

void IntFoo_ctor(struct IntFoo *this_pointer, int value)
{
     this_pointer->v = value;
}

int IntFoo_val(struct IntFoo *this_pointer)
{
    return this_pointer->v;
}

...

struct Fail
{
    vtable_Fail *vtable;
};

struct IntFoo
{
    vtable_IntFoo *vtable;
    int v;
}; 
```

这个想法是每个结构都应该有一个伴随的 vtable 结构，它存储指向该结构实现的所有虚拟方法的指针。每个 Vtable 结构只有一个实例。它们应该驻留在静态内存中，并且应该使用指向函数的指针来初始化。这些指针应该以每个特定结构所需的方式实现虚拟方法。结构本身可以有很多实例。实例中的 vtable 数据字段应指向其类的静态 vtable 结构。

参数`this_pointer`传递实例的地址。它应该手动传递。这是一天结束时的C。

请注意，您需要分配 vtable 结构、初始化 vtable 指针等。您需要使用自己的代码手动完成所有这些操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-31T20:21:11.773

我推荐的方法是查看其他一些使用调度表的 C 代码并了解它的结构。我突然意识到的具体示例（也许不是最好的教学示例，因为它们只是我研究过的随机免费软件）是 MIT Kerberos 和 Heimdal，它们都使用调度表地点和 Apache Web 服务器以及它如何处理动态加载的模块。这些都没有继承，但继承相对容易添加：您查看您尝试调用的方法是否为 NULL，如果是，则检查该方法的父调度表。

如何在 C 中处理调度表的简短版本通常是定义一个类似于 C++ vtable 的数据结构，它包含函数指针和某种确定要使用哪个指针的方法。就像是：

```
typedef void (*dispatch_func)(void *);
struct dispatch {
    const char *command;
    dispatch_func callback;
}; 
```

是超通用版本，它将字符串方法名称映射到将单个匿名指针作为参数的函数。您的实际调度表将是这些的数组，如下所示（取自 INN 源中的 tinyleaf 的修改示例）：

```
const struct dispatch commands[] = {
    { "help",  command_help },
    { "ihave", command_ihave },
    { "quit",  command_quit }
}; 
```

显然，你对函数了解得越多，你就能做出越具体的原型，你可以在调度表中嵌入其他的选择标准（比如参数的数量）。（实际的 INN 源具有最小和最大参数计数，传入参数结构而不仅仅是 void *，并在调度表中包含命令描述。）

搜索调度表的基本代码非常简单。假设您有一个包含这些调度结构条目的数组以及 in`vtable`中的表的长度`length`，例如：

```
for (i = 0; i < length; i++)
    if (strcmp(command, vtable[i].command) == 0) {
        (*vtable[i].callback)(data);
        return;
    } 
```

要实现继承，您需要父指针，如果您离开循环的末尾，则向上移动到父指针并重复逻辑。（显然，这对于递归函数来说可能是一个有用的地方。）

# node.js - 从与渲染文件快递相同的目录提供静态文件

> ID：15733592
> 
> 赞同：1
> 
> 时间：2013-03-31T19:29:53.020
> 
> 标签：node.js, express

对于 express 中定义的静态文件，我有以下中间件：

```
app.use(express.static(__dirname + '/public'));
app.use('/lessons', express.static(__dirname + '/lessons', { redirect : false })); 
```

在课程文件夹中，我有几个课程文件夹

```
lessons
|-- lesson01
|-- lesson02
.
.
. 
```

在每个课程文件夹中都有一个`lesson.md`我渲染的文件。该文件引用了同一课程文件夹中的图像。我希望能够仅`img01.png`在 markdown 文件中使用例如来引用图像，但 express 期望图像可以`/lessons/img01.png`在`/lessons/lesson01/img01.png`.

在降价`./img01.png`文件中用作对图像的引用也无济于事。

关于如何告诉 express 在同一目录中查找静态文件的任何想法？

谢谢

编辑 ：

多一点信息，

获取课程文件的途径是：

```
app.get('/lessons/:name', function(req, res, next) {
    res.locals.controller = 'lessons';
    var name = req.params.name;
    var lesson = lessons[name];
    if (!lesson) {
      return next();
    }
    lesson.path = 'lessons/' + name;
    lesson.file = lesson.path + '/' + name + '.md';
    markdown(lesson.file, function(result, err) {
      if (err) {
        console.log(err);
      }
      lesson.body = result;
      res.locals.lesson = lesson;
      res.render('lesson');
    });
}); 
```

此外，我正在使用名为[connect-slashes](https://github.com/avinoamr/connect-slashes)的中间件来删除每个 URL 末尾的斜杠。（作为[这个SO问题](https://stackoverflow.com/questions/13442377/redirect-all-trailing-slashes-gloablly-in-express)的结果）

```
var slashes = require('connect-slashes');
var app = express();
app.use(express.static(__dirname + '/public'));
app.use('/lessons', express.static(__dirname + '/lessons', { redirect : false }));
// add middleware to remove trailing slash in urls
app.use(slashes(false)); 
```

# android - OG 请求上的空图形对象

> ID：15733594
> 
> 赞同：0
> 
> 时间：2013-03-31T19:29:58.783
> 
> 标签：android, facebook, facebook-opengraph, facebook-android-sdk

当尝试从原生 Android 应用程序向 Facebook 发布活动时，我在执行请求后收到以下响应：

```
{
    Response: responseCode: 200,
    graphObject: null,
    error: {
        HttpStatus: -1,
        errorCode: -1,
        errorType: null,
        errorMessage: null
    },
    isFromCache: false
} 
```

我的应用程序从用户那里获得了 publish_action 权限。

```
public void publishActivity(){
    session = Session.getActiveSession();
    openSession();

    Bundle params = new Bundle();
    params.putString("highest", "http://www.my-url.com/graph.html");

    Request request = new Request(
            Session.getActiveSession(),
            "me/namespace:play",
            params,
            HttpMethod.POST
        );
        Response response = request.executeAndWait();
    Log.d("DEBUG",response.toString());     
}

public void openSession(){
    if(session.isClosed()){
        Session.OpenRequest openRequest = new Session.OpenRequest(GameActivity.get());
        openRequest.setPermissions(PERMISSIONS);
        session.openForPublish(openRequest);
    }
} 
```

（我替换了 url 和命名空间。在我的代码中，它们是正确的。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T10:12:02.600

问题似乎出在命名空间提供的 KeyHash 中。它已更改，尚未添加到 Facebook 开发人员页面中。

# c++ - 使用 AddFontResource() 将字体的 C++ 查找索引临时添加到系统字体表以在控制台中使用

> ID：15733596
> 
> 赞同：2
> 
> 时间：2013-03-31T19:30:18.510
> 
> 标签：c++, winapi, console-application, custom-font

我正在尝试临时安装要在 win32 控制台中使用的字体

`int AddFontResource(LPCTSTR lpszFilename);`

和

`BOOL WINAPI SetConsoleFont(HANDLE hOutput, DWORD fontIndex)`

我从[这个](http://blogs.microsoft.co.il/blogs/pavely/archive/2009/07/23/changing-console-fonts.aspx)网站获得了这个功能。

尽管这两个功能似乎都可以正常工作，但我不知道如何找到添加的字体索引以与`SetConsoleFont`.

`AddFontResource`不返回临时字体的索引值或键。

这是我的相关代码：

```
#include "Level.h"
#include "ConsoleFont.h" //acquired from above mentioned site

#include <Windows.h>

 //-------------------------------------------------------------------------------

void init();
void cleanup();

int main()
{
   FileManager *pFileManager = new FileManager();     //unrelated
   Level *lvl1 = new Level("filename",pFileManager);  //unrelated

   ///TEMPORARY PLANNING
   // using add font resource. how can i get this fonts index value? 
   int err = AddFontResource(L"Files/gamefont.fnt");
   if (err == 0)
   {
       MessageBox(NULL,L"loading font failed",L"Error",0);
   }
   else
   {  
       wchar_t message[100];
       swprintf_s(message,100,L"AddFontResource returned: %d",err);
       MessageBox(NULL,LPTSTR(message),L"error",0);
   }
   SendMessage(HWND_BROADCAST, WM_FONTCHANGE,0,0); 

   //acquiring handle to current active screen buffer 
   HANDLE tempHandle = GetStdHandle(STD_OUTPUT_HANDLE);
   if (tempHandle == INVALID_HANDLE_VALUE)
   {
    MessageBox(NULL,L"Failed to aquire Screen Buffer handle",L"Error",0);
   }

       //I dont know what to set this to. this is the crux of the problem.
   DWORD  fontIndex = 1;
   if (FALSE == SetConsoleFont(tempHandle,fontIndex))
   {
       MessageBox(NULL,L"loading console font failed",L"Error",0);
   }

    //draws a house when in correct font
    std::cout<<"!!!!!!!!#\n"
         <<"!!!!!!!!!\n"
         <<"! !! !! !\n"
         <<"!!!!!!!!!\n"
         <<"! !! !! !\n"
         <<"!!!!!!!!!\n"
         <<"! !! !! !\n"
         <<"!!!!!!!!!\n"
         <<"! !! !! !#\n"
         <<"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"<<std::endl;

       ///PLANNING OVERS 

    bool quit = false;
    while(!quit)
    {
           //still to be implemented
    }

    err = RemoveFontResource(L"Files/gamefont.fnt");
    if (err==0)
    {
        MessageBox(NULL,L"removing font failed",L"Error",0);
    }
    return 0;
} 
```

我不知道如何找到我的新字体的索引值，或者即使使用我当前的方法可以做到这一点。

如果有人知道或有更好的方法，请帮助我。任何帮助或提示表示赞赏。必须可以在 win32 控制台中使用自定义字体，而无需摆弄注册表。我敢肯定 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T20:04:34.440

不幸的是，你进入了 Win API 的黑暗世界。没有用于控制台字体表查找的文档（或者至少我永远找不到它）。您可以尝试“GetNumberOfConsoleFonts()”方法来查看返回的内容。我认为索引 10 处的字体是 Lucida Console。你得玩一会儿。此外，这可能不适用于您拥有的操作系​​统版本。在 XP 上为我工作。从来没有尝试过其他任何东西。老实说，它也从未完全在 XP 上运行。

对于注册表，

字体注册表在这里：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts 
```

控制台注册表在这里：

```
HKEY_CURRENT_USER\Console 
```

如果您最终修改了注册表，这些更改可能不会立即反映。您需要重新启动控制台或发送特殊的 WM_* 消息（抱歉不记得名称）。

如果您能找到解决方案/解决方法，那就太好了:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-29T08:52:59.740

```
 int err = AddFontResource(L"Files/gamefont.fnt");
   if (err == 0)
   {
       MessageBox(NULL,L"loading font failed",L"Error",0);
   }
   else
   {  
       wchar_t message[100];
       swprintf_s(message,100,L"AddFontResource returned: %d",err);
       MessageBox(NULL,LPTSTR(message),L"error",0);
   } 
```

这是错误的 AddFontResource 返回加载的字体数量，因此 ELSE 中的代码没有意义。

# ruby-on-rails - Rails 控制台登录失败

> ID：15733601
> 
> 赞同：0
> 
> 时间：2013-03-31T19:31:00.647
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2, fedora

当我尝试打开 rails 控制台时出现以下错误：

```
$ rails console
/home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:251:in `require': cannot load such file -- minitest/unit (LoadError)
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:251:in `block in require'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:236:in `load_dependency'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:251:in `require'
from /usr/share/ruby/test/unit/assertions.rb:1:in `<top (required)>'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:251:in `require'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:251:in `block in require'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:236:in `load_dependency'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:251:in `require'
from /usr/share/ruby/test/unit/testcase.rb:1:in `<top (required)>'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:251:in `require'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:251:in `block in require'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:236:in `load_dependency'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:251:in `require'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/test_case.rb:1:in `<top (required)>'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:251:in `require'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:251:in `block in require'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:236:in `load_dependency'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:251:in `require'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/railties-3.2.13/lib/rails/console/app.rb:2:in `<top (required)>'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:251:in `require'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:251:in `block in require'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:236:in `load_dependency'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/activesupport-3.2.13/lib/active_support/dependencies.rb:251:in `require'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/railties-3.2.13/lib/rails/application.rb:304:in `initialize_console'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/railties-3.2.13/lib/rails/application.rb:152:in `load_console'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/railties-3.2.13/lib/rails/commands/console.rb:27:in `start'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/railties-3.2.13/lib/rails/commands/console.rb:8:in `start'
from /home/me/.rvm/gems/ruby-1.9.3-p392/gems/railties-3.2.13/lib/rails/commands.rb:41:in `<top (required)>'
from script/rails:6:in `require'
from script/rails:6:in `<main>' 
```

我使用 Fedora 17。我通过 yum 安装了 Ruby 和 gem，然后通过 gem 安装了 rails。

更新：我安装的 gem，也许我的 gemset 中缺少一些 gem，或者我有它的错误版本。

```
$ gem list
*** LOCAL GEMS ***

actionmailer (3.2.13)
actionpack (3.2.13)
activemodel (3.2.13)
activerecord (3.2.13)
activeresource (3.2.13)
activesupport (3.2.13)
arel (3.0.2)
builder (3.0.4)
bundler (1.3.4)
coffee-rails (3.2.2)
coffee-script (2.2.0)
coffee-script-source (1.6.2)
erubis (2.7.0)
execjs (1.4.0)
hike (1.2.1)
i18n (0.6.1)
journey (1.0.4)
jquery-rails (2.2.1)
json (1.7.7)
mail (2.5.3)
mime-types (1.22)
minitest (4.7.0)
multi_json (1.7.2)
polyglot (0.3.3)
rack (1.4.5)
rack-cache (1.2)
rack-ssl (1.3.3)
rack-test (0.6.2)
rails (3.2.13)
railties (3.2.13)
rake (10.0.4)
rdoc (3.12.2)
sass (3.2.7)
sass-rails (3.2.6)
sprockets (2.2.2)
thor (0.18.1)
tilt (1.3.6)
treetop (1.4.12)
tzinfo (0.3.37)
uglifier (1.3.0) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:48:46.733

通过运行尝试：

```
script/rails console 
```

让我们知道会发生什么，否则您也可以尝试

```
bundle exec script/rails console 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T21:28:52.450

在控制台中加载测试很奇怪...... minitest gem 可能只包含在测试组中，在开发环境中不可用。将 gem 添加到开发组可能会起作用，但这是治疗症状，而不是原因。

不知何故，也许在一个 irbrc 文件中，您包含了测试库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T21:36:46.727

好的，我已经通过手动安装 ruby​​ 2.0.0 并删除了我通过 yum 安装的 ruby​​ 1.9.3 解决了这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-10T12:56:02.523

```
group :development, :test do
    gem 'test-unit'
end 
```

并运行

```
bundle 
```

解决了我的问题。

在您的情况下，您可能希望包含“minitest”

# r - 在 data.table 中的 := 中正确放置大括号

> ID：15733603
> 
> 赞同：9
> 
> 时间：2013-03-31T19:31:13.623
> 
> 标签：r, data.table

这是我遇到的问题的一个例子。我是在滥用还是这是一个错误？

```
require(data.table)
x <- data.table(a = 1:4)

# this does not work
x[ , {b = a + 3; `:=`(c = b)}]
# Error in `:=`(c = b) : unused argument(s) (c = b)

# this works fine
x[ ,`:=`(c = a + 3)] 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-31T20:07:52.177

不是错误，只是大括号的顺序应该不同：

也就是说，使用大括号仅将`RHS`参数包装在 ``:=`(LHS, RHS)`

例子：

```
# sample data
x <- data.table(a = 1:4)

# instead of: 
x[ , {b = a + 3; `:=`(c, b)}]   # <~~ Notice braces are wrapping LHS AND RHS

# use this: 
x[ , `:=`(c,  {b = a + 3; b})]  # <~~ Braces wrapping only RHS

x
#    a c
# 1: 1 4
# 2: 2 5
# 3: 3 6
# 4: 4 7 
```

* * *

## 然而，更简洁自然：

你可能正在寻找这个：

```
 x[ , c := {b = a + 3; b}] 
```

### 马修更新

确切地。以`:=`其他不正确的方式使用会产生这个（长）错误：

```
x := 1
# Error: := is defined for use in j only, and (currently) only once; i.e.,
# DT[i,col:=1L] and DT[,newcol:=sum(colB),by=colA] are ok, but not
# DT[i,col]:=1L, not DT[i]$col:=1L and not DT[,{newcol1:=1L;newcol2:=2L}].
# Please see help(":="). Check is.data.table(DT) is TRUE. 
```

但不是在问题显示的情况下，只给出：

```
x[ , {b = a + 3; `:=`(c = b)}]
# Error in `:=`(c = b) : unused argument(s) (c = b) 
```

我刚刚在 v1.8.9 中对此进行了更改。这两种不正确的使用方式`:=`现在都给出了更简洁的错误：

```
x[ , {b = a + 3; `:=`(c = b)}]
# Error in `:=`(c = b) : 
#   := and `:=`(...) are defined for use in j only, in particular ways. See 
#   help(":="). Check is.data.table(DT) is TRUE. 
```

我们会修饰`?":="`。感谢@Alex 强调！

# php - .htaccess 是否适合创建 yii 管理面板？

> ID：15733606
> 
> 赞同：-1
> 
> 时间：2013-03-31T19:31:36.810
> 
> 标签：php, .htaccess, yii

我正在使用 Yii 框架创建一个应用程序并希望将 http://mydomain.com/yiiframework 重定向[到](http://mydomain.com/yiiframework)http://mydomain.com/yiiframework/default[所以](http://mydomain.com/yiiframework/default)我创建了 .htaccess 文件并将此内容放在上面但它没有t 重定向任何东西：

```
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /default/index.php [L] 
```

我的问题是：

1 - 我的 htaccess 文件有什么问题？

2-这是创建管理部分并将其他内容放入默认文件夹的好方法吗？

**编辑：**

我不小心发现了，我把 .htaccess 改成了这个：

```
RewriteEngine on
RewriteRule ^$  http://mydomain.com/yiiframework/default/index.php 
```

它符合我的目的，但奥秘在于：

> ^$

显示行首和行尾，这个正则表达式是什么意思？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-02T04:56:46.980

创建管理面板的最佳实践是为后端和前端创建单独的应用程序，它们与字体共享共同的东西，后端就像这个样板一样，[https://github.com/clevertech/YiiBoilerplate](https://github.com/clevertech/YiiBoilerplate)

或者

您应该创建单个应用程序并将其划分为模块，每个模块都有前端和后端的代码，正如您在许多基于 yii 的开源应用程序（如[Zurmo](https://github.com/yupe/yupe)、[Yupe CMS](https://github.com/yupe/yupe)、[X2Engine](https://github.com/X2Engine/X2Engine)、

我更喜欢第二种方法，它是模块化和可维护的代码，有点难但最好

# php - 使用 Restler v3 上传文件

> ID：15733608
> 
> 赞同：0
> 
> 时间：2013-03-31T19:31:45.453
> 
> 标签：php, api, rest, restler

就在最近，对**多部分/表单数据上传的**支持被添加到 Restler v3 ( [source](https://github.com/Luracast/Restler/issues/107) )，但我无法让它工作。在我的 index.php 文件中，我添加了：

```
$r->setSupportedFormats('JsonFormat', 'UploadFormat'); 
```

当我发布 .txt 文件时，出现以下错误（这是意料之中的，因为默认的“允许”格式是“image/jpeg”、“image/png”：

```
"error": {
    "code": 403,
    "message": "Forbidden: File type (text/plain) is not supported."
} 
```

但是，当我发布 .jpg 文件时，我收到以下错误：

```
"error": {
    "code": 404,
    "message": "Not Found"
} 
```

我错过了什么？这是我的功能：

```
function upload() {
    if (empty($request_data)) {
        throw new RestException(412, "requestData is null");
    }
    return array('upload_status'=>'image uploaded successfully');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T21:34:16.333

我想到了！我只需要一个`post()`功能！对于遇到与我遇到的相同问题的任何人，这是我使用 Restler 3 上传文件的解决方案：

**索引.php**

```
<?php
    require_once '../vendor/restler.php';
    use Luracast\Restler\Restler;

    $r = new Restler();    
    $r->addAPIClass('Upload');  
    $r->setSupportedFormats('JsonFormat', 'UploadFormat');

    $r->handle(); 
```

**上传.php**

```
<?php
    class Upload {
        function get(){
           if (empty($request_data)) {
              throw new RestException(412, "requestData is null");
           }
        }

        function post($request_data=NULL) {
           return array('upload_status'=>'image uploaded successfully!');
        }
    } 
```

# c# - 为什么 Azure 服务总线在由两个辅助角色访问时不起作用？

> ID：15733609
> 
> 赞同：0
> 
> 时间：2013-03-31T19:31:49.500
> 
> 标签：c#, azure, asp.net-mvc-4, servicebus, azureservicebus

我正在使用服务总线在 Web 角色和工作角色之间进行通信，但它给了我一些不稳定的结果。我已将我的云项目部署到 azure。令人惊讶的是，当我只运行已部署的项目时，服务总线工作正常，但是当我也在使用服务总线的本地仿真器上运行相同的项目时，服务总线出现故障，因为所有消息都出现死信或不被工作者角色接收。这是服务总线的正常行为吗？如果不是，可能是什么问题，我该如何解决？

这对我来说很烦人，因为现在当我在本地模拟器上运行我的项目时，服务总线永远无法正常工作。

这就是发送和接收消息的方式，但我想问题可能不在其中，因为当服务总线仅由部署的项目使用时它工作正常。

工人角色：

```
public override void Run()
{
    while (!IsStopped)
    {
        try
        {
            if (BroadcastReceived)
            {
                BroadcastReceived = false;
                // Receive the message from Web Role to upload the broadcast to queue
                BroadcastClient.BeginReceive(OnWebRoleMessageReceived, null);
            }

            if (SignalRMessageReceived)
            {
                SignalRMessageReceived = false;
                // Receive the message from SignalR BroadcastHub
                SignalRClient.BeginReceive(OnSignalRMessageReceived, null);
            }

            if (SignalRFirstTimeMessageReceived)
            {
                SignalRFirstTimeMessageReceived = false;
                // Receive the message from SignalR BroadcastHub
                SignalRFirstTimeClient.BeginReceive(OnSignalRFirstTimeMessageReceived, null);
            }          
     }
 }

public void OnWebRoleMessageReceived(IAsyncResult iar)
{
    BrokeredMessage receivedBroadcastMessage = null;
    receivedBroadcastMessage = BroadcastClient.EndReceive(iar);

    if (receivedBroadcastMessage != null)
    {
        // Process the message
       receivedBroadcastMessage.Complete();
    }
BroadcastReceived = true;
 } 
```

网络角色：

```
var queueClient = CloudStorageHelper.GetServiceBusQueueClient(Queuenames.ApiToWorkerRole);            

        BrokeredMessage message = new BrokeredMessage(record);

        queueClient.Send(message); 
```

如何创建服务总线队列：

```
public static QueueClient GetServiceBusQueueClient(string queuename)
{
    string connectionString = CloudConfigurationManager.GetSetting("Microsoft.ServiceBus.ConnectionString");

    var namespaceManager = NamespaceManager.CreateFromConnectionString(connectionString);

    if (!namespaceManager.QueueExists(queuename))
    {
        namespaceManager.CreateQueue(queuename);
    }

    QueueClient Client = QueueClient.CreateFromConnectionString(connectionString, queuename);

    return Client;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T16:20:45.340

您能否详细说明以下内容？

1) 您是否使用相同的服务总线连接字符串进行调试和部署的服务？请注意，服务总线队列/主题不会在模拟器中运行，即使您的云服务正在那里调试，所以您总是在 Azure 中访问实时服务。

2) 检查Queue/Topic/Messages 上的[MaxDeliveryCount](http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.servicebus.messaging.queuedescription.maxdeliverycount.aspx)和[TimeToLive属性。](http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.servicebus.messaging.brokeredmessage.timetolive.aspx)当消息上的[DeliveryCount](http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.servicebus.messaging.brokeredmessage.deliverycount.aspx)超过 MaxDeliveryCount 时，消息会出现死信，每次收到且不完成消息时都会递增（调试时您可能希望设置更高的值）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T17:10:28.413

之所以出现这个问题，是因为在我们的工作者角色中，我们不断检查服务总线队列以查看是否有消息到达。当我们同时启动本地和云工作者角色时，两个工作者角色都会尝试从同一个服务总线队列接收新消息。因此，有时云接受它，有时接受本地接受。

为云和本地项目使用不同的服务总线队列名称解决了该问题。

# c# - 将 UTC 转换为特定时区

> ID：15733612
> 
> 赞同：1
> 
> 时间：2013-03-31T19:31:54.917
> 
> 标签：c#, asp.net

我将日期作为 UTC 存储在我的数据库中。我想将它们转换为 CST（中部标准时间）。

我到处找，我只找到了将UTC时间转换为本地时间的方法。如何将其转换为特定时区？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T19:39:56.327

试试这个方法

```
TimeZoneInfo.ConvertTimeBySystemTimeZoneId(DateTime.Now, "New Zealand Standard Time", "UTC") 
```

更多讨论：

[如何在特定时区转换 DateTime？](https://stackoverflow.com/questions/9869051/how-to-convert-datetime-in-specific-timezone)

[http://blog.mozilla.org/it/2012/11/16/converting-timezone-specific-times-in-mysql/](http://blog.mozilla.org/it/2012/11/16/converting-timezone-specific-times-in-mysql/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-31T19:39:41.453

也许`TimeZoneInfo.ConvertTimeFromUtc`来自 .NET 3.5/4.0？

# c# - 引发事件与在 c# 中调用函数有性能差异吗

> ID：15733615
> 
> 赞同：0
> 
> 时间：2013-03-31T19:32:08.230
> 
> 标签：c#, events

这是比实际问题更理论的问题，实际上我没有任何性能问题。

我试图弄清楚 eventד 是如何工作的（并推断使用它们而不是调用函数是否会降低性能）。

事件只是一个类，它包含一个指向已注册该事件的函数的指针列表，还是在它后面有更多？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:03:42.450

当一个事件被引发时，一个多播委托（本质上为`.SomeEvent += MySomeEventHandler`在该类型实例上完成的每个事件附加一个新的事件处理程序 - 它确实获得一个分配给每个的新委托列表`+=`，但现在跳过它）将执行每个附加的处理程序。因此，在附加了多个事件处理程序的每种情况下，都会执行多个方法调用。对于非常底层的细节，只需查看发出的 IL 以了解事件引发情况，并将其与将事件更改为常规回调时的样子进行比较。

# php - PHP 消息表单

> ID：15733623
> 
> 赞同：0
> 
> 时间：2013-03-31T19:32:46.703
> 
> 标签：php, mysql, message

我正在尝试用 PHP 和 HTML 创建一个群聊/消息系统。结果一直很好，但我想更改系统以使其更详细。

我一直在努力让它以一种方式显示其他用户发出的消息，而你发出的消息是另一种方式，有点像 iPhone 上的 iMessage。

这是我的PHP代码...

```
<div class="groupchat span9" style="height: 200px; overflow: auto;">

<?php

    /*
    * LETS GET THESE MESSAGES PRINTED
    */

    $qry=mysql_query("SELECT * FROM chat ORDER BY chat.id ASC", $con);

    while($row=mysql_fetch_array($qry)) {

        if(!$row['name']) {
            echo '<div class="span5 place-left">';
                echo '<ul class="replies">';
                    echo '<li class="bg-color-orange">';
                        echo '<b class="sticker sticker-left sticker-color-orange"></b>';
                        echo '<div class="avatar"><img src="../content/images/myface.jpg" /></div>';
                        echo '<div class="reply">';
                            echo '<div class="date">'.$row['time'].'</div>';
                            echo '<div class="author">'.$row['name'].'</div>';
                            echo '<div class="text">'.$row['message'].'</div>';
                        echo '</div>';
                    echo '</li>';
                echo '</ul>';
            echo '</div>';
        }

        if($row['name'] == $_SESSION['name']) {
          echo '<div class="span5 place-right">';
                echo '<ul class="replies">';
                    echo '<li class="bg-color-blue">';
                        echo '<b class="sticker sticker-right sticker-color-blue"></b>';
                        echo '<div class="avatar"><img src="../content/images/myface.jpg" /></div>';
                        echo '<div class="reply">';
                            echo '<div class="date">'.$row['time'].'</div>';
                            echo '<div class="author">'.$row['name'].'</div>';
                            echo '<div class="text">'.$row['message'].'</div>';
                        echo '</div>';
                    echo '</li>';
                echo '</ul>';
            echo '</div>';
        }

    }

?>

<a name="groupchatbottom"></a>

</div> 
```

我在尝试获取它时遇到问题，因为它会显示不是您制作的消息。我很感激任何帮助！提前感谢大家的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:36:50.550

只需使用一个`if-else`语句：

```
if($row['name'] == $_SESSION['name']) {
    // post belongs to author
    echo '<div class="author-message">

    </div>';  
}
else{
    echo '<div class="user-message">

    </div>';    
} 
```

# web-services - Liferay 身份验证网络服务

> ID：15733624
> 
> 赞同：1
> 
> 时间：2013-03-31T19:33:16.890
> 
> 标签：web-services, authentication, liferay, single-sign-on

我是 Liferay 的新手。我想使用 Liferay 作为我的后端，并且我有几个 Web 服务可以与之交互。我在哪里可以找到文档（或一些示例）来提供用于身份验证 liferay 用户的 Web 服务？这只是入门和熟悉仪器。然后我必须在这个 Web 服务中集成一个单点登录系统。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T09:32:20.257

[我相信开发者指南](https://www.liferay.com/documentation/liferay-portal/6.1/development/-/ai/liferay-portal-6-1-development-guide)的第 11 章和第 12 章可能包含一些有价值的信息。关于登录——正如你已经提到的 SSO——我建议对一个公共后端进行身份验证，而不是直接对 Liferay 进行身份验证。Liferay 支持多种开箱即用的 SSO 系统。Liferay 的 Web 服务是通过 ServiceBuilder 生成的（也请阅读该章），您会通过它们的名称识别它们 - 例如，UserService 是处理用户管理的远程服务（UserLocalService 是远程不可用的，servicebuilder 文档将教您有关这些名称的各种后缀，如 *Util、*Impl 等）

此外，对于像您这样的问题，我永远无法完全确定哪个 Web 服务使用什么基础设施：如果您在 Liferay 中编写使用外部 Web 服务的 portlet，这与您编写将某些操作委托给 Liferay 的 Web 服务的 Web 服务是不同的故事。两者都是可能的（当然），但要求不同的方法：您必须使 Liferay 的服务可用（通过配置，默认情况下它们仅对 127.0.0.1 可用），但您可以使用任何您喜欢的 WebService你的插件，没有 Liferay 有什么可说的。

只有当你想在市场上发布你的插件时，你才需要声明你想连接到哪里——因此在这种情况下你必须阅读有关 PACL 的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-08T05:54:04.117

您可以找到 Web 服务的分步教程。 [http://www.liferaysavvy.com/2014/05/sumption-liferay-json-web-services.html](http://www.liferaysavvy.com/2014/05/consuming-liferay-json-web-services.html)

您可以在 Java 脚本的帮助下调用 Web 服务，如下所示。

```
<script>
$(document).on('ready',function(){ 
            var username ="test@liferay.com";
            var password ="test"; 
            function make_base_auth(user, password) {
              var tok = user + ':' + password;
              var hash = btoa(tok);
              return "Basic " + hash;
            }
                $.ajax({
                  url: 'http://localhost:8080/api/jsonws/CustomJsonWebservices-portlet.employee/get-employee/emplyee-id/1',
                  dataType: "json",
                  type: "get",
                  success: function(data){
                          alert('Employee Data with Id 1 is');       
                          alert(data.emplyeeName);
                          alert(data.employeeDesignation);
                  },
                  beforeSend: function(xhr){
                          xhr.setRequestHeader('Authorization',make_base_auth(username, password));
                                    },
                                    complete: function(){
                                    },
                  error: function(){
                  }
                });

 });
</script> 
```

您可以在下面找到 Web 服务的完整代码。 [https://drive.google.com/file/d/0B9B1NsG0lyx6Q2dlUVp6LU5fX0E/view?usp=sharing](https://drive.google.com/file/d/0B9B1NsG0lyx6Q2dlUVp6LU5fX0E/view?usp=sharing)

# java - 如何在 JAVA（Netbeans）中为 JSpinner 设置日期和时间？

> ID：15733625
> 
> 赞同：0
> 
> 时间：2013-03-31T19:33:18.230
> 
> 标签：java, string, swing, simpledateformat, jspinner

我有一个日期和时间值`String`类型。

```
String dateTime = "2012-10-27 19:00:00.000"; 
```

我有一个`JSpinner`以`spnDateTime`Spinner 模型类型为日期的命名。

我需要做的是获取 String 变量的值并设置为微调器的 date 和 time 。

我是 JAVA 的新手，这就是我试图做的。

```
spnDateTime.setValue(dateTime); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T19:41:21.587

您可以使用 a`SimpleDateFrmat`将其解析`String`为一个`Date`值

```
Date date = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss.SS").parse(daetTime); 
```

# silverlight - MS Fakes - 外部别名未在 /reference 选项中指定

> ID：15733630
> 
> 赞同：5
> 
> 时间：2013-03-31T19:34:04.593
> 
> 标签：silverlight, unit-testing, visual-studio-2012, microsoft-fakes

我有一个 silverlight 解决方案，我正在尝试为 System.Windows.Controls.Data.DataForm.Toolkit 创建一个假货程序集（以使用 DataForm）。

添加 fakes 程序集后，出现以下构建错误：

> 错误 6 外部别名 'swd' 未在 /reference 选项中指定 [C:\Dev\Temp\SLTest1\Controls.Tests\obj\Debug\Fakes\swcddft\f.csproj] C:\Dev\Temp\SLTest1 \Controls.Tests\f.cs 16 1 控制.Tests

看起来 .csproj 在每次构建时都会重新生成，所以我无法修改项目文件。如何指定参考？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-17T22:04:11.940

“由于 System 是一个大型库，Fakes 框架不会自动为每个 System 类生成一个假货。” 尝试将“System.Windows”显式添加到 .fakes 文件中。

```
<Fakes xmlns="http://schemas.microsoft.com/fakes/2013/">  <Assembly Name="System"/>  
<ShimGeneration>    
    <Add FullName="System.Windows"/>  
</ShimGeneration>
</Fakes> 
```

[http://www.colinsalmcorner.com/2012/06/microsoft-fakes-customizing-system.html](http://www.colinsalmcorner.com/2012/06/microsoft-fakes-customizing-system.html)

# android - 安卓。保存并重新建立计时器的值（反转屏幕）

> ID：15733640
> 
> 赞同：0
> 
> 时间：2013-03-31T19:35:26.600
> 
> 标签：android, chronometer

我的问题很简单，但我无法应付他。我的设计中有计时器字段。

我想通过恢复屏幕来保存它们以避免失去时间价值（重新创建新活动）

我用来保存

```
 public Object onRetainConfigurationInstance(){
    return timeSeconds;
} 
```

并重新建立`timeSeconds = (Chronometer) getLastNonConfigurationInstance();`

但它不起作用。有人可以帮我吗？我必须保存什么参数才能重新建立计时器时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T20:42:34.083

```
protected void onSaveInstanceState(Bundle outState) {
    outState.putLong(TIME_KEY, timeSeconds.getBase());
    super.onSaveInstanceState(outState);
}

protected void onRestoreInstanceState(Bundle savedInstanceState){
    if((savedInstanceState !=null)
            && savedInstanceState.containsKey(TIME_KEY)){
        timeSeconds.setBase(savedInstanceState.getLong(TIME_KEY));
    }
    super.onRestoreInstanceState(savedInstanceState);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:43:36.553

您可能应该使用`onSaveInstanceState()`在方向更改之间保存数据，您的代码可能如下所示：

```
@Override
protected void onSaveInstanceState(Bundle outState) {
    outState.putLong("time_seconds", timeSeconds);
    super.onSaveInstanceState(outState);
} 
```

然后你可以在 中获取存储的值，当方向改变时`onCreate()`，这被称为重新创建：`Activity`

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    long timeSeconds = savedInstanceState.getLong("time_seconds");
    // other code from onCreate()
} 
```

# django - 全局视图 (base.html) 中的 Django 动态菜单在所有模板中可见

> ID：15733641
> 
> 赞同：1
> 
> 时间：2013-03-31T19:35:45.310
> 
> 标签：django, django-templates, django-views, global-variables, inclusion

我已经用几个模板构建了网站，但我想实现如何从 base.html 中的 DB 读取菜单，这将在整个网站上可见，我不想将它添加到每个模板中。我在 POLL 示例的文档中找到：

[https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#inclusion-tags](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#inclusion-tags)

错误截图

TemplateSyntaxError at / Invalid block tag: 'show_menu'

![模板语法错误](https://i.stack.imgur.com/gLyhQ.png)

![Base.html 错误](https://i.stack.imgur.com/w4jMR.png)

在我做的应用程序下：templatetags/menu.py

```
from django import template
register = template.Library()

@register.inclusion_tag('menu.html')
def show_menu(menu):
    menu = Menu.objects.all()
    return {'menu': menu} 
```

base.html

```
{% load menu %}
<!DOCTYPE html>
<html lang="en">
<head></head>
<body>
    {% show_menu menu %}
    {% block content %}{% endblock %}
</body>
</html> 
```

索引.html

```
{% extends "base.html" %}

{% block content %}
Hello World! (Content)
{% endblock %} 
```

请帮忙，我做错了什么？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T19:45:25.983

您似乎并没有真正阅读您链接到的文档页面。首先，它给出了关于将模板标记代码放在何处的明确说明：不是在 view.py 中，而是在`templatetags`应用程序内目录内的新文件中。

其次，该页面还解释了您需要在使用它们的每个模板中加载您使用的每个标签库：因此假设您已将标签放入 templatetags/menu.py，您可以这样做`{% load menu %}`。

# c - C中的多维数组

> ID：15733642
> 
> 赞同：1
> 
> 时间：2013-03-31T19:36:02.343
> 
> 标签：c, arrays, memory-management, multidimensional-array

这与我对这个问题的回答的评论有关：[如何将 2d array out of 1d one?](https://stackoverflow.com/questions/15731383/how-to-turn-2d-array-out-of-1d-one)

所以，考虑这个片段：

```
int M = 5;
int N = 5;

int** theArray = (int**) malloc(M*sizeof(int*));  

for (int i = 0; i < M; i++)
{
    theArray[i] = (int*) malloc(N*sizeof(int));

    for(int j = 0 ; j < N; j++)
    {
        theArray[i][j] = i+j;
        printf("%d ", theArray[i][j]);
    }

    printf("\n");
}

for (int k = 0; k < M; k++)
{  
   free(theArray[k]);  
}
free(theArray); 
```

我得说它在我的机器上工作得非常好，但我在评论中被告知这纯粹是运气，声明二维数组的方法是错误的，应该只用 1 个 malloc 分配内存以获得连续内存。

我真的很困惑，因为我认为 C 中的非动态多维数组的工作方式完全相同：它们基本上是一个指针数组，其中每个值都是一个数组。

问题是，这样做是否正确（便携式、常见做法等）方式？我错过了有关此主题的内容吗？我的意思是，我真的看不出这段代码有什么问题。

编辑：

我从 WhozCraig 和 Daniel Fischer 的评论中得到了我终于明白的答案。我的主要错误是我认为数组和指针比实际更相似。

主要原因是实际多维数组存储在线性内存中的行优先顺序（[http://en.wikipedia.org/wiki/Row-major_order](http://en.wikipedia.org/wiki/Row-major_order)）。为了理解真正的多维数组和我的片段之间的实际区别，我建议阅读这篇文章（它对我来说很好地阐明了这个主题，并提供了易于理解的示例）：

第 1 部分：[http ://eli.thegreenplace.net/2009/10/21/are-pointers-and-arrays-equivalent-in-c/](http://eli.thegreenplace.net/2009/10/21/are-pointers-and-arrays-equivalent-in-c/)

第 2 部分：[http ://eli.thegreenplace.net/2010/04/06/pointers-vs-arrays-in-c-part-2d/](http://eli.thegreenplace.net/2010/04/06/pointers-vs-arrays-in-c-part-2d/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:56:31.347

比较这段代码：

```
int array[10][10];

for (int i = 0; i < 10 * 10; i++) {
   *((int *)array+i) = 0;
} 
```

这对于二维数组来说很好，因为所有内存都是连续的。在您的版本中，您有一组连续的指针，每个指针都可以指向内存中的任何位置。

# mysql - 仅当我重新声明数据类型时，修改才有效吗？

> ID：15733651
> 
> 赞同：0
> 
> 时间：2013-03-31T19:36:55.460
> 
> 标签：mysql, sql, alter

为了更改列的顺序，以下工作：

```
ALTER TABLE contacts  
MODIFY COLUMN id VARCHAR(20) FIRST; 
```

以下：

```
ALTER TABLE my_contacts
MODIFY COLUMN id FIRST; 
```

给我错误：

> ERROR 1064 (42000)：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 2 行的“FIRST”附近使用正确的语法

我想知道，是否不能在*不*重新声明其数据类型的情况下更改列的顺序？
列的所有修改是否都必须重新声明数据类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T19:39:25.310

你的直觉是正确的。ALTER 语句在列的完整类型中必须是显式的。

从文档：[http ://dev.mysql.com/doc/refman/5.1/en/alter-table.html](http://dev.mysql.com/doc/refman/5.1/en/alter-table.html)

```
 MODIFY [COLUMN] col_name column_definition
        [FIRST | AFTER col_name] 
```

column_definition 是强制性的。

# ruby-on-rails - 从联接查询中查找所有值

> ID：15733657
> 
> 赞同：0
> 
> 时间：2013-03-31T19:37:20.860
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

当我在控制台上运行它时：

```
ItemCategory.joins(:item_companies) 
```

我得到我的 sql 查询是：

```
SELECT `item_categories`.* FROM `item_categories` INNER JOIN `item_companies` ON `item_companies`.`item_category_id` = `item_categories`.`id` 
```

但我想要加入后的所有列，即项目公司和项目类别的所有列。请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:47:41.777

你可以做

```
item_categories = ItemCategory.includes(:item_companies) 
```

哪一个项目类别，然后项目公司以及一次拍摄，然后你可以做：

```
item_categories.each { |ic| ic.item_companies } 
```

您会意识到没有执行任何 sql，因为它们都是在您使用**包含运行查询时加载的**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T18:42:01.730

正如 Carlos 在评论中建议的那样，您需要添加一个 .select 以指定连接表中的其他字段。请参阅[http://guides.rubyonrails.org/active_record_querying](http://guides.rubyonrails.org/active_record_querying)。

添加以下内容有时会起作用：

```
ItemCategory.select("item_categories.*, item_companies.*").joins(:item_companies) 
```

虽然你可以尝试 * 我后来发现额外的 id 字段破坏对象的问题。您可以扩展选择以执行以下操作以删除重复的标准字段：

```
fnew = (item_companies.column_names - ['id', 'created_at', 'updated_at'])
fnew.map! {|f| "item_companies.#{f}"}
fnew_text = fnew.join(', ')
.select("item_categories.*, #{fnew_text}") 
```

显然，可能有更简单的方法可以做到这一点，您可以添加一种方法来使这更容易。为了避免对加入的 ID 进行奇怪的查找，这是我使用的蛮力方法。

# java - OnClickListener 方法的 Android 视图参数

> ID：15733658
> 
> 赞同：5
> 
> 时间：2013-03-31T19:37:25.170
> 
> 标签：java, android, android-widget, onclicklistener

请不要介意愚蠢的问题，但我需要清除我的困惑..

对于 `OnClickListener` android中的一个按钮，我确实把它放进去了`main.xml`

```
<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:text="Button"
    android:onClick="clicked"
/> 
```

在java文件中我做了

```
 public void clicked(View v)
  {
   //  my code here 
  } 
```

`View view` 我的问题是为什么我们在调用 `clicked`方法 时需要通过。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-31T19:42:34.633

AFAIK，

因为在 onCreate 中没有获取 Button 就调用了方法。为了访问该按钮，您需要有一个视图。

即 View v 代表您的按钮视图。

如果您想访问 button ，假设您想在 It 上获取文本。如何在不使用按钮的情况下获得它`findViewbyId`？你会像这样得到你的按钮

```
Button b=(Button)v; 
```

获取文本

```
String text=b.getText(); 
```

所以在这里我们没有通过使用来获取按钮`findViewById`

通常，如果您想访问按钮，则需要获取该对象。但在这里你会从视图中得到它。不使用`findViewById`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-31T19:44:07.657

我想到的第一个原因是您可以将多个视图附加到同一个方法并使用 v.getId() 您可以根据按下的视图进行操作。

一般来说，拥有与事件相关的视图可能会因为几个原因而有用，例如更改其某些属性。

# erlang - Erlang Supervisor 无法 start_child 且没有错误 simple_one_for_one

> ID：15733665
> 
> 赞同：0
> 
> 时间：2013-03-31T19:38:06.817
> 
> 标签：erlang, erlang-supervisor, gen-server

主管似乎无法默默地启动孩子......

这里是**监督**

```
-behaviour(supervisor).
-export([start_socket/0, init/1, start_link/1]).

-define(SSL_OPTIONS, [{active, once},
                      {backlog, 128},
                      {reuseaddr, true},
                      {packet, 0},
                      {cacertfile, "./ssl_key/server/gd_bundle.crt"},
                      {certfile, "./ssl_key/server/cert.pem"},
                      {keyfile, "./ssl_key/server/cert.key"},
                      {password, "**********"}
                     ]).

start_link(Port) ->
    Role = list_to_atom(atom_to_list(?MODULE) ++ lists:flatten(io_lib:format("~B", [Port]))),
    supervisor:start_link({local, Role}, ?MODULE, [Port]).

init([Port]) ->
    R = ssl:listen(Port, ?SSL_OPTIONS),
    LSocket = case R of
                  {ok, LSock} ->
                      LSock;
                  Res ->
                      io:fwrite("gateway_sup Error: ~p~n", [Res])
              end,
    spawn_link(fun empty_listeners/0),
    ChildSpec = [{socket,
                  {gateway_serv, start_link, [LSocket]},
                  temporary, 1000, worker, [gateway_serv]}
                ],
    {ok, {{simple_one_for_one, 3600, 3600},
          ChildSpec
         }}.

empty_listeners() ->
    io:fwrite("---------------------- empty_listeners~n"),
    [start_socket() || _ <- lists:seq(1,128)],
    ok.

start_socket() ->
    io:fwrite("++++++++++++++++++++++ start_socket~n"),
    supervisor:start_child(?MODULE, []). 
```

和**gen_server**

```
-module(gateway_serv).

-behaviour(gen_server).
-export([start_link/1, init/1, handle_call/3, handle_cast/2, handle_info/2, code_change/3, terminate/2]).

start_link(LSocket) ->
io:fwrite("#################~n"),
    gen_server:start_link(?MODULE, [LSocket], []).

init([LSocket]) ->
io:fwrite("/////////////////~n"),
    gen_server:cast(self(), accept),
    {ok, #client{listenSocket=LSocket, pid=self()}}.

handle_cast(accept, G = #client{listenSocket=LSocket}) ->
    {ok, AcceptSocket} = ssl:transport_accept(LSocket),
    gateway_sup:start_socket(),
    case ssl:ssl_accept(AcceptSocket, 30000) of
    ok ->
        timer:send_after(10000, closingSocket),
        ssl:setopts(AcceptSocket, [{active, once}, {mode, list}, {packet, 0}]),
        {noreply, G#client{listenSocket=none, socket=AcceptSocket}};
    {error, _Reason} ->
        {stop, normal, G}
    end;
handle_cast(_, G) ->
    {noreply, G}. 
```

**gen_server 的 start_link/1 显然从未被调用（使用 io:fwrite 检查）。**

似乎无法找出原因...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T20:20:46.363

当您注册主管时，您使用：

```
Role = list_to_atom(atom_to_list(?MODULE) ++ lists:flatten(io_lib:format("~B", [Port]))), 
```

因此，当您致电时：

```
start_socket() ->
    io:fwrite("++++++++++++++++++++++ start_socket~n"),
    supervisor:start_child(?MODULE, []). 
```

你打电话给一个不存在的主管。

您应该将其称为：

```
supervisor:start_child(Role, []). 
```

您可以将`Role`其作为参数传递给函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T20:14:41.490

~~对我来说有些奇怪，您在主管的 init 函数中启动 empty_listener 调用 start_socket() 调用 supervisor:start_child ，此时主管没有完成其初始化阶段。因此，调用主管启动子进程的进程与主管本身之间存在竞争。~~

我认为这段代码应该在init函数之外：

~~*   首先使用 start_link(Port) 启动 supervisor，~~
*   ~~当它返回时调用函数 start_socket()。~~

我已经完成了一个使用这种模式的应用程序，并且我有 2 级主管：

```
main supervisor (one_for_all strategy)
|                         |
|                         |
v                         v
application   ------->    supervisor (simple_one_for_one strategy)
server      start_child   worker factory
                          |
                          |
                          v*
                          many children 
```

编辑：忘记这个比赛条件，

我做了一个测试，在 init 函数结束之前引入了一个延迟，我已经看到 start_child 函数，等待 init 结束，什么都没有丢失。OTP的家伙比我想象的还要谨慎……

# c# - Visual Studio 编译代码

> ID：15733666
> 
> 赞同：7
> 
> 时间：2013-03-31T19:38:13.697
> 
> 标签：c#, visual-studio

有什么方法可以查看 Visual Studio 本身的编译代码输出。我知道我们可以使用一些反射器软件并查看代码。但我只想在 Visual Studio 中编码时查看编译器代码。所以我可以通过查看输出代码来决定什么是特定任务的最佳编码方法。

***注意：对 C# 的支持对我来说就足够了。***

**更新：**

* * *

我想查看 C# 代码的中间语言 (IL) 输出。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-31T19:42:53.703

假设您不是在谈论 .NET 语言（C#、VB.NET、F# 等），您可以使用[反汇编窗口](http://msdn.microsoft.com/en-us/library/a3cwf295.aspx)：

> 反汇编窗口显示与编译器创建的指令相对应的汇编代码。如果您正在调试托管代码，这些汇编指令对应于由即时 (JIT) 编译器创建的本机代码，而不是由 Visual Studio 编译器生成的 Microsoft 中间语言 (MSIL)。

* * *

但是，如果您正在谈论查看 .NET 语言的 IL - [ILDASM](http://msdn.microsoft.com/en-gb/library/f7dy01k1.aspx)可以向您展示，大多数反汇编程序（例如 Reflector）也可以。其中许多将默认向您展示他们对 IL 的 C#/VB.NET 解释，但您*始终*可以直接查看 IL。

其中一些还具有 Visual Studio 附加组件/扩展，允许您直接在 Visual Studio 中查看反汇编（Reflector 和 Resharper 都将执行此操作）。

# c - 检查字符是否为换行符

> ID：15733673
> 
> 赞同：15
> 
> 时间：2013-03-31T19:39:10.120
> 
> 标签：c, char

如何检查一个字符是否是C中任何编码的换行符？

我的任务是编写自己的***wc***程序。如果我使用`(s[i] == '\n')`它是否有另一个答案而不是原始***wc***如果我调用它自己。
这是代码：

```
typedef struct
{
    int newline;
    int word;
    int byte;
} info;

info count(int descr)
{
    info kol;
    kol.newline = 0;
    kol.word = 0;
    kol.byte = 0;

    int len = 512;
    char s[512];
    int n;

    errno = 0;
    int flag1 = 1;
    int flag2 = 1;
    while(n = read(descr, s, len))
    {
        if(n == -1)
            error("Error while reading.", errno);

        errno = 0; 

        kol.byte+=n;
        for(int i=0; i<n; i++)
        {
            if(flag1)
            {
                kol.newline++;
                flag1 = 0;
            }

            if(isblank(s[i]) || s[i] == '\n')
                flag2 = 1;
            else
            {
                if(flag2)
                {
                    kol.word++;
                    flag2 = 0;
                }
            }
            if(s[i] == '\n')
                flag1 = 1;
        }
    }
    return kol;
} 
```

它适用于所有文本文件，但是当我将它调用到文件时，我在编译后得到它并没有给出***wc***给出的答案。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-31T20:14:09.147

检查字符`s[i]`是否为换行符的方法很简单：

```
if (s[i] == '\n') 
```

如果您正在读取以文本模式（包括`stdin`）打开的文件，那么底层系统用于标记行尾的任何表示都将被转换为单个`'\n'`字符。

您说您正在尝试编写自己的`wc`程序，并且通过比较`'\n'`您得到的结果与系统的`wc`. 您还没有告诉我们足够多的信息来猜测为什么会发生这种情况。向我们展示您的代码并准确告诉我们发生了什么。

如果您正在读取编码不同的文件，您可能会遇到问题——例如，尝试在 Windows 系统上读取 Unix 格式的文本文件。但那样`wc`就会有同样的问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-31T19:48:14.837

ASCII 和 Unicode 中有几个换行符。

最著名的是`\r`和`\n`，来自 ASCII。从技术上讲，这些是回车和换行。Windows 同时使用两者`\r\n`（从技术上讲，回车意味着转到第 0 列，换行意味着转到下一行，但我所知道的实际上没有遵守这一点），unix 只使用`\n`. 一些（不常见的）操作系统只使用`\r`.

大多数应用程序都停在那里，并且不会为此受苦。接下来的内容更具理论性。

Unicode 使事情变得复杂。U+000A 和 U+000B 与`\r`and`\n`相同（在 UTF-8 中相同的二进制表示）。然后是 U+0085“下一行”、U+2028“行分隔符”和 U+2029“段落分隔符”。如果要检查所有内容，还可以检查垂直制表符 (U+000B)。见这里：[http ://en.wikipedia.org/wiki/Newline#Unicode](http://en.wikipedia.org/wiki/Newline#Unicode)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-31T19:50:00.397

据我所知，没有类似的标准功能`isXXXXX()`（最接近的是`isspace()`，对于其他条件（空格、制表符、换页...）也是如此。简单地比较 '\n' 应该可以解决您的问题问题；根据您认为是换行符的内容，您可能还需要检查“\r”（回车）。作为行分隔符的 UNIX 标准是“\n”，Mac（在 OS X 之前）使用“\r” '（现在 '\n' 更常见，但 '\r' 有时仍被某些应用程序使用，例如 MS Office），DOS/Windows 使用 "\r\n" 序列。

# javascript - Meteor 可以处理嵌套依赖吗？

> ID：15733681
> 
> 赞同：0
> 
> 时间：2013-03-31T19:40:20.877
> 
> 标签：javascript, meteor

如果我的 Meteor 自动运行函数所依赖的游标本身是依赖的，那么 Meteor 会在每次最内层依赖发生变化时创建并保存一个新的计算吗？

如果一个自动运行函数在另一个函数上调用 Deps.autorun 怎么办？

```
Session.set('fooVal', 33);
myComputation = Deps.autorun(function() { 
  if (typeof(myComputation) !== 'undefined')
    myComputation.stop(); // Is this needed to prevent Computation accumulation?
  var foos = BarCollection.find({foo:Session.get('fooVal')}; 
  /* Do stuff with foos */
});
Session.set('fooVal', 33);
Session.set('fooVal', 34);
Session.set('fooVal', 35); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T06:18:31.847

Meteor 可以使用响应式数据作为 Collection 查询中的键或值。仔细阅读文档的[反应](http://docs.meteor.com/#reactivity)部分。

自动运行函数可以嵌套而没有内存泄漏。如果内部自动运行块无效，则仅重新运行内部块。如果外部自动运行块无效，则两个自动运行块都将重新运行。

重要的是要了解：

*   Deps.autorun 创建并返回一个 Computation 对象。
*   Computation 对象跟踪函数所依赖的所有响应式数据源。
*   当任何一个响应式数据源发生变化时，整个函数都会重新运行。

# asp.net - VB.net中的Bind vs Eval，主要区别是什么

> ID：15733686
> 
> 赞同：1
> 
> 时间：2013-03-31T19:40:57.857
> 
> 标签：asp.net, vb.net

当我使用 Eval 时没有语法错误

```
<asp:TextBox ID="txtHaulZoneCodeWIL" runat="server" CssClass="cagText" Text='<%#ConvertHaulZoneCodeForDisplay(Eval("HaulZoneCodeWIL").ToString())%>'></asp:TextBox> 
```

当我对此语句使用 Bind 时，出现错误“未声明名称绑定”

```
<asp:TextBox ID="txtHaulZoneCodeWIL" runat="server" CssClass="cagText" Text='<%#ConvertHaulZoneCodeForDisplay(Bind("HaulZoneCodeWIL").ToString())%>'></asp:TextBox> 
```

如何解决这个问题。我只想使用 Bind，而不是 EVAL，因为 Bind 是双向的

在代码隐藏中，我这样写：

```
Protected Function ConvertHaulZoneCodeForDisplay(ByRef str As String) As String
        If str <> "0" Then
            Return str
        Else
            Return ""
        End If

    End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:43:54.953

**编辑：** 试试这种方式

```
<asp:Label  ID="Label123" **Visible="False"** runat="server"  CssClass="cagText" Text='<%#ConvertHaulZoneCodeForDisplay(Bind("HaulZoneCodeWIL").ToString())%></asp:Label >

**<asp:TextBox ID="txtHaulZoneCodeWIL" runat="server" CssClass="cagText" %></asp:TextBox>** 
```

看到这个.. Vb。代码

```
 Protected  Sub DetailsView1_DataBound(ByVal sender As Object, ByVal e As EventArgs)        
     Label lablehide=(Label) DetailsView1.FindControl("Label123")
     TextBox _txtHaulZoneCodeWIL=(TextBox) DetailsView1.FindControl("txtHaulZoneCodeWIL")
  **_txtHaulZoneCodeWIL.Text=ConvertHaulZoneCodeForDisplay(lablehide.Text)**

End Sub 
```

而这种方法是错误的。所以只要改变它

```
Protected Function ConvertHaulZoneCodeForDisplay(ByRef str As String) As String
        If str <> "0" Then
            Return str       

        End If
        Return ""
    End Function 
```

然后参考这个

eval 是一种方式绑定，但是 Bind 是两种方式

如果你使用 Eval 绑定一个值，它就像一个只读的。您只能查看数据。

如果您使用 Bind 绑定一个值，并且如果您对该值进行一些更改，它也会反映在数据库中

你可以在这里看到类似的帖子

[ASP.NET 中的 <%# Bind("") %> 和 <%# Eval("") %> 有什么区别？](https://stackoverflow.com/questions/259141/difference-between-bind-and-eval)

# php - 使用 MySQL 和 PHP 转换 CSV 文件结构

> ID：15733690
> 
> 赞同：0
> 
> 时间：2013-03-31T19:41:18.197
> 
> 标签：php, mysql, csv

我正在尝试创建一个 PHP 函数，我可以在其中将一个 CSV 文件上传到 MySQL，然后导出另一个 CSV 文件，其中包含数据和表格的某些更改。

例子

> **CSV-1：**
> 
> 表名 = Photolink
> 
> 表格内容 = http://www.sitename.com/image1.jpg

将其转换为：

> **CSV-2：**
> 
> 表名 = img_URL
> 
> 表格内容 = product/image1.jpg

我需要您的帮助来修改代码以使其正常工作；

我试了这段代码还是不行，请朋友们帮我修一下！

```
 $data1 = $mysql->prepare("INSERT INTO products (name, model, quantity, image_url) VALUES (:name, :model, :quantity, :image_url)");
    $data1->bindParam(':name', $name);
    $data1->bindParam(':model', $model);
    $data1->bindParam(':quantity', $quantity);
    $data1->bindParam(':image_url', $image_url);

    if ($_FILES[csv][size] > 0) {

        //get the csv file
        $file = $_FILES[csv][tmp_name];
        $handle = fopen($file,"r");

    while ($data = fgetcsv($handle,1000,",","'")) {
        if ($data[0]) {

        $name = $data[0];
        $model = $data[1];
        $quantity = 100;
        $image_url = $data[2];
        $data1->execute();

        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:50:24.337

翻转你的循环：

```
while ($data = fgetcsv($handle,1000,",","'")) {
    if ($data[0]) {
        mysql_query("INSERT INTO products (name, model, quantity, image_url) VALUES
            (
                '".addslashes($data[0])."',
                '".addslashes($data[1])."',
                //quantity is 100 for all
                '100',
                '".addslashes($data[2])."'
            )
        ");
    }
} 
```

因为在您的原始代码中，直到您在语句`$data`中定义它才存在。`while`

还有许多其他问题，但这应该能让你继续前进。

# node.js - Socket.io + Express：不同路线的不同事件/功能

> ID：15733699
> 
> 赞同：3
> 
> 时间：2013-03-31T19:42:10.260
> 
> 标签：node.js, express, socket.io

嗯......我的第一个 express + socketio 节点应用程序启动并运行。

Socketio 几乎在我的应用程序的每个页面上都使用，因为当添加新条目时，这些页面上显示的所有“列表”都应该使用 server-push 进行更新。

所以我得到了我的主要 app.js 文件 + 一个包含所有 route.js 文件的路由目录。现在我需要为每条路由使用不同的 socketio 事件 + 函数，因为这些页面上发生了不同的事情。

现在的问题是如何访问我的快速服务器以初始化 socketio 对象？

```
// app.js
var server = app.listen(app.get('port'), function(){...});
var io = socketio.listen(server);
// socket.io code here
// the code from here on should be different for each route.js file 
```

或者换句话说：

如何将 socket.io 的所有事件和函数定义排除到相应的路由文件中，以便为每个页面定义不同的 socket.io 事件和函数？套接字当然可以始终在同一个端口上运行（我希望没问题？！）。

我希望这是可以理解的……有点难以解释。

最好的问候帕特里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T20:12:41.337

根据用户连接的路由，您可以使用`socket.io`库中的命名空间向特定的用户组发送消息。

向所有连接的用户发送消息`/news`

`io.of('/news').emit('update',{message:"a new article is available"});`

至于客户端，一个简单的事件监听器会做（假设用户是`/news`命名空间）

```
socket.on('update',function(data){
 alert(data.message);
}); 
```

恕我直言，您不需要不同的事件，只需使用相同的事件并在每条路线中以不同方式处理它们。

# asp.net-mvc - 如何将所有 blob 存储在 azure 存储容器中

> ID：15733700
> 
> 赞同：3
> 
> 时间：2013-03-31T19:42:23.537
> 
> 标签：asp.net-mvc, azure

我有一个名为“images”的天蓝色容器，但我不知道如何获取存储在这个容器中的所有 blob

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-31T19:53:46.983

我找到了答案：

```
// We get reference for the container (by name "containerName" variable)
container = blobClient.GetContainerReference(containerName);

// We create the container if this container is not exists
container.CreateIfNotExist();

// Set permissions
var permissions = new BlobContainerPermissions 
{ 
    PublicAccess = blobContainerPublicAccessType.Blob 
};
container.SetPermissions(permissions);

// Get list of all blobs URLs which are stored inside container
IEnumerable<IListBlobItem> blobs = container.ListBlobs();
return blobs.Select(item => item.Uri.ToString()).ToList(); 
```

# visual-studio-2010 - Clickonce 部署导致 InitializeComponent() 中出现“空引用”错误；

> ID：15733701
> 
> 赞同：0
> 
> 时间：2013-03-31T19:42:29.727
> 
> 标签：visual-studio-2010, clickonce

Winforms 应用程序的 Clickonce 部署导致 InitializeComponent() 中出现“空引用”错误；直接运行可执行文件不会产生错误。

关于为什么会发生这种情况的任何想法？

编辑：

似乎与获取 Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) 的值有关

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T00:37:53.643

这本身不是 ClickOnce 问题，而是您的应用程序的问题。如果您在 \apps\2.0\obfuscatedfoldername\obfuscatedfoldername\xxxx...tion... 下找到 exe 文件（其中 xxxx 是前四个字符或您的程序集名称）并双击它，应用程序是否运行？可能不是。

将一些 try/catch 语句放入显示异常的消息框（如果有异常），以尝试*准确*找出导致问题的代码行。它将是 Environment.GetFolderPath 是没有意义的，除非你用它做一些奇怪的事情，所以找到导致问题的确切行并将其发布回这里。

# c++ - 应用程序部署——客户端无音频、无图像

> ID：15733705
> 
> 赞同：3
> 
> 时间：2013-03-31T19:42:48.970
> 
> 标签：c++, qt, opengl, deployment, windows-7

我正在部署一个用 Qt + OpenGL 编写的应用程序，它是用 Visual Studio 2008 for windows 7 编写的。

在客户端机器上，应用程序中不播放音频，也不显示图像。我保持非常简单。图像和音频文件没有不同的文件夹，所有内容都位于 .exe 附近 在我的代码中，我访问了这些文件，例如

```
QPixmap pixmap("closeButton.jpg"); 
```

现在有趣的是它在我的电脑上“完美”地工作。所以我没有找到问题所在

我尝试了从 /Release 到 /myProject 的输出目录，其中存在所有源文件以及图像和音频文件。同样，它适用于我的计算机，但不适用于客户端。

由于我无法在我的机器上产生类似的问题，因此很难解决这个问题。有没有好的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T05:07:10.673

行。现在问题解决了。我实际上缺少两个 dll，每个 dll 用于来自的音频和图像

Qt\Version\Plugins\ 目录。Dependency walker 不显示插件依赖项。

还参考第一个答案的评论，Qt 资源实际上包含在二进制文件中。![看这里](https://i.stack.imgur.com/j2KlJ.jpg)

谢谢你们的帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:45:42.183

您非常需要将音频/图像和任何其他外部文件作为**资源**添加到项目中。

例如，我编写了一个将图像加载到`QImage`小部件中的代码。我的资源文件的属性是：

![在此处输入图像描述](https://i.stack.imgur.com/rSh93.png)

稍后在代码中，我将文件称为：

```
QImage tmp(":/mario-block.png"); 
```

该交易的另一个重要部分是验证资源是否已正确加载，因此在这种情况下，我还添加了以下行：

```
if (tmp.isNull())
{
    std::cout << "!!! Failed to load image #1" << std::endl;
    return;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T19:44:36.657

您是否确认您的图像和音频文件包含在安装包中？如果您访问这些文件，您是否使用了正确的路径？

# visual-c++ - 竞技场分配器分配方法和违规写作问题

> ID：15733708
> 
> 赞同：0
> 
> 时间：2013-03-31T19:43:02.413
> 
> 标签：visual-c++

基本上，我正在尝试创建一个 Arena Allocator，而不使用结构、类或 new 运算符来手动管理内存。我有一个定义的大小、一个字符池、一个分配方法和一个 freeMemory 显示方法。

请注意，这`pool[0]`是我的索引，它将跟踪上次填充内存的位置。

```
const int size = 50000;
char pool[size];

void start() {
    pool[0] = 1;
}

int freeMemory(void) {
    int freemem = 0;
    for(int i = 0; i < size; i++) {
        if(pool[i] == NULL) {
            freemem++;
        }
    } 
    return freemem;
}

 void* allocate(int aSize)
 {

if(freeMemory() == 0)
  {
        out();
  }

else
{
    char* p = NULL;
    int pos = pool[0];
    pool[pos] = (char) a;
    p = &pool[pos];
    pool[0] += a;
    return((void*) &pool[pos]);
}
} 
```

在 main.cpp 中：

```
start();
long* test1 = (long *) allocate(sizeof(long));
cout << freeMemory() << endl; //Returns 49999
*test1 = 0x8BADF00D; //Breaks here
cout << freeMemory() << endl; 
```

当我尝试使用 0x8BADF00D 时它会中断，我相信我在初始化其中一些变量时也遇到了问题。

MemoryManagerC.exe 中 0x000515f7 处未处理的异常：0xC0000005：0x8BADF00D 上的访问冲突写入位置 0x00000004

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T23:43:43.720

There are some problems with allocate:

```
char* pointer = NULL;
int pos = pool[0]; 
```

`pool[0]` is a `char`. It's not big enough to store indexes to all members of the array.

```
pool[pos] = (char) a; 
```

I'm not sure what you're storing here, or why. You seem to be storing the size of the allocation *in* the space that you're allocating.

```
pointer = &pool[pos + a]; 
```

I think you're constructing a pointer to the memory *after* the allocated portion. Is that right?

```
pool[0] += a; 
```

And here you're incrementing the offset that shows how much of the pool is allocated, except that a single `char` isn't going to be big enough for more than a tiny quantity of allocations.

```
return((void*) &pointer); 
```

And now you're returning the *address* of the pointer variable. That's going to be an address on the stack, and unsafe to use. Even if you just the *contents* of `pointer` instead of its address, I think it would point after the region you just allocated in your pool.

There are also problems with freeMemory. It compares the contents of the pool (`char` elements) with NULL. This suggests you think it contains pointers, but they are just `char`s. It's not clear why unallocated parts of the pool would be 0\. Do you even allow deallocation within the pool?

Perhaps you could explain how you intend the allocator to work? There's obviously a gap between what you think it should do and what it actually does, but it's not clear what you think it should do, so it's hard to give advice. How do you apportion space in the array? Do you allow deallocation? What information is supposed to be encoded where?

* * *

I just realised that allocate uses the undefined variable `a`. Is that supposed to be the same thing as the parameter `aSize`? That's what I assume here.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T20:19:28.180

下面的代码有很多错误。

```
char* pointer;
for(int i = 0; i < size; i++)
{
    *pointer = pool[i];
    if(pointer != NULL)
    {
        pointer = (char*) a;
        return((void*) i); //return the pointer
    }
 } 
```

这一行将一个字符复制到一个未知的内存位置。由于`pointer`从未初始化，我们只能猜测它指向的位置

```
 *pointer = pool[i]; 
```

您可能打算复制一个指针。

```
 pointer = &pool[i]; 
```

尽管如果您*确实*打算从`pool`数组中复制一个指针，这将**始终**是正确的。该数组中的所有元素都不位于 address `NULL`。

```
 if(pointer != NULL) 
```

现在此代码更改`pointer`为指向...更多无效地址。当`a`is时`sizeof(long)`，该大小被重新解释为内存地址。内存地址`0x00000004`最有可能。

```
 pointer = (char*) a; 
```

然后这将返回地址`0x00000000`，在你的情况下。因为`i`是`0`。

```
 return((void*) i); //return the pointer 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T20:10:17.977

您的代码可能存在问题。

```
char* pointer;
for(int i = 0; i < size; i++)
{
    *pointer = pool[i]; 
```

这里的事情是这可能适用于某些编译器（我认为它不应该）。

`pointer`这里没有指向任何分配的东西。所以当你这样做时

```
*pointer = pool[i]; 
```

pool[i] 应该复制到哪里？例如，假设我们这样声明指针。

```
char* pointer = NULL; 
```

现在很明显

```
*pointer = pool[i]; 
```

是错的。 `g++`（我注意到）初始化指向 NULL 的指针。所以你的代码会出现段错误。VC++ 可能会工作，因为它没有 NULL initialize `pointer`。但是您正在写入不属于您的内存位置。

# php - 输入后执行带有字段值的php函数

> ID：15733709
> 
> 赞同：0
> 
> 时间：2013-03-31T19:43:03.363
> 
> 标签：php, ajax

我有一个表格询问新用户的电子邮件。我有一个 php 函数，可以使用此电子邮件通过 cURL 请求获取信息（名字、姓氏、办公室、工作......）并将其返回到数组（`$full_informations`）中。

**我希望在输入电子邮件后执行此功能**。由于不同的原因，我不能直接将代码添加到我的表单中，所以我需要一些可以在正文或头部的其他地方读取的内容。

我得到了这个由脚本自动填充的字段：

```
<input  onKeyPress="" class="editingSize " type="text" id="emails" name="emails" size="" value="" maxlength="150"> 
```

我希望能够将此字段的值发送到 php 函数，例如

```
$full_informations = get_more_info_from_mail($email) 
```

然后我可以做类似的事情

```
$firstname = $full_informations['firstname'];
$lastname = $full_informations['lastname'];
$job = $full_informations['job'];
//... 
```

并使这些变量自动插入到我的 mysql 数据库中，而不要求用户填写表格（我知道如何制作该部分）。

所以，我的问题是，**如何在用户输入电子邮件后使用字段值调用我的函数**？

我想我需要一些 ajax 请求，但我根本不熟悉这些请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T20:09:34.007

你用的是mysql数据库。您可以像这样在 php 中实现这一点：

把它放在你页面的开头

```
<?
    if (isset($_POST['submit'])) {
        $link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
        $mail = $_POST['mail'];
        $result = mysql_query("SELECT * FROM users WHERE email = $mail");
        $row = mysql_fetch_row($result);

        $firstName = $row[0]; //FirstName
        $lastName =  $row[1]; //LastName
        $job =       $row[2]; //Job
    }
?> 
```

您的 html 应如下所示：

```
<form action="" method="POST">
    <input type="text" name="mail" />
    <input type="submit" value="submit" name="submit" />
</form> 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T20:01:26.333

使用 jquery：

```
<script type="text/javascript">
$(function() {
    $('#emails').on('blur',function() {
        $.post('/path/to/your/php.php',
        {email: $('#emails').val()},
        function(json) {
            alert('responded with '+json.response);
        });
    });
});
</script> 
```

您的 php 脚本应如下所示：

```
<?php
$email = $_GET['email'];
// make sure you verify the email is in a correct format.
// save it to a database

//if it succeeds:
echo json_encode(array('response'=>'success'));

//if it fails:
echo json_encode(array('response'=>'failure')); 
```

# python - 从排序列表中提取索引

> ID：15733711
> 
> 赞同：1
> 
> 时间：2013-03-31T19:43:10.653
> 
> 标签：python, numpy

假设您有一个未排序的列表，并且您使用`np.sort`. 有没有办法使用numpy从原始列表中获取排序列表的索引？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:00:15.880

最简单的方法是使用位置索引来扩充数组，然后对二维数组进行排序。这会同时为您提供已排序的数据及其原始位置指示。

如果您只想要索引（而不是排序数据），请使用*argsort*：

```
>>> from numpy import array
>>> arr = array([10, 5, 80, 20, 70, 18])
>>> arr.argsort()
array([1, 0, 5, 3, 4, 2]) 
```

# c# - 具有统一性的 Caliburn.micro

> ID：15733713
> 
> 赞同：4
> 
> 时间：2013-03-31T19:43:30.930
> 
> 标签：c#, wpf, unity-container, caliburn.micro

目前我正在了解更多关于 caliburn.micro 的信息，这太棒了。

在我的带有一些导航的小型演示项目中，有 MEF 和 EventAggregator。

由于我想在已经使用统一的项目中使用 caliburn.micro，因此我想将 Unity 用于 DI。

如何设置引导程序以使用 Unity？

除了 MindScape 教程和 codeplex 页面上的教程之外，任何好的教程都非常受欢迎。（除了我没有看到合适的人处理这个案子）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-06-29T07:05:16.257

我发现[CM 的 Wiki](http://caliburnmicro.codeplex.com/wikipage?title=Customizing%20The%20Bootstrapper)非常有用，并且来自 Unity/CSL 背景，`Bootstrapper<TRootModel>`方法名称和签名非常直观。

我想分享我自己的`UnityBootstrapper<TRootModel>`使用 Unity 3 的类，它小巧、干净并且可以满足您的期望。

```
/// <summary>
/// <para>Unity Bootstrapper for Caliburn.Micro</para>
/// <para>You can subclass this just as you would Caliburn's Bootstrapper</para>
/// <para>http://caliburnmicro.codeplex.com/wikipage?title=Customizing%20The%20Bootstrapper</para>
/// </summary>
/// <typeparam name="TRootModel">Root ViewModel</typeparam>
public class UnityBootstrapper<TRootModel>
    : Bootstrapper<TRootModel>
    where TRootModel : class, new()
{
    protected UnityContainer Container
    {
        get { return _container; }
        set { _container = value; }
    }

    private UnityContainer _container = new UnityContainer();

    protected override void Configure()
    {
        if (!Container.IsRegistered<IWindowManager>())
        {
            Container.RegisterInstance<IWindowManager>(new WindowManager());
        }
        if (!Container.IsRegistered<IEventAggregator>())
        {
            Container.RegisterInstance<IEventAggregator>(new EventAggregator());
        }
        base.Configure();
    }

    protected override void BuildUp(object instance)
    {
        instance = Container.BuildUp(instance);
        base.BuildUp(instance);
    }

    protected override IEnumerable<object> GetAllInstances(Type type)
    {
        return Container.ResolveAll(type);
    }

    protected override object GetInstance(Type type, string name)
    {
        var result = default(object);
        if (name != null)
        {
            result = Container.Resolve(type, name);
        }
        else
        {
            result = Container.Resolve(type);
        }
        return result;
    }
} 
```

您可以直接实例化它，提供有效的泛型类型参数，或者您可以子类化和自定义诸如 Lifetime Managers 之类的东西：

```
public class AppBootstrapper
    : UnityBootstrapper<ViewModels.AppViewModel>
{
    protected override void Configure()
    {
        // register a 'singleton' instance of the app view model
        base.Container.RegisterInstance(
            new ViewModels.AppViewModel(), 
            new ContainerControlledLifetimeManager());

        // finish configuring for Caliburn
        base.Configure();
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-31T19:51:15.207

您必须在引导程序中覆盖 4 种方法来连接 IoC 容器（使用时`Boostrapper<T>`）：

1.  `Configure()`

    这通常是您初始化容器并注册所有依赖项的地方。

2.  `GetInstance(string, Type)`

    按类型和键检索对象 - 据我所知，框架通常使用它来检索例如视图模型、常规依赖项。所以在这里你的容器必须以*某种方式*获取一个基于 a`string`和/或的实例`Type`（通常类型，当你使用视图优先绑定将模型连接到视图时使用字符串）。通常容器有类似的内置方法，开箱即用或只需要稍作调整。

3.  `GetAllInstances(Type)`

    检索对象集合（仅按类型） - 再次，据我从经验中可以看出，Caliburn.Micro 通常将这个用于视图。

4.  `BuildUp(object)`

    一种可以对对象进行属性注入的方法。

如果您有兴趣，我有一个使用 SimpleInjector（或 Autofac）的示例，不幸的是我没有使用 Unity 的经验。

[编辑]

采样时间！这个使用的是 SimpleInjector。

```
public class MainViewModel
{
//...
}

public class ApplicationBootstrapper : Bootstrapper<MainViewModel>
{
    private Container container;

    protected override void Configure()
    {
        container = new Container();

        container.Register<IWindowManager, WindowManager>();
      //for Unity, that would probably be something like:
      //container.RegisterType<IWindowManager, WindowManager>();
        container.RegisterSingle<IEventAggregator, EventAggregator>();

        container.Verify();
    }

    protected override object GetInstance(string key, Type service)
    {
        // Now, for example, you can't resolve dependency by key in SimpleInjector, so you have to
        // create the type out of the string (if the 'service' parameter is missing)
        var serviceType = service;
        if(serviceType == null)
        {
            var typeName = Assembly.GetExecutingAssembly().DefinedTypes.Where(x => x.Name == key).Select(x => x.FullName).FirstOrDefault();
            if(typeName == null)
                throw new InvalidOperationException("No matching type found");

            serviceType = Type.GetType(typeName);
        }

        return container.GetInstance(serviceType);
        //Unity: container.Resolve(serviceType) or Resolve(serviceType, name)...?

    }

    protected override IEnumerable<object> GetAllInstances(Type service)
    {
        return container.GetAllInstances(service);
        //Unity: No idea here.
    }

    protected override void BuildUp(object instance)
    {
        container.InjectProperties(instance);
        //Unity: No idea here.
    }
} 
```

# java - Android 客户端实现错误

> ID：15733716
> 
> 赞同：0
> 
> 时间：2013-03-31T19:43:46.713
> 
> 标签：java, android, tcp, client-server

试图让 android 设备从我拥有的服务器获取数据：

```
RetreiveFeedTask DoStuff=new RetreiveFeedTask();
            try{
            Work=(DoStuff.execute(Exec)).get();
            }
            catch(Exception e)
            {System.out.print(e+"");} 
```

异步实现：

```
class RetreiveFeedTask extends AsyncTask<String , Void , String> {

//private Exception e;
String GotBack="empty";
@Override
protected String doInBackground(String... params) {

    try{ 
            Socket socket = new Socket("192.168.1.66", 2727);   
            OutputStream out = socket.getOutputStream();       
            PrintWriter output = new PrintWriter(out);    
            BufferedReader input=new BufferedReader(new InputStreamReader(socket.getInputStream()));
            output.println(params[0]);
            output.flush();
            output.close();
            GotBack="OverWritten";
            GotBack=input.readLine();
            socket.close();                                                 
            }
        catch(Exception e){System.out.print(e+"");}
    return GotBack;
} 
```

}

我的服务器正在发送 ACK：“1\n”

但是我在屏幕上看到的是“覆盖”，这是我从服务器读取数据之前的值。

知道为什么吗？

**更新**

我正在关闭输出套接字，所以它抛出了异常。现在我没有收到错误，但我得到的值是空的。知道为什么吗？

新代码：

```
class RetreiveFeedTask extends AsyncTask<String , Void , String> {

//private Exception e;
String GotBack="empty";
@Override
protected String doInBackground(String... params) {

    try{ 
            Socket socket = new Socket("192.168.1.66", 2727);   
            OutputStream out = socket.getOutputStream();       
            PrintWriter output = new PrintWriter(out);    
            BufferedReader input=new BufferedReader(new InputStreamReader(socket.getInputStream()));
            output.println(params[0]);
            output.flush();
            String read="";
            while((read=input.readLine())!=null)
            {
            GotBack+=read;
            }
            output.close();
            socket.close();                                                 
            }
        catch(Exception e){Log.e("MyApp","exception",e);}
    return GotBack;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:54:28.243

是的。执行`input.readLine();`必须引发您处理和打印的异常。的值`GotBack`现在是“OverWritten”，它在 上返回`return GotBack;`。

# javascript - jQuery中的动态参数

> ID：15733722
> 
> 赞同：0
> 
> 时间：2013-03-31T19:44:20.490
> 
> 标签：javascript, jquery

我有一个函数，其中 append 方法采用静态参数。

```
 function toggle() {
         $("#MS").append($('#hide'));        
    } 
```

我想要的是从我的超链接点击事件中动态传递参数。在上面的代码中，#MS 是静态的，我想动态传递

代码：HTML

```
<div id="MS">
        <a href="javascript:void(0);" onclick="toggle();">JP MORGAN</a><br>
    </div> 
```

我想将参数从 onclick 传递给切换方法，并且该参数将在 append 方法中使用。

我尝试了几种组合，但没有奏效。请帮忙..

更改后我的新代码

```
<script>
$(function() { // when the DOM is ready
    var $hide = $('#hide').click(function(){
       $(this).closest('div').hide();
    }); 

    $('a.toggle').click(function(e){
       e.preventDefault();
       $(this).parent().append($hide);
    });
}); 

</script>

<div id="JP">
        <a href="#">JP MORGAN</a><br>       
    </div> 
```

还是行不通

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:46:43.087

由于您使用的是 jQuery，因此您可以向`a`元素添加类并使用`parent`方法：

```
$(function() { // when the DOM is ready
    var $hide = $('#hide').click(function(){
       $(this).closest('div').hide();
    }); 

    $('a.toggle').click(function(e){
       e.preventDefault();
       $(this).parent().append($hide);
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T19:46:44.797

动态检索`ID`锚点`click`事件并将该 ID 传递给函数：

```
$("a").on("click", function(e){
    e.preventDefault();

    $(this).append($('#hide')); 

}; 
```

# optimization - 重复的图像会增加网站的加载时间吗？

> ID：15733728
> 
> 赞同：1
> 
> 时间：2013-03-31T19:44:43.840
> 
> 标签：optimization, load-time

我正在尝试优化我网站的加载时间。在代码的不同位置请求相同的图像会增加加载时间吗？例如，我使用图像作为按钮的背景，并且在网站的不同位置加载相同的图像。这是一个问题，还是因为所有按钮中的文件都相同，浏览器只加载一次？如果有问题，我该如何优化它？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:48:22.827

不，多次重复相同的图像应该只加载一次。您甚至可以走得更远，实际上使用 css sprites 将多个图像合二为一（一个图像是一个图像网格，作为一个较小的包含 div 中的背景，并使用背景位置属性移动它）

# java - 制作一个 Hashmap，其键是字符串，值是 HashSet

> ID：15733733
> 
> 赞同：1
> 
> 时间：2013-03-31T19:45:24.527
> 
> 标签：java, hashmap, hashset

试图用字符串的键和 HashSet 的值制作一个 Hash Map。我希望哈希集都是整数

```
Set<String> numbersSet = new HashSet<Integer>();

// won't work:
HashMap<String, numberSet> database = new HashMap<String, numberSet>();//error - "( or [ expected"

//Also won't work. If it did, how can even I add to the set inside this hashMap?
HashMap<String, HashSet<Integer>> database = new HashMap<String, HashSet<Integer>>(); //error-incompatible types 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:52:55.440

```
HashMap<String, HashSet<Integer>> database = new HashMap<String, HashSet<Integer>>(); 
```

为我工作。

顺便说一句，如果您使用的是 JDK 1.7，您可以使用：

```
HashMap<String, HashSet<Integer>> mymap = new HashMap<>(); 
```

# prolog - 为什么 prolog 输出一个奇怪的树状列表？

> ID：15733735
> 
> 赞同：1
> 
> 时间：2013-03-31T19:45:25.067
> 
> 标签：prolog, primes, difference-lists

在这个 Prolog 代码中，我打算列出前 N 个素数，

```
(...)

biggerPrime(N,P) :-
    isPrime(N),
    P is N,
    !.

biggerPrime(N,P) :-
    N1 = N+1,
    biggerPrime(N1,P).

primeListAcc(0,A,R,R) :- !.

primeList(N,L) :-
    primeListAcc(N,1,[],L).

primeListAcc(N,A,L,R) :-
    N1 is N-1,
    biggerPrime(A,P),
    A1 is P+1,
    primeListAcc(N1,A1,[P|L],R). 
```

如果我希望列表向后排序，它可以正常工作：

```
?- primeList(5,L).
L = [11, 7, 5, 3, 2]. 
```

但是，如果我将代码的最后一行从 [P|L] 更改为 [L|P]，如下所示：

```
primeListAcc(N,A,L,R) :-
        N1 is N-1,
        biggerPrime(A,P),
        A1 is P+1,
        primeListAcc(N1,A1,[L|P],R). 
```

我得到：

```
?- primeList(5,L).
L = [[[[[[]|2]|3]|5]|7]|11]. 
```

我错过了什么？这让我发疯！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T19:59:47.437

回想一下，列表要么是空列表，要么`[]`是具有函子`'.'`和两个参数的项，其第二个参数是列表。语法`[P|Ps]`是 term 的简写符号，`'.'(P, Ps)`如果`Ps`是一个列表，它就是一个列表（就像您的示例中的情况一样）。`'.'(Ps, P)`另一方面，术语也可以写成`[Ps|P]`（如您所做的那样），如果不是列表，*则*`P`不是列表。您可以使用 获取反向列表`reverse/2`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T12:41:14.567

太好了，所以您发现了将元素添加到列表*末尾*的问题。在 Prolog 中，我们可以使用

```
add(X,L,Z):- L=[X|Z]. 
```

等等，什么？怎么读这个？我们必须知道这里的调用约定。我们*期望* `L`和`Z`作为*未实例化*的变量进入，并且我们`L`从现在开始安排指向一个新创建的*cons*节点`X`，其头部和`Z`尾部。`Z`可能在将来的某个调用中被实例化。

IOW 我们在这里创建的是一个开放式列表，`L = [X|Z] = [X, ...]`：

```
primeList(N,L) :-
    primeListAcc(N,1,[],L).

primeListAcc(N,A,Z,L) :- N > 0,   % make it explicitly mutually-exclusive,
    N1 is N-1,                    %   do not rely on red cuts which are easily
    biggerPrime(A,P),             %   invalidated if clauses are re-arranged!
    A1 is P+1,                    
    L = [P|R],                    % make L be a new, open-ended node, holding P
    primeListAcc(N1,A1,Z,R).      % R, the tail of L, to be instantiated further

primeListAcc(0,A,R,R).            % keep the predicate's clauses together 
```

现在我们可以看到`Z`这里并不真正需要它，因为它`[]`沿着递归调用链向下传递，没有改变。`primeListAcc`所以我们可以在没有参数的情况下重写`Z`，这样它的最后一个子句将是

```
primeListAcc(0,A,R):- R=[]. 
```

保留`Z`为未实例化的变量允许稍后用非空列表实例化它（当然，只有*一次*（除非发生回溯））。这构成了“差异列表”技术的基础。

* * *

要回答您的*字面*问题 - 在这里，请考虑以下交互记录：

```
1 ?- X=[a|b].

X = [a|b] 
2 ?- X=[a|b], Y=[X|c].

X = [a|b]
Y = [[a|b]|c] 
```

当它的尾部（这里， ）*不是*列表时，`[a|b]`输出就是 cons 节点的打印方式。原子，作为数字，*不是*列表。`b`

# javascript - 自动调整窗口大小或移动设备上的导航栏大小

> ID：15733743
> 
> 赞同：0
> 
> 时间：2013-03-31T19:46:02.310
> 
> 标签：javascript, html, css

我找到了代码： http: [//media02.hongkiat.com/responsive-web-nav/demo/index.html](http://media02.hongkiat.com/responsive-web-nav/demo/index.html)菜单在这里： http: [//www.hongkiat.com/blog/responsive-web-nav/](http://www.hongkiat.com/blog/responsive-web-nav/)

我正在尝试用我的菜单来做到这一点：

CSS：

```
<style type="text/css">
#trans-nav {list-style-type: none; height: 40px; padding: 0; margin: 0; }
#trans-nav { list-style-type: none; height: 40px; padding: 0; margin: 0; }
#trans-nav li { float: left; position: relative; padding: 0; line-height: 40px; }
#trans-nav li:hover { background-position: 0 -40px; }
#trans-nav li a { display: block; padding: 0 15px; color: #666666; text-decoration: none; }
#trans-nav li a:hover { background-color:#F36F25; color: #eeeeee; }
#trans-nav li ul { opacity: 0; position: absolute; left: 0; width: 8em; background: #EEEEEE; list-style-type: none; padding: 0; margin: 0; }
#trans-nav li:hover ul { opacity: 1; }
#trans-nav li ul li { float: none; position: static; height: 0; line-height: 0; background: none; }
#trans-nav li:hover ul li { height: 30px; line-height: 30px; }
#trans-nav li ul li a { background: #EEEEEE; }
#trans-nav li ul li a:hover { background: #666666; color:#EEEEEE; }

#trans-nav li { -webkit-transition: all 0.2s; }
#trans-nav li a { -webkit-transition: all 0.5s; }
#trans-nav li ul { -webkit-transition: all 1s; }
#trans-nav li ul li { -webkit-transition: height 0.5s; }
</style> 
```

HTML：

```
<ul id="trans-nav">
        <li><a href="#">Home</a></li>
        <li><a href="#">About</a></li>
        <li><a href="#">Products</a>
            <ul>
                <li><a href="#">Widgets</a></li>
                <li><a href="#">Thingamabobs</a></li>
                <li><a href="#">Doohickies</a></li>
            </ul>
        </li>
        <li><a href="#">Contact</a></li>
    </ul> 
```

由于某种原因，我无法让它工作，我可以做些什么来使我的菜单与该网站上的菜单相同，或者，如果这太复杂而无法让我的菜单更改为下拉菜单（选择）在屏幕上调整大小

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:09:44.567

你想要**css媒体查询**

媒体查询由媒体类型和至少一个表达式组成，该表达式通过使用媒体特征（例如宽度、高度和颜色）来限制样式表的范围。在 CSS3 中添加的媒体查询让内容的呈现可以针对**特定范围的输出设备进行定制，而无需更改内容本身。**

更多细节

[https://developer.mozilla.org/en/docs/CSS/Media_queries](https://developer.mozilla.org/en/docs/CSS/Media_queries)

[http://www.w3.org/TR/css3-mediaqueries/](http://www.w3.org/TR/css3-mediaqueries/)

# java - Android - JSON 存储列表包含在应用退出、重新打开时恢复为超类的对象

> ID：15733747
> 
> 赞同：3
> 
> 时间：2013-03-31T19:46:52.583
> 
> 标签：java, android, json, gson, persistent

我有一个`ArrayList <GeneralTemplate> items`

在我的整个程序中，我添加了作为 GeneralTemplate 子类的例程，即`items.add(new Routine("Test"));`一切都很好。

最重要的是，我可以做到以下几点..`Routine myRoutine = items.get(position);`

我正在使用 Google 的 GSON 库将这个大项目列表保存在 JSON 中的一个特殊数据对象中。我相信这可能是问题所在。

此数据对象包含`ArrayList <GeneralTemplate> items`. 在我的程序中，我可以看到存储在项目列表中的例程确实是`Routine`对象。然后我使用下面的代码保存它。我已经使用调试器跟踪了这个过程，当我设置RoutineList 时，Routine 对象的维护没有问题。

```
// Global save String method
public static void save()
{
    Editor editor = sharedPreferences.edit();

    RoutineData tempSaveObject = new RoutineData();
    tempSaveObject.setRoutineList(routineList);

    String routineListInJSON = gson.toJson(tempSaveObject);

    editor.putString(ROUTINE_LIST, routineListInJSON).commit();
} 
```

当我重新启动应用程序并检索数据时会出现问题。列表中的所有项目都恢复为`GeneralTemplate`对象，`Routine`不能通过`Routine routine = (Routine) items.get(position)`->转换回`ClassCastException`（下面的加载代码）

```
 // Get a global sharedPreferences object that can be used amongst Activities
    sharedPreferences = this.getSharedPreferences(SHARED_PREFS, Context.MODE_PRIVATE);

    if (sharedPreferences.contains(ROUTINE_LIST))
    {
        String routineListJSON = sharedPreferences.getString(ROUTINE_LIST, null);
        routineDataObject = gson.fromJson(routineListJSON, RoutineData.class);

        routineList = routineDataObject.getRoutineList();
    }
    else
    {
        routineList = new ArrayList<GeneralTemplate>();     
    } 
```

因此，我无法访问特定的方法和变量，因为我无法重新获得子类上下文。这个问题还有其他几个例子，所以如果有任何好的解决方案，你的好人都知道，这将有很大帮助。

谢谢！

排序：

根森 JSON 库。

[https://code.google.com/p/genson/downloads/detail?name=genson-0.94.jar&can=2&q=](https://code.google.com/p/genson/downloads/detail?name=genson-0.94.jar&can=2&q=)

让事情变得如此简单，无需自定义序列化器/反序列化器。默认情况下处理所有深度多态性的东西。

如Eugen的答案所示实施

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T21:00:34.713

这是因为您有一个 GeneralTemplate 列表，而序列化 Gson 知道列表中每个元素的具体类型，但在反序列化期间，Gson 不知道要反序列化的类型（因为它是 GeneralTemplate 的列表）。

我不确定，但看起来他们有一些 contrib（不是 Gson 的一部分）允许在序列化流中添加类型信息，这允许 Gson 反序列化回正确的类型。

您也可以尝试[Genson](http://code.google.com/p/genson/)库，开箱即用地支持处理多态类型。它也具有 Gson 和其他一些提供的功能。以下是如何实现它：

```
// first configure your Genson instance to enable polymorphic types support and  
// serialization based on concrete types
Genson genson = new Genson.Builder()
                            .setWithClassMetadata(true)
                            .setUseRuntimeTypeForSerialization(true)
                            .create();

// and now just use it to serialize/deser
String json = genson.serialize(routineData);
RoutineData data = genson.deserialize(json, RoutineData.class); 
```

**编辑** 问题解决了。例程类没有默认构造函数。将 @JsonProperty("name") 放在 ctr 参数上并使用 gensons 以前的配置解决了这个问题。

# android - 使用 WebView android 读取 Gif 图像

> ID：15733749
> 
> 赞同：3
> 
> 时间：2013-03-31T19:47:10.020
> 
> 标签：android, webview, gif

当我尝试在 Android 2.3.3 API 10 中使用 WebView 读取 gif 图像时，它不是动画的（它看起来是静态的）。我该如何解决这个问题？有什么我必须更改的设置吗？

ActivtiyMain.xml：

```
<WebView
    android:id="@+id/webView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/textView1"
    android:layout_below="@+id/textView1"
    android:layout_marginTop="14dp" 
    /> 
```

MainActivity.java：

```
public WebView Wv;

Wv = (WebView) findViewById(R.id.webView1);
Wv.loadUrl("file:///android_asset/bet.gif"); 
```

bet.gif：添加到 assets 文件夹的 gif 图像。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-01T05:54:00.397

当您尝试从资产目录加载 gif 时，它不是动画的，您应该为此使用 GifWebView。

activity_main.xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#da4040" >

    <WebView
        android:id="@+id/webviewActionView"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:minHeight="200dp"
        android:minWidth="200dp"
        android:scrollbars="none" >
    </WebView>

</RelativeLayout> 
```

MainActivity.java

```
package com.test2;

import java.io.InputStream;

import android.app.Activity;
import android.os.Bundle;
import android.webkit.WebView;
import android.webkit.WebViewClient;

public class MainActivity extends Activity {

    WebView webviewActionView;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        InputStream stream = null;
        try {
            stream = getAssets().open("loading2.gif");
        } catch (Exception e) {
            e.printStackTrace();
        }

        webviewActionView = (WebView)findViewById(R.id.webviewActionView);
        webviewActionView.setWebViewClient(new MyWebViewClient());
        webviewActionView.getSettings().setJavaScriptEnabled(true);

        GifWebView view = new GifWebView(this, stream);
        webviewActionView.addView(view);
    }

    private class MyWebViewClient extends WebViewClient {
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
            view.loadUrl(url);
            return true;
        }
    }
} 
```

GifWebView.java

```
package com.test2;

import java.io.InputStream;

import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Movie;
import android.os.SystemClock;
import android.view.View;

public class GifWebView extends View {
    private Movie mMovie;
    InputStream mStream;
    long mMoviestart;

    public GifWebView(Context context, InputStream stream) {
        super(context);
        mStream = stream;
        mMovie = Movie.decodeStream(mStream);
    }

    @Override
    protected void onDraw(Canvas canvas) {
        canvas.drawColor(Color.TRANSPARENT);
        super.onDraw(canvas);
        final long now = SystemClock.uptimeMillis();

        if (mMoviestart == 0) {
            mMoviestart = now;
        }
        final int relTime = (int) ((now - mMoviestart) % mMovie.duration());
        mMovie.setTime(relTime);
        mMovie.draw(canvas, 10, 10);
        this.invalidate();
    }
} 
```

*将“ **loading2.gif** ”文件放在您的资产目录中。*

从下面的链接下载这个完整的deom

[下载演示](http://www.mediafire.com/?01ji789xqs5c2zj)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-03-09T07:19:00.987

要在您的 android 代码中使用 GIF，

**第 1 步：**资产文件夹设置：在此文件夹中，您必须放置 GIF 和 html 代码。HTML代码如下

```
<html>
<head>
    <style type='text/css'>body{margin:auto auto;text-align:center;} img{width:100%25;}</style>
</head>
<body>
<img src="splash.gif" width="100%"/>
</body>
</html>
```

在此代码中，假设您的资产文件夹中有 splash.gif

**第 2 步：**只需使用此 url 加载 webview

**wvSplashScreen.loadUrl("file:///android_asset/splash.html");**

通过这 2 个简单的步骤，您可以在 webview 中加载 GIF

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T21:29:06.570

尚不支持动画 gif，尽管它们可以在某些设备上使用。请参阅：[http ://code.google.com/p/android/issues/detail?id=3422](http://code.google.com/p/android/issues/detail?id=3422)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-31T22:19:31.800

你试过调查[这个答案](https://stackoverflow.com/questions/4825383/gif-image-display-using-webview)吗？

引用此用户@Kantesh：

```
<html>
<body bgcolor="white">
    <table width="100%" height="100%">
        <tr>
            <td align="center" valign="center">
                <font color="gray">Some text you display</font>
                <br/>
                <br/>
                <br/>
                <br/>
                <br/>
                <img src="yourGIF.gif">
            </td>
        </tr>
    </table>
</body> 
```

# android - 获取sha1密钥

> ID：15733750
> 
> 赞同：0
> 
> 时间：2013-03-31T19:47:13.880
> 
> 标签：android, api, key

在android中，我尝试获取google apikey version 2，我尝试获取sha 1密钥，如下所示 keytool -list -v -keystore "C:\Users\sapu.android\debug.keystore" -alias androiddebugkey -storepass android -keypass android 但在命令提示符下，keytool 没有重新生成为内部或外部命令我该如何克服这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T19:52:13.697

`keytool`命令存储在哪里？它在你的道路上吗？如果没有，那么您需要提供完整路径。

更多说明可以在[这个较早的问题中找到](https://stackoverflow.com/questions/5488339/how-can-i-find-and-run-the-keytool)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:54:15.720

发生这种情况可能是因为 Java 主目录不在您的路径中。将 jdk 文件夹的完整路径添加到 Path 变量中，就可以了。

# javascript - jQuery 兼容的时间跨度选择器

> ID：15733752
> 
> 赞同：1
> 
> 时间：2013-03-31T19:47:31.550
> 
> 标签：javascript, jquery

我正在寻找一个允许用户指定时间跨度的 javascript 小部件，例如“十五分钟”或“两周”。我目前正在使用 jQuery，并且想要一些兼容的东西（以及对开源友好的东西）。虽然我发现了很多面向时间的控件，但它们似乎都是针对一天中的某个时间的，可能带有附加的日期或日期时间范围。

是否有任何小部件允许我指定不附加到任何特定日期的时间长度？

# codeigniter - CodeIgniter 表单验证总是返回 false

> ID：15733754
> 
> 赞同：1
> 
> 时间：2013-03-31T19:47:34.763
> 
> 标签：codeigniter, validation

几个小时以来，我一直在网上搜索和使用我的代码，但似乎无法弄清楚为什么这不起作用。

我有一个模板库，它扫描 template.html 中的 {@tags}，然后运行与标签关联的函数来为该 {@tag} 的内容创建数据，然后替换 {@tag} 生成的内容，所以我可以在我的模板中添加类似部件的小部件。

在我的帐户/访问页面上，我有一个登录表单和一个注册表单，现在当模板库调用 widget_register() 函数时，表单验证似乎没有做任何事情，正如我从分析器中看到的那样，数据已发布，但表单验证似乎对它没有任何作用

## 帐户控制器

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Account extends CI_Controller {

public function index()
{
    $this->load->helper('url');
    #redirect('/');
}

public function access()
{
    $this->load->helper('url');

    #if($this->auth->loggedin()) redirect('/');

    $this->template->compile_page();
}

public function widget_register($template)
{
    $this->output->enable_profiler(TRUE);

    $this->load->helper('url');

    if($this->auth->loggedin()) redirect('/');

    if ($this->input->post('register_submit'))
    {
        $this->load->model('auth_model');

        $this->form_validation->set_rules('register_nickname', 'Nickname', 'required|min_length[3]|max_length[75]');
        $this->form_validation->set_rules('register_email_address', 'Email Address', 'required|valid_email|is_unique[users.email]');
        $this->form_validation->set_rules('register_confirm_email_address', 'Confirm Email Address', 'required|valid_email|matches[register_email_address]');
        $this->form_validation->set_rules('register_password', 'Password', 'required|min_length[5]');
        $this->form_validation->set_rules('register_confirm_password', 'Confirm Password', 'required|min_length[5]|matches[register_password]');

        if($this->form_validation->run() !== false)
        {

            echo 'validation successful';
            $nickname = $this->input->post('register_nickname');
            $email = $this->input->post('register_email_address');

            $generate_salt = $this->auth->generate_keys();

            $salt = $generate_salt['1'];

            $this->load->library('encrypt');

            $generate_password =  $salt . $this->input->post('register_password');
            $password = $this->encrypt->hash($generate_password);

            $generate_series_key = $this->auth->generate_keys();
            $user_series_key = $generate_series_key['1'];

            $this->db->query('INSERT INTO users (nickname, email, password, salt, register_date) VALUES ( "'.$nickname.'", "'.$email.'", "'.$password.'", "'.$salt.'", "'.time().'")');
        }
        else
        {
            echo 'invalid';
            echo validation_errors();
        }
    }

    $this->load->helper('form');

    $view_data = array();
    $view_data['form'] = form_open('account/access');
    $view_data['input_nickname'] = form_input(array('name' => 'register_nickname', 'value' => set_value('register_nickname'), 'id' => 'register_nickname', 'class' => 'common_input', 'size' => '55'));
    $view_data['input_email'] = form_input(array('name' => 'register_email_address', 'value' => set_value('register_email_address'), 'id' => 'register_email_address', 'class' => 'common_input', 'size' => '55'));
    $view_data['input_confirm_email'] = form_input(array('name' => 'register_confirm_email_address', 'value' => '', 'id' => 'register_confirm_email_address', 'class' => 'common_input', 'size' => '55'));
    $view_data['input_password'] = form_password(array('name' => 'register_password', 'value' => '', 'id' => 'register_password', 'class' => 'common_input', 'size' => '55'));
    $view_data['input_confirm_password'] = form_password(array('name' => 'register_confirm_password', 'value' => '', 'id' => 'register_confirm_password', 'class' => 'common_input', 'size' => '55'));
    $view_data['form_submit'] = form_submit('register_submit', 'Register');
    $view_data['/form'] = form_close();
    $view_data['validation_errors'] = validation_errors('<div class="error-box">', '</div>');

    return $this->parser->parse(FCPATH.'themes/'.$this->settings->settings['system_settings']['theme'].'/widgets/'.$template.'.html', $view_data, TRUE);

}

function widget_login()
{
    $this->load->helper('url');

    // user is already logged in

    if ($this->auth->loggedin())
    {
        return $this->load->view(FCPATH.'themes/'.$this->settings->settings['system_settings']['theme'].'/widgets/login/user.html', '', TRUE);
    }

    if($this->input->post('register'))
    {
        redirect('authentication/register');
    }

    // form submitted

    if ($this->input->post('login_email_address') && $this->input->post('login_password'))
    {
        $this->load->library('form_validation');
        $this->load->model('auth_model');

        $this->form_validation->set_rules('login_email_address', 'Email Address', 'required|valid_email');
        $this->form_validation->set_rules('login_password', 'Password', 'required|min_length[4]');

        if($this->form_validation->run() !== false)
        {
            // validation passed verify from db

            $remember = $this->input->post('remember') ? TRUE : FALSE;

            if($remember == 'remember');

            // check user exists and return user data

            $user_data = $this->auth_model->user_exists($this->input->post('email_address'), TRUE);

            if($user_data != FALSE)
            {
                // compare passwords

                if ($this->auth_model->check_password($this->input->post('password'), $this->input->post('email_address')))
                {
                    $this->auth->login($user_data->uid, $remember);
                    redirect('/');
                }
                else { $this->form_validation->set_custom_error('Incorrect password'); }
            }
            else { $this->form_validation->set_custom_error('There are no users with that email address'); }
        }
    }

    // show login form

    $this->load->helper('form');

    $view_data = array();
    $view_data['form'] = form_open();
    $view_data['input_email'] = form_input('login_email_address', set_value('login_email_address'), 'id="login_email_address"');
    $view_data['input_password'] = form_password('login_password', '', 'id="login_password"');
    $view_data['input_remember'] = form_checkbox('remember', 'rememberme');
    $view_data['form_submit'] = form_submit('login_submit', 'Login');
    $view_data['register_button'] = form_submit('register', 'Register');
    $view_data['/form'] = form_close();
    $view_data['validation_errors'] = validation_errors('<div class="error-box">', '</div>');

    return $this->parser->parse(FCPATH.'themes/'.$this->settings->settings['system_settings']['theme'].'/widgets/login/login.html', $view_data, TRUE);
}

function logout()
{   
    $this->load->helper('url');
    $this->session->sess_destroy();

    $this->load->helper('cookie');
    delete_cookie('aws_session');
    delete_cookie('aws_autologin_cookie');

    redirect('/');
}
} 
```

## 和模板库

```
class Template {

private $settings;
private $_ci;
private $_controller = ''; # Controller in use
private $_method = ''; # Method in use
private $_is_mobile = FALSE; # Is the User agent a mobile?
private $cache_lifetime = '1';

private $page_output = "";
private $partials = array();
private $spts = array(); # Static page tags

function __construct()
{
    $this->_ci =& get_instance();
    $this->settings = $this->_ci->settings->settings;

    $this->_controller = $this->_ci->router->fetch_class();
    $this->_method = $this->_ci->router->fetch_method();

    $this->_ci->load->library('user_agent');
    $this->_is_mobile = $this->_ci->agent->is_mobile();

    log_message('debug', "Template Class Initialized");
}

function build_page()
{
    $page = $this->_ci->load->view(FCPATH.'themes/'.$this->settings['system_settings']['theme'].'/pages/'.$this->settings['page_settings']['template'].'.html', '', TRUE);

    $this->page_output .= $page;
}

# MAIN PAGE FUNCTIONS END ------------------------------------------------------------------------------------------

public function check_static_tags()
{
    if(preg_match_all('/{@[A-Z]{1,75}}/', $this->page_output, $matches))
    {
        $this->spts = $matches['0'];
        $this->spts = array_diff($this->spts, array('{@CONTENT}')); # removes stp_content from array list

        return TRUE;
    }
    return FALSE;
}

# Convert static tags

public function convert_static_tags()
{
    foreach($this->spts as $key => $static_tag)
    {
        $static_tag = str_replace(array('{','}'), '', $static_tag);
        $this->partials[$static_tag] = $this->build_widget($static_tag);
    }
}

# Convert widget tags

function column_widget_tags()
{
    if(preg_match_all('/{@COLUMN_[0-9]{1,11}}/', $this->page_output, $matches))
    {
        if(isset($this->settings['page_settings']['widgets']))
        {
            $columns = unserialize($this->settings['page_settings']['widgets']);
        }

        foreach($columns as $column_id => $widgets)
        {
            if(count($columns[$column_id]) > '0') // if the column contains widgets
            {
                $this->partials[''.$this->_stp.'_COLUMN_'.$column_id] = '';

                foreach($widgets as $key => $widget_id)
                {
                    // build the widget and add it to the $this->page_bits['column_id'] variable for replacing later in the compiler

                    $this->partials[''.$this->_stp.'_COLUMN_'.$column_id] .= $this->build_widget($widget_id);
                }
            }
            else
            {
                $this->partials[''.$this->_stp.'_COLUMN_'.$column_id] = '';
            }
        }
    }
}

# Build Widget

function build_widget($widget_id)
{
    if(is_numeric($widget_id))
    {
        $widget_query = $this->_ci->db->query('SELECT * FROM widgets WHERE id = "'.$widget_id.'"'); # BIND STATEMENTS
    }
    elseif(preg_match('/@[A-Z]{1,75}/', $widget_id))
    {           
        $widget_query = $this->_ci->db->query('SELECT * FROM widgets WHERE tag = "'.$widget_id.'"'); # BIND STATEMENTS
    }
    else
    {
        show_error('Could not get widget from database: '.$widget_id);
    }

    if($widget_query->num_rows() > 0)
    {
        $widget_info = $widget_query->row_array();

        // loads widgets parent controller, builds the widget (class method) and returns it

        $this->_ci->load->controller($widget_info['controller'], $widget_info['controller']);
        $method_name = 'widget_'.$widget_info['method'];
        $complete_widget = $this->_ci->$widget_info['controller']->$method_name($widget_info['template']);

        return $complete_widget;
    }
    else
    {
        show_error('The requested widget could not be loaded: '.$widget_id);
    }
}

# Replace Partials

function replace_partials()
{   
    $this->_ci->load->library('parser');
    $this->page_output = $this->_ci->parser->parse_string($this->page_output, $this->partials, TRUE);
}

## METADATA

public function prepend_metadata($line)
{
    array_unshift($this->_metadata, $line);
    return $this;
}

# Put extra javascipt, css, meta tags, etc after other head data

public function append_metadata($line)
{
    $this->_metadata[] = $line;
    return $this;
}

# Set metadata for output later

public function set_metadata($name, $content, $type = 'meta')
{
    $name = htmlspecialchars(strip_tags($name));
    $content = htmlspecialchars(strip_tags($content));

    // Keywords with no comments? ARG! comment them
    if ($name == 'keywords' AND ! strpos($content, ','))
    {
        $content = preg_replace('/[\s]+/', ', ', trim($content));
    }

    switch($type)
    {
        case 'meta':
            $this->_metadata[$name] = '<meta name="'.$name.'" content="'.$content.'" />';
        break;

        case 'link':
            $this->_metadata[$content] = '<link rel="'.$name.'" href="'.$content.'" />';
        break;
    }

    return $this;
}

# Embed page into layout wrapper

function layout()
{
    $this->_ci->load->helper('html');

    $this->append_metadata(link_tag('themes/'.$this->settings['system_settings']['theme'].'/css/layout.css')); # default stylesheet
    $this->append_metadata('<link rel="shortcut icon" href="/favicon2.ico" />'); # default favicon

    $template['template.title'] = $this->settings['page_settings']['title']; # Page title, can be overidden by the controller ?
    $template['template.metadata']  = implode("\n\t\t", $this->_metadata); # Metadata
    $template['template.body'] = $this->page_output; # The page

    return $this->_ci->parser->parse(FCPATH.'assets/layout/L6_layout_wrapper.html', $template, TRUE);
}

# Run all functions to build page and set in output class

function compile_page($content_data = '')
{
    $this->partials['@CONTENT'] = $content_data;

    $this->build_page();

    $this->column_widget_tags();

    if($this->check_static_tags())
    {
        $this->convert_static_tags();
        $this->replace_partials();
    }

    $output = $this->layout();

    $this->_ci->output->set_header('Expires: Sat, 01 Jan 2000 00:00:01 GMT');
    $this->_ci->output->set_header('Cache-Control: no-store, no-cache, must-revalidate');
    $this->_ci->output->set_header('Cache-Control: post-check=0, pre-check=0, max-age=0');
    $this->_ci->output->set_header('Last-Modified: ' . gmdate( 'D, d M Y H:i:s' ) . ' GMT' );
    $this->_ci->output->set_header('Pragma: no-cache');

    # Let CI do the caching instead of the browser
    #$this->_ci->output->cache($this->cache_lifetime);

    $this->_ci->output->append_output($output);
}
} 
```

抱歉，这篇文章太长了，我真的很困惑，不想错过任何代码，在此先感谢！

# mysql - 主键可以为空吗？如果是，为什么这个改变会导致这个结果？

> ID：15733755
> 
> 赞同：4
> 
> 时间：2013-03-31T19:47:39.710
> 
> 标签：mysql, sql, primary-key, alter

我有下表：

```
mysql> DESC my_contacts;  
+----------+-------------+------+-----+---------+-------+  
| Field    | Type        | Null | Key | Default | Extra |  
+----------+-------------+------+-----+---------+-------+  
| id       | varchar(20) | NO   | PRI |         |       |  
| location | varchar(20) | YES  |     | NULL    |       |  
| city     | varchar(20) | YES  |     | NULL    |       |  
| state    | varchar(2)  | YES  |     | NULL    |       |  
+----------+-------------+------+-----+---------+-------+  
4 rows in set (0.01 sec) 
```

如果我选择所有我得到：

```
mysql> SELECT * FROM my_contacts;  
+----+--------------+------+-------+  
| id | location     | city | state |  
+----+--------------+------+-------+  
| 1  | Chester,NJ   | NULL | NULL  |  
| 2  | Katy,TX      | NULL | NULL  |  
| 3  | San Mateo,CA | NULL | NULL  |  
+----+--------------+------+-------+  
3 rows in set (0.00 sec) 
```

我运行以下命令：

```
INSERT INTO my_contacts (city,state)  
VALUES  
(SUBSTRING_INDEX(location,',',1),RIGHT(location,2)); 
```

我的目的是填充列`city`，并`state`使用列中逗号之前的部分和逗号之后的部分`location`。
但以下发生在我的桌子上：

```
mysql> INSERT INTO my_contacts (city,state)  
    -> VALUES  
    -> (SUBSTRING_INDEX(location,',',1),RIGHT(location,2));  
Query OK, 1 row affected (0.02 sec)   

mysql> SELECT * FROM my_contacts;  
+----+--------------+------+-------+  
| id | location     | city | state |  
+----+--------------+------+-------+  
|    | NULL         | NULL | NULL  |  
| 1  | Chester,NJ   | NULL | NULL  |  
| 2  | Katy,TX      | NULL | NULL  |  
| 3  | San Mateo,CA | NULL | NULL  |  
+----+--------------+------+-------+  
4 rows in set (0.00 sec) 
```

我得到一条记录，`id`主键是空的。这怎么可能？
我的意思是它不是`NULL`，但主键也不应该是空的，对吧？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-31T19:50:18.567

您将`id`字段定义为 varchar，当您使用它来存储整数时，这是一个愚蠢的想法。空字段**不**为空。零长度字符串仍然是有效字符串，因此`id`就您的表而言是有效值。尝试插入**另一个**空白字符串，您将获得主键违规：

```
INSERT INTO yourtable (id) VALUES (''); // will not work 
```

该`id`字段应该是一个`int`类型。那将不允许“空”值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-31T19:50:30.397

主键是唯一的，因此如果您更改表，则第二行将尝试添加空值并失败。结果，它将尝试下一个可能的值。如果您希望第一个值不为空，您可以设置一个默认值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-31T19:50:30.377

它不是空的。它可能是一个空字符串。请注意，数据类型是 varchar(20)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-31T19:50:31.160

好吧，您没有为主键字段分配值，因此默认值为 NULL。. 您要修改表，使主键为`auto_increment`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-31T19:51:53.540

您可以将 a`varchar`用作与另一个数据库表相关的外键，但如果您希望将其用作数字键，则应使用数字数据类型，例如`int`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-23T00:28:05.000

我知道这并不能回答有关主键的确切问题，但是正如您的问题确实指出了您在从位置列解析城市和州时也遇到问题的事实，这是您要使用的查询（注意你想要一个 UPDATE 来修改现有的行，而不是一个将添加新行而不是列的 INSERT）：

```
UPDATE my_contacts
SET
    city = substr(location, 1, locate(',', location) - 1),
    state = substr(location, locate(',', location) + 1); 
```

# php - 自定义 Wordpress 主题 - fancybox 不工作？

> ID：15733769
> 
> 赞同：0
> 
> 时间：2013-03-31T19:48:51.247
> 
> 标签：php, javascript, wordpress, fancybox, fancybox-2

（WordPress 3.5.1）

嗨，在functions.php中，我包含以下内容：

```
function add_lightbox_cys() {
    wp_enqueue_script( 'jquery' );
    wp_enqueue_script( 'fancybox', get_template_directory_uri() . '/inc/lightbox/js/jquery.fancybox.pack.js', array( 'jquery' ), false, true );
    wp_enqueue_script( 'lightbox', get_template_directory_uri() . '/inc/lightbox/js/jquery.lightbox.js', array('fancybox'), false, true );
    wp_enqueue_script( 'lightbox-style', get_template_directory_uri() . '/inc/lightbox/css/jquery.fancybox.css' );
}
add_action( 'wp_enqueue_scripts', 'add_lightbox_cys'); 
```

然后使用以下代码创建了 lightbox.js：

`(function($) { $(".fancybox").fancybox(); })(jQuery);`

现在在 wordpress 附带的 wordpress 主题二十二中，这实际上可以在花式框中打开图片。

但是当我在我自己的定制主题中尝试这个时，它根本不会触发fancybox。

这里是网站的链接：http: [//goo.gl/y6qfb](http://goo.gl/y6qfb)

有谁能够帮助我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:18:47.117

您可以从这个清单开始（可能不是全部）：

1）。你的页面没有合适的`DOCTYPE`（不要问我为什么），你可以在你的新主题模板中修复它。

2）。您似乎没有使用灯箱，因此请删除此参考

```
wp_enqueue_script( 'lightbox', get_template_directory_uri() . '/inc/lightbox/js/jquery.lightbox.js', array('fancybox'), false, true ); 
```

3）。您正在将 fancybox css 样式表加载为**脚本**，因此出现错误

```
Timestamp: 31/03/2013 1:14:48 PM
Error: SyntaxError: syntax error
Source File: http://jarsis.de/tground/wp-content/themes/cys/inc/lightbox/css/jquery.fancybox.css?ver=3.5.1
Line: 2
Source Code: .fancybox-wrap, 
```

...所以你需要替换这一行：

```
wp_enqueue_script( 'lightbox-style', get_template_directory_uri() . '/inc/lightbox/css/jquery.fancybox.css' ); 
```

这样 ：

```
wp_enqueue_style( 'lightbox-style', get_template_directory_uri() . '/inc/lightbox/css/jquery.fancybox.css' ); 
```

...但这取决于您如何注册新样式表。

4）。您可能需要将您的 fancybox 初始化代码包装在`.ready()`方法中，例如：

```
(function($) { 
  $(function(){
     $(".fancybox").fancybox();
  });
})(jQuery); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T19:59:10.603

Firebug 报告[http://jarsis.de/tground/wp-content/themes/cys/inc/lightbox/js/jquery.lightbox.js?ver=3.5.1](http://jarsis.de/tground/wp-content/themes/cys/inc/lightbox/js/jquery.lightbox.js?ver=3.5.1)的 404 ，表明 Lightbox js 没有得到加载。我想这可以解释这个问题。

Firebug 还报告了一个语法错误，有点难以解释，但与“.fancybox-wrap”有关

# python - 在 Python 中使用工程符号（带 SI 前缀）将浮点数转换为字符串

> ID：15733772
> 
> 赞同：6
> 
> 时间：2013-03-31T19:48:57.230
> 
> 标签：python, string, numbers

我有一个浮点数，例如`x=23392342.1`

我想将其转换为带有工程符号的字符串（带有公制前缀）

[http://en.wikipedia.org/wiki/Engineering_notation](http://en.wikipedia.org/wiki/Engineering_notation) [http://en.wikipedia.org/wiki/Metric_prefix](http://en.wikipedia.org/wiki/Metric_prefix)

所以在我的例子中 23392342.1 = 23.3923421E6 = 23.3923421 M (mega)

我想显示`23.3923421 M`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-31T20:36:12.407

这是一个受[Formatting a number with a metric prefix 启发的函数？](https://stackoverflow.com/questions/12181024/formatting-a-number-with-a-metric-prefix?rq=1)

`metric.py`

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

import math

def to_si(d, sep=' '):
    """
    Convert number to string with SI prefix

    :Example:

    >>> to_si(2500.0)
    '2.5 k'

    >>> to_si(2.3E6)
    '2.3 M'

    >>> to_si(2.3E-6)
    '2.3 µ'

    >>> to_si(-2500.0)
    '-2.5 k'

    >>> to_si(0)
    '0'

    """

    inc_prefixes = ['k', 'M', 'G', 'T', 'P', 'E', 'Z', 'Y']
    dec_prefixes = ['m', 'µ', 'n', 'p', 'f', 'a', 'z', 'y']

    if d == 0:
        return str(0)

    degree = int(math.floor(math.log10(math.fabs(d)) / 3))

    prefix = ''

    if degree != 0:
        ds = degree / math.fabs(degree)
        if ds == 1:
            if degree - 1 < len(inc_prefixes):
                prefix = inc_prefixes[degree - 1]
            else:
                prefix = inc_prefixes[-1]
                degree = len(inc_prefixes)

        elif ds == -1:
            if -degree - 1 < len(dec_prefixes):
                prefix = dec_prefixes[-degree - 1]
            else:
                prefix = dec_prefixes[-1]
                degree = -len(dec_prefixes)

        scaled = float(d * math.pow(1000, -degree))

        s = "{scaled}{sep}{prefix}".format(scaled=scaled,
                                           sep=sep,
                                           prefix=prefix)

    else:
        s = "{d}".format(d=d)

    return s

if __name__ == "__main__":
    import doctest
    doctest.testmod() 
```

及其用法：

```
from metric import to_si
d = 23392342.1
print(to_si(d)) 
```

它会显示

```
23.3923421 M 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-07-15T21:42:37.120

使用[QuantiPhy](https://quantiphy.readthedocs.io/en/stable)包。它是一个稳定的、有据可查且支持良好的软件包，旨在满足您的需求。

```
>>> from quantiphy import Quantity

>>> v = Quantity(23.3923421E6)                                               
>>> str(v)                                                                   
'23.392M'                                                                    

>>> v.render(prec='full')                                                    
'23.3923421M' 
```

通常人们使用SI单位前缀与单位，而数量旨在将单位与数字结合起来。

```
>>> v = Quantity(23.3923421E6, 'V')
>>> print(v)
23.392 MV

>>> f = Quantity('23.3923421 MHz')
>>> print('{}'.format(f))
23.392 MHz 
```

Quantity 子类浮动，因此您可以像使用浮点数一样在表达式中使用数量：

```
>>> t = 1/f                                                                  
>>> print(t)                                                                 
4.274903281275114e-08

>>> t = Quantity(t, 's')                                                     
>>> print(t)
42.749 ns 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-31T20:16:26.727

直接的解决方案是使用[Decimal.to_eng_string](http://docs.python.org/2.7/library/decimal.html#decimal.Decimal.to_eng_string)方法，然后进行字典查找以将指数转换为适当的度量前缀。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-09-12T18:17:53.023

您可以使用具有附加格式选项的浮点类型的[Prefixed 。](https://pypi.org/project/prefixed/)

```
>>> from prefixed import Float

>>> x = Float(23392342.1)
>>> print(f'{x:!h}')
23.392342 M 
```

或者如果你想保留 7 个小数位

```
>>> print(f'{x:!.7h}')
23.3923421 M 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-01T02:45:33.367

这是一个没有依赖关系的简单方法：

```
def to_units(x_):
    units = {-12: "T",-9: "G",-6: "M",-3: "K",0: "",3: "m",6: "µ",9: "n",12: "p",15: "f"}
    k = -12
    while x_ * 10.0**k < 1: 
        k += 3
    return f"{x_*10.0**k}{units[k]}" 
```

例子：

```
for i in range(-15,15):
    print(f"{to_units(1*10.0**i)} \t {1*10.0**i:1,.15f}")

1.0f    0.000000000000001
10.0f   0.000000000000010
100.0f  0.000000000000100
1.0p    0.000000000001000
10.0p   0.000000000010000
100.0p  0.000000000100000
1.0n    0.000000001000000
10.0n   0.000000010000000
100.0n  0.000000100000000
1.0µ    0.000001000000000
10.0µ   0.000010000000000
100.0µ  0.000100000000000
1.0m    0.001000000000000
10.0m   0.010000000000000
100.0m  0.100000000000000
1.0     1.000000000000000
10.0    10.000000000000000
100.0   100.000000000000000
1.0K    1,000.000000000000000
10.0K   10,000.000000000000000
100.0K  100,000.000000000000000
1.0M    1,000,000.000000000000000
10.0M   10,000,000.000000000000000
100.0M  100,000,000.000000000000000
1.0G    1,000,000,000.000000000000000
10.0G   10,000,000,000.000000000000000
100.0G  100,000,000,000.000000000000000
1.0T    1,000,000,000,000.000000000000000
10.0T   10,000,000,000,000.000000000000000
100.0T  100,000,000,000,000.000000000000000 
```

# iphone - 使用模态视图设置标题不起作用

> ID：15733774
> 
> 赞同：1
> 
> 时间：2013-03-31T19:49:37.640
> 
> 标签：iphone, ios, objective-c

我启动以下模态控制器：

```
UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];

UIViewController *modal = [storyboard instantiateViewControllerWithIdentifier:@"modalController"];
modal.title = @"Example Title";
[self presentModalViewController:modal animated:YES]; 
```

我将标题设置为：

```
modal.title = @"Example Title"; 
```

但这不起作用，任何人都可以帮助我吗？

编辑：我已经用这样的 UINavigationController 包装了我的 ModalView

![在此处输入图像描述](https://i.stack.imgur.com/b1EKa.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:51:47.447

您正在以一种稍微复杂的方式进行此操作...但是要保持您的范式，您需要呈现*navigationController*，而不是包含的*viewController*：尝试这样做后一种方式将实例化 viewController，但此操作不会拉包含的 navController 连同它一起从情节提要中出来。您正在设置 viewController 的 title 属性，但是您没有（自动）方法来显示标题。然而，如果你实例化 navController，它包含的 viewController 确实会随着它的`topViewController`.

```
 //give the navigation controller a storyboard id eg "navVC"
    UINavigationController* modalNav = [self.storyboard instantiateViewControllerWithIdentifier:@"navVC"];
    [modalNav topViewController].title = @"Example Title";

        //[self presentModalViewController:modalNav animated:YES];
        //deprecated method, use this instead:
    [self presentViewController:modalNavController 
                       animated:YES
                    completion:nil]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-20T13:37:04.230

您必须使用经典的拖放方法在模型控制器中为 UINavigationItem（标题）添加 IBOutlet 属性。

```
@property (weak, nonatomic) IBOutlet UINavigationItem *navTitle; 
```

然后在 viewDidLoad 函数中设置标题。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    // title view
    [self.navTitle setTitle: @"atitle"];
} 
```

# php - 处理 ID 列表中的 URL

> ID：15733777
> 
> 赞同：0
> 
> 时间：2013-03-31T19:49:55.127
> 
> 标签：php, macos, curl

我希望访问一定数量的 URL 地址，其中一部分 URL 是固定的，而 URL 的另一部分是可变的。更具体地说，变量始终是查询字符串。

下面是 URL 格式的示例。这样做的原因是因为目标 URL 是一个基于整数执行任务的脚本 - 但我有大量的 'id' 值要通过。我在文本文件中准备好“id”值，一个值低于另一个值（因此，单独的行）。

> [http://www.example.com/thread.php?id=](http://www.example.com/thread.php?id=)

在我在这里发帖之前，我已经尝试过命令行、Apple Script 和 curl。

我的 curl 脚本如下。

```
<?php

$lines = file('input/threads.txt');

foreach($lines as $line)
{
    $ch=curl_init();
    curl_setopt($ch, CURLOPT_URL,'http://www.example.com/thread.php?id=' . $line . '');
    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30);
    curl_exec($ch);
    curl_close($ch);
    }
?> 
```

我想知道是否有更有效的方法来完成这项任务。我特别想知道任务的状态（'列表有多远......'）。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T20:00:24.420

您可以使用迭代索引作为流程指标：

```
$lines = file('input/threads.txt');
$lineCount = count($lines);

foreach ($lines as $index => $line) {
    echo 'fetching URL #' . ($index + 1) . ' of ' . $lineCount . "...\n";
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, 'http://www.example.com/thread.php?id=' . urlencode($line));
    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30);
    curl_exec($ch);
    curl_close($ch);
} 
```

# sql-server-ce - SQLCE 插入 sql 错误“无法修改列。[列名 = somefieldname]”

> ID：15733783
> 
> 赞同：0
> 
> 时间：2013-03-31T19:50:24.570
> 
> 标签：sql-server-ce

使用 SQLCE 数据库执行简单的插入命令时遇到错误。

SQL：

```
insert into accountgroups (AcGroupId, AcGroupParentID, AcGroupName, AcGroupAlias, AcNatureID, AcBaseNatureID) values ('1', '0', 'Current Assets', '', '4', '1') 
```

错误：

```
{"The column cannot be modified. [ Column name = AcGroupId ]"} 
```

我尝试在 VS2010 Studio SQL 编辑器中执行相同的命令。并得到这个错误

```
 Error Code: 80004005
 Message   : The column cannot be modified. [ Column name = AcGroupId ]
 Minor Err.: 25004
 Source    : SQL Server Compact ADO.NET Data Provider
 Err. Par. : AcGroupId 
```

上面的命令在 MySQL 数据库上运行良好。

请让我知道我做错了什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-14T17:51:44.370

您可以这样插入 ID 列：

```
SET IDENTITY_INSERT accountgroups ON
insert into accountgroups (AcGroupId, AcGroupParentID, AcGroupName, AcGroupAlias, AcNatureID, AcBaseNatureID) values ('1', '0', 'Current Assets', '', '4', '1')
SET IDENTITY_INSERT accountgroups OFF 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T20:48:45.687

`AcGroupId`似乎是一个 ID 列，这些列通常设置为自动增量，因此无法手动设置。如果您删除查询的第一列和第一个值，它可能会起作用。

# sql - 在 SQL 中根据序列对值进行分组

> ID：15733796
> 
> 赞同：0
> 
> 时间：2013-03-31T19:51:19.240
> 
> 标签：sql, select, group-by, sequence

有没有办法只使用 select 语句创建一个表，该表在一列中包含重复值的范围，如本例所示？

例子：

从输入表：

```
id value:
1 25
2 25
3 24
4 25
5 25
6 25
7 28
8 28
9 11 
```

应该导致：

```
range value
1-2 25
3-3 24
4-6 25
7-8 28
9-9 11 
```

注意：输入表中的 id 值始终是有序的，并且按 id 排序的 2 个值之间的差值始终等于 1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T19:53:33.630

您想查找连续值的序列。这是一种使用窗口函数的方法：

```
select min(id), max(id), value
from (select id, value,
             row_number() over (order by id) as rownum,
             row_number() over (partition by value order by id) as seqnum
      from t
     ) t
group by (rownum - seqnum), value; 
```

这考虑到一个值可能出现在行之间的不同位置。这个想法很简单。 `rownum`是一个序号。 `seqnum`是一个序号，对于给定值递增。对于连续的值，它们之间的差异是恒定的。

让我补充一下，如果您真的希望表达式为“1-2”，我们需要更多信息。假设 id 是一个字符串，根据数据库，以下方法之一将起作用：

```
select min(id)+'-'+max(id), . . .
select concat(min(id), '-', max(id)), . . .
select min(id)||'-'||max(id), . . . 
```

如果 id 是一个整数（我怀疑），那么您需要将`id`上述表达式中的 s替换为`cast(id as varchar(32))`，但在 Oracle 中，您将使用`cast(id as varchar2(32))`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T19:53:24.660

```
SELECT CONCAT(MIN(id), '-', MAX(id)) AS id_range, value
  FROM input_table
 GROUP BY value 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T19:53:54.847

也许是这样：

```
SELECT MIN(ID), MAX(ID), VALUE FROM TABLE GROUP BY VALUE 
```

# boost - boost asio HTTP Server 3 示例或 boost 错误中是否存在错误？

> ID：15733799
> 
> 赞同：2
> 
> 时间：2013-03-31T19:51:22.633
> 
> 标签：boost, boost-asio, valgrind, boost-thread

boost 库版本 1.53
Debian Linux 6.0 ( Linux 2.6.32-5-amd64 on x86_64 )

当 valgrind 日志包含大量警告时，很难测试自己的软件。
因此，我在没有任何更改的情况下构建了 HTTP server3 示例并在 Valgrind 下运行它。
请看一看。我错过了什么？

valgrind --tool=helgrind --log-file=valgrind.log ./server3 0.0.0.0 83 5 /root/server3
这是 Helgrind 日志（编辑为 30000 个正文字符限制，完整日志[http://pastebin.com/ Vkbr9vsA](http://pastebin.com/Vkbr9vsA)）：

```
Helgrind, a thread error detector
Copyright (C) 2007-2012, and GNU GPL'd, by OpenWorks LLP et al.
Using Valgrind-3.9.0.SVN and LibVEX; rerun with -h for copyright info
Command: ./server3 0.0.0.0 83 5 /root/server3
Parent PID: 8662

Lock at 0x524F5E0 was first observed
   at 0x4C2C692: pthread_mutex_lock (hg_intercepts.c:495)
   by 0x5043388: ??? (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x5043498: boost::detail::set_current_thread_data(boost::detail::thread_data_base*) (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x504380E: ??? (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x4C2D6FE: mythread_wrapper (hg_intercepts.c:219)
   by 0x5256B4F: start_thread (pthread_create.c:304)
   by 0x5CE5A7C: clone (clone.S:112)

Possible data race during read of size 8 at 0x524F4E8 by thread #3
Locks held: none
   at 0x5043356: ??? (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x5043498: boost::detail::set_current_thread_data(boost::detail::thread_data_base*) (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x504380E: ??? (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x4C2D6FE: mythread_wrapper (hg_intercepts.c:219)
   by 0x5256B4F: start_thread (pthread_create.c:304)
   by 0x5CE5A7C: clone (clone.S:112)

This conflicts with a previous write of size 8 by thread #2
Locks held: 1, at address 0x524F5E0
   at 0x5043416: ??? (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x5043498: boost::detail::set_current_thread_data(boost::detail::thread_data_base*) (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x504380E: ??? (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x4C2D6FE: mythread_wrapper (hg_intercepts.c:219)
   by 0x5256B4F: start_thread (pthread_create.c:304)
   by 0x5CE5A7C: clone (clone.S:112)

----------------------------------------------------------------

Possible data race during read of size 4 at 0x524F60C by thread #3
Locks held: none
   at 0x50496D4: boost::detail::get_once_per_thread_epoch() (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x5043361: ??? (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x5043498: boost::detail::set_current_thread_data(boost::detail::thread_data_base*) (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x504380E: ??? (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x4C2D6FE: mythread_wrapper (hg_intercepts.c:219)
   by 0x5256B4F: start_thread (pthread_create.c:304)
   by 0x5CE5A7C: clone (clone.S:112)

This conflicts with a previous write of size 4 by thread #2
Locks held: none
   at 0x525C27B: pthread_key_create (pthread_key_create.c:44)
   by 0x525C82F: pthread_once (pthread_once.S:104)
   by 0x50496D3: boost::detail::get_once_per_thread_epoch() (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x5043361: ??? (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x5043498: boost::detail::set_current_thread_data(boost::detail::thread_data_base*) (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x504380E: ??? (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x4C2D6FE: mythread_wrapper (hg_intercepts.c:219)
   by 0x5256B4F: start_thread (pthread_create.c:304)

----------------------------------------------------------------

Possible data race during read of size 8 at 0x524F4E8 by thread #1
Locks held: 1, at address 0x61A1E20
   at 0x5043356: ??? (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x5043478: boost::detail::get_current_thread_data() (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x5047875: boost::detail::interruption_checker::interruption_checker(pthread_mutex_t*, pthread_cond_t*) (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x5044002: boost::thread::join_noexcept() (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x42660E: boost::thread::join() (thread.hpp:751)
   by 0x4215C5: http::server3::server::run() (server.cpp:63)
   by 0x41A65B: main (main.cpp:37)

----------------------------------------------------------------

Possible data race during read of size 4 at 0x524F60C by thread #1
Locks held: 1, at address 0x61A1E20
   at 0x50496D4: boost::detail::get_once_per_thread_epoch() (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x5043361: ??? (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x5043478: boost::detail::get_current_thread_data() (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x5047875: boost::detail::interruption_checker::interruption_checker(pthread_mutex_t*, pthread_cond_t*) (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x5044002: boost::thread::join_noexcept() (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x42660E: boost::thread::join() (thread.hpp:751)
   by 0x4215C5: http::server3::server::run() (server.cpp:63)
   by 0x41A65B: main (main.cpp:37)

This conflicts with a previous write of size 4 by thread #2
Locks held: none
   at 0x525C27B: pthread_key_create (pthread_key_create.c:44)
   by 0x525C82F: pthread_once (pthread_once.S:104)
   by 0x50496D3: boost::detail::get_once_per_thread_epoch() (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x5043361: ??? (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x5043498: boost::detail::set_current_thread_data(boost::detail::thread_data_base*) (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x504380E: ??? (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x4C2D6FE: mythread_wrapper (hg_intercepts.c:219)
   by 0x5256B4F: start_thread (pthread_create.c:304)

----------------------------------------------------------------

Possible data race during write of size 4 at 0x61A36B8 by thread #6
Locks held: none
   at 0x4223B0: boost::asio::detail::epoll_reactor::descriptor_state::set_ready_events(unsigned int) (epoll_reactor.hpp:68)
   by 0x4228A5: boost::asio::detail::epoll_reactor::run(bool, boost::asio::detail::op_queue<boost::asio::detail::task_io_service_operation>&) (epoll_reactor.ipp:430)
   by 0x423629: boost::asio::detail::task_io_service::do_run_one(boost::asio::detail::scoped_lock<boost::asio::detail::posix_mutex>&, boost::asio::detail::task_io_service_thread_info&, boost::system::error_code const&) (task_io_service.ipp:396)
   by 0x423302: boost::asio::detail::task_io_service::run(boost::system::error_code&) (task_io_service.ipp:153)
   by 0x42393A: boost::asio::io_service::run() (io_service.ipp:59)
   by 0x42EB34: boost::_mfi::mf0<unsigned long, boost::asio::io_service>::operator()(boost::asio::io_service*) const (mem_fn_template.hpp:49)
   by 0x42EA72: unsigned long boost::_bi::list1<boost::_bi::value<boost::asio::io_service*> >::operator()<unsigned long, boost::_mfi::mf0<unsigned long, boost::asio::io_service>, boost::_bi::list0>(boost::_bi::type<unsigned long>, boost::_mfi::mf0<unsigned long, boost::asio::io_service>&, boost::_bi::list0&, long) (bind.hpp:243)
   by 0x42E91E: boost::_bi::bind_t<unsigned long, boost::_mfi::mf0<unsigned long, boost::asio::io_service>, boost::_bi::list1<boost::_bi::value<boost::asio::io_service*> > >::operator()() (bind_template.hpp:20)
   by 0x42E65D: boost::detail::thread_data<boost::_bi::bind_t<unsigned long, boost::_mfi::mf0<unsigned long, boost::asio::io_service>, boost::_bi::list1<boost::_bi::value<boost::asio::io_service*> > > >::run() (thread.hpp:117)
   by 0x5043818: ??? (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x4C2D6FE: mythread_wrapper (hg_intercepts.c:219)
   by 0x5256B4F: start_thread (pthread_create.c:304)

Address 0x61A36B8 is 24 bytes inside a block of size 160 alloc'd
   at 0x4C28A3A: operator new(unsigned long) (vg_replace_malloc.c:298)
   by 0x42806A: boost::asio::detail::epoll_reactor::descriptor_state* boost::asio::detail::object_pool_access::create<boost::asio::detail::epoll_reactor::descriptor_state>() (object_pool.hpp:35)
   by 0x4267B8: boost::asio::detail::object_pool<boost::asio::detail::epoll_reactor::descriptor_state>::alloc() (object_pool.hpp:89)
   by 0x4229E3: boost::asio::detail::epoll_reactor::allocate_descriptor_state() (epoll_reactor.ipp:512)
   by 0x4223D4: boost::asio::detail::epoll_reactor::register_descriptor(int, boost::asio::detail::epoll_reactor::descriptor_state*&) (epoll_reactor.ipp:151)
   by 0x424405: boost::asio::detail::reactive_socket_service_base::do_assign(boost::asio::detail::reactive_socket_service_base::base_implementation_type&, int, int const&, boost::system::error_code&) (reactive_socket_service_base.ipp:182)
   by 0x42DA98: boost::asio::detail::reactive_socket_service<boost::asio::ip::tcp>::assign(boost::asio::detail::reactive_socket_service<boost::asio::ip::tcp>::implementation_type&, boost::asio::ip::tcp const&, int const&, boost::system::error_code&) (reactive_socket_service.hpp:117)
   by 0x42D75C: boost::asio::stream_socket_service<boost::asio::ip::tcp>::assign(boost::asio::detail::reactive_socket_service<boost::asio::ip::tcp>::implementation_type&, boost::asio::ip::tcp const&, int const&, boost::system::error_code&) (stream_socket_service.hpp:138)
   by 0x42D263: boost::asio::basic_socket<boost::asio::ip::tcp, boost::asio::stream_socket_service<boost::asio::ip::tcp> >::assign(boost::asio::ip::tcp const&, int const&, boost::system::error_code&) (basic_socket.hpp:285)
   by 0x42CAD7: boost::asio::detail::reactive_socket_accept_op_base<boost::asio::basic_socket<boost::asio::ip::tcp, boost::asio::stream_socket_service<boost::asio::ip::tcp> >, boost::asio::ip::tcp>::do_perform(boost::asio::detail::reactor_op*) (reactive_socket_accept_op.hpp:66)
   by 0x409DE0: boost::asio::detail::reactor_op::perform() (reactor_op.hpp:40)
   by 0x422C2F: boost::asio::detail::epoll_reactor::descriptor_state::perform_io(unsigned int) (epoll_reactor.ipp:622)

----------------------------------------------------------------

Possible data race during write of size 8 at 0x61A36A8 by thread #6
Locks held: none
   at 0x410E9E: void boost::asio::detail::op_queue_access::next<boost::asio::detail::task_io_service_operation, boost::asio::detail::task_io_service_operation>(boost::asio::detail::task_io_service_operation*&, boost::asio::detail::task_io_service_operation*) (op_queue.hpp:41)
   by 0x40EBEE: boost::asio::detail::op_queue<boost::asio::detail::task_io_service_operation>::push(boost::asio::detail::task_io_service_operation*) (op_queue.hpp:107)
   by 0x4228BB: boost::asio::detail::epoll_reactor::run(bool, boost::asio::detail::op_queue<boost::asio::detail::task_io_service_operation>&) (epoll_reactor.ipp:431)
   by 0x423629: boost::asio::detail::task_io_service::do_run_one(boost::asio::detail::scoped_lock<boost::asio::detail::posix_mutex>&, boost::asio::detail::task_io_service_thread_info&, boost::system::error_code const&) (task_io_service.ipp:396)
   by 0x423302: boost::asio::detail::task_io_service::run(boost::system::error_code&) (task_io_service.ipp:153)
   by 0x42393A: boost::asio::io_service::run() (io_service.ipp:59)
   by 0x42EB34: boost::_mfi::mf0<unsigned long, boost::asio::io_service>::operator()(boost::asio::io_service*) const (mem_fn_template.hpp:49)
   by 0x42EA72: unsigned long boost::_bi::list1<boost::_bi::value<boost::asio::io_service*> >::operator()<unsigned long, boost::_mfi::mf0<unsigned long, boost::asio::io_service>, boost::_bi::list0>(boost::_bi::type<unsigned long>, boost::_mfi::mf0<unsigned long, boost::asio::io_service>&, boost::_bi::list0&, long) (bind.hpp:243)
   by 0x42E91E: boost::_bi::bind_t<unsigned long, boost::_mfi::mf0<unsigned long, boost::asio::io_service>, boost::_bi::list1<boost::_bi::value<boost::asio::io_service*> > >::operator()() (bind_template.hpp:20)
   by 0x42E65D: boost::detail::thread_data<boost::_bi::bind_t<unsigned long, boost::_mfi::mf0<unsigned long, boost::asio::io_service>, boost::_bi::list1<boost::_bi::value<boost::asio::io_service*> > > >::run() (thread.hpp:117)
   by 0x5043818: ??? (in /usr/lib/libboost_thread.so.1.53.0)
   by 0x4C2D6FE: mythread_wrapper (hg_intercepts.c:219)

Address 0x61A36A8 is 8 bytes inside a block of size 160 alloc'd
   at 0x4C28A3A: operator new(unsigned long) (vg_replace_malloc.c:298)
   by 0x42806A: boost::asio::detail::epoll_reactor::descriptor_state* boost::asio::detail::object_pool_access::create<boost::asio::detail::epoll_reactor::descriptor_state>() (object_pool.hpp:35)
   by 0x4267B8: boost::asio::detail::object_pool<boost::asio::detail::epoll_reactor::descriptor_state>::alloc() (object_pool.hpp:89)
   by 0x4229E3: boost::asio::detail::epoll_reactor::allocate_descriptor_state() (epoll_reactor.ipp:512)
   by 0x4223D4: boost::asio::detail::epoll_reactor::register_descriptor(int, boost::asio::detail::epoll_reactor::descriptor_state*&) (epoll_reactor.ipp:151)
   by 0x424405: boost::asio::detail::reactive_socket_service_base::do_assign(boost::asio::detail::reactive_socket_service_base::base_implementation_type&, int, int const&, boost::system::error_code&) (reactive_socket_service_base.ipp:182)
   by 0x42DA98: boost::asio::detail::reactive_socket_service<boost::asio::ip::tcp>::assign(boost::asio::detail::reactive_socket_service<boost::asio::ip::tcp>::implementation_type&, boost::asio::ip::tcp const&, int const&, boost::system::error_code&) (reactive_socket_service.hpp:117)
   by 0x42D75C: boost::asio::stream_socket_service<boost::asio::ip::tcp>::assign(boost::asio::detail::reactive_socket_service<boost::asio::ip::tcp>::implementation_type&, boost::asio::ip::tcp const&, int const&, boost::system::error_code&) (stream_socket_service.hpp:138)
   by 0x42D263: boost::asio::basic_socket<boost::asio::ip::tcp, boost::asio::stream_socket_service<boost::asio::ip::tcp> >::assign(boost::asio::ip::tcp const&, int const&, boost::system::error_code&) (basic_socket.hpp:285)
   by 0x42CAD7: boost::asio::detail::reactive_socket_accept_op_base<boost::asio::basic_socket<boost::asio::ip::tcp, boost::asio::stream_socket_service<boost::asio::ip::tcp> >, boost::asio::ip::tcp>::do_perform(boost::asio::detail::reactor_op*) (reactive_socket_accept_op.hpp:66)
   by 0x409DE0: boost::asio::detail::reactor_op::perform() (reactor_op.hpp:40)
   by 0x422C2F: boost::asio::detail::epoll_reactor::descriptor_state::perform_io(unsigned int) (epoll_reactor.ipp:622)

----------------------------------------------------------------

Thread #2: lock order "0x64C720 before 0x619E550" violated

Observed (incorrect) order is: acquisition of lock at 0x619E550
   at 0x4C2C692: pthread_mutex_lock (hg_intercepts.c:495)
   by 0x408545: boost::asio::detail::posix_mutex::lock() (posix_mutex.hpp:52)
   by 0x40D9E1: boost::asio::detail::scoped_lock<boost::asio::detail::posix_mutex>::scoped_lock(boost::asio::detail::posix_mutex&) (scoped_lock.hpp:36)
   by 0x422BD3: boost::asio::detail::epoll_reactor::descriptor_state::perform_io(unsigned int) (epoll_reactor.ipp:611)
   by 0x422D38: boost::asio::detail::epoll_reactor::descriptor_state::do_complete(boost::asio::detail::task_io_service*, boost::asio::detail::task_io_service_operation*, boost::system::error_code const&, unsigned long) (epoll_reactor.ipp:648)
   by 0x409C69: boost::asio::detail::task_io_service_operation::complete(boost::asio::detail::task_io_service&, boost::system::error_code const&, unsigned long) (task_io_service_operation.hpp:37)
   by 0x4236AD: boost::asio::detail::task_io_service::do_run_one(boost::asio::detail::scoped_lock<boost::asio::detail::posix_mutex>&, boost::asio::detail::task_io_service_thread_info&, boost::system::error_code const&) (task_io_service.ipp:412)
   by 0x423302: boost::asio::detail::task_io_service::run(boost::system::error_code&) (task_io_service.ipp:153)
   by 0x42393A: boost::asio::io_service::run() (io_service.ipp:59)
   by 0x42EB34: boost::_mfi::mf0<unsigned long, boost::asio::io_service>::operator()(boost::asio::io_service*) const (mem_fn_template.hpp:49)
   by 0x42EA72: unsigned long boost::_bi::list1<boost::_bi::value<boost::asio::io_service*> >::operator()<unsigned long, boost::_mfi::mf0<unsigned long, boost::asio::io_service>, boost::_bi::list0>(boost::_bi::type<unsigned long>, boost::_mfi::mf0<unsigned long, boost::asio::io_service>&, boost::_bi::list0&, long) (bind.hpp:243)
   by 0x42E91E: boost::_bi::bind_t<unsigned long, boost::_mfi::mf0<unsigned long, boost::asio::io_service>, boost::_bi::list1<boost::_bi::value<boost::asio::io_service*> > >::operator()() (bind_template.hpp:20)

 followed by a later acquisition of lock at 0x64C720
   at 0x4C2C692: pthread_mutex_lock (hg_intercepts.c:495)
   by 0x408845: boost::asio::detail::posix_static_mutex::lock() (posix_static_mutex.hpp:44)
   by 0x40E523: boost::asio::detail::scoped_lock<boost::asio::detail::posix_static_mutex>::scoped_lock(boost::asio::detail::posix_static_mutex&) (scoped_lock.hpp:36)
   by 0x424EE7: boost::asio::detail::signal_set_service::deliver_signal(int) (signal_set_service.ipp:431)
   by 0x42477C: boost::asio::detail::signal_set_service::pipe_read_op::do_perform(boost::asio::detail::reactor_op*) (signal_set_service.ipp:95)
   by 0x409DE0: boost::asio::detail::reactor_op::perform() (reactor_op.hpp:40)
   by 0x422C2F: boost::asio::detail::epoll_reactor::descriptor_state::perform_io(unsigned int) (epoll_reactor.ipp:622)
   by 0x422D38: boost::asio::detail::epoll_reactor::descriptor_state::do_complete(boost::asio::detail::task_io_service*, boost::asio::detail::task_io_service_operation*, boost::system::error_code const&, unsigned long) (epoll_reactor.ipp:648)
   by 0x409C69: boost::asio::detail::task_io_service_operation::complete(boost::asio::detail::task_io_service&, boost::system::error_code const&, unsigned long) (task_io_service_operation.hpp:37)
   by 0x4236AD: boost::asio::detail::task_io_service::do_run_one(boost::asio::detail::scoped_lock<boost::asio::detail::posix_mutex>&, boost::asio::detail::task_io_service_thread_info&, boost::system::error_code const&) (task_io_service.ipp:412)
   by 0x423302: boost::asio::detail::task_io_service::run(boost::system::error_code&) (task_io_service.ipp:153)
   by 0x42393A: boost::asio::io_service::run() (io_service.ipp:59)

Required order was established by acquisition of lock at 0x64C720
   at 0x4C2C692: pthread_mutex_lock (hg_intercepts.c:495)
   by 0x408845: boost::asio::detail::posix_static_mutex::lock() (posix_static_mutex.hpp:44)
   by 0x40E523: boost::asio::detail::scoped_lock<boost::asio::detail::posix_static_mutex>::scoped_lock(boost::asio::detail::posix_static_mutex&) (scoped_lock.hpp:36)
   by 0x425060: boost::asio::detail::signal_set_service::add_service(boost::asio::detail::signal_set_service*) (signal_set_service.ipp:467)
   by 0x4248BB: boost::asio::detail::signal_set_service::signal_set_service(boost::asio::io_service&) (signal_set_service.ipp:128)
   by 0x42558B: boost::asio::signal_set_service::signal_set_service(boost::asio::io_service&) (signal_set_service.hpp:53)
   by 0x42B628: boost::asio::io_service::service* boost::asio::detail::service_registry::create<boost::asio::signal_set_service>(boost::asio::io_service&) (service_registry.hpp:81)
   by 0x408742: boost::asio::detail::service_registry::do_use_service(boost::asio::io_service::service::key const&, boost::asio::io_service::service* (*)(boost::asio::io_service&)) (service_registry.ipp:123)
   by 0x42A92F: boost::asio::signal_set_service& boost::asio::detail::service_registry::use_service<boost::asio::signal_set_service>() (service_registry.hpp:48)
   by 0x42984A: boost::asio::signal_set_service& boost::asio::use_service<boost::asio::signal_set_service>(boost::asio::io_service&) (io_service.hpp:33)
   by 0x428633: boost::asio::basic_io_object<boost::asio::signal_set_service, false>::basic_io_object(boost::asio::io_service&) (basic_io_object.hpp:90)
   by 0x42753A: boost::asio::basic_signal_set<boost::asio::signal_set_service>::basic_signal_set(boost::asio::io_service&) (basic_signal_set.hpp:106)

 followed by a later acquisition of lock at 0x619E550
   at 0x4C2C692: pthread_mutex_lock (hg_intercepts.c:495)
   by 0x408545: boost::asio::detail::posix_mutex::lock() (posix_mutex.hpp:52)
   by 0x40D9E1: boost::asio::detail::scoped_lock<boost::asio::detail::posix_mutex>::scoped_lock(boost::asio::detail::posix_mutex&) (scoped_lock.hpp:36)
   by 0x4224E4: boost::asio::detail::epoll_reactor::register_internal_descriptor(int, int, boost::asio::detail::epoll_reactor::descriptor_state*&, boost::asio::detail::reactor_op*) (epoll_reactor.ipp:179)
   by 0x4250FC: boost::asio::detail::signal_set_service::add_service(boost::asio::detail::signal_set_service*) (signal_set_service.ipp:485)
   by 0x4248BB: boost::asio::detail::signal_set_service::signal_set_service(boost::asio::io_service&) (signal_set_service.ipp:128)
   by 0x42558B: boost::asio::signal_set_service::signal_set_service(boost::asio::io_service&) (signal_set_service.hpp:53)
   by 0x42B628: boost::asio::io_service::service* boost::asio::detail::service_registry::create<boost::asio::signal_set_service>(boost::asio::io_service&) (service_registry.hpp:81)
   by 0x408742: boost::asio::detail::service_registry::do_use_service(boost::asio::io_service::service::key const&, boost::asio::io_service::service* (*)(boost::asio::io_service&)) (service_registry.ipp:123)
   by 0x42A92F: boost::asio::signal_set_service& boost::asio::detail::service_registry::use_service<boost::asio::signal_set_service>() (service_registry.hpp:48)
   by 0x42984A: boost::asio::signal_set_service& boost::asio::use_service<boost::asio::signal_set_service>(boost::asio::io_service&) (io_service.hpp:33)
   by 0x428633: boost::asio::basic_io_object<boost::asio::signal_set_service, false>::basic_io_object(boost::asio::io_service&) (basic_io_object.hpp:90)

----------------------------------------------------------------

Thread #1: lock order "0x619E550 before 0x64C720" violated

Observed (incorrect) order is: acquisition of lock at 0x64C720
   at 0x4C2C692: pthread_mutex_lock (hg_intercepts.c:495)
   by 0x408845: boost::asio::detail::posix_static_mutex::lock() (posix_static_mutex.hpp:44)
   by 0x40E523: boost::asio::detail::scoped_lock<boost::asio::detail::posix_static_mutex>::scoped_lock(boost::asio::detail::posix_static_mutex&) (scoped_lock.hpp:36)
   by 0x425166: boost::asio::detail::signal_set_service::remove_service(boost::asio::detail::signal_set_service*) (signal_set_service.ipp:492)
   by 0x4248F0: boost::asio::detail::signal_set_service::shutdown_service() (signal_set_service.ipp:138)
   by 0x42564D: boost::asio::signal_set_service::shutdown_service() (signal_set_service.hpp:110)
   by 0x41AA69: boost::asio::detail::service_registry::~service_registry() (service_registry.ipp:37)
   by 0x41AB32: boost::asio::io_service::~io_service() (io_service.ipp:53)
   by 0x41B178: http::server3::server::~server() (in /root/server3/server3)
   by 0x41A66A: main (main.cpp:37)

 followed by a later acquisition of lock at 0x619E550
   at 0x4C2C692: pthread_mutex_lock (hg_intercepts.c:495)
   by 0x408545: boost::asio::detail::posix_mutex::lock() (posix_mutex.hpp:52)
   by 0x40D9E1: boost::asio::detail::scoped_lock<boost::asio::detail::posix_mutex>::scoped_lock(boost::asio::detail::posix_mutex&) (scoped_lock.hpp:36)
   by 0x40AC3A: boost::asio::detail::epoll_reactor::deregister_descriptor(int, boost::asio::detail::epoll_reactor::descriptor_state*&, bool) (epoll_reactor.ipp:307)
   by 0x4251BC: boost::asio::detail::signal_set_service::remove_service(boost::asio::detail::signal_set_service*) (signal_set_service.ipp:499)
   by 0x4248F0: boost::asio::detail::signal_set_service::shutdown_service() (signal_set_service.ipp:138)
   by 0x42564D: boost::asio::signal_set_service::shutdown_service() (signal_set_service.hpp:110)
   by 0x41AA69: boost::asio::detail::service_registry::~service_registry() (service_registry.ipp:37)
   by 0x41AB32: boost::asio::io_service::~io_service() (io_service.ipp:53)
   by 0x41B178: http::server3::server::~server() (in /root/server3/server3)
   by 0x41A66A: main (main.cpp:37)

Required order was established by acquisition of lock at 0x619E550
   at 0x4C2C692: pthread_mutex_lock (hg_intercepts.c:495)
   by 0x408545: boost::asio::detail::posix_mutex::lock() (posix_mutex.hpp:52)
   by 0x40D9E1: boost::asio::detail::scoped_lock<boost::asio::detail::posix_mutex>::scoped_lock(boost::asio::detail::posix_mutex&) (scoped_lock.hpp:36)
   by 0x422BD3: boost::asio::detail::epoll_reactor::descriptor_state::perform_io(unsigned int) (epoll_reactor.ipp:611)
   by 0x422D38: boost::asio::detail::epoll_reactor::descriptor_state::do_complete(boost::asio::detail::task_io_service*, boost::asio::detail::task_io_service_operation*, boost::system::error_code const&, unsigned long) (epoll_reactor.ipp:648)
   by 0x409C69: boost::asio::detail::task_io_service_operation::complete(boost::asio::detail::task_io_service&, boost::system::error_code const&, unsigned long) (task_io_service_operation.hpp:37)
   by 0x4236AD: boost::asio::detail::task_io_service::do_run_one(boost::asio::detail::scoped_lock<boost::asio::detail::posix_mutex>&, boost::asio::detail::task_io_service_thread_info&, boost::system::error_code const&) (task_io_service.ipp:412)
   by 0x423302: boost::asio::detail::task_io_service::run(boost::system::error_code&) (task_io_service.ipp:153)
   by 0x42393A: boost::asio::io_service::run() (io_service.ipp:59)
   by 0x42EB34: boost::_mfi::mf0<unsigned long, boost::asio::io_service>::operator()(boost::asio::io_service*) const (mem_fn_template.hpp:49)
   by 0x42EA72: unsigned long boost::_bi::list1<boost::_bi::value<boost::asio::io_service*> >::operator()<unsigned long, boost::_mfi::mf0<unsigned long, boost::asio::io_service>, boost::_bi::list0>(boost::_bi::type<unsigned long>, boost::_mfi::mf0<unsigned long, boost::asio::io_service>&, boost::_bi::list0&, long) (bind.hpp:243)
   by 0x42E91E: boost::_bi::bind_t<unsigned long, boost::_mfi::mf0<unsigned long, boost::asio::io_service>, boost::_bi::list1<boost::_bi::value<boost::asio::io_service*> > >::operator()() (bind_template.hpp:20)

 followed by a later acquisition of lock at 0x64C720
   at 0x4C2C692: pthread_mutex_lock (hg_intercepts.c:495)
   by 0x408845: boost::asio::detail::posix_static_mutex::lock() (posix_static_mutex.hpp:44)
   by 0x40E523: boost::asio::detail::scoped_lock<boost::asio::detail::posix_static_mutex>::scoped_lock(boost::asio::detail::posix_static_mutex&) (scoped_lock.hpp:36)
   by 0x424EE7: boost::asio::detail::signal_set_service::deliver_signal(int) (signal_set_service.ipp:431)
   by 0x42477C: boost::asio::detail::signal_set_service::pipe_read_op::do_perform(boost::asio::detail::reactor_op*) (signal_set_service.ipp:95)
   by 0x409DE0: boost::asio::detail::reactor_op::perform() (reactor_op.hpp:40)
   by 0x422C2F: boost::asio::detail::epoll_reactor::descriptor_state::perform_io(unsigned int) (epoll_reactor.ipp:622)
   by 0x422D38: boost::asio::detail::epoll_reactor::descriptor_state::do_complete(boost::asio::detail::task_io_service*, boost::asio::detail::task_io_service_operation*, boost::system::error_code const&, unsigned long) (epoll_reactor.ipp:648)
   by 0x409C69: boost::asio::detail::task_io_service_operation::complete(boost::asio::detail::task_io_service&, boost::system::error_code const&, unsigned long) (task_io_service_operation.hpp:37)
   by 0x4236AD: boost::asio::detail::task_io_service::do_run_one(boost::asio::detail::scoped_lock<boost::asio::detail::posix_mutex>&, boost::asio::detail::task_io_service_thread_info&, boost::system::error_code const&) (task_io_service.ipp:412)
   by 0x423302: boost::asio::detail::task_io_service::run(boost::system::error_code&) (task_io_service.ipp:153)
   by 0x42393A: boost::asio::io_service::run() (io_service.ipp:59) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T19:22:20.417

[HTTP Server 3 示例](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/examples.html#boost_asio.examples.http_server_3)使用线程池。虽然 Valgrind 是一套非常有用的程序，但正确使用它需要一点技巧。正如 helgrind[文档所述](http://valgrind.org/docs/manual/hg-manual.html)，最好在项目的早期就开始使用 helgrind。根据我的经验，在 hlgrind 上抛出一个现有的多线程程序很可能会报告许多误报。例如，使用 posix 条件变量时 helgrind 不能总是检测到数据竞争，这句话来自我之前链接的 helgrind 文档

> 避免使用 POSIX 条件变量。如果可以，请使用 POSIX 信号量（sem_t、sem_post、sem_wait）进行线程间事件信号发送。初始值为零的信号量对此特别有用。

这可能是您引用的误报的原因。Asio 和 Thread 库都使用条件变量作为其实现的一部分。我非常怀疑可能的数据竞争或不正确的锁定顺序是由于任一库中的错误造成的。值得在这里引用[Jeff Atwood 的第一条编程规则](http://www.codinghorror.com/blog/2008/03/the-first-rule-of-programming-its-always-your-fault.html)

> 成为一个谦逊的程序员的一个重要部分是意识到，每当你编写的代码出现问题时，总是你的错。操作系统、编译器或第三方产品中可能存在错误——但这不应该是您的第一个想法。该错误更有可能存在于正在开发的应用程序代码中。

# android - Eclipse AVD 看不到连接的设备 - Win 8

> ID：15733804
> 
> 赞同：3
> 
> 时间：2013-03-31T19:51:49.153
> 
> 标签：android, eclipse

当我通过 USB 连接外部设备时，它不会出现在 ADVM 中

我之前在 32 位 Win 7 版本上使用 Eclipse 并且没有任何问题，当连接设备时它出现在 ADVM 中。

从那以后，我已经用 64 位 Win 8 干净地安装了机器，并从头开始安装了 Eclipse 和 SDK。

当我连接设备时，LogCat 会记录有关设备及其正在做什么的大量信息。但是当我打开 ADVM 时，设备不存在，所以我不能将它用作运行目标。

有任何想法吗？

（我是一个为我的孩子设备编写愚蠢的应用程序的涉猎者，而不是一个成熟的编码器）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T20:21:37.483

发生在我身上的是设备的*名称*没有显示，但是当它要求我选择时它仍然是第一个设备。当您必须选择从哪个启动时，请尝试单击“正在运行的设备”中的第一个列表项。如果您可以选择它（它将是一个空白项目），然后运行，它应该/可能会起作用。试试看，这正是发生在我身上的事情。我怀疑这可能只是因为您的 LogCat 似乎正在工作。

# apache-commons-fileupload - “导入 org.apache.commons.fileupload 无法解析”尽管添加了 lib 并没有消失

> ID：15733808
> 
> 赞同：2
> 
> 时间：2013-03-31T19:52:06.430
> 
> 标签：apache-commons-fileupload

当我尝试导入

```
import org.apache.commons.fileupload.FileItem;
import org.apache.commons.fileupload.FileItemFactory;
import org.apache.commons.fileupload.disk.DiskFileItemFactory;
import org.apache.commons.fileupload.servlet.ServletFileUpload; 
```

Eclipse 显示错误，

```
The import org.apache.commons.fileupload cannot be resolved 
```

我添加了这些库，但这个错误仍然没有消失。

```
commons-fileupload-1.3.jar
commons-fileupload-1.3-javadoc.jar
commons-fileupload-1.3-sources.jar
commons-fileupload-1.3-tests.jar
commons-fileupload-1.3-test-sources.jar 
```

我应该如何纠正这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T18:24:26.340

我必须在构建路径中添加这些库，之后它才能工作。Eclipse 不是自己做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-28T06:10:10.887

您必须在 2 个地方添加这些库。在 /WEB-INF/lib 文件夹中构建项目的路径

# eclipse - 使用 Eclipse 启动任务将展开的捆绑包部署到 Apache Felix

> ID：15733822
> 
> 赞同：1
> 
> 时间：2013-03-31T19:54:05.177
> 
> 标签：eclipse, osgi, apache-felix, gogo-shell

我正在寻找一种方法来从 Eclipse 中（重新）部署一个分解的捆绑包（意味着不是 jarred，而是在一个文件夹中）到一个正在运行的 Apache Felix OSGi 容器，最好使用启动任务。

我发现[了这个](https://stackoverflow.com/questions/5518388/is-there-a-way-to-deploy-exploded-bundles-in-apache-felix)问题，它有一个接近的答案，但它取决于在 Gogo shell 中输入命令，这不方便长期开发使用。我想为此使用 Eclipse 的启动任务机制，但如果有同样快速和方便的替代方案，我也愿意接受。

现在我认为，如果我可以从 Eclipse 启动任务中触发 Gogo shell 命令，那将是一个解决方案，但我也无法理解如何做到这一点。我想我需要 Remote Shell 捆绑包，对吗？

我开始考虑用 Java 编写一个 telnet 客户端，它可以连接到 Remote Shell 包并以自动方式执行 Gogo 命令。我已经看到[了一些](https://stackoverflow.com/questions/3480755/open-source-telnet-java-api) [示例](https://stackoverflow.com/questions/5988029/java-telnet-library/14098926#14098926)，我可以对其进行修改以满足我的需要……但是，我从中得到了一种“重新发明轮子”的感觉。肯定有更好的方法吗？

*一些背景可以帮助您了解我在做什么：*

我已经建立了一个 Eclipse 'OSGiContainer' 项目，它基本上包含 Apache Felix jar 和我想要部署的第三方包（如 Gogo shell），类似于[此处](http://felix.apache.org/site/integrating-felix-with-eclipse.html)描述的项目设置。然后我创建了第二个包含我的包的“MyBundle”项目。我想通过启动 OSGiContainer 项目来启动 OSGi 容器，然后在我的包上进行开发并通过将 MyBundle 项目启动到我只想在开发过程中一直运行的 OSGiContainer 中来测试我的更改。

项目布局：

*   OSGi容器
    *   bin（包含 felix jar）
    *   捆绑包（第三方捆绑包）
    *   conf（Felix 的 config.properties 文件）
*   我的捆绑
    *   源代码
    *   目标
        *   班级

然后我可以通过在 Gogo shell 上调用这些命令将我的包部署到 OSGi 容器：

```
install reference:file:../MyBundle/target/classes
start <bundleId> 
```

要重新部署，我调用这些命令：

```
stop <bundleId>
uninstall <bundleId>
install reference:file:../MyBundle/target/classes
start <bundleId> 
```

您可以想象每次必须在 shell 上调用 4 个命令并没有那么有趣……因此，即使您可以给我一种方法来将其归结为更少的命令来键入，这已经是一个很大的改进了。

**更新**

我修改了一下，想出了下面的课程。它是对 telnet 示例的改编，做了一些小改动，并提供了一个带有必要命令的 main 方法，用于卸载捆绑包，然后重新安装并启动它。捆绑包的路径应作为程序的参数给出，如下所示：

```
reference:file:../MyBundle/target/classes 
```

我仍然非常欢迎这个问题的答案，因为我根本不喜欢这个解决方案。然而，我已经证实这有效：

```
import java.io.IOException;
import java.io.InputStream;
import java.io.PrintStream;
import java.net.SocketException;
import java.util.concurrent.BlockingQueue;
import java.util.concurrent.CountDownLatch;
import java.util.concurrent.LinkedBlockingQueue;

import org.apache.commons.net.telnet.TelnetClient;

public class GogoDeployer {
    static class Responder extends Thread {
        private StringBuilder builder = new StringBuilder();
        private final GogoDeployer checker;
        private CountDownLatch latch;
        private String waitFor = null;
        private boolean isKeepRunning = true;

        Responder(GogoDeployer checker) {
            this.checker = checker;
        }

        boolean foundWaitFor(String waitFor) {
            return builder.toString().contains(waitFor);
        }

        public synchronized String getAndClearBuffer() {
            String result = builder.toString();
            builder = new StringBuilder();
            return result;
        }

        @Override
        public void run() {
            while (isKeepRunning) {
                String s;

                try {
                    s = checker.messageQueue.take();
                } catch (InterruptedException e) {
                    break;
                }

                synchronized (Responder.class) {
                    builder.append(s);
                }

                if (waitFor != null && latch != null && foundWaitFor(waitFor)) {
                    latch.countDown();
                }
            }
            System.out.println("Responder stopped.");
        }

        public String waitFor(String waitFor) {
            synchronized (Responder.class) {
                if (foundWaitFor(waitFor)) {
                    return getAndClearBuffer();
                }
            }

            this.waitFor = waitFor;
            latch = new CountDownLatch(1);
            try {
                latch.await();
            } catch (InterruptedException e) {
                e.printStackTrace();
                return null;
            }

            String result = null;
            synchronized (Responder.class) {
                result = builder.toString();
                builder = new StringBuilder();
            }

            return result;
        }
    }

    static class TelnetReader extends Thread {
        private boolean isKeepRunning = true;
        private final GogoDeployer checker;
        private final TelnetClient tc;

        TelnetReader(GogoDeployer checker, TelnetClient tc) {
            this.checker = checker;
            this.tc = tc;
        }

        @Override
        public void run() {
            InputStream instr = tc.getInputStream();

            try {
                byte[] buff = new byte[1024];
                int ret_read = 0;

                do {
                    if (instr.available() > 0) {
                        ret_read = instr.read(buff);
                    }
                    if (ret_read > 0) {
                        checker.sendForResponse(new String(buff, 0, ret_read));
                        ret_read = 0;
                    }
                } while (isKeepRunning && (ret_read >= 0));
            } catch (Exception e) {
                System.err.println("Exception while reading socket:" + e.getMessage());
            }

            try {
                tc.disconnect();
                checker.stop();
                System.out.println("Disconnected.");
            } catch (Exception e) {
                System.err.println("Exception while closing telnet:" + e.getMessage());
            }
        }
    }

    private static final String prompt = "g!";
    private static GogoDeployer client;

    private String host;
    private BlockingQueue<String> messageQueue = new LinkedBlockingQueue<String>();
    private int port;
    private TelnetReader reader;
    private Responder responder;
    private TelnetClient tc;

    public GogoDeployer(String host, int port) {
        this.host = host;
        this.port = port;
    }

    public void stop() {
        responder.isKeepRunning = false;
        reader.isKeepRunning = false;

        try {
            Thread.sleep(10);
        } catch (InterruptedException e) {
        }
        responder.interrupt();
        reader.interrupt();
    }

    public void send(String command) {
        PrintStream ps = new PrintStream(tc.getOutputStream());
        ps.println(command);
        ps.flush();
    }

    public void sendForResponse(String s) {
        messageQueue.add(s);
    }

    public void connect() throws SocketException, IOException {
        tc = new TelnetClient();
        tc.connect(host, port);
        reader = new TelnetReader(this, tc);
        reader.start();
        responder = new Responder(this);
        responder.start();
    }

    public String waitFor(String s) {
        return responder.waitFor(s);
    }

    private static String exec(String cmd) {
        String result = "";
        System.out.println(cmd);
        client.send(cmd);
        result = client.waitFor(prompt);
        return result;
    }

    public static void main(String[] args) {
        try {
            String project = args[0];
            client = new GogoDeployer("localhost", 6666);
            client.connect();
            System.out.println(client.waitFor(prompt));
            System.out.println(exec("uninstall " + project));
            String result = exec("install " + project);
            System.out.println(result);
            int start = result.indexOf(":");
            int stop = result.indexOf(prompt);
            String bundleId = result.substring(start + 1, stop).trim();
            System.out.println(exec("start " + bundleId));
            client.stop();
        } catch (SocketException e) {
            System.err.println("Unable to conect to Gogo remote shell: " + e.getMessage());
        } catch (IOException e) {
            System.err.println("Unable to conect to Gogo remote shell: " + e.getMessage());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T23:25:24.120

当我遇到相同的要求（尽可能快地从目标/类部署包）时，我的第一个想法也是用一些 shell 功能扩展我的容器。然而，我的第二个想法是编写一个简单的包，它打开一个始终在顶部的窗口，我可以简单地将任何项目从 Eclipse（或总指挥官或其他）拖放到该窗口。代码然后检查被删除的文件夹是否有一个目标/类文件夹，如果有，它将被部署。

源代码位于[https://github.com/everit-org/osgi-richconsole](https://github.com/everit-org/osgi-richconsole)

依赖项可从 maven-central 获得。

依赖是：

```
<dependency>
    <groupId>org.everit.osgi.dev</groupId>
    <artifactId>org.everit.osgi.dev.richconsole</artifactId>
    <version>1.2.0</version>
</dependency> 
```

您可以在开发时使用该捆绑包，并在设置实时服务器时将其删除。但是，如果容器在无头模式下运行，则没有必要不显示弹出窗口。

我称它为richconsole，因为我希望将来有更多功能（不仅仅是部署）:)

# ruby-on-rails - Capybara、Poltergeist 和 Phantomjs 并在正文中给出空洞的回应

> ID：15733827
> 
> 赞同：3
> 
> 时间：2013-03-31T19:54:35.367
> 
> 标签：ruby-on-rails, capybara, phantomjs, poltergeist

我从 phantomjs 得到一个空文档。我正在尝试使用 Capybara 和 Poltergeist 为 Capybara 设置 phantomjs 驱动程序。

我如下创建了一个模块，并将其包含在需要连接的文件中。

```
require 'capybara/poltergeist'

  module Parser
    module JSParser
      include Capybara

      # Create a new PhantomJS session in Capybara
      def new_session
        # Register PhantomJS (aka poltergeist) as the driver to use
        Capybara.register_driver :poltergeist do |app|
          Capybara::Poltergeist::Driver.new(app, :debug => true)
        end

        # Use XPath as the default selector for the find method
        Capybara.default_selector = :xpath
        Capybara.javascript_driver = :poltergeist
        Capybara.current_driver = :poltergeist
        # Start up a new thread
        @session = Capybara::Session.new(:poltergeist)

        # Report using a particular user agent
        @session.driver.headers = { 'User-Agent' => 'Mozilla/5.0 (Macintosh; Intel Mac OS X)' }

        # Return the driver's session
        @session
      end

      # Returns the current session's page
      def html
        @session.html
      end

    end
  end 
```

然后，加载页面如下：

```
class Loader
  include Parser::JSParser

  def load_page
    new_session
    visit "http://www.smashingmagazine.com"
    #let phantomjs take its time
    sleep 5
    puts "html=#{html}"  
  end
end 
```

然后，最后，调用 load_page

```
Loader.new.load_page 
```

这是来自 poltergeist 的调试响应

```
poltergeist [1364758785355] state default -> loading
{"response"=>true}
{"name"=>"visit", "args"=>["http://www.smashingmagazine.com"]}
poltergeist [1364758794574] state loading -> default
{"response"=>{"status"=>"success"}}
{"name"=>"body", "args"=>[]}
{"response"=>"<html><head></head><body></body></html>"} 
```

如您所见，响应只是一个空白文档，只有 html、head 和 body 标记，而 body 标记中没有任何内容。

我在做什么错？观察网络流量，我从主机（在这种情况下为 smashingmagazine.com）得到了完整的响应。在响应回来之后，我不知道发生了什么。有时 phantomjs 也会崩溃，而在其他情况下，它会通过空的身体。这是 phantomjs 崩溃时在 STDERR 上打印的最后一行

```
PhantomJS client died while processing {"name":"visit","args":["http://www.smashingmagazine.com"]} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-11-11T11:30:13.603

我也有类似的问题。但是下面的选项设置`:phantomjs_options`，帮助我解决了这个问题。

```
 Capybara.register_driver :poltergeist do |app|
    Capybara::Poltergeist::Driver.new(app,
                                      :phantomjs_options => ['--debug=no', '--load-images=no', '--ignore-ssl-errors=yes', '--ssl-protocol=TLSv1'], :debug => false)
  end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T11:53:31.647

访问此网站时，这听起来像是 PhantomJS 中的错误。我建议尝试*仅*使用PhantomJS（不是 Poltergeist 或 Capybara）加载网站，看看是否有效。如果它也有问题，请报告针对 PhantomJS 的错误。

您可以在此处阅读有关 PhantomJS 的信息：[https ://github.com/ariya/phantomjs/wiki/Quick-Start](https://github.com/ariya/phantomjs/wiki/Quick-Start)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T16:26:06.270

用这个来获取 html `puts "html=#{page.html}"`

# java - Java中两个矩阵相乘

> ID：15733829
> 
> 赞同：2
> 
> 时间：2013-03-31T19:55:19.043
> 
> 标签：java, arrays, matrix, multidimensional-array, multiplication

我目前正在开发一个表示矩阵的类，它表示任何通用的 mxn 矩阵。我已经计算出加法和标量乘法，但我正在努力开发两个矩阵的乘法。矩阵的数据保存在一个二维数组中。

该方法看起来有点像这样：

```
 public Matrix multiply(Matrix A) {
            ////code
   } 
```

它将返回产品矩阵。这是右边的乘法。所以，如果我调用 A.multiply(B) 那么它将返回矩阵 AB，B 在右边。

我还不需要担心检查是否在给定矩阵上定义了乘法，我可以假设我将得到正确维度的矩阵。

有谁知道一个简单的算法，甚至可能在伪代码中执行乘法过程？

提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-31T20:05:43.027

数学上，矩阵 A (lxm) 和 B (mxn) 的乘积定义为由以下元素组成的矩阵 C (lxn)：

```
 m
c_i_j = ∑  a_i_k * b_k_j
       k=1 
```

因此，如果您对速度不太感兴趣，您可能会对直接的 O(n^3) 实现感到满意：

```
 for (int i=0; i<l; ++i)
    for (int j=0; j<n; ++j)
      for (int k=0; k<m; ++k)
        c[i][j] += a[i][k] * b[k][j] 
```

相反，如果您想提高速度，则可能需要检查其他替代方案，例如 Strassen 算法（请参阅：Strassen 算法）。

尽管如此，请注意 - 特别是如果您在现代处理器架构上乘以小矩阵，速度在很大程度上取决于矩阵数据和乘法顺序的排列方式，以充分利用高速缓存行。

我强烈怀疑是否有机会通过使用虚拟机来影响这个因素，所以我不确定是否要考虑到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-22T21:27:19.907

**爪哇。矩阵乘法。**

这是“执行乘法过程的代码”。用不同大小的矩阵进行测试。

```
public class Matrix {

/**
 * Matrix multiplication method.
 * @param m1 Multiplicand
 * @param m2 Multiplier
 * @return Product
 */
    public static double[][] multiplyByMatrix(double[][] m1, double[][] m2) {
        int m1ColLength = m1[0].length; // m1 columns length
        int m2RowLength = m2.length;    // m2 rows length
        if(m1ColLength != m2RowLength) return null; // matrix multiplication is not possible
        int mRRowLength = m1.length;    // m result rows length
        int mRColLength = m2[0].length; // m result columns length
        double[][] mResult = new double[mRRowLength][mRColLength];
        for(int i = 0; i < mRRowLength; i++) {         // rows from m1
            for(int j = 0; j < mRColLength; j++) {     // columns from m2
                for(int k = 0; k < m1ColLength; k++) { // columns from m1
                    mResult[i][j] += m1[i][k] * m2[k][j];
                }
            }
        }
        return mResult;
    }

    public static String toString(double[][] m) {
        String result = "";
        for(int i = 0; i < m.length; i++) {
            for(int j = 0; j < m[i].length; j++) {
                result += String.format("%11.2f", m[i][j]);
            }
            result += "\n";
        }
        return result;
    }

    public static void main(String[] args) {
        // #1
        double[][] multiplicand = new double[][] {
                {3, -1, 2},
                {2,  0, 1},
                {1,  2, 1}
        };
        double[][] multiplier = new double[][] {
                {2, -1, 1},
                {0, -2, 3},
                {3,  0, 1}
        };
        System.out.println("#1\n" + toString(multiplyByMatrix(multiplicand, multiplier)));
        // #2
        multiplicand = new double[][] {
                {1, 2, 0},
                {-1, 3, 1},
                {2, -2, 1}
        };
        multiplier = new double[][] {
                {2},
                {-1},
                {1}
        };
        System.out.println("#2\n" + toString(multiplyByMatrix(multiplicand, multiplier)));
        // #3
        multiplicand = new double[][] {
                {1, 2, -1},
                {0,  1, 0}
        };
        multiplier = new double[][] {
                {1, 1, 0, 0},
                {0, 2, 1, 1},
                {1, 1, 2, 2}
        };
        System.out.println("#3\n" + toString(multiplyByMatrix(multiplicand, multiplier)));
    }
} 
```

**输出：**

```
#1
      12.00      -1.00       2.00
       7.00      -2.00       3.00
       5.00      -5.00       8.00

#2
       0.00
      -4.00
       7.00

#3
       0.00       4.00       0.00       0.00
       0.00       2.00       1.00       1.00 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-20T11:00:13.377

在这个答案中，我创建了一个名为 Matrix 的类，另一个名为 MatrixOperations 的类定义了可以对矩阵执行的各种操作（当然，行操作除外）。但我将从 MatrixOperations 中提取乘法代码。完整的项目可以在我的[GitHub](http://www.github.com)页面上[找到](https://github.com/Conrad6/matrixCalculator)。

下面是 Matrix 类的定义。

```
package app.matrix;

import app.matrix.util.MatrixException;

public class Matrix {

private double[][] entries;

public void setEntries(double[][] entries) {
    this.entries = entries;
}

private String name;

public double[][] getEntries() {
    return entries;
}

public String getName() {
    return name;
}

public void setName(String name) {
    this.name = name;
}

public class Dimension {
    private int rows;
    private int columns;

    public int getRows() {
        return rows;
    }

    public void setRows(int rows) {
        this.rows = rows;
    }

    public int getColumns() {
        return columns;
    }

    public void setColumns(int columns) {
        this.columns = columns;
    }

    public Dimension(int rows, int columns) {
        this.setRows(rows);
        this.setColumns(columns);
    }

    @Override
    public boolean equals(Object obj) {
        if(obj instanceof Dimension){
            return (this.getColumns() == ((Dimension) obj).getColumns()) && (this.getRows() == ((Dimension) obj).getRows());
        }
        return false;
    }
}

private Dimension dimension;

public Dimension getDimension() {
    return dimension;
}

public void setDimension(Dimension dimension) {
    this.dimension = dimension;
}

public Matrix(int dimension, String name) throws MatrixException {
    if (dimension == 0) throw new MatrixException(ZERO_UNIT_DIMENSION);
    else this.setEntries(new double[Math.abs(dimension)][Math.abs(dimension)]);
    this.setDimension(new Dimension(dimension, dimension));
    this.setName(name);
}

public Matrix(int dimensionH, int dimensionV, String name) throws MatrixException {
    if (dimensionH == 0 || dimensionV == 0) throw new MatrixException(ZERO_UNIT_DIMENSION);
    else this.setEntries(new double[Math.abs(dimensionH)][Math.abs(dimensionV)]);
    this.setDimension(new Dimension(dimensionH, dimensionV));
    this.setName(name);

}

private static final String OVERFLOW_ITEMS_MSG = "The values are too many for the matrix's specified dimensions";
private static final String ZERO_UNIT_DIMENSION = "Zero cannot be a value for a dimension";

public Matrix(int dimensionH, int dimensionV, String name, double... values) throws MatrixException {
    if (dimensionH == 0 || dimensionV == 0) throw new MatrixException(ZERO_UNIT_DIMENSION);
    else if (values.length > dimensionH * dimensionV) throw new MatrixException(Matrix.OVERFLOW_ITEMS_MSG);
    else this.setEntries(new double[Math.abs(dimensionH)][Math.abs(dimensionV)]);
    this.setDimension(new Dimension(dimensionH, dimensionV));
    this.setName(name);

    int iterator = 0;
    int j;
    for (int i = 0; i < dimensionH; i++) {
        j = 0;
        while (j < dimensionV) {
            this.entries[i][j] = values[iterator];
            j++;
            iterator++;
        }
    }
}

public Matrix(Dimension dimension) throws MatrixException {
    this(dimension.getRows(), dimension.getColumns(), null);
}

public static Matrix identityMatrix(int dim) throws MatrixException {
    if (dim == 0) throw new MatrixException(ZERO_UNIT_DIMENSION);

    double[] i = new double[dim * dim];
    int constant = dim + 1;
    for (int j = 0; j < i.length; j = j + constant) {
        i[j] = 1.0;
    }

    return new Matrix(dim, dim, null, i);
}

public String toString() {

    StringBuilder builder = new StringBuilder("Matrix \"" + (this.getName() == null ? "Null Matrix" : this.getName()) + "\": {\n");

    for (int i = 0; i < this.getDimension().getRows(); i++) {
        for (int j = 0; j < this.getDimension().getColumns(); j++) {
            if (j == 0) builder.append("\t");
            builder.append(this.entries[i][j]);
            if (j != this.getDimension().getColumns() - 1)
                builder.append(", ");
        }
        if (i != this.getDimension().getRows()) builder.append("\n");
    }

    builder.append("}");

    return builder.toString();
}

public boolean isSquare() {
    return this.getDimension().getColumns() == this.getDimension().getRows();
} 
```

}

这是MatrixOperations的矩阵乘法的代码方法

```
public static Matrix multiply(Matrix matrix1, Matrix matrix2) throws MatrixException {

    if (matrix1.getDimension().getColumns() != matrix2.getDimension().getRows())
        throw new MatrixException(MATRIX_MULTIPLICATION_ERROR_MSG);

    Matrix retVal = new Matrix(matrix1.getDimension().getRows(), matrix2.getDimension().getColumns(), matrix1.getName() + " x " + matrix2.getName());

    for (int i = 0; i < matrix1.getDimension().getRows(); i++) {
        for (int j = 0; j < matrix2.getDimension().getColumns(); j++) {
            retVal.getEntries()[i][j] = sum(arrayProduct(matrix1.getEntries()[i], getColumnMatrix(matrix2, j)));
        }
    }

    return retVal;
} 
```

以下是方法 sum、arrayProduct 和 getColumnMatrix 的代码

```
private static double sum(double... values) {
    double sum = 0;
    for (double value : values) {
        sum += value;
    }
    return sum;
}

private static double[] arrayProduct(double[] arr1, double[] arr2) throws MatrixException {
    if (arr1.length != arr2.length) throw new MatrixException("Array lengths must be the same");
    double[] retVal = new double[arr1.length];
    for (int i = 0; i < arr1.length; i++) {
        retVal[i] = arr1[i] * arr2[i];
    }

    return retVal;
}

private static double[] getColumnMatrix(Matrix matrix, int col) {
    double[] ret = new double[matrix.getDimension().getRows()];
    for (int i = 0; i < matrix.getDimension().getRows(); i++) {
        ret[i] = matrix.getEntries()[i][col];
    }
    return ret;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-13T09:07:34.510

为多个任意维数组尝试此代码并打印它。认为这更简单，任何人都可以理解这一点。

```
public class Test
{

  public static void main(String[] args)
  {
    int[][] array1 = {
        { 1, 4, -2 },
        { 3, 5, -6 },
        { 4, 5, 2 }
    };

    int[][] array2 = {
        { 5, 2, 8, -1 },
        { 3, 6, 4, 5 },
        { -2, 9, 7, -3 }
    };
    Test test = new Test();
    test.printArray(test.multiplication(array1, array2));
  }

  private int[][] multiplication(int[][] array1, int[][] array2)
  {
    int r1, r2, c1, c2;
    r1 = array1.length;
    c1 = array1[0].length;

    r2 = array2.length;
    c2 = array2[0].length;

    int[][] result;
    if (c1 != r2)
    {
      System.out.println("Error!");
      result = new int[0][0];
    }
    else
    {
      result = new int[r1][c2];

      for (int i = 0; i < r1; i++)//2
      {
        for (int j = 0; j < c2; j++)//4
        {
          for (int k = 0; k < c1; k++)
          {
            result[i][j] += array1[i][k] * array2[k][j];
          }
        }
      }
    }

    return result;
  }

  private void printArray(int[][] array)
  {
    for (int[] arr : array)
    {
      for (int element : arr)
      {
        System.out.print(element + " ");
      }
      System.out.println();
    }
  }
} 
```

# java - 如何在另一个 JPanel 中的 JPanel 上绘制形状？

> ID：15733835
> 
> 赞同：1
> 
> 时间：2013-03-31T19:57:03.580
> 
> 标签：java, swing, jpanel, java-2d, paintcomponent

我目前正在尝试在 a 上绘制形状`JPanel`，它在另一个`JPanel`内，在 a 内`JFrame`。

我搜索了 Google 和 Youtube，发现了如何在`JFrame`一个面板中绘制形状，但没有找到任何可以帮助我完成我正在做的事情的东西。（也许我什么都没看到）。

到目前为止我看到的代码：

```
public class GameScreen 
{
    public void paintComponent(Graphics g)
    {
        super.paintComponent(g);
        g.setColor(Color.red);
        g.drawRect(100, 10, 30, 40);
    }

    public static void main(String[] args)
    {
       GameScreen gs = new GameScreen();
       JFrame f = new JFrame();
       f.setTitle("");
       f.setSize(400,400);
       f.setVisible(true);
       f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
       f.add(gs);
} 
```

当我只处理一个面板时，这一切都很好，但我想在我创建的第一个面板内的面板上显示形状。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T20:01:38.043

以与您现在相同的方式将 JPanel 添加到 JFrame，但使用您自己的 JPanel 子类来完成。

```
class MyPanel extends JPanel {
    @Override
    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.setColor(Color.red);
        g.drawRect(100, 10, 30, 40);
    }

    @Override
    public Dimension getPreferredSize() {
        return new Dimension(400,400); // As suggested by camickr
    }
} 
```

您可以将其添加到位于 JFrame 内的 JPanel

```
public static void main(String[] args)
{
   MyPanel mp = new MyPanel();
   JPanel jp = new JPanel();
   jp.add(mp);

   JFrame f = new JFrame();
   f.setTitle("");
   f.setSize(400,400);
   f.setVisible(true);
   f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
   f.add(jp);
} 
```

如果您将它们添加为子组件，这可以适用于组件内的组件。关键是扩展组件并覆盖您希望更改的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-31T20:21:40.640

> 当我只处理一个面板时，这一切都很好，

您发布的代码工作正常，因为框架使用 BorderLayout。因此，当您将面板添加到框架时，尺寸会增加，并且会看到您的自定义绘画。

> 我想在我创建的第一个面板内的面板上显示形状。

创建面板时，默认情况下它使用 FlowLayout。当您向该面板添加自定义绘画面板时，它将以其首选尺寸显示，即 (0, 0)，因为您没有指定首选尺寸。

在进行自定义绘画的面板上，您还需要实现 getPreferredSize() 方法，以便布局管理器知道如何排列面板。例如：

```
public Dimension getPreferredSize()
{
    return new Dimension(200, 200);
} 
```

# c++ - 哪个更快：STL 队列或 STL 堆栈？

> ID：15733838
> 
> 赞同：3
> 
> 时间：2013-03-31T19:57:30.900
> 
> 标签：c++, performance, stl, stack, queue

我正在实现拓扑排序的一个变体，它需要一个结构来保存没有传入边的元素。两者看起来都很好`queue`，`stack`因为取出它们的顺序无关紧要。问题是：它们中的任何一个明显快于另一个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T20:03:13.623

`queue`并且`stack`都是容器适配器，它们本身并不是完整的容器。两者 `stack`和默认情况下`queue` 都在 a 之上实现，`std::deque`如果您不更改此设置，它们应该具有相似的性能。

这实际上取决于您正在编写什么样的应用程序，并且您可以选择最有利于您想要的那些操作的底层容器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-31T20:04:29.227

回答你的主要问题：我不知道。我不认为它们中的任何一个明显更快，因为`std::deque`（堆栈和队列的默认内部容器）push_back 和 push_front（以及 pop_back 和 pop_front）是对称的。没有一个应该更快。但是，我建议将普通的旧 std::vector 与`push_back`and`pop_back`或等效地一起使用

```
std::stack<T, std::vector<T>> 
```

请参阅[此处](https://stackoverflow.com/questions/102459/why-does-stdstack-use-stddeque-by-default)了解堆栈默认使用双端队列的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-31T20:07:03.783

虽然在性能上`queue`并`stack`没有太大的不同，但它们显然会导致不同的节点访问顺序。根据您的节点在内存中的布局方式，其中一个*可能会比另一个提供对缓存更友好的顺序。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-31T20:02:57.920

它们都具有恒定的复杂性...您只需要计时以确定是否有任何常数更高

```
http://www.cplusplus.com/reference/stack/stack/pop/
http://www.cplusplus.com/reference/queue/queue/pop/ 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2013-03-31T19:59:25.997

队列和堆栈是不同的。首先是FIFO，堆栈是FILO

# java - 从目标 c 调用 java api

> ID：15733840
> 
> 赞同：0
> 
> 时间：2013-03-31T19:57:57.820
> 
> 标签：java, android, ios, objective-c

我正在开发 android 和 ios 应用程序。我的问题是，在我的 android 应用程序中，我使用 Apachi POI api 来读取 .doc 和 .docx 文件，但在我的 ios 应用程序中，我不能使用 Apachi POI。有没有办法在目标 c 中使用 Java api？如果没有办法，我可以手动将 Apachi POI 转换为目标 c 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T20:12:53.047

没有办法在 iOS 上运行 Java。Java 需要虚拟机才能运行。

如果你足够了解 Obj-C，你可以手动转换任何你想要的 Java 代码。您还可以寻找 java -> obj-c 转换器，它可以帮助您进行一些转换。

请注意，这将是一项非常漫长的工作，而不是您可以在一个月内完成的工作。

最简单的解决方案是找到一个 C/C++/Obj-C 库或仅实现`docx`您需要的特定部分。

# java - 始终从启动器活动启动应用程序

> ID：15733845
> 
> 赞同：0
> 
> 时间：2013-03-31T19:58:44.057
> 
> 标签：java, android

我的应用程序包含 3 个活动。假设 A,B,C 。A是启动活动。现在以这种方式运行应用程序 - A -> B -> C 现在我按 Home 键（出现主屏幕）。现在，当我再次按下应用程序图标启动应用程序时，然后从前面的活动 C 开始。但是我希望我的应用程序在主屏幕上按应用程序图标时始终以活动 A 开头。

我该怎么做 ？

我不想杀死应用程序 onPause() 或 OnStop()，而只想在按下主页按钮时杀死。我已经用谷歌搜索了 CATCH HOME BUTTON 但未能成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T20:08:25.990

在启动`Activities`B 和 C 时，使用`FLAG_ACTIVITY_NO_HISTORY`带有 的标志`Intent`来防止它们`Activities`被保存在堆栈上。当您离开应用程序并从启动器重新启动它时，将启动`Activity`A。这是代码：

```
Intent intent = new Intent(A.this, B.class);
intent.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY);
startActivity(intent); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T20:06:05.687

尝试在清单文件上使用您的启动器活动添加以下标签。

```
android:clearTaskOnLaunch="true" 
```

# c++ - 赋值切换案例 c ++

> ID：15733849
> 
> 赞同：0
> 
> 时间：2013-03-31T19:59:12.123
> 
> 标签：c++, loops, switch-statement

要求

1.  秃鹰是 V，猫头鹰是 O，鹰是 E...
2.  `for`输入每个鸟类观察者收集的数据的循环。
3.  在`for`循环内部，一个`do ... while`循环输入和处理一位观鸟者收集的数据。
4.  在`do ... while`循环内部，一个`switch`语句用于计算每种鸟的蛋数量。输入an 时使用默认选项，它什么都不做`x`。
5.  `do ... while`当为鸟的类型输入 X 时，循环退出。
6.  根据下面的代码，总计部分很好

好的，现在我的问题是我似乎无法通过我的开关盒。它提示我输入第一个观察者的信息，当我输入它时，它永远不会移动到下一个观察者。

给出的输入数据是

```
3
E2 O1 V2 E1 O3 X0
V2 V1 O1 E3 O2 E1 X0
V2 E1 X 
```

这是我到目前为止得到的代码：

```
#include <iostream>
#include <cstdlib>

using namespace std;

int main()
{

int totNrVultureEggs, totNrEagleEggs, totNrOwlEggs, nrEggs,
   nrVultureEggs, nrEagleEggs, nrOwlEggs, nrBirdWatchers, nrEggsEntered;

char bird;

// initialize grand totals for number of eggs for each type of bird
cout << "How many bird watchers took part in the study?";
cin >> nrBirdWatchers;

// loop over number of bird watchers
for (int i = 0; i < nrBirdWatchers ;i++ )
{
// initialize totals for number of eggs for each type of bird
// this bird watcher saw
nrVultureEggs = 0;
nrEagleEggs = 0;
nrOwlEggs = 0;
cout << "\nEnter data for bird watcher " << i + 1 << ":" << endl;

//loop over bird watchers
do{

    cin >>  bird >> nrEggs;
    switch (bird)
    {
        case 'E':
        case 'e':
            nrEagleEggs = nrEagleEggs + nrEggs;

        case 'O':
        case 'o':
            nrOwlEggs = nrOwlEggs + nrEggs;

        case 'V':
        case 'v':
            nrVultureEggs = nrVultureEggs + nrEggs;

        default :
        nrBirdWatchers++;
        break;

    }

    }while (i < nrBirdWatchers )
;
cout << "Bird watcher " << i + 1 << " saw " << nrVultureEggs;
cout << " vulture eggs, " << nrEagleEggs << " eagle eggs and ";
cout << nrOwlEggs << " owl eggs " << endl;
// increment grand totals for eggs
}

// display results
cout << "\nTotal number of vulture eggs: " << totNrVultureEggs;
cout << "\nTotal number of eagle eggs: " << totNrEagleEggs;
cout << "\nTotal number of owl eggs: " << totNrOwlEggs;
return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:04:19.440

在每个 switch case 之后你需要休息一下。此外，您需要一个布尔变量“完成”来告诉您单个观鸟者何时完成。

```
 bool done = false; //Flag to note when a birdwatcher is done
 do {
     string data;
     cin >>  data;
     bird = data[0];
     nrEggs = data[1]-0;
     switch (bird)
     {
     case 'E':
     case 'e':
         nrEagleEggs = nrEagleEggs + nrEggs;
         break; //was missing before

     case 'O':
     case 'o':
         nrOwlEggs = nrOwlEggs + nrEggs;
         break; //was missing before

     case 'V':
     case 'v':
         nrVultureEggs = nrVultureEggs + nrEggs;
         break; //was missing before

     default :
         done = true; //changed: No more birds to report
         break;

     }
 }while (!done) //Check if there are birds to report 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T21:10:14.457

我重写了整个程序，现在它可以工作了，但要注意输入：由于输入的类型，你必须给 ALWAYS 几个`char-int`，否则你会很糟糕 xD [问题出在缓冲区] .

所以输入将是：

```
3
E2 O1 V2 E1 O3 X0
V2 V1 O1 E3 O2 E1 X0
V2 E1 X0 
```

以下来源：

```
#include <iostream>
#include <cstdlib>

using namespace std;

int main(){

    bool done;
    char birdType;
    int eagleEggs, owlEggs, vultureEggs;
    int totEagleEggs, totOwlEggs, totVultureEggs;
    int eggsTemp, eggsIn, birdWatchers;

    cout << "How many bird watchers took part in the study?";
    cin >> birdWatchers;

    totEagleEggs = totOwlEggs = totVultureEggs = 0;

    for (int i = 0; i < birdWatchers ;i++ ){
        eagleEggs = owlEggs = vultureEggs = 0;
        done = false;

        cout << endl;
        cout << "Enter data for bird-watcher n. " << (i + 1) << ":" << endl;
        do{
            cin >>  birdType >> eggsTemp;
            switch (birdType)
            {
                case 'E':
                case 'e':
                eagleEggs += eggsTemp;
                totEagleEggs += eagleEggs;
                break;

            case 'O':
              case 'o':
                owlEggs += eggsTemp;
                totOwlEggs += owlEggs;
            break;

            case 'V':
            case 'v':
                vultureEggs += eggsTemp;
                totVultureEggs += vultureEggs;
            break;

            default:
                done = true;
            }
        }while (!done);

        cout << "The bird-watcher n. " << (i + 1) << " saw " << vultureEggs;
        cout << " vulture eggs, " << eagleEggs << " eagle eggs and ";
        cout << owlEggs << " owl eggs." << endl;
    }

    cout << endl;
    cout << "Total number of vulture eggs: " << totVultureEggs << endl;
    cout << "Total number of eagle eggs: " << totEagleEggs << endl;
    cout << "Total number of owl eggs: " << totOwlEggs << endl;
    system("PAUSE");
    return 0;
} 
```

# video - 将原始像素帧转换为 mpeg 视频的媒体基础

> ID：15733851
> 
> 赞同：1
> 
> 时间：2013-03-31T19:59:15.800
> 
> 标签：video, encoding, ms-media-foundation, mpeg-4

我想在 Windows 7 上将固定大小的原始像素帧编码为 MPEG。我正在尝试使用媒体基础转换来做到这一点。但媒体基金会不支持直接将原始帧转换为 MPEG。相反，我必须使用媒体接收器将原始像素缓冲区转换为 WMV3 格式，然后使用转码拓扑将 WMV 转换为 MPEG。

媒体基金会是否支持直接将帧缓冲区转换为 MEPG？

此外，在执行此操作时，我遇到了转码框架无法将单帧 WMV 视频转换为 MEPG 的麻烦。不知道为什么，但在输入单帧 WMV 时会导致创建空的 MPEG 文件。这是媒体基金会的已知限制吗？

此致

燃气轮机

PS我不打算为直接显示实现过滤图来做到这一点。根据媒体基金会的文件，它应该提供直接展览提供的所有设施。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T21:12:45.240

Media Foundation 为您提供处理压缩的[H.264 视频编码器MFT/DMO。](http://msdn.microsoft.com/en-us/library/windows/desktop/dd797816%28v=vs.85%29.aspx)

与 DirectShow（您不想使用，但它为您提供使用第三方编码器压缩成 MPEG-4 和 MPEG-4 AVC 的类似选项）不同，使用 Media Foundation，您可以自己使用转换，无需将其插入功能齐全的图形（拓扑）中。Microsoft 仅为您提供 H.264 编码器，仅从 Windows 7 开始（对您有好处）。

在 MSDN 文章中描述了 MFT 的使用，并逐步遵循它，您将获得压缩的 H.264 (MPEG-4 AVC) NAL 单元，但它们并不完全是“文件”。MPEG-4 文件是按照 MPEG-4 Part 14 规范格式化的数据，Microsoft 为您提供了[MPEG-4 File Sink](http://msdn.microsoft.com/en-us/library/windows/desktop/dd757763%28v=vs.85%29.aspx)。后者基本上假设您使用的是拓扑而不是单个组件。

因此，您的选择是 (a) 实现要插入拓扑的自定义视频源节点，并构建编码拓扑以通过 H.264 编码器将数据路由到 MPEG-4 文件接收器，或者 (b) 实例化独立的视频编码器和文件接收器分开，并在拓扑之外使用它们设置它们并在它们之间传递数据。或者，另一个选项 (c) 是使用 Media Foundation [Sink Writer API](https://docs.microsoft.com/en-us/windows/win32/medfound/sink-writer)，它与提到的后者大致相同，重点是易用性而不是灵活性和对细节的控制。

> 根据媒体基金会的文件，它应该提供直接展览提供的所有设施。

不，它不应该也不应该。Microsoft 仅通过 Windows 7+ 中的 Media Foundation 提供 MPEG-4 视频编码器和多路复用器，并且根本不使它们可用于 DirectShow（除非通过 MF 组件的包装器），但是 MF 在许多方面不如 DS：支持在较旧的操作系统中，功能集、可扩展性和开销 - 仅举几例。

# android - 如何在 Facebook 登录期间隐藏 Android ActionBar？

> ID：15733853
> 
> 赞同：2
> 
> 时间：2013-03-31T19:59:17.277
> 
> 标签：android, android-actionbar, actionbarsherlock

我有一个常规的工作流程。这一切都从登录页面开始，带有“使用 Facebook 登录”按钮。如果用户按下此按钮，此按钮会出现 Facebook 登录页面。如果成功，则会出现应用程序主屏幕。

我希望 ActionBar 在成功登录后出现。所以启动过程中没有 ActionBar，登录页面上没有 ActionBar，Facebook 登录表单后面没有 ActionBar。

我可以在 Manifest 的登录页面上隐藏 ActionBar：

```
<application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name="hu.go.abs_style_test.LoginActivity"
            android:theme="@style/Theme.Sherlock.NoActionBar" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity
            android:name="hu.go.abs_style_test.MainActivity" /> 
```

但我无法将其隐藏在 Facebook 登录表单后面：

![带有操作栏的 facebook 登录表单](https://s3.postimg.org/5m9zp81eb/Screenshot_2013_03_31_21_40_26.png)

我想在登录页面后使用 ActionBar，所以这是不可能的，因为 ActionBar 之后将为空：

```
<application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" > 
```

哦，还有一件事：我正在使用`ActionBarSherlock`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T00:16:09.550

`getSupportActionBar().hide();`我建议您在显示 Facebook 登录弹出窗口时以编程方式（而不是在 XML 文件中）隐藏 ActionBar ，然后`getSupportActionBar().show();`在焦点返回到您的应用程序时调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-04T10:04:08.750

```
 <activity android:name="com.facebook.FacebookActivity"
        android:configChanges=
            "keyboard|keyboardHidden|screenLayout|screenSize|orientation"
        android:theme="@android:style/Theme.Translucent.NoTitleBar.Fullscreen"
        android:label="@string/app_name" /> 
```

解决了我的问题。

# jsf - 从选择一个菜单中选择自定义对象 JSF 转换器异常

> ID：15733862
> 
> 赞同：0
> 
> 时间：2013-03-31T19:59:44.083
> 
> 标签：jsf, jsf-2, selectonemenu

我想从选择一个菜单中选择自定义对象。它既不显示错误也不显示值。该怎么办？请帮我。提前致谢。

现在我在这一行的 getAsObject 看到 Null 指针异常：

```
return getCurrencyService().getCurrencyBtId(currencyId); 
```

**这是我的 xhtml 文档**

```
<h:panelGrid columns="2">
    <p:outputLabel value="" />
        <p:selectOneMenu id="CurrencyMenu" value="#{CurrencyMB.currency}" converter="currencyConverter" >
        <f:selectItems value="#{CurrencyMB.currencyList}" var="currency"  itemValue="#{currency}" itemLabel="#{currency.currencyName}" >    
            </f:selectItems>
        <p:ajax update="currencyOut" />
        </p:selectOneMenu>
        <p:outputLabel value="Currency Id : #{CurrencyMB.currency.currencyId}" id="currencyOut" />
</h:panelGrid> 
```

**这是我的 managedBean 类。**

```
@ManagedBean(name = "CurrencyMB")
@RequestScoped
public class CurrencyManagedBean implements Serializable{

private Currency currency;
private List<Currency> currencyList;

public Currency getCurrency() {
        return currency;
    }

public void setCurrency(Currency currency) {
        this.currency = currency;
    }
public List<Currency> getCurrencyList() {
        currencyList = new ArrayList<Currency>();
        currencyList.addAll(getiCurrencyService().getCurrencies());
        return currencyList;
    }

public void setCurrencyList(List<Currency> currencyList) {
        this.currencyList = currencyList;
    }

} 
```

**这是我的 currencyConverter 类代码：**

```
**@FacesConverter("currencyConverter")
public class CurrencyConverter implements Converter {
    @ManagedProperty(value = "#{currencyService}")
    private ICurrencyService currencyService;

    public ICurrencyService getCurrencyService() {
        return currencyService;
    }
    public void setCurrencyService(ICurrencyService currencyService) {
        this.currencyService = currencyService;
    }
    @Override
    public Object getAsObject(FacesContext arg0, UIComponent arg1, String value) {

        int currencyId = Integer.valueOf(value);
        return getCurrencyService().getCurrencyBtId(currencyId);
    }
    @Override
    public String getAsString(FacesContext arg0, UIComponent arg1, Object value) {
        Currency currency = (Currency) value;
        int currencyId = currency.getCurrencyId();
        return String.valueOf(currencyId);
    }
}** 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T05:50:34.547

从许多问题中可以看出，他们的答案，在这里，`@FacesConverter`不符合注射条件。在您的情况下，您尝试通过 注入您的服务`@ManagedProperty`，这会产生 NPE，正如 Luiggi 在对您最初问题的评论中告诉您的那样。

在当前的 JSF 版本中，您在转换器中注入服务所能做的就是放弃使用`@FacesConverter`并转而使用标准`@ManagedBean`注释，因此不是通过 id 而是通过 bean 名称来引用您的转换器，例如 in `converter="#{currencyConverter}"`.

# java - 创建静态方法以逐字符比较两个字符串。如果字符串 a 中的所有字母都在字符串 b 中，则返回 true。否则，则返回 false

> ID：15733865
> 
> 赞同：2
> 
> 时间：2013-03-31T20:00:02.723
> 
> 标签：java, static

到目前为止，这是我的代码。我被卡住了，我不知道该怎么办。谢谢您的帮助！

```
public static boolean checkWord(String a, String b){

    int x = 0;
    while (x < a.length()){
      int y = 0;
      while (y < b.length()){
        if(a.charAt(x)==b.charAt(y)){
          String t = "next";
          System.out.println(t);
          y++;
        }else{

        }
      }
      x++;
    }
    return false;
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:44:32.417

我还没有编译这段代码，但它应该可以工作。

```
public static boolean checkWord(String a, String b)
{
    int j;
    for(int i = 0; i < a.length(); i++)
    {
        j = 0;
        while(j < b.length())
        {
            if(a.charAt(i) == b.charAt(j)) break;
            j++;
        }
        if(j == b.length()) return false;
    }
    return true;
} 
```

据我了解，您想查看“a”中的字母是否以特定顺序包含在“b”中，即您不是在寻找“a”是否是“b”的子字符串。

外层循环将遍历字符串 a 中的每个字符，而内层循环将运行多次才能找到匹配项。如果没有匹配，内部循环将增加它的控制变量'j'到'b'的大小。这就是为什么你会在内部 while 循环之后进行检查 - 如果检查通过，这意味着在字符串 'b' 的任何地方都找不到来自字符串 'a' 的字母，因此程序可以返回 false；

如果外部 for 循环定期结束，则表示所有字母都匹配，函数将返回 true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T20:44:38.953

```
 public static boolean checkWord(String a, String b){
    int x = 0;
    while (x < a.length()){
      int y = 0;
      while (y < b.length()){
        System.out.println("x:" + x + " y:" + y + " a.charAt(x)==b.charAt(y):" + (a.charAt(x)==b.charAt(y)));
        if(a.charAt(x)==b.charAt(y)){
          break;
        }else{
          y++;
        }
        if (y == b.length()) {
          return false;
        }
      }
      x++;
    }
    return true;
  } 
```

# emacs - 在 Emacs 中自定义突出显示面：仅更改背景颜色

> ID：15733873
> 
> 赞同：7
> 
> 时间：2013-03-31T20:00:39.227
> 
> 标签：emacs, emacs-faces

`hl-line`有没有办法在Emacs中定义一个面（例如突出显示，如

更具体地说，我在`tango-dark`主题上尝试了以下内容

```
(custom-set-faces
 '(region ((t (:inherit nil :background "RoyalBlue4"))))
 '(highlight ((t (:inherit region :background "dark olive green"))))
 '(hl-line ((t (:inherit highlight))))) 
```

并且，如下所示，区域突出显示**确实**尊重前景字体（即它只改变背景颜色）：

                     ![在此处输入图像描述](https://i.stack.imgur.com/D0ltz.png)

**但**当前行的突出显示不会：

                       ![在此处输入图像描述](https://i.stack.imgur.com/zEsf5.png)

为什么？我怎样才能得到同样的效果`hl-line`？

## 更新：

这似乎是主题中的一个错误`tango-dark`（Emacs 的内置主题）。该代码适用于默认主题（使用 加载`emacs -Q`）。我在官方错误邮件列表上发布了这个。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-01T15:14:48.977

前段时间我为此苦苦挣扎，这似乎是颜色主题的错误。

不过，我想出了一个解决方法。这对我有用：

```
(load-theme 'tango-dark t)
(set-face-attribute 'highlight nil :foreground 'unspecified) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-18T17:03:52.303

我有一点类似的问题：

```
(add-hook 'after-make-frame-functions
  (lambda (frame)
    (select-frame frame)
      (when (display-graphic-p frame)
       (custom-set-faces '(region ((t (:inherit nil :background "RoyalBlue4")))))
     ) 
```

# iphone - UITableViewCell 平移以显示选项：动画

> ID：15733876
> 
> 赞同：4
> 
> 时间：2013-03-31T20:01:01.813
> 
> 标签：iphone, objective-c, xcode, cocoa-touch, core-animation

所以我有一个很好的在 tableview 单元格上平移的实现。我基本上使用 panGestureRecognizer 并将单元格移出屏幕，并在 tableViewCell 下方显示另一个视图。这工作正常。当我在 tableViewCell 上平移时，我基本上会在下面显示 5 个按钮。

我的目标是在 tableviewcell 移动时为 5 个按钮设置动画。例如，

* * *

## | 1 | 2 | 3 | 4 | 5|

如果我正在滑动并向右移动单元格并且我是十字按钮 1，我将动画按钮弹出并对用户可见。如果我越过 2，那么 2 将动画弹出，并且对用户可见。当我在按钮 5 中时，所有按钮都已弹出并准备好进行用户操作。

我正在这样做

```
 //Scale Animation
    CABasicAnimation *scaleAnim = [CABasicAnimation animationWithKeyPath:@"transform"];
    scaleAnim.duration = 0.3;
    scaleAnim.toValue = [NSValue valueWithCATransform3D:CATransform3DIdentity];
    scaleAnim.fromValue = [NSValue valueWithCATransform3D:CATransform3DMakeScale(0.1,0.1, 1.0)];
    scaleAnim.removedOnCompletion = YES;
    [view.layer addAnimation:scaleAnim forKey:nil]; 
```

**

我的目标 ：

**

因此，当我处于平移手势的中间，并且我决定关闭它（向左移动）时，按钮应该会弹出，并且对用户不可用。

此外，当我移动单元格时，按钮应逐渐放大，并可供用户使用。所以我基本上需要传递单元格的原点并使用一些数学来根据按钮的原点和宽度（相当简单）计算按钮的比例。

```
if (CGRectIntersectsRect(button.frame, self.movingCell.frame))
{
    CGFloat xScale = cellTranslation - xOriginForButton;
    [self popOutAnimate:button withScale:xScale/ (xWidthForButtons + xSpaceBetweenButtons)];
} 
```

但是当我快速移动单元格时问题出现了，视图没有得到单元格移动的所有变化，并且它们被卡在半动画状态。

我有一种感觉，我没有正确掌握逻辑。整个实现类似于**Sparrow** iphone 邮件应用程序。当您平移单元格时，按钮会随着单元格的移动以动画形式显示。对于那些没有使用麻雀的人。您可以在 1:25 中看到平移手势[https://www.youtube.com/watch?v=XLX6XV0SbWI&t=1m25s](https://www.youtube.com/watch?v=XLX6XV0SbWI&t=1m25s)

逻辑正确吗？我错过了什么吗？

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T18:33:08.810

在使用几种不同的方式解决这个问题后，我最终找到了一个解决方案，我在下面输入了它。

**算法：**

滑动或平移 tableViewCell 的原则是直截了当的。弹出单元格下方按钮的算法基于单元格的当前位置与按钮位置的比较。有几种方法可以解决这个问题，以下示例中使用的一种是_NOT_THE_MOST_OPTIMAL_ 一种，因为我们重新排序按钮时会出现复杂情况。（即如果按钮重新排序，算法将失败）。

让我们看一下这个问题的最佳解决方案。

1.  使用 ( 执行 hit_test`CGRectIntersects(rect1, rect2)`以找出单元格与任何按钮的位置。==> 这将是最理想的解决方案，因为替换或互换按钮仍然可以正常工作。但是我们不能使用这种方法，因为当单元格时 hit_test 将失败快速移动。这将使按钮处于非常不正确的状态。

2.  根据翻译直接使用按钮的框架并放大它们。===> 我们不能在任何场景中使用按钮的框架，因为当我们缩放它们时，(x,y,size,width) 变化很大

3.  在动画之前缓存按钮帧并使用它们来缩放它们。===> 缓存它们可能适用于某些情况，但我们需要非常定期地更新它们，并确保在 ORIENTATION_CHANGE 之后缓存它们。这将再次成为一种痛苦，因为方向改变后的按钮框架也非常剧烈（请参阅第 2 部分）。

**在职的：**

因此，如果我们要为单元格下方的所有按钮设置动画，那么您将只有一个 regionOfAnimation。如果您有一组带有静态按钮的部分，以及一组需要动画的按钮，那么我们有 2 个区域 - 一个带有 staticButtons 的区域，另一个带有 regionOfAnimation。

区域的这些值是根据动画区域的位置（如 IB 中设置的）计算得出的。我们再次根据按钮的数量均匀地分割 regionOfAnimation，当单元格在每个分割点上移动时，我们为它下面的按钮设置动画。

```
|    Region of Static Buttons   |  Region of Animation  |
---------------------------------------------------------
| Static Button | Static Button |  1 |  2 |  3 |  4 |  5|
---------------------------------------------------------
|                                       
|              ===>  CELL MOVES ====>               
|   
--------------------------------------------------------- 
```

**这种方法的优点：**

1.  性能优于 hit_test（非常需要中断）
2.  按钮将始终正确动画，因为我们不访问它们的框架进行计算

**缺点：**

1.  静态按钮区域和动画区域必须事先计算好两个方向。
2.  如果按钮互换，则需要更新算法以反映新的变化。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-01T05:21:38.913

你可以在这里找到你所有的答案 [https://github.com/spiliams/sparrowlike](https://github.com/spilliams/sparrowlike) :) 它的评论非常有力，并且会更加模块化.. 尝试编辑这个。

# javascript - 为什么 JSON.stringify 不序列化不可枚举的属性？

> ID：15733878
> 
> 赞同：9
> 
> 时间：2013-03-31T20:01:15.273
> 
> 标签：javascript, json, serialization

我正在使用 JavaScript 将对象序列化为 JSON 字符串，

我注意到只有可枚举的对象属性被序列化：

```
var a = Object.create(null,{
  x: { writable:true, configurable:true, value: "hello",enumerable:false },
  y: { writable:true, configurable:true, value: "hello",enumerable:true }
});
document.write(JSON.stringify(a)); //result is {"y":"hello"} 
```

^([[笔](http://codepen.io/anon/pen/CmAys)])

我想知道为什么会这样？我搜索了[MDN 页面](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/stringify)，[json2](https://github.com/douglascrockford/JSON-js)解析器文档。我无法在任何地方找到这种行为记录。

我怀疑这是使用[仅通过 [[enumerable]]](http://es5.github.com/#x12.6.4)`for... in`属性的循环的结果（至少在 的情况下）。这可能可以通过返回可枚举和不可枚举属性的类似方法来完成。但是，序列化可能会有问题（由于反序列化）。`json2``Object.getOwnPropertyNames`

**tl;博士**

*   为什么`JSON.stringify`只序列化可枚举的属性？
*   这种行为是否记录在任何地方？
*   如何自己实现序列化不可枚举的属性？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-31T20:06:36.450

它在[ES5 规范](http://es5.github.com/#x15.12.3)中指定。

> 如果 Type(value) 是 Object，并且 IsCallable(value) 是 false

```
If the [[Class]] internal property of value is "Array" then

    Return the result of calling the abstract operation JA with argument value.

Else, return the result of calling the abstract operation JO with argument value. 
```

那么，让我们看看[JO](http://es5.github.com/#JO)。这是相关部分：

> 令 K 是一个内部字符串列表，由**[[Enumerable]] 属性为 true 的 value 的所有自身属性**的名称组成。字符串的顺序应与 Object.keys 标准内置函数使用的顺序相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-07T19:49:54.333

正如@ThiefMaster 上面回答的那样，它在规范中指定

但是，如果您知道要提前序列化的不可枚举属性的名称，则可以通过将替换函数作为第二个参数传递给 JSON.stringify() 来实现它（[MDN 上的文档](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#The_replacer_parameter)），就像这样

```
var o = {
  prop: 'propval',
}

Object.defineProperty(o, 'propHidden', {
  value: 'propHiddenVal',
  enumerable: false,
  writable: true,
  configurable: true
});

var s = JSON.stringify(o, (key, val) => {
  if (!key) {
    // Initially, the replacer function is called with an empty string as key representing the object being stringified. It is then called for each property on the object or array being stringified.
    if (typeof val === 'object' && val.hasOwnProperty('propHidden')) {
      Object.defineProperty(val, 'propHidden', {
        value: val.propHidden,
        enumerable: true,
        writable: true,
        configurable: true
      });

    }
  }
  return val;
});

console.log(s);
```

# javascript - 从网页中提取数据

> ID：15733880
> 
> 赞同：0
> 
> 时间：2013-03-31T20:01:18.710
> 
> 标签：javascript, web-scraping

我有一个指向 Apple App Store 上的应用程序的链接。我需要在我自己的网页上使用它的数据。更准确地说，我想提取应用程序图标、它的类别以及它是否免费，并将这些数据添加到我的网页中。如何使用 JavaScript 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:05:02.617

据我所知，由于跨平台安全问题，您无法使用 Javascript 执行此操作。您将需要一个 Web 服务器，并可能在 PHP 中编写一个爬虫来读取该页面。然后从您的 JavaScript 调用您的 PHP 脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T20:15:36.227

这是PHP脚本：

```
<?php
$ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $Url);
    curl_setopt($ch, CURLOPT_REFERER, "https://itunes.apple.com/us/app/google+/id447119634?mt=8");
    curl_setopt($ch, CURLOPT_USERAGENT, "Mozzila/1.0");
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_TIMEOUT, 10);
    $output = curl_exec($ch);
    curl_close($ch);

$logo = explode('<div class="artwork">', $output);
$logo = explode('src="', $logo[1]);
$logo = explode('"', $logo[1]);
$logo = $logo[0];

$category = explode('<span class="label">Category:', $output);
$category = explode('">', $category[1]);
$category = explode('<', $category[1]);
$category = $category[0];

echo $logo;
echo $category;
?> 
```

# neural-network - 需要帮助来改进基本神经网络的 graphviz 渲染

> ID：15733882
> 
> 赞同：0
> 
> 时间：2013-03-31T20:01:27.427
> 
> 标签：neural-network, graphviz

我尝试使用 Graphviz 来了解基本神经网络的状态。输入层有14个神经元，输出层只有一个神经元。可以选择隐藏层的数量以及每一层内的神经元数量。通常只有一个隐藏层。不过，这一层内的神经元数量可能相当大（比如 1000 个）。但是，出于演示目的，我只需要 5 个神经元（我知道我永远不会得到数百个神经元的有用图片）。我想：

*   写出每个神经元之间的边（连接）的权重
*   根据其重量修改边缘的厚度
*   也许标记每一层

关于厚度，我知道我可以使用“penwidth”。我也知道集群，它可以帮助界定每一层并给它们贴标签。到目前为止，我的主要问题是输入层（14 个神经元）和隐藏层之间的边太多，Graphiz 无法生成清晰的图片。如果我添加标签来显示连接的权重，那就更糟了。**我认为在我的输入和隐藏层之间放置更多空间可以提高渲染的可读性，但我没有找到如何做到这一点**，尽管研究了很长时间。

下面是目前的样子： [神经网络的当前渲染，没有权重](http://files.getwebb.org/view-cre62x71.html)

这是这张图片背后自动生成的点代码：

```
digraph graphname {
0.0 -> 1.0;
0.1 -> 1.0;
0.2 -> 1.0;
0.3 -> 1.0;
0.4 -> 1.0;
0.5 -> 1.0;
0.6 -> 1.0;
0.7 -> 1.0;
0.8 -> 1.0;
0.9 -> 1.0;
0.10 -> 1.0;
0.11 -> 1.0;
0.12 -> 1.0;
0.13 -> 1.0;
0.0 -> 1.1;
0.1 -> 1.1;
0.2 -> 1.1;
0.3 -> 1.1;
0.4 -> 1.1;
0.5 -> 1.1;
0.6 -> 1.1;
0.7 -> 1.1;
0.8 -> 1.1;
0.9 -> 1.1;
0.10 -> 1.1;
0.11 -> 1.1;
0.12 -> 1.1;
0.13 -> 1.1;
0.0 -> 1.2;
0.1 -> 1.2;
0.2 -> 1.2;
0.3 -> 1.2;
0.4 -> 1.2;
0.5 -> 1.2;
0.6 -> 1.2;
0.7 -> 1.2;
0.8 -> 1.2;
0.9 -> 1.2;
0.10 -> 1.2;
0.11 -> 1.2;
0.12 -> 1.2;
0.13 -> 1.2;
0.0 -> 1.3;
0.1 -> 1.3;
0.2 -> 1.3;
0.3 -> 1.3;
0.4 -> 1.3;
0.5 -> 1.3;
0.6 -> 1.3;
0.7 -> 1.3;
0.8 -> 1.3;
0.9 -> 1.3;
0.10 -> 1.3;
0.11 -> 1.3;
0.12 -> 1.3;
0.13 -> 1.3;
0.0 -> 1.4;
0.1 -> 1.4;
0.2 -> 1.4;
0.3 -> 1.4;
0.4 -> 1.4;
0.5 -> 1.4;
0.6 -> 1.4;
0.7 -> 1.4;
0.8 -> 1.4;
0.9 -> 1.4;
0.10 -> 1.4;
0.11 -> 1.4;
0.12 -> 1.4;
0.13 -> 1.4;
1.0 -> 2.0;
1.1 -> 2.0;
1.2 -> 2.0;
1.3 -> 2.0;
1.4 -> 2.0;
} 
```

在这段代码中，神经元的编号方式如下：LAYER_NUMBER.NEURON_NUMBER。请注意，神经元在图片中没有以正确的顺序出现，我也没有解决的问题......

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T03:23:54.860

这是一个包含一些不同想法的图表：

rankep 增加“等级”之间的距离。边距使节点更大。（可能有更好的方法来做到这一点。）

为每个节点着色并让该节点的每条边都使用相同的色调。为了便于阅读，您可以使该色调的节点更亮，边缘更暗。不要担心使用颜色名称，因为它支持#rrggbb 表示法。

我发现使用这样的颜色极大地增加了复杂图形的视觉清晰度。当它被着色时，它更容易跟随边缘，如果某物重量轻，它可以变得几乎不可见或完全不可见。

这种着色的另一个额外好处是它可以呼应染色真实神经元的方法。请参阅此获取灵感[http://neuroimages.tumblr.com](http://neuroimages.tumblr.com)

```
digraph graphname {
graph [rankdir="LR" ranksep="3.0"]
node [style=filled];
edge [penwidth="0.5" color="#e0e0e0"];

0.1 [fillcolor="cadetblue"];
0.2 [fillcolor="coral"];
0.3 [fillcolor="green"];
0.4 [fillcolor="gold"];
0.6 [fillcolor="cyan"];

1.0 [margin=0.4];
1.1 [margin=0.4];
1.2 [margin=0.4];
1.3 [margin=0.4];
1.4 [margin=0.4];

0.0 -> 1.0;
0.1 -> 1.0 [color="cadetblue1" penwidth="1"];
0.2 -> 1.0 [color="coral2" penwidth="2"];
0.3 -> 1.0 [color="green3" penwidth="6"];
0.4 -> 1.0 [color="gold4" penwidth="8"];
0.5 -> 1.0;
0.6 -> 1.0;
0.7 -> 1.0;
0.8 -> 1.0;
0.9 -> 1.0;
0.10 -> 1.0;
0.11 -> 1.0;
0.12 -> 1.0;
0.13 -> 1.0;
0.0 -> 1.1;
0.1 -> 1.1 [color="cadetblue2" penwidth="2"];
0.2 -> 1.1 [color="coral3" penwidth="5"];
0.3 -> 1.1 [color="green4" penwidth="8"];
0.4 -> 1.1; 
0.5 -> 1.1 [color="cyan1" penwidth="1"];
0.6 -> 1.1;
0.7 -> 1.1;
0.8 -> 1.1;
0.9 -> 1.1;
0.10 -> 1.1;
0.11 -> 1.1;
0.12 -> 1.1;
0.13 -> 1.1;
0.0 -> 1.2;
0.1 -> 1.2 [color="cadetblue3"  penwidth="3"];
0.2 -> 1.2 [color="coral4"  penwidth="6"];
0.3 -> 1.2;
0.4 -> 1.2 [color="gold1" penwidth="1"];
0.5 -> 1.2 [color="cyan2" penwidth="2"];
0.6 -> 1.2;
0.7 -> 1.2;
0.8 -> 1.2;
0.9 -> 1.2;
0.10 -> 1.2;
0.11 -> 1.2;
0.12 -> 1.2;
0.13 -> 1.2;
0.0 -> 1.3;
0.1 -> 1.3 [color="cadetblue4" penwidth="4"];
0.2 -> 1.3;
0.3 -> 1.3 [color="green1" penwidth="1"];
0.4 -> 1.3 [color="gold2" penwidth="2"];
0.5 -> 1.3 [color="cyan3" penwidth="3"];
0.6 -> 1.3;
0.7 -> 1.3;
0.8 -> 1.3;
0.9 -> 1.3;
0.10 -> 1.3;
0.11 -> 1.3;
0.12 -> 1.3;
0.13 -> 1.3;
0.0 -> 1.4;
0.1 -> 1.4 [color="cadetblue4"  penwidth="2"];
0.2 -> 1.4 [color="coral4" penwidth="2"];
0.3 -> 1.4 [color="green4" penwidth="2"];
0.4 -> 1.4 [color="gold4" penwidth="2"];
0.5 -> 1.4 [color="cyan4" penwidth="2"];
0.6 -> 1.4;
0.7 -> 1.4;
0.8 -> 1.4;
0.9 -> 1.4;
0.10 -> 1.4;
0.11 -> 1.4;
0.12 -> 1.4;
0.13 -> 1.4;
1.0 -> 2.0;
1.1 -> 2.0;
1.2 -> 2.0;
1.3 -> 2.0;
1.4 -> 2.0;
} 
```

# mongodb - Mongodb分片和索引

> ID：15733885
> 
> 赞同：2
> 
> 时间：2013-03-31T20:01:48.727
> 
> 标签：mongodb, indexing, sharding

我一直在努力部署一个大型数据库。我已经部署了 3 个分片集群并开始索引我的数据。但是已经16天了，我才完成了一半。

问题是，我是否应该将所有数据导入非分片集群，然后在原始数据进入数据库后激活分片，然后附加更多集群并开始索引？这会自动平衡我的数据吗？

或者我应该再等 16 天，等待我正在使用的当前方法......

*编辑：这里是正在导入的设置和数据的更多解释......

所以我们有 1.6 亿个这样的文档

```
"_id" : ObjectId("5146ae7de4b0d58a864bcfda"),
"subject" : "<concept/resource/propert/122322xyz>",
"predicate" : "<concept/property/os/123ABCDXZYZ>",
"object" : "<http://host/uri_to_object_abcdy>" 
```

索引：主语、谓语、宾语、主语>谓语、宾语>谓语 分片键：主语、谓语、宾语

设置：AWS 上的 3 个集群（每个集群有 3 个副本集），每个节点有 8 GiB RAM（配置服务器在每个集群中，Mongos 在单独的服务器中）

数据由 Java 程序导入到 Mongos 中。导入这些数据、索引和分片的理想方式是什么？（无需等待一个月即可完成该过程）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T03:06:42.957

如果您正在执行大量批量插入，通常在没有索引的情况下执行插入然后对集合进行索引会更快。这与 Mongo 动态管理索引更新的方式有关。

此外，MongoDB 在索引时对内存特别敏感。检查您的索引大小[`db.stats()`](http://docs.mongodb.org/manual/reference/database-statistics/)并将您的数据库连接到[Mongo Monitoring Service](http://www.10gen.com/products/mongodb-monitoring-service)。

根据我的经验，每当 MongoDB 花费的时间比预期的要多时，这是由于以下两件事之一：

1.  它耗尽了物理内存或进入了糟糕的 I/O 模式。MMS 可以帮助诊断两者。特别检查页面错误图。

2.  对未索引的集合进行操作，这不适用于您的情况。

# bash - 如何使 bash 正则表达式更具可读性？

> ID：15733886
> 
> 赞同：2
> 
> 时间：2013-03-31T20:01:49.577
> 
> 标签：bash, indentation

这是一个缩进很好的 Python 正则表达式示例（取自[此处](http://docs.python.org/2/howto/regex.html)）：

```
charref = re.compile(r"""
 &[#]                # Start of a numeric entity reference
 (
     0[0-7]+         # Octal form
   | [0-9]+          # Decimal form
   | x[0-9a-fA-F]+   # Hexadecimal form
 )
 ;                   # Trailing semicolon
""", re.VERBOSE) 
```

现在，我想对 bash 正则表达式（即 sed 或 grep）使用相同的技术，但到目前为止找不到对类似功能的任何参考。甚至可以缩进（和评论）这样的东西吗？

```
echo "$MULTILINE | sed -re 's/(expr1|expr2)|(expr3|expr4)/expr5/g' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:07:30.647

您可以使用 bash 的续行，可能是：

```
echo "start of a line \
continues the previous line \
yet another continuation
oops. this is a brand new line" 
```

注意前两行末尾的反斜杠。它们本质上是“转义”换行符/换行符，否则会告诉 bash 您正在开始一个新行，这也隐式地终止了正在定义的语句。

# c++ - 理解使用 std::condition_variable 的例子

> ID：15733887
> 
> 赞同：4
> 
> 时间：2013-03-31T20:01:52.163
> 
> 标签：c++, multithreading, c++11

有`condition_variable`从[cppreference.com](http://en.cppreference.com/w/cpp/thread/condition_variable)获取的使用示例：

```
#include <condition_variable>
#include <mutex>
#include <thread>
#include <iostream>
#include <queue>
#include <chrono>

int main()
{
    std::queue<int> produced_nums;
    std::mutex m;
    std::condition_variable cond_var;
    bool done = false;
    bool notified = false;

    std::thread producer([&]() {
        for (int i = 0; i < 5; ++i) {
            std::this_thread::sleep_for(std::chrono::seconds(1));
            std::lock_guard<std::mutex> lock(m);
            std::cout << "producing " << i << '\n';
            produced_nums.push(i);
            notified = true;
            cond_var.notify_one();
        }   

        std::lock_guard<std::mutex> lock(m);  
        notified = true;
        done = true;
        cond_var.notify_one();
    }); 

    std::thread consumer([&]() {
        while (!done) {
            std::unique_lock<std::mutex> lock(m);
            while (!notified) {  // loop to avoid spurious wakeups
                cond_var.wait(lock);
            }   
            while (!produced_nums.empty()) {
                std::cout << "consuming " << produced_nums.front() << '\n';
                produced_nums.pop();
            }   
            notified = false;
        }   
    }); 

    producer.join();
    consumer.join();
} 
```

如果变量在消费者线程启动之前`done`出现`true`，消费者线程将不会收到任何消息。确实，`sleep_for(seconds(1))`几乎可以避免这种情况，但是**理论上是否可行**（或者如果`sleep`代码中没有）？

在我看来，正确的版本应该像这样强制运行消费者循环至少一次：

```
std::thread consumer([&]() {
    std::unique_lock<std::mutex> lock(m);
    do {
        while (!notified || !done) {  // loop to avoid spurious wakeups
            cond_var.wait(lock);
        }   

        while (!produced_nums.empty()) {
            std::cout << "consuming " << produced_nums.front() << '\n';
            produced_nums.pop();
        }   

        notified = false;
    } while (!done);
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T20:30:20.877

是的，你是绝对正确的：消费者线程有可能在设置之后才会开始运行`done`。此外，生产者线程中的写入`done`和消费者线程中的读取产生竞争条件，并且行为未定义。你的版本也有同样的问题。**在每个**函数中将互斥锁包裹在整个循环中。对不起，没有精力编写正确的代码。

# c# - 获取两个单词之间的文本

> ID：15733888
> 
> 赞同：2
> 
> 时间：2013-03-31T20:01:59.707
> 
> 标签：c#, text

我需要知道如何获得两个给定单词之间的单词。不幸的是，我不知道该怎么做。例如：你好，美好的一天。

我该怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-31T20:09:59.070

如果我正确理解这个问题......

```
public static String GetTextBetween(String source, String leftWord, String rightWord)
        {
            return
                Regex.Match(source, String.Format(@"{0}\s(?<words>[\w\s]+)\s{1}", leftWord, rightWord),
                            RegexOptions.IgnoreCase).Groups["words"].Value;
        } 
```

采用：

```
Console.WriteLine(GetTextBetween("Hello good day", "hello", "day")); 
```

在 msdn 上阅读它：[正则表达式](http://msdn.microsoft.com/ru-ru/library/hs600312.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T20:06:30.820

您需要为此提供方法：

1.  [指数](http://msdn.microsoft.com/en-us/library/k8b1470s.aspx)
2.  [子串](http://msdn.microsoft.com/en-us/library/aa904308%28v=vs.71%29.aspx)

只需使用 IndexOf 返回的值对这两个词进行子字符串化。

这很简单，如果您需要进一步的帮助 - 请发表评论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T20:12:19.067

您可以使用正则表达式和 string.Split 以保持正则表达式简单：

```
Regex.Match("string here",@"(?<=firstWord).*?(?=secondWord)").Value
    .Split(new char[] {' '}, StringSplitOptions.RemoveEmptyEntries) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-31T20:31:02.630

最初，您有一个字符串，并且您想将前几个字符提取到一个新字符串中。我们可以在这里使用带有两个参数的 Substring 实例方法，第一个是 0，第二个是所需的长度。

使用子字符串的程序 [C#]

```
using System;

class Program
{
    static void Main()
    {
    string input = "OneTwoThree";

    // Get first three characters
    string sub = input.Substring(0, 3);
    Console.WriteLine("Substring: {0}", sub);
    }
} 
```

输出

子串：一

参考[子串](http://www.dotnetperls.com/substring)

# java - Java - 我的排序不起作用

> ID：15733889
> 
> 赞同：0
> 
> 时间：2013-03-31T20:02:02.760
> 
> 标签：java

我创建了以下类来对字符串数组进行排序。

```
public class StringSort {
private String[] hotelNames;
private int arrayLength;

public void sortHotel(String[] hotelArray) {
    if (hotelArray.length <= 1) {
        return;
    }
    this.hotelNames = hotelArray;
    arrayLength = hotelArray.length;
    quicksort(0, arrayLength - 1);
}

private void quicksort(int low, int high) {
    int i = low, j = high;
    String first = hotelNames[low];
    String last = hotelNames[high];     
    String pivot = hotelNames[low + (high - low) / 2];

    while( (first.compareTo(last)) < 0 ) { // first is less than last
        while( (hotelNames[i].compareTo(pivot)) < 0 ) { // ith element is < pivot
            i++;
        }
        while( (hotelNames[j].compareTo(pivot)) > 0) { // jth element is > pivot
            j--;
        }
        if ( ( hotelNames[i].compareTo( hotelNames[j] )) <= 0 ) {
            swap(i, j);
            i++;
            j--;                
        }

        //recursive calls
        if (low < j) {
            quicksort(low, j);
        }
        if (i < high) {
            quicksort(i, high);
        }
    }
}

private void swap(int i, int j) {
    String temp = hotelNames[i];
    hotelNames[i] = hotelNames[j];
    hotelNames[j] = temp;
} 
```

}

但是在我的主类（一个测试 StringSort 的类）中，当我这样做时：

```
StringSort str = new StringSort();
String[] hotel1 = {"zzzz", "wwww", "dddd", "bbbbb", "bbbba", "aaaf", "aaag", "zzz"};
str.sortHotel(hotel1); 
```

然后我有另一种方法可以打印出数组。但是，当它打印出来时，它会按原样输出 hotel1 数组，保持不变。没有“排序”发生，我不确定我哪里出错了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-31T20:12:57.543

在您的快速排序实现中存在几个问题：

1.  **第一次/最后一次比较。**只要第一个元素小于最后一个元素，此代码将使您的快速排序不执行任何操作，无论任何其他顺序如何。

    ```
    while( (first.compareTo(last)) < 0 ) { // first is less than last 
    ```

2.  **交换前检查**。此行是不必要的：

    ```
    if ( ( hotelNames[i].compareTo( hotelNames[j] )) <= 0 ) { 
    ```

你真正想做的是看看是否`i`仍然小于`j`并退出循环。如果没有，那就换吧。完成分区循环后，只要每个子数组中有两个以上的元素，就可以进行递归调用。

# excel - 是否可以通过 Excel 公式中的编号引用整个列？

> ID：15733890
> 
> 赞同：0
> 
> 时间：2013-03-31T20:02:07.303
> 
> 标签：excel, excel-formula

目前我正在尝试使用此公式结构设置动态范围：

```
=OFFSET($A$2,,,COUNTA($A:$A)-1) 
```

然后我修改了公式以在标题行中找到一个关键字：

```
=OFFSET($A$2,,MATCH("THIS",$1:$1,0),COUNTA($A:$A)-1) 
```

我的问题是此时的 COUNTA 语句。我想输入类似的东西，`COUNTA(COLUMN(MATCH("THIS",$1:$1,0)))`但似乎没有这么简单。

相反，我的解决方法是：

```
COUNTA(INDIRECT(LEFT(ADDRESS(1,MATCH("THIS",$1:$1,0)),2)&":"&LEFT(ADDRESS(1,MATCH("THIS",$1:$1,0)),2)))-1 
```

整个公式变得相当冗长和繁琐，我感觉我可能遗漏了一些东西来简化它。有没有一种更简单的方法来做到这一点，类似于简单地评估`COUNTA(Column(10))`或者我的方法是最有效的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T21:06:26.993

试试这个定义

`=OFFSET($A$2,,MATCH("THIS",$1:$1,0)-1,COUNTA(OFFSET($A:$A,,MATCH("THIS",$1:$1,0)-1))-1)`

第二个`OFFSET`获取整列

# authentication - ASP.NET 上的 SSL 证书身份验证。用户按下取消后强制 IE 询问证书

> ID：15733891
> 
> 赞同：2
> 
> 时间：2013-03-31T20:02:12.620
> 
> 标签：authentication, ssl, ssl-certificate

我正在使用 ASP.NET 创建 SSL 身份验证。哪些用户启动了站点，我们看到一个选择证书的窗口（IIS 配置为接受用户证书）。它看起来像这样。

![在此处输入图像描述](https://i.stack.imgur.com/fQ1Zt.png)

我们这里有 2 个按钮：确定和取消。用户单击确定后，我从证书中获取一些信息并进行身份验证。

在下一页用户可以进行一些活动或按下按钮来更改用户。这是网络表单按钮代码

```
<asp:Image runat="server" src="img/btnChangeUser.jpg" Style="cursor: pointer;" onclick="document.execCommand('ClearAuthenticationCache'); document.location.reload(true); return false;"
                                    ID="Image1"></asp:Image> 
```

如果用户想使用其他证书 onclick javascript 部分完美

```
document.execCommand('ClearAuthenticationCache'); 
document.location.reload(true); 
```

我们清除 SSL 状态并重新加载页面。但是，如果用户在下一页按下取消，我需要告诉他没有证书就无法使用网站并添加按钮将再次打开此窗口以进行证书选择。不幸的是，与证书更改相同的代码不起作用。你有什么想法为什么？用户按下取消后，如何使用 javascript 使网站正常工作？即使我清理 ClearAuthenticationCache，页面刷新也不起作用并且窗口不会出现。

# ruby-on-rails - 试图在 OSX Mountain Lion 上安装 Ruby/Rails

> ID：15733894
> 
> 赞同：2
> 
> 时间：2013-03-31T20:02:38.670
> 
> 标签：ruby-on-rails, ruby, macos

这是我的第一个问题，请友好。

我一直在尝试使用 ruby​​/rails 来完成一个小型编码项目。我有 Mountain Lion，并且一直在尝试使用我在 stackoverflow 和互联网上发现的各种技术。它不会那么好！当然没有任何效果。到目前为止，我拥有 Ruby 的系统版本（1.8.7），以及由于尝试安装 Ruby 而失败而导致的一堆破垃圾！

当我通过 gem install 安装 Rails 时，它坐了一会儿......我终于学会了使用 -V，并注意到一切都返回 302，这需要很长时间，最后它安装 - 当我尝试时得到这个输出运行导轨 -v

/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems.rb:230:in `activate': 无法为 [ 激活机架（~> 1.4.5，运行时） "actionpack-3.2.13", "railties-3.2.13"]，已经为 ["rack-ssl-1.3.3", "railties-3.2.13"] 激活 rack-1.5.2 (Gem::LoadError)

看起来一些依赖关系被破坏了？无论如何，我现在正在尝试使用 RVM 来获取另一个版本的 ruby​​ 并使用 brew 设置 grails，这告诉我我需要更新版本的 ruby​​ 来安装任何东西？这是输出。

rvm install 1.9.2-head osx 的安装要求，可能需要 sudo 密码。跳过`brew update`确保您的公式是最新的。懦弱地拒绝继续，请阅读“rvm autolibs”。

要继续 rvm，需要安装 ruby​​-1.9|ruby-2 兼容的 ruby​​。我们试图自动安装 ruby​​，但它失败了。请手动安装（或兼容的替代方案）以继续。

-- 我在这里让操作系统感到沮丧，请给我一根骨头并帮助我 --- 如果我不得不设置一个 linux vm 只是为了让 rails 运行 -- 但我更喜欢在我的 mac 上工作。

请给点建议？？我只想在我的 Mac 上运行 Rails 3 的工作版本，这一切都提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:06:42.233

请通过 www.railsinstaller.org 了解详细的安装和设置过程。本指南应回答您的所有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T20:11:23.747

您是否尝试过本教程[http://net.tutsplus.com/tutorials/ruby/how-to-install-ruby-on-a-mac/](http://net.tutsplus.com/tutorials/ruby/how-to-install-ruby-on-a-mac/) 本教程包含您在安装过程中可能遇到的所有错误。根据本教程 Ruby on Rail 自带 mac 开箱即用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T20:49:37.363

你试过珠宝盒吗？它为 rvm 和一个很棒的小 gui 提供了一种轻松的安装方法，可以帮助您监控 gem 集的大小和 ruby​​ 的安装。以及升级 rvm 的有用提醒。起初我拒绝使用它，因为使用 GUI 让我觉得自己像个菜鸟，但它确实是一个很棒的小工具，可以超级轻松地安装 ruby​​ 和 rvm，从而安装 rails。

[http://jewelrybox.unfiniti.com/](http://jewelrybox.unfiniti.com/)

# git - 在 Github 上创建自己的仓库时的最佳实践

> ID：15733899
> 
> 赞同：7
> 
> 时间：2013-03-31T20:03:15.260
> 
> 标签：git, github

github上有一个我想构建的repo。这样做的最佳做法是什么？这是我所做的：

1）分叉回购。2）开始一个新的回购。3) 将分叉的 repo 的远程源 url 更改为新的 repo。4）将新repo的本地副本推送到github。

这为我提供了新存储库的“起点”，但是，我仍然拥有原始存储库的提交历史记录等。保留此类内容的最佳实践/礼仪是什么（而不是删除提交历史记录并从头开始。）

无论我做什么，原作者都会得到充分的信任，但提交历史似乎会让想要使用我的仓库的人感到困惑。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-31T21:49:14.450

> 一旦我开始添加功能/代码，它会有所不同，但提交历史将是相同的。这是预期的事情吗？

[是的，但是 fork 背后的真正想法是您可以通过pull request](https://help.github.com/articles/using-pull-requests)回馈给`upstream`repo（即您在 GitHub 上 fork 的 repo）。

这就是为什么您通常不只是将原始 url 更改为新的 repo，您​​还注册了一个远程 repo ' `upstream`' 指的是您分叉的原始 repo。

![叉](https://i.stack.imgur.com/AwpCH.png)

另一个想法，即使你不回馈，也是跟上任何来自`upstream`: you can的演变`git fetch upstream`，并合并或 rebase 来自上游的任何你想要的新提交。

# c# - 动态创建代理类

> ID：15733900
> 
> 赞同：40
> 
> 时间：2013-03-31T20:03:23.743
> 
> 标签：c#, .net, reflection, proxy

我正在尝试动态创建代理类。我知道有一些非常好的框架可以做到这一点，但这纯粹是一个作为学习练习的宠物项目，所以我想自己做。

例如，如果我有以下类实现一个接口：

```
interface IMyInterface
{
    void MyProcedure();
}

class MyClass : IMyInterface
{
    void MyProcedure()
    {
        Console.WriteLine("Hello World");
    }
} 
```

为了拦截此类的方法以记录它们，我正在创建另一个类（我的代理类版本），它实现了相同的接口但包含对“真实”类的引用。这个类执行一个动作（例如记录），然后在真实类上调用相同的方法。

例如：

```
class ProxyClass : IMyInterface
{
    private IMyInterface RealClass { get; set; }

    void MyProcedure()
    {
        // Log the call
        Console.WriteLine("Logging..");

        // Call the 'real' method
        RealClass.MyProcedure();
    }
} 
```

然后调用者调用代理类上的所有方法（我使用一个基本的自制 IoC 容器来注入代理类来代替真实类）。我使用这种方法是因为我希望能够`RealClass`在运行时换出另一个实现相同接口的类。

有没有办法`ProxyClass`在运行时创建并填充其`RealClass`属性，以便它可以用作真实类的代理？有没有一种简单的方法可以做到这一点，还是我需要使用类似`Reflection.Emit`的东西并生成 MSIL？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2013-03-31T20:22:37.957

看看[System.Runtime.Remoting.Proxies.RealProxy](http://msdn.microsoft.com/en-us/library/system.runtime.remoting.proxies.realproxy.aspx)。您可以使用它来创建一个从调用者的角度来看似乎是目标类型的实例。RealProxy.Invoke 提供了一个点，您可以从该点简单地调用底层类型的目标方法或在调用之前/之后执行额外的处理（例如日志记录）。

这是在每次方法调用之前/之后记录到控制台的代理示例：

```
public class LoggingProxy<T> : RealProxy
{
    private readonly T _instance;

    private LoggingProxy(T instance)
        : base(typeof(T))
    {
        _instance = instance;
    }

    public static T Create(T instance)
    {
        return (T)new LoggingProxy<T>(instance).GetTransparentProxy();
    }

    public override IMessage Invoke(IMessage msg)
    {
        var methodCall = (IMethodCallMessage)msg;
        var method = (MethodInfo)methodCall.MethodBase;

        try
        {
            Console.WriteLine("Before invoke: " + method.Name);
            var result = method.Invoke(_instance, methodCall.InArgs);
            Console.WriteLine("After invoke: " + method.Name);
            return new ReturnMessage(result, null, 0, methodCall.LogicalCallContext, methodCall);
        }
        catch (Exception e)
        {
            Console.WriteLine("Exception: " + e);
            if (e is TargetInvocationException && e.InnerException != null)
            {
                return new ReturnMessage(e.InnerException, msg as IMethodCallMessage);
            }

            return new ReturnMessage(e, msg as IMethodCallMessage);
        }
    }
} 
```

以下是您将如何使用它：

```
IMyInterface intf = LoggingProxy<IMyInterface>.Create(new MyClass());
intf.MyProcedure(); 
```

控制台的输出将是：

调用前：MyProcedure
Hello World
调用后：MyProcedure

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T21:20:32.487

我不建议这样做。通常你会使用一些著名的库，例如 Castle 或 EntLib。对于一些复杂的类，动态生成代理可能是一个相当大的挑战。这是一个使用“Is”多态性的示例。为此，您必须将 base 中的所有方法声明为虚拟方法。您尝试执行此操作的方式（“有”）也是可能的，但对我来说看起来更复杂。

```
public class A
{
    public virtual void B()
    {
        Console.WriteLine("Original method was called.");
    }
}

class Program
{

    static void Main(string[] args)
    {
        // Create simple assembly to hold our proxy
        AssemblyName assemblyName = new AssemblyName();
        assemblyName.Name = "DynamicORMapper";
        AppDomain thisDomain = Thread.GetDomain();
        var asmBuilder = thisDomain.DefineDynamicAssembly(assemblyName,
                     AssemblyBuilderAccess.Run);

        var modBuilder = asmBuilder.DefineDynamicModule(
                     asmBuilder.GetName().Name, false);

        // Create a proxy type
        TypeBuilder typeBuilder = modBuilder.DefineType("ProxyA",
           TypeAttributes.Public |
           TypeAttributes.Class |
           TypeAttributes.AutoClass |
           TypeAttributes.AnsiClass |
           TypeAttributes.BeforeFieldInit |
           TypeAttributes.AutoLayout,
           typeof(A));
        MethodBuilder methodBuilder = typeBuilder.DefineMethod("B", MethodAttributes.Public | MethodAttributes.Virtual | MethodAttributes.ReuseSlot);
        typeBuilder.DefineMethodOverride(methodBuilder, typeof(A).GetMethod("B"));

        // Generate a Console.Writeline() and base.B() calls.
        ILGenerator ilGenerator = methodBuilder.GetILGenerator();
        ilGenerator.Emit(OpCodes.Ldarg_0);
        ilGenerator.EmitWriteLine("We caught an invoke! B method was called.");

        ilGenerator.EmitCall(OpCodes.Call, typeBuilder.BaseType.GetMethod("B"), new Type[0]);
        ilGenerator.Emit(OpCodes.Ret);

        //Create a type and casting it to A. 
        Type type = typeBuilder.CreateType();
        A a = (A) Activator.CreateInstance(type);

        // Test it
        a.B();
        Console.ReadLine();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-31T21:22:04.767

[您可以使用此问题](https://stackoverflow.com/questions/8387004/how-to-make-a-simple-dynamic-proxy-in-c-sharp)中描述的动态对象，但对于动态生成的强类型对象，您必须使用`Reflection.Emit`，正如您所怀疑的那样。[此博客](http://geekswithblogs.net/abhijeetp/archive/2010/04/04/a-simple-dynamic-proxy.aspx)有示例代码显示类型的动态创建和实例化。

我已经读到[Roslyn](http://msdn.microsoft.com/en-us/vstudio/roslyn.aspx)具有使创建动态代理更容易的功能，所以也可以看看那里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-31T20:29:50.910

也许我误解了这个问题，构造函数怎么样？

```
class ProxyClass : IMyInterface
{
    public ProxyClass(IMyInterface someInterface)
    {
        RealClass = someInterface;
    }
   // Your other code...
} 
```

# android - 在运行时更改 AlertDialog 中的文本

> ID：15733901
> 
> 赞同：0
> 
> 时间：2013-03-31T20:03:33.703
> 
> 标签：android, android-alertdialog, settext

我想在运行时更改 AlertDialog 中的文本，但它还没有真正起作用。

由于我使用的是自定义布局，我认为我可以这样做，

```
AlertDialog.Builder dialog_item_detail = new AlertDialog.Builder(this);   

LayoutInflater inflate_dialog = getLayoutInflater();
TextView mjollnir_descr = (TextView)findViewById(R.id.dialog_item_descr);
mjollnir_descr.setText(R.string.item_detail_mjollnir_descr);        

dialog_item_detail.setIcon(R.drawable.item_clarity);
dialog_item_detail.setView(inflate_dialog.inflate(R.layout.item_dialog, null));     
dialog_item_detail.create();

dialog_item_detail.setTitle(R.string.dialog_item_detail_title_clarity);   
//dialog_item_detail.setCancelable(true);   
dialog_item_detail.setNeutralButton(android.R.string.ok, new DialogInterface.OnClickListener() {  
   public void onClick(DialogInterface dialog, int whichButton){               
   }   
   });   

dialog_item_detail.show(); 
```

但如上所述，它不起作用。我总是在上面代码的第二行收到这个错误：

```
03-31 19:45:25.261: E/AndroidRuntime(781): FATAL EXCEPTION: main
03-31 19:45:25.261: E/AndroidRuntime(781): java.lang.IllegalStateException: Could not execute method of the activity
03-31 19:45:25.261: E/AndroidRuntime(781): Caused by: java.lang.NullPointerException
03-31 19:45:25.261: E/AndroidRuntime(781):  at com.myapp.ItemsOverview.show_details_mjollnir(ItemsOverview.java:81) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:05:52.770

**编辑：**

```
AlertDialog.Builder dialog_item_detail = new AlertDialog.Builder(this);   

    LayoutInflater inflate_dialog = getLayoutInflater();
View v=inflate_dialog.inflate(R.layout.item_dialog, null);
    TextView mjollnir_descr = (TextView)v.findViewById(R.id.dialog_item_descr);
    mjollnir_descr.setText(R.string.item_detail_mjollnir_descr);        

    dialog_item_detail.setIcon(R.drawable.item_clarity);
    dialog_item_detail.setView(v);     
    dialog_item_detail.create();

    dialog_item_detail.setTitle(R.string.dialog_item_detail_title_clarity);   
    //dialog_item_detail.setCancelable(true);   
    dialog_item_detail.setNeutralButton(android.R.string.ok, new DialogInterface.OnClickListener() {  
       public void onClick(DialogInterface dialog, int whichButton){               
       }   
       });   
dialog_item_detail.show(); 
```

* * *

你会得到`NullPointerException`，因为你`TextView`是空的。

因为您没有从对话框的膨胀视图（即您的 customView）中获取它

IE

尝试

```
TextView mjollnir_descr = (TextView)yourview. findViewById(R.id.dialog_item_descr); 
```

这里

`yourview`是 TextView 所在对话框的膨胀视图

# ruby - Intellij IDEA 中的 Ruby 设置

> ID：15733905
> 
> 赞同：13
> 
> 时间：2013-03-31T20:03:48.810
> 
> 标签：ruby, intellij-idea

这可能很明显，但我无法在 Intellij 项目设置、编译器、插件等中找到 ruby​​ interpeter 路径以及任何其他可用的 ruby​​ 设置。

我确实安装了最新版本的 ruby​​ 插件，并且正在使用 intellij 12.0.4 Ultimate。

感谢（可能很容易）的建议。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-01T13:44:50.670

在 IntelliJ IDEA 中，所有的 SDK 都可以在`File`|中配置。`Project Structure`| [开发工具包](http://www.jetbrains.com/idea/webhelp/sdks.html)。

# javascript - jquery mobile未在asp.net mvc4 SPA中加载自定义脚本

> ID：15733906
> 
> 赞同：0
> 
> 时间：2013-03-31T20:03:50.077
> 
> 标签：javascript, jquery-mobile, asp.net-mvc-4

有问题的脚本是 app.js。

我已将此自定义脚本放在 jquery.min.js 和 jquery.mobile.js 之间的 _layout.Mobile.cshtml 部分中。

```
 @* one recommendation to load custom scripts but does not work *@
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
    @*<script src="@Url.Content("~/Scripts/kendo.web.min.js")" type="text/javascript"></script>   *@
    @*<script src="http://openlayers.org/api/OpenLayers.js" type="text/javascript"></script>*@
    <script src="@Url.Content("~/Scripts/app.js?45")" type="text/javascript"></script>

    @*@Scripts.Render("~/bundles/modernizr")
    @Scripts.Render("~/bundles/3rdparties")*@

    <script src=@Url.Content("http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js") type="text/javascript"></script>
</head> 
```

我还尝试在 Index.Mobile.cshtml 中具有属性 role=page 的第一个元素之后立即引用脚本。

```
<div data-role="page" id="agencies-pane">
   <script src="@Url.Content("~/Scripts/app.js?45")" rel="external" type="text/javascript"></script>
    <div data-role="header" class="header"><h1><a>Agencies</a></h1></div> 
```

在这两种情况下，我的自定义脚本都不会加载。真是浪费了一个下午:(

我不想禁用 Ajax，即使我尝试过并且失败了。[即使仔细阅读此处](http://jquerymobile.com/demos/1.1.0/docs/pages/page-scripting.html)的说明，似乎也无法让 jQM 工作

有人有想法么？

# c++ - 调用函数时的g ++编译器错误（向量 > &)

> ID：15733907
> 
> 赞同：0
> 
> 时间：2013-03-31T20:03:57.420
> 
> 标签：c++, pass-by-reference, stdvector

谁能告诉我为什么这个简单的函数调用会返回底部显示的编译器错误？

```
//This is a type definition that I use below to simplify variable declaration
typedef vector<int> islice;
typedef vector<islice> int2D;
// therefore int2D is of type  vector<vector<int> >

// This is the function prototype in the DFMS_process_spectra_Class.hh file
int DumpL2toFile(int2D&);

// This is the type declaration in the caller
int2D L2Data;

// This is the function call where error is indicated
int DumpL2toFile(L2Data);      (**line 90 - error indicated here**)

// this is the function body 
int DFMS_process_spectra_Class::DumpL2toFile(int2D& L2) {

    string file=sL3Path+L2Info.fileName;
    fstream os;
    os.open(file.c_str(), fstream::out);
    os << "Pixel   A-counts   B-counts" << endl;
    char tmp[80];
    for (int i=0; i<512; ++i) {
        sprintf(tmp,"%5d    %8d    %8d\n",L2[i][0],L2[i][1],L2[i][2]);
        os << string(tmp) << endl;
    }

    os.close();

    return 1;
} 
```

//这是编译命令和错误

```
g++ -w -g -c src/DFMS_process_spectra_Class.cc -o obj/DFMS_process_spectra_Class.o
src/DFMS_process_spectra_Class.cc: 
In member function 'int   DFMS_process_spectra_Class::processL2()':
 src/DFMS_process_spectra_Class.cc:90: error: 
                      cannot convert 'int2D' to 'int' in initialization 
```

为什么编译器会`int2D&`混淆`int`？调用、函数原型和函数的`int2D`类型一致！！

//这是我在 Mac OS X 10.8.3 上的编译器版本 i686-apple-darwin11-llvm-g++-4.2

顺便说一句，这与我在使用 g++ 4.3 的 Linux 机器上遇到的错误相同

感谢您的帮助，迈克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T22:02:27.323

```
// This is the function call where error is indicated
int DumpL2toFile(L2Data);      (**line 90 - error indicated here**) 
```

That's not a function call! Assuming that this line occurs inside a function body (which is not clear from your code), the function call would be:

```
DumpL2toFile(L2Data); // No int 
```

OP, that's all you need to know. But if you are curious, the compiler is parsing your statement as if it were

```
int AnyOldIdentifier(L2Data); 
```

which is a declaration of an `int` variable called `AnyOldIdentifier`, initialised to the value `L2Data`. And it can't initialise an `int` to `L2Data`, because `L2Data` is an `int2D`, not an `int`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T20:10:15.860

您在这一行有语法错误：

```
 // This is the function call where error is indicated
  int DumpL2toFile(L2Data);      (**line 90 - error indicated here**) 
```

如果你打电话`DumpL2toFile`。您不再需要返回类型。这样，编译器将其视为函数声明，但是，`L2Data`它不是类型，而是 的对象`int2D`，这会触发编译错误

同时，编译错误说错误 insde`processL2()`函数，而您没有发布这部分的代码。

# java - 在二叉搜索树中找到第 n 个节点

> ID：15733921
> 
> 赞同：2
> 
> 时间：2013-03-31T20:04:50.307
> 
> 标签：java, recursion, project, binary-search-tree

大家好，我正在使用二叉搜索树进行课程项目。我在尝试查找二叉搜索树的第 n 个节点时遇到了麻烦。我理解使用顺序遍历和使用计数器的概念，但我无法将其放入代码中。如果有人可以提供帮助，将不胜感激。抱歉，代码太长了。有问题的方法就是`nthElement(int n, BinaryNode<AnyType> t)`方法。我不知道如何增加计数器。

```
package proj2;

// BinarySearchTree class
//
// CONSTRUCTION: with no initializer
//
// ******************PUBLIC OPERATIONS*********************
// void insert( x )       --> Insert x
// void remove( x )       --> Remove x
// boolean contains( x )  --> Return true if x is present
// Comparable findMin( )  --> Return smallest item
// Comparable findMax( )  --> Return largest item
// boolean isEmpty( )     --> Return true if empty; else false
// void makeEmpty( )      --> Remove all items
// void printTree( )      --> Print tree in sorted order
// ******************ERRORS********************************
// Throws UnderflowException as appropriate

/**
 * Implements an unbalanced binary search tree.
 * Note that all "matching" is based on the compareTo method.
 * @author Mark Allen Weiss
 */
public class BinarySearchTree<AnyType extends Comparable<? super AnyType>>
{
/** The tree root. */
private BinaryNode<AnyType> root;

/** The tree size. */
private int treeSize;

/**
 * Construct the tree.
 */
public BinarySearchTree( )
{
    root = null;
}

/**
 * Insert into the tree; duplicates are ignored.
 * @param x the item to insert.
 */
public void insert( AnyType x )
{
    root = insert( x, root );
}

/**
 * Remove from the tree. Nothing is done if x is not found.
 * @param x the item to remove.
 */
public void remove( AnyType x )
{
    root = remove( x, root );
}

/**
 * Find the smallest item in the tree.
 * @return smallest item or null if empty.
 */
public AnyType findMin( )
{
    if( isEmpty( ) )
        throw new UnderflowException( );
    return findMin( root ).element;
}

/**
 * Find the largest item in the tree.
 * @return the largest item of null if empty.
 */
public AnyType findMax( )
{
    if( isEmpty( ) )
        throw new UnderflowException( );
    return findMax( root ).element;
}

/**
 * Find an item in the tree.
 * @param x the item to search for.
 * @return true if not found.
 */
public boolean contains( AnyType x )
{
    return contains( x, root );
}

/**
 * Count the number of nodes in the tree.
 * @return the tree size.
 */
public int treeSize(){

    treeSize = treeSize(root);
    return treeSize;

}

/**
 * Make the tree logically empty.
 */
public void makeEmpty( )
{
    root = null;
}

/**
 * Test if the tree is logically empty.
 * @return true if empty, false otherwise.
 */
public boolean isEmpty( )
{
    return root == null;
}

/**
 * Print the tree contents in sorted order.
 */
public void printTree( )
{
    if( isEmpty( ) )
        System.out.println( "Empty tree" );
    else
        printTree( root );
}

public BinaryNode<AnyType> nthElement(int n){

    return nthElement(n, root);

}

/**
 * Internal method to insert into a subtree.
 * @param x the item to insert.
 * @param t the node that roots the subtree.
 * @return the new root of the subtree.
 */
private BinaryNode<AnyType> insert( AnyType x, BinaryNode<AnyType> t )
{
    if( t == null )
        return new BinaryNode<AnyType>( x, null, null );

    int compareResult = x.compareTo( t.element );

    if( compareResult < 0 )
        t.left = insert( x, t.left );
    else if( compareResult > 0 )
        t.right = insert( x, t.right );
    else
        ;  // Duplicate; do nothing
    return t;
}

/**
 * Internal method to remove from a subtree.
 * @param x the item to remove.
 * @param t the node that roots the subtree.
 * @return the new root of the subtree.
 */
private BinaryNode<AnyType> remove( AnyType x, BinaryNode<AnyType> t )
{
    if( t == null )
        return t;   // Item not found; do nothing

    int compareResult = x.compareTo( t.element );

    if( compareResult < 0 )
        t.left = remove( x, t.left );
    else if( compareResult > 0 )
        t.right = remove( x, t.right );
    else if( t.left != null && t.right != null ) // Two children
    {
        t.element = findMin( t.right ).element;
        t.right = remove( t.element, t.right );
    }
    else
        t = ( t.left != null ) ? t.left : t.right;
    return t;
}

/**
 * Internal method to find the smallest item in a subtree.
 * @param t the node that roots the subtree.
 * @return node containing the smallest item.
 */
private BinaryNode<AnyType> findMin( BinaryNode<AnyType> t )
{
    if( t == null )
        return null;
    else if( t.left == null )
        return t;
    return findMin( t.left );
}

/**
 * Internal method to find the largest item in a subtree.
 * @param t the node that roots the subtree.
 * @return node containing the largest item.
 */
private BinaryNode<AnyType> findMax( BinaryNode<AnyType> t )
{
    if( t != null )
        while( t.right != null )
            t = t.right;

    return t;
}

/**
 * Internal method to find an item in a subtree.
 * @param x is item to search for.
 * @param t the node that roots the subtree.
 * @return node containing the matched item.
 */
private boolean contains( AnyType x, BinaryNode<AnyType> t )
{
    if( t == null )
        return false;

    int compareResult = x.compareTo( t.element );

    if( compareResult < 0 )
        return contains( x, t.left );
    else if( compareResult > 0 )
        return contains( x, t.right );
    else
        return true;    // Match
}

/**
 * Internal method to print a subtree in sorted order.
 * @param t the node that roots the subtree.
 */
private void printTree( BinaryNode<AnyType> t )
{
    if( t != null )
    {
        printTree( t.left );
        System.out.println( t.element );
        printTree( t.right ); 
    }
}

/**
 * Internal method for traversing the tree in-order.
 * @param t the node that roots the subtree.
 * @return 
 */
  private void nthElement(int n, BinaryNode<AnyType> t){

    int i = t.treeSize;
    if(t.left.treeSize == n){
        System.out.println(t.element);
    }else if(t.left.treeSize > n){
        nthElement(n, t.left);
    }else if(t.left.treeSize < n){
        int k = i - t.left.treeSize;
        nthElement(k, t.right);
    }
}

/** 
 * Internal method for finding tree size.
 * @param t the node that roots the subtree.
 * @return the number of nodes.
 */
private int treeSize(BinaryNode<AnyType> t){

    int size = 1;                                      
    if(t.right != null){
        size = size + treeSize(t.right);        
    }
    if(t.left != null){
        size = size + treeSize(t.left);          
    }
    return t.treeSize = size;
} 

/**
 * Internal method to compute height of a subtree.
 * @param t the node that roots the subtree.
 */
private int height( BinaryNode<AnyType> t )
{
    if( t == null )
        return -1;
    else
        return 1 + Math.max( height( t.left ), height( t.right ) );    
}

// Basic node stored in unbalanced binary search trees
private static class BinaryNode<AnyType>
{
        // Constructors
    BinaryNode( AnyType theElement )
    {
        this( theElement, null, null );
    }

    BinaryNode( AnyType theElement, BinaryNode<AnyType> lt, BinaryNode<AnyType> rt )
    {
        element  = theElement;
        left     = lt;
        right    = rt;
    }

    AnyType element;            // The data in the node
    BinaryNode<AnyType> left;   // Left child
    BinaryNode<AnyType> right;  // Right child
}

    // Test program
public static void main( String [ ] args )
{
    BinarySearchTree<Integer> t = new BinarySearchTree<Integer>( );
    final int NUMS = 10;
    final int GAP  = 1;

    System.out.println( "Checking... (no more output means success)" );

    t.insert(55);
    t.insert(40);
    t.insert(35);
    t.insert(60);
    t.insert(70);
    t.insert(80);

    System.out.println("this is tree size: " + t.treeSize());
    int n = t.root.left.treeSize;
    System.out.println(n);
    t.nthElement(3);

}
} 
```

编辑：我已经修改了`nthElement(int n, BinaryNode<AnyType> t)`and`treeSize(BinaryNode<AnyType t>`方法。`NullPointerException`现在的问题是，除了 2 和 3 之外，我输入的任何数字都会得到 a 。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T02:23:47.660

问题是您需要从递归函数（或多个函数）返回计数和节点。如果你把它交给我，我会以一种会给你带来麻烦的方式来做:)

```
对象 nthElement(int n, BinaryNode t)
{
    // 我们在正确的节点上，返回它。
    if(n == 1) // 我会以 1 为基础，所以传入 1 会返回第一个元素。
         返回 t;

    // 检查树的左侧。
    如果（t.left！= null）{
        对象 o=nthElement(n-1, t.left);
        // 我们找到了正确的节点。
        if(o instanceof BinaryNode)
            返回 o;
        // 我们没有找到它，但让我们数一下我们找到的那些。（这就是“诀​​窍”）
        n=(整数)o;
    }
    // 我们没有更多的孩子，让我们返回我们当前的计数。
    如果（t.right == null）
        返回 n;

    // 右递归
    返回（nthElement（n-1，t.right）；
}

```

这是未经测试的手工编码，我经常在快速未经测试的代码上犯下巨大的逻辑错误，但这个概念是合理的。任何称职的老师都可能无法回答这个问题，因为返回值有两种完全不同的不相关类型，我正在修改一个参数，但我想给你留下一些乐趣！

用法必须检查返回值，如果它是 BinaryNode 的实例，如果不是树没有足够的节点，那就太好了。

也只是为了好玩，我认为 -(int)nthElement(0, t) 计算树中的节点数。

“真实”递归解决方案将返回一个带有 BinaryNode 和计数的新可变对象。当它被传递时，您将修改计数，为访问的每个节点减去 1，当您点击 0 时，您返回对象并将其提取为“BinaryNode”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T23:32:47.243

您最简单（但效率最低）的方法类似于：

```
// Ignoring the possibility that there may not be n elements in the tree.
int leftSize = treeSize(t.left);
// If the size of the left tree is greater than n then the nth element must be up the left branch.
if ( leftSize >= n ) {
  return nthElement(n-1, t.left);
} else {
  // Otherwise it must be up the right branch.
  return nthElement(n-leftSize, t.right);
} 
```

但是，最好执行一次`Iterator`，然后逐步执行 n 次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-15T08:16:43.087

这对我来说没问题。在保持计数的同时按顺序遍历树。

```
 int c = 0;
    public void findNth(int n, IntTree t) {

    if(!IntTree.isEmpty(t)) {
        findNth(n, t.left);
        c++;
        if(c==n)
            System.out.println("The element on position "+n+" is " + IntTree.value(t));
        findNth(n, t.right);

    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-29T01:23:37.967

我被震惊了两天解决了这个问题。我能够打印第 n 个到最后一个元素。但是退货有困难。终于可以使用下面的代码解决了：

```
 public class BinarySearchTree {

    Node root;

    public Node findNth(int n){
        if(root == null)
            return null;

        NodeCounter myNode = new NodeCounter();

        findNth(root,n, myNode);
        return myNode.node;
    }

    private void findNth(Node head, int n, NodeCounter nodeObj){

        if(head == null)
            return;

        findNth(head.left, n ,nodeObj);
        nodeObj.counter = nodeObj.counter + 1;
        if(n == nodeObj.counter){
            nodeObj.node = head;
            return;
        }
        if(n > nodeObj.counter)
            findNth(head.right,n,nodeObj);

    }

}

private class NodeCounter{
        Node node;
        int counter = 0;
}
class Node{
    Node left;
    Node right;
    int data;

    public Node getLeft() {
        return left;
    }

    public Node getRight() {
        return right;
    }

} 
```

# c# - 按每个 x 索引出现对列表的一些字符串进行分组

> ID：15733925
> 
> 赞同：-2
> 
> 时间：2013-03-31T20:05:04.367
> 
> 标签：c#, linq

```
var strings = new List<string> 
{ "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p" };

int rotation = 4; // could also be 1,2,3,4,5,6,7,8 but 4 is for the sample 
```

我想查询字符串列表并返回包含此数据的匿名类型的分组列表：

```
group0: a,b,c,d,i,j,k,l
group1: d,e,f,g,m,n,o,p 
```

如果**旋转**为**2**，那将是另一个样本：

```
group0: a,b,e,f,i,j,m,n
group1: c,d,g,h,k,l,o,p 
```

不知何故，我必须检查每个字符串及其索引位置，找到一个聪明的算法并将其与 4 的旋转结合起来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T20:12:46.493

使用 Select 接受索引参数的版本。然后取 mod (%) 运算符，看看得到的数字是偶数还是奇数。（索引 % 大小 % 2 == 0）。

您可以选择带有值的元组或匿名类型以及它是偶数/奇数。然后 GroupBy 使用偶数/奇数作为组键，值作为组值。

```
values.Select ((value, index) => 
    new 
    {
        Value = value,
        First = index % size % 2 == 0
    }
).GroupBy(pair => pair.First, pair => pair.Value) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T20:10:11.860

也许是这样：

```
var group0 = strings.Where((s, i) => (i/rotation)%2 == 0).ToArray();
var group1 = strings.Where((s, i) => (i / rotation) % 2 == 1).ToArray(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T20:22:07.747

```
var strings = new List<string> { "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p" };
int rotation = 2;

int inx = 0;
var groups = strings.GroupBy(s => (inx++ / rotation)%2)
                    .Select(g => g.ToList())
                    .ToList(); 
```

# ruby-on-rails - 导轨控制器的问题

> ID：15733936
> 
> 赞同：0
> 
> 时间：2013-03-31T20:06:25.147
> 
> 标签：ruby-on-rails

我有一个控制器页面如下：

```
class PagesController < ApplicationController
  def home
  end

  def about
  end

  def login
  end

end 
```

我也有相应的视图，在我的 routes.rb 中，我有以下内容

```
devise_for :users

  get 'log in' => 'pages#login'
  get 'about' => 'pages#about'

  root :to => 'pages#home' 
```

当我尝试进入登录页面时，它给了我一个错误：

#<#:0x2b9a298> 的未定义局部变量或方法 `login_path'

我尝试将控制器与操作匹配，同样的错误。我是 Rails 的新手，我试图了解我做错了什么，因为它适用于“关于”页面。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:10:26.743

您的路线应该是：

```
match 'login', :to => "pages#login", :as => :login
match 'about', :to => "pages#about", :as => :about 
```

要了解有关 Rails 路由的更多信息，请查看[路由指南](http://guides.rubyonrails.org/routing.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T20:13:28.683

```
get 'log in' => 'pages#login' 
```

“登录”中是否有空格，或者它就是这里的显示方式？

我认为 Devise 在自定义路线方面也有一些特殊设置。这是他们 GitHub 页面上提供的示例：devise_for :users, :path => "auth", :path_names => { :sign_in => 'login', :sign_out => 'logout', :password => 'secret' , :confirmation => '验证', :unlock => '解锁', :registration => '注册', :sign_up => 'cmon_let_me_in' }

它位于配置路由下的[https://github.com/plataformatec/devise 。](https://github.com/plataformatec/devise)

# java - 在 Java 的协议层提取数据最不痛苦的方法是什么？

> ID：15733939
> 
> 赞同：1
> 
> 时间：2013-03-31T20:06:41.970
> 
> 标签：java, network-programming, byte

我正在尝试实现一个 Android 应用程序来连接到开源软件 Motion。目标是能够检查应用程序的状态并获取最后捕获的图​​像。

我不太会用 Java 编程，我的背景主要是 C 和 Python。我在理解 Android 的 UI 部分方面没有遇到任何真正的问题，但我发现使用任何类型的字节缓冲区都非常痛苦。Motion 软件有一个非常简单的 HTTP API。在 Java 中打开 URL 连接很容易。默认页面的响应如下所示

```
Motion 3.2.12 Running [4] Threads
0
1
2
3 
```

出于我的目的，应用程序需要做的第一件事就是解析线程数。在某些时候，我还可以从第一行检索版本号，但这目前并不重要。

这是我的代码

```
package com.hydrogen18.motionsurveillanceviewer;

import java.io.BufferedInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.net.HttpURLConnection;
import java.net.URL;

import java.util.List;

public class MotionHttpApi {
    String host;
    int port = 80;
    boolean secure = false;

    int numberOfThreads = -1;

    String getBaseUrl()
    {
        StringBuilder sb = new StringBuilder();

        sb.append(secure ? "https://" : "http://");
        sb.append(host);
        sb.append(':');
        sb.append(port);

        return sb.toString();
    }

    public int getNumberOfCameras() throws IOException
    {
        if(numberOfThreads == -1)
        {
            retrieveSplash();
        }

        if(numberOfThreads == 1)
        {
            return 1;
        }
        return numberOfThreads - 1;
    }
    void retrieveSplash () throws IOException
    {
        URL url = new URL(getBaseUrl());

        HttpURLConnection conn = (HttpURLConnection)url.openConnection();

        if(conn.getResponseCode()!=HttpURLConnection.HTTP_OK)
        {
            throw new IOException("Got response code" + conn.getResponseCode());
        }

        try{
            Byte[] buffer = new Byte[512];
            byte[] sbuf = new byte[128];
            int offset = 0;
            InputStream in = new BufferedInputStream(conn.getInputStream());

            boolean foundInfoString= false;
            while( ! foundInfoString)
            {
                //Check to make sure we have not run out of space
                if(offset == buffer.length)
                {
                    throw new IOException("Response too large");
                }

                //Read into the smaller buffer since InputStream
                //can't write to a Byte[]
                final int result = in.read(sbuf,0,sbuf.length);

                //Copy the data into the larger buffer
                for(int i = 0; i < result;++i)
                {
                    buffer[offset+i] = sbuf[i];
                }
                //Add to the offset
                offset+=result;

                //Wrap the array as a list
                List<Byte> list = java.util.Arrays.asList(buffer);  

                //Find newline character
                final int index = list.indexOf((byte) '\n');

                //If the newline is present, extract the number of threads
                if (index != -1)
                {
                    //Find the number of threads
                    //Thread number is in the first lin like "[X]"
                    final int start = list.indexOf((byte)'[');
                    final int end = list.indexOf((byte)']');

                    //Sanity check the bounds
                    if(! (end > start))
                    {
                        throw new IOException("Couldn't locate number of threads");
                    }

                    //Create a string from the Byte[] array subset
                    StringBuilder sb = new StringBuilder();
                    for(int i = start+1; i != end; ++i)
                    {                   
                        final char c = (char) buffer[i].byteValue();
                        sb.append(c);
                    }
                    String numThreadsStr = sb.toString();

                    //Try and parse the string into a number
                    try
                    {
                        this.numberOfThreads = Integer.valueOf(numThreadsStr);
                    }catch(NumberFormatException e)
                    {
                        throw new IOException("Number of threads is NaN",e);
                    }

                    //No more values to extract
                    foundInfoString = true;
                }

                //If the InputStream got EOF and the into string has not been found
                //Then an error has occurred. 
                if(result == -1 && ! foundInfoString )
                {
                    throw new IOException("Never got info string");
                }
            }

        }finally
        {
            //Close the connection
            conn.disconnect();
        }

    }

    public MotionHttpApi(String host,int port)
    {
        this.host = host;
        this.port = port;
    }
} 
```

当您调用`getNumberOfCameras()`. 但是我想我一定不是真的了解java方面的东西，因为retrieveSplash方法太复杂了。我可以用大约 10 行 C 或 1 行 Python 来做同样的事情。当然必须有一种更明智的方式来操作 java 中的字节？

我认为存在一些样式问题，例如当整数无法解析时，我可能不应该抛出 IOException 。但这是一个单独的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-11T12:36:31.673

按照 Gautam Tandon 的建议阅读第一行，然后使用正则表达式。然后，您可以检查正则表达式是否匹配，甚至可以轻松提取数字。

正则表达式'可以在[http://txt2re.com](http://txt2re.com/index-java.php3?s=Motion%203.2.12%20Running%20%5B4%5D%20Threads&-7&-19&-5&-20&-1&2&-22&-21&-62&-63&15)创建。我已经为你做到了。该页面甚至创建 Java、Pyhton、C 等文件供您使用。

```
// URL that generated this code:
// http://txt2re.com/index-java.php3?s=Motion%203.2.12%20Running%20[4]%20Threads&-7&-19&-5&-20&-1&2&-22&-21&-62&-63&15 

import java.util.regex.*;

class Main
{
  public static void main(String[] args)
  {
    String txt="Motion 3.2.12 Running [4] Threads";

    String re1="(Motion)";  // Word 1
    String re2="( )";   // White Space 1
    String re3="(3\\.2\\.12)";  // MMDDYY 1
    String re4="( )";   // White Space 2
    String re5="(Running)"; // Word 2
    String re6="( )";   // White Space 3
    String re7="(\\[)"; // Any Single Character 1
    String re8="(\\d+)";    // Integer Number 1
    String re9="(\\])"; // Any Single Character 2
    String re10="( )";  // White Space 4
    String re11="((?:[a-z][a-z]+))";    // Word 3

    Pattern p = Pattern.compile(re1+re2+re3+re4+re5+re6+re7+re8+re9+re10+re11,Pattern.CASE_INSENSITIVE | Pattern.DOTALL);
    Matcher m = p.matcher(txt);
    if (m.find())
    {
        String word1=m.group(1);
        String ws1=m.group(2);
        String mmddyy1=m.group(3);
        String ws2=m.group(4);
        String word2=m.group(5);
        String ws3=m.group(6);
        String c1=m.group(7);
        String int1=m.group(8);
        String c2=m.group(9);
        String ws4=m.group(10);
        String word3=m.group(11);
        System.out.print("("+word1.toString()+")"+"("+ws1.toString()+")"+"("+mmddyy1.toString()+")"+"("+ws2.toString()+")"+"("+word2.toString()+")"+"("+ws3.toString()+")"+"("+c1.toString()+")"+"("+int1.toString()+")"+"("+c2.toString()+")"+"("+ws4.toString()+")"+"("+word3.toString()+")"+"\n");
    }
  }
}

//-----
// This code is for use with Sun's Java VM - see http://java.sun.com/ for downloads. 
//
// Paste the code into a new java application or a file called 'Main.java'
//
// Compile and run in Unix using:
// # javac Main.java 
// # java Main 
// 
```

`String int1=m.group(8);`给你想要的整数。当然你可以简化上面的代码。现在是冗长的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T19:53:28.743

您可以使用 BufferedReader 大大简化 retrieveSplash 方法。这是您的函数的更简单版本：

```
void retrieveSplash_simpler() throws IOException {
    URL url = new URL(getBaseUrl());
    HttpURLConnection conn = (HttpURLConnection)url.openConnection();
    // open the connection
    conn.connect();
    // create a buffered reader to read the input stream line by line
    BufferedReader reader = new BufferedReader(new InputStreamReader(conn.getInputStream()));

    // find number of threads
    String firstLine = reader.readLine();
    int x = firstLine.indexOf("[");
    int y = firstLine.indexOf("]");
    if (x > 0 && y > 0 && x < y) {
        try {
            numberOfThreads = Integer.parseInt(firstLine.substring(x+1, y));
        } catch (NumberFormatException nfe) {
            // disconnect and throw exception
            conn.disconnect();
            throw new IOException("Couldn't locate number of threads");
        }
    } else {
        // disconnect and throw exception
        conn.disconnect();
        throw new IOException("Couldn't locate number of threads");
    }

    // disconnect
    conn.disconnect();
} 
```

我将通过在适当的位置使用 try/catch/finally 块来进一步清理上述方法，这样我就不必复制那个“conn.disconnect()”。但我在这里没有这样做以保持简单（尝试/捕捉/最终有时会变得棘手......）。

# sql - Play框架中ebean为sqlite数据库生成错误的sql脚本

> ID：15733941
> 
> 赞同：1
> 
> 时间：2013-03-31T20:06:47.913
> 
> 标签：sql, sqlite, playframework-2.0

我正在使用 play framework 2.1 并使用 evolution 为我自动生成 sql 脚本。我使用的数据库是 sqlite3。

似乎进化无法为 sqlite3 生成正确的脚本。我得到的不正确的脚本是：

```
create table algorithm (

id                        bigint AUTOINCREMENT primary key,

name                      varchar(255),

description               varchar(255))

; 
```

我是 sqlite3 的新手。通过网上搜索，我意识到：

1.  `autoincrement`只能与`Integer`
2.  `autoincrement`应该放在后面`primary key`

所以显然自动生成的脚本是不正确的。我的问题是：

1.  有没有办法解决上述问题，以便我仍然可以使用 sqlite3 的进化？
2.  一般来说，您建议使用进化还是禁用它并手动编写 sql 脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-30T13:26:58.987

我昨天遇到了同样的问题。问题位于 ebean 框架的 sqlite ddl 配置内部。

但是，我能够通过创建自己的 com.avaje.ebean.config.dbplatform.SQLitePlatform 类的实现来解决这个问题。这是一个快速的技巧，它将 autoincrement 关键字设置为空字符串并将 bigint 类型重新定义为整数：

```
package com.avaje.ebean.config.dbplatform;

import java.sql.Types;

import javax.sql.DataSource;

import com.avaje.ebean.BackgroundExecutor;

public class SQLitePlatform extends DatabasePlatform {

    static {
        System.err.println("\n\n!!! Custom SQLitePlatform class for ebean ORM loaded !!!!\n\n");
    }

    public SQLitePlatform() {
        super();
        this.name = "sqlite";

        this.dbIdentity.setIdType(IdType.IDENTITY);
        this.dbIdentity.setSupportsGetGeneratedKeys(false);
        this.dbIdentity
                .setSelectLastInsertedIdTemplate("select last_insert_rowid()");
        this.openQuote = "\"";
        this.closeQuote = "\"";

        this.booleanDbType = Types.INTEGER;

        dbTypeMap.put(Types.BIT, new DbType("int default 0"));
        dbTypeMap.put(Types.BOOLEAN, new DbType("int default 0"));
        dbTypeMap.put(Types.BIGINT, new DbType("integer"));

        dbDdlSyntax.setInlinePrimaryKeyConstraint(true);
        dbDdlSyntax.setIdentity("");
        dbDdlSyntax.setDisableReferentialIntegrity("PRAGMA foreign_keys = OFF");
        dbDdlSyntax.setEnableReferentialIntegrity("PRAGMA foreign_keys = ON");
    }

    /**
     * Return null in case there is a sequence annotation.
     */
    @Override
    public IdGenerator createSequenceIdGenerator(BackgroundExecutor be,
            DataSource ds, String seqName, int batchSize) {

        return null;
    }

} 
```

将类编译并打包成一个 jar 文件。当放置在`lib`您的播放应用程序的目录中时，类加载器将在原始实现之前加载该类，并且 sqlite 应该接受此自定义实现生成的 ddl。

# php - PHP 与 MySQL WHERE 值范围

> ID：15733944
> 
> 赞同：0
> 
> 时间：2013-03-31T20:07:20.660
> 
> 标签：php, mysql

所以，我有一个带有某个整数的变量。我们称之为**$num**。我想做的是检查一个名为**nums**的表，其中我的值介于或等于**$num-2**和**$num+2**但不**等于****$num**。

从数学上讲，这个范围就像**[$num-2,$num[** ; **]$num,$num+2]**。

```
SELECT num FROM nums WHERE ... 
```

我知道这是基本查询，但我现在有点困惑。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T20:08:38.057

```
SELECT ...
...
WHERE nums (BETWEEN ($num - 2) AND ($num + 2))
   AND (nums <> $num) 
```

# php - PHP Windows 7 IPv6 解决方法 ip 列不能为空

> ID：15733947
> 
> 赞同：0
> 
> 时间：2013-03-31T20:07:30.903
> 
> 标签：php, ipv6

使用以下 PHP/SQL...

```
function ip2long6($ip)
{//ipv6 to ipv4 (string) to get Windows 7 local working
// Temp work-around until we convert the string to support ipv6 natively in SQL.
 if (substr_count($ip, '::')) {$ip = str_replace('::', str_repeat(':0000', 8 - substr_count($ip,':')).':',$ip);}

 $ip = explode(':',$ip);
 $r_ip = '';

 foreach ($ip as $v) {$r_ip .= str_pad(base_convert($v,16,2),16,0,STR_PAD_LEFT);}

 return base_convert($r_ip,2,10);
}

$ip = mysql_real_escape_string($_SERVER['REMOTE_ADDR']);
$ip = mysql_real_escape_string(ip2long6($ip));
INSERT INTO log (ip) VALUES (INET_ATON('1208321')) 
```

我收到以下错误...

> 列“ip”不能为空

我们现在如何让 $ip 与 IPv4 兼容？

* * *

一个有效的答案......

```
if (is_int($ip)) {$ipsql = mysql_real_escape_string("INET_ATON('$ip')");}
else {$ipsql = mysql_real_escape_string($ip);} 
```

有了这个，我只是`INET_ATON('$ip')`回复`$ipsql`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T20:12:55.703

您正在使用 INET_ATON 转换字符串整数。该函数需要一个 dotted.quad 地址，例如

```
INET_ATON('127.0.0.1'); 
```

不是有效输入，因此函数返回 null：

```
mysql> select inet_aton('12345'), inet_aton('127.0.0.1');
+--------------------+------------------------+
| inet_aton('12345') | inet_aton('127.0.0.1') |
+--------------------+------------------------+
|               NULL |             2130706433 |
+--------------------+------------------------+ 
```

# android - 我的片段无法转换为 android.support.v4.app.Fragment

> ID：15733948
> 
> 赞同：23
> 
> 时间：2013-03-31T20:07:38.020
> 
> 标签：android, fragment

我创建了一个非常简单的片段来测试我的应用程序，并收到以下错误消息：

```
03-31 16:04:39.834: E/AndroidRuntime(7860): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.team3.domore/com.team3.domore.TabActivity}: java.lang.ClassCastException: com.team3.domore.SomeFrag cannot be cast to android.support.v4.app.Fragment 
```

我的片段真的很简单......

```
import android.app.Fragment;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

public class SomeFrag extends Fragment {
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        return inflater.inflate(R.layout.alarm_frag, container, false);
    }

    @Override
    public void onStart() {
        super.onStart();
    }
} 
```

请帮助...我已经为此苦苦挣扎了将近两个小时..

编辑：我很确定我在哪里调用这个片段（一个扩展 FragmentActivity 的活动）正在工作......只是这个片段部分不起作用......

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2013-03-31T20:10:35.373

你的`SomeFrag`扩展

```
android.app.Fragment 
```

如进口所述。将导入更改为

```
android.support.v4.app.Fragment 
```

演员会成功。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-03-31T20:10:31.880

尝试更改以下导入

```
import android.app.Fragment 
```

到`import android.support.v4.app.Fragment`

# objective-c - 知道什么时候创建一个对象

> ID：15733951
> 
> 赞同：1
> 
> 时间：2013-03-31T20:07:45.283
> 
> 标签：objective-c, cocoa, objective-c-runtime

有没有办法使用 ObjC 运行时库或 Cocoa 在创建对象时收到通知，例如，在从`init`方法返回之后？

我想在不修改对象或对其进行子类化（`NSObject`例如，没有子类）并且不进行方法调配（我已经知道如何做到这一点）的情况下实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:37:16.807

默认情况下，运行时不会记录这一点。我想我会使用 swizzling 但是因为你不想要这个......我认为 CodaFi 将对象包装在代理中的想法是最好的，尽管这只是你手动执行 AFAICS 分配的一个选项

所以如果你想让它真正透明，毕竟我会说

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T20:38:46.410

方法执行时没有经过批准的通知方式，除非它特别指出它返回通知，或指向某种回调、块等的指针。虽然 swizzling 可能是处理它的一种方式，但代理是可能是你最好的选择。通过实现其所有属性和/或将选择器转发到目标对象，您可以将自己“作为”类插入，而不是弄乱整个类的选择器。通过这种方式，NSProxy 和子类可以用作普通对象的包装器，这意味着您可以在将其转发到目标之前响应碰巧通过代理发送的任何类型的方法。一个简单的代理可以仿照下面的示例：

```
FOUNDATION_EXPORT NSString *const CFIProxyDidInitializeTargetNotification;

@interface CFIObjectProxy : NSProxy {
    __strong Foo *_target;
}

- (id)init;

@property(nonatomic, readonly, retain) NSArray* bars;

@end

//...

#import "CFIObjectProxy.h"

NSString *const CFIProxyDidInitializeTargetNotification = @"CFIProxyDidInitializeTargetNotification";

@implementation CFIObjectProxy

- (id)init {

    _target = [[Foo alloc]init];
    [NSNotificationCenter.defaultCenter postNotificationName:CFIProxyDidInitializeTargetNotification object:nil];

    return self;
}

- (void)forwardInvocation:(NSInvocation *)invocation {
    [invocation invokeWithTarget:_target];
}

- (NSMethodSignature *)methodSignatureForSelector:(SEL)sel {
    return [_target methodSignatureForSelector:sel];
}

- (NSString *)description {
    return [_target description];
}

- (NSString *)debugDescription {
    return [NSString stringWithFormat:@"<%@:%p> Proxy for Object: %@", NSStringFromClass(self.class), self, _target];
}

- (NSArray*)bars {
    return [_target bars];
}

@end 
```

# objective-c - 如何获取 NSURL 导致画廊图像？

> ID：15733952
> 
> 赞同：1
> 
> 时间：2013-03-31T20:07:51.397
> 
> 标签：objective-c, uiimagepickercontroller

在我的应用程序中，我使用 UIImagePickerController 来选择图像。我想获得一个指向该图像的 NSURL。在“didFinishPickingImage”方法中，我尝试使用“UIImagePickerControllerReferenceURL”和“UIImagePickerControllerMediaURL”属性，就像stackoverflow中的一些线程建议的那样，但是它们都返回NULL作为url。

[这个](https://stackoverflow.com/questions/13773635/nsurl-of-uiimage-from-uiimagepickercontroller-returns-null)线程谈到了类似的事情 - 但是他们讨论的是获取图像本身而不是 URL，我不太明白如何最终得到一个 NSURL 导致我的画廊图像。

这是我当前的代码：

```
- (void)imagePickerController:(UIImagePickerController *)picker 
                              didFinishPickingImage:(UIImage *)image 
                              editingInfo:(NSDictionary *)editingInfo
{

    NSURL *imageUrl = [editingInfo valueForKey:UIImagePickerControllerReferenceURL];

    NSString *stringFromURL = [imageUrl absoluteString];
    NSLog(@"%@", stringFromURL);  // this shows i do get (null)

    // ....
} 
```

感谢您的时间！

# java - Neo4J Spring 的相关功能无法解析

> ID：15733958
> 
> 赞同：1
> 
> 时间：2013-03-31T20:08:08.060
> 
> 标签：java, spring, neo4j

给定以下课程：

```
package com.example.model;

import java.util.Collection;
import java.util.Set;

import org.neo4j.graphdb.Direction;
import org.neo4j.helpers.collection.IteratorUtil;
import org.springframework.data.neo4j.annotation.Indexed;
import org.springframework.data.neo4j.annotation.NodeEntity;
import org.springframework.data.neo4j.annotation.RelatedTo;
import org.springframework.data.neo4j.annotation.RelatedToVia;
import org.springframework.security.core.GrantedAuthority;

@NodeEntity
public class User {
    private static final String SALT = "cewuiqwzie";
    public static final String FRIEND = "FRIEND";
    public static final String RATED = "RATED";
    @Indexed
    String login;
    String name;
    String password;
    String info;
    private Roles[] roles;

    public User() {
    }

    public User(String login, String name, String password, Roles... roles) {
        this.login = login;
        this.name = name;
        this.password = encode(password);
        this.roles = roles;
    }

    private String encode(String password) {
        return "";
        // return new Md5PasswordEncoder().encodePassword(password, SALT);
    }

    @RelatedToVia(elementClass = Rating.class, type = RATED)
    Iterable<Rating> ratings;

    @RelatedTo(elementClass = Movie.class, type = RATED)
    Set<Movie> favorites;

    @RelatedTo(elementClass = User.class, type = FRIEND, direction = Direction.BOTH)
    Set<User> friends;

    public void addFriend(User friend) {
        this.friends.add(friend);
    }

    public Rating rate(Movie movie, int stars, String comment) {
        return relateTo(movie, Rating.class, RATED).rate(stars, comment);
    }

    public Collection<Rating> getRatings() {
        return IteratorUtil.asCollection(ratings);
    }

    @Override
    public String toString() {
        return String.format("%s (%s)", name, login);
    }

    public String getName() {
        return name;
    }

    public Set<User> getFriends() {
        return friends;
    }

    public Roles[] getRole() {
        return roles;
    }

    public String getLogin() {
        return login;
    }

    public String getPassword() {
        return password;
    }

    public String getInfo() {
        return info;
    }

    public void setInfo(String info) {
        this.info = info;
    }

    public void updatePassword(String old, String newPass1, String newPass2) {
        if (!password.equals(encode(old)))
            throw new IllegalArgumentException("Existing Password invalid");
        if (!newPass1.equals(newPass2))
            throw new IllegalArgumentException("New Passwords don't match");
        this.password = encode(newPass1);
    }

    public void setName(String name) {
        this.name = name;
    }

    public boolean isFriend(User other) {
        return other != null && getFriends().contains(other);
    }

    public enum Roles implements GrantedAuthority {
        ROLE_USER, ROLE_ADMIN;

        @Override
        public String getAuthority() {
            return name();
        }
    }
} 
```

我在这里得到一个编译异常：

```
public Rating rate(Movie movie, int stars, String comment) {
            return relateTo(movie, Rating.class, RATED).rate(stars, comment);
        } 
```

按照[这里的教程](https://github.com/SpringSource/spring-data-neo4j/tree/master/spring-data-neo4j-examples/cineasts-rest)。任何有关此功能所在位置的见解都值得赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T06:16:14.223

您正在尝试使用高级映射模式。有关详细信息，请参阅[参考手册](http://docs.spring.io/spring-data/data-neo4j/docs/3.3.2.RELEASE/reference/html/#reference_aspectj)。您需要在 IDE 中设置 AspectJ 支持。方法在编译时被编织到您的实体类中。

# xml - 使用 XSLT 转换 XML 以在 asp:menu 中使用

> ID：15733959
> 
> 赞同：-1
> 
> 时间：2013-03-31T20:08:11.997
> 
> 标签：xml, xslt

我们有一个当前系统，其中包含以下格式的菜单 XML 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<Menu>
<item name="A" value="Red Apple" />
<item name="B" value="Black Board" />
<item name="B" value="Blue Earth" />
</Menu> 
```

ASP:菜单

```
<asp:Menu ID="MenuControl" runat="server" Orientation="Horizontal" >
<DataBindings>
<asp:MenuItemBinding TextField="MenuText" ToolTipField="tooltip" NavigateUrlField="destUrl" />
</DataBindings>
</asp:Menu> 
```

为了将此数据绑定到 asp:menu，结果应采用以下格式：

```
<?xml version="1.0" encoding="UTF-8"?>
<MenuItems>
   <MenuItem MenuText="A" tooltip="A" destUrl="">
      <MenuItem MenuText="Red Apple" tooltip="Red Apple" destUrl="~/RedApple.aspx" />
   </MenuItem>
   <MenuItem MenuText="B" tooltip="B" destUrl="">
      <MenuItem MenuText="Black Board" tooltip="Black Board" destUrl="~/BlackBoard.aspx" />
      <MenuItem MenuText="Blue Earth" tooltip="Blue Earth" destUrl="~/BlueEarth.aspx" />
   </MenuItem>
</MenuItems> 
```

XSLT 似乎是合乎逻辑的选择。有谁知道如何使用 XSLT 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T20:38:21.067

这是执行请求转换的 XSLT。由于 Xml 源文件中未提供 destUrl，因此它是由 @value 通过将空格替换为空来生成的。

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes"/>
  <xsl:key name="name" match="item" use="@name" />

  <xsl:template match="Menu">
    <MenuItems>
      <xsl:apply-templates select="item[generate-id(.)=generate-id(key('name',@name)[1])]"/>
    </MenuItems>
  </xsl:template>

  <xsl:template match="item">
    <MenuItem MenuText="{@name}" tooltip="{@name}" destUrl="">
      <xsl:for-each select="key('name', @name)">
        <MenuItem MenuText="{@value}" tooltip="{@value}" destUrl="~/{translate(@value, ' ','')}.aspx" />
      </xsl:for-each>
    </MenuItem>
  </xsl:template>
</xsl:stylesheet> 
```

它完全符合您要求的格式。

[xml](/questions/tagged/xml "显示标记为“xml”的问题") [xslt](/questions/tagged/xslt "显示标记为“xslt”的问题")

# git - 如何从我的仓库中删除最新的提交？

> ID：15733970
> 
> 赞同：0
> 
> 时间：2013-03-31T20:09:15.143
> 
> 标签：git, github, commit, reset

我对我的 github 存储库的最新提交出现了一些错误。我怎样才能删除最新的一个？

我是否使用此命令：

```
git reset --hard HEAD^ 
```

删除最新的？

接着：

```
git push origin master 
```

更新？

还是我应该使用另一个命令？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T20:59:24.210

是的，可以重置和强制推送，但只有在您单独处理存储库时才应该这样做。

将提交推送到公共/共享存储库时，该提交会被其他人克隆到他们的存储库中，因此可能会找到返回存储库的方式。

最好的方法是简单地使用`git revert HEAD`. 这会创建另一个提交，它只是撤消您的最后一次提交。

规则是：如果你还没有发布你的提交，重置是可以的，但如果你已经发布（即推送）你的提交，恢复是安全的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T20:12:21.510

基本上，是的。你可能需要

```
git push --force origin master 
```

因为它通常会拒绝不是当前远程 HEAD 后代的更新，但先尝试你的方式并看看它抱怨什么不会有什么坏处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T20:17:13.610

我会`git reset --soft HEAD~1`继续将文件保存在索引中。通过这样做，您可以修改错误文件并再次提交。

# ruby - Rails：我如何需要 NumberHelper 并使其工作？

> ID：15733971
> 
> 赞同：15
> 
> 时间：2013-03-31T20:09:16.493
> 
> 标签：ruby, sinatra, actionpack

我正在尝试编写一个简单的 Sinatra 东西，但我需要动作包中的 ActionView::Helpers::NumberHelper。 [http://api.rubyonrails.org/classes/ActionView/Helpers/NumberHelper.html](http://api.rubyonrails.org/classes/ActionView/Helpers/NumberHelper.html)

问题是，我该如何安装和使用它？

```
irb(main):001:0> require 'action_view/helpers/number_helper'
irb(main):002:0> number_with_precision(1)
NoMethodError: undefined method `number_with_precision' for main:Object
irb(main):004:0> ActionView::Helpers::NumberHelper.number_with_precision(1)
NoMethodError: undefined method `number_with_precision' for ActionView::Helpers::NumberHelper:Module 
```

为什么这个简单的步骤不起作用？

此外，如果我需要所有的废话：

```
irb(main):001:0> require 'action_pack'
irb(main):004:0> require 'action_view'
irb(main):005:0> include ActionView::Helpers::NumberHelper
irb(main):006:0> number_to_phone(12345)
NoMethodError: undefined method `starts_with?' for "12345":String 
```

如何理解这一切？为什么这个模块不起作用？为什么它不需要它需要的任何东西？它需要什么？哪里是starts_with？

谷歌对这些问题完全保持沉默。

UPD：现在我得到以下信息

```
number_with_precision(1, :locale => 'fr')
TypeError: wrong argument type nil (expected Fixnum) 
```

在我看来，我的 NumberHelper 坏了。这不是一个好的行为。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-03-31T22:10:12.970

所以，经过一番研究，我在 Rails 的 master 分支上发现了以下拉取请求

[https://github.com/rails/rails/pull/6315](https://github.com/rails/rails/pull/6315)

它几乎旨在`ActionView::Helpers::NumberHelper`从`ActionView``ActiveSupport`

我还看到了一些封闭的问题，旨在解决一些允许包含`NumberHelper`为独立的问题。这意味着需要修复等。我没有找到一个未解决的问题，`number_to_phone`但问题的根源在于为类`ActiveSupport`添加了别名。我不确定他们是否在那里发现了那个错误。`starts_with?``String`

无论如何，使用`ActionView`版本，`3.2.13`您可以执行以下操作

```
require 'action_view'
include ActionView::Helpers::NumberHelper
number_with_precision 3.1
#=> "3.100" 
```

至于`number_to_phone`，那仍然会与当前版本中断。我正在做一个 PR 来解决这个问题。

**编辑**

至于语言环境问题，似乎如果您指定本地人，则需要在其中设置正确的选项`I18n`才能使其正常工作。如果您不提供语言环境，则默认值将如下所示`{:separator=>".", :delimiter=>"", :precision=>3, :significant=>false, :strip_insignificant_zeros=>false}`，否则，哈希将为空并且会导致问题。不过，我似乎在 Rails 上找不到任何关于它的问题。

同样，这已在 master [https://github.com/carlosantoniodasilva/rails/commit/f6b71499e967e03c65d53cc890585f42f3b8aaa2上的 PR 上修复](https://github.com/carlosantoniodasilva/rails/commit/f6b71499e967e03c65d53cc890585f42f3b8aaa2)

**更新**

您`ActiveSupport`现在可以使用这些助手

[http://api.rubyonrails.org/classes/ActiveSupport/NumberHelper.html](http://api.rubyonrails.org/classes/ActiveSupport/NumberHelper.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-03-03T15:54:43.910

最近变了：

```
require "active_support/all"

module Helpers
  extend ActiveSupport::NumberHelper
end

Helpers.number_to_currency(10.23) # => "$10.23" 
```

# php - jQuery 解析/显示来自 php json_encode 的 json 数据

> ID：15733972
> 
> 赞同：4
> 
> 时间：2013-03-31T20:09:21.450
> 
> 标签：php, jquery, ajax, json

jquery 中的初始 .ajax 调用：

```
$.ajax({                                      
 type: 'post',
 url: 'items_data.php',                  
 data: "id="+id,                                       
 dataType: 'json',                     
 success: function(data){     
  if(data){
   make_item_rows(data);
  }else{
   alert("oops nothing happened :(");
  }        
 } 
}); 
```

将一个简单的字符串发送到一个 php 文件，如下所示：

```
header('Content-type: application/json');
require_once('db.php');

if( isset($_POST['id'])){
 $id = $_POST['id'];
}else{
 echo "Danger Will Robinson Danger!";
}

$items_data = $pdo_db->query ("SELECT blah blah blah with $id...");
$result_array = $items_data->fetchAll();
echo json_encode($result_array); 
```

我很好地捕获了 $result_array 并将其传递给另一个函数。我仔细检查了确实返回了正确的值，因为我可以将结果回显到我的页面，它显示如下内容：

```
[{"item_id":"230","0":"230","other_id":"700"},{"item_id":"231","0":"231","other_id":"701"},{"item_id":"232","0":"232","other_id":"702"}] 
```

我无法弄清楚如何遍历结果，以便可以将值注入 HTML 中的表中。这是我的功能：

```
function make_item_rows(result_array){  
 var string_buffer = "";
 $.each(jQuery.parseJSON(result_array), function(index, value){
  string_buffer += value.item_id; //adding many more eventually
  $(string_buffer).appendTo('#items_container');
  string_buffer = ""; //reset buffer after writing          
 });                    
} 
```

我还尝试在 $.each 函数中发出警报，以确保它触发了 3 次，确实如此。但是，我的代码中没有数据。也尝试了其他一些方法，但没有运气。

更新：我更改了我的代码以包含 parseJSON，没有骰子。在我的 jquery 文件中出现意外的令牌错误（当它尝试使用本机 json 解析器时）。尝试添加 json 标头无济于事，同样的错误。jQuery 版本 1.9.1。现在的代码应该反映在上面。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-31T20:19:20.930

在您的 ajax 调用中设置`dataType:"JSON"`and 回调。

例如：

```
$.ajax({
    url: "yourphp.php?id="+yourid,
    dataType: "JSON",
    success: function(json){
        //here inside json variable you've the json returned by your PHP
        for(var i=0;i<json.length;i++){
            $('#items_container').append(json[i].item_id)
        }
    }
}) 
```

还请在您的 PHP 设置中考虑 JSON 内容类型。`header('Content-type: application/json');`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T20:14:05.170

你需要用它来解析它`jQuery.parseJSON`

```
function make_item_rows(result_array){  
 var string_buffer = "";
 $.each(jQuery.parseJSON(result_array), function(index, value){
  string_buffer = value.item_id;
  $(string_buffer).appendTo('#items_container');
 });                    
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-31T20:16:22.180

```
function make_item_rows(result_array){  
    var string_buffer = "";
    var parsed_array=JSON.parse(result_array);
    $.each(parsed_array, function(){
       string_buffer += parsed_array.item_id;
       $(string_buffer).appendTo('#items_container');
       string_buffer = "";           
    });                    
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-31T20:12:16.703

试试这个。

```
function make_item_rows(result_array){  
 var string_buffer = "";
 $.each(result_array, function(index, value){
  value = jQuery.parseJSON(value);
  string_buffer += value.item_id;
  $(string_buffer).appendTo('#items_container');
  string_buffer = "";           
 });                    
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-31T20:20:13.220

假设您已经解析了 json 响应并且您拥有数组。我认为问题是您需要将回调传递给 $.each ，它需要和索引和元素参数

```
function make_item_rows(result_array){  
    $.each(result_array, function(index, element){
        document.getElementById("a").innerHTML+=element.item_id;
    });                    
} 
```

[（稍作修改）DEMO](http://jsfiddle.net/cead22/x5AZ9/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-31T20:20:15.557

对于其中的初学者，`$.each`您需要访问包含在其中的对象实例的属性`result_array`，而不是`result_array`其本身。

```
var string_buffer = "";
 $.each(result_array, function(index, object){
     /* instance is "object"*/
     alert( object.item_id);
}); 
```

不完全确定您对这一行的期望：`$(string_buffer).appendTo('#items_container');`

`$(string_buffer)`不会创建有效的 jQuery 选择器，因为其中没有任何内容`string_buffer`具有类、标记名或 ID 的前缀，并且来自 json 的值也没有

`item_id`如果只想要附加的字符串值：

```
$('#items_container').append(  object.item_id+'<br/>'); 
```

如果您使用 jQuery AJAX 方法接收此信息，则不需要`$.parseJSON`像其他答案所建议的那样使用它，只要您为 AJAX 设置正确的 dataType，它就会在内部为您完成

# ios - 如何根据情节提要的状态在应用启动时对不同的初始屏幕进行建模？

> ID：15733974
> 
> 赞同：0
> 
> 时间：2013-03-31T20:09:31.277
> 
> 标签：ios

每当我的应用程序启动时，将根据状态显示 3 个可能的屏幕之一。

我打算通过将起始视图控制器作为导航视图控制器在情节提要中对此进行建模，然后从它到其他三个 VC 中的每一个都有一个 segue。然后在应用程序启动时，将根据应用程序的存储状态推送适当的 VC。

但是 IB 不允许我从导航控制器进行多个连接。如果我从 NVC 到任何 VC 进行初始转场，比如说 A。然后，当我尝试从 NVC 向另一个 VC B 添加另一个转场时，IB 会在 A 和 B 之间创建连接。

首先是将导航控制器作为起始 RVC 并根据状态将不同的 VC 推送到不正确的方法的方法？如果没有，那么如何用故事板对其进行建模？为什么 IB 不允许我将 segue 拖放到另一个控制器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T20:45:57.523

我不认为导航控制器是要走的路。IB 不会让您连接多个，因为第一个连接是根视图控制器，并且只有一个。

根据您在这 3 个初始视图之一之后的去向，您可以通过多种不同的方式获得所需的内容。接下来他们都去同一个视图吗？都是不同的看法？有的一样，有的不一样？没有更多细节很难给你建议。

如果您不想要那种外观，您可以从标签栏控制器开始，隐藏标签栏。或者，您可以在通用初始控制器的 viewDidAppear 方法中包含逻辑，并让它将窗口的根视图控制器切换到三个屏幕中的一个。

# python - Python中的二维数组分解

> ID：15733976
> 
> 赞同：-2
> 
> 时间：2013-03-31T20:09:40.367
> 
> 标签：python, arrays, decomposition

感谢您对 Python 3 的翻译帮助，该 Python 3 将任意大小的输入数组分解为长度为 4 的较小方形数组。

我已经在 numpy 中尝试过块和数组函数，但它们对此毫无用处。

这是我在 Perl 中运行良好的代码，但我希望它与 Python 进行比较（在效率上）。

```
sub make_array {
my $input = shift;
my $result;
my @parts = split '-', $input;

$result = [];

# Test for valid number of lines in inputs
my $lines = scalar @parts;
if($lines % $width){
    die "Invalid line count $lines not divisible by $width" ;
    # Or could pad here by adding an entire row of '0'.
}

# Chunk input lines into NxN subarrays
# loop across all input lines in steps of N lines

my $line_width = 0;
for (my $nn=0;$nn<$lines;$nn+=$width){

    # make a temp array to handle $width rows of input
    my @temp = (0..$width-1);
    for my $ii (0..$width-1){

        my $p = $parts[$nn+$ii];
        my $padding_needed = length($p) % $width;
        if($padding_needed != 0) { 
            print "'$p' is not divisible by correct width of $width, Adding $padding_needed zeros\n";
            for my $pp (0..$padding_needed){ 
                $p .= "0";
            }
        }
        if($line_width == 0){ 
            $line_width = length($p);
        }
        $temp[$ii] = $p;
    }
    # now process temp array left to right, creating keys
    my $chunks = ($line_width/$width);
    if($DEBUG) { print "chunks: $chunks\n"; }
    for (my $zz =0;$zz<$chunks;$zz++){
        if($DEBUG) { print "zz:$zz\n"; }
        my $key;
        for (my $yy=0;$yy<$width;$yy++){
            my $qq = $temp[$yy];
            $key .= substr($qq,$zz*$width, $width) . "-";
        }
        chop $key; # lose the trailing '-'
        if($DEBUG) { print "Key: $key\n"; }
        push @$result, $key;
    }
}        

if($DEBUG){
    print "Reformatted input:";
    print Dumper $result;
    my $count = scalar @$result;
    print "There are $count keys to check against the lookup table\n";
}
return $result;
} 
```

例如，我有以下 12 x 12 矩阵：

```
000011110011
000011110011
000011110011
000011110011
000011110011
000011110011
000011110011
000011110011 
```

我希望它分解成 6 个长度为 4 的方形子矩阵：

```
0000 1111 0011
0000 1111 0011
0000 1111 0011
0000 1111 0011

0000 1111 0011
0000 1111 0011
0000 1111 0011
0000 1111 0011 
```

原始矩阵来自以下格式的文件（程序应从文本文件中读取）：

```
000011110011,000011110011,000011110011,000011110011,000011110011,000011110011,000011110011,000011110011 
```

所以程序需要用连字符分割它，并将每个块作为大矩阵的一行。这 6 个子矩阵应该采用相同的输入格式，因此第一个是：

```
0000,0000,0000,0000 
```

程序应该将任何输入矩阵分解为长度为 j 的方阵，比如 4，如果原始矩阵的大小不是 4 的倍数，那么它应该忽略不能形成 4x4 矩阵的剩余块。

原始输入文件中可能会出现几个不同大小的大矩阵，并以断线作为分隔符。例如，原始大矩阵和另一个 rmatrix 在文本文件中看起来如下所示：

```
000011110011,000011110011,000011110011,000011110011,000011110011,000011110011,000011110011,000011110011\n
0101,0101,0101,0101 
```

并检索 2 组子数组，6 个 4x4 数组中的一个，第二个 4x4 中的一个。如果你为单一情况解决它当然没问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:57:01.417

这很容易使用[numpy](http://www.numpy.org/)。假设我们有一个 12x12 的数组；

```
In [1]: import numpy as np

In [2]: a = np.arange(144).reshape([-1,12])

In [3]: a
Out[3]: 
array([[  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11],
       [ 12,  13,  14,  15,  16,  17,  18,  19,  20,  21,  22,  23],
       [ 24,  25,  26,  27,  28,  29,  30,  31,  32,  33,  34,  35],
       [ 36,  37,  38,  39,  40,  41,  42,  43,  44,  45,  46,  47],
       [ 48,  49,  50,  51,  52,  53,  54,  55,  56,  57,  58,  59],
       [ 60,  61,  62,  63,  64,  65,  66,  67,  68,  69,  70,  71],
       [ 72,  73,  74,  75,  76,  77,  78,  79,  80,  81,  82,  83],
       [ 84,  85,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95],
       [ 96,  97,  98,  99, 100, 101, 102, 103, 104, 105, 106, 107],
       [108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119],
       [120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131],
       [132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143]]) 
```

要选择左上角的 4x4 数组，请使用[slicing](http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html)：

```
In [4]: a[0:4,0:4]
Out[4]: 
array([[ 0,  1,  2,  3],
       [12, 13, 14, 15],
       [24, 25, 26, 27],
       [36, 37, 38, 39]]) 
```

右下子数组是：

```
In [7]: a[8:12,8:12]
Out[7]: 
array([[104, 105, 106, 107],
       [116, 117, 118, 119],
       [128, 129, 130, 131],
       [140, 141, 142, 143]]) 
```

你可以猜到其余的...

# r - 新手需要在R中循环lm

> ID：15733977
> 
> 赞同：1
> 
> 时间：2013-03-31T20:09:40.840
> 
> 标签：r, loops, lm

我是遗传学博士生，我正在尝试使用线性回归对一些遗传数据进行关联分析。在下表中，我将每个“特征”与每个“SNP”进行回归还有一个交互项包括为“var”

我只使用了 2 周的 R，而且我没有任何编程背景，所以请解释我想要理解的任何帮助。

这是我的数据样本：

```
Sample ID   var trait 1 trait 2 trait 3 SNP1    SNP2    SNP3
77856517    2   188      3       2        1      0       0
375689755   8   17      -1      -1        1     -1      -1
392513415   8   28       14      4        1      1       1
393612038   8   85       14      6        1      1       0
401623551   8   152      11     -1        1      0       0
348466144   7   -74      11      6        1      0       0
77852806    4   81       16      6        1      1       0
440614343   8   -93      8       0        0      1       0
77853193    5   3        6       5        1      1       1 
```

这是我一直用于单次回归的代码：

```
result1 <-lm(trait1~SNP1+var+SNP1*var, na.action=na.exclude) 
```

我想运行一个循环，每个特征都针对每个 SNP 进行测试。

我一直在尝试修改我在网上找到的代码，但我总是遇到一些我不明白如何解决的错误。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-31T20:50:29.430

就我个人而言，我并不觉得问题那么容易。特别适合 R 新手。

这是一个基于动态创建回归公式的解决方案。这个想法是使用`paste`函数来创建不同`y~ x + var + x * var`的公式术语，然后使用`as.formula`. 这里是公式动态项：c(trait1,trai2,..) 中的 y 和 c(SNP1,SNP2,...) 中的 x `y`。`x`当然在这里我使用`lapply`循环。

```
lapply(1:3,function(i){
 y <- paste0('trait',i)
 x <- paste0('SNP',i)
 factor1 <- x
 factor2 <- 'var'
 factor3 <- paste(x,'var',sep='*')
 listfactor <- c(factor1,factor2,factor3)
 form <- as.formula(paste(y, "~",paste(listfactor,collapse="+")))
 lm(formula = form, data = dat)
}) 
```

我希望有人提供更简单的解决方案，或者更多的 R-ish 解决方案:)

**编辑**

感谢@DWin 评论，我们可以将公式简化为，因为`y~x*var`它意味着`y`由和`x``var``x*var`

所以上面的代码将被简化为：

```
 lapply(1:3,function(i){
     y <- paste0('trait',i)
     x <- paste0('SNP',i)
     LHS <- paste(x,'var',sep='*')
     form <- as.formula(paste(y, "~",LHS)
     lm(formula = form, data = dat)
    }) 
```

# ruby - rubymonk“数组中的所有元素都是Fixnum”？

> ID：15733980
> 
> 赞同：1
> 
> 时间：2013-03-31T20:09:57.090
> 
> 标签：ruby

[http://rubymonk.com/learning/books/1/problems/148-array_of_fixnum](http://rubymonk.com/learning/books/1/problems/148-array_of_fixnum)

红宝石和尚建议：

```
def array_of_fixnums?(array)
  array.all? { |x| x.is_a? Fixnum }
end 
```

这很好，但是下面的代码在 irb 1.9.2 中工作，但是当 ruby​​monk 传递一个空数组时失败：

```
def array_of_fixnums?(array)
  result = false
  array.each { |n|
    if n.is_a? Fixnum
      result = true
    else
      result = false
    end }
  result
end 
```

这是 irb 输出：

```
1.9.2-p320 :001 > array_of_fixnums? []
 => false 
```

以下是 ruby​​monk 对我的解决方案的评价：

```
returns 'true' for [1,2,3] ✔
returns 'false' for ['a',1,:b] ✔
returns 'true' for []
    RSpec::Expectations::ExpectationNotMetError
    expected false to be true 
```

我想知道为什么会这样？

根据答案更新：

```
def array_of_fixnums?(array)
  result = true
  array.each { |n| return false unless n.is_a? Fixnum }
  result
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:23:12.307

您的代码有两个问题：

1.  这个问题的措辞有点模糊。他们真正想要的是，如果任何元素不是 Fixnums，则返回 false，否则返回 true——因此空数组应该返回 true。如果您查看您的代码，您会发现它`result`以 false 开头，因此如果数组为空，即使测试认为它应该为 true，它也会返回 false。你可以从 true 开始解决这个问题。

2.  您的代码实际上只是检测数组的*最后一个元素是否是 Fixnum。*我们来看看数组`[1, "nope", 3]`。它首先会看到 1 并设置`result`为 true，然后会看到“nope”并设置`result`为 false，然后会看到 3 并设置`result`为 true，这就是方法将返回的内容。RubyMonks 测试实际上并没有检测到这个错误，但它会出现在现实世界中。您希望在得到错误结果后立即返回，因为这足以确定数组*不是*所有的 Fixnums。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T20:22:39.930

对于这种情况，您将永远不会进入每个循环，因为`array`. `result`因此，您返回在上面的行中设置为 false的默认值。但是，如果数组中没有元素，那么它的所有元素都是 Fixnums，因此您应该返回 true。

# prolog - 用 prolog 解决符号逻辑

> ID：15733986
> 
> 赞同：1
> 
> 时间：2013-03-31T20:10:21.877
> 
> 标签：prolog, logic, puzzle

我正在做一些[刘易斯卡罗尔逻辑测验](http://www.yesfine.com/carroll_symbolic_logic.htm) ，我在那个页面上有一个谜语号 60 的问题：

```
(1) The only animals in this house are cats; 
(2) Every animal is suitable for a pet, that loves to gaze at the moon; 
(3) When I detest an animal, I avoid it; 
(4) No animals are carnivorous, unless they prowl at night; 
(5) No cat fails to kill mice; 
(6) No animals ever take to me, except what are in this house; 
(7) Kangaroos are not suitable for pets; 
(8) None but carnivora kill mice; 
(9) I detest animals that do not take to me; 
(10) Animals, that prowl at night, always love to gaze at the moon. 
Univ. "animals"; a = avoided by me; b = carnivora; c = cats; d = detested by me;
e = in this house; h = kangaroos; k = killing mice; l = loving to gaze at the moon;
m = prowling at night; n = suitable for pets, r = taking to me. 
```

现在我想出了以下 Prolog 程序：

```
animal(cat).
animal(kangaroo).

prowl_at_night(cat).

carnivore(A) :- prowl_at_night(A).

loves_moongazing(A) :- prowl_at_night(A).

animals_in_house(cat).

suitable_pet(A) :-
    animal(A),
    A \= kangaroo,
    loves_moongazing(A).

can_kill_mice(cat).
can_kill_mice(A) :- carnivore(A).

take_to_me(A) :- animals_in_house(A).

detest(A) :- \+ take_to_me(A).

avoid(A) :- animal(A), detest(A). 
```

现在首先我不确定`taking to me`实际上是什么意思。其次，如果我查询 Prolog: `?- avoid(A)`unifies with `A = kangoroo` which 是正确的答案，但我觉得奇怪的是，`take_to_me`and`can_kill_mice` 谓词不用于得到这个答案。也许我没有看到明显的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T20:39:46.267

“接受”某事意味着依附于它。

如果 A 是动物并且您讨厌它，则避免（A）满足。你讨厌不喜欢你的东西。只有当它是家畜时，你才会接受它。因此，袋鼠是正确的答案。

# c# - C# Windows 窗体应用程序在顶部

> ID：15733991
> 
> 赞同：0
> 
> 时间：2013-03-31T20:10:41.510
> 
> 标签：c#, winforms

我想知道 Windows 窗体程序是否可以覆盖指针。

我想将动画作为 C# WinForm 应用程序的一部分，并在一切之上，甚至是指针，是否有可能，如果可以，该怎么办？

ps 这个问题也延伸到桌面弹出菜单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:15:40.507

您可以在动画运行时隐藏光标，然后在动画完成后再次显示。

```
cursor.Hide(); 
```

# javascript - jQuery动画队列：false无法同时制作动画

> ID：15733995
> 
> 赞同：3
> 
> 时间：2013-03-31T20:11:26.153
> 
> 标签：javascript, jquery, ajax, jquery-animate

我以前使用过 jQuery`queue`修饰符来使动画同时发生，但由于某种原因，这次我无法让它工作。

相关页面的 URL 是[http://fretfast.com](http://fretfast.com) - 当您单击左上角的“通知”时，您会看到该栏首先横向展开，然后“通知”栏展开以适应它，并且高度动画也会发生同样的事情。

这是我尝试的方法：

```
n.animate({width: em2px(35)+'px'}, {queue: false, duration: speeds['fast']/1.5});
nc.animate({width: em2px(35)+'px'}, {queue: false, duration: speeds['fast']/1.5}); 
```

where`n`是“通知”标题栏`nc`的变量，是首先展开的通知容器的变量。知道有什么问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-08-30T15:14:48.123

您的 CSS 中可能有 Transition 属性，在您尝试设置动画的选择器上。我花了很长时间才弄清楚这一点，但显然，CSS 过渡强制动画要么滞后，要么发生在所有其他动画之后，任何人都可以澄清或确认这一点吗？

一起使用 jQuery 动画和 CSS 动画可能会很棘手，有人对此有任何见解吗？尖端？

# c++ - 从给定的数字计算所有可能的数字

> ID：15733997
> 
> 赞同：2
> 
> 时间：2013-03-31T20:11:52.897
> 
> 标签：c++, algorithm, permutation, digits

问题很简单。从给定的一组数字（最多 10 位数字）中，计算可以从该数字组成的所有数字（一个数字可以多次使用它包含在该组中）。

拳头我想使用蛮力并遍历所有可能的组合，但是组合的数量与 N 的阶乘一样大，其中 N 是位数。即使有可能，我如何在不使用 10 个 for 循环的情况下运行所有​​可能的组合？

其次，我尝试将所有这些数字放在一个字符串中，然后从字符串中删除一个并放在末尾并继续这样尝试，但这可能不会给出任何可能的组合，即使它确实如此，我也不相信会在合理的时间内出现。

我确信必须有一个更快更好的算法来从给定的一组数字中获取所有可能的数字。

我在互联网上找到了一个代码，它是：

```
#include <iostream>
#include <algorithm>
using namespace std;
int main () {
    int noOfDigits;
    cin >> noOfDigits;
  int myints[noOfDigits];
  for(int i = 0; i<noOfDigits; i++)
  {
      cin >> myints[i];
  }

  sort (myints,myints+3);
  do {
        for(int i = 0; i<noOfDigits;i++)
        {
            cout << myints[i];
        }
        cout << endl;
  } while ( next_permutation(myints,myints+noOfDigits) );
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T20:42:39.783

我的方法可能看起来有点复杂，但我会先给出一个概述和一些非常简单的示例代码（来自错误的语言）。

正如您所说，您从根本上想要元素的所有排列。因此，显而易见的方法是使用已经执行此操作的库函数。也许[std::next_permutation](http://www.cplusplus.com/reference/algorithm/next_permutation/)（我将使用[intertools.permutations](http://docs.python.org/2/library/itertools.html?highlight=permutations#itertools.permutations)作为我的简单示例）。但是，您指定您的输入集中可能有重复的元素，这违反了对该工具的约束。

所以我的方法是在一组唯一键和我们的元素（数字）之间建立一个映射，它们可能存在重复。对于您描述的少量数字，最简单的方法是使用单个字符作为键，将它们（当然是通过字典）映射到给定的元素（数字）。一种方便的方法是通过[string.printable](http://docs.python.org/2/library/string.html?highlight=string.printable#string.printable)。*因此，给定一个名为mydigits*的元组、列表或其他“数字”序列，我们可以将映射构建为：

```
#!python
import string
digit_mapping = dict([(y,x) for x,y in zip(mydigits,string.printable)]) 
```

从那里我们所要做的就是遍历排列并将键映射回它们的原始“数字”（在这种情况下，这些“数字”的字符串表示

```
#!python
for i in itertools.permutations(digit_mapping.keys()):
    perm = ''.join([str(digit_mapping[x]) for x in i])
    print perm, 
```

*...当然，如果您想以某种特定的顺序而不是.keys()*方法和*itertools.permutations()*函数所做的任何事情来打印这些排列，那么您可能需要稍微改变一下。（这些是实现细节）。

那么，您能否创建这样的映射，遍历其键的排列，并在返回/打印结果时执行映射取消引用？

# python - Python：从导入类调用方法

> ID：15733999
> 
> 赞同：1
> 
> 时间：2013-03-31T20:12:18.180
> 
> 标签：python, oop, class

好吧，我想我的问题之前已经被问过，但我真的不知道使用哪些术语来搜索它，所以如果这是重复的，请道歉。

我的问题是如何从创建当前类实例的类中调用方法？例如我们有：

```
class First:
    def __init__(self):
        self.text = "This is a text in First class"
        self.second = Second()

class Second:
    def __init__(self):
        print "How to show self.text from First?" 
```

我现在这样做的方式是在启动类时`self`从类`First`作为参数传递`Second`，`self.second = Second(self)`但我不确定这是否是正确的方法。我还发现可以通过创建`Second`的子类来实现`First`，但我仍然不确定这是否是正确的方法。

你能帮我解答吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T20:19:11.553

您可以这样做：

```
class First:
    def __init__(self):
        self.text = "This is a text in First class"
        self.second = Second(self)

class Second:
    def __init__(self, first):
        self.first = first
        print "How to show self.text from First?"
        print self.first.text 
```

以这种方式相互了解并使用彼此属性的对象，我担心，很可能会违反[德米特法则](http://en.wikipedia.org/wiki/Law_of_Demeter)或使彼此难以区分。并且区分它们对于编写“好”类非常重要。所以要小心处理！

其他解决方案：传递文本：

```
class First:
    def __init__(self):
        self.text = "This is a text in First class"
        self.second = Second(self.text)

class Second:
    def __init__(self, text):
        self.text = text
        print "How to show self.text from First?"
        print self.text 
```

这也很OK。我比第一个解决方案更喜欢它。但是当有更多的参数出现时， text1, text2, text3, ... 这可能是一个新对象。

```
class First(object):
    @property
    def text(self):
        "get text from self.second"
        return self.second.text

    def __init__(self):
        self.second = Second("This is a text in First class")
        print self.text

class Second:
    def __init__(self, text):
        self.text = text
        print "How to show self.text from First?"
        print self.text 
```

我认为这对于同步文本来说也是一个很好的解决方案。但我想不出一个我真正需要它的例子。