# StackOverflow 问答 14711000-14711999

# date - 如何更改tomcat服务器日期？

> ID：14711007
> 
> 赞同：5
> 
> 时间：2013-02-05T15:28:42.740
> 
> 标签：date, tomcat, cron

我需要更改 tomcat 服务器日期，以检查我的 cron 表达式是否会在需要的日期和时间触发。我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-05T15:30:31.477

您需要更改底层操作系统的日期。Tomcat 没有单独的时钟。之后您还应该重新启动tomcat..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T15:35:13.770

Try to check in web.inf file if by any parameter is their from where you can change the date. Otherwise as earlier comment change the system date and restart the server.

# php - 正则表达式：匹配以 http/https 或仅 site.com/... 开头但不带前缀的链接？

> ID：14711009
> 
> 赞同：1
> 
> 时间：2013-02-05T15:28:46.167
> 
> 标签：php, regex

我需要匹配链接，但只有那些不以字符串 [image:x] 开头的链接，其中 x 是链接本身。

我需要在 preg_replace 中使用它，以便仅更改适合的链接，这是一个示例：

> “有一次狗吃了我的书`http://mysite.com/dog.jpg`，我不得不去商店`https://www.mysite.com/images/store.png`买一个新的 iPad `apple.com/iPad/iPadMini.jpg` ，这很有趣 [ `image:http://apple.com/iPad/images/iPads.com`]”

将导致

> “有一次狗吃了我的书`[image:http://mysite.com/dog.jpg]`，我不得不去商店`[image:https://www.mysite.com/images/store.png]`买一个新的 iPad `[image:apple.com/iPad/iPadMini.jpg]` ，这很有趣 [ `image:http://apple.com/iPad/images/iPads.com`]”

注意最后一个链接，因为现在我把它加倍了（链接仍然被 preg_replace 拾取）。像这里（不是想要的效果，我需要它原封不动）：

> `...[image:apple.com/iPad/iPadMini.jpg]` 那里很有趣
> [ `image:[image:http://apple.com/iPad/images/iPads.com]]`“

这是我现在的 preg_replace ：

```
preg_replace('~(https?://)?[\w-]+(\.[\w-]+)+\.?(:\d+)?(\S*)\.(jpg|png|jpeg|bmp|gif)~','[[image:$0]]',$text); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:38:21.660

您可以使用[否定的lookbehind](http://www.regular-expressions.info/lookaround.html)。

我们不希望它以 '[image:' 开头。我们也不想从一个单词的中间开始。这是防止使用`\b`. 如果以它开头的字符串`http://`应该包含在匹配中，所以不要在`http://`or之后匹配`https://`。

```
preg_replace('~(?<!\[image:)(?<!http://)(?<!https://)(?<!\w\.)(https?://)?\b[\w-]+(\.[\w-]+)+\.?(:\d+)?(\S*)\.(jpg|png|jpeg|bmp|gif)~','[image:$0]',$text); 
```

检查这个[PHP 小提琴](http://phpfiddle.org/main/code/85z-027)

*注意：这也不会用最终`]`缺失的字符串替换字符串，例如`[image:example.com`.*

# c# - 我如何知道 MonoTouch 中的 UIDevice 模型？

> ID：14711015
> 
> 赞同：1
> 
> 时间：2013-02-05T15:28:53.570
> 
> 标签：c#, ios, xamarin.ios, uidevice

我想在 MonoTouch 中获得精确的设备型号（例如 iPad 3）。
我已经[在 Objective C 中](https://stackoverflow.com/q/1108859/458193)看到过它，但我还没有找到正确的 P/Invokes。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T15:46:37.740

我从几个地方把它改成了我需要的，所以我不能完全相信它。有一个必须更新的枚举真的很臭，但是哦，好吧。

但这就是我所拥有的：

```
public static class DeviceHelper
{
    public const string HardwareProperty = "hw.machine";
    public static readonly string PLATFORM;

    public static bool IsTall
    {
        get
        {
            return UIDevice.CurrentDevice.UserInterfaceIdiom
                == UIUserInterfaceIdiom.Phone
                    && UIScreen.MainScreen.Bounds.Height
                    * UIScreen.MainScreen.Scale >= 1136;
        }
    }

    [DllImport(MonoTouch.Constants.SystemLibrary)]
    static internal extern int sysctlbyname([MarshalAs(UnmanagedType.LPStr)] string property, IntPtr output, IntPtr oldLen, IntPtr newp, uint newlen);

    static DeviceHelper ()
    {
        var pLen = Marshal.AllocHGlobal(sizeof(int));
        sysctlbyname(HardwareProperty, IntPtr.Zero, pLen, IntPtr.Zero, 0);

        var length = Marshal.ReadInt32(pLen);

        var pStr = Marshal.AllocHGlobal(length);
        sysctlbyname(HardwareProperty, pStr, pLen, IntPtr.Zero, 0);

        var hardwareStr = Marshal.PtrToStringAnsi(pStr);

        var ret = HardwareVersion.Unknown;

        if (hardwareStr == "iPhone1,1")
            ret = HardwareVersion.iPhone;
        else if (hardwareStr == "iPhone1,2")
            ret = HardwareVersion.iPhone3G;
        else if (hardwareStr == "iPhone2,1")
            ret = HardwareVersion.iPhone3GS;
        else if (hardwareStr == "iPhone3,1")
            ret = HardwareVersion.iPhone4;
        else if (hardwareStr == "iPhone3,3")
            ret = HardwareVersion.VerizoniPhone4;
        else if(hardwareStr == "iPhone4,1")
            ret = HardwareVersion.iPhone4S;
        else if(hardwareStr == "iPhone 5,1" || hardwareStr == "iPhone 5,2")
            ret = HardwareVersion.iPhone5;
        else if (hardwareStr == "iPad1,1")
            ret = HardwareVersion.iPad;
        else if (hardwareStr == "iPad2,1")
            ret = HardwareVersion.iPad2WIFI;
        else if (hardwareStr == "iPad2,2")
            ret = HardwareVersion.iPad2GSM;
        else if (hardwareStr == "iPad2,3")
            ret = HardwareVersion.iPad2CDMA;
        else if (hardwareStr == "iPad2,4")
            ret = HardwareVersion.iPad2WIFI24;
        else if (hardwareStr == "iPad3,1")
            ret = HardwareVersion.iPad3WIFI;
        else if (hardwareStr == "iPad3,2")
            ret = HardwareVersion.iPad3GSM;
        else if (hardwareStr == "iPad3,3")
            ret = HardwareVersion.iPad3CDMA;
        else if (hardwareStr == "iPod1,1")
            ret = HardwareVersion.iPod1G;
        else if (hardwareStr == "iPod2,1")
            ret = HardwareVersion.iPod2G;
        else if (hardwareStr == "iPod3,1")
            ret = HardwareVersion.iPod3G;
        else if (hardwareStr == "iPod4,1")
            ret = HardwareVersion.iPod4G;
        else if (hardwareStr == "i386" || hardwareStr=="x86_64") {
            if (UIDevice.CurrentDevice.Model.Contains("iPhone"))
                ret = UIScreen.MainScreen.Bounds.Height * UIScreen.MainScreen.Scale == 960 || UIScreen.MainScreen.Bounds.Width * UIScreen.MainScreen.Scale == 960 ? HardwareVersion.iPhone4Simulator : HardwareVersion.iPhoneSimulator;
            else
                ret = HardwareVersion.iPadSimulator;
        }

        if(ret == HardwareVersion.Unknown)
            PLATFORM = hardwareStr;
        else
            PLATFORM = ret.ToString();
    }

    public enum HardwareVersion {
        iPhone,
        iPhone3G,
        iPhone3GS,
        iPhone4,
        VerizoniPhone4,
        iPhone4S,
        iPhone5,
        iPod1G,
        iPod2G,
        iPod3G,
        iPod4G,
        iPad,
        iPad2WIFI,
        iPad2WIFI24,
        iPad2GSM,
        iPad2CDMA,
        iPad3WIFI,
        iPad3GSM,
        iPad3CDMA,
        iPhoneSimulator,
        iPhone4Simulator,
        iPadSimulator,
        Unknown
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T15:57:53.650

我以[这个答案](https://stackoverflow.com/a/10494590/458193)为基础。
我不确定这是最短的方法，但它有效。

```
[DllImport ("libc", CallingConvention = CallingConvention.Cdecl)]
static extern int sysctlbyname (string name, StringBuilder value, ref IntPtr length, IntPtr newp, IntPtr newlen);

public static string GetDeviceName (this UIDevice device)
{
    IntPtr size = (IntPtr) 8;
    var sb = new StringBuilder ();

    string param = "hw.machine";
    sysctlbyname (param, sb, ref size, IntPtr.Zero, (IntPtr) 0);

    return sb.ToString ();
} 
```

# c++ - Boost 可以完全替代 C++ 标准库吗？

> ID：14711018
> 
> 赞同：5
> 
> 时间：2013-02-05T15:29:00.063
> 
> 标签：c++, boost, c++-standard-library

假设我有最小的标头，例如`<new>`, `<initializer_list>`，也许还有其他一些东西，是否可以使用 Boost 作为标准 C++ 库，或者是否缺少很多代码？

我假设一个 C 标准库，它可能有一些糟糕的版本，比如（想想 Windows），Boost 会在（或其他东西）`printf`中提供更好的实现吗？`<boost/cstddef>`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T15:45:50.027

不，Boost 不是为了*取代*C++ 标准库而设计的；它旨在*补充*和*扩展*C++ 标准库。此外，Boost 在很大程度上依赖于 C++ 标准库。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-05T15:31:24.253

嗯，不。例如，Boost 没有定义封装*标准 out*的流。当然，您可以将`STDOUT` *其自身*与一些较低级别的函数一起使用，但按照这种逻辑，您几乎可以在不使用标准库的情况下完成所有工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T15:42:45.593

我建议使用 Boost 或任何其他真正的跨平台库来处理任何可能依赖于平台的东西。联网/锁定等

对于其他一切，我会坚持使用标准库——它们有很好的文档记录，它们通常针对操作系统进行了优化，除了你可能需要在这里和那里忍受的一些 ifdef 之外，它们会编译和运行良好在大多数平台上。

# php - 将论坛 ID 呼应到新页面以显示内容？

> ID：14711020
> 
> 赞同：0
> 
> 时间：2013-02-05T15:29:11.777
> 
> 标签：php, mysql

有人可以帮助我创建我的论坛时遇到问题。

在用户可以创建帖子的那一刻，帖子标题列在页面下方，然后假设用户能够单击标题链接并被带到 read_post.php，然后这应该将用户带到帖子所在的另一个页面可以查看内容，我试图通过回显论坛帖子 ID 来做到这一点，但它似乎不想工作，而是我收到此错误：

```
Database query failed: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 3 
```

有人可以告诉我我哪里出错了。

这是我的sql函数：

```
function read_forum() {
            global $connection;
            global $forum_id;
            $query = "SELECT *
                        FROM ptb_forum, ptb_profiles
                        WHERE ptb_forum.id = $forum_id ";
            $forum_set = mysql_query($query, $connection);
            confirm_query($forum_set);
            return $forum_set;
        } 
```

这是将用户带到 read_post.php 的链接代码，它假设回显论坛 ID 并显示每个帖子的内容。

```
<?
$forum_set = get_forum();
while ($forum = mysql_fetch_array($forum_set)) {
?>

            <div class="forumcase" id="forumcase">
                 <div class="pend-forum-content">
                 <?php echo "<strong><a href=\"read_post.php?post={$forum_id['id']}\">{$forum['title']}</a></strong> - Posted by {$user['first_name']}"; ?>
                 </div>

here's my code for read_post.php:

    <?php
        $page_title = "Read Post";
        include('includes/header.php'); 
        include ('includes/mod_login/login_form2.php');  ?>

        <?php
        confirm_logged_in();

        if (isset ($_GET['frm'])) {
        $forum_id = $_GET['frm'];
    }

    ?>

    <?php include('includes/copyrightbar.php'); ?>
    <div class="modtitle">
    <div class="modtitle-text">Messages Between <?php echo "{$forum['display_name']}"; ?> & You</div>
    </div>

    <div class="modcontent57">

    <br /><br /><br/><br/>

    <div class="forum">
    <div class="forum-pic"><?php echo "<img src=\"data/photos/{$_SESSION['user_id']}/_default.jpg\" width=\"100\" height=\"100\" border=\"0\" align=\"right\" class=\"img-with-border-forum\" />";?>
    </div>

    <div class="message-links">
    <strong><a href="forum.php"><< Back to Forum</a>
    </div> 
    <br /><br /><br/><br/>
    <?php 

        $datesent1 = $inbox['date_sent'];  ?>

    <?php
            $forum_set = read_forum();
            while ($forum = mysql_fetch_array($forum_set)) {
            $prof_photo = "data/photos/{$message['user_id']}/_default.jpg";

            $result = mysql_query("UPDATE ptb_forum SET ptb_forum.read_forum='1' WHERE ptb_forum.id='$forum_id'") 
    or die(mysql_error()); 

    ?>
    <div class="message-date">
    <?php echo "".date('D M jS, Y  -  g:ia', strtotime($message['date_sent'])).""; ?></div>

    <div class="img-with-border-msg-read"><?php echo "<a href=\"profile.php?id={$forum['from_user_id']}\"><img width=\"60px\" height=\"60px\" src=\"{$prof_photo}\"></a><br />"; ?></div>

    <div class="conversation-text">
    <?php echo "<i>Conversations between you and<a href=\"profile.php?id={$forum['from_user_id']}\"> </i>{$forum['display_name']}.</a><br /> "; ?></div>

    <div class="message-content">  
    <?php echo "<strong>Message Subject: </strong><i>{$forum['subject']}</i>"; ?>
    <br/>
    <br/>
    <br/>
    <br/>

    <?php echo  "<strong>Message:<br/></strong></br ><i>{$forum['content']}</i>"; ?>
    </div>

    <div class="reply-box">
    <? include ('message_reply.php'); ?>    
      </div>

    <?php
    }
    ?>
    <br/>
    <br/>
    <br/>

          </div>
          </div>

    <?php include('includes/footer.php'); ?>
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:35:48.997

You have an error in your query... Your parameter is not quoted...

```
 $query = "SELECT *
     FROM ptb_forum, ptb_profiles
     WHERE ptb_forum.id = '$forum_id'"; 
```

However... I suggest that you refrain from using the `mysql_` family of functions. They are deprecated and due to be removed from PHP in a future release. You should be using parameterized queries using MySQLi or PDO.

Also, `global` is evil. I've never had a need to use it in 10 years of PHP programming. Neither should you.

# jquery - 仅 IE10 中的 JQuery attr('src') iframe 缓存问题

> ID：14711021
> 
> 赞同：1
> 
> 时间：2013-02-05T15:29:16.457
> 
> 标签：jquery, caching, iframe, attr, internet-explorer-10

IE10 是唯一不刷新图库中 iframe 的浏览器。

iframe 是外部服务的嵌入代码，因此设置缓存元标记将不起作用。我尝试将 iframe 源设置为自身（根据几个论坛，iframe.src = iframe.src 或等效项），删除 iframe 并重新附加它（认为 iframe 的唯一实例会刷新）。

让 iframe 刷新的唯一方法是右键单击并在浏览器中选择“刷新”。有没有人成功解决了这个问题？

更新：作为一个实验，我尝试使用完全不同的外部 URL 实例化一个新的 iframe。此 iframe 也不会自动重新加载，需要强制刷新。有没有办法解决？

# bigdata - Storm 实时处理：如果宕机了怎么办？

> ID：14711025
> 
> 赞同：1
> 
> 时间：2013-02-05T15:29:39.707
> 
> 标签：bigdata, apache-storm

Storm 是一个免费的开源分布式实时计算系统。它接收数据流并对其进行处理。如果 Storm 出现故障并且部分数据从未通过它，这意味着计算将不同步怎么办？

Storm 如何解决这个问题？如果不能，如何解决这个问题？

一个类似的问题是：如何读取在添加 Storm 之前存在的旧数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T16:31:28.810

> 如何读取在添加 Storm 之前存在的旧数据？

数据必须存储在某个地方（例如 HDFS）。您编写了一个 Spout，它接受来自某些传输（例如 JMS）的数据。然后，您需要编写重放代码以从 HDFS 读取适当的数据，将其放在 JMS 通道上，Storm 会处理它。诀窍是知道你需要在数据中回溯多远，这可能是外部系统的责任，比如重放代码。这个重放代码可以查询数据库，或者 Storm 的处理结果，不管它们是什么。

总体而言，“如果它下降了怎么办”问题取决于您正在执行哪种类型的计算，以及您的系统是否处理背压。简而言之，流的大部分持久性取决于传递给 Storm 的消息传递/传输机制。

示例：如果您需要简单地转换 (xslt) 单个事件，则不会发生实时故障，并且如果 Storm 发生故障，也不会出现状态问题。您只需启动备份并恢复处理。

提供饲料的系统可能需要处理背压。[像Kafka](http://kafka.apache.org/%20Kafka)这样的消息传输可以处理持久的消息，并允许 Storm 从中断的地方继续。

需要详细说明导致“计算不同步”的特定用例，以提供更好、更具体的答案。

# shell - 自动加密/解密：检测文件在 Mate/Gnome 应用程序中关闭

> ID：14711026
> 
> 赞同：0
> 
> 时间：2013-02-05T15:29:41.007
> 
> 标签：shell, filesystems, gnome, inotify, mate

我正在编写一个 bash 脚本来自动解密文件以进行编辑，并在文件关闭后将其加密回来。文件类型可以是任何类型：纯文本、办公文档等。我在 Linux Mint 和 Mate 上。

我被卡住了：无法可靠地检测文件是否在应用程序中关闭，以便脚本可以继续对其进行加密并删除解密版本。

该脚本的第一个版本只是将 vim 与文本文件一起使用。脚本直接调用它，直到 vim 关闭才继续。现在，由于我希望能够对其他文件执行此操作，因此我尝试了以下操作：

xdg-open：调用与文件类型关联的应用程序后立即退出。因此脚本继续并且没有好处。

xdg-open 用于调用关联应用程序的修改函数：在当前脚本中运行它，所以现在我看到程序退出。仅在应用程序尚未运行时才有效。如果有，则新进程完成，脚本继续。

所以我现在要做的就是以某种方式观察该文件在已经运行的应用程序中被关闭。目前正在尝试使用 pluma/gedit 和 inotifywait。它也不起作用 - 打开文件后立即检测到*CLOSE_NOWRITE,CLOSE*事件。

如果没有针对不同应用程序的特定钩子，是否有可能检测到这一点？可能有一些 X 钩子？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-08T20:31:45.913

你可能会做这样的事情。

```
decrypt "TheFile"&
pluma "TheFile"
encrypt "TheFile" 
```

行`&`尾的 将执行该行然后落到 Pluma。脚本将暂停，直到 pluma 关闭。

如果您发布脚本，我可以提供更多帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-24T18:54:31.143

您可以使用 lsof 来确定文件是否被进程打开：

```
myFile="/home/myUser/myFile"
/usr/sbin/lsof "$myFile" | grep "$myFile" 
```

您可以使用 1 秒循环并等待 lsof 响应为空。我已经使用它来帮助防止脚本打开仍在写入或下载的新发现文件。

并非所有进程在使用文件时都会打开文件。例如，vim 保持打开一个临时文件 (/home/myUser/.myFile.swp) 并且可能仅在加载或保存时打开真实文件。

# c++ - 如何使用 wm_deadchar 发送非 Ascii 标志

> ID：14711030
> 
> 赞同：0
> 
> 时间：2013-02-05T15:29:49.540
> 
> 标签：c++, windows, winapi

我正在尝试使用函数 keybd_event 发送变音键事件。Windows 文档指出：“死键是生成字符的键，例如元音变音（双点），它与另一个字符组合形成复合字符。例如，元音变音-O 字符 (Ö ) 是通过键入元音变音字符的死键，然后键入 O 键生成的。”

我如何发出死键？

我尝试了以下但没有成功：

```
keybd_event(WM_DEADCHAR,0x0103,0,0);
keybd_event(0x4F,0,0,0); 
```

对不起，我的英语不好。我期待你的回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T12:36:29.467

的第一个参数`keybd_event`是虚拟键代码。例如，对于我的键盘，死键`"`是`VK_OEM_7`.

# css - 如果一个孩子有某个特定的价值，如何检查并使“真”，以便父母的悬停产生结果？

> ID：14711032
> 
> 赞同：0
> 
> 时间：2013-02-05T15:29:54.863
> 
> 标签：css, css-selectors

好吧，我知道，标题用词很糟糕。我真的不知道该怎么形容这个。

我正在编辑一个“网站”，但我无权访问 HTML、Javascript 或 PHP 或其他任何东西。只有 CSS，我可以创造性地操纵网站中已经呈现的 HTML。

```
<div id="list">
<table>
 <tbody>
  <tr>
   <td class="td1">blahblahblah</td>
   <td class="td1">blahblahblah</td>
   <td class="td1">blahblahblah</td>
   <td class="td1"><a href="bleach.com">Bleach</td>
   <td class="td1">Score: 9</td>
  </tr>
 <tbody>
</table>

<table>
 <tbody>
  <tr>
   <td class="td2">blahblahblah</td>
   <td class="td2">blahblahblah</td>
   <td class="td2">blahblahblah</td>
   <td class="td2"><a href="naruto.com">Naruto</a></td>
   <td class="td2">Score: 10</td>
  </tr>
 <tbody>
</table>
</div> 
```

所以这基本上是它的设置方式。这是2部动漫，漂白剂和火影忍者。Naruto 的得分是 10，Bleach 的得分是 9。我的目标是选择包含得分为 10 的动画的父表，这样我就可以在得分为 10 的动画表中使用关键帧设置特定的悬停动画事件悬停在上方。

现在设置的方式是，我认为除了手动选择每个得分为 10 的动画之外，没有其他方法可以通过执行 #list > table > td:nth-of-type(4) 之类的操作[href*="naruto.com"] 虽然我不确定这是否相关。这就是我可以选择孩子的方式，但是如何选择表格父级以设置悬停样式？一定有办法的。:(

感谢您提供的任何帮助。如果您在第二天发表评论，我应该能够立即回复。

谢谢。

**请记住，我不能简单地给一个表一个类或 id。我无权在设置的 HTML 中添加或编辑任何内容。所以我需要想出一个不同的方法。此外，通过执行 #list table:nth-of-type(n) 选择表格是不可能的，因为表格列表将不断变化（添加/删除表格），可以排序（改变 n），并且纯粹音量（我们说的是数百张桌子）等，这会使它失去作用。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:37:32.503

仅使用 CSS 是不可能的。您至少需要选择一个属性。有一个`:content`针对 CSS 3 的选择器的提议，但最终没有出现在规范中。（[更多信息在这里](https://stackoverflow.com/questions/1520429/css-3-content-selector)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:05:09.223

我的精神没有消沉。我想出了一个办法。通过操纵另一个 td 我不需要它在得分为 10 的表格中并将其设置为透明并将其定位在整个表格上，使其 z-index 为 1，以及表格中的所有其他元素z-index 为 2，我可以按照我的意愿使表悬停事件发生。:) 我只是在这里发布这个，以防有人遇到这样的问题，这也可能对他们有所帮助。

# c# - 从 HttpResponseMessage 获取内容以使用 c# 动态关键字进行测试

> ID：14711038
> 
> 赞同：14
> 
> 时间：2013-02-05T15:30:16.390
> 
> 标签：c#, unit-testing, asp.net-web-api

在其中一个动作中，我做了这样的事情

```
public HttpResponseMessage Post([FromBody] Foo foo)
{
    .....
    .....

    var response = 
          Request.CreateResponse(HttpStatusCode.Accepted, new { Token = "SOME_STRING_TOKEN"});
    return response;
} 
```

和更多类似的方法返回一个匿名类型实例，并且效果很好。

现在，我正在为它编写测试。我有

```
HttpResponseMessage response = _myController.Post(dummyFoo); 
```

[`HttpResponseMessage`](http://msdn.microsoft.com/en-us/library/hh159046.aspx)有一个名为的属性[`Content`](http://msdn.microsoft.com/en-us/library/system.net.http.httpresponsemessage.content.aspx)，并且有一个`ReadAsAsync<T>()`.

我知道如果有具体的特定类型，我可以做

```
Bar bar = response.Content.ReadAsAsync<Bar>(); 
```

但是如何访问返回的匿名类型？是否可以？

我希望做到以下几点：

```
dynamic responseContent = response.Content.ReadAsAsync<object>();
string returnedToken = responseContent.Token; 
```

但我得到了类型对象实例没有属性令牌的错误。即使调试器显示带有一个属性 Token 的 responseContent，也会发生这种情况。我明白为什么会这样，但我想知道是否有办法访问该物业。

![在此处输入图像描述](../Images/7d820e84994d977aa89a4bb6bbb712d5.png)

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-05T15:49:15.553

`.ReadAsAsync<T>`是一个异步方法，这意味着它不返回整个反序列化的对象，而是一个`Task<T>`处理整个异步任务的延续。

你有两个选择：

### 1\. 异步模式。

在您的封闭方法中使用`async`关键字（例如：）`public async void A()`并以这种方式进行异步调用：

```
dynamic responseContent = await response.Content.ReadAsAsync<object>();
string returnedToken = responseContent.Token; 
```

### 2.常规任务API

或者只使用任务 API：

```
response.Content.ReadAsAsync<object>().ContinueWith(task => {
   // The Task.Result property holds the whole deserialized object
   string returnedToken = ((dynamic)task.Result).Token;
}); 
```

由你决定！

## 更新

在您发布整个屏幕截图之前，没有人知道您打电话`task.Wait`是为了等待异步结果。但我会保留我的答案，因为它可能会帮助更多的访客:)

正如我在对自己的答案的评论中建议的那样，您应该尝试反序列化为`ExpandoObject`. ASP.NET WebAPI 使用 JSON.NET 作为其底层 JSON 序列化程序。也就是说，它可以处理匿名 JavaScript 对象反序列化为 expando 对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-03T10:27:53.990

您还可以使用类似的以下代码使用单元测试来测试 HttpResponseMessage。

这对我有用。

希望对你有帮助

```
[TestClass]
    public class UnitTest
    {
        [TestMethod]
        public void Post_Test()
        {
           //Arrange
           var contoller = new PostController();  //the contoller which you want to test
           controller.Request = new HttpRequestMessage();
           controller.Configuration = new HttpConfiguration();

           // Act
           var response = controller.Post(new Number { PhNumber = 9866190822 });
           // Number is the Model name and PhNumber is the Model Property for which you want to write the unit test

           //Assert
           var request = response.StatusCode;
           Assert.AreEqual("Accepted", request.ToString());

        }
    } 
```

同样根据需要改变Assert中的HttpResponseMessage。

# jvm - MuleStudio - 错误未能加载 JNI 共享库

> ID：14711039
> 
> 赞同：2
> 
> 时间：2013-02-05T15:30:17.880
> 
> 标签：jvm, java, mule, mule-studio

我安装了带有 32 位 JDK 的 Windows 7。

当我尝试运行 MuleStudio.exe 时，出现以下错误：

![在此处输入图像描述](../Images/2c4c59767178ccc5310e041b069dc2d1.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:30:17.880

您需要下载 32 位版本，在首页上很难找到。

**弃用通知：**该链接仅对 Mule Studio 有效，对新的 Anypoint Studio 无效。基本上认为这里的链接只是出于历史目的，有 99% 的机会这对你来说是错误的链接。

[**检查所有 Mule Studio 下载页面。**](http://www.mulesoft.org/all-mule-studio-downloads)并选择 32 位版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-17T03:12:22.427

另一种解决方案：

*   用记事本打开 AnypointStudio.ini
*   添加或编辑虚拟机

    -vm

    C:\Program Files\Java\jdk1.8.0_151\bin // 用你安装的 jdk 的路径编辑它

# ssis - SSIS 中的 OLE DB 命令无限期地持有表的排他锁

> ID：14711043
> 
> 赞同：1
> 
> 时间：2013-02-05T15:30:24.220
> 
> 标签：ssis, locking

我正在使用 SSIS 实现 upsert 操作

一般的包结构是

```
<Begin transaction>

<read config values>

<Data flow task>

<commit transaction> 
```

数据流任务包括

```
<oledb Source>

<Lookup>

<matched output to Update using oledbcommand>

<No Match output to Insert using oledbcommand> 
```

当只有插入时，包第一次运行良好

在第二次运行时，当发生一组更新，然后发生插入时，Update 语句最终在目标表上持有一个排他锁，进入睡眠状态`AWAITING COMMAND`，而 Insert 被挂起并继续等待锁.

为了检查最后一段中的语句，我使用了以下命令：

```
select * from master.sys.sysprocesses where blocked<>0 or spid in (select blocked from master.sys.sysprocesses where blocked <>0) 
```

有没有办法解决这种锁定情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T15:53:36.580

由于您明确控制您的交易，您是否将该`RetainSameConnection`属性设置为 true？否则，您将有两个以上的数据库连接到同一个资源，并在不同的事务上插入和更新同一个表，这将导致您遇到的行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T15:44:57.293

已知 OLEDB 命令存在问题。它一次在一行上执行，类似于游标。所以它很慢，特别是如果你有大量的记录要处理。我不能确切地说为什么会有锁定，但我想这是因为其他进程试图同时访问表。

最好将您的数据流任务更改为以下内容：

oledb 源码

抬头

没有匹配输出到 OLEDB 目的地，直接添加目的地，这里不需要 OLEDB 命令来进行插入。

将匹配的记录转移到目标数据库中的临时表

在控制流中，使用执行 sql 任务和更新语句来执行更新：现在执行基于集合的更新。比原来的配置更快。

SQL Server Central 上的[这篇文章介绍了实现。](http://www.sqlservercentral.com/articles/Integration+Services+%28SSIS%29/62063/)请注意，它使用的是 2005，您需要对套件 2008 的查找转换进行细微更改。

# javascript - 在 TD 中选择标签

> ID：14711044
> 
> 赞同：0
> 
> 时间：2013-02-05T15:30:25.937
> 
> 标签：javascript, dom

我在表格的一个单元格中有选择标签。仅当在前几行中选择了该选项时，我才想添加新行。我只想知道如何使用 DOM 来实现它。

这是我的 addRow javascript 函数

```
 function addRow()
  {
   var newRow = document.all("estTable").insertRow();
   var tblObj = document.getElementById("estTable");

   var noOfRow = document.getElementById("estTable").rows.length;

   var oCell = newRow.insertCell();
   oCell.innerHTML = tblObj.rows[1].cells[0].innerHTML;
   oCell.childNodes[0].selectedIndex =0;

   oCell = newRow.insertCell();
   oCell.innerHTML = tblObj.rows[1].cells[1].innerHTML;
   oCell.childNodes[0].selectedIndex =0;

   oCell = newRow.insertCell();
   oCell.innerHTML = tblObj.rows[1].cells[2].innerHTML;

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:55:39.917

您的新代码将使用：

```
var objParent = document.getElementById("someUniqueId"); 
```

`someUniqueId`您要获取其父级的行在哪里。从这里您可以随意访问父级。

# sql - 返回动态列集

> ID：14711045
> 
> 赞同：2
> 
> 时间：2013-02-05T15:30:29.580
> 
> 标签：sql, postgresql, plpgsql, dynamic-sql

我创建了以下函数来根据该函数的参数返回一组列：

```
CREATE OR REPLACE FUNCTION getColumns(IN _column1 text, IN _column2 text, IN _column3 text, IN _column4 text, IN _table text)
  RETURNS TABLE(cmf1 text, cmf2 text, cmf3 text, cmf4 text) AS
$BODY$
BEGIN
    RETURN QUERY EXECUTE 
        'SELECT ' 
            || case when _column1 = 'None' then quote_literal('None') else quote_ident(_column1) end || '::text as cmf1,' 
            || case when _column2 = 'None' then quote_literal('None') else quote_ident(_column2) end || '::text as cmf2,' 
            || case when _column3 = 'None' then quote_literal('None') else quote_ident(_column3) end || '::text as cmf3,'   
            || case when _column3 = 'None' then quote_literal('None') else quote_ident(_column3) end || '::text as cmf4'    
        ' FROM '
            ||  _table; 
END;
 $BODY$
  LANGUAGE plpgsql VOLATILE
  COST 100
  ROWS 1000; 
```

使用样本表：

```
CREATE TABLE test20130205
(
  a text,
  b text,
  c character varying,
  d text
); 
```

我可以通过以下方式使用该功能：

```
select * from getColumns('a','b','c','d','test20130205'); 
```

我确实有以下问题：

*   如何扩展此函数以将任意数量的列作为输入（目前我限制为 4），例如：

    ```
    getColumns([textColumn1,...,textColumnN],'table') 
    ```

*   目前我必须使用“无”作为参数值，以防我需要少于 4 列，有没有办法避免这种情况？我认为这将通过回答上一个问题自动解决

*   我可以以某种方式在输出中保留数据类型吗？如果没有，我可以使用更多的数组参数吗？该函数将如下所示：

    ```
    getColumns(
      [textColumn1,...,textColumnN],
      [numericColumn1,...,numericColumnM],
      [dateColumn1,...,dateColumnO],
      [intColumn1,...,intColumnP],
      'table'
    ) 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:57:04.873

如果所有列共享相同的类型，则可以使用*数组*进行操作。

更灵活的解决方案是使用[多态函数](http://www.postgresql.org/docs/current/interactive/extend-type-system.html#EXTEND-TYPES-POLYMORPHIC)，提交类型参数`anyelement`并让函数返回相同的多态类型。该参数可以是众所周知的复合类型...

这是相当高级的服务器端编程。[您可以在这个密切相关的答案](https://stackoverflow.com/a/11751557/939860)中找到这两种方法的代码示例以及解释和链接。

# python - 从两个文件中取行，输出到同一行-python

> ID：14711054
> 
> 赞同：0
> 
> 时间：2013-02-05T15:30:58.557
> 
> 标签：python, read-write

我试图打开两个文件，然后取第一个文件中的第一行，将其写入输出文件，然后取第二个文件中的第一行并将其附加到输出文件中的同一行，用制表符分隔。

我试图对此进行编码，而我的 outfile 最终成为第一个文件的全部内容，然后是第二个文件的全部内容。我包含打印语句只是因为我想在脚本运行时看到终端中发生的事情，这就是它们存在的原因。有任何想法吗？

```
import sys

InFileName = sys.argv[1]                 

InFile = open(InFileName, 'r') 

InFileName2 = sys.argv[2]

InFile2 = open(InFileName2, 'r')

OutFileName = "combined_data.txt"

OutFile = open(OutFileName, 'a')

for line in InFile:
    OutFile.write(str(line) + '\t')
    print line
    for line2 in InFile2:
        OutFile.write(str(line2) + '\n')
        print line  

InFile.close()
InFile2.close()
OutFile.close() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T15:32:35.850

您可以[`zip`](http://docs.python.org/2/library/functions.html#zip)为此使用：

```
with open(file1) as f1,open(file2) as f2,open("combined_data.txt","w") as fout:
     for t in zip(f1,f2):
         fout.write('\t'.join(x.strip() for x in t)+'\n') 
```

如果您的两个文件的行数不同（或者如果它们**真的很大**），您可以使用[`itertools.izip_longest(f1,f2,fillvalue='')`](http://docs.python.org/2/library/itertools.html#itertools.izip_longest)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:32:13.613

也许这会给你一些想法： [在python中添加来自多个文件的条目](https://stackoverflow.com/questions/14708041/adding-entries-from-multiple-files-in-python/14708146#14708146)

```
o = open('output.txt', 'wb')

fh = open('input.txt', 'rb')
fh2 = open('input2.txt', 'rb')

for line in fh.readlines():
    o.write(line.strip('\r\n') + '\t' + fh2.readline().strip('\r\n') + '\n')

## If you want to write remaining files from input2.txt:
# for line in fh2.readlines():
#     o.write(line.rstrip('\r\n') + '\n')

fh.close()
fh2.close()
o.close() 
```

这会给你：

```
line1_of_file_1        line1_of_file_2
line2_of_file_1        line2_of_file_2
line3_of_file_1        line3_of_file_2
line4_of_file_1        line4_of_file_2 
```

我的输出示例中的空格是 [tab] 注意：由于显而易见的原因，没有将行尾附加到文件中。

为此，文件 1 和 2 中的衬里都需要正确。要检查这一点：

```
print 'File 1:'
f = open('input.txt', 'rb')
print [r.read[:200]]
f.close()

print 'File 2:'
f = open('input2.txt', 'rb')
print [r.read[:200]]
f.close() 
```

这应该给你类似的东西

> 文件 1：
> ['This is\ta lot of\t text\r\nWith a few line\r\nendings\r\n']
> 文件 2：
> ['Give\r\nMe\r\nSome\r\nLove\ r\n']

# java - 在混合代码项目中是否有任何理由在 groovyc 上使用 javac？

> ID：14711060
> 
> 赞同：6
> 
> 时间：2013-02-05T15:31:19.947
> 
> 标签：java, maven, groovy, gradle

在 maven 或 gradle 中设置混合 java7/groovy2 项目时，是否有任何理由先用 javac 编译，然后用 groovyc 编译，而不是让 groovyc 处理这一切？

我开始按照最佳实践建议在它们自己的树（src/main/java 和 src/main/groovy）中单独编译它们。然而，由于 java 和 groovy 用于解决相同的问题并且如此混合，我现在倾向于将我的所有源代码转储到 src/main/groovy 并让 groovy 编译器处理 .java 和 .groovy 文件。在查看源代码树时，这似乎使项目更容易理解。有什么缺点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T18:01:35.477

让`groovyc`两者都处理`.java`好`.groovy`。`Grails`框架也使用了这种方法。Grails 2 将所有 .java 文件放在 groovy 源目录下，就像您所做的那样。你现在做的是最佳实践。

这是一个例子： [https ://github.com/groovy/groovy-core/tree/master/src/main/groovy/io](https://github.com/groovy/groovy-core/tree/master/src/main/groovy/io)

# c++ - 如何创建具有 3 个维度的 Mat 对象？

> ID：14711062
> 
> 赞同：1
> 
> 时间：2013-02-05T15:31:22.243
> 
> 标签：c++, opencv

我用它：

垫图（img.size（），CV_8UC3，CV_RGB（0,0,0））；

但它似乎没有创建任何具有 3 维的矩阵！有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:20:24.760

The good way to do that is to use the appropriated constructor :

```
Mat::Mat(int ndims, const int* sizes, int type) 
```

For example if you want to create a 100x60x15 matrix :

```
int sz[] = {100, 60, 15};
Mat map(3, sz, CV_8U); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T16:26:28.193

CV_8UC3 标志意味着您正在创建一个具有三个通道的图像，其中每个通道中的每个像素都表示为一个无符号字符。您应该能够通过查看输出来确认多个通道（或第 3 维）

```
 map.channels(); 
```

这将返回矩阵在第三维中的大小。如果您需要更多频道，请使用以下内容：

```
 map.create(100,60,CV_8UC(15)); 
```

其中 15 是通道数。

# android - 在listview android中隐藏列

> ID：14711065
> 
> 赞同：1
> 
> 时间：2013-02-05T15:31:27.390
> 
> 标签：android, sqlite, listview, hide, multiple-columns

我有大约 20 列输入到列表视图中。但我希望该用户可以选择禁用（隐藏）视图中的某些列。我发现我可以制作自己的阵列适配器并查看行。但我不想为 2 到 20 个连续的项目定义这个。有什么选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T11:58:11.483

我找到了一种方法。例如，我在列表视图中有这个项目布局。我将制作自​​己的适配器，然后只需调用 setVisibility(View.GONE); 我将从列表视图中隐藏此项目。PS：这只是 realcode 中的示例，应该有一些 IF() 来隐藏列。

项目的布局。

```
<TextView
    android:id="@+id/description"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<TextView
    android:id="@+id/value"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/description"
    android:layout_alignBottom="@+id/description"
    android:layout_toRightOf="@+id/description"
    android:text="TextView" /> 
```

和我的适配器。

```
private class ConnectedAdapter extends ArrayAdapter<ConnectionClass> {

    private ArrayList<ConnectionClass> connectionList;

    public ConnectedAdapter(Context context, int textViewResourceId,
            ArrayList<ConnectionClass> countryList) {
        super(context, textViewResourceId, countryList);
        this.connectionList = new ArrayList<ConnectionClass>();
        this.connectionList.addAll(countryList);
    }

    private class ViewHolder {
        TextView description;
        TextView value;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        ViewHolder holder = null;
        Log.v("ConvertView", String.valueOf(position));

        if (convertView == null) {
            LayoutInflater vi = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            convertView = vi.inflate(R.layout.activity_connected_item,
                    null);

            holder = new ViewHolder();
            holder.description = (TextView) convertView
                    .findViewById(R.id.description);
            holder.value = (TextView) convertView
                    .findViewById(R.id.value);

            convertView.setTag(holder);

        } else {
            holder = (ViewHolder) convertView.getTag();
        }

        ConnectionClass connection = connectedList.get(position);
        holder.description.setText(connection.getDescription());
        holder.description.setVisibility(View.GONE);
        holder.value.setText(connection.getValue());

        return convertView;

    }

} 
```

# javascript - 动态附加一个类

> ID：14711066
> 
> 赞同：0
> 
> 时间：2013-02-05T15:31:35.297
> 
> 标签：javascript, jquery, css

> **可能重复：**
> [使用 jquery 添加 css 规则](https://stackoverflow.com/questions/5846900/add-css-rule-using-jquery)

我想动态地向 DIV 添加第二个类。我有一个这样做的变量：

```
var headerDIV = $("<div>", { "class": "modal-header" }).appendTo($(this.dialog)); 
```

这段代码在一个函数中，现在我想创建一个包含 css 类的新变量，我只想用这样的名称添加它：

```
 var headerDIV = $("<div>", { "class": "modal-header " + 'customClass' }).appendTo($(this.dialog)); 
```

我的 customClass 将是这样的：

```
var customClass = { 'background-color': '#00609a', 'color': 'white' }; 
```

有没有办法做到这一点？谢谢

# grails - 在 Jetty 上部署 Grails 战争会产生 ConcurrentModificationException

> ID：14711073
> 
> 赞同：1
> 
> 时间：2013-02-05T15:31:56.140
> 
> 标签：grails, deployment, jetty, war, ibm-midrange

我尝试在 linux pc 上使用 tomcat 部署我的 grails 应用程序，一切正常。如果我尝试在 IBM AS400 上使用 jetty 部署相同的应用程序，我会得到一个非常长的堆栈跟踪：

```
org.springframework.beans.factory.access.BootstrapException: Error executing  bootstraps; nested exception is org.codehaus.groovy.runtime.InvokerInvocationException: java.lang.ExceptionInInitializerError
at org.codehaus.groovy.grails.web.context.GrailsContextLoader.initWebApplicationContext(GrailsContextLoader.java:118)
at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
at org.eclipse.jetty.server.handler.ContextHandler.startContext(ContextHandler.java:733)
at org.eclipse.jetty.servlet.ServletContextHandler.startContext(ServletContextHandler.java:233)
at org.eclipse.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1222)
at org.eclipse.jetty.server.handler.ContextHandler.doStart(ContextHandler.java:676)
at org.eclipse.jetty.webapp.WebAppContext.doStart(WebAppContext.java:455)
at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
at org.eclipse.jetty.deploy.bindings.StandardStarter.processBinding(StandardStarter.java:36)
at org.eclipse.jetty.deploy.AppLifeCycle.runBindings(AppLifeCycle.java:183)
at org.eclipse.jetty.deploy.DeploymentManager.requestAppGoal(DeploymentManager.java:491)
at org.eclipse.jetty.deploy.DeploymentManager.addApp(DeploymentManager.java:138)
at org.eclipse.jetty.deploy.providers.ScanningAppProvider.fileAdded(ScanningAppProvider.java:142)
at org.eclipse.jetty.deploy.providers.ScanningAppProvider$1.fileAdded(ScanningAppProvider.java:53)
at org.eclipse.jetty.util.Scanner.reportAddition(Scanner.java:604)
at org.eclipse.jetty.util.Scanner.reportDifferences(Scanner.java:535)
at org.eclipse.jetty.util.Scanner.scan(Scanner.java:398)
at org.eclipse.jetty.util.Scanner.doStart(Scanner.java:332)   
at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)   
at org.eclipse.jetty.deploy.providers.ScanningAppProvider.doStart(ScanningAppProvider.java:118)
at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59) 
at org.eclipse.jetty.deploy.DeploymentManager.startAppProvider(DeploymentManager.java:552) 
at org.eclipse.jetty.deploy.DeploymentManager.doStart(DeploymentManager.java:227) 
at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59) 
at org.eclipse.jetty.util.component.AggregateLifeCycle.doStart(AggregateLifeCycle.java:63) 
at org.eclipse.jetty.server.handler.AbstractHandler.doStart(AbstractHandler.java:53) 
at org.eclipse.jetty.server.handler.HandlerWrapper.doStart(HandlerWrapper.java:91) 
at org.eclipse.jetty.server.Server.doStart(Server.java:260) 
at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59) 
at org.eclipse.jetty.xml.XmlConfiguration$1.run(XmlConfiguration.java:1215)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)          
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
at java.lang.reflect.Method.invoke(Method.java:599)
at org.eclipse.jetty.start.Main.invokeMain(Main.java:457)
at org.eclipse.jetty.start.Main.start(Main.java:602)
at org.eclipse.jetty.start.Main.main(Main.java:82)

...

Caused by:                                                    
java.lang.ExceptionInInitializerError
at java.lang.J9VMInternals.initialize(J9VMInternals.java:222)
at java.lang.Class.forNameImpl(Native Method)
at java.lang.Class.forName(Class.java:136)
at org.codehaus.groovy.grails.plugins.datasource.DataSourceGrailsPlugin$_closure2.class$(DataSourceGrailsPlugin.groovy)
at org.codehaus.groovy.grails.plugins.datasource.DataSourceGrailsPlugin$_closure2.$get$$class$org$apache$commons$dbcp$BasicDataSource(DataSourceGrailsPlugin.groovy)
at org.codehaus.groovy.grails.plugins.datasource.DataSourceGrailsPlugin$_closure2.doCall(DataSourceGrailsPlugin.groovy:151)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
at java.lang.reflect.Method.invoke(Method.java:599)
at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)
at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1071)
at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1110)
at groovy.lang.MetaClassImpl.invokePropertyOrMissing(MetaClassImpl.java:1110)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1073)
at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1110)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:901)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:721)
at org.codehaus.groovy.grails.plugins.datasource.DataSourceGrailsPlugin.invokeMethod(DataSourceGrailsPlugin.groovy)
at groovy.lang.MetaClassImpl.invokeMethodOnGroovyObject(MetaClassImpl.java:1136)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1030)
at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1110)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:901)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:721)
at groovy.lang.GroovyObjectSupport.invokeMethod(GroovyObjectSupport.java:44)
at groovy.lang.MetaClassImpl.invokeMethodOnGroovyObject(MetaClassImpl.java:1136)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1030)
at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1110)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:901)
at org.codehaus.groovy.runtime.callsite.PogoMetaClassSite.callCurrent(PogoMetaClassSite.java:66)
at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallCurrent(CallSiteArray.java:46)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:133)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:145)
at org.codehaus.groovy.grails.plugins.datasource.DataSourceGrailsPlugin$_closure1_closure8.doCall(DataSourceGrailsPlugin.groovy:69)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) 
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
at java.lang.reflect.Method.invoke(Method.java:599)
at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)
at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1071)
at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1110)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:901)
at groovy.lang.Closure.call(Closure.java:415)
at org.codehaus.groovy.runtime.DefaultGroovyMethods.callClosureForMapEntry(DefaultGroovyMethods.java:3649)
at org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:1408)
at org.codehaus.groovy.runtime.dgm$171.invoke(Unknown Source)
at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoMetaMethodSiteNoUnwrapNoCoerce.invoke(PojoMetaMethodSite.java:271)
at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:53)
at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:42)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:108)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:116)
at org.codehaus.groovy.grails.plugins.datasource.DataSourceGrailsPlugin$_closure1.doCall(DataSourceGrailsPlugin.groovy:69)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
at java.lang.reflect.Method.invoke(Method.java:599)
at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite$PogoCachedMethodSite.invoke(PogoMetaMethodSite.java:231)
at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite.callCurrent(PogoMetaMethodSite.java:52)
at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallCurrent(CallSiteArray.java:46)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:133)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:141)
at org.codehaus.groovy.grails.plugins.datasource.DataSourceGrailsPlugin$_closure1.doCall(DataSourceGrailsPlugin.groovy)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
at java.lang.reflect.Method.invoke(Method.java:599)
at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)
at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1071)
at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1110)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:901)
at groovy.lang.Closure.call(Closure.java:415)
at groovy.lang.Closure.call(Closure.java:409)
at grails.spring.BeanBuilder.invokeBeanDefiningClosure(BeanBuilder.java:736)
at grails.spring.BeanBuilder.beans(BeanBuilder.java:569)
at grails.spring.BeanBuilder.invokeMethod(BeanBuilder.java:511)
at org.codehaus.groovy.grails.plugins.DefaultGrailsPlugin.doWithRuntimeConfiguration(DefaultGrailsPlugin.java:528)
at org.codehaus.groovy.grails.plugins.AbstractGrailsPluginManager.doRuntimeConfiguration(AbstractGrailsPluginManager.java:120)
at org.codehaus.groovy.grails.commons.spring.GrailsRuntimeConfigurator.configure(GrailsRuntimeConfigurator.java:156)
at org.codehaus.groovy.grails.commons.spring.GrailsRuntimeConfigurator.configure(GrailsRuntimeConfigurator.java:127)
at org.codehaus.groovy.grails.web.context.GrailsConfigUtils.configureWebApplicationContext(GrailsConfigUtils.java:121)
at org.codehaus.groovy.grails.web.context.GrailsContextLoader.initWebApplicationContext(GrailsContextLoader.java:104)
at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
at org.eclipse.jetty.server.handler.ContextHandler.startContext(ContextHandler.java:733)
at org.eclipse.jetty.servlet.ServletContextHandler.startContext(ServletContextHandler.java:233)
at org.eclipse.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1222)
at org.eclipse.jetty.server.handler.ContextHandler.doStart(ContextHandler.java:676)
at org.eclipse.jetty.webapp.WebAppContext.doStart(WebAppContext.java:455)
at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
at org.eclipse.jetty.deploy.bindings.StandardStarter.processBinding(StandardStarter.java:36)
at org.eclipse.jetty.deploy.AppLifeCycle.runBindings(AppLifeCycle.java:183)
at org.eclipse.jetty.deploy.DeploymentManager.requestAppGoal(DeploymentManager.java:491)
at org.eclipse.jetty.deploy.DeploymentManager.addApp(DeploymentManager.java:138)
at org.eclipse.jetty.deploy.providers.ScanningAppProvider.fileAdded(ScanningAppProvider.java:142)
at org.eclipse.jetty.deploy.providers.ScanningAppProvider$1.fileAdded(ScanningAppProvider.java:53)
at org.eclipse.jetty.util.Scanner.reportAddition(Scanner.java:604)
at org.eclipse.jetty.util.Scanner.reportDifferences(Scanner.java:535)
at org.eclipse.jetty.util.Scanner.scan(Scanner.java:398)
at org.eclipse.jetty.util.Scanner.doStart(Scanner.java:332)
at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
at org.eclipse.jetty.deploy.providers.ScanningAppProvider.doStart(ScanningAppProvider.java:118)
at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
at org.eclipse.jetty.deploy.DeploymentManager.startAppProvider(DeploymentManager.java:552)
at org.eclipse.jetty.deploy.DeploymentManager.doStart(DeploymentManager.java:227)
at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
at org.eclipse.jetty.util.component.AggregateLifeCycle.doStart(AggregateLifeCycle.java:63)
at org.eclipse.jetty.server.handler.AbstractHandler.doStart(AbstractHandler.java:53)
at org.eclipse.jetty.server.handler.HandlerWrapper.doStart(HandlerWrapper.java:91)
at org.eclipse.jetty.server.Server.doStart(Server.java:260)
at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
at org.eclipse.jetty.xml.XmlConfiguration$1.run(XmlConfiguration.java:1215)
at java.security.AccessController.doPrivileged(AccessController.java:202)
at org.eclipse.jetty.xml.XmlConfiguration.main(XmlConfiguration.java:1138)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
at java.lang.reflect.Method.invoke(Method.java:599)
at org.eclipse.jetty.start.Main.invokeMain(Main.java:457)
at org.eclipse.jetty.start.Main.start(Main.java:602)
at org.eclipse.jetty.start.Main.main(Main.java:82)
Caused by:
java.util.ConcurrentModificationException
at java.util.AbstractList$SimpleListIterator.next(AbstractList.java:59)
at java.sql.DriverManager.getDrivers(DriverManager.java:407)
at org.apache.commons.dbcp.BasicDataSource.<clinit>(BasicDataSource.java:57)
at java.lang.J9VMInternals.initializeImpl(Native Method)
at java.lang.J9VMInternals.initialize(J9VMInternals.java:200)
at java.lang.Class.forNameImpl(Native Method)
at java.lang.Class.forName(Class.java:136)
at org.codehaus.groovy.grails.plugins.datasource.DataSourceGrailsPlugin$_closure2.class$(DataSourceGrailsPlugin.groovy)
at org.codehaus.groovy.grails.plugins.datasource.DataSourceGrailsPlugin$_closure2.$get$$class$org$apache$commons$dbcp$BasicDataSource(DataSourceGrailsPlugin.groovy)
at org.codehaus.groovy.grails.plugins.datasource.DataSourceGrailsPlugin$_closure2.doCall(DataSourceGrailsPlugin.groovy:151)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
at java.lang.reflect.Method.invoke(Method.java:599)
at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)
at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1071)
at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1110)
at groovy.lang.MetaClassImpl.invokePropertyOrMissing(MetaClassImpl.java:1110)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1073)
at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1110)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:901)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:721)
at org.codehaus.groovy.grails.plugins.datasource.DataSourceGrailsPlugin.invokeMethod(DataSourceGrailsPlugin.groovy)
at groovy.lang.MetaClassImpl.invokeMethodOnGroovyObject(MetaClassImpl.java:1136)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1030)
at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1110)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:901)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:721)
at groovy.lang.GroovyObjectSupport.invokeMethod(GroovyObjectSupport.java:44)
at groovy.lang.MetaClassImpl.invokeMethodOnGroovyObject(MetaClassImpl.java:1136)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1030)
at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1110)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:901)
at org.codehaus.groovy.runtime.callsite.PogoMetaClassSite.callCurrent(PogoMetaClassSite.java:66)
at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallCurrent(CallSiteArray.java:46)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:133)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:145)
at org.codehaus.groovy.grails.plugins.datasource.DataSourceGrailsPlugin$_closure1_closure8.doCall(DataSourceGrailsPlugin.groovy:69)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
at java.lang.reflect.Method.invoke(Method.java:599)
at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)
at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1071)
at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1110)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:901)
at groovy.lang.Closure.call(Closure.java:415)
at org.codehaus.groovy.runtime.DefaultGroovyMethods.callClosureForMapEntry(DefaultGroovyMethods.java:3649)
at org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:1408)
at org.codehaus.groovy.runtime.dgm$171.invoke(Unknown Source)
at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite$PojoMetaMethodSiteNoUnwrapNoCoerce.invoke(PojoMetaMethodSite.java:271)
at org.codehaus.groovy.runtime.callsite.PojoMetaMethodSite.call(PojoMetaMethodSite.java:53)
at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:42)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:108)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:116)
at org.codehaus.groovy.grails.plugins.datasource.DataSourceGrailsPlugin$_closure1.doCall(DataSourceGrailsPlugin.groovy:69)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
at java.lang.reflect.Method.invoke(Method.java:599)
at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite$PogoCachedMethodSite.invoke(PogoMetaMethodSite.java:231)
at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite.callCurrent(PogoMetaMethodSite.java:52)
at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallCurrent(CallSiteArray.java:46)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:133)
at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:141)
at org.codehaus.groovy.grails.plugins.datasource.DataSourceGrailsPlugin$_closure1.doCall(DataSourceGrailsPlugin.groovy)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
at java.lang.reflect.Method.invoke(Method.java:599)
at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)
at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1071)
at groovy.lang.ExpandoMetaClass.invokeMethod(ExpandoMetaClass.java:1110)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:901)
at groovy.lang.Closure.call(Closure.java:415)
at groovy.lang.Closure.call(Closure.java:409)
at grails.spring.BeanBuilder.invokeBeanDefiningClosure(BeanBuilder.java:736)
at grails.spring.BeanBuilder.beans(BeanBuilder.java:569)
at grails.spring.BeanBuilder.invokeMethod(BeanBuilder.java:511)
at org.codehaus.groovy.grails.plugins.DefaultGrailsPlugin.doWithRuntimeConfiguration(DefaultGrailsPlugin.java:528)
at org.codehaus.groovy.grails.plugins.AbstractGrailsPluginManager.doRuntimeConfiguration(AbstractGrailsPluginManager.java:120)
at org.codehaus.groovy.grails.commons.spring.GrailsRuntimeConfigurator.configure(GrailsRuntimeConfigurator.java:156)
at org.codehaus.groovy.grails.commons.spring.GrailsRuntimeConfigurator.configure(GrailsRuntimeConfigurator.java:127)
at org.codehaus.groovy.grails.web.context.GrailsConfigUtils.configureWebApplicationContext(GrailsConfigUtils.java:121)
at org.codehaus.groovy.grails.web.context.GrailsContextLoader.initWebApplicationContext(GrailsContextLoader.java:104)
at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
at org.eclipse.jetty.server.handler.ContextHandler.startContext(ContextHandler.java:733)
at org.eclipse.jetty.servlet.ServletContextHandler.startContext(ServletContextHandler.java:233)
at org.eclipse.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1222)
at org.eclipse.jetty.server.handler.ContextHandler.doStart(ContextHandler.java:676)
at org.eclipse.jetty.webapp.WebAppContext.doStart(WebAppContext.java:455)
at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
at org.eclipse.jetty.deploy.bindings.StandardStarter.processBinding(StandardStarter.java:36)
at org.eclipse.jetty.deploy.AppLifeCycle.runBindings(AppLifeCycle.java:183)
at org.eclipse.jetty.deploy.DeploymentManager.requestAppGoal(DeploymentManager.java:491)
at org.eclipse.jetty.deploy.DeploymentManager.addApp(DeploymentManager.java:138)
at org.eclipse.jetty.deploy.providers.ScanningAppProvider.fileAdded(ScanningAppProvider.java:142)
at org.eclipse.jetty.deploy.providers.ScanningAppProvider$1.fileAdded(ScanningAppProvider.java:53)
at org.eclipse.jetty.util.Scanner.reportAddition(Scanner.java:604)
at org.eclipse.jetty.util.Scanner.reportDifferences(Scanner.java:535)
at org.eclipse.jetty.util.Scanner.scan(Scanner.java:398)
at org.eclipse.jetty.util.Scanner.doStart(Scanner.java:332)
at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
at org.eclipse.jetty.deploy.providers.ScanningAppProvider.doStart(ScanningAppProvider.java:118)
at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
at org.eclipse.jetty.deploy.DeploymentManager.startAppProvider(DeploymentManager.java:552)
at org.eclipse.jetty.deploy.DeploymentManager.doStart(DeploymentManager.java:227)
at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
at org.eclipse.jetty.util.component.AggregateLifeCycle.doStart(AggregateLifeCycle.java:63)
at org.eclipse.jetty.server.handler.AbstractHandler.doStart(AbstractHandler.java:53)
at org.eclipse.jetty.server.handler.HandlerWrapper.doStart(HandlerWrapper.java:91)
at org.eclipse.jetty.server.Server.doStart(Server.java:260)
at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
at org.eclipse.jetty.xml.XmlConfiguration$1.run(XmlConfiguration.java:1215)
at java.security.AccessController.doPrivileged(AccessController.java:202)
at org.eclipse.jetty.xml.XmlConfiguration.main(XmlConfiguration.java:1138) 
```

搜索互联网并没有发现任何有用的东西。任何帮助解决此问题将不胜感激。我正在使用 Grails 2.0.3 版和 Jetty 7.6.3 版。

这是我的 grails 应用程序的数据源配置：

```
dataSource {
        dbCreate = "update" // one of 'create', 'create-drop', 'update', 'validate', ''
        pooled = true
        url = "jdbc:as400://localhost;naming=system;libraries=*LIBL;errors=full"
        driverClassName = "com.ibm.as400.access.AS400JDBCDriver"
        username = "user"
        password = "pass"
        dialect = org.hibernate.dialect.DB2400Dialect.class
} 
```

注意到我正在使用Grails的[systemitools 插件可能会有所帮助。](http://code.google.com/p/grails400utils/)

**更新：**我删除了所有其他 webapp，这样我的 webapp 将成为码头启动时唯一运行的 webapp，并且运行良好。问题似乎是在 grails 应用程序之前启动了不同的 web 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:52:31.553

不要让 Spring 创建数据源。这违反了 Servlet 规范的规则。

让 Spring 仅引用您在 webapp 容器中定义的 JNDI 数据源。

1）真正的服务器端/容器`DataSource`

将服务器端 JNDI 引用设置为 real `javax.sql.DataSource`，随意调用它（在本例中，我们将调用它`jdbc/myContainerDS`）

使用[http://wiki.eclipse.org/Jetty/Howto/Configure_JNDI_Datasource上的文档](http://wiki.eclipse.org/Jetty/Howto/Configure_JNDI_Datasource)

2) WEB-INF/web.xml 资源引用

您*必须*在其中设置`<resource-ref>`引用`web.xml`（这是某些 webapp 容器未能遵循的 servlet 规范的必需部分）。同样，使用上面的文档寻求帮助。

3) Spring bean 对 JNDI 提供的 DataSource 的引用

设置 Spring 端 bean 以引用服务器端的 JNDI 数据源。

```
<bean id="dataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
    <property name="jndiName" value="jdbc/myContainerDS"/>
    <property name="lookupOnStartup" value="false"/>
    <property name="cache" value="true"/>
    <property name="proxyInterface" value="javax.sql.DataSource"/>
</bean> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:25:19.587

我至少找到了解决方法。如果我将数据源中的数据库驱动程序更改为使用 db2 而不是 as400（并相应地更改 url），那么一切都很好。我曾尝试将 webapps 转换为 Grails，希望它能解决问题，但没有。直到我改用 db2 驱动程序而不是 as400 驱动程序。

```
com.ibm.db2.jdbc.app.DB2Driver 
```

使用 db2 驱动程序的多个应用程序很好。一些使用 db2 的应用程序和一个使用 as400 的应用程序很好。使用 as400 驱动程序的多个应用程序不好。

我仍然不确定为什么会这样。如果有人有想法，请发表评论。

# ios - dylib 或可执行导出列表

> ID：14711077
> 
> 赞同：1
> 
> 时间：2013-02-05T15:32:04.787
> 
> 标签：ios, macos, dynamic, dylib, dlopen

我正在编写一个插件子系统，其中一个想法是遍历 dylib（或至少当前全局范围）导出的函数。我知道还有其他方法，只是真的想尝试一下。

我想知道的是，有没有办法获取由 dylib 导出的函数列表或通过 OS X 和 iOS API 在全局范围内可用的函数列表？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T13:56:06.957

您可以使用命令“nm”从动态库中获取信息。另请参阅 Mac 上此命令的系统手册。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-15T19:33:29.237

如果您希望从代码中执行此操作，则可以使用此方法。

```
std::vector<std::string> load_mach_o(std::string file_name)
{
  /*
  Parse the Mach-O structure to find all the exported symbols
  Mach-O structure:
   mach_header_64
   cmd
   ...
   cmd
   data
   ...
   data
  */
  std::vector<std::string> methods; 
  off_t offset = sizeof(struct mach_header_64);
  BYTE * bytes = load_bytes(file_name.c_str());
  if (bytes == NULL)
  {
    return methods;
  }

  struct mach_header_64 *header = (struct mach_header_64 *)bytes;
  //Get the load commands
  struct load_command *cmd = (struct load_command *)(bytes + offset);

  for (uint32_t i = 0U; i < header->ncmds; i++)
  {
    if (cmd->cmd == LC_SYMTAB)
    {
      struct symtab_command * symtab = (struct symtab_command *)cmd;
      off_t string_start = 0;
      const char* strings = (const char *)(bytes + symtab->stroff + 1);
      for (uint32_t i = 0 ; i < symtab->strsize ; i++)
      {
        if (strings[i] == '\0')
        {
        i++;
        size_t size = sizeof(char) * (i - string_start);
        if (size == 1)
        {
          string_start = i+1;
          continue;
        }
        methods.push_back(std::string((const char *)(strings + string_start)));
        string_start = i+1;
        }
      }
    }
    offset += cmd->cmdsize;
    //load next command
    cmd = (struct load_command *)(bytes + offset);
  }
  free(bytes);
  return methods;
} 
```

此函数读取文件并解析结构直到 mach-O 字符串部分，然后解析每个字符串并将其存储在包含所有公开函数的向量中。

此致。

# jquery - 在按钮单击事件上使用 javascript 更改谷歌地图 iframe src 属性

> ID：14711084
> 
> 赞同：2
> 
> 时间：2013-02-05T15:32:13.083
> 
> 标签：jquery, iframe, maps, src

我有一个包含 10 个不同地址的联系页面，中间有一个谷歌地图 iframe，我想让地址可点击，当你点击一个特定的地址时，地图的内容会改变并指向点击的地址。

我是 jquery 新手，我不知道该怎么做。

现在我坚持这个，但它不工作：

HTML：

这是默认加载的地图，id 为“map”。

```
<iframe id="map" width="650" height="300" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://maps.google.it/maps?f=q&amp;source=s_q&amp;hl=it&amp;geocode=&amp;q=23,+Quai+des+Bergues&amp;aq=&amp;sll=46.198392,6.142296&amp;sspn=0.084955,0.222988&amp;ie=UTF8&amp;hq=&amp;hnear=Quai+des+Bergues+23,+Grottes+-+Saint-Gervais,+1201+Gen%C3%A8ve,+Svizzera&amp;t=m&amp;z=14&amp;ll=46.206419,6.145108&amp;output=embed&amp;iwloc=near"></iframe> 
```

这是 ID 为“changesrc”的按钮。

```
<input type="submit" name="changesrc" id="changesrc" value="Another Adress" /> 
```

Javascript：

```
<script type="text/javascript">
        $('#changesrc').click(function() {
        $('#map').attr('src','http://maps.google.it/maps?f=q&amp;source=s_q&amp;hl=it&amp;geocode=&amp;q=roma&amp;aq=&amp;sll=41.811729,12.738513&amp;sspn=2.927223,7.13562&amp;ie=UTF8&amp;hq=&amp;hnear=Roma,+Lazio&amp;t=m&amp;z=11&amp;iwloc=A&amp;output=embed');
        });
    </script> 
```

有什么建议吗？很感谢任何形式的帮助。谢谢！

* * *

我现在可以让它正常工作了！我将输入设置为看起来像普通链接，所以现在一切正常，但我有一个问题：

当我单击更改地图时，显示的新地图不是“居中”大头针所在的位置，而是错误地移动（大头针和中心位置现在位于左上角）。

我认为这是因为造成问题的“显示：无”。有办法解决吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:45:43.350

#changesrc 是否存在不止一次？那么你应该使用`class`属性而不是`id`因为与后者不同，前者允许存在不止一次。

`src`由于浏览器的安全规则（跨域访问），您无法访问该属性。这适用于所有 JavaScript，不仅适用于 jQuery 和 Google Maps。

但是您可以将所有地图包装在 <div> 标记中并按需显示。当然，所有地图（可能除了您的默认地图）都应该首先通过 CSS 隐藏。

你可以在这里看到这一切：http: [//jsfiddle.net/FDKHee/pYX6Y/7](http://jsfiddle.net/FDKHee/pYX6Y/7)
（CSS在右上角）

# objective-c - iPhone：在视图之间传递数据

> ID：14711088
> 
> 赞同：0
> 
> 时间：2013-02-05T15:32:26.780
> 
> 标签：objective-c, ios4

我正在尝试创建一个简单的应用程序来了解如何在视图之间传递数据。我有两种看法。第一个使用此方法将一些字符串传递给第二个视图：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"colorSegue"]) {

    [segue.destinationViewController setFirstColor:self.favoriteColorTextField.text];
    [segue.destinationViewController setSecondColor:self.secondColor];
    [segue.destinationViewController setDelegate:self];
} 
```

第二个视图使用此方法接收数据。

```
- (void)viewWillAppear:(BOOL)animated
{
 [super viewWillAppear:animated];
 if (self.firstColor != nil && ![self.firstColor isEqualToString:@""]) {
    self.favoriteColorLabel.text = [[NSString alloc] initWithFormat:@"Favorite color: %@", self.firstColor];
 }
 if (self.secondColor != nil && ![self.secondColor isEqualToString:@""]){
    self.secondFavoriteColorLabel.text = [[NSString alloc] initWithFormat:@"Second favorite color: %@", self.secondColor];
 }
} 
```

到目前为止一切正常，第二个视图可视化了第一个字符串（但不是第二个，因为它仍然是空的）。然后第二个视图通过委托将一个字符串传回给第一个：

```
- (void)viewWillDisappear:(BOOL)animated
{
[self.delegate setSecondFavoriteColor:self.secondFavoriteColorTextField.text];
} 
```

第一个视图将字符串可视化，如下所示：

```
- (void)viewWillAppear:(BOOL)animated
{
 [super viewWillAppear:animated];
 if (self.secondColor != nil && ![self.secondColor isEqualToString:@""]) {
    self.secondFavoriteColorLabel.text = [[NSString alloc] initWithFormat:@"Second favorite color: %@", self.secondColor];
 }
} 
```

在这里一切正常，第一个视图可视化了两个字符串。但现在我遇到了问题。如果我尝试再次将字符串传递给第二个视图，则只有第一个被正确传递。第二个视图总是接收带有 nil 值的 secondColor，即使它的值已经通过委托设置。变量 firstColor 和 secondColor 的声明和合成方式完全相同。你能帮我找出错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:38:24.190

我认为您需要将 segue.destinationViewController 转换为 SecondViewController 类

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"colorSegue"]) {
        SecondViewController *svc = [segue destinationViewController];
        [svc setFirstColor:self.favoriteColorTextField.text];
        [svc setSecondColor:self.secondColor];
        [svc setDelegate:self];
} 
```

或者

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"colorSegue"]) {

        [(SecondViewController *)segue.destinationViewController setFirstColor:self.favoriteColorTextField.text];
        [(SecondViewController *)segue.destinationViewController setSecondColor:self.secondColor];
        [(SecondViewController *)segue.destinationViewController setDelegate:self];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:06:11.683

如果你想在超过 1 个视图之间传递数据，那么你有这些选项。

*   您可以使用单例
*   使用您的 AppDelegate。

这是一个关于单例的好教程：

> [http://www.galloway.me.uk/tutorials/singleton-classes/](http://www.galloway.me.uk/tutorials/singleton-classes/)

如果您想使用 AppDelegate 这样做：

AppDelegate.h

```
@property (nonatomic, retain) NSString *something; 
```

AppDelegate.m

```
@synthesize something; 
```

第一视图控制器.m

```
#import "AppDelegate.h";

(void) setSomething {
       AppDelegate *AppDelegate = [[UIApplication sharedApplication] delegate];
       AppDelegate.something = @"something";

} 
```

SecondviewController.m

```
#import "AppDelegate.h";

(void) getSomething {
       AppDelegate *AppDelegate = [[UIApplication sharedApplication] delegate];
       label.text = AppDelegate.something;

} 
```

# c#-4.0 - 如何使用 LinqToObjects 维护计数器？

> ID：14711089
> 
> 赞同：0
> 
> 时间：2013-02-05T15:32:27.483
> 
> 标签：c#-4.0, linq-to-objects

我有以下 c# 代码：

```
 private XElement BuildXmlBlob(string id, Part part, out int counter)
    {
        // return some unique xml particular to the parameters passed
        // remember to increment the counter also before returning.
    } 
```

由以下人员调用：

```
 var counter = 0;
        result.AddRange(from rec in listOfRecordings
                        from par in rec.Parts
                        let id = GetId("mods", rec.CKey + par.UniqueId)
                        select BuildXmlBlob(id, par, counter)); 
```

*上面的代码示例象征着我想要实现的目标。*

根据 Eric Lippert 的说法，out 关键字和 linq 不能混合使用。好吧，很公平，但是有人可以帮我重构上面的内容，让它起作用吗？工作中的一位同事提到了累加器和聚合函数，但我是 Linq 的新手，而且我的谷歌搜索结果有任何真正的成果，所以我想我会在这里问:)。

**澄清：**

我正在计算每次调用代码时我可能拥有的部件数量，这些部件数量可能是任意数量。因此，每次调用 BuildXmlBlob() 方法时，生成的 xml 都会有一个唯一元素，表示“partNumber”。

因此，如果计数器当前位于 7，这意味着我们目前正在处理第 7 部分！这意味着从 BuildXmlBlob() 返回的 XML 将在某处嵌入计数器值。这就是为什么每次运行时每次调用 BuildXmlBlob() 时我都需要以某种方式传递和递增它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:55:33.557

如果您想纯粹在 LINQ 中保留它，并且需要维护一个运行计数以在查询中使用，那么最干净的方法是利用`Select()`查询中包含索引的重载来获取当前索引。

在这种情况下，先做一个收集输入的查询，然后使用重载进行投影会更干净。

```
var inputs =
    from recording in listOfRecordings
    from part in recording.Parts
    select new
    {
        Id = GetId("mods", recording.CKey + part.UniqueId),
        Part = part,
    };
result.AddRange(inputs.Select((x, i) => BuildXmlBlob(x.Id, x.Part, i))); 
```

那么你就不需要使用`out`/`ref`参数了。

```
XElement BuildXmlBlob(string id, Part part, int counter)
{
    // implementation
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T17:04:07.763

以下是我自己设法弄清楚的：

```
 result.AddRange(listOfRecordings.SelectMany(rec => rec.Parts, (rec, par) => new {rec, par})
                            .Select(@t => new
                                {
                                    @t, 
                                    Id = GetStructMapItemId("mods", @t.rec.CKey + @t.par.UniqueId)
                                })
                            .Select((@t, i) => BuildPartsDmdSec(@t.Id, @t.@t.par, i))); 
```

我使用 resharper 将其转换为一个方法链，该方法链构建了我需要的基础知识，然后我只是在最后添加了 select 语句。

# c# - 拦截 ASP NET MVC POST 值

> ID：14711091
> 
> 赞同：3
> 
> 时间：2013-02-05T15:32:29.387
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, security

我最近的一个 MVC3 项目被我的讲师黑掉了，他不会告诉我他是如何做到的，直到他在几周内向全班同学做演示。然而我不能等这么久。

我的问题是，有没有办法拦截从视图发送到控制器 POST 方法的数据？如果是这样，这种方法被称为什么，我该如何阻止它？

例如：

将用户对象发布到数据库的注册页面。用户对象有一个布尔 Admin，它自动设置为 false。黑客拦截 Post 并将 Users Admin 属性的值更改为 true。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T16:52:17.217

向控制器（或任何 HTTP 处理程序）发出的请求没有什么特别或受保护的。它只是一串可以随意更改的名称/值对。`Request.Form`在Visual Studio 调试器的即时窗口中查看。

[您可以使用Firefox Tamper Data](https://addons.mozilla.org/en-us/firefox/addon/tamper-data/)插件之类的工具来篡改表单数据。即使没有工具使用几行代码进行修改也是微不足道的。您甚至不需要网络浏览器来执行此操作。

我的猜测是您的讲师只是将 POST 从更改`IsAdmin=false`为`IsAdmin=true`

那么我们该如何预防呢？

*   **验证所有输入**。POST/view 模型说 IsAdmin=true？好的，调用者是否有权进行该分配？

*   创建不公开您不想更改的属性的视图模型。**即使一个属性没有显示在页面上，如果它在请求中，ModelBinder 也会绑定它。**这意味着即使您没有`IsAdmin`在页面上放置复选框，如果视图模型包含 IsAdmin 属性，也可以设置它。

*   您可以选择性地将模型的属性标记为不可绑定，但我通常不建议这样做；太容易忘记了。

另请参阅：[ASP.NET MVC - [Bind(Exclude = "Id")] 的替代方案](https://stackoverflow.com/questions/4631000/asp-net-mvc-alternative-for-bindexclude-id)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:39:27.237

亚伦说的。没有什么是可以信任的。一切都必须检查。如果“admin”的唯一决定因素是传入的布尔值，则您将需要更多安全性，例如令牌或在更新/检查数据时可以在数据库中双重检查的东西。

# php - 如何禁用 Magento 的简单产品 URL 重写管理？

> ID：14711099
> 
> 赞同：3
> 
> 时间：2013-02-05T15:32:46.000
> 
> 标签：php, zend-framework, magento, magento-1.7

我有 3 个在线商店在单个 Magento 安装上运行。

他们共享超过 10.000 多个 SKU（我已将它们设置为简单产品），但在前端可见的唯一产品是每个商店的分组产品（与 SKU 相关联）。

因此，我的 URL 重写表非常繁重，在检查 Varien Profiler 时，我遇到了“mage::dispatch::routers_match”，这需要超过 5 秒才能完成。我想这是因为它是一张很大的桌子。所以这让我想到了我的问题：

如何指定我不想让 Magento 重写的 URL。无论如何我可以告诉它不要重写简单的产品 URL 吗？仅此一项就会将桌子降低到1/3。

PS：Magento CE 1.7.0.2

编辑：

感谢 Tobias 为我指明了正确的方向。我去了 app/code/core/Mage/Catalog/Model/Url.php 并将函数编辑`refreshProductRewrites`为：

```
foreach ($products as $product) {
        if($product->getTypeId() == "simple"){
            continue;
        }
        else {
        $this->_refreshProductRewrite($product, $this->_categories[$storeRootCategoryId]);
        foreach ($product->getCategoryIds() as $categoryId) {
            if ($categoryId != $storeRootCategoryId && isset($this->_categories[$categoryId])) {
                if (strpos($this->_categories[$categoryId]['path'], $storeRootCategoryPath . '/') !== 0) {
                    continue;
                }
                $this->_refreshProductRewrite($product, $this->_categories[$categoryId]);
            }
        }
    }
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T15:56:53.617

存储在其中的产品的集合在refreshProductRewrites中**`core_url_rewrite`**生成。**`Mage_Catalog_Model_Url`**

你可以重写这个类并实现你自己的实现，它只存储分组的产品。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-30T14:03:43.900

另一种解决方案是忽略具有空 url 键的产品。

```
 protected function _refreshProductRewrite(Varien_Object $product, Varien_Object $category)
   {
   if ($category->getId() == $category->getPath()) {
   return $this;
   }
   if ($product->getUrlKey() != '') {

   $urlKey = $this->getProductModel()->formatUrlKey($product->getUrlKey()); 
```

您可以通过（检查属性 id）清除简单产品的 url 键：

DELETE FROM catalog_product_entity_varchar WHERE entity_id IN (SELECT entity_id FROM `catalog_product_entity`WHERE type_id='simple' AND attribute_id='97');

# c# - 在任务管理器中更改进程名称

> ID：14711100
> 
> 赞同：6
> 
> 时间：2013-02-05T15:32:46.570
> 
> 标签：c#, taskmanager

我有一个在服务器上运行的 Windows 窗体应用程序。现在我需要同时运行同一个应用程序的多个实例。每个实例将连接到不同的数据库。在应用程序启动期间，我更改了标题，以便我可以识别正在连接的数据库，但我也想在任务管理器中更改名称。这是因为我有另一个应用程序充当主管，根据需要终止和启动进程。我必须找到一种方法来清楚地识别要杀死的进程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:20:15.240

让您的主管创建可执行文件的临时副本，包括您的识别信息，然后启动它......这样任务管理器看起来像

```
My process - database 1.exe
My process - database 2.exe
et cetera 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:58:26.087

如果 Supervisor 程序是启动进程的程序，那么您将完全控制这些子进程。您可以根据需要轻松杀死/启动它们。根据需要使用[进程](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx)。

```
using System.Diagnostics;

Process p1 = new Process();
Process p2 = new Process();
Process p3 = new Process();

p1.StartInfo.FileName = "notepad.exe";
p2.StartInfo.FileName = "notepad.exe";
p3.StartInfo.FileName = "notepad.exe";

//start the procs
p1.Start();
p2.Start();
p3.Start();

//kill the procs
p1.Kill();
p2.Kill();
p3.Kill(); 
```

如果您希望某些超级用户有权终止该进程，为什么不让他们使用 GUI 来完成呢？如果没有 GUI，他们是如何运行程序的？它是通过cmd启动的吗？

从我下面的评论中复制：

如果用户希望能够专门从任务管理器中终止进程，他们可以使用应用程序选项卡选择正确的进程（您需要给它一个唯一的窗口标题），然后他们可以右键单击>转到进程并从那里杀死。

# primefaces - 无法在 flowscope 中创建输入集的多个实例

> ID：14711101
> 
> 赞同：0
> 
> 时间：2013-02-05T15:32:48.400
> 
> 标签：primefaces, persistence, spring-webflow

我有输入类型，它的值在 flowScope 中设置。

```
<input name="myItem" required="false" value="flowScope.myItem"/> 
```

我正在创建一个 MyOtherItem 列表并将其发送到这样的控制器方法：

```
<evaluate expression="myController.save(myOtherItemDataModel.selectedRows,myItem)" result="flowScope.myItem"/> 
```

在 MyController 中，我有方法 save，我想通过从 myOtherItemList 获取数据来保存 myItem 的多个实例。

```
public MyItem save(MyOtherItem[] myOtherItem,MyItem myItem){
    for(int i=0; i<myOtherItem.length; i++){
        myItem.setData(myOtherItem[i].getData());
        saveMyItem(myItem);
    }
    return myItem;
} 
```

在 saveMyItem 方法中，我坚持 MyItem 对象

```
public void saveMyItem(MyItem myItem) {
    entityManager.persist(myItem);
} 
```

这里 entityManager 是 javax.persistence.EntityManager 类的一个实例。

我的问题是我只在数据库中保存了一个条目，而 save 方法中的循环运行了不止一次。原因是它没有创建 MyItem 的新实例，而只是覆盖旧实例的数据。有谁知道我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:50:07.600

我不明白您为什么需要将 MyItem 传递给控制器​​方法我不明白您要返回哪个 myItem ，因为您似乎想保存一堆...

也许你应该使用类似的东西：

```
public List<MyItem> save(MyOtherItem[] myOtherItem){
   List<MyItem> result = new ArrayList<MyItem>(); 
   for(int i=0; i<myOtherItem.length; i++){
        MyItem myItem = new MyItem();
        myItem.setData(myOtherItem[i].getData());
        saveMyItem(myItem);
        result.add(myItem);
    }
    return myItem;
} 
```

# dojo - 将 dojo 1.8 与 requirejs 一起使用

> ID：14711102
> 
> 赞同：5
> 
> 时间：2013-02-05T15:32:48.890
> 
> 标签：dojo, requirejs

有没有人有将 dojo 1.8 与 requrejs 集成的经验？如果我使用 requrejs 加载 dojo/dijit/dojox 它将引发一些关于 has.js 无法正常工作的异常。

> TypeError: _3.add 不是函数
> _3.add("dom-addeventlistener",!!document.addEventListener);

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T15:37:43.177

从

[http://requirejs.org/docs/dojo.html](http://requirejs.org/docs/dojo.html)

> 从 Dojo 1.8 开始，Dojo 已将其模块转换为 AMD 模块。但是，Dojo 使用了一些加载器插件，加载器插件 API 仍处于 AMD 草案模式。因此，虽然 Dojo 中的一些模块可以与 RequireJS 一起使用，但要使用所有 Dojo 会很困难。最好在票证 15616 得到解决之前使用 Dojo 的 AMD 加载程序。

[http://bugs.dojotoolkit.org/ticket/15616](http://bugs.dojotoolkit.org/ticket/15616)

# database - 数据库函数给出错误 - Postgresql

> ID：14711103
> 
> 赞同：3
> 
> 时间：2013-02-05T15:32:52.023
> 
> 标签：database, postgresql, debian

我在这里得到了一些帮助并得到了以下代码：

```
-- Setup Solrid Function
CREATE OR REPLACE FUNCTION solrid(IN local_id INTEGER, OUT result TEXT) AS $$
DECLARE
  database_id TEXT := 'A';
BEGIN
  result := database_id || local_id::TEXT;
END;
$$ LANGUAGE PLPGSQL; 
```

但是，当我在 sqlfiddle 中运行它时，它会说：

> 架构创建失败：错误：“$$ DECLARE database_id TEXT := 'A'”处或附近未终止的美元引号字符串：

这个错误可能看起来很自我解释，但我无法弄清楚修复它的方法。有人介意对此有所了解吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:20:18.410

这个功能绝对没有问题，它是 100% 合法的。我在安装中使用 8.4 和 9.1 进行了测试。

一定是有什么误解。这不能与触发错误消息的代码完全相同。

# java - PeriodAxis 不正确的时区

> ID：14711105
> 
> 赞同：4
> 
> 时间：2013-02-05T15:33:03.627
> 
> 标签：java, timezone, jfreechart

使用**DateAxis**它工作正常：

```
// From: 2/5/13 02:00:00 PM (+1), To: 2/5/13 03:00:00 PM (+1)
// Configuring dataset
Timezone tz = new SimpleTimeZone(1, "Test");
TimeSeriesCollection dataset = new TimeSeriesCollection(tz);
TimeSeries timeSeries = new TimeSeries("Series1");
...
timeSeries.add(new Millisecond(new Date(timestamp1), tz, locale), value1);
timeSeries.add(new Millisecond(new Date(timestamp2), tz, locale), value2);
timeSeries.add(new Millisecond(new Date(timestamp3), tz, locale), value3);
...
// Setting axis timezone
((DateAxis) chart.getXYPlot().getDomainAxis()).setTimeZone(tz);
((DateAxis) chart.getXYPlot().getDomainAxis()).setRange(new DateRange(
           from, to), true, true); 
```

![日期轴图表](../Images/295a72561dee67d926df4dc454ce347b.png)

但是，当我尝试对**PeriodAxis**执行相同操作时，它会显示不正确的时区。看起来它正在从我的计算机（-3）获取时区。

```
// From: 2/5/13 02:00:00 PM (+1), To: 2/5/13 03:00:00 PM (+1)
// Configuring dataset
Timezone tz = new SimpleTimeZone(1, "Test");
TimeSeriesCollection dataset = new TimeSeriesCollection(tz);
TimeSeries timeSeries = new TimeSeries("Series1");
...
timeSeries.add(new Millisecond(new Date(timestamp1), tz, locale), value1);
timeSeries.add(new Millisecond(new Date(timestamp2), tz, locale), value2);
timeSeries.add(new Millisecond(new Date(timestamp3), tz, locale), value3);
...
// Setting periodAxis
PeriodAxis periodaxis = new PeriodAxis("");

periodaxis.setFirst(new Millisecond(new Date(from), tz));
periodaxis.setLast(new Millisecond(new Date(to), tz));

periodaxis.setTimeZone(tz);

periodaxis.setRange(new DateRange(from, to), true, true);
periodaxis.setAutoRangeTimePeriodClass(Second.class);
PeriodAxisLabelInfo aperiodaxislabelinfo[] = new PeriodAxisLabelInfo[2];
aperiodaxislabelinfo[0] = new PeriodAxisLabelInfo(
        org.jfree.data.time.Minute.class, new SimpleDateFormat("mm"));
aperiodaxislabelinfo[1] = new PeriodAxisLabelInfo(
        org.jfree.data.time.Hour.class, new SimpleDateFormat("HH"));
periodaxis.setLabelInfo(aperiodaxislabelinfo);

chart.getXYPlot().setDomainAxis(periodaxis); 
```

![周期轴图](../Images/8ebb10d1f4488e3eb527dc540a7abba1.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T14:21:54.533

找到了两种方法来解决这个问题：

## 第一

设置时区`SimpleDateFormat`：

```
...
SimpleDateFormat dfMin = new SimpleDateFormat("mm");
dfMin.setTimeZone(tz); // Setting timezone
PeriodAxisLabelInfo aperiodaxislabelinfo[] = new PeriodAxisLabelInfo[2];
aperiodaxislabelinfo[0] = new PeriodAxisLabelInfo(
        org.jfree.data.time.Minute.class, dfMin);
SimpleDateFormat dfHour = new SimpleDateFormat("mm");
dfHour.setTimeZone(tz); // Setting timezone
aperiodaxislabelinfo[1] = new PeriodAxisLabelInfo(
        org.jfree.data.time.Hour.class, dfHour);
periodaxis.setLabelInfo(aperiodaxislabelinfo);
... 
```

* * *

## 第二

也将此报告为[错误](http://sourceforge.net/p/jfreechart/bugs/1107/)，IMO 轴必须遵守`periodaxis.setTimeZone(tz);`指令。此行应添加到[PeriodAxis.java](http://www.jfree.org/jfreechart/api/javadoc/src-html/org/jfree/chart/axis/PeriodAxis.html#line.888)：

```
885        while (p.getFirstMillisecond() <= axisMax) {
886            float x = (float) valueToJava2D(p.getMiddleMillisecond(), dataArea,
887                    edge);
888            DateFormat df = this.labelInfo[band].getDateFormat();

               df.setTimeZone(timeZone); // Missing timezone setting

889            String label = df.format(new Date(p.getMiddleMillisecond()));
890            long first = p.getFirstMillisecond();
891            long last = p.getLastMillisecond();
892            if (last > axisMax) { 
```

# html - HTML5 中的 Youtube 视频

> ID：14711107
> 
> 赞同：1
> 
> 时间：2013-02-05T15:33:06.593
> 
> 标签：html, youtube-api, windows-store-apps, youtube-javascript-api

我使用 Youtube Iframe API 制作了一个 Windows 商店应用程序。我可以很好地处理事件并播放视频，但存在一个主要问题，因为它不支持全屏模式（以及其他一些小问题）。

我一直在查看应用商店，发现大多数 youtube 播放器应用程序不使用 iframe API，它们直接抓取视频并将其放入标准的 HTML5 视频播放器中。

我做了很多搜索，我能看到人们这样做的唯一方法是解析 youtube 页面以找到 Youtube 播放器要播放的视频文件并将其直接加载到媒体播放器中。

我对这种方法有一些问题。

1.  我不确定这是否合法，因为它可能会违反 youtube 的条款和条件
2.  如果 youtube 上的页面发生更改，它可能会破坏应用程序。

这两种情况都不可接受。

有没有办法让全屏在应用程序内工作或合法地获得直接视频流？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:59:30.363

不确定版权和 youtube 条款的东西，但显然你是这样做的：

[将 Youtube 视频源显示为 HTML5 视频标签？](https://stackoverflow.com/questions/5157377/show-youtube-video-source-into-html5-video-tag)

看起来它是特定于浏览器的，youtube 为不同的浏览器生成不同的 html。

我会向 youtube url 附加一个 ajax 请求，`html5-true`然后使用 jQuery 抓取视频标签的源，添加您的属性，然后附加到您的页面。

现在您有了 youtube 使用的标签，所以我假设在他们的网页上有效的内容对您也有效。

可能违反所有条款和条件...

# javascript - Javascript/HTML5 - 尝试制作一个简单的游戏 AI

> ID：14711112
> 
> 赞同：0
> 
> 时间：2013-02-05T15:33:18.853
> 
> 标签：javascript, html5-canvas, game-ai

我的概念很简单。以一种方式为图像设置动画，然后让它回来。

```
var xPos = 10;

function main(){
    window.requestAnimationFrame(main);
    var canvas = document.getElementById("myCanvas");
    var c = canvas.getContext("2d");

    //Initialize images
    var img = new Image();
    img.src = "goomba.png";

    c.clearRect(0,0,500,500);
    c.drawImage(img,xPos,10);

    //increment coordinates
    if(xPos <= 250){
        xPos+=2;
    }
    else if(xPos >= 250){
        xPos-=2;
    }
}
window.requestAnimationFrame(main); 
```

我已经知道我的代码有什么问题。当 xPos 超过 250 时，第二个**if**语句变为真。然而，一旦它低于 250，第一个**if**再次变为 true。所以我知道问题是什么，我只是不知道如何解决它。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:42:50.973

有一个速度变量（正是右，负是左，幅度是改变每个循环的像素数）：

```
var xVelocity = 2; 
```

并使用它来确定每个循环要添加到 xPos 的内容：

```
xPos += xVelocity; 
```

然后根据 xVelocity 和 xPos 设置它，以便图像会“反弹”：

```
if(xVelocity > 0){
    if(xPos > 250){
        xVelocity = -2;
    }
} else {
    if(xPos < 10){
        xVelocity = 2;
    }    
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:51:21.273

[http://jsbin.com/uweyam/1/edit](http://jsbin.com/uweyam/1/edit)

这是你想要的吗？或者你想把它停在左边缘？

UPD .：你也可以让它像这样反弹 - [http://jsbin.com/uweyam/4/edit](http://jsbin.com/uweyam/4/edit)

# codeigniter - 如何在codeigniter搜索中路由查询字符串？

> ID：14711122
> 
> 赞同：0
> 
> 时间：2013-02-05T15:33:43.630
> 
> 标签：codeigniter, routes, query-string, codeigniter-routing

我对路由查询字符串有疑问。

我正在尝试使用 codeigniter 进行搜索。我为每个搜索设置了一些参数，首先是输入文本字段，用于标题或描述。其次，我有诸如实用程序、游戏、锻炼之类的类别……第三，一个平台，例如 IOS、WP、Android ……还有页面。

我想看到这样的路线：

/page/3，或

/page/3/search/whatever 或

/猫/游戏或

/cat/Games/search/battelfield 或

/page/1/cat/games/search/battelfield 或

/search/whatever 或类似的东西。

我将此代码用于模型中的函数：

```
enter code here

 function getAppBy($categ, $page, $str, $platform) {

    $perpage = 16;
    $offset = ($page-1)*$perpage;

    $this->db->select('app.id');
    $this->db->from('t_yp_app_category cat, t_yp_user_apps app');
    if ($categ != "") {
        $this->db->where("cat.name =", $categ);
    } if ($str != "") {
        $this->db->like('app.yp_title', '%' . $str . '%');
        $this->db->like('app.yp_description', '%' . $str . '%');
    }if ($platform != "") {
        $this->db->like('app.yp_platforms', '%' . $platform . '%');
    }

    $this->db->limit($perpage,$offset);
    $query = $this->db->get();
    $result = $query->result_array();
    //FIN SELECT
    if (sizeof($result) > 0) {
        return $result;
    } else {
        return false;
    }
}

enter code here 
```

谢谢你。如果我没有解释清楚，请告诉我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:39:00.553

```
//www.mysite.com/search/sometitle/puzzle/android/4
$route['search/(:any)/(:any)/(:any)'] = 'search/getAppby/$1/$2/$3'; //default without offset, which is why offset defaults to 0
$route['search/(:any)/(:any)/(:any)/(:num)'] = 'search/getAppby/$1/$2/$3/$4'; //default with offset
//You may want to use some regex rather than wildcards ie:(:any)

public function getAppBy($input, $category, $platform, $offset=0){} 
```

# eclipse-plugin - 隐藏/未添加项目性质时的操作

> ID：14711124
> 
> 赞同：1
> 
> 时间：2013-02-05T15:33:49.713
> 
> 标签：eclipse-plugin

Eclipse 插件开发新手。我们正在开发一个自定义插件，它在 MyEclipse 10 上包含一个构建器，我相信它是 Eclipse Indigo。

无论如何，我使用了 Builder 向导生成的示例代码，对其进行了修改，并使其正常工作。现在我试图让“切换自然”动作更像是“添加自然”或“删除自然”，这取决于自然是否存在。

我在 plugin.xml 中有以下内容（我更改了一些名称以保护无辜者）：

```
<extension
       point="org.eclipse.ui.popupMenus">
    <objectContribution
          adaptable="true"
          id="Sample_Eclipse_Plugin.contribution1"
          nameFilter="*"
          objectClass="org.eclipse.core.resources.IProject">

          <menu
                label="Sample"
                id="mainSampleMenu"
                menubarPath="additions">
             <separator
                   name="group1">
             </separator>
          </menu>
          <action
                class="com.sample.eclipse.builder.AddSampleNatureAction"
                enablesFor="+"
                id="Sample_Eclipse_Plugin.addNatureAction"
                label="Add Sample Project Nature"
                menubarPath="mainSampleMenu/group1">
             <enabledWhen>
                <with variable="selection">
                   <iterate ifEmpty="false" operator="or">
                         <with variable="projectNature">
                            <not>
                               <equals value="Sample_Eclipse_Plugin.sampleNature"/>
                            </not>
                         </with>
                   </iterate>
                </with>
             </enabledWhen>
          </action>
          <action
                class="com.sample.eclipse.builder.RemoveSampleNatureAction"
                enablesFor="+"
                id="Sample_Eclipse_Plugin.removeNatureAction"
                label="Remove Sample Project Nature"
                menubarPath="mainSampleMenu/group1">
             <enabledWhen>
                <with variable="selection">
                   <iterate ifEmpty="false" operator="or">
                         <with variable="projectNature">
                            <equals value="Sample_Eclipse_Plugin.sampleNature"/>
                         </with>
                   </iterate>
                </with>
             </enabledWhen>
          </action>
    </objectContribution>
 </extension> 
```

弹出菜单显示完美，但我仍然得到添加和删除选项。所有这些都是基于 Eclipse 生成的示例代码，我将通过 Google 搜索在网上找到的东西拼凑起来。由于缺乏知识，我确信我在做一些非常愚蠢的事情，但任何指导都将受到高度赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-08T12:01:27.527

**添加示例项目性质**

```
<enabledWhen>
   <with variable="selection">
      <iterate ifEmpty="true" operator="and">
         <adapt type="org.eclipse.core.resources.IResource">
            <not>
               <test
                     property="org.eclipse.core.resources.projectNature"
                     value="Sample_Eclipse_Plugin.sampleNature" />
            </not>
         </adapt>
      </iterate>
   </with>
</enableWhen> 
```

它测试所有 ( `operator="and"`) 性质不是 sampleNature。如果选择的项目没有性质，可以`ifEmpty="true"`添加（ ）sampleNature。

**删除示例项目性质**

```
<enabledWhen>
   <with variable="selection">
      <iterate ifEmpty="false" operator="or">
         <adapt type="org.eclipse.core.resources.IResource">
            <test
                  property="org.eclipse.core.resources.projectNature"
                  value="Sample_Eclipse_Plugin.sampleNature" />
         </adapt>
      </iterate>
   </with>
</enableWhen> 
```

它测试 ( `operator="or"`) 个性质之一是 sampleNature。如果所选项目没有性质，则无法（`ifEmpty="false"`）删除 sampleNature。

我在 Eclipse 4.3.1 (Kepler) 中测试了类似的代码。

# java - Java 优化器和冗余数组评估

> ID：14711125
> 
> 赞同：7
> 
> 时间：2013-02-05T15:33:51.673
> 
> 标签：java, performance, optimization, compiler-optimization

这是关于Java优化的一个非常基本的问题。

如果您有一个简单的 for 循环来遍历数组并在循环的标头中使用 array.length 而不是之前对其进行评估，以便您只执行一次（这是我几乎总是这样做的）：

```
for(int i=0; i<array.length;i++) { ... } 
```

是否可以优化语句，以便 JVM 知道数组在循环期间是否正在更改，以便它不会`array.length`每次都重新评估？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T15:37:08.607

> 如果另一个线程没有同时修改数组，array.length 将只被有效评估一次，

更关键的是，除非该字段是`volatile`JVM，否则无论它是否正确都会做出这个假设。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T15:50:01.347

Java中的数组是固定长度的。数组创建后长度不能更改。首先获取长度并将其分配给局部变量没有任何好处。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T17:17:16.567

在花了太多时间调试这个之后，我得到了：

A：

```
 static String test(String[] arg){
     String a  ="";
     for(int i = 0, len = arg.length; i < len; i++)
      if (arg[i].length() > a.length()) a = arg[i];
     return a;
  } 
```

乙：

```
 static String test(String[] arg){
    String a  ="";
    for(int i = 0; i < arg.length; i++)
      if (arg[i].length() > a.length()) a = arg[i];
    return a;
  } 
```

一个字节码：

```
 static java.lang.String test(java.lang.String[]);
  Code:
   0:   ldc #2; //String 
   2:   astore_1
   3:   iconst_0
   4:   istore_2
   5:   aload_0
   6:   arraylength
   7:   istore_3
   8:   iload_2
   9:   iload_3
   10:  if_icmpge   36
   13:  aload_0
   14:  iload_2
   15:  aaload
   16:  invokevirtual   #3; //Method java/lang/String.length:()I
   19:  aload_1
   20:  invokevirtual   #3; //Method java/lang/String.length:()I
   23:  if_icmple   30
   26:  aload_0
   27:  iload_2
   28:  aaload
   29:  astore_1
   30:  iinc    2, 1
   33:  goto    8
   36:  aload_1
   37:  areturn 
```

B字节码：

```
 static java.lang.String test(java.lang.String[]);
  Code:
   0:   ldc #2; //String 
   2:   astore_1
   3:   iconst_0
   4:   istore_2
   5:   iload_2
   6:   aload_0
   7:   arraylength
   8:   if_icmpge   34
   11:  aload_0
   12:  iload_2
   13:  aaload
   14:  invokevirtual   #3; //Method java/lang/String.length:()I
   17:  aload_1
   18:  invokevirtual   #3; //Method java/lang/String.length:()I
   21:  if_icmple   28
   24:  aload_0
   25:  iload_2
   26:  aaload
   27:  astore_1
   28:  iinc    2, 1
   31:  goto    5
   34:  aload_1
   35:  areturn 
```

重要的区别是第 33/31 行，其中 goto 跳转到第 8 行或第 5 行。在 (A) 和 (B) 调用 arraylength 之后。

因此，如果不缓存长度，字节码实际上会在每次迭代中调用 arraylength。

当然 javac 不会优化，只有 JIT 会。那么 JIT 是做什么的呢？

通常看起来什么都没有。它未列在 -XX:+PrintCompilation 已编译方法列表中。

只有在调用该函数 100 万次之后，它才会通过展开循环完全激活并删除长度检查，如果我没看错的话：

一个拆机：

```
# parm0:    rsi:rsi   = '[Ljava/lang/String;'
  #           [sp+0x30]  (sp of caller)
  0x00007fdc296b30a0: mov    %eax,-0x6000(%rsp)
  0x00007fdc296b30a7: push   %rbp
  0x00007fdc296b30a8: sub    $0x20,%rsp         ;*synchronization entry
                                                ; - Acminesimple::test@-1 (line 3)
  0x00007fdc296b30ac: mov    0xc(%rsi),%ebp     ;*arraylength
                                                ; - Acminesimple::test@6 (line 4)
                                                ; implicit exception: dispatches to 0x00007fdc296b31ad
  0x00007fdc296b30af: movabs $0xeb8b7168,%rax   ;   {oop("")}
  0x00007fdc296b30b9: test   %ebp,%ebp
  0x00007fdc296b30bb: jle    0x00007fdc296b312e  ;*if_icmpge
                                                ; - Acminesimple::test@10 (line 4)
  0x00007fdc296b30bd: test   %ebp,%ebp
  0x00007fdc296b30bf: jbe    0x00007fdc296b3177
  0x00007fdc296b30c5: mov    %ebp,%ecx
  0x00007fdc296b30c7: dec    %ecx
  0x00007fdc296b30c9: cmp    %ebp,%ecx
  0x00007fdc296b30cb: jae    0x00007fdc296b3177
  0x00007fdc296b30d1: xor    %r8d,%r8d          ;*aload_0
                                                ; - Acminesimple::test@13 (line 5)
  0x00007fdc296b30d4: mov    0x10(%rsi,%r8,4),%edi  ;*aaload
                                                ; - Acminesimple::test@15 (line 5)
  0x00007fdc296b30d9: mov    0x14(%rdi),%r11d   ; implicit exception: dispatches to 0x00007fdc296b318d
  0x00007fdc296b30dd: mov    0x14(%rax),%r10d   ; implicit exception: dispatches to 0x00007fdc296b319d
  0x00007fdc296b30e1: cmp    %r10d,%r11d
  0x00007fdc296b30e4: jg     0x00007fdc296b30e9  ;*if_icmple
                                                ; - Acminesimple::test@23 (line 5)
  0x00007fdc296b30e6: mov    %rax,%rdi
  0x00007fdc296b30e9: inc    %r8d               ;*iinc
                                                ; - Acminesimple::test@30 (line 4)
  0x00007fdc296b30ec: cmp    $0x1,%r8d
  0x00007fdc296b30f0: jge    0x00007fdc296b30f7  ;*if_icmpge
                                                ; - Acminesimple::test@10 (line 4)
  0x00007fdc296b30f2: mov    %rdi,%rax          ;*iinc
                                                ; - Acminesimple::test@30 (line 4)
  0x00007fdc296b30f5: jmp    0x00007fdc296b30d4
  0x00007fdc296b30f7: cmp    %ecx,%r8d
  0x00007fdc296b30fa: jl     0x00007fdc296b3163
  0x00007fdc296b30fc: mov    %edi,%r10d
  0x00007fdc296b30ff: cmp    %ebp,%r8d
  0x00007fdc296b3102: jl     0x00007fdc296b310f
  0x00007fdc296b3104: mov    %r10d,%r9d
  0x00007fdc296b3107: jmp    0x00007fdc296b312b
  0x00007fdc296b3109: data32 xchg %ax,%ax
  0x00007fdc296b310c: mov    %r9d,%r10d         ;*aload_0
                                                ; - Acminesimple::test@13 (line 5)
  0x00007fdc296b310f: mov    0x10(%rsi,%r8,4),%r9d  ;*aaload
                                                ; - Acminesimple::test@15 (line 5)
  0x00007fdc296b3114: mov    0x14(%r9),%r11d    ; implicit exception: dispatches to 0x00007fdc296b318d
  0x00007fdc296b3118: mov    0x14(%r10),%ebx    ; implicit exception: dispatches to 0x00007fdc296b319d
  0x00007fdc296b311c: cmp    %ebx,%r11d
  0x00007fdc296b311f: cmovle %r10d,%r9d
  0x00007fdc296b3123: inc    %r8d               ;*iinc
                                                ; - Acminesimple::test@30 (line 4)
  0x00007fdc296b3126: cmp    %ebp,%r8d
  0x00007fdc296b3129: jl     0x00007fdc296b310c
  0x00007fdc296b312b: mov    %r9,%rax           ;*if_icmpge
                                                ; - Acminesimple::test@10 (line 4)
  0x00007fdc296b312e: add    $0x20,%rsp
  0x00007fdc296b3132: pop    %rbp
  0x00007fdc296b3133: test   %eax,0x5766ec7(%rip)        # 0x00007fdc2ee1a000
                                                ;   {poll_return}
  0x00007fdc296b3139: retq   
  0x00007fdc296b313a: mov    %r11d,%edi
  0x00007fdc296b313d: data32 xchg %ax,%ax       ;*iinc
                                                ; - Acminesimple::test@30 (line 4)
  0x00007fdc296b3140: movslq %r8d,%r10
  0x00007fdc296b3143: mov    0x14(%rsi,%r10,4),%r10d  ;*aaload
                                                ; - Acminesimple::test@15 (line 5)
  0x00007fdc296b3148: mov    0x14(%r10),%r9d    ; implicit exception: dispatches to 0x00007fdc296b318d
  0x00007fdc296b314c: mov    0x14(%rdi),%r11d   ; implicit exception: dispatches to 0x00007fdc296b319d
  0x00007fdc296b3150: cmp    %r11d,%r9d
  0x00007fdc296b3153: cmovle %edi,%r10d
  0x00007fdc296b3157: add    $0x2,%r8d          ;*iinc
                                                ; - Acminesimple::test@30 (line 4)
  0x00007fdc296b315b: cmp    %ecx,%r8d
  0x00007fdc296b315e: jge    0x00007fdc296b30ff  ;*if_icmpge
                                                ; - Acminesimple::test@10 (line 4)
  0x00007fdc296b3160: mov    %r10d,%edi         ;*aload_0
                                                ; - Acminesimple::test@13 (line 5)
  0x00007fdc296b3163: mov    0x10(%rsi,%r8,4),%r11d  ;*aaload
                                                ; - Acminesimple::test@15 (line 5)
  0x00007fdc296b3168: mov    0x14(%r11),%r10d   ; implicit exception: dispatches to 0x00007fdc296b318d
  0x00007fdc296b316c: mov    0x14(%rdi),%r9d    ; implicit exception: dispatches to 0x00007fdc296b319d
  0x00007fdc296b3170: cmp    %r9d,%r10d
                                                ; - Acminesimple::test@23 (line 5)
  0x00007fdc296b3175: jmp    0x00007fdc296b3140
  0x00007fdc296b3177: mov    %rsi,(%rsp)
  0x00007fdc296b317b: mov    $0xffffff86,%esi
  0x00007fdc296b3180: data32 xchg %ax,%ax
  0x00007fdc296b3183: callq  0x00007fdc29620320  ; OopMap{[0]=Oop off=232}
                                                ;*aload_0
                                                ; - Acminesimple::test@13 (line 5)
                                                ;   {runtime_call}
  0x00007fdc296b3188: callq  0x00007fdc2de8b7c0  ;*aload_0
                                                ; - Acminesimple::test@13 (line 5)
                                                ;   {runtime_call}
  0x00007fdc296b318d: mov    $0xfffffff6,%esi
  0x00007fdc296b3192: nop
  0x00007fdc296b3193: callq  0x00007fdc29620320  ; OopMap{off=248}
                                                ;*invokevirtual length
                                                ; - Acminesimple::test@16 (line 5)
                                                ;   {runtime_call}
  0x00007fdc296b3198: callq  0x00007fdc2de8b7c0  ;*invokevirtual length
                                                ; - Acminesimple::test@16 (line 5)
                                                ;   {runtime_call}
  0x00007fdc296b319d: mov    $0xfffffff6,%esi
  0x00007fdc296b31a2: nop
  0x00007fdc296b31a3: callq  0x00007fdc29620320  ; OopMap{off=264}
                                                ;*invokevirtual length
                                                ; - Acminesimple::test@20 (line 5)
                                                ;   {runtime_call}
  0x00007fdc296b31a8: callq  0x00007fdc2de8b7c0  ;*invokevirtual length
                                                ; - Acminesimple::test@20 (line 5)
                                                ;   {runtime_call}
  0x00007fdc296b31ad: mov    $0xfffffff6,%esi
  0x00007fdc296b31b2: nop
  0x00007fdc296b31b3: callq  0x00007fdc29620320  ; OopMap{off=280}
                                                ;*arraylength
                                                ; - Acminesimple::test@6 (line 4)
                                                ;   {runtime_call}
  0x00007fdc296b31b8: callq  0x00007fdc2de8b7c0  ;*arraylength
                                                ; - Acminesimple::test@6 (line 4)
                                                ;   {runtime_call}
  0x00007fdc296b31bd: hlt    
  0x00007fdc296b31be: hlt    
  0x00007fdc296b31bf: hlt    
[Exception Handler] 
```

B拆解：

```
# parm0:    rsi:rsi   = '[Ljava/lang/String;'
  #           [sp+0x20]  (sp of caller)
  0x00007fc749ebcf20: mov    %eax,-0x6000(%rsp)
  0x00007fc749ebcf27: push   %rbp
  0x00007fc749ebcf28: sub    $0x10,%rsp         ;*synchronization entry
                                                ; - Acfoamsimple::test@-1 (line 3)
  0x00007fc749ebcf2c: mov    0xc(%rsi),%r9d     ;*arraylength
                                                ; - Acfoamsimple::test@7 (line 4)
                                                ; implicit exception: dispatches to 0x00007fc749ebd029
  0x00007fc749ebcf30: movabs $0xeb8b7168,%rax   ;   {oop("")}
  0x00007fc749ebcf3a: test   %r9d,%r9d
  0x00007fc749ebcf3d: jle    0x00007fc749ebcfad  ;*if_icmpge
                                                ; - Acfoamsimple::test@8 (line 4)
  0x00007fc749ebcf3f: test   %r9d,%r9d
  0x00007fc749ebcf42: jbe    0x00007fc749ebcff5
  0x00007fc749ebcf48: mov    %r9d,%ebx
  0x00007fc749ebcf4b: dec    %ebx
  0x00007fc749ebcf4d: cmp    %r9d,%ebx
  0x00007fc749ebcf50: jae    0x00007fc749ebcff5
  0x00007fc749ebcf56: xor    %ecx,%ecx          ;*aload_0
                                                ; - Acfoamsimple::test@11 (line 5)
  0x00007fc749ebcf58: mov    0x10(%rsi,%rcx,4),%edx  ;*aaload
                                                ; - Acfoamsimple::test@13 (line 5)
  0x00007fc749ebcf5c: mov    0x14(%rdx),%r10d   ; implicit exception: dispatches to 0x00007fc749ebd009
  0x00007fc749ebcf60: mov    0x14(%rax),%r8d    ; implicit exception: dispatches to 0x00007fc749ebd019
  0x00007fc749ebcf64: cmp    %r8d,%r10d
  0x00007fc749ebcf67: jg     0x00007fc749ebcf6c  ;*if_icmple
                                                ; - Acfoamsimple::test@21 (line 5)
  0x00007fc749ebcf69: mov    %rax,%rdx
  0x00007fc749ebcf6c: inc    %ecx               ;*iinc
                                                ; - Acfoamsimple::test@28 (line 4)
  0x00007fc749ebcf6e: cmp    $0x1,%ecx
  0x00007fc749ebcf71: jge    0x00007fc749ebcf78  ;*if_icmpge
                                                ; - Acfoamsimple::test@8 (line 4)
  0x00007fc749ebcf73: mov    %rdx,%rax          ;*iinc
                                                ; - Acfoamsimple::test@28 (line 4)
  0x00007fc749ebcf76: jmp    0x00007fc749ebcf58
  0x00007fc749ebcf78: cmp    %ebx,%ecx
  0x00007fc749ebcf7a: jl     0x00007fc749ebcfe1
  0x00007fc749ebcf7c: mov    %edx,%r10d
  0x00007fc749ebcf7f: cmp    %r9d,%ecx
  0x00007fc749ebcf82: jl     0x00007fc749ebcf8f
  0x00007fc749ebcf84: mov    %r10d,%r8d
  0x00007fc749ebcf87: jmp    0x00007fc749ebcfaa
  0x00007fc749ebcf89: data32 xchg %ax,%ax
  0x00007fc749ebcf8c: mov    %r8d,%r10d         ;*aload_0
                                                ; - Acfoamsimple::test@11 (line 5)
  0x00007fc749ebcf8f: mov    0x10(%rsi,%rcx,4),%r8d  ;*aaload
                                                ; - Acfoamsimple::test@13 (line 5)
  0x00007fc749ebcf94: mov    0x14(%r8),%r11d    ; implicit exception: dispatches to 0x00007fc749ebd009
  0x00007fc749ebcf98: mov    0x14(%r10),%edi    ; implicit exception: dispatches to 0x00007fc749ebd019
  0x00007fc749ebcf9c: cmp    %edi,%r11d
  0x00007fc749ebcf9f: cmovle %r10d,%r8d
  0x00007fc749ebcfa3: inc    %ecx               ;*iinc
                                                ; - Acfoamsimple::test@28 (line 4)
  0x00007fc749ebcfa5: cmp    %r9d,%ecx
  0x00007fc749ebcfa8: jl     0x00007fc749ebcf8c
  0x00007fc749ebcfaa: mov    %r8,%rax           ;*if_icmpge
                                                ; - Acfoamsimple::test@8 (line 4)
  0x00007fc749ebcfad: add    $0x10,%rsp
  0x00007fc749ebcfb1: pop    %rbp
  0x00007fc749ebcfb2: test   %eax,0x5766048(%rip)        # 0x00007fc74f623000
                                                ;   {poll_return}
  0x00007fc749ebcfb8: retq   
  0x00007fc749ebcfb9: mov    %r10d,%edx
  0x00007fc749ebcfbc: nopl   0x0(%rax)          ;*iinc
                                                ; - Acfoamsimple::test@28 (line 4)
  0x00007fc749ebcfc0: movslq %ecx,%r10
  0x00007fc749ebcfc3: mov    0x14(%rsi,%r10,4),%r10d  ;*aaload
                                                ; - Acfoamsimple::test@13 (line 5)
  0x00007fc749ebcfc8: mov    0x14(%r10),%r8d    ; implicit exception: dispatches to 0x00007fc749ebd009
  0x00007fc749ebcfcc: mov    0x14(%rdx),%r11d   ; implicit exception: dispatches to 0x00007fc749ebd019
  0x00007fc749ebcfd0: cmp    %r11d,%r8d
  0x00007fc749ebcfd3: cmovle %edx,%r10d
  0x00007fc749ebcfd7: add    $0x2,%ecx          ;*iinc
                                                ; - Acfoamsimple::test@28 (line 4)
  0x00007fc749ebcfda: cmp    %ebx,%ecx
  0x00007fc749ebcfdc: jge    0x00007fc749ebcf7f  ;*if_icmpge
                                                ; - Acfoamsimple::test@8 (line 4)
  0x00007fc749ebcfde: mov    %r10d,%edx         ;*aload_0
                                                ; - Acfoamsimple::test@11 (line 5)
  0x00007fc749ebcfe1: mov    0x10(%rsi,%rcx,4),%r10d  ;*aaload
                                                ; - Acfoamsimple::test@13 (line 5)
  0x00007fc749ebcfe6: mov    0x14(%r10),%r8d    ; implicit exception: dispatches to 0x00007fc749ebd009
  0x00007fc749ebcfea: mov    0x14(%rdx),%r11d   ; implicit exception: dispatches to 0x00007fc749ebd019
  0x00007fc749ebcfee: cmp    %r11d,%r8d
  0x00007fc749ebcff1: jg     0x00007fc749ebcfb9  ;*if_icmple
                                                ; - Acfoamsimple::test@21 (line 5)
  0x00007fc749ebcff3: jmp    0x00007fc749ebcfc0
  0x00007fc749ebcff5: mov    %rsi,%rbp
  0x00007fc749ebcff8: mov    $0xffffff86,%esi
  0x00007fc749ebcfff: callq  0x00007fc749e29320  ; OopMap{rbp=Oop off=228}
                                                ;*aload_0
                                                ; - Acfoamsimple::test@11 (line 5)
                                                ;   {runtime_call}
  0x00007fc749ebd004: callq  0x00007fc74e6947c0  ;*aload_0
                                                ; - Acfoamsimple::test@11 (line 5)
                                                ;   {runtime_call}
  0x00007fc749ebd009: mov    $0xfffffff6,%esi
  0x00007fc749ebd00e: nop
  0x00007fc749ebd00f: callq  0x00007fc749e29320  ; OopMap{off=244}
                                                ;*invokevirtual length
                                                ; - Acfoamsimple::test@14 (line 5)
                                                ;   {runtime_call}
  0x00007fc749ebd014: callq  0x00007fc74e6947c0  ;*invokevirtual length
                                                ; - Acfoamsimple::test@14 (line 5)
                                                ;   {runtime_call}
  0x00007fc749ebd019: mov    $0xfffffff6,%esi
  0x00007fc749ebd01e: nop
  0x00007fc749ebd01f: callq  0x00007fc749e29320  ; OopMap{off=260}
                                                ;*invokevirtual length
                                                ; - Acfoamsimple::test@18 (line 5)
                                                ;   {runtime_call}
  0x00007fc749ebd024: callq  0x00007fc74e6947c0  ;*invokevirtual length
                                                ; - Acfoamsimple::test@18 (line 5)
                                                ;   {runtime_call}
  0x00007fc749ebd029: mov    $0xfffffff6,%esi
  0x00007fc749ebd02e: nop
  0x00007fc749ebd02f: callq  0x00007fc749e29320  ; OopMap{off=276}
                                                ;*arraylength
                                                ; - Acfoamsimple::test@7 (line 4)
                                                ;   {runtime_call}
  0x00007fc749ebd034: callq  0x00007fc74e6947c0  ;*arraylength
                                                ; - Acfoamsimple::test@7 (line 4)
                                                ;   {runtime_call}
  0x00007fc749ebd039: hlt    
  0x00007fc749ebd03a: hlt    
  0x00007fc749ebd03b: hlt    
  0x00007fc749ebd03c: hlt    
  0x00007fc749ebd03d: hlt    
  0x00007fc749ebd03e: hlt    
  0x00007fc749ebd03f: hlt 
```

[在讨论开始的问题](https://stackoverflow.com/questions/14696584/java-loop-through-array)中使用`Math.min(args.length, 20)`而不是`args.length`like ，它的行为类似：

A-with-min:

```
 static java.lang.String test(java.lang.String[]);
  Code:
   0:   ldc #2; //String 
   2:   astore_1
   3:   iconst_0
   4:   istore_2
   5:   aload_0
   6:   arraylength
   7:   bipush  20
   9:   invokestatic    #3; //Method java/lang/Math.min:(II)I
   12:  istore_3
   13:  iload_2
   14:  iload_3
   15:  if_icmpge   41
   18:  aload_0
   19:  iload_2
   20:  aaload
   21:  invokevirtual   #4; //Method java/lang/String.length:()I
   24:  aload_1
   25:  invokevirtual   #4; //Method java/lang/String.length:()I
   28:  if_icmple   35
   31:  aload_0
   32:  iload_2
   33:  aaload
   34:  astore_1
   35:  iinc    2, 1
   38:  goto    13
   41:  aload_1
   42:  areturn 
```

B-with-min:

```
static java.lang.String test(java.lang.String[]);
  Code:
   0:   ldc #2; //String 
   2:   astore_1
   3:   iconst_0
   4:   istore_2
   5:   iload_2
   6:   aload_0
   7:   arraylength
   8:   bipush  20
   10:  invokestatic    #3; //Method java/lang/Math.min:(II)I
   13:  if_icmpge   39
   16:  aload_0
   17:  iload_2
   18:  aaload
   19:  invokevirtual   #4; //Method java/lang/String.length:()I
   22:  aload_1
   23:  invokevirtual   #4; //Method java/lang/String.length:()I
   26:  if_icmple   33
   29:  aload_0
   30:  iload_2
   31:  aaload
   32:  astore_1
   33:  iinc    2, 1
   36:  goto    5
   39:  aload_1
   40:  areturn 
```

（jit 反汇编函数太长，无法在答案中发布）

# r - 最大中间波动率

> ID：14711126
> 
> 赞同：0
> 
> 时间：2013-02-05T15:33:53.910
> 
> 标签：r, cycle

我有两个向量，a 和 b。见附件。

`a`是信号，是概率。 `b`是下一个时期的绝对百分比变化。

```
Signalt <- seq(0, 1, 0.05) 
```

我想找到在`Signalt`a 向量的每个中间 5%-tile ( ) 内出现的最大绝对回报。所以如果是

```
 0.01, 0.02, 0.03, 0.06 0.07 
```

那么它应该计算之间的最大回报

```
 0.01 and 0.02, 
     0.01 and 0.03, 
     0.02 and 0.03\. 
```

然后继续

```
 0.06 and 0.07 do it over etc. 
```

当整个序列运行时，输出将被合并到一个矩阵或表格中。

它应该遵循向量 a 和 b 的索引。

`i`是一个索引，每次`a`跨越一个新的百分位时都会更新一个。是与第交叉`t(i)`关联的桶。`i`

`a`是长度为 tao 的概率向量。这个向量应该在其 5% 的瓦片中进行分析，最大的中间绝对回报是输出。下一周期的价格变化是向量`b`。这将在下面的等式中由 P 表示。 `l`并且`m`是索引。

> 每次 Signal 从一个 5% 的块移动到另一个时，我们计算任何两个中间桶之间发生的最大绝对回报，直到 Signal 移动到另一个 5% 的块。例如，假设 Signal 移动到第 85 个百分位，而 4 个音量桶后来移动到第 90 个百分位。然后，我们将计算存储桶 1 和 2、1 和 3、1 和 4、2 和 3、2 和 4、3 和 4 之间的绝对回报。我们对最大绝对回报感兴趣。然后，我们将计算下一个百分位桶中的最大回报，继续下一个，这可能是第 85 个百分位，依此类推。所以我们让 i 是一个索引，每次 Signal 从一个百分位移动到另一个百分位时，它都会更新 1，并且 τ(i) 与第 i 个交叉关联的桶。

这是我正在使用的等式。符号可能略有不同。 ![方程](../Images/b8edb4f85934ad2e537b55b46b51e98b.png)

现在我的问题是如何去做。也许有人对此有一个直观的解决方案。我希望我的问题很清楚。

```
"a","b"
0,0.013013698630137
0,0.0013522650439487
0,0.00135409614082593
0,0.00203389830508471
0.27804813511593,0.00135317997293627
0.300237801284318,0
0.495965075167796,0.00405405405405412
0.523741892051237,0.000672947510094168
0.558753750296458,0.00202020202020203
0.665762829019002,0.000672043010752743
0.493106479913899,0.000671591672263272
0.344592579573497,0.000672043010752854
0.336263897823707,0.00201748486886366
0.35884763774257,0.00536912751677865
0.23662807979007,0.00133511348464632
0.212636893966841,0.00267379679144386
0.362212830513403,0.000666666666666593
0.319216408413927,0.00333555703802535
0.277670854167344,0
0.310143323100971,0
0.374104373036218,0.00267737617135211
0.190943075221511,0.00268456375838921
0.165770070508112,0.00200803212851386
0.240310208616952,0.00133600534402145
0.212418038918236,0.00200133422281523
0.204282022136019,0.00200534759358306
0.363725074298064,0.000667111407605114
0.451807761954326,0.000666666666666593
0.369296011692801,0.000666222518321047
0.37503495989363,0.0026666666666666
0.323386355686901,0.00132978723404265
0.189216171830472,0.00266311584553924
0.185252052821193,0.00199203187250996
0.174882909380997,0.000662690523525522
0.149291525540782,0.00132625994694946
0.196824215268048,0.00264900662251666
0.164611993131396,0.000660501981505912
0.125470998266484,0.00132187706543285
0.179999532586703,0.00264026402640272
0.368749638521621,0.000658327847267826
0.427799340926225,0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T20:39:55.743

# 我对问题的解释

我希望我能正确理解你的问题。这是我的理解：

1.  对于每一行，您计算它属于哪个 5% 百分位
2.  每当该百分位数发生变化时，您就会开始一个新的存储桶
3.  来自同一存储桶的所有行都会产生一个结果值
4.  如果存储桶中只有一行，则`b`该行的值就是结果值
5.  否则，您计算所有`abs(b[l]/b[m]-1)`位置`m<l`并且都属于同一个存储桶

# 基本答案

## 代码

此处的代码执行我上面描述的操作：

```
# read the data (shortened, full data in OP)
d <- read.table(textConnection("a,b
0,0.013013698630137
[…]
0.427799340926225,0
"), sep=",", header=TRUE)

# compute percentile number for each line    
d$percentile <- floor(d$a/0.05)*5 + 5

# start a new bucket whenever the percentile changes
d$bucket <- cumsum(c(1, diff(d$percentile) != 0))

# compute a single number for all rows of the same bucket
aggregate(b ~ percentile + bucket, d, function(b) {
  if(length(b) == 1) return(b); # special case of only a single row
  m <- outer(b, b, function(pm, pl) abs(pl/pm - 1)) # compare all pairs
  return(max(m[upper.tri(m)])) # only return pairs with m < l
}) 
```

## 输出

结果将如下所示：

```
 percentile bucket            b
1           5      1 0.8960891071
2          30      2 0.0013531800
3          35      3 0.0000000000
4          50      4 0.0040540541
5          55      5 0.0006729475
6          60      6 0.0020202020
7          70      7 0.0006720430
8          50      8 0.0006715917
9          35      9 2.0020174849
10         40     10 0.0053691275
11         25     11 1.0026737968
12         40     12 0.0006666667
13         35     13 0.0033355570
14         30     14 0.0000000000
15         35     15 0.0000000000
16         40     16 0.0026773762
17         20     17 0.2520080321
18         25     18 0.5010026738
19         40     19 0.0006671114
20         50     20 0.0006666667
21         40     21 3.0026666667
22         35     22 0.0013297872
23         20     23 0.7511597084
24         15     24 0.0013262599
25         20     25 0.7506605020
26         15     26 0.0013218771
27         20     27 0.0026402640
28         40     28 0.0006583278
29         45     29 0.0000000000 
```

# 附加列

## 代码

如果您还想知道每个组中的项目数，那么我建议您使用[`plyr`库](http://cran.r-project.org/web/packages/plyr/index.html)：

```
library(plyr)

aggB <- function(b) {
  if(length(b) == 1) return(b)
  m <- outer(b, b, function(pm, pl) abs(pl/pm - 1))
  return(max(m[upper.tri(m)]))
}

ddply(d, .(bucket), summarise,
      percentile = percentile[1], n = length(b), maxr = aggB(b)) 
```

## 输出

这将为您提供以下结果：

```
 bucket percentile n         maxr
1       1          5 4 0.8960891071
2       2         30 1 0.0013531800
3       3         35 1 0.0000000000
4       4         50 1 0.0040540541
5       5         55 1 0.0006729475
6       6         60 1 0.0020202020
7       7         70 1 0.0006720430
8       8         50 1 0.0006715917
9       9         35 2 2.0020174849
10     10         40 1 0.0053691275
11     11         25 2 1.0026737968
12     12         40 1 0.0006666667
13     13         35 1 0.0033355570
14     14         30 1 0.0000000000
15     15         35 1 0.0000000000
16     16         40 1 0.0026773762
17     17         20 2 0.2520080321
18     18         25 3 0.5010026738
19     19         40 1 0.0006671114
20     20         50 1 0.0006666667
21     21         40 2 3.0026666667
22     22         35 1 0.0013297872
23     23         20 3 0.7511597084
24     24         15 1 0.0013262599
25     25         20 2 0.7506605020
26     26         15 1 0.0013218771
27     27         20 1 0.0026402640
28     28         40 1 0.0006583278
29     29         45 1 0.0000000000 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:58:18.140

我不确定是否理解，但在这里尝试一下。我的想法是按百分位数对数据进行分组，而不是使用`by`

1.  为了对数据进行分组，我创建了一个新的变量拆分

    ```
    ##dat$split <- cut(dat$a,seq(0, 1, 0.05),include.lowest=T)

    dat$split <- c(0,cumsum(diff(dat$a) > 0.05)) 
    ```

2.  使用 by，我可以在每个组中执行我的功能。我删除了 NULL prob 值或一个值的奇异情况。

    ```
    by(dat,dat$split,FUN =function(x){
      P <- x$b
      if( is.null(P)||length(P) ==1) return(0)
      nn <- length(P)
      ind <- expand.grid(1:nn,1:nn)     ## I generate indexes here
      ret <- abs(P[ind[,1]]/P[ind[,2]]-1)   ## perfom P_l/P_m-1  (vectorized)
      list(P=P,
           ret.max = max(ret),
            ret.ind = ind[which.max(ret),])
    }) 
    ```

这里是结果列表。对于我显示的每个间隔，

*   P（概率值），
*   最大回报
*   计算此最大值的索引。

例如：

```
dat$split: 0
$P
[1] 0.0130 0.0014 0.0014 0.0020

$ret.max
[1] 8.6236

$ret.ind
  Var1 Var2
5    1    2

--------------------------------------------------------------------------------------------------------------- 
dat$split: 1
$P
[1] 0.0014 0.0000

$ret.max
[1] 1

$ret.ind
  Var1 Var2
2    2    1 
```

# ruby-on-rails - Dynamic partials and cache_digests

> ID：14711130
> 
> 赞同：3
> 
> 时间：2013-02-05T15:34:05.983
> 
> 标签：ruby-on-rails

I have the following code in my contactsheet/preview view:

```
= render :partial => @contactsheet.choose_partial.first 
```

choose_template is a function for selecting the right partial. choose_partial() returns an array with one element (the partial name). It works fine. Now, I want to use cache_digests for this partial, I added the cache code in the partial.

But when I run the rake task `rake cache_digests:nested_dependencies TEMPLATE=contactsheets/preview` for getting the dependencies, it outputs

```
[
  "contactsheets/@contactsheet.choose_template.first"
] 
```

The expression isn't evaluated and the dependency is wrong. How do I correct this dependency?

# c - Difference between #include<...> and #include"..."?

> ID：14711132
> 
> 赞同：-2
> 
> 时间：2013-02-05T15:34:13.113
> 
> 标签：c

> **Possible Duplicate:**
> [What is the difference between #include <filename> and #include “filename”?](https://stackoverflow.com/questions/21593/what-is-the-difference-between-include-filename-and-include-filename)

What is the meaning of include "abc.h" and how it is different from include ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:36:08.217

Including `"abc.h"` will look in the current directory. `<abc.h>` will look in the include directory, which can be provided at compile-time.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:40:44.923

`<abc.h>`通常用于内置用途，例如数学，而`"abc.h"`通常用于定制用途。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T15:47:59.420

首先在您的头文件中查找包含路径和相对于源文件路径的“abc.h”。

# ember.js - 如何为重度嵌套的 ember.js 路由结构连接插座

> ID：14711133
> 
> 赞同：3
> 
> 时间：2013-02-05T15:34:13.957
> 
> 标签：ember.js

我有以下路线

```
App.Router.map(function(match) {
    this.route("days", { path: "/" });
    this.resource("day", { path: "/:day_id" }, function() {
        this.resource("slots", { path: "/slots" }, function() {
            this.resource("slot", { path: "/:slot_id" }, function() {
                this.route("edit", { path: "/edit" });
            });
        });
    });
}); 
```

我有以下模板

```
script/app/templates/application.handlebars
script/app/templates/days.handlebars
script/app/templates/day.handlebars
script/app/templates/day/index.handlebars
script/app/templates/slots.handlebars
script/app/templates/slots/index.handlebars
script/app/templates/slot.handlebars
script/app/templates/slot/index.handlebars
script/app/templates/slot/edit.handlebars 
```

1.  以上是否正确
2.  如果我打算执行以下操作（不包括几天），每个车把模板中应该包含什么 html
3.  假设我要执行以下操作（不包括天数），我需要定义哪些路线

    *   选择一天时，我想显示关联模型的列表（在这种情况下为插槽）
    *   when a slot is selected I want the html from it's index page (showing an individual slot based on the slot id param being passed to the route)

**更新**

到目前为止，看起来标有“资源”的路由需要有一个 {{outlet}} 可用于内部资源或路由以放入一些标记。

例如 day.handlebars 模板有一个 {{outlet}} 并且在我的 day/index.handlebars 模板中我放入一个 for 循环来显示每一天。接下来在 slot.handlebars 模板中，我包含一个 {{outlet}} 并在 slot/index.handlebars 模板中添加另一个 for 循环以显示每个可用的插槽。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-04T18:00:48.713

添加到 Jakub 的答案中 - 在嵌套资源的情况下，通常（当您希望子项在父项上呈现时）**xyz.handlebars**应该只包含出口，并且您想成为 xyz 模板一部分的任何 html 都应该进入**xyz/index .车把**。那是因为无论何时你回到父资源，它都不会被重新渲染，因为 ember 假定它一直存在。但是兄弟姐妹总是会被重新渲染，在你的情况下是 slot/index 和 slot/edit

关于路线，任何必须有孩子的东西都是资源。在您的情况下 ， **host/#/days**和**hosts/#/day**都被渲染到应用程序出口中

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T18:08:15.570

来了

```
script/app/templates/application.handlebars - {{outlet}}
script/app/templates/days.handlebars - template, but it should be a `resource` 
                                       instead of a route, which results in this
script/app/templates/days/index.handlebars - will be rendered on `/days`

script/app/templates/day.handlebars - {{outlet}} inserted into `application` outlet
script/app/templates/day/index.handlebars - inserted into `day` outlet

script/app/templates/slots.handlebars - {{outlet}} inserted into `day` outlet
// this also overwrites `day/index` template, so only one of them 
// can be displayed at once

script/app/templates/slots/index.handlebars - inserted into `slots` outlet
script/app/templates/slot.handlebars - {{outlet}} inserted into `slots` outlet
script/app/templates/slot/index.handlebars - inserted into `slot` outlet
script/app/templates/slot/edit.handlebars - inserted into `slot` outlet 
```

您还应该定义`days`为资源

`this.resource("days", { path: "/" });`

它对其他路线没有任何影响，这条路线仍然有效

`this.resource("day", { path: "/:day_id" } ...`

# node.js - In mongoose how do I push a subdocument onto an array of a saved objects and then return what I just pushed?

> ID：14711136
> 
> 赞同：1
> 
> 时间：2013-02-05T15:34:21.813
> 
> 标签：node.js, mongoose

I am trying to push a subdocument onto my object whenever. Below is the handler for POST. First it checks whether the account was invited to take the survey. If everything checks out, then we want to push the response onto the survey responses array.

```
 handler: function(req, res, next) {
        var survey = req.params.survey;
        var account = req.params.account;

        Survey.findById(survey).exec(function(err, survey) {
            if(err) { return handleError(res, err); }
            if(!survey) { return handleError(res, 'Invalid Survey', true); }
            if(!account) { return handleError(res, 'Invalid Account', true); }

            var invite = _(survey.invites).find(function(i){
                return i.account == account;
            });

            if(!invite) {
                return handleError(res, 'No invite exists for user');
            }

            if(!survey.responses) {
                survey.responses = [];
            }

            var response = survey.responses.push(req.params);

            console.log(response); // returns an integer want it to return the subdocument

            survey.save(function(err){
                if(err) { return handleError(res, err); }
                return res.send(response);
            });

        });
    } 
```

My schemas:

```
var SurveyResponseSchema = new Schema({
    account: {type: Schema.Types.ObjectId, ref: 'Account', required: true},
    answers: [SurveyAnswerSchema],
    complete: Boolean
});

var SurveySchema = new Schema({
    start_date: Date,
    end_date: Date,
    title: String,
    survey_questions: [SurveyQuestionSchema],
    invites: [SurveyInviteSchema],
    responses: [SurveyResponseSchema]
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-06T01:52:16.103

`push`返回数组的新长度`responses`，所以你想做这样的事情：

```
var responseIx = survey.responses.push(req.params) - 1;

survey.save(function(err, survey){
    if(err) { return handleError(res, err); }
    return res.send(survey.responses[responseIx]);
}); 
```

# c++ - Marking a function as inline when compiling with -O3?

> ID：14711137
> 
> 赞同：2
> 
> 时间：2013-02-05T15:34:27.173
> 
> 标签：c++, performance, gcc, inline

C++ allows you to annotate functions with the `inline` keyword. From what I understand, this provides a hint (but no obligation) to the compiler to inline the function, thereby avoiding the small function calling overhead.

I have some methods which are called so often that they really should be inlined. But `inline`-annotated functions need to be implemented in the header, so this makes the code less well-arranged. Also, I think that inlining is a compiler optimization that should happen transparently to the programmer where it makes sense.

So, do I have to annotate my functions with `inline` for inlining to happen, or does GCC figure this out without the annotation when I compile with `-O3` or other appropriate optimization flags?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T15:41:30.787

`inline`只是对编译器的建议是不正确的并且具有误导性。将函数标记为内联有两种可能的影响：

1.  将函数定义内联替换到进行函数调用的位置 &
2.  某些放宽 wrt[一个定义规则](http://en.wikipedia.org/wiki/One_Definition_Rule)，允许您在头文件中定义函数。

编译器可能会执行也可能不会执行`#1`，但它必须遵守`#2`. 所以内联不仅仅是一个建议。一旦函数被标记为内联，就会应用一些规则。

作为一般准则，不要`inline`仅仅为了优化而标记您的函数。大多数现代编译器将在没有您帮助的情况下自行执行这些优化。`inline`如果您希望将它们包含在头文件中，请标记您的函数，因为这是在不破坏 ODR 的情况下在头文件中包含函数定义的唯一正确方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T15:37:40.247

常见的民间传说是 gcc 总是自行决定（基于一些成本启发式）是否内联某些东西（取决于编译器/链接器选项，它甚至可以在链接时这样做）。您有时可以在使用 -Winline 时观察到这一点，其中 gcc 警告内联提示已被忽略，它通常甚至给出一个原因。

如果您想确切地知道发生了什么，您可能必须阅读它的源代码，或者听读它的人的话。

# highcharts - Custom axis labels on Stacked bar chart

> ID：14711138
> 
> 赞同：2
> 
> 时间：2013-02-05T15:34:28.650
> 
> 标签：highcharts

I am generating a standard stacked bar chart for a client. But what they want for the yAxis label is not the sum of the values of the two stacked bars. This is easy is a simple bar chart, but in a stacked chart it always takes the total of the two. My existing code is:

```
return Highcharts.numberFormat(Math.round(this.total*100)/100, 2) + '%'; 
```

I'm setting the number I need to display in the data string like this:

```
data: [{y: 1.83, color: '#BBBBBB', 'QTotal': 3.37} 
```

Where 'QTotal' is the value they want to display. I've tried the following with no luck:

```
return Highcharts.numberFormat(Math.round(this.QTotal*100)/100, 2) + '%';
return Highcharts.numberFormat(Math.round(this.point.QTotal*100)/100, 2) + '%';
return Highcharts.numberFormat(Math.round(this.y.QTotal*100)/100, 2) + '%'; 
```

Setting up fixed labels doesn't work cause the number of bars being shown is flexible. Any pointer would be greatly appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:04:03.043

如果我正确理解您的问题，您应该使用以下方法访问额外数据：

```
return Highcharts.numberFormat(Math.round(this.series.options.QTotal*100)/100, 2) + '%'; 
```

另请参阅此答案：[将附加数据添加到 Highcharts 系列以用于格式化程序](https://stackoverflow.com/questions/8752141/add-additional-data-to-a-highcharts-series-for-use-in-formatters/8758914#8758914)

还有这个：[将附加数据设置为 highcharts 系列](https://stackoverflow.com/questions/8514457/set-additional-data-to-highcharts-series)

# c# - Mono.TextTemplating passing parameters to template

> ID：14711139
> 
> 赞同：2
> 
> 时间：2013-02-05T15:34:41.273
> 
> 标签：c#, monodevelop, t4, css, texttemplate

I try to pass a parameter(foo) to an existing template(MyTemplate.tt) with this command:

**TextTransform.exe -a=foo!bar -o Output.txt MyTemplate.tt**

MyTemplate.tt:

```
<#@ template language="C#" #>
<#@ import namespace="System.IO" #>

<#
  this.Write(foo);  
#> 
```

This command fails due to the parameter "foo" is not existing. How can I pass this parameter correctly?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T20:11:23.210

MonoDevelop 的 TextTransform.exe 的参数与 Microsoft 的相匹配，在[此处](http://msdn.microsoft.com/en-us/library/bb126245.aspx)记录。

不幸的是，这些参数在代码中没有作为变量公开，它们旨在作为自定义指令处理器的参数。要直接从代码访问它们，您必须`hostspecific="true"`通过设置和访问它们`Host.ResolveParameterValue (paramName)`。

但是，您可以使用动态对象来使您的示例工作，方法是在模板的基类上[实现`IDynamicMetaObjectProvider`](http://msdn.microsoft.com/en-us/vstudio/ff800651.aspx)并覆盖`BindGetMember`以解析来自`Host.ResolveParameterValue`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T08:41:15.383

谢谢，这对我来说很好：

**TextTransform.exe -a=foo!bar -o Output.txt MyTemplate.tt**

我的模板.tt：

```
<#@ template language="C#" hostspecific="true" #>
<# string temp = this.Host.ResolveParameterValue("", "", "foo");#>
<#
  this.Write(temp);  
#> 
```

输出.txt：

```
bar 
```

我还将看看 IDynamicMetaObjectProvider。

# excel - Pure Excel: How do I reference a column wit a dynamic number?

> ID：14711141
> 
> 赞同：2
> 
> 时间：2013-02-05T15:34:59.760
> 
> 标签：excel, excel-2010

I create a random number in my excel sheet (using RAND), 5 for example. Now I want to reference column A[my number], in this example its A5\. How would I do that?

If thats not possible, is it possible to get a random row value from a column?

Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:40:23.810

通常 INDEX 比 INDIRECT 更可取（它不是易失性的，您不需要“硬编码”列引用）。如果您在 B3 中有随机数，请尝试

`=INDEX(Data!A:A,B3)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T15:38:14.443

`=INDIRECT("A"&RANDBETWEEN(1;10))`将随机返回 range 中的单元格`A1:A10`。

# php - Trying to think of a way to dynamically add text for each image

> ID：14711142
> 
> 赞同：1
> 
> 时间：2013-02-05T15:35:01.297
> 
> 标签：php, jquery

I'm trying to think of a way to make this happen.

I'm using a jQuery slideshow to display images, and a simple php script to pull the images from a folder based on which gallery the user selects:

```
 $handle = opendir(dirname(realpath(__FILE__)).'/../images/gallery/'.$gallery);
while($file = readdir($handle)){
    if($file !== '.' && $file !== '..'){
        $pictures .= '<img src="images/gallery/'.$gallery.'/'.$file.'" alt="" />';
    }
} 
```

I'm doing it this way since there are 6 different galleries, and the amount of photos in each gallery varies, from about 25 - 40 pictures. If I did the site staticly, or had a database running it'd be no problem, but I can't think of a PHP way of doing this.

Basically here is an example of what I'm hoping to do: [I hard coded all the images and text](http://diguiseppi.com/Brad/index.php?cat=Create&do=International-Gallery)

But on [this page](http://diguiseppi.com/Brad/index.php?cat=Create&do=Gallery) I can't think of a good way of doing it

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:38:17.033

`info.txt`您可以像描述一样添加到每个文件夹文件。在加载时检查 file_exists() 并从文件中获取数据。

如果你想为每张照片设置 desc，你可以这样做：

对于文件：

*   花.jpg
*   云.jpg
*   女孩.jpg

信息.txt：

```
flower.jpg::This is flower
cloud.jpg::This is cloud
girl.jpg::This is girl 
```

因此，您阅读 info.txt，按行分解并最后分解行。结果，您将获得带有描述和文件名的数组。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-05T19:51:24.383

可能不是最好的方法，但这是我完成它的解决方法：`我将图像重命名：01-A Bird，02-A Cat

```
$handle = opendir(dirname(realpath(__FILE__)).'/../images/gallery/'.$gallery);
while($file = readdir($handle)){
    if($file !== '.' && $file !== '..'){

        $alt = substr($file, 3, -4); //Removes the "##-" and the ".jpg"
        $id = substr($file, 0, 2); // Removes EVERYTHING after the "##"

    // The image
        $pictures .= '<img src="images/gallery/'.$gallery.'/'.$file.'" alt="'.$alt.'" data-caption="#cap'.$id.'" />';
    // The text
        $span .= '<span class="caption" id="cap'.$id.'">'.$alt.'</span>';

    }
}` 
```

# mysql - 如何更正此查询？

> ID：14711147
> 
> 赞同：-2
> 
> 时间：2013-02-05T15:35:39.637
> 
> 标签：mysql

我有一个看起来像这样的 MySQL 查询：

```
SELECT column1_value, column2_value 
  FROM some_table
 WHERE column2_value IN (a,lot,of,comma,separated,values)
   AND column1_value NOT IN (SELECT column1_value, 
                                    column3_value 
                               FROM some_table 
                              WHERE column3_value = some_number)
ORDER BY something DESC
LIMIT 4 
```

但是一直报错，怎么回事？

我不能做 IN 然后不 IN 吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:37:18.497

错误在这部分

```
NOT IN (SELECT column1_value, column3_value 
        FROM some_table 
        WHERE column3_value = some_number) 
```

如您所见，您从子查询中返回了多个列。从子查询中获取值时，它应该只返回*一*列。

尝试使用`LEFT JOIN`，

```
SELECT  column1_value, column2_value 
  FROM  some_table
        LEFT JOIN
        (
            SELECT  column1_value,  column3_value 
            FROM    some_table   
            WHERE column3_value = some_number
        ) x ON sometable.column1_value = x.column1_value
 WHERE  column2_value IN (a,lot,of,comma,separated,values) AND
        x.colName IS NULL
ORDER   BY something DESC
LIMIT 4 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T15:38:18.280

问题是这条线

```
AND column1_value NOT IN (SELECT column1_value, 
                                column3_value 
                           FROM some_table 
                          WHERE column3_value = some_number) 
```

注意内部子查询？

```
SELECT column1_value, column3_value 
FROM some_table 
WHERE column3_value = some_number 
```

您将返回数据集中的两列！它应该只是

```
SELECT column1_value 
FROM some_table 
WHERE column3_value = some_number 
```

或您要测试的任何（单个！）列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T15:37:16.717

我认为您不允许在第二个子查询中选择多于一列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T15:37:58.370

在部分：

```
(SELECT column1_value, column3_value FROM some_table WHERE column3_value = some_number) 
```

您选择了多个值，它是一组值。

# ios - Detecting a cancelled itunes login alert for in-app purchases

> ID：14711148
> 
> 赞同：17
> 
> 时间：2013-02-05T15:35:44.930
> 
> 标签：ios, objective-c, storekit

I have a class that implements `SKPaymentTransactionObserver`. However when clicking a buy button, if the user is not signed into the app store they get an alert asking for an existing ID or to create a new one. If the use clicks cancel from this, or a subsequent login credentials alert, I receive no notification of that cancellation. I have an activity view covering the screen after the buy button is clicked so I really need to know if the login alert was cancelled.

I already test for the error code `SKErrorPaymentCancelled` and that works if the purchase process is cancelled after logging in. I'm testing on a device.

Any clues?

-UPDATE-

Apologies I forgot to mention that this only happened when attempting to restore transactions, and that reveals the answer: my lack of knowledge about the protocol.

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-02-06T05:00:46.280

要在用户尝试取消恢复购买请求后检测取消事件，请执行：

```
- (void)paymentQueue:(SKPaymentQueue *)queue restoreCompletedTransactionsFailedWithError:(NSError *)error
{
    // test error.code, if it equals SKErrorPaymentCancelled it's been cancelled
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-03-14T15:27:25.567

在 Swift 3.0 中

```
public func paymentQueue(_ queue: SKPaymentQueue, restoreCompletedTransactionsFailedWithError error: Error) {
        print("Cancel Transaction");
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-01-18T12:27:46.420

在斯威夫特 2.2

```
public func paymentQueue(queue: SKPaymentQueue, restoreCompletedTransactionsFailedWithError error: NSError) {
    print("Cancel Transaction")

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-13T23:50:59.957

当用户取消让他们输入 Apple ID 凭据的提示时，事务的状态为`SKPaymentTransactionStateFailed`. 这可能会令人困惑，因为如果用户自愿退出流程，则交易在技术上并未“失败”。要检测用户是否真正退出了进程，请检查事务错误（访问者）的错误代码是否`transaction.error.code`为`SKErrorPaymentCancelled`。如果不是，则该应用实际上在处理交易时遇到了问题。

# wordpress - S2Member Wordpress Plugin Configuration

> ID：14711151
> 
> 赞同：0
> 
> 时间：2013-02-05T15:35:51.163
> 
> 标签：wordpress

Hi I am a newbie in Wordpress.

I want a registration form and paypal button in a page.

User will fill in the details and click the paypal payment button .

The user information gets saved and the url will be redirected to the paypal website for

payment.

I have installed the s2member plugin ,read the configurations but somehow unable to achieve the same.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T02:49:44.390

回答需要您确认您是否需要不同的访问级别、在付费之前是否需要任何免费用户以及您的订阅模式。使用大锤破解用户注册和付款没有意义，只能使用 Gravity 表格和 PayPal 设置，但需要了解更多才能正确回答。

让我们知道，然后可以提供帮助。

# python - How to authenticate with requests module using a trust store?

> ID：14711153
> 
> 赞同：0
> 
> 时间：2013-02-05T15:35:57.607
> 
> 标签：python, authentication, python-requests, truststore, urllib3

I am currently writing a python language plugin for a compiler I have written that automates http calls for a RESTful API. I have managed to get the login/authentication working using the socket and ssl modules, but this low-level approach seems to create potential problems with parsing the response in order to obtain the authentication token and secret. The requests module seems popular/efficient, however, I cannot seem to get it to function properly for my particular authentication needs. I am using a trust store in the form of a .pem file (containing just a public key) that I converted from my .jks file used to authenticate for the Java plugin. The server expects the username and password to be submitted in the request body in json format. Here is the code I have been trying to use:

```
#Server and login data
...
host = 'localhost'
port = 8443
pem_file = "C:\\Users\\aharasta\\pycert.pem"

#Digest password with MD5 algorithm
m = hashlib.md5()
m.update(password)
encrypted_password = m.hexdigest()

url = <url>
data = {'userid': user_name, 'password': encrypted_password}
json_data = json.dumps(data)
headers = {'Content-type': 'application/json', 'Accept': 'text/plain', 'Content \                     
          Length': len(json_data)} 

r = requests.post(url, headers = headers, data = json_data, cert = pem_file)
print(r) 
```

Upon execution, this code will raise an SSL error stating "certificate verify failed". If I add the parameter `verify = False` or `verify = pem_file`, I will receive a 404 response from the server. I should also note that when I launch the server in debug mode and execute the request (with one of the verify parameters), it never makes it to the server's authentication methods, or any methods for that matter. Any insight or help on this matter would be *greatly* appreciated!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:51:24.100

首先，您发布的内容有几个问题：

*   您指定但未给出示例`host`，因此我们可以猜测您正在使用本地部署进行测试，并且可以实际查看对服务器的请求。我不确定您在谈论什么方法，但是如果您使用类似于 Flask 的东西进行服务器开发，您可能不想将身份验证作为 JSON 编码数据发送。有 Authentication 标头是有原因的，请求有 Authentication 处理程序是有原因的。;-)`port``url`

*   您不应该`Content-Length`自己指定标题。requests 将为您执行此操作。除此之外，您指定它不正确（根据您发布的内容），因此 404 可能来自接收您的服务器无法识别的标头。

现在，应该没有理由指定`verify=False`，您可以指定`cert=pem_file`或`verify=pem_file`。一个或两个都可以，但你永远不应该使用`verify=False`.

最后，`SSLError`引发的 是告诉您`pem`您提供的文件与服务器指定的文件不匹配。考虑到这一点，您可能需要检查本地服务器的设置。Requests 本身不处理证书验证，但 urllib3 提供了它。我们只是根据您提供的参数进行设置。我怀疑这是 urllib3 的错，因为它引发了`SSLError`标准库`ssl`模块产生的问题。

**编辑**

说明在[文档](http://docs.python-requests.org/en/latest/user/advanced/#ssl-cert-verification)中指定的`*.pem`文件`cert`无效。您必须使用`verify='/path/to/file.pem'`才能正确执行此操作。

**编辑#2**

要检查已发送的请求，您可以执行以下操作：

```
r = requests.post(...)
r.request
# PreparedRequest('POST', url, ...)
r.request.body
r.request.headers
# etc. 
```

要在发送前修改请求，您可以执行以下操作：

```
from requests import Request, Session

s = Session()
r = Request('POST', url, datajson_data, headers=headers)
p = r.prepare()
p.body = 'New body'
p.headers = #etc.
s.send(p, verify=pem_file) 
```

# python - Fbconsole output error

> ID：14711155
> 
> 赞同：0
> 
> 时间：2013-02-05T15:36:04.677
> 
> 标签：python, facebook, oauth

I use [fbconsole](https://github.com/facebook/fbconsole) for authetication on Facebook.

```
import fbconsole
fbconsole.APP_ID = '1234567890'
fbconsole.AUTH_SCOPE = ['publish_stream', 'publish_checkins', 'read_stream',         'offline_access']
fbconsole.authenticate()
newsfeed = fbconsole.get('/me/home', {'fields':'from,name,description,message'})
newsfeedData = newsfeed["data"]
for status in newsfeedData:
    print status['from']['name'];
    print status['created_time'];
    #print status['name']
    print status['message']
    #print status.encode("utf-8")
    print('##############################################################################') 
```

The `status['from']['name']` shows name of friend, but `status['message']` shows KeyError. How can I print news from Facebook, if `'status'` is dictionary type and it HAS the `'message'` key??? The same error is printing on `'name'` key.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:44:26.453

有时没有“ **name** ”和“ **message** ”值，在这种情况下，facebook 不会将它们包含在响应中。这可能是它引发错误的原因。我想您应该检查密钥是否存在。但老实说，我不知道如何在 Python 中做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-07T07:28:52.557

您可以使用 python 的 (try, except) 块来解决问题。例如

```
try:
 print(status['message'])
except(KeyError):
 print("This post doesn't contain any message")
 continue 
```

# c++ - Lambda 函数返回类似自动的行为

> ID：14711158
> 
> 赞同：1
> 
> 时间：2013-02-05T15:36:09.823
> 
> 标签：c++, c++11, lambda

我在尝试创建以下 lambda 函数时遇到问题：

```
const auto var x = [&y]() -> /*???*/ {
if (y == type1) {
  return some_type_1;
} else if (y == type2) {
  return some_type_2;
} else // ... 
```

我知道我不能使用 auto 作为返回类型。但我怎么能以另一种方式做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:38:14.737

如果`some_type_1`和`some_type_2`有一个共同的类型，写：

```
const auto var x = [&y]() -> typename std::common_type<
  decltype(some_type_1),
  decltype(some_type_2)>::type {
if (y == type1) {
  return some_type_1;
} else if (y == type2) {
  return some_type_2;
} else // ... 
```

等效地，您可以使用三元表达式：

```
const auto var x = [&y]() {
  (y == type1) ? some_type_1 :
  (y == type2) ? some_type_2 :
  ...;
} 
```

# python - 使用 Selenium 的 Python 绑定处理响应

> ID：14711161
> 
> 赞同：0
> 
> 时间：2013-02-05T15:36:17.953
> 
> 标签：python, selenium

因此，我有一个网页，其中包含一些在单击链接时会执行的 javascript。此 javascript 打开一个新窗口并调用其他一些 javascript，该 javascript 请求一个 xml 文档，然后解析该 url 以传递给视频播放器。如何使用 selenium 获得该 xml 响应？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:39:02.410

简短的回答，除非将 xml 发布到页面上，否则您不能。长答案，您可以使用 Selenium 在页面上进行 JS 注入，以便将 xml 文档复制到您可以预期的某个隐藏页面元素，或存储到您可以打开的本地文件中。当然，这是假设 xml 文档实际上是在客户端检索的；如果这都是服务器端，您需要与后端集成或自己模拟调用。哦，最后一个要探索的选项是代理 Selenium 正在驱动的浏览器，然后检查包含 xml 的响应的流量。虽然更复杂，但这实际上可以说是最好的解决方案，因为您没有修改被测系统来测试它。

# r - 为什么在指定中断时直方图的 X 轴值会消失？

> ID：14711166
> 
> 赞同：0
> 
> 时间：2013-02-05T15:36:32.867
> 
> 标签：r, ggplot2, histogram, raster

尝试使用 ggplot2 绘制光栅文件，但 x 轴值消失了。我很感激任何帮助

```
conne <- file("C:complete.bin","rb")
sd <- readBin(conne, numeric(), size=4,  n=1440*720, signed=TRUE)
y <-t(matrix((data=sd), ncol=1440, nrow=720))
f <- hist(y, breaks=30,main="sm")
f$counts <-f$counts/sum(f$counts)
dat <- data.frame(counts= f$counts,breaks = f$mids)
ggplot(dat, aes(x = breaks, y = counts, fill =counts)) + 
    geom_bar(stat = "identity",alpha = 0.8)+
    xlab("Bi")+ 
    ylab("Frequency")+
    scale_fill_gradientn(colours = rev(rainbow(20, s = 1, v = 1, start = 0, end = 1)[1:12]))+
    ggtitle("2010")+
    theme(axis.title.x = element_text(size = 20))+
    theme(axis.title.y =  element_text(size = 20))+
    theme(plot.title = element_text(size = rel(2.5)))+
    scale_x_continuous(breaks = seq(seq(-0.5,0.5,0.1)),labels = seq(seq(-0.5,0.5,0.1))) 
```

![在此处输入图像描述](../Images/ac080a9b6c55e611d7f5b4ed85dd5c67.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T18:17:14.543

正如@joran 暗示的那样，将最后一行更改为

```
scale_x_continuous(breaks = seq(-0.5,0.5,0.1),labels = seq(-0.5,0.5,0.1)) 
```

（我认为`labels`在这种情况下，这个论点可能是多余的。）当你运行时`seq(seq(...))`，你得到的是在`seq`向量上运行的结果，即从 1 到向量长度 (11) 的索引向量。该向量根本不与数据的 x 范围重叠，因此中断消失了...

# mercurial - 如何使用tortoiseHg 和Mercurial 下载google 开源代码？

> ID：14711167
> 
> 赞同：0
> 
> 时间：2013-02-05T15:36:32.740
> 
> 标签：mercurial, tortoisehg

我想下载[http://code.google.com/p/android-traditional-chinese-ime/source/checkout](http://code.google.com/p/android-traditional-chinese-ime/source/checkout)这个。但是如何使用tortoiseHg2.7配合Mercurial下载google开源代码呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:15:28.143

看起来该项目正在使用 Subversion 存储库，因此如果您想将源作为 Mercurial 存储库获取，您有两个选择，它们都使用 Mercurial 扩展。

一种是[HgSubversion](http://mercurial.selenic.com/wiki/HgSubversion)，它允许您直接使用 Subversion 存储库，理论上允许您将更改推送回项目。Mercurial（或 TortoiseHg）不附带它，因此您必须单独下载它。我没有使用过它，所以不能真正评论它。

另一个选项是Mercurial 附带的[转换](http://mercurial.selenic.com/wiki/ConvertExtension)- 您只需要启用它，在 TortoiseHg*中，您可以通过选择用户配置并选中扩展部分中的“转换”框来完成。*再说一次，我没有用它来处理 Subversion 存储库，所以只能将您指向扩展页面，它有一些有用的信息。

或者，您可以使用 Subversion 本身，它更有可能与存储库一起使用而不会出现问题。我建议使用[TortoiseSVN](http://tortoisesvn.net/) - 它应该可以满足您的需求。

# matlab - 如何在 MATLAB 中连接向量和单元格？

> ID：14711171
> 
> 赞同：0
> 
> 时间：2013-02-05T15:36:43.510
> 
> 标签：matlab

我有`F`尺寸为 5 X 3 的矩阵。例如：

```
 F= [1 12 13; 
    2 23 24; 
    3 34 35; 
    4 45 46;
    5 56 57] 
```

我有一个大小为 1X1 的标签单元格，条目为“v”，即

```
>> label

     label = 

       'v' 
```

F 的大小由下式给出：

```
>> [m n]=size(F)

     m=

      5

    n =

      3 
```

我希望我的输出看起来像：

```
>> F

    F =

         1    12    13   v
         2    23    24   v
         3    34    35   v
         4    45    46   v
         5    56    57   v 
```

如何将单元格与矩阵连接以获得此输出？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T15:48:36.627

要创建一个包含数字和非数字数据的数组，您需要将所有内容放入一个元胞数组（如果它不是元胞数组，请替换为）`label`：`{label}`

```
Fcell = [ num2cell(F), repmat(label,size(F,1),1)] 
```

然后，您可以使用大括号访问单个数字/字母：

```
Fcell{2,2}

ans =
   23 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:03:04.873

正如@Jonas 所描述的，当您想要访问数据以供进一步使用时，将其转换为单元格是一种方法。但是，如果您只对查看屏幕上的数据感兴趣并且不喜欢括号，这也是一个选项：

```
Fcell = [num2str(F) repmat([' ' label{1}],size(F,1),1)] 
```

如果您的标签实际上是一个字符，它应该像这样工作：

```
Fcell = [num2str(F) repmat([' ' label],size(F,1),1)] 
```

# redis - 使用 Redis 跟踪并发的出站 HTTP 请求

> ID：14711172
> 
> 赞同：3
> 
> 时间：2013-02-05T15:36:58.200
> 
> 标签：redis

我对 Redis 有点陌生，但我想看看它是否可以用来跟踪我正在创建的并发 HTTP 连接数。

这是高级计划：

```
INCR requests
// request begins
HTTP.get(...)
// request ends
DECR.requests 
```

然后在任何时候，只需打电话`GET requests`看看目前有多少是开放的。

这里的最终目标是限制我的 http 请求保持在任意数量以下，比如 50 个请求/秒。

这是正确的方法吗？有什么陷阱吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:28:41.990

我不清楚在这种情况下使用 redis 会获得什么。在我看来，在你的服务器中只使用一个全局变量会更合适。如果您的服务器出现故障，您的计数器也会出现故障，因此您不必放置复杂的东西来处理断开连接、不一致等问题......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:42:49.890

至于陷阱，我唯一能看到的是，服务器出现故障或失去与 Redis 中间请求的连接可能永远不会调用`DECR`.

由于您不知道哪个服务器执行哪个请求，因此您永远无法将计数重置为正确的值，而不会使系统停止并重置为 0。

# javascript - 如何使用 chrome 扩展修改站点元素

> ID：14711178
> 
> 赞同：1
> 
> 时间：2013-02-05T15:37:20.583
> 
> 标签：javascript, html, json, google-chrome-extension

我想修改带有扩展名的站点的内容，有`<ul>`和`<il>`标签，（在 a 内`<div>`），我想`<il>`在`<ul>`. 任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T17:23:03.667

您可以[将 JS 注入带有 Chrome 扩展程序的站点](http://developer.chrome.com/extensions/content_scripts.html)。例如，使用 jQuery，您可以执行以下操作：

```
$("div > ul").append("<li>This is a new list element.</li>"); 
```

这会将“新列表元素”附加到`ul`元素。

2013.02.06 更新：

取自[Chrome 扩展文档](http://developer.chrome.com/extensions/content_scripts.html)。清单文件将包含以下内容（其中“...”表示省略）：

```
{
  "name": "My extension",
  ...
  "content_scripts": [
    {
      "matches": ["http://www.the-site-your-targeting.com/*"],
      "js": ["jquery.js", "myscript.js"]
    }
  ],
  ...
} 
```

并且`myscript.js`将包含以下内容：

```
(function () {
    // $("#theIdOfTheElement").append("<li>Foo bar baz</li>");
    // OR
    // $(".aSpecificClassName").append("<li>Foo bar baz</li>");
}()) 
```

阅读Chrome 开发者网站上的[入门](http://developer.chrome.com/extensions/getstarted.html)文章，了解有关创建扩展程序的整个过程如何工作的更深入信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T03:38:47.563

没有 jQuery：

```
var ul = document.getElementsByTagName("div")[0].getElementsByTagName("ul")[0];
var newElement = document.createElement("li");
var textNode = document.createTextNode("New Element");
newElement.appendChild(textNode);
ul.appendChild(newElement); 
```

# php - 使用 PHP 将图像上传到新创建的域

> ID：14711179
> 
> 赞同：1
> 
> 时间：2013-02-05T15:37:23.677
> 
> 标签：php, image, dns, cross-domain

**用例**：在用户可以创建自己的站点并将其发布到 Internet 的项目上工作。（类似于[this](http://www.wix.com)或[this](http://app.imcreator.com)的东西）。用户可以**创建并稍后编辑**他的网站。当用户想要发布时，我们创建他选择的域（首先是子域。以后可以是不同的域）。

**问题**：我们要做的是，将图像直接存储在为用户创建的域上（该域最初将创建为子域）。例如，我们的站点位于 www.xyz.com，那么子域可以是 ABC.xyz.com。这将有助于为发布域和编辑域维护一个图像副本。我们不想将相同的图像存储在两个不同的位置。

**研究**：
我发现可以使用两种可能性：
1）在每个创建的域上都有一个 php**上传脚本**（`upload.php`），当用户上传任何图像时会调用**它。--> 不确定效率如何**
2）使用 FTP 传输从一个域到另一个域的图像。（一些跨域机制）**-->不确定这里的安全问题**

我需要编写任何类型的跨域脚本吗？请帮助我解决这个问题。我不想要整个代码，而是需要让我朝着正确方向发展的逻辑。**建议，如果我的方法是错误的欢迎**。谢谢你的时间。
**注意：**我仍在寻找其他替代方案。如果我得到某种形式的代码，将更新它。

# grails - GRAILS：createCriteria NAND

> ID：14711181
> 
> 赞同：0
> 
> 时间：2013-02-05T15:37:27.420
> 
> 标签：grails, createcriteria

我在 createCriteria 中的查询中有一堆行，但必须进行一些更改，我需要隐藏列中包含 0 和另一列中字母 A 的行，但如果它们有，我不会隐藏它们0 和另一个字母，我怎样才能在 createCriteria 中做到这一点？我唯一的解决方案是使用 NAND，但我认为它不存在......

```
 createCriteria.list{
                     nand{
                          eq('value',0)
                          eq('letter','A')  
                     }
             }

             TABLE
             VALUE          LETTER
             0              A                HIDE
             0              B                NOT HIDE
             1              A                NOT HIDE 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:58:21.100

您可以使用`and`和`ne`：

```
createCriteria.list {
    and {
        ne 'value', 0
        ne 'letter', 'A'
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:00:27.010

使用 HQL，您可以：

```
def result = Object.executeQuery(
   "from Object o where o not in " +
       "(from Object o2 where o2.value = '0' and o2.letter = 'A')",
  ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T15:55:33.013

试试“ne”，不等于

```
createCriteria.list{
   and{
      eq('value',0)
      ne('letter','A')  
   }
} 
```

# php - 如何处理爆炸 get 参数并像 Python Google App Engine 中的 PHP 一样检查它

> ID：14711183
> 
> 赞同：1
> 
> 时间：2013-02-05T15:37:32.020
> 
> 标签：php, python, google-app-engine

整整一天后，我想出了一种在 python 文件中获取 GET 参数的方法。

现在在我的 URL 上`localhost:8080/test_file?mood=good,bad`，我想像我们在 PHP 中那样分解一个 GET 参数`explode(',', $_GET['mood'])`

在python中我写道：

```
mymood = cgi.escape(self.request.get('mood')) 
```

我在哪里得到`good,bad`命令`self.response.out.write(mymood)` 但是当我使用 .split 函数时，我现在很困惑，如何使用像 if else 这样的决策语句。（实际上我想在 PHP 中使用像**in_array**一样- 即是否`good`存在于`mymood`python 变量中）我写道：

```
splitted = mymood.split(',') 
```

并且，它会发出`[u'good', u'bad']`命令`self.response.out.write(splitted)`

如何处理爆炸 get 参数并在 Python Google App Engine 中使用 if else 或 in_array （就像 PHP）检查它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:46:51.303

你可以这样做：

```
if 'good' in splitted: 
```

它相当于 PHP

```
if (in_array('good', splitted)) { 
```

# quartz-scheduler - 实例失败后石英作业不会重新启动

> ID：14711186
> 
> 赞同：2
> 
> 时间：2013-02-05T15:37:40.933
> 
> 标签：quartz-scheduler, restart, jobs

我在集群环境（2 个节点、持久性、集群、JobStoreCMT）中运行了 QUARTZ 1.8.5。现在我安排几个作业在每天的特定时间运行。我将每个作业的 REQUEST RECOVERY 设置为 true（jobDetail.setRequestsRecovery(true)。我看到 QRTZ_JOB_DETAILS 表中的标志设置为 1。我想要的是一个节点失败（例如重新启动 Jboss 服务器）然后其他活动节点重新启动失败的作业。但这不会发生。

我做错了什么/没做什么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:56:31.137

您是否尝试过更新到最新的 Quartz？已经出了一个版本`2.1.6`。

否则，您所做的似乎是正确的。

# matlab - 创建网络

> ID：14711187
> 
> 赞同：0
> 
> 时间：2013-02-05T15:37:41.633
> 
> 标签：matlab

我希望在 MATLAB 中创建一个包含源节点和目标节点的简单网络。源节点发送大小从 512 到 1024 不等的数据包，一旦链路连接好，然后无线连接，以计算这些不同情况下的延迟。我真的不知道从哪里开始。

我在 MATLAB 相对较新，所以任何帮助都会非常有用！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:44:08.563

关于它的教程是[如何创建自己的网络](http://www.stanford.edu/group/pdplab/pdphandbook/handbookap2.html)。

# windows - 批处理文件进度纺车

> ID：14711188
> 
> 赞同：4
> 
> 时间：2013-02-05T15:37:42.317
> 
> 标签：windows, batch-file, cmd

我已经尝试了好几天，似乎可以让它发挥作用。我找到了一个例子，但它使用了一个不起作用的（CryEcho）。我只是想添加它以让用户知道在 ping IP 地址时正在发生的事情。我确实在这里找到了一些代码，但这让我感到困惑，因为我刚刚开始为了好玩而搞乱批处理文件。

无论如何，我想要使用类似于下面示例的内容，但使用类似 (Waiting...[spinner]) 的文本。谢谢！

```
@echo off
setlocal

set COUNT=0
set MAXCOUNT=10
set SECONDS=1

:LOOP
title "\"
call :WAIT
title "|"
call :WAIT
title "/"
call :WAIT
title "-"
if /i "%COUNT%" equ "%MAXCOUNT%" goto :EXIT
set /a count+=1
echo %COUNT%
goto :LOOP

:WAIT
ping -n %SECONDS% 127.0.0.1 > nul
ping -n %SECONDS% 127.0.0.1 > nul
goto :EOF

:EXIT
title FIN!
endlocal 
```

我也发现了这段代码：

```
@echo off
rem Example showing how to use CryEcho to produce a spinning wheel to show activity.

CryEcho Working ... 
call :DoSomeWork
call :SpinAlive
call :DoSomeWork
call :SpinAlive
call :DoSomeWork
call :SpinAlive
call :DoSomeWork
call :SpinAlive
call :DoSomeWork
call :SpinAlive
call :DoSomeWork
call :SpinAlive
call :DoSomeWork
call :SpinAlive
call :DoSomeWork
call :SpinAlive
call :DoSomeWork

cryecho \s\nFinished.

goto :eof

:DoSomeWork
ping -n 1 localhost > nul
goto :eof

:SpinAlive
if "%Spinner%" == "2" (cryecho \\\b) 
if "%Spinner%" == "3" (cryecho -q "|"\b) 
if "%Spinner%" == "4" (cryecho /\b set Spinner=0) else (cryecho -\b set Spinner=1)
set /A Spinner=%Spinner%+1
goto :eof 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-05T16:50:30.070

这里的主要技巧是将光标移回同一行。
这可以用一个`carriage return`或一个`backspace`字符来完成。

```
@echo off
setlocal EnableDelayedExpansion
for /f %%a in ('copy /Z "%~dpf0" nul') do set "CR=%%a"

FOR /L %%n in (1,1,10) DO (
    call :spinner
    ping localhost -n 2 > nul
)
exit /b

:spinner
set /a "spinner=(spinner + 1) %% 4"
set "spinChars=\|/-"
<nul set /p ".=Waiting !spinChars:~%spinner%,1!!CR!"
exit /b 
```

`<CR>`字符是从 的输出创建的`copy /z`。
输出由 完成`set /p`，因为这省略了`CR/LF`最后的输出。每次输出都强制光标移回第一列
。 但由于 Win7 和 Vista 删除了所有空格，并且还从 的前导输出中删除，它被放置在末尾。`!CR!`
`CR``set /p`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-03T07:47:38.663

```
@ECHO OFF
SETLOCAL ENABLEDELAYEDEXPANSION
CALL :BACKSPACE $BS
SET /A FULL_COUNT=75
SET /A MAX_COUNT=160
SET /A Spin_Delay=60
SET "_MSG=Process running..."
SET /A CTR=0
IF NOT [%1]==[] SET "_MSG=%~1"
IF NOT [%2]==[] SET /A FULL_COUNT=%2
IF NOT [%3]==[] SET /A SPIN_DELAY=%3
IF %FULL_COUNT% GTR %MAX_COUNT% SET /A FULL_COUNT=%MAX_COUNT%
<nul SET/P="%_MSG%*"
SET "SPINNER=³/Ä\"
FOR /L %%A IN (1,1,%FULL_COUNT%) DO (
  CALL :DELAY %SPIN_DELAY%
  <nul CALL SET/P="%$BS%%%SPINNER:~!CTR!,1%%"
  SET /A CTR=%%A %% 4
)
<nul SET/P="%$BS%*"
ENDLOCAL & EXIT /B %CTR%

:BackSpace
setlocal
for /f %%a in ('"prompt $H&for %%b in (1) do rem"') do set "BS=%%a"
endlocal&call set %~1=%BS%&exit /b 0

:Delay msec
setlocal
set/a correct=0
set/a msecs=%1+5
if /i %msecs% leq 20 set /a correct-=2
set time1=%time: =%
set/a tsecs=%1/1000 2>nul
set/a msecs=(%msecs% %% 1000)/10
for /f "tokens=1-4 delims=:." %%a in ("%time1%") do (
  set hour1=%%a&set min1=%%b&set sec1=%%c&set "mil1=%%d"
)
if /i %hour1:~0,1% equ 0 if /i "%hour1:~1%" neq "" set hour1=%hour1:~1%
if /i %min1:~0,1% equ 0 set min1=%min1:~1% 
if /i %sec1:~0,1% equ 0 set sec1=%sec1:~1%
if /i %mil1:~0,1% equ 0 set mil1=%mil1:~1% 
set/a sec1+=(%hour1%*3600)+(%min1%*60)
set/a msecs+=%mil1%
set/a tsecs+=(%sec1%+%msecs%/100)
set/a msecs=%msecs% %% 100
::    check for midnight crossing
if /i %tsecs% geq 86400 set /a tsecs-=86400
set/a hour2=%tsecs% / 3600
set/a min2=(%tsecs%-(%hour2%*3600)) / 60
set/a sec2=(%tsecs%-(%hour2%*3600)) %% 60
set/a err=%msecs%
if /i %msecs% neq 0 set /a msecs+=%correct%
if /i 1%msecs% lss 20 set "msecs=0%msecs%"
if /i 1%min2% lss 20 set "min2=0%min2%"
if /i 1%sec2% lss 20 set "sec2=0%sec2%"
set "time2=%hour2%:%min2%:%sec2%.%msecs%"
:wait
  set timen=%time: =%
  if /i %timen% geq %time2% goto :end
goto :wait
:end
for /f "tokens=2 delims=." %%a in ("%timen%") do set num=%%a
if /i %num:~0,1% equ 0 set num=%num:~1%
set/a err=(%num%-%err%)*10
endlocal&exit /b %err% 
```

# javascript - 使用 JSPDF 将网页转换为 pdf：'Uint8Array' 未定义

> ID：14711195
> 
> 赞同：1
> 
> 时间：2013-02-05T15:38:03.970
> 
> 标签：javascript, html, pdf, jspdf

我正在尝试使用 jspdf 将表单从网页转换为 pdf。我有一个应该触发创建 pdf 的按钮，但是当我按下它时出现此错误：

0x800a1391 - Microsoft JScript 运行时错误：“Uint8Array”未定义

当我尝试在 Chrome 中打开它时，我得到一个空白的 pdf，并且没有错误。

该错误是由此处第二个文件中的这一行引起的：

```
var array = new Uint8Array(new ArrayBuffer(length)); 
```

[https://gist.github.com/anonymous/4715183](https://gist.github.com/anonymous/4715183)

我假设由于它创建了一个空白 pdf，问题在于缓冲区试图读取数据。我不知道我在做什么，所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T03:49:23.797

[Uint8Array](http://msdn.microsoft.com/en-us/library/ie/br212477%28v=vs.94%29.aspx)直到 Internet Explorer 10 才可用。

[Can I Use...](http://caniuse.com/#search=uint8array)表示类型化数组从 Firefox 4 和 Chrome 7 开始可用。

# python - 对 Django Q 对象执行逻辑异或

> ID：14711203
> 
> 赞同：10
> 
> 时间：2013-02-05T15:38:18.693
> 
> 标签：python, django, django-queryset, django-q

我想对对象执行逻辑异或（[XOR](http://en.wikipedia.org/wiki/Exclusive_disjunction)）`django.db.models.Q`，使用[运算符](http://docs.python.org/2/library/operator.html)模块将模型字段的选择限制为外键的子集。我在 Django 1.4.3 和 Python 2.7.2 中这样做。我有这样的事情：

```
import operator

from django.conf import settings
from django.db import models
from django.db.models import Q
from django.contrib.auth.models import User, Group

def query_group_lkup(group_name):
    return Q(user__user__groups__name__exact=group_name)

class Book(models.Model):
    author = models.ForeignKey(
                 User,
                 verbose_name=_("Author"),
                 null=False,
                 default='',
                 related_name="%(app_label)s_%(class)s_author",
                 # This would have provide an exclusive OR on the selected group name for User
                 limit_choices_to=reduce(
                     operator.xor,
                     map(query_group_lkup, getattr(settings, 'AUTHORIZED_AUTHORS', ''))
                 ) 
```

`AUTHORIZED_AUTHORS`是现有组名的列表。

但这不起作用，因为`Q`对象不支持`^`运算符（仅支持[docs](https://docs.djangoproject.com/en/1.4/topics/db/queries/#complex-lookups-with-q-objects)`|`中的和`&`运算符）。来自堆栈跟踪的消息（部分）如下：

```
File "/home/moi/.virtualenvs/venv/lib/python2.7/site-packages/django/db/models/loading.py", line 64, in _populate
    self.load_app(app_name, True)
  File "/home/moi/.virtualenvs/venv/lib/python2.7/site-packages/django/db/models/loading.py", line 88, in load_app
    models = import_module('.models', app_name)
  File "/home/moi/.virtualenvs/venv/lib/python2.7/site-packages/django/utils/importlib.py", line 35, in import_module
    __import__(name)
  File "/opt/dvpt/toto/apps/book/models.py", line 42, in <module>
    class Book(models.Model):
  File "/opt/dvpt/toto/apps/book/models.py", line 100, in Book
    map(query_group_lkup, getattr(settings, 'AUTHORIZED_AUTHORS', ''))
TypeError: unsupported operand type(s) for ^: 'Q' and 'Q' 
```

因此，受这个[答案](https://stackoverflow.com/questions/8903128/python-list-to-bitwise-operations)的启发，我尝试为我的特定查找实现 XOR。它不是很灵活，因为查找是硬编码的（我需要在例如...`kwargs`的参数中使用）。`query_xor`我最终做了这样的事情：

```
from django.conf import settings
from django.db import models
from django.db.models import Q
from django.db.models.query import EmptyQuerySet
from django.contrib.auth.models import User, Group

def query_xor_group(names_group):
    """Get a XOR of the queries that match the group names in names_group."""

    if not len(names_group):
        return EmptyQuerySet()
    elif len(names_group) == 1:
        return Q(user__user__groups__name__exact=names_group[0])

    q_chain_or = Q(user__user__groups__name__exact=names_group[0])
    q_chain_and = Q(user__user__groups__name__exact=names_group[0])

    for name in names_group[1:]:
        query = Q(user__user__groups__name__exact=name)
        q_chain_or |= query
        q_chain_and &= query

    return q_chain_or & ~q_chain_and

class Book(models.Model):
    author = models.ForeignKey(
                 User,
                 verbose_name=_("author"),
                 null=False,
                 default='',
                 related_name="%(app_label)s_%(class)s_author",
                 # This provides an exclusive OR on the SELECT group name for User
                 limit_choices_to=query_xor_group(getattr(settings, 'AUTHORIZED_AUTHORS', ''))
                 ) 
```

它可以按我的意愿工作，但在我看来，我似乎不是 pythonic（尤其是`query_xor_group`方法）。会有更好（更直接的方式）这样做吗？

基本上，我的问题可以去掉`limit_choices_to`部分，总结为：

**如何`django.db.models.Q`以 Djangonic 方式对一组对象进行按位异或？**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-01-19T18:19:45.700

您可以`__xor__()`向 Q 添加一个使用和/或/不执行 XOR 逻辑的方法。

```
from django.db.models import Q

class QQ:
    def __xor__(self, other):    
        not_self = self.clone()
        not_other = other.clone()
        not_self.negate()
        not_other.negate()

        x = self & not_other
        y = not_self & other

        return x | y

Q.__bases__ += (QQ, ) 
```

这样做后，我可以打电话`Q(...) ^ Q(...)`了`filter()`。

```
Foobar.objects.filter(Q(blah=1) ^ Q(bar=2)) 
```

这意味着原始尝试不再引发不受支持的操作数异常。

```
limit_choices_to=reduce(
                     operator.xor,
                     map(query_group_lkup, getattr(settings, 'AUTHORIZED_AUTHORS', ''))
                 ) 
```

测试`Django 1.6.1`在`Python 2.7.5`

# c++ - 多个 QGLWidgets 和 gluUnProject

> ID：14711207
> 
> 赞同：0
> 
> 时间：2013-02-05T15:38:23.033
> 
> 标签：c++, qt, opengl, qglwidget

我有一个包含两个 QGLWidget 的 QMainWindow。小部件使用默认构造函数并且不共享上下文。这些小部件都显示二维数据并允许单击和拖动。

这可以使用 gluUnproject 并在创建的第一个 QGLWidget 上运行良好。单击第二个小部件时，一切都按预期工作。但是，当拖动第二个小部件时，移动并不顺畅。更糟糕的是，一旦第二个小部件被拖动，第一个小部件的 gluUnproject 就会出现与第二个显示器被拖动的方向和距离相关的一些边距。

我尝试在绘图方法开始时、鼠标事件开始时调用 makeCurrent() 以及一个、另一个和两者的组合，但没有看到任何改进。

```
void MyGLWidget::paintEvent(QPaintEvent *event){
    glViewport(0, 0, widgetWidth, widgetHeight);

    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(90,(GLfloat)((widgetWidth/widgetHeight)),0.1f,-zoomMin);
    glTranslatef(camera.x, camera.y, camera.zoom);

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();

    glClearColor(0.0f, 0.0f, 0.0f, 0.0f);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    //[GL Drawing code]

    glGetDoublev( GL_MODELVIEW_MATRIX, _modelview );
    glGetDoublev( GL_PROJECTION_MATRIX, _projection );
    glGetIntegerv( GL_VIEWPORT, _viewport );
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:09:41.537

确保您传递给 gluUnProject 的视口和矩阵数据与您正在与之交互的小部件相匹配。理想情况下，您在绘制时将它们的副本创建到一些小部件类成员变量中。

# java - Android 上的 USB HID

> ID：14711211
> 
> 赞同：2
> 
> 时间：2013-02-05T15:38:34.953
> 
> 标签：java, android, usb, hid

我正在尝试从 Android 中的定制 USB 设备（作为从设备工作）读取数据。我能够使用以下代码将数据写入设备：

```
UsbRequest request = new UsbRequest();
request.initialize(_outConnection, _outEndpoint);

int bufferDataLength = _outEndpoint.getMaxPacketSize();

ByteBuffer buffer = ByteBuffer.allocate(bufferDataLength + 1);
buffer.put(bytes);
if (request.queue(buffer, bufferDataLength)) {
            UsbRequest req = _outConnection.requestWait(); } 
```

我在我的设备连接到的调试板上看到了结果。我正在尝试使用相同的方法来读取数据，但显然这不起作用：

```
int siz = 1; 
ByteBuffer res = ByteBuffer.allocate(siz + 1);
UsbRequest request = new UsbRequest();
request.initialize(_inConnection, _inEndpoint);
request.queue(res, siz); // This return false always 
```

我究竟做错了什么？我不知道发回的数据包的大小 - 但我假设我总是能够读取 1 个字节。

我的设备具有带两个中断端点（IN 和 OUT）的 HID 接口

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T08:33:39.243

我不知道是什么解决了这个问题，但现在它可以工作了。我已经从头开始重写了所有内容。我想我没有使用此代码（我认为它是用于用户通知，我不需要它。但似乎它是别的东西） - 这就是它不起作用的主要原因：

```
// Create and intent and request a permission.
    PendingIntent mPermissionIntent = PendingIntent.getBroadcast(_context, 0, new Intent(ACTION_USB_PERMISSION), 0);
    IntentFilter filter = new IntentFilter(ACTION_USB_PERMISSION);
    _context.registerReceiver(mUsbReceiver, filter); 
```

我做过的几件事帮助我实现了稳定的连接：

1）每次需要时关闭和打开连接。我知道这听起来很奇怪，但这是我让它稳定的唯一方法。如果我尝试使用长期连接，由于某种原因它会损坏并在一段时间后停止工作。

2）在永无止境的while循环中连续读取。我还在我的所有线程中放了一些短暂的睡眠——这有助于以更实时的方式阅读。

3) 锁定设备（同步）。我不会同时打开写入和读取连接。

我没有为这个项目分配太多时间，而且这个项目只是一个演示 - 所以所有这些都非常适合我们。我想如果多花一点时间，其中一些东西可能会被改写成更好的东西。

# iphone - NSInvalidArgumentException 出现在模态视图中

> ID：14711214
> 
> 赞同：0
> 
> 时间：2013-02-05T15:38:44.767
> 
> 标签：iphone, ios, objective-c, exception

有时在我的测试设备上有时会出现以下异常，但并非总是如此。我不明白为什么应用程序有时会崩溃但并非总是如此，以及为什么有时会崩溃。我正在使用 crashlytics 收集异常。

```
[[Shared instance].myTabbar presentModalViewController:imagePicker animated:YES]; 
```

**异常类型：** NSInvalidArgumentException

**原因：**应用程序试图以模态方式呈现一个活动控制器。

# internet-explorer - Janrain 在不显示小部件的情况下参与

> ID：14711216
> 
> 赞同：1
> 
> 时间：2013-02-05T15:38:48.557
> 
> 标签：internet-explorer, janrain

有没有办法在没有小部件的情况下使用免费 API 向提供者进行身份验证？

我的问题我正在尝试从 Windows Phone 应用程序实现身份验证，而 WebBrowser 控件似乎无法很好地呈现小部件内容。

不过，它在 IE10 网络浏览器应用程序中运行良好。问题是由于 WebBrowser 控件无法将混合资源从 http 转换为 https

# directx - 如何减少关于 D3DXCreateTextureFromFileInMemoryEx 的使用内存？

> ID：14711224
> 
> 赞同：0
> 
> 时间：2013-02-05T15:39:06.023
> 
> 标签：directx, direct3d

我正在使用 Direct3D 制作 2D 游戏，并用于`D3DXCreateTextureFromFileInMemoryEx`加载我的游戏图像。我的游戏中有 221KB 大小的图像。但是当我使用`D3DXCreateTextureFromFileInMemoryEx`将图像加载到内存时。它们在内存中使用了数十次。

那么，我怎样才能减少使用的内存呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:09:17.027

默认情况下，D3DX 纹理加载功能非常灵活，将通过执行各种格式转换、压缩/解压缩、缩放、mip-map 生成和其他任务来帮助您将任意源图像转换为可用纹理。

如果您想阻止任何这种转换（这在 CPU 成本和内存使用方面可能很昂贵），那么您需要确保您的源纹理已经完全符合您想要的格式，然后将标志传递给 D3DX 告诉它不要执行任何转换或缩放。

通常，支持 D3D 使用的所有纹理格式的唯一文件格式是 D3D 格式 DDS，因此您需要将所有源资源保存为 DDS 文件。如果您用于制作纹理的软件不直接支持保存 DDS 文件，您可以使用 DirectX SDK 随附的工具为您进行转换，编写您自己的工具或使用其他第三方转换工具。

如果您安装了完整的 DirectX SDK（2010 年 6 月的 SDK，最后一个独立版本），您可以使用与它一起安装的 DirectX 纹理工具。不过，这并未随 Windows 8 SDK 一起提供（DirectX SDK 现在是 Windows SDK 的一部分，并且不作为独立的 SDK 提供）。

一旦您将源资源转换为具有您希望在运行时使用的格式的 DDS 文件（可能是 DXT 压缩，并预先生成完整的 mipmap 链），您希望将正确的标志传递给 D3DX 纹理加载函数以避免任何转换. 这意味着你应该通过：

*   `D3DX_DEFAULT_NONPOW2`对于`Width`and`Height`参数和参数（意思`D3DX_DEFAULT`是 `MipLevels`从文件中获取尺寸并且不要将大小四舍五入到 2 的幂）*。
*   `D3DFMT_FROM_FILE`对于`Format`参数（意味着使用文件中的确切纹理格式）。
*   `D3DX_FILTER_NONE`对于`Filter`and`MipFilter`参数（意味着不执行任何缩放或过滤）。

如果您将源资源预处理为您希望在运行时使用的确切格式，将它们保存为 DDS 文件并设置上面的所有标志以告诉 D3DX 不要执行任何转换，那么您应该会发现您的纹理加载速度更快并且没有过多的内存使用。

*这要求您的目标硬件支持非 2 纹理的幂，或者您只使用 2 纹理的幂。过去 5 年的几乎所有硬件都支持非 2 纹理的幂，所以这应该是相当安全的。

# mysql - Bash脚本：Mysql查询字段到变量

> ID：14711229
> 
> 赞同：0
> 
> 时间：2013-02-05T15:39:12.067
> 
> 标签：mysql, bash

我正在尝试获取记录集并从中读取一些字段。我无法弄清楚如何将字段放入变量中。脚本是：

```
#!/bin/bash
sqlQuery="$(mysql -h host -u user -ppass -D oberonsaas_v2 -s -N -e 
'select ventas.id_venta,
ventas_entradas.id_ventas_entradas,
ventas.id_evento,
id_tarifa,
DATE_FORMAT(fecha_evento,"%Y%m%d") as fecha,
TIME_FORMAT(pase,"%H%i") as pase

from pases,ventas,ventas_entradas,recintos

where ventas.id_recinto = recintos.id_recinto 
and ventas.id_pase = pases.id_pase
and ventas.id_venta = ventas_entradas.id_venta
and recintos.id_cliente = 32
and ventas.estado="Pagada"
and date(fecha_venta) = date_add(date(CURRENT_TIMESTAMP),INTERVAL -1 day)')"
echo $sqlQuery 
```

我在 $sqlQuery 中获得了所有记录集，但我想做一个循环并连接字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:16:21.200

好吧，我发明了一些输出

```
#!/bin/bash

Result="21,336,purchase,tarif_exspensive,Jose"
(IFS=","
for i in $Result
do
    echo "I Have: " $i
done
) 
```

输出是

```
$ bash t5.sh 
I Have:  21
I Have:  336
I Have:  purchase
I Have:  tarif_exspensive
I Have:  Jose 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:21:51.810

将其折叠成最简单的结构。将返回的记录集放入 bash 数组中（例如）：

```
sqlQuery=( pases_value ventas_value ventas_entradas_value recintos_value ) 
```

注意：你的可能看起来像：

```
sqlQuery=( $(mysql -h host ... ) 
```

数组运算符“（”和“）”之间的新行是可以的

每个都将位于不同的 sqlQuery 数组位置。例如返回：recintos_value

```
echo ${sqlQuery[3]} 
```

连接所有：

```
echo ${sqlQuery[*]} 
```

如果需要考虑分隔符，请使用 mysql --delimiter 开关来定义所需的字符，然后

```
set concatValue=${sqlQuery[*]} 
```

然后删除分隔符（例如“，”）：

```
set finalValue=${concatValue//,} 
```

# c# - ASP.NET Request.ServerVariables 产生本地 IP 地址而不是远程 IP

> ID：14711235
> 
> 赞同：3
> 
> 时间：2013-02-05T15:39:54.723
> 
> 标签：c#, asp.net, iis, ip

在 c# 中有一个 asp.net 网页。我们想做的一件事是跟踪网站的点击，包括他们的 IP 地址。我实现了一些代码（感谢 SO），但记录的 IP 地址似乎总是本地的，即：192.168.xx 我已经从各种设备上尝试过，甚至是我的手机和版本 MiFi，只是为了确保它不奇怪ISP，但日志总是列出相同的 2-3 个不同的内部 IP 地址（随着时间的推移，似乎会发生一些变化）。

这是我获取 IP 的函数（再次感谢 SO 上的帖子）：

```
protected IPAddress GetIp(HttpRequest request)
{
    string ipString;
    if (string.IsNullOrEmpty(request.ServerVariables["HTTP_X_FORWARDED_FOR"]))
        ipString = request.ServerVariables["REMOTE_ADDR"];
    else
        ipString = request.ServerVariables["HTTP_X_FORWARDED_FOR"].Split(",".ToCharArray(), StringSplitOptions.RemoveEmptyEntries).FirstOrDefault();

    IPAddress result;
    if (!IPAddress.TryParse(ipString, out result))
        result = IPAddress.None;

    return result;
}

public void logHit()
{
    IPAddress ip = GetIp(Request);
    string sIP = ip.ToString();
} 
```

我也试过这个，产生相同的结果：

```
HttpContext.Current.Request.UserHostAddress; 
```

当我使用 apppot 上的服务之类的东西在客户端进行呼叫时，它工作得很好：

```
<script type="application/javascript">
    function getip(json) {
        //txtIP is a input box on the form
        document.getElementById("txtIP").value = json.ip;
    }
</script>

<script type="application/javascript" src="http://jsonip.appspot.com/?callback=getip"></script> 
```

我想我可以通过点击那个appspot链接并解析它来做一个迂回的方法，但是对于应该很简单的事情来说，这似乎是一个很大的麻烦。

会不会是服务器上的 IIS？某种重定向正在进行？记录的 IP 地址不是服务器。问题是我无法直接访问它，所以我必须与管理它的人交谈，并希望在他们开始改变之前给他们一些指导。

谢谢

厄尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T05:05:11.820

如果真正支持 HTTP_X_FORWARDED_FOR 标头，那么我认为这不会是正向或反向代理服务器导致此问题，而更有可能是动态网络地址转换或动态端口地址转换，这发生在 TCP/IP 堆栈上的应用层下方因此不会影响 HTTP 请求标头。

配置 NAT 的方法有很多，其中大多数*不会*导致这些症状，但当然可以以会出现此问题的方式配置 NAT。动态 NAT 或动态 PAT 将是两个这样的示例，我建议这是您向网络管理员询问的内容。

有关动态 NAT/PAT 的更多信息以及很好的示例，您可以查看：[http ://www.cisco.com/en/US/docs/security/asa/asa82/configuration/guide/nat_dynamic.html](http://www.cisco.com/en/US/docs/security/asa/asa82/configuration/guide/nat_dynamic.html)

在典型的 NAT 场景中，请求数据包到达 NAT 设备（防火墙或路由器）为： FROM - 5.5.5.5（客户端的公共地址） TO - 6.6.6.6（服务器的公共地址）

“典型” NAT 配置将仅重写目标，如下所示： FROM - 5.5.5.5 TO - 192.168.6.6（服务器的私有地址）

在这种典型情况下，服务器仍会将 REMOTE_ADDR 视为 5.5.5.5，因为这是传入请求的源地址。然后，数据包将返回到 5.5.5.5，响应将成功返回客户端。

现在，以动态 PAT 为例，请求将按如下方式到达 NAT 设备： FROM - 5.5.5.5 TO - 6.6.6.6

然后，NAT 设备将重写源数据包*和*目标数据包，仅在请求的生命周期内维护这个“动态”映射：FROM - 192.168.1.1:12345（动态 PAT 地址）到 - 192.168.6.6（私有地址）服务器）

现在，当服务器看到这个请求时，它似乎来自私有地址 192.168.1.1。事实上，在严格的 PAT下，*所有*请求似乎都来自该地址。在您的情况下，这些地址有 2 或 3 个，可能是因为您可能有足够的流量，如果您只使用一个动态 PAT 地址，您可能会冒着耗尽端口的风险。

因此，您的 REMOTE_ADDR 是 192.168.1.1，因为这实际上是请求数据包上的源地址。没有 HTTP_X_FORWARDED_FOR，因为动态 PAT 发生在较低的 TCP/IP 层（地址而不是应用程序）。

最后，响应被发送回 192.168.1.1:12345，路由到 NAT 设备，在请求/响应期间（请参阅上面的 Cisco 文档）将其映射回 5.5.5.5，然后丢弃“动态”映射。

一切正常，客户端得到响应，除了你从服务器的角度不知道实际的客户端地址。如果它是动态 NAT，我看不出你如何从服务器获取这些信息。

幸运的是，您在客户端上以 javascript 格式获取信息是完全正确的，因此这很可能解决了您的问题，并且可以解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T05:37:20.977

这取决于您的网络结构。只需防火墙或负载平衡器就可以更改您正在检查的变量。

如果您使用的是负载均衡器，请检查： [How to get visitor IP on load balance machine using asp.net](https://stackoverflow.com/questions/2514591/how-to-get-visitor-ip-on-load-balancing-machine-using-asp-net)

如果您的服务器位于防火墙后面，请检查： [查找请求是否从防火墙转发到 IIS](https://stackoverflow.com/questions/10224179/find-if-request-was-forwarded-from-firewall-to-iis)

# java - 通过Javascript使用AJAX调用一个spring控制器

> ID：14711236
> 
> 赞同：1
> 
> 时间：2013-02-05T15:39:55.510
> 
> 标签：java, javascript, ajax, spring, spring-mvc

我无法打开控制器的方法

```
var url = "UsersGroupReader";
if (window.XMLHttpRequest) {
    req = new XMLHttpRequest();
} else if (window.ActiveXObject) {
    req = new ActiveXObject("Microsoft.XMLHTTP");
}
req.onreadystatechange = processAccessGroupRequest;
req.open("GET", url, true); 
req.send(null); 
```

我的*控制器*是：

```
@RequestMapping(value = "UsersGroupReader", method = RequestMethod.GET)
public Vector<String> readUsersGroup(HttpServletRequest request,
        HttpSession httpSession) { 
```

`req.status`我收到的是`404`through `AJAX`。

我的*web.xml*中的模式如下：

```
<servlet-mapping>
    <servlet-name>login</servlet-name>
    <url-pattern>*.html</url-pattern>
</servlet-mapping> 
```

我尝试`UsersGroupReader.html`在`AJAX`函数和控制器中都使用，但仍然无法访问控制器。

谁能帮我找出错误？
可能是[this](https://stackoverflow.com/questions/4909580/how-do-i-call-a-spring-controller-method-with-jquery-ajax)的副本，即使遵循它也是徒劳的。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:08:58.963

您发送的请求可能没有被预期的服务器接收，或者没有为请求调用 DispatcherServlet。要解决这些类型的问题，您通常可以通过以下方式找到实际原因：

1.  使用浏览器的开发人员工具栏来确定请求中发送的确切 URL。
2.  打开 Spring 的日志以进行调试，以了解它在收到请求时正在做什么（*如果*它收到请求）。
3.  相应地调整 servlet 映射。

# intuit-partner-platform - 一次从 intuit Anywhere api 获取多张发票

> ID：14711241
> 
> 赞同：1
> 
> 时间：2013-02-05T15:40:15.837
> 
> 标签：intuit-partner-platform

当我在 QB 中更新发票时（在我的系统中更改后），我想避免更新用户在 QB 中修改的任何内容。我的计划是使用过滤器 API 方法并按 Ids 过滤以从我的应用程序创建的 QB 获取发票列表。但是，看起来 InvoiceFilter 不接受 ListIdSet。它确实有一个 TransactionIdSet，但我找不到通过数据服务获取该数字（即 TransactionId）的方法。阅读发票时，它肯定不在响应中。那么，如何通过 API 查询一组特定的发票呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T18:24:49.683

交易id在这里指的是发票的id。例如，以下发票查询将检索 ID 为 4 的发票 -

```
<InvoiceQuery xmlns="http://www.intuit.com/sb/cdm/v2">
<TransactionIdSet>
<Id idDomain="QB">4</Id>
</TransactionIdSet>
</InvoiceQuery> 
```

# java - 如何将网页上输入的数据保存或发送到 java 中的 Microsoft Project(.mpp) 文件中

> ID：14711243
> 
> 赞同：0
> 
> 时间：2013-02-05T15:40:18.620
> 
> 标签：java, jsp, web-applications, ms-project

我们的一个客户需要创建一个 Web 应用程序，其中包含映射到 Microsoft Project (.mpp) 文件列的元素。

一旦员工/资源输入有关他的任务的详细信息，如开始日期、完成日期、完成百分比等......，数据应保存到 Microsoft 项目 (.mpp) 文件中。

我只是想知道这是否可以使用 Java 来实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:42:29.497

看看[MPXJ 项目](http://mpxj.sourceforge.net/)。

> 该库提供了一组工具，允许在 Java 和 .Net 中操作项目信息。MPXJ 支持一系列数据格式：Microsoft Project Exchange (MPX)、Microsoft Project (MPP、MPT)、Microsoft Project Data Interchange (MSPDI XML)、Microsoft Project Database (MPD)、Planner (XML)、Primavera (PM XML、XER和数据库）、Asta Powerproject（PP、MDB）和标准数据交换格式（SDEF）。

# javascript - 在文本区域中按 Enter 时如何提交表单

> ID：14711245
> 
> 赞同：-1
> 
> 时间：2013-02-05T15:40:21.470
> 
> 标签：javascript, html

如何通过按而不是按按钮来获取提交`enter`的`<textarea>`表单`<input type="submit">`？

```
<HTML>
    <BODY>
        <FORM ACTION="MyInserts.php"  METHOD="GET">
            firstname:  <TEXTAREA NAME="firstbox"></TEXTAREA><BR>
            <INPUT TYPE="submit" Value="send">
        </FORM>
</HTML> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T16:14:08.810

如果您想`<form>`在用户按下 a 时提交`ENTER`a `<textarea>`，您应该为其分配一个`onKeyDown`事件处理程序，并在检测到它`ENTER`被按下时使用 javascript 手动提交表单：

```
<html>
    <head>
        <script>
        function pressed(e) {
            // Has the enter key been pressed?
            if ( (window.event ? event.keyCode : e.which) == 13) { 
                // If it has been so, manually submit the <form>
                document.forms[0].submit();
            }
        }
        </script>
    </head>
    <body>
        <form action="MyInserts.php">
        <textarea onkeydown="pressed(event)"></textarea>
        </form>
    </body>
</html> 
```

看到它在这个[JSFiddle](http://jsfiddle.net/uYSSL/)中工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-11-10T00:21:38.247

如果您像我一样在 2020 年阅读此问题并尝试将其与 typescript 一起使用，您可能知道 typescript 会告诉您这一点`e.keyCode`或被**贬低**！`e.which`

 **因此，您可以使用`e.key`它来为您提供正在按下的键的确切字符串，就像它会为您`Enter`提供按下回车按钮或它会为您`ctrl`提供按下控制 btn 一样，所以希望您明白这一点！

此外，如果您想编写一个函数将其转换为获取关键代码的旧方法，您可以使用以下内容：

```
switch (theChar) {
    case "Backspace":
      return 8;
    case "Tab":
      return 9;
    case "Enter":
      return 13;
    case "Alt":
      return 18;
    case "Escape":
      return 27;
    case "Delete":
      return 127;
    case "Minus":
      return 45;
    case "Plus":
      return 43;
    case "Equal":
      return 61;
    case "Delete":
      return 127;
    case "BracketRight":
      return 93;
    case "BracketLeft":
      return 91;
    case "Backslash":
      return 92;
    case "Slash":
      return 47;
    case "Semicolon":
      return 59;
    case "Colon":
      return 58;
    case "Comma":
      return 44;
    case "Period":
      return 46;
    case "Space":
      return 32;
    case "Quote":
      return 34;
    case "Backquote":
      return 39;

    //there are also "Numpad....." variants

    case "Unidentified":
      alert("handle the 'Unidentified' if you want to!");
  } 
```

这里还有许多其他可能的字符值[，](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/code/code_values) 但是，AFAIK，它们没有 unicode 代码点，例如：

```
switch (theKey) {
    case "AltLeft":
    case "CapsLock":
    case "ControlRight":
    case "Fn":
    case "NumpadDecimal":
    ... 
```

event.which 可能会为它们输出一些数字，但在浏览器/机器之间并不一致，它们可能与其他代码点重叠。**

# cordova - 为 Phonegap 条形码插件构建测试

> ID：14711254
> 
> 赞同：1
> 
> 时间：2013-02-05T15:40:48.840
> 
> 标签：cordova

我对 Phonegap 完全陌生，我一直在尝试为 iOS 安装 BarcodeSacanner 插件[https://github.com/phonegap/phonegap-plugins/tree/master/iPhone/BarcodeScanner](https://github.com/phonegap/phonegap-plugins/tree/master/iPhone/BarcodeScanner)它带有一个我没有的测试应用程序无法设置。

在 README.md 文件中，它解释了如何在运行测试之前构建测试。但是，有一个我无法理解的简单指令：

“`make build`在这个目录下运行。”

我确信这是一件非常容易做的事情，但我不知道该怎么做。如何运行“make build”？

我试过终端没有成功。任何帮助都非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-05T14:16:23.310

可能会帮助一些人来看这篇文章，我一直在使用 Plugman 来管理 Cordova/PhoneGap 插件，[https://github.com/apache/cordova-plugman](https://github.com/apache/cordova-plugman)

您可以使用类似于以下的命令安装 BarcodeScanner：

`cd /project/directory`

`plugman install --platform ios --project platforms/ios/ --plugin https://github.com/phonegap-build/BarcodeScanner.git`

# .net - VC++ 2010 编译错误：类包含显式覆盖但不是从包含函数声明的接口派生

> ID：14711255
> 
> 赞同：1
> 
> 时间：2013-02-05T15:40:57.050
> 
> 标签：.net, visual-c++, namespaces

我正在开发一个 C++ .NET 项目，并且我有一个来自供应商的 .lib 库，可以与他们的特定硬件对话。
我从头文件中收到一个编译错误“错误 C3254：'类包含显式覆盖'GetLastWin32Error'，但不是从包含函数声明的接口派生”，但该函数不存在，它只是称为 GetLastError。

我在函数上收到第二个编译错误，说它在成员声明中具有非法限定名称。

这在供应商的示例应用程序和我自己的命令行应用程序中编译得很好，所以我认为这与 .NET 有关，并且看起来像命名空间冲突。

有没有一种简单的方法可以通过命名空间更改来解决这个问题？

# sql - Oracle 生成插入语句

> ID：14711259
> 
> 赞同：1
> 
> 时间：2013-02-05T15:41:23.853
> 
> 标签：sql, oracle11g, oracle-sqldeveloper

我有大约 10 个表，我使用 select 和 join 语句从中选择。我让 select 语句正常工作，但想生成更多数据以确保它确实有效。

有没有一种简单的方法来生成虚拟数据而无需手动操作。也就是说，如果从表 a 中选择连接表 b `a.id = b.id`。如何在不手动执行的情况下生成满足此要求的数据？如果这没有意义，我可以更清楚地说明。谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:17:23.170

**对于相关表（您需要连接和参照完整性才能工作..），您必须一个接一个地编写一个 pl/sql 块或一组插入。**

PL/SQL : --见下文以了解如何生成多行...

```
Begin
  for v_rec in (select level from dual
                 connect by level <= 1000)
  loop
     create_new_dept (v_rec.level);
     create_1000_rows_for_dept(v_rec.level);
  end loop;
end;
/ 
```

或 SQL：

```
--create 1000 departments.
insert into dept(deptno, dname)
select level, 'deptno ' || level
from dual
connect by level <= 1000;
commit;

--create 1000 employees for each department..
with emp as
(select level empid
  from dual
  connect by level <=1000
 )
insert into emp(empno, deptno, dname)
select deptno,
       emp_seq.nextval,
       'dname ' || 'emp ' || level empname
  from dept,
       emp; --no join condition, cartesian join on purpose
commit; 
```

**当表格彼此不相关时，有两种常见的方法。**

使用 DBMS_RANDOM，通过查询连接并生成多行。例子...

```
--This will insert 1000 rows {(1, emp1), (2,emp2)} and so on..
insert into emp (empno, ename)
select level, 'employee ' || level
from emp
connect by level <=1000; 
```

使用 dba_objects 之类的表并执行多次插入以生成数据。如果您想测试“基于函数的索引的性能”之类的案例并且并不真正关心它是什么数据，只要有很多数据，这很有用。

```
create table my_test_table
as
select * from dba_objects; --or user_objects, all_objects

--keep doubling rows until you have enough rows.
insert into my_test_table
select * from my_test_table;
commit; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:58:57.657

使用 LEVEL 插入 10 行的简单示例 - 运行内部查询以查看结果：

```
INSERT INTO emp_test(empno)
(
 SELECT 1+LEVEL-1 FROM dual
  CONNECT BY LEVEL <= 10
)
/ 
```

# stream - 基于 CR 方法的 ClearCase 流配置

> ID：14711260
> 
> 赞同：1
> 
> 时间：2013-02-05T15:41:25.317
> 
> 标签：stream, clearcase

我无法创建最适合基于票证 (CR) 工作的项目的 ClearCase 流结构。例如，如果我有 7 个 CR 需要同时开发，那么最好的方法是什么？

假设我有三个流：DEV、TEST 和 PROD。我的 7 个 CR 通过交付操作从 DEV 转移到 TEST。在这 7 个 CR 中，只有 4 个已准备好用于 PROD。我如何才能将 7 个 CR 中的 4 个（现在归为一个交付）移动到 PROD？什么流结构可以做到这一点？

我已经阅读了许多（有时是相互矛盾的）建议，但我仍然没有找到可靠的方法。

问候，

安德鲁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:52:58.040

使用 UCM 仅交付某些活动而不交付其他活动是非常危险的，主要是因为您有将*所有*活动链接在一起的风险。

```
PROD
  TEST
    DEV 
```

如果您总是从`DEV`to `TEST`，`TEST`to`PROD`交付（然后您可以交付活动），那将起作用。
但是，您可能会被合法的基于活动*文件的*依赖项阻止：请参阅“[关于交付操作中的活动依赖](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearcase.hlp.doc/cc_main/about_activity_depend.htm)项”。

如果您在交付活动时遇到任何问题，那么您可以使用`findmerge`仅合并您想要的活动。

更多关于“所有活动都链接”和`findmerge`“ [ClearCase：使用旧基线活动制作新基线](https://stackoverflow.com/questions/684895/clearcase-making-new-baseline-with-old-baseline-activities/684928#684928)”的内容。

# c# - 获取下一页的 URL

> ID：14711262
> 
> 赞同：0
> 
> 时间：2013-02-05T15:41:30.873
> 
> 标签：c#, asp.net, url, http-redirect

在C#中离开当前页面时是否可以获得下一页的URL？

在我当前的页面上，我想在下一页加载之前捕获下一页的 url。我不知道从哪里开始......或者我会在页面上的哪个方法中放置这个逻辑（例如 page_load、buttonClick 等）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:56:06.630

我不认为可以“捕获下一页的url”，但可以尽快获取当前请求。因此使用[`Global.asax`](http://aspalliance.com/1114_Understanding_the_Globalasax_file.all)：

```
public class Global : System.Web.HttpApplication
{
    protected void Application_BeginRequest(object sender, EventArgs e)
    {
        HttpContext context = base.Context;
        HttpResponse response = context.Response;
        HttpRequest request = context.Request;
        var url = request.RawUrl;
        // and many other properties ...
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:50:14.240

假设您正在通过查询字符串进行分页并且您的当前页面是：

```
url.com/default.aspx?page=1 
```

然后获取下一页 URL 只会增加页面查询字符串，因此：

```
if (!String.IsNullOrempty(Request.QueryString["page"]) {
  int nextPageNumber = int.Parse(Request.QueryString["page"] + 1; 
  string nextPageUrl = String.Format("url.com/default.aspx?page={0}, nextPageNumber);
} 
```

理想情况下，您将使用[UriBuilder](http://msdn.microsoft.com/en-us/library/system.uribuilder.aspx)来重建域，而不是像我在 String.Format 方法中那样对其进行硬编码。我这样做只是为了简洁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T19:16:47.687

CodeProject 有一个项目用于[在关闭或退出页面上保存更改，](http://www.codeproject.com/Articles/20260/Save-Changes-on-Close-of-Browser-or-When-Exiting-t)这可能对您有所帮助。

# c++ - 从 DllMain() 锁定时，Visual Studio 2012 中的 C++11 std::mutex 死锁

> ID：14711263
> 
> 赞同：4
> 
> 时间：2013-02-05T15:41:34.297
> 
> 标签：c++, multithreading, visual-studio, dll, visual-studio-2012

`std::mutex`当互斥锁从下面锁定时，我看到死锁`DllMain()`是一个最小的 DLL 测试用例，它对我来说是一个问题。我的实际代码执行互斥锁，因为它使用在正常功能期间也可在初始化之外使用的成员函数。

我认为问题是在`main()`线程调用堆栈中看到的调度程序与调度程序产生的另一个线程（可能）之间存在死锁。死锁似乎发生在`main()`实际执行之前。

我将不胜感激有关如何修复/解决死锁的任何建议。

简单的DLL：

```
static void testFunc()
{
    std::mutex mtx;
    mtx.lock();

    mtx.unlock();
}

BOOL APIENTRY DllMain( HMODULE hModule,
                       DWORD  ul_reason_for_call,
                       LPVOID lpReserved
                     )
{
    switch (ul_reason_for_call)
    {
    case DLL_PROCESS_ATTACH:
        testFunc ();
        break;

    case DLL_THREAD_ATTACH:
        testFunc ();
        break;

    case DLL_THREAD_DETACH:
    case DLL_PROCESS_DETACH:
        break;
    }
    return TRUE;
} 
```

在死锁点，进程中有两个线程：

```
Not Flagged >   6408    0   Main Thread Main Thread msvcr110d.dll!Concurrency::details::SchedulerBase::SchedulerBase    Normal
Not Flagged     7600    0   Worker Thread   ntdll.dll!_TppWaiterpThread@4() ntdll.dll!_NtDelayExecution@8   Normal 
```

这是`main()`线程的调用堆栈：

```
 ntdll.dll!_NtWaitForKeyedEvent@16() Unknown
    ntdll.dll!_TppWaitpSet@16() Unknown
    ntdll.dll!_TppSetWaitInterrupt@12() Unknown
    ntdll.dll!_RtlRegisterWait@24() Unknown
    kernel32.dll!_RegisterWaitForSingleObject@24()  Unknown
>   msvcr110d.dll!Concurrency::details::SchedulerBase::SchedulerBase(const Concurrency::SchedulerPolicy & policy) Line 152  C++
    msvcr110d.dll!Concurrency::details::ThreadScheduler::ThreadScheduler(const Concurrency::SchedulerPolicy & policy) Line 26   C++
    msvcr110d.dll!Concurrency::details::ThreadScheduler::Create(const Concurrency::SchedulerPolicy & policy) Line 34    C++
    msvcr110d.dll!Concurrency::details::SchedulerBase::CreateWithoutInitializing(const Concurrency::SchedulerPolicy & policy) Line 276  C++
    msvcr110d.dll!Concurrency::details::SchedulerBase::GetDefaultScheduler() Line 650   C++
    msvcr110d.dll!Concurrency::details::SchedulerBase::CreateContextFromDefaultScheduler() Line 567 C++
    msvcr110d.dll!Concurrency::details::SchedulerBase::CurrentContext() Line 399    C++
    msvcr110d.dll!Concurrency::details::LockQueueNode::LockQueueNode(unsigned int timeout) Line 616 C++
    msvcr110d.dll!Concurrency::critical_section::lock() Line 1017   C++
    msvcp110d.dll!mtx_do_lock(_Mtx_internal_imp_t * * mtx, const xtime * target) Line 65    C++
    msvcp110d.dll!_Mtx_lock(_Mtx_internal_imp_t * * mtx) Line 144   C++
    ConsoleApplicationDll.dll!std::_Mtx_lockX(_Mtx_internal_imp_t * * _Mtx) Line 68 C++
    ConsoleApplicationDll.dll!std::_Mutex_base::lock() Line 43  C++
    ConsoleApplicationDll.dll!testFunc() Line 16    C++
    ConsoleApplicationDll.dll!DllMain(HINSTANCE__ * hModule, unsigned long ul_reason_for_call, void * lpReserved) Line 29   C++
    ConsoleApplicationDll.dll!__DllMainCRTStartup(void * hDllHandle, unsigned long dwReason, void * lpreserved) Line 508    C
    ConsoleApplicationDll.dll!_DllMainCRTStartup(void * hDllHandle, unsigned long dwReason, void * lpreserved) Line 472 C
    ntdll.dll!_LdrpCallInitRoutine@16() Unknown
    ntdll.dll!_LdrpRunInitializeRoutines@4()    Unknown
    ntdll.dll!_LdrpInitializeProcess@8()    Unknown
    ntdll.dll!__LdrpInitialize@8()  Unknown
    ntdll.dll!_LdrInitializeThunk@8()   Unknown 
```

第二个线程的调用堆栈很短：

```
>   ntdll.dll!_NtDelayExecution@8() Unknown
    ntdll.dll!__LdrpInitialize@8()  Unknown
    ntdll.dll!_LdrInitializeThunk@8()   Unknown 
```

**编辑1：**

WinDbg 确认这是加载程序锁定问题：

```
PRIMARY_PROBLEM_CLASS:  APPLICATION_HANG_HungIn_LoaderLock 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T10:32:05.070

检查[创建 DLL 的最佳实践](http://msdn.microsoft.com/en-us/windows/hardware/gg487379.aspx)文档：

> 永远不要在 DllMain 中执行以下任务：
> 
> *   调用 LoadLibrary 或 LoadLibraryEx（直接或间接）。这可能会导致死锁或崩溃。
> *   与其他线程同步。这可能会导致死锁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T10:39:57.577

似乎使用`QueueUserAPC()`队列初始化总是在 main() 之前执行，但在可怕的加载程序锁之外。这看起来像是我的问题的解决方案。

**编辑 1**

经过一些测试后，如果我将 APC 从队列中排队，似乎 APC 方法有效，`DllMain()`但如果我从类的静态全局实例的 ctor 排队 APC，则它不起作用。IOW，对我来说，使用 APC 并不能在所有可能的编译器和构建模式组合中统一使用。

# objective-c - 学习Cocos2D的要求？

> ID：14711268
> 
> 赞同：4
> 
> 时间：2013-02-05T15:42:19.067
> 
> 标签：objective-c, cocos2d-iphone

我想做一个 2D iPhone 游戏，我做了一些研究，Cocos2D 似乎是最好的选择，我只是想知道在处理 Cocos2D 之前我需要多少 Objective-C 知识。我了解 Objective-C 编程的基础知识——我可以制作一个基本的命令行工具应用程序。我已经完成了一些 iOS SDK 教程，但如果有人问我，我不知道如何制作 iOS 应用程序，因为我目前正在学习的教程大约有 3 年的历史。

在使用 Cocos2D 之前需要什么作为先验知识，有人知道任何好的资源吗？我更像是一个视觉学习者，所以我发现视频比书籍或博客文章更有帮助。

提前感谢您的时间和任何帮助:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:12:20.507

不需要事先学习。用它。如果您遇到问题，请查找、谷歌搜索或提出问题。

含义：不要在没有实际应用它们的情况下浪费时间学习一般概念。

类比：你不需要机械工程博士学位来驾驶汽车——尽管当你遇到任何问题时它可能会有所帮助。但在这种情况下，只需做 99% 的人都会做的事情：寻求帮助。首先了解汽车可能遇到的潜在问题几乎没有任何意义，当它们发生时你会处理它们。

另外：挫折是游戏的一部分，无法避免。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T15:48:39.560

> 我需要多少 Objective-C 知识

很多。在尝试制作这样一个更大的项目之前，您需要掌握 Objective-C。

而要理解 Objective-C，你需要对 C 有非常扎实的了解。

（另外，为了使用 Cocos2D 中的 3rd-party 框架，请确保您了解基本的默认库，例如 Foundation 和 UIKit。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:00:27.650

这个问题的答案真的取决于你是谁，你的职业道德，以及你愿意付出多少努力来同意这种努力。我认为，如果您对其他 OO 语言/框架有坚实的基础，那么您的追求是可能的。我将首先“重新利用”一个免费提供的游戏（您会从[Ray Wenderlich](http://www.raywenderlich.com)和[Steffen Itterheim](http://www.learn-cocos2d.com)找到许多很好的示例和教程。选择一个与您的游戏规范不太“遥远”的示例项目，然后重新调整它的用途。在做所以，你将闯入 Objective-C 和一些你需要理解的基本框架。如果你专注并坚持下去，就会掌握它。此外，SO 规则：这里有很多答案：适当的问题会产生很多有用的提示和解决问题的方法。

附言。我最大的学习曲线原来是 xCode，一个真正神秘且充满教条的 IDE。此后，我切换到另一个 IDE，我的工作效率又回到了可观的水平。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T15:46:42.120

对于像 Free flow 这样的游戏，具备 Objective-C 的中级知识就足够了。但是如果你打算制作像 Temple Run 这样的东西，那么你需要对 Objective-C、Open-Gl 和 cocos2d 有很好的了解。

我推荐的网站是 raywenderlich.com，我就是从那里开始的，他们提供从真正基础到真正高级的教程。

希望这可以帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T19:44:26.340

我最近同时学习了 Objective-C 和 cocos2d。一开始我做了很多关于objective-c的阅读，给我一个入门知识。除了语法，大部分知识在我的游戏中都没有用到。在开始学习 cocos2d 教程之前，学习 Objective-c 最重要的事情是内存管理和调试。

引用计数内存管理可能需要一分钟来适应，具体取决于您来自什么语言。一般规则是，如果你分配/复制（没有自动释放）或保留它，你必须在某个时候释放它，如果你需要使用超出当前范围的东西，你应该保留它。您可以从一些覆盖对象 dealloc 方法的 cocos2d 示例中看到，以便释放您创建/保留的任何内容。

调试也花了我一分钟时间来适应。如果您添加一个可用于记录未捕获异常的高级 try/catch 块，它会有所帮助，否则您的一些错误将给您提供很少的信息。您可能还想研究/弄乱您的一些项目设置，以便更好地捕捉错误，例如启用僵尸。Objective-c 崩溃的一个重要原因是向已经释放的对象发送消息。一旦遇到无法弄清楚的 badaccess 错误，您基本上将被迫深入研究这些东西以找出原因。

其他一些会派上用场的纯客观 c 知识非常熟悉 NSArray 和 NSDictionary 对象如何工作，它们如何自动保留/释放，以及它们如何只能保存对象（没有原始值）。要使用浮点数/整数和数组/字典，您需要将原语转换为类似 NSNumber 对象的东西，只需稍加研究即可轻松完成。另一个有用的方法是知道如何保存/加载 plist。在 NSArray 和 NSDictionary 对象上执行此操作有一些方便的方法。这与 NSFileManager 的一些知识一起应该足以帮助您保存/加载游戏状态。如果你想在你的编码中变得非常花哨/干净，你还将了解 Objective-c 中的观察者。KVO 非常适合在某些对象属性更改时自动更新 UI。例如，我的 HUD KVOs 玩家对象的生命，因此当生命值改变时，HUD 会自动更新。这可以让你制作一个更干净的 MVC 类型的应用程序。您还可以注册以收听其他类型的消息（不仅仅是属性更改），只需确保在完成收听后取消注册您的侦听器。

我的最后一点建议是始终注意 XCode 警告。如果你得到一个，你不知道为什么，你应该弄清楚为什么。您可能可以忽略一些简单的错误，其他可能会导致您无法以任何其他方式追踪的错误。例如，我曾经在我的代码中使用了函数 max()，xcode 给了我一个我不理解的奇怪警告。这通过破坏堆栈对我的程序造成了严重破坏。当我将 max() 更改为 MAX() 时，三四个无法解释的错误立即消失了。这种事情可能会让你倒退数周，如果你没有立即抓住它，就要认真梳理你的每一段代码。

其余的大部分可以通过查看 cocos2d 代码/示例来学习。祝你好运。

# wpf - WPF 绑定到 UserControl 自定义 DependencyProperty

> ID：14711274
> 
> 赞同：7
> 
> 时间：2013-02-05T15:42:35.427
> 
> 标签：wpf, binding, user-controls, dependency-properties

我有一个名为 SongDescription 的自定义 UserControl：

```
<UserControl x:Class="DPTestAp.SongDescription" ...>
    <Grid x:Name="LayoutRoot">
        <DockPanel Height="50">
            <TextBlock x:Name="title" Text="{Binding name}" Width="100" Height="30"/>
            <TextBox x:Name="lyrics"/>
        </DockPanel>
    </Grid>
</UserControl> 
```

我向其中添加了 DependencyProperty：

```
public partial class SongDescription : UserControl
{
    public static readonly DependencyProperty SongProperty = DependencyProperty.Register("Song", typeof(Song), typeof(SongDescription));

    public Song Song
    {
        get
        {
            return (Song)GetValue(SongProperty);
        }
        set
        {
            SetValue(SongProperty, value);
            updateLyrics()
        }
    }

    private void updateLyrics()
    {
        lyrics.Text = Song.lyrics;
    }

    public SongDescription()
    {
        InitializeComponent();
    }
} 
```

问题是：如何将一些东西绑定到这个 SongProperty？我在主窗口中使用 SongDescription，如下所示：

```
<local:SongDescription x:Name="songDescription" Song="{Binding DataContext}"/> 
```

我无法让我的 TextBox*歌词*显示歌词。在主窗口中，我尝试将 DataContext 设置为 songDescription，如下所示：

```
songDescription.DataContext = new Song() { name="Home", lyrics="Hold on, to me as we go" }; 
```

或像这样窗口本身：

```
DataContext = new Song() { name="Home", lyrics="Hold on, to me as we go" }; 
```

我什至尝试让 Song 成为资源并将其绑定到 SongProperty，如下所示：

```
<Window.Resources>
    <local:Song x:Key="res" name="Home" lyrics="Hold on, to me as we go"/>
</Window.Resources>
<Grid>
    <local:SongDescription x:Name="songDescription" Song="{StaticResource res}"/>
</Grid> 
```

没有任何帮助。TextBlock*标题*很好地绑定了歌曲名称。但我不能调用 updateLyrics() 方法。（在现实生活中这种方法比较复杂，所以我不能像 name 那样使用 Binding）。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T15:51:59.643

是的，所以这是依赖属性的一个陷阱。您*永远不会*将验证代码放在访问器方法 (get/set) 中，因为 WPF 将依赖项属性存储在它自己管理的表中。这就是为什么您必须注册依赖属性的原因，它本质上是在此表上创建条目以存储与每个属性关联的值，并且当您使用“GetValue”/“SetValue”时，您正在更新此表上的条目（顺便说一下与 WPF 如何能够管理数据绑定有关）。

这样做的结果是 WPF 可以（并且将）完全绕过您的属性访问器，因为它可以直接访问真实数据。如果它可以直接访问数据，为什么还要使用你的访问器。相反，您需要实现一个“PropertyChanged”回调函数或一些 WPF 认可的验证方法，但*永远不要在您的访问器中这样做*。

看：

[http://msdn.microsoft.com/en-us/library/ms752914.aspx](http://msdn.microsoft.com/en-us/library/ms752914.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T16:16:07.443

除了 sircodesalot 的回答之外，您还不受歌词文本框的约束。此外，由于您绑定的歌曲是一个类，因此您需要完全指定要在“Path=Song.Lyrics”等框中显示的属性的路径。

要考虑的另一件事是依赖属性；默认情况下，您的模式将是单向的，因此除非您更改它，否则使文本字段可编辑实际上是没有意义的。

第三，如果您使用 MVVM，您只需要将主窗口上下文设置为视图模型，并具有要绑定的匹配 Song 属性。

# r - 修改 R 包数据

> ID：14711277
> 
> 赞同：4
> 
> 时间：2013-02-05T15:42:48.707
> 
> 标签：r

bio.infer 包包含需要修改的数据框 /usr/lib/R/library/bio.infer/data/itis.ttable.rda。

在加载 bio.infer 包并使用 data() 函数附加数据框后，我使用 write.table() 将数据框写入文本文件。

使用 emacs，我在数据框中添加了另一行，然后应用 read.table() 来创建数据框，但它在我的密码中，而不是 bio.infer 包的 R 库数据子目录。

将文本文件或 itis.ttable 的本地副本复制/保存/写入到 /usr/lib/R/library/bio.infer/data/itis.ttable.rda 的 R 函数是什么？我查看了 R 文档和我的 R 书籍库，但没有看到如何将此行添加到库的数据框中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:22:54.087

`load`与`save`rda 文件一起使用。

```
#Path to the data file
fname <- system.file("data", "itis.ttable.rda", package = "bio.infer")
stopifnot(file.exists(fname))

#Load data into new environment
e <- new.env()
load(fname, envir = e)

#Manipulate it
e$itis.ttable <- rev(e$itis.ttable) #or whatever

#Write back to file
save(itis.ttable, file = fname, envir = e) 
```

尽管正如大卫罗宾逊所提到的，您可能不应该覆盖包中的副本。制作自己的副本可能更明智。

# php - 在同一个脚本中两次插入一个表？

> ID：14711282
> 
> 赞同：0
> 
> 时间：2013-02-05T15:42:56.737
> 
> 标签：php, mysql, pdo, insert

我以前问过这个问题，但从那以后我改变了我的代码。我在使用这个将表单数据插入表格的脚本时遇到了问题。第一个插入创建一个存储客户联系方式的预订。第二个插入获取在第一个中创建的预订参考，并为客户创建一个“工作”。最后的插入应该创建第二个“工作”，即客户的回程。

前两个插入运行良好，但它忽略了最后一个，即第二个 JOB 插入。

我已经检查了表结构，并且将数据传递给脚本一切正常，因此问题必须在脚本中（如下所示），非常感谢任何帮助。

使用一个脚本两次插入同一个表是否正确？

```
<?php

  $customer_title           =  $_POST['customer_title'];
  $customer_first_name      =  $_POST['customer_first_name'];
  $customer_last_name       =  $_POST['customer_last_name'];
  $billing_address          =  $_POST['billing_address'];
  $customer_tel             =  $_POST['customer_tel'];
  $customer_mobile          =  $_POST['customer_mobile'];
  $customer_email           =  $_POST['customer_email'];
  $passengers               =  $_POST['passengers'];
  $cases                    =  $_POST['cases'];
  $return_flight_number     =  $_POST['return_flight_number'];
  $price                    =  $_POST['price'];
  $pickup_date              =  $_POST['pickup_date'];
  $pickup_time              =  $_POST['pickup_time'];
  $pickup_address           =  $_POST['pickup_address'];
  $destination_address      =  $_POST['pickup_destination'];
  $return_date              =  $_POST['return_date'];
  $return_time              =  $_POST['return_time'];
  $return_pickup            =  $_POST['return_pickup'];
  $return_destination       =  $_POST['return_destination'];
  $booking_notes            =  $_POST['booking_notes'];

  $booking_status           =  "Confirmed";
  $authorised               =  "N";

  $booking_agent            =   "ROOT_TEST";
  $booking_date             =   date("Y/m/d");

if (isset($_POST['customer_title'])) {

  include('../assets/db_connection.php');

  $create_booking = $db->prepare("INSERT INTO bookings(customer_name, billing_address, contact_tel, contact_mob, contact_email, party_pax, party_cases, booking_notes, price, booking_agent, booking_date, booking_status, authorised)
                                      VALUES(:customer_name, :billing_address, :contact_tel, :contact_mob, :contact_email, :party_pax, :party_cases, :booking_notes, :price, :booking_agent, :booking_date, :booking_status, :authorised );");
  $create_booking->execute(array(
      ":customer_name"       =>   $customer_title  . ' ' .   $customer_first_name  . ' '  .   $customer_last_name,
      ":billing_address"     =>   $billing_address,
      ":contact_tel"         =>   $customer_tel,
      ":contact_mob"         =>   $customer_mobile,
      ":contact_email"       =>   $customer_email,
      ":party_pax"           =>   $passengers,
      ":party_cases"         =>   $cases,
      ":booking_notes"       =>   $booking_notes,
      ":price"               =>   $price,
      ":booking_agent"       =>   $booking_agent,
      ":booking_date"        =>   $booking_date,
      ":booking_status"      =>   $booking_status,
      ":authorised"          =>   $authorised    
    ));

  $booking_ref = $db->lastInsertId('booking_ref'); // Takes Booking Ref generated in $create_booking

  $scheduled   = "N";

  $create_job =  $db->prepare("INSERT INTO jobs(booking_ref, pickup_date, pickup_time, pickup_address, destination_address, scheduled) 
                              VALUES(:booking_ref, :pickup_date, :pickup_time, :pickup_address, :destination_address, :scheduled)");

  $create_job->execute(array(
      ":booking_ref"          =>  $booking_ref,
      ":pickup_date"          =>  $pickup_date,
      ":pickup_time"          =>  $pickup_time,
      ":pickup_address"       =>  $pickup_address,
      ":destination_address"  =>  $destination_address,
      ":scheduled"            =>  $scheduled  
  ));

  $return = "Y";

  $create_return  = $db->prepare("INSERT INTO jobs(booking_ref, pickup_date, pickup_time, pickup_address, destination_address, scheduled, return)
                                  VALUES(:booking_ref, :pickup_date, :pickup_time, :pickup_address, :destination_address, :scheduled, :return)");

  $create_return->execute(array(
      ":booking_ref"          =>  $booking_ref,
      ":pickup_date"          =>  $return_date,
      ":pickup_time"          =>  $return_time,
      ":pickup_address"       =>  $return_pickup,
      ":destination_address"  =>  $return_destination,
      ":scheduled"            =>  $scheduled,
      ":return"               =>  $return
  ));

}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:52:13.703

这肯定是不正确的，因为两次插入相同的数据违反了最重要的数据库架构法则之一——[数据库规范化](http://en.wikipedia.org/wiki/Database_normalization)原则

但是，它没有技术问题。您必须使用**来自 mysql 的错误消息**来捕获一些错误。要拥有它，请在连接到 PDO 后添加此行。

```
$db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
```

请注意，捕获实际错误是调试 SQL 查询的唯一方法。仅仅看代码没有任何意义也没有帮助。

return 必须是 mysql 关键字。把它写成

```
`return` 
```

顺便说一句，我无法忍受如此巨大的代码。

如果我是你，我会用 10 行而不是 50 行：

```
$allowed = array('customer_name', 'billing_address', 'contact_tel', 'contact_mob',
                 'contact_email', 'party_pax', 'party_cases', 'booking_notes', 'price'); 
$insert = $db->filterArray($_POST,$allowed);

$insert['booking_status'] =  "Confirmed";
$insert['authorised']     =  "N";
$insert['booking_agent']  =   "ROOT_TEST";
$insert['booking_date']   =   date("Y-m-d");

$db->query("INSERT INTO bookings SET ?u", $insert); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:47:47.607

看起来`booking_ref`是表中的主键`jobs`，您尝试两次插入相同的键，这就是最终查询失败的原因。

您应该有一个单独的字段，它是主键，`jobs`它只是一个自动递增的数字，然后在`booking_ref`.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-05T15:48:05.603

没有法律禁止它。您需要做的是检查最后一个 INSERT 查询的返回值。我最好的猜测是`jobs`表上有一个唯一索引，您违反了双插入。

如果您在这里使用 mySQLi 或 PDO 并不明显，但是两者的执行函数都会`false`在失败时返回，因此您应该抓住它，然后调用相应对象的错误函数来找出问题所在。

# java - JTree子树中的多选

> ID：14711288
> 
> 赞同：1
> 
> 时间：2013-02-05T15:43:08.313
> 
> 标签：java, swing, jtree, multi-select

我有一棵有几个子树（类别）的树，我如何只在指定的子树中允许多选操作，例如：我可以多选类别中的节点，但如果我尝试选择其他类别中的节点，它将取消选择当前子树中的节点并选择一个新节点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T15:59:21.250

`JTree`通过使用更改默认选择模型[`setSelectionModel`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTree.html#setSelectionModel%28javax.swing.tree.TreeSelectionModel%29)

提供你自己的实现[`TreeSelectionModel`](http://docs.oracle.com/javase/7/docs/api/javax/swing/tree/TreeSelectionModel.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T16:41:23.490

无需实现 TreeSelectionModel，使用默认模型实现 TreeSelectionListener 就足够了。这是一个半工作示例，需要更多调整才能完美工作，但它说明了原理：

```
 JFrame f = new JFrame("JTree test");
    f.setSize(300, 300);
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    JTree t = new JTree();
    DefaultTreeModel model = (DefaultTreeModel) t.getModel();
    final TreeSelectionModel selectionModel = t.getSelectionModel();

    selectionModel.setSelectionMode(TreeSelectionModel.CONTIGUOUS_TREE_SELECTION);
    selectionModel.addTreeSelectionListener(new TreeSelectionListener() {
        @Override
        public void valueChanged(TreeSelectionEvent e) {
            // detect additive selections
            if (e.isAddedPath()) {
                TreePath selection = e.getPath();
                DefaultMutableTreeNode selectedNode = (DefaultMutableTreeNode) selection
                        .getLastPathComponent();

                // a contrived way to detect selection of items within a category
                if (((String) selectedNode.getUserObject())
                        .startsWith("Item")) {
                    // get the new selection's category node
                    DefaultMutableTreeNode category = (DefaultMutableTreeNode) selection
                            .getParentPath().getLastPathComponent();

                    // deselect everything outside that category
                    ArrayList<TreePath> deselectList = new ArrayList<TreePath>();
                    for (TreePath path : selectionModel.getSelectionPaths()) {
                        if (!category.equals(path.getParentPath()
                                .getLastPathComponent())) {
                            deselectList.add(path);
                        }
                    }
                    selectionModel.removeSelectionPaths(deselectList
                            .toArray(new TreePath[deselectList.size()]));
                } else {
                    // completely prevent selection of categories
                    selectionModel.removeSelectionPath(selection);
                }
            }
        }
    });

    DefaultMutableTreeNode root = new DefaultMutableTreeNode();
    DefaultMutableTreeNode category1 = new DefaultMutableTreeNode("Category 1");
    DefaultMutableTreeNode category2 = new DefaultMutableTreeNode("Category 2");
    DefaultMutableTreeNode item1 = new DefaultMutableTreeNode("Item 1");
    DefaultMutableTreeNode item2 = new DefaultMutableTreeNode("Item 2");
    DefaultMutableTreeNode item3 = new DefaultMutableTreeNode("Item 3");
    DefaultMutableTreeNode item4 = new DefaultMutableTreeNode("Item 4");

    category1.add(item1);
    category1.add(item2);
    category2.add(item3);
    category2.add(item4);

    root.add(category1);
    root.add(category2);

    t.setRootVisible(false);
    model.setRoot(root);

    f.getContentPane().add(new JScrollPane(t));
    f.setVisible(true); 
```

# ajax - Joomla - OnMouseover 使用 Qtip 脚本在工具提示中显示来自控制器的数据

> ID：14711289
> 
> 赞同：0
> 
> 时间：2013-02-05T15:43:18.610
> 
> 标签：ajax, joomla, tooltip, qtip

我需要帮助才能在 MouseOVer 事件的工具提示（使用 qTip 脚本）中显示数据（来自控制器）。

1.  用户鼠标悬停在链接上（多个链接，如 foreach）
2.  id 发送到 js 函数，如 function getData(id){}
3.  从控制器调用 PHP 函数并使用变量将数据返回到工具提示。
4.  在工具提示中显示返回数据。

**HTML 和 PHP：**

```
foreach ($rows as $row) {
    <a href="#" onmouseover="getData(<?php echo $row->id; ?>)" >Name</a>
} 
```

**JS函数：**

```
function getData(id)
{
    var url='index.php?option=com_test&controller=test&task=getDetails&format=raw';
    var data = 'item_id=' + id ;
    var request = new Request({
    url: url,
    method:'post',
    data: data,
    async: true,
    onSuccess: function(responseText)
{ 
    // How i show the "responseText" data here in tooltip using qTip
}
}).send();      
} 
```

**控制器功能：**

```
function getDetails()
{
   echo $return = JRequest::getVar('item_id');   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T08:42:01.030

在内容项视图覆盖中预加载提示会不会更容易（将其添加到 title= 属性），并添加对 qTip 的调用（每页一个）可以解决问题。

此外，ajax 会使工具提示不是很快。

只需确保您正确转义标题属性中的 " 或 ' 字符，否则您将破坏您的标记。

编辑：添加代码。我在这里写这个，所以可能有错别字，但它应该给你的想法：

```
foreach ($rows as $row) {
    // let's assume $tip contains the right tip for each row:
    <a href="#" title="<?php echo $tip; ?>" class="tipme">Name</a>
} 
```

第一部分将显示默认浏览器工具提示。

现在你必须注入 qTip 脚本：

```
$document = JFactory::getDocument();
$document->addScriptDeclaration('
    jQuery("a.tipme").qTip();
'); 
```

现在如何将值放入 $tip 中？我看到你有一个 com_test 组件，你不需要通过控制器，但可以直接实例化将提供工具提示的模型；如果它被称为“提示”：

```
$tipmodel=JModel::getInstance('tip', 'ComtestModel'); // get the model (once!)

$tip = $tipmodel->getTip($row->id); 
```

这个故事中的所有变量、模型、控制器名称都是虚构的。

# javascript - 将ajax请求中的内容加载到DOJO中的dom节点

> ID：14711290
> 
> 赞同：1
> 
> 时间：2013-02-05T15:43:25.127
> 
> 标签：javascript, jquery, ajax, dojo, xmlhttprequest

我想知道 DOJO 中是否有一种快速的方法可以将 http 请求的输出加载到 jQuery 中的某个 DOM 节点中

```
$('#injectMe').load('/someResource', {
    id: 223,
    xxx: "2323"
}); 
```

ps 我知道 dojo.xhr* 方法 :) 也许有更简单的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T15:51:23.913

您可以使用`ContentPane`带有 url 的 a 来指定内容。

```
<div id="foo" data-dojo-type="dijit/layout/ContentPane" href="/some/page.html">
</div> 
```

[http://dojotoolkit.org/reference-guide/1.8/dijit/layout/ContentPane.html](http://dojotoolkit.org/reference-guide/1.8/dijit/layout/ContentPane.html)

# ms-access - 组合框的访问选择查询并不总是评估复选框值

> ID：14711293
> 
> 赞同：0
> 
> 时间：2013-02-05T15:43:46.170
> 
> 标签：ms-access, vba

我有一个带有组合框和复选框（chkClosed）的表单。对于组合框，我将行源作为选择查询。它有两个字段（均来自表 1）：字段 1、字段 2 *（未显示）* & 它的标准是`[Forms]!Form1]![chkClosed]`

表1示例数据：

```
Field1    Field2
Test      -1
Test1      0
Test2      0
Test3     -1 
```

问题是当我在运行时取消选中 chkClosed 时，下拉列表不会改变。我知道它正确地评估它，就好像我切换到设计然后回到表单视图，同时它检查它在下拉列表中显示 Test & Test3，反之亦然。只是它评估它是在启动时而不是持续时，我相信我将不得不随着事件改变一些东西。这只是一个例子，我正在做的数据实际上来自 SQL 源，但逻辑仍然适用我只是使用标准：`IIf([Forms]![Form1]![chkClosed]=-1,1,0)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:49:09.473

您需要重新查询组合框以更新行源。在复选框的 AfterUpdate 事件中，添加以下行：

```
Private Sub chkClosed_AfterUpdate()
    Me.Combo1.Requery
End Sub 
```

# c++ - 为什么同一个对象要调用两次析构函数？

> ID：14711295
> 
> 赞同：7
> 
> 时间：2013-02-05T15:43:50.070
> 
> 标签：c++, gdb

在来自核心转储 A2 的以下回溯中：~A2 被调用两次：

```
#0  0x086f5371 in B1::~B1 (this=0xe6d3a030, 
    __in_chrg=<value optimized out>)
    at /fullpath/b1.cpp:400
#1  0x086ffd43 in ~B2 (this=0xe6d3a030, 
    __in_chrg=<value optimized out>)
    at /fullpath/b2.h:21
#2  B2::~B2 (this=0xe6d3a030, 
    __in_chrg=<value optimized out>)
    at /fullpath/b2.h:21
#3  0x086ea516 in A1::~A1 (this=0xe3e93958, 
    __in_chrg=<value optimized out>)
    at /fullpath/a1.cpp:716
#4  0x0889b85d in A2::~A2 (this=0xe3e93958, 
    __in_chrg=<value optimized out>)
    at /fullpath/a2.cpp:216
#5  0x0889b893 in A2::~A2 (this=0xe3e93958, 
    __in_chrg=<value optimized out>)
    at /fullpath/a2.cpp:216
#6  0x0862c0f1 in E::Identify (this=0xe8083e20, t=PT_UNKNOWN)
    at /fullpath/e.cpp:713 
```

A2 是从 A1 派生的，B2 是从 B1 派生的。只有 B2 有默认析构函数，所有基类析构函数都是虚拟的。

代码看起来像这样：

e.cpp：

```
E::E(){
    //... some code ...
    myA1= new A2();
}

void E::Identify(){
    //...
    if(myA1){
        delete myA1; //line 713 of e.cpp
        myA1 = NULL;
    }

} 
```

a2.cpp：

```
A2::~A2(){
    //...
    if (sd) //sd is not null here and also not made null after deletion
    {
        delete [] sd; //when called the second time shouldn't it crash here?
    }
    //...
} // line 216 of a2.cpp 
```

a1.cpp

```
A1::A1(){
//...
   myB1 = new B2();
//...
}

A1::~A1(){
//...
    delete myB1; //line 716 of a1.cpp
//...
} 
```

我不明白为什么 A2::~A2 会为同一个对象调用两次（回溯中的 this 指针对于 4 帧和 5 帧具有相同的值）。

如果我转到第 4 帧并反汇编，它会打印出与第 5 帧反汇编代码非常不同的结果（大约 90 行汇编代码与大约 20 行汇编代码）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-06T09:58:48.263

我将示例最小化为

```
#include <cassert>
class A1 {
public:
    virtual ~A1() {
        assert(false);
    }
};

class A2 : public A1 {
};

int main() {
    A1* a = new A2;
    delete a;
    return 0;
} 
```

使用断言触发核心转储。

使用g++ 4.7.2编译，我们得到gdb中的双重析构函数回溯

```
#0  0x00007f16060e92c5 in raise () from /usr/lib/libc.so.6
#1  0x00007f16060ea748 in abort () from /usr/lib/libc.so.6
#2  0x00007f16060e2312 in __assert_fail_base () from /usr/lib/libc.so.6
#3  0x00007f16060e23c2 in __assert_fail () from /usr/lib/libc.so.6
#4  0x00000000004007c8 in A1::~A1 (this=0xf60010, __in_chrg=<optimized out>) at double.cpp:6
#5  0x000000000040084d in A2::~A2 (this=0xf60010, __in_chrg=<optimized out>) at double.cpp:10
#6  0x0000000000400880 in A2::~A2 (this=0xf60010, __in_chrg=<optimized out>) at double.cpp:10
#7  0x000000000040078c in main () at double.cpp:15 
```

而使用 g++ 4.3.2 编译的相同代码的回溯看起来相似，但 A2::~A2 只有一帧。

使用相同版本的 gdb (7.5.1) 提取的两个回溯。

因此它是 g++ 4.7 生成的代码的产物，无需担心编译后的二进制文件的行为。这不是对析构函数的真正双重调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T15:52:51.940

这可能是您的情况（但您没有向我们展示这部分代码）...

如果类**E**拥有指向 A2 的私有成员指针，并且它没有复制构造函数或 operator= ...。

然后，可能会出现这样一种情况，即使用默认的复制构造函数或运算符 = 将类型 E 的对象复制到类型 E 的另一个对象（变量）。

这将导致成员的浅拷贝，这将导致两个对象现在都指向**同一个**对象 A1。

当对象 E 被销毁时，它们都试图删除**同一个 A2**对象。

# asp.net - ASP.net 用户代理检测加载站点的移动应用程序

> ID：14711297
> 
> 赞同：3
> 
> 时间：2013-02-05T15:43:56.610
> 
> 标签：asp.net, regex, mobile, mobile-website, user-agent

我们已成功使用以下 asp.net 正则表达式对访问我们网站的移动浏览器进行服务器端检测（取自[http://detectmobilebrowsers.com/](http://detectmobilebrowsers.com/)

```
Public Shared Function IsMobileBrowser(httpUserAgentString As String) As Boolean

    ' set up user agent sniffing (http://detectmobilebrowsers.com/)

    Dim b As New Regex("(android|ipad|playbook|silk|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino", RegexOptions.IgnoreCase)
    Dim v As New Regex("1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-", RegexOptions.IgnoreCase)

    If (b.IsMatch(httpUserAgentString) Or v.IsMatch(Left(httpUserAgentString, 4))) Then
        Return True
    Else
        Return False
    End If

End Function 
```

但是，当用户从 QR 阅读应用程序 (Qrafter) 打开网站时，我们收到了有关此失败的报告。这似乎是因为应用程序（至少在 iOS 上的 Qrafter 的情况下）通过在应用程序内部加载代码页面来“测试”网站。执行此操作时传递的用户代理字符串与移动浏览器测试不匹配，因此我们设置了一个会话变量，将站点模式存储为桌面/非移动，然后当站点完全加载时通过应用程序发生，它以桌面模式而不是移动模式启动。

应用程序呈现给我们的 ASP.net 代码的用户代理字符串是：

```
Qrafter/6.3+CFNetwork/609+Darwin/13.0.0 200 0 0 178 
```

因此，我们使用以下正则表达式方法解决了这个问题，以检测和忽略网站的这些“应用内”负载

```
Public Shared Function IsAppSniffer(httpUserAgentString As String) As Boolean

    Dim b As New Regex("\bCFNetwork\b.+\bDarwin\b", RegexOptions.IgnoreCase)

    If (b.Matches(httpUserAgentString).Count > 0) Then
        Return True
    Else
        Return False
    End If

End Function 
```

基本上，我想知道这是否是进行此测试的可靠方法，以及我们必须寻找什么来检测 Android / Windows / 其他运行 QRafter 等价物的手机上的类似问题？他们基于应用程序的用户代理字符串是什么？或者，由于其“URL 测试”功能，这可能是 iOS 上的 QRafter 应用程序特有的问题吗？

随意（如果可能的话，建设性地！）批评我们将移动/桌面站点模式存储在会话对象中的方法，但是我们在这个项目上重新设计它可能有点晚了。

为这个问题的冗长道歉，希望它仍然只是一个问答环节，非常感谢任何有用的信息。

* * *

**编辑：**正如斯蒂芬在下面指出的那样，简而言之，我的问题本质上是，“有没有一种实用的方法来检测直接从移动设备（任何风格）发送的用户代理字符串以及来自他们的移动浏览器的用户代理字符串？”

例如（对于 iOS / Safari 配对）直接来自应用程序

```
AppName/CFNetwork/609+Darwin/13.0.0 200 0 0 178 
```

Safari 用户代理字符串

```
Mozilla/5.0+(iPhone;+CPU+iPhone+OS+6_0_1+like+Mac+OS+X)+AppleWebKit/536.26+(KHTML,+like+Gecko)+Mobile/10A523 200 0 0 20 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T15:59:46.973

基本上，您的问题总结为：您通常可以检测到浏览器，但有时，您没有得到预期的用户代理字符串，并且您将桌面版本发送到移动设备。

您解决此问题的问题在于，每次出现这种情况时，您都需要修改检测正则表达式并使用新程序。虽然这可以在循环和数据库中的表中完成，但仍然需要大量维护和麻烦。不过，老实说，其他解决方案也是如此。必须有人维护“移动”浏览器的列表。那可以是您自己，也可以是您付费的服务。

我要做的是让桌面端对浏览器及其版本进行 JavaScript 检测（[如何检测浏览器的版本？](https://stackoverflow.com/questions/5916900/detect-version-of-browser)）。如果它检测到它恰好在移动设备上显示自己，则提供一个链接以将用户带到相关的移动页面。

当且仅当用户代理不在检测移动浏览器站点提供的列表中时，您可以更进一步，甚至将此逻辑添加到页面中。当然，这可能有点矫枉过正。

Sadly, at some point, you'll just have to say "We gave it our best shot at getting someone to the proper view of the site" and be happy with how its working. There's only so much automated detection that can be performed in this manner, and program designers will happily try ways to break said logic, just because they can.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T15:57:14.260

您可以尝试使用[51degrees.mobi 之](http://51degrees.mobi/)类的东西进行浏览器检测，而不是滚动您自己的解决方案。具有各种怪癖的组合如此之多，很难推出自己的综合解决方案。

# winforms - Windows 窗体 - dataGridView 列的行为异常

> ID：14711300
> 
> 赞同：0
> 
> 时间：2013-02-05T15:44:07.467
> 
> 标签：winforms, visual-studio-2010, datagridview

我有`dataGridView`几列，我按照它们必须出现的顺序排列。但是在设计视图中的 Visual Studio 2010 中，我得到了这个：

![在此处输入图像描述](../Images/7dcfcd89d2e99610ed1f13e273846c35.png)

但是当我启动项目时，我在调试模式下看到：

![在此处输入图像描述](../Images/fcca536883c28fb2e5e2182c644bb3a2.png)

如您所见，该`Delete`列已移动。我不知道为什么。我尝试了不同的场景，比如自己编辑网格并将`Delete`列移动到其他地方，但没有任何效果。如果这对这一列的行为有影响，我会使用一个虚拟类来获取这个空数据行。

附言

我试图清理解决方案并重建，但这也无济于事。

# javascript - 如何从此 javascript 代码中排除容器？

> ID：14711303
> 
> 赞同：-1
> 
> 时间：2013-02-05T15:44:17.077
> 
> 标签：javascript, html, css

这个问题与我在这个网站上问的最后一个问题有关 -[使用 javascript 从 html 背景图像“链接”？](https://stackoverflow.com/questions/14697735/using-javascript-to-link-from-html-background-image).

我收到了一个很好的答案，但是背景图像的链接也适用于容器。我将如何确保仅单击（id 主体的）背景图像而不是容器链接到任何网站？

我希望我已经足够清楚了。提前谢谢了。

的HTML：

```
<html>

<head>
<link href = "style1.css" rel = "stylesheet" type = "text/css">
</head>

<div id = "header">
Header
</div>

<body>

<div id = "body">

<div class = "container">

</div>
</div>

</body>

</html>

<script>
document.getElementById('body').onclick = function() {
window.location = 'http://www.google.com/';
}
</script> 
```

CSS 代码：

```
#header{
width:100%;
height:50px;
background-color:black;
}

#body {
width:100%;
height:2000px;
background-image:url('uploads/1.jpg');
cursor:pointer;
}

.container{
 width: 1000px;
margin-right: auto;
margin-left: auto;
height: 1000px;
background-color:white;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:57:36.223

在您的点击处理程序中，您可以检查被点击的元素，如果不是`body`（意味着它是一个孩子），那么不要做任何事情。

```
document.getElementById('body').onclick = function(e) {
    // e.target is what you clicked on
    // this is always what the event was bound to
    if(e.target === this){
        window.location = 'http://www.google.com/';
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:54:01.677

尝试在您的脚本中添加此代码：

```
document.querySelector('#body .container').onclick = function() {return false; } 
```

具有：

```
<script>
document.getElementById('body').onclick = function() {
window.location = 'http://www.google.com/';
}
document.querySelector('#body .container').onclick = function() {return false; }
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:08:19.043

你也可以做一个 return false

```
document.getElementById('body').onclick = function(e)
{
    if(!(e.target===this))
        return false;
    console.log("click");
    //window.location = 'http://www.google.com/';
} 
```

# slickgrid - 光滑的网格单元着色

> ID：14711305
> 
> 赞同：0
> 
> 时间：2013-02-05T15:44:25.327
> 
> 标签：slickgrid

我需要根据渲染到网格的数据设置光滑网格中单元格的背景颜色。查看堆栈溢出中的其他帖子，我发现我们可以使用自定义格式化程序通过返回一个 div 来做同样的事情。我想在不返回另一个 div 的情况下完成此操作。我确实尝试使用 rowCssClass 和列 cssClass 属性，但没有运气。有人可以帮我吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-08T18:31:59.273

您可以`grid.setCellCssStyles`按如下方式使用，

```
var row = // row Number
var rowObject = { };
rowObject[row] = { property1: "cssClass", property2: "cssClass" };
grid.setCellCssStyles(row, rowObject); 
```

# python - How do I run IOMeter using Python?

> ID：14711315
> 
> 赞同：2
> 
> 时间：2013-02-05T15:44:46.683
> 
> 标签：python

I am trying to setup test automation. I would like to run several different sets of IOMeter tests without individually hitting go for all of them. How do I do that using Python? If you know a different method, that would work too. I just have the rest of the test automation setup with Python.

Side note: can IOMeter record data every 5 seconds for a 30min test?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-09T16:43:58.643

您可以在 IOmeter PC 上创建以下批处理文件，然后从远程 PC 运行它：

iometer.bat

```
@echo off
SET sessionid=%1

cd <path-to-iometer>\iometer
psexec \\localhost -i %sessionid% -accepteula -u <domain>\<user> -p <password> cmd /c "<path-to-iometer>\IOmeter.exe" <path-to-iometer>iometer.icf <path-to-iometer>results.csv

@echo on 
```

注意 (1)：您需要在 IOmeter PC 上安装最新的[psexec版本](http://download.sysinternals.com/files/PSTools.zip)

注意（2）：要获取 windows 桌面的会话 ID，您需要运行

```
query session 
```

在 CMD 中

如果我没记错的话，每 5 秒记录一次是在最后 1.1.0 中实现的

# windows - 需要根据文件名和日期清理日志文件

> ID：14711320
> 
> 赞同：0
> 
> 时间：2013-02-05T15:44:58.187
> 
> 标签：windows, loops, batch-file

我有一个包含混合日志文件的文件夹 - 例如：

AAA.0.1.txt
AAA.0.2.txt
BBB.1.2.txt
BBB.1.3.txt
BBB.1.4.txt
CCC.0.5.txt
CCC.0.6.txt

我需要一个快速的小批处理文件来清除 A、B 和 C 中除最近（按日期）3 个文件之外的所有文件。

我可以删除文件夹中除他最近的 3 个文件之外的所有文件：

```
for /f "tokens=* skip=3" %%F in ('dir %myDir% /o-d /tc /b') do del %myDir%\%%F 
```

但我不确定如何在不硬编码 A、B 和 C 并执行 3 个单独循环的情况下添加命名约定（如果 D 出现，则它会被完全忽略）。

~~有任何想法吗？~~

好的，我想通了：

```
@echo off
setlocal enabledelayedexpansion
cls
set fileDir=C:\My\Log\Path
set prev=A
for /f "tokens=*" %%P in ('dir %fileDir% /o-d /tc /b') do (
    set fileName=%%P
    for /f "tokens=1,2,3,4 delims=. " %%a in ("!fileName!") do set proj=%%a

    if "!proj!" == "!prev!" (
        REM skip
    ) else (
        for /f "tokens=* skip=3" %%F in ('dir %fileDir%\!proj!.* /o-d /tc /b') do del %fileDir%\%%F
        set prev=!proj!
    )
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T17:33:06.063

I believe you want the last modified date, so I changed the option to `/T2`. Change back to `/TC` if you truly want creation date.

```
for /f "delims=." %%A in ('dir /a-d /b "%myDir%\*.*.txt"') do (
  for /f "skip=3 delims=" %%F in (
    'dir /a-d /o-d /tw /b "%myDir%\%%A.*.txt'
  ) do del "%myDir%\%%F"
) 
```

The above is perhaps a bit inefficient since it will attempt to delete old files once for each file. You really only need to delete old files once per unique name prefix - that could be implemented, but I didn't think the added complexity was worth it. The above works just fine.

# javascript - Jquery 回调参数

> ID：14711321
> 
> 赞同：0
> 
> 时间：2013-02-05T15:45:07.823
> 
> 标签：javascript, jquery, extjs

不知道我在这里做错了什么，但让我设置场景。

一开始，store(resultsStore) 被数据填充并通过函数调用显示。

现在，需要通过另一个存储获取更多数据并将这两个集合传递给原始函数的中间步骤。

我已经尝试了下面的许多变体，但是这两个数据集似乎没有传递给 updateLeftPanel 函数，第一个很好，第二个说“未定义”。有什么明显的我失踪了吗？

```
resultsStore.load({
    params: {
        'certid' : certId
    },
    callback: function(record,operation,success){
        updateRightPanel(record[0].data);  // code not shown,works fine
        //updateLeftPanel(record[0].data);   // original call

        loadCriteriaStore(record[0].data);  // new call

    }
});

function loadCriteriaStore(data)
{
    criteriaStore.load({
        params: {
            'edition' : data['Edition']
        },
        callback: function(record,operation,success,data){
            updateLeftPanel(data,record[0].data);  
            // orig data first, new dataset second
        }

    });

}

 function updateLeftPanel(data, dataa){ 
 // code here
          dataa object still unpopulated
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:06:52.257

在`loadCriteriaStore`函数的回调中，您分配了 4 个参数。我假设它只通过3。

因此，在该回调中`data`，包含您的数据的 被新的“本地”覆盖`data`，即`undefined`.

```
function loadCriteriaStore(data)
{
    criteriaStore.load({
        params: {
            'edition' : data['Edition']
        },
        // Get rid of the ",data" here
        callback: function(record,operation,success){
            // the `data` param will be the value passed to `loadCriteriaStore`
            updateLeftPanel(data,record[0].data);
            // orig data first, new dataset second
        }

    });

} 
```

# algorithm - 贪心算法的改进

> ID：14711328
> 
> 赞同：5
> 
> 时间：2013-02-05T15:45:53.223
> 
> 标签：algorithm, haskell, optimization, recursion, greedy

我一直在使用 Haskell 研究一个抽象的国际象棋算法（试图扩大我对不同范式的理解），并且我遇到了一个我已经思考了几个星期的挑战。

这是问题所在：

> 给定一个尺寸为 nxn 的棋盘（由整数列表表示；每个整数代表一个后续的点值），确定提供最多点的路径。如果最佳路径存在平局，则返回其中任何一个。

以下是具体情况：

```
A = [[5,4,3,1],[10,2,1,0],[0,1,2,0],[2,3,4,20]] 
```

呈现为：

```
R1: 5  4  3  1, R2: 10 2 1 0, R3: 0 1 2 0, R4: 2 3 4 20. 
```

规则是：

1.  您可以从第一行的任何位置开始

2.  您可以一次移动一个方格，可以是直线向下、左下（对角线）或右下（对角线）。

3.  输出必须是整数元组。

第一个元素是表示列与行的列表，第二个元素是点的总数。例如。对于上面的电路板，最好的解决方案是从左上角 (5) 开始，然后沿对角线走剩余的步骤（直到 20 点正方形）。这将导致 tuple `([1,2,3,4], 29)`。

请记住，这一切都在 Haskell 中，所以它是一个函数范式递归问题。一开始我在想用贪心算法，也就是选择r1中的最大值，然后通过比较接下来的3种可能性进行递归；选择 3 中的最高值。然而，缺点是贪心算法没有能力在下一行之前看到潜力。

我该怎么办？我不是在寻找代码本身，因为我喜欢自己解决问题。但是，非常感谢伪代码或一些算法指导！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T16:01:10.033

保留该单元格得分最高的行中每一列的路径列表。

您将从列表开始（在您的示例中）

```
[([1],5), ([2],4), ([3],3), ([4],1)] 
```

然后，在检查下一行时，对于每一列，您选择前一行中可以到达该列的得分最高的路径，在这里，对于第二行，在第 1 列和第 2 列中，您将选择路径结尾在上一行的第 1 列和第 3 列中，您将选择在上一行中以第 2 列结尾的路径，在第 4 列中，在前一行中以第 3 列结尾的路径，这样会给您

```
[([1,1],15), ([1,2],7), ([2,3],5), ([3,4],3)] 
```

对于第三行，`[0,1,2,0]`您将再次为前两列选择以第 1 列结尾的路径，为第三列选择以第 2 列结尾的路径，为第四列选择以第 3 列结尾的路径，

```
[([1,1,1],15), ([1,1,2],16), ([1,2,3],9), ([2,3,4],5)] 
```

对于第四行，`[2,3,4,20]`您将为前三列选择以第 2 列结尾的路径，为最后一列选择以第 3 列结尾的路径，

```
[([1,1,2,1],18), ([1,1,2,2],19), ([1,1,2,3],20), ([1,2,3,4],29)] 
```

然后，当您到达最后一行时，您选择总数最高的路径。

为什么有效：

让得分最高的路径在 column 结束`c`。最后一列上方的部分必须是在`c-1, c, c+1`倒数第二行的一列`c`中结束的得分最高的路径，因为最后一行中的列只能从这些路径中到达。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T16:05:31.867

我看到了你之前关于同一主题的问题，我开始研究它。
由于您不想要直接的解决方案，我可以为您提供我对您的问题的反思，我想它可以帮助您。

一些基本性质：
1\. 移动的次数总是等于列表的长度**m = 长度 A**
2\. 起点的数量等于列表头的**长度 n = 长度（头 A）**
3.当前位置永远不会是负数，然后：
- 如果当前位置等于 0，您可以向下或向右
- 否则您可以向左、向下或向右

这导致我们这个伪代码

```
generate_path :: [[Int]] -> [[Int]]
generate_path [] = [[]] 
generate_path A =  ... -- You have to put something here
        where 
              m = length A
              n = length (head A) 
```

这东西应该看起来像这样

```
move pos0 count0
    | count0 == 0 =   
        | pos0 == 0 = move (down count) ++ move (right count)  
        | otherwise = move (left count) ++ move (down count) ++ move (right count)  
            where 
                count = count0 - 1
                down  = position0 
                left  = position0 - 1
                right = position0 + 1 
```

事实上，牢记所有这些并添加**(!!)**运算符，我们不应该走得太远。说服你玩**A + 列表理解 + !!** ， 作为

```
[A !! x !! y | x <- [1..2], y <- [0..2]] -- I take random range 
```

或者玩另一个版本：

```
[[A !! x !! y | x <- [1..2]] | y <- [0..2]]] -- I take random range 
```

实际上，您有两个递归，主要是处理参数 n = length (head A)，您在 (n-1) 处重复从 0 到 (n-1) 的相同操作，检索结果，此递归嵌入另一个在 m 上工作，从 0 到 (m-1) 重复相同的动作。

希望它有所帮助。祝你好运。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-05T23:46:20.220

最好的解决方案不是自上而下的贪心算法，而是从最后一行开始向上工作的方法：

```
import Data.Function
import Data.List

-- All elements of Board are lists of equal lengths
-- valid b = 1 == length (group (map length b))
type Value = Int
type Board = [[Value]]
type Index = Int
type Result = ([Index], Value)

p :: Board
p = [[5,4,3,1],[10,2,1,0],[0,1,2,0],[2,3,4,20]] 

best_from :: Board -> Result
best_from [] = undefined
best_from xs | any null xs = undefined
best_from b = best_of . best_list $ b

best_list :: Board -> [Result]
best_list b = foldr1 layer (map label b)
  where label = zipWith (\index value -> ([index],value)) [1..]
        layer new rest =  zipWith (\(i1,v1) (i2,v2) -> (i1++i2, v1+v2)) new best
          where temp = head rest : map best_pair (zip rest (tail rest))
                best = map best_pair (zip temp (tail rest)) ++ [last temp]

best_pair :: (Result,Result) -> Result
best_pair (a@(_,a1), b@(_,b1)) | a1 >=b1 = a
                               | otherwise = b

best_of :: [Result] -> Result
best_of = maximumBy (compare `on` snd)

main = do
  print (best_from p) 
```

如果有一行就很容易解决。因此，这会将每一行转换为具有简单 [#] 解决方案路径的 Result 列表。

给定一行`rest`下方的谜题，`new`然后添加行就是从（通过检查向下、左下、右下）`new`找到解决方案并与行结合的问题。`best``rest``new`

这使得`foldr`, 或这里`foldr1`成为自然结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T04:16:31.940

我选择了一条不同的道路，没有双关语的意思。我列出了允许的索引组合并将板映射到它们。也许有人可以找到一种方法将其推广到任何规模的董事会。

```
import Data.List
import Data.Ord
import Data.Maybe

a = [[5,4,3,1],[10,2,1,0],[0,1,2,0],[2,3,4,20]]
r1 = a !! 0
r2 = a !! 1
r3 = a !! 2
r4 = a !! 3

i = [0,1,2,3]
index_combinations = [[a,b,c,d] | a <- i, b <- i, c <- i, d <- i, 
                      abs (b-a) < 2, abs (c-b) < 2, abs (d-c) < 2]

mapR xs = [r1 !! (xs !! 0), r2 !! (xs !! 1), 
           r3 !! (xs !! 2), r4 !! (xs !! 3)]

r_combinations = map mapR index_combinations
r_combinations_summed = zip r_combinations $ map (foldr (+) 0) r_combinations

result = maximumBy (comparing snd) r_combinations_summed
path = index_combinations !! fromJust (elemIndex result r_combinations_summed) 
```

# python - 检查值是否存在

> ID：14711330
> 
> 赞同：0
> 
> 时间：2013-02-05T15:46:00.243
> 
> 标签：python

我是 Python 新手，我正在编写一个`<td>`在 HTML 表中查找行的网络爬虫：

```
# open CSV with URLS to scrape
csv_file = csv.reader(open('urls.csv', 'rb'), delimiter=',')

names = []
for data in csv_file:
    names.append(data[0])

for name in names:
   html = D.get(name);
   html2 = html
   param = '<br />';
   html2 = html2.replace("<br />", " | ")
   print name

   c = csv.writer(open("darkgrey.csv", "a"))
   for row in xpath.search(html2, '//table/tr[@class="bgdarkgrey"]'):
       cols = xpath.search(row, '/td')
       c.writerow([cols[0], cols[1], cols[2], cols[3], cols[4]]) 
```

它所做的只是从 4 个表中获取值`'<td>'`

问题是，有些表没有`cols[2]`，`cols[3]`或者`cols[4]`

有没有办法，我可以检查这些是否存在？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:48:09.487

我并不完全熟悉`xpath`，但您应该能够检查 的长度`cols`（只要它不是一个在其他方面看起来像序列的非常奇怪的对象）：

```
 if len(cols) >= 5:
    ... 
```

另一个常见的 Python 习语是试试看。

```
try:
    c.writerow([cols[0], cols[1], cols[2], cols[3], cols[4]])
except IndexError:
    #failed because `cols` isn't long enough.  Do something else. 
```

最后，假设`cols`是 a `list`，您始终可以确保它足够长：

```
cols.extend(['']*5) 
```

这将用空字符串填充您的列，以便您*至少有 5 列*（通常更多）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:50:13.970

```
c.writerow([col[x] for x in range(0,len(col))]) 
```

也不要忘记关闭“darkgrey.csv”文件！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T15:57:10.467

另一种可能的方法

```
c.writerow([cols[0], cols[1], '' if not(cols[2]) else cols[2], '' if not(cols[3]) else cols[3], '' if not(cols[4]) else cols[4]]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T16:08:13.750

也许你想说`cols = xpath.search(row, 'td')`不`cols = xpath.search(row, '/td')`？（没有斜线）

# javascript - 在 AngularJS 中，当表单缺少 action 属性时，是否有办法禁用阻止默认操作？

> ID：14711334
> 
> 赞同：10
> 
> 时间：2013-02-05T15:46:08.887
> 
> 标签：javascript, forms, angularjs

在我的代码中，我有一个如下所示的表单：

```
<form action="" method="post"> 
```

默认情况下，AngularJS在没有指定 action 属性的情况下[禁用表单提交。](http://docs.angularjs.org/#dsq-login-google)我知道我可以（并且应该）分配一个表单操作，但是我想知道是否有一种简单的方法可以防止 AngularJS 拦截这个特定的表单提交事件，以便它可以正常发布。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-05T15:54:23.890

使用`action="?"`... Angular 正在检查`!attr.action`，如果 action == ""，则为真。

# c# - 如何从 Excel 工作表中的单个文件中删除宏？

> ID：14711335
> 
> 赞同：0
> 
> 时间：2013-02-05T15:46:09.007
> 
> 标签：c#, excel, vba

**范围：**

我和我的团队正在使用 VBA 为我们的客户开发 Excel 报告。此 .xlms 文件中有我不想为客户提供的函数和宏。

我们已使用此代码示例成功地从工作簿中删除了所有宏：

```
 private void DeleteMacros (string reportPath)
    {
        // WorkBookManager is our own Wrapper for the Excel Workbook class
        WorkbookManager wb = new WorkbookManager (reportPath);
        wb.OpenWorkbook (false);

        //Lock workbook
        wb.RunMacro("ThisWorkbook.LockWorkbook");

        //Deleting the Macros from the workbook
        VBProject project = wb.GetInstance().VBProject;

        for (int i = project.VBComponents.Count; i >= 1; i--)
        {
            VBComponent component = project.VBComponents.Item(i);

            try
            {
                project.VBComponents.Remove(component);
            }
            catch (ArgumentException)
            {
                continue;
            }
        }

        for (int i = project.VBComponents.Count; i >= 1; i--)
        {
            VBComponent component = project.VBComponents.Item(i);
            component.CodeModule.DeleteLines(1, component.CodeModule.CountOfLines);
        }

        wb.CloseAndSave();
        wb.CleanUp();
    } 
```

**问题：**

此工作簿中有一些宏我们仍然需要，例如用于从一个工作表导航到另一个工作表的宏，我们绑定到按钮（以避免在报表底部显示工作表选项卡）。

**问题：**

有什么办法可以将那些不重要（/敏感）的宏封装在单个工作簿上的单个文件中，并以某种方式删除所有其他工作簿及其宏？

如果不是，那么这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T07:05:09.623

`Name`您是否尝试在删除之前检查每个组件的属性（例如）？只是不要删除你想保留的那些。

# java - 使用模板引擎的类似速度的延迟加载

> ID：14711336
> 
> 赞同：2
> 
> 时间：2013-02-05T15:46:10.020
> 
> 标签：java, lazy-loading, velocity, template-engine, freemarker

在一个应用程序中，我们使用 Velocity 来合并模板中的占位符。所以 ${firstname} 被合并到用户的名字，因为我们在合并到 VelocityContext Hashmap 之前添加了它。

代码：

```
public static String evaluateTemplate(final VelocityContext context, final String template){
    try {
        velocityEngine.init();
        StringWriter writer = new StringWriter();
        velocityEngine.evaluate(context, writer, "", template);
        return writer.toString();
    } catch (Exception e) {
        ...
    }           
} 
```

这是一个非常简单的示例，并且总是将名字添加到 VelocityContext 中，即使它没有在模板中使用，也不是一项昂贵的操作，因为用户属性字段（来自 Hibernate 实体的 getter）大部分时间都需要评估模板（模板可以是个人页面或电子邮件）。但在某些特殊情况下，我们需要一些更“昂贵”的数据。例如，来自其他应用程序的数据通过 Web 服务获取。即使模板中没有请求信息的占位符，它也会每次加载并放入上下文哈希映射中。

所以我的问题是，是否有替代模板引擎（我也知道'Freemarker'和'String template'）在必要时加载所需内容？某种开销较小的延迟加载模板引擎

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T08:42:59.193

您不必将可能需要的所有/所有值都放在上下文中。只需在其中放入一些带有 getter 的对象（或类，如果您想使用静态方法）来检索值：`$myObject.getFirstname()`. 对于昂贵的东西，您可以在需要时拨打电话`$myObject.getExpensiveData()`。延迟加载应该发生在方法内部`getExpensiveData()`，所以如果模板不需要这些东西，那么它就不会调用该方法，因此加载不会发生。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-06T08:14:59.533

有可能将多个上下文链接在一起，比如您的廉价内容进入标准上下文映射并从那里提供服务，而昂贵的（如 Web 服务调用）则委托给您的自定义上下文。这样您就可以提供延迟加载。

速度本身的开销很小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T19:17:04.013

由于您也问过这个问题，因此在 FreeMarker 中，模板上下文（在此处称为数据模型）只需实现`TemplateHashModel`接口（或`java.util.Map`），因此在您的自定义`get(String)`实现中，您可以推迟解析变量值，直到模板中第一次需要它。

# matplotlib - matplotlib 刻度相对于轴的位置

> ID：14711338
> 
> 赞同：19
> 
> 时间：2013-02-05T15:46:16.047
> 
> 标签：matplotlib

matplotlib 中有没有办法在标签和轴之间设置刻度，因为它在 Origin 中默认设置？在线示例部分没有显示具有此功能的单个图。我喜欢在绘图区域之外有刻度，因为有时绘图会在内部隐藏刻度。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-02-05T16:37:21.603

要设置主要刻度：

```
ax = plt.gca()
ax.get_yaxis().set_tick_params(direction='out')
ax.get_xaxis().set_tick_params(direction='out')
plt.draw() 
```

设置所有刻度（次要和主要），

```
ax.get_yaxis().set_tick_params(which='both', direction='out')
ax.get_xaxis().set_tick_params(which='both', direction='out')
plt.draw() 
```

同时设置 x 和 y 轴：

```
ax = plt.gca()
ax.tick_params(direction='out') 
```

[轴级文档](http://matplotlib.org/api/axis_api.html#matplotlib.axis.Axis.set_tick_params)和[轴级文档](http://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes.tick_params)

要相对于刻度移动刻度标签，请使用`pad`. 相比

```
ax.tick_params(direction='out', pad=5)
plt.draw() 
```

和

```
ax.tick_params(direction='out', pad=15)
plt.draw() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-15T03:33:02.460

我猜你需要这个：

通过获取 subplot 对象，您可以使用您的刻度

```
ax = plt.subplot(111)
yax = ax.get_yaxis()
plt.xticks(y_pos, city)
xtickNames=ax.set_xticklabels(city)
plt.setp(xtickNames, rotation=45, fontsize=10) 
```

[以下是旋转 45 度刻度的输出](https://i.stack.imgur.com/zZlOi.png)

# php - 无法在 iOS 6 + 中创建具有所需格式的 POST 正文

> ID：14711339
> 
> 赞同：0
> 
> 时间：2013-02-05T15:46:17.010
> 
> 标签：php, web-services, ios6, http-post, httprequest

我正在为我的 iOS 应用程序使用用 PHP 开发的 Web 服务。现在我已经在 PHP 开发人员给出的 POST 正文中发送参数。但我无法以所需格式在 POST 正文中发送它。这是PHP开发人员给出的格式

```
 Array
(
    [key] => ecwrerwe3453453453454cea
    [secret] => 45d77657657567jghjb6ef
    [product] => Array
        (
            [name] => mobile
            [id] => 3
            [desc] => nokia c 5
            [price] => 5
        )

    [spec] => Array
        (
            [0] => Array
                (
                    [key] => color
                    [value] => ping
                )

        )
) 
```

我发送到服务器的内容如下

```
 {
    key = c435435t3tergs680;
    product =     (
                {
            id= 3;
            desc = "Test desc";
            name = "Nokia mobile";
            "price" = "987.65";
        }
    );
    secret = 43ytehgrdghd1ee0d8;
    specs =     (
                (
                        {
                key = aaaaaaaaa;
                value = aaaa;
            }
        ),
                (
                        {
                key = bbbbbbbbbb;
                value = bbbbb;
            }
        )
    );
} 
```

要在 POST 正文之上构建，我在 iOS 中使用以下代码

```
NSMutableArray *specsArray = [[NSMutableArray alloc]init];
    for (ProductSpecification *prodSpecs in self.newProduct.specificationArray)
    {
        NSMutableDictionary *specsDict = [[NSMutableDictionary alloc]init];
        [specsDict setValue:prodSpecs.name forKey:SPECS_NAME_KEY];
        [specsDict setValue:prodSpecs.value forKey:SPECS_VALUE_KEY];
        NSArray *array = [NSArray arrayWithObjects:specsDict, nil];
        [specsArray addObject:array];
    }

    NSMutableArray *productArray = [[NSMutableArray alloc]init];
    NSMutableDictionary *productDict = [[NSMutableDictionary alloc]init];
    [productDict setValue:self.newProduct.name forKey:NAME_KEY];
    [productDict setValue:self.newProduct.prodId forKey:ID_KEY];
    [productDict setValue:self.newProduct.productDescription forKey:DESC_KEY];
    [productDict setValue:self.newProduct.price forKey:PRICE_KEY];
    [productArray addObject:productDict];

    NSMutableDictionary *params = [[NSMutableDictionary alloc]initWithObjectsAndKeys:productArray,NEW_PRODUCT_ARRAY_NAME_KEY,specsArray,SPECS_ARRAY_KEY,nil];
    // Get the API keys & append it in params 
    NSDictionary *keysDictionary = [kUserDefaults getAPIKeys];
    [params setValue:[keysDictionary objectForKey:API_KEY] forKey:API_KEY];
    [params setValue:[keysDictionary objectForKey:API_SECRET_KEY] forKey:API_SECRET_KEY];

    NSLog(@"Params Dict: %@",params); 
```

我无法将所需格式的数据发送到服务器。如何发送数组而不是 nsdictionary 中的键值？

谁能告诉我我的 iOS 代码出了什么问题？

任何形式的帮助都将受到高度赞赏。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:50:56.413

我不确定这是否能解决你的问题，但它可能会帮助你到达那里。

本质上，您正在重新创建以下 HTML 表单，但来自您的 iOS 应用程序：

```
<form method="post">
<input name="key" type="hidden" value="ecwrerwe3453453453454cea" />
<input name="secret" type="hidden" value="45d77657657567jghjb6ef" />
<input name="product[name]" type="hidden" value="mobile" />
<input name="product[id]" type="hidden" value="3" />
<input name="product[desc]" type="hidden" value="nokia c 5" />
<input name="product[price]" type="hidden" value="5" />
<input name="spec[0][key]" type="hidden" value="color" />
<input name="spec[0][value]" type="hidden" value="ping" />
<input type="submit" name="submit" />
</form> 
```

提交此表单时，浏览器将在帖子正文中提交以下内容：

`key=ecwrerwe3453453453454cea&secret=45d77657657567jghjb6ef&product%5Bname%5D=mobile&product%5Bid%5D=3&product%5Bdesc%5D=nokia+c+5&product%5Bprice%5D=5&spec%5B0%5D%5Bkey%5D=color&spec%5B0%5D%5Bvalue%5D=ping&submit=Submit`

或解码：

`key=ecwrerwe3453453453454cea&secret=45d77657657567jghjb6ef&product[name]=mobile&product[id]=3&product[desc]=nokia c 5&product[price]=5&spec[0][key]=color&spec[0][value]=ping`

您可以尝试使用 NSMutableString / appendFormat / 自行创建此字符串。然后在你的（大概）NSMutableUrlRequest 中，`[request setHTTPBody:[postDataString dataUsingEncoding:NSUTF8StringEncoding]];`

我猜你的代码可能看起来像这样：

```
NSMutableURLRequest* request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@"http://www.example.com/api/"] cachePolicy:NSURLCacheStorageNotAllowed timeoutInterval:60];
[request setHTTPMethod:@"POST"];

NSMutableString* postDataString = [[NSMutableString alloc] init];
[postDataString appendFormat:@"key=%@",key];
[postDataString appendFormat:@"&secret=%@",secret];
[postDataString appendFormat:@"&product%5Bname%5D=%@",self.newProduct.name];
// etc...

[request setHTTPBody:[postDataString dataUsingEncoding:NSUTF8StringEncoding]]; 
```

不要忘记，你也需要正确地逃避你的价值观。

# matlab - matlab语法矩阵括号或无括号

> ID：14711346
> 
> 赞同：2
> 
> 时间：2013-02-05T15:46:35.107
> 
> 标签：matlab, syntax

我注意到您可以在 matlab 中使用以下两个代码创建一个矩阵...

```
m=[1:2:10] 
```

或者

```
m=1:2:10 
```

上述两者之间实际上有什么区别吗？他们似乎输出相同的东西？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:53:05.200

没有区别，方括号可用于连接，例如：

```
m = [1:2:10 50] 
```

结果是：

```
m =

     1     3     5     7     9    50 
```

对于您的问题中使用的数组，无需这样做。

# algorithm - Phong 反射模型参数

> ID：14711350
> 
> 赞同：3
> 
> 时间：2013-02-05T15:46:49.760
> 
> 标签：algorithm, image-processing, 3d, formula, 3d-reconstruction

**问题：**任何人都可以向我介绍为网络摄像头拍摄的面部图像的 Phong 反射模型参数吗？

**细节：**

我正在使用 3D Morphable Model 对 2D 图像进行 3D 重建，如本文[Vetter & Blanz, 2003](http://gravis.cs.unibas.ch/publications/pami03.pdf)中所述。

有一个成本函数需要使用牛顿法进行优化。我需要为 Newton 方法提供初始化值。

下面的等式是图像的 phong 反射模型。显示了环境、漫反射和镜面反射分量。

![在此处输入图像描述](../Images/9690f9bd473193969ff9fa398addf638.png)

[Phong 反射模型 wiki](http://en.wikipedia.org/wiki/Phong_reflection_model)

Phong 参数：Ks、Kd、Ka、α、Lm、V

我正在使用牛顿法估计上述参数。图像是人脸，摄像头是网络摄像头。

**我给出了以下值：** Ks = Kd = Ka = 0.6 α = 5 Lm = [0 1 1] V = [0 0 1]

任何人都可以评论上述值以及参数的良好初始化值是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T22:01:09.547

我的老板前段时间有一篇关于这方面的 Siggraph 论文，并提出了一个在线工具，该工具可以根据性别、皮肤类型等检索适合 Blinn-Phong 模型的特定皮肤 BRDF。该工具可在： [http:// /gvi.seas.harvard.edu/ext/facescanning/index.html](http://gvi.seas.harvard.edu/ext/facescanning/index.html)

或者，您可以在以下位置查看 Matusik 的 BRDF 数据库配件： [http](http://people.csail.mit.edu/addy/research/ngan05_brdf_supplemental_doc.pdf) ://people.csail.mit.edu/addy/research/ngan05_brdf_supplemental_doc.pdf 并选择一个“看起来像”皮肤的 BRDF（他们没有测量皮肤，因为他们使用球）。

# c# - BookResumptionQuery 在 WPF 中不起作用，但仅在控制台应用程序中起作用。为什么？

> ID：14711352
> 
> 赞同：0
> 
> 时间：2013-02-05T15:46:52.363
> 
> 标签：c#, .net, workflow

```
 BookmarkTrackingParticipant tracker = new BookmarkTrackingParticipant()
        {
            TrackingProfile = new TrackingProfile()
            {
                Queries =
                {
                    new BookmarkResumptionQuery()
                    {
                        Name = "*"
                    }
                }
            }
        };

        _workflow.Extensions.Add(tracker); 
```

每当我使用参与者所在的控制台应用程序运行它时 - 它都附加到工作流中。突然间，如果我使用 WPF 应用程序，参与者就不存在了。工作流程正在运行，但没有参与者。为什么？

# c# - 如何用星号替换所有大写字母？

> ID：14711356
> 
> 赞同：0
> 
> 时间：2013-02-05T15:47:06.093
> 
> 标签：c#, string

这就是我在按钮 1 下的内容。我对这个程序完全陌生。我错过了什么吗？没有错误，但按钮没有达到其目的，也没有将“A”更改为星号，也就是 *。我最终想用*替换单词中的所有大写字母，但现在我只想学习如何写字母“A”。

```
string orgstring = textBox1.Text;
string Asteriskstring = textBox1.Text.Replace("A","//*"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T15:50:13.927

您正在这样做，尽管我不知道正斜杠的用途，并且`orgstring`在此示例中是多余的；结果由 保存`Asteriskstring`，因此假设您要显示该值，您需要更新 UI：

```
textBox1.Text = Asteriskstring; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T15:56:11.573

```
string sSource = "AcccADFGHcsdD";
string sDest = Regex.Replace(sSource, @"[A-Z]", "*"); 
```

将返回：

> “*ccc*****csd*”

在你的情况下：

```
string orgstring = textBox1.Text;
string Asteriskstring = Regex.Replace(orgstring, @"[A-Z]", "*"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T15:51:20.720

您是否尝试更改文本框的内容？如果是这样的话...

```
 string textBox1.Text = textBox1.Text.Replace("A","//*"); 
```

**编辑：**最好的方法可能是将 Arie 的答案和我原来的答案结合起来。您想使用他们的正则表达式替换来更改文本框的文本；该文本既是您的来源又是目的地，因此：

```
textBox1.Text = Regex.Replace(textBox1.Text, "[A-Z]", "*"); 
```

如果这不起作用，则包含`Regex`该类的命名空间可能未包含在您的程序中。该类`Regex`位于`System.Text.RegularExpressions`命名空间中。要启用`Regex`该类，请将以下代码添加到包含以 开头的所有语句的代码部分`using`：

```
using System.Text.RegularExpressions; 
```

# c# - 将类型转换为其可为空的等价物

> ID：14711358
> 
> 赞同：0
> 
> 时间：2013-02-05T15:47:14.393
> 
> 标签：c#, type-conversion, nullable

我有这段代码

```
 NullableConverter nullableConverter = new NullableConverter(type);
 Type baseType = nullableConverter.UnderlyingType;
 Object value = Convert.ChangeType(rule.Data, baseType);
 constant = Expression.Constant(value); 
```

在这种情况下，类型是`decimal?`，但它可以是任何可为空的类型。

我需要`value`是 type `decimal?`，而不是`decimal`现在的 type 。问题在于，`Convert.ChangeType`它不适用于可空类型。所以我首先创建一个不可为空的。

如何将包含的字符串转换`rule.Data`为`type`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:55:24.680

你不能。

当可空结构被装箱时，`Object`它不会存储装箱的可空结构。如果结构没有值，它只会装箱`null`，如果它有值，它将装箱可空结构的基础值。

你不需要为它装箱，这甚至是可能的。

# wpf - Windsor - 解决项目后添加的组件和服务

> ID：14711359
> 
> 赞同：0
> 
> 时间：2013-02-05T15:47:15.453
> 
> 标签：wpf, castle-windsor

我在我的 WPF 项目中使用最新的 Castle Windsor，我遇到了一个非常奇怪的问题。

在解析我的一个 ViewModel 时 - 容器自行注册不需要作为服务的类型并注入这些类型的空属性，容器自行注册服务是常见的行为吗？

我可以看到，在配置容器后检查内核的服务集合，我在一个解析之前停止了，在解析结束后又添加了 3 个服务......

如果有人可以对这个问题有所了解，那将非常有帮助谢谢

我的配置文件：

```
 public IContainerService Get()
    {
        var container = new WindsorContainer();
        var adapter = new ContainerServiceWindsorAdapter(container.Kernel);

        container.Register(Component.For<IWindowManager>().ImplementedBy<TelerikWindowManager>());
        container.Register(Component.For<IEventAggregator>().ImplementedBy<EventAggregator>());
        container.Register(Component.For<INavigationService>().ImplementedBy<NavigationService>());
        container.Register(Component.For<IFileService>().ImplementedBy<FileService>());
        container.Register(Component.For<ISessionFactory>().UsingFactoryMethod(k =>
        {
            var fs = container.Resolve<IFileService>();
            var normalConfig = new Configuration().Configure(Path.Combine(fs.GetWorkingFolder(), CONFIG_FILE));

            return Fluently.Configure(normalConfig)
                           .CurrentSessionContext<ThreadStaticSessionContext>()
                           .Mappings(m => m.FluentMappings.AddFromAssemblyOf<NHDataAccessProvider>())
                           .ExposeConfiguration(BuildSchema)
                           .BuildSessionFactory();
        }));
        container.Register(Component.For<IDataAccessProvider>().ImplementedBy<NHDataAccessProvider>());

        //Register IShell
        container.Register(Component.For<IShell>().ImplementedBy<ShellViewModel>()
            .Properties(p => p.PropertyType != typeof(IModuleDataScreen)));

        //Register all IModuleDataScreens
        container.Register(AllTypes.FromAssemblyContaining<ShellViewModel>()
                     .BasedOn(typeof(IModuleDataScreen))
                     .WithService.FromInterface(typeof(IModuleDataScreen))
                     .Configure(x => x.LifeStyle.Is(LifestyleType.Transient))
                     .Configure(x => x.Named(x.Implementation.Name)));

        //Register all Modules
        container.Register(AllTypes.FromAssemblyContaining<ShellViewModel>()
                .BasedOn(typeof(IModule))
                .WithService.FromInterface(typeof(IModule))
                .Configure(x => x.LifeStyle.Is(LifestyleType.Singleton))
                .Configure(x => x.Named(x.Implementation.Name)));

        container.Install(new CommonComponentsInstaller(),new DynamicCalculationsInstaller());

        var sf = container.Resolve<ISessionFactory>();
        CurrentSessionContext.Bind(sf.OpenSession());

        return adapter;
    }

public class DynamicCalculationsInstaller : IWindsorInstaller
{
    public void Install(Castle.Windsor.IWindsorContainer container, Castle.MicroKernel.SubSystems.Configuration.IConfigurationStore store)
    {
        container.Register(Component.For<IFormulaEvaluator>().ImplementedBy<FleeFormulaEvaluator>().LifeStyle.Singleton);
        container.Register(Component.For<IRulesEvaluator>().ImplementedBy<FleeRulesEvaluator>().LifeStyle.Singleton);

        container.Register(Component.For<IPlansModule>()
                                    .ImplementedBy<PlansModule>()
                                    .LifeStyle
                                    .Transient);

        container.Register(
            Component.For<IDataProvider<PackageData>>()
                     .ImplementedBy<PackageDataProvider>()
                     .LifeStyle
                     .Transient);

        container.Register(Component.For<IPackagesModule>()
                                    .ImplementedBy<PackagesModule>()
                                    .LifeStyle
                                    .Transient);

        container.Register(Component.For<ExternalRuleSetService>());
    }
}

public class CommonComponentsInstaller : IWindsorInstaller
{

    #region Implementation of IWindsorInstaller

    public void Install(IWindsorContainer container, IConfigurationStore store)
    {
        container.Register(Component.For<IErrorHandler>().ImplementedBy<ErrorHandlerEntLibAdapter>());
        container.Register(Component.For<ICacheService>().ImplementedBy<CacheServiceEntLibAdapter>());
        container.Register(Component.For<ILogger>().ImplementedBy<LoggerEntLibAdapter>());
        container.Register(Component.For<IMessageSerializer>().ImplementedBy<MessageSerializer>());
        container.Register(Component.For<IInteroperableSerializer>().ImplementedBy<InteroperableSerializer>());
        container.Register(Component.For<ILazyComponentLoader>().ImplementedBy<ConcreteClassComponentLoader>().Named("concreteClass"));
    }

    #endregion

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:41:54.317

您所指的功能称为`ILazyComponentLoader`s。

这是一个扩展点，Windsor 允许在需要的地方注册组件。

Windsor 本身在少数地方使用它，最常用的是[基于委托的类型工厂](http://stw.castleproject.org/Windsor.Typed-Factory-Facility-delegate-based-factories.ashx)。

现在，解决方案。如果您不希望 Windsor 满足这些依赖项，请不要将它们暴露给容器。

```
Container.Register(
    Component.For<MyType>().Properties(PropertyFilter.IgnoreAll));
   ); 
```

# c# - 如何在超类中定义静态方法以使用反射获取子类的属性？

> ID：14711362
> 
> 赞同：1
> 
> 时间：2013-02-05T15:47:27.950
> 
> 标签：c#, .net, inheritance, reflection, properties

我有一个类，`BaseClass`它有一个`GetPropertyByDataMemberName`方法。此方法使用反射来获取具有`DataMemberAttribute`指定名称的属性。我想将它定义为一个静态方法，`BaseClass`所以我不必在每个子类中定义它。

问题是，由于此方法使用反射来查找属性，因此我需要以`Type`某种方式获取当前值才能调用`GetProperties`. 由于它是一个静态方法，我不能调用`GetType`，所以我不知道该怎么做！

```
abstract class BaseClass
{
    [DataMember(Name = "p1")]
    public int PropertyOne{ get; set; }

    public static PropertyInfo GetPropertyByDataMemberName(string dataMemberName)
    {
        return GetType() // argh! can't call this statically!
            .GetProperties()
            .Where(z => Attribute.IsDefined(z, typeof(DataMemberAttribute)))
            .Single(z => ((DataMemberAttribute)Attribute.GetCustomAttribute(z, typeof(DataMemberAttribute))).Name == dataMemberName);
    }
} 
```

为什么不让它成为非静态的？好吧，假设我有一个这样的子类：

```
class SubClassOne : BaseClass
{
    [DataMember(Name = "p2")]
    public string PropertyTwo { get; set; }
} 
```

我希望能够做这样的事情：

```
static void Main(string[] args)
{
    // print property names
    Console.WriteLine(BaseClass.GetPropertyByDataMemberName("p1").Name);   // should work
    Console.WriteLine(BaseClass.GetPropertyByDataMemberName("p2").Name);   // should not work
    Console.WriteLine(SubClassOne.GetPropertyByDataMemberName("p1").Name); // should work
    Console.WriteLine(SubClassOne.GetPropertyByDataMemberName("p2").Name); // should work
} 
```

我试过 make `GetPropertyByDataMemberName`use `typeof(BaseClass)`，但它只获取 的属性`BaseClass`，而不是任何子类。

```
public static PropertyInfo GetPropertyByDataMemberName(string dataMemberName)
{
    return typeof(BaseClass)
        .GetProperties() // only gets properties of BaseClass
        .Where(z => Attribute.IsDefined(z, typeof(DataMemberAttribute)))
        .Single(z => ((DataMemberAttribute)Attribute.GetCustomAttribute(z, typeof(DataMemberAttribute))).Name == dataMemberName);
} 
```

那么，如何做到这一点呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:52:55.703

您可以使用泛型来实现这一点：

```
public static PropertyInfo GetPropertyByDataMemberName<T>(string dataMemberName)
    where T : BaseClass
{
    return typeof(T)
        .GetProperties()
        .Where(z => Attribute.IsDefined(z, typeof(DataMemberAttribute)))
        .Single(z => ((DataMemberAttribute)Attribute.GetCustomAttribute(z, typeof(DataMemberAttribute))).Name == dataMemberName);
}

// Shortcut overload for properties on BaseClass.
public static PropertyInfo GetPropertyByDataMemberName(string dataMemberName)
{
    return GetPropertyByDataMemberName<BaseClass>(dataMemberName);
} 
```

你可以这样称呼它：

```
static void Main(string[] args)
{
    Console.WriteLine(BaseClass.GetPropertyByDataMemberName("p1").Name);   // should work
    Console.WriteLine(BaseClass.GetPropertyByDataMemberName("p2").Name);   // should not work
    Console.WriteLine(BaseClass.GetPropertyByDataMemberName<SubClassOne>("p1").Name); // should work
    Console.WriteLine(BaseClass.GetPropertyByDataMemberName<SubClassOne>("p2").Name); // should work
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:04:31.917

尝试这个：

```
public static PropertyInfo GetPropertyByDataMemberName(string dataMemberName)
{
    var st = new StackTrace();

    var type = ((System.Reflection.MemberInfo)(st.GetFrame(0).GetMethod())).ReflectedType;
    return type // argh! can't call this statically!
        .GetProperties()
        .Where(z => Attribute.IsDefined(z, typeof(DataMemberAttribute)))
        .Single(z => ((DataMemberAttribute)Attribute
            .GetCustomAttribute(z, typeof(DataMemberAttribute))).Name == dataMemberName);
} 
```

# c# - 在 Timer 中修改 TextBlock 的值

> ID：14711365
> 
> 赞同：0
> 
> 时间：2013-02-05T15:47:38.787
> 
> 标签：c#, wpf

我无法在 Timer 中修改我的 textBlock。

这是我的代码：

```
 private void Play_Button_Click(object sender, RoutedEventArgs e)
    {
            timer = new System.Timers.Timer(1000);
            timer.Elapsed += new ElapsedEventHandler(displayTime);
            timer.Enabled = true;
            try
            {
               // video.Play();
            }
            catch (Exception exp)
            {
                Console.WriteLine("error: " + exp.Message);
            }
        }
     }

    private void displayTime(object source, ElapsedEventArgs e)
    {
        textProgression.Text = "Test";
    } 
```

每一秒，我的函数 displayTime 都会被调用，但 textProgression 的值不会改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:56:09.937

您对 WPF 中的 UI 所做的任何修改都必须在 WPF 线程（调度程序线程）中完成。

为此，您有两种选择：

使用线程，并在 displayTime 调用 textProgression.Text = "Test"; 在调度程序中：

```
private void displayTime(object source, ElapsedEventArgs e)
{
    Dispatcher.Invoke(new Action(() =>
    {
        textProgression.Text = "Test";
    }));
} 
```

或者，我认为最好的方法是使用[`DispatcherTimer`](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer.aspx). 因为在这个计时器中，所有`Tick`事件都在 Dispatcher 线程中触发。

```
private void dispatcherTimer_Tick(object sender, EventArgs e)
{
    textProgression.Text = "Test";
} 
```

# asp.net-mvc - SessionTempDataProvider 和 CookieTempDataProvider 之间的不同行为

> ID：14711367
> 
> 赞同：2
> 
> 时间：2013-02-05T15:47:58.587
> 
> 标签：asp.net-mvc, session, asp.net-mvc-4, tempdata

所有这一切的简短版本是我正在使用 TempData 来存储反馈消息，并且在切换到使用 CookieTempDataProvider 后，它们在使用 PRG 模式时不会出现，但是如果我恢复到 SessionTempDataProvider 他们会出现。

在我的 MVC4 应用程序中，我有一种模式，即在成功创建/更新后或当某些页面出现问题并且我需要显示失败消息时，将警告消息写入临时数据以显示在屏幕上。例如...

```
[HttpPost, ValidateAntiForgeryToken]
public ActionResult Edit(PeopleEditFormModel model)
{
    if (!ModelState.IsValid)
        return RedirectToAction("Edit", new { id = model.ObjectId });
    try
    {
        var person = personService.UpdatePerson(model); // personService is set via DI in constructor
        TempData["message"] = "Person successfully updated.";
        TempData["messageType"] = "success"
        return RedirectToAction("Details", new { id = person.ObjectId });
    }
    catch (DomainException ex)
    {
        //For putting business logic errors in the ModelState
        ModelState.AddModelError(string.Empty, ex.Message);
        return RedirectToAction("Edit", new {id = model.ObjectId});
    }
} 
```

我有一个由我的 _Layout.cshtml 文件调用的部分视图，该文件基本上是一个占位符 DIV 元素（加上一些 js），其中填充了我的反馈消息，这很好用。

![更新反馈](../Images/15473b42dafaf05cdb0c070679a1f1bb.png)

现在默认情况下这是可行的，但 TempData 依赖于会话，如果可能，我想禁用它并使用 TempDataProvider 的不同实现来解决没有会话的问题。我必须使用不同的 TempDataProvier，因为如果我禁用会话而不更改 TempData 的实施，我第一次尝试使用它时会得到一个 InvalidOperationException 说明

> SessionStateTempDataProvider 类需要启用会话状态。

```
<system.web>
  <sessionState mode="Off"/>
</system.web> 
```

我已经用我的 Dependency Injector，StructureMap 注册了一个新组件，它看起来像这样。

```
//I have tried this with and without the HttpContextScoped()
For<ITempDataProvider>().HttpContextScoped().Use<CookieTempDataProvider>();
For<HttpContextBase>().HttpContextScoped().Use(x => new HttpContextWrapper(HttpContext.Current)); 
```

~~我应该提一下我对 CookieTempDataProvider[的实现来自这里](https://github.com/ASP-NET-MVC/aspnetwebstack/blob/master/src/Microsoft.Web.Mvc/CookieTempDataProvider.cs)~~ 显然它已被删除。

现在，当我现在尝试使用 TempData 但我的反馈没有出现时，这解决了异常。我想也许我在努力中破坏了一些东西，所以我注释掉了我的 DI 行并将我的会话状态模式改回`InProc`，并对其进行了测试。我的反馈按预期显示（重新启动 IISExpress 后）。我取消注释我的注入行，将会话状态更改为`Off`，然后我又没有反馈了。

我做了一些进一步的测试，发现如果我在操作中执行以下操作，我不会收到任何消息

```
TempData["message"] = "Person successfully updated.";
TempData["messageType"] = "success"
return RedirectToAction("Details", new { id = person.ObjectId }); 
```

但是，如果我忽略 PRG 模式，而是这样做，那么我会看到我的反馈。

```
TempData["message"] = "Person successfully updated.";
TempData["messageType"] = "success"
return View("Edit", person); 
```

所以我的问题是，普遍接受的 CookieTempDataProvider 是否存在缺陷，或者我做错了什么？

# objective-c - UITableView 插入/删除后没有选择

> ID：14711370
> 
> 赞同：1
> 
> 时间：2013-02-05T15:48:02.857
> 
> 标签：objective-c, uitableview

我在故事板中连接了一个 UITableViewController 子类。选择后，将推送数据元素的编辑器。这个编辑器有一个用于新条目的“完成”按钮和一个用于现有条目的“删除”按钮。它们的连接方式如下：

```
- (void)doneButtonClicked:(id)sender {
    [self setEditing:NO animated:NO];
    [self.navigationController popViewControllerAnimated:YES];
    [self.delegate taskDefinitionEditor:self didCreate:self.taskDefinition];
}

- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    switch (buttonIndex) {

        case 1:
            [self.delegate taskDefinitionEditor:self didDelete:self.taskDefinition];
            [self.navigationController popViewControllerAnimated:YES];
            break;

        default:
            break;
    }
} 
```

UIAlertView 是一个确认对话框。
如您所见，编辑器调用委托来通知它有关新项目或已删除项目的信息。这将是 UITableViewController 子类。我使用了委托和导航控制器调用的不同顺序来确定这是否是我的问题的原因。它不是。

最后，这是我的问题：
当屏幕在插入/删除后返回表格时，UITableView 暂时不会选择任何单元格或直到滚动。

我尝试在 viewDidAppear 中手动滚动表格视图，但没有帮助。我还尝试过 reloadData、戳 refreshControl、禁用和启用 userInteraction、allowsSelection 和 allowSelectionDuringEdit。
我今天花了几个小时在网上搜索其他解决方案，但找不到任何可行的方法。

为了完整起见，这里是委托方法：

```
- (void)taskDefinitionEditor:(id)sender didCreate:(TaskDefinitionEntity *)taskDefinition {
    //remote call
    [self.dataProvider createTaskDefinition:taskDefinition success:^(TaskDefinitionEntity *taskDefinition){
        NSMutableArray *mutableDefinitions = self.taskDefinitions.mutableCopy;
        [mutableDefinitions addObject:taskDefinition];
        self.taskDefinitions = mutableDefinitions;

        dispatch_async(dispatch_get_main_queue(), ^{
            [self.tableView insertRowsAtIndexPaths:@[[NSIndexPath indexPathForRow:mutableDefinitions.count-1 inSection:0]] withRowAnimation:UITableViewRowAnimationAutomatic];
        });
    } failure:^(NSError *error){
        NSLog(@"error creating task-definition:\n%@", error);
        [self requestFailed:error showAlert:YES];
    }];
}

- (void)taskDefinitionEditor:(id)sender didDelete:(TaskDefinitionEntity *)taskDefinition {
    //remote call
    [self.dataProvider deleteTaskDefinition:taskDefinition success:^(void){
        NSMutableArray *mutableDefinitions = self.taskDefinitions.mutableCopy;
        NSInteger index = [self.taskDefinitions indexOfObject:taskDefinition];

        [mutableDefinitions removeObjectAtIndex:index];

        self.taskDefinitions = mutableDefinitions;

        dispatch_async(dispatch_get_main_queue(), ^{
            [self.tableView deleteRowsAtIndexPaths:@[[NSIndexPath indexPathForRow:index inSection:0]] withRowAnimation:UITableViewRowAnimationAutomatic];
        });
    } failure:^(NSError *error){
        NSLog(@"error deleting task-definition:\n%@", error);
        [self requestFailed:error showAlert:YES];
    }];
} 
```

所以他们基本上只是对服务器进行远程调用，接收更新的对象并将其插入/删除表视图和数据源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T09:57:22.223

问题是在后台运行的缓存更新。它包含一个通知来通知控制器更新的数据，然后重新加载 tableView。

此重新加载是在后台线程中触发的，因此 UI 仍然没有响应。我已经用`performSelectorOnMainThread`.

我通过设置调试器来观察控制器的数据模型属性发现了这一点。

很抱歉浪费您的时间，@MySpecialPurpose，并感谢您的建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:32:43.273

您是否尝试过将 insertrows:/deleterows: 方法调用从调度队列中拉出？

# c# - 使用 HtmlAgilityPack 选择内部/子元素

> ID：14711372
> 
> 赞同：0
> 
> 时间：2013-02-05T15:48:05.970
> 
> 标签：c#, html-parsing, html-agility-pack

我想从这个 html-snippet 中提取这两个源属性：

```
<audio controls>
<source src="horse.mp3" type="audio/mpeg">
<source src="horse.ogg" type="audio/ogg">
<embed height="50" width="100" src="horse.mp3">
</audio> 
```

这是我所做的：

首先，我提取所有音频标签（包括您在上面看到的那个）：

```
var audio_tags = HtmlDoc.DocumentNode.SelectNodes("//" + HTML.TAG_AUDIO); 
```

之后，我尝试使用这段代码从 HtmlNodeCollection audio_tags 中提取源元素：

```
foreach (HtmlNode link in audio_tags)
        {
            if (link != null)
            {
                string url;
                string type;
                // select all source tags, see here for an example: http://www.w3schools.com/html/html_sounds.asp
                if(link.HasChildNodes)
                {
                    var children = link.ChildNodes;
                    if (children != null)
                    {
                        foreach (HtmlNode child in children)
                        {
                            Console.WriteLine(children[0].GetAttributeValue("type", "err").ToString() + "||" + children[0].OriginalName);
                            Console.WriteLine(children[1].GetAttributeValue("type", "errrr").ToString() + "||" + children[1].OriginalName);
 ... 
```

写入行表明第一个元素不存在，因为打印了“err”。但它应该是第一个源元素。我会很高兴有一些提示。

编辑：

这些写入的输出是：

```
 err||#text
 audio/mpeg||source 
```

和nr。儿童元素的数量为 2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:40:44.303

第一个问题是您的`<source>`标签未关闭。AgilityPack 以这样的方式自动关闭它，即第二个`<source>`和`<embed>`标签位于第一个`<source>`标签内。但 AgilityPack*知道*这`<embed>`是一个自闭合标签。幸运的是，有一种方法可以说，您希望将标签视为自闭合标签：

```
HtmlNode.ElementsFlags.Add("source", HtmlElementFlag.Empty); 
```

第二个问题是文本节点。每个换行符/空格序列都被转换为文本节点。我假设你想摆脱它们，所以这些节点可能会被跳过。

最后一个，您可以通过将 LINQ 或 xpath 与 AgilityPack 结合使用来提高代码的可读性。这是一个例子：

```
doc.LoadHtml(html);
doc.DocumentNode
    .Descendants("audio")
    .SelectMany(a =>
        a.ChildNodes.Where(n => n.GetType() != typeof(HtmlTextNode))
    ).ToList()
    .ForEach(n => 
        Console.WriteLine("{0}||{1}", n.GetAttributeValue("type", "err"), n.OriginalName)
    ); 
```

这会让你得到类似的东西：

```
audio/mpeg||source 
audio/ogg||source 
err||embed 
```

# python - 拍照 opencv + python 3.3

> ID：14711374
> 
> 赞同：1
> 
> 时间：2013-02-05T15:48:08.373
> 
> 标签：python, opencv

我想在用户按“s”时拍照。这是我的代码，我不知道为什么它是错误的。

```
import cv
import sys

win = 'Camera'
cv.NamedWindow(win)
cap = cv.CreateCameraCapture(0)

while cv.WaitKey(1) != 27:
img = cv.QueryFrame(cap)

cv.ShowImage(win, img)
if cv.WaitKey(10) == 115:
cv.SaveImage('test1.jpg', img) 
```

错误说：

文件“dos.py”，第 14 行 cv.SaveImage('test1.jpg', img) ^ IndentationError: expected an indented block

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T17:13:31.240

由于您没有告诉我们问题出在哪里，我猜测相机无法初始化。

明显的[问题](https://stackoverflow.com/a/8919567/176769)是......您需要**安全地开始编码**！尽可能测试调用的返回：

```
cap = cv.CreateCameraCapture(0)
if not cap:
    print("!!! Failed CreateCameraCapture: invalid parameter!") 
```

**编辑：**

既然您已经分享了问题所在，我建议您缩进代码，因为[Python 使用代码的缩进](http://www.diveintopython.net/getting_to_know_python/indenting_code.html)来确定代码块的开始和结束位置。

您还可以使用双引号指定文件名：

```
if cv.WaitKey(10) == 115:
    cv.SaveImage("test1.jpg", img) 
```

# android - 安卓充电动画

> ID：14711378
> 
> 赞同：2
> 
> 时间：2013-02-05T15:48:12.977
> 
> 标签：android, android-animation, battery

嗨，我正在定制一个 android 手机平板电脑 7" android 4.0.4，我想知道如何更改充电动画以及它的位置...任何想法通用 android 有这些吗？谢谢，我会感谢任何帮助实际上我已经更改了所有这些：boot_logo、bootanimation、battery.bmp 和 low_battery.bmp，所以我想知道在 android 上是否存在诸如charging_animation.zip 或charginganimation.zip 之类的东西。

谢谢。

格斯。

非常感谢任何指向情感教程的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:55:42.567

您必须为此更改其中一个系统应用程序。

也许[这](http://forum.xda-developers.com/showthread.php?t=1823223)可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-18T14:22:26.460

是的，您可以在系统应用程序中更改其不是 zip 或位置..

在 mtk 设备中，您可以转到那里的闪烁文件中的徽标 bin 提取徽标 bin 在那里您将找到所有电池图像

您可以使用 abode Photoshop 或 illustrator 进行自定义

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-27T00:19:29.563

在您的设备植根后，将动画文件添加到：

```
/system/media/charging 
```

# sql - 如何通过加载不同的包配置文件来运行 SSIS 包？

> ID：14711381
> 
> 赞同：0
> 
> 时间：2013-02-05T15:48:28.050
> 
> 标签：sql, ssis

在 SSIS 2008 中，是否可以从单独的`dtsconfig`文件创建多个 Configuration Manager 配置？

如果是这样，我不确定在哪里创建连接。原因是我们有一个测试集群和一个实时集群。我希望能够选择`development`或`production`配置以便在单独的集群上运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T17:42:49.230

您可以使用在 dtexec 参数中指定 dtsconfig 文件路径`/CONFIGFILE "Drive:\Path\To\Your\Config.dtsConfig"`

例如 ：

```
dtexec /FILE "C:\Ssis\MyPackage.dtsx" /CONFIGFILE "C:\Ssis\MyPackage.dtsConfig" 
```

# php - 登录帖子错误

> ID：14711386
> 
> 赞同：0
> 
> 时间：2013-02-05T15:48:36.857
> 
> 标签：php, html, xml

我正在寻找一种方法来检查用户是否在登录脚本中输入了某些内容。我试过 `if (!empty($_POST))` 了，但是这个方法失败了。由于我是 php 新手，我不确定要使用什么其他干净的方法。

```
<?php
    if ( !empty($post)){
    header("Location:login.php");
    echo"Invalid Username or Password";
    }
?>
<html>
    <head>
        <title>Administrator Login Page</title>
        <style type="text/css">
            @import "style.css";
        </style>
    </head>
    <body>
        <h1>Administrator Login Page</h1>
        </br></br></br></br></br></br></br>
        <form action="admin_verify.php" method="post">
            User Name:
            <input type="text" name="admin_name" />
            </br></br>
            Password:&nbsp;&nbsp;
            <input type="password" name="admin_password" />
            </br></br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="submit" value="Login"/>
            <input type="reset" value="Reset"/>
        </form>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:52:25.270

你应该把这段代码放在`admin_verify.php`not in`login.php`

```
<?php
    if ( !empty($post)){
        header("Location:login.php");
        exit;        
    }
?> 
```

更好的是，您应该检查所有输入或不输入的字段

```
if( !isset($_POST['admin_name'], $_POST['admin_password'] )) {
     header("Location:login.php");
     exit; 
} 
```

如果您想将一些消息发送回登录页面，您可以在 get 参数中发送该消息或使用会话

```
header("Location:login.php?msg=Invalid Username or Password");
exit; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:53:44.797

您可能希望在此页面上检查用户名和密码，而不是简单地检查表格是否已填写。如果您想保留它`login.php`，请将内容保存`$_POST`到`$_SESSION`.

```
<?php
if (!empty($_POST)){
    if (strlen($_POST["admin_name"]) > 0 && strlen($_POST["admin_password"]) > 0) {
        header("Location:login.php");
        exit;
    } else {
        $not_filled = true;
    }
}
?>
<html>
<head>
<title>Administrator Login Page</title>
<style type="text/css">
@import "style.css";
</style>
</head>
<body>
<h1>Administrator Login Page</h1>
</br></br></br></br></br></br></br>
<?php if ($not_filled) echo"Invalid Username or Password"; ?>
<form action="admin_verify.php" method="post">
User Name: <input type="text" name="admin_name" />
</br></br>
Password:&nbsp;&nbsp; <input type="password" name="admin_password" />
</br></br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <input type="submit" value="Login"/>
    <input type="reset" value="Reset"/>
</form>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T15:55:20.600

尝试

```
if((isset($_POST['admin_name']) && isset($_POST['admin_password']))
{
   //INSTRUCTION
} 
```

# php - 拆分不均匀字符串变量值的最快方法是什么

> ID：14711390
> 
> 赞同：0
> 
> 时间：2013-02-05T15:48:44.823
> 
> 标签：php, performance, parsing, html-parsing

我必须拆分这些字符串值，什么是拆分它的最佳算法。

字符串变化为

```
$string=X-1, Sector -12, Dhaka-131301 Landline: +(93)-(220)-5533491, 4390666 Email: sample@tesrting.com

$string =C-1, Sector -00, Dhaka-131301 Landline: 5533491, 4390666 Mobile : 9999999999 Email: sample2@tesrting.com

$string =XC, Sector -12, Dhaka-131301 Mobile: 90909090909 
```

我的代码是

```
$landlinenumber=array("","","","","");
$address=array("","","","","");
$pincode="";

$ldm=explode('Email:',$string,2);
$ema=$ldm[1];

$ldm=explode('Landline',$ema[0],2);

$adss=explode(',',$ldm[0]);
for($inm=0;$inm<sizeof($adss);$inm++)
{
$pins=trim($adss[$inm]);
$m=preg_match('/[0-9]{6}/', $pins, $matches);
if($m)
{
    $pincode=$matches[0];
    continue;
}
$address[$inm]=$adss[$inm];
}

$ld=explode(':',$ldm[1],2);

if(strpos($ld[1],','))
{
$nums=explode(',',$ld[1]);
for($inm=0;$inm<sizeof($nums);$inm++)
{
    $landlinenumber[$inm]=$nums[$inm];
}

}
elseif(strpos($ld[1],'/'))
{
$nums=explode('/',$ld[1]);
for($inm=0;$inm<sizeof($nums);$inm++)
{
    $landlinenumber[$inm]=$nums[$inm];
}
}
else
{
$landlinenumber[$inm]=$ld[1];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:02:27.180

如

```
$string="X-1, Sector -12, Dhaka-131301 Landline: +(93)-(220)-5533491, 4390666 Email: sample@tesrting.com";
testparse( $string );
$string="C-1, Sector -00, Dhaka-131301 Landline: 5533491, 4390666 Mobile : 9999999999 Email: sample2@tesrting.com";
testparse( $string );
$string="XC, Sector -12, Dhaka-131301 Mobile: 90909090909";
testparse( $string );

exit;

function testparse( $str )
{
    if( preg_match('/^(.*), Sector (-[0-9][0-9]), Dhaka-([0-9]+) Landline: (.*) Mobile : ([0-9]+) Email: (.*)$/', $str, $regs ))
        $res = array_combine( array('line', 'code', 'sector','dhaka','landlines','mobile','email'), $regs);
    else if( preg_match('/^(.*), Sector (-[0-9][0-9]), Dhaka-([0-9]+) Landline: (.*) Email: (.*)$/', $str, $regs ))
        $res = array_combine( array('line', 'code', 'sector','dhaka','landlines','email'), $regs );
    else if( preg_match('/^(.*), Sector (-[0-9][0-9]), Dhaka-([0-9]+) Mobile: ([0-9]+)$/', $str, $regs ))
        $res = array_combine( array('line', 'code', 'sector','dhaka','mobile'), $regs );
    else
        die("Unable to compute:\n$str\n");

    echo "Got: ";
    var_export( $res );
    return $res;
} 
```

请注意第三个字符串在 Mobile 和冒号之间缺少空格。

# wpf - 使用 FocusManager、ContentControl 和 DataTemplate 聚焦

> ID：14711391
> 
> 赞同：0
> 
> 时间：2013-02-05T15:48:49.783
> 
> 标签：wpf, focus, datatemplate, focusmanager

我正在尝试使用以下结构的应用程序使（键盘）焦点正常工作：

```
ItemsControl
  DataTemplate for Item
    ContentControl
      DataTemplate for Content (multiple, depending on type)
        Some container
          Different controls (mainly textbox or OK button should have focus) 
```

在每个内容模板（“某个容器”）的根目录上，我`FocusManager.FocusedElement`在模板中设置了一个控件。在 ItemsControl 中的所有项目中，只有一个 ContentControls 是实际可见的（“当前”一个）。所以，基本上，我让第一件事可见，其中的 OK 按钮有焦点，用户可以按 Enter 确认。然后隐藏这个，显示下一个，并且它的主控件（例如文本框）有焦点，用户可以按回车确认（小事件处理使在文本框中回车确认项目）等等。

一切完成后，用户可以单击工具栏中的按钮重新开始，使第一个 ContentControl 再次可见。但这一次它没有焦点。我不知道谁有重点，我希望它像一开始那样工作。我试图将焦点设置到刚刚显示的 ContentControl （它有效，通过虚线可见），但它不会将焦点设置为它的孩子。由于我不知道选择了哪个数据模板（好吧，不是没有编写特殊代码），我不能只是手动设置焦点或通过绑定到孩子。也许我在这一点上错过了一件简单的事情？

另一方面，当用户手动单击活动的 ContentControl 按钮或文本框时，他可以通过 enter 确认，但 ItemsControl 似乎有焦点，而不是下一个项目。我只是无法理解这个焦点问题。有简单的解决方案吗？我是否必须编写代码来遍历 ContentControl 中的树以获得正确的数据模板？然后，我可以以某种方式关注数据模板或设置为 FocusedElement 的控件，还是必须分别为每个数据模板编写代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T08:02:24.933

您应该实现一个可以在需要时从 ViewModel 触发到焦点元素的操作。试试这个代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Interactivity;
using System.Windows;

namespace Behaviors
{
    /// <summary>
    /// Action to focus target element, if invoked when target is not yet specified, will focus once the target is set
    /// </summary>
    public class FocusAction : TargetedTriggerAction<DependencyObject>
    {
        protected override void OnAttached()
        {
            base.OnAttached();
        }
        protected override void OnDetaching()
        {
            base.OnDetaching();
        }
        protected override void Invoke(object parameter)
        {
            if (Target is UIElement)
            {
                if(!((UIElement)Target).IsKeyboardFocusWithin)
                    ((UIElement)Target).Focus();
            }
            else
                invokeOnConnect = true;
        }
        private bool invokeOnConnect = false;
        protected override void OnTargetChanged(DependencyObject oldTarget, DependencyObject newTarget)
        {
            base.OnTargetChanged(oldTarget, newTarget);
            if (invokeOnConnect)
            {
                invokeOnConnect = false;
                Invoke(null);
            }
        }
    }
} 
```

然后在 WPF 中：

```
<DockPanel>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Loaded">
            <nuib:FocusAction TargetName="title"/>
            </i:EventTrigger>
        <TextBlock x:Name="title"/>
</DockPanel> 
```

命名空间是：

```
xmlns:nuib="clr-namespace:Behaviors;assembly=Nui" // for Action class
xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity" // .net library for interactivity 
```

# c - 从套接字描述符获取IP地址？

> ID：14711392
> 
> 赞同：7
> 
> 时间：2013-02-05T15:49:02.440
> 
> 标签：c, sockets, network-programming, ip

我打开了一个 TCP 套接字服务器（我省略了一些东西，取自[这里](http://beej.us/guide/bgnet/output/html/multipage/clientserver.html#simpleserver)

```
sockfd = socket(p->ai_family, p->ai_socktype,
            p->ai_protocol)) 
```

是否可以从 sockfd 获取服务器的 IP 地址？如果不是我应该去哪里看？

编辑：我想知道服务器的地址（这是在任何客户端连接之前）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-05T15:56:20.303

如果您想知道套接字的另一端是谁，您可以在 Linux中使用[getpeername 。](http://linux.die.net/man/3/getpeername)[getsockname](http://linux.die.net/man/3/getsockname)会告诉你你是谁。[不过，您可以在绑定](http://linux.die.net/man/3/bind)时决定您希望服务器最初位于哪个地址。

您可能还会发现这个 SO 问题很有用：[将套接字绑定到网络接口](https://stackoverflow.com/questions/14478167/bind-socket-to-network-interface)

以及 W. Richard Stevens 所著的“Unix Network Programming, vol 1”一书。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T16:10:25.123

在客户端连接之前，您不能使用套接字获取服务器的地址，因为它是未知的。

原则上，一个主机可能有多个 IP。用于连接到服务器的 IP 是属于接口的 IP，连接通过该接口到达。在连接到达之前，它是未知的。
即使您只有一个 IP，连接也可能来自机器内部，在这种情况下，地址将是`127.0.0.1`.

所以监听套接字没有关于IP的信息。
您需要找到机器有哪些接口，以及它们的 IP 是什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T16:08:16.427

服务器的地址由您决定。

取决于传递给`bind()`函数的参数。

您可以指定`single ip`或绑定您的套接字到主机的每个地址。

查看[绑定手册页](http://linux.die.net/man/2/bind)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T17:50:11.923

服务器的地址是传递给成功调用的地址`bind()`（如您链接的源代码所示）。

# c# - 仅限于特定时间和日期的日期/时间下拉列表

> ID：14711393
> 
> 赞同：0
> 
> 时间：2013-02-05T15:49:06.230
> 
> 标签：c#, .net, visual-studio

我想知道是否有任何方法可以在 asp .net 中创建一个下拉列表，该下拉列表将具有日期/时间选择器或列表中的特定日期和时间列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:57:00.840

试试[Ajax 工具包 - 日历](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/Calendar/Calendar.aspx)。我认为它是你需要的。我不确定它是否有时间。

# jpa - 在 eclipse jun 中看不到 DB2 ex-c 的模式，但我可以用刮书查询

> ID：14711396
> 
> 赞同：4
> 
> 时间：2013-02-05T15:49:09.100
> 
> 标签：jpa, db2, java-ee-6, eclipse-juno

StackOverflow，我需要你的帮助。

我正在开发 J EE 应用程序，但遇到了障碍。我目前正在设置我的环境，以便在带有*Eclipse Juno J EE*版本的*Windows 7上使用**IBM DB2 Express-C*和 WASCE 。两种技术都运行良好，我可以通过浏览器访问 WASCE，我可以通过*Data Studio 3.1.1访问我的**DB2*实例，我可以访问现有数据库并创建模式、表、执行查询......

 ***当我尝试通过 Eclipse 创建数据连接配置文件以便我可以使用*JPA*工具对架构进行逆向工程时，我的问题就出现了。`db2jcc.jar`因此，我使用 Ex-c ( , `db2jcc_license_cu.jar`) 中的 Jars 和以下属性创建了一个连接配置文件：

```
Connection URL: jdbc:db2://localhost:50000/DBNAME
Database Name: DBNAME
Driver Class: com.ibm.db2.jcc.DB2Driver
Password: ****
User ID: USERNAME

Test Connection Result: "Ping Succeeded!" 
```

因此，我单击确定，现在已建立连接配置文件。所以，我点击twisty并看到DBNAME，点击DBNAME，点击Catalogs，点击DBNAME，点击Schemas ...

没别的了！

我打开 SQL Scrapbook，执行一个简单的查询：“Select * from schema.table”，然后我得到了结果，这是我通过 Data Studio 放入数据库的正确数据。

所以，我尝试使用 JPA 工具，就像我猜的那样，它没有通过连接配置文件注册任何表，所以它不起作用。此外，在建立 JPA 时，我的实体（手工制作）对我大喊大叫，因为它说表不存在，并且字段不对应。或类似的东西。

我需要您的帮助来通过 Eclipse Juno Java EE 和 DB2 Exc 建立正确的连接配置文件！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-21T16:49:58.237

由于关闭了此错误，该问题可能会得到解决：

错误 416722 – 自 db2 V9.7 FP6 起无法查看模式：[https ://bugs.eclipse.org/bugs/show_bug.cgi?id=416722](https://bugs.eclipse.org/bugs/show_bug.cgi?id=416722)

根据错误报告，此功能应该在即将发布的 DTP 1.11.2 中。DPT 1.11.2 里程碑的更新 URL 是：

[http://download.eclipse.org/datatools/downloads/drops/M_updates_1.11.2](http://download.eclipse.org/datatools/downloads/drops/M_updates_1.11.2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-29T13:46:33.070

我在使用 Eclipse Kepler 时遇到了同样的问题。在 Eclipse 中，转到帮助 > 安装新软件。在 Work with: 中粘贴地址[http://download.eclipse.org/datatools/downloads/drops/M_updates_1.11.2/](http://download.eclipse.org/datatools/downloads/drops/M_updates_1.11.2/)并完成其余过程。这解决了我的问题。***

# javascript - 使用 Jquery 更改我的下拉列表的选定索引

> ID：14711397
> 
> 赞同：4
> 
> 时间：2013-02-05T15:49:11.993
> 
> 标签：javascript, jquery, html-select

大家好，我正在尝试更改一个下拉列表选择的索引，一旦另一个更改，我想使用 jquery 来选择下拉列表。这是我的一些代码：

```
<div id = "monthlist">
<select name = "months">
   <option value = 1 > January </option>
   <option value = 2 > Febuary </option>
   <option value = 3 > March </option>
   <option value = 4 > April </option>
   <option value = 5 > May </option>
   <option value = 6 > June </option>
   <option value = 7 > July </option>
   <option value = 8 > August </option>
   <option value = 9 > September </option>
   <option value = 10 > October</option>
   <option value = 11 > November </option>
   <option value = 12 > December </option>
   </select>
   </div>

   <div id = "yearlist">
   <select name = "years">
   <option value = 1993 > 1993 </option>
   <option value = 1994 > 1994 </option>
   <option value = 1995 > 1995 </option>
   <option value = 1996 > 1996 </option>
   <option value = 1997 > 1997 </option>
   <option value = 1998 > 1998 </option>
   <option value = 1999 > 1999 </option>
   <option value = 2000 > 2000 </option>
   <option value = 2001 > 2001 </option>
   </select>
   </div> 
```

JQuery 代码在这里：

```
$("#monthlist").change(function(){

        $("select#yearlist").prop('selectedIndex', 2);
    }); 
```

一旦更改了月列表下拉列表，我想将“年列表”的选定索引设置为特定索引。但是我的选择器或我的代码不正确，任何建议或提示将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T15:59:48.213

您正在尝试按名称选择月份和年份列表。改为使用外部 div 的 ID...

```
$("div#monthlist select").change(function(){
    $("div#yearlist select")[0].selectedIndex = 2;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:52:46.637

是你在找吗？？

```
$("#monthlist").change(function(){
    $("#yearlist").get(0).selectedIndex = 2; 
} 
```

并更正您的情况：

```
$("#monthlist").change(function(){
    $("select#yearlist").attr('selectedIndex', 2);
} 
```

以及索引的另一种选择

```
$("#monthlist").change(function(){
    $('#yearlist option').eq(2).attr('selected', 'selected');
} 
```

# ruby-on-rails - 为什么这种“添加索引迁移”不起作用？

> ID：14711400
> 
> 赞同：0
> 
> 时间：2013-02-05T15:49:13.657
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我做`bundle exec rake db:migrate`了下面的迁移文件。

在终端上它看起来像这样成功

```
==  AddIndexToCommunity: migrating ============================================
-- add_index(:communities, [:community_name, :title, :user_id], {:name=>:communities_idx})
   -> 0.0452s
==  AddIndexToCommunity: migrated (0.0456s) =================================== 
```

但是，如果我查看 phpMyAdmin 的 Structure 部分，它不会显示此迁移生成的索引。
为什么？

**迁移文件**

```
class AddIndexToCommunity < ActiveRecord::Migration
  def self.up
    add_index :communities, [:community_name, :title, :user_id], :name=>:communities_idx
  end

  def self.down
    remove_index :communities, [:community_name, :title, :user_id], :name=>:communities_idx
  end
end 
```

# iphone - 没有子类化的 UINavigationBar 颜色变化和阴影去除？

> ID：14711406
> 
> 赞同：0
> 
> 时间：2013-02-05T15:49:27.187
> 
> 标签：iphone, ios, objective-c, xcode, uinavigationbar

我想将 UINavigationBar 的颜色更改为我选择的纯色。在 IB 中，我为 Background 和 Tint 属性添加了纯色。但是，栏的正下方有一个阴影。如何在不继承 UINavigationBar 的情况下将其删除？如果没有，那么如何子类化呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:01:05.690

我最终像这样子类化 UINavigationBar：

```
#import <UIKit/UIKit.h>

@interface MyNavigationBar : UINavigationBar <UINavigationBarDelegate> {

}

@end 
```

在 .M 文件中我覆盖了这个

```
- (void)drawRect:(CGRect)rect {
 UIColor * color = [UIColor colorWithRed:255/255.0f green:255/255.0f blue:255/255.0f alpha:1.0f];
 CGContextRef context = UIGraphicsGetCurrentContext();
 CGContextSetFillColor(context, CGColorGetComponents( [color CGColor]));
 CGContextFillRect(context, rect);
} 
```

注意：由于某种原因，我无法使用 [UIColor whiteColor] - 它默认为黑色，所以我最终使用 colorWithRed:green:blue: 代替。

它对我来说效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T06:25:16.687

您可以将 UINavigationBar 的 shadowImage 设置为 [[UIImage alloc] init] 以移除阴影。不过，这仅适用于 iOS 5.0+。

# django - Django：从 sqlite3 到 Postgres 的“冲突 NULL/NOT NULL 声明”

> ID：14711407
> 
> 赞同：0
> 
> 时间：2013-02-05T15:49:27.603
> 
> 标签：django, sqlite, postgresql, django-south

我一直在使用 Django 项目开发 sqlite3 数据库。我正在将项目移动到使用 Postgres 的生产环境中。我用过 South，所以我的所有迁移都是自动化的。

我在尝试迁移架构时遇到以下错误：

```
[05/Feb/2013 16:38:31] DEBUG [south:270] execute "ALTER TABLE "frontend_userprofile" ADD COLUMN "id" serial NULL PRIMARY KEY;" with params "[]"
FATAL ERROR - The following SQL query failed: ALTER TABLE "frontend_userprofile" ADD COLUMN "id" serial NULL PRIMARY KEY;
The error was: conflicting NULL/NOT NULL declarations for column "id" of table "frontend_userprofile"

[..]

django.db.utils.DatabaseError: conflicting NULL/NOT NULL declarations for column "id" of table "frontend_userprofile" 
```

这是迁移文件的相关部分：

```
def forwards(self, orm):
    # Adding field 'UserProfile.id'
    db.add_column('frontend_userprofile', 'id',
                  self.gf('django.db.models.fields.AutoField')(default=None, primary_key=True, null=True),
                  keep_default=False)

    # Changing field 'UserProfile.user'
    db.alter_column('frontend_userprofile', 'user_id', self.gf('django.db.models.fields.related.OneToOneField')(to=orm['auth.User'], unique=True, null=True))

[..]

    'frontend.userprofile': {
        'Meta': {'object_name': 'UserProfile'},
        'company': ('django.db.models.fields.related.ForeignKey', [], {'default': 'None', 'to': "orm['frontend.Company']", 'null': 'True'}),
        'id': ('django.db.models.fields.AutoField', [], {'primary_key': 'True'}),
        'user': ('django.db.models.fields.related.OneToOneField', [], {'to': "orm['auth.User']", 'unique': 'True', 'null': 'True'})
    } 
```

和模型：

```
class UserProfile(models.Model):
    user    = models.OneToOneField(User, null=True, unique=True)
    company = models.ForeignKey(Company, null=True, default=None) 
```

**编辑**

正如 Jordan 所建议的，您不能同时拥有空主键，因此以下更改可以解决此问题：

```
 db.add_column('frontend_userprofile', 'id',
                  self.gf('django.db.models.fields.AutoField')(default=None, primary_key=True),
                  keep_default=False)

class UserProfile(models.Model):
    user    = models.OneToOneField(User, unique=True)
    company = models.ForeignKey(Company, null=True, default=None) 
```

但是我在完成迁移时仍然遇到问题：

```
DEBUG [south:270] execute "ALTER TABLE "frontend_userprofile" ADD COLUMN "id" serial NOT NULL PRIMARY KEY;" with params "[]"
FATAL ERROR - The following SQL query failed: ALTER TABLE "frontend_userprofile" ADD COLUMN "id" serial NOT NULL PRIMARY KEY;
The error was: multiple primary keys for table "frontend_userprofile" are not allowed

django.db.utils.DatabaseError: multiple primary keys for table "frontend_userprofile" are not allowed 
```

我认为原因是在以前的迁移`user_id`中已设置为主键，现在它正试图添加`id`为主键。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:52:33.897

据我所知，您不能拥有 NULL 主键。那会很糟糕。

我建议删除该迁移中显示 Null=True 的部分，然后重试。

# c - 编译器警告 - 从指针转换为不同大小的整数

> ID：14711409
> 
> 赞同：6
> 
> 时间：2013-02-05T15:49:36.233
> 
> 标签：c, generics

我正在尝试创建一个可以保存通用值的结构。下面的代码有效，但我收到关于从指针转换为整数的编译器警告。这是在 64 位系统上。

```
struct node
{
    void *key;
    void *value;
};

void insert(struct node *ht, void *key, void *value)
{
    ht->key = key;
    ht->value = value;
    return;
}

int main()
{
    struct node *t = (struct node *)malloc(sizeof(struct node));
    insert(t, (void *)3, (void *)5);
    printf("[%d]->[%d]\n", (int)t->key,(int)t->value);
    free(t);
    return 0;
} 
```

我什至不确定这是否是正确的方法。我有点破解它。请让我知道是否有适当的方法来做到这一点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T15:54:53.770

编译器会尝试警告您在从`void *`to转换时丢失位`int`。它不知道这`void *`实际上是一个`int`演员表，所以丢失的位是没有意义的。

双重演员可以解决这个问题`(int)(uintptr_t)t->key`。
它首先转换`void *`为`uintptr_t`（相同大小，无警告），然后`uintptr_t`转换为`int`（数字到数字，无警告）。
您需要包含`<stdint.h>`类型`uintptr_t`（与指针大小相同的整数类型）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T16:57:33.823

需要记住的一件事是，在 64 位系统中，指针是 64 位值 [内存地址]。

int 只是一个 32 位的值，无论您使用什么架构。每当您尝试将 64 位值分配给 32 位值而不显式转换它时，编译器都会抛出警告 [授予，它仍然可以工作，但通常不是好的做法。]

如果您不反对使用无符号整数，则使用 uint_64t 或类似的东西可能会更容易，这将避免 64 位到 32 位的赋值（uint_64t 是无符号的 64 位整数）

希望有帮助。

你可以做的一件事是：

```
int key = 3;
int value = 5;
insert(t, (void *) &key, (void *) &value);
printf("[%d]->[%d]\n", (int) *(t->key), (int) *(t->value)); 
```

但是，在做这样的事情时要非常小心。除非您可以保证设置了指针并且它的值/类型不变，否则不可能绝对知道该指针存储的值是什么。除非您添加一个枚举字段或存储存储在指针位置的值类型的东西——但这违背了目的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T16:50:10.757

您发布的代码有很多问题。

第一的：

```
printf("[%d]->[%d]\n", (int)t->key,(int)t->value); 
```

打印指针时，打印指针。使用 %p。看这里：

[http://www.cplusplus.com/reference/cstdio/printf/](http://www.cplusplus.com/reference/cstdio/printf/)

第二：

```
insert(t, (void *)3, (void *)5); 
```

我不确定您期望发生什么，但您存储的是地址而不是值。（即，您将键设置为指向地址 3 内容的指针，并将值设置为指向地址 5 内容的指针）。

第三：

```
struct node *t = (struct node *)malloc(sizeof(struct node)); 
```

在这里，您已经分配了节点，但还没有分配任何东西来保存内容。您的节点仅包含一些指针（地址），它不包含任何值。我不确定这是否是你想要的。

最后，您的编译器正确地警告您。您有可能会失去精确度。就像@JonathanLeffler 所说，使用 uintptr_t。

# c++ - 使用 boost 优化/检查绘制随机数

> ID：14711412
> 
> 赞同：0
> 
> 时间：2013-02-05T15:49:58.643
> 
> 标签：c++, boost, boost-random

我已经完成了 Boost 的安装，并且（终于）在我的程序中使用了它。我想要的是能够生成

1.  在 0 和 1 之间随机分布的数字
2.  标准差为 1 的正态分布数

我通过以下头文件实现了这一点：

```
#include <boost/random/normal_distribution.hpp>
#include <boost/random/uniform_real.hpp>
#include <boost/random/mersenne_twister.hpp>
#include <boost/random/variate_generator.hpp>

boost::mt19937 rng;

boost::normal_distribution<double> nd(0.0, 1.0);
boost::variate_generator< boost::mt19937, boost::normal_distribution<double> > normal(rng, nd);

boost::uniform_real<float> ur(0.0, 1.0);
boost::variate_generator< boost::mt19937, boost::uniform_real<float> > uniform(rng, ur); 
```

我有两个问题：

1.  我的方法正确吗？到目前为止，我得到了想要的行为似乎是一致的，而且其他人似乎也这样做了
2.  我需要模拟一个非常大的样本，因此我需要非常多的随机数，远远大于 10^9。有没有比我简单地调用 uniform() 和 normal() 的方法更有效的方法来实现这一点？

# iis-7 - ASP.NET MVC4 不在 IIS7 集成模式下处理 POST 请求，而是在 IIS7.5 中

> ID：14711414
> 
> 赞同：13
> 
> 时间：2013-02-05T15:50:04.817
> 
> 标签：iis-7, asp.net-mvc-4, iis-7.5

我有一个我无法解释的有趣案例，我需要帮助找出我在 IIS7 上的问题：

鉴于：

*   ASP.NET MVC 4 Web 应用程序
*   注册到 {controller}/{action} 的默认路由

请参阅以下控制器：

```
public class ServiceController : Controller
{
    public ActionResult Test()
    {
        return Content("Test");
    }

    [HttpPost]
    public ActionResult Test2()
    {
        return Content("Test2");
    }
} 
```

此外，在 Global.asax 中有以下代码：

```
protected void Application_EndRequest()
{
    if (Context.Response.StatusCode == 404)
    {
        ExecuteIndexPage();
    }
}

protected void Application_Error(object sender, EventArgs e)
{
    var error = Server.GetLastError();
    ExceptionLogger.Log(error);

    ExecuteIndexPage();
} 
```

因此，每当出现服务器错误时，都会记录下来。在这种情况下以及在正常 404 的情况下，将返回起始页。这（几乎）工作得很好。稍后再说。

此设置在 IIS7（Windows Server 2008，生产环境）和 IIS7.5（Win7 Pro，开发环境和 Windows Server 2008 R2，也是生产环境）上提供了非常不同的行为。

给定 IIS 中的以下配置（两个版本）：

*   IIS 中的 Web 使用**集成模式**ASP.NET 4 应用程序池进行配置
*   <modules runAllManagedModulesForAllRequests="true" /> 在 system.webServer 部分设置

在**IIS 7.5**中，行为是：

*   GET请求到/：返回索引页面
*   对 / 的 POST 请求：返回索引页
*   对 /Service/Test 的 GET 请求：返回*Test*
*   对 /Service/Test 的 POST 请求：返回*Test*
*   对 /Service/Test2 的 GET 请求：执行 Global.asax Application_Error：HttpException：在控制器“MyTestProject.Controllers.ServiceController”上找不到公共操作方法“Test2”。
*   对 /Service/Test2 的 POST 请求：返回*Test2*
*   *对没有*路由的事物的 GET 请求：执行 Global.asax End_Request。

在**IIS 7**中，行为改为：

*   GET请求到/：返回索引页面
*   POST 请求到 /：IIS 404 页面
*   对 /Service/Test 的 GET 请求：返回*测试*
*   对 /Service/Test 的 POST 请求：IIS 404 页面
*   对 /Service/Test2 的 GET 请求：执行 Global.asax Application_Error：HttpException：在控制器“MyTestProject.Controllers.ServiceController”上找不到公共操作方法“Test2”。
*   对 /Service/Test2 的 POST 请求：返回 IIS 404 页面
*   GET请求*没有*路由的东西：IIS 404页面

因此，IIS 7 和 IIS 7.5 在使用 GET 请求时运行良好，除非没有路由。当没有路由时，IIS 7.5 执行带有状态码 404 的 Global.asax 结束请求并传递索引页。IIS 7 不**执行**Global.asax 结束请求。为什么？我可以（并且目前正在）通过注册 {*catchall} 路由来解决此问题，以便存在匹配的路由。

当我尝试使用 HTTP POST 时，IIS 7 的工作量甚至低于我的预期。

发布请求时，IIS 7 不会在我的应用程序中执行任何代码，而是直接返回 IIS 404 页面。

所以我的问题是：为什么 IIS 7 如此难以处理我的 MVC 4 应用程序中的 POST 请求，我该怎么做才能让它也处理 POST 请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-13T12:14:32.903

We figured it out - finally.

The default configuration inserts this in the web.config:

```
<system.webServer>
  <validation validateIntegratedModeConfiguration="false" />
  <modules runAllManagedModulesForAllRequests="true" />
  <handlers>
    <remove name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" />
    <remove name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" />
    <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
    <add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
    <add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness64" responseBufferLimit="0" />
    <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
  </handlers>
</system.webServer> 
```

The problem is the "*." path, which would cover /test.aspx but not simply /test.

If you change this to "*", then all requests will be handled by the ExtensionlessUrlHandler, including those to static files which will not be served anymore.

So the solution is: Remove the POST verb from the handler entries and add new entries for the ExtensionlessUrlHandler with the path set to "*" and only for POST requests:

```
 <add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" path="*." verb="GET,HEAD,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
    <add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" path="*." verb="GET,HEAD,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness64" responseBufferLimit="0" />
    <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
    <add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit_post" path="*" verb="POST" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
    <add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit_post" path="*" verb="POST" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness64" responseBufferLimit="0" />
    <add name="ExtensionlessUrlHandler-Integrated-4.0_post" path="*" verb="POST" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" /> 
```

Ideally remove the ones you don't need (x86 and x64 in classic vs. integrated pipeline).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-21T08:36:13.413

可能 7 和 7.5 路由在将 POST 传递给没有参数可以接受 POST 表单数据的操作方面是不同的。

如果您的代码从未被命中，则表明路由没有找到与签名、参数和内置约束匹配的匹配项，它在移交给代码之前会检查这些约束。

也许下一步是尝试将参数添加到 POST 以接受模型，即使您没有传入该模型。模型显然会因此为空。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-10T21:24:26.510

This might have to do with some features that are not (or not correctly) installed on IIS 7 which prevent extensionless URL's from working correctly.

Please check the following items:

In the "Turn Windows Features On or Off" dialog box of the Windows Control Panel "Programs and Features" application:

1.  Go to Internet Information Services > World Wide Web Services > Common HTTP Features
2.  Make sure that the "HTTP Error Redirection" option is selected.
3.  Make sure that the "Static Content Compression" option is selected. After either option has been selected, click "OK" to save changes.

Reference: [http://support.microsoft.com/kb/2023146](http://support.microsoft.com/kb/2023146)

# solr - 如何在 SOLR 中索引 .html 文件

> ID：14711415
> 
> 赞同：7
> 
> 时间：2013-02-05T15:50:08.903
> 
> 标签：solr, full-text-indexing, dataimporthandler, data-import, solr4

我要做索引的文件存储在服务器上（我不需要爬）。/path/to/files/ 示例 HTML 文件是

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="product_id" content="11"/>
<meta name="assetid" content="10001"/>
<meta name="title" content="title of the article"/>
<meta name="type" content="0xyzb"/>
<meta name="category" content="article category"/>
<meta name="first" content="details of the article"/>

<h4>title of the article</h4>
<p class="link"><a href="#link">How cite the Article</a></p>
<p class="list">
  <span class="listterm">Length: </span>13 to 15 feet<br>
  <span class="listterm">Height to Top of Head: </span>up to 18 feet<br>
  <span class="listterm">Weight: </span>1,200 to 4,300 pounds<br>
  <span class="listterm">Diet: </span>leaves and branches of trees<br>
  <span class="listterm">Number of Young: </span>1<br>
  <span class="listterm">Home: </span>Sahara<br>

</p>
</p> 
```

我在 solrconfing.xml 文件中添加了请求处理程序。

```
<requestHandler name="/dataimport" class="org.apache.solr.handler.dataimport.DataImportHandler">
<lst name="defaults">
  <str name="config">/path/to/data-config.xml</str>
</lst> 
```

我的 data-config.xml 看起来像这样

```
<dataConfig>
<dataSource type="FileDataSource" />
<document>
    <entity name="f" processor="FileListEntityProcessor" baseDir="/path/to html/files/" fileName=".*html" recursive="true" rootEntity="false" dataSource="null">
        <field column="plainText" name="text"/>
    </entity>
</document>
</dataConfig> 
```

我保留了默认的 schema.xml 文件并将以下代码添加到 schema.xml 文件中。

```
 <field name="product_id" type="string" indexed="true" stored="true"/>
 <field name="assetid" type="string" indexed="true" stored="true" required="true" />
 <field name="title" type="string" indexed="true" stored="true"/>
 <field name="type" type="string" indexed="true" stored="true"/>
 <field name="category" type="string" indexed="true" stored="true"/>
 <field name="first" type="text_general" indexed="true" stored="true"/>

 <uniqueKey>assetid</uniqueKey> 
```

当我在设置后尝试进行完全导入时，它显示所有 html 文件都已获取。但是当我在 SOLR 中搜索时，它没有显示任何结果。任何人都知道可能是什么原因？

我的理解是所有文件都正确提取但未在 SOLR 中编制索引。有谁知道如何在 SOLR 中索引 HTML 文件的元标记和内容？

您的回复将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T04:28:56.360

您可以使用[Solr 提取请求处理](http://wiki.apache.org/solr/ExtractingRequestHandler)程序向 Solr 提供 HTML 文件并从 html 文件中提取内容。例如在[链接](http://wiki.apache.org/solr/ExtractingRequestHandler#Getting_Started_with_the_Solr_Example)

Solr 使用[Apache Tika](http://tika.apache.org/)从[上传的 html 文件中提取内容](http://tika.apache.org/1.2/formats.html#HyperText_Markup_Language)

如果您想抓取网站并将其编入索引，带有 Solr 的 Nutch 是一个更广泛的解决方案。
[Nutch 与 Solr 教程](http://wiki.apache.org/nutch/NutchTutorial)将帮助您入门。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:58:06.567

您的意思是在 data-config.xml 中有 fileName="*.html" 吗？你现在有 fileName=".*html"

我很确定 Solr 不会知道如何将您的元字段从您的 html 转换为索引字段。我没试过。

但是，我创建了读取 (x)html 的程序（使用 xpath）。这将创建一个格式化的 xml 文件以发送到 \update。此时，您应该可以使用 dataimporthandler 来查找格式化的 xml 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-15T07:13:50.340

这是一个将 HTML 转换为文本并提取相关元数据的完整示例：

```
import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNull;

import org.apache.tika.metadata.Metadata;
import org.apache.tika.parser.AutoDetectParser;
import org.apache.tika.parser.ParseContext;
import org.apache.tika.sax.BodyContentHandler;
import org.junit.Test;

import java.io.ByteArrayInputStream;

public class ConversionTest {

    @Test
    public void testHtmlToTextConversion() throws Exception {
        ByteArrayInputStream bais = new ByteArrayInputStream(("<html>\n" +
            "<head>\n" +
            "<title> \n" +
            " A Simple HTML Document\n" +
            "</title>\n" +
            "</head>\n" +
            "<body></div>\n" +
            "<p>This is a very simple HTML document</p>\n" +
            "<p>It only has two paragraphs</p>\n" +
            "</body>\n" +
            "</html>").getBytes());
        BodyContentHandler contenthandler = new BodyContentHandler();
        Metadata metadata = new Metadata();
        AutoDetectParser parser = new AutoDetectParser();
        parser.parse(bais, contenthandler, metadata, new ParseContext());
        assertEquals("\nThis is a very simple HTML document\n" + 
            "\n" + 
            "It only has two paragraphs\n" + 
            "\n", contenthandler.toString().replace("\r", ""));
        assertEquals("A Simple HTML Document", metadata.get("title"));
        assertEquals("A Simple HTML Document", metadata.get("dc:title"));
        assertNull(metadata.get("title2"));
        assertEquals("org.apache.tika.parser.DefaultParser", metadata.getValues("X-Parsed-By")[0]);
        assertEquals("org.apache.tika.parser.html.HtmlParser", metadata.getValues("X-Parsed-By")[1]);
        assertEquals("ISO-8859-1", metadata.get("Content-Encoding"));
        assertEquals("text/html; charset=ISO-8859-1", metadata.get("Content-Type"));
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-12-06T18:57:37.873

最简单的方法是使用`post`bin 目录中的工具。它会自动完成所有工作。这是示例

`./post -c conf1 /path/to/files/*`

更多信息在[这里](https://cwiki.apache.org/confluence/display/solr/Uploading+Data+with+Solr+Cell+using+Apache+Tika)

# javascript - 当我将鼠标悬停在下拉列表中的某个项目上时，如何显示 JQuery 工具提示？

> ID：14711420
> 
> 赞同：4
> 
> 时间：2013-02-05T15:50:24.257
> 
> 标签：javascript, jquery, html

该[工具提示](http://docs.jquery.com/Plugins/Tooltip)适用于除下拉项目之外的所有其他内容。

我究竟做错了什么

```
$(document).ready(function(){
    $('option').each(function(){
        $(this).tooltip();
    });
    //$('option').tooltip();
}); 
```

编辑：我的 html 目前非常基本[http://jsfiddle.net/kasfu/](http://jsfiddle.net/kasfu/)

**编辑**我希望当我将鼠标悬停在下拉列表中的项目上时显示工具提示

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T08:25:44.187

从外观上看，它与您的代码无关。这是一个已知问题，而且看起来不会修复（无论如何很快）。工具提示在 chrome 中确实有效，但是 webkit 浏览器不喜欢`option`元素上的工具提示。

[请参阅此处获取错误票](http://bugs.jqueryui.com/ticket/8708)

我想你有我能想到的三个解决方案。

1.  找到一个不同的/构建你自己的有效的工具提示插件。

2.  使用 a`<ul>`并设置样式使其看起来像一个下拉菜单，并添加一些 jQuery 来控制显示/隐藏

3.  只需坚持浏览器标准工具提示即可。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T17:37:45.620

从您的工具提示插件链接。我想，这取决于`jquery.dimensions.js and jquery.bgiframe.js` 演示页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-10T09:24:48.127

我认为你应该试试这个

```
$('option').each(function(index, element){
        $(element).tooltip({ content: "<div>Select an Item</div>", track: true});
    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-06T10:02:39.780

我想我有你需要的东西。。

```
<select>
    <option title="1" >1</option>
    <option title="2">2</option>
    <option title="3">3</option>
</select>

$(document).ready(function(){
$('option').each(function(){
        $(this).style.top = window.event.clientY + 20;
        $(this).style.left = window.event.clientX;
        $(this).style.display = 'block';
        $(this).tooltip();
    });
}); 
```

希望这可以帮助。

# javascript - 使用 JavaScript 根据 location.hash 伪造点击锚点 - WordPress, FAQ Plug-in

> ID：14711421
> 
> 赞同：0
> 
> 时间：2013-02-05T15:50:24.277
> 
> 标签：javascript, wordpress, dom-events

这是一个 JavaScript 问题，但用于 WordPress 站点/插件。我已经安装了一个常见问题插件，当您单击问题时，它会展开和折叠“答案”，这是一个带有锚点的 h3。所有常见问题解答都显示在一个页面上。

最终我想要实现的是在主页上创建一个链接，比如说“问题十”，这将把访问者直接带到常见问题页面上的“问题十”并展开答案。

到目前为止，我已经能够调整常见问题解答代码以在锚标记上包含一个 id，使用：

```
id="' . basename(get_permalink()) . '" 
```

如果该特定问题的 URL 是 mysite.com/faq/this-is-question-ten，则锚点的结果 id 将是“this-is-question-ten”。

从那里，我在主页上为链接设置了 href = mysite.com/faq-page#this-is-question-ten。

在常见问题页面（模板）中，我声明了一个变量：

var anchorName = location.hash; 我添加了一个警报（anchorName），结果是#this-is-question-10。

从那里我试图打电话：

```
$('#this-is-question-ten').click(); 
```

和/或

```
$('#this-is-question-ten').trigger('click'); 
```

从而该函数查找 id = "#this-is-question-ten" 的锚点，并假“点击”该锚点。但是，它不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:07:36.700

那么javascript在一个页面上运行而FAQ在另一个页面上？比您无法将变量从第一个脚本解析到第二个脚本，而不是修改 URL。

如果您修改 URL，您也可以构建这样的链接

```
http://www.example.com/faq.php#this-is-question-ten 
```

浏览器将完成其余的工作。

要扩展给定的锚节点，不要尝试模拟点击，只需调用扩展函数（根据您使用的插件，您需要找到正确的调用）

所以例如

```
$("#question-10").expand();
//or
$("#question-10").show();
//or
$("#question-10").toggle(); 
```

请记住：#question-10 不是要单击的“按钮”或对象，而是答案隐藏在其中的隐藏容器；）

例子：

```
<div class="faq">
    <a id="question-10" onclick="answer.expand('answer-10');"> This is the question </a>

    <div id="answer-10" style="display:none">
     THIS IS THE HIDDEN ANSWER
    </div>
</div> 
```

假设您的布局类似于上面的布局......而不是试图模拟点击问题

```
$("question-10").click(); 
```

您应该直接调用底层函数：

```
if(anchorName == "question-10")
{
     answer.expand('answer-10');
} 
```

# javascript - 如何 console.log 单击的引导弹出窗口的标题？

> ID：14711422
> 
> 赞同：0
> 
> 时间：2013-02-05T15:50:28.193
> 
> 标签：javascript, jquery, twitter-bootstrap

如果我有这个弹出框代码：

```
 $('.UofTennesseeKnox').popover({
    'placement': 'bottom',
    'title': '<a class="passName" href="#">University of Tennessee-Knoxville</a>',
    'content': 'Facilities Services Department 2233 Volunteer Boulevard, Room 203 Knoxville, TN 37996-3010',
    'html': 'true'
  }); 
```

此获取内容的代码`.passName`不起作用：

```
 $('.passName').click(function(){
            console.log($(this).html());
        }); 
```

难道我做错了什么？还是因为在弹出窗口中所以它不起作用`.passName`，我可以做这样的事情来让`$('.passName').click(function())`弹出窗口加载后才触发吗？：

```
 $('.UofTennesseeKnox').popover({
    'placement': 'bottom',
    'title': '<a class="passName" href="#">University of Tennessee-Knoxville</a>',
    'content': 'Facilities Services Department 2233 Volunteer Boulevard, Room 203 Knoxville, TN 37996-3010',
    'html': 'true'
  }, passNamefunction()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:03:00.293

我认为这是因为您以动态方式创建此元素，请尝试使用[.on()](http://api.jquery.com/on/)：

```
 $(document).on("click", ".passName", function(){
        console.log($(this).html());
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T16:04:16.597

您可以使用 HTML 属性`data-original-title`在弹出框元素上设置数据。这样，您以后更容易读取数据：

```
$(".UofTennesseeKnox").attr("data-original-title", "Your title");
$(".UofTennesseeKnox").popover({ 
    // Your other options here
});

var title = $(".UofTennesseeKnox").attr("data-original-title"); 
```

我想您`.data()`以后甚至可以使用它来读取数据属性。我没有验证。

```
var title = $(".UofTennesseeKnox").data("original-title"); 
```

# joomla - joomla com_content 覆盖

> ID：14711425
> 
> 赞同：1
> 
> 时间：2013-02-05T15:50:35.090
> 
> 标签：joomla, overriding, core

我需要在 com_content/views/article/view.html.php 中进行一些更改

该文件是一个类：

```
class ContentViewArticle extends JViewLegacy{

} 
```

那么我如何覆盖这个类，因为在某些类别上我需要以现在的另一种方式设置元描述。

我将核心源文件复制到：templates/my_template_name/code/com_content/views/article/view.html.php

我做了一些更改，但它不起作用。

我认为它不使用新文件。我正在使用 joomla 2.5.7

谢谢你

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T08:47:45.280

您不需要覆盖 view.html，而只需覆盖 com_content/views/article/tmpl/default.php。只需将其复制到

/templates/your_template/html/com_content/article/default.php

并编辑副本。然后你可以使用

```
$document = JFactory::getDocument();
$document->setMetaData(... 
```

更改元字段。最终它们将由模板呈现，因此您无需自己输出元数据。

您可以在组件或模板中的任何位置执行上述操作，但不能在模块中执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T15:55:54.890

您不能对`view.html.php`文件进行模板覆盖 - 如果要这样做，您必须编辑核心文件。不要忘记您可以在文章参数中设置文章的元描述（它在编辑/新文章视图的手风琴内）。

最后，在您进行这些更改之前将您的 Joomla 版本更新到 2.5.9 - 因为您应该更新，但您将失去`view.html.php`对更新的更改

# css - Symfony2 - 子域上的资产背景图像

> ID：14711427
> 
> 赞同：2
> 
> 时间：2013-02-05T15:50:41.713
> 
> 标签：css, symfony, assetic, symfony-2.2

我在 Symfony 2.2 中有两个捆绑包

*1\. domaint.tld 上的 FrontBundle*

*   domain.tld/symfony/src/Company/FrontBundle/Resources/public/css
*   domain.tld/symfony/src/Company/FrontBundle/Resources/public/images
*   domain.tld/symfony/src/Company/FrontBundle/Resources/public/js

*2\. admin.domain.tld 上的 AdminBundle*

*   domain.tld/symfony/src/Company/AdminBundle/Resources/public/css (custom.css)
*   domain.tld/symfony/src/Comapny/AdminBundle/Resources/public/images (image.png)
*   domain.tld/symfony/src/Company/AdminBundle/Resources/public/js

*domain.tld/symfony/src/Comapny/AdminBundle/Resources/public/css/custom.css*

```
div.image {
    background-image: url(../images/image.png);
} 
```

*domain.tld/symfony/app/config/config.yml*

```
debug:          "%kernel.debug%"
use_controller: false
bundles:        [ AdminBundle, FrontBundle ]
read_from:      "%kernel.root_dir%/../../public_html/"
write_to:      "%kernel.root_dir%/../../public_html/"
filters:
    cssrewrite: ~ 
```

*domain.tld/symfony/app/config/routing.yml*

```
admin:
    host: "admin.domaint.tld"
    resource: "@AdminBundle/Controller/"
    type:     annotation

front: 
    host: "domain.tld"
    resource: "@FrontBundle/Controller/"
    type:     annotation 
```

*domain.tld/symfony/src/Company/AdminBundle/Resources/views/layout.html.twig*

```
{% stylesheets
'bundles/admin/css/custom.css'
filter='cssrewrite,?yui_css'
 %}
<link rel="stylesheet" href="{{ asset_url }}"/>
{% endstylesheets %} 
```

我用

```
app/console cache:clear
app/console assets:install ../public_html --symlink   
app/console assetic:dump 
```

--

**问题**

在 domain.tld 上一切正常，但问题出在子域上。

来自 admin.domain.tld 的源代码

```
<link rel="stylesheet" href="/css/8d488cd_custom_11.css"/> 
```

8d488cd_custom_11.css

```
div.image {
    background-image: url(../../bundles/admin/images/image.png);
} 
```

从萤火虫

```
"NetworkError: 404 Not Found - http://admin.domain.tld/bundles/admin/images/image.png" 
```

**知道如何将代码或配置更正为（css背景）也适用于子域和根域吗？**

# matlab - Matlab：收集/保存数据和收缩代码

> ID：14711428
> 
> 赞同：0
> 
> 时间：2013-02-05T15:50:43.703
> 
> 标签：matlab, save, iteration, shrink

给定以下代码：

```
clc
clear all
P = 45;

Mat =[
   64.7331   62.4019   60.2700   58.7798   58.4334   62.6596   59.4961   56.2320   53.6037 52.9330   60.9245   56.7753   51.7143   46.3398   44.5793   59.9245   55.0268   48.0563 36.3834   27.3842   59.9858   55.1389   48.3194   37.4449   30.2616
   57.9874   54.0479   50.6911   50.0354   52.6935   55.4367   49.3499   41.7788   39.6147 46.7394   54.3272   46.7781   32.1549   20.1516   42.9207   55.3253   49.1113   41.1552 38.7894   46.4079   57.8245   53.7807   50.2828   49.5916   52.3766
   63.0248   62.0303   61.8372   62.5024   63.8418   59.4631   57.8597   57.5336   58.6360 60.6997   55.2480   52.3275   51.6672   53.8008   57.2342   50.6163   44.3727   42.4670 47.8379   53.8624   47.3455   34.0518   22.7165   42.7145   51.8266
   60.1421   55.2778   48.3022   35.9256   16.6506   60.8750   56.5697   51.0854   44.5373 41.5090   62.4192   59.0475   55.4089   52.2317   51.1936   64.3903   61.8774   59.4945 57.7313   57.2225   66.4892   64.6241   63.0031   61.9060   61.6064
   55.8668   54.2772   54.7708    7.0326   59.9984   50.3209   46.7794   47.9743   52.4927 57.1425   44.2363   32.9105   38.0425   48.3069   55.0584   42.9081   25.1741   34.8503 47.5309   54.7311   48.3741   43.5202   45.2490   51.0490   56.3626
   62.8081   62.7123   63.3845   64.6575   66.2861   58.8319    4.6746   59.7547   61.6696 63.9329   53.6053   53.3021   55.2850   58.3709   61.5730   46.1003   45.3092   49.8225 55.0705   59.5074   34.5594   30.5746   44.5462   52.7418   58.2459
   59.7305   56.9737   55.1115   55.0603   56.8513   56.5791   52.0789   48.2510   48.1309 51.8531   54.0783   47.0293   37.1612   36.6764   46.6022   53.4451   45.4219   29.5077 28.1924   44.8975   55.1133   49.3157   43.1930   42.9668   48.9959
   44.4319   46.3901   51.8259   56.8807   61.0151   26.7070   36.7384   48.2747   55.1761 60.0372   30.2115   37.9156   48.5729   55.3044   60.1077   45.7796   47.4661   52.3927 57.1888   61.2012   53.6748   54.3513   56.8248   59.9279   62.9754];

for j = 1:1:size(Mat,2)

      if isnan(Mat)
        break;
      end

        for matrows=1:1:size(Mat,1)
        [ski1,snow1]=min(Mat(:,j));

        if ski1 <=P
            M_B = snow1;
            Mat(snow1,:) = NaN;            
%             Mat
            [ski2,snow2]=min(Mat(:,j));
        else
            break
        end
                if ski2 + ski1 <=P
                    M_B = horzcat(snow1,snow2);
                    Mat(snow2,:) = NaN;
        %           Mat
                    [ski3,snow3]=min(Mat(:,j));
                else
                    break
                end

                    if ski3 + ski2 + ski1 <=P
                        M_B = horzcat(snow1,snow2,snow3);
                        Mat(snow3,:) = NaN;
            %           Mat
                        [ski4,snow4]=min(Mat(:,j));
                    else
                        break
                    end

                        if ski4 + ski3 + ski2 + ski1 <=P
                            M_B = horzcat(snow1,snow2,snow3,snow4);
                            Mat(snow4,:) = NaN;
                %           Mat
                            [ski5,snow5]=min(Mat(:,j));
                         else
                             break
                        end
        M_B(j,matrows)=[M_B]
        end
       Mat
end
     Mat 
     M_B 
```

试图`M_B`从每次迭代中保存到矩阵，但我总是得到最后一个值`M_B`。目的是根据列 (j) 和行 (matrows) 获得一个 M_B 矩阵或单元格（也尝试过但没有成功），如果使用 Mat 的前 4 列，则为 pe：

```
1 2 3   4 %j column
8 0 0 [5,4] %number of M_B row 
```

等等。
我做错了什么？

在那之后，如果可能的话，请帮助我缩小/压缩代码。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:30:19.363

我不明白你的代码，但我看到你在每个循环中使用相同的变量，我认为这样的事情可以防止你覆盖它：

```
totalM_B(j,matrows)=[M_B] 
```

您可能需要对其进行一些调整以使其正常工作，但我希望您能看到当前代码的问题。

# asp.net - Asp Gridview View 在编辑模式和预览模式之间变化

> ID：14711430
> 
> 赞同：1
> 
> 时间：2013-02-05T15:50:48.520
> 
> 标签：asp.net, gridview, vb.net-2010

我有一个通过数据库填充的 asp gridview 控件（允许分页）。我还允许用户连续编辑任何单元格。gridview 控件被包裹在这个 div 标签中，这使得它更小，占用更少的屏幕。它工作得很好，直到我单击编辑按钮，这导致所选行变成编辑模式。当它这样做时，将编辑行突出显示为一种颜色，并使该行上的控件成为文本框。我为 gridview 中的每一列使用模板。下列的;

TemplateField ItemTemplate EditTemplate FooterTemplate

对于每一列。当gridview 切换到editmode 时，它​​基本上以默认大小呈现网格，该大小占据了所有屏幕并且看起来很糟糕......似乎忽略了div 标签。关于为什么在编辑模式和非编辑模式之间切换渲染大小的任何想法？当我取消编辑操作时，它会在网格的初始负载上恢复到正确的大小:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:38:08.637

这可能是编辑模式文本框使您的网格失控。您的 DIV 字体大小仅适用于文本跨度元素，而不适用于文本框。

尝试设置文本框的样式以减小它们的大小。每个链接[在这里](https://stackoverflow.com/questions/8680202/how-to-taking-control-of-size-of-gridview-when-its-on-edit-mode-and-its-not)：

```
<asp:GridView ID="gvCustomer" runat="server">
    ...
    <EditRowStyle CssClass="GridViewEditRow" /> <%-- add this --%>
</asp:GridView> 
```

然后为您的文本框添加样式：

```
.GridViewEditRow input[type=text] {width:50px;} 
```

或者，根据可能填充这些框的文本大小，添加 font-size 属性：

```
.GridViewEditRow input[type=text] {width:70px; font-size: .9em} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-29T17:44:35.557

利用：

```
< Control style width="" /> between < asp:Boundfield>----< /asp:Boundfield> 
```

它会立即解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:18:42.657

```
<div align="center" style="font-size: smaller;">
        <table>
            <tr>
                <td>
                    <asp:GridView ID="gvCustomer" runat="server" AutoGenerateColumns="false" AllowPaging="True"
                        ShowFooter="True" BorderColor="Blue" BorderStyle="Double">
                        <Columns>
                            <asp:TemplateField HeaderStyle-HorizontalAlign="Center" FooterStyle-HorizontalAlign="Center"
                                ItemStyle-HorizontalAlign="Center" HeaderText="StandardAcctNo" ShowHeader="true">
                                <HeaderTemplate>
                                    Standard<br />
                                    Account
                                </HeaderTemplate>
                                <ItemTemplate>
                                    <asp:Label ID="lblStandardAcctNo" runat="server" Text='<%# Bind("StandardAcctNo")%>'></asp:Label>
                                </ItemTemplate>
                                <EditItemTemplate>
                                    <asp:TextBox ID="txtStandardAcctNo" runat="server" Text='<%# Eval("StandardAcctNo") %>'></asp:TextBox>
                                </EditItemTemplate>
                                <FooterTemplate>
                                    <asp:DropDownList ID="FtrddlStandardAcctNo" runat="server">
                                    </asp:DropDownList>
                                </FooterTemplate>
                            </asp:TemplateField>
                            <asp:TemplateField HeaderStyle-HorizontalAlign="Center" FooterStyle-HorizontalAlign="Center"
                                ItemStyle-HorizontalAlign="Center" HeaderText="CompanyID" ShowHeader="true">
                                <HeaderTemplate>
                                    Company<br />
                                    ID
                                </HeaderTemplate>
                                <ItemTemplate>
                                    <asp:Label ID="lblCompanyID" runat="server" Text='<%# Bind("CompanyID")%>'></asp:Label>
                                </ItemTemplate>
                                <EditItemTemplate>
                                    <asp:TextBox ID="txtCompanyID" runat="server" Text='<%# Eval("CompanyID") %>'></asp:TextBox>
                                </EditItemTemplate>
                                <FooterTemplate>
                                    <asp:TextBox Width="50px" ID="ftrCompanyID" runat="server"></asp:TextBox>
                                </FooterTemplate>
                            </asp:TemplateField>
                            <asp:TemplateField HeaderStyle-HorizontalAlign="Center" FooterStyle-HorizontalAlign="Center"
                                ItemStyle-HorizontalAlign="Center" HeaderText="OrgGroupID" ShowHeader="true">
                                <HeaderTemplate>
                                    OrgGroup<br />
                                    ID
                                </HeaderTemplate>
                                <ItemTemplate>
                                    <asp:Label ID="lblOrgGroupID" runat="server" Text='<%# Bind("OrgGroupID")%>'></asp:Label>
                                </ItemTemplate>
                                <EditItemTemplate>
                                    <asp:TextBox ID="txtOrgGroupID" runat="server" Text='<%# Eval("OrgGroupID") %>'></asp:TextBox>
                                </EditItemTemplate>
                                <FooterTemplate>
                                    <asp:TextBox Width="75px" ID="ftrOrgGroupID" runat="server"></asp:TextBox>
                                </FooterTemplate>
                            </asp:TemplateField>
                            <asp:TemplateField HeaderStyle-HorizontalAlign="Center" FooterStyle-HorizontalAlign="Center"
                                ItemStyle-HorizontalAlign="Center" HeaderText="BuyerID" ShowHeader="true">
                                <ItemTemplate>
                                    <asp:Label ID="lblBuyerID" runat="server" Text='<%# Bind("BuyerID")%>'></asp:Label>
                                </ItemTemplate>
                                <EditItemTemplate>
                                    <asp:TextBox ID="txtBuyerID" runat="server" Text='<%# Eval("BuyerID") %>'></asp:TextBox>
                                </EditItemTemplate>
                                <FooterTemplate>
                                    <asp:TextBox Width="75px" ID="ftrBuyerID" runat="server"></asp:TextBox>
                                </FooterTemplate>
                            </asp:TemplateField>
                            <asp:TemplateField HeaderStyle-HorizontalAlign="Center" FooterStyle-HorizontalAlign="Center"
                                ItemStyle-HorizontalAlign="Center" HeaderText="SupplierID" ShowHeader="true">
                                <HeaderTemplate>
                                    Supplier<br />
                                    ID
                                </HeaderTemplate>
                                <ItemTemplate>
                                    <asp:Label ID="lblSupplierID" runat="server" Text='<%# Bind("SupplierID")%>'></asp:Label>
                                </ItemTemplate>
                                <EditItemTemplate>
                                    <asp:TextBox ID="txtSupplierID" runat="server" Text='<%# Eval("SupplierID") %>'></asp:TextBox>
                                </EditItemTemplate>
                                <FooterTemplate>
                                    <asp:TextBox Width="75px" ID="ftrSupplierID" runat="server"></asp:TextBox>
                                </FooterTemplate>
                            </asp:TemplateField>
                            <asp:TemplateField HeaderStyle-HorizontalAlign="Center" FooterStyle-HorizontalAlign="Center"
                                ItemStyle-HorizontalAlign="Center" HeaderText="CarrierID" ShowHeader="true">
                                <HeaderTemplate>
                                    Carrier<br />
                                    ID
                                </HeaderTemplate>
                                <ItemTemplate>
                                    <asp:Label ID="lblCarrierID" runat="server" Text='<%# Bind("CarrierID")%>'></asp:Label>
                                </ItemTemplate>
                                <EditItemTemplate>
                                    <asp:TextBox ID="txtCarrierID" runat="server" Text='<%# Eval("CarrierID") %>'></asp:TextBox>
                                </EditItemTemplate>
                                <FooterTemplate>
                                    <asp:TextBox Width="75px" ID="ftrCarrierID" runat="server"></asp:TextBox>
                                </FooterTemplate>
                            </asp:TemplateField>
                            <asp:TemplateField HeaderStyle-HorizontalAlign="Center" FooterStyle-HorizontalAlign="Center"
                                ItemStyle-HorizontalAlign="Center" HeaderText="TerminalID" ShowHeader="true">
                                <HeaderTemplate>
                                    Terminal<br />
                                    ID
                                </HeaderTemplate>
                                <ItemTemplate>
                                    <asp:Label ID="lblTerminalID" runat="server" Text='<%# Bind("TruckTermID")%>'></asp:Label>
                                </ItemTemplate>
                                <EditItemTemplate>
                                    <asp:TextBox ID="txtTerminalID" runat="server" Text='<%# Eval("TruckTermID") %>'></asp:TextBox>
                                </EditItemTemplate>
                                <FooterTemplate>
                                    <asp:TextBox Width="75px" ID="ftrTerminalID" runat="server"></asp:TextBox>
                                </FooterTemplate>
                            </asp:TemplateField>
                            <asp:TemplateField HeaderStyle-HorizontalAlign="Center" FooterStyle-HorizontalAlign="Center"
                                ItemStyle-HorizontalAlign="Center" HeaderText="CustomerName" ShowHeader="true">
                                <HeaderTemplate>
                                    Customer<br />
                                    Name
                                </HeaderTemplate>
                                <ItemTemplate>
                                    <asp:Label ID="lblCustomerName" runat="server" Text='<%# Bind("CustomerName")%>'></asp:Label>
                                </ItemTemplate>
                                <EditItemTemplate>
                                    <asp:TextBox ID="txtCustomerName" runat="server" Text='<%# Eval("CustomerName") %>'></asp:TextBox>
                                </EditItemTemplate>
                                <FooterTemplate>
                                    <asp:TextBox Width="100px" ID="ftrCustomerName" runat="server"></asp:TextBox>
                                </FooterTemplate>
                            </asp:TemplateField>
                            <asp:TemplateField HeaderStyle-HorizontalAlign="Center" FooterStyle-HorizontalAlign="Center"
                                ItemStyle-HorizontalAlign="Center" HeaderText="Tolerance %" ShowHeader="true">
                                <ItemTemplate>
                                    <asp:Label ID="lblTolerancePercentage" runat="server" Text='<%# Bind("Tolerance")%>'></asp:Label>
                                </ItemTemplate>
                                <EditItemTemplate>
                                    <asp:TextBox ID="txtTolerancePercentage" runat="server" Text='<%# Eval("Tolerance") %>'></asp:TextBox>
                                </EditItemTemplate>
                                <FooterTemplate>
                                    <asp:TextBox Width="50px" ID="ftrTolerancePercentage" runat="server"></asp:TextBox>
                                </FooterTemplate>
                            </asp:TemplateField>
                            <asp:TemplateField HeaderStyle-HorizontalAlign="Center" FooterStyle-HorizontalAlign="Center"
                                ItemStyle-HorizontalAlign="Center" HeaderText="Credit/Rebill BOL" ShowHeader="true">
                                <ItemTemplate>
                                    <asp:Label ID="lblCreditRebillBOL" runat="server" Text='<%# Bind("CreditRebillBOL")%>'></asp:Label>
                                </ItemTemplate>
                                <EditItemTemplate>
                                    <asp:TextBox ID="txtCreditRebillBOL" runat="server" Text='<%# Eval("CreditRebillBOL") %>'></asp:TextBox>
                                </EditItemTemplate>
                                <FooterTemplate>
                                    <asp:TextBox Width="20px" ID="ftrCreditRebillBOL" runat="server"></asp:TextBox>
                                </FooterTemplate>
                            </asp:TemplateField>
                            <asp:TemplateField ShowHeader="False">
                                <ItemTemplate>
                                    <asp:LinkButton ID="lnkbtnXRefEdit" runat="server" CausesValidation="false" CommandName="Edit"
                                        Text="Edit"></asp:LinkButton>
                                    <asp:LinkButton ID="lnkbtnXRefDelete" runat="server" CommandName="Delete" Text="Delete"
                                        OnClientClick="return confirm('Are you sure you want to DELETE this entry?');"></asp:LinkButton>
                                </ItemTemplate>
                                <EditItemTemplate>
                                    <asp:LinkButton ID="lnkbtnXRefUpdate" runat="server" CausesValidation="true" CommandName="Update"
                                        ValidationGroup="Update" OnClientClick="return confirm('Are you sure you want to UPDATE this entry?');"
                                        Text="Update"></asp:LinkButton>
                                    <asp:LinkButton ID="lnkbtnXRefCancel" runat="server" CausesValidation="False" CommandName="Cancel"
                                        Text="Cancel"></asp:LinkButton>
                                </EditItemTemplate>
                                <FooterTemplate>
                                    <asp:LinkButton ID="lnkbtnXRefAddNew" runat="server" CommandName="AddNew" Text="Add New"
                                        CausesValidation="true" ValidationGroup="AddNew"></asp:LinkButton>
                                </FooterTemplate>
                            </asp:TemplateField>
                        </Columns>
                    </asp:GridView>
                </td>
            </tr>
        </table>
    </div> 
```

# java - Java FileReader 和写作

> ID：14711431
> 
> 赞同：-2
> 
> 时间：2013-02-05T15:50:49.327
> 
> 标签：java, filewriter

我正在努力将数组保存到文件中，然后将其读回到保存它的同一数组中。

Person 的代码是

```
 import java.io.*;

public class Person implements Serializable
{
        protected String name;
        protected char gender;
        protected Date dateOfBirth;
        protected String address;
        protected String natInsceNo;
        protected String phoneNo;

        public Person()
        {
            this("", 'N' , new Date());
        }

        public Person (Person other)
        {
            // Create a clone from Person other
            //TO DO
        }

        public Person (String aName, char sex, Date dob)
        {
            name = aName;
            gender = sex;
            dateOfBirth = dob;
            address = "";
            natInsceNo = "" ;
            phoneNo = "";

        }

        public void setName(String aName)
         {
               //Setter method to alter the Person aName string
                name = aName;
         }

         public void setAddress(String addr)
         {
               //Setter method to alter the Person address string
                address = addr;
         }
         public void setNatInsNo(String ins)
         {
               //Setter method to alter the Person national insurance number
                natInsceNo = ins;
         }

         public void setPhone(String phone)
         {
               //Setter method to alter the Person phone number
                phoneNo = phone;
         }

         public String getName()
         {
               //Getter method to return the Person name String
             return name;

         }
         public String getAddress()
         {
               //Getter method to return the Person address String
             return address;

         }
         public String getNatInsNo()
         {
               //Getter method to return the Person national insurance String
             return natInsceNo;

         }
        public String getPhone()
        {
               //Getter method to return the Person phone number
            return phoneNo;
        }

        public boolean equals(Person other)
        {
        // return true if name, dateOfBirth and national insurance number are same 

            return false;
        }

        public String toString()
        {
               //Override the toString() method of the Object class
                String output= "";
                output = "Name: " + name + ", Gender: " + gender+ ",  Date Of Birth: " + dateOfBirth +", National Insurance No "+natInsceNo+"";
            return output;      
        }

} 
```

我的员工的代码是

```
 import java.awt.List;
import java.io.*;
import java.lang.reflect.Array;
import java.util.ArrayList;

import javax.swing.JOptionPane;
public class Store implements Serializable
{
private static int MAXSIZE; // holds the size of the array
private static int count; // keeps count of number of  employees stored in array 
Person list[];
static String fileName = "Employee.txt";

        public void save(Person testStore) throws IOException{
            try{
                FileWriter fr = new FileWriter(fileName);
                PrintWriter pr = new PrintWriter(fr);
                for(int i=0; i<Store.getCount(); i++)
                {
                    pr.println(list[i]);
                }
                pr.close();
            }
            catch(IOException e){
                String message = "problem Writing to file";
                JOptionPane.showMessageDialog(null,  message, null, JOptionPane.ERROR_MESSAGE);
            }
        }

        public void readFile() throws IOException {
            BufferedReader CSVFile = new BufferedReader(new FileReader(fileName));
            String dataRow = CSVFile.readLine();
            while (dataRow !=null){
                String[] dataArray = dataRow.split(",");
                for (String item:dataArray){
                    System.out.print(item);
                    //int i=0;
                    //String word = item;
                    //list[i]=item;
                }

                System.out.println();
                dataRow = CSVFile.readLine();
            }
        }

        public Store(int size)
        {
            //Constructor which allow the size of the store to be specified
            list = new Person[size];
            MAXSIZE = size;
            count=0;
        }

        public static void setFileName(String fileNameIn){
            fileName = fileNameIn;          
        }

       public static int getCount()
       {
             //Getter method to return the number of elements currently in store
            //To do
           return count;
       }
       public static boolean isFull()
       {
             //Returns true if no more space in store
            //To do
           return count == MAXSIZE;
       }
       public Store()
       {
             //Default constructor
            this(0);
       }

       public Store(Store s)
       {
             //Create a Store from another Store s
            //To do
       }
       public void add(Employee e)
       {
           list[count++] = e;
       }

       public void displayAll()
       {
           //display the contents of store on the screen
           for (int i = 0; i< count; i++)
               System.out.println(list[i]); 
        }    

} 
```

我保存的代码是

人员列表[]; 静态字符串文件名 = "Employee.txt";

```
 public void save(Person testStore) throws IOException{
        try{
            FileWriter fr = new FileWriter(fileName);
            PrintWriter pr = new PrintWriter(fr);
            for(int i=0; i<Store.getCount(); i++)
            {
                pr.println(list[i]);
            }
            pr.close();
        }
        catch(IOException e){
            String message = "problem Writing to file";
            JOptionPane.showMessageDialog(null,  message, null, JOptionPane.ERROR_MESSAGE);
        }
    } 
```

如果代码有点混乱并且不是很结构化，我很抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:54:36.387

用于`ObjectOutputStream`序列`Object state`化为文本文件并用于`ObjectInputStream`取回。

```
ObjectOutputStream output = new ObjectOutputStream(
                            new FileOutputStream(fileName));
output.writeObject(Store);
output.close(); 
```

和

```
ObjectInputStream input = new ObjectInputStream(
                            new FileInputStream(fileName));
ArrayList<Person> store = (ArrayList<Person>)input.readObject();
input.close(); 
```

# r - R - “线性化” tapply 的结果（到一个单一的向量，按列解包）

> ID：14711434
> 
> 赞同：2
> 
> 时间：2013-02-05T15:50:59.817
> 
> 标签：r, tapply

在数据框中，我有一个带有一些值的向量，以及每个值所属的类别向量。我想将一个函数应用于“按类别”操作的值，所以我使用了tapply。例如，就我而言，我想重新调整每个类别中的值。

但是，tapply 的结果是重新缩放值的向量列表，但我需要统一（或“线性化”回）这个列表，所以我可以将重新缩放值的列添加到我的数据框中。

我正在寻找一种简单的方法来做到这一点。这是一个示例：

```
x = 1:10
c = factor(c(1,2,1,2,1,2,1,2,1,2))
#I do the rescaling like this:
rescaled = tapply(x,list(c),function(x) as.vector(scale(x)))
# this look like this:
$`1`
[1] -1.2649111 -0.6324555  0.0000000  0.6324555  1.2649111

$`2`
[1] -1.2649111 -0.6324555  0.0000000  0.6324555  1.2649111

# but really, I need to get something like this
[1] -1.2649111 -1.2649111 -0.6324555 -0.6324555  0.0000000  0.0000000
 [7]  0.6324555  0.6324555  1.2649111  1.2649111 
```

有什么建议么？

谢谢，阿米特

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T15:54:05.893

主力的另一份工作`ave`。让我用一个数据框来说明它：

```
> mydf <- data.frame(x=1:10,myfac=factor(c(1,2,1,2,1,2,1,2,1,2)))
> within(mydf, scaledx <- ave(x,myfac,FUN=scale))
    x myfac    scaledx
1   1     1 -1.2649111
2   2     2 -1.2649111
3   3     1 -0.6324555
4   4     2 -0.6324555
5   5     1  0.0000000
6   6     2  0.0000000
7   7     1  0.6324555
8   8     2  0.6324555
9   9     1  1.2649111
10 10     2  1.2649111 
```

如果您查看`?ave`，它会告诉您您也可以使用一系列因素来执行此操作。如果您想向数据框添加一列，这是您最简洁（尽管不是最快）的选择。结合`within`您可以在一行代码中完成这两项操作。

# grails - 有什么区别 和

> ID：14711435
> 
> 赞同：4
> 
> 时间：2013-02-05T15:51:03.460
> 
> 标签：grails, tags, gsp, sitemesh

正如标题所说...我正在使用 grails 来构建网页，我知道 grails 使用 sitemesh 来网格化 GSP。我做了一些谷歌搜索，发现了 2 种“平铺”gsps 的方法（g:applyLayout 和 g:render 模板标签）。两者似乎都在做“平铺”gsps的工作，所以我的问题是，有什么区别？

编辑：

例如，我将使用瓦片定义。

```
<tiles-definitions>
  <definition name="myapp.homepage" template="/layouts/classic.jsp">
    <put-attribute name="title" value="Tiles tutorial homepage" />
    <put-attribute name="header" value="/tiles/banner.jsp" />
    <put-attribute name="menu" value="/tiles/common_menu.jsp" />
    <put-attribute name="body" value="/tiles/home_body.jsp" />
    <put-attribute name="footer" value="/tiles/credits.jsp" />
  </definition>
</tiles-definitions> 
```

并且您使用 tiles:addAttribute 将页面“注入”到 jsp 中。

据我了解，任何不是您要导航到的页面的 gsp（因此“图块”）都应该放入 grails 中的布局中。所以我想我同意的问题是 1\. 你如何最有效地使用 grails/sitemesh 来做到这一点，以及 2\. 如果布局不是我被引导相信的那样，那么它是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-26T04:56:33.077

我认为 applyLayout 和 render 之间的主要区别在于 applyLayout 更用于将整体样式/定位应用于特定页面或页面的部分。例如使用

```
<g:applyLayout name="myLayout" url="http://www.google.com" /> 
```

会将您的“myLayout”应用到 google.com 网址页面并将其放置在您包含该标签的位置。

我对何时应该将渲染标签用于几乎所有其他事情的理解。为给定的模板 gsp 部分呈现（创建 html）。能够使用这种语法为集合中的每个项目一遍又一遍地呈现 html 的特定部分（又名模板）特别方便

```
<g:render template="displaybook" collection="${books}" /> 
```

但是你可以使用类似的东西

```
<g:applyLayout name="myLayout" template="displaybook" params="[books: books]" /> 
```

当您想将“myLayout”的不同布局应用于模板“displaybook”时。

希望有帮助

汤姆

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-18T18:49:50.600

这是一个[很好的例子](http://mrhaki.blogspot.com/2011/03/grails-goodness-applying-layouts-in.html)，它回答了你关于如何最有效地使用 grails/sitemesh 的问题。

# jquery - jQuery 单选按钮显示/隐藏

> ID：14711436
> 
> 赞同：0
> 
> 时间：2013-02-05T15:51:03.560
> 
> 标签：jquery

我正在尝试使用单选按钮来显示和隐藏 div，但无法使以下内容正常工作，有什么帮助会很棒吗？

```
 $('input:radio[name="option"]').click(function() {
    if ( $(this).val() == "pop" ) {
        $(this).parent().next('.wrapper').show();
    } else {
        $(this).parent().next('.wrapper').hide();
    }
});

<input name="option" type="radio">
<input name="option" type="radio" value="pop">

<div class="wrapper">text</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T15:52:12.477

删除`parent()`, 因为`.wrapper`元素与输入处于同一级别。

你也想要`nextAll`，不是`next`，因为`next`只选择紧随其后的兄弟。

工作代码：

```
$('input:radio[name="option"]').click(function() {
    var $this = $(this);
    if ( $this.val() == "pop" ) {
        $this.nextAll('.wrapper').show();
    } else {
        $this.nextAll('.wrapper').hide();
    }
}); 
```

[示范](http://jsfiddle.net/AwYjY/)

如果您只想要以下第一个`.wrapper`元素，那么您可以使用这个：

```
$('input:radio[name="option"]').click(function() {
    var $this = $(this), $wrapper = $this.nextAll('.wrapper').eq(0);
    if ( $this.val() == "pop" ) {
        $wrapper.show();
    } else {
        $wrapper.hide();
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:59:55.093

尝试这个：

```
$(document).ready(function(){  
    $("input[value='pop']").on("click", function() {
        $(".wrapper").toggle();
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T15:55:36.827

你`.parent().next('wrapper').`没有什么可以抓住的（没有这样的元素）。

这将起作用

```
$('.wrapper').show(); 
```

# java - java.lang.RuntimeException: 传递结果失败 ResultInfo{who=null, request=100, result=-1, data=Intent }...: java.lang.NullPointerException

> ID：14711437
> 
> 赞同：3
> 
> 时间：2013-02-05T15:51:07.557
> 
> 标签：java, android, android-camera

我正在创建一个 Android 应用程序，它拍摄照片并将其发送到 Ocr Web 服务（Microsoft Hawaii）；但是我遇到了一个很糟糕的问题.. 拍完照片后，应用程序崩溃了，但我不明白问题出在哪里，以及如何解决！代码是这样的：

```
package your.Mobile;

 import java.io.ByteArrayOutputStream;
 import java.io.File;
 import java.io.FileNotFoundException;
 import java.io.IOException;
 import android.app.Activity;
 import android.content.Context;
 import android.content.Intent;
 import android.graphics.Bitmap;
 import android.graphics.Canvas;
 import android.graphics.Paint;
 import android.graphics.Rect;
 import android.location.GpsStatus;
 import android.location.GpsStatus.Listener;
 import android.location.Location;
 import android.location.LocationListener;
 import android.location.LocationManager;
 import android.net.Uri;
 import android.os.Bundle;
 import android.provider.MediaStore;
 import android.util.Log;

 import android.view.View;
 import android.widget.ImageView;

 public class FotocameraActivity extends Activity {

// dati che servono per la fotocamera
private static final int CAMERA_REQUEST = 100; // un numero a nostro
                                                                                                // piacimento
File tmpFotoFile = null;
byte[] bitmapdata;
ImageView preview;
LocationManager locationManager;
String gps;
final static String ARRAY_BYTE = "ARRAY_BYTE";
final static String GPS = "GPS";

@Override
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        locationManager = (LocationManager)this.getSystemService(Context.LOCATION_SERVICE);
        if(locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER)){
            startGpsTracking();
        }

        try {
                launchCamera();
        } catch (IOException e) {
                throw new RuntimeException(e);
        }
}

private void startGpsTracking() {
    // TODO Auto-generated method stub
    locationManager.addGpsStatusListener(gpsListener);
    locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 500, 3, myLocationListener);
}

private Listener gpsListener = new Listener(){
    public void onGpsStatusChanged(int status){
        switch(status){
        case GpsStatus.GPS_EVENT_FIRST_FIX:
            Log.d(LOCATION_SERVICE,"onGpsStatusChanged First Fix");
            break;
        case GpsStatus.GPS_EVENT_SATELLITE_STATUS:
            Log.d(LOCATION_SERVICE, "onGpsStatusChanged Satellite");
            break;
        case GpsStatus.GPS_EVENT_STARTED:
            Log.d(LOCATION_SERVICE, "onGpsStatusChanged Started");
            break;
        case GpsStatus.GPS_EVENT_STOPPED:
            Log.d(LOCATION_SERVICE, "onGpsStatusChanged Stopped");
            break;
        }
    }
};

private LocationListener myLocationListener = new LocationListener(){

    public void onLocationChanged(Location location) {
        // TODO Auto-generated method stub
        double lng = location.getLongitude(), lat = location.getLatitude();
        gps += String.format("%6f", lng) + "#" + String.format("%6f", lat); 

    }

    public void onProviderDisabled(String provider) {
        // TODO Auto-generated method stub

    }

    public void onProviderEnabled(String provider) {
        // TODO Auto-generated method stub

    }

    public void onStatusChanged(String provider, int status, Bundle extras) {
        // TODO Auto-generated method stub

    }

};

private void launchCamera() throws IOException {

        // Fase 1
        tmpFotoFile = File.createTempFile("OCRPic", null);

        Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
        cameraIntent.putExtra(MediaStore.EXTRA_OUTPUT, android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI); //Uri.fromFile(tmpFotoFile));
        startActivityForResult(cameraIntent, CAMERA_REQUEST);
}

protected void onActivityResult(int requestCode, int resultCode, Intent data) {

        if (requestCode == CAMERA_REQUEST) {
                Bitmap datifoto = null;
                try {
                        datifoto = android.provider.MediaStore.Images.Media.getBitmap(this.getContentResolver(), android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI); <------ Here is the error
                } catch (FileNotFoundException e) {
                        throw new RuntimeException(e);
                } catch (IOException e) {
                        throw new RuntimeException(e);
                }
                ByteArrayOutputStream bos = new ByteArrayOutputStream();
                datifoto.compress(Bitmap.CompressFormat.JPEG, 100, bos);
                bitmapdata = bos.toByteArray();
                //tmpFotoFile.delete();

                SimpleView view = new SimpleView(this, datifoto); // creo l'istanza
                                                                                                                        // // della                                                                                                       // view...
                setContentView(view); // e la setto

                Intent intentRecognize = new Intent(this, RecognitionActivity.class);
                intentRecognize.putExtra(ARRAY_BYTE, bitmapdata);
                intentRecognize.putExtra(GPS, gps);
                startActivity(intentRecognize);
        }

}
}

class SimpleView extends View{

private Bitmap bitmap;
private Paint tmpPaint = new Paint(Paint.ANTI_ALIAS_FLAG);

public SimpleView(Context context, Bitmap bitmap) {
        super(context);
        this.bitmap = Bitmap.createScaledBitmap(bitmap,480,320,false);//ridimensiono l'immagine
}

@Override
protected void onDraw(Canvas canvas){
super.onDraw(canvas);
canvas.drawBitmap( bitmap, null , new Rect(0,0,getWidth(),getHeight()),tmpPaint);
}

} 
```

而logcat是这样的：

```
02-05 16:41:50.321: E/AndroidRuntime(489): FATAL EXCEPTION: main
02-05 16:41:50.321: E/AndroidRuntime(489): java.lang.RuntimeException: Failure              delivering result ResultInfo{who=null, request=100, result=-1, data=Intent { dat=content://media/external/images/media/1285 (has extras) }} to activity {your.Mobile/your.Mobile.FotocameraActivity}: java.lang.RuntimeException: java.io.FileNotFoundException: Multiple items at content://media/external/images/media
02-05 16:41:50.321: E/AndroidRuntime(489):  at android.app.ActivityThread.deliverResults(ActivityThread.java:2984)
02-05 16:41:50.321: E/AndroidRuntime(489):  at android.app.ActivityThread.handleSendResult(ActivityThread.java:3027)
02-05 16:41:50.321: E/AndroidRuntime(489):  at android.app.ActivityThread.access$1100(ActivityThread.java:127)
02-05 16:41:50.321: E/AndroidRuntime(489):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1181)
02-05 16:41:50.321: E/AndroidRuntime(489):  at android.os.Handler.dispatchMessage(Handler.java:99)
02-05 16:41:50.321: E/AndroidRuntime(489):  at android.os.Looper.loop(Looper.java:137)
02-05 16:41:50.321: E/AndroidRuntime(489):  at android.app.ActivityThread.main(ActivityThread.java:4476)
02-05 16:41:50.321: E/AndroidRuntime(489):  at java.lang.reflect.Method.invokeNative(Native Method)
02-05 16:41:50.321: E/AndroidRuntime(489):  at java.lang.reflect.Method.invoke(Method.java:511)
02-05 16:41:50.321: E/AndroidRuntime(489):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:816)
02-05 16:41:50.321: E/AndroidRuntime(489):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:583)
02-05 16:41:50.321: E/AndroidRuntime(489):  at dalvik.system.NativeStart.main(Native Method)
02-05 16:41:50.321: E/AndroidRuntime(489): Caused by: java.lang.RuntimeException: java.io.FileNotFoundException: Multiple items at content://media/external/images/media
02-05 16:41:50.321: E/AndroidRuntime(489):  at your.Mobile.FotocameraActivity.onActivityResult(FotocameraActivity.java:124)
02-05 16:41:50.321: E/AndroidRuntime(489):  at android.app.Activity.dispatchActivityResult(Activity.java:4820)
02-05 16:41:50.321: E/AndroidRuntime(489):  at android.app.ActivityThread.deliverResults(ActivityThread.java:2980)
02-05 16:41:50.321: E/AndroidRuntime(489):  ... 11 more
02-05 16:41:50.321: E/AndroidRuntime(489): Caused by: java.io.FileNotFoundException: Multiple items at content://media/external/images/media
02-05 16:41:50.321: E/AndroidRuntime(489):  at android.database.DatabaseUtils.readExceptionWithFileNotFoundExceptionFromParcel(DatabaseUtils.java:144)
02-05 16:41:50.321: E/AndroidRuntime(489):  at android.content.ContentProviderProxy.openTypedAssetFile(ContentProviderNative.java:612)
02-05 16:41:50.321: E/AndroidRuntime(489):  at android.content.ContentResolver.openTypedAssetFileDescriptor(ContentResolver.java:628)
02-05 16:41:50.321: E/AndroidRuntime(489):  at android.content.ContentResolver.openAssetFileDescriptor(ContentResolver.java:557)
02-05 16:41:50.321: E/AndroidRuntime(489):  at android.content.ContentResolver.openInputStream(ContentResolver.java:392)
02-05 16:41:50.321: E/AndroidRuntime(489):  at android.provider.MediaStore$Images$Media.getBitmap(MediaStore.java:725)
02-05 16:41:50.321: E/AndroidRuntime(489):  at your.Mobile.FotocameraActivity.onActivityResult(FotocameraActivity.java:122)
02-05 16:41:50.321: E/AndroidRuntime(489):  ... 13 more 
```

希望你能帮我！（如果我不能很好地解释这个问题，我很抱歉！）

非常感谢！

塞尔吉奥

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T16:12:47.960

使用 URI return in `onActivityResult`from`data intent`获取`getBitmap`：

```
if (requestCode == CAMERA_REQUEST) {
      Bitmap datifoto = null;
      Uri picUri = data.getData();//<- get Uri here from data intent
       if(picUri !=null){
         try {
             datifoto = android.provider.MediaStore.Images.Media.getBitmap(
                                     this.getContentResolver(), 
                                     picUri);
         } catch (FileNotFoundException e) {
            throw new RuntimeException(e);
         } catch (IOException e) {
            throw new RuntimeException(e);
         }
    } 
```

# html - IE 上的 VLC javascript API

> ID：14711438
> 
> 赞同：1
> 
> 时间：2013-02-05T15:51:09.410
> 
> 标签：html, internet-explorer, vlc

我正在尝试为所有浏览器实现[vlc 网络插件。](http://wiki.videolan.org/Documentation:WebPlugin)

从现在开始我能得到的最好的，它是一个在 chrome 和 firefox 等浏览器和静态插件上完全工作的插件，无需访问 IE 9 和 8 中的 javascript API。

**HTML：**

```
<div class="span8" id="playerContainer">
    <!--[if IE]>
    <object
        classid="clsid:9BE31822-FDAD-461B-AD51-BE1D1C159921" 
        id="vlcPlayer"
        name="vlcPlayer"
        events="True" width="800" height="450">
          <param name="Src" value="" />
          <param name="ShowDisplay" value="True" />
          <param name="AutoLoop" value="True" />
          <param name="AutoPlay" value="True" />
          <param name="Toolbar" value="false"></param>
    </object>
    <![endif]-->
</div> 
```

在这里我以这种方式包含 IE 插件，因为如果我使用带有 javascript 的动态插入，插件将被强制设置为 0px 的宽度和高度，并且永远不会显示。

**JS：**

```
function initVLC(width,height,stream)
{
    var embed   = "<div>Error loading plugin</div>";

    if(! $.browser.msie) {
        embed = '<embed type="application/x-vlc-plugin" pluginspage="http://www.videolan.org"'+
                        'id="vlcPlayer"'+
                        'toolbar ="false"'+
                        'autoplay="yes" loop="yes" width="'+width+'" height="'+height+'"'+
                        'target="" style="margin-bottom: 40px;" />';

        $('#playerContainer').html(embed);            
    }
    updateStream(stream);
}

function updateStream(stream)
{
    var vlc     = null;
    vlc = document.getElementById('vlcPlayer');
    vlc.playlist.stop();
    vlc.playlist.items.clear();
    vlc.playlist.add(stream);
    vlc.playlist.play();
} 
```

在 Chrome 或 firefox 上一切正常。在 IE 上，如果我不调用`updateStream()`插件，则会显示该插件，但一旦我尝试使用 javascript API，插件就会消失（存在于 DOM 中但未显示）并且什么也没有发生。

当我使用 IE9 调试时，vlc 对象似乎没问题，并且没有显示错误：

![IE9 上的 vlc 对象](../Images/d9568202439c934b98ee3513bff8499a.png)

**我如何使用带有 IE 9 和 8 的 JS API 来初始化和更新 vlc 播放的流？**

任何工作样品将不胜感激

注意：我在 Win 7 64 位上使用 vlc 2.0.5 进行测试，我的网页有一个 html5 文档类型

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T08:02:23.727

我已经切换到[FbVLC](http://code.google.com/p/fbvlc/)，它是使用 Firebreath 的 vlc 插件。

它工作得很好，只需要在非 Windows 客户端上使用经典 vlc 即可。

# javascript - Javascript - 从动态创建的元素中收集变量

> ID：14711445
> 
> 赞同：0
> 
> 时间：2013-02-05T15:51:25.140
> 
> 标签：javascript, forms, validation, dynamic, undefined

基本上这是我的javascript的添加功能

```
function Add(){
    var newDiv7 = document.createElement("div");
    newDiv7.setAttribute("class","StartDate");
    newDiv7.innerHTML = 'Description: <input type="text" name="Description[]">';
    document.getElementById("container").appendChild(newDiv7);
} 
```

这是我的主要形式

```
<form name="MainDATA" method="POST" action="Executer.php" onSubmit="validate()">
    <div id="container">
        <div id="cmd">
        <input type="button" value="Add" onclick="Add()">
        <input type="submit" name="submit" value="Submit">
        </div>
    </div>
</form> 
```

验证 javascript

```
function validate(){
    var y = document.forms["MainDATA"]["Description[]"];
    alert(y);
    //validation code
} 
```

仅当用户`div`在我的表单中添加了一个时，此代码才能完美运行。我能够将我的描述转移到`y`进行验证，但是当用户添加 2`div`秒时，我的`y`变成了`undefined`. `div`无论用户添加了多少 s，我该怎么做才能收集所有描述？

另外，如果我想检查“y”的长度是否至少为 10 个字符，我该怎么做才能做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:03:12.293

它似乎工作正常。

只是计数器变量未定义。

```
var counter = 0;

function Add() {
    var newDiv7 = document.createElement("div");
    newDiv7.setAttribute("class", "StartDate");
    newDiv7.innerHTML = 'Description: <input type="text" name="Description[]">';
    document.getElementById("container").appendChild(newDiv7);
    document.getElementById("counter").value = counter;
}

function validate() {
    var y = document.forms["MainDATA"]["Description[]"];
    console.log(y);
    //validation code
} 
```

查看[FIDDLE上的工作示例](http://jsfiddle.net/UzQ9T/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:20:09.537

我在 Firefox 18 上运行它并且没有任何问题。你能试试这个[小提琴吗](http://jsfiddle.net/Vkxgd/)

```
f d() 
```

# sql - 试图参数化一条 sql 行并且似乎无法平衡引号

> ID：14711446
> 
> 赞同：-1
> 
> 时间：2013-02-05T15:51:28.573
> 
> 标签：sql, sql-server

我想采用下面的行并将日期和时间戳作为传入的参数，但我似乎无法绕过不平衡的撇号。

所以这：

```
@tsmobject = N'Server\Instance\BackupName_2013-02-01_22.35.bak', 
```

应该最终看起来像这样？

```
@tsmobject = 'N'Server\Instance\backupName_' + @time + '.bak'', 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:54:17.153

这应该有效：

```
@tsmobject = N'Server\Instance\backupName_' + @time + '.bak' 
```

但这取决于数据类型和格式`@time`- 确保这是正确的格式以匹配您的备份。

# ios - 自动布局约束

> ID：14711447
> 
> 赞同：2
> 
> 时间：2013-02-05T15:51:31.947
> 
> 标签：ios, objective-c, autolayout, nslayoutconstraint

我需要一个视图在纵向模式下垂直居中并在横向模式下向右移动（比如 150 像素）。

我尝试设置一些约束，但似乎无法确定：

```
[myImage addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"H:|-(577@700)-[contentView]-(257@800)-|"
                                                                options:0
                                                                metrics:nil
                                                                  views:NSDictionaryOfVariableBindings(contentView)]];

NSLayoutConstraint *myConstraint = [NSLayoutConstraint constraintWithItem:contentView
                                                    attribute:NSLayoutAttributeCenterX
                                                    relatedBy:NSLayoutRelationEqual
                                                       toItem:myImage
                                                    attribute:NSLayoutAttributeCenterX
                                                   multiplier:1.0
                                                     constant:-1];
myConstraint.priority = 700;

[myImage addConstraint:myConstraint]; 
```

这适用于横向模式，但不适用于纵向。在纵向中，左侧约束 (570@700) 失败，然后左侧约束可以成功 (257@800) 并且中心 X 永远不会实现。我需要第一组（570@700 和 257@800）都失败，以便它可以诉诸中心 X 约束。

还是我应该放弃 centerX 约束？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:26:34.880

我看到两个选项：

*   添加使`contentView`'s CenterX = `myImage`'s CenterX 的约束，并保存对约束的引用。当设备旋转到横向时，将Constraint的常数设置为150；当旋转为纵向时，将常量设置为 0。
*   当设备旋转时，移除`contentView`的水平位置和尺寸约束，并为您的设备方向添加适当的约束。

如果新的 Apple 设备具有不同的尺寸，则第一种选择更简单，但不会过时。如果您使用第一个选项，则不需要`@"H:|-(577)-[contentView]-(257)-|"`约束，但您需要一个约束来告知`contentView`其水平尺寸。

如果您希望我详细说明任一选项，请告诉我。

# visual-studio-2012 - TFS2010 与 VS2012 工作流构建过程模板

> ID：14711451
> 
> 赞同：4
> 
> 时间：2013-02-05T15:51:46.083
> 
> 标签：visual-studio-2012, workflow, build-automation

众所周知，Visual Studio 2010 与使用 Visual Designer 编辑 XAML 文件的构建过程模板一起工作非常缓慢（更多信息请参见：[为什么工作流设计器在编辑构建过程模板时如此缓慢？](https://stackoverflow.com/questions/6344234/why-is-the-workflow-designer-so-extremely-slow-when-editing-build-process-templa)）。出于这个原因，我开始使用 Visual Studio 2012，效果非常好。每个文件保存需要 2 秒，而不是我使用 Visual Studio 2010 获得的 40 秒。为了使其正常工作，我必须清理版本化程序集并将我的自定义程序集更改为 .NET 4.5 框架。

一旦我把所有东西都整理好（在可视化设计器中加载工作流而没有错误），我使用该工作流针对我们的 TFS2010 服务器启动了构建定义，我收到了下一条错误消息：

> TF215097：为构建定义 \MyProject\MyBuildDefinition 初始化构建时出错：无法设置未知成员“{ [http://schemas.microsoft.com/netfx/2009/xaml/activities](http://schemas.microsoft.com/netfx/2009/xaml/activities) }TextExpression.NamespacesForImplementation”。

是否可以在 TFS2010 中运行 VS2012 编辑的构建模板？如果是这样，我该如何解决这个问题？

我尝试了以下[博客](http://osnabrugge.wordpress.com/2012/08/08/lessons-learned-in-upgrading-my-tfs-2010-build-templates-to-tfs-2012/)建议，但没有结果。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-09-10T19:16:44.147

这绝对是可能的。我的团队在 TFS2010 上运行 VS2012 编辑的工作流程长达 6 个月左右。您确定您尝试了博客文章中的解决方案吗？您的错误消息特别引用了“TextExpression.NamespacesForImplementation”部分，如果您按照博客文章应该已完全删除。有时我发现在签入新版本的工作流 XAML 后，我必须打开构建定义，摆弄一些参数，然后保存并关闭它。

另外，为了更好地衡量，请确保您的构建机器（控制器和代理）已更新到最新版本（我认为应该是更新 3？）。

# c# - 将文本附加到文件 Windows 商店应用程序（Windows RT）

> ID：14711453
> 
> 赞同：10
> 
> 时间：2013-02-05T15:51:48.540
> 
> 标签：c#, windows-8, windows-runtime, windows-store-apps

我正在寻找一种将字符串文本附加到 Windows 应用商店应用程序中的文件的方法。我已尝试读取该文件，然后创建一个新文件以覆盖它，但 Windows Store Apps C# 不像 C 那样工作，在创建具有相同名称的新文件时会覆盖旧文件。目前我的代码正在打开旧文件，读取它的内容，删除它并使用我读取的内容以及我希望附加的内容创建一个新文件。我知道有更好的方法，但我似乎找不到。那么如何将文本附加到 Windows 应用商店应用程序 (Windows RT) 中已存在的文件中？

编辑 -

我试过这个

```
var folder = Windows.ApplicationModel.Package.Current.InstalledLocation;
var file = await folder.GetFileAsync("feedlist.txt");
await Windows.Storage.FileIO.AppendTextAsync(file, s); 
```

但是`System.UnauthorizedAccessException` 根据 MSDN，当文件是只读的（我检查了右键单击属性，它不是）并且如果我没有访问文件的必要权限时，会发生这种情况，我该怎么办？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-05T23:01:27.350

您可以使用[FileIO](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.fileio.aspx)类附加到文件。例如 ...

```
// Create a file in local storage
var folder = ApplicationData.Current.LocalFolder;
var file = await folder.CreateFileAsync("temp.txt", CreationCollisionOption.FailIfExists);

// Write some content to the file
await FileIO.WriteTextAsync(file, "some contents");

// Append additional content
await FileIO.AppendTextAsync(file, "some more text"); 
```

查看[文件访问示例](http://code.msdn.microsoft.com/windowsapps/File-access-sample-d723e597/)以获取更多示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-27T13:48:27.357

使用 FileIO.AppendTextAsync 是一个不错的选择。请为此找到代码片段。

*   首先它创建一个文件夹，如果不存在的话。否则不会创建。

*   然后，如果不存在，它会创建一个文件。

*   最后将文本附加到文件中。

    ```
    public static async void  WriteTrace(TraceEventType eventType, string msg, [CallerMemberName] string methodName = "")
    {
         const string TEXT_FILE_NAME = "Trace.txt";
        string logMessage = eventType.ToString() + "\t" + methodName + "\t" + msg ;
        IEnumerable<string> lines = new List<string>() { logMessage }; 
        StorageFolder localFolder = ApplicationData.Current.LocalFolder;
        StorageFolder tempFolder = ApplicationData.Current.TemporaryFolder;

        //if(localFolder.CreateFolderQuery(Windows.Storage.Search.CommonFolderQuery.)
        StorageFolder LogFolder = await localFolder.CreateFolderAsync("LogFiles", CreationCollisionOption.OpenIfExists);

        await LogFolder.CreateFileAsync(TEXT_FILE_NAME, CreationCollisionOption.OpenIfExists);

        StorageFile logFile = await LogFolder.GetFileAsync(TEXT_FILE_NAME);

        await FileIO.AppendLinesAsync(logFile, lines);

    } 
    ```

# actionscript-3 - 关于静态谷歌地图的咨询

> ID：14711457
> 
> 赞同：0
> 
> 时间：2013-02-05T15:52:00.777
> 
> 标签：actionscript-3

我是 Flash 新手，需要您的建议。很长一段时间以来，我一直在使用密钥使用 Google Maps API 制作应用程序，但现在当我启动页面时，它已被弃用。我见过其他应用程序，它仍然可以与这个 API 一起使用。我必须更改我的申请吗？我已经研究了许多处理静态地图的方法，但我找不到任何可以帮助我的方法。

如果有任何提示或建议，我将不胜感激。我在 CS5 中使用 Flash AS3。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T00:16:18.347

感谢您的回答，

抱歉，也许我会问一些愚蠢的问题，但是因为当我测试主 swf 并加载其他加载地图的 swfs 文件时，舞台的所有内容都会消失到主 swf 中？

感谢您的任何建议。

问候

乔西

# php - 将表单字段值保存为数组

> ID：14711458
> 
> 赞同：0
> 
> 时间：2013-02-05T15:52:05.237
> 
> 标签：php, jquery, html

我有一个名为`$_POST['hidden-tags']`

它的输入值如下

```
cars, vans, bikes, trains, 
```

我在帖子上尝试拆分值并将它们保存到一个数组中，然后将该数组与我拥有的另一个数组进行比较，只显示不同的值。我知道 $arr1 有值，因为我已经测试了数据。

我到目前为止的代码是

```
 $arr1;

  $arr2 = array();

foreach($_POST['hidden-tags'] as $value){
$arr2[] = explode(",",$value);  
}

print_r($arr2);

   // $tmp = array_diff_key($arr1, $arr2);
     //  echo $tmp; 
```

我在堆栈 [PHP 爆炸数组中找到的部分](https://stackoverflow.com/questions/3697008/php-explode-array)

如您所见，我已将最后一点注释掉。这样我就可以看到数组值。如果我回显 $arr2 我在屏幕上看到的只是

> 大批（）

即使我已经进入了汽车、自行车、货车。我还没有比较两个数组并显示 $tmp 变量

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:55:06.663

是`$_POST['hidden-tags']`文本输入字段吗？如果是这样，您无需`foreach`在其上运行 a 即可将其拆分为数组。只需将其分解并将生成的数组与您已有的数组进行比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:57:31.230

我不认为 $_POST['hidden-tags'] 是一个数组，而是一个要拆分的字符串。

此外，我认为您不想将 POST 变量上的拆分操作的结果保存在 $arr2 的下一个索引中，因为拆分将返回一个数组，这样您将在数组中拥有一个数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:16:55.403

```
 $arr1;

    $arr2 = array();

    $arr2[] = explode(",",$_POST['hidden-tags']);  

    print_r($arr2);

    $tmp = array_diff_key($arr1, $arr2);
    echo $tmp; 
```

# c# - Kinect：计算头部的俯仰角、偏航角、滚动角

> ID：14711459
> 
> 赞同：3
> 
> 时间：2013-02-05T15:52:11.013
> 
> 标签：c#, kinect

我正在尝试使用 Kinect 传感器和 SDK 来计算用户头部的方向，但我无法在谷歌上找到任何好的帮助。有没有人有任何好的样本、教程或类似的东西可以帮助我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T02:57:19.623

我认为我已经找到了一个解决方案，虽然它是有限的，但它只有在 Kinect SDK 可以检测到面部时才有效，因为我正在使用该`FaceTrackFrame`对象。

如果有人在 Kinect SDK 无法检测到人脸时找到跟踪更极端角度的解决方案，我会更高兴看到它。

我的解决方案如下所示：

```
 FaceTrackFrame faceFrame = faceTracker.Track(
            kinectSensor.ColorStream.Format, colorPixelData,
            kinectSensor.DepthStream.Format, depthPixelData, skeleton);

        // Only works if face is detected
        if (faceFrame.TrackSuccessful)
        {
            txtTracked.Content = "TRACKED";
            txtRoll.Content = faceFrame.Rotation.Z;
            txtPitch.Content = faceFrame.Rotation.X;
            txtYaw.Content = faceFrame.Rotation.Y;
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T23:46:49.980

我设法使用图像中的深度数据手动计算这些。

首先你需要得到深度点

```
 private EnumIndexableCollection<FeaturePoint, Vector3DF> depthPoints; 
```

然后如果你看SDK自带的FaceTracking查看器代码，搜索DrawFaceModel函数。您可以在第一个 for 循环中提取这样的代码。

```
 faceModelPts3D.Add(new Point3D(this.depthPoints[i].X + 0.5f, this.depthPoints[i].Y + 0.5f, this.depthPoints[i].Z + 0.5f));
    FaceDataPoints.DepthXPointInfo[i] = this.depthPoints[i].X;
    FaceDataPoints.DepthYPointInfo[i] = this.depthPoints[i].Y;
    FaceDataPoints.DepthZPointInfo[i] = this.depthPoints[i].Z; 
```

然后我将点 0 和点 9 放入以下函数中以获得音高。然后我将点 120 和 116 放入以获得打哈欠角度。

```
 public static double FacePitch(double FirstXPos, double FirstYPos, double FirstZPos, double SecXPos, double SecYPos, double SecZPos)
    {
        double PitchAngle = 0;
        double r = 0;
        double XDifference, YDifference, ZDifference = 0;
        double DifferenceSquared = 0;

        XDifference = FirstXPos - SecXPos;//Calculates distance from Points 
        YDifference = FirstYPos - SecYPos;
        ZDifference = FirstZPos - SecZPos;

        DifferenceSquared = Math.Pow(XDifference, 2) + Math.Pow(YDifference, 2) + Math.Pow(ZDifference, 2);

        r = Math.Sqrt(DifferenceSquared);

        PitchAngle = (Math.Acos(ZDifference / r));

        PitchAngle = ((PitchAngle * 180 / Math.PI) - 90) * -1; //Converts to Degrees as easier to recognise visually 

        return PitchAngle;
    } 
```

对于滚动，我再次将点 0 和 9 放入并再次使用上述功能但我改变了

```
PitchAngle = (Math.Acos(ZDifference / r)); 
```

到

```
RollAngle = Math.Acos(XDifference / r); 
```

# jquery - jQuery UI 选项卡自动启用键盘控制

> ID：14711462
> 
> 赞同：0
> 
> 时间：2013-02-05T15:52:13.237
> 
> 标签：jquery, user-interface, tabs, keyboard

目前，jQuery UI 选项卡容器具有键盘控制，可以通过左右键在选项卡之间切换，但只有在单击选项卡后才会启用。有没有办法随意显式启用和禁用小部件的键盘控制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:56:53.367

我相信你可以通过在启动时关注标签容器

```
$("#myTabContainer").focus();

// or if you need to have focus on a tab

$("#myFirstTab").focus(); 
```

但不要一遍又一遍地重置焦点，否则用户无法输入任何文本字段或单击滚动网站

# r - 在 ggplot2 中绘制 envfit 向量（素食包）

> ID：14711470
> 
> 赞同：13
> 
> 时间：2013-02-05T15:52:37.403
> 
> 标签：r, ggplot2, vegan

我正在努力完成我在 vegan 和 ggplot2 中创建的 NMDS 图，但无法弄清楚如何将 envfit 物种加载向量添加到图中。当我尝试它说“无效的图形状态”。

下面的例子是从另一个问题（[Plotting ordiellipse function from vegan package to NMDS plot created in ggplot2](https://stackoverflow.com/questions/13794419/plotting-ordiellipse-function-from-vegan-package-onto-nmds-plot-created-in-ggplo)）稍微修改的，但它准确地表达了我想要包括的例子，因为我首先使用这个问题来帮助我将 metaMDS 放入 ggplot2 中：

```
library(vegan)
library(ggplot2)
data(dune)

# calculate distance for NMDS
NMDS.log<-log(dune+1)
sol <- metaMDS(NMDS.log)

# Create meta data for grouping
MyMeta = data.frame(
  sites = c(2,13,4,16,6,1,8,5,17,15,10,11,9,18,3,20,14,19,12,7),
  amt = c("hi", "hi", "hi", "md", "lo", "hi", "hi", "lo", "md", "md", "lo", 
      "lo", "hi", "lo", "hi", "md", "md", "lo", "hi", "lo"),
row.names = "sites")

# plot NMDS using basic plot function and color points by "amt" from MyMeta
plot(sol$points, col = MyMeta$amt)

# same in ggplot2
NMDS = data.frame(MDS1 = sol$points[,1], MDS2 = sol$points[,2])
ggplot(data = NMDS, aes(MDS1, MDS2)) + 
  geom_point(aes(data = MyMeta, color = MyMeta$amt))

#Add species loadings
vec.sp<-envfit(sol$points, NMDS.log, perm=1000)
plot(vec.sp, p.max=0.1, col="blue") 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-05-10T15:38:25.300

（否则很好）接受的答案的问题，这解释了为什么向量在包含的图中都是相同的长度[*请注意，接受的答案现在已被编辑，以按照我在下面描述的方式缩放箭头，以避免遇到 Q&A 的用户感到困惑的*是，存储在`$vectors$arrows`返回的对象的组件中的`envfit()`是拟合向量的方向余弦。这些都是单位长度，因此@Didzis Elferts 图中的箭头都是相同的长度。这与来自的输出不同`plot(envfit(sol, NMDS.log))`，并且出现是因为我们通过与排序配置（“轴”）的相关性来缩放矢量箭头坐标。这样，与排序配置关系较弱的物种会得到更短的箭头。缩放是通过将方向余弦乘以打印输出表中显示的值来`sqrt(r2)`完成的。`r2`将向量*添加*到现有绘图时，**vegan**还尝试缩放向量集，以便它们填充可用绘图空间，同时保持箭头的相对长度。这是如何完成的在**细节**部分讨论`?envfit`并且需要使用未导出的函数`vegan:::ordiArrowMul(result_of_envfit)`。

这是一个完整的工作示例，它复制了`plot.envfit`使用**ggplot2**的行为：

```
library(vegan)
library(ggplot2)
library(grid)
data(dune)

# calculate distance for NMDS
NMDS.log<-log1p(dune)
set.seed(42)
sol <- metaMDS(NMDS.log)

scrs <- as.data.frame(scores(sol, display = "sites"))
scrs <- cbind(scrs, Group = c("hi","hi","hi","md","lo","hi","hi","lo","md","md",
                              "lo","lo","hi","lo","hi","md","md","lo","hi","lo"))

set.seed(123)
vf <- envfit(sol, NMDS.log, perm = 999) 
```

如果我们在这一点停下来看看`vf`：

```
> vf

***VECTORS

             NMDS1       NMDS2     r2 Pr(>r)    
Belper -0.78061195 -0.62501598 0.1942  0.174    
Empnig -0.01315693  0.99991344 0.2501  0.054 .  
Junbuf  0.22941001 -0.97332987 0.1397  0.293    
Junart  0.99999981 -0.00062172 0.3647  0.022 *  
Airpra -0.20995196  0.97771170 0.5376  0.002 ** 
Elepal  0.98959723  0.14386566 0.6634  0.001 ***
Rumace -0.87985767 -0.47523728 0.0948  0.429
.... <truncated> 
```

因此，`r2`数据用于缩放列`NMDS1`和中的值`NMDS2`。最终的情节是通过以下方式产生的：

```
spp.scrs <- as.data.frame(scores(vf, display = "vectors"))
spp.scrs <- cbind(spp.scrs, Species = rownames(spp.scrs))

p <- ggplot(scrs) +
  geom_point(mapping = aes(x = NMDS1, y = NMDS2, colour = Group)) +
  coord_fixed() + ## need aspect ratio of 1!
  geom_segment(data = spp.scrs,
               aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
               arrow = arrow(length = unit(0.25, "cm")), colour = "grey") +
  geom_text(data = spp.scrs, aes(x = NMDS1, y = NMDS2, label = Species),
            size = 3) 
```

这会产生：

![在此处输入图像描述](../Images/2e7be6008a2ee2d07fdff56a6cb4b9a3.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-05T16:35:08.877

从添加库开始。另外图书馆`grid`是必要的。

```
library(ggplot2)
library(vegan)
library(grid)
data(dune) 
```

进行 metaMDS 分析并将结果保存在数据框中。

```
NMDS.log<-log(dune+1)
sol <- metaMDS(NMDS.log)

NMDS = data.frame(MDS1 = sol$points[,1], MDS2 = sol$points[,2]) 
```

添加物种载荷并将它们保存为数据框。箭头余弦的方向存储在 list`vectors`和 matrix`arrows`中。`r2`要获得箭头的坐标，这些方向值应乘以存储在 中的值的平方根`vectors$r`。更直接的方法是使用`scores()`@Gavin Simpson 的回答中提供的功能。然后添加包含`species`名称的新列。

```
vec.sp<-envfit(sol$points, NMDS.log, perm=1000)
vec.sp.df<-as.data.frame(vec.sp$vectors$arrows*sqrt(vec.sp$vectors$r))
vec.sp.df$species<-rownames(vec.sp.df) 
```

箭头用 加上`geom_segment()`，物种名称用`geom_text()`。这两个任务都使用数据框`vec.sp.df`。

```
ggplot(data = NMDS, aes(MDS1, MDS2)) + 
  geom_point(aes(data = MyMeta, color = MyMeta$amt))+
  geom_segment(data=vec.sp.df,aes(x=0,xend=MDS1,y=0,yend=MDS2),
      arrow = arrow(length = unit(0.5, "cm")),colour="grey",inherit_aes=FALSE) + 
  geom_text(data=vec.sp.df,aes(x=MDS1,y=MDS2,label=species),size=5)+
  coord_fixed() 
```

![在此处输入图像描述](../Images/ac5da981638b3dddfefc2c6fd706865f.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-08-21T11:31:31.080

我可以晚点加点东西吗？

Envfit 提供 pvalues，有时您只想绘制重要参数（纯素食者可以在 plot 命令中使用 p.=0.05 为您做一些事情）。我很难用 ggplot2 做到这一点。这是我的解决方案，也许你找到一个更优雅的解决方案？

从上面Didzis的回答开始：

```
ef<-envfit(sol$points, NMDS.log, perm=1000)
ef.df<-as.data.frame(ef$vectors$arrows*sqrt(ef$vectors$r))
ef.df$species<-rownames(ef.df)

#only significant pvalues
#shortcutting ef$vectors
A <- as.list(ef$vectors)
#creating the dataframe
pvals<-as.data.frame(A$pvals)
arrows<-as.data.frame(A$arrows*sqrt(A$r))
C<-cbind(arrows, pvals)
#subset
Cred<-subset(C,pvals<0.05)
Cred <- cbind(Cred, Species = rownames(Cred)) 
```

如上所述，“Cred”现在可以在 geom_segment-argument 中实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-05-20T12:00:30.487

简短补充：为了在“箭头长度充分利用绘图区域”中获得`plot.envfit`功能的完整表示，`ggplot2`需要应用一个因素。我不知道上面的答案是否故意遗漏了它，因为加文甚至特别提到了它？只需使用提取所需的比例因子`arrow_factor <- ordiArrowMul(vf)`，然后您可以将其应用于两个 NMDS 列，`spp.scrs`或者您可以手动执行此操作，如

```
arrow_factor <- ordiArrowMul(vf)
spp.scrs <- as.data.frame(scores(vf, display = "vectors")) * arrow_factor
spp.scrs <- cbind(spp.scrs, Species = rownames(spp.scrs), Pvalues = vf$vectors$pvals, R_squared = vf$vectors$r)

# select significance similarly to `plot(vf, p.max = 0.01)`
spp.scrs <- subset(spp.scrs, Pvalues < 0.01)

# you can also add the arrow factor in here (don't do both!)
ggplot(scrs) +
  geom_point(mapping = aes(x = NMDS1, y = NMDS2, colour = Group)) +
  coord_fixed() + ## need aspect ratio of 1!
  geom_segment(data = spp.scrs,
               aes(x = 0, xend = NMDS1 * arrow_factor, y = 0, yend = NMDS2 * arrow_factor),
               arrow = arrow(length = unit(0.25, "cm")), colour = "grey") +
  geom_text(data = spp.scrs, aes(x = NMDS1 * arrow_factor, y = NMDS2 * arrow_factor, label = Species),
            size = 3) 
```

# python - 当它的调用超过多行时，我如何进入一个函数？

> ID：14711472
> 
> 赞同：1
> 
> 时间：2013-02-05T15:52:49.727
> 
> 标签：python, pdb

假设我有这个代码示例：

```
function1(
    'arg1',
    'arg2',
    function2(
        'arg3.1',
        'arg3.2',
    ),
) 
```

根据 pdb 的文档，我可以通过键入`s`. 但是，在第一行按下`s`不会产生预期的效果，它只会将控制权传递给后续行。

我怎么能踏入`function1`而不踏入`function2`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:55:06.820

每行都显示为一个单独的表达式，pdb 将在计算右括号之前的最后一个表达式之后立即进入一个函数。

你无法阻止步入`function2`；step in, straight out with `r`，然后在返回时使用`s`step into 。如果您要*跨过*（当出现带有的行时） ，您将一次性跨过两者。`function1``function2` *`function2``arg3.2``function2``function1`*

# php - strcmp vs. == vs. === 在 PHP 中用于检查哈希相等

> ID：14711474
> 
> 赞同：17
> 
> 时间：2013-02-05T15:52:52.983
> 
> 标签：php, string, security, bcrypt, crypt

我`crypt()`在 PHP 中使用哈希密码，并试图找出在执行密码检查时测试结果哈希是否相等的最安全方法。

我可以看到三个选项：

**选项 1 - 双等号**

```
function checkPassword($hash, $password)
{
    return crypt($password, $hash) == $hash;
} 
```

**选项 2 - 三等分**

```
function checkPassword($hash, $password)
{
    return crypt($password, $hash) === $hash;
} 
```

**选项 3 -`strcmp()`**

```
function checkPassword($hash, $password)
{
    return strcmp(crypt($password, $hash), $hash) === 0;
} 
```

我的直觉告诉我选项 1 是个坏主意，因为缺少类型检查，而选项 2 或 3 可能会更好。但是，我无法确定是否存在特定案例`===`或`strcmp`将失败。为此目的，哪个最安全？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-05T16:59:03.977

在安全性方面，我更喜欢使用`===`操作员。`===`确保两个操作数完全相同，而无需尝试容纳一些强制转换以“帮助”比较以达到成功的匹配 - 因为它在开发时可能会有所帮助，这要归功于 PHP 等松散类型的语言。

当然，其中一个操作数是可信任的。来自数据库的散列是可信任的，而用户输入则不是。

人们总是可以犹豫一段时间，得出的结论是`==`在特定情况下使用没有风险。也许。但例如

```
 "0afd9f7b678fdefca" == 0 is true
  "aafd9f7b678fdefca" == 0 is also true 
```

由于 PHP 尝试将“哈希”转换为一个数字（可能使用*atoi*），它给出 0。虽然它不太可能`crypt`返回 0，但我更愿意最大化密码不匹配的情况（并接听支持电话）通过使用`===`, 而不是允许使用`==`.

至于`strcmp`，如果不同，函数返回`<0`or `>0`，如果相等则返回 0。但

```
 strcmp("3", 0003) returns 0
  strcmp("0003", 0003) returns -3 
```

毕竟这并不奇怪。文字`0003`实际上是一个整数，`3`由于*strcmp*需要一个字符串，因此`3`将转换为`"3"`. 但这表明在这种情况下可能会发生一些转换，因为*strcmp*是一个函数，而`===`它是语言的一部分。

所以我在这种情况下的偏好是`===`（这比`==`无论如何都要快）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-11-21T16:59:07.080

您应该使用 PHP 中内置的 hash_equals() 函数。没有必要制作自己的功能。hash_equals() 将返回一个布尔值。

在我看来，使用 == 或 === 比较字符串通常不是一个好主意，更不用说散列字符串了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-13T16:26:30.900

那是不正确的，请看函数的定义。根据 PHP：

`Returns < 0 if str1 is less than str2;`

`> 0 if str1 is greater than str2,`

`and 0 if they are equal`

如果 str1 小于 str2，则返回小于 0。请注意短语“小于”，它不仅返回 -1，还返回任何负值。当 str1 大于 str2 时也会发生同样的情况，但它返回一个正的非零值。它返回一个正值，可以是 1，也可以是其后的任何数字。

`strcmp()`返回一个数字，该数字是从发现的最后一个相似字符开始的两个字符串之间的差异。

这是一个例子：

`$output = strcmp("red", "blue");`

变量 $output 包含的值为 16

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2013-02-05T15:58:50.447

我认为`==`在你的情况下使用就足够了。

`==`无论类型如何都检查相等，而`===`检查相等和类型。

`1 == "1"`= 真

`1 === "1"`= 假

由于我们不太关心类型，所以我会保持简单并使用`==`.

# android - 从通知中实现 setOnClickPendingIntent

> ID：14711475
> 
> 赞同：1
> 
> 时间：2013-02-05T15:52:53.383
> 
> 标签：android, broadcastreceiver, android-notifications, android-pendingintent

我构建了包含按钮的自定义通知，并且我想在用户按下它时列出。

该按钮不应打开任何活动，而只能打开诸如更改歌曲之类的逻辑人员。

编码：

```
 RemoteViews contentView = new RemoteViews(getPackageName(), R.layout.notification);
        contentView.setTextViewText(R.id.toptext, nowPlayingTitle);

        //this not work
        Intent intent = new Intent(this, receiver.class);
        intent.putExtra("UNIQ", "1");
        PendingIntent pendingIntent = PendingIntent.getBroadcast(
                this.getApplicationContext(), 234324243, intent, PendingIntent.FLAG_CANCEL_CURRENT)
        contentView.setOnClickPendingIntent(R.id.imageButtonPlay,
                pendingIntent);
        notification.contentView = contentView; 

        // this is to return to my activity if click somwhere else in notification
        Intent notificationIntent = new Intent(this, MYACTIVITY.class);
        PendingIntent contentIntent = PendingIntent.getActivity(this, 0, notificationIntent, 0);
        notification.contentIntent = contentIntent;

        mNotificationManager.notify(NOTIFICATION_ID, notification); 
```

我不明白 setOnClickPendingIntent 的第二个参数需要什么？用户按下按钮后如何调用函数？

我可能错过了一些东西，因为我不了解接收方以及用户按下后发生了什么

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T16:09:54.077

您错过了您创建的按钮实际上不属于您的应用程序的事实。它是在另一个上下文中，在另一个过程中创建的。它无法调用您的函数。

相反，当用户点击按钮时，会触发待处理的意图。您可以通过接收器（在您的活动中）捕获它，检查一些参数并执行操作。或者你可以实现一个服务并在后台处理这个意图。我更喜欢这种方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:15:11.577

感谢您的快速回答。我尝试使用接收器，但它从未触发。代码在主要问题中，我为接收者类创建了以下代码：

```
public class receiver extends BroadcastReceiver 
{   
    @Override
    public void onReceive(Context context, Intent intent) 
    {
   Bundle bundle = intent.getExtras(); 
    }      
} 
```

但单击通知永远不会触发接收器（在调试模式下测试）

# java - Java 时区转换问题

> ID：14711477
> 
> 赞同：-2
> 
> 时间：2013-02-05T15:52:56.497
> 
> 标签：java

> **可能重复：**
> [Java 时区：为什么需要偏移](https://stackoverflow.com/questions/14705561/java-timezone-why-offset-is-needed)

我的系统时区是。`Asia/Calcutta`我的要求是将一个时区的时间转换为另一个时区。

```
long l = 1223123123232l;// long value representing the date.
TimeZone tz = TimeZone.getTimeZone("Australia/Sydney");// First Time zone
long tzOff = tz.getOffset(l);
java.util.Date d = new Date(l-tzOff);   // WHY THIS??
DateFormat df = new SimpleDateFormat("dd MMM yyyy HH:mm:ss z");
df.setTimeZone(TimeZone.getTimeZone("Africa/Asmara"));// Required Time zone
String s = df.format(d);
System.out.println(s); 
```

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:24:11.070

这是一个重复的问题，已经解决。

使用[Java 时区：为什么需要 Offset](https://stackoverflow.com/questions/14705561/java-timezone-why-offset-is-needed)

或者

试试下面

```
Date date = new Date();
DateFormat dateFormat = new SimpleDateFormat("dd MMM yyyy HH:mm:ss z");     
System.out.println("Default time, timezone EST : "+dateFormat.format(date));        
TimeZone t1 = TimeZone.getTimeZone("Asia/Calcutta");

dateFormat.setTimeZone(t1);
System.out.println("Converted time, timezone IST : "+dateFormat.format(date)); 
```

# qt - 如何在 QT 中向多个网格中添加大量小部件

> ID：14711479
> 
> 赞同：1
> 
> 时间：2013-02-05T15:52:58.077
> 
> 标签：qt, qgridlayout

我在 MySQl 数据库中有一个表，它由产品类别类型、子类别、picUrl 和价格组成。我想将每条记录添加到多个 QGridLayout 小部件中，我已经制作了 Ui 并分配给 QScrollAreas 以用于不同的类别和子类别。

它适用于 100 个项目或少量项目，但如果我将 LIMIT 项目设置为 LIMIT 1000 或任何大于 100 的项目 .. 它开始产生 QThread::start: Failed to create thread() Invalid parameter passing to C运行时函数。错误。QThread::start: 创建线程失败（访问码无效。）

我有时会得到很多 QPixmap::scaled: Pixmap 是一个空像素图但是我的插槽在收到 QNetworkReply 后会更新图片，因此它会在自己的时间加载。

这是因为创建的类太多，如果是这样的话，有没有办法减慢创建速度并添加到我的网格布局中，这样我就可以查看它们了？或者，我应该重新设计和创建包含 100 个项目的页面和/或仅显示 1 个类别的页面而不是包含所有内容的 TabWidget？...

我真的想要在我的 Gridlayouts 中插入任意数量的小部件。

这是我使用的代码。

```
 void checkNewArrivals::addAllItems(){
    QString sql = "SELECT Category, SubCategory, picUrl, usPrice FROM newproducts LIMIT 1000";
    QSqlQuery query(this->db);
    query.exec(sql);
    while (query.next()){
        QString category = query.value(0).toString();
        QString subCategory = query.value(1).toString();
        QString picUrl = query.value(2).toString();
        QString usPrice = query.value(3).toString();
        addItem("id", picUrl, usPrice, category, subCategory);
    }
} 
```

addItem 函数

```
 void checkNewArrivals::addItem(QString id, QString picUrl, QString price, QString category, QString subCategory){
    if (category == "Autumn-Spring"){
        if (subCategory == "Dress"){
            addToGrid(ui->autumnSpringDressLayout, id, picUrl, price);
        }else if (subCategory == "Blouse"){
            addToGrid(ui->autumnSpringBlouseLayout, id, picUrl, price);
        } else if (subCategory == "Long Coat"){
            addToGrid(ui->autumnSpringLongCoatLayout, id, picUrl, price);
        } else if (subCategory == "Short Coat"){
            addToGrid(ui->autumnSpringShortCoatLayout, id, picUrl, price);
        } else if (subCategory == "Sweater"){
            addToGrid(ui->autumnSpringSweaterLayout, id, picUrl, price);
        } else if (subCategory == "Skirt Pants"){
            addToGrid(ui->autumnSpringSkirtPantsLayout, id, picUrl, price);
        } else if (subCategory == "Sportsuit"){
            addToGrid(ui->autumnSpringSportsuitLayout, id, picUrl, price);
        } else if (subCategory == "Vest Bustier"){
            addToGrid(ui->autumnSpringVestBustierLayout, id, picUrl, price);
        }
    }
} 
```

添加到网格的功能

```
 void checkNewArrivals::addToGrid(QGridLayout *layout, QString id, QString picUrl, QString usPrice){
    checkNewArrivalItem *item = new checkNewArrivalItem;
    item->setupItem(id, picUrl, usPrice);
    int row = (layout->count() / 4);
    int col = (layout->count() % 4);
    layout->addWidget(item, row, col);
    qDebug() << "Item Added to Grid: Row: " << row << " Col: " << col << endl;
} 
```

和我的 checkNewArrivalitem 类头

```
 #ifndef CHECKNEWARRIVALITEM_H
#define CHECKNEWARRIVALITEM_H

#include <QWidget>
#include "filedownloader.h"
#include <QGridLayout>

namespace Ui {
class checkNewArrivalItem;
}

class checkNewArrivalItem : public QWidget
{
    Q_OBJECT

public:
    explicit checkNewArrivalItem(QWidget *parent = 0);
    ~checkNewArrivalItem();
    void setupItem(QString id, QString picUrl, QString usPrice);
    FileDownloader *m_pImgCtrl;
    QString id, picUrl, usPrice;
    QGridLayout *layout;

private slots:
    void loadImage();

private:
    Ui::checkNewArrivalItem *ui;
};

#endif // CHECKNEWARRIVALITEM_H 
```

和 checkNewArrivalItem 类 cpp

```
 #include "checknewarrivalitem.h"
#include "ui_checknewarrivalitem.h"

checkNewArrivalItem::checkNewArrivalItem(QWidget *parent) :
    QWidget(parent),
    ui(new Ui::checkNewArrivalItem)
{
    ui->setupUi(this);
}

checkNewArrivalItem::~checkNewArrivalItem()
{
    delete ui;
}

void checkNewArrivalItem::setupItem(QString id, QString picUrl, QString usPrice){
    ui->itemGroupBox->setTitle("ID: " + id);
    ui->priceLabel->setText("US $" + usPrice);
    m_pImgCtrl = new FileDownloader(QUrl(picUrl), this);
    connect(m_pImgCtrl, SIGNAL(downloaded()), SLOT(loadImage()));
    this->setMinimumHeight(267);
}

void checkNewArrivalItem::loadImage(){
    QPixmap *buttonImage = new QPixmap;
    if (!m_pImgCtrl->downloadedData().isNull()){
        buttonImage->loadFromData(m_pImgCtrl->downloadedData());
        int h = ui->photoLabel->height();
        int w = ui->photoLabel->width();
        ui->photoLabel->setPixmap(buttonImage->scaled(w, h, Qt::KeepAspectRatio, Qt::SmoothTransformation));
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:37:33.133

你想做什么不是一个很好的方法。即使你解决了这个错误 - CPU 和内存消耗会非常大，最糟糕的是用户通常无法集中注意力，甚至一次看到 1000 个项目，所以在大多数情况下，它真的是不必要的（这是您没有看到论坛引擎设置显示最后 10000 条回复的部分原因）。

您应该结合 MySql`LIMIT offset, number_of_items`对窗口进行分页（并且不要忘记为用户提供愉快的分页机制）。

# ios - ios , 将音频文件 aac 格式附加到电子邮件

> ID：14711487
> 
> 赞同：0
> 
> 时间：2013-02-05T15:53:36.383
> 
> 标签：ios, email, avaudioplayer, email-attachments, mfmailcomposeviewcontroller

我尝试通过文件 aac (kAudioFormatMPEG4AAC) 格式发送音频记录，但附加的文件没有发送

*myString = file://localhost/private/var/mobile.......

这是我的代码

```
MFMailComposeViewController *picker =
[[MFMailComposeViewController alloc] init];
picker.mailComposeDelegate = self;
[picker setSubject:@"My Audio File"];  
NSString *fileName = @"Rec.aac";  

NSString *documentsDirectory = myString ;

NSString *path = [documentsDirectory stringByAppendingPathComponent:fileName];
NSData   *data = [NSData dataWithContentsOfFile:path];
[picker addAttachmentData:data mimeType:@"audio/aac"
                 fileName:fileName];
NSString *emailBody = @"AAC format sound file attached.";  
[picker setMessageBody:emailBody isHTML:YES];
[self presentModalViewController:picker animated:YES];
[picker release]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:58:16.577

```
NSData   *data = [NSData dataWithContentsOfFile:path]; 
```

您正在传递一个`file://`URL，该方法无法理解该 URL。该方法只需要一个标准文件路径，即`/private/var/mobile/`.

您可以简单地使用文件路径，但如果您只提供了一个 URL 表单字符串，您可以创建一个 URL 对象并将其与 NSData 一起使用。

```
NSURL* fileURL = [NSURL URLwithString:myString];
NSError* error = nil;
NSData* data = [NSData dataWithContentsOfURL:fileURL options:0 error:&error];

if (error) {
    NSLog(@"Unable to load file from provided URL %@: %@", myString, error);
} 
```

# java - 从 Java 向 VBS 传递参数

> ID：14711490
> 
> 赞同：1
> 
> 时间：2013-02-05T15:53:47.780
> 
> 标签：java, parameters, vbscript, runtime, parameter-passing

我从 Java 中调用 VBS 是这样的

```
public class CallVBS {
    public static void main(String[] args) {

        try {
            Runtime.getRuntime().exec("wscript C:\\openURL.vbs");
        } catch (IOException e) {

            System.exit(0);
        }
    }
} 
```

如果我的 openURL.vbs 包含类似的方法

```
Sub Test(Name,Age,Sex) 
```

如何使用 Java 中的参数调用 VBS 中存在的上述方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-10T12:55:08.353

所以只是对 AlexR 做一些改动，因为我认为有一些事情可以用来纠正。

例如，我们有一个名为 MyVBScript.vbs 的 VBS 文件

MyVBScript.vbs 的内容如下：

```
name = WScript.Arguments.Item(0)
age = WScript.Arguments.Item(1)
sex = WScript.Arguments.Item(2)

Call Test(name, age, sex) 
```

*请记住，集合的索引从 0 作为第一次出现开始*

现在在调用这个 VBS 文件的 Java 代码中，我们将具有以下内容：

```
Runtime.getRuntime().exec("wscript C:\\MyVBScript.vbs " + name + " " + age + " " + sex 
```

感谢 AlexR 的原始答案，但我觉得它需要一点澄清。我希望这对人们有所帮助。我个人在我的 Java 测试工具中使用它作为启动 Quick Test Professional 的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T17:08:00.580

可能`getURL.vbs`看起来像这样：

```
Option Explicit

WScript.Echo "openURL.vbs"

Dim a0 : a0 = "Def. A. Ult"
If 1 <= WScript.Arguments.Count Then a0 = WScript.Arguments(0)
Dim a1 : a1 = "47.11"
If 2 <= WScript.Arguments.Count Then a1 = WScript.Arguments(1)
Dim a2 : a2 = "neuter"
If 3 <= WScript.Arguments.Count Then a2 = WScript.Arguments(2)

Test a0, a1, a2

Sub Test(name, age, sex)
  WScript.Echo """" & Join(Array(name, age, sex), """, """) & """"
End Sub 
```

它查看通过命令行在顶层/'main'/立即执行/超出 VBScript 代码的 Sub/Function 部分中传递的参数。

为了避免引用/args 包含空格可能出现的问题，我会使用这个 .exec 调用：

```
String[] parms = {"wscript", "openURL.vbs", "Anna B. Carlson", "12", "fale"};
Runtime.getRuntime().exec(parms); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:19:25.763

你的问题主要不是关于java，而是关于VBS。查看描述如何在 VBS 中读取命令行参数的[讨论。](https://stackoverflow.com/questions/2469754/how-to-pass-and-access-command-line-arguments-in-vbscript)通常你必须使用内置对象`Wscript.Arguments`。解析脚本“主要”部分中的参数并调用您的 subrutine `Test`，例如

```
Set name =  Wscript.Arguments(1)
Set age =  Wscript.Arguments(2)
Set sex =  Wscript.Arguments(3)
Call Test(name, age, sex) 
```

现在您可以从 java 调用您的脚本，如下所示：

```
Runtime.getRuntime().exec("wscript C:\\openURL.vbs " + name + " " + age + " " + sex); 
```

# html - 电子商务的HTML5官方示例

> ID：14711491
> 
> 赞同：1
> 
> 时间：2013-02-05T15:53:49.420
> 
> 标签：html, e-commerce, online-store

在构建新的在线商店（基于 magento）时，我们考虑使用新的 HTML5 标签等`<header><footer><section><article>`。

我们阅读了许多描述如何使用标签的博客/网站 - 不幸的是，大多数时候作者使用博客或新闻网站作为他们的示例，而不是典型的带有登录页面、类别页面、产品页面的电子商务商店。

此外，我们发现一些商店已经在使用上述标签 - 但它们的做法不同。

因此，我们想知道是否有人知道是否有任何（可能是官方的）示例来说明如何使用 HTML5 标签构建类别或产品页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:13:52.547

许多 HTML5 标签都有自己的语义含义并且是不言自明的。没有硬性规定。

`<figure>`用于图像或图表。

`<section>`用于部分或类别等。

除了在选择标签时尝试合乎逻辑之外，实际上并没有任何标准。虽然您可以找到人们如何使用它们的[示例](http://www.hongkiat.com/blog/html5-single-product-page/)，但在更大的计划中，这并不重要。**重要的是是什么促使客户进行购买并拥有一个体面的结构来支持 SEO。**

如果您真的想了解可以实际使用的语义标记（例如在 Google Offers 中），那么您可能需要考虑使用微格式模式作为替代方案。

[http://schema.org/Product](http://schema.org/Product)

# emacs - 将整个组织模式文件重新归档为树？

> ID：14711492
> 
> 赞同：2
> 
> 时间：2013-02-05T15:54:00.717
> 
> 标签：emacs, org-mode

我有一个充满组织模式文件的目录。每个文件都被构造成多个树，如下所示。

> 这是第一个文件
> 
> * 第一项
> ** 子项 1
> ** 子项 2
> * 第二项

我想将所有这些文件组合成一个文件，其中每个文件都有自己的树。所以它看起来像这样。

> * file1.org
> 这是第一个文件
> ** 第一项
> *** 子项 1
> *** 子项 2
> ** 第二项
> * file2.org
> 这是第二个文件。
> ** 第一项
> ** 第二项 ...

使用 elisp 实现这一目标的最简单方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T17:01:02.613

这当然可以改进，但应该工作得很好：

```
rm combined.org tmp.org ;
for i in *.org ; do 
    touch combined.org ; 
    echo "* $i" > tmp.org;
    sed "s/^\*/**/" "$i" | cat combined.org tmp.org - > combined.org.tmp ;
    mv combined.org.tmp combined.org ;
done 
```

# spring-integration - Spring Integration - 网关参数的拼写映射

> ID：14711494
> 
> 赞同：0
> 
> 时间：2013-02-05T15:54:00.830
> 
> 标签：spring-integration

我有以下接口，谁的实现将加密特定路径的文件。

```
package xx.messaging.fileTransfer;

import org.springframework.integration.annotation.Gateway;
import org.springframework.integration.annotation.Header;
import org.springframework.integration.annotation.Payload;

/**
* <H1>FileEncryptionService</H1>
*/
public interface FileEncryptionService {

    /**
     * Generates a new encrypted filename based on the input, calls the default method and returns
     * the encrypted file name
     * @param srcFilename
     * @return
     * @throws Exception
     */
    @Gateway
    public String encryptFile(@Payload String srcFilename) throws Exception;

    /**
     * Encrypt the a file
     * @param srcFilename The source file name
     * @param destFilename The target file name
     */
    @Gateway
    public void encryptFile(@Payload String srcFilename, @Header("encryptedFilename") String destFilename); 
} 
```

该服务将通过 spring 集成调用，并通过以下方式在上下文中注册为网关

```
<int:gateway service-interface="lu.scoteqint.messaging.fileTransfer.FileEncryptionService"/> 
```

实现 bean 和 service-activator 注册为

```
<beans:bean id="fileEncryptionService" class="xx.messaging.fileTransfer.impl.CommandLineEncryptionService"/>

<int:service-activator 
    input-channel="file1"
    output-channel="file2"
    expression="@fileEncryptionService.encryptFile(payload)"/> 
```

我期望消息有效负载是文件的字符串路径，因为线标签日志显示

```
2013-02-05 15:50:26,911 DEBUG [org.springframework.integration.handler.LoggingHandler] (task-scheduler-1) [Payload=.\src\test\resources\test\xx.xml][Headers={timestamp=1360079426907, id=1c3be020-fc6d-42ba-b3f0-5b963f76fb76}] 
```

但似乎“服务激活器”表达式找到了一个文件。

```
Caused by: org.springframework.expression.spel.SpelEvaluationException: EL1004E:(pos 31): Method call: Method encryptFile(java.io.File) cannot be found on lu.scoteqint.messaging.fileTransfer.impl.CommandLineEncryptionService type
    at org.springframework.expression.spel.ast.MethodReference.findAccessorForMethod(MethodReference.java:182)
    at org.springframework.expression.spel.ast.MethodReference.getValueInternal(MethodReference.java:106)
    at org.springframework.expression.spel.ast.CompoundExpression.getValueInternal(CompoundExpression.java:57)
    at org.springframework.expression.spel.ast.SpelNodeImpl.getTypedValue(SpelNodeImpl.java:102)
    at org.springframework.expression.spel.standard.SpelExpression.getValue(SpelExpression.java:102)
    at org.springframework.integration.util.AbstractExpressionEvaluator.evaluateExpression(AbstractExpressionEvaluator.java:126)
    at org.springframework.integration.util.AbstractExpressionEvaluator.evaluateExpression(AbstractExpressionEvaluator.java:86)
    ... 30 more 
```

编辑

日志详细信息

```
2013-02-05 16:26:42,737 DEBUG [org.springframework.integration.channel.DirectChannel] (task-scheduler-1) preSend on channel 'file1', message: [Payload=.\src\test\resources\test.xml][Headers={timestamp=1360081602736, id=877407f6-c5a2-4bea-9ec7-f970b09f08a8}] 
```

有没有办法确保参数映射为字符串而不是文件？

# web-services - HTTPS 身份验证会减慢我的应用程序吗？

> ID：14711496
> 
> 赞同：0
> 
> 时间：2013-02-05T15:54:04.870
> 
> 标签：web-services, rest, authentication, ssl, https

我正在构建一个 Web 应用程序和 RESTful Web 服务。

我一直在阅读有关对 Web 服务请求进行身份验证的最佳方法的各种文章。

对我来说最好的选择似乎是使用 HTTP 基本身份验证。我读过的几乎每一篇文章都说身份验证应该通过 SSL 或等效的方式进行加密。

我不完全确定这涉及到什么。这是否意味着我的整个 Web 服务都必须在安全服务器上？这会减慢速度吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:09:14.407

这实际上取决于传输的数据量以及您的服务获得的点击量。加密数据将增加处理时间，通常会增加传输的信息量。但是，如果您选择没有 SSL 的基本身份验证并且有用户在您的网络上运行数据包嗅探器，这几乎就像在房间里大喊您的凭据一样。如果您愿意，可以通过配置 .HTACCESS 在 HTTP 和 HTTPS 之间切换。请参阅以下链接：

[使用 .htaccess 在 HTTP 和 HTTPS 之间正确切换](https://stackoverflow.com/questions/1108706/correctly-switching-between-http-and-https-using-htaccess)

# php - 检查 'pdo->query foreach' 是否返回 null

> ID：14711499
> 
> 赞同：0
> 
> 时间：2013-02-05T15:54:16.310
> 
> 标签：php, mysql, sql, pdo

数据库很好，但我不明白为什么 $ROW 不能被识别为 NULL。

我有这个代码：

```
$pdo = new PDO("mysql:host=" . $this->hostname . ";dbname=" . $this->dbname, $this->username, $this->password);

foreach($pdo->query('SELECT * FROM people WHERE name="Joshua"') as $row):
    if($row['name'] != NULL):
        echo "WE HAVE ONE JOSHUA";
    else:
        echo "WE DO NOT HAVE ANY JOSHUA";
    endif;
endforeach; 
```

当我运行这个脚本时，我得到了：“我们有一个约书亚”消息；

当我在 PDO->QUERY 中将 name="Joshua" 更改为数据库中不存在的名称时，我没有收到“我们没有任何 JOSHUA”消息；

有什么提示可以解决这个问题吗？

我只想创建一个语句来控制 FOREACH 是否返回 NULL。

在此先感谢并抱歉英语不好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:07:23.173

您可以使用 PDO rowCount 测试结果是否为空。看：

```
$cmd = $pdo->prepare('SELECT * FROM people WHERE name="Joshua"');
$cmd->execute();
if ($cmd->rowCount() > 0)
{
    while ($row = $cmd->fetch())
    {
        do...
    }
} 
```

PDO 不返回错误。您可以使用 PDOStatement::errorCode()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:55:38.703

这个怎么样？

```
foreach($pdo->query('SELECT COUNT(*) totalCOunt FROM people WHERE name="Joshua"') as $row):
    if($row['totalCOunt'] != 0):
        echo "WE HAVE ONE JOSHUA";
    else:
        echo "WE DO NOT HAVE ANY JOSHUA";
    endif;
endforeach; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T18:03:56.953

您只需要一个循环来处理多行，
而如果您只获得一行，则不需要循环。

```
$result = $pdo->query('SELECT * FROM people WHERE name="Joshua"');
$row = $result->fetch();
if ($row) {
   echo "WE HAVE ONE JOSHUA";
   // here you have Joshua's data in $row
} else {
    echo "WE DO NOT HAVE ANY JOSHUA";
} 
```

# python - 使用模拟库修补类方法

> ID：14711500
> 
> 赞同：4
> 
> 时间：2013-02-05T15:54:17.043
> 
> 标签：python, mocking

我正在编写单元测试，我需要模拟一个方法调用，以便在大多数情况下它表现为方法本身，除非参数获得特殊值“插入”。这是一个简化的生产代码：

```
class CommandServer(object):
    def __init__(self):
        self.rowcount = None
    def runSQL(self, sql):
        print "Do something useful"
        self.rowcount=5
        return self

class Process(object):
    def process(self):
        cs = CommandServer()
        cs.runSQL("create table tbl1(X VARCHAR2(10))")
        r = cs.runSQL("insert into tbl1 select * from tbl2")
        print "Number of rows: %s" % r.rowcount

p = Process()
p.process() 
```

哪个打印

```
Do something useful
Do something useful
Number of rows: 5 
```

我可以使用以下代码自己制作一个模拟版本：

```
runSQL = CommandServer.runSQL
def runSQLPatch(self, sql):
    if sql.lstrip().startswith('insert into'):
        print "Patched version in use"
        class res(object):
            rowcount = -1
        return res
    else:
        return runSQL(self, sql)
CommandServer.runSQL = runSQLPatch

p = Process()
p.process() 
```

哪个打印

```
Do something useful
Patched version in use
Number of rows: -1 
```

我想使用`mock` [库](http://www.voidspace.org.uk/python/mock/)来完成同样的事情（我相信这是[python 3](http://docs.python.org/dev/library/unittest.mock-examples.html)中包含的库）。我怎样才能做到这一点？(Python 2.6.2)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:03:49.940

完全清楚，它只包含在 python 3.3 中（我很高兴学到了，谢谢！）。

否则，您可以使用的模式是

```
from mock import patch

with patch.object(CommandServer, 'runSQL') as runSQL:
    class res(object):
       rowcount = -1

    runSQL.return_value = res

    p = Process()
    p.process()

    for c in runSQL.call_list:
        assert c[1].lstrip().startswith('insert into') is True 
```

但这将涵盖所有情况，而不仅仅是您发送`'insert into'`. 这可能会给你一个关于在哪里看的提示，但除此之外，我认为你正在寻找的东西在 mock 中是不可能的。

# php - 在循环中取消链接不起作用

> ID：14711502
> 
> 赞同：0
> 
> 时间：2013-02-05T15:54:21.130
> 
> 标签：php, mysql

我寻求有关 PHP 代码的帮助。简单的取消链接功能有效，但当它处于循环状态时，它不起作用。一定是哪里出了问题。所以这就是问题所在。我有一个简单的页面，您可以在其中删除导航项。如果用户删除导航项（他是管理员）并且该链接指向包含一些照片的页面，我想在用户删除整个页面时删除这些照片。PHP代码：

```
$sql2 = "SELECT * FROM foto WHERE ID=".$inid;
    $vysledek = mysql_query($sql2) or die (mysql_error());
    while ($zaznam= MySQL_Fetch_Array($vysledek)) {
                $path = "maly/maly".$zaznam["url_v"];
                unlink($path);
                $path2 = "uploads/".$zaznam["url_v"];
                unlink($path2);     
            } 
```

此代码不会删除所有匹配的照片。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:58:09.173

我不确定我是否理解所要求的所有内容，但构建的路径似乎不正确。看起来它应该在之后有一个斜线`maly`：

```
$path = "maly/maly/".$zaznam["url_v"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:45:11.840

首先声明

```
$sql2 = "SELECT * FROM foto WHERE ID=".$inid; 
```

可能不正确，可能

```
$sql2 = "SELECT * FROM foto WHERE ID='".$inid."'"; 
```

（忽略潜在 SQL 注入的事实）。

但，

为什么不回显当前工作目录的值`$path`并`$path2`找出问题所在？

否则很难说清楚。

顺便说一句 - mysql_* 库已弃用。应该移动到像 PDO 或 mysqli 这样的 summat。

# ruby-on-rails-3.2 - 如何在 STI 的开发环境中重新加载 app/models/子目录中的文件

> ID：14711505
> 
> 赞同：3
> 
> 时间：2013-02-05T15:54:24.363
> 
> 标签：ruby-on-rails-3.2, development-environment, single-table-inheritance

[我使用Alex Reisner 博客文章中的](http://code.alexreisner.com/articles/single-table-inheritance-in-rails.html)一些技巧在我的一个模型中实现了 STI 。我已经让我的所有子类都使用超类的控制器，并使用序列化/存储来保存额外的属性。我将`model_name`and`self.select_options`方法添加到超类中，并从 Alex 的博客中添加了预加载初始化程序。我还更改了我`collection_select`在 _form 视图助手和属性验证中的使用`self.select_options`方法。我所有的子类都在 app/models/subfolder 中的单个文件中，尽管它们不像 SubFolder::Subclass 那样命名空间。

然后我开始遇到问题。更改任何代码后，`self.select_options`停止返回所有子类。它只返回一个小子集或不返回。因此，由于验证和 _form 绑定，我无法在代码更改后编辑/更新我的模型。据我所知，当我更改任何代码时，Rails 会重新加载环境，但不会重新加载子文件夹中的模型。

[我尝试像许多建议一样](https://stackoverflow.com/questions/3356742/best-way-to-load-module-class-from-lib-folder-in-rails-3/9819938#9819938)将路由添加到 config.autoload_paths ，但最终没有奏效。

所以最终，我想要：

*   修复自动加载的东西，所以我不必在每次更改后重新启动服务器
*   基于包含所有子目录的子目录，以避免手动维护数组
*   Rails 3.2.11，红宝石 1.9.3p125，ubuntu 12.04.01，rvm

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T15:54:24.363

我最终将这个答案中的代码和这个答案[中](https://stackoverflow.com/a/6680809/1777670)[的](https://stackoverflow.com/a/5309126/1777670)代码和从底部的[精彩](http://wondible.com)博客文章中收集到的知识结合起来。`config.autoload_paths`似乎从来没有帮助任何东西，但我把它们留在那里。关键部分是初始化程序，它在启动时需要子目录中的所有文件，然后在每次重新加载时。我试`load`了一遍`require_dependency`，还是不行。不必一直重新加载绝对是一件好事。

在应用程序.rb

```
config.autoload_paths += %W(#{config.root}/app/models/configuration) 
```

开发中.rb

```
config.autoload_paths += Dir["#{config.root}/app/models/configuration/**"] 
```

在 preload_sti_models.rb

```
if Rails.env.development?
  Dir.entries("#{Rails.root}/app/models/subfolder").each do |c|
    require_dependency File.join("app","models", "subfolder", "#{c}") if c =~ /.rb$/
  end
  ActionDispatch::Reloader.to_prepare do
    Dir.entries("#{Rails.root}/app/models/subfolder").each do |c|
      require_dependency File.join("app","models", "subfolder", "#{c}") if c =~ /.rb$/
    end
  end
end 
```

一些包含有用信息的博客文章

1.  [http://wondible.com/2012/01/13/rails-3-2-autoloading-in-theory/](http://wondible.com/2012/01/13/rails-3-2-autoloading-in-theory/)
2.  [http://wondible.com/2011/12/30/rails-autoloading-cleaning-up-the-mess/](http://wondible.com/2011/12/30/rails-autoloading-cleaning-up-the-mess/)
3.  [http://wondible.com/2011/12/23/give-rails-autoloading-a-boot-to-the-head/](http://wondible.com/2011/12/23/give-rails-autoloading-a-boot-to-the-head/)
4.  [http://www.williambharding.com/blog/technology/rails-3-autoload-modules-and-classes-in-production/](http://www.williambharding.com/blog/technology/rails-3-autoload-modules-and-classes-in-production/)

编辑：[这是众所周知的事情](https://github.com/rails/rails/issues/8699)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-11T16:37:38.327

这个解决方案类似于上面的 undefinedvariable，但更 DRY。

```
# organize your sti classes in directories named after the parent
sti_directory_paths = [
  Rails.root.join("app","models","subfolder_one"),
  Rails.root.join("app","models","subfolder_two"),
]

def require_sti_model(path, filename)
  require_dependency (path + filename).to_s
end

# if you use something like guard, just exclude from production
unless Rails.env.production?
  sti_directory_paths.each do |sti_directory_path|
    Dir[sti_directory_path + "*.rb"].each do |filename|
      require_sti_model(sti_directory_path, filename)
      ActionDispatch::Reloader.to_prepare do
        require_sti_model(sti_directory_path, filename)
      end
    end
  end
end 
```

# xml - 如何避免 Groovy 的 XmlNodePrinter 将编码的换行符转换为实际的换行符

> ID：14711507
> 
> 赞同：-1
> 
> 时间：2013-02-05T15:54:28.577
> 
> 标签：xml, groovy

我正在使用 XmlParser 读取具有以下内容的 XML 文档：

```
<instructions size='1'>
   <instruction key='manifest'>
      Bundle-SymbolicName: org.slf4j.api&#xA;Bundle-Version: 1.6.4.v20120130-2120
   </instruction>
</instruction> 
```

注意在第 3 行有换行符的实体，`&#xA;`

问题是当我使用 Groovy 的 XmlNodePrinter 打印出此文档时（在我的情况下，我已对文档的其他地方进行了更改），节点打印机将打印出文本节点并使用真正的换行符而不是`%#xA;`

```
<instructions size='1'>
   <instruction key='manifest'>
      Bundle-SymbolicName: org.slf4j.api
Bundle-Version: 1.6.4.v20120130-2120
   </instruction>
</instruction> 
```

我为 XmlParser 对象设置了 trimWhitespace=false 并为 XmlNodePrinter 设置了 preserveWhitespace=true 但这不会改变上述行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:09:52.973

您可以将文本包装在里面`<![CDATA...]]>`：

```
<instructions size='1'>

   <instruction key='manifest'> 
   <![CDATA[       
       Bundle-SymbolicName: org.slf4j.api&amp;#xA;Bundle-Version: 1.6.4.v20120130-2120 
   ]]>
   </instruction>
</instructions> 
```

我正在使用以下代码对其进行测试：

```
def out = new StringWriter() 
def xml = new XmlParser().parseText(new File("file.xml").text) 
def printer = new XmlNodePrinter(new PrintWriter(out)) 
printer.print(xml) 
println out.toString() 
```

输出如预期：

```
<instructions size="1">
   <instruction key="manifest">
      Bundle-SymbolicName: org.slf4j.api&amp;#xA;Bundle-Version: 1.6.4.v20120130-2120
   </instruction>
</instructions> 
```

**回复评论：**

如果您真的别无选择，那么您可以扩展`XmlNodePrinter`（这是一个 Java 类）并创建 Groovy 代码，例如：

```
class MyXmlNodePrinter extends XmlNodePrinter {
   MyXmlNodePrinter(PrintWriter out) {
      super(out)
   }

   void printSimpleItem(Object value) {
      value = value.replaceAll("\n", "&#xA;")
      out.print(value)
   }
}

def out = new StringWriter() 
def xml = new XmlParser().parseText(new File("file.xml").text) 
def printer = new MyXmlNodePrinter(new PrintWriter(out)) 
printer.print(xml) 
println out.toString() 
```

这段代码的输出是：

```
<instructions size="1">
   <instruction key="manifest">
      Bundle-SymbolicName: org.slf4j.api&#xA;Bundle-Version: 1.6.4.v20120130-2120
   </instruction>
</instructions> 
```

这`MyXmlNodePrinter`是微不足道的并且不会执行转义，因此您可能需要`private void printEscaped(String s, boolean isAttributeValue)`从`XmlNodePrinter`. `XmlNodePrinter`您可以在[https://github.com/groovy/groovy-core/blob/master/subprojects/groovy-xml/src/main/java/groovy/util/XmlNodePrinter.java](https://github.com/groovy/groovy-core/blob/master/subprojects/groovy-xml/src/main/java/groovy/util/XmlNodePrinter.java)中找到源代码

# php - PHP多维数组到平面文件夹视图

> ID：14711510
> 
> 赞同：4
> 
> 时间：2013-02-05T15:54:34.370
> 
> 标签：php, arrays, multidimensional-array

我在 PHP 中有一个像这样的多维数组：

```
Array
(
    [folder1] => Array
        (
            [folder11] => Array
                (
                    [0] => index.html
                    [1] => tester.html
                )

            [folder12] => Array
                (
                    [folder21] => Array
                        (
                            [0] => astonmartindbs.jpg
                        )

                )

        )

) 
```

并应转换为像这样的“文件路径”字符串：

```
Array
(
    [0] => 'folder1/folder11/index.html'
    [1] => 'folder1/folder11/tester.html'
    [2] => 'folder1/folder12/folder21/astonmartindbs.jpg'
) 
```

有人有什么想法吗？

我已经尝试了很多所有删除...这是我最后一次尝试的起点：

```
public function processArray( $_array ) {
foreach( $_array AS $key => $value ) {
    if( is_int( $key ) ) {

    } else {
    if( is_array( $value ) ) {
        $this->processArray( $value );
    } else {

    }
    }
}
echo $this->string;

} 
```

但我没有走到尽头....希望有人能帮忙吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T16:10:50.317

递归函数可能是您正在搜索的内容。以下功能将起作用：

```
/**
 * Flattens the array from the question
 *
 * @param array  $a       Array or sub array of directory tree
 * @param string $prefix  Path prefix of $a
 */
function flatten($a, $prefix = './') {
    $paths = array();
    foreach($a as $index => $item) {
        // if item is a string then it is a file name (or a leaf in tree)
        // prefix it and add it to paths
        if(is_string($item)) {
            $paths []= $prefix . $item;
        } else {
            // if item is a directory we call flatten on it again.
            // also we append the new folder name to $prefix
            foreach(flatten($item, $prefix . $index . '/') as $path) {
                $paths []= $path;
            }
        }         
    }
    return $paths;
}

var_dump(flatten($a)); 
```

请注意，`flatten()`在 foreach 循环中调用自身，并使用子数组作为参数。这被称为“递归算法”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T16:19:55.793

如果您喜欢[SPL](http://www.php.net/manual/en/book.spl.php)，您可以使用[`RecursiveArrayIterator`](http://php.net/manual/en/class.recursivearrayiterator.php)并[`RecursiveIteratorIterator`](http://php.net/manual/en/class.recursiveiteratoriterator.php)在平面结构上进行迭代。

我的结果如下所示：

```
$arr = array(); // your array
$arr = new RecursiveArrayIterator($arr);
$iterator = new RecursiveIteratorIterator($arr, RecursiveIteratorIterator::SELF_FIRST);

$currentDepth = 0;
$currentPath = array();
$result = array();

foreach($iterator as $key => $value) {
  // if depth is decreased
  if ($iterator->getDepth() < $currentDepth) {
    // pop out path values
    do {
      $currentDepth--;
      array_pop($currentPath);
    } while($iterator->getDepth() < $currentDepth);
  }

  if (is_array($value)) {
    // add parent to the path
    $currentPath[] = $key;
    $currentDepth++;
  } else {
    // add children to result array
    $result[] = implode('/', $currentPath).'/'.$value;
  }
} 
```

转储数据将如下所示：

```
print_r($result);
/*
Array
(
    [0] => folder1/folder11/index.html
    [1] => folder1/folder11/tester.html
    [2] => folder1/folder12/folder21/astonmartindbs.jpg
)
*/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:19:35.090

在您的情况下，您需要实现一个您尝试执行的递归函数，这是一个简单的代码，它可能会对您有所帮助，我不确定这是否有效：

```
$result = array();
$d = 0;
$tmp = "";
public function processArray( $_array ,$before) {
foreach( $_array AS $key => $value ) {
    if( is_int( $key ) ) {  // If the key is a number, then there is no a sub-array 
      $result[$d] = $before . '/' . $value;
       $d++;
      $before="";
    } else {
    if( is_array( $value ) ) { // if the value is an array, then we will add the key into string that we will return and search into subarray.
 $before = $before . '/' . $key;
        $this->processArray( $value,$before  );
    } else {

    }
    }
}
return $result;

} 
```

# java - HttpServletRequest 中有什么东西可以用来识别集群中的节点吗？

> ID：14711513
> 
> 赞同：2
> 
> 时间：2013-02-05T15:54:47.600
> 
> 标签：java, tomcat, servlets, httprequest

如何使用 HttpServletRequest 中的信息识别集群中的节点？

每个节点唯一的任何信息都是合适的——我需要它来区分日志。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T16:03:43.037

您可以尝试获取`IP`and`hostname`

```
// Get client's IP address
String ipAddress = request.getRemoteAddr(); // ip

// Get client's hostname
String hostname = request.getRemoteHost(); // hostname 
```

如果它没有提供您想要的，我会打印所有请求标头并查看是否有唯一标识符

例如，某些服务器会添加`x-forwarded-for`，或者`X_FORWARDED_FOR`如果请求通过代理

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T16:01:00.910

添加一个系统变量`-Dnode.id=1`，然后你可以访问它`System.getProperty("node.id")`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T16:01:13.033

`java.net.InetAddress.getLocalHost()`会给你提供服务的主机的名字。这能得到你所需要的吗？

# playframework - 向 Play Framework 2.1-RC4 项目添加解析器（Maven 存储库）？

> ID：14711515
> 
> 赞同：3
> 
> 时间：2013-02-05T15:54:48.790
> 
> 标签：playframework, playframework-2.0

我正在尝试将解析器添加到我的 Play 2.1-RC4 构建文件并收到错误“未找到：值解析器”

任何想法出了什么问题？

```
import sbt._
import play.Project._

object ApplicationBuild extends Build {

val appName = "myappname"
val appVersion = "1.0-SNAPSHOT"

val appDependencies = Seq(
    "org.ocpsoft.prettytime" % "prettytime" % "2.1.2.Final",
    "com.twitter" % "cassie" % "0.19.0",
    jdbc,
    anorm)

val main = play.Project(appName, appVersion, appDependencies).settings(defaultScalaSettings: _*).settings(
    resolvers += "Twitter's Repository" at "http://maven.twttr.com/"
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:58:44.640

通过添加解决：

```
import Keys._
import PlayProject._ 
```

# java - 用于编写 excel 文件的 Java servlet 在 IE7/IE8 中导致错误

> ID：14711521
> 
> 赞同：1
> 
> 时间：2013-02-05T15:55:10.633
> 
> 标签：java, excel, internet-explorer, servlets, download

我有一个 jsf 应用程序，当用户单击一个按钮时，有一个支持 bean 方法调用这个 servlet。

问题是在IE7和IE8中，文件无法下载。它给出了错误消息：

`Internet Explorer cannot download ExcelGenerator from mydomain.com`

我需要做什么才能让它在 IE7/IE8 中工作？我需要设置一些额外的标题吗？

调用 servlet 的支持 bean 方法：

```
public void generateExcel()
{
    FacesContext context = FacesContext.getCurrentInstance();
    String url = context.getExternalContext().getRequestContextPath() + "/ExcelGenerator";
    context.getExternalContext().redirect(url);
} 
```

生成 excel 文件的 Servlet：

```
 public class ExcelGenerator extends HttpServlet {

        private static final long serialVersionUID = 1L;
        private static final Logger LOG = LoggerFactory.getLogger(ExcelGenerator.class);

        @Override
        public void init(ServletConfig config) throws ServletException {
            super.init(config);
        }

        @SuppressWarnings("unchecked")
        protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

            SXSSFWorkbook wb = new SXSSFWorkbook();
            Sheet sheet = wb.createSheet("Results");
            List<List<TableData>> results = (List<List<TableData>>) request.getSession().getAttribute("results");
            String tableName = (String) request.getSession().getAttribute("tableName");
            DateFormat df = new SimpleDateFormat("yyyy-MM-dd");
            Date date = new Date();
            String filename = tableName+"-"+df.format(date)+".xlsx";
            OutputStream out = null;

            response.setContentType("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");
            response.setHeader("Expires:", "0"); // eliminates browser caching
            response.setHeader("Content-Disposition", "attachment; filename="+filename);

            int rowCounter = 0;

            // Create the rows
            for(List<TableData> l : results) {

                int counter = 0;
                Row row = sheet.createRow(rowCounter);

                for(TableData td : l) {

                    Cell cell = row.createCell(counter);

                    // if we're on the first row, get the column description, else get the data
                    if(rowCounter == 0) {
                        cell.setCellValue(td.getColumnDescription());
                    } else {
                        cell.setCellValue(td.getData());
                    }
                    counter++;
                }
                rowCounter++;
            }

            try {
                out = response.getOutputStream();
                wb.write(out);
                out.flush();
            } catch (Exception e) {
                LOG.debug(e.getStackTrace().toString());
            } finally {
                out.close();
                wb.dispose();
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T16:05:35.603

> Internet Explorer 无法从 mydomain 下载 ExcelGenerator。

当域使用 HTTPS 并且响应不允许缓存时，此错误很典型。另见[MS 知识库 316431](http://support.microsoft.com/kb/316431)。

修复相当简单：

```
if (request.isSecure()) {
    response.setHeader("Cache-Control", "public");
    response.setHeader("Pragma", "public");
} 
```

### 也可以看看：

*   [IE 无法下载 foo.jsf。IE 无法打开此 Internet 站点。请求的站点不可用或找不到](https://stackoverflow.com/questions/5034454/internet-explorer-cannot-download-the-file-served-by-jsf/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:02:37.703

看看[这个页面](http://greenbytes.de/tech/tc2231/)，它列出了最近浏览器版本与`Content-Disposition`标题的兼容性。某些值的组合，尤其是围绕文件名部分的编码方式，可能会导致 IE 显示错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-01T14:39:51.530

**我遇到了这个问题，下面的条目解决了这个问题**

response.setContentType("application/vnd.ms-xls; charset=utf-8");

response.setHeader("内容配置","附件;文件名="+文件名);

response.setHeader("Pragma", "public");

response.setHeader("Cache-Control", "public, max-age=3800");

# php - 虚荣网址 + REST + 网络爬虫

> ID：14711523
> 
> 赞同：0
> 
> 时间：2013-02-05T15:55:16.363
> 
> 标签：php, apache, api, url, rest

我有一个应用程序使用来自多个应用程序 APIS（Facebook、Twitter、Instagram 等）的数据，从 PHP 中的 REST 端点访问它们。

我正在为我的应用用户建立一个虚荣 URL，比如[http://www.myapp.com/username](http://www.myapp.com/username)。

如果我有一个数据库，我可以从数据库中获取用户数据以显示在用户页面中。

使用 REST 服务，每次我进入 URL 时，都会调用从主要网站获取信息的 API。

问题越来越大，因为该应用程序将从搜索引擎爬虫那里获得大量流量（我不会降低爬取率）

第一个问题：由于 API 提供有限的访问权限（每小时 2000 次查询），有没有办法跳过 api 调用（例如，使用 memcache）？

第二个问题：我想制作一个虚荣网址，所以每次我调用[http://www.myapp.com/username](http://www.myapp.com/username)我都必须调用 api 来获取用户 ID，然后是用户名，我想知道这是否是正确的方法要做到这一点，大多数网站都是通过 url 重写来实现的，但是当你有外部数据而不是内部数据库时如何处理呢？

感谢您的阅读，需要任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:07:16.797

尝试使用某种框架。它应该使路由更简单。

url 重写将在 vi .htaccess 中发生，因此用户永远不会看到 url 的重写。

我能想到的两种方法是：

1.  在 .htaccess 中重写，以便您定义的所有路由都保持不变，并且在所有其他情况下（即[http://www.example.com/username](http://www.example.com/username)），用户控制器方法被注入到用户名和 url 之间。

2.  定义路由，以便处理所有已知路由，并让默认路由负责找出用户 ID 并执行所有必要的操作。

对于缓存，使用 memcache/redis 来缓存您的查询/用户对象/任何其他经常访问的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:05:07.900

关于使用 memcache，您将遇到的大问题是验证和过期缓存数据。

假设您像这样实现它：

```
function getSomeData() {
    if (Memcache::has('key-for-data')) {
        return Memcache::get('key-for-data');
    } else {
        $data = RestApi::getData();
        Memcache::put('key-for-data', $data);
        return $data;
    }
} 
```

这似乎很明智，但是如果通过任何其他方式访问 REST API 会发生什么？（就像另一个第三方应用程序将数据发布到相同的 API）。然后，缓存的数据可能无效，您将不知道。

从您的应用程序的角度来看，对底层数据存储的更改是完全随机的，而且完全不透明且不可知，因此它不是缓存的好目标。

另一方面，如果您可以在数据更新时从服务中获得某种“推送”通知（即订阅服务），您可以将其用作使相关缓存条目无效的触发器。然而，这是额外的复杂性，并且需要在两端都得到支持。

抱歉，这不是一个真正的答案，但它是一个部分答案，评论太长了:-)

# vb.net - Datagridview过滤空白

> ID：14711526
> 
> 赞同：0
> 
> 时间：2013-02-05T15:55:26.720
> 
> 标签：vb.net, forms, events, gridview

我不知道代码是否有问题，但是每次我在文本框中输入一个值时，datagridview 都不会过滤，这意味着它只是变成空白，就好像它没有找到任何东西一样。当我在文本框中插入文本时，有人可以帮我提供正确的代码吗？例如，datagridview 过滤器可以说我在文本框中输入字母“M”，DGV 显示所有以 M 开头的单词

这是我的代码

```
If TextBox1.TextLength > 0 Then
        frmReportMenu.ProjectBindingSource.Filter = String.Format_
("[Register number] Like '&" & TextBox1.Text) & "&'"
    Else
        frmReportMenu.ProjectBindingSource.Filter = String.Empty
    End If 
```

我找不到任何东西来正确过滤数据

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:12:29.297

我认为你的通配符是错误的。尝试使用 * 而不是 &

```
frmReportMenu.ProjectBindingSource.Filter = String.Format_
("[Register number] Like '*" & TextBox1.Text & "*'") 
```

# javascript - javascript 未在此网页上触发

> ID：14711534
> 
> 赞同：-6
> 
> 时间：2013-02-05T15:55:46.880
> 
> 标签：javascript, asp.net

在此[页面上](http://uat.knowledge.scot.nhs.uk/dementia.aspx) ，javascript 函数设置 cookie 未在“确定”时触发 单击 cookie 栏中页面顶部的“确定”。有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:58:58.267

这是工作。我有一套饼干。您根本没有在后端某处使用正确的逻辑来隐藏栏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T16:03:16.593

您的代码正在设置 cookie。看我的屏幕截图。您只是没有正确阅读它来隐藏 cookies-bar 层。

![您的 cookie 的屏幕截图](../Images/c4f1d599ed7750d65606a9e390002318.png)

# eclipse - eclipse中的JSP/JS格式化？

> ID：14711537
> 
> 赞同：1
> 
> 时间：2013-02-05T15:56:00.287
> 
> 标签：eclipse, jsp, eclipse-plugin, formatting

伙计们，有没有提供标准格式/缩进的 Eclipse 插件。我可以在 Web->JSP 文件->编辑器中找到一些基本设置，但没有多大帮助。我正在寻找非常基本的缩进/格式。它还可以在jsp中格式化javascript代码。例如：-

```
<s:if test="myManager">
<s:set var="cust" value="%{'customer'}" />
       <s:set var="custMode" value="%{'custEdit'}" />
            </s:if> 
```

**保存时应更改为以下**

```
<s:if test="myManager">
  <s:set var="cust" value="%{'customer'}" />
  <s:set var="custMode" value="%{'custEdit'}" />
</s:if> 
```

**Javascript 示例**

```
function test(){
var test1;
  var test2;
 if(someCondition)
{
  var test3;
}
} 
```

**保存时应更改为以下**

```
function test(){
  var test1;
  var test2;
  if(someCondition)
    {
       var test3;
    }

} 
```

**我并不是在寻找上述格式，但是对于 jsp 和 javascript 代码，是一些有意义的/可读的格式/缩进。**我正在使用日食 helios。我没有在网上获得任何开源插件。我相信一定有一些可用的实用程序，但不知何故我没有通过它。如果它也可以格式化脚本就好了。

# c# - 选择另一个单元格时 DatagridView 中的自定义组合框列消失

> ID：14711541
> 
> 赞同：1
> 
> 时间：2013-02-05T15:56:11.513
> 
> 标签：c#, datagridview, custom-controls, datagridviewcombobox

[我按照http://msdn.microsoft.com/en-us/library/7tas5c80.aspx](http://msdn.microsoft.com/en-us/library/7tas5c80.aspx)中的步骤在 datagridview 上托管了我的自定义组合框 (ComboBoxEx) 。

1.  我创建了从 DataGridViewColumn 派生的 DataGridVIewComboExColumn。
2.  名为“DataGridVIewComboExCell”的自定义单元格是从 DataGridViewCell 创建的。
3.  最后创建了我的自定义编辑控件“ComboExEditCtrl”（从 ComboBoxEx 派生并实现 IDataGridViewEditingControl）。

在 ComboExEditCtrl 中，OnSelectedValueChanged 方法被覆盖，如下所示。

```
protected override void OnSelectedValueChanged(EventArgs eventargs)
{
valueChanged = true;
this.EditingControlDataGridView.NotifyCurrentCellDirty(true);
base.OnSelectedValueChanged(eventargs);
} 
```

每当加载网格时，自定义控件 (ComboExEditCtrl) 就会显示在单元格上。问题是当我更改自定义控件 (ComboExEditCtrl) 上的值并单击下一个单元格时，自定义控件会消失。此外，当我在 datagridview 中单击同一单元格（自定义控件单元格）时，会出现自定义控件。

我遵循了 MSDN 中描述的几乎相同的步骤（上面的链接）。我不知道我错过了什么。请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-05T12:57:05.223

当您创建一个包含您自己的控件的自定义列/单元格时，datagridview 不知道在显示模式下如何绘制您的控件。当您单击一个单元格时，该单元格进入编辑模式，任何设置为 EditType 的控件都将被使用和显示（并且可以作为 DatagridView.EditingControl 使用）。在显示模式下，您必须重写 DataGridViewCell.Paint 方法才能按照您希望的方式绘制单元格。

# jquery - :not(:last-child) 不适用于标签包装的列表项

> ID：14711547
> 
> 赞同：1
> 
> 时间：2013-02-05T15:56:32.760
> 
> 标签：jquery, html, css, dom

一个快速的 CSS 问题。我有一些带有复选框的列表项，我想让整个项目可点击。很简单...只需将其包裹在复选框的标签中即可。这行得通。这是我的两个问题（我将它们都放在这里是因为我认为它们可能是由同一件事引起的）。

**问题：**我正在尝试使用 :not(:last-child) 在每个列表项（最后一个除外）之间放置分隔线，但我遇到了麻烦。

[**这是一个 jsFiddle**](http://jsfiddle.net/rEGex/4/)

* * *

**HTML**

```
<div class="box50">
    <div class="filterFolder">Companies<i class="icon-caret-down"></i></div>
    <ul id="companies">
        <li><label><input type="checkbox" name="checkbox" value="value" /> Apple</label></li>
        <li><label><input type="checkbox" name="checkbox" value="value" /> Microsoft</label></li>
        <li><label><input type="checkbox" name="checkbox" value="value" /> Google</label></li>
    </ul>
    <div class="filterFolder">People<i class="icon-caret-down"></i></div>
    <ul id="people">
        <li><label><input type="checkbox" name="checkbox" value="value" /> Mark Zuckerberg</label></li>
        <li><label><input type="checkbox" name="checkbox" value="value" /> Steve Jobs</label></li>
        <li><label>><input type="checkbox" name="checkbox" value="value" /> Bill Gates</label></li>
    </ul>
    <div class="filterFolder">(+) Add New</div>
</div> 
```

* * *

**CSS**

```
ul li {
    font-size:12px;
    padding:2px 7px;
    border-bottom:1px dashed #EFEFEF; 
}
    ul li:hover {
        background:#EFEFEF;
        cursor:pointer;
    }
    .listSelected {
        background:red;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:08:26.343

我会这样解决它：

**HTML**

```
<li>
    <label>
        <input type="checkbox" name="checkbox" value="value"> Apple
    </label>
</li> 
```

**CSS**

```
ul label {
    display: block;
    border-bottom:1px solid red;
}

ul li:last-child label {
    border:none;
} 
```

这是有效的 HTML 并且整个`<li>`似乎是可点击的——实际上你仍然在点击`<label>`.

另一个注意事项：对于插入图标，使用 a`<span>`而不是`<i>`作为 span 没有语义，唯一的目的是添加样式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T16:10:23.873

这是两个不同的问题。

第一个问题是由于您的 html 无效。只能`li`是 的孩子`ul`。 `label`不是一个有效的孩子。解决方案很简单：包装`<label>`在`<li>`而不是相反，并相应地更改您的样式规则。

您的第二个问题是由于标签的默认输入被检查操作导致标签上的点击事件再次触发（即两次）引起的一些奇怪行为。我无法解释这一点，但一个简单的解决方案是检查输入是否被检查以确定是否应该添加类，因为“检查”发生在第二次触发`click`.

```
if ($(this).find('input').prop('checked')) {
    $(this).addClass("listSelected");
}
else {
    $(this).removeClass("listSelected");
} 
```

[http://jsfiddle.net/ExplosionPIlls/GFcvf/](http://jsfiddle.net/ExplosionPIlls/GFcvf/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T16:19:46.807

我建议做一些小的改动。

1.  制作标签`display: block`，使其一直延伸到 LI。这样，标签将拦截 LI 内任何地方的点击。

2.  将单击处理程序附加到复选框本身（以上将有助于此）。点击后，使用`jQuery.closest()`找到对应的 LI 并在其上应用 CSS。

3.  `li:not(:last-child)`似乎工作，即选择所有LI，除了最后一个孩子。

这希望能回答您的所有 3 个问题。

[**演示在这里**](http://jsfiddle.net/salman/rEGex/7/)

# r - 有没有办法使用 ggplot 更改 GGally::ggpairs 的调色板？

> ID：14711550
> 
> 赞同：19
> 
> 时间：2013-02-05T15:56:35.897
> 
> 标签：r, ggplot2, palette

我想更改`GGally`函数的调色板`ggpairs`。当我尝试将 ggplot 命令添加到使用 返回的 ggplot`getPlot`时，颜色不会改变。

```
my_pair_plot = ggpairs(dataset, color="var1")
getPlot(my_pair_plot,2,1) + scale_fill_brewer(palette = "Set2") 
```

尝试将 ggplot 命令直接放在`ggpairs`函数上会导致错误。

```
ggpairs(dataset, color="var1") + scale_fill_brewer(palette = "Set2") 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-12-02T07:40:11.197

事实证明，这是可能的！它需要查找源代码，但解决方案很容易出现。我们对`ggpairs`函数感兴趣，所以第一步就是

```
ggpairs 
```

让我们看看是否可以找到任何 aes 映射来填充或着色。确实，

```
combo_aes <- addAndOverwriteAes(aes_string(x = xColName, 
            y = yColName, ...), section_aes) 
```

我们可能希望它做它所说的。两个重要说明：

*   颜色和填充 aes 应包含在`ggpairs`调用的省略号中

*   `aes_string()`用来

让我们试试这个：

```
ggpairs(diamonds[, 1:2], colour='cut') 
```

![在此处输入图像描述](../Images/9a201ecfe3c115c73f0c2002f266fc73.png)

太好了，我们快到了！我们只需要覆盖调色板。请注意，您提出的类似建议

```
ggpairs(diamonds[, 1:2], colour='cut') + scale_fill_brewer(palette = "Set2") 
```

将不起作用，因为 ggpairs 对象不是 ggplot，因此该`+`符号不能以任何方式直接适用。但是，[此处](https://stackoverflow.com/questions/10504724/change-the-default-colour-palette-in-ggplot?)提供了简单的解决方法。交叉你的手指，然后...

```
ggplot <- function(...) ggplot2::ggplot(...) + scale_fill_brewer(palette="Set2")
ggpairs(diamonds[, 1:2], colour='cut') 
```

![在此处输入图像描述](../Images/de25598350efbe62596447ccdc36b864.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-06-02T08:14:37.683

# 更新：

GGAlly 再次更新，这个答案中的 hack*也*不再起作用，但最后有一个非 hack 解决方案：给定

```
scales <- scale_colour_brewer(type = 'qual') %+% scale_fill_brewer(type = 'qual') 
```

你可以做到（以一种有希望的面向未来的方式）

```
for (row in seq_len(ps$nrow))
    for (col in seq_len(ps$ncol))
        ps[row, col] <- ps[row, col] + scales 
```

# 老路

另一个答案中的破解不再起作用，所以让我们破解一个新的！

对象的内部结构`ggpairs`是数据集和字符串列表：

```
> dta <- data.frame(a=1:6, b=7:12, c=c('f', 'g'))
> ps <- ggpairs(dta, 1:2, colour = 'c')
> str(ps)
List of 10
 $ data        :'data.frame':   2 obs. of  3 variables:
  ..$ a: int [1:2] 1 2
  ..$ b: int [1:2] 3 4
  ..$ c: int [1:2] 5 6
 $ columns     : int [1:3] 1 2 3
 $ plots       :List of 9
  ..$ : chr "ggally_densityDiag(ggally_data, ggplot2::aes(x = a, colour = c))"
  ..$ : chr "ggally_cor(ggally_data, ggplot2::aes(x = b, y = a, colour = c))"

[...]

 $ gg          : NULL
 - attr(*, "class")= chr [1:2] "gg" "ggpairs"

> ps 
```

![之前的情节](../Images/c6911291ba8a14a49ea31e65a9e3e519.png)

为了修改绘图，需要修改绘图对象中的各个字符串以包含附加命令。为此，我们使用`deparse(substitute(argument))`获取包含用户传递的代码的字符串，并将其附加到每个绘图调用：

```
add_to_plots <- function(pairs, modification) {
    str <- deparse(substitute(modification))
    pairs$plots <- lapply(pairs$plots, function(s) paste(s, '+', str))
    pairs
}

> add_to_plots(ps, scale_colour_brewer(type = 'qual')) 
```

![情节之后](../Images/0c9fb861cf60c0e249317bed58492619.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-03-03T10:58:13.243

我觉得更改调色板最简单的方法是修改它自己的图形功能，因为它们返回可以自由定制的 ggplot2 对象。

要改变对角线的密度，只需改变相应的函数，`ggally_densityDiag`。

```
 modified_density = function(data, mapping, ...) {

  ggally_densityDiag(data, mapping, ...) + scale_fill_brewer(type = "qual", palette = "Set2")
} 
```

然后，为函数调用提供新函数`ggparis`，如下所示，

```
 ggpairs(iris, columns = 1:3,  aes(color = Species),
        diag = list(continuous = modified_density)) 
```

[![在此处输入图像描述](../Images/7102593b6c02dc77e2317e81cb0bee31.png)](https://i.stack.imgur.com/Nz4V4.png)

还有一些参数`upper`也`lower`可以用于情节的其他部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-13T15:23:17.537

将矩阵图分配给一个变量，然后使用 for 循环遍历每个图似乎也可以解决问题：

```
library(GGally)

plot.matrix <-ggpairs(iris,aes(color= Species), upper = list(continuous = wrap("cor", size=6)))

for(i in 1:5) {
  for(j in 1:5){
    plot.matrix[i,j] <- plot.matrix[i,j] +
      scale_fill_brewer(palette = "Dark2") +
      scale_color_brewer(palette = "Dark2")
  }
}

plot.matrix 
```

示例改编自 Schmuller (2018)：*R Projects for* dummies ，p。149.

[![在此处输入图像描述](../Images/31b2b09d16798fcf9c11e696bfe816b1.png)](https://i.stack.imgur.com/hY75Y.png)

# c# - 在 BeginXXX 和 EndXXX 方法中使用 AsyncWaitHandle

> ID：14711551
> 
> 赞同：0
> 
> 时间：2013-02-05T15:56:37.613
> 
> 标签：c#, asynchronous, dns

我想调用一个返回`IAsyncResult`对象的异步操作，特别是类的`GetHostEntry`方法`System.Net.Dns`。

我已经明白我应该调用属性的`WaitOne`方法来等待某个超时以等待操作完成，但显然我错了，因为这段代码不起作用：`AsyncWaitHandle``IAsyncResult`

```
using System;
using System.Net;

static class Program {

    class GetHostEntryState {
        public IPHostEntry Value {
            get;
            set;
        }
    }

    static void Main(string[] args) {
        string hostName = "somehost";
        int timeout = 1000;

        var state = new GetHostEntryState();
        var asyncResult = Dns.BeginGetHostEntry(hostName, ar => {
            ((GetHostEntryState)ar.AsyncState).Value = Dns.EndGetHostEntry(ar);
        }, state);
        if (asyncResult.AsyncWaitHandle.WaitOne(timeout) && asyncResult.IsCompleted) {
            if (state.Value == null) {
                // we always hit this condition
                Console.WriteLine("state.Value == null");
                return;
            }
            foreach (var address in state.Value.AddressList) {
                Console.WriteLine(address);
            }
        } else {
            Console.WriteLine("timed out");
        }
    }
} 
```

[msdn 中](http://msdn.microsoft.com/en-us/library/ms143990.aspx)的示例使用`ManualResetEvent`对象进行同步。那有必要吗？如果是这样，`AsyncWaitHandle`这里的财产有什么用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T13:10:07.593

因为我想要的是一个超时的 GetHostEntry，所以我想出了这个解决方案，如果我理解正确的话，应该避免泄漏资源，因为最终无论如何都会调用 EndGetHostEntry 操作。

我在这里分享它以防它对其他人有用:)

```
using System;
using System.Net;
using System.Net.Sockets;
using System.Threading;

public sealed class HostEntryTimeout {

    public IPHostEntry HostEntry {
        get;
        private set;
    }

    string _hostName;
    int _timeoutInMilliseconds;
    ManualResetEvent _getHostEntryFinished;

    public HostEntryTimeout(string alias, int timeoutInMilliseconds) {
        _hostName = alias;
        _timeoutInMilliseconds = timeoutInMilliseconds;
        _getHostEntryFinished = new ManualResetEvent(false);
    }

    /// <summary>
    /// Gets the IPHostEntry.
    /// </summary>
    /// <returns>True if successful, false otherwise.</returns>
    public bool GetHostEntry() {
        _getHostEntryFinished.Reset();
        Dns.BeginGetHostEntry(_hostName, GetHostEntryCallback, null);
        if (!_getHostEntryFinished.WaitOne(_timeoutInMilliseconds)) {
            return false;
        }
        if (HostEntry == null) {
            return false;
        }
        return true;
    }

    void GetHostEntryCallback(IAsyncResult asyncResult) {
        try {
            HostEntry = Dns.EndGetHostEntry(asyncResult);
        } catch (SocketException) {
        }
        _getHostEntryFinished.Set();
    }
} 
```

然后可以这样使用：

```
var hostEntryTimeout = new HostEntryTimeout("somehost", 1000);
if (hostEntryTimeout.GetHostEntry()) {
    // success, do something with the hostEntryTimeout.HostEntry object
} 
```

# javascript - 在 Flask 上运行时未添加外部 JavaScript 文件

> ID：14711552
> 
> 赞同：76
> 
> 时间：2013-02-05T15:56:41.317
> 
> 标签：javascript, python, flask, external

我有一个名为的 HTML 文件`showMap.html`：

```
<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <title>Map</title>
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false">
  </script>
  <script type="text/javascript" src="js/map.js"></script>
</head>

<body onload="showPosition()">
  <div id="map_canvas" style="width:500px;height:500px;"></div>
</body>

</html> 
```

另一个 JavaScript 文件`map.js`放在`js`同一目录的文件夹中。

此代码在加载 HTML 文件时工作正常，但当我在服务器中运行它时不起作用。

我使用 Python 的 Flask 框架进行后端编程，有趣的是，如果我在 HTML 文件中扩展 JavaScript 代码，同样的事情也会很好地工作。唯一的问题是外部文件。

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2013-02-05T15:57:43.693

将`map.js`文件作为[静态资源提供](http://flask.pocoo.org/docs/quickstart/#static-files)：

*   将文件移动到`static/`包的子目录

*   在 Jinja2 模板中为其生成一个静态 URL，如下所示：

    ```
     <script type="text/javascript"
             src="{{ url_for('static', filename='map.js') }}"></script> 
    ```

该`filename`参数采用相对路径；您可以使用子目录。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2017-01-25T06:29:02.420

**第 1 步：** 在项目根目录上创建名称为 static 的文件夹

**步骤 2：** 在静态文件夹中添加静态文件

**步骤 3** 添加模板

```
<script type="text/javascript" src="{{ url_for('static', filename = 'hello.js') }}"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-01T12:27:19.113

我遇到了同样的问题，对于样式表，URL_FOR 有效，但适用于 javascript。我不得不写

```
<script type="text/javascript" src="static/map.js"/> 
```

它对我有用

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-08-02T14:00:49.343

我想补充一下 Martijn 的答案，你必须像这样链接你的 js 文件：

`<script type="text/javascript" src="{{ url_for('static', filename='map.js') }}"></script>`

而不是这样：

`<script type="text/javascript" src="{{ url_for('static', filename='map.js') }}"/>`

# c++ - 使用“->”调用函数

> ID：14711565
> 
> 赞同：0
> 
> 时间：2013-02-05T15:57:25.077
> 
> 标签：c++, pointers

我目前正在学习虚函数，在这个特定的课程中，它创建了一个对象指针数组`firstArray[5]`，并从这些对象调用函数。直到现在，每当我想`func()`从一个对象调用一个函数时`foo`，我都会写`foo.func()`. 现在我正在使用虚函数和这个数组，本书已经切换到这个方法：`firstArray[0]->func()`. 这本书没有很好地证明这种转变的合理性，有人可以解释一下吗？我看到当我尝试使用时`firstArray[0].func()`，我得到了这个....

`error: request for member 'func' in 'firstArray[0]', which is of non-class type 'sampleClass*'`.

仅仅是因为我试图从指针而不是实际对象调用函数吗？我已经学习 C++ 几个月了，无论出于何种原因，有时指针仍然让我感到困惑。任何澄清都会有所帮助。

编辑：

我认为让我混淆的部分是：我可以使用`base *ptr;`. 然后，我可以通过说从派生类创建一个新对象来设置该指针`ptr = new derived;`。这就是我感到困惑的地方。如果我要创建一个`int* ptr;`，并且我希望它指向一个我创建的整数，我不能说`ptr = int j`. 如果`ptr`真的只是一个地址，为什么这两个示例的工作方式不同？我想我也不太了解“新”机制。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T16:01:34.967

这与虚函数没有任何关系。如果你有一个指针，你需要 operator-> 来尊重和访问它指向的对象......

您仍然可以使用运算符。（点）如果您首先取消引用，则访问成员/函数：

```
(*foo).func() 
```

指向对象的指针仅保存对象在内存中的地址。
因此，如果您有一个指向某种类型的指针的变量，它实际上包含一个数字。

如果要使用该对象，则需要调用它所指向的对象，正如我所说的使用运算符*或运算符。（点）。

# entity-framework - 使用从另一个 CSDL 文件导入命名空间的 CSDL 文件运行 POCO 实体生成器时，没有遇到“基本”命名空间的模式

> ID：14711567
> 
> 赞同：1
> 
> 时间：2013-02-05T15:57:29.590
> 
> 标签：entity-framework, poco, t4, edmx, csdl

当使用从另一个 CSDL 文件导入命名空间的 CSDL 文件运行 POCO 实体生成器时，我收到此错误“没有遇到 'Base' 命名空间的模式”。

两个 CSDL 文件都已移动到项目文件夹之外的不同文件夹中。这是因为我必须编辑 Administracion.csdl 文件才能从“Base”CSDL 文件中导入命名空间。

“Administracion.csdl”文件如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<Schema Namespace="Administracion" Alias="Self" p1:UseStrongSpatialTypes="false" xmlns:annotation="http://schemas.microsoft.com/ado/2009/02/edm/annotation" xmlns:p1="http://schemas.microsoft.com/ado/2009/02/edm/annotation" xmlns="http://schemas.microsoft.com/ado/2009/11/edm">
  <Using Namespace="Base"  Alias="Base" />
  <EntityContainer Name="AdministracionEntities" p1:LazyLoadingEnabled="true">
    <EntitySet Name="adm_accesoxperfil" EntityType="Administracion.adm_accesoxperfil" />
    <EntitySet Name="adm_accesoxusuario" EntityType="Administracion.adm_accesoxusuario" />
    <EntitySet Name="adm_accionxnivelseguridadxusuario" EntityType="Administracion.adm_accionxnivelseguridadxusuario" />
    <EntitySet Name="adm_alarmaxperiodopresupuesto" EntityType="Administracion.adm_alarmaxperiodopresupuesto" />
    <EntitySet Name="adm_categoriapredefinidaxbanner" EntityType="Administracion.adm_categoriapredefinidaxbanner" />
    <EntitySet Name="adm_configuraciondetallepresupuesto" EntityType="Administracion.adm_configuraciondetallepresupuesto" />
    <EntitySet Name="adm_configuracionperiodopresupuesto" EntityType="Administracion.adm_configuracionperiodopresupuesto" />
    <EntitySet Name="adm_confirmacionseguridadoperacion" EntityType="Administracion.adm_confirmacionseguridadoperacion" />
    <EntitySet Name="adm_cuenta" EntityType="Base.adm_cuenta" />
    <EntitySet Name="adm_cuentaxmetafinanciera" EntityType="Administracion.adm_cuentaxmetafinanciera" /> 
```

我编辑了 POCO 实体生成器模板来读取我编辑过的 CSDL 文件，而不是读取项目文件夹中的 EDMX 文件。

模板上的代码如下所示：

```
string csdl = @"path\Administracion.csdl";  
var ItemCollection = new EdmItemCollection(csdl); 
```

运行模板时出现以下错误：

```
Error   1   Running transformation: System.Data.MetadataException: Schema specified is not valid. Errors: 
Administracion.csdl(3,4) : error 0160: No schema encountered with 'Base' namespace. Make sure the namespace is correct or the schema defining the namespace is specified.
Administracion.csdl(13,6) : error 0034: Unknown namespace or alias (Base). 
```

我究竟做错了什么？是因为 CSDL 文件位于不同的文件夹中吗？我必须把它们放在哪里？POCO 实体生成器模板可以处理在 CSDL 文件上导入命名空间吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:05:24.350

文件夹应该用“。”分隔。不是 '/'。

元数据的正确格式是：

`res:///DataLayer.myProject.myProject.csdl or res:///DataLayer.myProject.myProject.ssdl or res://*/DataLayer.myProject.myProject.msl`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T19:12:15.017

错误背后的问题是我没有在 EdmItemCollection 中加载其他 CSDL 文件。解决方案是将带有必要 CSDL 文件（包括具有导入命名空间的文件）的路径的 String[] 加载到 EdmItemCollection。

在代码中，它看起来像这样：

```
List<string> lstCsdlPaths = new List<string>();
lstCsdlPaths.Add(@"path\Base.csdl");
lstCsdlPaths.Add(@"path\Administracion.csdl");
var ItemCollection = new EdmItemCollection(lstCsdlPaths.ToArray()); 
```

# xml - 使用相对路径使用 DTD 或 XSD 进行本地 XML 验证？

> ID：14711569
> 
> 赞同：4
> 
> 时间：2013-02-05T15:57:34.563
> 
> 标签：xml, xsd, xml-validation, xsd-validation, dtd

可以使用文档类型描述 (DTD) 或 XML 模式 (xsd) 定义和验证 XML 文件，如下所示：

```
<?xml version='1.0' encoding='UTF-8'?>
<annotation xmlns="http://www.xyz.com"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.xyz.com
    file:system.xsd" > 
```

或者

```
<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE annotation SYSTEM "http://www.xyz.de/system.dtd"> 
```

这两种方式都定义了一个可以找到 DTD 或 XSD 的 URL。有没有办法给出相对或本地路径？所以我可以将它们与 XML 文件一起存储，而不是依赖服务器？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-05T16:01:46.743

这很简单。只需将文件的相对位置设置为

```
<?xml version='1.0' encoding='UTF-8'?>
<annotation xmlns="http://www.xyz.com" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.xyz.com ./system.xsd" > 
```

# c# - 如何使用 GUID 在实体框架中创建唯一主键并在发现重复项时重新生成 GUID？

> ID：14711573
> 
> 赞同：1
> 
> 时间：2013-02-05T15:57:43.743
> 
> 标签：c#, .net, entity-framework, ef-code-first

我有一个 CodeFirst 实体框架数据库。我自己生成了一个 GUID，模型中定义了以下内容：

```
 [Required, Key, DatabaseGenerated(System.ComponentModel.DataAnnotations.Schema.DatabaseGeneratedOption.None)]
    public string BatchId { get; set; } 
```

我的目标 - 有没有一种方法可以首先验证数据库中尚不存在 GUID，然后根据需要创建一个新的 GUID，直到找到唯一的 GUID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:01:08.057

这不是一个`Guid`，这是一个`string`；最好将其声明为 a `Guid`，那么您不必担心。

实际上，`Guid`相同的机器不会在同一台机器上生成两次。因此，如果您将财产更改为：

```
[Required, Key, DatabaseGenerated(System.ComponentModel.DataAnnotations.Schema.DatabaseGeneratedOption.None)]
    public Guid BatchId { get; set; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T16:05:31.493

务必先阅读数据库以确保确定。但是 E=MC^2 或你的钱回来。

```
Context.DbSet.find(MyGuid); 
```

Nope not found.... 如果使用 Guid.New(); 请告诉我们何时获得副本；

顺便说一句，您打算为您的 gUid 使用字符串还是键入 Guid / DBType UniqueIdentier ？如果是这样，您应该重新考虑选择的类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:01:27.533

这是我自己制作的旧代码：

```
private static IQueryable<MyData> FetchFromDatabase(MyContainer context, Guid guid)
{
    if (!context.DatabaseExists())
        throw Constants.ExceptionDatabaseMissing;

    return from data in context.MyDataSet
           where data.GUID.Equals(guid)
           select data;
} 
```

只需检查返回值是否包含任何内容。如果是，你有一个副本。

# ruby-on-rails - 当我需要在 rails 的表格中添加新字段时，我应该怎么做？

> ID：14711575
> 
> 赞同：1
> 
> 时间：2013-02-05T15:57:47.333
> 
> 标签：ruby-on-rails, field

我是 Rails 的新手；我的问题是：我有一个用户表，我需要添加更多字段......

我把它放在哪里？我试图把它放在迁移文件中，但是当我运行`rake db:migrate`.

这是在我的迁移文件中：

```
def self.up
 create_table :users do |t|
  t.string :username,         :null => false  # if you use another field as a username, for example email, you can safely remove this field.
  t.string :email,            :default => nil # if you use this field as a username, you might want to make it :null => false.
  t.string :crypted_password, :default => nil
  t.string :salt,             :default => nil
  t.string :nombres,          :default => nil
  t.string :apellidos,        :default => nil
  t.string :codigo,           :default => nil
  t.string :fecha,            :default => nil
  t.string :zona,             :default => nil
  t.string :institucion,      :default => nil
  t.string :frecuencia,       :default => nil
  t.string :pregunta,         :default => nil
  t.string :respuesta,        :default => nil

  t.timestamps
  end 
```

并且架构仍然没有新字段

```
create_table "users", :force => true do |t|
t.string   "username",                     :null => false
t.string   "email"
t.string   "crypted_password"
t.string   "salt"
t.string   "nombres"
t.string   "apellidos"
t.string   "codigo"
t.string   "fecha"
t.string   "zona"
t.string   "institucion"
t.string   "frecuencia"
t.datetime "created_at",                   :null => false
t.datetime "updated_at",                   :null => false
t.string   "remember_me_token"
t.datetime "remember_me_token_expires_at"
end 
```

我应该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:04:01.327

# 简单迁移

您可以使用迁移生成器：
`$> rails g migration add_position_to_users position:integer`
然后运行
`$> rake db:migrate`

# 更复杂的迁移

或更复杂的迁移，rails 还提供：
`$> rails g migration add_body_and_pid_to_users body:string:index pid:integer:uniq:index`
`$> rake db:migrate`

有关迁移的更多信息，请访问 railsguides [http://guides.rubyonrails.org/migrations.html](http://guides.rubyonrails.org/migrations.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T12:11:26.673

我认为我们在这里没有提到的是将代码添加到迁移文件中。

我添加列的步骤是这样的：

```
# rails generate migration AddFieldName blah:string 
```

在生成的迁移文件里面：

（顺便说一句，这通常看起来像：db/migrations/20130330115915_add_field_name.rb）

```
class AddFieldName < ActiveRecord::Migration
    def change
        add_column :table_name, :blah, :string
    end
end 
```

进行此更改后，我*然后*运行 ​​db:migrate。然后，将该列添加到数据库中。

# flash - 调整大小时垂直居中动画剪辑

> ID：14711580
> 
> 赞同：1
> 
> 时间：2013-02-05T15:58:11.013
> 
> 标签：flash, actionscript, actionscript-2

我的公司有一款可以在线阻止各种内容类型的产品，我目前正在设计何时`*.swf`阻止文件。自从我在 Flash 中工作以来已经有好几年了，我需要一些帮助。**这必须用 ActionScript 2 编写以确保最大的兼容性！**

我有一个 4 帧的影片剪辑，我根据舞台大小/比例切换帧以显示不同的徽标布局。不过，在所有情况下，徽标都应该集中在我遇到问题的舞台上。它非常接近居中，但在某些情况下它已经足够使徽标被切断。

有问题的代码在第一帧。一般来说，我为使影片剪辑居中所做的一切是：

```
Stage.align = "TC";
Stage.scaleMode = "noscale";

var blockedContent:MovieClip = _root.mc_blocked;
var stageListener:Object = new Object();
stageListener.onResize = function() {
    blockedContent._y = (Stage.height/2)-(blockedContent._height/2);`
};
Stage.addListener(stageListener); 
```

* * *

但这里是完整的代码，因此您可以在上下文中查看它。

```
// set the Flash movie to have a fixed anchor in the top top center of the screen.
Stage.align = "TC";
// prevent the Flash movie from resizing when the window changes size.
Stage.scaleMode = "noscale";

//--------------------------------------------------------------------
//Add a new listener when the stage is resized
//--------------------------------------------------------------------
var stageListener:Object = new Object();
stageListener.onResize = function() {
    fixLayout();
};
Stage.addListener(stageListener);

//--------------------------------------------------------------------
//Define some variables
//--------------------------------------------------------------------
var blockedContent:MovieClip = _root.mc_blocked;
var StageRatio:Number = 0;
var Sizes:Object = {
    Padding:20,
    VLarge:{w:0, h:0},
    VSmall:{w:0, h:0},
    HLarge:{w:0, h:0},
    HSmall:{w:0, h:0}
};
//--------------------------------------------------------------------
//duplicate the clip, and save the sizes for each frame
//--------------------------------------------------------------------
duplicateMovieClip(blockedContent, "mc_duplicate", _root.getNextHighestDepth());
mc_duplicate._alpha = 0;
mc_duplicate.gotoAndStop(1);
Sizes.VLarge.w = mc_duplicate._width;
Sizes.VLarge.h = mc_duplicate._height;
mc_duplicate.gotoAndStop(2);
Sizes.HLarge.w = mc_duplicate._width;
Sizes.HLarge.h = mc_duplicate._height;
mc_duplicate.gotoAndStop(3);
Sizes.VSmall.w = mc_duplicate._width;
Sizes.VSmall.h = mc_duplicate._height;
mc_duplicate.gotoAndStop(4);
Sizes.HSmall.w = mc_duplicate._width;
Sizes.HSmall.h = mc_duplicate._height;
//Remove it, we are done with it
mc_duplicate.removeMovieClip();

//Uncomment to see if it is centered
//mc_duplicate._alpha = 25;
//mc_duplicate.gotoAndStop(1);

//--------------------------------------------------------------------
//Fix the layout and scale things appropriately
//--------------------------------------------------------------------
function fixLayout() {

    StageRatio = Stage.width/Stage.height;
    //derermine which way to scale the logo
    if (Stage.height-Sizes.Padding>Sizes.VLarge.h+Sizes.Padding || (StageRatio>0.67 && StageRatio<2.45)) {
        if (Stage.width-Sizes.Padding<Sizes.VSmall.w+Sizes.Padding) {
            //Small vertical layout (no logo)
            blockedContent.gotoAndStop(3);
        } else {
            //default state - the large vertical layout
            blockedContent.gotoAndStop(1);
        }
    } else {
        //if it's not as tall as the large vertical...
        if (Stage.width-Sizes.Padding<Sizes.HSmall.w+Sizes.Padding) {
            //Use the small horizontal (no logo)
            blockedContent.gotoAndStop(4);
        } else {
            //Use the large horizontal
            blockedContent.gotoAndStop(2);
        }
    }
    //make sure it's never larger than 100%
    blockedContent._xscale = blockedContent._yscale=100;

    //Resize by the height...
    if (blockedContent._height+Sizes.Padding>Stage.height-Sizes.Padding) {
        blockedContent._height = Stage.height-Sizes.Padding;
        //Match the scales
        blockedContent._xscale = blockedContent._yscale;
    }
    //Resize by the width...  
    if (blockedContent._width+Sizes.Padding>Stage.width-Sizes.Padding) {
        blockedContent._width = Stage.width-Sizes.Padding;
        //Match the scales
        blockedContent._yscale = blockedContent._xscale;
    }

    //Center it up   
    blockedContent._y = (Stage.height/2)-(blockedContent._height/2); //-Sizes.Padding*2;
}

//--------------------------------------------------------------------
//Fade it in, and initially call the layout fix
//--------------------------------------------------------------------
blockedContent._alpha = 0;
setTimeout(function(){
    blockedContent.onEnterFrame=function(){
        this._alpha+=3;
        if(this._alpha>=100){
            delete this.onEnterFrame;
        }
    }
},300);
fixLayout(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:10:01.067

MovieClip 中的内容`blockedContent`已经居中。因此，您所要做的就是根据舞台高度（除以一半）将 MC 居中。只需删除`(blockedContent._height/2)`代码的一部分：

```
blockedContent._y = (Stage.height/2); 
```

# c# - 如何等待在 WinRT 中使用反射调用的异步私有方法？

> ID：14711585
> 
> 赞同：65
> 
> 时间：2013-02-05T15:58:26.117
> 
> 标签：c#, reflection, windows-runtime, async-await

我正在为 WinRT 应用程序编写单元测试，并且可以使用以下方法调用非异步私有方法：

```
TheObjectClass theObject = new TheObjectClass();
Type objType = typeof(TheObjectClass);
objType.GetTypeInfo()
       .GetDeclaredMethod("ThePrivateMethod")
       .Invoke(theObject, null); 
```

但是，如果有问题的私有方法是`async`，代码将继续执行而不等待它完成。

如何`await`为此添加功能？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2013-02-05T16:01:09.187

那么您需要使用该方法返回的值。你知道类型吗？例如，如果它总是 a `Task`，您可以使用：

```
await (Task) objType.GetTypeInfo()
                    .GetDeclaredMethod("ThePrivateMethod")
                    .Invoke(theObject, null); 
```

如果您不知道返回类型但知道它是可等待的，您可以使用动态类型：

```
await (dynamic) objType.GetTypeInfo()
                       .GetDeclaredMethod("ThePrivateMethod")
                       .Invoke(theObject, null); 
```

不过，我会*尽量*避免首先在单元测试中通过反射来调用私有方法。您可以通过公共（或内部）API 间接测试它吗？这通常是可取的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-05T16:00:49.807

`Invoke`应该返回一个可转换为`Task`. 就是`await`这样。

如果您的私有方法返回`void`，那么您将需要一个 custom `SynchronizationContext`，这很混乱。最好让您的方法返回`Task`/ `Task<T>`。

# javascript - Shell 排序不适用于 JavaScript

> ID：14711587
> 
> 赞同：0
> 
> 时间：2013-02-05T15:58:31.367
> 
> 标签：javascript, arrays, sorting, shellsort

我有一个 Java 代码，它运行良好，但是转换为 JavaScript 的代码会引发错误。ShellSort 方法将一个数组传递给该方法。（**我正在使用控制台进行调试**）我的代码是：

```
this.shellSort = function(nums)
    {
//O contador de tempo inicia aqui
    var tempoSS = new Date();
    var n = nums.length;
    console.log("n = ",n);
    var h = n / 2;
    console.log("h = ",h);
    var c, j;
    while (h > 0)
    {
        for (var i = h; i < n; i++)
        {
            c = nums[i];
            j = i;
            while (j >= h && nums[j - h] > c)
            {
                nums[j] = nums[j - h];
    console.log("nums["+j+"] = ",nums[j]);
                j = j - h;
    console.log("j = ",j);
            }
            nums[j] = c;
    console.log("nums["+j+"] = ",nums[j]);
        }
        h = h / 2;
    console.log("h = ",h);
    } 
```

捕获的错误是`-- [13:52:59.581] ReferenceError: reference to undefined property nums[(j - h)] @ file:///C:/Documents%20and%20Settings/erickribeiro/Desktop/www/index.html:240`

**测试页面：dev.erickribeiro.com.br/index.html**

完整的脚本是 html 页面。怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:07:40.243

我相信您会陷入无限循环，因为`h`有时可能会浮动。你必须确保它是一个整数（在 Java 中它总是这样，因为你可能这样声明它）：

```
this.shellSort = function(nums)
    {
//O contador de tempo inicia aqui
    var tempoSS = new Date();
    var n = nums.length;
    console.log("n = ",n);

    // HERE:
    var h = Math.floor(n / 2);

    console.log("h = ",h);
    var c, j;
    while (h > 0)
    {
        for (var i = h; i < n; i++)
        {
            c = nums[i];
            j = i;
            while (j >= h && nums[j - h] > c)
            {
                nums[j] = nums[j - h];
    console.log("nums["+j+"] = ",nums[j]);
                j = j - h;
    console.log("j = ",j);
            }
            nums[j] = c;
    console.log("nums["+j+"] = ",nums[j]);
        }

        // AND HERE:
        h = Math.floor(h / 2);
    console.log("h = ",h);
    }
} 
```

# c++ - 分配给构造函数？（就像一个元组层）

> ID：14711588
> 
> 赞同：2
> 
> 时间：2013-02-05T15:58:32.553
> 
> 标签：c++, constructor, assignment-operator

当我可以分配给“看起来”像构造函数的函数时，为什么我不能分配给构造函数？

例子：

```
struct Bar {
   Bar() : b_(false) {}
   Bar(bool b) : b_(b) {}
};

struct Foo {
   Foo(Bar const & bar) : bar_(bar) {}
   Foo operator=(Foo const & f) { return Foo(f.bar_); }
   const Bar & bar_;
}

Foo bool_to_foo(bool b) { return Foo(Bar(b)); }

Foo MakeFoo(Bar const & bar) { return Foo(bar); } 
```

为什么会这样：

```
Bar bar;
MakeFoo(bar) = bool_to_foo(true); 
```

当这不起作用时？

```
Bar bar;
Foo(bar) = bool_to_foo(true);  // Error: 'bar': redefinition; different basic types 
```

MakeFoo(.) 和 Foo(.) 具有相同的签名和相同的功能。

构造函数有什么特别之处？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T16:07:51.057

这一行：

```
Foo(bar) = bool_to_foo(true); 
```

不做你认为它做的事。它*没有*声明一个用 初始化的临时对象`bar`。它实际上所做的是声明一个名为`bar`type的对象`Foo`并使用 value 对其进行初始化`bool_to_foo(true)`。

从这个意义上说，它完全等同于：

```
Foo bar = bool_to_foo(true); 
```

由于您已经`bar`在范围内命名了一个对象，因此这是一个重新定义。

* * *

如果你仍然想做你想做的事情，你可以尝试：

```
Foo((0,bar)) = bool_to_foo(true); 
```

但是，由于这既丑陋又令人困惑，我不会进一步描述它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:12:03.660

该`MakeFoo()`函数返回一个对象，然后可以将其分配给（尽管我怀疑带有编译器警告的它会抱怨分配给临时对象）。但是，正如您所推测的，C++ 标准对构造函数给予特殊处理。虽然我不完全确定，但我怀疑该`= bool_to_foo(true)`部分被视为初始化，而不是分配。这会导致错误，因为 foo 没有复制构造函数。

Rob 的 Foo(bar) 交易也一针见血。C++ 语法有时会很奇怪。

无论如何，这两种形式中的任何一种都是不好的做法——分配给右值*可能*不是你想要的，如果是的话，很可能会让人们感到困惑。

# events - 如何在primefaces中的p：schedule的“月”视图中隐藏事件时间？

> ID：14711589
> 
> 赞同：2
> 
> 时间：2013-02-05T15:58:32.653
> 
> 标签：events, primefaces, schedule

是否可以在“**月**”视图中隐藏事件时间？我正在使用`<p:schedule>`，我只想在日历的月视图中显示事件标题。

希望有办法....请帮助

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T16:04:03.143

`fc-event-time`您可以通过将css 类设置为来隐藏时间`display:none;`

像这样

```
.fc-event-time{
    display:none;
} 
```

但是你最好给它一个更具体的 id ，像这样（你可以`prependId="false"`在调度程序周围的表单中设置）

```
#myscheduleId .fc-event-time{
    display:none;
} 
```

只需确保最后包含 css（例如在您`h:body`的示例中）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-08T11:01:49.567

使用属性 rightHeaderTemplate。默认值为月，议程周，议程日。更改为 rightHeaderTemplate ="agendaWeek,agendaDay"

# ruby-on-rails - 为现有模型生成脚手架

> ID：14711591
> 
> 赞同：0
> 
> 时间：2013-02-05T15:58:37.753
> 
> 标签：ruby-on-rails, scaffolding

RoR 的新手。我已经构建了没有命名空间的模型。其中之一被称为“品牌”。然后我继续使用 rails g "admin/brands" 将维护功能放在管理命名空间下，使用`rails generate scaffolding_controller "admin/brand"`- 生成视图和控制器。当我进行测试时，单元测试失败：

```
NoMethodError: undefined method `admin_brands' for #<Admin::BrandsControllerTest:0x1034c0730>
test/functional/admin/brands_controller_test.rb:5:in `_callback_before_193' 
```

在 routes.rb 我有：

```
# Administration routes
namespace :admin do
    resources :brands
end 
```

生成的控制器代码如下：

```
class Admin::BrandsController < ApplicationController
  # GET /admin/brands
  # GET /admin/brands.json
  def index
    @admin_brands = Brand.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render :json => @admin_brands }
    end
  end

  # GET /admin/brands/1
  # GET /admin/brands/1.json
  def show
    @admin_brand = Brand.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render :json => @admin_brand }
    end
  end

  # GET /admin/brands/new
  # GET /admin/brands/new.json
  def new
    @admin_brand = Brand.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render :json => @admin_brand }
    end
  end

  # GET /admin/brands/1/edit
  def edit
    @admin_brand = Brand.find(params[:id])
  end

  # POST /admin/brands
  # POST /admin/brands.json
  def create
    @admin_brand = Brand.new(params[:admin_brand])

    respond_to do |format|
      if @admin_brand.save
        format.html { redirect_to @admin_brand, :notice => 'Brand was successfully created.' }
        format.json { render :json => @admin_brand, :status => :created, :location => @admin_brand }
      else
        format.html { render :action => "new" }
        format.json { render :json => @admin_brand.errors, :status => :unprocessable_entity }
      end
    end
  end

  # PUT /admin/brands/1
  # PUT /admin/brands/1.json
  def update
    @admin_brand = Brand.find(params[:id])

    respond_to do |format|
      if @admin_brand.update_attributes(params[:admin_brand])
        format.html { redirect_to @admin_brand, :notice => 'Brand was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render :action => "edit" }
        format.json { render :json => @admin_brand.errors, :status => :unprocessable_entity }
      end
    end
  end

  # DELETE /admin/brands/1
  # DELETE /admin/brands/1.json
  def destroy
    @admin_brand = Brand.find(params[:id])
    @admin_brand.destroy

    respond_to do |format|
      format.html { redirect_to admin_brands_url }
      format.json { head :no_content }
    end
  end
end 
```

不知道如何调试此类问题......我认为路径以某种方式搞砸了，但这就是我目前所能理解的。帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:20:16.393

在我们公司，我们不使用脚手架，尤其是当我们需要生成管理命名空间时。
您可以简单地自己编写管理命名空间。

# 配置/路由.rb

```
 namespace :admin do
      root :to => "base#index"
      resources :pages 
    # resources :states do
      # member do
        # get :make_default
      # end
    # end
  end 
```

# 应用程序/控制器/管理员/base_controller.rb

```
class Admin::BaseController < ApplicationController
 before_filter :authenticate_user!, :admin_user?

  layout "admin/admin"
  def index
    @page = Page.all
  end

private
  def admin_user?
   redirect_to root_path, :alert => 'This page is allowed for admin' unless current_user.admin
  end
end 
```

# app/views/admin/base/index.html.haml

```
= link_to "New Post", new_admin_post_path
%ul
  - @post.each do |post|
    %li= post.title 
```

# enums - 枚举 [显示（名称）本地化 MVC 4

> ID：14711598
> 
> 赞同：0
> 
> 时间：2013-02-05T15:59:03.817
> 
> 标签：enums, data-annotations

我有一个包含国家/地区的枚举：

```
public enum CountryEnum
{
    [Display(Name = "AF", ResourceType = typeof(Global))]
    AF,

    [Display(Name = "AL", ResourceType = typeof(Global))]
    AL,

    [Display(Name = "DZ", ResourceType = typeof(Global))]
    DZ,
}; 
```

如您所见，我使用 DataAnnotations 来本地化这些值。

现在我想显示一个包含所有本地化国家名称的下拉列表。我想出了这段代码：

```
public static string GetDisplayName<TEnum>(TEnum value)
{        
    FieldInfo fi = value.GetType().GetField(value.ToString());

    DisplayAttribute[] attributes = 
        (DisplayAttribute[])fi.GetCustomAttributes(
            typeof(DisplayAttribute), false);

        if ((attributes != null) && (attributes.Length > 0))
            return attributes[0].Name;
        else
            return value.ToString();
} 
```

我有一个使用上述方法的 Html 助手：

```
public static MvcHtmlString EnumDropDownListFor<TModel, TEnum>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TEnum>> expression, object htmlAttributes)
{
    ModelMetadata metadata = ModelMetadata.FromLambdaExpression(expression, htmlHelper.ViewData);
    Type enumType = GetNonNullableModelType(metadata);
    IEnumerable<TEnum> values = Enum.GetValues(enumType).Cast<TEnum>();

    IEnumerable<SelectListItem> items = from value in values
                                        select new SelectListItem
                                        {
                                            Text = GetDisplayName(value),
                                            Value = value.ToString(),
                                            Selected = value.Equals(metadata.Model)
                                        };

    // If the enum is nullable, add an 'empty' item to the collection
    if (metadata.IsNullableValueType)
        items = SingleEmptyItem.Concat(items);

    return htmlHelper.DropDownListFor(expression, items, htmlAttributes);
} 
```

DropDown 正确呈现，但是`GetDisplayName`不返回本地化值，它只显示名称属性（例如，第一个条目的 AF）。

如何修改`GetDisplayName`方法以返回本地化值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-11T09:35:16.870

您需要更新您的`GetDisplayName`方法以使用该`GetName()`方法而`Name`不是`DisplayAttribute`.

像这样：

```
public static string GetDisplayName<TEnum>(TEnum value)
{
    FieldInfo fi = value.GetType().GetField(value.ToString());

    DisplayAttribute[] attributes = (DisplayAttribute[])fi.
        GetCustomAttributes(typeof(DisplayAttribute), false);

    if ((attributes != null) && (attributes.Length > 0))
        return attributes[0].GetName();
    else
        return value.ToString();
} 
```

来自 MSDN 文档`DisplayAttribute.Name`：

> 不要使用此属性来获取 Name 属性的值。请改用 GetName 方法。

该`GetName()`方法的 MSDN 文档有这样的说法：

> 如果已指定 ResourceType 属性并且 Name 属性表示资源键，则返回 Name 属性的本地化字符串；否则，Name 属性的非本地化值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-24T22:38:13.500

我遇到了类似的问题，像你一样设置了显示属性（因为类使用相同的属性来加载本地化更容易），所以拿了你的初始代码并稍微调整了一下，现在它按预期显示了本地化字符串。我不认为这是最聪明或最优化的方法，但它确实有效。希望这就是你的意图。

```
public static string GetDisplayName<TEnum>(TEnum value)
    {
        FieldInfo fi = value.GetType().GetField(value.ToString());

        DisplayAttribute[] attributes = (DisplayAttribute[])fi.
            GetCustomAttributes(typeof(DisplayAttribute), false);

        if ((attributes != null) && (attributes.Length > 0))
        {
            string key = attributes[0].Name;
            string localizedString = attributes[0].ResourceType.GetProperty(key).GetValue("").ToString();
            return localizedString;
        }
        else
            return value.ToString();
    } 
```

# java - Selenium Webdriver(JAVA) 嵌套元素

> ID：14711601
> 
> 赞同：5
> 
> 时间：2013-02-05T15:59:10.530
> 
> 标签：java, selenium, webdriver, selenium-webdriver

如何在不使用 xpath 的情况下访问嵌套元素

这就是我在 Selenium WebDriver (Ruby) 中编写它的方式

```
@browser.find_element(:class, 'mapLock').find_element(:class => 'mapLockOverlay').click 
```

但是我将如何用我尝试过的 JAVA 编写它：

```
browser.findElement(By.className("mapLock").findElement(By.className("mapLockDisplay").click 
```

我知道这显然是错误的

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T16:35:09.277

您实际上非常接近，请注意括号。我只是把事情分开了一点。

```
final WebElement mapLockElement = browser.findElement(By.className("mapLock"));
final WebElement mapLockDisplayElement = mapLockElement.findElement("mapLockDisplay");
mapLockDisplayElement.click(); 
```

如果您在一条线上完成所有操作，那将是

```
browser.findElement(By.className("mapLock")).findElement(By.className("mapLockDisplay")).click(); 
```

# java - 如何在 OSGI 中包含 slf4j-api、logback 和 slf4j.impl 的自定义实现？

> ID：14711604
> 
> 赞同：1
> 
> 时间：2013-02-05T15:59:14.440
> 
> 标签：java, osgi, slf4j, logback

我之前使用 slf4j-api、logback-core 和 logback-classic 包实现了 OSGI 日志记录到文件。

我现在想在一个单独的包中拦截日志调用（以在网页 servlet 中显示它们）。[本博客](http://blog.kornr.net/index.php/2008/12/18/osgi-logging-putting-it-all-together)上的本教程建议构建 org.slf4j.impl 的自定义实现，以将消息传递给日志服务。（这很好用！）

我遇到的问题是，我还想使用 logback 将日志消息保存到文件中，而我们自定义的 org.slf4j.impl 实现是 OSGI 中的一个捆绑包，可防止使用 org.slf4j.impl 的 logback 实现。

我认为这可能是因为在本教程中，org.slf4j.impl 和 slf4j-api 的自定义实现是作为依赖项嵌入的，而不是作为捆绑包安装的。但是，当我尝试这个时

```
<Embed-Dependency>slf4j.api_1.7.2.jar, logbackadapter.jar;scope=compile|runtime;inline=false</Embed-Dependency>
<Embed-Transitive>true</Embed-Transitive> 
```

Slf4j-api 仍然作为包安装。有谁知道如何将 slf4j-api 嵌入到一个包中以防止它使用 logback 提供的导出的 org.slf4j.impl ？

谢谢你的帮助，

布赖恩

ps 完整的 pom 元素是：

```
<plugin>
    <groupId>org.apache.felix</groupId>
    <artifactId>maven-bundle-plugin</artifactId>
    <version>1.4.3</version>
    <extensions>true</extensions>

   <configuration>
      <instructions>
        <Bundle-SymbolicName>${bundle.symbolicName}</Bundle-SymbolicName>
        <Bundle-Version>${pom.version}</Bundle-Version>
        <Export-Package></Export-Package>
        <Private-Package>${bundle.namespace}.internal.*</Private-Package>
        <Embed-Dependency>slf4j.api_1.7.2.jar;logbackadapter.jar;scope=compile|runtime;inline=true</Embed-Dependency>
        <Embed-Transitive>true</Embed-Transitive>
      </instructions>
   </configuraiton>
</plugin> 
```

依赖元素是：

```
<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>slf4j-api</artifactId>
    <version>1.7.2</version>
    <scope>compile</scope>
</dependency> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T08:31:32.697

我建议使用 Pax-Logging，这为您提供了日志记录所需的一切。只有“缺点”，取决于您如何看待它，它是由 std. log4j 属性文件，因为它为此使用了 ConfigurationAdmin 服务。除此之外，它对各种不同的登录框架、log4j、slf4j、jul 等都有很大帮助......

[Pax 记录](http://team.ops4j.org/wiki/display/paxlogging/Pax+Logging)

# android - Android ProgressDialog 查询处理

> ID：14711612
> 
> 赞同：0
> 
> 时间：2013-02-05T15:59:30.070
> 
> 标签：android, android-asynctask, progressdialog

我`android.os.AsyncTask`对处理方法很陌生`android.app.ProgressDialog`。我遇到了通过处理特定查询`android.database.Cursor`并将其转换为我需要的实体的问题。

我正在关注这个模板，但它总是返回给我一个`android.view.WindowManager$BadTokenException`.

```
List<Entity> loadData() throws Exception {
    AsyncTask<Cursor, Void, List<Entity>> process = new AsyncTask<Cursor, Void, List<Entity>>() {
        ProgressDialog dialog;
        protected void onPreExecute() {
            dialog = ProgressDialog.show(getApplicationContext(), "Please wait...", "Loading data...");         
        }
        protected void onPostExcecute() {
            dialog.dismiss();
        }
        @Override
        protected List<Entity> doInBackground(Cursor... params) {
            List<Entity> entities = new ArrayList<Entity>();
            // process of convertion of data from android.database.Cursor to <pacakge>.Entity
            return entities;
        }
    }.execute(/* the query : android.database.Cursor */)
    return process.get();
} 
```

我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:15:57.303

`ProgressDialog`从AsyncTask 的方法中显示`onPreExecute()`使用 AsyncTask 正在运行的当前活动上下文而不是`getApplicationContext()`：

```
 dialog = ProgressDialog.show(Your_Current_Activity.this, 
                    "Please wait...",
                    "Loading data..."); 
```

如果`AsyncTask`在单独的类中运行，`Activity`则需要使用 AsyncTask 的类构造函数在 AsyncTask 中传递当前活动上下文

# facebook - 获取使用我的 facebook 应用程序的用户列表

> ID：14711614
> 
> 赞同：1
> 
> 时间：2013-02-05T15:59:33.787
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我发现有一种方法可以找到我的哪些朋友是我的 facebook 应用程序的用户。

```
$retrobj=$facebook->api(array('method' => 'fql.query', 'query' =>
"SELECT name FROM user WHERE is_app_user = '1' AND uid IN (SELECT uid2
 FROM friend WHERE uid1 = '" . $user. "')")); 
```

上面的查询将显示我的哪些朋友 uid 使用我的应用程序。

然后我使用一个while循环来解析返回的数组。

我的问题是以下...

如果我没有他们的身份证，有没有办法让所有用户即使他们不是使用我的应用程序的朋友？

我还没有找到一种方法，这就是为什么我要问是否真的有办法做到这一点。

任何帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T16:19:52.217

没有。Facebook 发现一些开发人员构建应用程序只是为了收集 Facebook 用户名，然后向他们发送垃圾邮件。他们删除了返回应用程序和页面用户列表的功能。

您运行的任何 FQL 查询都必须在`WHERE`子句中包含一个索引字段（标有星号），否则查询将失败。这需要`name`,`username`或`user_id`. 查询`friend`、`event_member`或表是`stream`获取`checkin`其他用户列表的一些有效方法。

# c# - 当我点击 VStudio 2010 IDE 上的播放按钮时，如何知道运行了哪些确切的命令？

> ID：14711616
> 
> 赞同：3
> 
> 时间：2013-02-05T15:59:36.450
> 
> 标签：c#, visual-studio-2010

我对 Visual Studio 比较陌生，我想知道当我点击 IDE 的播放按钮来构建项目时到底发生了什么。有没有办法知道在后台执行了哪些命令？

当我打开输出窗口时，我会看到以下内容。

```
------ Build started: Project: ZXing.Net.Mobile.MonoForAndroid, Configuration: Debug Any CPU ------

ZXing.Net.Mobile.MonoForAndroid -> C:\Users\avi\Desktop\APC-mono\ZXing.Net.Mobile\bin\Debug\ZXing.Mobile.dll

========== Build: 1 succeeded or up-to-date, 0 failed, 0 skipped ========== 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T16:04:08.913

*   在“选项”对话框中（来自`Tools | Options...`）
*   在左边的树中选择`Projects and Solutions | Build and Run`
*   在右边，下`MSBuild project build output verbosity`，选择（说）`Normal`

现在，当您构建时，构建输出将具有更多详细信息。请注意，这`Detailed`可能比您需要的更详细，并且`Diagnostic`几乎可以肯定比您需要的更详细。

截图如下：

![在此处输入图像描述](../Images/d4a2f75bccb39dc9bf5a01d149b55740.png)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-05T16:03:25.903

通过单击播放按钮，您开始调试程序。所有程序都从找到 Main() 的地方开始。

# jquery - 使用从数据库中提取的颜色数据更改数据表中的颜色

> ID：14711617
> 
> 赞同：1
> 
> 时间：2013-02-05T15:59:38.220
> 
> 标签：jquery, datatables

有两种方法可以在[DataTables](http://www.datatables.net)中显示 sql 数据。第一个是用循环构建一个 html 表。第二个选项是使用[sAjaxsource](http://www.datatables.net/ref#sAjaxsource)。

用第一种解决方案改变每个颜色`<tr>`是微不足道的，如下所示：

```
<table>
<thead>
  <tr>
    <th>id</th>
    <th>Customer Number</th>
    <th>WCODE</th>
  </tr>
</thead>
<tbody>
  <?php  while ($row = mysql_fetch_array($result)) :?>

    <tr style="background-color:<?=$row['COLOR']?>;" >
      <td ><?=$row['id']?></td>
      <td ><?=$row['customer_number']?></td>
      <td ><?=$row['WCODE']?></td>
    </tr>

  <? endwhile; ?>
</tbody>
</table> 
```

如您所见， $row['COLOR'] 是每一行的颜色。

我想使用第二个选项[sAjaxsource](http://www.datatables.net/ref#sAjaxsource)来完成相同的结果。`<tbody>`是空的，我无法控制每个 tr。没有tr。

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:06:00.893

使用简单的php，改变：

```
<tr style="background-color:<?=$row['COLOR']?>;border:1px solid;" > 
```

在

```
echo "<tr style=\"background-color:".$row['COLOR'].";border:1px solid;\" >"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:12:37.550

查看他们的文档，似乎没有一种干净或简单的方法可以做到这一点。`Note: I'm not familiar with this plugin. And I briefly skimmed their docs.`

我可能会建议，尽管可能有更好的解决方案，但在您返回的一个单元格中（对于每一行）添加一个 html 标签，如`<span class="SOMECLASS" style="background-color:YOURCOLOR; display: none;"></span>`.

表建立并加载后，运行如下：

```
$('tr span.SOMECLASS').each(function() {
    $(this).parents('tr:first').css('background-color', $(this).css('background-color'));
}); 
```

但是，我也想提出一些意见。将 UI 内容的颜色存储在数据库中并不是最佳实践，也许应该对数据进行一些后处理以确定该行是否需要为某种颜色。

希望这可以帮助。

# entity-framework - 简单的成员资格提供程序 - 实体框架和角色

> ID：14711622
> 
> 赞同：4
> 
> 时间：2013-02-05T15:59:52.647
> 
> 标签：entity-framework, simplemembership

我正在尝试尽可能“按书”使用带有 MVC 4 的 Simple Membership Provider。这是当前的情况：

- 我一直在使用 Jon Galloway 的关于该主题的博[文](http://weblogs.asp.net/jgalloway/archive/2012/08/29/simplemembership-membership-providers-universal-providers-and-the-new-asp-net-4-5-web-forms-and-asp-net-mvc-4-templates.aspx)。

1）我知道这个东西是通过实体框架连接的。但是，我确实注意到，当我向 UserProfile 类添加属性时，它们在生成时并没有自动出现在表中。这是由于数据库已经生成（表不存在）吗？我手动添加了这些字段，它可以正常工作，但是很高兴知道会导致字段无法自动创建的“陷阱”。

2) 就角色而言，它似乎主要面向全局权限类型的事物（即用户是用户、管理员等）。如果您想让它在项目级别处理（即项目1 的管理员，项目2 的用户），需要进行哪些修改？

等）是否有一篇文章真正详细介绍了如何扩展它的最佳实践？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T17:29:34.323

1) 我发现 Simple Membership 的 UserProfile 表部分有点复杂（以一种好的方式），但它对我的应用程序非常有用。

Simple Membership 的约定是创建一个名为“UserProfile”的 UserProfile 表，其中包含两个字段，UserId 和 UserName。您可以通过修改 Filters/InitializeSimpleMembershipAttribute.cs 中的 WebSecurity.InitializeDatabaseConnection() 行为 UserProfile 配置不同的表名或不同的 UserId 和 UserName 字段名。您可以创建一个带有附加字段的 UserProfile 表，如果 Simple Membership 在第一次运行时找到该表，Simple Membership 将使用该表。在默认配置下，您的应用第一次运行 SimpleMembership 时将创建数据库表，包括在 Filters/InitializeSimpleMembershipAttribute.cs 中指定的任何 UserProfile 表详细信息。

因此，诀窍是在第一次调用 Simple Membership 之前创建所需的 UserProfile 表（包括该表中所需的所有字段）。这可以由 EF Migrations 创建或由数据库脚本创建，甚至可以在 SSMS 中手动创建。

如果您想深入了解简单成员资格代码，请参阅[http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/5cb74eb3b2f3#src/WebMatrix.WebData/WebSecurity.cs](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/5cb74eb3b2f3#src/WebMatrix.WebData/WebSecurity.cs)和[http://aspnetwebstack.codeplex.com/ SourceControl/changeset/view/5cb74eb3b2f3#src/WebMatrix.WebData/SimpleMembershipProvider.cs](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/5cb74eb3b2f3#src/WebMatrix.WebData/SimpleMembershipProvider.cs)。

2）我同意你关于角色和全局权限的观点。也许您可以使用 AddUsersToRoles 和 RemoveUsersFromRoles （在[http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/5cb74eb3b2f3#src/WebMatrix.WebData/SimpleRoleProvider.cs](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/5cb74eb3b2f3#src/WebMatrix.WebData/SimpleRoleProvider.cs)）根据他们使用的项目在登录时修改用户的角色.

等）我不知道关于扩展简单成员资格的好文章，但原则上简单成员资格扩展了扩展成员资格提供程序，它扩展了 ASP.NET 成员资格提供程序。您应该能够在适当的位置跳入。

编辑回应罗伯特的评论：

作为 Entity Framework 没有创建添加到 UserProfile 类的列的直接答案，当在特定于应用程序的表创建运行之前，SimpeMembership 初始化已经创建了 UserProfile 表时，就会发生这种情况。原因是 SimpleMembership 具有 UserProfile 表的内置定义，在 SimpleMembership 创建该表时使用该定义。UserProfile 表的创建时间很重要，因此需要确保在 SimpleMembership 初始化运行之前创建了特定于应用程序的表。

# php - PHP 5.4 缺少用于会话管理的 sqlite 注册保存处理程序

> ID：14711628
> 
> 赞同：2
> 
> 时间：2013-02-05T16:00:03.393
> 
> 标签：php, sqlite, session

我正在将我们的应用程序从运行 PHP 5.3 的服务器迁移到运行 PHP 5.4 的新服务器。在我们的旧设置中，我们根据 php.ini 中的以下行使用 PHP 内置的 sqlite 会话处理程序

```
session.save_handler = sqlite
session.save_path = /some/dir/sessions.sqlite 
```

这对我们很有用，我们希望继续在新平台上做同样的事情。我遇到的问题是，这`sqlite`似乎不再是内置保存处理程序的有效选项。

在较旧的服务器上，我会看到：

```
[root@localhost ~]# php -i | grep "Registered save"
Registered save handlers => files user sqlite 
```

在我得到的新服务器上

```
[root@localhost ~]# php -i | grep "Registered save"
Registered save handlers => files user 
```

现在我一直在谷歌上搜索关于这个的文章，似乎在 PHP 5.4 中他们已经停止使用 sqlite 扩展来支持 sqlite3 扩展。很好，我有 sqlite3 工作，但它仍然不是注册保存处理程序的选项。

我的老板要求我们不要使用`files`处理程序，因为它过去给我们带来了问题。我唯一的选择真的是使用自定义处理程序吗？我认为理想情况下`sqlite`或至少`sqlite3`仍然是有效的处理程序。

如果我误读了这种情况，我会很高兴听到它。感谢您的任何意见。

# android - 关闭应用程序时如何将堆大小设置为最小

> ID：14711629
> 
> 赞同：0
> 
> 时间：2013-02-05T16:00:10.070
> 
> 标签：android, bitmap, out-of-memory, heap-memory

我正在开发一个 android 应用程序，它使用更多分辨率约为 640*960 的图像。所有这些图像都加载了具有适当比例因子的位图。

当我加载 bitmpas 时，堆大小正在增加，即使我正在回收 bitmpas，它也不会减少。当我读到很少关于这个问题的理论时，最大值说一旦堆增加它就不会减少。

我的问题是如果我在堆大小为 10MB 时关闭我的应用程序，而当我重新打开应用程序堆时从 10Mb 开始。它会导致 VM 超过最大堆内存，然后在一段时间后内存不足。

我必须为此做些什么，并且我保证如果没有回收位图，我的应用程序将永远不会关闭。

谁能建议我如何最小化堆内存并解决这个OOM。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:23:14.440

即使我遇到了同样的问题....您可以参考此链接以有效加载位图[http://developer.android.com/training/displaying-bitmaps/load-bitmap.html](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)

一旦堆大小超过了垃圾收集器运行的限制......它会清理任何不需要的对象。所以最好不要调用垃圾收集器，因为它会自动运行。

在 API 级别 11+ 上运行的应用程序可以在清单中的元素上使用 android:largeHeap="true" 以请求大于正常的堆大小

在您活动的 onCreate 方法中，您可以使用这个（我没有尝试过）dalvik.system.VMRuntime.getRuntime().setMinimumHeapSize(yournumberhere);

# c# - 我的 C# 应用程序正在将 0xE0434352 返回到 Windows 任务计划程序，但它没有崩溃

> ID：14711633
> 
> 赞同：83
> 
> 时间：2013-02-05T16:00:23.477
> 
> 标签：c#, .net, scheduled-tasks, task

我编写了一些通过 Windows 任务调度程序运行的 C# 应用程序。它们运行成功（正如我从它们正在编写的日志文件中看到的那样），但 Windows 任务调度程序显示它们返回的最后运行结果为`0xE0434352`. 我需要在我的 C# 应用程序中做些什么，以便它向 Windows 任务调度程序返回成功代码吗？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2013-03-19T13:27:56.730

另一种选择是简单地使用可通过 Windows 事件查看器访问的应用程序日志。.Net 错误将记录到应用程序日志中。

您可以在此处查看这些事件：

事件查看器（本地）> Windows 日志 > 应用程序

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2015-01-08T22:11:56.650

在新窗口中设置作业时，您有两个字段“**程序/脚本**”和“**开始（可选）** ”。将程序名称放在第一位，程序位置放在第二位。如果您不这样做并且您的程序不在 exe 目录中启动，它将找不到位于其中的文件。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-02-15T14:41:06.263

Hans Passant 是正确的，我为 AppDomain.CurrentDomain.UnhandledException 添加了一个处理程序，如此处所述[http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception(v=vs.71).aspx)我是能够找到正在发生的异常并纠正它。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-07-10T18:51:29.047

我正在引用一个**映射驱动器**，我发现映射驱动器并不总是可用于运行计划任务的用户帐户，因此我使用`\\IPADDRESS`而不是`MAPDRIVELETTER:`并且我已经启动并运行。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-04-23T18:48:18.650

如果它对其他人有帮助，当运行任务的服务没有对​​可执行位置的写入权限时，我会收到此错误。它试图在那里写一个日志文件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-08-13T09:23:44.820

我遇到了这个问题，这是由于 .Net 框架版本造成的。我已将构建升级到框架 4.0，但这似乎影响了应用程序正在使用的一些 comms dll。我回滚到框架 3.5，它运行良好。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-02-16T01:09:41.320

我遇到了同样的错误，但我通过将文件读取路径从**“ConfigFile.xml”**更改为 **AppDomain.CurrentDomain.BaseDirectory.ToString() +“ConfigFile.xml ”来修复它**

在我的情况下，由于文件路径错误导致此错误，因为任务管理器从“System32”作为初始路径启动程序，但我们认为的文件夹。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-03-20T14:28:37.380

我使用 MVC 5 在 dotNet Core 2.2 中收到了相同的消息消息，但是没有任何内容被记录到 Windows 事件查看器中。

我发现我已将 Project sdk 从更改`Microsoft.NET.Sdk.Web`为`Microsoft.NET.Sdk.Razor`（在`projects.csproj`文件中看到）。我把它改回来了，效果很好:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-10-23T13:54:38.780

还有 PowerShell 中的消息框。我将 PowerShell 脚本转换为 exe。当以管理员身份运行时，它可以工作，但在任务计划中我也收到了这个错误。PowerShell 脚本中有一行带有写输出。注释此行并编译新的 exe 任务计划后成功完成。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-07-31T04:34:36.183

我在处理 COM 对象时遇到了这个问题。在某些情况下（我的错），我破坏了一个外部 .EXE 进程，在一个并行线程中，一个变量试图访问 com 接口 app.method 并且发生了 COM 级崩溃。任务计划程序注意到这一点并关闭了应用程序。但是如果您在控制台中运行应用程序并且不处理异常，应用程序将继续工作......

请注意，如果您使用非托管代码或外部对象（AD、Socket、COM ...），您需要对其进行监控！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-06-26T19:55:59.437

就我而言，这是因为我有消息框。一旦我注释掉该代码，它就开始工作了。我记得当我按照此线程中的建议查看事件日志时，这可能是个问题。谢谢大家！

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2018-10-03T13:10:49.777

在我的情况下，这是权限问题，任务计划程序的用户对存在数据库的服务器没有权限。

# ruby - 什么是 ruby 1.9.3 依赖项

> ID：14711636
> 
> 赞同：0
> 
> 时间：2013-02-05T16:00:28.217
> 
> 标签：ruby, build, compilation, dependencies, libraries

我试图确定在从源代码安装 ruby​​ 之前需要安装的最少软件包。我已经对 ruby​​ 源进行了一些挖掘，我认为在这里询问可能会更快。

有没有人有一个列表或知道如何挖掘这些信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T17:11:43.593

这一切都在自述文件中......

对于包括 Mac OS 在内[的类 Unix 平台](https://github.com/ruby/ruby/blob/trunk/README#L67)，除了 C 编译器（C89 是官方目标，即使对于 Ruby 2.0.0 也是如此），没有额外的要求。

对于[Windows](https://github.com/ruby/ruby/blob/trunk/win32/README.win32)：

*   Windows XP 或更高版本。

*   Visual C++ 6.0 或更高版本。

*   命令：

    *   制作
    *   分类
    *   库
    *   垃圾箱

这可能令人惊讶，但不需要`libyaml`或`zlib`不需要类似的库。如果需要，Ruby 将[使用它的捆绑包。`libyaml`](https://bugs.ruby-lang.org/issues/7375)如果`zlib`未安装，则 Ruby 将工作，但`require 'zlib'`外部库将无法工作。

RTFM 了解更多详情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-08T14:42:18.487

根据其gentoo ebuild：berkdb、gdbm、ssl socks5、tk、ncurses、readline、yaml、libffi、zlib、libedit。

# php - 未选中复选框时发生错误（在 PHP 中）

> ID：14711639
> 
> 赞同：0
> 
> 时间：2013-02-05T16:00:35.657
> 
> 标签：php, checkbox

我有一个 php 代码，其中从我的数据库中获取数据，并在一个数组中获取对应每个数据的复选框。我已经有了可以更新我的表的代码（对于检查的每个数据）：

```
<?php
include("connect.php");
$user=$_SESSION['username'];
$updated = FALSE;
$submit=FALSE;
if(count($_POST) > 0){

$library = $_POST['library'];
array_map('intval',$library);
$library = implode(',',$library);
mysql_query("UPDATE ES_Students SET library=0") or trigger_error(mysql_error

(),E_USER_ERROR);
mysql_query("UPDATE ES_Students SET library=1 WHERE StudentNO IN ($library)") or        trigger_error

(mysql_error(),E_USER_ERROR);
$submit=TRUE;
$updated=TRUE;
}
?> 
```

我的问题是，只要没有选中复选框，就会出现库索引未定义的错误。我知道这与 $count($_POST)>0 有关，但我实际上不知道如何解决这个问题。我尝试放置一个 else 子句将其重定向到另一个页面，但它会导致相同的错误。谁能告诉我该怎么办？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:04:23.617

在你的帖子周围使用一个`isset`。[PHP 链接](http://php.net/manual/en/function.isset.php)

```
if( isset($_POST) && count($_POST) > 0){
  .... 
```

如果发送了任何数据，即使是空白表单，`isset($_POST)`也将返回 true，但 a`count($_POST)`为 0。因此，您还可以测试您要查找的数组的确切项目，以确保它实际上在`$_POST`：

```
if( isset($_POST) && count($_POST) > 0 && isset($_POST['library'])){
 .... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:08:26.667

您应该检查 $_POST['library'] 是否包含任何项目，因为如果它是空的，那么 implode 函数会返回一个空字符串，并且您的查询看起来像 ... IN () ，这不是有效的 sql 语法。

# rest - 面向客户端的 REST API 身份验证

> ID：14711646
> 
> 赞同：6
> 
> 时间：2013-02-05T16:01:02.100
> 
> 标签：rest, restful-authentication

我看过很多关于验证 RESTful API 的不同解决方案的不同帖子，鉴于当前的情况，我有一些问题。

我已经构建了一个 REST API，它将允许我的软件服务的客户（我们是一家 B2B 公司）以编程方式访问资源。现在我已经让 API 正常工作，我想以最标准化的方式保护它。我需要根据 API 的调用者允许访问某些资源。也就是说，并非所有 API 的用户都可以访问所有资源。

我有以下格式的 URL：

```
https://mydomain/api/students
https://mydomain/api/students/s123
https://mydomain/api/students/s123/classes
https://mydomain/api/students/s123/classes/c456 
```

到目前为止，我已经提出了这些可能的解决方案：

1.  为每个客户端提供一个唯一密钥，他们可以使用该密钥最终生成一个加密令牌，该令牌将在每个 REST 调用结束时作为 GET 参数传递，以（重新）验证每个请求。这种方法是否太昂贵

    [https://mydomain.com/api/students/s123?token=abc123](https://mydomain.com/api/students/s123?token=abc123)

2.  在 HTTP 授权标头中提供一个值，如此处[所示](http://en.wikipedia.org/wiki/List_of_HTTP_header_fields)。这和#1几乎一样吗？（除了我无法将 URL 粘贴到浏览器中）人们不再使用这些标题了吗？

3.  使用 OAuth 2（我还不清楚）。OAuth 2 是否真的将客户端验证为登录用户？这难道不违背 REST API 无状态的精神吗？我希望 OAuth 对我来说是正确的解决方案（因为它是一个公共标准），但是在阅读了一点之后，我不太确定。REST API 调用是否矫枉过正和/或不当？

我的目标是提供一个不需要为每个想要使用该 API 的客户更改的 API，而是我可以提供一个标准文档，供我们所有的客户使用。

如果我不清楚，我很乐意发布更多细节。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-01T15:30:32.130

您可能要准备 API 的客户端有 2 种类型：

*   受信任的客户 - 由您编写。他们可以拥有实际用户的用户名和密码，并且可以在每次请求时将该数据发送到您的服务器，可能在 HTTP auth 标头中。您所需要的只是他们的加密连接。

*   3rd 方客户端 - 由一些随机开发人员编写。您可以在您的服务中注册它们并为它们中的每一个添加一个唯一的 API 密钥。之后，如果用户想要使用他们的服务，您必须向她显示一个提示，在该提示中她可以允许访问第 3 方客户端。之后，第三方客户端将被分配给具有给定权限的用户帐户，并将获得用户特定的访问令牌。因此，当客户端将其 API 密钥和用户特定令牌与请求一起发送时，它会以用户的名义发送请求。

OAuth 可以帮助您控制第二种情况。

您的 URL 对客户没有任何意义。通过 REST，您必须通过发送带有语义注释的链接（例如链接关系）来将客户端与 URL 结构分离。因此，您的文档不必包含有关 URL 结构的任何内容（也许它对服务器端调试很有用，但仅此而已）。你必须谈论不同类型的链接。通过在服务器端生成这些链接，您可以检查实际用户（或第三方客户端）的权限并跳过她无权关注的链接。

# html - 文本到 Div 的底部

> ID：14711647
> 
> 赞同：6
> 
> 时间：2013-02-05T16:01:05.737
> 
> 标签：html, css

有什么方法可以将 div 的内容文本放到它的底部？这里我准备了一个例子。

[http://jsfiddle.net/JGuP7/](http://jsfiddle.net/JGuP7/)

这是示例层次结构：

```
<div class="button">Button Label</div> 
```

我试图在不添加额外跨度或更改层次结构的情况下实现结果。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T16:46:20.540

三种可能的解决方案，尽管每个都有自己的警告。

**[jsFiddle 演示](http://jsfiddle.net/JGuP7/6/)**

第一个解决方案依赖于`line-height: 220px; vertical-align: bottom;`将文本与`DIV`. 第二种解决方案创建了一个`:before`伪元素，将文本推到底部`DIV`（这不需要额外的标记）。两种解决方案都将在 IE7 或更早版本中失败，并且在以下情况下都会出现问题：

*   字体大小发生变化
*   文本换行到第二行
*   包含元素的大小发生变化

第三种解决方案依赖于`display: box;`属性，这是一个正在逐步淘汰的 CSS 属性（更多详细信息请参见[Quick Hits With the Flexible Box Model](http://www.html5rocks.com/en/tutorials/flexbox/quick/)）。仅从 v4 开始的 Chrome、从 v2 开始的 Firefox 和 IE10 beta 支持此解决方案。然而，一个新的 Flexbox 标准已经标准化，但浏览器支持却很少。该解决方案可能被认为“太新”而无法有效使用（[html5please.com/#flexbox](http://html5please.com/#flexbox)）。

一般来说，您应该考虑在文本周围添加一个新的包装元素，这将允许`position: absolute; bottom: 0;`将元素舒适地放置在父元素的底部。*这具有随着字体大小或文本长度增加而向上*增长子元素的好处，并且与父容器的尺寸无关。根据您的定位对布局的关键任务程度，您可以使用 Javascript 添加这个新元素。考虑到您提出的问题，这可能并不理想，但是对于我上面列出的更古怪的 CSS 解决方案来说，浏览器支持并不理想：-p

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-05T16:16:51.393

另一种方法是使用“display: table-cell”和“vertical-align:bottom”。

[http://jsfiddle.net/JGuP7/1/](http://jsfiddle.net/JGuP7/1/)

```
.button {
    display: table-cell;
    background-color: darkred;
    color: white;
    width: 120px;
    height: 120px;
    text-align: center;
    vertical-align: bottom;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:07:57.183

如果您`position:relative`在容器中使用，并使用

```
position:absolute;
bottom:0; 
```

在内容上，可以达到预期的效果。

您的 CSS 可能如下所示：

```
 .button
    {
        display: block;
        background-color: darkred;
        color: white;
        width: 120px;
        height: 120px;
        text-align: center;
        position: relative;
    }
    .bottomContent
    {
        position:absolute;
        bottom: 0;
    } 
```

和你的 HTML：

```
<div class="button"><p class="bottomContent">Button Label</p></div> 
```

[来源](https://stackoverflow.com/questions/8403882/css-text-align-bottom-of-container)

# php - 比较变量（字符串）并使用 if/else 找到更大的数字

> ID：14711650
> 
> 赞同：0
> 
> 时间：2013-02-05T16:01:09.790
> 
> 标签：php, string, if-statement

我有两个变量：

```
$wh_odds_attrib
$lad_odds_attrib 
```

如果我对它们执行 var_dump，我会得到

```
string(4) "1.36"
string(4) "2.00" 
```

分别。

我想在 if 语句中使用这些 vairbales，但是如果我这样做，它将评估什么，即值。1.36 还是 string(4) 部分？（我需要评估的部分是 1.36）

我使用的 if 语句是

```
 if ($wh_odds_attrib['oddsDecimal'] > $lad_odds_attrib['oddsDecimal']) {
      echo $wh_odds_attrib['oddsDecimal'];

  } else {
      echo $lad_odds_attrib['oddsDecimal'];
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:10:09.853

如果由于某种原因您的字符串比较失败，您可以使用*类型转换将值转换为双精度值。*

```
if ((double) $wh_odds_attrib['oddsDecimal'] > (double) $lad_odds_attrib['oddsDecimal']) {
     echo $wh_odds_attrib['oddsDecimal'];
 } else {
     echo $lad_odds_attrib['oddsDecimal'];
 } 
```

不过，这可能不是必需的。建议阅读： http: [//php.net/manual/en/language.types.type-juggling.php](http://php.net/manual/en/language.types.type-juggling.php)

# php - 5.4 解除对有效 5.3 数组调用的引用

> ID：14711654
> 
> 赞同：2
> 
> 时间：2013-02-05T16:01:17.603
> 
> 标签：php, arrays

我在使用取消引用的这行代码上遇到错误：

```
 $data['data'] = $results->result()[0]; 
```

（我从 PHP 5.4 开始学习 PHP。）如何以 5.3 的方式取消引用？

我检查了文档：

```
function getArray() {
    return array(1, 2, 3);
}

// on PHP 5.4
$secondElement = getArray()[1];

// before PHP 5.4
$tmp = getArray();
$secondElement = $tmp[1];

// or
list(, $secondElement) = getArray(); 
```

但是创建方法调用似乎很麻烦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-24T01:03:21.137

list() 是你想要的。假设右边的值可以通过整数键访问，它一直存在并且工作得很好。

```
<?php
list(, $one, , $three) = range(0, 4); 
```

请注意， list() 不会迭代键（如 foreach 那样），而是通过槽位置 (0, 1, ...) 直接访问整数键。如果这些键不存在，您将收到一条通知并将您的值设置为 null。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T16:03:32.373

```
$res = $results->result();
$data['data'] = $res[0]; 
```

或者您可以使用重新分配（以避免需要临时变量）：

```
$data['data'] = $results->result();
$data['data'] = $data['data'][0]; 
```

# python - 如何防止在 Python matplotlib 图中将数字更改为指数形式

> ID：14711655
> 
> 赞同：78
> 
> 时间：2013-02-05T16:01:19.087
> 
> 标签：python, graph, matplotlib, figure

我在 Python 中使用 Matplotlib 来绘制简单的 xy 数据集。这会产生漂亮的图形，尽管当我使用图形视图（在您执行时出现）“放大”绘制图形的各个部分太近时`plt.show()`，x 轴值会从标准数字形式（1050、1060、 1070 等）转换为具有指数符号的科学形式（例如 1、1.5、2.0，x 轴标签为`+1.057e3`）。

我希望我的数字保留轴的简单编号，而不是使用指数形式。有没有办法可以强制 Matplotlib 这样做？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2013-02-05T16:11:56.040

刻度标签的格式由一个`Formatter`对象控制，假设您没有做任何花哨的事情`ScalerFormatter`[，默认情况下](http://matplotlib.org/api/ticker_api.html#matplotlib.ticker.ScalarFormatter)将是一个. 如果可见值的部分变化非常小，则此格式化程序将使用常量移位。为避免这种情况，只需将其关闭：

```
plt.plot(arange(0,100,10) + 1000, arange(0,100,10))
ax = plt.gca()
ax.get_xaxis().get_major_formatter().set_useOffset(False)
plt.draw() 
```

如果你想避免一般的科学记数法，

```
ax.get_xaxis().get_major_formatter().set_scientific(False) 
```

可以通过`axes.formatter.useoffset`rcparam 全局控制它。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2017-05-05T12:15:07.643

您可以使用更简单的命令将其关闭：

```
plt.ticklabel_format(useOffset=False) 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2015-03-04T05:24:43.053

你可以使用类似的东西：

```
from matplotlib.ticker import ScalarFormatter, FormatStrFormatter

ax.xaxis.set_major_formatter(FormatStrFormatter('%.0f')) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-09-11T16:24:58.303

使用以下命令： `ax.ticklabel_format(useOffset=False, style='plain')`

如果您使用的是子图，您可能会遇到类似下面`AttributeError: This method only works with the ScalarFormatter`添加的情况。`axis='y'`您可以将“y”更改为有问题的轴。

```
ax1.ticklabel_format(useOffset=False, style='plain', axis='y') 
```

来源问题和答案[在这里](https://stackoverflow.com/questions/28371674/prevent-scientific-notation-in-matplotlib-pyplot)。请注意，`axis 'y'`命令使用隐藏在答案注释中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-05-06T17:38:33.783

我在图表之前使用了下面的代码，它对我来说是无缝的..

```
plt.ticklabel_format(style='plain') 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-11T22:51:56.887

确切地说，我不希望在放大时显示科学数字，以下也适用于我的情况。我在科学形式没有意义的标签中使用纬度/经度。

```
plt.ticklabel_format(useOffset=False) 
```

# ruby-on-rails - 无法访问由回形针创建的文件

> ID：14711657
> 
> 赞同：0
> 
> 时间：2013-02-05T16:01:25.687
> 
> 标签：ruby-on-rails, ruby

不知道这是怎么回事：

```
file = Rails.root.join(Attachment.last.attachment.url(:original))
# => "/system/attachments/3/original/!my_awesome_pdf.pdf?1359735260" 
```

然后我尝试这样做：

```
File.new(file, 'rb')
# => No such file or directory - /system/attachments/3/original/!my_awesome_pdf.pdf?1359735260 
```

为什么会这样？我正在尝试能够选择要上传到 GroupDocs.com 的文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:38:18.933

啊，问题是 URI 会使 Ruby 无法识别文件名。删除 URI 允许 Ruby 打开文件。

# c# - 是否可以使用 OpenXml 将 RTF 文本片段插入 Word 文档 (.docx)？

> ID：14711659
> 
> 赞同：4
> 
> 时间：2013-02-05T16:01:28.967
> 
> 标签：c#, .net, ms-word, openxml

我正在开发一个 .NET C# 应用程序，它需要创建一个 Word 文档，插入存储在数据库中的 RTF 文本片段。有谁知道这是否可能以及如何使用 OpenXml（或 COM 互操作）来完成？

我不需要将一个完整的 RTF 文件转换为 Word 文档。我需要使用 C# 以编程方式创建 Word 文档并在 Word 文档的不同位置添加 RTF 文本。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T19:25:15.403

*您可以通过altChunk*锚点导入外部内容。altChunk锚点在 word 文档*中*定义了一个位置，用于插入外部内容，例如 RTF、HTML、XML...

有关*altChunk*锚点的更多信息，请参阅以下[MSDN](http://msdn.microsoft.com/en-us/library/documentformat.openxml.wordprocessing.altchunk%28v=office.15%29.aspx)文章。

以下代码展示了如何使用 OpenXML SDK 将一块 RTF 插入到 word 文档中：

1.  打开你的word文档。
2.  创建`AlternativeFormatImportPart`具有唯一块 ID 的块。
3.  将您的 RTF 数据输入到块中（我在`MemoryStream`这里使用）。
4.  创建一个`AltChunk`具有相同 ID 的用于创建`AlternativeFormatImportPart`.
5.  保存word文档。

.

```
static void Main(string[] args)
{
  using (WordprocessingDocument doc = WordprocessingDocument.Open(@"test.docx", true))
  {
    string altChunkId = "AltChunkId5";

    MainDocumentPart mainDocPart = doc.MainDocumentPart;
    AlternativeFormatImportPart chunk = mainDocPart.AddAlternativeFormatImportPart(
        AlternativeFormatImportPartType.Rtf, altChunkId);                

    string rtfEncodedString = @"{\rtf1\ansi{\fonttbl\f0\fswiss Helvetica;}\f0\pard This is some {\b bold} text.\par}";

    using (MemoryStream ms = new MemoryStream(Encoding.ASCII.GetBytes(val)))
    {
      chunk.FeedData(ms);
    }

    AltChunk altChunk = new AltChunk();
    altChunk.Id = altChunkId;

    mainDocPart.Document.Body.InsertAfter(
      altChunk, mainDocPart.Document.Body.Elements<Paragraph>().Last());

    mainDocPart.Document.Save();

  }
} 
```

# jquery - jQuery 的 .width() 结果在 Chrome 25 中是错误的，我如何获得真正的结果？

> ID：14711660
> 
> 赞同：1
> 
> 时间：2013-02-05T16:01:29.870
> 
> 标签：jquery, css, google-chrome, firefox

当屏幕不够大时，我有一个带有滚动条的表格。但我仍然需要知道*实际*内容有多广泛。

我曾经能够做到：

```
$('table').width() 
```

这将为我提供带有滚动条的表格内容的完整宽度。它**仍然**在 Firefox、Chrome 24、...

但在 Chrome 25 中，它只给了我所能看到的宽度。

这是一个示例设置。在 Firefox 和 Chrome 25 中打开控制台（或自己尝试 $('table').width()）：

[http://public.kipdola.be/chrome-25-jquery-test.html](http://public.kipdola.be/chrome-25-jquery-test.html)

（顺便说一句，我也尝试过 get `$('table tr').width()`，但这会产生相同的结果。）

那么：哪一个是对的？Firefox 适合提供内容的实际大小，还是 Chrome 适合提供我在屏幕上可以看到的大小？

而且，更重要的是，我如何获得表格内容的完整大小？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:14:32.787

从您的表中删除`width: 100%`and而是添加。`max-width: 100%``min-width: 100%`

# sql - 如何使用 SUM 根据查询结果获取查询详细信息

> ID：14711661
> 
> 赞同：2
> 
> 时间：2013-02-05T16:01:30.553
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有一个查询，可以在一天内检查数据库中的多个客户条形码扫描。该报告效果很好，但是我想在其中添加另一篇文章。我想在输出中包含一列“扫描次数”。但是，由于我使用的是“SUM”，它不会在 1 行上多次列出。例如，如果发现条形码“1234”被扫描两次，我希望它被扫描的次数（tickets.dtcreated）作为一个输出列在“扫描次数”列中。

这是我当前的输出：

```
Barcode    DtCreatedDate     Number of Scans   
    1234          1/1/2013            2            
    1235          1/1/2013            2            
    1563          1/2/2013            3 
```

这是我希望我的输出看起来像的样子（请记住，“扫描时间”应该只显示发生多次扫描的当天的时间（DTcreateddate）：

```
Barcode    DtCreatedDate     Number of Scans   Times Scanned
1234          1/1/2013            2            11:15AM, 12:15PM
1235          1/1/2013            2            9:00AM, 4:00PM
1563          1/2/2013            3            8:05AM, 8:08AM, 5:50PM 
```

我当前的查询如下

```
 SELECT        Customers.sBarcode, CAST(FLOOR(CAST(Tickets.dtCreated AS FLOAT)) AS DATETIME) AS dtCreatedDate, COUNT(Customers.sBarcode) AS [Number of Scans]
FROM            Tickets INNER JOIN
                         Customers ON Tickets.lCustomerID = Customers.lCustomerID
WHERE        (Tickets.dtCreated BETWEEN @startdate AND @enddate) AND (Tickets.dblTotal <= 0)
GROUP BY Customers.sBarcode, CAST(FLOOR(CAST(Tickets.dtCreated AS FLOAT)) AS DATETIME)
HAVING        (COUNT(*) > 1)
ORDER BY dtCreatedDate 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:19:32.747

您不能`SUM`为此使用，但可以使用`FOR XML PATH`. 将此添加到您的 SELECT 列表中：

```
SELECT ...,
       STUFF((    SELECT ', ' + RIGHT(convert(varchar, sub.dtCreated, 100), 7)
                    FROM Tickets sub
                    WHERE sub.Ticket_ID = Tickets.Ticket_ID
                    FOR XML PATH('')
                    ), 1, 2, '' )
       AS [Times Scanned]
FROM Tickets
JOIN ... 
```

这里的想法是用来`RIGHT(convert(varchar, sub.dtCreated, 100), 7)`获取格式化的时间，然后使用 连接它们`FOR XML PATH`，同时删除前导逗号`STUFF`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:13:25.730

我建议编写一个函数来创建调用时间列表，然后在查询中调用该函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T23:26:29.440

```
SELECT Customers.sBarcode, @startdate AS startdate, @enddate AS enddate, 
       CAST(FLOOR(CAST(Tickets.dtCreated AS FLOAT)) AS DATETIME) AS dtCreatedDate, 
       COUNT(Customers.sBarcode) AS [Number of Scans], 
       [Times Scanned] = MAX(STUFF((SELECT ',' + RIGHT(CONVERT(varchar, sub.dtCreated, 100), 7)
                                    FROM Tickets AS sub
                                    WHERE sub.Ticket_id = Tickets.Ticket_ID
                                    FOR XML PATH, TYPE).value('.[1]', 'nvarchar(max)'), 1, 1, ''))
FROM Tickets INNER JOIN Customers ON Tickets.lCustomerID = Customers.lCustomerID
WHERE(Tickets.dtCreated BETWEEN @startdate AND @enddate) AND (Tickets.dblTotal <= 0)
GROUP BY Customers.sBarcode, CAST(FLOOR(CAST(Tickets.dtCreated AS FLOAT)) AS DATETIME), Tickets.Ticket_ID
HAVING (COUNT(*) > 1)
ORDER BY dtCreatedDate 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-28T16:12:22.940

如果您使用的是 Oracle（并且它是最近的版本），您可以使用 LISTAGG() 函数

```
LISTAGG(TimesScanned, ', ') WITHIN GROUP (ORDER BY TimesScanned) 
```

其他数据库有时为此具有聚合函数；看到这个问题：[Concatenate many rows into a single text string？](https://stackoverflow.com/questions/194852/concatenate-many-rows-into-a-single-text-string/16526394)

# node.js - Node.js 中的一些混乱

> ID：14711663
> 
> 赞同：1
> 
> 时间：2013-02-05T16:01:36.097
> 
> 标签：node.js

我对 Node.js 技术有一个基本的困惑。让我用这个小例子来解释。

我有这段代码

```
setTimeout(function (){
    console.log('world');
}, 2000);

console.log('hello'); 
```

当我开始执行此代码时，它会立即打印“hello”，并在 2 秒后打印“world”。

现在我只想知道，如果说 node.js 是单线程框架，那么这个 setTimeout 函数在哪个上下文或在哪里（线程/进程）执行，因为唯一的单线程正在执行剩余的代码（打印世界） .

在像 DB hit 这样的 I/O 调用的情况下，node.js 使用 Libeio，而后者又在内部使用线程。所以它根本不是单线程的。

我对吗？？

请建议。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:39:46.980

Node.js 确实在*内部*使用了线程。当他们说它是“单线程”时，他们的意思是 javascript 仅在其中一个内部线程中运行。

该线程运行一个事件循环，可以总结为：

```
while true
    foreach events as event
         call event js callback
    endforeach
endwhile 
```

您的`setTimeout`函数在事件循环中创建一个计时器，触发它稍后调用您的回调。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T18:02:12.000

计时器在同一线程中执行，在“javascript 单线程”中：[Understanding javascript timers](http://javascriptweblog.wordpress.com/2010/06/28/understanding-javascript-timers/)。

文件系统调用发生在 C/C++ 级别。在内部 nodejs 使用线程池。[libuv](http://nikhilm.github.com/uvbook/threads.html)库提供了该功能，因此提供了 C/C++ 级别的异步调用。然后，node.js 向“javascript 单线程”公开一个公共 api。

# wordpress - 使用 nginx 将子域映射到 URL

> ID：14711666
> 
> 赞同：5
> 
> 时间：2013-02-05T16:01:50.917
> 
> 标签：wordpress, nginx, rewrite, subdomain

我对 nginx 很陌生，所以如果我的解释不对，请原谅我。我会尽力解释我想要达到的目标。

使用 WordPress 和 nginx，我希望将用户帐户映射到主域的子域。例如，如果用户创建了一个名为“sample”的帐户，则该用户的子域将是`sample.example.com`.

当用户去的时候`sample.example.com`，子域应该被映射到`example.com/sample/`。同样，如果用户访问`sample.example.com/account/`，它应该映射到`example.com/sample/account/`，依此类推。应该注意的是，这些`example.com/sample/`URL 是对这种结构的重写：`example.com/index.php?user=sample`.

还有一些保留的子域不**应该被重定向**，例如 cdn 和 admin。如果需要，这些规则应忽略它们。

当用户创建帐户时，如何自动实现这一点？这里的目标是自动化——正确设置一次，不用担心。由于我几天前才刚刚开始使用 nginx，所以我完全不知道从哪里开始。任何能让我朝着正确方向前进的建议都会非常有帮助。这是我当前的域配置文件：

```
server {
    listen          80;
    server_name     www.example.com;
    rewrite     ^(.*) $scheme://example.com$1 permanent;
}

server {
    listen          443 ssl;
    server_name     www.example.com;
    rewrite         ^(.*) $scheme://example.com$1 permanent;
}

server {
    listen      80;
    server_name example.com;

    access_log  /var/www/example.com/logs/access.log;
    error_log   /var/www/example.com/logs/error.log;

    root        /var/www/example.com/public;
    index       index.php;

    location / {
        try_files $uri $uri/ @wordpress /index.php?q=$request_uri;
    }

    location @wordpress {
        fastcgi_pass unix:/var/run/php5-fpm.sock;
        fastcgi_param SCRIPT_FILENAME /var/www/example.com/public/index.php;
        include /etc/nginx/fastcgi_params;
        fastcgi_param SCRIPT_NAME /index.php;
    }

    # Pass the PHP scripts to FastCGI server listening on UNIX sockets.
    #
    location ~ \.php$ {
        try_files $uri @wordpress;
        fastcgi_pass   unix:/var/run/php5-fpm.sock;
        fastcgi_index  index.php;
        fastcgi_param  SCRIPT_FILENAME  /var/www/example.com/public$fastcgi_script_name;
        include        fastcgi_params;
    }
}

server {
    listen                      443 ssl;
    ssl                         on;
    keepalive_timeout           70;
    server_name                 example.com;
    ssl_certificate             ssl/example.com.chained.crt;
    ssl_certificate_key         ssl/example.key;
    ssl_protocols               SSLv3 TLSv1 TLSv1.1 TLSv1.2;
    ssl_ciphers                 HIGH:!aNULL:!MD5;
    ssl_session_cache           shared:SSL:10m;
    ssl_session_timeout         10m;
    ssl_prefer_server_ciphers   on;

    root        /var/www/example.com/public;
    index       index.php;

    location / {
        try_files $uri $uri/ @wordpress /index.php?q=$request_uri;
    }

    location @wordpress {
        fastcgi_pass unix:/var/run/php5-fpm.sock;
        fastcgi_param SCRIPT_FILENAME /var/www/example.com/public/index.php;
        include /etc/nginx/fastcgi_params;
        fastcgi_param SCRIPT_NAME /index.php;
    }

    # Pass the PHP scripts to FastCGI server listening on UNIX sockets.
    #
    location ~ \.php$ {
        try_files $uri @wordpress;
        fastcgi_pass   unix:/var/run/php5-fpm.sock;
        fastcgi_index  index.php;
        fastcgi_param  SCRIPT_FILENAME  /var/www/example.com/public$fastcgi_script_name;
        include        fastcgi_params;
    }
} 
```

我知道我想要实现的目标可能需要进入`/etc/nginx/nginx.conf`文件，如果我希望它是自动化的，我正在积极尝试学习如何实现这一点。我只是被困在现在的位置，正在寻找任何可以为我指明正确方向的建议/帮助。我渴望学习！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T19:14:03.453

**回答**

经过几天的搜索、调整和配置，我已经得到了将子域映射到 URL 所需的代码，就像在我的示例中一样。这是 example.com 的我的虚拟主机：[https ://gist.github.com/thomasgriffin/4733283](https://gist.github.com/thomasgriffin/4733283)

```
server {
    listen      80;
    listen      443 ssl;
    server_name ~^(?<user>[a-zA-Z0-9-]+)\.example\.com$;

    location / {
        resolver            8.8.8.8;
        rewrite             ^([^.]*[^/])$ $1/ permanent;
        proxy_pass_header   Set-Cookie;
        proxy_pass          $scheme://example.com/user/$user$request_uri;
    }
}

server {
    listen          80;
    listen          443 ssl;
    server_name     www.example.com;
    return          301 $scheme://example.com$request_uri;
}

server {
    listen      80;
    server_name example.com;

    access_log  /var/www/example.com/logs/access.log;
    error_log   /var/www/example.com/logs/error.log;

    root        /var/www/example.com/public;
    index       index.php;

    location / {
        try_files $uri $uri/ @wordpress /index.php?q=$request_uri;
    }

    location @wordpress {
        fastcgi_pass unix:/var/run/php5-fpm.sock;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include /etc/nginx/fastcgi_params;
        fastcgi_param SCRIPT_NAME /index.php;
    }

    # Pass the PHP scripts to FastCGI server listening on UNIX sockets.
    #
    location ~ \.php$ {
        try_files $uri @wordpress;
        fastcgi_pass   unix:/var/run/php5-fpm.sock;
        fastcgi_index  index.php;
        fastcgi_param  SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include        fastcgi_params;
    }
}

server {
    listen                      443 ssl;
    ssl                         on;
    keepalive_timeout           70;
    server_name                 example.com;
    ssl_certificate             ssl/example.com.chained.crt;
    ssl_certificate_key         ssl/example.key;
    ssl_protocols               SSLv3 TLSv1 TLSv1.1 TLSv1.2;
    ssl_ciphers                 HIGH:!aNULL:!MD5;
    ssl_session_cache           shared:SSL:10m;
    ssl_session_timeout         10m;
    ssl_prefer_server_ciphers   on;

    root        /var/www/example.com/public;
    index       index.php;

    location / {
        try_files $uri $uri/ @wordpress /index.php?q=$request_uri;
    }

    location @wordpress {
        fastcgi_pass unix:/var/run/php5-fpm.sock;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include /etc/nginx/fastcgi_params;
        fastcgi_param SCRIPT_NAME /index.php;
    }

    # Pass the PHP scripts to FastCGI server listening on UNIX sockets.
    #
    location ~ \.php$ {
        try_files $uri @wordpress;
        fastcgi_pass   unix:/var/run/php5-fpm.sock;
        fastcgi_index  index.php;
        fastcgi_param  SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include        fastcgi_params;
    }
} 
```

映射的主要块在第一个服务器块中完成。我的目标是任何子域（我已经用其他不相关的代码清除了受限制的子域）并重写它以确保它有一个尾部斜杠，以避免 WordPress 对没有尾部斜杠的 URL 进行任何内部重定向。从那里，需要该`resolver`指令来解析中定义的 URL `proxy_pass`，因此我使用 Google 的 DNS 进行解析。我还使用该`proxy_pass_header`指令通过 cookie 发送，以保持 WordPress 登录身份验证的完整性。`proxy_pass`定义要映射到的 URL。

还应该注意的是，如果您想对子域也使用登录身份验证，您需要`wp-config.php`像这样定义您的自定义 cookie 域：

```
define('COOKIE_DOMAIN', '.example.com'); 
```

应该就是这样。您现在可以享受`subdomain.example.com`该映射到的URL`example.com/user/subdomain/`或您想要的任何内容。从那里，您可以利用 WordPress 的 Rewrite API 将映射的 URL 映射到特定的查询参数，这些参数可以发送到`$wp_query`加载自定义模板等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T20:46:16.120

以下应该做到这一点：

```
server {
  listen 80; listen 443;
  server_name *.example.com;

  if ($host ~ "^(.*)\.example\.com$" ) { set $subdomain $1;}
  rewrite ^ $scheme://example.com/$subdomain/$request_uri permanent;
} 
```

（顺便说一句：正则表达式`^`匹配所有 url 的效率最高，标准 nginx 变量`$request_uri`保存 uri 包括参数，因此您不需要`(.*)`重写中的组）

另外为您不想重定向的域添加第二个服务器块：

```
server {
  listen 80; listen 443;
  server_name cdn.example.com admin.example.com;
  # do whatever with the requests of the reserved subdomains;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T08:17:42.023

我认为 .htaccess 不适用于 nginx。[我在这里](http://www.cyberciti.biz/tips/using-nginx-as-reverse-proxy.html)使用 Nginx 作为反向代理服务器端口 80 和 Apache 作为 Web 服务器

# ios - 在异步操作后设置 CoreData 字段（但不是其他字段）时的 EXC_BAD_ACCESS

> ID：14711667
> 
> 赞同：0
> 
> 时间：2013-02-05T16:01:56.813
> 
> 标签：ios, objective-c, core-data, asynchronous, automatic-ref-counting

我有一个`UserService`包含以下方法的单例。我`book.downloaded`在进度回调中设置的行上收到了 EXC_BAD_ACCESS。

我希望服务继续下载和更新图书对象*，即使用户退出他们所在的视图*（当前是表格的详细视图）。如果我保持详细视图打开，这一切都很好，但是当我回到父表视图时，我得到了错误的访问权限。

我的第一个想法是`book`ARC 正在发布它，但这并不成立。您可以设置其他属性，甚至读取 的当前值`book.downloaded`，但在您尝试设置它的那一刻。繁荣。

`Book`是 mogenerator 生成的 CoreData 类，如果重要的话。

```
// UserService is a singleton. 
// Only errors if I back out of the detail view to the parent table view.
-(void)addBook:(Book *)book downloadProgress:(void (^)(Book *))progressCb downloadComplete:(void (^)(Book *))cb {
    book.purchasedValue = YES;
    book.downloadedValue = 0.0;

    // making my UserService own the book with a strong reference doesn't help
    self.strongBookProperty = book;

    [FileService.shared
        downloadFiles:[FileService.shared byBookId:book.bookId]
        progress:^(float percent) {
            book.title = @"fake title"; // no error!
            NSLog(@"old downloaded %@", book.downloaded); // no error!
            book.downloaded = [NSNumber numberWithFloat:percent]; // EXC_BAD_ACCESS
            progressCb(book);
        }
        complete:^() {
            book.downloaded = [NSNumber numberWithFloat:1.0];
            cb(book);
        }
    ];
} 
```

* * *

**更新**`book.downloaded`我在详细信息视图中进行键值观察，这将启动此操作。如果我注释掉键值观察，它不会出错。为什么？（显然这使我的观点没有更新）。这解释了为什么只有那个属性会抛出错误（它是唯一一个被观察到的键值）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:29:49.377

`dealloc`我并没有在我的详细信息视图中删除我的键值观察者。以下摆脱了错误。（在详细信息视图中）

```
-(void)dealloc {
    [self.book removeObserver:self forKeyPath:@"downloaded"];
    [self.book removeObserver:self forKeyPath:@"purchased"];
} 
```

我以为 ARC 会为我解决这个问题，但我觉得它不知道怎么做是有道理的。我也不太明白这将如何导致我得到它的线路上的访问不正确。似乎它会在解除分配的观察者中提供错误的访问权限。

# image-processing - 使用 CUDA 并行处理将彩色图像转换为灰度图像

> ID：14711668
> 
> 赞同：6
> 
> 时间：2013-02-05T16:01:59.867
> 
> 标签：image-processing, cuda, parallel-processing, gpu

我正在尝试解决我应该将彩色图像更改为灰度图像的问题。为此，我正在使用 CUDA 并行方法。

我在 GPU 上调用的内核代码如下。

```
__global__
void rgba_to_greyscale(const uchar4* const rgbaImage,
                   unsigned char* const greyImage,
                   int numRows, int numCols)
{
    int absolute_image_position_x = blockIdx.x;  
    int absolute_image_position_y = blockIdx.y;

  if ( absolute_image_position_x >= numCols ||
   absolute_image_position_y >= numRows )
 {
     return;
 }
uchar4 rgba = rgbaImage[absolute_image_position_x + absolute_image_position_y];
float channelSum = .299f * rgba.x + .587f * rgba.y + .114f * rgba.z;
greyImage[absolute_image_position_x + absolute_image_position_y] = channelSum;

}

void your_rgba_to_greyscale(const uchar4 * const h_rgbaImage,
                            uchar4 * const d_rgbaImage,
                            unsigned char* const d_greyImage,
                            size_t numRows,
                            size_t numCols)
{
  //You must fill in the correct sizes for the blockSize and gridSize
  //currently only one block with one thread is being launched
  const dim3 blockSize(numCols/32, numCols/32 , 1);  //TODO
  const dim3 gridSize(numRows/12, numRows/12 , 1);  //TODO
  rgba_to_greyscale<<<gridSize, blockSize>>>(d_rgbaImage,
                                             d_greyImage,
                                             numRows,
                                             numCols);

  cudaDeviceSynchronize(); checkCudaErrors(cudaGetLastError());
} 
```

我在第一个像素行中看到一行点。

我得到的错误是

libdc1394 错误：无法初始化 libdc1394
位置 51 的差异超出容差 5
参考：255
GPU：0
[我的输入/输出图像](https://docs.google.com/folder/d/0B_4HoenewpKDdFh6R19XOVBrNkU/edit?usp=sharing) 谁能帮我解决这个问题？提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-10-17T14:46:32.383

我最近参加了这门课程并尝试了您的解决方案，但它不起作用，我尝试了自己的解决方案。你几乎是正确的。正确的解决方案是这样的：

```
__global__`
void rgba_to_greyscale(const uchar4* const rgbaImage,
               unsigned char* const greyImage,
               int numRows, int numCols)
{`

int pos_x = (blockIdx.x * blockDim.x) + threadIdx.x;
int pos_y = (blockIdx.y * blockDim.y) + threadIdx.y;
if(pos_x >= numCols || pos_y >= numRows)
    return;

uchar4 rgba = rgbaImage[pos_x + pos_y * numCols];
greyImage[pos_x + pos_y * numCols] = (.299f * rgba.x + .587f * rgba.y + .114f * rgba.z); 

} 
```

其余的与您的代码相同。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-06T04:03:33.283

现在，自从我发布了这个问题以来，我一直在不断地解决
这个问题，现在我意识到我最初的解决方案是错误的，应该做一些改进来解决这个问题。
要做的改变：-

```
 1\. absolute_position_x =(blockIdx.x * blockDim.x) + threadIdx.x;
 2\. absolute_position_y = (blockIdx.y * blockDim.y) + threadIdx.y; 
```

第二，

```
 1\. const dim3 blockSize(24, 24, 1);
 2\. const dim3 gridSize((numCols/16), (numRows/16) , 1); 
```

在解决方案中，我们使用 numCols/16 * numCols/16 的网格
和 24 * 24 的块大小

代码在 0.040576 毫秒内执行

@datenwolf：感谢您在上面的回答！！！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-09-06T19:26:55.550

由于您不知道图像大小。最好选择二维线程块的任何合理尺寸，然后检查两个条件。第一个是内核中的`pos_x`和`pos_y`索引不超过`numRows`和`numCols`。其次，网格大小应该略高于所有块中的线程总数。

```
const dim3 blockSize(16, 16, 1);
const dim3 gridSize((numCols%16) ? numCols/16+1 : numCols/16,
(numRows%16) ? numRows/16+1 : numRows/16, 1); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-10T07:15:14.180

```
__global__
void rgba_to_greyscale(const uchar4* const rgbaImage,
                       unsigned char* const greyImage,
                       int numRows, int numCols)
{
    int rgba_x = blockIdx.x * blockDim.x + threadIdx.x;
    int rgba_y = blockIdx.y * blockDim.y + threadIdx.y;
    int pixel_pos = rgba_x+rgba_y*numCols;

    uchar4 rgba = rgbaImage[pixel_pos];
    unsigned char gray = (unsigned char)(0.299f * rgba.x + 0.587f * rgba.y + 0.114f * rgba.z);
    greyImage[pixel_pos] = gray;
}

void your_rgba_to_greyscale(const uchar4 * const h_rgbaImage, uchar4 * const d_rgbaImage,
                            unsigned char* const d_greyImage, size_t numRows, size_t numCols)
{
    //You must fill in the correct sizes for the blockSize and gridSize
    //currently only one block with one thread is being launched
    const dim3 blockSize(24, 24, 1);  //TODO
    const dim3 gridSize( numCols/24+1, numRows/24+1, 1);  //TODO
    rgba_to_greyscale<<<gridSize, blockSize>>>(d_rgbaImage, d_greyImage, numRows, numCols);

    cudaDeviceSynchronize(); checkCudaErrors(cudaGetLastError());
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-05T16:07:41.727

> libdc1394 错误：无法初始化 libdc1394

我不认为这是一个 CUDA 问题。libdc1394 是一个用于访问 IEEE1394 aka FireWire aka iLink 视频设备（DV 摄像机、Apple iSight 摄像头）的库。该库没有正确初始化，因此您没有得到有用的结果。基本上它是 NINO: Nonsens In Nonsens Out。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-05-30T04:58:09.967

绝对 x 和 y 图像位置的计算是完美的。但是当您需要访问彩色图像中的特定像素时，您不应该使用以下代码吗？

```
uchar4 rgba = rgbaImage[absolute_image_position_x + (absolute_image_position_y * numCols)]; 
```

我是这么认为的，当将它与您编写的代码进行比较时，您可以在串行代码中执行相同的问题。请告诉我 ：）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-10-14T06:50:04.707

您仍然应该在运行时遇到问题 - 转换不会给出正确的结果。

这些行：

1.  uchar4 rgba = rgbaImage[absolute_image_position_x + absolute_image_position_y];
2.  grayImage[absolute_image_position_x + absolute_image_position_y] = channelSum;

应改为：

1.  uchar4 rgba = rgbaImage[absolute_image_position_x + absolute_image_position_y*numCols];
2.  grayImage[absolute_image_position_x + absolute_image_position_y*numCols] = channelSum;

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-07-12T05:17:10.173

在这种情况下，libdc1394 错误与火线等无关 - 它是 udacity 用于将程序创建的图像与参考图像进行比较的库。也就是说，对于该位置，您的图像和参考图像之间的差异已超过特定阈值，即。像素。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-06T00:20:54.260

您正在运行以下数量的块和网格：

```
 const dim3 blockSize(numCols/32, numCols/32 , 1);  //TODO
  const dim3 gridSize(numRows/12, numRows/12 , 1);  //TODO 
```

但是您没有在内核代码中使用任何线程！

```
 int absolute_image_position_x = blockIdx.x;  
 int absolute_image_position_y = blockIdx.y; 
```

这样想，图像的宽度可以分为`absolute_image_position_x`列的部分，图像的高度可以分为`absolute_image_position_y`行的部分。现在，它创建的每个横截面的框都需要以 grayImage 的形式并行更改/重绘所有像素。一个任务的剧透就够了：）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-06-25T22:39:59.737

具有处理非标准输入尺寸图像的相同代码

```
int idx=blockDim.x*blockIdx.x+threadIdx.x;
int idy=blockDim.y*blockIdx.y+threadIdx.y;

uchar4 rgbcell=rgbaImage[idx*numCols+idy];

   greyImage[idx*numCols+idy]=0.299*rgbcell.x+0.587*rgbcell.y+0.114*rgbcell.z;

  }

  void your_rgba_to_greyscale(const uchar4 * const h_rgbaImage, uchar4 * const d_rgbaImage,
                        unsigned char* const d_greyImage, size_t numRows, size_t numCols)
 {
 //You must fill in the correct sizes for the blockSize and gridSize
 //currently only one block with one thread is being launched

int totalpixels=numRows*numCols;
int factors[]={2,4,8,16,24,32};
vector<int> numbers(factors,factors+sizeof(factors)/sizeof(int));
int factor=1;

   while(!numbers.empty())
  {
 if(totalpixels%numbers.back()==0)
 {
     factor=numbers.back();
     break;
 }
   else
   {
  numbers.pop_back();
   }
 }

 const dim3 blockSize(factor, factor, 1);  //TODO
 const dim3 gridSize(numRows/factor+1, numCols/factor+1,1);  //TODO
 rgba_to_greyscale<<<gridSize, blockSize>>>(d_rgbaImage, d_greyImage,    numRows, numCols); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-02-09T15:34:04.323

1-`int x =(blockIdx.x * blockDim.x) + threadIdx.x;`

2-`int y = (blockIdx.y * blockDim.y) + threadIdx.y;`

并在网格和块大小

1-`const dim3 blockSize(32, 32, 1);`

2-`const dim3 gridSize((numCols/32+1), (numRows/32+1) , 1);`

代码在 0.036992 毫秒内执行。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-07-19T03:30:43.777

```
const dim3 blockSize(16, 16, 1);  //TODO
const dim3 gridSize( (numRows+15)/16, (numCols+15)/16, 1);  //TODO

int x = blockIdx.x * blockDim.x + threadIdx.x;  
int y = blockIdx.y * blockDim.y + threadIdx.y;

uchar4 rgba = rgbaImage[y*numRows + x];
float channelSum = .299f * rgba.x + .587f * rgba.y + .114f * rgba.z;
greyImage[y*numRows + x] = channelSum; 
```

# python - 创建元组列表（以更优雅的方式）

> ID：14711669
> 
> 赞同：1
> 
> 时间：2013-02-05T16:02:02.057
> 
> 标签：python, python-3.x

我正在编写一个 python 脚本来读取一个由逗号分隔的三列组成的文件，为每行创建一个元组，并列出这些元组。使用以下脚本，我实现了我想要的；我只是想知道是否有比在单独的行中编写以下每个步骤更简单/更优雅的方法。

```
import sys
fin=open(sys.argv[1],'r') 

list  = []

for line1 in fin:
        line2 = line1[:-1]
        line3 = line2.split(',')
        line4 = tuple(line3)
        list.append(line4)
print(list) 
```

谢谢您的回答。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T16:03:53.527

使用列表推导：

```
lst = [tuple(line.rstrip().split(',')) for line in fin] 
```

（不要命名您的变量`list`；它会影响内置变量并可能导致意外错误）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T16:14:10.667

Python 随附电池！如果您需要读取 csv 文件，只需使用[csv 模块](http://docs.python.org/3/library/csv.html)：

```
import sys, csv

with open(sys.argv[1]) as f:
    lst = list(csv.reader(f)) 
```

请注意，这会创建一个列表列表，如果您出于某种原因想要元组，那么

```
with open(sys.argv[1]) as f:
    lst = [tuple(row) for row in csv.reader(f)] 
```

# blackberry - 如何在黑莓中的 HttpConnection 正文中传递数据

> ID：14711670
> 
> 赞同：0
> 
> 时间：2013-02-05T16:02:03.590
> 
> 标签：blackberry

实际上我想在 httpconnection 的主体中传递数据。

在黑莓中使用 apache httpclient 库，在我的项目中集成了 jar 文件，但在运行我的项目时出现编译错误。

请更新我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T18:31:13.493

我之前没有尝试在 BB 项目中使用 Apache HttpClient lib，因为我一时不认为它会起作用......简而言之，您需要代码与 J2ME 兼容，并且可以使用 RIM 工具链进行编译。然后我们进入其他问题......

首先，请注意黑莓中的网络并不像人们希望的那样简单。观看此视频了解背景理论：[BB 平台上的网络传输](http://supportforums.blackberry.com/t5/Java-Development/Networking-Transports-II/ta-p/446742?name=NetworkingTransportsII)

好的，那么对于一些代码（我假设您已经经历了获取 HttpConnection 的麻烦）：

```
byte [] bodyBytes = getBodyBytesFromSomewhere();
OutputStream out = httpConnection.openOutputStream();
out.write(bodyBytes);
out.flush();
out.close();//If you are done, which I'm guessing you are 
```

上面的代码当然很简单，完全忽略了网络IO过程中会出现的很多很多的错误。

我建议您也看看[这个 API](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/io/transport/package-summary.html)、[这个论坛条目](http://docs.blackberry.com/en/developers/deliverables/21128/Network_API_Overview_1251781_11.jsp)和[这个](http://docs.blackberry.com/en/developers/deliverables/21128/Network_communication_overview_1226079_11.jsp)。OS6.0 还引入了一个新的 HTTP 连接 API——现在找不到那个链接（对不起！）

# javascript - 单击按钮时水平JS页面滚动

> ID：14711671
> 
> 赞同：0
> 
> 时间：2013-02-05T16:02:03.943
> 
> 标签：javascript, html, scroll

[我正在寻找与http://mercertavern.com/](http://mercertavern.com/)上使用的导航功能几乎相同的导航功能，但没有滚动条本身。我只希望它在单击菜单项时滚动。有什么简单的代码吗？一切都是正确方向的线索，我们将不胜感激。谢谢！

# jquery - 改进代码以清除除数字之外的任何输入值

> ID：14711674
> 
> 赞同：1
> 
> 时间：2013-02-05T16:02:12.617
> 
> 标签：jquery, string, performance

我正在使用以下代码来清理其类包含的输入字段`.number`。我需要该值仅包含数字，不包含逗号、点或除数字之外的任何内容：

```
var numberEle = $(form).find('.number'); // check number fields
for(var i=0;i<numberEle.length;i++){
        var numValue = $(numberEle[i]).val()
        var numValue = numValue.replace(/\s/g,""); // removes spaces
        var numValue = numValue.replace(/\D/g,""); // leaves only numbers
        $(numberEle[i]).val(numValue);
} 
```

上面的代码工作正常，但由于几个原因，在我看来它没有正确编写，这意味着它可能更“更干净”和更简单，有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:05:26.830

这应该这样做：

```
$(form).find('.number').val(function() {
    return this.value.replace(/[\s\D]/g, '');
}); 
```

[http://jsfiddle.net/4hrqq/](http://jsfiddle.net/4hrqq/)

# mysql - MYSQL 条件

> ID：14711675
> 
> 赞同：0
> 
> 时间：2013-02-05T16:02:13.360
> 
> 标签：mysql

我有一个 mysql 表`category`，其字段 `events`为 varchar，其值如下所示：`11,29,32`.and this values referer to `event`table ID。（所以我可以说：我有几个表中的`event ID`表）`event``category`

所以我想从中`events`选择 `category`：

```
 SELECT *
FROM                      
event e, category c                                                    
where e.event_id in (c.events) 
```

但是当我手动输入值时，这并没有给出正确的结果：

```
 SELECT *
FROM                      
event e, category c                                                    
where e.event_id in (11,29,32) 
```

我希望这很清楚，

请提供任何帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T16:08:57.937

您的部分问题是您设置表格的方式。通常，您将有一个`events`,`category`然后是两者之间的连接表。您不应将数据存储在逗号分隔的列表中以进行查询。

如果你不能改变你的表结构，那么你可以使用 MySQL 函数`FIND_IN_SET()`：

```
SELECT *
FROM event e
INNER JOIN category c                                                    
  on find_in_set(e.event_id, c.events) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/d478f/2)

如果你可以改变你的表，那么结构应该是：

```
create table events
(
  event_id int not null auto_increment primary key,
  event_name varchar(50) not null
);

create table category
(
  cat_id int not null auto_increment primary key,
  cat_name varchar(50) not null
);

create table events_category
(
   event_id int not null,
   category_id int not null,
   PRIMARY KEY(event_id, category_id),
   constraint fk_event 
    foreign key (event_id) references events (event_id),
   constraint fk_category 
    foreign key (category_id) references category (cat_id)
); 
```

然后，当您查询将使用的数据时：

```
select *
from events e
left join events_category ec
  on e.event_id = ec.event_id
left join category c
  on ec.category_id = c.cat_id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T16:08:09.883

您可以使用[FIND_IN_SET](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_find-in-set)：

```
SELECT *
FROM event e INNER JOIN category c
     ON FIND_IN_SET(e.event_id, c.events) 
```

如果 FIND_IN_SET`e.event_id`中不存在，则返回 0 `c.events`，否则返回其位置。如果结果值大于 0，则连接将成功。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:06:01.887

看起来您正在尝试在类别和事件之间创建多对多关系。如果是这种情况，您确实需要重构您的设计以包含一个映射此关系的表。

```
category
--------
- id
- name

event
-----
- id
- name

category_to_event
-----------------
- id
- category_id
- event_id 
```

创建这种类型的结构将允许您执行您寻求的查询。

# mysql - 来自 Mysql 的 Scala 日期格式

> ID：14711676
> 
> 赞同：0
> 
> 时间：2013-02-05T16:02:23.903
> 
> 标签：mysql, scala, playframework-2.0

日期格式有问题，我有以下代码：

但是我在 Play 2.1-RC3 中得到 [IllegalArgumentException: Cannot format given Object as a Date]

```
def formatDate(indate: Date) : String = {
        val dateFormat = new java.text.SimpleDateFormat("yyyy/MM/dd HH:mm:ss")
        val datedate = dateFormat.format(indate)
        datedate
    }

    val fdate = Extrastuff.formatDate("2012-10-08 15:16:56.0") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:26:40.623

如果我理解正确，那么方法 formatDate 接受 Date 类型的对象（indate：Date），但您正试图将它与字符串一起使用。

# php - 在页面上多次用 HTML 替换短代码

> ID：14711678
> 
> 赞同：0
> 
> 时间：2013-02-05T16:02:31.783
> 
> 标签：php, regex, shortcode

我的客户希望能够将 PayPal 添加到购物车按钮放置在页面上的任何位置，并且可能在单个页面上有多个按钮。他将使用 [price MONKEY] 之类的短代码让 PaylPal 按钮替换该文本，并使用“monkey”的价格和描述。

因此，每次我们在页面上找到 [price] 短代码时，我都需要查询数据库以获取价值，然后将其插入到以下 PayPal 按钮代码中，并在页面上的该位置显示按钮。然后移动到下一个替换，如果有的话。

这是 PayPal 按钮代码：

```
<form target="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" value="_cart" name="cmd" /> 
<input type="hidden" value="me@mydomain.com" name="business" /> 
<input type="hidden" value="1" name="add" /> 
<input type="hidden" value="MONKEY" name="item_name" /> 
<input type="hidden" value="" name="item_number" /> 
<input type="hidden" value="17.00" name="amount" /> 
<input type="hidden" value="2" name="no_shipping" /> 
<input type="hidden" value="USD" name="currency_code" /> 
<input border="0" type="image" name="submit" src="https://www.paypal.com/en_US/i/btn/x-click-but22.gif" alt="Make payments with PayPal - it's fast, free and secure!" />
</form> 
```

我一直在尝试使用 preg_replace_callback() 函数来执行此操作，但是在插入按钮的所有 HTML 时遇到问题，然后在页面上查找更多短代码实例并替换它们。

感谢您对此的任何帮助！它在 Wordpress 中非常简单，所有这些代码都已经编写好了（但是在哪里？）——这是我从头开始创建的一个应用程序，现在需要一些改进。谢谢！

这是我的正则表达式：

```
 $pattern = '/\[price (.*?)\]/'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:17:03.440

您可以使用您的模式使用基本的 preg_replace 来完成此任务。像这样：

```
<?php

function myexamplefunction($html){
    $pattern = '/\[price (.*?)\]/';
    $replace = '<form target="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post">
        <input type="hidden" value="_cart" name="cmd" /> 
        <input type="hidden" value="me@mydomain.com" name="business" /> 
        <input type="hidden" value="1" name="add" /> 
        <input type="hidden" value="$1" name="item_name" /> 
        <input type="hidden" value="" name="item_number" /> 
        <input type="hidden" value="17.00" name="amount" /> 
        <input type="hidden" value="2" name="no_shipping" /> 
        <input type="hidden" value="USD" name="currency_code" /> 
        <input border="0" type="image" name="submit" src="https://www.paypal.com/en_US/i/btn/x-click-but22.gif" alt="Make payments with PayPal - it\'s fast, free and secure!" />
      </form>';
    return preg_replace($pattern,$replace,$html);
} 
```

# ruby-on-rails-3 - 使用组标题在 Rails 中进行分组

> ID：14711679
> 
> 赞同：0
> 
> 时间：2013-02-05T16:02:33.377
> 
> 标签：ruby-on-rails-3, collections, group-by

我想按标题的字母顺序对集合进行分组：

```
@projects = Project.find_all_by_user_id(current_user.id) 
```

该视图应包含按标题分组的项目列表，例如：

```
A
Andre's Project
Ananas

C
Chemnitz
Cleopatra

F
Find a new office

S
Super secret stuff 
```

但我不知道如何在rails中做到这一点。Rails 是否提供了执行此操作的功能，还是我需要编写自己的循环来查找标题等？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T12:05:21.330

不是 Rails，而是 Ruby 可以解决问题。在您看来：

```
<% @projects.group_by{ |project| project.name[0].downcase }.each do |letter, projects| %>
  <div id="letter-<%= letter %>" class="letter-group">
    <h2><%= letter.upcase %><h2>
    <% projects.each do |project| %>
      <p><%= link_to project.name, project %></p>
    <% end %>
  </div>
<% end %> 
```

`group_by`( [ruby​​-doc](http://www.ruby-doc.org/core-2.0/Enumerable.html#method-i-group_by) ) 返回一个哈希值，您可以轻松地循环使用字母作为键和相应项目的数组作为值。确保您的记录已经按项目名称排序：（在您的控制器中）

```
@projects = Project.order("name ASC").find_all_by_user_id(current_user.id) 
```

# matlab - 向量化 matlab 代码以映射两个数组中最接近的值

> ID：14711680
> 
> 赞同：0
> 
> 时间：2013-02-05T16:02:34.233
> 
> 标签：matlab, optimization, vectorization

我有两个时间戳列表，我正在尝试在它们之间创建一个使用 imu_ts 作为真实时间的映射，并尝试找到最接近它的 vicon_ts 值。输出是一个 3xd 矩阵，其中第一行是 imu_ts 索引，第三行是该索引处的 unix 时间，第二行是同一列中时间戳上方最接近 vicon_ts 值的索引。

到目前为止，这是我的代码，它可以工作，但它真的很慢。我不确定如何对其进行矢量化。

```
function tmap = sync_times(imu_ts, vicon_ts)

tstart = max(vicon_ts(1), imu_ts(1));
tstop = min(vicon_ts(end), imu_ts(end));

%trim imu data to 
tmap(1,:) = find(imu_ts >= tstart & imu_ts <= tstop);
tmap(3,:) = imu_ts(tmap(1,:));%Use imu_ts as ground truth

%Find nearest indecies in vicon data and map
vic_t = 1;
for i = 1:size(tmap,2)
    %
    while(vicon_ts(vic_t) < tmap(3,i))
        vic_t = vic_t + 1;
    end
    tmap(2,i) = vic_t;
end 
```

时间戳已经按升序排序，所以这本质上是一个 O(n) 操作，但因为它是循环的，所以运行缓慢。任何矢量化的方法来做同样的事情？

**编辑** 它的运行速度似乎比我预期的或第一次测量的要快，所以这不再是一个关键问题。但我很想看看这个问题是否有任何好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:37:07.350

我相信您当前的方法是合理的，我不会尝试进一步矢量化。当您尝试优化某些内部循环时，矢量化实际上可能是有害的，尤其是当您对数据的上下文了解得比 Mathworks 工程师了解的更多时（例如，它已排序）。

当我需要优化某些代码时，我通常会寻找的东西是：

1.  所有数组都是预先分配的（这是性能的最大驱动力）
2.  快速内部循环使用简单的代码（Matlab 在基本命令上执行非常有效的 JIT，但必须解释其他命令。）
3.  利用您拥有的任何特殊数据功能，例如使用排序适当的算法和某些循环的提前退出条件。

你已经在做这一切了。我建议不要改变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T16:21:22.530

看看MATLAB 中的[knnsearch](http://www.mathworks.com/help/stats/knnsearch.html)。使用城市街区距离，并附加一个约束，即数据点 in`vicon_ts`应小于其邻居 in `imu_ts`。如果不是，则采用下一个索引。这是必需的，因为 cityblock 需要绝对距离。另一种选择（也是首选）是编写您的自定义距离函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:18:11.567

一个好的开始可能是摆脱`while`，尝试类似：

```
for i = 1:size(tmap,2)
    C = max(0,tmap(3,:)-vicon_ts(i));
    tmap(2,i) = find(C==min(C));
end 
```

# facebook - 为什么图表返回不同的结果

> ID：14711682
> 
> 赞同：0
> 
> 时间：2013-02-05T16:02:35.107
> 
> 标签：facebook, facebook-graph-api

为什么[https://graph.facebook.com/http://www.clickconsult.com/](https://graph.facebook.com/http://www.clickconsult.com/)只返回一些共享，如[https://graph.facebook.com/http://www.central-health。 com](https://graph.facebook.com/http://www.central-health.com)返回有关网站的一系列信息？

# c# - 使用 mvc2010 从具有特定名称的 sql-server 下载文件

> ID：14711685
> 
> 赞同：1
> 
> 时间：2013-02-05T16:02:40.973
> 
> 标签：c#, sql-server, asp.net-mvc

我正在使用**mvc 2010 Express在****c#**中创建一个应用程序，并且在某些时候，用户可以上传文件并将其**打开/下载**到/从数据库中。 这是我存储文件的表：

 ****```
CREATE TABLE [dbo].[tClientsFiles](  
    [IdClient] [int] NOT NULL,  
    [IdFile] [int] IDENTITY(1,1) NOT NULL,  
    [Name] [varchar](256) NULL,  
    [Type] [varchar](256) NULL,  
    [Lenght] [money] NULL,  
    [Content] [varbinary](max) NULL,  
    [DateAdd] [datetime] NULL,  
    [UserAdd] [varchar](50) NULL) 
```

在 tClientsFiles.Name 中，我将文件的路径和名称存储为：，`uploadFile.FileName;`其中. 因此，例如，如果文件在并且它在用户的桌面中，它存储`uploadFile``HttpPostedFileBase``Test.txt``C:\Users\user\Desktop\test.txt`

然后，在查看/下载文件时，我有一个指向我的`ActionResult`链接`Controller`：

```
public ActionResult GetFile(int id)
    {
        var file = dre.tClientsFiles.First(m => m.IdFile == id);

        MemoryStream ms = new MemoryStream(file.Content, 0, 0, true, true);
        Response.ContentType = file.Type;
        Response.AddHeader("content-disposition", "attachment;filename=" + file.Name);
        Response.Buffer = true;
        Response.Clear();
        Response.OutputStream.Write(ms.GetBuffer(), 0, ms.GetBuffer().Length);
        Response.OutputStream.Flush();
        Response.End();
        return new FileStreamResult(Response.OutputStream, file.Type);
    } 
```

打开文件时，它用它的 "Name" 命名它`file.Name`，如下所示：`c_Users_user_Desktop_Test`.

My question is: is there a way (maybe modifying my `Response.AddHeader`) to **name it with just its "real name"?** (I mean, in our example: `Test`)
**Or** maybe a way to **store the Name in a different way** so that it just stores its "real name" instead of the name and its whole path?

Thanks a lot for your time!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:12:03.873

Try

```
Response.AddHeader("content-disposition", "attachment;filename=" + Path.GetFileName(file.Name)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T16:16:45.980

If you want the file name without the extension ie the .txt bit then

```
Response.AddHeader("content-disposition", "attachment;filename=" + Path.GetFileNameWithoutExtension(file.Name)); 
```

Path is in the System.IO namespace.****

# regex - 用 Lex 捕捉评论

> ID：14711686
> 
> 赞同：0
> 
> 时间：2013-02-05T16:02:44.787
> 
> 标签：regex, lex

我正在努力编写一个可以捕获各种评论甚至“未完成”评论错误的规则。

这是基于 Pascal 的语言。评论可以是以下形式：

`(* ...with any characters within... *)`

```
(*
 * separated onto multiple lines
 *) 
```

`(* they can contain "any" symbol, so -, +, :, ; , etc. should be ignored *)`

但我需要捕捉任何评论错误，例如：

`(* this comment has no closing r-parenthesis *`或者`(* this comment is missing an asterisk )`

到目前为止我有这个：

```
{%
int yylval;
vector<string> string_table;
int string_table_index = 0;
int yyline = 1, yycolumn = 1;
%}

delim   [ \t\n]
ws      {delim}+
letter  [a-zA-Z]
digit   [0-9]
id      {letter}({letter}|{digit})*
number  {digit}+
float   {digit}+(\.{digit}+)?(E[+\-]?{digit}+)?

%%
{ws}      {yycolumn += yyleng;}
"(*" {
    int c;
    yycolumn += yyleng;
    while ((c = yyinput()) != '*' && c != EOF) {
        c = yyinput(); /* read additional text */
        if (c == '*') {
            while ((c = yyinput()) == '*') {
                c = yyinput();
                if (c == ')') {
                    break; /* found the end */
                } else if (c == EOF) {
                    cout << "EOF in comment\n";
                    break;
                } else {
                    cout << "unended comment, line = "  
                    << yyline << ", column = "
                    << yycolumn-yyleng << "\n";
                }
            }
        }
    }
 } 
```

1.  它没有抓住最后一个括号（总是打印出来`RPARENtoken`！），

2.  它不会忽略注释中的所有字符（即：打印`MINUStoken`“-”）

3.  它无法捕获多行的评论。

4.  我不确定它是否正确捕获了未完成的评论错误。

    我想我很接近了……谁能看到我哪里出错了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T01:14:40.693

考虑使用[开始条件](http://westes.github.io/flex/manual/Start-Conditions.html)来避免在`(*`模式中编写所有额外的代码。我在下面写了一个简短的例子。

```
%x COMMENT
%%
"(*" { BEGIN(COMMENT); }
<COMMENT>{
    "*)" { BEGIN(INITIAL); }
    <<EOF>> { printf("EOF in comment\n"); }
    . {}
} 
```

基本上，当词法分析器找到注释的开头时，它就会进入`COMMENT`状态，并且只会检查`<COMMENT>`块内的规则。当它找到时`*)`，它会回到初始状态。请注意，如果您打算使用多个状态，最好使用`yy_push_state(COMMENT)`and`yy_pop_state(COMMENT)`而不是`BEGIN(STATENAME)`.

我不完全确定您的评论错误标准是什么（例如，它与在评论中遇到 EOF 有何不同），但这可能也可以扩展到处理这些情况。

# javascript - 如何在 css/html/javascript 中的文本上添加边框

> ID：14711690
> 
> 赞同：2
> 
> 时间：2013-02-05T16:02:59.977
> 
> 标签：javascript, html, css

我有一个问题，我想用 html、css 或 javascript 在我的文本上添加一个边框。边框的大小应为 10px。这可能吗？

所以它应该是这样的： ![在此处输入图像描述](../Images/62d62fc5558bac673d2c1ea1ed22930c.png)

希望你能帮忙，

问候克里斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T16:29:52.367

如前所述，您可以尝试使用`text-shadow`，但不建议这样做。我编辑了 Ankit 的解决方案，因为它看起来有别名：

[http://jsfiddle.net/ZnfED/1409/](http://jsfiddle.net/ZnfED/1409/)

```
text-shadow: 2px 0 black, -2px 0 black, 0 2px black, 0 -2px black, 1px 1px black, -1px -1px black, -1px 1px black, 1px -1px black; 
```

正如 Eric Brockman 所说，您可以使用[`text-stroke`](http://css-tricks.com/adding-stroke-to-web-text/)，但目前大多数浏览器**都不支持**。但它适用于带`-webkit-`前缀的浏览器。

这是一个示例小提琴：http: [//jsfiddle.net/ZnfED/1410/](http://jsfiddle.net/ZnfED/1410/)

```
 -webkit-text-fill-color: white;
   -webkit-text-stroke-width: 2px;
   -webkit-text-stroke-color: black; 
```

请注意，无论您的 CSS 中的顺序是什么，它`-webkit-text-fill-color`总是会覆盖。`color`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:08:11.737

尝试将此添加到您的样式表中：

```
h1 {
   color: black;
   -webkit-text-fill-color: white; /* Will override color (regardless of order) */
   -webkit-text-stroke-width: 1px;
   -webkit-text-stroke-color: black;
} 
```

在此处阅读有关此选项的更多信息：http: [//css-tricks.com/adding-stroke-to-web-text/](http://css-tricks.com/adding-stroke-to-web-text/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:25:07.500

你需要很多阴影，阴影数量越多效果越好

```
{
    font-size:80px;
    color: green;
   text-shadow: 0 0 4px black, 0 0 4px black, 0 0 4px black, 0 0 4px black, 0 0 4px black, 0 0 4px black, 0 0 4px black, 0 0 4px black, 0 0 4px black, 0 0 4px black, 0 0 4px black, 0 0 4px black, 0 0 4px black, 0 0 4px black, 0 0 4px black, 0 0 4px black, 0 0 4px black, 0 0 4px black;
} 
```

这是演示它的链接：http: [//jsfiddle.net/ZnfED/1408/](http://jsfiddle.net/ZnfED/1408/) 您可以通过使用 text-shadow 属性中的任何其他值来增加/减少阴影的宽度（我使用了 4px）

**注意：仅少数浏览器支持此功能**

我建议你使用 image 而不是这个，因为你不需要担心浏览器的兼容性

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T16:36:52.400

我建议您不要依赖实验性功能，而是创建一个看起来像您发布的图像的透明 .PNG 图像，创建一个`div`具有必要文本和宽度的图像，然后在 CSS 中设置`text-indent`属性。使用 background 属性`-9999px`将 PNG 图像设置为背景。`div`您将成功使用该`-9999px`hack。

请参阅此处： http: [//www.dennisplucinik.com/blog/2007/09/01/css-hack-text-indent-10000px/](http://www.dennisplucinik.com/blog/2007/09/01/css-hack-text-indent-10000px/)这是 Apple 在其网站上创建精美字体的方法。

# macos - mac 中的 Air 应用程序图标不接受任何文件拖放来自行启动

> ID：14711692
> 
> 赞同：1
> 
> 时间：2013-02-05T16:03:01.047
> 
> 标签：macos, actionscript-3, flash, apache-flex

双击该图标会启动应用程序，但它不接受文件以自行启动。

但在 Windows 中，相同的应用程序图标接受文件并启动它。

我在用着

> NativeApplication.nativeApplication.addEventListener(InvokeEvent.INVOKE, onInvokeEvent);

如果某些文件被拖放到应用程序上，则启动应用程序。Windows 会，mac 不会。有什么专长吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T17:18:06.013

[Flex 文档](http://livedocs.adobe.com/flex/3/html/help.html?content=File_formats_1.html)说：

> **文件类型关联**
> 
> 要将您的应用程序与 Mac OS X 上的公共或自定义文件类型相关联，您必须编辑包中的 info.plist 文件以设置 CFBundleDocumentTypes 属性。请参阅 Mac OS X 开发人员库：信息属性列表键参考，CFBundleURLTypes。

# image - Oracle 查找图片最常见的颜色

> ID：14711693
> 
> 赞同：1
> 
> 时间：2013-02-05T16:03:00.373
> 
> 标签：image, oracle, colors, multimedia, segment

我是 oracle 多媒体/中间媒体的新手，目前我正在处理 oracle 文档。我想对存储在 oracle ORDImage 中的图像进行“颜色配置”。我看到有 SI_COLOR 和 SI_HISTOGRAM 但它可能不是我需要的。

这是一个例子：有一个图像，比如说风景，主要是绿色和蓝色。而且我想以某种方式提取这些信息，如 RGB(000,200,000) RGB(000,000,200) 并用主要颜色构建一个映射数据库表并尝试匹配图像。65%绿色和25%蓝色或类似的东西。

任何想法表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T18:36:09.537

与此同时，我有解决方案。

如果图片存储在 ORDIMAGE 中，我必须先将其转换为 BLOB，然后再转换为 SI_STILLIMAGE。然后我可以使用包含 rgb、频率对的 SI_COLORHISTOGRAM，很容易找到前 N 个最常见的颜色然后我可以使用这个前 N 个颜色列表来将图片与一些基本颜色匹配:)

# linux - 通过传递命令行参数从目录中列出文件

> ID：14711695
> 
> 赞同：0
> 
> 时间：2013-02-05T16:03:10.840
> 
> 标签：linux, bash, shell, unix

我正在尝试使用命令行参数从任意数量的目录中列出文件。我正在尝试通过命令行传递目录路径并显示搜索目录中的文件。像这样的东西。“目录：PATH1”文件文件文件

“目录：PATH2”文件文件

等等

所以我使用 $* 来传递所有命令行参数，但它只显示第一个列出的目录中的文件。

```
#!/bin/bash

cd $*
for filename in *
do
        echo "Directory: $*"
        echo $filename
done 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T17:16:15.097

万一您在目录名称中有空格，您可能想要使用“$@”，并且检查目录是否存在并没有什么坏处：

```
 for dir in "$@" ; do
    if [ -d "$dir" ] ; then
      echo "Directory: $dir"
      ls "$dir"  # If all you want is to show the contents, this should do
    else
      echo "Not a directory: $dir"
    fi
  done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:10:36.953

与此类似的东西应该可以工作：

```
dirs=$*
for dir in $dirs
do
  echo "Directory: $dir"
  for filename in $(ls $dir)
  do
        echo $filename
  done
done 
```

# string - 将字符串输入表示为对象的选项

> ID：14711700
> 
> 赞同：0
> 
> 时间：2013-02-05T16:03:19.147
> 
> 标签：string, oop, artificial-intelligence

我收到一个由字符串表示的“地图”作为输入，其中地图的某些节点具有重要性。例如：

---s--

--s---

s---s-

s---s-

-----s

我的问题是，有哪些合理的选择可以将此输入表示为对象。唯一真正想到的选择是：

(1) 每个位置都用上、下、左、右指针转换为节点。整个对象包含一个指向右上角节点的指针。

这似乎只是针对此问题的图形表示。

谢谢您的帮助。此外，如果此类输入有通用术语，请告诉我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:07:58.823

好吧，这在很大程度上取决于您需要委托给这些对象的内容。OOP 基本上是关于要求对象执行某事以解决给定问题，因此如果不知道您需要完成什么就很难说清楚。

您提到的解决方案可能是一个有效的解决方案，也可以有一个矩阵（在这种情况下为 6x5），您可以在每个矩阵单元中存储一个表示节点的对象（例如，我曾经使用这两种方法来建模[康威的人生游戏](http://en.wikipedia.org/wiki/Conway%27s_Game_of_Life)）。如果您可以提供更多关于您需要对地图的对象表示做什么的信息，那么可以讨论更好的设计。

高温高压

# sql - 返回每个员工部门名称

> ID：14711704
> 
> 赞同：0
> 
> 时间：2013-02-05T16:03:38.970
> 
> 标签：sql, oracle, plsql

> 编写函数返回每个员工的部门名称。在20个部门写一个块打印所有员工姓名和部门名称。函数头：
> `Create or replace function empdnm (empno number) return varchar2 is`
> 
> 如果没有这样的empno，请尝试编写异常。

我尝试了以下代码，但它显示了一些错误，即 `SQL statment ignored and missing expression`. 问题是什么？

```
create or replace function empdnm (empno1 number) return varchar2 is 
deptname varchar (30);
BEGIN   
Select into deptname(select d.dname from dept d
join emp  e on  e.deptno=d.deptno
Where e.empno= empno1
)
exception
WHEN no_data_found THEN
dbms_output.put_line('no employee with no:'|| empno1);

return(deptname);
end;

BEGIN
FOR r IN (SELECT * FROM emp where dept_id = 20) loop
dbms_output.put_line( 'employee '|| r.emp_name  || ' is in department '||  empdnm(empno1) );
END loop;
end; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:06:47.243

试试这样：

```
create or replace function empdnm (empno1 number) return varchar2 is 
   deptname varchar (30);
BEGIN   
   SELECT d.dname
   INTO   deptname
   FROM   dept d
   JOIN   emp e on e.deptno = d.deptno
   WHERE  e.empno = empno1;

   return(deptname);
exception
   WHEN no_data_found THEN
      dbms_output.put_line('no employee with no:'|| empno1);
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:47:15.340

使用以下一种：

```
create or replace function empdnm (empno1 number) return varchar2 is 
   deptname varchar (30);
BEGIN   
   SELECT d.dname
   INTO   deptname
   FROM   dept d
   JOIN   emp e on e.deptno = d.deptno
   WHERE  e.empno = empno1;

   return(deptname);
exception
   WHEN no_data_found THEN
      dbms_output.put_line('no employee with no:'|| empno1);
end;

BEGIN
FOR r IN (SELECT * FROM emp where dept_id = 20) loop
dbms_output.put_line( 'employee '|| r.emp_name  || ' is in department '||  empdnm(r.empno1) );
END loop;
end; 
```

# unit-testing - Grails 1.3.7 到 Grails 2.2 升级，单元测试现在因缺少 GORM 方法而失败

> ID：14711707
> 
> 赞同：0
> 
> 时间：2013-02-05T16:03:48.333
> 
> 标签：unit-testing, grails-2.0

我正在将应用程序从 Grails 1.3.7 升级到 2.2

到目前为止，它相对无痛且直截了当。

直到我们开始运行单元测试。

在 1.3.7 下，所有测试都通过了。

在 2.2 之下，现在大约有一半失败了。测试没有改变，它们仍然是老式的 mockDomain ......

最让我担心的是某些领域类缺少基本的 gorm 功能。

.list 和 .get 之类的东西

> 失败：testList_NoMaxSpecified_10Shown(com.litle.bldvwr.StreamControllerTests) | groovy.lang.MissingMethodException：没有方法签名：>com.litle.bldvwr.Stream.list() 适用于参数类型：() 值：[] 可能的解决方案：list()、list()、list()、列表（java.lang.Object），列表（java.util.Map），>列表（java.lang.Object）

和

> 失败：>testAddFailureOutputToHappyPathWithIntegrationFailure(com.litle.bldvwr.LogParserServiceTests) | groovy.lang.MissingMethodException：没有方法签名：>com.litle.bldvwr.Result.get() 适用于参数类型：() 值：[] 可能的解决方案：get(java.io.Serializable), get(java .lang.Object)、>get(java.io.Serializable)、getId()、grep()、grep(java.lang.Object)

此类故障的一般模式是：

```
mockDomain(Phase, [new Phase(id:1, name: 'xxx')])       
mockDomain(Result, [new Result(id:1, phase: Phase.get(1), failureOutput:"")])          
logParserService.addFailureOutputTo(Result.get(1)) 
```

正是最后一次获取导致无签名错误。

虽然我们打算开始使用新的单元测试功能，但我希望避免重写 500 多个当前测试。

想法，想法？

-克拉克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-24T18:38:45.493

在域对象的测试中使用新`@Mock()`注释将注入所有预期的模拟 GORM 方法，您甚至可以只使用`save()`域对象而不是在`mockDomain()`调用中提供列表。

```
@Mock([Result, Nightly])
class MyTests {
  void testSomething() {
    def night = new Nightly( name:'nightly1')
    night.id=1
    night.save(validate: false)

    assert Nightly.get(1).name == 'nightly1'

    assert Result.count() == 0

    new Result(status: Constants.SUCCESS, type: Constants.INTEGRATION, 
      nightly: Nightly.get(1)).save(validate: false)

    assert Result.count() == 1
    assert Result.findByStatus(Constants.SUCCESS) != null // yay dynamic finders!

  }
} 
```

[http://grails.org/doc/latest/guide/testing.html#unitTestingDomains](http://grails.org/doc/latest/guide/testing.html#unitTestingDomains)

您必须将所有测试更新为新方法，但它比旧的 1.3 方法*要*好得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:07:50.130

所以这就是我们发现的。

使用 1.3，您可以：

```
 {
   mockDomain(Nightly, [new Nightly(id: 7)])
    mockDomain(Result, [
        new Result(status: Constants.SUCCESS, 
        type: Constants.INTEGRATION, nightly: Nightly.get(7))
    ])
    service.callSomething(results, Nightly.get(7))
    assert result==Nightly.get(7).property 
```

它会工作得很好。您拥有一个 id 为 7 的 Mock 域对象，并且 get 可以正常工作。

从那以后，有些事情发生了变化，你不能再设置 id 已经创建的部分了。

你需要做的是：

```
night = new Nightly( name:'nightly1')
    night.id=1
    mockDomain(Nightly, [night])
    mockDomain(Result, [
        new Result(status: Constants.SUCCESS, type: Constants.INTEGRATION, nightly: Nightly.get(1))
    ]) 
```

这主要是正确设置模拟。

我们接下来遇到的问题是，在 mockDomain 调用之外，Nightly.get() 不起作用。

所以现在我们需要将“模拟”域保存在局部变量中，以便进行后期操作比较和检查。

不是一个完全可怕的解决方案，但没有我们希望的那么优雅。

# c# - 变量状态

> ID：14711711
> 
> 赞同：2
> 
> 时间：2013-02-05T16:03:53.727
> 
> 标签：c#, asp.net

在“edmx”页面中，我有带有事件“NextButton_Click”的按钮控件进行点击。当我单击此按钮时，变量“index”不想更改为“40”，“text”变量不想更改为“active”。这些变量总是处于相同的状态，“text”总是等于“start”，“index”总是等于“10”。为什么他们不想改变 (index = 40; text = "active";) 正如我在点击按钮事件方法中所写的那样？

```
public partial class CountriesTowns : System.Web.UI.Page
{
    int index = 10;
    string text = "start";

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            index = 20;
            text = "stop";
        }
    }

    //click next button
    protected void NextButton_Click(object sender, EventArgs e)
    {   
        Response.Write(index);
        Response.Write(text);
        index = 40;
        text = "active";
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T16:06:46.870

HTTP 是无状态的，像您的 `index`or `text`（甚至所有控件）这样的每个对象都会在页面生命周期结束时被销毁。所以它们总是用它们的默认值初始化。

```
int index = 10;
string text = "start"; 
```

您可以使用控件（fe a`TextBox`或 a `HiddenField`）在回发中保持其值。

但还有其他选择：

[**在 ASP.NET 应用程序中管理持久用户状态的九个选项**](http://msdn.microsoft.com/en-us/magazine/cc300437.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T16:06:21.533

您没有在回发之间保持`index`和`text`变量的更新状​​态。因此，由于`CountriesTowns`每个请求都会创建一个新实例，因此这些值将重新初始化为其默认值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T16:07:25.893

每次单击按钮时，都会导致所谓的*回*发。回发不只是运行您的点击代码......它还重建您的*整个*页面。为此，*它会创建一个全新的 Page 类实例，*然后在新页面的 html 完成后立即销毁该实例。它必须这样做，因为您的 Page 类的原始实例在呈现 html 时也被破坏了。

# ios - iOS UIGestureRecognizer

> ID：14711720
> 
> 赞同：1
> 
> 时间：2013-02-05T16:04:13.217
> 
> 标签：ios, uiswipegesturerecognizer

我有两个问题：

1.  我可以实现从处理程序继承`UISwipeGestureRecognizer`并向`UIEvent`处理程序添加逻辑的手势识别器吗？

2.  我可以`UIGestureRecognizer`在不将其附加到的情况下实施`UIView`吗？意思是，我将分析和管理`UIEvent`事件并调用正确的选择器（`touchesBegan`, `touchesMoved`, `touchesEnded`, `touchesCancelled`）？

与此同时，当状态为 时，我在重置手势识别器时遇到问题`UIGestureRecognizerStateEnded`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:34:56.183

您问：

> 我可以实现从处理程序继承`UISwipeGestureRecognizer`并向`UIEvent`处理程序添加逻辑的手势识别器吗？

是的。请参阅*iOS 事件处理指南*中的[创建自定义手势识别器。](http://developer.apple.com/library/ios/documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/GestureRecognizer_basics/GestureRecognizer_basics.html#//apple_ref/doc/uid/TP40009541-CH2-SW44)另请参阅[WWDC 2010 会议 121 - 高级手势识别](https://developer.apple.com/videos/wwdc/2010/?id=121)。不过，这可能取决于您想要做什么，您应该看看是否可以通过配置标准滑动手势和参数来完成您想要的操作。我已经对连续手势进行了更多的子类化，比如*`direction``numberOfTouches``UIPanGestureRecognizer`*

 *> 我可以`UIGestureRecognizer`在不将其附加到的情况下实施`UIView`吗？意思是，我将分析和管理`UIEvent`事件并调用正确的选择器（`touchesBegan`, `touchesMoved`, `touchesEnded`, `touchesCancelled`）？

不。显然你可以创建一个，但它不会接收任何事件，直到它被添加到 a`UIView`并且该视图接收到触摸。

> 与此同时，当状态为 时，我在重置手势识别器时遇到问题`UIGestureRecognizerStateEnded`。

您必须提交一个新问题，提供相关的代码片段，以便我们帮助您解决该问题。一般来说，当你的处理程序被调用`UIGestureRecognizerStateEnded`（和`UIGestureRecognizerStateCancelled`或`UIGestureRecognizerStateFailed`）时，你会做任何手势后清理，当你收到下一个手势时，你会为下一个手势初始化一切`UIGestureRecognizerStateBegan`。*

# android - 用单行 TextView 以编程方式填充 LinearLayout

> ID：14711726
> 
> 赞同：1
> 
> 时间：2013-02-05T16:04:30.073
> 
> 标签：android, textview, width, android-linearlayout

我试图通过将 TextViews 放置在单行 LinearLayouts 行中来在屏幕上显示一堆文本。每个单词都存储在自己单独的 TextView 中，我希望能够在单个 LinearLayout 行上放置尽可能多的 TextView，并检测何时用完水平空间，以便移动到下一行。

我面临的问题是，我似乎无法在创建显示时找到一种方法来测量不断变化的布局大小，因为我无法`getWidth()`在父布局上使用参考宽度，即使在我添加了TextViews，我似乎无法控制宽度。

我们之前有一个工作版本，但它使用基于 TextView 中固定大小的字符数的硬编码数字来完成所有工作。我正在尝试扩展应用程序以使用所有文本和屏幕尺寸。如果这需要彻底检修，我理解 - 我只是希望能够用不定行数的文本填满屏幕。

一个明显的解决方案是将所有文本放在一个 TextView 中，但是我们需要能够通过显示的 TextView 访问每个 Word/Pontuation 对象及其属性。

```
// layout_row is the current LinearLayout row I'm adding my TextViews to
// layout is the LinearLayout parent of all layout_rows
// text.text_content is a linked list of Word and Ponctuation objects
// each Word and Ponctuation object has a TextView attribute called view

private void display_views() {

    if (text != null)
    {
        boolean prochainLigneSuivante; // if new line is to follow
        int widthSoFar = 0;
        int layoutWidth = layout_row.getWidth();  

        for (Object o : text.text_content) {
            if (o instanceof Word ) {
                Word w = (Word) o;
                Object next = text.next(o);

                if  (noNeedForSpace(w)) {
                    // by default all TextViews have 
                    // right padding to simulate spaces
                    w.view.setPadding(0, 0, 0, 0);
                }

                layout_row.addView(w.view);
                widthSoFar += w.view.getWidth();

                // Am I out of space?
                prochainLigneSuivante = widthSoFar >= layoutWidth;

                if(prochainLigneSuivante) {
                    layout_row.removeView(w.view);
                    widthSoFar = 0;
                    layout_row = new LinearLayout(context);
                    layout_row.setOrientation(LinearLayout.HORIZONTAL);
                    layout_row.addView(w.view);
                    layout_row.setBackgroundColor(Color.BLACK);
                    layout_row.setLayoutParams(new 
                        LayoutParams(LayoutParams.WRAP_CONTENT, 
                            LayoutParams.MATCH_PARENT));
                    layout.addView(layout_row);     
                }
            }
            else if (o instanceof Ponctuation) {
                Ponctuation p = (Ponctuation) o;

                if (p.text.contains("CR")) {
                    layout_row = new LinearLayout(context);
                    layout_row.setOrientation(LinearLayout.HORIZONTAL); 
                    layout_row.setLayoutParams(new 
                            LayoutParams(LayoutParams.WRAP_CONTENT, 
                                        LayoutParams.MATCH_PARENT));
                    widthSoFar = 0;
                    layout.addView(layout_row);
                }
                else {
                    if (p.view.getText().equals(" "))
                        p.view.setPadding(0, 0, 0, 0);
                    layout_row.addView(p.view);
                    if(!p.view.getText().equals(""))
                    widthSoFar += p.view.getWidth();
                }
            }
        }
    }
    else {
        Log.e("Text", "text est nul");
    }

    scroll.refreshDrawableState();
    transition.startTransition(0);

} 
```

# c# - App.conf 自定义配置集合 - 无法识别的属性

> ID：14711729
> 
> 赞同：3
> 
> 时间：2013-02-05T16:04:41.177
> 
> 标签：c#, .net, configuration

我为 app.config 中的自定义嵌套配置集合创建了自己的一组类。我现在收到一条错误消息，指出“无法识别的属性‘名称’。请注意，属性名称区分大小写。”

以下是我的课程、我的 app.config 的相关部分以及获取自定义配置的代码行：

```
public class Custom : ConfigurationSection
{
   [ConfigurationProperty("AutoSyncConfiguration")]
   public BackupLocationElementCollection AutoSyncConfiguration
   {
      get { return this["AutoSyncConfiguration"] as BackupLocationElementCollection; }
   }
}
public class BackupLocationElementCollection : ConfigurationElementCollection
{
   protected override ConfigurationElement CreateNewElement()
   {
      return new BackupLocationElement();
   }
   protected override object GetElementKey(ConfigurationElement element)
   {
      return ((BackupLocationElement)element).Name;
   }
   public override ConfigurationElementCollectionType CollectionType
   {
      get { return ConfigurationElementCollectionType.BasicMap; }
   }
   protected override string ElementName
   {
      get { return "BackupLocation"; }
   }
   public BackupLocationElement this[int index]
   {
      get { return (BackupLocationElement)BaseGet(index); }
      set
      {
         if (BaseGet(index) != null)
         {
            BaseRemoveAt(index);
         }
         BaseAdd(index, value);
      }
   }
   new public BackupLocationElement this[string backupName]
   {
      get { return (BackupLocationElement)BaseGet(backupName); }
   }
   public bool ContainsKey(string key)
   {
       bool result = false;
       object[] keys = BaseGetAllKeys();
       foreach (object obj in keys)
       {
         if ((string)obj == key)
         {
            result = true;
            break;
         }
      }
      return result;
   }
}

public class BackupLocationElement : ConfigurationElement
{
   [ConfigurationProperty("Name", IsRequired = true, IsKey = true)]
   public string Name
   {
      get { return this["Name"] as string; }
      set { this["Name"] = value; }
   } 

   [ConfigurationProperty("Details", IsRequired = true, IsKey = false)]
   public string Details
   {
      get { return this["Details"] as string; }
      set { this["Details"] = value; }
   } 

   [ConfigurationProperty("WatchedFolder")]
   public WatchedFolderElementCollection WatchedFolder
   {
      get { return this["WatchedFolder"] as WatchedFolderElementCollection; }
   }
} 

public class WatchedFolderElementCollection : ConfigurationElementCollection
{
   protected override ConfigurationElement CreateNewElement()
   {
      return new WatchedFolderElement();
   }
   protected override object GetElementKey(ConfigurationElement element)
   {
      return ((WatchedFolderElement)element).Name;
   }
   public override ConfigurationElementCollectionType CollectionType
   {
      get { return ConfigurationElementCollectionType.BasicMap; }
   }
   protected override string ElementName
   {
      get { return "WatchedFolder"; }
   }
   public WatchedFolderElement this[int index]
   {
      get { return (WatchedFolderElement)BaseGet(index); }
      set
      {
         if (BaseGet(index) != null)
         {
            BaseRemoveAt(index);
         }
         BaseAdd(index, value);
      }
   }
   new public WatchedFolderElement this[string folderName]
   {
      get { return (WatchedFolderElement)BaseGet(folderName); }
   }
   public bool ContainsKey(string key)
   {
      bool result = false;
      object[] keys = BaseGetAllKeys();
      foreach (object obj in keys)
      {
         if ((string)obj == key)
         {
            result = true;
            break;
         }
      }
      return result;
   }
} 

public class WatchedFolderElement : ConfigurationElement
{
   [ConfigurationProperty("Name", IsRequired = true, IsKey = true)]
   public string Name
   {
      get { return this["Name"] as string; }
      set { this["Name"] = value; }
   } 

   [ConfigurationProperty("LocalFolder", IsRequired = true, IsKey = false)]
   public string LocalFolder
   {
      get { return this["LocalFolder"] as string; }
      set { this["LocalFolder"] = value; }
   } 

   [ConfigurationProperty("RemoteFolder", IsRequired = true, IsKey = false)]
   public string RemoteFolder
   {
      get { return this["RemoteFolder"] as string; }
      set { this["RemoteFolder"] = value; }
   }

   [ConfigurationProperty("FileSpec", IsRequired = true, IsKey = false)]
   public string FileSpec
   {
      get { return this["FileSpec"] as string; }
      set { this["FileSpec"] = value; }
   }
} 
```

以下是我的 app.config：

```
<configuration>
  <configSections>
    <section name="custom" type="AutoSync.Custom, AutoSync" />
  </configSections>

  <custom>
    <AutoSyncConfiguration>
      <BackupLocation Name="S3" Details="AccessKey=asdf;SecretKey=asdf;BucketName=asdf">
        <WatchedFolder Name="test1" LocalFolder="C" RemoteFolder="Z" FileSpec="*"/>
      </BackupLocation>
      <BackupLocation Name="External" Details="MappedDrive=X;">
        <WatchedFolder Name="test" LocalFolder="D" RemoteFolder="XPhotos" FileSpec="*.jpeg" />
      </BackupLocation>
    </AutoSyncConfiguration>
  </custom>
</configuration> 
```

我的代码如下：

```
Custom config = (Custom)ConfigurationManager.GetSection("custom"); 
```

谁能看到我的错误在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T16:29:51.890

看来，按照我的类的编写方式，我遗漏了一部分层次结构。更改以下内容：

```
[ConfigurationProperty("WatchedFolder")]
public WatchedFolderElementCollection WatchedFolder
{
   get { return this["WatchedFolder"] as WatchedFolderElementCollection; }
} 
```

到

```
[ConfigurationProperty("WatchedFolders")]
public WatchedFolderElementCollection WatchedFolders
{
   get { return this["WatchedFolders"] as WatchedFolderElementCollection; }
} 
```

然后修改我的 app.config 以在 WatchedFolder 元素周围有一个 WatchedFolders 元素解决了这个问题。

# c# - 以编程方式向 DataGridView 添加行

> ID：14711731
> 
> 赞同：0
> 
> 时间：2013-02-05T16:04:43.797
> 
> 标签：c#, .net, datagridview

我有一个`DatGridView`我添加新行的。每行的第一列是一个图像，指示该行的其余部分是否已完成。为了跟踪这一点，每一行都附加了一个类似列表的对象，该对象计算已完成字段的数量，如果已完成足够多的字段，则更改图像。当用户在 GUI 中添加行时，这完全符合预期，但是当我尝试以编程方式添加新行时遇到问题。

创建新行时，`DataGridViewImageCell`第一列中的第一个将添加到跟踪已完成字段的自定义类中。

这是添加新行的代码：

```
//initiate the new row
object[] buffer = new object[13];
buffer[0] = nullImage; //a blank image

for (int i = 1; i < buffer.Length; i++)
{
     buffer[i] = String.Empty;
}

rowID = DataGridView1.Rows.Add(buffer); 
```

这是`RowAdded`代码：

```
 private void DataGridView1_RowsAdded(object sender, DataGridViewRowsAddedEventArgs e)
    {
        DataGridViewImageCell tmp = (DataGridViewImageCell)DataGridView1.Rows[DataGridView1.RowCount - 1].Cells[0];
        DataGridView1ValidateFields.AddRow(tmp); //custom class to keep track of completed fields
    } 
```

自定义类包含一个`DataGridViewImageCells`dgvic 列表；这是它的`AddRow`方法：

```
 private List<object> dgvic = new List<object>();
    public void AddRow(DataGridViewImageCell p)
    {
        items.Add(new List<int>());//List of ints to keep track of completed fields
        dgvic.Add(p);
    } 
```

当我进入调试器（以编程方式添加行时）时，我可以看到每次添加新行时，`DataGridViewImageCells`存储的`dgvic`都是最新行。例如，添加 3 行后，我希望 3`DataGridViewImageCells`来自第 0、1 和 2 行；但是所有这些都来自第 2 行。

在我看来，`RowCount`它仍然与 each 相关联`DataGridViewCell`，并且随着`RowCount`单元格的变化而变化。如果是这种情况，它是如何通过 GUI 工作的？有没有人有任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:57:04.903

改变你`AddedRows`的事件如下：

```
private void DataGridView1_RowsAdded(object sender, DataGridViewRowsAddedEventArgs e)
{
    int index = e.RowIndex;
    for (int i = 0; i < e.RowCount; i++)
    {
        DataGridViewImageCell tmp = (DataGridViewImageCell)DataGridView1.Rows[index].Cells[0];
        DataGridView1ValidateFields.AddRow(tmp);
        index++;
    }
} 
```

# c# - Visual Studio 10 未重建

> ID：14711737
> 
> 赞同：1
> 
> 时间：2013-02-05T16:05:08.010
> 
> 标签：c#, asp.net, visual-studio-2010, build

我对网站中的一个网页进行了小改动。在发布到服务器之前，我在本地编译了它，但似乎没有进行任何更改。例如，在其中一个表格单元格中，我会将“工程师”更改为“苹果”，当我重新构建并运行时，它仍然会显示“工程师”。奇怪的是，当其他人复制代码并运行它时，它运行得非常好。

我尝试清除当前构建，重置所有设置，甚至完全重新安装vs10，但问题仍然存在。

在这一点上，我已经用尽了所有尝试。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:09:59.307

我最近遇到了类似的问题，不一定相同，但是...谁知道呢。

签入菜单构建 -> 配置管理器。在右栏中，确保正在构建所有必需的项目。出于某种原因，就我而言，所有这些都没有被选中，当我点击编译按钮时，什么都不会发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:17:16.010

我在使用 chrome 时遇到了同样的问题。尝试清除您的历史记录，然后重新构建您的应用程序并再次尝试，这对于 VS 2010 来说没有问题。在清除您在 chrome 中的历史记录之前，请尝试使用另一个浏览器并检查它是否相同 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:10:48.800

如果 Clean + Build 或 Rebuild 或手动删除输出文件并重新构建不起作用，则可能是缓存问题。

尝试在 Chrome 中打开页面，打开开发者工具`CTRL+SHIFT+I`，然后长按重新加载页面按钮并从下拉列表中选择`Empty Cache and Hard Refresh`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T16:15:27.570

您是否尝试过刷新您的网络浏览器？尝试在浏览器中按 Ctrl-F5 – Blachshma

这行得通！不敢相信这是这么简单的事情。一直在看错方向。太感谢了！

# css - CSS 图像精灵不显示背景图像

> ID：14711740
> 
> 赞同：2
> 
> 时间：2013-02-05T16:05:09.180
> 
> 标签：css, html, css-sprites

嗨，我在让这个精灵工作时遇到了很多麻烦。背景图像从不显示，只显示链接文本。我尝试使用图像的直接路径 http://..，但它仍然无法正确显示。我很感激帮助。

**CSS：**

```
 #social a {
      text-indent: -9000px;
      display: block;
      background-repeat: no-repeat;
    }

   #youtubelink a {
      background-image: url(social-btns.png);
      background-position: 0px 0px;
      width:46px;
      height:43px;
   }
   #youtubelink a:hover {
      background-position: 0px -43px;
   }
   #googlelink a {
      background-image: url(social-btns.png);
      background-position: 46px 0px;
      width:46px;
      height:43px;
   }
   #googlelink a:hover {
      background-position: 46px -43px;
   }
   #facebooklink a {
      background-image: url(social-btns.png);
      background-position: 92px 0px;
      width:46px;
      height:43px;
   }
   #facebooklink a:hover {
      background-position: 92px -43px;
   } 
```

**HTML：**

```
 <div id="social" align="right">

       <a id="youtubelink" href="#">Youtube</a>

       <a id="googlelink" href="#">Google</a>

       <a id="facebooklink" href="#">Facebook</a>

    </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:10:57.777

您有锚元素的 id，并且您选择它作为它们的子元素。你应该这样做：

```
a#facebooklink 
```

您使用的方式：

```
#facebooklink a 
```

它会认为锚是子级的`#facebooklink`，你必须改变你所有的选择器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:11:15.937

代替：

```
#youtubelink a {
  // my css rules 
```

}

它应该是：

```
a#youtubelink {
      // my css rules
   } 
```

这同样适用于您的所有三个社交链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:11:22.640

那是因为你的 CSS 是错误的。*表示标签内*`#youtubelink a`的锚标签，其 id 为“youtubelink”。你想要的是一个#youtubelink

# windows - Windows 批处理：从合并文件中删除行

> ID：14711741
> 
> 赞同：0
> 
> 时间：2013-02-05T16:05:10.200
> 
> 标签：windows, batch-file

我目前正在制作一个批处理文件，该文件将 systeminfo 的输出和 ipconfig 两者合并：

```
@ECHO OFF
pause
systeminfo > "%computername% SystemInfo.txt"
ipconfig >> "%computername% SystemInfo.txt"
"%computername% systeminfo.txt" 
```

据我所知，代码运行良好，也独立于操作系统版本和操作系统语言。不过，我的问题在于 systeminfo 转储。它列出了所有 100 多个已安装在运行的机器上的修补程序，使 txt 文件几乎难以辨认：

```
<useful info>
[01]: File 1
[02]: File 1
[03]: File 1
[04]: File 1
....
[150]: file 1
etc...
<useful info> 
```

还有另一个问题，即这个批处理文件必须在运行荷兰语窗口或英语窗口的计算机上运行，​​这意味着我无法过滤单词，因为这些修补程序和单词在每台计算机上都会有所不同。任何人都可以很好地解决这个问题。

注意：我看到它以相反的方式解决，只留下使用 findstr 的相关信息。但是，因为这取决于语言，所以这不是一个可行的选择。

编辑：修补程序在不同操作系统上的命名也不同，这意味着我无法过滤这些。示例：在我测试的 XP SP3 上，列表中的大部分内容都会受到 vista 上称为“[##]file1”的修补程序的影响，但是，您会在列表中看到十六进制值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T16:45:14.467

**编辑**

我的原始答案不起作用，但我有另一个想法，只要每个 systeminfo 标头的数量和顺序一致。我依赖于 Hotfix(s): 始终是第 31 个标头这一事实。

```
@echo off
setlocal enableDelayedExpansion
>systemInfo.txt (
  set cnt=0
  for /f "delims=" %%A in ('systeminfo') do (
    set "ln=%%A"
    if "!ln:~0,1!"==" " (if !cnt! neq 31 echo !ln!) else (
      echo !ln!
      set /a cnt+=1
    )
  )
  ipconfig
) 
```

如果标题的数量和/或顺序可以改变，那么我看不出有什么解决方案，除了硬着头皮寻找特定的标题文本，考虑到您需要支持的所有语言。

**原始失败的答案**

我不知道这有多可靠。它在我的机器上对我有用，但如果在某些机器上它剥离了不应该的东西，我不会感到惊讶。

```
>systemInfo.txt (
  systeminfo|findstr /vxrc:"                           \[[0-9]*\]: [^ ]*"
  ipconfig
) 
```

我所有的修补程序都以 KB 开头，然后是一串数字。如果这总是正确的，那么上面的内容可以改进为：

```
>systemInfo.txt (
  systeminfo|findstr /vxrc:"                           \[[0-9]*\]: KB[0-9]*"
  ipconfig
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T17:11:50.853

我不想弄清楚，但您可以根据 systeminfo 的 csv 输出对其进行格式化。

```
systeminfo /fo csv > info.csv 
```

任何语言的输出基本上是：

```
(headers)"<col>", "<col>", "<col>" <...> "<col>"<newline>
(data)"<col>", "<col>", "<col>" <...> "<col>" 
```

修补程序列是倒数第二列。因此您可以用引号将其拆分，并忽略该字段。它里面会有一堆废话，但它仍然会是`"hotfix, hotfix, hotfix,"`这样，你可以删除引号中的整个内容。

如果你问我，批量字符串操作很糟糕。如果这是我，我会用带有字符串库的语言来代替它。

# sql - 如何用程序修改列中的每一行？

> ID：14711742
> 
> 赞同：0
> 
> 时间：2013-02-05T16:05:16.957
> 
> 标签：sql, oracle, plsql, oracle10g

我有下表：

```
-----------------
ID | DESCRIPTION
-----------------
7  | qweqwe
8  | asdasd
9  |
10 | zxczxc 
```

我怎样才能用这个程序让她变成这样？

```
-----------------
ID | DESCRIPTION
-----------------
7  | qweqwe_[7]
8  | asdasd_[8]
9  |
10 | zxczxc_[10] 
```

也就是说，如果该字段不为空，那么我需要添加到末尾`_[id]`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:09:23.343

您不需要过程，它只能在 SQL 中完成。

```
update your_table
set    your_column = your_column || '_[' || your_id || ']'
where  your_column is not null 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T16:50:40.190

用这个：

```
select id, description||'_[' || id || ']' 
from table 
where description is not null; 
```

是的，您要更新，然后使用`update`语句：

```
update table 
set description=description||'_[' || id || ']'  
where description is not null; 
```

# iphone - 如何在 ABAddressBook MonoTouch 中获取重复的电话号码

> ID：14711743
> 
> 赞同：0
> 
> 时间：2013-02-05T16:05:17.150
> 
> 标签：iphone, ios, xamarin.ios, abaddressbook

我正在开发获取具有相同电话号码的重复联系人的应用程序。我的问题是常规的 foreach 与大量的联系很慢，我也知道使用谓词可以做到这一点。但我找不到任何带有单点触控的样品。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:33:40.700

我不知道 ABAddressBook，但如果您使用 Xamarin Mobile APi，那么您可以使用谓词，如下所示：

```
var abook = new AddressBook();
abook.RequestPermissions().ContinueWith (t =>
{
    if (!t.Result)
        return; // Permission denied

    var builder = new StringBuilder();

    // Full LINQ support
    foreach (Contact c in abook.Where (c => c.FirstName == "Eric" && c.Phones.Any()))
    {
        builder.AppendLine (c.DisplayName);
        foreach (Phone p in c.Phones)
            builder.AppendLine (String.Format ("{0}: {1}", p.Label, p.Number));

        builder.AppendLine();
    }

    contacts.Text = builder.ToString(); // Update UI

}, TaskScheduler.FromCurrentSynchronizationContext()); // Ensure we're on the UI Thread 
```

来自[http://betaapi.xamarin.com/?link=T%3aXamarin.Contacts.AddressBook](http://betaapi.xamarin.com/?link=T%3aXamarin.Contacts.AddressBook)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T12:37:09.967

您可以在 O(N) 时间内完成。此答案使用一个循环来识别数组中的重复项： [https](https://stackoverflow.com/a/12948182/1441667) ://stackoverflow.com/a/12948182/1441667 。尝试将 Stuarts 的答案与这种方法结合起来。

# wpf - 如何在运行时在我的 WPF 应用程序中查找我的 XAML 文件的名称

> ID：14711755
> 
> 赞同：1
> 
> 时间：2013-02-05T16:05:43.523
> 
> 标签：wpf, xaml

我正在开发非常复杂的 WPF 应用程序，它有很多资源文件，因此 XAML 在设计时不会加载。我想在运行时查找 XAML 文件的名称。我正在尝试使用 snoop 但无法找到 XAML 文件的名称。请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T17:17:45.330

使用 Snoop 不会为您提供文件名，但您应该能够通过查看您要到达的位置附近的可视树视图来定位某些类型名称（即 UserControls、自定义控件等）或带有 x:Names 的元素使用 Ctrl-Shift 鼠标悬停快捷方式后。搜索类型的使用（在控件的情况下）或在所有解决方案 *.xaml 文件上使用“在文件中查找”应该可以帮助您找到要查找的元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T16:28:42.573

通常我会从较高级别的 UI（例如 MainWindow）开始，然后在纸上绘制我在那里找到的组件，尤其是网格。

然后我试图找出我的应用程序的元素在那个视图中的位置。

如果您有多个视图，这可能会有些耗时。但是，如果您不能只单击设计器窗口，这是最快的方法之一。

好的，如果您只有较小的更改，您可以尝试使用字符串搜索找到要更改的元素。

找到你想要的标签，如果是资源字符串，找到它的用法。

如果您有一个复杂的 MVVM 应用程序，您可以从调查使用的 ViewModel 开始。它们可能是比视图本身更好的起点。

-edit- WPF Inspector 可以为您提供有关搜索位置的良好提示。你可以在这里得到它：[WPF Inspector home](http://wpfinspector.codeplex.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-07T16:04:07.827

如果您正在为自己的需要寻找它，您可以在任何视觉对象上调用 BaseUriHelper.GetBaseUri(v)，它会为您提供视觉对象所来自的资源的 Uri。从此 Uri 您可以获取原始 xaml 文件

# php - 挣扎着用小json和php获取IP

> ID：14711762
> 
> 赞同：1
> 
> 时间：2013-02-05T16:06:05.230
> 
> 标签：php, jquery, json

**PHP**

```
<?php
header('Content-type: application/json');
$return['ip'] = $_SERVER['REMOTE_ADDR'];  
$results[] = array(
      'ip' => $return['ip']
   );
echo json_encode($results);
?> 
```

**jQuery**

```
$.getJSON("http://domain.com/json/",
        function(data){
            console.log(data.ip);
        });
    }); 
```

但是当我运行 jQuery 时，我检查了 Fire 错误，它显示以下内容

> GET [http://domain.com/json/](http://domain.com/json/) 200 OK 81ms

并且不响应我请求的 IP。我错过了什么吗？

**更新代码**

**PHP**

```
<?php
header('Content-type: application/json');
$return['ip'] = $_SERVER['REMOTE_ADDR'];  
$results = array(
      'ip' => $return['ip']
   );
echo json_encode($results);
?> 
```

**jQuery**

```
$.getJSON("http://domain.com/json/", function(data){
            console.log(data.ip);
        }); 
```

**萤火虫错误**

> SyntaxError: 无效标签 {"ip":"XXX.XXX.XXX.X"}

一个箭头指向单词 ip 之前的第一个引号。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T16:13:18.440

您正在返回：

```
[{'ip': 'XXX.XXX.XXX.XXX'}] 
```

但是您将其视为返回：

```
{'ip': 'XXX.XXX.XXX.XXX'} 
```

您需要将 JavaScript 更改为`console.log(data[0].ip)`或将 PHP 更改为：`$results = array( ... );`而不是`$results[] = array( ... );`

要么解决你的问题。:)

# directx - HLSL浮点数组打包在常量缓冲区中？

> ID：14711763
> 
> 赞同：5
> 
> 时间：2013-02-05T16:06:05.290
> 
> 标签：directx, hlsl, directx-11, vertex-shader

人们。

我通过**常量缓冲区将****浮点数组**传递给顶点着色器（HLSL）时遇到问题。我知道由于 HLSL 打包规则，下面数组中的每个“浮点数”都单独获得一个 16 字节的插槽（空间相当于 float4）：

 **```
// C++ struct
struct ForegroundConstants
{
    DirectX::XMMATRIX transform;
    float bounceCpp[64];
};

// Vertex shader constant buffer
cbuffer ForegroundConstantBuffer : register(b0)
{
    matrix transform;
    float bounceHlsl[64];
}; 
```

（不幸的是，[这里](https://stackoverflow.com/questions/2866778/hlsl-index-to-unaligned-packed-floats)的简单解决方案不起作用，在我进行更改后没有绘制任何内容）

当 C++ 数据被传递时，由于打包规则，它们被隔开，使得**bounceCpp C++ 数组中的每个“浮点数”在****bounceHlsl**数组中都单独进入一个 16 字节的空间。这导致了类似于以下内容的警告：

> ID3D11DeviceContext::DrawIndexed：Vertex Shader 单元的 slot 0 处的 Constant Buffer 的大小太小（提供 320 字节，预计至少 1088 字节）。这没关系，因为越界读取被定义为返回 0。开发人员也可能知道无论如何都不会使用丢失的数据。如果开发人员实际上打算为着色器所期望的绑定足够大的常量缓冲区，这只是一个问题。

[正如此处](http://msdn.microsoft.com/en-us/library/windows/desktop/bb509632(v=vs.85).aspx)和[此处](http://xboxforums.create.msdn.com/forums/p/27472/151228.aspx)所指出的，建议是以这种方式重写 HLSL 常量缓冲区：

```
cbuffer ForegroundConstantBuffer : register(b0)
{
    matrix transform;
    float4 bounceHlsl[16]; // equivalent to 64 floats.
};

static float temp[64] = (float[64]) bounceHlsl;

main(pos : POSITION) : SV_POSITION
{
    int index = someValueRangeFrom0to63;
    float y = temp[index];

    // Bla bla bla...
} 
```

但这不起作用（即 ID3D11Device1::CreateVertexShader 永远不会返回）。我正在针对**Shader Model 4 Level 9_1**编译东西，你能发现我在这里做错了什么吗？

提前致谢！:)

问候，本

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T13:25:53.963

一种解决方案（尽管不是最佳的）是将您的浮点数组声明为

```
float4 bounceHlsl[16]; 
```

然后像处理索引一样

```
float x = ((float[4])(bounceHlsl[i/4]))[i%4]; 
```

其中 i 是您需要的索引。**

# javascript - Metro 应用程序可以在不打开页面的情况下打开默认浏览器吗？

> ID：14711765
> 
> 赞同：1
> 
> 时间：2013-02-05T16:06:17.780
> 
> 标签：javascript, windows-8, microsoft-metro, windows-runtime, windows-store-apps

单击按钮时，我想打开默认的 Metro 浏览器（通常是 IE）而不打开新的选项卡/页面，只需打开浏览器，如果它已经在运行，则只需切换到当前状态即可。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T20:14:03.057

不可以。启动浏览器的唯一方法是通过[Launcher](http://msdn.microsoft.com/en-us/library/windows/apps/windows.system.launcher.aspx)间接启动。Launcher 需要 Uri 或文件，它将打开与该 Uri 或文件类型关联的默认程序。例如，如果是 http，它将启动默认浏览器。不幸的是，[Uri 类](http://msdn.microsoft.com/en-us/library/windows/apps/br225998.aspx)似乎没有正确解析[about Uri 方案](https://www.rfc-editor.org/rfc/rfc6694)，也不会接受没有主机的空白字符串或 http 地址。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T20:25:02.447

这只是尝试的东西，可能会或可能不会在您的场景中起作用：

如果您知道在浏览器中打开的 url，您的 Windows 应用商店应用程序可以使用启动器启动相同的 url。

在我的应用程序中，当我多次启动同一个 url 时，IE 会弹出但不会加载该 url 的第二个实例。

# php - 找不到重定向的来源

> ID：14711769
> 
> 赞同：1
> 
> 时间：2013-02-05T16:06:29.200
> 
> 标签：php, redirect, joomla

我在大约 10 秒后重定向到某个“dodonet.biz”有线域，但我找不到重定向的来源。- 在所有 JS 文件中搜索。- 禁用 JS。- 搜索进行刷新的标签。

但是什么也没发现。

请看一下并告诉我您是否知道下一步要检查什么

该网站是：www.tmaster.co.il

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T12:01:53.243

我强烈建议升级到最新的 Joomla 版本。好像您被黑客入侵了，您的文件也被盗用了。尽管黑客很聪明，但您不会在文件中找到“dodonet.biz”。

我会搜索奇怪`base64_decode`的`eval`片段。或者您可以将您的站点与[Meld](http://meldmerge.org/)或类似软件的干净 joomla 安装（或仅文件）进行比较。

[您可以在Joomla 文档](http://docs.joomla.org/Security_Checklist/You_have_been_hacked_or_defaced)中找到有关 Joomla 安全性的更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T10:09:41.557

您的重定向位于根目录中名为 decode.php 的文件中。

```
<?php

$str = "aGVhZGVyKCJSZWZyZXNoOiAyNTsgdXJsPVwiaHR0cDovL3d3dy5kb2RvbmV0LmJpei8xL1wiIik7";

echo base64_decode($str);
?> 
```

解码它说

```
header("Refresh: 25; url=\"http://www.dodonet.biz/1/\""); 
```

这发生在我的网站上，希望对您有所帮助:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:11:52.363

该页面没有进行任何重定向。

尝试清除缓存并重新加载网页。

# git - ls-remote 报告以“^{}”结尾的虚拟标签

> ID：14711770
> 
> 赞同：8
> 
> 时间：2013-02-05T16:06:41.580
> 
> 标签：git

以'^{}'结尾的标签是什么？它们实际上并不存在于裸存储库中。

```
$ git ls-remote -t origin
55f09717db93733b8f151763e7e28628f3f22129        refs/tags/Init
dce13158fff0e95b8adcc5628f193a8c03bada9c        refs/tags/Init^{}
2c9f64c306aa76e5b689bc2ffb41163aa255ac40        refs/tags/kaos-red
0970feca84d87df60ec5e943da2f55f1947fd0a3        refs/tags/legacy
dce13158fff0e95b8adcc5628f193a8c03bada9c        refs/tags/legacy^{} 
```

例如，当我尝试使用“git push :legacy^{}”删除它们时，git 会响应

```
fatal: remote part of refspec is not a valid name in :Init^{} 
```

那么他们来自哪里呢？它是 ls-remote 中的错误吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T16:30:58.927

[git rev-parse 手册](http://www.kernel.org/pub/software/scm/git/docs/git-rev-parse.html)描述了您可以在git 中指定提交或其他对象的各种方法。对于这种情况，它说：

> ^{}，例如 v0.99.8^{} 后缀 ^ 后跟一个空括号对意味着对象可以是一个标签，并递归地取消引用该标签，直到找到一个非标签对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-25T07:54:07.097

我想在我的远程 git 存储库中批量删除标签，在我从谷歌找到的一些结果文档中，我找到了类似的命令

```
git ls-remote --tag | awk '/(.*)(\s+)(.*)/ {print ":" $2}' | xargs git push origin 
```

或类似的东西。（同样的问题，它会显示以 ^{} 结尾的幻像标签）

如果你想做和我一样的事情，可以尝试使用 git 命令 show-ref

```
git show-ref --tag | awk '/(.*)(\s+)(.*)/ {print ":" $2}' | xargs git push origin 
```

后一种方式，你不会被这个问题所阻碍。

# c# - 在 WP 中访问 BackgroundAudioPlayer 的流数据

> ID：14711774
> 
> 赞同：0
> 
> 时间：2013-02-05T16:06:47.353
> 
> 标签：c#, silverlight, windows-phone-7, windows-phone-7.1, windows-phone-8

从远程服务器流式传输时，是否可以在 WP 中访问 BackgroundAudioPlayer 的 AudioTrack 的流数据？

我尝试了类似使用媒体流源的方法，但这涉及为我的音频容器（mp4/m4a）实现一个处理程序，我试图避免这种情况（我需要一个独立于容器的解决方案）。

我正在寻找的是能够在流式传输音频数据时对其进行处理/操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:10:09.053

如果您想查看音频流，您必须实现`MediaStreamSource`.

在按曲目播放器中，您的代码甚至不会运行，除非您的曲目结束或用户点击播放、暂停或跳过。

# javascript - 模态中的角度。无法弄清楚我的控制器出了什么问题

> ID：14711783
> 
> 赞同：0
> 
> 时间：2013-02-05T16:07:20.817
> 
> 标签：javascript, angularjs

我对角度很陌生，我一生都无法弄清楚这段代码有什么问题。我很乐意根据需要提供更多代码。

问题是没有发生任何角度动作。该表没有被填充，并且没有任何按钮执行任何操作。http get 永远不会到达我的服务器。所以，我想知道是否有人不介意快速浏览一下并让我知道我是否犯了一个愚蠢的错误。

这是我的角度代码：

```
function locateController($scope, $http) {
            $scope.init = function () {
                $http.get('@(Url.Action<WorkorderController>(c => c.GetLocateNumbers(Model.Id)))').success(function (data) {
                    $scope.model = data;
                    $scope.locateNumber = $scope.locateNumbers();

                    $("#loading").css('display', 'none');
                    $("#ctrl").css('visibility', 'visible');
                    $scope.master = angular.copy($scope.model);
                });
            };

            $scope.init();

            $scope.reset = function () {
                if (confirm('Are you sure you want to discard all your changes?')) {
                    $scope.model = angular.copy($scope.master);
                    $(".selected").removeClass("selected");

                    $scope.locateNumber = $scope.locateNumbers();
                };
            };

            $scope.removeLocate = function (remove) {
                if (confirm('Are you sure you want to remove this location number?')) {
                    var oldLines = $scope.locateNumber;
                    $scope.labor = [];
                    angular.forEach(oldLines, function (line) {
                        if (line != remove) $scope.locateNumber.push(line);
                    });
                }
            };

            $scope.locateNumbers = function () {
                if (!$scope.model) {
                    return null;
                }

                var lines = [];
                angular.forEach($scope.model, function (item) {
                    if (item.IsActive) {
                        lines.push(item);
                    }
                });
                return lines;
            };

            $scope.addLocateLine = function () {
                $scope.locateNumber.push({
                    locationNum: ''
                });
            };

            $scope.dirty = function () {
                if ($scope.model === undefined) {
                    return false;
                }
                var isDirty = !angular.equals($scope.locateNumber, $scope.master.locateNumbers);
                if (isDirty) {
                    $scope.notice = null;
                }
                return isDirty;
            };

            $scope.save = function () {
                $scope.model.Size = $scope.locateNumber.length;
                $scope.model.locateNumbers = $scope.locateNumber;

                $http({
                    method: 'post',
                    url: '@(Url.Action<WorkorderController>(c => c.AssignLocate(Model.Id,null)))',
                    headers: {
                        "Content-Type": 'application/json',
                        Accepts: 'application/json'
                    },
                    data: { wo: $scope.model }
                }).success(function (data, status, headers, config) {
                    $scope.init();
                }).error(function (data, status, headers, config) {
                    alert('An error has occurred. Please try again later or contact an administrator');
                });
            };
        }; 
```

这是HTML：

```
<div class="modal hide" id="assignLocate" data-ng-controller="locateController">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">×</button>
        <h3 class="addRow">Locate Number <button type="button" class="btn btn-warning btn-mini" data-ng-click="addLocateLine()">Add</button></h3>
    </div>
    <div>
        <div class="span3 offset1">
            <table cellpadding="0" cellspacing="25" border="0" class="table" id="locateNumbers">
                <thead>
                    <tr>
                        <th>Locate Number</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="num in locateNumber">
                        <td>
                            <ng-form name="LocateNum">
                                <input type="text" ng-model="num.LocateNum" class="span2" required name="Input"/>
                                <span class="alert-error" ng-show="LocatenNum.Input.$error.required"><strong>*Required</strong></span>
                            </ng-form>
                        </td>
                        <td>
                            <button class="btn btn-mini btn-danger" ng-click="removeLocate(line)">Remove</button>
                        </td>
                    </tr>
                </tbody>
            </table>
            <br /><br />
            <div>
                <div class="span3" style="padding-bottom:25px; margin-left: 0px">
                    <button type="button" class="btn btn-inverse" ng-click="reset()" ng-disabled="!dirty()">Reset</button>
                    <button type="button" class="btn btn-primary pull-right" ng-disabled="form.$invalid" ng-click="save()" ng-disabled="!dirty()">Save</button>
                </div>
            </div>
        </div>
    </div>
</div> 
```

这是一个 js 小提琴：http: [//jsfiddle.net/exmMY/](http://jsfiddle.net/exmMY/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:36:15.613

以下是我注意到的问题：

1.  HTML 中没有“ng-app”。
2.  `locateNumbers`函数有时会返回`null`，但代码的其他部分期望`locateNumber`是数组。

我没有排除更多功能。更改您的示例可以在这里找到：[http ://plnkr.co/edit/A52VmYLznpNqMLq4XLK0?p=preview](http://plnkr.co/edit/A52VmYLznpNqMLq4XLK0?p=preview)

# android - 无法在我的 HTC SENSATION 上安装 Eclipse 的 APK

> ID：14711789
> 
> 赞同：0
> 
> 时间：2013-02-05T16:07:40.967
> 
> 标签：android, eclipse

当我尝试运行我的应用程序时，这就是我在控制台中得到的：

```
[2013-02-05 18:03:46 - IncomingCallBC] Android Launch!
[2013-02-05 18:03:46 - IncomingCallBC] adb is running normally.
[2013-02-05 18:03:46 - IncomingCallBC] Performing com.example.incomingcallbc.MainActivity activity launch
[2013-02-05 18:03:46 - IncomingCallBC] Automatic Target Mode: using device 'SH18RT500393'
[2013-02-05 18:03:46 - IncomingCallBC] Uploading IncomingCallBC.apk onto device 'SH18RT500393'
[2013-02-05 18:03:47 - IncomingCallBC] Installing IncomingCallBC.apk...
[2013-02-05 18:03:47 - IncomingCallBC] Success!
[2013-02-05 18:03:47 - IncomingCallBC] Starting activity com.example.incomingcallbc.MainActivity on device SH18RT500393 
```

但是，我的设备上没有安装 apk。在第一次运行时它安装正确，但在代码中进行了一些更改并再次运行后，它不会安装/重新安装 apk。即使我从设备中手动删除应用程序并尝试运行它并没有真正安装它。

是 HTC SENSATION 常见问题吗？还是我的日食的一些错误设置？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:14:21.627

执行以下操作：

> [1] 从 Eclipse 清理并重建您的项目。
> 
> [2] 拔下并重新启动设备，然后重新插入。
> 
> **[3] Windows > Preference > Android > DDMS > ADB Connection time out (ms):**
> 
> 您将看到**5000**将其更改为**10000**。

然后尝试再次从 Eclipse 运行应用程序。

# python - Python 键错误

> ID：14711792
> 
> 赞同：0
> 
> 时间：2013-02-05T16:07:50.510
> 
> 标签：python, python-2.7, upnp

我有这个 python 代码的 Keyerror

```
service = self.get_cd_service()
browse_response = service.Browse(ObjectID=str(object_id),
                                 BrowseFlag=browse_flag,
                                 Filter=filter,
                                 StartingIndex=starting_index,
                                 RequestedCount=requested_count,
                                 SortCriteria=sort_criteria)
elt = Element.from_string(browse_response['Result'])
browse_response['Result'] = elt.get_items()
return browse_response 
```

错误是：

```
Traceback (most recent call last):
  File "CommandlLineControlPointAv.py", line 93, in <module>
    main()
  File "CommandlLineControlPointAv.py", line 89, in main
    cmdline.run()
  File "CommandlLineControlPointAv.py", line 68, in run
    self.cmd_browse(c.split(' ')[1])
  File "CommandlLineControlPointAv.py", line 48, in cmd_browse
    result = self.browse(id, 'BrowseDirectChildren', '*', 0, 10)['Result']
  File "/usr/local/lib/python2.7/dist-packages/brisa/upnp/control_point/control_point_av.py", line 136, in browse
    elt = Element.from_string(browse_response['Result'])
KeyError: 'Result' 
```

感谢您的帮助/最好的问候。

雷姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T16:10:34.623

browse_response 没有密钥`Result`检查 browse_reponse 包含的内容

`service.Browse`您可以在通话 后立即放入调试器`import pdb; pdb.set_trace()`

您可以`broser_response`通过 python[日志记录该对象](http://docs.python.org/2/library/logging.html)

# visual-studio - 将本地 Git 存储库发布到 Team Foundation Service

> ID：14711796
> 
> 赞同：20
> 
> 时间：2013-02-05T16:08:00.527
> 
> 标签：visual-studio, git, tfs, azure-devops

大约一周前，Visual Studio 2012 和 Team Foundation Service 添加了 Git 支持。我一直在玩它，想将本地存储库发布到我的团队项目中。Team Foundation Service[网站](http://tfs.visualstudio.com/en-us/learn/code/publish-new-team-project-vs-git/)上的步骤 2 中对此进行了描述：

*   将本地 Git 存储库发布到新的团队项目中。

![在此处输入图像描述](../Images/82917369b50b8b8351a40fd835b80edb.png) ![在此处输入图像描述](../Images/9b230dc436aa21bd940efce87b180530.png)

现在我一直在做同样的事情，但我没有得到“发布到...”上下文项。这可能是一个错误还是我错过了什么？

![在此处输入图像描述](../Images/d28a712171b16e5dfaec2c284e556317.png)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-06T23:26:48.180

我遇到了同样的问题。我不知道为什么。

但是，经过一番玩耍后，我设法使以下工作正常进行。免责声明：不能保证这实际上是正确的方法。它可能会使事情变得更糟。而且它是否与缺少的“发布”菜单项应该做的一样，我不知道。酌情使用...

*   在您在 TFS 中设置的项目中获取您的 git 存储库的 url。
    *   在 TFS Web 界面中转到您的项目，然后转到代码选项卡。
    *   您应该会收到一条消息，为您提供 URL。
    *   例如[https://user.visualstudio.com/DefaultCollection/_git/YourProject](https://user.visualstudio.com/DefaultCollection/_git/YourProject)
*   编辑本地仓库中的 .git/config 文件。
    *   将源远程配置为指向您的 TFS 存储库。
    *   （注意：如果您已经有一个原始遥控器，您可能需要先重命名它以保留它）

例如

```
[remote "origin"]
    url = https://user.visualstudio.com/DefaultCollection/_git/YourRepo
    fetch = +refs/heads/*:refs/remotes/origin/* 
```

*   在 Visual Studio 中打开您的解决方案。
*   编辑文件。
*   做一个提交。
*   做一个推。

这应该有望将您的本地存储库作为源推送到您的 TFS 远程。

从这里开始，事情似乎对我有用——代码至少在我的 TFS Web 界面中，我可以向它推送提交。我可以添加积压项目等。我是 TFS 的新手，但不确定它是否真的按应有的方式工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-05-06T08:44:07.510

我只是遇到了同样的问题，ngm的答案没有用；我不得不做相反的事情。[remote "origin"] 部分已经在我的 .git/config 文件中，但是项目代码没有上传到 TFS。

为了修复它，我只是从配置文件中删除了该部分，然后重新启动 Visual Studio 并按照[官方说明](https://tfs.visualstudio.com/en-us/learn/code/publish-new-team-project-vs-git/)进行操作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-07-16T07:21:52.303

我有同样的问题。我能够通过完全重新启动 Visual Studio、打开团队资源管理器然后导航到我的本地存储库来解决它。我打开了我的本地 .sln，然后单击“更改”、“提交”，然后它就有了一个可以将项目发布到 URL 的区域。我使用该 URL，例如：[https](https://myapps.visualstudio.com/DefaultCollection/_git/MySolution) ://myapps.visualstudio.com/DefaultCollection/_git/MySolution然后单击“发布”（我必须这样做两次。）我现在可以提交到 TFS 并在线查看我的代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-11-11T14:27:39.703

我遇到过同样的问题。在 Publish 选项可用之前，我必须删除 .git/config 中的所有遥控器（不仅仅是 origin）。显然，微软认为你永远不会梦想使用不同的遥控器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-17T18:44:10.057

我发现它有助于开始一个新的解决方案并从那里逐步发布。

一旦它本身“困惑”，最好重新开始这个过程。我让它工作，从来没有编辑过那个文件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-07-23T08:44:45.187

我尝试了以上所有方法，但我可以让它工作的唯一方法是使用 git hub for windows。

要完成这项工作，您需要设置备用凭据。[https://tfs.visualstudio.com/en-us/home/news/2012/aug-27/](https://tfs.visualstudio.com/en-us/home/news/2012/aug-27/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-07-26T17:05:39.713

将现有的本地存储库提交到 TFS-Git：

*   在 TFS 中创建新项目。
*   使用 Git 扩展，选择要推送到 TFS 中的新项目的本地存储库。
*   选择推动箭头。
*   选择管理遥控器。
*   在 URL 中，输入 TFS 项目的位置：https://[您的站点名称].visualstudio.com/DefaultCollection/_git/[您的项目名称]
*   节省。是否要自动配置推送和拉取？（我说是。）
*   关闭。
*   选择远程下拉框 - 选择您刚刚保存的远程 URL。
*   推。

在 TFS 设置我的帐户时，我确实设置了备用凭据，但我不确定此过程是否需要它们。

我是 GIT 和 TFS 的新手，但这个过程允许我将两个解决方案推送到 TFS 中，每个解决方案都有三个项目。此外，在 Git Extensions 中，我发现我可以将本地存储库组织到类别中，这证明了一种将我的项目组织到他们的解决方案中的便捷方式。我也想在 TFS 中做同样的事情。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-12-18T04:07:14.387

我今天遇到了同样的问题，我不明白为什么这个“发布到...”菜单没有出现。我发现这是因为您必须将一个在线存储库映射到本地存储库，仅此而已。

在您的示例中，Gittyup online 似乎已经映射到本地 Gittyup，因此您必须在 Web 界面中创建一个新的 Git 项目，然后在 VS 中连接到它，然后您可以将本地存储库发布到在线存储库。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-11-12T17:08:24.017

在 Team Explorer 窗口中，在 Local Git Repositories 下找到您的存储库。右键单击要更改的选项并选择打开命令提示符。现在输入`git remote -v`，它应该会显示远程名称和完整的 url。类型`git remote remove origin`假设 origin 是您的远程存储库的名称。然后`git remote add origin [url]`将 [url] 替换为存储库的实际 url。

现在您应该能够将您的主分支推送到您的团队项目的存储库中。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-01-16T15:03:49.960

我可以确认其他答案，即 GIT 存储库不能列出任何遥控器，否则 VS13 不会将其添加到团队项目中。我正在使用 Atlassian 工具 Stash / Bitbucket / SourceTree，一旦我关闭 VS13，删除所有遥控器，重新打开 VS13，打开团队项目，然后右键单击我的本地 GIT 存储库。“发布到 {teamProject}”选项可用，然后通过打开团队项目可以使用 .sln。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-06-10T22:18:00.877

同样的问题，除了编辑 git 配置文件，只需删除项目的整个 git 存储库文件夹即可。重新加载项目并从文件下的源代码操作重新开始。然后将项目的所有更改添加到本地 Git。然后“同步”，它将显示 url 文本框。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-02-11T04:14:36.290

在 VSTS/GitHub/somewhere 中创建项目，然后从 Git Bash...

> git remote add origin [https://xxx.somewhere.com/_git/xxxProjectNamexxx](https://xxx.somewhere.com/_git/xxxProjectNamexxx)
> git push -u origin --all

# javascript - 从浏览器上传图片到 Amazon S3 的问题

> ID：14711797
> 
> 赞同：0
> 
> 时间：2013-02-05T16:08:06.030
> 
> 标签：javascript, amazon-s3, cross-browser, xmlhttprequest

最近我在浏览器中实现了从 javascript 将图像上传到 Amazon S3。我只专注于 FireFox、Chrome 和 IE。

最后我还没有设法为 IE 实现它 - 任何版本（甚至 10）。

用**例**是这样的：

1.  选择本地图像文件
2.  将文件大小、mime 内容类型和文件名发送到云中的服务器。
3.  从图像文件中制作base64缩略图
4.  云中的服务器进行签名并将所有重要数据和网址发送给我以供上传
5.  获取数据并形成 xhr:XMLHttpRequest 对象
6.  使用“POST”方法，通过“multipart/form-data”请求上传文件，同时使用提供的数据（acl、key、Content-Type、AWSAccessKey、签名、策略和文件）

另一个重要的事情是浏览器的定位协议是https。

**问题：** 我遇到了几个问题，主要是在 IE 上。

1.  在 IE<10 中无法读取文件的大小、mime 类型或本地路径。
2.  IE<10 无法读取本地文件内容以创建 base64。
3.  IE 10 可以做这些事情（1 和 2）但是 xhr.open("POST",url,true) 有问题 - 当 url 以 http:// 开头时它崩溃（浏览器从[https://something调用它.com/more/stuff](https://something.com/more/stuff)）

    3.1。如果浏览器在http上它可以工作。

    3.2\. 如果对以 https:// 开头的 url 调用 POST 请求，它不会崩溃，但无法上传 3.2.1。与 3.2 相同的情况发生在 FireFox

**不可接受的解决方案：**

1.  当浏览器和目标网址以 http:// 开头时，一切正常
2.  使用 Flash 插件

如果该解决方案支持旧版浏览器，那将非常非常好，如果它支持 IE9+，那将非常好，如果只支持 IE10 就可以了。当然 FF 和 Chrome 也应该使用它。

以下是部分代码有效，但存在问题（问题 3）：

```
function sendFile(putFields){
var xhr = new getXHRObject(); // returns new XMLHttpRequest object.
var url = 'http://'+putFields.bucket+"."+putFields.host+"/";
xhr.onreadystatechange=function(){
   if (http.readyState==4&&null!=http.status&&(http.status==200||http.status==201
        ||http.status==202||http.status==204||http.status==205||http.status==0)){
        alert('success!');
    }else if (http.readyState==4){
        alert('fail ');
    }
}

 var params={
        'acl':""+putFields.acl,
        'key':""+putFields.key,
        'Content-Type':putFields.contentType,
        'AWSAccessKeyId':putFields.awsAccessKeyId,
        'signature':putFields.signature,//encodeURIComponent()
        'policy':""+putFields.policy,
        'file':aFile
 };
 var fData = new FormData();

 for (var p in params)
     fData.append(p,params[p]);

xhr.open("POST", postUrl, true); // IE crashes here when https-->http is the case
setTimeout(function(){ xhr.send(fData);}, 100);
} 
```

我正在尝试为此寻找解决方案一段时间，但没有真正成功，请帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-05T07:43:24.147

如果有人仍然收到此错误，我发现添加 'contentType' 修复了它

```
$('.uploadAssets').ajaxForm( {
    dataType:               'json',
    contentType:            'application/json; charset=utf-8',//added this line and problem solved
    beforeSend:             beforeuploadAssetsPostForm,
    success:                uploadAssetsFormResponse,
    error:                  uploadAssetsError
}); 
```

# android - android列表项格式化

> ID：14711802
> 
> 赞同：1
> 
> 时间：2013-02-05T16:08:12.767
> 
> 标签：android, android-layout

我有一个带有 3 个视图的列表视图项 xml - 两个文本框和一个复选框。我需要始终显示第二个文本视图和复选框，即它们不能被裁剪或推离项目的末尾。

第一个 textview 有时包含一个长名称，这使得第二个 textview 太窄并将复选框推离列表项的末尾。第一个文本视图必须是椭圆的。

我试过使用 android:layout_weight 但这使得视图总是使用相同的宽度，这不是我想要的。例如，如果第二个文本视图不包含任何文本，我希望它完全折叠。

我尝试使用 wrap_content/fill_parent 的各种组合并在代码中执行操作，但似乎没有任何效果。我目前正在为它使用线性布局。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:23:10.943

您可以尝试使用[TableLayout](http://developer.android.com/reference/android/widget/TableLayout.html)，设置`shrinkColumns`为 0 和`stretchColumns`"1, 2"

这应该允许复选框和第二个文本视图占据所有可用位置，并根据需要缩小第一个文本视图

# visual-studio-2010 - Web 服务器找不到请求的资源 Visual Studio 调试

> ID：14711807
> 
> 赞同：10
> 
> 时间：2013-02-05T16:08:21.787
> 
> 标签：visual-studio-2010, visual-studio, visual-studio-2012, iis-7, visual-studio-debugging

## 问题

我有一个在 Visual Studio 2012 中运行的 .net 4.0 Web 应用程序，每次我去调试站点时都会收到以下错误：

> Web 服务器找不到请求的资源

* * *

## 我试过的

我已经关注了微软的网站并提供了解决方案：[msdn](http://msdn.microsoft.com/en-us/library/dwesw3ee.aspx)

> 1.  在命令提示符窗口中，运行以下命令：`systemroot\Microsoft.NET\Framework\ versionNumber \aspnet_regiis -i`
> 2.  我还尝试删除 .csproj.user 文件
> 3.  由于我们使用源代码控制，我删除了所有项目、站点和应用程序池，并从头开始重新配置。
> 4.  AppPool 设置为允许 32 位应用程序

一切都无济于事......任何人都有可能为我解决这个视觉工作室调试噩梦的解决方案？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-05T16:08:47.683

脚步：

1.  关闭 Visual Studio 中的所有解决方案
2.  打开 IIS7（运行 > inetmgr）
3.  单击您的顶部节点（计算机名称）
4.  打开“ISAPI 和 CGI​​ 限制”选项
5.  检查您的 .Net 版本是否有正确的限制（例如，如果您使用的是 4.0，则应该设置为“允许”）

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-02-16T18:23:15.803

当我从 IIS 运行 ASP.NET 项目时，我遇到了同样的错误。我通过配置 IIS 解决了这个问题。

1.  去跑步
2.  键入 appwiz.cpl 并按 Enter。
3.  查找“打开或关闭 Windows 功能”并单击它
4.  现在 Windows 将打开以打开或关闭 Windows 功能
5.  查找 Internet 信息服务并选择该选项。
6.  转到互联网信息服务部门下的万维网服务
7.  扩展应用程序开发功能
8.  选择所有 ASP 和 .net 版本。并单击确定。
9.  现在尝试从 asp.net 运行应用程序，它会工作 :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-27T22:16:04.060

我有相同的症状，但完全不同的问题。我曾尝试安装 Url Scan，但它似乎无法正常工作，因为我找不到 .ini 文件来编辑其中的设置。我忘记了我已经安装了它，但默认情况下它会阻止调试工作。

卸载 Url Scan 为我解决了这个问题。要卸载它，我必须右键单击 .msi 文件并选择卸载。网址扫描未显示在“添加或删除程序”部分下。

# mongodb - 选择不同的结果

> ID：14711808
> 
> 赞同：0
> 
> 时间：2013-02-05T16:08:21.677
> 
> 标签：mongodb, pymongo

我有这样的mongodb集合：

```
{
    "_id" : ObjectId("51111618b419e37023f5070c"),
    "checkCode" : "statusCode",
    "checkDate" : ISODate("2013-02-05T18:24:24.927Z"),
    "domain" : ObjectId("511102021ffae419c2363c33"),
    "pageUrl" : "/index.html",
    "checkResult" : "404"
} 
```

该集合可以有许多具有相同域、pageUrl、checkCode 但不同 checkResult（或相同）和不同 checkDate（检查日期）的记录。

所以我只需要在给定域中按 pageUrl 和 checkCode 选择最后一个日期 checkResult 。什么是最好和更快的方法（域和检查结果可能有很多记录）？我应该使用组还是映射/减少？不同的工作太慢了......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T09:03:27.687

您可以在这里使用聚合框架，如下所示：

```
db.col.aggregate([
    {$match:{domain: ObjectId("511102021ffae419c2363c33")}},
    {$sort:{checkDate:-1}},
    {$group: {_id: {pageUrl: '$pageUrl', checkCode: '$checkCode'}, checkResult: {$first: '$checkResult'}}}
]) 
```

将`$match`and`$sort`与`$first`运算符一起使用允许使用索引，这可以为至少大量记录创建一个高性能组。

# javascript - 将某些内容附加到链接 URL 的更简洁的方法是什么？

> ID：14711811
> 
> 赞同：3
> 
> 时间：2013-02-05T16:08:27.967
> 
> 标签：javascript, jquery, jquery-selectors, jquery-attributes

到目前为止，我已经得到了这段代码，但它不起作用：

```
$('.passName').click(function(){
    var schoolName = "18734";
    var link = $(this).attr('href');
    var newLink = link + schoolName;
    $(this).attr('href') = newLink;
}); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-05T16:09:48.757

请执行下列操作：

```
$(this).attr('href', newLink); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-05T16:13:38.533

您的方法存在问题：每次单击时都会将 schoolName 附加到 URL，即使用户定位到另一个选项卡也是如此。

所以我建议不要弄乱`href`属性，而是在 click 上执行操作：

```
 $('.passName').click(function(){
            location.href = this.href + "18734";
   }); 
```

或者至少检查你之前没有添加它：

```
 $('.passName').click(function(){
       var schoolName = "18734";
       var link = this.href;
       if (link.indexOf(schoolName, link.length - schoolName.length)!==-1) {
           this.href = link+schoolName
       }
   }); 
```

或者，正如 Felix Kling 所建议的那样，只需确保该函数只被调用一次：

```
 $('.passName').one('click', function(){
       this.href += "18734"
   }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T16:18:46.833

在简单中，这样做： -

```
$('.passName').click(function() {
    $(this).attr('href', this.href+'18734');
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T16:14:08.030

你实际上不需要创建一个新的 jQuery 对象，你可以简单地拥有：

```
$('.passName').click(function() {
   var schoolName = "18734";
   this.href += schoolName;
}); 
```

库和 jQuery 一样有用，但我们不应该忘记纯 JavaScript 和 DOM。

另外，在 JS 中，你不能真正“分配”一些东西给你所做的函数调用；在 jQuery 中设置属性值的方法是`$(this).attr('attr', newLink)`

# excel - 用户选择的打印范围

> ID：14711812
> 
> 赞同：3
> 
> 时间：2013-02-05T16:08:35.017
> 
> 标签：excel, vba, printing, range

我希望创建一个基本上可以像这样运行的模块：

1.  定义 4 或 5 个打印范围；
2.  提示用户输入框；
3.  允许用户从该输入框中的下拉列表中选择他们希望打印的范围；
4.  选择范围后，他们点击确定，并提示“您确定吗？” 框以防止误点击。

我对此相当迷茫，老实说，我觉得我一直在编写的代码将比仅仅阐明问题的帮助少。

我已经让用户定义范围（手动选择他们希望打印的列）来工作，但这不是我想要的。

更进一步，是否可以进一步自定义打印格式（横向与纵向和纸张类型）？

非常感谢您提前提供的帮助，我会尽力回答问题并提供我上面引用的代码示例（只是一个允许您选择列的提示。我需要它是一个定义的范围，按名称，`range1=a2:c14`或类似的东西，因为最终用户不是优秀的 excel 用户。

见下文：

```
Sub SelectPrintArea()
Dim PrintThis As Range
ActiveSheet.PageSetup.PrintArea = ""
Set PrintThis = Application.InputBox _
(Prompt:="Select the Print Range", Title:="Select", Type:=8)
PrintThis.Select
Selection.Name = "NewPrint"
ActiveSheet.PageSetup.PrintArea = "NewPrint"
ActiveSheet.PrintPreview
End Sub 
```

作为后续：

假设文档有隐藏部分，如果这些部分是用户定义范围的一部分（比如它是分组的一部分），是否能够取消隐藏这些部分。这适用于受保护的文档吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-17T00:05:29.070

为了向用户显示名称列表，您需要一个类似于以下内容的 UserForm：

[![在此处输入图像描述](../Images/2dc6cb2b43404e33e6dafc6245f41244.png)](https://i.stack.imgur.com/lPosb.png)

该表单背后的代码如下所示。我使用打印预览来支持“你确定”消息，因为它是一个更优雅的用户体验。

```
Option Explicit

Private Sub UserForm_Initialize()

  With Me.cboPrintAreas
    .MatchRequired = True
    'Add named ranges to the listbox
    .AddItem "Report_1"
    .AddItem "Report_2"
    .AddItem "Report_3"
    .AddItem "Report_4"
    .AddItem "Report_5"

    'Set the default report
    .Value = "Report_1"
  End With

End Sub

Private Sub btnCancel_Click()
  Unload Me
End Sub

Private Sub btnPrint_Click()

    Dim rng As Range

    Set rng = Range(Me.cboPrintAreas.Value)

    With rng.Worksheet
      'Do a crude assignment of paper orientation
      If rng.Height > rng.Width Then
      .PageSetup.Orientation = xlPortrait
      Else
        .PageSetup.Orientation = xlLandscape
      End If
      .PageSetup.PrintArea = rng.Address
      Me.Hide
      .PrintOut Preview:=True, IgnorePrintAreas:=False
      Unload Me
    End With

End Sub 
```

您将使用以下代码显示来自标准模块的表单：

```
Sub test()

  UserForm1.Show

End Sub 
```

如果要取消隐藏隐藏的行/列，则需要确保该范围的工作表适当地不受保护。

# c# - X12 实现 270、271 资格验证请求

> ID：14711813
> 
> 赞同：1
> 
> 时间：2013-02-05T16:08:39.463
> 
> 标签：c#, x12

我们正在为我们的应用程序使用 .net framework 4.0。

我将简要介绍一下我在这里要做什么。我的申请需要向美国大多数州提交医疗补助资格申请。

用户填写具有验证状态字段的资格请求表270。根据验证状态字段，我们决定将其发送到哪个状态。我们通过 Web HTTP POST 或 ftp 向各州提交请求 270。这取决于国家。我们也有他们的用户名，各个州的密码。我们在发出 HTTP 请求时需要这些。每个状态都有自己的要提交的 URL。

问题：存储所有这些 URL 的好地方是什么。App.config 可能会变得过于笨拙。还是数据库？

我将如何为这个特定的应用程序做一个 web 服务或 WCF。这将是我的第一个 Web 服务或 WCF（如果我需要的话）。

感谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-14T20:43:33.773

我认为数据库将是最好的。部分原因是它可能会很快增长。CAQH CORE [http://www.caqh.org/pdf/CLEAN5010/270-v5010.pdf](http://www.caqh.org/pdf/CLEAN5010/270-v5010.pdf)受《行政简化法案》的强制要求，您可能可以拥有一项网络服务来完成大部分工作，但医疗补助因州而异，并且通常预算足够低，以至于您不能指望他们与标准保持同步。因此，您可能希望数据库告诉您两件事：将它发送到哪个 URL，以及通过哪个 Web 服务发送它。随着项目的进展，这个数字可能会增加。

# sql - 使用 BULK INSERT 时忽略某些列

> ID：14711814
> 
> 赞同：14
> 
> 时间：2013-02-05T16:08:44.857
> 
> 标签：sql, sql-server, sql-server-2008, tsql, bulkinsert

我有一个逗号分隔的文本文件，其结构

```
field1   field2   field3   field4
1        2        3        4 
```

我编写了以下脚本来批量插入文本文件，但我想省略第 3 列

```
create table test (field1 varchar(50),field2 varchar(50),field4 varchar(50))
go
bulk insert test
from 'c:\myFilePath'
with 
(fieldterminator=',',
rowterminator='\n'
) 
```

插入工作正常，但插入的结果使 field4 看起来像 field3,field4，所以字段 3 实际上只是连接到 field4 上。我正在使用的平面文件是几个演出，不能轻易修改。有没有办法使用批量插入，但它忽略未在 create table 语句中声明的列？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-04-17T10:42:45.050

最简单的方法是创建一个只包含您需要的列的视图。

然后批量插入该视图。

例子：

```
create table people (name varchar(20) not null, dob date null, sex char(1) null)

--If you are importing only name from list of names in names.txt

create view vwNames as
select name from people

bulk insert 'names.txt' 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-05T16:19:04.857

您可以使用格式文件来执行此操作：

[http://msdn.microsoft.com/en-gb/library/ms178129.aspx](http://msdn.microsoft.com/en-gb/library/ms178129.aspx)

[http://msdn.microsoft.com/en-gb/library/ms179250.aspx](http://msdn.microsoft.com/en-gb/library/ms179250.aspx)

或者，如果您想要一种稍微厚颜无耻的方式，只需将其全部导入并在之后删除一列。;)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-24T18:22:15.173

在进行批量插入时，您不能忽略一个字段，而是这样做..加载所有 4 列并删除您不想要的列

```
create table test (field1 varchar(50),field2 varchar(50), field3 varchar(50),field4 varchar(50))
go
bulk insert test
from 'c:\myFilePath'
with 
(fieldterminator=',',
rowterminator='\n'
)

ALTER TABLE test DROP column [field3] 
```

# mongodb - 仅返回 mongo 投影中的数组值

> ID：14711816
> 
> 赞同：7
> 
> 时间：2013-02-05T16:08:52.350
> 
> 标签：mongodb

有没有办法只返回 mongodb 投影中的属性值？例如，我有一个文档，该文档具有一个值为数组的属性。我希望查询的返回对象只是数组，而不是`property: [ .. ]`. 例子：

文档：

```
db.test.insert({ name: "Andrew",
   attributes: [ { title: "Happy"},
                 { title: "Sad" }
               ]
}); 
```

询问：

```
db.test.find({name: "Andrew"},{attributes:1, "_id":0}); 
```

返回：

```
{ "attributes" : [ { "title" : "Happy" }, { "title" : "Sad" } ] } 
```

我希望它返回数组：

```
[ { title: "Happy"},
  { title: "Sad" }
] 
```

有没有办法做到这一点？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T20:22:40.383

JSON 不允许顶层是数组，因此普通查询不允许这样做。但是，您可以使用聚合框架执行此操作：

```
> db.test.remove();
> db.test.insert({ name: "Andrew", attributes: [ { title: "Happy"}, { title: "Sad" } ] });
> foo = db.test.aggregate( { $match: { name: "Andrew" } }, { $unwind: "$attributes" }, { $project: { _id: 0, title: "$attributes.title" } } );
{
    "result" : [
        {
            "title" : "Happy"
        },
        {
            "title" : "Sad"
        }
    ],
    "ok" : 1
}
> foo.result
[ { "title" : "Happy" }, { "title" : "Sad" } ] 
```

但是，这不会创建 find 所做的游标对象。

# objective-c - UIAlertView 显示两次

> ID：14711829
> 
> 赞同：0
> 
> 时间：2013-02-05T16:09:43.673
> 
> 标签：objective-c, cocoa-touch, ios5

我有一个应用程序，它部分循环遍历 NSSet 的内容，并为集合中找到的每个项目显示 UIAlertView。当集合中只有一个项目时，UIAlertView 会正常运行。但是，如果有多个，第一个视图会闪现（通常显示集合中最后一项的内容），然后在没有任何用户干预的情况下消失。然后将显示 NSSet 中的第一项并等待响应，然后再显示 NSSet 中的下一项，依此类推。

这与这个未解决的问题中描述的体验相同：[IPHONE: UIAlertView 在自定义函数/IBAction 中调用了两次](https://stackoverflow.com/questions/4483410/iphone-uialertview-called-twice-in-a-custom-function-ibaction)

这是代码：

```
#import "CalcViewController.h"

@interface CalcViewController()
@property (nonatomic) int variablesCount;
@property (nonatomic, strong) NSMutableDictionary *variablesSet;
@end

@implementation CalcViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    self.variablesSet = [[NSMutableDictionary alloc] init];
}

- (IBAction)variablePressed:(UIButton *)sender
{
    [[self calcModel] setVariableAsOperand:sender.titleLabel.text];
    self.expressionDisplay.text = [[self calcModel] descriptionOfExpression:self.calcModel.expression];
}

- (IBAction)solveExpressionPressed:(UIButton *)sender {
    self.variablesCount = 0;
    [self.variablesSet removeAllObjects];

    NSSet *variablesCurrentlyInExpression = [[NSSet alloc] initWithSet:[CalcModel variablesInExpression:self.calcModel.expression]];
    self.variablesCount = [variablesCurrentlyInExpression count];

    if (variablesCurrentlyInExpression){
        for (NSString *item in variablesCurrentlyInExpression) {
            UIAlertView *alertDialog;
            alertDialog = [[UIAlertView alloc] initWithTitle:@"Enter value for variable"
                                                message:item
                                                delegate:self
                                                cancelButtonTitle:@"OK"
                                                otherButtonTitles:nil];

            alertDialog.alertViewStyle=UIAlertViewStylePlainTextInput;
            UITextField * alertTextField = [alertDialog textFieldAtIndex:0];
            alertTextField.keyboardType = UIKeyboardTypeNumbersAndPunctuation;
            [alertDialog show];
        }

    }
}

- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex{
      if (buttonIndex == 0){
        if ([[alertView textFieldAtIndex:0] text]){         
            self.variablesSet[alertView.message] = [[alertView textFieldAtIndex:0] text];
        }
    }

    if ([self.variablesSet count] == self.variablesCount){
        NSLog(@"time to solve");
        [[self calcDisplay] setText:[NSString stringWithFormat:@"%g", [CalcModel evaluateExpression:self.calcModel.expression usingVariableValues:self.variablesSet]]];
    }
} 
```

我检查了触发solveExpressionPressed方法的按钮后面的IBActions，这是唯一存在的。我还在 [alertDialog show] 之前放置了一些日志记录；当 variablesCurrentlyInExpression NSSet 包含两个值时，它仅被调用两次，但 UIAlertView 出现了 3 次（闪烁一次）。

最后，我在没有以下代码的情况下尝试了它：

```
 UITextField * alertTextField = [alertDialog textFieldAtIndex:0];
            alertTextField.keyboardType = UIKeyboardTypeNumbersAndPunctuation; 
```

并且问题仍然存在，所以我不认为是那样。

我已经坚持了一段时间，还没有弄清楚（因此发帖！！），所以任何帮助都将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:42:45.417

尝试显示第一个 UIAlertView，然后在第一个被关闭后显示第二个。

发生的情况是，如果应用程序或操作系统调用 [alert show] 并且 UIAlertView 已经被显示，则原始的 alertView 被放入队列中并呈现新的。当新的被关闭时，原来的 UIAlertView 会重新显示。

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T16:51:29.750

使用布尔标志轻松修复，当显示第一个警报时将其设置为 YES。然后，当找到第二个匹配项并且布尔值已经是 YES 因为警报可见时，您将不会显示它。然后你可能想知道 NSSet 中匹配的确切数量。在这种情况下，您使用计数器跟踪并在匹配功能完成且计数器不为 0 后显示警报。

避免在按钮触发器的方法中显示警报。而是将每个函数拆分为不同的方法集。不仅是为了使您的功能正常工作，而且是为了以后代码的可维护性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T17:00:23.433

为了完成这件事，你需要在课堂上保留一些额外的状态，就像这样......

```
@property (strong, nonatomic) NSMutableSet *promptVariables;
@property (strong, nonatomic) NSString *promptVariable;
@property (strong, nonatomic) NSMutableDictionary *promptResults; 
```

您可以通过在模型中保留一些原样（或者像您目前巧妙地在警报视图消息中隐藏一点）来减少损失，但为了清楚起见，我将使用所有新变量。

当您想发出多个提示时，请像这样设置您的状态...

```
self.promptVariables = [[NSSet alloc] initWithSet:[CalcModel variablesInExpression:self.calcModel.expression]];
[self promptForVariables]; 
```

如果没有工作要做（promptVariables 为空），则定义 promptForVariables 以保释，或者删除一个并为其发出警报。

```
- (void)promptForVariables {

    if (![self.promptVariables count]) return;
    self.promptResults = [NSMutableDictionary dictionary];

    self.promptVariable = [self.promptVariables anyObject];
    [self.promptVariables removeObject:self.promptVariable];

    // do your alert here, I won't repeat your code
} 
```

然后在警报完成后，按您的方式处理结果并再次调用 promptForVariables。下一次，因为你已经改变了状态，它有更少的工作要做。

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex{
      if (buttonIndex == 0){
        if ([[alertView textFieldAtIndex:0] text]){         
            [self.promptResults setValue:[[alertView textFieldAtIndex:0] text] forKey:self.promptVariable];
        }
        [self performSelector:@selector(promptForVariables) withObject:nil afterDelay:0.0];
    }
} 
```

完成后，promptResults 将包含变量名称作为键和用户输入作为值。

# .net - Microsoft 模拟和模拟 SqlConnection 以进行集成测试

> ID：14711831
> 
> 赞同：2
> 
> 时间：2013-02-05T16:09:49.477
> 
> 标签：.net, web-services, testing, integration-testing, microsoft-fakes

我有各种相互通信的 Web 服务，有时会进行数据库调用，有些会与消息队列通信，但我希望能够在不实际调用数据库的情况下测试彼此交互的服务。

有没有一种方法可以让我执行集成测试，而无需实际触及系统的外围，即数据库和消息队列。

我们的 Web 服务和数据库在编写时没有考虑 DI 或可测试性，因此在服务中创建虚假实现并不是一个真正的选择。我已经看到了 Microsoft Mocks 库，它创建了伪造的程序集版本，看起来很有希望。

有没有办法使用微软的假货来实现这一点？我们能否以某种方式让服务调用虚假的 SqlConnection 并模拟数据库调用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:25:45.090

如果您无法使用依赖注入，您可以尝试模拟数据库层的某些组件

我建议看看存储库模式

[http://www.codeproject.com/Articles/526874/Repositorypluspattern-2cplusdoneplusright](http://www.codeproject.com/Articles/526874/Repositorypluspattern-2cplusdoneplusright)

并尝试分离和抽象所有 DB 模型，因此在您可以使用诸如 RhinoMocks 之类的模拟框架模拟所有这些类之后

# java - Java 到 JSON 与 cxf JSONProvider

> ID：14711836
> 
> 赞同：1
> 
> 时间：2013-02-05T16:10:08.433
> 
> 标签：java, json, cxf

我需要将使用 CXF 从 WSDL 文件生成的对象转换`cxf-codegen-plugin`为 JSON 字符串。我不幸运找到任何解决方案。

据我所知：我创建了一个 CXF JSONProvider 的 Spring 配置：

```
<bean id="jsonProvider" class="org.apache.cxf.jaxrs.provider.json.JSONProvider">
    <property name="dropRootElement" value="true"/>
    <property name="dropCollectionWrapperElement" value="false"/>
    <property name="serializeAsArray" value="true"/>
    <property name="ignoreNamespaces" value="true"/>
</bean> 
```

将它注入到我的 bean 中，现在我正在尝试使用：

```
try {
    StringWriter writer = new StringWriter();

    jsonProvider.writeTo(
            evaluationType,
            EvaluationType.class,
            new Annotation[]{},
            MediaType.APPLICATION_JSON_TYPE,
            null,
            new StringOutputStream(writer));

    return writer.toString();
} catch (IOException e) {
    LOGGER.error("e", e);
    return "";
} 
```

问题是，我必须为这个方法提供什么样的注释？没有关于它的文档。我正进入（状态：

```
Caused by: com.sun.xml.bind.v2.runtime.IllegalAnnotationsException: 1 counts of IllegalAnnotationExceptions
com.company.test.evaluation.evaluation.EvaluationImpl$1 is a non-static inner class, and JAXB can't handle those.
    this problem is related to the following location:
        at com.company.test.evaluation.EvaluationImpl$1 
```

这`EvaluationImpl`是我在其中调用此方法的类。请建议我必须为此方法提供什么样的注释。或者也许还有其他使用**CXF JSONProvider**的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T08:34:01.273

我建议您使用 Jackson [ObjectMapper](http://fasterxml.github.com/jackson-databind/javadoc/2.0.0/com/fasterxml/jackson/databind/ObjectMapper.html)将您的 java 对象转换为`JSON`有很多配置 Jackson 的选项，`ObjectMapper`并且更易于使用。

# jquery - 如何使用 jquery 和 css 对齐动画菜单

> ID：14711851
> 
> 赞同：0
> 
> 时间：2013-02-05T16:10:56.040
> 
> 标签：jquery, html, css

我一直在尝试使用 CSS & jquery 制作一个水平滑出菜单。

问题： 1) CSS - 当悬停在选项上时（在这种情况下为“服务”），菜单的其余部分被按下。我不知道如何克服这一点。

2）我能做些什么来使菜单在活动选项上保持打开状态吗？即，如果用户单击“服务 1”，菜单将保持打开状态（完全滑出）。

我在 Stackoverflow 上看到了这个，它似乎和我描述的问题一样：http: [//dabblet.com/gist/3635623/f69409ee9ee7e6613b7ed098a6a82b6a5445ed07](http://dabblet.com/gist/3635623/f69409ee9ee7e6613b7ed098a6a82b6a5445ed07)

最后，我的jsfiddle：http: [//jsfiddle.net/LJ4tH/13/](http://jsfiddle.net/LJ4tH/13/)

HTML：

```
 <nav>
    <ul id="menu-nav">
    <li><a href="#">About Us</a></li>
    <li class="has-flyout"><a href="#">Services</a>
    <ul class="flyout">
    <li class="active"><a href="#">Service 1</a></li>
    <li><a href="#">Service 2</a></li>
    <li><a href="#">Service 3</a></li>
    </ul>
    </li>
    <li><a href="#">News</a></li>
    <li><a href="#">Contact us</a></li>
    <li><a href="#">Blog</a></li>
    </ul>
    </nav> 
```

查询：

```
(function navslider($) {
    $('.flyout').hide();
    $('.has-flyout').on({
        mouseenter: function() {
            $(this).find('ul.flyout').stop().animate({width: 'toggle'},1000);
        },
        mouseleave: function(){
            $(this).find('ul.flyout').stop().animate({width: 'toggle'},3000);
        }
     });
})(jQuery); 
```

CSS：

```
 nav li { display: inline-block; }
    /*li a:hover { margin-top:0px; }/*This doesn't seem to work*/
    .flyout { display: inline-block; white-space: nowrap; margin-top: 0px; }
    /*ul.flyout li.active { margin-top: 0px; }
    ul.flyout. li. a:hover { margin-top: 0px; }*/ 
```

谢谢

晶圆厂

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T20:25:34.243

你可以尝试这样的事情：

```
(function navslider($) {
    $('.flyout').hide();
    $('.has-flyout').on({
        mouseenter: function () {
            if ($(this).hasClass("active")) return;

            $(this).find('ul.flyout').stop().animate({width: 'toggle'}, 500);
        },
        mouseleave: function () {
            if ($(this).hasClass("active")) return;

            $(this).find('ul.flyout').stop().delay(500).animate({width: 'toggle'}, 500);
        },
        click: function () {
            $(this).toggleClass('active');
        }
    });
})(jQuery); 
```

[http://jsfiddle.net/LJ4tH/20/](http://jsfiddle.net/LJ4tH/20/)

没有看到项目被推下的问题，除非像 Dim3i 所说的那样，当文档不够宽时。

# c# - % 使用 Tweetsharp 登录 Twitter 帖子会导致 401 Unauthorized

> ID：14711853
> 
> 赞同：0
> 
> 时间：2013-02-05T16:11:02.223
> 
> 标签：c#, tweetsharp

我有一段简单的代码可以发送一条推文。保留带有 % 符号的消息会导致 401 Unauthorized 错误：

```
class Program
{
    static void Main(string[] args)
    {
        var test = new TwitterService("ConsumerKey", "ConsumerSecret", "Token", "TokenSecret");

        try
        {
            // "Test 1, So, I know there's no #inflation and so on...but the 10y inflation swap just went to 2.80%. 5y CPI 5y forward is 3.15%. Hmmm."
            test.SendTweet(WebUtility.HtmlEncode("Test 3, So, I know there's no #inflation and so on...but the 10y inflation swap just went to 2.80%. 5y CPI 5y forward is 3.15\. Hmmm."));
        }
        catch (Exception ex)
        {
            if (ex.Message.Equals(""))
            {

            }
        }
    }
} 
```

如果我通过 TweetDeck 或直接使用 Twitter 页面发送相同的消息，它会毫无问题地发布。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:49:56.560

看起来您必须使用 a`&#37;`而不是常规的 % 符号。

# php - MySQL 数据库未更新

> ID：14711855
> 
> 赞同：0
> 
> 时间：2013-02-05T16:11:15.120
> 
> 标签：php, mysql, passwords

（请忽略 md5 不是最安全的事实，mysql_* 功能已过时等 - 这不会在任何网站上上线！）

所以，我目前有一个系统，用户可以在其中进入恢复密码页面并输入他们的电子邮件。它会向他们发送一封电子邮件，其中包含恢复密码的链接。这个链接如下：

[http://www.example.com/recover_password.php?username=](http://www.example.com/recover_password.php?username=(USERNAME)（这里的用户名）&recover_password=（这里的代码）。

该代码是在注册时随机生成的，并且可以很好地存储在数据库中。但是，我在尝试让他们从上面的链接中更改它时遇到问题。这是recover_password.php 页面：

```
<?php
include 'core/init.php';

$username = (isset($_GET['username']));
$password_recovery = (isset($_GET['password_recovery']));

if (isset($_GET['success']) && empty($_GET['success'])) {
    echo 'Your password has been changed. You may now proceed to log in.';
    die();
} else {

if (password_recovery_exists($password_recovery) === true && (user_exists($username) === true)) {
    if (empty($_POST) === false) {
        $required_fields = array('password', 'password_again');
        foreach($_POST as $key=>$value) {
            if (empty($value) && in_array($key, $required_fields) === true) {
                $errors[] = 'You missed a field!';
                break 1;
            }
        }
            if (trim($_POST['password']) !== trim($_POST['password_again'])) {
                $errors[] = 'Your new passwords do not match';
            } else if (strlen($_POST['password']) < 6) {
                $errors[] = 'Your password must be at least 6 characters long.';
            }
        }
        if (empty($_POST) === false && empty($errors) === true) {
            password_recovery($username, $_POST['password']);
            header('Location: recover_password.php?success');
        }   else {
                echo output_errors($errors);
        }
    }
?>
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Liste - Login</title>
<link rel="stylesheet" type="text/css" href="css/style.css">
</head>
<body>
<form action="" method="post">          
        <label for="password"><b><center>New Password:</label><br >
        <input type="password" name="password" size="30"><br />

        <label for="password_again"><b><center>Re-enter New Password:</label><br >
        <input type="password" name="password_again" size="30"><br />

        <input type="submit" value="Change Password"><br /><br />
</form>
</center>
</body>
</html>

<?php
}
?> 
```

首先，最大的问题是当他们点击“更改密码”时没有显示错误信息，但是密码没有在数据库中更新，导致我认为密码恢复功能有问题：

```
function password_recovery($username, $password) {
    $username = sanitize($username);
    $password = md5($password);

    mysql_query("UPDATE `users` SET `password` = '$password' WHERE `username` = '$username'"); 
```

我不确定该函数是否存在问题，或者变量是否实际被发送或什么，因此将不胜感激:)

我还想知道检查“用户名”和“密码恢复”（来自链接）是否来自数据库中的同一行的语法是什么？

我知道这段代码是一团糟，过时等，但非常感谢您的帮助:)

多谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:21:33.193

这应该有效：

```
<?php
include 'core/init.php';

function password_recovery($username, $password) {
    $username = mysql_real_escape_string(sanitize($username));
    $password = md5($password);

    mysql_query("UPDATE `users` SET `password` = '" . $password . "' WHERE `username` = '" . $username . "'");
}

$username = (isset($_SESSION['username']) ? $_SESSION['username'] : false);
$password_recovery = (isset($_POST['password_recovery']) ? $_POST['password_recovery'] : false);

if (isset($_GET['success']) && empty($_GET['success'])) {
    echo 'Your password has been changed. You may now proceed to log in.';
    die();
} else {

    if (password_recovery_exists($password_recovery) === true && (user_exists($username) === true)) {
        if (empty($_POST) === false) {
            $required_fields = array('password', 'password_again');
            foreach ($_POST as $key => $value) {
                if (empty($value) && in_array($key, $required_fields) === true) {
                    $errors[] = 'You missed a field!';
                    break 1;
                }
            }
            if (trim($_POST['password']) !== trim($_POST['password_again'])) {
                $errors[] = 'Your new passwords do not match';
            } else if (strlen($_POST['password']) < 6) {
                $errors[] = 'Your password must be at least 6 characters long.';
            }
        }
        if (empty($_POST) === false && empty($errors) === true) {
            password_recovery($username, $_POST['password']);
            header('Location: recover_password.php?success');
        } else {
            echo output_errors($errors);
        }
    } else {
        die("User not found");
    }
}
?>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html;charset=utf-8">
        <title>Liste - Login</title>
        <link rel="stylesheet" type="text/css" href="css/style.css">
    </head>
    <body>
        <form action="" method="post">          
            <label for="password"><b><center>New Password:</label><br >
                        <input type="password" name="password" size="30"><br />

                        <label for="password_again"><b><center>Re-enter New Password:</label><br >
                                    <input type="password" name="password_again" size="30"><br />

                                    <input type="submit" value="Change Password"><br /><br />
                                    </form>
                                </center>
                                </body>
                                </html> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-05T16:16:55.323

尝试这样的事情：

```
mysql_query("UPDATE `users` SET `password` = '".$password."' WHERE `username` = '".$username."'"); 
```

# android - 在 Android 应用程序中使用下载的图像

> ID：14711857
> 
> 赞同：0
> 
> 时间：2013-02-05T16:11:16.790
> 
> 标签：android, image-processing

我想将 PDF 和图像下载到我的应用程序中，本质上它将调用一个 JSON Web 服务，该服务返回 PDF 的链接、图像的链接和标题。它将下载图像和 PDF 并保存它们。然后它将显示带有标题的 PDF 和图像。我唯一的问题是如何处理图像？它们无法保存到 APK，因为它已被锁定。这些图像的分辨率足够高，可以缩小以适应所有其他密度，我应该只使用大图像，并在使用它时让活动按比例缩小。或者我应该在检索过程中实施图像缩放器吗？

最终 PDF 和图像将被加载到 APK 中。我将如何检查资产文件夹以删除图像，我是否只需要调用在应用程序首先开始检查资产文件夹中的文件时运行的服务，然后如果它们存在则将其删除？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:41:16.933

示例代码供您参考，您可以从网络下载图像。将图像存储在资产文件夹中比内部存储器更好，并调整图像大小以获得良好的性能。您可以在调用 Web 服务之前删除文件夹并加载新的设置图像。

```
if (Utility.isWifiPresent()
                    || Utility.isMobileConnectionPresent()) {
                URL url = new URL(fileUrl);
                InputStream iStream = url.openConnection().getInputStream();// .read(data)
                ByteArrayOutputStream buffer = new ByteArrayOutputStream();
                byte[] tmpArray = new byte[1024];
                int nRead;
                while ((nRead = iStream.read(tmpArray, 0, tmpArray.length)) != -1) {
                    buffer.write(tmpArray, 0, nRead);
                }
                buffer.flush();
                data = buffer.toByteArray();
                FileOutputStream fOut = null;
        //path to store

                    fOut = Utility.getFileOutputStreamForCloud(
                            sdcardFolderPath, fileUrl);
                }
                fOut.write(data);
                fOut.flush();
                fOut.close(); 
```

# perl - 如何在所有文件上逐行运行时打印目录中的所有文件名

> ID：14711860
> 
> 赞同：0
> 
> 时间：2013-02-05T16:11:33.623
> 
> 标签：perl, filenames

我编写的程序逐行遍历目录和子目录中的所有文件，并执行一些命令，包括 $counter。我想制作一个 .txt 文件，每行如下所示：

```
<file name> <$counter in the beginning of the file> 
```

例如，如果我在文件 a 中有三个文件 a.txt 、 b.txt 和 c.txt ，则计数器在文件 b 中计数为 10，它计数为 20，在文件 c 中计数为 30，则文件如下所示：

```
a.txt 0
b.txt 10
c.txt 20 
```

我的程序如下所示：

```
use strict;
use warnings;
use File::Find;

my $dir = "C:/New Folder";   
open (MYFILE, '>>data.txt');

# fill up our argument list with file names:
find(sub { if (-f && /\.[c]$/) { push @ARGV, $File::Find::name } }, $dir);
$^I = ".bak";   # supply backup string to enable in-place edit  

foreach $argvv(@ARGV)
{
  while (<>) 
  {
     if ($prev_arg ne $argvv)
     {
       print MYFILE  "$argvv $counter\n";
       $prev_arg = $argvv;
     }   

     #some unrelated line by line code here
     close (MYFILE); 
  }
} 
```

我试图做的是让程序在每次完成一个文件并启动另一个文件时打印文件名和计数器。

我得到的 data.txt 文件是第一个文件的名称和为目录中每个文件的每一行打印的计数器。不用说我是 Perl 的菜鸟，所以我真的很感激一些帮助。

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:09:02.877

您的代码存在一些问题。

*   您正在使用`strict`and`warnings`但您尚未声明`$prev_arg`and `$argvv`。警告已告诉您有关它们的信息。
*   您永远不会打开文件进行阅读。相反，您尝试使用`-i`命令行开关和参数列表来读取`STDIN`. 这对我来说毫无意义。相反，您应该使用普通数组并一一打开文件。
*   您正在使用老式的裸字文件句柄和`open`. 相反，请使用词法文件句柄，因为它们不是全局的，而是只存在于它们周围的块中。使用三参数形式，`open`这样您就不会遇到安全问题。见[这里](http://modernperlbooks.com/mt/2010/04/three-arg-open-migrating-to-modern-perl.html)。

尝试这个：

```
use warnings;
use strict;
use File::Find;

my $dir = 'D:/temp';   

my @files;
find(
  sub {
    if (-f && /\.c.txt$/) {
      push @files, $File::Find::name }
    },
  $dir
);

open my $fh_out, '>>', 'data.txt'   # open the output filehandle
  or die $!; 
foreach my $file (@files) {         # iterate the file list
  open my $fh_in, '<', $file        # open the current file for reading
    or die $!; 
  my $counter = <$fh_in>;           # read the first line
  chomp $counter;                   # remove trailing linebreak
  close $fh_in; 
  print $fh_out "$file $counter\n"; # close the input filehandle (explicit)
}
close $fh_out;                      # close the output filehandle 
```

# python - 如何使用结构编辑主机名文件

> ID：14711861
> 
> 赞同：-3
> 
> 时间：2013-02-05T16:11:51.933
> 
> 标签：python, fabric

我已经更改了我的主机文件，所以如何更改主机名。我的系统是 ubuntu。例如我的主机文件：

```
192.168.0.100 host1.mydomain.com
192.168.0.101 host2.mydomain.com 
```

我想要host1的/etc/hostname下的hostname文件到host1.mydomain.com，host2的hostname文件到host2.mydomain.com

如何使用面料做到这一点？我必须对每个主机进行 ssh 并编辑主机名文件，fabric 可以这样做吗？

我不是要使用`hostname`命令，而是要编辑 /etc/hostname 文件。我的意思是如何使用织物来做到这一点：例如：

```
def update_hostname():
  get("/etc/hosts","hosts")
  hosts_content = file("hosts")
  **hostname = ·get the hostname corespond to ip·**
  get("/etc/hostname","hostname")
  update `hostname file`
  put("hostname","/etc/hostname") 
```

怎么获取ip？因为fabric在每台主机上都做这项工作，并且主机名对应于每台主机。我需要知道作业正在哪个主机工作，然后取回 ip，然后获取与 ip 对应的主机名，最后更新主机名文件。 ![在此处输入图像描述](../Images/2c50c12289829cbe8b13652abceada14.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-28T09:29:14.757

```
def hostname():

   '''
   function to change the hostname of the ubuntu server
   '''

   server_hostname = prompt ("The Hostname for the server is :")

   sed ("/etc/hostname", before='current hostname', after='%s' % (server_hostname), use_sudo=True,backup='')

   sudo ("init 6") 
```

这将根据您的选择更改主机名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T16:17:54.297

Fabric 只是一个 SSH 包装器，所以您正在查看的是 LINUX 特定的，而不是 frabric 或 python 特定的。

```
from fabric.api import run
run('hostname your-new-name')
run('echo your-new-hostname > /etc/hostname') 
```

并根据您的 linux dist 执行 run(..edit..) 吗？

或者只是这样做：

```
from subprocess import Popen, PIPE
hosts = open('/etc/networking/hosts', 'rb')
for hostline in hosts.readlines():
    ip, name = hostline.split(' ')
    command = ['ssh', '-t', 'root@' + host.strip('\r\n ,;), ' ', "echo " + name.strip('\r\n ,;) + " > /etc/hostname",]
    stdout, stderr = Popen(command, stdout=PIPE, stderr=PIPE).communicate()
hosts.close() 
```

**注意：** /etc/networking/hosts 可能会为您放置在其他地方。这里重要的部分是您遍历 /hosts 文件，然后通过 ssh 连接到每台机器，将给定的主机名回显到该机器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T17:05:03.570

在您的织物脚本中，您需要...

*   以允许编辑主机文件的用户身份 ssh 进入机器（通过权限或组）。如果您需要`sudo`进入用户，请在 StackOverflow 中搜索有关 sudo 和 Fabric 的问题——您需要调整您的 fabfile 以不提示输入密码。

*   织物可能有一种尴尬的方式来处理读/写/打开文件。您最好`cd`进入正确的目录。就像是...

    用 cd('/etc/') 运行('echo new_hostname hostname')

# c# - 我收到错误消息“视图状态 MAC 验证失败

> ID：14711865
> 
> 赞同：1
> 
> 时间：2013-02-05T16:11:55.027
> 
> 标签：c#, load-balancing

我们的设置是通过负载平衡的粘性会话进行的。当我只使用一台服务器时，我根本不会收到此错误。当我使用负载均衡器时，我偶尔会收到此错误。使用负载均衡器时如何消除此错误

我的配置文件说：

```
<machineKey validationKey='2EEA416CEFC6D6BE856ED57B97FB9CA7DFACE17C073125949A1D682C80A44BB2AD887DDDC13DBFB0954F1000FEE5757E99693F222F8E28CAA2E6DAB8C4F99E0C'
    decryptionKey='877478B2F33A74226ABEF55FDCC1A76E43F1BBEA6241A592'
    validation='SHA1' />
<pages enableViewStateMac="false">
    <controls>
        <add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add tagPrefix="asp" namespace="System.Web.UI.WebControls" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add namespace="AjaxControlToolkit" assembly="AjaxControlToolkit" tagPrefix="ajaxToolkit"/>
    </controls>
</pages> 
```

我已经用过`enableViewStateMac="false">`。此外，挑战是使用负载均衡器消除零星错误。我可以采取什么方法？

# ios - 在 iOS 上运行单元测试时如何排除代码路径？

> ID：14711870
> 
> 赞同：0
> 
> 时间：2013-02-05T16:12:16.067
> 
> 标签：ios, objective-c, unit-testing, ocunit

我有一些代码在从 ocunit 中的逻辑测试运行时会引发异常。我想忽略此代码并测试其余功能，而无需设置应用程序测试也不必分解方法。

例如：

```
-(void)testMethod {
    BOOL result = NO;
    UIFont * font = [UIFont systemFontOfSize:12]; //throws exception in ocunit
    ...
    return result;
} 
```

如何在排除 UIFont 创建的单元测试中调用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T14:54:22.307

将 UIFont 调用包装在 if 块中，并使用 NSClassFromString 动态加载 SenTestCase 类。

例子：

```
-(void)testMethod {
    BOOL result = NO;
    if(!NSClassFromString(@"SenTestCase")) {
        UIFont * font = [UIFont systemFontOfSize:12]; //throws exception in ocunit
    }
    ...
    return result;
} 
```

# java - 从字符串解析日期返回错误的时间

> ID：14711874
> 
> 赞同：1
> 
> 时间：2013-02-05T16:12:31.923
> 
> 标签：java

运行以下代码：

```
String s = "1914-07-20T00:00:00+0200";
SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssZ");
System.out.println(df.parse( s )); 
```

我得到这个结果：

> Sun Jul **19** 23:34:52 EET 1914（注意日期和时间）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T16:17:58.210

这可能是为了让太阳在中午出现在头顶上而进行的时间调整之一。这些发生在那个时候，因为世界变得越来越小，当地时区被更普遍的时区所取代。25分钟很可能是这样的调整。您将不得不查看从那时到现在的东欧时区调整记录。

检查这一点的另一种方法是将它放在一个循环中，看看它在 1924 年和 1934 年正常工作，依此类推直到现在。在某个时候，如果它进行了这样的调整，它可能会开始工作，您可以将其缩小到一个特定的时间，在该时间下班后的所有时间和之前的所有时间都没有。不过，可以肯定的是，可能会有一系列调整。这里10分钟和那里7分钟加起来25分钟。

*笔记*

此页面 ( [http://www.prokerala.com/travel/timezones/EET?mode=history](http://www.prokerala.com/travel/timezones/EET?mode=history) ) 显示 1901 年 1.64444 和 1920 年 2 的 GMT 偏移量。即 39:52 分和秒。

此页面（[http://home.tiscali.nl/~t876506/TZworld.html](http://home.tiscali.nl/~t876506/TZworld.html)）是关于全球 tz 数据库的，显示欧洲/雅典的 LMT（本地平均时间）为 1:34:52，理论上应该+2:00。我不太确定这与它有什么关系，但正是 OP 所看到的似乎是一个奇怪的巧合。（我还发现 joda-time 使用“官方”时区数据文件中第一个条目之前的任何日期的 LMT 偏移量。

# jsp - 使用 JSP 中的 where 从数据库中检索数据

> ID：14711876
> 
> 赞同：0
> 
> 时间：2013-02-05T16:12:33.117
> 
> 标签：jsp, select

有人可以帮助我吗？

我有一个jsp页面。因为我想从用户名匹配的数据库中获取数据。我尝试过这个。但无法获得输出。这是代码。请帮我。所有数据库连接都正常。错误显示在“WHERE”中。它说 SQL 语法不正确

```
<html>
   .....
<body>
 <%
      //table name is "register" have Name and Username filed.
      String uname=request.getParameter("username");
      String sql;
      sql="SELECT * FROM register WHERE Username="+uname+"";
      ResultSet rs=stmt.executeQuery(sql);
      while(rs.next())
                    {
      %>          

   NAME: <%=rs.getString(1)%> 
   USERNAME: <%=rs.getString(2)%> 

       <%        
                }
         %> 

   </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:19:31.283

尝试

```
 sql="SELECT * FROM register WHERE Username= '"+uname+"'"; 
```

您可能还需要考虑首先在您的数据库控制台中运行查询来解决这样的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T05:49:02.703

查询没有问题。

要检查这一点，请转到您正在使用的 mysql 工具或命令提示符

通过热编码某些值来使用相同的语法，例如

SELECT * FROM **databasename.register** WHERE Username="vector" 。如果它有效，那么

例外可能是由于其他三个原因

查看

1.  数据库名称
2.  表名
3.  字段名称

如果它不起作用，请告诉我。

# java - RXTX 通讯。从流 []byte 读取期间不正确的 Eclipse 行为

> ID：14711880
> 
> 赞同：0
> 
> 时间：2013-02-05T16:12:49.613
> 
> 标签：java, eclipse, rxtx

我正在创建使用 RXTXComm 库读取/写入 com 端口的应用程序。当我试图从流中读取一个字节时，一切都很好。

```
while ( ( data = in.read() ) > -1 ) 
```

然后我尝试读取 []byte 并将断点放在这一行：

```
int g = in.read(buffer,off,len); 
```

当调试到达这个地方并且我恢复调试时 - 出现带有如下消息的新窗口：

```
Class File Editor

Source not found
----------------------
The JAR file c:\pro\RXTXcom.jar has no source attachment.
You can attach the source by clicking Attach Source below: 
```

问题是什么？这也不例外，因为我无法在 try-except 块中捕获它。这是什么？我没有要求“追踪”，也不需要来源。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:44:29.427

似乎您的 IDE（您没有命名）告诉您它正在尝试显示 RXTXcom 库中的一行，但它没有可用于执行此操作的源代码。如果我使用的是 eclipse，我会期望这个，只有二进制的库副本，在调试器中打开异常检查，并且库抛出异常。

我不认识“恢复调试 - 新窗口”，所以我不知道这可能会产生什么影响。

Eclipse 在其调试器中有一个“跳出”功能，允许您单步执行下一个返回语句；这可能会帮助您达到您确实有资源的水平。

我怀疑这条消息与您实际的 1 字节与字节数组读取问题有很大关系。

# ruby - 在正则表达式中使用哈希 - 无法将正则表达式转换为整数

> ID：14711881
> 
> 赞同：0
> 
> 时间：2013-02-05T16:12:51.600
> 
> 标签：ruby, regex, hash, rake

我有一个非常简单的 rake 任务，并且可以按我的预期工作。

```
 task :qualify => :environment do
 require 'classifier'
 # encoding: utf-8
 test = Skirt.where(:asin => "B007O9MXF0")
 w = %w{ rayon wool cotton polyester nylon spandex}  
a = test.first.content
b = test.first.title
c = a + b
w.each do |w|
    if c[/#{w}/]
        c = w
    else
        c
    end
end     

good ={}
skirt = Skirt.where(:quality => "Good")
skirt.each do |f|
    good[f.content] = [f.quality]   
end

bad = {}
skirt = Skirt.where(:quality => "Bad")
skirt.each do |f|
    bad[f.content] = [f.quality]    
end
classifier = Classifier::Bayes.new('Good', 'Bad')

good.each {|good| classifier.train_good "Good"}
bad.each {|bad| classifier.train_bad "Bad"}

puts classifier.classify(a), 
        c,
        test.first.color,
        a+b
    end 
```

现在我试图让一些更复杂的东西，但是使用完全相同的想法并且它不起作用。参见下面的代码： desc "Import details" task :import_clean => :environment do

```
 require 'sucker'
       require 'mechanize'
       require 'nokogiri'
       require 'open-uri'
       require 'carrierwave'
       require 'rmagick'
       require 'csv'
       # encoding: utf-8

          skirt = Skirt.where(:quality => "Good")
good = {}   
skirt_type = ""

skirt.each do |f|
    content_title = f.content + f.title
    good[content_title] = [f.quality]   
end

bad = {}
skirt = Skirt.where(:quality => "Bad")
skirt.each do |f|
    content_title = f.content + f.title
    bad[content_title] = [f.quality]    
end
classifier = Classifier::Bayes.new('Good', 'Bad')

good.each {|good| classifier.train_good "Good"}

bad.each {|bad| classifier.train_bad "Bad"}

request = Sucker.new(
    :associate_tag => 'thenewoutpro-20',  
    :key    => 'AKIAJXNLXYCBU3NJAIJQ',
    :secret => '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',
    :locale => :us)

    request << {
         "Operation"     => "ItemSearch",
         "SearchIndex"   => "Apparel",
         "Keywords"      => ["women", "skirt"], 
         "ResponseGroup" => ["BrowseNodes"] }

        rep = request.get

         url = "#{rep.find('MoreSearchResultsUrl')}"
         new_url = url[2, url.length-4]

         agent = Mechanize.new
         agent.get(new_url)

i = (0..47)

    i.each do |i|

        b = "#{i}"
        item = "#result_" + b
        doc = agent.page.search(item)
        link = doc.css("a")[0]["href"]
        asin = link[-10,10]
        request2 = Sucker.new(
                        :associate_tag => 'thenewoutpro-20',  
                        :key    => 'KEY',
                        :secret => 'SECRET',
                        :locale => :us)     
        request2 << {
                    "Operation"     => "ItemLookup",
                    "IdType"        => "ASIN",
                    "ItemId"        => asin,
                    "ResponseGroup" => ["Large"] }

            response = request2.get
            images = response.find('LargeImage').first.to_a
            image_new = images[0].to_s
            image = image_new[8, image_new.length-9]
            color_string = response.find('Color')
            color = color_string[6, color_string.length]
            brand_string = response.find('Manufacturer')
            brand = brand_string[5, brand_string.length]
            content = response.find('Content')
            title = response.find('Title')
            combined = content + title
            f = %w{ polyester rayon nylon cotton silk chiffon wool knit jersey viscose corduroy velvet lace }
            s = %w{ pencil A-line mini maxi long pleated panel }
            p = %w{ pettite 'plus size' maternity }             

            f.each do |f|
                if combined[/#{f}/]
                    fabric = f
                    else
                    fabric = ""
                end
            end
            s.each do |s|
                a = combined[/#{s}/]
                if a > 0
                skirt_type = s              
                else
                skirt_type = ""
                end
            end
            p.each do |p|
                if combined[/#{p}/]
                    size = p
                else
                    size = "Regular"    
                end
            end

            quality = classifier.classify(combined)             

            Bottom.create!(          
                                        :asin => asin,
                                        :title => response.find('Title'),
                                        :price => response.find('FormattedPrice'),
                                :manufacturer => brand,
                                :content => response.find('Content'),
                                :color => color,
                                :fabric => fabric,
                                :size => size,
                                :skirt_type => skirt_type, 
                                :images => image,
                                :link => link)

    end
       end
     end 
```

当我尝试运行 rake 时出现以下错误：rake aborted！无法将正则表达式转换为整数

我不明白的部分是代码的同一部分（使用正则表达式中的哈希在数组上运行）在 rake 任务上运行良好：qualify。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:52:00.033

> 组合 = (内容 + 标题).to_s

in `combined[regex]`，如果`combined`不是字符串，Ruby 认为您正在访问一个数组，因此期望正则表达式是一个整数......

# java - 请求DNS服务器记录并检查权威性

> ID：14711887
> 
> 赞同：0
> 
> 时间：2013-02-05T16:13:06.573
> 
> 标签：java, dns, dnsjava

我如何询问 google.com 域的 DNS 服务器，例如 8.8.8.8？在这个[http://www.xbill.org/dnsjava/dnsjava-current/examples.html](http://www.xbill.org/dnsjava/dnsjava-current/examples.html)页面上是示例如何发送指定域的请求，但如何询问具体服务器并检查答案是否权威？我可以使用 dnsjava 或其他 Java lib

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-27T14:59:20.927

要向特定服务器发出请求，您可以使用配置了 org.xbill.DNS.SimpleResolver 的 dnsjava：

```
 Resolver resolver = new SimpleResolver("10.233.104.38");
    Lookup lookup = new Lookup("google.com", Type.A);
    lookup.setResolver(resolver);
    Record[] records = lookup.run();
    String address = ((ARecord) records[0]).getAddress().toString();
    System.out.println(address); 
```

# c# - 如果我附加一个已附加在 EF 中的实体会怎样？

> ID：14711890
> 
> 赞同：3
> 
> 时间：2013-02-05T16:13:18.053
> 
> 标签：c#, entity-framework

我将一些保存`EF entities`在我编写的缓存层中。当我从缓存中检索它们时，有时会收到“contextObject is disposed”错误。`contextObject`从缓存中获取实体后，我想附加一个新的。这会导致什么副作用？如果我附加一个已经附加的实体会发生什么？表现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:27:32.013

异常“ **ObjectStateManager 中已存在具有相同键的对象。ObjectStateManager 无法跟踪具有相同键的多个对象**。”

请参阅 Context.DbSet.Local() 方法以获取 Context 中的所有对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T16:36:45.447

试试这样。

```
ObjectStateEntry entry;
    if(context.ObjectStateManager.TryGetObjectStateEntry(entity, out entry)) {
        return (entry.State != EntityState.Detached);
    } 
```

也检查这个答案。[附加到数据上下文的实体](https://stackoverflow.com/questions/1715501/is-is-possible-to-check-if-an-object-is-already-attached-to-a-data-context-in-en)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:23:10.687

它将抛出一个异常（不确定是哪个），因为该对象已经附加。

只需在代码中尝试一下，尝试起来非常简单。它发生在我身上。

顺便说一句，您应该在结束使用 contextobject 后立即处理它。如果不这样做，您会得到一些奇怪的行为（对象未更新，直接在 db 中修改的缓存对象不反映更改等）。

问候。

# android - 滑动菜单上的奇怪偏移行为

> ID：14711892
> 
> 赞同：1
> 
> 时间：2013-02-05T16:13:25.603
> 
> 标签：android, actionbarsherlock, offset, viewpagerindicator, slidingmenu

我正在尝试将 SlidingMenu 包含到我的应用程序中。它结合了 3 个库 ActionBarSherlock / ViewPagerIndicator / SlidingMenu。那么问题是如果我向右滑动以展开 SlidingMenu 它没有偏移量。这意味着孔屏幕将被菜单填充。如果我按下切换按钮，它看起来真的很奇怪。似乎他得到了偏移，但看图片......如果我按下切换按钮两次，它看起来应该 -.-'

知道我做错了什么吗？

那是我的 layout.xml

```
<LinearLayout 
android:id="@+id/id_Main_output"
xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:app="http://schemas.android.com/apk/res-auto"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:weightSum="1.0"
android:orientation="vertical" >

<com.viewpagerindicator.TitlePageIndicator
    android:id="@+id/id_Main_titlepageindicator"
    android:textColor="#FF808080"
    app:selectedColor="#FF33B5E5"
    app:selectedBold="true"
    android:layout_height="wrap_content"
    android:layout_width="fill_parent"
    />
<android.support.v4.view.ViewPager
    android:id="@+id/id_Main_pager"
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="1"
    />

</LinearLayout> 
```

这是我的 onCreate

```
super.onCreate(savedInstanceState);
    setContentView(R.layout.layout_mensaplanhsulm);
    setBehindContentView(R.layout.layout_settings);

    mPager              = (ViewPager)findViewById(R.id.id_Main_pager);
    mIndicator          = (TitlePageIndicator)findViewById(R.id.id_Main_titlepageindicator);
    mAdapter = new DayTitleFragmentAdapter(getSupportFragmentManager());
    mPager.setAdapter(mAdapter);
    mPager.setCurrentItem(0);
    mIndicator.setViewPager(mPager);

    SlidingMenu menu = new SlidingMenu(this);
    menu.setMode(SlidingMenu.LEFT);
    menu.setTouchModeAbove(SlidingMenu.TOUCHMODE_MARGIN);
    menu.setShadowWidthRes(R.dimen.shadow_width);
    menu.setShadowDrawable(R.drawable.shadow);
    menu.setBehindOffsetRes(R.dimen.slidingmenu_offset);
    menu.setAboveOffset(R.dimen.slidingmenu_offset);
    menu.setFadeDegree(0.35f);
    menu.attachToActivity(this, SlidingMenu.SLIDING_WINDOW);
    menu.setMenu(R.layout.layout_settings);

    getSupportActionBar().setDisplayHomeAsUpEnabled(true);
    setSlidingActionBarEnabled(true); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:37:55.910

**这就是我使用的：**

```
// customize the SlidingMenu
        setBehindContentView(R.layout.menu_frame);
        FragmentTransaction t = this.getSupportFragmentManager().beginTransaction();
        mFrag = new SlidingFragment();
        t.replace(R.id.menu_frame, mFrag);
        t.commit();

                SlidingMenu sm = getSlidingMenu();
                sm.setShadowWidthRes(R.dimen.shadow_width);
                sm.setShadowDrawable(R.drawable.shadow);
                sm.setBehindOffsetRes(R.dimen.slidingmenu_offset);
                sm.setFadeDegree(0.35f);
                setSlidingActionBarEnabled(true);

                getSupportActionBar().setDisplayHomeAsUpEnabled(true); 
```

**维度.xml**

```
<resources>

    <dimen name="slidingmenu_offset">60dp</dimen>
    <dimen name="list_padding">10dp</dimen>
    <dimen name="shadow_width">15dp</dimen>

    <integer name="num_cols">1</integer>

</resources> 
```

**样本：**

[https://www.4shared.com/rar/zOWrvmyu/ViewpagerandSherlock.html](https://www.4shared.com/rar/zOWrvmyu/ViewpagerandSherlock.html)

这个示例是完美的 viewpager 和 sherlock。

只需在 BaseSampleActivity 中实现此代码扩展 SlidingFragmentActivity，创建一个简单的 SlidingFragment 即可。

您需要扩展一个 SlidingMenu 类。要同时使用 ActionBar Sherlock 库，您必须按照自述文件中列出的步骤进行操作，尤其是以下步骤：

进入您计划使用的 SlidingActivity，使它们扩展 Sherlock__Activity 而不是 __Activity。

所以你的项目应该扩展 SlidingActivity：

```
public class Waiter extends SlidingActivity { 
```

您需要更改您的 SlidingMenu 库副本以使用 ABS。打开 com/slidingmenu/lib/app/SlidingActivity.java 并更改：

```
public class SlidingActivity extends Activity implements SlidingActivityBase { 
```

到：

```
public class SlidingActivity extends SherlockActivity implements SlidingActivityBase {
//             Add "Sherlock" here:  ^^^^^^^^ 
```

（对您希望使用的任何其他 SlidingMenu 活动重复此步骤。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:07:52.583

这个答案不是必需的，所以我编辑以关注其他答案！

# mysql - 从 Mysql 中连接创建表时出错

> ID：14711895
> 
> 赞同：0
> 
> 时间：2013-02-05T16:13:36.713
> 
> 标签：mysql, left-join, create-table

我有 2 个表`A`，`B`我想使用一个列加入它们并从中`id`创建第三个表`C`。
我执行了这个查询：

```
create table C select * from ( A left join B using (id))T; 
```

但它给出了错误：

```
 You have an error in your SQL syntax; check the manual that corresponds to your   MySQL server version for the right syntax to use near 'T' at line 1 
```

我不知道为什么会出现错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:14:47.787

删除以下

*   插入语
*   `FROM`前`SELECT`
*   和`ALIAS`

还

提示，使用 创建表时`CREATE TABLE ... SELECT`，请确保为查询中的任何函数调用或表达式设置别名。如果不这样做，CREATE 语句可能会失败或导致不需要的列名。

询问，

```
CREATE TABLE C 
SELECT  * 
FROM    A 
        LEFT JOIN B USING (id) 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/f8c51/1)
*   [创建表...选择](http://dev.mysql.com/doc/refman/5.0/en/create-table-select.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T16:14:43.593

删除圆括号和别名就可以了（至少对于语法而言）

```
create table C 
select * from  A left join B using (id); 
```

# sql-server - 使用一条 sql 语句在数据透视表中创建多于一列

> ID：14711897
> 
> 赞同：3
> 
> 时间：2013-02-05T16:13:41.917
> 
> 标签：sql-server, pivot

我需要对同一项目编号的数据透视表项目数据中的日期进行排序

该项目如下所示：

```
"Project nr"   "Task"                "Task deadline"  "Task Type Production"
123             pack                  1 april 2013    Pack
123             Leave production      3 april 2013    Leave Production
123             Flight date           9 april 2013    Flight Date 
```

“任务类型生产”是为了确保字段的内容始终一致我只能在数据透视表中创建一列。有没有办法在 3 列中显示这些信息，它看起来像这样：

```
Project nr ;  Pack   ;  leave production ; flightdate   

SELECT  [TaskDeadline] AS Packed
FROM         MSP_EpmTask_UserView where  [Task Type Production] = 'Packed'
SELECT  [TaskDeadline] AS LeaveProduction
FROM         MSP_EpmTask_UserView where  [Task Type Production] =  'Leave Production' 
SELECT  [TaskDeadline] AS FlightDate
FROM         MSP_EpmTask_UserView where  [Task Type Production] =  'Flight Date' 
```

谢谢安妮

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T16:38:41.243

这可以使用聚合函数和`CASE`表达式轻松完成：

```
select  [Project nr],
    MAX(case when [Task Type Production] = 'Pack' then [Task deadline] end) as Pack,
    MAX(case when [Task Type Production] = 'Leave Production' then [Task deadline] end) as [Leave Production],
    MAX(case when [Task Type Production] = 'Flight Date' then [Task deadline] end) as [Flight Date]
from MSP_EpmTask_UserView 
group by    [Project nr] 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/0889e/1)

如果要`PIVOT`在 SQL Server 中使用该函数，则查询将是：

```
select *
from
(
  select [Project nr],[Task deadline], [Task Type Production]
  from MSP_EpmTask_UserView 
) src
pivot
(
  max([Task deadline])
  for [Task Type Production] in ([Pack], [Leave Production],
                                 [Flight Date])
) piv 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/0889e/3)。

最后，这可以使用多个连接到您的表来完成：

```
select t1.[Project nr],
  t1.[Task deadline] pack,
  t2.[Task deadline] [Leave Production],
  t3.[Task deadline] [Flight Date]
from MSP_EpmTask_UserView t1
left join MSP_EpmTask_UserView t2
  on t1.[Project nr] = t2.[Project nr]
  and t2.[Task Type Production] = 'Leave Production'
left join MSP_EpmTask_UserView  t3
  on t1.[Project nr] = t3.[Project nr]
  and t3.[Task Type Production] = 'Flight Date'
where t1.[Task Type Production] = 'Pack' 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/0889e/5)

所有查询的结果是：

```
| PROJECT NR |       PACK | LEAVE PRODUCTION | FLIGHT DATE |
------------------------------------------------------------
|        123 | 2013-04-01 |       2013-04-03 |  2013-04-09 | 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T16:32:40.040

您可以尝试使用相关子查询的传统方法创建交叉表或数据透视表：

```
select [Project nr]
    , (select [Task deadline] from MSP_EpmTask_UserView where [Project nr] = t.[Project nr] and [Task Type Production] = 'Pack') as Pack
    , (select [Task deadline] from MSP_EpmTask_UserView where [Project nr] = t.[Project nr] and [Task Type Production] = 'Leave Production') as [Leave Production]
    , (select [Task deadline] from MSP_EpmTask_UserView where [Project nr] = t.[Project nr] and [Task Type Production] = 'Flight Date') as [Flight Date]
from MSP_EpmTask_UserView t
group by [Project nr]
order by [Project nr]

/*
Project nr  Pack       Leave Production Flight Date
----------- ---------- ---------------- -----------
123         2013-04-01 2013-04-03       2013-04-09
*/ 
```

我已经在具有不错`date`数据类型的 SQL Server 2008 中完成了此操作，尽管您当然可以使用 stings 或 datetime 来完成此操作。这还假设特定项目编号的每个日期只有一个。

此外，如果可能，请尽量不要在 DB 对象名称中放置空格或其他特殊字符，这些字符会迫使您用括号分隔它们。

# security - “__fortify_fail”有什么作用？

> ID：14711899
> 
> 赞同：3
> 
> 时间：2013-02-05T16:13:45.010
> 
> 标签：security, gcc, debian

一个用户提交了一个错误报告，其中我的应用程序在“__fortify_fail()”中出现了段错误。

我知道这与使用 Debian 的“强化”标志构建我的应用程序有关`-D_FORTIFY_SOURCE=2 -fstack-protector`。

不幸的是，用户的[回溯](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=690410)并没有告诉我太多，而且用户的响应速度不是很快（现在）。

为了更好地了解发生了什么，我想知道`__fortify_fail`实际发生了什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T10:11:30.483

这个函数通常只是一个错误报告器。glibc 的示例代码是：

```
extern char **__libc_argv attribute_hidden;

void
__attribute__ ((noreturn))
__fortify_fail (msg)
     const char *msg;
{
  /* The loop is added only to keep gcc happy.  */
  while (1)
    __libc_message (2, "*** %s ***: %s terminated\n",
                    msg, __libc_argv[0] ?: "<unknown>");
}
libc_hidden_def (__fortify_fail) 
```

它可以在这里和那里被称为首选强化来源。“设防”本身只是几个运行时检查。函数中的示例用法`openat`来自`io/openat.c`：

```
int
__openat_2 (fd, file, oflag)
     int fd;
     const char *file;
     int oflag;
{
  if (oflag & O_CREAT)
    __fortify_fail ("invalid openat call: O_CREAT without mode");

  return __openat (fd, file, oflag);
} 
```

没有设防，`O_CREAT`没有模式是可以接受的（这种情况仍然是高度可疑的，它**是**合法的）。

想想`__fortify_fail`printf+abort。

关于您的问题打开心灵感应，我可能会建议用户在用户代码中使用 libc 时遇到一些问题。`/lib/x86_64-linux-gnu/libc.so.6(+0xebdf0)[0x7f75d3576df0]`是 libc 中某些运行时检查失败`pd[0x49b5c0]`的地方，也是 libc 错误调用的地方。

# php - 在查询字符串中转义 ' - 甚至可能吗？

> ID：14711900
> 
> 赞同：2
> 
> 时间：2013-02-05T16:13:48.267
> 
> 标签：php, sql, oracle

我有一个使用 oracle-db 的大型 php 应用程序（纯 php，没有框架等）。所有查询都是这样执行的：

```
oci_parse($conn_id,"insert into table (bla) values ('bla')");
oci_execute($stmt) 
```

我知道这很糟糕！无需指出诸如“使用绑定”之类的东西或类似的东西。我知道，但我无法改变这一点。

我们都知道，你必须转义字符。这个问题尤其是关于`'`性格的。

我有很多这样的查询：

```
$query = "INSERT INTO table (field1, field2,field3,field4) VALUES ('bla,bla','blub', 'mimi'm', 'mu's'c'hle')";
$query2 = "UPDATE table SET field1 =  'bla,bla', field2 = 'blub', field3 = 'mimi'm', field4 = 'mu's'c'hle' WHERE field5 = 'lol'zj'd'" 
```

当然，通常他们没有这么多`'`- 但这只是为了演示。

现在问题来了：有没有办法验证/转义 php 中的整个查询字符串？无论我怎么想，我都想不出/找到一种方法来实现这一点。

很明显，在构建查询字符串之前很容易转义所有值，只需替换`'`为`''`- 但是当您只有整个查询作为字符串时（如上面的示例）是否有可能？我个人想不出一个“通用解决方案”......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:47:20.293

我相信在已经建立查询的时候，这是用传统方法无法解决的：

1.  尝试简单地在每个撇号上添加一个斜线当然是行不通的，因为您正在转义分隔符撇号以及“in-value”撇号。
2.  没有函数或正则表达式来确定哪些是值内撇号，哪些是值分隔撇号。
3.  即使是解析器也无济于事，因为解析器的一部分工作是告诉您查询何时具有无效语法，而不是修复该语法；一旦它碰到一个不合适的撇号并且后面的字符不是逗号，它就会阻止。

让我们来看看你的第二个例子：

```
field3 = 'mimi'm', field4 = 'mu's'c'hle' 
```

正常的查询解析器会看到该`field3`值`'mini'`后跟一个错误`m`的 ，它需要一个逗号。这不是解析器旨在处理的事情。

所以假设我们写了一些自定义的东西来处理这个。假设我们决定撇号，因为它后面没有逗号，所以它必须是值的一部分。这很好，但是下一个撇号是什么意思，它是一个分隔符？

我们的代码如何知道撇号是否是分隔符，而不是实际包含撇号后跟逗号的值？事实上，该值可能包含与查询的其余部分完全相同的内容！（此外，一旦我们开始以这种方式质疑查询本身的结构，我们将如何检测实际上*无效的查询）。*

**tl;博士**

GIGO = 垃圾进，垃圾出

您无法编写（传统）软件来解决任意混乱！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T18:32:15.380

好的，这绝对不是万无一失的，甚至不是优雅的，但它确实适用于给定的查询，可以说是“概念证明”......

不要在生产服务器中使用该功能..它会尽快中断（而不是稍后;））

```
<?php

$query = "INSERT INTO table (field1, field2,field3,field4) VALUES ('bla,bla','blub','mimi'm','mu's'c'hle')";
$query2 = "UPDATE table SET field1 =  'bla,bla', field2 = 'blub', field3 = 'mimi'm', field4 = 'mu's'c'hle' WHERE field5 = 'lol'zj'd'";

function clean_given_query($qry)
{
    if(strpos($qry , " VALUES "))
    {   
        //the easy way, since we know exactly how many fields we have here
        $qra = explode('VALUES', $qry);
        if(count($qra) == 2)
        {
            // qra[0] = "INSERT INTO table (field1, field2,field3,field4)"
            // qra[1] = "('bla,bla','blub', 'mimi'm', 'mu's'c'hle')";
            $qtemp = explode('(', $qra[0]);
            $qtemp = $qtemp[1]; // we can loose the insert -part for now
            $fieldcount = count(explode(',',$qtemp)); // now we know how many fields we want to populate
            $qra[1] = explode("','", $qra[1]); // dirty values....
            if(count($qra[1]) === $fieldcount) //make sure we have the correkt value count
            {
                $values = array();
                foreach($qra[1] as $i => $val)
                {
                    if($i==0)
                        $val = substr($val, 3); // we know $val is a string and index 0 starts with (' which we need to remove!
                    if($i == count($qra[1])-1) // last item  needs to be cropped at the end
                        $val = substr($val, 0, count($val)-3); //also a string as we know.

                    $val = addslashes($val); //escape the string according to your needs
                    $values[] = $val;
                }
                return $qra[0]." VALUES ('".implode("','", $values)."')";
            }

        }
    }
    else if (strpos($qry, "SET"))
    {
        $qra = explode('=', $qry);
        // $qra[0] = "UPDATE table SET field1";
        // $qra[1] = "'bla,bla', field2";
        $save = $qra[0]."='";

        foreach($qra as $i => $mixed)
        {   
            if($i == 0) // qra[0]  holds nothing to edit!
                continue;

            $parts = explode(',', $mixed); // [0] 'bla    [1] bla'  [2] field2
            $nextfield = array_pop($parts);

            $val = implode(',', $parts); // $val = 'bla,bla'
            if(strpos($nextfield , "WHERE"))
            {
                list($val, $nextfield) = explode("WHERE",$nextfield);
                $nextfield = " WHERE ".$nextfield;
            }
            $val = trim($val);
            $val = substr($val, 1, count($val)-2); //$val  bla,bla
            $val = addslashes($val); // escape according to your needs

            if($val!=="" and strpos($nextfield , "WHERE") === false)
                $save .= $val."', ".$nextfield."='";
            elseif($val!=="" and strpos($nextfield , "WHERE"))
                $save .= $val."' ".$nextfield."='";
            else
            {
                $val = trim($nextfield);
                $val = substr($val, 1, count($val)-2); //$val  bla,bla
                $val = addslashes($val); // escape according to your needs
                $save .= $val."'";
            }
        }
        return $save;
    }
}

echo $query.PHP_EOL;
echo clean_given_query($query).PHP_EOL;

echo $query2.PHP_EOL;
echo clean_given_query($query2).PHP_EOL;

?> 
```

输出：

```
INSERT INTO table (field1, field2,field3,field4) VALUES ('bla,bla','blub','mimi'm','mu's'c'hle')
INSERT INTO table (field1, field2,field3,field4)  VALUES ('bla,bla','blub','mimi\'m','mu\'s\'c\'hle')
UPDATE table SET field1 =  'bla,bla', field2 = 'blub', field3 = 'mimi'm', field4 = 'mu's'c'hle' WHERE field5 = 'lol'zj'd'
UPDATE table SET field1 ='bla,bla',  field2 ='blub',  field3 ='mimi\'m',  field4 ='mu\'s\'c\'hle'  WHERE  field5 ='lol\'zj\'d' 
```

通过一点点努力，并纠正 reg_exp 而不是简单的爆炸/内爆和适合您需要的转义函数，您可以构建一个能够清理给定查询的函数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:17:48.133

您可以使用只需做一个简单的`str_replace()`. 即`str_replace("'", "\'", $string);`。

编辑：你也可以做

```
$str = "INSERT INTO table(field1, field2) 
                        VALUES (
                                replace(" . $value . ", Chr(39), Chr(39) & Chr(39)), 
                                replace(" . $value . ", Chr(39), Chr(39) & Chr(39))
                               );"; 
```

由于 Chr(39) 指的是 '.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-05T16:23:42.520

```
$query = "INSERT INTO table(field) Values('".addslashes("'")."')"; 
```

我认为这是失败的，甚至更好

```
$query = sprintf("INSERT INTO table(field) Values('%s')", addslashes("'")); 
```

因为如果您想在某天扩展插入内容，那将更容易阅读。

[编辑] 据我所知，如果您只想让字符串转义，则使用哪种风格的 sql 并不重要，但以防万一 addlashes 在这里也能正常工作。是的...... php中有一些专门的sql-escape函数，

而且..重读问题..只有查询字符串，没有初始值，很难正确地转义所有内容。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-05T16:28:26.073

如果我理解您的问题，它应该可以工作

```
$name = addslashes("mu's'c'hle");
$query = "INSERT INTO teste (teste) VALUES ('$name')"; 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-05T16:29:01.950

除非您想编写可以解释查询并确定错误所在位置然后以某种方式确定正确修复方法的东西，否则没有办法。

此外，如果您这样做，您仍然没有解决更大的问题，即 sql 注入。

# c# - 使用多线程向服务器发送多个请求

> ID：14711901
> 
> 赞同：0
> 
> 时间：2013-02-05T16:13:52.127
> 
> 标签：c#, multithreading

我有一个任务，我形成了数千个请求，这些请求随后被发送到服务器。服务器返回每个请求的响应，然后将该响应逐行转储到输出文件中。

伪代码如下：

```
//requests contains thousands of requests to be sent to the server
string[] requests = GetRequestsString();

foreach(string request in requests)
{
   string response = MakeWebRequest(request);
   ParseandDump(response);
} 
```

现在，可以看出，服务正在一一处理我的请求。我想加快整个过程。有问题的服务器能够一次处理多个请求。我想应用多线程并一次向服务器发送 4 个请求并将响应转储到同一个线程中。

您能否给我任何可能的方法的指示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:35:41.763

您可以利用[`Task`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx).NET 4.0 和新玩具[`HttpClient`](http://msdn.microsoft.com/en-us/library/system.net.http.httpclient.aspx)，下面的示例代码显示了您如何并行发送请求，然后使用以下方法在同一线程中转储响应`ContinueWith`：

```
var httpClient = new HttpClient();
var tasks = requests.Select(r => httpClient.GetStringAsync(r).ContinueWith(t =>
            {
                ParseandDump(t.Result);
            })); 
```

任务`ThreadPool`在后台使用，因此您无需指定应该使用多少线程，`ThreadPool`将以优化的方式为您管理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T16:40:14.780

最简单的方法是这样使用`Parallel.ForEach`：

```
string[] requests = GetRequestsString();
Parallel.ForEach(requests, request => ParseandDump(MakeWebRequest(request))); 
```

.NET 框架 4.0 或更高版本才能使用`Parallel`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T16:36:31.573

我认为这可以在消费者-生产者模式中完成。您可以使用`ConcurrentQueue`（来自 namespace `System.Collections.Concurrent`）作为许多并行 WebRequest 和转储线程之间的共享资源。

伪代码将类似于：

```
var requests = GetRequestsString();
var queue = new ConcurrentQueue<string>();

Task.Factory.StartNew(() => 
{
    Parallel.ForEach(requests , currentRequest =>
    {
        queue.Enqueue(MakeWebRequest(request));
    }
});

Task.Factory.StartNew(() =>
{
    while (true)
    {        
       string response;
       if (queue.TryDequeue(out response))
       {
          ParseandDump(response);
       }

    }
  }); 
```

也许 a`BlockingCollection`可能会更好地为您服务，具体取决于您希望如何同步线程以发出传入请求结束的信号。

# ruby-on-rails-3.2 - rake db:rollback 恢复错误的迁移

> ID：14711908
> 
> 赞同：3
> 
> 时间：2013-02-05T16:14:17.420
> 
> 标签：ruby-on-rails-3.2, rake, rails-migrations

我在恢复上次迁移时遇到问题。

自从我安装了 'letrate' gem 进行评级以来，所有的结果都`rake db:rollback`准确地恢复了**letrate gem**迁移，而不是预期的最后一次迁移。

我怀疑这是由于宝石本身。

任何想法如何解决这个问题，所以我可以享受非常方便的回滚？

同样的问题：

```
rake db:migrate:redo 
```

结果：

```
==  CreateRates: reverting ====================================================
-- drop_table(:rates)
   -> 0.0224s
==  CreateRates: reverted (0.0225s) ===========================================

==  CreateRates: migrating ====================================================
-- create_table(:rates)
NOTICE:  CREATE TABLE will create implicit sequence "rates_id_seq" for serial column "rates.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "rates_pkey" for table "rates"
   -> 0.1787s
-- add_index(:rates, :rater_id)
   -> 0.0032s
-- add_index(:rates, [:rateable_id, :rateable_type])
   -> 0.0024s
==  CreateRates: migrated (0.1850s) =========================================== 
```

耙分贝：迁移：状态

```
...
   up     20121205224038  Rename user address column
   up     20121206125016587  ********** NO FILE **********
   up     20121206125016605  ********** NO FILE **********
   up     20121210152550  Create reservations
   up     20121210180233  Create transactions
   up     20121210215840  ********** NO FILE **********
   up     20121218144200  Create videos
   up     20121218144800  Add video to videos
   up     20130108225007  Devise invitable add to users
   up     20130130202046  Acts as taggable on migration
   up     20130205154206  Create commissions
   up     20130207133520  Add user id to event transition 
```

和文件

```
-rw-r--r--@  1 joel  staff   137 Dec  7 16:40 20121205224038_rename_user_address_column.rb
-rw-r--r--@  1 joel  staff   443 Dec  7 16:40 20121206125016587_create_rating_caches.rb
-rw-r--r--@  1 joel  staff   432 Dec  7 16:40 20121206125016605_create_rates.rb
-rw-r--r--@  1 joel  staff   429 Dec 10 23:30 20121210152550_create_reservations.rb
-rw-r--r--@  1 joel  staff   414 Dec 10 19:03 20121210180233_create_transactions.rb
-rw-r--r--@  1 joel  staff   237 Dec 18 15:44 20121218144200_create_videos.rb
-rw-r--r--@  1 joel  staff   172 Dec 18 16:18 20121218144800_add_video_to_videos.rb
-rw-r--r--@  1 joel  staff   758 Jan  8 23:50 20130108225007_devise_invitable_add_to_users.rb
-rw-r--r--   1 joel  admin   775 Jan 30 21:20 20130130202046_acts_as_taggable_on_migration.rb
-rw-r--r--@  1 joel  admin   422 Feb  5 17:05 20130205154206_create_commissions.rb
-rw-r--r--@  1 joel  admin   266 Feb  7 15:20 20130207133520_add_user_id_to_event_transition.rb 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-16T16:44:25.847

好的，问题是您的 letrate 迁移的版本号。Rails 只是对迁移文件中的时间戳进行排序，以了解最近应用的时间戳。时间戳中还有 3 个数字，**20121206125016605_create_rates.rb**和**20121206125016587_create_rating_caches**总是会被检测为最后一次迁移。

让我们尝试修复它并清理您的迁移状态。首先回滚有问题的迁移：

```
rake db:rollback STEP=2 
```

您`rake db:migrate:status`现在应该如下所示：

```
up     20121205224038  Rename user address column
up     20121210152550  Create reservations
up     20121210180233  Create transactions
up     20121210215840  ********** NO FILE **********
up     20121218144200  Create videos
up     20121218144800  Add video to videos
up     20130108225007  Devise invitable add to users
up     20130130202046  Acts as taggable on migration
up     20130205154206  Create commissions
up     20130207133520  Add user id to event transition 
```

现在让我们修复它们的版本号（假设您的迁移位于默认`db/migrate`文件夹中）

```
mv db/migrate/20121206125016605_create_rates.rb db/migrate/20121206125017_create_rates.rb
mv db/migrate/20121206125016587_create_rating_caches.rb db/migrate/20121206125016_create_rating_caches.rb 
```

现在你`db:migrate:status`应该是这样的：

```
up     20121205224038  Rename user address column
down   20121206125016  Create rating caches
down   20121206125016  Create rates  
up     20121210152550  Create reservations
up     20121210180233  Create transactions
up     20121210215840  ********** NO FILE **********
up     20121218144200  Create videos
up     20121218144800  Add video to videos
up     20130108225007  Devise invitable add to users
up     20130130202046  Acts as taggable on migration
up     20130205154206  Create commissions
up     20130207133520  Add user id to event transition 
```

现在“时间线”是固定的，但我们仍然需要重新应用这些迁移。`rake db:migrate`不会工作，因为最后一次迁移现在是**20130207133520_add_user_id_to_event_transition.rb**并且它已经被应用所以 rake 认为它是最新的......所以我们必须欺骗 rake：编辑**20121206125017_create_rates.rb**在迁移状态之后出现的每个迁移文件通过注释`down`方法内的所有内容来输出。如果只有一个`change`方法，请将其注释并创建空的 up 和 down 方法。所以所有这些 down 方法都将是这样的：

```
def down
  # This is the old code
  # which I will uncomment later...
end 
```

您还需要创建一个空迁移，因为有一个奇怪的迁移没有关联文件（那个`********** NO FILE **********`）。因此，创建一个名为**db/migrate/20121210215840_ghost_migration.rb**的文件，其内容如下：

```
class GhostMigration < ActiveRecord::Migration
  def up
  end

  def down
  end
end 
```

现在我们准备好模拟一路回滚。也一样

```
rake db:rollback STEP=9 
```

迁移状态输出现在应该是

```
up     20121205224038  Rename user address column
down   20121206125016  Create rating caches
down   20121206125016  Create ratings
down   20121210152550  Create reservations
down   20121210180233  Create transactions
down   20121210215840  Ghost migration
down   20121218144200  Create videos
down   20121218144800  Add video to videos
down   20130108225007  Devise invitable add to users
down   20130130202046  Acts as taggable on migration
down   20130205154206  Create commissions
down   20130207133520  Add user id to event transition 
```

~~现在，您可以通过取消注释您之前评论的内容并删除“Ghost migration”文件来将文件更改回其原始状态。~~您实际上应该像之前对 down 方法所做的那样评论“up”方法，删除“Ghost migration”文件并迁移所有内容

```
rake db:migrate 
```

最后取消注释您在文件中注释掉的所有内容，之后事情应该会顺利进行（我希望）。

关于为什么会首先发生这种情况，我认为这实际上是由于 gem 本身造成的，我认为它不应该生成那些具有无效（或至少非标准）版本号的迁移。看起来 gem 在同一秒内生成了两个迁移，所以也许作者添加了这 3 个额外的数字以防止版本号冲突。我认为在同一次迁移中完成所有事情会更好。

我希望这可以帮助您解决问题！

**更新**

也许我把事情复杂化了。如果您不介意实际回滚所有迁移然后再次迁移它们，则无需对任何文件进行任何评论（尽管“幽灵迁移”技巧仍然是必要的）。我只是觉得这样会更安全。

# css - 在 MyEclipse 中保存时自动运行 maven，无需提交项目文件

> ID：14711910
> 
> 赞同：1
> 
> 时间：2013-02-05T16:14:23.060
> 
> 标签：css, eclipse, maven, less, myeclipse

这可能是其他人以前遇到过的问题，但如果是这样，我一直无法找到正确的搜索词。

我在我的 webapp 中使用 LESS CSS（一个 CSS 预处理器），我需要它在保存 LESS 文件时自动编译一个 CSS 文件，这样我就可以刷新我的浏览器并查看更改。我以前通过更改 MyEclipse 中的项目属性来成功地做到这一点，以便指向一个外部 maven 可执行文件，以及我项目的 POM 中的 generate-sources 阶段。

我们现在正在过渡到 GIT（非常缓慢），作为该路径上的一步，我们希望确保没有任何项目文件在版本控制中。显然，这意味着在项目文件中设置外部可执行文件不再可行，如果我希望所有开发人员自动为他们执行此操作。

谁能指出我解决问题的正确方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:37:50.760

你可以试试 java 的 web 资源优化器（又名[wro4j](http://code.google.com/p/wro4j/)）。它可以同时使用更少的 css 处理器（或许多其他[处理器](http://code.google.com/p/wro4j/wiki/AvailableProcessors)）：运行时解决方案（作为[过滤器](http://alexo.github.com/wro4j/)）或构建时解决方案（作为能够识别增量构建的m2 [-wro4j eclipse 插件的](https://github.com/jbosstools/m2e-wro4j)[maven 插件）。](http://code.google.com/p/wro4j/wiki/MavenPlugin)

或者，有一个轻量级的解决方案，它使用[LessCssFilter 动态处理较少的资源](http://code.google.com/p/wro4j/wiki/AbstractProcessorsFilter)

# c# - 在同一进程中运行的 Windows Service 和 Cassini-dev 之间共享数据

> ID：14711915
> 
> 赞同：0
> 
> 时间：2013-02-05T16:14:51.097
> 
> 标签：c#, cassini, cassini-dev

我有一个用 C# 编写的 Windows 服务。我最近向它添加了[CassiniDev](http://cassinidev.codeplex.com/)，以允许远程 Web 管理和监视服务。除了我无法从托管的 ASP.NET 页面与我的 Windows 服务的数据层进行交互之外，集成进行得非常好。

我尝试将所有感兴趣的内容放入一个公共程序集中，但调试器显示有两个加载的程序集具有相同的名称但来自不同的路径。Cassini 在某个临时文件夹中运行 ASP.NET，因此我使用的程序集实际上是同一进程地址空间中的“不同实例”。

我不确定这里发生了什么。可能是我目前不理解的一些“应用程序域”分离的东西。

那么 Windows 服务和 web 服务器在同一个进程中运行，我怎样才能让它们交互呢？假设我在服务部分中有一些状态，我想在 ASP.NET 部分中报告。任何想法我怎么能做到这一点？想到共享内存或 TCP，但对于纯粹的进程内通信来说，这听起来有点过头了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:20:25.053

如果安全不是一个直接的问题，即数据不是高度敏感的并且在受控环境中，那么您可以使用[命名管道](http://msdn.microsoft.com/en-gb/library/windows/desktop/aa365590%28v=vs.85%29.aspx)取得成功。用于处理管道的托管 API 已作为框架的一部分实现，因此您无需考虑本机调用。

# ruby-on-rails - 创建包含多个单词的模型名称的约定是什么？

> ID：14711916
> 
> 赞同：0
> 
> 时间：2013-02-05T16:14:53.780
> 
> 标签：ruby-on-rails, model

```
rails generate model FooTable  name:string

rails generate model foo_table name:string 
```

哪一个是正确的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T16:18:40.630

您可以使用其中任何一个，它们是等效的。两者都`FooTable`使用名为`foo_tables`.

# clojure - 如何在 clojure/leiningen 中要求 java 类

> ID：14711923
> 
> 赞同：3
> 
> 时间：2013-02-05T16:15:27.790
> 
> 标签：clojure, leiningen, clojure-java-interop

我正在测试 Clojure/Java 互操作。我创建了一个新的 Leiningen 项目并创建了这个 project.clj 文件，其中包含一些我将使用的依赖项：

```
 (defproject kente "0.1.0-SNAPSHOT"
      :description "FIXME: write description"
      :url "http://example.com/FIXME"
      :license {:name "Eclipse Public License"
                :url "http://www.eclipse.org/legal/epl-v10.html"}
      :dependencies [[org.clojure/clojure "1.4.0"]
                     [ring/ring-jetty-adapter "1.0.0-RC1"]
                     [compojure "0.6.5"]
                     [hiccup "0.3.7"]
                     [cheshire "5.0.1"]]
      :java-source-paths ["src/java"]
      :plugins [[lein-ring "0.8.2"]]
      :ring {:handler kente.core/application}
      :main kente.core) 
```

我还包括了“java-source-paths”列表，并将 hello.java 文件放入 src/java 目录，如下所示：

```
public class hello {

    private String msg = "Hello World";

    public String sayHello() {
        return this.msg;
    }

} 
```

然后我从模板创建了这个 core.clj 文件：

```
 (ns kente.core
      (:require [java/hello]))

    (defn application
      "I don't do a whole lot."
      [x]
      (println x "Hello, World!"))

    (defn -main [] (application "Say: ")) 
```

正如你所看到的，我什至没有在应用程序函数中使用 hello java 类，我只是需要它，但是当我在终端中运行“lein jar”时，我得到了这个堆栈跟踪：

```
 $ lein jar
    Compiling kente.core
    Exception in thread "main" java.io.FileNotFoundException: Could not locate hello__init.class or hello.clj on classpath: , compiling:(core.clj:1)
            at clojure.lang.Compiler$InvokeExpr.eval(Compiler.java:3387)
            at clojure.lang.Compiler.compile1(Compiler.java:7035)
            at clojure.lang.Compiler.compile1(Compiler.java:7025)
            at clojure.lang.Compiler.compile(Compiler.java:7097)
            at clojure.lang.RT.compile(RT.java:387)
            at clojure.lang.RT.load(RT.java:427)
            at clojure.lang.RT.load(RT.java:400)
            at clojure.core$load$fn__4890.invoke(core.clj:5415)
            at clojure.core$load.doInvoke(core.clj:5414)
            at clojure.lang.RestFn.invoke(RestFn.java:408)
            at clojure.core$load_one.invoke(core.clj:5227)
            at clojure.core$compile$fn__4895.invoke(core.clj:5426)
            at clojure.core$compile.invoke(core.clj:5425)
            at user$eval7.invoke(NO_SOURCE_FILE:1)
            at clojure.lang.Compiler.eval(Compiler.java:6511)
            at clojure.lang.Compiler.eval(Compiler.java:6501)
            at clojure.lang.Compiler.eval(Compiler.java:6477)
            at clojure.core$eval.invoke(core.clj:2797)
            at clojure.main$eval_opt.invoke(main.clj:297)
            at clojure.main$initialize.invoke(main.clj:316)
            at clojure.main$null_opt.invoke(main.clj:349)
            at clojure.main$main.doInvoke(main.clj:427)
            at clojure.lang.RestFn.invoke(RestFn.java:421)
            at clojure.lang.Var.invoke(Var.java:419)
            at clojure.lang.AFn.applyToHelper(AFn.java:163)
            at clojure.lang.Var.applyTo(Var.java:532)
            at clojure.main.main(main.java:37)
    Caused by: java.io.FileNotFoundException: Could not locate hello__init.class or hello.clj on classpath:
            at clojure.lang.RT.load(RT.java:432)
            at clojure.lang.RT.load(RT.java:400)
            at clojure.core$load$fn__4890.invoke(core.clj:5415)
            at clojure.core$load.doInvoke(core.clj:5414)
            at clojure.lang.RestFn.invoke(RestFn.java:408)
            at clojure.core$load_one.invoke(core.clj:5227)
            at clojure.core$load_lib.doInvoke(core.clj:5264)
            at clojure.lang.RestFn.applyTo(RestFn.java:142)
            at clojure.core$apply.invoke(core.clj:603)
            at clojure.core$load_libs.doInvoke(core.clj:5298)
            at clojure.lang.RestFn.applyTo(RestFn.java:137)
            at clojure.core$apply.invoke(core.clj:603)
            at clojure.core$require.doInvoke(core.clj:5381)
            at clojure.lang.RestFn.invoke(RestFn.java:408)
            at kente.core$loading__4784__auto__.invoke(core.clj:1)
            at clojure.lang.AFn.applyToHelper(AFn.java:159)
            at clojure.lang.AFn.applyTo(AFn.java:151)
            at clojure.lang.Compiler$InvokeExpr.eval(Compiler.java:3382)
            ... 26 more 
```

我应该做些什么不同的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T16:23:39.100

在这里查看我的答案，这几乎是您想要的：[https ://stackoverflow.com/a/14014153/6264](https://stackoverflow.com/a/14014153/6264)

提示：

*   不要使用裸包结构 - 也许你可以，但它通常会导致不必要的问题
*   Java 类被导入，不是必需的。仅当您不想键入包前缀时才需要导入。

# entity-framework - 创建托管在 IIS 中的 silverlight 业务应用程序项目

> ID：14711940
> 
> 赞同：1
> 
> 时间：2013-02-05T16:16:46.680
> 
> 标签：entity-framework, mvvm, iis-7.5, wcf-ria-services, silverlight-5.0

我想创建一个 Silverlight 业务应用程序，它使用我机器的本地 Web 服务器，并使用 EF、Domain Serices 和 RIA 服务在 MVVM 方法下访问 SQL SERVER Express 数据库。

我是 VS2010 或 2012 的 Windows 7 用户。

**以下哪一项是更好的做法？**：

**第一种方法**) 创建一个使用 http 位置 (IIS 7.5) 的网站，然后向其中添加一个 Silverlight 业务应用程序项目。所有的 DomainServices、Views 和 ViewModels 都将位于 BusinessApplication 和 BusinessApplication.Web 项目中。LocalHost 项目将仅作为向世界开放项目的方式：

[图片 http://s8.postimage.org/fveorpir9/Sin_T_tulo.jpg](http://s8.postimage.org/fveorpir9/Sin_T_tulo.jpg)

**第二种方法**）创建一个 Silverlight 业务应用程序，检查 BusinessApplication.Web 属性 Web->使用本地 IIS Web 服务器并继续创建模型、域服务等...

[![图2](../Images/dca2af937afbe0f0add57d4398c8cc43.png)](https://i.stack.imgur.com/IfgBl.jpg)

**第三种方法**）创建一个位于 localhost 的网站，并添加一个托管在该网站中的 Silverlight 项目。此方法不使用业务应用程序模板。没兴趣。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T08:16:16.130

您应该使用 2\. 方法来设置您的 silverlight 项目。从 Silverlight Web 应用程序的开发开始。业务应用程序模板将为您设置许多设置和选项，以便您可以直接实现业务逻辑。

作为一名经验丰富的 Silverlight 开发人员，我使用 3\. 方法，因为我不喜欢使用这些模板，因为它们可以满足我的许多需求。

# jtable - JavaFX TableView 的方法等价于 JTable.getSelectedRow() 是什么

> ID：14711941
> 
> 赞同：2
> 
> 时间：2013-02-05T16:16:47.240
> 
> 标签：jtable, javafx-2, tableview

我需要它来访问我程序中 tableview 内的信息，以便我可以显示一个窗口（阶段），其中包含有关表格选定行中元素的更多信息。非常感谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:33:55.167

要从表中获取所选项目，请使用下一个代码：

```
table.getSelectionModel().getSelectedItem() 
```

选择模型还有其他方便的方法来提供有关索引、多选等信息。

# javascript - 帐号与 Accountid - Dynamics CRM 中的 iFrame

> ID：14711943
> 
> 赞同：1
> 
> 时间：2013-02-05T16:16:48.847
> 
> 标签：javascript, iframe, dynamics-crm-2011

使用 iFrames，我目前知道如何使用 getId() 函数将它们包含在 CRM 中的帐户中。我需要能够通过帐号来执行此操作。是否有功能或解决方案可以实现这一目标？

感谢所有的帮助！

-山姆

编辑：在接受 glossrob 的建议后，我添加了 get('accountnumber') 行，这让我更接近我想要的位置，但它没有产生正确的结果。这是我用来生成 IFRAME 的代码：

```
function SetReport() {
    var id = window.parent.Xrm.Page.data.entity.attributes.get('accountnumber')
    var serverAndOrgUrl = '(*Company URL*)&AccountNumber=';
    var mycmd = '&rs:Command=Render&rc:Toolbar=false'
    var iframeSrc = serverAndOrgUrl + id + mycmd;

    var report = document.createElement("iframe");
    report.setAttribute('id', 'reportFrame');
    report.setAttribute('name', 'reportFrame');
    report.setAttribute('src', iframeSrc);
    report.setAttribute('height', '100%');
    report.setAttribute('width', '100%');
    report.setAttribute('scrolling', 'auto');
    report.setAttribute('frameborder', '0');

    var reportDiv = document.createElement("div");
    reportDiv.setAttribute('height', '100%');
    reportDiv.setAttribute('width', '100%');
    reportDiv.appendChild(report);
    document.body.appendChild(reportDiv);

    function ShowFrame() {
        if(report.readyState == "complete") {
            menubar = report.contentWindow.document.getElementById('mnuBar1');
            if(menubar != null) {
                menubar.style.display = "none";
            }

            editFilter = report.contentWindow.document.getElementById('trEditFilter');
            if(editFilter != null) {
                editFilter.style.display = "none";              
            }
        }
    }
} 
```

IFRAME 已生成，但没有数据显示在应有数据的帐户上。这让我觉得帐号没有正确匹配。

任何帮助，将不胜感激！

谢谢，

-山姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T12:48:02.253

The following line in you question is getting the accountnumber attribute object:

```
var id = window.parent.Xrm.Page.data.entity.attributes.get('accountnumber') 
```

This needs to be updated in order to get the value of the accountnumber so that you can use it in your report URL:

```
var id = window.parent.Xrm.Page.data.entity.attributes.get('accountnumber').getValue() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T20:11:15.053

您可以使用此处的方法在[IFRAME 和实体之间进行通信](https://stackoverflow.com/questions/13571127/communicating-between-iframe-and-an-entity)

本质上，您可以访问父表单的`Xrm`对象，这意味着您可以通过以下方式访问该`accountnumber`属性：

```
parent.window.Xrm.Page.data.entity.attributes.get('accountnumber') 
```

编辑：刚刚看到你的评论......

> 我把那个警报放在那里，它回来了'未定义'。对于帐号，您可以从表单上的字段中获取值。

这两个应该是相关的。`accountnumber`即使它是隐藏的，你也需要在表单上。

您可能还需要取消选中表单属性上的“限制跨站点脚本”。

> 另外，在创建表单上隐藏 iframe，因为不存在帐号

好吧，是的，如果尚未创建帐户，那么显然没有相关数据可以检索，因此这样做会浪费时间 - 不确定我还有更多要添加的内容吗？

要测试表单是否处于创建模式，您可以使用

```
Xrm.Page.ui.getFormType() == 1//CREATE MODE 
```

看[这里](http://msdn.microsoft.com/en-us/library/gg327828.aspx#BKMK_getFormType)

您可以测试创建模式，然后根据它是否处于创建模式来显示/隐藏该部分。

# vb.net - 如何在 TableLayoutPanel 中设置行高

> ID：14711948
> 
> 赞同：3
> 
> 时间：2013-02-05T16:17:02.857
> 
> 标签：vb.net, winforms, visual-studio-2010

我正在动态地将行添加到我的行中，`TableLayoutPanel`但我无法在那里配置高度。

代码可能看起来很长，但它是一个非常简单的代码。

**关于代码的解释：**

代码创建一个`TableLayoutPanel`并设置它的属性。之后，代码`Pictureboxes`根据`Labels`数据库中的电影数量创建。创建 a`Picturebox`和 a后`Label`，代码将它们都放在 a 中`Panel`，然后代码将`Panel`插入`TableLayoutPanel`. 问题是行的高度。

**输出：**

![在此处输入图像描述](../Images/2e74eba6e75826ec21f4f01458469c4c.png)

**这是我正在使用的代码：**

```
 Dim movieN As Integer = MoviesDataSet.movies.Rows.Count
    Dim tablePanel As New TableLayoutPanel

    With tablePanel
        .Size = New Point(Me.ClientRectangle.Width - 10, Me.ClientRectangle.Bottom - 55)
        .ColumnCount = 4
        .GrowStyle = TableLayoutPanelGrowStyle.AddRows
        .AutoScroll = True
        .Margin = New System.Windows.Forms.Padding(0)
        .Location = New System.Drawing.Point(5, 50)
        .CellBorderStyle = TableLayoutPanelCellBorderStyle.Inset
        .ColumnStyles.Add(New ColumnStyle(SizeType.Percent, 25.0!))
        .ColumnStyles.Add(New ColumnStyle(SizeType.Percent, 25.0!))
        .ColumnStyles.Add(New ColumnStyle(SizeType.Percent, 25.0!))
        .ColumnStyles.Add(New ColumnStyle(SizeType.Percent, 25.0!))
        .Anchor = AnchorStyles.Bottom Or AnchorStyles.Left Or AnchorStyles.Right Or AnchorStyles.Top
    End With

    For Each MovieRow As DataRow In MoviesDataSet.Tables("movies").Rows
        'define two new controls to be added
        Dim myLabel As New Label
        Dim myPicture As New PictureBox
        Dim container As New Panel

        'set the properties of the new controls
        myLabel.Text = MovieRow("movieName")
        myLabel.AutoSize = True
        myLabel.Location = New System.Drawing.Point(30, 110)
        With myPicture
            .Image = Image.FromFile(MovieRow("moviePhoto"))
            .Tag = MovieRow("ID")
            .Size = New System.Drawing.Size(100, 100)
            .SizeMode = PictureBoxSizeMode.StretchImage
            .Location = New System.Drawing.Point(2, 2)
            .Cursor = Cursors.Hand
        End With

        'here we add the controls to a layout panel to
        'manage the positioning of the controls
        With container
            .Dock = DockStyle.Fill
            .Margin = New System.Windows.Forms.Padding(0)
            .Controls.Add(myPicture)
            .Controls.Add(myLabel)
        End With

        With tablePanel.Controls

            .Add(container)

        End With

        'here we add a handler for the picture boxs click event
        AddHandler myPicture.Click, AddressOf MyPictureClickEvent
    Next

    Me.Controls.Add(tablePanel)
End Sub 
```

提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T16:49:15.620

试试这个 ：

```
For Each RS As RowStyle In tablePanel.RowStyles    
     RS.SizeType = SizeType.Absolute         
     RS.Height = 180    
Next 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T16:55:41.763

我得到了答案。为了设置行的高度，你所要做的就是添加这个：

```
tablePanel.RowStyles.Add(New RowStyle(SizeType.Absolute, 150)) 
```

你应该在添加到**之后添加这一行**`Panel``TableLayoutPanel`

一个片段：

```
 '.... THE CODE ABOVE CAN BE SEEN IN THE QUESTION POST
        With container
            .Dock = DockStyle.Fill
            .Margin = New System.Windows.Forms.Padding(0)
            .Controls.Add(myPicture)
            .Controls.Add(myLabel)
        End With

        With tablePanel.Controls

            .Add(container)

        End With
        tablePanel.RowStyles.Add(New RowStyle(SizeType.Absolute, 150))
        'here we add a handler for the picture boxs click event
        AddHandler myPicture.Click, AddressOf MyPictureClickEvent
    Next

    Me.Controls.Add(tablePanel)
End Sub 
```

希望对某人有所帮助

# javascript - 在页面加载时将 Javascript 添加到 ASP 下拉列表

> ID：14711954
> 
> 赞同：0
> 
> 时间：2013-02-05T16:17:24.950
> 
> 标签：javascript, asp.net, updatepanel, pageload

我正在开发一个不使用 的交互式 Web 表单`UpdatePanel`，因此我尝试使用 JavaScript 来完成大部分功能。对于这个问题，我试图弄清楚如何让 java 脚本将函数添加到 PageLoad() 的下拉列表中。

我有以下 ASP 文件：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <script src="Default.js" type="text/javascript"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>
</head>
<body>
    <form id="form1" runat="server">
        <div>
            Discovery Form Templates
            <asp:DropDownList ID="uiFormTemplates" runat="server" DataTextField="Subject" DataValueField="DiscoveryFormID" AppendDataBoundItems="true" OnChange="GetTemplateValue();">
                <asp:ListItem Text="--Select One--" Value=""/>
            </asp:DropDownList>
        </div>
        <div id="ChangePlate"></div>
    </form>
</body>
</html> 
```

然后这个javascript：

```
function GetTemplateValue()
{
var dropdown = document.getElementById("uiFormTemplates");
var SelectedOption = dropdown.options[dropdown.selectedIndex].value;

if (SelectedOption == null) {
    document.getElementById("ChangePlate").innerText = "There is nothing here.";
}
else {
    document.getElementById("ChangePlate").innerText = dropdown;
}
} 
```

我正在尝试使用以下 javascript：

```
$(document).ready(function () {
    $("#uiFormTemplates").onchange(function () { GetTemplateValue(); });
}); 
```

当我`OnChange="GetTemplateValue()"`从 中删除`dropdownlist`时，即使使用第二种 javascript 方法，也没有任何反应。我的代码是不是写错了，或者我什至没有从正确的角度来解决这个问题？代码批评或某些方向现在都会有所帮助，我是 js 菜鸟。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:23:52.510

假设您包含 jQuery（您正在使用），则没有`onchange`方法。您必须将其更改为`on('change', ...)`，或使用该`change`方法。另外，`#uiFormTemplates`不应该工作，你必须使用你的控件`ClientID`

所以：

```
$(document).ready(function () {
    $("#<%= uiFormTemplates.ClientID %>").on('change', function () { GetTemplateValue(); });
}); 
```

或者：

```
$(document).ready(function () {
    $("#<%= uiFormTemplates.ClientID %>").change(function () { GetTemplateValue(); });
}); 
```

# php - 仅显示我的第二个数组 php 中的值

> ID：14711955
> 
> 赞同：1
> 
> 时间：2013-02-05T16:17:25.513
> 
> 标签：php, arrays

我有两个要比较的数组。比较工作完美，如下所示：

```
 $tmp = array_diff_key($arr1, $arr2);
  $echo $tmp; 
```

但是，我只想显示数组 2 中存在但数组 1 中不存在的值。

编辑：好的，谢谢大家的帮助。我怎么仍然无法使它工作。

我现在正在使用

```
 $tmp = array_diff($arr2, $arr1);
  var_dump($tmp); 
```

打印出以下内容：

```
 array(1) { [0]=> array(3) { [0]=> string(4) "cars" [1]=> string(4) "vans" [2]=> string(6) "people" } } 
```

所以，我会稍微解释一下。

阵列 1 有汽车、货车（这是从数据库中提取的）。

数组 2 有汽车、人（这是从表格中输入的）。

我试图只显示不在数据库中的值，所以我认为 $tmp 会回显人，因为汽车在数据库中，而货车在 $arr1

我希望这很清楚，因为它甚至让我在写它时感到困惑；）

如果我分别 var_dump 两个数组，我会得到

```
 array(3) { [0]=> NULL [1]=> string(4) "cars" [2]=> string(4) "vans" } array(1) { [0]=> array(2) { [0]=> string(6) "people" [1]=> string(5) "tanks" } } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:20:23.537

使用`array_intersect`. `array_intersect`给出两者中的值.

```
$tmp2 = array_intersect($arr1, $arr2);
var_dump($tmp2); 
```

编辑：误读了这个问题。`array_diff`将达到目的。`array_diff`从 argument1 返回其余参数中不存在的值。

```
$tmp2 = array_diff($arr2, $arr1);
var_dump($tmp2); 
```

编辑：在您的情况下，您`$arr2`的内部有一个包含值的数组。所以，你需要`array_diff($arr2[0], $arr1);`

这是一个工作[小提琴](http://phpfiddle.org/main/code/g4u-dyp)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T16:20:11.843

```
$tmp = array_diff_key($arr2, $arr1);
$echo $tmp; 
```

`echo $tmp`我认为只会输出`'Array'`，所以你可能必须循环它（也许用`foreach`）来显示每个单独的值，或者使用`var_dump`.

`array_diff_key`也适用于键`array_diff`和值（您在问题中提到“值”）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T16:20:49.117

根据我对 的理解`array_diff_key`，该函数返回一个数组，其中包含来自 argument1 的所有条目，其键不存在于任何其他数组中。因此，只需放入`$arr2`第一个论点。

所以你的代码应该是：

```
$tmp = array_diff_key($arr2, $arr1);
$echo $tmp; 
```

[资源](http://php.net/manual/en/function.array-diff-key.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-05T16:21:22.687

换个方向：

```
$tmp = array_diff_key($arr2, $arr1);
  $echo $tmp; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-05T16:20:19.340

您可以执行以下操作：

```
foreach($tmp as $key=>$value) {
    if(isset($arr2[$key])) {
        echo $arr2[$key];
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-05T16:21:59.377

如果您关心的是值而不是键值，那么您应该只使用`array_diff()`. 您还需要颠倒参数中数组的顺序。最后回显一个数组不会向你展示你想要什么，使用`var_dump()`. 所以把它们放在一起：

```
$tmp = array_diff($arr2, $arr1);
var_dump($tmp); 
```

# javascript - 如何有效地用许多静态键/值对填充 Javascript 对象文字？

> ID：14711956
> 
> 赞同：50
> 
> 时间：2013-02-05T16:17:27.790
> 
> 标签：javascript, object-literal, static-initialization

创建 Javascript 对象的典型方法如下：

```
var map = new Object();
map[myKey1] = myObj1;
map[myKey2] = myObj2; 
```

我需要创建这样一个键和值都是字符串的映射。我有一大组静态的配对要添加到地图中。

有没有办法在Javascript中执行这样的事情：

```
var map =  { { "aaa", "rrr" }, { "bbb", "ppp" } ... }; 
```

还是我必须为每个条目执行类似的操作：

```
map["aaa"]="rrr";
map["bbb"]="ppp";
... 
```

基本上，剩余的 Javascript 代码将遍历此映射并根据“运行时”已知的标准提取值。如果这个循环工作有更好的数据结构，我也很感兴趣。我的目标是最小化代码。

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2016-03-12T19:22:56.043

在 ES2015 又名 ES6 版本的 JavaScript 中，`Map`引入了一种名为的新数据类型。

```
let map = new Map([["key1", "value1"], ["key2", "value2"]]);
map.get("key1"); // => value1 
```

查看[此参考](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map#Relation_with_Array_objects)以获取更多信息。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2013-02-05T16:18:55.017

JavaScript 的对象字面量语法，通常用于实例化对象（说真的，没有人使用`new Object`or `new Array`），如下所示：

```
var obj = {
    'key': 'value',
    'another key': 'another value',
     anUnquotedKey: 'more value!'
}; 
```

对于数组，它是：

```
var arr = [
    'value',
    'another value',
    'even more values'
]; 
```

如果您需要对象中的对象，那也可以：

```
var obj = {
    'subObject': {
        'key': 'value'
    },
    'another object': {
         'some key': 'some value',
         'another key': 'another value',
         'an array': [ 'this', 'is', 'ok', 'as', 'well' ]
    }
} 
```

这种能够实例化静态数据的便捷方法是导致[JSON 数据格式](http://www.json.org/)的原因。

JSON 有点挑剔，键必须用双引号括起来，字符串值也是如此：

```
{"foo":"bar", "keyWithIntegerValue":123} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-05T16:20:55.773

它适用于对象文字表示法：

```
var map = { key : { "aaa", "rrr" }, 
            key2: { "bbb", "ppp" } // trailing comma leads to syntax error in IE!
          } 
```

顺便说一句，实例化数组的常用方法

```
var array = [];
// directly with values:
var array = [ "val1", "val2", 3 /*numbers may be unquoted*/, 5, "val5" ]; 
```

和对象

```
var object = {}; 
```

您也可以执行以下任一操作：

```
obj.property     // this is prefered but you can also do
obj["property"]  // this is the way to go when you have the keyname stored in a var

var key = "property";
obj[key] // is the same like obj.property 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-05T16:23:42.790

试试这个：

```
var map = {"aaa": "rrr", "bbb": "ppp"}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T16:21:23.630

您首先编写的语法无效。您可以使用以下方法实现某些目标：

```
var map =  {"aaa": "rrr", "bbb": "ppp" /* etc */ }; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-19T21:27:32.947

试试这个打字稿

```
const MAP: Record<string, string> = {
  key1: 'value1'
};

MAP[this.name] 
```

# c++ - glDrawArrays vs glDrawElements w/Texture mapping

> ID：14711957
> 
> 赞同：0
> 
> 时间：2013-02-05T16:17:35.340
> 
> 标签：c++, opengl

周末我在用我为学校开发的一个简单的 Waveform OBJ 导入器进行试验。在这样做的同时，我阅读了 glDrawArrays 和 glDrawElements 以及后者如何通过将顶点保存在缓冲区中以便于访问而不是重绘它们来优于前者。我开发了简单的算法来对我的顶点、纹理和法线数组进行排序以同时使用它们。但是，当使用 gDE 时，我无法将相同的顶点关联到不同的法线和/或纹理，因为它对所有 3 个缓冲区使用相同的索引。因此，绘制在不同多边形上的顶点保持它们在 OBJ 上首次出现时获得的相同纹理。这可以通过在缓冲区中使用所需的法线/纹理值写入相同的顶点 n 次来解决。然而，该解决方案将最终的缓冲区结果转换为用于 gDA 的相同缓冲区。所以，我的问题是：还有性能优势吗？或者对于这种不便有不同的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T14:40:01.447

> 我不能将相同的顶点关联到不同的法线和/或纹理，因为它对所有 3 个缓冲区使用相同的索引。

你陷入了一个普遍的误解，即“顶点”等于“位置”。*不是这种情况！*顶点是位置、法线、纹理坐标和您使用的所有其他属性的整体组合。您更改属性的值之一，您将获得不同的顶点。因此，您要做的就是从 OBJ 文件中的面生成模型的实际顶点。

不幸的是，许多人误以为“顶点”==“位置”，因此您会发现许多文件格式和规范错误地将位置替换为顶点。例如，在波前 OBJ 格式中，位置是用定义的，`v`而不是更明智的`vp`。

称为“顶点”的数学对象和位置之间的区别在现代 OpenGL 中变得非常明显，在现代 OpenGL 中，您必须提供一个*顶点着色器*，该着色器将任意通用属性作为顶点输入，其中没有一个实际上需要成为位置并且可以从输入以任意方式创建剪辑空间位置。

# .net - 在 WPF 应用程序中托管多个 HwndHost

> ID：14711966
> 
> 赞同：4
> 
> 时间：2013-02-05T16:18:00.597
> 
> 标签：.net, wpf, wpf-4.0, hwndhost

我正在使用一个`hwndhost`元素在 WPF 应用程序中绘制 DirectX 内容。当我覆盖`WndProc`for时，`HwndHost`我确实会被窗口消息调用，但只能由`hwndhost`我创建的第一个实例调用。

基本上在`WM_PAINT`消息上我渲染了我的 DirectX 场景并将“ `handled`”参数标记为 true（我确实检查`hwnd`传入的`WndProc`是否是我的句柄）。一旦我将其标记为 true，其他实例都`HwndHost`不会收到该`WM_PAINT`消息。

如何让其他`HwndHost`实例接收`WM_PAINT`消息？

# soap - 使用 HttpConduit 和 HttpClientPolicy 执行的 CXF 配置的持久性

> ID：14711968
> 
> 赞同：1
> 
> 时间：2013-02-05T16:18:08.977
> 
> 标签：soap, jax-ws, cxf

我正在使用 HttpConduit 和 HttpClientPolicy 配置 CXF。现在每个请求都会看到以下自定义：

```
 Client client = ClientProxy.getClient(queryService);
    client.getRequestContext().put(Message.ENDPOINT_ADDRESS, server);
    HTTPConduit conduit = (HTTPConduit) client.getConduit();
    HTTPClientPolicy policy = new HTTPClientPolicy();
    policy.setConnectionTimeout(timeout * 1000);
    policy.setReceiveTimeout(timeout * 1000);

    if (AUTHENTICATION_TYPE_NTLM.equals(authenticationType))
        policy.setAllowChunking(false);

    if (authenticationCookie != null)
        policy.setCookie(authenticationCookie.toString());

    conduit.setClient(policy); 
```

这些定制是否可以在`queryService`创建实例时应用一次？如果是这种情况，如何为每个请求独立设置身份验证 cookie？

# jquery-mobile - jQuery 移动面板

> ID：14711972
> 
> 赞同：3
> 
> 时间：2013-02-05T16:18:30.303
> 
> 标签：jquery-mobile

我正在尝试添加一个面板以用作侧面菜单，但看起来我做错了什么。我已经尝试对其进行故障排除，但看不到问题出在哪里。

该面板默认情况下不隐藏（不确定它是否应该这样做），我无法让它滑出/滑入。

这就是我所拥有的。我感谢您的帮助。

```
<!-- @ Page = menu -->
<div data-role="page" id="menu">

    <div data-role="panel" id="myPanel" class="main_nav" data-display="push"  data-dismissible="true" data-theme="a">

        <div class="nav_profile">
            <div class="nav_thumb"><img src="images/nav_thumb.png" width="64" /></div>
            <div class="nav_name">
                <h3>user</h3>
                <p>2 active threads</p>
            </div><!--/nav_name-->
        </div><!--/nav_profile-->

    </div><!-- /panel -->

    <div data-role="header" class="header" data-position="fixed" role="banner" >

        <h3>Threads (2)</h3>
        <a href="#" class="right menu_button">New</a>
    </div>

    <div data-role="content">
        <a href="#myPanel" data-rel="panel" data-role="button" class="menu_icon left" ></a>
        <div class="head_search">
            <input type="text" class="search rounded" placeholder="Search" />
        </div>

    </div>

</div><!--/menu--> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:22:57.897

它在这里：http: [//jquerymobile.com/demos/1.3.0-beta.1/docs/panels/index.html](http://jquerymobile.com/demos/1.3.0-beta.1/docs/panels/index.html)

> 面板的可见性通过页面某处的链接或直接调用面板的 open 方法来切换。默认情况下将面板放在左侧，它将被显示。像这样以编程方式打开一个面板：
> 
> `$( "#idofpanel" ).panel( "open" , optionsHash );`
> 
> 要通过链接控制面板，请将 href 指向要切换的面板的 ID（上例中的 mypanel）。这指示框架将链接绑定到面板。此链接将切换面板的可见性，因此点击它将打开面板，再次点击它将关闭它。
> 
> `<a href="#mypanel">Open panel</a>`

我将您的代码放在 jsFiddle 中，没有发现问题，面板正常打开：http: [//jsfiddle.net/Twisty/Ej7A7/1/](http://jsfiddle.net/Twisty/Ej7A7/1/)

确保您使用的是最新的 JQuery 和 JQM 框架。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-03T09:50:18.467

我遇到了同样的问题，但在我的情况下，CSS 文件（从 jQuery 移动网站下载）似乎已损坏。下载无主题的 CSS 文件后，它按预期工作。这个问题现在似乎已经解决了！

# java - 通用记录方法

> ID：14711973
> 
> 赞同：5
> 
> 时间：2013-02-05T16:18:35.767
> 
> 标签：java, design-patterns

这是一件好事吗？通过这样的方法登录？

```
public static void log(final Object... messages) {
    logger.info(Joiner.on(',').useForNull("null").join(messages));
} 
```

// 在代码的其他部分，我们可以使用逗号而不是字符串连接来调用记录器方法。请注意 Joiner 是一个番石榴类。

```
log(" Check ",obja.getXXX(),anotherObject.getMethod()); 
```

期望是干净的代码、便利性和性能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T16:22:59.103

我使用[SLF4J 的`Logger`](http://www.slf4j.org/api/org/slf4j/Logger.html)接口（带有[Logback](http://logback.qos.ch/)实现），我发现它更易于阅读。

```
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class Test {
    private static final Logger logger = LoggerFactory.getLogger(Test.class);

    public void method(String name, int age, Address address) {
        logger.info("Person {}, age {} years old resides at {}", name, age, address);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T16:22:28.717

您可能希望加入`' '`（空白）而不是逗号，但设计方法是一个好主意。

性能方面，它并不理想。您创建一个额外的对象数组和一个连接器以及连接器的内部缓冲区。

所以你可以用这种方法得到 3 个中的 2 个。如果您真的关心性能，请使用已经使用类似方法的[slf4j 。](http://www.slf4j.org/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T16:24:33.303

SLF4J 的界面更好，就像其他答案所说的那样。

我不明白这是如何提高性能的。也许 OP 有一个特定的用例，一些示例代码可以解释它。如果想法是预先收集消息并将它们一起发送到日志方法调用，那么使用缓冲的附加程序会更好。

# python - 配对颜色名称和值

> ID：14711981
> 
> 赞同：1
> 
> 时间：2013-02-05T16:18:58.237
> 
> 标签：python, matlab, image-processing, colors

我正致力于从科学论文中的图形中提取信息，结合图形本身的图像处理和其标题的自然语言处理。

我已经到了一个阶段，我在图像中隔离了对象，并为每个对象获得了一个“平均”颜色（在 RGB 和 Lab 颜色空间中，不确定什么是最好的）。从标题中，我解析了一个对象列表，以及用于描述它们的颜色名称。

所以我有两个列表：

```
names = ['Red', 'Brown', 'Yellow', 'Magenta'];
rgbs = [ (249,0,252), (253,0,1), (250,248,60), (140,70,20)]; 
```

我试图找出一种自动化方法来确定名称和值之间的最佳配对。考虑到这一点，我认为最好从使用所有常用名称的查找表开始，将名称转换为其“可接受的”rgb 值。然后我可以计算出每个 rgb 值和每个名称 rgbs 之间的“距离”（欧几里得？）。在这个阶段，我应该能够以某种方式使用这些距离来找到最佳配对，但我不确定具体如何。

有没有人有任何想法，或者知道任何可能为此提供有用工具的库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:27:09.170

尝试阅读[这项工作](http://lear.inrialpes.fr/people/vandeweijer/papers/cvpr07.pdf)，它看起来解决了一个非常相似的问题。

你能从**不同**的数字中获得这样的列表对（名称 - RGB-values）吗？
如果是这样，通过与这些列表相交，您可能会分离出一组对（仅此颜色）共有的颜色名称，然后尝试找到“尽可能常见”的 RGB 三元组（最多有点失真）。
您可以使用此消除过程，直到您隔离所有颜色。

例如：假设你有

```
{ ['Red','Green'], {[1 0 0], [0 1 0]} }
{ ['Red','blue'] , {[.9 .1\. 1], [ .2 .3 .9] } 
```

您在交叉路口有“红色”，并且 [1 0 0], [.9 .1 .1] 是最接近的颜色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-26T21:16:31.997

我碰巧也需要一个 value->name 函数，并且发现这里的帖子很有帮助。然而，这就是我想出的：

```
from bs4 import BeautifulSoup
import requests
import sys 

def squ_diff(c1, c2):
    return ((c1 & 0x0000FF) - (c2 & 0x0000FF))**2 +\
           (((c1 & 0x00FF00)>>8) - ((c2 & 0x00FF00)>>8))**2 +\
           (((c1 & 0xFF0000)>>16) - ((c2 & 0xFF0000)>>16))**2

def best_match(c, ref):
    """Find the best match for color c.
    Uses least square to determine fitness.
    """
    diff = squ_diff(0xFFFFFF, 0x000000)
    best = "None"
    for ref_color in ref:
        curr_diff = squ_diff(c, ref_color[1])
        #if curr_diff < 1000:
        #    print curr_diff, ref_color[0], hex(ref_color[1])
        if curr_diff < diff:
            diff = curr_diff
            best = ref_color[0]
    return best

def get_ref():
    """Retreives some reference colors.
    Format:
        [("red", 0xFF0000), ("green", 0x00FF00), ("blue", 0x0000FF)]
    """
    html = requests.get("http://jadecat.com/tuts/colorsplus.html").content
    soup = BeautifulSoup(html)
    return [(e.text[:-6].strip(), int(e.text[-6:], 16)) for e in soup.find_all("td")[2:]]

if __name__ == "__main__":
    """For testing, just provide a hex value as the argument.
    """
    r = get_ref()
    print best_match(int(sys.argv[1], 16), r) 
```

它计算给定参考表上的最小二乘差（我刚刚从互联网上下载了一个），以将名称与给定的颜色值配对。就调整人类的颜色感知而言，我并没有真正做太多的科学工作，但我得到的效果相当不错。希望这对某人有用，因为您可以随意修改评分功能。

不过，Shai 引用的工作确实很有趣，这意味着我的算法应该在某些颜色上失败。然而，这种方法背后的想法是为尽可能多的颜色命名，以尽量减少这种影响。例如，您甚至可以将多个颜色值映射到“红色”。

# objective-c - NSDictionary 的 NSArray - 简单的初始化语法

> ID：14711982
> 
> 赞同：5
> 
> 时间：2013-02-05T16:18:59.633
> 
> 标签：objective-c, nsstring, nsdictionary

我开始使用Objective-C（来自Python）
我需要创建和初始化一个简单的字典。
在 Python 中，我曾经这样做过：

```
arr = [
    {'fieldX': value1, 'fieldY': value2},
    {'fieldX': value3, 'fieldY': value3},
] 
```

这是我在 Objective-C 中所做的

```
NSArray *arr = [NSArray arrayWithObjects:
    [NSDictionary dictionaryWithObjectsAndKeys:
        value1, @"fieldX", value2, @"fieldY"
      , nil]
  , [NSDictionary dictionaryWithObjectsAndKeys:
        value3, @"fieldX", value4, @"fieldY"
      , nil]
  , nil
]; 
```

难道没有更简单的方法来初始化这个字典数组吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-05T16:22:03.380

从 ios6 开始，您可以使用文字

```
NSArray *arr = @[
                 @{@"fieldX": value1, @"fieldY": value2},
                 @{@"fieldX": value3, @"fieldY": value3}
                ]; 
```

更多信息：[http ://clang.llvm.org/docs/ObjectiveCLiterals.html](http://clang.llvm.org/docs/ObjectiveCLiterals.html)

# java - ECDH VS。JAVA中的DH基准测试

> ID：14711983
> 
> 赞同：2
> 
> 时间：2013-02-05T16:19:03.200
> 
> 标签：java, cryptography, diffie-hellman

这个问题以前发布在[crypto.exchange](https://crypto.stackexchange.com/questions/6202/ecdh-vs-dh-benchmarking-in-java)上，但是由于我的问题仍然存在，我认为这可能更多是我可能忽略的编程细节，而不是理论上的东西。

所以基本上我的问题是我在测量在 java 中生成 ECDH 密钥所需的时间与生成 DH 密钥所需的时间时得到的奇怪结果。

我比较生成所需的时间：

*   192 位 ECDH 密钥到 512 位 DH 密钥
*   224 位 ECDH 密钥到 1024 DH 密钥

现在，由于密钥大小的不同，我预计 ECDH 密钥对的生成会击败常规的 DH 密钥，但是当我这样做时，情况并非如此。也许我测量错了，或者有其他解释。

```
 public void generateKeyPair() {

    try {

        keyfactory = KeyFactory.getInstance("ECDH");

        keyPairGenerator = KeyPairGenerator.getInstance("ECDH", "BC");

        //NIST EC-Curve P-224"
        org.bouncycastle.jce.spec.ECParameterSpec ecSpec = ECNamedCurveTable.getParameterSpec(EllipticCurveDiffieHellman.curveNames.get(new Integer(224)));

        keyPairGenerator.initialize(ecSpec, new SecureRandom());

    int num = 10;

        /* Warm up */
        for (int wRound = 0; wRound < 200; wRound++) {
            keyPairGenerator.generateKeyPair(); 
        }

        /*
         * Finding the right number of iterations such that we iterate for
         * at least 2s
         */
        for (;;) {

            long begin = System.currentTimeMillis();

            for (int i = 0; i < num; i++) {

                keypair = keyPairGenerator.generateKeyPair();
            }

            long end = System.currentTimeMillis();

            long time = end - begin;

            if (time >= 2000) {
                System.out.printf("Average keygen time: %.2f ms\n",
                        (double) time / num);
                break;
            }

            num *= 2;
        }

    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

# google-analytics - GA 事件目标跟踪 onSubmit 不在 GA 中跟踪

> ID：14711985
> 
> 赞同：0
> 
> 时间：2013-02-05T16:19:04.280
> 
> 标签：google-analytics

我有一个带有订购单的页面。我想跟踪谷歌分析中的 onSubmit 点击。这是我使用的格式。我还在管理/目标面板的谷歌分析中添加了正确的信息。

```
<form method='post' id='form_catalogrequest' name='CatalogRequest' value='CatalogRequest' onSubmit ="return valid(this);_gaq.push(['_trackEvent', 'catalogRequest', 'Submit']);"> 
```

这是设置它的正确方法吗？有一个更好的方法吗？因为当我处理表格时它没有在 GA 中跟踪。

[http://www.positivepromotions.com/catalogrequest.aspx](http://www.positivepromotions.com/catalogrequest.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:42:05.093

问题是，在您拥有 GA 代码之前，`return valid(this);`由于您要返回某些内容，因此之后的所有代码都将被忽略。您需要重组 onSubmit 代码以允许触发 GA 代码。从链接中查看您的函数，如果表单字段有效，`valid()`它看起来最终会返回，如果不是。 `true``false`

所以有两种方法可以解决这个问题：

**方法 A：** 将 onSubmit 代码包装在一个条件中

```
<form method='post' id='form_catalogrequest' name='CatalogRequest' value='CatalogRequest' onSubmit ="if (valid(this)){_gaq.push(['_trackEvent', 'catalogRequest', 'Submit']); return true;} else { return false; }"> 
```

**方法 B：**将您的 GA 代码移动到您的`valid()`函数中：

```
function valid(form){

  // lots of form validation stuff that I didn't c/p to save space

  _gaq.push(['_trackEvent', 'catalogRequest', 'Submit']);
  return true;
} 
```

就我个人而言，我会选择**方法 B**，因为它是 IMO 清洁剂。

# javascript - 选项选择 onchange

> ID：14711986
> 
> 赞同：3
> 
> 时间：2013-02-05T16:19:10.140
> 
> 标签：javascript, jquery

这可能是一个原始问题，但我是 JS/jQuery 的新手。

我在一个页面上有几个不同的选择框。Each of them has an image next to, that is changed, when a different option is selected. 但是，这仅适用于带有 getElementById 的一个选择框，但它不适用于其中许多 getElementByClassName ，我也不想使用此方法，因为我读到它不受 IE8.0 支持。有没有办法让这个页面中的多个选择框工作，而不为每个选择框使用单独的 ID？

您的帮助将不胜感激。这是我的代码。

```
<img id="color" src="content/1.png"> 
<select class="mod_select" name="colors" id="changingColor" tabindex="1" onchange="changeimg()">
<option value="content/1.png">1 thing</option>
<option value="content/2.png">2 thing</option>
<option value="content/3.png">3 thing</option>
</select>

<script type="text/javascript">
function changeimg(){
document.getElementById('color').src=document.getElementById('changingColor').value
}
</script> 
```

编辑：我想对 select 和 img 都使用类。然后在一个 div 中有一个特定的选择选项更改它旁边的 img。那可能吗？

编辑2：这很好用：

```
$('.mod_select').on('change', function () {
     var $this = $(this);
     var img = $this.prev(); // assuming select is next to img
     img.attr('src', $this.val());
 }); 
```

但是，img 不在旁边选择，我想我应该使用 prevSibling，但我不确定如何。阅读 jQuery API 对我没有多大帮助。我将衷心感谢您的帮助！这是我的html：

```
 <img src="content/1.png"> <!-- the image that needs to be updated with new select option -->
 <p>text</p>
 <div class="moreinfo info_icon left"></div> <!-- the div that triggers qTip -->
 <div class="moreinfo_text"> <!-- this is a hidden div this that is shown by qTip with -- text: $(this).next('.moreinfo_text') -->
      <img src="content/qtip_img.jpg">
      <p>qTip text</p> 
 </div> 
 <select class="mod_select" name="colors" tabindex="1">
      <option value="content/1.png">1 thing</option>
      <option value="content/2.png">2 thing</option>
      <option value="content/3.png">3 thing</option>
 </select> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:22:49.270

请看看这是否适合您：

```
jQuery(document).ready(function($){

   $('.mod_select').change(function() {
    $('.mod_select option:selected').each(function() {
     $('#color').attr('src', $(this).val());
    });
   });

}); 
```

你应该添加类似的东西

```
<!-- Grab Google CDN's jQuery. fall back to local if necessary -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">/* <![CDATA[ */
!window.jQuery && document.write('<script type="text/javascript" src="/js/jquery.js"><\/script>')
/* ]]> */</script> 
```

到添加jQuery。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T17:44:50.850

由于 IE 8 不支持`getElementsByClassName`，您可以使用`getElementsByTagName`Internet Explorer 支持的版本创建您自己的版本。一旦你有了元素数组，你就可以遍历它们并为事件分配一个事件处理程序，`change`而不必与 html 内联。完成此操作后，您需要做的就是使用`previousSibling`或通过其类名查找图像元素`nextSibling`并更改其源。

**这是javascript**

```
var select = getElementsByClassName(document.body,'mod_select');
for (var i = 0; i < select.length; i++){
    select[i].onchange = function() {
      var prevSibling = this.previousSibling;
      while(prevSibling && prevSibling.className != 'image') {
           prevSibling = prevSibling.previousSibling;
      }
      prevSibling.src = this.value;
    }
}

function getElementsByClassName(node, classname) {
    var a = [];
    var re = new RegExp('(^| )'+classname+'( |$)');
    var els = node.getElementsByTagName('*');
    for(var i = 0, j = els.length; i < j; i++)
        if(re.test(els[i].className))a.push(els[i]);
    return a;
} 
```

这是一个显示这个的[小提琴的链接。](http://jsfiddle.net/KsuzP/2/)注意：这不需要任何 jQuery :)

**编辑**

jQuery 为您完成了所有繁重的工作，您可以将上面的代码更改为简单

```
$('.mod_select').change(function(){
    $(this).prevAll('img:first').attr('src', this.value); 
}); 
```

这会在所有先前的兄弟元素中查找它到达的第一个图像并更改其来源。您可以更改选择器以包含您提到的要在第一次编辑中添加的类名称。这是一个使用 jQuery 显示代码 的[小提琴。](http://jsfiddle.net/KsuzP/3/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T16:57:48.050

由于 jQuery 提供了一个非常强大的选择器，您可以使用类选择器来实现您的目标，如下所示：

1.  从选择中删除`onchange`属性。
2.  编辑您的 JavaScript。

    ```
    $('.mod_select').on('change', function () {
        var $this = $(this);
        var img = $this.prev(); // assuming select is next to img
        img.attr('src', $this.val());
    }); 
    ```

# iphone - 当应用程序处于非活动状态时监控耳机插孔

> ID：14711988
> 
> 赞同：0
> 
> 时间：2013-02-05T16:19:21.840
> 
> 标签：iphone, ios, background, monitoring, headphones

我想监控我的应用程序中的耳机插孔，我有执行此操作的代码，但这仅在应用程序处于活动状态时才有效，即使应用程序处于非活动状态，我也需要这样做。那可能吗？

在我的测试中，我将用于监视的代码放在 AppDelegate 中，当我拔下插孔时，它会触发我为这种情况放置的“NSLog”，如果我插入它，则会启动另一个 NSLog，但是当用户按下“电源按钮”时” 据我了解，我的应用程序现在处于“非活动状态”，并且监控代码当时无法正常工作。

是否有可能为此目的创建一个后台任务，即使应用程序处于非活动状态也可以工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:28:05.923

在应用程序进入后台后，您可以使用后台任务运行应用程序长达十分钟。查看 iOS App Programming Guide 的[Background Execution and Multitasking](http://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html#//apple_ref/doc/uid/TP40007072-CH4-SW20)部分。

```
- (void)applicationDidEnterBackground:(UIApplication *)application
{
    backgroundTask = [application beginBackgroundTaskWithExpirationHandler:^{
        // clean up any unfinished task business, your app is going to be killed if you don't end the background task now

        [application endBackgroundTask:backgroundTask];
        backgroundTask = UIBackgroundTaskInvalid;
    }];

    // start the long-running task and return immediately.
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        // Monitor the head phone jack here.
        // If this happens asynchronously, you don't need to dispatch this block, your app will continue to run as normal, only modifying or accessing its UI while it's in background mode is prohibited.

        // End the background task if you're done. If this is never the case, your expiration handler will be called after ten minutes.
        [application endBackgroundTask:backgroundTask];
        backgroundTask = UIBackgroundTaskInvalid;
    });
} 
```

您可以通过发送一个通知用户[`UILocalNotification`](http://developer.apple.com/library/ios/#documentation/iphone/Reference/UILocalNotification_Class/Reference/Reference.html)：

```
- (void)notifyUserWhilePerformingBackgroundTask
{
    UILocalNotification *notification = [[UILocalNotification alloc] init];
    notification.alertBody = @"Headphone removed!";

    [[UIApplication sharedApplication] presentLocalNotificationNow:notification];
} 
```

# flot - Flot Axes 的 p2c 计算偏移量

> ID：14711989
> 
> 赞同：1
> 
> 时间：2013-02-05T16:19:23.577
> 
> 标签：flot

我正在使用 flots`drawOverlay`钩子来帮助注释图表。当我使用 计算从某个位置的 y 轴坐标时`p2c`，我注意到有轻微的偏移。似乎如果我重新添加`yaxis.box.top`，事情就会排成一行，但我不确定这是否是正确的方法。

[在这里](http://jsfiddle.net/kWvEw/1/)拉小提琴。

画出我在说什么：

![在此处输入图像描述](../Images/3eb0cfa02de82c28fafed02b79f1f408.png)

代码：

```
$(function () {

 overlayThresholdHook = function(plot, ctx) {

        var threshold = plot.getOptions().thresholdY;

        if (threshold == -1) return;

        var axes = plot.getAxes();
        var xStart = axes.xaxis.box.left;
        var xStop = axes.xaxis.box.width + xStart;
        var yCor = axes.yaxis.p2c(threshold);// + axes.yaxis.box.top;

        ctx.font = '9pt Arial';
        ctx.strokeStyle = 'blue';
        ctx.fillStyle = 'blue';
        ctx.lineWidth = 2;
        ctx.textAlign = 'left';
        ctx.textBaseline = 'middle';

        ctx.fillText(threshold+'',xStart,yCor);

        ctx.beginPath();
        ctx.moveTo(xStart+ctx.measureText(threshold+'').width+2, yCor);
        ctx.lineTo(xStop, yCor);
        ctx.stroke();
    }    

    var options = { legend: {show: false}, yaxis: {min: -120, max: 150, show: true}, thresholdY: 100, hooks: {drawOverlay: [overlayThresholdHook]}   };
    var plot0 = $.plot($("#plot0"), [ {"data":[[1,-0.998195931084865],[45,2.26027181085055]],"color":"#C0D800","points":{"symbol":"circle"}}], options);
    plot0.triggerRedrawOverlay();
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-03T16:34:37.657

我计算不正确。我必须考虑情节偏移。要以正确的方式获得 y 坐标：

```
var axes = plot.getAxes();
var plotOffset = plot.getPlotOffset();
var yCor = axes.yaxis.p2c(threshold) + plotOffset.top; 
```

# emacs - 转到文件中特定行的 Emacs 快捷方式

> ID：14711992
> 
> 赞同：56
> 
> 时间：2013-02-05T16:19:27.057
> 
> 标签：emacs, line-numbers

在使用 Notepad++ 作为我的默认编辑器两年多之后，我正在学习 Emacs。我仍然对一些事情感到困惑，但我发现自己很享受使用它。

我的问题很简单：在 Notepad++ 中，当我想转到文件的特定行时，我使用了`CTRL+G`. 由于某些令人费解的原因，Emacs 要求我做`M-x goto-line [enter] $linenumber [enter]`.

我不敢相信没有捷径。我一定是谷歌搜索错了，当然？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2013-02-05T16:21:03.407

`M-g g`或者`M-g M-g`是`goto-line`.

而且，找到它的最简单方法是`M-x where-is RET goto-line RET`列出 command 的绑定`goto-line`，或者您可以键入`C-h b`列出当前缓冲区的所有绑定（然后您可以仔细阅读绑定以查看是否`goto-line`存在，或发现其他有用的命令和绑定。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-05T16:27:04.120

[Trey Jackson 的回答](https://stackoverflow.com/a/14712037)是正确的，但是在 emacs 中要知道的另一件有用的事情是如何自己发现这类事情。在您的情况下，您知道命令的名称 -- `goto-line`。如果你输入 'Ch w'（Control+h 然后是 w），Emacs 会告诉你“命令在哪里：”。键入 goto-line 并按回车键，它会告诉您哪些击键（如果有）绑定到该命令。

还有很多类似的功能。'Ch k' 则相反——要求你击键，然后告诉你它运行的命令；'Ch b' 显示所有当前的键绑定；'Ch a' 将搜索一个字符串，因此您可以输入 'Ch a goto' 来搜索名称中带有“goto”的命令；'Ch v' 描述变量；'Ch f' 描述函数；等等

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-18T21:31:10.233

如果您是 emacs 新手，[此网页](https://kb.iu.edu/d/abuf)详细说明了如何查找特定行号。

对我来说（在 Mac 上），它是`M-x goto-line`（通过按下并立即释放退出按钮来获得“M”元键）。

# appharbor - 如何使用 AppHarbor 帐户登录 New Relic 的 iPhone 应用程序

> ID：14711993
> 
> 赞同：0
> 
> 时间：2013-02-05T16:19:27.200
> 
> 标签：appharbor, newrelic

我没有直接在[New Relic 的网站](http://newrelic.com/)上注册，但我通过 AppHarbor 使用它。

如何登录 iPhone 应用程序并仍然**从我的 AppHarbor 应用程序获取我的统计信息**？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-29T18:28:44.743

编辑：我们的 iOS 应用目前不支持 AppHarbor 帐户。

对于您没有密码的帐户：只需在 iPhone 应用程序的第一个字段中输入您的电子邮件地址，您就会收到一封确认电子邮件，而不是被要求输入密码。如果它继续要求您输入密码，请在[https://support.newrelic.com/home](https://support.newrelic.com/home)向我们开票，我会整理您的帐户。

# web-services - Karaf 容器、Rest WS 和 Spring 安全性

> ID：14711995
> 
> 赞同：1
> 
> 时间：2013-02-05T16:19:29.320
> 
> 标签：web-services, rest, spring-security, apache-karaf, dosgi

我正在尝试将安全性（例如基本身份验证）应用于我的 Rest-WS。这些 WS 通过 DOSGi 在 Karaf 容器中发布。

```
<!--
    Register VCPENetworkManager as OSGi Service
  -->       
<bean id="vcpeNetworkManager" class="org.opennaas.extensions.vcpe.manager.VCPENetworkManager"/>
<service ref="vcpeNetworkManager" interface="org.opennaas.extensions.vcpe.manager.IVCPENetworkManager">
    <service-properties>
        <!-- Rest -->   
        <entry key="service.exported.interfaces" value="*"/>
        <entry key="service.exported.configs" value="org.apache.cxf.rs"/>
        <entry key="service.exported.intents" value="HTTP"/>        
        <entry key="org.apache.cxf.ws.address" value="${ws.rest.url}/vcpenetwork"/>  
    </service-properties>
</service> 
```

我需要帮助，为什么我不知道发布 ws 的包中添加了哪些依赖项，或者如何或在何处包含 spring 的配置文件。我一直使用应用程序服务器。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T17:26:37.157

如果您将 CXF 用于 DOSGi，我建议将它与 Blueprint 一起使用，它是一种类似于 Spring 的 XML 语法，并且在 OSGi 环境中效果最好。