# StackOverflow 问答 12846000-12846999

# c# - 使用表达式编码器的网络摄像头快照

> ID：12846013
> 
> 赞同：0
> 
> 时间：2012-10-11T18:16:04.893
> 
> 标签：c#, vb.net, webcam, expression-encoder-sdk, expression-encoder-4

一直在使用我在 [http://www.codeproject.com/Articles/285964/WPF-Webcam-Control](http://www.codeproject.com/Articles/285964/WPF-Webcam-Control)找到的示例 来制作我需要的一些网络摄像头功能。我对快照最感兴趣，我可以让它们在上面的示例中正常工作，没有任何问题。我的主要问题是我希望能够从网络摄像头拍摄快照，而无需事先为用户显示“预览窗口”。图像只是自动保存，没有任何显示或任何东西给用户。以下是我所拥有的（在 vb.net 中，但我不介意在 c# 中回答）：

```
Public Shared Function TakeSnapshotReturnBytes(panelHeight As Integer, panelWidth As Integer) As Byte()
    Dim b() As Byte = Nothing
    Dim vidDevCol As IEnumerable(Of EncoderDevice) = EncoderDevices.FindDevices(EncoderDeviceType.Video)
    If vidDevCol IsNot Nothing AndAlso vidDevCol.Count > 0 AndAlso vidDevCol(0) IsNot Nothing Then
        Dim tmpJob As LiveJob = Nothing
        Dim lvDevSrc As LiveDeviceSource = Nothing
        Try
            tmpJob = New LiveJob
            Using tmpPanel As New System.Windows.Forms.Panel
                tmpPanel.Height = panelHeight
                tmpPanel.Width = panelWidth

                lvDevSrc = tmpJob.AddDeviceSource(vidDevCol(0), Nothing)
                lvDevSrc.PreviewWindow = New PreviewWindow(New HandleRef(tmpPanel, tmpPanel.Handle))
                tmpJob.ActivateSource(lvDevSrc)

                Using MS As New IO.MemoryStream()
                    Using bmp As New Bitmap(panelWidth, panelHeight)
                        tmpPanel.DrawToBitmap(bmp, New Rectangle(0, 0, bmp.Width, bmp.Height))

                        bmp.Save(MS, System.Drawing.Imaging.ImageFormat.Jpeg)
                        MS.Position = 0
                        Using br As New IO.BinaryReader(MS)
                            b = br.ReadBytes(CInt(MS.Length))
                        End Using
                    End Using
            End Using
            End Using
        Finally
            If lvDevSrc IsNot Nothing Then
                tmpJob.RemoveDeviceSource(lvDevSrc)
                lvDevSrc.Dispose()
            End If
            If tmpJob IsNot Nothing Then
                tmpJob.Dispose()
            End If
        End Try
    End If
    Return b
End Function 
```

我得到的只是一个灰色的窗口。我猜我不应该使用“PreviewWindow”对象，但我找不到任何替代品。其他人有任何运气这样做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T11:47:05.187

像这样更改您的代码：

```
tmpJob.ActivateSource(lvDevSrc) 

// This delay let your camera to initialize and ready to capture image.
// Actualy we should find another safer :) way to do this but just to check if it works!
System.Threading.Thread.Sleep(5000)

Using MS As New IO.MemoryStream() 
```

并检查这是否适合您。我猜想您的网络摄像头在您捕获快照时尚未初始化。

# python - mongoengine - 我需要为模型创建表单吗？如何通过表单或直接验证 ListField(ImageField())

> ID：12846014
> 
> 赞同：0
> 
> 时间：2012-10-11T18:16:07.277
> 
> 标签：python, django, mongodb, pymongo, mongoengine

我使用 mongoengine 将 mongodb 用于 django。
通常对于普通模型，我们编写表单，在提交输入数据（html 表单）之后，我们填充验证数据的 django 表单。如果表单有效，我们只需将 django 表单中的数据保存到模型中。我是否也需要对 mongoengine 遵循相同的流程？如果是，我如何验证图像字段。我的图像字段是这样的：

```
 images = ListField(ImageField()) 
```

另外，我应该如何要求用户在 html 页面中输入可以保存到上述字段中的图像列表。如有需要，将提供更多信息

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T10:26:34.853

向 中添加新图像时，`ListField`如果要验证，可以调用`Model.validate()`以确保其有效。

`ImageFields`获取实际的图像文件 - 您可以在此处查看它们的一些用法示例： [https ://github.com/MongoEngine/mongoengine/blob/master/tests/test_fields.py#L1880-1968](https://github.com/MongoEngine/mongoengine/blob/master/tests/test_fields.py#L1880-1968)

一个警告-我还没有尝试过`ImageField`，`ListField`所以让我知道它是怎么回事:)

# java - 具有匿名 Diffie Hellman 的 Java SSL/TLS

> ID：12846017
> 
> 赞同：3
> 
> 时间：2012-10-11T18:16:10.307
> 
> 标签：java, ssl

我有一个用 Java 编写的基本客户端/服务器应用程序，它使用普通套接字进行通信。

我想防止对其进行被动窃听攻击并通过 TLS/SSL 进行通信。我不希望应用程序用户陷入设置证书等的麻烦，我想使用 AES 加密（TLS_DH_anon_WITH_AES_128_CBC_SHA 模式）使用匿名 Diffie Hellman 通过 SSL 设置套接字。

但是，我在网上找不到任何合适的示例或任何关于如何设置 SSLContext 或 SSLSocketFactory 以启用我想要的模式的文档。我很感激这个最小的例子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T18:27:49.843

您应该在`SSLSocket`（或`SSLEngine`）上使用[`setEnabledCipherSuites`](http://docs.oracle.com/javase/7/docs/api/javax/net/ssl/SSLSocket.html#setEnabledCipherSuites%28java.lang.String%5b%5d%29).

# mysql - 选择并列出孩子和父母 - 替代

> ID：12846021
> 
> 赞同：-2
> 
> 时间：2012-10-11T18:16:27.043
> 
> 标签：mysql, sql

> **可能重复：**
> [选择并列出子项和父项](https://stackoverflow.com/questions/12770436/select-and-list-children-and-parent)

我从 xception 收到了这个答案：

[https://stackoverflow.com/a/12770593/445820](https://stackoverflow.com/a/12770593/445820)

不幸的是， GROUP_CONCAT 不是我的解决方案，另一个问题过于扩展，因此我重新提出这个问题。

我需要使用子查询来替代该查询。由于我的查询不够好，因此这项任务也超出了我的能力范围。

请帮忙。

这是代码：

```
// Prepare query
$columns = "c.rule_id, c.rule_title, GROUP_CONCAT(r.rule_description ORDER BY r.rule_position ASC SEPARATOR '~sep~') AS rule_desc, ";
$columns .= "GROUP_CONCAT(r.parse_bbcode ORDER BY r.rule_position ASC SEPARATOR '~sep~') AS bbcode, ";
$columns .= "GROUP_CONCAT(r.parse_links ORDER BY r.rule_position ASC SEPARATOR '~sep~') AS links, ";
$columns .= "GROUP_CONCAT(r.parse_smilies ORDER BY r.rule_position ASC SEPARATOR '~sep~') AS smilies";

$sql_array = array(
    'SELECT'    => $columns,
    'FROM'      => array(RULES_TABLE => 'c'),
    'LEFT_JOIN' => array(
        array(
            'FROM'  => array(RULES_TABLE => 'r'),
            'ON'    => 'r.parent_id = c.rule_id',
        ),
    ),
    'WHERE'     => 'c.parent_id = 0 AND r.public = 1',
    'GROUP_BY'  => 'c.rule_id',
    'ORDER_BY'  => 'c.cat_position',
);

$sql = $db->sql_build_query('SELECT', $sql_array);
$result = $db->sql_query($sql);

$cat_count      = 1;
$alpha_count    = 'abcdefghijklmnopqrstuvwxyz';

while ($row = $db->sql_fetchrow($result))
{
    $template->assign_block_vars('rules', array(
        'RULE_CATEGORY' => $row['rule_title'],
        'ROW_COUNT'     => $cat_count,
    ));

    $rules_ary      = explode('~sep~', $row['rule_desc']);
    $parse_bbcode   = explode('~sep~', $row['bbcode']);
    $parse_links    = explode('~sep~', $row['links']);
    $parse_smilies  = explode('~sep~', $row['smilies']);
    $counter        = 0;

    foreach ($rules_ary as $key => $rule)
    {
        $uid = $bitfield = $options = '';
        generate_text_for_storage($rule, $uid, $bitfield, $options, $parse_bbcode[$key], $parse_links[$key], $parse_smilies[$key]);

        $template->assign_block_vars('rules.rule', array(
            'RULE_DESC'     => generate_text_for_display($rule, $uid, $bitfield, $options),
            'ALPHA_COUNT'   => $alpha_count{$counter},
        )); 

        $counter++;
    }

    $cat_count++;
}
$db->sql_freeresult($result); 
```

您可能不知道某些功能。仅供参考，这是 phpBB 相关的代码。

很抱歉没有在第一次添加代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:35:27.560

```
// Prepare query
$columns = "c.rule_id, c.rule_title, r.rule_description AS rule_desc, ";
$columns .= "r.parse_bbcode AS bbcode, ";
$columns .= "r.parse_links AS links, ";
$columns .= "r.parse_smilies AS smilies";

$sql_array = array(
    'SELECT'    => $columns,
    'FROM'      => array(RULES_TABLE => 'c'),
    'LEFT_JOIN' => array(
        array(
            'FROM'  => array(RULES_TABLE => 'r'),
            'ON'    => 'r.parent_id = c.rule_id',
        ),
    ),
    'WHERE'     => 'c.parent_id = 0 AND r.public = 1',
    'ORDER_BY'  => 'c.cat_position',
);

$sql = $db->sql_build_query('SELECT', $sql_array);
$result = $db->sql_query($sql);

$cat_count      = 0;
$alpha_count    = 'abcdefghijklmnopqrstuvwxyz';

$prev_rule_id   = 0;
$r_rule_titles  = array();

$rule_id = null;

while ($row = $db->sql_fetchrow($result))
{
    if( $rule_id != $row['rule_id'] ) {
            $rule_id = $row['rule_id'];
        $cat_count++;
        $counter = 0;
        $template->assign_block_vars('rules', array(
            'RULE_CATEGORY' => $row['rule_title'],
            'ROW_COUNT'     => $cat_count,
        ));
    }
    $uid = $bitfield = $options = '';
    generate_text_for_storage($row['rule_desc'], $uid, $bitfield, $options, $row['bbcode'], $row['links'], $row['smilies']);

    $template->assign_block_vars('rules.rule', array(
        'RULE_DESC'     => generate_text_for_display($row['rule_desc'], $uid, $bitfield, $options),
        'ALPHA_COUNT'   => $alpha_count{$counter},
    ));

    $counter++;    
}
$db->sql_freeresult($result); 
```

# javascript - 自引用对象如何在 JavaScript 函数中工作？

> ID：12846023
> 
> 赞同：0
> 
> 时间：2012-10-11T18:16:32.620
> 
> 标签：javascript

我正在尝试设置一个 javascript 对象，其中一个项目是函数。我正在做一些自我参考，但它不起作用。

```
var onTimePoints = function($a, $b, $c, $lifeotr){

    $var1 = ($b - $a) / $c;
    $var2 = ($lifeotr - $a) / $var1;
    if($var2>$c)
    {
    $var2 = $c;
    }
    if($var2<0)
    {
    $var2 = 0;
    }
    $var2 = Math.round($var2);
    return $var2;
}
var lifeData ={
      min: 25000,
      max: 65000,
      otr: 56426,
      maxPoints:100,
      otp: onTimePoints(25000, 65000, 100, 56426),
      test: function(){
        alert(this.min);
      }
} 
```

当我这样做时`conosle.log(lifeData.otp)`，它会起作用。

`this.min`当我用,等替换硬编码数字时`this.max`......它不起作用。

这是一个不起作用的示例：

```
var lifeData ={
  min: 25000,
  max: 65000,
  otr: 56426,
  maxPoints:100,
  otp: onTimePoints(this.min, this.max, this.maxPoints, this.otr),
  test: function(){
    alert(this.min);
  }
} 
```

在这种情况下`console.log(lifeData.otp)`返回`NaN`。

我确信我只是忽略了一些东西。如果您知道这个问题，请欣赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T18:34:04.477

你会得到很多教程来理解这一点，但在这里我试图用几行代码来说明它。在 firebug 控制台或 Chrome 控制台中执行以下操作

1.  输入`this`并按回车

    **> Window** // 现在是全局范围

2.  运行以下代码

    ```
    this.a = 500;
    this.b = 600; 
    ```

3.  现在运行以下代码；

    ```
    var MyObject = {
        a: 20,
        b: 40,
        sum: this.a + this.b,
        getSum: function(){
            return this.a + this.b;
        }
    } 
    ```

4.  现在运行以下

    ```
     MyObject.sum 
    ```

    **> 1100** // 因为`MyObect`在全局范围内声明并且在表达式`sum:this.a+this.b` `this` 中是 Window 对象。所以`sum: 400 + 500`

5.  现在运行

    ```
     MyObject.getSum(); 
    ```

    **> 60** // 因为`getSum`是`MyObject`. `MyObject.getSum()`当在`getSum` `this`will 中调用时`MyObject`。所以它返回`20 + 40`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T18:23:52.123

你不能做你想做的事。

考虑：

```
var lifeData ={
  min: 25000,
  max: 65000,
  otr: 56426,
  maxPoints:100,
  otp: onTimePoints(25000, 65000, 100, 56426),
  otNewcomm: formula,
  test: function(){
    alert(this.min);
  }
} 
```

或者

```
var min = 25000;
var max = 65000;
var otr = 56426;
var maxPoints = 100;
var lifeData ={
  min: min,
  max: max,
  otr: otr,
  maxPoints: maxPoints,
  otp: onTimePoints(min, max, maxPoints, otr),
  otNewcomm: formula,
  test: function(){
    alert(this.min);
  }
} 
```

或者

```
function lifeData(min, max, otr, maxPoints)
{
    this.min = min;
    this.max = max;
    this.otr = otr;
    this.maxPoints = maxPoints;
    this.otp = onTimePoints(min, max, maxPoints, otr);
    ...
}
var lifeDataInstance = new lifeData(25000, 65000, 56426, 100); 
```

# spring - Spring MVC 中的 Spring.AjaxEventDecoration 和 dijit.form.Select 问题

> ID：12846027
> 
> 赞同：0
> 
> 时间：2012-10-11T18:16:43.187
> 
> 标签：spring, spring-mvc, dojo, spring-webflow

我在使用 Spring.AjaxEventDecoration 和 dijit.form.Select 时遇到问题，如果用户以某种方式从选择框中选择性别类型，我在 bean 中获取的 elementID 是 Spring MVC？下面是我的表格：

```
<form:select path="sex">
<form:option value="MALE" label="MALE" />
<form:option value="FEMALE" label="FEMALE" />
</form:select> 
<script type="text/javascript">
  Spring.addDecoration(new Spring.ElementDecoration({
  elementId : "sex",
  widgetType : "dijit.form.Select",
  widgetAttrs : {
  promptMessage : "Enter Sex",
  required : true }}));

  Spring.addDecoration(new Spring.AjaxEventDecoration({
  elementId: "sex",
  event: "onChange",
  formId:"customer",
  params: {fragments:"body", _eventId: "loadSchools"}}));
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T16:38:48.963

我解决了这个问题。我删除了***Spring.AjaxEventDecoration***调用并将***Spring.ElementDecoration***更改为以下内容：

```
 <script type="text/javascript">
                            Spring.addDecoration(new Spring.ElementDecoration({
                                elementId : "sex",
                                widgetType : "dijit.form.Select",
                                widgetAttrs : {
                                promptMessage : "Enter Sex",
                                required : true, 
                                onChange : function() {
                                    Spring.remoting.submitForm(
                                        'submit', 
                                        'customer', 
                                        {_eventId: 'sexchange', fragments:'contents'}
                                     ); 
                                     return false;
                                } }}));

                        </script> 
```

我不是 100% 清楚为什么 Ajax 调用不起作用，但我的项目现在正在使用此代码！

# algorithm - 如何将 Redis 中的排行榜限制为仅 N 个元素？

> ID：12846028
> 
> 赞同：7
> 
> 时间：2012-10-11T18:16:44.220
> 
> 标签：algorithm, nosql, redis, leaderboard

我需要创建一个具有最大元素数的排行榜，比如 N ？我知道如何使用 LPUSH + LTRIM 将列表大小限制为 N 个元素。如何使用 Redis 排序集为排行榜实现此功能

到目前为止，我的方法是分 3 步完成：a) ZADD 将分数 + 项目添加到排行榜

b）找到第 N 个元素的排名（我不知道该怎么做）

c) 做一个 ZREMRANGEBYRANK 排行榜 0 rank_of_the_nth_element。

有没有更好的办法 ？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-11T20:05:34.550

我实际上有一个使用 redis 的有效排行榜应用程序。你可以在[这里查看](https://github.com/carlzulauf/leader_boards)。在我的应用程序中，排行榜受到最高`n`分数的限制，并且旧分数在太旧时也会下降（因此可能会有日、周、月、年的高分板）。

无论如何，我认为你想要做的是一个整体的排行榜，所以低分会被推迟。在 Redis Sorted Set 分数的意义上，如果你设置了它，那么高分应该保留（它们在底部）而低分应该离开（它们在顶部），那么你会做类似的事情：

```
ZREMRANGBYRANK leaderboard 0 -100 
```

该示例假设您要保留最后 100 个分数。

也许您将分数反转，因此 1000 的“高分”在 redis 中存储为 -1000，因此它是排序集中的第一个。在这种情况下，它与上述相同，但用于`ZREMRANGEBYRANK leaderboard 100 -1`删除前 100 个之后的所有项目。

**更新：**意识到我的例子是`ZREMRANGEBYRANK`如此简化。

您提出的解决方案也应该有效。如果你想找到`nth`元素的分数，你可以使用这个：

```
hundredth_entry = ZRANGE leaderboard 100 100
hundredth_score = ZSCORE leaderboard hundredth_entry
ZREMRANGEBYSCORE leaderboard -inf (hundredth_score 
```

是为了`(`使范围不包括在内，因此任何小于百分之一的分数都将被删除，而不是百分之一的分数本身。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-05T11:37:46.503

OP算法的lua实现：

```
redis.call("ZADD", KEYS[1], ARGV[1]+0, ARGV[2])
local n = redis.call("ZCARD", KEYS[1])
if n > ARGV[3]+0 then 
    redis.call("ZREMRANGEBYRANK", KEYS[1], 0, n-ARGV[3]-1) 
end 
```

然后更换

```
ZADD key score member 
```

和

```
EVAL script 1 key score member cap 
```

# php - PHP数组中的键未按数字排序

> ID：12846030
> 
> 赞同：5
> 
> 时间：2012-10-11T18:16:46.560
> 
> 标签：php

我有一个 PHP 数组，其中的键包含年份和周数，如下所示：

```
year-week 
```

使用内置的 ksort 函数，它会像这样返回它们：

```
ksort($array);

2011-21
2011-3
2011-44
2011-45 
```

是否可以像这样对它们进行数字排序：

```
2011-3
2011-21
2011-44
2011-45 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-11T18:18:04.883

如果您使用 PHP >= 5.4，请使用`ksort($array, SORT_NATURAL);`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-11T18:21:41.140

用于`uksort`对键进行排序，并在回调中使用`strnatcmp`.

```
uksort($array, function($a,$b){
    return strnatcmp($a,$b);
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-11T18:23:09.017

您可以使用[natsort](http://php.net/manual/en/function.natsort.php)

```
$a = array_keys($myarray);

// $a now has
// array('2011-21', '2011-3', '2011-45', '2011-44');
natsort($a); 
```

这打印

```
2011-3
2011-21  
2011-44
2011-45 
```

然后，您可以将`$a`数组用作对包含数据的数组的每个元素的引用（在上面的示例中`$myarray`）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-11T18:26:31.667

您可以`ksort`与`natural`标志一起使用。（仅 PHP 5.4+ 支持）

```
ksort($array, SORT_NATURAL); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-11T18:27:37.520

如果你用 2 位数的周格式化它们，你会得到你想要的结果。更像是 2011 年 3 月。参见 sprint_f()。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-11T18:29:17.940

我看到有更简单的解决方案可用，但这是我最初的想法：

```
function cmp($a, $b) {
    $comp1 = explode('-', $a);
    $comp2 = explode('-', $b);
    $year1 = (int) $comp1[0];
    $year2 = (int) $comp2[0];
    $week1 = (int) $comp1[1];
    $week2 = (int) $comp2[1];

    if ($year1 == $year2 && $week1 == $week2) {
        return 0;
    } elseif ($year1 == $year2) {
        return ($week1 < $week2) ? -1 : 1;
    } else {
        return ($year1 < $year2) ? -1 : 1;
    }
}

$array = array('2011-21', '2011-3', '2011-44', '2011-45');
uasort($array, 'cmp'); 
```

# python - gae/python 中的嵌套注释

> ID：12846032
> 
> 赞同：1
> 
> 时间：2012-10-11T18:17:03.433
> 
> 标签：python, google-cloud-datastore

我是 GAE 和 python 的新手。挑战在于使用例如 3 级标识进行嵌套评论。GAE-datastore 为我们做了一半的工作。它以所需的方式存储和输出嵌套结构。所以让例子非常简单：

*   家长 1
    *   父母 1 的孩子 1
    *   父母 1 的孩子 2
        *   孩子 1 的孩子 2
        *   孩子 2 的孩子 2
*   家长 2
    *   父母 2 的孩子 1
        *   孩子 1 的孩子 1
    *   父母 2 的孩子 2
        *   孩子 1 的孩子 2

如果我们将此层次结构保留在数据存储中（通过在创建实体时正确使用属性“父”），我们将能够获取已经以这种方式排序的实体列表：
父 1
子 1 父 1
子 2 父 1
子 1 子 2
孩子 2 的孩子 2
父母 2的
孩子 1 父母 2
的孩子 1 孩子 1 的
孩子 2 父母 2
的孩子 1 孩子 2

所以我们所需要的只是做出正确的识别。换句话说，我们需要为每个项目向我们的模板传递一个参数。让我们将此参数称为 0,1,2。我有解决方案，但我不喜欢它。我以这种方式计算 ident 参数的值：

```
ident_value = len(CURREN_ITEM.key().to_path())/2 - 2 
```

（GAE 层次结构路径中的每个级别都包含 2 个元素。）

因此，在从数据存储中获取模型之后，这个循环正在执行：

```
for model in model_list:            
    new_model_list.append(model) # helper list
    ident_value = len(model.key().to_path())/2 - 2 
    if ident_value>3: ident_value = 3 # max ident = 3
    setattr(new_model_list[i], 'ident', ident_value )
    i += 1 
```

然后 new_model_list 被传递给 jinja 模板，其中每个项目的类名是根据 model.ident 值分配的。需要帮助列表，因为模型是 MyModel 类的实例，用于将数据保存在数据存储中并且没有“ident”属性。

所以问题是：有没有更优雅的方式来做同样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T09:50:03.597

如果有人需要我的解决方案：

```
def nest (flow, root_rep_id_list, deep = 0): 
    msglist = []
    nested_comments = []
    deep += 1 

    for rep_id in root_rep_id_list:
        if rep_id in flow:
            msglist.append(flow[rep_id])        

    for msg in msglist: 
        nested_comments.append(Nestedobject (msg, nest(flow, msg.replies, deep) if msg.replies else None, deep))
        logging.error(msg.replies)      
    return nested_comments 
```

# c++ - 如何使用构造函数的参数构造成员数组的每个元素

> ID：12846035
> 
> 赞同：3
> 
> 时间：2012-10-11T18:17:12.200
> 
> 标签：c++, templates, c++11

> **可能重复：**
> [将 std::tuple 转换为 std::array C++11](https://stackoverflow.com/questions/10604794/convert-stdtuple-to-stdarray-c11)

假设你有：

```
template<class T,int N>
struct A {
  A(const B& b): /* what comes here */ {}

  std::array<T,N> F;
}; 
```

`F[]`在上述情况下，我需要使用构造函数的参数构造的每个元素`b`。这很棘手，因为参数可能不是可以是编译时常量的类型，例如`int`等。

这与[是否可以根据完整的模板参数构造成员数组的元素不同？](https://stackoverflow.com/questions/12836708/is-it-possible-to-construct-the-elements-of-a-member-array-depending-on-an-integ)因为这里使用了用户定义的结构，因此我们需要它的运行时副本。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-11T18:32:43.967

[索引技巧](http://loungecpp.wikidot.com/tips-and-tricks:indices)也可以在这里应用，你只需要稍微转换一下：

```
template <std::size_t... Is>
struct indices {};

template <std::size_t N, std::size_t... Is>
struct build_indices
  : build_indices<N-1, N-1, Is...> {};

template <std::size_t... Is>
struct build_indices<0, Is...> : indices<Is...> {};

template<class T,int N>
struct A {
  template<std::size_t... Is>
  A(const B& b, indices<Is...>) : F{{(void(Is),b)...}} {}
  A(const B& b) : A(b, build_indices<N>{}) {}

  std::array<T,N> F;
}; 
```

[活生生的例子。](http://liveworkspace.org/code/49495941a403bfffb75ebcb9692ab3e8)

我们基本上忽略了索引的值，只使用包本身来执行扩展，即我们只关心包的大小。为此重用索引可能看起来像是滥用，因为我们对实际值不感兴趣，但我认为在这里重用机器很好。用于创建`N`-element 包的任何其他构造看起来都相同，只是包很可能只包含零。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:52:07.577

The build_indicies trick as shown by Xeo is clever and probably the best option if your compiler supports it.

Another option might be to allow the elements to be default constructed, then to destroy them and reconstruct them with placment new/uninitialized_fill:

```
template<class T,int N>
struct A {
  A(const B& b) {
      for (size_t i=0;i<N;++i) {
          F[i].~T();
          new (&F[i]) T(b);
      }
  }

  std::array<T,N> F;
}; 
```

You could also use storage that wouldn't be initialized normally, to avoid the default construction:

```
template<class T,int N>
struct A {    
  typedef std::array<T,N> array_type;
  std::aligned_storage<sizeof(array_type),alignof(array_type)>::type storage;

  array_type &F() {
    return reinterpret_cast<array_type&>(storage);
  }

  A(const B& b) {
    // placement new/uninitialized_fill
  }
}; 
```

# jquery - 这个 jquery 不会在另一个页面上计算 li 元素吗？

> ID：12846039
> 
> 赞同：1
> 
> 时间：2012-10-11T18:17:16.247
> 
> 标签：jquery

我正在尝试计算名为 file.xml 的远程页面上的 li 元素的数量。我究竟做错了什么？很抱歉这个简单的问题，但我就是想不通。

Javascript：

```
<script>
$(document).ready(function(){
$.get('/file.xml', function(data)
{
var allslides = $(data).find('li'),
var slidenumber = $allslides.length;
alert(slidenumber);
});
});
</script> 
```

HTML（file.xml 的内容）：

```
 <body>
    <li><h2>Headline1</h2><span class="desctext">Description</span></li>
    <li><h2>Headline2</h2><span class="desctext">Description</span></li>
    <li><h2>Headline3</h2><span class="desctext">Description</span></li>
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T18:19:54.650

尝试指定您正在加载一个 XML 文件：

```
$.ajax({
    url      : '/file.xml',
    dataType : 'xml',
    success  : function (data) {
       var $allslides = $(data).find('li'),
           slidenumber = $allslides.length;
       alert(slidenumber);
    },
    error    : function () { /* don't forget to handle errors */ }
}); 
```

另外我注意到你的变量名并没有真正匹配，首先你使用`allslides`然后你使用`$allslides`. 我在示例代码中对这些变量名称进行了规范化。

它看起来也有点像您返回的是 HTML 而不是 XML。这将起作用，只需更改`dataType : 'xml'`为`dataType : 'html'`（或将选项保留为`html`默认值）。在一般意义上，指定内容类型而不是让 jQuery 自己猜测是个好主意。

文档`$.ajax()`：[http ://api.jquery.com/jquery.ajax/](http://api.jquery.com/jquery.ajax/)

# vim - 如何在 vim 中安装 pascal 编译器？

> ID：12846040
> 
> 赞同：0
> 
> 时间：2012-10-11T18:17:16.897
> 
> 标签：vim, compiler-construction, pascal

我在那里找到了 vim 的 pascal 编译器，[但](http://www.vim.org/scripts/script.php?script_id=1376)我不知道如何安装它。没有指示。我不知道我必须用它做什么，以及如何用它编译程序。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:25:25.270

我想你想看看关于插件安装的 Vim 文档：http: [//vimdoc.sourceforge.net/htmldoc/usr_05.html#plugin](http://vimdoc.sourceforge.net/htmldoc/usr_05.html#plugin)

**摘抄**

```
使用全局插件

首先阅读插件本身中的文本以检查是否有任何特殊情况。
然后将文件复制到您的插件目录：

    系统插件目录
    Unix ~/.vim/plugin/
    PC 和 OS/2 $HOME/vimfiles/plugin 或 $VIM/vimfiles/plugin
    Amiga s:vimfiles/插件
    Macintosh $VIM:vimfiles:plugin
    Mac OS X ~/.vim/plugin/
    RISC-OS 选择：vimfiles.plugin

Unix 示例（假设您还没有插件目录）：

    mkdir ~/.vim
    mkdir ~/.vim/plugin
    cp /usr/local/share/vim/vim60/macros/justify.vim ~/.vim/plugin

就这样！现在您可以使用此插件中定义的命令来证明
文本。

除了将插件直接放入 plugin/ 目录之外，您还可以
通过将它们放入 plugin/ 下的子目录来更好地组织它们。
例如，考虑对所有 Perl 使用 "~/.vim/plugin/perl/*.vim"
插件。

```

# mysql - 通过 mercurial 钩子应用数据库补丁

> ID：12846042
> 
> 赞同：0
> 
> 时间：2012-10-11T18:17:20.817
> 
> 标签：mysql, mercurial, alter-table, mercurial-hook

我目前正在尝试确定如何通过 mercurial 提交挂钩应用 mysql 数据库补丁。基本上，我有一个传入的提交钩子指向我的搜索路径中的某个脚本。这一切都有效。我真正的问题是如何保留一系列 mysql alter table 语句，这些语句可以在我每次拉取时应用（传入的 mercurial 钩子），再次运行时不会出错。例如：

我在表中添加了一个新列。因此，在我的 altertables.sql 中，我添加了如下内容：

```
ALTER TABLE `thecompany_tbl` ADD `firstLogin` INT NOT NULL DEFAULT '1'; 
```

我第一次通过自动提交挂钩运行它。工作正常。下次我拉动时，它会再次尝试运行它，并产生如下内容：

```
#1060 - Duplicate column name 'firstLogin' 
```

无论如何围绕这个？如果我可以保留一个包含所有更改的文件，然后在每次拉取时应用它，那就太好了。感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T09:26:13.853

您需要更改您的脚本，以便它不会在已应用的情况下进行更改。

[这个](https://stackoverflow.com/questions/3395798/mysql-check-if-a-column-exists-in-a-table-with-sql)答案显示了如何检查列是否存在。

或者，您可以向数据库添加一个表以包含脚本检查和更新的版本号。这可能更容易，因为另一个选项涉及使用不同的查询检查每种类型的更改。

# wcf - TFS 2010 WorkItem 客户端 - 找不到方法异常

> ID：12846047
> 
> 赞同：2
> 
> 时间：2012-10-11T18:17:41.127
> 
> 标签：wcf, tfs-sdk

我已将自定义 TFS 事件点部署到我们的生产网络服务器。服务器没有安装 TFS sdk，所以我必须找到并部署所有依赖的 dll。由于某种原因，当应用程序尝试使用 TFS 客户端联系 TFS 时，只会在服务器上抛出缺少方法异常。有谁知道如何在不安装完整 SDK 的情况下让这个 Web 服务在系统上运行？

该 bin 部署了 TFS dll

*   Microsoft.TeamFoundation.Client.dll
*   Microsoft.TeamFoundation.Common.dll
*   Microsoft.TeamFoundation.Common.Library.dll
*   Microsoft.TeamFoundation.dll
*   Microsoft.TeamFoundation.WorkItemTracking.Client.Cache.dll
*   Microsoft.TeamFoundation.WorkItemTracking.Client.DataStore.dll
*   Microsoft.TeamFoundation.WorkItemTracking.Client.dll
*   Microsoft.TeamFoundation.WorkItemTracking.Proxy.dll

例外

```
System.MissingMethodException: Method not found: 'Boolean Microsoft.TeamFoundation.Client.TfsConnection.HandleUnauthorizedException(Microsoft.TeamFoundation.TeamFoundationServerUnauthorizedException)'.
   at Microsoft.TeamFoundation.WorkItemTracking.Client.DataStore.HandleComException(Int32 hr)
   at Microsoft.TeamFoundation.WorkItemTracking.Client.DataStore.DatastoreClass.ConnectEx(String connectionString, String defaultCachePath, String instanceId, String userSamName, String userFriendlyName, String userSid, WorkItemServer clientService)
   at Microsoft.TeamFoundation.WorkItemTracking.Client.WorkItemStore.InitializeInternal()
   at Microsoft.TeamFoundation.WorkItemTracking.Client.WorkItemStore.Microsoft.TeamFoundation.Client.ITfsTeamProjectCollectionObject.Initialize(TfsTeamProjectCollection teamProjectCollection)
   at Microsoft.TeamFoundation.WorkItemTracking.Client.WorkItemStore..ctor(TfsTeamProjectCollection teamProjectCollection) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-27T08:27:27.363

看起来部分与该问题有关：http: [//blogs.msdn.com/b/bharry/archive/2013/02/13/10392771.aspx](http://blogs.msdn.com/b/bharry/archive/2013/02/13/10392771.aspx)

不幸的是，我仍然无法在哪里找到正确版本的“Microsoft.TeamFoundation.WorkItemTracking.Proxy.dll”库。

# multithreading - 内核上的多线程

> ID：12846053
> 
> 赞同：0
> 
> 时间：2012-10-11T18:18:14.887
> 
> 标签：multithreading, operating-system

在高尔文，我遇到了

> 最后，许多操作系统内核现在是多线程的；内核中有几个线程在运行，每个线程执行一个特定的任务。

### 问题 1

这并不意味着所有这些都将同时运行，因为在给定时间只有 1 个进程/线程可以获得对处理器的控制权？虽然他们可以做各种各样的工作，比如一个在 CPU 上，另一个在 I/O 上工作，比如在缓冲区中获取击键等，对吧？

### 问题2

多线程只会在多处理器系统上显示更好的性能，对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T18:35:49.997

**答案 1**：您的 CPU 的每个核心都可以在任何给定时间执行一个命令。由于几乎所有现代 CPU 都是多核的，因此如果您的应用程序是多线程的，您将获得更好的性能。

**答案 2**：在大多数情况下，即使在具有单核 CPU 的系统上，多线程也会显示出更好的性能。如果您将时间密集型作业分派给多个线程，您的应用程序将对用户输入做出更快的响应

并行化级别如下：

1.  多计算机
2.  多处理器
3.  多核
4.  多线程

在更高的级别上，您会看到线程化带来的更多好处。例如，与单核（多线程）CPU 相比，您的多线程应用程序在多核 CPU 中运行得更好

# python - 在 Python 中从同一模块内的字符串调用函数？

> ID：12846054
> 
> 赞同：24
> 
> 时间：2012-10-11T18:18:23.503
> 
> 标签：python, string, function

假设我`bar`在一个名为`foo.py`. 在 foo.py 的某个地方，我希望能够从字符串“bar”调用 bar()。我怎么做？

```
# filename: foo.py
import sys

def bar():
  print 'Hello, called bar()!'

if __name__ == '__main__':
  funcname = 'bar'
  # Here I should be able to call bar() from funcname 
```

我知道在 python 中存在一些名为“getattr”的内置函数。但是，它需要“模块对象”作为第一个参数。如何获取当前模块的“模块对象”？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-10-11T18:19:43.530

`globals`可能更容易理解。它返回当前模块的`__dict__`，所以你可以这样做：

```
func_I_want = globals()['bar']  #Get the function
func_I_want()    #call it 
```

如果你*真的*想要模块对象，你可以从`sys.modules`（但你通常不需要它）获取它：

```
import sys.modules
this_mod = sys.modules[__name__]
func = getattr(this_mod,'bar')
func() 
```

请注意，一般来说，您应该问自己为什么要这样做。这将允许通过字符串调用*任何函数*——这可能是用户输入......如果您不小心让用户访问错误的函数，这可能会产生潜在的不良副作用。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-10-11T18:20:39.303

使用保留要调用的函数映射的字典：

```
if __name__ == '__main__':
  funcnames = {'bar': bar}
  funcnames['bar']() 
```

# ruby-on-rails - 具有嵌套资源的命名空间 Rails 3.2.8

> ID：12846055
> 
> 赞同：6
> 
> 时间：2012-10-11T18:18:24.667
> 
> 标签：ruby-on-rails, resources, namespaces, routes, nested

我正在尝试将我的 Rails 应用程序组织到两个提供相同资源但具有不同控制器和视图的命名空间中。类似于以下场景：

**路线.rb**

```
resources :beehives do
    resources :bees
    resources :honeycombs
end

namespace :api do
    resources :beehive, only: [:show] do
        resources :bees, only: [:index, :show]
        resources :honeycombs, only: [:index, :show]
    end
end 
```

使用脚手架，我创建了控制器结构：

> rails g 控制器 api/蜂箱
> 
> rails g 控制器 api/蜂箱/蜜蜂
> 
> rails g 控制器 api/蜂箱/蜂窝

我为控制器获得的文件夹结构听起来像这样：

```
+ app
  + controllers
    - beehives_controller.rb
    - bees_controller.rb
    - honeycombs_controller.rb
    + api
      - beehives_controller.rb
      + beehives
        - bees_controller.rb
        - honeycombs_controller.rb 
```

**控制器/beehives_controller.rb**

```
class Api::BeehivesController < ApplicationController 
```

**控制器/api/beehives_controller.rb**

```
class Api::BeehivesController < ApplicationController 
```

**控制器/api/beehives/bees_controller.rb**

```
class Api::Beehives::BeesController < ApplicationController 
```

嗯，这很容易。在这种情况下，`/beehives/1`将路由到根命名空间（用于 Web 应用程序）和`/api/beehives/1`“api”命名空间（用于提供 RESTful Web 服务）。这真的很好。问题是当我尝试访问时`/api/beehives/1/bees`，由于某种原因，命名空间不适用于嵌套资源，并且 Rails 吐出这个错误：

```
uninitialized constant Api::BeesController 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T18:48:04.827

`resources :beehive`+ nested`resources :bees`也不需要嵌套您各自的控制器。这只是构建 URL 的一种方式。因此，您的应用自然会要求 `Api::BeesController`而不是`Api::Beehives::BeesController`.

如果您有任何疑问，请使用`rake routes`命令检查您的路由及其关联的控制器。

# spring - HTTP-Outbound 网关不显示特殊字符 - 编码中断

> ID：12846057
> 
> 赞同：1
> 
> 时间：2012-10-11T18:18:35.837
> 
> 标签：spring, http, character-encoding, spring-integration

我们有一个使用 http-outboundgateway 进行 REST 调用的客户端

```
<int-http:outbound-gateway request-channel="glNewsRequestChannel"
url="${gl.url}" http-method="GET" expected-response-type="java.lang.String"
reply-channel="glHeaderEnricher" charset="iso-8859-1">
<int-http:uri-variable name="site_code"
expression="payload" />
</int-http:outbound-gateway> 
```

当获取响应并将其保存在文件中时，它会显示一些混乱的字符 - 这基本上无法以特定的编码进行翻译。我参考了 SI 文档，其中提到除非指定工厂 Java URLconnection 类用于进行 REST 调用。为了缩小问题范围，我编写了一个小型 Java 程序并直接使用 URLconnection 类，而不使用任何开箱即用的模板或网关——它成功地获取并呈现了所有特殊字符。我尝试了另一个独立的应用程序，它是 apache http 库，它也能够获取字符。作为 SI 的一部分，我缺少任何配置吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:17:22.637

进一步调查显示我们使用了错误的消息转换器 - 如果我们使用 byte[]，而不是使用字符串转换器，则根据 bytearraymessageconverter - 它按预期工作。

```
 <int-http:outbound-gateway request-channel="glNewsRequestChannel" url="${gl.url}" 
    http-method="GET" message-converters="byteArrayHttpMessageConverter" 
    expected-response-type="byte[]" reply-channel="glHeaderEnricher" 
    charset="iso-8859-1">  <int-http:uri-variable name="site_code" 
    expression="payload" /> 
   </int-http:outbound-gateway> 
```

其中 byteArrayHttpMessageConverter 可以定义为：

```
 <bean id="byteArrayHttpMessageConverter"
    class="org.springframework.http.converter.ByteArrayHttpMessageConverter">
    </bean> 
```

# javascript - WebGL：获取活动纹理

> ID：12846059
> 
> 赞同：0
> 
> 时间：2012-10-11T18:18:56.570
> 
> 标签：javascript, webgl

WebGL 函数`activeTexture`允许*设置*活动纹理。有没有办法查询活动纹理是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:33:48.000

以下应该有效：

```
gl.getParameter(gl.ACTIVE_TEXTURE); 
```

# windows-8 - WinJS：如何从 HTML 访问页面函数和变量？

> ID：12846066
> 
> 赞同：0
> 
> 时间：2012-10-11T18:19:09.270
> 
> 标签：windows-8, winjs

我正在用一些变量和方法定义页面。然后我想在 html 标记中使用它（例如`data-win-bind="textContent: myPage.variable`）。如何访问 html 标记中的页面变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:55:51.827

在页面后面的 JavaScript 代码中，比如 default.js，您将包含用于数据绑定的 ViewModel，如下所示：

```
(function(){
   WinJS.Namespace.define("MyModel.myPage", {
      variable : null
   };
   MyModel.myPage.variable = 'foo';
})(); 
```

然后在页面被激活时（在 default.js 中），您需要使用如下调用初始化绑定

```
WinJS.Binding.processAll(document.body, MyModel); 
```

不过还有更多可用的功能，所以这只是一个简单的单向绑定案例，应该可以帮助您入门。有关更多信息，请查看[快速入门：绑定数据和样式](http://msdn.microsoft.com/en-us/library/windows/apps/hh700358.aspx)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-11T18:24:07.113

你必须使用 javascript 这里的骨架：

```
<html>
<head>
<script type="text/javascript">
//Code goes here
</script>
</head>
<body>
</body>
<html> 
```

# arrays - 在 Hive 中搜索数组

> ID：12846069
> 
> 赞同：2
> 
> 时间：2012-10-11T18:19:12.093
> 
> 标签：arrays, string, set, hive, collect

我需要在一个数组函数中搜索配置单元中的特定值。

我有一个为每个事件创建一行的表。我曾经`collect_set(event_id)`把桌子卷到人的水平。我现在需要搜索数组以将用户分为不同的类别。我尝试使用 case when 语句，`find_in_set`但是`in_file`这些函数都不适用于数组。

有任何想法吗？我可以将数组转换为字符串吗？理想情况下，我会`group_concat`在 SQL 中使用一个函数 - 但 hive 不支持它

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T02:19:19.660

`ARRAY_CONTAINS(events, search_param)``search_param`如果在事件数组中找到，将返回一个布尔值。

它在 Hive 0.7.1 和可能的更早版本中可用。

# c# - 果园 - 联系表格 rtl

> ID：12846071
> 
> 赞同：0
> 
> 时间：2012-10-11T18:19:17.240
> 
> 标签：c#, asp.net-mvc, orchardcms, right-to-left

我想知道如何转换“联系表格 - 0.9.4”模块或“oForms - 1.8.1”。还是从右到左脚本的“自定义表单”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:32:24.497

您可以使用自定义表单：[http](http://devdirective.com/post/160/how-to-create-custom-forms-in-orchard-cms-with-email-and-recaptcha) ://devdirective.com/post/160/how-to-create-custom-forms-in-orchard-cms-with-email-and-recaptcha 。

# python - 我没有让我的 pacman 到达目的地.. nd 出现下面提到的错误

> ID：12846072
> 
> 赞同：0
> 
> 时间：2012-10-11T18:19:21.810
> 
> 标签：python, python-2.7

```
[SearchAgent] using function depthFirstSearch
[SearchAgent] using problem type PositionSearchProblem
Path found with total cost of 999999 in 0.0 seconds
Search nodes expanded: 1
Traceback (most recent call last):
  File "C:\Documents and Settings\vpn\My Documents\Aptana Studio 3 Workspace\Project 1 - Search\pacman.py", line 672, in <module>
    runGames( **args )
  File "C:\Documents and Settings\vpn\My Documents\Aptana Studio 3 Workspace\Project 1 - Search\pacman.py", line 638, in runGames
    game.run()
  File "C:\Documents and Settings\vpn\My Documents\Aptana Studio 3 Workspace\Project 1 - Search\game.py", line 662, in run
    action = agent.getAction(observation)
  File "C:\Documents and Settings\vpn\My Documents\Aptana Studio 3 Workspace\Project 1 - Search\searchAgents.py", line 121, in getAction
    if i < len(self.actions):
TypeError: object of type 'NoneType' has no len() 
```

我正在做一个项目，在该项目中我必须通过应用 DFS（深度优先算法）测试我的 pacman 代理以尽可能少的空间和时间复杂度到达其目的地

我的代码是

```
stack = util.Stack()
    explored = list()
    start = problem.getStartState()

    for item in problem.getSuccessors(start):
        state = item[0]
        path = list()
        path.append(item[1])
        stateInfo = (state, path)
        stack.push(stateInfo)
    explored.append(start)

    while stack.isEmpty():
        state = stack.pop()

        if problem.isGoalState(state[0]):
            return state[1]

        for states in problem.getSuccessor(state[0]):
            newstate = states[0]
            newpath = list(state[1])
            newpath.append(states[1])
            newstateInfo = (newstate, newpath)
            stack.push(newstateInfo)
        explored.append(state[0]) 
```

我现在应该怎么做.. 我的 pacman 代理卡在与目的地相对的东方向的起始位置。[https://www.edx.org/courses/BerkeleyX/CS188.1x/2012_Fall/courseware/Week_2/Project_1_Search/](https://www.edx.org/courses/BerkeleyX/CS188.1x/2012_Fall/courseware/Week_2/Project_1_Search/)中提到了运行代理的支持文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T14:46:37.857

我想我知道发生了什么（尽管鉴于问题中的代码数量有限，我无法确定）。

我的猜测是，您发布的代码被调用来设置`self.actions`您遇到错误的变量。发生错误是因为您`None`从函数返回，而不是您期望的列表。

潜在的错误是您的主循环向后测试。你想要`while not stack.isEmpty()`的，而不是你拥有的。因为您刚刚将几个值压入堆栈，所以写入的循环立即退出。在循环之后，您到达函数的末尾，这相当于`None`在 Python 中返回。那 None 稍后会导致异常。

即使您修复了损坏的循环，如果无法找到到达目标状态的路径，也可能会从函数的末尾脱落。我建议添加代码来检测这一点，并做出适当的响应。您可以引发异常（因为它不应该在正常情况下发生），或者可能返回一个空列表。

还有一个问题是您没有检查是否已经探索了新访问的状态。当您从一个状态搜索到邻居然后返回时，这可能会导致无限循环。A`set`也将优于 a `list`for `explored`。您可以检查它`if state in explored`（这也适用于列表，但效率较低）。

作为一个附带问题，您的一些变量的命名非常糟糕。`state`在不同的时间有不同的类型，并且有第二个变量`states`会使它更加混乱，尤其是在引入索引的情况下。

我建议用代码解压你推入堆栈的元组`state, path = stack.pop()`，这将解决部分问题。然后只需重命名`states`为其他名称（或者也可以将其解压缩，使用类似的名称`for neighbor, direction in problem.getSuccessor(state)`），您就可以开始使用了。

您还可以通过将启动状态推送到堆栈来节省几行代码，而不是在设置代码中对其邻居进行额外的循环。

# c# - ASP.net 连接到数据库

> ID：12846075
> 
> 赞同：0
> 
> 时间：2012-10-11T18:19:39.190
> 
> 标签：c#, asp.net, sql-server-2012

大家好，我正在尝试使用 ASP.net 连接到 MSSQL 数据库！我创建了一个包含 3 个表的数据库，但每次我尝试连接到数据库时，我都会收到一条错误消息，指出我必须先获得权限...如何连接或获得权限？

Windows 身份验证

错误

您无权打开此文件

联系文件所有者或管理员以获得许可

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-20T02:13:45.153

尝试不同的方法，例如在 SQL Management Studio 中启用“SQL Server 和 Windows 身份验证模式”
右键单击服务器节点 => 属性 => 安全

然后创建一个对您的数据库具有完全权限的新 SQL 用户配置文件，并在您的连接字符串中使用这些凭据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T18:31:42.470

你可以调整你的字符串连接`IntegratedSecurity = true`

链接：http: [//msdn.microsoft.com/fr-fr/library/system.data.sqlclient.sqlconnectionstringbuilder.integratedsecurity.aspx](http://msdn.microsoft.com/fr-fr/library/system.data.sqlclient.sqlconnectionstringbuilder.integratedsecurity.aspx)

注意：当前 Windows 帐户凭据用于身份验证的信息

注意：您也可以使用服务器帐户（假），但您必须在字符串连接中指定

关于构建字符串连接的另一个链接：http: [//www.connectionstrings.com/sql-server-2012](http://www.connectionstrings.com/sql-server-2012)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-10-11T18:28:40.827

您的应用程序池身份必须具有足够的权限才能访问您的数据库。

# ruby - ruby 中的三路比较

> ID：12846080
> 
> 赞同：10
> 
> 时间：2012-10-11T18:19:54.947
> 
> 标签：ruby

确保红宝石中三个变量都相等的最简洁方法是什么？例如

```
dog = 'animal'
cat = 'animal'
chicken = 'animal'
shoe = 'clothing'

# Something like this...which doesn't work
dog == cat == chicken # true   
dog == cat == shoe # false 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-11T18:23:29.677

三个元素最简洁的方式是（抱歉让你失望了）：

```
dog == cat && cat == chicken 
```

当然，如果你愿意，你总是可以变得聪明......

```
[dog, cat, chicken] == [dog] * 3
[dog, cat, chicken].uniq.length == 1 
```

...但这并没有真正使代码更简洁（或可读）。

*如果您想要一个可以比较任意*多个元素是否相等的可重用函数，我会做这样的事情：

```
def all_equal?(*elements)
  elements.all? { |x| x == elements.first }
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T18:23:00.500

```
dog == cat && dog == chicken 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-04T12:39:56.060

给定数字进行比较：

狗='动物'

猫='动物'

鸡='动物'

鞋='衣服'

创建一个数组：

```
arr = [dog, cat, chicken, shoe]
arr_length = arr.reject { |a| a != dog }.length

if arr_length == 0
puts "All numbers are equal"
end 
```

# sql - 在插入的子选择中更新

> ID：12846083
> 
> 赞同：-1
> 
> 时间：2012-10-11T18:19:59.063
> 
> 标签：sql

是否可以将更新查询放入插入查询的子选择中？喜欢：

```
select * from db.testtable
where
col1 = 1 or
(UPDATE ...); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:22:23.263

根据您的数据库引擎，您可以执行类似的操作

```
INSERT INTO table (a,b,c) VALUES (1,2,3)
ON DUPLICATE KEY UPDATE c=c+1; 
```

以避免重复和更新。

# java - 嵌入式类/数据库结构

> ID：12846088
> 
> 赞同：0
> 
> 时间：2012-10-11T18:20:30.923
> 
> 标签：java, playframework, playframework-2.0, ebean

我正在尝试将我的多层菜单存储在数据库中。我有一个`HorizontalMenu`包含`List<MenuItem>`其项目的类。我的`MenuItem`类包含一个`String`用于文本、一个`String`用于 URL 和另一个`HorizontalMenu`用于子菜单（如果有的话）。

所以我的主菜单可以有任意数量的`MenuItem`s，每个可以有零或一个`HorizontalMenu`s。

**所以我想知道如何在代码中准确设置它，以便在数据库中正确设置。**

我正在使用 Ebeans 和 Play Framework 2.0，所以在这些方面的答案会很好，但如果有人可以用 DB 术语指出我正确的方向，那也很好。

* * *

* * *

这是我到目前为止所得到的：

## Horizo​​ntalMenu.java：

```
@Entity
@Embeddable
public class HorizontalMenu extends Model{

    @Id
    @GeneratedValue
    public Long id;

    public List<MenuItem> items;

    public Long getId()
    {
        return this.id;
    }
    public void setId(Long id)
    {
        this.id = id;
    }

    public List<MenuItem> getItems()
    {
        return this.items;
    }
    public void setItems(List<MenuItem> items)
    {
        this.items = items;
    }

    public static Finder find = new Finder(Long.class, HorizontalMenu.class);
} 
```

## 菜单项.java：

```
@Entity
@Embeddable
public class MenuItem {
    @Id
    public Long id;
    public String text;
    public String url;
    public HorizontalMenu subMenu;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T12:50:35.853

因为你的`MenuItem`课是`@Embeddable`. 类中的数据成员项`HorizontalMenu`将是`@Embedded`. 所以，它应该是这样的：

```
@Embedded
public List<MenuItem> items; 
```

由于您`MenuItem`的标记为`@Embeddable`，因此您不必将其标记为`@Entity`。`Object`a要成为`Entity`eg有一定的要求`Id`。并且`Embeddable`对象没有唯一的身份。所以，不要打扰。

为了快速测试这一点，请创建一个内存数据库。现在，当您启动您的应用程序时 - 数据库将即时创建。因此，您将能够看到表格的布局方式。执行的脚本在 conf 目录中可用。

为了进一步测试 - 在应用程序启动期间通过 YAML 插入一些数据（提示 - 查看 GlobalSettings 对象，Play Docs 中提供的示例）并查看它是否正确插入。

# powershell - 使用 PowerShell 设置 AppPool 空闲超时

> ID：12846092
> 
> 赞同：0
> 
> 时间：2012-10-11T18:20:45.833
> 
> 标签：powershell, iis-6, application-pool

如何使用 powershell 设置 IIS6 应用程序池的空闲超时？我从搜索中看到的只是如何设置不完全相同的应用程序池回收时间。

这就是出现的情况，但我认为这不是我想要的：

```
$destinationPool.recycling.periodicRestart.schedule 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:58:16.370

我无法测试它，但试试这个：

```
$ApplicationPool = Get-WmiObject -Class IISApplicationPoolSetting -Namespace "root/microsoftiisv2" | Where-Object {$_.Name -eq 'W3SVC/APPPOOLS/DefaultAppPool'}
$ApplicationPool.IdleTimeout=0
$ApplicationPool.Put() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-06T00:07:32.783

使用 DSC（所需状态配置）

```
cAppPool $application.AppPool.Name 
{ 
    Name                    = $application.AppPool.Name                 
    AutoStart               = $application.AppPool.AutoStart            
    StartMode               = $application.AppPool.StartMode            
    ManagedRuntimeVersion   = $application.AppPool.ManagedRuntimeVersion
    ManagedPipelineMode     = $application.AppPool.ManagedPipelineMode  
    IdentityType            = $application.AppPool.IdentityType  
    LoadUserProfile         = $application.AppPool.LoadUserProfile
    Ensure                  = "Present" 
    idleTimeout             = "00:00:00"
} 
```

这`idleTimeout`是一个类型`string`而不是一个`int`类型的事实让我绊倒了一段时间。尝试`"0"`静默使用会将其保留为默认 20 分钟

（参见[GitHub 上的 cAppPool](https://github.com/PowerShellOrg/cWebAdministration/blob/master/DSCResources/PSHOrg_cAppPool/PSHOrg_cAppPool.psm1)）

# iphone - 将 json_encoded 数据解析为用于 UIPickerView 的数组 - Xcode

> ID：12846093
> 
> 赞同：0
> 
> 时间：2012-10-11T18:20:46.990
> 
> 标签：iphone, objective-c, xcode, uipickerview, json

我正在寻找一个要在pickerview中使用的数组。数组的数据是从数据库表中生成的。

我有以下 JSON_ENCODED 数组（在 php 中创建）：

```
{"result":
 [
  {"id":"3","quivername":"Kite Boarding"},
  {"id":"4","quivername":"Live and Die in LA"},
  {"id":"14","quivername":"Bahamas Planning"},
  {"id":"15","quivername":"My Trip to India"},
  {"id":"16","quivername":"Snowboarding"}
 ]
} 
```

WEBSERVICE PHP 代码更新

我将此功能作为网络服务运行：

```
passport($_SESSION['IdUser'])

function passport($userid) {

$result = query("SELECT id, quivername FROM quivers WHERE userid = $userid");

if (!$result['error']) {
    print json_encode($result);
} else {
        errorJson('Can not get passports');
    }
}

function query() {
global $link;
$debug = false;

//get the sql query
$args = func_get_args();
$sql = array_shift($args);

//secure the input
for ($i=0;$i<count($args);$i++) {
    $args[$i] = urldecode($args[$i]);
    $args[$i] = mysqli_real_escape_string($link, $args[$i]);
}

//build the final query
$sql = vsprintf($sql, $args);

if ($debug) print $sql;

//execute and fetch the results
$result = mysqli_query($link, $sql);
if (mysqli_errno($link)==0 && $result) {

    $rows = array();

    if ($result!==true)
    while ($d = mysqli_fetch_assoc($result)) {
        array_push($rows,$d);
    }

    //return json
    return array('result'=>$rows);

} else {

    //error
    return array('error'=>'Database error');
}
} 
```

我在 XCODE 中使用此代码使用 NSNetworking 连接到 WEB 服务/网站...

```
-(void)getPassports {
    //just call the "passport" command from the web API
    [[API sharedInstance] commandWithParams:[NSMutableDictionary dictionaryWithObjectsAndKeys:
        @"passport",@"command",
        nil]
        onCompletion:^(NSDictionary *json) 
        {
        //got passports, now need to populate pickerArray1
        if (![json objectForKey:@"error"])
        {
                    //success, parse json data into array for UIPickerview
        } 
        else
        //error, no passports
        {
                    // error alert
        }

        }];
} 
```

我需要以下内容：

1）如何使用 quivername 值填充 NSMutable 数组？我试图让结果看起来像这样：

```
pickerArray1 = [[NSMutableArray alloc] initWithObjects:@"Kite Boarding",
@"Live and Die in LA", @"Bahamas Planning", @"My Trip to India", @"Snowboarding",
nil]; 
```

我假设我需要运行一个 for 循环，这需要我首先“计算”数组中的行数，但我不确定。我不知道如何计算 json_array 中的行数或创建 NSMutable 数组。

提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:35:59.860

您应该能够使用 NSData 从返回 JSON 的 URL 中获取您的 NSData `[NSData dataWithContentsOfURL:yourURLValue]`，然后根据您的 JSON 使用类似于以下内容的内容传递数据并解析：

```
 //INVOKE WEB SERVICE QUERY IN VIEW DID LOAD -- RUNS ASYNC SO WONT BLOCK UI
- (void)viewDidLoad
{
    [super viewDidLoad];

    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
        NSData* data = [NSData dataWithContentsOfURL: 
          @"URLOFYOURWEBSERVICE"];  // <-- may need to cast string to NSURL....
        NSMutableArray *quivernames = [self performSelectorOnMainThread:@selector(fetchedData:) 
          withObject:data waitUntilDone:YES];
    });
}

- (NSMutableArray *)fetchedData:(NSData *)responseData {
    //parse out the json data
    NSError* error;
    //ARRAY OR DICT DEPENDING ON YOUR DATA STRUCTURE
    NSDictionary* json = [NSJSONSerialization 
        JSONObjectWithData:responseData 

        options:kNilOptions 
        error:&error];
    //ITERATE AND/OR ADD OBJECTS TO YOUR NEW ARRAY
    NSMutableArray* JSONResultValues = [json objectForKey:@"yourKey"]; 
    NSMutableArray* resultValues = [[NSMutableArray alloc] init];
   for(int x = 0; x< [JSONResultValues count]; x++){
       NSDictionary *tempDictionary = [JSONResultValues objectAtIndex:x];
       [resultValues addObject:[tempDictionary objectForKey:@"quivername"]];
    }

    NSLog(@"Results Count: %@", [JSONResultValues count]);
   NSLog(@"Results Count: %@", [resultValues count]);
    return resultValues;
} 
```

编辑：有关更多信息，请查看 JSON 解析的说明[http://www.raywenderlich.com/5492/working-with-json-in-ios-5](http://www.raywenderlich.com/5492/working-with-json-in-ios-5)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T18:44:33.130

你可以试试这个（未经测试）：

```
 //convert this to NSData, not sure how it is getting into obj-c
 {"result":[
  {"id":"3","quivername":"Kite Boarding"},
  {"id":"4","quivername":"Live and Die in LA"},
  {"id":"14","quivername":"Bahamas Planning"},
  {"id":"15","quivername":"My Trip to India"},
  {"id":"16","quivername":"Snowboarding"}
]};

NSMutableArray* myData = [self fetchedData:responseData]; 

- (NSMutableArray* )fetchedData:(NSData *)responseData {

    //parse out the json data
    NSError* error;
    NSDictionary* json = [NSJSONSerialization 

        JSONObjectWithData:responseData 

        options:kNilOptions 
        error:&error
    ];

    NSMutableArray* quivers = [json objectForKey:@"result"];

    return quivers;
 } 
```

[文德利希在这里解释...](http://www.raywenderlich.com/5492/working-with-json-in-ios-5)

# windows - 使用 JDK 7 构建 Cocoon 2.1.0 失败：compile-build.xml:68

> ID：12846098
> 
> 赞同：4
> 
> 时间：2012-10-11T18:21:08.770
> 
> 标签：windows, apache-cocoon

我正在使用 java JDK 7 在 Windows 2008 R2 上构建 cocoon 2.1.10 以最终在 Tomcat 7 中部署。我已经下载了 cocoon 源文件，解压缩它们，设置我的 JAVA_HOME 变量，然后尝试运行 build.bat提供的文件。我得到 11 个不同的编译错误。

```
 D:\cocoon-2.1.10-src\cocoon-2.1.10>build.bat
    Buildfile: build.xml

    prepare:
    ====================================================================
                     Apache Cocoon 2.1.10 [1999-2006]
    ====================================================================
     Building with Apache Ant version 1.6.5 compiled on June 2 2005
    --------------------------------------------------------------------
     Using build file D:\cocoon-2.1.10-src\cocoon-2.1.10\build.xml
    --------------------------------------------------------------------
     Compiler options:
       - debug ......... [on]
       - optimize ...... [on]
       - deprecation ... [off]
    ====================================================================

    compile-core:
    Compiling 594 source files to D:\cocoon-2.1.10-src\cocoon-2.1.10\build\cocoon\classes
    D:\cocoon-2.1.10-src\cocoon-2.1.10\src\java\org\apache\cocoon\reading\ImageReader.java:39: error: package com.
    sun.image.codec.jpeg does not exist
    import com.sun.image.codec.jpeg.ImageFormatException;
                                   ^
    D:\cocoon-2.1.10-src\cocoon-2.1.10\src\java\org\apache\cocoon\reading\ImageReader.java:40: error: package com.
    sun.image.codec.jpeg does not exist
    import com.sun.image.codec.jpeg.JPEGCodec;
                                   ^
    D:\cocoon-2.1.10-src\cocoon-2.1.10\src\java\org\apache\cocoon\reading\ImageReader.java:41: error: package com.
    sun.image.codec.jpeg does not exist
    import com.sun.image.codec.jpeg.JPEGEncodeParam;
                                   ^
    D:\cocoon-2.1.10-src\cocoon-2.1.10\src\java\org\apache\cocoon\reading\ImageReader.java:42: error: package com.
    sun.image.codec.jpeg does not exist
    import com.sun.image.codec.jpeg.JPEGImageEncoder;
                                   ^
    D:\cocoon-2.1.10-src\cocoon-2.1.10\src\java\org\apache\cocoon\reading\ImageReader.java:326: error: cannot find
     symbol
                        JPEGImageEncoder encoder = JPEGCodec.createJPEGEncoder(out);
                        ^
      symbol:   class JPEGImageEncoder
      location: class ImageReader
    D:\cocoon-2.1.10-src\cocoon-2.1.10\src\java\org\apache\cocoon\reading\ImageReader.java:326: error: cannot find
     symbol
                        JPEGImageEncoder encoder = JPEGCodec.createJPEGEncoder(out);
                                                   ^
      symbol:   variable JPEGCodec
      location: class ImageReader
    D:\cocoon-2.1.10-src\cocoon-2.1.10\src\java\org\apache\cocoon\reading\ImageReader.java:327: error: cannot find
     symbol
                        JPEGEncodeParam p = encoder.getDefaultJPEGEncodeParam(currentImage);
                        ^
      symbol:   class JPEGEncodeParam
      location: class ImageReader
    D:\cocoon-2.1.10-src\cocoon-2.1.10\src\java\org\apache\cocoon\reading\ImageReader.java:333: error: cannot find
     symbol
                        JPEGImageEncoder encoder = JPEGCodec.createJPEGEncoder(bstream);
                        ^
      symbol:   class JPEGImageEncoder
      location: class ImageReader
    D:\cocoon-2.1.10-src\cocoon-2.1.10\src\java\org\apache\cocoon\reading\ImageReader.java:333: error: cannot find
     symbol
                        JPEGImageEncoder encoder = JPEGCodec.createJPEGEncoder(bstream);
                                                   ^
      symbol:   variable JPEGCodec
      location: class ImageReader
    D:\cocoon-2.1.10-src\cocoon-2.1.10\src\java\org\apache\cocoon\reading\ImageReader.java:334: error: cannot find
     symbol
                        JPEGEncodeParam p = encoder.getDefaultJPEGEncodeParam(currentImage);
                        ^
      symbol:   class JPEGEncodeParam
      location: class ImageReader
    D:\cocoon-2.1.10-src\cocoon-2.1.10\src\java\org\apache\cocoon\reading\ImageReader.java:342: error: cannot find
     symbol
                } catch (ImageFormatException e) {
                         ^
      symbol:   class ImageFormatException
      location: class ImageReader
    11 errors

    BUILD FAILED
    D:\cocoon-2.1.10-src\cocoon-2.1.10\tools\targets\compile-build.xml:68: The following error occurred while exec
    uting this line:
    D:\cocoon-2.1.10-src\cocoon-2.1.10\tools\targets\compile-build.xml:51: Compile failed; see the compiler error
    output for details. 

```

我还尝试在命令行上使用“构建战争”，这产生了相同的结果。

这是我正在使用的 JDK 的问题，还是我需要查看其他内容？这是我第一次尝试构建和部署茧，我可能会遗漏一些明显的东西。

问候，托尼

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T08:48:05.167

`com.sun.image.jpeg.codec`已从 JDK 7 中删除了已弃用的专有软件包（请参阅此[官方 JDK7 兼容性说明](http://www.oracle.com/technetwork/java/javase/compatibility-417013.html)）。因此你的编译问题。

由于在您的情况下可能无法选择修补 Cocoon 源代码，因此最短的路径可能是**使用 JDK 6**（或更早版本，[Cocoon 2.1 系列需要“Java 1.3 或更高版本”](http://cocoon.apache.org/2.1/installing/requirements.html)）进行编译。

（但如果是这样，因为您似乎需要特定的 Cocoon 和 JDK 版本，您可能需要查看关于[如何](https://stackoverflow.com/q/8015291/326294)用调用标准 Java Image替换 com.sun.image.codec.jpeg.JPEGImageEncoder 的 SO Q&A输入/输出接口）

* * *

另一种选择可能是查看`com.sun.image.jpeg.codec`要包含在构建（可能还有运行时）类路径中的包的单​​独分发。我不确定此选项的可用性（和易用性）。无论如何，除非所有其他路径都被证明是死胡同，否则我不建议深入研究它......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T14:58:08.227

在我的情况下，此错误的解决方案是：搜索已认可的文件夹，它应该在路径中：cocoon-2.1.11-src\cocoon-2.1.11\lib\endorsed 将此文件夹复制到您当前的 JAVA_HOME/jre/lib 中并且尝试再次构建。我希望这能解决你的问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-31T22:36:41.197

我知道这是旧的，但如果有人感兴趣，我最近能够构建 cocoon 2.1 而没有错误

我必须从他们当前的开发分支（2_1_X）获取最新的源代码，因为我发现他们已经修复了这个错误，但它仍然不在他们的最新版本（2.1.12）中

我实际上能够使用 JDK 8 构建它，也可以使用 Tomcat 8 运行它。必须进行一些调整才能使其正常工作

# ruby - 在 BoundingBox 内创建一组随机的 LatLngs

> ID：12846099
> 
> 赞同：1
> 
> 时间：2012-10-11T18:21:08.710
> 
> 标签：ruby, gis

我正在尝试在边界框内创建随机纬度/经度。下面的代码创建了纬度/经度，它们在地图上绘制......虽然它们在正确的国家，但它们不在正确的“盒子”中

我的边界框如下所示：

```
top_left = 51.514881121099904, -0.1293877362387679 
bottom_right = 51.492151803709525, -0.09693947143827275

minLat = 51.514881121099904
maxLat = 51.492151803709525
minLng =  -0.09693947143827275
maxLng = -0.1293877362387679 
```

我的代码如下所示：

```
markers = []

10.times do
    x = minLat + rand(maxLat - minLat)
    y = minLng + rand(maxLng - minLng)
    latLng = [x,y]
    markers <<  latLng
end

markers.each do |x|
    puts "#{x[0]} , #{x[1]}"
end 
```

但它没有输出正确的纬度/经度。有什么我做错了吗？我看错了吗？

例如一次运行输出：

```
51.51778835694538 , 0.8479098023328967
51.56834519895925 , 0.70003581382595
52.47933844269927 , 0.6167209565236026
51.52116824209034 , 0.8997051592766233
52.26830135905681 , 0.7514635122980192
52.143607260212896 , 0.21838042686322268
52.04649651836466 , 0.6683244476203801
52.057410769358576 , -0.08734906181439461
52.053408170846915 , 0.1600069328435182
51.8991829618331 , 0.3993135670912452 
```

但显然 52.26830135905681 不在最小和最大纬度之间......所以我有点困惑

rand() 是否进行某种排序或四舍五入。它可以在这么大的花车上工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T19:16:59.917

rand() 是如何定义的？一时想不起来了……

您可以使用 ruby​​ 的 Random 类（[http://www.ruby-doc.org/core-1.9.3/Random.html](http://www.ruby-doc.org/core-1.9.3/Random.html)）并执行以下操作：

```
rng = Random.new(seed)
lat = minLat + rng.rand * (maxLat - minLat)
lng = minLng + rng.rand * (maxLng - minLng) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:24:35.127

rand在它的论点上使用[to_i.abs 。](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-rand)更好用`rand(minLat..maxLat)`。此外，在您的代码中，最小值和最大值似乎混淆了。

```
maxLat = 51.514881121099904
minLat = 51.492151803709525
maxLng = -0.09693947143827275
minLng = -0.1293877362387679 
markers = []

10.times do
  markers << [rand(minLat..maxLat), rand(minLng..maxLng)]
end

markers.each do |lat, lng|
  puts "#{lat} , #{lng}"
end 
```

# php - 征集基于 PHP 5 的事务协调器的想法

> ID：12846102
> 
> 赞同：0
> 
> 时间：2012-10-11T18:21:23.417
> 
> 标签：php

我希望有人能激发一些想法或提供参考资料，以在 PHP 5 中创建“事务协调器”实现。驱动程序基于多供应商单一业务流程集成。由于潜在的故障点，我想避免带有大量 if、开关、try..catch 的意大利面条代码，并有一个可以拦截方法调用、跟踪对后续调用的响应并询问方法属性以确定补偿功能的协调器用于撤销交易。目的是创建类似“ACID”的处理。我可以参考的最后一个东西是 .Net 中的 TransactionScope 对象。

示例场景：

```
ServiceA
ServiceB
ServiceC

ServiceA->DoSomething() - passes
ServiceB->DoSomething() - passes
ServiceC->DoSomething() - fails 
```

此时 A & B 必须采用某种类型的补偿策略来调用将返回状态的功能，无论是数据库、第三方集成还是以其他方式返回其原始状态。

我最初的想法是使用某种类型的 AOP 来保存对补偿器的引用和完成反转活动的状态要求。协调器需要跟踪执行以及返回的执行状态以允许调用补偿器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:53:21.793

不要尝试 ACID，因为你做不到。试图伪造它会在某些时候泄漏，所以最好不要一开始就尝试。正如您自己编写的那样，使用服务 A 执行一步，后来看到服务 C 失败，您需要告诉服务 A 撤消已采取的一步。如果无法撤消单个步骤，则解决方法可能是使用服务 A 重新启动，执行重置和所有先前完成的步骤，而不是事务中的最后一个步骤。这听起来一点也不酸。假装它在某个时候会失败。

在为流程建模时，请为其使用有限状态机。它独立于您的服务能做什么或不能做什么，但您可以跟踪需要采取哪些步骤，可能按什么顺序执行，如果步骤失败该怎么办，并且在任何时候扩展都相对容易。

关于您的评论，您可能会陷入混乱的 if、switch 和 try/catch：这完全取决于您，但与实施流程无关。

如果您正在寻找状态机的实现，那么 PHP 没有那么多。PEAR 有一个非常 PHP4 风格的旧版本，它可能仍然可以工作并完成工作（看看： http: [//pear.php.net/package/FSM](http://pear.php.net/package/FSM)），但更好的实现是[https://github。 com/Metabor/Statemachine](https://github.com/Metabor/Statemachine) - 这家伙已经写了“状态机”，我看到了一些非常好的特性，例如通过回调将执行工作的代码移交给转换，然后通过事件更改转换。这样做的好处是您的状态机可以完全控制可以做什么和不可以做什么，如果可以完成，它将通过回调来完成。

一个简洁的功能是您可以将定义的状态和转换作为图像获取。

# c# - 并行代码扩展性差

> ID：12846106
> 
> 赞同：5
> 
> 时间：2012-10-11T18:21:35.710
> 
> 标签：c#, .net, multithreading, scalability, task-parallel-library

最近我一直在分析我的并行计算是如何在 16 核处理器上实际加速的。我得出的一般公式——线程越多，每个核心的速度越慢——让我很尴尬。这是我的cpu负载和处理速度的图表：

![图片1](../Images/ae059eb618bb6581d75f775e44dd830d.png)

因此，您可以看到处理器负载增加，但速度增加得慢得多。我想知道为什么会发生这种影响以及如何获得不可扩展行为的原因。我确保使用**Server GC mode**。我已经确保我正在并行化适当的代码，只要代码只做

*   从 RAM 加载数据（服务器有 96 GB 的 RAM，不应命中交换文件）
*   执行不复杂的计算
*   将数据存储在 RAM 中

我仔细**分析了**我的应用程序并没有发现任何瓶颈 - 看起来每个操作都会随着线程数的增加而变慢。

我被卡住了，我的场景有什么问题？

我使用 .Net 4 任务并行库。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-11T18:31:37.860

你总会得到这种曲线，这叫做[阿姆达尔定律](http://en.wikipedia.org/wiki/Amdahl%27s_law)。
问题是它多久会趋于平稳。

您说您检查了代码是否存在瓶颈，让我们假设这是正确的。然后还有内存带宽和其他硬件因素。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-11T22:05:01.817

线性可扩展性的关键——在从一个内核到两个内核使吞吐量翻倍的情况下——是尽可能少地使用共享资源。这表示：

*   不要使用超线程（因为两个线程共享相同的核心资源）
*   将每个线程绑定到特定的核心（否则操作系统将在核心之间处理线程）
*   不要使用比内核更多的线程（操作系统将换入和换出）
*   留在核心自己的缓存中 - 现在的 L1 和 L2 缓存
*   除非绝对必要，否则不要冒险进入 L3 缓存或 RAM
*   最小化/节省关键部分/同步使用

如果您已经走到这一步，您可能也已经对您的代码进行了概要分析和手动调整。

线程池是一种折衷方案，不适合不折不扣的高性能应用程序。总线程控制是。

不要担心操作系统调度程序。如果您的应用程序受 CPU 限制，需要进行长时间的计算，主要是进行本地 L1 和 L2 内存访问，那么将每个线程绑定到自己的内核是一个更好的性能选择。当然操作系统会进来，但与你的线程正在执行的工作相比，操作系统的工作可以忽略不计。

另外我应该说我的线程经验主要来自 Windows NT 引擎机器。

****_ *_* __ *_* _***编辑****_* __ *_* __ *_*****

 **并非所有内存访问都与数据读取和写入有关（请参阅上面的评论）。一个经常被忽视的内存访问是获取要执行的代码。所以我关于留在核心自己的缓存中的声明意味着确保所有必要的数据和代码都驻留在这些缓存中。还要记住，即使是非常简单的 OO 代码也可能会生成对库例程的隐藏调用。在这方面（代码生成部门），OO 和解释代码比 C（通常是所见即所得）或程序集（完全所见即所得）要少得多。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-11T18:29:57.347

更多线程的回报普遍减少可能表明某种瓶颈。

是否有任何共享资源，例如集合或队列或其他东西，或者您是否使用了一些可能依赖于某些有限资源的外部函数？

8 线程的突然中断很有趣，在我的评论中，我询问 CPU 是真正的 16 核还是具有超线程的 8 核，其中每个内核在操作系统中显示为 2 个内核。

如果是超线程，要么你的工作量太大，以至于超线程无法使核心的性能翻倍，要么通往核心的内存管道无法处理两倍的数据吞吐量。

线程执行的工作是均匀还是某些线程比其他线程做得更多，这也可能表明资源不足。

由于您添加了线程非常频繁地查询数据，这表明等待的风险非常大。

有什么方法可以让线程每次获取更多数据？喜欢阅读 10 项而不是一项？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-12T16:24:08.023

您的线程是否正在读取和写入内存中靠近的项目？那么您可能会遇到虚假共享。如果线程 1 使用 data[1] 而线程 2 使用 data[2]，那么即使在理想世界中，我们知道线程 2 连续两次读取 data[2] 将始终产生相同的结果，但在现实世界中，如果 thread1 在这两次读取之间的某个时间更新 data[1]，则 CPU 会将缓存标记为脏并更新它。[http://msdn.microsoft.com/en-us/magazine/cc872851.aspx](http://msdn.microsoft.com/en-us/magazine/cc872851.aspx)。要解决这个问题，请确保每个线程正在使用的数据在内存中与其他线程正在使用的数据足够远。

这可能会给你带来性能提升，但可能不会让你达到 16 倍——引擎盖下发生了很多事情，你只需要一个接一个地敲掉它们。实际上，并不是说您的算法在多线程时以 30% 的速度运行；更重要的是，您的单线程算法以 300% 的速度运行，由运行多线程的各种 CPU 和缓存功能支持，而运行多线程则更难利用。所以没有什么可“尴尬”的。 *但是*通过一些努力，您*也许*可以让多线程版本以接近 300% 的速度运行。

此外，如果您将超线程内核视为真正的内核，那么它​​们不是。它们只允许线程在一个被阻塞时快速交换。但是它们永远不会让你以双倍速度运行，除非你的线程无论如何都被阻塞了一半，在这种情况下，这已经意味着你有机会加速。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-11T18:33:51.527

如果你正在做内存密集型的事情，你可能会达到缓存容量。

您可以使用模拟算法对此进行测试，如果数据一遍又一遍地处理相同的一小部分，因此它们都应该适合缓存。

如果它确实是缓存，可能的解决方案可能是让线程以某种方式处理相同的数据（如小数据窗口的不同部分），或者只是将算法调整为更本地化（如排序，合并排序通常比快速排序慢，但它对缓存更友好，在某些情况下仍然使它更好）。**

# reverse-proxy - 如何在 squid 2.7 中使用 3.1 功能“ignore-cc”

> ID：12846107
> 
> 赞同：0
> 
> 时间：2012-10-11T18:21:34.913
> 
> 标签：reverse-proxy, squid

有什么方法可以忽略客户端“ **Cache-Control: max-age=0** ”并总是让 squid 返回**过时的内容**？

在 Squid 3.2 中使用“ignore-cc”并且请求永远不会到达后端（仅在重新验证时），总是过时但在 Squid 2.7 中工作正常，除非您发送**Cache-control: max-age=0**和**If-Modified-Since**标题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T11:55:39.503

好吧，在尝试了所有替代方案之后，我修改了源代码以实现该功能。

我在**Squid-2.7-stable9**中更改了文件**src/** refresh.c : *282*：

```
282:    if (request) { 
```

为了

```
282:    if (request && FALSE) { 
```

* * *

他们在 3.X 中做了类似的事情来实现 ignoreCc：

```
269:    if (request && !request->flags.ignore_cc) { 
```

按预期工作。

# java - Eclipse 中的 GWT 编译错误

> ID：12846108
> 
> 赞同：1
> 
> 时间：2012-10-11T18:21:39.937
> 
> 标签：java, eclipse, gwt

我正在努力编译一个 GWT 项目。我确认项目引用了 GWT、AppEngine 和必要的库*（在**Java Build Path**中添加，GWT 也从 Marketplace 成功安装）*。

使用上面的设置，我尝试使用 GWT 构建，我得到了

> java.lang.NoClassDefFoundError: com/google/gwt/dev/Compiler

一遍又一遍地。

然后尝试在**Windows CLASSPATH中设置****gwt-dev.jar**，我可以摆脱这个错误但最终得到

 **> [错误] 无法在您的类路径中找到“some/package/My_Project.gwt.xml”；可能是拼写错误，或者您忘记包含源的类路径条目？

我试图将项目类路径设置为`some/package/`但没有用。

即使我可以设法克服这个错误***一次***，我又遇到了另一个错误：

> java.lang.NoClassDefFoundError：com/google/appengine/tools/enhancer/Enhance。

我搞砸了环境，无法解决我遇到的最后一个错误，而我只是陷入了第二个错误。

我尝试删除所有运行配置、创建新工作区和从头开始导入项目，并尝试了我在 Google 上找到的所有内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:55:53.793

你看过这个答案吗：[GWT/Eclipse: ClassNotFoundException com/google/gwt/dev/Compiler](https://stackoverflow.com/questions/4075839/gwt-eclipse-classnotfoundexception-com-google-gwt-dev-compiler)

此外，您可以尝试清理您的项目并通过 eclipse 中通常的类路径配置添加 jar 文件（右键单击您的项目）。然后，您可以从插件中添加 gwt-dev.jar 文件。确保使用安装在 eclipse 插件中的那个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T05:09:10.880

`[ERROR]` `Unable to find 'some/package/My_Project.gwt.xml' on your`

`classpath`; 可能是错字，或者您忘记包含`classpath`

输入源？

查看链接以获取更多信息...[这里](http://code.google.com/p/google-web-toolkit-doc-1-4/wiki/FAQ_UnableToFindModule)**

# c# - 如何实例化、操作和返回Type T

> ID：12846115
> 
> 赞同：4
> 
> 时间：2012-10-11T18:21:47.067
> 
> 标签：c#, generics

我有一个函数，我想使用泛型返回 CreditSupplementTradeline 或 CreditTradeline。问题是，如果我创建一个 T ctl = new T(); ...我无法对 ctl 进行操作，因为 VS2010 无法识别它的任何属性。这可以做到吗？谢谢你。

```
 internal T GetCreditTradeLine<T>(XElement liability, string creditReportID) where T: new()
    {
        T ctl = new T();
        ctl.CreditorName = this.GetAttributeValue(liability.Element("_CREDITOR"), "_Name");
        ctl.CreditLiabilityID = this.GetAttributeValue(liability, "CreditLiabilityID");
        ctl.BorrowerID = this.GetAttributeValue(liability, "BorrowerID");
        return ctl;
    } 
```

我收到此错误：

> 错误 8“T”不包含“CreditorName”的定义，并且找不到接受“T”类型的第一个参数的扩展方法“CreditorName”（您是否缺少 using 指令或程序集引用？）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-11T18:23:15.243

您需要有一个具有适当属性的接口，例如：

```
internal interface ICreditTradeline
{
     string CreditorName { get; set; }
     string CreditLiabilityID { get; set; }
     string BorrowerID { get; set; }
} 
```

在您的方法上，您需要添加一个约束以`T`要求它必须实现上述接口：

```
where T: ICreditTradeline, new() 
```

你的两个类应该实现接口：

```
class CreditTradeline  : ICreditTradeline
{
     // etc...
}

class CreditSupplementTradeline  : ICreditTradeline
{
     // etc...
} 
```

然后您可以使用类作为类型参数调用该方法：

```
CreditTradeline result = this.GetCreditTradeLine<CreditTradeline>(xElement, s); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-11T18:25:20.533

现在，您的程序只知道 T 至少是`object`具有无参数构造函数的 a。您需要更新您的`where T`以包含一个接口约束，该约束告诉您的函数 T 是某个接口的成员，该接口包含`CreditorName`、`CreditLiabilityID`和的定义`BorrowerID`。你可以这样做：

```
where T: InterfaceName, new() 
```

# python - Python 描述符与属性

> ID：12846116
> 
> 赞同：20
> 
> 时间：2012-10-11T18:21:50.513
> 
> 标签：python, properties, descriptor

> **可能重复：**
> [何时以及为什么我可以将描述符类的实例分配给 Python 中的类属性而不是使用属性？](https://stackoverflow.com/questions/5842593/when-and-why-might-i-assign-an-instance-of-a-descriptor-class-to-a-class-attribu)

我对何时使用属性与描述符感到困惑。我读到一个属性是一个专门的描述符。

有人可以发布这是如何工作的吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-11T18:27:58.357

您应该阅读有关实际上是什么描述符的文档。Cliff's Notes 版本：描述符是一种低级机制，可让您连接到正在访问的对象的属性。属性是它的高级应用；也就是说，属性是使用描述符实现的。或者，更好的是，属性*是*标准库中已经为您提供的描述符。

如果您需要一种简单的方法来从属性读取中返回计算值，或者在属性写入时调用函数，请使用`@property`装饰器。描述符 API 更灵活，但不太方便，并且在这种情况下可以说是“矫枉过正”且不习惯。它对于更高级的用例很有用，例如实现绑定方法或静态和类方法；例如，当您需要知道属性是通过类型对象还是类型的实例访问时。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-10-11T18:33:38.737

[您可以从此处](http://www.linuxtopia.org/online_books/programming_books/python_programming/python_ch25.html)阅读有关两者的更多信息。但这里有一个来自同一本书的简单例子，它试图解释解决本质上是同一个问题的区别。如您所见，使用属性的实现要简单得多。

有几种方法可以利用 Python 的内部机制来获取和设置属性值。最容易使用的技术是使用属性函数来定义与属性名称关联的 get、set 和 delete 方法。属性函数为您构建描述符。一种不太容易访问但更可扩展和可重用的技术是自己定义描述符类。这为您提供了相当大的灵活性。为此，您可以创建一个定义 get、set 和 delete 方法的类，并将描述符类与属性名称相关联。

属性函数为我们提供了一种方便的方法来实现一个简单的描述符，而无需定义一个单独的类。我们可以编写 getter 和 setter 方法函数，然后将这些函数绑定到一个属性名称，而不是创建一个完整的类定义。

描述符示例：

```
class Celsius( object ):
    def __init__( self, value=0.0 ):
        self.value= float(value)
    def __get__( self, instance, owner ):
        return self.value
    def __set__( self, instance, value ):
        self.value= float(value)

class Farenheit( object ):
    def __get__( self, instance, owner ):
        return instance.celsius * 9 / 5 + 32
    def __set__( self, instance, value ):
        instance.celsius= (float(value)-32) * 5 / 9

class Temperature( object ):
    celsius= Celsius()
    farenheit= Farenheit()
>>>
oven= Temperature()
>>>
oven.farenheit= 450
>>>
oven.celsius
232.22222222222223
>>>
oven.celsius= 175
>>>
oven.farenheit
347.0 
```

属性示例：

```
class Temperature( object ):
    def fget( self ):
        return self.celsius * 9 / 5 + 32
    def fset( self, value ):
        self.celsius= (float(value)-32) * 5 / 9
    farenheit= property( fget, fset )
    def cset( self, value ):
        self.cTemp= float(value)
    def cget( self ):
        return self.cTemp
    celsius= property( cget, cset, doc="Celsius temperature" )
>>>
oven= Temperature()
>>>
oven.farenheit= 450
>>>
oven.celsius
232.22222222222223
>>>
oven.celsius= 175
>>>
oven.farenheit
347.0 
```

# c++ - windows中的wxwidgets错误

> ID：12846117
> 
> 赞同：3
> 
> 时间：2012-10-11T18:21:54.933
> 
> 标签：c++, windows, wxwidgets

当我使用 wxFRAME_NO_TASKBAR | 创建一个简单的应用程序时 wxBORDER_NONE 如下

```
#include <wx/wx.h>class Simple : public wxFrame

class Simple : public wxFrame
{
public:
    Simple(const wxString& title);

};

Simple::Simple(const wxString& title)
       : wxFrame(NULL, wxID_ANY, title, wxDefaultPosition, wxSize(250,     150),wxFRAME_NO_TASKBAR | wxBORDER_NONE)
{
  Centre();
}

class MyApp : public wxApp
{
  public:
    virtual bool OnInit();
};

IMPLEMENT_APP(MyApp)

bool MyApp::OnInit()
{
    Simple *simple = new Simple(wxT("Simple"));
simple->Show(true);

return true;
} 
```

当我在此应用程序运行时尝试关闭计算机时，它显示“0x00780065 处的指令引用了 0x00780065 处的内存无法写入内存”。

要防止注销，您可以执行以下操作 启动记事本，然后键入内容。然后启动编译好的程序。然后尝试注销。你会看到错误。当记事本询问您是否要保存时，什么也不做。几秒钟后，将弹出一个窗口，其中包含强制注销的选项。单击取消。这样，您可以在不注销的情况下重复该问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T22:00:18.963

我认为您需要处理关闭事件。

[http://docs.wxwidgets.org/trunk/classwx_close_event.html](http://docs.wxwidgets.org/trunk/classwx_close_event.html)

特别注意 EVT_END_SESSION 的讨论

# php - GET 变量未被访问

> ID：12846118
> 
> 赞同：3
> 
> 时间：2012-10-11T18:21:55.273
> 
> 标签：php, get, request

我有一个简单的*7 行* `PHP`脚本，如下所示：

# 代码

```
require( "connect.php" );
$ctg = ($_GET['ctg'])? $_GET['ctg']:'movie';
$offset = ($_GET['off'])? $_GET['off']:30;
$query = "SELECT `msg`, `id`, `nick`, `date` FROM `entries` WHERE `ctg` = ? ORDER BY `id` DESC LIMIT 15 OFFSET ?";
$statemnt = $conn->prepare( $query );
$statemnt->bindParam( 1, $ctg, PDO::PARAM_STR );
$statemnt->bindParam( 2, $offset, PDO::PARAM_INT );
$statemnt->execute();
$results = $statemnt->fetchAll( PDO::FETCH_ASSOC );
echo "$ctg\n$offset\n" . count($results) . "\n"; 
```

# 问题

我面临的问题是这样的：当我在控制台（使用`php fetch.php`）中执行文件时，所有`echo`工作都很好。当我在没有变量的浏览器中打开页面时`$_GET`，会观察到相同的输出。

当我只提供`ctg`索引变量（例如`http://localhost/fetch.php?ctg=docu`）时，浏览器中的输出是相同的，输出是正确的；像这样：

```
docu
30
15 
```

但是当我传递`off`索引变量时（作为**OR** **OR**）；输出总是这样：*`fetch.php?off=15`* ***`fetch.php?ctg=docu&off=15`* ***`fetch.php?off=15&ctg=docu`*****

 ****```
docu
15
0 
```

# 问题

输出（和`var_dump`）都显示正确的值被传递给两个变量，那么为什么 PDO 语句没有收到任何结果？为什么`count($results)`剩下的**0**？

任何帮助表示赞赏。

* * *

# 附言

我还包括以下声明：

```
$statemnt->debugDumpParams(); 
```

将其转储到浏览器（和控制台）中：

```
SQL: [102] SELECT `msg`, `id`, `nick`, `date` FROM `entries` WHERE `ctg` = ? ORDER BY `id` DESC LIMIT 15 OFFSET ?
Params:  2
Key: Position #0:
paramno=0
name=[0] ""
is_param=1
param_type=2
Key: Position #1:
paramno=1
name=[0] ""
is_param=1
param_type=1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:35:43.403

可能`$off` `GET`变量被视为字符串，而`int`预期

改变：

```
$offset = ($_GET['off'])? $_GET['off']:30; 
```

到

```
$offset = ($_GET['off'])?(intval($_GET['off']):30; 
```

当然，所有`GET`变量都应该存在适当的验证****

# javascript - 如何补偿 JavaScript 中的 Nginx url 重写？

> ID：12846119
> 
> 赞同：3
> 
> 时间：2012-10-11T18:22:01.657
> 
> 标签：javascript, python, nginx, coffeescript, flask

我有几个 Flask 应用程序在 Nginx 反向代理后面运行。URL 以 /demo/pipeline 开头的所有请求都转到侦听端口 7001 的 Flask 实例。我正在设置 X-Script-Name 标头，以便我的 Flask 后端可以根据[http://flask.pocoo处理此根 URL .org/snippets/35/](http://flask.pocoo.org/snippets/35/)。这让后端代码生成相对于 /demo/pipeline 根目录的 url。例如 /demo/pipeline/static/utils.js。

这是我的 Nginx 配置的一部分，它将请求路由到 /demo/pipeline 应用程序：

```
server {

    listen 80;
    server_name localhost; 

    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Scheme $scheme;

    location / {

        proxy_set_header X-Script-Name /;
        proxy_pass http://localhost:7000;
    }

    location /demo/pipeline/ {

        proxy_set_header X-Script-Name /demo/pipeline;
        rewrite ^/demo/pipeline/(.*) /$1 break;
        proxy_pass http://localhost:7001;
    }

    ...
} 
```

现在我如何在客户端考虑根 URL？以我的一个 jQuery AJAX 调用为例：

```
 $.ajax
        type: 'PUT'
        url: '/subreddit/update'
        data: name: @subreddit
        error: -> $(elem)?.text val 
```

如何让这个请求转到 /demo/pipeline/subreddit/update 而不是 /subreddit/update？我不想硬编码字符串“/demo/pipeline”，因为如果我更改路由名称或删除 Nginx 反向代理，代码需要继续工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T02:54:18.473

一种方法是在包含主脚本之前将这样的脚本添加到模板中：

```
<script type="text/javascript">var APP_ROOT = {{ app_root|json_encode }};</script> 
```

（假设您已`json_encode`设置为过滤器并被`app_root`定义为应用程序的根 URL。）

然后你的 CoffeeScript 代码可以做这样的事情：

```
$.ajax
    type: 'PUT'
    url: "#{APP_ROOT}/subreddit/update"
    data: name: @subreddit
    error: -> $(elem)?.text val 
```

顺便说一句，假设`$`是jQuery，`$(elem)?.text val`是没用的；它也可以这么说，因为当没有匹配项时`$(elem).text val`jQuery 返回一个空的 jQuery 对象（而不是`null`or ），并且不会在空的 jQuery 对象上出错。`undefined``text`

# oracle10g - oracle DB中的日期日期差异（以年为单位）

> ID：12846120
> 
> 赞同：2
> 
> 时间：2012-10-11T18:22:06.300
> 
> 标签：oracle10g

我正在使用 Oracle DB 并试图找到年份的日期差异。我用谷歌搜索，发现我可以使用`DateDiff`函数。当我使用此功能时：

```
select datediff(year, date_1, date_2) as Age_Diff 
 from employee 
```

我收到一个错误

```
ORA-00904: "DATEDIFF": invalid identifier. 
```

请提出这有什么问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T18:31:01.157

`DATEDIFF`不是 Oracle 中存在的函数。

确切地说，在年份中获得两个日期之间的差异对您意味着什么？例如，如果给定日期 2010-04-01 和 2012-01-01，那么预期的输出是什么？差异是 1 年零 9 个月，那会是 1.75 吗？或者我们应该计算这 9 个月中的天数与一年中的天数，然后除以得到与 1.75 稍有不同的结果吗？

我的第一个猜测是你想要

```
SELECT months_between( date_1, date_2 )/12 years_between
  FROM employee 
```

如果您想忽略一年的任何小数部分

```
SELECT floor( months_between( date_1, date_2 )/12) floor_years_between
  FROM employee 
```

# php - 使用 PHP 启用 SVN 调用的安全方法？

> ID：12846123
> 
> 赞同：2
> 
> 时间：2012-10-11T18:22:34.090
> 
> 标签：php, apache, svn, shell

有没有办法修改 RHEL/Apache/PHP 的权限，以便以安全的方式使用 shell 命令调用 SVN - 即。shell_exec()、shell() 还是 system() ？

目前，我在尝试 shell 命令时被拒绝权限。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T05:25:56.170

你不必使用`exec()`调用和制造你自己的`svn add ...`命令，因为 PECL 有一个稳定的 PHP 扩展 - [Subversion](http://php.net/manual/en/book.svn.php)。包裹[在这里](http://pecl.php.net/package/svn)。

这样您就可以轻松访问代码中所有需要的 SVN 功能。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-11T18:25:09.410

我能够做到这一点的唯一方法是使用 SSH2 库并在特定帐户下本地连接。否则我永远无法正确设置它们。

* * *

这不是一个好的图书馆，我有 1 天的时间来测试和搜索文档，所以它绝对不是最好的方法，但至少它可以工作......

目前使用的图书馆：

```
<?php
/**
 * 
 * Runs several SSH2 commands on the devl server as root
 * 
 */
function ssh2Run(array $commands, $catchoutput = true, $server = 'localhost', $user = 'root', $logfile = NULL){

    //Open a log file for web output
    if($logfile == NULL){ $logfile = logCreate(); }

    //Connect to ssh2
    $connection = ssh2_connect($server);
    $hostkey = ssh2_fingerprint($connection);
    logWrite($logfile, 'Connected to '.$server.', hostkey = '.$hostkey);
    ssh2_auth_pubkey_file($connection, $user, '/home/myuser/.ssh/id_rsa.pub', '/home/myuser/.ssh/id_rsa');

    //Execute the various commands and read the output to the log file
    foreach($commands as $command){

        // Run a command that will probably write to stderr (unless you have a folder named /hom)
        logWrite($logfile, 'Sending command: '.$user.'@'.$server.': '.$command);
        logWrite($logfile, '----------------------------------------------------------------------------------');
        $outputStream = ssh2_exec($connection, $command, true);
        if(is_resource($outputStream)){
            stream_set_blocking($outputStream, true);
        }

        //Catch
        if($catchoutput){

            if(is_resource($errorStream)){
                $errorStream = ssh2_fetch_stream($outputStream, SSH2_STREAM_STDERR);
            }

            // Enable blocking for both streams
            if(is_resource($errorStream)){
                stream_set_blocking($errorStream, true);
            }

            // Whichever of the two below commands is listed first will receive its appropriate output.  The second command receives nothing
            logWrite($logfile, 'Output of command:');

            //Loop the stream until it is complete
            while((is_resource($outputStream) && !feof($outputStream)) || (is_resource($errorStream) && !feof($errorStream))){

                //Content read out
                if(is_resource($outputStream) && !feof($outputStream)){
                    $outputContent = trim(fgets($outputStream));
                }else{
                    $outputContent = '';
                }
                if(is_resource($errorStream) && !feof($errorStream)){
                    $errorContent = trim(fgets($errorStream));
                }else{
                    $errorContent = '';
                }

                //Add the information to the log
                if($outputContent == '' && $errorContent == ''){ continue; }
                if($outputContent !== ''){
                    logWrite($logfile, 'OUT: '.$outputContent);
                }
                if($errorContent !== ''){
                    logWrite($logfile, 'ERROR: '.$errorContent);
                }

            }

            // Close the streams       
            if(is_resource($errorStream)){ fclose($errorStream); }
            if(is_resource($outputStream)){ fclose($outputStream); }

        }

    }

    //Return the log
    return $logfile;

}

/**
 * 
 * List files in a SFTP enabled directory
 * 
 */
function sftpList($server, $user, $path){

    //Connect to ssh2
    $connection = ssh2_connect($server);
    $hostkey = ssh2_fingerprint($connection);
    ssh2_auth_pubkey_file($connection, $user, '/home/myuser/.ssh/id_rsa.pub', '/home/myuser/.ssh/id_rsa');

    //Create our SFTP resource
    if(!$sftp = ssh2_sftp($connection)){
        throw new Exception('Unable to create SFTP connection.');
    }

    /**
      * Now that we have our SFTP resource, we can open a directory resource
      * to get us a list of files. Here we will use the $sftp resource in
      * our address string as I previously mentioned since our ssh2:// 
      * protocol allows it.
      */
    $results = array();
    $dirHandle = opendir('ssh2.sftp://'.$sftp.$path);
    while (false !== ($result = readdir($dirHandle))) {
        if ($result != '.' && $result != '..') {
            $results[] = $result;
        }
    }
    closedir($dirHandle);

    //Return the log
    return $results;

} 
```

# php - php日期字符串sql server 2008插入

> ID：12846124
> 
> 赞同：0
> 
> 时间：2012-10-11T18:22:35.507
> 
> 标签：php

尝试将日期作为字符串从数组插入到 SQL Server 2008 并收到此错误

> Array ( [0] => Array ( [0] => 22007 [SQLSTATE] => 22007 [1] => 241 [code] => 241 [2] => [Microsoft][SQL Server Native Client 11.0][SQL服务器]从字符串转换日期和/或时间时转换失败。[消息] => [Microsoft][SQL Server Native Client 11.0][SQL Server]从字符串转换日期和/或时间时转换失败。））

插入数组是这样的

```
$data = array(
    'date' => '2012-10-12',
    'time' => '10:37:10'
); 
```

日期字段数据类型日期时间字段数据类型时间(7)

```
$sql = "INSERT INTO test (p_date, p_time) VALUES (?, ?)";

$stmt = sqlsrv_prepare($conn, $sql, array(&$data['date'], &$data['time']));

if( sqlsrv_execute($stmt) === false) 
{
    die( print_r( sqlsrv_errors(), true));
} 
```

# svn - SVN 是否与 .gitattributes 等效？

> ID：12846125
> 
> 赞同：1
> 
> 时间：2012-10-11T18:22:48.207
> 
> 标签：svn, unity3d, automatic-properties, gitattributes

**背景：**

我有两个 Unity3d 项目：

*   第一个其 Unity 首选项设置为“混合资产”模式（一些文件是文本，一些是二进制文件）和
*   第二个，其首选项设置为“强制文本”（大多数二进制文件都被翻译成`YAML`文本，因此几乎所有文件都可以`diff`编辑）。

为了将第一个项目的文件设置为文本/二进制文件，我们的`~/.subversion/config`文件已`svn auto-props`启用以及文件列表及其 svn 属性（***.cs**文件设置为`svn:eol-style=native`，***.unity**文件设置为`svn:mime-type=application/octet-stream`，等等）。

**问题：**

由于我们的第二个项目现在支持所有文件的文本模式，我们需要使用一组不同的`auto-props`规则，因此***.unity**文件现在被处理为`svn:eol-style=native`.

我看到`git`可以`.gitattributes`在每个项目（或每个目录）的基础上使用它，所以我们可以拥有这个功能。SVN 可以使用我们可以在我们的 repo 中共享的某种文件来做到这一点，这样每个提交的人都将使用相同的默认设置吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:51:41.260

One of the things you must understand that in git there's no real difference between a repository and a working directory. When you pull from a parent repository, you create your own repository.

.Gitattributes affect your local repository and only your local copy. Someone else can change their .gitattributes for their repository. After all, it's their repository. If a parent repository is receiving changes, it can use a pre-receive hook to verify the retrieved packet to make sure it follows the parent repository's policy. You shouldn't use .gitattributes to enforce policy, only to help you follow policy.

Subversion's auto-properties configuration is similar. It affects all working copies of that user. There's no individual configuration for each working copy. You can use a `--config-dir` parameter on many Subversion commands to specify a different Subversion configuration file for that operation, so you could have multiple configuration files and use `--config-dir` to specify that file. It's not convenient, but it's possible.

If you want to make sure your properties are set correctly, you need a pre-commit hook that checks the properties on a commit and rejects commits with invalid properties or property values on the files. I have a [pre-commit hook](https://github.com/qazwart/SVN-Precommit-Kitchen-Sink-Hook) that can do just that.

# map - 靠近地图边缘时相对于玩家绘制的项目

> ID：12846128
> 
> 赞同：0
> 
> 时间：2012-10-11T18:22:58.360
> 
> 标签：map, xna, tile, tile-engine

我有一个瓷砖引擎，一切都很好，我的玩家四处走动都很好，我正在添加项目，玩家总是在屏幕的中心，直到他接近世界的边缘然后他开始靠近边缘。

当我在世界中绘制物品时，它们绘制得很好，除非玩家离开中心（在世界边缘）。我只是无法解决如何解决这个问题。

```
public static void Draw(SpriteBatch spriteBatch, World w, Item i, Player p, Point screenDimensions)
    {
        bool IsOnScreen = true;

        float leftX = p.X - ((screenDimensions.X / 32) / 2);
        float rightX = leftX + (screenDimensions.X / 32);

        float topY = p.Y - ((screenDimensions.Y / 32) / 2);
        float bottomY = topY + (screenDimensions.Y / 32);

        if (i.x < leftX || i.x > rightX || i.y < topY || i.y > bottomY)
            IsOnScreen = false;

        if (IsOnScreen)
            i.animation.Draw(spriteBatch, (int)Math.Floor((i.x - leftX) * 32), (int)Math.Floor((i.y - topY) * 32));
    } 
```

它非常自我解释，传入世界以获取尺寸（`w.worldDimensions.x`宽度和`.y`高度），项目用于获取`i.x`和`i.y`（游戏世界中的位置，而不是屏幕上），用于绘制相对的玩家（包含`.x`和`.y`位置），然后是屏幕尺寸。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:23:16.713

好吧，我看起来不太清楚。你在使用相机课程吗？如果您使用相机类并使用它来导航您的世界，这永远不会发生。

这是我目前用于我的项目的一个基本的。

```
class Camera
{
    float zoom;
    public float Rotation { get; private set; }
    public Vector2 Position { get; private set; }
    Matrix transform;

    int velocity = 60;

    UserInput input;

    public float Zoom
    {
        get { return zoom; }
        set { zoom = value; if (zoom < 0.1f) zoom = 0.1f; } // Negative zoom will flip image
    }

    public Camera(UserInput input)
    {
        zoom = 1.0f;
        Rotation = 0f;
        Position = new Vector2(0, 0);
        this.input = input;
    }

    public void MoveCam()
    {
        if (input.IsKeyHold(Keys.Up))
        {
            Position += new Vector2(0, -velocity);
        }
        if (input.IsKeyHold(Keys.Left))
        {
            Position += new Vector2(-velocity, 0);
        }
        if (input.IsKeyHold(Keys.Down))
        {
            Position += new Vector2(0, velocity);
        }
        if (input.IsKeyHold(Keys.Right))
        {
            Position += new Vector2(velocity, 0);
        }

        if (input.IsKeyHold(Keys.OemMinus))
        {
            Zoom -= .01f * Zoom;
        }
        else if (input.IsKeyHold(Keys.OemPlus))
        {
            Zoom += .01f * Zoom;
        }
    }

    public void FollowCam(int xPos, int yPos)
    {
        Position = new Vector2(xPos * TileData.Width, yPos * TileData.Height);
    }

    public Matrix TransformMatrix(GraphicsDevice device)
    {
        transform = Matrix.CreateTranslation(new Vector3(-Position.X, -Position.Y, 0)) *
            Matrix.CreateRotationX(MathHelper.ToRadians(Rotation)) *
            Matrix.CreateRotationY(MathHelper.ToRadians(Rotation)) *
            Matrix.CreateRotationZ(MathHelper.ToRadians(Rotation)) *
            Matrix.CreateScale(new Vector3(zoom, zoom, 0)) *
            Matrix.CreateTranslation(new Vector3(device.Viewport.Width * 0.5f, device.Viewport.Height * 0.5f, 0));
        return transform;
    }
} 
```

只需像在 main 中一样实例化该类并在您的 draw 方法中使用它。

```
batch.Begin(SpriteSortMode.Immediate, BlendState.AlphaBlend, null, null, null, null, camera.TransformMatrix(graphicsDevice));
batch.End() 
```

在这个 spritebatch 中绘制您世界中的所有内容，并使用新的基础来绘制屏幕坐标，例如 gui/hud。您可以使用相机移动方法手动移动它，并使用锁将其锁定在任何位置（如果更新，它会跟随）。

如果您有大型地图，您可能只想渲染必要的图块。我在我的地图类中这样做：

```
public void Draw(SpriteBatch batch, Vector2 camPosition, float camZoom, GraphicsDevice device)
    {
        float top = (camPosition.Y / TileData.Height) - ((device.Viewport.Height / 2) / TileData.Height + 1) / camZoom;
        float bottom = (camPosition.Y / TileData.Height) + ((device.Viewport.Height / 2) / TileData.Height + 2) / camZoom;
        float left = (camPosition.X / TileData.Width) - ((device.Viewport.Width / 2) / TileData.Width + 1) / camZoom;
        float right = (camPosition.X / TileData.Width) + ((device.Viewport.Width / 2) / TileData.Width + 2) / camZoom;

        for (int y = (int)top; y < (int)bottom; y++)
        {
            for (int x = (int)left; x < (int)right; x++)
            {
                if (y >= 0 && y < map.GetLength(1) && x >= 0 && x < map.GetLength(0))
                {
                    batch.Draw(map[x, y].texture, new Rectangle(x * TileData.Width, y * TileData.Height, TileData.Width, TileData.Height), Color.White);

                }
            }
        }
    } 
```

Here first i figure out which tiles to draw from each direction. Note the camZoom, you want more tiles to be drawn when zooming out. Then i use these "bounderies" in my for loops, the if statement makes sure i am not accessing tiles that dont exist (out of bounds).

# java - 最后，尝试在 java 中的 catch 块语句

> ID：12846133
> 
> 赞同：-4
> 
> 时间：2012-10-11T18:23:13.663
> 
> 标签：java, exception, try-catch

我不明白为什么这段代码是错误的，我错过了什么？？？

```
 try{
input = inputFile.readLine();

}

finally{
inputFile.close();
}
catch (IOException e){
    System.out.println("I/O error: " + e.getMessage());
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:25:54.027

finally 应该在 catch 块之后。

```
 try{}
  catch{}
  finaly 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T18:25:23.260

你可以试试这个订单

```
try 
{
  ...
} 
catch (Exception ex) 
{
   //Treat exception
}
finally 
{
  //Clean your ressources
} 
```

# android - ORMLite 数据库从屏幕旋转关闭后的异步任务返回数据

> ID：12846146
> 
> 赞同：2
> 
> 时间：2012-10-11T18:24:09.860
> 
> 标签：android, android-asynctask, ormlite, screen-rotation

我收到此错误

```
10-11 13:58:46.713: E/AndroidRuntime(29407): FATAL EXCEPTION: AsyncTask #2
10-11 13:58:46.713: E/AndroidRuntime(29407): java.lang.RuntimeException: An error occured while executing doInBackground()
10-11 13:58:46.713: E/AndroidRuntime(29407):    at android.os.AsyncTask$3.done(AsyncTask.java:299)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at java.lang.Thread.run(Thread.java:856)
10-11 13:58:46.713: E/AndroidRuntime(29407): Caused by: java.lang.IllegalStateException: attempt to re-open an already-closed object: SQLiteDatabase: /data/data/com.philly.philly/databases/PhillyORM.db
10-11 13:58:46.713: E/AndroidRuntime(29407):    at android.database.sqlite.SQLiteClosable.acquireReference(SQLiteClosable.java:55)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1310)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at android.database.sqlite.SQLiteDatabase.rawQuery(SQLiteDatabase.java:1253)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at com.j256.ormlite.android.AndroidCompiledStatement.getCursor(AndroidCompiledStatement.java:154)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at com.j256.ormlite.android.AndroidCompiledStatement.runQuery(AndroidCompiledStatement.java:57)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at com.j256.ormlite.stmt.SelectIterator.<init>(SelectIterator.java:55)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at com.j256.ormlite.stmt.StatementExecutor.buildIterator(StatementExecutor.java:206)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at com.j256.ormlite.stmt.StatementExecutor.query(StatementExecutor.java:155)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at com.j256.ormlite.dao.BaseDaoImpl.query(BaseDaoImpl.java:261)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at com.j256.ormlite.stmt.QueryBuilder.query(QueryBuilder.java:262)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at com.j256.ormlite.stmt.Where.query(Where.java:482)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at com.j256.ormlite.dao.BaseDaoImpl.queryForEq(BaseDaoImpl.java:241)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at com.philly.philly.Repository.saveOrUpdateKontext(Repository.java:180)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at com.philly.philly.PostListActivity$LoadPostsTask.doInBackground(PostListActivity.java:161)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at com.philly.philly.PostListActivity$LoadPostsTask.doInBackground(PostListActivity.java:1)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at android.os.AsyncTask$2.call(AsyncTask.java:287)
10-11 13:58:46.713: E/AndroidRuntime(29407):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
10-11 13:58:46.713: E/AndroidRuntime(29407):    ... 5 more 
```

我相信关键部分是`10-11 13:58:46.713: E/AndroidRuntime(29407): Caused by: java.lang.IllegalStateException: attempt to re-open an already-closed object: SQLiteDatabase: /data/data/com.philly.philly/databases/PhillyORM.db`

当我在异步任务从远程服务器检索数据时旋转屏幕时会发生这种情况。

我假设正在发生的是请求正在返回并尝试写入数据库，但启动任务的活动已被破坏并重新启动。

如果您需要查看我的代码，我会添加它，但我认为仅从错误消息和我的描述来看，这个问题的根源实际上可能很清楚。

我只是在寻找如何在检索远程数据和使用 ORMLite 写入本地数据库时正确处理屏幕旋转。也许我应该使用服务而不是异步任务？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T12:21:38.847

您的活动可能正在轮换关闭数据库。我的建议是使用 AsyncTaskLoader，它会自行处理旋转。[http://developer.android.com/guide/components/loaders.html](http://developer.android.com/guide/components/loaders.html)

我从经验中学到的一个技巧是拥有一个单例 DB 对象，它只会在应用程序的整个生命周期中打开一次……当应用程序终止时，该对象会自动关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T18:31:55.773

您最好使用服务来处理数据库。当您旋转屏幕时，所有组件的当前布局都被破坏，并使用新的方向布局（将有其他组件）构建新布局。如果您不真正使用它，您还可以选择阻止屏幕旋转。

# java - 使用工具栏按钮使用其他编辑器打开文件 - RCP

> ID：12846147
> 
> 赞同：1
> 
> 时间：2012-10-11T18:24:14.590
> 
> 标签：java, eclipse, eclipse-rcp

我在两个不同的插件中有一个带有两个编辑器（扩展 Editorpart）的**rcp**应用程序，我想创建一个工具栏按钮来在具有相同文件的 **编辑器/插件之间切换。**

那可能吗？

问候亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T05:48:13.357

当然，只需获取活动工作台页面并调用`IWorkbenchPage.openEditor(input, editorId)`.

# php - PHP：使用 Jquery 获取下一张图片

> ID：12846148
> 
> 赞同：1
> 
> 时间：2012-10-11T18:24:33.840
> 
> 标签：php, javascript, jquery

我有一个漫画网站，它遍历数据库中的所有图像并将它们显示为缩略图。用户可以单击其中一张图像，在 viewComic.php 模板上以正常大小查看它。

我想让用户按左右箭头来导航图像。

所以，我的想法是：

1.  pagination.php 通过遍历数据库结果数组来处理正确页面上的图像显示（通过偏移）。用户可以单击结果（如下）以转到 viewcomic.php 模板上的特定图像。

    ```
    '<br />IMG: <a href="./templates/viewcomic.php?id=' . $row['imgid'] . '&image=' . $imgpath.$row['imgname'] . '"> 
    ```

2.  现在在 viewcomic.php 上，我得到了 id 和图像，并显示了图像

    ```
    $imgid = $_GET['id']; 
    $imgpath = $_GET['image']; 
    <center><img src=".<?php echo  $imgpath  ?>" /></center> 
    ```

用户可以按左右箭头来浏览图像...我的目标是以某种方式增加图像 ID 以移动到下一个图像，但这似乎不起作用...

```
 <script type="text/javascript">
        $(document).ready(function() { 
            $(document).keydown(function (e) {
                if (e.which == 39) { //get next image           
                <?php 
                    $count = 0;
                    $count++;
                    echo "<img src=" . $imageArray[$count] . "/>";
                ?> 
                }
            });
        });
    </script> 
```

有任何想法吗？

编辑：我将通过从 pagination.php 传入的图像数组。

所以，在我的 viewcomic.php 文件中，我更新了我的 jquery 脚本（见上文）.. 但 jquery 似乎不喜欢嵌入式 php，即使它都在一个 php 文件中。

这是页面源代码与代码的图片：

![页面来源](../Images/dd2bfe19fde9fb978aaf04d06684316f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:29:10.547

怎么样：

```
$(document).ready(function() { 
 $(document).keydown(function (e) {
    if (e.which == 39) { 
       var nextId = $_GET['id'] + 1;
       window.location = "./templates/viewcomic.php?id=" + nextId;
    }
 });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:48:18.650

这是我要做的：

假设图像路径被引号包围：

```
echo $imageArray[0]; // 'imagepath/image' 
```

脚本：

```
<script type="text/javascript">
var imgArray = [<?php echo implode(',',$imageArray) ?>];
// now the image array have the list of all your images. 

$(document).ready(function() {
   var img = document.getElementById("theImage");
   imgIndex = 0;
   $(document).keydown(function (e) {
      if (e.which == 39) { //get next image           
         img.src = imgArray[imgIndex++]
      }

      ... /* Logic to check if at the end of imageArray */ ...
   });
});
</script> 
```

的HTML：

```
<center><img src="" id="theImage"/></center> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T18:52:33.427

在这种情况下，您的页面会在每次请求时提交，您也可以在客户端站点处理此问题。

单击链接查看有关使用 JavaScript 旋转链接的演示。:[使用 javascript 链接旋转](http://mycodeprograms.blogspot.in/p/java-script.html)

# android - 使用 ksoap2 将对象从 android 传递给 wcf soap 服务；它发送和接收 0

> ID：12846149
> 
> 赞同：6
> 
> 时间：2012-10-11T18:24:36.537
> 
> 标签：android, vb.net, wcf, soap, ksoap2

我正在尝试使用 ksoap2 从 android 访问 wcf soap 服务中的方法。我能够成功地将简单的类型参数传递给该方法，它工作正常。但是当我尝试传递对象时，wcf 方法接收到的所有对象值都是 0。

我在 WP7 应用程序中使用了相同的 SOAP 服务，它运行良好。

我的服务中有 2 种方法，ksoapadd 和 addParam。addParam 接受两个整数并返回它们的总和（这有效）。ksoapadd 接受 testadd 类的对象，该对象具有两个整数元素，并且 ksoapadd 返回它们的总和（获取并发送 0）。

我认为它与命名空间有关，但我不知道如何解决它。我一直在反复试验以使肥皂请求正确，但还没有运气。

谁能帮我弄清楚该怎么做？我尝试了许多选项，以某种方式帮助其他有类似问题的人，但无济于事。

这是我的wsdl：

```
<?xml version="1.0" encoding="UTF-8"?>
-<wsdl:definitions xmlns:wsx="http://schemas.xmlsoap.org/ws/2004/09/mex"
xmlns:wsa10="http://www.w3.org/2005/08/addressing" 
xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" 
xmlns:wsaw="http://www.w3.org/2006/05/addressing/wsdl" 
xmlns:msc="http://schemas.microsoft.com/ws/2005/12/wsdl/contract" 
xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
xmlns:wsap="http://schemas.xmlsoap.org/ws/2004/08/addressing/policy" 
xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy" 
xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing" 
xmlns:tns="http://tempuri.org/" 
xmlns:wsam="http://www.w3.org/2007/05/addressing/metadata" 
xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" 
xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" 
xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" 
xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" 
targetNamespace="http://tempuri.org/" name="Service1">
-<wsdl:types>
-<xsd:schema targetNamespace="http://tempuri.org/Imports">
<xsd:import namespace="http://tempuri.org/" schemaLocation="http://localhost:51086/Service1.svc?xsd=xsd0"/>
<xsd:import namespace="http://schemas.microsoft.com/2003/10/Serialization/" schemaLocation="http://localhost:51086/Service1.svc?xsd=xsd1"/>
<xsd:import namespace="http://schemas.datacontract.org/2004/07/InsertIntoUserWCF" schemaLocation="http://localhost:51086/Service1.svc?xsd=xsd2"/>
</xsd:schema>
</wsdl:types>
-<wsdl:message name="IService1_ksoapAdd_InputMessage">
<wsdl:part name="parameters" element="tns:ksoapAdd"/>
</wsdl:message>
-<wsdl:message name="IService1_ksoapAdd_OutputMessage">
<wsdl:part name="parameters" element="tns:ksoapAddResponse"/>
</wsdl:message>
-<wsdl:message name="IService1_addParam_InputMessage">
<wsdl:part name="parameters" element="tns:addParam"/>
</wsdl:message>
-<wsdl:message name="IService1_addParam_OutputMessage">
<wsdl:part name="parameters" element="tns:addParamResponse"/>
</wsdl:message>
-<wsdl:portType name="IService1">
-<wsdl:operation name="ksoapAdd">
<wsdl:input message="tns:IService1_ksoapAdd_InputMessage"    wsaw:Action="http://tempuri.org/IService1/ksoapAdd"/>
<wsdl:output message="tns:IService1_ksoapAdd_OutputMessage" wsaw:Action="http://tempuri.org/IService1/ksoapAddResponse"/>
</wsdl:operation>
-<wsdl:operation name="addParam">
<wsdl:input message="tns:IService1_addParam_InputMessage" wsaw:Action="http://tempuri.org/IService1/addParam"/>
<wsdl:output message="tns:IService1_addParam_OutputMessage" wsaw:Action="http://tempuri.org/IService1/addParamResponse"/>
</wsdl:operation>
</wsdl:portType>
-<wsdl:binding name="BasicHttpBinding_IService1" type="tns:IService1">
<soap:binding transport="http://schemas.xmlsoap.org/soap/http"/>
-<wsdl:operation name="InsertUserDetails">
<soap:operation style="document" 
-<wsdl:operation name="ksoapAdd">
<soap:operation style="document" soapAction="http://tempuri.org/IService1/ksoapAdd"/>
-<wsdl:input>
<soap:body use="literal"/>
</wsdl:input>
-<wsdl:output>
<soap:body use="literal"/>
</wsdl:output>
</wsdl:operation>
-<wsdl:operation name="addParam">
<soap:operation style="document" soapAction="http://tempuri.org/IService1/addParam"/>
-<wsdl:input>
<soap:body use="literal"/>
</wsdl:input>
-<wsdl:output>
<soap:body use="literal"/>
</wsdl:output>
</wsdl:operation>
</wsdl:binding>
-<wsdl:service name="Service1">
-<wsdl:port name="BasicHttpBinding_IService1" binding="tns:BasicHttpBinding_IService1">
<soap:address location="http://localhost:51086/Service1.svc"/>
</wsdl:port>
</wsdl:service>
</wsdl:definitions> 
```

这是我的 xsd2：

```
<?xml version="1.0" encoding="UTF-8"?>
-<xs:schema xmlns:tns="http://schemas.datacontract.org/2004/07/InsertIntoUserWCF"
xmlns:xs="http://www.w3.org/2001/XMLSchema" 
targetNamespace="http://schemas.datacontract.org/2004/07/InsertIntoUserWCF" 
elementFormDefault="qualified">
-<xs:complexType name="testadd">
-<xs:sequence>
<xs:element name="number_1" type="xs:int" minOccurs="0"/>
<xs:element name="number_2" type="xs:int" minOccurs="0"/>
</xs:sequence>
</xs:complexType>
<xs:element name="testadd" type="tns:testadd" nillable="true"/>
</xs:schema> 
```

这是我的肥皂请求：

```
<v:Envelope xmlns:i="http://www.w3.org/2001/XMLSchema-instance"
xmlns:d="http://www.w3.org/2001/XMLSchema" xmlns:c="http://schemas.xmlsoap.org/soap/encoding/" xmlns:v="http://schemas.xmlsoap.org/soap/envelope/">
<v:Header />
<v:Body>
<ksoapAdd xmlns="http://tempuri.org/" id="o0" c:root="1">
<n0:num1 xmlns:n0="http://tempuri.org/">
<number_1>25</number_1>
<number_2>25</number_2>
</n0:num1>
</ksoapAdd>
</v:Body>
</v:Envelope> 
```

肥皂反应：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
<s:Body>
<ksoapAddResponse xmlns="http://tempuri.org/">
<ksoapAddResult>0</ksoapAddResult>
</ksoapAddResponse>
</s:Body>
</s:Envelope> 
```

这是我使用 ksoap2 的 java 代码：

```
private static final String NAMESPACE = "http://tempuri.org/";
private static final String URL = "http://10.0.2.2:51086/Service1.svc?wsdl";
private static final String SOAP_ACTION4 = "http://tempuri.org/IService1/ksoapAdd";
private static final String METHOD_NAME4 = "ksoapAdd";
private static final String SOAP_ACTION5 = "http://tempuri.org/IService1/addParam";
private static final String METHOD_NAME5 = "addParam";

try {
    testadd numX = new testadd(25,25);

    SoapObject Request = new SoapObject(NAMESPACE, METHOD_NAME4);

    PropertyInfo prop = new PropertyInfo();
    prop.setNamespace(NAMESPACE);
    prop.setName("num1");
    prop.setType(numX.getClass());
    prop.setValue(numX);
    Request.addProperty(prop);

    SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
    envelope.dotNet = true;
    envelope.setOutputSoapObject(Request);

    envelope.implicitTypes = true;

    HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);
    androidHttpTransport.debug=true;
    androidHttpTransport.call(SOAP_ACTION4, envelope);

    Log.d(logtag + " request dump", androidHttpTransport.requestDump);
    Log.d(logtag + " response dump", androidHttpTransport.responseDump);

    final SoapPrimitive response = (SoapPrimitive)envelope.getResponse();
    final int num = Integer.parseInt(response.toString());

    } catch (Exception e) 
    {
        e.printStackTrace();
    } 
```

这是我的java类testadd：

```
import java.util.Hashtable;
import org.ksoap2.serialization.KvmSerializable;
import org.ksoap2.serialization.PropertyInfo;

public class testadd implements KvmSerializable{
int number1;
int number2;

testadd(){}
testadd(int a, int b){ number1 = a; number2 = b;}

@Override
public Object getProperty(int arg0) {
    switch(arg0)
    {
    case 0:
        return number1;
    case 1:
        return number2;

    }

return null;
}

@Override
public int getPropertyCount() {

    return 2;
}

@Override
public void getPropertyInfo(int arg0, Hashtable arg1, PropertyInfo arg2) {

     switch(arg0)
        {
        case 0:
            arg2.type = PropertyInfo.INTEGER_CLASS;
            arg2.name = "number_1";
            break;
        case 1:
            arg2.type = PropertyInfo.INTEGER_CLASS;
            arg2.name = "number_2";
            break;

        default:break;
        }

}

@Override
public void setProperty(int arg0, Object value) {

    switch(arg0)
    {
    case 0:
       number1 = Integer.parseInt(value.toString());
        break;
    case 1:
        number2 = Integer.parseInt(value.toString());
        break;

    default:
        break;
    }
}
} 
```

服务代码：

```
<ServiceContract()> _
Public Interface IService1
<OperationContract()> _
Function ksoapAdd(ByVal num1 As testadd) As Integer

<OperationContract()> _
Function addParam(ByVal num1 As Integer, ByVal num2 As Integer) As Integer

End Interface

<DataContract()> _
Public Class testadd
Private number1 As Integer
Private number2 As Integer

<DataMember()> _
Public Property number_1() As Integer
    Get
        Return number1
    End Get
    Set(ByVal value As Integer)
        number1 = value
    End Set
End Property

<DataMember()> _
Public Property number_2() As Integer
    Get
        Return number2
    End Get
    Set(ByVal value As Integer)
        number2 = value
    End Set
End Property

End Class 
```

服务方式：

```
Public Function ksoapAdd(ByVal num1 As testadd) As Integer Implements IService1.ksoapAdd
    MsgBox(num1.number_1)
    Return num1.number_1 + num1.number_2
End Function

Public Function addParam(ByVal num1 As Integer, ByVal num2 As Integer) As Integer Implements IService1.addParam
    MsgBox(num1 + num2)
    Return num1 + num2
End Function 
```

我知道这是很多代码，但它认为有必要了解整个情况。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-12T15:22:44.797

我终于让它工作了！

原来我的 android ksoap2 代码不喜欢 WCF 在 SOAP 服务中设置的默认命名空间（tempuri.org）。

我的猜测是，使用默认命名空间，请求信封无法将传递的 testadd 对象映射到服务中定义 testadd 类的数据合同。通过为 WCF 服务中的 servicecontract 和 datacontract 显式定义命名空间，这会更改/重新排列 wsdl 并使 datacontract 可访问。

我按照本教程摆脱了 tempuri.org 命名空间- [http://blogs.msdn.com/b/endpoint/archive/2011/05/12/how-to-eliminate-tempuri-org-from-your-服务-wsdl.aspx](http://blogs.msdn.com/b/endpoint/archive/2011/05/12/how-to-eliminate-tempuri-org-from-your-service-wsdl.aspx)

我在服务代码（VB）的适当位置添加了以下内容

```
<ServiceContract(Namespace:="http://wcfservicetest.org/Service1")> _
<DataContract(Namespace:="http://wcfservicetest.org/Service1")> _
<ServiceBehavior(Namespace:="http://wcfservicetest.org/Service1")> _ 
```

我将命名空间更改为“http://wcfservicetest.org/Service1”，并使用新命名空间在 android java 代码中编辑了 NAMESPACE 和 SOAP_ACTION。

这样做之后，我得到了我想要的结果！

这是肥皂请求：

```
<v:Envelope xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns:d="http://www.w3.org/2001/XMLSchema" xmlns:c="http://schemas.xmlsoap.org/soap/encoding/" xmlns:v="http://schemas.xmlsoap.org/soap/envelope/">
<v:Header />
<v:Body>
<ksoapAdd xmlns="http://wcfservicetest.org/Service1" id="o0" c:root="1">
<n0:num1 xmlns:n0="http://wcfservicetest.org/Service1">
<number_1>25</number_1>
<number_2>25</number_2>
</n0:num1>
</ksoapAdd>
</v:Body>
</v:Envelope> 
```

肥皂反应：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
<s:Body>
<ksoapAddResponse xmlns="http://wcfservicetest.org/Service1">
<ksoapAddResult>50</ksoapAddResult>
</ksoapAddResponse>
</s:Body>
</s:Envelope> 
```

因此，我对其他使用 ksoap2 学习 SOAP 服务的人的建议是，不要使用默认命名空间，设置自己的命名空间。我浪费了一周的时间试图弄清楚这一点。

希望有一天这对某人有所帮助！

# java - 安卓 SSL 证书

> ID：12846153
> 
> 赞同：3
> 
> 时间：2012-10-11T18:25:01.510
> 
> 标签：java, android, ssl, ssl-certificate

android 2.2：例如我的 ssl 证书已过期，因为我的手机系统时间不正确。如何从 worldclock.com 设置时间以检查证书？无需更改手机时间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T02:27:37.743

你不能，这就是重点。如果每个人都根据自己的时间进行证书验证，那就不太可靠了。只需为您的手机设置正确的时间。

# asp.net - 果汁界面： 。附 为空或不是对象

> ID：12846158
> 
> 赞同：0
> 
> 时间：2012-10-11T18:25:20.000
> 
> 标签：asp.net, juice-ui

我只是决定试一试 JuiceUI，以利用快速简单的对话框弹出窗口。我尝试将对话框控件的示例代码添加到我的 ASP.NET 应用程序的页面中（我刚刚从对话框控件的 Juice UI 示例页面复制并粘贴了它）并得到了这个运行时错误：

> Microsoft JScript 运行时错误：“datepicker._attachDatepicker”为空或不是对象

在 juice.js 的第 138 行

注释掉 juice.js 引用中的所有代码行`.datepicker`，得到

> Microsoft JScript 运行时错误：“ui.tabs”为空或不是对象

对此进行了评论，并为 ui.dialogs 等得到了相同的结果。看起来好像没有任何控件被实例化。我一定错过了一些步骤，但我对这个库和 jQuery 也很陌生，所以我不确定发生了什么。对于上下文，我使用 NuGet 包管理器安装了 JuiceUI 1.0.1。

我检查了我的 web applicaiton 项目中的二进制引用，以及 web.config 中的引用，所有这些似乎都是应有的。

有没有其他人遇到过这个问题或有任何想法？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T15:01:31.320

在这里回答我自己的问题。问题是一个愚蠢的 JavaScript 菜鸟错误。我忘记了页面内引用的顺序很重要。以前，我有这样的脚本引用：

> <script src="../../Scripts/amplify.min.js" type="text/javascript"></script>
> <script src="../../Scripts/jquery-1.8.2\. min.js" type="text/javascript"></script>
> <script src="../../Scripts/jquery-ui-1.8.24.min.js" type="text/javascript">< /script>
> <script src="../../Scripts/juice.min.js" type="text/javascript"></script>

这是行不通的，因为 amplify 依赖于 jquery，所以不能先定义它。通过将它们重新排序为...，问题就消失了

> <script src="../../Scripts/jquery-1.8.2.min.js" type="text/javascript"></script>
> <script src="../../Scripts/jquery- ui-1.8.24.min.js" type="text/javascript"></script>
> <script src="../../Scripts/amplify.min.js" type="text/javascript">< /script>
> <script src="../../Scripts/juice.min.js" type="text/javascript"></script>

编译器把我宠坏了。

# vb.net - 失去在 KeyDown 中拾取制表键的能力

> ID：12846163
> 
> 赞同：1
> 
> 时间：2012-10-11T18:25:35.537
> 
> 标签：vb.net, winforms, keydown

我正在开发一个应用程序，它使用在运行时交换的大量面板。通过处理 keydown 事件并检查应用程序的当前“状态”以确定如何路由键来控制面板的交换。

我在表单设计器中做一些清理工作，移动面板和标签，现在我以某种方式禁用了我的主表单在我的 keydown 事件中拾取 tab 键的能力。我仍然得到所有其他键，包括输入键。

代码没有改变，并且经过大量测试，可以使用 Tab 键正常运行，所以我只能想象我在设计器中玩时不小心关闭了一些重要的属性。

我在主窗体中打开了 keypreview。由于我收到其他关键事件，我不相信我的 keydown 处理程序工作不正确。不知何故，我的表单刚刚停止输入制表键。TabIndexes 是按顺序编号的，但它们并不重要，因为我使用 keypreview 来处理事件，然后让 tabindex 确定它的下一个跳转。

我认为这对于曾经去过那里并与之抗争过的人来说可能是一件容易的事。我有 Tab 键仍在运行的备份，但我今天在逻辑上取得了飞跃，所以我还没有准备好回滚或对表单上的每个对象进行并排比较。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T18:40:29.590

那不应该工作。当您在表单上有任何可以获取焦点的控件时不会。Tab 键和光标键用于*导航*，将焦点从一个控件移动到另一个控件。

KeyPreview 属性是 VB6 旧版兼容性属性，用于实现自定义快捷键击键。拦截导航键的代码在触发表单的 KeyDown 事件的代码*之前运行。*相反，您应该重写 ProcessCmdKey() 方法，它在导航代码*之前*运行，因此可以看到 Tab 和光标键：

```
Protected Overrides Function ProcessCmdKey(ByRef msg As Message, keyData As Keys) As Boolean
    If keyData = Keys.Tab Then
        '' Do something, preferably navigation related since that what the user expects
        ''...
        Return True   '' That means that the key was consumed
    End If
    Return MyBase.ProcessCmdKey(msg, keyData)
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T18:53:21.960

我搜索了 tabstop 并寻找一个对象，这个对象是真的。

我在 VS 中的“查找”没有找到任何内容，但随后我在添加到项目的最后一个面板上看到了一个列表框，该面板打开了 tabstop。

关闭它让我回到了我最初的位置，我的代码拿起了 Tab 键。

# hadoop - 用于性能的 Hadoop 映射输出类型

> ID：12846165
> 
> 赞同：0
> 
> 时间：2012-10-11T18:25:37.470
> 
> 标签：hadoop, mapreduce

我有一堆字段要由 Mapper 写出大约 10 个字段。哪种方式会更快 1\. 写出如下字段

```
 tradeDate.readFields(in);
    marketMakerId.readFields(in);
    eventTime.readFields(in);
    bidPrice.readFields(in);
    ......................... 
```

或 2\. 将它们转换为单个文本字段（tradeDate、marketId、evenTime、bidPrice ....）并在 Reducer 上构造回对象。

哪种方式可以提供更好的性能呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:01:58.493

像往常一样，基准测试可能会有所帮助。您可以使用[Caliper](http://code.google.com/p/caliper/wiki/JavaMicrobenchmarks)来检查假设。

但总的来说，当涉及文本<->二进制转换时，二进制格式更快。因此，我认为二进制读/写字段会更快。

# excel - 为 Excel 编写 Apple Script 以删除单元格中具有特定值的行

> ID：12846169
> 
> 赞同：1
> 
> 时间：2012-10-11T18:25:48.783
> 
> 标签：excel, applescript

我正在尝试删除具有特定值的 excel 中的单元格。我已经走了很远，并且已经编写了自己的脚本，并从互联网上借了一些摘录。

```
 set theOutputPath to (path to desktop folder as string) & "FilteredNY.csv"
    set fstring to "(Not NY State)"

    tell application "Microsoft Excel"
     activate
     open workbook workbook yatta yatta
activate object worksheet 1
-->activate range current region
set LastRow to ((count of rows of used range of active sheet) + 1)
set lastCol to count of columns of used range of active sheet
set lastCol to (get address of column lastCol without column absolute)
set lastCol to (characters 1 thru ((length of lastCol) div 2) of lastCol as string)
set fullRange to range ("2:" & LastRow)
repeat with i from 2 to LastRow
    --code in repeat 
    if value of cell ("J" & i) is equal to fstring then
        delete range row i
    end if
end repeat
end tell 
```

大多数代码并不重要，包括 fullRange 变量和设置在顶部的路径变量。问题是删除代码在第 2 行之后甚至没有继续进行，并且在此之上运行非常缓慢，因此实际上存在很多问题。我猜我做的那个循环一定有问题。如果有人能让我走上正确的轨道，那就太好了。

经过大量的试验/挖掘，我最近发现了这个问题。当我删除范围时，行实际上移动了前导 excel 以删除错误的范围。我目前正在研究一种解决方法，包括清除我不想要的行并隐藏所有空白单元格，然后将所有可见单元格复制到新工作表中。

好的，另一个更新，最后一次更新。我终于完成了脚本，让它可以做它需要做的事情。而不是所有的清除、隐藏和复制，我只是通过将所有要删除的行添加到一个数组中来完成删除工作，而不是将数组转换为一个范围字符串，删除范围可以一次性删除所有行。这是一种更快、更简单的解决方案。

这是伟大的苹果脚本：

```
 set theOutputPath to (path to desktop folder as string) & "FilteredNY.csv"
 set fstring to "(Not NY State)"
 set del_list to {}

 tell application "Microsoft Excel"
activate
open workbook workbook file name yatta yatta
activate object worksheet 1
set LastRow to ((count of rows of used range of active sheet))

repeat with i from 2 to LastRow
    --code in repeat 
    if value of cell ("J" & i) is equal to fstring then
        set di to i as string
        set end of del_list to di & ":" & di

    end if
end repeat
set AppleScript's text item delimiters to ","
set ToDelete to del_list as string
set AppleScript's text item delimiters to {""}
delete range range ToDelete
  end tell 
```

我希望这对那里的人有所帮助！我有解决自己问题的坏习惯。:)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T12:31:24.843

将 Excel 与 applescript 一起使用时，请尽量避免循环，并使用 Excel 强度在短时间内处理大量行/列。

对于您的情况，我知道您要删除列“J”的值为“（非纽约州）”的所有行您不要触摸必须有列标题的第一行。

所以这里是代码：

```
tell application "Microsoft Excel"
    set autofilter mode of active sheet to false
    set lastRow to first row index of last row of used range

    autofilter range row ("1:" & lastRow) field 10 criteria1 "(Not NY State)"
    select row ("2:" & lastRow)
    delete selection -- if you want to delete 
    #clear contents selection -- if you only wish to clear the data
end tell 
```

这不是更快吗？

加快代码速度的额外技巧：

```
tell application "Microsoft Excel" to set screen updating to false --vvv---
-- insert here operations that would change Excel display --
tell application "Microsoft Excel" to set screen updating to true --^^^--- 
```

您也可以使用自动过滤器+排序

但真正重要的是在 Excel 中巧妙地使用公式来快速完成工作。（设置一个单元格的公式，然后填写到最后一行）

# jquery - 使用其属性获取元素？

> ID：12846174
> 
> 赞同：1
> 
> 时间：2012-10-11T18:26:03.230
> 
> 标签：jquery, html

我有这个，

```
<select id="rid" style="border: 1px solid #ccc;" name="rid">
    <option value="1">Option 1</option>
    <option value="2">Option 2</option>
    <option value="3">Option 3</option>
    <option value="4">Option 4</option>
    <option value="5">Option 5</option>
    <option value="6">Option 6</option>
</select> 
```

我有触发事件的链接，

```
<a href="#">Disable Option 1</a><br />
<a href="#">Disable Option 2</a><br />
<a href="#">Disable Option 3</a> 
```

现在，如果我单击`Disable Option 1`，这将从`Option 1`选择下拉列表中禁用。我在想，通过使用属性`value`，我可以指定要禁用哪些选项来禁用我将单击的链接，但我迷路了。如何仅使用该`value`属性禁用下拉列表中的任何选项？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-11T18:31:03.510

**编辑：**

> 例如，当单击禁用选项 1 时，它将禁用选项 1、4 和 5，当我单击禁用选项 2 时，它将禁用选项 2 和 3，有点像这样。

设置链接如下，

```
<a href="#" data-val="1,4,5">Disable Option 1</a><br />
<a href="#" data-val="2,3">Disable Option 2</a><br />
<a href="#" data-val="3">Disable Option 3</a> 
```

并更改如下代码，

```
$('a').click (function () {
    var thisVal = $(this).data('val')+'';
    $('#rid option').filter(function () {            
        return $.inArray(this.value, thisVal.split(',')) >= 0;
    }).prop('disabled', true);
}); 
```

**演示：http:** [//jsfiddle.net/vPhJc/1/](http://jsfiddle.net/vPhJc/1/)

* * *

如果您设置如下链接，

```
<a href="#" data-val="1">Disable Option 1</a><br />
<a href="#" data-val="2">Disable Option 2</a><br />
<a href="#" data-val="3">Disable Option 3</a> 
```

那么你就可以

```
$('a').click (function () {
    $('#rid option[value=' + $(this).data('val') + ']').prop('disabled', true);
}); 
```

**演示：http:** [//jsfiddle.net/vPhJc/](http://jsfiddle.net/vPhJc/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T18:42:40.493

请检查这个

**HTML：**

```
<a href="#">Disable Option <span>1</span></a><br />
<a href="#">Disable Option <span>2</span></a><br />
<a href="#">Disable Option <span>3</span></a> 
```

**代码：**

```
$("a").click(function(){
   // if you want to enable previously disabled option then do this
   // $("#rid").find("option").removeAttr('disabled');

   $("#rid").find("option[value='"+$(this).find("span").html()+"']")
           .attr('disabled','disabled');
}); 
```

[http://jsfiddle.net/66hyZ/14/](http://jsfiddle.net/66hyZ/14/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T18:30:41.593

JQuery 支持可以检查属性值的选择器，例如[`[name="value"]`](http://api.jquery.com/attribute-equals-selector/).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T18:37:19.280

为什么不给每个链接一个 id，然后使用 id 值禁用选择框中的选项

# tfs-process-template - 为什么 scrum v3 版本（3.0.4281.00）没有反映为 tfs 2010 上的流程模板

> ID：12846176
> 
> 赞同：1
> 
> 时间：2012-10-11T18:26:12.963
> 
> 标签：tfs-process-template

我们已经在服务器上安装了 scrum v3。以前我们的 scrum v2 在 tfs 2008 上运行良好，但我们将 tfs 2008 升级到 tfs 2010。我们在 tfs 2010 上运行 scrum v2 时遇到了一些问题。但我担心的是，当我们创建团队项目时，scrum v3 作为模板不可见。我[在这个网站上读到](http://consultingblogs.emc.com/crispinparker/archive/2010/02/26/scrum-for-team-system-v3-release-candidate.aspx)：

> SfTS v3 Beta 2 和 SfTS v2.x (TFS 2008) 不能在单个 TFS 2010 实例中共存。

如果是的话，这会是一个问题吗，我是否必须卸载/删除 scrum v2。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T01:04:54.843

为了在团队项目创建中显示流程模板，您需要先上传模板。请参阅团队 -> 团队项目集合 -> 流程模板管理器以上传模板。

# jquery - 如何在 JQuery 中替换标签？

> ID：12846178
> 
> 赞同：1
> 
> 时间：2012-10-11T18:26:18.503
> 
> 标签：jquery

我想选择页面上具有特定标签的所有项目，并将该标签值替换为不同的值。

以下是我到目前为止所获得的

```
$j("optgroup[label=Available]"). 
```

当 optgroup 标记具有可用标签时，我希望它是其他东西（即选项）

我如何完成这条线？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:28:24.650

你试过使用`attr`吗？

```
$("optgroup[label='Available']").attr("label", "Options"); 
```

你可以在这里看到一个小提琴：http: [//jsfiddle.net/s58Lk/](http://jsfiddle.net/s58Lk/)

attr 文档： [http ://api.jquery.com/attr/](http://api.jquery.com/attr/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T18:32:26.223

如果要更改标签属性，可以尝试以下操作：

```
$j("optgroup[label=Available]").attr('label', 'Options'); 
```

**一点解释**

`attr`读取和更改 html 标记中属性的值：

读取当前值

```
var label = $("...").attr("label"); 
```

更改值：

```
$("...").attr("label", "new value"); 
```

# visual-studio-2010 - 我的广告周围有这个奇怪的 1 像素“边距”，这是什么原因？

> ID：12846180
> 
> 赞同：0
> 
> 时间：2012-10-11T18:26:34.773
> 
> 标签：visual-studio-2010, windows-phone-7, xaml

这是一个简单的项目，我没有经常使用标准代码。但我仍然在我的广告周围得到这个奇怪的 1px 边距......在这种情况下是 adduplex。

我尝试将 with 设置为 480，margin 设置为 0，页面属性 designheight 为 800，width 为 480：-/

有谁知道我可以测试/做些什么来纠正它？我不想要这个边距（蓝色水平线，黑色右侧，白色上下边框）。

正如我提到的，带有上下边框的黑色是我的 AdDuplex 控件。蓝线应该是白色的，但是因为我的应用程序不知何故需要这个边距，所以它的蓝色作为我的背景

图片：![在此处输入图像描述](../Images/97b39ba11da94996bdf8e7307493137c.png)

# java - 具有添加效果的 ConcurrentHashMap

> ID：12846183
> 
> 赞同：0
> 
> 时间：2012-10-11T18:26:55.243
> 
> 标签：java

我只是试图获得添加效果，`ConcurrentHashMap<String,String>`但元素顺序是混合的。代码就像...

```
ConcurrentHashMap<String,String>h=new ConcurrentHashMap<String,String>();

        for(int i=0; i<10; i++)
        {           
            h.put(""+Math.random(), ""+i);

        }

        Iterator<String> iterator=h.values().iterator();
        while(iterator.hasNext())
        {
            System.out.println(iterator.next());
        } 
```

...在控制台中给出下一个值：

```
9
4
6
2
0
5
1
7
3
8 
```

……所以我的问题是……

如果键是一些随机字符串，有没有办法让 ConcurrentHashMap 获取原始元素的顺序？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-11T18:27:56.347

改用[`LinkedHashMap`](http://docs.oracle.com/javase/1.6/docs/api/java/util/LinkedHashMap.html)它将保留插入顺序

> Map 接口的哈希表和链表实现，具有可预测的迭代顺序。

并使用

```
Collections.synchronizedMap(mapInstance) 
```

看[`Collections.synchronizedMap(mapINstance);`](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#synchronizedMap%28java.util.Map%29)

```
 Map<K,V> map = Collections.synchronizedMap(new LinkedHashMap()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T18:28:38.577

[LinkedHashMap](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/LinkedHashMap.html)维护插入顺序。

> Map 接口的哈希表和链表实现，具有可预测的迭代顺序。此实现与 HashMap 的不同之处在于它维护一个双向链表，该列表贯穿其所有条目。这个链表定义了迭代顺序，通常是键插入映射的顺序（插入顺序）。请注意，如果将键重新插入到地图中，则插入顺序不会受到影响。

# java - 尝试从设备上的内部存储中播放视频将无法正常工作。权限问题？包含人、xml、java

> ID：12846184
> 
> 赞同：0
> 
> 时间：2012-10-11T18:27:35.170
> 
> 标签：java, android, video, view

**我附加了*层次结构图像、清单、xml、java***

我的内部存储器中有图像和视频。在我的应用程序的 1 个活动中，我显示图像。有用。在另一项活动中，我展示了视频。我得到的只是“抱歉，无法播放此视频”并返回：

```
10-11 12:58:50.889: E/MediaPlayer(23497): Error (1,-2147483648) 
```

似乎这可能是一个权限问题，就好像视频在 /mnt/sdcard/.. 它会完全按照它被告知的那样做。这些视频不得更改，因此有人决定将它们放入位于 /data/data/.... 的内部存储中。

我认为这可能是由于我引用图像的方式，但不应调用此问题，因为它是同一个应用程序。是否有我需要的特殊 Manifestflag 或从 /data/data/... 读取视频的东西？

应用布局：

```
 -----------------------------------------
                 |            Application                |
                 |           _/         \_               |
                 |   ImageActivity     Video Activity    |
                 ----------------------------------------- 
```

显现：

```
<supports-screens
    android:anyDensity="true"
    android:xlargeScreens="true"
    android:largeScreens="true"
    android:normalScreens="true"
    android:resizeable="true"
    android:smallScreens="true" />

<uses-permission android:name="android.permission.VIBRATE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.CAMERA" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_LOCATION_EXTRA_COMMANDS" />
<uses-permission android:name="android.permission.READ_LOGS" />

<uses-feature android:name="android.hardware.camera" android:required="true" />
<uses-feature android:name="android.hardware.microphone" android:required="true" />
<uses-feature android:name="android.hardware.wifi" android:required="true" />
<application
    android:hardwareAccelerated="true"
    android:debuggable="true"
    android:icon="@drawable/pl_launcher"
    android:label="@string/app_name" >
    <activity
        android:name="com.bentley.cordova.plugins.MediaPlaybackActivity" 
        android:launchMode="standard"
        android:configChanges="orientation"
        android:theme="@android:style/Theme.NoTitleBar.Fullscreen">
    </activity>
</application> 
```

XML:

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >
    <VideoView
        android:id="@+id/video"
        android:layout_width="wrap_content"
        android:layout_height="match_parent" />
</LinearLayout> 
```

爪哇：

```
path = this.getIntent().getStringExtra("path_name"); 
//path looks like:   /data/data/com.XXXXX.viewer/folder/video.mp4
setContentView(R.layout.media_playback_video);
VideoView vv = (VideoView)findViewById(R.id.video);
vv.setMediaController(new MediaController(this));
vv.setVideoURI(Uri.parse(path));
vv.requestFocus();
vv.start(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:23:39.680

使用什么编解码器对这些视频进行编码非常重要，尝试使用其他视频，看看这是否是问题所在。默认情况下，android video view 不能播放任何类型的视频。

# android - 如何将日期选择器串到时间选择器？

> ID：12846187
> 
> 赞同：0
> 
> 时间：2012-10-11T18:27:51.467
> 
> 标签：android, datepicker, datetimepicker, timepicker

我正在开发一个涉及 datepicker 和 timepicker 的应用程序，并希望为 datepicker“ok”按钮设置 onClick 以生成 timepicker 对话框。这是可能的还是只创建2个单独的按钮会更好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T18:34:45.723

您可以只监听 的返回`DatePicker`并将其用作启动`TimePicker`.

# java - java ftp zip 更好的方法

> ID：12846193
> 
> 赞同：0
> 
> 时间：2012-10-11T18:28:11.910
> 
> 标签：java, ftp

我见过使用 java.util.zip.ZipEntry 我们可以压缩文件。

我可以压缩它，而且我正在将它从一个**FTP**位置传输到另一个 FTP 位置

```
 outStream.putNextEntry(new ZipEntry());
 while ((ByteRead = is.read(buf)) != -1) 
 {      
     outStream.write(buf, 0, ByteRead);
     ByteWritten += ByteRead;
 } 
```

我还看到有一些方法 FTP.sendCommand() 。但不确定如何使用它发送命令以将文件压缩到一个 FTP 位置并使用此方法复制到另一个 lcoation。

有人对此有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:42:53.073

我认为你可以通过两个步骤实现它：

1.  压缩文件并写入第一个 FTP 位置

    ```
    URL ftpLocation1 = new URL("ftp://url1");
    URLConnection ftpConnect1 = ftpLocation1.openConnection();
    OutputStream ftpOutStream1 = ftpConnect1.getOutputStream(); // To upload
    ftpOutStream1.putNextEntry(new ZipEntry());
    while ((ByteRead = is.read(buf)) != -1) {      
       ftpOutStream1.write(buf, 0, ByteRead);
       ByteWritten += ByteRead;
     } 
    ```

2.  按原样读取 zip 文件并写入第二个 FTP 位置

    ```
    InputStream ftpInputStream1 = ftpConnect1.getInputStream(); // To read back
    URL ftpLocation2 = new URL("ftp://url2");
    URLConnection ftpConnect2 = ftpLocation1.openConnection();
    OutputStream ftpOutStream2 = ftpConnect2.getOutputStream(); // To upload

    //read through ftpInputStream1 and write in ftpOutStream2 
    while ((ByteRead = ftpInputStream1.read(buf)) != -1) {      
       ftpOutStream2.write(buf, 0, ByteRead);
       ByteWritten += ByteRead;
     } 
    ```

3.  完成后，关闭所有流

# java - 在不更改模型的情况下编码/解码数据模型的最佳方法？

> ID：12846196
> 
> 赞同：2
> 
> 时间：2012-10-11T18:28:28.347
> 
> 标签：java, xml

我想生成一个数据模型的 xml 表示，我不想修改我的模型添加类似 JAXB 和注释来描述它。我想要一个透明和灵活的设计。

有任何想法吗？

谢谢！

编辑 - 广告示例

```
public class Figure {
private String name;
private String color;
public Figure(String name, String color) {
    super();
    this.name = name;
    this.color = color;
}
public String getName() {
    return name;
}
public void setName(String name) {
    this.name = name;
}
public String getColor() {
    return color;
}
public void setColor(String color) {
    this.color = color;
} 
```

它是xml：

```
<Figure>
<name>square</name>
<color>red</color>
</Figure> 
```

这是一个简单的例子，我真正的问题是：如何在不更改“解析器/编码器/解码器”的情况下支持对象的组合或对模型的更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:35:19.423

使用[XMLEncoder](http://docs.oracle.com/javase/1.4.2/docs/api/java/beans/XMLEncoder.html)：

```
XMLEncoder e = new XMLEncoder(new BufferedOutputStream(new FileOutputStream("Test.xml")));
e.writeObject(new Figure("car", "blue"));
e.close(); 
```

或者看看[xstream](http://xstream.codehaus.org/)：

```
XStream xstream = new XStream(new DomDriver());
xstream.alias("Figure", Figure.class);
String xml = xstream.toXML(new Figure("car", "blue")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:39:44.393

使用[Xstream](http://xstream.codehaus.org/tutorial.html)。您将[创建一个自定义 Converter 类](http://xstream.codehaus.org/converter-tutorial.html)，并使用 canConvert() 方法将您的类（您的模型）映射到它。如果您正在创建自定义 Converter 类，则不需要在模型类中添加注释。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T18:33:40.750

蓖麻怎么样 - [http://www.castor.org/](http://www.castor.org/)？

# javascript - WebGLUniformLocation 对象的属性是什么？

> ID：12846197
> 
> 赞同：1
> 
> 时间：2012-10-11T18:28:31.750
> 
> 标签：javascript, webgl

这是我的片段着色器，其中包含`uniform`：

```
precision highp float;

uniform sampler2D uSampler;
varying vec2 vPosition;

void main() {
    gl_FragColor = texture2D(uSampler, vPosition);
} 
```

现在我在哪里调用函数`getUniformLocation`：

```
var uniformLocation = gl.getUniformLocation(program, 'uSampler') 
```

我得到一个`WebGLUniformLocation`似乎没有附加属性的：

```
for(a in uniformLocation) { console.log(a); } // prints no results 
```

为什么`WebGLUniformLocation`对象是无属性的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-12T02:09:40.337

A`WebGLUniformLocation`只是制服位置的不透明句柄，以便您可以设置制服。在真实的 OpenGL 中，统一位置是整数。不幸的是，许多程序员会对这些整数进行数学运算。例如，他们可能会做这样的事情

```
//--shader--
uniform float a;
uniform float b;
...

// C
GLint location_a = glGetUniformLocation(program, "a");
GLint location_b = a + 1;   // ILLEGAL BUT MIGHT WORK ON SOME CARDS 
```

同样，他们可能会这样做

```
//--shader--
uniform float a[2];
...

// C
GLint location_a0 = glGetUniformLocation(program, "a[0]");
GLint location_a1 = a + 1;   // ILLEGAL BUT MIGHT WORK ON SOME CARDS 
```

或者他们可以这样做

```
//--shader #1--
uniform float a;
...

//--shader #2--
uniform float a;
...

// C
GLint program_1 = CompileShadersAndLinkProgram(shader_1_src, ..);
GLint program_2 = CompileShadersAndLinkProgram(shader_2_src, ..);

// Get the location from program 1
GLint location_a = glGetUniformLocation(program_1, "a");

// Use a location from program 1 with program 2
glUseProgram(program_2);
glUnform1f(location_a, 123);  // ILLEGAL BUT MIGHT WORK ON SOME CARDS 
```

根据 OpenGL 规范，所有这些都是非法和错误的。有时没关系。如果您正在编写一些 OpenGL 程序并且您只需要它在您的个人机器或某些固定硬件上工作，那么您可能不在乎它是否是错误的，如果它碰巧工作。

对于 WebGL，虽然这还不够好。在可能的情况下，您希望编写一次代码并让它在任何地方运行。为了防止这些错误，WebGL 返回 a `WebGLUniformLocation`，这样你就不能做任何数学运算，也不能在另一个程序上使用一个程序的位置。

# php - mysqli 并访问同一个数据库中的两个不同的表

> ID：12846199
> 
> 赞同：0
> 
> 时间：2012-10-11T18:28:34.260
> 
> 标签：php, mysql, mysqli

最近我收到一个错误 undefined variable mysqli ，我想知道 - 是不是因为我正在访问同一个数据库中的两个不同的表？

```
$mysqli = new mysqli('localhost', 'myuser', 'qwerty', 'mydb');

if(!empty($_SERVER['HTTP_X_REQUESTED_WITH']) && strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) == 'xmlhttprequest')
{
    //initialise vars
    $username = $_POST['username'];

    $checkRecord = $mysqli->query("SELECT information, blahblah FROM table1 WHERE username='$username' AND field1='$field1' AND field2=$field2");

    if(!$checkRecord->num_rows) 
    {
        echo "nothing retreived";
    }   
    else
    {
        $catch = $checkRecord->fetch_object();

        $newsessionnumber = get_new_session_number($username, $ip, $userAgent);

        $senddata = array(
            'newsessionnumber' => $newsessionnumber,
            'info' => $catch->information, 
            'blahblah' => $catch->blahblah, 
            'username' => $username 
        );

        echo json_encode($senddata); 
    }   
}

function get_new_session_number($username, $ip, $userAgent)
{   
    $mysqli->query("INSERT INTO sessionnumberdispatch VALUES (NULL, '$username', NOW(), '$ip', '$userAgent')");

    $newsessionnumber = $mysqli->insert_id;
    return $newsessionnumber;       
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T18:34:22.203

该`$mysqli`对象在内部没有得到识别`get_new_session_number()`。

使用`global`关键字：

```
function get_new_session_number($username, $ip, $userAgent)
{   
    global $mysqli;
    $mysqli->query("INSERT INTO sessionnumberdispatch VALUES (NULL, '$username', NOW(), '$ip', '$userAgent')");

    $newsessionnumber = $mysqli->insert_id;
    return $newsessionnumber;       
} 
```

# jquery-ui - jQuery UI 对话框 - 无法在对话框内容中插入表格

> ID：12846206
> 
> 赞同：0
> 
> 时间：2012-10-11T18:28:51.577
> 
> 标签：jquery-ui, dialog, datatables

我有一个简单的网页，对于每一行数据，我可以弹出一个带有该行详细信息的 jQuery UI 对话框。由于子查询中可以有多行，因此表是最佳选择。结果是我得到一个空对话框，并且该 div 中包含的表格（用于对话框的表格）出现在页面底部，无论是否单击该行来激活对话框。其他一切都完美无缺，点击事件，弹出对话框，为 div 传递正确的 id，一切都很完美。

但是 dang 表（对话框内的一个，具有“inner-table”类）立即出现在页面底部。

HTML 是在 Groovy 中使用 HTMLMarkupBuilder 创建的，生成的 HTML 如下所示：

```
<html>
  <head>
    <title>NAS Execution Groovy Servlet</title>
    <script type='text/javascript' src='js/jquery.js'></script>
    <script type='text/javascript' src='js/jquery-ui-1.8.23.custom.min.js'></script>
    <script type='text/javascript' src='js/jquery.dataTables.min.js'></script>
    <script type='text/javascript' src='js/executions.js'></script>
    <link rel='stylesheet' type='text/css' href='css/jquery.dataTables_themeroller.css'></link>
    <link rel='stylesheet' type='text/css' href='css/jquery-ui.css'></link>
    <link rel='stylesheet' type='text/css' href='css/nas.css'></link>
  </head>
  <body>
    <div id='results' class='execution-results'>
      <p id='rpt-header'>
        <span class='rpt-header-txt'>Backup Schedule Report for </span>
        <span class='rpt-header-asset'>ret2w089n1t1</span>
      </p>
      <table id='nas-table'>
        <thead>
          <tr class='table-header'>
            <th class='hidden'>Backup ID</th>
            <th>Schedule Name</th>
            <th>Backup Product</th>
            <th>Size Mb</th>
            <th>Start Time</th>
            <th>Duration</th>
            <th>Expiration Date</th>
            <th>Mon 17</th>
          </tr>
        </thead>
        <tbody>
          <tr class='row'>
            <td class='hidden'>12345678</td>
            <td class='row-data'>null</td>
            <td class='row-data'>Product One</td>
            <td id='size-mb' class='row-data'>601.31</td>
            <td class='row-data'>00:09:03</td>
            <td class='row-data'>158 secs</td>
            <td class='row-data'>2012-10-01</td>
            <td class='row-center'>
              <img id='success-fail' src='img/success.gif'></img>
            </td>
          </tr>
          <tr class='row'>
            <td class='hidden'>23456789</td>
            <td class='row-data'>PolicyName</td>
            <td class='row-data'>Product Two</td>
            <td id='size-mb' class='row-data'>995.92</td>
            <td class='row-data'>20:09:00</td>
            <td class='row-data'>191 secs</td>
            <td class='row-data'>2012-10-01</td>
            <td class='row-center'>
              <img id='success-fail' src='img/success.gif'></img>
            </td>
          </tr>
          <div id='dialog-23456789' class='details-dialog'>
            <table class='inner-table'>
              <thead>
                <tr>
                  <th>JOB_TYPE_NAME</th>
                  <th>VENDOR_STATUS_NAME</th>
                  <th>KILOBYTES</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Incr Backup</td>
                  <td>Successful</td>
                  <td>1019821</td>
                </tr>
              </tbody>
            </table>
          </div>
        </tbody>
      </table>
    </div>
  </body>
</html> 
```

jQuery 非常简单；它使用单击行中的 id，并弹出一个对话框窗口。这很好用，但包含在该 div 中的表格实际上位于屏幕底部，甚至在单击任何内容之前：

```
$(document).ready(function() {

    $('#nas-table').dataTable( {
        "bJQueryUI": true,
         "aaSorting": [[4, 'asc']]
    }   );

    $('.row').live("click", function(){
        var target = $(this);
        var backupId = $(this).children(":first").html();
        var thisId = '#dialog-' + backupId;
        $(thisId).dialog(
            {   
                title: "Backup Job Detail",
                width: 800,
                height: 450
            }
        );
        $(thisId).dialog("open");
        $(thisId).dialog("widget").position({
                my: 'left top',
                at: 'left bottom',
                of: target
        });
    });

} ); 
```

起初，我以为 Groovy HTMLMarkupBuilder 在一切发生之前就输出了 DOM，但是当我查看源代码，将其复制到一个文件中，然后在我的浏览器中打开该文件时，我得到了相同的结果。

我将不胜感激。我之前问过这个问题，以防你想抱怨，但我不得不跟进 Groovy 代码中的一些其他潜在问题，我解决了这些问题。这个例子更完整，并且准确地代表了我的代码将要做什么。

布赖恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T18:52:47.453

问题是您有一个 div 嵌套在 TR 和 TD 之外的表中，这将导致渲染和 DOM 有点错误。如果您调整 html 使其类似于以下内容，它将起作用：

```
<div id='results' class='execution-results'> 
      <p id='rpt-header'> 
        <span class='rpt-header-txt'>Backup Schedule Report for </span> 
        <span class='rpt-header-asset'>ret2w089n1t1</span> 
      </p> 
      <table id='nas-table'> 
        <thead> 
          <tr class='table-header'> 
            <th class='hidden'>Backup ID</th> 
            <th>Schedule Name</th> 
            <th>Backup Product</th> 
            <th>Size Mb</th> 
            <th>Start Time</th> 
            <th>Duration</th> 
            <th>Expiration Date</th> 
            <th>Mon 17</th> 
          </tr> 
        </thead> 
        <tbody> 
          <tr class='row'> 
            <td class='hidden'>12345678</td> 
            <td class='row-data'>null</td> 
            <td class='row-data'>Product One</td> 
            <td id='size-mb' class='row-data'>601.31</td> 
            <td class='row-data'>00:09:03</td> 
            <td class='row-data'>158 secs</td> 
            <td class='row-data'>2012-10-01</td> 
            <td class='row-center'> 
              <img id='success-fail' src='img/success.gif'></img> 
            </td> 
          </tr> 
          <tr class='row'> 
            <td class='hidden'>23456789</td> 
            <td class='row-data'>PolicyName</td> 
            <td class='row-data'>Product Two</td> 
            <td id='size-mb' class='row-data'>995.92</td> 
            <td class='row-data'>20:09:00</td> 
            <td class='row-data'>191 secs</td> 
            <td class='row-data'>2012-10-01</td> 
            <td class='row-center'> 
              <img id='success-fail' src='img/success.gif'></img> 
            </td> 
          </tr>
          </tbody> 
      </table>
          <div id='dialog-23456789' class='details-dialog' style="display:none;"> 
            <table class='inner-table'> 
              <thead> 
                <tr> 
                  <th>JOB_TYPE_NAME</th> 
                  <th>VENDOR_STATUS_NAME</th> 
                  <th>KILOBYTES</th> 
                </tr> 
              </thead> 
              <tbody> 
                <tr> 
                  <td>Incr Backup</td> 
                  <td>Successful</td> 
                  <td>1019821</td> 
                </tr> 
              </tbody> 
            </table> 
          </div>         
    </div> 
```

诀窍是将 div 移到父表之外，您还需要在详细信息表上设置 display:none ，否则它将在页面呈现时显示。

# mysql - SQL 查询与连接计数多个结果每条记录按计数排序

> ID：12846208
> 
> 赞同：0
> 
> 时间：2012-10-11T18:29:04.680
> 
> 标签：mysql, sql, statistics, analytics

我有一张名为 Request 的表。
其他表通过请求 id 链接到请求表。有一个 TwitterTweet 表和一个 FacebookPost 表。因此，一个请求可以有 50 个 TwitterTweets 和/或 20 个 FacebookPosts 或任意数量的 Tweets/Posts 我们可以将它们加在一起，总数为 70。

我正在尝试创建一个查询，该查询可以告诉我总数最高的请求是什么。

我知道这是错误的：（我试图通过 TwitterTweet 中的计数对它们进行排序，但它不会让我做一个我认为会带回 Count.count 列的 OUTER JOIN。它迫使我做一个 Left Join让它编译。我的逻辑是做一个连接，以便通过requestid为每一行计算结果）

```
SELECT r1.`id` AS requestid, r1 . * 
FROM  `Request` AS r1
LEFT JOIN 

(SELECT COUNT( * ) AS count, rid
FROM 

((SELECT  `TwitterTweet`.`id` AS  `smid` ,  `TwitterTweet`.`requestid` AS rid
FROM  `TwitterTweet` 
WHERE  `TwitterTweet`.`requestid` = requestid
AND  `TwitterTweet`.`active` =1) AS talias

)) AS Count ON ( Count.rid = requestid ) 
ORDER BY Count.count 
```

*当我尝试在 Facebook 端添加时，它不会再编译（概念是结果是从 TwitterTweet 添加的，而 FacebookPost 的结果附加到特定的 requestid，这会给我们一个计数。整个结果集应按该计数排序）

```
SELECT r1.`id` AS requestid, r1 . * 
FROM  `Request` AS r1
LEFT JOIN 

(SELECT COUNT( * ) AS count, rid
FROM 

((SELECT  `TwitterTweet`.`id` AS  `smid` ,  `TwitterTweet`.`requestid` AS rid
FROM  `TwitterTweet` 
WHERE  `TwitterTweet`.`requestid` = requestid
AND  `TwitterTweet`.`active` =1 ) AS talias 

UNION All

(SELECT `FacebookPost`.`id` AS  `smid`, `FacebookPost`.`requestid` AS rid
FROM  `FacebookPost`
WHERE  `FacebookPost`.`requestid` = requestid
AND  `FacebookPost`.`active` = 1) as falias 

)) AS Count ON ( Count.rid = requestid ) 
ORDER BY Count.count 
```

我更新了查询并尝试添加别名：

```
SELECT rid, SUM(count) total_count

FROM 

(
(SELECT COUNT(*) AS count, r.rid
FROM   request r
       JOIN TwitterTweet tt
       ON r.id = tt.requestid
WHERE  tt.active = 1
GROUP BY r.rid) AS twitter

UNION ALL

(SELECT COUNT(*) AS count, r.rid
FROM   request r
       JOIN FacebookPost fp
       ON r.id = fp.requestid
WHERE  fp.active = 1
GROUP BY r.rid ) AS fbook
)

GROUP BY rid

ORDER BY SUM(count) DESC 
```

我进行了另一次调整，给中间子查询一个别名，但现在我只得到一行返回，rid 列中为零，total_count 列中为 5686……5686 可能是所有结果。

```
SELECT counts.rid, SUM(count) total_count

FROM 

(
SELECT COUNT(*) AS count, r.requestid AS rid
FROM   request r
       JOIN TwitterTweet tt
       ON r.id = tt.requestid
WHERE  tt.active = 1
GROUP BY r.requestid

UNION ALL

SELECT COUNT(*) AS count, r.requestid AS rid
FROM   request r
       JOIN FacebookPost fp
       ON r.id = fp.requestid
WHERE  fp.active = 1
GROUP BY r.requestid
) AS counts

GROUP BY counts.rid

ORDER BY SUM(count) DESC 
```

知道了！！！感谢您的帮助，我不得不根据请求删除这些连接：

```
SELECT counts.rid, SUM(count) total_count

FROM 

(
SELECT COUNT(*) AS count, tt.requestid AS rid
FROM  TwitterTweet tt
WHERE  tt.active = 1
GROUP BY tt.requestid

UNION ALL

SELECT COUNT(*) AS count, fp.requestid AS rid
FROM   FacebookPost fp
WHERE  fp.active = 1
GROUP BY fp.requestid
) AS counts

GROUP BY counts.rid

ORDER BY SUM(count) DESC 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:41:35.300

```
SELECT id, SUM(count) total_count

FROM 

(
SELECT COUNT(*) AS count, r.id
FROM   request r
       JOIN TwitterTweet tt
       ON r.id = tt.requestid
WHERE  tt.active = 1
GROUP BY r.id

UNION ALL

SELECT COUNT(*) AS count, r.id
FROM   request r
       JOIN FacebookPost fp
       ON r.id = fp.requestid
WHERE  fp.active = 1
GROUP BY r.id
) sub

GROUP BY id

ORDER BY SUM(count) DESC
; 
```

# ios - 从 iOS 中的日期删除时区偏移

> ID：12846216
> 
> 赞同：4
> 
> 时间：2012-10-11T18:29:27.587
> 
> 标签：ios, nsdate, rubymotion

我需要获取当前`NSDate.date`时区并删除时区并将其解析为 GMT 日期

```
NSDate.date 
```

返回`2012-10-11 11:27:09 -0700`

我需要的是这个：`2012-10-11 11:27:09 +0000`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T18:47:47.487

NSDate.date 返回一个日期，其当前日期和时间存储为 GMT。

如果要将日期格式化为字符串并显示 GMT 时间，则应使用 NSDateFormatter 并将语言环境设置为 GMT：

```
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setLocale:[[NSLocale alloc] initWithLocaleIdentifier:@"GMT"]];
[formatter setDateFormat:@"yyyy-MM-dd HH:mm:ss Z"];

NSString *dateAsString = [formatter stringFromDate:[NSDate date]]; 
```

# php - 动态 PHP 正则表达式

> ID：12846221
> 
> 赞同：-2
> 
> 时间：2012-10-11T18:30:04.970
> 
> 标签：php, regex

我正在编写一个函数，该函数接受一个字符串（`$skill`）和一个正则表达式中允许的字符列表。

这是作业的要求

> 1.  技能名称：必填；不能太长；可以包含空格、连字符、撇号（当然还有字母数字字符），但不能包含其他字符
> 2.  作为此步骤的一部分，您必须有一个 php 函数，该函数接受一个字符串和一个允许的字符列表（或者，不允许的字符，甚至可能是一个正则表达式），并返回一个错误消息（如果字符串不'不符合要求），或空字符串（如果字符串符合要求）。一定要给这个函数一个描述性的名字。

这是我的代码

```
function validate_skill($skill, $list) { 
if (preg_match('/['.$list.']/',$skill)) {
        echo "The skill contains a match.<br />";
    }else{
    echo "The skill does not contain a match.";
    }
} 
```

我只收到一个空白页面，通过注释掉该功能，该页面就可以工作了。这是将变量放在表达式中的正确方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:41:48.550

你要么误解了你的要求，要么你正在接近这个错误。这是要求的简化版本：

1.  该函数应该有 2 个参数、技能名称和某种验证字符串（在您的情况下，是允许的字符列表，也就是*白名单*）。明白了✔</li>
2.  技能名称不宜过长。这意味着您需要限制长度。✘</li>
3.  通过**验证**字符串是否匹配允许的字符列表，您需要确保它只匹配**那些**，而***不是其他***。现在，您正在检查是否**找到列表中的任何字符**。✘</li>
4.  该函数应**返回**错误（或不返回任何内容），因此，它本身不应**回**显任何内容。✘</li>

你应该努力解决这些问题。

另外，在另一个方面，您有语法错误。`echo echo`，应该是吧`else echo`。

# windows-mobile - 如何删除 Windows Mobile 6.5 上多余的开始菜单图标？

> ID：12846229
> 
> 赞同：1
> 
> 时间：2012-10-11T18:30:47.387
> 
> 标签：windows-mobile, windows-mobile-6.5

我有一个 Windows Mobile 5 应用程序，我们的生产车间正在使用它来扫描条形码并更新我们 SQL Server 上的数据。

我们很快就会购买新设备，它们配备了 Windows Mobile 6.5 Professional。

我一直在使用模拟器来启动我的应用程序并在其上运行，并让自己熟悉新的操作系统功能。

我似乎无法解决的问题之一是设备上的“开始菜单”中的所有图标都混乱不堪。

![截屏](../Images/aed14bba233b79c8db48fd201c07e791.png)

看到上面的截图了吗？这就是您单击开始菜单时弹出的内容！

**那是行不通的！**

我们有不会说英语的员工，我需要非常简化的桌面。电子邮件没有在这些上配置，它们没有互联网连接，没有短信等。

我应该删除所有这些并在那里放置一个指向我们应用程序的链接。

在 Windows Mobile 5 中，我能够清除所有这些多余的垃圾，以免我们的员工感到困惑。

![手机5截图](../Images/3eea8495c4f4c49825ddbd500e2c6531.png)

**如何在 Windows Mobile 6.5 下清除开始菜单？**

我想将项目显示为 LIST 而不是 ICONS。那可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T11:48:07.993

首先，只需删除“\Windows\开始菜单”下的所有链接和文件夹，只保留主页和设置项：

![非常稀疏的 Windows Mobile '开始菜单'](../Images/7c4005fedcfaa3254cb2bbfc5030f711.png)

...

Windows Mobile 6.5 始终使用六边形布局。获得或多或少的列表布局的唯一方法是使用一列。

设备上的 Windows 目录中有一些布局文件。具有扩展名 .cpr 并且看起来像 xml：

```
 <Form Width="480" Height="640">
  <StartMenu_GridScene ID="Scene">

  <GridView ID="Start Menu Items List" Top="0" Left="0" Width="480" Height="536" Columns="3" Scrollable="TRUE" HexagonGrid="TRUE" HorizontalWrapAround="TRUE" PaginatedScrolling="TRUE">
     <Image ID="Selection" Left="0" Top="-30" Width="192" Height="158" Source=".\StartMenu_Selection.png" />
     <Layer ID="GridItem"  Width="192" Height="166" OnAction ="GridItemAction">
        <Layer ID="Normal">
                <Image ID="Image" Left="51"  Top="4" Width="90" Height="90" ScaleStyle="Fit" />

                <Text  ID="Text"  Left="18" Top="98" Width="156" Height="68" FontFamily="Tahoma" FontSize="7" HorizontalAlignment="Center" VerticalAlignment="Top" Wrap="True" Trimming="EllipsisCharacter" ForeColor="#00FFFFFF" BackColor="#00000000" />
        </Layer>
    </Layer>

   <Layer ID="NoItems">
       <Text ID="Text" Width="480" Height="40" FontFamily="Tahoma" FontSize="10" ForeColor="#00FFFFFF" Wrap="False" HorizontalAlignment="Center" Trimming="Character" InnerTextType="Resource">shellres.dll,22596</Text>
   </Layer>

  </GridView>

  </StartMenu_GridScene>
</Form> 
```

您可以下载正确的文件（查看您设备的分辨率，我的是 480x640），然后更改列数：

```
<GridView ID="Start Menu Items List" Top="0" Left="0" Width="480" Height="536" Columns="**1**" Scrollable="TRUE" HexagonGrid="TRUE" HorizontalWrapAround="TRUE" PaginatedScrolling="TRUE"> 
```

然后将更改的文件复制到设备上，并在现有文件的顶部。由于该文件可能是 ROM 文件，您可能需要更好的资源管理器来覆盖该文件（例如 Altap Salamander 或 Total Commander）。

![windows mobile 6.5上的一栏视图](../Images/90f18e6a021fc67e318b19c164153da0.png)

如果您正在寻找更好的应用程序锁定方式，您应该尝试 SPB Kiosk 或 Odyssey AppCenter。一些供应商提供了自己的信息亭模式解决方案线 Intermec 与 IntermecLauncher 一起使用。

制作一个真正锁定的应用程序是一种很难的方法，另请参阅我的网站 hjgode.de/wp

~约瑟夫

# c# - 在控制台应用程序中将 HTML 标记传递到 RazorEngine

> ID：12846232
> 
> 赞同：2
> 
> 时间：2012-10-11T18:31:02.473
> 
> 标签：c#, html, templates, razor

我正在尝试使用 RazorEngine 3 将 HTML 元素插入到模板中。当我尝试这个时，生成的字符串（稍后用作 HTML）最终会显示 HTML 标记，而不是利用它来呈现页面。

**代码：**

```
var linkText = new HtmlString("<a href=" + location + ">" + linkName + "</a>");
string result = Razor.Parse(template, new {MyLink = linkText}); 
```

**模板文件：**

```
Link to file: @Model.MyLink 
```

**生成的 HTML：**

```
Link to file: <a href=http://blah.com>Blah link</a> 
```

此功能在 RazorEngine 2 上运行良好，但由于另一个故障我不得不升级。此外，这是一个控制台应用程序，因此添加 @Raw 功能可能会很复杂。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T17:32:16.033

答案最终是使用传递给模板的字符串类型变量。模板反过来使用 Raw() 方法，如下所示。

**代码：**

```
string linkText = "<a href=" + location + ">" + linkName + "</a>";
string result = Razor.Parse(template, new {MyLink = linkText}); 
```

**模板文件：**

```
Link to file: @Raw(@Model.MyLink) 
```

# mysql - MySQL 查询检查用户评估

> ID：12846235
> 
> 赞同：1
> 
> 时间：2012-10-11T18:31:08.563
> 
> 标签：mysql

我无法为我拥有的用户评估表形成查询。

目前该表看起来像这样。

```
+-----+----------+----------+
| id  | video_id | user_id  |
+-----+----------+----------+
| 1   |       1  |        1 |
| 2   |       2  |       50 |
| 3   |       1  |      115 |
| 4   |       2  |       25 |
| 5   |       2  |       1  |
| 6   |       6  |       98 |
| 7   |       3  |        1 |
+-----+----------+----------+ 
```

我遇到的问题是形成一个查询，该查询为观看了 video_id 1、2 和 3 的人返回 user_id。因此在上面的示例中，只应返回 user_id 1。

我想做类似的事情

```
SELECT user_id 
    FROM user_assessment 
    WHERE video_id = '1' AND video_id = '2' AND video_id = '3' 
```

但这显然是不正确的。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T18:33:29.857

这里的关键是在 HAVING 子句 (3) 中检查的值等于 IN 分组中包含的元素数。这保证了所有三个视频都包括在内。

```
SELECT user_id
    FROM user_assessment
    WHERE video_id IN (1, 2, 3)
    GROUP BY user_id
    HAVING COUNT(DISTINCT video_id) = 3 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T18:33:08.890

```
SELECT user_id 
FROM user_assessment
WHERE video_id IN (1, 2, 3)
GROUP BY user_id
HAVING COUNT(video_id) = 3 
```

这假设每个用户没有重复的 video_id

# javascript - 通过操作 URL 设置单选按钮值

> ID：12846237
> 
> 赞同：1
> 
> 时间：2012-10-11T18:31:12.057
> 
> 标签：javascript, html, jsp

我敢肯定，你们所有人都操纵了参数化的 URL 来改变特定网站（不是您创建的）的外观。例如，您希望在页面上看到超过最大数量的结果，因此您可以执行以下操作：

```
http://www.example.com/search.jsp?results=1000 
```

或者快速跳转到第 1500 个结果：

```
http://www.example.com/search.jsp?startat=1500&results=50 
```

因此，考虑到这一点，我正在尝试创建指向网页某些搜索结果的链接，但我需要设置单选按钮的值才能获得我正在寻找的结果。我使用 Chrome 开发人员工具找到了字段名称，因为参数未显示在 URL 中，即使我可以通过使用找到的字段操作 URL 进行搜索。到目前为止，我有：

```
http://www.example.com/blah/search.jsp?vstr4=A123456789 
```

要在其中`vstr4`搜索的文本字段在哪里。但也有一个单选按钮，`vint2`。在 HTML 中，

```
<input type=​"radio" name=​"vint2" value=​"0" checked >​ "Type 1"
<input type=​"radio" name=​"vint2" value=​"1">​ "Type 2" 
```

在这种情况下，`Type 1`是默认设置，但我需要将单选按钮设置为`Type 2`获取我要查找的内容。所以我的问题是，**如何在索引 1 的选中属性处设置单选按钮？**我尝试过类似的东西：

```
http://www.example.com/blah/search.jsp?vstr4=A123456789&vint2=1 
```

和

```
http://www.example.com/blah/search.jsp?vstr4=A123456789&vint2[1]checked="checked" 
```

和类似的。我不确定如何访问单选按钮的特定索引的属性。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:34:29.500

单选按钮只是名称/值对。它们更像是形状奇特的文本输入，而不是其他任何东西。将“vint2”设置为“1”就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T18:38:29.983

只需添加

```
&vint2=1 
```

到网址！

# node.js - Node.js mongodb 设置默认安全变量

> ID：12846238
> 
> 赞同：13
> 
> 时间：2012-10-11T18:31:25.197
> 
> 标签：node.js, mongodb

我正在尝试在本地运行 Node.js 脚本，它给了我这个错误消息：

> ```
> ========================================================================================
> =  Please ensure that you set the default safe variable to one of the                  =
> =   allowed values of [true | false | {j:true} | {w:n, wtimeout:n} | {fsync:true}]     =
> =   the default value is false which means the driver receives does not                =
> =   return the information of the success/error of the insert/update/remove            =
> =                                                                                      =
> =   ex: new Db(new Server('localhost', 27017), {safe:false})                           =
> =                                                                                      =
> =   http://www.mongodb.org/display/DOCS/getLastError+Command                           =
> =                                                                                      =
> =  The default of false will change to true in the near future                         =
> =                                                                                      =
> =  This message will disappear when the default safe is set on the driver Db           =
> ======================================================================================== 
> ```

这是我的变量：

```
var express = require('express');

var mongodb = require('mongodb');
var GridStore = require('mongodb').GridStore;
var Db = require('mongodb').Db;
var Server = require('mongodb').Server;
var db = new Db(Config.dbName, new Server("127.0.0.1", 27017, {}), {});    

var HttpGet = require('./httpGet').HttpGet;
var URL = require('url');

var dbClient = null; // this is initialized when db is opened
var app = module.exports = express(); 
```

相同的脚本在我的实时服务器上运行良好。只有当我在本地运行它时它才会崩溃。

我发现在 github 上讨论了同样的问题，但没有找到解决方案。 [https://github.com/kissjs/node-mongoskin/issues/77](https://github.com/kissjs/node-mongoskin/issues/77)

有谁知道什么可能导致这个问题？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-11T19:32:47.680

以下适用于我使用 1.1.11 mongo 驱动程序：

```
var db = new Db(Config.dbName, new Server("127.0.0.1", 27017, {}), {safe: true}); 
```

如果没有`{safe: true}`参数，我会收到与您在问题中显示的相同的警告。

此警告是最近添加到驱动程序的；您可能在服务器上使用的是旧版本的驱动程序，这就是您在那里看不到警告的原因。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-12T20:23:38.143

我通过将`strict`模式设置为 false 让它工作。

```
var db = new Db(config.dbName, new Server("127.0.0.1", 27017, {}), {safe: false, strict: false}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-10T10:56:47.760

这对我有用！

```
var db = new Db((new DbServer('127.0.0.1', 27017), {w:-2,journal:false,fsync:false,safe: false}) 
```

# iphone - 我们如何才能解除我们不再使用它的视图？

> ID：12846245
> 
> 赞同：0
> 
> 时间：2012-10-11T18:32:03.197
> 
> 标签：iphone, objective-c, ios, memory-management

我目前正在设计一个用户应该先登录的简单应用程序。

我将登录页面设置为窗口的根视图。一旦用户登录系统，它将模态地呈现一个标签栏视图。

我想登录页面（实际上是导航控制器中的几个视图控制器）在那之后就没用了。我可以释放这些页面并将根视图重置为标签栏控制器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T18:36:25.647

不要将登录页面设置为根。使用现在应该作为根的选项卡栏呈现模式视图是错误的方式，并且很可能因此被 Apple 拒绝。

您当前拥有的第二个视图，或者用户在登录后应该看到的视图应该是 root。在这个根视图中，检查用户是否登录，如果没有，将登录显示为模式视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T18:39:47.703

你永远不应该`dealloc`直接从你的代码中调用。没有 ARC，唯一的例外是调用`dealloc`超类。有了 ARC（你应该使用 ARC），你就不必再打电话`dealloc`了。

话虽这么说，既然登录屏幕只会在几次运行中需要，为什么不反转流程，让标签栏控制器成为应用程序的根，只有在需要时才显示登录视图，也许没有动画，所以用户永远不会看到根？

# sql-server - 如何在从 tsql 查询派生的 xml 模式中显示表关系？

> ID：12846252
> 
> 赞同：0
> 
> 时间：2012-10-11T18:32:30.343
> 
> 标签：sql-server, tsql, xsd

我发现这个 tsql 查询显示了一个表的 xml 模式，它工作得很好。

```
SELECT * FROM TableA
FOR XML AUTO, XMLSCHEMA 
```

我现在正试图通过这个查询来显示表之间的关系。我不确定这是否可能。我已经模拟了几个测试表，但我没有任何运气。基本上，我在 tableA 和 tableB 之间创建一对多的关系，然后在 xml 模式中它将 tableA 显示为父级，而 tableB 将是模式中的子级。

这就是我一直在运行的。：

```
SELECT * FROM TableA,
dbo.TableB 
FOR XML AUTO, XMLSCHEMA 
```

这是我从上述查询中获得的示例 xml 模式文件。

```
<xsd:schema targetNamespace="urn:schemas-microsoft-com:sql:SqlRowSet7" xmlns:schema="urn:schemas-microsoft-com:sql:SqlRowSet7" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:sqltypes="http://schemas.microsoft.com/sqlserver/2004/sqltypes" elementFormDefault="qualified">
  <xsd:import namespace="http://schemas.microsoft.com/sqlserver/2004/sqltypes" schemaLocation="http://schemas.microsoft.com/sqlserver/2004/sqltypes/sqltypes.xsd" />
  <xsd:element name="TableA">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="columnA" type="sqltypes:int" />
        <xsd:element name="columnB">
          <xsd:simpleType>
            <xsd:restriction base="sqltypes:varchar" sqltypes:localeId="1033" sqltypes:sqlCompareOptions="BinarySort">
              <xsd:maxLength value="50" />
            </xsd:restriction>
          </xsd:simpleType>
        </xsd:element>
        <xsd:element ref="schema:dbo.tylersTestTable2" minOccurs="0" maxOccurs="unbounded" />
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="TableB">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="columnA" type="sqltypes:int" />
        <xsd:element name="columnB">
          <xsd:simpleType>
            <xsd:restriction base="sqltypes:varchar" sqltypes:localeId="1033" sqltypes:sqlCompareOptions="BinarySort">
              <xsd:maxLength value="50" />
            </xsd:restriction>
          </xsd:simpleType>
        </xsd:element>
        <xsd:element name="fkToTableA" type="sqltypes:int" />
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
</xsd:schema> 
```

如您所见，它将表显示为架构中的相同级别，而不是真正显示父子关系。我在这里有点不知所措，因为我不是 dba，但我必须为大量表格执行此操作，而且我不想全部手动编写。

关于这个有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:20:08.277

TSQL 中的表没有真正的父子关系。每个表处于同一级别，外键关系可能会对一个或两个表中的数据造成约束。从逻辑上讲，一张表可能是父表，一张表是子表，但这绝不意味着它们是物理层次结构。您可以使用像 ERwin 这样的建模工具来生成 XML，该工具将物理模型解释为逻辑模型，但 TSQL 实际上只看到物理模型。

# python - 在代理python上重写http请求

> ID：12846253
> 
> 赞同：0
> 
> 时间：2012-10-11T18:32:35.307
> 
> 标签：python, linux, proxy

我需要一些关于性能调整此脚本的建议，该脚本读取代理在临时 ram 磁盘上转储的 URL 标头，它读取文件并将其附加到列表中，经过一些检查后它会读取列表，并且如果该行包含“用户代理” " 使用标准输出重新编辑并刷新...

```
proc = open(sys.argv[1],'r')
    slog.write("writing standard input \n")
    for line in proc.readlines():
        header.append(line)

      . . . . . . . . 

        if check_header == None: #check_header is returned by one of the functions to whether rewrite the header
            for h in header:
                if "User-Agent" in h and "custom-header:" not in h:
                    h = h.rstrip("\r\n") + " custom-header:" + customer + "\r\n"
                sys.stdout.write(h)
                sys.stdout.flush()
            #sys.exit(1)

        else:
            sys.stdout.write(new_get) 
```

我担心的是，对于大量请求，它会很慢，因为它附加到列表，读取并刷新它，任何想法我可以如何调整它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T18:52:50.343

除非您在代码示例中的缩进是错误的，否则您尝试添加自定义标题的次数与列表中的元素数一样多。尝试

```
proc = open(sys.argv[1],'r')
slog.write("writing standard input \n")
for h in proc.readlines():

  . . . . . . . . 

    if check_header == None: #check_header is returned by one of the functions to whether rewrite the header
        if "User-Agent" in h and "custom-header:" not in h:
            h = h.rstrip("\r\n") + " custom-header:" + customer + "\r\n"
        sys.stdout.write(h)
        sys.stdout.flush()

    else:
        sys.stdout.write(new_get) 
```

# c# - 在运行时创建一组两个 Div

> ID：12846254
> 
> 赞同：0
> 
> 时间：2012-10-11T18:32:37.877
> 
> 标签：c#, asp.net, html, css

我有一个大约 600 像素宽度的页面。在此页面中，我想动态显示一个 Div，它本身会动态获取标题和其他文本。文本来自数据库。Div 看起来有点像这样，高度可能会根据它包含的文本而有所不同。

要显示此动态 Div 的表如下所示： ![在此处输入图像描述](../Images/2e51b2b9e2b535feed8323cf28a47115.png)

Div 应如下所示：

![在此处输入图像描述](../Images/777395278216d51d6510bc82afa35985.png)

它应该显示为一组两个（动态），只要有另一个记录可用，否则只应显示一个。

我使用示例 Div 尝试了此代码，但我想知道是否有更聪明的方法：

```
HtmlGenericControl divBlock = new HtmlGenericControl("div");
divBlock.ID = "Blockdiv";
divBlock.Attributes["style"] = "width: 120px; height: auto; background-color:grey";
divBlock.InnerHtml = "<div><table><tr><td>This is sample Div</td></tr></table></div>"; 
```

我的设计页面中的表单标签包含一个主 Div，如下所示：

```
<div id="MainDiv" runat="server"></div> 
```

我在其中插入动态生成的 div：

```
MainDiv.Controls.Add(divBlock); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T18:43:47.927

您可以使用`DataList`控件来实现

```
 <asp:DataList runat="server" ID="NamesDL" RepeatColumns="2" RepeatDirection="Horizontal">
 <ItemTemplate>
    <div class="header">
       <%# Eval("CustomerName") %>
    </div>
    <div class="Details">
       <%# Eval("ProcessDetails") %>
    </div>
 </ItemTemplate>
 </asp:DataList> 
```

在代码隐藏中

```
protected void Page_Load(object sender, EventArgs e)
{
   NamesDL.DataSource = getDataFromDatabase();
   NamesDL.DataBind();
} 
```

Asp.net 应该处理其余的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T18:42:26.093

我不会动态地构造这个 InnerHTML。你称它们为动态 div，但我认为你真正的意思是，你有两个或三个静态 div，并且你想控制它们每个的内容和可见性。

我会在页面上创建静态控件，然后在您的代码隐藏中，只需更改文本和可见性。

我也可能会为每个 div 创建一个用户控件，然后您可以从您的代码中与用户控件的属性进行交互，而不用担心它们是如何显示的。用户控件的 ascx（视图）将控制它们的呈现方式，即：表结构是什么，或者其他什么。

相反，如果您有不同数量的这些 div，基于数据库中的数据，我仍然会使用用户控件，但将它们设置在您绑定到数据源的某种转发器或列表控件中。

# php - PHP 图像下载器

> ID：12846262
> 
> 赞同：-1
> 
> 时间：2012-10-11T18:33:12.750
> 
> 标签：php, image, curl, download

嘿伙计们，我正在寻求帮助，从我的一个供应商那里下载 1000 多张图像，用于电子商务网站。他们为我提供了我在数组中设置的正确 URL，但我似乎无法找到任何 PHP 脚本来功能性地下载图像。

我有：

```
ArrayOf1000ULRS[];

Loop through Array
   -save_image(URL) 
```

我在网上找到的示例函数：

```
function save_image($img,$fullpath){
$ch = curl_init ($img);
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_BINARYTRANSFER,1);
$rawdata=curl_exec($ch);
curl_close ($ch);
if(file_exists($fullpath)){
    unlink($fullpath);
}
$fp = fopen($fullpath,'x');
fwrite($fp, $rawdata);
fclose($fp);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T15:39:58.230

```
foreach($fileNames as $url)
{
set_time_limit(0);
//Get the filename from the end of the URL.
$imgName = explode("/", $url);
//Used this to run multiple scripts.
//Basically don't download files you have.
if(!file_exists("./images/".$imgName[-int-]))
{
$ch = curl_init ($url);
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_BINARYTRANSFER,1);
$rawdata=curl_exec ($ch);
curl_close ($ch);
$fp = fopen("./images/".$imgName[-int-],'w');
fwrite($fp, $rawdata);
fclose($fp);
}
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-11T18:53:28.923

假设您在 *nix 机器上，您可以在其中抛出系统调用并使用 WGET。

```
foreach($arrayOfImages as $url){
    $cmd = "wget $url";
    system($cmd);
} 
```

真是不安全，但如果这是一次性的个人事情，我会说去做。

# actionscript-3 - 三角学 - 根据固定中心点计算角度

> ID：12846263
> 
> 赞同：1
> 
> 时间：2012-10-11T18:33:17.520
> 
> 标签：actionscript-3, trigonometry

我有一个 1000x1000 的网格，中心有一个固定点 (p1) 和一个可变点 (p2)。如何以度为单位计算以红色表示的角度？垂直的蓝线将始终固定为 0 度。

![图表](../Images/db714212174983148199a386a5925ccf.png)

提前谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:44:46.750

您可以使用以下公式计算角度：

```
if(x>0)
    angle = cos^-1(y/(sqrt(x^2+y^2))
else 
    angle = 180 + cos^-1(y/(sqrt(x^2+y^2)) 
```

其中是和`x`之间的水平距离，是垂直距离。`p1``p2``y`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T18:55:25.197

一些提示可以指导您理解为什么您已经看到/将看到的解决方案有效......

让 p2 坐在网格上的 (x,y) 位置；p2 在 x 轴上或 p2 在 y 轴上的投影是多少？

p1在哪里？

如何确定坐标轴上两点之间的距离？

毕达哥拉斯会说连接 p1 和 p2 的线的长度是多少？

您知道哪些三角函数事实将三角形的边与角联系起来？

如果我们知道 cos(x) = a，那么 x = ...？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T18:44:35.330

`arctan(p2.y/p2.x) + 90`适用于左上象限。根据您想要计算其他象限的方式，您可以使用相同的公式或使用倒数作为`abs(result - 180)`

# json - 如何拆分json整数键以获取年月

> ID：12846271
> 
> 赞同：0
> 
> 时间：2012-10-11T18:33:52.993
> 
> 标签：json

```
 I have a js object in json format, 
"monthly_sal":{
    "2012_08":"421",
    "2012_09":"332",
    "2012_10":"332"
}, 
```

我想以 2012 年和 08 月的形式访问 2012_08，我该如何在密钥上进行操作。基于此，我需要分别用其数据填充表格。我有代码可以拆分它，但不确定如何将其应用于 json 对象键并遍历整个对象

```
 var number = 2012_08;
   var splitstring = number.toString().split('_');
   var years = splitstring[0];
   var months = splitstring[1];
   alert(years + ' years,' + months + ' months');​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T18:35:33.383

使用`for i`n 迭代键，使用[parseInt](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseInt)从键的两个部分获取数字。

```
for (var key in monthly_sal) {
   var tokens = key.split('_');
   var years = parseInt(tokens[0], 10);
   var months = parseInt(tokens[1], 10);
   alert(years + ' years,' + months + ' months' + ' => ' + monthly_sal[key]);​
} 
```

# java - 我正在用 Java 实现长数字的 3Des 加密算法

> ID：12846273
> 
> 赞同：0
> 
> 时间：2012-10-11T18:34:00.263
> 
> 标签：java, string, 3des

我正在为一个项目实施 3Des 加密算法。

我以这段代码为例：

[http://www.java2s.com/Code/Java/Security/TripleDES.htm](http://www.java2s.com/Code/Java/Security/TripleDES.htm)

它工作正常，但我需要发送和接收字符串，但我这样做是为了将信用卡号保存在数据库中，所以我需要使用长数字，而不是字符串。

这样做有可能吗？

我必须使用特殊的 Key 还是必须对返回值进行一些转换？我正在寻找最好、最正确的解决方案。

我知道，也许我的问题有点傻，但我迷路了。

感谢您的回答，并为我糟糕的英语感到抱歉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T18:39:10.843

你需要`byte[]`加密，从很长时间你可以生成`byte[]`

```
public static byte[] toByteArray(long value)    
{  
    ByteBuffer bb = ByteBuffer.allocate(8);  
    return bb.putLong(value).array();  
}  

public long toLong(byte[] bytes) {
    ByteBuffer buffer = ByteBuffer.allocate(8);
    buffer.put(bytes);
    return buffer.getLong();
} 
```

使用它`byte[]`进行加密和解密。还要注意，信用卡号码太长真的不好。

# java - 识别 (JAVA) 代码内聚块的工具

> ID：12846277
> 
> 赞同：2
> 
> 时间：2012-10-11T18:34:20.113
> 
> 标签：java, methods, refactoring, extract, cohesion

我想知道是否有一种工具可以识别 JAVA 源代码中的内聚代码块。例如，如果我有一个很长的方法，我想从中提取另一个方法 - 是否有任何工具可以自动告诉我值得提取的大量代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:09:34.203

[Google CodePro Analytics](https://developers.google.com/java-dev-tools/codepro/doc/)有一个 Eclipse 插件，它可以提供一堆统计数据，例如代码行数和圈复杂度，这些数据可以很好地指示方法应该被重构。

我认为您不会找到可以自动将“内聚”代码块重构为方法的工具。这里面有太多的主观性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T18:35:11.323

[有像PMD](http://pmd.sourceforge.net/) (for eclipse) & [FindBugs](http://findbugs.sourceforge.net/manual/eclipse.html)等插件，可以进行静态代码审查，根据您配置的规则标记代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T06:10:10.230

我在另一个问题上寻找了一个类似的工具：[https](https://stackoverflow.com/questions/12016289/tool-for-visualizing-dependencies-inside-a-java-class) ://stackoverflow.com/questions/12016289/tool-for-visualizing-dependencies-inside-a-java-class只是在更高的级别：一个类。

我认为同样的答案也适用：没有那样的东西。虽然有一些工具可以提供信息，您可以从中提取您正在寻找的信息。

我会调查[DependencyFinder](http://depfind.sourceforge.net/)。它提供对所有代码片段的访问，因此您可以找到访问一组通用变量的代码元素集群。不幸的是，我发现 API 有点混乱并且没有很好的文档记录，所以你需要尝试和错误或与作者联系。我认为它也可能不会让您访问空白。但无论如何，我认为这不是一种有效的方法。

您可能想要研究的另一个工具是[JaMoPP](http://www.jamopp.org/index.php/JaMoPP) 它甚至应该包含有关空格的信息。虽然它是一个 Java 插件，但您可以使用独立于 eclipse 的底层库（我认为）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T18:36:34.630

查看[Sonar](http://www.sonarsource.org/)它对查找重复代码块有很好的支持。

Sonar 使用 PMD 和 FindBugs 底层。它还生成一些自定义指标，例如类复杂性、方法复杂性，这些指标指向太大的类/方法，并且可能被分解。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-12T05:48:50.487

控制块（即条件和循环）是“内聚的”，因为您不能轻易地提取跨越控制块边界的代码块。查找可以被方法调用替换的块，这使得原始方法更容易理解。通过提取最深的控制流嵌套区域，您将对复杂性产生最佳影响，因此这是一个很好的起点。你不需要这样的工具——代码本身就有你需要的信息。

# sql - 为什么 SQL Server 不使用索引进行非常相似的日期时间查询？

> ID：12846283
> 
> 赞同：4
> 
> 时间：2012-10-11T18:34:46.897
> 
> 标签：sql, indexing, primary-key

我在 SQL Server 上有一个大约 100 万行的表。它有一个 ID (PK)、一个状态 (int) 和一个日期时间列。我还在日期时间列上创建了一个索引。

现在我发现了一个我不明白的效果。

```
SELECT status
FROM table
WHERE dateTime BETWEEN '2010-01-01T00:00:00' AND '2010-01-02T12:00:00' 
```

此语句返回 3664 行。它运行大约 150 毫秒，执行计划显示它使用键查找进行索引查找。

现在，如果我将其更改如下（只需将小时从 12 更改为 13）：

```
SELECT status
FROM table
WHERE dateTime BETWEEN '2010-01-01T00:00:00' AND '2010-01-02T13:00:00' 
```

此语句返回 3667 行。它运行大约 600 毫秒，执行计划显示它使用主键！

我只是不明白。对于 3667 和更多的行，它总是使用主键，即使查找速度要快得多。

有解释吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T18:43:15.213

`status`不包含在索引中，`datetime`因此它需要对每个匹配行进行键查找以检索此值。

随着范围的增长（因此需要查找的数量），它估计仅扫描整个（覆盖）聚集索引以避免查找会更快。在您的情况下可能不正确。它从一个计划切换到另一个计划的点被称为[临界点](http://sqlskills.com/blogs/kimberly/category/The-Tipping-Point.aspx)。

您应该检查估计的行数与实际的行数是否不正常（也许自上次更新统计信息以来，已删除了一些与范围匹配的行）。

Or maybe the index scan is more expensive than the costing assumptions assume due to high levels of fragmentation or for some other reason the [costing assumptions](http://www.benjaminnevarez.com/2010/07/an-introduction-to-cost-estimation/) made do not reflect the actual relative performance in your environment.

# c# - 在面向对象编程中使用垃圾收集器？

> ID：12846288
> 
> 赞同：-4
> 
> 时间：2012-10-11T18:35:10.517
> 
> 标签：c#

我正在阅读有关垃圾收集器的信息。我想知道垃圾收集器在面向对象编程中的用途是什么？我们也可以手动删除对象而不是垃圾收集器。然后我们有垃圾收集器的一代，它具有 N、N+1、N+2 的角蛋白水平。他们真的那么重要吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T18:37:17.530

垃圾收集与面向对象编程无关。

C# 是一种托管语言。这意味着开发人员无需担心（至少不应该担心）内存管理。这就是垃圾收集器如此重要的原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T18:37:28.270

> 我们也可以手动删除对象而不是垃圾收集器

是的，我们可以——但它可能会给我们带来以下严重麻烦：

1.  [内存泄漏](http://en.wikipedia.org/wiki/Memory_leak)
2.  [悬空指针](http://en.wikipedia.org/wiki/Dangling_pointer)

GC 的使用通常会显着减少开发时间，但是在使用它时 - 我们会遭受一些性能损失，尤其是在[延迟](http://en.wikipedia.org/wiki/Latency_%28engineering%29)方面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T18:39:36.503

除非您正在编写`unsafe`代码，否则您不会在 C# 中释放内存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T18:42:56.623

垃圾收集器和面向对象编程是完全不同的概念。您可能会混淆它们，因为许多 OOP 语言都实现了某种形式的垃圾收集器。

垃圾收集是清理未使用资源的过程 - 意味着超出范围的对象等。它允许程序员（在大多数情况下）不必担心自己进行清理。

C# 是一种托管语言 - 这意味着它实现了垃圾收集器等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T18:44:58.047

这两个概念完全不相关。

你可以拥有一个而不是另一个。您可以使用垃圾收集语言*删除*对象，但无法*回收内存*。这是我使用过的所有语言中垃圾收集器的职责

为了证明它们是完全不同的概念，这里有一个带有/不带有 oop/gc 的语言的简短列表：

**垃圾收集器和面向对象：**

*   C＃
*   爪哇
*   无数人

**面向对象，但不是垃圾收集：**

*   C++

**垃圾收集但不是面向对象：**

*   JavaScript*

**既不收集垃圾，也不面向对象：**

*   C

* * *

*虽然 JavaScript 有*对象*，但它不像 C++ 和 Java 那样面向对象。我将其称为基于原型的语言而不是面向对象的语言。

# matlab - 覆盖用户定义类的值在它是结构的字段时如何显示

> ID：12846290
> 
> 赞同：4
> 
> 时间：2012-10-11T18:35:13.307
> 
> 标签：matlab, oop, enums

我创建了自己的类来充当枚举类型。我已经覆盖了 disp() 方法，因此当包含该类型的变量显示在命令行窗口中时，它会显示一些有意义的内容（特别是该枚举值的名称。）

```
classdef MyEnumeratedType

    properties(Constant)
        ENUMVAL1     = MyEnumeratedType(1, 'ENUMVAl1');
        ENUMVAL2     = MyEnumeratedType(2, 'ENUMVAL2');
        ENUMVAL3     = MyEnumeratedType(3, 'ENUMVAL3');
    end

    properties(Access=private)
        ordinal
        name
    end

    methods(Access=private)
        function this = MyEnumeratedType(ord, name)
            this.ordinal = ord;
            this.name = name;
        end
    end

    methods
        function disp( this )
            disp(this.name);
        end
    end

end 
```

因此，当我将它分配给命令窗口中的变量时，我得到了所需的输出：

```
>> x = MyEnumeratedType.ENUMVAL2

x = 

ENUMVAL2 
```

到目前为止，一切都很好。但是当我将 MyEnumeratedType 类型的值分配给结构的字段时，该结构的显示不会显示该值，而只会告诉我我有一个 MyEnumeratedType 类型的值。

```
>> mystruct.field1 = 42

mystruct = 

    field1: 42

>> mystruct.field2 = MyEnumeratedType.ENUMVAL3

mystruct = 

    field1: 42
    field2: [1x1 MyEnumeratedType] 
```

如何让 field2 的值像 field1 中的双精度值一样显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:28:04.693

结构的`disp`方法显示数值和元胞数组的内容，如果它们可以写成一行，否则显示类/大小信息：

```
s = struct('a',1,'b',[1 2 3],'c',{{1}},'d',magic(3),'e',[1;2])

s = 

    a: 1
    b: [1 2 3]
    c: {[1]}
    d: [3x3 double]
    e: [2x1 double] 
```

因此，要显示枚举的值，您需要`disp`对结构进行重载。为此，您`@struct`在路径上创建一个目录，并创建您自己的`disp`方法，希望忠实地重现 Matlab 所做的事情，但您的特定类除外。简而言之：这是可能的，但我不想成为这样做的人。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-12-03T05:25:34.113

此提交[http://www.mathworks.com/matlabcentral/fileexchange/48637](http://www.mathworks.com/matlabcentral/fileexchange/48637)试图`disp`很好地重新创建该函数。因此，您可以将其用于`disp.m`放入`@struct`文件夹中。

# android - 如何将数据和时间从 TextView 保存到 SQLite？

> ID：12846308
> 
> 赞同：1
> 
> 时间：2012-10-11T18:36:18.207
> 
> 标签：android, database, time, android-date

在我的应用程序中，我有 2 个按钮打开时间对话框/日期对话框，然后我选择日期和时间，然后按确定。因此该值显示在 TextView 中（对于每个），所以我需要从 TextViews 中获取 VALUE 并将其保存在数据库中。

**数据库行**=`date`

TextView 中显示的时间代码：

```
tvHora = (TextView) findViewById(R.id.tvHora);

    final Calendar d = Calendar.getInstance();
    hour = d.get(Calendar.HOUR_OF_DAY);
    minute = d.get(Calendar.MINUTE);

    //set current time into textview
    tvHora.setText(new StringBuilder().append(pad(hour)).append(":").append(pad(minute))); 
```

TextView 中显示的日期代码：

```
tvData = (TextView) findViewById(R.id.tvData);

    final Calendar c = Calendar.getInstance();
    year = c.get(Calendar.YEAR);
    month = c.get(Calendar.MONTH);
    day = c.get(Calendar.DAY_OF_MONTH);

    //SET CURRENT DATE INTO TEXTVIEW

    tvData.setText(new StringBuilder().append(year).append("-").append(month + 1).append("-").append(day).append("-")); 
```

单击“保存”按钮时的代码：

```
 ContentValues valor = new ContentValues();
                        valor.put("mensagenssalvas", resultado);
                        db.insert("mensagens", null, valor); 
```

那么如何从文本视图中获取值以保存在数据库中呢？

**编辑** 时间选择器对话框：

```
private TimePickerDialog.OnTimeSetListener timePickerListener = new TimePickerDialog.OnTimeSetListener() {

        public void onTimeSet(TimePicker view, int selectedHour, int selectedMinute) {
            // TODO Auto-generated method stub

            hour = selectedHour;
            minute = selectedMinute;

            //set current time into textview
            tvHora.setText(new StringBuilder().append(pad(hour)).append(":").append(pad(minute)));

        }
    }; 
```

日期选择器对话框：

```
 private DatePickerDialog.OnDateSetListener datePickerListener = new DatePickerDialog.OnDateSetListener() {

        public void onDateSet(DatePicker view, int Year, int monthOfYear,
                int dayOfMonth) {
            // TODO Auto-generated method stub

            year = Year;
            month = monthOfYear;
            day = dayOfMonth;

            // set selected date into textview
            tvData.setText(new StringBuilder().append(month + 1)
                .append("-").append(day).append("-").append(year)
                .append(" "));
        }

    }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T18:50:57.377

我会将值作为数字存储在 SQLite 中以使其兼容，因为 SQLite 没有内置日期/时间数据类型。

您需要将值保存在 DatePicke's`OnDateSetListener`中。

给你一个如何做到这一点的例子很大程度上取决于你如何创建日期选择器。假设设置了值，您可以使用下面的代码。请注意，它假设 tvData 和 tvHora 在类属性（类的全局变量）中，这样您可以在设置它们后重用它们（应该在 onCreate 中完成）也许这样的事情会起作用：

```
private final SimpleDateFormat parser = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");

//keep your current code for the date/time pickers..

public void saveData(View button) {
    String dateStr = tvData.getText().toString();
    String timeStr = tvHora.getText().toString();

    //only save if both fields are non empty 
    if (!TextUtils.isEmpty(dateStr) && !TextUtils.isEmpty(timeStr)) {
       try {
         Date d = parser.parse(dateStr + " " + timeStr);
         ContentValues valor = new ContentValues();
         valor.put("mensagenssalvas", d.getTime());
         db.insert("mensagens", null, valor);
       } catch(ParseException ex) {
          Log.e("YOURTAG", "Error parsing date", ex);
       }
    } else {
      Log.d("YOURTAG", "Both fields not present, can't save");
    }

} 
```

在文件的 xml 布局中创建一个保存按钮，如下所示：

```
<Button  android:id="@+id/Save"
            android:onClick="saveData"
            android:text="Save" /> 
```

或者，如果您不想将 onClick 放在 xml 中，您可以在如下代码中执行相同的操作：

```
Button saveButton = findViewById(R.id.save);
saveButton.setOnClickListener(new View.OnClickListener() {
      @Override
      public void onClick(View button) {
        saveData(button);
      }

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T18:54:35.330

看到您可以在对话框上注册
**OnDateSetListener** 侦听器，当您按下 OK 按钮时该侦听器将被触发。例如

```
OnDateSetListener
{           
           @Override
       public void onDateSet(DatePicker view, int year, int monthOfYear,int dayOfMonth) {

        // here you can set the date to the textview as you want
     }
} 
```

谈到第二点，如果您想将此日期存储到 SQLITE 数据库中，则此日期或时间将自动转换为字符串。请阅读[此](http://www.sqlite.org/draft/datatype3.html)。所以把它放在你的任何格式中，比如 dd-MM-yyyy 并存储它。并在检索读取为字符串并根据需要转换为日期格式时

# sql - 在连接中使用表值函数

> ID：12846320
> 
> 赞同：1
> 
> 时间：2012-10-11T18:37:06.367
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2005, cross-apply

有一个表值函数，它提供多行作为输出，并且有 2 列作为输出。

现在我想在查询employees表中的所有员工时使用这个函数

我正在使用 CROSS APPLY 但它需要很长时间并且没有给出任何结果。

这是我尝试过的查询

```
select *
from emp A Cross APPLY fnempDiv(A.EmpID) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T18:54:57.327

我正在使用交叉应用

*   它需要很长时间

不幸的是，这就是 CROSS APPLY 的本质，因为它是逐行运算符。它适用于一些员工行（方便），但根据您的描述，您应该避免在此查询中使用它，并将 APPLY 中的查询扩展到外部查询。一个简单的 INNER JOIN 应该可以。

*   没有给出任何结果。

CROSS APPLY 从 APPLY 中删除`emp A`不产生任何行的记录。OUTER APPLY 将保留`emp A`记录。如果您总共获得 0 条记录，则您可能传递了错误的列，例如`A.EmpID`不是正确的键。

如果函数是这样定义的（来自您的评论）：

```
CREATE FUNCTION dbo.fnempDiv(@EmpID)
RETURNS TABLE AS RETURN
 SELECT A.EmpID,D.Name
 FROM empdetail A
 INNER JOIN empdiv D on A.empID=D.ID
 where EXISTS (select * from X)
GO 
```

这根本没有意义。`Select * from X`要么使整个查询失败，要么成为一个无效条件，只需通过记录`X`或其他方式。输入参数`@EmpID`也没有被使用。

另一方面，如果声明如下：

```
CREATE FUNCTION dbo.fnempDiv(@EmpID)
RETURNS TABLE AS RETURN
 SELECT A.EmpID,D.Name
 FROM empdetail A
 INNER JOIN empdiv D on A.empID=D.ID
 where A.EmpID = @EmpID
GO 
```

然后可以重写您的完整查询

```
select E.*, A.emp_ID as EmpDetail_Emp_ID, D.Name
from emp E
INNER JOIN empdetail A ON E.emp_ID=A.EMP_ID
INNER JOIN empdiv D on A.empID=D.ID 
```

此外，连接`A.empID=D.ID`甚至看起来都不正确。

# jquery - 在 ASP.NET MVC 3 下使用 jQuery/AJAX 组合自动完成失败（在某些输入上）

> ID：12846325
> 
> 赞同：1
> 
> 时间：2012-10-11T18:37:27.377
> 
> 标签：jquery, asp.net-mvc-3

我有一个用于在员工之间进行搜索的搜索字段。视图的代码如下所示：

```
<input id="employeeSearchText" name="employeeSearchText" type="text" autocomplete="off" />  

<script type="text/javascript" language="javascript">
    $("#employeeSearchText").autocomplete({
        source: function (request, response) {
            $.ajax({
                url: "/Medarbejdere/Soeg",
                type: "POST",
                dataType: "json",
                data: { searchText: request.term },
                success: function (data) {
                    response($.map(data, function (item) {
                        return { label: item.Firstname + " " 
                 + item.Lastname, value: item.description, id: item.description }
                    }))
                }
            })
        }
    });
</script> 
```

路径“/Medarbejdere/Soeg”在控制器中定义为：

```
[HttpPost]
public JsonResult Soeg(string searchText)
{
    EmployeeRepository repo = new EmployeeRepository();
    var result = repo.SearchByKeywords(searchText.Trim(), 10);
    return Json(result, JsonRequestBehavior.AllowGet);
} 
```

我的问题是，对于某些输入，结果永远不会出现。实际上只输入一个字母并等待输入，英文字母表中相同的 5 个字母永远不会返回结果，始终如一。

在所有输入的“Soeg”操作中放置一个断点，并且 repo.SearchByKeywords() 也为所有输入返回正确的结果，但由于某种原因，当结果返回给 AJAX 调用时，它永远不会呈现。

我完全不知道在这个阶段如何进行调试。我使用 MVC 迷你分析器，它显示了以下行为（假设字母“c”不给出结果，而字母“e”给出）

键入“e”将触发对操作的调用，触发断点，浏览器左侧的 mvc-mini-profiler 调试信息将显示调用花费了多长时间。键入“c”将触发对操作的调用，触发断点，但不会显示在 mvc-mini-profiler 调试窗口中。

现在，如果我键入另一个“c”以使搜索字符串为“cc”，分析器实际上会显示两个对操作的调用，但仅在键入第二个“c”时

有关如何进一步调试问题的解决方案甚至建议的任何想法？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:39:44.790

显然问题是由 repo.SearchByKeywords() 的结果引起的。

虽然结果是正确的，但在以 JSON 形式返回时，它会以某种方式破坏某些输入的自动完成功能。

根本原因是返回的数据类型是 SQL Server 中定义的数据类型，它引用了其他表。如果单个元素上的一个引用为空（在业务逻辑的其他部分完全没问题），自动完成小部件会以某种方式导致错误。

我通过返回一个更简单的数据结构而不是来自数据库的实际表来缓解这种情况，其中包含固定数量的从不为空的字段。

# jquery - jQuery - 检查空 TD，如果全部为空，则隐藏父 TR

> ID：12846330
> 
> 赞同：11
> 
> 时间：2012-10-11T18:38:01.560
> 
> 标签：jquery, html, css

我想检查空的 TD（仅限类啊），如果都是空的，那么我想隐藏父 TR。我遇到的问题是，我的空 TD 包含“”我不确定如何测试这些？

[http://jsfiddle.net/FeQ7h/1/](http://jsfiddle.net/FeQ7h/1/)

```
<table>
  <tr>
    <td class="requirementRight">Requirement</td>
    <td class="a">&nbsp;</td>
    <td class="b">&nbsp;</td>
    <td class="c">&nbsp;</td>
    <td class="d">&nbsp;</td>
    <td class="e">&nbsp;</td>
    <td class="f">NOT EMPTY</td>
    <td class="g">&nbsp;</td>
    <td class="h">&nbsp;</td>
  </tr>
  <tr>
    <td class="requirementRight">Requirement</td>
    <td class="a">&nbsp;</td>
    <td class="b">&nbsp;</td>
    <td class="c">&nbsp;</td>
    <td class="d">&nbsp;</td>
    <td class="e">&nbsp;</td>
    <td class="f">&nbsp;</td>
    <td class="g">&nbsp;</td>
    <td class="h">&nbsp;</td>
  </tr> 
```

​</p>

```
if ( $('td.a:empty, td.b:empty, td.c:empty, td.d:empty, td.e:empty, td.f:empty, td.g:empty, td.h:empty') ) {
   // hide the parent tr
} ​ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T18:49:58.947

“如果为空”不清楚，因为在您的示例中，它们充满了“nbsp”。这就是我创建一个名为 isEmpty() 的函数的原因，以便您可以在其中定义自定义规则。因为你不想要requirementRight，所以我放了td:not(.requirementRight)。这不是正确的方法。

正确的做法，就是上二班啊，比如

```
<tr>
    <td class="requirementRight">Requirement</td>
    <td class="checkempty a">&nbsp;</td>
    <td class="checkempty b">&nbsp;</td>
    <td class="checkempty c">&nbsp;</td>
    <td class="checkempty d">&nbsp;</td>
    <td class="checkempty e">&nbsp;</td>
    <td class="checkempty f">NOT EMPTY</td>
    <td class="checkempty g">&nbsp;</td>
    <td class="checkempty h">&nbsp;</td>
  </tr> 
```

所以我们可以调用 tr.find(tr.checkempty)..

无论如何，这是代码！

```
$("tr").each(function() {
  var trIsEmpty = true;
  var tr = $(this);

    tr.find("td:not(.requirementRight)").each(function() {
      td = $(this);

        if (isEmpty(td) === false)  {
         trIsEmpty = false;   
        }
    });

    if (trIsEmpty == true) {
         tr.hide();                       
    }
});

    function isEmpty(td) {
        if (td.text == '' || td.text() == ' ' || td.html() == '&nbsp;' || td.is(":not(:visible)")) {
            return true;
        }            

        return false;
    }
​ 
```

工作示例：http: [//jsfiddle.net/FeQ7h/7/](http://jsfiddle.net/FeQ7h/7/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-11T18:47:11.793

这就是您要查找的内容：

```
$(function(){
    $('tr').each(function(){
        var _hide = true;
        $(this).find('td:not(.requirementRight)').each(function(){
            if($(this).text().trim() != ''){
                _hide = false;
            }
        });

        if(_hide){
            $(this).hide();
        }
    });
}) 
```

您检查每一行是否有空白以外的内容，如果没有找到则隐藏该行。玩得开心！工作示例：http: [//jsfiddle.net/kvCXa/7/](http://jsfiddle.net/kvCXa/7/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-11T18:45:05.303

首先，我建议给 TD 一个额外的类来区分要检查其内容的 TD。下面，我使用了 .et (emptyTest)。

下面的语法可能有点错误，但它应该给你的想法：

```
$("tr").each(function() {
  var nonEmpty = $(this).find("td.et").filter(function() {
    return $(this).text().trim() != ""; //check the trimmed TD content - will make it ignore all white space
  });
  if (nonEmpty.length == 0) $(this).hide();
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-11T18:40:35.393

为什么不省略不间断的空格？我猜他们是为了在空的 TD 上进行造型设计的？

如果是这样，您可以使用此 CSS 来解决该问题：

```
table
{
    empty-cells: show;
} 
```

更正了 CSS。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-11T19:22:16.527

```
$('tr').each(function(){
  var emptyTdArray=$(this).find('td:not(:.requirementRight,:empty)').filter(function() {     
  return $(this).html()!= "&nbsp;";  
  });

  if(emptyTdArray.length==0)
  {
     $(this).hide();
  }
}); 
```

# c# - EPPlus 数据透视表 - 折叠整个字段

> ID：12846334
> 
> 赞同：6
> 
> 时间：2012-10-11T18:38:33.010
> 
> 标签：c#, .net, vb.net, openxml, epplus

有谁知道如何做到这一点？

我在 .Net 中使用 EPPlus，并创建了一个包含 2 个行字段和一个汇总数据字段的数据透视表：

```
Dim Pivot As OfficeOpenXml.Table.PivotTable.ExcelPivotTable
Pivot = wksPivot.PivotTables.Add(wksPivot.Cells("A1"), Datarange, "pName")

Pivot.RowFields.Add(Pivot.Fields("Fld1")).Sort = Table.PivotTable.eSortType.Ascending
Pivot.RowFields.Add(Pivot.Fields("Fld2")).Sort = Table.PivotTable.eSortType.Ascending

Dim dtaFld As OfficeOpenXml.Table.PivotTable.ExcelPivotTableDataField
dtaFld = Pivot.DataFields.Add(Pivot.Fields("XYZ"))
dtaFld.Function = Table.PivotTable.DataFieldFunctions.Sum 
```

一切正常，但我希望数据透视表在用户打开工作簿时以折叠状态开始（在 excel 中，当您创建数据透视表时，您可以右键单击数据元素并选择“展开/折叠" > "折叠整个字段"

热我可以通过代码做到这一点吗？（如果 EPPlus 还不支持，我愿意直接使用 OpenXML ......）

**另外**，有没有办法从工作簿中删除原始数据，以便数据透视表仍然有效？我试过了，当我打开工作簿时，我的数据透视表是空白的？- 我目前的逻辑让我想到了[这个问题](https://stackoverflow.com/questions/16346004/openxml-epplus-create-pivotcache-in-net)......有什么想法吗？

（我确实知道我在 VB 中写了这个问题。但我在这个问题中添加了`C#`&`VB`标记 - 我对任何一种语言的代码都很满意 - 谢谢！！）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-22T17:32:45.660

可以使它成为 xlsm 并向其添加 vba。这可能是这个解决方案最糟糕的答案，但它实现了完全崩溃。我提供了一个工作示例，只需将过去复制到一个新的控制台应用程序中即可。添加 epplus 依赖项“F5”。

修改/取自[http://epplus.codeplex.com/SourceControl/latest#SampleApp/Sample15.cs](http://epplus.codeplex.com/SourceControl/latest#SampleApp/Sample15.cs)

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using OfficeOpenXml.Table;
using OfficeOpenXml.Table.PivotTable;
using OfficeOpenXml;
using System.IO;

namespace pTable
{
    class Program
    {
        static void Main(string[] args)
        {
            //ExcelPackage _pck = new ExcelPackage();

            Directory.CreateDirectory(string.Format("Test"));
            //ExcelPackage _pck = new ExcelPackage(new FileInfo("Test\\Worksheet.xlsx"));
            ExcelPackage _pck = new ExcelPackage(new FileInfo("Test\\Worksheet.xlsm"));

            var wsPivot1 = _pck.Workbook.Worksheets.Add("Rows-Data on columns");

            var ws = _pck.Workbook.Worksheets.Add("Data");
            ws.Cells["K1"].Value = "Item";
            ws.Cells["L1"].Value = "Category";
            ws.Cells["M1"].Value = "Stock";
            ws.Cells["N1"].Value = "Price";
            ws.Cells["O1"].Value = "Date for grouping";

            ws.Cells["K2"].Value = "Crowbar";
            ws.Cells["L2"].Value = "Hardware";
            ws.Cells["M2"].Value = 12;
            ws.Cells["N2"].Value = 85.2;
            ws.Cells["O2"].Value = new DateTime(2010, 1, 31);

            ws.Cells["K3"].Value = "Crowbar";
            ws.Cells["L3"].Value = "Hardware";
            ws.Cells["M3"].Value = 15;
            ws.Cells["N3"].Value = 12.2;
            ws.Cells["O3"].Value = new DateTime(2010, 2, 28);

            ws.Cells["K4"].Value = "Hammer";
            ws.Cells["L4"].Value = "Hardware";
            ws.Cells["M4"].Value = 550;
            ws.Cells["N4"].Value = 72.7;
            ws.Cells["O4"].Value = new DateTime(2010, 3, 31);

            ws.Cells["K5"].Value = "Hammer";
            ws.Cells["L5"].Value = "Hardware";
            ws.Cells["M5"].Value = 120;
            ws.Cells["N5"].Value = 11.3;
            ws.Cells["O5"].Value = new DateTime(2010, 4, 30);

            ws.Cells["K6"].Value = "Crowbar";
            ws.Cells["L6"].Value = "Hardware";
            ws.Cells["M6"].Value = 120;
            ws.Cells["N6"].Value = 173.2;
            ws.Cells["O6"].Value = new DateTime(2010, 5, 31);

            ws.Cells["K7"].Value = "Hammer";
            ws.Cells["L7"].Value = "Hardware";
            ws.Cells["M7"].Value = 1;
            ws.Cells["N7"].Value = 4.2;
            ws.Cells["O7"].Value = new DateTime(2010, 6, 30);

            ws.Cells["K8"].Value = "Saw";
            ws.Cells["L8"].Value = "Hardware";
            ws.Cells["M8"].Value = 4;
            ws.Cells["N8"].Value = 33.12;
            ws.Cells["O8"].Value = new DateTime(2010, 6, 28);

            ws.Cells["K9"].Value = "Screwdriver";
            ws.Cells["L9"].Value = "Hardware";
            ws.Cells["M9"].Value = 1200;
            ws.Cells["N9"].Value = 45.2;
            ws.Cells["O9"].Value = new DateTime(2010, 8, 31);

            ws.Cells["K10"].Value = "Apple";
            ws.Cells["L10"].Value = "Groceries";
            ws.Cells["M10"].Value = 807;
            ws.Cells["N10"].Value = 1.2;
            ws.Cells["O10"].Value = new DateTime(2010, 9, 30);

            ws.Cells["K11"].Value = "Butter";
            ws.Cells["L11"].Value = "Groceries";
            ws.Cells["M11"].Value = 52;
            ws.Cells["N11"].Value = 7.2;
            ws.Cells["O11"].Value = new DateTime(2010, 10, 31);
            ws.Cells["O2:O11"].Style.Numberformat.Format = "yyyy-MM-dd";

            var pt = wsPivot1.PivotTables.Add(wsPivot1.Cells["A1"], ws.Cells["K1:N11"], "Pivottable1");

            pt.Compact = true;
            pt.CompactData = true;

            pt.GrandTotalCaption = "Total amount";
            pt.RowFields.Add(pt.Fields[1]);
            pt.RowFields.Add(pt.Fields[0]);
            pt.DataFields.Add(pt.Fields[3]);
            pt.DataFields.Add(pt.Fields[2]);
            pt.DataFields[0].Function = DataFieldFunctions.Product;
            pt.DataOnRows = false;

            _pck.Workbook.CreateVBAProject();

            var sb = new StringBuilder();

            sb.AppendLine("Private Sub Workbook_Open()");
            sb.AppendLine("    Range(\"A1\").Select");
            sb.AppendLine("    ActiveSheet.PivotTables(\"Pivottable1\").PivotFields(\"Category\").PivotItems(\"Hardware\").ShowDetail = False");
            sb.AppendLine("End Sub");

            _pck.Workbook.CodeModule.Code = sb.ToString();

            _pck.Save();

        }

    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-07T15:10:00.390

使用 EPPlus，您可以尝试类似（取自[这篇 SO 帖子](https://stackoverflow.com/questions/9464047/how-to-set-pivot-table-report-layout-to-tabular-in-epplus)）：

```
(from pf in pivot.Fields
 select pf).ToList().ForEach(f =>
 {
     f.Compact = false;
     f.Outline = false;
 }); 
```

或者更简单地说，像下面这样的东西不工作吗？

```
pvtTable.Compact = False
pvtTable.CompactData = False
pvtTable.Outline = False
pvtTable.OutlineData = False
pvtTable.ShowDrill = True 
```

另请查看[这篇 SO 帖子](https://stackoverflow.com/questions/15479192/creating-pivot-table-in-excel-using-open-xml-and-c-sharp)，详细介绍了一种很好的逆向工程方法，用于了解 excel 如何实现“事物”。

PS无法帮助您解决其他“也”问题，抱歉。

# php - onclick 显示在 php 页面中单击的文件夹的内容

> ID：12846335
> 
> 赞同：0
> 
> 时间：2012-10-11T18:38:35.897
> 
> 标签：php, ftp

嗨，我的 PHP 页面有以下代码，它通过 FTP 函数向我显示另一台服务器中目录的内容

```
<?php
$conn = ftp_connect("host") or die("Could not connect");
ftp_login($conn,"username","password");
$files = ftp_nlist($conn,"logs");
foreach($files as $value)
    {
    echo $value;
    }
ftp_close($conn);
?> 
```

该目录包含子目录，我要做的是输出结果中的每个文件夹！当我点击它时；它向我展示了它的内容，我不知道如何让它工作这是生成结果的链接，但上面的代码[点击我](http://ahstpc.6te.net/site/test.php) 应该使用 onclick = 原谅一些 PHP 函数还是什么？以及如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:42:24.027

尝试将循环中的代码更改为：

```
echo "<a href=\"test.php?dir={$value}\">{$value}</a>"; 
```

用这个替换你的`ftp_nlist`函数调用：

```
if ($_GET['dir'] != null) {
    ftp_chdir($conn, "logs/{$_GET['dir']}");
}
else
    ftp_chdir($conn, "logs");
}

$files = ftp_nlist($conn,""); 
```

这将导致`$value`作为`$_GET['dir']`.

编辑：最终代码应如下所示：

```
<?php
$conn = ftp_connect("host") or die("Could not connect");
ftp_login($conn,"username","password");

if ($_GET['dir'] != null) {
    ftp_chdir($conn, "logs/{$_GET['dir']}");
}
else
    ftp_chdir($conn, "logs");
}

$files = ftp_nlist($conn,"");

foreach($files as $value) {
    echo "<a href=\"test.php?dir={$value}\">{$value}</a>";
}

ftp_close($conn);
?> 
```

# php - PHP iMagick 从另一个 imagick 对象而不是文件加载图像

> ID：12846336
> 
> 赞同：1
> 
> 时间：2012-10-11T18:38:38.733
> 
> 标签：php, image, load, imagick

我创建了两个 imagick 对象，将文件**test.pdf**`$obj_one`中的图像添加并加载到.`$obj_two`**`$obj_one`**

 **现在我需要从文件中加载图像，但从另一个 imagick 对象`$obj_one`加载图像。`$obj_two`

我该怎么做？

请注意，我将`$obj_two`分辨率设置为两倍，`$obj_one`并且我需要在加载到`$obj_one`.

**编辑**：

```
$obj_one = new Imagick();
$obj_two = new Imagick();

$obj_one->setOption('pdf:use-cropbox', 'true');
$obj_one->readImage("docs/test.pdf");

$output_x_res = 800; //px
$output_y_res = $obj_one->getImageHeight() * $output_x_res / $obj_one->getImageWidth();

$Img_Dpi_Arr = $obj_one->getImageResolution();

$final_x_dpi = ceil(($Img_Dpi_Arr['x'] / $obj_one->getImageWidth()) * $output_x_res);
$final_y_dpi = ceil(($Img_Dpi_Arr['y'] / $obj_one->getImageHeight()) * $output_y_res);

$obj_two->setResolution($final_x_dpi,$final_y_dpi);

... 
```**

# html - 固定侧边栏和流体内容区域

> ID：12846338
> 
> 赞同：1
> 
> 时间：2012-10-11T18:38:57.470
> 
> 标签：html, css

![在此处输入图像描述](../Images/09fa616b317f5828cd1c438e40e10e39.png)

我试图创建一个像这张图片一样的页面。但我被侧边栏困住了。我试图让它左右浮动。但是有些棘手的问题！试图使侧边栏绝对定位。但是当内容区域很大时，侧边栏背景跟不上内容区域。

谁能帮我创建一个基本结构？

这是我用过的！

```
aside{
    width: 215px;
    background: #f9f9f9;
    padding:5px 0;
    padding:5px;
    position: absolute;
    top: 128px;
    bottom:0;
    left: 0     
}
.main .content{
    background:#fff;
    padding:5px;
    margin-left: 195px;
    height:100%;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:34:16.233

您可以通过侧边栏上的绝对定位和内容上的边距来做到这一点：http: [//jsbin.com/ucihul/1/edit](http://jsbin.com/ucihul/1/edit)

关键属性是：

1.  在侧边栏和内容的父元素上：`position: relative`

2.  在侧边栏上：

    ```
    bottom: 0;
    left: 0;
    position: absolute;
    top: 0;
    width: 215px; /* or whatever your fixed width is */ 
    ```

3.  在内容 div 上：（`margin-left: 215px`或任何您的固定宽度）

您还可以在侧边栏和内容中包含内部 div 以进行额外控制（它们在我的演示中，但我没有对它们做任何事情）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T18:44:41.023

这个怎么样：

**HTML**

```
 <div id="sidebar">Sidebar</div>
  <div id="content">Content</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

**CSS**

```
 ​#sidebar { float: left; width: 100px; background: red; }
 #content { margin-left: 100px; background: blue; }​ 
```

小提琴：http: [//jsfiddle.net/j7dS5/1/](http://jsfiddle.net/j7dS5/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T19:26:44.270

最简单的方法是图形化。制作一个与“.main”区域一样宽且高度为 1 像素的图像，并根据您设置的 div 的宽度进行适当的着色。

```
.main{
    background:url(images/image.png) top center repeat-y;
}
aside{
    width: 215px;
    padding:5px 0;
    padding:5px;
    position: absolute;
    top: 128px;
    bottom:0;
    left: 0     
}
.main .content{
    padding:5px;
    margin-left: 195px;
} 
```

# linux - 这是编写 opts 的正确方法吗

> ID：12846345
> 
> 赞同：0
> 
> 时间：2012-10-11T18:39:20.793
> 
> 标签：linux, bash, shell, command-line, getopts

这是获取和设置 OPTS 的正确方法吗？

我希望能够接受很多选择，比如

./runthis.sh --option1 setuff --option2 setmorestuff

```
while :
do
        case $1 in
                -h | --help | -\?)
                        usage
                        exit 0
                        ;;
                -o | --option1)
                        O=$2
                        shift 2
                        ;;
                -z | --option2)
                        Z=$2
                        shift 2
                        ;;
                --) # End of all options
                        shift
                        break
                        ;;
                -*)
                        echo "WARN: Unknown option (ignored): $1" >&2
                        shift
                        ;;
                *)  # no more options. Stop while loop
                        break
                        ;;
        esac
done 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T03:24:03.297

如果您想解析选项，您有两个现成的选项可供您使用：

1.  getopts（你可以查找这个的 getopts 教程）
2.  手动解析（我将在这里介绍）

使用 getopts 可能更容易，但不够灵活。您的代码大部分是正确的，但不适合更一般的选项解析。

1.  正如 chepner 所说，`while true`与`while :`. 前者是首选，因为它可以立即直观地看到它在做什么。这是我们正在谈论的 bash，而不是 perl。不需要不必要的混淆。
2.  `while true`不是解析选项的良好循环终止条件。如果你仔细想想，它不会告诉你循环在做什么。我必须一直到你的最后一个案例才能了解发生了什么。正确的循环终止条件是当您用完命令行参数时。
3.  我们的循环正在执行任何形式的统一循环并不是很明显。我必须阅读每个案例以查看您正在移动位置参数数组。由于您将`shift`在每次迭代中至少执行一次，因此请执行此操作。
4.  绑定到#2，使用`*)`检查循环终止不是一个好主意。空字符串将匹配：

    ./foo.sh --option1 "" --option2 123

    如您所见，`option2`使用您的代码永远不会获得它的价值。幸运的是 #2 也会解决这个问题。

5.  最后一点：您可能应该引用所有变量，除非您确定它们不会包含空格。bash 中的空格拆分发生在变量替换之后，所以空格真的会搞砸你。如果您不确定，请引用它。

您的代码的修订版本可能是：

```
while [ $# -gt 0 ]
do
        case "$1" in
                -h | --help | -\?)
                        usage
                        exit 0
                        ;;
                -o | --option1)
                        O="$2"
                        shift
                        ;;
                -z | --option2)
                        Z="$2"
                        shift
                        ;;
                --) # End of all options
                        shift
                        break
                        ;;
                *)
                        echo "WARN: Unknown option (ignored): $1" >&2
                        break
                        ;;
        esac
        shift
done 
```

# ios - 应用程序的 iOS 错误

> ID：12846348
> 
> 赞同：-3
> 
> 时间：2012-10-11T18:39:34.063
> 
> 标签：ios, iphone, ios5

我正在为我的应用创建登录和注册。每次运行此代码时，我都会收到此错误：

```
#import <UIKit/UIKit.h>

#import "THRAppDelegate.h"

int main(int argc, char *argv[])
{
    @autoreleasepool {
        return UIApplicationMain(argc, argv, nil, NSStringFromClass([THRAppDelegate class]));
    }
} 
```

谁能告诉我这是什么意思？我相信它发生在服务器端（PHP）

我不断收到的 JSON 响应也是错误：False

这是php代码：

```
function registerUser($email, $name, $username, $password){

    $uuid               = uniqid('', true);
    $hash               = hashSSHA($password);
    $encrypted_password = $hash["encrypted"]; //encrypted password
    $salt               = $hash["salt"]; //salt password

$register = query("SELECT email FROM users WHERE email='$email' limit 1");  

    if (count($register['result'])>0) {

        errorJson('This email is already registered. Try to login or recover your password.');
    }

    //try to register the user

$result  = query("INSERT INTO users(unique_id, name, email, username, encrypted_password, salt) VALUES('$uuid', '$name', '$email','$username', '$encrypted_password', '$salt', NOW())");    
    if (!$result['error']) {
        //success
        login($email, $password);

    } else {
        //error
        //errorJson('Sorry, something went wrong :( . Please try again later.');
        errorJson(mysql_error());
    }

}

function login($email, $password){

    $result = query("SELECT uid, email FROM users WHERE email ='%s' AND password ='%s' limit 1", $email, $password);

    if (count($result['result'])>0) {

            $salt               = $result['salt'];
            $encrypted_password = $result['encrypted_password'];
            $hash               = checkhashSSHA($salt, $password);

            //checking for password equality
            if ($encrypted_password == $hash) {
                //user authentication details are correct
                return $result;
                //authorized
                $_SESSION['uid'] = $result['result'][0]['uid'];

                print json_encode($result);
            }

    } else {
        //not authorized
        errorJson('Wrong Email and password combination.');
    }

}

function hashSSHA($password){

        $salt = sha1(rand());
        $salt = substr($salt, 0,10);
        $encrypted = base64_encode(sha1($password . $salt, true) . $salt);
        $hash = array("salt" => $salt, "encrypted" => $encrypted);
        return $hash;
    }

/*
    *Decrypting password
    *#param salt. pasword
    returns hash string
    */
function checkhashSSHA($salt, $password){

        $hash = base64_encode(sha1($password.$salt, true) . $salt);
        return $hash;
    } 
```

Xcode 错误

```
2012-10-11 15:04:42.528 Thryfting[1457:c07] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFBoolean isEqualToString:]: unrecognized selector sent to instance 0x1883964'
*** First throw call stack:
(0x1752012 0x1577e7e 0x17dd4bd 0x1741bbc 0x174194e 0x6184af 0x618674 0x8b0706 0x8be578 0x8beb50 0x1b5fb 0x1ce4c 0x1e6fb 0xed99 0x1f0753f 0x1f19014 0x1f097d5 0x16f8af5 0x16f7f44 0x16f7e1b 0x2c827e3 0x2c82668 0x4bf65c 0x2bad 0x2ad5 0x1)
libc++abi.dylib: terminate called throwing an exception 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:05:25.747

您可以通过 Zombie 对象跟踪您的代码：

# `⌥</kbd>`⌘</kbd>`R```

选择“诊断”选项卡并单击“启用僵尸对象”：

![点击](../Images/20e6b65718733cfb4846d07aab57f8af.png)

这会将释放的对象转换为 NSZombie 实例，在再次使用时会打印控制台警告。这是一种调试辅助工具，可以增加内存使用（没有真正释放对象），但可以改进错误报告。

一个典型的情况是当你过度释放一个对象并且你不知道是哪一个时：

*   与僵尸：`-[UITextView release]: message sent to deallocated instance`
*   没有僵尸：![EXC_BAD_ACCESS](../Images/48c8461bcbf885414cfbd24b1a8c0ca3.png)

* * *

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T21:06:47.803

所以，据我所知，你的错误是

```
[__NSCFBoolean isEqualToString:]: unrecognized selector.... 
```

这意味着，在您的代码中的某处（无法告诉您在哪里，因为您没有提供它）您正在向一个不是 NSString 的对象发送 isEqualToString 消息。

请您快速搜索一下，看看您在哪里发送该消息？可能是您正在读取一个布尔值，但将其视为 NSString。请检查您的代码，并确认您在发送该消息之前检查了数据类型。

请提供可能发生这种情况的代码。

# ajax - 使用 Proc 返回默认布局行为

> ID：12846350
> 
> 赞同：3
> 
> 时间：2012-10-11T18:39:37.750
> 
> 标签：ajax, ruby-on-rails-3, layout

我正在向我的网站添加不显眼的 ajax，因此我需要根据请求类型设置布局：

```
# app/controllers/application_controller.rb
layout Proc.new { |controller| controller.request.xhr? ? 'ajax' : 'application' }

# app/views/layout/ajax.html.erb
<%= render :partial => "shared/flash", :object => flash %>
<%= yield %> 
```

但我也想使用嵌套布局并让我的 javascript 处理在哪里插入 ajax 检索的内容。根据[rails api](http://api.rubyonrails.org/classes/AbstractController/Layouts/ClassMethods.html#method-i-layout) layout nil force 默认布局行为与继承，所以我尝试了这个：

```
layout Proc.new { |controller| controller.request.xhr? ? 'ajax' : nil } 
```

这不起作用，我根本没有布局。我发现的唯一一条信息是一个旧的聊天日志，它说这确实是行不通的，因为 Rails 处理布局的方式。

有没有办法做到这一点？

由于返回 nil 的 proc 不起作用，它们是一种在满足条件的情况下设置布局的方法（request.xhr？这里）。像 layout_if 这样的东西。

或者我应该添加

```
layout Proc.new { |controller| controller.request.xhr? ? 'ajax' : 'controller_name' } 
```

给每个具有不同布局的控制器？

我的 ajax 请求实际上返回了 html，我应该稍微作弊并在 .xml 文件中返回那些 html 元素并使用 respond_to 来设置布局吗？（这可能很棒，出于另一个原因，在有和没有布局内容的情况下访问不同的 url 可以允许页面缓存，但还有其他方法可以实现这一点。）

或者也许有更好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T10:41:42.183

Rails 可以自动执行此操作。例如，您创建 2 个布局（`application.html.erb`和`application.js.erb`）。什么时候请求是 xhr？它将使用 js( `application.js.erb`) 布局，如果标准请求到达服务器 rails 将呈现`application.html.erb`。

# objective-c - UIScrollView contentSize 不起作用

> ID：12846351
> 
> 赞同：62
> 
> 时间：2012-10-11T18:39:41.773
> 
> 标签：objective-c, ios, uiscrollview

我把 a`UIScrollView`放在我的 nib's`view`中，并将它链接到 a`IBOutlet`属性。

现在，当我在我的`viewDidLoad`方法中执行此操作时，它似乎对以下内容没有影响`contentSize`：

```
self.sv.backgroundColor = [UIColor yellowColor]; // this works
CGSize size =  CGSizeMake(1000.0, 1000.0); 
[self.sv setContentSize:size]; // this does not 
```

它的行为就好像`contentSize`与框架相同。这是怎么回事？当我关闭自动布局时，这开始工作。为什么？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-10-11T18:44:08.700

我有同样的问题。自动布局`UIScrollView`搞砸了。

解决方法：将所有内容`UIScrollView`放入另一个`UIView`中，并将其`UIView`作为唯一的孩子`UIScrollView`。然后你可以使用自动布局。

如果接近尾端的事情搞砸了（无论你`UIScrollView`滚动哪个方向的尾端），请更改最后的约束以具有最低的优先级。

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2014-03-31T11:46:39.540

我尝试使用 viewWillLayoutSubviews 来更新 scrollView 的 contentSize，它对我有用。

```
- (void)viewDidLayoutSubviews
{
  [self.bgScrollView setContentSize:CGSizeMake(320, self.view.frame.size.height* 1.5)];
} 
```

[**苹果文档**](https://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#jumpTo_87)

```
-(void)viewDidLayoutSubviews 
```

调用以通知视图控制器其视图刚刚布置了其子视图。

**讨论**

当视图控制器视图的边界发生变化时，视图会调整其子视图的位置，然后系统调用此方法。但是，调用此方法并不表示视图的子视图的各个布局已被调整。每个子视图负责调整自己的布局。

您的视图控制器可以覆盖此方法以在视图布置其子视图后进行更改。此方法的默认实现什么也不做。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-03-05T01:01:31.867

最简单/最干净的方法是在 viewDidAppear 设置 contentSize，这样你就可以否定自动布局的效果。这不涉及添加随机视图。然而，依靠加载顺序来实现工作可能不是最好的主意。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2016-09-02T12:45:29.203

使用此代码。ScrollView setContentSize 应该在主线程中被称为异步。

迅速：

```
override func viewDidLayoutSubviews() {
    super.viewDidLayoutSubviews()

    DispatchQueue.main.async {
        var contentRect = CGRect.zero

        for view in self.scrollView.subviews {
           contentRect = contentRect.union(view.frame)
        }

        self.scrollView.contentSize = contentRect.size
    }
} 
```

目标 C：

```
 - (void)viewDidLayoutSubviews {
     [super viewDidLayoutSubviews];

     dispatch_async(dispatch_get_main_queue(), ^ {
                        CGRect contentRect = CGRectZero;

                        for(UIView *view in scrollView.subviews)
                           contentRect = CGRectUnion(contentRect,view.frame);

                           scrollView.contentSize = contentRect.size;
                       });
} 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2014-05-12T04:26:19.937

### 在 Interface Builder 中使用带有 UIScrollViews 的 AutoLayout 的超级简单方法：

**第 1 步：**创建一个`UIScrollView`

**第 2 步：**创建一个`UIView`滚动视图的子项，如下所示：

```
-UIScrollView
---UIView
-----Your other content 
```

（我们称它为`contentView`）。

**第 3 步：**在尺寸检查器中，为该视图指定高度和宽度（例如 320x700）。

![](../Images/6d084ad5396747af0405cc9e1960dc5d.png)

**第 4 步（使用 AutoLayout）：**创建从您的`contentView`到其父视图（the `UIScrollView`）的明确约束：连接 4 个边缘（顶部、前导、尾随、底部），然后给它一个定义的宽度和高度，您希望它也可以滚动。

例如：如果你的滚动视图跨越整个屏幕，你可以给你的内容视图一个[设备宽度]的宽度和一个600的高度；然后它将设置`UIScrollView`要匹配的内容大小。

**或者：**

**第 4 步（不使用 AutoLayout）：**使用 IB 将这两个新控件连接到您的视图控制器（从每个控件按 ctrl+拖动到您的视图控制器的 .h @implementation）。让我们假设每个分别被称为`scrollView`和`contentView`。它应该如下所示：

```
@interface YourViewController : UIViewController

@property (strong, nonatomic) IBOutlet UIScrollView *scrollView;
@property (strong, nonatomic) IBOutlet UIView *contentView;

@end 
```

**第 5 步（不使用 AutoLayout）：**在视图控制器的 .h 文件中添加（实际上是覆盖）以下方法：

```
-(void)viewDidLayoutSubviews
{
    [super viewDidLayoutSubviews];
    self.scrollView.contentSize = self.contentView.frame.size;
} 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2012-11-25T15:31:55.507

这里有两个问题。(1) viewDidLoad 过早；您必须等到布局完成后。(2) 如果您想使用来自笔尖的滚动视图的自动布局，那么您必须使用约束来完全描述的大小`contentSize`（然后您根本不设置`contentSize`in 代码），或者，如果您想要在代码中设置它，你必须*防止*对滚动视图的子视图的约束决定`contentSize`. 听起来你想做后者。为此，您需要一个 UIView 作为滚动视图的唯一顶级子视图，并且在代码中您必须将其设置为*不*使用自动布局，启用它`autoresizingMask`并删除它的其他外部约束。我在这里展示了一个如何做到这一点的例子：

[https://github.com/mattneub/Programming-iOS-Book-Examples/blob/master/ch20p573scrollViewAutoLayout/ch20p573scrollViewAutoLayout/ViewController.m](https://github.com/mattneub/Programming-iOS-Book-Examples/blob/master/ch20p573scrollViewAutoLayout/ch20p573scrollViewAutoLayout/ViewController.m)

但请注意下一个示例，它显示了如何完全使用约束，*而*不是`contentSize`.

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-04-17T13:48:03.553

您可以在 *.m 文件中使用这行代码

```
- (void)viewDidLoad{
   [scroll setContentSize:CGSizeMake(320, 800)]   ;
   [scroll setScrollEnabled:TRUE];
   [scroll setShowsVerticalScrollIndicator:NO];
   [scroll setShowsHorizontalScrollIndicator:YES];
} 
```

为此，您需要以这种方式将 UIScrollView 的 IBOutlet 属性放入您的 *.h 文件中：

```
IBOutlet UIScrollView *scroll; 
```

并从 Storyboard 连接它。

或者，

您可以在 *.m 文件中使用此方法：

```
-(void)viewDidLayoutSubviews 
{
  [scroll setContentSize:CGSizeMake(320, self.view.frame.size.height* 1.5)];
   // this will pick height automatically from device's height and multiply it with 1.5  
} 
```

这两种解决方案都适用于**xcode-5、xcode-6、xcode-6.1、xcode-6.2**

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-12-13T20:53:34.183

设置 contentSize`viewDidAppear`至关重要。

但我也有 3.5 英寸屏幕和 4 英寸屏幕的变化。4英寸的屏幕可以用，旧的不行。两者都是 iOS 7。奇怪的是轻描淡写！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-01-18T17:48:09.617

我永远无法获得基于约束的自动布局来工作。由于我的视图已经是 UIScrollView 的子类，因此我通过覆盖 setContentView: 并忽略自动布局零高度 setContentSize: 消息来解决它。

```
@interface MyView : UIScrollView {}
@end

@implementation MyView
- (void)setContentSize:(CGSize)aSize {
    if (aSize.height > 0)
        [super setContentSize:aSize];
}
@end 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-08-27T22:15:54.860

我曾经以编程方式设置 uiscrollview，直到我观看了以下精彩教程，逐步了解如何让 uiscrollview 和 uiview 工作：[https ://www.youtube.com/watch?v=PgeNPRBrB18](https://www.youtube.com/watch?v=PgeNPRBrB18)

观看视频后，您肯定会开始喜欢 Interface Builder。

投票

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-11-10T01:22:45.987

**当标签的动态高度超过视图高度时仍然不滚动。**

我做了上面标记为正确的 yuf 的回答（我在我的滚动视图中添加了一个内容视图，并设置了从内容视图到滚动视图的前导、尾随、顶部底部和相等宽度的约束。）但我的视图仍然是当内部控件高度超过滚动视图的高度时不滚动。

[![在此处输入图像描述](../Images/d0d3143dbb696f2a0676336cd29c9628.png)](https://i.stack.imgur.com/IB8po.png)

在我的内容视图中，我在其下方有一个图像和 3 个标签。每个标签都会根据其中的文本量调整自己的高度（它们被设置为自动换行并且 numberoflines = 0 来实现这一点）。

我遇到的问题是当标签超过滚动视图/主视图的高度时，我的内容视图的高度没有根据标签的动态高度进行调整。

为了解决这个问题，我说我需要在底部标签和内容视图之间设置*底部空间到容器*约束，并给它一个值 40（任意选择以在底部给它一个很好的边距）。现在这意味着我的内容视图调整了它的高度，以便在最后一个标签的底部和它自身之间有一个空间，并且***它可以完美地滚动***！

耶！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-06-06T09:05:04.007

试试这个......
像你一样添加所有约束`UIView` *（参见我在 Storyboard 中的 ViewControler 的屏幕截图*） 现在技巧开始了。选择最后一个对象并选择其底部约束。*（参见上面的屏幕截图，Instagram 按钮的底部约束（黄线））*并在尺寸检查器中更改常量，如下图所示。
[![在此处输入图像描述](../Images/1a0823bf2cf4f3a111a1ae95b375d367.png)](https://i.stack.imgur.com/2OZoy.png)

 *[![在此处输入图像描述](../Images/59529787243fceb2a7f3b4306924a319.png)](https://i.stack.imgur.com/JJpzd.png)

我需要 Constant=8 但您可以根据自己的要求进行更改。这个常量是那个橙色按钮的底部和滚动视图之间的空间。

**编辑**

确保您的视图的层次结构。

0）ViewController.view（**可选**）
1）UIScrollView
2）UIView（重命名为“contentView”）
3）UIView（这个视图是你的内容，会让**scrollView**滚动）

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-09-21T15:40:45.937

我终于找到了自己的解决方案来解决这个问题，因为在我的情况下，我无法使用视图控制器的生命周期。创建您自己的滚动视图子类并使用它来代替 UIScrollView。这甚至适用于集合视图单元格内的滚动视图。

```
 class MyScrollView:UIScrollView {

    var myContentSize:CGSize = CGSize.zero  // you must set this yourself 

    override func layoutSubviews() {
       super.layoutSubviews()
       contentSize = myContentSize
    }

 } 
```

我的 MyScrollView 是在笔尖中定义的，标签为 90。如果是这样，这是在父视图的代码中设置内容大小的好方法。

```
let scrollView = viewWithTag(90) as! MyScrollView      
scrollView.myContentSize = ... 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-03-27T18:44:51.677

如果您使用`AutoLayout`一种非常简单的方法来设置`contentSize`a `UIScrollView`，只需添加如下内容：

```
CGFloat contentWidth = YOUR_CONTENT_WIDTH;

NSLayoutConstraint *constraintWidth = 
 [NSLayoutConstraint constraintWithItem:self.scrollView 
                              attribute:NSLayoutAttributeTrailing 
                              relatedBy:NSLayoutRelationEqual 
                                 toItem:self.scrollView 
                              attribute:NSLayoutAttributeLeading 
                             multiplier:1 
                               constant:contentWidth];

[self.scrollView addConstraint:constraintWidth]; 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-05-02T14:12:58.917

我让 Autolayout 为页面占据整个屏幕宽度的分页滚动视图工作。**页面会根据滚动视图的大小自动调整大小。**我还没有测试过宽度较小的滚动视图，但如果它有效，请不要评论——我相信它应该。针对 iOS 9，在 Swift 2 中编写代码，在`awakeFromNib`.

脚步：

*   定义全屏滚动视图。
*   在滚动视图中，添加一个`UIView`（我称为 mine `contentView`），它的顶部、尾部、底部和前导边缘都为零；高度等于滚动视图的高度；**但宽度是滚动视图的宽度乘以页数。**如果您在视觉上执行此操作，您将看到您的内容视图超出了 Inteface Builder 中的滚动视图。
*   对于 中的每个“页面” `contentView`，添加 Autolayout 规则以将它们并排放置，但最重要的是，**给它们每个约束，以便它们的宽度等于滚动视图的宽度，而不是内容视图的宽度。**

下面的示例代码。`embedChildViewController`这只是我添加子 VC 的便捷方法——看看`setupLayoutRulesForPages`. 我正好有两页，所以功能太简单了，但您可以根据需要进行扩展。

在我的视图控制器中：

```
override func loadView() {
    self.view = self.customView
}

override func viewDidLoad() {
super.viewDidLoad()

self.embedChildViewController(self.addExpenseVC, toView: self.customView.contentView, fillSuperview: false)
self.embedChildViewController(self.addCategoryVC, toView: self.customView.contentView, fillSuperview: false)
self.customView.setupLayoutRulesForPages(self.addExpenseVC.view, secondPage: self.addCategoryVC.view)
} 
```

我的自定义视图：

```
class __AMVCView: UIView {

    @IBOutlet weak var scrollView: UIScrollView!
    @IBOutlet weak var contentView: UIView!
    @IBOutlet weak var pageControl: UIPageControl!

    override func awakeFromNib() {
        super.awakeFromNib()

        self.scrollView.pagingEnabled = true
        self.scrollView.bounces = true
        self.scrollView.showsHorizontalScrollIndicator = false
        self.scrollView.showsVerticalScrollIndicator = false

        self.pageControl.numberOfPages = 2

        self.contentView.backgroundColor = UIColor.blueColor()
        self.scrollView.backgroundColor = UIColor.clearColor()
        self.backgroundColor = UIColor.blackColor()
    }

    func setupLayoutRulesForPages(firstPage: UIView, secondPage: UIView) {
        guard self.contentView.subviews.contains(firstPage) && self.contentView.subviews.contains(secondPage)
            else {
                return
        }

        let rules = [
            "H:|-0-[firstPage]-0-[secondPage]-0-|",
            "V:|-0-[firstPage]-0-|",
            "V:|-0-[secondPage]-0-|"
        ]
        let views = [
            "firstPage" : firstPage,
            "secondPage" : secondPage
        ]
        let constraints = NSLayoutConstraint.constraintsWithVisualFormatArray(rules, metrics: nil, views: views)

        UIView.disableAutoresizingMasksInViews(firstPage, secondPage)
        self.addConstraints(constraints)

        // Add the width Autolayout rules to the pages.
        let widthConstraint = NSLayoutConstraint(item: firstPage, attribute: .Width, relatedBy: .Equal, toItem: self.scrollView, attribute: .Width, multiplier: 1, constant: 0)
        self.addConstraint(widthConstraint)
    }

} 
```*

# objective-c - 评价要执行的链接方式

> ID：12846359
> 
> 赞同：0
> 
> 时间：2012-10-11T18:40:36.890
> 
> 标签：objective-c

我可以看到有很多方法可以编写用于对应用程序进行评分的 url，我的方法是：

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"http://itunes.apple.com/us/app/appName/id-----------?mt=8"]]; 
```

我看到了许多其他方式，例如：

```
@"itms-apps://ax.itunes.apple.com/WebObjects/MZStore.woa/wa/viewContentsUserReviews?type=Purple+Software&id=341086403"; 
```

我不能检查，我想确定。这样做的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T08:48:08.273

使用 Appirater 类对您的应用进行评分。希望[此](http://www.buzztouch.com/forum/thread.php?tid=B60C6EE41CD7D289048B0F4)链接对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T18:52:09.043

不太确定你的问题是什么。您**`openURL`**正确使用将用户重定向到 App Store。iOS 将解析这个 URL，看到它是一个 iTunes 应用程序链接并相应地重定向用户。

此外，您发布的第二个示例是将用户重定向到应用程序的客户评论页面。

# java - 使用 DateTime 来描述生日

> ID：12846361
> 
> 赞同：3
> 
> 时间：2012-10-11T18:40:47.733
> 
> 标签：java

我正在使用库 DateTime 来存储生日的日期值。

```
 DateTime dateTime01Abegin = new DateTime(2013, 5, 23, 00, 00);
 DateTime dateTime01Bbegin = new DateTime(2012, 5, 22, 00, 00); 
```

在它们上运行 .getDayOfYear() 方法，我得到的两个值都是 143。但是一个是 5 月 23 日，一个是 5 月 22 日 - 我不明白为什么他们返回相同的值！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-11T18:42:12.930

2012 年有 366 天（2 月 29 日），而 2013 年有 365 天，这就是两个日期都返回 143 的原因。

一年中的天数在闰年有一天的偏移量，因为在 2 月 28 日之后，闰年比正常年份多了一天。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-11T18:42:25.990

不是每一年都是 365 天，有些年份是 366 天。

2012 年是闰年，这意味着它多了一天，即 2 月 29 日。对于 2 月 28 日之前的`.getDayOfYear()`日期，对于任何年份的类似日期，都将返回相同的值。对于 2 月 28 日之后`.getDayOfYear()`的日期，如果这两个日期都在闰年，或者这两个日期都不是闰年，则将返回相同日期的相同值。否则，它们应该相差一个。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-11T18:42:39.307

闰年。2012 年是闰年，所以有一个 2 月 29 日，将所有“较晚”的日期推到一个位置，所以你的 5 月 22 日实际上是这两年的第 143 天。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-11T18:43:17.127

2012年是闰年。所以 2013 年 5 月 23 日比 2012 年 5 月 23 日早了 1 天。

# c# - 这个的优化代码是什么

> ID：12846371
> 
> 赞同：1
> 
> 时间：2012-10-11T18:41:34.570
> 
> 标签：c#, c#-4.0

我有一个`string1, string2,...,stringn` 和每个字符串的值是

`string1 = "s1k1-s1k2-s1k3-....-s1kn | s1v1-s1v2-s1v3-....-s1vn";`

`string2 = "s2k1-s2k2-s2k3-....-s2kn | s2v1-s2v2-s2v3-....-s2vn";`

```
 ............. 
```

`stringn = "snk1-snk2-snk3-....-snkn | snv1-snv2-snv3-....-snvn";`

现在，我想`Dictionary<string, string>()`用键和值填充如下。

```
var dict = new Dictionary<string, string>();
dict.Add(s1k1, s1v1);
dict.Add(s1k2, s1v2);
         :
         :
dict.Add(snkn, snvn); 
```

**下面是我的示例代码：**

```
 string string1 = "s1k1-s1k2-s1k3-s1kn|s1v1-s1v2-s1v3-s1vn";
        string string2 = "s2k1-s2k2-s2k3-s2kn|s2v1-s2v2-s2v3-s2vn";
        string stringn = "snk1-snk2-snk3-snkn|snv1-snv2-snv3-snvn";

        var dict = new Dictionary<string, string>();

        new List<string> { string1, string2, stringn }.ForEach(str =>
        {
            var strSplit = str.Split('|');
            var strKeys = strSplit[0].Split('-');
            var strValues = strSplit[1].Split('-');
            strKeys.Zip(strValues, (key, value) => new { key, value }).ToList().ForEach(filed => dict.Add(filed.key, filed.value));
        }); 
```

是否可以优化此代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T09:31:15.363

在我看来，就内存使用而言，这里最昂贵的操作是`strSplit = str.Split('|')`. 它创建两个大字符串，之后直接进入垃圾`strKeys`并`strValues`获得。稍后所有这些垃圾字符串将被垃圾收集器收集，这将对性能产生负面影响。

`strKeys`和`strValues`字符串数组包含将在 中使用的字符串，`dict`因此这里的内存损失是最小的。

要优化内存使用，您必须`str`逐个字符地遍历并使用`StringBuilder`类创建键和值。在这种情况下，内存损失将是最小的，但是您的代码不会像现在这样干净。因此，仅当这部分代码是您的应用程序中真正的性能瓶颈时，我才会推荐这种解决方案。

# javascript - Chrome 扩展程序 - 仅在新加载时清除 WebRequest

> ID：12846376
> 
> 赞同：0
> 
> 时间：2012-10-11T18:41:49.997
> 
> 标签：javascript, google-chrome, google-chrome-extension, webrequest

我正在尝试编写一个扩展，将所有 http 标头信息存储在一个数组中，以便我可以通过弹出窗口显示它。为了保持一个整洁的弹出页面，我需要在每次新加载后清除标题，但我需要一种方法来判断何时应该发生这种情况。

1）清除新的requestId

*   不起作用，因为 requestId 每次都会更改

2) 在最后一次 onComplete 发生后的 webRequest 之前清除

*   不起作用，因为每个图像、main_frame 等都以 onComplete 结尾，因此它会在每个图像或页面完成后清除

有什么建议么？这是我到目前为止所拥有的（选项2）......如果你只使用main_frame，它有点工作，但这并不理想。

```
beforeRedirect = function( details )  {
    if (debug && details.tabId > 0 && typeof(tabs[details.tabId]) != 'undefined') {
        //returns all info stored in tabs array for the current tab
        log('The following data was recorded and stored', tabs[details.tabId]); 
    }
    //adds current tab to tabs array and stores header info in there
    var tabId = details.tabId;
    var url = details.url;
    details.type = 'normal';

    //if tab is null... init
    if (typeof(tabs[details.tabId]) == 'undefined') {
        tabs[tabId] = {};
        tabs[tabId].isRedirect = false;
    }

    //set Header info
    tabs[tabId].lasactive = new Date().getTime();
    if (typeof(details.redirectUrl) != 'undefined') {
        tabs[tabId].isRedirect = true;
        details.type = 'redirect';
    }

    if (typeof(tabs[tabId].requestId) == 'undefined' || tabs[tabId].completed) {
        tabs[tabId].requestId = details.requestId;
        log('clearing tab['+tabId+'] headers');
        tabs[tabId].requestHeader = []; //init or reset
    }
    tabs[tabId].requestHeader.push(details);

    log('Saved tab '+tabId+'\'s '+details.type+' header information', details);

    return;
}

completed = function( details )  {
    if (debug && details.tabId > 0 && typeof(tabs[details.tabId]) != 'undefined') {
        //returns all info stored in tabs array for the current tab
        log('The following data was recorded and stored', tabs[details.tabId]); 
    }
    //adds current tab to tabs array and stores header info in there
    var tabId = details.tabId;
    var url = details.url;
    details.type = 'normal';

    //if tab is null... init
    if (typeof(tabs[details.tabId]) == 'undefined') {
        tabs[tabId] = {};
        tabs[tabId].isRedirect = false;
    }

    //set Header info
    tabs[tabId].lasactive = new Date().getTime();
    if (typeof(details.redirectUrl) != 'undefined') {
        tabs[tabId].isRedirect = true;
        details.type = 'redirect';
    }

    if (typeof(tabs[tabId].requestId) == 'undefined' || tabs[tabId].completed) {
        log('clearing tab['+tabId+'] headers');
        tabs[tabId].requestId = details.requestId;
        tabs[tabId].requestHeader = []; //init or reset
    }
    tabs[tabId].requestHeader.push(details);
    tabs[tabId].completed = true;
    log('Saved tab '+tabId+'\'s '+details.type+' header information', details);

    return;
} 
```

# android - 如何将此代码写入线程或 AsyncTask？

> ID：12846377
> 
> 赞同：1
> 
> 时间：2012-10-11T18:41:59.733
> 
> 标签：android, android-sdk-2.3

如何将此代码写入 Thread 或 AsyncTask ？

```
JSch jsch = new JSch();
    Session session = null;
        session = jsch.getSession("******", "*********",22);
        session.setConfig("StrictHostKeyChecking", "no");     
        session.setPassword("******");
        session.connect();
        Channel channel = session.openChannel("sftp");
        channel.connect();
        ChannelSftp sftpChannel = (ChannelSftp) channel;     
        sftpChannel.exit();
        session.disconnect(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T18:58:13.290

要将其写入线程，只需创建一个包含 Runnable 进程的新线程对象。

```
Thread connectionThread = new Thread(new Runnable() {
    public void run() {
        JSch jsch = new JSch();
        Session session = null;
        session = jsch.getSession("******", "*********",22);
        session.setConfig("StrictHostKeyChecking", "no");     
        session.setPassword("******");
        session.connect();
        Channel channel = session.openChannel("sftp");
        channel.connect();
        ChannelSftp sftpChannel = (ChannelSftp) channel;     
        sftpChannel.exit();
        session.disconnect();
    }
}); 
```

然后可以随时运行

```
connectionThread.start(); 
```

关于线程、ASyncTasks 和其他进程的更多信息可以在这里找到：http: [//developer.android.com/guide/components/processes-and-threads.html](http://developer.android.com/guide/components/processes-and-threads.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:18:34.970

从理论上讲，您只需将其放在 doInBackground 中即可进行 AsyncTask

# c# - 从目录中仅检索文件名

> ID：12846380
> 
> 赞同：2
> 
> 时间：2012-10-11T18:42:08.623
> 
> 标签：c#

使用目录类库我正在尝试检索文件夹中存在的所有文件名称，如下所示：

```
 private void button1_Click(object sender, EventArgs e)
     {
        string[] filePaths = Directory.GetFiles(@"d:\Images\", "*.png");
        foreach (string img in filePaths)
        {
          listBox1.Items.Add(img.ToString());
        }
    } 
```

如您所知，此方法返回文件的完整路径和名称，但我只需要获取文件的名称。是否可以在目录类中执行此操作？我必须为此使用 Path 类吗？如果是，我如何为没有文件名的变量分配路径？谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T18:43:09.803

你可以使用[`Path.GetFileName`](http://msdn.microsoft.com/fr-fr/library/system.io.path.getfilename%28v=vs.80%29.aspx)方法

```
var file = Path.GetFileName(img); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T18:43:49.247

试试这个：

```
using System.IO;

...

private void button1_Click(object sender, EventArgs e) 
{ 
    string[] filePaths = Directory.GetFiles(@"d:\Images\", "*.png"); 
    foreach (string img in filePaths) 
    { 
        listBox1.Items.Add(Path.GetFileName(img)); 
    } 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T18:44:51.663

您可以使用

`var files = Directory.EnumerateFiles(path,searchpattern);`

```
var files = Directory.EnumerateFiles(@"C:\Users\roberth\Programming_Projects\Common\UI\bin\Debug\",
                                                 "*.xml");
            var filename = new List<string>();
            Console.WriteLine("Parsing Files...");
            foreach (var file in files)
            {
                filename.Add(file);
                Console.WriteLine("Parsing file: " + file);
                .... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T18:44:54.643

使用`DirectoryInfo`而不是`Directory`. 它返回一个`FileInfo`您可以获得其`Name`属性的值。

```
 private void button1_Click(object sender, EventArgs e)
 {
    var filePaths = new DirectoryInfo.GetFiles(@"d:\Images\", "*.png").Select(x => x.Name);
    foreach (string img in filePaths)
    {
      listBox1.Items.Add(img.ToString());
    }
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T18:44:58.507

来自 MSDN

```
string fileName = @"C:\mydir\myfile.ext";
string path = @"C:\mydir\";
string result;

result = Path.GetFileName(fileName);
Console.WriteLine("GetFileName('{0}') returns '{1}'", 
    fileName, result);

result = Path.GetFileName(path);
Console.WriteLine("GetFileName('{0}') returns '{1}'", 
    path, result);

// This code produces output similar to the following: 
// 
// GetFileName('C:\mydir\myfile.ext') returns 'myfile.ext' 
// GetFileName('C:\mydir\') returns '' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-17T22:04:54.590

```
string aPath= @"course\train\yes\";
var fileNames=Directory.GetFiles(aPath).Select(name=>Path.GetFileName(name)).ToArray(); 
```

# javascript - 奇怪的 jQuery.load 行为

> ID：12846381
> 
> 赞同：1
> 
> 时间：2012-10-11T18:42:09.697
> 
> 标签：javascript, jquery, html, canvas, onload

我正在尝试使用 jQuery.load() 方法将外部 html 加载到 div 中。我从 document.ready() 调用这个方法。

**html.1**

```
 <script type='text/javascript' src='js/jquery-1.7.1.min.js'></script>
    <script type='text/javascript' src='js/script1.js'></script>
... 
```

**script1.js**

```
$(document).ready(function() {
        $('div.dropzone').load('drawings.html');
}); 
```

***该文件已加载，但直到我按 F5***（刷新），有时甚至是 ctrl F5 时才会显示，有时（3-5）。如果我不按 F5 ，则永远不会显示该页面，但是按某些 F5 始终会显示该页面。

加载到 div 中的 HTML 在其 window.onload 中进行了大量的画布绘制。

**图纸.html**

```
<script>
var init = function() {
   var container = document.getElementById('MyCanvas');
   var canvas = document.createElement('canvas');
   canvas.width = container.clientWidth;
   canvas.height = 1000;
   container.appendChild(canvas);
   return canvas;
}

window.onload = function()
{
   var canvas = init();
   var context = canvas.getContext('2d');
   context.beginPath();
   //... lots of drawings here
   context.closePath();
};

</script>
...
<div id='MyCanvas'>
</div> 
```

当我删除这个画布的东西并放置一些静态 HTML 时，它显示没有任何问题。

有人可以解释这里发生了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:00:05.613

尝试将 window.onload 更改为命名函数，并在回调中调用该函数进行加载。像这样的东西：

```
$(document).ready(function() {
   $('div.dropzone').load('drawings.html', function() {
      doMyNewNamedFunction();
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:00:10.173

试试这个

```
$.get('/drawings.html', function(data) {
  $('div.dropzone').html(data);
  console.log('Load was performed.');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T19:01:11.010

您看到的是一种竞争条件，有时窗口加载事件会在您的 div 完成加载内容之前触发，导致加载的 js 绑定到已经触发且不会再次触发的事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T19:02:43.977

window.onload 可能在 drawing.html 加载时已经触发。为什么不使用 jquery 和文档的 ready 事件来完成所有的 init() 初始化和绘图。jQuery 将始终调用您的函数，即使事件已经通过。

顺便说一句 - 我是真正的 javascript 的忠实拥护者......但在这种情况下，您已经在页面上拥有了一个可靠的框架......使用它；）

# ios - _setViewDelegate 无法识别的选择器发送到实例

> ID：12846398
> 
> 赞同：3
> 
> 时间：2012-10-11T18:42:49.030
> 
> 标签：ios, ios6

我得到了这个例外：

2012-10-11 14:27:05.039 SunriseAlarm[2297:907] *** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[PickerViewController _setViewDelegate:]：无法识别的选择器发送到实例 0x1e56fff0”

我在 appDelegate.m 文件中有这段代码

 ``PickerViewController *pvc = [[PickerViewController alloc] initWithNibName:@"PickerView" bundle:nil];

self.window.rootViewController = pvc;`  `我已经将笔尖的类设置为自定义类，它不是 UIViewController。请看下图。

![这是XCode窗口的图像](../Images/0c590454d19e790f707fc4aee509aefb.png)

请让我知道你认为我做错了什么。

谢谢你，

文卡特饶

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-11T19:06:12.190

您确实为 UIView 设置了 PickerViewController 类，它不正确，返回并为文件的所有者设置 PickerViewController``

# iphone - iOS - 是否可以在运行时为 uitabbar 选择视图？

> ID：12846403
> 
> 赞同：1
> 
> 时间：2012-10-11T18:43:04.383
> 
> 标签：iphone, ios, uitabbarcontroller

我在创建视图控制器后立即将其分配给我的选项卡。是否可以选择单击选项卡后将显示的视图？

例如 //user clicks tab 1 if(hasMessages) //show view A else //show view B

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:25:33.520

是的，有可能。您需要为您的选项卡控制器设置一个委托：

```
UITabBarController *tabBarController = (UITabBarController *)self.window.rootViewController;
tabBarController.delegate = self;  // or whatever suitable class you have 
```

该委托需要符合`UITabBarControllerDelegate`协议。

在您的委托中，实施`tabBarController:didSelectViewController:`并在其中找出您要呈现的视图。假设您的选项卡的根视图控制器是导航控制器，那么委托方法实现将是这样的：

```
- (void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController {
    /* logic goes here */

    [viewController pushViewController:someNewVC animated:YES];
} 
```

# c# - 是否有理由先转换为一个类型，然后再转换为它的可为空类型？

> ID：12846404
> 
> 赞同：5
> 
> 时间：2012-10-11T18:43:08.580
> 
> 标签：c#, casting, type-conversion

所以我才看到这行代码：

```
Item = (int?)(int)row["Item"]; 
```

有没有理由不能只是：

```
Item = (int?)row["Item"]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T18:49:15.757

见[装箱空类型（C#）](http://msdn.microsoft.com/en-us/library/ms228597%28v=vs.80%29.aspx)；可以将对象直接转换为可为空的 int（但如果对象实际上不是 int，则会导致 InvalidCastException）。这两个强制转换将做的一件事是直接强制转换不会`int?`执行对 null 的隐式检查。

当转换为 int 然后转换为可为 null 的 int 时，如果对象变量的值为 null，则将引发 ICE。当直接转换为可为空的 int 时，可以很好地处理 null，但是如果代码随后尝试检索 Value 属性而不检查是否确实有一个，则会引发 InvalidOperationException。

这看起来像是“快速失败”的半途而废的尝试，我不会推荐它作为“好代码”。只需直接转换为可为空，然后测试 HasValue 属性并从那里开始。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T19:02:18.177

我相信编写这行代码的正确方法是：

```
int val;
var success = int.TryParse(Convert.ToString(row["Item"]), out val);
Item = success ? (int?)val : (int?)null; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T18:46:43.873

```
Item = (int?)(int)row["Item"]; 
```

`row["Item"]`如果为空，此行将引发异常。这个坏主意，不要这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T18:53:29.100

你可以使用`as`关键字。

```
Item = row["Item"] as int?; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T19:12:19.720

您实际上可以转换`null`为可为空的类型

```
Item = sdr.IsDBNull(sdr.GetOrdinal("Item")) ? (int?)null : (int)row["Item"]; 
```

不太确定这可能会导致什么异常，但我已经毫无问题地使用它。

# vb.net - Visual Basic 循环永远不会结束

> ID：12846408
> 
> 赞同：2
> 
> 时间：2012-10-11T18:43:15.253
> 
> 标签：vb.net, visual-studio-2010, visual-studio, loops

我正在尝试在 Visual Basic 中打印钻石。我的代码的上半部分运行良好，但由于某种原因，我无法让下半部分以类似的方式工作。在下半部分，在o（用于制作菱形）之后打印出空格，并且o的数量减少使程序陷入无限循环？任何人都可以帮忙吗？

*下半部分可能完全错误，我还在努力*

这是代码：

```
Option Explicit On
Imports System

Module diamond
    Sub Main()
        ' The o variable will make the "o" part of the diamond, the space variable will be for places without an "o". 
        Dim row, spaces, o as Integer  
        'Dim index as integer

        'For top half
        ' Count the row number.
        row = 1
        spaces = 9
        o = 1
        Do until row = 20
            ' Count of row increases every loop until half of diamond is done.
            row +=1
            ' Write 1 less space every line.
            For row = 1 to spaces
                console.write(" ")
            Next row
            spaces -=1
            'Write 2 more "o"'s every loop.
            For row = 1 to o 
                Console.write("o")
            Next row    
            o +=2
            Console.Writeline
        Loop
        'Top of the diamond is done

        'This is the bottom half, which will not work.
        row = 20

        Do until row = 40
            row +=1
            For row = 20 to spaces
                Console.write(" ")
            Next row
            spaces +=1
            'Write 2 less "o"'s every loop.
            For row = 20 to o 
                Console.write("o")
            Next row    
            o -=2
            Console.Writeline
        Loop
    End Sub
End Module 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T18:49:04.473

问题是您将`row`其用作循环的行计数器以及`while`循环的循环索引`for`。上半场完全奏效是偶然的。下半场`row`永远不会达到 40，因为它不断被`for`循环劫持。

尝试`For i = 20 to spaces`，等等，而不是。

# c++ - NULL 函数指针，在头文件中声明的函数

> ID：12846411
> 
> 赞同：2
> 
> 时间：2012-10-11T18:43:25.313
> 
> 标签：c++, xcode, osx-lion

我在处理函数指针时遇到问题。我创建了一个具有函数指针作为成员的类 Control：

```
void (*mouseFunction) (Control*, Event*); 
```

该成员是受保护的，它有 setter 和 getter：

```
void (*getMouseFunction()) (Control*,Event*)
{
    return mouseFunction;
}
void setMouseFunction( void (*mouseFunction) (Control*, Event*) )
{
    this->mouseFunction=mouseFunction;
} 
```

问题是，即使设置了指针，它也始终为 NULL。
我在头文件中声明了一个函数：

```
void mouseFunction (Control* control, Event* event)
{
    std::cout << "Inside Text Field";
} 
```

如果我尝试分配它：

```
myControlInstance.setMouseFunction(mouseFunction); 
```

如果我使用 getter 来获取指针，它是 NULL；如果我尝试执行该函数，我会得到 EXC_BAD_ACCESS：

```
error: address doesn't contain a section that points to a section in a object file 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:01:43.183

以下 cod 正在工作，因此请确保您的方法是公开的，以便可以从对象以外的其他地方访问。

```
typedef int Event;

class Control
{

public:
    void (*mouseFunction) (Control*, Event*);

    void (*getMouseFunction()) (Control*,Event*)
    {
        return mouseFunction;
    }

    void setMouseFunction( void (*mouseFunction) (Control*, Event*) )
    {
        this->mouseFunction=mouseFunction;
    }
};

void mouseFunction (Control* control, Event* event)
{
    printf ("test");
}

int _tmain(int argc, _TCHAR* argv[])
{

    Control c;
    c.setMouseFunction(mouseFunction);
    Event e = 1;
    c.mouseFunction(&c,&e);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:07:41.073

您的问题可能与内联有关。由于该函数是在同一点声明*和*定义的，并且在标头内..编译器可能会将其视为隐式内联（请注意，由编译器决定是否实际内联它）。如果函数是内联的，那么编译器将不得不跳过一些额外的环节来存储指向该函数的指针（即，编译器必须构建函数的非内联版本）。如果编译器没有实现这一点，那么您将在存储和调用指向该函数的函数指针时遇到问题。

要消除此问题的可能根源，请尝试将函数的实现移出到 cpp 文件中，这是防止隐式内联的一种常用方法（并且通常是更好的样式）。

# javascript - 将跨度放在选定的文本上

> ID：12846412
> 
> 赞同：2
> 
> 时间：2012-10-11T18:43:41.570
> 
> 标签：javascript, dom, selection, textrange

如何在不破坏任何标签元素（javascript）的情况下使选定的文本被一个跨度包围

一个例子：

原文：

```
<p> a foo </p>
<p> another bar </p> 
```

选择：

吧台_`o
anoth`

我不想破坏 html 嵌套结构：

```
 <p> a fo<span>o </p>
<p> anoth</span>er bar </p> 
```

我需要这样的东西：

```
 <p> a fo<span>o </span></p>
 <p> <span>anoth</span>er bar </p> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:03:24.923

这是不可能的。想象一下：

```
<p> a foo </p>
<p> another bar </p> 
```

导致：

一个 foo
另一个酒吧

现在，如果用户只选择一部分，让我们说：

吧台_`o
anoth`

你打破了 html 嵌套结构：

```
 <p> a fo<span>o </p>
<p> anoth</span>er bar </p> 
```

仅使用一个标签是不可能实现的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:59:25.657

使用[这个](https://stackoverflow.com/questions/1482832/how-to-get-all-elements-that-are-highlighted)优秀的 treeWalker 实现，这里是一个[jsFiddle](http://jsfiddle.net/A46UL/11/)。请让我知道这是否适合您。旁注，使用 rangy 非常棒。

编辑：不，等等，已修复。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T19:29:16.013

您将需要遍历所选文本中的每个字符，按字符所在的 DOM 节点对字符进行分组。创建组后，您需要将每个组包装在`<span>`标签中。

您可以通过查看选择对象的`anchorNode`和`focusNode`属性，以及使用该方法测试其他合理节点（即，锚节点和焦点节点的公共父节点/祖先的所有子节点）来做到这一点`containsNode()`。

# java - 在android应用程序中测试谷歌地图视图的功能

> ID：12846418
> 
> 赞同：2
> 
> 时间：2012-10-11T18:44:13.480
> 
> 标签：java, android, eclipse, android-emulator, android-mapview

您好，感谢您的关注。我正在开发我的第一个 android 应用程序。在其中一个标签中，我想要一个功能版本的谷歌地图。如你所见，我正在路上。但是我不知道如何使用模拟器放大/输入导航地址等，以查看它是否正常运行。

![在此处输入图像描述](../Images/30b90b51dbf027b235d458501b232956.png)

这是布局xml：

```
 <?xml version="1.0" encoding="utf-8"?>
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
     android:orientation="vertical"
     android:layout_width="fill_parent"
     android:layout_height="fill_parent"
     >

    <com.google.android.maps.MapView
     android:id="@+id/myMapView"
     android:layout_width="fill_parent"
     android:layout_height="fill_parent"
     android:enabled="true"
     android:clickable="true"
     android:apiKey="myapikey"
   />

 </LinearLayout> 
```

和我的地图活动的java：

```
 import android.os.Bundle;

 import com.google.android.maps.MapActivity;

 public class MapsActivity extends MapActivity {
     public void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         setContentView(R.layout.maps_layout);
     }

     @Override
     protected boolean isRouteDisplayed() {
         // TODO Auto-generated method stub
         return false;
     }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:55:08.293

要打开缩放，您应该执行以下操作：

```
public class MapsActivity extends MapActivity {
     private MapView map;
     public void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         setContentView(R.layout.maps_layout);
         map = (MapView) findViewById(R.id.map);
         map.setBuiltInZoomControls(true);
     } 
```

我不确定导航，所需的覆盖

```
protected boolean isRouteDisplayed() {
        // TODO Auto-generated method stub
        return false;
    } 
```

是这个，因此您无法显示到搜索地点的路线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:31:55.900

```
@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    TextView myLocationText = (TextView) findViewById(R.id.myLocationText);
    setContentView(R.layout.map);        

    //make available zoom controls
    mapView.setBuiltInZoomControls(true);

    // zoom 1 is top world view
    controller.setZoom(17);
} 
```

您还可以使用最后一行对地图启动时的缩放进行硬编码

# maxscript - Maxscript在3DS MAX中去除退化人脸的功能

> ID：12846419
> 
> 赞同：1
> 
> 时间：2012-10-11T18:44:14.407
> 
> 标签：maxscript

如何在特定模型上调用 removeDegenerateFaces？我无法理解 Autodesk 文档上的内容，因为它基本上只有下面一行

```
meshop.removeDegenerateFaces <Mesh mesh> 
```

[http://docs.autodesk.com/3DSMAX/15/ENU/MAXScript-Help/index.html?url=files/GUID-EF78FA1A-A382-4BED-BA10-7C856A7551A5.htm,topicNumber=d30e365344](http://docs.autodesk.com/3DSMAX/15/ENU/MAXScript-Help/index.html?url=files/GUID-EF78FA1A-A382-4BED-BA10-7C856A7551A5.htm,topicNumber=d30e365344)

假设我有一个名为 body 的对象，我怎么能在它上面调用那个函数呢？我试过 `body.removeDegenerateFaces <Mesh mesh>`了，但是有：错误`'<factor> expected'`..

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T08:03:13.953

要直接回答您的问题，假设名为 body 的对象是可编辑网格，您可以通过调用

```
meshop.removeDegenerateFaces $body 
```

`true`如果有一些它会返回，它会删除它们，`false`否则。不过，我怀疑它可能不是你真正想要的——提供详细的描述肯定会有所帮助。

# wix - 从 PackageID 获取显示名称

> ID：12846421
> 
> 赞同：9
> 
> 时间：2012-10-11T18:44:30.293
> 
> 标签：wix, wix3.6, bootstrapper, burn

查看 Wix Standard Bootstrapper 应用程序的源代码，似乎每个包都有一个**DisplayName**属性：

```
pPackage->sczDisplayName 
```

但是，WiX 设置项目中使用的 BootstrapperCore dll 没有此属性。有没有办法从托管代码中的包中提取此属性？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-07-09T12:31:19.413

我将代码移植`Bal`到 C# 中，试图让它像 C++ 代码一样工作：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Reflection;
using System.Xml;
using System.Xml.XPath;

public class BootstrapperApplicationData
{
    public const string defaultFileName = "BootstrapperApplicationData.xml";
    public const string xmlNamespace = 
        "http://schemas.microsoft.com/wix/2010/BootstrapperApplicationData";

    private static DirectoryInfo defaultFolder;
    public static DirectoryInfo DefaultFolder
    {
        get
        {
            if (defaultFolder == null)
            {
                defaultFolder = (new FileInfo(Assembly.GetExecutingAssembly().Location)).Directory;
            }
            return defaultFolder;
        }
    }

    private static FileInfo defaultFile;
    public static FileInfo DefaultFile
    {
        get
        {
            if (defaultFile == null)
            {
                defaultFile = new FileInfo(Path.Combine(DefaultFolder.FullName, defaultFileName));
            }
            return defaultFile;
        }
    }

    public FileInfo DataFile { get; protected set; }
    public Bundle Data { get; protected set; }

    public BootstrapperApplicationData() : this(DefaultFile) { }

    public BootstrapperApplicationData(FileInfo fiBootstrapperApplicationData)
    {
        DataFile = fiBootstrapperApplicationData;
        using (FileStream fs = DataFile.OpenRead())
        {
            Data = ParseBundleFromStream(fs);
        }
    }

    public static Bundle ParseBundleFromStream(Stream stream)
    {
        XPathDocument manifest = new XPathDocument(stream);
        XPathNavigator root = manifest.CreateNavigator();
        return ParseBundleFromXml(root);
    }

    public static Bundle ParseBundleFromXml(XPathNavigator root)
    {
        Bundle bundle = new Bundle();

        XmlNamespaceManager namespaceManager = new XmlNamespaceManager(root.NameTable);
        namespaceManager.AddNamespace("p", xmlNamespace);
        XPathNavigator bundleNode = root.SelectSingleNode("/p:BootstrapperApplicationData/p:WixBundleProperties", namespaceManager);

        if (bundleNode == null)
        {
            throw new Exception("Failed to select bundle information");
        }

        bool? perMachine = GetYesNoAttribute(bundleNode, "PerMachine");
        if (perMachine.HasValue)
        {
            bundle.PerMachine = perMachine.Value;
        }

        string name = GetAttribute(bundleNode, "DisplayName");
        if (name != null)
        {
            bundle.Name = name;
        }

        string logVariable = GetAttribute(bundleNode, "LogPathVariable");
        if (logVariable != null)
        {
            bundle.LogVariable = logVariable;
        }
        else
        {
            //wix would actually debug "Failed to select bundle information" and return with E_NOTFOUND, but I think it's a (harmless) bug
        }

        Package[] packages = ParsePackagesFromXml(root);
        bundle.Packages = packages;

        return bundle;
    }

    public static Package[] ParsePackagesFromXml(XPathNavigator root)
    {
        List<Package> packages = new List<Package>();

        XmlNamespaceManager namespaceManager = new XmlNamespaceManager(root.NameTable);
        namespaceManager.AddNamespace("p", xmlNamespace);
        XPathNodeIterator nodes = root.Select("/p:BootstrapperApplicationData/p:WixPackageProperties", namespaceManager);

        foreach (XPathNavigator node in nodes)
        {
            Package package = new Package();

            string id = GetAttribute(node, "Package");
            if (id == null)
            {
                throw new Exception("Failed to get package identifier for package");
            }
            package.Id = id;

            string displayName = GetAttribute(node, "DisplayName");
            if (displayName != null)
            {
                package.DisplayName = displayName;
            }

            string description = GetAttribute(node, "Description");
            if (description != null)
            {
                package.Description = description;
            }

            PackageType? packageType = GetPackageTypeAttribute(node, "PackageType");
            if (!packageType.HasValue)
            {
                throw new Exception("Failed to get package type for package");
            }
            package.Type = packageType.Value;

            bool? permanent = GetYesNoAttribute(node, "Permanent");
            if (!permanent.HasValue)
            {
                throw new Exception("Failed to get permanent settings for package");
            }
            package.Permanent = permanent.Value;

            bool? vital = GetYesNoAttribute(node, "Vital");
            if (!vital.HasValue)
            {
                throw new Exception("Failed to get vital setting for package");
            }
            package.Vital = vital.Value;

            bool? displayInternalUI = GetYesNoAttribute(node, "DisplayInternalUI");
            if (!displayInternalUI.HasValue)
            {
                throw new Exception("Failed to get DisplayInternalUI setting for package");
            }
            package.DisplayInternalUI = displayInternalUI.Value;

            string productCode = GetAttribute(node, "ProductCode");
            if (productCode != null)
            {
                package.ProductCode = productCode;
            }

            string upgradeCode = GetAttribute(node, "UpgradeCode");
            if (upgradeCode != null)
            {
                package.UpgradeCode = upgradeCode;
            }

            string version = GetAttribute(node, "Version");
            if (version != null)
            {
                package.Version = version;
            }

            packages.Add(package);
        }

        return packages.ToArray();
    }

    public static string GetAttribute(XPathNavigator node, string attributeName)
    {
        XPathNavigator attribute = node.SelectSingleNode("@" + attributeName);

        if (attribute == null)
        {
            return null;
        }

        return attribute.Value;
    }

    public static bool? GetYesNoAttribute(XPathNavigator node, string attributeName)
    {
        string attributeValue = GetAttribute(node, attributeName);

        if (attributeValue == null)
        {
            return null;
        }

        return attributeValue.Equals("yes", StringComparison.InvariantCulture);
    }

    public static PackageType? GetPackageTypeAttribute(XPathNavigator node, string attributeName)
    {
        string attributeValue = GetAttribute(node, attributeName);

        if (attributeValue == null)
        {
            return null;
        }

        if (attributeValue.Equals("Exe", StringComparison.InvariantCulture))
        {
            return PackageType.EXE;
        }
        else if (attributeValue.Equals("Msi", StringComparison.InvariantCulture))
        {
            return PackageType.MSI;
        }
        else if (attributeValue.Equals("Msp", StringComparison.InvariantCulture))
        {
            return PackageType.MSP;
        }
        else if (attributeValue.Equals("Msu", StringComparison.InvariantCulture))
        {
            return PackageType.MSU;
        }
        else
        {
            return 0;
        }
    }

    public enum PackageType
    {
        EXE,
        MSI,
        MSP,
        MSU,
    }

    public class Package
    {
        public string Id;
        public string DisplayName;
        public string Description;
        public PackageType Type;
        public bool Permanent;
        public bool Vital;
        public bool DisplayInternalUI;

        //not available until WiX 3.9.421.0
        public string ProductCode;
        public string UpgradeCode;
        public string Version;
    }

    public class Bundle
    {
        public bool PerMachine;
        public string Name;
        public string LogVariable;
        public Package[] Packages;
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-15T07:04:24.033

`BootstrapperApplicationData.xml`在构建过程中生成的文件放在您的 BA .dll 旁边。您可以加载该 XML 文件以获取有关捆绑包和捆绑包中的包的大量信息。

要加载本`BootstrapperApplicationData.xml`机代码，请使用WiX 工具集提供的`BalManifestLoad()`方法。`balutil.lib`您可以在 中查看代码`src\ext\BalExtension\balutil\balutil.cpp`。然后您还可以使用`BalInfoParseFromXml()`in`balutil.lib`将 XML 文件解析为一堆方便的结构。您可以在 中查看代码`src\ext\BalExtension\balutil\balinfo.cpp`。

# design-patterns - 持久性无知和依赖——对术语感到困惑

> ID：12846426
> 
> 赞同：0
> 
> 时间：2012-10-11T18:44:43.400
> 
> 标签：design-patterns, domain-driven-design, repository-pattern

可能是一个愚蠢的问题：

*域实体*应该完全不知道*Persistence 层*，因此应该只通过*Repositories*与其通信，因此*域实体*应该是*Persistence Ignorant*。

*将域层*与*持久层*完全解耦的常用方法是使用*存储库*，其中*存储库接口*位于*域组件*中，而存储库*实现*存在于*持久层组件* **PLA**中。

但我对术语有点困惑。也就是说，我知道将*Repository 接口*放在**PLA**中是一个坏主意，至少有两个原因，第一个原因是这会强制*Domain 程序集*持有对**PLA**的引用，而且现在*Repository 接口*是根据较低级别的组件定义的（即现在*持久层*决定了*存储库接口*的定义）。但是如果出于某种原因我们确实将*Repository 接口*放入**PLA**中，那么：

a) 我们还能说*域层*（即它的实体）是*持久无知*的吗？我假设是的，因为*域实体*仍然完全不知道 *持久层*？！

b) 在这种情况下，正确的表达方式是“*域组件现在依赖于**PLA*** ”或者“*域层现在依赖于持久层*”或者......？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T05:57:32.523

> a) 我们还能争辩说领域层（即它的实体）是持久无知的吗？我假设是的，因为域实体仍然完全不知道持久层？！

域实体仍然不知道持久层（只要它们使用接口）。然而，程序集依赖于持久层。

> b) 在这种情况下，正确的表达方式是“域组件现在依赖于 PLA”或者“域层现在依赖于持久层”或者......？

真的没关系。存储库接口的目的是抽象出数据层并使域模型 100% 持久化无知。

新 DDD 用户犯的典型错误是在数据库之后对域模型进行建模（即先创建数据库，然后尝试在其后拟合域模型），而不是反之亦然。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T11:55:37.307

a) 领域层服务（有时甚至是实体）需要从存储库获取数据的情况并不少见。所以实际上，将存储库接口放在持久层中*会*更频繁地破坏 PI。

b) 我想你可以两者都说。

# c# - 对普通类进行单元测试覆盖是一种好习惯吗

> ID：12846428
> 
> 赞同：20
> 
> 时间：2012-10-11T18:44:47.770
> 
> 标签：c#, .net, unit-testing, tdd, bdd

这是一个完全没有行为的类的示例。所以问题是我应该为它做单元测试覆盖，因为我认为它是不必要的，因为它确实有任何行为。

```
public class Employee
{
    public int Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public Address Address { get; set; }
} 
```

***我的代码覆盖率结果抱怨我没有对该类进行任何覆盖***

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-11T18:46:50.673

我从不为这些编写测试。 *没有要测试的行为。*

如果有任何重要的行为代码（也许是验证代码），那么我会为它编写一个测试。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-11T18:51:20.827

[我发现Martin Fowler](http://martinfowler.com/bliki/TestCoverage.html)的这篇有趣的文章：

> 测试覆盖率是查找代码库中未测试部分的有用工具。测试覆盖率作为测试有多好的数字声明几乎没有用。

===

[还有来自对象导师](http://blog.objectmentor.com/articles/2007/05/16/100-code-coverage)的这个有趣的引用：

> 这可能不是强制性的，如果您的目标是 100% 的覆盖率，您将专注于该目标，而不是专注于为代码的行为编写最佳测试。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-10-11T18:47:55.413

我可以接受，也可以离开。但是，虽然现在几乎没有明显的好处，但如果后来有程序员出现，将它们转换为传统的、成员字段支持的属性，并在微不足道的情况下搞砸了实现，你就会被覆盖。

但我个人实际上不会打扰，因为我的时间有限，而且我还有更重要的测试要编写，这将为我带来更大的收益。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-10-11T19:33:06.587

Kent Beck 在他的“示例测试驱动开发”中列出了您**应该**测试的内容：

*   条件句
*   循环
*   操作
*   多态性

你的班级没有这些。

问自己一个问题通常会有所帮助，*“如果我用单元测试覆盖这段代码，我会得到什么？”* . 如果*“指向某些指标”*是您能想出的唯一答案，那么为此类代码编写测试可能不值得。您将花费**时间**，产生额外的**代码**，却一无所获（代码覆盖“点”没有什么价值——至少在这种情况下）。

另外，看看这两个问题（他们都解决了类似的问题，并且答案主要解决了一个重要问题 - *[在大多数情况下]*总是有人为你的工作付钱 - 有人可能不会很高兴认识你花时间*提高收视率*，因为它本质上就是这样）：

*   [你的测试有多深？](https://stackoverflow.com/q/153234/343266)
*   [何时进行单元测试？](https://stackoverflow.com/q/12714980/343266)

定论？我同意其他人说你**不应该测试**这样的课程。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-10-11T18:47:34.493

这不是一个坏主意...例如，您开发了一个用于将来存储此数据的后端（例如，存储到数据库中）。您可以`get; set;`用其他自定义功能替换通用调用。进行单元测试可确保您的代码始终得到执行，并且在转换过程中不会引入任何错误。

即使是一个非常简单的测试来检查您是否可以创建对象、设置字段并读回相同的值，这表明您正在以预期的行为执行代码。即使这一切对您来说都是显而易见的，该代码的未来开发人员将有示例可以借鉴并确保任何更改都符合您的原始设计目标。

我也是这样看待的：开发具有一些非常可能的长期优势的测试几乎没有害处。现在只需要几分钟而不是跟踪引入的问题。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-10-11T18:58:38.973

替代方案：您没有覆盖这个特定类的事实暗示有一些代码使用这个类并且该代码也没有测试覆盖率。我会先解决这个问题，然后看看是否需要更多测试。

至于测试这种纯数据对象：如果该对象是库/单元外部合同的一部分，我肯定会添加显式测试。您承诺此数据将由您的代码返回/使用。如果没有测试验证您可以更改代码的内部结构并更改此类，那么您将违反承诺，没有什么可以阻止您。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-10-11T18:48:08.190

如果您只是将此类类保留为数据传输对象，则可能会争辩说您不需要对它们进行单元测试。但是，一旦开始添加行为，就应该编写相应的测试。

查看可能作为构建过程的一部分返回的代码覆盖率也可能有助于发现任何缺失的测试。

作为一个简短的回答，我会说“是”，对于普通课程，您可以在没有得到他们的报道的情况下逃脱。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-09-08T21:06:59.197

单元测试的重点是保持你的代码“固定”，这样如果你改变实现，你就会知道你没有破坏任何东西，或者如果你确实破坏了某些东西，你会立即确切地知道你破坏了什么。

这样做的一个附带好处是知道您*当前编写*的代码可以执行您希望它执行的操作，但这不是（或不一定）单元测试的主要目标。单元测试使您可以放心地更改代码。

如果上述类没有经过单元测试，则可以破坏该类而不会导致任何测试失败。例如：

```
public class Employee
{
    public int Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get { return "Smith"; } set { FirstName = value; } }
    public Address Address { get; set; }
} 
```

通过单元测试，您可以知道在您的整个代码库中没有发生过类似的事情。（这个具体的例子有可能吗？也许没有。但这样*的*事情是很有可能的，而且基本上是不可避免的。）

只需四个简单的单元测试，您就可以“修复”此代码，因为您知道如果没有测试失败，它不可能改变它的行为*：

```
[TestMethod]
public void TestId() {
   var emp = new Employee { Id = 3 };
   Assert.AreEqual(3, emp.Id);
}

[TestMethod]
public void TestFirstName() {
   var emp = new Employee { FirstName = "asdf" };
   Assert.AreEqual("asdf", emp.FirstName);
}

[TestMethod]
public void TestLastName() {
   var emp = new Employee { LastName = "asdf" };
   Assert.AreEqual("asdf", emp.LastName);
}

[TestMethod]
public void TestAddress() {
   var address = new Address();
   var emp = new Employee { Address = address };
   Assert.AreEqual(address, emp.Address);
} 
```

[（*也许除了模仿您用来测试的值的损坏实现的侧面情况）]

我不会在这里实现它，但您也可以使用反射来简化编写这些类型的测试。例如，您可以相对容易地构建一些允许您执行以下操作的东西：

```
[TestClass]
public sealed TestEmployee {
   [TestMethod]
   public void TestSimpleProperties() {
      Assert.IsTrue(
         SimplePropertyTester.Create(
            new SimplePropertyTestCollection<Employee> {
               { emp => emp.Id, 3 },
               { emp => emp.FirstName, "asdf" },
               { emp => emp.LastName, "1234" },
               { emp => emp.Address, new Address() }
            }
         ).Test()
      );
   }
} 
```

您失去了将每个属性都放在自己的测试中的好处，但是您获得了非常容易修改测试集的能力。

您也可以为每个单元测试构建一个单独的测试器，然后将测试分开，但这与手动编写它们并没有太大区别，并且您最终编写了基本上完全相同的代码行一遍又一遍。

您可以做的一件事是将`Console.WriteLine`语句放入`Test()`方法中，然后您应该能够查看一些文本输出以更快地查明问题。

编辑：实际上我现在已经让这些看起来像下面这样：

```
[TestClass]
public sealed TestEmployee {
   [TestMethod]
   public void TestSimpleProperties() {
      var factory = SimplePropertyTestFactory.Create<Employee>();
      new SimplePropertyTestCollection<Employee> {
         factory.IntTest(emp => emp.ID),
         factory.StringTest(emp => emp.FirstName),
         factory.StringTest(emp => emp.LastName),
         factory.ReferenceTest(emp => emp.Address)
      }.Test();
   }
} 
```

# javascript - 有没有更好的方法在每个模块中要求 Backbone、jQuery、下划线等？

> ID：12846436
> 
> 赞同：0
> 
> 时间：2012-10-11T18:45:29.750
> 
> 标签：javascript, node.js, requirejs

在 require.js 中定义模块时，我必须始终将公共库列为依赖项：

```
define(['jquery', 'underscore', 'backbone'], function(){
   //do stuff here
}); 
```

有没有一种方法我不必总是在每个定义中都需要这些公共模块而只需要它们一次，或者这会破坏独立模块的整个概念吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T19:10:15.583

几乎是后者：使用模块系统的主要目的之一是避免需要单独的代码片段通过全局变量相互接口。这几乎需要在每个模块中显式调用依赖项并给出本地范围的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:01:11.493

看看[https://github.com/requirejs/example-multipage](https://github.com/requirejs/example-multipage)应用程序。根据自述文件，它混合使用特定于页面的模块和通用模块。

# ajax - jquery ajax 从另一个域获取 XML

> ID：12846437
> 
> 赞同：0
> 
> 时间：2012-10-11T18:45:30.570
> 
> 标签：ajax, jquery, get, vimeo

嘿，这里是我的代码，我必须从 Vimeo 网站读取 XML 文件：

```
$(document).ready(function(){
  $.ajax({
    type: "GET",
    url: "http://vimeo.com/api/v2/video/51229736.xml",
    dataType: "xml",
    success: function(xml) {
        $(xml).find('video').each(function(){
            var thumbURL = $(this).attr('thumbnail_small');
            alert(thumbURL);
            $('#vidThumb').html('<img src="' + thumbURL + '">');
        });
    },
    error: function(err) {alert('err');}
  });
}); 
```

XML 如下所示：

```
<videos>
  <script/>
    <video>
       <id>51229736</id>
       <title>CHATT HISTORY CENTER FILMS CAVALIER</title>
       <description/>
       <url>http://vimeo.com/51229736</url>
       <upload_date>2012-10-11 13:08:51</upload_date>
<thumbnail_small>http://b.vimeocdn.com/ts/353/072/353072229_100.jpg</thumbnail_small>
<thumbnail_medium>http://b.vimeocdn.com/ts/353/072/353072229_200.jpg</thumbnail_medium>
......
</video>
</videos> 
```

问题是它出错了。我确定这是因为尝试读取它的域名不同，所以我该如何解决它才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:54:58.133

我认为答案是将回调设置为“？” 至少它通常适合我。这至少适用于 JSON。如果是 JSON，我会这样做：

```
var query = 'http://vimeo.com/api/v2/video/51229736.xml&callback=?';
$.ajax({
    url: query,
    type: 'GET',
    dataType: 'json',
    success: function(s) { 
       console.log('success' + s)
    },
    error: function(e) { console.log('something went wrong!', e)}
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T18:56:55.880

您不能通过使用 XML 跨不同域的 jQuery 的 ajax 来做到这一点`callback=?` ，如果可以从该 url 获取 json 响应，您可以像在其他答案中一样使用来获取 jsonp 响应

从服务器端获取 XML 响应应该没有问题，您应该尝试该路由

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T15:33:55.307

通过执行以下操作实现了它：

```
 var vimeoVideoID = '51229736';
    $.getJSON('http://www.vimeo.com/api/v2/video/' + vimeoVideoID + '.json?callback=?', {format: "json"}, function(json) {
    $("#vidThumb").attr('src', json[0].thumbnail_small);
 }); 
```

# php - 单击链接时获取php查询的where子句中的链接名称？

> ID：12846438
> 
> 赞同：1
> 
> 时间：2012-10-11T18:45:39.487
> 
> 标签：php

我制作了一个网站，用户可以在其中从下拉菜单中选择一个值并从数据库中获取一些信息。我使用 ajax 将请求发送到数据库（因此当我发送请求时页面不会刷新）。这是jquery函数的一部分：

```
 $.ajax({
      type:'POST',
      url:'activities_code.php',
      data: {datastr:datastr, datastr1:datastr1},
      success:function(response){

        $("#msg").html(response);                           
            }});}); // there are other functions before.. 
```

结果显示在网页的主容器上。它们由标题和一些文本组成。我以这种方式呼应标题，因此它是一个链接。我还给每个元素一个 id 和一个类，以便我以后可以调用它。下面是对应的代码：

```
 echo "<table id=\"container\">";
$num_results = 0;
while ($row=mysqli_fetch_array($result, MYSQLI_ASSOC)) {
     // Here the columns of title and information are printed
     echo "<tr><td>";
     echo "<a href='test.php' name=\"fd\" id=\"t".$t."\" target=\"_new\"  class='pickanchor' onClick=\"test()\">".$row['title']."</a>";
     echo "<br>";
     echo $row['PK'];
     echo "</td></tr>";

     echo "<tr><td>";
     echo $row['Information'];
     echo "</td></tr>"; 
 } 
```

我现在要做的是：当我单击标题（这是一个链接）时，会打开一个新页面，其中一个 php 脚本运行查询并显示更多信息：这是我所拥有的：

```
 <?php
     include('connect.php');

    $query = "SELECT title,Information from activities where title='?????'";

$result = mysqli_query($dbcon, $query) or die('no available data');
echo "<table>";
$num_results = 0;
while ($row=mysqli_fetch_array($result, MYSQLI_ASSOC)) {
     // Here the columns of title and information are printed
     echo "<tr><td>";
     echo "<a href='test.php' id=\"t\".$t target=\"_new\">".$row['title']."    </a>";
     echo "</td></tr>";

     echo "<tr><td>";

     echo $row['Information'];

     echo "</td></tr>";
    // Here I sum up the number of the results
     $num_results=$num_results+1;        
 }
     ?> 
```

我正在尝试找到一种方法将我的查询放入 where 子句中，我选择的标题名称：

```
 $query = "SELECT title,Information from activities where title='?????'"; 
```

任何帮助将非常感激。让我知道是否一切都清楚，或者我没有清楚地解释某些观点。谢谢。D.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:18:04.240

您可以使用全局变量和 URL 参数获取**标题。**`$_GET`尝试更改此行：

```
echo "<a href='test.php' name=\"fd\" id=\"t".$t."\" target=\"_new\"  class='pickanchor' onClick=\"test()\">".$row['title']."</a>"; 
```

到

```
echo "<a href='test.php?title={$row['title']}' name=\"fd\" id=\"t".$t."\" target=\"_new\"  class='pickanchor' onClick=\"test()\">".$row['title']."</a>"; 
```

那么您可以使用以下代码获取标题：

```
$title = $_GET['title']; 
```

确保您首先对值进行消毒。我希望这能帮到您。

**关联：**

[PHP $_GET](http://php.net/manual/en/reserved.variables.get.php)

# django - 如何查找所有 Django 默认表单验证消息？

> ID：12846439
> 
> 赞同：0
> 
> 时间：2012-10-11T18:45:53.810
> 
> 标签：django, django-forms

我在哪里可以找到 Django 输出的所有默认验证错误消息（例如字段所需的错误消息）？

我想将这些翻译成另一种语言，我知道如何替换它们，但不知道如何找到所有这些。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:51:48.213

对于`form`错误消息，您可以浏览`django.forms.fields`文件并查找`default_error_messages`.

[https://github.com/django/django/blob/master/django/forms/fields.py](https://github.com/django/django/blob/master/django/forms/fields.py)

# c# - 从任何地方开始对小部件进行排序和迭代

> ID：12846447
> 
> 赞同：0
> 
> 时间：2012-10-11T18:46:39.603
> 
> 标签：c#

```
List<Widget> list = List<Widget>();
Widget widgetA = new Widget();
Widget widgetB = new Widget();
Widget widgetC = new Widget();
Widget widgetD = new Widget();
Widget widgetE = new Widget();
Widget widgetF = new Widget();
list.AddRange(new[] { widgetA, widgetB, widgetC, widgetD, widgetE, widgetF }); 
```

我需要做什么才能从中间的某个地方开始排序？

例如，

```
list.AddRange(new[] { widgetD, widgetE, widgetF, widgetA, widgetB, widgetC }); 
```

或者，换句话说，在中间某处开始索引，然后按顺序包装剩余的对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T18:56:27.293

您可以使用`Skip`,`Take`和的组合`Union`。

```
List<Widget> widgets = ...

// now to split and wrap
int startIndex = 3;
var newList = widgets.Skip(startIndex)
                     .Union(widgets.Take(startIndex)
                     .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:08:04.320

首先对它们进行排序，然后取出前几个元素并将它们放在最后。

```
var mid = 2; // starting point
var arr = new[] { widgetA, widgetB, widgetC, widgetD, widgetE, widgetF };
arr.Sort(); //you can use your own comparator for sorting
list.AddRange(arr.Skip(mid).Concat(arr.Take(mid))); 
```

# c# - LINQ 执行查询

> ID：12846448
> 
> 赞同：3
> 
> 时间：2012-10-11T18:46:41.217
> 
> 标签：c#, linq, linq-to-sql, entity

我想使用 ExecuteQuery() 来获取 Entities.UserLevel 类型的 IEnumerable。以下代码运行良好。

```
using (CDataContext context = data.GetDataContext())
{
   string q = "SELECT *FROM UserLevel";
   IEnumerable<Entities.UserLevel> res = context.ExecuteQuery<Entities.UserLevel>(q);
}

public class UserLevel
{
   public int userID { get; set; }
   public int levID { get; set; }
} 
```

但问题是我必须在 UserLevel 类中使用与数据库中相同的属性名称，否则我不会得到值。我想知道有什么方法可以获取值而不考虑类/属性名称？例如，我想使用以下 UserLevel 类而不是上面的类：

```
public class UserLevel
{
   public int UserIdentity { get; set; }
   public int LevelIdentity { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T18:51:23.477

当然只是写。

```
var q = "SELECT userID as UserIdentity, levID as LevelIdentity FROM UserLevel";
var res = context.ExecuteQuery<UserLevelDTO>(q); 
```

但是为什么不使用 Linq 呢？你可以写：

```
var res = from u in context.UserLevel
          select new UserLevelDTO()
          {
             UserIdentity = u.userID,
             LevelIdentity = u.levID 
          }; 
```

您需要创建自己的 DTO 类。

```
public class UserLevelDTO
{
   public int UserIdentity { get; set; }
   public int LevelIdentity { get; set; }
} 
```

# c# - 在这个例子中如何使用列表

> ID：12846455
> 
> 赞同：2
> 
> 时间：2012-10-11T18:47:10.230
> 
> 标签：c#, arrays, list

可以说我有一个这样的数组（我知道这在 c# 上是不可能的）：

```
string[,] arr = new string[,]
{
    {"expensive", "costly", "pricy", 0},
    {"black", "dark", 0}
}; 
```

那么如何在列表中添加这些项目以及如何在**“昂贵”**和**0**之间添加新项目？我在网上找不到任何例子。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T18:57:05.163

数组是不可变的，因此您无法真正添加或删除其中的项目。例如，您唯一可以做的就是将项目复制到另一个数组实例，减去您不想要的那些，或者做同样的事情但使用更高的维度并添加您需要添加的项目。

我建议在`List<T>`这里使用 a ，它`T`可以是一个简单的类型，可以反映您添加到数组中的内容。例如：

```
class Thing {
    public string Prop1 {get; set; }
    public string Prop2 {get; set; }
    public string Prop3 {get; set; }
    public int Prop4 {get; set; }
}

List<Thing> list = new List<Thing>();

list.Add(new Thing() { Prop1 = "expensive", Prop2 = "costly", Prop3 = "pricy", Prop4 = 0}; 
```

然后你可以插入项目：

```
list.Insert(1, new Thing() { Prop1 = "black", Prop2 = "dark", Prop4 = 0}); 
```

不确定这是否适合您，这取决于您的“锯齿状”数据是否可以适合`Thing`. 显然，这里的“Prop1”等将是您在数组中拥有的数据的实际属性名称。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-11T18:50:04.613

如果要添加（插入）项目，则不要使用数组。使用`List<>`.

您的样品可能会被

```
var data = new List<string>[2] { new List<string>(), new List<string> () }; 
```

然后，您可以使用如下语句

```
data[0].Add("expensive");
string s = data[1][1];     // "dark" 
```

当然不可能有`0`字符串数组或列表。您可以使用`null`，但请先尝试避免使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T18:53:31.200

那么你想要什么列表**呢**？现在你有字符串和整数，`object`你的通用基类也是

你可以做一个锯齿状数组（数组的数组）：

```
object[][] arr = new []
{
    new object[] {"expensive", "costly", "pricy", 0},
    new object[] {"black", "dark", 0}
}; 
```

或列表列表：

```
List<List<object>> arr = new List<List<object>> 
{
    new List<object> {"expensive", "costly", "pricy", 0},
    new List<object> {"black", "dark", 0}
}; 
```

但这两个似乎都是糟糕的设计。如果您提供有关您要完成的工作的更多信息，您可能会得到一些更好的建议。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T18:51:17.033

您可以将其设为 a `Dictionary<string,string>`，但密钥必须保持唯一。然后你就可以像这样循环

```
Dictionary<string,string> list = new Dictionary<string,string>();
foreach(KeyValuePair kvp in list) 
{
    //Do something here
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T19:16:12.510

你的任务有点奇怪，我不明白它在哪里有用。但是在您的上下文中，您可以不用`List`等等。您应该按索引器遍历元素（在您的示例项目中，字符串 [,] 只能通过两个索引获取）。

所以这里的解决方案有效，我这样做只是为了有趣

```
var arr = new[,]
                          {
                              {"expensive", "costly", "pricy", "0"},
                              {"black", "dark", "0", "0"}
                          };
            int line = 0;
            int positionInLine = 3;
            string newValue = "NewItem";

            for(var i = 0; i<=line;i++)
            {
                for (int j = 0; j <=positionInLine; j++)
                {
                    if (i == line && positionInLine == j)
                    {
                        var tmp1 = arr[line, positionInLine];
                        arr[line, positionInLine] = newValue;

                        try
                        {
                            // Move other elements
                            for (int rep = j+1; rep < int.MaxValue; rep++)
                            {
                                var tmp2 = arr[line, rep];

                                arr[line, rep] = tmp1;

                                tmp1 = tmp2;

                            }
                        }
                        catch (Exception)
                        {

                            break;
                        }
                    }
                }
            } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-25T07:17:15.403

```
class Program
{
    static void Main(string[] args)
    {
        List<Array> _list = new List<Array>();

        _list.Add(new int[2] { 100, 200 });
        _list.Add(new string[2] { "John", "Ankush" });

        foreach (Array _array in _list)
        {
            if (_array.GetType() == typeof(Int32[]))
            {
                foreach (int i in _array)
                    Console.WriteLine(i);
            }
            else if (_array.GetType() == typeof(string[]))
            {
                foreach (string s in _array)
                    Console.WriteLine(s);
            }
        }
        Console.ReadKey();
    }
} 
```

# php - LinkedIn Api - 未捕获的异常“OAuthException”

> ID：12846458
> 
> 赞同：3
> 
> 时间：2012-10-11T18:47:15.760
> 
> 标签：php, api, oauth, linkedin, fatal-error

我目前正在尝试在我的网站上安装 LinkedIn 的登录按钮。正如开发人员部分所示，我正在尝试逐步进行。在我编写了获取请求令牌的代码并使用 print_r 检查它之后。

```
define("my consumer key");
define("my consumer secret");

$oauth = new OAuth(my consumer key, my consumer secret);

//The first item of business is getting a request token
$request_token_response = $oauth->getRequestToken('https://api.linkedin.com/uas/oauth/requestToken');

if($request_token_response === FALSE) {
        throw new Exception("Failed fetching request token, response was:"
        . $oauth->getLastResponse());
} else {
        $request_token = $request_token_response;
}

print "Request Token:\n";
printf("    - oauth_token        = %s\n", $request_token['oauth_token']);
printf("    - oauth_token_secret = %s\n", $request_token['oauth_token_secret']);
print "\n"; 
```

我收到“致命错误：未捕获的异常 'OAuthException'...无法使用已知 CA 证书对对等证书进行身份验证”。为错误调用的行如下

```
$request_token_response = $oauth->getRequestToken('https://api.linkedin.com/uas/oauth/requestToken'); 
```

我不明白该错误试图告诉我什么，以便我可以解决问题。我将不胜感激并提供提示或指导，以帮助我更好地了解此错误消息试图传达的内容以及如何解决它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T18:57:05.300

该库似乎正在尝试验证 SSL 证书，但它不能这样做。您可以通过 OAuth::disableSSLChecks 方法禁用 ssl 检查。我假设您正在使用以下 pecl 扩展[http://www.php.net/manual/en/class.oauth.php](http://www.php.net/manual/en/class.oauth.php)。如果不是，您使用的客户端库应该有一种禁用 SSL 证书验证的方法。

```
....
...
$oauth = new OAuth(my consumer key, my consumer secret);   
$oauth->disableSSLChecks();
..
... 
```

理想情况下，您会在实例化后立即执行此操作

# ruby-on-rails - Rails 表单处理：如何处理单选按钮？

> ID：12846459
> 
> 赞同：0
> 
> 时间：2012-10-11T18:47:23.977
> 
> 标签：ruby-on-rails, database-design

我有一个标准的控制器`users`，由脚手架生成，并且有一点点主题。使用迁移，我将`:gender`字段`:orientation`类型从整数更改为字符串。我有一个表单视图，可以将新条目提交到 users 表：

```
<%= form_for @user do |f| %>
<%= f.label :first_Name %><br><%= f.text_field :first_name %><br>
<%= f.label :last_name %><br><%= f.text_field :last_name %><br>
<%= f.radio_button :orientation, false %><%= f.label :orientation, "Straight" %>
<%= f.radio_button :orientation, false %><%= f.label :orientation, "Gay" %>
<%= f.radio_button :orientation, false %><%= f.label :orientation, "Bi" %><br>
<%= f.submit "Go" %>
<% end %> 
```

但是，当我检查数据库本身时，`:gender`它们`:orientation`都是“假的”。我希望它们成为用户选择的值。

我怎样才能做到这一点？这里有什么问题？

另外，每个选择都有布尔字段会更好吗？

```
:man :boolean
:woman :boolean
:gay :boolean 
```

等等

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T18:50:18.407

尝试 check_box 而不是 radio_button？

```
<%= f.check_box :man %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T22:05:49.590

正确的代码：

```
I am:<br>
<%= f.radio_button :gender, "Male" %><%= f.label :gender, "Man" %>
<%= f.radio_button :gender, "Female" %><%= f.label :gender, "Woman" %><br>

Sexsual Orientation:<br>
<%= f.radio_button :orientation, "Straight" %><%= f.label :orientation, "Straight" %>
<%= f.radio_button :orientation, "Gay" %><%= f.label :orientation, "Gay" %>
<%= f.radio_button :orientation, "Bi" %><%= f.label :orientation, "Bi" % 
```

# cocos2d-iphone - 在屏幕顶部对齐 CCMenu

> ID：12846461
> 
> 赞同：1
> 
> 时间：2012-10-11T18:47:29.420
> 
> 标签：cocos2d-iphone, alignment

我本来希望屏幕左上角的“切换播放器”按钮上方有一个“菜单”按钮，但“菜单”按钮的上部位于屏幕上方。怎么来的？这是一个错误吗？

左对齐没问题。

谢谢！

```
-(void) superSceneEnded
{
  _sceneEnded = true;

  CCMenu *menu = [CCMenu menuWithItems:nil];
  menu.anchorPoint = ccp(0, 1); // Upper left corner
  menu.position = ccp(2, _winSize.height - 2); // Almost at upp left corner of screen
  [self addChild:menu];

  [self addButton:menu :@"Menu" :@selector(goToMenu)];
  if ([MatchMgr instance].currentMatch.isOnDevice)
  {
    [self addButton:menu :@"Switch player" :@selector(switchPlayer)];
  }
  [menu alignItemsVerticallyWithPadding:10];
}

-(void) addButton: (CCMenu*) menu: (NSString*) text: (SEL) selector
{
  CCMenuItem *menuItem = [CCMenuItemImage itemFromNormalImage:@"button.png" selectedImage:@"button-pressed.png" target:self selector:selector];
  menuItem.anchorPoint = ccp(0, 1); // Upper left corner
  //menuItem.scale = 0.5;
  [menu addChild:menuItem];

  // The code below is not relevant for the question, but I keep it for your understanding.
  CCLabelBMFont *bmText = [CCLabelBMFont labelWithString:text fntFile:@"MainFont.fnt"];
  bmText.color = ccBLACK;
  bmText.scale = 0.75;
  bmText.alignment = NSTextAlignmentCenter;
  bmText.position = ccp(75, 15);
  [menuItem addChild: bmText]; 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T08:07:08.870

看来这真的被打破了：http: [//www.cocos2d-iphone.org/forum/topic/8261](http://www.cocos2d-iphone.org/forum/topic/8261)

我自己放置按钮。

这是我的，不是那么花哨的代码：

```
-(void) superSceneEnded
{
  _sceneEnded = true;

  CGFloat yPos = _winSize.height - 10;
  CCMenu *menu = [CCMenu menuWithItems:nil];
  menu.position = ccp(0, 0);
  [self addChild:menu];

  [self addButton:menu :@"Menu" :@selector(goToMenu): &yPos];
  if ([MatchMgr instance].currentMatch.isOnDevice)
  {
    [self addButton:menu :@"Switch player" :@selector(switchPlayer): &yPos];
  }
}

-(void) addButton: (CCMenu*) menu: (NSString*) text: (SEL) selector: (CGFloat*) yPos
{
  CCMenuItem *menuItem = [CCMenuItemImage itemFromNormalImage:@"button.png" selectedImage:@"button-pressed.png" target:self selector:selector];
  menuItem.scale = 0.5;
  menuItem.position = ccp(42, *yPos);
  *yPos -= 20;
  [menu addChild:menuItem];

  CCLabelBMFont *bmText = [CCLabelBMFont labelWithString:text fntFile:@"MainFont.fnt"];
  bmText.color = ccBLACK;
  bmText.scale = 0.75;
  bmText.alignment = NSTextAlignmentCenter;
  bmText.position = ccp(75, 15);
  [menuItem addChild: bmText];
} 
```

# jaxb - Mule ESB JAXB XML 到 Object Transformer 的更好方法？

> ID：12846462
> 
> 赞同：1
> 
> 时间：2012-10-11T18:47:30.373
> 
> 标签：jaxb, esb, mule, transformer

Mule 3.3 可以使用 JAXB 自动将 XML 字符串解组为对象，前提是：
1\. 您首先使用 spring 注册您的 jaxb 注释类。2\. 有一个组件需要输入这样的类型

所以我设法进行了转换，但我必须创建一个什么都不做的“DumbTransformer”。它有一个方法可以返回它接收到的相同对象。我需要它来触发 XML 到对象的转换，以便我可以进一步处理消息。

流程示例：

```
<spring:beans>
    <spring:bean id="dumbTransformer" class="foo.bar.DumbTransformer"/>
</spring:beans>

<flow name="main" doc:name="main">
    <vm:inbound-endpoint path="in" doc:name="VM" />
        <component doc:name="Java">
            <spring-object bean="dumbTransformer"/>
        </component>
        <splitter expression="#[payload.items]" doc:name="Split Items"/>
    <logger message="#[payload]" level="INFO" doc:name="Log Item"/>
    <vm:outbound-endpoint path="out" doc:name="VM" />
</flow> 
```

DumbTransformer.java

```
package foo.bar;

@ContainsTransformerMethods
public class InvoiceUnmarshaller extends AbstractTransformer {

    @Transformer
    public MyJaxbAnnotatedClass foo(@Payload MyJaxbAnnotatedClass i) {
        return i;
    }

} 
```

有没有办法在不必创建这样的 DumbTransformers 的情况下实现这一点？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T18:59:25.657

如您所料，JAXB 反序列化不会发生，因为没有要满足的组件：

> 1.  有一个组件需要输入这样的类型

那么如果你有一个自动变压器来做到这一点呢：

```
<auto-transformer returnClass="foo.bar.MyJaxbAnnotatedClass" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T18:53:57.853

[Mule XML 模块](http://www.mulesoft.org/documentation/display/MULE3USER/XML+Module+Reference)为 OOTB 提供了一个JAXB[转换](http://www.mulesoft.org/documentation/display/MULE3USER/JAXB+Transformers)器。我宁愿尽可能利用 mule 功能，而不是编写自定义代码

# python - 匹配数字和算术运算符的正则表达式

> ID：12846466
> 
> 赞同：1
> 
> 时间：2012-10-11T18:47:48.673
> 
> 标签：python, regex

我正在寻找一个正则表达式，它将匹配 1 到 n 次出现的数字并且只出现一次算术运算符（只允许 + 或 - ）

例如，它应该匹配 -123 或 123- 或 +123 或 123+

这是我到目前为止所拥有的

```
import re

number = "-123" 

if re.findall(r"[0-9]+[+|-]?", number): 
    return True
else:
    return False 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:08:12.853

尝试这样的事情：

```
In [55]: strs
Out[55]: '+123 abc 123 -123 123- 123+ 14 foo bar'

   #you need to escape '+'and '-' In order to search them   

In [56]: re.findall(r"\d+[\+|\-]{1}|[\-|\+]{1}\d+",strs)
Out[56]: ['+123', '-123', '123-', '123+'] 
```

# android - 如何在命令行中使用选项创建 android 模拟器？

> ID：12846469
> 
> 赞同：17
> 
> 时间：2012-10-11T18:47:52.307
> 
> 标签：android, android-emulator, automation

我想用一些选项在命令行中创建模拟器，比如`hw.mainKeys = false`. 我需要它是一个 shell 脚本，以便可以在自动化测试中运行，但是[在这里](http://developer.android.com/tools/devices/managing-avds-cmdline.html)我找不到设置这些值的地方。

```
android create avd 
```

没有地方指定这些选项。

一种替代方法是创建一个“平台”类型的 avd，但是，shell 是一种交互式 shell，对人类非常有用，但对脚本来说很难

```
Android 4.1 is a basic Android platform.
Do you wish to create a custom hardware profile [no]yes 

Name of the AVD being run: 
avd.name [<build>]: 
```

是否有一些工具我可以将选项作为参数传递，例如`--hw.mainKeys false`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-11T18:52:17.907

您可以使用所需参数创建文本文件 config.ini

```
hw.lcd.density=252
sdcard.size=32M
skin.name=NEXUS-ONE
skin.path=platforms/android-10/skins/NEXUS-ONE
hw.cpu.arch=arm
hw.keyboard.lid=no
abi.type=armeabi
hw.keyboard=no
vm.heapSize=24
hw.ramSize=256
image.sysdir.1=platforms/android-10/images/ 
```

[在此处](http://developer.android.com/tools/devices/managing-avds-cmdline.html)查看官方文档

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-08-13T07:41:06.473

来自`android --help create avd`：

```
 Usage:
   android [global options] create avd [action options]
   Global options:
  -s --silent     : Silent mode, shows errors only.
  -v --verbose    : Verbose mode, shows errors, warnings and all messages.
     --clear-cache: Clear the SDK Manager repository manifest cache.
  -h --help       : Help on a specific command.

                 Action "create avd":
  Creates a new Android Virtual Device.
  Options:
  -t --target  : Target ID of the new AVD. [required]
  -a --snapshot: Place a snapshots file in the AVD, to enable persistence.
  -c --sdcard  : Path to a shared SD card image, or size of a new sdcard for
             the new AVD.
  -p --path    : Directory where the new AVD will be created.
  -b --abi     : The ABI to use for the AVD. The default is to auto-select the
             ABI if the platform has only one ABI for its system images.
  -d --device  : The optional device definition to use. Can be a device index
             or id.
  -n --name    : Name of the new AVD. [required]
  -s --skin    : Skin for the new AVD.
  -g --tag     : The sys-img tag to use for the AVD. The default is to
             auto-select if the platform has only one tag for its system
             images.
  -f --force   : Forces creation (overwrites an existing AVD) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-10-11T00:01:19.993

不推荐使用的命令具有较少的命令行选项，但它们是：

```
$ $ANDROID_HOME/tools/bin/avdmanager --help create 

Usage:
      avdmanager [global options] create [action options]
      Global options:
  -s --silent     : Silent mode, shows errors only.
  -v --verbose    : Verbose mode, shows errors, warnings and all messages.
     --clear-cache: Clear the SDK Manager repository manifest cache.
  -h --help       : Help on a specific command.

Valid actions are composed of a verb and an optional direct object:
- create avd          : Creates a new Android Virtual Device.

Action "create avd":
  Creates a new Android Virtual Device.
Options:
  -a --snapshot: Place a snapshots file in the AVD, to enable persistence.
  -c --sdcard  : Path to a shared SD card image, or size of a new sdcard for
                 the new AVD.
  -g --tag     : The sys-img tag to use for the AVD. The default is to
                 auto-select if the platform has only one tag for its system
                 images.
  -p --path    : Directory where the new AVD will be created.
  -k --package : Package path of the system image for this AVD (e.g.
                 'system-images;android-19;google_apis;x86'). [required]
  -n --name    : Name of the new AVD. [required]
  -f --force   : Forces creation (overwrites an existing AVD)
  -b --abi     : The ABI to use for the AVD. The default is to auto-select the
                 ABI if the platform has only one ABI for its system images.
  -d --device  : The optional device definition to use. Can be a device index
                 or id. 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-11T18:57:16.150

看看[这里](https://stackoverflow.com/questions/3552218/android-create-avd-size-on-windows-command-prompt)

```
android create avd -n Ev o4G -t 9 -c 8000M -s 480-800 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-04T09:51:45.100

只需使用**`echo no | android create avd -n name -t 9`**

# php - 正则表达式获取信息

> ID：12846470
> 
> 赞同：1
> 
> 时间：2012-10-11T18:47:54.660
> 
> 标签：php, regex

我有一个字符串，我想为它提取一些信息。字符串可能是这样的

```
$string = "Followers: abc.com. ID by: xyz@gmail.com. More info: all the rest of information goes here. All other goes everywhere else." 
```

**$string 有时只是有**

```
$string = "ID by: xyz@gmail.com." 
```

**或者**

```
$string = "Followers: abc.com." 
```

或任何其他组合。我只是想看看那里是否有身份证并将其取出。

实现这一目标的最佳方法是什么

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T18:53:49.693

使用正则表达式 with`preg_match`来查找 ID。

```
preg_match('/ID by\\: ([\\w@\\.]+)\\.(?: |$)/',$input,$matches); 
```

ID（电子邮件地址）将在`$matches[1]`. 该模式匹配“ID by：”，捕获电子邮件地址，最后需要句点 + 空格或字符串结尾。

# python - 如何从模块和主文件中读取配置文件？

> ID：12846472
> 
> 赞同：4
> 
> 时间：2012-10-11T18:48:02.153
> 
> 标签：python, import, module, python-3.x, configparser

我在加载和读取我的配置文件时遇到问题。当我运行`imptest.py`文件时，Python 读取`configfile.cfg`并得到以下输出：

```
D:\tmp\test\dir1>python imptest.py
Section1
Section2
Section3 
```

但是当我运行该`mainfile.py`文件时，什么也没有发生，似乎 Python 没有读取该`configfile.cfg`文件：

```
D:\tmp\test>python mainfile.py

D:\tmp\test> 
```

我的目录结构：

```
测试/
 目录1/
    __init__.py
    imptest.py
 静止的/
    配置文件.cfg
 主文件.py

```

文件来源`mainfile.py`：

```
from dir1.imptest import run

if __name__ == '__main__':
    run() 
```

文件来源`imptest.py`：

```
import configparser

def run():
    config = configparser.ConfigParser()
    config.read('../static/configfile.cfg', encoding='utf8')

    for sections in config.sections():
        print (sections)

if __name__ == '__main__':
    run() 
```

文件来源`configfile.cfg`：

```
[Section1]
Foo = bar
Port = 8081

[Section2]
Bar = foo
Port = 8080

[Section3]
Test = 123
Port = 80 
```

**已编辑**

到目前为止，我的解决方案（绝对路径）是：

```
cwd = os.path.realpath(os.path.dirname(__file__) + os.path.sep + '..')
config.read(os.path.join(cwd,'static' + os.path.sep + 'configfile.cfg'), encoding='utf8') 
```

它与@Yavar 的解决方案更好、更差还是相同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T19:01:35.897

如果您想要一个相对路径`imptest.py`，请使用`__file__`：

```
mydir = os.path.dirname(os.path.abspath(__file__))
new_path = os.path.join(mydir, '..', rest_of_the_path) 
```

另外，请参阅此问题的答案： [Difference between __file__ and sys.argv[0]](https://stackoverflow.com/questions/5851588/difference-between-file-and-sys-argv0)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:03:21.323

它没有找到您的配置文件，因为从您的主文件版本调用时您没有使用正确的路径。

有趣的是，configparser 会默默地忽略。看一下这个：

```
Python 3.2.3 (default, Sep 10 2012, 18:14:40) 
[GCC 4.6.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import configparser
>>> 
>>> config = configparser.ConfigParser()
>>> config.read('doesnotexist.cfg')
[]
>>> print(config.sections())
[]
>>> 
```

# flash - 如何在 Flash 中使用动作脚本移除对象

> ID：12846477
> 
> 赞同：-1
> 
> 时间：2012-10-11T18:48:15.390
> 
> 标签：flash, actionscript-2

我的表单中有三个图像，当 x 轴达到 50px 时，我想删除它们。我使用了以下代码：

```
onClipEvent (enterFrame) {  
    if (this._x <40){
        this.removeMovieClip();
    }
} 
```

但图像并没有消失。如何删除此对象。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:02:47.580

我也是新手

也许 removeChild 是你要找的，removeChild(this) 或 removeChild(myMovieClip)

在 AS2 中，也许这是深度问题，这可能会有所帮助 [http://www.kirupa.com/forum/showthread.php?317085-remove-movie-clip-help-remove-child-AS2](http://www.kirupa.com/forum/showthread.php?317085-remove-movie-clip-help-remove-child-AS2)

# visual-studio - 已存在同名配置

> ID：12846478
> 
> 赞同：123
> 
> 时间：2012-10-11T18:48:18.033
> 
> 标签：visual-studio, visual-studio-2010, deployment, configuration

我有一个包含 10 多个项目的解决方案（VS2010 SP1）。我在解决方案中定义了以下配置：

*   调试
*   调试-QA
*   释放-UAT
*   发布-生产

这使我可以轻松地为每个部署方案设置特定设置。但是，由于某种原因，我无法按照我的意愿进行设置。请看这个截图：

![配置管理器的屏幕截图](../Images/84eded68c8e0691867d5e9103a315175.png)

注意突出显示的项目/配置。我无法为这些项目创建“Debug-QA”配置（通过`<New>`在该特定项目的单元格中进行选择）。例如，当我尝试向 DataUtility 项目添加新的“Debug-QA”配置时，Visual Studio 对我大喊：

> 无法创建此配置，因为已存在同名的解决方案配置。

我知道确实如此！我正在尝试将配置添加到项目中！我在这里想念什么？我希望所有项目都具有全部 5 种配置。在尝试匹配（创建）平台时（例如，将“Any CPU”平台添加到 DataUtility 项目）时，我遇到了同样的问题。

* * *

## 回答 #1

> 赞同：270
> 
> 时间：2012-10-11T19:11:31.603

确保您使用的是网格中的下拉列表（不是对话框顶部的下拉列表），并且在添加新项目配置时不要选中“创建新的解决方案配置”复选框。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-01-22T20:59:29.293

如果已选中“*创建新解决方案配置*”复选框，则可以使用以下解决方法：

> 1.  打开资源管理器并导航到缺少平台的项目的解决方案位置。
> 2.  将解决方案 .sln 文件移动到 Visual Studio 找不到它的临时位置。
> 3.  打开缺少平台的项目的 .csproj 文件。
> 4.  单击解决方案平台下拉菜单。
> 5.  单击配置管理器...
> 6.  在表中，单击项目的平台列中的下拉菜单并选择 , 以添加新平台。
> 7.  单击确定。
> 8.  根据需要重复添加新平台。
> 9.  保存项目。
> 10.  将先前移动的解决方案文件返回到原来的位置。
> 11.  重新打开组合项目解决方案。

*来源*：[https ://developercommunity.visualstudio.com/content/problem/972/adding-a-platform-when-one-with-the-same-name-alre.html](https://developercommunity.visualstudio.com/content/problem/972/adding-a-platform-when-one-with-the-same-name-alre.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-06-30T12:40:46.427

上面的解决方案不太奏效，但我确实在一个有效的论坛上找到了一个解决方案。下面描述的是为每个设置为“任何 CPU”的项目将构建设置为 x64，但这些步骤也适用于 x86。

1.  打开主解决方案。卸载每个有冲突的项目（而不是删除）。

2.  让解决方案保持打开状态。

3.  在资源管理器中，导航到项目文件夹并在 Visual Studio 中打开 csproj 文件。

4.  在这个搞砸的项目中，导航到 Build->Configuration Manager。

5.  如果需要，“添加新”并将其设置为 x64 并保存。

6.  右键单击该项目并将构建体系结构设置为新的 x64。

7.  保存这个，但是当你在VS中关闭项目时，不要保存到解决方案中。那是不必要的。

8.  对架构未对齐的每个项目重复此操作。

9.  最后，在包含所有违规项目的原始解决方案中，重新加载每个项目。

10.  打开解决方案的 Build->Configuration Manager。然后，将“任何 CPU”一一重置为所需的平台，在我的情况下为 x64。

保存解决方案的更改并全部重建。你现在应该没事了。

[![在此处输入图像描述](../Images/bee050034265b1deb22f1fbfead7cafb.png)](https://i.stack.imgur.com/JlRYH.png)

# c# - 在同一个对象上调用两次时，MustHaveHappened 失败

> ID：12846484
> 
> 赞同：4
> 
> 时间：2012-10-11T18:48:39.497
> 
> 标签：c#, unit-testing, fakeiteasy

给定以下被测类（以及相关的 DTO 类和接口）：

```
public class Foo
{
    private readonly IBar _bar;

    public Foo(IBar bar) { _bar = bar; }

    public void DoStuff()
    {
        var dto = new DTO();

        dto.Num = 1;
        _bar.Test(dto);

        dto.Num = 2;
        _bar.Test(dto);
    }
}

public class DTO { public int Num { get; set; } }

public interface IBar { void Test(DTO dto); } 
```

这个测试方法（它试图验证 IBar.Test() 被调用了两次：一次是 Num = 1，一次是 Num = 2）：

```
public void TestMethod1()
{
    var bar = A.Fake<IBar>();
    var foo = new Foo(bar);
    foo.DoStuff();

    A.CallTo(() => bar.Test(A<DTO>.That.Matches(x => x.Num == 1))).MustHaveHappened();
    A.CallTo(() => bar.Test(A<DTO>.That.Matches(x => x.Num == 2))).MustHaveHappened();
} 
```

第一个“MustHaveHappened”调用失败。我发现这是因为两次调用 IBar.Test() 使用的 DTO 是同一个实例。如果我将代码更改为使用两个不同的 DTO 调用 IBar.Test()，它会按预期工作。

我的问题是：这是 FakeItEasy 中的错误还是我做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-12T10:20:39.107

这是正确的行为，而不是错误。FakeItEasy 记录带有参数的调用，但它**不会**在调用期间存储参数的内部状态——它只是存储参数本身的引用/值。最后，在您的验证阶段，`DTO`对象的当前状态是`Num`等于 2 的状态，这就是 FakeItEasy 将验证的内容。

我不确定是否有针对此类情况的开箱即用支持，但您可以轻松实现此解决方法（无需创建第二个`DTO`对象）：

```
var bar = A.Fake<IBar>();
var foo = new Foo(bar);
var expectedNumValues = new [] { 1, 2 };
var actualNumValues = new List<int>();
// Whenever a call to IBar.Test is made, store DTO.Num in list
A.CallTo(() => bar.Test(A<DTO>.Ignored)).Invokes(
    fakeCall =>
    {
        var dto = (DTO) fakeCall.Arguments[0];
        actualNumValues.Add(dto.Num);
    }
);

foo.DoStuff();

// this verifies that both collections contain same elements at same positions
CollectionAssert.AreEqual(expectedNumValues, actualNumValues); 
```

# android - Android Gingerbread 上 LocalStorage 的非法访问异常

> ID：12846485
> 
> 赞同：18
> 
> 时间：2012-10-11T18:48:41.107
> 
> 标签：android, cordova, local-storage, android-2.3-gingerbread

我制作了一个 Android/Phonegap 应用程序，它在所有具有多个 android 操作系统版本的设备上运行良好，除了一些 Gingerbread (2.3) 手机。我正在使用 Phonegap 1.9。

调试代码，我实现了一次`illegal access exception`对Ja​​vascript，每次使用HTML5`localStorage.getItem()`和`localStorage.setItem()`方法。

如何`localStorage`在这些 Android 设备上启用这些功能？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T18:31:44.640

当 .getItem() 返回 null 时，非法异常是由 JSON.parse() 方法引起的。只是要小心验证它。Android 2.3、HTML5 localStorage 和 Phonegap 现在可以完美运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-03T07:16:57.190

这个验证对我有用。:) （android 2.3 中的 javascript 使用 phonegap）

```
Storage.prototype.getArray = function(key) {
        if (this.getItem(key)) {
            return JSON.parse(this.getItem(key)) 
        } else {
            //console.log("no error null value");
        }

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:10:41.387

检查您的 WebView 的 WebSettings 的代码，即检查以下调用：

```
WebSettings settings = webView.getSettings();

settings.setJavaScriptEnabled(true);

settings.setDatabaseEnabled(true);

settings.setDatabasePath(this.getApplicationContext()
        .getDir("database", Context.MODE_PRIVATE).getPath());

settings.setDomStorageEnabled(true); 
```

# design-patterns - 使存储库持久性无知的优点/缺点是什么？

> ID：12846490
> 
> 赞同：6
> 
> 时间：2012-10-11T18:49:10.187
> 
> 标签：design-patterns, domain-driven-design, repository-pattern

通常，*存储库*应该知道我们决定使用哪个数据库的实现细节。

*a) 但是，使存储库*持久性无知（即不知道什么持久性介质用于存储数据）的优点/缺点是什么。我能想到的唯一优点是现在可以使用相同的*Repository 实现，无论持久化哪种介质数据*

b）假设*Repository*是*Persistence Ignorant*，那么*Repository 接口*及其实现都应该驻留在*域程序集中*？！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T11:47:57.037

好吧，使用存储库模式的全部意义在于将域逻辑与持久性逻辑分开，因此，您可以使用具有不同数据存储的相同域实现。因此，存储库的实现必须在某种程度上依赖于数据库的实现似乎很自然。

a) 我认为主要的缺点是性能。存储库越抽象，您将需要设计和实现更多抽象级别，涵盖更多案例。但是，一个专门的存储库会表现得更好，因为它知道其底层存储的全部功能。

另一个缺点是开发和维护成本。我认为这些缺点超过了具有完全通用结构的任何优点......

b) 对于较小的项目，我的回答是“也许”，但对于所有其他项目，我的回答是“不”。它与持久无知没有任何关系。我一直尝试遵循的最佳实践是关注点分离。如果他们试图做不同的事情，那么就把他们分开。它将使您免于以后的许多噩梦。

任何进一步的想法| 想法，我也愿意听他们的:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T03:18:42.567

您可能希望将存储库接口与实现分离，而不是使存储库“持久化无知”。例如，一个 CustomerRepository 可以由 NHibernateCustomerRepository 和 EFCustomerRepository 实现。这样，实现之间的切换就像更改配置一样容易（至少在幻想世界中）。这有一些现实世界的用途：例如，某些客户坚持使用专有解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T01:52:36.033

这听起来有点像在想自己。经典的存储库模式旨在将持久性细节从值对象和实体的实现中抽象出来，这是 DDD 中的基本构建块。如果关键是隐藏持久性，那么使存储库持久性不知道会得到什么？

有些人认为他们应该抽象出他们的持久性抽象的细节，例如允许“通用 ORM”而不是“NHibernate”，但在这里我认为这对你自己来说太聪明了。你有一个`IRepository`，这就足够了。如果你想要一个`NHibernateRepository`和一个`EventStoreRepository`，去吧。

# python - 从列表中删除不需要的数据

> ID：12846492
> 
> 赞同：0
> 
> 时间：2012-10-11T18:49:18.047
> 
> 标签：python, list

我有一个不同长度的列表，我想用一些新数据不断更新。所以基本上我想添加一个新的数据点并删除设定范围之外的任何数据。我现在一直在玩这个，但我还没有得到任何可以告诉的地方。我试图用[这篇](https://stackoverflow.com/questions/1207406/remove-items-from-a-list-while-iterating-in-python)文章作为参考，但显然我不明白发生了什么。下面是一个代码片段，它是我尝试过的一个示例。

```
for i in range(0,100):
    n.append(i)
    n = [x for x in n if not (x-n[-1]>10)]
    print len(n) 
```

理想情况下，在 for 循环期间的任何给定时间，n 都只会包含最后 10 个数据点。我确信这是我不理解的基本内容，如果你们都可以帮助我，我将非常感激。谢谢。

编辑：列表 n 的示例

```
[0]
[0, 1]
...
[89, 90, 91, 92, 93, 94, 95, 96, 97, 99] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T18:56:33.277

为什么不只是`pop()`每次添加某些内容时的列表，如果`len>10`？如果我正确理解这个问题。

```
for i in range(0,100):
    n.append(i)
    if len(n)>10:
       n.pop(0) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-11T18:56:38.817

假设你的意思是 n 应该只包含最近插入的 10 个数据点，你想要：

```
for i in range(0,100):
    n.append(i)
    if len(n)>10: n[:] = n[1:]
    print len(n) # will never go above 10 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T19:04:24.583

如果我正确理解，您希望在列表“n”中保留一些可变数量的元素。让我们称这个变量为“m”，所以

```
for i in range(0,100):
    n.append(i)
    m = random.randint(1, 10)
    if len(n)>m:
        n = n[-m:]               # [-m:] defines the last m elements of n
    print len(n) 
```

这应该总是在最后打印 m

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T19:16:25.830

使用带有快速追加和弹出的[双端队列](http://docs.python.org/library/collections.html#collections.deque)：从 python 2.7 开始，您可以设置 maxlen。

```
from collections import deque

>>> d=deque([])
>>> for i in range(10):
...     d.append(i)
...     if len(d) > 3: d.popleft()
... 
0
1
2
3
4
5
6
>>> d
deque([7, 8, 9]) 
```

使用 maxlen：

```
>>> d = deque(range(5), maxlen=3)
>>> print d
deque([2, 3, 4], maxlen=3)
>>> print d.maxlen
3 
```

# java - 如何从 BufferedImage 创建 8 位 PNG？

> ID：12846494
> 
> 赞同：2
> 
> 时间：2012-10-11T18:49:23.673
> 
> 标签：java, png, bufferedimage

我有一个 Java 程序，它创建仅包含黑色像素和 100% 透明像素的复合 png 图像。我试图尽可能减小这些复合材料的大小，我注意到 ImageIO.write 总是输出 32 位 PNG。考虑到图像总共只有两种颜色，我想将它们保存为 8 位，但我认为没有办法使用标准 Java 函数来做到这一点。

有谁知道任何可以从 BufferedImage 创建 8 位 png 的预构建函数？也欢迎任何其他减小这些 png 大小的建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T18:55:21.017

我不确定，但我猜它`ImageIO`使用任何*类型*的`BufferedImage`用途。尝试使用可用的不同类型。`TYPE_CUSTOM`看起来`TYPE_BYTE_BINARY`很有希望。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T14:46:03.483

我不得不把它放在后座上一会儿，但我昨天又回来了，想出了怎么做。基本上它归结为使用下的类`com.sun.imageio.plugins.png`和自定义`ImageWriteParam`.

我必须自己构建颜色表（不太难，只是字节数组）。然后将颜色表传递给`ImageTypeSpecifier.createIndexed`. 返回的结果`ImageTypeSpecifier`允许您创建一个`BufferedImage`我将像素复制到其中的。

接下来，我使用创建了自定义 PNG 标头`PNGMetadata`（需要阅读大量有关 PNG 规范的内容，但总体而言非常简单）。`IIOImage`然后我使用所述元数据和 BufferedImage创建了一个新的。

最后，我创建了一个`PNGImageWriter`并从中获得了默认值`ImageWriteParam`。然后我简单地将`ImageTypeSpecifier`from before 传递给它的`setDestinationType`方法。最后一步是通过将 IIOImage 和 ImageWriteParam 传递给 PNGImageWriter 将 PNG 写入磁盘。

其中许多类的文档非常稀少，但它们的功能很棒。通过这样做，我创建了一个包含位深度为 1 的最小 PNG（因为只有两种颜色），这将我的 PNG 的大小平均减少了 78%！！！非常值得努力。

# sql-server-2008 - 替换 SQL Server 2008 的等效项

> ID：12846495
> 
> 赞同：0
> 
> 时间：2012-10-11T18:49:52.073
> 
> 标签：sql-server-2008, replace

> **可能重复：**
> [在 SQL Server 2008 中替换为](https://stackoverflow.com/questions/10385933/replace-into-in-sql-server-2008)

我怎样才能做到这一点

```
REPLACE INTO "product_to_store" ("store_id", "product_id") VALUES ('1', '1') 
```

在 SQL Server 2008 中？

我需要替换这个值不只是更新

# magento-1.7 - 从主页上列出的产品中获取属性

> ID：12846498
> 
> 赞同：1
> 
> 时间：2012-10-11T18:50:01.383
> 
> 标签：magento-1.7

在 Magento 上，我们在主页上列出了产品，并且运行良好。我想阅读这个添加到列表文件中产品常规部分的自定义属性来做检查。

这是一个是/否属性。

尝试执行以下操作作为测试：

```
if($this->getLoadedProductCollection()->addAttributeToFilter('iscomingsoon', array('like' => '1')) == 1)
{
    echo "huzzah!";
} 
```

属性是`iscomingsoon`。即使选项设置为 no，它也始终返回 true。

编辑：以下将在实际的产品视图页面上工作：getProduct(); echo $_product->getiscomingsoon();//如果是则显示 1 ?>

^^ 将无法在主页上使用。基本上我们有即将推出的产品。这些产品应该是不可点击的、有评级的、添加到购物车的按钮或数量的。它应该有的唯一的东西是产品的形象，说即将推出。当产品不再即将推出并发布时，将即将推出选项从是更改为否。

基本上我的想法是有一个 if 语句检查产品即将推出的选项是否为是（值 = 1）。如果是，则显示如上所述的产品以及即将推出的图像。产品集合加载到主页网格上。不知道该怎么做才能获得该属性。可能我错过了一些简单的东西，但我似乎无法得到它......

谢谢你的时间，乔治

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T05:10:00.477

嘘！得到它的工作。我使用以下内容来获取属性值：

```
$_product->getData('iscomingsoon') 
```

# matlab - 在 MAtrix 中查找具有 NAN 值的行并删除它们

> ID：12846504
> 
> 赞同：2
> 
> 时间：2012-10-11T18:50:32.177
> 
> 标签：matlab

> **可能重复：**
> [MATLAB：如何有效地从矩阵中删除 NaN 元素](https://stackoverflow.com/questions/5202680/matlab-how-to-efficiently-remove-nan-elements-from-matrix)

我得到了下面的代码，但它有点慢（矩阵很大）有没有更好的方法来做到这一点？

```
errorMat=isnan(rates);
errorRows=ind(errorMat);
for i=1:length(errorRows)
   rates(:,errorRows(i)) = [];
end 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-11T19:03:51.420

```
rates(any(isnan(rates), 2), :) = []; 
```

或者：

```
rates = rates(~any(isnan(rates), 2), :); 
```

我认为第二种方法更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:03:46.987

尝试这个：

```
[rows, cols] = find(isnan(rates)); 
rates(unique(rows),:) = [] 
```

免责声明：未经测试，因为我不在这台机器上使用 Matlab，并且 Octave 抱怨该`unique`功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T19:21:40.960

另一个变体 - sum with `NaN`s 返回 a `NaN`，所以

```
rates(isnan(sum(rates,2)),:) = []; 
```

# vb.net - SAP COM VB6 VB.NET 行为差异

> ID：12846506
> 
> 赞同：0
> 
> 时间：2012-10-11T18:50:33.837
> 
> 标签：vb.net, com, vb6, sap, bapi

我通过 COM 连接到 SAP，使用拖入表单的 ActiveX 控件。在VB6中我写：

```
Private Sub Form_Terminate()
    SAPBAPIControl.Connection.Logoff
End Sub

Private Sub SAPLogonControl_Click()
    Set SAPBAPIControl.Connection = SAPLogonControl.NewConnection
    SAPBAPIControl.Connection.Client = "100"
    If SAPBAPIControl.Connection.Logon(0, False) Then
        MsgBox SAPBAPIControl.Connection.IsConnected
    End If
End Sub 
```

在 VB.NET 2010 中，我写道：

```
Public Class MainForm
    Private Sub MainForm_FormClosing(sender As Object, e As System.Windows.Forms.FormClosingEventArgs) Handles Me.FormClosing
    AxSAPBAPIControl1.Connection.Logoff()
End Sub

    Private Sub AxSAPLogonControl1_ClickEvent(sender As Object, e As System.EventArgs) Handles     AxSAPLogonControl1.ClickEvent
        AxSAPBAPIControl1.Connection = AxSAPLogonControl1.NewConnection()
        AxSAPBAPIControl1.Connection.Client = "100"
        If AxSAPBAPIControl1.Connection.Logon(0, False) Then
            MsgBox(AxSAPBAPIControl1.Connection.IsConnected)
        End If
    End Sub
End Class 
```

最后得到：

> Eine Ausnahme (erste Chance) des Typs "System.AccessViolationException" ist in mscorlib.dll aufgetreten。在 .Client = "100"

VB6 可以正常工作。

有谁知道如何将连接对象传输到 VB.NET 中的其他类

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-12T10:54:48.747

猜测一下：您在旧的 VB6 代码中使用 Set，我认为这会影响对象，VBA 中的链接。你可以尝试类似的东西

```
AxSAPBAPIControl1 =  AxSAPBAPIControl1.Connection = AxSAPLogonControl1.NewConnection() 
```

我认为 AxSAPBAPIControl1 为您提供了一个连接对象并且不会修改自身 - 所以您正在打开一个从未使用过的新连接，然后使用“未连接”的 AxSAPBAPIControl1。我不知道 SAP-Com，但这种 krad 有时会在 msoffice.interop 中发生。请给我一些反馈。

# python - 使用 Beautiful Soup 查找描述

> ID：12846507
> 
> 赞同：0
> 
> 时间：2012-10-11T18:50:40.743
> 
> 标签：python, beautifulsoup

这里有很多帖子询问如何在 Google 上进行自动搜索。我选择使用 BeautifulSoup，并在这里阅读了很多关于它的问题。我找不到我的问题的直接答案，尽管具体任务似乎很平常。我下面的代码非常不言自明，括号中的部分是我遇到麻烦的地方（*编辑*“遇到麻烦”我的意思是我无法弄清楚如何为这部分实现我的伪代码，并且在阅读了文档和用代码在线搜索类似的问题，我仍然不知道该怎么做）。如果有帮助，我认为我的问题可能与在 PubMed 上进行自动搜索以查找感兴趣的特定文章的任何人非常相似。非常感谢。

```
#Find Description

import BeautifulSoup
import csv
import urllib
import urllib2

input_csv = "Company.csv"
output_csv = "output.csv"

def main():
    with open(input_csv, "rb") as infile:
        input_fields = ("Name")
        reader = csv.DictReader(infile, fieldnames = input_fields)
        with open(output_csv, "wb") as outfile:
            output_fields = ("Name", "Description")
            writer = csv.DictWriter(outfile, fieldnames = output_fields)
            writer.writerow(dict((h,h) for h in output_fields))
            next(reader)
            first_row = next(reader)
            for next_row in reader:
                search_term = first_row["Name"]
                url = "http://google.com/search?q=%s" % urllib.quote_plus(search_term)

                #STEP ONE: Enter "search term" into Google Search
                #req = urllib2.Request(url, None, {'User-Agent':'Google Chrome'} )
                #res = urllib2.urlopen(req)
                #dat = res.read()
                #res.close()
                #BeautifulSoup(dat)

                #STEP TWO: Find Description
                #if there is a wikipedia page for the entity:
                    #return first sentence of wikipedia page
                #if other site:
                    #return all sentences that have the keyword "keyword" in them

                #STEP THREE: Return Description as "google_search" variable

                first_row["Company_Description"] = google_search
                writer.writerow(first_row)
                first_row = next_row

if __name__ == "__main__":
    main() 
```

**附录**

对于任何从事此工作或正在研究它的人，我想出了一个我仍在完成的次优解决方案。但我想我会发布它，以防它帮助其他任何来到这个页面的人。基本上，我没有处理查找要选择的网页的问题，而是做了一个初始步骤，它在维基百科中进行所有搜索。这不是我想要的，但至少它会使获取实体子集变得更容易。代码位于两个文件中（Wikipedia.py 和 wiki_test.py）：

```
#Wikipedia.py

from BeautifulSoup import BeautifulSoup
import csv
import urllib
import urllib2
import wiki_test

input_csv = "Name.csv"
output_csv = "WIKIPEDIA.csv"

def main():
    with open(input_csv, "rb") as infile:
        input_fields = ("A", "C", "E", "M", "O", "N", "P", "Y")
        reader = csv.DictReader(infile, fieldnames = input_fields)
        with open(output_csv, "wb") as outfile:
            output_fields = ("A", "C", "E", "M", "O", "N", "P", "Y", "Description")
            writer = csv.DictWriter(outfile, fieldnames = output_fields)
            writer.writerow(dict((h,h) for h in output_fields))
            next(reader)
            first_row = next(reader)
            for next_row in reader:
                print(next_row)
                print(first_row["A"])
                search_term = first_row["A"]
                #print(search_term)
                result = wiki_test.wiki(search_term)
                first_row["Description"] = result
                writer.writerow(first_row)
                first_row = next_row

if __name__ == "__main__":
main() 
```

还有一个基于这篇文章的帮助模块[从维基百科文章中提取第一段（Python）](https://stackoverflow.com/questions/4460921/extract-the-first-paragraph-from-a-wikipedia-article-python)：

```
import urllib
import urllib2
from BeautifulSoup import BeautifulSoup

def wiki(article):
    article = urllib.quote(article)
    opener = urllib2.build_opener()
    opener.addheaders = [('User-agent', 'Google Chrome')] #wikipedia needs this
    resource = opener.open("http://en.wikipedia.org/wiki/" + article)
    #try:
    #    urllib2.urlopen(resource)
    #except urllib2.HTTPError, e:
    #    print(e)
    data = resource.read()
    resource.close()
    soup = BeautifulSoup(data)
    print soup.find('div',id="bodyContent").p 
```

我只需要修复它以处理 HTTP 404 错误（即未找到页面），此代码适用于任何想要查找维基百科上提供的基本公司信息的人。再说一次，我宁愿有一些可以在谷歌搜索上工作的东西，并找到相关网站和网站中提到“关键字”的相关部分，但至少这个当前的程序让我们得到了一些东西。

# python - 如何判断项目在 qlistview 中的放置位置？

> ID：12846509
> 
> 赞同：2
> 
> 时间：2012-10-11T18:50:56.080
> 
> 标签：python, drag-and-drop, pyqt, pyqt4, qlistview

我有一个自定义 QListView：

```
from PyQt4.QtCore import *
from PyQt4.QtGui import *

from Diagnostics import Trace2 #writes to log file
import traceback

class ListOrderView(QListView):

    itemMoved = pyqtSignal(int, int, QStandardItem) # Old index, new index, item 

    def __init__(self, parent=None):
        try:
            super(ListOrderView, self).__init__(parent)

            self.setAcceptDrops(True)
            self.setDragEnabled(True)
            self.setDragDropMode(QAbstractItemView.InternalMove)
            self.setDefaultDropAction(Qt.MoveAction)

            self.setEditTriggers(QAbstractItemView.NoEditTriggers)
            self.setSelectionBehavior(QAbstractItemView.SelectRows)
            self.setSelectionMode(QAbstractItemView.SingleSelection)

            self.dragItem = None
            self.dragRow = None

            self.indexesMoved.connect(self.onIndexesMoved)
            #self.installEventFilter(self)
        except:
            Trace2.WriteLine(str(traceback.format_exc()))

    def onIndexesMoved(self, indexes):
        Trace2.WriteLine("indexes were moved")

    def dropEvent(self, event): 
        try:
            super(ListOrderView, self).dropEvent(event) 

            self.selectionModel().setCurrentIndex(self.model().indexFromItem(self.dragItem), QItemSelectionModel.SelectCurrent)
            Trace2.WriteLine("[LISTVIEW] item dropped")
            Trace2.WriteLine("[LISTVIEW] current index is %d" %self.selectionModel().currentIndex().row())
            Trace2.WriteLine("[LISTVIEW] current selection is %d" %self.selectionModel().selection().indexes()[0].row())

            self.itemMoved.emit(self.dragRow, self.row(self.dragItem), self.dragItem)
            self.dragItem = None
        except:
            Trace2.WriteLine(str(traceback.format_exc()))

    def startDrag(self, supportedActions): 
        try:
            self.dragItem = self.currentItem() 
            self.dragRow = self.row(self.dragItem) 
            super(ListOrderView, self).startDrag(Qt.MoveAction)
        except:
            Trace2.WriteLine(str(traceback.format_exc()))

    def currentItem(self):
        index = self.currentIndex()
        item = self.model().itemFromIndex(index)
        #Trace2.WriteLine("[LISTVIEW] currentItem = %s" % item.data(Qt.DisplayRole).toString())
        return item

    def row(self, item):
        #index = self.model().indexFromItem(item)
        index = self.selectedIndexes()[0]
        row = index.row()

        #Trace2.WriteLine("[LISTVIEW] row = %d" %row)
        return row 
```

而且我真的需要知道拖放操作后项目被放置在哪里，以便可以正确更新其他内容（我试图将拖放放入从未设计过的东西，大型应用程序，而不是我的设计）。选择模型的当前索引和选择不跟随丢弃的项目，它们有效地选择一个新项目并将事情搞砸。有没有办法让它们随着掉落的物品一起移动？信号 indexMoved 看起来和我想要的完全一样，但它永远不会触发。我用错了吗？有没有不同/更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T19:51:30.850

我认为你可能需要让模型告诉你东西掉在哪里了，因为它最终会处理这个动作：

```
class Model(QStandardItemModel):

    rowDropped = pyqtSignal(int)

    def dropMimeData(self, *args):
        success =  super(Model, self).dropMimeData(*args)
        if success:
            self.rowDropped.emit(args[2])
        return success 
```

这将从模型中发出发生下降的行号。您的视图已经知道从它自己的事件中拖放了哪个项目。

我确信在跟踪对象方面还有其他方法，然后在放置完成后再次查询它。

# javascript - 弹出窗口 DOM 异常中的 IE 复制画布：TYPE_MISMATCH_ERR (17)

> ID：12846510
> 
> 赞同：0
> 
> 时间：2012-10-11T18:51:02.190
> 
> 标签：javascript, html, internet-explorer, canvas

我不知道我遇到的这个 IE9 问题是否有解决方法，但这就是我想要做的。我的页面上的画布中有一张图片。我想将此画布图像复制到另一个画布，但在我创建的弹出窗口中。我在这个实验中遇到的是我可以将画布图像复制到同一页面上另一个动态创建的画布中，没问题。但是当我尝试在弹出窗口中执行此操作时，IE 给了我一个**DOM Exception: TYPE_MISMATCH_ERR (17)**。可悲的是，这似乎是 IE 的事情，因为我在 Chrome 中运行了相同的代码，并且它有效......所以这是我的代码。不过，您需要提供自己的图像，我使用了一个简单的 640x480 jpeg 文件。您还需要打开控制台，因为我正在执行 console.error。

```
<!DOCTYPE html>
<html>
<head>
    <title>Canvas Copy Test</title>
    <style>
        #mainSrc {
            border:1px solid red;
        }
        #dest01 {
            width:640px;
            height:480px;
            border:1px solid blue;
        }
    </style>
    <script>
        var destWin;    // Destination Window

        window.onload=function()
        {           
            var testImg = new Image();
            testImg.src = "me.jpg";
            testImg.onload = function()
            {
                var mainCanvas = document.getElementById("mainSrc");
                var mainCtx = mainCanvas.getContext("2d");
                mainCtx.drawImage(testImg,0,0);
            }
            var copyBtn = document.getElementById("copyBtn");
            var copyWinBtn = document.getElementById("copy2WinBtn");
            copyBtn.addEventListener("click",copyImage,false);
            copyWinBtn.addEventListener("click",copy2Win,false);
        }

        // Copy Canvas Image to Another on the same page.
        function copyImage()
        {
            var mainCanvas = document.getElementById("mainSrc");
            var destCanvas = document.createElement("canvas");
            var destDiv = document.getElementById("dest01");
            destCanvas.width = mainCanvas.width;
            destCanvas.height = mainCanvas.height;
            var dCtx = destCanvas.getContext("2d");
            dCtx.drawImage(mainCanvas,0,0);
            destDiv.appendChild(destCanvas);
        }

        // Copy Canvas to Popup Window
        function copy2Win()
        {
            var mainCanvas = document.getElementById("mainSrc");

            try {           
                destWin = window.open("","destWin");
                var destWinDoc = destWin.document;
                var destWinHTML = "<!DOCTYPE html><html><head><title>POPUP</title><body><div id='destWinDiv' style='width:640px; height:480px; border:1px solid red'></div></body></html>";
                destWinDoc.write(destWinHTML);

                var destCanvas = destWinDoc.createElement("canvas");
                var destDiv = destWinDoc.getElementById("destWinDiv");
                destCanvas.width = mainCanvas.width;
                destCanvas.height = mainCanvas.height;
                var dCtx = destCanvas.getContext("2d");
                dCtx.drawImage(mainCanvas,0,0);
                destDiv.appendChild(destCanvas);
            }
            catch (err)
            {
                console.error(err);
            }
        }

    </script>
</head>
<body>
    <canvas id="mainSrc" width="640" height="480"></canvas>
    <p>
        <input type="button" name="Copy" value="Copy" id="copyBtn" />
        &nbsp;
        <input type="button" name="Copy2Win" value="Copy To New Window" id="copy2WinBtn" />
    </p>
    <div id="dest01"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:55:42.313

好吧，在玩了一会儿之后，我发现标签实际上可以从画布 toDataURL() 中获取 base64 编码的图像并显示它......所以我能够在上面的 copy2Win 函数中进行这个修改这个：

```
 function copy2Win()
    {
        var mainCanvas = document.getElementById("mainSrc");
        destWin = window.open("","destWin");
        var destWinDoc = destWin.document;
        var destWinHTML = "<!DOCTYPE html><html><head><title>POPUP</title><body><div id='destWin' style='width:640px; height:480px; border:1px solid red'><img src='" + mainCanvas.toDataURL() + "' alt='Copy!' /></div></body></html>";
        destWinDoc.write(destWinHTML);          
    } 
```

需要注意的是，我正在将 img 标记的 src 写为 canvas.toDataURL()，这很有效。IE 不会抱怨这一点。虽然数据没有进入另一个画布，但我能够得到我需要的东西，这是我从画布中提取并显示在新窗口中的图像数据。有趣的是，如果您查看生成的源代码，图像实际上显示为 src 中的 base64 编码数据，因此浏览器似乎正在解码 src 数据以进行显示；有趣的。

# php - 创建mysql数据库表的语法错误

> ID：12846511
> 
> 赞同：1
> 
> 时间：2012-10-11T18:51:14.363
> 
> 标签：php, html, mysql

```
CREATE TABLE items (
'itemnumber' int(10) NOT NULL AUTO_INCREMENT,
'itemname' varchar(255),
'slot' varchar(255),
'level' varchar(255),
'class' varchar(255),
'white1' varchar(255),
'white2' varchar(255),
'white3' varchar(255),
'purple1' varchar(255),
'purple2' varchar(255),
'purple3' varchar(255),
'id1' varchar(255),
'id2' varchar(255),
'id3' varchar(255),
'green1' varchar(255),
'green2' varchar(255),
'green3' varchar(255),
'icon' varchar(255),
'dateadded' varchar(255),
PRIMARY KEY ('itemnumber')
) ENGINE=MyISAM; 
```

返回以下内容：

> ERROR 1064 (42000)：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 2 行的 ''itemnumber' int(10) NOT NULL AUTO_INCREMENT, 'itemname' varchar(255), 'slot' va' 附近使用正确的语法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T18:53:44.410

您必须对字段使用反引号：

```
CREATE TABLE items (
`itemnumber` int(10) NOT NULL AUTO_INCREMENT, 
```

# mysql - 是什么导致我的 if 语句被跳过？

> ID：12846514
> 
> 赞同：0
> 
> 时间：2012-10-11T18:51:20.637
> 
> 标签：mysql, vb.net

我有一个嵌入式 IF 语句，应该在数据库查询之后执行。但是，我注意到在运行时根本没有评估整个语句（紧随其后的那个`While dbData.Read()`）。我究竟做错了什么？

**这是代码：**

```
Private Sub ButtonNew_Click(ByVal sender As System.Object, ByVal e As     System.EventArgs) Handles ButtonNew.Click

If TextBoxSearch.Text = "" Then
        MessageBox.Show("Sorry, you must enter an ACCOUNT# before proceeding!")
        TextBoxSearch.Focus()
    Else
        Try
            Dim dbConn As MySqlConnection
            dbConn = New MySqlConnection("Server=" & FormLogin.ComboBoxServerIP.SelectedItem & ";Port=3306;Uid=parts;Password=parts;Database=accounting")
            Dim account As Boolean = True
            If dbConn.State = ConnectionState.Open Then
                dbConn.Close()
            End If
            dbConn.Open()
            Dim dbQuery As String = "SELECT * FROM customer WHERE accountNumber = '" & TextBoxSearch.Text & "';"
            Dim dbData As MySqlDataReader
            Dim dbAdapter As New MySqlDataAdapter
            Dim dbCmd As New MySqlCommand
            dbCmd.CommandText = dbQuery
            dbCmd.Connection = dbConn
            dbAdapter.SelectCommand = dbCmd
            dbData = dbCmd.ExecuteReader
            While dbData.Read()
                If dbData.HasRows Then
                    'MessageBox.Show("Customer record already exists!")
                    Call recordExists()
                    account = False
                    Call lockForm()
                    TextBoxSearch.Focus()
                    Me.Refresh()
                Else
                    'dbData.Close()
                    account = True
                    TextBoxAccount.Text = TextBoxSearch.Text
                    TextBoxAccount.BackColor = Color.LightGray
                    TextBoxAccount.TabStop = False
                    Call unlockForm()
                    TextBoxLastName.Focus()
                    ButtonSubmit.Visible = True
                    Me.Refresh()
                End If
            End While
            dbData.Close()
            dbCmd.Dispose()
            dbAdapter.Dispose()
            dbConn.Close()
        Catch ex As Exception
            MessageBox.Show("A DATABASE ERROR HAS OCCURED" & vbCrLf & vbCrLf & ex.Message & vbCrLf & _
                        vbCrLf + "Please report this to the IT/Systems Helpdesk at Ext 131.")
        End Try
    End If

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:55:57.957

如果`dbData.Read()`返回`False`，则它不会进入您的循环，因此该`If`语句将不会被执行。如果没有要读取的行，则`Read`始终返回`False`，因此该`If`语句在其所在的位置是无用的。您需要将该`If`语句向上移动，以便 while 循环位于`If`块内：

```
If dbData.HasRows Then
    While dbData.Read()
        ' ...
    End While
Else
    ' ...
End If 
```

# java - Java 同步和重入锁

> ID：12846517
> 
> 赞同：1
> 
> 时间：2012-10-11T18:51:26.083
> 
> 标签：java, multithreading

当我们对一个对象进行同步时，这是一个重入锁吗？同步锁和重入锁之间有真正的区别吗？

亲切的问候，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T18:58:54.900

是的，按关键字锁定`synchronized`是可重入的。但是，它们之间的实现可能会有所不同。例如，在早期版本的 JVM 中，的实现比关键字`ReentrantLock`的吞吐量要好得多。`synchronized`实现是否或如何不同取决于 JVM 实现/版本。

一般来说，`synchronized`如果您不需要该类`ReentrantLock`提供的其他功能，我倾向于建议使用关键字。但这最终是一种偏好。

# java - 如何在 DefaultMutableTreeNode 上获得鼠标侦听器？

> ID：12846518
> 
> 赞同：1
> 
> 时间：2012-10-11T18:51:27.410
> 
> 标签：java, jtree, mouselistener

我知道我可以将 mouseListener 添加到 Jtree，但我需要双击他的一个元素并 doSomething();

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T18:57:31.697

从[JTree 的文档中](http://docs.oracle.com/javase/6/docs/api/javax/swing/JTree.html)：

> 如果您有兴趣检测双击事件或用户单击节点时，无论它是否被选中，我们建议您执行以下操作：

```
final JTree tree = ...;

 MouseListener ml = new MouseAdapter() {
     public void mousePressed(MouseEvent e) {
         int selRow = tree.getRowForLocation(e.getX(), e.getY());
         TreePath selPath = tree.getPathForLocation(e.getX(), e.getY());
         if(selRow != -1) {
             if(e.getClickCount() == 1) {
                 mySingleClick(selRow, selPath);
             }
             else if(e.getClickCount() == 2) {
                 myDoubleClick(selRow, selPath);
             }
         }
     }
 };
 tree.addMouseListener(ml); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T18:55:46.130

检查这个： -

```
 public class NetworkTree extends JPanel implements TreeSelectionListener {
  private JTree tree;
  private static int PANEL_WIDTH=250;
  private static int PANEL_HEIGHT=500;
private static String lineStyle = "Horizontal";

public NetworkTree() {
DefaultMutableTreeNode top = new DefaultMutableTreeNode(new Site(
                1,1,"Network","",3));
getSubNodes(top,0);
tree = new JTree(top);
tree.getSelectionModel().setSelectionMode(TreeSelectionModel.SINGLE_TREE_SELECTION);
tree.addTreeSelectionListener(this);
JScrollPane treeView = new JScrollPane(tree);
add(treeView);

tree.addMouseListener(new MouseAdapter() {
  public void mouseClicked(MouseEvent me) {
    newNodeSelected();
  }
});
 }
.....
    public void newNodeSelected() {
   JOptionPane.showMessageDialog(null,"Hello");
} 
```

..... }

# objective-c - 如何获取 NSTableView 中选定行内的元素？

> ID：12846529
> 
> 赞同：9
> 
> 时间：2012-10-11T18:52:12.633
> 
> 标签：objective-c, cocoa, nstableview, nstextfield

我有一个包含两列`NSTableView`的内容类型。`View Based`

我的对象结构如下：

```
Table View
    Table Column
        Table Cell View
            Text Field
    Table Column
        Table Cell View
            Popup Button 
```

对于选定的行，我想在特定列的选定行内获取一个元素。具体来说，我想获得`Text Field`所选行的第一列。

我有一个表格视图的出口，到目前为止我有所选行的索引，但仅此而已：

```
- (void)getSelectedTextField
{
    NSInteger selected = [tableView selectedRow];
} 
```

关于如何解决这个问题的任何想法？

**编辑**：这就是我想要做的：我想将文本字段更改为处于编辑状态并专注于它，以便用户可以在选择文本字段值后立即开始编辑

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-11T22:08:06.733

我似乎已经解决了我自己的问题：

```
- (void)getSelectedTextField
{
    NSInteger selected = [tableView selectedRow];

    // Get row at specified index
    NSTableCellView *selectedRow = [tableView viewAtColumn:0 row:selected makeIfNecessary:YES];

    // Get row's text field
    NSTextField *selectedRowTextField = [selectedRow textField];

    // Focus on text field to make it auto-editable
    [[self window] makeFirstResponder:selectedRowTextField];

    // Set the keyboard carat to the beginning of the text field
    [[selectedRowTextField currentEditor] setSelectedRange:NSMakeRange(0, 0)];
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-11-12T10:21:03.377

使用可以通过获取其子视图来获取表格视图单元格的所有元素。建议使用前显示日志列表子视图

```
NSInteger index = [self.tableViewFiles selectedRow];

// Get row at specified index of column 0 ( We just have 1 column)
NSTableCellView *cellView = [self.tableViewFiles viewAtColumn:0 row:index makeIfNecessary:YES];

// Get row's checkBox ( at index 0, textFields is 1,2)
NSButton *checkBox = [[cellView subviews] objectAtIndex:0]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T21:46:38.920

如果文本字段是表格视图单元格的唯一子视图，您可以使用以下代码获取对它的引用，并选择其文本，以便可以进行编辑：

```
-(void)tableViewSelectionDidChange:(NSNotification *)notification {
   NSInteger row = [notification.object selectedRow];
   NSTextField *tf = [[[notification.object viewAtColumn:0 row:row makeIfNecessary:NO]subviews] lastObject];
   [tf selectText:tf.stringValue];
} 
```

# c++ - 实现资源目录的良好实践

> ID：12846530
> 
> 赞同：0
> 
> 时间：2012-10-11T18:52:13.180
> 
> 标签：c++, resources, cross-platform, qmake

我不确定这是否太笼统，所以如果是的话，我会说我在使用 qmake 的 Linux 上，但我希望能够在需要时使用我的项目从 Linux 切换到 Windows，以及可能的其他 PC。

为了做到这一点，我想知道这里的一些程序员是如何在不使用绝对路径定义的情况下使用资源目录的。对于 Qt，运行时工作目录似乎是应用程序的*构建*目录，而不是源目录。

理想情况下，我认为最好的解决方案是以某种方式获取 Resource 目录，因为它驻留在源目录中，并将其复制到相对的构建目录（即 Debug 或 Release，取决于开发阶段），以便应用程序可以通过运行。

然而，这可能会带来一些复杂性（至少，我认为它可以）。

无论如何，这样做有什么好的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T20:58:05.373

如果您使用的是 Qt。我建议使用部署过程。 [http://doc.qt.digia.com/qtcreator/creator-building-running.html](http://doc.qt.digia.com/qtcreator/creator-building-running.html)

基本上，您只需要声明需要复制哪些目录。构建过程完成后，qt 创建者会将这些目录复制到构建目录（发布/调试）。然后您只需运行可执行文件。

这是一个例子。 [https://github.com/longwei/incubator-cordova-qt](https://github.com/longwei/incubator-cordova-qt)。

在专业文件中

```
wwwDir.source = www
xmlDir.source = xml
qmlDir.source = qml

DEPLOYMENTFOLDERS = wwwDir xmlDir qmlDir 
```

第二

```
include(deployment.pri)
qtcAddDeployment() 
```

然后就完成了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:28:46.857

目前尚不清楚您到底想要实现什么，但也许一个简单的解决方案是构建脚本通过编译定义（`-D`使用 gcc）传递必要的路径。然后根据它是否是 Debug、Release 等构建，相应地设置定义，然后相应的二进制文件将具有正确的路径。

作为旁注，我尝试了 qmake 一段时间，但发现 SCons 更加通用。

# handlebars.js - TypeScript 定义函数的哈希表

> ID：12846533
> 
> 赞同：8
> 
> 时间：2012-10-11T18:52:29.087
> 
> 标签：handlebars.js, typescript

我正在尝试为 Handlebars 创建一个定义文件，以与预编译的车把脚本一起使用。Handlebars 会将预编译的脚本放入字符串索引的函数哈希表中，但我无法弄清楚或找到如何定义它。

一个假设的定义是：

```
declare module Handlebars {
    export var templates: { (model:any) => string; }[index: string];
} 
```

但这不是一个有效的定义。该定义应该适用于这样的调用：

```
var myHtml = Handlebars.templates["person-template"]({FNmae: "Eric"}); 
```

像这样的定义很*接近*：

```
export var templates: { (model:any) => string; }[]; 
```

但那是一个带有数字索引的数组，而且不是一回事，VS Intellisense 只是决定数组中的函数是*any*。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-11T18:57:20.437

您要使用的是具有索引签名的对象类型（请参阅规范第 3.5.3 节，特别是 3.5.3.3）。

```
declare module Handlebars {
    export var templates: {
        [s: string]: (model: any) => string;
    }
} 
```

# php - 单击提交按钮时执行php脚本

> ID：12846534
> 
> 赞同：-3
> 
> 时间：2012-10-11T18:52:29.773
> 
> 标签：php

> **可能重复：**
> [PHP 已发送的标头](https://stackoverflow.com/questions/8028957/headers-already-sent-by-php)

大家好...我是 PHP 新手，我正在尝试创建一个登录页面。我面临的问题是 If 条件中的标题给我错误，所以如果 $reg 和 $password 我无法重定向到下一页与数据库中的匹配。其次，你认为这是我在这段代码中做的最好的方式吗？对不起我的英语不好这是我的代码..

```
<?php

$reg=$_POST["reg"];
$password=$_POST["pwrd"];

$result=mysql_query("Select * from student where reg='$reg' and password='$password'");

if(!$result){
    die('errrrrrrrrrrrrror'.mysql_error());
}

while ($row = mysql_fetch_array($result)) {
    $db_reg=$row['reg'];
    $db_password=$row['password'];

}
if(isset($_POST['login'])){

 if($reg!=$db_reg || $password!=$db_password){
   echo 'login failed';    

}
//else if($reg=="" || $password!=""){
//  echo 'empty';
//}  
    else if($reg==$db_reg && $password==$db_password){

    header("Location:welcome.php");
    //echo 'weclome here'." ".$reg;

    }

}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T18:56:14.847

发送标头后您无法回显。

将欢迎信息移至welcome.php 并在标头函数后退出

```
header("Location: welcome.php");
exit(); 
```

# c# - C# WMI 远程进程执行

> ID：12846541
> 
> 赞同：3
> 
> 时间：2012-10-11T18:52:57.000
> 
> 标签：c#, .net, c#-4.0, wmi

我正在尝试运行一个调用 Win 2008 框上的批处理文件的命令。（当我登录Win 2008并单击时，命令运行成功）。

但是，当我使用相同的用户凭据通过 WMI 调用此批处理文件时，批处理不会执行。

我的连接代码是：

```
ConnectionOptions connOptions = new ConnectionOptions();
connOptions.Impersonation = ImpersonationLevel.Impersonate;
connOptions.EnablePrivileges = true;
connOptions.Username = UserName;
connOptions.Password = Password;

ManagementScope manScope = new ManagementScope(
    String.Format(@"\\{0}\ROOT\CIMV2", ComputerName), connOptions);
manScope.Connect();

ObjectGetOptions objectGetOptions = new ObjectGetOptions();
ManagementPath managementPath = new ManagementPath("Win32_Process");
ManagementClass processClass = new ManagementClass(
    manScope, managementPath, objectGetOptions);

ManagementBaseObject inParams = processClass.GetMethodParameters("Create");

inParams["CommandLine"] = command;
ManagementBaseObject outParams = processClass.InvokeMethod("Create", inParams, null);
Object returnValue = outParams["ReturnValue"]; 
```

任何帮助表示赞赏...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T03:26:52.120

通过 WMI 在远程计算机上实例化命令时，您需要指定显式凭据。WMI 增强了安全性，但这样做实际上降低了安全性，因为与令牌不同，显式凭据以明文方式传递它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-18T13:52:34.900

如果 ROOT\CIMV2 设置为服务器上脚本的默认命名空间，那么您只需要以下内容：

```
ManagementScope manScope = new ManagementScope(
    String.Format(@"\\{0}", ComputerName), connOptions);
manScope.Connect(); 
```

# bash - 在 Linux 中为文件重命名循环

> ID：12846542
> 
> 赞同：-1
> 
> 时间：2012-10-11T18:52:59.147
> 
> 标签：bash, loops

我正在尝试创建一个遍历目录的 for 循环，并重命名该目录中的每个文件。

```
dir2=$1

for i in $dir2
do
file=$(basename "$i")
b=${file%.*}
c=${file#"$stub"}
d=-BACKUP
e=$b$d$c
mv "$i" "$e" 
```

我正在尝试更改每个文件：i 变为 $e。

例如，如果我有一个目录，并且其中有一个名为 test.txt 的文件，则该文件将更改为 test-BACKUP.txt

我遇到的问题是它没有更改目录中的文件，而是更改了目录本身。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:56:28.383

```
for i in "$dir2/"*; do
    mv "$i" "${i%.*}-BACKUP.${i##*.}"
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T18:58:16.597

```
for i in *
do
  echo $i
  mv $i `basename $i`.new
done 
```

# java - 如何使用 System.currentTimeMillis() 在特定时间执行方法？

> ID：12846543
> 
> 赞同：0
> 
> 时间：2012-10-11T18:53:01.737
> 
> 标签：java, tcp

我有一个实时程序，我需要执行一个名为“execTask(Packet task)”的方法，只需要在某个 System.currentTimeMillis() 调用它。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:02:18.780

[`ScheduledExecutorService.schedule(Runnable command, long delay, TimeUnit unit)`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ScheduledExecutorService.html#schedule%28java.lang.Runnable,%20long,%20java.util.concurrent.TimeUnit%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:09:35.143

比你想要的多一点，但相当笼统（一旦有人清理了特定的东西）：

事件列表.java

```
/**
 * 
 */
package com.jodatosa.auction.timekeeper;

import java.util.concurrent.DelayQueue;

/**
 * @author db2admin
 *
 */
public class EventList {

    public static final int NO_EVENT = 0;
    public static final int SWITCH_ITEM_TO_POSTED = 1;
    public static final int SWITCH_ITEM_TO_CLOSED = 2;
    public static final int UNLOCK_REGISTERED_USER = 3;

    private DelayQueue<EventObject> eventList;

    public EventList() {
        eventList = new DelayQueue<EventObject>();
    }

    public void add(int eventType, long eventTime, int id) {
        eventList.put(new EventObject(eventType, eventTime, id));
    }

    public EventObject waitForNext() throws InterruptedException {
        return eventList.take();
    }

    public int size() {
        return eventList.size();
    }

    public EventObject peek() {
        return eventList.peek();
    }
} 
```

事件对象.java

```
package com.jodatosa.auction.timekeeper;

import java.util.concurrent.Delayed;
import java.util.concurrent.TimeUnit;

import com.jodatosa.auction.auditing.Trace;

public class EventObject implements Delayed {
    int eventType;
    long eventTime;
    int id;

    EventObject(int eventType, long eventTime, int id) {
        this.eventType = eventType;
        this.eventTime = eventTime;
        this.id = id;
    }

    public long getDelay(TimeUnit unit) {
        long delay = unit.convert(eventTime - System.currentTimeMillis(), TimeUnit.MILLISECONDS);
        if (unit == TimeUnit.MILLISECONDS) {
            Trace.message("EventObject.getDelay time unit = MILLISECONDS");
        }
        else if (unit == TimeUnit.MICROSECONDS) {
            Trace.message("EventObject.getDelay time unit = MICROSECONDS");
        }
        else if (unit == TimeUnit.NANOSECONDS) {
            Trace.message("EventObject.getDelay time unit = NANOSECONDS");
        }
        Trace.message("EventObject.getDelay returning " + delay);
        return delay;
    }

    public int compareTo(Delayed o) {
        EventObject comparand = (EventObject) o;
        if (this.eventTime < comparand.eventTime) {
            return -1;
        }
        else if (this.eventTime > comparand.eventTime) {
            return 1;
        }
        return 0;
    }
} 
```

计时员.java

```
/**
 * 
 */
package com.jodatosa.auction.timekeeper;

import java.sql.SQLException;

import com.jodatosa.auction.auditing.Trace;
import com.jodatosa.auction.controller.AuctionControl;
import com.jodatosa.auction.datastore.jdbc.TableConnection;
import com.jodatosa.auction.model.Item;
import com.jodatosa.auction.model.User;
import com.jodatosa.auction.util.AuctionProperties;

/**
 * @author db2admin
 *
 */
public class Timekeeper {

    private static EventList eventList;

    public Timekeeper() {
        // TODO
    }

    public static void initializeEventList() throws SQLException {

        eventList = new EventList();

        long currentTime = System.currentTimeMillis();

        // Scan Users for locked Users and extract the time locked
        User user = User.findByStatus(User.ACCOUNT_DISABLED_FOR_LOGIN);
        if (user != null) {
            long currentTimePlus2 = System.currentTimeMillis() - AuctionProperties.getTimeForLockedUserToUnlock();
            do {

                // Compare time locked + 2 days to current time
                if (user.getTime_locked_for_failed_logins() < currentTimePlus2) {
                    Trace.message("Timekeeper.initializeEventList: Unlocking user " + user.getUser_name() + ", locked at time " + user.getTime_locked_for_failed_logins());
                    // Immediately unlock those where time has expired.
                    AuctionControl.unlockRegisteredUser(user.getUser_id());
                }
                else {
                    // For those not expired, enter an event into the event list.
                    int eventType = EventList.UNLOCK_REGISTERED_USER;
                    long eventTime = user.getTime_locked_for_failed_logins() + AuctionProperties.getTimeForLockedUserToUnlock();
                    int userId = user.getUser_id();
                    Trace.message("Timekeeper.initializeEventList: Adding event type " + eventType + " for user " + user.getUser_name() + " at time " + eventTime);
                    eventList.add(eventType, eventTime, userId);
                }

            } while (user.next());
        }

        // Scan Items.  Extract item status, time to post, and time to close.
        // For items not yet posted, check time to post and either set status to posted or add to event list.
        // For posted items not yet closed, check time to close and process similarly.
        Item item = Item.getAll();

        if (item != null) {
            boolean more = true;
            do {
                int itemId = item.getItem_id();
                int status = item.getStatus();
                Trace.message("Timekeeper.initializeEventList: Examining item #" + itemId + " with status " + status);
                int oldStatus = status;
                long eventTime = 0;
                int eventType = EventList.NO_EVENT;
                if (status == Item.STATUS_NOT_POSTED) {
                    long timeToPost = item.getTime_to_post();
                    if (timeToPost < currentTime) {
                        // Switch status to posted
                        status = Item.STATUS_POSTED;
                    }
                    else {
                        // Add item to event list
                        eventTime = timeToPost;
                        eventType = EventList.SWITCH_ITEM_TO_POSTED;
                    }
                }
                if (status == Item.STATUS_POSTED) {
                    long timeToClose = item.getTime_to_close();
                    if (timeToClose < currentTime) {
                        // Switch status to closed
                        status = Item.STATUS_CLOSED;
                    }
                    else {
                        // Add item to event list
                        eventTime = timeToClose;
                        eventType = EventList.SWITCH_ITEM_TO_CLOSED;
                    }
                }

                // If item status changed, update item
                if (status != oldStatus) {
                    Trace.message("Timekeeper.initializeEventList: Changing item #" + itemId + " status " + oldStatus + " to " + status);
                    Item updateItem = Item.getByItemIdForUpdate(itemId);
                    if (updateItem == null) {
                        Trace.error("Could not find item #" + itemId + " to update");
                    }
                    else {
                        updateItem.setStatus(status);
                        updateItem.update();
                        TableConnection.commit();
                    }
                }

                // If event type set, register new event to occur.
                if (eventType != EventList.NO_EVENT) {
                    Trace.message("Timekeeper.initializeEventList: Adding event type " + eventType + " for item #" + itemId + " at time " + eventTime);
                    eventList.add(eventType, eventTime, itemId);
                }

                // Advance to next entry
                more = item.next();
            } while(more);
        }

        // TODO -- Dutch auction
    }

    public static Thread startTimerThread() {
        TimerThread timerThread = new TimerThread(eventList);
        timerThread.setName("AuctionTimerThread");
        timerThread.setDaemon(true);
        timerThread.start();
        Trace.message("Timekeeper.startTimerThread completed");
        return timerThread;
    }

    public static void endTimerThread(Thread timerThread) {
        timerThread.interrupt();
    }

    public static void addAuctionStart(int auctionId, long postTime) {
        eventList.add(EventList.SWITCH_ITEM_TO_POSTED, postTime, auctionId);
    }

    public static void addAuctionClose(int auctionId, long closeTime) {
        eventList.add(EventList.SWITCH_ITEM_TO_CLOSED, closeTime, auctionId);
    }

    public static void addRegisteredUserLocked(int userId, long lockTime) {
        eventList.add(EventList.UNLOCK_REGISTERED_USER, lockTime + AuctionProperties.getTimeForLockedUserToUnlock(), userId);
    }
} 
```

TimerThread.java

```
/**
 * 
 */
package com.jodatosa.auction.timekeeper;

import java.sql.SQLException;

import com.jodatosa.auction.auditing.Trace;
import com.jodatosa.auction.controller.AuctionControl;

/**
 * @author db2admin
 *
 */
public class TimerThread extends Thread implements Runnable {

    private EventList eventList;

    public TimerThread(EventList eventList) {
        this.eventList = eventList;
    }

    /* (non-Javadoc)
     * @see java.lang.Runnable#run()
     */
    public void run() {
        Trace.message("TimerThread.run starting");
        try {
            while(true) {
                Trace.message("TimerThread.run: EventList size = " + eventList.size());
                EventObject peekObject = eventList.peek();
                if (peekObject == null) {
                    Trace.message("TimerThread.run: EventList peek = null");
                }
                else {
                    Trace.message("TimerThread.run: EventList peek = " + peekObject.eventType + ", " + peekObject.eventTime + ", " + peekObject.id);
                }
                EventObject eventObject = eventList.waitForNext();
                Trace.message("TimerThread.run: EventObject type " + eventObject.eventType + " being processed");
                if (eventObject.eventType == EventList.SWITCH_ITEM_TO_POSTED) {
                    Trace.message("TimerThread: Switch Item to POSTED");
                    try {
                        AuctionControl.startAuction(eventObject.id);
                    } 
                    catch (SQLException ex) {
                        Trace.error("TimerThread:  AuctionControl.startAuction failed with exception " + ex.toString());
                        Trace.exception(ex);
                    }
                }
                else if (eventObject.eventType == EventList.SWITCH_ITEM_TO_CLOSED) {
                    Trace.message("TimerThread: Switch Item to CLOSED");
                    try {
                        AuctionControl.endAuction(eventObject.id);
                    } 
                    catch (SQLException ex) {
                        Trace.error("TimerThread:  AuctionControl.endAuction failed with exception " + ex.toString());
                        Trace.exception(ex);
                    }
                }
                else if (eventObject.eventType == EventList.UNLOCK_REGISTERED_USER) {
                    Trace.message("TimerThread: Unlock registered user");
                    try {
                        AuctionControl.unlockRegisteredUser(eventObject.id);
                    }
                    catch (SQLException ex) {   
                        Trace.error("TimerThread:  AuctionControl.unlockRegisteredUser failed with exception " + ex.toString());
                        Trace.exception(ex);
                    }
                }
                else {
                    Trace.error("TimerThread: Unrecognized event type " + eventObject.eventType);
                }
            }
        }
        catch (InterruptedException ex) {
            Trace.message("TimerThread interrupted");
            return;
        }
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T18:56:05.883

查看[Quartz](http://quartz-scheduler.org/)调度程序。我假设您是在 Java 中执行此操作的？

# php - 检查数据库并重定向到特定页面

> ID：12846547
> 
> 赞同：0
> 
> 时间：2012-10-11T18:53:27.767
> 
> 标签：php, codeigniter, codeigniter-2

如果检查的管理员登录正确，它应该重定向到仪表板页面，但如果管理员登录正确或不正确，它将转到仪表板页面。如果不正确，则应转到登录页面。

这是代码

```
<?php 
class Validate extends CI_Model
{
    public function checkdatabase()
    {
        $username=$_POST['username'];
        $password=$_POST['password'];
        //echo $username;
        $this->load->database();
         $query ="select * from adminlogin where name='$username' AND password='$password'";
    $value = $this->db->query($query);
    $data = $value->result();
    return $data;

    }
}
?> 
```

这是控制器中的条件

```
if($value=$this->validate->checkdatabase()){
    redirect('dashboard', 'refresh');
    }else{
    $this->load->view('admin/login');
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:31:27.667

您可以尝试以下

```
`
    $value=$this->validate->checkdatabase();
    如果（isset（$值））{
        重定向（“仪表板”，“刷新”）；
    }别的{
        $this->load->view('admin/login');
    }
`

```

@[我的代码程序](http://mycodeprograms.blogspot.in/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T23:04:19.520

你做事的方式确实有点错误，首先在我看来，你没有自动加载数据库库，几乎任何 CI 站点都将使用该库，所以通常不让它自动加载是没有意义的。

接下来，正如其他人所说，您根本没有对输入进行清理，让您自己打开以供注入，并考虑到这是您完全打开的登录。CI 的输入包装器会为您处理这些，请参见下面的代码。

您也没有检查返回值是什么，并且登录时您总是检查单个返回值。

```
<?php 
class Validate extends CI_Model
{
    public function checkdatabase()
    {
        $username=$this->input->post('username');
        $password=$this->input->post('password'); //and honestly this is taking a plain text password... not a good thing.
        //echo $username;
        $this->load->database();  //again, do this in the autoload.php
         $query ="select * from adminlogin where name='$username' AND password='$password'";
    $value = $this->db->query($query);
    if($value->num_rows()==1)
    {
        $data = $value->result();
        return $data;
    } else {
        return false;
    }
} 
```

我在输入此内容后看到您已经开始工作，这里仍然有一些您应该考虑的有效点，所以无论如何我都会发布它。

# php - 向上传的文件添加随机数

> ID：12846552
> 
> 赞同：0
> 
> 时间：2012-10-11T18:53:43.053
> 
> 标签：php, ajaxuploader

我正在使用 Valum 的 Ajax-Uploader 脚本将文件上传到我的服务器。因为上传的文件很有可能具有相同的名称，所以我在文件名中添加了一个随机数。问题是 ajax 上传器将原始文件名返回到`input[type=text]`而不是添加了随机数的新文件名中。我试过`echo $file;`代替`echo "success";`，但所发生的只是文件已上传，并且脚本返回并弹出错误。

```
jQuery(function() {
    var url = "http://example.com/uploads/samples/";
    var button = jQuery('#up');
    new AjaxUpload(button, {
        action: 'upload.php',
        name: 'upload',
        autoSubmit: true,
        onSubmit: function(file, ext) {
            // do stuff while file is uploading
        },
        onComplete: function(file, response) {
            if (response === "success") {
                $('input[type=text]').val(url + file);
            } else {
                jAlert('Something went wrong!', 'Error!');
            }
        }
    });
}); 
```

**上传.php**

```
<?php
    $uploaddir = '/path/to/uploaddir/'; 
    $file = basename($_FILES['file']['name']);

     if($_FILES['file']['name']) {
      $file = preg_replace('/\s+/', '_', $file);
      $rand = rand(0000,9999);

      if (move_uploaded_file($_FILES['file']['tmp_name'], $uploaddir . $rand . $file)) { 
            echo "success";
        } else {
            echo "error";
        }
    }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:19:28.480

改变

```
$('input[type=text]').text(url + file); 
```

到

```
$('input[type=text]').val(url + file); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:27:01.473

我想建议使用日期和时间来创建一个唯一的随机数。你可以在你的代码中使用以下函数，我完全信任这个函数，因为我已经在我的项目中使用了它。

```
`
    /**
    * 此函数返回唯一字符串作为键
    */
    公共静态函数 getUniqueKey(){      
        $currentDateTime = date("YmdHisu");
        返回 $currentDateTime 。BTITTools::createRandomString(3);
    }
`

```

@[我的代码程序](http://mycodeprograms.blogspot.in/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T20:03:03.867

客户端代码和服务器代码完全独立存在。基本上，您的 JavaScript 代码无法知道您的 PHP 代码刚刚做了什么。`url`当您在 PHP 文件中更改它时，它不会自动更新。

另一种解决方案是让您的 PHP 代码回显新文件名，或回显错误消息。

例如：

**PHP**

```
<?php
if (move_uploaded_file($_FILES['file']['tmp_name'], $uploaddir . $rand . $file)) {   
    // Everything went well! Echo the dollar sign ($) plus the new file name
    echo '$' . $_FILES['file']['tmp_name'], $uploaddir . $rand . $file;   
} else {  
    echo "error";  
}  
?> 
```

**JS**

```
onComplete: function(file, response) { 
    // If the first character of the response is the "$" sign
    if (response.substring(0,1) == "$") { 
        $('input[type=text]').val(response.substring(1));
    } else { 
        jAlert('Something went wrong!', 'Error!'); 
    } 
} 
```

# c# - 要根据下拉列表中的选定项显示控件？

> ID：12846554
> 
> 赞同：0
> 
> 时间：2012-10-11T18:53:48.053
> 
> 标签：c#, asp.net

对于 Dropdownlist 项目，我编写了以下代码：

```
 protected void dropdowndatasrc()
{
    con = new OleDbConnection(ConfigurationManager.ConnectionStrings["ConnectionString"].ToString());
    string command = "select eventname from Events";
    cmd = new OleDbCommand(command);
    dataadapter = new OleDbDataAdapter(command, con);
    DataSet dataset = new DataSet();
    con.Open();
    DataTable dt = new DataTable("PayEvent");
    dataadapter.Fill(dt);
    DropDownList4.DataSource = dt;
    DropDownList4.DataTextField = dt.Columns[0].ToString();
  //  DropDownList4.DataValueField = dt.Columns[0].ToString();
   DropDownList4.DataBind();
} 
```

我必须根据下拉列表的值显示控件（在访问数据库中有一个名为 payevent 的列，如果数据库中的选定项目具有“是”，则它具有是/否数据类型意味着显示控件，如果不是没有控件必须显示）

我试过这段代码但没有用

```
protected void DropDownList4_SelectedIndexChanged(object sender, EventArgs e)
{

    TextBox11.Text = DropDownList4.SelectedItem.Text;
    con = new OleDbConnection(ConfigurationManager.ConnectionStrings["ConnectionString"].ToString());
    string query = "select payevent from Events where  eventname=@dropdownlist";
    con.Open();
    //string query="select payevent from Events";
    cmd = new OleDbCommand(query, con);
    cmd.Parameters.Add("@dropdownlist", selectedtext);
    OleDbDataReader reader = cmd.ExecuteReader();

    while (reader.Read())
    {
        string value = reader.GetValue((0)).ToString();
        TextBox11.Text = value.ToString();
        if (value == "True" || value == "true")
        { pnl.Visible = false; }
        else if (value == "False" || value == "false")
        { pnl.Visible = true; }

    }
} 
```

**表结构如下：**

```
**eventname             payevent**
Work Shop       Yes
emsisoft workshop   Yes
ECE             No
CSE             No 
```

需要帮忙 ！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:07:13.067

通常的问题是您在回发后再次在下拉列表上进行数据绑定并且值丢失。因此，在页面加载时，不要将`dropdowndatasrc`on post 调用为：

```
if(!IsPostBack)
  dropdowndatasrc(); 
```

同样的问题：[下拉列表没有选择值 asp.net](https://stackoverflow.com/questions/12832344/dropdown-list-not-selecting-value-asp-net/12832949#12832949)

# linux - 如何记录由“screen”命令生成的会话的输出？

> ID：12846557
> 
> 赞同：0
> 
> 时间：2012-10-11T18:53:51.480
> 
> 标签：linux, bash, shell, gnu-screen

我同时在同一目录中运行多个 Screen 会话。

当某个会话中的程序完成后，该会话自动终止。但是，我需要检查会话的输出。所以我尝试使用“screen -L”来保存日志。但是，所有会话的输出都记录到一个文件*screenlog.0*中（一个会话的几行，然后另一个会话的几行......这是无法读取的）。

有没有办法将不同的会话记录到不同的日志文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:58:25.397

例如，您可以使用`logfile`screenrc 中的命令。

# javascript - 谷歌浏览器网络请求冲突？

> ID：12846563
> 
> 赞同：1
> 
> 时间：2012-10-11T18:54:05.480
> 
> 标签：javascript, google-chrome, google-chrome-extension, webrequest

有人可以向我解释为什么以及如果在访问网页时以下代码不会总是连续两次提醒相同的值，假设在警报框上单击“确定”会有一点延迟，这是否是所需的行为？

在 background.js 中使用以下代码设置通常的简单扩展：

```
chrome.webRequest.onBeforeRequest.addListener(function(request) {
    alert(request.requestId);
    alert(request.requestId);
    return {};
}, {urls: ["*://*/*"]}, ["blocking"]); 
```

我就是无法得到这个。我需要相同的值弹出两次，因为我将执行 AJAX 请求，并且我不能允许自己在背后改变变量，因为 AJAX 可能会延迟......

如果这是所需的行为，我如何确保不会发生这种情况？关闭会有帮助吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T15:59:43.630

最可能的原因是弹出窗口来自同时发生的两个不同请求。例如，每个底层 HTTP 请求可以有多个请求。`console.log()`您可以通过该功能登录，而不是使用弹出窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T18:56:33.727

```
var rId = request.requestId;
alert(rId);
alert(rId); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T22:51:12.640

那这个呢？？？

```
var rId = request.requestId.toString();
alert(rId);
alert(rId); 
```

# regex - 带有查找命令的正则表达式

> ID：12846565
> 
> 赞同：6
> 
> 时间：2012-10-11T18:54:19.170
> 
> 标签：regex, linux, find

我正在尝试使用 find 命令，`-regextype`但它无法正常工作。

我正在尝试在这些文件中查找所有文件`c`并将`h`它们发送到管道和 grep 名称`func_foo`。我错过了什么？

```
$ find ./ -regextype sed -regex ".*\[c|h]" | xargs grep -n --color func_foo 
```

同样在类似的方面，我尝试了以下命令，但它给了我一个错误，例如路径必须在表达式之前：

```
$ find  ./  -type  f  "*.c"  |  xargs  grep  -n  --color  func_foo 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-04-21T22:57:12.103

接受的答案包含一些不准确之处。在我的系统上，GNU find 的联机帮助页说要运行`find -regextype help`以查看支持的正则表达式类型列表。

```
# find -regextype help
find: Unknown regular expression type 'help'; valid types are 'findutils-default', 'awk', 'egrep', 'ed', 'emacs', 'gnu-awk', 'grep', 'posix-awk', 'posix-basic', 'posix-egrep', 'posix-extended', 'posix-minimal-basic', 'sed'. 
```

例如`find . -regextype egrep -regex '.*\.(c|h)'`查找`.c`和`.h`文件。您的正则表达式语法错误，您使用方括号而不是括号。使用方括号，它将是`[ch]`.

您也可以使用默认的正则表达式类型：`find . -regex '.*\.\(c\|h\)$'`也可以。请注意，在这种情况下，您必须转义`(`, `|`,`)`字符（也使用`sed`regextype）。`egrep`使用, `posix-egrep`,时不必转义它们`posix-extended`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T19:12:44.367

为什么不这样做：

```
find ./ -name "*.[c|h]" | xargs grep -n --color func_foo 
```

和

```
find ./ -type f -name "*.c" | xargs grep -n --color func_foo 
```

* * *

关于`find`'s option的有效参数，`-regextype`这逐字来自`man find`：

> -regextype 类型
> 
> 更改稍后在命令行中出现的 -regex 和 -iregex 测试所理解的正则表达式语法。当前实现的类型是 emacs（这是默认值）、posix-awk、posix-basic、posix-egrep 和 posix-extended

没有类型`sed`。

# java - 适合java中大文本存储和计数的表

> ID：12846567
> 
> 赞同：3
> 
> 时间：2012-10-11T18:54:31.190
> 
> 标签：java, data-structures, string-comparison

我想实现这个。我将读取一个 .txt 文件，然后将其从大写字母转换为另一个 .txt 文件中的小写字母。然后我必须计算它们，以便找到最常见的字母或单词。我的问题是我应该使用什么样的表？我应该使用哈希表还是映射表？.txt 文件有大约 5000000 个字母单词句子。如果我想存储比较、计数和转换大文件，我必须使用什么表，以便我可以快速检索它。我有一个哈希表

```
 HashMap<String, String> hm = new HashMap<String, String>(); 
```

还是我应该用其他方式来做？或者我应该使用链表？我如何为句子或单词实现它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T18:59:58.440

如果要数字母，a`Map<Character, Long>`甚至`Map<Character, BigInteger>`似乎更合适。具体的实现并不那么重要。如果您的字母集已定义并减少（例如拉丁字母），您甚至可以使用`BigInteger[]`，每个字母都可以轻松地替换为其在数组中的顺序。

对于这些数字中的句子或单词，我会选择一种数据库方法，每个要计算的值对应一行。

更新：具有数据结构的单词和句子的另一种方法可能是使用树。rood 节点是空词，如果你从 root 中找到“dad”，你会得到孩子“d”，它的孙子“a”和它的曾孙“d”，此时你将 1 添加到最后一个节点的指针（当然，如果缺少任何节点，则必须创建它们）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T20:03:39.883

`Map`对于每个要求，您都需要一个。对于句子：

```
Map<String, Integer> sentences = new HashMap<String, Integer>(); 
```

对于单词，相同：

```
Map<String, Integer> words = new HashMap<String, Integer>(); 
```

最后，对于字符，使用以下内容：

```
Map<Character, Integer> chars = new HashMap<String, Integer>(); 
```

`HashMap`应该是`Map`您使用的实现，因为您将在这些地图中进行大量搜索。计数过程确实很适合多个线程，因此`Map`如果您决定采用这种方法，则可能需要线程安全。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T18:13:22.993

看看这里 [http://www.ntu.edu.sg/home/ehchua/programming/java/J5c_Collection.html#zz-2.6](http://www.ntu.edu.sg/home/ehchua/programming/java/J5c_Collection.html#zz-2.6)
和这里[http://www.ntu.edu.sg/home/ehchua/programming /java/J5c_Collection.html#zz-4](http://www.ntu.edu.sg/home/ehchua/programming/java/J5c_Collection.html#zz-4)。在这里[http://www.javapractices.com/topic/TopicAction.do?Id=65](http://www.javapractices.com/topic/TopicAction.do?Id=65) 我认为 bset 在这里[http://www.javamex.com/tutorials/collections/how_to_choose.shtml](http://www.javamex.com/tutorials/collections/how_to_choose.shtml)。玩得开心

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T19:08:59.417

我想建议您可以使用数据库方法，也可以使用 map 来处理插入或更新计数方法。

```
Map<String, boolean>
```

.

您还可以使用批处理来一次处理多个查询。

# c++ - 从函数访问类

> ID：12846568
> 
> 赞同：0
> 
> 时间：2012-10-11T18:54:32.777
> 
> 标签：c++, qt

除了在类内声明一个静态方法以从类外调用它之外，还有其他方法吗？

这是我的代码（请参阅标记为评论的问题）

```
#include "mainwindow.h"
#include "ui_mainwindow.h"

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);
}

MainWindow::~MainWindow()
{
    delete ui;
}

_stdcall BOOL EnumWindowsProc(HWND hw,LPARAM lp)
{
    char title[255];

    memset(title,0,255);
    GetWindowTextA(hw,title,255);

    qDebug() << title << endl;

     // How can I access class MainWindow from this function ?   

    return true;
}

void MainWindow::on_pushButton_clicked()
{
    EnumWindows(&EnumWindowsProc,0);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T18:57:37.447

在 Windows 世界中执行此操作的典型方法是将指针传递给 Enum 函数，如下所示：

```
void MainWindow::on_pushButton_clicked()
{
    EnumWindows(&EnumWindowsProc,reinterpret_cast<void*>(this));
} 
```

...然后在回调中将其转换回：

```
_stdcall BOOL EnumWindowsProc(HWND hw,LPARAM lp)
{
    char title[255];

    memset(title,0,255);
    GetWindowTextA(hw,title,255);

    qDebug() << title << endl;

     // How can I access class MainWindow from this function ?   

MainWindow* that = reinterpret_cast<MainWindow*>(lp);

    return true;
} 
```

# android - 具有 Windows 身份验证和各种客户端的 WCF 服务

> ID：12846569
> 
> 赞同：0
> 
> 时间：2012-10-11T18:54:33.697
> 
> 标签：android, asp.net, active-directory, wcf-security

我正在开始一个包含三层的项目：Web 前端、移动前端和 WCF 后端。身份验证需要通过 Active Directory 完成，但两个 Web 前端都将使用表单身份验证来授予/拒绝对某些区域的访问权限，并且所有用户控制都将通过 AD 内的组进行处理。这特别适用于我希望能够利用内置 Permission.Demand() 功能的 WCF 端。

我有两个问题。首先，有人知道这样做的最佳实践示例吗？特别是关于将凭据（没有密码）传递给 WCF 服务，以便它知道正在访问它的上下文。其次，未来包括创建一个 Android 应用程序（可能还有 iPhone/Windows Phone 版本），所以我需要确保使用的方法可以跨平台使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:44:48.170

将 PrincipalPermissionMode 设置为 Custom，编写自定义授权策略 (http://msdn.microsoft.com/en-us/library/ms729794.aspx) 并在 Evaluate 方法的实现中执行以下操作：

```
 evaluationContext.Properties["Principal"]=HttpContext.Current.User; 
```

[http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/8f424d4f-2f47-4f85-a6b0-00f7e58871f1/](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/8f424d4f-2f47-4f85-a6b0-00f7e58871f1/)

# ios - 使用情节提要将用户发送到视图控制器

> ID：12846570
> 
> 赞同：0
> 
> 时间：2012-10-11T18:54:33.447
> 
> 标签：ios, xcode, cocoa-touch, storyboard

我在我的应用程序委托中使用以下代码将用户发送到正确的视图控制器：

```
BOOL user = [[NSFileManager defaultManager] fileExistsAtPath:userFile];
NSString *identifier = user ? @"in" : @"out";
UIStoryboard *storyBoard = [[self.window rootViewController] storyboard];
UIViewController *viewController = [storyBoard instantiateViewControllerWithIdentifier:identifier];
[self.window setRootViewController:viewController]; 
```

现在我正在尝试使用登录视图控制器中的代码，但我没有 self.window 引用，所以代码不起作用。如何将用户发送到特定的视图控制器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:09:04.420

持有对窗口的引用的是视图，而不是控制器。试试`self.view.window`吧。

# asp.net-mvc - WebGrid 中的下拉列表 - MVC4

> ID：12846572
> 
> 赞同：3
> 
> 时间：2012-10-11T18:54:35.840
> 
> 标签：asp.net-mvc, webgrid

有人可以告诉我我在下拉列表视图中做错了什么吗？我认为它期望 SelectList 用于下拉列表？先感谢您。

我的模型：

```
public class AppointmentModel
    {
        public int CustomerID { get; set; }
        public string LastName { get; set; }
        public string FirstName { get; set; }        
        public List<DateTime> ApptDates { get; set; }
    } 
```

看法：

```
@{
    var grid = new WebGrid(Model, rowsPerPage: ViewBag.RowsPerPage);    
    @grid.GetHtml(columns: grid.Columns(
        grid.Column(columnName: "LastName", header: "Last Name", canSort: true, format: @<text>@item.LastName</text>),
        grid.Column(columnName: "LastName", header: "First Name", canSort: true, format: @<text>@item.Firstname</text>),
        grid.Column(columnName: "ApptDates", header: "Appointment Dates", format: @Html.DropDownList(@item.ApptDates))
        ));                                             
} 
```

以下更改解决了该问题：

```
public class AppointmentModel
    {
        public int CustomerID { get; set; }
        public string LastName { get; set; }
        public string FirstName { get; set; }        
        public DateTime ApptDt { get; set; }
        public IEnumerable<SelectListItem> ApptDatesSelectList { get; set; }
    } 
```

看法

```
@{
    var grid = new WebGrid(Model, rowsPerPage: ViewBag.RowsPerPage);    
    @grid.GetHtml(columns: grid.Columns(
        grid.Column(columnName: "LastName", header: "Last Name", canSort: true, format: @<text>@item.LastName</text>),
        grid.Column(columnName: "LastName", header: "First Name", canSort: true, format: @<text>@item.Firstname</text>),
        grid.Column(columnName: "ApptDates", header: "Appointment Dates", format: @<text>@Html.DropDownList("ApptDt", (IEnumerable<SelectListItem>)@item.ApptDatesSelectList)</text>)
        ));                                             
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T19:05:56.733

假设我的评论的答案是每个约会都有一个日期，您首先需要在特定日期为您的模型添加一个属性：

```
public class AppointmentModel
    {
        public int CustomerID { get; set; }
        public string LastName { get; set; }
        public string FirstName { get; set; }
        public DateTime AppointmentDate {get; set;}        
        public List<DateTime> ApptDates { get; set; }
    } 
```

然后，您将需要您的潜在约会，`SelectList`一旦您这样做了，您可以像这样实施：

```
@{
    var grid = new WebGrid(Model, rowsPerPage: ViewBag.RowsPerPage);    
    @grid.GetHtml(columns: grid.Columns(
        grid.Column(columnName: "LastName", header: "Last Name", canSort: true, format: @<text>@item.LastName</text>),
        grid.Column(columnName: "LastName", header: "First Name", canSort: true, format: @<text>@item.Firstname</text>),
        grid.Column(columnName: "ApptDates", header: "Appointment Dates", format: @<text> @Html.DropDownList(@item.AppointmentDate, yourSelectList )</text>)
        ));                                             
} 
```

# c# - 保持对结构的引用或以其他方式重构此代码？

> ID：12846573
> 
> 赞同：1
> 
> 时间：2012-10-11T18:54:37.030
> 
> 标签：c#, reference, refactoring

我有这个代码：

```
BigInteger lhs = new BigInteger(0);
BigInteger rhs = new BigInteger(0);

bool isLeftHandSide = true;

for (int i = 0; i < txtResult.Text.Length; i++)
{
    char currentCharacter = txtResult.Text[i];

    if (char.IsNumber(currentCharacter))
    {
        char currentCharacter = txtResult.Text[i];

        if (isLeftHandSide)
        {
            lhs += (int)char.GetNumericValue(currentCharacter);
        }
        else
        {
            rhs += (int)char.GetNumericValue(currentCharacter);
        }
    }
} 
```

我想知道是否有一种方法可以存储对当前端的引用，以便我可以直接操作该变量并摆脱 if 和 else 语句。我希望能够在不使用不安全代码上下文的情况下做到这一点。

像替换这个：

```
if (isLeftHandSide)
{
    lhs += (int)char.GetNumericValue(currentCharacter);
}
else
{
    rhs += (int)char.GetNumericValue(currentCharacter);
} 
```

有了这个：

```
currentSide += (int)char.GetNumericValue(currentCharacter); 
```

currentSide 是对 lhs 或 rhs 的引用。因为它们是结构，所以我不确定如何保留对它的引用，而不仅仅是复制数据。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T19:30:47.823

您所需要的只是一个包装类来添加一个额外的间接层。（我发现这个类有时很有用，我把它作为一个实用类保留。）

```
public class Wrapper<T>
{
    public T Value { get; set; }
} 
```

然后使用它：

```
BigInteger lhs = new BigInteger(0);
BigInteger rhs = new BigInteger(0);
Wrapper<BigInteger> currentSide = new Wrapper<BigInteger>();

currentSide.Value = lhs;

for (int i = 0; i < txtResult.Text.Length; i++)
{
    char currentCharacter = txtResult.Text[i];

    if (char.IsNumber(currentCharacter))
    {
        currentSide.Value += (int)char.GetNumericValue(currentCharacter);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:14:50.587

您可以在 lambda 中捕获所需的变量，如下所示：

```
Action<int> addToCurrentSide;

BigInteger lhs = new BigInteger(0);
BigInteger rhs = new BigInteger(0);

addToCurrentSide = x => lhs += x;

for (int i = 0; i < txtResult.Text.Length; i++)
{
    char currentCharacter = txtResult.Text[i];

    if (char.IsNumber(currentCharacter))
    {
        char currentCharacter = txtResult.Text[i];

        addToCurrentSide((int)char.GetNumericValue(currentCharacter));
    }
} 
```

然后换边，你只需重新分配`addToCurrentSide`：

```
addToCurrentSide = x => rhs += x; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T19:14:08.277

您不能完全删除，`if`但可以将其拉出循环：

```
bool isLeftHandSide = true;

if (isLeftHandSide)
   lhs = NewMethod(lhs, txtResult.Text);
else
   rhs = NewMethod(rhs, txtResult.Text); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-11T19:19:50.837

你可以这样做，

```
var isLeftHandSide = true;
var currentSide = new BigInteger(0);

for (int i = 0; i < txtResult.Text.Length; i++)
{
    char currentCharacter = txtResult.Text[i];
    if (char.IsNumber(currentCharacter))
        currentSide += (int)char.GetNumericValue(currentCharacter);
}

if (isLeftHandSide)
    // lhs = currentSide;
else
    // rhs = currentSide; 
```

# sqlite - Sqlite C/C++ API - 使用选择查询获取时间戳值

> ID：12846577
> 
> 赞同：0
> 
> 时间：2012-10-11T18:54:46.057
> 
> 标签：sqlite

我使用 sqlite3 C/C++ API 使用 SELECT 查询从表中检索行。我没有看到任何 sqlite3_column_timestamp() 在 sqlite3_step() 之后检索时间戳列值。如何获取时间戳值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:09:26.657

列/值访问器将仅具有与[它们直接支持的数据](http://www.sqlite.org/lang_datefunc.html)类型相对应的类型（`NULL`, `INTEGER`, `REAL`, `TEXT`, `BLOB`）。

您将使用`TEXT`访问权限来获取/设置日期的列值。

[*它们提供的*](http://www.sqlite.org/lang_datefunc.html)[SQL](http://www.sqlite.org/lang_datefunc.html)中有一些[帮助函数](http://www.sqlite.org/lang_datefunc.html)*，可让您在查询中处理它们。*

 *我不熟悉 SQLite Manager，但我认为它只报告声明表的数据类型。

在解析`CREATE`语句时，sqlite 了解许多支持良好的数据类型的意图，并自动将它们映射到适合其内部存储结构的内容。 `VARCHAR`例如，将映射到`TEXT`。我假设该列已声明`DATETIME`并且 sqlite 只是在内部将其映射到`TEXT`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:37:53.503

SQLite 没有特殊的时间戳数据类型。

当您想使用 SQLite 的任何[日期和时间函数时，您必须以](http://www.sqlite.org/lang_datefunc.html)[它们支持的格式](http://www.sqlite.org/lang_datefunc.html)之一存储时间戳，即类似`YYYY-MM-DD HH:MM:SS`or的字符串`HH:MM:SS`、朱利安日期数字或 Unix 时间戳数字。

您可以将表列类型声明为`DATETIME`，但 SQLite 将忽略该类型；SQLite 总是允许将任何类型的值放在任何列中。这样的声明仅作为文档有用。*

# java - 如何返回由 ObjectInspector 引用的对象

> ID：12846582
> 
> 赞同：0
> 
> 时间：2012-10-11T18:55:13.077
> 
> 标签：java, hive, user-defined-functions

我正在编写一个自定义 Hive UDF 来根据属性文件中定义的值解析 Map 中的键/值对。格式为 validate(Map<String, String>, String)。目的是让第一个参数是要评估的 Map，第二个参数是包含属性文件。

我遇到的问题是 GenericUDF 类似乎期望这两个值对于查询都是动态的，因为 initialize() 函数将参数转换为 ObjectInspectors，从事物的外观来看，它没有提供返回对象的可能选项他们正在检查。

我希望初始化函数加载属性文件，并且评估函数返回通过/失败。这几乎不足以涵盖我尝试过的所有内容，但希望它能让知道他们在做什么的人对这个问题有一个好主意：

```
public ObjectInspector initialize(ObjectInspector[] arguments) throws UDFArgumentException {
  mapOI = (MapObjectInspector) arguments[0];
  StringObjectInspector stringOI = (StringObjectInspector) arguments[1];

  try {
    // Begin Debug
    System.out.println(stringOI.getPrimitiveJavaObject(((DeferredObject) arguments[1]).get()));
    // End Debug

    loadProperties(stringOI.getPrimitiveJavaObject(((DeferredObject) arguments[1]).get()));
  }
  catch (HiveException exception) {
    throw new UDFArgumentTypeException(1, "Failed to cast properties file path for evaluation by loadProperties... What did you do?");
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T19:39:18.767

初始化方法只被调用一次，因此参数只能被视为描述评估方法期望接收的输入类型的元数据。因此，您可以实际看到输入值的唯一地方是在评估方法中，该方法可能被多次调用，通常每行一次。您实际上应该只使用初始化函数来验证类型而不是实际值。也就是说，在您的情况下，检查输入是否为具有字符串类型的原始类别元素的 map 类型。应在评估方法中对实际值进行验证。

# android - 如何仅在 Android 应用程序本身而不是应用程序内的产品上实现年度订阅

> ID：12846583
> 
> 赞同：5
> 
> 时间：2012-10-11T18:55:18.047
> 
> 标签：android, subscription, billing, in-app

在 Android 文档中，您可以找到如何为您在应用程序中出售的产品实施订阅计费。它涉及与 Google 服务器交换大量消息。

我只想通过订阅销售我的应用程序本身（而不是其中的产品）。我觉得这几乎就像一次性收费出售应用程序一样简单。当许可证在一年后失效时，谷歌服务器中的许可机制会告诉客户续订。

所以我的问题是：我是否必须实施文档中描述的整个应用内计费？要通过订阅销售应用程序本身，我必须做的最少工作是什么？据我调查，这并不明显或不清楚。有人有更多经验吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:02:29.467

Google Play 自己的销售方式本身不允许订阅式计费。如果你想要订阅类型的计费，你必须在应用计费中使用，或者通过你自己的网站销售应用程序。

绝对最低要求是允许用户免费下载应用程序，或者在购买应用程序本身时支付一年的费用。下载免费应用程序后，您必须要求用户支付第一笔订阅费用。如果您在购买应用程序时向用户收费，请在一年后要求付款。

简而言之，是的，您必须为此在应用计费中使用。

# android - 为什么 getEnabledProtocols() 返回 TLS v1 而不是 TLSv1.2？

> ID：12846593
> 
> 赞同：0
> 
> 时间：2012-10-11T18:55:46.817
> 
> 标签：android, ssl

我从[这篇](https://stackoverflow.com/a/11337538/1143977)文章中了解到 JB 支持 TLSv1.2。现在我进退两难了，当我运行以下测试代码时。我得到支持的协议为 TLS1.0 而不是 TLSv1.2。做错什么了吗？

```
public class SSLTest extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_ssltest);
        SSLSocketFactory mSslSocketFactory = null;
        SSLContext sslContext = null;
        try {
            sslContext = SSLContext.getInstance("Default");
        } catch (NoSuchAlgorithmException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        }
        mSslSocketFactory = sslContext.getSocketFactory();
        SSLSocket sock = null;
        try {
            sock = (SSLSocket)mSslSocketFactory.createSocket();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        String[] prots = sock.getEnabledProtocols();
        for(int i=0;i<prots.length;i++){
            Log.d("TEMP","$$$$$$$$$$$$$$$$$$$$$$$ ::: " + prots[i]);
        }
        SSLParameters sslp = sock.getSSLParameters();
        String[] newprots = sslp.getProtocols();
        for(int i=0;i<newprots.length;i++){
            Log.d("TEMP","$$$$$$$$$$$$$$$$$$$$$$$ ::: " + newprots[i]);
        }
    } 
```

**输出：**

```
10-11 11:57:53.280: D/TEMP(7928): $$$$$$$$$$$$$$$$$$$$$$$ ::: SSLv3
10-11 11:57:53.280: D/TEMP(7928): $$$$$$$$$$$$$$$$$$$$$$$ ::: TLSv1
10-11 11:57:53.280: D/TEMP(7928): $$$$$$$$$$$$$$$$$$$$$$$ ::: SSLv3
10-11 11:57:53.280: D/TEMP(7928): $$$$$$$$$$$$$$$$$$$$$$$ ::: TLSv1 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T19:20:50.917

你混淆了*enabled*和*supported*。支持协议这一事实并不意味着默认启用它。

如果要使用 TLS 1.2，`setEnabledProtocols`请先使用 启用它，如果`getSupportedProtocols`.

# mysql - 如何并行写入 MySQL 中的同一行？

> ID：12846596
> 
> 赞同：2
> 
> 时间：2012-10-11T18:55:51.467
> 
> 标签：mysql, parallel-processing, deadlock, database-deadlocks

我目前正在构建一个运行计算的系统，并且每 5 秒将基于这些计算的信息插入或更新到 MySQL 中的几行。我现在正在使用几个代理同时在几个不同的服务器上运行这个系统，每个代理都在做类似的处理，然后在同一组行上写入。我已经随机化了每个代理写入其行集的顺序，但是仍然发生了很多死锁。解决这些僵局的最佳/最快方法是什么？我应该在每次发生查询时重新运行查询，还是执行行锁，或者完全是其他事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:16:33.867

我建议您尝试一些不需要多个客户来更新您的“几行”的方法。

例如，您可以让每个产生结果的代理`INSERT`使用 MEMORY 访问方法对临时表执行操作。

然后，您可以每五秒钟运行一次 MySQL 事件（服务器中的存储过程），该事件循环遍历该表中的所有行，将它们的结果发布到您的“几行”，然后删除它们。如果按顺序处理临时表中的行很重要，则可以使用 AUTO_INCREMENT id 字段。但对他们来说，井井有条可能并不重要。

如果您想获得比这更高级和更可扩展的功能，您将需要像 Apache ActiveMQ 这样的队列管理系统。

# c# - FTP 客户端回复同步

> ID：12846599
> 
> 赞同：0
> 
> 时间：2012-10-11T18:56:01.860
> 
> 标签：c#

我正在用 C# 编写一个带有套接字的 FTP 客户端。现在我有以下问题。当我通过我的控制连接套接字向服务器发送 FTP 命令时，我尝试接收回复。但有时服务器会延迟发送数据。我的结果是支离破碎的。

现在我的代码：

```
public byte[] BinaryReceive()
{
       byte[] bytes;
       using (MemoryStream memoryStream = new MemoryStream())
             {
                        byte[] buffer = new byte[4056];
                        while (_controlConnectionSocket.Available > 0)
                        {
                            int count = _controlConnectionSocket.Receive(buffer, buffer.Length, SocketFlags.None);
                            memoryStream.Write(buffer, 0, count);

                            Thread.Sleep(100);
                        }
                        bytes = memoryStream.ToArray();

              }
       return bytes;
 } 
```

我怎样才能避免这种情况？目前，我将`Thread.Sleep()`a 实现为解决方法。但这不可能是解决方案。

任何建议将不胜感激。

**编辑：**

我解决了这个问题。关键是，不要用`Available > 0`我等回复结束。比它有效..

# c# - 从 sql server 获取数据到文本框错误信息

> ID：12846604
> 
> 赞同：0
> 
> 时间：2012-10-11T18:56:19.303
> 
> 标签：c#, asp.net, visual-studio

```
protected void DropDownServerName_SelectedIndexChanged(object sender, EventArgs e)
{
    SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["Database_Shared_NotebookConnectionString"].ConnectionString);

        conn.Open();

        string serverName = DropDownServerName.SelectedValue;

        string sqlquery = ("SELECT Architecture FROM tblServer WHERE (ServerName = " + serverName + ")");

        SqlCommand command = new SqlCommand(sqlquery, conn);

        txtUpdateArchitecture.Text = command.ExecuteScalar().ToString();

        conn.Close();
    } 
```

DropDownServerName 区域使用 SqlDataSource 连接到 SQL Server 以显示 ServerName 列上的值列表。

在我获得名为“Brad”的选择值之后，我希望 Brad 的 Architecture 列中的值显示在文本框中。但是我得到错误说，无效的列名“Brad”。该列假定为 ServerName，而 Brad 只是 ServerName 列中的一个值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T18:59:19.157

你需要在你的服务器名周围加上引号

```
string sqlquery = ("SELECT Architecture FROM tblServer WHERE (ServerName = '" + serverName + "')"); 
```

或者更好的是，使用参数化查询 [它更安全，可以防止 SQL 注入和字符串中可能污染查询的有趣字符]

```
string sqlquery = "SELECT Architecture FROM tblServer WHERE ServerName = @ServerName";

SqlCommand command = new SqlCommand(sqlquery, conn);
command.Parameters.AddWithValue("@ServerName", serverName); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T18:59:33.193

在 WHERE 子句中的 servername 周围添加“”：

```
... WHERE ServerName = '" + serverName + "' ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T18:59:59.377

试试这个。它应该与单引号一起使用。

```
string sqlquery = ("SELECT Architecture FROM tblServer WHERE ServerName = '" + serverName + "'"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T19:00:11.593

您可能在变量周围缺少单引号。试试这个

```
 protected void DropDownServerName_SelectedIndexChanged(object sender, EventArgs e)
{
    SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["Database_Shared_NotebookConnectionString"].ConnectionString);

        conn.Open();

        string serverName = DropDownServerName.SelectedValue;

        string sqlquery = ("SELECT Architecture FROM tblServer WHERE (ServerName = '" + serverName + "')");

        SqlCommand command = new SqlCommand(sqlquery, conn);

        txtUpdateArchitecture.Text = command.ExecuteScalar().ToString();

        conn.Close();
    } 
```

# java - Mongo DB 对象是否尝试了单个 Mongo 实例？

> ID：12846610
> 
> 赞同：2
> 
> 时间：2012-10-11T18:56:35.573
> 
> 标签：java, mongodb, database

我花了一些时间搜索这个，最终不得不去寻找源头。

问题是；Mongo.getDb() 中的 DB 对象是绑定到单个 Mongo 实例还是将对集群中的所有节点进行调用？其次，对象线程安全吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T18:56:35.573

所以它是[线程安全](http://www.mongodb.org/display/DOCS/Java+Driver+Concurrency)的，这很容易。在查看源代码（版本 2.9.1）后，我发现整个 ServerAddresses 列表是作为创建 DB 对象的一部分传入的。

# r - splinefun() 的解析导数

> ID：12846618
> 
> 赞同：0
> 
> 时间：2012-10-11T18:57:09.590
> 
> 标签：r, spline

我正在尝试将自然肘形样条拟合到概率数据（随机变量小于某些值的概率）以获得累积分布函数，该函数使用以下方法可以很好地工作`splinefun()`：

```
cutoffs <- c(-90,-60,-30,0,30,60,90,120)
probs <- c(0,0,0.05,0.25,0.5,0.75,0.9,1)
CDF.spline <- splinefun(cutoffs,probs, method="natural")
plot(cutoffs,probs)
curve(CDF.spline(x), add=TRUE, col=2, n=1001) 
```

然而，我想使用密度函数，即样条的导数，来执行各种计算（例如，获得随机变量的期望值）。

有没有办法将这个导数作为一个函数来获得，而不仅仅是通过`splinefun(x, deriv=1`) 在离散数量的点上进行评估？

[这](https://stat.ethz.ch/pipermail/r-help/2006-March/101901.html)与我正在寻找的非常接近，但可惜该示例似乎不适用于 R 版本 2.15.0。

除非有解析解，否则最干净的数值方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:36:06.187

如果您将代码中的环境分配行更改为`g`Berwin Turlach 在 R-help 上提供的代码：

```
environment(g) <- environment(f) 
```

...您在 R 2.15.1 中取得了成功。

# hibernate - 为什么 EntityManagerFactoryImpl.createEntityManager() 会导致 NullPointerException？

> ID：12846621
> 
> 赞同：2
> 
> 时间：2012-10-11T18:57:18.490
> 
> 标签：hibernate, jpa, oracle10g

我是 JPA 的新手。我的代码尝试连接到 Oracle 10.3 数据库以填充一些表。但是，在它到达代码填充之前，它会在 EntityManagerFactoryImpl.createEntityManager(String) 中引发 NullPointerException。我已经验证该`emf`变量不为空。这是 Populator.java 中的相关代码，就像许多教程示例一样：

```
public static void main(String[] args) {
    EntityManagerFactory emf =
        Persistence.createEntityManagerFactory("LeaveSchedulerJPA");
    EntityManager em = emf.createEntityManager(); 
```

异常跟踪是：

```
[EL Severe]: 2012-10-11 14:37:02.415--ServerSession(37999235)--java.lang.NullPointerException
    at java.util.ResourceBundle.getBundle(ResourceBundle.java:950)
    at org.eclipse.persistence.exceptions.i18n.ExceptionMessageGenerator.buildMessage(ExceptionMessageGenerator.java:47)
    at org.eclipse.persistence.exceptions.ValidationException.errorDecryptingPassword(ValidationException.java:864)
    at org.eclipse.persistence.internal.security.JCEEncryptor.decryptPassword(JCEEncryptor.java:124)
    at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.updateLogins(EntityManagerSetupImpl.java:1183)
    at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.updateServerSession(EntityManagerSetupImpl.java:1450)
    at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.deploy(EntityManagerSetupImpl.java:372)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.getServerSession(EntityManagerFactoryImpl.java:164)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManagerImpl(EntityManagerFactoryImpl.java:221)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:209)
    at com.engilitycorp.leaveschedulerjpa.Populator.main(Populator.java:28) 
```

我的 persistence.xml 在下面。当我从 Eclipse 中使用指定的 URL 来生成与表对应的类时，指定的 URL 有效。有任何想法吗？

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
    <persistence-unit name="LeaveSchedulerJPA" transaction-type="RESOURCE_LOCAL">
        <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
        <class>com.engilitycorp.leaveschedulerjpa.Holiday</class>
        <class>com.engilitycorp.leaveschedulerjpa.Leave</class>
        <class>com.engilitycorp.leaveschedulerjpa.LeaveType</class>
        <class>com.engilitycorp.leaveschedulerjpa.Notification</class>
        <class>com.engilitycorp.leaveschedulerjpa.NotificationType</class>
        <class>com.engilitycorp.leaveschedulerjpa.Role</class>
        <class>com.engilitycorp.leaveschedulerjpa.User</class>
        <properties>
        <property name="javax.persistence.jdbc.url" value="jdbc:oracle:thin:@localhost:1521:xe"/>
            <property name="javax.persistence.jdbc.user" value="leavescheduler"/>
            <property name="javax.persistence.jdbc.password" value="xxxx"/>
            <property name="javax.persistence.jdbc.driver" value="oracle.jdbc.OracleDriver"/>
        </properties>
    </persistence-unit>
</persistence> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T16:58:33.857

问题是我试图测试持久性，就好像它是一个独立的 Java 应用程序一样。该文档指出 EntityManagerFactoryImpl 维护“对活动 ServerSession 的引用”。当我在 WebLogic 中运行相同的代码时，它运行良好。

一位同事能够运行与独立 Java 应用程序相同的代码。我还没有弄清楚关键的配置差异是什么。

# java - 严重的泛型问题：int vs. Integer java

> ID：12846624
> 
> 赞同：0
> 
> 时间：2012-10-11T18:57:30.457
> 
> 标签：java, generics, types, int

很长一段时间以来，我一直试图让一段代码工作，但这是不可能的。我拥有的类需要一个我设置为整数的泛型。所以我尝试了以下方法：

```
public class a<T> //set generics for this function
{
    private T A;
    protected boolean d;

    public a(final T A)
    {
        this.A = A;

        //do calculations
        //since constructor cannot return a value, pass to another function.
        this.d = retnData(Integer.parseInt(A.toString()) != 100); //convert to an integer, the backwards way.
    }
    private boolean retnData(boolean test)
    {
        return test;
    }
}
// IN ANOTHER CLASS
transient a<Integer> b;
boolean c = b.d = b.a(25); // throws an erorr: (Int) is not apporpriate for a<Integer>.a 
```

Java 不允许这样做，因为 java 会看到 int != Integer，即使两者都接受相同的数据。由于泛型的工作方式，我无法设置 ab；因为 int 类型的原始性。即使转换为 Integer 也不起作用，因为它仍然会引发“类型错误”

最后，我不得不问一下是否有某种解决方法，或者尝试让它工作是徒劳的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T19:00:57.737

您正在尝试将构造函数显式调用为实例方法。这不能在 Java 中完成。

也许你想要：

```
transient a<Integer> b = new a<Integer>(25);
boolean c = b.d; 
```

但是，由于`d`声明为`protected`，因此仅当此代码位于从同一包派生的另一个类中`a`或在同一包中时，它才会起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T19:00:04.850

采用

```
final a<Integer> b = new a<Integer>(10); 
boolean c = b.d; 
```

int 可以使用`new Integer(10`) 或显式转换为 Integer`Integer.valueOf(10)`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T18:59:27.690

代码没有多大意义：`b`是一个类型的对象`a`，它没有`a`方法 - 所以不确定你期望什么;...这与vs`b.a(25)`无关...`int``Integer`

# coldfusion - 冷融合 StructFindValue 不起作用

> ID：12846628
> 
> 赞同：2
> 
> 时间：2012-10-11T18:57:46.033
> 
> 标签：coldfusion, struct

我有很多结构，我正在使用 StructFindValue() 来确定一个键是否多次出现。

我得到了为“singles”返回的预期数组，但是我得到了一个用于“doubles”和“triples”的空数组 - 此代码实际上位于不同的代码段内，-my 本身就是一个结构......

如果我尝试任何一行“x= StructFindValue(y, 3, 'all');” 在一个独立的模板中 - CF 找到 '2' 和 '3' 值就好了 - 我得到一个包含数据的数组 - 但在上面的代码中 - 只有 '1' 的值返回任何东西......

我很困惑。

* * *

**更新**

好的，为了响应更多信息的请求，我的服务器详细信息是：

```
 Version             ColdFusion 10,282462
    Edition             Developer  
    Operating System    Windows XP  
    Java Version        1.6.0_29   
    OS Version          5.1  
    Update Level        /C:/ColdFusion10/cfusion/lib/updates/chf10000002.jar  
    Adobe Driver Version   4.1 (Build 0001) 
```

从下面的代码示例中可以看出，我的数组有几个不同的名称，具有不同的重复性质。我想知道哪些值重复了指定的次数。如上所述，`structkeyFind()`如果（并且仅）在`1`. 它不适用于 , 的键值`2`（`3`或 4 或 5 等，为简洁起见，此处不包括在内）。

```
<cfscript>
   _myArry = listToArray('bob,bob,bob,joe,jane,jane,john,john,john,alex,greg');
   _myStats = getDataStats( _myArry );
   writeDump( _myStats );
</cfscript>

<cffunction name="getDataStats">
   <cfargument name="data" required="yes" type="array" >

    <cfscript>
    var _hv = {};

    // default some values
    _hv.vals = {};
    _hv.threes = false;
    _hv.twos = false;
    _hv.ones =false;

    // loop the data put it into separate containers
    for ( var i=1; i LTE arrayLen( arguments.data ); i++ ) {            
        switch ( lcase( arguments.data[i] ) ) {
            case 'bob': // bob 
                if ( structKeyExists( _hv.vals, 'bob' ) ) { _hv.vals.bob = _hv.vals.bob + 1; }
                else { _hv.vals.bob = 1; }
            break;      
            case 'joe': // joe 
                if ( structKeyExists( _hv.vals, 'joe' ) ) { _hv.vals.joe = _hv.vals.joe + 1; }
                else { _hv.vals.joe = 1; }
            break;
            case 'jane': // jane 
                if ( structKeyExists( _hv.vals, 'jane' ) ) { _hv.vals.jane = _hv.vals.jane + 1; }
                else { _hv.vals.jane = 1; }
            break;
            case 'john': // john 
                if ( structKeyExists( _hv.vals, 'john' ) ) { _hv.vals.john = _hv.vals.john + 1; }
                else { _hv.vals.john = 1; }
            break;  
            case 'alex': // alex 
                if ( structKeyExists( _hv.vals, 'alex' ) ) { _hv.vals.alex = _hv.vals.alex + 1; }
                else { _hv.vals.alex = 1; }
            break;  
            case 'greg': // greg 
                if ( structKeyExists( _hv.vals, 'greg' ) ) { _hv.vals.greg = _hv.vals.greg + 1; }
                else { _hv.vals.greg = 1; }
            break;      
        }
    }

    // give me a return struct for testing so i can 'see' where I'm at
    var _thisReturn = {
        'threes' = StructFindValue( _hv.vals, 3, 'all' ),
        'twos' = StructFindValue( _hv.vals, 2, 'all' ),
        'ones' = StructFindValue( _hv.vals, 1, 'all' ),
        'values' = arguments.data
    };
    </cfscript>

    <cfreturn _thisReturn />
</cffunction> 
```

* * *

为了尝试“转换”这些值，我尝试了这些变体中的每一个。然而，结果与原始结果没有变化。

```
'ones' = StructFindValue( _hv.vals, '1', 'all' ),
'twos' = StructFindValue( _hv.vals, '2', 'all' ),
'threes' = StructFindValue( _hv.vals, '3', 'all' ), 
```

进而

```
'ones' = StructFindValue( _hv.vals, val( 1 ), 'all' ),
'twos' = StructFindValue( _hv.vals, val( 2 ), 'all' ),
'threes' = StructFindValue( _hv.vals, val( 3 ), 'all' ), 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T17:30:06.633

这里的问题似乎是 CF 如何存储/显示/比较值。

这是问题的简单演示：

```
<cfset Data = 
    { Bob  : 2
    , Joe  : 1+1
    , Jane : "2"
    , John : 2.0
    , Alex : 4/2
    } />

<cfdump var=#Data# />

<cfdump var=#StructFindValue(Data,2,"all")# />
<cfdump var=#StructFindValue(Data,"2","all")# />
<cfdump var=#StructFindValue(Data,2.0,"all")# /> 
```

第一个转储显示`2`除了 John 之外的所有值，他是`2.0`

但是，前两个 StructFindValue 调用都只返回`Bob`, `Jane`。

第三个 StructFindValue 调用返回`Joe`, `John`, `Alex`。

这基本上表明 CF 的 StructFindValue 对检查相等性进行了非常粗略的比较，在处理数字时基本上不可信。

（Railo 不存在此问题，它可能使用与进行测试时完全相同的比较`EQ`，相应地强制类型。仅在 CF10,0,0,282462 上测试。）

为了解决您的问题，您似乎需要手动遍历结构并自己复制 StructFindValue 的行为。

# java - 正则表达式吃太多东西

> ID：12846638
> 
> 赞同：1
> 
> 时间：2012-10-11T18:58:34.677
> 
> 标签：java, regex

所以我最近打开了一个问题并最终通过使用正则表达式来解决它。我使用的正则表达式基本上吃掉了我所有的非英语字符。

让我重试一下：

我想吃掉字符串中可能存在的所有非键盘字符

我正在使用的正则表达式是：

```
[^\\p{L}\\p{N}] 
```

然而，这变成了像

2012 年 10 月 10 日上午 10:51:25

进入

```
10102012105125AM 
```

是否有某种方法可以轻松地从带有 replaceALL 的字符串中排除所有 alt 代码字符并保留键盘字符（如 % / \ : 和其他字符）？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:04:29.763

您可能只想保存 ASCII 字符。字符范围`[ -~]`将实现这一点。如果您还想要空白字符，可以将它们添加到：`[ -~\s]`.

```
System.out.println(input.replaceAll("[^ -~\\s]+", "")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:07:34.157

要删除所有非 ASCII 字符：

```
String mystring = <your_input_string>;
mystring.replaceAll("[^ -~\\s]+", ""); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T19:08:09.480

怎么样`\p{Print}`？它匹配所有可打印的字符，这听起来正是您所需要的。

# php - 如何更改随 SOAP 请求发送的命名空间？

> ID：12846640
> 
> 赞同：4
> 
> 时间：2012-10-11T18:58:34.917
> 
> 标签：php, api, namespaces, soap-client

与此问题相关：[如何从 SOAP XML API 请求答案？](https://stackoverflow.com/questions/12844309/how-to-request-an-answer-from-a-soap-xml-api)

我有这个 PHP 脚本发送带有必填字段的请求：

```
$client = new SoapClient('https://live.domainbox.net/?WSDL');
$params = array(
    'AuthenticationParameters' => array(
        'Reseller' => 'resellername',
        'Username' => 'myusername',
        'Password' => 'mypassword'
    ),
    'CommandParameters' => array(
        'DomainName' => 'mydomain.com',
        'LaunchPhase' => 'GA'
    )
);

$result = $client->CheckDomainAvailability($params);

print_r($result); 
```

我收到以下错误消息：

> 致命错误：未捕获的 SoapFault 异常：[soap:VersionMismatch]
> 
> 可能的 SOAP 版本不匹配：信封命名空间 **[http://schemas.xmlsoap.org/soap/envelope/](http://schemas.xmlsoap.org/soap/envelope/)**是意外的。
> 
> 期待**[http://www.w3.org/2003/05/soap-envelope](http://www.w3.org/2003/05/soap-envelope)**。在 /home/nosa/public_html/dev/check-domain-availability.php:20 堆栈跟踪：#0 /home/nosa/public_html/dev/check-domain-availability.php(20)：
> 
> SoapClient->__call('CheckDomainAvai...', Array) #1 /home/nosa/public_html/dev/check-domain-availability.php(20): SoapClient->CheckDomainAvailability(Array) #2 {main} 抛出/home/nosa/public_html/dev/check-domain-availability.php 第 20 行

我删除并重新编译了 apache，以包含使用 WHM/cPanel 可用的最新 SOAP 版本。

我的问题是：如何发送正确的信封命名空间？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T19:01:58.707

在构建您的 soap_client 对象时，您可以传递一个选项的数组，默认情况下，根据 php 文档，版本将为 1.1。

您的错误似乎指出该服务可能是 SOAP 1.2，因此您需要将其设置为 1.2 ...

```
$client = new SoapClient('https://live.domainbox.net/?WSDL', array('soap_version' => SOAP_1_2)); 
```

试试看！

# c# - 在联网服务器上的 C#.net 中连接 SQL SERVER

> ID：12846643
> 
> 赞同：0
> 
> 时间：2012-10-11T18:58:46.660
> 
> 标签：c#, sql-server-2005

我有一个在 C#.net 中构建的现有应用程序，使用 SQL SERVER 2005，早期的应用程序和 SQL 在同一台机器上，但现在我需要将服务器上的 SQL 连接到安装应用程序的机器上。那么任何人都可以告诉我如何将 SQL 连接到应用程序，以及需要对连接字符串进行哪些更改。

谢谢编辑：我对 c#.net 有点陌生。目前我的连接字符串是： public SqlConnection con = new sqlConnection("server=.;database=Database1;integrated security=sspi); 所以如果我把它直接连接到其他计算机上的 SQL 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:01:59.213

答案取决于您是否使用 SQL Server 身份验证

**标准安全**性（SQL Server 身份验证）

> 服务器=myServerAddress;Database=myDataBase;用户 ID=myUsername;Password=myPassword;

或连接到服务器上的特定实例

> 服务器=myServerName\myInstanceName;Database=myDataBase;用户 ID=myUsername; 密码=我的密码；

**可信连接**

> 服务器=myServerAddress;数据库=myDataBase;Trusted_Connection=True;

[http://connectionstrings.com/sql-server-2005](http://connectionstrings.com/sql-server-2005)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T23:07:59.473

服务器=.;

意味着您正在连接到同一台机器上的 sql2005 的默认实例。

自 2005 年以来，SQL Server 允许使用实例。

所以你可以有 MyMachine/MyLiveDBMSInstance 和 MyMachine/MyTestDBMSInstance。

基本上就像你安装了两次 sql server 一样。默认（即未命名）实例是一种向后兼容的措施，因此 DBA 不必四处向单纯的程序员解释实例是什么。:)

您将使用 Server = MyMachine\MyLiveDBMSInstance 或 Server = .\MyInstance 点连接到它们，基本上是这个本地主机。

所以你不能使用 . 此外，您还需要机器的名称，如果它使用命名实例，您也需要它。

即服务器 = RemoteMachine 或服务器 = RemoteMachine\InstanceName

当然，所有这些都假设打开了 dbms 的机器设置正确，并且运行该应用程序的 Windows 用户已被允许访问。

# php - 处理在 PHP 中使用 json_encode() 时出现的加号

> ID：12846646
> 
> 赞同：1
> 
> 时间：2012-10-11T18:58:55.953
> 
> 标签：php, jquery, json, forms, cookies

我正在使用 PHP 将表单的值作为 JSON 保存到 cookie 中，如下所示：

```
// set cookie with search values so we can use jQuery to repopulate the form
setcookie('jobSearchValues', json_encode($form_state['values']), 0, '/'); 
```

这很好用，然后`JavaScript`我可以用它来获取值：

```
var jobSearchValues = JSON.parse($.cookie("jobSearchValues"));
$("#keywords").val(jobSearchValues.keywords); 
```

同样，这很好用，但问题是当表单中某个字段的值中有空格时，空格会被替换为“+”。因此，当重新填充表单时，文本字段会像这样显示，例如“hi+mom”。有没有更好的方法来解决这个问题？顺便说一句，`$form_state['values']`是一个 PHP `array`。我将表单中的 4 个字段设置为 cookie 中的 JSON。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:23:21.603

在客户端使用`setrawcookie( '<name>', rawurlencode( json_encode( $value ) ), ... )`然后手动 url-decode & json-parse (with `JSON.parse(decodeURIComponent(cookie))`)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:11:22.023

这很奇怪。`json_encode`不应该用`+`..替换空格

`setcookie`可能是 urlencoding 它。

在使用它之前，您必须`urldecode`在 javascript 中使用它。

试试这个：

（取自phpjs）

```
function urldecode(str) {
   return decodeURIComponent((str+'').replace(/\+/g, '%20'));
} 
```

进而

```
var jobSearchValues = JSON.parse($.cookie("jobSearchValues"));
$("#keywords").val(urldecode(jobSearchValues.keywords)); 
```

# postgresql - 如何将 C# Windows mobile 6.5 应用程序连接到 Postgres 数据库？

> ID：12846648
> 
> 赞同：1
> 
> 时间：2012-10-11T18:59:11.360
> 
> 标签：postgresql, windows-mobile-6.5

我正在为 Windows Mobile 6.5 开发一个应用程序，该应用程序需要从应用程序网络内的 Postgres 数据库获取和发送数据。

我已经用谷歌搜索并阅读了有关此事的每一页，但未能找到解决方案。

npgsql 驱动程序在这个 sdk 上不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T23:44:27.770

与 Android 或 iOS 非常相似，我建议您构建由 Internet 上的服务器提供的中间 Web 服务，手机与之通信，而不是直接与数据库通信。Web 服务将接受来自电话客户端的 REST+JSON、REST+XML、XML-RPC、SOAP 或任何您首选的 Web 服务协议。它会对来自手机的请求采取行动，在数据库中执行任何需要满足请求的操作，并通过 Web 服务协议返回任何结果。

这意味着您的个人电话不需要直接连接到 PostgreSQL - 这是一件好事，因为电话网络连接很不稳定，并且重试/重新建立逻辑可能很难正确。你会得到很多到 Pg 服务器的悬空连接。您最好使用像 HTTP 这样的无状态协议来与 Web 服务通信，然后由它来完成真正的工作*。*

选择在 Windows Phone 6.5 上最容易使用的任何 Web 服务协议，并使用您喜欢的后端服务器实现它。在您的情况下，我想这可能是 IIS 上的 .NET。

根据应用程序，您可能已经*有*一个 Web 服务协议。如果您有一个现代网页版本，那么很有可能使用带有 REST+JSON 的 JavaScript 来调用服务器端点，在这种情况下，您可能只是能够扩展和重用那些电话应用程序。

# facebook - Facebook fb:fan - 定义显示的粉丝数

> ID：12846649
> 
> 赞同：1
> 
> 时间：2012-10-11T18:59:17.063
> 
> 标签：facebook, xfbml, facebook-likebox

我正在使用`<fb:fan>`XFBML 的标签，这样我就可以为类似框使用自定义样式。标签的问题`<fb:fan>`在于，它不会自动计算显示的粉丝数。有没有办法手动设置这个计数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T11:38:02.760

有一个参数称为`connections`定义显示的粉丝数。
例如`connections="15"`将显示 15 个粉丝。

# sql - SQL Server - 将图像传递给存储过程，无效的本地 var 类型

> ID：12846650
> 
> 赞同：2
> 
> 时间：2012-10-11T18:59:16.710
> 
> 标签：sql, stored-procedures, sql-server-2000

我有两个包含文档内容的表：一个用于临时暂存，另一个用于永久存储。内容存储为类型图像（无法更改，因为它是当前功能）。

我需要一个执行以下操作的存储过程：

1.  传入临时文档表中存在的 TempDocumentID。
2.  使用该 TempDocumentID，从临时文档表中选择图像内容。
3.  执行将图像参数插入永久文档表的现有存储过程。

我的问题有两个：

*   我不能声明一个“图像”类型的局部变量来从临时表的选择语句中填充。它抛出错误“文本、ntext 和图像数据类型对局部变量无效。”
*   我不知道用临时表的选择语句的直接结果来执行存储过程的方法。

这是我的 SQL Fiddle 示例：[http ://sqlfiddle.com/#!3/09384/5](http://sqlfiddle.com/#!3/09384/5)

谢谢，格雷格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:06:06.157

您应该能够在 SQL Server 2005 及更高版本中使用 VARBINARY(MAX)。

```
CREATE PROCEDURE MoveDocumentFromTemp
(
  @TempDocumentID numeric(18,0)
)
AS
BEGIN
  DECLARE @ContentToMove varbinary(max)
  SELECT @ContentToMove = cast(TempContent as varbinary(max))
  FROM DocumentContentTemp (NOLOCK)
  WHERE TempDocumentID = @TempDocumentID

  EXEC InsertDocumentContentFinal @ContentToMove
END
GO 
```

对于 SQL Server 2000，您只需将来自 MoveDocumentFromTemp 的 INSERT 代码直接包含到您的包装存储过程中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:02:50.420

试试这个，它不会在 SQL Fiddle 中出现错误。我相信它会传递子查询的结果：

```
CREATE PROCEDURE MoveDocumentFromTemp
(
  @TempDocumentID numeric(18,0)
)
AS
BEGIN

  EXEC InsertDocumentContentFinal (SELECT TempContent
  FROM DocumentContentTemp (NOLOCK)
  WHERE TempDocumentID = @TempDocumentID)
END 
```

# cocoa - 保持 NSPanel 控件处于活动状态

> ID：12846651
> 
> 赞同：2
> 
> 时间：2012-10-11T18:59:18.297
> 
> 标签：cocoa, nswindow, osx-mountain-lion, nscontrol

我有一个基于 NIB 的 NSPanel，样式实用程序面板，我正在制作我的 NSDocument 窗口的子窗口。我希望它表现得像一个抽屉，因为它看起来像窗口的一部分，只要文档窗口是主窗口，控件就会以它们的活动窗口状态绘制。我还计划自定义框架、关闭和最小化按钮。

该面板已将 becomeKeyOnlyIfNeeded 和 excludeFromWindowsMenu 设置为 YES，并且它的子类从 canBecomeKeyWindow 返回 YES。

面板的 NIB 包含一个 NSSegmentedControl 和一个视图，我在其中添加了另一个 NIB 的视图。我发现分段控件正在其窗口非活动状态下绘制，除非单击面板成为键。

![在此处输入图像描述](../Images/c5da89c9c34950a4b7ef7a837a642509.png)

我从 OmniGroup 的 OIInspectorWindow 和 cocoadev.com 的 NSWindow 页面尝试了一个技巧，实现了一个返回 YES 的 _hasActiveControls 方法，但这似乎没有效果。然后我尝试覆盖 isMainWindow 以在父窗口是主窗口时返回 YES（加上观察窗口的状态更改通知和调用 -display）。我希望这会欺骗控件和窗口框架以在活动状态下绘制。在 10.7 (Lion) 上，事实证明该控件确实按照我的意愿绘制为活动的，尽管窗口框架不是。在 10.8 (Mountian Lion) 上，即便如此，当窗口不是键时，分段控件仍然处于非活动状态。

我可以忍受不影响窗框和关闭按钮的技巧，因为无论如何我都计划自定义它们。有谁知道a）为什么我的技巧在10.8上不起作用以及我如何让它工作，或者b）另一种方法来确保我的面板的控件在其父窗口为主时始终处于活动状态。

# iphone - 在 iOS 模拟器中调用 glDrawElements 时出现奇怪的、看似随机的崩溃

> ID：12846659
> 
> 赞同：0
> 
> 时间：2012-10-11T18:59:44.820
> 
> 标签：iphone, xcode, opengl-es

这个错误似乎只发生在 iOS 模拟器中，但它经常发生以至于影响了我的工作。

随机地，应用程序将在 glDrawElements 中崩溃。

通常，没有输出，但是当使用 GuardMalloc 运行时，我得到了这个：

```
GuardMalloc[Sketch Nation Galaxy-92006]: Failed to VM allocate 16777216 bytes
GuardMalloc[Sketch Nation Galaxy-92006]: Explicitly trapping into debugger!!!
dlopen(/Applications/Xcode.app/Contents/PlugIns/DebuggerFoundation.ideplugin/Contents/Resources/DebuggerIntrospectionSupport.dylib, 0x00000002)
dyld: loaded: /Applications/Xcode.app/Contents/PlugIns/DebuggerFoundation.ideplugin/Contents/Resources/DebuggerIntrospectionSupport.dylib 
```

查看 glDrawElements 调用，如果崩溃发生在 GuardMalloc 未打开时，一切看起来都很正常，并且似乎没有任何顶点或索引数据被损坏。只是 glDrawElements 调用中的一个奇怪的 exec_bad_access 。

当我尝试在 GuardMalloc 开启时发生崩溃时查看数据时，无论我爬上堆栈跟踪多高，都没有任何数据。

我不知道它是否有帮助，但这里是 glDrawElements 调用中的程序集：

```
OpenGLES`glDrawElements:
0x1b3f11d:  pushl  %ebp
0x1b3f11e:  movl   %esp, %ebp
0x1b3f120:  pushl  %ebx
0x1b3f121:  pushl  %edi
0x1b3f122:  pushl  %esi
0x1b3f123:  subl   $28, %esp
0x1b3f126:  movl   $30, (%esp)
0x1b3f12d:  calll  0x1b455c2                 ; symbol stub for: pthread_getspecific
0x1b3f132:  testl  %eax, %eax
0x1b3f134:  je     0x1b3f15e                 ; glDrawElements + 65
0x1b3f136:  movl   20(%ebp), %ecx
0x1b3f139:  movl   16(%ebp), %edx
0x1b3f13c:  movl   12(%ebp), %esi
0x1b3f13f:  movl   8(%ebp), %edi
0x1b3f142:  movl   16(%eax), %ebx
0x1b3f145:  movl   %ecx, 16(%esp)
0x1b3f149:  movl   %edx, 12(%esp)
0x1b3f14d:  movl   %esi, 8(%esp)
0x1b3f151:  movl   %edi, 4(%esp)
0x1b3f155:  movl   %ebx, (%esp)
0x1b3f158:  calll  *288(%eax)
0x1b3f15e:  addl   $28, %esp <-- CRASH HAPPENS HERE
0x1b3f161:  popl   %esi
0x1b3f162:  popl   %edi
0x1b3f163:  popl   %ebx
0x1b3f164:  popl   %ebp
0x1b3f165:  ret 
```

有人知道吗？

此崩溃随机发生在我的任何 glDrawElement 调用中。我最常见的调用是用于渲染精灵的“三角形条形正方形”：

```
glVertexPointer( 3, GL_FLOAT, byteStride, m_pVertexData );
glTexCoordPointer( 2, GL_FLOAT, byteStride, m_pVertexData+6 );

glDrawElements(GL_TRIANGLE_STRIP, m_numVertices, GL_UNSIGNED_BYTE, m_pIndices); 
```

m_pVertexData 是从 m_pVertices 创建的，它是一个结构。

```
m_numVertices = 4;
m_stride = sizeof( GEMeshVertex ) / sizeof( GLFloat );

int vertexCounter = 0;
m_pVertices[vertexCounter].x = -0.5;
m_pVertices[vertexCounter].y = 0.5;
m_pVertices[vertexCounter].z = 0;   
m_pVertices[vertexCounter].nx = 0;
m_pVertices[vertexCounter].ny = 0;
m_pVertices[vertexCounter].nz = 1;
m_pVertices[vertexCounter].tu = 0;
m_pVertices[vertexCounter].tv = 1;

vertexCounter++;
m_pVertices[vertexCounter].x = -0.5;
m_pVertices[vertexCounter].y = -0.5;
m_pVertices[vertexCounter].z = 0;   
m_pVertices[vertexCounter].nx = 0;
m_pVertices[vertexCounter].ny = 0;
m_pVertices[vertexCounter].nz = 1;
m_pVertices[vertexCounter].tu = 0;
m_pVertices[vertexCounter].tv = 0;

vertexCounter++;
m_pVertices[vertexCounter].x = 0.5;
m_pVertices[vertexCounter].y = 0.5;
m_pVertices[vertexCounter].z = 0;   
m_pVertices[vertexCounter].nx = 0;
m_pVertices[vertexCounter].ny = 0;
m_pVertices[vertexCounter].nz = 1;
m_pVertices[vertexCounter].tu = 1;
m_pVertices[vertexCounter].tv = 1;

vertexCounter++;
m_pVertices[vertexCounter].x = 0.5;
m_pVertices[vertexCounter].y = -0.5;
m_pVertices[vertexCounter].z = 0;   
m_pVertices[vertexCounter].nx = 0;
m_pVertices[vertexCounter].ny = 0;
m_pVertices[vertexCounter].nz = 1;
m_pVertices[vertexCounter].tu = 1;
m_pVertices[vertexCounter].tv = 0;

m_pIndices = new GLubyte[m_numVertices];
m_pIndices[0] = 0;
m_pIndices[1] = 1;
m_pIndices[2] = 2;
m_pIndices[3] = 3;

for( i = 0; i < m_numVertices; i++ )
{
    m_pVertexData[(i*stride)+0] = m_pVertices[i].x;
    m_pVertexData[(i*stride)+1] = m_pVertices[i].y;
    m_pVertexData[(i*stride)+2] = m_pVertices[i].z;
    m_pVertexData[(i*stride)+3] = m_pVertices[i].nx;
    m_pVertexData[(i*stride)+4] = m_pVertices[i].ny;
    m_pVertexData[(i*stride)+5] = m_pVertices[i].nz;
    m_pVertexData[(i*stride)+6] = m_pVertices[i].tu;
    m_pVertexData[(i*stride)+7] = m_pVertices[i].tv;
} 
```

作为一个 2d 应用程序，我没有使用法线。

这是保存 m_pVertices 数据的结构：

```
class GEMeshVertex {
public:
    float x, y, z;   // The untransformed position for the vertex.
    float nx,ny,nz;
    float tu, tv;    // The texture coordinates
} PACK_STRUCT; 
```

PACK_STRUCT 是一个字节对齐结构的宏：

```
#   define PACK_STRUCT  __attribute__((packed)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-07T18:22:20.437

我也有这个问题，很久没解决。直到最近我才发现它甚至可能不是我的代码中的错误。似乎异常被模拟器捕获并处理得很好。如果我让调试器恢复执行，应用程序会继续执行，就好像什么都没发生一样。

在没有附加调试器的情况下，我的应用程序在模拟器中空闲时不会崩溃，这一事实也说明了这一理论。此外，我的应用在实际设备上运行时从未出现过此问题。

天知道 OpenGL ES 模拟器在幕后做了什么。它似乎期待这个特定的例外，因为它准备从中恢复。

遗憾的是，不能指示 Xcode 忽略特定异常或特定模块中的异常。但这与其说是一个主要问题，不如说是一个烦恼。

现在我假设一切都很好，直到我发现与我的发现相矛盾的证据。

# php - php mailer 不向谷歌应用程序发送邮件

> ID：12846670
> 
> 赞同：0
> 
> 时间：2012-10-11T19:00:15.487
> 
> 标签：php, email, local

我最近将我的电子邮件帐户从主机迁移到了谷歌应用程序。但从那时起，我在网站上的 php 邮件表单不再起作用。它似乎一直将电子邮件发送到旧邮箱，并且似乎没有在全球范围内查找 DNS，因此它不会将电子邮件发送到谷歌应用程序。

有没有办法在不在线配置 smtp 的情况下解决这个问题？

编辑

让我这样解释一下：我可以通过谷歌应用程序在我的 gmail 帐户中阅读来自 www.domain.com 的邮件。因此，如果我发送到 jack@domain.com，我会在我的 gmail 概述中看到它。但！我的 phpmailerform 到 jack@domain.com 的邮件在我的 gmail 中不可见，尽管我仍然可以在我的网络邮件中看到它们。它以某种方式识别它是同一个域并在本地发送它我想......这是我想要避免的事情。希望现在清楚了吗？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:14:47.843

您应该更改服务器上该域的 MX 记录，以便它知道将电子邮件发送到 google 而不是 localhost。

# ruby-on-rails - Rails：未定义的方法'MODELNAME'？我在创建时保存了错误的东西吗？

> ID：12846672
> 
> 赞同：0
> 
> 时间：2012-10-11T19:00:33.077
> 
> 标签：ruby-on-rails

目前我正在为用户制作一个应用程序来创建相册。问题是每个相册可以有多个所有者，因此在创建相册的表单中有一个复选框部分，您可以在其中突出显示您的朋友姓名并“邀请他们”成为所有者。但是，我很难让它工作，因为它在我的`AlbumsController#create`. 错误是：

`undefined method 'user' for #<Album:0x007fcd9021dd00>`

`app/controllers/albums_controller.rb:43:in 'create'`

这是我的表格

```
<%= form_for ([@user, @album]), :html => { :id => "uploadform" } do |f| %>
<div class="formholder">
    <%= f.label :name %>
    <%= f.text_field :name %>

    <br>
    <label>Hosts</label>
    <% @user.friends.each do |friend| %>
    <%= friend.name %>
    <%= check_box_tag 'album[user_ids][]', friend.id, @album.users.include?(friend) %>
    <% end %>

    <%= f.label :description %>
    <%= f.text_area :description %>

    <br>

    <%=f.submit %>
</div>
<% end %> 
```

复选框返回一组`friend.id`值，我想邀请这些值成为专辑的所有者。这里棘手的部分是`pending_album`我的 join album_user 模型中有一个假想的列。以下是我无法弄清楚如何修复的错误：

专辑控制器

```
def create
  @user = User.find(params[:user_id])
  @album = @user.albums.build(params[:album], :status => 'accepted')
  @friends = @user.friends.find(params[:album][:user_ids])
  for friend in @friends
    params[:album1] = {:user_id => friend.id, :album_id => @album.id, :status => 'pending'}
    AlbumUser.create(params[:album1])
  end
      #the next line is where the error occurs. why???
  if @user.save
    redirect_to user_album_path(@user, @album), notice: 'Album was successfully created.'
  else
    render action: "new"
  end
end 
```

专辑模特

```
class Album < ActiveRecord::Base
  attr_accessible :name, :description, :user_ids
  validates_presence_of :name

  validates :user, :uniqueness => true

  has_many :album_users
  has_many :users, :through => :album_users
  has_many :photos

end 
```

用户模型

```
class User < ActiveRecord::Base

has_secure_password
attr_accessible :email, :name, :password, :password_confirmation, :profilepic
validates_presence_of :password, :on => :create

validates_format_of :name, :with => /[A-Za-z]+/, :on => :create
validates_format_of :email, :with => /\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\Z/i, :on => :create
validates_length_of :password, :minimum => 5, :on => :create
# validates :album, :uniqueness => true

has_many :album_users
has_many :albums, :through => :album_users, :conditions => "status = 'accepted'"
has_many :pending_albums, :through => :album_users, :source => :album, :conditions => "status = 'pending'"
accepts_nested_attributes_for :albums

has_many :friendships, :dependent => :destroy
has_many :friends, :through => :friendships, :conditions => "status = 'accepted'"
has_many :requested_friends, :through => :friendships, :source => :friend, :conditions => "status = 'requested'", :order => :created_at
has_many :pending_friends, :through => :friendships, :source => :friend, :conditions => "status = 'pending'", :order => :created_at

has_attached_file :profilepic

before_save { |user| user.email = email.downcase }

def name_with_initial
  "#{name}"
end

private

  def create_remember_token
    self.remember_token = SecureRandom.urlsafe_base64
  end 
```

结尾

album_user 连接表模型

```
class AlbumUser < ActiveRecord::Base
  attr_accessible :user_ids, :album_id, :status, :user_id
  belongs_to :album
  belongs_to :user
end 
```

参数（看起来有点可疑......特别是因为 album_id 为零）：

{"utf8"=>"✓", "authenticity_token"=>"xkIi6+1vjEk4yQcFs9vI1uvI29+Gyuenyp71vhpX9Hw=", "专辑"=>{"name"=>"123123", "user_ids"=>["27", " 28"], "description"=>"123123"}, "commit"=>"创建相册", "user_id"=>"29", "album1"=>{"user_id"=>28, "album_id"= >无，“状态”=>“待定”}}

我不太确定我做错了什么。有人可以帮忙吗！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:13:26.343

你的相册真的有很多用户吗？那应该返回方法“用户”吗？如果想要一个用户拥有的相册，您必须`belongs_to`在模型中使用。然后方法“user”将正确的用户返回到相册

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:14:16.547

错误信息是：

```
undefined method 'user' for #<Album:0x007fcd9021dd00> 
```

好吧，有东西在召唤`Album#user`。控制器中的第 46 行是`@user.save`，那么如何`user`调用呢？

```
class Album < ActiveRecord::Base
  attr_accessible :name, :description, :user_ids
  validates_presence_of :name

  validates :user, :uniqueness => true    # <-- bam!

  has_many :album_users
  has_many :users, :through => :album_users
  has_many :photos
end 
```

`save`触发验证，包括那里的那条线，它验证那`user`是唯一的。由于这正在爆炸，我猜这`user`是一个不存在的列，要么是因为 a) 它没有在迁移中定义，要么 b) 你没有运行迁移。

(As an aside, I'm rather confused as to why you would have a unique `user` attribute on `Album`, an `AlbumUser` model with both `user_id` and `user_ids`, and a `User` model. Maybe it makes sense, but I think it's more likely that it all needs a cleanup.)

# php - 为 PHP 准备的声明

> ID：12846674
> 
> 赞同：1
> 
> 时间：2012-10-11T19:00:53.790
> 
> 标签：php, login, prepared-statement

我正在关注 php.net 网站上的准备好的语句示例，但我似乎无法让我的版本正常工作。

```
$link = mysql_connect("localhost","root","mypassword") or die (mysql_error());

$query= $link->prepare("select * from users WHERE userid = ? AND password=password('?')");
$query->bindParam(1, $userid);
$query->bindParam(2, $password);
$query->execute();

if (mysql_num_rows($query)==1)
    {
        echo "Welcome, ",$userid,"\n";
    }
    mysql_close($link); 
```

我收到错误：语法错误，意外的 T_VARIABLE

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T19:07:07.173

使用`mysqli_*`喜欢`$link = mysqli_connect(...`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:02:14.507

改变`echo "Welcome, ",$userid,"\n";`

到

`echo "Welcome, " . $userid . "\n";`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T19:20:17.467

更改以下代码

```
` echo "Welcome,",$userid,"\n";`
```

进入

```
` 回声“欢迎”。$用户标识。"\n";`
```

这是因为，PHP 使用 '.' 用于连接字符串。

# html - 我的网站上的 Gravatar 图像模糊？

> ID：12846676
> 
> 赞同：0
> 
> 时间：2012-10-11T19:00:59.387
> 
> 标签：html, image, gravatar

好的，所以我一直在尝试为我的用户 Gravatar 图像设置样式。问题是，当我尝试放大图像时，即使我在测试帐户上上传的照片真的是高分辨率的，图像也会变得如此模糊。我在其他网站上看到过大约 H:200px W:200px 的 gravatar，并且照片的分辨率非常完美。现在我想我可能试图以不正确的方式调整照片大小

```
<img class="img-circle" height="200px" width="200px" src="<?php echo $profile->get_gravatar($profile->getField('email'), false, 54); ?>"/> 
```

我在 img class="img-circle" 之后添加了高度和宽度，我认为这可能是不正确的？这里还有它的外观和外观的图像。

正确（来自 Photoshop）

![在此处输入图像描述](../Images/e1e9d2da3d0efb601b3531f82601d5b4.png)

![在此处输入图像描述](../Images/d64aed8c45aa55db1d50f263eff80541.png)

不正确和模糊（现场直播）。注意服务器失真。

我想我需要告诉 CSS 从 Gravatar 中提取照片的原始大小并以常规分辨率显示，因为直接将宽度和大小添加到标签只会在网站上炸毁它。有想法该怎么解决这个吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T19:04:04.317

当您获得 Gravatar 图像 URL 时，您会告诉服务器要获取什么分辨率。现在你要求一个 54x54 像素的图像：

```
<?php echo $profile->get_gravatar($profile->getField('email'), false, 54); ?> 
```

将最后一个数字更改为 200（以匹配您要显示的大小），您应该没问题。

# html - 网站上的电话号码在 iPhone 上显示为蓝色

> ID：12846677
> 
> 赞同：4
> 
> 时间：2012-10-11T19:00:59.623
> 
> 标签：html, css

我没有 iPhone，但我的客户告诉我，电话号码（在我为他制作的网站上）在他的 iPhone 上变成蓝色。解决此问题的最佳方法是什么？

*注意：这不是我网站上的链接，但 safari 浏览器似乎将其合二为一*

```
<span>(873)984-0923</span> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-11T19:04:30.573

添加此元标记：

```
<meta name="format-detection" content="telephone=no" /> 
```

来自文档： [https ://developer.apple.com/library/safari/#codinghowtos/Mobile/UserExperience/_index.html](https://developer.apple.com/library/safari/#codinghowtos/Mobile/UserExperience/_index.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T19:02:37.033

iPhone 上的所有电话号码都会变为蓝色，以便您轻松拨打电话。这是手机的内置功能

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-30T13:25:06.600

我知道这个问题很老，但它是我在谷歌得到的第一个结果，并且接受的答案对我来说还不够好。

IOS实际上将数字变成了链接，所以我最终做的是将电话号码包装在一个跨度中：

```
<span class="iwrap">01234 567889</span> 
```

然后添加一个css样式来定位IOS生成的链接标签：

```
.iwrap a {
    color: #ffffff;
    text-decoration: none;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T19:02:51.587

这是默认的 iOS 行为 - 纠正尝试在数字之间放置 ASCII 字符。

例如，号码`111 111 1111`将转到`111&nbsp;111&nbsp;1111&nbsp;`

或者号码`111-111-111`会转到`111&ndash;111&ndash;1111&ndash;`

`<head>`或者使用文档部分中 的元标记。

`<meta name="format-detection" content="telephone=no" />`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-05T10:42:49.833

它受链接样式的影响。只需为您的电话号码创建一个类，您可以在其中按照您希望它们显示的方式设置您的“a”标签。这样用户仍然可以通过点击来拨打电话。

# c# - 计算偏移量的更简洁的方法是什么？

> ID：12846678
> 
> 赞同：-2
> 
> 时间：2012-10-11T19:01:03.803
> 
> 标签：c#, arrays, algorithm, refactoring

这段代码：

```
private int GetColumnToPopulate(int columnBase, int offset) {
    int duckbillColNum = 0;
    switch (columnBase) {
        case 0:
            duckbillColNum = 1;
            break;
        case 1:
            duckbillColNum = 5;
            break;
        case 2:
            duckbillColNum = 9;
            break;
        case 3:
            duckbillColNum = 13;
            break;
        case 4:
            duckbillColNum = 17;
            break;
        case 5:
            duckbillColNum = 21;
            break;
        case 6:
            duckbillColNum = 25;
            break;
        case 7:
            duckbillColNum = 29;
            break;
    }
    duckbillColNum += offset;
    return duckbillColNum;
} 
```

...很容易理解，但冗长而笨拙。我想精简它。我的伪代码想法是这样的：

```
int[] colBases
{
    0..7
}
int[] offsets
{
    1,5,9,13,17,21,25,29
}
int idx = colBases.IndexOf(columnBase);
duckbillColNum = offsets[idx]; 
```

...或者也许是一个多维 int 数组？无论如何，“IndexOf”业务当然不会编译[ile,ute]。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-11T19:04:13.183

怎么样：

```
private int GetColumnToPopulate(int columnBase, int offset) {
   return (columnBase * 4) + 1 + offset;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T19:07:25.863

考虑使用 a `Dictionary`，您可以像这样定义它：

```
Dictionary<int, int> offsets = new Dictionary<int, int>()
    {
        { 0, 1 },
        { 1, 5 },
        { 2, 9 },
        { 3, 13 },
        { 4, 17 },
        { 5, 21 },
        { 6, 25 },
        { 7, 29 },
    } 
```

然后在使用时：

```
return offsets[columnBase]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T19:04:05.583

在我看来，您应该用这个表达式替换开关，`duckbillColNum = columnBase*4 +1;`不是吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-11T19:04:08.297

这只是一个简单的数学模式：

```
private int GetColumnToPopulate(int columnBase, int offset) 
{ return 1 + (columnBase * 4) + offset; } 
```

# knockout.js - 在淘汰赛中更新子模型后，我的事件不会被触发

> ID：12846685
> 
> 赞同：0
> 
> 时间：2012-10-11T19:01:19.993
> 
> 标签：knockout.js

在我更新子模型之前，我的偶数被解雇了。在我更新子模型后，事件不再触发。更新模型的方法是 data-bind="click: MyClickFunction" 在 MyClickFunction 中，模型被传递了一个 CommunityModel 的新对象，所有属性都是可观察的。

```
parentVM.NewPolicy().Community(myCM()); 
```

在此之后，甚至不再开火。

```
 <input class="column required restrictedAutoComplete mediumInputBox ui-widget-content ui-corner-all"
       data-bind="jqAuto: { autoFocus: true, minLength: 0 },
                                        jqAutoSource: viewModel.InitializationValues.ListsOptions.AvailableGrandfatheringTypesArray,
                                        jqAutoValue: viewModel.NewPolicy().Community().GrandfatheringType,
                                        jqAutoSourceLabel: 'Name',
                                        jqAutoSourceInputValue: 'Name',
                                        jqAutoSourceValue: 'ID', valueUpdate: {mouseclick: viewModel.CommunityInfoVM().myAlert() }" placeholder="Grandfathering" /> 
```

# javascript - 将 knockout.js observablearray 对象传递给 MVC 控制器操作？

> ID：12846689
> 
> 赞同：14
> 
> 时间：2012-10-11T19:01:39.823
> 
> 标签：javascript, jquery, asp.net-mvc, knockout.js

我使用 MVC 淘汰赛。我试图将一个可观察的对象数组从淘汰赛传递回我的 MVC 控制器操作以保存到数据库。如果我通过 ko.toJSON(viewModel.ArrayName) 将 Array 从淘汰赛传递给我的控制器操作，它在我的控制器参数中返回为 null。如果我尝试通过 ko.toJS(viewModel.ArrayName) 将它传递给 MVC，它具有正确的项目数，但由于某种原因数据为空。任何有关如何做到这一点的帮助将不胜感激。谢谢！

**我的 JQuery 数据检索方法：**

```
var dataService = {};
var viewModel;

$(document).ready(function () {
    dataService.getAccessLevelList();
})

dataService.getAccessLevelList = function () {
    $.post('/DataService/GetAccessLevelList', null, function (data) {
        viewModel = ko.mapping.fromJS(data); 
        ko.applyBindings(viewModel);
    });
} 
```

**这是问题方法：**

```
updateAccessLevels = function () {
    $.post('/DataService/UpdateAccessLevels', { accessLevels: ko.toJSON(viewModel.AccessLevels) }, function (status) {
        alert(status);
    });
} 
```

**我的 MVC 控制器数据检索操作：**

```
 [HttpPost]
    public ActionResult GetAccessLevelList()
    {
        FacilityAccessViewModel viewModel = new FacilityAccessViewModel();
        viewModel.AccessLevels = unitOfWork.AccessLevelRepository.Get().ToList();
        return Json(viewModel);
    } 
```

**尝试在此控制器方法上从 Knockout 传递参数时，参数返回 NULL 或带有 NULL 数据。**

```
 [HttpPost]
    public ActionResult UpdateAccessLevels(List<AccessLevel> accessLevels)
    {
        try
        {
            foreach (AccessLevel record in accessLevels)
            {
                unitOfWork.AccessLevelRepository.Update(record);
            }

            unitOfWork.Save();
            return Json("SUCCESS");
        }
        catch (Exception ex)
        {
            return Json(ex.ToString());
        }
    } 
```

**下面是通过提琴手显示的 JSON 数据，当我传入 { accessLevels: ko.toJSON(viewModel.AccessLevels) } 时，控制器参数将使用此参数为 null**

```
[{"Access":[],"Id":1,"AccessLevelDesc":"TEST222"},{"Access":[],"Id":2,"AccessLevelDesc":"TEST222"}] 
```

**下面是通过提琴手显示的 JS 数据，当我传入 { accessLevels: ko.toJS(viewModel.AccessLevels) } 时，这些数据被发布到我的 MVC 控制器操作中，在这种情况下，列表有两个预期的成员，但数据全部为空在属性中**

```
accessLevels[0][Id] 1
accessLevels[0][AccessLevelDesc]    TEST222
accessLevels[1][Id] 2
accessLevels[1][AccessLevelDesc]    TEST222 
```

如果我将单个对象传递给我的控制器，它工作得很好，但我似乎无法弄清楚将对象数组从 obervablearray 发布回 POCO 实体的正确方法。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-12T13:52:51.877

尝试通过指定正确的请求 Content-Type 标头将其作为 JSON 请求发送：

```
updateAccessLevels = function () {
    $.ajax({
        url: '/DataService/UpdateAccessLevels', 
        type: 'POST',
        contentType: 'application/json; charset=utf-8',
        data: ko.toJSON(viewModel.AccessLevels),
        success: function(status) {
            alert(status);
        }
    });
}; 
```

# c# - dataGridView 列标题

> ID：12846692
> 
> 赞同：-1
> 
> 时间：2012-10-11T19:01:55.863
> 
> 标签：c#, .net, datagridview

我正在将 excel 文件读入 C#.NET 中的 dataGridView 中，但是它为第一行呈现列标题，如何消除呈现列标题以便所有行看起来都一样？

我有 openDialogBox1 和 button1 来打开这个对话框并选择 excel 文件：

```
private void button1_Click(object sender, EventArgs e)
        {
            if (openFileDialog1.ShowDialog() == DialogResult.OK)
            {                
                Excel.Application excelApp = new Excel.Application();
                //excelApp.Visible = true;

                Excel.Workbook theWorkbook = excelApp.Workbooks.Open(openFileDialog1.FileName, 0, true, 5,
                                                                    "", "", true, Excel.XlPlatform.xlWindows, "\t", false, false,
                                                                    0, true);
                Excel.Sheets sheets = theWorkbook.Worksheets;
                Excel.Worksheet worksheet = (Excel.Worksheet)sheets.get_Item(1);

                /*
                for (int i = 1; i <= 3; i++)
                {
                    Excel.Range range = worksheet.get_Range("A"+i.ToString(), "B" + i.ToString());
                    dataGridView1.DataSource = rangeTable(range);                                        
                }
                 */
                Excel.Range range = worksheet.get_Range("A1", "B3");
                dataGridView1.DataSource = rangeTable(range);                                                                 
            }            
        }

        private DataTable rangeTable(Excel.Range range)
        {
            DataTable dataTable = new DataTable();
            int rowCnt = range.Rows.Count;
            int colCnt = range.Columns.Count;

            for (int i = 1; i <= rowCnt; i++)
            {
                DataRow newRow = dataTable.NewRow();
                for (int j = 1; j <= colCnt; j++)
                {
                    if (i == 1)
                    {
                        dataTable.Columns.Add(((Excel.Range)range.get_Item(i, j)).Value2.ToString(), typeof(string));
                    }
                    else
                    {
                        newRow[j - 1] = ((Excel.Range)range.get_Item(i, j)).Value2;
                    }
                }
                if (i > 1)
                {
                    dataTable.Rows.Add(newRow);
                }
            }
            return dataTable;
        } 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:06:51.290

设置`RowHeadersVisible="false"` 请参见此处：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.rowheadersvisible.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.rowheadersvisible.aspx)

# liferay-6 - 如何在主题中仅显示用户的公共和私人网站

> ID：12846703
> 
> 赞同：1
> 
> 时间：2012-10-11T19:02:22.307
> 
> 标签：liferay-6, liferay-theme

在打印用户所属的私人和公共网站时，我需要帮助。

通过从帖子中恢复代码（[如何获取用户是 Liferay 主题成员的站点？](https://stackoverflow.com/questions/12469131/how-do-i-get-sites-of-which-the-user-is-a-member-in-liferay-theme/12477508#12477508)）我能够获取这些站点，但它也提供了用户的私人和公共页面。

如何避免打印用户的私人和公共页面，因为我只需要社区或站点。

```
<ul>
    #foreach($site in $user.mySites)
       #if ($site.hasPrivateLayouts())
              <li><a href="/group${site.friendlyURL}">$site.descriptiveName</a></li>
       #end
       #if ($site.hasPublicLayouts())
              <li><a href="/web${site.friendlyURL}">$site.descriptiveName</a></li>
    #end
    #end
</ul> 
```

**环境：Liferay 6.1**

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T06:50:18.547

我认为您应该使用用户服务和组服务来获取用户组，而不是为用户使用 mysites 部分。

```
#set($userId = $getterUtil.getLong($request.remote-user))
#set($userLocalService = $serviceLocator.findService("com.liferay.portal.service.UserLocalService"))
#set($user = $userLocalService.getUserById($userId))
#set($groupLocalService=$serviceLocator.findService("com.liferay.portal.service.GroupLocalService"))
#set($userGroup = $groupLocalService.getUserGroup($companyId,$getterUtil.getLong($userId)))

$userGroup 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T12:37:47.823

我认为您可以使用相同的代码进行一些更改：

```
<ul>
    #foreach($site in $user.mySites)        
        <!-- if it is NOT a user's public or private site only then print it -->
        #if(!$site.isUserPersonalSite())            
            #if ($site.hasPrivateLayouts())
                <li><a href="/group${site.friendlyURL}">$site.descriptiveName</a></li>
            #end

            #if ($site.hasPublicLayouts())
                <li><a href="/web${site.friendlyURL}">$site.descriptiveName</a></li>
            #end
        #end
    #end
</ul> 
```

请注意`if(!$site.isUserPersonalSite())`代码，如果站点是用户的公共或私人站点（即包含用户的公共和私人页面），则不要打印任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T20:46:51.173

`portal-ext.properties`在 Liferay 根目录中更新以下属性

```
# Deactivate Personal Community with *private* pages:
layout.user.private.layouts.enabled=false   

# Deactivate Personal Community with *public* pages:
layout.user.public.layouts.enabled=false 
```

# iphone - shouldAutorotateToInterfaceOrientation 有问题

> ID：12846704
> 
> 赞同：0
> 
> 时间：2012-10-11T19:02:28.800
> 
> 标签：iphone, objective-c, ios, ipad

我的 UIViewController 中有以下代码，我正在设备和模拟器中测试 iOS 5。

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    if (IS_IPHONE){
        return interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown;
    } else {
        return YES;
    }
} 
```

我放了一个断点，它确实被调用了，但是它仍然旋转到横向。为什么是这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:05:06.127

因为你告诉它这样做。`return interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown;`意味着您要自动旋转到**除纵向倒置之外的每个方向**，包括横向。对于 iPad，即使没有这个约束，它也会自动旋转到任何方向。

（你应该对文档有新鲜感......）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:04:54.337

改用这个

> return (interfaceOrientation == UIInterfaceOrientationPortrait);

# .net - FParsec - 如何从标准输入流中解析

> ID：12846706
> 
> 赞同：0
> 
> 时间：2012-10-11T19:02:29.247
> 
> 标签：.net, parsing, f#, fparsec

我似乎无法使用 FParsec 从标准输入流中成功解析。我将我的案例简化为这个非常简单的代码：

```
match (runParserOnStream (pstring "test" .>> FParsec.CharParsers.newline) () "stdin" (Console.OpenStandardInput ()) Console.InputEncoding) with
    | Success(result, _, _)   -> printfn "Success: %A" result
    | Failure(errorMsg, perr, _) -> printfn "Failure: %s" errorMsg 
```

但是当我运行程序时，输入字符串测试，然后按回车，它挂在那里，我似乎无法弄清楚为什么..

解决方案是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T23:09:10.910

出于性能和简单性的原因，FParsec 逐块读取输入流（或在开始解析之前将完整流读入字符串）。有关更多详细信息，请参见例如此答案：[Chunked Parsing with FParsec](https://stackoverflow.com/questions/8891019/chunked-parsing-with-fparsec?rq=1)

如果你想用 FParsec 解析来自 REPL 的输入，你可以实现一个简单的扫描器，等待输入流中的终止符（例如，“;;”后跟换行符，就像在 FSI 控制台中一样），然后，当它遇到这样的终止符，将输入到终止符复制到一个字符串中，并将其交给 FParsec 解析器进行评估。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T19:16:42.803

由于 FParsec 的源代码可用，因此很容易单步执行它并查看它读取输入流，直到缓冲区已满或发出流结束信号。

或者，您可以一次读取一行：

```
let rec parseConsoleInput() =
  let parser = pstring "text" .>> eof
  Console.Write("> ")
  match Console.ReadLine() with
  | null | "" -> ()
  | input -> 
    match run parser input with
    | Success(result, _, _) -> printfn "Success: %A" result
    | Failure(msg, _, _) -> printfn "Failure: %s" msg
    parseConsoleInput() 
```

# java - 用参数封装命令的更好方法

> ID：12846709
> 
> 赞同：0
> 
> 时间：2012-10-11T19:02:40.060
> 
> 标签：java, encapsulation

我有一个具有多种方法的 impl 类，它们基本上都使用具有不同参数列表的 runtime.exec 调用脚本，例如

```
public String doExport(String ruleIds, String fileName) throws Exception{
        StringBuffer cmd = new StringBuffer();
        cmd.append(SOME_SCRIPT + " -a export ");
        cmd.append(" -f " );
        cmd.append(fileName);
        cmd.append(" -r " );
        cmd.append(ruleIds);
        cmd.append(" 2>/dev/null");
        return execCmd(cmd.toString());
    }

    public String doImport(String fileName, String user, String iface) throws Exception {
        StringBuffer cmd = new StringBuffer();
        cmd.append(SOME_SCRIPT + " -a import ");
        cmd.append(" -f " );
        cmd.append(fileName);
        cmd.append(" -m " );
        cmd.append("user");
        cmd.append(" -u " );
        cmd.append(user);
        cmd.append(" -I " );
        cmd.append(iface);
        return execCmd(cmd.toString());
    } 
public String setRulesMode(String mode) throws Exception {
        String cmd = SOME_SCRIPT + " -a ";
        return execCmd(cmd.toString());
    } 
```

有没有更好的方法来做到这一点？喜欢封装命令和参数或更通用的方法？我尝试使用枚举，但发现当有静态/常量参数列表时使用枚举更好，因此寻找更好的替代方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:15:00.463

我将创建包装`ProcessBuilder`并能够编写和运行命令行的“CommandBuilder”。

请注意，您尝试将 STDOUT 重定向到文件将不起作用。重定向是一个 shell 功能。您可以通过 shell 运行命令（例如`/bin/sh YOUR COMMAND >YOURFILE`在 unix 或 `cmd -c YOUR COMMAND >YOURFILE`windows 上）。

更好的方法是`Process.setOutputStream()`从java中使用。它是可移植的，更易于调试和维护。这可以是您的`CommandBuilder`.

编辑

以下是 CommandBuilder 结构的一些提示。

```
public class CommandBuilder {
    public void setPrefix(); // e.g. cmd or /bin/sh But some kind of automatic logic should be implemented too, i.e. cmd for windows, /bin/sh for unix
    public void setCommand(); // for example ping
    public void addArgument(String value);  // e.g. myhost
    public void setInputStream(InputStream in);
    public void setOutputStream(OutputStream in);

    // add appropriate getters.

    public Process exec();
    public int execAndWait(); // returns process status
} 
```

# awk - 在 gnuplot 函数中使用 awk 或其他 shell 命令

> ID：12846717
> 
> 赞同：17
> 
> 时间：2012-10-11T19:03:03.850
> 
> 标签：awk, gnuplot

我想要这样的东西：

```
file1='logs/last/mydata1.log'
file2='logs/last/mydata2.log'

# declare function that uses awk to reshape the data - does not work :(
sum1(fname)=("<awk '{sum=0; for(i=8;i<=NF;i+=2) sum+=$i; print $1,sum/2}' $fname")
sum2(fname)=("<awk '{sum=0; for(i=9;i<=NF;i+=2) sum+=$i; print $1,sum/2}' $fname")

# plot different columns of my file and awk processed file
plot file1 u 1:2 title "thing A measure 1" w l, \
     file1 u 3:4 title "thing A measure 2" w l, \
     file2 u 1:2 title "thing B measure 1" w l, \
     file2 u 3:4 title "thing B measure 2" w l, \
     sum1(file1) u 1:2 title "group A measure 1" w l, \
     sum2(file1) u 1:2 title "group A measure 2" w l, \
     sum1(file2) u 1:2 title "group B measure 1" w l, \
     sum2(file2) u 1:2 title "group B measure 2" w l 
```

不工作的是`awk`gnuplot 函数内部的部分。工作正常后直接使用我的`awk`脚本`plot`：

```
plot "<awk '{sum=0; for(i=9;i<=NF;i+=2) sum+=$i; print $1,sum}' ./logs/last/mydata1.log" u 1:2 w l 
```

有没有办法`awk`在 gnuplot 函数中放置或其他 shell 命令？我知道我可以将 awk 脚本外包给另一个文件，然后直接 awk 这个文件`plot`，但我不想要单独的文件。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-12T12:05:58.217

`$var`不会`var`像在 shell 中那样在 gnuplot 中的字符串中展开。您想使用 gnuplot 的字符串连接（使用`.`运算符）：

```
sum1(fname)="<awk '{sum=0; for(i=8;i<=NF;i+=2) sum+=$i; print $1,sum/2}' ".fname 
```

`sprintf`或者，如果您觉得更舒服，我想您可以使用：

```
sum1(fname)=sprintf("<awk '{sum=0; for(i=8;i<=NF;i+=2) sum+=$i; print $1,sum/2}' %s",fname) 
```

*请注意，这实际上并不执行命令。它只是构建将传递给的字符串，`plot`然后`plot`执行命令。如果你真的想在函数中执行命令，你可以`system`作为函数调用。从文档：

```
`system "command"` executes "command" using the standard shell. See `shell`.
 If called as a function, `system("command")` returns the resulting character
 stream from stdout as a string.  One optional trailing newline is ignored.

 This can be used to import external functions into gnuplot scripts:

       f(x) = real(system(sprintf("somecommand %f", x))) 
```

# ruby - 如何根据类别列出 YAML 记录？

> ID：12846718
> 
> 赞同：0
> 
> 时间：2012-10-11T19:03:03.417
> 
> 标签：ruby, yaml

我有一个 YAML 数据库，其中包含以下格式的数据：

```
- product:
  name: Apples

- product:
  name: Grapes 
```

如何更新它以便将每个产品分配给一个类别，然后在我的页面上我可以在类别标题下列出产品的无序列表？

例如：

```
Fruit
  *Apples
  *Grapes

Vegetables
  *Tomatoes
  *Broccoli 
```

我尝试搜索类似这样的示例，但找不到任何东西。有可能做这样的事情吗？

```
- category:
  name: fruit

  - product:
    name: Apples

  - product:
    name: Grapes

- category:
  name: vegetables

  - product:
    name: Tomatoes

  - product:
    name: Broccoli 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:11:44.707

我建议两个方案，第一个将所有产品组合在一起：

```
products:
  - name: Apple
    type: Fruit

  - name: Grape
    type: Fruit

  - name: Tomato
    type: Vegetable

  - name: Brocoli
    type: Vegetable 
```

另一种方案将针对每种类型的产品在组上使用

```
fruits:
  - name: Apple

  - name: Grape

vegetable:
  - name: Tomato

  - name: Brocoli 
```

要实际显示这一点，您只需使用类似的内容加载 yaml 数据（如果这已经改变，请原谅我......自从我使用 yaml 已经有一段时间了）：

```
require 'yaml'
data = YAML.load_file('data.yml') 
```

data 本质上只是一个 ruby​​ 哈希，因此您可以通过遍历它来显示您喜欢的任何内容。

编辑：

如果第二个选项是你想要的。尝试以下操作：

```
require 'yaml'

data = YAML.load_file('data.yml')
data.each do |category, products|
  puts "#{category}"
  products.each do |product|
    puts "\t#{products}"
  end
end 
```

输出应该是：

```
fruits
     Apple
     Grape
vegetable
     Tomato
     Brocoli 
```

如果要输出html，则将其修改为：

```
require 'yaml'

data = YAML.load_file('data.yml')
data.each do |category, products|
  puts "#{category}"
  puts "<ul>"
  products.each do |product|
    puts "<li>#{products}</li>"
  end
  puts "</ul>"
end 
```

您可以看到添加 html 格式的差异非常简单，您应该能够根据需要进一步修改它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:07:55.593

您可以`category`为每个分配一个属性`Product`：

```
- name: Apples
  category: Fruit
- name: Grapes
  category: Fruit
- name: Tomatoes
  category: Vegetables
- name: Broccoli
  category: Vegetables 
```

...然后加载所有`Fruit`s 的数据：

```
require "yaml"
YAML.load("products.yml").select{ |product| product["category"] == "Fruit" }
# => [{"name"=>"Apples", "category"=>"Fruit"}, {"name"=>"Grapes", "category"=>"Fruit"}] 
```

# facebook - Facebook og:title 和 og:site_name 永远不会更新

> ID：12846720
> 
> 赞同：0
> 
> 时间：2012-10-11T19:03:18.813
> 
> 标签：facebook, facebook-graph-api

我们的 Facebook 应用程序被 Facebook 命名为“主页”，这不是我们应用程序的首选名称！我们尝试更新 og 元标记无济于事。我们检查了调试页面，试图强制刷新。像 og:description 这样的其他元标记确实更新成功，但 og:title 和 og:sitename 没有。unix 时间戳总是新鲜的，刮板显示正确的信息，即：

```
http://developers.facebook.com/tools/debug/og/object?q=[our site url]

Meta Tag: meta property="og:title" content="*old title that does not update*" ...

Meta Tag: meta property="og:site_name" content="*old title that does not update*" ...

vs: http://developers.facebook.com/tools/debug/og/echo?q=[our site url] 
```

我们在哪里看到：

```
meta id="FBItemTitle" property="og:title" content="*new title that we want*"...

meta id="SiteName" property="og:site_name" content="*new title that we want*"... 
```

Facebook 是否有可能只是拒绝更新站点 URL 或画布页面的标题和站点名称？

# javascript - 解释 Javascript 闭包

> ID：12846721
> 
> 赞同：1
> 
> 时间：2012-10-11T19:03:19.950
> 
> 标签：javascript, closures

> **可能重复：**
> [JavaScript 闭包是如何工作的？](https://stackoverflow.com/questions/111102/how-do-javascript-closures-work)

我正在尝试在循环内的另一个函数中使用循环计数器的值。我知道这与函数闭包有关。它变得有点混乱。我想如果有人可以解释这个问题，我会理解的。

```
for (var i = 0; i < foo.length; i++) {
    // $('<li/>').addClass('box').append($('<img/>').attr({'src':foo[i].image, 'data-phrase':foo[i].phrase}).hide()).appendTo($('ul.boxPack'))
    $('<li/>').addClass('box')
              .attr('data-phrase', foo[i].phrase)
              .bind('click', function (i) {
                   alert(i);
                   console.log(foo[2]);
                   $(this).append($('<img/>').attr('src', foo[2].image))
               })
              .appendTo($('ul.boxPack'));
} 
```

我无法警觉`i`。

# iphone - 视图之间的 Xcode HTTP GET REQUEST

> ID：12846724
> 
> 赞同：1
> 
> 时间：2012-10-11T19:03:34.180
> 
> 标签：iphone, xcode, http, geolocation, xmlhttprequest

我对 xcode 非常陌生，并且知道一些编码，但我正在尝试在我的应用程序中实现 api 的使用。这是我正在尝试做的事情。

*   从我的第一个视图控制器中获取地理位置。
*   从我的第二个视图控制器中获取几个变量。
*   使用所有收集的变量并生成我的 HTTP 请求
*   在我的第三个视图控制器上显示返回的数据。

我已经设置了我的视图控制器，并且我的第一个视图控制器已经找到了我。

任何帮助将不胜感激。我在山狮上使用最新的 xcode，这是需要发送的请求[http://yourtaxmeter.com/api/?key=...](http://yourtaximeter.com/api/?key=APIKEY&type=fare&day=05&month=10&year=2012&hour=14&minute=54&passengers=2&mobile=0&from=Cambridge&to=Granchester&return=xml)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:13:26.673

不要在视图控制器中实现逻辑，为所有连接使用另一个类。例如“ConnectionManager”类或“DataManager”类。看看[这个](https://stackoverflow.com/questions/5896072/connection-manager-singleton-or-not-singleton)问题。

您还可以查看[AFNetworking](https://github.com/AFNetworking/AFNetworking)并使用他们的[AFHTTPClient](http://afnetworking.github.com/AFNetworking/Classes/AFHTTPClient.html)为您自己的 api 创建一个子类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:36:03.867

在请求之前的 VC 上，声明一个属性（和@synthesize）来保存网络请求的结果。

```
@property (nonatomic, strong) NSData *responseData; 
```

然后在任何触发请求的事件上，像这样启动它：

```
NSString *urlString = /* form the get request */
NSURL *url = [NSURL urlWithString:urlString];
NSURLRequest *request = [NSURLRequest requestWithURL:url];

// consider doing some UI on this VC to indicate that you're working on a request

[NSURLConnection sendAsynchronousRequest:request queue:[NSOperationQueue mainQueue] completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
    if (!error) {
        self.responseData = data;
        // hide the "busy" UI
        // now go to the next VC with the response
        [self performSegueWithIdentifier:@"ThridVCSegue" sender:self];
    }
}]; 
```

然后将响应数据传递给第三个 VC，如下所示：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

    if ([[segue identifier] isEqualToString:@"ThridVCSegue"]) {
        ThirdViewController *vc = (ThirdViewController *)[segue destinationViewController];
        [vc dataFromHTTPRequest:self.responseData];
    }
} 
```

这假设您将使用 ARC、故事板并定义该 segue。ThirdViewController 需要一个公共方法来接受 http 响应数据。

# asp.net-mvc - mvc 万无一失的验证客户端脚本直到提交表单后才显示

> ID：12846736
> 
> 赞同：2
> 
> 时间：2012-10-11T19:04:09.343
> 
> 标签：asp.net-mvc

我在 MVC 3 中的几个问题上使用了万无一失的方法。具体来说，我有带有 textarea 的单选按钮，如果选择了单选按钮“是”，那么 textarea 不能为空。我对某些字段进行了其他验证，使用常规的 'Required' 属性并且工作正常，但 'RequiredIfTrue' 属性在客户端没有验证。因此，如果我填写所有字段以便它们进行验证，然后在收音机上单击“是”但将相应的文本区域留空，然后提交，表单会到达服务器而不是验证客户端。我还注意到，在浏览器中查看源代码时，直到提交表单后，'RequiredIfTrue' 属性才会添加到 HTML 中。

我正在为这个项目使用 ViewModel，这似乎是问题所在。当前属性在模型中的属性上，然后我在 ViewModel 中引用该模型并将 ViewModel 传递给 View。但是如果我将属性直接放在 ViewModel 中，它就可以正常工作。我不想要 hte ViewModel 中的属性，因为我不需要向 ViewModel 添加某种映射代码以便属性与正确的模型/表相关联吗？

这些是项目中包含的脚本：

```
<link href="@Url.Content("~/Content/mvc.css")" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Content/jquery-ui-1.8.22.custom.css")" rel="Stylesheet"" type="text/css" />
<script src="@Url.Content("~/Scripts/jquery-1.8.2.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/modernizr-1.7.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery-ui-1.8.22.custom.min.js")" type="text/javascript""></script>
<script src="@Url.Content("~/Scripts/HistoryArrayTables.js")" type="text/javascript""></script>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script>

<script src="@Url.Content("~/Scripts/MicrosoftAjax.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/MicrosoftMvcAjax.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/MicrosoftMvcValidation.js")" type="text/javascript"></script>

<script src="@Url.Content("~/Scripts/mvcfoolproof.unobtrusive.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/MvcFoolproofJQueryValidation.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/MvcFoolproofValidation.min.js")" type="text/javascript"></script> 
```

这是模型的一部分：

```
using Foolproof;

namespace EligibityForm.Models
{
[MetadataType (typeof(HistoryMetadata))]
public partial class History
{
}

public class HistoryMetadata
{

    [StringLength(2000)]
    [RequiredIfTrue("HasComment", ErrorMessage="Please enter an explanation")]
    [Display(Name = "Have you EVER been subject to a lawsuit?")]
    public string Comment { get; set; }

    public bool HasComment { get; set; }
} 
```

这是 ViewModel 的一部分：

```
using Foolproof;

namespace EligibityForm.Models.CompositeModels
{
    public class HistoryViewModel
    {
        public History HistoryModel { get; set; } 
```

谢谢。

# codeigniter - CodeIgniter 登录错误

> ID：12846738
> 
> 赞同：0
> 
> 时间：2012-10-11T19:04:15.297
> 
> 标签：codeigniter

你好，当我尝试使用代码点火器登录时，我遇到了这个错误

```
The action you have requested is not allowed. 
```

这是我对 csrf 的配置：

```
$config['csrf_protection'] = TRUE;    
$config['csrf_token_name'] = 'csrf_token_name';    
$config['csrf_cookie_name'] = 'csrf_cookie_name';   
$config['csrf_expire'] = 7200; 
```

嗯，它是一个定制的 CMS，用于魔兽世界模拟，称为 FusionCMS，它使用连接到 MySQL 数据库的 php。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:10:27.657

您提交的每个表单都需要`form_open('form_action_url')`从表单助手中使用，以便 CodeIgniter 自动插入 CSRF 字段。确保您以这种方式打开表单，而不是通过`<form method="POST" action="form_action_url">`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T05:43:37.050

## [根据此线程，](http://codeigniter.com/forums/viewthread/163976/)您有两个选择：

`form_open()`用作[Form Helper](http://codeigniter.com/user_guide/helpers/form_helper.html)的一部分。这个函数会自动生成csrf token到一个隐藏的`<input>`

或者，香草 HTML 与手动 csrf 令牌结合使用：

```
<form method='post' action='somecontroller'>
    <input type="hidden" name="<?= $this->security->get_csrf_token_name()?>" value="<?= $this->security->get_csrf_hash()?>" >
    <input .../>
</form> 
```

*请注意，如果您收到错误消息，指出`get_csrf_hash()`不存在，您可能使用的是旧版本的 CI，可以使用它来代替：*

```
<input type="hidden" name="<?= $this->security->csrf_token_name?>" value="<?= $this->security->csrf_hash?>" /> 
```

# sql - 具有可变列名的动态更新语句

> ID：12846743
> 
> 赞同：20
> 
> 时间：2012-10-11T19:04:36.003
> 
> 标签：sql, sql-server, tsql

我们希望在几个 SQL Server 数据库中进行更新，以将某个表中的所有 NULL 值更改为空字符串而不是 NULL。我们可能会在数百个数据库中执行此操作。表名将始终相同，但列名根据前端应用程序的配置方式是可变的（不要判断...我没有创建这个系统）。

有没有办法在不提前知道列名的情况下对所有这些列进行更新？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-11T19:30:33.863

您可以在动态 sql 中传递列的名称：

```
declare @sql nvarchar (1000);
set @sql = N'update table set ' + @column_name + '= ''''';

exec sp_executesql @sql; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T19:07:27.457

您可以查看`sys.columns`表并加入表名或 object_id。

```
 DECLARE @OBJ_ID INT

 SELECT @OBJ_ID = OBJECT_ID
 FROM SYS.tables
 WHERE name = 'YOURTABLE'

 SELECT * FROM SYS.columns
 WHERE OBJECT_ID = @OBJ_ID 
```

您可以使用`name`sys.columns 查询中的字段作为执行更新的基础。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-11T20:07:10.320

假设您只需要 varchar/char 类型的所有列（或将类型过滤器更改为您需要的任何内容）：

```
DECLARE @tableName varchar(10)
SET @tableName = 'yourtablenamehere'

DECLARE @sql VARCHAR(MAX)
SET @sql = ''

SELECT @sql = @sql + 'UPDATE ' + @tableName + ' SET ' + c.name + ' = '''' WHERE ' + c.name + ' IS NULL ;'
FROM sys.columns c
INNER JOIN sys.tables t ON c.object_id = t.object_id
INNER JOIN sys.types y ON c.system_type_id = y.system_type_id
WHERE t.name = @tableName AND y.name IN ('varchar', 'nvarchar', 'char', 'nchar')

EXEC (@sql) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-02-04T22:23:55.113

这可以通过游标来实现。您首先选择@Darren 提到的列名，然后使用这些值设置光标并循环：

```
Open oColumnsCursor
Fetch Next From oColumnscursor
    Into @ColumnName

While @@FETCH_STATUS=0
    Begin
        Set @oQuery = 'Update [DB]..[Table] Set [' + @ColumnName + '] = ''NewValue'' Where [' + @ColumnName + '] = ''OldValue'''
        Execute(@oQuery)
        Fetch Next From oColumnscursor Into @ColumnName
        Set @oCount = @oCount + 1
    End

Close oColumnsCursor;
Deallocate oColumnsCursor; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-01-10T00:30:53.477

当您知道表名时，这将起作用：

```
DECLARE @tableName varchar(10)
SET @tableName = 'Customers'

DECLARE @sql VARCHAR(MAX)
SET @sql = ''

SELECT @sql = @sql + 'UPDATE ' + @tableName + ' SET ' + c.name + ' = ISNULL('+ c.name +','''');'
FROM sys.columns c
INNER JOIN sys.tables t ON c.object_id = t.object_id
INNER JOIN sys.types y ON c.system_type_id = y.system_type_id
WHERE y.name IN ('varchar', 'nvarchar', 'char', 'nchar')
AND t.name = @tableName;

EXEC(@sql); 
```

这将迭代数据库中的所有表和所有列：

```
DECLARE @sql VARCHAR(MAX)
SET @sql = ''

SELECT @sql = @sql + 'UPDATE ' + t.name + ' SET ' + c.name + ' = ISNULL('+ c.name +','''');'
FROM sys.columns c
INNER JOIN sys.tables t ON c.object_id = t.object_id
INNER JOIN sys.types y ON c.system_type_id = y.system_type_id
WHERE y.name IN ('varchar', 'nvarchar', 'char', 'nchar');

EXEC(@sql); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-09-02T13:02:46.523

下面是程序。

```
ALTER PROCEDURE [dbo].[util_db_updateRow]
    @colval_name  NVARCHAR (30), -- column and values e.g. tax='5.50'
    @idf_name  NVARCHAR (300),   -- column name
    @idn_name  NVARCHAR (300),   -- column value
    @tbl_name  NVARCHAR (100)    -- table name
AS
BEGIN
    SET NOCOUNT ON;

    DECLARE @sql NVARCHAR(MAX)

    -- construct SQL
    SET @sql = 'UPDATE ' + @tbl_name + '  SET ' + @colval_name + 
               ' WHERE ' + @idf_name + '=' + @idn_name;

    -- execute the SQL
    EXEC sp_executesql @sql
    SET NOCOUNT OFF  

    RETURN
END 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-08T05:50:16.023

下面是存储过程，您可以在其中传递模式名称、表名称和以逗号分隔的列名列表。它仅适用于 Sql Server 2016 或更高版本。

```
CREATE OR ALTER PROCEDURE UpdateData
(@SchemaName NVARCHAR(Max),@TableName NVARCHAR(MAX),@ColumnNames NVARCHAR(MAX))
AS
BEGIN
DECLARE @DynamicSql NVARCHAR(MAX);
SET @DynamicSql =  'UPDATE ' +'[' +@SchemaName+'].' + '[' +@TableName+']' +' SET ' + STUFF((SELECT ', [' + C.name + '] = ' + '''NEW_VALUE''' 
FROM sys.columns C
INNER JOIN sys.tables T ON T.object_id = C.object_id
INNER JOIN sys.schemas S ON T.schema_id = S.schema_id
WHERE 
    T.name = @TableName
    AND S.Name = @SchemaName
    AND [C].[name] in (SELECT VALUE FROM string_split(@ColumnNames,','))
FOR XML PATH('')), 1,1, '')
print @DynamicSql;
EXEC (@DynamicSql);
END 
```

# opengl-es - Cocos2D：openGL-es 在 UIView 上变得透明

> ID：12846744
> 
> 赞同：1
> 
> 时间：2012-10-11T19:04:39.417
> 
> 标签：opengl-es, uiview, cocos2d-iphone, opacity, transparent

由于 Cocos2D 能力之外的原因，我需要使其透明并在其背后显示 UIView。

这工作正常，除非在特定情况下。当精灵的不透明度变得更加透明时，由于某种原因，它会使在其下绘制的 Cocos2D 中的其他所有内容变得透明，这使我的 UIViews 显示出来。

第一张图中显示的是水瓦，在 Cocos2D 中绘制，带有山的 UIView 和下面的天空。第二张图片是一样的，只是在 Cocos2D 中，有一个黑色精灵以一半的不透明度覆盖整个屏幕，由于某种原因，这使得它下面的 UIView 显示出来。在我的示例中，最明显的是通过水瓦显示的山。

![Cocos2D 上没有应用透明图像](../Images/113f95fbb52d8909dba685236e7e7823.png)

![在 Cocos2D 上应用透明图像](../Images/ce1836576920876eefd1547d863ae82d.png)

我的委托的 applicationDidFinishLaunching 代码如下：

```
- (void) applicationDidFinishLaunching:(UIApplication*)application 
{
    // Init the window
    window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

    // Try to use CADisplayLink director
    // if it fails (SDK < 3.1) use the default director
    if( ! [CCDirector setDirectorType:kCCDirectorTypeDisplayLink] )
        [CCDirector setDirectorType:kCCDirectorTypeDefault];

    CCDirector *director = [CCDirector sharedDirector];

    // Init the View Controller
    viewController = [[RootViewController alloc] initWithNibName:nil bundle:nil];
    viewController.wantsFullScreenLayout = YES;

    EAGLView *glView = [EAGLView viewWithFrame:[window bounds]
                                   pixelFormat:kEAGLColorFormatRGBA8    // kEAGLColorFormatRGBA8, kEAGLColorFormatRGB565
                                   depthFormat:0                        // GL_DEPTH_COMPONENT16_OES
                        ];

    // attach the openglView to the director
    [director setOpenGLView:glView];

    glView.opaque = NO;

#if GAME_AUTOROTATION == kGameAutorotationUIViewController
    [director setDeviceOrientation:kCCDeviceOrientationPortrait];
#else
    [director setDeviceOrientation:kCCDeviceOrientationLandscapeLeft];
#endif

    [director setAnimationInterval:1.0/60];
    [director setDisplayFPS:YES];

    //color/gradient BG

    bgLayer = [ColorBGView createGradientWithName:@"darkCave"];

    CGRect screenRect = [[UIScreen mainScreen] bounds];
    CGFloat screenWidth = screenRect.size.width;
    CGFloat screenHeight = screenRect.size.height;

    bgLayer.frame = CGRectMake(0, 0, screenHeight, screenWidth);
    [viewController.view.layer insertSublayer:bgLayer atIndex:0];

    // add custom parallax view

    parallaxView = [[ParallaxView alloc] init];
    parallaxView.frame = CGRectMake(0, 0, 1024, 768);
    [viewController.view insertSubview:parallaxView atIndex:1];

    [parallaxView release];

    // make the OpenGLView a child of the view controller
    [viewController.view insertSubview:glView atIndex:2];
    viewController.view.opaque = YES;
    viewController.view.backgroundColor = [UIColor blackColor];

    // make the View Controllers childs of the main window
    window.rootViewController = viewController;

    foregroundLabelView = [[ForegroundLabelView alloc] init];
    foregroundLabelView.frame = CGRectMake(0, 0, 1024, 768);
    [viewController.view insertSubview:foregroundLabelView atIndex:3];
    foregroundLabelView.hidden = YES;

    [foregroundLabelView release];

    [window makeKeyAndVisible];

    // Default texture format for PNG/BMP/TIFF/JPEG/GIF images
    // It can be RGBA8888, RGBA4444, RGB5_A1, RGB565
    // You can change anytime.
    [CCTexture2D setDefaultAlphaPixelFormat:kTexture2DPixelFormat_RGBA8888]; //

    [glView setMultipleTouchEnabled:YES];

    // Removes the startup flicker
    [self removeStartupFlicker];

    // Run the intro Scene
    [[CCDirector sharedDirector] runWithScene: [BlankScene scene]];
} 
```

如果您需要其他任何东西，请告诉我。谢谢你。

# actionscript-3 - 嵌入字体 flash.text.engine

> ID：12846752
> 
> 赞同：0
> 
> 时间：2012-10-11T19:05:06.240
> 
> 标签：actionscript-3, flash, fonts

我对此完全没有想法。它紧随其后，并且是我之前问题的一部分：

[使用 as3 在 swf 中嵌入字体](https://stackoverflow.com/questions/12763516/embedding-a-font-in-a-swf-using-as3/12807110#12807110)

我只是似乎无法让 flash.text.engine 使用我的嵌入字体。注意，在用户选择了两种语言（用于相互翻译）后，必须将字体加载到应用程序中（嵌入在 swf 中）。似乎有一点信息暗示现在有必要使用 sdk 中的 fontswf 应用程序。我已经尝试过这个并生成了可加载的 swf 文件，但我找不到任何关于如何加载这些文件的信息（即下面的 getDefinition 和 registerFont 位不起作用，因为这些 swf 中没有类）并应用于 text.engine对象。嵌入的来源在我对上述问题的回答中。这是一个测试 as3，它演示了它是如何不起作用的！

```
package 
{
import flash.display.Loader;
import flash.display.Shape;
import flash.display.Sprite;
import flash.events.Event;
import flash.text.engine.ElementFormat;
import flash.text.engine.FontDescription;
import flash.text.engine.TextBlock;
import flash.text.engine.TextLine;
import flash.text.engine.TextElement;
import flash.net.URLRequest;
import flash.text.Font;

public class Main extends Sprite 
{
    private var loader:Loader;
    private var tl:TextLine;

    public function Main():void 
    {
        loader = new Loader();
        loader.contentLoaderInfo.addEventListener(Event.COMPLETE,fontLoaded);
        loader.load(new URLRequest("EnglishF.swf"));
    }

    private function fontLoaded(evt:Event):void {
        var FontClass:Class
        FontClass = evt.target.applicationDomain.getDefinition("EnglishF") as Class;
        try {
            Font.registerFont(FontClass.myFont);
            trace("successfully loaded " + FontClass); 
            // gives 'successfully loaded EnglishF'
        } catch (err:Error) {}
        var fontList:Array = Font.enumerateFonts();
        for (var i:int = 0; i < fontList.length; i++) {
            trace(fontList[i].fontName, fontList[i].fontType); 
            // gives 'EnglishF embeddedCFF'
        }
        var block:TextBlock = new TextBlock();
        var font:FontDescription = new FontDescription("EnglishF");
        var formt:ElementFormat = new ElementFormat(font, 30);
        trace(FontDescription.isFontCompatible("EnglishF","normal","normal"), formt.fontDescription.fontName); 
        // gives 'true EnglishF'
        formt.color = 0x882233;
        var span:TextElement = new TextElement("Hello World. This is certainly NOT in the Font provided!", formt);
        block.content = span;
        tl = block.createTextLine();
        tl.x = 10;
        tl.y = tl.ascent + 10;
        addChild(tl);
    }
}
} 
```

我做错了什么，还是这是不可能的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T20:27:21.247

希望这会有所帮助。在这一行下：

```
var font:FontDescription = new FontDescription("EnglishF"); 
```

添加以下行：

```
font.fontLookup = FontLookup.EMBEDDED_CFF; 
```

这将使文本框架知道您正在使用 CFF 字体（在新文本框架中使用），而不是常规嵌入字体（在 TextFields 中使用）。

希望这可以帮助。

约旦

# asp.net-mvc - 在调试时了解参数的计数

> ID：12846762
> 
> 赞同：0
> 
> 时间：2012-10-11T19:06:07.797
> 
> 标签：asp.net-mvc, debugging

当我在调试时，我想看看我的参数是否被传入和计算，只是想对以下方法进行一些澄清：

```
public void Create(VisitEntry visitEntry,IList<Guid>caseIds, IList<Guid>partyIds )  
{..code..} 
```

当我将鼠标悬停在 visitEntry 上时，我会看到我拥有的大部分填充字段/项目。并将鼠标悬停在 caseIds 上会显示：Count=2 并将鼠标悬停在 partyId：System.Guid[1] 上。

它的真正含义是什么：System.Guid[1] - 为什么不将 Count = 1 或 Count = 2 显示为 caseIds？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T13:57:47.807

原因是因为在第一种情况下，具体类型是`List<Guid>`for`caseIds`和`Guid[]`for `partyIds`：

例如运行以下代码，您将看到不同之处：

```
List<Guid> caseIds = new List<Guid> { Guid.NewGuid() };
Guid[] partyIds = new Guid[] { Guid.NewGuid() }; 
```

# windows - WiX 中的 CustomAction 日志名称错误 0x8007007a

> ID：12846768
> 
> 赞同：0
> 
> 时间：2012-10-11T19:06:41.460
> 
> 标签：windows, dll, installation, wix, naming-conventions

我目前正在处理我导出以供 WiX 安装程序使用的 DLL 中的自定义操作，我最近在运行安装程序时在日志中发现了以下错误：

```
<exported_name_cut_off>: Error 0x8007007a: Failed to copy CustomAction log name: <exported_name_NOT_cut_off> 
```

由于我对 Windows 编程和 Wix 比较陌生，当我注意到错误消息中的 DLL 函数名称被截断时，我立即认为 DLL 中导出的函数名称必须有 31 个字符的限制，但显然情况并非如此; 事实证明，这是我不知道的 WiX 的一个限制。

所以，我在这里有两个问题：

1.  DLL 中导出或导入函数名的长度是否有限制？我在 MSDN 帮助中找不到任何提及。如果相关，我正在使用 C++ 编码并在 Windows 7 x64 上使用 Visual Studio 2010。

2.  我找到[了这个](http://www.mail-archive.com/wix-users@lists.sourceforge.net/msg29129.html)，但不幸的是，对于为什么 WiX 有这样的限制，没有给出很好的答案。有谁知道为什么以这种方式限制它？在大于 3.5.2519（我正在使用的版本）的 WiX 版本中仍然是这种情况吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T22:22:21.430

您控制传递给 WcaInitialize 的名称；它不必是实际函数或自定义操作名称，因此您可以根据需要缩短它。WcaLog* 函数使用它来为您的日志添加前缀，因此它并不重要；如果你愿意，你甚至可以传递 NULL。

WiX v3.6 和 v3.7 beta 版本中仍然存在限制。

# python - 这是一个包装脚本吗？它的正确名称是什么？（Python）

> ID：12846769
> 
> 赞同：0
> 
> 时间：2012-10-11T19:06:46.613
> 
> 标签：python

```
execfile("es.py")
execfile("ew.py")
execfile("ef.py")
execfile("gw.py")
execfile("sh.py")

print "--Complete--" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:10:57.237

我猜它是一种包装脚本，但是没有“正确的名称”，因为写这样的东西不是很pythonic。

一个人可能会写类似

```
import es
import ew
### ...

es.run() # assuming es code is in a run function
ew.run()
# ... 
```

为了对此进行扩展，在 python 中，一个文件应该代表一个功能单元。例如，如果你实现了一个列表类型/类，你可能想把这个类型的类和与之相关的每个函数都放到这个文件中。

在python中，函数应该是一个执行单元，例如。一堆应该在某些特定数据上一次运行的代码。在不知道文件内容的情况下很难为您提供建议，但是在您的代码片段中执行的每个文件的内容可能会受益于放入函数中。文件划分可以保留，也可以不保留，具体取决于功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T19:41:47.013

它看起来更像是一个“批处理”脚本。它看起来类似于在 unix/windows 中编写一个 bash 或批处理文件来执行一堆预定义的事情。我绝对同意，尽管按照所写的那样做，这并不是真正的蟒蛇式的事情。

# iphone - 如何让我的 iphone 应用在 iPad 上运行？

> ID：12846772
> 
> 赞同：0
> 
> 时间：2012-10-11T19:06:50.060
> 
> 标签：iphone, objective-c, ios, xcode, ipad

我的理解（我已经看到）可以在 iPad 上打开和查看某些应用程序。虽然，iPad 保持屏幕小，如果屏幕尺寸加倍，则像素化。

我正在尝试对我的应用程序做同样的事情，但是当我尝试在 iPad 上运行它时，它会因错误而崩溃

'找不到名为'MainStoryboard_iPad'的故事板

这很明显，因为我没有 iPad 的故事板，但目前我不想要。我只希望 iPad 以较小版本的 iPhone 应用程序运行该应用程序。所以我的问题是，如何阻止它寻找 iPad 故事板？我的理解是我必须在 plist.info 中调整一些东西，但我不知道如何在 xcode 中访问它。据我了解，您在导航器中选择项目，然后选择“信息”，但我没有看到人们说应该在 plist.info 中的任何信息。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:19:35.717

您似乎使您的应用程序具有通用性。您想将“设备”设置为 iPhone。这可以在目标摘要页面上完成（无需直接与您的 .plist 交互）。

![在此处输入图像描述](../Images/22d0b3b4328ba74178d9be65cf8546dd.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:10:42.797

只针对 iPhone 平台，不要在代码中调用任何 iPad 接口对象。您应该查看 Main xib 文件以确保没有对 iPad 界面对象的引用。

仅限 iPhone 的应用程序本机应该以双像素模式运行。为了解决您看到的像素化/颗粒状问题，请使用@2x（适用于 iPhone）大小的图像。这将减少您看到的像素化，但仍会包含一些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T19:44:52.243

好的，我找到了最后一个问题。将摘要编辑为“iPhone”后，我还必须进入“信息”选项卡并更改显示的行

'主故事板文件基本名称 (iPad) 到 MainStoryboard_iPhone。它当前设置为 MainStoryboard_iPad。第二步解决了这个问题。

多谢你们！

# ruby-on-rails - 基于正则表达式的 Rails 3 路由

> ID：12846773
> 
> 赞同：6
> 
> 时间：2012-10-11T19:06:56.967
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routing, routes

我想将以字符串 xyz 开头的所有路由重定向到其他路径。

```
match /\/xyz\/(.)*/ => redirect{ "whateverurl" } 
```

给定正则表达式时，匹配方法似乎不起作用，我用谷歌搜索了很多似乎有与正则表达式有关的选项，但它们用于参数例如

```
match 'photos/:id' => 'photos#show', :constraints => { :id => /[A-Z]\d{5}/ } 
```

我怎样才能实现它？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-11T19:21:33.690

怎么样：

```
match '/xyz/*foo' => redirect('url') 
```

这不是一个正则表达式，它被称为*route globbing*。更多关于它[的信息](http://guides.rubyonrails.org/routing.html#route-globbing-and-wildcard-segments)。

# php - 意外的“targetNamespace”无法导入 XSD

> ID：12846774
> 
> 赞同：3
> 
> 时间：2012-10-11T19:06:57.513
> 
> 标签：php, namespaces, wsdl

我有一个定义如下的 WSDL。不确定定义有什么问题，但每次我尝试导入时，我都会收到错误

```
 <definitions targetNamespace="myservices" 
      xmlns:nslt2="myxsdspace"
      xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" 
      xmlns="http://schemas.xmlsoap.org/wsdl/" 
      xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" 
      xmlns:tns="urn:myservices" 
      xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
      xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" 
      xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/">
  <types>
    <schema elementFormDefault="unqualified" 
    targetNamespace="myservices" xmlns="http://www.w3.org/2001/XMLSchema"/>
      <xsd:schema>
        <xsd:import namespace="myxsdspace" schemaLocation="ApplicaitonForm_Latest.xsd"/>
      </xsd:schema>
  </types>
  <message name="processRequest"> 
```

…………

我收到以下错误，但无法找到解决方案。

```
SOAP-ERROR: Parsing Schema: can't import schema from 'myxsd.xsd', unexpected 'targetNamespace'='myxsdspace 
```

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-14T10:47:42.763

给有同样烦恼的人的答案，

它通常与属性之间的不匹配有关： `namespace`从`<import>`标签和导入的 xsd 文件中`targetNamespace`的标签。`schema`

引发`unexpected 'targetNamespace'`错误的不匹配属性示例：

文件 wsdl.xml

```
<xs:import namespace="http://www.example.fr/modules/payment/schema/qwerty"
                   schemaLocation="location.xsd"/> 
```

文件位置.xsd

```
<xs:schema targetNamespace="http://www.example.fr/modules/payment/schema/azerty" ... > 
```

* * *

因此，只需更正其中一个属性，错误就会消失：

文件 wsdl.xml

```
<xs:import namespace="http://www.example.fr/modules/payment/schema/qwerty"
                   schemaLocation="location.xsd"/> 
```

文件位置.xsd

```
<xs:schema targetNamespace="http://www.example.fr/modules/payment/schema/qwerty" ... > 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:30:24.427

您使用的是什么版本的 PHP？您可以发布连接到 SOAP 的代码吗？PHP-SOAP 接口仍然非常挑剔，您可能需要对您的 WSDL 或 PHP 进行一些修改才能使其满意。对于初学者，请尝试设置肥皂选项以强制使用肥皂版本。此外，请查看是否可以通过`var_dump`对错误运行 a 来获取更多详细信息，如下所示。

```
$soapServer = 'http://yoursoap.com/wsdl';
$soapOptions = array(
        'soap_version'    => SOAP_1_1,
        'exceptions'      => true,
        'trace'           => 1,
        'wsdl_local_copy' => true,
        'keep_alive'      => true,
        'features'        => SOAP_SINGLE_ELEMENT_ARRAYS
        );

try
{
    $soapClient = new SoapClient($soapServer, $soapOptions);
}
catch (Exception $e)
{
    $message = "<h2>Connection Error!</h2></b>";
    var_dump($e);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T19:27:17.047

您提交的 WSDL 不完整。根元素没有关闭，还有其他不完整的元素。您将无法解析语法不规范的 WSDL

# google-apps-script - 查看我的 ScriptDB 的大小，不是有多少对象..而是数据库的大小

> ID：12846779
> 
> 赞同：2
> 
> 时间：2012-10-11T19:07:04.647
> 
> 标签：google-apps-script

问题应该足够清楚。我想知道是否有办法查看我的 ScriptDB 的大小？如果我调用 .getSize() 方法，它将在我的数据库中产生项目数？

我想知道大小，因为当我接近 200mb 大小限制时，我希望能够设置一个脚本来删除旧条目。

非常感谢您的时间和精力。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T07:45:33.237

正如问题的第一条评论中所写，现在不可能获得 ScriptDB 数据大小，但有一个解决此问题的方法。解决方法是封装数据库处理代码，`try/catch`如果代码抛出异常，则清理数据库。请参阅下面的示例

```
try {
  db.save(...);
}
catch(err) {
  // scavenge here
} 
```

以同样的方式可以处理[缓存服务](https://developers.google.com/apps-script/class_cacheservice)的配额限制异常。

# linux - 如何使用静态 IP 地址设置我的主机和 httpd.conf 文件

> ID：12846784
> 
> 赞同：0
> 
> 时间：2012-10-11T19:07:23.537
> 
> 标签：linux, apache, centos

我使用静态 IP 地址（不是 FQDN）在 Rackspace 机器上设置 Centos 6.3。我将在这个盒子上设置虚拟主机，它似乎工作正常，但是当我重新启动 HTTPD 服务器时，我收到一条错误消息“无法可靠地确定服务器的完全限定域名，使用 xx.xxx.xx .xx for ServerName”（xx.xxx.xx.xx 是服务器的静态 IP 地址）。

我的 /etc/hosts 中有以下内容：

```
27.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
xx.xxx.xx.xx    name-used-for-rackspace 
```

name-used-for-racspace 是我在创建服务器时使用的名称（不是 FQDN）（您必须输入名称）。

我假设我可能不需要更改 /etc/hosts 中的任何内容，但是我在 httpd.conf 中添加了什么？现在，我在该文件中有以下内容：

```
NameVirtualHost *:80
<VirtualHost *:80>
    DocumentRoot /var/www/html
    ServerName localhost 
    <Directory /var/www/html>
            allow from all
            Options +Indexes
    </Directory>
</VirtualHost> 
```

我也尝试将 ServerName 设置为 xx.xxx.xx.xx，但我收到了相同的错误消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:14:46.923

此错误是因为您没有使用 FQDN。它不应该影响网络服务器的运行。

要摆脱启动时的消息，您需要使用正确的域和 IP 地址配置主机文件。您的 httpd.conf 也应该使用相同的名称（您已指定 localhost）。

只要您的服务器正在启动并且您不打算将域分配给您的网络服务器，就可以忽略此错误。

具有 FQDN 的虚拟主机示例：

```
<VirtualHost *:80>
ServerName www.domain.net
ServerAlias domain.net *.domain.net
ServerAdmin administrator@domain.net
DocumentRoot "/home/domain/htdocs"
<Directory "/home/domain/htdocs">
        Options Indexes FollowSymLinks
        AllowOverride All
        Order allow,deny
        Allow from all
</Directory>
CustomLog "/home/domain/logs/access-www.log" common
ErrorLog "/home/domain/logs/error-www.log"

        <IfModule mpm_peruser_module>
          ServerEnvironment apache apache
        </IfModule>
</VirtualHost> 
```

示例主机文件：

```
127.0.0.1       localhost       localhost.localdomain gentoo1
x.x.x.x         gentoo1.domain.net 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-28T19:56:08.000

您需要使用静态 IP 配置网络连接，请参阅下面的参考。否则，您的 Web 服务器正在工作，但无法从外部访问。

[https://access.redhat.com/knowledge/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Deployment_Guide/sec-Configuring_IPv4_Settings.html](https://access.redhat.com/knowledge/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Deployment_Guide/sec-Configuring_IPv4_Settings.html)

然后把静态IP放在httpd.conf服务器名后面。

# ruby-on-rails - 为什么 Rails 运行的是架构版本之前的迁移？

> ID：12846787
> 
> 赞同：1
> 
> 时间：2012-10-11T19:07:28.577
> 
> 标签：ruby-on-rails, database, heroku

我有一个版本号为 20120926232105 的迁移。我的架构版本为 20121003190827。

我的网站托管在 Heroku 上，当我运行时

```
heroku run rake db:migrate -a my-app 
```

我收到一个错误，它试图在迁移 20120926232105 中创建的表已经存在（应该如此）。我不明白——schema_migration 表的重点不就是要记录最后一次成功的迁移吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:42:59.823

[这个人](https://stackoverflow.com/questions/8235899/how-does-rake-migrate-actually-work)解释得很好。

基本上，在某处有一个名为“schema_migrations”的表。您迁移的“版本号”实际上只是一个时间戳。此外，在您的“schema_migrations”表中没有带有该时间戳的迁移记录。由于迁移存在，并且在“schema_migrations”表中找不到它的时间戳，Rake 知道运行它。

试试看`grep -r "table_name" db/migrate`它是否在那里两次。

# c - 在数组中设置/取消设置 n 个连续位

> ID：12846789
> 
> 赞同：0
> 
> 时间：2012-10-11T19:07:37.930
> 
> 标签：c

我想找到`n`在数组中设置或取消设置连续位的位置。

示例数组：

```
a[0] = 0x0fffffff  
a[1] = 0x000000f0  
a[2] = 0xffffff00 
```

如果我想找到前 8 个未设置的位，它必须返回 28（数组中的第 28 位位置）

如果我想找到前 32 个未设置的位，它必须返回 40（数组中的第 40 位位置）

我正在尝试扩展我在[此处](https://tekpool.wordpress.com/category/bit-count/)找到的代码，以便它可以与任意大的数组一起使用：

```
int BitCount(unsigned int u)
 {
         unsigned int uCount;

         uCount = u
                  - ((u >> 1) & 033333333333)
                  - ((u >> 2) & 011111111111);
         return
           ((uCount + (uCount >> 3))
            & 030707070707) % 63;
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-09T16:34:08.380

这就是我想出的：

只需循环遍历数组并一次检查 1 位以查看其是否设置。

```
int UnsetBits(unsigned int a[], int sizeOfArray, int requiredBits)
{
    //number of found bits in a row
    int found = 0;

    //current index in array
    int index = 0;

    //current bit
    int bit = 0;

    while(index < sizeOfArray)
    {
        //isolate the current bit
        int data = ((a[index] << (31 - bit)) >> 31);

        //bit is unset
        if(data == 0)
        {
            found++;

            //found required amount, return start position
            if(found == requiredBits)
            {
                return bit + 1 + (index * 32) - requiredBits;
            }
        }
        //bit is set, reset found count
        else
        {
            found = 0;
        }

        //increment which bit we are checking
        bit++;

        //increment which array index we are checking
        if(bit >= 32)
        {
            bit = 0;
            index++;
        }
    }

    //not found
    return -1;
} 
```

# iphone - MKAnnotationView 问题，我的图钉最初显示然后消失？

> ID：12846791
> 
> 赞同：1
> 
> 时间：2012-10-11T19:07:39.397
> 
> 标签：iphone, ios, mkmapview, ios6, mkannotationview

我正在尝试用我的代码调试一个问题，即我的 MKAnnotationView 上的引脚最初在第一次调用时显示一秒钟，但是当地图放大该位置时，除用户位置之外的所有注释都消失了。有人可以指出我的逻辑缺陷吗？

下面是正在使用的代码。AddPlacemark 用于获取我所有注释的位置，然后 MKAnnotationView 应该将它们全部显示在地图上。就像我说的，当地图第一次出现时，所有注释都会显示，但是当地图放大用户的位置时，我所有的其他注释都会消失。我相信这个问题只是在我更新我的 Xcode 时才开始出现，以便我可以在 iOS 6 上进行测试并获得 iPhone 5 的模拟器。

```
 - (void)AddPlacemark {
        if([allplacemarkarray count]>0) {
        [mapView removeAnnotations:allplacemarkarray];

        [allplacemarkarray removeAllObjects];
    }

    MKCoordinateRegion region;
    MKCoordinateSpan span;
    span.latitudeDelta=0.2;
    span.longitudeDelta=0.2;

    CLLocationCoordinate2D location1;  
    location1.latitude = appdel.MyCurrentLocation.latitude;  
    location1.longitude = appdel.MyCurrentLocation.longitude;  
    region.span = span;
    region.center = location1;  

    Placemark *addAnnotation = [[[Placemark alloc] initWithCoordinate:location1] retain]; 
    [mapView addAnnotation:addAnnotation];
    [allplacemarkarray addObject:addAnnotation];
    [addAnnotation release];

    if(alllocationArray) {
        for(int i=0;i<[alllocationArray count];i++) {
            NSDictionary *locationdict=[alllocationArray objectAtIndex:i];
            CLLocationCoordinate2D location;
            location.latitude = [[locationdict objectForKey:@"VLATITUDE"] floatValue];
            location.longitude =[[locationdict objectForKey:@"LONGITUDE"]floatValue];
            region.span=span;
            region.center=location;

            Placemark *addAnnotation = [[[Placemark alloc] initWithCoordinate:location] retain];
            [allplacemarkarray addObject:addAnnotation];
            addAnnotation.titletext = [locationdict objectForKey:@"NAME"];
            addAnnotation.logoText = [locationdict objectForKey:@"LOGO"];
            NSString *add1=[locationdict objectForKey:@"ADDR1"];
            NSString *add2=[locationdict objectForKey:@"ADDR2"];
            NSString *city=[locationdict objectForKey:@"CITY"];
            NSString *state=[locationdict objectForKey:@"STATE"];
            NSString *zip =[locationdict objectForKey:@"ZIP"];
            addAnnotation.subtitletext=[NSString stringWithFormat:@"%@ %@ %@, %@  %@",add1,add2,city,state,zip];
            [addAnnotation setPlacemarkId:[NSNumber numberWithInt:i]];
            [mapView addAnnotation:addAnnotation];

            [addAnnotation release];
            }

            [mapView setRegion:region animated:TRUE];
            [mapView regionThatFits:region];
        }
    }

    - (MKAnnotationView *) mapView:(MKMapView *)mapView viewForAnnotation:(Placemark *) annotation {
        MKPinAnnotationView *annView=[[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:@"MyPin"];

        annView.animatesDrop = TRUE;
        annView.canShowCallout = YES;
        [annView setSelected:YES];

        UIImage *pinImage = [UIImage imageNamed:annotation.logoText];
        UIImageView *logoView = [[UIImageView alloc] initWithImage:pinImage];

        logoView.frame = CGRectMake(-23, -6, 63, 48);

        UIButton *myDetailButton = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
        myDetailButton.frame = CGRectMake(0, 0, 23, 23);
        myDetailButton.contentVerticalAlignment = UIControlContentVerticalAlignmentCenter;
        myDetailButton.contentHorizontalAlignment = UIControlContentHorizontalAlignmentCenter;
        [myDetailButton addTarget:self action:@selector(checkButtonTapped:) forControlEvents:UIControlEventTouchUpInside];
        [myDetailButton setTag:[annotation.placemarkId intValue]];
        annView.rightCalloutAccessoryView=myDetailButton;

        if(annotation.coordinate.latitude == appdel.MyCurrentLocation.latitude && annotation.coordinate.longitude == appdel.MyCurrentLocation.longitude) {
            annView.pinColor = MKPinAnnotationColorRed;
        } else if ([annotation.logo isEqualToString:@""]) {
            annView.pinColor = MKPinAnnotationColorPurple;
        } else {
            [annView addSubview:logoView];
        }

        annView.calloutOffset = CGPointMake(-5, 5);

        return annView;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:01:15.850

这个问题实际上不是由于应用程序中的错误代码造成的。对于那个很抱歉！事实证明，我为这个逻辑提供信息的后端代码很糟糕。

# c# - 为其设置模板时，我的列表视图项目未显示

> ID：12846804
> 
> 赞同：2
> 
> 时间：2012-10-11T19:08:41.277
> 
> 标签：c#, wpf, templates, listview, controls

我有两个模板，一个用于文本框，一个用于列表视图，两者都只是用来给它们圆角而不是默认矩形。我的文本框需要“ScrollViewer x:Name="PART_ContentHost" 行才能显示文本，但这不适用于列表视图。如果我取出列表视图的模板，则会显示示例列表视图项（内容）。否则它不会，我看不到我在后面的代码中添加的任何其他项目。我在 xaml 中缺少什么来让它工作？

下面是我的 xaml：

```
 <!-- Design Templates to set the borders of the controls-->
<UserControl.Resources>
    <ControlTemplate x:Key="TextBoxTemplate" TargetType="TextBox">
        <Border BorderBrush="Black" BorderThickness="1,1,1,.5" CornerRadius="7">
            <ScrollViewer x:Name="PART_ContentHost" ></ScrollViewer>
        </Border>
    </ControlTemplate>
    <ControlTemplate x:Key="ListViewTemplate" TargetType="ListView">
        <Border BorderBrush="Black" BorderThickness=".5,1,1,1" CornerRadius="7">
        </Border>
    </ControlTemplate>
</UserControl.Resources>

<!-- Controls -->
<Grid Height="270" Width="400">
    <StackPanel Width="390">
        <TextBox Height="35" Name="InputTextbox" Template="{StaticResource TextBoxTemplate}" VerticalContentAlignment="Center" TextChanged="InputTextbox_TextChanged"></TextBox>
        <ListView Height="235" Name="ResultsListView" Template="{StaticResource ListViewTemplate}"  SelectionChanged="ResultsListView_SelectionChanged">
            <ListViewItem Content="stuff"></ListViewItem>
        </ListView>
    </StackPanel>
</Grid> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:55:36.200

您的 ControlTemplate 没有与之关联的演示者。这就是您没有看到任何项目的原因。有关如何创建 ListView.ControlTemplate 的工作示例，请参阅此页面：

[MSDN：ListView ControlTemplate 示例](http://msdn.microsoft.com/en-us/library/ms788747%28v=vs.85%29.aspx)

这是您的控件模板的更新 xaml：

```
<ControlTemplate x:Key="ListViewTemplate" TargetType="ListView">
    <Border BorderBrush="Black" BorderThickness=".5,1,1,1" CornerRadius="7">
      <ScrollViewer>
        <ItemsPresenter />
      </ScrollViewer>
    </Border>
</ControlTemplate> 
```

# xslt - 在 XSLT 之后将字符串附加到 XSL 值

> ID：12846805
> 
> 赞同：0
> 
> 时间：2012-10-11T19:08:46.357
> 
> 标签：xslt, concatenation

XSL 文件：

```
<xsl:attribute name="id">                          
    <xsl:value-of select="$text/FieldName"/>
</xsl:attribute> 
```

XML 数据：

```
<FieldName>
   meLikeStackOverflow
</FieldName> 
```

在 XSLT 之后...

```
<id>meLikeStackOverflow</id> 
```

我如何编辑 XSL 文件，以便在 XSLT 之后，它看起来像这样：

```
<id>meListStackOverflow_LBL</id> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:23:36.863

```
<xsl:value-of select="concat($text/FieldName, '_LBL')"/> 
```

# performance - 为什么这个简单的 OpenCL 内核运行如此缓慢？

> ID：12846809
> 
> 赞同：3
> 
> 时间：2012-10-11T19:08:55.600
> 
> 标签：performance, opencl, gpgpu

我正在研究 OpenCL，与我期望它的运行方式相比，我有点困惑为什么这个内核运行得这么慢。这是内核：

```
__kernel void copy(
  const __global char* pSrc, 
  __global __write_only char* pDst, 
  int length)
{
  const int tid = get_global_id(0);

  if(tid < length) {
    pDst[tid] = pSrc[tid];
  }
} 
```

我通过以下方式创建了缓冲区：

```
char* out = new char[2048*2048];
cl::Buffer(
  context,
  CL_MEM_USE_HOST_PTR | CL_MEM_WRITE_ONLY,
  length,
  out); 
```

输入缓冲区同上，除了我已将 in 指针初始化为随机值。最后，我以这种方式运行内核：

```
cl::Event event;
queue.enqueueNDRangeKernel(
  kernel, 
  cl::NullRange,
  cl::NDRange(length),
  cl::NDRange(1), 
  NULL, 
  &event);

event.wait(); 
```

平均而言，时间约为 75 毫秒，计算公式如下：

```
cl_ulong startTime = event.getProfilingInfo<CL_PROFILING_COMMAND_START>();
cl_ulong endTime = event.getProfilingInfo<CL_PROFILING_COMMAND_END>();
std::cout << (endTime - startTime) * SECONDS_PER_NANO / SECONDS_PER_MILLI << "\n"; 
```

我正在运行带有 Intel i5-3450 芯片（Sandy Bridge 架构）的 Windows 7。相比之下，进行复制的“直接”方式只需不到 5 毫秒。我不认为 event.getProfilingInfo 包括主机和设备之间的通信时间。想法？

编辑：

在 ananthonline 的建议下，我将内核更改为使用 float4s 而不是 chars，这将平均运行时间降低到大约 50 毫秒。仍然没有我希望的那么快，但有所改善。谢谢ananthonline！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T22:57:33.980

我认为您的主要问题是您正在使用的 2048*2048 工作组。如果您有这么多单项工作组，系统上的 opencl 驱动程序必须管理更多开销。如果您要使用 gpu 执行此程序，这将特别糟糕，因为您将获得非常低的硬件饱和度。

优化：用更大的工作组调用你的内核。您甚至不必更改现有内核。[看问题：这个尺寸应该是多少？](https://stackoverflow.com/questions/10096443/what-is-the-algorithm-to-determine-optimal-work-group-size-and-number-of-workgro)我以下面的 64 为例。在大多数硬件上，64 恰好是一个不错的数字。

```
cl::size_t myOptimalGroupSize = 64;
cl::Event event;
queue.enqueueNDRangeKernel(
  kernel, 
  cl::NullRange,
  cl::NDRange(length),
  cl::NDRange(myOptimalGroupSize), 
  NULL, 
  &event);

event.wait(); 
```

您还应该让内核做的不仅仅是复制单个值。我已经回答了一个关于全局内存的类似问题[here。](https://stackoverflow.com/questions/9912385/opencl-global-memory-fetches/9927270#9927270)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T08:31:15.710

CPU 与 GPU 非常不同。在 x86 CPU 上运行它，获得良好性能的最佳方法是使用 double16（最大的数据类型）而不是 char 或 float4（如其他人所建议的那样）。

根据我在 CPU 上使用 OpenCL 的少量经验，我从未达到使用 OpenMP 并行化所能达到的性能水平。与CPU并行进行复制的最佳方法是将要复制的块划分为少量的大子块，并让每个线程复制一个子块。GPU 方法是正交的：每个线程都参与同一块的副本。这是因为在 GPU 上，不同的线程可以有效地访问连续的内存区域（合并）。

要使用 OpenCL 在 CPU 上进行高效复制，请在内核中使用循环来复制连续数据。然后使用不大于可用内核数的工作组大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-14T23:30:57.877

我相信是 cl::NDRange(1) 告诉运行时使用单项工作组。这效率不高。在 C API 中，您可以为此传递 NULL 以将工作组大小留给运行时；在 C++ API 中也应该有一种方法可以做到这一点（也许也只是 NULL）。这在 CPU 上应该更快；它肯定会在 GPU 上。

# c# - 带有“？：”的 if 子句

> ID：12846813
> 
> 赞同：2
> 
> 时间：2012-10-11T19:09:11.650
> 
> 标签：c#, if-statement

> **可能重复：**
> [可空类型和三元运算符：为什么是`？10：null`禁止？](https://stackoverflow.com/questions/858080/nullable-types-and-the-ternary-operator-why-is-10-null-forbidden)

我想根据情况为 x （可以为空的整数）分配一个值或空值（您可以在下面看到）

```
int? x;
x = stackoverflow.ToString() != "" ? int.Parse(stackoverflow.ToString()) : null; 
```

但它给出了以下错误。

```
Type of conditional expression cannot be determined because there is no implicit conversion between 'int' and '<null>' 
```

为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T19:10:47.500

将 int 转换为可为空的 int。

```
x = stackoverflow.ToString() != "" ? 
       (int?)int.Parse(stackoverflow.ToString()) : null; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:12:26.810

试试这个：

```
x = stackoverflow.ToString() != "" ? int.Parse(stackoverflow.ToString()) : (int?) null; 
```

看看这是否有效。我没有测试它，因为我不知道`stackoverflow`应该是什么

# python - 带有 Django 的 matplotlib 在 print_figure 抛出时失败 [Errno 2] 没有这样的文件或目录

> ID：12846814
> 
> 赞同：1
> 
> 时间：2012-10-11T19:09:12.540
> 
> 标签：python, django, matplotlib

我正在尝试通过 matplotlib 创建一个 png，但我得到：

```
[Errno 2] No such file or directory 
```

相同的代码适用于单元测试。`print_figure`来电

```
# creates a canvas from figure
canvas = FigureCanvasAgg(fig)
filename = "directory" + os.sep + name_prefix + ".png"
# saves figure to filesystem in png format
canvas.print_figure(filename) 
```

我认为这可能是一个权限问题，但对我来说，相同的代码通过以下方式工作似乎很奇怪`manage.py test`

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T19:50:12.430

My recommendation is to use fully qualified path names. For example: you could determine the MEDIA_ROOT from your django settings, write a snippet of code that ensures that a subdirectory for the graphs exists, then save the images there.

Your current code seems to rely on finding a subdirectory with the appropriate name in the "current working directory". The "current working directory" is a finicky thing - it will be different in testing, dev, production...

```
# import settings
from django.conf import settings
...
# ensure that a subdirectory with the appropriate name exists
if not os.path.exists(directory):
    os.makedirs(directory)

# save the plots
canvas = FigureCanvasAgg(fig)
filename = settings.MEDIA_ROOT + os.sep + directory  + os.sep + name_prefix + ".png"
# saves figure to filesystem in png format
canvas.print_figure(filename)
... 
```

The actual location that you will save at should be determined by your needs. The key points are to use fully qualified paths and to check for the existence of the directory / subdirectory before attempting to save the image.

# python - Python中的正则表达式在字母字符串后获取数字字符串

> ID：12846815
> 
> 赞同：2
> 
> 时间：2012-10-11T19:09:12.737
> 
> 标签：python, regex

我有一个格式为`results_item12345`. 数字部分的长度为四位或五位。字母总是小写的，并且在非数字部分的某处总是有一个下划线。

我尝试使用以下方法提取它：

```
 import re
 string = 'results_item12345'
 re.search(r'[^a-z][\d]',string) 
```

但是，我只得到最左边的两位数。我怎样才能得到整个号码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-11T19:11:04.943

假设您*只*关心字符串末尾的数字，以下表达式匹配字符串末尾的 4 或 5 位数字。

```
\d{4,5}$ 
```

否则，以下将是匹配所提供要求的完整正则表达式。

```
^[a-z_]+\d{4,5}$ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T19:13:17.640

如果您只想匹配字符串中的任何数字，您可以搜索：

```
r'[\d]{4,5}' 
```

如果您需要某种类型的验证，您需要使用：

```
r'^result_item[\d]{4,5}$' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-27T11:12:32.377

```
import re    
a="results_item12345"
pattern=re.compile(r"(\D+)(\d+)")
x=pattern.match(a).groups()
print x[1] 
```

# windows - 从 Windows 操作系统到 GitHub 存储库 - install_github() 不起作用 - 可能与 Rtools 相关

> ID：12846817
> 
> 赞同：0
> 
> 时间：2012-10-11T19:09:27.400
> 
> 标签：windows, r, github, ropensci

答：这是我想到的项目 - (weblink) schamberlain.github.com/2012/10/rgbif-newfxns/

B：这是他们的 GitHub - [https://github.com/ropensci/rgbif](https://github.com/ropensci/rgbif)

C：我的机器：i86-64bit，Windows 7，R. 2.15，RStudio 0.96.330

按照他们的指示，我执行以下操作：

a) 下载和安装 Rtools 2.15 (weblink) cran.r-project.org/bin/windows/Rtools/

这一步对我来说简直就是魔法，我只是按照“Windows 工具集”附录（网络链接）cran.r-project.org/doc/manuals/R-admin.html#The-Windows-toolset 中给出的说明进行操作。

最后，我的系统中有这个讨厌的 C:\Rtools 文件夹，并且 PATH 变量（不知道这是什么）设置为附录建议的（据我所知）。

b）在 R 中：库（devtools）

c) 在 R 中： install_github("rgbif", "ropensci")

这将产生一些通知输出并以此[错误消息](http://pastebin.com/sU3G54SJ)结尾（它是输出的 pastebin.com 片段）。

我不确定是否可以帮助提供所提供的信息。另外我觉得（a）和（b）之间缺少一些东西-b / c我在R中看不到包'Rtools'-也许这就是它应该是的，我应该怎么知道？

我应该添加：在我的默认库文件夹 .../Documents/R/win-library/2.15 之后，有一个解压缩的文件夹“ropensci-rgbif-60c74ca”，其中包含所有需要的文件！但我无法从 R 中访问它。

# c# - 我在 Gridview 中显示 Excel 文件的内容。如何处理合并的单元格？

> ID：12846829
> 
> 赞同：3
> 
> 时间：2012-10-11T19:10:31.553
> 
> 标签：c#, .net, excel

我想在网页中读取并显示一个 excel 文件。我`Microsoft.Office.Interop.Excel`在 .aspx.cs 和 .aspx 中使用 GridView。我只是将它读入 DataTable 并将其绑定到 GridView。

问题是，我无法处理合并的单元格。例如，如果在 Excel 中合并两列，则在显示时，它将显示两列，其中第一个单元格中的值，第二个单元格将为空。我只想按原样检索工作表。有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T20:32:26.107

`Microsoft.Office.Interop.Excel`旨在提供对 excel 文件的编程访问。它会做一些格式化工作（见`Text`属性），但渲染的大部分困难留给消费者（你的程序）。

`MergeCells``True`如果您有合并的单元格，`MergeArea`将返回，并将返回包含`Range`合并单元格的 a。然后，您可以使用的单元格的`RowSpan`和`ColumnSpan`字段`GridView`来复制功能。

# antlr - ANTLR 浮点和 Int 以语法形式返回

> ID：12846831
> 
> 赞同：2
> 
> 时间：2012-10-11T19:10:44.507
> 
> 标签：antlr, grammar

我正在使用 ANTLR 创建一种语言，并使用 expr.g 示例开始了一种基础语言。我正在使用 ANTLR 3。我已准备好处理比 int 更多的数据类型，环顾四周后，我在[这里](https://stackoverflow.com/questions/1931307/antlr-is-there-a-simple-example/1932664#1932664)找到了 Bart Kiers 的浮点数的精彩示例。

在他的示例中，他有表达式 return float，然而，这意味着它不返回 int。我对如何让返回规则允许多种返回类型感到困惑？我在想我可以创建一个结合了整数和浮点数的组合“数字”类型并返回它，但是当然我遇到了在 Java 中我必须专门返回一个整数或浮点数的问题。我是否必须有两个版本的表达式代码，每个数据类型一个？我认为这不是必需的，但我很难过......我可以想象对表达式使用可选规则（即在这个表达式中浮点或 int 是有效的），但返回类型本身需要一个特定的类型。我很抱歉重复自己，但我希望我清楚我的困惑。

[这是我的语法文件](https://code.google.com/p/rongo/source/browse/rongo.g)

和表达式语法部分：

```
expr returns [int value]
    : e=mexpr {$value = $e.value;}
      ( PLUS e=mexpr {$value += $e.value;}
      | MINUS e=mexpr {$value -= $e.value;}
      )*
    ; 
```

与巴特的比较：

```
additionExp returns [double value]
    :    m1=multiplyExp       {$value =  $m1.value;} 
         ( '+' m2=multiplyExp {$value += $m2.value;} 
         | '-' m2=multiplyExp {$value -= $m2.value;}
         )* 
    ; 
```

当然，我们的规则正在使用适当的数据类型（对我来说是 int，对他来说是 float）......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:31:48.170

我真的不认为有必要让规则同时返回 a`double` *和* `int`：如果您需要 a `int`，只需强制转换`double`.

也就是说，ANTLR 规则可以返回多个对象（或原语）：

```
additionExp returns [double value, int i] 
```

您可以在倾斜代码中设置它`{ ... }`，就像`$value`，或者在`@after{ ... }`块中设置它：

```
additionExp returns [double value, int i]
@after{ $i = (int)$value; }
    :    m1=multiplyExp       {$value =  $m1.value;} 
         ( '+' m2=multiplyExp {$value += $m2.value;} 
         | '-' m2=multiplyExp {$value -= $m2.value;}
         )* 
    ; 
```

在其他规则中，您只需引用规则中的任何一个`value`或`i`从`additionExp`规则中引用，如下所示：

```
otherRule
 : a=additionExp { 
                   System.out.println("int a.i = " + $a.i);
                   System.out.println("double a.value = " + $a.value);
                 }
 ; 
```

# javascript - Backbone.js 慢速服务器 save() 响应覆盖本地更改的属性

> ID：12846835
> 
> 赞同：2
> 
> 时间：2012-10-11T19:10:50.650
> 
> 标签：javascript, backbone.js

我的 Backbone 模型出现了一些奇怪的行为——我在调用`save()`和服务器响应之间设置的属性被丢弃，取而代之的是服务器响应（它只是回显保存的属性）。

这是 Backbone 应该表现的方式吗？当服务器有点滞后时，它让我的应用程序看起来非常疯狂 - 它`currentScreen`用旧的属性覆盖我的属性，它向后导航一个屏幕。这是我的代码：

```
Interview = Backbone.Model.extend({
    urlRoot: "/interviews",
    defaults: {
        "currentScreen": 0
    }
}); 
```

这是我的 Jasmine/Sinon.JS 测试，描述了我的期望（它失败了`Expected 0 to equal 1.`）：

```
describe("Interview model", function() {

    beforeEach(function() {
        this.interview = new Interview;
    });

    describe("saving with a slow server response", function() {

        beforeEach(function() {
            this.server = sinon.fakeServer.create();
        });

        afterEach(function() {
            this.server.restore();
        });

        it('should not overwrite locally changed attributes on server response', function() {
            this.server.respondWith("PUT", "/interviews/1",
                       [200, { "Content-Type": "application/json" },
                        '{"id":1,"currentScreen":0}']);
            this.interview.set({id: 1, currentScreen: 0});
            this.interview.save();

            this.interview.set({currentScreen: 1}); // user navigates to next screen
            this.server.respond(); // return fake response after currentScreen changed locally
            expect(this.interview.get('currentScreen')).toEqual(1);
        });

    });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T20:06:38.230

是的，这就是它应该如何工作的方式。您的服务器具有规范的数据集，因此无论真实值是什么，它都会覆盖客户端状态。

如果您不希望或不需要服务器在保存后更新客户端，那么就不要返回任何更改的属性——只需使用一个空对象：`{}`

# c# - 使用 C# 检测事件源和事件类型

> ID：12846840
> 
> 赞同：1
> 
> 时间：2012-10-11T19:11:12.480
> 
> 标签：c#

我正在学习如何与代表合作，现在已经有了一些想法。在 C# 代码（如下）中，我喜欢在字符串中捕获事件类型。获取事件来源和事件类型的最佳方法是什么？

对于我正在使用的来源的名称，`sender.GetType().FullName.ToString();`如果它是正确的。事件类型呢？

谢谢。

```
protected virtual void OnChanged(EventArgs e)
{
    if (Changed != null)
        Changed(this,e);
}

protected override void OnClosed(EventArgs e)
{
    base.OnClosed(e);
    OnChanged(EventArgs.Empty);
}

public EventListener(myForm theform)
{
    TheForm = theform;
    TheForm.Changed += new ChangedEventHandler(myMethod);
}

private void myMethod(object sender, EventArgs e)
{

    string s = "hey, got notified " + sender.GetType().FullName.ToString();
    MessageBox.Show(s);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:27:26.953

无法知道哪个事件调用了`EventArgs`该类的函数。

如果您正在使用准备好的事件（如 Click 事件），您可以像这样创建自己的“Args”类：

```
public class MyEventArgs : EventArgs
{
    public string EventCallerName { get; set; }
} 
```

然后像这样调用事件：

```
 if (Changed != null)  
        Changed(this,new MyEventArgs() { EventCallerName = "Changed" }); 
```

在接收器方法中，您可以看到该值，如下所示：

```
private void myMethod(object sender, EventArgs e) 
{ 
    if (e is MyEventArgs)
        MessageBox.Show("Event type: " + (e as MyEventType).EventCallerName); 
    string s = "hey, got notified " + sender.GetType().FullName.ToString(); 
    MessageBox.Show(s); 
} 
```

但是，如果您使用自己的事件，您可以创建自己的委托并随心所欲地使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:24:40.760

您应该能够使用[StackTrace](http://msdn.microsoft.com/en-us/library/system.diagnostics.stacktrace.getframe.aspx)找到事件的来源。我相信您会发现事件通常由名称与事件名称相似的受保护函数触发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T19:28:11.440

事件的支持类型是委托。无法确定来自事件处理程序的事件源。但是，您可以在订阅事件时检查委托类型。定义\发布事件的类将是事件源，委托的类型将是事件类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T19:29:47.637

这可能是正确的解决方案吗？：

```
 private void Form1_FormClosed(object sender, EventArgs e)
        {
            var eventType = e.ToString().Split('.').Last().Replace("EventArgs", ""); //eventType = "FromClosed"
        } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T19:35:52.237

假设您想要事件的名称，而不是检测为什么在为事件注册处理程序时不修复它？就像是：

```
public EventListener(myForm theform)
{
    TheForm = theform;
    TheForm.Changed += (s, e) => this.MyMethod(s, e, "Changed");
}

private void MyMethod(object sender, EventArgs e, string eventName)
{
    string s = "hey, got notified " + sender.GetType().FullName.ToString();
    MessageBox.Show(s);
} 
```

# javascript - Jquery 菜单 - 子菜单切换

> ID：12846846
> 
> 赞同：1
> 
> 时间：2012-10-11T19:11:36.317
> 
> 标签：javascript, jquery, html, animation

我正在尝试从菜单链接切换子菜单，这是我的标记：

```
<ul id="menu">
<li id="artworks"><a href="#">ARTWORK</a></li>
    <ul class="submenu">
        <img src="../img/submenu.png" alt="submenu" width="62" height="1" />
        <li><a href="#">Sweet Life</a></li>
        <li><a href="#">Pleasure</a></li>
        <li><a href="#">Bienal de la habana</a></li>
        <img src="../img/submenu.png" alt="submenu" width="62" height="1" />
    </ul>
<li id="prensa_nav"><a href="prensa.html">PRENSA</a></li>
<li id="contacto_nav"><a href="contacto.html">CONTACTO</a></li> 
```

这是我的脚本：

```
$(function () {

var $submenu = $( '.submenu' );

$( '#artworks a' ).click( function( e ) {
    $submenu.toggle( 'fast' );
    e.preventDefault();
    e.stoppropagation();
} );
});​ 
```

我不知道为什么，但它不起作用，它应该很简单，但它不起作用；我已经尝试了一切，请帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T19:15:41.930

当您触发点击事件时，您的`$submenu`变量超出了范围。你打错了`stopPropagation`。您的标记缺少结束语`<ul>`。

[这是一个工作示例](http://jsfiddle.net/tebCS/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:15:10.023

修复无效的 HTML。将`submenu`UL 移动为`#artworks`列表项的子项。

# mysql - MySQL以错误的顺序插入数据

> ID：12846847
> 
> 赞同：0
> 
> 时间：2012-10-11T19:11:37.840
> 
> 标签：mysql, database, insert

订单完成后，我的付款处理方收到以下回复

```
Receipt_ID1, Order_ID1, Data_1 
```

我成功地将这些值以相同的顺序插入到我的 MySQL 表中。但有时当在 1-2 秒内执行**两个订单时，****数据值** 会以错误的方式插入到表中。数据值交换。我得到以下结果

```
Receipt_ID1, Order_ID1, Data_2
Receipt_ID2, Order_ID2, Data_1 
```

谁能告诉我为什么会发生这种情况以及如何确保在正确的收据中插入正确的数据值？

好的，这些是 SQL 语句的实际顺序 -

```
$new_order_id_query = "SHOW TABLE STATUS LIKE ORDERS";
$new_order_id = $row['Auto_increment']; 
```

这就是我从 Orders 表中获取新订单 ID 并将其发送到支付处理器的方式。然后我收到响应数组并将其分解并执行一个简单的插入语句，如下所示

```
INSERT INTO Receipts Values(ReceiptID, OrderID, Data) Values ($Receipt_ID, $Order_ID, $Data); 
```

希望能更好地解释它！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T08:13:09.563

当您将记录插入表中时，您应该使用`mysqli_insert_id`or获取 id `PDO::lastInsertId()`。这是 100% 确保获得为该插入生成的 id 的唯一方法。

# c# - 从richtextbox获取值并将它们分配给c#中的单选按钮？

> ID：12846849
> 
> 赞同：0
> 
> 时间：2012-10-11T19:11:53.477
> 
> 标签：c#, user-interface

我正在开发一个程序，该程序将在循环中从richtextboxes 获取输入，然后我想将从用户获得的文本分配给将在组框中的单选按钮。我成功地循环开发了带有richtextboxes的表单，但现在我坚持如何将它们分配给循环中的单选按钮？当我点击按钮？？请在这方面指导我？

一段代码在这里

```
Label label1 = new Label();
                label1.Size = new System.Drawing.Size(96, 24);
                label1.Text = "Question" + _openCount++;
                label1.Font = new System.Drawing.Font("Microsoft Sans Serif", 14.25F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
                RichTextBox richTextBox1 = new RichTextBox();
                richTextBox1.Size = new System.Drawing.Size(600, 91);
                richTextBox1.Text = "";
                Label label2 = new Label();
                label2.Size = new System.Drawing.Size(96, 24);
                label2.Text = "Option1";
...................... 
```

现在我想把我的代码放在这个按钮中我如何进一步启动我的代码？？？

```
void button1(object sender, EventArgs e)
        {

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:19:32.367

创建一个单选按钮列表，然后创建一个富文本框字符串列表。

Enumerable.Zip 这两个列表一起然后遍历该列表。

```
foreach(var item in zippedList)
{
    item.RadioButton.Text = item.RichTextBoxText.Text;
} 
```

这样做的语法会很离谱，但我希望你明白这一点。这也是假设您有相同数量的单选按钮和文本行。您需要考虑到这一点，如果两个列表的长度不同，则必须在压缩它们之前修改它们。

# asp.net-mvc - 从区域内的不同控件访问局部视图

> ID：12846850
> 
> 赞同：1
> 
> 时间：2012-10-11T19:11:55.753
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, asp.net-mvc-areas

在 MVC 视图中，我想从不同的控制器访问部分视图。在我解释我手头的问题之前，您应该知道我的解决方案中的所有内容：

```
Areas      
   MyArea    
        Views
         Cont1
           PartialPages
           ViewImIn
         Cont2
            PartialPages
               ViewICall 
```

现在，在 ViewImIn.cshtml 我这样调用 ViewIcall.cshtml ：

```
@Html.Partial("~/Views/Cont2/PartialPages/ViewICall.cshtml", Model) 
```

但我不断收到错误消息，指出“未找到部分视图或视图引擎不支持搜索的位置......”

我也尝试过“../Cont2/PartialPages/ViewICall”及其变体。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:15:00.650

尝试这样称呼它

```
 @{Html.RenderPartial("ViewICall");} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:39:27.533

与其在 Cont2 下拥有 PartialPages 文件夹，不如在 Views 下拥有一个 Shared 文件夹。然后应该可以直接找到：

```
@{Html.RenderPartial("ViewICall", Model);} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T14:40:28.613

您还可以使用 RenderAction，它可能是您所寻找的，也可能不是。如果 ViewICall 的模型不同，或者您想分离模型/逻辑；然后你可以使用 RenderAction 来调用 Controller 方法并渲染结果。如果您尝试渲染的局部视图使用与当前视图相同的模型，则使用 RenderPartial。

*   [这](http://haacked.com/archive/2009/11/17/aspnetmvc2-render-action.aspx)是 Phil Haack 关于 Html.RenderAction 和 Html.Action 的帖子
*   [这](http://captaincodeman.com/2009/02/21/when-to-use-renderaction-vs-renderpartial-with-asp-net-mvc/)是关于何时使用 RenderAction 以及何时使用 RenderPartial 的帖子

# php - SVG/PNG 扩展开关

> ID：12846852
> 
> 赞同：4
> 
> 时间：2012-10-11T19:12:16.487
> 
> 标签：php, javascript, svg, png, modernizr

有没有办法在我的网站上使用 SVG 图像，如果浏览器/设备不支持它，请将扩展名切换为 png？有一个更好的方法吗？

注意：我使用的是`<img>`标签和 Modernizr。

这是我动态吐出图像的代码。

```
<?php $attachments = attachments_get_attachments(); ?>
        <?php if( function_exists( 'attachments_get_attachments' ) ) {
        $attachments = attachments_get_attachments();
        $total_attachments = count( $attachments ); if( $total_attachments ) : ?><?php for( $i=0; $i<$total_attachments; $i++ ) : ?>
<img src="<?php echo $attachments[$i]['location']; ?>" alt="<?php echo $attachments[$i]['title']; ?>" class="full" />
<?php endfor; ?><?php endif; ?><?php } ?> 
```

输出以下内容： `<img src="http://mysiteurl.net/image.png" alt="Image Title" class="full wp-image-287" />`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-09T09:44:32.303

这是有效的，只过滤 svg 文件

```
<script type="text/javascript">
jQuery( document ).ready(function() {
    if(!Modernizr.svg){
      jQuery("img").each(function(){
        var src = this.src;
        if( src.match(/svg$/) ){
            // Replace "svg" by "png"
            this.src = src.slice(0,-3) + 'png'
        }           
      });
    }
});
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:20:55.190

我想您可以测试是否`svg`支持，如果不支持则遍历您的图像标签并将其 src 路径设置为`.png`. 此示例尚未经过测试，但它可能是朝着正确方向迈出的一步。

```
if(!Modernizr.svg){
  var images = document.getElementsByTagName("img");
  for(var i = 0; i < images.length; i++){
    var src = images[i].src.split(".");
    images[i].src = src[0] + ".png";
  }
} 
```

如果 jQuery 是一个选项，那么这样的事情可能是可能的：

```
if(!Modernizr.svg){
  $("img").each(function(){
    var src = this.src.split(".");
    this.src = src[0] + ".png";
  });
} 
```

**编辑**

您也可以考虑查看[Modernizr-Server](https://github.com/jamesgpearce/modernizr-server)。这样，您可以在循环浏览图像并附加适当的扩展名时测试 svg。

```
if ($modernizr->svg) {
    ...
} elseif ($modernizr->canvas) {
    ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T23:46:04.760

另一种方法是使用具有后备功能的 SVG 的 CSS-ony 解决方案，如本答案所述： [https ://stackoverflow.com/a/13575068/418711](https://stackoverflow.com/a/13575068/418711)

# jquery - 计算 Div 中的图像

> ID：12846854
> 
> 赞同：0
> 
> 时间：2012-10-11T19:12:22.507
> 
> 标签：jquery, css, image

我在计算 div 中的图像数量时遇到问题。

例如 1/4、2/4、3/4、4/4

这是我试图弄清楚的小代码

```
//count image
var currentNum = $(this).iniShow() + 1;
var count = $(this).closest('.slideshow').find('img:first').length;
var item = $(this).closest('.slideshow').attr('id');
       $('.' + item ).html(currentNum + ' of ' + count); 
```

到目前为止，这是我的 html 代码：

```
<!DOCTYPE html> 
<html> 
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js">   </script>
</head>
<style>
.slideshow img { display: none; cursor: pointer; }
</style>
<script type="text/javascript">
jQuery(function($){
//previous slide
$('.slideshow .prev').click(function() {
    prevSlide($(this).closest('.slideshow').find('.slides'));
});
//next slide
$('.slideshow .next, .slideshow img,').click(function() {
    nextSlide($(this).closest('.slideshow').find('.slides'));
});
//initialize show
iniShow();
function iniShow() {
    // show first slide with caption
    $('.slideshow').each(function() {
        showSlide($(this).find('.slides'));
    });
}
// move previous slide 
function prevSlide($slides) {
    $slides.find('img:last').prependTo($slides);
    showSlide($slides);
}
// move next slide 
function nextSlide($slides) {
    $slides.find('img:first').appendTo($slides);
    showSlide($slides);
}
// show slide with caption
function showSlide($slides) {
    var $nextSlide = $slides.find('img:first');
    //hide (reset) all slides
    $slides.find('img').hide();
    //fade in next slide
    $nextSlide.fadeIn(500);
    //show caption
    $('#caption').text($nextSlide[0].alt);
    //count image
    var currentNum = $(this).iniShow() + 1;
    var count = $(this).closest('.slideshow').find('img').length;
    $('#count').html(currentNum + ' of ' + count);
    }
});
</script>
<body>
<div class="slideshow">
<div class="slides">
    <img src="image/1a.jpg" width="500" height="500" alt="Caption 1 Image is ..." />
    <img src="image/2a.jpg" width="500" height="500" alt="Caption 2 Image is ..." />
    <img src="image/3a.jpg" width="500" height="500" alt="Caption 3 Image is ..." />
    <img src="image/4a.jpg" width="500" height="500" alt="Caption 4 Image is ..." />
</div>
<p id="caption"></p> / <p id="count"></p>
<div class="controls">
<a class="prev" href="javascript:void(0);">Previous</a> -
<a class="next" href="javascript:void(0);">Next</a>
</div>
</div>
</body>
</html> 
```

任何建议将不胜感激。我也想知道我是否接近解决这个问题。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T19:16:08.823

你似乎在使用这个

```
.find('img:first').length; 
```

因此，如果其中有图像，计数将始终为**1 ..**

试试这个

```
var count = $slides.closest('.slideshow').find('img').length; 
```

此外，**这**在当前函数上下文中没有任何意义.. 将其替换为**$slides**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:13:25.687

您可以直接使用 count 作为选择器。[jsfiddle 的变化](http://jsfiddle.net/xYXGX/2/)

为了

```
var item = $(this).closest('.slideshow').attr('id');
       $('.' + item ).html(currentNum + ' of ' + count); 
```

我相信你想用 id 在 div 中显示你的计数`count`。对于 id，您应该使用 # 而不是 .（用于类 selectopr）。

```
 $('#count').html(currentNum + ' of ' + count); 
```

修改后的代码：

```
var currentNum = $(this).iniShow() + 1;
var count = $(this).closest('.slideshow').find('img').length;
       $('#count').html(currentNum + ' of ' + count); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T19:18:52.540

语法必须是：

```
var count = $('div.myDiv').find('img').size(); 
```

所以在你的情况下，它将是：

```
var count = $(this).closest('.slideshow').find('img').size(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T19:21:04.130

你可以试试这个：

```
var count = $(".slides > img").size(); 
```

* * *

它更好地使用`id`，而不是`class`你的情况。所以你的`div`会看起来像这样：

```
 <div id="slides">
    <img src="image/1a.jpg" width="500" height="500" alt="Caption 1 Image is ..." />
    <img src="image/2a.jpg" width="500" height="500" alt="Caption 2 Image is ..." />
    <img src="image/3a.jpg" width="500" height="500" alt="Caption 3 Image is ..." />
    <img src="image/4a.jpg" width="500" height="500" alt="Caption 4 Image is ..." />
  </div>
... 
```

和你的jQuery代码：

```
var count = $("#slides > img").size(); 
```

参见示例：[jsfiddle](http://jsfiddle.net/liorlolo/YD28x/2/)

# jquery - jquery 库与 jquery mobile 冲突

> ID：12846857
> 
> 赞同：0
> 
> 时间：2012-10-11T19:12:27.470
> 
> 标签：jquery, jquery-mobile

我有一个使用 jquery 和 jquery mobile 的页面。在同一页面中，我有一个指向同一页面另一部分的链接（请参阅[http://www.coffeecup.com/help/articles/how-do-i-make-links-to-different-sections-的同一页/](http://www.coffeecup.com/help/articles/how-do-i-make-links-to-different-sections-of-the-same-page/)）。现在，当我单击该链接时，它不会去任何地方。这是代码[http://jsfiddle.net/sCsSN/](http://jsfiddle.net/sCsSN/)。这是假设工作不？此外，如果我删除其中一个库，这可行，但如果我保留它们，它就不起作用。任何人对我该如何去做这件事有任何建议？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T21:29:07.207

根据 jQuery-Mobile[文档](http://jquerymobile.com/demos/1.2.0/docs/pages/page-navmodel.html)，不支持使用哈希导航

> 由于我们使用 URL 哈希来保留后退按钮的行为，因此使用传统的锚链接 (#foo) 不支持使用页面锚来跳转到页面上的某个位置。使用[silentScroll](http://jquerymobile.com/demos/1.2.0/docs/api/methods.html)方法滚动到特定的 Y 位置，而不触发滚动事件侦听器。你可以传入一个 yPos 参数来滚动到那个 Y 位置。

这是文档中的silentScroll方法示例

```
$.mobile.silentScroll(100); 
```

您可能还想查看JQM 论坛中关于同一主题的[这个论坛](https://forum.jquery.com/topic/jquery-mobile-anchor-linking)主题。

# java - java正则表达式清除mediawiki标记

> ID：12846866
> 
> 赞同：1
> 
> 时间：2012-10-11T19:13:10.307
> 
> 标签：java, regex, performance, mediawiki, matcher

> **可能重复：**
> [Wikipedia : Java library to remove wikipedia text markup removal](https://stackoverflow.com/questions/2863272/wikipedia-java-library-to-remove-wikipedia-text-markup-removal)

我必须清理一些来自 Confluence 的内容。该内容几乎是干净的；但是，有些事情是这样的：

1.  [link|]：不带 url 部分的链接
2.  *[link|]*：粗体链接（不包括 url 部分）
3.  *文本*：粗体文本
4.  _*text*_：斜体粗体文本

等等。我需要编写一个清除所有这些的正则表达式，所以，我做了类似的事情：

`String wikiCleanMarkupRegex = "\\\\[(.*?)[\\\\|.*?]?\\\\]|\\\\*(.*?)\\\\*|_(.*?)_";`

但这并不能清除所有内容，我的意思是，如果我将 #2 中的链接提供给它，我将得到：

[链接|]

这不是我想要的，我想获得“链接”......所以，我需要一次又一次地重新解析字符串，直到找不到其他匹配项。

这真的很慢，因为有数百万条记录要清理，那么，有没有办法做一个一次性的正则表达式？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:18:45.847

因为它看起来基本上是三种类型的代码格式：*斜体*、**粗体**和[链接](http://pastebin.com/7WWwYMpy)

我会做一个 3-pass 正则表达式替换器。

并且根据您给出的输入的优先顺序应该是：

```
/**
 * FIRST REMOVE ITALICS, THEN BOLD, THEN URL
 */
public static String cleanWikiFormat(CharSequence sequence) {
    return Test.removeUrl(Test.removeBold(Test.removeItalic(sequence)));
} 
```

这是一个示例代码：

```
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class Test {

    private static String removeItalic(CharSequence sequence) {
        Pattern patt = Pattern.compile("_\\*(.+?)\\*_");
        Matcher m = patt.matcher(sequence);
        StringBuffer sb = new StringBuffer(sequence.length());
        while (m.find()) {
            String text = m.group(1);
            // ... possibly process 'text' ...
            m.appendReplacement(sb, Matcher.quoteReplacement(text));
        }
        m.appendTail(sb);
        return sb.toString();
    }

    private static String removeBold(CharSequence sequence) {
        Pattern patt = Pattern.compile("\\*(.+?)\\*");
        Matcher m = patt.matcher(sequence);
        StringBuffer sb = new StringBuffer(sequence.length());
        while (m.find()) {
            String text = m.group(1);
            // ... possibly process 'text' ...
            m.appendReplacement(sb, Matcher.quoteReplacement(text));
        }
        m.appendTail(sb);
        return sb.toString();
    }

    private static String removeUrl(CharSequence sequence) {
        Pattern patt = Pattern.compile("\\[(.+?)\\|\\]");
        Matcher m = patt.matcher(sequence);
        StringBuffer sb = new StringBuffer(sequence.length());
        while (m.find()) {
            String text = m.group(1);
            // ... possibly process 'text' ...
            m.appendReplacement(sb, Matcher.quoteReplacement(text));
        }
        m.appendTail(sb);
        return sb.toString();
    }

    public static String cleanWikiFormat(CharSequence sequence) {
        return Test.removeUrl(Test.removeBold(Test.removeItalic(sequence)));
    }

    public static void main(String[] args) {
        String text = "[hello|] this is just a *[test|]* to clean wiki *type* and _*formatting*_";
        System.out.println("Original");
        System.out.println(text);
        text = Test.cleanWikiFormat(text);
        System.out.println("CHANGED");
        System.out.println(text);
    }
} 
```

以下将给出：

```
Original
[hello|] this is just a *[test|]* to clean wiki *type* and _*formatting*_
CHANGED
hello this is just a test to clean wiki type and formatting 
```

# ruby-on-rails - 在 has_many :through 关系上覆盖 ActiveRecord << 运算符，以接受连接模型的数据

> ID：12846881
> 
> 赞同：7
> 
> 时间：2012-10-11T19:14:25.533
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activerecord, ruby-on-rails-3.2

我有三个类：Person、Position 和 Directory。

*   一个人 has_many :directories, :through => :position。
*   目录 has_many :people, :through => :position。
*   Person 和 Directory 都有很多 :positions。
*   Position 模型除了具有id、person_id 和directory_id 之外，还具有一个或多个附加字段（例如，title）。

我希望能够在每次将人员添加到 Directory.people 集合时将数据添加到连接模型，例如标题字段。通常的 << 运算符不会削减它。身份证：

```
directory = Directory.last     # Let's assume that retrieves a Directory object
person = Person.last           # Let's assume that retrieves a Person object
directory.people << person 
```

这会将一个人添加到 Directory 对象的人员集合中，但不允许我将数据分配给连接模型。所以，在对这个网站做了很多研究之后，我找到了另一种方法来将 Person 添加到 people 集合中，并将数据添加到连接 Person 和 Directory 的 Position 中，id est：

```
directory = Directory.last     # Let's assume that retrieves a Directory object
person = Person.last           # Let's assume that retrieves a Person object
position = person.positions.build(:directory_id => directory.id, :title => "Administrative Assistant") 
position.save 
```

这很麻烦。一个同样繁琐的方法是：

```
directory = Directory.last     # Let's assume that retrieves a Directory object
person = Person.last           # Let's assume that retrieves a Person object
position = Position.new(directory_id: directory.id, person_id: person.id, title: "Administrative Assistant") 
```

同样，这似乎是错误的，因为我希望能够强调 Person 和 Directory 之间的关系，我相信这就是使用 has_many :through 适当的原因。

我想做的是使用 << 运算符，然后传递其他数据，例如：

```
directory = Directory.last # Let's assume that retrieves a Directory object
person = Person.last # Let's assume that retrieves a Person object
directory.people << person, :position => {:title => "Administrative Assistant"} 
```

我在 has_many :through 声明中重载了 << 运算符，如下所示：

```
has_many :people, :through => :positions do
  def << *args
    arg = args.first
    if arg.is_a?(Person)
      self.push([arg]) 
    elsif arg.is_a?(Hash)
      # Don't know what to do in here (see below)
    else
      raise "Invalid Value" # There's a better error to raise here, but good enough for now.
    end
  end
end 
```

让它工作的优点是它在语法上运行良好，并且允许我在将 Person 添加到 Directory 对象的人员集合时简洁地将数据分配给连接对象（位置）。

但我不能让它工作，因为我需要能够访问 << 运算符左侧的人员集合是一个属性的 Directory 对象，以便构建一个 Position 并将其保存到数据库中。

**所以，我的问题是：**

1.  有没有办法从对象的属性访问对象？
2.  或者，是否有另一种方法可以重载 << 运算符，以便我可以在将一个对象添加到集合时轻松地将数据分配给连接模型？

非常感谢您的帮助和周到的答复。我一直在破解这个半天无济于事。

**回答** 感谢 PinnyM，他回答了这个问题，我能够想出这个实现：

```
module AddToPeopleAndPositionExtension
  def << *args
    arg = args.first
      if arg.is_a?(Person)
        self.push([arg]) 
        return self
      elsif arg.is_a?(Hash)
        directory = proxy_association.owner
        person = arg[:person]
        position = person.positions.build(:directory_id => directory.id, :title => arg[:position][:title]) 
        position.save
      else
        raise "Invalid Value"
      end
  end
end

class Directory < ActiveRecord::Base  
  # Relationships
  has_many :positions
  has_many :people, :through => :positions, :extend => AddToPeopleAndPositionExtension
end 
```

如果我不关心连接模型上发生的情况，这允许我以标准方式调用 << 运算符，例如：

```
directory = Directory.last     # Let's assume that retrieves a Directory object
person = Person.last           # Let's assume that retrieves a Person object
directory.people << person 
```

而且，我还可以以指定连接模型属性的方式调用它，例如：

```
directory = Directory.last     # Let's assume that retrieves a Directory object
person = Person.last           # Let's assume that retrieves a Person object
directory.people << {:person => person, :position => {:title => "Administrative Assistant"}} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-11T19:28:22.750

您可以使用`proxy_association`块内的帮助程序来获取关联并`proxy_association.owner`获取 Directory 对象本身。有关这方面的更多信息，请参见[此处。](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#label-Association+extensions)

# django - 在 Django 中将导入语句放在哪里？

> ID：12846882
> 
> 赞同：2
> 
> 时间：2012-10-11T19:14:26.363
> 
> 标签：django

我的views.py中有很多导入语句。

如果将所有导入都放在文件的开头，我将导入准确地放在需要它们的视图中，这对性能有帮助吗？

将它们放在需要它们的特定视图中也会有所帮助，例如，如果您必须删除不需要向上滚动的视图并删除不需要的导入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:26:37.370

> 如果将所有导入都放在文件的开头，我将导入准确地放在需要它们的视图中，这对性能有帮助吗？

否。如果所有导入都将放在文件的开头，则导入只执行一次 - 当 django-process 启动时。

# wso2 - WSO2 StratosLive 的问题

> ID：12846894
> 
> 赞同：0
> 
> 时间：2012-10-11T19:15:05.333
> 
> 标签：wso2, wso2stratos

[如https://wso2.org/jira/browse/STRATOS-2118](https://wso2.org/jira/browse/STRATOS-2118)所述，我在将示例 Spring 应用程序部署到 WSO2 StratosLive 时遇到了问题。

请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T07:57:02.540

我们会看看。但与此同时，您可以在独立服务器上尝试一下。在这种情况下是 WSO2 应用程序服务器。尽管 WSO2 AS 在运行时支持 Spring jars，但它不支持 spring classLoading。为了提供更多上下文，WSO2 服务器基于 OSGi 运行时。通常每个 OSGi 包都有自己的类加载器，因此也有自己的类加载器。

乍一看，这似乎是与上述行为相关的类加载问题。

高温高压

# python - 导入ftplib时出错

> ID：12846898
> 
> 赞同：0
> 
> 时间：2012-10-11T19:15:31.370
> 
> 标签：python, ftplib

我在运行前一段时间有效的代码时得到了这个。我试图更改导入选项aka`from ftplib import *`等，但没有运气。任何帮助表示赞赏...

```
C:\blahblahblah>python ftp_client.py
Traceback (most recent call last):
  File "ftp_client.py", line 8, in <module>
    from ftplib import FTP
  File "C:\blahblahblah\ftplib.py", line 1
    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtm
l11/DTD/xhtml11.dtd">
    ^
SyntaxError: invalid syntax 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:30:03.350

您从 Web 上下载并放置在脚本的同一目录中的副本`ftplib.py`（这是 Python 默认搜索模块的第一个位置）实际上是 HTML，而不是 Python 源代码。

你不应该需要你自己的`ftplib.py`，因为`ftplib` [它在标准库](http://docs.python.org/library/ftplib.html)中。删除它，我怀疑你的脚本会正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:19:51.600

您尝试导入`C:\blahblahblah\ftplib.py`包含 html 代码的文件。我认为这不是你想要的。

# ruby-on-rails - 使用 Test::Unit 测试 rails 3.2 引擎

> ID：12846904
> 
> 赞同：0
> 
> 时间：2012-10-11T19:15:47.047
> 
> 标签：ruby-on-rails

我在测试 rails 3.2 引擎时遇到了很大的困难。

我执行以下操作：

```
# generate the engine
rails plugin new myengine --mountable
cd myengine

# generate user resource
rails generate scaffold user name email password_digest

# try to run rake test from myengine root folder
rake test 
=> NoMethodError: undefined method `users' for #<myengine::UsersControllerTest> 
```

所以我试试这个：

```
cd test/dummy
rake myengine:install:migrations
rake db:migrate db:test:prepare  
rake test # from within test/dummy
=> # nothing happens, no output 
```

返回引擎的根文件夹

```
cd ../.. 
rake test
=> NoMethodError: undefined method `users' for #<myengine::UsersControllerTest> 
```

我怀疑未定义的方法是指我的 UsersContrllerTest 顶部的以下行：

```
setup do
  @user = users(:one)
end 
```

我确实有固定装置，它们是与脚手架的其余部分一起生成的，而且我没有弄乱任何代码，只是完成了上面概述的步骤。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T00:06:24.323

似乎有人在 8 个月前开了一张票，Rails 团队关闭了它，没有修复它。[解决步骤在此 Github 问题](https://github.com/rails/rails/issues/4971)的评论中有详细说明。

# spring - 创建 Spring Search 表单的最佳实践是什么？

> ID：12846908
> 
> 赞同：0
> 
> 时间：2012-10-11T19:16:18.543
> 
> 标签：spring, search, spring-mvc

创建 Spring MVC 搜索表单的最佳实践是什么？

例如，可以按姓名、姓氏和类别搜索客户。

是否需要创建一个与搜索表单中使用的参数相同的类，然后将该类绑定到表单？

非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:24:06.447

> 是否需要创建一个与搜索表单中使用的参数相同的类，然后将该类绑定到表单？

这是一种方式。如果您想在搜索表单的输入字段中以某种方式预定义值，那么使用此类（CommandObject / FormBackingBean）是一种好方法。

如果您不需要预定义字段，那么最简单的方法是访问请求参数“直接”：

```
@RequestMapping("search")
public ModelAndView search(@RequestParam("searchTerm") String searchTerm) 
```

# c# - EF 未在数据库级别执行 where 子句

> ID：12846913
> 
> 赞同：3
> 
> 时间：2012-10-11T19:16:55.873
> 
> 标签：c#, .net, entity-framework-4

免责声明：我将服务/实体/等的名称更改为记事本中 SO 的通用名称。如果您发现类名不一致，请忽略它们，因为这不是问题。

我正在为客户开发 WCF 服务，并且我正在序列化的表达式存在一些问题。我目前正在使用[Serialize.Linq](https://github.com/esskar/Serialize.Linq)来处理表达式序列化。最重要的是，我使用我的 DataContract 类在客户端创建表达式，并使用我的 Entity 类将其转换为表达式。

假设这两个类：

1.  MyEntity（项目中 DataContract 命名空间的一部分）
2.  MyEntity（项目中实体命名空间的一部分）

两者具有相同的属性，我使用 AutoMapper 将通过 EF 获得的实体转换为我的 DataContract 对象，然后将该对象发送回客户端。

为了处理表达式转换，我使用了 ExpressionVisitor 类：

```
class MyExpressionVisitor : ExpressionVisitor
{
    public ParameterExpression ParameterExpression { get; private set; }

    public MyExpressionVisitor(ParameterExpression newParameterExp)
    {
        ParameterExpression = newParameterExp;
    }

    protected override Expression VisitParameter(ParameterExpression node)
    {
        return ParameterExpression;
    }

    protected override Expression VisitMember(MemberExpression node)
    {
        if (node.Member.DeclaringType == typeof(DataContracts.MyEntity))
        {
            return Expression
                .MakeMemberAccess(this.Visit(node.Expression), typeof(Entities.MyEntity).GetMember(node.Member.Name).FirstOrDefault());
        }

        return base.VisitMember(node);
    }
} 
```

这就是我调用我的服务的方式：

```
Expression<Func<DataContracts.MyEntity, bool>> expression =
    fl.SomeNameField1 == "John Doe" || fl.SomeNameField2 == "John Doe";
var entities = manager.MyService.GetFilteredEntities(expression.ToExpressionNode()); 
```

这是我当前的服务实现（部分，省略返回行等）`GetFilteredEntities`：

```
// Using Serialize.Linq for send expressions over WCF.
// query is an ExpressionNode from the Serialize.Linq library.
// This DOES NOT execute the where clause on the database.
var expression = query.ToExpression<Func<DataContracts.MyEntity, bool>>();
var visitor = new MyExpressionVisitor(Expression.Parameter(typeof(Entities.MyEntity), expression.Parameters[0].Name));
var entityExpression = Expression.Lambda<Func<Entities.MyEntity, bool>>(visitor.Visit(expression.Body), visitor.ParameterExpression);
var func = entityExpression.Compile();
var entities = this.Entities.MyEntities.Where(func); 
```

所有这些代码都*有效*，但`Where`不是在数据库级别应用，而是针对我表中*每一*行的内存集应用。这需要很长时间，因为该表有 150k+ 行。

如果我在服务中对我想要的位置进行硬编码，它会在数据库级别应用 where 子句：

```
// This DOES execute the where clause on the database.
var temp1 = this.Entities.MyEntities.Where(fl => fl.SomeNameField1 == "John Doe" || fl.SomeNameField2 == "John Doe");

// This DOES execute the where clause on the database.
Func<Entities.MyEntity, bool> func2 = fl => fl.SomeNameField1 == "John Doe" || fl.SomeNameField2 == "John Doe";
var temp2 = this.Entities.MyEntities.Where(func2); 
```

我知道我可以编写一堆不同的服务操作，允许用户通过传入名称、ID 等进行过滤，但是这个表有大量的列（200+），我在所述数据库上输入为零. 对于可能正在使用我正在编写的客户端的其他开发人员来说，能够使用他们喜欢的任何数据和列来创建表达式要容易得多，所以我很*乐意*在数据库级别应用 where。

我几乎可以肯定我已经在这篇文章中包含了所有相关的内容。我使用 SQL Server Profiler 检查 EF 正在运行的查询，这就是我知道哪些查询在哪里使用的方式。请在需要时询问更多信息。

谢谢！

/墙文字

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:22:07.580

也许问题出在这一行：

```
var func = entityExpression.Compile(); 
```

由于您`Where`使用已编译的委托函数进行调用，因此您不会调用实际发送到数据库的 Where 的重载。

您需要将表达式对象传递给`Where`（即调用[其中之一](http://msdn.microsoft.com/en-us/library/system.linq.queryable.where.aspx)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:28:29.620

`Where`我认为你不应该在你的子句中使用它之前编译你的表达式。这样做将调用命名空间中提供的扩展`System.Core`方法`System.Linq`。您需要采用类型对象的方法重载`Expression`。

换句话说，尝试删除这一行：

```
var func = entityExpression.Compile(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T19:21:30.697

您是否尝试过使用`LinqKit`来创建复合查询？它提供了 `PredicateBuilder`一种使用表达式的简单方法。

看看[这个地址](http://www.albahari.com/nutshell/predicatebuilder.aspx)，源代码很简单，在我的案例中创造了奇迹。

# visual-studio-2010 - 我在单声道中使用时出现休眠事务问题

> ID：12846919
> 
> 赞同：0
> 
> 时间：2012-10-11T19:17:15.453
> 
> 标签：visual-studio-2010, nhibernate, mono

我正在使用 Visual Estudio 2010 c#、nhibernate queryover、silverlight 5 开发我的应用程序，在这部分中，我使用的数据访问部分都可以正常工作：

```
using (var session = NHibernateFactory.OpenSession())
{
   ClassAlias ca = null;
   var x = session.QueryOver<SomeClass>()
           .Where(root=>root.SomeField > somefield)
           .SelectList(list=>list
            .Select(root=>root.SomeField1).WithAlias(()=>ca.SF1)
             ...
            .Select(root=>root.SomeFieldN).WithAlias(()=>ca.SF2)
            )
            .UnderlyingCriteria.SetResultTransformer(
                        Transformers.AdvanceEntityMapTransformer<ClassAlias>())
                    .List<ClassAlias>();

} 
```

所有的数据访问都是 select 语句，所以问题是当我使用 mono 将我的应用程序发布到 linux 环境时，我开始得到这个间歇性错误：

```
16:51:45.488 [Threadpool worker] ERROR NHibernate.Transaction.AdoTransaction - Begin transaction failed
System.NotImplementedException: The requested feature is not implemented.
  at MySql.Data.MySqlClient.MySqlConnection.EnlistTransaction (System.Transactions.Transaction transaction) [0x00000] in <filename unknown>:0
  at MySql.Data.MySqlClient.MySqlConnection.Open () [0x00000] in <filename unknown>:0
  at NHibernate.Connection.DriverConnectionProvider.GetConnection () [0x00000] in <filename unknown>:0 
```

此日志来自 nhibernate 通用日志文件，认为我找不到修复它的人，任何帮助都会非常受欢迎

我添加了一个自定义日志来捕获异常，并确保 nhibernate 中的这个异常是我的查询失败的原因，就是这种情况，这就是异常：

```
 ERROR serverAppLog - custom error message
NHibernate.Exceptions.GenericADOException: could not execute query
[ SELECT this_.list_id as y0_, this_.list_name as y1_ FROM vicidial_lists this_ ]
[SQL: SELECT this_.list_id as y0_, this_.list_name as y1_ FROM vicidial_lists this_] ---> System.NotImplementedException: The requested feature is not implemented.
  at MySql.Data.MySqlClient.MySqlConnection.EnlistTransaction (System.Transactions.Transaction transaction) [0x00000] in <filename unknown>:0
  at MySql.Data.MySqlClient.MySqlConnection.Open () [0x00000] in <filename unknown>:0
  at NHibernate.Connection.DriverConnectionProvider.GetConnection () [0x00000] in <filename unknown>:0
  --- End of inner exception stack trace ---
  at NHibernate.Loader.Loader.DoList (ISessionImplementor session, NHibernate.Engine.QueryParameters queryParameters) [0x00000] in <filename unknown>:0
  at NHibernate.Loader.Loader.ListIgnoreQueryCache (ISessionImplementor session, NHibernate.Engine.QueryParameters queryParameters) [0x00000] in <filename unknown>:$
  at NHibernate.Loader.Loader.List (ISessionImplementor session, NHibernate.Engine.QueryParameters queryParameters, ISet`1 querySpaces, NHibernate.Type.IType[] resu$
  at NHibernate.Loader.Criteria.CriteriaLoader.List (ISessionImplementor session) [0x00000] in <filename unknown>:0
  at NHibernate.Impl.SessionImpl.List (NHibernate.Impl.CriteriaImpl criteria, IList results) [0x00000] in <filename unknown>:0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T13:44:20.820

如果您正在使用 System.Transactions / TransactionScope（从您的堆栈跟踪中可以看出），那么我怀疑这是因为事务被升级为分布式事务（即 DTC）。

如果您尝试访问同一 TransactionScope 中的两个不同事务资源，通常会发生这种情况 - 例如。两个不同的数据库（或相同的数据库，但连接字符串不同），或 MSMQ 和一个数据库。

问题是大多数 MySql 驱动程序不支持 DTC - 这就是引发此异常的原因。您有多种选择：

1.  找出它升级的原因并找到避免这种情况的方法（如果可能，最好的性能 - DTC 相对较慢）
2.  修复 MySql 驱动程序以升级或不加入（我不确定后者的后果）
3.  我听说有一些商业 MySql 驱动程序确实支持 DTC - 请咨询 Google
4.  可能使用 ODBC，请参阅[MySQL 和 MSSQL 之间的分布式事务](https://stackoverflow.com/questions/7204452/distributed-transactions-between-mysql-and-mssql)（我没有尝试过，但似乎可以）
5.  使用 Sql 服务器 :)

# android - css3变换rotate3d的透视在Android上不起作用

> ID：12846921
> 
> 赞同：8
> 
> 时间：2012-10-11T19:17:44.350
> 
> 标签：android, css, cordova

我有一个使用 3D 转换的 Web 应用程序，它在 Android 4.1 的 Android 浏览器中运行良好。但是，PhoneGap 容器中的同一个应用程序会导致挤压和展开动画，而不是透视 3D 旋转。有没有办法让它在 PhoneGap 中运行，或者它是否使用无法进行 3D 转换的不同渲染引擎？

我用

```
-webkit-perspective: 300; 
```

在父母和

```
-webkit-transform: rotate3d(0, 1, 0, -180deg);
-webkit-transform-style: preserve-3d; 
```

在旋转的图像上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-09T13:43:04.787

该`perspective`属性采用长度值，因此它应该始终具有单位。如果未给出单位，某些浏览器可能会将像素推断为单位，但您应始终指定。另请注意，较大的透视值会导致较不引人注目的透视效果。

还要确保添加属性的无前缀版本。这应该出现在前缀版本之后，正如 Tim Nguyen 所说，随着浏览器不再需要前缀，这将使您的应用程序面向未来。

顺便说一句，`transform-style: preserve-3d;`应该将其分配给其子元素在 3d 空间中被转换的元素，因此它在这里并没有真正做任何事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-04T19:12:14.963

也许 phonegap 没有`-webkit-`前缀就可以工作。

您应该始终考虑为您的代码包含无前缀属性以防万一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-15T00:02:03.140

我对 PhoneGap 场景比较陌生，但从我的阅读中记得，Android 在 3D 转换上会窒息，但这可能只是在 jQM 中，它经常在 PhoneGap 实现中使用。我看到您更多地谈论 css，但我想知道您遇到的问题是否与 jQM 开发人员遇到的问题有关。

[PhoneGap Android 上的 JqueryMobile 过渡](https://stackoverflow.com/questions/8600403/jquerymobile-transitions-on-phonegap-android)

# php - 为什么我不能使用 PHP 将我的 24 小时时间转换为上午/下午 12 小时时间？

> ID：12846927
> 
> 赞同：0
> 
> 时间：2012-10-11T19:18:11.533
> 
> 标签：php, mysql, codeigniter, time, unix-timestamp

我正在使用 Codeigniter，但我遇到了一个问题，即我的 MySQL 表中的 24 小时时间列被 ActiveRecord 提取，并且只是拒绝转换为正确的上午/下午时间。

在我的数据库表中，我将时间存储为 22:00:00（晚上 10:00）。当我从数据库中提取值时，原始 Unix 时间似乎是 1349960400（这本身似乎不正确），当我通过 date & strttotime 函数运行它时，它显示为下午 22:00。

这就是我的代码的样子：

```
function get_events_by_day($year, $month, $day)
{           
    $events = array();
    $query = $this->db->select('*')
                        ->from('calendar_events')
                        ->where('EventDate', "$year-$month-$day", 'after')
                        ->get();

    $events = $query->result(); 

    foreach($events as $event)
    {
        debug($event->EventStartTime); // prints 1349960400
        debug(strtotime($event->EventStartTime)); // prints 22:00
        $event->EventStartTime = date("H:i A", strtotime($event->EventStartTime));
        $event->EventEndTime = date("H:i A", strtotime($event->EventEndTime));
        debug($event->EventEndTime); // prints 22:00 PM
    }           

    return $events;
} 
```

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-11T19:21:56.357

```
date("h:i A", strtotime($event->EventEndTime)); 
```

应该解决。H 是`24 h`, h = `12h`.

# java - 在 WritableRaster 中设置值时坐标超出范围

> ID：12846929
> 
> 赞同：0
> 
> 时间：2012-10-11T19:18:17.233
> 
> 标签：java, image-processing, indexoutofboundsexception

我正在做一个关于中值滤波器的程序。我想要完成的只是获取一个像素值，找到它的相邻像素，并将它们存储在一个数组中，对该数组进行排序，然后取中间值（对于大小为 9 的数组，中间值是索引位置 4）。并将该值替换为与所考虑的像素完全相同的坐标。

如果我删除其内容并仅打印`i,j,x,y`. 在我添加我做的语句的那一刻，我`neighborhoodVal.add(imageRaster.getSample(x, y, 0));`得到了一个`java.lang.ArrayIndexOutOfBoundsException: Coordinate out of bounds!`错误。

根据我的观察，我发现当值`j`变为`1`时`i`变为值`264`，这很奇怪，因为我只循环图像内的所有像素，外部两个循环（i 和 j）循环除边缘之外的所有像素的图像。内部循环 ( `x`& ) 循环遍历第 th 个像素`y`的所有 8 个邻居。`[i][j]`

我使用的图像有`width = 265`和`height=269`。代码如下：

```
public class MedianFilter {

    public static void main(String[] args) throws IOException {

        int i, j, x, y;
        ArrayList<Integer> neighborhoodVal = new ArrayList<Integer>();
        ;
        String imagePath = "images/assignment10/noisyShapes.jpg";
        BufferedImage inputImage = convertToGrayScale(ImageIO.read(new File(
                imagePath)));
        WritableRaster imageRaster = inputImage.getRaster();
        BufferedImage filteredImage = new BufferedImage(inputImage.getWidth(),
                inputImage.getHeight(), BufferedImage.TYPE_BYTE_GRAY);
        WritableRaster newWRaster = filteredImage.getRaster();

        for (i = 1; i < imageRaster.getHeight()-1; i++) {
            for (j = 1; j < imageRaster.getWidth()-1; j++) {
                for (x = Math.max(0, i - 1); x <= Math.min(i + 1,imageRaster.getWidth()); x++) {
                    for (y = Math.max(0, j - 1); y <= Math.min(j + 1,imageRaster.getHeight()); y++) {

                        System.out.println(i+","+j+"------->"+x+","+y);

                        neighborhoodVal.add(imageRaster.getSample(x, y, 0));
                        Collections.sort(neighborhoodVal);
                    }
                }
                newWRaster.setSample(i, j, 0, (neighborhoodVal
                                .get((neighborhoodVal.size() / 2) + 1)));
                neighborhoodVal.clear();
            }

        }

        File f = new File("images/assignment10/medianFilterOutput.jpg");
        ImageIO.write(filteredImage, "JPG", f);

    }
    public static BufferedImage convertToGrayScale(BufferedImage givenImage)
            throws IOException {
        // TODO Auto-generated method stub
        BufferedImage image = new BufferedImage(givenImage.getWidth(),
                givenImage.getHeight(), BufferedImage.TYPE_BYTE_GRAY);
        Graphics grp = image.getGraphics();
        grp.drawImage(givenImage, 0, 0, null);
        return image;
    }
} 
```

我正在使用这张图片：

![在此处输入图像描述](../Images/788db691b8b525d305c7c2730422fb54.png)

怎么`j`变成1了？我在哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T04:23:01.473

在外部循环中，您将“i”与 .getHeight() 一起使用，但在内部循环中，“x”与 .getWidth() 一起使用。所以看起来 i 和 j 的边界需要交换。这可能是因为疲倦而打错了；我可能会在下面的示例代码中自己做。

此外，由于外部循环已经忽略了边界像素，因此内部循环可能只是 "for(x = i - 1; i <= i + 1; i++" 和 "for(y = j - 1; y <= j + 1; j++)" 并保证在范围内。

如果我可以提出建议：在图像处理中，通常在最外层循环中逐行（即按“y”）扫描，然后按 x，并且还使用 (x,y) 作为像素坐标和 ( i,j) 用于偏移量。例如：

```
int r = 1;  //radius, in case you want to use median over a larger kernel

for(int y = r; y < height - r; y++)
{
   for (int x = r; x < width - r; x++)
   {
      for(int j = y - r; j <= y + r; j++)
      {
         for(i = x - r; i <= x + r; i++)
         {
            //get all neighborhood values 
         } 
      }    

      //find median
   }
} 
```

也就是说，一旦你使用了约定，就坚持下去。意外交换 getWidth() 和 getHeight() 边界很容易，但如果你总是以 y,x,j,i 的相同顺序嵌套循环，你将更有可能在不考虑的情况下键入正确的边界.

# php - wordpress 重定向不起作用

> ID：12846930
> 
> 赞同：0
> 
> 时间：2012-10-11T19:18:30.103
> 
> 标签：php, wordpress, custom-url

```
 add_filter('query_vars', 'add_query_vars');

function add_rewrite_rules($aRules) {
    $aNewRules = array('societies/([^/]+)/?$' => 'index.php?pagename=societies&sid=$matches[1]');
    $aRules = $aNewRules + $aRules;
    return $aRules;
}

add_filter('rewrite_rules_array', 'add_rewrite_rules');

function add_query_vars($aVars) {
    $aVars[] = "page_id";    // represents the name of the variable as shown in the URL
    return $aVars;
}

add_filter('query_vars', 'add_query_vars'); 
```

所以我试图在重定向上使用自定义 get 变量。目前，我有一个重定向，可将您带到我网站的某个部分：例如 zzz.net/dashboard?page_id=2278，但我得到一个 404 页面无法显示，所以我添加了此代码。主要问题是我真的不知道我在做什么。

我希望在重定向时使用 ?page_id=2278 等的原因是，我可以在用户到达仪表板页面之前知道他们来自哪里。

建议和指导可能比仅仅回答更有帮助。无论哪种方式，感谢您花一点时间来查看它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T21:05:20.940

Wordpress 核心在查询任何页面对象时使用名为“page_id”的 GET 变量。

相反，如果您将查询更改为“p=2786”，那么 Wordpress 将尝试搜索 ID 为 2786 的帖子。

通过在您的 URL 中包含该变量，Wordpress 会感到困惑，并试图返回一个页面，该页面的 ID 由您的 GET 请求定义。为了防止这样的命名冲突，最好为全局范围内可访问的任何命名变量添加前缀。

将 GET 变量的名称更改为其他名称（即：WJ_page_id），以确保您不会与任何主要的 Wordpress 变量发生冲突。

# size - 在 Windows Server 2003 上设置文件夹大小限制 - 可以吗？

> ID：12846931
> 
> 赞同：1
> 
> 时间：2012-10-11T19:18:31.677
> 
> 标签：size, directory, limit, windows-server-2003

我在家里有一个基于 Apache、MySQL、hMailServer 等的共享虚拟主机服务器。是否可以将我的用户的 htdocs 目录限制为某个数量。国标？如果是，我该如何实现？谢谢！

# linux - WGET 或 cURL 获取受保护的文件

> ID：12846933
> 
> 赞同：0
> 
> 时间：2012-10-11T19:18:34.283
> 
> 标签：linux, bash, curl, wget

哪个是从远程网络服务器下载文件的最佳途径？我想使用 .htaccess 拒绝所有下载，除非通过了特定的用户代理。这必须通过 cURL 完成还是 WGET 也可以这样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T19:20:51.693

[http://www.gnu.org/software/wget/manual/wget.html](http://www.gnu.org/software/wget/manual/wget.html)

> '-U agent-string' '--user-agent=agent-string' 标识为 http 服务器的代理字符串。http 协议允许客户端使用 User-Agent 标头字段来标识自己。这可以区分 www 软件，通常用于统计目的或跟踪协议违规。Wget 通常标识为“Wget/version”，version 是 Wget 的当前版本号。
> 
> 但是，众所周知，某些站点会根据用户代理提供的信息实施定制输出的策略。虽然这在理论上并不是一个坏主意，但它已被服务器滥用，拒绝向（历史上）Netscape 或更常见的 Microsoft Internet Explorer 以外的客户端提供信息。此选项允许您更改 Wget 发出的 User-Agent 行。不鼓励使用此选项，除非您真的知道自己在做什么。
> 
> 使用 '--user-agent=""' 指定空用户代理会指示 Wget 不要在 http 请求中发送 User-Agent 标头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-26T18:42:15.193

另外，为了记录，来自`man curl(1)`：

```
 -A, --user-agent <agent string>
          (HTTP) Specify the User-Agent string to send to the HTTP server.
          Some  badly  done  CGIs  fail  if  this  field  isn't   set   to
          "Mozilla/4.0".  To  encode  blanks  in  the string, surround the
          string with single quote marks. This can also be  set  with  the
          -H, --header option of course.

          If this option is used several times, the last one will be used. 
```

# php - 玩弄带有数字字符串键的数组

> ID：12846936
> 
> 赞同：1
> 
> 时间：2012-10-11T19:19:10.993
> 
> 标签：php, arrays

要了解我为什么要问这个问题，请阅读[此](https://stackoverflow.com/a/12832680/370483)内容及其下方的评论。考虑以下代码：

```
$obj = new stdClass;
$obj->{10} = 'Thing';

$objArray = (array) $obj;
var_dump($objArray); 
```

产生：

```
array(1) {
  ["10"]=>
  string(5) "Thing"
} 
```

现在，我无法访问它，`$objArray['10']`因为 PHP 将数字字符串键转换为整数键。该手册在将数组转换为对象时明确指出“整数属性不可访问”。还是他们？

为了证明文档是错误的，我创建了一个类：

```
class strKey implements ArrayAccess
{
    private $arr;
    public function __construct(&$array)
    {
        $this->arr = &$array;
    }

    public function offsetExists($offset)
    {
        foreach ($this->arr as $key => $value)
        {
            if ($key == $offset)
            {
                return true;
            }
        }
        return false;
    }

    public function offsetGet($offset)
    {
        foreach ($this->arr as $key => $value)
        {
            if ($key == $offset)
            {
                return $value;
            }
        }
        return null;
    }

    public function offsetSet($offset, $value)
    {
        foreach($this->arr as $key => &$thevalue)
        {
            if ($key == $offset)
            {
                $thevalue = $value;
                return;
            }
        }

        // if $offset is *not* present...
        if ($offset === null)
        {
            $this->arr[] = $value;
        }
        else
        {
            // this won't work with string keys
            $this->arr[$offset] = $value;
        }
    }

    // can't implement this
    public function offsetUnset($offset)
    {
        foreach ($this->arr as $key => &$value)
        {
            if ($key == $offset)
            {
                //$value = null;
            }
        }
    }
} 
```

现在，我可以做[（演示）](http://codepad.org/7oxYrB9j)：

```
$b = new strKey($objArray);

echo $b['10']; // Thing
$b['10'] = 'Something else';

// because the classes works with a reference to the original array,
// this will give us a modified array:
var_dump($objArray); 
```

最后一个难题是，如何取消设置键为数字字符串的元素？我尝试使用`ArrayIterator`, `key()`,`next()`等，但它不起作用。我找不到解除这些的方法。

任何解决方案都应该使用原始数组，而不是创建副本并替换原始数组。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T19:34:09.793

`array_splice()`如果您知道它的偏移量 ( )，您可以尝试使用 删除它`foreach (...) { $offset++; ... }`，但是将数据存储在这样的数组中确实不是一个好主意。您应该使用 foreach 将这些对象转换为数组：

```
foreach ( $obj as $key => $value )
    $array[$key] = $value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:58:46.343

按照 pozs 的建议，结果如下`offsetUnset()`。我还添加了一个`offsetSet()`支持添加数字键的新功能。

```
public function offsetUnset($offset)
{
    $off = 0;

    foreach ($this->arr as $key => $value)
    {
        if ($key === $offset)
        {
            array_splice($this->arr, $off, 1);
            return;
        }
        $off++;
    }       
}

public function offsetSet($offset, $value)
{
    foreach($this->arr as $key => &$thevalue)
    {
        if ($key === $offset)
        {
            $thevalue = $value;
            return;
        }
    }

    // if $offset is *not* present...
    if ($offset === null)
    {
        $this->arr[] = $value;
    }
    // it's a numeric string key, now we have to hack it
    else if (strval(intval($offset)) === $offset)
    {
        // create new array via loophole:
        $tempObj = new stdClass;
        $tempObj->{$offset} = $value;

        // append to old array (+= doesn't create copies)
        $this->arr += (array) $tempObj;
        unset($tempObj);
    }
    // we are dealing with a normal key
    else
    {
        $this->arr[$offset] = $value;
    }
} 
```

我已经正式击败了 PHP。耶！

# php - 按日期而不是日期排序。PHP 或 PHPUnit

> ID：12846937
> 
> 赞同：0
> 
> 时间：2012-10-11T19:19:11.867
> 
> 标签：php

$dates = array(下面的日期);

我将如何按月、日、年对这个数组进行排序，然后按如下所示的时间戳排序？

```
Array (
0 => 'Thu Aug 30 2012 14:38:13 GMT-0700 (PDT)',
1 => 'Thu Aug 30 2012 14:53:13 GMT-0700 (PDT)',
2 => 'Thu Aug 30 2012 14:57:42 GMT-0700 (PDT)',
3 => 'Thu Aug 30 2012 14:58:34 GMT-0700 (PDT)',
4 => 'Thu Aug 30 2012 14:59:21 GMT-0700 (PDT)',
5 => 'Thu Aug 30 2012 15:00:11 GMT-0700 (PDT)',
6 => 'Thu Aug 30 2012 15:01:25 GMT-0700 (PDT)',
7 => 'Thu Aug 30 2012 15:03:15 GMT-0700 (PDT)',
8 => 'Thu Aug 30 2012 15:05:56 GMT-0700 (PDT)',
9 => 'Thu Aug 30 2012 15:06:50 GMT-0700 (PDT)',
10 => 'Thu Aug 30 2012 15:09:06 GMT-0700 (PDT)',
11 => 'Thu Aug 30 2012 15:11:32 GMT-0700 (PDT)',
12 => 'Thu Aug 30 2012 15:20:26 GMT-0700 (PDT)',
13 => 'Thu Aug 30 2012 15:21:12 GMT-0700 (PDT)',
14 => 'Thu Aug 30 2012 15:22:00 GMT-0700 (PDT)',
15 => 'Thu Aug 30 2012 15:22:58 GMT-0700 (PDT)',
16 => 'Thu Aug 30 2012 15:24:34 GMT-0700 (PDT)',
17 => 'Thu Aug 30 2012 15:25:35 GMT-0700 (PDT)',
18 => 'Thu Aug 30 2012 15:26:48 GMT-0700 (PDT)',
19 => 'Wed Sep 19 2012 09:42:57 GMT-0700 (PDT)',
20 => 'Fri Oct 05 2012 10:11:28 GMT-0700 (PDT)',
21 => 'Wed Oct 10 2012 11:27:15 GMT-0700 (PDT)',
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:24:26.250

strtotime() 将每个时间转换为 unix 时间戳，然后 date('Ymd H:i:s') 按日期排序

例如：

```
$unix =  strtotime('Thu Aug 30 2012 14:38:13 GMT-0700 (PDT)');

echo date('Y-m-d H:i:s', $unix); 
```

将输出：

```
2012-10-11 15:25:42 
```

你可以排序

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:25:14.660

可能有更好的解决方案，但这应该有效：

```
foreach ($dates as $value) {
    $newDates[strtotime($value)] = $value;
}

$newDates = ksort($newDates); 
```

这将使新数组`$newDates`具有时间戳的键并按键排序。这将以您已有的格式维护数组的值。如果您想更改格式，可以执行以下操作：

```
$newDates[strtotime($value)) = date("Y-m-d H:i:s", strtotime($value)); // 2012-11-10 12:27:00 
```

# oop - 深度继承层次结构的替代方案？

> ID：12846939
> 
> 赞同：6
> 
> 时间：2012-10-11T19:19:25.807
> 
> 标签：oop, inheritance, orm, language-agnostic, domain-driven-design

我正在尝试对具有一组综合属性的产品进行建模。通常，在线商店会使用文本描述来列出特定产品的属性。然而，这个解决方案不是最优的。

例如，以下链接显示同一产品的文本描述中的属性不一致，但制造商不同：

*   [微星 GTX690](http://www.landmarkpc.co.za/store/gtx690-n690gtxp3d4gd5-nvidia-geforce-p-8883.html)
*   [技嘉GTX690](http://www.landmarkpc.co.za/store/gigabyte-gtx690-gvn690d54gdb-nvidia-geforce-p-8498.html)
*   [华硕 GTX690](http://www.landmarkpc.co.za/store/asus-gtx690-gtx6904gd5-nvidia-geforce-p-8564.html)

因此，我选择了如下继承层次结构：

`Product`> `Component`> `GraphicsCard`>`NvidiaGraphicsCard`

这样做的原因是因为我希望对每个`Product`. 这允许我包含特定于 a 的属性`NvidiaGraphicsCard`，但不适用于 a `ATiGraphicsCard`。

`OrderItem`请注意，除了向子类添加更多字段外，继承还允许我在持有对 a 的引用方面利用多态性`Product`。这就是我排除作曲的原因。

拥有如此深的继承层次是否有问题，如果有，是否有任何解决方案或模式来处理这个问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-13T21:07:47.970

由于几个原因，在 DDD 和 ORM 的上下文中，深层继承层次结构存在问题。当您尝试定义实体的身份时，就会出现一个问题。A`Product`必须基于身份与其他产品进行比较，无论要比较哪个子类。可以在`Product`类中提供此功能，但必须注意确保子类也可以进行比较，并且存在一些问题。例如，NHibernate 将为类生成一个代理，因此对象的实际运行时类型将不是`NvidiaGraphicsCard`从它继承的代理。虽然临时实例`NvidiaGraphicsCard`不会成为代理。这意味着您无法根据类型比较它们。

另一个困难是配置 ORM 映射以支持继承。虽然大多数 ORM 都允许这样做，但生成的映射和生成的 SQL 通常很复杂。您是否将所有子类存储在一个表中？在具有通用产品表外键的多个表中？在前者中，您最终会得到一张巨大的桌子。在后一种情况下，您的查询将受到影响，因为所有子类表都需要连接。关系模型和对象模型之间存在太多的阻抗不匹配。事件如果使用文档数据库，最好支持组合而不是继承。

Instead, I would go for having a single `Product` class, which can be composed of either product specific descriptors, or a dictionary of attributes. This would an `OrderItem` to reference a `Product` without knowing the specific product type - no need for polymorphism. This would also make it easier to allow for new types of products - no need to create a new sub-class.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T19:25:07.283

这是一个关于继承的教科书示例，一个很好的例子。我认为这种模型没有任何问题，只是在关系数据库中保存它会很困难。

另一方面，有时一组属性仅与无法通过单一继承表示的项目子集相关。例如`PowerConsumption`，描述给定产品需要多少功率与鼠标和 USB 记忆棒无关。对于某些组件，重量也不是很重要。这意味着您可能会研究具有特征的语言，例如 Scala，以使您的模型尽可能 DRY。

请注意，深度继承没有性能损失——更长的继承链并不意味着更慢的虚拟方法调用（好吧，你不会经常使用虚拟调用，因为它们只是数据容器）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T19:34:25.167

我建议您查看装饰器模式。这样，您将拥有所需的任何技巧和不到十亿的课程。

# php - PHP - 如何编写正则表达式来检查字符串是否仅包含某些字符？

> ID：12846942
> 
> 赞同：1
> 
> 时间：2012-10-11T19:19:28.340
> 
> 标签：php, regex, string

我几乎没有编写正则表达式的经验。我将如何检查字符串是否只包含零、空格、连字符和冒号？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T19:22:18.743

您应该使用简单的正则表达式（无前向查找）获得良好的性能：

```
^[0 :-]++$ 
```

分解它：

*   `^`识别输入的开头
*   `[]`表示括号内的*任何*字符都匹配。
*   `+`表示前面的（括号）必须匹配 1 次或多次。`++`使其[占有](http://www.regular-expressions.info/possessive.html)，提高性能。
*   `$`识别输入的结尾

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T19:22:21.773

```
/^[0\s:-]+$/ 
```

*   `^`= 字符串开头
*   `[0\s:-]+`= 一个或多个零、空格、连字符、冒号。`+`表示*一个或多个*,是任何空白字符，`\s`可能包括换行符和制表符。
*   `$`= 字符串结尾

由于模式锚定在 和 之间`^`，`$`因此除了`[]`字符类中的字符之外，不会匹配其他字符。

如果您只允许文字空间而不是任何空白字符，请使用：

```
/^[0 :-]+$/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T19:21:10.413

您可以使用范围。

```
^[0 \-:]{1,}$ 
```

# cpu - 下一行预测分支目标预测器如何工作？

> ID：12846945
> 
> 赞同：1
> 
> 时间：2012-10-11T19:19:45.453
> 
> 标签：cpu

在问题[为什么处理排序数组比处理未排序数组更快？](https://stackoverflow.com/questions/11227809/)答案与分支预测对随机顺序数据不好而对排序数据很好有关。但问题是数据是一样的，只是顺序不同。

这让我很困惑，我几乎假设预测是编译的。它要么总是假设为真，要么总是假设为假，但显然它是动态的。既然它是动态的，它怎么知道要预测哪个？某处的缓存中是否有关于它的数据？听说有代码执行缓存和内存缓存，cpu缓存里有数据吗？只有L1吗？

分支预测究竟是如何调整它的预测的，它的数据在哪里来做出这个动态决策呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-02-23T17:54:58.020

您要问的问题是关于分支目标预测的，但这在这个特定示例中并没有发挥作用。这里唯一的区别是分支是否被采用。

这种情况下的代码归结为：

```
if (data[c] >= 128)
  sum += data; 
```

在一个循环中，所以在汇编中它看起来像：

```
cmp rsi, 128
jl loop ;this is the one being predicted
add eax, rsi
j loop 
```

在跳转小于中，分支预测器必须猜测是再次进入循环的开头还是失败。如果它做对了，代码将运行得更快，因为指令队列将得到很好的馈送，而不会在管道中出现气泡或停顿。

按照天气预报的原则（明天的天气和今天差不多），如果CPU能记住上次走哪条路，那就更快了。您可以将其视为存储在 CPU 实现中的单个布尔值，该值记录上次是否如此，并再次猜测相同。每次跳转（或不跳转）后，该值将更新以供下次使用。

如果你有一个 (eg) 的模式，`aaaaAAAA`并且你正在迭代它是否是资本，如果你使用这个简单的预测，那么除了`aA`转换之外，你一直都是对的。如果数据是，`aAaAaAaA`那么您将一直是错误的。

因此，数据的模式导致采取/未采取的记录要么接近发生的事情，要么没有发生的事情。在这种情况下，如果您对数据进行排序，那么所有小值都将位于数据的开头，因此分支预测器将在正确预测方面取得成功。如果您有随机数据，那么分支预测器将不太有用。

现代分支预测器要复杂得多。所以这是一个简单的观点。但是，如果您认为分支预测状态是作为分支预测器逻辑的一部分保存在存储单元中的单个布尔值，它可能是有意义的。

# deployment - WebSphere 8 是否有类似于 Tomcat Valves 的请求拦截功能（不是应用内 Servlet 过滤器..）？

> ID：12846952
> 
> 赞同：2
> 
> 时间：2012-10-11T19:20:12.757
> 
> 标签：deployment, websphere, jaas, websphere-8

我必须将通常部署在 Tomcat 或 Jetty 上的现有应用程序配置到 WebSphere Application Server v8 上。我遇到的主要问题是，在将要部署它的环境中，它需要通过 JAAS 处理身份验证/授权。不幸的是，该应用程序使用自制的身份验证系统，并且与 JAAS 或 WebSphere 的 JAAS 实现不兼容。

到目前为止，为了提供一个允许应用程序在 WebSphere 上和谐运行的 shim，我一直在尝试编写一个 WebSphere 信任关联拦截器来从 websphere 的接口中提取一个主题（通过调用`com.ibm.websphere.security.auth.WSSubject.getCallerSubject()`）并将其放入HttpServletRequest 在正常操作过程中，我的 webapp 将提取添加的属性供我们使用。但这似乎……很棘手。它看起来非常有目的，似乎我们不能将它用于这种类型的操作。

理想情况下，我想远离应用内过滤器，因为我想尽可能地将 IBM 特定的代码排除在应用之外。

这里有人有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-01-18T21:12:45.093

一种可能的解决方案是使用位于应用程序外部的过滤器，类似于以下示例：

[https://www-03.ibm.com/support/techdocs/atsmastr.nsf/WebIndex/WP101859](https://www-03.ibm.com/support/techdocs/atsmastr.nsf/WebIndex/WP101859)

这仍然是过滤器链的一部分，其功能与任何其他过滤器相同，但代码不会成为应用程序的一部分。它将驻留在一个单独的 jar 文件中。

# flash - .swf 嵌入时会变得粗大

> ID：12846960
> 
> 赞同：0
> 
> 时间：2012-10-11T19:20:55.317
> 
> 标签：flash

我有一个客户将动画从 After Effects 导出到 swf。该文件大约为 180k，看起来非常清晰。但是，当我将它嵌入到一个 html 页面中时，它会显得很笨重。[你可以在这里](http://camandbenny.com/flash/)看到一个测试。任何闪存专家有什么想法吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:13:47.247

```
object {
        height: 100%;
        width: auto;
        } 
```

我以为我可以做出反应……但这似乎是罪魁祸首。

# ruby - 使用带有数据映射器的正则表达式

> ID：12846961
> 
> 赞同：0
> 
> 时间：2012-10-11T19:20:57.663
> 
> 标签：ruby, regex, datamapper

是否可以使用带有 DataMapper“.like”条件语法的正则表达式？

例如，我只想查找爱好以字符串“skating”开头的用户。

正则表达式看起来像这样：

^滑冰

目前，我只能找到所有爱好包含“滑冰”一词的用户，因此返回的记录比我想要的要多。

```
>> User.all(:hobby.like => "%skating%")

# 我得到了什么

+--------------+---------------+------------------ +----------+
| 登录 | 名字 | 姓氏 | 爱好 |
+--------------+---------------+------------------ +----------+
| 杰斐逊 | 汤姆 | 杰斐逊 | 滑冰 |
| 亚当斯 | 约翰 | 亚当斯 | 滑冰 |
| 华盛顿| 乔治 | 华盛顿 | 速滑 |
+--------------+---------------+------------------ +----------+

# 我想得到什么

+--------------+---------------+------------------ +----------+
| 登录 | 名字 | 姓氏 | 爱好 |
+--------------+---------------+------------------ +----------+
| 杰斐逊 | 汤姆 | 杰斐逊 | 滑冰 |
| 亚当斯 | 约翰 | 亚当斯 | 滑冰 |
+--------------+---------------+------------------ +----------+

>> User.all(:hobby.like => "%^skating%")

# 没有结果

```

感谢您的任何反馈！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:34:01.287

怎么样 ：

```
 User.all(:hobby.like => "skating%") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-21T04:03:27.670

Datamapper 确实允许您在使用 和 查找记录时通过其属性使用正则表达式`:conditions`查询mysql 。`:all``:first``:last`

请参阅标有“兼容性”的部分：http: [//datamapper.org/docs/find.html](http://datamapper.org/docs/find.html)

例如，这有效（我已经测试和验证）：

```
User.all(:conditions => ['hobby REGEXP ?', '^skating']) 
```

这相当于 MySQL：

```
SELECT * FROM `user` WHERE (hobby REGEXP '^skating'); 
```

在上面的 Datamapper 示例中，`REGEXP`指的是 MySQL 对正则表达式的支持：

[https://dev.mysql.com/doc/refman/5.7/en/regexp.html#operator_regexp](https://dev.mysql.com/doc/refman/5.7/en/regexp.html#operator_regexp)

而且，为了清楚起见，上面 Datamapper 示例中的问号有助于避免错误和 SQL 注入。

# winforms - 通过设计器添加控件时，visual studio 2010 'System.BadImageFormatException'

> ID：12846964
> 
> 赞同：2
> 
> 时间：2012-10-11T19:21:04.690
> 
> 标签：winforms, visual-studio-2010, visual-c++, clr

我在 Visual Studio 2010 Ultimate 中工作，在向我的 Windows 窗体添加某些控件时遇到问题。我在同一个解决方案中有两个项目，PeakEstimator 和 PeakEstimatorUI。PeakEstimatorUI（我的 GUI）依赖于 PeakEstimator（我的后端），并且一切都可以使用我目前拥有的表单和控件按预期编译和运行。

但是，当我尝试添加某些控件时，我现在遇到了问题。文本框、按钮、标签、OpenFileDialog 控件和许多其他东西都可以正常工作，但是当我尝试添加图表、LineShape、OvalShape、ReportViewer、ElementHost 等时，我收到以下错误：

> 未能创建组件“组件名称”。错误消息如下：'System.BadImageFormatException：尝试加载格式不正确的程序。（来自 HRESULT 的异常：0x8007000B）'

我一直在寻找类似的问题，我见过的大多数线程都在谈论 x86 与 x64 问题，但我的印象是使用 clr 会为我处理这些事情。也许我在那里有一个根本的误解。

如果我创建一个新的 Windows 窗体项目，我遇到的所有控件似乎都可以正常工作，所以我认为它一定与我的项目配置有关。有任何想法吗？

这是我第一次开发任何类型的严肃的 GUI 或使用 Visual Studio，这是我很长时间以来第一次在 Windows 中编程，所以请像我 5 岁一样解释它。

谢谢你的时间，

戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:59:06.390

当您尝试将 32 位 DLL 加载到 64 位应用程序时，这通常是一个错误。在您的环境中可能吗？

如果您有外部依赖项并且只有 .DLL 文件，则可以使用 Visual Studio 命令提示符查看它是否为 32 位：`corflags myReference.dll`. 你正在寻找`32BIT`国旗。如果它是您可以控制的，请检查项目/解决方案以确保它被设置为构建`AnyCPU`而不是`x86`（注意：如果它执行 COM 互操作或使用另一个 32 位程序集，则可能需要 x86）。

如果您在 64 位机器上并且有一个设置为 AnyCPU 构建配置的解决方案并尝试随后加载 32 位程序集，则会引发此异常。您可以将解决方案更改为为 x86 构建，这应该可以解决问题。

更多资源：

*   [http://support.dtsearch.com/dts0223.htm](http://support.dtsearch.com/dts0223.htm)
*   [http://msdn.microsoft.com/en-us/library/system.badimageformatexception.aspx](http://msdn.microsoft.com/en-us/library/system.badimageformatexception.aspx)（如果您搜索“64 位”，您会发现这是原因之一）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:02:17.027

抱歉，我最初的答案是针对 C#。

对于 C++，您需要查看 /CLRIMAGETYPE。这是 MSDN，它解释了它的工作原理以及在 VS2010 中的设置位置：

[http://msdn.microsoft.com/en-us/library/31zwwc39(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/31zwwc39%28v=vs.100%29.aspx)

这是属性页面的屏幕截图。我不确定要更改为哪个值，但您可以尝试看看什么对您有用。

![在此处输入图像描述](../Images/87a91efcf146bf6f3747168b866dbcf5.png)

# graphics - 在计算机图形练习中找到相机位置？

> ID：12846968
> 
> 赞同：1
> 
> 时间：2012-10-11T19:21:16.373
> 
> 标签：graphics, camera, position

假设我们有一个如下图所示的对象，其底面为 2x3 单位，高度为 2 单位。如果我们假设我们使用透视投影，那么相机的参数应该是什么才能得到下图？

[链接到这里的图片](http://i1310.photobucket.com/albums/s655/androsland/Untitled_zpsd834433a.png)

# netbeans - 如何在 netbeans 7.2 中从右到左书写语言

> ID：12846972
> 
> 赞同：1
> 
> 时间：2012-10-11T19:21:26.310
> 
> 标签：netbeans, netbeans-7

![我的问题](../Images/a7a383ec27c667ea9d58e38a9cd39a27.png)

我对netbeans 7.2有问题，

我的语言从右到左。请帮我纠正这个问题。

因为照片显示的 html 代码显示不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T11:52:21.250

通过更改 NetBeans 主题（工具 > 选项 -> 字体和颜色 -> 配置文件）解决了我的问题。

感谢 NetBeans 提供了非常好的应用程序。

# javascript - 使用 jquery 遍历 html 表行以获取单元格内的 div id

> ID：12846973
> 
> 赞同：0
> 
> 时间：2012-10-11T19:21:28.847
> 
> 标签：javascript, jquery, html, css

我想遍历表 id="myTable" 中每一行中的每个单元格并获取单元格子 div 的 id。

到目前为止，我有类似的东西：

```
$("td.theCell").each(function() {
  var id = $(this).attr('id'); //this would give me the td id but I want its child div's id
}); 
```

我的 html 是这样的：

```
<table id='myTable'>
  <tr>foo</tr>
  <tr>bar</tr>
    <td>foo</td>
    <td class='theCell'>
      <div id='myDiv'>foo</div>
    </td>
  <tr>foo</tr>
  <tr>bar</tr>
</table> 
```

有人知道这样做的好方法吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:22:24.133

试试这个

```
$("td.theCell").each(function() {
  var id = $(this).find('div').attr('id'); 
}); 
```

您需要正确获取 div 的**ID**而不是 td.thecell 元素。所以你需要使用`.find()`来选择里面的潜水..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-11T19:24:53.737

将所有 div id 保存在一个数组中。使用`.each` [jsfiddle](http://jsfiddle.net/jWdZd/)

```
var dividlist = [];
$("td.theCell div").each(function() {
     dividlist.push(this.id);
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-11T19:25:12.400

您也可以不使用 find 直接选择子 div：

```
$("td.theCell div").each(function() {    
      var id = this.id
});​ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-11T19:22:23.143

使用[find](http://api.jquery.com/find/)获取后代 div ：

```
$("td.theCell").each(function() {
  var id = $(this).find('div').attr('id'); 
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-11T19:28:13.827

您可以通过选择器中的小改动来做到这一点

```
$("#myTable tr > td.theCell > div").each(function() {//you can remove the '>' if you don't just want the direct children only 
  var k = $(this).attr('id'); 
  console.log(k);
});​ 
```

# jquery - 通过 AJAX 从 VB.NET WebMethod 将 Excel 导出为二进制文件？

> ID：12846980
> 
> 赞同：0
> 
> 时间：2012-10-11T19:21:49.553
> 
> 标签：jquery, ajax, export-to-excel, webmethod

我可以很容易地在 WebMethod 中制作 excel 文件，但是 WebMethod 函数应该能够将文件发送到客户端吗？

我想 jQuery .get（或任何需要的）来自 WebMethod 的文件，但我不知道该函数应该如何导出。

寻找“作为二进制”，但没有看到类似的东西。

我的网站是 jQuery/AJAX/.NET WebMethod，我想避免使用服务器端脚本。如果有比我尝试做的更好的方法，请提出建议。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T19:26:20.043

Ajax 更多的是用于从服务器获取 json 或 xml 数据，创建文件后将文件保存在服务器上可能更容易，然后在客户端给他们文件的链接供他们下载

# c++ - C++ 模块设计在提案 N2073 的情况下和作为一个整体

> ID：12846993
> 
> 赞同：0
> 
> 时间：2012-10-11T19:22:28.230
> 
> 标签：c++, module, standards

总是有一些关于 C++ 模块的讨论。但是昨天（就在昨天让我感到羞耻）我遇到了这个带有 c++ 模块提案链接的[线程。](https://stackoverflow.com/questions/3596147/modules-in-c11)

就像“男孩哦男孩！终于会有一些关于实现或设计以及一些有趣的想法......”

在那一刻，我必须请求原谅我进一步的愤怒......

我已经读了两遍了。

正如作者所说，有以下好处：

• 显着缩短大型项目的构建时间（Olalal 我虽然在那里！那将是真棒......）

• 更好地分离接口和实现

• 为现有图书馆提供可行的过渡路径

• 屏蔽宏观干扰

• 屏蔽私人成员

• 改进的初始化顺序保证

• 避免未诊断的 ODR 问题

• 全局优化属性（异常、副作用、别名泄漏……）

还有一些人提到了algon的文字。

（再次为愤怒的语气道歉）

嗯...老实说，我并不真正关心他的导入/导出技巧如何（混淆与否都没关系），不关心可见性，隐藏等我不关心某些事情，例如在 java 和其他一些中确实存在的静态 init 块。

但是主要目标，模块的核心应该是编译速度，这里提到：

• 显着缩短大型项目的构建时间

所有那些没有提高编译速度的动作都是无用的。它是胡说八道。

我按我说的读了两遍。

并且热实现模块以实现加速绝对没有任何用处。我只是“什么？你在开玩笑吗？”

QUOTE：模块通过用预编译的模块附件机制（其处理时间可以与导入声明的数量成正比）替换文本包含机制（其处理时间与包含的代码量成正比）来解决此问题。可以保留私有模块定义发生变化时不需要重新编译客户端翻译单元的属性。

我们知道目标。但是除了“它应该”之外还有什么东西呢？

我不知道 mb 提案的目标只是说“他你对这个想法有什么看法？” 但我虽然会有一些像 RFC 这样的想法。看来我错了。

因此，在这种情况下，我只想问社区一些非常基本的问题，因为我真的不明白如何在不从头开始重写大部分语言以及我们今天拥有的所有编译和链接机制的情况下实现模块。我真的不明白:(如此巨大的努力值得吗？这将是完全不同的语言......说“进化的c ++”的原因是什么？

不用说，要实现模块，这些模块应该有某种数据格式，一些元数据。好的。可以是纯文本不是吗？它服务于目标，但ofc NO！这样就会有另一个 import->import->ipmport 纯文本链，应该在编译时进行解析。所以似乎应该有二进制数据:) 好的。它应该只是特定于语言和跨平台还是特定于平台？

那么代码中的所有#ifdef 块呢？如果会有某种预编译的二进制数据，它将依赖于平台（并且包括世界上所有的 ifdef 分支），或者它将是我们每次都应该重新编译的奇怪模块。好像不可能是真的。那方面呢？或者说c ++中的模块我们根本不谈论平台无关的元数据，我们只是在谈论某种预编译数据，这些数据仅在同一项目的重新编译阶段有用？没有类似 java 的机器可以在运行时排除一些分支，不是吗？

它到底是如何被创造出来的？主要思想:)

那么所有这些库的实现呢？.dll、.a、.so？例如，现在我们有源+标头（+标头+标头+标头）-> obj-> 二进制。c++ 模块在该链中的位置在哪里？它应该是什么样子？来源-> obj+模块-> 二进制？或来源->模块+模块->objs->二进制？

似乎以任何方式实现模块都会影响我们今天使用的所有编译过程。

总而言之，我只是对基本概念感兴趣，但比“哦，它应该减少编译时间”更具建设性 - 这并不严重！并希望有人可以分享一些关于如何实现它的知识或概念（或指出正确的方法）。

提前 Tnx！希望我不会被禁止 :(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:45:30.443

首先，请注意N2073相当老了！我知道的最新模块提案是[N3347](http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2012/n3347.pdf)。当然，这也只讨论语言级别的结构。关于该主题（或任何其他主题）的所有其他论文也是如此：语言标准根本没有指定语言是如何实现的。C++ 标准指定的是语言的语义。如何实现取决于编译器编写者，并且在某种程度上取决于定义软件开发平台的人员：对于给定的平台，可能会有不同编译器如何互操作的规范。如果模块被包含在语言标准中，这就是定义文件格式之类的地方。

也就是说，请注意，指定如何在语言级别上表示模块的语义为编译器提供了创建有效表示的必要杠杆（当然，假设它做得正确）。目前，任何奇怪的`#define`可以扭曲许多声明，并使其完全无法预测给定标头中的声明的外观。当然，任何健全的库都会对用户可以做什么施加限制，但所有这些限制都超出了语言规范。一旦有了稳定的定义，编译器就可以根据之前以某种方式创建的模块的合适表示来加载其内部数据结构。编译器供应商也不需要任何关于如何制作特定编译器进程模块的指导：他们比其他任何人都更了解自己的内部数据结构！...无论如何，任何固定的配方都不适用于某些编译器供应商。

只是关于模块内容表示的注释：模块中声明的表示是文本还是二进制并不重要：在这两种情况下，表示的数据都是相同的，并且很容易包括，例如，名称解析并避免任何解析怪癖。

模块是该标准未来修订议程上的主题之一。我没有看到太多关于模块状态的信息，但这是多个编译器供应商感兴趣的话题。当然，他们都有不同的想法，需要什么以及应该是什么样子，但他们同意合作。

# mysql - 在连接表中选择不同的值

> ID：12846995
> 
> 赞同：2
> 
> 时间：2012-10-11T19:22:48.327
> 
> 标签：mysql

简化我正在解决的问题，但我认为以下是它的要点：

我有两个表（TableA 和 TableB），由 LEFT JOIN 连接。

我需要按时间倒序从 TableA 中获取 10 条记录；但是这十个结果中的每一个都在 TableB.foo 中具有唯一值。

IE

A.id 是 1，A.date 是两天前，B.foo 是“猫”。
A.id 是 2，A.date 是昨天，B.foo 是“猫”。
A.id 是 3，A.date 是今天，B.foo 是“狗”。
A.id 是 4，A.date 是三天前，B.foo 是“猪”。
A.id 是 5，A.date 是四天前，B.foo 是“狗”。

我希望查询的前 3 个结果是 3、2、4（并且根本不返回 1 和 5）。

这可以在单个 MySQL 查询中实现吗？

如果做不到这一点，那么在多个步骤中获得所需结果集的最有效策略是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:11:29.023

```
SELECT T1.id, T1.date
FROM (SELECT A.id id, B.foo foo, A.date date
      FROM A JOIN B
      ON A.b_id = B.id) T1
JOIN (
    SELECT B.foo foo, MAX(A.date) maxdate
    FROM A JOIN B
    ON A.b_id = B.id
    GROUP BY B.foo) T2
ON T1.foo = T2.foo and T1.date = T2.maxdate
ORDER BY T1.date DESC
LIMIT 10 
```

# php - 将 Google Map Location URL 获取到文本框

> ID：12846996
> 
> 赞同：0
> 
> 时间：2012-10-11T19:22:51.187
> 
> 标签：php, google-maps

我对谷歌地图很陌生，在我的项目中，有这样的要求。

有打开谷歌地图的链接，当用户点击链接时，谷歌地图会出现，当他从地图中选择一个位置时，该位置的URL应该填写到一个文本框中，

有没有办法做到这一点？因为我需要将它保存在数据库中并且必须在 Web 服务中使用。

任何建议也欢迎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T19:29:32.227

查看谷歌关于事件的文档：[https ://developers.google.com/maps/documentation/javascript/events](https://developers.google.com/maps/documentation/javascript/events)

```
google.maps.event.addListener(map, 'click', function(event) {
   //event.latLng is the lat long of the click's location
   //At this point you could do a document.getElementById("someId").value= ... to cahnge the text box
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:30:48.247

这不是您问题的确切答案，但是由于您刚刚从 google-maps + db + webservice 开始，也许您最好从这个官方教程开始 [使用 PHP、MySQL 和 Google 地图创建商店定位器](https://developers.google.com/maps/articles/phpsqlsearch_v3)

# javascript - jQuery防止动画分割的跳跃

> ID：12846999
> 
> 赞同：2
> 
> 时间：2012-10-11T19:22:59.637
> 
> 标签：javascript, jquery, jquery-tools

我有动画选项卡，在将鼠标悬停在链接上`h2`（触发幻灯片动画）时，我会向上/向下设置幻灯片效果，就像手风琴一样。

```
<div class="slideBox">
    <div class="pane"><img src="images/homepage/sm1.jpg" alt="Room" /></div><!--pane-->
    <h2 class="drkbluebg" style="border-bottom:7px solid #fff;">
        <b>main title</b>
        <br />
        photo caption
    </h2>
    <div class="pane" style="display:block;">
        <img src="images/homepage/sm2.jpg" alt="Room" />
    </div><!--pane-->
    <h2 class="current greybg"><b>main title</b><br/>photo caption</h2>
</div><!--slideBox--> 
```

但是，动画不会停止。手风琴效果（幻灯片效果）不断触发。有没有办法来解决这个问题？

（顺便说一下，到目前为止我用jQuerytools尝试过，但是如果您有其他解决方案，欢迎您提出）

这是JS代码：

```
$(function() {
    $(".slideBox").tabs(".pane", {tabs: 'h2', effect: 'slide', event: 'mouseover'});    
}); 
```

这是我所做的链接[http://www.ixpander.com/simulation/so_issue/](http://www.ixpander.com/simulation/so_issue/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:28:02.367

尝试使用`mouseenter`而不是`mouseover`这样它只会在鼠标第一次进入元素时触发，而不是每次鼠标移动时触发

```
$(".slideBox").tabs(".pane", {tabs: 'h2', effect: 'slide', event: 'mouseenter'}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:32:43.077

我会将它与类和 css 一起使用：

```
<style>
.pane{
   height:0;
   overflow:hidden;
}

.pane.active{
   height:100px;
}

</style> 
```

然后我将使用 jQuery 添加类，如下所示。

```
<script>
$(document).ready(function() {
    $(".slideBox").on('hover', function(){
      $(this).prev('.pane').addClass('active');
    });
}
</script> 
```