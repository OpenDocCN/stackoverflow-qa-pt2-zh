# StackOverflow 问答 13078000-13078999

# ruby-on-rails - favicon the rails way

> ID：13078000
> 
> 赞同：4
> 
> 时间：2012-10-25T22:01:41.533
> 
> 标签：ruby-on-rails, favicon

我遵循了我在 stackOverflow 上找到的建议，并将以下内容添加到我的 layouts/application.html.erb 部分：

```
<%= favicon_link_tag '/favicon.ico' %> 
```

favicon.ico 在我的公用文件夹中 我也尝试将它放在 assets/images 文件夹中

我重新启动了 rails 服务器（MAC 上的本地开发环境，Rails 3.2.xxx），但我没有看到 favicon。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T08:19:10.793

要检查的三件事：

*   是否`favicon_link_tag`正确呈现在您的文档的 HTML 源代码中？

*   它呈现的`favicon.ico`URL 是否指向有效文件，路径是否错误，或者您可能对此有权限问题？

*   您是否刷新了浏览器的缓存？在大多数浏览器中，通过按住`Ctrl`或`Shift`重新加载网站来执行此操作。另请参阅：[维基百科：绕过缓存](http://en.wikipedia.org/wiki/Wikipedia%3aBypass_your_cache#Bypass_browser_cache.2C_instructions_for_various_browsers)

# javascript - 如何在用户通过 jQuery 在键盘上键入时删除警报消息？

> ID：13078005
> 
> 赞同：-1
> 
> 时间：2012-10-25T22:02:16.993
> 
> 标签：javascript, jquery, syntax

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Save new student</title>
<script>

function insertdata()
{

var n = document.getElementById("name").value;
var f = document.getElementById("family").value;
var m = document.getElementById("mark").value;
var t = document.getElementById("tell").value;

 if ((n=="") || (f=="") || (m=="") || (t=="")){

  var error=document.getElementById("error").innerHTML="fill out the form with valid values";

 }
 **else if()**
 {

 }
 else{

frminsert.submit();

 }

 }

</script>
</head>

<body>

please enter your data:

<br/>

 <form action="saveinsert.php" method="post" name="frminsert">
  Name :
 <input type="text" name="name" id="name" />
 <br/>
 Family :
 <input type="text" name="family" id="family" />
 <br/>
 Mark :
<input type="text" name="mark" id="mark" />
<br/>
 Tell :
<input type="text" name="tell" id="tell" />
<br />
 <input type="button" value="Save New Student"  onclick="insertdata();" />

 <input type="reset" value="Reset Form" />

</form>
<p id="error"></p>
<a href="show.php">show the list of students</a>
</body>
</html> 
```

我的代码将使用此语句指示错误消息：正确填写表格。
我将详细说明它，当用户开始在键盘上键入时，我需要消除上面提到的错误消息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T22:07:26.570

我想这就是你需要的吗？（清除错误信息）

```
document.getElementById("error").innerHTML= ""; 
```

如果您希望它在用户执行某些操作时发生，例如输入框，那么您需要在该输入上添加一个事件侦听器，例如

```
<input onKeyDown="removeErrorMessage()" ... />
...
<script>
function removeErrorMessage{
document.getElementById("error").innerHTML= "";
};
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:12:07.997

您可以将其放入第一行：

```
function cleanError()
{
document.getElementById("error").innerHTML= "";
} 
```

每个输入都`onBlur="cleanError()`像这样放置“：

```
<input onBlur="cleanError()" type="text" name="family" id="family" /> 
```

祝你好运 ！

# arrays - 按行数聚合值

> ID：13078006
> 
> 赞同：1
> 
> 时间：2012-10-25T22:02:23.470
> 
> 标签：arrays, aggregate, window-functions, postgresql-9.2

我有一系列行，我需要将这些行中的值聚合到`N`元素组中，从当前行和`N-1`后续行中累积值。

和`N=3`数据是：

```
VALUES (1),(2),(3),(4),(5); 
```

我想收到以下一组行（数组）：

```
{1,2,3}
{2,3,4}
{3,4,5}
{4,5}
{5} 
```

重要的是，这`N`是一个变量，所以我不能使用连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:41:16.713

好吧，这可以通过[使用框架和窗口函数](http://www.postgresql.org/docs/current/interactive/sql-expressions.html#SYNTAX-WINDOW-FUNCTIONS)来解决。

题目中的问题可以这样解决：

```
WITH v(v) AS (VALUES (1),(2),(3),(4),(5))
SELECT v,
       array_agg(v) OVER (ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS arr
  FROM v; 
```

以下示例说明了如何获取完整数组的列表，即消除那些不包含所有`N`条目的数组：

```
WITH cnt(c) AS (SELECT 3),
     val(v) AS (VALUES (1),(2),(3),(4),(5)),
     arr AS
(SELECT v,
        array_agg(v) OVER (ROWS BETWEEN CURRENT ROW
                           AND (SELECT c-1 FROM cnt) FOLLOWING) AS arr
   FROM val)
SELECT v,arr
  FROM arr
 WHERE array_upper(arr,1) = (SELECT c FROM cnt); 
```

我真的很喜欢窗口功能！

# android - 实现 Facebook SDK 3.0 时如何扩展 SherlockFragmentActivity

> ID：13078009
> 
> 赞同：4
> 
> 时间：2012-10-25T22:02:36.620
> 
> 标签：android, actionbarsherlock, facebook-android-sdk

我正在尝试在依赖 ActionBarSherlock 的 Android 应用程序中实现 Facebook SDK（3.0 测试版），但我不明白怎么做，因为我无法同时**扩展** `SherlockFragmentActivity`和`FacebookActivity`.

Facebook SDK 中的示例应用程序具有：

```
public class MainActivity extends FacebookActivity {

  private static final int SPLASH = 0;
  private static final int SELECTION = 1; 
```

FacebookActivity 看起来像：

```
public class FacebookActivity extends FragmentActivity { 
```

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T22:15:48.800

扩展`FacebookActivity`不是必需的，但在使用 Facebook 集成时，它确实让您的生活更轻松。请参阅我们示例应用程序中的 SessionLoginSample，了解如何在不使用`FacebookActivity`. 您只需要处理自己的 Session 序列化和 onActivityResult 回调。

我建议`SherlockFragmentActivity`手动扩展然后处理 Facebook 集成。这个 SO 答案也可能有更多相关信息： http: [//facebook.stackoverflow.com/a/13018745/931354](http://facebook.stackoverflow.com/a/13018745/931354)

# rest - 是否在自定义 HTTP 标头 RESTful 中传递租户？

> ID：13078015
> 
> 赞同：17
> 
> 时间：2012-10-25T22:03:21.320
> 
> 标签：rest, http-headers, uri, restful-url, restful-architecture

我正在考虑在多租户环境中识别 HTTP 请求的租户的以下两种方法 - 在 URI 中对租户进行硬编码：

`/{tenantUuid}/foos/{id}`

或者在自定义 HTTP Header 中传递租户，例如：

`X-Auth-Token: 7d2f63fd-4dcc-4752-8e9b-1d08f989cc00"`

（类似于：[http](http://docs.openstack.org/api/quick-start/content/) ://docs.openstack.org/api/quick-start/content/ ）

请注意，`{id}`在所有租户中都是唯一的 - 因此`/{tenantUuid}/foos/{id}`仍将唯一标识`foo`资源。

我的问题是-为此使用自定义标头在理论上是否正确，或者使用自定义标头是否不安全。我也知道`X-...`标头已被弃用，但问题是忽略了这一事实。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T23:47:15.680

URI 应该唯一标识资源。

但这与授权和访问是正交的。两个人可以要求相同的资源。一个人一无所获，一个省略的副本，或者一个错误；而另一个会得到整个事情，因为它们在 Authorization 标头中被正确识别。

现在 URI 可以包含租户 ID 作为其唯一 URI 的一部分，这没有任何问题。但无论哪种方式，资源本身都会（不知何故，包括通过其 URI 的组件或内部状态）“知道”它属于哪个租户。

因此，在您的情况下，您应该使用 HTTP Authorization 标头正确识别请求者，然后使用该信息在内部确定特定请求的响应是否以及响应内容。请求者可能被授权查看系统上的任何租户、一个租户、部分租户或所有租户。

对于此用例，您根本不需要自定义标头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T23:24:32.773

如果您需要租户 ID 来识别资源，那么 RESTful 方式就是将它放在 URL 中。如果您不这样做（id 在租户中是唯一的），那么从技术上讲，您不需要在 URL 或标题中使用它。

由于 id 在所有租户中都是唯一的，因此 /foos/{id} 可以唯一地标识该资源并且是 RESTful 的。

我会避免使用自定义标头作为寻址资源的一种方式。它们应该用于传递辅助信息，例如接受类型、身份验证令牌等……您需要确定识别资源并将其放入 URL 是否至关重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-29T17:15:38.063

您的应用程序将用户与不同的租户分开可能与 craig 的列表之类的应用程序将其与城市分开一样有趣。

但是你想在你的 URI 中显示所有类型的分隔符吗？你想要一个URI，比如`/comcast/blackeyes/long-haired/london/`？

RESTful 或 RESTenough 不会回答这个问题。这只是一个品味问题。

# c# - 如何跨程序集使用 Ninject

> ID：13078017
> 
> 赞同：7
> 
> 时间：2012-10-25T22:03:29.680
> 
> 标签：c#, ninject

我可以看到以前曾提出过类似的问题，但是对于 DI 和 .Net 来说是全新的，我无法掌握整个解决方案，或者可能找不到正确的来源......

*   我有程序集 WebAPI、BL、DL。
*   WebAPI依赖于BL，
*   BL依赖于DL，
*   WebAPI 不引用 DL，我想保持不变。还有一些程序集，但这足以说明问题。

WebAPI 有应用程序启动部分，因此我可以使用它来初始化 Ninject 内核并为 WebAPI 项目注册依赖项。

我怎样才能为 BL 和其他程序集实现相同的目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T22:13:21.210

有几种不同的方法，您可以使用[Ninject 约定](https://github.com/ninject/ninject.extensions.conventions/wiki/What-is-configuration-by-convention)自动将每个解析`ISomething`为具有相同名称的实现（例如`IThing`-> ），或者您可以在每个注册依赖项的程序集中`Thing`创建一个[Ninject 模块](https://github.com/ninject/ninject/wiki/Modules-and-the-Kernel)（您的BL 可以在你的 DL 中加载模块）。

您采用的方法取决于您是否需要为不同的对象定义不同的范围，例如，如果您希望将某些事情解析为可能会影响您使用的方法的单例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T14:22:51.780

我认为[Mark Seemann 对此的建议](http://blog.ploeh.dk/2011/07/28/CompositionRoot.aspx)很棒——在应用程序的最高可能层创建一个组合根。对于 Web 应用程序，这意味着在 Globals.asax 文件中。我可以解释这样做的充分理由，但链接的博客文章做得更好。

这确实打破了你试图实现的分层，但只是勉强，我认为这是一种合适的方式。如果您的 Web 层足够薄（即，您可以很容易地用厚客户端替换它），那么这并不是什么大损失。如果你真的反对，你可以在 BL 中为 DL 创建一个组合根。

# maven - 如何提交一个新的maven插件

> ID：13078021
> 
> 赞同：2
> 
> 时间：2012-10-25T22:03:56.637
> 
> 标签：maven

假设我开发了一个我不相信以前开发过的插件。我可以将此插件提交给 maven 社区还是存在这样的设施？这需要一个过程吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:01:25.860

如果您的意思是将您的工件提交到[中央存储库](http://search.maven.org/#browse)，这里是完整的用户指南：

## [Sonatype OSS Maven 存储库使用指南](https://docs.sonatype.org/display/Repository/Sonatype+OSS+Maven+Repository+Usage+Guide)

> **一、简介**
> 
> Sonatype OSSRH（OSS Repository Hosting Service）使用Nexus为开源项目提供Maven仓库托管服务：[https](https://oss.sonatype.org/) ://oss.sonatype.org/ 。您可以部署快照、暂存版本并升级您的版本，以便将它们同步到[中央存储库](http://repo1.maven.org/maven2/)。您需要做的就是注册一个 Sonatype JIRA 帐户，创建一个 JIRA 票证并进行一些 POM/设置配置。本文档将逐步指导您了解详细信息。
> 
> ……

# php - PHP ldap_modify 访问权限不足

> ID：13078022
> 
> 赞同：7
> 
> 时间：2012-10-25T22:03:59.340
> 
> 标签：php, ldap, openldap

在 OpenLDAP 2.4.32 和 PHP 5.4.6 中使用 ldap_modify 时出现访问不足错误。

给出错误的 php 函数如下所示：

```
function set_user($dn, $password, $data)
{
  /* This function sets the users infomation */

  // Get Configuration Items
  $ldapServer = $this->config->item('ldapServer');
  $ldapDCRoot = $this->config->item('ldapDCRoot');

  // Connect to LDAP
  $ldapConnection = ldap_connect($ldapServer);

  if($ldapConnection)
  {
    $r = ldap_bind($ldapConnection, $dn, $password);
    if ($r)
    {
      // Bind completed successfully
      $r = ldap_modify($ldapConnection, $dn, $data);
      return True;
    }
    die("Unsuccessful Bind");
  }
  die("Can't connect to LDAP");
} 
```

$dn 是尝试更改其信息及其密码的用户的完整 DN。$data 是他们正在更新的值，现在 data 只包含要更改的电话号码 $data['mobile'] = "newPhoneNumber"。除了数据从未实际写入之外，这一切似乎都在工作。

openldap 文件包含在下面，您可以看到 ACL 说我应该能够写入它。

```
include     /etc/openldap/schema/corba.schema
include     /etc/openldap/schema/core.schema
include     /etc/openldap/schema/cosine.schema
include     /etc/openldap/schema/duaconf.schema
include     /etc/openldap/schema/dyngroup.schema
include     /etc/openldap/schema/inetorgperson.schema
include     /etc/openldap/schema/java.schema
include     /etc/openldap/schema/misc.schema
include     /etc/openldap/schema/nis.schema
include     /etc/openldap/schema/openldap.schema
include     /etc/openldap/schema/ppolicy.schema
include     /etc/openldap/schema/collective.schema

allow bind_v2

pidfile     /var/run/openldap/slapd.pid
argsfile    /var/run/openldap/slapd.args

TLSCertificateFile /etc/pki/tls/certs/slapd.pem
TLSCertificateKeyFile /etc/pki/tls/certs/slapd.pem

access to *
    by self write
    by users read
    by anonymous auth

database    bdb
suffix      "dc=example,dc=com"
checkpoint  1024 15
rootdn      "cn=manager,dc=example,dc=com"
rootpw          REDACTED

directory   /var/lib/ldap

index objectClass                       eq,pres
index ou,cn,mail,surname,givenname      eq,pres,sub
index uidNumber,gidNumber,loginShell    eq,pres
index uid,memberUid                     eq,pres,sub
index nisMapName,nisMapEntry            eq,pres,sub 
```

问题是为什么 PHP 不能更新值，而是得到一个访问不足的错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-04-21T18:03:59.893

要调试您的问题，我建议使用命令行工具**ldapmodify**发出相同的请求。您可能需要将它安装到您的系统（Redhat `openldap-clients`，Debian `slapd`）。

[LDAP 实用程序](http://www.tldp.org/HOWTO/LDAP-HOWTO/utilities.html)

通过设置调试级别`-d`，您有望获得比 php 库提供的有关您的调用返回访问不足错误的原因的更多信息。

虽然我从来不用**ldapmodify**来做这件事，但我已经将它与**ldapsearch**一起使用并取得了巨大的成功。所以可能需要一些搜索或`ldapmodify --help`弄清楚如何使用它。

我想命令看起来像这样：

```
ldapmodify -d 7 -h ldap.server.com -D bind_dn -w bind_password -f /tmp/entrymods 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-22T09:34:11.180

我在更改 Active Directory 密码时遇到了一些问题。也许这也会对其他人有所帮助：

第一：您将需要一个安全连接，否则 LDAP 将拒绝更改密码。

```
$this->ldap_ds = ldap_connect($this->hostname);
//some protocol options
ldap_set_option($this->ldap_ds, LDAP_OPT_REFERRALS, 0);
ldap_set_option($this->ldap_ds, LDAP_OPT_PROTOCOL_VERSION, 3);

// start secure connection on port 636
ldap_start_tls($this->ldap_ds); 
```

第二：在我的系统上，我在启动安全连接时遇到了问题，我现在解决了这个问题，编辑 /etc/ldap/ldap.conf

```
# TLS_CACERT    /etc/ssl/certs/ca-certificates.crt
TLS_REQCERT never 
```

第三：对于活动目录，我们使用`unicodePwd`字段而不是`userPassword`字段。此字段需要 Unicode 字符串。

```
$entry["unicodePwd"] = iconv("UTF-8", "UTF-16LE", '"' . $newPassword . '"'); 
```

第四：更改密码不能使用`modify`，而是使用`mod_replace`函数。

```
ldap_mod_replace($ldapConnection, $user_dn, $entry); 
```

# python - 为什么从 C 应用程序导入 Python 脚本时，我需要显式地将 os.getcwd() 添加到 sys.path？

> ID：13078025
> 
> 赞同：2
> 
> 时间：2012-10-25T22:04:13.270
> 
> 标签：python, c, python-embedding

我正在阅读有关[使用 C/C++ 扩展 Python](http://docs.python.org/extending/extending.html)的 Python 文档，我发现了一个非常有趣的场景。`test_script.py`考虑一下我的工作目录中命名了以下简单的 Python 脚本：

```
import time
def My_Python_Func():
    print "My_Python_Func() Called: " + str(time.time()) 
```

在同一目录中，我有一个名为 的文件`another_test_script.py`，其中包含：

```
import test_script
test_script.My_Python_Func() 
```

哪个工作正常，当称为`python ./another_test_script.py`. 现在，我试图从与 Python 库链接的 C 环境中调用所述函数，如下所示：

```
#include <stdio.h>
#include <Python.h>

PyObject *pName, *pModule, *pDict, *pFunc, *pVal;

int main()
{
    const char* script_name = "test_script";
    const char* func_name   = "My_Python_Func";

    Py_Initialize();

    pName = PyString_FromString(script_name);

    PyRun_SimpleString("import os");
    PyRun_SimpleString("import sys");
    /* * * * IF I COMMENT THE FOLLOWING LINE OUT, pModule IS ALWAYS SET TO NULL * * * */
    PyRun_SimpleString("sys.path.insert(0, os.getcwd())");
    pModule = PyImport_Import(pName);

    Py_DECREF(pName);
    if (pModule != NULL)
    {
        pFunc = PyObject_GetAttrString(pModule, func_name);
    }
    pDict = PyModule_GetDict(pModule);
    pFunc = PyDict_GetItemString(pDict, func_name);
    if (PyCallable_Check(pFunc))
    {
        PyObject_CallObject(pFunc, NULL);
        Py_DECREF(pModule);
        Py_DECREF(pName);
    }
    else
    {
        PyErr_Print();
    }
    Py_Finalize();
    return 0;
} 
```

如上述 C 程序中的注释所述，注释掉包含的行`PyRun_SimpleString("sys.path.insert(0, os.getcwd())")`会导致调用`PyImport_Import`失败（返回`NULL`）。此外，呼叫`PyRun_SimpleString("import test_script")`的行为方式似乎相同。

为什么我需要手动将当前工作目录添加到 Python 的`sys.path`字符串列表中，而只是从同一工作目录中的另一个 Python 脚本导入它？此外，为什么 Python 不首先搜索当前工作目录（`os.getcwd()`返回正确的路径）？如果我想从与我的 C 应用程序捆绑的脚本中导入函数，这是一个合适的解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T22:06:39.520

添加脚本目录`sys.path`是`python`可执行文件的一个特性；默认情况下，解释器初始化时不会这样做，因为在嵌入式应用程序中这样做并不总是合适的。

# forms - 来自控制器的 Magento 帖子

> ID：13078029
> 
> 赞同：0
> 
> 时间：2012-10-25T22:04:28.663
> 
> 标签：forms, magento, post, controller

最近我一直在使用`cURL`将数据从自定义 Magento 控制器发布回同一网站上的自定义页面。

但是，我这样做的方式以某种方式破坏了 Magento 的登录数据。所以我尝试了另一种方法。Magento 具有`cURL`内置的功能 ( `Varien_Http_Adapter_Curl`)。

我试图通过这个发布，但到目前为止它已经超出了我的想象，并且网络上的文档相当稀疏。我需要这方面的帮助。我有一个`$_POST`准备好所有数据的字符串。请问有人能告诉我怎么寄吗？

这个：

```
$url="<URL>";
$curl = new Varien_Http_Adapter_Curl;
$curl->setConfig(array('timeout' => 15));
$curl->write(Zend_Http_Client::POST,$url, '1.1', array(), $poststring);
$result = $curl->read();
$curl->close(); 
```

...不发送数据。

编辑：

我试过非 Magento cURL，但不知道会话数据。我仍然不知道如何发送会话数据。现在，我尝试了会话变量，但结果是我可以在一页上设置和提取数据，但是在更改页面时数据会丢失。所以，目前不能在控制器和视图之间使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T07:21:59.843

更好的是你可以使用magento会话

[http://magento-rohan.blogspot.in/2012/03/magento-get-set-unset-session.html](http://magento-rohan.blogspot.in/2012/03/magento-get-set-unset-session.html)

这是如何使用它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T08:00:35.070

您需要向我们提供有关您要达到的目标的更多信息。基本上你需要告诉我们你在哪里发送 POST 请求？也许是另一个 Magento 实例，甚至是同一个 Magento 网站？您是否希望用户拥有与现在相同的会话？一旦您向我们提供更多信息，我将编辑我的答案。现在，我将尝试根据您提供的输入来猜测是什么困扰着您。

当您从服务器端使用 curl 提交 POST 请求时，这意味着用户不再与您尝试向其提交发布请求的“页面”交互。

如果用户没有与之交互，这意味着它没有发送用户会话信息。

基本上它看起来像这样：

**一般**

> Eric ->（带有会话信息的请求）-> 服务器（哦，是你 Eric，这是专为你准备的回复）

**你想做什么**

> Eric ->（带有会话信息的请求）-> 服务器 ->（没有会话信息的请求）-> 服务器（此服务器不知道 Eric）

因此，为了正确实现这一点，如果我善于假设您的问题是什么，只需将会话信息与您的请求一起传递给第二台服务器。

如果您告诉我我正在了解您的问题，我会添加更多信息。

**- -更新 - -**

你没有很好地解释你的情况。我告诉你这是因为你使用 cURL 的整个方法可能从一开始就是一个糟糕的决定。例如，如果您尝试在同一个 Magento 代码库中执行代码，并且该代码被困在某个控制器中，也许您可​​以重构您的代码并将该逻辑封装在某个模型中并直接执行它。

但这里是在普通 php 中通过 curl 传递会话信息的示例：

```
$strCookie = 'PHPSESSID=' . $_COOKIE['PHPSESSID'] . '; path=/';
curl_setopt( $curl, CURLOPT_COOKIE, $strCookie ); 
```

Cookie 在 Magento 中或许应该被称为“前端”。我检查了 Varien_Http_Adapter_Curl 它没有任何设置 CURLOPT_COOKIE 选项的方法，所以我建议你使用普通的 curl 设置。您还可以选择扩展适配器并自行添加该选项。只需覆盖“_applyConfig”方法。

# ios - Jenkins 上的 XCode 项目，停留在“代码设计”

> ID：13078033
> 
> 赞同：10
> 
> 时间：2012-10-25T22:04:42.863
> 
> 标签：ios, xcode, continuous-integration, jenkins

我使用 Jenkins 与 XCode 插件进行持续集成，Jenkins 坚持了一个项目：

/usr/bin/codesign --force --sign ......

紧随其后的是旋转器，永远旋转，我以前从未见过，有人见过吗？是配置文件问题还是证书问题？在 Jenkins 上，配置文件和证书已正确安装并在 Organizer 中显示绿色勾号，所以我不知道是什么导致了这个问题。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-10-25T22:12:02.753

检查您的 Mac OS 机器，它应该会提示访问钥匙串的请求。除非您不接受或拒绝对钥匙串的访问，否则作业将一直卡住。

# excel - 水平排序 - 每行独立于其他行

> ID：13078043
> 
> 赞同：0
> 
> 时间：2012-10-25T22:05:45.293
> 
> 标签：excel, vba, sorting

我想对我的数据（字符串）进行水平排序，但我想独立于其他行对每一行进行排序。

这样做的唯一方法是选择手动选择每一行并对其进行排序吗？

我根本不是 VBA 专家，我可以在 c# 或 java 中做到这一点，但我希望这个函数存在于 excel 中......

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:41:42.903

这是VBA，假设您的最后一行在A列中有数据：

```
Sub Macro1()
Dim lLastRow As Long, lLoop As Long

lLastRow = Cells(Rows.Count, 1).End(xlUp).Row

'turn off updates to speed up code execution
With Application
    .ScreenUpdating = False
    .EnableEvents = False
    .Calculation = xlCalculationManual
    .DisplayAlerts = False
End With

For lLoop = 1 To lLastRow

Rows(lLoop).Sort key1:=Cells(lLoop, 1), order1:=xlAscending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _
                    False, Orientation:=xlLeftToRight, DataOption1:=xlSortNormal, DataOption2 _
                    :=xlSortNormal

Next

With Application
    .ScreenUpdating = True
    .EnableEvents = True
    .Calculation = xlCalculationAutomatic
    .DisplayAlerts = True
End With

End Sub 
```

# c++ - 循环中的 std::bad_alloc 错误

> ID：13078045
> 
> 赞同：2
> 
> 时间：2012-10-25T22:06:05.103
> 
> 标签：c++

菜鸟在这里。我知道我不应该发布家庭作业，但我不知道是什么可能导致这个问题。出于某种原因，这个 while 循环在它退出之前（即，当它读取文件结尾时）抛出一个 std::bad_alloc 异常。它在 8GB 的​​系统上只使用 500 MB 的 RAM，所以我很确定这不是内存的过度使用。如果有人可以提供帮助，那就太好了，因为我一直在寻找这个问题大约四个小时，但找不到解决办法。这可能是一些愚蠢的事情，但我无法弄清楚。

这是代码：

```
temperatures_in >> low >> high;
tempMin=low;
tempMax=high;
getLocation(temperatures_in, location);

while(!temperatures_in.eof()){
    temperatures_out << left << setw(20) << location;
    temperatures_out << right << fixed << showpoint << setprecision(2) << setw(6) << low << setw(6) << high << endl;
    temperatures_in >> low >> high;
    getLocation(temperatures_in, location);
    if(low<tempMin){
        tempMin=low;
    }
    if(high>tempMax){
        tempMax=high;
    }
    cout << low << " " << tempMin << " " << high << " " << tempMax << " " << location;
} 
```

此外，当我运行调试器时，它显示异常以某种方式在第 -1 行抛出（这甚至可能吗？），即使我已经测试了循环内外的输出并且它会在循环结束之前执行代码，但不是之后。

编辑：这是 getLocation() 函数：

```
void getLocation(ifstream &temperatures_in, string &location){
    char a;
    temperatures_in.get(a);
    while(a==' '){
        temperatures_in.get(a);
    }
    location="";
    while(a!='\n'){
        location+=a;
        temperatures_in.get(a);
    }
} 
```

# php - 访问类结构中的数组

> ID：13078047
> 
> 赞同：1
> 
> 时间：2012-10-25T22:06:17.600
> 
> 标签：php, arrays, class, properties, scope

我想用 php 验证表单。

为此，我创建了一个类“benutzer”和该类的公共函数“benutzerEintragen”来验证表单：

```
class benutzer
{
private $username = "";
private $mail = "";
private $mail_check = "";
private $passwort = "";
private $passwort_check = "";
public $error_blank = array();
public $error_notSelected = array();
public $error_notEqual = array();

    public function benutzerEintragen () {
    $textfields[0] = $this->username;
    $textfields[1] = $this->mail;
    $textfields[2] = $this->mail_check;
    $textfields[3] = $this->passwort;
    $textfields[4] = $this->passwort_check;
    foreach ($textfields as $string) {
      $result = checkFormular::emptyVariable($string);
      $error_blank[] = $result; 
    } 
```

在函数“benutzerEintragen”中，我用适当的 $_POST 条目填充了变量“用户名，邮件”等等（上面的代码中没有显示）。通话

```
checkFormular::emptyVariable($string) 
```

如果该字段未设置或为空，则返回“TRUE”，否则返回 FALSE。

现在，当我尝试创建此类的新实例时，执行该函数并访问 $error_blank[0] 数组为空！

```
 if (($_SERVER['REQUEST_METHOD'] == 'POST')){ 
 $BENUTZER = new benutzer();
 $BENUTZER->benutzerEintragen();
 echo $BENUTZER->error_blank[0];} 
```

所以最后一行导致“注意：未定义的偏移量：0”。它似乎与数组结构有关，因为如果我这样做

```
 echo $BENUTZER->mail; 
```

我得到了我在表格中写的任何输入，这是正确的。此外，当我在 phpEd 中运行调试器时，foreach 循环似乎做了正确的事情，但似乎在函数执行后数组“error_blank”被删除了。

任何帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T22:15:42.287

这里存在范围问题。您确实有一个带有名称的类属性。不像在 Java 中使用与类变量同名的局部变量会自动选择类属性，这在 PHP 中不是这种情况。

基本上，您将输出保存在一个局部变量中，一旦您离开该函数，该变量就会被丢弃。更改`$error_blank[] = $result;`为`$this->error_blank[] = $result;`，你应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:17:02.963

首先，完成一项简单任务的方法似乎过于复杂，但这实际上不是问题。

您正在创建一个仅在函数范围内的新 $error_blank 变量。如果你想使用类变量，你应该使用 $this->error_blank[]

# javascript - 您将如何处理具有 30+ 计算的表格，具体取决于彼此

> ID：13078059
> 
> 赞同：0
> 
> 时间：2012-10-25T22:07:18.350
> 
> 标签：javascript, date-arithmetic

我有这个超过 30 次计算的 Excel 文件，但我对如何在网络上创建它有疑问。

在 excel 中这很容易，但在网络上它必须全部用 javascript 制作，而且它不像在 excel 中那样简单，您可以说 (C4 + C5 / E9 * 1000)。

所有计算都必须实时计算，以便他们可以在最后确定最终价格，而无需先提交。

由于某些输入取决于其他值，我如何看待它，必须多次重新计算公式。

以前有没有人做过这样的事情，他们做过吗？现在我似乎找不到任何可以简化这个过程的好的 javascript 库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:17:56.633

这是一个简洁的 jQuery 网格插件，支持在网页上创建“类似 Excel”的网格。

[http://www.trirand.com/blog/](http://www.trirand.com/blog/)

[https://github.com/tonytomov/jqGrid](https://github.com/tonytomov/jqGrid)

[http://trirand.com/blog/jqgrid/jqgrid.html](http://trirand.com/blog/jqgrid/jqgrid.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:20:46.150

有几个提供实时数据绑定的js 库（ [AngularJS是我喜欢的一个）。](http://angularjs.org/)如果您设置了几个输入文本框（NumberA、NumberB），并有一些只读文本区域数据绑定到您需要的公式（NumberA + NumberB/10），您可能能够在没有太大压力的情况下完成此操作。

当然，这假设您只需要一个“行”信息——重新创建 Excel 将变得更加棘手。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T22:18:03.917

给每个输入一个“id”属性（将使使用成为`getElemetntById`可能）。谷歌“javascript oninput 事件”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T22:18:05.670

您想获取一个 Excel 电子表格并将其转换为 javascript 代码，该代码接收输入变量（您必须在 Excel 中填写的变量）并输出所有变量？

这样做的方法是将每个 Excel 单元格描述为图中的一个节点。如果单元 Y 需要单元 X 来执行计算，那么您必须有一条从节点 X 到节点 Y 的边。

然后，您必须找到图形的拓扑排序（即，单元格/节点的顺序，这样当您尝试计算任何单元格 D 时，您已经计算了它所依赖的所有单元格）。执行此操作的算法在图的大小上是简单且线性的：[http ://en.wikipedia.org/wiki/Topological_sorting](http://en.wikipedia.org/wiki/Topological_sorting)

您只需按照拓扑顺序依次编写javascript代码，您就可以找到所有结果，而不必多次访问任何操作。

# sql - 用 SQL 合并记录，有一些规则

> ID：13078062
> 
> 赞同：2
> 
> 时间：2012-10-25T22:07:32.043
> 
> 标签：sql, merge, duplicates, concatenation

我有一张有 4 条记录的表：

```
NAME    INSTRUMENT    BOOLEAN 1  BOOLEAN 2
Bob     Organ         TRUE       FALSE
Thomas  Violin        FALSE      FALSE
Bob     Piano         FALSE      TRUE 
```

我想合并具有相同“NAME”的记录，以获得：

```
Bob     Organ Piano   TRUE       TRUE
Thomas  Violin        FALSE      FALSE 
```

合并时我想要什么规则？

*   “文本字段”只是连接（例如：Organ + Piano ==>“Organ Piano”）

*   “布尔字段”与逻辑或合并（例如：TRUE 或 FALSE = TRUE）

我的问题：

1）我会根据执行此操作的能力来选择使用哪个软件！带有 SQL 查询（SQLite、MySQL 甚至 Access）或 Excel 的数据库？

2）如果最好的解决方案是数据库，那么执行此操作的 SQL 查询是什么？

提前非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T06:56:47.660

我的选择和 SQLServer2005+

```
SELECT a.NAME AS NAME,(
SELECT ISNULL(b.INSTRUMENT, '')+ ' '
FROM dbo.COExample b WHERE b.NAME=a.NAME
FOR XML PATH('')) AS INSTRUMENT, MAX(CAST(BOOLEAN1 AS int)) AS BOOLEAN1, MAX(CAST(BOOLEAN2 AS int)) AS BOOLEAN2
FROM dbo.COExample a
GROUP BY a.NAME 
```

[SQLFiddle](http://sqlfiddle.com/#!3/6b4b9/1/0)上的示例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T22:33:12.813

使用 SQL Server 2005 或更高版本，下面是一组 T-SQL 语句，将说明您上面的示例（使用交叉应用和案例语句的组合）：

```
CREATE TABLE [dbo].[COExample](
   [NAME] [varchar](50) NULL,
   [INSTRUMENT] [varchar](50) NULL,
   [BOOLEAN1] [bit] NULL,
   [BOOLEAN2] [bit] NULL
);

INSERT INTO dbo.COExample VALUES('Bob','Organ',1,0);
INSERT INTO dbo.COExample VALUES('Thomas','Violin',0,0);
INSERT INTO dbo.COExample VALUES('Bob','Piano',0,1);

SELECT DISTINCT c.NAME, RTRIM(CombInstruments.combinstruments) AS 'INSTRUMENTS'
,CASE WHEN EXISTS(SELECT * FROM dbo.COExample b1 WHERE b1.NAME = c.NAME AND b1.BOOLEAN1 = 1) THEN 1 ELSE 0 END AS 'BOOLEAN1'
,CASE WHEN EXISTS(SELECT * FROM dbo.COExample b2 WHERE b2.NAME = c.NAME AND b2.BOOLEAN2 = 1) THEN 1 ELSE 0 END AS 'BOOLEAN2'
FROM dbo.COExample c

CROSS APPLY
(
   SELECT ISNULL(c2.INSTRUMENT,'') + ' '
   FROM dbo.COExample c2
   WHERE c2.NAME = c.NAME
   ORDER BY c2.INSTRUMENT FOR XML PATH('')
) CombInstruments(combinstruments) 
```

# google-app-engine - AppEngine-OAuth-Library LinkedIn - 授予更多权限

> ID：13078066
> 
> 赞同：1
> 
> 时间：2012-10-25T22:07:48.853
> 
> 标签：google-app-engine, oauth, python-2.7, linkedin

我使用[AppEngine-OAuth-Library](https://github.com/mikeknapp/AppEngine-OAuth-Library/blob/master/oauth.py)从 LinkedIn 获取用户信息，但是如何授予比默认基本配置文件更多的权限。

LinkedInClient 类有这个构造函数：

```
OAuthClient.__init__(self,
    LINKEDIN,
    consumer_key,
    consumer_secret,
    "https://api.linkedin.com/uas/oauth/requestToken",
    "https://api.linkedin.com/uas/oauth/accessToken",
    callback_url) 
```

我已经尝试过这个：

[https://api.linkedin.com/uas/oauth/requestToken?scope=r_basicprofile+r_emailaddress](https://api.linkedin.com/uas/oauth/requestToken?scope=r_basicprofile+r_emailaddress)

但是当我提出请求时，它会出现内部服务器错误。它与默认的 basicprofile 请求完美配合。关于什么是错的一些想法？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T18:16:57.413

您必须在 oauth.py 中提供额外的参数。您在哪里放置带有键“Scope”的字典，并且值应该是您想要的权限。如果您想要超过 1 个权限，请在值中留一个空格，例如 'r_basicprofile r_emailaddress'

# python - 生命哈希 Python 游戏

> ID：13078068
> 
> 赞同：1
> 
> 时间：2012-10-25T22:08:05.073
> 
> 标签：python, hash, conways-game-of-life

我正在尝试通过将 Cell 对象存储到一个集合中（必须使用类）来创建一个简单的生命游戏，但我遇到了我无法将单元对象添加到 Set 中的问题，因为它是不可散列的......有没有解决这个问题？谢谢！

```
class Cell():
    def __init__(self, row, col):
        self.row = row
        self.col = col
    def getRow(self):
        return self.row
    def getCol(self):
        return self.col
    def __eq__(self, other):
        if isinstance(other, self.__class__):
            return self.__dict__ == other.__dict__
        else:
            return False

    def __ne__(self, other):
        return not self.__eq__(other)    

class SparseLifeGrid(set):
    # Creates a new infinite-sized game grid with all cells set to dead.
    def __init__(self):
        self.rowList = []
        self.colList = []
        self.cellSet = set()

    def __add__(self, cell):
        self.cellSet.add(cell)
        self.rowList.append(cell.getRow())     
        self.colList.append(cell.getCol())     

    def minRange(self):
        #Returns a 2-tuple (minrow, mincol) that contains the minimum
        #row index and the minimum
        #column index that is currently occupied by a live cell.
        #None is returned if there are no alive cells.        
        return (sorted(self.rowList)[0], sorted(self.rowList)[0])

    def maxRange(self):
        #Returns a 2-tuple (maxrow, maxcol) that contains the
        #maximum row index and the maximum
        #column index that is currently occupied by a live cell.
        #None is returned if there are no live cells.        
        return (sorted(self.rowList,reverse = True)[0],\
                sorted(self.colList,reverse = True)[0])

    def clearCell(self, row, col):
        #Clears the individual cell (row, col) and sets it to dead.
        #If the cell is already dead, no action is taken.
        for item in self:
            if item == Cell(row,col):
                self.remove(item)

    def setCell(self, row, col):
        #Sets the indicated cell (row, col) to be alive.
        #If the cell is already alive, no action is taken.
        self.__add__(Cell(row,col))

    def isLiveCell(self, row, col):
        #Returns a boolean value indicating if the given
        #cell (row, col) contains a live organism.
        return Cell(row,col) in self

    def numLiveNeighbors(self, row, col):
    #checks how many live adjacents (not diagonals I think) a cell has
        surround = 0
        if self.isLiveCell(row+1,col):
            surround += 1
        if self.isLiveCell(row-1,col):
            surround += 1
        if self.isLiveCell(row, col+1):
            surround += 1
        if self.isLiveCell(row, col-1):
            surround += 1
        return surround

G = SparseLifeGrid()
G.setCell(2,3) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T22:32:09.690

你的对象是可变的，你还没有实现`__hash__()`；但无论如何你都不想这样做。您的单元格仅在它们存在时表示活着，因此只需`(row, col)` 在您的集合中使用一个元组。由于元组是不可变且可散列的，因此您可以将它们放入您的集合中。

使用网格和游戏的类和对象，而不是单元格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T13:59:23.623

您需要使您的 Cell 实例不可变，然后创建一个`__hash__`始终保持不变的方法。如果您不能直接使用元组，这里有一个替代方案（仅从 中借用一点`tuple`）：

```
class Cell:
    # each cell will have exactly two values, so no need for __dict__
    __slots__ = ["row", "col"]

    # set up values at construction time using super().__setitem__()
    def __init__(self, row, col):
        super().__setitem__("row", row)
        super().__setitem__("col", col)
        return self

    # a Cell is intended to be immutable, so __setattr__ always raises an error
    def __setattr__(self, name, value):
        if hasattr(self, name):
            raise AttributeError("{!r} object attribute {!r} is read-only"
                                 .format(self.__class__.__name__, name))
        else:
            raise AttributeError("{!r} object has no attribute {!r}"
                                 .format(self.__class__.__name__, name))

    # comparison operators
    def __eq__(self, other):
        return (isinstance(other, Cell) and
                self.row == other.row and
                self.col == other.col)

    def __ne__(self, other):
        return not self == other

    # hash function, with a value borrowed from a tuple
    def __hash__(self):
        return hash((self.row, self.col)) 
```

不过，这需要做很多工作，因为它相当于：

```
Cell = collections.namedtuple(["row", "col"]) 
```

您的网格类也有一些问题。例如，您正在覆盖`__add__`，它用于实现加法运算符，但您不返回任何内容，因此它不会像预期的那样工作。我怀疑您的意思是要覆盖该`add`方法（没有下划线）。但是，如果是这种情况，`super().add()`如果您希望网格实际作为一个集合运行，您将需要确保使用适当的参数进行调用。

此外，`min(lst)`应该比`sorted(lst)[0]`(O(N) 而不是 O(N log N)) 快得多。

# python - 从 Python 启动另一个程序>单独<

> ID：13078071
> 
> 赞同：8
> 
> 时间：2012-10-25T22:08:16.880
> 
> 标签：python, subprocess

我正在尝试从 Python 运行一个外部的、单独的程序。通常这不会是一个问题，但该程序是一个游戏，并且内置了一个 Python 解释器。当我使用 subprocess.Popen 时，它会启动单独的程序，但会在原始程序的 Python 实例下这样做，以便它们共享第一个 Python 控制台。我可以很好地结束第一个程序，但我宁愿有单独的控制台（主要是因为我已经隐藏了控制台启动，但是当我使用 subprocess.POpen 从 Python 启动程序时它会显示出来）。

如果我可以完全自行启动第二个程序，我会很高兴，就好像我只是“双击它”一样。此外， os.system 将无法工作，因为我的目标是跨平台兼容性，并且仅在 Windows 上可用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T23:24:20.700

> 如果我可以完全自行启动第二个程序，我会很高兴，就好像我只是“双击它”一样。

从 2.7 和 3.3 开始，Python 没有跨平台的方式来执行此操作。将来可能会添加新`shutil.open`方法（可能不在该名称下）；有关详细信息，请参阅[http://bugs.python.org/issue3177](http://bugs.python.org/issue3177)。但在那之前，您必须为您关心的每个平台编写自己的代码。

幸运的是，您尝试做的事情比`shutil.open`最终希望提供的更简单，更不通用，这意味着编码并不难：

*   在 OS X 上，有一个名为的命令[`open`](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/open.1.html)完全符合您的要求：“打开命令打开一个文件（或目录或 URL），就像您双击文件的图标一样。” 所以，你可以`popen` `open /Applications/MyGame.app`。
*   在 Windows 上，等效命令是`start`，但不幸的是，它是 shell 的一部分，`cmd.exe`而不是独立程序。幸运的是，Python 附带了一个[`os.startfile`](http://docs.python.org/library/os.html#os.startfile)做同样事情的函数，所以只需`os.startfile(r'C:\Program Files\MyGame\MyGame.exe')`.
*   在与 FreeDesktop 兼容的 *nix 系统（包括大多数现代 linux 发行版等）上，有一个非常相似的命令，称为[`xdg-open`](http://portland.freedesktop.org/xdg-utils-1.0/xdg-open.html)：“xdg-open 在用户首选应用程序中打开文件或 URL”。再次，只是`popen` `xdg-open /usr/local/bin/mygame`。
*   如果您希望在其他平台上运行，则需要进行一些研究以找到最佳等价物。否则，对于 Mac 和 Windows 之外的任何东西，我都会尝试`popen` `xdg-open`，如果失败则抛出错误。

有关（未经测试的）示例，请参见[http://pastebin.com/XVp46f7X 。](http://pastebin.com/XVp46f7X)

请注意，这只适用于运行实际上可以双击以在 Finder/Explorer/Nautilus/etc 中启动的东西。例如，如果您尝试启动“./script.py”，根据您的设置，它可能会启动一个包含您的脚本的文本编辑器。

此外，在 OS X 上，您希望运行 .app 包，而不是其中的 UNIX 可执行文件。（在某些情况下，启动一个 UNIX 可执行文件——无论是在 .app 包中还是独立的——可能会起作用，但不要指望它。）

另外，请记住，以这种方式启动程序与从命令行运行程序不同——特别是，它将从 Windows/Launch Services/GNOME/KDE/ 继承其环境、当前目录/驱动器等。等等 会话，而不是来自您的终端会话。如果您需要对子进程进行更多控制，则需要查看`open`、`xdg-open`和`os.startfile`/或提出不同的解决方案的文档。

最后，仅仅因为//`open`成功并不意味着游戏正常启动。例如，如果它在创建窗口之前启动然后崩溃，那么它对您来说仍然是成功的。`xdg-open``os.startfile`

您可能想在 PyPI 中寻找可以满足您需求的库。[http://pypi.python.org/pypi/desktop](http://pypi.python.org/pypi/desktop)看起来很有可能。

或者您可以查看 issue 3177 中的补丁，然后选择您最喜欢的补丁。据我所知，它们都是纯 Python，您可以轻松地将添加的函数放入您自己的模块中，而不是放入`os`or中`shutil`。

作为一个快速破解，您可以（ab）使用[`webbrowser.open`](http://docs.python.org/library/webbrowser.html#webbrowser.open). “请注意，在某些平台上，尝试使用此功能打开文件名可能会工作并启动操作系统的关联程序。但是，这既不支持也不可移植。” 特别是 IIRC，它不适用于 OS X 10.5+。但是，我相信从文件名中制作一个文件：URL 实际上*可以*适用于 OS X 和 Windows，也适用于大多数（但不是全部）配置的 linux。如果是这样，它对于快速和肮脏的脚本可能已经足够了。请记住，它没有被记录在案，它可能会为您的某些用户破坏，它可能会在将来破坏，并且它被 Python 开发人员明确认为是滥用，所以我不会指望它更严重。启动“script.py”或“Foo.app/Contents/MacOS/foo”、传递环境变量等与上述更正确的方法相同。

您问题中的几乎所有其他内容都是不相关且错误的：

> 通常这不会是一个问题，但该程序是一个游戏，并且内置了一个 Python 解释器。

那没关系。如果游戏从 C 代码写入标准输出，它会做同样的事情。

> 当我使用 subprocess.Popen 时，它会启动单独的程序，但在原始程序的 Python 实例下这样做

不，它没有。它启动了一个全新的进程，其嵌入式 Python 解释器是一个全新的 Python 实例。您可以通过例如运行与游戏嵌入不同的 Python 版本来验证这一点。

> 以便他们共享第一个 Python 控制台。

不，他们没有。它们可能共享相同的 tty/cmd 窗口，但这不是一回事。

> 我可以很好地结束第一个程序，但我宁愿有单独的控制台（主要是因为我已经隐藏了控制台启动，但是当我使用 subprocess.POpen 从 Python 启动程序时它会显示出来）。

您始终可以将子进程的 stdout 和 stderr 通过管道传输到例如日志文件，然后您可以根据需要从父进程的输出中单独查看该日志文件。但我认为这与你真正关心的事情无关。

> 此外， os.system 将无法工作，因为我的目标是跨平台兼容性，并且仅在 Windows 上可用。

错误的; [`os.system`](http://docs.python.org/library/os.html#os.system)在“Unix，Windows”上可用——这可能是你关心的任何地方。但是，它不起作用，因为它使用相同的 tty 在脚本的子 shell 中运行子程序。（而且它还有很多其他问题——例如，阻塞直到孩子完成。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T22:12:54.900

> 当我使用 subprocess.Popen 时，它会启动单独的程序，但在原始程序的 Python 实例下这样做......

不正确。

> ...这样他们就可以共享第一个 Python 控制台。

*这*是你问题的症结所在。如果您希望它在另一个控制台中运行，那么您必须运行*另一个*控制台并告诉*它*运行您的程序。

> ...我的目标是跨平台兼容性...

抱歉，没有跨平台的方法可以做到这一点。您需要运行适合该平台的控制台/终端。

# java - Java Enter 事件不激活处理程序

> ID：13078072
> 
> 赞同：1
> 
> 时间：2012-10-25T22:08:18.033
> 
> 标签：java, swing, event-handling, jlabel, actionlistener

我是 Java 事件、侦听器和处理程序的新手。我可以编写代码来创建按钮单击事件和工作结果。但是，我无法让 TextField 中的简单输入事件起作用。

请注意，我确实声明并调用了动作侦听器、输入处理程序，并定义了结果方法执行。（我导入了下面未显示的 java.awt 和 javax.swing 库。）

```
public convertStringToCapitalLetters() {
    setTitle("Convert String to All Capital Letters");
    Container c = getContentPane();
    c.setLayout(new GridLayout(2, 2));

    inputLabel = new JLabel("Enter String: ", SwingConstants.LEFT);
    stringTextField = new JTextField(50);
    outputLabel = new JLabel("Capitalized String: ", SwingConstants.LEFT);
    newStringLabel = new JLabel("", SwingConstants.RIGHT);

    c.add(inputLabel);
    c.add(stringTextField);
    c.add(outputLabel);
    c.add(newStringLabel);

    inputHandler = new InputHandler();

    stringTextField.addActionListener(inputHandler);

    setSize(WIDTH, HEIGHT);
    setDefaultCloseOperation(EXIT_ON_CLOSE);
    setVisible(true);
}

private class InputHandler implements ActionListener {

    public void actionPerformed(ActionEvent e) {
        String str, newStr;

        str = stringTextField.getText();
        newStr = str.toUpperCase();

        newStringLabel.setText(String.format("", newStr));
    }
}

public static void main(String[] args) {
    convertStringToCapitalLetters capitalConv = new convertStringToCapitalLetters();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T22:19:59.367

我认为您只是犯了一个很小的错误，就是忘记`%s`在`String.format()`

试试这个：

```
newStringLabel.setText(String.format("%s", newStr)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T22:22:28.650

设置标签文本时不需要`String.format("", newStr)`调用，只需使用

```
newStringLabel.setText(newStr); 
```

# jquery - jQuery IE 9 日期选择器错误

> ID：13078073
> 
> 赞同：3
> 
> 时间：2012-10-25T22:08:19.970
> 
> 标签：jquery, jquery-ui, internet-explorer-9, jquery-ui-datepicker

我正在使用 jQuery 1.7.2 和 jQuery UI 1.8.18。我有一个在 Chrome 和 Firefox 中运行良好的页面，但在 IE 9 中运行良好。
我收到以下错误：

```
SCRIPT5007: Unable to get value of the property 'inline': object is null or undefined 
jquery-ui.min.js, line 12 character 29775 
```

它引用的代码是 datepicker 代码，所以这是我将 datepicker 添加到两个不同元素的方法（注意这是 inside `$(document).ready(function(){`）：

```
$('#revisedShipDate').datepicker({
    onSelect: revisedShipDate,
    dateFormat: "yy-mm-dd"
});

$('#nextCallDate').datepicker({
    dateFormat: "yy-mm-dd"
}); 
```

有没有人见过这个并且知道我能做些什么来解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T17:08:33.930

在使用 IE9 的日期选择器和我们网站的客户中遇到类似问题

我发现了什么：

如果操作系统是 64 位并且正在运行的 IE9 是 32 位版本（通过在浏览器 ID 字符串 (navigator.appVersion) 中查找 WOW64 来识别 ID，则日期选择器无法触发。

请参阅：[https ://forum.jquery.com/topic/datepicker-don-t-work-in-ie-9](https://forum.jquery.com/topic/datepicker-don-t-work-in-ie-9)

并查看： http: [//msdn.microsoft.com/en-us/library/ms537503](http://msdn.microsoft.com/en-us/library/ms537503(v=vs.85).aspx) (v=vs.85).aspx（大约在“功能令牌”下页面的一半）以获取 WOW64 参考

到目前为止，解决方案的选择似乎仅限于变通方法：

1.  使用元标记强制浏览器版本回到 7 或 8
2.  要求客户以兼容模式运行
3.  当从 64 位操作系统运行时，请客户确保他们运行的是 64 位版本的 IE9。

# node.js - Nodejs：迭代 req.files 属性

> ID：13078074
> 
> 赞同：4
> 
> 时间：2012-10-25T22:08:30.310
> 
> 标签：node.js

我对nodejs很陌生，有时我会遇到困难:)例如。我通过 AJAX 发送图像文件并在我的应用程序中成功接收。

console.log(req.files) 打印：

```
{
    img_1351078491675: {
        size: 354683,
        path: '/tmp/f29009b6dc914c2ab27e2c5fde13e7d8.jpg',
        name: 'nov10wallpaper-1_1600.jpg',
        type: 'image/jpeg',
        hash: false,
        lastModifiedDate: Wed Oct 24 2012 13: 36: 55 GMT + 0200(CEST),
        _writeStream: {
            path: '/tmp/f29009b6dc914c2ab27e2c5fde13e7d8.jpg',
            fd: 14,
            writable: false,
            flags: 'w',
            encoding: 'binary',
            mode: 438,
            bytesWritten: 354683,
            busy: false,
            _queue: [],
            _open: [Function],
            drainable: true
        },
        length: [Getter],
        filename: [Getter],
        mime: [Getter]
    }
} 
```

因为图像有一个时间戳，所以我无法使用 req.files.img_ 访问。所以我使用 for(file in reg.files) 来获取它（forEach 不起作用 - 不知道为什么。似乎是一个普通的哈希/对象）。但现在我的问题实际上开始了。如何读出该文件的属性？例如 file.path 不起作用。它返回“未定义”，但为什么呢？

有人可以给我一个提示以了解这些基础知识吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-25T22:23:55.767

我相信`forEach()`它适用于数组而不是对象，所以这可能就是为什么它不起作用。

如果只有（曾经）一个文件，那么：

```
var fileKey = Object.keys(req.files)[0];
var file = req.files[fileKey]; 
```

...要不就：

```
var file = req.files[Object.keys(req.files)[0]];` 
```

...将“向下挖掘一个级别”，以便您可以执行`file.path`或`file.type`. 如果有（或可能有）不止一个：

```
var files = [];
var fileKeys = Object.keys(req.files);

fileKeys.forEach(function(key) {
    files.push(req.files[key]);
}); 
```

这将为您提供一个“向下挖掘一个级别”的文件列表，您可以在其中`forEach()`.

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-27T11:57:22.413

我相信`forEach()`它适用于数组而不是对象，所以这可能就是为什么它不起作用。

如果只有（曾经）一个文件，那么：

如果上传是这样的多个文件，forEach() 可以解决问题：

控制台.log(文件[0].name);

控制台.log(文件[0].size);

我们可以给你一个循环来获取 req 文件 i=0>=文件长度

# java - 如何遍历整个 HashMap

> ID：13078077
> 
> 赞同：0
> 
> 时间：2012-10-25T22:08:36.093
> 
> 标签：java, hashmap, iterator

如果我需要使用的方法看起来像这样......

```
public void printMessages(Message mm) {
} 
```

我如何遍历看起来像这样的整个 HashMap...

```
HashMap<String, ArrayList<User>> hM = new HashMap<>(); 
```

向每个用户发送消息 mm 生成的 toString 消息？我被卡住了，谢谢你的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:16:11.520

要遍历地图，请在`entrySet()`

```
Map<K, V> map;
for (Map.Entry<K, V> entry : map.entrySet()) {
    // do something with the key/value
    K key = entry.getKey();
    V value = entry.getValue();
} 
```

但是，在您的情况下，我认为您*实际上*可能想要这个：

```
String message;
Map<String, List<User>> hM;

List<User> usersForMessage = hM.get(message);
for (User user : usersForMessage) {
    // send "message" to "user"
    user.sendMessage(message);  // for example
} 
```

# iphone - 在 Objective-C 中将 TypeDef 作为参数

> ID：13078078
> 
> 赞同：2
> 
> 时间：2012-10-25T22:08:37.030
> 
> 标签：iphone, objective-c, ios, cocoa-touch

我有一种情况，我`typedef enums`在我的常量文件中声明了多个相关：

```
typedef enum 
{
    AnimalTypeBear,
    AnimalTypeBunny,
    MemeTypeCount
} 
AnimalType;

typedef enum 
{
    FishTypeSalmon,
    FishTypeTrout,
    FishTypeCount
} 
FishType; 
```

现在我想为调用的初始化程序定义一个参数，该初始化`type`程序可以将这两个`typedef enums`作为参数。我目前将类型定义为 an`NSUInteger`并且无论我将哪种类型发送到初始化程序中，我都会得到 0（即 FishTypeTrout 应该是 1 但它是 0）。什么类型的对象应该`type`适用于两个`enter code here`typeDef 枚举？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T22:22:56.503

我不是 100% 确定你在问什么，但我尝试了以下代码：

```
typedef enum AnimalType : NSUInteger
{
    AnimalTypeBear,
    AnimalTypeBunny,
    MemeTypeCount
} AnimalType;

typedef enum FishType : NSUInteger
{
    FishTypeSalmon,
    FishTypeTrout,
    FishTypeCount
} FishType;

void TestFunction(NSUInteger at)
{
    printf("at = %d\n",at);
} 
```

当我打电话时它打印 1`TestFunction(FishTypeTrout);`

这有帮助吗？

# google-maps - 在地图上调用 fitBounds 函数时不要触发“zoom_changed”事件

> ID：13078082
> 
> 赞同：12
> 
> 时间：2012-10-25T22:08:50.883
> 
> 标签：google-maps, google-maps-api-3, dom-events

有没有办法防止`zoom_change`事件被触发，如果它发生是由于`fitBounds()`？

我遇到了一个问题，当地图发生缩放更改时，我需要从客户端在服务器上进行搜索，但是每次调用`fitBounds()`它都会导致`zoom_change`触发，从而导致客户端在服务器上进行另一次搜索。我只对用户完成的 zoom_change 感兴趣，而不是以编程方式使用`fitBounds`.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-25T22:57:17.223

当您在程序中执行 fitBounds 时，设置一个全局标志。当 zoom_changed 事件触发时，如果设置了标志，则清除它，否则将您的请求发送到服务器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-12-01T04:30:21.557

经过许多令人沮丧的小时，这是我的解决方案：

```
 var tiles_listener = google.maps.event.addListenerOnce(map, 'tilesloaded', function() {
    var zoom_listener = google.maps.event.addListener(map, 'zoom_changed', function() {
      reloadMarkers();
    });
  }); 
```

请注意，我要求`addListenerOnce`确保`tilesloaded`仅在第一个完成`zoome_changed`后添加一次侦听器。`fitBounds`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-26T14:06:54.423

这是一个老问题，但它可能对其他人有用。我遇到了同样的问题，`zoom_changed`每次`fitBounds`在向地图添加多个标记时调用 () 时都会触发。我所做的是`map_changed`在地图完全加载后将监听器添加到事件中，如下所示：

```
google.maps.event.addListener(map, 'tilesloaded', function() {
    google.maps.event.addListener(map, 'zoom_changed', function() { 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-09-18T06:39:24.067

There is another way to do that by removing that that event. I think it would be much easier and cleaner than adding a global variable.

```
 vm.map.events.bounds_changed = function() {
   google.map.event.removeListener(zoom_changed);
   } 
```

Another way (forgotten to add that):

```
 vm.map.events.bounds_changed = function() {
google.map.event.addEventListener(zoom_changed,function(mapper,eventName,args){});
           } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-14T06:22:17.643

`setZoom()`在我的应用程序中，我可以通过、`fitBounds()`或以编程方式触发缩放更改事件`setOptions()`。

```
MAN = {};
MAN.globalMap = google.maps.Map(document.getElementById('map')); 
```

然后，我通过包装函数路由所有编程调用以设置缩放，这些函数`false`在继续设置缩放之前将标志翻转到。

```
MAN.savedZoom = MAN.globalMap.getZoom();
MAN.saveZoomFlag = true;
// we want it to always be true, unless zoom was
// changed programatically.

MAN.setZoom = function setZoom(zoomLevel) {
  console.log("won't save that I'm setting zoomLevel to " + zoomLevel);
  this.saveZoomFlag = false;
  MAN.globalMap.setZoom(zoomLevel);
};

MAN.fitBounds = function fitBounds(bounds) {
  console.log("setting bounds, won't save zoomlevel.");
  this.saveZoomFlag = false;
  MAN.globalMap.fitBounds(bounds);
};

MAN.setOptions = function setOptions(options) {
  console.log("setting options, won't save zoomlevel.");
  this.saveZoomFlag = false;
  MAN.globalMap.setOptions(options);
}; 
```

I then declare a listeners. At first I was declaring only the first, and was puzzled that it wasn't working:

```
 google.maps.event.addListener(
    MAN.globalMap,
    'zoom_changed',
    function zoom_changed_listener() {
      console.log(
        "zoom changed to " +
        MAN.globalMap.getZoom() + "; " +
        (MAN.saveZoomFlag ? "saving." : "not saving.")
      );
      if (MAN.saveZoomFlag) {
        console.trace("saving");
        MAN.savedZoom = MAN.globalMap.getZoom();
      }
      MAN.saveZoomFlag = true;
    }
  ); 
```

you may also find the `idle` event helpful, however, if you're just trying to avoid the initial set. See more about the maps events here: [https://developers.google.com/maps/documentation/javascript/events](https://developers.google.com/maps/documentation/javascript/events)

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2012-10-26T03:55:18.833

我想这应该很简单。有一个变量说

```
var z = map.getZoom(); //scope this variable appropriately(somewhere before you call the fitbounds() 
```

然后在 map.fitbounds() 之后立即执行

```
map.setZoom(z); //this automatically changes the zoom level back to the previous level 
```

# c# - 将javascript传递的json反序列化到c#

> ID：13078090
> 
> 赞同：0
> 
> 时间：2012-10-25T22:09:24.807
> 
> 标签：c#, javascript, json

我目前正在尝试以这种方式反序列化由 javascript 提供的 json：

```
window.external.handlemessage(json); 
```

它由 c# 处理，如下所示：

```
 public void handlemessage(string json)
   {
            JavaScriptSerializer deserializer = new JavaScriptSerializer();

            Dictionary<string, object> deserializedDictionary1 = (Dictionary<string, object>)deserializer.Deserialize(json, typeof(object));
            Dictionary<string, object> deserializedDictionary2 = deserializer.Deserialize<Dictionary<string, object>>(json);
            object objDeserialized = deserializer.DeserializeObject(json);

   } 
```

例如，传递适用于纯文本，但不适用于 json..

我已经尝试了几件事，例如我在句柄消息中提供的反序列化示例，但 json 基本上只是返回无效。我尝试过的其他几个例子也没有做到。

我试图用java反序列化json并再次序列化它没有结果（以防有一些缺陷）。

我也试图在不知道 json 结构的情况下反序列化数据。

甚至可以通过javascript传递json并用c#反序列化它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:13:07.157

> 我也试图在不知道 json 结构的情况下反序列化数据。

为此，您想使用 C# 的`dynamic`类型：

```
JavaScriptSerializer js = new JavaScriptSerializer();
dynamic v = js.Deserialize<dynamic>("{\"text\" : \"hi\"}"); 
```

事实上，您可以从那里开始处理所有数据，直到您了解对象是如何映射的。

# ms-access - Access VBA：在窗体上迭代控件，仅显示某些控件类型具有的属性

> ID：13078094
> 
> 赞同：2
> 
> 时间：2012-10-25T22:09:52.433
> 
> 标签：ms-access, vba

我正在尝试遍历窗体上的控件以显示那些支持 ControlSource 的控件的 ControlSource 属性。

我发现识别具有 ControlSource 属性的控件相对容易。问题在于访问这些控件的属性。通用 Control 对象没有 ControlSource 属性。如果我使用另一种语言，我只需将作为列表框的控件强制转换为 ListBox 对象，例如，访问 ControlSource 属性。但我的理解是，在 VBA 中没有类型继承，所以我不能将一种类型的对象转换为另一种类型的对象。

那么如何访问那些支持该属性的控件的 ControlSource 属性呢？

到目前为止，这是我的代码：

```
Private Sub IterateControlsOnForm()
Dim frm As Form, formName As String
' The only controls that have a ControlSource property are either
'   BoundObjectFrame controls or ListBox controls.
Dim ctrl As Control
Dim boundObjectFrame As boundObjectFrame, listBoxCtrl As listBox
Dim boundObjectFrameTypes() As String, listBoxTypes() As String
Dim ctrlType As String

    formName = "MAINFORM"

    ' Useful way of populating a string array - use Split function.
    '   Array function only works with Variants.
    boundObjectFrameTypes = _
        Split("CheckBox,ComboBox,CustomControl,GroupLevel", ",")
    listBoxTypes = Split("OptionButton,OptionGroup,TextBox,TextBox", ",")

    ' Assumes form is open.
    Set frm = Forms(formName)
    For Each ctrl In frm.Controls
        ' Ignore controls that do not have a ControlSource property.
        ctrlType = TypeName(ctrl)
        If IsStringInArray(ctrlType, boundObjectFrameTypes) Then
            ' **** FOLLOWING LINE FAILS ****
            Set boundObjectFrame = ctrl
            Debug.Print boundObjectFrame.Name & "(" & ctrlType & ") " & _
                "ControlSource Property: " & boundObjectFrame.ControlSource
        ElseIf IsStringInArray(ctrlType, listBoxTypes) Then
            ' **** FOLLOWING LINE FAILS ****
            Set listBoxCtrl = frm.Controls(ctrl.Name)
            Debug.Print listBoxCtrl.Name & "(" & ctrlType & ") " & _
                "ControlSource Property: " & listBoxCtrl.ControlSource
        End If
    Next ctrl
End Sub 
```

我尝试了两种将通用 Control 对象转换为具有 ControlSource 属性的更具体控件的方法。请参阅两条评论“ **** FOLLOWING LINE FAILS **** ”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T22:22:35.410

使用对象怎么样？

```
Private Sub IterateControlsOnForm()
Dim frm As Form, formName As String
' The only controls that have a ControlSource property are either
'   BoundObjectFrame controls or ListBox controls.
Dim ctrl As Control
Dim boundObjectFrame As Object, listBoxCtrl As Object
Dim boundObjectFrameTypes As String, listBoxTypes As String
Dim ctrlType As String

    formName = "MAINFORM"

    ' Useful way of populating a string array - use Split function.
    '   Array function only works with Variants.
    boundObjectFrameTypes = _
        ",CheckBox,ComboBox,CustomControl,GroupLevel"
    listBoxTypes = ",OptionButton,OptionGroup,TextBox,TextBox"

    ' Assumes form is open.
    Set frm = Forms(formName)
    For Each ctrl In frm.Controls
        ' Ignore controls that do not have a ControlSource property.
        ctrlType = TypeName(ctrl)
        If InStr(boundObjectFrameTypes, "," & ctrlType) Then
            Set boundObjectFrame = ctrl
            Debug.Print boundObjectFrame.Name & "(" & ctrlType & ") " & _
                "ControlSource Property: " & boundObjectFrame.ControlSource
        ElseIf InStr(listBoxTypes, "," & ctrlType) Then
            Set listBoxCtrl = frm.Controls(ctrl.Name)
            Debug.Print listBoxCtrl.Name & "(" & ctrlType & ") " & _
                "ControlSource Property: " & listBoxCtrl.ControlSource
        End If
    Next ctrl
End Sub 
```

使用 VBA，您还可以使用 On Error Resume Next，尽管我同意通常最好避免错误。

```
formName = "MAINFORM"

Set frm = Forms(formName)
For Each ctrl In frm.Controls
On Error Resume Next
    Debug.Print ctrl.Name _
        & " ControlSource Property: " & ctrl.ControlSource
    If Err.Number = 438 Then
        Err.Clear
    End If
Next 
```

# iphone - 动态改变 UILabel 高度错误

> ID：13078097
> 
> 赞同：0
> 
> 时间：2012-10-25T22:10:07.030
> 
> 标签：iphone, ios, xcode, uilabel

我正在根据文本更改 UILabel 高度。它工作得很好，但我发现如果字体大小大于 19.0f 则无法加载。如果我改变它没关系，但我给了用户改变字体大小的选项，所以......

它开始重叠视图，混乱视图，这里是示例： ![在此处输入图像描述](../Images/143256820bf585c343996e74c36abb02.png)

这是我用来调整标签大小的代码：

```
-(float)resizeToFit{
    float height = [self expectedHeight];
    CGRect newFrame = [self frame];
    newFrame.size.height = height;
    [self setFrame:newFrame];
    return newFrame.origin.y + newFrame.size.height;
}

-(float)expectedHeight{
    [self setNumberOfLines:0];
    [self setLineBreakMode:UILineBreakModeWordWrap];

    CGSize maximumLabelSize = CGSizeMake(self.frame.size.width,9999);

    CGSize expectedLabelSize = [[self text] sizeWithFont:[self font] 
                                            constrainedToSize:maximumLabelSize
                                            lineBreakMode:[self lineBreakMode]]; 
    return expectedLabelSize.height;
} 
```

谢谢！

# html - 如何更改 rails 中 text_field 的长度？

> ID：13078098
> 
> 赞同：10
> 
> 时间：2012-10-25T22:10:13.470
> 
> 标签：html, css, ruby-on-rails-3, textfield

所以我有这个文本字段

```
<%= f.text_field :body, placeholder: "Make an offer ", :maxlength=>"254" %> 
```

现在它占据了它所在盒子宽度的 100%。我希望它占据 95%。到目前为止，我已经尝试过（来自其他论坛帖子）

添加`:columns => "50"`这个并没有影响它。我尝试放置一个 html 标签，`:html => { :id => "offer_form" }`然后放入我的 css 文件

```
#offer_form { width:50%;} 
```

这没有用

还有其他建议吗？

编辑：

我意识到在我的css文件中我有/ *forms* /

```
input, textarea, select, .uneditable-input {
  border: 1px solid #bbb;
  width: 98%;
  padding: 10px;
  height: auto !important;
  margin-bottom: 15px;

} 
```

当我在这里更改宽度时，它可以工作。但它会影响整个应用程序中的所有表单（显然）（即它们都是 98%）。有没有办法我可以只识别这个字段，以便我可以独立编辑它的宽度。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-25T22:25:23.690

`:size=>"50"`向 text_field添加选项

```
<%= f.text_field :body, :size=>"50", placeholder: "Make an offer ", :maxlength=>"254" %> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-25T22:14:12.160

使用 CSS。字段的宽度与其最大字符数无关。

```
input.body {
  width:95%;
} 
```

# c++ - strcpy/strcat 奇怪字符输出

> ID：13078100
> 
> 赞同：1
> 
> 时间：2012-10-25T22:10:23.293
> 
> 标签：c++, operator-overloading

我有以下自定义`String`类的代码：

```
const String &String::operator+(const String &right)
{
   String temp;
   temp.length = length + right.length;
   temp.sPtr = new char [temp.length + 1];
   assert( sPtr != 0 );
   strcpy(temp.sPtr, sPtr);
   strcat(temp.sPtr, right.sPtr);
   return temp;
} 
```

哪里`sPtr`是`char*`。

但是，当我在两个字符串上执行此函数时，我会得到垃圾字符，如下所示：

```
 ]√Hâ«Ö“xË˜" = "The date is" + " August 1, 1993 
```

我一点也不知道发生了什么。我已经阅读了一些在结果字符串被连接之前得到垃圾字符的人的推荐，但我完全不明白为什么整个字符串都是垃圾字符。

任何帮助都会非常棒。提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T22:16:46.803

不要通过引用返回“临时”对象。一旦函数结束，临时字符串就会被释放，并且由于字符串被设置为临时地址，它就变成了垃圾。

# asp.net-mvc-3 - 如何在 mvc3 应用程序中更新淘汰模型

> ID：13078103
> 
> 赞同：0
> 
> 时间：2012-10-25T22:10:36.417
> 
> 标签：asp.net-mvc-3, knockout.js

我已经用 KnockoutJs 玩 MVC3 几个星期了，我一直在想一些事情

说我有一个 mvc 动作，它返回一个简单的列表

```
public ActionResult AddFoos()
{
    List<Foo> funds = new List<Foo>();     
    .. etc
    return Json(funds.ToList(), JsonRequestBehavior.AllowGet);
} 
```

然后将其传递给视图模型

```
var viewModel = {
  fooChocies: ko.mapping.fromJS([]),
  fooOptions: ko.mapping.fromJS([]),
    loadInitialData: function () {

        ko.mapping.fromJS(serverData, dataMappingOptions, viewModel.fooOptions);
    },
}; 
```

在我的 Foo 类型中，我还有显示或隐藏 ui 元素的属性

```
var Foo = function (data, preselect) {

    var self = this;
    self.id = ko.observable(data.id);
    self.Name = ko.observable(data.Name);
    self.number = ko.observable('');

    self.showProducts = ko.observable(false);   <---
    self.displayBigPanel = ko.observable(false);  <---

   } 
```

到目前为止，我的方法是动态创建表单的元素

它通过 ModelBinder 并创建一个 List< Foo > 作为控制器操作的参数。

最后的**问题**...

当用户导航回此页面时，我需要使用用户创建的 fooChoices 恢复 UI。

似乎我有两个选择来重建用户选择（都通过扩展方法）

1.  使用原始 json，如

    ```
    ko.toJSON(viewModel.fooChoices)) 
    ```

除了基本的模型属性之外，它还提供了关于隐藏和显示 UI 元素的信息，

```
 sb.Append("viewModel.fooCghoices= ko.mapping.fromJS(" + json + ");");
            sb.Append("ko.applyBindings(viewModel);");
            return new HtmlString(sb.ToString()); 
```

从而将客户端 ui 信息发送到服务器并返回

或者

1.  直接操作 ViewModel 以模拟用户操作

    ```
     sb.Append("viewModel.fooChoices.push(new Foo(1509));");
            sb.Append("viewModel.fooChoices()[0].selectedSubFoo = new Foo(273);");
            sb.Append("viewModel.fooChoices()[0].showProducts(true);"); 
    ```

无论哪种情况，它都感觉有点不对劲，而且有更好的模式。想知道一种方法是否比另一种更好，或者以上都没有。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T11:06:46.140

目前，您的控制器方法返回一个`Foo`. 考虑创建一个更复杂的对象，该对象同时包含您的 Foo 和您的选择。

```
public class FooViewModel 
{
  public List<Foo> Foos { get; set; };
  public UserChoices { get; set; }
} 
```

更改您的控制器方法，使其返回`FooViewModel`. 这意味着用户选择将与您感兴趣的任何 Foo 一起返回。

```
public ActionResult AddFoos()
{
    // Are there any choices stored in session?
    // Use those first, otherwise create a new UserChoices object
    UserChoices choices = 
        Session["User.Choices"] as UserChoices ?? new UserChoices();

    List<Foo> funds = new List<Foo>();     
    .. etc

    FooViewModel vm = new FooViewModel() { Foos = funds; UserChoices = choices };

    // Return the whole object, containing Choices and Foos
    return Json(vm, JsonRequestBehavior.AllowGet);
} 
```

此外，考虑某种动作过滤器，让您轻松传递完整的对象。ObjectFilter 是一个很好的方法。它允许您轻松传递复杂的对象结构，而无需依赖特定的标记。

[http://www.c-sharpcorner.com/blogs/863/passing-json-into-an-asp-net-mvc-controller.aspx](http://www.c-sharpcorner.com/blogs/863/passing-json-into-an-asp-net-mvc-controller.aspx)

ObjectFilter 上面的一个控制器方法。很简单，只是声明控制器应该尝试将任何传入的参数`fooStuff`视为 type `FooViewModel`。

```
 [HttpPost, 
     ObjectFilter(Param = "fooStuff", RootType = typeof(FooViewModel)), 
     UnitOfWork]
    public JsonResult ProcessFoos(FooViewModel fooStuff) { 
```

通过定义相应的 JavaScript 视图模型，您可以将整个内容转换为 json 字符串并将其传递给完全填充的控制器方法。

因此，相应的 js vm 的示例是：-

```
var fooViewModel = function(data) {
  var self = this;
  self.Foos = ko.observableArray(data.Foos);
  self.UserChoices = ko.observable(data.UserChoices);

  // Don't worry about properties or methods that don't exist
  // on the C# end of things.  They'll just be ignored.
  self.usefulJSOnlyMethod = function() {
    // behaviour
  };
}

var userChoice = function(data) {
  var self = this;
  self.DinnerId = ko.observable(data.DinnerId);
} 
```

对由修饰的控制器方法的典型调用`ObjectFilter`将是这样的（假设 self 是 a `fooViewModel`）：-

```
var queryData = ko.mapping.toJSON(self);
$.ajax(
   //...
   data: queryData, 
```

来自 js vm 的任何匹配（相同名称，相同类型区分大小写）属性将自动结束在`fooStuff`您的控制器方法的参数中。是时候保存这些选择了：-

另请注意，我在此处的会话中保留了用户选择。这将允许它们被可能需要它们的任何其他控制器方法拾取（上面的 AddFoos 中的示例）。

```
 [HttpPost, 
     ObjectFilter(Param = "fooStuff", RootType = typeof(FooViewModel)), 
     UnitOfWork]
    public JsonResult ProcessFoos(FooViewModel fooStuff) 
    {
        // hey!  I have a fully mapped FooViewModel right here!
        // ( _fooServices.ProcessFoos will return updated version of viewmodel )
        FooViewModel vm = _fooServices.ProcessFoos(fooStuff);

        // What about those choices?
        // Put them in the session at this point in case anyone else comes asking
        // after them.
        Session["User.Choices"] = vm.UserChoices;

        return Json(vm);
    } 
```

因为我们已经：-

*   定义了更好的 C# 视图模型
*   定义了对应的JS视图模型
*   包括 UserChoices 作为该视图模型的一部分

....在这一点上恢复选择很简单。引用视图模型中包含用户选择的部分。

```
<select id="dinnerChoice"
   data-bind="value: UserChoices.DinnerId"
>
</select> 
```

# c# - 如何在不保存到数据库的情况下对 SaveInfo 方法进行单元测试

> ID：13078105
> 
> 赞同：0
> 
> 时间：2012-10-25T22:10:41.930
> 
> 标签：c#, unit-testing

这是我的课：

```
public class AuditInfo
{
    public String ActionDescription { get; set; }
    public String ActionWho { get; set; }
    public BasicProjectProfile Project { get; set; }

    public AuditInfo ()
    { }

    public void SaveInfo ()
    {
        using (CIHEntities _dbContext = new CIHEntities())
        {
            AuditInfoEntity aie = new AuditInfoEntity();
            aie.ActionDescription = this.ActionDescription;
            aie.ActionWhen = DateTime.Now;
            if (this.ActionWho != null)
            {
                aie.ActionWho = this.ActionWho;
            }
            else
            {
                aie.ActionWho = "Not Specified";
            }
            aie.ProjectAssoc = _dbContext.ProjectEntity
                .Where(r => r.Id == this.Project.Id)
                .First();
            _dbContext.SaveChanges();
        }
    }
} 
```

`CIHEntities`是一个实体框架数据库。

我想对 SaveInfo 方法进行单元测试，但它实际上不应该保存到数据库中。如何才能做到这一点？

谢谢

埃里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T22:26:09.680

```
Given : that Id don't know what is the interface of CIHEntities
When : Unit Test is required for AuditInfo.SaveInfo
Then : inject the interface of CIHEntities from constructor of AuditInfo
Then : create a mock of CIHEntities from its interface and use it for Unit Test 
```

请模拟期望并验证使用模拟库（例如 Moq）调用了 SaveChanges

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:30:24.730

使用存储库模式并将保存实体的责任转移到存储库：

```
public class AuditInfo
{
    public String ActionDescription { get; set; }
    public String ActionWho { get; set; }
    public BasicProjectProfile Project { get; set; }
} 
```

为您的存储库编写一个接口：

```
public interface IRepository
{
    void Save();
} 
```

然后你的实现：

```
public RealRepository : IRepository
{
    public void SaveInfo ()
    {
        using (CIHEntities _dbContext = new CIHEntities())
        {
            AuditInfoEntity aie = new AuditInfoEntity();
            aie.ActionDescription = this.ActionDescription;
            aie.ActionWhen = DateTime.Now;
            if (this.ActionWho != null)
            {
                aie.ActionWho = this.ActionWho;
            }
            else
            {
                aie.ActionWho = "Not Specified";
            }
            aie.ProjectAssoc = _dbContext.ProjectEntity
                .Where(r => r.Id == this.Project.Id)
                .First();
            _dbContext.SaveChanges();
        }
    }
} 
```

然后让您的将存储库作为参数的客户端代码将是这样的

```
public class MyClient{

    IRepository _repository;

    public MyClient(){
        _repository = new RealRepository();
    }

    public MyClient(IRepository repository)
    {
        _repository = repository;
    }

    public void Main(){
         AuditInfo entity = new AuditInfo();
         //do whatever you want
         _repository.Save();
    }
} 
```

您的真实应用程序可以使用默认构造函数，该构造函数将使用 RealRepository，而您的单元测试可以传递不与数据库对话的 Fake Repository 实现（甚至更好地使用像 Moq 这样的 Mocking 框架）。

这是基本概念，您可以将其改进为具有通用存储库，使用 UoW 模式...您可以在这篇 msdn 文章中阅读更多信息：可测试性[和 EF](http://msdn.microsoft.com/en-us/library/ff714955.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T12:40:02.257

使用[TransactionScope](http://msdn.microsoft.com/en-us/library/system.transactions.transactionscope.aspx)。除非您实际提交更改，否则不会将其添加到数据库中。这就是我在单元测试中使用的，它完美地工作。

要使用它，您必须添加对 System.Transactions 的引用，然后您可能会收到一些 Windows 错误。如果我没记错的话，你必须启动一些 Windows 服务。但是，当你走到那一步时，谷歌它。

# javascript - 每次单击都向关联数组添加新元素

> ID：13078111
> 
> 赞同：3
> 
> 时间：2012-10-25T22:11:06.533
> 
> 标签：javascript, jquery, arrays, object, associative-array

这可能很容易，但我现在不知道如何解决它。每次单击提交按钮时，下面的函数都会检查输入字段 1（名称），如果不为空，则将值添加到关联数组中，然后继续描述。

我想要的是在每次点击时向数组添加一个新的 1 级元素，它应该保存这些值，以便在点击三下后它看起来像这样：

```
Click 1:
    listObject[0]['listObjectName'] = 'Name 1';
    listObject[0]['listObjectDesc'] = 'Desc 1';

Click 2:
    listObject[1]['listObjectName'] = 'Name 2';
    listObject[1]['listObjectDesc'] = 'Desc 2';

Click 3:
    listObject[2]['listObjectName'] = 'Name 3';
    listObject[2]['listObjectDesc'] = 'Desc 3'; 
```

**功能：**

```
$('#addListObjectSubmit').click(function (e) {

            var listObjectName = $('#m_newListObject').val();

            if((listObjectName == null) || (listObjectName == '')) {
                return false;
            }
            else {
                listObjects['listObjectName'] = listObjectName;

                var listObjectDesc = $('#m_newListObjectDesc').val();

                if ((listObjectDesc == null) || (listObjectDesc == '')) {
                    listObjects['listObjectDesc'] = null;
                }
                else {
                    listObjects['listObjectDesc'] = listObjectDesc;
                }
            }

            e.preventdefault();
        }); 
```

那么，处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T22:14:20.170

如果您忘记关联数组，它将对您有所帮助。它们仅理论上存在于 Javascript 中。事实上，一切都是对象，甚至是数组。但是从数据存储的角度考虑，你可以使用一个只能用数字索引的简单[数组](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array)，也可以使用一个[对象](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Working_with_Objects)作为数据映射。

以下示例创建一个数组（注意更紧凑`[]`的而不是`new Array()`）并将地图（使用 创建）[推](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/push)`{}`入其中：

```
var listObjects = [];
...
var newElem = {
    'listObjectName' : 'Name 1',
    'listObjectDesc' : 'Desc 1'
};
listObjects.push(newElem); 
```

之后，`listObjects[0]`如果它是数组中的第一个元素，您可以使用 访问该元素。

如果要访问其属性，可以使用以下之一：

```
listObjects[0].listObjectName
listObjects[0]['listObjectName'] 
```

所以你可以看到，在处理对象时，你可以使用`.`符号和括号符号——它们是等价的，但后一种形式使它看起来像是一个“关联数组”（对于来自 PHP 的人来说更是如此） .

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T22:16:02.143

..您的意思是，您想在每次点击时将“关联数组”（它们在 JavaScript 中称为“对象”，顺便说一句）添加到数组中？

向数组添加东西的方法是`push()`：

```
listObject.push({
    'listObjectName': 'Name X',
    'listObjectDesc': 'Description X'
}) 
```

# iphone - iOS - 设置锁屏图片

> ID：13078112
> 
> 赞同：0
> 
> 时间：2012-10-25T22:11:13.160
> 
> 标签：iphone, ios, lockscreen

我打算使用[MPNowPlayingInfoCenter](http://developer.apple.com/library/ios/#documentation/mediaplayer/reference/MPNowPlayingInfoCenter_Class/Reference/Reference.html) API 在锁定屏幕上设置图像。

我可以在不实际播放任何音频的情况下执行此操作吗？我只想更改锁定屏幕图像。

如果我能在技术上做到这一点，你认为苹果会让它进入应用商店吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T23:45:02.793

除非您不打算将其作为内部应用程序发布，否则您不应该以编程方式更改锁定屏幕图像。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T22:14:26.403

不会。即使您设法做到了，Apple 也不会接受您的应用程序。

# java - 最佳实践 - 基于用户选择构建查询

> ID：13078116
> 
> 赞同：2
> 
> 时间：2012-10-25T22:11:28.307
> 
> 标签：java, sql, database, oracle

我正在创建一个基于 Web 的小型工具，允许用户以各种方式查询大型查找表。由于它是一个小工具，我使用的是 JSP/Servlets。

查找表的定义如下：

第 1 列 | 第 2 列 | 第 3 列 | 日期 | 用户 | 数数

用户可以按列值或范围查询。此外，结果可以按特定列排序。因为该表有几十万条记录，并且增长迅速，所以我使用 Oracle 的 ROWNUM 并且只返回一小部分结果。

我有一个从用户那里获取搜索条件的表单页面。我根据一系列条件生成查询，例如：

```
query = "SELECT * FROM mytable WHERE 1=1 "
if(searchCriteria1 != "")
    query += "AND column1='searchCriteria1' "
if(searchCriteria2 != "")
    query += "AND column2='searchCriteria2' "
if(searchCriteria2 != "")
    query += "AND column2='searchCriteria2' "
if(searchCriteria3 != "")
    query += "AND column3='searchCriteria3' "
if((searchCriteria4 != "") && (searchCriteria5 != ""))
    query += "AND date>='searchCriteria4' AND date<='searchCriteria5' "
etc... 
```

（这只是简化的伪代码）

在显示第一个结果页面后处理排序。用户单击该页面的列标题以按该列排序。这将是回发并查询数据库。基本上，我在上面运行相同的代码，但最后是这样的：

```
if(sortColumn1)
    query += "ORDER BY column1"
if(sortColumn2)
    query += "ORDER BY column2"
if(sortColumn3)
    query += "ORDER BY column3" 
```

因此，正如您可能想象的那样，我的查询构建代码在所有这些不同的条件下都很长。关于更好的方法来做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T22:29:17.937

字符串连接不是 SQL 的最佳选择。您可以做的最好的事情是使用[QueryDSL](http://www.querydsl.com/)或[JOOQ](http://www.jooq.org/)并以 OO 方式进行。我对 QueryDSL 比较熟悉。看看[这里](http://blog.mysema.com/2011/01/querying-in-sql-with-querydsl.html)的例子。

```
SQLQuery query = new SQLQueryImpl(connection, dialect); 
query.from(myTable);

BooleanBuilder wheres = new BooleanBuilder();

if(notBlank(searchCriteria1))
   wheres.and(myTable.column1.eq(searchCriteria1));
if(notBlank(searchCriteria2))
   wheres.and(myTable.column2.eq(searchCriteria2));
if(notBlank(searchCriteria4) && notBlank(searchCriteria5))
   wheres.andAllOf(myTable.date.goe(searchCriteria4),  myTable.date.loe(searchCriteria5));  //you may want to use myTable.date.between(...)

if (...) {
   query.orderBy(myTable.column1.asc());
} else if (...){
   query.orderBy(myTable.column2.asc());
}

query.limit(100); //it is good to limit a result
query.list(myTable.all()); 
```

至于 SQL 注入查询引擎将在构造 SQL 时将您的参数包装在命名参数中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T22:37:56.890

首先，不要使用简单`String`的查询。您应该使用[PreparedStatement](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html)，它可以保护您免受[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)（恶意用户破坏易受攻击系统的一种非常简单的方法）。

`if()... else if()...`其次，如果您的输入确实如此复杂，那么您将无法避免阻塞。看起来你的方法做得比它应该做的要多得多。考虑根据用户想要运行的查询类型调用不同的方法。我已经实现了许多 DAO，在向子句`if`添加行时，无法绕过块中的所有这些空检查。`AND``WHERE`

但是，您绝对可以做的一件事是将大部分查询写在一个`private static final String`带有问号的常量中，您希望参数为 ( `?`)，根据用户输入附加您需要的其他条件，然后`PreparedStatement`直接从中构建。一旦你制作了s `PreparedStatement`，你可以使用各种 setter 命令来填充那些`?`s。这对代码进行了相当多的整理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T22:21:06.763

永远不要使用字符串连接将用户输入的数据放入您的查询中。您应该在查询中使用命名参数或位置参数并传递参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T22:16:24.477

我认为向后端发送请求进行排序不是一个好主意。js中有很多插件可以对表格进行排序，可以使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T22:16:41.660

从简单的角度

如果您知道所有类型的列，则可以使用数组和表来使此代码更多地由数据驱动。

# jquery - 文本框更改事件未在 chrome 中触发

> ID：13078122
> 
> 赞同：3
> 
> 时间：2012-10-25T22:12:12.413
> 
> 标签：jquery, google-chrome, textbox, onchange

我有一个文本框

```
<input name="tx1" size="10" type="text" id="tx1" class="sample dynamic format" maxlength="10" /> 
```

文本框更改和 keyup 事件绑定到两个不同的函数。

```
$('.sample.dynamic').change(myJsFunction);

$('.format').keyup(function (e) {
        formatfn(this, e);

    }); 
```

这是我的格式：

```
function formatfn(sValue, e) {

//Do some formatting

$(sValue).val(newVal);

return newVal;

} 
```

这两个事件在 IE 和 firefox 中工作正常，但在 chrome 中只有 keyup 功能正在工作，并且不会触发更改事件。

**如果我在formatfn**中评论以下行，那么更改事件也开始在 chrome 中触发。

```
//$(sValue).val(newVal); 
```

但我不能评论这一行，因为我需要在每个按键上应用格式。

我在[这里](https://stackoverflow.com/questions/6362052/onchange-event-not-firing-on-a-textbox-in-chrome)和[这里](https://stackoverflow.com/questions/11422210/jquery-on-change-event-for-textbox-class-not-working-in-chrome)看过两个类似的问题，但找不到答案。

**更新**： Formatfn 正在做各种格式化工作，但只是为了让您了解**newval**变量，我在这里添加了一些相关代码：

```
var newVal = $(sValue).val();

if (newVal != "")
        newVal = parseInt(RemoveCommas(newVal), 10).toString();

    var sRegExp = new RegExp('(-?[0-9]+)([0-9]{3})');

    while (sRegExp.test(newVal)) {
        newVal = newVal.replace(sRegExp, '$1,$2'); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T22:51:56.573

您始终可以使用模糊来滚动自己的更改功能：

```
$('.sample.dynamic').data('last','').on('blur', function() {
    var last = $(this).data('last');
    if (this.value!=''&&this.value!=last) myJsFunction();
    $(this).data('last', this.value);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-30T17:39:45.437

同意这与 Chromium 开发网站上现有报告的错误一致，这些错误与以编程方式更改值时未触发的 onchange 事件相关。这些已被确认为 r36 和 r37 (canary) 中的回归/错误。建议在关于 Google Chrome 菜单项中检查您的版本。

关键：[https ://code.google.com/p/chromium/issues/detail?id=92492](https://code.google.com/p/chromium/issues/detail?id=92492)

更改：[https ://code.google.com/p/chromium/issues/detail?id=378871](https://code.google.com/p/chromium/issues/detail?id=378871)

一个简单的解决方法可能是让您的处理程序在模糊而不是更改上执行，这样可以避免前面答案中提到的 onchange 事件失败。另一个示例是在模糊时显式触发更改事件。

```
$('.sample.dynamic').on("blur", function(e){ 
     $(this).change();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-10T11:18:25.557

实际上，如果“keyup”事件更改了某些内容，Google Chrome 上有一个错误会导致“更改”事件不会触发：

[https://code.google.com/p/chromium/issues/detail?id=92492](https://code.google.com/p/chromium/issues/detail?id=92492)

自 2013 年 5 月 2 日以来，该问题似乎已公开。

# asp.net-mvc - ASP.NET MVC3 Aspnetdb Sql 生产服务器

> ID：13078123
> 
> 赞同：1
> 
> 时间：2012-10-25T22:12:41.053
> 
> 标签：asp.net-mvc, database-connection, aspnetdb

我创建了一个功能齐全的 Web 应用程序（MVC MusicStore，从这里下载：http: [//mvcmusicstore.codeplex.com/](http://mvcmusicstore.codeplex.com/)）。

该应用程序创建了一个 ASPNETDB.MDF 文件和一个 MusicStoreDB.mdf 文件。我使用了 SQL Server Management 2008 R2。

问题是我在主机服务器上部署应用程序后，单击“注册”链接时，会显示默认错误页面。尝试登录时，再次显示默认错误页面。主机服务器（与 SQL 2008 兼容）似乎可以从 MusicStoreDB.mdf 文件中读取数据，但无法访问 ASPNETDB.MDF 文件。无法登录或注册用户。

我确实将 web.config 文件中的连接字符串更改为主机服务器地址，它工作正常。我还使用 aspnet_regsql 在 MusicStoreDB 中创建了 ASPNETDB 表，但错误仍然存​​在。此外，MusicStoreDB 文件在发布后不包含任何数据（尽管 cs 文件中有示例数据）。我知道主机服务器可以从此文件中读取数据，因为我通过本地 SQL 服务器手动添加了数据。

我有两个问题：正确部署应用程序和数据库以便可以注册和登录的步骤是什么？*两个*mdf 文件如何协同工作？湾。SampleData.cs 文件中的数据如何在 MusicStoreDB.mdf 文件中重新创建？

尽管我已经搜索了一周，但我一直无法通过网络找到答案...

# log4j - 如何在 web.xml 中使用 Jetty 服务器定义多个 log4j 配置

> ID：13078129
> 
> 赞同：1
> 
> 时间：2012-10-25T22:13:05.250
> 
> 标签：log4j, jetty, config, web.xml

这就是我想要做的： - 能够为每个不同的部署“战争”分离 log4j.properties - 能够在 ant build 或 web.xml 中使用系统参数定义要使用的日志属性。

我的项目设置是带有 Jersey 作为 REST API 的 Jetty，没有 Spring。

我做了一些研究，结果发现在 webl.xml 中设置了其他 Spring 解决方案，但我没有使用 spring。我也知道 Jetty 正在使用 slf4j，但如果切换到 slf4j，我能更轻松地做到这一点吗？

解决这个问题的最佳方法是什么，以便在 web.xml 或 ant 构建中，可以自定义定义 log4j 配置？

非常感谢！

编辑：我认为我可以启动另一个定义了一些 init-param 的 servlet。然后在一个单独的 HttpServlet 实现上设置 PropertyConfigurator.configure([name of the log4j config]); 这是添加一个 servlet 的一种理想的处理方式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T00:43:43.210

很多不同的方法来处理这个。

由于您的任务不是每个 Servlet 或每个 Webapp 的不同日志记录......我不会在 servlet 或 webapp 位置解决问题，而是在服务器级别解决问题。对我来说，您希望将所有这些信息记录到正确的位置，而不仅仅是部署 servlet 后的所有信息。为此，我将在 jetty 中启用 slf4j-api 支持，然后从 slf4j 方面研究处理它的最佳方法。有了它，你可以使用任何你想要的日志框架，slf4j-simple、log4j 或 logback..任何你喜欢的。

或者，如果你真的想避免服务器端的日志记录，我想你可以在资源目录中使用 log4j.properties 文件，然后在命令行上的码头启动时提供不同的资源目录。找出您想要的选项并启动：

java -jar start.jar OPTIONS=服务器,jmx,jsp,resources-[dev,qa,prod]

干杯

# ios - 为什么应用程序：didReceiveLocalNotification 的通知参数在输入时为 NULL？

> ID：13078132
> 
> 赞同：2
> 
> 时间：2012-10-25T22:13:19.650
> 
> 标签：ios, notifications

在调试器中，application:didReceiveLocalNotification: 有一个 NULL 条目。该应用程序正在通过通知栏中的本地通知启动。该文档以下列方式描述了通知（第二个）参数：

封装通知详细信息的本地通知，可能包括自定义数据。

这正在 iOS6 设备上进行测试，而不是在已知存在本地通知错误的模拟器上进行测试。

在什么情况下这个 NULL，我怎样才能得到启动应用程序的通知？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T09:29:22.517

我昨天在更彻底地阅读了苹果的文档后发现了这一点。

基本上，iOS 在某些情况下使用另一种方法将 UILocalNotification 传达给您的应用程序：`application:didFinishLaunchingWithOptions:`. 此方法包含 UILocalNotification，可通过 key 在其选项字典中找到`UIApplicationLaunchOptionsLocalNotificationKey`。正是这种方法将包含您的通知，例如，当您的应用程序没有运行但由于用户单击通知中心中的通知而由 iOS 启动时。显然，它的选项字典中并不总是存在 UILocalNotification 。

阅读此处了解更多信息： [https ://developer.apple.com/library/ios/#documentation/iPhone/Reference/UILocalNotification_Class/Reference/Reference.html](https://developer.apple.com/library/ios/#documentation/iPhone/Reference/UILocalNotification_Class/Reference/Reference.html)

希望对您有所帮助！

# keyboard-shortcuts - 如何在 Sublime Text 2 中将多行/选择复制并粘贴到相同数量的多行/选择而不将它们 1:1 映射？

> ID：13078134
> 
> 赞同：5
> 
> 时间：2012-10-25T22:13:22.893
> 
> 标签：keyboard-shortcuts, copy-paste, sublimetext2, multiline, multipleselection

每隔一段时间，我就会复制多行代码，然后将它们粘贴到多个选择中，希望每个选择都具有该代码块，但是由于行/选择的数量匹配，因此代码块被拆分为多个选择。如果行/选择的数量匹配，这是默认行为，这很有用，但在这种情况下却没有。

我的第一直觉是看看是否有一个快捷方式可以取消这种行为，就像“paste_and_indent”的快捷方式是“super+shift+v”一样。不过我一个也没找到。

每次遇到此问题时，我都会取消选择其中一项并粘贴，然后仅选择我取消选择并粘贴的一项。

如果有人知道这样做的更好方法，请分享。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T06:51:17.220

我认为唯一的方法是创建一个插件 ( *)*`Tools/New Plugin...`将剪贴板复制到所有选定区域：

```
import sublime, sublime_plugin

class FullMultilinePasteCommand(sublime_plugin.TextCommand):
    def run(self, edit):
        for region in self.view.sel():
            self.view.insert(edit, region.begin(), sublime.get_clipboard()) 
```

将其保存在您的`Packages/User`目录中。

然后你可以添加键绑定（`Preferences/Key Bindings - User`）：

```
{ "keys": ["alt+super+v"], "command": "full_multiline_paste" } 
```

# javascript - 在 IE 8 中以编程方式选择文本区域中的文本

> ID：13078142
> 
> 赞同：3
> 
> 时间：2012-10-25T22:14:16.537
> 
> 标签：javascript, asp.net, html, textarea, textselection

我一直在尝试根据开始和结束索引以编程方式在文本区域中选择文本，但由于某种原因，选择被一些字符位置偏移：

我的用户进行了初始手动选择，并将其存储到数据库中。为了获取初始选择的开始/结束位置，我使用此处概述的方法[Caret position in textarea, in characters from the start](https://stackoverflow.com/questions/263743/how-to-get-caret-position-in-textarea/3373056#3373056) (Answered by Tim Down)

我存储用户所做的选择，当他们返回页面时，我希望在他们之前的选择中默认。

我根据使用 Tim Down 函数提取的存储位置进行选择的代码如下：

```
 function SelectText(start,end) {
    var textArea = document.getElementById("textArea");

    var inputRange = textArea.createTextRange();
    inputRange.collapse(true);

    inputRange.moveStart("character", start);
    inputRange.moveEnd("character", end - start);

    inputRange.select();
} 
```

似乎问题是由换行符/空格引起的。有谁知道如何根据开始和结束以编程方式在 IE 中正确进行选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T20:26:09.383

我不知道它是否对你有帮助，但你可以尝试使用由 Tim Down 开发的 RangyInputs js 库，可以使用以下网址： [http ://code.google.com/p/rangyinputs/](http://code.google.com/p/rangyinputs/)

至于我，我在我的一个项目中使用 Rangy（也是由 Tim Down 开发的）库作为内容可编辑的 div，它真的很好用，对我帮助很大。

您可以在 WiKi 页面上找到有关受支持方法的文档：[http ://code.google.com/p/rangyinputs/wiki/Documentation](http://code.google.com/p/rangyinputs/wiki/Documentation)

# ios - 如何在开发环境中测试 Smart App Banner Urls

> ID：13078147
> 
> 赞同：25
> 
> 时间：2012-10-25T22:14:40.850
> 
> 标签：ios, ios6, meta-tags

我想知道是否可以在 iOS 应用的开发版本上测试 iOS 6 的智能应用横幅的 app-argument URL 参数。仅当从 App Store 下载应用程序时，才会出现横幅中的打开选项。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-08T05:46:11.183

What worked for me was to download my application from the appstore, and then overwrite it using a build from XCode. This worked and allowed me to debug the smart banner feature using my current build. This won't work from the simulator, you need to use a device.

Just to be clear, you must overwrite it. You can't delete the appstore version, and then build from XCode.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-12-02T07:18:16.653

截至目前，Xcode 8 和 iOS 10，我已经尝试了所有方法，但**无法调试**正在打开的智能横幅 URL，因为它需要应用程序的商店版本。

我找到了解决方法，并使用它测试了我的应用程序。

除了`<meta ...>`标签之外，我还在使用该方案打开应用程序的页面上添加了一个链接按钮。

```
<!doctype html>
<html>
  <head>
    <meta name="apple-itunes-app" content="app-id=xxxx,pt=xxxxx,ct=xxxxx,app-argument=myappscheme://www.mymobilesite.com/link/detailpage?query=x">
    <title>Banner Debug Sample</title>
  </head>
  <body>
    <p>Visit <a href="myappscheme://www.mymobilesite.com/link/detailpage?query=x">App Using Scheme</a>.</p>
  </body>
</html> 
```

使用此链接，我可以调试 Dev 构建并且运行良好。

虽然这仅在应用程序为自己注册了一个方案时才有效，但只是为了测试，我们可以注册一个虚拟方案说`appscheme://`并`http://`用虚拟方案替换方案，测试它，然后将应用程序的链接恢复`scheme://`到`http://`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-22T23:38:25.357

以下内容适用于我使用 iOS 6 设备，因为它不适用于 iOS 8。

我从 AppStore 安装了该应用程序，然后使用 Xcode 6 用开发版本覆盖它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-12T18:39:45.060

这很麻烦，但我们所做的是添加一些日志消息并提交构建以供 Apple 审查标记为手动发布。应用程序获得批准后，为未发布版本发布促销代码。兑换促销，这将安装应用程序的未发布版本。转到 safari 并使用元标记点击您的网页以显示智能应用横幅。应该启动您的应用程序并传递 URL。然后查看控制台中的日志消息。

# php - CodeIgniter - 我在控制器中有一个公共函数，但我不希望人们通过 URL 请求它

> ID：13078154
> 
> 赞同：1
> 
> 时间：2012-10-25T22:15:31.553
> 
> 标签：php, codeigniter, public

CodeIgniter - 我在控制器中有一个公共函数，但我不希望人们通过 URL 请求它。

**即，我有这个**：

```
public function process_images($images) {
  ...
} 
```

我需要将其公开，因为我正在使用 GroceryCRUD 并使用回调 - 将其设置为受保护意味着 GroceryCRUD 不会使用其回调调用它。

所以看起来它必须是公开的。如何将其声明为公开但确保 CodeIgniter 不会从 URL 请求中调用它（即，如果我去*`http://site.com/images/process_images/test.jp`*它不会调用`::process_images('test.jpg'))`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T22:19:20.980

您可以使用下划线前缀：

```
public function _process_images($images) { ... } 
```

这样它就可以保持公开，并且 codeigniter 不会在 URL 请求上调用它。

记录[在这里](http://codeigniter.com/user_guide/general/controllers.html#private)

# scheme - Letrec 和可重入延续

> ID：13078165
> 
> 赞同：5
> 
> 时间：2012-10-25T22:15:54.250
> 
> 标签：scheme, continuations, letrec

有人告诉我，以下表达式的计算结果为 0，但 Scheme 的许多实现将其计算为 1：

```
(let ((cont #f))
  (letrec ((x (call-with-current-continuation (lambda (c) (set! cont c) 0)))
           (y (call-with-current-continuation (lambda (c) (set! cont c) 0))))
    (if cont
        (let ((c cont))
          (set! cont #f)
          (set! x 1)
          (set! y 1)
          (c 0))
        (+ x y)))) 
```

我必须承认，我什至不知道从哪里开始。我了解 continuation 和 的基础知识`call/cc`，但我能得到这个表达式的详细解释吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T15:31:55.913

这是一个有趣的片段。`letrec`我遇到了这个问题，因为我正在寻找关于和之间的确切差异的讨论`letrec*`，以及这些在不同版本的 Scheme 报告和不同的 Scheme 实现之间如何变化。在试验这个片段时，我做了一些研究，并将在这里报告结果。

如果您在脑海中走过这个片段的执行过程，那么您应该注意两个问题：

Q1。初始化子句的顺序`x`和`y`评估顺序是什么？

Q2。是否首先评估所有初始化子句，并缓存它们的结果，然后再进行所有分配`x`和`y`执行？还是在评估某些初始化子句之前进行了一些分配？

对于`letrec`，Scheme 报告说 Q1 的答案是“未指定”。大多数实现实际上会以从左到右的顺序评估子句；但你不应该依赖这种行为。

方案 R6RS 和 R7RS 引入了一个新的绑定结构`letrec*`，它指定了从左到右的评估顺序。`letrec`正如我们将在下面看到的，它在其他一些方面也与 不同。

回到`letrec`，Scheme 报告至少可以追溯到 R5RS*似乎*指定 Q2 的答案是“在进行任何分配之前评估所有初始化子句”。我说“似乎指定”是因为语言并没有像它可能的那样明确说明这是必需的。事实上，许多 Scheme 实现并不符合这个要求。这就是你的片段中“预期”和“观察到”行为之间差异的原因。

让我们看看你的片段，记住 Q2。`x`首先，我们为和`y`绑定两个“位置”（参考单元格）留出空间。然后我们评估其中一个初始化子句。假设它是 for 的子句`x`，尽管正如我所说，`letrec`它可能是任何一个。我们将此评估的延续保存到`cont`. 此评估的结果为 0。现在，根据 Q2 的答案，我们要么*立即将该结果分配给 ，要么将其`x`缓存以稍后进行分配*。接下来我们评估另一个初始化子句。我们将其延续保存到`cont`中，覆盖前一个。这个评估的结果是 0。现在所有的初始化子句都被评估了。*根据 Q2 的答案，我们此时可能会将缓存结果 0 分配给`x`; 或者分配到`x`可能已经发生。*在任何一种情况下，分配到`y`现在都会发生。

然后我们开始评估表达式的主体`(letrec (...) ...)`（第一次）。有一个延续存储在 中`cont`，所以我们将它检索到`c`，然后清除每个`cont`和到1。然后我们用值 0 调用检索到的延续。这又回到了最后评估的初始化子句——我们已经假定为'。我们提供给延续的参数然后用于代替, 并将分配给。根据对 Q2 的回答，此时可能会或可能不会（再次）发生 0 的分配。`set!``x``y``y``(call-with-current-continuation (lambda (c) (set! cont c) 0))``y``x`

然后我们开始计算表达式的主体`(letrec (...) ...)`（第二次）。现在`cont`是#f，所以我们得到`(+ x y)`. 这将是`(+ 1 0)`或，这取决于我们调用保存的延续时`(+ 0 0)`是否重新分配了 0 。`x`

您可以通过使用一些调用来装饰您的片段来跟踪此行为`display`，例如：

```
(let ((cont #f))
 (letrec ((x (begin (display (list 'xinit x y cont)) (call-with-current-continuation (lambda (c) (set! cont c) 0))))
          (y (begin (display (list 'yinit x y cont)) (call-with-current-continuation (lambda (c) (set! cont c) 0)))))
  (display (list 'body x y cont))
  (if cont
   (let ((c cont))
    (set! cont #f)
    (set! x 1)
    (set! y 1)
    (c 'new))
   (cons x y)))) 
```

我还替换`(+ x y)`为`(cons x y)`, 并用参数`'new`而不是`0`.

我使用几种不同的“语言模式”在 Racket 5.2 和 Chicken 4.7 中运行了该片段。这是结果。两种实现都`x`首先评估 init 子句，然后评估`y`子句，尽管正如我所说，这种行为是未指定的。

Racket with `#lang r5rs`and`#lang r6rs`符合 Q2 的规范，因此我们得到了在`0`调用延续时重新分配给另一个变量的“预期”结果。（在试验 r6rs 时，我需要将最终结果包装在 a`display`中以查看结果。）

这是跟踪输出：

```
(xinit #<undefined> #<undefined> #f)
(yinit #<undefined> #<undefined> #<continuation>)
(body 0 0 #<continuation>)
(body 0 new #f)
(0 . new) 
```

Racket with`#lang racket`和 Chicken 不符合这一点。相反，在评估每个初始化子句之后，它被分配给相应的变量。因此，当调用延续时，它最终只会重新分配一个值给最终值。

这是跟踪输出，并添加了一些注释：

```
(xinit #<undefined> #<undefined> #f)
(yinit 0 #<undefined> #<continuation>) ; note that x has already been assigned
(body 0 0 #<continuation>)
(body 1 new #f) ; so now x is not re-assigned
(1 . new) 
```

现在，关于计划报告的真正要求。以下是 R5RS 的相关部分：

> 库语法：(letrec <bindings> <body>)
> 
> 语法：<Bindings> 应该具有 ((<variable1> <init1>) ...) 的形式，并且 <body> 应该是一个或多个表达式的序列。<variable> 在被绑定的变量列表中出现多次是错误的。
> 
> 语义：<variable> 被绑定到新的位置，包含未定义的值，<init> 在结果环境中被评估（以某种未指定的顺序），每个 <variable> 被分配给相应 <init> 的结果， <body> 在结果环境中进行评估，并返回 <body> 中最后一个表达式的值。<variable> 的每个绑定都将整个 letrec 表达式作为其区域，从而可以定义相互递归的过程。
> 
> ```
> (letrec ((even?
>           (lambda (n)
>             (if (zero? n)
>                 #t
>                 (odd? (- n 1)))))
>          (odd?
>           (lambda (n)
>             (if (zero? n)
>                 #f
>                 (even? (- n 1))))))
>   (even? 88))   
> ===>  #t 
> ```
> 
> 对 letrec 的一个限制非常重要：必须可以在不分配或引用*任何*<variable> 的值的情况下评估每个 <init>。如果违反此限制，则为错误。该限制是必要的，因为 Scheme 通过值而不是名称传递参数。在 letrec 最常见的用法中，所有 <init> 都是 lambda 表达式，并且自动满足限制。

“语义”部分的第一句听起来像是要求所有的赋值都*在*所有初始化子句都被评估之后发生；但是，正如我之前所说，这并不像它可能的那样明确。

在 R6RS 和 R7RS 中，对规范这一部分的唯一实质性更改是添加了以下要求：

> 每个 <init> 的延续不应被多次调用。

不过，R6RS 和 R7RS 还添加*了另一个*绑定结构：`letrec*`. 这`letrec`在两个方面有所不同。首先，它确实指定了从左到右的评估顺序。相应地，上面提到的“限制”可以稍微放宽一些。现在可以引用已经分配了初始值的变量的值：

> 必须可以评估每个 <init> 而不分配或引用*相应 <variable> 的值或 <bindings> 中跟随它的任何绑定的 <variable>*。

第二个区别是关于我们的 Q2。有了`letrec*`，规范现在要求在评估每个初始化子句之后进行分配。这是来自 R7RS（草案 6）的“语义”的第一段：

> 语义： <variable> 绑定到新的位置，*每个 <variable> 以从左到右的顺序分配给评估相应 <init> 的结果*，<body> 在结果环境中评估，并且<body> 中最后一个表达式的值被返回。尽管评估和赋值顺序是从左到右，但 <variable> 的每个绑定都将整个 letrec* 表达式作为其区域，从而可以定义相互递归的过程。

So Chicken, and Racket using `#lang racket`---and many other implementations---seem in fact to implement their `letrec`s as `letrec*`s.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T10:51:00.537

将其评估为 1 的原因是因为`(set! x 1)`. 如果您将 x 设置为 0 而不是 1，那么它将导致零。这是因为存储延续的延续变量`cont`实际上是为`y`而不是存储延续，`x`因为它在 x 之后被设置为 y 的延续。

# ruby-on-rails - Spree 中的缩略图设置和更改如何工作？

> ID：13078168
> 
> 赞同：3
> 
> 时间：2012-10-25T22:16:14.920
> 
> 标签：ruby-on-rails, imagemagick, e-commerce, thumbnails, spree

我正在构建我的第一个 Spree 应用程序和我自己的布局/主题。我需要更改产品的缩略图大小，并且得到了不同的指导，主要是它似乎是一个不受欢迎的主题。这是如何工作的，我该如何改变它？

### 大礼包配置

配置/初始化程序/spree_config.rb

```
Spree::Config.set(
    attachment_styles: "{
        \"mini\":\"48x48>\",
        \"small\":\"110x110>\",
        \"product\":\"340x340>\",
        \"large\":\"650x650>\"
    }"
) 
```

这就是我第一次尝试的方式 - 没有效果。

### 清除缓存

我试图像这样清除缓存： `rake tmp:clear`没有结果。

### 重新上传？

我尝试重新上传一些图像以强制重新生成缩略图并且有*结果*，但不是所有尺寸的。例如，似乎很难为“产品”尺寸创建 340x340 像素的图像。

我所追求的是一种根据我自己定义的尺寸重新生成所有缩略图的方法。

`ruby 1.9.3p194 | Rails 3.2.8 | Spree 1.2.0`

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-26T17:28:29.247

转到 Spree 管理员仪表板 > 配置 > 图像设置。单击编辑并更改回形针样式字段，然后单击更新。

运行命令。

```
bundle exec rake paperclip:refresh:thumbnails class=Spree::Image 
```

您不需要重新上传已经存在的图像，rake 命令将重新生成缩略图。

# php - 带有密码的 SHA1，不涉及密码

> ID：13078172
> 
> 赞同：2
> 
> 时间：2012-10-25T22:16:35.333
> 
> 标签：php, encryption, web, passphrase

我正在从我没有 root 访问权限的远程服务器检索会话 ID 和密钥。我想出于自己的原因加密这些数据，当我必须将密钥发送回 API 服务器以进行 w/e 时，我需要解密。据我了解，您不能只解密 SHA 哈希。有没有办法将会话信息传递给具有特定密码或“解密密钥”的加密变量，以便稍后允许我解密？

我已经搜索过，并用谷歌搜索了这个主题。结果只是人们希望解密存储在 SHA1 中的密码。这不是学习如何暴力破解/碰撞哈希的菜鸟尝试。我有一个合法的目的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T22:21:02.227

您不能“解密” SHA-1 哈希，它是“*摘要*”（或“*签名*”）算法而不是*加密*算法。

只能检查您拥有的其他一些文本是否具有相同的签名，在这方面，SHA-1 是一种非常强大的算法，尽管并非没有弱点，特别是在与密码等低熵源数据一起使用时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T22:21:42.660

就我而言，没有办法解密 SHA-1 哈希，因为 SHA-1 只是一种单向哈希方法。如果人们能够解密这些，那么 SHA-1 根本就不是一种非常安全的散列算法方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T22:26:43.673

散列和加密之间存在很大差异。

散列是单向的。这意味着一旦你散列一些东西，它只会作为散列存在，你不应该能够从输出中确定输入。SHA-1 就是其中之一。

但是，对于加密，您希望做到这一点。也有不同的方法可以实现这一点。您可以使用对称或非对称加密。不同之处在于，对于对称加密，您需要相同的密钥来加密和解密数据。这方面的例子是 DES 和 AES。非对称加密具有用于加密和解密数据的不同密钥。您还可以使用它们来签署数据。这方面的例子是 RSA 或 ElGamal。

# .net - Control.Invoke 挂起

> ID：13078175
> 
> 赞同：1
> 
> 时间：2012-10-25T22:16:48.993
> 
> 标签：.net, vb.net, invoke, freeze

我看过很多关于控制问题的帖子。调用挂起的应用程序，但它们似乎大多仅限于在 .NET 1.1 上运行的应用程序。我还看到了使用 .BeginInvoke 的建议，我尝试过但无济于事。.BeginInvoke 不会挂起，但它也不会调用委托。我主要担心的是我已经使用 .Invoke 多年没有任何问题，并且我在该领域有一个广泛使用它的主要应用程序，我担心这个问题会在那里出现。据我所知，我的工作代码和失败的代码之间没有什么不同。我写了一段简单的代码来复制这个问题（全部在 4.0 VS2010 中）：

```
Public Class Form1

    Private WithEvents sat As TestInvoke
    Private Delegate Sub doTheUpdateDelegate(ByVal message As String)

    Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles     Button1.Click
        sat = New TestInvoke

        sat.startAThread()

    End Sub

    Public Class TestInvoke

        Public Event UpdateControl()

        Public Sub startAThread()
            Dim t As New Threading.Thread(AddressOf _startAThread)
            Dim trace As String

            trace = "a"
            t.SetApartmentState(Threading.ApartmentState.STA)

            t.Start()
            t.Join()

        End Sub

        Protected Sub _startAThread()
            Try
                For k = 0 To 10
                    System.Threading.Thread.Sleep(1000)
                    k += 1
                    RaiseEvent UpdateControl()
                Next
            Catch ex As Exception
                MsgBox(ex.Message)
            End Try
        End Sub
    End Class

    Private Sub sat_UpdateControl() Handles sat.UpdateControl
        Try
            Call doTheupdate(Now.ToString)
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
    End Sub

    Private Sub doTheUpdate(ByVal message As String)
        Try
            If Button1.InvokeRequired = True Then
                Dim objParams As Object() = {message}

                'hangs on the following line
                Button1.Invoke(New doTheUpdateDelegate(AddressOf doTheUpdate),     objParams)

            Else
                Button1.Text = message
            End If
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
    End Sub
End Class 
```

如果有人能看到我在这里做错了什么，我将不胜感激！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-25T22:44:00.707

Control.Invoke() 调用挂起的原因只有一个。或者 BeginInvoke() 调用不执行其目标，同样的事情。当程序的主线程 UI 线程没有空闲并忙于做其他事情时，就会发生这种情况。

“其他东西”可能是地图。您可以做的最糟糕的事情是让主线程等待工作线程完成。如果您使用 Invoke()，那肯定会出现死锁。

这种情况很容易诊断，使用 Debug + Break All 和 Debug + Windows + Threads。双击主线程并查看调用堆栈窗口。堆栈跟踪的顶部应该是“Managed to Native Transition”，它下面的应该是 FPushMessageLoop()。如果您看到其他内容，那么您已经找到了导致死锁的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T22:44:53.887

您正在使用`Thread.Join`让 UI 线程暂停，直到另一个线程完成。同时你`Control.Invoke`用来让 UI 线程做一些动作。这不起作用，因为 UI 线程正在等待另一个线程完成。

`Thread.Join`如果您希望它等待操作完成，我建议您删除呼叫或在 UI 线程中执行您的操作。

# python - FNV1A_64 不匹配

> ID：13078183
> 
> 赞同：1
> 
> 时间：2012-10-25T22:17:30.460
> 
> 标签：python, mysql, hash, fnv

我正在尝试 3 种不同的**FNV1A_64**哈希实现。

1）[Maatkit](http://code.google.com/p/maatkit/)

```
SELECT FNV1A_64('1') 
```

**结果**：*-5808609649712063748*

2）[pyhash](http://code.google.com/p/pyfasthash/)

```
import pyhash
hasher = pyhash.fnv1a_64()
print hasher('1') 
```

**结果**：*53876069782339L*

3）[fnv](http://www.isthe.com/chongo/src/fnv/)

```
./fnv1a64 -s 1 
```

**结果**：*0xaf63ac4c86019afc*（12638134423997487000 十进制）

为什么所有的结果都不一样？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T22:39:54.117

MySQL 和命令行程序给了你同样的结果。一个只打印了一个带符号的数字，另一个打印了相同数字的十六进制表示。

```
>>> import struct
>>> struct.pack('q', -5808609649712063748)
'\xfc\x9a\x01\x86L\xacc\xaf'
>>> struct.unpack('Q', _)
(12638134423997487868L,)
>>> 0xaf63ac4c86019afc == _[0]
True 
```

但是，Python 需要`FNV1A_64_INIT`，因为默认情况下它不通过。

```
>>> FNV1A_64_INIT = 0xcbf29ce484222325
>>> import pyhash
>>> hasher = pyhash.fnv1a_64()
>>> hasher('1', seed=FNV1A_64_INIT)
12638134423997487868L
>>> _ == 0xaf63ac4c86019afc
True 
```

# c - execlp 行为异常

> ID：13078185
> 
> 赞同：1
> 
> 时间：2012-10-25T22:17:47.950
> 
> 标签：c, unix, arguments, exec

我正在尝试使用 fork 和 execlp 运行一个非常简单的程序，但它并没有像我预期的那样工作。我目前在我的工作目录中有一个简单命名为“1”的文件。所以命令**rm 1***应该删除它。但是，当通过 execlp 尝试时，它不会。

```
int main()
{

  if(fork()==0)
    {
      execlp("rm", "rm", "1*",  NULL);
      perror("Problem\n");
    }

  return 0;
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:56:07.550

对于你想要做的事情，你想要：

```
execlp("sh", "sh", "rm 1*", (char *)0); 
```

请注意，从安全性、健壮性和效率的角度来看，这是一个相当糟糕的主意。如果要删除与模式匹配的文件，则应直接在 C 中执行此操作。使用`glob`函数和简单的循环很容易。

# javascript - Bootstrap：使用 nextall() 从 typeahead 创建 2 个下拉列表

> ID：13078190
> 
> 赞同：0
> 
> 时间：2012-10-25T22:18:01.767
> 
> 标签：javascript, jquery, html, twitter-bootstrap

我从 bootstrap 获得了这段代码：[link](https://github.com/twitter/bootstrap/pull/4024)。

显然它使用 nextall() 从 typeahead 创建了 2 种下拉列表，但我不明白如何实现它。我是否需要更改引导预输入文件中的某些内容？

**链接中的文本：公开的** *typeahead 渲染方法，因此您可以覆盖它并根据从自定义源返回的对象类型自定义列表 html。如果你想产生类似新的 twitter 搜索/自动完成的东西，你需要这个。将 .next() 更改为使用 .nextAll(':has(a):first') 以便您可以分离结果类型。例子*

```
var labels
  , mapped
$("input").typeahead({
  source: function (query, process) {
    $.get('/autocomplete', { q: query }, function (data) {
      labels = []
      mapped = {}

      $.each(data, function (i, item) {
        mapped[item.label] = item.value
        labels.push(item.label)
      })

      process(labels)
    })
  },
  render: function () {
      var that = this

      items = $(mapped).map(function (i, item) {
        i = $(that.options.item).attr('data-value', item)

        if (item.thumb) { // Ok object has a thumbnail.
          i.find('a').append(''+that.highlighter(item));
        } else {
          i.find('a').html(that.highlighter(item))
        }

        return i[0]
      })

      items.first().addClass('active')
      this.$menu.html(items)
  },
  updater: function (item) {
    return mapped[item]
  }
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T16:39:27.743

要实现您链接的提交（它似乎已经从 Bootstrap 源中消失了），您可以下载[gcoop 的 bootstrap-typeahead.js 修改版本](https://github.com/gcoop/bootstrap/blob/ed0830c7d7efd7337b8b4fb35b98e51a0229d762/js/bootstrap-typeahead.js)并使用它而不是原始版本。
请注意，他的 fork 版本为 2.0.4，如果您使用较新的版本，可能会导致问题。

# objective-c - 在另一个 plist 文件中引用 info.plist 中的配置变量

> ID：13078196
> 
> 赞同：2
> 
> 时间：2012-10-25T22:18:14.823
> 
> 标签：objective-c, ios, xcode, xcode4

如果我有一个不在 Info.plist 包中的单独 Sample.plist 文件，我将如何引用 Info.plist 中引用的变量？

例如，{SOME_VARIABLE} 是在编译时根据配置文件在 Info.plists 中填充的......但在此之外的 plists 不会被替换。

例如：

```
ConfigurationConstants.cfg:
SOME_VARIABLE="SOME VALUE";

Info.plists/Debug.plist:
SOME_KEY = {SOME_VARIABLE} <--- this gets replaced at compile time

SomeOtherFile.plist:
SOME_OTHER_KEY = {SOME_VARIABLE} <--- this does not get replaced at compile time because it's outside of the Info.plists bundle. 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:25:21.073

您可以在构建阶段编写运行脚本以在编译时更改 plist 文件。

# ios - 将 CString 转换为 NSUTF16 编码的 NSString

> ID：13078198
> 
> 赞同：0
> 
> 时间：2012-10-25T22:18:29.987
> 
> 标签：ios, nsstring, cstring

我有一个 cstring，我可以像这样将它转换成 NSUTF8 NSString

```
NSString *resultString = [[NSString alloc] initWithUTF8String:cstring]; 
```

但是我想知道是否有办法将其转换为 UTF16String？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T22:25:09.883

你可以简单地使用 NSString 的`stringWithCString:encoding`

```
NSString *resultString = [NSString stringWithCString:cstring encoding:NSUTF16StringEncoding]; 
```

或者，如果您希望坚持使用 alloc/init 格式，请使用：

```
NSString *resultString = [[NSString alloc] initWithCString:cstring encoding:NSUTF16StringEncoding]; 
```

# javascript - FB.Canvas.setSize(); 更改页面时不起作用

> ID：13078202
> 
> 赞同：0
> 
> 时间：2012-10-25T22:19:23.257
> 
> 标签：javascript, facebook, iframe, tabs, facebook-page

我有一个包含多个页面的 facebook 标签。第一页上一切正常，iframe 完美调整大小，但在内容小于第一页的第二页上，iframe 不会移动它，它与第一页保持相同的高度。起初它还停留在页面底部，但 FB.Canvas.scrollTo(0,0); 解决了这个问题。我尝试使用特定大小调用 setSize ，但没​​有任何效果。也在这里尝试了大部分解决方案，但没有任何效果。

这是我在关闭正文之前在每一页上调用的代码

```
<script type="text/javascript">
window.fbAsyncInit = function() {
    <cfif structKeyExists(cgi,'https') AND cgi.https IS 'ON'>
    FB._https = true;
    </cfif>
    FB.init({
        appId   : '<cfoutput>#appId#</cfoutput>',
        cookie  : true, // enable cookies to allow the server to access the session
        oauth     : true, // OAuth 2.0
        status  : true, // check login status
        xfbml   : true // parse XFBML
    });

    FB.getLoginStatus(function(response) {
        // user is connected but we don't have access to his province
        if(typeof response.status == 'string' && response.status == 'connected') {
            $('#erreurProvinceFB').css('display', 'block');
            $('.fb_iframe_widget').css('display', 'none');
            $('.sepOU').html('&nbsp;');
        }
    });

    FB.Event.subscribe('auth.login', function(response) {
        <!--- met en post le nouveau signedRequest car l'ancien qui est en session n'est plus valide et que
        facbook ne renvoie pas un nouveau acces token si le tab est juste rafraichie et non reloader au complet. --->
        $('#signed_request').val(response['authResponse']['signedRequest']);
        $('#loginSignedRequest').submit();
    });
    FB.Canvas.setSize({ width: 520, height: 500 });
    //FB.Canvas.setSize();
    FB.Canvas.setAutoGrow();
    FB.Canvas.scrollTo(0,0);
    $("body").css("overflow", "hidden");
};

(function() {
    var e = document.createElement('script');
    e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
    e.async = true;
    document.getElementById('fb-root').appendChild(e);
}()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T22:41:26.927

到目前为止，这种组合对我来说效果很好：

```
<body style="overflow: hidden;">

...

<script>
window.fbAsyncInit = function() {
    FB.init({
        appId      : '*ID*', // App ID
        channelUrl : '/channel.php', // Channel File
        status     : false, // check login status
        cookie     : true, // enable cookies to allow the server to access the session
        xfbml      : true  // parse XFBML
    });

    if ( window.location.protocol == 'https:' ) {
        FB._https = true;
    }

    FB.Canvas.setAutoGrow();
};
</script> 
```

确保您的 FB 应用程序 ID 正确。

# zend-framework - 在zend框架中向控制器添加条件逻辑

> ID：13078203
> 
> 赞同：0
> 
> 时间：2012-10-25T22:19:30.477
> 
> 标签：zend-framework

我想在我的布局中添加一个条件语句来测试：

1.  url 中的控制器参数
2.  zend_auth() 的存在

实现这一目标的最佳方法是什么？我曾尝试`$this->_getParam('controller')`在布局中进行测试，但出现错误。我可以在所有控制器中设置该变量，但这似乎有点愚蠢。如何通过一些条件逻辑最好地设置我以后可以从布局中使用的变量？或者我应该添加视图助手内的条件逻辑，然后加载到布局中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:24:54.067

**编辑** 控制器不应该是 URL 参数，除非你正在做一些非常奇怪的路由。如果您要获取 GET（或 POST）变量，您将`->getParam()`在请求对象上`Zend_Controller_Front::getInstance()->getRequest()`使用 ，如下所示。但控制器是该请求对象的一个​​单独属性。

这是认证部分：

```
$loggedIn = Zend_Auth::getInstance()->hasIdentity(); 
```

这是控制器部分：

```
$controller = Zend_Controller_Front::getInstance()->getRequest()->controller; 
```

# assembly - 带常量的 x86 汇编程序

> ID：13078205
> 
> 赞同：-1
> 
> 时间：2012-10-25T22:19:37.867
> 
> 标签：assembly, x86

我需要在汇编程序中编写一个程序来计算多项式的值。我有两个文件：

*   C 源文件
*   ASM 源文件

### C 文件：

```
#include <stdio.h>
#include <stdlib.h>

double func(double,double);

int main()
{ 
  double x=3;
  double y=2;
  printf("%f\n",func(x,y) );
  return 0;
} 
```

### ASM 文件：

.386 .model flat, c .stack 100h

```
.DATA
var DW 27

.code

func PROC a:QWORD, b:QWORD
  finit
  fld b
  fld b
  fmul
  fld b
  fmul
  fld a
  fld a
  fmul
  fld a
  fmul
  mov ax, [var]
  push ax
  fmul
  fdiv
  fwait
  RET
func ENDP

end 
```

在这个阶段我想要实现的是 (b^3) / (27 * a^3) 的值。可能 mov 和 push 是问题的原因。

结果我得到`-1.#IND00`

我在 Windows 上，使用 Visual Studio 2012 编译器。对于编译，我使用 VS2012 命令行和以下 bat 文件：

```
del *.obj
cl -c poly.c
ml -c poly.asm
cl poly.obj poly.obj 
```

### 还：

有什么方法可以创建一个具有 2 个以上参数的过程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T00:07:54.037

如果要将整数加载到 FPU 堆栈中，可以使用`fild`命令。还可以查看`fimul`命令，借助此命令，您可以直接使用整数常量进行乘法运算。

请注意实现中的堆栈。一种简单的方法是

```
...
fld    qword ptr [b]  
fmul   qword ptr [b]  
fmul   qword ptr [b]  
fild   dword ptr [var]  
fmul   qword ptr [a]  
fmul   qword ptr [a]  
fmul   qword ptr [a]  
fdivp  st(1),st  
... 
```

代码完成后，结果将在`st(0)`.

# ruby-on-rails - 用于设计的 reset_password_sent_at 分配

> ID：13078207
> 
> 赞同：3
> 
> 时间：2012-10-25T22:19:51.667
> 
> 标签：ruby-on-rails, devise

问题是当用户单击链接以重置其密码（来自电子邮件）时，设计正在检查 reset_password_sent_at 并且在尝试重置（以表单形式）时发生错误：

```
Reset password token has expired, please request a new one 
```

意思是，“当生成 reset_password_token 时，需要将 @user.reset_password_sent_at 设置为 Time.now，否则当 devise 运行 @user.reset_password_period_valid? 以确定重置令牌是否仍然有效时，它将变为 nil 并假设令牌已过期。”

我不明白的是如何以及在何处将 reset_password_sent_at 分配给 Time.now

我是否需要通过控制台将 Time.now 分配给所有用户？如果是这样，我该怎么做？

或者，是不是我需要将 Time.now 分配给 reset_password_sent_at 的 before_create （或其他东西）？如果是这样，我应该如何以及在哪里执行此操作？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-26T12:20:43.013

您无需担心`reset_password_sent_at`；当将 reset_password 发送给用户时，这`devise`将负责正确设置。

`reset_password_sent_at``reset_password_within`与文件中设置的参数一起使用`config/initializers/devise.rb`。它应该看起来像这样：

```
config.reset_password_within = 2.hours 
```

很可能它设置为`nil`or `0`，这使得应用程序抛出该`password reset token has expired`方法。

# c# - 列出查询比 IQueryable 快 20 倍？

> ID：13078208
> 
> 赞同：6
> 
> 时间：2012-10-25T22:19:52.447
> 
> 标签：c#, performance, linq, list, iqueryable

这是我今晚设置的一个测试。它是为了证明一些不同的东西，但结果并不像我预期的那样。

我正在对 IQueryable 进行 10000 个随机查询的测试，在测试时我发现如果我在 List 上做同样的事情，我的测试速度会快 20 倍。

见下文。我的 CarBrandManager.GetList 最初返回一个 IQueryable，但现在我首先发出一个 ToList()，然后速度更快。

谁能告诉我为什么我看到了这么大的不同？

```
var sw = new Stopwatch();
sw.Start();

int queries = 10000;

//IQueryable<Model.CarBrand> carBrands = CarBrandManager.GetList(context);
List<Model.CarBrand> carBrands = CarBrandManager.GetList(context).ToList();

Random random = new Random();
int randomChar = 65;

for (int i = 0; i < queries; i++)
{
    randomChar = random.Next(65, 90);
    Model.CarBrand carBrand = carBrands.Where(x => x.Name.StartsWith(((char)randomChar).ToString())).FirstOrDefault();
}

sw.Stop();
lblStopWatch.Text = String.Format("Queries: {0} Elapsed ticks: {1}", queries, sw.ElapsedTicks); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-25T22:21:51.017

这里可能存在两个问题。`GetList(context)`首先：除了它实现的知识之外，从什么类型的集合返回并不明显`IQueryable`。这意味着当您评估结果时，很可能是创建一个 SQL 查询，将该查询发送到数据库，并将结果具体化为对象。或者它可能正在解析一个 XML 文件。或者下载 RSS 提要或在 Internet 上调用 OData 端点。这些显然比简单地过滤内存中的短列表要花费更多时间。（毕竟，汽车品牌到底能有多少？）

但是让我们假设它返回的实现实际上是 a `List`，因此您要测试的唯一区别是它是转换为 an`IEnumerable`还是转换为 a `IQueryable`。将[`Enumerable`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.aspx)类的扩展方法上的方法签名与[`Queryable`](http://msdn.microsoft.com/en-us/library/system.linq.queryable.aspx). 当您将列表视为 IQueryable 时，您传入的`Expression`是需要评估`Func`的 s，而不仅仅是可以直接运行的 s。

当您使用像实体框架这样的自定义 LINQ 提供程序时，这使框架能够评估实际的表达式树并从中生成 SQL 查询和实现计划。但是，LINQ to Objects 只想在内存中计算 lambda 表达式，因此它必须使用反射或将表达式编译为`Func`s，这两者都会对性能造成很大影响。

您可能很想只调用`.ToList()`或`.AsEnumerable()`在结果集上强制它使用`Func`s，但从[信息隐藏](http://en.wikipedia.org/wiki/Information_hiding)的角度来看，这将是一个错误。您会假设您知道从该`GetList(context)`方法返回的数据是某种内存对象。目前可能是这样，也可能不是。无论如何，它*不是*为`GetList(context)`方法，因此你不能假设它总是这样。你必须假设你得到的类型很可能是你可以查询的。即使目前可能只有十几个汽车品牌可供搜索，但有可能有一天会有数千个（我在这里谈论的是编程实践，不一定说汽车行业就是这种情况）。所以你不应该假设下载整个汽车列表并在内存中过滤它们总是更快，即使现在恰好是这种情况。

如果`CarBrandManager.GetList(context)`可能返回由自定义 LINQ 提供程序（如实体框架集合）支持的对象，那么您可能希望将数据强制转换为 IQueryable：即使您的基准测试显示使用列表要快 20 倍，但这种差异是如此之小，以至于没有用户能够分辨出其中的区别。有朝一日，通过调用`.Where().Take().Skip()`并仅从数据存储中加载真正需要的数据，您可能会看到性能提升几个数量级，而如果您立即调用，您最终会将整个表加载到系统的内存`.ToList()`中。

但是，如果您*知道*它将`CarBrandManager.GetList(context)`始终返回一个内存列表（顾名思义），则应将其更改为返回 an`IEnumerable<Model.CarBrand>`而不是 an `IQueryable<Model.CarBrand>`。或者，如果您使用的是 .NET 4.5，则可能是`IReadOnlyList<Model.CarBrand>`or `IReadOnlyCollection<Model.CarBrand>`，这取决于您愿意强制`CarManager`遵守的合同。

# node.js - node.js 脚本和可能的内存泄漏

> ID：13078212
> 
> 赞同：5
> 
> 时间：2012-10-25T22:20:04.523
> 
> 标签：node.js, memory-leaks

我正在编写一个 node.js 脚本，该脚本从一个连接的套接字获取数据并将其发送到另一个连接的套接字。在测试过程中，我注意到如果我在服务器发送大量数据时一遍又一遍地断开和重新连接客户端，我会遇到内存泄漏。以下是 node.js 代码。

```
var net = require('net');
var logServer = net.createServer();  
var clientList = [];
var clientIPList = [];
var serverList = [];
var serverIPList = [];
var port = 6451;

logServer.on('connection', function(client) {
    client.setEncoding('utf8');
    client.once('data', function(data) {
        if (data[0].toString() == 'S') {
            var server = client;
            client = undefined;
            serverList.push(server);
            serverIPList.push(server.remoteAddress + ":" + server.remotePort);
            console.log('Server connected: %s:%d', server.remoteAddress, server.remotePort);

            server.on('data', function(data) {
                for(var i=0;i<clientList.length;i+=1) {
                    try {
                        clientList[i].write(data);
                    } catch (err) {
                        console.log('Error writing to client "data event": ' + clientIPList[i] );
                        // close and null the socket on write error
                        try {
                            clientList[i] = null;
                            clientList[i].end();
                        } catch (err) {}
                        clientList.splice(i, 1);
                        clientIPList.splice(i, 1);
                    }
                }            
            })

            server.on('end', function() {
                try {
                    var d;
                    if( (d = serverList.indexOf( server )) != -1 ) {
                        console.log('Server disconnecting "end event": ' + serverIPList[d]);
                        try {
                            serverList[d] = null;
                            serverList[d].end();
                        } catch (err) {}
                        serverList.splice(d, 1);
                        serverIPList.splice(d, 1);
                    }
                    else {
                        console.log('Server disconnecting "end event": unknown server');                    
                    }
                } catch (err) {
                    console.log('Error cleaning up server socket list on "end event"');
                }
            })

            server.on('timeout', function() {
                try {
                    var d;
                    if( (d = serverList.indexOf( server )) != -1 ) {
                        console.log('Server disconnecting "timeout event": ' + serverIPList[d]);
                        try {
                            serverList[d] = null;
                            serverList[d].end();
                        } catch (err) {}
                        serverList.splice(d, 1);
                        serverIPList.splice(d, 1);
                    }
                    else {
                        console.log('Server disconnecting "timeout event": unknown server');                    
                    }
                } catch (err) {
                    console.log('Error cleaning up server socket list on "timeout event"');
                }
            })

            server.on('error', function(e) {
                try {
                    var d;
                    if( (d = serverList.indexOf( server )) != -1 ) {
                        console.log('Server disconnecting ' + e.code + ' "error event": ' + serverIPList[d]);
                        try {
                            serverList[d] = null;
                            serverList[d].end();
                        } catch (err) {}
                        serverList.splice(d, 1);
                        serverIPList.splice(d, 1);
                    }
                    else {
                        console.log('Server disconnecting "error event": unknown server');                  
                    }
                } catch (err) {
                    console.log('Error cleaning up server socket list on "error event"');
                }
            })

            server.on('close', function() {
                try {
                    var d;
                    if( (d = serverList.indexOf( server )) != -1 ) {
                        console.log('Server disconnecting "close event": ' + serverIPList[d]);
                        try {
                            serverList[d] = null;
                            serverList[d].end();
                        } catch (err) {}
                        serverList.splice(d, 1);
                        serverIPList.splice(d, 1);
                    }
                } catch (err) {
                    console.log('Error cleaning up server socket list on "close event"');
                }
            })
            server.on('drain', function() {
            })
        } 

        else {
            clientList.push(client);
            clientIPList.push(client.remoteAddress + ":" + client.remotePort);
            console.log('Client connected: %s:%d',client.remoteAddress, client.remotePort);

            client.on('data', function(data) {
                console.log('writing "%s" to %d servers', data.replace(/[\r\n]/g,''), serverList.length);
                for(var i=0;i<serverList.length;i+=1) {
                    try {
                        serverList[i].write(data);
                    } catch (err) {
                        console.log('Error writing to server "data event": ' + serverIPList[i] );
                        try {
                            serverList[i] = null;
                            serverList[i].end();
                        } catch (err) {}
                        serverList.splice(i, 1);
                        serverIPList.splice(i, 1);
                    }
                }
            })

            client.on('end', function() {
                try {
                    var d;
                    if( (d = clientList.indexOf( client )) != -1 ) {
                        console.log('Client disconnecting "end event": ' + clientIPList[d]);
                        // close and null the socket
                        try {
                            clientList[d] = null;
                            clientList[d].end();
                        } catch (err) {}
                        clientList.splice(d, 1);
                        clientIPList.splice(d, 1);
                    }
                    else {
                        console.log('Client disconnecting "end event": unknown client');
                    }               
                } catch (err) {
                    console.log('Error cleaning up socket client list on "end event"');
                }
            })

            client.on('timeout', function() {
                try {
                    client.end();
                } catch (err) {
                    var d;
                    if( (d = clientList.indexOf( client )) != -1 ) {
                        console.log('Error closing client connection "timeout event": ' + clientIPList[d]);
                    }
                    else {
                        console.log('Error closing client connection "timeout event": unknown client');                 
                    }
                }               
                try {
                    var d;
                    if( (d = clientList.indexOf( client )) != -1 ) {
                        console.log('Client disconnecting "timeout event": ' + clientIPList[d]);
                        try {
                            clientList[d] = null;
                            clientList[d].end();
                        } catch (err) {}
                        clientList.splice(d, 1);
                        clientIPList.splice(d, 1);
                    }
                    else {
                        console.log('Client disconnecting "timeout event": unknown client');
                    }               
                } catch (err) {
                    console.log('Error cleaning up client socket list on "timeout event"');
                }
            })

            client.on('error', function(e) {
                try {
                    var d;
                    if( (d = clientList.indexOf( client )) != -1 ) {
                        console.log('Client disconnecting ' + e.code + ' "error event": ' + clientIPList[d]);
                        try {
                            clientList[d] = null;
                            clientList[d].end();
                        } catch (err) {}
                        clientList.splice(d, 1);
                        clientIPList.splice(d, 1);
                    }
                    else {
                        console.log('Client disconnecting ' + e.code + ' "error event": unknown client');
                    }               
                } catch (err) {
                    console.log('Error cleaning up client socket list on "error event"');
                }
            })

            client.on('close', function() {
                try {
                    var d;
                    if( (d = clientList.indexOf( client )) != -1 ) {
                        console.log('Client disconnecting "close event": ' + clientIPList[d]);
                        try {
                            clientList[d] = null;
                            clientList[d].end();
                        } catch (err) {}
                        clientList.splice(d, 1);
                        clientIPList.splice(d, 1);
                    }
                } catch (err) {
                    console.log('Error cleaning up client socket list on "close event"');
                }
            })

            client.on('drain', function() {
                // nothing
            })
        }
    })
})
logServer.listen( port ); 
```

据我所知，一旦检测到断开连接，我正在处理所有关键的“网络”事件，并且正在正确清理套接字。这是我用来测试的两个脚本。第一个只是作为客户端反复连接和断开连接，第二个作为服务器发送数据。我同时运行它们。

condiscon.rb：在将自己注册为客户端后连接和断开连接“一旦连接就发送换行符”。我用'./condiscon.rb 1000'运行

```
#!/usr/bin/ruby

require 'rubygems'
require 'socket'

def connectFlac
    host = '10.211.55.10'
    port = 6451

    sock = TCPSocket.open( host, port )
    sock.puts( "" )
    sock
end

sock = connectFlac()
data = []
user_agents = {}
instances_lat = {}

count = ARGV.shift.to_i

while( count > 0 )
    sock = connectFlac()
    sleep( 0.05 )
    sock.close()
    sleep( 0.05 )
    count-= 1
end 
```

dataflood.rb：作为服务器连接并使用计数器发送约 2600 字节的 abcde 数据包。我运行“dataflood.rb 30000”

```
#!/usr/bin/ruby

require 'socket'

def connectFlac
    host = '10.211.55.10'
    port = 6451

    sock = TCPSocket.open( host, port )
    sock.setsockopt(Socket::IPPROTO_TCP,Socket::TCP_NODELAY,1)
    sock.puts( "S" )
    sock
end

def syntax()
    print "./script number_of_packets\n"
    exit( 1 )
end

data = ""
(1..100).each {
    data+= "abcdefghijklmnopqrstuvwxyz"
}

sock = connectFlac()

numpackets = ARGV.shift.to_i || syntax()
counter = 1
byteswritten = 0

while( numpackets > 0 )
    r,w,e = IO.select( nil, [sock], nil, nil )
    w.each do |sock_write|
        print numpackets, "\n"
        sock.write( counter.to_s + "|" + data + "\n" )
        sock.flush()
        byteswritten+= counter.to_s.length + 1 + data.length + 1
        counter+= 1
        numpackets-= 1
    end
end
sock.close()

print "Wrote #{byteswritten} bytes\n" 
```

这是我看到的一些结果。在任何测试之前在 logserver.js 上运行内存配置文件时，它使用大约 9 兆字节的常驻内存。我包括一个 pmap 来显示泄漏似乎占用的内存部分。

```
[root@localhost ~]# ps vwwwp 20658
  PID TTY      STAT   TIME  MAJFL   TRS   DRS   **RSS** %MEM COMMAND
20658 pts/4    Sl+    0:00      0  8100 581943 **8724**  0.8 /usr/local/node-v0.8.12/bin/node logserverdemo.js

[root@localhost ~]# pmap 20658
20658:   /usr/local/node-v0.8.12/bin/node logserverdemo.js    
0000000000400000   8104K r-x--  /usr/local/node-v0.8.12/bin/node    
0000000000de9000     76K rwx--  /usr/local/node-v0.8.12/bin/node    
0000000000dfc000     40K rwx--    [ anon ]    
**000000001408a000    960K rwx--    [ anon ]**    
0000000040622000      4K -----    [ anon ] 
```

在 ame time 对 logserver 运行上面的两个 ruby​​ 脚本之后，这是流量停止后大约 30 分钟的内存情况。（我等待所有 gc 发生）

```
[root@localhost ~]# ps vwwwp 20658
  PID TTY      STAT   TIME  MAJFL   TRS   DRS   RSS %MEM COMMAND
20658 pts/4    Sl+    0:01      0  8100 665839 **89368**  8.7 /usr/local/node-v0.8.12/bin/node logserverdemo.js

[root@localhost ~]# pmap 20658
20658:   /usr/local/node-v0.8.12/bin/node logserverdemo.js

0000000000400000   8104K r-x--  /usr/local/node-v0.8.12/bin/node
0000000000de9000     76K rwx--  /usr/local/node-v0.8.12/bin/node    
0000000000dfc000     40K rwx--    [ anon ]    
**000000001408a000  80760K rwx--    [ anon ]**
0000000040622000      4K -----    [ anon ]
0000000040623000     64K rwx--    [ anon ] 
```

dataflood.rb一共写入了78198894字节的数据，泄漏非常接近。我在 0x1408a000 处转储了内存，我看到我从 dataflood.rb 发送的大部分数据包都卡在了内存中。

```
[root@localhost ~]# ./memoryprint 20658 0x1408a000 80760000 > 20658.txt
[root@localhost ~]# strings 20658.txt | grep '|abcde' | wc -l
30644
[root@localhost ~]# strings 20658.txt | grep '|abcde' | sort | uniq | wc -l
29638 
```

等待 24 小时后，内存仍未释放。任何人都可以给我的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:50:06.347

由于输入流和输出流之间的速度不平衡，可能会出现此问题。

尝试更改下面的源代码。

```
<AS-IS>

server.on('data', function(data) {
                for(var i=0;i<clientList.length;i+=1) {
                    try {
                        clientList[i].write(data);
                    } catch (err) {
                        console.log('Error writing to client "data event": ' + clientIPList[i] );
                        // close and null the socket on write error
                        try {
                            clientList[i] = null;
                            clientList[i].end();
                        } catch (err) {}
                        clientList.splice(i, 1);
                        clientIPList.splice(i, 1);
                    }
                }            
            }) 
```

.

```
<TO-BE>

for(var i=0;i<clientList.length;i+=1) {
    try {
        server.pipe(clientList[i]);
    } catch (err) {
        console.log('Error writing to client "data event": ' + clientIPList[i] );
        // close and null the socket on write error
        try {
             clientList[i] = null;
             clientList[i].end();
        } catch (err) {}
             clientList.splice(i, 1);
             clientIPList.splice(i, 1);
        }
    }            
 } 
```

此代码将调整您的内存问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T09:48:02.037

可能不会导致泄漏，但是在将套接字设置为 null 后，您正在结束（）套接字：

```
clientList[i] = null;
clientList[i].end(); 
```

不应该反过来吗？

# bash - 使用 bash 获取硬盘型号名称

> ID：13078214
> 
> 赞同：3
> 
> 时间：2012-10-25T22:20:09.413
> 
> 标签：bash, terminal

我想使用 bash 获取硬盘驱动器的各种型号名称。

如果只有一个，我可以这样做，使用这样的 hwinfo：

```
hwinfo --ide|grep Model|sed -ne '/Model/s/.*Model: "\([^"]*\)".*/\1/p' 
```

但是，当有多个时，这显然会失败。当有多个硬盘驱动器时，一个常规的 hwinfo 输出是这样的：

```
[faidoc@Delorean ~]$ hwinfo --ide
11: IDE 200.0: 10600 Disk                                       
  [Created at block.245]
  Unique ID: 3OOL.XFCtBh10jZ2
  Parent ID: qnJ_.3_X41NtKT36
  SysFS ID: /class/block/sda
  SysFS BusID: 2:0:0:0
  SysFS Device Link: /devices/pci0000:00/0000:00:0d.0/ata3/host2/target2:0:0/2:0:0:0
  Hardware Class: disk
  Model: "VBOX HARDDISK"
  Vendor: "VBOX"
  Device: "HARDDISK"
  Revision: "1.0"
  Serial ID: "VBfa9b1456-03d78f51"
  Driver: "ahci", "sd"
  Driver Modules: "ahci"
  Device File: /dev/sda
  Device Files: /dev/sda, /dev/disk/by-id/ata-VBOX_HARDDISK_VBfa9b1456-03d78f51
  Device Number: block 8:0-8:15
  BIOS id: 0x80
  Geometry (Logical): CHS 1305/255/63
  Size: 20971520 sectors a 512 bytes
  Capacity: 10 GB (10737418240 bytes)
  Config Status: cfg=new, avail=yes, need=no, active=unknown
  Attached to: #10 (SATA controller)

12: IDE 300.0: 10600 Disk
  [Created at block.245]
  Unique ID: WZeP.0xN7VsONW+D
  Parent ID: qnJ_.3_X41NtKT36
  SysFS ID: /class/block/sdb
  SysFS BusID: 3:0:0:0
  SysFS Device Link: /devices/pci0000:00/0000:00:0d.0/ata4/host3/target3:0:0/3:0:0:0
  Hardware Class: disk
  Model: "VBOX HARDDISK"
  Vendor: "VBOX"
  Device: "HARDDISK"
  Revision: "1.0"
  Serial ID: "VB350f9911-48221ae2"
  Driver: "ahci", "sd"
  Driver Modules: "ahci"
  Device File: /dev/sdb
  Device Files: /dev/sdb, /dev/disk/by-id/ata-VBOX_HARDDISK_VB350f9911-48221ae2
  Device Number: block 8:16-8:31
  BIOS id: 0x81
  Geometry (Logical): CHS 2349/255/63
  Size: 37748736 sectors a 512 bytes
  Capacity: 18 GB (19327352832 bytes)
  Config Status: cfg=new, avail=yes, need=no, active=unknown
  Attached to: #10 (SATA controller) 
```

每个驱动器都以例如“11：”或“12：”开头，所以如果我能一次得到一个，那将是解决方案。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T22:25:04.157

您可以通过以下方式获取信息：

```
hdparm -i /dev/sda | grep -i model 
```

或者，如果您只想要型号名称：

```
hdparm -i /dev/sda | perl -n -e 'print "$1\n" if (m/model=(.+?),/i);' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:23:36.467

如果你知道你想要一个非常简单的方法是`grep -A8 -E '^11:'`

```
hwinfo --ide|grep -A8 -E '^11:'|grep Model|sed -ne '/Model/s/.*Model: "\([^"]*\)".*/\1/p' 
```

上的 -A 标志在`grep`比赛“之后”以及与比赛相匹配的那一行中抓取了许多行。

还有 -B 表示“之前”，-C 表示“上下文”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T22:45:10.967

这是一个快速而肮脏的`awk`陈述，可能会有所帮助：

```
hwinfo --ide | awk '{ if($2=="IDE"){ide=$3} if($1=="Model:"){print "IDE " ide $0} }' 
```

基本上在每行的第二个单词中搜索模式“IDE”。如果找到了，它将该行的第三个单词存储在名为“ide”的变量中。

然后它在每行的第一个单词中搜索“Model:”。如果找到，它会打印它之前存储的 IDE 以及包含模型名称的整行。

所以你最终会在输出中得到名称和 IDE 位置：

```
IDE 200.0:  Model: "VBOX HARDDISK"
IDE 300.0:  Model: "VBOX HARDDISK" 
```

无论连接了多少磁盘，它都应该可以工作。

# codeigniter - CodeIgniter，消息：未定义的变量，传递数据

> ID：13078215
> 
> 赞同：0
> 
> 时间：2012-10-25T22:20:08.903
> 
> 标签：codeigniter, variables

**>> 我的控制器 - 验证注册**

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class verifyregistration extends CI_Controller {

function __construct()
{
    parent::__construct();
    $this->load->model('users_model','',TRUE);
    $this->load->library('email');
}

function index()
{
    //This method will have the credentials validation
    $this->load->library('form_validation');

    $this->form_validation->set_rules('Login', 'Login', 'trim|required|xss_clean|callback_check_database|min_length[6]|strtolower|callback_username_not_exists');
    $this->form_validation->set_rules('Haslo', 'Haslo', 'trim|required|xss_clean|min_length[6]');
    $this->form_validation->set_rules('Powtorz_Haslo', 'Powtorz haslo', 'trim|required|xss_clean|matches[Haslo]|min_length[6]');
    $this->form_validation->set_rules('Imie', 'Imie', 'trim|required|xss_clean|min_length[2]');
    $this->form_validation->set_rules('Nazwisko', 'Nazwisko', 'trim|required|xss_clean');
    $this->form_validation->set_rules('Email', 'Email', 'trim|required|xss_clean|valid_email|min_length[6]');
    $this->form_validation->set_rules('Data_urodzenia', 'Data urodzenia', 'trim|required|xss_clean');
    $this->form_validation->set_rules('Telefon', 'Telefon', 'trim|required|xss_clean|min_length[8]');
    $this->form_validation->set_rules('Miasto', 'Miasto', 'trim|required|xss_clean');
    $this->form_validation->set_rules('Ulica', 'Ulica', 'trim|required|xss_clean|min_length[6]');
    $this->form_validation->set_rules('Kod_pocztowy', 'Kod pocztowy', 'trim|required|xss_clean');
    $this->form_validation->set_error_delimiters('<span style="color: red; font-size:    12px; ; line-height: 14px; ">', '</span>');
    $this->form_validation->set_error_delimiters('<li>', '</li>');
    $data['heading'] = "My Real Heading";  

    if($this->form_validation->run() == FALSE)
    {
        $this->load->view('register/register_open',$data);
    }
    else
    {
        return false;  //this is not important
    }
} 
```

**>> 我的视图打开 - register_open**

```
<?php
$this->load->view('mains/header'); 
$this->load->view('login/loggin');
$this->load->view('mains/menu');
$this->load->view('left_column/left_column_before');
$this->load->view('left_column/menu_left');
$this->load->view('left_column/left_column');
$this->load->view('center/center_column_before');
$this->load->view('register/register_view',$data);
$this->load->view('center/center_column');
$this->load->view('right_column/right_column_before');
$this->load->view('right_column/right_column');
$this->load->view('mains/footer');
?> 
```

**>>我的观点 - register_view**

```
<?php echo form_open('verifyregistration/index'); ?>
    <form>
        <label for="username">Login:</label>
        <input type="text" size="25" id="Login" name="Login" set_value='Login' /> 
        .
        .
        .

        <legend>
            <input type="checkbox" id="regulamin" name="Regulamin" onclick="this.form.elements['Wyslij'].disabled = !this.checked" /> 
            Akceptuję regulamin serwisu. </legend>

            <label>&nbsp;</label>
            <input type="submit" name="Wyslij" value="Wyslij" disabled="disabled"/>
            <label>&nbsp;</label>

        <legend>
            <<?php echo $heading;?>
        </legend>
    </form> 
```

我有错误：

严重性：通知消息：未定义变量：数据文件名：register/register_open.php 行号：9 此行->`$this->load->view('register/register_view',$data);`

严重性：通知消息：未定义变量：标题文件名：register/register_view.php 行号：48 此行->`<<?php echo $heading;?>`

如何将数据传递到另一个视图？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T22:26:42.670

在您的控制器中，更改

```
$this->load->view('register/register_open',$data) 
```

至

```
$this->load->view('register/register_open',array('data' => $data)); 
```

当你这样做时`$this->load->view('view', $variable)`，它需要`$variable`并使用 php 函数`extract()`将数组键转换为变量。所以，如果你想`$data`在嵌套视图中使用变量，你必须像我上面那样发送另一个数组。

# c++ - 3D 和 UI 工具包

> ID：13078218
> 
> 赞同：2
> 
> 时间：2012-10-25T22:20:35.303
> 
> 标签：c++, .net, graphics, ogre, irrlicht

我必须开发一个基本的库存系统，我的客户希望以 3D 形式查看库存中的所有对象及其在仓库中的位置。问题是我必须尽快开发这个，交货时间是我的首要任务。所以我得出的结论是，我需要一个强大的 3D 图形引擎和一个可以轻松集成的 UI 工具包。我在 C++、Qt、OpenGL、VTK、C# 和 WinForms 方面拥有丰富的经验。根据我的经验，VTK 在纹理方面不太好，它需要更多的工作来添加我的客户想要的视觉效果（如动画、视觉效果等）。我已经用 WinForms 尝试过 Axiom。我经历了地狱般的样本加载和运行（框架不兼容，未找到渲染引擎，缺少编解码器本机依赖项等）。我一直在评估不同的选择：

1.  Qt + 食人魔 (C++)
2.  WinForms + Axiom (.NET)
3.  Qt + Irrlicht (C++)

你认为哪个是最好的选择？你能给我推荐一些其他的可能性吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T04:25:21.650

我花了很多时间使用 Mogre（Ogre 的 C# 包装器）和 WinForms 进行开发。在我看来，这是一个很好的组合，因为在 C# WinForms 中开发 GUI 的速度比任何 C++ 选项都要快得多。

如果你不介意在 C++ Ogre 库周围使用 C# 包装器，我建议使用 Mogre 而不是 Axiom。它非常稳定，有一些优秀的维护者，并且很好地跟上了最新版本的 Ogre。Ogre 论坛上的任何代码都可以轻松移植到 C#，因为大多数 API 是相同的。

Axiom 是 Ogre 的纯 .NET 端口，尽管它落后了几个版本并且可能缺少一些功能。我没有花很多时间在它上面，但我相信它的主要优势在于它都是托管代码，如果这对你很重要的话。

我不久前开始了一个名为 Glue Editor 的开源项目。它不再维护，但它有很多代码可以让 Mogre 使用 WinForms。您应该能够下载存储库并开箱即用地编译它。欢迎您获取代码并随意使用它。

[https://bitbucket.org/glue/glueeditor/src](https://bitbucket.org/glue/glueeditor/src)

如果你决定走 Qt + Ogre 的道路，有一个名为 Ogitor 的项目，你可能想看看。

[https://bitbucket.org/jacmoe/ogitor/src](https://bitbucket.org/jacmoe/ogitor/src)

您可能还想查看 XNA 和 MonoGame。XNA 是微软用 C# 制作游戏的框架。它相当简单，但它的学习曲线比 Ogre、Mogre 或 Axiom 低得多。MonoGame 是 XNA 框架的开源实现，适用于非 Microsoft 平台（例如 Android、iOS、Linux）。

[http://monogame.codeplex.com/](http://monogame.codeplex.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T18:36:16.470

我推荐 Qt + Ogre (C++)，尽管我不得不承认这是你列表中我有很多经验的唯一组合。Ogre 的好处是文档的数量和活跃的社区。很多问题都得到了回答和记录。图形本身可能可以在所有库组合中创建。但是，我喜欢 Ogre 中对象交互的简单集成。该标准基于边界框，但也有可用于三角形相交的代码。祝您好运！

# ruby-on-rails - rails_admin gem Encoding::CompatibilityError

> ID：13078223
> 
> 赞同：0
> 
> 时间：2012-10-25T22:20:51.963
> 
> 标签：ruby-on-rails, gem, rails-admin

我刚刚尝试过，`rails_admin`在保存包含变音符号的字符串时遇到了问题（例如“ü，ö，ä ...”）。模型已保存到数据库，但后续屏幕失败。

```
incompatible character encodings: UTF-8 and ASCII-8BIT

Extracted source (around line #17): 
```

```
 14:   = menu_for((@abstract_model ? (@object.try(:persisted?) ? :member : :collection) : :root), @abstract_model, @object)
15:   = content_for :contextual_tabs
16: = yield
17: 
18: %footer
19:   %p © RailsAdmin 2012 
```

我还尝试使用 before_save 钩子对 utf8 中的字符串进行编码，但是在按下保存后，错误仍然存​​在：

## 我的模特

```
# encoding: utf-8
require 'carrierwave/orm/activerecord'
class Product < ActiveRecord::Base
  mount_uploader :img_small, ProductImgSmallUploader
  mount_uploader :img_large, ProductImgLargeUploader

  attr_accessible :img_small, :img_small_cache, :remove_img_small
  attr_accessible :img_large, :img_large_cache, :remove_img_large
  attr_accessible :title_de, :title_en, :description_de, :description_en, :visible

  before_save do
    [:title_de,:title_en,:description_de,:description_en].each do |arg|
      if self.try arg
        self.send("#{arg}=", self.send(arg).encode('UTF-8'))
      end
    end
  end
end 
```

关于如何在我这边解决它的任何建议？还是我必须分叉宝石？

## 完整的堆栈跟踪

```
 rails_admin (0.1.2) app/views/layouts/rails_admin/pjax.html.haml:17:in `_c___uby____lib_ruby_gems_______gems_rails_admin_______app_views_layouts_rails_admin_pjax_html_haml___1061959050_34768032'
actionpack (3.2.8) lib/action_view/template.rb:145:in `block in render'
activesupport (3.2.8) lib/active_support/notifications.rb:125:in `instrument'
actionpack (3.2.8) lib/action_view/template.rb:143:in `render'
actionpack (3.2.8) lib/action_view/renderer/template_renderer.rb:47:in `block (2 levels) in render_template'
actionpack (3.2.8) lib/action_view/renderer/abstract_renderer.rb:38:in `block in instrument'
activesupport (3.2.8) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.8) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.8) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.8) lib/action_view/renderer/abstract_renderer.rb:38:in `instrument'
actionpack (3.2.8) lib/action_view/renderer/template_renderer.rb:46:in `block in render_template'
actionpack (3.2.8) lib/action_view/renderer/template_renderer.rb:54:in `render_with_layout'
actionpack (3.2.8) lib/action_view/renderer/template_renderer.rb:45:in `render_template'
actionpack (3.2.8) lib/action_view/renderer/template_renderer.rb:18:in `render'
actionpack (3.2.8) lib/action_view/renderer/renderer.rb:36:in `render_template'
actionpack (3.2.8) lib/action_view/renderer/renderer.rb:17:in `render'
actionpack (3.2.8) lib/action_view/helpers/rendering_helper.rb:24:in `render'
haml (3.1.7) lib/haml/helpers/action_view_mods.rb:11:in `block in render_with_haml'
haml (3.1.7) lib/haml/helpers.rb:90:in `non_haml'
haml (3.1.7) lib/haml/helpers/action_view_mods.rb:11:in `render_with_haml'
rails_admin (0.1.2) app/views/layouts/rails_admin/application.html.haml:27:in `_c___uby____lib_ruby_gems_______gems_rails_admin_______app_views_layouts_rails_admin_application_html_haml___191072136_5393304'
actionpack (3.2.8) lib/action_view/template.rb:145:in `block in render'
activesupport (3.2.8) lib/active_support/notifications.rb:125:in `instrument'
actionpack (3.2.8) lib/action_view/template.rb:143:in `render'
actionpack (3.2.8) lib/action_view/renderer/template_renderer.rb:59:in `render_with_layout'
actionpack (3.2.8) lib/action_view/renderer/template_renderer.rb:45:in `render_template'
actionpack (3.2.8) lib/action_view/renderer/template_renderer.rb:18:in `render'
actionpack (3.2.8) lib/action_view/renderer/renderer.rb:36:in `render_template'
actionpack (3.2.8) lib/action_view/renderer/renderer.rb:17:in `render'
actionpack (3.2.8) lib/abstract_controller/rendering.rb:110:in `_render_template'
actionpack (3.2.8) lib/action_controller/metal/streaming.rb:225:in `_render_template'
actionpack (3.2.8) lib/abstract_controller/rendering.rb:103:in `render_to_body'
actionpack (3.2.8) lib/action_controller/metal/renderers.rb:28:in `render_to_body'
actionpack (3.2.8) lib/action_controller/metal/compatibility.rb:50:in `render_to_body'
actionpack (3.2.8) lib/abstract_controller/rendering.rb:88:in `render'
actionpack (3.2.8) lib/action_controller/metal/rendering.rb:16:in `render'
actionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:40:in `block (2 levels) in render'
activesupport (3.2.8) lib/active_support/core_ext/benchmark.rb:5:in `block in ms'
c:/Ruby193/lib/ruby/1.9.1/benchmark.rb:295:in `realtime'
activesupport (3.2.8) lib/active_support/core_ext/benchmark.rb:5:in `ms'
actionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:40:in `block in render'
actionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:83:in `cleanup_view_runtime'
activerecord (3.2.8) lib/active_record/railties/controller_runtime.rb:24:in `cleanup_view_runtime'
actionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:39:in `render'
remotipart (1.0.2) lib/remotipart/render_overrides.rb:8:in `render'
rails_admin (0.1.2) lib/rails_admin/config/actions/index.rb:35:in `block (4 levels) in '
actionpack (3.2.8) lib/action_controller/metal/mime_responds.rb:196:in `call'
actionpack (3.2.8) lib/action_controller/metal/mime_responds.rb:196:in `respond_to'
rails_admin (0.1.2) lib/rails_admin/config/actions/index.rb:32:in `block (2 levels) in '
(eval):8:in `instance_eval'
(eval):8:in `index'
actionpack (3.2.8) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.8) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.2.8) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.2.8) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
activesupport (3.2.8) lib/active_support/callbacks.rb:469:in `_run__375825897__process_action__876887233__callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.8) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.8) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.2.8) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.8) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.8) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.8) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
activerecord (3.2.8) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.8) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.8) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.8) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.8) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.8) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:36:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:600:in `call'
railties (3.2.8) lib/rails/engine.rb:479:in `call'
railties (3.2.8) lib/rails/railtie/configurable.rb:30:in `method_missing'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:600:in `call'
rack-pjax (0.6.0) lib/rack/pjax.rb:12:in `call'
warden (1.1.1) lib/warden/manager.rb:35:in `block in call'
warden (1.1.1) lib/warden/manager.rb:34:in `catch'
warden (1.1.1) lib/warden/manager.rb:34:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.1) lib/rack/etag.rb:23:in `call'
rack (1.4.1) lib/rack/conditionalget.rb:25:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/head.rb:14:in `call'
remotipart (1.0.2) lib/remotipart/middleware.rb:30:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'
rack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/cookies.rb:339:in `call'
activerecord (3.2.8) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.8) lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.8) lib/active_support/callbacks.rb:405:in `_run__979894838__call__1042350755__callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.8) lib/rails/rack/logger.rb:26:in `call_app'
railties (3.2.8) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.1) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.8) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.1) lib/rack/lock.rb:15:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.8) lib/rails/engine.rb:479:in `call'
railties (3.2.8) lib/rails/application.rb:223:in `call'
rack (1.4.1) lib/rack/content_length.rb:14:in `call'
railties (3.2.8) lib/rails/rack/log_tailer.rb:17:in `call'
rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'
c:/Ruby193/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
c:/Ruby193/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
c:/Ruby193/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

## 使用的宝石

```
 $ bundle show
Gems included by the bundle:
  * actionmailer (3.2.8)
  * actionpack (3.2.8)
  * activemodel (3.2.8)
  * activerecord (3.2.8)
  * activeresource (3.2.8)
  * activesupport (3.2.8)
  * arel (3.0.2)
  * bcrypt-ruby (3.0.1)
  * bootstrap-sass (2.1.0.1)
  * builder (3.0.2)
  * bundler (1.1.4)
  * carrierwave (0.7.0)
  * coffee-rails (3.2.2)
  * coffee-script (2.2.0)
  * coffee-script-source (1.3.3)
  * devise (2.0.4)
  * erubis (2.7.0)
  * execjs (1.4.0)
  * font-awesome-sass-rails (2.0.0.0)
  * haml (3.1.7)
  * hike (1.2.1)
  * i18n (0.6.1)
  * journey (1.0.4)
  * jquery-rails (2.1.2)
  * jquery-ui-rails (2.0.2)
  * json (1.7.5)
  * kaminari (0.14.1)
  * mail (2.4.4)
  * mime-types (1.19)
  * multi_json (1.3.6)
  * mysql (2.8.1)
  * nested_form (0.2.3)
  * nokogiri (1.5.5)
  * orm_adapter (0.0.7)
  * polyglot (0.3.3)
  * rack (1.4.1)
  * rack-cache (1.2)
  * rack-pjax (0.6.0)
  * rack-ssl (1.3.2)
  * rack-test (0.6.1)
  * rails (3.2.8)
  * rails_admin (0.1.2)
  * railties (3.2.8)
  * rake (0.9.2.2)
  * rdoc (3.12)
  * remotipart (1.0.2)
  * sass (3.2.1)
  * sass-rails (3.2.5)
  * sprockets (2.1.3)
  * sqlite3 (1.3.6)
  * thor (0.16.0)
  * tilt (1.3.3)
  * treetop (1.4.10)
  * twitter-bootstrap-rails (2.0.7 ad1b849)
  * tzinfo (0.3.33)
  * uglifier (1.3.0)
  * warden (1.1.1) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T20:35:38.677

我通过使用 msql2 gem 而不是 mysql gem 解决了这个问题：

> “请注意，我使用的是 mysql2 适配器而不是 mysql。此时（2011 年 2 月）mysql gem 不支持编码。在 Gemfile 中将 mysql 替换为 mysql2 并运行 bundle。” [[参见 rails-utf-8-and-heroku]](http://craiccomputing.blogspot.de/2011/02/rails-utf-8-and-heroku.html)

# java - java SSLHandshakeException 通用 SSLEngine

> ID：13078226
> 
> 赞同：8
> 
> 时间：2012-10-25T22:21:03.427
> 
> 标签：java, ssl

我有一个 Java 服务器应用程序（加载了它自己的服务器证书）尝试与另一台服务器安全连接（微软 - 有它的服务器证书）。

他们每个人都加载了受信任的 ROOT-CA 证书，我可以在两台服务器上清楚地看到。在 Java 方面，我在 JRE lib/security CA 信任库以及应用程序的信任库中加载了 root-ca 证书。在 Microsoft 服务器上，它使用 MMC 工具加载了 root-ca。

在 SSL 握手期间，我不断收到此错误：

> javax.net.ssl.SSLHandshakeException：一般 SSLEngine 问题........... 引起：java.security.cert.CertificateException：根证书（主题：CN=blah.com，OU=ABC Communications Inc.， [blah.com] 的 O=CORP, C=US) 不受信任。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-25T22:29:49.020

该消息清楚地表明根证书不受信任。所以你没有做你说你做的正确的事。

# sql - SQL - 在不使用数据透视等的情况下转换行

> ID：13078228
> 
> 赞同：0
> 
> 时间：2012-10-25T22:21:07.567
> 
> 标签：sql, rows

我需要一些帮助来组织我必须创建的报告的表格。不幸的是，表格的布局很难使用。我知道数据透视函数，但在这种情况下它不起作用，因为我使用的是 Intersystems 的缓存 SQL。不过，我并没有把这个问题当成那种问题来营销，因为缓存 SQL 的帮助基础非常小。如果你能用你的语言解决它，它将帮助我。这是表格：

```
PID    DE_Num   DE_Val
1001   102    arbitrary value
1001   650    arbitrary value
1001   6225    10/12/12
1001   6227    01/14/09
1343   809    arbitrary value
1343   103    arbitrary value
1343   6225    11/23/11
1343   412    arbitrary value
1343   6227    03/07/01
1222   6225    05/19/12
1222   6227    08/08/08 
```

我需要结果表如下所示：

```
PID    DE_Num    DE_Val
1001    6225    10/12/12
1001    6227    01/14/09
1343    6225    11/23/11
1343    6227    03/07/01
1222    6225    05/19/12
1222    6227    08/08/08 
```

有什么建议么？如果您需要更多信息，请告诉我。同样，我不需要缓存 SQL 特定信息。一般来说，信息同样有很大帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:34:39.537

好吧，产生这样的输出并不难。

```
select *
from your_table_name
where DE_Num > 6000
order by PID, DE_Num 
```

不过，如果那是您正在寻找的东西，我会感到非常惊讶。我在您的问题中没有看到任何暗示您需要 PIVOT 或任何类似 PIVOT 的东西。

# android - 通知自动取消不会调用 DeleteIntent

> ID：13078230
> 
> 赞同：12
> 
> 时间：2012-10-25T22:21:12.600
> 
> 标签：android, google-cloud-messaging

我正在我的应用程序中实现 GCM 并保留通知哈希以跟踪通知阴影中的内容（我必须根据用户是否在应用程序中更改意图）。

我为所有通知设置了 deleteIntent PendingIntent。所有这一切都是从我的本地哈希中删除通知，这样它就不会再更新了。如果我清除所有或滑动以删除通知，则意图被触发。但是，我还将通知设置为自动取消。单击通知不会触发我的通知的 deleteIntent。

我的问题是，当我的通知被自动取消时，有什么方法可以通知？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-12T16:34:41.950

[已经报告了](https://code.google.com/p/android/issues/detail?id=41253)这个错误，但它看起来根本没有被调查过。为了解决这个问题，这就是我所做的：

*   关闭自动取消
*   对内容使用广播并删除具有不同操作的意图
*   广播接收器检查动作
    *   内容操作：点击和删除操作，手动取消通知
    *   删除操作：只做删除操作

例如：

### 发送通知

```
Notification.Builder builder = new Notification.Builder(context)
    // Set other properties (not auto-cancel)
    .setContentIntent(PendingIntent.getBroadcast(context, 0, new Intent(NOTIFICATION_CLICKED_ACTION), 0))
    .setDeleteIntent(PendingIntent.getBroadcast(context, 0, new Intent(NOTIFICATION_DELETED_ACTION), 0));
notificationManager.notify(NOTIFICATION_ID, builder.build()); 
```

### 接收广播

```
if (intent.getAction().equals(NOTIFICATION_CLICKED_ACTION)) {
    startActivity(new Intent(context, MyActivity.class));
    notificationManager.cancel(NOTIFICATION_ID);
}
// Do deletion behaviour here (for both click and delete actions) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T01:43:01.400

[这](http://developer.android.com/reference/android/app/Notification.Builder.html#setDeleteIntent%28android.app.PendingIntent%29)是Android SDK 文档中所述的 DeleteIntent 的正确行为：

> 提供 PendingIntent 以**在用户明确清除通知时**发送。

只有当用户通过滑动或使用通知菜单的“全部清除”功能明确清除通知时，才会调用 DeleteIntent。即使 AutoCancel 设置为 True，点击通知也只会触发 ContentIntent。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T12:37:51.223

文档[在这里](http://developer.android.com/reference/android/app/Notification.html#FLAG_AUTO_CANCEL)和[这里](http://developer.android.com/reference/android/app/Notification.html#contentIntent)说，单击带有 FLAG_AUTO_CANCEL 的通知会自动取消它。此行为还意味着常规 contentIntent（如果已设置）将与自动取消一起触发，因为它是为响应用户的点击操作而触发的。使用 contentIntent 字段和 deleteIntent 来检测由显式用户点击执行的取消。

# javascript - 从 Angular 指令调用的函数访问属性/$element 上下文

> ID：13078231
> 
> 赞同：2
> 
> 时间：2012-10-25T22:21:17.263
> 
> 标签：javascript, html, angularjs

在[指令定义](http://docs.angularjs.org/guide/directive#Attributes)中，有一个用于访问 $element 和 $attrs 的 API，因此您可以返回调用指令的元素。使用像 ng-class 这样的标准指令调用自定义函数时，如何访问 $element 和 $attrs？

* * *

**编辑**：我知道这不是惯用的方法。这个问题适用于快速原型，这对 Angular 的许多功能都有很大的用处。只是不是关于可持续性、关注点分离等的那些。我主要关心的是速度。因此，能够使用内置指令和快速控制器方法快速完成某些事情实际上可以成为一种美德，并且可以赢得在未来进行更全面和更正确实施的机会......

* * *

在这种情况下，我只是根据这篇文章和这篇文章的值，将上下文类[添加](https://stackoverflow.com/questions/12592472/how-to-highlight-a-current-menu-item-in-angularjs)到[导航](https://stackoverflow.com/questions/12592472/how-to-highlight-a-current-menu-item-in-angularjs)`.active`元素中。但是，在这些示例中，您需要显式且冗余地将属性内容的副本作为参数传递给您从中调用的函数。但是有没有办法以编程方式从内部访问属性并避免将相同的内容作为 arg 冗余传递？`$location.path()``href``getClass()``ng-class``href``getClass()`

例如，具有`getClass()`我想象的功能的控制器可以工作：

```
function navCtrl($scope, $routeParams) {
    $scope.getClass = function($element, $attrs) {
        if ($location.path().substr(0, path.length) == $attrs.href) {
            return "active"
        } else {
            return ""
        }
    }
} 
```

然后你可以简单而优雅地调用它：

```
<a ng-class="getClass()" href="/tasks">Tasks</a> 
```

而不是：

```
<a ng-class="getClass('/tasks')" href="/tasks">Tasks</a> 
```

（我认识到另一种选择是创建一个执行此操作的自定义指令，但现在我只想弄清楚是否可以从指令调用的控制器函数中访问 $attrs 和/或 $element 。谢谢！）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T01:06:24.480

你实际上*可以*这样做......**但你不应该这样做。**哈哈...

这是如何做你所要求的......

在您的标记中，将 $event 传递给您的函数。

```
<a ng-click="test($event)" href="whatever">Click Me</a> 
```

然后在您的控制器中，获取事件的目标元素：

```
$scope.test = function($event) {
    alert($event.target.href);
}; 
```

现在这就是你可能不应该这样做的原因：

如果您引用 DOM，或在控制器中操作 DOM，您将危及依赖注入以及 Angular 结构中关注点的分离。当然，如果您正在测试您的函数，您仍然可以将 $event 作为依赖项注入，但取决于您在该函数内部执行的操作，您可能仍然破坏了您的 DI，并且您正试图让控制器执行指令工作（这是为了防止你的控制器与你的标记紧密耦合）

也就是说，如果你所做的只是获得一个值，那可能没问题，但你仍然在某种程度上将你的控制器耦合到你的标记。如果你对那个 DOM 元素做任何其他事情，你就没有保留。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T23:20:02.040

我不认为你能做到这一点。角度哲学是避免直接从控制器访问 DOM。您已经确定了在 Angular 中执行此操作的两个选项：

*   将 href 作为参数传递，即。getClass('/任务')
*   或者，编写自定义指令

或者，如果该类纯粹是展示性的并且不影响您的应用程序的运行方式，那么您可以忽略 angular 并使用快速而肮脏的 jQuery 函数来为您完成这项工作。

缺乏与 DOM 的直接交互一开始可能有点奇怪，但从长远来看，随着代码库的增长、变得更加复杂和需要更多测试，这是天赐之物。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T11:32:27.527

这是一个完全不同的答案：您不需要 Angular 来根据 href 更改样式。您可以为此使用 CSS 选择器。

在你的风格中：

```
a[href="/something"] {
    background-color: red;
} 
```

这与您可能对 ng-class 所做的任何事情相结合应该是您需要的一切。

# asp.net - 将一个可为空的位字段绑定到 ASP.Net 中文本框的 TextMode 属性

> ID：13078234
> 
> 赞同：0
> 
> 时间：2012-10-25T22:21:33.493
> 
> 标签：asp.net, eval

我有一张包含问题列表的表格。属性之一是`largeText`。
`NULL`意味着隐藏文本框意味着显示多行文本
`TRUE`框
`FALSE`意味着显示单行文本框。

这就是我想要做的

```
<asp:TextBox ID="tbxFreeResponse" runat="server"
             Visible='<%# Eval("largeText") != null %>'
             TextMode = '<%# (Eval("largeText") == (object)true) ?
                               TextBoxMode.SingleLine : 
                               TextBoxMode.MultiLine%>'/> 
```

`Eval("largeText") == (object)true`总是评估`FALSE`为。我错过了什么？强制转换是必要的`(object)`，否则它会抱怨类型不兼容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:43:17.410

这就是我的诀窍，希望有人会觉得这很有用。

```
<asp:TextBox ID="tbxFreeResponse" runat="server" 
             Visible='<%# Eval("largeText") != null %>'
             TextMode = '<%# (!(Eval("largeText") is DBNull) && (bool)Eval("largeText")) ? 
                             TextBoxMode.MultiLine :
                             TextBoxMode.SingleLine%>'/> 
```

# backend - 我为特定月度文件运行的查询的后端错误：六月

> ID：13078240
> 
> 赞同：1
> 
> 时间：2012-10-25T22:21:54.287
> 
> 标签：backend

我一直在尝试在不同场合整晚运行此查询，并且似乎一直收到“后端错误”。似乎所有其他月份都运行了（尽管有些人确实遇到了错误，所以我重新运行并且它起作用了）。

查询是：

```
SELECT 
  raw.c.Country_Name AS Country, 
  ytfin.yt_Channel AS YT_Channel, 
  ytfin.Account AS YT_Account, 
  raw.y.Content_Type AS Content_Type, 
  MIN(ytfin.Novation_Date) AS Novation_Date, 
  AVG(ytfin.Video_Duration_sec) AS Video_Duration_sec, 
  SUM(raw.y.Watch_Page_Views) AS Watch_Page_Views, 
  SUM(raw.y.Embedded_Player_Views) AS Embedded_Player_Views, 
  SUM(raw.y.Total_Earnings) AS Total_Earnings, 
  SUM(raw.y.Gross_YouTube_sold_Revenue) AS Gross_YouTube_sold_Revenue, 
  SUM(raw.y.Gross_Partner_sold_Revenue) AS Gross_Partner_sold_Revenue, 
  SUM(raw.y.Gross_AdSense_sold_Revenue) AS Gross_AdSense_sold_Revenue 
FROM 
  (SELECT 
     y.Video_ID, 
     y.Custom_ID, 
     y.Day, 
     y.Country, 
     c.Country_Name, 
     y.Content_Type, 
     y.Policy, 
     y.Embedded_Player_Views, 
     y.Watch_Page_Views, 
     y.Gross_YouTube_sold_Revenue, 
     y.Gross_Partner_sold_Revenue, 
     y.Gross_AdSense_sold_Revenue, 
     y.Total_Earnings 
   FROM 
     Youtube_Raw_Country.201206_Jun AS y 
   LEFT OUTER JOIN 
     Country_Codes.iso_3166_1_country_codes as c 
     ON y.Country = c.Code) AS raw
INNER JOIN 
  All_YT_Video_IDs.201206_Jun_2012 AS ytfin 
  ON raw.y.Video_ID = ytfin.Video_ID
GROUP BY Country, YT_Channel,YT_Account, Content_Type 
```

# c# - 了解 WebRequest

> ID：13078241
> 
> 赞同：0
> 
> 时间：2012-10-25T22:22:03.083
> 
> 标签：c#, .net, performance, webrequest

在我的代码（C#）中，我使用的是 WebRequest：

```
var request = WebRequest.Create(url); 
```

由于某种原因，这条线大约需要 2-3 秒才能运行。我一直在寻找解决方案，但找不到任何用于创建请求的解决方案。我尝试了不同的网址（http 和 https、google 等），但似乎没有任何帮助。有没有其他人经历过这样的行为？谁能解释在创建请求期间到底发生了什么？有什么选择吗？

顺便说一句 - 我使用的是 64 位 Win 7（训练营）

编辑 - 使用秒表测量以下代码（无线）的 3.126 秒：

```
var request = WebRequest.Create("http://www.google.com"); 
```

在同一个网络上，仅有线，耗时 0.01 秒。

感谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:14:45.847

[有些](https://stackoverflow.com/a/3603413/120955) [人](https://stackoverflow.com/a/935728/120955)发现代理检测可能需要非常长的时间。如果您知道不会有代理，请尝试将 WebRequest 的代理属性设置为 null。

```
var request = WebRequest.Create("http://www.google.com");
request.Proxy = null; 
```

## 更新

我没有任何其他想法，但这里有一些你可以尝试缩小问题范围的事情。

1.  通过将以下代码放入配置文件中来启用日志记录：

    ```
    <configuration>
      <system.diagnostics>
        <trace autoflush="true" />
        <switches>
          <add name="System.Net" value="Verbose"/>
        </switches>
      </system.diagnostics>
    </configuration> 
    ```

2.  查看`WebRequest.Create`ILSpy 或类似工具的源代码，并尝试直接执行相同的操作。例如，您可以尝试创建一个`new HttpWebRequest(...)`而不是调用`WebRequest.Create`，看看您是否得到相同的行为。

# r - R代码mcmcplots函数

> ID：13078242
> 
> 赞同：0
> 
> 时间：2012-10-25T22:22:08.483
> 
> 标签：r, plot, mcmc

有没有办法让 R`mcmcplot()`函数在调用时不打开浏览器？我需要在集群上运行我的 R 代码，如果`mcmcplot()`尝试打开浏览器，它会呕吐。

可以将输出转储到文件中吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T22:38:45.700

该函数将所有内容写入文件并在浏览器中打开它。如果您不想打开浏览器，我建议您编辑函数以传递是否要在浏览器中打开作为参数。您可以通过键入不带任何括号的名称来检索该函数。

`mcmcplot`

然后将该输出复制到编辑器并在开始时更改函数的名称并添加参数：

```
mcmcplotnew=function (mcmcout, parms = NULL, regex = NULL, random = NULL, 
    leaf.marker = "[\\[_]", dir = tempdir(), filename = "MCMCoutput", 
    extension = "html", title = NULL, heading = title, col = NULL, 
    lty = 1, xlim = NULL, ylim = NULL, style = c("gray", "plain"), 
    greek = FALSE,ShouldIPlotinbrowser=T)   #new argument here 
```

然后还有更多的功能部分

然后最后有

```
 cat("\r", rep(" ", getOption("width")), "\r", sep = "")
    cat("\n</div>\n</div>\n", file = htmlfile, append = TRUE)
    .html.end(htmlfile)
    full.name.path <- paste("file://", htmlfile, sep = "")
    browseURL(full.name.path)
    invisible(full.name.path)
} 
```

在您有 browsURL 行的地方，将其设置为：

```
if(ShouldIPlotinbrowser) { browseURL(full.name.path) } 
```

然后在运行之前初始化该函数：

```
mcmcplotnew(whatever, usual, arguments,then,ShouldIPlotinbrowser=F) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T22:40:43.407

看[源码](https://gist.github.com/s-mckay-curtis/mcmcplots/blob/master/mcmcplots/R/mcmcplot.R#L72)，好像没有。那里有一个无条件的呼唤`browseURL()`。也许通过制作一个在全局命名空间中什么都不做的函数的虚拟版本，可以避免它的影响。

```
browseURL <- identity 
```

这也可能会破坏其他浏览器活动，因此在`mcmcplot`调用之后，您可能想要

```
rm(browseURL) 
```

或者，复制`mcmcplot`除该`browseURL`行之外的所有代码并改用该函数。

# c++ - 如何在光线追踪器中移动相机？

> ID：13078243
> 
> 赞同：6
> 
> 时间：2012-10-25T22:22:23.820
> 
> 标签：c++, camera, transformation, raytracing

我目前正在研究光线追踪技术，我认为我做得很好；但是，我还没有涵盖相机。

`(-width/2, height/2, 200)`到目前为止，我使用了一个平面片段作为视图平面，它位于`(width/2, -height/2, 200)`[200 只是 z 的固定数量，可以更改] 之间。

除此之外，我主要使用相机`e(0, 0, 1000)`，并使用透视投影。

我将光线从点发送`e`到像素，并在计算像素颜色后将其打印到图像的相应像素。![在此处输入图像描述](../Images/14162eb77c2c4f61a9ed77590477cfd7.png)

这是我创建的图像。希望您可以通过查看图像来猜测眼睛和视图平面的位置。

我的问题从这里开始。是时候移动我的相机了，但我不知道如何将 2D 视图平面坐标映射到规范坐标。有没有一个转换矩阵？

我认为的方法需要知道视图平面上像素的 3D 坐标。我不确定这是使用正确的方法。所以你有什么建议？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-25T23:20:43.903

有多种方法可以做到这一点。这就是我所做的：

1.  选择一个点来表示相机位置 ( `camera_position`)。
2.  选择一个向量来指示相机正在看的方向 ( `camera_direction`)。（如果您知道相机正在查看的点，则可以通过`camera_position`从该点减去该点来计算该方向向量。）您可能想要归一化 ( `camera_direction`)，在这种情况下，它也是图像平面的法线向量。
3.  选择另一个从相机的角度（大约）“向上”的归一化向量（`camera_up`）。
4.  `camera_right = Cross(camera_direction, camera_up)`
5.  `camera_up = Cross(camera_right, camera_direction)`（这可以纠正选择“向上”的任何错误。）

在 处可视化图像平面的“中心” `camera_position + camera_direction`。上和右向量位于图像平面中。

您可以选择图像平面的矩形部分以对应您的屏幕。这个矩形部分的宽度或高度与 camera_direction 的长度之比决定了视野。要放大，您可以增加 camera_direction 或减少宽度和高度。做相反的事情来缩小。

所以给定一个像素位置`(i, j)`，你想要`(x, y, z)`图像平面上的那个像素。从中您可以减去`camera_position`以获得光线矢量（然后需要对其进行归一化）。

```
Ray ComputeCameraRay(int i, int j) {
  const float width = 512.0;  // pixels across
  const float height = 512.0;  // pixels high
  double normalized_i = (i / width) - 0.5;
  double normalized_j = (j / height) - 0.5;
  Vector3 image_point = normalized_i * camera_right +
                        normalized_j * camera_up +
                        camera_position + camera_direction;
  Vector3 ray_direction = image_point - camera_position;
  return Ray(camera_position, ray_direction);
} 
```

这只是说明性的，因此未进行优化。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T22:32:27.043

对于光栅化渲染器，您往往需要一个转换矩阵，因为这是您直接从 3D 坐标映射到屏幕 2D 坐标的方式。

对于光线追踪，这不是必需的，因为您通常*从*2D 空间中的已知像素坐标开始。

给定眼睛位置、屏幕中心的 3 空间中的一个点以及“上”和“右”的向量，很容易计算从眼睛位置穿过指定位置的 3D“射线”像素。

我之前在[https://stackoverflow.com/a/12892966/6782上发布了一些来自我自己的光线追踪器的示例代码](https://stackoverflow.com/a/12892966/6782)

# php - PHP 函数“scandir”在 Windows 资源管理器中打开已删除目录时显示已删除目录

> ID：13078251
> 
> 赞同：1
> 
> 时间：2012-10-25T22:23:04.333
> 
> 标签：php

我在装有 PHP 5.4.4 的 Windows Server 2008 R2 机器上运行 Apache HTTP 服务器 2.4。

我的`E:\`驱动器上有以下目录结构：

```
E:\Dir1\Dir2\Dir3 
```

`Dir1`除了上面显示的子目录之外，所有目录（`Dir2`和`Dir3`）都是空的（它们没有文件）。

我正在尝试删除`Dir3`然后查看目录的内容`Dir2`以确保那里没有任何内容。我编写了以下 PHP 脚本来测试它：

```
<?php

    $currentDir = "E:\\Dir1\\Dir2\\Dir3";

    $parentDir = dirname( $currentDir );  // Get the parent directory for Dir3.

    rmdir ( $currentDir );  // Remove directory Dir3.

    echo "<b>Current directory:</b> " . $currentDir . " <b><< I don't exist, I was just deleted.</b><br />";
    echo "<b>Parent directory:</b> " . $parentDir. "<br />";

    echo "<b>According to 'scandir', the parent directory contains:</b> ";
    print_r( scandir( $parentDir, SCANDIR_SORT_NONE ) );
    echo "<br /><br />";

?> 
```

如果我**没有**在 Windows 资源管理器中`Dir3`打开，上面的脚本可以完美运行并提供以下输出：

> **当前目录：** E:\Dir1\Dir2\Dir3 **<< 我不存在，我只是被删除了。**
> 
> **父目录：** E:\Dir1\Dir2
> 
> **根据'scandir'，父目录包含：** Array ( [0] => . [1] => .. )

但是，如果我`Dir3`在 Windows 资源管理器中打开，我会得到以下输出：

> **当前目录：** E:\Dir1\Dir2\Dir3 **<< 我不存在，我只是被删除了。**
> 
> **父目录：** E:\Dir1\Dir2
> 
> **根据'scandir'，父目录内容：** Array ( [0] => . [1] => .. [2] => Dir3 )

请注意，`Dir3`出现在 的内容数组中`Dir2`。换句话说，即使我知道它不存在，`scandir()`认为它仍然存在（Windows 资源管理器将我踢回）。`Dir3``Dir2`

有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T22:39:37.807

当您在 Windows 资源管理器中打开目录时。中存在`handle`一个。从操作系统内部获取目录/文件存在的详细信息。因此，当目录打开并且您将其删除并立即运行 a 时，Windows 会返回它，因为目录句柄上有 a 。此句柄仅在您关闭目录时关闭（或者我猜在操作系统级别发生了一些内部垃圾收集）。当目录没有在 Windows 资源管理器中打开时，这些边缘情况都不会发生，所以一切都像魅力一样。`directory``OS-es memory``Scandir``scandir``"lock"`

再次是 Windows 的行为之一。我认为`clearstatcache()`是一种选择，但我相信它只适用于`posix-compliant`Os-es 并且`scandir()`不受它的影响。

# vba - 如何在 VBA 中使用 .OpenText 打开以第一列（如“ID”）开头的文本文件而不会出现 SYLK 错误

> ID：13078256
> 
> 赞同：1
> 
> 时间：2012-10-25T22:23:38.560
> 
> 标签：vba, excel

我在 Excel VBA 的`.OpenText`方法中遇到了一个令人讨厌的小错误。当前两个字母为大写“ID”时，打开任何文本或 CSV 文件时都会出错。这是来自 MS 的文章，所以你知道我没疯：http: [//support.microsoft.com/kb/323626](http://support.microsoft.com/kb/323626)

所以，我试图找出一种解决方法，它不涉及复制整个文件只是为了重命名第一个标题。我正在处理一些大型文本文件，这将是一个不令人满意的最后手段。

我`On Error Resume Next`在通话前尝试过，`.OpenText`但没有成功。有没有人遇到过这个并找到了我缺少的简单解决方案？有没有办法打开第一行并在文本文件中查找/替换？或者我可以使用的额外参数`.OpenText`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T22:51:59.757

我为你写了这个。只需在尝试打开它之前调用它传递文件路径。我特意用后期绑定写了这个，所以不需要引用。如果文件以“ID”开头，它将在文件的开头添加一个撇号。

```
Sub FixIDProblem(filePath As String)
    Dim fso As Object
    Dim text As Object
    Dim contents as String
    Set fso = CreateObject("Scripting.FileSystemObject")
    If fso.FileExists(filePath) Then
        'Open the file for reading
        Set text = fso.OpenTextFile(filePath, 1)
        'Load the text contents to variable
        contents = text.ReadAll
        'Check for the forbidden text at the beginning
        If Left(contents, 2) = "ID" Then
            text.Close
            'Overwrite textfile with it's contents plus an apostraphe
            Set text = fso.OpenTextFile(filePath, 2)
            text.Write "'" & contents
        End If
        text.Close
    Else
        MsgBox "File does not exist"
    End If
    Set fso = Nothing
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-07T18:22:38.723

只需关闭警报：

```
Application.DisplayAlerts = False
Application.Workbooks.OpenText Filename:="startwithID.tab"
Application.DisplayAlerts = True 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-11T08:56:20.577

我这样做了：

```
Application.DisplayAlerts = False
On Error Resume Next
Workbooks.OpenText Filename:=myfile, DataType:=xlDelimited, Tab:=False, Semicolon:=True, Local:=True
Workbooks.OpenText Filename:=myfile, DataType:=xlDelimited, Tab:=False, Semicolon:=True, Local:=True
Application.DisplayAlerts = True 
```

第一个 OpenText 失败，但第二个有效。

FixIDProblem 是个好主意，但在大文件（~ 40MB）上失败

# sorting - 对目录中的所有文件进行单独排序

> ID：13078261
> 
> 赞同：1
> 
> 时间：2012-10-25T22:24:16.673
> 
> 标签：sorting, text, for-loop, cygwin

我正在尝试将文件按顺序排序`input_directory`到`output_directory`.

我知道如何为单个文件执行此操作，如下所示：

```
sort filename > newfilename 
```

但是，我希望程序对以下每个文件`input_directory`执行以下操作：

```
sort file_in_directrory > output_file_in_directory 
```

我怎样才能做到这一点？

我正在使用 cygwin 排序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:30:36.933

使用`for`循环：

```
 for file in $(ls /PATH/TO/INPUT/DIR); 
 do 
   sort /PATH/TO/INPUT/DIR/$file > /PATH/TO/OUTPUT/DIR/$file; 
 done 
```

请注意，如果输入目录中的任何文件是目录，则`sort`命令将失败，因为 sort 需要文件作为输入。

# android - Android：显示可变图像

> ID：13078265
> 
> 赞同：2
> 
> 时间：2012-10-25T22:25:02.083
> 
> 标签：android, image, variables, imageview

编辑。我尝试加载可变图像，但不知何故它不起作用。我想我有错误的 xml imageview 设置。

```
ImageView lblPic = new ImageView(this);
int resID = getResources().getIdentifier(pic, "drawable", getPackageName());
lblPic.setImageResource(resID); 
```

xml imageview 像这样使用 xml 我希望 Java 中的代码将替换 android:src 定义的图像，但它没有。如果我不使用 android:src 它会导致错误。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T22:45:49.863

如果你有图片的名字，你需要做

```
int resID = getResources().getIdentifier(filename, "drawable", getPackageName()); 
```

`filename`之后的部分在哪里`R.drawable.`，然后调用

```
lblPic.setImageResource(resId); 
```

# jquery - $.post 在进行所有函数调用之前不会运行

> ID：13078270
> 
> 赞同：1
> 
> 时间：2012-10-25T22:25:29.603
> 
> 标签：jquery, .post

遇到一个有趣的问题。我在进入我的 html ( `class="day"`) 时隐藏了一周中的每一天。通过单击日期，它会通过 AJAX 调用扩展以显示该日期下的所有内容`$.post`。这一切都运作良好。

我认为用户可能想要一次查看整个星期，所以我有一个按钮 ( `id="expander"`) 来显示所有内容。`getSchedule()`但是，当我从单击中调用该函数时`#expander`，它会遍历除函数`$.post`中的所有内容`getSchedule()`。然后它循环通过`$.post`.

```
$(document).ready(function()
{ 
    $('.day').click(function(){
        pass = $(this).prop('id');
        getSchedule(pass);
    });

    $('#expander').click(function(ex){
            $('.day').each(function(index){
                    pass = $(this).prop('id');
                    getSchedule(pass);
            });
            $('#expander').text('Hide All Days');
        ex.preventDefault();
        return false;       
    });
});

function getSchedule(elementid){
            dow = elementid.substr(-1);
            url = "standarddayofweek.php?d="+dow;
            $theday = $("#"+elementid);
            console.log("The day is "+$theday.prop('id'));
            $.post(url,function(data){
                    $theday.children('.dayschedule').html(data);
                }, "html"
            )
    } 
```

我得到的控制台响应是：

```
The day is d1 
The day is d2
The day is d3 
The day is d4 
The day is d5 
The day is d6
The day is d7 
XHR finished loading: "http://127.0.0.1/standarddayofweek.php?d=1"
In the post function, the day is d7
XHR finished loading: "http://127.0.0.1/standarddayofweek.php?d=2"
In the post function, the day is d7
XHR finished loading: "http://127.0.0.1/standarddayofweek.php?d=3"
In the post function, the day is d7 
XHR finished loading: "http://127.0.0.1/standarddayofweek.php?d=4"
In the post function, the day is d7 
XHR finished loading: "http://127.0.0.1/standarddayofweek.php?d=5"
In the post function, the day is d7 
XHR finished loading: "http://127.0.0.1/standarddayofweek.php?d=6"
In the post function, the day is d7 
XHR finished loading: "http://127.0.0.1/standarddayofweek.php?d=7"
In the post function, the day is d7 
```

淡化的 HTML：

```
<div id="expander">Click me to expand</div>

<div id="d1" class="day">
            <div class="dayschedule"></div>
</div>
<div id="d2" class="day">
            <div class="dayschedule"></div>
</div>

....

<div id="d7" class="day">
            <div class="dayschedule"></div>
</div> 
```

到底是怎么回事？我尝试添加延迟，以查看 AJAX 是否发生得太快，但没有任何改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:38:58.070

Javascript 主要使用单个执行线程运行，请参见[此处](https://stackoverflow.com/questions/2734025/is-javascript-guaranteed-to-be-single-threaded)。这对您的代码意味着什么：

首先，这`.each`只是一个循环。想象一下 ajax 请求是在 for 循环中发送的。

```
for(...)
    $.post(); 
```

在当前执行停止之前，ajax 回调无法运行。因此，您的代码将遍历所有元素，并按原样进行记录，然后释放线程并且 ajax 回调可以控制。

你应该改变你的程序，这样你就可以得到一个列表或*一批*内容，这样一个请求只需要几个元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T00:30:00.197

并非所有浏览器都会同步运行，因此`async: false`不是一个全面的解决方案。但是，将变量本地化为`getSchedule()`is.

试试这个：

```
function getSchedule(elementid) {
    var dow = elementid.substr(-1);
    var url = "standarddayofweek.php?d="+dow;
    var $theday = $("#"+elementid);
    console.log("The day is "+$theday.prop('id'));
    $.post(url, function(data) {
        $theday.children('.dayschedule').html(data);
    }, "html");
} 
```

因此，形成了一个包含（正式和非正式）vars 的闭包，当内部函数（ajax 成功处理程序）异步触发时，即使外部函数已经完成并返回，它们仍然可以使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T22:39:03.563

JavaScript 不是多线程的。你的函数必须在异步事情发生之前返回。

通过重复调用`$.post`而不将执行流程返回给浏览器，您实际上是在排队异步操作，这些操作将在您的代码完成时运行。

例如，如果您的代码永远不会通过永远循环返回，那么您的*任何*`$.post`s 都不会被调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T00:22:14.083

感谢@RobertSmith，答案是从 $.post 切换到 $.ajax。我只是改变了：

```
$.post(url,function(data){
                    $theday.children('.dayschedule').html(data);
                }, "html"
            ) 
```

到

```
$.ajax({
    url: url,
    async:false,
    success: function(data) {
     $theday.next().children('.dayschedule').html(data);
    }
}); 
```

注意`async:false`; 这就是开关所需要的。

感谢大家的评论！

# arrays - 最低、最高和平均温度的伪代码

> ID：13078275
> 
> 赞同：1
> 
> 时间：2012-10-25T22:26:08.633
> 
> 标签：arrays, max, pseudocode, min, average

我不是一个经验丰富的程序员（还），但我正在申请一所有几门编码课程的学校。

然而，在入学考试中，可能存在必须用伪代码或流程图编写的可解决问题。我有点处理流程图，但我很难让伪代码看起来不错。

例如，我尝试为一个扫描 24 个温度读数并打印出 MIN、MAX 和 AVG 的程序编写伪代码，但我认为我做得并不好。我做到了这一点，但没有得到 AVG：

```
 max = 0 min = 0 set up array of a[24] loop start    if  a[x] > max
        max = a[x]
        else if a[x] < min
        min = a[x]

 print Max temp: print Min temp: 
```

我想看看你们如何构建这个程序的清晰伪代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T22:35:56.887

较小的语句往往更好。我会将您提供的代码段重写为：

```
count = 24
temperatures is an array of count elements
max = -9999
min = 9999
total = 0

for each value in temperatures
    total = total + value
    if value > max
        max = value
    else if value < min
        min = value

print "Minimum: " min
print "Maximum: " max
print "Average: " total / count 
```

这几乎是真正的 Python 代码。以下是真正的python代码：

```
count = 24
temperatures = [3 * x for x in range(count)]
max = -9999
min = 9999
total = 0.0

for value in temperatures:
    total = total + value
    if value > max:
        max = value
    if value < min:
        min = value

print("Minimum: ", min)
print("Maximum: ", max)
print("Average: ", total / count) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:34:33.837

```
max:= 0
min:= (some big number)

while i < 24
begin
   if a[i] < min then min = a[i]
   if a[i] > max then max = a[i]
   sum = sum + a[i]
end

print min, max, sum/24 
```

如果我是你，我可能会写这样的东西。我并不是说它是完美的，但至少它是值得努力的。

# android - 如何避免在主要代码返工期间旧的小部件失败/消失？

> ID：13078279
> 
> 赞同：3
> 
> 时间：2012-10-25T22:26:12.567
> 
> 标签：android, android-appwidget

我在市场上有一个支持小部件的应用程序。我对应用程序进行了一些重大更改，重新设计了很多内部结构，替换/重命名活动等。其他更改包括从不同的共享首选项键中获取小部件配置数据，尽管我已经编写了转换代码来处理迁移. 从全新安装时，该应用程序可以按我的意愿运行，包括小部件。但是，我现在正在测试从旧版本的应用程序升级到新版本（通过模拟器）。我看到一些奇怪的行为。有一次，该小部件在首次启动时显示正常，但单击时尝试启动旧活动而不是我编程的新活动。所以第一个问题是，为什么小部件没有更新到应用安装的新代码？

我测试升级的其余尝试导致现有小部件在新版本安装时完全消失。这可能是什么原因造成的？log-cat 日志中没有任何值得注意的内容。有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T22:37:21.850

> ...替换/重命名活动...

有你的问题。如果您重命名 AppWidget 接收器，它将消失。唯一的解决方案是不要重命名它。

类似于可以固定到主屏幕的活动。如果您重命名活动，主屏幕图标将消失。

在此处阅读更多相关信息：[Android 开发者博客：无法改变的事情](http://android-developers.blogspot.com/2011/06/things-that-cannot-change.html)

# c# - 可以在 Global.asax 中添加对服务层的静态引用吗？

> ID：13078280
> 
> 赞同：2
> 
> 时间：2012-10-25T22:26:17.153
> 
> 标签：c#, asp.net, unity-container

我正在单个项目 ASP.NET Web 窗体应用程序的上下文中评估[Highway.Data.EntityFramework.Unity包。](http://nuget.org/packages/Highway.Data.EntityFramework.Unity/3.0.3.2)

我想轻松访问我的服务层。以下是 Global 的相关部分：

```
public class Global : HttpApplication
{
    private static readonly IUnityContainer Container = new UnityContainer();

    public static IEmployeeService Service { get; private set; }

    protected void Application_Start(object sender, EventArgs e)
    {
        Container.BuildHighway();
        Container.RegisterType<IMappingConfiguration, EntityMapping>();
        Container.RegisterType<IEmployeeService, EmployeeService>(
            new PerRequestLifetimeManager());
        Container.RegisterType<IRepository, Repository>(
            new PerRequestLifetimeManager());
        Container.RegisterType<IDataContext, DataContext>(
            new PerRequestLifetimeManager(), 
            new InjectionConstructor("DataContext", new EntityMapping()));

        Service = Container.Resolve<IEmployeeService>();
    }
} 
```

在我的客户中，我可以这样访问：

```
this.Employees.DataSource = this.service.GetEmployees();
this.Employees.DataBind(); 
```

工作正常，但我以前没有采用这种方法，只是因为它看起来没问题......好吧，是吗？如果没有，我该怎么办？

[编辑]为了要求的清晰。

服务：

```
public class EmployeeService : IEmployeeService
{
    private readonly IRepository repository;

    public EmployeeService(IRepository repository)
    {
        this.repository = repository;
    }

    public IEnumerable<Employee> GetEmployees()
    {
        return this.repository.Find(
            new AllEmployeesQuery())
            .ToList()
            .Select(ObjectMapper.Map<EmployeeEntity, Employee>);
    }
} 
```

AllEmployeesQuery 是一个规范。业务对象通过 AutoMapper 映射到 EF 实体，反之亦然。

谢谢，理查德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T22:50:41.720

你想像瘟疫一样避免这种方法。不要在应用程序级别共享数据库连接或资源；这将导致糟糕的性能和微妙的错误。

我发现的最佳模型是为每个请求创建一个连接并将其存储在当前请求中，以使该连接可用于请求生命周期内可能发生的任何其他调用。

以下代码是我们数据层中的静态属性。默认行为是在第一次获取时实例化一个连接并将其存储在请求中，随后对该属性的访问将返回之前创建的实例。该属性还使用户能够在没有 HttpContext 的情况下显式覆盖它。

```
protected static dataLayer DataContext
{
    get
    {
        if (HttpContext.Current == null)
        {
            if (StaticContext == null)
                StaticContext = new dataLayer();

            return StaticContext;
        }

        if (HttpContext.Current.Items["dataLayer"] == null)
            HttpContext.Current.Items["dataLayer"]= new dataLayer();

        return (dataLayer)HttpContext.Current.Items["dataLayer"];
    }
} 
```

# android - 为什么我的 androiv 虚拟设备只在我的 WebView 中打开 google 页面？

> ID：13078282
> 
> 赞同：0
> 
> 时间：2012-10-25T22:26:29.507
> 
> 标签：android

如果我写

```
webView.loadUrl("http://www.google.com"); 
```

谷歌页面正常打开，但如果我放另一个地址，比如

```
webView.loadUrl("http://www.android.com"); 
```

页面打不开。这是我的 AVD 的错误吗？它没有出现任何错误消息。我尝试了其他页面，例如 Bing，并且网页正常打开。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T02:23:03.480

如果您在模拟器中的 Google 搜索中搜索 Android，它会搜索并产生结果吗？当您尝试加载网页时，浏览器到底在做什么？不要忘记有些页面使用 Https 而不是 Http，尽管[http://www.Android.com](http://www.Android.com)应该可以工作。如果没有其他问题，请进入 AVD 管理器并创建一个新的模拟器，看看问题是否仍然存在。

# javascript - 同位素插件中砌体柱移位布局的问题

> ID：13078287
> 
> 赞同：2
> 
> 时间：2012-10-25T22:26:45.267
> 
> 标签：javascript, jquery, html, css, jquery-masonry

当用户将光标聚焦在 Post Comment 输入框上时，我的 div 会更改高度（以显示最初隐藏的提交按钮）。当 div 的高度发生变化时，我只希望该列中的项目移动以适应高度变化。我很高兴地发现 jquery isotope 插件有一个功能：masonryColumnShift

我一直在关注这篇文章[http://isotope.metafizzy.co/custom-layout-modes/masonry-column-shift.html](http://isotope.metafizzy.co/custom-layout-modes/masonry-column-shift.html)，但是如果我将布局设置为 masonryColumnShift，我的项目根本不会显示。当我的布局设置为“砌体”时工作正常。

HTML：

```
<div id="main">
    <div id="Container">       
         <div class="item">   
              ...
          </div>
    </div>
</div> 
```

JS：

```
$(#Container).isotope({
  itemSelector: '.item',
  layoutMode: 'masonryColumnShift'
}); 
```

CSS：

```
 #main
    {    
        clear:both;
        padding:40px; 
    }

    #Container
    {
    }

.item
{
  margin-right:10px;
  margin-bottom:10px;
  float:left;  
  display:block;
  width:250px;
  padding:15px;
  ...
} 
```

如果我有这种方式，它可以工作：

```
 $(#Container).isotope({
      itemSelector: '.item',
      layoutMode: 'masonry'
  }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T23:00:23.587

弄清楚了。应该添加一些脚本来让它工作。这里是：

```
// -------------------------- Masonry Column Shift -------------------------- //

// custom layout mode
$.Isotope.prototype._masonryColumnShiftReset = function () {
    // layout-specific props
    var props = this.masonryColumnShift = {
        columnBricks: []
    };
    // FIXME shouldn't have to call this again
    this._getSegments();
    var i = props.cols;
    props.colYs = [];
    while (i--) {
        props.colYs.push(0);
        // push an array, for bricks in each column
        props.columnBricks.push([])
    }
};

$.Isotope.prototype._masonryColumnShiftLayout = function ($elems) {
    var instance = this,
    props = instance.masonryColumnShift;
    $elems.each(function () {
        var $brick = $(this);
        var setY = props.colYs;

        // get the minimum Y value from the columns
        var minimumY = Math.min.apply(Math, setY),
      shortCol = 0;

        // Find index of short column, the first from the left
        for (var i = 0, len = setY.length; i < len; i++) {
            if (setY[i] === minimumY) {
                shortCol = i;
                break;
            }
        }

        // position the brick
        var x = props.columnWidth * shortCol,
      y = minimumY;
        instance._pushPosition($brick, x, y);
        // keep track of columnIndex
        $.data(this, 'masonryColumnIndex', i);
        props.columnBricks[i].push(this);

        // apply setHeight to necessary columns
        var setHeight = minimumY + $brick.outerHeight(true),
      setSpan = props.cols + 1 - len;
        for (i = 0; i < setSpan; i++) {
            props.colYs[shortCol + i] = setHeight;
        }

    });
};

$.Isotope.prototype._masonryColumnShiftGetContainerSize = function () {
    var containerHeight = Math.max.apply(Math, this.masonryColumnShift.colYs);
    return { height: containerHeight };
};

$.Isotope.prototype._masonryColumnShiftResizeChanged = function () {
    return this._checkIfSegmentsChanged();
};

$.Isotope.prototype.shiftColumnOfItem = function (itemElem, callback) {

    var columnIndex = $.data(itemElem, 'masonryColumnIndex');

    // don't proceed if no columnIndex
    if (!isFinite(columnIndex)) {
        return;
    }

    var props = this.masonryColumnShift;
    var columnBricks = props.columnBricks[columnIndex];
    var $brick;
    var x = props.columnWidth * columnIndex;
    var y = 0;
    for (var i = 0, len = columnBricks.length; i < len; i++) {
        $brick = $(columnBricks[i]);
        this._pushPosition($brick, x, y);
        y += $brick.outerHeight(true);
    }

    // set the size of the container
    if (this.options.resizesContainer) {
        var containerStyle = this._masonryColumnShiftGetContainerSize();
        containerStyle.height = Math.max(y, containerStyle.height);
        this.styleQueue.push({ $el: this.element, style: containerStyle });
    }

    this._processStyleQueue($(columnBricks), callback)

}; 
```

# java - XStream 中的序列化问题

> ID：13078289
> 
> 赞同：1
> 
> 时间：2012-10-25T22:27:06.960
> 
> 标签：java, xml, parsing, web, xstream

所以我在序列化我的 Java 代码时遇到了问题。这是一个网络爬虫，为我正在从事的项目从我们学校的课程选择网站上爬取页面，我正在尝试在 XML 文件中输出指定主题的所有班级信息。问题是，有些类有多个部分，而不是仅仅重写这些文件名和浪费空间，我希望它们都留在我的 XML 中一个名为“Sections”的部分下。知道我的代码有什么问题吗？这是要点的链接，我不想用我的代码拉伸页面：[要点](https://gist.github.com/3955843)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T22:41:27.260

处理`List`通过`xstream`有点棘手。您需要添加一个`implicitCoolection`for`sections`

```
 //xstream.alias("list", Class.class);
    xstream.addImplicitCollection(Class.class, "sections"); 
```

希望这可以帮助！！

# mysql - 如何在另一个数据库中继续一个数据库中的表

> ID：13078291
> 
> 赞同：0
> 
> 时间：2012-10-25T22:27:21.770
> 
> 标签：mysql, database, database-design

我基本上很好奇是否可以继续在一个数据库中创建的表在另一个数据库中继续。例如，如果已经为用户创建了一个表，每个表都有一个唯一的 id 递增，在一个数据库中但变得“满”，那么同一个表是否可以在另一个数据库中继续，唯一 id 仍然递增，即使那数据库在另一台服务器上。

如果这是一个菜鸟问题，我提前道歉。我是 MySql 的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:32:24.883

除非您用完物理磁盘空间，否则表永远不会被填满。但是，如果您有大量用户，他们可能会真正加载数据。

您在一般意义上谈论的是分区，分片或集群。通常这样做是出于性能原因，而不是因为任何特定的表在物理上太大。但是，请谨慎执行此操作，因为此更改的开销很大，并且需要非常严格的努力才能在整个应用程序中正确使用。

如果您使用某种对象关系映射器 (ORM) 与您的数据库进行交互，那么从编程的角度来看，这可能具有使这更容易的功能。

除非您有数千万行，否则可能有办法调整您的数据库以获得所需的性能。

# algorithm - 确定数字数组是否与要求列表匹配

> ID：13078295
> 
> 赞同：3
> 
> 时间：2012-10-25T22:27:44.120
> 
> 标签：algorithm

假设您有一个不同数字的数组 {5,6,1,67,13,9,14,15}，以及这样的要求列表： R1：您必须从集合中选择至少 2 个数字（5,6， 10) 在这种情况下，它们也在你的数组中，它将是 5,6

R2：您必须从 set(9,13,67,5) 中选择至少 3 个数字，这些数字也在您的数组中。在这种情况下，它将是 9,13,67。请注意，我们不能选择 5，因为它已在 R1 中使用过

R3：您必须从 set(1,14,15,6) 中选择至少 2 个数字，这些数字也在您的数组中。在这种情况下，它可以是 1,14 或 1,15 或 14,15，我们将有多个满意。......

......

Rk：您必须从 set (.......) 中选择至少 k 个数字，这些数字也在您的数组中。

所以问题是找到一种多项式时间算法来确定给定数组是否满足所有要求，并且数组的每个数字只能用于满足一个要求。

我的解决方案是这样的：

```
determine(array a,R[]) //R[] is a array of requirements, array a is our checking array
{
     if R is empty return true   //we satisfied all the requirments
     if R[0] cannot be satisfied by our array a return false
     for each satisfactions
     {
       new array b=a-selected numbers for this satisfaction
       new rule array newR=R-R[0]    //remove the first rule of the rule array
       if determine(b,newR) is false     //we begin our recursive call
           we continue our loop since this means the current way of satisfaction does not work
       else return true
      }
         return false   //this means we finish checking all the satisfactions and cannot find a match we need to tell the last recursive call that this way does not work    
} 
```

显然我的解决方案需要指数时间，任何人都可以提出多项式解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:40:49.180

在满足所有要求后，您将选择数组中的每个元素 (c(0), c(1), c(2), ... , c(n)) 次。

其中 c(i) 为 0 或 1。例如，您的约束告诉您 c(i) + c(j) + c(k) = 2。

我可能错了，但这似乎是 0-1 整数规划，这是卡普的 NP 完全问题之一，不是吗？

[http://en.wikipedia.org/wiki/Integer_linear_programming#Integer_unknowns](http://en.wikipedia.org/wiki/Integer_linear_programming#Integer_unknowns)

# cuda - GTX 680 , Kepler 和每个线程的最大寄存器

> ID：13078301
> 
> 赞同：5
> 
> 时间：2012-10-25T22:28:37.830
> 
> 标签：cuda

当我感到困惑时，我正在问以下问题......

在各种网站和论文上，我发现声明说 Kepler 架构增加了每个线程的寄存器数量，但在我的 GTX680 上，这似乎不是真的，因为 RegsPerBlock 是 65536，所以对于 1024 个线程，它将是 64 个 regs。我错过了什么？.. 将来每个线程会有更多的寄存器吗？

问候丹尼尔

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-25T23:02:44.657

Kepler 架构有两种变体，sm_30 和 sm_35。GTX 680 卡基于实现 sm_30 架构的 GK104 GPU。这种架构每个线程有 64 个寄存器，其中 63 个可用于用户代码，一个是专用的零寄存器。未来基于 GK110 的部件（如 K20）实现 sm_35 架构，该架构为每个线程提供 256 个寄存器，其中 255 个可用于用户代码（又是一个专用的零寄存器）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-12T09:51:14.803

虽然[@njuffa 写](https://stackoverflow.com/a/13078626/1593077)的是真的，但同样重要的是要注意每个线程的最大寄存器数不一定相等（寄存器文件大小/每个块的最大线程数）。可能的情况是，您只能利用每个线程的最大可能 regs 和较小的线程块。

...事实上，这[正是](https://en.wikipedia.org/wiki/CUDA)CC 3.5 Kepler 卡、Maxwell 5.x 和 Pascal 6.0 卡的实际情况：寄存器文件有 64 个 Ki 寄存器；每个块的最大线程数为 1024；但每个线程的最大寄存器为 255（+ 零寄存器）。只有每个块最多 256 个线程的网格才能获得每个线程 255 个 regs。

# iphone - 我如何在方法中使用这个值 - Objective C

> ID：13078302
> 
> 赞同：0
> 
> 时间：2012-10-25T22:28:47.103
> 
> 标签：iphone, objective-c, ios, ipad

我必须将以下对象传递给一个方法，让该方法对其进行修改，以便在方法调用之后我可以继续使用修改后的对象。

```
AVMutableCompositionTrack *compositionVideoTrack[2]; 
```

目前像这样传递它：

```
[self buildShow:&compositionVideoTrack]; 
```

buildshow 方法如下所示：

```
-(void)buildShow:(AVMutableCompositionTrack**)videoTracks{
} 
```

我收到此编译器警告，但目前无法正常工作：

不兼容的指针类型将“AVMutableCompositionTrack *__strong (*)[2]”发送到“AVMutableCompositionTrack *__autoreleasing *”类型的参数

我怎样才能改变它以使其工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T22:32:42.870

像这样传递它：

```
[self buildShow:compositionVideoTrack]; 
```

当你像这样声明它时：

```
AVMutableCompositionTrack * __autoreleasing compositionVideoTrack[2]; 
```

`AVMutableCompositionTrack**`它已经是一个指针数组，因此它与参数 ( )的类型兼容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:36:20.437

除非您正在使用属性，否则您应该这样做（注意该方法现在返回相同类型的对象）：

方法构造函数：

```
-(AVMutableCompositionTrack *)buildShow:(AVMutableCompositionTrack *)videoTracks {
    // do something
    return newVideoTracks;
} 
```

并且，方法调用：

```
newVideoTracks = [self buildShow:compositionVideoTrack]; 
```

如果使用属性，则可以使用不带参数的 void 方法。

# haskell - How to index an "element" type by a "source container" value?

> ID：13078307
> 
> 赞同：6
> 
> 时间：2012-10-25T22:29:16.290
> 
> 标签：haskell, dependent-type

So I have a situation very similar to this (much simplified) code:

```
import Data.Maybe
import Data.List

data Container a = Container [a] 

-- Assumption: an Element can only obtained from a Container.  The operation
-- guarentees the Element is in the Container.
data Element a = Element (Container a) a

-- This operation is only valid for Elements that have the same Container.
before :: Eq a => Element a -> Element a -> Bool
before (Element (Container xs) x) (Element (Container ys) y) 
    | xs == ys = fromJust (elemIndex x xs) < fromJust (elemIndex y xs)
    | otherwise = error "Elements from different Containers" 
```

How can I use Haskell's type system (or GHC extensions) to restrict `before` and similar operations from taking `Element`s from different `Container`s? I've been looking into `GADTs` and `DataKinds` but, well, that's going to take a long while and I could use some suggestions or pointers. (Another idea I've thought of but haven't worked out: use a similar trick as the `ST` monad's `s` parameter...)

Am I too pessimistic if I conclude that this would require a dependently typed language? Because, as my limited understanding of dependent typing goes, I think that I'm trying to index the `Element` type by values of the `Container` type.

* * *

**EDIT:** Just for extra color, this all ultimately arises because I'm trying to define something very much like this:

```
import Data.Function
import Data.Ix

-- I want to use Elements as Array indexes; so Elements need to know
-- their Container to calculate their Int
instance Eq a => Ix (Element a) where
    -- Ignore how crap this code is
    range (l, u) = map (getSibling l) [getIndex l .. getIndex u]
    index (l,u) i = index (getIndex l, getIndex u) (getIndex i)
    inRange (l,u) i = inRange (getIndex l, getIndex u) (getIndex i)

getIndex :: Eq a => Element a -> Int
getIndex (Element (Container xs) x) = fromJust $ elemIndex x xs

getList :: Element a -> [a]
getList (Element (Container xs) _) = xs

getSibling :: Element a -> Int -> Element a
getSibling (Element (Container xs) _) i = Element (Container xs) (xs!!i)

instance Eq a => Eq (Element a) where
    (==) = (==) `on` getIndex

instance Eq a => Ord (Element a) where
    compare = compare `on` getIndex 
```

All of this code requires that you never "mix" `Element`s from different `Container`s.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T23:52:30.307

You can tell containers apart statically by associating a type with each container. Container elements are tagged with the type to determine whether two given elements came from the same container. This uses `-XExistentialQuantification` and `-XRank2Types`. Basically, this is dependent typing, except that types depend on the tag instead of the container value.

```
-- Containers with existentially typed tags 'c'
data Container a = forall c. Container !(OpenContainer c a)

-- Containers with a tag parameter 'c'
data OpenContainer c a = OpenContainer [a]

-- A container element with a tag parameter 'c'
data Element c a = Element (OpenContainer c a) a

-- Create a container.  An arbitrary tag is chosen for the container.
container :: [a] -> Container a
container = Container . OpenContainer

-- Use a container.  The tag is read.
openContainer :: Container a -> (forall c. OpenContainer c a -> b) -> b
openContainer c k = case c of Container c' -> k c'

-- Get a container's elements.  The elements are tagged.
getElements :: OpenContainer c a -> [Element c a]
getElements c@(OpenContainer xs) = map (Element c) xs 
```

Any time `openContainer` is called, it will yield a collection of values belonging to the same container. Two different calls to `openContainer` will be assumed to refer to different containers.

```
-- Ok
f c = openContainer c $ \oc -> getElements oc !! 0 `before` getElements oc !! 1

-- Error
f c d = openContainer c $ \oc -> openContainer d $ \od -> getElements oc !! 0 `before` getElements od !! 0 
```

This is safe, but conservative, because it is not based on which container is used, but rather which call to `openContainer` was used.. Calling `openContainer` on a container, then calling it again, will produce incompatible elements.

```
-- Error
f c = openContainer c $ \oc -> openContainer c $ \od -> getElements oc !! 0 `before` getElements od !! 1 
```

Now you can write `before` without explicitly testing for equality. Since both elements have the same index, they must have come from the same container.

```
before :: Eq a => Element c a -> Element c a -> Bool
before (Element (OpenContainer xs) x) (Element _ y) = fromJust (elemIndex x xs) < fromJust (elemIndex y xs) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T01:54:51.783

I don't know if this qualifies as an answer, but I will just throw it out there. You can make every Element a function of the Container that it derives from:

```
newtype a `HasA` b = H { using :: a -> b }
    deriving (Monad, Applicative, Functor) 
```

By restricting the set of permissible operations to the above classes, you ensure that any elements you combine share the same originating container.

You export the "using" function but not the H constructor. The primitive functions that create Elements are provided by you, but then the user can just combine them using the Monad instance, ensuring that they always refer to the same container once you unwrap and supply them with the container.

As a bonus, it answers your title's question literally: it indexes the element on its container's value.

# c# - 从 C# 配置 *.scr 文件

> ID：13078311
> 
> 赞同：3
> 
> 时间：2012-10-25T22:29:44.527
> 
> 标签：c#, windows, configure, screensaver

我正在 C#.Net 中创建一个程序，其中一项功能允许用户从列表中选择屏幕保护程序并预览或配置它。在做了一些研究后，我发现通过使用“/c”参数调用 *.scr 文件将显示配置对话框。

从命令行使用这个参数可以正常工作（“C:\Windows\System32>PhotoScreensaver.scr /c”），但是从 C# 调用它总是会导致屏幕保护程序被简单地显示，就好像参数被忽略了一样。

我正在使用的代码是这样的：

```
Process.Start(ScreensaverPath, "/c"); 
```

其中 ScreensaverPath 包含 *.scr 文件的路径（包括）。

我也试过这段代码，但无济于事：

```
Process.Start(ScreensaverPath + "/c"); 
```

任何帮助将不胜感激。

PS 我使用的是 Windows 8 Pro，但我需要与 XP 和更新版本兼容的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:20:34.760

我认为直接传递 args 不会在 C# 中起作用。如果您`c:\windows\system32\sspipes.scr /c`在开始|运行框中键入，这也将直接进入屏幕保护程序，而不是显示配置屏幕。

但是，我已经能够通过 cmd 文件来做到这一点，所以一个解决方案（虽然不完美）是在某处创建一个只有一行的 cmd 文件`%1 /c`

然后您可以将屏幕保护程序的路径和文件名传递给 cmd 文件，这将调出配置屏幕

一些快速而肮脏的VB代码将说明

```
Public Class Form1

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

        Dim path As String = "C:\temp\scr.cmd"

        Dim args As String = "C:\WINDOWS\system32\sspipes.scr"

        Dim psi As New ProcessStartInfo
        psi.Arguments = args
        psi.FileName = path
        Process.Start(psi)

    End Sub

    Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click
        Dim app As String = "C:\WINDOWS\system32\sspipes.scr"
        Process.Start(app)

    End Sub
End Class 
```

这是一个带有 2 个按钮的表单。Button1 调出配置屏幕，Button 2 运行屏幕保护程序。显然你会删除硬编码等，所以请原谅糟糕的编码风格。

您只需要在其中创建一个名为 scr.cmd 的文本文件并将`%1 /c`其保存到`c:\temp`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T22:42:05.967

我建议您首先创建[ProcessStartInfo](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.aspx)的实例设置您的属性，然后将该实例传递给 Process.Start(instanceOfProcessStartInfo)

我直接使用 Process.Start 时遇到了类似的问题，这就是它的解决方案

# path - 结合绝对路径和相对路径得到新的绝对路径

> ID：13078314
> 
> 赞同：20
> 
> 时间：2012-10-25T22:30:01.550
> 
> 标签：path, go

我正在编写一个程序，其中一个组件必须能够采用给定的路径（例如`/help/index.html`，或`/help/`）和基于该位置的相对路径（例如`../otherpage/index.html`，或`sub/dir/of/help/`，或`help2.html`）并生成绝对路径由相对路径暗示。考虑以下目录树。

```
/
index.html
content.txt
help/
    help1.html
    help2.html 
```

该文件`index.html`包含一个链接，如`help/help1.html`. 该程序通过`/`or `/index.html`，并将其与`help/help1.html`get结合起来`/help/help1.html`。

同样，该文件`/help/help1.html`具有链接`../content.txt`，程序需要从该链接返回`/content.txt`。有没有合理的方法来做到这一点？

谢谢你。:)

**编辑：**谢谢斯蒂芬温伯格！对于[未来](http://xkcd.com/979/)的每个人，这是我使用的代码。

```
func join(source, target string) string {
    if path.IsAbs(target) {
        return target
    }
    return path.Join(path.Dir(source), target)
} 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-10-25T22:32:56.210

使用`path.Join`时`path.Dir`应该做你想做的事。有关交互式示例，请参见[http://golang.org/pkg/path/#example_Join 。](http://golang.org/pkg/path/#example_Join)

```
path.Join(path.Dir("/help/help1.html"), "../content.txt") 
```

这将返回`/content.txt`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-07-25T09:27:26.143

[斯蒂芬的回答](https://stackoverflow.com/a/13078343/1229237)是正确的，但我想添加一些东西来节省未来的读者一些时间：

您应该注意[path 包](https://golang.org/pkg/path/)中的函数假定分隔符是`/`. 使用上面的示例时，我一直得到输出，`.`因为我有一个使用`\`.

如果您不处理 URL，请考虑使用使用操作系统目录分隔符的文件[路径包。](https://golang.org/pkg/path/filepath/)

例如在 Windows 上运行时：

```
path.Dir("C:\\Users\\Darren\\Desktop\\file.txt")
filepath.Dir("C:\\Users\\Darren\\Desktop\\file.txt") 
```

回报：

```
.
C:\Users\Darren\Desktop 
```

# ios - ios中是否有本机zip或gzip解压功能可用？

> ID：13078315
> 
> 赞同：3
> 
> 时间：2012-10-25T22:30:23.687
> 
> 标签：ios, compression

我知道有一些库（ZLib、MiniZip 等）来管理任务。

但是，我正在寻找基于 iO 或系统库的解决方案。URL 传输协议嵌入了 GZIP 的传输压缩，因此如果有人设法找到 iOS 库的公共可访问接口，将会很有趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T23:24:54.433

如果您使用 NSURLConnection ，您收到的数据将会为您解压缩。

# java - 有没有办法以编程方式从 android:drawable 设置背景？

> ID：13078324
> 
> 赞同：1
> 
> 时间：2012-10-25T22:31:09.207
> 
> 标签：java, android, background, drawable

好吧，我知道这可以通过这种方式在 xml 中完成

```
android:background="@android:drawable/editbox_dropdown_dark_frame" 
```

上面这条线是我的想法，所以它可能有一些错误，但基本上就是这样。现在我怎样才能以编程方式做同样的事情？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T22:34:59.803

您可以这样做（来自 View 子类）：

```
setBackgroundResource(android.R.drawable.editbox_dropdown_dark_frame); 
```

如果你有对视图的引用（比如 from `findViewById`），你可以做同样的事情：

```
View v = . . .;
v.setBackgroundResource(android.R.drawable.editbox_dropdown_dark_frame); 
```

如果您愿意，可以`Drawable`直接检索自身：

```
Drawable d = getResources().getDrawable(
    android.R.drawable.editbox_dropdown_dark_frame); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T22:35:15.593

```
<TextView
android:id="@+id/background_tv"
android:layout_width="wrap_content"
android:layout_height="wrap_content"/> 
```

* * *

```
TextView toChange = (TextView) this.findViewById(R.id.background_tv);
toChange.setBackgroundResource(android.R.drawable.editbox_dropdown_dark_frame); 
```

# c# - c#中的索引越界异常

> ID：13078325
> 
> 赞同：0
> 
> 时间：2012-10-25T22:31:11.483
> 
> 标签：c#, indexoutofboundsexception

我的程序中有以下代码，它在 yearList.SetValue(years[count], count); 行抛出 index out of bound 异常；

```
protected void invoiceYear_DataBound(object sender, EventArgs e)
        {
           //invoiceYear.SelectedItem.Value= GetYearRange();
            String[] years = GetYearRange().Split(new char[] { '[', ',', ']',' ' });
            ListItem [] yearList = new ListItem[]{};
            System.Diagnostics.Debug.WriteLine("years-->" + years.Length);
            for (int i = 0; i < years.Length; i++)
            {
                System.Diagnostics.Debug.WriteLine("years-->" + years.GetValue(i));

            }
            int count = 0;
            foreach (String str in years)
            {
                if (string.IsNullOrEmpty(str))
                    System.Diagnostics.Debug.WriteLine("empty");
                else
                {
                    yearList.SetValue(years[count], count);
                    count++;
                }
            }

            //System.Diagnostics.Debug.WriteLine("yearList-->" + yearList.GetValue(0));
            //invoiceYear.Items.AddRange(yearList);
        } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T22:36:38.423

你还没有问过问题，所以我猜你的问题只是“为什么？”

`yearList`被定义为一个空数组：

```
ListItem [] yearList = new ListItem[]{}; 
```

它的长度始终为零。因此，您不能设置它的任何元素，因为它没有要设置的元素。

**更新**

您现在问：“但我不知道如何声明动态数组？？”

.NET 中没有动态数组。根据您的方案，您有许多不同的集合类型。我会建议这`List<ListItem>`可能是你想要的。

```
List<ListItem> yearList = new List<ListItem>(); // An empty list 
```

然后

```
yearList.Add(years[count]); // Adds an element to the end of the list. 
```

或者，整个循环可以更好地写成：

```
 foreach (String str in years)
        {
            if (string.IsNullOrEmpty(str))
                System.Diagnostics.Debug.WriteLine("empty");
            else
            {
                yearList.Add(str);
            }
        } 
```

然后你不必担心并且你也不会`count`步调不一致（因为你只是在 str 包含某些东西时增加计数 - 这可能不是你想要的）

**更新 2** 如果您最后确实需要一个数组，您始终可以使用 将列表转换为数组`yearList.ToArray()`，但请记住`using System.Linq;`在文件顶部添加，因为它是 LINQ 提供的扩展方法，而不是列表的一部分类本身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:38:07.893

如果您想保留计数器，为什么要使用`Foreach`循环？`For`

```
 foreach (var int i = 0; i < years.Length; i++)
        {
            if (string.IsNullOrEmpty(years[i]))
                System.Diagnostics.Debug.WriteLine("empty");
            else
            {
                yearList.SetValue(years[i], i);
            }
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T22:57:08.727

我不知道您的目标是什么，也没有任何经验`ListItem`，但是您是否考虑过这种方法：

```
string[] yearList = years.Where(y => !string.IsNullOrEmpty(y)).ToArray(); 
```

这会创建一个包含所有非空或非空年份的数组。它还取决于您如何使用该列表来确定这是否有用。如果它不需要是一个数组，那么你甚至可以这样做：

```
var yearList = years.Where(y => !string.IsNullOrEmpty(y)); 
```

请注意，这些解决方案在诊断输出或使用`ListItem`. 它还取决于您使用的 .net 版本是否适合您。

# python - 如何在python中删除RTL字符串的最后一个字符？

> ID：13078327
> 
> 赞同：6
> 
> 时间：2012-10-25T22:31:12.530
> 
> 标签：python, string, unicode, right-to-left

我正在尝试以“从右到左”的语言删除字符串的最后一个字符。但是，当我这样做时，最后一个字符会换行到字符串的开头。例如 `ותֵיהֶם]׃` 变成 `ותֵיהֶם]`

我知道这是我如何处理 RTL 范例的一个基本问题，但如果有人可以帮助我思考它，我将非常感激。

**代码**

```
with open(r"file.txt","r") as f:
    for line in f:
        line = unicode(line,'utf-8')
        the_text = line.split('\t')[1]
        the_text.replace(u'\u05C3','') 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-25T22:45:52.407

Unicode 中的某些字符始终是 LTR，有些始终是 RTL，有些则取决于它们周围的上下文。此外，双向文本的显示上下文将具有“主要”方向性（例如，为主要是英文文本配置的文本编辑器将主要是 LTR 并且具有参差不齐的右边距，配置为主要是希伯来语的文本编辑器将主要是 RTL，具有参差不齐的左边距）。

看起来这里发生的事情是，当右方括号字符出现在两个 RTL 字符之间时，它会以其 RTL 形式呈现（您的第一个示例），但是当它出现在 RTL 和 LTR 字符之间（或在字符串 - 基本上，它在两侧没有相同方向的其他字符的地方）然后它被认为是与主要方向匹配的任何文本运行的一部分。如果您尝试将鼠标拖到字符串上以选择字符，您会看到*逻辑上*关闭`]`仍然跟随，`ֶם`即使在*视觉上*它似乎已经移动。

如果字符串中的倒数第二个字符也是希伯来字符（或其他强 RTL 字符）而不是`]`，或者如果显示上下文主要是 RTL，那么它将出现在您期望的位置。

# c# - DocumentCompleted 的 WPF 等效项是什么？

> ID：13078331
> 
> 赞同：5
> 
> 时间：2012-10-25T22:31:55.530
> 
> 标签：c#, browser, webbrowser-control

我检查了。这个问题还没有被问到。WebBrowser 类的 DocumentCompleted 的 WPF 等效项是什么？

WPF 中不存在 DocumentCompleted 方法（至少在最新版本的 .NET 和 Visual Studio 中不存在）。那么，我该如何做与 WPF 中的 Windows 窗体一样的事情呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T23:37:03.447

您要查找的事件是 LoadCompleted。

您可以在此处的 .NET 文档中阅读更多相关信息[http://msdn.microsoft.com/en-us/library/system.windows.controls.webbrowser.loadcompleted(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.webbrowser.loadcompleted(v=vs.90).aspx)

# java - 在 applet 中解析和创建 XML 文档

> ID：13078332
> 
> 赞同：0
> 
> 时间：2012-10-25T22:31:57.287
> 
> 标签：java, applet, xml-parsing

我需要在小程序中生成和解析 XML 文档。问题是如何做到这一点。我可以编写 java 代码来生成 XML 格式的文档。我过去做过这件事。我还可以使用任意数量的解析器来解析 XML 文档。我想知道的是 XMLbeans 或类似的包是否可以工作。在 Internet 上进行的快速搜索显示 XMLbeans 不能在 applet 中工作，但这些帖子是 5 年前的。有谁知道这是否已修复？我特别关注从小程序中引用 XML 模式，XMLbeans 依赖于该模式。

这是一条富有成效的追求之路，还是我应该重新依赖本文第一部分中描述的久经考验的真实方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T22:49:09.007

我已经确认 XMLbeans 确实在 applet 中工作。您只需将 xbean.jar 和 xmlbeans 从 xsd 生成的 jar 放入 APPLET 标记的 ARCHIVE 属性中，就像您希望下载到 applet 中的任何 jar 一样。

# php - 带有php计数的fancybox youtube

> ID：13078333
> 
> 赞同：0
> 
> 时间：2012-10-25T22:32:01.887
> 
> 标签：php, jquery, mysql, count, fancybox

我有一个项目页面，有时有一个相关的 youtube 链接。当它完成时，fancybox 将在fancybox 窗口中单击打开链接。我的链接由#youtube1 等计数器标识。有没有更好的方法来做到这一点，以便每次循环时都不必重做 javascript？

```
<?php mysql_data_seek($projects,0); $counter = 1; while ($row_projects = mysql_fetch_assoc($projects)) { ?>
<div class="img<?php $count=$counter++; echo $count; ?>" style="height:212px; overflow:hidden;">
    <h3><?php echo $row_projects['project_name']; ?></h3>
    <p id="project-content"><?php echo stripslashes($row_projects['project_content']); ?><br><?php if(!empty($row_projects['youtube_link'])) { echo '<a id="youtube'.$count.'" href="'.$row_projects['youtube_link'].'" title="'.$row_projects['project_name'].'" class="link1">View project</a>'; } ?>
    <script>
    $(document).ready(function() { 
        $("<?php echo '#youtube'.$count ?>").click(function() {
            $.fancybox({
                    'padding' : 0,
                    'autoScale' : false,
                    'transitionIn' : 'fade',
                    'transitionOut' : 'fade',
                    'title' : this.title,
                    'width' : 680,
                    'height' : 495,
                    'href' : this.href.replace(new RegExp("watch\\?v=", "i"), 'v/'),
                    'type' : 'swf',
                    'swf' : { 'wmode' : 'transparent', 'allowfullscreen' : 'true' }
            });
            return false;
        });
    });
    </script>
    </p>
    <p class="font1"><span><?php echo $row_projects['project_bold']; ?></a></span></p>
</div>
<?php } ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T22:47:31.160

让你的选择器是通用的：

```
$("a.link1").live('click', function() { 
```

那么就不需要在循环中重复这个函数了。

# php - 我要将配置文件图像加载到名为配置文件的数据库中，但我如何才能在屏幕上实际显示配置文件？

> ID：13078334
> 
> 赞同：-2
> 
> 时间：2012-10-25T22:32:04.260
> 
> 标签：php, codeigniter

我的个人资料模型文件：

```
function putProfileImage($user, $image)
{

    $record = array('user' => $user, 'profileimage' => $image);
    if ($this->exists($user))
    {
        $this->db->where('user', $user)->update('profiles', $record);
    }
    else
    {
        $this->db->where('user', $user)->insert('profiles', $record);
    }
}

function getProfileImage($user)
{

    $config = array(
            'allowed_types' => 'jpg|jpeg|gif|png',
            'height' => 200,
            'length' => 150
    );

    $this->db->select('*')->from('profiles')->where('user', $user);
    $query = $this->db->get();
    $row = $query->row();
    return $row->profileimage; //Trying to get property of non-object error

} 
```

它的getProfileimage，类似于我遇到最多麻烦的do_upload函数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T04:33:56.407

看看这些网站

*   [http://codeigniter.com/forums/viewthread/134429](http://codeigniter.com/forums/viewthread/134429)

*   [http://www.phpriot.com/articles/images-in-mysql](http://www.phpriot.com/articles/images-in-mysql)

然后按照下面的伪代码进行操作（假设 profileimage 在数据库中存储为 BLOB 字段）

模型文件：

```
function putProfileImage($user, $image)
{
    // you may need to store the image type / mine type
    $record = array('user' => $user, 'profileimage' => $image);
    if ($this->exists($user))
    {
        $this->db->update('profiles', $record)->where('user', $user);
    }
    else
    {
        $this->db->insert('profiles', $record);
    }
}

function getProfileImage($user)
{
    $this->db->select('*')->from('profiles')->where('user', $user);
    $query = $this->db->get();
    if ($query->num_rows() > 0){
        $row = $query->row();
        return $row->profileimage; //Trying to get property of non-object error
    }

    return Null;
} 
```

控制器 - profile.php

```
function Upload()
{
    // see - Creating the Upload Form
    // @ - http://codeigniter.com/user_guide/libraries/file_uploading.html
}

function doUpload ()
{
    //see do_upload() and save with module above
    // @ - http://codeigniter.com/user_guide/libraries/file_uploading.html
}

function displayImage()
    {
        //Retrieve image id from the URI
        $imageid = $this->uri->segment(3);
        //Initialize the images model
        $this->load->model("image_model");
        //Call the model's getImage function passing the image id
        $image = $this->image_model->getProfileImage($imageid);
        if (!is_null($image)) {
            //need to know the mine type 
           // header('Content-Type: image/png');

            header ('Content-Type: image/jpg');
            imagejpeg(imagecreatefromstring($image), null,100);
        }
        else{
         // load a default profile image
        }
    }

    function viewProfile(){
        //load profile detail view for users and display image
        // 18 = change to image id
        echo '<img src="<?=base_url()?>profile/displayImage/18" alt="profile"/>';

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T02:40:23.770

* *Trying to get property of non-object **错误意味着查询很可能没有结果，即*profile*表中没有*user=$user*的行。

为了帮助您调试，您可以在*$query = $this->db->get();之后使用此命令*

```
echo $this->db->last_query(); die(); 
```

*$this->db->last_query();* 将获取最后一次查询运行的 sql，*die()*将终止程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T01:30:49.587

我设法通过保存到正确的图像位置文件夹来解决这个问题

# matlab - 传递数组，没有开销（最好是“通过引用”），以避免在matlab中复制复杂的代码块？

> ID：13078338
> 
> 赞同：8
> 
> 时间：2012-10-25T22:32:25.390
> 
> 标签：matlab

我在 Matlab 脚本中有复杂的代码块，它们作用于大型非稀疏数组。该代码对数组中的随机元素执行许多写入操作，以及读取操作。相同的代码必须针对不同的（大）数组（即，相同的代码块，不同的数组变量名除外）执行。

我不希望只有数组名称不同的长而重复的代码块。

不幸的是，当我创建一个函数来执行操作时，代码块只出现一次，性能会降低 10 倍或更多（可能是由于数组的复制）。但是，我不需要复制数组。我更喜欢“通过引用传递”，这样函数调用的目的只是为了避免重复的代码块。然而，似乎没有办法避免写时复制语义。

此外，不可能（据我了解）创建一个脚本（不是函数）来实现这一点，因为脚本必须包含与调用脚本相同的变量名，所以我需要为每个数组使用不同的脚本我希望运行脚本，但没有任何收获（我仍然会有重复的代码块）。

我已经研究过创建一个别名变量名来“替换”感兴趣的数组变量名，在这种情况下，我可以调用脚本并避免重复代码。但是，我找不到在 Matlab 中创建别名的任何方法。

最后，我尝试编写一个利用该函数的函数，并将数组变量的*字符串*`evalin()`名称传递给该函数，但尽管这可行，但性能也慢得多——与将数组按值传递给函数大致相同（性能至少下降 10 倍）。

 *我得出的结论是，在对非稀疏数组执行复杂操作时，在 Matlab 中不可能避免重复代码块，以避免使用任何可能的避免重复代码块的技术来避免 Matlab 似乎呈现的可怕开销。

我觉得这很难相信，但我找不到解决办法。

在 Matlab 中对多个非稀疏数组执行相同的复杂操作时，有人知道避免重复代码块的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-26T06:14:02.777

正如[Loren 在他的博客](http://blogs.mathworks.com/loren/2007/03/22/in-place-operations-on-data/)中指出的那样，MATLAB 确实支持对矩阵**的内联**运算，这基本上涵盖了通过引用传递数组、在函数中修改它们以及返回结果。您似乎知道这一点，但您错误地指出，*因为脚本必须包含与调用脚本相同的变量名*。这是显示这是错误的代码示例。测试时，请逐字复制并保存为函数：

```
function inplace_test
y = zeros(1,1e8);
x = zeros(1,1e8);

tic; x = compute(x); toc
tic; y = compute(y); toc
tic; x = computeIP(x); toc
tic; y = computeIP(y); toc
tic; x = x+1; toc
end

function x=computeIP(x)
x = x+1;
end

function y=compute(x)
y = x+1;
end 
```

我的电脑上的时间结果：

```
Elapsed time is 0.243335 seconds.
Elapsed time is 0.251495 seconds.
Elapsed time is 0.090949 seconds.
Elapsed time is 0.088894 seconds.
Elapsed time is 0.090638 seconds. 
```

如您所见，使用**就地**函数的最后两个调用对于输入数组`x`和`y`. 此外，它们与`x = x+1`没有功能的运行一样快。唯一重要的是**函数里面的**输入输出参数是一样的。还有一件事......

如果我猜你的代码有什么问题，我会说你制作了你希望就地的**嵌套函数。**他们不是。所以下面的代码将不起作用：

```
function inplace_test
y = zeros(1,1e8);
x = zeros(1,1e8);

tic; x = compute(x); toc
tic; y = compute(y); toc
tic; x = computeIP(x); toc
tic; y = computeIP(y); toc
tic; x = x+1; toc

    function x=computeIP(x)
        x = x+1;
    end

    function y=compute(x)
        y = x+1;
    end
end

Elapsed time is 0.247798 seconds.
Elapsed time is 0.257521 seconds.
Elapsed time is 0.229774 seconds.
Elapsed time is 0.237215 seconds.
Elapsed time is 0.090446 seconds. 
```

底线 - 小心那些嵌套函数..

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T23:42:30.963

您可以尝试将所有数组放入一个单元格数组并在其上使用索引，而不是按名称引用。函数仍将复制数组，但脚本可以完成这项工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T01:08:02.297

另一个答案：

有一篇很好的文章[In-place Operations on Data](http://blogs.mathworks.com/loren/2007/03/22/in-place-operations-on-data/)。显然，可能有两个陷阱：

1.  （这是微不足道的，你可能做到了）你应该使用相同的输入和输出变量名，不仅在函数的定义中，而且在你调用它的地方。
2.  这仅在您从 ANOTHER FUNCTION 而不是从命令行调用函数时才有效。奇怪......我试过了，虽然有开销，但它非常小（对于 10000 x 10000 阵列，从命令行需要 1 秒，从另一个函数需要 0.000361 秒）。

如果这对您不起作用，您可以使用未记录的功能，该功能允许您在 C++ MEX 文件中进行就地操作。这很讨厌，但这里有一篇关于此的文章：[Matlab mex in-place editing](http://undocumentedmatlab.com/blog/matlab-mex-in-place-editing/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-26T01:27:27.643

Brian L 建议的句柄解决方案确实有效，尽管修改包装数据的第一个调用确实需要很长时间（因为它必须复制原始数据）。

试试这个：

一些数据.m

```
classdef SomeData < handle
    properties        
            X
    end
    methods                
        function obj = SomeData(x)            
            if nargin > 0
                obj.X = x;
            else
                obj.X = [];
            end
        end
    end
end 
```

大运算

```
function directArray = LargeOp( someData, directArray )
    if nargin > 1
        directArray(1,1) = rand(1);
    else
        someData.X(1,1) = rand(1);
        directArray = [];    
    end
end 
```

测试性能的脚本

```
large = zeros(10000,10000);

data = SomeData(large);

tic
LargeOp(data);
toc

tic
large = LargeOp(data,large);
toc

tic
LargeOp(data);
toc

tic
large = LargeOp(data,large);
toc 
```

结果

```
Elapsed time is 0.364589 seconds.
Elapsed time is 0.450668 seconds.
Elapsed time is 0.001073 seconds.
Elapsed time is 0.443150 seconds. 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-25T23:14:54.417

根据您的需要，您可以通过创建[嵌套函数](http://www.mathworks.com/products/matlab/examples.html?file=/products/demos/shipping/matlab/nesteddemo.html)来完成此操作。

```
function A = evensarenegative(n)
    A = zeros(n,1);

    for i = 1:n
        if mod(i,2)
            nested1(i)
        else
            nested2(i)
        end
    end

    function nested1(i)
        A(i) = i;
    end

    function nested2(i)
        A(i) = -i;
    end
end 
```

在这里，函数共享相同的工作空间，尤其是`A`矩阵，因此不会复制任何变量。我发现它是一种组织代码的便捷方式，尤其是当我有很多次要（但可能是冗长的）操作作为更大工作流程的一部分时。*

# keyboard-shortcuts - Geany 键盘快捷键，用于循环浏览参数建议

> ID：13078339
> 
> 赞同：6
> 
> 时间：2012-10-25T22:32:26.060
> 
> 标签：keyboard-shortcuts, geany

我有点沮丧，用非常酷的轻量级编辑器 Geany 编辑一个更大的 C++ 项目。

我想知道是否有一个键盘快捷键可以循环浏览 geany 在打开括号以调用函数时显示的参数建议（见图）。

![在此处输入图像描述](../Images/0312ecbc97ff7ee28e428c9057c4dddd.png)

我找不到任何快捷方式，当单击鼠标光标悬停在所示图像中的按钮时，geany 会做什么（即循环遍历不同的构造函数 - 在本例中为 MenuButtonRect）。到目前为止，我一直在使用鼠标，这会稍微中断工作流程。有这个键盘快捷键吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-25T05:16:31.760

不幸的是，目前这是不可能的，但它可能有用。查看 Scintilla 错误跟踪器，有一个[拒绝的功能请求](https://sourceforge.net/p/scintilla/bugs/208/)。Scintilla 是 Geany 使用的编辑器小部件。我不认为 Scintilla 的维护者反对这样的功能，但他不会自己实现它。如果您有兴趣添加该功能，您可以联系 scintilla-interest 邮件列表或在 Geany 邮件列表或 FreeNode IRC 上的#geany 上联系我们，我们可以帮助指导您如何继续将其放入 Scintilla 和吉尼。

# objective-c - 获取所有核心数据子实体

> ID：13078342
> 
> 赞同：0
> 
> 时间：2012-10-25T22:32:47.007
> 
> 标签：objective-c, sql, cocoa, core-data

假设我在 Core Data 中有一个 Song 实体和 Genre 实体。流派有很多歌曲。

我想执行一个获取请求来获取所有歌曲的流派。这意味着流派会出现多次。或者，用 SQL 术语来说，

```
select G.*
  from Songs S
       join Genres G on G.id = S.genre_id 
```

我意识到 SQL 等效项有点牵强，因为我不需要外键/主键。目标是一样的。看起来很简单，但我在研究中找不到完全适合我的问题的答案。

我的最终目标是汇总类型并计算它们，[就像在这篇文章](https://stackoverflow.com/a/10842113/260460)中一样。同样，用 SQL 术语来说：

```
select G.name, count(*)
  from Songs S
       join Genres G on G.id = S.genre_id
 group by G.name 
```

我希望通过对这个问题的理解，我可以从链接中添加代码以获得我想要的东西。随意告诉我，如果 CD 不能那样工作，它就不会工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T02:03:36.587

为什么不直接为没有 NSPredicate 的“流派”实体创建一个 NSFetchRequest？您将获得所有流派实例。还是您只想要有歌曲的流派？[如果是这样，您可以在此处](https://stackoverflow.com/questions/2785844/how-to-fetch-distinct-values-in-core-data)找到示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:05:39.070

假设在您的核心数据模型中，每个流派与一首歌曲有一对多的关系，以下将为您提供每种流派的歌曲计数（实际上是聚合您的流派并计算它们），其中流派附加到至少 1 首歌曲：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"ANY songs != NULL"];
NSEntityDescription *genres = [NSEntityDescription entityForName:@"Genre" 
                                          inManagedObjectContext:moc];
NSFetchRequest *request = [[NSFetchRequest alloc] init];
[request setEntity:genres];
[request setPredicate:predicate];
NSError *error;
NSArray *genresArray = [moc executeFetchRequest:request error:&error];
NSLog(@"Total number of genres that have songs: %d", genresArray.count);
for (NSManagedObject *genre in genresArray) {
  NSLog(@"Genre: %@ (%@)", [genre valueForKey:@"genreName"], [genre valueForKeyPath:@"songs.@count"]);
} 
```

# mysql - Mysql - GPS 距离

> ID：13078344
> 
> 赞同：0
> 
> 时间：2012-10-25T22:32:59.367
> 
> 标签：mysql, gps

我在表“A”中有一个 GPS 坐标 Lat 4.649182 Long -74.108948，我需要使用存储在表“B”中的值来计算距离，如下所示：

```
Id    UserID  Lat             Long       
1     1       4.649200    -74.109200 
2     1       4.649110    -74.108860 
3     2       4.648985    -74.108831 
4     3       4.64923     -74.10893666 
```

通常使用这个公式来计算两点之间的距离：

```
SELECT (acos(sin(radians(LATITUDE_1)) * sin(radians(LATITUDE_2)) +
cos(radians(LATITUDE_1)) * cos(radians(LATITUDE_2)) * 
cos(radians(LONGITUDE_1) - radians(LONGITUDE_2))) * 6378) as Distance; 
```

但是我需要结果显示当 UserID = 1 时各个点之间的距离，它看起来像这样

```
Id    UserID  Lat             Long       Distance
1     1       4.649200    -74.109200      XX
2     1       4.649110    -74.108860      XX 
```

# ruby - 为什么此返回“无法将 nil 转换为字符串”

> ID：13078346
> 
> 赞同：1
> 
> 时间：2012-10-25T22:33:25.493
> 
> 标签：ruby, cucumber, pageobjects, page-object-gem

我正在使用与 Jeff Morgan 的书“Cucumber & Cheese”几乎完全相同的设置，并且我有一个这样的页面对象

```
class NewPublicationPage
  include PageObject
  include RSpec::Matchers
  ... 
  def submit_basic_message_with_tag
    @tag = Time.now.to_i
    ...
    self.tag_entry = @tag
    # the tag ends up getting added later on down the road to a div container.
    ...
  end

  def verify_last_tag
    done_loading
    # tag_list is a div container that should contain the tag.
    tag_list.should include @tag
  end
end 
```

当我在 Cucumber 步骤中运行以下命令时，每个命令都有自己的步骤，它会说`cannot convert nil to string`. 我知道这与实例变量@tag 有关，但我不确定为什么。

```
When /^I submit a basic message with tags$/ do
  on_page(NewPublicationPage).submit_basic_message_with_tag
end

Then /^I should see the tag under Publish History$/ do
    visit_page(PublishHistoryPage) # goes to page with div container that holds tags
    on_page(NewPublicationPage).verify_last_tag #this creates the error
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T12:05:10.330

但无论如何，您只需要在尝试阅读之前设置@tag。因此，例如，您可以在 verify_last_tag 方法的开头设置它，或者如果您需要它在两个测试中都相同，您可以看看[那个帖子](http://www.cloudspace.com/blog/2010/06/23/using-instance-variables-with-cucumber-steps/) 我不是黄瓜专家，所以我真的帮不上忙你。

# ios - 使用 WSAssetPickerController 时遇到问题

> ID：13078348
> 
> 赞同：1
> 
> 时间：2012-10-25T22:33:33.760
> 
> 标签：ios, xcode, image, picker

我正在尝试在我的项目中使用一个名为[WSAssetPickerController](https://github.com/w5mith/WSAssetPickerController)的库。它是 iOS 的选择器控制器，可让您选择多张图片。我已严格按照说明将其包含在我的项目中，但出现以下错误：

```
ld: warning: ignoring file /Users/davdon42/Documents/Apps/Photomosaic/Photo Mosaic/libWSAssetPicker.a, missing required architecture i386 in file /Users/davdon42/Documents/Apps/Photomosaic/Photo Mosaic/libWSAssetPicker.a (2 slices)
Undefined symbols for architecture i386:
  "_OBJC_CLASS_$_WSAssetPickerController", referenced from:
      objc-class-ref in ImportImagesViewController.o
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

有任何想法吗？

我认为这可能与 xcode 和 iphone sdk 的版本有关。我正在使用针对 iOS 5.1 的 Xcode 版本 4.5.1 和 iOS SDK 6.0。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T03:39:04.577

用户1775671,

该错误是由于没有为 iOS 模拟器编译该库。我更新了项目以编译模拟器和设备的库。自述文件也更新了新的说明，如下所示：

1.  打开演示项目
2.  选择`WSAssetPickerCombined`方案
3.  在菜单栏中选择产品 > 构建
4.  将生成的`WSAssetPicker`目录（位于项目目录的 builds 文件夹中）复制到您的项目中。
5.  确保`libWSAssetPicker-Combined.a`已将其添加到您的目标构建阶段

您还可以通过[CocoaPods](http://cocoapods.org/)获取代码，这是一种非常方便的方式来管理您的项目的依赖关系。

# python - 如何以 Pythonic 方式处理这些类函数调用？

> ID：13078350
> 
> 赞同：0
> 
> 时间：2012-10-25T22:33:42.903
> 
> 标签：python, python-2.7

我对 Python 比较陌生，我刚刚开始上课。我手上有一些复杂的东西，我想以正确的 Pythonic 方式解决。

我想有一门课，比如说“**书**”。我希望这个类能够处理两个具有不同结构的 python 字典，比如“**化学**”和“ **（英语）字典**”。我希望能够对这两个具有不同结构的 python 字典执行操作，例如“**查找**”、“**添加**”、“**删除**”、“**列表**”等。

由于这两个结构，“**化学**”和“**字典**”是不同的，“**添加**”、“**删除**”和“***查找***”函数将需要具有不同的代码结构。因此，当我在 ' **chemistry** ' 中查找某些内容时，要执行的代码块与**'dictionary' 中的 'finding'**不同。

我的问题：

*   我应该如何组织这门课？

*   我应该如何拨打电话？

*   最终，如果函数调用看起来像：`books.chemistry.find('keyword to find')`和`books.dictionary.find('other keyword to find')`. 这可能吗？我怎么能这样得到它？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:50:08.557

通常你还想在你的类之间共享一些方法，这样你就可以拥有一个`Book`具有通用属性的类，然后一个`Chemistry`类`English`定义不同的`find`方法并从以下位置继承属性或方法`Book`：

```
class Books(object):
    def __init__(self, dictionary):
        self.input = dictionary
    def commonMethod(self):
        print 'This is a shared method'

class Chemistry(Books):
    def find(self):
        print 'This is a particular method'

class English(Books):
    def find(self):
        print 'This is other particular method'

chemistryBook = Chemistry({'hello': 'goodbye'})
chemistryBook.find()
# This is a particular method

EnglishBook = English({'hello': 'goodbye'})
EnglishBook.find()
# This is other particular method 
```

**更新**

我没有阅读你留言的最后一部分。也许这就是你想要的：

```
class Books(object):
    def __init__(self, dictionary):
        self.input = dictionary
        if len(dictionary) > 1:
            print 'More than 1'
            self.command = Chemistry(self.input)
        else:
            print 'Less or equal'
            self.command = English(self.input)

class Chemistry(object):
    def __init__(self, d):
        self.d = d
    def find(self):
        print "Now you can manipulate your dictionary in Chemistry", self.d

class English(object):
    def __init__(self, d):
        self.d = d
    def find(self):
        print "Now you can manipulate your dictionary in English", self.d

book = Books({'hello': 'goodbye'})
book.command.find()
# Less or equal
# Now you can manipulate your dictionary in English {'hello': 'goodbye'}

book2 = Books({'hello': 'goodbye', 'one': 1})
book2.command.find()
# More than 1
# Now you can manipulate your dictionary in Chemistry {'hello': 'goodbye', 'one': 1} 
```

基本上，这会根据输入创建所需的类的特定实例。在这种情况下，如果您作为参数传递的字典长度 > 1，它会创建一个 Chemistry() 实例。否则，它会创建一个 English() 实例。之后，您可以使用 find 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T22:50:41.143

```
#Here's what I would do.

class Page(object):
    def __init__(self, text):
        self.text = text

class Book(object):

    def __init__(self, pages):

        if type(pages) == Page:
            self.pages = [pages]
        elif type(pages) == list:
            self.pages = pages

    def find(self, term):

        for page in self.pages:
            if term in page.text:
                return True
        return False

class ChemistryBook(Book):

    def __init__(self, pages):

        super(ChemistryBook, self).__init__(pages)

    #def someChemistryBookSpecificMethod(self):
    pass

if __name__ == '__main__':

    page = Page("Antoine Lavoisierb")
    chemBook = ChemistryBook(page)
    print chemBook.find("Antoine") 
```

# mod-rewrite - mod rewrite QUERY_STRING issue

> ID：13078354
> 
> 赞同：0
> 
> 时间：2012-10-25T22:34:17.067
> 
> 标签：mod-rewrite, apache2

All,

I am redirecting some urls with specific query strings to new page . For example `http://testserver.xyz.com/abc/content/content.jsp?contentId=123` or `http://testserver.xyz.com/abc/content/content.jsp?contentId=345` needs to be redirected to `http://ww2.newtestserver.com/xyz.html`

For this purpose i wrote following redirects:

```
RewriteCond %{QUERY_STRING} contentId=123 [OR]
RewriteCond %{QUERY_STRING} contentId=345 [OR] 
RewriteCond %{QUERY_STRING} contentId=678 
RewriteRule ^/(.*)$ http://ww2.newtestserver.com/xyz.html/? [R=301,L] 
```

This works fine except when i type in my browser `http://testserver.xyz.com/abc/content/content.jsp?contentId=1234`. This also gets redirected to `http://ww2.newtestserver.com/xyz.html`.

I do not want this. how can i prevent this so that my mod rewrite only looks at query string 123 or 345 or 567 but not something 123x or 345x or 678x?

Please help

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T07:26:50.400

To make sure that the rewrite looks only at the exact query strings you specified, you should tell it that those are the *full* query strings using `^` and `$`. `^` matches the beginning of the string, and `$` matches the end.

```
RewriteCond %{QUERY_STRING} ^contentId=123$ [OR]
RewriteCond %{QUERY_STRING} ^contentId=345$ [OR]
RewriteCond %{QUERY_STRING} ^contentId=678$
RewriteRule ^/(.*)$ http://ww2.newtestserver.com/xyz.html [R=301,L] 
```

The above code will work. The code below might work (and should be more efficient), but I'm not at a computer I can test on right now.

```
RewriteCond %{QUERY_STRING} ^contentId=(123|345|678)$
RewriteRule ^/(.*)$ http://ww2.newtestserver.com/xyz.html [R=301,L] 
```

# pyside - 如何让 PySide QWebView 显示所有图像？

> ID：13078357
> 
> 赞同：1
> 
> 时间：2012-10-25T22:34:31.370
> 
> 标签：pyside

下面显示的带有 QWebView 的最简单的 PySide 应用程序显示了缺少许多但并非所有图像的网页。导致问题的原因是 gif、png 还是 jpg 并不一致。这可能与正在下载的图像的大小有关。

```
from sys import exit
from PySide.QtGui import QApplication
from PySide.QtWebKit import QWebView, QWebPage

app = QApplication([])
webview = QWebView()

webview.show()

webview.load("http://bbc.co.uk")

exit(app.exec_()) 
```

我的环境是 PySide=1.1.2 使用 easy_install 安装到在 Windows 7 机器上运行的 Python 2.7 virtualenv 中。

我寻找与缓存中图像大小有关的设置，这是我的怀疑之一，但我找不到任何东西。页面的其余部分正确加载，包括所有 js 和 css 部分。

任何关于这里可能出错的建议将不胜感激。

# c# - 创建所有 ExpressionTree/Func 参数的数组

> ID：13078363
> 
> 赞同：3
> 
> 时间：2012-10-25T22:35:02.247
> 
> 标签：c#, lambda, expression, expression-trees

以下程序的输出是：

第一个：System.String。第二：System.String。

预期的结果是：第一：hello1。第二：你好2。

如果我在 Expression.Assign(resultArrayAccessor, parameters[0]) 中将索引硬编码为 1 或 2，它可以工作，但我需要在变量 i 之后有索引。

```
 public static void Main()
    {
        var type = typeof(Func<string, string, object>);
        var del = GenerateFunc<Func<string, string, object>>(type);
        del("hello1", "hello2");
        Console.ReadLine();
    }

    public static T GenerateFunc<T>(Type type)
    {
        var i = Expression.Parameter(typeof (int), "i");

        var x = type.GetMethod("Invoke");
        var target = typeof (Program).GetMethod("Target");

        var resultArray = Expression.Parameter(typeof(object[]), "result");
        var parameterArray = Expression.Parameter(typeof(ParameterExpression[]), "parameters");

        var resultArrayAccessor = Expression.ArrayAccess(resultArray, i);
        var parameterArrayAccessor = Expression.ArrayAccess(parameterArray, i);

        var label = Expression.Label();

        var parameters = x.GetParameters().Select(p => Expression.Parameter(p.ParameterType, p.ParameterType.ToString())).ToArray();

        var block = Expression.Block(x.ReturnType,
            new[] { resultArray, i, parameterArray },
            Expression.Assign(resultArray, Expression.Constant(new object[parameters.Length])),
            Expression.Assign(parameterArray, Expression.Constant(parameters)),
            Expression.Loop(
                Expression.Block(
                    Expression.IfThenElse(
                        Expression.LessThan(i, Expression.Constant(parameters.Length)),
                            Expression.Block(
                                Expression.Assign(resultArrayAccessor, parameterArrayAccessor),
                                Expression.PostIncrementAssign(i)
                            ),
                        Expression.Break(label)
                    )
                ),
                label
            ),

            Expression.Call(target, resultArray)
        );

        return Expression.Lambda<T>(block, parameters).Compile();
    }

    public static object Target(object[] test)
    {
        Console.WriteLine("First: " + test[0] + ". Second: " + test[1] + ".");
        return null;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T16:29:57.540

终于弄明白了，更简单的语法以及实际工作;）

```
public static T GenerateFunc<T>(Type type)
{
    var target = typeof (Program).GetMethod("Target");

    var invokeMethod = type.GetMethod("Invoke");
    var parameters = invokeMethod
      .GetParameters()
      .Select(pi => Expression.Parameter(pi.ParameterType, pi.Name))
      .ToList();

    var parametersExpression = Expression.NewArrayInit(typeof(object), parameters);
    var body = Expression.Call(target, parametersExpression);
    return Expression.Lambda<T>(body, parameters).Compile();
} 
```

# file - 在 Fortran 中读取 ASCII 文件

> ID：13078364
> 
> 赞同：-1
> 
> 时间：2012-10-25T22:35:02.487
> 
> 标签：file, fortran, ascii

我有个问题。我的桌面上有一个充满数字的 ASCII 文件，但我需要知道如何使用 FORTRAN 读取 ASCII 文件。你能告诉我它是如何完成的或者是什么命令的例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T14:32:56.110

You didn't give many details, so I'm going to make some assumptions here. Let's say that your file consists of 3 columns of floating point numbers, i.e.

```
1.2345 -4.222e7 2.229
77.222 77e7     50
... 
```

If you simply want to read these numbers without storing them in an array, this could be done straightforwardly as

```
 integer :: unit
    real    :: a,b,c
    unit = 20
    open(unit,"foo.txt",status="old",action="read")
    do
        read(unit,*,end=1) a, b, c
        write(*,*) "I got", a, b, c
    end do
    1 close(unit) 
```

If you want to store these numbers as an array, however, you first need to allocate the appropriate amount of space, for which you need to know the number of lines. This requires a preliminary pass through the file, sadly, because Fortran doesn't provide growing arrays, and implementing a replacement yourself is inconvenient. Assuming you use fortran 90 or newer, this would look something like this:

```
 integer :: unit, i, n
    real, allocatable :: data(:,:)
    unit = 20
    open(unit,"foo.txt",status="old",action="read")
    n = 0
    do
        read(unit,*,end=1)
        n = n+1
    end do
    1 rewind(unit)
    allocate(data(n,3))
    do i = 1, n
        read(unit,*) data(i,:)
    end do
    close(unit) 
```

The unit number is simply some unique user-chosen number. Beware that some low numbers have predefined meanings. It is common to define a function like getlun() that will provide a free unit number for you. A quick google search produced this: [http://ftp.cac.psu.edu/pub/ger/fortran/hdk/getlun.f90](http://ftp.cac.psu.edu/pub/ger/fortran/hdk/getlun.f90). If you have a new enough compiler, you can use open(newunit=unit,...) which will automatically assign a free unit number to the variable "unit".

# ios - 由于 .xib 中的 IBClassDescriber 元素为空，XCode 中的 .h 文件关联丢失

> ID：13078367
> 
> 赞同：0
> 
> 时间：2012-10-25T22:35:15.583
> 
> 标签：ios, xcode, xamarin.ios, xib

注意：也许这个问题也可以由纯 Objective-C 专家来回答？我主要在 MonoTouch 中工作，但我认为这个问题可能*不是*MonoTouch 特有的。

通常，当 XCode 中的助理编辑器不显示我的`.h`文件时，我只需[关闭所有内容，删除我的 obj 目录，然后重建所有](https://stackoverflow.com/questions/10475120/xcode-has-lost-associating-from-xib-to-h-file-monotouch). 我等待该`Indexing`过程完成。但是这次我真的无法让`.h`文件显示出来，因此我无法在我的`FooViewController`.

到目前为止，我已经将它追踪到`IBClassDescriber`我的一个空元素`FooViewController.xib`

```
<object class="IBClassDescriber" key="IBDocument.Classes"/> 
```

这应该看起来更像：

```
<object class="IBClassDescriber" key="IBDocument.Classes">
        <array class="NSMutableArray" key="referencedPartialClassDescriptions">
                <object class="IBPartialClassDescription">
                        <string key="className">FooViewController</string>
                        <string key="superclassName">UIViewController</string>
                        <dictionary class="NSMutableDictionary" key="outlets">
                            ...
                        </dictionary>
                        <dictionary class="NSMutableDictionary" key="toOneOutletInfosByName">
                            ...
                        </dictionary>
                        <object class="IBClassDescriptionSource" key="sourceIdentifier">
                                <string key="majorKey">IBProjectSource</string>
                                <string key="minorKey">./Classes/FooViewController.h</string>
                        </object>
                </object>
        </array>
</object> 
```

其中包含指向该`.h`文件`minorKey`的链接`IBClassDescriptionSource`。

我试过清理我的项目，关闭我的所有应用程序并删除`obj`和`bin`目录。我试过重命名文件（连同上面的文件）。以及其他各种零星的诅咒和删除/还原/大声敲打东西。无济于事。

`IBClassDescriber`有谁知道元素清空后如何恢复？

我将回顾一下文件历史记录，看看它什么时候消失了。也许这会给我一个线索。

谢谢！厘米

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T01:37:30.840

因此，当我重命名`ViewController`文件并且未能更新对旧名称的所有引用时，就会出现这种情况（就像其他人所做的那样）。视图控制器的名称有几个地方需要更改，但实际上只有 2 个关键地方需要匹配以使 XCode 和 MonoDevelop 同步。对于此示例，假设我有一个名为的视图控制器并将`FooViewController`其重命名为`BarViewController`.

首先，每次启动 XCode (XC) 时，MonoDevelop (MD) 都会创建一个名为`obj/XCode/#`where`#`从 0 开始的临时目录，每次重新启动 XC 时都会递增 1。每次重新启动 MD 时，该数字都会重置为 0。每次关闭 XC 并返回 MD 时，目录都会被删除。

注意：如果您从 Finder 或终端等浏览目录，该目录不会被删除。

MD在 XC 期望看到的目录中创建所需的文件`.h`和文件。这些文件的名称`.m`基于. 就我而言，我已将文件正确更新为：`Register``YourViewController.designer.cs``.designer`

```
[Register ("BarViewController")] 
```

现在，当我打开时，`.xib`我得到了可怕的`No Assistant Results`错误。

此时，我的`.xib`文件在 MD 的源代码编辑器中打开时，显示了一个完整的`IBClassDescriber`部分（尽管`./Classes/FooViewController.h`由于我还没有更新它，所以引用不正确）。

我接下来要做的是从 XC中**保存。**`.xib`由于 XC 找不到`./Classes/FooViewController.h`（MD 现在正在生成`BarViewController.h`），它从 中删除了该`IBClassDescriber`部分`.xib`，给了我一个空实体

```
<object class="IBClassDescriber" key="IBDocument.Classes"/> 
```

我未能`.xib`正确更新，现在我丢失了整个部分（其中有许多我不想或不知道如何重新创建的引用）。

解决此问题的关键是注意到 中的`-1.CustomClassname`属性`.xib`设置不正确。更新它以匹配`Register`设置

```
<dictionary class="NSMutableDictionary" key="flattenedProperties">
    <string key="-1.CustomClassName">BarViewController</string>
    ...
</dictionary> 
```

并重新保存文件导致 XC使用对文件`IBClassDescriber`的正确引用重新创建整个部分`.h`

```
<object class="IBClassDescriber" key="IBDocument.Classes">
        <array class="NSMutableArray" key="referencedPartialClassDescriptions">
                <object class="IBPartialClassDescription">
                        <string key="className">BarViewController</string>
                        <string key="superclassName">UIViewController</string>
                        <object class="NSMutableDictionary" key="outlets">
                            ...
                        </object>
                        <object class="NSMutableDictionary" key="toOneOutletInfosByName">
                            ...
                        </object>
                        <object class="IBClassDescriptionSource" key="sourceIdentifier">
                                <string key="majorKey">IBProjectSource</string>
                                <string key="minorKey">./Classes/BarViewController.h</string>
                        </object>
                </object>
        </array>
</object> 
```

总而言之，当您重命名文件时，要更改的地方是：

1.  重构/重命名您的主 ViewController 类（例如，改名`FooViewController.cs`为`BarViewControllercs`. 使用重构（右键单击类文件 -> 重构 -> 重命名）将为您更新很多东西，包括`.designer`文件和整个代码中对该类的任何引用
2.  `public GrepViewController () : base ("BarViewController", null)`在运行时加载类所需的 ViewController 构造函数中更改传递给超类的字符串值
3.  打开您的`.designer`文件并更改`Register`调用，以便保持 XC 和 MD 之间的链接：`[Register ("BarViewController")] partial class BarViewController`
4.  重命名`.xib`：`BarViewController.xib`
5.  使用源代码编辑器在 MD 中打开`BarViewController.xib`（右键单击 -> 打开方式 -> 源代码编辑器）并更改`-1.CustomClassName`密钥：`<string key="-1.CustomClassName">BarViewController</string>`
6.  `.xib`从 MD保存
7.  `BarViewController.xib`在 XC 中打开。（如果你已经在 MD 中打开它，你需要右键单击 -> 打开方式 -> XCode）。等待索引完成，然后打开 Assistant Editor。请注意，`BarViewController.h`它（正确地）打开了。
8.  `.xib`从 XC保存。
9.  打开`.xib`MD 并注意该`IBClassDescriber`部分已完全指定，即使它一开始是空的。

装运它！

希望这对某人有所帮助，解开 XC 和 MD 之间联系的一些谜团，或者至少提醒我下次遇到这个问题时该怎么做。

干杯，厘米

# firefox-addon - 如何在我的 Firefox 插件中显示 HTML 块？

> ID：13078369
> 
> 赞同：0
> 
> 时间：2012-10-25T22:35:26.797
> 
> 标签：firefox-addon, xul

我使用 XUL 创建了一个工具栏按钮。当我单击此按钮时，我希望以与单击 Google Chrome 中的扩展程序相同的样式弹出一个 div。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T06:01:08.597

如果您想将 HTML 元素添加到 XUL 文档，您必须为其定义命名空间：

```
<window
  xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
  xmlns:html="http://www.w3.org/1999/xhtml"
> 
```

然后您可以添加 HTML 元素，但您必须在标签名称前加上命名空间。像这样：

```
<vbox>
  <description>This is XUL element</description>
  <html:div>This is HTML element</html:div>
</vbox> 
```

[您可以在 Mozilla Developer Network](https://developer.mozilla.org/en-US/docs/XUL_Tutorial/Adding_HTML_Elements)的官方文档中找到更多信息和示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T00:16:27.893

```
<?xml-stylesheet href="chrome://global/skin" type="text/css"?>
  <window xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">

  <button label="Details" type="panel">
      <panel id="search-panel">
        <label control="name" value="Name:"/>
        <textbox id="name"/>
      </panel>
  </button>

   </window> 
```

按钮可以替换为工具栏按钮

# report - 如何记录序列图

> ID：13078371
> 
> 赞同：1
> 
> 时间：2012-10-25T22:35:34.010
> 
> 标签：report, document, sequence-diagram

如何在技术报告中记录（描述）序列图？有什么指导方针吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T07:43:54.823

`Sequence diagrams`代表你的`use-cases`。的文档`sequence diagram`是相应的`use-case`描述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:53:38.397

尽管有 UML 模板.... 将事件绘制为向下倾斜的线而不是水平线。

水平线误导大脑认为在发送事件和接收事件之间没有时间流逝。

我以前曾多次以这种方式重绘另一个序列图，并寻找可以说事件可以“在邮件中交叉”的病态案例......并发现了一个错误。

[消息序列图生成器](http://www.mcternan.me.uk/mscgen)是一个方便的工具。

# php - 使用 PHP 和 AJAX 的基于 Cookie 的投票

> ID：13078379
> 
> 赞同：2
> 
> 时间：2012-10-25T22:36:19.683
> 
> 标签：php, ajax, cookies

在我的网站上，我有一个民意调查。这是基于 cookie 的民意调查。如果用户投票，我会使用当前投票创建一个 cookie，因此在创建新投票之前他无法投票。我知道用户可以删除 cookie 并再次投票，但这不是这里的问题。

我有一个处理 ajax 帖子的 ajax.php 页面。这是代码：

```
if(isset($_COOKIE['poll_id']) && $_COOKIE['poll_id'] == $poll_id)
{
// print message that it is already voted, show the results...
}
else
{
// update the database and create a cookie
} 
```

如果在按钮单击时进行投票，则此代码可以正常工作。但是，我在 Firebug 中启动了一个 javascript，它正在这样做：

```
for(var i=0;i<100;i++) {
    jQuery.post('ajax.php', {
        //post parameters
    });
} 
```

我得到100票。如果我再次运行脚本，它会失败，因为创建了一个cookie，但似乎如果我同时发出100个请求，检查失败，因为我猜系统没有时间及时创建cookie，所以所有的更新都会通过。

关于如何解决这个问题的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T22:48:18.717

这就是`XSRF`玩的地方。在您的站点中，您应该首先创建一个随机（适当加盐且足够安全）字符串并将其存储在会话中。在您的所有页面中，您应该获取此会话值并将其与表单提交一起传递。在检查用户输入时，您应该将此值作为页面请求的一部分进行检查。

现在，如果您在投票页面中发送此内容，并且在 ajax.php 中检查此内容，那么您将找到该值并知道这是一个安全请求。当有人尝试通过 firebug/jquery 等进行智能操作时，他们将无法访问/发送此值，并且您的页面可以忽略此类请求。

当然，为了更好/更容易理解，我的解释过于简单化了。但是请阅读更多关于它的内容，这将有助于解决您的场景并使您的代码更加健壮。

**添加一个简单的伪代码示例：**

首先假设您的随机 XSRF 字符串已在会话中设置。

```
jQuery.post('ajax.php', {
     <?php echo $_SESSION['token'];?>,
    //rest of the post parameters
}); 
```

现在当有人用萤火虫尝试它时：

```
for(var i=0;i<100;i++) {
    jQuery.post('ajax.php', {
        //post parameters
        //cannot access $_SESSION['token'] so cannot pass it..
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:42:17.600

设置 cookie 时尝试重定向，以便 Set-Cookie 标头在请求中

# c# - 像处理数组一样处理位图

> ID：13078380
> 
> 赞同：-1
> 
> 时间：2012-10-25T22:36:21.027
> 
> 标签：c#, arrays, winforms, bitmap

好吧，我想知道是否有人编写代码以在表单上显示位图。
是否可以像 c# 中的数组一样直接访问它？

我想知道这是因为位图已经存在于内存和屏幕上。
但我不确定如何指出它；喜欢指针或数组的位置，我想在 c# 中执行此操作，而且我也不知道表单上的数组数据结构（比如它是 RGB BGR / RGB24 等）

请注意，此图像源不是来自文件，而是来自网络摄像头。
另外，我想这样做的一个原因是因为 getpixel / putpixel 会减慢我想要的速度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:52:47.633

如果要获取数组中的图像像素，可以这样做：

```
 Bitmap image = new Bitmap("somebitmap.png");
            Rectangle area = new Rectangle(0,0,image.Width, image.Height);
            BitmapData bitmapData = image.LockBits(area, ImageLockMode.ReadWrite, PixelFormat.Format24bppRgb);
            int stride = bitmapData.Stride;
            IntPtr ptr = bitmapData.Scan0;
            int numBytes = bitmapData.Stride * image.Height;
            byte[] rgbValues = new byte[numBytes];
            Marshal.Copy(ptr, rgbValues, 0, numBytes); 
```

当您更改它们时，您应该使用以下方法将该数组复制回位图：

```
 Marshal.Copy(rgbValues, 0, bitmapData.Scan0, bitmapData.Stride * image.Height);
            image.UnlockBits(bitmapData); 
```

But if you realy want to deal with pixels like you said, you should use some [FastBitmap](http://code.google.com/p/renderterrain/source/browse/trunk/Utilities/FastBitmap.cs?r=18) implementation. There are many other implementations available also.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:42:19.533

在 C# 中访问位图当然是可能的——甚至很容易——就像一个数组一样。使用位图类：

```
Bitmap bmp = new Bitmap(640, 480);
Color pixel = bmp.GetPixel(x, y);    // "array like" access
bmp.SetPixel(x,y, Color.FromArgb(red,green,blue); 
```

在您的情况下，诀窍是将位图放入 Bitmap 类。如果它已经在表单上，​​您可以创建一个“图形上下文”并从中检索它：

```
Graphics g = this.CreateGraphics();
Bitmap bmp = new Bitmap(640, 480, g); 
```

或从控件：

```
Graphics g = this.MyControl.CreateGraphics();
Bitmap bmp = new Bitmap(640, 480, g); 
```

您无需担心它的内部 RGB(A) 格式，只需处理“颜色”类型并根据需要设置/获取它的 R/G/B 组件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T22:43:53.953

位图中的像素不通过数组暴露，即 mybitmap[x,y]。

您可以使用 GetPixel(x,y) 方法访问特定像素的颜色值，或使用 SetPixel(x,y) 更改值。

# joomla - 在 Joomla 3 中的其他 Javascript 之前加载 jQuery

> ID：13078383
> 
> 赞同：8
> 
> 时间：2012-10-25T22:36:29.920
> 
> 标签：joomla, joomla-extensions, joomla3.0

我正在为 Joomla 3 调整一个自定义组件。它依赖于 jQuery，这是我之前自己加载的。现在它已包含在基本模板中，我不需要。但是，我的依赖于 jQuery 的自定义 javascript 是首先加载的。我使用以下表格加载它们：

```
$document = JFactory::getDocument();
$document->addScript( PATH TO SCRIPT); 
```

这正确地将它们包含在`<head>`元素中，但它们是在 jQuery 之前加载的。

一些快速搜索显示`abstract class JHtmlJquery`，`libraries/cms/html/jquery.php`但我不确定从哪里调用它。

如何更改加载顺序，以便在依赖它的脚本之前加载 jQuery？我可以在不进入核心代码的情况下做到这一点吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-29T16:02:27.357

马里奥的回答是朝着正确的方向发展，但并没有完全做到。事实证明，`JHtml::('bootstrap.framework');` **在加载其他脚本之前，您必须在组件中包含代码（不仅仅是模板文件）。**我正在使用库存的 J3 模板 protostar，它在其模板 index.php 中包含 twitter 引导程序。

我的自定义 view.html.php 的代码现在如下：

```
class MyView extends JViewLegacy
{
    function display($tpl = null)
    {
        $document = JFactory::getDocument();
        JHtml::_('bootstrap.framework');

        $document->addScript( PATH_TO_SCRIPT );

        ...
    }
} 
```

这符合预期，并且 jQuery 和 Bootstrap 文件（`jquery.min.js`、`jquery-noconflict.js`和`bootstrap.min.js`）包含在`<head>`我的自定义脚本之前。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-08T20:30:41.270

我找到了解决方案。我不希望模板和组件都加载引导程序，加上在加载某些模块的单篇文章的页面上，我不想让每个模块也加载引导程序..（我的意思是有点荒谬..）所以我决定完全从模板中取出引导程序，我构建了一个系统插件，它只加载引导程序，然后我将插件的加载顺序设置为首先加载。效果很好。。

```
// Bootstrap Loader

    jimport('joomla.plugin.plugin');

    class plgSystemBootstrapLoader extends JPlugin {

        function onAfterRoute() {

            // Load Bootstrap
            JHtml::_('bootstrap.framework');
            $document = JFactory::getDocument();
            $document->addStyleSheet('/media/jui/css/bootstrap.min.css');
            $document->addStyleSheet('/media/jui/css/bootstrap-responsive.css');
        }

    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T00:39:15.387

你用的是什么模板？在 J3 中，将 jQuery 平台加载到页面底部是一种常识，这样页面加载速度会更快。在您的模板中查找 `JHtml::_('bootstrap.framework'); // Loads the jQuery js scripts` 并尝试在此之后加载您的 js。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-26T09:12:59.043

`$document->addScript( PATH TO SCRIPT);`Joomla 可能会按照执行组件和模块代码的添加顺序来编写包含在其中的脚本和 css 文件。

我进行了一些搜索，但找不到影响单独声明或 jQuery 加载的方法。但我可以提供其他解决方案。

我不能说我确定这将是您问题的解决方案，因为我不知道您的代码做了什么，或者什么时候需要做某事。因此，我将提供最广泛的解决方案；）

只要您的代码在页面准备好之前不必处于活动状态，这将起作用。

将您的自定义代码包装在 js on ready 语句中，因此在页面（因此 jQuery 已加载）之前它不会做任何事情。

```
if (document.readyState === "complete") { 
    DoYourStuff(); 
} 
```

# ios - 适用于不同设备的 iOS 用户界面

> ID：13078387
> 
> 赞同：0
> 
> 时间：2012-10-25T22:36:42.500
> 
> 标签：ios, xcode, user-interface, device

我对如何同时处理不同操作系统和设备的用户界面感到困惑。

如果我想支持 iOS 4.3+，并为不同屏幕尺寸的不同设备工作，我该怎么做？我使用支柱/弹簧吗？

对于 5.0+，我是否使用多个情节提要和视图对象的硬编码位置？

对于 6.0+，我是否只使用一个带有自动布局的情节提要？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T22:40:49.477

如果您的目标是 4.3+，那么您应该使用 xib、弹簧和支柱来做所有事情。在 6.0 + 设备上尝试使用 5.0 的故事板和自动布局只会浪费您的大量时间。

但后来我考虑支持 4.3+，而不是让 iOS 5 成为你的最低限度浪费时间。

如果可以的话，您应该将 iOS 5 设为最低要求并使用情节提要。

# java - 无法在 azure 上的 hadoop 中设置映射器的数量

> ID：13078392
> 
> 赞同：0
> 
> 时间：2012-10-25T22:37:30.317
> 
> 标签：java, azure, hadoop

我正在使用 Microsoft 的 azure 上的 hadoop 来运行一些 mapreduce 作业。我已将 dfs.block.size 设置为 16777216（即 16MB）并将 mapred.max.split.size 设置为 16MB。我还通过访问每个任务跟踪器将每个任务跟踪器中的地图任务数设置为 16。（这是一个 3+1 节点集群）。我还尝试使用 -D 选项设置 mapred.map.tasks 属性。但是这些努力都没有成功地增加地图任务的数量，令人惊讶的是仍然是 1..

有什么建议吗？提前致谢..

编辑：输入大小很大（以 GB 为单位）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T08:28:41.687

检查，该文件未压缩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T15:55:25.390

也许你的设置不起作用。

您可以在作业配置页面上检查运行时作业配置，hadoop作业配置页面是`http://<host>:<port>/jobconf.jsp?jobid=<jobid>`.

# c - 这两个中断服务程序的竞争条件是什么？

> ID：13078394
> 
> 赞同：4
> 
> 时间：2012-10-25T22:37:52.663
> 
> 标签：c, multithreading, queue, arm, interrupt

我在大学的实时系统课程中使用 ARM 微控制器。在我目前正在进行的项目中，我正在实现矢量场直方图（VFH）算法。

问题是：我需要在线程之间进行通信；更具体地说，我希望有一个线程从测距仪获取传感器数据，对其进行必要的转换并将它们存放在队列中。他们，另一个线程必须获取这些数据并处理它，等等。

目前，我正在使用它的一个更简单的版本——一个线程从 ADC（SensorAcquisitionHandler）获取数据，另一个线程（最多）将前 5 个项目的平均值输出到显示器（ControlSignalHandler）。

```
/* Queue used to store data from the rangefinder sensors. */
static unsigned int Sensors[100];
static int SensorsHead = 0;
static int SensorsTail = 0;

void SensorAcquisitionHandler(void) {
    /* Clear the interrupt. */
    ADCIntClear(ADC0_BASE, 1);

    int i; /* Index for the measurements buffer. */

    /* There are only 3 rangefinders used. */
    if (ADCSequenceDataGet(ADC0_BASE, 1, rangeBuffer) == 3) {
        /* Put rangeBuffer's data into SensorDataQueue. */
        /* Also, when using SensorDataQueue, must put what's the direction of 
        the corresponding range measurement. */

        /* Critical section ahead!!! Turn off interrupts!!! */
        IntMasterDisable();

        /* Temporarily using the simple FIFO... */
        for (i = 0; i < 3; ++i) {
            if (SensorsHead < 100) {
                Sensors[SensorsHead] = rangeBuffer[i];
                SensorsHead++;
            }
        }

        /* All is fine, turn on interrupts. */
        IntMasterEnable();
    }
}

void ControlSignalHandler(void) {
    /* Clear the timer interrupt. */
    TimerIntClear(TIMER0_BASE, TIMER_TIMA_TIMEOUT);

    unsigned char i; /* Index for the measurements buffer. */
    unsigned long average = 0;
    char buffer[20];

    /* Average first n (n <= 5) elements from Sensors queue. */
    for (i = 0; i < 5 && SensorsTail < SensorsHead; ++i) {
        average += Sensors[SensorsTail];
        SensorsTail++;
    }

    IntMasterDisable();
    average /= i;

    sprintf(buffer, "%d  ", average);

    average = 0;

    if (SensorsTail >= SensorsHead) {
        SensorsTail = 0;
        SensorsHead = 0;
    }

    Display96x16x1StringDraw(buffer, 0, 0);
    IntMasterEnable();
} 
```

结果在一段时间内相对稳定，但在随机间隔内会变得非常高（结果几乎一直是 ~330）。此外，当我在“非常高的价值”时刻使用符号调试器时，索引 SensorTail 和 SensorHead 可以达到 300+（队列是一个 100 元素的数组）。

这听起来像是某种溢出，但我无法想象它是如何发生的。有人可以帮我找到吗？

我知道问题的答案是“使用线程安全队列”，但我想了解这里的竞争条件是如何发生的，索引是如何搞砸的，等等。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T23:16:46.883

通过清除中断，您允许它再次发生。想象一下，如果（例如）在`ControlSignalHandler`第一个循环的中间重新进入会发生什么，因为计时器设法超过了您的代码......

*将整个*函数（两者）包装在`IntMasterDisable`+`IntMasterEnable`中，并在禁用之后和启用之前清除中断。（我会在启用之前立即执行此操作。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T00:03:14.053

您可以通过使用无锁单读取器单写入器 FIFO 来避免头指针和尾指针的竞争条件 - 其中头指针仅写入一个线程（或在您的情况下为 ISR），而尾部写入另一个。这意味着您在每个 ISR 中执行缓冲区包装测试。

如果您这样做并在每个 ISR 结束时重置您的中断源，那么您根本不需要*任何锁定*- 全局禁用中断是非常不礼貌的。目前你持有的锁很长时间。

需要重写 FIFO 实现的另一个原因是：

```
 for (i = 0; i < 3; ++i) {
        if (SensorsHead < 100) { 
```

由于您一次添加 3 个读数，因此您最终将输入`SensorAcquisitionHandler()`-`SensorsHead==99`这保证您将丢弃 2 个读数。

相似地：

```
/* Average first n (n <= 5) elements from Sensors queue. */
for (i = 0; i < 5 && SensorsTail < SensorsHead; ++i) {
    average += Sensors[SensorsTail];
    SensorsTail++;
} 
```

在某些情况下，将对少于 5 个值执行计算。

根据您使用的 ARM 部分，没有硬件划分。计算一个二次幂的平均值要便宜得多，因为它是一个单周期逻辑移位。

最后，我想这`Display96x16x1StringDraw(buffer, 0, 0);`是一个特别昂贵的操作，它也可能是线程安全的。IO 在 ISR 中总是严格禁止的。您可能希望在计时器线程和处理输出的非中断上下文之间建立另一个队列。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T23:24:41.763

您使用的是什么特定的处理器/微控制器？什么 RTOS（如果有）？

ARM 微控制器上的中断堆栈通常非常非常小。像这样的运行时例程`snprintf()`很容易需要数百个字节，并且可能会溢出一个小堆栈。即使不考虑堆栈空间，C 运行时函数在中断上下文中使用通常也不安全——您通常*非常*受限于可以从中断调用哪些函数。具体细节取决于您使用的实际 RTOS 和编译器工具链。

如果您违反这些约束，则很容易导致数据损坏。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T23:02:41.273

查看程序集转储。非易失性代码可以相对于易失性代码重新排序。

想象一下你有：

```
assignmentA_with_volatile_operands;
assignmentB_with_non_volatile_operands;
assignmentC_with_volatile_operands; 
```

编译可以免费重新排序到：

```
assignmentA_with_volatile_operands;
assignmentC_with_volatile_operands;
assignmentB_with_non_volatile_operands; 
```

例如，您`for`在第一个处理程序中的循环`SensorAcquisitionHandler`实际上可以在之后执行，因为循环中`IntMasterEnable`出现的对象都没有被限定。`for``volatile`

**编辑：**

有些人认为这种代码重新排序是不允许的。事实是它们是，并且它们是用现实生活中的编译器执行的。

volatile 在程序中不充当内存屏障。您不应该假设易失性访问对非易失性访问起到了内存屏障的作用。

该标准在 C11 的 5.1.2.3 中定义了关于*程序的可观察行为，对**符合实现的最低要求是*什么。

 *`gcc`例如说：*对非易失性对象的访问相对于易失性访问没有排序。您不能使用易失性对象作为内存屏障来排序对非易失性内存的写入序列。*

[http://gcc.gnu.org/onlinedocs/gcc/Volatiles.html](http://gcc.gnu.org/onlinedocs/gcc/Volatiles.html)

许多编译器谨慎地不要在存在 volatile 的情况下执行此类代码重新排序优化，但我已经看到编译器（`gcc`例如）执行它们。*

# algorithm - 将玩家分配到牌桌

> ID：13078397
> 
> 赞同：4
> 
> 时间：2012-10-25T22:38:07.827
> 
> 标签：algorithm, math, random

考虑`N = 4k`玩家、`k`桌子和许多部落，这样每个成员都可以属于一个部落。一个氏族最多可以包含`k`玩家。

我们希望组织 3 轮游戏，这样，对于每张正好坐 4 名玩家的桌子，没有 2 名坐在那儿的玩家属于同一个部落，并且在后面的几轮中，没有 2 名坐在那儿的玩家坐在同一个位置表前。所有玩家都玩所有回合。

如果`N`可以`~80`很大，我们如何有效地做到这一点？

我想到了这个：

```
for each table T:
  repeat until 4 players have been seated at T:
    pick a random player X that is not currently seated anywhere
    if X has not sat at the same table as anyone currently at T AND
       X is not from the same clan as anyone currently at T
       seat X at T
       break 
```

我不确定这是否会一直完成，或者即使有有效的分配它也会卡住。即使这有效，还有更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T11:01:44.010

如果每个氏族总是正好有 k 个玩家（即 4 个氏族），那么您知道在一张桌子上应该始终有 1 个氏族的人。在这种情况下，我认为可以提出一些预定义的轮换方案，每个玩家，根据他来自的氏族，进一步移动固定数量的桌子。

如果氏族的数量可以超过4，我认为这是不可能的（或者我看不到，反正）

我觉得你的算法很不错。您可以防止它永远不会终止（如果没有有效的解决方案）同时仍然保持随机行为的一种方法是不要无限地选择随机玩家，而是将未坐下的玩家列表洗牌一次，并处理此列表中的每个玩家转动：

**编辑**：我忘了遍历轮次，也将其包含在算法中。

```
for each round R in {1, 2, 3}
  for each table T:
    UP = a randomly shuffled list of unseated players
    for each player X from UP
      if there are less than 4 people seated at T AND
         X has not previously sat with any of the players currently at T AND
         X is not from the same clan as anyone currently at T
           seat X at T

    //No more players left to try for this table
    if T has less than 4 people seated
      abort;  //No solution possible (at least, with the decisions taken so far)

  //All tables filled with players, prepare for the next round.
  for each table T:
    for each player X on T:
      Register on X that he has sat with each of the other 3 players at T
    Unseat all players at T 
```

这样，对于单轮，算法在每张桌子上最多尝试所有玩家一次，因此单次运行在终止之前最多尝试 3*T*N 次让玩家入座（有或没有解决方案）。换句话说，单次运行应该很快完成。

请注意，由于它仍然是随机的，因此多次运行相同的算法是完全可以接受的，因为它每次都会尝试不同的座位组合（使其成为所谓的拉斯维加斯算法）。

**编辑 2**：用 5 个氏族（每个氏族 16 名玩家）尝试并测试了此算法。通常，它需要大约 400 次运行才能找到第一个解决方案，但总运行时间仍然只有 1 秒左右。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T10:57:48.943

# 它卡住了

## 卡在座位上

> 我不确定这是否会一直完成，或者即使有有效的分配它也会卡住。

它可能会卡住。假设*k* = 4 张桌子，*N* = 16 名玩家，4 个部落，每个部落 4 人。让*A1*到*A4*成为氏族*A*中的玩家，其他氏族也是如此。然后以下是可能由您的算法引起的手工制作情况的示例：

```
Round 1:
 Table 1: A1, B1, C1, D1
 Table 2: A2, B2, C2, D2
 Table 3: A3, B3, C3, D3
 Table 4: A4, B4, C4, D4

Round 2:
 Table 1: A1, B2, C3, D4
 Table 2: A2, B3, C1 !!! 
```

## 卡在圆形水平？

一个有趣的问题仍然存在：如果所有三轮的有效分配都是可能的，你能否找到排除第三轮所有有效分配的两轮有效分配？如果是这种情况，您可能会卡在回合级别，因此在执行一些回溯算法时，您有时可能必须撤消完整的回合才能获得有效的解决方案。我没有发生这种情况的例子，也没有强烈的直觉。

# 更好的方法

> 有没有更好的方法来做到这一点

我想只要付出足够的努力，就可以将其压缩到一些标准图算法的框架中。最有可能的是，该图形问题将是 NP 难题，因此也不会有多项式时间算法可用于此。

Donald Knuth 写了一篇关于[跳舞链接](http://arxiv.org/abs/cs/0011047)及其在解决[精确封面问题](http://en.wikipedia.org/wiki/Exact_cover)中的应用的好论文。在最坏的情况下，它仍然使用回溯和指数时间，但是对于完成大部分工作的搜索树的那些部分，它会保持较小的数据结构，从而加快搜索速度。也许其中一些想法也可以应用于您的情况。不过，只是猜测，还没有考虑到特定的实现。

另一个想法：也许您可以采用*增加路径的概念，*因为它在计算匹配时使用。这个想法是这样的：如果没有空位的人，从其他玩家中选择一个任意的人。如果该人与当前表兼容，请将其移至该表。这样一来，另一张桌子就会少一个玩家，而您可以尝试使用一些未就座的玩家来填补这个空白。如果这不起作用，您将再次重新安排现有玩家。您可能不应该立即开始移动玩家。相反，您应该首先尝试找到一条完整的增强路径，从一个空座位开始，到一个没有座位的人结束。只有在你验证了这样的链条存在之后，你才能开始根据它来移动人们。

# ruby-on-rails - 设计 Ruby On Rails 管理员以注销用户

> ID：13078400
> 
> 赞同：0
> 
> 时间：2012-10-25T22:38:40.797
> 
> 标签：ruby-on-rails, devise

我正在尝试从管理员帐户禁用设计用户。我希望他们当前的会话被终止，并且他们的帐户被标记为禁用。

我想出了如何禁用他们的帐户，以便他们无法再次登录，但我不知道如何从设计控制器（AdminController

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T10:01:45.800

我们在 Devise wiki 上有关于如何做到这一点的说明：

[https://github.com/plataformatec/devise/wiki/How-To:-Require-admin-to-activate-account-before-sign_in](https://github.com/plataformatec/devise/wiki/How-To:-Require-admin-to-activate-account-before-sign_in)

基本上，在您的数据库上创建一个新列，它可以称为`enabled`or `approved`，默认情况下为 true。然后像 wiki 中那样自定义`active_for_authentication?`and 。`inactive_message`

`active_for_authentication?`在每个请求之前都会询问该检查，因此您将在用户的下一个请求中有效地禁用用户访问。如果您有 ajax 和 javascript，请记住正确处理 401 请求。

# c++ - Sqlite 不再打开 Google Drive 数据库

> ID：13078404
> 
> 赞同：2
> 
> 时间：2012-10-25T22:39:17.423
> 
> 标签：c++, sqlite

Google Drive 文件夹的路径可以在文件中找到，该文件**`...\AppData\Local\Google\Drive\sync_config.db`**是一个 SQLITE3 数据库。我的 Windows C++ 程序曾经成功地获取此数据，但最近它停止工作，无论是在我的 PC 上还是对于我听说过的客户。数据库必须仍然有效，因为我可以使用**`sqlite3`**命令行实用程序打开数据库并使用我尝试以编程方式使用的确切查询成功查询它。

如下所示的代码中发生的事情是它永远不会过去`**sqlite3_prepare_v2**`，它会返回错误代码**`26`**。此代码通常表明该文件不是有效的数据库。那么为什么命令行实用程序有效呢？

有什么想法可能会突然破坏这段代码吗？

```
extern CString GoogleDrivePath()
{
  CString sPath = "";
  CString sDbPath;
  char acValue[1024];
  DWORD lSize = sizeof(acValue);
  struct _stat fstat;
  sqlite3 *pDb;
  sqlite3_stmt *pStmt;
  int iSts;
  char acSelect[] = "SELECT data_value FROM data WHERE entry_key = 'local_sync_root_path';";
  const unsigned char *pPath;

  DWORD lLen = GetEnvironmentVariable("LOCALAPPDATA", acValue, lSize);
  if (lSize <= 0) return(sPath);

  sDbPath = acValue;
  sDbPath += "\\Google\\Drive\\sync_config.db";
  if (_stat(sDbPath, &fstat) < 0) return(sPath);

  iSts = sqlite3_open_v2(sDbPath, &pDb, SQLITE_OPEN_READONLY, NULL);
  if (iSts) return(sPath);
  iSts = sqlite3_prepare_v2(pDb, acSelect, -1, &pStmt, NULL);
  if (!iSts)  {
    iSts = sqlite3_step(pStmt);
    if (iSts == SQLITE_ROW) {
      pPath = sqlite3_column_text(pStmt, 0);
      if (pPath != NULL)  {
        sPath = pPath;
      }
    }
    sqlite3_finalize(pStmt);
  }

  sqlite3_close(pDb);
  return(sPath);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:04:04.467

我找到了解决办法。我的产品是用 V3.6 构建的并且停止工作；起作用的命令行实用程序实际上是 V3.7。所以我用 sqlite3.c V3.7.14.1 重建了程序，它现在可以工作了！

显然，谷歌使用了更新版本的 SQLite，它以某种方式使数据库不向后兼容。

（由于我的程序还创建了一个 SQLite 数据库，然后在 Android 设备上使用，我有点担心更新我的版本，但它似乎工作正常。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T07:04:06.780

命令行实用程序不会尝试以只读模式打开数据库。试试`SQLITE_OPEN_READWRITE`。

只读模式可能失败的原因有两个：数据库有热日志并且需要恢复，或者您启用了 WAL。

# mysql - 每天从 MySQL 提取数据到本地 MySQL 数据库

> ID：13078406
> 
> 赞同：1
> 
> 时间：2012-10-25T22:39:19.747
> 
> 标签：mysql

我正在本地做一些实验，这些实验需要来自生产 MySQL 数据库的一些数据，而我只有读取权限。除了省略一列之外，这些模式几乎相同。我的目标是编写一个我可以每天运行的脚本，提取前一天的数据并将其导入我的本地表中。

我最困惑的部分是如何下载数据。我见过像`mysqldump`被折腾的名字，但这似乎是复制整个数据库的一种方式。我很想避免使用 php，因为我没有使用它的经验。我一直在创建 CSV，但我担心数据完整性（如果字段中有逗号或 \n 怎么办）以及 CSV 的大小（每天有几十万行）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T22:48:07.567

没有办法比 mysqdump 更快，如果你有数十万行最好和简单的解决方案，mysqldump 不仅可以导出整个数据库，还可以只导出你想要的表。

[http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html)

```
mysqldump.exe -u root -p DATABASENAME TABLE1 TABLE2 > exported_tables.sql 
```

这将导出`table1`和`table2`从`databasename`.

您还可以使用 where 参数来过滤结果：

```
 --where='where_condition', -w 'where_condition'

Dump only rows selected by the given WHERE condition. Quotes around the condition are mandatory if it contains spaces or other characters that are special to your command interpreter.

Examples:

--where="user='jimf'"
-w"userid>1"
-w"userid<1" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:46:31.420

您需要在两个数据库之间建立某种形式的 dblink。请参阅此讨论并根据您的生产数据库是在本地访问还是从远程计算机访问合适的答案：

[Oracle Database Link - MySQL 等价物？](https://stackoverflow.com/questions/1565993/oracle-database-link-mysql-equivalent)

我的理解是您必须从单独的服务器访问生产服务器，`MySQL`而且您不想要精确的副本，您需要编写自定义查询。如果是这样，使用`FEDERATED MySQL storage engine`可能是您可能拥有的最佳选择。*使用`FEDERATED`表时，本地服务器上的查询会自动在远程（联合）表上执行。本地表上不存储任何数据。* [在这里](http://dev.mysql.com/doc/refman/5.0/en/federated-storage-engine.html)。

# algorithm - 算法优化：通过计算或查找表求对数

> ID：13078407
> 
> 赞同：4
> 
> 时间：2012-10-25T22:39:23.440
> 
> 标签：algorithm, optimization, lookup-tables, logarithm

我正在尝试优化一个音频算法，它必须在每一步中计算如下两种算法。现在我读到，没有在多项式时间内运行的对数算法。我的问题是，如果通过查找表来计算所有对数是否有意义，因为它们总是相同的，尽管有大量内存访问的缺点？

```
for(int f=1;f<11000;f++){
    for(int fk=1;fk<1000;fk++){
        int k = ceil(12 * log2f((f - 0.5) / fk));
    }
} 
```

我正在用 C++ 编程。

非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T23:42:54.030

如果你真正需要的是

```
ceil(12 * log2(/* something */)) 
```

然后有一个非常简单的 O(1) 计算将起作用，使用一个只有 12 个值的表。

1.  使用 frexp() 将值拆分为指数和尾数。（这只是位操作，所以只需要几个周期。）

2.  在预先计算的 2.0 的 12 次方（除以 2）的幂的列表中查找尾数，您最多可以进行四次比较。

3.  结果是 12*(exponent - 1) + 最小根的索引 >= 尾数。

编辑添加：

实际上有一个更好的解决方案，因为 2 的 12 次方的幂被合理地平均分布。如果将 [0.5, 1.0)（由 frexp 返回的尾数范围）划分为 17 个均匀分布的子范围，则每个子范围将落入两个可能的返回值之一。因此，如果您将每个子范围与根向量的索引相关联，则只需将目标（在该范围内）与单个根进行比较。

我写连贯的英语为时已晚，所以你必须满足于代码：

```
int Ceil12TimesLog2(double x) {
  int exp;
  double mantissa = std::frexp(x, &exp) * 2;
  int idx = indexes[int((mantissa - 1.0) * 17)];
  return 12 * (exp - 1) + (mantissa <= roots[idx] ? idx : idx + 1);
}

// Here are the reference tables.

double roots[12] = {
  0x1.0000000000000p+0,
  0x1.0f38f92d97963p+0,
  0x1.1f59ac3c7d6c0p+0,
  0x1.306fe0a31b715p+0,
  0x1.428a2f98d728bp+0,
  0x1.55b8108f0ec5ep+0,
  0x1.6a09e667f3bccp+0,
  0x1.7f910d768cfb0p+0,
  0x1.965fea53d6e3dp+0,
  0x1.ae89f995ad3adp+0,
  0x1.c823e074ec129p+0,
  0x1.e3437e7101344p+0
};
int indexes[17] = { 0, 1, 2, 3, 4, 5, 5, 6, 7, 8, 8, 9, 9, 10, 10, 11, 11 }; 
```

我试过这个，它使用 OP 中的循环将总计算时间从大约 0.5 秒（对于 log2f）减少到大约 0.15 秒。参考表的总大小为 164 字节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T23:36:15.553

为简洁明了而写 z 而不是 fk，你的内循环计算`ceil(12 * log2f((f - 0.5) / z))`. 现在`12 * log2f((f - 0.5) / z)`= `12*log2f(f - 0.5) - 12*log2f(z)`。事先，计算一个包含 999 个条目的数组，允许您只用 11998 个对数计算来计算所有值，而不是其中的 10988001 个：

```
for (int z=1; z<1000; ++z)
  z12[z] = 12 * log2f(z);

for (int f=1; f<11000; ++f) {
  w = 12 * log2f(f - 0.5);
  for (int z=1; z<1000; ++z) {
    int k = ceil(w - z12[z]);
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T23:16:57.390

我发现：

*   虽然你有 11Kx1K = 11M 的组合`(f, fk)`，
*   k 的不同值的数量只有 294。（你只需要 9 位来表示它）。

所以绝对可以构造一个二维数组来存储映射并将其加载到内存中。看起来像

```
LOOKUP[f][fk] = v, f in 1..11000, fk in 1..1000 
--------------------
v1,1 v1,2 v1,3 ... v1,1000
v2,1 v2,2 v2,3 ... v2,1000
...    ...    ...  ...
v11000,1 , ...     v11000,1000 
```

由于每个`v`是两个字节，因此您只需要 11Kx1Kx2B = 22MB 内存即可加载此表。没什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T07:21:39.147

如果循环顺序相反，则 k 的重复值的数量会更高。在该集合中只有 12977 个案例，其中 k 有“一个”；最长的一次是618。

这表明反向方法可以最大限度地减少 log2f 调用的次数——必须计算索引*n*，其中 k(z,f+n) != k(z,f) （并循环 n 个实例......）

无论如何，在最终产品中，我怀疑巨大 LUT 的好处。即使是使用 11000 + 1000 大小的表的方法对我来说似乎也不是最理想的。相反，我猜只有 11000 + 1000 个整数存在一个线性或最大 2 次分段多项式逼近 log2，它由 8 到 16 个部分组成。

如果找到了这种方法，那么多项式系数将适合 NEON 或 XXM 寄存器，并允许在没有内存访问的情况下并行实现。

# c++ - 将结构成员写入二进制文件并使用 fstream 和 C++ 读取它们

> ID：13078410
> 
> 赞同：0
> 
> 时间：2012-10-25T22:39:51.770
> 
> 标签：c++, binaryfiles, fstream

对 C++ 世界来说仍然是新手，下面的问题是因为家庭作业！通过以前回答的问题或谷歌搜索，我没有找到太多帮助，并不意味着我没有错过它。

作业的目标： 1.) 获取用户输入信息并将其存储在二进制文件中。2.) 稍后再读回该数据。

我有一个最多 10 个结构的数组，该结构接受用户名的 char 数组、用户电话号码的 char 数组和浮动工资。当我输入一些测试用例时，文件写入，我假设正确。当我去读取值时，第一个名字和第一个电话号码一样打印得很好。无论我在测试用例中输入了什么值，浮点数都会给我 -4013602080。从那里开始走下坡路。我正在尝试使用 . **我的问题归结为两部分，我是否“正确”地将结构成员写入文件，以及如何从二进制文件中读取浮点数？（或者使用 fopen 和 fclose 是否有利？）**提示或引用会很棒。

标题

```
//my header
#ifndef USERS_H
#define USERS_H

#include <iostream>
#include <cstring>
#include <cstdlib>
#include <limits>
#include <iomanip>

const int arsize=20;
using namespace std;
struct emp
{
    char name[arsize];
    char phone[arsize];
    float salary;
};
class Users
{
private:
    //const int arsize=20;
    int choice, num_of_names;
public:
    Users();
    void menu();
    void enter(emp*pt, int n);
    void print_all(emp*pt);
    void print_condition(emp*pt);
    void end_phone_array(emp*pt);
    void bubble_sort(emp*pt);
    void selection_sort(emp*pt);
    void raise(emp*pt);
            void file_store(emp*pt);
    void file_read(emp*pt);

};
#endif USERS_H_ 
```

这是我相信的源文件中的必要部分：

```
void Users::enter(emp*pt, int n)
{
    extern int gl,count,f;
    if(gl+n>10)
    {
        cout<<"Memory Full!\n";
    }
    else
    {
        for (int i=count;i<f+n;i++)
        {
            gl++;
            cout<<"Enter user #"<<i+1<< " name(no more than 20 characters)\n";
            cin.get();
            cin.getline(pt[i].name, arsize);//.get();
            cout<<"Enter user #"<<i+1<< " phone #\n";
            cin.getline(pt[i].phone, arsize);//.get();
            cout<<"Enter user #"<<i+1<< " salary\n";
            (cin>>pt[i].salary);//.get();
        }
        count=gl;
        f=gl;
    }
}
void Users::file_store(emp* pt)
{
    //ifstream::pos_type size;
    extern int gl;
    //float test;
    //ofstream Testfile ("C:\\Users\\Ian\\Desktop\\Programming\\C++\\data.bin", ios::out| ios::binary);  //for personal computer use
    ofstream Testfile ("data.bin", ios::out | ios::binary);
    for (int i=0; i<gl;i++)
    {
        Testfile.write((char*)&pt[i].name, sizeof(pt));
        Testfile.write(pt[i].phone, sizeof(pt[i].phone));
        Testfile.write((char *)&pt[i].salary, sizeof(pt[i].salary));
    }
}
void Users::file_read(emp*pt)
{
    //extern int gl;
    struct TEST
    {
        char n_array[20];
        char p_array[13];
        float salary;
    };
    TEST test[20];
    for (int i=0;i<20;i++)
    {
        test[i].n_array[0]='\0';
        test[i].p_array[0]='\0';
        test[i].salary=0.0;
    }
    /*ifstream::pos_type size;
     * char *memblocktest;*/
    ifstream test_in ("data.bin", ios::in | ios::binary);
    for(int i=0;i<10;i++)
    {
        if(test_in.is_open())for(int i=0;i<10;i++)
        {
            test_in.read((char*)&test, sizeof(test));
            cout<<test[i].n_array<<"\n";
            cout<<test[i].p_array<<endl;
            cout<<"$"<<test[i].salary<<endl;
        }
        else
            cout<<"Don't know what I am doing!\n";
    }

} 
```

这是主文件

```
#include "stdafx.h"
#include "users.h"
#include <iostream>
#include <cctype>
#include <limits>
#include <iomanip>
#include <cstring>
using namespace std;

extern int gl=0, count =0, f=0;
int main()
{
    Users Test;
    std::cout.setf(std::ios::fixed);
    std::cout.precision(2);
    emp*test=new emp[10];
    Test.menu();
    int choice, num_of_names;
    while(1)
    {
        if(!(cin>>choice))
        {
            cin.clear();
            cin.ignore(numeric_limits<streamsize>::max(),'\n');
            cout<<"ERROR!\n";
        }
        else
            break;
    }
    while(choice!=9)
    {
        switch(choice)
        {
            case 1:{cout<<"How many users will you enter?\n";
                    cin>>num_of_names;
                    Test.enter(test, num_of_names);
                    Test.end_phone_array(test);
                    break;}
            case 2:{Test.print_all(test);
                    break;}
            case 3:{Test.print_condition(test);
                    break;}
            case 4:{Test.bubble_sort(test);
                    break;}
            case 5:{Test.selection_sort(test);
                    break;}
            case 6:{Test.raise(test);
                break;}
            case 7:{Test.file_store(test);
                    break;}
            case 8:{Test.file_read(test);
                break;}
            default:{"Bad Choice..........\n";
                     break;}
        }
        Test.menu();
        while(1)
        {
            if(!(cin>>choice))
            {
                cin.clear();
                cin.ignore(numeric_limits<streamsize>::max(),'\n');
                cout<<"ERROR!\n";
            }
            else
                break;
        }
    }
    delete [] test;
    //system("Pause");
    return 0;
} 
```

我想我可以改进很多东西，但现在我想弄清楚二进制部分。非常感谢任何提示。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T22:54:48.553

这看起来不对：

```
void Users::file_store(emp* pt)
{
    // etc...

        Testfile.write((char*)&pt[i].name, sizeof(pt));
        Testfile.write(pt[i].phone, sizeof(pt[i].phone));
        Testfile.write((char *)&pt[i].salary, sizeof(pt[i].salary)); 
```

在第一行中，您存储了一个名称字段，但您使用`sizeof(pt)`的是大小，其中大小实际上是指针值的大小。您还将获取名称数组 (a `char**`) 的地址并将其转换为`char*`

修理：

```
Testfile.write(pt[i].name, sizeof(pt[i].name));
Testfile.write(pt[i].phone, sizeof(pt[i].phone));
Testfile.write((char *)&pt[i].salary, sizeof(pt[i].salary)); 
```

实际上，您可能不需要单独处理这些字段（除非您尝试遵循与结构不同的顺序），因为结构没有任何动态数据。您可以一次存储整个记录：

```
Testfile.write((char*)&pt[i], sizeof(struct emp)); 
```

更好的是，您可以一次性存储整个数组并避免循环：

```
Testfile.write((char*)pt, gl * sizeof(struct emp)); 
```

类似地读取......请注意，您可能也希望将 的值存储`gl`在文件中，这样您就知道它包含多少条记录。或者，如果您想稍微神秘一点，您可以检查文件大小并`sizeof(struct emp)`对其进行划分以推断记录数。

# linker - 动态链接的静默重复符号错误

> ID：13078411
> 
> 赞同：3
> 
> 时间：2012-10-25T22:39:53.530
> 
> 标签：linker, shared-libraries

我有以下 C 文件：

基数.h：

```
void g();
void h(); 
```

Base.c：

```
#include <stdio.h>
#include <Base.h>

void g() {
  printf("This is lib g\n");
  h();
}

void h() {
  printf("This is lib h\n");
} 
```

交流：

```
#include <stdio.h>
#include <Base.h>

void h() {
  printf("This is A h\n");
}

void main() {
  g();
  h();
} 
```

我编译和链接如下：

```
$ gcc -c -fPIC -o Base.o -I. Base.c
$ gcc -shared -o libBase.so Base.o
$ gcc -c -o A.o A.c
$ gcc -o A A.o -lBase -L. 
```

现在我运行程序

```
$ LD_LIBRARY_PATH=. ./A 
```

并获得：

```
This is lib g
This is A h
This is A h 
```

这意味着，在 libBase 中对 h 的调用是由 Ao 的 h 解决的，这不是我所期望的。我要么期望动态链接器使用 libBase 中的 h 解析对 libBase 中的 h 的调用，要么期望在第四个 gcc 调用中出现错误消息。

如果我将 Ac 中的 h 重命名为 h1

```
#include <stdio.h>
#include <Base.h>

void h1() {
  printf("This is A h1\n");
}

void main() {
  g();
  h1();
} 
```

我得到

```
This is lib g
This is lib h
This is A h1 
```

因此，在这种情况下， h 按我的预期解决。

我该怎么做才能获得错误消息或将 g 中的调用解析为 libBase 中的 h？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T02:09:36.180

> 这不是我所期望的。

你的期望是错误的。这是大多数 UNIX 系统上的共享库的工作方式：加载器只是沿着已加载库的列表向下移动，并尝试找到给定的符号。第一个定义符号“wins”的库。

这种行为有很多优点。一个例子：你可以`LD_PRELOAD` `libtcmalloc.so`，突然所有的`malloc`和`free`调用都解决了`tcmalloc`。

`-Bsymbolic`在 ELF 系统上，您可以使用链接器标志修改此行为（`-Wl,-Bsymbolic`通过 GCC 传递它时使用）。当心：`-Bsymbolic`“违背系统”，你可能会因此得到许多意想不到的和不受欢迎的副作用。

另请参阅[此](https://stackoverflow.com/a/1056738/50617)答案。

# ios - iOS - 将累积的数据传递到长长的 UIViewController 链中

> ID：13078413
> 
> 赞同：1
> 
> 时间：2012-10-25T22:40:23.780
> 
> 标签：ios, uiviewcontroller, singleton

我正在编写一个带有几个（可能是 8 个）调查式模块的 iOS 应用程序，用户将在其中回答一系列问题（关于家庭生活、健康等）。有些模块有多达 12 个问题。每个问题都有自己的 nib 和自己的 UIViewController。理想情况下，答案将在模块结束时写入数据库。每个模块对应一个表中的一条记录。永远只有一个用户，因此只有一个记录。我想将核心数据堆栈留在应用程序委托中。我目前正在从视图控制器创建核心数据对象。

**我一直在努力寻找：**

1.  将累积数据传递到 UIViewController 的长线性链的最佳方式。
2.  另一种解决方案。

**我知道以下可能性：**

*   通过视图控制器的重载初始化程序将数据数据沿链传递，使用在每次传递时添加的集合
*   再次使用集合将数据传递给子视图控制器中的属性
*   在应用程序委托中使用全局变量（我不认真考虑这是一个选项）
*   使用单例类

我*认为*在这种情况下，单例被认为是最好的选择，至少在设计方面，但我的研究到目前为止，我还没有听说有人使用这么多（8 个，也许更多）单例。他们引起如此多争论的事实使我感到困惑。而且我有时会看到多线程与单例一起讨论，但我不明白为什么它们会齐头并进（如果他们甚至这样做的话）以及我将如何处理它。最后，如果我要使用单例，我会从单例还是从视图控制器调用核心堆栈？

**编辑：**如果我使用单例，另一个问题是 - 我如何处理我的核心数据实体类？我可以或应该使用单例类来替换它们吗？

将不胜感激对上述和/或解决方案的替代建议的回答。如果可能的话，我想在好的设计和简单/快速的实现之间找到一个折衷方案。更改应用程序设计不是一种选择（客户正在确定布局和流程）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:43:09.477

作为一名从事过大量 iOS 项目的工程师，我已经尝试了您刚才提到的所有方法。到目前为止，最干净和最可维护的解决方案是使用单例。

为什么？从重构的角度考虑您的代码。您有一个过程（将类型为 answer 的对象推送到 Core Data 堆栈），您在不同的视图控制器中重复了很多次。如果您不喜欢答案处理代码中执行某些操作的方式，则需要更改该代码的相关部分，因为它已在您的应用程序中出现。逐个视图控制器进行适当的更改比在一个地方进行更改要乏味得多。这似乎很明显，但在设计任何应用程序时，这是一个深刻的事实。

让我们考虑在视图控制器链中传递一个累积对象。无论是通过属性还是通过为视图控制器子类创建新的指定初始化程序来执行此操作，您都需要编写样板代码以将对象从一个视图控制器传递到下一个视图控制器。鉴于您对每个问题如何拥有自己的 UIViewController 子类的描述，这意味着您将在每一步都受类型安全的支配，只是为了移动数据。如果您明天决定要更改要传递的数据类型怎么办？即使您有一个特殊的 UIViewController 子类来集中所有其他控制器继承的样板代码，您仍然会遇到相同的问题，即在代码中散布随机分配只是为了将数据保留在那里。和你'

现在考虑一个单例。单例非常棒，因为它可以拥有和管理最好的单一数据集，而且可以让应用程序的任何部分都可以访问它。想想你会想到 UIDevice 的单例。你只会处理一个 UIDevice —— 类似地，你只会处理一个核心数据堆栈或一组数据。为什么不认识到这一点并尝试从那里分解您的代码？

不幸的是，Apple 在 Storyboards 中的示例让人认为依赖注入是您将数据从一个视图控制器传递到下一个视图控制器的唯一方法。与其尝试去思考其他工程师对某些实践的看法，不如尝试确定您自己使用的每种方法的优缺点。如果你不完全理解它们，试一试，看看结果如何。其中很多都是反复试验，建筑设计也不例外。

**编辑**正如 Inafziger 所说，在多个线程上存储（在某些情况下读取）数据时，单例是棘手的。如果您正在从多个线程写入单例，请构建您想要的任何类型和大小的调度队列并在单独的线程上运行它（或将其添加到主线程上的运行循环）。如果您不处理多个线程，那么单例非常棒:)

顺便说一句，在 Objective C 中创建单例的最佳实践可以在[这里](http://www.galloway.me.uk/tutorials/singleton-classes/)找到。

# shell - 在 Amazon EC2 中启动实例时传递脚本

> ID：13078414
> 
> 赞同：2
> 
> 时间：2012-10-25T22:40:31.297
> 
> 标签：shell, amazon-ec2, amazon-web-services, cloud

启动实例时是否可以传递脚本？这样实例将在初始化后执行该脚本？

```
public static void startInstance(final String instanceId) {
    StartInstancesRequest startRequest = new StartInstancesRequest().withInstanceIds(instanceId);
    logger.info(String.format("Starting instance '%s':...", instanceId));
    ec2.startInstances(startRequest);       
} 
```

任何想法？脚本将是一种启动脚本，我需要在实例准备好后立即执行它。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T00:15:48.230

我在 2009 年的社区 Ubuntu AMI 中引入了*用户数据脚本*的概念（来自 RightScale 的一些想法的简化版）：

> [http://alestic.com/2009/06/ec2-user-data-scripts](http://alestic.com/2009/06/ec2-user-data-scripts)

它归结为：

> **如果实例 user-data 以这两个字符开头，`#!`则实例在第一次启动时以 root 用户身份运行它。**

此功能后来包含在 CloudInit 包中的官方 Ubuntu AMI 中：

> [https://help.ubuntu.com/community/CloudInit](https://help.ubuntu.com/community/CloudInit)

Amazon 现在在自己的 Amazon Linux AMI 中包含 CloudInit 包：

> [http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/AmazonLinuxAMIBasics.html](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/AmazonLinuxAMIBasics.html)

欢迎其他发行版（并且可能已经）在其 AMI 中包含此功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:58:02.747

您可以使用 Userdata 将脚本传递给新的 EC2 实例，尽管我不知道您是否可以启动预先存在的实例并将数据传递给它。

我有一个预配置的 AMI，它在根驱动器上保存了一个脚本，这个脚本用于配置服务器并下载最新的源代码。

因此，您的请求可能如下所示：

var runInstance = new RunInstancesRequest();

```
 runInstance.WithImageId("{ami-id}")
            .WithInstanceType("{size}")
            .WithMaxCount(1)
            .WithMinCount(1)
            .WithSecurityGroup("{the security group}")
            .WithKeyName("{your key}")
            .WithUserData(Convert.ToBase64String(Encoding.ASCII.GetBytes(userData)));

        ec2.RunInstances(runInstance); 
```

用户数据可以包含对脚本的引用或脚本本身。

# r - 在 R 中加速 read.table？

> ID：13078416
> 
> 赞同：1
> 
> 时间：2012-10-25T22:40:33.703
> 
> 标签：r

> **可能重复：**
> [在 R 中快速读取非常大的表作为数据框](https://stackoverflow.com/questions/1727772/quickly-reading-very-large-tables-as-dataframes-in-r)

我需要从一个大（超过 50MB）的文本文件中重复读取不同的数据部分。目前，我的代码正在运行，但完成 1 次迭代需要 30 秒。任何人都可以帮助我提高代码的效率吗？

我的代码：

```
Skip_s=c(88334, 92244, 92635, 96154, 96545, 100455, 100846, 104365, 104756, 
         112967, 123524, 134081, 145929, 156877, 170171, 183856, 194804, 206143,
         217482, 230385, 245243, 255800)   #starting number of rows

nrows_s=c(380) #the length of code I will read
for (k in 1:length(Skip_s)){
    bb = read.table("file",skip=Skip_s[k]-1, nrows=nrows_s, colClasses = c("character",rep("numeric",6)))
    #I use read.table is because it can break the loaded information into columns
    TOT_s[k,1,Ite] = mean(bb$V4[1:105])  
    TOT_s[]..... #I have 20 this statements 
} 
```

上述代码的完整版本需要 30 秒。大部分时间都花在`read.table`. 我在想有没有办法优化它？

这是 read.table 函数读取数据的示例

```
 CNC HORIZON     COMPARTMENT      TOTAL      ADSORBED   DISSOLVED  GAS CONC.
 CNC                              (MG/KG)    (MG/KG)    (MG/L)     (MG/L)
 CNC --------------------------------------------------------------------------
 CNC
 CNC
 CNC   1            1             0.4062     0.3737      1.210     0.2419E-05
 CNC   1            2             0.4942     0.4547      1.472     0.2943E-05
 CNC   1            3             0.4930     0.4536      1.468     0.2936E-05
 CNC   1            4             0.4812     0.4427      1.433     0.2865E-05
 CNC   1            5             0.4682     0.4307      1.394     0.2788E-05
 CNC   1            6             0.4550     0.4186      1.355     0.2710E-05
 CNC   1            7             0.4418     0.4065      1.315     0.2631E-05
 CNC   1            8             0.4286     0.3944      1.276     0.2552E-05
 CNC   1            9             0.4154     0.3822      1.237     0.2474E-05
 CNC   1           10             0.4022     0.3701      1.198     0.2395E-05 
```

# objective-c - 从我的应用程序访问文档/收件箱中 IOS 上的文件

> ID：13078417
> 
> 赞同：0
> 
> 时间：2012-10-25T22:40:40.647
> 
> 标签：objective-c, ios, xcode, nsfilemanager, documents

我整晚都在这，它让我发疯，我有一个应用程序，它由来自 Safari 的 openURL 调用调用。Safari 向我发送 fileURL 并将文件复制到 Documents/Inbox，然后我想将该文件的内容读入字符串。然而，在尝试了多种定位/访问文件的方法之后......我的应用程序仍然说该文件不存在。

所以我像这样从 Safari 收到了 fileURL ..

```
file://localhost/Users/plasma/Library/Application%20Support/iPhone%20Simulator/6.0/Applications/EE3A1801-98CF-4C7A-8ED1-639A81316B1C/Documents/Inbox/HereIsYourFile.txt 
```

如果我在终端中浏览到此路径，我可以确认该路径是该位置并且文件存在。

> ```
> macbook:Inbox plasma$ pwd
> 
> /Users/plasma/Library/Application Support/iPhone Simulator/6.0/Applications/EE3A1801-98CF-4C7A-8ED1-639A81316B1C/Documents/Inbox
> 
> macbook:Inbox plasma$ ls
> HereIsYourFile.txt 
> ```

我将此路径放在一个名为 receivedURL 的字符串中，但尝试读取该文件只会给出一个空字符串和错误 260。

```
NSString *myFileContents = [NSString stringWithContentsOfFile:receivedURL
                                             encoding:NSUTF8StringEncoding
                                             error:&error]; 
```

这推断该文件不存在，所以我尝试证明它存在于我的应用程序中......

```
 NSFileManager *filemgr;
        filemgr = [NSFileManager defaultManager];

        if ([filemgr fileExistsAtPath:receivedURL ] == YES) {
            NSLog (@"File exists");
        } else {
            NSLog (@"File not found");
        } 
```

它说它不存在！！！！我可以看到它..它在那里，为什么我的应用程序不能。我在文档页面上阅读了[此](http://developer.apple.com/library/mac/#documentation/FileManagement/Conceptual/FileSystemProgrammingGUide/FileSystemOverview/FileSystemOverview.html)位置的文件应该对应用程序可见和可读。

任何有关访问此文件的帮助将不胜感激。

提前致谢

等离子体

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T22:51:07.620

当应用程序启动时，您如何`receivedURL`根据`NSURL`给定的内容进行创建？你应该这样做：

```
NSString *receivedURL = [url path]; 
```

确保开头`receivedURL`没有**file:// 。**

另一种选择是使用`NSURL`从文件中加载字符串：

```
NSString *myFileContents = [NSString stringWithContentsOfURL:url
                                         encoding:NSUTF8StringEncoding
                                         error:&error]; 
```

而不是将 URL 转换为文件路径。

# asp.net - 如何在 ms 图表中设置渐变停止点？

> ID：13078424
> 
> 赞同：1
> 
> 时间：2012-10-25T22:41:15.420
> 
> 标签：asp.net, vb.net, charts, mschart

有没有办法在 mschart 中设置渐变停止点？我可以为每列设置一种颜色，但未能成功为一列设置多种颜色，请指教，非常感谢。

这就是我想要实现的目标：

![在此处输入图像描述](../Images/d48d31147b1fc8809db9d24b4d13d287.png)

这是我的代码：

```
'set color variation on chart 1
Private Sub chart_ssi_rzli_1_Customize(ByVal sender As Object, ByVal e As System.EventArgs) Handles chart_ssi_rzli_1.Customize
    chart_ssi_rzli_1.Series(0).SmartLabelStyle.Enabled = True

    'set max and min y axis according to the current goal ranges.
    chart_ssi_rzli_1.ChartAreas(0).AxisY.Minimum = Session("rzli_red") - 6
    chart_ssi_rzli_1.ChartAreas(0).AxisY.Maximum = Session("rzli_blue") + 4

    For Each dp As DataPoint In chart_ssi_rzli_1.Series(0).Points

        If dp.YValues(0) >= Session("rzli_blue") Then
            dp.Color = Drawing.Color.LightSkyBlue
        ElseIf dp.YValues(0) >= Session("rzli_green") And dp.YValues(0) < Session("rzli_blue") Then
            dp.Color = Drawing.Color.LightGreen
        ElseIf dp.YValues(0) >= Session("rzli_yellow") And dp.YValues(0) < Session("rzli_green") Then
            dp.Color = Drawing.Color.Yellow
        ElseIf dp.YValues(0) <= Session("rzli_red") Then
            dp.Color = Drawing.Color.FromArgb(245, 56, 61)
        End If
    Next

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T10:50:51.820

渐变支持仅限于 2 种颜色，因此没有直接的方法可以通过单个系列来实现这一点。但是，您可以通过在每个堆叠系列上使用`StackedColumn`and来伪造这种效果。`GradientStyle.TopBottom`这涉及将您的数据系列分成几个，可能不值得付出努力。您还需要从图例中隐藏附加系列。

![用堆叠列伪造的多梯度](../Images/d0df119c203c0790408b5963fa584d83.png)

配置图表的代码：

```
// Chart settings inside Form4.Designer.cs
chartArea1.Name = "ChartArea1";
this.chart1.ChartAreas.Add(chartArea1);
this.chart1.Dock = System.Windows.Forms.DockStyle.Fill;
legend1.Name = "Legend1";
this.chart1.Legends.Add(legend1);
this.chart1.Location = new System.Drawing.Point(0, 0);
this.chart1.Name = "chart1";
series1.BackGradientStyle = System.Windows.Forms.DataVisualization.Charting.GradientStyle.TopBottom;
series1.BackSecondaryColor = System.Drawing.Color.Lime;
series1.ChartArea = "ChartArea1";
series1.ChartType = System.Windows.Forms.DataVisualization.Charting.SeriesChartType.StackedColumn;
series1.Color = System.Drawing.Color.Yellow;
series1.IsVisibleInLegend = false;
series1.Legend = "Legend1";
series1.Name = "Series1";
series2.BackGradientStyle = System.Windows.Forms.DataVisualization.Charting.GradientStyle.TopBottom;
series2.BackSecondaryColor = System.Drawing.Color.Yellow;
series2.ChartArea = "ChartArea1";
series2.ChartType = System.Windows.Forms.DataVisualization.Charting.SeriesChartType.StackedColumn;
series2.Color = System.Drawing.Color.FromArgb(((int)(((byte)(255)))), ((int)(((byte)(128)))), ((int)(((byte)(0)))));
series2.IsVisibleInLegend = false;
series2.Legend = "Legend1";
series2.Name = "Series2";
series3.BackGradientStyle = System.Windows.Forms.DataVisualization.Charting.GradientStyle.TopBottom;
series3.BackSecondaryColor = System.Drawing.Color.FromArgb(((int)(((byte)(255)))), ((int)(((byte)(128)))), ((int)(((byte)(0)))));
series3.ChartArea = "ChartArea1";
series3.ChartType = System.Windows.Forms.DataVisualization.Charting.SeriesChartType.StackedColumn;
series3.Color = System.Drawing.Color.Red;
series3.Legend = "Legend1";
series3.Name = "Series3";
this.chart1.Series.Add(series1);
this.chart1.Series.Add(series2);
this.chart1.Series.Add(series3);
this.chart1.Size = new System.Drawing.Size(292, 273);
this.chart1.TabIndex = 0;
this.chart1.Text = "chart1"; 
```

以及创建数据点的代码：

```
// How to populate the series correctly in Forms.cs
public Form4()
{
    InitializeComponent();

    Random rand = new Random();
    chart1.Series[0].Points.Clear();
    chart1.Series[1].Points.Clear();
    chart1.Series[2].Points.Clear();
    for (int i = 0; i < 5; i++)
    {
        chart1.Series[0].Points.Add(66);
        chart1.Series[1].Points.Add(9);  // 66 + 9 = 75
        chart1.Series[2].Points.Add(rand.Next(1, 25));
    }

    chart1.ChartAreas[0].AxisY.Minimum = 60;
} 
```

# java - Java 数组标准差和中位数

> ID：13078428
> 
> 赞同：0
> 
> 时间：2012-10-25T22:41:27.820
> 
> 标签：java

需要将中值和标准偏差添加到以下程序中，但我不知道从哪里开始，我知道我想要它做什么，但不知道如何实现它，特别是因为中值必须在排序数字之后但是如果我将它作为 void Median () 放入，我会丢失已排序的数组。请帮忙！非常感谢任何帮助：

```
import java.util.Scanner;
import javax.swing.*;
public class JScannerO
{
    public JScannerO(){}
    public JScannerO(int A)
    {
        HowMuch = A;
    }
    void GenerateNumbers()
    {
        int k,Hide;
        k = 0;
        while ( k < HowMuch )
        {
            Hide = (int) (Math.random() * 100);
            if ( Hide > 9 && Hide < 100 )
            {
                Hanson[k] = Hide;
                k++;
            }
        }
    }
    void DisplayNumbers()
    {
        int k;
        for ( k = 0; k < HowMuch; k++)
        {
            System.out.println("\t\tThe numbers are : " + Hanson[k]);
        }
    }
    void BiggestNumber()
    {
        int k,Biggest;
        Biggest = Hanson[0];
        for ( k = 0; k < HowMuch; k++)
        {
            if ( Biggest < Hanson[k] ) Biggest = Hanson[k];
        }
        System.out.println("\n\n\t\tThe biggest number is : " + Biggest);
    }
    void SmallestNumber()
    {
        int k,Smallest;
        Smallest = Hanson[0];
        for ( k = 0; k < HowMuch; k++)
        {
            if ( Smallest > Hanson[k] ) Smallest = Hanson[k];
        }
        System.out.println("\n\n\t\tThe Smallest number is : " + Smallest);
    }
    void Average()
    {
        int k,Sum;
        double Average;
        Sum = 0;
        for ( k = 0; k < HowMuch; k++)
        {
            Sum = Sum + Hanson[k];
        }
        Average = 1.0 * Sum / HowMuch;
        System.out.format("\n\n\t\tThe Average number is : %7.2f",Average);
    }
    void Sort()
    {
        int k,Hide;
        boolean DidISwap;
        DidISwap = true;
        while (DidISwap)
        {
            DidISwap = false;
            for ( k = 0; k < HowMuch - 1; k++)
            {
                if ( Hanson[k] > Hanson[k+1] )
                {
                    Hide = Hanson[k ];
                    Hanson[k] = Hanson[k+1];
                    Hanson[k+1] = Hide ;
                    DidISwap = true;
                }
            }
        }
        System.out.println("\n\n\n\t\tThe Sorted Numbers : \n");
    }
    private int HowMuch;
    private int[] Hanson = new int[100];
} 
```

**这是通过使用调用程序运行的**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T02:04:45.533

我不明白你的问题。

你有一个排序算法可以为你工作！

你就不能写一个

```
public int median() { 
  Sort();
  return Hanson[Math.floor(Hanson/2)]; 
} 
```

?

这将花费您 O(N) 而不是 O(1)，但它不容易出错并且可以执行您需要做的事情 - 特别是因为您的“Hanson”数组只有 100 大小，所以我们现在可以不在乎.

最后一点：函数名称总是以小驼峰命名，即它是 sort() 而不是 Sort()，它是 calculateSomething() 而不是 Calculate_Something() 或任何其他变体。

这条规则没有任何例外，这将使您的代码（更多）更具可读性。考虑在 Eclipse (http://eclipse-cs.sourceforge.net/) 中安装 CheckStyle，以便在您编写时获得交互式样式指南:-)

# python - 动态大小的Python列表理解

> ID：13078429
> 
> 赞同：1
> 
> 时间：2012-10-25T22:41:31.410
> 
> 标签：python, list

假设我有一个列表理解

```
[x,y,z] for x in a for y in a for z in a 
```

假设这是我对尺寸 3 的理解，我希望能够相应地修改它，所以对于 2，我将只有 x，y，对于 4，我将拥有像 a、b、c、d 等...

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T22:46:28.147

是的，您可以使用以下[`product`](http://docs.python.org/library/itertools.html#itertools.product)功能：

```
from itertools import product
a = [1,2,3]
print list(product(a))
# gives: [(1,), (2,), (3,)]
print list(product(a, a))
# gives: [(1, 1), (1, 2), (1, 3), (2, 1), (2, 2), (2, 3), (3, 1), (3, 2), (3, 3)]
print list(product(a, a, a))
# gives: [(1, 1, 1), (1, 1, 2), (1, 1, 3), (1, 2, 1), (1, 2, 2), (1, 2, 3), (1, 3, 1), (1, 3, 2), (1, 3, 3), (2, 1, 1), (2, 1, 2), (2, 1, 3), (2, 2, 1), (2, 2, 2), (2, 2, 3), (2, 3, 1), (2, 3, 2), (2, 3, 3), (3, 1, 1), (3, 1, 2), (3, 1, 3), (3, 2, 1), (3, 2, 2), (3, 2, 3), (3, 3, 1), (3, 3, 2), (3, 3, 3)] 
```

或更方便地使用`repeat`关键字：

```
product(a, repeat=3) 
```

# css - CSS 属性有特定的顺序吗？

> ID：13078431
> 
> 赞同：3
> 
> 时间：2012-10-25T22:41:57.290
> 
> 标签：css

例如，如果我写：

```
background-color: black;
color: white; 
```

或者

```
color: white;
background-color: black; 
```

两者之间有什么区别，我应该关心订单吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T22:44:34.500

不，您可以按任何顺序编写它们。如果同一选择器中有重复项，则最后一条规则获胜。

```
p {
  color:blue;
  color:red;
  color:green; /* Green wins */
} 
```

在处理多个选择器时，后面的规则将覆盖前面的规则，除非前面的选择器更具体。

例如，此代码会将您的所有段落变为绿色：

```
p { color:red; }
/* ... */
p { color:green; } 
```

虽然这段代码会把你所有的段落都变成红色，因为第一个选择器*更具体*。

```
body p { color:red; }
/* ... */
p { color:green; } 
```

虽然选择器中规则的顺序可能无关紧要，但我会注意以可预测的顺序编写它们（例如，在调整大小规则之前的位置规则之前的着色规则之前）只是为了使您的 CSS 保持一致并且稍微更易于维护。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T22:44:52.310

在您的示例中没有区别，但是排序*可能*很重要，但仅在极少数情况下。

例如，有时通常会这样做：

```
display: block;
display: inline-block; 
```

当样式在同一规则中时，解析器将始终从上到下进行解释。在这种情况下会`inline-block`覆盖`block`，因为该属性是同名的。

然而：

```
ul li{
  font-size: 14px;
}

ul{
  font-size: 12px;
} 
```

在这种情况下，即使规则中的`12px`之后出现`14px`，列表项元素中的文本也会`14px`因为选择器的优先级`ul li`高于`ul`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T22:47:19.530

一些样式指南建议按字母顺序排列 CSS 样式。这有助于避免重复属性定义产生的错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T22:47:54.227

```
background: none no-repeat 0 0 #ccc;
background-color: #eee; 
```

`background-color will be #eee`......应该照顾这种情况......对于其他情况，顺序无关紧要。

对于具有一组值及其简单子属性的复杂属性 - 您应该谨慎行事：`margin, padding, background`......等等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T22:49:36.730

只有时间顺序重要的是使用具有 html 父/子节点或多个类的元素覆盖，如下所示。或者正如 Meagar 所说，如果您有多个描述同一类的相同类型的属性。最后一个将占主导地位。所以文本颜色将是白色或#fff。

```
.classname
{
  color:#000;
}

.classnameTwo
{
  color:#fff;
 } 
```

示例 html。

```
<div class="classname classnameTwo">Color text </div> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-26T06:12:38.093

如果声明影响相同的属性，则声明的顺序很重要。通过[级联规则](https://stackoverflow.com/questions/13080220/how-important-is-css-property-order#36089)，后者指定获胜，其他条件相同。

因此，在示例中，顺序没有影响，因为声明会影响不同的属性。但是例如在声明中

```
 font: 100% Calibri; font-weight: bold; 
```

顺序很重要，因为两个声明都设置了`font-weight`（设置为不同的值）。同样，在

```
 background: white; backround-image: url(bg.png); 
```

该命令很重要；如果顺序颠倒，将没有背景图像，因为`background`速记设置了所有背景属性，包括`background-image: none`在这种情况下。

（这总结并扩展了我对这个问题的[副本](https://stackoverflow.com/questions/13080220/how-important-is-css-property-order#36089)的回答。）

# wcf - 无法远程访问托管在 IIS 上的 WCF 服务，但可以在本地访问它

> ID：13078434
> 
> 赞同：1
> 
> 时间：2012-10-25T22:42:07.493
> 
> 标签：wcf, iis

我在 IIS 7.5 上部署了一个使用 HTTP 绑定的 WCF 服务。登录 Web 服务器后，我可以浏览到 svc 文件：“http://localhost:8200/MyService.svc”

但是当我从远程机器上执行它时它不可用：“http://11.22.33.44:8200//MyService.svc”

任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T06:57:39.607

确保您的防火墙已关闭，或者它允许连接到端口 8200

# ruby - 将数组拆分为第一个和最后一个

> ID：13078442
> 
> 赞同：-1
> 
> 时间：2012-10-25T22:43:21.863
> 
> 标签：ruby, arrays, multidimensional-array

```
@main = connection.execute("select code_ver, comment from mastertest 
```

@main 包含这样的内容：

```
{ [2.1, abcd],
  [3.0, xyz],
  [2.0, pqr] } 
```

我想将此数组拆分为 2 个数组，以便：

```
@arr1 = {[2.1],
         [3.0],
         [2.0]}

@arr2 = {[abcd],
         [xyz],
         [pqr]} 
```

我做这样的事情来从另一个数组复制一个数组：

```
@arr1 = Array.new
@main.each { |r| @arr1.push(r[0]) }

Can something be done here itself to split it how I want it? 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T22:47:27.893

假设上面的“数组”中有一些错字，一个简单的`map`就可以了：

```
> @main = [[2.1, 'abcd'], [3.0, 'xyz'], [2.0, 'pqr']]
# => [[2.1, "abcd"], [3.0, "xyz"], [2.0, "pqr"]] 
> @arr1 = @main.map {|y|[y[0]]}
# => [[2.1], [3.0], [2.0]] 
> @arr2 = @main.map {|y|[y[1]]}
# => [["abcd"], ["xyz"], ["pqr"]] 
```

您还可以查看`transpose`：

```
> @main.transpose
# => [[2.1, 3.0, 2.0], ["abcd", "xyz", "pqr"]] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T22:48:26.403

你可以试试：

```
ar1 = Array.new
ar2 = Array.new
[ [2.1, abcd], [3.0, xyz], [2.0, pqr] ].each do |val| 
  ar1 << val[0]
  ar2 << val[1]
end 
```

编辑：
如上所述：

```
{[2.1, abcd], [3.0, xyz], [2.0, pqr]} 
```

无效，我的解决方案没有返回单项数组的数组

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T22:49:44.987

```
@arr1, @arr2 = @main.transpose.map{|a| a.map{|x| [x]}} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T22:49:31.817

简单的方法是做两个`map`操作：

```
@arr1 = @main.map(&:first)
@arr2 = @main.map(&:last) 
```

但是如果`@main`很大，这是一个坏主意，因为它会遍历数组两次。在这种情况下：

```
@arr1 = []
@arr2 = []
@main.each do |item|
  @arr1 << item.first
  @arr2 << item.last
end 
```

`transpose`可以单线完成

```
@arr1, @arr2 = @main.transpose 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-25T22:49:41.673

也许使用该`#transpose`方法的东西：

```
main = [[2.1,'abcd'],[3.0,'xyz'],[2.0,'pqr']]
p main.transpose.first #=> [2.1, 3.0, 2.0] 
```

或者，如果结果应该是单元素数组：

```
main = [[2.1,'abcd'],[3.0,'xyz'],[2.0,'pqr']]
p main.transpose.first.map { |e| [e] } #=> [[2.1], [3.0], [2.0]] 
```

# java - 在字符串数组中搜索，代码需要布尔值？

> ID：13078444
> 
> 赞同：-1
> 
> 时间：2012-10-25T22:43:26.137
> 
> 标签：java, arrays, string, methods

所以我的代码应该在字符串数组中搜索名称。所以“mit”会找到“Smith”，我快到了，但我的方法存在问题。在`for`搜索名称的循环中，有一个错误告诉我我需要一个布尔值并且我正在使用一个字符串。有人知道怎么修这个东西吗？

```
public static void Search(String[] arr, String find) {
    for (int i = 0; i < 10; i++) {
        if (arr[i].toLowerCase()).contains(find.toLowerCase()) {
             System.out.println(String.format("found name: %s", arr[i]));
             return;
        }
    }
    System.out.println("Name not found!");
} 
```

错误在`if`声明中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T22:44:46.043

看这个：

```
if (arr[i].toLowerCase()).contains(find.toLowerCase()) 
```

计算括号...您在`if`第一个之后立即关闭条件`toLowerCase()`，而*不是*`contains`在通话后关闭它。你要：

```
if (arr[i].toLowerCase().contains(find.toLowerCase())) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:46:46.900

像这样做：

```
if ( arr[i].toLowerCase().contains(find.toLowerCase())) 
```

你关闭括号太早了，所以如果你有一个字符串而不是布尔值。

# ios - 当给定太多 CCAction 时，CCSequence 会导致应用程序内存不足

> ID：13078446
> 
> 赞同：1
> 
> 时间：2012-10-25T22:43:34.073
> 
> 标签：ios, cocos2d-iphone

我正在使用 Cocos2d 在 iPad 应用程序中创建动画。

在应用程序中，用户可以创建一系列动画并选择该序列重复的次数。由于不相关的原因，我选择将每个动作分成许多小动作——即如果用户选择移动 100 分，她将改为移动 2 分 100 次。这会导致非常大的 CCSequence 数组。

我发现创建大约 16k CCAction 的序列会导致应用程序崩溃。这是预期的行为吗？有谁知道实现这种效果的解决方法，还是我需要结束运动的分裂？

谢谢！

编辑：这是一个截图，描述了我想要实现的效果以及我拆分动画的原因。 ![在此处输入图像描述](../Images/c32961e38f62c5535f0c1d457c6582cb.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T06:22:48.043

```
typedef enum Actor_STATE{
    kState_MovingLeft = 14001,
    kState_MovingRight
}ActorState;

@interface HorseRider : CCSprite
{
    ActorState mState;
    float mMoveSpeed;
}
@property(nonatomic, assign) ActorState     state;

//implementation of HorseRider

-(void)updateRider
{
    CGPoint pos = self.position;

    if(self.state == kState_MovingLeft)
    { 
        pos.x -= mMoveSpeed;

        if(pos.x>screenWidth)
        {
           state = kState_MovingRight; 
           continue;
        }
    }
    else 
    { 
       pos.x += mMoveSpeed;

        if(pos.x>0.0f)
        {
           state = kState_MovingRight; 
           continue;
        }

        [self createTrackDots];

    }

    self.position = pos;
}

-(void) createTrackDots
{
   if(ABS(lastDots.x - self.position.x) > MIN_DOT_DISTANCE)
   {
      [self createDotsAtPos: self.position]; 
   }
}

//Game init
-(id)init
{
    …
    hero = [HorseRider spriteWithSpriteFrameName:FRAME_NAME];
    hero.state = kState_MovingLeft;
    ….
    [self schedule: @selector(tick:)];
}

-(void) tick: (ccTime) dt
{    
   if(self.isGamePaused || self.isGameOver )
    {
        [hero updateRider];
    }

} 
```

# django - BackboneJS 保存发送 GET 而不是 PUT

> ID：13078448
> 
> 赞同：1
> 
> 时间：2012-10-25T22:43:46.307
> 
> 标签：django, backbone.js, tastypie

我的 BackboneJS 模型现在发送一个`GET`而不是`PUT`当我调用该`model.save()`方法时。我有一个带有 django-tastypie 的 Django 后端，用于 REST api。

例如，我有一个用户模型，我尝试像这样更新：

```
var me = new UserModel({
    id: this.user.id
});
me.fetch({
    success: function (t) {
        console.log(t);
        t.set({
            'premium': true
        });
        t.save({
            success: function () {
                alert('success')
            },
            error: function (m, e) {
                console.log(e);
            }
        });
    }
}) 
```

我在控制台中收到以下错误：

```
GET http://127.0.0.1:8000/api/v1/users/100003258103084/ 500 (INTERNAL SERVER ERROR) 
```

在我有的那一行`t.save()`

我在这里做错了什么吗？

**编辑**

好的，它在他的行中显示的消息`console.log(e)`如下：

```
"{"error_message": "int() argument must be a string or a number, not 'dict'", "traceback": "Traceback (most recent call last):\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/tastypie/resources.py\", line 192, in wrapper\n    response = callback(request, *args, **kwargs)\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/tastypie/resources.py\", line 406, in dispatch_detail\n    return self.dispatch('detail', request, **kwargs)\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/tastypie/resources.py\", line 427, in dispatch\n    response = method(request, **kwargs)\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/tastypie/resources.py\", line 1131, in put_detail\n    updated_bundle = self.obj_update(bundle, request=request, **self.remove_api_resource_names(kwargs))\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/tastypie/resources.py\", line 1827, in obj_update\n    m2m_bundle = self.hydrate_m2m(bundle)\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/tastypie/resources.py\", line 743, in hydrate_m2m\n    bundle.data[field_name] = field_object.hydrate_m2m(bundle)\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/tastypie/fields.py\", line 742, in hydrate_m2m\n    m2m_hydrated.append(self.build_related_resource(value, **kwargs))\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/tastypie/fields.py\", line 593, in build_related_resource\n    return self.resource_from_data(self.fk_resource, value, **kwargs)\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/tastypie/fields.py\", line 548, in resource_from_data\n    return fk_resource.obj_update(fk_bundle, **data)\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/tastypie/resources.py\", line 1814, in obj_update\n    bundle.obj = self.obj_get(request, **lookup_kwargs)\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/tastypie/resources.py\", line 1752, in obj_get\n    base_object_list = self.get_object_list(request).filter(**kwargs)\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/django/db/models/query.py\", line 621, in filter\n    return self._filter_or_exclude(False, *args, **kwargs)\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/django/db/models/query.py\", line 639, in _filter_or_exclude\n    clone.query.add_q(Q(*args, **kwargs))\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/django/db/models/sql/query.py\", line 1250, in add_q\n    can_reuse=used_aliases, force_having=force_having)\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/django/db/models/sql/query.py\", line 1185, in add_filter\n    connector)\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/django/db/models/sql/where.py\", line 69, in add\n    value = obj.prepare(lookup_type, value)\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/django/db/models/sql/where.py\", line 320, in prepare\n    return self.field.get_prep_lookup(lookup_type, value)\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/django/db/models/fields/related.py\", line 137, in get_prep_lookup\n    return self._pk_trace(value, 'get_prep_lookup', lookup_type)\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/django/db/models/fields/related.py\", line 210, in _pk_trace\n    v = getattr(field, prep_func)(lookup_type, v, **kwargs)\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/django/db/models/fields/__init__.py\", line 310, in get_prep_lookup\n    return self.get_prep_value(value)\n\n  File \"/home/mohamed/code/skempi/venv/local/lib/python2.7/site-packages/django/db/models/fields/__init__.py\", line 537, in get_prep_value\n    return int(value)\n\nTypeError: int() argument must be a string or a number, not 'dict'\n"}" 
```

这是否意味着问题出在 Django-Tastypie 而不是 BackbonejS？这仍然`GET`是我猜的问题！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T09:15:54.230

save 方法有 2 个参数：model.save([attributes], [options]) - 都是可选的。

现在您正在传递选项哈希而不是属性。尝试：

```
t.save(t.attributes, {
    success: function () {
        alert('success')
    },
    error: function (m, e) {
        console.log(e);
    }
}); 
```

或者

```
t.save({'premium':true}, {
    success: function () {
        alert('success')
    },
    error: function (m, e) {
        console.log(e);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T09:51:29.177

似乎`me.fetch`发送 GET 请求。除非您覆盖了默认同步方法，否则 Backbone 中没有任何内容会在保存时发出 GET 请求。

Save 仅执行 POST 或 PUT 请求（如果模型没有 id 则为 POST，否则为 PUT）。

# java - 为特定大小的拇指和轨道切换视图集可绘制对象

> ID：13078449
> 
> 赞同：4
> 
> 时间：2012-10-25T22:43:48.133
> 
> 标签：java, android

我正在使用 Switch 视图，并将我的可绘制资源用于拇指和轨道。现在为了不在拇指上显示文本但具有特定宽度的文本，我正在这样做：例如，我希望拇指宽度为 40dp，然后我将 thumbTextPadding 设置为 20dp。有更好的方法吗？我还有一个问题。我需要轨道宽度正好是 2 * 拇指宽度，但我注意到 switch 将其宽度设置得更大一些，对我来说这是必不可少的。谁能帮我解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-10T14:20:33.693

为了解决这个问题，我使用了设置开关的最小宽度样式：

```
android:switchMinWidth="40dp" 
```

我还没有找到不使用 thumbTextPadding 来设置拇指宽度的方法。

希望有帮助。

# php - 当属性名称为 * 时如何解析 PHP 对象？

> ID：13078453
> 
> 赞同：3
> 
> 时间：2012-10-25T22:44:17.693
> 
> 标签：php, object, json

> **可能重复：**
> [对象的属性名称中的特殊字符](https://stackoverflow.com/questions/10455775/special-characters-in-property-name-of-object)

我正在解析来自 MediaWiki 的 API 的 JSON 响应：[请求的 URL](http://en.wikipedia.org/w/api.php?format=json&action=query&prop=revisions&rvprop=content&titles=George%20Washington)

我运行它`json_decode()`，然后拉出一些碎片。我遇到的问题是内容的属性名称是`*`. 当我尝试访问内容时出现 PHP 错误（下面我的 vardumped json_decoded 示例末尾的 140,950 个字符串），如下所示：

```
foreach( $Response->query->pages as $page_id => $Page ) {
    $this->id                   = $Page->pageid;
    $this->title                = $Page->title;
    $this->content_with_markup  = $Page->revisions[0]->*;
} 
```

PHP错误：`PHP Parse error: syntax error, unexpected '*'`

和`pageid`工作`title`正常。

这是给我带来问题的 JSON_Decoded 对象：

```
object(stdClass)#5 (1) {
  ["11968"]=>
  object(stdClass)#6 (4) {
    ["pageid"]=>
    int(11968)
    ["ns"]=>
    int(0)
    ["title"]=>
    string(17) "George Washington"
    ["revisions"]=>
    array(1) {
      [0]=>
      object(stdClass)#7 (2) {
        ["contentformat"]=>
        string(11) "text/x-wiki"
        ["*"]=>
        string(140950) "{{About|the first President of the United States|other uses}}... 
```

**如何访问名为 * 的属性中包含的内容？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T22:45:06.367

一直如此。

```
...->{'*'}->... 
```

# ruby-on-rails - JSON 没有嵌套在 Rails 视图中

> ID：13078461
> 
> 赞同：0
> 
> 时间：2012-10-25T22:44:48.953
> 
> 标签：ruby-on-rails, json

我有几个模型在一个层次结构中，每个级别都是 1:many。每个类只与它上面的类和它下面的类相关联，即：

L1 课程、L2 单元、L3 单元布局、L4 布局字段、L5 表格字段（不在代码中，而是布局字段的兄弟）

我正在尝试构建整个层次结构的 JSON 响应。

```
def show
    @course = Course.find(params[:id])
    respond_to do |format|
      format.html # show.html.erb
      format.json do
        @course = Course.find(params[:id])
        @units = @course.units.all
        @unit_layouts = UnitLayout.where(:unit_id => @units)
        @layout_fields = LayoutField.where(:unit_layout_id => @unit_layouts)
        response = {:course => @course, :units => @units, :unit_layouts => @unit_layouts, :layout_fields => @layout_fields}
        respond_to do |format|
          format.json {render :json => response }
        end
      end
    end
  end 
```

代码带回了正确的值，但是单元、unit_layouts 和 layout_fields 在课程中都嵌套在同一级别。我希望它们嵌套在它们的父级中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:58:01.690

您需要使用[`to_json`](http://apidock.com/rails/ActiveRecord/Serialization/to_json)with`:include`来包含关联的记录。

这是一个尝试：

```
@course = Course.find(params[:id])

respond_to do |format|
  format.html # show.html.erb
  format.json do
    render :json => @course.to_json(:include => { :units => { :include => :layouts } })
  end
end 
```

这可能不是 100% 正确，因为您没有包括所有关联的名称，但我假设`Unit`has_many `Layouts`。要包含更深的嵌套，请添加额外的嵌套`:include`s。

# jquery - jQuery嵌入youtube IE问题

> ID：13078471
> 
> 赞同：0
> 
> 时间：2012-10-25T22:45:24.587
> 
> 标签：jquery

我一直在研究这里特色的自定义图像滑块：

jQuery

```
$(function(){
      $('.cont:gt(0)').hide();
      $("#parent").on("mouseenter", ".extraContent div", function(){
           var ind = $(this).index();
           $("#parent").find(".cont").stop().fadeTo(600,0,function(){
               $('#parent').find('.cont').eq(ind).stop().fadeTo(300,1);
           });
        });
        $('#parent .extraContent').on('click',function(){
             window.location=$(this).find("a").attr("href"); 
             return false;
        });
    }); 
```

CSS

```
​#parent { width:400px; margin:auto}
.mainContent { width:430px; height:300px; border:1px solid #000;padding:5px; }
.extraContent {overflow:auto; width:450px;}
.extraContent div{float:left; width:90px; height:90px; border:1px solid #00F; margin:5px; padding:5px }
.extraContent div:hover { border:1px solid #0F0;cursor:pointer }
.cont{
   position:absolute;
} 
```

HTML

```
<div id="parent">
    <div class="mainContent">
        <div class="cont"> Content 1....</div>
        <div class="cont"> Content 2....</div>
        <div class="cont">Content 3...<br /><iframe width="267" height="200" src="http://www.youtube.com/embed/6tlQn7iePV4?rel=0" frameborder="0" allowfullscreen></iframe></div>
        <div class="cont"> Content 4....</div>  
    </div>
    <div class="extraContent">
        <div><p>1 Custom content here <br /> <a href="">Some link</a></p></div>
        <div><p>2 Custom content here <br /> <a href="">Some link</a></p></div>
        <div><p>3 Custom content here <br /> <a href="">Some link</a></p></div>
        <div><p>4 Custom content here <br /> <a href="">Some link</a></p></div>
    </div>
</div>​ 
```

我的问题是，如果我使用 iframe 直接从网站嵌入 YouTube 视频，它在 Chrome 中的转换效果很好，但 Firefox 和 IE 只是立即显示视频，并且每个幻灯片/div 都出现在视频下方，这是一个已知问题，没有人知道我可以让 IE 和 FF 表现的方法。

ps 因为这将在内容管理系统中，用户嵌入视频的唯一方法是使用来自 youtube 的默认代码。

[在这里提琴](http://jsfiddle.net/vrqdh/6/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T22:55:45.620

这是一个已知问题，我称之为“超级 z-index”。这是一个flash相关的问题。如果您使用 HTML5 播放器，它不会发生。基本上你必须在你的 Youtube url 中再设置一个参数：

```
http://www.youtube.com/embed/6tlQn7iePV4?rel=0&amp;wmode=transparent
                                              ^--------------------^ 
```

顺便说一句，如果你想保持你的标记干净，你可以使用这个片段，它将你的 Youtube 链接转换为 iframe，包括 z-index 修复。

```
function embedYoutube(link, ops) {

  var o = $.extend({
    width: 480,
    height: 320,
    params: ''
  }, ops);

  var id = /\?v\=(\w+)/.exec(link)[1];

  return '<iframe style="display: block;"'+
    ' class="youtube-video" type="text/html"'+
    ' width="' + o.width + '" height="' + o.height +
    ' "src="http://www.youtube.com/embed/' + id + '?' + o.params +
    '&amp;wmode=transparent" frameborder="0" />';
} 
```

有关它的更多信息[这篇文章](http://www.onextrapixel.com/2012/10/04/10-useful-and-time-saving-javascript-snippets/)。

# oop - 将数据连接到 GUI - OOP

> ID：13078473
> 
> 赞同：1
> 
> 时间：2012-10-25T22:45:49.843
> 
> 标签：oop, user-interface, design-patterns

我有一个应用程序，上面有几个图表。

我工作得很快，只是制作了类似的类`Graph`，`Table`每个类都包含一个请求对象（伪代码）：

```
class Graph {
  private request;

  public function setDateRange(dateRange) {
    request.setDateRange(dateRange);
  }
  public function refresh() {
    request.getData(function() {
      //refresh the display
    });
  }
} 
```

对于 GUI 事件（例如，有人更改日期范围下拉菜单），我只需调用`Graph`实例上的设置器，然后刷新它。好吧，当我添加其他 GUI 元素（如表格等）时，它们基本上都有类似的方法（`setDateRange`以及请求中常见的其他东西）。

有哪些更优雅的 OOP 方法可以做到这一点？

该应用程序非常简单，我不想过度设计它，但我也不希望有一堆类具有基本相同的方法，它们只是路由到请求对象。我也不想将每个 GUI 类设置为从请求类继承，但我真的对任何想法持开放态度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T23:11:29.550

正如您所评论的，这些方法是相同的。在这种情况下，我建议采用以下方法。

```
abstract class AbstractGUIElement {

    protected request;

    public function setDateRange(dateRange) {
        request.setDateRange(dateRange);
    }

    abstract function refresh();
} 
```

刷新可能是特定于元素的，因此我将其添加为继承类型必须实现的抽象方法。

```
class Graph extends AbstractGUIElement {

    public function refresh() {
        // Graph specific refreshing
    }
} 
```

# multithreading - 添加AFDownloadRequestOperation时出现几个重新声明错误

> ID：13078481
> 
> 赞同：-1
> 
> 时间：2012-10-25T22:46:45.660
> 
> 标签：multithreading, uiimageview, uiimage, nsoperation, afnetworking

当我添加时，`AFDownloadRequestOperation`我遇到了几个错误，导致我无法成功构建我的项目......

这些错误似乎都具有重新声明的性质。我首先想到的是进入显示错误的文件并单独删除其他声明。

但我认为这可能会导致更多错误和/或不是解决我的问题的最佳方法。有人熟悉这个问题吗？

我附上了我看到的截图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T06:45:15.673

我最好的猜测是 Xcode 抱怨项目中有多个文件声明了`@interface`for `AFDownloadRequestOperation`。请注意，`AFDownloadRequestOperation`它从未成为标准 AFNetworking 库的一部分，因此我建议您确保使用可用的规范源的最新版本。

您可能会发现[CocoaPods](http://cocoapods.org)有助于管理您的依赖项，作为手动将源文件添加到项目的替代方法。

# asp.net - 如何调用索引操作并有条件地在 ASP.NET MVC 应用程序中将值传递给它

> ID：13078486
> 
> 赞同：1
> 
> 时间：2012-10-25T22:46:58.753
> 
> 标签：asp.net, asp.net-mvc

我在控制器上有一个索引操作，如下所示...

```
public ActionResult Index(string errorMsg = "")
   {
      //do stuff
      ViewBag.ErrorMsg=erorMsg;

      return View();
   } 
```

我还有另一个动作是 Index 的 http 帖子。

当出现问题时，我想重新加载索引页面并显示错误...

我的观点已经有条件地显示 errorMsg。但我不知道如何调用 Index 并传入错误字符串？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T22:54:04.313

通常，您只需在两个操作之间共享视图。我猜您的操作看起来像这样（您提供的有关索引功能的信息越多，我的示例就越好）：

```
public ActionResult Index()
{
   return View();
}

[HttpPost, ActionName("Index")]
public ActionResult IndexPost()
{

    if (!ModelState.IsValid)
    {
        ViewBag.ErrorMsg = "Your error message"; // i don't know what your error condition is, so I'm just using a typical example, where the model, which you didn't specify in your question, is valid.
    }

    return View("Index");
} 
```

和 Index.cshtml

```
@if(!string.IsNullOrEmpty(ViewBag.ErrorMsg)) 
 {
      @ViewBag.ErrorMsg
 }

 @using(Html.BeginForm())
 {
     <!-- your form here. I'll just scaffold the editor since I don't know what your view model is -->
    @Html.EditorForModel()

    <button type="Submit">Submit</button>
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:53:49.510

如果我理解正确，您只需要在查询字符串中使用 errorMsg 访问 url：

`/*controllername*/index?errorMsg=*errormessage*`

但是，当出现问题时，您不一定需要重新加载页面。似乎您可能以错误的方式处理此问题..？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T22:54:17.867

您可以使用`RedirectToAction`errorMsg 值的查询字符串重定向到页面。

```
[HttpPost]
public ActionResult Index(YourViewModel model)
{
  try
  {
    //try to save and then redirect (PRG pattern)
  }
  catch(Exception ex)
  {
    //Make sure you log the error message for future analysis
    return RedirectToAction("Index",new { errorMs="something"}
  }
} 
```

`RedirectToAction`发出`GET`请求。因此，您的表单值将消失，因为**HTTP 是无状态的**。如果您想保留表单中的值，请再次返回发布的视图模型对象。我会摆脱 ViewBag 并添加一个名为`ErrorMsg`ViewModel 的新属性并设置它的值。

```
[HttpPost]
public ActionResult Index(YourViewModel model)
{
  try
  {
    //try to save and then redirect (PRG pattern)
  }
  catch(Exception ex)
  {
    //Make sure you log the error message for future analysis
    model.ErrorMsg="some error";
    return View(model);
  }
} 
```

在视图中，您可以检查此模型属性并向用户显示消息。

# php - CodeIgniter - 是否有用于裁剪图像的基于 GUI 的库？

> ID：13078487
> 
> 赞同：0
> 
> 时间：2012-10-25T22:47:00.443
> 
> 标签：php, codeigniter

CodeIgniter - 是否有用于裁剪图像的基于 GUI 的库？

我想准确选择要裁剪的内容和位置。理想情况下，我希望能够去

mysite.com/manageImage/crop/example-image.jpg

它会显示裁剪它的界面，然后裁剪该图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:01:23.070

您需要做的是一个好的库，然后将其作为库添加到您的 CI 结构中。然后`manageimage`控制器的`crop`函数将图像名称作为参数并调用裁剪库来发挥它的魔力。您将需要的大部分内容，因为它带有 UI，这意味着您需要进行一些集成工作。

遗憾的是无法为您搜索和列出库，但我希望您知道该往哪个方向前进。

想到的一个好的库是[cropzoom](http://www.cropzoom.com.ar/)

# java - Android：收到短信时创建一个 AlertDialog/PopUp

> ID：13078489
> 
> 赞同：0
> 
> 时间：2012-10-25T22:47:13.540
> 
> 标签：java, android, android-alertdialog

我正在尝试构建一个从特定发件人那里读取 SMS 的程序。然后它将文本解析为地址。带有地址和两个按钮的弹出窗口自动出现，OK（取消弹出窗口）和 Map（将地址发送到显示地址的 MapView）。我不知道如何创建一个显示时间、地址和呼叫类型的弹出窗口。

```
package bkgdService;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.telephony.SmsMessage;
import android.widget.Toast;

public class SMSReceiver extends BroadcastReceiver
{
public int calltypeIndexA;
private String time;
private String callType;
private String location;

public void onReceive(Context context, Intent intent)
{
    Bundle myBundle = intent.getExtras();
    SmsMessage [] messages = null;

    if (myBundle != null)
    {
        Object [] pdus = (Object[]) myBundle.get("pdus");
        messages = new SmsMessage[pdus.length];

        for (int i = 0; i < messages.length; i++)
        {

        if (messages[i].getOriginatingAddress() == "messaging@iamresponding.com") 
            {

                messages[i] = SmsMessage.createFromPdu((byte[]) pdus[i]);
                String message = messages[i].getMessageBody();
                this.time = SupportMethods.findTime(message);
                this.callType = SupportMethods.findCallType(message);

                }
            }

        //ADD POPUP
    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:32:44.027

是的，他们中的许多人可能会很混乱。我会看看我能不能帮忙。如果您的应用程序不会非常健壮，您可以在此处发出警报。如果您认为它会变得更大，我建议为您的警报/弹出窗口创建一个单独的类，并通过意图[链接](http://developer.android.com/reference/android/content/Intent.html)传递数据这是文档中的一个链接，它很好地解释了如何创建自定义警报[链接](http://developer.android.com/guide/topics/ui/dialogs.html)。您可以使用它来创建要弹出的自定义警报。您可以在应用程序的开头声明您的消息、日期等变量，然后在警报中将它们用作文本视图以显示在警报中。或者正如我所说，如果您将在整个程序中获得更多警报，您可能需要考虑为它们创建一个单独的类。希望这可以帮助！

# linux - 从文件名中提取版本号

> ID：13078490
> 
> 赞同：5
> 
> 时间：2012-10-25T22:47:17.843
> 
> 标签：linux, string, bash

我在这样的文件夹中有一个文件：

> 安装程序-x86_64-XXX.XX-diagnostic.run

其中 XXX.XX 是版本号，我只需要版本号。**如何在Linux中做到这一点？**

我有这个代码：

```
#!/bin/bash
current_ver=$(find /mnt/builds/current -name '*.run'|awk -F/ '{print $NF}') 
```

所以这给了我正确的文件名（减去我不想要的位置）。

但是我如何只将 XXX.XX 版本号放入变量中，例如`$version`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T23:01:00.580

您实际上不需要任何外部工具。您可以完全在 bash 中执行此操作，方法是根据模式切割变量。

```
[ghoti@pc ~]$ name="installer-x86_64-XXX.XX-diagnostic.run"
[ghoti@pc ~]$ vers=${name#*-}; echo $vers
x86_64-XXX.XX-diagnostic.run
[ghoti@pc ~]$ vers=${vers#*-}; echo $vers
XXX.XX-diagnostic.run
[ghoti@pc ~]$ vers=${vers%-*}; echo $vers
XXX.XX
[ghoti@pc ~]$ 
```

或者，如果您愿意，您可以先在右侧切块：

```
[ghoti@pc ~]$ name="installer-x86_64-XXX.XX-diagnostic.run"
[ghoti@pc ~]$ vers=${name%-*}; echo $vers
installer-x86_64-XXX.XX
[ghoti@pc ~]$ vers=${vers##*-}; echo $vers
XXX.XX
[ghoti@pc ~]$ 
```

当然，如果你想使用外部工具，那也没关系。

```
[ghoti@pc ~]$ name="installer-x86_64-XXX.XX-diagnostic.run"
[ghoti@pc ~]$ vers=$(awk -F- '{print $3}' <<<"$name")
[ghoti@pc ~]$ echo $vers
XXX.XX
[ghoti@pc ~]$ vers=$(sed -ne 's/-[^-]*$//;s/.*-//;p' <<<"$name")
[ghoti@pc ~]$ echo $vers
XXX.XX
[ghoti@pc ~]$ vers=$(cut -d- -f3 <<<"$name")
[ghoti@pc ~]$ echo $vers
XXX.XX
[ghoti@pc ~]$ 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-25T22:52:55.887

你要：

```
awk -F"-" '{ print $3 }' 
```

与`-F`您一起指定分隔符。在这种情况下，`-`。版本号是第三个字段，所以这就是你需要`$3`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-25T22:53:32.127

尝试：

```
current_ver=$(find /mnt/builds/current -name '*.run'|grep -Eo '[0-9]+\.[0-9]+') 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-25T22:57:02.997

人们忘记了还有一个更简单的，[`cut`](http://www.freebsd.org/cgi/man.cgi?query=cut&manpath=FreeBSD+9.0-RELEASE).

```
$ echo "installer-x86_64-XXX.XX-diagnostic.run" | cut -d - -f 3
XXX.XX 
```

# shell - 根据可显示的行限制终端中命令的输出

> ID：13078504
> 
> 赞同：1
> 
> 时间：2012-10-25T22:48:37.607
> 
> 标签：shell, terminal

给定一个列出上次修改文件的别名，如下所示：

> 别名 lt='ls -ltc|head -10'

有没有办法确定可显示的行，所以我可以有一个过滤器/限制是它的函数。

不关心换行等其他问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T01:46:54.810

当前终端上可显示的行数在`$LINES`变量中可用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T23:00:36.103

您可以通过以下方式获取终端的大小：

```
stty size 
```

它以行数和列数响应，例如：

> 25 80

和

```
stty size | awk '{print $1;}' 
```

只会给你行数。

# java - 将应用程序导出到 Jar 后，为什么会出现“发生 Java 异常”？

> ID：13078505
> 
> 赞同：2
> 
> 时间：2012-10-25T22:48:40.320
> 
> 标签：java, eclipse, exception, jar, export

好吧，我用 Eclipse 将我的应用程序导出到 JAR 中，但是现在每当我尝试运行它时，我都会得到：“发生了 Java 异常”。当我尝试通过命令行运行它时，它说：

```
C:\Users\Arturas>java -jar D:\Dropbox\EclipseWorkspace\Exports\Dantracio_skaiciu
oklis3.jar
Exception in thread "main" java.lang.NoClassDefFoundError: org/eclipse/swt/widge
ts/Composite
        at java.lang.Class.getDeclaredMethods0(Native Method)
        at java.lang.Class.privateGetDeclaredMethods(Unknown Source)
        at java.lang.Class.getMethod0(Unknown Source)
        at java.lang.Class.getMethod(Unknown Source)
        at sun.launcher.LauncherHelper.getMainMethod(Unknown Source)
        at sun.launcher.LauncherHelper.checkAndLoadMain(Unknown Source)
Caused by: java.lang.ClassNotFoundException: org.eclipse.swt.widgets.Composite
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        ... 6 more

C:\Users\Arturas> 
```

有什么解决办法吗？我只是讨厌 java ......当你想要它时它永远不会在桌面上工作......对不起，我真的很紧张，我反应过度......

有什么想法可能导致这种情况吗？我也不在其他计算机上工作。现在它使用的是 Java 1.7。该应用程序在 Eclipse 上完美运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T22:51:11.470

您需要获取依赖项。看起来您依赖于 swt，它不是核心 java 语言的一部分。您需要获取您所依赖的所有第三方 jar，并将它们包含在您的类路径中。它在 Eclipse 上完美运行，因为 Eclipse 负责为您设置类路径。

[您可以按照文档](http://docs.oracle.com/javase/tutorial/deployment/jar/downman.html)中的说明在清单文件中设置类路径，或者您可以包含一个脚本来启动您的应用程序，该脚本将`-cp`在运行 jar 时使用该命令，或者您可以使用将所有内容打包到一个怪物 jar 中的东西，例如[这个问题](https://stackoverflow.com/questions/1059851/is-it-possible-to-package-all-the-jar-dependencies-in-one-big-jar)的解决方案。

# python - Pythonic从目录上传SQL中的CSV文件，路径错误

> ID：13078507
> 
> 赞同：1
> 
> 时间：2012-10-25T22:49:20.833
> 
> 标签：python, mysql

目前，我的脚本将 .txt 文件从 FTP 站点下载到本地目录（在检查目录是否已包含该文件之后），将每个文件转换为（单独的）.csv。我需要将数据移植到 mysql 数据库中。

这是我遇到问题的部分：运行脚本的第二部分（选票阅读器），其中文件中的行被导入 SQL，当路径不是动态时（即 R:\path\filename），脚本工作和 sql 表填充。当路径是动态的（即'R:\path\'+filename）时，不会填充任何内容。有什么建议么？

```
for filename in filenames:
    local_filename = os.path.join('R:\\path', filename)
    if os.path.isfile(local_filename) is False:
        print 'New file found.'
        file = open(local_filename, 'wb')
        ftp.retrbinary("RETR " + filename, file.write, 8*1024)
        file.close()
        print 'Downloaded '+filename+' file'
        txt_file = r""+filename
        csv_file = r""+filename+".csv" 
        in_txt = csv.reader(open(txt_file, "rb" ),delimiter = '|')
        outcsv = csv.writer(open(csv_file,'wb'))
        outcsv.writerows(in_txt)

        with open("R:\\path"+csv_file,'rb') as csv_input:
            ballotreader = csv.reader(csv_input, delimiter=',',quotechar ='|') 
            for row in ballotreader:  
                cursor = db.cursor()  
                if row[1] > 0: 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:12:37.067

问题可能与您构建路径的方式有关。尝试使用`os.path.join`：

```
import os

path = os.path.join("R:\\path",csv_file)
with open(path,'rb') as csv_input:
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T19:07:13.143

谢谢@btel。这就是我的问题的解决方案。我的最终代码：

```
 with open(csv_file,'wb') as outcsv:
        out = csv.writer(outcsv, delimiter = '|')
        out.writerows(in_txt) 
```

# apache-camel - 如何使用 Apache Camel 定期处理一些输入

> ID：13078511
> 
> 赞同：2
> 
> 时间：2012-10-25T22:49:40.743
> 
> 标签：apache-camel

我想知道是否有办法让骆驼做我需要的事情，如下所示：

“定期从某个来源（比如说一个文件）读取数据，对其进行一些处理并将其写入其他地方”

我想出了如何做所有这些减去“定期”部分。我知道如何使用 Quartz 或 Timer 触发路由。但是当我使用这些时，部分已经被占用了，所以我不能再改变身体了。

有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T06:36:32.840

您也可以使用预定路由策略 [http://camel.apache.org/scheduledroutepolicy.html](http://camel.apache.org/scheduledroutepolicy.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-26T02:49:36.263

您可以使用计时器/石英启动它，然后使用[内容丰富](http://camel.apache.org/content-enricher.html)器或[轮询消费者](http://camel.apache.org/polling-consumer.html)

```
//using timer/pollEnrich to populate the body with the polling results
from("timer://foo?period=5000")
    .pollEnrich("file:inbox")
    .to("file:outbout");

//using time/polling consumer bean for more flexibility and multiple polling
from("timer://foo?period=5000")
    .bean(myPollingConsumerBean, "doIt");

public static class MyPollingConsumerBean {
...
    public void doIt() {
      while (true) {
        String msg = consumer.receiveBody("file:inbox", 3000, String.class);
        if (msg == null) {
            break;
        }
        producer.sendBody("file:outbox", msg);
      }
    }
} 
```

# php - 模态框电子邮件将php变量传递给短信发件人

> ID：13078513
> 
> 赞同：1
> 
> 时间：2012-10-25T22:49:45.343
> 
> 标签：php, jquery, email, variables, post

好的，所以我使用 ModalBox 在我的网站上创建一个电子邮件表单..但是，我需要模态框来发送电子邮件不是给我，而是发送给添加汽车的用户（它是一个汽车销售网站），所以我需要将 $email 变量传递给 sendmessage.php。

这是我到目前为止所做的：

 `````
$(document).ready(function() {
    $(".modalbox").fancybox();
    $("#contact").submit(function() { return false; });

    $("#send").on("click", function(){
    setTimeout("$.fancybox.close()", 10);
        var emailval  = $("#email").val();
        var msgval    = $("#msg").val();
        var msglen    = msgval.length;
        var mailvalid = validateEmail(emailval);

        if(mailvalid == false) {
            $("#email").addClass("error");
        }
        else if(mailvalid == true){
            $("#email").removeClass("error");
        }

        if(msglen < 4) {
            $("#msg").addClass("error");
        }
        else if(msglen >= 4){
            $("#msg").removeClass("error");
        }

        if(mailvalid == true && msglen >= 4) {
            // if both validate we attempt to send the e-mail
            // first we hide the submit btn so the user doesnt click twice
            $("#send").replaceWith("<em>Se trimite...</em>");

            $.ajax({
                type: 'POST',
                url: 'http://automoka.ro/sendmessage.php',
                data: $("#contact").serialize(),
                success: function(data) {
                    if(data == "true") {
                        $("#contact").fadeOut("fast", function(){
                            $(this).before("<p><strong>Mesajul a fost trimis!</strong></p>");
                            setTimeout("$.fancybox.close()", 10);
                            $_POST['contact'] = $email;
                        });
                    }
                }
            });
        }
    });
}); 
````  `并在 php 发件人中：

```
$email = $_POST['contact'];

$sendto   = $email;
$usermail = $_POST['email'];
$content  = nl2br($_POST['msg']);

if(@mail($sendto, $subject, $msg, $headers)) {
    echo "true";
} else {
    echo "false";
} 
```

我究竟做错了什么？请帮助....提前致谢！

**编辑：没关系..想通了！...我添加了另一个隐藏到模态框的文本区域...并使用 post 将其发送到 sendmessage.php。**``

# jquery - 从 html jQuery 加载内容（许多不同的 div）

> ID：13078516
> 
> 赞同：-1
> 
> 时间：2012-10-25T22:50:14.113
> 
> 标签：jquery, dynamic, load, rel

我有很多 div

```
<div id="movies" rel="info.php?m=19923"></div>
<div id="movies" rel="info.php?m=98127"></div>
<div id="movies" rel="info.php?m=39423"></div>
<div id="movies" rel="info.php?m=32942"></div>
<div id="movies" rel="info.php?m=15454"></div>
<div id="movies" rel="info.php?m=143436"></div> 
```

100+ 格

我可以以某种方式使用 jQuery 并`.load`更新每个 div 以显示其亲属文件（info.php?m=XXXXX）信息吗？

我在这个[http://jasonlau.biz/home/jquery/screw-a-jquery-plugin中找到了这个功能](http://jasonlau.biz/home/jquery/screw-a-jquery-plugin)

但我不想要懒惰的效果。就这样它从顶部开始加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:25:55.273

下面是一个如何使用 jQuery 进行操作的示例。`class`它找到具有名称 的所有元素并调用执行ajax 请求`movies`的 jQuery函数。`get`请求的响应可用作回调函数的第一个参数（`data`在本例中）。获得数据后，您可以使用 jQuery 的`html`函数将其添加到 DOM 元素中。

```
$(".movies").each(function(){ 
   // make a reference to the current div  
   var element = $(this);
   // get the url
   var url = element.attr('rel');
   // make ajax request
   $.get(url, function(data) {
      // append the data to the div
      element.html(data);
   });
}) 
```

请记住，HTML ID 应该是唯一的。在您的示例中，您有多个 div 的 id `movies`。您可以使用 ID 按 ID 选择元素`$('#movies')`，但它只会返回与 ID 匹配的第一个元素。如果您可以控制 HTML，那么每个 div 应该看起来更像这样：

`<div class="movies" rel="info.php?m=19923"></div>`

# c# - 我应该如何使用 C# 桥接 TCP 流量？需要复制一个端口上的流量并将其发送到另一个端口

> ID：13078523
> 
> 赞同：2
> 
> 时间：2012-10-25T22:50:50.023
> 
> 标签：c#, sockets, networking, tcpclient

我需要桥接来自一个端口（例如端口 3000）的流量并将其发送到一个新端口（例如端口 4000）并具有完整的双向 TCP 支持。

我应该如何解决这个问题？我应该使用套接字类还是 TCPClient 类？

这会像将数据流从一个 TCPClient 发送到另一个一样简单吗？

还有什么我应该考虑的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T06:20:24.287

您的程序需要同时充当服务器*和*客户端：

它应该在有关端口 3000 的服务器上运行，您的程序在该端口接收连接。每次收到新连接时，您自己都会在端口 4000 上创建一个到实际服务器的新连接。将这两个连接（一个在端口 3000 上启动的连接和您在端口 4000 上创建的一个连接）放在一起，这样您就知道它们是一对. 当您在这些连接中的任何一个上接收数据时，只需在该对中的另一个连接上发送它。

# tfs - TFS 2012：将二进制文件与构建和源代码相关联

> ID：13078526
> 
> 赞同：1
> 
> 时间：2012-10-25T22:50:54.923
> 
> 标签：tfs, auditing

我开始深入研究 TFS 2012，并且对这些层以及构建服务器、控制器和代理的工作方式以及不同的构建脚本如何具有不同的配置和项目有了基本的了解。

但是，我正在努力解决的一件事是对我们的源代码控制解决方案的要求，即我需要能够证明特定的变更集或货架集产生了特定的构建。也就是说，给定一个特定的二进制文件，我可以指向生成该二进制文件的发布变更集。我还应该能够指向合并到发布分支中的测试变更集。这里的想法不仅仅是职责分离，而是验证由于发布和测试变更集是相同的，代码审查员没有将代码注入项目中。

我读过[一篇](http://sstjean.blogspot.com/2008/01/reset-association-between-changesets.html)关于“二元促销”的博文——这个概念在我的情况下有用吗？我很难找到如何在 TFS 中设置此二进制促销。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T07:19:32.467

**部署**

开箱即用的 TFS 并不真正支持部署，它可以部署到构建时的 1 个位置，该位置通常是测试服务器（想想实验室管理）。TFS 2012 内置了对 Azure 部署的支持，但它们仍然发生在构建结束时，并且构建工件无法自动部署到新位置。

您可以修改构建模板以允许发布到不同的位置，但这仍然是每个环境的全新构建，而不是真正的二进制促销。

然而，TFS 确实有构建质量的概念，并且在质量发生变化时实际上会触发事件。 [TFS Deployer](http://tfsdeployer.codeplex.com)是一个第 3 方工具，它与质量更改事件挂钩并可以执行 powershell 脚本。这意味着只需简单更改下拉值，您就可以自动启动一个脚本，该脚本可以发布到您想要的任何环境。您可以将构建质量列表（每个团队集合）自定义为环境列表（开发、uat、登台、生产等），然后脚本会确定将特定构建发布到的位置。

VS2012 对 web 部署也有一些很好的改进，这意味着部署配置与项目一起存储在源代码控制中，这在理论上意味着它们可以在放置文件夹中供 TFS Deployer 使用。

我不相信 TFS 会保留构建质量的历史记录，这意味着您不能真正使用构建质量历史记录来维护部署到哪个环境的列表。不过，您可以很容易地将此​​信息记录为部署脚本的一部分。或者至少在构建中添加一个自定义摘要节点，其中包含有关发布的信息。

TFS2012 确实能够将构建标记为已部署为 Azure 部署功能的一部分，您可以使用脚本将[tfs 部署程序构建标记为已部署](http://tfsdeployer.codeplex.com/discussions/397983)，但感觉不是很有用。

[Octopus Deploy](http://octopusdeploy.com/)是另一个值得一试的项目，如果您的构建模板创建 NuGet 包，则可以使用它来代替 TFS Deployer。它需要对生产硬件进行更多控制，因为您需要在每个环境中安装代理来处理版本，但它解决了许多其他部署问题。

**版本控制**

一旦你有一个很好的一致的方式来自动发布人们不会绕过的，你可以考虑增强构建模板以注入构建版本，或者变更集编号作为作为该自动构建的一部分构建的任何东西的程序集版本。有许多不同的方法可以做到这一点，还有大量的[博客](http://blogs.msdn.com/b/jjameson/archive/2010/11/29/incrementing-the-assembly-version-for-each-build-in-tfs-2010.aspx) [文章](http://blog.irm.se/blogs/eric/archive/2012/06/03/Assembly-Versioning-in-a-TFS-Team-Build.aspx)和[工具](http://tfsversioning.codeplex.com/)可以帮助您实现这一目标。

或者，您可以使用自动程序集版本控制 ( `[assembly: AssemblyVersion("1.0.*")]`) 来为您提供构建发生的日期/时间，最终结果类似于 1.0.1234.123 其中 1234 类似于自 2000 年 1 月 1 日以来的天数，而 123 是自午夜以来的分钟数（我的具体情况这里可能是错的）。

如果您正在部署网站，那么我强烈建议您将当前的构建版本注入到 html 的某个地方。这样您就可以检查网站正在运行的版本，而无需访问 bin 目录。它也可以作为查询字符串附加到 css/js 文件导入中，以确保版本之间不会发生浏览器缓存。

**想法**

就我个人而言，我希望 Microsoft 意识到 xaml 构建工作流正在尝试做太多事情，并且它们将不同的关注点（构建、测试、部署......）分成不同的可编写脚本的部分。当然，这要等到 TFS 的下一个主要版本，也就是几年之后。尽管使用 Team Foundation Service，他们正在尝试更快地迭代，因此他们实际上可能会将 Azure 部署内容扩展为在不久的将来更有用的东西。

# javascript - 使用 d3.behavior.drag() 和变换时“口吃”拖动

> ID：13078535
> 
> 赞同：20
> 
> 时间：2012-10-25T22:51:48.843
> 
> 标签：javascript, d3.js

我正在尝试使用 d3.js 的`d3.behavior.drag()` `drag`事件来更新我的数据模型（不立即设置元素位置），然后运行我的“绘制”函数以根据更新的模型更新所有元素。此外，我`transform`在包含的 group 元素上使用了 translate 以移动与拖动对象关联的所有元素（我从下面链接的示例中删除了额外的元素）。这会导致被拖动的元素在被拖动时会卡住，拖得越快，情况就会越糟糕。

请参阅[jsFiddle 上的这个精简示例](http://jsfiddle.net/EMNGq/13/)。

这是示例的代码：

```
blocks = [
  { x: 0, y: 0 }
];

drag = d3.behavior.drag()
  .origin(Object)
  .on("drag", function(d) {
    d.x = d3.event.x;
    d.y = d3.event.y;
    draw();
  });

svg = d3.select("body")
  .append("svg:svg")
  .attr("width", 600)
  .attr("height", 600);

function draw() {
  g = svg.selectAll("g")
    .data(blocks);

  gEnter = g.enter().append("g");

  g.attr("transform", function(d) { return "translate("+d.x+","+d.y+")"; });

  gEnter.append("rect")
    .attr("height", 100)
    .attr("width", 100)
    .call(drag);
}

draw()​; 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-10-26T01:47:41.640

`drag`您正在调用`rect`元素，但您正在转换其父元素：`g`元素。

问题是拖动组件使用鼠标相对于父级的位置来确定新的`d3.event.x`和`d3.event.y`。因此，如果您`transform`在用户拖动时移动（即）父级，事情就会变得一团糟。

解决方案是调用`drag`您正在移动的相同元素；在这种情况下，`g`元素：

```
function draw() {
  g = svg.selectAll("g")
    .data(blocks);

  gEnter = g.enter().append("g")
    .call(drag);

  g.attr("transform", function(d) { return "translate("+d.x+","+d.y+")"; });

  gEnter.append("rect")
    .attr("height", 100)
    .attr("width", 100);
} 
```

请参阅更正的小提琴：http: [//jsfiddle.net/EMNGq/14/](http://jsfiddle.net/EMNGq/14/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-24T23:11:57.127

我和达尔文有同样的问题。拖动处理程序位于附加了 D3 数据的子对象上，但需要将转换应用于父组（而不是 d3）。

我通过将原点函数设置为返回 x:0, y:0 然后在事件中使用 x 值而不是 dx 来解决它。

例如

```
var drag = d3.behavior.drag()
    .origin(function(d,i) { return {x:0, y:0}; })
    .on("drag", function (d) {  movePosition(d3.event.x);   }); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-05T20:16:40.903

Nautat 为您的案例提供了很好的解决方案。

我的情况稍微复杂一些。我的数据绑定在我要转换的 g 节点之下。在这种情况下，我不能简单地将 .call(drag) 移动到 g 级别。

我提交了一个拉取请求以使基本坐标空间可定制： [https ://github.com/mbostock/d3/pull/1055](https://github.com/mbostock/d3/pull/1055)

# ios - UITableViewCell 显示问题

> ID：13078542
> 
> 赞同：0
> 
> 时间：2012-10-25T22:52:23.203
> 
> 标签：ios, uitableview

编辑：与 NSAttributedString、OHAttributedLabel 或 TTTAttributedLabel 无关！

简短的问题：我在使用*UILabel、* OHAttributedLabel 或 TTTAttributedLabel 时遇到同样的问题 - 滚动表格视图会破坏标签的显示。更多关于下面...

长格式：我有一个 NSAttributedString 对象，表示来自推文的文本。我已经根据推文中的各种内容修饰了字符串（例如，主题标签为蓝色，url 为绿色并带下划线，用户提及为红色）。

例如，这条推文：

```
 @MeetGreen Keep up the good work. Say Hi to Nancy for me - she convinced me that I can be green and save green at the same time! 
```

导致这个 NSAttributedString: （使用我编写的实用程序显示以帮助我查看发生了什么）：

```
@MeetGreen{
    NSColor = "UIDeviceRGBColorSpace 1 0 0 1";
    NSFont = "<UICFFont: 0x93c57d0> font-family: \"Helvetica\"; font-weight: normal; font-style: normal; font-size: 17px";
} Keep up the good work. Say Hi to Nancy for me - she convinced me that I can be green and save green at the same time!{
    CTForegroundColor = "<CGColor 0x93c8f20> [<CGColorSpace 0x938b570> (kCGColorSpaceDeviceGray)] ( 0 1 )";
    NSFont = "<UICFFont: 0x93c57d0> font-family: \"Helvetica\"; font-weight: normal; font-style: normal; font-size: 17px";
} 
```

生成 NSAttributedString 对象的代码似乎正在做我希望它做的事情，但是当我尝试在 UILabel（或 TTTAttributedLabel 或 OHAttributedLabel）中显示此对象时，我无法说服它正常工作。主要问题似乎是滚动行为 - 单元格无法正确绘制（文本处于某个奇怪的位置）。但是，如果我只是选择单元格（例如，通过触摸它），则单元格将完全按照应有的方式绘制。这让我认为问题在于我的委托方法中的表格滚动处理，而不是属性标签本身（因为 OHAttributedLabel 和 TTTAttributedLabel 的行为相同），但我不确定为什么会这样。（我还没有尝试过的一件事是纯文本和用于推文内容的纯 UILabel - 这是今晚的列表。**好的，UILabel 和纯文本内容的行为相同。我究竟做错了什么？？？**)

这是我的代码 tableView:cellForRowAtIndexPath:, tableView:heightForRowAtIndexPath: 和 tableView:didSelectRowAtIndexPath:; 请注意，此代码位于 UIViewController 子类中，而不是 UITableViewController 的子类中。

```
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    TweetingTweetCell *cell = [tableView dequeueReusableCellWithIdentifier:@"Tweet"];

    TSTweet *tweet = [self.model tweetAtIndexPath:indexPath];

    cell.userHandleLabel.text = tweet.user.screenName;
    cell.userNameLabel.text = tweet.user.name;
    cell.timestampLabel.text = timeStamp;
    cell.tweetTextLabel.attributedText = [self.model decoratedStringForTweetAtIndexPath:indexPath];

    UIImage *image = [UIImage imageNamed:@"avatar"];

    cell.userImage.image = image;

    return cell;
}

-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    CGFloat tweetHeight = [self.model heightForTweetAtIndexPath:indexPath
                                                     usingWidth:label_width];

    CGFloat height = tweetHeight + label_headroom + label_footroom;

    CGFloat result = MAX(height,defaultHeight);

    NSLog(@"[%@ %@] %@ (%@)\ntweetHeight=%f, height=%f, defaultHeight=%f, result=%f", NSStringFromClass([self class]), NSStringFromSelector(_cmd),indexPath,[self.model decoratedStringForTweetAtIndexPath:indexPath].string,tweetHeight,height,defaultHeight,result);

    return result;
}

-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSLog(@"[%@ %@] indexPath=%@", NSStringFromClass([self class]), NSStringFromSelector(_cmd),indexPath);

    TweetingTweetCell *cell = (TweetingTweetCell *)[tableView cellForRowAtIndexPath:indexPath];

    NSLog(@"decoratedString=%@",[self.model decoratedStringForTweetAtIndexPath:indexPath]);
    [cell dumpDebugInfo];
    [tableView deselectRowAtIndexPath:indexPath
                             animated:NO];
} 
```

TweetingTweetCell 是 UITableViewCell 的子类，它包含 4 个对象：用于头像的 UIImageView、用于发送者屏幕名称的 UILabel、用于发送时间的 UILabel 以及用于推文内容的“标签”对象。正如我上面所说，我已经尝试过 OHAttributedLabel 和 TTTAttributedLabel 并且行为是相同的。

坏滚动：

![奇怪的卷轴](../Images/6fc422fe5da1396761a4f86ce45ae373.png)

*   文本和屏幕名称之间的所有空白都很奇怪。

选择时：

![通过选择固定](../Images/e689df14f236c957c1a49ffb764399f3.png)

*   看看定位是如何固定的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:42:31.860

已解决 - 飞行员错误。问题是弹簧/支柱的邪恶阴谋以及我如何设置标签的大小。

上面介绍的 tableView:heightForRowAtIndexPath: 代码按预期工作。我做了两个影响结果行为的更改：

1.  我在 tableView:cellForRowAtIndexPath: 中添加了代码来设置 tweetTextLabel 的高度，即：

    ```
    CGRect rect = cell.tweetTextLabel.frame;
    rect.size.height = [self.model heightForTweetAtIndexPath:indexPath
                                                  usingWidth:label_width];
    cell.tweetTextLabel.frame = rect; 
    ```

2.  我关闭了右侧和底部支柱以及 tweetTextLabel 上的垂直弹簧（在 IB 中）。

这两个更改使初始演示文稿和滚动行为正确。

# java - 如何在继续方法之前暂停

> ID：13078548
> 
> 赞同：1
> 
> 时间：2012-10-25T22:52:58.353
> 
> 标签：java, methods, delay

现在，我知道有人问过这个问题，但我需要知道如何在 html 或任何东西上执行此操作。这是我的代码，不包括所有其他 java 文件。

```
package rtype;

import java.awt.Image;
import java.awt.event.KeyEvent;

import java.util.ArrayList;

import javax.swing.ImageIcon;

public class aa {
private int xd;
private int yd;
private int dx;
private int dy;
private int x;
private int y;
private Image image;

private ArrayList missiles;

private final int CRAFT_SIZE = 70;

public aa() {
    ImageIcon ii = new ImageIcon(this.getClass().getResource("/aa.png"));
    image = ii.getImage();
    missiles = new ArrayList();
    x = 10;
    y = 10;
    xd = -14;
    yd = 140;
}

public void move() {
    if(y >=xd)
        y += dx;
    else if(y < xd)
        y += 1;
    if(y <=yd)
        y += dy;
    else if(y > yd)
        y += -1;
}

public int getX() {
    return x;
}

public int getY() {
    return y;
}

public Image getImage() {
    return image;
}

public ArrayList getMissiles() {
    return missiles;
}

public void keyPressed(KeyEvent e) {

    int key = e.getKeyCode();

    if (key == KeyEvent.VK_SPACE) {
        fire();
    }

    if (key == KeyEvent.VK_UP) {
        dy = -1;
    }

    if (key == KeyEvent.VK_DOWN) {
        dy = 1;
    }

    if (key == KeyEvent.VK_RIGHT) {
        yd++;
    }

    if (key == KeyEvent.VK_LEFT) {
        yd--;
    }

    if (key == KeyEvent.VK_W) {
        xd++;
    }

    if (key == KeyEvent.VK_S) {
        xd--;
    }
}

public void fire() {
    try{
    missiles.add(new Missle(x + CRAFT_SIZE, y + CRAFT_SIZE));
    }catch(Exception e){}
}

public void keyReleased(KeyEvent e) {
    int key = e.getKeyCode();

    if (key == KeyEvent.VK_UP) {
        dy = 0;
    }

    if (key == KeyEvent.VK_DOWN) {
        dy = 0;
    }
}
} 
```

因此，在 fire() 方法中，我想让它在两次拍摄之间延迟。如何？

对不起，如果这是 n00bish

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:12:04.273

正如已经指出的那样，`Thread.sleep()`是您问题的直接答案。

但是，查看您的代码，我可以看到您想使用它来为动画计时，这`Thread.sleep()`不是一个好主意。（这里不想讲太多细节，试试看，没有坏处，你很快就会明白为什么。）

相反，您应该拥有的是一个三部分系统：

1.  第一部分处理输入并将其转换为命令。命令立即放入队列中。
2.  第二部分是游戏引擎线程。顾名思义，这是一个单独的线程，它自己计时（“心跳”）。你当然可以`Thread.sleep()`在这里使用，记住它有时会非常不准确。该引擎从队列中获取命令，处理它们并更新内部游戏状态（例如坐标）。
3.  第三部分是显示更新线程。同样，这是与上述两个线程不同的线程，它也会有自己独立的心跳，它可能以与游戏引擎不同的速度运行，因为您可能希望比显示更频繁地更新游戏的内部状态. 这是处理实际图像和绘图的位。

我知道一开始这听起来像是很多工作，但它比你必须做的工作少得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T22:55:45.107

您可以使用`Thread.sleep(1000);`休眠 1000 毫秒（1 秒）。

请注意，您必须捕获 InterruptedException：

```
try {
    Thread.sleep(1000);
} catch (InterruptedException e) {
    // Handle here
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-06T17:02:18.487

尝试`Thread.sleep(1000)`每一千是一秒，例如，如果你想要它 5sec `Thread.sleep(5000)` 希望我帮助你！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T22:55:34.497

```
Thread.sleep(x); 
```

`x`以毫秒为单位。有关更多信息，请参阅[sleep() 教程](http://docs.oracle.com/javase/tutorial/essential/concurrency/sleep.html)。

# php - PHP 将 X-Msg 附加到链接

> ID：13078553
> 
> 赞同：1
> 
> 时间：2012-10-25T22:53:36.400
> 
> 标签：php, html, forms, email, hyperlink

我正在尝试制作一个在线系统，人们可以在其中从系统内发送线索 html 电子邮件......

除了在富文本编辑器中添加链接时，我的一切都正常工作，并且源代码中的一切看起来都很好，但是当我查看收件箱中的电子邮件时，链接不起作用并已更改为：

> x-msg://30/%22http://example.com/%22

我不明白...

我认为这是 html post 功能的问题，因为我通过`$_POST`方法提交它并使用 html 表单...当我在下一页上回显语句时，链接是*`http://workwithmandy.co/%22http://phobes.com/%22`*，这很奇怪，因为网站的根目录系统已开启*`http://workwithmandy.co/`*。

关于为什么会这样的任何想法？

**这是表格：**

```
<form action="<?php echo $editFormAction; ?>" method="POST" name="form" id="sendemailform">
          <fieldset>
          <div class="emailtablecontainer">
          <table width="525" border="0" cellspacing="10">
  <tr>
    <td><label>To:</label></td>
    <td><select data-placeholder="Select Lead(s) To Email..." multiple="true" class="chzn-container-multi" name="selectleads"style="width:500px;">
            <?php
do {  
?>
            <option value="<?php echo $row_rsAllLeads['Email']?>"><?php echo $row_rsAllLeads['FullName']?></option>
            <?php
} while ($row_rsAllLeads = mysql_fetch_assoc($rsAllLeads));
  $rows = mysql_num_rows($rsAllLeads);
  if($rows > 0) {
      mysql_data_seek($rsAllLeads, 0);
      $row_rsAllLeads = mysql_fetch_assoc($rsAllLeads);
  }
?>
          </select></td>
  </tr>
  <tr>
    <td><label>Subject:</label></td>
    <td><input class="inputs" name="subjectfield" type="text"></td>
  </tr>
  <tr>
    <td><label>Message:</label></td>
    <td><textarea id="sendemailtextarea" name="messagefield"></textarea></td>
    <script>
    CKEDITOR.replace( 'sendemailtextarea',
    {
        toolbar : 'SendEmailToolbar'
    });
    </script>
  </tr>
</table>
</div>
<input class="submitemailbuttonsprite submitemailbutton1" name="submitemail" type="submit" value="Send Email(s)">
          </fieldset>
          <input type="hidden" name="MM_insert" value="form">
          </form> 
```

**这是实际的 PHP 代码：**

```
<?php
$editFormAction = $_SERVER['PHP_SELF'];
if (isset($_SERVER['QUERY_STRING'])) {
  $editFormAction .= "?" . htmlentities($_SERVER['QUERY_STRING']);
}

if ((isset($_POST["MM_insert"])) && ($_POST["MM_insert"] == "form")) {
    echo $_POST['messagefield'];
 $to = $_POST['selectleads'];
 $subject = $_POST['subjectfield'];
 $body = $_POST['messagefield'];
 $headers = "MIME-Version: 1.0\r\n"; 
 $headers .= "Content-type: text/html; charset=iso-8859-1\r\n"; 
 $headers .= "From: " . $row_rs_CurrentUser['FirstName'] . " " . $row_rs_CurrentUser['LastName'] . " <" . $row_rs_CurrentUser['Email'] . ">";
 if (mail($to, $subject, $body, $headers)) {
  } else {
   echo("<p>Message delivery failed...</p>");
  }
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-15T04:45:07.780

我知道现在回答这个问题为时已晚。但它可能会帮助其他有需要的人。

这不像 PHP Prepends`x-msg://`到电子邮件链接。

实际上，电子邮件客户端会添加`x-msg://`到链接。因为他们采用没有URI`http://`或`https://`无效 URI 的链接。为了使其有效，它们`x-msg://`会添加到链接中。

因此，请检查您是否错过了`http://`或`https://`在您的 href 链接中。

示例：第一个示例可能无法正常工作：

```
<a href="www.example.com">www.example.com</a> // x:msg:// may be prepended by some of the email clients 
```

这肯定会正常工作：

```
<a href="http://www.example.com">www.example.com</a> // x:msg:// will not be prepended by any email client 
```

# sql-server-2008 - 多种收款人

> ID：13078556
> 
> 赞同：1
> 
> 时间：2012-10-25T22:53:47.353
> 
> 标签：sql-server-2008, data-warehouse, business-intelligence, msas

我向各种收款人付款，我想知道是否应该为每种收款人创建一个维度并在我的事实表中有多个外键，或者通过类型属性将各种收款人混为一谈并拥有一个 FK在 PaymentFact 表中，代价是在 PayeeDim 表中对于 PayeeDim.Type 的任何特定值都没有任何意义的属性...

这些情况通常如何处理？

TIA-e

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T14:14:01.780

与维度建模一样，答案是“视情况而定”。如果替代方案是具有 15-20 个维度的事实表，则通常最好有一个具有一堆空属性的维度。

对于业务来说，如果一个 Payee 是一个 payee，并且有几种 payee 类型，那么有一个 payee 维度是有意义的。但是，如果一个付款记录可以与多种不同“类型”的收款人相关联，那么每个点心都应该获得自己的事实密钥。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T15:05:58.637

一种选择是具有两个维度 - 一个带有 Payee 信息，另一个带有 Payee_Type 信息。

# php - 水平样式化 Wordpress 小部件

> ID：13078562
> 
> 赞同：3
> 
> 时间：2012-10-25T22:54:36.727
> 
> 标签：php, html, css, wordpress, wordpress-theming

我目前正在从新的 212 Wordpress 网站上整合一个儿童[主题](http://wordpress.org/extend/themes/twentytwelve)。该网站的响应性具有流体/液体结构（使用百分比而不是像素的固定宽度 - 这与我可能必须如何设置小部件的样式有关）。

在我的模板顶部，我想包含一个小部件区域，用户/管理员可以在其中从提供的列表中的可用小部件中拖放项目。

理想情况下，由于本节站点的设计和布局是在水平面上，因此三个小部件在空间上看起来会很好看。

但是，如果用户想添加更多，我认为我需要使用 PHP 或 JavaScript 来计算节标记中是否有一定数量的 div/classes/id，例如，将 CSS 宽度从33.33%（3 个小部件）到 25%（4 个小部件）或 50% 是否有两个等？

我如何能够为每个小部件提供等间距的宽度并将它们彼此相邻放置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:07:16.643

有点乱，但这是一个开始：

```
<?php
$widgets = wp_get_sidebars_widgets();
$percentage = !empty($widgets['header-widget-area']) ? floor(100/count($widgets['header-widget-area'])) : 100;
?>
<style type="text/css">
hgroup .widget{
    width:<?php echo $percentage; ?>% !important;
    float:left;
}
</style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-29T12:47:11.283

这可以使用 Bootstrap Grid View 来完成。
完整的细节可以在[这里](http://getbootstrap.com/css/#grid-example-basic)找到。

理论上，Bootstrap 网格默认有 12 列。
如果您想要连续 3 列，则将 12 除以 4。
它将连续产生 3 列。您可以在 Bootstrap Grid Link 上查看示例。

# javascript - 在Javascript中使用单引号和双引号转义和取消转义字符串

> ID：13078572
> 
> 赞同：1
> 
> 时间：2012-10-25T22:55:58.817
> 
> 标签：javascript, php, jquery, escaping, html-escape-characters

我有一个搜索框，用户可以搜索任何字符串，包括单引号和双引号，一旦他们搜索，后端会将关键字传回给我，这样我就可以把它放回框中。我不知道字符串是什么，所以我自己无法转义引号，下面是一个示例：

```
var keyword = "hello";
$("#selectionkeywords").val(); 
```

我遇到的问题是，如果用户输入“hello”，则关键字变为“”hello””，我收到此错误：

```
missing ) after argument list
[Break On This Error]   
jQuery("#selectionkeywords").val(""hello""); 
```

用户还可以输入单引号，以便也排除它。我尝试使用 escape unescape 但我仍然有同样的问题，例如 escape(""hello"") 我可以以非转义格式获取值，例如 "hello" 但我不知道如何处理它，escape 不会努力工作我最终得到了这个 %26%23034%3Bhello%26%23034%3B

所以我现在几乎被困住了，因为我无法对字符串做任何事情，有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T23:15:43.480

您必须转义字符串服务器端，因此 javascript 接收它已经转义，在 PHP 的情况下，您可以这样做：

```
$var = str_replace('"', '\"', $var); 
```

然后在javascript中确保你在双引号之间阅读它，因为你为此转义：

```
//use double quotes, as you escaped for them
jQuery("#selectionkeywords").val("<?php echo $var ?>"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T23:30:08.550

当您从服务器到客户端交换数据时，反之亦然，您希望使用 base64 编码和解码，以避免此类问题和其他类型的问题。

**Java端：**

```
import javax.xml.bind.DatatypeConverter;

/* ... */

/* Decode input from client */
String input = DatatypeConverter.printBase64Binary(inputFromClient);

/* Encode output for client */
String output = DatatypeConverter.printBase64Binary(encodedOutput); 
```

**Javascript方面：**

```
// Encode data for the server
var dataForServer = Base64.encode(data);

// Decode data coming from the server
var data = Base64.decode(dataFromServer); 
```

使用这个类

```
var Base64 = {

    // private property
    _keyStr : "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",

    // public method for encoding
    encode : function (input) {
        var output = "";
        var chr1, chr2, chr3, enc1, enc2, enc3, enc4;
        var i = 0;

        input = Base64._utf8_encode(input);

        while (i < input.length) {

            chr1 = input.charCodeAt(i++);
            chr2 = input.charCodeAt(i++);
            chr3 = input.charCodeAt(i++);

            enc1 = chr1 >> 2;
            enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
            enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
            enc4 = chr3 & 63;

            if (isNaN(chr2)) {
                enc3 = enc4 = 64;
            } else if (isNaN(chr3)) {
                enc4 = 64;
            }

            output = output +
            this._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) +
            this._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);

        }

        return output;
    },

    // public method for decoding
    decode : function (input) {
        var output = "";
        var chr1, chr2, chr3;
        var enc1, enc2, enc3, enc4;
        var i = 0;

        input = input.replace(/[^A-Za-z0-9\+\/\=]/g, "");

        while (i < input.length) {

            enc1 = this._keyStr.indexOf(input.charAt(i++));
            enc2 = this._keyStr.indexOf(input.charAt(i++));
            enc3 = this._keyStr.indexOf(input.charAt(i++));
            enc4 = this._keyStr.indexOf(input.charAt(i++));

            chr1 = (enc1 << 2) | (enc2 >> 4);
            chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
            chr3 = ((enc3 & 3) << 6) | enc4;

            output = output + String.fromCharCode(chr1);

            if (enc3 != 64) {
                output = output + String.fromCharCode(chr2);
            }
            if (enc4 != 64) {
                output = output + String.fromCharCode(chr3);
            }

        }

        output = Base64._utf8_decode(output);

        return output;

    },

    // private method for UTF-8 encoding
    _utf8_encode : function (string) {
        string = string.replace(/\r\n/g,"\n");
        var utftext = "";

        for (var n = 0; n < string.length; n++) {

            var c = string.charCodeAt(n);

            if (c < 128) {
                utftext += String.fromCharCode(c);
            }
            else if((c > 127) && (c < 2048)) {
                utftext += String.fromCharCode((c >> 6) | 192);
                utftext += String.fromCharCode((c & 63) | 128);
            }
            else {
                utftext += String.fromCharCode((c >> 12) | 224);
                utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                utftext += String.fromCharCode((c & 63) | 128);
            }

        }

        return utftext;
    },

    // private method for UTF-8 decoding
    _utf8_decode : function (utftext) {
        var string = "";
        var i = 0;
        var c = c1 = c2 = 0;

        while ( i < utftext.length ) {

            c = utftext.charCodeAt(i);

            if (c < 128) {
                string += String.fromCharCode(c);
                i++;
            }
            else if((c > 191) && (c < 224)) {
                c2 = utftext.charCodeAt(i+1);
                string += String.fromCharCode(((c & 31) << 6) | (c2 & 63));
                i += 2;
            }
            else {
                c2 = utftext.charCodeAt(i+1);
                c3 = utftext.charCodeAt(i+2);
                string += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));
                i += 3;
            }

        }

        return string;
    }

} 
```

# c# - 使用实体框架批量插入和更新（可能是更好的选择？）

> ID：13078576
> 
> 赞同：0
> 
> 时间：2012-10-25T22:56:26.430
> 
> 标签：c#, entity-framework, insert, sql-update, bulkinsert

我有一个设备、地址和公司的数据集，需要导入到我们的数据库中，并发现我们的数据库可能已经包含新数据集中包含的特定设备/地址/公司。如果是这种情况，我需要使用数据集中的新信息更新该条目，不包括地址。我们检查该地址的精确副本是否存在，否则我们创建一个新条目。

我的问题是尝试在 EF 中获取设备/公司非常慢，如果存在则更新它，否则插入它。为了解决这个问题，我尝试获取所有公司、设备和地址，并将它们插入到各自的 hashmap 中，并检查新数据的标识符是否存在于 hashmap 中。这并没有导致任何性能提升。我在下面包含了我的代码。通常我会进行批量插入，但我不确定我会为批量更新做什么。有人可以建议不同的路线吗？

```
 var context = ObjectContextHelper.CurrentObjectContext;
            var oldDevices = context.Devices;
            var companies = context.Companies;
            var addresses = context.Addresses;

            Dictionary<string, Company> companyMap = new Dictionary<string, Company>(StringComparer.OrdinalIgnoreCase);
            Dictionary<string, Device> deviceMap = new Dictionary<string, Device>(StringComparer.OrdinalIgnoreCase);
            Dictionary<string, Address> addressMap = new Dictionary<string, Address>(StringComparer.OrdinalIgnoreCase);
            foreach (Company c in companies)
            {
                if (c.CompanyAccountID != null && !companyMap.ContainsKey(c.CompanyAccountID))
                    companyMap.Add(c.CompanyAccountID, c);
            }
            foreach (Device d in oldDevices)
            {
                if (d.SerialNumber != null && !deviceMap.ContainsKey(d.SerialNumber))
                    deviceMap.Add(d.SerialNumber, d);
            }
            foreach (Address a in addresses)
            {
                string identifier = GetAddressIdentifier(a);
                if (!addressMap.ContainsKey(identifier))
                    addressMap.Add(identifier, a);
            }

            foreach (DeviceData.TabsDevice device in devices)
            {
                // update a device
                Company tempCompany;
                Address tempAddress;
                Device currentDevice;
                if (deviceMap.ContainsKey(device.SerialNumber)) //update a device
                    deviceMap.TryGetValue(device.SerialNumber, out currentDevice);
                else // insert a new device
                    currentDevice = new Device();
                currentDevice.SerialNumber = device.SerialNumber;
                currentDevice.SerialNumberTABS = device.SerialNumberTabs;
                currentDevice.Model = device.Model;
                if (device.CustomerAccountID != null && device.CustomerAccountID != "")
                {
                    companyMap.TryGetValue(device.CustomerAccountID, out tempCompany);
                    currentDevice.CustomerID = tempCompany.CompanyID;
                    currentDevice.CustomerName = tempCompany.CompanyName;

                }
                if (companyMap.TryGetValue(device.ServicingDealerAccountID, out tempCompany))
                    currentDevice.CompanyID = tempCompany.CompanyID;
                currentDevice.StatusID = 1;
                currentDevice.Retries = 0;
                currentDevice.ControllerFamilyID = 1;
                if (currentDevice.EWBFrontPanelMsgOption == null) // set the Panel option to the default if it isn't set already
                    currentDevice.EWBFrontPanelMsgOption = context.EWBFrontPanelMsgOptions.Where( i => i.OptionDescription.Contains("default")).Single();
                // link the device to the existing address as long as it is actually an address
                if (addressMap.TryGetValue(GetAddressIdentifier(device.address), out tempAddress))
                {
                    if (GetAddressIdentifier(device.address) != "")
                        currentDevice.Address = tempAddress;
                    else
                        currentDevice.Address = null;
                }
                else // insert a new Address and link the device to it (if not null)
                {
                    if (GetAddressIdentifier(device.address) == "")
                        currentDevice.Address = null;
                    else
                    {
                        tempAddress = new Address();
                        tempAddress.Address1 = device.address.Address1;
                        tempAddress.Address2 = device.address.Address2;
                        tempAddress.Address3 = device.address.Address3;
                        tempAddress.Address4 = device.address.Address4;
                        tempAddress.City = device.address.City;
                        tempAddress.Country = device.address.Country;
                        tempAddress.PostalCode = device.address.PostalCode;
                        tempAddress.State = device.address.State;
                        addresses.AddObject(tempAddress);
                        addressMap.Add(GetAddressIdentifier(tempAddress), tempAddress);
                        currentDevice.Address = tempAddress;
                    }
                }
                if (!deviceMap.ContainsKey(device.SerialNumber)) // if inserting, add to context
                {
                    oldDevices.AddObject(currentDevice);
                    deviceMap.Add(device.SerialNumber, currentDevice);
                }
            }
            context.SaveChanges(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:26:47.187

尽管它没有涵盖您的确切问题，[但该线程](https://stackoverflow.com/questions/5940225/fastest-way-of-inserting-in-entity-framework)已帮助我极大地提高了数据库导入的性能，我建议您阅读它。

如果你有很多散列，使用任务并行库可能会有所帮助。我们还使用哈希映射来映射 ID，这很有帮助。但我建议您将 {} 锁定在 SaveChanges() 上，这样您就不会遇到并发问题（因此，TPL 仅在您进行大量散列和转换时才有帮助 - 在我们的例子中，它有很大帮助，因为我们不得不做相当多的解析）。

# mysql - 数据库（MySQL）结构化：多表的优缺点

> ID：13078577
> 
> 赞同：0
> 
> 时间：2012-10-25T22:56:27.350
> 
> 标签：mysql, database

我正在收集数据并将其存储在 MySQL 中，用于：

*   75 个变量
*   55个国家
*   每年

在这个阶段，自从我构建这个工具以来，我已经创建了一个变量/国家的单一表格（存储 1 年的数据）。

明年（以及之后的几年）将为每个国家输入一组新数据。

因此，在控制返回给查看所有收集数据的用户的数据中存在 3 个变量。任何查询的一般形式是：

*   给我看**这些**具体的变量，**这些**具体的国家，**这些**具体的年份。

（例如，显示 2012 年和 2009 年美国和加拿大的平均年龄和体重）

我的问题是，似乎我有两种选择来安排这些数据： - 多个表，我为收集的每一年数据创建一个*国家/变量*表 - 单个表并简单地为该数据的年份添加一个列（字段）涉及到。

据我所知，我可以使用任何一种结构进行这些数据库调用，但是一种更强大/更高效/更快，为什么？

感谢您的考虑。

如果这是相关的，它是一个 PDO / PHP 接口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:10:42.687

使用关系方法通常涉及更多表。这转化为查询速度更慢（尽管在小型数据库中可能不明显）并且数据库大小更小。这使得正确更新信息变得更简单，从而确保数据完整性。例如，如果 Joe 的地址发生更改，您知道所有使用 Joe 的地址的报告都会更改。

使用较少的链接表，其中一个字段可以重复多次，您可能会在不同表中的数据之间存在差异，而您自然希望它是相等的。如果您正确安排表格，访问速度应该会快一点，因为您的信息将根据您访问它的方式进行分组。

例如，在第一种方法中，您将有一个`Orders`带有`Supplier`和表的`Client`表来制作完整的发票，而在第二种方法中，您希望将两者的一些信息放在`Supplier`表`Client`中`Orders`，以便访问找到与发票对应的行您正在寻找的数字将返回您需要的整个数据集（从而消除了连接的需要`Supplier`并`Client`减少了数据库服务器上的负载）。

编辑：我认为更好的答案需要更多关于您的数据的信息（例如样本）。

# javascript - 在不触发该事件处理程序的情况下执行 javascript 事件

> ID：13078579
> 
> 赞同：8
> 
> 时间：2012-10-25T22:56:39.923
> 
> 标签：javascript, events, event-handling

`focus`在我最新的代码中，我在 textarea 上有一个事件处理程序。当用户点击 textarea 时，会触发该事件处理程序，它会根据选定的 textarea 设置一些其他 DOM 状态。但是，在我的程序的其他地方，我想以编程方式设置`focus`textarea 而不触发该事件处理程序。例如，我知道 Backbone 有一种`silently`执行操作的方法。

我唯一的伪解决方案是临时设置一个变量：

```
var silence = true; 
```

然后，在我的事件处理程序中，只有当静默为假时才执行逻辑。处理程序仍然被触发，但逻辑没有运行。

还有其他人知道更好的策略吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T23:33:26.633

你可以暂时`unbind()`的事件，像这样：

您有以下处理焦点事件的场景：

```
function focus_handler() {
   //focus handler code
   ...
   ...
}

$('#yourelement').bind('focus', focus_handler); 
```

现在在您希望以编程方式聚焦元素而不触发事件处理程序的代码部分：

```
$('#yourelement').unbind('focus');
$('#yourelement').focus();
$('#yourelement').bind('focus', focus_handler); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T23:38:51.790

```
<input type="text" name="input" id="input" value="0">
<input type="text" name="input" id="input2" value="0">

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript"></script>
<script>
$(function() {

$('#input').focus(function(a,b) {
   if (b) alert('forced');
});

$('#input').trigger('focus', jQuery.Event("focus"));

});
</script> 
```

当`b`事件处理程序的参数存在时，通过调用来触发事件`$('#input').trigger('focus', jQuery.Event("focus"));`。所以你可以让你的处理函数根据正常焦点或强制焦点执行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-09-12T12:16:02.710

在 jQuery 中，`trigger()`可以采用事件命名空间。只有与此命名空间绑定的事件和默认行为才会被触发。

例如：

```
$('#yourelement').trigger('focus.anyOldNonsense'); 
```

应该可以解决问题（前提是没有人使用“anyOldNonsense”作为事件命名空间）。

编辑：这适用于 1.7.2 和 1.8.3，但在 1.9 及更高版本中存在一个[已知错误，用于将数据和命名空间添加到“焦点”事件。](http://bugs.jquery.com/ticket/13428)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-29T22:57:09.677

由于您无法阻止事件的发生，因此您需要某种中介来决定是否发出事件。因此，您将让中介监听所有焦点事件，并且您必须告诉该中介是否重新发出该事件。然后你会直接听那个中介而不是 dom 节点。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-12-01T08:55:45.160

```
<a href='javscript:void()' onClick="()=>myFunction(myParams)">click here</a> 
```

试试这个 hack 来设置带有参数的 onClick 函数，而不是在实例化时触发它们。

# c# - 对象引用未设置为对象的实例 - 链接列表示例

> ID：13078580
> 
> 赞同：1
> 
> 时间：2012-10-25T22:56:40.533
> 
> 标签：c#

我看到以下错误：

> 你调用的对象是空的！
> 
> 在调用方法之前检查以确定对象是否为空！

我为排序链接列表制作了一个小型测试程序。这是错误出现的代码！

```
 public void Insert(double data)
    {
        Link newLink = new Link(data);
        Link current = first;
        Link previous = null;

        if (first == null)
        {
            first = newLink;
        }

        else
        {
            while (data > current.DData && current != null)
            {
                previous = current;
                current = current.Next;
            }

            previous.Next = newLink;
            newLink.Next = current;
        }
    } 
```

它说当前的引用是 null `while (data > current.DData && current != null)`，但我分配了它：`current = first;`

剩下的就是程序的完整代码了！

```
class Link
{
    double dData;
    Link next=null;

    public Link Next
    {
        get { return next; }
        set { next = value; }
    }

    public double DData
    {
        get { return dData; }
        set { dData = value; }
    }

    public Link(double dData)
    {
        this.dData = dData;
    }

    public void DisplayLink()
    { 
    Console.WriteLine("Link : "+ dData);
    }

}

class SortedList
{
    Link first;

    public SortedList()
    { 
        first = null;
    }

    public bool IsEmpty()
    {
        return (this.first == null);
    }

    public void Insert(double data)
    {
        Link newLink = new Link(data);
        Link current = first;
        Link previous = null;

        if (first == null)
        {
            first = newLink;
        }

        else
        {
            while (data > current.DData && current != null)
            {
                previous = current;
                current = current.Next;
            }

            previous.Next = newLink;
            newLink.Next = current;
        }
    }

    public Link Remove()
    {
        Link temp = first;
        first = first.Next;
        return temp;
    }

    public void DisplayList()
    {
        Link current;
        current = first;

        Console.WriteLine("Display the List!");

        while (current != null)
        {
            current.DisplayLink();
            current = current.Next;
        }
    }
}

class SortedListApp
{
    public void TestSortedList()
    {
        SortedList newList = new SortedList();
        newList.Insert(20);
        newList.Insert(22);
        newList.Insert(100);
        newList.Insert(1000);
        newList.Insert(15);
        newList.Insert(11);

        newList.DisplayList();
        newList.Remove();
        newList.DisplayList();

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:02:59.597

同意你已经完成

```
current = first; 
```

但是你的课程的开头首先是空的

```
class SortedList
{
    Link first; 
```

请分配一些东西，`first`否则它将为空

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T23:07:31.890

您可能会假设 while 循环在第一次迭代时中断，这并不是 while 循环中的赋值最终会中断它。

根据您的代码，最终 current 为 NULL，您甚至可以对其进行测试 - 将其更改为此应该没问题：

```
while (current != null && data > current.DData)
{
    previous = current;
    current = current.Next;
} 
```

# haskell - Haskell 递归 ":" 替换为 || 为什么？

> ID：13078583
> 
> 赞同：3
> 
> 时间：2012-10-25T22:57:06.133
> 
> 标签：haskell, recursion

我有一个问题，为什么这个函数不能与“：”一起使用，但可以与 || 一起使用 以及为什么将“：”替换为|| 我的意思是为什么不能写

## 包含 xs (y:ys) = 前缀 xs (y:ys) : 包含 xs ys

```
 contains :: String -> String -> Bool
 contains [] _ = True
 contains _ [] = False
 contains xs (y:ys) = prefix xs (y:ys) || contains xs ys 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T23:18:20.937

**关键思想**

用于`:`建立一个列表答案，`||`或`&&`建立一个真/假答案，和/`+`或`*`建立一个数字答案。想想你正在结合什么——它不必一直`:`都是。

**细节**

我想你的意思是问为什么你不能写

```
contains xs (y:ys) = prefix xs (y:ys)  :  contains xs ys 
```

`:`用于将元素粘合到列表的前面，因此它具有 type `a -> [a] -> [a]`。这意味着你在左边放一个东西，在右边放一个列表。您经常在编写递归函数时使用它，例如，您可以定义

```
increase :: [Int] -> [Int]
increase [] = []
increase (x:xs) = x + 5 : increase xs 
```

这`x + 5`是一个`Int`和`increase xs`是一个`[Int]`。

让我们看看你的功能。它的类型是`contains :: String -> String -> Bool`这样的，它需要一个字符串，然后是一个字符串，然后给你一个布尔值。之后`=`你就得到了`prefix xs (y:ys)`。现在`prefix`有相同的类型：`prefix :: String -> String -> Bool`，所以现在我们给了它`xs`，`(y:ys)`它给了我们一个布尔值。

在行的末尾，我们也得到了`contains xs ys`一个布尔值，所以如果我们把它们放在`:`它们之间，我们就会得到一些类似的东西

```
False : True 
```

但我们不允许这样做，因为`True`它不是一个列表。（记住`(:) :: a -> [a] -> [a]`。）你可以做`False:[True]`（​​这将是`[False,True]`，但这不是你想要的。

您需要检查是否`xs`存在 - 无论是在前面`(y:ys)` **还是**在后面。**或**的符号是`||`。所以代码说

> `xs`如果它在`(y:ys)`它的前面 ( `prefix xs (y:ys)`) 或者它在`ys`( `contains xs ys`) 中的某个地方，它就在里面。

里面有`:`(put-in-front-of 符号) 它会说

> `xs`如果它在`(y:ys)`它的前面（`prefix xs (y:ys)`），则将那个答案放在这些答案的前面 - 它在`ys`（`contains xs ys`）中的某个地方。

这是没有意义的。这就是为什么您需要或 ( `||`) 不在 ( ) 前面的原因`:`。

# cocoa - 覆盖设置器时的两种方式绑定

> ID：13078585
> 
> 赞同：1
> 
> 时间：2012-10-25T22:57:14.280
> 
> 标签：cocoa, properties, key-value-observing

我有一个绑定到某个对象“缩放”属性的 NSTextField。

在这个对象的类实现中，我有以下

```
- (void)setZoom:(CGFloat)zoom
{
    _zoom = MAX(0, MIN(10, zoom));
} 
```

如果我在文本字段中写“-5”，`setZoom:`将以“-5”作为参数调用，_zoom 将设置为 0。

然后问题是文本字段没有更新自身，它显示“-5”而不是重新读取它刚刚设置的属性值。

如果我`myObject.zoom = -5;`在代码中这样做，文本字段将正确显示 0。

我试图将 _zoom =... 包装在 willChangeValueForKey/didChangeValueForKey 调用中，但它没有改变任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T17:34:16.477

您可以尝试这样做：

```
- (void)setZoom:(CGFloat)zoom
{
    CGFloat corectedValue = MAX(0, MIN(10, zoom));
    if (zoom != corectedValue)
    {
        [self setZoom:correctedValue];
    } else {
        _zoom = zoom;
    }
} 
```

# javascript - 这种分类格式的缺点是什么？

> ID：13078587
> 
> 赞同：1
> 
> 时间：2012-10-25T22:57:49.487
> 
> 标签：javascript, javascript-objects, oop

这是我的分类格式的 3 层示例

```
function __(_){return _.constructor}

//class
var _ = ( CLASS = function(){
this.variable = 0;
this.sub = new CLASS.SUBCLASS();
}).prototype;

_.func = function(){
alert('lvl'+this.variable);
this.sub.func();
}

_.divePeak = function(){
alert('lvl'+this.variable);
this.sub.variable += 5;
}

    //sub class
    _ = ( __(_).SUBCLASS = function(){
        this.variable = 1;
        this.sub = new CLASS.SUBCLASS.DEEPCLASS();
    }).prototype;

    _.func = function(){
        alert('lvl'+this.variable);
        this.sub.func();
    }

            //deep class
            _ = ( __(_).DEEPCLASS = function(){
                this.variable = 2;
            }).prototype;

            _.func = function(){
                alert('lvl'+this.variable);
            } 
```

在你吹垫圈之前，让我解释一下。下划线背后的目的是加快为类指定函数以及指定类的子类所需的时间。对我来说，它更容易阅读。我知道，如果您打算在您的课程中使用 underscore.js，这确实会干扰它。我敢肯定 _.js 可以很容易地切换到另一个 $ymbol 虽然......哦等等，但我离题了。

为什么在一个类中有类？因为 solar.system() 和 social.system() 意味着两个完全不同的东西，但使用相同的名称很方便。为什么用户下划线来管理类的定义？因为“Solar.System.prototype”花了我大约 2 秒的时间来输入和 2 个拼写错误来纠正。它还将所有类的所有函数名称保留在同一列文本中，这有助于易读性。

我所做的只是展示我对这种方法的推理以及我提出这种方法的原因。我学习 OO JS 已经 3 天了，我非常愿意接受我可能搞砸了。

# android - GoogleAuthUtil：已超出未经身份验证使用的每日限制

> ID：13078588
> 
> 赞同：2
> 
> 时间：2012-10-25T22:58:00.720
> 
> 标签：android, oauth

我正在使用 Google Client API 和[GoogleAuthUtil.class](https://developers.google.com/android/google-play-services/reference/com/google/android/gms/auth/GoogleAuthUtil)来访问用户的 Google Drive 帐户。

```
String scope = "oauth2:" + DriveScopes.DRIVE;
String token = GoogleAuthUtil.getToken(getContext(), account.name, scope); 
```

这就是全部的魔法。它工作了一整天，但几个小时后，我在发送 API 调用时收到以下消息：

```
com.google.api.client.googleapis.json.GoogleJsonResponseException: 403 Forbidden
 {
   "code": 403,
   "errors": [
     {
       "domain": "usageLimits",
       "message": "Daily Limit for Unauthenticated Use Exceeded. Continued use requires signup.",
       "reason": "dailyLimitExceededUnreg",
       "extendedHelp": "https://code.google.com/apis/console"
     }
   ],
   "message": "Daily Limit for Unauthenticated Use Exceeded. Continued use requires signup."
} 
```

我不知道如何使用控制台中的 API 密钥而不是 oauth2 身份验证。有两种不同的“getToken()”消息。一个有四个参数，最后一个的描述说：

> extras：包含可能与身份验证范围相关的附加信息的捆绑包。

但是这些信息应该是什么样的？我必须在捆绑包中放入哪些信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:28:39.597

丹宁。我一直收到一个有效的令牌，但我从来没有用它来执行请求......我的解决方案：

```
GoogleCredential c = new GoogleCredential();
c.setAuthToken(myNewCoolToken); 
```

大错特错...

# javascript - JavaScript：将数字转换为文本（例如 18 -> “十八”）

> ID：13078591
> 
> 赞同：0
> 
> 时间：2012-10-25T22:58:09.967
> 
> 标签：javascript, internationalization

是否有任何元语言库可以做到这一点？我一直在谷歌搜索，但没有找到任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:03:13.503

这是一个页面，但它不是很完整： http: [//javascript.about.com/library/toword.js](http://javascript.about.com/library/toword.js)（取自[http://javascript.about.com/library/bltoword.htm](http://javascript.about.com/library/bltoword.htm)）

另一个可能会给您一些想法的页面：http: [//www.codeproject.com/Articles/305408/Convert-numbers-to-words-in-English-and-Asian-form](http://www.codeproject.com/Articles/305408/Convert-numbers-to-words-in-English-and-Asian-form)

我也会提出反射链接的问题。

# python - Mountain Lion：VirtualEnv 无法创建虚拟环境

> ID：13078592
> 
> 赞同：1
> 
> 时间：2012-10-25T22:58:18.330
> 
> 标签：python, virtualenv, osx-mountain-lion

```
$ sudo virtualenv test
Password:
Sorry, try again.
Password:
New python executable in test/bin/python
Installing setuptools.............done.
Installing pip....
  Complete output from command /Users/hhimanshu/test/bin/python -x /Users/hhimanshu/test/bin/easy_install /Library/Python/2.7/...ort/pip-1.2.1.tar.gz:
  /Users/hhimanshu/test/bin/python: can't open file '/Users/hhimanshu/test/bin/easy_install': [Errno 2] No such file or directory
----------------------------------------
...Installing pip...done.
Traceback (most recent call last):
  File "/usr/local/bin/virtualenv", line 8, in <module>
    load_entry_point('virtualenv==1.8.2', 'console_scripts', 'virtualenv')()
  File "/Library/Python/2.7/site-packages/virtualenv.py", line 942, in main
    never_download=options.never_download)
  File "/Library/Python/2.7/site-packages/virtualenv.py", line 1054, in create_environment
    install_pip(py_executable, search_dirs=search_dirs, never_download=never_download)
  File "/Library/Python/2.7/site-packages/virtualenv.py", line 655, in install_pip
    filter_stdout=_filter_setup)
  File "/Library/Python/2.7/site-packages/virtualenv.py", line 1020, in call_subprocess
    % (cmd_desc, proc.returncode))
OSError: Command /Users/hhimanshu/test/bin/python -x /Users/hhimanshu/test/bin/easy_install /Library/Python/2.7/...ort/pip-1.2.1.tar.gz failed with error code 2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:34:32.607

你是怎么安装的`virtualenv`？这适用于我使用显式路径：

```
sudo /usr/bin/easy_install-2.7 virtualenv
/usr/local/bin/virtualenv-2.7 test 
```

# ruby - 将两个数组添加到另一个数组中

> ID：13078593
> 
> 赞同：3
> 
> 时间：2012-10-25T22:58:38.133
> 
> 标签：ruby, arrays

> **可能重复：**
> [ruby：对两个数组的对应成员求和](https://stackoverflow.com/questions/2682411/ruby-sum-corresponding-members-of-two-arrays)

所以我正在努力做到这一点。

我正在尝试添加两个数组并将结果放入第三个数组中。现在我希望能够通过一个函数来做到这一点。

所以我有 Array_One、Array_Two 和 Array_Three。我想将“比较函数”调用为 1 和 2 并使 3 具有相同的长度，然后如果它们的长度匹配，我想添加 1 和 2 并将结果放入 3 中。

这可以在一个功能中完成吗？更好的方法来做到这一点？这是我的思考过程，但我没有 Ruby 的知识来做到这一点。

编辑：抱歉含糊不清。

```
Array_One = [3,4]
Array_Two = [1,3]
Array_Three= [] 
```

我想通过一个比较长度并验证它们长度相同的函数传递一个和两个。然后，在我看来，我会通过一个实际执行添加的函数来发送它。所以最后我会有 Array_Three = [4,7] 希望有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T23:06:56.977

您的问题的描述有点令人困惑，但我认为这可能是您想要的：

```
def add_array(a,b)
  a.zip(b).map{|pair| pair.reduce(&:+) }
end

irb> add_array([1,2,3],[4,5,6])
=> [5, 7, 9] 
```

此外，它很容易推广到添加多个数组：

```
def add_arrays(first_ary, *other_arys)
  first_ary.zip(*other_arys).map{|column| column.reduce(&:+) }
end

irb> add_arrays([1,2,3],[4,5,6])
=> [5, 7, 9]
irb> add_arrays([1,2,3],[4,5,6],[7,8,9])
=> [12, 15, 18] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T23:21:54.353

如果通过添加您的意思是按元素添加，那么您可以使用：

```
def add(a, b)
  a.zip(b).map &:sum
end 
```

假设您的环境已`sum`定义。

Sum 是 的别名`reduce(&:+)`，您可以使用它来代替。

`zip`是一个函数，它接受两个数组并返回一个数组数组：

```
[a1, a2, a3, ..., an].zip [b1, b2, b3, ..., bm] 
   #=> [[a1, b1], [a2, b2], [a3, b3], ..., [an, bn]]
   # assuming n <= m 
```

我们将我们的数组数组和该数组中的所有数字相加，然后使用 map 收集结果。

`map`是一个接受一个块并产生一个数组的函数：

```
[c1, c2, c3, ..., cn].map &block
  # => [block.call(c1), block.call(c2), block.call(c3), ..., block.call(cn)] 
```

所以如果我们得到示例输入说

```
a = [1, 2, 3]
b = [4, 2, 5]

a.zip(b)            #=> [[1,4], [2,2], [3,5]]
a.zip(b).map(&:sum) #=> [[1,4].sum, [2,2].sum, [3,5].sum] #=> [5, 4, 8] 
```

现在我们可以使用 if 条件检查相同的长度：

```
def add(a, b)
  a.zip(b).map &:sum if a.size == b.size
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-25T23:03:17.430

假设我理解您的问题，一种可能的方法（无需任何检查）：

```
x = [1, 2, 3]
y = [4, 5, 6]
z = []
x.each_with_index do |v, i|
  z << v + y[i]
end 
```

另一种方法（仍然假设我理解了这个问题）：

```
[x, y].transpose.map {|v| v.reduce(:+)} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T23:05:53.077

如果要添加两个数组，只需*添加*它们：

```
array1 = [1, 2, 3]
array2 = ['a', 'b', 'c']

if array1.length == array2.length
  array3 = array1 + array2
end

# array3 = [1, 2, 3, 'a', 'b', 'c'] 
```

# jquery - 不显眼的验证 - 如何找到一个依赖属性进行比较

> ID：13078600
> 
> 赞同：0
> 
> 时间：2012-10-25T22:59:43.790
> 
> 标签：jquery, asp.net-mvc-3, jquery-validate

在 MVC 3 应用程序上工作。我已经完成了我的自定义服务器端代码，现在在客户端工作。我想将它与现有的不显眼的东西联系起来，所以我使用了 addMethod。伪代码类似于“如果 radioValue 为真，则 counterValue 必须大于零。” 问题是，当我尝试获取 radioValue 时，我的函数在第 3 行停止运行。它抛出一个通用异常“检查你的方法”。请指教。哦，这是我第一次这样做，所以如果你看到任何东西，请告诉我。谢谢！

```
$.validator.addMethod("requiredifyes", function (val, elem, param) {
var dependantProperty = param;
var radioValue = document.getElementByName(dependantProperty).value;
var counterValue = val;

if (radioValue == true) {
    if (counterValue == 0) {
        return false;
    }
}
    return true;
});

$.validator.unobtrusive.adapters.addSingleVal("requiredifyes", "othervalue", "requiredifyes"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:08:17.583

`getElementByName`会给你元素节点列表..

因此，当您尝试直接访问列表上的值时，会抛出错误。集合内的元素将具有一个值而不是整个列表...

如果你确定只有那个名字的..试试这个

```
var radioValue = document.getElementByName(dependantProperty)[0].value; 
```

如果有多个具有相同名称的元素..您需要遍历它们。/

当您可以直接分配函数参数时，您也不必要地分配了两个变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:46:20.087

谢谢大家的帮助。我已经取出了所有不需要的变量，并根据 Sushanth 关于返回数组的代码的评论，我通过研究 JQuery 论坛来寻找 JQuery 解决方案。这是最终的工作代码：

```
 $.validator.addMethod("requiredifyes", function (val, elem, param) {
       var radioValue = $('input:radio[name="' + param + '"]:checked').val();

    if (radioValue == "True") {
        if (val == 0) {
            return false;
        }
    }
    return true;
});

$.validator.unobtrusive.adapters.addSingleVal("requiredifyes", "othervalue", "requiredifyes"); 
```

# javascript - Javascript：如何验证整个对象路径是否已定义？

> ID：13078602
> 
> 赞同：1
> 
> 时间：2012-10-25T22:59:59.443
> 
> 标签：javascript, object, undefined

> **可能重复：**
> [javascript 测试是否存在嵌套对象键](https://stackoverflow.com/questions/2631001/javascript-test-for-existence-of-nested-object-key)
> [在 JavaScript 中，是否有更简单的方法来检查属性的属性是否存在？](https://stackoverflow.com/questions/7636789/in-javascript-is-there-an-easier-way-to-check-if-a-property-of-a-property-exist)

我一直在寻找一种优雅的方式来验证是否定义了整个对象路径。
例如：`person.positions.values[0].company.name`
在每一步，在 之后`person`，它可以是未定义的。
这可以在不实际通过它们的情况下完成吗？

谢谢你。

# php - 处理 URL 中多余的“/”

> ID：13078603
> 
> 赞同：2
> 
> 时间：2012-10-25T23:00:01.323
> 
> 标签：php

所以我有一个使用这种类型输入的定制网站：

```
example.com/?id=4e2dc982 
```

或者这也可以：

```
example.com/index.php?id=4e2dc982 
```

但现在我开始在我的日志中看到来自 GoogleBot 的命中，因为某种原因试图检索它：

```
example.com/index.php/?id=4e2dc982 
```

更糟糕的是，这确实有效，它使用正确的 GET 参数拉取页面，但由于额外的“/”，所有链接和引用都不起作用。当它尝试加载“image.jpg”而不是加载正确的“example.com/image.jpg”时，它会尝试加载“example.com/index.php/image.jpg”。我如何最好地解决这个问题？我知道我可以返回并替换每个链接以使用绝对路径，但这很愚蠢。带有额外“/”的链接首先不应该工作。

**更新：**

我找到了修复程序，但仍然不知道为什么甚至允许这样做。我去了：

```
http://ca1.php.net/manual-lookup.php?pattern=test 
```

并尝试查看以下是否可行，果然可行：

```
http://ca1.php.net/manual-lookup.php/?pattern=test 
```

但是他们的页面没有中断。所以我看了看，发现了原因：

```
<base href="http://ca1.php.net/manual-lookup.php" /> 
```

所以基本上，任何 PHP 脚本似乎都接受额外的 /，但如果你没有将所有链接编码为具有绝对路径或使用基本标签，那么只要有人添加额外的“/”，你的网站就会被搞砸。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:07:28.270

它必须从某个地方链接，您需要从哪里弄清楚。你可以用google site search来（即site:yoursie）可能会搞清楚。目前的一个建议是使用规范标签 [http://googlewebmastercentral.blogspot.com.au/2009/02/specify-your-canonical.html](http://googlewebmastercentral.blogspot.com.au/2009/02/specify-your-canonical.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T23:12:05.573

我认为您实际上可以做的一件事是获取标头或浏览器代理（尽管有些浏览器不发送此），您可以做到。然后，如果标头包含 Google 之类的内容，则不允许机器人抓取页面，否则将用户重定向到该站点。下面是一个例子：

```
$browser = $_SERVER['HTTP_USER_AGENT'];
checkbrowser($browser); //Calls checkbrowser(); with the browser version.
function checkbrowser($analyze) {
    $searchwords = array("bot","google","crawler");

    $matches = array();
    $matchFound = preg_match_all(
                "/\b(" . implode($searchwords,"|") . ")\b/i", 
                $analyze, 
                $matches
        );

        if ($matchFound) {
            $words = array_unique($matches[0]);
            foreach($words as $word) {
            if($word == "bot") {
                echo "Sorry, bots are not allowed to crawl this specific page.";
                die(); //Terminate the script and leave the bot with that message so it cannot crawl.
            }
        }
    }

} 
```

这就是我经常这样做的方式，但我将这种方法用于不同的事情。`$searchwords`您可以通过将 更改为最适合您的内容来修改功能。

# objective-c - 捕获 QLPreviewController 的屏幕导致 iOS 6 出现问题

> ID：13078609
> 
> 赞同：2
> 
> 时间：2012-10-25T23:00:54.273
> 
> 标签：objective-c, ios

在 Apples Technical notes 网站上，他们将代码发布到屏幕截图。一切正常，除了它不捕获在 iOS 6 下使用 QLPreviewController 预览的文件。

我想知道他们是否正在使用一些新的 OpenGL ES 来渲染文件预览以使其无法捕获？理论上，这段代码应该可以捕捉到屏幕上的任何东西吧？？

来自[http://developer.apple.com/library/ios/#qa/qa1703/_index.html](http://developer.apple.com/library/ios/#qa/qa1703/_index.html)

```
- (UIImage*)screenshot 
{
// Create a graphics context with the target size
// On iOS 4 and later, use UIGraphicsBeginImageContextWithOptions to take the scale into consideration
// On iOS prior to 4, fall back to use UIGraphicsBeginImageContext
CGSize imageSize = [[UIScreen mainScreen] bounds].size;
if (NULL != UIGraphicsBeginImageContextWithOptions)
    UIGraphicsBeginImageContextWithOptions(imageSize, NO, 0);
else
    UIGraphicsBeginImageContext(imageSize);

CGContextRef context = UIGraphicsGetCurrentContext();

// Iterate over every window from back to front
for (UIWindow *window in [[UIApplication sharedApplication] windows]) 
{
    if (![window respondsToSelector:@selector(screen)] || [window screen] == [UIScreen mainScreen])
    {
        // -renderInContext: renders in the coordinate space of the layer,
        // so we must first apply the layer's geometry to the graphics context
        CGContextSaveGState(context);
        // Center the context around the window's anchor point
        CGContextTranslateCTM(context, [window center].x, [window center].y);
        // Apply the window's transform about the anchor point
        CGContextConcatCTM(context, [window transform]);
        // Offset by the portion of the bounds left of and above the anchor point
        CGContextTranslateCTM(context,
                              -[window bounds].size.width * [[window layer] anchorPoint].x,
                              -[window bounds].size.height * [[window layer] anchorPoint].y);

        // Render the layer hierarchy to the current context
        [[window layer] renderInContext:context];

        // Restore the context
        CGContextRestoreGState(context);
    }
}

// Retrieve the screenshot image
UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

UIGraphicsEndImageContext();

return image;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T15:34:40.003

这听起来并不相似，但这实际上不起作用，原因与它不起作用的原因相同：[iOS 6 UIGestures (Tap) stop working with QLPreviewController](https://stackoverflow.com/questions/12675378/ios-6-uigestures-tap-stops-working-with-qlpreviewcontroller)

* * *

由于 ios 6 QLPreviewController 实际上是一个完全独立的应用程序（独立的进程和一切）

=> 所以当你按下它时，你的整个应用程序都会移动到 bg，包括它的窗口。

=> QlController 从来都不是你窗口的一部分

# jdo - 向数据核中的依赖映射添加索引

> ID：13078610
> 
> 赞同：0
> 
> 时间：2012-10-25T23:00:55.637
> 
> 标签：jdo, datanucleus

我的持久类上有一个依赖映射...我在想 indexed="true" 会导致 DN 为生成的表上的键和值列添加索引，但它似乎完全被忽略了。当然我可以手动添加索引..但是有没有办法让DN通过注释（首选）或xml为我做这件事？

```
@Persistent
@Key(types=String.class,indexed="true",index = "key_idx")
@Value(types=String.class,dependent="true",indexed="true",index = "value_idx")
@Join
private Map<String,String> metadata = new HashMap<>(); 
```

作为对 DN 评论的回应，它正在使用 mysql……这是我可以找到的相关日志和生成的架构……还有什么我可以添加的东西来帮助找出我做错了什么吗？：

```
DataNucleus.Datastore.Schema:58 - Column "account_metadata.id_oid" added to internal representation of table.
DataNucleus.Datastore:58 - Field [com.core.data.account.Account.metadata] -> Column(s) [account_metadata.id_oid] using mapping of type "org.datanucleus.store.mapped.mapping.PersistableMapping" (org.datanucleus.store.rdbms.mapping.IntegerRDBMSMapping)
DataNucleus.Datastore.Schema:58 - Column "account_metadata.`key`" added to internal representation of table.
DataNucleus.Datastore:58 - Field [com.core.data.account.Account.metadata] -> Column(s) [account_metadata.`key`] using mapping of type "org.datanucleus.store.mapped.mapping.StringMapping" (org.datanucleus.store.rdbms.mapping.VarCharRDBMSMapping)
DataNucleus.Datastore.Schema:58 - Column "account_metadata.`value`" added to internal representation of table.
DataNucleus.Datastore:58 - Field [com.core.data.account.Account.metadata] -> Column(s) [account_metadata.`value`] using mapping of type "org.datanucleus.store.mapped.mapping.StringMapping" (org.datanucleus.store.rdbms.mapping.ClobRDBMSMapping)

DataNucleus.Datastore.Schema:58 - Validating 2 index(es) for table account_metadata
DataNucleus.Datastore.Schema:58 - Validating 1 foreign key(s) for table account_metadata
DataNucleus.Datastore.Schema:58 - Validating 1 unique key(s) for table account_metadata

CREATE TABLE `account_metadata` (
  `id_oid` int(11) NOT NULL,
  `key` varchar(64) CHARACTER SET latin1 COLLATE latin1_bin NOT NULL,
  `value` mediumtext,
  PRIMARY KEY (`id_oid`,`key`),
  KEY `account_metadata_n49` (`id_oid`),
  CONSTRAINT `account_metadata_fk1` FOREIGN KEY (`id_oid`) REFERENCES `account` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T14:53:18.330

DataNucleus 的 SVN 主干现在支持对映射连接表的键/值列的索引，其中键/值是非持久的（以前仅支持嵌入式键/值）。

# c# - Loading images from a relative path

> ID：13078613
> 
> 赞同：5
> 
> 时间：2012-10-25T23:01:08.740
> 
> 标签：c#, wpf, resx

I'm making a Blackjack game for a project in college (semester-long) and I've hit a road block that I can't seem to get over.

I'm trying to load the card images so they can be displayed onscreen, but I've been having *very* little luck in doing so. I've got absolute references down; I can load from those, but any attempt to load from a relative path fails. The project must be standalone; I can't instruct my professor to copy these images onto the root.

```
#if FROMDISK
        Uri myUri = new Uri(@"C:\cards\" + getFilename(r, s, "png"), UriKind.Absolute);
        PngBitmapDecoder decoder2 = new PngBitmapDecoder(myUri, BitmapCreateOptions.PreservePixelFormat, BitmapCacheOption.Default);
        BitmapSource bmp = decoder2.Frames[0];
#else
        System.Reflection.Assembly myAssembly = System.Reflection.Assembly.GetExecutingAssembly();
        Stream myStream = myAssembly.GetManifestResourceStream("Blackjack." + getFilename(r, s, "png"));
        BitmapImage bmp = new BitmapImage();
        bmp.StreamSource = myStream;
#endif
        // Draw the Image
        im.Source = bmp;
        im.Stretch = Stretch.Uniform;
        im.Width = CARD_WIDTH; 
```

[(Context)](https://github.com/vermiculus/se-blackjack/blob/master/proj/Blackjack!/MainWindow.xaml.cs#L110)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T23:30:28.223

You can use:

```
Uri uri = new Uri(@"FolderName\FileName.png",UriKind.Relative);
PngBitmapDecoder decoder2 = new PngBitmapDecoder(uri, BitmapCreateOptions.PreservePixelFormat, BitmapCacheOption.Default); 
```

Remember to set the properties for the image file to (otherwise the compiler will skip them) you can look the bin/debug folder after build and verify that the file is where it should be:

*   Build action: [content](https://stackoverflow.com/questions/145752/what-are-the-various-build-action-settings-in-vs-net-project-properties-and-wh)
*   Copy to output directory: Copy always

Another option is to make the file an [embedded resource](http://msdn.microsoft.com/en-us/library/7k989cfy%28v=vs.80%29.aspx) then you can access it like this:

```
Bitmap bitmap = Properties.Resources.FileName; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T00:09:34.270

I like to declare images as resources in my XAML. I will assume that you can still play around with the code structure at this point, and hopefully there aren't too many new concepts for you. Here's how I do it:

Start y creating a folder in your project called "Images". Add the images of your cards by drag and dropping them onto the folder in Visual Studio. Make sure their "Build Action" is set to Resource.

Create a new "Resource Dictionary" by pressing CTRL-SHIFT-A. Name it CardImages.xaml.

Link this file in App.xaml like this (showing how to link multiple XAML files at once, but for this of course remove the "AnyDictionary" line!)

App.XAML:

```
<Application.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="Controls/CardImages.xaml" />
            <ResourceDictionary Source="Controls/AnyDictionaryYouWant.xaml" />
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Application.Resources> 
```

Add this code to CardImages.xaml. Rename "MyBlackJackAssembly" to the assembly name of your proejct.

```
<Style TargetType="Image">
    <Setter Property="RenderOptions.BitmapScalingMode" Value="HighQuality" />
</Style>

<DataTemplate x:Key="Spade1">
    <Image Source="MyBlackJackAssembly;component/Images/Spade1.png" />
</DataTemplate>

<DataTemplate x:Key="Spade2">
    <Image Source="MyBlackJackAssembly;component/Images/Spade2.png" />
</DataTemplate> 
```

Then, you can locate them in your code like this:

```
Label label = new Label();
label.ContentTemplate = (DataTemplate)label.FindResource("Spade1"); 
```

This will get you a WPF Label object that should show your card. This technique works with anything that supports ContentTemplate. You can then add your Label to a grid on your UI, I'm not sure how you display your cards on screen.

For a blackjack application, I would probably create a UserControl called "Card" in order to be able to generate it kind of like this. This encapsulates the "card generation" logic into its own Control so the rest of the code can just focus on dealing the cards.

XAML:

```
<myControls:CardImage Kind="Spades" Digit="1" /> 
```

Or like this in c#:

```
CardImage aCard = new CardImage();
aCard.Kind = CardImage.Kinds.Spades; //enum
aCard.Digit = 1; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T23:09:15.913

The way I'm loading some background images that are imported in the project's resources:

```
this.staticBg.Source = new BitmapImage(
    new Uri(@"/Project;component/Images/" + ((App)App.Current).bgImage
                                          + ".jpg", UriKind.Relative)); 
```

Where "Project" is project name. So basically you should add images to resources and call them with relative uri.

# objective-c - NSURLConnection GET 和 POST 不起作用

> ID：13078616
> 
> 赞同：0
> 
> 时间：2012-10-25T23:01:22.647
> 
> 标签：objective-c, ios, cocoa-touch, nsurlconnection

我没有从服务器获得正确的输出。我每次得到的回复是：

> 走了
> 
> ```
> /prod/bwckgens.p_proc_term_datehas been permanently removed from this server. 
> ```

[当您只是将网络浏览器定向到此处](https://selfservice.mypurdue.purdue.edu/prod/bwckgens.p_proc_term_date)的页面而不是先浏览[此](https://selfservice.mypurdue.purdue.edu/prod/bwckschd.p_disp_dyn_sched?)页面时，通常会收到此信息。这让我得出一个 cookie 没有被保存的结论，但我在文档中读到这一切都由 NSURLConnection 对象处理。我在这里做错了什么吗？

```
#import "PCFViewController.h"

@interface PCFViewController ()

@end

NSMutableData *mutData;

@implementation PCFViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (IBAction)queryServer {
    NSURL *url = [NSURL URLWithString:@"https://selfservice.mypurdue.purdue.edu/prod/bwckschd.p_disp_dyn_sched"];
    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url cachePolicy:NSURLCacheStorageAllowed timeoutInterval:3.0];
    //the reason I perform a GET here is just to get a cookie and communicate like a normal web browser, since directly doing a POST to the proper address isn't working
    [request setHTTPMethod:@"GET"];
    [request setValue:@"text/html; charset=UTF-8" forHTTPHeaderField:@"Content-Type"];
    NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
    if (connection) {
        mutData = [NSMutableData data];
    }
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    NSLog(@"Succeeded! Received %d bytes of data",[mutData length]);
    NSString *str = [[NSString alloc] initWithData:mutData encoding:NSUTF8StringEncoding];
    //just to see the contents(for debugging)
    NSLog(@"%@", str);

    [self handleConnection:connection];
}

-(void)handleConnection:(NSURLConnection *)connection
{
    //this is the first step
    if ([@"/prod/bwckschd.p_disp_dyn_sched" isEqualToString:[[[connection originalRequest] URL] path]]) {
        //first request
        //POST
        NSURL *url = [NSURL URLWithString:@"https://selfservice.mypurdue.purdue.edu/prod/bwckgens.p_proc_term_date"];
        NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url cachePolicy:NSURLCacheStorageAllowed timeoutInterval:3.0];
        [request setHTTPMethod:@"POST"];
        NSString *args = @"p_calling_proc=bwckschd.p_disp_dyn_sched&p_term=201320";
        NSData *requestBody = [args dataUsingEncoding:NSUTF8StringEncoding];
        [request setHTTPBody:requestBody];
        connection = [connection initWithRequest:request delegate:self];
        [connection start];
        if (connection) {
            mutData = [NSMutableData data];
        }
        //second step. Here I send the list of classes(COMPUTER SCIENCE) I want to display as well as the term SPRING2013
    }else if([@"/prod/bwckgens.p_proc_term_date" isEqualToString:[[[connection currentRequest] URL] path]]) {
        NSURL *url = [NSURL URLWithString:@"https://selfservice.mypurdue.purdue.edu/prod/bwckschd.p_get_crse_unsec"];
        NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url cachePolicy:NSURLCacheStorageAllowed
                                                           timeoutInterval:3.0];
        [request setHTTPMethod:@"POST"];
        NSString *args = @"term_in=201320&sel_subj=dummy&sel_day=dummy&sel_schd=dummy&sel_insm=dummy&sel_camp=dummy&sel_levl=dummy&sel_sess=dummy&sel_instr=dummy&sel_ptrm=dummy&sel_attr=dummy&sel_subj=CS&sel_crse=dummy&sel_title=dummy&sel_schd=%25&sel_from_cred=&sel_to_cred=&sel_camp=%25&sel_ptrm=%25&sel_instr=%25&sel_sess=%25&sel_attr=%25&begin_hh=0&begin_mi=0&begin_ap=a&end_hh=0&end_mi=0&end_ap=a";
        NSData *requestBody = [args dataUsingEncoding:NSUTF8StringEncoding];
        [request setHTTPBody:requestBody];
        connection = [connection initWithRequest:request delegate:self];
        [connection start];
        if (connection) {
            mutData = [NSMutableData data];
        }
        //the courses should be shown now I have to parse the data
    }else if([@"/prod/bwckschd.p_get_crse_unsec" isEqualToString:[[[connection currentRequest] URL] path]]) {

    }
}
-(void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{
    NSLog(@"%@\n", error.description);
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
    [mutData setLength:0];
    NSLog(@"%@\n", response.description);

}

-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
    [mutData appendData:data];
}
@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:19:17.970

一旦启动，您就不能使用相同的 URL 连接更改请求对象。阅读 NSURLConnection 的文档。它说：

> 要加载的 URL 请求。请求对象作为初始化过程的一部分被深度复制。此方法返回后对请求所做的更改不会影响用于加载过程的请求。

所以如果你想点击另一个 URL，你必须创建一个新的 URLRequest 和新的 URLConnection 对象。关于您关于保存 cookie 的问题。您可以使用以下方法设置 URLRequest 的缓存策略

```
- (void)setCachePolicy:(NSURLRequestCachePolicy)policy 
```

# ruby - 在 mathn 中使用 Primes.new 遍历素数

> ID：13078620
> 
> 赞同：0
> 
> 时间：2012-10-25T23:02:04.727
> 
> 标签：ruby, for-loop, primes

我在 Ruby`Prime.new`的`mathn`库中找到了。我用它来为一个问题生成质数。我想使用 . 遍历 1 到 1000 之间的所有素数`Primes.new`。有没有办法`Prime.new`在`for`循环中使用或以某种方式迭代素数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:10:45.293

这是一种雄辩的处理方式。

```
ruby-1.9.3-p194 :001 > require 'mathn'
 => true

ruby-1.9.3-p194 :002 > Prime.each(1000) do |i|
ruby-1.9.3-p194 :003 >   puts i
ruby-1.9.3-p194 :004 > end
2
3
.
.
.
991
997
 => nil 
```

PS`Prime.new`似乎已经过时了。

```
ruby-1.9.3-p194 :005 > Prime.new
Prime::new is obsolete. use Prime::instance or class methods of Prime.
 => #<Prime:0x0000010083ca10 @generator=#<Prime::EratosthenesGenerator...>> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T23:12:38.083

您还可以像这样获得 n 个第一个质数：

```
Prime.each(100) do |prime|
  p prime  #=> 2, 3, 5, 7, 11, ...., 97
end 
```

参见：[http ://www.ruby-doc.org/gems/docs/b/backports-2.6.1/Prime.html](http://www.ruby-doc.org/gems/docs/b/backports-2.6.1/Prime.html)

编辑：要获得高于给定值的 n 个第一个素数，我会这样做（这是一个草稿）

```
require 'mathn'

def prime_numbers_from start, n
  primes = []
  Prime.each(n) do |prime|
    primes << prime if prime > start
  end
  primes
end

prime_numbers_from(10, 30)
# returns => [11, 13, 17, 19, 23, 29] 
```

# iphone - 将现有对象添加到 Core Data？

> ID：13078624
> 
> 赞同：0
> 
> 时间：2012-10-25T23:02:33.950
> 
> 标签：iphone, ios, xcode, core-data

我找不到有关此主题的任何内容。我有不使用 insertNewObject 的 NSManagedObjects ... 我使用 alloc init，然后将它们添加到数组中，按字母顺序对它们进行排序，然后我想将它们添加到实体并保存上下文。关于如何将它们添加到实体而不制作全新对象的任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T00:22:00.927

这可能更适合作为评论，但实际上它是答案。

不要那样做。首先，阅读文档，然后按照指示使用 API。

直接来自以下文档`NSManagedObject`：

> 正确配置托管对象以与 Core Data 一起使用非常重要。如果直接实例化托管对象，则必须调用指定的初始化程序（initWithEntity:insertIntoManagedObjectContext:)。

然后，从文档中`initWithEntity:insertIntoManagedObjectContext:`

> 重要此方法是 NSManagedObject 的指定初始化程序。您不能简单地通过发送 init 来初始化托管对象。

请注意，上述声明实际上是在文档中的一个引人注目的框中突出显示的。

# architecture - Backbone.js 架构：路由还是应用程序状态？

> ID：13078627
> 
> 赞同：3
> 
> 时间：2012-10-25T23:02:56.157
> 
> 标签：architecture, backbone.js, routes

我正在构建一个相当复杂的 Backbone.js 应用程序。来自 Rails 背景，我试图弄清楚何时适合触发路由（以及使用 true 选项的函数），以及何时只更改应用程序状态而不影响 url。

似乎严重依赖路由器将是一个很好的方向，因为我可以轻松地将应用程序启动到我想要的任何状态。有没有这方面的最佳实践？当我开始依赖导航方法时，我注意到我的视图被重复了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:08:45.103

这真的取决于情况。

**当状态实际上是**您希望能够添加书签/共享 的东西时，您通常希望使用路由。

另一方面，如果您只是在更新视图中的某些内容，而实际上并不是您需要为其检索状态的内容 - 只需更改它即可。但是，您可以提供通往该州的路线的选项，但不是必需的。例如，如果您的应用程序涉及地图 - 您可能不想在每次用户平移/缩放地图时更新位置/路线，但提供“共享”或“书签”类型的按钮可能是个好主意功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T05:54:30.923

正如上面提到的 Jsonwyatt 。他的说法“这真的取决于情况”是正确的。像状态改变或状态操作之类的东西通常是我更喜欢通过视图。但是，例如，在我实际浏览任何导航 url 的情况下，我希望`/home/foo`通过骨干路由器呈现类似的东西。

但是，当您实际上只是在说明模型状态更改时，例如更新模型。你可以做`model.save()`而不是通过一个 url 来驱动类似的事情`/home/student/1`，这会不必要地呈现另一个视图。但这可能会导致您渲染另一个视图，而这只能从您当前的视图中完成。

作为参考，Darik bailey 就应用程序状态和路由器导航以及维护浏览器历史 pushstate 进行了很好的讨论。作为参考，您可以通过此链接。

[不要从您的代码中执行主干 js 路由处理程序](http://lostechies.com/derickbailey/2011/08/28/dont-execute-a-backbone-js-route-handler-from-your-code/)

# python - 修改“元组列表列表”结构中的某些内容而不破坏python中的结构

> ID：13078634
> 
> 赞同：1
> 
> 时间：2012-10-25T23:03:27.710
> 
> 标签：python, list, tuples

这听起来像是一个简单的问题。但是，给定一个：

```
a = [[(1,2)], [(3,4), (5,6)], [(7,8), (9,10), (11,12)]] 
```

如何将 1 添加到元组中的第一项，以便获得以下内容？

```
b = [[(2,2)], [(4,4), (6,6), [(8,8), (10,10), (12,12)]] 
```

我尝试了如下代码：

```
b = []

for list_of_tuples in a:
    for num1, num2 in list_of_tuples:
        b.append((num1+1, num2))

b 
```

但是，这破坏了原始结构。那么，我怎样才能得到我想要的，使用两个 for 循环呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T23:07:45.397

使用嵌套列表推导：

```
>>> a = [[(1,2)], [(3,4), (5,6)], [(7,8), (9,10), (11,12)]]
>>> b = [[(x+1, y) for x, y in tuples] for tuples in a]
>>> b
[[(2, 2)], [(4, 4), (6, 6)], [(8, 8), (10, 10), (12, 12)]] 
```

作为`for`一个列表理解：

```
b = []
for tuples in a:
    b.append([(x+1, y) for x, y in tuples]) 
```

没有任何列表理解：

```
b = []
for tuples in a:
    tuples_b = []
    for x, y in tuples:
        tuples_b.append((x+1, y))
    b.append(tuples_b) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T23:19:57.030

使用`map()`和`isinstance()`：

```
def func(x):
    if isinstance(x,list):
       return map(func,x)
    elif isinstance(x,tuple):
        return (x[0]+1,x[1])

a = [[(1,2)], [(3,4), (5,6)], [(7,8), (9,10), (11,12)]]
print map(func,a) 
```

**输出：**

```
[[(2, 2)], [(4, 4), (6, 6)], [(8, 8), (10, 10), (12, 12)]] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T23:44:43.087

你被元组困住了吗？将它们转换为列表可能会更好，因为您显然正在修改它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T23:07:22.853

您几乎走上了正轨，但您还需要先将元组的容器列表添加到 b 中，以重新创建原始结构

```
a = [[(1,2)], [(3,4), (5,6)], [(7,8), (9,10), (11,12)]]

b = []

for list_of_tuples in a: 
    b.append([])
    for num1, num2 in list_of_tuples: 
        b[-1].append((num1+1, num2))

print b 
```

输出：

```
[[(2, 2)], [(4, 4), (6, 6)], [(8, 8), (10, 10), (12, 12)]] 
```

# c# - HttpClient GetAsync 在 Windows 8 上的后台任务中失败

> ID：13078635
> 
> 赞同：10
> 
> 时间：2012-10-25T23:03:39.333
> 
> 标签：c#, windows-8, windows-runtime, background-process

我有一个 Win RT 应用程序，它有一个后台任务，负责调用 API 来检索它需要自我更新的数据。但是，我遇到了一个问题；在后台任务之外运行时，调用 API 的请求可以完美运行。在后台任务内部，它失败了，并且还隐藏了任何可能有助于指出问题的异常。

我通过调试器跟踪这个问题以跟踪问题点，并验证执行在 GetAsync 上停止。（我传递的 URL 是有效的，并且 URL 在不到一秒的时间内响应）

```
var client = new HttpClient("http://www.some-base-url.com/");

try
{
    response = await client.GetAsync("valid-url");

    // Never gets here
    Debug.WriteLine("Done!");
}
catch (Exception exception)
{
    // No exception is thrown, never gets here
    Debug.WriteLine("Das Exception! " + exception);
} 
```

我读过的所有文档都说，后台任务可以根据需要拥有尽可能多的网络流量（当然是节流的）。所以，我不明白为什么这会失败，或者知道任何其他诊断问题的方法。我错过了什么？

* * *

**更新/回答**

感谢史蒂文，他指出了解决问题的方法。为了确保确定的答案在那里，这里是修复前后的后台任务：

*前*

```
public void Run(IBackgroundTaskInstance taskInstance)
{
    BackgroundTaskDeferral deferral = taskInstance.GetDeferral();

    Update();

    deferral.Complete();
}

public async void Update()
{
    ...
} 
```

*后*

```
public async void Run(IBackgroundTaskInstance taskInstance) // added 'async'
{
    BackgroundTaskDeferral deferral = taskInstance.GetDeferral();

    await Update(); // added 'await'

    deferral.Complete();
}

public async Task Update() // 'void' changed to 'Task'
{
    ...
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-26T04:24:37.870

完成后，您必须调用[`IBackgroundTaskInterface.GetDeferral`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.background.ibackgroundtaskinstance.getdeferral.aspx)然后调用其`Complete`方法`Task`。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-26T01:39:01.457

以下是我的做法，它对我有用

```
 // Create a New HttpClient object.
        var handler = new HttpClientHandler {AllowAutoRedirect = false};
        var client = new HttpClient(handler);
        client.DefaultRequestHeaders.Add("user-agent",
                                         "Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; WOW64; Trident/6.0)");

        var response = await client.GetAsync(url);
        response.EnsureSuccessStatusCode();
        return await response.Content.ReadAsStringAsync(); 
```

# sql - 参数可能为 NULL 的 SQL 函数

> ID：13078637
> 
> 赞同：4
> 
> 时间：2012-10-25T23:04:19.213
> 
> 标签：sql, postgresql, stored-procedures

我想使用以下函数（在 PostgreSQL 中）：

```
create type holder as (userName varchar(50), processName varchar(50), 
    dateTime timestamp, macAddress varchar(30), labName varchar(50),
    subjectName varchar(50));

create or replace function returnData( 
   uName varchar(50), pName varchar(50), dTimeIn timestamp, dTimeOut timestamp,
   macAddress MACADDR, lName varchar(50), subjectName varchar(50)
 ) returns setof holder as $$
declare
    r holder%rowtype;
begin

    for r in  (SELECT DISTINCT u.name, p.process_name, i.date_time,
               c.mac_address, l.lab_name, d.subject_name
    FROM user u, session s, init i, process p, computer c, laboratory l,
         class a, subject d, occur_in o
    WHERE i.process_id = p.process_id AND i.session_id = s.session_id
       AND s.user_id = u.user_id AND s.comp_id = c.comp_id
       AND c.lab_id = l.lab_id AND l.lab_id = o.lab_id
       AND o.class_id = a.class_id AND a.subject_id = d.subject_id
       AND p.blocked = true
       --important part now
       AND u.name = userName AND p.name = processName
       AND i.dateTimeIn > dTimeIn AND i.dateTimeOut < dTimeOut
       AND c.mac_address = macAddress 
       AND l.name = lName AND d.name = subjectName
    )
    loop
        return next r;
    end loop;
    return;

end;
$$
language 'plpgsql'; 
```

我将其翻译成英文时可能有一些拼写错误，但只要我传递有效参数，实际功能就可以工作。但我的用户可能不想按用户名过滤结果，例如。或者他可以选择在某个日期之后提供数据，但不指定完成日期。我可以做类似的事情

```
...   
IF (userName IS NULL AND pName IS NULL AND ...)
    -- query without filtering user name nor process name,
    -- filtering or not the other parameters
IF (userName IS NOT NULL AND pName IS NULL AND ...)
    --filter user name, don't filter process name,
    -- filtering or not the other parameters
... 
```

等等。但是，如果我没记错的话，我必须编写 49 个查询，因为我有 7 个可能会或可能不会被过滤的参数。我可以这样做，但如果可能的话，我想通过做类似的事情来简化我的查询

```
SELECT ...
FROM ...
WHERE ...
AND userName = * 
```

如果用户不想过滤用户名，其中 * 将是参数 uName 中的值。有可能做这样的事情吗？有没有更好的方法来做到这一点？以及如何处理这两个时间戳？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T23:11:47.163

```
 AND (userName is null or u.name = userName)
   AND (processName is null or p.name = processName)
   AND (dTimeIn is null or i.dateTimeIn > dTimeIn)
   AND (dTimeOut is null or i.dateTimeOut < dTimeOut)
   AND (macAddress is null or c.mac_address = macAddress)
   AND (lName is null or l.name = lName)
   AND (subjectName is null or d.name = subjectName) 
```

# ruby - 如何调试 Ruby gem？（罗盘）

> ID：13078638
> 
> 赞同：3
> 
> 时间：2012-10-25T23:04:21.417
> 
> 标签：ruby, debugging, gem, compass-sass

我正处于学习 Ruby 的早期阶段，并且想学习如何调试 gem，但是在寻找有关这方面的学习资源时遇到了麻烦。一个简单的例子对我来说会有很长的路要走。

[调试器](https://github.com/cldwalker/debugger)是首选调试器吗？我在哪里需要它？如何用它设置断点？

**注意：**我做出有根据的猜测，调试过程可能会根据需要调试的 gem 有所不同，因此作为参考，我对使用[Compass](https://github.com/chriseppstein/compass/)[调试某些问题](https://github.com/chriseppstein/compass/issues/989)特别感兴趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T12:10:15.290

好的，这是我自己想出来的。这是我采取的步骤..

我正在运行 Ruby 1.9.3（由 running 确定`ruby -v`），因此在测试[ruby](https://rubygems.org/gems/ruby-debug) ​​-debug和[ruby​​-debug19 之后](https://rubygems.org/gems/ruby-debug19)，我确定这些调试器不再维护，或者至少在我安装的 ruby​​1.9.3-p125 时无法正常工作. 这导致我[调试器](https://github.com/cldwalker/debugger)。

有效的安装说明是：

`$ gem install debugger -- --with-ruby-include=PATH_TO_HEADERS`

我机器上的 PATH_TO_HEADERS 只是 ruby​​ 的源位置：

`/Users/myusername/.rvm/src/ruby-1.9.3-p125/`

由于我特别下定决心要调试 Compass 编译器，所以我做了以下工作：

1.  克隆源：`$ git clone git://github.com/chriseppstein/compass.git`
2.  首先检查现有的指南针版本`$ compass -v`，即 13.0
3.  编辑了 VERSION.yml 并增加了补丁号（至 13.1），因此它不会与我现有的安装冲突。
4.  编辑了我要调试的文件的 .rb 文件，`lib/compass/compiler.rb`并在顶部添加了这一行：`require 'debugger'; debugger`
5.  构建宝石：`gem build compass.gemspec`
6.  安装新编译的gem：`sudo gem install compass-0.13.2.058ead2.gem`
7.  编译了一个我遇到问题的现有基于指南针的项目，并开始调试。
8.  调试完成后，我卸载了调试版本，`sudo gem uninstall compass`选择了Compass 13.2对应的数字。

**关于第 7 步的注意事项：**由于调试器具有与 ruby​​-debug/ruby-debug19 相同的调试命令，因此我能够按照现有的关于调试步骤的教程进行操作。

*   比如这个 RailsCast： [http: //railscasts.com/episodes/54-debugging-with-ruby-debug](http://railscasts.com/episodes/54-debugging-with-ruby-debug)
*   还有这个博客（和链接的备忘单）： http: [//pivotallabs.com/users/chad/blog/articles/366-ruby-debug-in-30-seconds-we-don-t-need-no-stinkin-贵-](http://pivotallabs.com/users/chad/blog/articles/366-ruby-debug-in-30-seconds-we-don-t-need-no-stinkin-gui-)

如果您有其他调试器教程、指针、提示等，请发布它们。

# bash - 如何防止bash函数参数被扩展

> ID：13078639
> 
> 赞同：0
> 
> 时间：2012-10-25T23:04:41.563
> 
> 标签：bash, unix

我有一个 bash 函数，如下所示：

```
foo() {
    echo $1
} 
```

或者

```
bar() {
    baz $1
} 
```

如果我再调用`foo 'file[1-3]'`结果是`file1 file2 file3`，不是`file[1-3]`。将参数传递给另一个 bash 函数的调用时会发生类似的现象，例如在 function 中`bar`。除了确保当前目录中没有匹配的文件以便我可以在回显或将参数传递给另一个函数时引用参数之外，最简单的方法是什么？

编辑：字符串匹配似乎并没有扩展全局。在对另一个函数的内部调用中执行字符串匹配时，我的具体问题就显现出来了。似乎扩展了模式的是对另一个函数的调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:07:22.213

将其插入脚本的顶部：

```
set -o noglob 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T23:18:07.227

只需将 $1 括在双引号中，即

```
echo "$1" 
```

因为在双引号内不会发生通配符/文件名扩展。

# c# - 使用视图注册演示者

> ID：13078640
> 
> 赞同：2
> 
> 时间：2012-10-25T23:04:44.153
> 
> 标签：c#, mvp, autofac

如果我有这样的主持人——

```
public class LandingPresenter : ILandingPresenter
{            
    private ILandingView _view { get; set; }
    private IProductService _productService { get; set; }

    public LandingPresenter(ILandingView view, IProductService)
    {
        ....
    }
} 
```

考虑到不会注册依赖视图（但 IProductService 会），我如何使用 Autofac 注册此 Presenter

```
 builder.RegisterType<LandingPresenter>().As<ILandingPresenter>(); ???? 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-27T23:07:03.110

为什么不在容器中注册视图，让 Autofac 工作！然后，您可以通过在演示者上使用构造函数注入和在视图上使用属性注入来自动连接演示者和视图。您只需使用属性连接注册视图：

```
builder.RegisterAssemblyTypes(ThisAssembly).
    Where(x => x.Name.EndsWith("View")).
    PropertiesAutowired(PropertyWiringFlags.AllowCircularDependencies).
    AsImplementedInterfaces(); 
```

主持人：

```
public class LandingPresenter : ILandingPresenter
{            
    private ILandingView _view;
    private IProductService _productService { get; set; }

    public LandingPresenter(ILandingView view, IProductService _productService)
    {
        ....
    }
} 
```

看法：

```
public class LandingView : UserControl, ILandingView
{
    // Constructor

    public LandingView(... other dependencies here ...)
    {
    }

    // This property will be set by Autofac
    public ILandingPresenter Presenter { get; set; }
} 
```

如果你想先查看，那么你应该能够反转它，以便演示者将视图作为属性。

# c# - 在 Razor 中循环浏览模型内容

> ID：13078647
> 
> 赞同：13
> 
> 时间：2012-10-25T23:06:11.140
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, razor

我想在我的剃刀视图中循环浏览模型中的每个项目，但我想将所有项目组合在一起。然后我想遍历每个组。想象一下我有一张桌子：

```
ID   GroupNo    GroupName
1    1          Group1
2    1          Group2
3    1          Group3
4    2          Group1
5    2          Group2
6    3          Group56 
```

我想做类似的事情：

```
@foreach (var group in Model.GroupNo) {
    <section>
        <header>Group No is @group.GroupNo</header>
        @foreach (var item in group) {
            <p>GroupName: @item.GroupName</p>
        }
    </section>
} 
```

所以我的输出是：

```
Group No is 1
GroupName: Group1
GroupName: Group2
GroupName: Group3
Group No is 2
GroupName: Group1
GroupName: Group2
Group No is 3
GroupName: Group56 
```

这可能吗？

谢谢

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-10-25T23:11:09.583

是的，使用 Linq 很容易做到这一点`GroupBy`。我建议将您的视图更改为 use `@model IEnumerable<IGrouping<string, MyModel>>`，您将像这样填充它：

```
var groupModel = MyModelCollection.GroupBy(item => item.GroupNo).ToArray();
return View(groupModel); 
```

然后，只需按照您编写的方式遍历组，除了使用`group.Key`而不是`group.GroupNo`检索 IGrouping 的键：

```
@foreach (var group in Model) {
    <section>
        <header>Group No is @group.Key</header>
        @foreach (var item in group) {
            <p>GroupName: @item.GroupName</p>
        }
    </section>
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-25T23:39:28.470

LINQ 可以帮助您做到这一点

```
@model IEnumerable<Project1.Models.Group>

@foreach (var item in Model.Select(i=>i.groupno).Distinct().ToList()) {
    <tr>
        <td>
            <header>Group No is @item</header>
            @foreach (var grpName in Model.Where(i => i.groupno == item).ToList())
            {
                <p>GroupName: @grpName.groupName</p>
            }
        </td>
    </tr>
} 
```

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2017-12-08T10:29:23.507

```
@{
    Layout = null;
}
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>
</head>
<body>
    <div>

        @{
            String[] name = {"Prashant", "Rishabh", "Zaheer", "Pratima", "Rahul"};
            int i = 1;
            while (i <= 5)
            {
                foreach(var x in name)
                {
                       <p>@i.  @x</p>
                       i++;
                };
                break;
            }
        }
    </div>
</body>
</html>

O/p-
1\. Prashant

2\. Rishabh

3\. Zaheer

4\. Pratima

5\. Rahul 
```

# web-applications - LimeJS director.makeMobileWebAppCapable(); 使屏幕空白

> ID：13078650
> 
> 赞同：2
> 
> 时间：2012-10-25T23:06:28.530
> 
> 标签：web-applications, screen, limejs

在我的 helloWorld 模板中，`LimeJS`我得到一个空白屏幕，其中 FPS 框正在运行，没有别的。

但是，如果我只是注释掉`director.makeMobileWebAppCapable();`它运行得很好。我可以看到橙色圆圈并移动它。在 google 和 formus 上花了 2 天，找不到其他人有同样的问题，在所有教程中甚至没有人提到这条线，所以我想每个人都认为它总是有效的。

我安装没有问题`LimeJS`我没有收到任何其他错误，`director.makeMobileWebAppCapable();`注释掉我能够通过一些教程并且一切正常，但是这个功能。

我用：

> ```
> win xp sp3, 
> python 2.7.3 
> ```

得到了入门页面上提到的所有其他重要内容。有谁知道可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T20:24:35.140

在 Chrome 中运行它或使用调试器运行它并查看控制台。我在 chrome 中运行我的，右键单击并“检查元素”打开我的调试器框架，然后我只需单击“控制台”选项卡，看看是否有任何错误被抛出。

# xpages - 将 MIME 附件从一个文档复制到另一个文档

> ID：13078654
> 
> 赞同：2
> 
> 时间：2012-10-25T23:07:13.560
> 
> 标签：xpages, mime

XPages 应用程序使用包含绑定到 RichText 编辑器和文件上传/下载控件的两个字段的“模板”文档。常规文档最初链接到模板文档，一个数据源用于当前文档的公共字段（标题、类别、读者/作者...），第二个数据源显示模板中的只读 RT+附件。

当用户决定更改 RT/附件时，他从模板中取消链接文档 - 通过将 RT+附件从模板复制到当前文档。

**问题：**用于 RT 副本（以及附件）的标准 Java 片段是：

```
session.setConvertMime(true);
RichTextItem rti = (RichTextItem)docTemplate.getFirstItem("Body");
rti.copyItemToDocument(docCurrent, "Body");
rti = (RichTextItem)docTemplate.getFirstItem("Files"); <====
rti.copyItemToDocument(docCurrent, "Files");
docCurrent.save(); //saves in RT format, next save via XPage converts to MIME 
```

这总是适用于正文字段（尽管它会稍微改变格式），但它很少适用于附件。在 Notes 客户端中重新保存模板文档可将 RT 从 MIME 转换为原生 RT 格式，并且代码可以正常工作。

不工作意味着：

*   与箭头一致的异常`java.lang.ClassCastException: lotus.domino.local.Item incompatible with lotus.domino.RichTextItem`。
*   缺少文件字段（正文已正确创建）对于某些附件，代码似乎可以工作（文本文件），对于更大的或二进制文件，它会失败（23k .doc，3M .pdf）。

上述称为代理的代码的 LotusScript 替代方案也无济于事。数据源属性 computeWithForm 不是故意使用的。

**问题：**在文档之间复制 MIME 附件的正确技术是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T07:23:55.037

最快的方法是使用 Document.copyAllItems(Document doc, boolean replace) 而不是删除不必要的内容。

# java - 在Java方法中模拟一个静态C变量的效果

> ID：13078655
> 
> 赞同：2
> 
> 时间：2012-10-25T23:07:14.700
> 
> 标签：java

在 Java 中，一个方法可以有任何接近 C 中的静态变量的东西吗？尽管 Java 没有提供一个，也就是说，它只会被初始化一次，并在后续的递归调用中保持最新的值

我可以将它传递回方法以获得最新值并根据某些仅适用一次的条件实现“仅初始化一次”

```
 int fun(.....,Nthcall,PseudoStatic)
   {if(NthCall==1)
     PseudoStatic=10
    //rest of code
      Pseudostatic=100
       fun(.....,Nthcall+1,PseudoStatic)
    } 
```

没有更好的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T23:08:09.457

为什么不向类声明一个静态变量？有关更多信息，请参阅[有关实例和类变量的教程](http://docs.oracle.com/javase/tutorial/java/javaOO/classvars.html)。

请注意，如果多个线程使用同一个类，这不是线程安全的。因此，您最好在每次调用时定义一个类成员变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T00:40:10.813

我们可以做这样的事情

```
public void test()
{
    StaticVar<Integer> s1 = new StaticVar<Integer>(){};

    StaticVar<Long> s2 = new StaticVar<Long>(){};

    Integer v1 = s1.get();
    System.out.println(v1);
    s1.set( v1==null? 1 : v1+1 );

    Long v2 = s2.get();
    System.out.println(v2);
    s2.set( v2==null? 1 : v2*2 );
}

public abstract class StaticVar<V>
{
    public V get()
    {
        return (V)class2value.get(this.getClass());
    }

    public void set(V value)
    {
        class2value.put(this.getClass(), value);
    }

    static WeakHashMap<Class,Object> class2value = new WeakHashMap<>();
} 
```

虽然它不是线程安全的。我们可以简单地添加`synchronized(class2value)`. 或者使用弱并发哈希映射。

# android - 使 ViewPager 重叠 PageTitleStrip

> ID：13078661
> 
> 赞同：2
> 
> 时间：2012-10-25T23:07:33.763
> 
> 标签：android, android-viewpager, page-title

我已经为此苦苦挣扎了一段时间：是否可以强制 PageTitleStrip 在 ViewPager 的内容上绘制自身？

情况如下：![屏幕](../Images/f22d7a6e9ab5a78ba19a97475e162e07.png)

红线表示 ViewPager 内容的结束和 PagerTitleStrip 的开始。棕色背景属于孔活​​动。黑板和蓝色背景来自寻呼机中的片段。屏幕在滚动过程中被截取，以便可以看到 2 个片段。我希望 PagerTitleStrip 中的图标透明地显示并在 viewPager 的内容上聚会。

任何建议都受到高度赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:34:21.843

我认为使用内置的 ViewPager 和 PagerTitleStrip 是不可能做到这一点的。您必须根据这些制作自己的自定义组件才能获得所需的效果。

# php - Symfony2 上子应用程序的主页

> ID：13078662
> 
> 赞同：2
> 
> 时间：2012-10-25T23:07:35.527
> 
> 标签：php, symfony

我敢肯定这很容易，但我完全被困在这里。

我正在使用`sf2`创建一个包含多个“应用程序”的站点，但我想要一个主页来显示它们的某种索引，但我不确定如何执行此操作。让我们想想这个例子（实际上，这不是我正在做的，但我们可以使用它）：

我有一些视频游戏机的页面（目前，PS3、360、WII、PSV 和 NDS）。它们将位于 、 等`ps3.domain.com`站点`360.domain.com`中`nds.domain.com`。他们每个人的逻辑实际上都是不同的，他们不是克隆（每个人都有一个“应用程序”），他们大多是独立的，除了他们共享的核心和用户/社区的东西。但是在[www.domain.com](http://www.domain.com)或只是[domain.com](http://domain.com)，我需要链接到所有这些，我不知道把它放在哪里，或者如何使一个“全局”控制器高于所有其他控制器。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-27T16:56:52.113

如果您的应用程序真的不同，我会怎么做：

结构：

```
// src/:
    Sybio\Bundle\CoreBundle // Shared entities, config and tools
    Sybio\Bundle\PortalBundle // Your main portal, domain.com
    Sybio\Bundle\Ps3Bundle // Ps3 bundle
    Sybio\Bundle\XboxBundle // Xbox bundle
    // etc ... 
```

也许更好的是，将所有控制台包添加到“控制台”存储库中：

```
Sybio\Bundle\CoreBundle // Shared entities, config and tools
Sybio\Bundle\PortalBundle // Your main portal, domain.com
Sybio\Bundle\Console\Ps3Bundle // Ps3 bundle
Sybio\Bundle\Console\XboxBundle // Xbox bundle
// etc ... 
```

CoreBundle 用于在其他包之间共享实体，但不仅仅是：它将是包含模板特定部分的包，这些模板包含在所有包中。

之后，为每个控制台创建一个 Web 控制器：

```
web/app.php // Your main site
web/app_ps3.php // Ps3 app
web/app_xbox.php // Xbox app
// etc... 
```

查看 app_ps3.php 内部，将 AppKernel 构造函数的第一个参数替换为控制台名称：

```
// ...    
$kernel = new AppKernel('ps3', false);
// ... 
```

如果需要，您可以复制开发版本中的每个控制器，例如 app_dev.php ...

现在，框架将根据使用的 web 控制器加载不同的环境。

例如，您的域“ps3.domain.com”将使用 web/app_ps3.php（我们将在最后看到如何做到这一点）。

该框架将在 app/AppKernel.php 中加载应用程序的配置：

```
public function registerContainerConfiguration(LoaderInterface $loader)
{
    $loader->load(__DIR__.'/config/config_'.$this->getEnvironment().'.yml');
} 
```

如果访问者点击 web/app_ps3.php，框架将加载 config_ps3.yml 而不是经典的 config_dev.php 或 config_prod.php。您现在将使用捆绑依赖项！

为每个控制台创建一个“app/config_myconsole.php”和一个“app/routing_myconsole.yml”。

在 config_ps3.yml（和其他控制台）中，加载您的常规配置：

```
// config_ps3.yml
imports:
    - { resource: config.yml } 
```

在此行之后覆盖 ps3 路由文件的路由包含：

```
// config_ps3.yml

// ...

framework:
    router:
        resource: "%kernel.root_dir%/config/routing_ps3.yml" 
```

要恢复，如果用户点击 web/app_ps3.yml，则加载文件 config_ps3.yml，然后加载通用 config.yml 文件，然后是 routing_ps3.yml（替换 routing.yml）。

您也可以只导入所需捆绑包的配置，对于每个配置文件，如果您有很多捆绑包，这可以减轻负载：

```
// config_ps3.yml
imports:
- { resource: config.yml }
- { resource: "@SybioCoreBundle/Resources/config/services.yml" }
- { resource: @SybioPs3Bundle/Resources/config/services.yml } 
```

使用的每个控制台应用程序都是自己的路由，以及位于 CoreBundle 中的一些共享路由和操作。

对于每个应用程序，您需要加载其控制台路由和 corebundle 路由，这里是 routing_ps3.yml 的示例：

```
// routing_ps3.yml:
SybioCoreBundle:
    resource: "@SybioCoreBundle/Controller/"
    type:     annotation
    prefix:   /

SybioPs3Bundle:
    resource: "@SybioPs3Bundle/Controller/"
    type:     annotation
    prefix:   / 
```

如果用户点击 web/app_ps3.yml，则加载来自 Ps3Bundle 和 CoreBundle 的路由...如果用户在[http://ps3.domain.com/](http://ps3.domain.com/)上，则将点击来自 Ps3Bundle 的路由“/”，而不是从另一个控制台或门户包路由“/”，因为您不加载它们！

如果您有一个在所有应用程序之间共享的通用页面，例如“/stats/”，只需在 CoreBundle 中创建此路由，这样您就不必在每个包上复制代码。当您在 Ps3Bundle 中包含 CoreBundle 路由时，框架将在两个包中搜索路由。

这条路线可以在这里访问：ps3.domain.com/stats/, xbox.domain.com/stats/...

**最后**，您需要做的最后一件事是根据子域使用正确的网络控制器，这里如何处理：

```
// web/.htaccess
<IfModule mod_rewrite.c>
    RewriteEngine On

    # Hit ps3 app
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{HTTP_HOST} !^ps3\.domain.com$ [NC]
    RewriteRule ^(.*)$ app_ps3.php [QSA,L]

    # Hit xbox app
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{HTTP_HOST} !^xbox\.domain.com$ [NC]
    RewriteRule ^(.*)$ app_xbox.php [QSA,L]

    # Hit your main portal
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{HTTP_HOST} !^www\.domain.com$ [NC]
    RewriteRule ^(.*)$ app.php [QSA,L]

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.*)$ app.php [QSA,L]
</IfModule> 
```

我对虚拟主机不太满意，但通常它可以工作！

就是这样，您知道如何使用不同的配置来加载构建在同一核心上的不同应用程序！

干杯。

# storyboard - 使用情节提要创建的没有标题的自定义 UITabbarItem

> ID：13078664
> 
> 赞同：1
> 
> 时间：2012-10-25T23:07:49.920
> 
> 标签：storyboard, title, uitabbaritem

我知道这可能是非常基本的事情，但对于我的一生，我无法弄清楚如何去做。我四处搜索，但没有看到任何有效的解决方案。

我已经使用 Storyboard 设置了一个 UITabbar，并将其设置为使用自定义图像（标签栏项目在情节提要中设置为“自定义”）。我没有为标签栏项目设置任何标题。

图像出现凸起，并且仍然为标题保留空间。图像为 30x30（视网膜为 60x60，分别命名为 info.png 和 info@2x.png）。

我尝试过的事情

```
[[UITabBarItem appearance] setTitlePositionAdjustment:UIOffsetMake(0.0, -50.0)]; 
// to make the title go off the tabbar. Have also tried other offsets less and greater than -50. 
```

这确实移动了标题，但图像保持在同一个地方。接下来我尝试了

```
UITabBarItem * tabItem5 = [self.tabBar.items objectAtIndex: 4];
[tabItem5 setTitle:nil]; 
```

这些解决方案都不起作用。我不想以编程方式声明 UITabbar。对于使用故事板/IB声明的UITabbars，必须有一种方法。

帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T13:40:56.543

目前似乎没有办法做到这一点。“最好的”（虽然对我来说不是一个很好的选择）原来是使用其他人编写的自定义类。

我遇到了一些这样的课程

[https://github.com/briancollins/BCTabBarController](https://github.com/briancollins/BCTabBarController)

[https://github.com/davidmorford/TabBarKit](https://github.com/davidmorford/TabBarKit)

[https://github.com/boctor/idev-recipes/tree/master/TabBarAnimation](https://github.com/boctor/idev-recipes/tree/master/TabBarAnimation)

不过，出于我的需要，我决定暂时保留 tabbaritem 文本。

# codeigniter - GroceryCRUD - 对字段列表进行排序（不是对实际数据进行排序，只是对字段进行排序）

> ID：13078667
> 
> 赞同：0
> 
> 时间：2012-10-25T23:08:14.323
> 
> 标签：codeigniter, grocery-crud

在 GroceryCRUD 中，我从具有这些字段的表中获取数据（因为它们在 MYSQL 中按顺序显示）

```
id,
date_added,
views,
outhits,
clicks,
title,
description 
```

我希望标题+描述在输入新行或编辑行时位于表单的顶部。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T05:44:20.687

我通过使用 columns() 方法并指定该列表中的顺序解决了这个问题，因此在您的情况下，请尝试：

```
$this->grocery_crud->columns('title',
                             'description',
                             'id',
                             'date_added',
                             'views',
                             'outhits',
                             'clicks'); 
```

# autotools - Autotools：从不同编译的源创建静态库

> ID：13078671
> 
> 赞同：2
> 
> 时间：2012-10-25T23:08:37.320
> 
> 标签：autotools, static-linking, automake, libtool, unix-ar

我正在尝试从多个来源构建一个静态库。问题是对于某些来源，我必须使用不同的`CFLAGS`.

一开始我想创建几个，最后在using`noinst_LIBRARIES`中将它们组合成一个。这种方法失败了，因为没有办法在不提取静态库的情况下组合使用它们。`lib_LIBRARIES``LIBADD``ar`

这是我`Makefile.am`目前的样子：

```
noinst_LIBRARIES = lib1.a lib2.a
lib_LIBRARIES = final.a

final_a_CFLAGS = -Werror
final_a_SOURCES = mainlib/src.c
final_a_LIBADD = lib1.a lib2.a

lib1_a_CFLAGS = -O0
lib1_a_SOURCES = lib1/src11.c lib1/src12.c

lib2_a_CFLAGS = -O3
lib2_a_SOURCES = lib2/src21.c 
```

我已经考虑过`AR`用一个`ar`包装器代替，它首先提取库，然后将它们组合到`final.a`. 但是我不喜欢这种方法，那么有没有正确的方法来实现呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-24T16:54:18.880

您可能需要便利库。它们记录在手册中。

# shell - shell脚本：嵌套循环并继续

> ID：13078677
> 
> 赞同：4
> 
> 时间：2012-10-25T23:09:30.610
> 
> 标签：shell, continue

```
while [condition]
do
  for [condition]
  do
    if [ "$x" > 3 ];then
      break
    fi
  done

  if [ "$x" > 3 ];then
    continue
  fi
done 
```

在上面的脚本中，我必须测试`"$x" > 3`两次。实际上，我第一次测试它时，如果它是真的，我想逃避 while 循环并继续下一个 while 循环。

有没有更简单的方法，所以我可以使用类似的东西`continue 2`来逃避外循环？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T01:10:05.603

“break”和“continue”是“goto”的近亲，通常应该避免，因为它们会引入一些无名条件，导致程序控制流发生飞跃。如果存在需要跳转到程序的其他部分的条件，下一个阅读它的人会感谢您为该条件命名，这样他们就不必弄清楚了！

在您的情况下，您的脚本可以更简洁地编写为：

```
dataInRange=1
while [condition -a $dataInRange]
do
  for [condition -a $dataInRange]
  do
    if [ "$x" > 3 ];then
      dataInRange=0
    fi
  done
done 
```

# python - 在python中替换字符串

> ID：13078679
> 
> 赞同：0
> 
> 时间：2012-10-25T23:10:05.617
> 
> 标签：python

我想编写一个python函数来搜索一行，寻找一个符号，如果找到，然后用一个值替换它。目标是解决`cgi`问题所以，该行如下所示：

```
<h1><font color="#CC6600">%<br></font></h1> 
```

我想检查 % 是否在页面上，然后用一个单词替换它，比如说`Suffle`. 我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T23:11:40.297

使用`str.replace()`：

```
In [24]: strs="""<h1><font color="#CC6600">%<br></font></h1>"""

In [25]: strs.replace("%","Suffle")
Out[25]: '<h1><font color="#CC6600">Suffle<br></font></h1>' 
```

要检查字符串中是否存在子字符串，我们使用`in`：

```
In [26]: "%" in strs
Out[26]: True 
```

# cloud-foundry - Cloudfoundry 部署问题

> ID：13078684
> 
> 赞同：0
> 
> 时间：2012-10-25T23:11:21.237
> 
> 标签：cloud-foundry

在 Cloud Foundry 上部署我的 spring-mysql-tomcat 应用程序时出现以下错误。此代码在本地运行良好。我有一个 bean 管理的数据源，并且能够使用 spring 提供的“jdbc-user-service”登录到应用程序，但之后没有打开尝试连接到数据库的页面。

```
type Exception report

message

description The server encountered an internal error () that prevented it from fulfilling this request.

exception

org.springframework.web.util.NestedServletException: Request processing failed; nested exception is org.springframework.transaction.CannotCreateTransactionException: Could not open JDBC Connection for transaction; nested exception is org.apache.tomcat.dbcp.dbcp.SQLNestedException: Cannot create JDBC driver of class '' for connect URL 'null'
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:656)
    org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:549)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:369)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:97)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:100)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:78)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:35)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:187)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.session.ConcurrentSessionFilter.doFilter(ConcurrentSessionFilter.java:109)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:168)
    org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)
    org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)
root cause

org.springframework.transaction.CannotCreateTransactionException: Could not open JDBC Connection for transaction; nested exception is org.apache.tomcat.dbcp.dbcp.SQLNestedException: Cannot create JDBC driver of class '' for connect URL 'null'
    org.springframework.jdbc.datasource.DataSourceTransactionManager.doBegin(DataSourceTransactionManager.java:240)
    org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:371)
    org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:335)
    org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:105)
    org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    $Proxy24.fetchAllRestaurent(Unknown Source)
    com.zeater.guru.admin.controller.RestaurantController.showRestaurantPage(RestaurantController.java:71)
    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    java.lang.reflect.Method.invoke(Method.java:597)
    org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:176)
    org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:426)
    org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:414)
    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:790)
    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
    org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:549)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:369)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:97)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:100)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:78)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:35)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:187)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.session.ConcurrentSessionFilter.doFilter(ConcurrentSessionFilter.java:109)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:168)
    org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)
    org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)
root cause

org.apache.tomcat.dbcp.dbcp.SQLNestedException: Cannot create JDBC driver of class '' for connect URL 'null'
    org.apache.tomcat.dbcp.dbcp.BasicDataSource.createConnectionFactory(BasicDataSource.java:1452)
    org.apache.tomcat.dbcp.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:1371)
    org.apache.tomcat.dbcp.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)
    org.springframework.jdbc.datasource.DataSourceTransactionManager.doBegin(DataSourceTransactionManager.java:202)
    org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:371)
    org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:335)
    org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:105)
    org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    $Proxy24.fetchAllRestaurent(Unknown Source)
    com.zeater.guru.admin.controller.RestaurantController.showRestaurantPage(RestaurantController.java:71)
    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    java.lang.reflect.Method.invoke(Method.java:597)
    org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:176)
    org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:426)
    org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:414)
    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:790)
    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
    org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:549)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:369)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:97)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:100)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:78)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:35)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:187)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.session.ConcurrentSessionFilter.doFilter(ConcurrentSessionFilter.java:109)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:168)
    org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)
    org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)
root cause

java.lang.NullPointerException
    sun.jdbc.odbc.JdbcOdbcDriver.getProtocol(JdbcOdbcDriver.java:507)
    sun.jdbc.odbc.JdbcOdbcDriver.knownURL(JdbcOdbcDriver.java:476)
    sun.jdbc.odbc.JdbcOdbcDriver.acceptsURL(JdbcOdbcDriver.java:307)
    java.sql.DriverManager.getDriver(DriverManager.java:253)
    org.apache.tomcat.dbcp.dbcp.BasicDataSource.createConnectionFactory(BasicDataSource.java:1437)
    org.apache.tomcat.dbcp.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:1371)
    org.apache.tomcat.dbcp.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)
    org.springframework.jdbc.datasource.DataSourceTransactionManager.doBegin(DataSourceTransactionManager.java:202)
    org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:371)
    org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:335)
    org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:105)
    org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    $Proxy24.fetchAllRestaurent(Unknown Source)
    com.zeater.guru.admin.controller.RestaurantController.showRestaurantPage(RestaurantController.java:71)
    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    java.lang.reflect.Method.invoke(Method.java:597)
    org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:176)
    org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:426)
    org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:414)
    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:790)
    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
    org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:549)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:369)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:97)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:100)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:78)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:35)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:187)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.session.ConcurrentSessionFilter.doFilter(ConcurrentSessionFilter.java:109)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:168)
    org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)
    org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)
note The full stack trace of the root cause is available in the Apache Tomcat/6.0.35 logs.

Apache Tomcat/6.0.35 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T06:13:19.170

CF 尝试智能地调整应用程序与绑定到它的服务。这就是所谓的“自动重新配置”。您可能想检查一下并在之后查看您的 spring 应用程序：http: [//docs.cloudfoundry.com/frameworks/java/spring/spring.html#determining-whether-your-application-can-be-auto-configured](http://docs.cloudfoundry.com/frameworks/java/spring/spring.html#determining-whether-your-application-can-be-auto-configured)

如果您不想利用自动重新配置，“选择退出自动重新配置”部分将帮助您摆脱这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T17:51:52.353

我认为这已解决，我有 2 个数据源定义，一个在安全配置中，一个在应用程序上下文中，我只更改了一次。因此，任何人都可以通过 CF 轻松地使用 spring 管理的数据源连接他们的应用程序。

# sql - 我有什么替代方法可以匹配散列或使用游标吗？

> ID：13078689
> 
> 赞同：1
> 
> 时间：2012-10-25T23:12:00.920
> 
> 标签：sql, cursor

对 sql 开发仍然很陌生，但学习速度很快。

这种情况可以通过实体框架来解决，但这不是一种选择。

需要向两个表中插入数据。下面说明情况。

主表有一个身份键，当插入与键相关的记录相关的数据时，子表也需要该键。

源信息来自其他几个表。我无法更改主表或子表结构。

我试图避免使用光标，但我没有看到任何替代方案。

我尝试在#temp1 中使用输出inserted.main_id - 这有效，但我也找不到将Sub_ID 放入该临时表的方法。Sub_ID 来自源。

他们的工作方式是将数据插入主表，然后通过将源中的哈希与主表进行匹配，然后我可以将 Main_ID 插入具有相应 Sub_ID 的子表中。

例子

```
TABLE MAIN    
Main_ID    PK, bigint,not null - identity
FirstName    varchar(15) not null
LastName    varchar(15) not null
Misc1    varchar(15)null
Misc2    varchar(15) null
Misc3    varchar(15) null

TABLE SUB    
Main_ID    PK,FK,bigint, not null
Sub_ID    int null
Misc4    varchar(15)
Misc5    varchar(15)
Misc6    varchar(15) 
```

有没有办法将 Sub_ID 和“输出插入的.main_id”一起捕获到临时表中？

现在我正在做的是匹配来自源的哈希和插入到主表中的记录，以获得将插入到子表中的 Main_ID。

如果我可以在 Main 表中生成 Main_ID 时将 Sub_ID 捕获到临时表中，则该过程会快得多。我想避免使用光标，但我认为这是我现在最好的选择。

# text - 如何破译一段文字？

> ID：13078692
> 
> 赞同：0
> 
> 时间：2012-10-25T23:12:13.510
> 
> 标签：text, encryption

我收到一条短信：

> Xli wigsrh qiwweki aew irgvctxih ywmrk xli pmriev gshi amxl e xlvii erh o wmb。

我需要解密它。如何在不知道使用哪种方法对其进行编码的情况下破译文本？我只需要一些提示。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T00:01:33.103

解密通过实现加密（加密）效果的反转来工作：

*   通过蛮力，基本上意味着“试错”，无论是手动还是使用自动化或半自动化工具；并且通常包括找出您正在处理的密码类型，以使破译更容易。

或者

*   通过获取加密或解密代码并对其进行逆向工程，除非应用程序 100% 本地化，否则几乎无法获得；更不用说这样做几乎总是完全违法的。

这适用于解密所有类型的加密，但请注意，这仅考虑加密，并且加密几乎从不单独应用：诸如[散列](http://en.wikipedia.org/wiki/Hash_function)、[消息摘要](http://en.wikipedia.org/wiki/Cryptographic_hash_function)和[混淆](http://en.wikipedia.org/wiki/Obfuscation_%28software%29)之类的东西存在并且与它一起被广泛使用。

* * *

至于您的具体情况，正如@nickhar 提到的那样： A [substitution-cipher](http://en.wikipedia.org/wiki/Substitution_cipher)，意味着字母表元素的位置被旋转和/或交换。

我不会骗你的：这是一个非常弱的密码，可以通过一些单词字母计数和猜测手动破译，因此，有很多自动化工具可以用按下一个按钮。

但话又说回来，我不会对你撒谎：如果你想真正理解这些东西，那就低下头，弄脏你的手，然后自己做（破译）。

如果您学习和学习，您将立即[回答此类问题](https://stackoverflow.com/questions/12937641/handling-passwords-used-for-auth-in-source-code)！=D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-31T21:09:11.707

破译没什么大不了的。您只需要检查 k 的每个值，即 25，因为总共有 26 个字母。

解密后给出“第二条消息是使用线性代码加密的，带有 3 和 k 6”，使用的 K 为 4（k=4）。

# c++ - C++，是否可以使用要求它属于某个类来声明一个对象？

> ID：13078694
> 
> 赞同：-1
> 
> 时间：2012-10-25T23:12:26.770
> 
> 标签：c++, oop, object

首先，我是 C++ 新手，尤其是以 OOP 方式使用 C++。我有一个有多个子类的类，我想知道我是否可以含糊地声明一个变量来接受一个对象，而不限制哪些对象可以存储在其中。我问是因为多个孩子中的一个最终会被一次使用。因此，如果我不能模棱两可地声明一个变量，我可以通过一种方法来确定正在使用的众多变量中的哪一个。

类似的东西

`obj randomObj = new className;`

代替

`className randomObj = new className`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:16:34.463

由于所有类都派生自一个公共基类，因此您可以将变量声明为该基类类型，但仍然可以将任何派生类分配给它，例如：

```
class BaseClass
{
...
};

class DerivedClass : public BaseClass
{
...
};

BaseClass *randomObj = new DerivedClass; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T23:17:16.730

一个容器只能包含相同类型的对象。如果你想要一个异构集合，你需要在容器中插入一个“句柄”类型并间接访问对象。标准句柄类型是*指针*，标准构造是`std::vector<std::unique_ptr<Base>>`，像这样：

```
#include <memory>
#include <utility>
#include <vector>

template <typename T, typename ...Args>
std::unique_ptr<T> make_unique(Args &&... args)
{
    return std::unique_ptr<T>(new T(std::forward<Args>(args)...)); // or "::new"
}

struct Base
{
     virtual ~Base() { }
};

struct Derived1 : Base { /* ... */ };
struct Derived2 : Base { /* ... */ };
struct Derived3 : Base { /* ... */ };

std::vector<std::unique_ptr<Base>> v; 
```

**用法：**

```
v.push_back(make_unique<Derived1>(true, 'a'));
v.push_back(make_unique<Derived2>(11, 22, 33));
v.push_back(make_unique<Derived3>("hello", "world")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T23:36:19.000

您说您是 C++ 新手，而您用来描述所需内容的语法表明您更熟悉其他语言，例如 Java 或 C#。您显示的语法在这些语言中运行良好：

```
Foo myFoo = new DerivedFoo; 
```

这是因为，在 Java 和 C# 的幕后`myFoo`实际上表现为指向 Foo 的指针，而不是能够存储 Foo 的固定内存区域的名称。在 C++ 中，语法`Foo myFoo`创建了这样一个固定的内存区域。即使您尝试通过这样做将一些派生类型放在那里：

```
DerivedFoo myDerivedFoo;
Foo myFoo = myDerivedFoo; 
```

`myFoo`仍然只能持有一个 Foo 对象。在 Foo 的初始化过程中，所有不是 Foo 的东西都会被“切掉” `myFoo`，因为它不适合那个固定的内存区域。

因此，在 C++ 中，您必须使用 C++ 的指针语法显式地执行 Java 和 C# 在幕后所做的事情：

```
 Foo *myFoo = new DerivedFoo; 
```

Now`myFoo`是一个指向 Foo 的指针，该指针可以引用任何`Foo`对象，包括 DerivedFoo 的 Foo 部分，而无需任何切片或任何事情发生。`new DerivedFoo`创建一个 DerivedFoo 可以存在的内存区域，然后`myFoo`设置为指向`Foo`created 的部分`DerivedFoo`。

# java - 有没有一种简单的方法可以使 Jackson ObjectMapper 从 Iterator 反序列化 >?

> ID：13078698
> 
> 赞同：0
> 
> 时间：2012-10-25T23:12:40.310
> 
> 标签：java, json, jackson

由于复杂的原因，我的原始输入是一堆 Pair < JsonToken, String >。有没有办法让我的 Jackson ObjectMapper 从此表单反序列化 JSON？我想如果我可以将它转换为 JsonNode 树或 JsonParser 它会起作用。让我自己实现 JsonParser 看起来很痛苦。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:49:14.617

您也许可以从中建立一个`TokenBuffer`；并且由于它同时实现了`JsonParser`and `JsonGenerator`，因此可以将其传递给其余的功能。

# asp.net-mvc-3 - 通过浏览器访问 SignalR 集线器

> ID：13078701
> 
> 赞同：0
> 
> 时间：2012-10-25T23:13:07.877
> 
> 标签：asp.net-mvc-3, signalr, signalr-hub

如何通过浏览器访问 Signalr Hub？我在其中创建了名为“testhub”（使用`HubName`属性）和方法“Hello”的集线器，所以我想像这样访问它：`http://serverurl/signalr/testhub/Hello`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:42:55.913

SignalR 是一个实时消息传递框架，因此首先使用几个更高级别的协议之一通过 HTTP（最好是 WebSockets，最坏情况是长轮询）建立连接，然后通过传递 JSON 格式的消息来调用 Hub 方法本身。级协议。

您描述的示例似乎您期待一个请求/响应模型，为此您最好使用基于 REST 的技术，如 ASP.NET MVC 或 ASP.NET Web API。

# sql - 从 SQL 结果存储 ID

> ID：13078704
> 
> 赞同：0
> 
> 时间：2012-10-25T23:13:45.177
> 
> 标签：sql, vb.net, executereader

我运行以下代码来判断用户是否存在于数据库中 - 标准的东西。显然，一旦代码运行，如果有结果，将返回布尔值 true 或 false。如果找到结果，我想存储所述结果的 ID。谁能告诉我我是怎么做的？

代码：

```
 Username = txtUserName.Text
    Password = txtPassword.Text
    dbConnInfo = "PROVIDER=Microsoft.Jet.OLEDB.4.0; Data Source = C:\Users\Dave\Documents\techs.mdb"
    con.ConnectionString = dbConnInfo
    con.Open()
    Sql = "SELECT * FROM techs WHERE userName =  '" & Username & "' AND '" & Password & "'"
    LoginCommand = New OleDb.OleDbCommand(Sql, con)
    CheckResults = LoginCommand.ExecuteReader
    RowsFound = CheckResults.HasRows
    con.Close()
    If RowsFound = True Then

        MsgBox("Details found")

        TechScreen.Show()
    Else
        MsgBox("Incorrect details")
    End If 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T00:20:58.787

您发布的代码段存在很多问题。希望我能帮助您纠正这些问题。

为了加载结果的 ID，您需要使用[SqlCommand.ExecuteScalar()](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx)，因为它经过优化以从 Sql 中拉回一个结果。

至于您的代码有什么问题，您对 Sql Injection 攻击持开放态度，您应该使用[参数化查询](https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet#Defense_Option_1%3a_Prepared_Statements_.28Parameterized_Queries.29)，如下面的示例所示。

```
Public Function AddProductCategory( _
  ByVal newName As String, ByVal connString As String) As Integer 
    Dim newProdID As Int32 = 0
    Dim sql As String = _
     "INSERT INTO Production.ProductCategory (Name) VALUES (@Name); " _
       & "SELECT CAST(scope_identity() AS int);" 

Using conn As New SqlConnection(connString)
    Dim cmd As New SqlCommand(sql, conn)
    cmd.Parameters.Add("@Name", SqlDbType.VarChar)
    cmd.Parameters("@Name").Value = newName
    Try
        conn.Open()
        newProdID = Convert.ToInt32(cmd.ExecuteScalar())
    Catch ex As Exception
        Console.WriteLine(ex.Message)
    End Try 
End Using 

Return newProdID
End Function 
```

资料来源：[MSDN](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx)

# android - 为什么我的 ListView 在新设备上滞后，但在旧设备上却很快？

> ID：13078706
> 
> 赞同：5
> 
> 时间：2012-10-25T23:13:49.217
> 
> 标签：android

所以我正在做典型的列表视图视图模式。如果用户抛出列表，我还在后台线程中设置图像并禁用加载图像。

在较旧的设备（Galaxy s、htc 渴望、原始 Google Nexus）上，我的列表视图可以完美运行，完全没有延迟，即使我滚动/翻动列表视图也是如此。但是，在我的较新设备（Galaxy S3、Nexus）上，它是超级滞后的。

我正在执行相当多的 if/else 条件来设置某些视图的可见性。这可能是根本原因吗？如果是这样，为什么它只会影响较新的设备？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T02:13:59.920

很难说没有看到你的代码。尝试将设备连接到 adb，打开 DDMS 并按下方法分析按钮（带有 3 个箭头和一个红点的图标），然后开始在您的应用程序中滚动几秒钟。按下停止分析按钮（相同的按钮），[Traceview](http://developer.android.com/guide/developing/debugging/debugging-tracing.html)将打开，您会看到是什么耗尽了所有 CPU 时间。

# git - git 中多个分支的热修复

> ID：13078707
> 
> 赞同：1
> 
> 时间：2012-10-25T23:13:51.447
> 
> 标签：git

在 Git 中，我有两个主要分支：一个稳定分支和一个“测试版”分支。

一组人使用从“beta”分支编译的代码，而大多数人使用从稳定分支编译的代码。每隔一段时间，“beta”分支就会与 stable 分支合并，但并不经常。在两次发布之间，我有时会对稳定分支和“beta”分支进行修补。我不确定在这种情况下最佳做法是什么，但我通常会创建一个补丁并将其分别应用于两个分支。我不想将“beta”分支合并到稳定分支上来分发修补程序。我也不希望稳定的分支用户等待几个月来合并以分发一个简单的修补程序。

在这种情况下创建补丁是否正确？还是应该在创建修补程序时将稳定版合并到“beta”分支上？对我来说，将 stable 合并回“beta”似乎是个坏主意，而它通常会反过来（我可能是错的；我不是 Git 专家）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:15:07.257

为什么不从一个分支[挑选](http://www.kernel.org/pub/software/scm/git/docs/git-cherry-pick.html)你的提交到另一个分支？这样，您将携带提交信息以及提交的更改，而不必合并完整的分支。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-01T16:41:21.853

这是一篇旧帖子，但如果有人想知道，我发现这是最佳实践：

稳定分支上的补丁和提交修补程序不断将稳定分支合并到“beta”分支

当我发布这个问题时，我是一个 Git 菜鸟。我发现这种策略比樱桃采摘要好得多（尽管确实有效），因为当我们最终确定 beta 代码是稳定的时，我们可以更轻松地将“beta”合并到稳定中。希望有帮助。

# ruby - 在 Ruby 中对数组进行哈希处理

> ID：13078708
> 
> 赞同：0
> 
> 时间：2012-10-25T23:13:51.827
> 
> 标签：ruby, arrays, multidimensional-array

我在 Ruby 中有一个数组，如下所示：

```
@arr = [ [2.1, pass], 
         [2.1, fail],
         [2.1, pass],
         [2.1, unknown],
         [2.1, pass],
         [3.0, pass],
         [3.0, unknown],
         [3.1, pass],
         [3.1, fail] ] 
```

我想对其应用某种散列或计算，以便我的输出应该是一个数组，如：

```
@result = [ [2.1, 3, 1, 1],
            [3.0, 1, 0, 1],
            [3.1, 1, 1, 0] ] 
```

输出数组以这种格式显示结果 {version, no.of pass, no.of fail, no.of unknown}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T23:32:49.543

如果我稍微翻译一下你的表达...

```
@arr = [
  [2.1, :pass],
  [2.1, :fail],
  [2.1, :pass],
  [2.1, :unknown],
  [2.1, :pass],
  [3.0, :pass],
  [3.0, :unknown],
  [3.1, :pass],
  [3.1, :fail]] 
```

那么问题就可以解决了...

```
@arr.group_by(&:first).values.map do |x|
  y = x.flatten
  [y[0], y.count(:pass), y.count(:fail), y.count(:unknown)]
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T23:19:51.087

这些不是有效的哈希。哈希必须有与之关联的键。这是初始示例中的数组哈希：

```
@arr = { something: [2.1, pass], 
         somethingelse: [2.1, fail],
         another: [2.1, pass],
         andanother: [2.1, unknown],
         whatever: [2.1, pass],
         whateverelse: [3.0, pass],
         key: [3.0, unknown],
         anotherkey: [3.1, pass],
         yetanother: [3.1, fail] } 
```

哈希用 { 和 } 标记。数组是 [ 和 ]。如果你想要一个数组数组，你可以使用 [ 和 ]。

# c++ - 通过加法相乘

> ID：13078709
> 
> 赞同：-3
> 
> 时间：2012-10-25T23:13:51.043
> 
> 标签：c++, multiplication, addition

我想创建一个函数，通过使用可以同时处理负数和正数的加法来找到两个整数的乘积。

这是我到目前为止的代码...得到疯狂的数字作为结果..我是菜鸟..谢谢

```
double multi(double n1, n2)
{

  double answer(0), i=0;

  do
  {
    answer += n1; i++;
  } while (i < n2);

  return answer;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:22:22.670

您可以从使用整数而不是双精度开始，并将它们都作为参数传递......

```
int multi( int x, int y )
{
    int answer = 0;

    // stuff goes here...

    return answer;
} 
```

我怀疑这是作业，所以我不会逐字给你代码......

但是请考虑，如果一个值为负，则如果该相同值为正，则相对于答案的结果将被否定。有效地，如果您要添加`x`并执行`y`次数，那么您可以翻转两者的符号，`x`如果`y`是`y`负数。这否定了答案，并给你一个积极`y`的循环。

一种优化是检查两个值中的哪一个较大，并使用较小的一个作为循环变量。

* * *

> ..是的，这是hmwk ..但我很抱歉我不明白你的意思..

假设你有两个整数`X`和`Y`。如果`Y`为正，则很容易看出：

```
X * Y = (X + X + X + X + ...) 
```

现在，如果`Y`是负数呢？我将`-Y`用来表示：

```
X * -Y = -(X * Y)
       = -(X + X + X + X + ...)
       = (-X - X - X - X - ...)
       = ((-X) + (-X) + (-X) + (-X) + ...) 
```

所以，如果是肯定的，`Y`我将. 如果是负数，我将.`Y``X``Y``-Y``-X`

如果这仍然没有帮助，那么我建议您坐下来考虑一下。

# php - 如何使用 php-撇号问题创建新的 php 页面

> ID：13078711
> 
> 赞同：0
> 
> 时间：2012-10-25T23:13:55.753
> 
> 标签：php

更清楚地说，我确实了解如何使用我正在使用的 php 创建一个新的 php 文件`fwrite`，如下所示：

```
//actually create the file now

$my_file=$post_title_edited . ".php";;

$fh= fopen($my_file, 'w');

fwrite($fh, $head);
fwrite($fh, $body);
fwrite($fh, $php);
fwrite($fh, $php2);
fwrite($fh, $php3);
fwrite($fh, $phpend);
fwrite($fh, $end); 
fclose($fh);

//redirect to created file
header("location:". $post_title_edited .".php"); 
```

现在一切正常，或者更确切地说，如果不是因为这个问题，它会：

```
$php3='

session_start();

if(isset($_SESSION['login'])){
    $myusername = $_SESSION['login'];

    echo '  <div id="header-logedin">
              <h3>Hello ' . $myusername . '</h3>
              <a href="login/logout.php">Log out</a>
            </div><!--header-logedin-->
         ';
} else {
    echo $log;
} 
```

如您所见，当我开始设置时`$php3`，它被我第一次会话调用的登录名中的撇号中断。因此它无法设置，反过来我也无法将它写入我的新文件，也`$php2`有同样的问题。

我想做什么？简而言之：用户从 index.php 发布的信息发布到由该代码创建的新页面上，然后根据 sql 表检查数据以确保它不存在，非常像一个论坛。我真的希望这是一件复杂的事情，我不会忽视一些非常明显的事情。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:21:55.063

目前尚不清楚您要做什么，但是您似乎遇到了逃避问题。

要使撇号实际上不结束字符串，您可以：

*   用斜杠转义它，如下所示：

    ```
    $s = 'string with \'single quotes\' inside' 
    ```

*   在里面使用双引号：

    ```
    $s = 'string with "double quotes" inside' 
    ```

*   使用heredoc。

    ```
    $s = <<<END
    This string uses a heredoc. So it doesn't use 'single' or "double" quotes.
    END; 
    ```

**编辑：** 还要检查您是否正在尝试做一些明智的事情。问问自己：你真的需要创建一个新的 PHP 文件吗？通过这样做，你肯定会给你的代码增加太多的复杂性，还有奇怪的、几乎无法检测到的错误，可能还有一堆安全问题。

# javascript - 滚动时将 div 保持在页面顶部

> ID：13078713
> 
> 赞同：1
> 
> 时间：2012-10-25T23:14:02.193
> 
> 标签：javascript, html, css

===================

名称：//html文本框//

年龄：//文本框//

//div//

//桌子//

===================

假设上面是一个 HTML 页面。还假设该表至少有 50 行，以便可以滚动整个页面。目前，当我滚动页面时，整个页面（div、table）都会滚动。我希望 div 在滚动时位于页面顶部，如下图所示：

===================

//div//

...

...

...

//row21//

//row22//

...

...

===================

**我想知道这是否可能。我尝试对 div 使用 CSS：**

//div的CSS：

位置：固定；

**宽度：100；**

但是，它会准确地显示 div 的位置。但是，我想在滚动时将 div 移动到页面顶部。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:19:09.187

这不是微不足道的

*   您将需要使用 JavaScript 来复制 div 并使其位置固定。
*   您将需要处理滚动事件来隐藏和显示固定 div

我有一个小型库来为表头做这样的事情，我认为您可以阅读源代码或按原样使用表

演示：[http](http://www.agyey.com/demo/stickyhead/demo.html)
://www.agyey.com/demo/stickyhead/demo.html 代码：[https ://bitbucket.org/anuraguniyal/stickyhead](https://bitbucket.org/anuraguniyal/stickyhead)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T23:17:50.677

这仅在 CSS 中是不可能的。如您所知，您可以使用：

```
position: fixed 
```

将元素相对于浏览器窗口保持在同一位置，但是为了在滚动内容时将其移动到顶部，您需要使用 JavaScript。

您可能想查看[此 SO 帖子](https://stackoverflow.com/questions/7591107/how-to-create-a-bar-that-stays-on-top-when-scrolling)以了解如何实现该效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T23:18:53.420

您需要将其添加到 CSS 中。

```
 top:100px;//adjust til the div is below the name and age section.
  position:fixed; 
```

我想这就是你要找的。

# mysql - 一条记录MYSQL的多条数据

> ID：13078714
> 
> 赞同：0
> 
> 时间：2012-10-25T23:14:10.683
> 
> 标签：mysql, record

我有一个名为 medOrder 的表。在这张桌子上，我有订单。一份订单有很多愿望。我试图编写一个查询来显示一条记录和所有愿望的名称，但我认为查询并没有做到最好。

```
SELECT m.ordcode as koden, w.wish, r.meaName as rnamn, r.meaImg as bild, 
        r.meaPrice as pris, k.catName as cname from cats k, meals r, wishes w,
        meaOrder m
    join orders c on c.ordNR='7265'
    WHERE m.ordNR=c.ordNR AND m.meaID=r.meaID AND m.wishesID=w.id
        AND r.catID=k.catID
    ORDER BY m.ordcode DESC; 
```

![数据模式](../Images/3d1f4b1919a8d94835d7aa9ecf318e3f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:27:48.157

试试这个查询：

```
SELECT koden, GROUP_CONCAT(wish) wish, rnamn, bild, pris, cname 
FROM
(
SELECT m.ordcode as koden, w.wish, r.meaName as rnamn, r.meaImg as bild, 
        r.meaPrice as pris, k.catName as cname from cats k, meals r, wishes w,
        meaOrder m
    join orders c on c.ordNR='7265'
    WHERE m.ordNR=c.ordNR AND m.meaID=r.meaID AND m.wishesID=w.id
        AND r.catID=k.catID
) T
GROUP BY koden, rnamn, bild, pris, cname
ORDER BY koden DESC 
```

此查询`GROUP BY`对所有重复列执行，但连接 的非重复列的值`wish`。

# javascript - jqplot 选项的问题

> ID：13078717
> 
> 赞同：1
> 
> 时间：2012-10-25T23:14:53.727
> 
> 标签：javascript, jquery, jqplot

如果这已在其他地方得到回答，我深表歉意，但我一直在寻找一段时间，找不到任何东西。我对 javascript 和 jqplot 还是很陌生，我基本上是通过复制和修改我在网上找到的一些示例脚本来创建我的代码，所以请在你的答案中尽可能简单和具体，并包含一些上下文相关的。

我正在尝试使用 constrainTo 选项将可移动点锁定到 y 轴。我在 jqplot 的文档中看到该命令应该类似于 constrainTo: 'y' 但我无法弄清楚代码中应该去哪里。我的代码在下面，因此您可以看到我目前正在尝试的内容（不工作）。我也尝试了许多其他配置，但它们要么使代码无法工作，要么就没有效果。非常感谢您的帮助！

```
<html>
 <head>
 <title>Limbo</title>
 <script language="javascript" type="text/javascript" src="jqPlot/dist/jquery.min.js">    </script>
 <script language="javascript" type="text/javascript" src="jqPlot/dist/jquery.jqplot.min.js"></script>
 <script language="javascript" type="text/javascript" src="jqPlot/dist/plugins/jqplot.highlighter.js"></script>
 <script language="javascript" type="text/javascript" src="jqPlot/dist/plugins/jqplot.dragable.min.js"></script>
 <script language="javascript" type="text/javascript" src="jqPlot/dist/plugins/jqplot.canvasOverlay.min.js"></script>
 <script language="javascript" type="text/javascript" src="jqPlot/dist/plugins/jqplot.BezierCurveRenderer.min.js"></script>
 <link rel="stylesheet" href="jqPlot/dist/jquery.jqplot.min.css" type="text/css"     media="all" />
 <!--[if IE]><script language="javascript" type="text/javascript" src="./scripts/jqplot/excanvas.js"></script><![endif]-->
 <script language="javascript" type="text/javascript">

 $(document).ready(function() {
 $.jqplot.config.enablePlugins = true;
 $.jqplot('chartdiv',  [[[0,2000],[1,1800],[2,1500],[3,1100],[4,700],[5,300],[6,150],[7,100],[8,60],[9,20],[10,0]]], 
    {
        title: 'Decline Rate',
    seriesDefaults: {
            dragable: {
                constrainTo: 'y'
            }
        }   
    });
 });

 </script>
 </head>
 <body>
 <div id="chartdiv" style="height:400px;width:300px;"></div>
 </body>

</html> 
```

*最后一点：当然，要渲染此代码，您必须将 src 文件更改为它们在您计算机上的任何位置，我假设回答的人会知道这一点。不过，值得注意的是，这段代码确实对我有用，只是约束不起作用（就此而言，我也尝试添加其他选项，如阴影等，但这是另一个问题）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:48:40.390

看起来选项没有进入 seriesDefault，我将选项移动到 series 并且它只是工作。

```
series: [{
    dragable: {
        constrainTo: 'y'
    }
}] 
```

查看[jsFiddle](http://jsfiddle.net/finfin/uGqnN/)

# winapi - Win32 api编程-调整大小后的wm_paint

> ID：13078719
> 
> 赞同：1
> 
> 时间：2012-10-25T23:14:56.187
> 
> 标签：winapi

我想在每次调整窗口大小时重绘窗口，但我不想在调整大小完成之前调用 WM_PAINT。我尝试使用 WM_EXITSIZEMOVE 消息，但没有成功。有没有办法，例如在每次调整大小时（在调整大小后的每只鼠标上）绘制 TextOut？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T00:56:42.397

当您收到时`WM_EXITSIZEMOVE`，只需`Invalidate()`在窗口中生成一条`WM_PAINT`新消息并让 Windows 自行调度。

# asp.net - 在 Windows Embedded Handheld 6.5 设备上的 IE 中播放声音

> ID：13078721
> 
> 赞同：0
> 
> 时间：2012-10-25T23:15:07.630
> 
> 标签：asp.net, html, windows-embedded

我需要在 ASP.NET Web 应用程序中播放声音。

目前我正在使用

```
<embed id="SoundPlaceholder" runat="server" src="/Audio/success.wav" hidden="true" autostart="true" loop="false" /> 
```

这在桌面上的 IE 中运行良好，但是，当我在 Windows Embedded 设备上的 IE 中运行它时，没有声音播放。

**操作系统：Windows Embedded Handheld 6.5**

有谁知道我该如何解决这个问题，或者是否有另一种选择可以在网页上播放简单的短声音。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T01:40:57.230

我设法让这个工作，事实证明`<embed>`设备不支持，也不支持`<object>`。

```
<bgsound src="file://\windows\critical.wav" loop="1"> 
```

这将播放实际设备上的critical.wav 声音文件（因此无需下载）。但是，您也可以在服务器上指定一个 .wav 文件。

# python - 生菜入门：“XMLSyntaxError：无”

> ID：13078726
> 
> 赞同：1
> 
> 时间：2012-10-25T23:16:18.977
> 
> 标签：python, django, lxml, nose, lettuce

我一直在尝试在 django 项目中启动并运行一组基本的[生菜](http://lettuce.it/index.html)测试，但我遇到了一些问题。

我按照[生菜网站上的示例教程进行操作](http://lettuce.it/recipes/django-lxml.html)，但运行时不断出现以下错误`python manage.py harvest`：

```
Feature: Rocking with lettuce and django               #apps/my_app/features/index.feature:1

  Scenario: Simple Hello World                         # apps/my_app/features/index.feature:3
    Given I access the url "/admin"                    # apps/my_app/features/index-steps.py:12
    Given I access the url "/admin"                    # apps/my_app/features/index-steps.py:12
    Traceback (most recent call last):
      File "/home/myhome/.virtualenvs/my_env/lib/python2.7/site-packages/lettuce/core.py", line 141, in __call__
        ret = self.function(self.step, *args, **kw)
      File "/home/myhome/code/my_app/apps/my_app/features/index-steps.py", line 14, in access_url
        world.dom = html.fromstring(response.content)
      File "/home/myhome/.virtualenvs/my_env/lib/python2.7/site-packages/lxml/html/__init__.py", line 634, in fromstring
        doc = document_fromstring(html, parser=parser, base_url=base_url, **kw)
      File "/home/myhome/.virtualenvs/my_env/lib/python2.7/site-packages/lxml/html/__init__.py", line 532, in document_fromstring
        value = etree.fromstring(html, parser, **kw)
      File "lxml.etree.pyx", line 2756, in lxml.etree.fromstring (src/lxml/lxml.etree.c:54726)
      File "parser.pxi", line 1578, in lxml.etree._parseMemoryDocument (src/lxml/lxml.etree.c:82843)
      File "parser.pxi", line 1457, in lxml.etree._parseDoc (src/lxml/lxml.etree.c:81641)
      File "parser.pxi", line 965, in lxml.etree._BaseParser._parseDoc (src/lxml/lxml.etree.c:78311)
      File "parser.pxi", line 569, in lxml.etree._ParserContext._handleParseResultDoc (src/lxml/lxml.etree.c:74567)
      File "parser.pxi", line 650, in lxml.etree._handleParseResult (src/lxml/lxml.etree.c:75458)
      File "parser.pxi", line 601, in lxml.etree._raiseParseError (src/lxml/lxml.etree.c:74958)
    XMLSyntaxError: None
    Then I see the header "Log in | Django site admin" # apps/my_app/features/index-steps.py:17
    Then I see the header "Log in | Django site admin" # apps/my_app/features/index-steps.py:17

1 feature (0 passed)
1 scenario (0 passed)
2 steps (1 failed, 1 skipped, 0 passed) 
```

我的虚拟环境中安装了以下内容：

```
Django==1.4.1
MySQL-python==1.2.3
South==0.7.6
Werkzeug==0.8.3
boto==2.6.0
cssselect==0.7.1
django-extensions==0.9
django-nose==1.1
django-storages==1.1.5
django-tastypie==0.9.11
fuzzywuzzy==0.1
lettuce==0.2.10
lxml==2.3.5
mimeparse==0.1.3
mock==1.0.0
nose==1.2.1
python-dateutil==1.5
selenium==2.25.0
sure==1.0.6
wsgiref==0.1.2 
```

这是一个错误，还是我在某个地方犯了一些错误？我原以为这个例子会涵盖它......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T14:36:28.720

显然，这个错误是一个红鲱鱼。我得到`XMLSyntaxError`是因为来自 URL 的响应是空的（在这种情况下，我正在检查的 URL 缺少尾部斜杠）。

因此，如果有人遇到此问题，请务必先验证您自己的代码是否有效，然后再指责他人的代码。

# asp.net-mvc-4 - 如何在 Asp Net MVC 4 Web Api 的自定义模型绑定器中访问我的请求内容？

> ID：13078732
> 
> 赞同：2
> 
> 时间：2012-10-25T23:17:18.610
> 
> 标签：asp.net-mvc-4, asp.net-web-api, custom-model-binder

我一直在思考如何解决我在上一个问题中遇到的问题

[我可以访问 .net Web api 模型绑定无法处理的数据吗？](https://stackoverflow.com/questions/12967254/can-i-get-access-to-the-data-that-the-net-web-api-model-binding-was-not-able-to)

我可以使用我自己的自定义模型绑定器，这样我就可以处理完美的案例，并在我得到我不期望的数据时写入日志。

我有以下课程和模型绑定器

```
 public class Person
{
    public int Id { get; set; }
    public string Name { get; set; }
}

public class CustomPersonModelBinder : IModelBinder
{
    public bool BindModel(HttpActionContext actionContext, ModelBindingContext bindingContext)
    {
        var myPerson = bindingContext.ValueProvider.GetValue(bindingContext.ModelName);
        var myPersonName = bindingContext.ValueProvider.GetValue("Name");

        var myId = bindingContext.ValueProvider.GetValue("Id");

        bindingContext.Model = new Person {Id = 2, Name = "dave"};
        return true;
    }
}

public class CustomPersonModelBinderProvider : ModelBinderProvider
{
    private  CustomPersonModelBinder _customPersonModelBinder = new CustomPersonModelBinder();

    public override IModelBinder GetBinder(HttpConfiguration configuration, Type modelType)
    {
        if (modelType == typeof (Person))
        {
            return _customPersonModelBinder;
        }
        return null;
    }
} 
```

这是我的控制器方法

```
 public HttpResponseMessage Post([ModelBinder(typeof(CustomPersonModelBinderProvider))]Person person)
    {
        return new HttpResponseMessage(HttpStatusCode.OK);
    } 
```

我一直在使用提琴手来调用它

```
Post http://localhost:18475/00.00.001/trial/343

{  
        "Id": 31,
        "Name": "Camera Broken"
} 
```

这很好用，在不使用自定义模型绑定器的情况下，我在 post 方法中从我的 json 数据中填充了一个 Person 对象，并且使用自定义模型绑定器，我总是得到一个人（Id= 2，Name =“dave”）。

问题是我似乎无法访问自定义模型活页夹中的 JSon 数据。

bindModel 方法中的 myPerson 和 myPersonName 变量都是 null。但是 myId 变量填充了 343。

任何想法如何在我的 BindModel 方法中访问 json 中的数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T06:05:11.480

尝试这个：

```
actionContext.Request.Content.ReadAsStreamAsync() 
```

# c++ - Fortran 与 C++，如今 Fortran 在数值分析中是否仍然具有优势？

> ID：13078736
> 
> 赞同：50
> 
> 时间：2012-10-25T23:18:11.277
> 
> 标签：c++, c, cuda, fortran

随着 C++ 编译器（尤其是 intel 编译器）的快速发展，以及在 C/C++ 代码中直接应用 SIMD 函数的能力，Fortran 在数值计算领域是否仍然具有真正的优势？

我来自应用数学背景，我的工作涉及大量数值分析、计算、优化等，并具有严格定义的性能要求。

我对 Fortran 几乎一无所知，我在 C/CUDA/matlab 方面有一些经验（如果您一开始就认为后者是一门计算机语言），而且我的日常任务涉及分析非常大的数据（例如 10GB 大矩阵），并且似乎该程序至少将 2/3 的时间用于内存访问（这就是我将其部分工作发送到 GPU 的原因），你们认为我至少尝试 fortran 例程可能值得吗？我的代码中的一些性能关键部分来提高我的程序的性能？

因为那里涉及的复杂性和事情需要完成，所以如果只有那里有显着的性能优势，我只会执行该例程，在此先感谢。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-10-25T23:55:20.867

与 C++ 相比，Fortran 具有严格的别名语义，并且几十年来一直在积极调整数值性能。使用 CPU 处理数据数组的算法通常有可能从 Fortran 实现中受益。

编程语言大战不应被太认真地对待，但在 15 个基准测试中，Fortran 在*其中四个*（英特尔 Q6600 单核）上的速度排名第一，超过任何其他单一语言。您可以看到 Fortran 最出色的基准是大量数字基准：

*   [频谱标准](http://benchmarksgame.alioth.debian.org/u64q/performance.php?test=spectralnorm)快 27%
*   [fasta](http://benchmarksgame.alioth.debian.org/u64q/performance.php?test=fasta)快 67%
*   [mandelbrot](http://benchmarksgame.alioth.debian.org/u64q/performance.php?test=mandelbrot)快 56%
*   [pidigits](http://benchmarksgame.alioth.debian.org/u64q/performance.php?test=pidigits)快 18%

反例：

*   [k-核苷酸](http://benchmarksgame.alioth.debian.org/u64q/performance.php?test=knucleotide)慢 500%（这个基准主要关注更复杂的数据结构和字符串处理，这不是 Fortran 的强项）

您还可以看到一个摘要页面“[慢多少倍](http://benchmarksgame.alioth.debian.org/u64q/which-programs-are-fastest.html)”，它表明在所有实现中，Fortran 代码平均最接近每个基准测试的最快实现——尽管分位数条比 C++ 大得多，表明 Fortran不适合 C++ 擅长的某些任务，但你应该已经知道了。

所以你需要问自己的问题是：

1.  这个函数的速度是否如此重要，以至于在 Fortran 中重新实现它值得我花时间？

2.  性能如此重要，以至于我在学习 Fortran 上的投资会得到回报吗？

3.  是否可以使用像 ATLAS 这样的库而不是自己编写代码？

回答这些问题需要详细了解您的代码库和业务模型，因此我无法回答这些问题。但是，是的，Fortran 实现通常比 C++ 实现更快。

您决定的另一个因素是示例代码的数量和可用的参考实现的数量。Fortran 的悠久历史意味着有大量的数字代码可供下载，甚至可以访问图书馆。与往常一样，您需要筛选它才能找到好东西。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-10-26T00:51:25.770

您的问题的完整和正确答案是，“是的，Fortran 确实具有一些优势”。

C++ 也有一些不同的优点。Python、R 等也是如此。它们是不同的语言。用一种语言做一些事情，用另一种语言做一些事情会更容易、更快捷。所有这些都在他们的社区中被广泛使用，并且有很好的理由。

在没有更具体的问题的情况下，其他任何事情都只是噪音和语言战争的诱饵，这就是为什么我投票结束这个问题并希望其他人也能这样做。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-26T00:18:24.407

Fortran 自然适合数值编程。在这样的程序中，您往往会有大量的数字，通常是排列好的数组。数组是 Fortran 中的一等公民，将数值内核从 Matlab 转换为 Fortran 通常非常简单。关于潜在的性能优势，请参阅其他答案，它们很好地涵盖了这一点。基线可能是您可以使用当今大多数编译语言创建高效的数值应用程序，但您可能会跳过一些循环才能到达那里。由于语言特性，Fortran 经过精心设计，允许编译器识别大多数优化点。当然，您也可以使用任何编译语言（包括 Fortran）编写任意慢速代码。在任何情况下，您都应该选择合适的工具。Fortran 适合数值应用，C适合系统相关的开发。最后，学习 Fortran 基础并不难，学习其他语言总是值得的。这为您要解决的问题打开了不同的视图。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-10-22T12:39:52.850

另外值得一提的是，Fortran 比 C++ 更容易掌握。事实上，Fortran 的语言规范比普通 C 语言规范更短，而且它的语法可以说更简单。你可以很快拿起它。

这意味着如果您只对学习 C++ 或 Fortran 感兴趣以解决您目前遇到的单个特定问题（例如，加快您用原型语言编写的内容的瓶颈），Fortran 可能会给您带来更好的投资回报.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-10-18T20:10:54.773

Fortran 代码通常更适合矩阵和向量类型的操作。但是您也可以通过将提示/建议传递给编译器以产生类似质量的向量指令，从而使用 c/c++ 代码产生类似的性能。一个给我很大提升的选择是不假设作为数组对象的输入变量之间存在内存别名。通过这种方式，编译器可以积极地为 IL​​P 进行内部循环展开和流水线操作，其中它可以使用正确的预取在循环迭代中重叠加载和存储操作。

# php - 在结果宽度全文搜索mysql中计算行数

> ID：13078737
> 
> 赞同：3
> 
> 时间：2012-10-25T23:18:11.363
> 
> 标签：php, mysql

我想问是否有人可以帮助我解决这个问题

```
SELECT count(MATCH(product_text) AGAINST('lorem*' in boolean mode)) AS score FROM table_products WHERE MATCH (text) AGAINST ('lorem*' in boolean mode) limit 0,50000 
```

列文本上有全文索引。Am 查询将行总和作为分数返回。我不会计算全文搜索结果。如果结果（行）数大于 50000，则返回 count-sum 50000，否则返回结果的确切计数。

问题是，如果用户尝试查找例如单词“lorem”并且该单词出现在表 fe 中超过 500 000 x，那么在 150 万行的表宽度上它并不快。

我也试过

```
SELECT id,name,product_text,price, MATCH(product_text) AGAINST('lorem*' in boolean mode) AS score FROM table_products WHERE MATCH(product_text) AGAINST('lorem*' in boolean mode) and show_product='1' limit 0,50000 
```

...宽度 php mysql_num_rows

另一个问题是，在以下查询中，mysql 仅使用全文索引并按另一列或按分数排序比慢

```
SELECT id,name,product_text,price, MATCH(product_text) AGAINST('lorem*' in boolean mode) AS score FROM table_products WHERE MATCH(product_text) AGAINST('lorem*' in boolean mode) and show_product='1' order by score desc limit 0,50000 
```

分别 （..按名称订购，按价格订购）

还有其他更好更快的方法吗？

非常感谢您的帮助。

# android - Android：如何在屏幕保护程序上制作像手机解锁按钮一样的滑动按钮？

> ID：13078741
> 
> 赞同：9
> 
> 时间：2012-10-25T23:18:35.730
> 
> 标签：android, android-widget

我不知道这种类型的按钮到底是怎么称呼的，这就是为什么我什至不能用谷歌搜索它。您使用该按钮解锁手机 - 点击它并从左向右移动。我想在我的应用程序中添加相同的按钮。怎么做？

![在此处输入图像描述](../Images/ea96f0f68f7f03c44533137db18951cb.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T07:18:31.983

您应该使用 SeekBar 来实现您想要的。[http://developer.android.com/reference/android/widget/SeekBar.html](http://developer.android.com/reference/android/widget/SeekBar.html)

这是一个很好的例子

[http://www.techrepublic.com/blog/app-builder/androids-seekbar-your-way/943](http://www.techrepublic.com/blog/app-builder/androids-seekbar-your-way/943)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-21T18:41:56.663

试试这个库 [https://github.com/sitepoint-editors/SwipeButtonExample](https://github.com/sitepoint-editors/SwipeButtonExample) 和这个 DIY [https://rightclicksolutions.wordpress.com/2014/04/09/android-slide-to-unlock-like-ios -mb-滑块滑块/](https://rightclicksolutions.wordpress.com/2014/04/09/android-slide-to-unlock-like-ios-mb-slider-slider/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T23:31:33.653

您可以覆盖 onTouch() 并根据 x 位置更改按钮的位置。当您抬起手指时，您可以覆盖 onUp() （我不确定那是方法的名称）并创建一个动画，将按钮引导回其位置。从您的问题中，我了解到您可能认为它是一个按钮，您可以简单地从按钮列表中添加，好吧，它不是。你需要手动创建它。

# ruby-on-rails - Rails 3 使用 ajax 更新两个模型

> ID：13078745
> 
> 赞同：0
> 
> 时间：2012-10-25T23:19:01.437
> 
> 标签：ruby-on-rails, ruby-on-rails-3, jquery, twitter-bootstrap

我已经坚持了大约2周。我需要以正确的方式帮助来做到这一点。我有两个模型。模型一是Leads。模式二是推荐人。

潜在客户belongs_to 推荐人

推荐 has_many Leads

在潜在客户输入屏幕中，有一个部分显示潜在客户可供选择的推荐。部分中有一个 Add Referral 链接，它使用 twitter bootstrap 作为 css 框架来显示一个模式。从那里我正在渲染推荐控制器的新动作。

到目前为止，这一切都有效。我想要发生的是然后我可以输入一个新的推荐，它被保存，模式关闭，然后更新线索编辑/新视图部分中的推荐列表以反映新的推荐添加。但在这一点上，我现在已经嵌套了 form_for。以及正在使用不同控制器的推荐表单。

我不确定我应该如何处理这个问题。几个星期以来，我一直在寻找和尝试各种方法。我是否重复自己并在 Leads 控制器和视图下完全重建 Referral 视图和控制器？像这样的重复代码是我切换到 Rails 的原因，也是我觉得我没有正确看待这个问题的原因。必须有一个简单的方法来解决这个问题。我已经研究过使用 Draper 和 Cell 之类的 Gems，并且我已经阅读了有关使用演示者的信息。但这些似乎都是仪表板类型视图的解决方案，而不是我想要完成的。

任何帮助或方向将不胜感激。

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T17:40:10.397

这就是我编写此类问题的方式。
它对我有用，也许你可以适应自己的情况。

好吧，你对你`create`的推荐控制器的操作应该用 javascript 响应。

```
if @referral.save
    format.js 
```

这样，您将`create.js.erb`在views 文件夹中拥有一个文件，您可以在其中保存推荐人的意见。
在`create.js.erb`你可能有类似的东西：

```
$('#modal_id').hide(); // Hide the modal or if you prefer, remove from DOM.
$('#referral_list_id').chidren().delete(); // Remove the list of referrals.
$('#referral_list_id').html(
  "<%= escape_javascript(render('referrals_list')) %>"
); // Render a partial with the new content from your controller. 
```

您的模态`form`中的新`referral`内容也应该是远程的：

```
<%= form_for @referral, :remote => true do %> 
```

也许您在实施这种方式时会遇到一些问题，但我相信这很容易解决。

# wcf - WCF 无法打开 MSMQ 队列：访问被拒绝

> ID：13078747
> 
> 赞同：3
> 
> 时间：2012-10-25T23:19:06.680
> 
> 标签：wcf, msmq

我们有一个 Windows 服务，它使用 WCF 从 MSMQ 队列中读取消息。最近因为打不开队列，服务启动不了：

```
Running WcfHost, service contract IWcfService.  :
System.InvalidOperationException: There was an error opening the queue. Ensure 
 that MSMQ is installed and running, the queue exists and has proper authorization
 to be read from. The inner exception may contain additional information. --->
 System.ServiceModel.MsmqException: An error occurred while opening the queue:
 Access is denied. (-1072824283, 0xc00e0025). The  message cannot be sent or 
 received from the queue. Ensure that MSMQ is installed and running. Also ensure 
 that the queue is available to open with the required access mode and 
 authorization.
   at System.ServiceModel.Channels.MsmqQueue.OpenQueue()
   at System.ServiceModel.Channels.MsmqQueue.GetHandle()
   at System.ServiceModel.Channels.MsmqQueue.SupportsAccessMode(String formatName, Int32 accessType, MsmqException& msmqException)
   --- End of inner exception stack trace ---
   at System.ServiceModel.Channels.MsmqVerifier.VerifyReceiver(MsmqReceiveParameters receiveParameters, Uri listenUri)
   at System.ServiceModel.Channels.MsmqTransportBindingElement.BuildChannelListener[TChannel](BindingContext context)
   at System.ServiceModel.Channels.Binding.BuildChannelListener[TChannel](Uri listenUriBaseAddress, String listenUriRelativeAddress, ListenUriMode listenUriMode, BindingParameterCollection parameters)
   at System.ServiceModel.Description.DispatcherBuilder.MaybeCreateListener(Boolean actuallyCreate, Type[] supportedChannels, Binding binding, BindingParameterCollection parameters, Uri listenUriBaseAddress, String listenUriRelativeAddress, ListenUriMode listenUriMode, ServiceThrottle throttle, IChannelListener& result, Boolean supportContextSession)
   at System.ServiceModel.Description.DispatcherBuilder.BuildChannelListener(StuffPerListenUriInfo stuff, ServiceHostBase serviceHost, Uri listenUri, ListenUriMode listenUriMode, Boolean supportContextSession, IChannelListener& result)
   at System.ServiceModel.Description.DispatcherBuilder.InitializeServiceHost(ServiceDescription description, ServiceHostBase serviceHost)
   at System.ServiceModel.ServiceHostBase.InitializeRuntime()
   at System.ServiceModel.ServiceHostBase.OnOpen(TimeSpan timeout)
   at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)
   at WcfHost`2.Open() 
```

我们已经仔细检查了队列的权限并且它们没有改变。我们已经运行[ProcMon](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)并且没有看到任何拒绝访问事件。我们不知道是什么改变导致了这个错误。

**为什么 WCF 不能打开这个队列？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-05T10:23:24.737

您可以尝试从队列设置中关闭 RPC 请求吗？

# python - 合并 DataFrame 中的重复列

> ID：13078751
> 
> 赞同：33
> 
> 时间：2012-10-25T23:19:21.707
> 
> 标签：python, pandas, dataframe, group-by, pandas-groupby

如果我有一个包含相同名称的列的数据框，有没有办法将具有相同名称的列与某种函数（即总和）结合起来？

例如：

```
In [186]:

df["NY-WEB01"].head()
Out[186]:
                NY-WEB01    NY-WEB01
DateTime        
2012-10-18 16:00:00  5.6     2.8
2012-10-18 17:00:00  18.6    12.0
2012-10-18 18:00:00  18.4    12.0
2012-10-18 19:00:00  18.2    12.0
2012-10-18 20:00:00  19.2    12.0 
```

我如何通过对列名相同的每一行求和来折叠 NY-WEB01 列（有一堆重复的列，而不仅仅是 NY-WEB01）？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-10-26T09:02:36.623

我相信这可以满足您的需求：

```
df.groupby(lambda x:x, axis=1).sum() 
```

或者，根据 df 的长度，快 3% 到 15%：

```
df.groupby(df.columns, axis=1).sum() 
```

编辑：要将其扩展到总和之外，请使用`.agg()`（缩写`.aggregate()`）：

```
df.groupby(df.columns, axis=1).agg(numpy.max) 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2019-01-22T02:28:21.177

## 熊猫 >= 0.20：`df.groupby(level=0, axis=1)`

这里不需要 lambda，也不需要明确地查询`df.columns`；[`groupby`](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html)接受`level`可以与参数一起指定的`axis`参数。这更干净，IMO。

```
# Setup
np.random.seed(0)
df = pd.DataFrame(np.random.choice(50, (5, 5)), columns=list('AABBB'))
df

    A   A   B   B   B
0  44  47   0   3   3
1  39   9  19  21  36
2  23   6  24  24  12
3   1  38  39  23  46
4  24  17  37  25  13 
```

<!_ >

```
df.groupby(level=0, axis=1).sum()

    A    B
0  91    6
1  48   76
2  29   60
3  39  108
4  41   75 
```

* * *

# **处理`MultiIndex`列**

另一种需要考虑的情况是在处理`MultiIndex`列时。考虑

```
df.columns = pd.MultiIndex.from_arrays([['one']*3 + ['two']*2, df.columns])
df
  one         two    
    A   A   B   B   B
0  44  47   0   3   3
1  39   9  19  21  36
2  23   6  24  24  12
3   1  38  39  23  46
4  24  17  37  25  13 
```

要跨上层执行聚合，请使用

```
df.groupby(level=1, axis=1).sum()

    A    B
0  91    6
1  48   76
2  29   60
3  39  108
4  41   75 
```

或者，如果仅按上层聚合，则使用

```
df.groupby(level=[0, 1], axis=1).sum()

  one     two
    A   B   B
0  91   0   6
1  48  19  57
2  29  24  36
3  39  39  69
4  41  37  38 
```

* * *

# 替代解释：**删除重复的列**

如果您来这里是想了解如何简单地删除重复的列（不执行任何聚合），请使用[`Index.duplicated`](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Index.duplicated.html)：

```
df.loc[:,~df.columns.duplicated()]

    A   B
0  44   0
1  39  19
2  23  24
3   1  39
4  24  37 
```

或者，要保留最后一个，请指定`keep='last'`（默认为`'first'`），

```
df.loc[:,~df.columns.duplicated(keep='last')]

    A   B
0  47   3
1   9  36
2   6  12
3  38  46
4  17  13 
```

`groupby`上述两种解决方案的备选方案分别是、 `df.groupby(level=0, axis=1).first()`和`... .last()`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-04-05T10:36:41.923

这是常见聚合函数（如`sum`, `mean`, `median`, `max`, `min`, ）的可能更简单的解决方案`std`- 仅使用参数`axis=1`来处理列和`level`：

```
#coldspeed samples
np.random.seed(0)
df = pd.DataFrame(np.random.choice(50, (5, 5)), columns=list('AABBB'))
print (df)

print (df.sum(axis=1, level=0))
    A    B
0  91    6
1  48   76
2  29   60
3  39  108
4  41   75

df.columns = pd.MultiIndex.from_arrays([['one']*3 + ['two']*2, df.columns])

print (df.sum(axis=1, level=1))
    A    B
0  91    6
1  48   76
2  29   60
3  39  108
4  41   75

print (df.sum(axis=1, level=[0,1]))
  one     two
    A   B   B
0  91   0   6
1  48  19  57
2  29  24  36
3  39  39  69
4  41  37  38 
```

与索引类似，然后`axis=0`改用`axis=1`：

```
np.random.seed(0)
df = pd.DataFrame(np.random.choice(50, (5, 5)), columns=list('ABCDE'), index=list('aabbc'))
print (df)
    A   B   C   D   E
a  44  47   0   3   3
a  39   9  19  21  36
b  23   6  24  24  12
b   1  38  39  23  46
c  24  17  37  25  13

print (df.min(axis=0, level=0))
    A   B   C   D   E
a  39   9   0   3   3
b   1   6  24  23  12
c  24  17  37  25  13

df.index = pd.MultiIndex.from_arrays([['bar']*3 + ['foo']*2, df.index])

print (df.mean(axis=0, level=1))
      A     B     C     D     E
a  41.5  28.0   9.5  12.0  19.5
b  12.0  22.0  31.5  23.5  29.0
c  24.0  17.0  37.0  25.0  13.0

print (df.max(axis=0, level=[0,1]))
        A   B   C   D   E
bar a  44  47  19  21  36
    b  23   6  24  24  12
foo b   1  38  39  23  46
    c  24  17  37  25  13 
```

如果需要使用其他功能，如`first`, `last`, `size`,`count`有必要使用[冷速答案](https://stackoverflow.com/a/54300430/2901002)

# flash - Flash：在 MP3 播放器中跳过 X 帧向后/向前 onkeypress

> ID：13078752
> 
> 赞同：-1
> 
> 时间：2012-10-25T23:19:46.320
> 
> 标签：flash

以下是与我的问题相关的MP3播放器，你应该下载FLA文件并查看源代码（如果你没有看到Flash脚本点击第一层的第三帧）...

[http://www.bezzmedia.com/swfspot/samples/flash8/Mp3_Player_with_XML_Playlist](http://www.bezzmedia.com/swfspot/samples/flash8/Mp3_Player_with_XML_Playlist)

我要做的就是当用户按下右箭头键时使`progressslider`对象向右移动 X 帧/秒数，或者`progressslider`当用户按下左箭头键时使对象向左移动 Y 帧数。

下面我已经弄清楚了如何做最基本的部分，但是我不是很先进，所以歌曲长度和奇怪的是，当前位置似乎也影响了滑块移动了多少帧。我试图让一些东西保持一致。

```
progressslider.onKeyDown = function()
{
 if (Key.isDown(Key.RIGHT))
 {// Seek fowards X frames or X seconds.
  playingsong.start((playingsong.position/playingsong.duration)*182+5);
 }
 else if (Key.isDown(Key.LEFT))
 {// Seek backwards X frames or X seconds.
  playingsong.start((playingsong.position/playingsong.duration)*182-5);
 }
}; 
```

请不要发布猜测答案，如果您还没有查看源代码，请不要费心回答。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-10-25T23:26:20.757

```
myClip_mc.gotoAndPlay(myClip_mc.currentFrame + 50); 
```

# c++ - 在 C++ 中获取 DATETIME 标记的最简单方法

> ID：13078756
> 
> 赞同：2
> 
> 时间：2012-10-25T23:20:06.797
> 
> 标签：c++, sql, datetime

我有一个带有 DATETIME 字段的 SQL 表。我正在使用 C++ 中的表。当我填写该行时，我需要提交一个日期时间。得到这个的最简单的方法是什么？

使用 ubuntu 并且需要它也可以与 Qt 一起使用，所以最好不要添加像 boost:: 这样的外部库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:51:45.223

我曾经遇到过类似的情况，所以我写了自己的`DateTime`课。

在 pastebin 上：

[日期时间.h](http://pastebin.com/erAXnvG8)

[日期时间.cpp](http://pastebin.com/tthi6J5x)

* * *

如果您正在使用[`MySQL Connector/C++`](http://dev.mysql.com/doc/refman/5.5/en/connector-cpp.html)，那么我相信这个库会尝试[`JDBC`](http://docs.oracle.com/javase/6/docs/api/java/sql/package-summary.html)从 Java 中进行模拟。`java.sql`Java 包中的类`sql`在 C++ 的命名空间中定义。

JDBC 有一个[`java.sql.Timestamp`](http://docs.oracle.com/javase/6/docs/api/java/sql/Timestamp.html)类，所以 C++ 库应该有一个`sql::Timestamp`类。

但是，MySQL 5.6 文档显示[MySQL 连接器/C++ 有功能请求，要求](http://dev.mysql.com/doc/refman/5.6/en/connector-cpp-requests.html)他们将`Date`,`Time`和`Timestamp`类型添加`JDBC`到 C++ 库中。所以它们可能还不可用。

目前，[这个问题的答案](https://stackoverflow.com/questions/9045030/c-store-a-modified-mysql-timestamp-as-string)建议您应该使用它`std::string`来获取和设置`Timestamp`字段。

插入：

```
std::string ts_field = "2012/10/26 07:15:00";

pstmt = con->prepareStatement("INSERT INTO date_table(date_field) VALUES (?)");

pstmt->setString(1, ts_field);
pstmt->execute();

delete pstmt; 
```

选择：

```
pstmt = con->prepareStatement("SELECT date_field FROM date_table");
res = pstmt->executeQuery();

while (res->next()) 
{
    std::string ts_field = res->getString("date_field");
    cout << ts_field << endl;
}

delete res;
delete pstmt; 
```

如果你想`Timestamp`在你的程序中操作这些 s。使用这些对象使用我附加的类`std::string`创建对象将是微不足道的。`DateTime``pastebin`

* * *

如果你不是太深入`MySQL Connector/C++`，你可以考虑切换到[`MySQL++`](http://tangentsoft.net/mysql++/)。这个库肯定有一个[`DateTime`](http://tangentsoft.net/mysql++/doc/html/refman/classmysqlpp_1_1DateTime.html)类型。

# c# - 从 .ASPX 页面删除代码后，WCF 服务在启动时调用 Javascript 代码

> ID：13078759
> 
> 赞同：0
> 
> 时间：2012-10-25T23:20:43.217
> 
> 标签：c#, javascript, ajax, wcf

我有一个 C# .NET WCF 项目，它由一个调用服务的 JavaScript 页面组成。启动时（在调试模式下）它会立即调用服务，但我不知道为什么。为了尝试解决问题，我执行了标准操作，例如清理和重建。我还删除了 Windows 目录下的项目 dll。为了进一步强调这一点，我删除了 .aspx 文件中的所有 Javascript，但它似乎仍然保留了它。我知道这一点，因为调用堆栈正在拉动填充了变量的函数调用，即使它们不存在。

什么会导致这种情况？我应该如何清除代码，因为它不再存在？我认为这是一个很好的起点，因为启动时调用的其他问题可能会得到解决。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T11:31:49.010

无论如何，您绝对应该使用 REST 协议。这确保了其他非 ASP.net 网站可以使用您的服务（互操作性）。

您为此使用 WCF 有什么特别的原因吗？将 MVC 4.0 与 REST API 一起使用会更容易。WCF 更适合使用数据合约等进行繁重的工作，但它的互操作性不是很好。

针对您的问题，配置为用作启动项的 VS 项目是什么？

# java - GWT formpanel 不调用 onSubmitComplete

> ID：13078770
> 
> 赞同：4
> 
> 时间：2012-10-25T23:22:15.883
> 
> 标签：java, gwt, servlets

GWT：我可以在浏览器中调用 servlet。当我通过formpanel调用它时，它可以调用onSubmit。但它不会调用 onSubmitComplete。它还会弹出一个新窗口，uri 是我的 servlet。

```
String URL= GWT.getModuleBaseURL()+"getType";
         FormPanel formPanel = new FormPanel();  
         formPanel.setAction(URL); 
         formPanel.setEncoding(FormPanel.ENCODING_URLENCODED);  
         formPanel.setMethod(FormPanel.METHOD_GET); 

     formPanel.addSubmitHandler(new SubmitHandler(){

        @Override
        public void onSubmit(SubmitEvent event) {
            // TODO Auto-generated method stub
            System.out.println(event.getSource());
        }

     });
     formPanel.addSubmitCompleteHandler(new FormPanel.SubmitCompleteHandler() {  
            public void onSubmitComplete(SubmitCompleteEvent event) { 
                System.out.println("in");
                System.out.println(event.getResults());  
            }  
        });  
     formPanel.submit();

GWT.xml
 <servlet class="msp2.server.getType" path="/getType" />  

web.xml
    <servlet >
<servlet-name>getType</servlet-name>
    <servlet-class>msp2.server.getType</servlet-class>
</servlet>

<servlet-mapping>
    <servlet-name>getType</servlet-name>
    <url-pattern>/msp2_app/getType</url-pattern>
</servlet-mapping> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-27T10:23:29.707

我知道这是一个老问题，但我只是遇到了同样的问题，这些答案都不是解决方案。调用后`FormPanel.submit()`，响应将在新选项卡中打开并且`onSubmitComplete()`不会被调用。

解决方案最终是 my`FormPanel`没有添加到我调用的对话框中`submit()`。由于表单完全由`Hidden`字段组成，其值是根据按下的页面上的按钮设置的，因此我`FormPanel`实际上不包含任何具有用户可选值的表单小部件，因此我不需要将其添加到任何地方的窗口。

这就是导致响应在新窗口中打开`onSubmitComplete()`而不被调用的原因。我将它添加到我的面板中，`DialogBox`然后它就可以正常工作了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T10:23:07.990

从[javadoc](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/FormPanel.html#FormPanel%28%29)：

> 后端服务器应该以“text/html”的内容类型进行响应，这意味着返回的文本将被视为 HTML。如果服务器指定了任何其他内容类型，则在 onFormSubmit 事件中发送的结果 HTML 将在浏览器之间不可预测，并且 onSubmitComplete 事件可能根本不会触发。

假设您说响应在另一个窗口中打开，并且您没有为您的 设置特定*目标*`FormPanel`，则可能是您的服务器没有这样做`response.setContentType("text/html")`（或与`;charset=`参数类似）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-21T12:48:54.117

我已经挣扎过了

> 它还会弹出一个新窗口

我找到的所有答案都是关于将表单小部件添加到面板或添加 FormPanel 本身而不是小部件，使操作链接成为绝对链接和其他没有凝胶的东西。经过一个小时的尝试后，真正为我工作的解决方案是**阅读 javadoc**

```
 public FormPanel(String target) {...} 
```

> @param target 接收提交结果的<iframe>的名字，或者`null`指定当前页面被替换

只需将“_self”传递给 FormPanel 构造函数

```
FormPanel form = new FormPanel("_self"); 
```

或者稍后通过 .setTarget(...) 方法设置它。哇 - 它不会打开一个弹出窗口（这肯定会被 Chrome 阻止）还在方法中创建一个表单并提交它，甚至没有附加到 DOM 按预期工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-26T03:52:01.810

如果表单提交成功完成，将调用 onSubmitComplete。确保表单提交没有错误。

发布您正在尝试的代码。它将帮助其他人找出问题所在。

[您也可以尝试使用此处](http://google-web-toolkit.googlecode.com/svn/javadoc/1.6/com/google/gwt/user/client/ui/FormPanel.html)提供的 FormPanel 的示例

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-14T12:39:36.837

问题来自在 GWT 应用程序中使用的 iframe。在文件上传过程中，Javascript 中经常会出现跨域调用，这是不允许的。在开发应用程序期间，您打开开发模式，即在端口 9999 上，因此您的浏览器使用[http://127.0.0.1:9999/YourApp.html](http://127.0.0.1:9999/YourApp.html)。应该处理上传文件的 servlet 在另一台机器上或在同一台机器上但在另一个端口上运行（即[http://127.0.0.1:6544/servlet/upload](http://127.0.0.1:6544/servlet/upload)）。这两种情况都会遇到 Javascript 安全问题，因为域中包含端口号。

但是您可以在您的开发机器上安装一个 Apache 并使用 mod_proxy 将您的应用程序的两个部分移动到一个域中。将 -bindAddress 设置为 localhost 并为您的 GWT 应用程序使用静态端口（即 9999）。还使用静态端口（即 6544）在 localhost 上启动 servlet。然后你可以添加

```
ProxyRequests Off
ProxyPreserveHost Off
ProxyTimeout 3600

<Location /gui>
  Allow from All
  ProxyPass          http://localhost:9999
  ProxyPassReverse   http://localhost:9999
</Location>

<Location /api>
  Allow from All
  ProxyPass          http://localhost:6544/servlet
  ProxyPassReverse   http://localhost:6544/servlet
</Location> 
```

到您的 Apache 配置。现在可以使用“ [http://localhost/gui/YourApp.html](http://localhost/gui/YourApp.html) ”启动 GWT 应用程序，并在 FormPanel.setAction() 中引用“/api/upload”（相对 URL）。现在两个域（GWT app 和upload-servlet）都在同一个域中（[http://localhost](http://localhost)），您将获得SubmitCompleteEvent.getResults()。在 servlet 中，您还必须将 HTTP 响应标头“Content-Type”设置为“text/html”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-04T14:03:47.240

我也有同样的问题，原来是我没有设置 FormPanel 的操作 URL。

```
final FormPanel formPanel = new FormPanel();
formPanel.setAction("/test"); 
```

# iphone - iOS Interface Builder 将视图锁定在其表格单元格的右侧

> ID：13078772
> 
> 赞同：0
> 
> 时间：2012-10-25T23:22:20.960
> 
> 标签：iphone, ios, interface-builder, xcode4.5

如您所见，在下图所示的表单中，所有项目在纵向模式下都向右对齐。但是，在横向模式下，文本框和开关不会随细节项向右移动。细节单元格使用苹果模板，而带有文本框和开关的单元格是自定义单元格。如何在界面生成器中进行设置，以便开关和文本框移到右侧？

我已经搞砸了一段时间没有成功，也没有找到任何有用的信息谷歌搜索。

![应用肖像模式](../Images/96c20822f1b49fa4f9297b1954918493.png) ![应用横向模式](../Images/dc4dcddecfc4829a9a7cc7862acdcddd.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T00:12:40.897

如果您使用的是自定义单元格，则需要设置自动调整大小的掩码以将右边距固定在要右对齐的视图上，如下所示：

![在此处输入图像描述](../Images/7d21488421aec496418d17cb9411c8af.png)

# asp.net - 接收错误 C0000142 (-1073741502)

> ID：13078774
> 
> 赞同：0
> 
> 时间：2012-10-25T23:22:27.247
> 
> 标签：asp.net, compiler-errors

该站点运行良好，然后我在之前使用 VS2010 的 Visual Studio 2012 (VS2012) 中重建了该站点。该站点使用.Net 4.0。我的托管公司还没有 4.5。

升级网站后，我收到以下错误：

```
Server Error in '/' Application.

Compilation Error

Description: An error occurred during the compilation of a resource required to service this request. Please review the following specific error details and modify your source code appropriately. 

Compiler Error Message: The compiler failed with error code -1073741502.

Show Detailed Compiler Output:
Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.272 
```

我进行了谷歌搜索并想出了 IIS 的东西，例如应用程序数据池需要不是本地系统并删除 IIS 上的临时文件夹，但是网络托管公司表示这不是问题，Plesk 可以很好地处理它。到目前为止，它们并不是很有帮助。

具体错误：

> ```
> C:\Windows\SysWOW64\inetsrv> "C:\Windows\Microsoft.NET\Framework\v4.0.30319\csc.exe" /t:library /utf8output /R:"C:\Windows\Microsoft.Net\assembly\GAC_32\System.Web\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Web.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Configuration\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Configuration.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Xml\v4.0_4.0.0.0__b77a5c561934e089\System.Xml.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.IdentityModel\v4.0_4.0.0.0__b77a5c561934e089\System.IdentityModel.dll" /R:"C:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files\root\9bdee0dc\377ffe6c\assembly\dl3\cac0f9df\00e0d4fd_988fcd01\LogicNP.CryptoLicensing.Generator.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.WorkflowServices\v4.0_4.0.0.0__31bf3856ad364e35\System.WorkflowServices.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Activities\v4.0_4.0.0.0__31bf3856ad364e35\System.Activities.dll" /R:"C:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files\root\9bdee0dc\377ffe6c\assembly\dl3\2ec33a5d\28752f05_ffb2cd01\LicService.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.ServiceModel.Activation\v4.0_4.0.0.0__31bf3856ad364e35\System.ServiceModel.Activation.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Web.Services\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Web.Services.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Runtime.Serialization\v4.0_4.0.0.0__b77a5c561934e089\System.Runtime.Serialization.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.ServiceModel\v4.0_4.0.0.0__b77a5c561934e089\System.ServiceModel.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_32\System.EnterpriseServices\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.EnterpriseServices.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_32\System.Data\v4.0_4.0.0.0__b77a5c561934e089\System.Data.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.ComponentModel.DataAnnotations\v4.0_4.0.0.0__31bf3856ad364e35\System.ComponentModel.DataAnnotations.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Web.ApplicationServices\v4.0_4.0.0.0__31bf3856ad364e35\System.Web.ApplicationServices.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System\v4.0_4.0.0.0__b77a5c561934e089\System.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\Microsoft.CSharp\v4.0_4.0.0.0__b03f5f7f11d50a3a\Microsoft.CSharp.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.ServiceModel.Activities\v4.0_4.0.0.0__31bf3856ad364e35\System.ServiceModel.Activities.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.ServiceModel.Web\v4.0_4.0.0.0__31bf3856ad364e35\System.ServiceModel.Web.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Xml.Linq\v4.0_4.0.0.0__b77a5c561934e089\System.Xml.Linq.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Web.Extensions\v4.0_4.0.0.0__31bf3856ad364e35\System.Web.Extensions.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Web.Entity\v4.0_4.0.0.0__b77a5c561934e089\System.Web.Entity.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Data.DataSetExtensions\v4.0_4.0.0.0__b77a5c561934e089\System.Data.DataSetExtensions.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Drawing\v4.0_4.0.0.0__b03f5f7f11d50a3a\System.Drawing.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Core\v4.0_4.0.0.0__b77a5c561934e089\System.Core.dll" /R:"C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Web.DynamicData\v4.0_4.0.0.0__31bf3856ad364e35\System.Web.DynamicData.dll" /R:"C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorlib.dll" /out:"C:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files\root\9bdee0dc\377ffe6c\App_Web_login.aspx.c29b009d.a4o19rhv.dll" /D:DEBUG /debug+ /optimize- /w:4 /nowarn:1659;1699;1701 /warnaserror-  "C:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files\root\9bdee0dc\377ffe6c\App_Web_login.aspx.c29b009d.a4o19rhv.0.cs" "C:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files\root\9bdee0dc\377ffe6c\App_Web_login.aspx.c29b009d.a4o19rhv.1.cs" 
> ```

对我来说，编译器错误输出似乎只是编译器行。'/' 很有趣。一个谷歌搜索结果说应用程序名称是问题，但我检查了。

# bash - 在 awk 中使用记录分隔符

> ID：13078776
> 
> 赞同：2
> 
> 时间：2012-10-25T23:22:34.213
> 
> 标签：bash, shell, scripting, awk

我有

```
$ cat awktestf 
a++
b++
c++ 
```

我在做，我得到

```
cat  awktestf | awk 'BEGIN { RS="++" ; OFS="@"; ORS="()" } { print $0 } END {print "I am done" }'
a()
b()
c()
()I am done()abc@abc:~$ 
```

我的问题是为什么我最后会得到一个额外的 () ？

即使这样也行不通：

```
$ echo 'a++
> b++
> c++' | awk 'BEGIN { RS="++" ; OFS="@"; ORS="()" } { print $0 } END {print "I am done" }'
a()
b()
c()
()I am done()abc@abc:~$ 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T23:40:59.657

`ORS`附加到每个输出记录的末尾。因此，您的“我完成了”以`()`.

* * *

第一次就误解了这个问题。

这

```
a++
b++
c++ 
```

翻译成

```
a++\nb++\nc++\n 
```

使用 拆分为记录后`RS`，您将获得这些记录

1.  一种
2.  \nb
3.  \nc
4.  \n

`ORS`当您打印它们时，每条记录都以,终止`()`，所以

```
a()\nb()\nc()\n() 
```

你添加了“我完成了”

```
a()\nb()\nc()\n()I am done() 
```

因此这显示为

```
a()
b()
c()
()I am done() 
```

（由于最后一行不以换行符结尾，您的提示将显示在同一行）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T23:31:09.070

可能您的文件末尾有一个空行。

由于`OFS`设置为`()`，它会在打印到输出的每一行之后打印。只需从输入文件中删除空白行。

旁注：您不必`cat`将文件然后通过管道传输到 awk。只需使用`awk`：

```
awk ' .... ' file 
```

# php - 如何在php中回显数组中的特定数据？

> ID：13078777
> 
> 赞同：0
> 
> 时间：2012-10-25T23:22:47.283
> 
> 标签：php, arrays, echo

我想从我创建的数组中获取一个特定的值。

这是代码：

```
 try
    {
    // Conecting to MySQL
    $bdd = new PDO('mysql:host=localhost;dbname=horse', 'root', '');
    }
    catch(Exception $e)
    {
    // ERROR MESSAGE
    die('Erreur : '.$e->getMessage());
    }

    // Fetching the data from the table
    $reponse = $bdd->query('SELECT * FROM videos');

    $vidarray = array();

    while ($donnees = $reponse->fetch())
    {
    $videolink = $donnees['link'];

    $vidarray = array($videolink);

    print_r($vidarray);
    }
    echo $vidarray[1]);

    $reponse->closeCursor(); // Closing the request 
```

我想像这样回显这些特定数据之一

```
echo $array[1]; 
```

我希望这个输出“WubVcOaW-qs”。

我对 php 比较陌生，我确信这是非常基本的，但在任何地方都找不到。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:24:25.940

```
$array = array(
'S01tE08GSNg',
'WubVcOaW-qs',
'2n0ag4qmG5g',
'ni1UR-lXiZo',
'ynvz8P_aFwk'
);

echo $array[1]; 
```

# android - 如何使用drawable插入图标？

> ID：13078781
> 
> 赞同：0
> 
> 时间：2012-10-25T23:23:41.437
> 
> 标签：android

我有这些可绘制的项目：

```
<array name="bookmark_icons">
    <item>@drawable/google</item>
    <item>@drawable/android</item>
    <item>@drawable/offspot</item>
</array> 
```

我想将这些图标插入我的应用程序。我怎样才能做到这一点？

这些项目必须出现在我的 ListView

```
 ListView lv = (ListView) findViewById(R.id.favoritos_listView);
    ArrayAdapter<CharSequence> aa = ArrayAdapter.createFromResource(this, R.array.bookmark_titles, android.R.layout.simple_list_item_1);
    lv.setAdapter(aa); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T02:21:20.440

我建议使用列表视图创建自定义列表视图。希望以下链接对您有所帮助。

[http://theopentutorials.com/tutorials/android/listview/android-custom-listview-with-image-and-text-using-arrayadapter/](http://theopentutorials.com/tutorials/android/listview/android-custom-listview-with-image-and-text-using-arrayadapter/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T23:34:01.157

android.R.layout.simple_list_item_1 没有图标以及 android.R.layout.simple_list_item_2

您必须使用 ImageView 创建自己的 list_item 布局，并在新布局中创建自定义适配器插入图像。

# jquery - 使用鼠标“点击”而不是“鼠标悬停”事件，jquery

> ID：13078782
> 
> 赞同：0
> 
> 时间：2012-10-25T23:23:47.877
> 
> 标签：jquery, mousehover, onmouseclick

我在[这里](http://webarchive.gr/test111.html)有这个脚本可以正常工作，但我需要让它在鼠标单击而不是鼠标悬停时工作。

我试过了，但失败了。它看起来很简单，但我无法弄清楚。任何人都可以帮忙吗？

代码是：

```
$(".cat").hover(function(){
    $(this).parent().parent().find(".sub_menu").hide();
},
function() {
    $(this).parent().parent().find(".sub_menu").show();
});` 
```

下面的代码适用于ie，而不是firefox。

```
$(".cat").on('click', function(){
    $(this).parent().parent().find(".sub_menu").toggle();
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:24:40.640

```
$(".cat").on('click', function(){
    $(this).parent().parent().find(".sub_menu").toggle();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T23:24:53.633

尝试这个

```
$(".cat").on('click', function(e){
    e.preventDefault();
    $(this).parent().parent().find(".sub_menu").toggle();
}); 
```

`.closest()`如果 HTML 结构已知，您可以使用 .parent() 替换..

或者

```
$(".cat").on('click', function(e){
        e.preventDefault();
        $(this).closest('.menu').find(".sub_menu").toggle();
 }); 
```

**[工作演示](http://jsfiddle.net/sushanth009/sJbbZ/)**

# c++ - 如何在不丢失任何数据的情况下为左、右和临时释放内存？

> ID：13078783
> 
> 赞同：1
> 
> 时间：2012-10-25T23:24:06.173
> 
> 标签：c++, memory-leaks, b-tree

```
void split_into_children ( btnode& rootNode, btnode& root ) {
    long* key = & ( root->key[0] );
    int middle = root->capacity / 2;
    int i;
    btnode left = new node ( order );
    btnode right = new node ( order );
    btnode temp = new node ( order );
    for ( int i = 0; i < middle; i++ ) {
        left->key[i] = root->key[i];
        left->value[i] = root->value[i];
        left->capacity += 1;
        left->nodes[i] = root->nodes[i];
    }
    left->nodes[middle] = root->nodes[middle];
    for ( i = 0; i < root->capacity - middle; i++ ) {
        right->key[i] = root->key[middle + 1 + i];
        right->value[i] = root->value[middle + 1 + i];
        right->capacity += 1;
        right->nodes[i] = root->nodes[middle + 1 + i];
    }
    right->nodes[right->capacity] = root->nodes[root->capacity + 1];
    temp->key[0] = root->key[middle];
    temp->value[0] = root->value[middle];
    temp->nodes[0] = left;
    temp->nodes[1] = right;
    temp->capacity = 1;
    for ( int i = 0; i <= left->capacity; i++ ) {
        if ( left->nodes[i] != NULL )
            left->nodes[i]->parent = left;
    }
    for ( int i = 0; i <= right->capacity; i++ ) {
        if ( right->nodes[i] != NULL )
            right->nodes[i]->parent = right;
    }
    if ( root->parent == root ) {
        right->parent = temp;
        left->parent = temp;
        temp->parent = temp;
        rootNode->parent = temp;
        rootNode = temp;
    } else {
        add_middle_to_parent ( rootNode, root->parent, left, right, root->key[middle], root->value[middle] );
    }
} 
```

我使用 left 和 right 来拆分 b+ 树节点和 temp 来存储指向左右的中间节点。在从函数返回之前，如何释放左、右和临时的内存？

节点类：

```
class node
{

public:

    long* key;
    int capacity;
    node** nodes;
    node* parent;
    long* value;

    node ( int order ) {
        key = new long[order + 1];
        value = new long[order + 1];
        nodes = new node *[order + 2];
        capacity = 0;
        parent = NULL;
        for ( int i = 0; i <= order + 1; i++ ) {
            this->nodes[i] = NULL;
        }
    }
    ~node() {
        delete[] key;
        delete[] value;
        delete[] nodes;
    }

}; 
```

# iphone - 强制导航栏高度为 44

> ID：13078784
> 
> 赞同：0
> 
> 时间：2012-10-25T23:24:07.590
> 
> 标签：iphone, objective-c, ios, ipad

我的 UINavigationBar 类别中有以下代码：

```
- (CGSize)sizeThatFits:(CGSize)size
{
    CGSize newSize = [super sizeThatFits:size];
    newSize.height = 44;
    return newSize;
} 
```

出于某种原因，当我的视图是横向时，iPad 上的尺寸（在 newSize 变量上）是 512px 而不是 1024。知道为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T04:51:58.333

做这个：

```
- (void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)orientation duration:(NSTimeInterval)duration {
  //[super willAnimateRotationToInterfaceOrientation:orientation duration:duration];
  CGRect frame = self.navigationController.navigationBar.frame;
  frame.size.height = 44;
  self.navigationController.navigationBar.frame = frame;
} 
```

# html - 我如何实际将特定内容（博客文章除外）添加到 Wordpress 博客？

> ID：13078785
> 
> 赞同：0
> 
> 时间：2012-10-25T23:24:19.107
> 
> 标签：html, wordpress, content-management-system

这是真正让我困惑的部分。我有我的网站定制，主题等，但我不确定我是如何实际输入内容的，比如联系我页面。当我选择添加页面时，它似乎在要求一个博客文章样式页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:47:24.083

许多主题都安装了自定义帖子类型，例如安装了联系页面，但您是对的，创建新页面看起来像博客帖子，没关系。尝试创建一个，您会看到它的外观，它可能正是您想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T23:30:15.837

WordPress 中的“页面”在各方面都类似于博客文章，只是它们不会显示在主循环中。

WordPress 可以将其帖子分类为“帖子类型”。您在主循环中看到的帖子默认是“帖子”类型的帖子，“页面”是“页面”类型的帖子。使用一些编码或插件，您还可以添加其他类型，例如“收据”、“事件”、“艺术家”或任何您想要的，但稍后您应该告诉 WordPress 如何或在哪里显示它们，无论是主循环还是其他地方。

因此，“页面”实际上是默认情况下不会显示在主页中的帖子，仅此而已。

# javascript - 变量包含在 JSON 调用中

> ID：13078789
> 
> 赞同：-1
> 
> 时间：2012-10-25T23:24:34.350
> 
> 标签：javascript, jquery, html, json

> **可能重复：**
> [动态对象属性名称](https://stackoverflow.com/questions/4244896/dynamic-object-property-name)

考虑到这个json：

```
{
    "items" : [
        { "item_blue" : "10" },
        { "item_green" : "100" },
        { "item_red" : "1000" }
    ]
} 
```

这可能吗？

```
var item = "item_green";
echo(items.item)    //100 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:26:10.370

不，使用

```
items[item] 
```

否则`items.item`将尝试获取名为 item 的属性

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T23:26:33.120

JS 中没有回显，但您可以使用括号表示法：

```
var item = "item_green";
console.log(items[item]); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T23:37:34.083

那是一个无效的 JSON.. 需要用逗号分隔数组内的对象

```
var data = {
              "items" : [
                 { "item_blue" : "10" },
                 { "item_green" : "100" },
                 { "item_red" : "1000" }
             ]
          }; 
```

使用**console.log**代替**echo**

```
var item = "item_green";
console.log(data.items[1][item]); 
```

**如果您的 JSON 采用这种格式，**item.item将起作用..****

 **```
var data = {
    "items": {
        "item_blue": "10",
        "item_green": "100",
        "item_red": "1000"
    }
}; 
```

[检查小提琴](http://jsfiddle.net/sushanth009/z7FME/)**

# php - Facebook PHP sdk 返回未知方法

> ID：13078795
> 
> 赞同：-1
> 
> 时间：2012-10-25T23:24:57.823
> 
> 标签：php, facebook, api, facebook-php-sdk

我已经多次访问 fb->api 方法......但最近下载了最新的 SDK，现在我得到了一些奇怪的行为。这是代码：

```
 try {
    include("facebooksdk/src/facebook.php");
}
catch (Exception $e) {
    echo "$e" . "<br/>";
    die($e);
}
$appId = 'xxxxxxxxxxx';
$appsecret= 'xxxxxxxxxxxxxxxxxxxxxxxxxxxx';
$fb = new Facebook(array(
    'appId' => $appId,
    'secret' => $appsecret,
    'oauth' => 'true'
));
$accesstoken = $fb->getAccessToken();
$me = $fb->getUser();
if(!$me) {
    header("Location:{$fb->getLoginUrl(array('req_perms' => 'email,offline_access'))}");
}

**try {
    $result = $fb->api(array('/me', 'GET'));**

    print_r($result);
}
catch(FacebookApiException $e){
    echo $e->getMessage();
} 
```

我的问题是当我尝试 $result 时......我得到“未知方法”返回（偶尔还有一些指向 base_facebook.php 的方向）。关于这个有什么想法吗？在网上的任何地方都找不到好的数据。我们是否无法通过 relative_url 访问（我也尝试过 relative_url=> 方法......不走运！）。最终我想从中获得 DAU。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:27:28.520

试试：

```
$fb->api('/me'); 
```

`GET`是默认方法。当你传递一个数组时，你是在告诉 Facebook SDK 你正在使用一个 REST 方法，这显然不存在，所以这就是你得到“未知方法”的原因。

# sql-server-2008 - 使用 JTA TransactionManager 的 Spring3+Hibernate4 中的“No Session found for current thread”

> ID：13078798
> 
> 赞同：1
> 
> 时间：2012-10-25T23:25:18.157
> 
> 标签：sql-server-2008, spring-mvc, jboss7.x, spring-3, hibernate-4.x

我正在尝试从

春季 1.2.9 与休眠 3.2.0.ga

至

spring 3.1.1.RELEASE with hibernate 4.0.1.Final

大多数**bean 的连接都是用 xml**而不是注解完成的。在部署之前，我已经对 dao、service 和 controller 对象进行了必要的更改以及单元测试，以确保现有 spring 配置的兼容性。

当我部署到 JBoss AS 7.1.1.Final 时，我得到“No Session found for current thread”。我一直在通过这个论坛和 spring 和 hibernate 文档寻找答案，但我仍然无法找到适用于我的问题的解决方案。

这是休眠异常日志

```
> 06:18:25,703 ERROR [com.test.customer.dao.InvoicingInfoDAOImpl] (http--12
7.0.0.1-8080-1) selectBillingInfoIdById:Runtime error.: org.hibernate.HibernateE
xception: **No Session found for current thread**
        at org.springframework.orm.hibernate4.SpringSessionContext.currentSessio
n(SpringSessionContext.java:97) [spring-orm-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at org.hibernate.internal.SessionFactoryImpl.getCurrentSession(SessionFa
ctoryImpl.java:883) [hibernate-core-4.0.1.Final.jar:4.0.1.Final]
        at com.test.customer.dao.InvoicingInfoDAOImpl.selectBillingInfoBy
Id(InvoicingInfoDAOImpl.java:58) [classes:]
        at com.test.customer.services.CustomerServiceImpl.getBillingInfo(
CustomerServiceImpl.java:535) [classes:]
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1
.6.0_25]
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.
java:39) [rt.jar:1.6.0_25]
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
sorImpl.java:25) [rt.jar:1.6.0_25]
        at java.lang.reflect.Method.invoke(Method.java:597) [rt.jar:1.6.0_25]
        at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflecti
on(AopUtils.java:318) [spring-aop-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJo
inpoint(ReflectiveMethodInvocation.java:183) [spring-aop-3.1.1.RELEASE.jar:3.1.1
.RELEASE]
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(
ReflectiveMethodInvocation.java:150) [spring-aop-3.1.1.RELEASE.jar:3.1.1.RELEASE
]
        at org.springframework.transaction.interceptor.TransactionInterceptor.in
voke(TransactionInterceptor.java:110) [spring-tx-3.1.1.RELEASE.jar:3.1.1.RELEASE
]
        at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(
ReflectiveMethodInvocation.java:172) [spring-aop-3.1.1.RELEASE.jar:3.1.1.RELEASE
]
        at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynami
cAopProxy.java:202) [spring-aop-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at $Proxy22.getBillingInfo(Unknown Source)      at com.test.custo
mer.CustomerController.getBillingInfo(CustomerController.java:205) [classes:]
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1
.6.0_25]
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.
java:39) [rt.jar:1.6.0_25]
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
sorImpl.java:25) [rt.jar:1.6.0_25]
        at java.lang.reflect.Method.invoke(Method.java:597) [rt.jar:1.6.0_25]
        at org.springframework.web.method.support.InvocableHandlerMethod.invoke(
InvocableHandlerMethod.java:213) [spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at org.springframework.web.method.support.InvocableHandlerMethod.invokeF
orRequest(InvocableHandlerMethod.java:126) [spring-web-3.1.1.RELEASE.jar:3.1.1.R
ELEASE]
        at org.springframework.web.servlet.mvc.method.annotation.ServletInvocabl
eHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:96) [spring-we
bmvc-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingH
andlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:617) [spring
-webmvc-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at org.springframework.web.servlet.mvc.method.annotation.RequestMappingH
andlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:578) [spring-webm
vc-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapt
er.handle(AbstractHandlerMethodAdapter.java:80) [spring-webmvc-3.1.1.RELEASE.jar
:3.1.1.RELEASE]
        at org.springframework.web.servlet.DispatcherServlet.doDispatch(Dispatch
erServlet.java:923) [spring-webmvc-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at org.springframework.web.servlet.DispatcherServlet.doService(Dispatche
rServlet.java:852) [spring-webmvc-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at org.springframework.web.servlet.FrameworkServlet.processRequest(Frame
workServlet.java:882) [spring-webmvc-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServ
let.java:789) [spring-webmvc-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:754) [jboss-s
ervlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:847) [jboss-s
ervlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Appl
icationFilterChain.java:329) [jbossweb-7.0.13.Final.jar:]
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationF
ilterChain.java:248) [jbossweb-7.0.13.Final.jar:]
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperV
alve.java:275) [jbossweb-7.0.13.Final.jar:]
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextV
alve.java:161) [jbossweb-7.0.13.Final.jar:]
        at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(Secu
rityContextAssociationValve.java:153) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final] 
```

这是会话工厂和事务管理器的spring配置（这里使用jta）

```
> <!-- Configuration of Hibernate SessionFactory -->
    <bean id="sessionFactory"
        class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
        <property name="dataSource">
            <ref bean="csvliteDataSource" />
        </property>
        <property name="hibernateProperties">
            <ref bean="csvliteHibernateProperties" />
        </property>
        <property name="mappingResources">
            <list>
                <!-- Customer Domain Mapping -->
                <value>com/test/customer/domain/InvoicingInfo.hbm.xml</value>
                <value>com/test/customer/domain/PickupAddress.hbm.xml</value>
            </list>
        </property>
    </bean>

    <!-- Configurationof Hibernate Configuration Properties -->
    <bean id="csvliteHibernateProperties" class="java.util.Properties">
        <constructor-arg>
            <props>
                <!-- Hibernate Configuration Properties -->
                <prop key="hibernate.dialect">org.hibernate.dialect.SQLServer2008Dialect</prop>             
                <prop key="hibernate.current_session_context_class">org.springframework.orm.hibernate4.SpringSessionContext</prop>
                <!-- Hibernate Configuration Properties - enabled only if debugging -->
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.format_sql">true</prop>
                <prop key="hibernate.generate_statistics">true</prop>
                <prop key="hibernate.use_sql_comments">true</prop>
                <!-- Hibernate Cache Properties -->
                <prop key="hibernate.cache.provider_class">org.hibernate.cache.OSCacheProvider</prop>
                <prop key="hibernate.cache.use_query_cache">true</prop>         
            </props>
        </constructor-arg>
    </bean>

    <!-- Configuration of Data Source -->
    <bean id="csvliteDataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
        <property name="jndiName">
            <value>java:jboss/datasources/CSLiteDS</value>
        </property>
    </bean>

    <!-- Configuration of Transaction Manager -->
    <bean id="csvliteTxManager"
        class="org.springframework.transaction.jta.JtaTransactionManager">
        <property name="transactionManagerName">
            <value>java:jboss/TransactionManager</value>
        </property>
    </bean> 
```

这是相关 dao 和服务对象的 spring 配置（它为每个服务对象使用 TransactionProxyFactoryBean）

```
<bean id="invoicingInfoDAO"
    class="com.test.customer.dao.InvoicingInfoDAOImpl">
    <property name="sessionFactory" ref="sessionFactory"/>
</bean>

<bean id="pickupAddressDAO"
    class="com.test.customer.dao.PickupAddressDAOImpl">
    <property name="sessionFactory" ref="sessionFactory"/>
</bean>

<bean id="customerService"
    class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
    <property name="transactionManager" ref="csvliteTxManager"/>
    <property name="target" ref="customerServiceImpl"/>
    <property name="transactionAttributes"> 
        <props>     
            <prop key="getBillingInfo">PROPAGATION_REQUIRES_NEW, -Throwable</prop>                                              
            <prop key="addBillingInfo">PROPAGATION_REQUIRED, -Throwable</prop>
            <prop key="updateBillingInfo">PROPAGATION_REQUIRED, -Throwable</prop>
            <prop key="addPickupAddress">PROPAGATION_REQUIRED, -Throwable</prop>
            <prop key="updatePickupAddress">PROPAGATION_REQUIRED, -Throwable</prop>
            <prop key="getPickupAddress">PROPAGATION_REQUIRES_NEW, -Throwable</prop>
            <prop key="unlockPickupAddress">PROPAGATION_REQUIRED, -Throwable</prop>
            <prop key="lockPickupAddress">PROPAGATION_REQUIRED, -Throwable</prop>
            <prop key="lockBillingInfo">PROPAGATION_REQUIRED, -Throwable</prop>
            <prop key="unlockBillingInfo">PROPAGATION_REQUIRED, -Throwable</prop>
            <prop key="closePickupAddress">PROPAGATION_REQUIRED, -Throwable</prop>
            <prop key="processPurgePickupAddress">PROPAGATION_REQUIRED, -Throwable</prop>
            <prop key="getMultiplePickupAddress">PROPAGATION_REQUIRES_NEW, -Throwable</prop>           
        </props>
    </property>     
</bean> 
<bean id="customerServiceImpl" class="com.test.customer.services.CustomerServiceImpl">
    <property name="invoicingInfoDAO" ref="invoicingInfoDAO"/>  
    <property name="pickupAddressDAO" ref="pickupAddressDAO"/>
</bean> 
```

我在配置中真正错过了什么？

==========================

[更新 - 20121101]

我接受了@adrian-shum 的建议，并与我在网上找到的一些信息进行了交叉参考。

我做了以下测试，但所有测试都不起作用，除非我切换到 HibernateTransaction 而不是 JTA 事务。

# 测试 1 - 成功

（使用 HibernateTransactionManager）

```
<!-- Configurationof Hibernate Configuration Properties -->
    <bean id="csvliteHibernateProperties" class="java.util.Properties">
        <constructor-arg>
            <props>
                <!-- Hibernate Configuration Properties -->
                <prop key="hibernate.dialect">org.hibernate.dialect.SQLServer2008Dialect</prop>             
                <prop key="hibernate.current_session_context_class">org.springframework.orm.hibernate4.SpringSessionContext</prop>

        <!-- Hibernate Configuration Properties - enabled only if debugging -->
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.format_sql">true</prop>
                <prop key="hibernate.generate_statistics">true</prop>
                <prop key="hibernate.use_sql_comments">true</prop>
                <!-- Hibernate Cache Properties -->
                <prop key="hibernate.cache.provider_class">org.hibernate.cache.OSCacheProvider</prop>
                <prop key="hibernate.cache.use_query_cache">true</prop>         
            </props>
        </constructor-arg>
    </bean>

    <!-- Configuration of Data Source -->
    <bean id="csvliteDataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
        <property name="jndiName">
            <value>java:jboss/datasources/CSLiteDS</value>
        </property>
    </bean>

    <!-- Configuration of Transaction Manager -->
    <bean id="csvliteTxManager"
        class="org.springframework.orm.hibernate4.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory" />
    </bean> 
```

# 测试 2 - 失败

（使用 JtaTransactionManager - hibernate.transaction.manager_lookup_class + hibernate.transaction.factory_class）

```
<!-- Configurationof Hibernate Configuration Properties -->
    <bean id="csvliteHibernateProperties" class="java.util.Properties">
        <constructor-arg>
            <props>
                <!-- Hibernate Configuration Properties -->
                <prop key="hibernate.dialect">org.hibernate.dialect.SQLServer2008Dialect</prop>             
                <prop key="hibernate.current_session_context_class">org.springframework.orm.hibernate4.SpringSessionContext</prop>
                <prop key="hibernate.transaction.factory_class">org.hibernate.transaction.JtaTransactionFactory</prop>
                <prop key="hibernate.transaction.manager_lookup_class">org.hibernate.transaction.JBossTransactionManagerLookup</prop>

                <!-- Hibernate Configuration Properties - enabled only if debugging -->
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.format_sql">true</prop>
                <prop key="hibernate.generate_statistics">true</prop>
                <prop key="hibernate.use_sql_comments">true</prop>
                <!-- Hibernate Cache Properties -->
                <prop key="hibernate.cache.provider_class">org.hibernate.cache.OSCacheProvider</prop>
                <prop key="hibernate.cache.use_query_cache">true</prop>         
            </props>
        </constructor-arg>
    </bean>

    <!-- Configuration of Data Source -->
    <bean id="csvliteDataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
        <property name="jndiName">
            <value>java:jboss/datasources/CSLiteDS</value>
        </property>
    </bean>

    <!-- Configuration of Transaction Manager -->   
    <bean id="csvliteTxManager"
        class="org.springframework.transaction.jta.JtaTransactionManager">
        <property name="transactionManagerName">
            <value>java:jboss/TransactionManager</value>
        </property>
    </bean> 
```

# 测试 3 - 失败

（使用 JtaTransactionManager - hibernate.transaction.jta.platform 属性）

```
<!-- Configurationof Hibernate Configuration Properties -->
    <bean id="csvliteHibernateProperties" class="java.util.Properties">
        <constructor-arg>
            <props>
                <!-- Hibernate Configuration Properties -->
                <prop key="hibernate.dialect">org.hibernate.dialect.SQLServer2008Dialect</prop>             
                <prop key="hibernate.current_session_context_class">org.springframework.orm.hibernate4.SpringSessionContext</prop>
                <!-- prop key="hibernate.transaction.jta.platform">org.hibernate.service.jta.platform.internal.JBossAppServerJtaPlatform</prop-->
                <prop key="hibernate.transaction.jta.platform">org.hibernate.service.jta.platform.internal.JBossStandAloneJtaPlatform</prop>

                <!-- Hibernate Configuration Properties - enabled only if debugging -->
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.format_sql">true</prop>
                <prop key="hibernate.generate_statistics">true</prop>
                <prop key="hibernate.use_sql_comments">true</prop>
                <!-- Hibernate Cache Properties -->
                <prop key="hibernate.cache.provider_class">org.hibernate.cache.OSCacheProvider</prop>
                <prop key="hibernate.cache.use_query_cache">true</prop>         
            </props>
        </constructor-arg>
    </bean>

    <!-- Configuration of Data Source -->
    <bean id="csvliteDataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
        <property name="jndiName">
            <value>java:jboss/datasources/CSLiteDS</value>
        </property>
    </bean>

    <!-- Configuration of Transaction Manager -->
    <bean id="csvliteTxManager"
        class="org.springframework.transaction.jta.JtaTransactionManager">
        <property name="transactionManagerName">
            <value>java:jboss/TransactionManager</value>
        </property>
    </bean> 
```

使用 Hibernate Transaction 对我来说不是一个选项。为了使 JTA 事务正常工作，我需要在 JBoss AS 7 方面做些什么吗？

==========================

[更新 - 20121101]

基本上，除了我之前发布的异常之外，我没有从日志中找到任何其他异常。

但是，有趣的是，我没有看到任何日志条目显示事务管理器与我指定的 JNDI 的绑定，并且它总是说它将使用“HHH000399：使用默认事务策略（直接 JDBC 事务）”

```
15:46:00,548 INFO  [org.springframework.transaction.jta.JtaTransactionManager] (
MSC service thread 1-5) Using JTA UserTransaction: org.jboss.tm.usertx.client.Se
rverVMClientUserTransaction@307c44
15:46:00,548 INFO  [org.springframework.transaction.jta.JtaTransactionManager] (
MSC service thread 1-5) Using JTA TransactionManager: com.arjuna.ats.jbossatx.jt
a.TransactionManagerDelegate@a2f435
15:46:00,548 INFO  [org.springframework.transaction.jta.JtaTransactionManager] (
MSC service thread 1-5) Using JTA TransactionSynchronizationRegistry: com.arjuna
.ats.internal.jta.transaction.arjunacore.TransactionSynchronizationRegistryImple
@4ef523
15:46:01,736 INFO  [org.hibernate.annotations.common.Version] (MSC service threa
d 1-5) HCANN000001: Hibernate Commons Annotations {4.0.1.Final}
15:46:01,767 INFO  [org.hibernate.Version] (MSC service thread 1-5) HHH000412: H
ibernate Core {4.0.1.Final}
15:46:01,783 INFO  [org.hibernate.cfg.Environment] (MSC service thread 1-5) HHH0
00206: hibernate.properties not found
15:46:01,783 INFO  [org.hibernate.cfg.Environment] (MSC service thread 1-5) HHH0
00021: Bytecode provider name : javassist
15:46:06,142 INFO  [org.hibernate.dialect.Dialect] (MSC service thread 1-5) HHH0
00400: Using dialect: org.hibernate.dialect.SQLServer2008Dialect
15:46:06,189 INFO  [org.hibernate.engine.transaction.internal.TransactionFactory
Initiator] (MSC service thread 1-5) HHH000399: Using default transaction strateg
y (direct JDBC transactions)
15:46:06,205 INFO  [org.hibernate.hql.internal.ast.ASTQueryTranslatorFactory] (M
SC service thread 1-5) HHH000397: Using ASTQueryTranslatorFactory
15:46:06,361 INFO  [org.hibernate.validator.util.Version] (MSC service thread 1-
5) Hibernate Validator 4.2.0.Final 
```

不确定这是否是原因...如果是，那我需要做什么？

==========================

[更新 - 20130425]

我怀疑这可能与未配置 XA 数据源有关。我会测试并确认。

如果有人能启发我可能是什么原因，我仍然很感激。

[更新 - 20130426]

我已经按如下方式配置了 XA 数据源，但我仍然遇到同样的错误。我尝试过的另一件事是升级以使用休眠 4.2，但我仍然遇到同样的错误。

有没有人尝试使用 JBoss7.1.1.final+Spring3.1.1.RELEASE+Hibernate4.0.1.Final+MS SQL server 2008 配置全局 JTA 事务支持？

```
<subsystem xmlns="urn:jboss:domain:datasources:1.0">
  <datasources>
    <xa-datasource jta="true" jndi-name="java:jboss/datasources/CSLiteDS" pool-name="CSLiteDS" enabled="true" use-java-context="true">
      <xa-datasource-property name="ServerName">{someServerName}</xa-datasource-property>
      <xa-datasource-property name="PortNumber">{somePortNo}</xa-datasource-property>
      <xa-datasource-property name="DatabaseName">{someDatabaseName}</xa-datasource-property>
      <xa-datasource-property name="SelectMethod">cursor</xa-datasource-property>
      <driver>sqljdbc</driver>
      <security>
        <user-name>{someUserName}</user-name>
        <password>{somePassword}</password>
      </security>
    </xa-datasource>
    <xa-datasource jta="true" jndi-name="java:jboss/datasources/CRDDataSource" pool-name="CRDDataSource" enabled="true" use-java-context="true">
      <xa-datasource-property name="ServerName">{someServerName}</xa-datasource-property>
      <xa-datasource-property name="PortNumber">{somePortNo}</xa-datasource-property>
      <xa-datasource-property name="DatabaseName">{someDatabaseName}</xa-datasource-property>
      <xa-datasource-property name="SelectMethod">cursor</xa-datasource-property>
      <driver>sqljdbc</driver>
      <security>
        <user-name>{someUserName}</user-name>
        <password>{somePassword}</password>
      </security>
    </xa-datasource>
    <drivers>
      <driver name="sqljdbc" module="com.microsoft.sqlserver.jdbc">
        <driver-class>com.microsoft.sqlserver.jdbc.SQLServerDriver</driver-class>
        <xa-datasource-class>com.microsoft.sqlserver.jdbc.SQLServerXADataSource</xa-datasource-class>
      </driver>
    </drivers>
  </datasources>
</subsystem> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T16:18:28.953

我通过在休眠会话工厂中设置属性 jtaTransactionManager 解决了这个问题

```
<bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
        <property name="packagesToScan" value="com.foo" />
        <property name="dataSource" ref="myDataSource" />
        <property name="jtaTransactionManager" ref="transactionManager" />
...
</bean> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:11:38.617

只是简单的扫描一下，我认为您必须在 Hibernate 的属性中定义 hibernate.transaction.manager_lookup_class + hibernate.transaction.factory_class 或 hibernate.transaction.jta.platform 属性。

# jquery - 视差侧边栏滚动

> ID：13078800
> 
> 赞同：0
> 
> 时间：2012-10-25T23:25:27.283
> 
> 标签：jquery, scroll, parallax

我只想创建一个像[http://readwrite.com/](http://readwrite.com/)这样的视差侧边栏。

有什么插件吗？还是仅此站点的自定义视差？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:47:22.023

After a few hours of experimenting and coding, I've finally come up with a very exposed solution that doesn't rely on fixed positions (or extensive jQuery plugins), but rather relies solely on **absolute positioning** using known offsets.

See it in action at: [http://jsfiddle.net/LntUP/](http://jsfiddle.net/LntUP/)

The code that makes it happen:

```
$(document).ready(function() {

    var origTop = $('#sidebar').offset().top;
    var origBottom = origTop + $('#sidebar').height();

    var scrollDir = 0;
    var scrollLast = 0;

    var weirdOffset = -8;

    $(window).scroll(function() {

        var scrollTop = $(window).scrollTop();
        var scrollBottom = $(window).scrollTop() + $(window).height();
        var curTop = $('#sidebar').offset().top;
        var curBottom = curTop + $('#sidebar').height();

        if(scrollTop > scrollLast) {
            scrollDir = 1;
        } else if(scrollTop < scrollLast) {
            scrollDir = 0;
        }
        scrollLast = scrollTop;

        if(scrollDir == 1) {
            if(scrollBottom >= origBottom && scrollBottom >= curBottom) {
                $('#sidebar').animate({
                    top: scrollBottom -  $('#sidebar').outerHeight() + weirdOffset
                }, 0);
            }
        }

        if(scrollDir == 0) {
            if(scrollTop <= origTop) {

                $('#sidebar').css('top', (origTop + weirdOffset) + 'px');

            } else if(scrollTop <= curTop) {

                $('#sidebar').animate({
                    top: scrollTop + weirdOffset
                }, 0);

            }
        }
    });
}); 
```

The only thing I noticed is that for some reason I have an offset of 8px that I compensate for using the weirdOffset variable. Still not bad quick solution, albeit a few months later ;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T23:44:20.187

我还没有看到一个这样做的，但是有许多插件在那里你可以通过在你的页面上配置它们来很快地将它们组合在一起......

看看[http://johnpolacek.github.com/scrollorama/](http://johnpolacek.github.com/scrollorama/)它具有您可以很快构建它的功能。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T15:38:44.230

如果您只想以不同的速度滚动项目，则某些框架可能会矫枉过正。您可以将函数绑定到滚动事件（***$(document).ready(function(){});***）并通过将滚动值乘以预定义因子来手动设置顶部位置。

[这里](http://f6design.com/journal/2011/08/06/build-a-parallax-scrolling-website-interface-with-jquery-and-css/)和[这里](http://net.tutsplus.com/tutorials/html-css-techniques/simple-parallax-scrolling-technique/)有几个关于如何做到这一点的教程。

从第一个教程开始，当检测到滚动并以不同的速度移动绝对定位的元素时调用这个函数，给人一种深度和透视的感觉：

```
function parallaxScroll(){
    var scrolled = $(window).scrollTop();
    $('#parallax-bg1').css('top',(0-(scrolled*.25))+'px');
    $('#parallax-bg2').css('top',(0-(scrolled*.5))+'px');
    $('#parallax-bg3').css('top',(0-(scrolled*.75))+'px');
} 
```

这可能是一个更简单的解决方案:)

# backbone.js - BackboneJS 集合添加事件在多个集合上触发

> ID：13078805
> 
> 赞同：4
> 
> 时间：2012-10-25T23:25:58.863
> 
> 标签：backbone.js, backbone.js-collections

我遇到了一个问题，我正在添加到集合中`CollectionA`，在哪里`CollectionA`并`CollectionB`正在侦听添加事件。但是，添加到 时，两个集合都会触发添加事件`CollectionA`。 `CollectionA`并且`CollectionB`是扩展`Backbone.Collection`且仅设置 url 的基本集合。

查看定义

```
ModelViewA = Backbone.View.extend({
    ...
    render : function() {
        var self       = this;
        var attributes = this.model.toJSON();
        this.$el.html(this.template(attributes));

        var collectionB     = new CollectionB();
        var collectionViewB = new CollectionViewB();
        collectionB.fetch({
            self.$el.append(collectionViewB.render().el);
        });

        return this;
    },
    ...
});

CollectionViewA = Backbone.View.extend({
    initialize : function() {
       this.collection.on('add', this.renderOne, this);
    },
    ...
    render : function() {
       this.collection.forEach(this.renderOne, this);
       return this;
    },

    renderOne : function(model) {
        console.log('Added to Collection A');

        var view = new ViewA({ model : model });
        this.$el.append(view.render().el);
        return this;
    }
});

CollectionViewB = Backbone.View.extend({
    initialize : function() {
       this.collection.on('add', this.renderOne, this);
    },
    ...
    render : function() {
       this.collection.forEach(this.renderOne, this);
       return this;
    },

    renderOne : function(model) {
        console.log('Added to Collection B');

        var view = new ViewB({ model : model });
        this.$el.append(view.render().el);
        return this;
    }
}); 
```

这就是我如何开始这些事件的级联......

```
var collectionA = new CollectionA();
var modelViewA = new ModelViewA({
    model : collectionA.at('some id');
});

$('body').append(modelViewA.render().el);
$('body').empty();

var collectionViewA = new CollectionViewA({ collection: collectionA });
$('body').append(collectionViewA.render().el);
collectionViewA.add([{...}]); 
```

此代码将使用模型视图正确输出初始视图。然后它将正确呈现`collectionViewA`，但是当我触发 add 事件时，它将尝试添加到`CollectionA`，`CollectionB`因此控制台将在每次调用 add 事件时显示以下内容

```
Added to Collection B
Added to Collection A 
```

它也会尝试渲染`Collection B`，但由于模板没有给出模型而引发错误。

让我知道这是否太令人困惑，我可以尝试更多地清除此描述。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T01:31:09.077

为什么，在你的渲染方法中`ModelViewA`，你创建一个`CollectionB`获取的实例？

```
 var collectionB     = new CollectionB();
    var collectionViewB = new CollectionViewB();
    collectionB.fetch({
        self.$el.append(collectionViewB.render().el);
    }); 
```

这甚至不解析。你确定你没有不小心编辑掉匿名成功函数吗？首先让我假设这不是您的代码所显示的。也就是说，它应该是这样的：

```
 collectionB.fetch({
        success: function(){
           self.$el.append(collectionViewB.render().el);
        }
    }); 
```

?

让我们一起去吧。

因此，当`ModelViewA`渲染时，*显然* `collectionB`会获取一些东西然后`collectionViewB`渲染，因为*这就是你告诉它要做的事情*。现在会导致你渲染`ModelViewA`s?

```
CollectionViewA = Backbone.View.extend({
    initialize : function() {
       this.collection.on('add', this.renderOne, this);
    }, ... 
```

```
renderOne : function(model) {
    console.log('Added to Collection A');

    var view = new ViewA({ model : model });
    this.$el.append(view.render().el);
    return this;
} 
```

这是什么`ViewA`？那也可以指`ModelViewA`？

如果是这样，我们可能会猜测发生了什么：

您的实例在每次添加时都会`CollectionViewA`呈现一个实例。`ModelViewA`每个实例的渲染`ModelViewA`都会创建一个`CollectionB`实例（`collectionB`）和一个`CollectionViewB`实例（`collectionViewB`），并且`collectionB`fetch 有一个成功的方法来渲染`collectionViewB`。如果`collectionB`有任何模型，对于每个模型，它会在尝试呈现 ViewB 实例之前成功登录到控制台“添加到集合 B”，如果我理解正确，它会失败（这可能就是为什么你只有一个“添加到集合” B”消息。

现在至于为什么控制台日志的顺序是相反的……我仍在努力解决这个问题。也许我错过了什么。

无论如何……这种情况并不理想。不过，我不确定我可以说些什么来改进您的代码。在我看来，调用`fetch`from`render`就像您在渲染代码中指定了很多事情要做。我什至不确定你`fetch`一开始就知道那是什么。

# c# - InvalidCastException：MongoDB 驱动程序中的 ConstantExpression 到 LambdaExpression

> ID：13078809
> 
> 赞同：1
> 
> 时间：2012-10-25T23:26:17.623
> 
> 标签：c#, linq, mongodb, lambda, mongodb-.net-driver

如何将其包装成可重用的表达式，以便在代码的其他地方使用？

```
nv => nv.a == nv2.a 
```

我试过这样做，但似乎返回 a`ConstantExpression`而不是 a `LambdaExpression`。

```
public Func<EntityName, bool> compareExpression()
{
    return nv => nv.a == this.a;
} 
```

我不介意我是如何做到这一点的，只要我有一个 LambdaExpression，我可以在代码中的多个地方使用它。DB 驱动程序将读取表达式并将其转换。

**更多详情**

鉴于这种;

```
db.p.insert(
  {
    arrayNest: [
      { a:1, b:10 },
      { a:2, b:20 },
      { a:3, b:30 },
      { a:4, b:40 },
]
  }
); 
```

和

```
class NV {
    int a;
    int b;
    public Func<EntityName, bool> compareExpression()
    {
        return nv => nv.a == this.a;
    }
}
class P {
     NV[] arrayNest;
} 
```

和一个方法；

```
 public virtual void Delete(Expression<Func<T, bool>> criteria)
    {
        this.Collection.Remove(Query<T>.Where(criteria));
    }

    var nv2 = new NV();
    Delete(p => p.arrayNest.Any(nv => nv.a == nv2.a)); // Works fine 
```

但是，当我使用返回表达式的函数中的 lambda 时；

```
 Delete(p => p.arrayNest.Any(nv => nv2.compareExpression())); // FAILS 
```

我得到一个

```
 System.InvalidCastException: Unable to cast object of type 'System.Linq.Expressions.ConstantExpression' to type 'System.Linq.Expressions.LambdaExpression'.

 Result StackTrace: 
  at MongoDB.Driver.Linq.PredicateTranslator.BuildAnyQuery(MethodCallExpression methodCallExpression) 
```

我看到`MongoDB.Driver.Linq.PredicateTranslator`假设每个表达式都是`(LambdaExpression)`.

那么这是驱动程序问题，还是我做错了什么？奇怪的是我根本不明白它为什么要评估为一个 ConstantExpression。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T07:15:32.200

问题是您的`compareExpression`方法返回一个表达式而不是该`Any`方法正在寻找的布尔值。您可以像这样调用返回的表达式`compareExpression`：

```
Delete(p => p.arrayNest.Any(nv => nv.compareExpression().Invoke(nv))); 
```

但是你`compareExpression`编写传入的对象的方式与对象`compareExpression`相同`this`，所以它总是会返回true。

# php - 在 php 中使用 imagefilter() 使图像清晰

> ID：13078812
> 
> 赞同：0
> 
> 时间：2012-10-25T23:26:39.050
> 
> 标签：php, image, image-processing, fonts, gd

有没有可能使用`imagefilter()`功能使图像更清晰？我正在使用`imagettftext()`它为字体添加抗锯齿，字体看起来有点分散。我喜欢让我的最终图像锐化一点，这样我就可以减少图像中字符周围的模糊。

## 不同的测试图像

*   **使用的字体**
    *   Roboto-Thin.ttf
    *   Roboto-Black.ttf

### 带有浅色字体的图像

我喜欢让我的字体看起来像旁边的那些线条。

![在此处输入图像描述](../Images/7c120421852a268e85a7c5d6a0fbb8e3.png)

### 带有深色字体的图像

![在此处输入图像描述](../Images/1aa7e0420df991f7ad749694f1b055d8.png)

### 带有 -$font_color 的图像（一些网络资源建议将字体颜色值设为负值，这基本上会关闭抗锯齿）但在这种情况下，字体看起来很难看。（Left-To-Right 100 关闭抗锯齿）

![在此处输入图像描述](../Images/53c8dc354b47415dda1ef5cdd93ec843.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T23:53:32.973

*imagefilter()*中没有这样的过滤器（您确实尝试过`IMG_FILTER_EDGEDETECT`？对于尖锐的过渡，也许它可以为您带来一些东西）。但是您可以尝试使用`imageconvolution`：

```
imageconvolution($imageResource, array(
    array( -1, -1, -1 ),
    array( -1, 16, -1 ),
    array( -1, -1, -1 ),
), 8, 0); 
```

您可能想查看[PHP imageconvolution() 在左上角留下黑点](https://stackoverflow.com/questions/12918060/php-imageconvolution-leaves-black-dot-in-the-upper-left-corner)，似乎有问题`imageconvolution`

另一种可能性是在应用文本之前调整图像大小，使其（比如说）大 200%。然后再次使用大 200% 的字体应用文本。然后对图像进行下采样。根据字体特性，这将具有减少模糊的效果。使用 2 的整数幂（200%、400%、...）有助于减少伪影。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T23:39:21.887

**GD解决方案**

```
$old = "old.png";
$new = "new.png";

$im = imagecreatefrompng($imgname);
imagetruecolortopalette($im, FALSE, 256);
imagecolorset($im, imagecolorclosest($im, 159, 159, 159), 0, 0, 0);
imagecolorset($im, imagecolorclosest($im, 191, 191, 191), 0, 0, 0);

imagepng($im, $new);
imagedestroy($im); 
```

**图像魔术解决方案**

```
convert old.png -fuzz 0% -fill rgb(0,0,0) -opaque rgb(159,159,159) new.png
convert new.png -fuzz 0% -fill rgb(0,0,0) -opaque rgb(191,191,191) new.png 
```

**他们会输出**

![在此处输入图像描述](../Images/cc7c1268f92fda000e34761dd10bce44.png) ![在此处输入图像描述](../Images/c5b6eeeeb82a6d3804ca5165ce7cb6a7.png)

```
 Old                           new 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T21:36:41.393

您正在使用 Roboto 字体的两个极端。选择浅色或普通版，它会变暗而不会*太暗*。

字体渲染器的抗锯齿功能无法使细线的粗细小于 1 个像素，因此反而使它们变暗。

# sql - 根据在另一个表上找到的值从 ms 访问数据库中获取可变数量的行

> ID：13078813
> 
> 赞同：1
> 
> 时间：2012-10-25T23:26:40.730
> 
> 标签：sql, ms-access-2007, oracle-xe, rownum

我花了一整天的时间试图为这个问题想出一个解决方案，但我仍然不知道：

我在一个表**用户**中有以下字段：

*   ID
*   姓名
*   city_id
*   分数

在另一个表**城市**中，有两个字段：

*   ID
*   用户数

我要做的是从**城市**中的 users_number 字段指定的**用户**表中获取最上面的行，但首先，按分数对获取的行进行排序。用户数量远大于 users_number 指定的值。

 **我的问题是：

是否有可能从表**users**中选择条件是表**city**中的行数？

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:43:38.660

这是 T-SQL 中的一个答案，这对找出 Access 有什么帮助吗？

```
declare @users table 
(
    id int primary key clustered
    , name nvarchar(64)
    , city_id int 
    , score int
)
declare @city table (
    id int primary key clustered
    , name nvarchar(64)
    , users_number int
)

insert @city
      select 1, 'San Fran', 2
union select 2, 'NY', 5

insert @users
      select 1, 'Steve Fields', 1, 10
union select 2, 'Sarah Felcher', 1, 20
union select 3, 'Nick Yarnton', 2, 12
union select 4, 'Nigel Yardsman', 2, 12
union select 5, 'Nicki Yakatou', 2, 13
union select 6, 'Nicola Yates', 2, 23
union select 7, 'Steph Freeman', 1, 15
union select 8, 'Ned Yount', 2, 18
union select 9, 'Neil Yorke', 2, 1

select *
from @city c
left outer join 
(
    select id, name, city_id, score
    , ROW_NUMBER() over (partition by city_id order by score desc) r
    from @users
) u
on c.id = u.city_id
where c.users_number >= u.r
order by c.id, u.score desc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T23:34:24.763

MS Access 怎么样：

```
SELECT t.ID, (
   SELECT Count(ID) 
   FROM users s 
   WHERE s.ID<=t.ID And s.city_id=t.city_id) AS Expr1
FROM users AS t
INNER JOIN City c
ON t.city_id = c.ID
WHERE (
    SELECT Count(ID) 
    FROM users s 
    WHERE s.ID<=t.ID And s.city_id=t.city_id)<=c.users_number
ORDER BY t.ID 
```

结果：

```
id  city_id Expr1
1       1       1
2       1       2 
-----------------------------
5       2       1
6       2       2
7       2       3
-----------------------------
9       3       1 
```

其中 ID 是用户 ID，Expr1 是订单。

输入

用户

```
id  name    city_id 
1   a       1   
2   b       1   
3   c       1   
4   d       1   
5   e       2   
6   a       2   
7   b       2   
8   c       2   
9   d       3   
10  e       3 
```

城市

```
id  users_number
1   2
2   3
3   1 
```**

# orm - monodevelop 的 codesmith+nettiers 替代方案

> ID：13078816
> 
> 赞同：0
> 
> 时间：2012-10-25T23:26:51.537
> 
> 标签：orm, mono

我真的很喜欢 codesmith+nettiers(+visual studio)。monodevelop+linuxi+postgresql 有什么好的替代方案吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T05:53:37.533

我想你可以使用 NHibernate + [MindScape 的 NHibernate Designer for Visual Studio](http://www.mindscapehq.com/products/nhdesigner) 对于小型模型是免费的而且 Nhibernate 是开源的，顺便说一句：NetTiers 死了吗？

# asp.net-mvc-3 - MVC 3 视图如何绑定到控制器操作

> ID：13078819
> 
> 赞同：3
> 
> 时间：2012-10-25T23:27:31.847
> 
> 标签：asp.net-mvc-3, razor, view, controller

这更像是对 MVC 3 如何工作的“架构理解”。我真的很想知道 MVC 如何知道为给定的控制器操作调用哪个视图。我可以猜测，当我们使用 Visual Studio 为控制器操作创建视图时，它会将这些绑定存储在项目的某种文件中，对吗？

提前致谢。Marcelo Myara 里约热内卢/巴西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:32:16.880

它是使用[“约定优于配置”](http://en.wikipedia.org/wiki/Convention_over_configuration)的思想完成的。

如果您使用没有视图的随机操作，您可以看到它实际上是在尝试一堆不同的约定，寻找匹配项：

```
public ActionResult SomeActionWithNoView()
{
    return View();
} 
```

**它在Views/ControllerName**或**Views/Shared**文件夹中查找与操作名称匹配的视图文件（.aspx、.ascx、.cshtml 或 .vbhtml 扩展名） 。

> 未找到视图“SomeActionWithNoView”或其主视图，或者没有视图引擎支持搜索到的位置。搜索了以下位置：
> 
> ~/Views/Home/SomeActionWithNoView.aspx
> 
> ~/Views/Home/SomeActionWithNoView.ascx
> 
> ~/Views/Shared/SomeActionWithNoView.aspx
> 
> ~/Views/Shared/SomeActionWithNoView.ascx
> 
> ~/Views/Home/SomeActionWithNoView.cshtml
> 
> ~/Views/Home/SomeActionWithNoView.vbhtml
> 
> ~/Views/Shared/SomeActionWithNoView.cshtml
> 
> ~/Views/Shared/SomeActionWithNoView.vbhtml

* * *

可以使用**/Views**根目录中的**_ViewStart.cshtml设置默认视图布局：**

 **```
@{
    Layout = "~/Views/Shared/MyDefaultLayout.cshtml";
} 
```

可以根据需要在各个视图中删除或更改它。**

# c# - MEF Composition ImportMany 产生同一类的两个版本

> ID：13078821
> 
> 赞同：2
> 
> 时间：2012-10-25T23:27:45.643
> 
> 标签：c#, .net, mef

我一直无法为我的问题找到答案。我正在使用 MEF 来查找和创建实现 IPlugIn 的类，但我最终得到了每个 PlugIn 类的两个版本。我已确定 AggregateCatalog 仅包含一个程序集，该程序集仅包含每个类的一种类型作为部件，但我仍然得到每个类的两个实例作为最终结果。我可能只是在做一些愚蠢的事情，但我还没有找到它。我将不胜感激任何帮助...

```
...

    [ImportMany(typeof(IPlugIn))]
     公共 System.Lazy>[] 插件 { 获取；放; }

...
    //aggregatecatalog 只包含一个包含插件类的 dll，其中 4 个
    容器 = 新组合容器（聚合目录，
                                         CompositionOptions.DisableSilentRejection
                                         | CompositionOptions.IsThreadSafe);\

    container.SatisfyImportsOnce(this);

    ...
    公共无效开始所有（）
    {
    //我们这里有8个插件？？如何？
    if (Plugins == null || Plugins.Count() == 0)
    {

       log.Warn("没有可启动的插件！");
       返回;
    }

        foreach（插件中的 var 插件）
        {
            log.Info("启动插件：" + plug.Value.GetName());
            plug.Value.Start();
        }
    }

   ...

    [导出（类型（IPlugIn））]
    公共类 MyPlugIn : BasePlugIn, IPlugIn

    ...

```

我在 Visual Studio 中调试。我清楚地看到只有一个程序集加载。CompositionContainer 每个只有 1 个。在 StartAll() 中的 SatisfyImportOnce 之后，我有每个 IPlugIn 类的两个实例。这与我使用 ImportMany 的方式有关吗？我对任何想法持开放态度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T20:03:21.483

解决方案很简单。我从 IPlugIn 接口中完全删除了 [InheritedExport]，并创建了正确数量的插件。如果我从每个 PlugIn 子类中删除 [Export... ，我根本没有插件。正是这两者的结合创造了多个实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-02T15:14:54.287

如果您`InheritedExport`的接口上有一个属性，则必须`InheritedExport`在实现该接口的类上使用一个属性。应用`Export`结果将组成一个额外的部分，这就是你发现的。

此外，如果您想将任何其他应用`ExportMetadata`到实现接口的类，则`InheritedExport`必须*再次*`InheritedExport`添加该属性以添加元数据（替换继承的元数据，即使没有）。[InheritedExport](http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&l=EN-US&k=k%28SYSTEM.COMPONENTMODEL.COMPOSITION.INHERITEDEXPORTATTRIBUTE%29;k%28TargetFrameworkMoniker-%22.NETFRAMEWORK%2CVERSION%3DV4.0%22%29;k%28DevLang-CSHARP%29&rd=true)或[ExportMetadata](http://msdn.microsoft.com/en-us/library/system.componentmodel.composition.exportmetadataattribute%28v=vs.100%29.aspx)的 MSDN 文档中没有解决此问题，但我在其他晦涩的 Microsoft 文档中遇到了一些模糊的引用。

# git - Git克隆突然停止工作？

> ID：13078825
> 
> 赞同：0
> 
> 时间：2012-10-25T23:28:34.693
> 
> 标签：git, deployment, capistrano

我使用 capistrano 来部署我的 rails 应用程序。今天我注意到它失败了，然后回滚了。具体错误是：

```
** github.com[0:207.97.227.239]: errno=Connection timed out 
** fatal: unable to connect a socket (Connection timed out) 
** Git error: command `git clone 'git://github.com/username/pygments.rb.git' 
```

如果我通过 SSH 连接到服务器并运行

`git clone 'git://github.com/username/pygments.rb.git' test`

它超时......如果我在本地运行它但是在我的计算机上它可以完美运行。

另外——如果我使用 http:// 链接，它会成功克隆。只有 git-read-only 链接是超时的。

我的代码中没有任何更改，并且已经使用此代码部署了 100 次。

我还将那个特定的 IP 添加到 CSF 中，但它也没有帮助（我还没有对防火墙等进行任何服务器更改）。

有什么办法可以调试这个，或者任何关于我应该列入白名单的输入（如果这甚至是正确的答案的话......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:36:12.870

看起来服务器被阻止访问 github。确保您的防火墙允许 TCP 通过端口 9418 到您的服务器访问 github，或者尝试切换到`https://github.com/...`而不是`git://github.com/...`

您可以在本地计算机上访问它但服务器不能访问它的事实似乎表明有人更改了防火墙以阻止您的服务器使用该端口。

# instruments - 从设备上的命令行运行仪器 4.5 时无法启动跟踪

> ID：13078828
> 
> 赞同：4
> 
> 时间：2012-10-25T23:29:52.180
> 
> 标签：instruments, ios-ui-automation

我尝试从设备上的命令行运行 Instruments 4.5。我有以下

```
instruments -w UICD -t /Applications/Xcode.app/Contents/Applications/Instruments.app/Contents/PlugIns/AutomationInstrument.bundle/Contents/Resources/Automation.tracetemplate /Users/xxx/Library/Developer/Xcode/DerivedData/xxxxx/Build/Products/Debug-iphoneos/AppName.app -e UIASCRIPT /Users/xxxx/Documents/Automation/test.js  -e UIARESULTSPATH /pathName 
```

当我在 iPod 上运行时，我还尝试省略路径名和 .app 扩展名。并尝试了 Release-iphoneos 和 Debug-iphoneos 构建。但无论我做什么，它总是给我错误：

```
Instruments Trace Error : Failed to start trace 
```

谁能告诉我为什么以及如何使这项工作？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T18:43:42.837

我实际上弄清楚为什么这不起作用。上面列出的命令没有错。从命令行运行 Instruments 当前无法在所有受支持的 iOS 设备上运行。相同的命令适用于我的带有 iOS6 的新 ipad，但不适用于带有 ealier iOS 的旧 ipod。我找到了下面的链接。希望这对每个人都有帮助。此外，在某些奇怪的情况下，该命令仅在仪器和 Xcode 未运行时才有效....

[https://discussions.apple.com/thread/4344641?start=0&tstart=0](https://discussions.apple.com/thread/4344641?start=0&tstart=0)

# javascript - 构建多维数组

> ID：13078833
> 
> 赞同：0
> 
> 时间：2012-10-25T23:30:25.123
> 
> 标签：javascript, node.js, redis

我正在尝试使用 redis 作为数据源使用 node.js 构建一个多维数组。但是，我做得不对。

menuKey 包含包含 redis 中排序集的键，排序集包含引用其他键的值。例如：

```
menu:main:sections contains ["menu:main:section1","menu:main:section2"]
menu:main:section1 contains ["option1", "option2"]
menu:main:section2 contains ["option1"] 
```

我正在尝试构建的数组：

```
[["option1", "option2"], ["option1"]] 
```

这是我拥有的代码，但我以某种方式放置了错误的回调？

```
function handleMenu(jsonrpc) {
  var params = jsonrpc['params'];
  var result = [];
  var sections = [];

  menuKey = 'menu:' + params['menu'] + ':sections';
  async.series([
      function (callback) {
        redis.zrevrange(menuKey, 0, -1, function(err, sections) {
          async.forEachSeries(sections, function(section, sectionCallback) {
            redis.zrevrange(section, 0, -1, function(err, items) {
              result.push(items); 
              sectionCallback();
            });
          }, callback);
        });
      }
  ], function() {
    console.log(result);
  });
} 
```

我看不出我做错了什么，请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T05:12:48.457

我认为你有两个问题。

1.  您需要一个 javascript 对象而不是数组作为您的顶级容器
2.  你似乎在最后覆盖了你的结果

尝试这个：

```
function handleMenu(jsonrpc) {
  var params = jsonrpc['params'];
  var result = {}; // THIS LINE IS DIFFERENT
  var sections = [];

  menuKey = 'menu:' + params['menu'] + ':sections';
  async.series([
     function (callback) {
         redis.zrevrange(menuKey, 0, -1, function(err, values) {
         sections = values;
         callback(); 
     });
  },
  function (callback) {
    async.forEachSeries(sections, function(section, cb) {
      redis.zrevrange(section, 0, -1, function(err, values) {
        result[section] = values;
        cb();
      });
    }, callback);
  }
  ], function() {
    // result = sections; // <--- DON'T DO THIS
    console.log(result);
  });
} 
```

在这种情况下`result`将如下所示：

```
{"menu:main:section1": ["option1", "option2"], "menu:main:section2": ["option1"]} 
```

您不需要二维数组。`sections`是 的有序索引`result`。您`sections`按顺序浏览并使用这些键来提取保留二级顺序的数组。像这样：

```
var i = 0,
    j = 0,
    section,
    contents;

for(i = 0; i < sections.length; i++){
    section = sections[i];
    contents = result[section];
    for(j = 0; j < contents.length; j++{
        console.log(contents[j]);
    }
} 
```

更新：

如果绝对必须有一个二维数组。`i`然后在顶部声明一个变量（并将其设置为 0）`handleMenu`并使用它代替`sections`，如下所示：

```
result[i++] = values; 
```

另外，将`result`声明改回如下：

```
var result = []; 
```

# android - SQLite“没有这样的表”

> ID：13078835
> 
> 赞同：3
> 
> 时间：2012-10-25T23:30:33.423
> 
> 标签：android, eclipse, sqlite

我在 Eclipse 中制作了一个 Adnroid 程序，它读取 csv 文件并将信息输入到 SQLite 数据库中，并使用

```
dbCursor = database.query(DATABASE_TABLE, new String[]{KEY_ROWID, KEY_ITEMTYPE, KEY_QUANTITY},  null, null, null, null, null);  

    int iRow = dbCursor.getColumnIndex(KEY_ROWID);
    int iType = dbCursor.getColumnIndex(KEY_ITEMTYPE);
    int iQuantity = dbCursor.getColumnIndex(KEY_QUANTITY);

        for(dbCursor.moveToFirst(); !dbCursor.isAfterLast(); dbCursor.moveToNext()){
            allData = allData + " " + dbCursor.getString(iRow) + "\t " + dbCursor.getString(iType) + "\t\t\t " + dbCursor.getString(iQuantity) + "\n";      
        } 
```

然后在 textview 框中打印出 allData 效果很好。

然后我想用

```
dbCursor = database.rawQuery("SELECT KEY_ROWID , SUM(KEY_ITEMTYPE) FROM DATABASE_TABLE GROUP BY KEY_ROWID", null);          
for(dbCursor.moveToFirst(); !dbCursor.isAfterLast(); dbCursor.moveToNext()){

    allDataSum = allDataSum + " " + dbCursor.getString(0);
} //I know this will probably not print what I want correctly but that's a problem for another day 
```

当我尝试打印此内容时，我收到错误“10-25 22:06:35.016: I/Database(1911): sqlite returned: error code = 1, msg = no such table: DATABASE_TABLE”。

然后我打开 DDMS 文件资源管理器并将数据库复制到我的桌面上，然后尝试使用命令工具查看数据库，但再次出现错误，“SQL 错误：没有这样的表：库存”。

当数据库中显然没有表时，模拟器如何向我显示我想从 .query()（但不是从 .rawQuery）中看到的内容？关于我使用查询和 rawQuery 的一切都是相同的，所以这不是不为 rawQuery 或类似的东西打开数据库的情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:37:32.150

您似乎正在使用名为 DATABASE_TABLE、KEY_ROWID 和 KEY_ITEMTYPE 的静态变量，其中包含您的实际名称。当您将它与 rawQuery 一起使用时，您必须这样做

```
dbCursor = database.rawQuery("SELECT " + KEY_ROWID + ", SUM(" + KEY_ITEMTYPE + ") FROM " + DATABASE_TABLE + " GROUP BY " + KEY_ROWID, null); 
```

请注意，当您使用`database.query`引号中没有这些变量进行查询时，这就是它起作用的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T23:37:28.777

不确定 SUM() 聚合是否给您带来麻烦，但您可以使用 sqlite 命令行和“.tables”命令仔细检查表的存在：

```
sqlite3 DATABASE
SQLite version 3.7.8 2011-09-19 14:49:19
Enter ".help" for instructions
Enter SQL statements terminated with a ";"
sql>.tables 
```

# android - Android 模拟器内存 不足

> ID：13078837
> 
> 赞同：2
> 
> 时间：2012-10-25T23:31:07.493
> 
> 标签：android, opengl-es, android-emulator, opengl-es-2.0

我正在 Android OpenGL ES 2.0 中编写一个 2D 图形程序，当我重新启动模拟器时，它开始出现以下错误`"OutOfResourceException initializing HW surface"`，并且`"... error 0x3003: EGL_BAD_MALLOC"`

我正在为 4.0.3 运行一个普通的预煮模拟器，并启用了 GPU 仿真，并且该应用程序运行良好并正常退出。但是，模拟器似乎在每次编译时都会累积内存，最终会用完。Windows 任务管理器显示模拟器到那时消耗了大约 850MB（我的电脑有 8GB）。我从内存中加载的唯一资源是两个只是文本的小型着色器程序，所以我不知道这些积累来自哪里。

我的问题是为什么会这样。**在管理内存方面， OpenGL ES**在后台做了哪些事情我应该知道？我以前做过 Android 应用程序，但没有发生这种情况。我意识到这是相当开放的，所以对此的一般智慧将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T15:52:46.123

模拟器上的 OpenGL ES 很糟糕，几乎完全无法与设备相比。

挖出那根USB线:)

# vba - Powerpoint vba - 从excel复制表格

> ID：13078839
> 
> 赞同：1
> 
> 时间：2012-10-25T23:31:11.330
> 
> 标签：vba, powerpoint

我一直在尝试编写一个宏，该宏使用 Excel 中的表格通过 powerpoint vba 更新演示文稿。

**这是我正在做的**

*   代码首先删除演示文稿中的所有图片，
*   然后打开 Excel 工作簿，复制命名范围并粘贴到正确的幻灯片中。

这个确切的代码在两天前运行良好，现在说该**对象超出**了复制范围**"PL"**的范围。任何帮助或提示都会很棒，因为这是我第一次使用 powerpoint vba。

```
valnPath = "G:\valnpath\"
PriorPath = "G:\Priorpath\"

Dim xlApp As Object
Dim xlWorkBook As Object
Dim XL As Excel.Application
Dim PPSlide As PowerPoint.Slide

Set xlApp = CreateObject("Excel.Application")
xlApp.Visible = True
xlApp.DisplayAlerts = False
xlApp.AskToUpdateLinks = False

Set xlWorkBook = xlApp.Workbooks.Open(valnPath & "Presentation Tables 1208.xlsx", True, False)
Set XL = GetObject(, "Excel.Application")
    XL.DisplayAlerts = False
    XL.AskToUpdateLinks = False
    XL.Range("PL").Copy

 ActivePresentation.Slides(3).Select
 Application.ActiveWindow.View.PasteSpecial DataType:=ppPasteEnhancedMetafile

Set XL = GetObject(, "Excel.Application")
    XL.DisplayAlerts = False
    XL.AskToUpdateLinks = False
    XL.Range("AvE").Copy

 ActivePresentation.Slides(5).Select
 Application.ActiveWindow.View.PasteSpecial DataType:=ppPasteEnhancedMetafile

 Set XL = GetObject(, "Excel.Application")
 XL.Quit 
```

我做错什么了吗？请在这件事上给予我帮助，

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T00:51:08.723

试试这个：

```
valnPath = "G:\valnpath\"
PriorPath = "G:\Priorpath\"

Dim xlApp As Excel.Application
Dim xlWorkBook As Excel.Workbook
Dim PPSlide As PowerPoint.Slide

Set xlApp = CreateObject("Excel.Application")
With xlApp
   .Visible = True
   .DisplayAlerts = False
   .AskToUpdateLinks = False
End With

Set xlWorkBook = xlApp.Workbooks.Open(valnPath & _
                       "Presentation Tables 1208.xlsx", True, False)

xlApp.Range("PL").Copy
ActivePresentation.Slides(3).Select
Application.ActiveWindow.View.PasteSpecial DataType:=ppPasteEnhancedMetafile

xlApp.Range("AvE").Copy
ActivePresentation.Slides(5).Select
Application.ActiveWindow.View.PasteSpecial DataType:=ppPasteEnhancedMetafile

xlWorkBook.Close False
xlApp.Quit 
```

# webdav - 如何访问 CardDAV 协议的基本 URL？

> ID：13078840
> 
> 赞同：0
> 
> 时间：2012-10-25T23:31:16.017
> 
> 标签：webdav, carddav

我想获取一个帐户存在的 vCard。服务器是`google.com`，我知道用户名/密码。我不知道正确的基本网址是什么。在 google.com 上执行 PROPFIND 会导致服务不可用。我在 icloud CardDAV 上遇到了类似的问题（我通过硬编码完整地址来破解它），这让我相信必须有一种正确的方法来发现基本 url。搜索 RFC 我找不到它。此外，CardDAV 应用程序似乎能够毫无问题地找到数据。有人有想法么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T12:18:39.680

使用[https://google.com/.well-known/carddav](https://google.com/.well-known/carddav)作为起点。这也适用于 iCloud。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-28T13:02:11.083

我尝试使用这个[github](https://github.com/Metric/CardDavNet)项目（用于 .NET）。自述文件告诉我们使用这个网址（使用正确的用户名）： [https:](https://google.com/m8/carddav/principals/) //google.com/m8/carddav/principals/__uids__/username@gmail.com/lists/

但我没有看到我的联系人或使用此代码创建新联系人，谷歌只是响应 HTML 200 OK 或 400 Bad Request。

本文[指出](http://www.ghacks.net/2012/12/15/sync-google-contacts-with-thunderbird-using-carddav/)：[https:](https://google.com/m8/carddav/principals/) //google.com/m8/carddav/principals/__uids__/username@gmail.com/lists/default/

[您可以在此处](https://github.com/Metric/CardDavNet/issues/1)找到我们的研究结果。但一些[消息来源](http://www.bynari.net/can-i-access-my-calendars-and-contacts-with-other-clients-via-caldav-and-carddav/)说，谷歌的 CardDAV URL 不再可用。

# android - 可以在android径向渐变drawable中重新定位中心颜色吗？

> ID：13078845
> 
> 赞同：11
> 
> 时间：2012-10-25T23:32:09.017
> 
> 标签：android, drawable, gradient, android-xml

使用径向渐变中的标准开始、中心和结束颜色很容易在左侧实现下面的渐变，其中开始 = 黄色，中心 = 紫色，结束 = 蓝色。然而，右边的圆圈需要重新定位中心颜色。这可能吗？

![在此处输入图像描述](../Images/7a48330fdbbed2ed9a4464b37e163df3.png)

左侧的结果可以通过以下方式重现：

```
 <shape android:shape="oval">
        <gradient
            android:endColor="#0000ff"
            android:gradientRadius="my_radius"
            android:centerColor="#770077"
            android:startColor="#00ffff"
            android:type="radial"/>
    </shape> 
```

我想知道是否可以移动中心颜色以实现右侧的渐变。我相信答案是否定的，但我想看看是否有人发现了一种方法来做到这一点。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-07T02:05:18.873

遗憾的是，这不能通过 XML 声明来实现，但是可以通过代码来实现。

这是一个快速的代码示例：

```
public class MyDrawing extends View 
{   
    private Paint mPaint;

    public MyDrawing(Context context, AttributeSet attrs, int defStyle)
    {
        super(context, attrs, defStyle);
        init();
    }

    public MyDrawing(Context context, AttributeSet attrs)
    {
        super(context, attrs);
        init();
    }

    public MyDrawing(Context context)
    {
        super(context);
        init();
    }

    private void init()
    {
        int [] colors = new int[] { 0xff0000ff, 0xff00ff00, 0xffff0000 };
        float [] positions = new float[] { 0.4f, 0.7f, 0.9f };

        RadialGradient gradient = new RadialGradient(50, 50, 50, colors, positions, TileMode.CLAMP);                
        mPaint = new Paint();
        mPaint.setDither(true);
        mPaint.setShader(gradient);
    }

    @Override
    protected void onDraw(Canvas canvas) 
    {           
        super.onDraw(canvas);                               

        canvas.drawCircle(circleX, circleY, circleRadius, mPaint);      
    }
} 
```

你应该注意两件事：

1.  在颜色数组中，您必须指定 alpha（第一个到 chars）。在我的示例中，我将两者都指定为“ff”，表示没有透明度。如果不指定 alpha，则默认为 0。

2.  位置数组指定渐变中每种颜色的位置或强度。玩弄这个来达到你正在寻找的结果。

希望这可以帮助 ：）

# node.js - 不显眼的节点测试

> ID：13078848
> 
> 赞同：3
> 
> 时间：2012-10-25T23:32:31.830
> 
> 标签：node.js, tdd, bdd, mocha.js

所以，我是 js 测试的新手，我正在尝试使用 mocha 来测试节点应用程序。

理想情况下，我希望拥有它，以便测试位于单独的文件中并在节点脚本本身上运行（可能通过在测试脚本顶部使用 require 调用）。目前我正在做一些我知道不可能正确的事情，即将测试包含在脚本文件底部的一个块中。这是包含在生产代码中的测试代码的问题，以及当您尝试启动节点服务器时它返回“未定义描述”的事实。

我已经阅读了很多关于 mocha 等的教程，似乎您可以通过执行“module.export.”来单独导出所有方法，但这似乎成本高昂而且也很突兀。

我在这里想念什么？当然，您不必构建两个脚本（一个有测试代码，一个没有测试代码？） - 最终会出现版本问题。

这是如何做到最好的（文章链接也被接受了。:)

谢谢

詹姆士

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T02:51:01.173

所以这就是我看到人们在做的事情，以及我在自己的工作中采用的方法：

1.  在您的模块中，仅导出需要导出的值。就个人而言，我试图限制自己只导出一个函数，但这是一个单独的讨论。
2.  创建一个`test`目录并将所有测试用例放入其中。使用您喜欢的任何命名约定。我更喜欢为每个源模块创建一个测试文件。在每个文件的开头，只需要被测模块。
3.  使用参数从 Makefile/Cakefile 调用 mocha，`--recursive`以便它知道检查`test`目录的全部内容。

这意味着您正在通过它们的接口测试模块，就像在普通代码中使用它们一样。缺点是，如果您有执行路径难以通过模块界面访问的非导出函数，您可能会发现自己有点沮丧。

一方面，我同意模块应该在使用时进行测试的观点。另一方面，我认为我知道我直接测试了上述每一个棘手的执行路径，我晚上会睡得更好。在进行 node.js 编程之前，我花了几年时间编写 erlang 代码，它具有完全相反的约定：（测试放在源文件的末尾，因此它们可以直接访问模块中的每个函数，并且测试包含/导出由 ifdef 指令处理）。就个人而言，我更喜欢 erlang 方法。

无论如何，我希望这会有所帮助。如果有人读到这篇文章有强烈的相反意见，我很想听听。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-02T20:23:44.487

我同意 David Weldon 的帖子，但我将添加一些示例。

您应该像往常一样编写 Node 模块。如果我正在编写一个可能在代码的其他部分中使用的计算器，我的计算器模块可能看起来像这样：

```
Calculator = {
  add: function(a, b) {
    return a + b;
  }
};

module.exports = Calculator; 
```

您提到使用`module.exports`似乎昂贵且突兀。对此，您可以做几件事。`module.exports`是让您的代码在另一个文件中可访问的最佳和推荐方式。为了简单起见，您可以将函数和变量包装在一个对象中，就像我对计算器所做的那样，并且只导出一个对象。

请注意，有两种使用“导出”的方法。你可以这样做：

```
var a = function() { ... };
var b = 10;
var c = null;

exports.a = a;
exports.b = b;
exports.c = c; 
```

它将东西添加到`exports`模块的特殊对象中。或者你可以这样做：

```
objectToExport = {
  a: function() { ... },
  b: 10,
  c: null
};

module.exports = objectToExport; 
```

这将替换**对象**`exports`。如果你这样做`exports = objectToExport`了，它将不起作用，当你尝试`require`在另一个文件中使用模块时，你最终会得到一个空对象。

当我使用 Mocha 进行测试时，我将所有测试文件放在一个`test`目录中，该目录反映了我的代码目录的结构。

```
project
  +- lib
   +- calculator.js
  +- test
   +- lib
    +- calculator.js 
```

我的 test/lib/calculator.js 文件是我对 lib/calculator.js 文件的 Mocha 测试

```
var Calculator = require('../../lib/calculator.js');
var assert = require('assert');

describe('Calculator', function() {
  describe('add', function() {
    it('should add two numbers', function() {
      var res = Calculator.add(2,2);
      assert.equal(res, 4);
    });
  });
}); 
```

默认情况下，mocha 会`/test`在你运行 mocha 的目录中查找目录。如果您有上面示例中的子目录，您可以添加`--recursive`到命令行以查找所有测试。因此，如果您在`project`上面的目录中运行，您的命令将是`mocha --recursive`.

# vb.net - TryCast 加倍？

> ID：13078854
> 
> 赞同：5
> 
> 时间：2012-10-25T23:33:36.507
> 
> 标签：vb.net, casting

我正在尝试将字符串转换为双精度，但我不希望它抛出异常，而是返回一些值。我找到了 TryCast 功能，但似乎我没有正确使用它。我试了一下`TryCast(string, Double)`，它说“Double”是一种值类型，而不是引用类型。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T23:37:01.387

[Double.TryParse（字符串，双精度）](http://msdn.microsoft.com/en-us/library/system.double.tryparse.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T23:35:54.460

您应该改用[TryParse](http://msdn.microsoft.com/en-us/library/system.double.tryparse.aspx)方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-10T09:34:47.433

你应该试试这个：

```
If Double.TryParse(value, New Double) Then
    ' TODO
end if 
```

# tomcat - 如何找到 Tomcat 的 servlet-api.jar 的位置？

> ID：13078856
> 
> 赞同：0
> 
> 时间：2012-10-25T23:33:57.577
> 
> 标签：tomcat

以前版本的 Tomcat 在环境中设置了 TOMCAT_HOME 和 CATALINA_HOME。

但是 Tomcat 7 没有设置这些。我在注册表中也找不到任何给出根 Tomcat 目录的东西。

我怎样才能以编程方式得到这个？

我的问题仅适用于 Windows。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T16:01:49.737

您可以通过查找此 JAR 中包含的任何类的位置来获取 JAR 文件的位置，例如使用以下代码：

```
Class<?> clazz = javax.servlet.Servlet.class;
ClassLoader cl = clazz.getClassLoader();
if (cl == null) {
    cl = Thread.currentThread().getContextClassLoader();
}
String classLocation = cl.getResource(clazz.getName().replace('.', '/') + ".class").toString();
String jarLocation = classLocation.substring(0, classLocation.indexOf('!')); 
```

# php - PHP 生成帖子数据

> ID：13078859
> 
> 赞同：0
> 
> 时间：2012-10-25T23:34:01.827
> 
> 标签：php, html, forms, post, header

所以我有一个注册页面，用户在其中注册他/她的所有信息，然后当他们点击提交时，我将表单的操作设置为`action="Scripts/Insert.php`。

insert 所做的只是将所有输入的信息插入到我的数据库中。之后，我需要将他们重定向到另一个他们可以付款的网站。但我需要将一些数据发布到以下站点。出于安全原因，我必须通过**POST**而不是会话发送它。我尝试将所需的信息插入到内部的 post 数组中，或者`Insert.php`当我重定向时 post 数组被清除。所以插入看起来像这样：

```
$gen = new Generator();
$_POST["SITEID"] = 3;

//Validation Key Generator
$_POST["TransactionID"] = $gen->keygen(10);
$_POST["Amount"] = 500;
$salt = "somelongstring";
$_POST["VALIDATION_KEY"] = base64_encode(md5($posting_valKey+$_POST["EXT_TRANS_ID"]+$_POST["AMT"]));

//Use PDO to insert previous page form information into the database

header("Location: www.paymentsite.com/index.jsp"); 
```

但就像我说的那样，帖子被删除了，所以没有任何东西被发送到网站。那么如何在这里生成一些帖子数据并将其发送到站点呢？我正在考虑一种可能的解决方案，即回显具有这些值的隐藏字段的 html 表单，但是有两个问题：

1.  如何在输入值中使用变量？我可以这样做：

    ```
    echo "<input type='hidden' value="$salt" name='salt'>" 
    ```

2.  然后我该如何提交表格？

如果我的解决方案很糟糕，请让我知道从 php 发布到另一个网站的任何其他方式。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:37:59.300

你看过[cURL](http://php.net/manual/en/book.curl.php)吗？

您是否需要将用户物理推送到另一个站点或只是将表单信息发送到那里？

如果您需要发布到外部站点，您可以使用隐藏字段来传递必要的信息。您可以将您的操作参数更改为接收站点 www.paymentsite.com/index.jsp

不过，您会认为支付网站会为您提供基本的集成教程。如果他们不这样做，他们可能不值得使用。

澄清一下，用户在单击提交按钮时会发送表单和隐藏字段的信息。如果您将操作点指向接收站点，它将自动将它们带到那里。但这可能很明显，所以我质疑您网站的实际需求。您是否首先发布给自己以创建交易记录、参考或接收站点所需的内容？那么您知道将付款记入哪个帐户吗？这可以在页面加载之前完成吗？

我想我只是不知道你为什么先给自己发帖。如果您用它更新您的问题，也许您发布给我们的支付处理器可以改进答案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T23:37:38.987

你有不同的可能性，其中两个是 Curl 和 Pecl。

更多信息：[http ://www.lornajane.net/posts/2010/three-ways-to-make-a-post-request-from-php](http://www.lornajane.net/posts/2010/three-ways-to-make-a-post-request-from-php)

# networking - 为什么wireshark 不能识别我的tcp 请求中的http 文本？

> ID：13078866
> 
> 赞同：0
> 
> 时间：2012-10-25T23:34:58.373
> 
> 标签：networking, tcp, pcap, tcp-ip, pcap.net

我正在尝试通过定制的基于 pcap.net 的 tcp 客户端发送 http 数据。

通常，当我通过浏览器发送请求时，在wireshark中它看起来像这样：

![在此处输入图像描述](../Images/7ca72f0ff9519ea2f1bcb8b96b1589c3.png)

但是，当我自己通过 TCP 发送相同的数据时，wireshark 中的请求如下所示：

![在此处输入图像描述](../Images/14b37e51d849b918b112c4a6607a8fb6.png)

并且服务器没有正确响应它。

我通过 PayloadLayer 将数据附加到 TcpDatagraw，但似乎缺少一些东西。

我应该改变什么才能正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T00:25:41.273

尝试在 HTTP 数据末尾附加 2 个 CRLF ( **\r\n\r\n )**

# vb.net - 使用文本框目录移动具有特定扩展名的文件 vb.net

> ID：13078867
> 
> 赞同：0
> 
> 时间：2012-10-25T23:35:17.877
> 
> 标签：vb.net, file, move

所以我正在开发一个桌面清洁器，它根据扩展名将项目移动到特定目录（正在清理的目录）

用户定义将放置项目的文件夹的名称。

但是移动文件的代码不能正常工作。

```
Private Sub FlowButton1_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles FlowButton1.Click
    If CheckBox1.Checked Then
        Dim folderPathTextBox = options.TextBox1.Text
        Dim files() As String
        files = System.IO.Directory.GetFiles(options.FolderBrowserDialog1.SelectedPath, "*.txt")

        For Each file As String In files
            System.IO.File.Copy(file, options.TextBox1.Text & options.TextBox8.Text & options.TextBox2.Text & System.IO.Path.GetFileName(file))
        Next

    Else
    End If 
```

*   `options.TextBox1.Text`= 使用文件夹对话框选择的目录 EG：“C:\directory”

*   `options.TextBox8.Text`= 斜线分隔 = "C:\directory\"

*   `options.TextBox2.Text`= 由用户 EG Images 确定的文件夹名称 = "C:\directory\images"

如果不创建它，我还希望代码检查文件夹是否存在。

感谢任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T16:29:27.503

我正在寻找一种将子文件夹的所有图像移动到新文件夹的方法。这是我想出的工作。

```
 Dim WantedExtention As String = ".Your Type"
    Dim sourcePath As String
    Dim destinationPath As String

    'Somewhere else in the code to set the path is by paste not folder selection.
    FolderInfo = New DirectoryInfo(txtSelectedPath.Text)
    SelectedFolder = txtSelectedPath.Text
    Try
        'Check if it exits (Why its not False, Not too sure, but this worked)
        If Directory.Exists(SelectedFolder + "Move Folder") = True Then
            Directory.CreateDirectory(SelectedFolder + "Move Folder")
        End If
        destinationPath = Path.Combine(SelectedFolder + "Move Folder")

        For Each subdir In FolderInfo.GetDirectories()
            'Since I am making the sub folder in the Root Folder I had to Skip the folder
            If (subdir.Name = "Move Folder") Then
                Exit For
            End If
            sourcePath = Path.Combine(SelectedFolder, subdir.Name)

            Dim picList As String() = Directory.GetFiles(sourcePath, "*" + WantedExtention)

            For Each f As String In picList
                Dim fname As String = f.Substring(sourcePath.Length + 1)'Don't know why this is hear yet - but ya need it
                FileCopy(Path.Combine(sourcePath, fname), Path.Combine(destinationPath, fname))
            Next

        Next
        lblCompleted.Text = "COMPLETED"
    Catch ex As Exception
        MessageBox.Show(ex.Message)
    End Try 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T02:50:10.040

遍历文件夹中文件的另一种好方法是使用 DirectoryInfo Dim di 作为 DirectoryInfo

di = My.Computer.FileSystem.GetDirectoryInfo("path to directory") For Each f as FileInfo In di.GetFiles("*.txt") '您对 FileInfo 对象有各种选项，包括复制。下一个

DirectoryInfo 还提供了 Exists 属性来确定您的目录是否真的存在！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T01:24:38.207

一些帮助您组织/简化代码的想法：

1.  `TextBox`正确命名你的。如果您不能这样做，请声明有意义的局部变量并在代码中使用它。它将大大提高可读性。
2.  使用[Path.Combine](http://msdn.microsoft.com/en-us/library/fyy7a5kt.aspx)加入`C:\directory`并`Images`一起。摆脱`TextBox8`.
3.  ~~我认为您也可以安全地删除`System.IO.Path.GetFileName(file)`部分，应该能够只使用目录作为复制目标。~~ `File.Copy`需要一个文件名作为第二个参数。您需要使用`Path.Combine`接受 3 个参数的重载，并结合基本路径 + 用户指定的文件夹 + 文件名。
4.  使用[File.Copy](http://msdn.microsoft.com/en-us/library/c6cfw35a.aspx)时，请确保目标中没有此文件。根据 MSDN `Overwriting a file of the same name is not allowed`，.

# jquery - 适用于每个屏幕分辨率的全屏 Masonry 主题？

> ID：13078868
> 
> 赞同：0
> 
> 时间：2012-10-25T23:35:52.417
> 
> 标签：jquery, screen, fullscreen, jquery-masonry, calculated-columns

基本上我想制作一个 Masonry 主题，它有一定数量的列，例如 5，每列（柱）的宽度将由屏幕尺寸计算。

我不确定如何去做，我已经阅读了 Masonry 文档和诸如此类的内容，但找不到任何有用的东西。如果你能帮上忙，那就太棒了！谢谢！

到目前为止，这是我的砌体编码：

```
<script type="text/javascript">
$(window).load(function () {
var $content = $('#posts');
$content.masonry({itemSelector: '.entry'}),
$content.infinitescroll({
navSelector : 'div#pagination', 
nextSelector : 'div#pagination a#nextPage', 
itemSelector : '.entry',
loading: {
finishedMsg: '',
img: 'http://static.tumblr.com/dbek3sy/pX1lrx8xv/ajax-loader.gif'
},
bufferPx : 600,
debug : false,
},
// call masonry as a callback.
function( newElements ) {
var $newElems = $( newElements );
$newElems.hide();
// ensure that images load before adding to masonry layout
$newElems.imagesLoaded(function(){
$content.masonry( 'appended', $newElems, true, function(){$newElems.fadeIn(300);} );
});
});
});
</script> 
```

# html - Wordpress 通用标题链接不起作用

> ID：13078878
> 
> 赞同：0
> 
> 时间：2012-10-25T23:36:27.970
> 
> 标签：html, wordpress, footer

我正在将 wordpress 用于网站，而我要做的只是链接到一般标题部分中的外部网站。

具体来说，我在“设置/常规页眉”部分创建它，并在页脚框中输入我的 HTML。

我的网站的实际 html 有点复杂，但我添加了一个非常简单的文本链接来演示这个问题。这是代码：

```
<a href="http://www.google.com"> Google </a> 
```

基本上这个链接什么都不做。使用通用标题部分是否有限制？我还能把这段代码放在哪里让它工作？任何帮助都很棒，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T19:38:20.860

所以事实证明，上面的代码中有一些随机的 div，一旦删除，一切都按预期工作！

# php - 来自另一个开发者的消息让我头疼（可能很傻）

> ID：13078879
> 
> 赞同：-1
> 
> 时间：2012-10-25T23:36:30.047
> 
> 标签：php, command-line

这是我与另一位开发人员合作过的一小段内容，我在 PHP 方面非常基础，需要将他的一些代码转移到我的网站中。

这是他发送的信息的一部分：

> 接下来，请编辑 config.php。您需要从命令行提供并执行 loadercsv.php，如下所示：
> 
> ```
>  $ php loadercsv.php 
> ```
> 
> 这将从 zip 文件中提取数据并填充必须存在的数据库。

这到底是什么意思？我确实知道这是一场猜谜游戏，但我很想知道其他人是否可以解释他在说什么？

此外，以下是 config.php 文件中的代码，以防万一：

```
<?php

// Temporary directory where data will be extracted. Must be directory, absolute path, writable.
define('DATA_DIR', '/CourseFinder/tmp');
// Location of zip file, must be readable and absoluate path.
define('ZIP_FILE', '/CourseFinder/assets/zip/ziplocation.zip');

define('DB_HOST', 'localhost');
define('DB_USER', 'removedforreasons');
define('DB_PASSWORD', 'removedforreasons');
define('DB_NAME', 'removedforreasons');    

define('MAX_LINE_WIDTH', 2048);
define('CSV_SEP', ',');
define('RESULTS_PER_PAGE', 10);

/*
 * List of CSV files to be loaded. These files are processed in order listed here.
 * In case some file does not exists, process will break.
 *
 */ 

/* Try to connect */
$connection = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);

/* If cannot connect, simply exit. */
if (mysqli_connect_errno($connection)) {
    $msg = sprintf("Cannot connect to MySQL: %s", mysqli_connect_errno($connection));
    printf("ERROR: config.php - %s\n", $msg);
    exit();
}

/* Function to close the connection */
function close_connection($connection_to_close)
{

    mysqli_close($connection_to_close);
}

/* Register the function at shutdown. */
register_shutdown_function('close_connection', $connection);

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:41:09.277

这似乎很简单：

该程序`loadercsv.php`被编写为打开一个硬编码的 zip 文件，处理其内容，并将数据插入数据库。假定数据库本身已设置并正在运行。

zip 文件的名称和数据库访问凭据存储在单独的文件中`config.php`，该文件可能包含在第一个文件中。也就是说，您无需在命令行上或以任何其他方式提供配置选项，只需*编辑*`config.php`文件以包含所需的数据。

最后，程序只需从命令行运行，使用 command `php loadercsv.php`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T23:41:06.827

您的 PHP 应用程序需要一个已经填充的数据库才能运行。zip 文件包含应用于填充数据库的 csv 格式的初始数据。页面 loadercsv.php 读取 zip 文件，将其解压缩并填充数据库。在那之后，它可能会被丢弃，你就可以做更多有趣的事情了。

# django - 即使答案相等，Django assertEquals() 测试也会失败

> ID：13078885
> 
> 赞同：0
> 
> 时间：2012-10-25T23:37:13.100
> 
> 标签：django, django-testing

我有一个功能：

```
from django.contrib.gis.measure import Distance, D

def RunLengthCalc(mod_ewdim, mod_ewspacing, cols):
    y = D(inch=mod_ewspacing)  # user input
    x = D(inch=mod_ewdim)  # user input
    z = D(inch=3)  # constant
    lrun = ((x * cols) + (y * (cols - 1))) + zrun
    return lrun 
```

和我的测试：

```
def test_run_length_calculation(self):
    l = RunLengthCalc(26.5, 1, 25)
    self.assertEquals(l, D(inch=689.5)) 
```

但是当我运行测试时，我得到了这个非常混乱的错误：

```
AssertionError: Distance(inch=689.5) != Distance(inch=689.5) 
```

我无法弄清楚这里有什么问题。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:55:53.827

距离类平等的实际实现方式似乎有一些有趣的事情：

[https://github.com/django/django/blob/master/django/contrib/gis/measure.py#L87](https://github.com/django/django/blob/master/django/contrib/gis/measure.py#L87)

阅读该代码，看起来你应该工作......但显然它没有。

我怀疑您可以通过比较特定的单位值来解决您的问题，如下所示：

`self.assertEquals(l.inch, D(inch=689.5).inch)`

# html - 使用来自音频标签的源使用 AudioContext

> ID：13078889
> 
> 赞同：6
> 
> 时间：2012-10-25T23:37:37.673
> 
> 标签：html, audio, html5-audio

我正在构建一个音乐播放器，我想根据当前播放的曲目添加一个脉动效果。

这里有一些我想要的例子：

[http://www.htmlfivewow.com/demos/hal/index.html](http://www.htmlfivewow.com/demos/hal/index.html)

[http://www.schillmania.com/projects/soundmanager2/demo/360-player/canvas-visualization.html](http://www.schillmania.com/projects/soundmanager2/demo/360-player/canvas-visualization.html)

我的问题是，在第一个示例中，声音是通过 xhr 加载的，而在第二个示例中，它使用了 flash。

我希望能够从音频标签中获得我想要分析的声音。

恐怕不可能，这会导致很大的安全性缺失，因为我们可以加载网页而不是声音然后分析它。反正有解决办法吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-11-16T12:37:18.677

您可以在 AudioContext中使用**createMediaElementSource方法。**

```
<audio id="audio" src="test.mp3"></audio>
<script type="text/javascript">
    var context = new webkitAudioContext;
    var el = document.getElementById('audio');
    var source = context.createMediaElementSource(el);
    source.connect(context.destination);
    el.play();
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T11:27:10.677

看起来这是通过 Web Audio API 进行的一种实现：

[https://github.com/richtaur/audia/blob/master/audia.js](https://github.com/richtaur/audia/blob/master/audia.js)

和背景：

[http://www.lostdecadegames.com/audia-is-a-library-for-simplifying-the-web-audio-api/](http://www.lostdecadegames.com/audia-is-a-library-for-simplifying-the-web-audio-api/)

# python - 在 webapp2 中，如何获取所有路由 URI 的列表？

> ID：13078892
> 
> 赞同：3
> 
> 时间：2012-10-25T23:38:27.957
> 
> 标签：python, google-app-engine, webapp2

我有一个典型的 WSGI 应用程序，如下所示：

```
app = webapp2.WSGIApplication([
    ('/site/path/one',     'package.module.ClassOne'),
    ('/site/path/two',     'package.module.ClassTwo'),
    ('/site/path/three',   'package.module.ClassThree'),
]) 
```

我希望稍后能够在我的应用程序中检索路由列表，例如在 ClassOne 中：

```
class ClassOne(webapp2.RequestHandler):
    def get(self):
        print ''' list of routes (e.g. '/site/path/one', '/site/path/two', etc.) ''' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T23:48:01.497

看起来 WSGIApplication 有一个[路由器](http://webapp2.readthedocs.io/en/latest/api/webapp2.html#webapp2.WSGIApplication)属性

[路由器](http://webapp2.readthedocs.io/en/latest/api/webapp2.html#webapp2.Router)有

```
def __repr__(self):
        routes = self.match_routes + [v for k, v in \
            self.build_routes.iteritems() if v not in self.match_routes]

        return '<Router(%r)>' % routes 
```

您的 wsgiApplication 实例是您的属性`webapp2.RequestHandler`

所以我认为`request.app.router`

所以希望有一个更直接的方式，但如果不是上面应该工作？

[Webapp2 在http://webapp2.readthedocs.io/en/latest/](http://webapp2.readthedocs.io/en/latest/)上提供了非常棒的可搜索源代码

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-12T18:57:34.807

我刚刚编写了这个函数来提取有关 webapp2 应用程序路由器中所有 URI 路由的有用信息，甚至包括使用 webapp2_extras.routes.PathPrefixRoute 创建的嵌套路由：

```
def get_route_list(router):
  """
  Get a nested list of all the routes in the app's router
  """
  def get_routes(r):
    """get list of routes from either a router object or a PathPrefixRoute object,
    because they were too stupid to give them the same interface.
    """
    if hasattr(r, 'match_routes'):
      return r.match_routes
    else:
      return list(r.get_routes())

  def get_doc(handler, method):
    """get the doc from the method if there is one,
    otherwise get the doc from the handler class."""
    if method:
      return getattr(handler,method).__doc__
    else:
      return handler.__doc__

  routes=[]
  for i in get_routes(router):
    if hasattr(i, 'handler'):
      # I think this means it's a route, not a path prefix
      cur_template = i.template
      cur_handler  = i.handler
      cur_method   = i.handler_method
      cur_doc      = get_doc(cur_handler,cur_method)
      r={'template':cur_template, 'handler':cur_handler, 'method':cur_method, 'doc':cur_doc}
    else:
      r=get_route_list(i)
    routes.append(r)
  return routes 
```

这将返回一个嵌套的列表列表，但如果您只想要一个平面列表（就像我实际上所做的那样），您可以使用此处的函数将其展平：[Flattening a shallow list in python](https://stackoverflow.com/a/406822/580592) 注意：您可能需要编辑该展平浅列表函数也避免迭代字典。即，在此处添加：“...而不是 isinstance(el, basestring) 而不是 isinstance(el, dict)”

这从查看代码中应该是显而易见的，但是我编写这个的方式，对于每条路由，它都会为您提供来自自定义方法的文档字符串（如果有的话）；否则，它会为您提供处理程序类的文档字符串。这个想法是这应该对 OP 的目的有用，这也是我想做的。

# c++ - 嵌套匿名命名空间

> ID：13078893
> 
> 赞同：5
> 
> 时间：2012-10-25T23:38:38.987
> 
> 标签：c++, language-lawyer

在 C++ 中，以下列方式声明嵌套的匿名命名空间是合法的：

```
namespace {
    namespace {
        struct Foo
        {
        };
    }
}

namespace {    
    struct Foo // SAME IDENTIFIER AS <unnamed>::<unnamed>::Foo!!!
    {
    };
} 
```

但是，如何使用显式类型的 Foo 声明标识符以避免歧义？

已编辑——适用于所有未阅读该问题的人。

ps 我无意使用这种结构，但我需要了解是否可以消除 Foo 的歧义，以防有人发现它的合法用途。我的编译器扩展需要处理所有情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T23:59:23.660

C++ 标准在 7.3.1.1p1 中非常清楚地说明了这一点：

> 未命名的命名空间定义的行为就像它被替换为

```
inline(opt) namespace unique { /* empty body */ }
using namespace unique ;
namespace unique { namespace-body } 
```

> 其中 inline 出现当且仅当它出现在 unnamed-namespace-definition 中时，翻译单元中所有出现的 unique 都被相同的标识符替换，并且该标识符不同于整个程序中的所有其他标识符。

因此，从上面，我们知道您的代码实际上转换为以下内容：

```
namespace unique1 {}
using namespace unique1;
namespace unique1 {
    namespace unique2 {}
    using namespace unique2;
    namespace unique2 {

        struct Foo
        {
        };

    }
}

namespace unique3 {}
using namespace unique3;
namespace unique3 {

    struct Foo
    {
    };

} 
```

~~因此，由于. `Foo`_ **_** _ `namespace unique1``Foo``using namespace unique3;`~~我错了。通过下面的评论更正。

然后从 7.3.4p4：

> 对于非限定查找 (3.4.1)，using-directive 是可传递的：如果一个作用域包含一个 using-directive，该指令指定第二个命名空间，该命名空间本身包含 using-directives，效果就像来自第二个命名空间的 using-directives出现在第一。

因此，当您提到 时`Foo`，它可能意味着要么 要么`unique1::unique2::Foo`，`unique3::Foo`这是一个**错误**。**请注意，**另一个答案说：`has hidden unique name that cannot be accessed`。这是**不正确**的，由于使用指令可以访问它们，只是两个名称都是可见的。

**但是**，通过将范围解析运算符添加`::`到`Foo`您**可以**访问`unique3::Foo`，原因如下：

从 3.4.3.2p2 开始：

> 对于命名空间 X 和名称 m，命名空间限定查找集 S(X,m) 定义如下：令 S0(X,m) 是 X 中所有 m 声明的集合和 X 的内联命名空间集 ( 7.3.1)。如果 S0(X,m) 不为空，则 S(X,m) 为 S0(X,m)；**否则，S(X,m) 是 S(Ni,m) 的并集，用于通过 X 中的 using 指令指定的所有命名空间 Ni 及其内联命名空间集**。

强调的部分说`using-directives in X`，在您的情况下表示`using namespace unique1;`and `using namespace unique3;`，因此命名空间限定的查找集如下所示：`S(unique3::Foo)`，这意味着`unique1::unique2::Foo` **不**包含在集合中，因此不是错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T23:40:06.517

是的，这是完全合法的，因为它与任何东西都不矛盾。

未命名的命名空间在概念上等同于：

```
namespace <09FD8E6E-2DB6-4517-B62D-3B5A657DCC82>
{
  // ....
} 
```

这意味着每个未命名的命名空间都隐藏着无法访问的唯一名称。

# javascript - 这是 nerf console.log 的好方法吗？

> ID：13078894
> 
> 赞同：0
> 
> 时间：2012-10-25T23:38:44.073
> 
> 标签：javascript

在浏览了一些 nerfing console.log 的不同方法之后，我想要一些更短的东西......我使用的是 html5 样板，但对于 console.log 来说有点过分了。

你看到我在使用它时可能遇到的任何问题吗？它似乎在最新的 Chrome/FF 和 IE 7 & FF 3.6 中运行良好。

```
 if (!window.console) {window.console = {}}
 if (!window.console.log) {window.console.log = function () {}} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T23:40:53.910

是的，没关系。甚至更短：

```
if (!window.console) window.console = { log: function() { } }; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T23:41:52.070

```
window.console = window.console || {log : function(){}} 
```

# macos - 在 Mac 上为 IntelliJ 设置 JDK 7

> ID：13078898
> 
> 赞同：43
> 
> 时间：2012-10-25T23:39:23.177
> 
> 标签：macos, intellij-idea, java

我通过从 Oracle 网站下载 dmg 安装了 JDK：[http ://www.oracle.com/technetwork/java/javase/downloads/jdk7u9-downloads-1859576.html](http://www.oracle.com/technetwork/java/javase/downloads/jdk7u9-downloads-1859576.html)

安装后，我尝试在 IntelliJ 中设置 JDK，但是当我在 Project Structure-> SDKs 屏幕中将位置设置为 JDK 时，只加载了几个库，并且很多（包括 Content/Classes/ 中的所有库）都丢失了。

如何添加所有必要的库？

JDK 的安装位置是**/Library/Java/JavaVirtualMachines/jdk1.7.0_07.jdk/Contents/Home**

我试过查看**/System/Library/Frameworks/JavaVM.framework/Versions/**无济于事。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-03-27T19:01:36.207

导航到项目结构 -> 平台设置/SDK。

点击“+”号并添加 /Library/Java/JavaVirtualMachines/jdk1.7.0_17.jdk/Contents/Home

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-10-26T00:01:43.227

下`Project Structure -> Platform Settings -> SDKs`。

通过使用“+”号，您应该添加一个有效的 JDK，它会注意并添加适当的库，例如。`/Library/Java/JavaVirtualMachines/jdk-XYZ.jdk/Contents/Home`

## [![项目结构 -> 平台设置 -> SDK](../Images/6f17f3c867d56e0f0b3295b0e2b87442.png)](https://i.stack.imgur.com/TVfPK.png)

对于较旧的 jdk 映像，例如 1.6 或更早版本，您需要确保`/Library/Java/JavaVirtualMachines/jdkXYZ_VERSION.jdk/Contents/Home/jre/lib`目录中的所有 jar（charsets.jar、jce.jar、JObjC.jar、jsse.jar、management-agent.jar、resources.jar 和 rt。 jar) 是您设置的一部分。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-25T23:55:49.977

对我来说，我必须选择 Project Structure->Platform Setting->Global Libraries，然后单击 Project Structure 窗口中间窗格顶部的“+”图标。这将打开一个“新全局库”下拉菜单。从那里我能够找到我想要包含的库。

# bash - bash 脚本 - 目录上的迭代合并文件

> ID：13078900
> 
> 赞同：0
> 
> 时间：2012-10-25T23:39:30.983
> 
> 标签：bash, merge, cygwin

您好，我想迭代合并 input_directory 中的文件并将合并后的文件放入 output_directory。

假设在 input_directory 我有：file1.txt，file2.txt，file3.txt

我希望输出目录包含以下文件：

*   merge1.txt ：与 file1.txt 相同
*   merge2.txt : 合并 file1.txt file2.txt
*   merge3.txt : 合并 file1.txt file2.txt file3.txt

我几乎没有使用 bash 脚本的经验，很明显可以在 for 循环中使用迭代器来完成，但我不知道如何操作。

先感谢您..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T16:44:55.993

存储附加到输出的先前文件名并在下一次迭代中使用它：

```
#!/bin/bash

touch prev #a temp variable to hold previous filename
i=1;

for file in $(ls /INPUT/file*); 
do 
   cat /OUTPUT/$prev /INPUT/$file > /OUTPUT/merge$i;
   prev=merge$i;
   let i=i+1
 done 
```

此代码利用事实`ls`列出具有相同前缀的文件。如果您的文件名具有不同的前缀，并且您想要输出它们的特定顺序，您可以修改它。

# delegates - Cocos2D 2.1：iOS 6 中不推荐使用“Delegate”。如何设置此 AVAudioSession 的委托？

> ID：13078901
> 
> 赞同：13
> 
> 时间：2012-10-25T23:39:37.250
> 
> 标签：delegates, cocos2d-iphone, avaudiosession

在 Xcode 4.5 中启动了 Cocos2D 2.1 模板（没有物理引擎），针对 iOS 6 和 iPad。在 CDAudioManager.m 文件中，以下代码...

```
AVAudioSession* session = [AVAudioSession sharedInstance];
session.delegate = self;  // Which is what is automatically generated by the template. 
```

...生成以下警告...

```
"delegate deprecated:  first deprecated in iOS 6" 
```

所以我去苹果开发者文档，它在“委托”下说，“在iOS 6.0中不推荐使用。改用这个类的通知部分中描述的通知。”

[http://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVAudioSession_ClassReference/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/occ/instp/AVAudioSession/delegate](http://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVAudioSession_ClassReference/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/occ/instp/AVAudioSession/delegate)

问题是，在我看来，我们正在尝试做的所有事情——请原谅我的经验不足——将 AVAudioSession 的委托设置为 CDAudioManager 实例本身。通知是如何做到这一点的？或者我对上述代码的目标是错误的？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-09T21:30:17.337

您遇到的错误在此代码块中

```
AVAudioSession* session = [AVAudioSession sharedInstance];
session.delegate = self;// <-------- DEPRECATED IN IOS 6.0 
```

要使警告静音，请将这两行更改为：

```
[[AVAudioSession sharedInstance] setActive:YES error:nil]; 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-10-04T09:51:39.523

**而不是使用委托使用通知进行如下处理**

```
[AVAudioSession sharedInstance];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(interruption:) name:AVAudioSessionInterruptionNotification object:nil];

 - (void) interruption:(NSNotification*)notification
   {
    NSDictionary *interuptionDict = notification.userInfo;

    NSUInteger interuptionType = (NSUInteger)[interuptionDict valueForKey:AVAudioSessionInterruptionTypeKey];

   if (interuptionType == AVAudioSessionInterruptionTypeBegan)
        [self beginInterruption];

    else if (interuptionType == AVAudioSessionInterruptionTypeEnded)
        [self endInterruption];
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-10-26T18:21:57.867

我在 Cocos2D-iPhone.org 论坛上找到了一篇关于此的帖子。虽然我并不完全理解它——但我正在努力解决它——它似乎确实解决了这个问题，至少是暂时的。他所做的就是在 CDAudioManger.m 文件中编写这个方法：

```
-(void) releaseBufferForFile:(NSString *) filePath {
    int bufferId = [self bufferForFile:filePath create:NO];
    if (bufferId != kCDNoBuffer) {
        [soundEngine unloadBuffer:bufferId];
        [loadedBuffers removeObjectForKey:filePath];
        NSNumber *freedBufferId = [[NSNumber alloc] initWithInt:bufferId];
        [freedBufferId autorelease];
        [freedBuffers addObject:freedBufferId];
    }
}
@end

- (void) interruption:(NSNotification*)notification
{
    NSDictionary *interuptionDict = notification.userInfo;
            NSNumber* interuptionTypeValue = [dict valueForKey:AVAudioSessionInterruptionTypeKey];
    NSUInteger interuptionType = [interuptionTypeValue intValue];

    if (interuptionType == AVAudioSessionInterruptionTypeBegan)
        [self beginInterruption];
#if __CC_PLATFORM_IOS >= 40000
    else if (interuptionType == AVAudioSessionInterruptionTypeEnded)
        [self endInterruptionWithFlags:(NSUInteger)[interuptionDict valueForKey:AVAudioSessionInterruptionOptionKey]];
#else
    else if (interuptionType == AVAudioSessionInterruptionTypeEnded)
        [self endInterruption];
#endif
} 
```

然后他换了：

```
AVAudioSession *session = [AVAudioSession sharedInstance];
session.delegate = self; 
```

有了这个：

```
[AVAudioSession sharedInstance];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(interruption:) name:AVAudioSessionInterruptionNotification object:nil]; 
```

这是链接： http: [//www.cocos2d-iphone.org/forum/topic/49956](http://www.cocos2d-iphone.org/forum/topic/49956)

如果我对这段代码的作用有了更好的理解，我一定会编辑这篇文章。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-01T01:39:56.510

我没有对此进行测试，但根据这篇文章： http: [//www.cocos2d-iphone.org/forums/topic/cdaudiomanager-line-402-delegate-is-deprecated/#post-390211](http://www.cocos2d-iphone.org/forums/topic/cdaudiomanager-line-402-delegate-is-deprecated/#post-390211)

```
float osVersion = [[UIDevice currentDevice].systemVersion floatValue];
if (osVersion >=6.0)
{
[AVAudioSession sharedInstance];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(interruption:) name:AVAudioSessionInterruptionNotification object:nil];
}
else
{
AVAudioSession* session = [AVAudioSession sharedInstance];
session.delegate = self;
} 
```

即根据 iOS 版本抛出不同的代码运行时。

现在，我的应用程序只是 iOS 6.0+，所以我会选择：

```
[AVAudioSession sharedInstance];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(interruption:) name:AVAudioSessionInterruptionNotification object:nil]; 
```

并交叉我的拇指。

# objective-c - 多次类型转换与使用单个指针

> ID：13078902
> 
> 赞同：0
> 
> 时间：2012-10-25T23:39:41.623
> 
> 标签：objective-c, ios, xcode

从性能的角度来看，我怀疑哪个更好。

我有一个 aViewController 类型的变量，它包含一个 bViewController 对象。所以每次我需要在 bViewController 上调用一个方法时，我都会像 (bViewController *)aViewController.MethodName 一样调用它

我在想如果将 bViewController 存储在它自己类型的变量中并使用它进行类型转换会更好。

与类型转换相关的开销是多少？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T04:42:59.317

您似乎没有遵循标准命名约定，因此评论中出现了明显的混淆。这是我对你在做什么的猜测：

你说你有：

```
UIViewController *aViewController; 
```

没有错 - 变量名以小写字母开头。然后你说你这样做：

```
aViewController = [[bViewController alloc] init]; 
```

这里`bViewController`大概是一个*类*，因此按照惯例应该以大写字母开头。你也没有说这个类是如何定义的，但大概它是一个子类（纠正这种情况）：

```
@interface BViewController : UIViewController 
```

现在，在上面的分配之后，您希望调用定义的方法`BViewController`，因此编写：

((BViewController *)aViewController).propertyDefinedInBViewController

首先调用*方法*不是（通常）使用点语法完成的，即对于*properties*。其次，您需要额外的括号，否则您将转换属性调用的结果而不是`aViewController`.

这符合你正在做的事情吗？

如果是这样，你的问题是 - 类型转换的成本是多少？

从一种指针类型到另一种类型的类型转换没有任何成本，而值类型（整数、实数等）之间的类型转换可能涉及运行时转换并带来成本。您的情况是前者，因此运行时成本为零。但是，如果您要进行大量引用，我建议您使用正确类型的中间变量并只转换一次，这往往会提高可读性（开发时间成本）。此外，除非您检查过您是否确实拥有该类的实例，否则您不应强制转换为子类，例如：

```
if ([aViewController isKindOfClass:[BViewController class]])
{
   BViewController *myBViewController = (BViewController *)aViewController;
   ...
} 
```

*或者*你的代码保证你有一个子类的实例，这是显而易见的或注释的。

HTH，我并没有完全猜错你在做什么！

# android - android WebView和字体大小

> ID：13078903
> 
> 赞同：0
> 
> 时间：2012-10-25T23:39:53.247
> 
> 标签：android, webview

我需要“富文本格式”，所以我使用 webview 作为自定义单行文本编辑。

我想在所有分辨率和密度下将字体大小设置为 webview 高度的 90%。

可能吗？如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:43:56.777

WebView 只显示网页（更准确地说是 HTML），因此您的所有文本格式都必须在 HTML/CSS 中完成。

您可能想尝试[TextView](http://developer.android.com/reference/android/widget/TextView.html)并查看使用[Html.fromHtml()](http://developer.android.com/reference/android/text/Html.html#fromHtml%28java.lang.String%29)来设置文本样式。然后您可以使用 TextView 的大小调整功能。

# windows-phone-7 - 我如何检测到触摸点的数量已变为 0？

> ID：13078908
> 
> 赞同：0
> 
> 时间：2012-10-25T23:40:29.640
> 
> 标签：windows-phone-7, windows-phone-7.1, windows-phone

我正在使用以下代码来检测触摸点。但是，当用户的手指完全离开屏幕时，我的处理程序永远不会被调用。

问题 - 我如何检测到触摸点的数量已变为 0？

```
 public MainPage()
    {
        InitializeComponent();

        Touch.FrameReported += new TouchFrameEventHandler(OnFrameReported);
    }

    private void OnFrameReported(object sender, TouchFrameEventArgs e)
    {
        var args = e.GetTouchPoints(null); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T01:50:05.917

我找到的最佳答案是听 ManipulationComplete 以获取用户正在抬起最后一根手指的通知。但是，在那之后你仍然会得到一些拖尾的触摸帧。所以我们需要忽略它们......我只是忽略了它们的下一秒，但这可能是矫枉过正。

```
 public MainPage()
    {
        ...

        ManipulationCompleted += OnManipulationCompleted;

        ...
    }

    private void OnManipulationCompleted(object sender, ManipulationCompletedEventArgs e)
    {
        OnFrameReported(this, null);

        m_whenStopIgnoringTouchEvents = Environment.TickCount + 1000;
    }

    private void OnFrameReported(object sender, TouchFrameEventArgs e)
    {
        if (e != null)
        {
            if(Environment.TickCount > m_whenStopIgnoringTouchEvents)
            {
                // null indicates the touch point information is relative to the 
                // top left corner
                var args = e.GetTouchPoints(null);
                ...
            }
        }
    }

    private int m_whenStopIgnoringTouchEvents = 0; 
```

# permissions - 有没有办法让人们对 github wiki 有写访问权限，而不给他们查看代码的权限

> ID：13078914
> 
> 赞同：6
> 
> 时间：2012-10-25T23:41:09.580
> 
> 标签：permissions, github, wiki, repository

我想为 github 上的私有 repo 授予对 wiki 的读写访问权限，在同一个 repo 上，我不希望这些团队成员能够看到实际的 repo（包含代码而不是 wiki 本身的 repo ）， 有没有办法做到这一点？

为了更清楚，我想发布我的 API 文档，它只是团队内部的，它使用 API 但对他们隐藏实际的 api 代码（听起来很邪恶，但还不错，你需要知道整个故事，请不要评判我）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T06:34:07.150

一种解决方法是使用公共存储库的 wiki，并将该公共存储库声明为私有存储库的**[子模块。](http://git-scm.com/book/en/Git-Tools-Submodules)**

wiki repo 是一个子模块这一事实意味着父 repo（带有代码的私有 repo）确实记录了与之同步的 wiki repo 的确切版本（SHA1）：每个版本的私有 repo 都知道哪个版本的它也引用了wiki。

# c# - 如何确定本地时间是否针对夏令时进行了调整？

> ID：13078922
> 
> 赞同：4
> 
> 时间：2012-10-25T23:42:08.160
> 
> 标签：c#, date, time, dst

是否可以知道当地时间是否调整了夏令时？

是否可以知道机器上的当地时间是否正确？

我想很奇怪的愚蠢问题（假设没有互联网连接），但你永远不知道！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T23:44:55.767

您可以使用来查看当前时间是否正在调整。[`TimeZoneInfo.Local.IsDaylightSavingsTime`](http://msdn.microsoft.com/en-us/library/bb460642.aspx)`(DateTime.Now)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T23:45:54.730

我发现大多数 DST 实现在计算时间时会从 GMT 偏移量增加/减少一个小时，例如，澳大利亚悉尼将是 +10 GMT 没有 DST 和 +11 GMT 与 DST

# c - 有没有办法在 C 中计算令牌？

> ID：13078926
> 
> 赞同：13
> 
> 时间：2012-10-25T23:42:56.370
> 
> 标签：c, token, delimiter, strtok

我`strtok`用来将字符串拆分为标记。有谁知道任何实际计算令牌数量的函数？

我有一个命令字符串，我需要拆分它并将参数传递给`execve()`.

谢谢！

**编辑**

`execve`将参数作为`char**`，所以我需要分配一个指针数组。在不知道有多少令牌的情况下，我不知道要分配多少。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-25T23:54:25.610

一种方法是简单地使用`strtok`计数器。但是，这将修改原始字符串。

另一种方法是`strchr`在循环中使用，如下所示：

```
int count = 0;
char *ptr = s;
while((ptr = strchr(ptr, ' ')) != NULL) {
    count++;
    ptr++;
} 
```

如果您有多个分隔符，请使用`strpbrk`：

```
while((ptr = strpbrk(ptr, " \t")) != NULL) ... 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-15T14:39:46.640

因为令牌的数量只不过是使用的分隔符的出现频率多一个。所以你的问题归结为没有。字符串中字符出现的次数

说c中strtok函数中使用的分隔符是''

```
int count =0,i;
char str[20] = "some string here";

for(i=0;i<strlen(str);i++){
    if(str[i] == ' ')
        count++;
} 
```

令牌数将与 count+1 相同

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-30T10:10:30.250

这是一个基于`strtok`它的版本，它不修改原始字符串，而是它的临时副本。此版本适用于用作标记分隔符的制表符和空格字符的任意组合。功能是

```
unsigned long int getNofTokens(const char* string){
  char* stringCopy;
  unsigned long int stringLength;
  unsigned long int count = 0;

  stringLength = (unsigned)strlen(string);
  stringCopy = malloc((stringLength+1)*sizeof(char));
  strcpy(stringCopy,string);

  if( strtok(stringCopy, " \t") != NULL){
    count++;
    while( strtok(NULL," \t") != NULL )
        count++;
  }

  free(stringCopy);
  return count;
} 
```

函数调用可能是

```
char stringExample[]=" wordA 25.4 \t 5.6e-3\t\twordB 4.5e005\t ";
printf("number of elements in stringExample is %lu",getNofTokens(stringExample)); 
```

输出是

```
number of elements in stringExample is 5 
```

# c# - 如何在 C# .NET 中显示图表

> ID：13078929
> 
> 赞同：0
> 
> 时间：2012-10-25T23:43:25.563
> 
> 标签：c#, winforms, diagram, windows-forms-designer

我试图在 C# .NET Windows 窗体应用程序中显示这样的图表。我有一个包含 2D 数据的文件，一切都很好。我只需要一个 API 来为用户显示图形图表。

[我的示例图图片 http://upload.tehran98.com/images/qzluxti62q0xmjyizaet.jpg](http://upload.tehran98.com/images/qzluxti62q0xmjyizaet.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:59:34.007

您是否尝试过[用于 Winforms 的 MS 图表控件](http://msdn.microsoft.com/pt-br/library/system.windows.forms.datavisualization.charting.chart.aspx)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T23:52:12.397

好吧，总会有[Telerik。](http://www.telerik.com/products/winforms/chartview.aspx)但它不是免费的。Microsoft .NET的[Microsoft Chart Contorls](http://archive.msdn.microsoft.com/mschart)可能是一些东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T23:48:07.097

[DynamicDataDisplay](http://dynamicdatadisplay.codeplex.com/)很好，但针对 wpf。可以在 winforms中使用[wpf，](http://www.switchonthecode.com/tutorials/wpf-tutorial-using-wpf-in-winforms)但我从未这样做过。

# python - 加入 IRC 频道似乎不起作用

> ID：13078931
> 
> 赞同：0
> 
> 时间：2012-10-25T23:43:43.430
> 
> 标签：python, irc

我有一个工作机器人（感谢 abarnert），它有一个错误：它不会加入频道。他可以让它工作，但我不能。我意识到这可能是我这边的一个问题，但我在 X-Chat 上连接得很好。

```
host = "irc.kbfail.net"
port = 6667
nick = "Alice"
ident = "Alice"
realname = "Alice"
channel = "#nb"
readbuffer = ""

irc = socket.socket ( socket.AF_INET, socket.SOCK_STREAM )
irc.connect ( ( host, port ) )
print irc.recv ( 4096 )
irc.send ("NICK %s\r\n" % nick)
irc.send ("USER %s %s bla :%s\r\n" % (ident, host, realname))
irc.send ("JOIN %s\r\n" % channel) 
```

这完全取决于 JOIN 命令。我的机器人已连接到服务器并停在 ":Alice MODE Alice :+x"

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T23:51:00.603

正如我在[其他问题](https://stackoverflow.com/questions/13059547/irc-reading-sockets/13059863#comment17768652_13059863)中解释的那样，您确实需要记录输入和输出以查看发生了什么。这是您（或其他任何人）能够调试它的唯一方法。

同样，有多种方法可以做到这一点：破解你的机器人源以打印它在套接字上接收和发送的所有内容，使用 netcat 运行假服务器，将 netcat 设置为代理，运行设置为记录所有内容的本地 IRC 服务器, 使用 Wireshark 来捕获线路上的消息……你选择哪一个并不重要，但你需要做其中之一。

通过在我自己的本地副本上执行此操作，我可以看到您发送 JOIN 太早，并且您从服务器收到错误消息：

```
:asgard.kbfail.net 451 JOIN :You have not registered 
```

同时，您的机器人停在 MODE 行的原因是在那之后没有人向您发送任何内容。启动客户端，`/MSG Alice foo`您会发现您仍然可以正常接收消息。

那么，什么时候发送 JOIN 合适呢？我的猜测是您需要等到 /MOTD 之后，或者可能在自动 MODE 命令之后，或者在它确认您的 NICK 命令之后。但实际上，你不应该在这里猜测。[IRC 协议有很好的文档记录](http://www.irchelp.org/irchelp/rfc/rfc.html)，并不复杂。

最重要的是，除非您将其作为如何编写基于套接字的客户端应用程序的学习练习，否则您会浪费大量时间；有几十个开源 Python IRC 机器人和模块可以帮助编写 IRC 机器人，因此您不必自己处理所有这些低级的东西，因为快速的 Google 搜索会告诉您。

# jquery - jquery.find 在 ie 8 中不返回数据

> ID：13078934
> 
> 赞同：0
> 
> 时间：2012-10-25T23:44:00.250
> 
> 标签：jquery, internet-explorer-8

```
<H1 class=extraBottomMargin>Tell us the name of your employers</H1>
        <UIWIDGET>
            <FIELDSET>
                <DIV>
                    <INPUT id=viewEnterEmployerNames_q1 tabIndex=1 maxLength=75 placeholder="Employer">
                </DIV>
            </FIELDSET>
        </UIWIDGET>
        <DIV class="rightRail watermark"><IMG src="app/img/RR_Watermark.png"></div> 
```

我运行一个命令`jQuery("above html").find("UIWIDGET").html()`

这适用于除 IE 8 以外的所有浏览器。请指教。

请注意，uiwidget 是我的自定义标签，因此请忽略建议对此进行任何改进的部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:51:09.043

没有命名的 HTML 标记`UIWIDGET`- 在较旧的 IE 版本中，如果不先创建它们，访问非标准标记将无法工作。

您可以通过调用轻松地做到这一点`document.createElement('UIWIDGET')`- 这就是 html5shiv 等库为 HTML5 元素所做的事情。

如果您打算使用一些 HTML5 标签，您可以添加[html5shiv](https://github.com/aFarkas/html5shiv/blob/master/dist/html5shiv.js)并在包含 html5shiv 脚本之前运行以下代码：`html5.options.elements += ' uiwidget';`

但是，如果您根本不使用无效的 HTML 标签会**更好！**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T00:25:57.697

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns:custom="http://www.test.com">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript"></script>
<body>
<H1 class=extraBottomMargin>Tell us the name of your employers</H1>
        <custom:uiwidget>
            <FIELDSET>
                <DIV>
                    <INPUT id=viewEnterEmployerNames_q1 tabIndex=1 maxLength=75 placeholder="Employer">
                </DIV>
            </FIELDSET>
        </custom:uiwidget>
        <DIV class="rightRail watermark"><IMG src="app/img/RR_Watermark.png"></div>
</body>

<script>    
$(function() {
   alert($("uiwidget").html());
});
</script> 
```

这将在 IE 中工作，但`WON'T`在其他浏览器中工作！！！这是 IE 定义和支持自定义标签的官方方式。这反映在`.getElementsByTagName()`方法上，所以我看不到像`<mytag>`在 IE 中那样搜索自定义标签的方法，无论您使用 jQuery 或其他库还是直接调用`.getElementsByTagName()`. 搜索 Google，您可以找到许多关于此问题的官方和非官方文章。

# c++ - 在 C++11 中使用异步的分段 错误（核心转储）

> ID：13078942
> 
> 赞同：4
> 
> 时间：2012-10-25T23:45:16.990
> 
> 标签：c++, multithreading, asynchronous, c++11

我创建了一个函数来将现有的树对象转换为字符串。字符串的格式是

```
parent ( child1 ) ( child2 ( childOfChild2 ) ) 
```

程序正确输出字符串，做一些其他的工作，但在和崩溃

```
Segmentation fault (core dumped) 
```

这是函数（`getTree(this->root)`输出整棵树）：

```
template <typename T>
string Tree<T>::getTree(const Node<T>& node) {
    if (node.isLeaf()){
        return to_string(node.value);
    }

    vector<future<string>> results; //each element represents a subtree connected to "node"
    for (auto child:node.children){
        results.push_back(move(async(&Tree<T>::getTree,this,ref(*child))));
    }

    string children("");
    for (auto& result:results){
        children+=string(" (") + result.get()+ string(") ");     //this creates Segmentation fault, but the output is correct
        //children+=string("");                                  //this does not create Segmentation fault
        //children+=string("foo");                               //this creates Segmentation fault
    }

    return to_string(node.value)+children;
} 
```

关于变量的一些信息：

```
vector<shared_ptr<Node>> children; 
```

请告诉您是否需要更多信息。完整的源代码是[tree.cpp](https://dl.dropbox.com/u/107383231/tree.cpp)和[tree.h](https://dl.dropbox.com/u/107383231/tree.h)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T08:41:31.190

您在迭代器中的比较功能不起作用 - 您还需要涵盖两个容器均为空的情况，即

```
bool operator!= (const Iter& other) const {
    if (this->queueToIter.empty()&& other.queueToIter.empty()) return false;
    if (this->queueToIter.empty()&&! other.queueToIter.empty()) return true;
    if (!this->queueToIter.empty()&& other.queueToIter.empty()) return true;
    return (this->queueToIter.front())!=(other.queueToIter.front());
}; 
```

# xcode - 无法在 Interface Builder 中正确调整 MKMapView 的大小

> ID：13078943
> 
> 赞同：1
> 
> 时间：2012-10-25T23:45:31.097
> 
> 标签：xcode, mkmapview, xib

我尝试通过界面生成器（xcode 4.5）插入和调整 MKMapView 的大小。但是，模拟器显示的大小/位置与我们在 IB 中看到的不同。任何提示哪里可能出错？

谢谢。

[http://i463.photobucket.com/albums/qq355/popov_kai/Untitled3.png](http://i463.photobucket.com/albums/qq355/popov_kai/Untitled3.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T00:36:14.137

我会说您的文本字段被导航栏向下推，但地图不是。因此，在 Interface Builder 中找到设置以在您的 UI 中模拟导航栏，然后根据该设置定位您的地图。

# java - 如何提示用户输入 0 到 100 之间的数字？

> ID：13078951
> 
> 赞同：4
> 
> 时间：2012-10-25T23:47:27.313
> 
> 标签：java, int

尝试以 0 到 100 之间的 int 形式获取用户输入，并提示用户“再试一次”，只要他们的输入不符合此条件。

到目前为止，我的代码在实现我的目标方面有些成功：

```
import java.util.Scanner;

public class FinalTestGrade
{
    public static void main(String[] args)
    {
        Scanner studentInput = new Scanner (System.in );
        int testGrade;

        System.out.println("Please enter your test grade (0 to 100)");
        while (!studentInput.hasNextInt()) 
            {
            System.out.println("Your input does not match the criteria, please enter a number between 0 and 100");
            studentInput.next();
            }
        testGrade = studentInput.nextInt();

        while (testGrade > 100 || testGrade < 0) 
            {
            System.out.println("Your input does not match the criteria, please enter a number between 0 and 100");
            testGrade = studentInput.nextInt();
            } 
```

如您所见，程序将检查输入是否为 int。一旦用户成功输入一个 int，程序就会检查以确保他们的输入在 0 到 100 之间。当用户输入一个非 int 以响应第二个提示（由第二个 while 循环启动）时，就会出现问题。下面是一个例子：

```
run:
Please enter your test grade (0 to 100)
P
Your input does not match the criteria, please enter a number between 0 and 100
109
Your input does not match the criteria, please enter a number between 0 and 100
P
    Exception in thread "main" java.util.InputMismatchException
            at java.util.Scanner.throwFor(Scanner.java:840)
            at java.util.Scanner.next(Scanner.java:1461)
            at java.util.Scanner.nextInt(Scanner.java:2091)
            at java.util.Scanner.nextInt(Scanner.java:2050)
            at finaltestgrade.FinalTestGrade.main(FinalTestGrade.java:24)
Java Result: 1
BUILD SUCCESSFUL (total time: 9 seconds) 
```

长话短说，我想知道是否有一种方法可以组合我的 while 循环，以便接受表示为 0 到 100 之间的 int 的输入并将其保存为变量。所有不符合此标准的输入都应触发一个提示，该提示会重复直到输入符合此标准。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:51:52.463

```
int testGrade = -1 ;
Scanner studentInput = new Scanner(System.in);
while (testGrade > 100 || testGrade < 0) 
{
   System.out.println("Your input does not match the criteria, please enter a number between 0 and 100");

   while(!studentInput.hasNextInt())
   {
       studentInput.next() ;
   }
   testGrade = studentInput.nextInt();
} 
```

有一个无限循环来检查流中是否有无效字符。如果是这样，请消费它，这就是`hasNextInt()`目的。如果您输入有效的内容，则该循环退出。

# c++ - 代码分析显示 'wWinMain' 的注释不一致：此实例没有注释

> ID：13078953
> 
> 赞同：33
> 
> 时间：2012-10-25T23:47:48.050
> 
> 标签：c++, winapi, visual-c++, annotations

我正在写一些简单的 win32 东西，我正在使用以下 wWinMain

```
int WINAPI wWinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance,
                    PWSTR pCmdLine, int nCmdShow) 
```

VS2012 express 代码分析说

> C28251 函数注释不一致：此实例有一个错误 'wWinMain' 的注释不一致：此实例没有注释。请参见 c:\program files (x86)\windows kits\8.0\include\um\winbase.h(2201)。LeesSpaceShip main.cpp 6

我不清楚注释甚至是什么。那么什么是注释，我的代码中哪一部分有问题？

除了这个诊断之外，代码编译和运行都很好。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-10-25T23:50:30.310

winbase.h 中的声明`wWinMain`（错误中提到）是：

```
wWinMain(
    _In_ HINSTANCE hInstance,
    _In_opt_ HINSTANCE hPrevInstance,
    _In_ LPWSTR lpCmdLine,
    _In_ int nShowCmd
    ); 
```

您`wWinMain`在 main.cpp 中的实现缺少[SAL 注释](http://msdn.microsoft.com/en-us/library/ms182032.aspx)，并且代码分析警告您不匹配。

# bash - Unix - 在多个子目录中的同一文件上执行相同的命令

> ID：13078957
> 
> 赞同：0
> 
> 时间：2012-10-25T23:47:52.230
> 
> 标签：bash, unix, loops, execute

我在同一个目录中有 36 个子目录，名为`10,11,12,....45`

在每个子目录中都有一个名为`pressure.sh`我想执行命令的文件，命令是`qsub`

我想知道是否有一种方法可以`pressure.sh`对父目录中的每个子目录 10-45 中的每个文件执行命令 qsub？

所以我正在寻找`qsub pressure.sh`一个在每个子目录中一个一个地执行“”的代码，所以我不必每次都一个一个地执行。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T23:49:50.590

您可以使用 glob：

```
for i in */pressure.sh; do
    qsub $i
done 
```

要更明确地了解目录，您可以使用范围：

```
for i in {10..45}/pressure.sh 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T13:42:03.247

另一种方法是使用`find`and `xargs`：

```
find . -name pressure.sh | xargs -n 1 qsub 
```

找到 all `pressure.sh`，即使比一层更深。

# php - 如何在 FPDF 中显示 JSON/base64 编码的图像？

> ID：13078959
> 
> 赞同：2
> 
> 时间：2012-10-25T23:47:53.430
> 
> 标签：php, json, image, fpdf

我正在存储签名（在我的数据库中使用[签名板](http://thomasjbradley.ca/lab/signature-to-image/)`Coldfusion/MySQL 5.0.88`，并希望将我正在使用的签名输出到我正在生成的 pdf 中`fpdf`。但是我无法让它工作......

签名存储如下：

```
[{"lx":19,"ly":58,"mx":19,"my":57},{"lx":23,"ly":54,"mx":19,"my":58},{"lx":26,"ly":53,"mx":23,"my":54},{"lx":32,"ly":51,"mx":26,"my":53},{"lx":38,"ly":47,"mx":32,"my":51},{"lx":44,"ly":44,"mx":38,"my":47},{"lx":51,"ly":41,"mx":44,"my":44},{"lx":58,"ly":37,"mx":51,"my":41},{"lx":64,"ly":35,"mx":58,"my":37},{"lx":67,"ly":31,"mx":64,"my":35},{"lx":70,"ly":30,"mx":67,"my":31},{"lx":72,"ly":28,"mx":70,"my":30},{"lx":71,"ly":28,"mx":72,"my":28},{"lx":69,"ly":28,"mx":71,"my":28},{"lx":66,"ly":28,"mx":69,"my":28},{"lx":62,"ly":29,"mx":66,"my":28},{"lx":59,"ly":31,"mx":62,"my":29},{"lx":55,"ly":32,"mx":59,"my":31},{"lx":52,"ly":33,"mx":55,"my":32},{"lx":48,"ly":35,"mx":52,"my":33},{"lx":44,"ly":37,"mx":48,"my":35},{"lx":41,"ly":38,"mx":44,"my":37},{"lx":39,"ly":40,"mx":41,"my":38},{"lx":36,"ly":40,"mx":39,"my":40},{"lx":33,"ly":42,"mx":36,"my":40},{"lx":32,"ly":43,"mx":33,"my":42},{"lx":31,"ly":44,"mx":32,"my":43},{"lx":31,"ly":46,"mx":31,"my":44},{"lx":32,"ly":48,"mx":31,"my":46},{"lx":136,"ly":23,"mx":32,"my":48},{"lx":132,"ly":24,"mx":136,"my":23},{"lx":104,"ly":38,"mx":132,"my":24},{"lx":103,"ly":40,"mx":104,"my":38},{"lx":102,"ly":41,"mx":103,"my":40},{"lx":102,"ly":42,"mx":102,"my":41},{"lx":103,"ly":42,"mx":102,"my":42},{"lx":108,"ly":42,"mx":103,"my":42},{"lx":115,"ly":42,"mx":108,"my":42},{"lx":123,"ly":39,"mx":115,"my":42},{"lx":133,"ly":36,"mx":123,"my":39},{"lx":141,"ly":34,"mx":133,"my":36},{"lx":148,"ly":32,"mx":141,"my":34},{"lx":155,"ly":30,"mx":148,"my":32},{"lx":159,"ly":29,"mx":155,"my":30},{"lx":161,"ly":28,"mx":159,"my":29},{"lx":159,"ly":27,"mx":161,"my":28},{"lx":155,"ly":27,"mx":159,"my":27},{"lx":151,"ly":27,"mx":155,"my":27},{"lx":145,"ly":27,"mx":151,"my":27},{"lx":140,"ly":29,"mx":145,"my":27},{"lx":135,"ly":31,"mx":140,"my":29},{"lx":132,"ly":33,"mx":135,"my":31},{"lx":127,"ly":36,"mx":132,"my":33},{"lx":125,"ly":38,"mx":127,"my":36},{"lx":125,"ly":40,"mx":125,"my":38},{"lx":125,"ly":41,"mx":125,"my":40},{"lx":125,"ly":42,"mx":125,"my":41},{"lx":127,"ly":43,"mx":125,"my":42},{"lx":131,"ly":44,"mx":127,"my":43},{"lx":139,"ly":45,"mx":131,"my":44},{"lx":147,"ly":45,"mx":139,"my":45},{"lx":157,"ly":43,"mx":147,"my":45},{"lx":164,"ly":41,"mx":157,"my":43},{"lx":173,"ly":39,"mx":164,"my":41},{"lx":181,"ly":36,"mx":173,"my":39},{"lx":186,"ly":34,"mx":181,"my":36},{"lx":191,"ly":33,"mx":186,"my":34},{"lx":193,"ly":30,"mx":191,"my":33},{"lx":194,"ly":29,"mx":193,"my":30},{"lx":194,"ly":28,"mx":194,"my":29},{"lx":193,"ly":27,"mx":194,"my":28},{"lx":191,"ly":26,"mx":193,"my":27},{"lx":188,"ly":25,"mx":191,"my":26},{"lx":183,"ly":25,"mx":188,"my":25},{"lx":180,"ly":25,"mx":183,"my":25},{"lx":177,"ly":25,"mx":180,"my":25},{"lx":174,"ly":27,"mx":177,"my":25},{"lx":171,"ly":30,"mx":174,"my":27},{"lx":169,"ly":32,"mx":171,"my":30},{"lx":168,"ly":34,"mx":169,"my":32},{"lx":167,"ly":36,"mx":168,"my":34},{"lx":167,"ly":38,"mx":167,"my":36},{"lx":168,"ly":40,"mx":167,"my":38},{"lx":169,"ly":41,"mx":168,"my":40},{"lx":171,"ly":41,"mx":169,"my":41},{"lx":174,"ly":41,"mx":171,"my":41},{"lx":176,"ly":41,"mx":174,"my":41},{"lx":176,"ly":40,"mx":176,"my":41},{"lx":177,"ly":39,"mx":176,"my":40},{"lx":177,"ly":37,"mx":177,"my":39}] 
```

siganturepad 中包含一个自定义函数（[签名到图像](http://thomasjbradley.ca/lab/signature-to-image/)），可以将上述内容转换回图像。像这样：

```
<?php
require_once '../../signature-to-image.php';
$img = sigJsonToImage(file_get_contents('sig-output.json'));

// Output to browser
header('Content-Type: image/png');
imagepng($img);

imagedestroy($img);
> 
```

但是如果我在我的 fpdf 页面上尝试这个，整个页面都会中断（我想是因为我想将图像嵌入到一个单元格中，而不是只将图像输出到浏览器），我得到了这个：

资源 id #10‰PNG IHDRÆ7Ø7¢¶±IDATxœí›iP[×Ç/'a6±£'ŒÀk0›ëÝ†6)NÒÆ‰Ý¸µM2î´nf:“d2gq”Æušq–Ió! ŽSâÄNJgRÛñ '@1KOFF±õ´ ÀfÖÖ/}y'Ä`çþ>x¬û®Gºÿ{Î=ç…¹.Pm¡ €Ük@IA(J B1PRŠ'‚P”„b ¤ %¡()Å@ IA(J B1PRŠ'‚P”„b ¤ %¡()Å@IA(J B1PRŠ'‚Pc¡ €üÀðèT³Æ Pa×L'^z02œ¾¡”Ô£·Œ+ÔX‹S¨0íÍb¼«wpåòô4,h¤vK †ê¿Õe¨þÆà1Á óÓ¥bŽTÌÉËN™ÃL#u ªƒÇ•¾§Y'±27½ZÂg%{^ ƒ? œNÚoQ¨°A†ê‡Fnâ–Dìyà¾=÷ß¹ >¿¤ýËáÆ[Óþ¿¥€—ºwKá /Ëy4Z1%*lvG{¹YmÀãÚØ”mÆiþ‹i|êN}c÷7}ß´öûiÃoÖ×dº-¹'“VÛSïž?)ïTKxÏ?.‰aFø~ßÞcúJ¡;¥¼>:y°±ˆ{è÷ kÙ‰1øÕ»XR£“wZÔ∼Å”ZÃ·Z£ÛUuíîäø¨y6iÒjSjJA†êÛºMV›ƒ¸ÄCX"Äîp6u}ìüS‡Î\× ªoìž°Î¬Kß¼³wÃ£k>lÞvàk9Š±¢#_ß³vKEŽŸ·¶9ŽžS½Qßj™xò +^Ýý3|ü®””idâí/ÛjOw:œ^fkÉ³[KçÁ∼'qk‹ÚÐ¬6ÈP}WŸÅîpâãaa@ÌM–^2[*æho¿ö™RŽbÀo1án©®AõÝõA|„‡...

如果我这样做：

```
if( strlen($unterschrift) > 0){
    $img = sigJsonToImage( $unterschrift );
}; 
```

并尝试输出：

```
if ( $imgProceed == "true" ){
    $pdf->imagepng($img);
} else {
    $pdf->Cell(50,4,'',0,1);
} 
```

我得到的只是：

```
`Call to undefined method PDF::imagepng() `/ `strpos() expects parameter 1 to be string, resource` 
```

有人可以向我解释一下，我做错了什么或者我需要做什么才能将图像包含在 fpdf 的单元格中吗？我一无所知。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:57:19.030

问题在这里

```
$pdf->imagepng($img);
                 ^-------------- This should be an image path (String) 
```

解决方案

```
$file = 'signature.png' ;
imagepng($img, $file);  
                 ^----------- Save Image to File Instead 
```

然后

```
if ($imgProceed == "true") {
    $pdf->imagepng($file);
} else {
    $pdf->Cell(50, 4, '', 0, 1);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T23:47:18.710

最初，我打算转换为 PNG，但我想得越多，开销就越大。毕竟，Signature Pad 为我们提供了在 FPDF 中重新绘制签名所需的一切。

我做了以下事情：

```
 // decode the signature into an array
    $sig = json_decode($signatureInJSON);

    // for each line segment
    foreach ($sig as $line) {
        $lx = $line->lx;
        $ly = $line->ly;
        $mx = $line->mx;
        $my = $line->my;
        // draw the line
        $pdf->Line($lx, $ly, $mx, $my);
    } 
```

显然，我还添加了一些函数来缩放签名并将其偏移到 PDF 中我想要的位置。

希望对其他人有所帮助。

# git - 当网络在中间断开时，gerrit/git 设置搞砸了。如何放弃部分提交？

> ID：13078962
> 
> 赞同：0
> 
> 时间：2012-10-25T23:48:08.793
> 
> 标签：git, gerrit

当我的网络断开连接时，我正在使用“git push origin HEAD:refs/for/master”将我的更改从本地 git repo 推送到 Gerrit。

现在，当我尝试重新运行它时，我得到：

计数对象：40，完成。使用多达 8 个线程的 Delta 压缩。压缩对象：100% (28/28)，完成。写入对象：100% (36/36)，2.23 MiB，完成。总共 36 个（增量 4），重复使用 5 个（增量 0）远程：解析增量：100%（4/4）远程：处理更改：参考：1，完成
到 ssh://@:29418/scaligent.git ！[远程拒绝] HEAD -> refs/for/master（更改 57 已关闭）错误：未能将一些 refs 推送到 'ssh://@:29418/scaligent.git'

如何清理状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T02:13:09.577

错误信息说明一切

> [远程拒绝] HEAD -> refs/for/master（更改 57 已关闭）

这不是由 git push 引起的。通常在这种情况下您会收到此错误：

*   将本地提交推送到服务器作为更改 57 补丁集 1
*   修改一些东西 & git commit -amend
*   某人（包括您自己）单击 gerrit 中的提交或放弃按钮（这将关闭更改 57）
*   再次运行 git push

Gerrit 发现您尝试将新补丁集添加到已关闭的更改中，因此恢复推送。

现在您可以按照以下步骤清理它：

*   （可选） git branch -b 备份
*   git 获取原点
*   git重置原点/主
*   git 提交 -a
*   git push origin HEAD:refs/for/master

# sql - 连续重复/重复的有序计数

> ID：13078964
> 
> 赞同：1
> 
> 时间：2012-10-25T23:49:13.337
> 
> 标签：sql, performance, postgresql, plpgsql, window-functions

我非常怀疑我是否以最有效的方式这样做，这就是我`plpgsql`在这里标记的原因。对于**一千个测量系统**，我需要在**20 亿行**上运行它。

 **您的测量系统通常会在失去连接时报告先前的值，并且它们经常会因为突然但有时很长时间而失去连接。您需要汇总，但是当您这样做时，您需要查看它重复了多长时间并根据该信息制作各种过滤器。假设您正在测量汽车的 mpg，但它停留在 20 mpg 一个小时，然后移动到 20.1，依此类推。您需要在卡住时评估准确性。您还可以放置一些替代规则来查找汽车何时在高速公路上行驶，并且通过窗口功能，您可以生成汽车的“状态”并进行分组。无需再费周折：

```
--here's my data, you have different systems, the time of measurement, and the actual measurement
--as well, the raw data has whether or not it's a repeat (hense the included window function
select * into temporary table cumulative_repeat_calculator_data
FROM
    (
    select 
    system_measured, time_of_measurement, measurement, 
    case when 
     measurement = lag(measurement,1) over (partition by system_measured order by time_of_measurement asc) 
     then 1 else 0 end as repeat
    FROM
    (
    SELECT 5 as measurement, 1 as time_of_measurement, 1 as system_measured
    UNION
    SELECT 150 as measurement, 2 as time_of_measurement, 1 as system_measured
    UNION
    SELECT 5 as measurement, 3 as time_of_measurement, 1 as system_measured
    UNION
    SELECT 5 as measurement, 4 as time_of_measurement, 1 as system_measured
    UNION
    SELECT 5 as measurement, 1 as time_of_measurement, 2 as system_measured
    UNION
    SELECT 5 as measurement, 2 as time_of_measurement, 2 as system_measured
    UNION
    SELECT 5 as measurement, 3 as time_of_measurement, 2 as system_measured
    UNION
    SELECT 5 as measurement, 4 as time_of_measurement, 2 as system_measured
    UNION
    SELECT 150 as measurement, 5 as time_of_measurement, 2 as system_measured
    UNION
    SELECT 5 as measurement, 6 as time_of_measurement, 2 as system_measured
    UNION
    SELECT 5 as measurement, 7 as time_of_measurement, 2 as system_measured
    UNION
    SELECT 5 as measurement, 8 as time_of_measurement, 2 as system_measured
    ) as data
) as data;

--unfortunately you can't have window functions within window functions, so I had to break it down into subquery
--what we need is something to partion on, the 'state' of the system if you will, so I ran a running total of the nonrepeats
--this creates a row that stays the same when your data is repeating - aka something you can partition/group on
select * into temporary table cumulative_repeat_calculator_step_1
FROM
    (
    select 
    *,
    sum(case when repeat = 0 then 1 else 0 end) over (partition by system_measured order by time_of_measurement asc) as cumlative_sum_of_nonrepeats_by_system
    from cumulative_repeat_calculator_data
    order by system_measured, time_of_measurement
) as data;

--finally, the query. I didn't bother showing my desired output, because this (finally) got it
--I wanted a sequential count of repeats that restarts when it stops repeating, and starts with the first repeat
--what you can do now is take the average measurement under some condition based on how long it was repeating, for example  
select *, 
case when repeat = 0 then 0
else
row_number() over (partition by cumlative_sum_of_nonrepeats_by_system, system_measured order by time_of_measurement) - 1
end as ordered_repeat
from cumulative_repeat_calculator_step_1
order by system_measured, time_of_measurement 
```

那么，为了在一个巨大的桌子上运行它，你会做些什么不同的事情，或者你会使用什么替代工具？我正在考虑 plpgsql，因为我怀疑这需要在数据库中或在数据插入过程中完成，尽管我通常在加载数据后处理数据。有没有办法在不诉诸子查询的情况下一次性完成？

我已经测试了一种*替代方法*，但它仍然依赖于子查询，我认为这更快。对于该方法，您可以使用 start_timestamp、end_timestamp、system 创建一个“开始和停止”表。然后加入更大的表，如果时间戳介于两者之间，则将其归类为处于该状态，这本质上是`cumlative_sum_of_nonrepeats_by_system`. 但是，当您这样做时，您会以 1=1 的方式加入数千台设备和数千或数百万个“事件”。你认为这是一个更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T02:16:19.033

### 测试用例

首先，一种更有用的方式来呈现您的数据 - 甚至更好，在[**sqlfiddle**](http://www.sqlfiddle.com/#!12/a467b/1)中，准备好使用：

```
CREATE TEMP TABLE data(
   system_measured int
 , time_of_measurement int
 , measurement int
);

INSERT INTO data VALUES
 (1, 1, 5)
,(1, 2, 150)
,(1, 3, 5)
,(1, 4, 5)
,(2, 1, 5)
,(2, 2, 5)
,(2, 3, 5)
,(2, 4, 5)
,(2, 5, 150)
,(2, 6, 5)
,(2, 7, 5)
,(2, 8, 5); 
```

### 简化查询

由于尚不清楚，我仅假设上述内容。
接下来，我简化了您的查询以达到：

```
WITH x AS (
   SELECT *, CASE WHEN lag(measurement) OVER (PARTITION BY system_measured
                               ORDER BY time_of_measurement) = measurement
                  THEN 0 ELSE 1 END AS step
   FROM   data
   )
   , y AS (
   SELECT *, sum(step) OVER(PARTITION BY system_measured
                            ORDER BY time_of_measurement) AS grp
   FROM   x
   )
SELECT * ,row_number() OVER (PARTITION BY system_measured, grp
                             ORDER BY time_of_measurement) - 1 AS repeat_ct
FROM   y
ORDER  BY system_measured, time_of_measurement; 
```

现在，虽然使用纯 SQL 非常好用，但使用 plpgsql 函数会**更快**，因为它可以在单个表扫描中完成，该查询至少需要 3 次扫描。

### 使用 plpgsql 函数更快：

```
CREATE OR REPLACE FUNCTION x.f_repeat_ct()
  RETURNS TABLE (
    system_measured int
  , time_of_measurement int
  , measurement int, repeat_ct int
  )  LANGUAGE plpgsql AS
$func$
DECLARE
   r    data;     -- table name serves as record type
   r0   data;
BEGIN

-- SET LOCAL work_mem = '1000 MB';  -- uncomment an adapt if needed, see below!

repeat_ct := 0;   -- init

FOR r IN
   SELECT * FROM data d ORDER BY d.system_measured, d.time_of_measurement
LOOP
   IF  r.system_measured = r0.system_measured
       AND r.measurement = r0.measurement THEN
      repeat_ct := repeat_ct + 1;   -- start new array
   ELSE
      repeat_ct := 0;               -- start new count
   END IF;

   RETURN QUERY SELECT r.*, repeat_ct;

   r0 := r;                         -- remember last row
END LOOP;

END
$func$; 
```

称呼：

```
SELECT * FROM x.f_repeat_ct(); 
```

确保在这种 plpgsql 函数中始终对您的列名进行表限定，因为我们使用与输出参数相同的名称，如果没有限定，它们将优先。

### 数十亿行

如果您***有数十亿*行**，您可能希望拆分此操作。[我在这里](https://www.postgresql.org/docs/current/interactive/plpgsql-control-structures.html#PLPGSQL-STATEMENTS-RETURNING)引用手册：

> 注意：当前实现`RETURN NEXT`并`RETURN QUERY` 在从函数返回之前存储整个结果集，如上所述。这意味着如果一个 PL/pgSQL 函数产生一个非常大的结果集，性能可能会很差：数据将被写入磁盘以避免内存耗尽，但函数本身在生成整个结果集之前不会返回。PL/pgSQL 的未来版本可能允许用户定义没有此限制的集合返回函数。目前，数据开始写入磁盘的点由[work_mem](https://www.postgresql.org/docs/current/interactive/runtime-config-resource.html#GUC-WORK-MEM) 配置变量控制。有足够内存在内存中存储较大结果集的管理员应考虑增加此参数。

考虑一次为一个系统计算行数，或者设置一个足够高的值`work_mem`来应对负载。按照报价中提供的链接了解有关 work_mem 的更多信息。

一种方法是在您的函数中为`work_mem`with设置一个非常高的值[`SET LOCAL`](https://www.postgresql.org/docs/current/interactive/sql-set.html)，该值仅对当前事务有效。我在函数中添加了注释行。不要**在**全局范围内将其设置得非常高，因为这可能会破坏您的服务器。阅读手册。**

# php - $_SESSION 变量不起作用

> ID：13078965
> 
> 赞同：1
> 
> 时间：2012-10-25T23:49:13.710
> 
> 标签：php

作为 PHP 的新手，我需要让 $_SESSION 变量作为更大项目的一部分工作。我发现我无法使用 $_SESSION 变量在 .php 文件之间传输数据。我用谷歌搜索了类似的问题，发现这个问题已解决。[同样的问题](http://x10hosting.com/forums/scripts-3rd-party-apps-programming/134814-php-session-not-working.html)

我将我的代码减少到与问题的解决方案完全相同，但它仍然存在。我有

**sesstest.php**

```
<?php
session_start();
$_SESSION['test']="TEST SESSION TEXT";
header('location:sessreceive.php');
?> 
```

**sessreceive.php**

```
<?php session_start();
echo $_SESSION['test'];
?> 
```

我启用了 cookie，它在 Firefox 和 IE 中是一样的。我正在访问的站点是我家庭网络上的 Raspberry Pi。它在 Linux 版本下运行 Apache2。我的 php.ini 的会话部分是

![php.ini 的会话部分](../Images/0aa3eff6bad3182fc4002960036b603f.png)

任何人都可以建议可能出了什么问题，因为我在 sessreceive.php 中没有输出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:55:50.803

确保`session.save_path`存在。有时这就是问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T23:57:00.243

1.  可以试试`var_dump($_SESSION);`，看看它到底包含什么。

2.  此外，请尝试`echo session_id();`在这两种情况下确保您在两种情况下都选择相同的会话。

3.  确保 Apache 可以写入`session.save_path`( `/var/lib/php5`)

# google-analytics - 在 Google Analytics 中显示下载事件的自定义报告

> ID：13078968
> 
> 赞同：0
> 
> 时间：2012-10-25T23:49:28.907
> 
> 标签：google-analytics

有没有人能够在谷歌分析的自定义报告中包含下载？我知道我可以获得一般/所有事件，但我只想下载。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T09:19:31.317

如果您还没有按照上面@Sheikh 更准确的自定义报告答案的跟踪代码，Google Analytics on Steroids 在他们的 API 中提供了一个很棒的 _gasTrackDownloads 钩子。

代码示例：

```
<script type="text/javascript">
var _gas = _gas || []; // _gas instead of _gaq
_gas.push(['_setAccount', 'UA-YYYYYY-Y']); // REPLACE WITH YOUR GA NUMBER
_gas.push(['_setDomainName', '.mydomain.com']); // REPLACE WITH YOUR DOMAIN
_gas.push(['_trackPageview']);
_gas.push(['_gasTrackForms']);
_gas.push(['_gasTrackOutboundLinks']);
_gas.push(['_gasTrackMaxScroll']);
_gas.push(['_gasTrackDownloads']); // track downloads
_gas.push(['_gasTrackYoutube', {force: true}]);
_gas.push(['_gasTrackVimeo', {force: true}]);
_gas.push(['_gasTrackMailto']);

(function() {
var ga = document.createElement('script');
ga.type = 'text/javascript';
ga.async = true;
ga.src = '//cdnjs.cloudflare.com/ajax/libs/gas/1.10.1/gas.min.js'; // new url
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(ga, s);
})();
</script> 
```

链接：[类固醇的谷歌分析](https://github.com/CardinalPath/gas)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T01:35:22.190

如果您要求跟踪，`downloads`那么您可以将`_trackEvent`方法添加到要跟踪的链接中，例如

```
Click <a onclick="_gaq.push(['_trackEvent', 'Downloads', 'Demo', this.href]);" href="downloads/google_dynamic_map.zip">here</a> to download with demo. 
```

上面的代码来自我的工作站点，我能够跟踪`download`该文件。

要查看报告，您可以`Contents->Events`从谷歌分析页面的左侧导航栏中选择菜单。

在我的链接`Downloads`中是`Event Category`and`Demo`是`Event Action`并且`this.href`是我`Event Label`的，它给了我`url`文件的。

我还创建了一个自定义报告，仅用于跟踪`Downloads`来自 Google 的自定义报告选项的事件类别，并且可以从该自定义报告中跟踪它，过滤为`Downloads`.

## 自定义报告设置的屏幕截图

![在此处输入图像描述](../Images/dc3221cec3dc136a1d844b9ab185dfa3.png)

## 标准报告的屏幕截图和从`content`菜单中查看

![在此处输入图像描述](../Images/c11a697438289ef7234bf41cb411a957.png)

**此处有用的链接：** [链接一](http://www.blastam.com/blog/index.php/2011/04/how-to-track-downloads-in-google-analytics/)和[链接二](http://gaconfig.com/google-analytics-event-tracking/)以及[事件跟踪指南](https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide)。

**更新：**还请记住，在您设置完所有这些内容后需要一些时间来跟踪并查看结果。

# mercurial - CoolIris 的 hg 克隆因“abort no such dir”而失败

> ID：13078970
> 
> 赞同：0
> 
> 时间：2012-10-25T23:49:36.457
> 
> 标签：mercurial, abort, cooliris

尝试使用谷歌提供的命令克隆cooliris项目；

```
hg clone https://cooliris-toolkit.googlecode.com/hg/ Cooliris-ToolKit 
```

但它虽然运行并且总是失败

> 更新到分支默认中止：没有这样的文件或目录

我是否创建了**Cooliris-ToolKit**文件夹。

有人可以为此提出解决方案吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:57:02.797

这是一个工作命令：

```
hg clone https://cooliris-toolkit.googlecode.com/ 
```

[https://code.google.com/p/cooliris-toolkit/source/checkout](https://code.google.com/p/cooliris-toolkit/source/checkout)

# c++ - 如何阻止 QXmlStreamWriter 转义引号？

> ID：13078977
> 
> 赞同：4
> 
> 时间：2012-10-25T23:50:02.083
> 
> 标签：c++, xml, qt, escaping

让我首先表达我的理解，即我正在尝试做的事情**不**正常，通常也不是很好的建议。我完全知道在普通 XML 中，该`"`字符是保留的。

我正在`.vcxproj`使用 Qt 应用程序生成要在 Visual Studio 2010 中使用的文件。我正在利用`QXmlStreamWriter`该类来编写项目文件所需的 XML。但是，由于 Microsoft 不遵守 XML 标准，我遇到了问题。

在`CustomBuild`元素中，用户需要指定构建文件的命令。对于 Visual Studio 中的 Qt 项目，您最终会得到如下内容：

```
 <Command Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">"$(QTDIR)\bin\moc.exe"  "%(FullPath)" -o "..\myproj\moc_%(Filename).cpp"  -DUNICODE -DWIN32 -DQT_LARGEFILE_SUPPORT -DQT_DLL -DQT_CORE_LIB -DQT_GUI_LIB -DQT_XML_LIB -DQT_SQL_LIB -DQT_OPENGL_LIB -DQT_QT3SUPPORT_LIB -DQT3_SUPPORT -DQT_SVG_LIB "-I." "-I$(QTDIR)\include" "-I$(QTDIR)\include\QtCore" "-I$(QTDIR)\include\QtGui" "-I$(QTDIR)\include\QtXml" "-I$(QTDIR)\include\QtSql" "-I$(QTDIR)\include\QtOpenGL" "-I$(QTDIR)\include\Qt3Support" "-I$(QTDIR)\include\QtSvg" "-I$(QTDIR)\include\QtTest" "-I..\myproj"</Command> 
```

令人讨厌，但*c'est la vie*，尤其是与微软。不幸的是，我的`QXmlStreamWriter`对象产生了这个（完全兼容的）输出：

```
 <Command Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">$(QTDIR)\bin\moc.exe&quot; &quot;%(FullPath)&quot; -o &quot;..\myproj\moc_%(Filename).cpp&quot;   -DUNICODE -DWIN32 -DQT_LARGEFILE_SUPPORT -DQT_DLL -DQT_CORE_LIB -DQT_GUI_LIB -DQT_XML_LIB -DQT_SQL_LIB -DQT_OPENGL_LIB -DQT_QT3SUPPORT_LIB -DQT3_SUPPORT -DQT_SVG_LIB &quot;-I.&quot; &quot;-I$(QTDIR)\include&quot; &quot;-I$(QTDIR)\include\QtCore&quot; &quot;-I$(QTDIR)\include\QtGui&quot; &quot;-I$(QTDIR)\include\QtXml&quot; &quot;-I$(QTDIR)\include\QtSql&quot; &quot;-I$(QTDIR)\include\QtOpenGL&quot; &quot;-I$(QTDIR)\include\Qt3Support&quot; &quot;-I$(QTDIR)\include\QtSvg&quot; &quot;-I$(QTDIR)\include\QtTest&quot; &quot;..\myproj&quot;</Command> 
```

当然，Visual Studio 并没有留下深刻的印象。我在这里有什么选择？我可能可以读回文件并取消转义，但这听起来不是特别有效或智能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T02:39:17.957

我猜您正在使用`QXmlStreamWriter::writeCharacters`或类似的方法来编写包含`"`?

也许，在调用该函数之前，您可以检查您要编写的字符串是否包含`"`. 如果是这样，您可以将其拆分为`"`，通过 写入非`"`字符`QXmlStreamWriter::writeCharacters`，然后`"`直接写入底层`QIODevice`：

```
QString maybeHasQuotes = ...;
QStringList parts = maybeHasQuotes.split('"');
while (!parts.isEmpty()) {
    QString part = parts.takeFirst();
    writer.writeCharacters(part);
    if (!parts.isEmpty()) {
        writer.device()->putChar('"');
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T20:22:44.240

直接绕过`QIODevice`@rohanpm 建议的方式是要走的路。

我子类化`QXmlStreamWriter`并添加了一个方法来编写带引号的字符串。

# customstreamwriter.h

```
#ifndef CUSTOMSTREAMWRITER_H
#define CUSTOMSTREAMWRITER_H

#include <QXmlStreamWriter>

class CustomStreamWriter : public QXmlStreamWriter
{
public:
    CustomStreamWriter(QIODevice *device);
    void writeQuotedCharacters(QString text);
};

#endif // CUSTOMSTREAMWRITER_H 
```

# customstreamwriter.cpp

```
#include "customstreamwriter.h"

CustomStreamWriter::CustomStreamWriter(QIODevice *device) :
    QXmlStreamWriter(device)
{
}

void CustomStreamWriter::writeQuotedCharacters(QString text) {
    QStringList parts = text.split('"');
    while (!parts.isEmpty()) {
        QString part = parts.takeFirst();
        writeCharacters(part);
        if (!parts.isEmpty()) {
            device()->putChar('"');
        }
    }
} 
```

我没有使用`QXmlStreamWriter`，而是使用 my `CustomStreamWriter`。唯一的区别是当我需要写一个带引号的字符串时，我调用我的`writeQuotedCharacters()`方法。

# python - 在python中添加

> ID：13078978
> 
> 赞同：1
> 
> 时间：2012-10-25T23:50:07.153
> 
> 标签：python, loops

```
while i<10:
   a = a + i
   print (a)
   i = i+1 
```

或者

```
for i in range(10):
   sum = sum + i
   print 
```

* * *

```
0
1
3
6
10
15
21
28
36
45 
```

那么如何通过编写更多代码将它们加在一起呢？我的意思是 1+3+6+10+15+21+... 然后将总数设置为变量！如果你能在两个循环中都给我看，那就太好了:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:56:28.073

这个怎么样：

```
total, totaltotal = 0, 0
for i in range(10):
  total += i
  totaltotal += total
  print total, totaltotal 
```

或者，您可以列出总计并存储它们以单独操作：

```
total, totals = 0, []
for i in range(10):
  total += i
  totals.append(total)
  print total
totaltotal = 0
for i in range(10):
  totaltotal += totals[i]
  print totaltotal 
```

您可能希望将其重写为列表推导式（甚至是生成器表达式），作为一个有用的练习。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T23:54:04.783

```
In [26]: summ=0

In [27]: foo=0       

In [28]: for i in range(10):
    sum+=i          #add i to summ
    foo+=sum        #add summ to foo
   ....:     
   ....:     

In [31]: sum
Out[31]: 45

In [32]: foo
Out[32]: 165 
```

或单线：

```
In [58]: sum(map(sum,map(range,range(1,11))))
Out[58]: 165 
```

`timeit`比较：

```
In [56]: %timeit sum(sum(i + 1 for i in range(n)) for n in range(1000))
10 loops, best of 3: 128 ms per loop

In [57]: %timeit sum(map(sum,map(range,range(1,1001))))
10 loops, best of 3: 27.4 ms per loop 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T23:56:25.500

怎么样

```
sum(sum(i + 1 for i in range(n)) for n in range(10)) 
```

（如果你想要一个pythonic方法）

# c++ - 如何在简单的树实现中使用智能指针

> ID：13078979
> 
> 赞同：0
> 
> 时间：2012-10-25T23:50:09.137
> 
> 标签：c++, smart-pointers, b-tree

这是 B+ 树的一个节点。我想使用智能指针，因为我的程序泄漏了大量内存。如何使用智能指针转换代码？

```
class node
{

public:

    long* key;
    int capacity;
    node** nodes;
    node* parent;
    long* value;

    node ( int order ) {
        key = new long[order + 1];
        value = new long[order + 1];
        nodes = new node *[order + 2];
        capacity = 0;
        parent = NULL;
        for ( int i = 0; i <= order + 1; i++ ) {
            this->nodes[i] = NULL;
        }
    }
    ~node() {
        delete[] key;
        delete[] value;
        for ( int i = 0; i <= order + 1; i++ ) {
            delete nodes[i];
        }
    }

}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T23:53:22.053

不要使用智能指针。要聪明，*不要*使用指针，而是使用*容器*：

```
#include <vector>

struct node
{
    std::vector<long>   keys;
    std::vector<long>   values;

    std::vector<node *> nodes;
    node *              parent;
}; 
```

根据您的结构的约束，我什至可能希望制作`parent`一个`node &`（如果父级总是先出现并且从不改变），或者可能是一个`std::reference_wrapper<node>`. 但这是一个小问题。）

# javascript - 如何将鼠标点击动作添加到谷歌树形图可视化

> ID：13078980
> 
> 赞同：2
> 
> 时间：2012-10-25T23:50:17.700
> 
> 标签：javascript, google-visualization, treemap

[谷歌树图可视化](https://google-developers.appspot.com/chart/interactive/docs/gallery/treemap)非常好。无论如何要添加鼠标单击动作（例如添加超链接，以便在单击特定图块时弹出新的浏览器窗口。）？该文档没有提及有关鼠标单击事件的任何内容。

如果谷歌可视化不允许这样做，您会推荐其他易于使用且具有此功能的东西吗？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T01:38:00.887

迟到总比没有好，但是...

可以使用`'select'`处理程序来执行此操作。

```
google.visualization.events.addListener(myTreeMap, 'select', myOnClickFunction); 
```

`myOnClickFunction`可以包含您想要的任何内容，但处理链接的最佳方法是将它们作为列添加到原始数据中，然后根据在 TreeMap 中选择的行从列中查找适当的链接。

当您使用侦听器时，如果您使用以下函数`select`，它将为您提供行中的行（[此处](https://developers.google.com/chart/interactive/docs/reference#visgetselection)的文档）：`DataTable``getSelection()`

```
myTreeMap.getSelection(); 
```

这将为您提供表格中的行，因此如果您在第 5 列中有 URL，您可以按如下方式计算 URL：

```
myTreeMap.getValue(4, myTreeMap.getSelection()); 
```

一旦你有了 URL，你就可以使用标准的 Javascript 来做任何你需要的事情（打开一个新窗口等）。

# c# - Windows 8 - 在 Windows.Storage.ApplicationData.Current.LocalSettings 中存储通用列表？

> ID：13078986
> 
> 赞同：1
> 
> 时间：2012-10-25T23:51:06.300
> 
> 标签：c#, windows, windows-runtime, settings

将列表存储在 Windows.Storage.ApplicationData.Current.LocalSettings.Values 数组中是否有技巧？我试过添加一个，它说不支持数据类型。

> WinRT 信息：尝试序列化要写入应用程序数据存储的值时出错
> 
> 附加信息：不支持这种类型的数据。

当我使用 Silverlight 本地设置存储时，此代码运行良好。我需要帮助 api 序列化我的对象吗？列表中的对象只有几个由简单整数和字符串组成的公共属性。

我正在尝试存储一个

```
List<Animal> 
```

在哪里

```
public class Animal
{
   public string Name { get; set; }
   public int Age { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T01:28:51.003

我正在使用[StorageHelper](http://codepaste.net/gtu5mq)来存储数据，它真的很容易，试一试。

感谢[@JerryNixon](http://blog.jerrynixon.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-29T09:31:47.797

我遇到了同样的问题，最终保存和恢复了一个数组，将我的 List 与数组相互转换。

因此，在您的情况下，在整个应用程序中使用 List（因为它更容易），但将 Animal[] 保存并恢复到 LocalSettings。

另一个需要注意的问题是您的数组不能为空或为空，因此对于这种情况有一个虚拟动物，并在您的保存和恢复代码中识别它。

# jqgrid - 从数组本地加载 Jqgrid 数据类型

> ID：13078987
> 
> 赞同：2
> 
> 时间：2012-10-25T23:51:07.140
> 
> 标签：jqgrid

在我关于如何在从[此处提出](https://stackoverflow.com/questions/12983215/alternative-to-jqgrid-triggertoolbar-on-a-local-dataset)的本地 js var 问题刷新下划线数据后重新应用工具栏过滤器的问题中，Oleg 为我提供了一个解决方案：1 使用 datatype:"local" 和 data:localvar 的组合。

现在我面临一个不同的问题，一周后我无法解决。

根据使用本地数据源时的 Jqgrid wiki，默认的 localreader 看起来像

```
The initial configuration of the localReader is the same as those from jsonReader

localReader = {
   root: "rows",
   page: "page",
   total: "total",
   records: "records",
   repeatitems: false,
   cell: "cell",
   id: "id",
   userdata: "userdata",
   subgrid: {root:"rows", repeatitems: true, cell:"cell"}
} 
```

我发现情况并非如此。因为在我可以使用 dataype:"local" 找到的每个示例中，它总是使用直接的 js 数组而不是 js 对象，如下所示：

```
var mydata = [       
{id:"1",invdate:"2007-10-01",name:"test",note:"note",amount:"200.00",tax:"10.00",total:"210.00"},   
   {id:"2",invdate:"2007-10-02",name:"test2",note:"note2",amount:"300.00",tax:"20.00",total:"320.00"}, 
{id:"3",invdate:"2007-09-01",name:"test3",note:"note3",amount:"400.00",tax:"30.00",total:"430.00"}]; 
```

我尝试使用默认的 localReader（repeatitems 设置为 true）来处理

```
var locObj = {"rows":[
       {"id":0,"cell":["val1","val2","val3"]},
       {"id":1,"cell":["val1","val2","val3"]}
        ],
  "page":"1",
  "total":"1",
  "records":"2"
} 
```

数据类型：“本地”，数据：locObj

这不起作用，因为它不会通过 addlocaldata 函数中的数组检查。如果我将选项更改为 datatype:"local", data:locObj.rows

我得到了一个行数正确的网格，但每个单元格都有一个空值。我认为这是因为 addlocaldata 函数无法处理格式为 locObj.rows 的数组。

有没有办法使用自定义的 localreader 实际处理数据类型为“local”的 json 对象（或字符串）（而不必在客户端重新创建数组）？

任何帮助是极大的赞赏。

卡斯比

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T06:17:15.343

你需要做的只是使用

```
data: locObj.rows,
localReader: {repeatitems: true} 
```

请参阅[相应的演示](http://www.ok-soft-gmbh.com/jqGrid/LocalReader.htm)。

# vb.net - 多按钮功能

> ID：13078990
> 
> 赞同：-1
> 
> 时间：2012-10-25T23:51:22.963
> 
> 标签：vb.net, gridview

我只是想知道是否可以在网格视图中的按钮字段中使用一个按钮来通过相同的单击完成几件事。具体来说，我试图让按钮启用编辑模式，将 gridview 的一列从 0 更改为 1（基本上只是检查数字形式的框，而不是单击实际按钮），然后像更新一样应用更改功能按钮就可以了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T23:52:49.527

是的。你可以让按钮的事件处理程序做任何你想做的事情——它可以是一个动作，也可以是一系列动作。

在您的情况下，您只需在处理 Button 的单击事件的代码中执行这三个操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:45:35.817

您可以通过将多个按钮放在一起并一次只显示一个来伪造它。

或者有一个带有变量的按钮来说明按钮的状态。

```
Enum ButtonStateEnum
    EnableEdit
    ChangeColumn
    DoSave
End Enum

Private _state As ButtonStateEnum = ButtonStateEnum.EnableEdit

Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click

    Select Case _state
        Case ButtonStateEnum.EnableEdit
            ' ...
            _state = ButtonStateEnum.ChangeColumn
        Case ButtonStateEnum.ChangeColumn
            ' ...
            _state = ButtonStateEnum.DoSave
        Case ButtonStateEnum.DoSave
            ' ...
            _state = ButtonStateEnum.EnableEdit
    End Select

End Sub 
```