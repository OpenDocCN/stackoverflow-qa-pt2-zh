# StackOverflow 问答 14093000-14093999

# actionscript-3 - AS3 Flash CS6 对象基类和类

> ID：14093001
> 
> 赞同：1
> 
> 时间：2012-12-30T17:44:51.483
> 
> 标签：actionscript-3, flash, air

我似乎遇到了一点问题，我正在使用 AS3 创建一个新的影片剪辑作为变量，现在 AS 文件是 Monster.AS，如果我将基类作为 Monster 和类作为对象，则使用我的对象Monster1，怪物代码运行，因为我有一个跟踪消息，但它没有显示在屏幕上，如果我将基类更改为 flash.display.MovieClip 并将类更改为 Monster，它会运行代码并显示敌人......我很困惑为什么它显示和不显示，因为基类是如何工作的，这是创建怪物的代码

这是 Level.as 的代码片段

```
 public function Level( playerHero:HeroDisplay )
    {
        trace("Level code ran");
        monsterArray = new Array();
        heroGra = playerHero;
        addChild( heroGra );
        var newMonster = new Monster();
        monsterArray.push( newMonster );
        addChild( newMonster );
        setupLevel(1);
        //Buttons
        this.addEventListener(TouchEvent.TOUCH_BEGIN, onTouchBegin);
        this.addEventListener(TouchEvent.TOUCH_MOVE, onTouchMove);
        this.addEventListener(TouchEvent.TOUCH_END, onTouchEnd);
    } 
```

这对两者都有效，但如上所述，如果 Base Class = Monster Class = Monster1 将不会显示，如果 Base Class = flash.display.MovieClip Class = Monster 将显示。

有谁知道为什么？

帆布

更多信息，这是类+基类的图像

![在此处输入图像描述](../Images/06a8d97e0a493bd74a99bacafb90bf87.png)

这里还有怪物AS文件

```
package
{
import flash.display.MovieClip;

public class Monster extends MovieClip
{
    public var id:Number;
    public var hp:Number;
    public var damage:Number;
    public var speed:Number;
    public var xPos:Number;
    public var yPos:Number;
    public var avaiableSkill:Number;

    public function Monster()
    {
        id = 1;
        monsterSetup();
    }

    public function monsterSetup():void
    {
        switch(id)
        {
            case 1: hp = 10; damage = 1; speed = 2; avaiableSkill = 0; this.x = 100; this.y = 150; trace("Monster Setup");
            break;
            default:
            break;
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:18:05.353

你的 Monster 类没有视觉方面。

Monster1，我假设有你的怪物艺术品，对吗？

要使用 Monster1 类，您可以使用以下代码：

```
var newMonster:Monster1 = new Monster1;
addChild(newMonster); 
```

我不太清楚您的方法是什么，但根据您的设置，您永远不会创建视觉元素的实例 - 这是 Monster1 类。

# c++ - 通过引用递归函数传递字符串或流对象时的 C++ 段错误

> ID：14093006
> 
> 赞同：0
> 
> 时间：2012-12-30T17:45:07.397
> 
> 标签：c++, recursion, segmentation-fault, tail-recursion

我正在尝试将我的霍夫曼树序列化到一个文件中，但是遇到了问题的递归性质。我使用 cout 将它打印到控制台没有问题，但是当我尝试将它存储在字符串中或写入文件时出现分段错误。

```
string putData(Node *n, string &s) {

  if (n->leaf()) {
    s << "[" << n->value() << "]";
  } else {
    s << ".";
  }

  if (n->left())
    putData(n->left(), s);

  if (n->right())
    putData(n->right(), s);

} 
```

与 ofstream 对象相同的问题。实际上，在程序段错误之后，我检查了文件及其内容是否正确。但是为什么最后会出现段错误？如何阻止程序出现段错误？

```
string putData(Node *n, ofstream &s) {

  s.open("huffout.txt", ios::app);

  if (n->leaf()) {
    s << "[" << n->value() << "]";
  } else {
    s << ".";
  }
  s.close()
  if (n->left())
    putData(n->left(), s);

  if (n->right())
    putData(n->right(), s);

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T17:49:17.493

您的函数被声明为返回`string`但没有返回语句，如果有任何东西查看可能导致段错误的返回值。你的编译器应该警告你缺少返回，你编译时不是警告吗？

Also, the first code example uses a `string` but tries to append to it with `operator<<`, presumably that's just a copy'n'paste error.

# c++ - c++ 中成员变量因未知原因而更改..？

> ID：14093011
> 
> 赞同：0
> 
> 时间：2012-12-30T17:45:35.770
> 
> 标签：c++, class, private-members

我正在创建一个包含 Cells 的程序，为此我有一个 Cell 类和一个 CellManager 类。单元格组织在一个二维数组中，Cell 类管理器有两个 int 成员变量，xgrid 和 ygrid，它们反映了数组的大小。

由于某种原因，我无法弄清楚，这些成员变量在程序执行过程中会发生变化。任何人都可以看到为什么会发生这种情况，或者也许可以指出我在哪里看的方向。

使用的类和函数如下所示：

```
class Cell
{
    public:
        Cell(int x, int y);
}

---------------------------------

class CellManager
{
     public:
         CellManager(int xg, int yg)

         void registercell(Cell* cell, int x, int y);
         int getxgrid() {return xgrid;}
         int getygrid() {return ygrid;}

     private:
         int xgrid;
         int ygrid;         
         Cell *cells[40][25];

}

-----------------------

and CellManagers functions:

CellManager::CellManager(int xg, int yg)
{
    CellManager::xgrid = xg;
    CellManager::ygrid = yg;
}

void CellManager::registercell(Cell *cell, int x, int y)
{
    cells[x][y] = cell;
} 
```

这是主要功能：

```
int main ()
{
    const int XGRID = 40;
    const int YGRID = 25;

    CellManager *CellsMgr = new CellManager(XGRID, YGRID);

    std::cout << CellsMgr->getxgrid() << std::endl; // PRINTS 40 
    std::cout << CellsMgr->getygrid() << std::endl; // PRINTS 25

    //create the cells and register them with CellManager
    for(int i = 1; i <= XGRID; i++) {

        for(int j = 1; j <= YGRID; j++) {

            Cell* cell = new Cell(i, j);
            CellsMgr->registercell(cell, i, j);
        }
    }

    std::cout << CellsMgr->getxgrid() << std::endl; // PRINTS A RANDOM LARGE INT, EX. 7763680 !!
    std::cout << CellsMgr->getygrid() << std::endl; // PRINTS 1, ALWAYS !! 
```

因此，我初始化了一个 CellMgr，并通过构造函数设置了 xgrid 和 ygrid。然后我创建了一堆 Cell 并将它们注册到 CellMgr。在这之后，CellMgr 的两个成员变量发生了变化，有人知道这是怎么回事吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-30T17:47:12.103

数组是零索引的，但是您使用它们时就像从 1 开始索引一样。因此，您的数组索引将覆盖单元格，并注销数组的末尾，这是未定义的行为。覆盖随机的其他变量当然是可能的。

# objective-c - Unity3D+iOS Dev，等了这么久才拿到IAP SKProductsResponse

> ID：14093013
> 
> 赞同：0
> 
> 时间：2012-12-30T17:46:06.553
> 
> 标签：objective-c, ios, storekit, in-app-purchase

在 IAP 开发中，首先，我按照链接中的说明进行操作：http: [//troybrant.net/blog/2010/01/in-app-purchases-a-full-walkthrough/](http://troybrant.net/blog/2010/01/in-app-purchases-a-full-walkthrough/)

幸运且很快，我弹出了 IAP 对话框（以 0.99 美元购买 XXX？）。一切似乎都奏效了！然后我开始处理收据验证的东西。

一两天后，我得到了***Invalid Product ID***的事情。我几乎在所有地方都添加了断点，最后，我找到了

```
- (void)productsRequest:(SKProductsRequest *)request didReceiveResponse:(SKProductsResponse *)response 
```

方法根本没有被调用。然后我花了大约 2 周的时间在谷歌上搜索所有内容，但我没有任何进展。然后我删除了我的 startPayment 方法，

```
- (void)startPayment
{
   SKPayment *payment = [SKPayment paymentWithProduct: myProduct];
   [[SKPaymentQueue defaultQueue] addPayment:payment];
} 
```

并在该行中添加了一个断点

```
- (void)productsRequest:(SKProductsRequest *)request didReceiveResponse:(SKProductsResponse *)response 
```

好的，等了3-5秒后发现方法被调用了，不存在***Invalid Product ID***问题。

因此，我在***productsRequest didReceiveResponse方法中调用了我的******startPayment***方法。是的，***无效的产品 ID***问题消失了，但我遇到了另一个问题。

 **我的应用程序在等待 2-3 秒后崩溃（返回 iPhone 的主菜单），然后在 1-2 秒后弹出 IAP 对话框。看起来对话框是直接在 iPhone 的主菜单上弹出的。当我再次单击我的应用程序图标时，对话框消失了，应用程序从头开始加载。

有没有人能告诉我到底发生了什么？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T03:58:00.350

应用内购买有一个请求队列。如果您的请求未完成，它将保留在队列中，并且当您的应用重新启动时将尝试继续请求。通过调用适当的方法来完成请求是开发人员的责任。

请记住：Apple 的沙盒服务可能很慢，实时服务器应该快得多。

就在今天，我将应用内购买集成到一个应用程序中，我将在下面发布代码以用于教育目的。我选择将所有代码放入单例中。可能不是最好的解决方案（也许是，也许不是），但就我的目的而言，效果很好。我的商店目前只处理 1 种产品，在销售更多产品时代码可能有点不切实际，但我会尽量记住这一点。

**PS：**请注意下面的代码是一个正在进行的工作。不过，它似乎对我来说很好，所以它可能会帮助你解决你的问题。

**产品商店.h**

```
@interface FSProductStore : NSObject

+ (FSProductStore *)defaultStore;

// AppDelegate should call this on app start (appDidFinishLoading) ...
- (void)registerObserver;

// handling product requests ...
- (void)startProductRequestWithIdentifier:(NSString *)productIdentifier
                        completionHandler:(void (^)(BOOL success, NSError *error))completionHandler;
- (void)cancelProductRequest;

@end 
```

**FSProductStore.m**

```
#import "FSProductStore.h"
#import <StoreKit/StoreKit.h>
#import "NSData+Base64.h"
#import "AFNetworking.h"
#import "FSTransaction.h"

@interface FSProductStore () <SKProductsRequestDelegate, SKPaymentTransactionObserver>

- (void)startTransaction:(SKPaymentTransaction *)transaction;
- (void)completeTransaction:(SKPaymentTransaction *)transaction;
- (void)failedTransaction:(SKPaymentTransaction *)transaction;
- (void)restoreTransaction:(SKPaymentTransaction *)transaction;
- (void)validateReceipt:(NSData *)receiptData withCompletionHandler:(void (^)(BOOL success, NSError *error))completionHandler;

- (void)purchaseSuccess:(NSString *)productIdentifier;
- (void)purchaseFailedWithError:(NSError *)error;

@property (nonatomic, strong) SKProductsRequest *currentProductRequest;
@property (nonatomic, copy) void (^completionHandler)(BOOL success, NSError *error);

@end

@implementation FSProductStore

+ (FSProductStore *)defaultStore
{
    static FSProductStore *store;

    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        if (!store)
        {
            store = [[FSProductStore alloc] init];
        }
    });

    return store;
}

- (void)registerObserver
{
    DLog(@"registering observer ...");

    [[SKPaymentQueue defaultQueue] addTransactionObserver:self];
}

#pragma mark - Products request delegate

- (void)productsRequest:(SKProductsRequest *)request didReceiveResponse:(SKProductsResponse *)response
{
    if (!response.products || response.products.count == 0)
    {
        NSError *error = [NSError errorWithDomain:FSMyAppErrorDomain code:FSNoProductsAvailableError];
        [self purchaseFailedWithError:error];
    }
    else
    {
        SKProduct *product = response.products[0];
        SKPayment *payment = [SKPayment paymentWithProduct:product];

        if ([SKPaymentQueue canMakePayments])
        {
            [[SKPaymentQueue defaultQueue] addPayment:payment];
        }
        else
        {
            NSError *error = [NSError errorWithDomain:FSMyAppErrorDomain code:FSInAppPurchaseDisabledError];
            [self purchaseFailedWithError:error];
        }
        DLog(@"%@", response.products);
    }
}

#pragma mark - Payment transaction observer

// Sent when the transaction array has changed (additions or state changes).  Client should check state of transactions and finish as appropriate.
- (void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions
{
    DLog(@"%@", transactions);

    for (SKPaymentTransaction *transaction in transactions)
    {
        DLog(@"%@", transaction);

        switch (transaction.transactionState)
        {
            case SKPaymentTransactionStatePurchasing: [self startTransaction:transaction];    break;
            case SKPaymentTransactionStateFailed:     [self failedTransaction:transaction];   break;
            case SKPaymentTransactionStatePurchased:  [self completeTransaction:transaction]; break;
            case SKPaymentTransactionStateRestored:   [self restoreTransaction:transaction];  break;
            default: break;
        }
    }
}

// Sent when an error is encountered while adding transactions from the user's purchase history back to the queue.
- (void)paymentQueue:(SKPaymentQueue *)queue restoreCompletedTransactionsFailedWithError:(NSError *)error
{
    DLog(@"%@", error);

    [self purchaseFailedWithError:error];
}

// Sent when transactions are removed from the queue (via finishTransaction:).
- (void)paymentQueue:(SKPaymentQueue *)queue removedTransactions:(NSArray *)transactions
{
    DLog(@"%@", transactions);
}

// Sent when all transactions from the user's purchase history have successfully been added back to the queue.
- (void)paymentQueueRestoreCompletedTransactionsFinished:(SKPaymentQueue *)queue
{
    DLog(@"%@", queue);
}

// Sent when the download state has changed.
- (void)paymentQueue:(SKPaymentQueue *)queue updatedDownloads:(NSArray *)downloads
{
    DLog(@"%@", downloads);
}

#pragma mark - Public methods

- (void)startProductRequestWithIdentifier:(NSString *)productIdentifier
                        completionHandler:(void (^)(BOOL success, NSError *error))completionHandler
{
    if ([productIdentifier isEqualToString:FS_PRODUCT_DISABLE_ADS] == NO)
    {
        DLog(@"ERROR: invalid product identifier!");

        NSError *error = [NSError errorWithDomain:FSMyAppErrorDomain code:FSInvalidProductIdentifier];

        if (completionHandler)
        {
            completionHandler(NO, error);
        }

        return;
    }

    // cancel any existing product request (if exists) ...

    [self cancelProductRequest];

    // start new  request ...

    self.completionHandler = completionHandler;

    NSSet *productIdentifiers = [NSSet setWithObject:productIdentifier];
    self.currentProductRequest = [[SKProductsRequest alloc] initWithProductIdentifiers:productIdentifiers];
    _currentProductRequest.delegate = self;
    [_currentProductRequest start];
}

- (void)cancelProductRequest
{
    if (_currentProductRequest)
    {
        DLog(@"cancelling existing request ...");

        [_currentProductRequest setDelegate:nil];
        [_currentProductRequest cancel];
    }
}

#pragma mark - Private methods

- (void)startTransaction:(SKPaymentTransaction *)transaction
{
    DLog(@"starting transaction: %@", transaction);
}

- (void)completeTransaction: (SKPaymentTransaction *)transaction
{
    [self validateReceipt:transaction.transactionReceipt withCompletionHandler:^ (BOOL success, NSError *error) {
        if (success)
        {
            // Your application should implement these two methods.
            [self recordTransaction:transaction];
            [self purchaseSuccess:transaction.payment.productIdentifier];
        }
        else
        {
            // deal with error ...
            [self purchaseFailedWithError:error];
        }

        [[SKPaymentQueue defaultQueue] finishTransaction: transaction];
    }];
}

- (void)failedTransaction: (SKPaymentTransaction *)transaction
{
    if (transaction.error.code != SKErrorPaymentCancelled) {
        [self purchaseFailedWithError:transaction.error];
    }

    [[SKPaymentQueue defaultQueue] finishTransaction:transaction];
}

- (void)restoreTransaction: (SKPaymentTransaction *)transaction
{
    [self recordTransaction:transaction];
    [self purchaseSuccess:transaction.originalTransaction.payment.productIdentifier];

    [[SKPaymentQueue defaultQueue] finishTransaction:transaction];
}

- (void)recordTransaction:(SKPaymentTransaction *)transaction
{
    DLog(@"recording transaction: %@", transaction);

    // TODO: store for audit trail - perhaps on remote server?

    FSTransaction *transactionToRecord = [FSTransaction transactionWithIdentifier:transaction.transactionIdentifier receipt:transaction.transactionReceipt];
    [transactionToRecord store];
}

- (void)purchaseSuccess:(NSString *)productIdentifier
{
    // TODO: make purchase available to user - perhaps call completion block?

    DLog(@"transaction success for product: %@", productIdentifier);

    self.currentProductRequest = nil;

    if (_completionHandler)
    {
        _completionHandler(YES, nil);
    }
}

- (void)purchaseFailedWithError:(NSError *)error
{
    DLog(@"%@", error);

    self.currentProductRequest = nil;

    if (_completionHandler)
    {
        _completionHandler(NO, error);
    }
}

- (void)validateReceipt:(NSData *)receiptData withCompletionHandler:(void (^)(BOOL success, NSError *error))completionHandler
{
    DLog(@"validating receipt with Apple ...");

    NSString *body = [NSString stringWithFormat:@"{\"receipt-data\" : \"%@\"}", [receiptData base64EncodedString]];
    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:FS_URL_APPLE_VERIFY_RECEIPT];
    request.HTTPMethod = @"POST";
    request.HTTPBody   = [body dataUsingEncoding:NSUTF8StringEncoding];

    [AFJSONRequestOperation addAcceptableContentTypes:[NSSet setWithObject:@"text/plain"]];
    AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^ (NSURLRequest *request, NSURLResponse *response, id JSON) {

        DLog(@"%@", JSON);

        NSNumber *number  = [JSON objectForKey:@"status"];
        BOOL      success = number && (number.integerValue == 0);
        NSError  *error   = success ? nil : [NSError errorWithDomain:FSMyAppErrorDomain code:FSInvalidProductReceipt];

        if (completionHandler)
        {
            completionHandler(success, error);
        }

    } failure:^ (NSURLRequest *request, NSURLResponse *response, NSError *error, id JSON) {

        if (completionHandler)
        {
            completionHandler(NO, error);
        }

    }];
    [operation start];
}

@end 
```

这个类的设计的好处是它有点像一个用于应用内购买的黑盒子。使用该类相当容易，例如以下代码用于购买“禁用广告”产品：

```
- (void)disableAds
{
    [self showLoadingIndicator:YES forView:self.tableView];

    [[FSProductStore defaultStore] startProductRequestWithIdentifier:FS_PRODUCT_DISABLE_ADS completionHandler:^ (BOOL success, NSError *error) {

        [self showLoadingIndicator:NO forView:self.tableView];

        DLog(@"%d %@", success, error);

        if (success)
        {
            NSNumber *object = [NSNumber numberWithBool:YES];
            [[NSNotificationCenter defaultCenter] postNotificationName:FSShouldDisableAdsNotification object:object];

            NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow];
            if (indexPath)
            {
                [self.tableView deselectRowAtIndexPath:indexPath animated:YES];
            }
        }
        else
        {
            [UIAlertView showAlertViewWithError:error delegate:self];
        }

    }];
} 
```

**PS：**以下宏用于收据验证 URL。我有 3 个方案：调试（开发）、发布（测试）和分发（AppStore）：

```
// In-App purchase: we'll use the Sandbox environment for test versions ...

#if (DEBUG || RELEASE)
#define FS_URL_APPLE_VERIFY_RECEIPT [NSURL URLWithString:@"https://sandbox.itunes.apple.com/verifyReceipt"]
#else // DISTRIBUTION
#define FS_URL_APPLE_VERIFY_RECEIPT [NSURL URLWithString:@"https://buy.itunes.apple.com/verifyReceipt"]
#endif // (DEBUG || RELEASE) 
```**

# java - 动画 JDialog

> ID：14093015
> 
> 赞同：0
> 
> 时间：2012-12-30T17:46:18.853
> 
> 标签：java, swing, animation, jdialog, event-dispatch-thread

我创建了一个`JDialog`我想移动和调整大小的。`JDialog`我的程序在屏幕上绘制。当用户点击它时，它应该拉伸到屏幕的宽度，然后增加高度。我试过这样。

```
for(int i = 150; i <= width; i += 3) {
    dialog.setSize(i, 80);

    try {
        Thread.sleep(0, 1);
    } catch(Exception e2) {}
}

for(int i = 80; i <= 200; i++) {
    dialog.setSize(width, i);

    try {
        Thread.sleep(1);
    } catch(Exception e3) {}
} 
```

执行代码时，需要一段时间，然后 JDialog 将立即显示为拉伸状态。没有显示展开。

好吧，当用户再次单击对话框时，它将反转打开动画并关闭。

```
for(int i = 200; i >= 80; i--) {
    newMsg.setSize(width, i);

    try {
        Thread.sleep(0, 1);
    } catch(Exception e4) {}
}   

for(int i = 0; i >= -width; i -= 3) {
    newMsg.setLocation(i, 100);

    try {
        Thread.sleep(0, 1);
    } catch(Exception e5) {}
} 
```

这个工作正常。可以看到运动。据我了解，这些代码在其他方面是相同的，只是它们被颠倒了。为什么开场没有按预期工作，但收场却可以？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T17:50:37.260

不要`Thread.sleep`在`EDT`. 这会导致 UI “冻结”。您可以在此处使用[Swing Timer 。](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)以下是初始“扩展”的处理方式：

```
Timer timer = new Timer(0, new ActionListener() {

   @Override
   public void actionPerformed(ActionEvent e) {
    updateDialogSize();
   }
});

timer.setDelay(5); // short delay
timer.start(); 
```

更新对话框：

```
void updateDialogSize() {
   Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
   if (dialog.getWidth() < screenSize.getWidth()) { // 1st size width
      dialog.setSize(dialog.getWidth() + 5, dialog.getHeight());
   } else if (dialog.getHeight() < screenSize.getHeight()) { // then size height
     dialog.setSize(dialog.getWidth(), dialog.getHeight() + 5);
   } else {
      timer.stop(); // work done
   }

     dialog.setLocationRelativeTo(myFrame);
} 
```

我将把对话框“收缩”作为练习；）

# php - 使用 CodeIgniter 备份 MySQL 数据库

> ID：14093020
> 
> 赞同：12
> 
> 时间：2012-12-30T17:46:56.753
> 
> 标签：php, mysql, database, codeigniter

我一直在研究 CodeIgniter 附带的用户指南。我对这种方法非常感兴趣`dbutil()`。特别是以下代码行：

```
// Load the DB utility class
$this->load->dbutil();

// Backup your entire database and assign it to a variable
$backup =& $this->dbutil->backup(); 

// Load the file helper and write the file to your server
$this->load->helper('file');
write_file('/path/to/mybackup.gz', $backup); 

// Load the download helper and send the file to your desktop
$this->load->helper('download');
force_download('mybackup.gz', $backup); 
```

它应该备份当前加载的 MySQL 数据库。但不幸的是，它不起作用，我收到以下消息：

> 遇到 PHP 错误
> 
> 严重性：通知
> 
> 消息：未定义的属性：CI_Loader::$dbutil
> 
> 文件名：views/view.php
> 
> 行号：10
> 
> 致命错误：调用第 10 行 C:\xampp\htdocs\CodeIgniter\application\views\view.php 中非对象的成员函数 backup()

我在这里想念什么？任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-31T02:13:46.680

试试这个，如果你愿意，你可以将格式 zip 更改为 gz :)

```
$this->load->dbutil();

$prefs = array(     
    'format'      => 'zip',             
    'filename'    => 'my_db_backup.sql'
    );

$backup =& $this->dbutil->backup($prefs); 

$db_name = 'backup-on-'. date("Y-m-d-H-i-s") .'.zip';
$save = 'pathtobkfolder/'.$db_name;

$this->load->helper('file');
write_file($save, $backup); 

$this->load->helper('download');
force_download($db_name, $backup); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-30T18:18:15.323

使用 php 执行此操作仅适用于非常小的数据库。您将很快遇到内存限制 - 如果您增加其他性能问题。

最有效的是使用 mysqldump 创建转储：

```
header('Content-type: application/force-download');
header('Content-Disposition: attachment; filename="dbbackup.sql.gz"');
passthru("mysqldump --user=xx --host=xx --password=xx dbname | gzip"); 
```

当然，您必须具有执行此操作所需的权限。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-06-30T05:14:27.277

```
//load helpers

$this->load->helper('file');
$this->load->helper('download');
$this->load->library('zip');

//load database
$this->load->dbutil();

//create format
$db_format=array('format'=>'zip','filename'=>'backup.sql');

$backup=& $this->dbutil->backup($db_format);

// file name

$dbname='backup-on-'.date('d-m-y H:i').'.zip';
$save='assets/db_backup/'.$dbname;

// write file

write_file($save,$backup);

// and force download
force_download($dbname,$backup); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-11-16T10:12:31.757

```
public function db_backup()
{
    $this->load->helper('url');
    $this->load->helper('file');
    $this->load->helper('download');
    $this->load->library('zip');
    $this->load->dbutil();
    $db_format=array('format'=>'zip','filename'=>'my_db_backup.sql');
    $backup=& $this->dbutil->backup($db_format);
    $dbname='backup-on-'.date('Y-m-d').'.zip';
    $save='assets/db_backup/'.$dbname;
    write_file($save,$backup);
    force_download($dbname,$backup);

}` 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-02-29T11:29:33.397

```
function backup($fileName='db_backup.zip'){
    // Load the DB utility class
    $this->load->dbutil();

    // Backup your entire database and assign it to a variable
    $backup =& $this->dbutil->backup();

    // Load the file helper and write the file to your server
    $this->load->helper('file');
    write_file(FCPATH.'/downloads/'.$fileName, $backup);

    // Load the download helper and send the file to your desktop
    $this->load->helper('download');
    force_download($fileName, $backup);
} 
```

使用 codeigniter 备份数据库的简单方法

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-12-19T11:08:05.057

我对 CodeIgniter 非常陌生，但我成功地进行了此备份。试试这个，它会成功并且很容易实现。在您的控制器中编写代码并从您的视图页面调用用于备份的函数。准备好，走，你就完成了。

```
function dbbackup()
{
    $this->load->dbutil();   
    $backup =& $this->dbutil->backup();  
    $this->load->helper('file');
    write_file('<?php echo base_url();?>/downloads', $backup);
    $this->load->helper('download');
    force_download('mybackup.gz', $backup);
} 
```

对于完整的应用程序备份，使用以下代码执行相同的过程：

```
function backup()
{
    $this->load->helper('download');
    $this->load->library('zip'); 
    $time = time(); 
    $this->zip->read_dir('D:xampp/htdocs/wms/');
    $this->zip->download('my_backup.'.$time.'.zip');
} 
```

在这里，您可以使用您选择的任何路径。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-12-16T10:10:47.067

试试这个...它已经过测试...如果您要使用 mysqli 那么它会正常工作...您可以将您的代码放在您的控制器或模型中，但我建议将这个保留在 your_model 中并调用它来自 your_controller 的函数...

```
public function db_backup()
{
       $this->load->dbutil();   
       $backup =& $this->dbutil->backup();  
       $this->load->helper('file');
       write_file('your_file_path/your_DB.zip', $backup); 
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-04-24T10:04:22.307

如果您有幸在您的服务器上启用了、或`exec()`之一。也许您想使用以下内容：`shell_exec()``system()``passthru()`

```
public function db_backup()
{
    $DBUSER=$this->db->username;
    $DBPASSWD=$this->db->password;
    $DATABASE=$this->db->database;

    $filename = $DATABASE . "-" . date("Y-m-d_H-i-s") . ".sql.gz";
    $mime = "application/x-gzip";

    header( "Content-Type: " . $mime );
    header( 'Content-Disposition: attachment; filename="' . $filename . '"' );

    // $cmd = "mysqldump -u $DBUSER --password=$DBPASSWD $DATABASE | gzip --best";   
    $cmd = "mysqldump -u $DBUSER --password=$DBPASSWD --no-create-info --complete-insert $DATABASE | gzip --best";

    passthru( $cmd );

    exit(0);
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-08-17T12:35:31.900

$content = 'SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO"; 开始交易；SET time_zone = "+00:00";';

```
 if($tables = $this->db->list_tables()){
        foreach($tables as $table){
            $content .= ' DROP TABLE IF EXISTS `' . $table . '`;';
            $content .= $this->db->query('SHOW CREATE TABLE ' . $table)->row_array()['Create Table'] . ';'; 
            $fields = $this->db->list_fields($table);
            $table_data = $this->db->query('SELECT * FROM ' . $table)->result_array();
            $insert_field = '';
            $insert_values = '';
            if($fields && $table_data){
                $insert_field .= 'INSERT INTO `' . $table . '` (';

                foreach($fields as $field){
                    $insert_field .= '`' . $field . '`,';
                }
                $insert_field = substr($insert_field,0,-1);
                $insert_field .= ')';

                $insert_values .= ' VALUES ';
                foreach($table_data as $table_row){
                    $insert_values .= '(' ;
                    foreach($table_row as $column => $value){
                        $insert_values .= "'" . addslashes($value) . "',";
                    }
                    $insert_values = substr($insert_values,0,-1);
                    $insert_values .= '),';
                }
                $insert_values = substr($insert_values,0,-1) . '; ';
            }
            $content .= $insert_field . $insert_values;
        }
    }
    $file_path = "./uploads/backup-" . date('Y-m-d') . ".sql";
    $myfile = fopen($file_path, "w");
    fwrite($myfile, $content);
    fclose($myfile); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-02-19T10:01:55.200

```
 public function backup(){
    $this->load->dbutil();
    $config = array(     
        'format'      => 'zip',             
        'filename'    => 'insert-file-name.sql'
    );

    $backup =& $this->dbutil->backup($config); 

    $db_name = 'backup-on-'. date("Y-m-d-H-i-s") .'.zip';
    $save = 'uploads/'.$db_name;

    $this->load->helper('file');
    write_file($save, $backup); 
    $this->load->helper('download');
    force_download($db_name, $backup);

} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-12-08T05:36:50.273

问题是您在引导过程中很早就尝试备份数据库。

当我试图破解 CodeIgniter 来备份我的数据库时，我遇到了同样的问题：

```
$prefs = array(
            'ignore'=> array('codes_cdt','codes_cpt','codes_icd10_dx_order','codes_icd10_pcs_order','pharma'),
            'format'=>'gzip','filename','add_drop'=> TRUE,'add_insert'=>TRUE,'newline'=> "\n");

$filename = APPPATH.'\\backups\\' .'backup-' . date('d-m-Y') . ' .gz';
if(!file_exists($filename)){
    get_instance()->load->dbutil();
    file_put_contents( $filename, $this->dbutil->backup($prefs));
} 
```

在我`config.php`文件的底部。

将它移动到模型并允许它自动加载，你会没事的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-06-16T12:25:23.837

尝试这个！

```
$username = "root";
$password = "root";
$hostname = "localhost";
$dbname   = "raas";

header('Content-Description: File Transfer');
header('Content-Type: application/octet-stream');
header('Content-Disposition: attachment; filename='.basename($dbname . "_" .date("Y-m-d_H-i-s").".sql"));

$command = "C:\AppServ\MySQL\bin\mysqldump --add-drop-table --host=$hostname   --user=$username --password=$password ".$dbname;

system($command); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-12-31T08:33:32.227

这些行已从 codeigniters 文档中获取：

> 重要提示：为了初始化实用程序类，您的数据库驱动程序必须已经在运行，因为实用程序类依赖于它。

调用此函数时，请检查您的数据库类是否已加载。或者您可以在加载 dbutil 类之前放置这一行`$this->load->database();`

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-03-18T13:44:39.460

如果要归档数据库，请使用函数 $this->archive_database(); 此函数将 .sql 文件保存在根文件夹中名为 archives 的文件夹中

```
// to intialize the path split the real path by dot .
        public function init_path($string){
            $array_path =  explode('.', $string);
            $realpath  = ''; 
            foreach ($array_path as $p)
            {

                $realpath .= $p;
                $realpath .= '/';
            }
            return $realpath;

        }

        // backup database function         
        public function archive_database($host = '',$user ='',$pass ='',$name ='', $path = '' , $download_allow = false ,       $tables=false, $backup_name=false){ 
            $CI = &get_instance();
            $CI->load->database();
            if($path != '')
            {
                $path = realpath($this->init_path($path));

            }else{
                if (!is_dir('archives/'))
            mkdir('archives/', 0777);
                $path = realpath($this->init_path('archives'));
            }
            if($host == '')
            {
                $host = $CI->db->hostname;

            }
            if($user == '')
            {
                $user = $CI->db->username;

            }
            if($pass == '')
            {
                $pass = $CI->db->password;

            }
            if($name == '')
            {
                $name = $CI->db->database;

            }

            set_time_limit(3000); 
            $mysqli = new mysqli($host,$user,$pass,$name); 
            $mysqli->select_db($name);
            $mysqli->query("SET NAMES 'utf8'");
            $queryTables = $mysqli->query('SHOW TABLES');
            while($row = $queryTables->fetch_row()) { $target_tables[] = $row[0]; } 
            if($tables !== false)
                { $target_tables = array_intersect( $target_tables, $tables); } 
            $content = "SET SQL_MODE = \"NO_AUTO_VALUE_ON_ZERO\";\r\nSET time_zone = \"+00:00\";\r\n\r\n\r\n/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;\r\n/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;\r\n/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;\r\n/*!40101 SET NAMES utf8 */;\r\n--\r\n-- Database: `".$name."`\r\n--\r\n\r\n\r\n";
            foreach($target_tables as $table){
                if (empty($table)){ continue; } 
                $result = $mysqli->query('SELECT * FROM `'.$table.'`');
                $fields_amount=$result->field_count; 
                $rows_num=$mysqli->affected_rows; 
                $res = $mysqli->query('SHOW CREATE TABLE '.$table);
                $TableMLine=$res->fetch_row(); 
                $content .= "\n\n".$TableMLine[1].";\n\n";
                for ($i = 0, $st_counter = 0; $i < $fields_amount;   $i++, $st_counter=0) {
                    while($row = $result->fetch_row())  { //when started (and every after 100 command cycle):
                        if ($st_counter%100 == 0 || $st_counter == 0 )  {$content .= "\nINSERT INTO ".$table." VALUES";}
                            $content .= "\n(";    for($j=0; $j<$fields_amount; $j++){ $row[$j] = str_replace("\n","\\n", addslashes($row[$j]) ); if (isset($row[$j])){$content .= '"'.$row[$j].'"' ;}  else{$content .= '""';}     if ($j<($fields_amount-1)){$content.= ',';}   }        $content .=")";
                        //every after 100 command cycle [or at last line] ....p.s. but should be inserted 1 cycle eariler
                        if ( (($st_counter+1)%100==0 && $st_counter!=0) || $st_counter+1==$rows_num) {$content .= ";";} else {$content .= ",";} $st_counter=$st_counter+1;
                    }
                } $content .="\n\n\n";
            }
            $content .= "\r\n\r\n/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;\r\n/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;\r\n/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;";
            $backup_name = $backup_name ? $backup_name : $name."___(".date('H-i-s')."_".date('d-m-Y').")__rand".rand(1,11111111).".sql";

            $fileLocation = $path .'\\'. $backup_name;
            $file = fopen($fileLocation,"w");
            fwrite($file,$content);
            fclose($file);

            if($download_allow){
            ob_get_clean(); header('Content-Type: application/octet-stream');   header("Content-Transfer-Encoding: Binary"); header("Content-disposition: attachment; filename=\"".$backup_name."\"");
            }

            echo $content; exit;
        } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-01-31T05:15:15.037

```
 <?

// Try this one, this works FOR both codeigniter and core PHP

            public function Export_Database()
                {
                    date_default_timezone_set('GMT');
                   // Load the file helper in codeigniter
                    $this->load->helper('file');

            $con = mysqli_connect("localhost","username","password","databasename");

            $tables = array();
            $query = mysqli_query($con, 'SHOW TABLES');
            while($row = mysqli_fetch_row($query)){
                 $tables[] = $row[0];
            }

            $result = 'SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";';
            $result .= 'SET time_zone = "+00:00";';

            foreach($tables as $table){
            $query = mysqli_query($con, 'SELECT * FROM `'.$table.'`');
            $num_fields = mysqli_num_fields($query);

            $result .= 'DROP TABLE IF EXISTS '.$table.';';
            $row2 = mysqli_fetch_row(mysqli_query($con, 'SHOW CREATE TABLE `'.$table.'`'));
            $result .= "\n\n".$row2[1].";\n\n";

            for ($i = 0; $i < $num_fields; $i++) {
            while($row = mysqli_fetch_row($query)){
               $result .= 'INSERT INTO `'.$table.'` VALUES(';
                 for($j=0; $j<$num_fields; $j++){
                   $row[$j] = addslashes($row[$j]);
                   $row[$j] = str_replace("\n","\\n",$row[$j]);
                if(isset($row[$j])){
                       $result .= '"'.$row[$j].'"' ; 
                    }else{ 
                        $result .= '""';
                    }
                    if($j<($num_fields-1)){ 
                        $result .= ',';
                    }
                }
                $result .= ");\n";
            }
            }
            $result .="\n\n";
            }

            //Create Folder
            $folder = 'database/';
            if (!is_dir($folder))
            mkdir($folder, 0777, true);
            chmod($folder, 0777);

            $date = date('m-d-Y'); 
            $filename = $folder."db_filename_".$date; 

            $handle = fopen($filename.'.sql','w+');
            fwrite($handle,$result);
            fclose($handle);
            redirect('Dashboard');           

                } // end Export_Database function
            ?> 
```

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2015-10-11T08:49:44.287

无需`base_url()`在路径添加

# css - 嵌套表 - 合法吗？

> ID：14093022
> 
> 赞同：0
> 
> 时间：2012-12-30T17:47:02.513
> 
> 标签：css, responsive-design, html-table, semantic-markup

我正在创建一个餐厅菜单，但我不确定是否应该使用表格，尤其是是否应该使用嵌套表格。这是有效的吗？我认为餐厅菜单可以被视为表格数据。

在任何浏览器中使用嵌套表创建结构都非常方便且稳定，但我不知道这是否是正确的方法。这是它的样子：

[http://jsbin.com/ejoqad/1/edit](http://jsbin.com/ejoqad/1/edit)

```
 <table>
    <tr>
      <td>
        <table>
          <tr>
            <td>PIZZA</td>
          </tr>
          <tr>
            <td>onions,cheese</td>
          </tr>
        </table>
      </td>
      <td>3.5 $</td>

    </tr>
  </table> 
```

此外，当我尝试针对不同设备优化设计时，这种结构是否可能会给我带来麻烦？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T17:48:49.660

这当然是有效的，但您可能应该只使用`<br />`而不是整个表来换行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T13:59:09.967

根据[HTML 5 规范](http://www.w3.org/TR/html401/struct/tables.html#h-11.2.6.1)`rowspan`，使用属性可以用更少的标记实现相同的效果。

基本思想是通过将属性设置为整数值，`<td>`元素可以跨越多行或多列（`rowspan`用于行和列）。`colspan`因此，`<td rowspan="2">`是跨越表格两行的单元格。

这些属性存在于 HTML 3.2 中，因此兼容性非常好（我测试回 IE8 没有问题）。

这是更新的 jsbin 供参考：http: [//jsbin.com/ejoqad/5/edit](http://jsbin.com/ejoqad/5/edit)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T14:21:23.427

看起来您的菜单是一个数据表，因此无论布局如何，使用 HTML 表在语义上都是正确的。干得好。但是我不知道为什么你需要使用两个嵌套表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-08T20:27:36.073

HTML 表格用于存储表格数据，例如在矩阵中。

你的菜单可能是一个列表吗？那时它可以使用 uls。与表格相比，布局样式更灵活。

如果您的意图纯粹是呈现表格数据并且在布局中没有任何手段，请执行此操作并尝试稍后对其进行布局：p

如果您打算将其用作布局容器，那么您的想法就错了。我考虑使用表格进行布局的任何情况都是在使用 CSS 时很麻烦，比如具有不同高度的列，或者当我希望没有 JS 的情况下有一些具有静态宽度/高度的区域和中间的一些灵活的区域。

# gradle - 尝试 Gradle 构建 - “在根项目中找不到任务‘构建’”

> ID：14093024
> 
> 赞同：40
> 
> 时间：2012-12-30T17:47:06.893
> 
> 标签：gradle

我刚开始阅读“Pro Spring MVC with web flow”，它附带了一个我想要遵循的代码示例。

*   **我想要什么**- 我想按照书中所做的那样构建应用程序，使用`Gradle`
*   **有什么问题**- 我以前从未使用`Gradle`过，当我尝试执行我认为我必须执行的操作时，我得到了这个错误`Task 'build' not found in root project`
*   **到目前为止我做了什么**- 昨天我`Gradle`从官方网站下载并让它工作。今天，当我实际尝试执行书中的步骤时，结果发现示例代码带有它自己的 Gradle 发行版，我执行了它，我认为这是为了获得 Gradle 的第二个发行版。但是，我不知道这是否是一个问题。现在我的示例代码目录如下所示： ![在此处输入图像描述](../Images/e565c708274bc0e3646f719862d0cd4d.png)

然后写到我必须执行`../gradlew build`我这样执行并得到以下内容： ![在此处输入图像描述](../Images/308514e5854197899b60b633c7c0ce30.png)

*   **我试过什么**- 我唯一想到的就是只留下 Gradle 的东西和`appendixA-bookstore`文件夹，以防 Gradle 将所有目录识别为不同的构建但没有成功。
*   **我想要完成的最终结果是什么**- 首先我想弄清楚我的错误在哪里以及如何构建示例应用程序。如果我真的可以从我`Gradle`昨天写的第一个设置中做到这一点，那将是完美的，我应该怎么做才能将这个示例代码与我的新鲜和原始 Gradle 设置一起使用？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-30T17:54:57.377

你没有做你被要求做的事情。

问什么：

> 我必须执行 ../gradlew build

你做什么

```
cd ..
gradlew build 
```

那不是一回事。

第一个将使用在`..`目录（`mdeinum...`）中找到的 gradlew 命令，并在当前目录（例如）中查找要执行的构建文件`chapter1-bookstore`。

第二个将执行在当前目录（`mdeinum...`）中找到的 gradlew 命令，并在当前目录中查找要执行的构建文件，即`mdeinum...`.

所以执行的构建文件是不一样的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2018-02-05T07:29:53.973

跑

```
gradle clean 
```

然后尝试

```
gradle build 
```

它对我有用

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-12-12T11:28:31.197

检查您的文件：`settings.gradle`包含子项目的存在行（例如： include `chapter1-bookstore` ）

# iphone - 添加飞艇进行推送后代码失败

> ID：14093028
> 
> 赞同：0
> 
> 时间：2012-12-30T17:47:20.610
> 
> 标签：iphone, xcode

我的代码因以下错误而失败：“Clang failed with exit code 1”

这是错误截图

![错误截图](../Images/9077c2b0b66f9d8312662b0ece7ac11e.png)

我认为这是因为我添加了 AirShip，但是在我删除了它的所有组件并注释掉了所有方法之后，它仍然给我这个错误。

有人有什么想法吗？

# vb.net - 如何使 DataTable 只读？

> ID：14093029
> 
> 赞同：2
> 
> 时间：2012-12-30T17:47:21.860
> 
> 标签：vb.net, ado.net, sqlclient

我正在编写一个返回 DataTable 对象的函数。我正在使用`DataTable.Load( DataReader)`来填充 DataTable。但是，据我了解，虽然底层 DataReader 是 ReadOnly，Forward-only；一旦它被加载到数据表中；其他程序员仍然可以通过`DataTable.Rows(x).Column(y).ReadOnly = False`然后设置值来更新数据。

是否可以确保我的函数返回的 DataTable 是只读的？在较早的 ADODB 时代，我使用 ADODB.LockTypeEnum 将返回的记录集标记为只读。

只读，我的意思是我的函数的调用者（获取返回的 DataTable）不能对行数据进行更改和/或根本更新它（即只读）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:03:47.817

> 是否可以确保我的函数返回的 DataTable 是只读的？

不，通常没有这样的方法或方式使其只读。与`DataView`which 具有[`AllowEdit`](http://msdn.microsoft.com/en-us/library/system.data.dataview.allowedit.aspx)用于此目的的属性不同（因此您可以返回 DataView ）。

我看到避免更改表的唯一方法是：尝试处理[`RowChanged`](http://msdn.microsoft.com/en-us/library/system.data.datatable.rowchanged%28v=vs.110%29.aspx)事件并[`RejectChanges`](http://msdn.microsoft.com/en-us/library/system.data.datarow.rejectchanges.aspx)随后调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-13T14:02:16.617

另一种防止调用者破坏您的内部 DataTable（或 DataSet）的方法是返回一个副本。DataSet 和 DataTable 类都有一个 Copy() 方法，可以复制原始的结构和数据。

显然，这对于包含相对少量数据的 DataTable 会更好。

# android - 谷歌地图 API 密钥

> ID：14093030
> 
> 赞同：0
> 
> 时间：2012-12-30T17:47:33.437
> 
> 标签：android, google-maps, google-maps-api-2

我是android开发的新手。我想知道自 2012 年 12 月 3 日起，Google Map API v1 密钥是否已被弃用？如果是这样，Google Map API v2 密钥将与 android ver 兼容。2.3.3（姜饼）？因为我正在 Gingerbread ver 上开发 android 应用程序。v1 密钥可以在 v2 密钥中使用吗？

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T17:49:41.497

> 我想知道自 2012 年 12 月 3 日起，Google Map API v1 密钥是否已被弃用？

您的 Maps V1 密钥应该可以无限期使用。自 2013 年 3 月 3 日起，您将无法获得新的 Maps V1 密钥。

> 如果是这样，Google Map API v2 密钥将与 android ver 兼容。2.3.3（姜饼）？

Maps V2 可在许多 Android 2.3.3 设备上运行，这些设备支持 OpenGL ES 2.0 并具有 Google Play 服务应用程序（通过 Play 商店获得）。

> v1 密钥可以在 v2 密钥中使用吗？

Maps V1 密钥仅适用于 Maps V1。Maps V2 密钥仅适用于 Maps V2。

# jquery - 在锚点单击时显示/隐藏多个 div

> ID：14093031
> 
> 赞同：1
> 
> 时间：2012-12-30T17:47:39.800
> 
> 标签：jquery, show-hide

单击锚点时，我需要显示/隐藏 3 个单独的 div 的内容。

标记如下所示： *Div 1*

```
<div class="media pull-left">
    <img src="img.jpg" />
</div>
<div class="media pull-left is-hidden">
    <img src="img.jpg" />
</div> 
```

*第 2 部分*

```
<div class="media-aside pull-right">
    <h4>heading 4</h4>
    <p>Text...</p>
    <p class="call-to-action"><a href="someurl">url</a></p>
</div>
<div class="media-aside pull-right is-hidden">
    <h4>heading 4</h4>
    <p>Paragraph...</p>
    <p class="call-to-action"><a href="someurl">url</a></p>
</div> 
```

*第 3 部分*

```
<div class="media-thumb ">
    <img src="thumb.jpg" />
    <p><a href="#">Link 1</a></p>
</div>
<div class="media-thumb is-hidden">
    <img src="thumb.jpg" />
    <p><a href="#">Link 2</a></p>
</div> 
```

jQuery 看起来像这样：

```
$('.media-thumb a').click(function(){
    $(this).parent().parent().find('is-hidden').toggle();
    return false;
}); 
```

本质上，我想`is-hidden`从应用它的 div 中删除该类并将其添加到其他类中，从而在单击锚点时有效地打开和关闭内容。

我怎样才能扩展上面的代码来做我需要的事情？

提前致谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T17:55:54.967

您的遍历方法和选择器一样不正确`is-hidden`（类缺少点前缀）

`find()`在元素内搜索，但您想要元素本身

下面将介绍`<a>`标签点击的情况。目前尚不清楚您希望对具有`is-hidden`类的其他元素采取什么行为。显然，如果它是隐藏的，你就不能点击它

尝试这个

```
$('.media-thumb a').click(function(){
   /* if wanting to remove "is-hidden" from all others*/
    $('.is-hidden').removeClass('is-hidden').show();
   /* hide this one*/
   $(this).closest('.media-thumb').addClass('is-hidden').hide();

    return false;
}); 
```

`closest()`将查找树，直到找到选择器。比干净`parent().parent()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T17:52:32.620

您可以使用选择器：可见，例如。

```
$('div:visible').addClass('is-hidden') 
```

# performance - 缓冲传输本质上是否比使用 WCF 流式传输慢？

> ID：14093032
> 
> 赞同：0
> 
> 时间：2012-12-30T17:47:44.063
> 
> 标签：performance, wcf, streaming, buffering

因此，在过去，当我在开发文件传输应用程序时，我使用流式传输，而且我似乎能够至少在本地机器之间快速传输文件。

尽管文件非常大，超过 4GB（我希望任何文件大小都是可能的，从小到大），但我遇到了问题，并且需要考虑将文件分成更小的块。所以现在我正在处理我的程序的不同化身，并让它成功地将一个大文件分割成由特定块大小（在本例中为 4MB）指定的块。

我通过回调方法将这些文件传输到客户端，但与流式传输相比，传输似乎需要很长时间。

WCF 中是否有某些设置可以真正提高消息传输的性能，或者某些设置可能会阻碍我的性能？

```
 public void RequestFile()
    {
        IFileTransferCallback callback = OperationContext.Current.GetCallbackChannel<IFileTransferCallback>();

        while (chunkedFile.MoreChunks)
        {
            callback.ReceiveFile(chunkedFile.NextChunk(), chunkedFile.MoreChunks);
        }

        host.Close();
    } 
```

这些是我现在正在使用的绑定设置。有些只是随意设置。

```
 NetTcpBinding binding = new NetTcpBinding(SecurityMode.None, true);
        binding.MaxBufferPoolSize = int.MaxValue;
        binding.ReaderQuotas.MaxDepth = int.MaxValue;
        binding.ReaderQuotas.MaxStringContentLength = int.MaxValue;
        binding.ReaderQuotas.MaxArrayLength = int.MaxValue;
        binding.ReaderQuotas.MaxBytesPerRead = int.MaxValue;
        binding.ReaderQuotas.MaxNameTableCharCount = int.MaxValue;
        binding.MaxBufferSize = int.MaxValue;
        binding.MaxConnections = 500;
        binding.MaxReceivedMessageSize = int.MaxValue;
        binding.TransferMode = TransferMode.Buffered;
        binding.SendTimeout = new TimeSpan(0, 5, 0);
        binding.ReceiveTimeout = new TimeSpan(0, 5, 0);
        BindingElementCollection collection = binding.CreateBindingElements();
        collection.Add(new MtomMessageEncodingBindingElement());

        UnityContainer.RegisterInstance(typeof(Binding), binding); 
```

**编辑：**

我一直在尝试各种选择以提高速度。当我运行服务器 localhost 时，它可以在几秒钟内完成一个 700mb 的文件，显然......但是当我使用我的外部 IP 执行它时，它需要相当长的时间，比我的 15mbps 上传速度要长得多。

这是怎么回事？WCF 的速度是否有硬性上限？如何解锁？当然，它可以比现在更快。老实说，我无法说出我的数据传输速度有多快，因为我还不知道如何计算它，但它可能在 250kbps 左右或更低。

**第二次编辑：**

我再次建立了一个流媒体系统，但利用了我的块。所以我正在流式传输整个较大文件的块。

通过 Internet 上的 64mb 块，我在 11 分 30 秒内向自己传输了一个 862mb 的文件。我的最大下载速度为 25mbps，上传速度约为 5mbps。我认为这很不错。

很遗憾，我无法通过缓冲流模式达到这些速度。

为什么是这样？为什么会有这样的限制？为什么流媒体的速度如此之快？

**更多信息**

将块大小从 64 减小到 8，然后减小到 4，最后减小到 2，产生了越来越快的结果，对于 2mb 的块大小，**在 2 分钟内传输了 862mb的文件。**使用缓冲传输模式，我永远无法获得这样的结果。

# sencha-touch - Sencha Touch 配置文件 - 实例化视图时如何使用

> ID：14093037
> 
> 赞同：0
> 
> 时间：2012-12-30T17:48:30.690
> 
> 标签：sencha-touch, sencha-touch-2

我目前有 2 个配置文件：平板电脑和手机。每个配置文件在不同的视图中加载，如下所示：

```
Ext.define('Myapp.view.tablet.Login', {
    extend: 'Ext.Panel',
    alias: 'widget.loginview',
    ...
} 
```

但是在应用程序引导代码中，我有以下几行：

```
 var loginView = Ext.create('MyApp.view.Login')
 Ext.Viewport.add(loginView); 
```

这不起作用，因为我的观点现在按个人资料划分。我现在如何请求配置文件加载的登录视图？我不想这样做：

```
 var loginView = Ext.is.os.Phone? Ext.create('MyApp.view.phone.Login') : Ext.create('MyApp.view.tablet.Login') 
```

因为我认为这是拥有个人资料的全部意义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T18:14:11.583

这不是您应该检测配置文件的方式。

看看我的答案：[为不同的配置文件加载不同的视图](https://stackoverflow.com/questions/13499431/loading-different-views-for-different-profiles/13500602#13500602)

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-19T14:03:02.343

您可能应该在配置文件中定义依赖于活动配置文件的所有视图。典型的简单配置文件如下所示：

```
Ext.define('yourapp.profile.Phone', {
    extend: 'Ext.app.Profile',
    config: {
        name: 'Phone',
        controllers: ['YourController'],
        views: ['Login'] // the MyApp.view.phone.Login view will be used if Phone profile is active
    },
    isActive: function() {
        return Ext.os.is('Phone');
    }
} 
```

# ajax - component.namingContainer.parent 跳过 h:form

> ID：14093039
> 
> 赞同：1
> 
> 时间：2012-12-30T17:48:47.220
> 
> 标签：ajax, jsf-2, composite-component, naming-containers

我做了一个复合组件，里面是一个<f:ajax>标签，它的“render”属性是cc的一个参数。

像这样的东西：

```
 ...
    <cc:attribute name="additionalAjaxRenderIds" type="java.lang.String"></cc:attribute>
    ...
    <h:commandLink value="test" action="#{myBean.someAction}" id="testLink" >
        <f:ajax execute="@this" render="#{cc.attrs.additionalAjaxRenderIds} "/>
    </h:commandLink>
    ... 
```

我在一个表单中使用这个 cc，那已经在一个外部命名容器中：

```
 <h:form id="myForm">
        ...
        <mycomp:myComponent id="myCC" additionalAjaxRenderIds=":#{component.namingContainer.parent.clientId}:myPanel" />
        <h:panelGroup id="myPanel">
            ...
        </h:panelGroup>
        ...
    </h:form> 
```

问题是，如果我写

```
additionalAjaxRenderIds=":#{component.namingContainer.clientId}:myPanel" 
```

我收到此错误：

```
<f:ajax> contains an unknown id ':j_idt44:myForm:myCC:myPanel' - cannot locate it in the context of the component testLink 
```

而如果我使用这个（+ .parent）：

```
additionalAjaxRenderIds=":#{component.namingContainer.parent.clientId}:myPanel" 
```

错误是：

```
<f:ajax> contains an unknown id ':j_idt44:myPanel' - cannot locate it in the context of the component testLink 
```

而不是预期的ID：

```
':j_idt44:myForm:myPanel' 
```

所以看起来我的cc命名容器的父级不是表单，而是外部命名容器

有什么办法：1，获得正确的父（表单）2，在我将EL作为参数传递之前评估EL（所以我可以将计算出的clientId传递给我的cc而不是EL表达式，所以组件不会引用到 commandLink 标签，但到 h:form 我把我的抄送）

我知道我可以使用

```
additionalAjaxRenderIds=":#{component.namingContainer.parent.clientId}:myForm:myPanel" 
```

但我不喜欢那个解决方案

此外，将表单的 prependId 属性设置为 false 会破坏整个组件的查找（结果也会导致 ajax 标记）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T19:01:54.760

EL 表达式不会在构建组件时评估，而是在访问属性时评估。换句话说，它们是*runtime*而不是*buildtime*。是`#{component}`指评估 EL 表达式时的*当前*UI 组件，在您的特定情况下是`<h:commandLink>`. 这解释了不同的结果。

您需要以不同的方式处理此问题，而不使用`#{component}`.

例如

```
<h:form id="myForm" binding="#{myForm}">
    ...
    <mycomp:myComponent id="myCC" additionalAjaxRenderIds=":#{myForm.clientId}:myPanel" />
    <h:panelGroup id="myPanel">
        ...
    </h:panelGroup>
    ...
</h:form> 
```

或者

```
<h:form id="myForm">
    ...
    <mycomp:myComponent id="myCC" additionalAjaxRenderIds=":#{myPanel.clientId}" />
    <h:panelGroup id="myPanel" binding="#{myPanel}">
        ...
    </h:panelGroup>
    ...
</h:form> 
```

# java - android/eclipse 没有打开

> ID：14093043
> 
> 赞同：2
> 
> 时间：2012-12-30T17:49:01.473
> 
> 标签：java, android, eclipse

android/eclipse 在点击时没有打开`eclipse.exe`。我从其站点下载了完整的 android SDK，文件或包名称为`adt-bundle-windows-x86_64.zip`. 提取文件后，有两个文件夹（eclipse 和 sdk with sdk manager）。当我打开 Eclipse 时，它​​会显示一个 java 错误 ( `A java Runtime environment(JRE) or Java Development Kit (JDK) must be available inorder to run Eclipse. No java virual machine was found after searching the following locations: F"\android\adt-bundle-windows-x86_64\eclipse\jre\bin\javaw.exe javaw.exe in your current PATH`)
，但另一个 eclipse(juno) 不会显示它轻松运行的错误。我卸载了java并重新安装它但仍然相同，并且还从c驱动器（c:)卸载了以前的android sdk管理器，但仍然出现同样的问题。请给我解决方案，以便我可以开发应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T17:57:05.243

尝试添加 JAVA_HOME 环境变量（控制面板->系统->高级系统设置->环境变量...）：

JAVA_HOME - c:\Program Files (x86)\Java\jdk1.7.0_06 （如果您的JDK位于不同的地方，请正确更改）

您还可以在 Eclipse.ini 文件中的 Eclipse 文件夹中定义 JVM：-vm c:/jre/bin/javaw.exe 请参见：wiki.eclipse.org/Eclipse.ini

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-18T11:31:35.280

我绝不是专家，我不会假装是。我遇到了同样的问题，并且一直在努力寻找解决方案几个小时。如果未安装 Java Development Kit，则无法在 eclipse.ini 文件的 Eclipse 文件夹中定义 JVM，因此假设您尚未安装 JDK。

我只是从 Oracle 的网站下载并安装了 Java 开发工具包，瞧，它工作了，它完全忽略了 eclipse.ini 文件（所以假设它确实如此，但这就是我放入的内容：“ **-vm C:\Program Files (x86 )\Java\jre7\bin\javaw** " - 没有引号)。我真的认为没有必要在该文件中包含任何内容，因为我之后删除了所有内容并且它仍然有效。

这是下载链接：[http ://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html](http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html)

我希望我至少帮助了一个人。祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-11T02:42:59.723

我所做的是卸载我拥有的 Java (JDK) 版本，并在 Oracle[网站 http://www.oracle.com/technetwork/java/javase/downloads/index.html](http://www.oracle.com/technetwork/java/javase/downloads/index.html)下载了最后一个版本。只有这个 Eclipse 才停止给我这个错误，它工作得很好

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-31T06:55:16.380

这实际上发生在我身上。我通过这样做解决了这个问题。

1.  下载 JRE 32 位版本
2.  安装在相关路径（adt-bundle-windows-x86_64\eclipse\jre）

而已。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-30T19:44:10.143

有同样的问题并通过从其官方站点下载 Eclipse Classic 解决了它，然后从（[此处](http://dl.google.com/android/installer_r21.0.1-windows.exe)）下载并安装 Android SDK，然后按照在 Android Dev 上安装 ADT 插件的教程（[此处](http://developer.android.com/sdk/installing/installing-adt.html)）进行操作。

SDK 安装应该会自动找到 JDK。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-25T19:46:49.947

需要指定jdk的位置让eclipse找到。在 eclipse 目录中，运行以下命令： eclipse -vm C:\jdk1.7.0_11\jre\bin\javaw 我的 jdk 版本是 1.7.0_11。您在上面的命令中指定您的版本。

# c - PThreads：核心与线程

> ID：14093045
> 
> 赞同：2
> 
> 时间：2012-12-30T17:49:03.670
> 
> 标签：c, parallel-processing, pthreads

我正在使用一个复杂的 C 代码，它通过 posix 线程具有并行支持。它是在超线程存在之前编写的。

我在 Macbook i5（2 核 4 线程）上运行代码。由于代码在强制在 4 个线程上运行时存在各种 malloc 错误等，但在 2 个线程上很好，这让我产生了疑问：**您是否需要专门的编程来启用并行 pthread 代码以支持超线程？**

由于我对 pthreads 完全一无所知，我假设它会自动检测可用线程的数量并运行良好，而不是仅使用物理内核的数量正确运行。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T17:51:57.667

不，您的用户代码不需要特殊支持。操作系统为您隐藏了所有差异。

如果在增加线程数时代码运行不正常，则说明存在错误。

# vb.net - 如何检测鼠标点击

> ID：14093051
> 
> 赞同：1
> 
> 时间：2012-12-30T17:49:29.880
> 
> 标签：vb.net, class, events, click

正如标题所示，我正在寻找一种检测鼠标点击的方法。我并不*完全*愚蠢，但在这种情况下我不能使用事件。为什么？因为使用它的函数完全在另一个类中。（而且我完全不知道如何将一个子程序放在一个类和一个事件中`e`，，，一起）

那么究竟如何检测子内的鼠标点击呢？这是用于 Windows 编程的。如果您正在寻找一些代码：

```
Public Class Ball
    Public Sub ResetBall() 
       MainForm.GFX.drawstring("Click to continue", Main.GameFont, Brushes.Orange, 300, 290) 
'Here! How do I detect a click here? D:
    End Sub
End Class 
```

谢谢

编辑：我找到了一个可能的解决方案：

```
 AwaitingClick = True
    Main.TmrMain.Stop()
    Main.TmrTime.Stop()

    Main.GFX.DrawString("Click to continue", Main.GameFont, Brushes.Orange, 300, 290)
    Main.Invalidate()
  'How do I stop the program from continuing? D:
    Main.TmrMain.Start()
    Main.TmrTime.Start() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T21:25:24.940

这是一个 WinForm 项目吗？如果是这样，您不能“停止程序继续运行”，直到发生鼠标单击，因为 UI 在单个线程上运行。如果您让 UI 线程忙，它将无法检测和处理点击。

在任何情况下，您都需要摆脱过程式编程技术，并开始以事件驱动的方式重新思考您的设计。如果您需要显示一个按钮或标签并等待它被单击然后再继续，您只需显示按钮或标签，然后将其余代码放入该控件的单击事件处理程序中。

# php - 如何打印从 PHP 中的函数返回的数组的所有元素？

> ID：14093052
> 
> 赞同：2
> 
> 时间：2012-12-30T17:49:31.703
> 
> 标签：php, sql, arrays, return, echo

我有一个函数可以根据 sql 查询将一些行提取到数组中。该数组是从函数返回的，如何遍历返回数组的所有元素？我是 PHP 初学者。

```
function get_user_wants($user_id)
{
$query=mysql_query("select product_id from user_wishlist where user_id= $user_id");
return mysql_fetch_assoc($query);
}

$out=get_user_wants($user_id);
print_r($out); 
```

它只打印第一个元素或第一条记录！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T17:52:34.373

尝试这样的事情：

```
$sql = "select product_id from user_wishlist where user_id= $user_id";
$res = mysql_query($sql) or die("FAIL: $sql BECAUSE: " . mysql_error());;
while ($row = mysql_fetch_assoc($res))
{
    print_r($row);
} 
```

如果你还没有注意到它，有人会因为使用 MySQL 而不是 MySQLI 或 PDO 等不同的东西而对你大发雷霆。不要让他们打扰你。这里的要点是您的查询可能返回许多行，并且您需要某种迭代器来检索所有行，以便您的脚本可以处理它们。

在本例中，每个 $row 数组中都会有一个 product_id 元素。一旦您看到 print_r() 函数的输出，您可能会很明显如何更改代码。这可能是你想要的（我认为）。

```
function get_user_wants($user_id)
{
    $sql = "select product_id from user_wishlist where user_id= $user_id";
    $res = mysql_query($sql) or die("FAIL: $sql BECAUSE: " . mysql_error());;
    while ($row = mysql_fetch_assoc($res))
    {
        $out[] = $row['product_id'];
    }
    return $out;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T17:54:04.147

您正在返回单个调用的结果，`mysql_fetch_assoc()`因此您只会得到第一行。

循环它们以创建一个多维数组，然后返回：

```
function get_user_wants($user_id)
{
    $query=mysql_query("select product_id from user_wishlist where user_id= $user_id");
    $rows = array();
    while($row = mysql_fetch_assoc($query))
    {
         $rows[] = $row;
    }
    return $rows;
} 
```

现在您可以使用以下命令循环它们`foreach`：

```
$list = get_user_wants(99);
foreach($list as $product)
{
    print_r($product);
} 
```

* * *

旁注：该`mysql_*`库已弃用，建议升级到 MySQLi 或 PDO。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T17:54:09.680

你不能。该函数仅返回第一个结果。并且没有更多信息。

所以你需要返回一些不同的东西，例如结果资源：

```
function get_user_wants($user_id)
{
    $query = mysql_query("select product_id from user_wishlist where user_id= $user_id");

    return $query;
} 
```

然后，您可以对其进行迭代：

```
$result = get_user_wants($user_id);

while ($out = mysql_fetch_assoc($result))
{
    print_r($out):
} 
```

一个更好的方法是将结果包装在一个迭代器中：

```
function get_user_wants($user_id)
{
    $query = mysql_query("select product_id from user_wishlist where user_id= $user_id");

    return new MySqlResult($query);
}

$result = get_user_wants($user_id);

foreach ($result as $out)
{
    print_r($out):
} 
```

这样的结果迭代器可能如下所示：

```
/**
 * MySql Result Set - Array Based
 */
class MySqlResult implements Iterator, Countable
{
    private $result;
    private $index = 0;
    private $current;

    public function __construct($result)
    {
        $this->result = $result;
    }

    public function fetch($result_type = MYSQL_BOTH)
    {
        $this->current = mysql_fetch_array($this->result, $result_type);
        return $this->current;
    }

    /**
     * Return the current element
     * @link http://php.net/manual/en/iterator.current.php
     * @return array
     */
    public function current()
    {
        return $this->current;
    }

    public function next()
    {
        $this->current && $this->fetch();
    }

    /**
     * Return the key of the current element
     * @link http://php.net/manual/en/iterator.key.php
     * @return mixed scalar on success, or null on failure.
     */
    public function key()
    {
        return $this->current ? $this->index : null;
    }

    /**
     * Checks if current position is valid
     * @link http://php.net/manual/en/iterator.valid.php
     * @return boolean The return value will be casted to boolean and then evaluated.
     * Returns true on success or false on failure.
     */
    public function valid()
    {
        return (bool)$this->current;
    }

    /**
     * Rewind the Iterator to the first element
     * @link http://php.net/manual/en/iterator.rewind.php
     * @return void Any returned value is ignored.
     */
    public function rewind()
    {
        $this->fetch();
    }

    /**
     * Count of rows.
     *
     * @link http://php.net/manual/en/countable.count.php
     * @return int The count of rows as an integer.
     */
    public function count()
    {
        return mysql_num_rows($this->result);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T17:51:33.513

尝试

```
foreach ($out as $key=>$value) 
  echo "$key: $value<br>"; 
```

作为起点。

# excel - Arrayist 对象的 Removerange 方法未删除值

> ID：14093056
> 
> 赞同：-2
> 
> 时间：2012-12-30T17:50:18.453
> 
> 标签：excel, vbscript, vba

**编辑**

```
Option Explicit

Dim ParentArr : ParentArr = Array("47266943","UPDATE/ENABLE SUPPLIER ADDRESS - Water","F48471101","ASHLAND INDUSTRIES EUROPE GMBH","Tier 4 Review","Bihacker, Zoltán Árpád",
"9/4/12 3:34 AM","9/25/12 3:06 PM","Closed",
"Water and Process Technologies/Direct - Chemicals/Europe - United Arab Emirates","47266943",
"Return to Requestor (Update/Enable WF) - Water","09/04/2012 04:59:36 AM","Bihacker, Zoltán Árpád","Bihacker, Zoltán Árpád",
"Return to Requestor (Update/Enable WF) - Water","09/06/2012 08:29:34 AM","Bihacker, Zoltán Árpád","Bihacker, Zoltán Árpád",
"Requestor Provides Business Specific Supplier Details - Update/Enable Supplier","09/04/2012 03:34:32 AM","Bihacker, Zoltán Árpád","Bihacker, Zoltán Árpád",
"Requestor Provides Supplier Details - Update/Enable Supplier","09/04/2012 03:40:22 AM","Bihacker, Zoltán Árpád",
"Bihacker, Zoltán Árpád","VMH All Fields Review  (Req. Provides Supplier Details) - Update/Enable Supplier","09/11/2012 01:43:53 AM",
"Karve, Vinod","Karve, Vinod","VMH All Fields Review  (Req. Provides Supplier Details) - Update/Enable Supplier","09/04/2012 04:59:36 AM",
"Karve, Vinod","Karve, Vinod","VMH All Fields Review  (Req. Provides Supplier Details) - Update/Enable Supplier","09/06/2012 08:29:34 AM",
"Karve, Vinod","Karve, Vinod","Sourcing Final Review of Supplier Self-Serve - Update/Enable Supplier","09/17/2012 08:59:36 AM",
"Karve, Vinod","Karve, Vinod","Sourcing Final Review of Supplier Self-Serve - Update/Enable Supplier","09/19/2012 08:29:34 AM","Karve, Vinod",
"Karve, Vinod","Sourcing Final Review of Requestor Provided Details - Update/Enable Supplier","09/11/2012 04:52:28 PM","Vekemans, Ilse",
"Vekemans, Ilse","Sourcing Final Review of Requestor Provided Details - Update/Enable Supplier","09/18/2012 08:59:36 AM","Karve, Vinod",
"Karve, Vinod","Sourcing Final Review of Requestor Provided Details - Update/Enable Supplier","09/20/2012 08:29:34 AM","Karve, Vinod",
"Karve, Vinod","Resend Supplier Survey - Update/Enable Supplier","09/26/2012 08:29:34 AM","Karve, Vinod","Karve, Vinod",
"Resend Supplier Survey - Update/Enable Supplier","09/24/2012 08:59:36 AM","Karve, Vinod","Karve, Vinod",
"Supplier Starts Survey - Update/Enable Supplier","09/25/2012 08:59:36 AM","Karve, Vinod","Karve, Vinod",
"Supplier Starts Survey - Update/Enable Supplier","09/27/2012 08:29:34 AM","Karve, Vinod","Karve, Vinod",
"Supplier Completes Survey - Update/Enable Supplier","11/08/2012 08:29:34 AM","Karve, Vinod","Karve, Vinod",
"Supplier Completes Survey - Update/Enable Supplier","11/06/2012 08:59:36 AM","Karve, Vinod","Karve, Vinod",
"VMH All Fields Review of Supplier Survey - Update/Enable Supplier","1/07/2012 08:59:36 AM","Karve, Vinod","Karve, Vinod",
"VMH All Fields Review of Supplier Survey - Update/Enable Supplier","11/09/2012 08:29:34 AM","Karve, Vinod","Karve, Vinod",
"Sourcing Review of Supplier Survey - Update/Enable Supplier","11/13/2012 08:59:36 AM","Karve, Vinod","Karve, Vinod",
"Sourcing Review of Supplier Survey - Update/Enable Supplier","11/15/2012 08:29:34 AM","Karve, Vinod","Karve, Vinod",
"Sourcing Quality Review of Supplier Survey - Update/Enable Supplier","11/14/2012 08:59:36 AM","Karve, Vinod",
"Sourcing Quality Review of Supplier Survey - Update/Enable Supplier","09/12/2012 02:41:01 AM","Schreurs, Rene","Schreurs, Rene",
"Sourcing Quality Review of Supplier Survey - Update/Enable Supplier","11/16/2012 08:29:34 AM","Karve, Vinod","Karve, Vinod",
"Finance Review of Supplier Survey - Update/Enable Supplier","09/21/2012 08:30:17 AM","Bruck, Barbara","Bruck, Barbara",
"Finance Review of Supplier Survey - Update/Enable Supplier","11/15/2012 08:59:36 AM","Karve, Vinod","Karve, Vinod",
"Finance Review of Supplier Survey - Update/Enable Supplier","11/19/2012 08:29:34 AM","Karve, Vinod","Karve, Vinod",
"Activate / Create supplier in business system - Update/Enable Supplier","11/16/2012 08:59:36 AM","Karve, Vinod","Karve, Vinod",
"Activate / Create supplier in business system - Update/Enable Supplier","11/20/2012 08:29:34 AM","Karve, Vinod","Karve, Vinod",
"Activate / Create supplier in business system - Update/Enable Supplier","09/24/2012 04:01:28 AM","Goud, Siddhartha","Goud, Siddhartha")

Dim VMHArray : VMHArray = Array("VMH All Fields Review - Add Supplier  Emergency","VMH All Fields Review  (Req. Provides Supplier Details) - Update/Enable Supplier","VMH Triggered Final Sourcing Review - Add Address_Direct","Activate / Create supplier in business system - Add Address","Activate / Create supplier in Business System - Add Supplier","Activate / Create supplier in Business System - Add Supplier Emergency","Activate / Create supplier in business system - Update/Enable Supplier","Resend Supplier Survey - Add Address","Resend Supplier Survey - Add Supplier","Resend Supplier Survey - Add Supplier","Resend Supplier Survey - Update/Enable Supplier","SSS BTP Team – Add Address","SSS BTP Team – Update/Enable Supplier","SSS BTP Team E","SSS BTP Team S","SSS BTP Team-Update/Activate Supplier ","VMH All Fields Review (Req. Provides Supplier Details) - Update/Enable Supplier","VMH All Fields Review - Add Address","VMH All Fields Review - Add Supplier","VMH All Fields Review - Add Supplier Emergency","VMH All Fields Review of Supplier Survey - Add Address","VMH All Fields Review of Supplier Survey - Add Supplier","VMH All Fields Review of Supplier Survey - Add Supplier Emergency","VMH All Fields Review of Supplier Survey - Update/Enable Supplier","VMH Bank Review - Edit Supplier/Address_Direct","VMH Bank Review - Push To Downstream","VMH Edit Supplier/Address_Direct","VMH Inputs Supplier Details - Add Address_Direct","VMH Inputs Supplier Details - Add Supplier_Direct","\VMH Triggered Final Sourcing Review - Add Address_Direct","Activate / Create supplier in business system - Add Address","Activate / Create supplier in Business System - Add Supplier","Activate / Create supplier in Business System - Add Supplier Emergency","Activate / Create supplier in business system - Update/Enable Supplier","Resend Supplier Survey - Add Address","Resend Supplier Survey - Add Supplier","Resend Supplier Survey - Add Supplier","Resend Supplier Survey - Update/Enable Supplier","SSS BTP Team – Add Address","SSS BTP Team – Update/Enable Supplier","SSS BTP Team E","SSS BTP Team S","SSS BTP Team-Update/Activate Supplier ","VMH All Fields Review (Req. Provides Supplier Details) - Update/Enable Supplier","VMH All Fields Review - Add Address","VMH All Fields Review - Add Supplier","VMH All Fields Review - Add Supplier Emergency","VMH All Fields Review of Supplier Survey - Add Address","VMH All Fields Review of Supplier Survey - Add Supplier","VMH All Fields Review of Supplier Survey - Add Supplier Emergency","VMH All Fields Review of Supplier Survey - Update/Enable Supplier","VMH Bank Review - Edit Supplier/Address_Direct","VMH Bank Review - Push To Downstream","VMH Edit Supplier/Address_Direct","VMH Inputs Supplier Details - Add Address_Direct","VMH Inputs Supplier Details - Add Supplier_Direct","VMH Supplier Validation - Add Address","VMH Supplier Validation - Add Supplier","VMH Supplier Validation - Update/Enable Supplier","VMH Triggered Final Sourcing Review - Edit Supplier/Address_Direct","VMH Watchlist Review - Add Address","VMH Watchlist Review - Add Address_Direct","VMH Watchlist Review - Add Supplier","VMH Watchlist Review - Add Supplier_Direct","VMH Supplier Validation - Add Supplier","VMH Supplier Validation - Update/Enable Supplier","VMH Triggered Final Sourcing Review - Edit Supplier/Address_Direct","VMH Watchlist Review - Add Address","VMH Watchlist Review - Add Address_Direct","VMH Watchlist Review - Add Supplier","VMH Watchlist Review - Add Supplier_Direct")

Dim i,IndexSearch
Dim ArrayListTaskDetails : Set ArrayListTaskDetails = CreateObject("System.Collections.ArrayList")

For i=Lbound(ParentArr) To Ubound(ParentArr)

     ArrayListTaskDetails.Add(ParentArr(i))

Next

For IndexSearch = Lbound(VMHArray) To Ubound(VMHArray)

Do Until ArrayListTaskDetails.IndexOf(VMHArray(IndexSearch), 0) = -1

RemovePosition = ArrayListTaskDetails.IndexOf(VMHArray(IndexSearch), 0)
'MsgBox(RemovePosition)
ArrayListTaskDetails.RemoveRange RemovePosition, 4

Loop

Next 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:32:09.107

从输出中可以看出：

```
alSrc: a.x.x.x.b.c.d.e.x.x.x.f.a.x.x.x.
aRmv: a.e.i
a 0 a.x.x.x.b.c.d.e.x.x.x.f.a.x.x.x.
a 8 b.c.d.e.x.x.x.f.a.x.x.x.
a -1 b.c.d.e.x.x.x.f.
e 3 b.c.d.e.x.x.x.f.
e -1 b.c.d.f.
i -1 b.c.d.f.
alSrc: b.c.d.f. 
```

这个演示脚本的：

```
 Dim alSrc : Set alSrc = CreateObject("System.Collections.ArrayList")
  Dim sE
  For Each sE In Split("a x x x b c d e x x x f a x x x ")
      alSrc.Add sE
  Next
  WScript.Echo "alSrc:", Join(alSrc.ToArray(), ".")
  Dim aRmv  : aRmv  = Split("a e i")
  WScript.Echo "aRmv:", Join(aRmv, ".")
  Dim nI
  For Each sE In aRmv
      Do
         nI = alSrc.IndexOf(sE, 0)
         WScript.Echo sE, nI, Join(alSrc.ToArray(), ".")
         If -1 < nI Then alSrc.RemoveRange nI, 4
      Loop Until -1 = nI
  Next
  WScript.Echo "alSrc:", Join(alSrc.ToArray(), ".") 
```

您可以可靠地从 ArrayList 中删除针（a，e）的所有范围，然后再删除三个元素（xxx）。

只要**您**不提供预期结果与实际结果的详细描述，**我**只能说：罪魁祸首一定是您的代码或数据（即您）。

# java - Eclipse 的 LogCat 被 WAIT_FOR_CONCURRENT_GC 和 android 淹没

> ID：14093057
> 
> 赞同：1
> 
> 时间：2012-12-30T17:50:29.257
> 
> 标签：java, android, garbage-collection

我正在编写一个小型 android 游戏，每当我第一次运行时，一切正常，但它会随机挂起并开始在 eclipse 的 LogCat 中无休止地发送垃圾邮件

> 12-30 12:40:05.344: D/dalvikvm(22831): WAIT_FOR_CONCURRENT_GC 阻塞 5ms 12-30 12:40:05.383: D/dalvikvm(22831): GC_CONCURRENT 释放 511K，34% 空闲 2374K/3552K，暂停 1ms+2ms , 总共 14ms

我知道它与垃圾收集有关，但是每当我强制停止应用程序（关闭它的唯一方法）时，我会丢失大约 5-10mb 的可用内存，直到我重新启动设备。有谁知道这意味着什么以及如何预防？

我正在使用的设备是运行 android 4.2.1（Cyanogenmod 10.1）和 3.2（api 级别 13）的 sdk/target 版本的 verizon Galaxy nexus。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T17:56:05.177

不确定这是否正是您要查找的内容，但这是我搜索您的错误时的第一件事 - [WAIT_FOR_CONCURRENT_GC 被阻止是什么意思？](https://stackoverflow.com/questions/11531657/what-does-wait-for-concurrent-gc-blocked-mean). 此外，几乎没有理由*针对*3.2

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T18:04:29.313

你可以用谷歌搜索到更详细的描述，但基本上这只是意味着你让垃圾收集器非常努力地工作。

编写游戏与编写“普通”应用程序不同：您的游戏可能会循环无数次。因此，即使是很小的内存泄漏也会迅速发展为真正的问题。

此外，GC 通常是你最大的朋友，在游戏中它几乎是你的敌人之一。每次 GC 运行都会产生一点冻结，因为它“停止了世界”。

我建议您继续搜索特定的游戏编程教程以及如何在这些教程中处理 GC。

# c++ - OpenGL 状态集

> ID：14093062
> 
> 赞同：6
> 
> 时间：2012-12-30T17:51:02.520
> 
> 标签：c++, opengl

这与其说是 OpenGL 问题，不如说是 C++ 组织问题。

我将有一个简单的场景图（一个 n 树），其中的节点（为了这个问题）都会渲染一些几何图形。更具体地说，它们每个在`draw()`方法中都有一些 OpenGL 绘制命令。

出于优化的原因，我想将相似的对象批处理在一起并一次绘制它们。出于这个原因，我想要一种表达我称之为 OpenGL 的“状态集”的方式。状态集只是一堆 OpenGL 绑定，或者在 X 对象上调用绘制之前设置的命令，然后再取消设置。

因此，状态集至少具有`set()`并且`unset()`将由渲染系统在使用该状态集的节点的绘制命令之前和之后调用。

我的问题是如何表达所说的状态集？当然一堆函数可以做，但我宁愿能够命名一个集合并回忆它。就像节点 A 有一个状态集，`LIGHTING_AND_SHADOW`节点 B 有`CEL_SHADING`。

出于这个原因，创建一个名为的抽象类`stateSet`，它本质上是`set()`and`unset()`方法的接口，并让每个状态集都继承自它似乎是个好主意。但是，它需要创建一堆对象才能从本质上获得名称。似乎有更好的方法。

理想情况下，我希望列出所有`stateSets`可以轻松回忆的内容。例如，在渲染开始之前，如果能够将场景图中的所有节点按它们的`stateSet`.

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T20:41:36.317

您可以使用单例模式来实现您的状态。然后，另一个单例状态跟踪器类管理这些状态类的实例，并且仅在尚未设置状态时设置状态。请参阅下面的粗略实现。这应该给你一个关于如何去做的想法：

```
class SingletonStateClass1 {
public:
    static SingletonStateClass1* getInstance() {
        if(! instanceFlag) {
            single = new SingletonStateClass1();
            instanceFlag = true;
            return single;
        }
        else {
            return single;
        }
    }
    void set() {
        // Do setting stuff
    }
    void unset() {
        // Do unsetting stuff
    }
    ~SingletonStateClass1() {
        instanceFlag = false;
    }

private:
    static bool instanceFlag;
    static SingletonStateClass1 *single;
    SingletonStateClass1() {} //private constructor
};
bool SingletonStateClass1::instanceFlag = false; //needs to be set so that the first call to getInstance() works ok.

//ASSUME THERE IS ANOTHER CLASS WITH SIMILAR DESIGN, NAMED: SingletonStateClass2  

class SingletonStateTracker {
public:
    static SingletonStateTracker* getInstance() {
        if(! instanceFlag) {
            single = new SingletonStateTracker();
            state1 = SingletonStateClass1::getInstance();
            state2 = SingletonStateClass2::getInstance();
            instanceFlag = true;
            isSetState1 = false;
            isSetState2 = false;
            return single;
        }
        else {
            return single;
        }
    }

    // Only setting a state unsets the other states
    void set1() {
        if (!isSetState1) {
            if (isSetState2) {
                state2->unset();
                isSetState2 = false;
            }
            state1->set();
            isSetState1 = true;
        }
    }
    void set2() {
        if (!isSetState2) {
            if (isSetState1) {
                state1->unset();
                isSetState1 = false;
            }
            state2->set();
            isSetState2 = true;
        }
    }

private:
    static bool instanceFlag;
    static bool isSetState1;
    static bool isSetState2;
    static SingletonStateTracker *single;
    static SingletonStateClass1 *state1; 
    static SingletonStateClass2 *state2; 
    SingletonStateTracker() {} //private constructor
};
bool SingletonStateTracker::instanceFlag = false; //needs to be set so that the first call to getInstance() works ok.

class DrawableObject1 {
public:
    DrawableObject1() {
        tracker = SingletonStateTracker::getInstance();
    }
    void draw() const
    {
        tracker->set1();
        //DO YOUR OBJECT SPECIFIC OPENGL DRAW STUFF HERE
    }
private:
    SingletonStateTracker* tracker;
};

class DrawableObject2 {
public:
    DrawableObject2() {
        tracker = SingletonStateTracker::getInstance();
    }
    void draw() const
    {
        tracker->set2();
        //DO YOUR OBJECT SPECIFIC OPENGL DRAW STUFF HERE
    }
private:
    SingletonStateTracker* tracker;
};

/* Below two classes show a crude usage of the above design */
class Scene {
    // ... other stuff ...

public:
    DrawableObject1 obj1a;
    DrawableObject1 obj1b;
    DrawableObject2 obj2;
    // ... other stuff ...
};

class Viewer {
    // ... other stuff ...
public:
    void draw() {
        scene->obj1a.draw(); //This call unsets state2, sets state1
        scene->obj1b.draw(); //This call does not set any state since state1 is already set
        scene->obj2.draw();  //This call unsets state1, sets state2
    }
private:
    Scene* scene;
    // ... other stuff ...
}; 
```

请注意，上面的设计非常简单。正如您在问题中指出的那样，您可以有多个状态类来继承一个公共接口。关键是要有一个 Tracker（又名 Manager）类，通过该类对象设置状态。Tracker 类的工作是消除对已设置状态的不必要设置，如果当前已设置其他状态，则取消设置它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T21:03:33.733

> 出于这个原因，创建一个名为的抽象类`stateSet`，它本质上是`set()`and`unset()`方法的接口，并让每个状态集都继承自它似乎是个好主意。但是，它需要创建一堆对象才能从本质上获得名称。

您假设的抽象类实现通过虚函数表工作，该表通常实现为函数指针数组。在这种情况下，您将实例化的显然毫无意义的对象确实拥有有意义的状态——那些函数指针。

作为创建两个函数指针的多个数组的替代方法，也许您应该创建两个函数指针数组，将索引命名为数组，保留最后使用的索引，并在通过数组间接访问之前`stateSet(uint state_name)`检查是否不同。`state_name`我建议通过`static`关键字对其他编译单元隐藏所有全局状态。

这种方法提供的自动安全性较低 - 从语义上讲，没有什么可以阻止您将任何整数传递到`stateSet(uint)`原始数组中，并且除非您自己将其放在那里，否则不会对原始数组进行范围检查。

这两个选项在其他方面基本相似；所以给你自己的想法适当的考虑。

# javascript - javascript可以生成可执行的javascript代码吗？

> ID：14093065
> 
> 赞同：1
> 
> 时间：2012-12-30T17:51:09.757
> 
> 标签：javascript, jquery, html, keycode

这是一个示例 javascript 代码，用于在用户单击 shift + 1（或 2,3...9）时提醒用户

但是正如你所看到的，这段代码几乎是一样的。

```
a = window.event.keyCode;

var b = window.event.shiftKey

if (a == 49 && b) {
    alert(document.getElementById('alert1').length)
}
if (a == 50 && b) {
    alert(document.getElementById('alert2').length)
}
if (a == 51 && b) {
    alert(document.getElementById('alert3').length)
}
if (a == 52 && b) {
    alert(document.getElementById('alert4').length)
}
if (a == 53 && b) {
    alert(document.getElementById('alert5').length)
}
if (a == 54 && b) {
    alert(document.getElementById('alert6').length)
}
if (a == 55 && b) {
    alert(document.getElementById('alert7').length)
}
if (a == 56 && b) {
    alert(document.getElementById('alert8').length)
}
if (a == 57 && b) {
    alert(document.getElementById('alert9').length)
} 
```

是否有任何javascript（可以是jQuery）代码（使用`for(){}`方法或其他东西）通过编写更少的代码和由浏览器生成并在需要时执行的其他代码来完成相同的工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-30T17:56:07.020

您不应创建可执行的 Javascript，而应查看您的代码。

重复代码大多数时候可以编写为循环，或者在您的情况下可以通过数学编写。

```
if(a < 58 && a > 48 && b) {
  alert(document.getElementById('alert'+(a-48)).length)
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T17:58:40.770

您可能并不真正想要代码生成+执行，这可能会变得非常危险。

您只需要对代码进行一点[DRY](http://c2.com/cgi/wiki?DontRepeatYourself "不要重复自己")操作：

```
var ALERT_KEYCODE_OFFSET = 48;
var alertIndex, alertId;
if (a >= 49 && a <= 57 && b)
{
    alertIndex = a - ALERT_KEYCODE_OFFSET;
    alertId = 'alert' + alertIndex;
    alert(document.getElementById(alertId).length);
} 
```

# debugging - 如果库也在 GAC 中，Visual Studio 2012 将不会调试它

> ID：14093066
> 
> 赞同：4
> 
> 时间：2012-12-30T17:51:13.967
> 
> 标签：debugging, visual-studio-2012, visual-studio-debugging, class-library

这与“仅我的代码”调试设置无关，或标记优化代码，或未标记调试代码......所有这些情况都已排除。

我有一个使用库的 .net 项目。为了调试，我创建了一个小项目，然后为库添加了项目。我在测试项目中添加了库项目的引用。我运行了启动测试项目的解决方案，我看到我的断点变为空心红点。同样的设置在 Visual Studio 2005 中完美运行。

但是，我记得我在 GAC 中安装了相同的库，然后我删除了，现在，我的断点被正确命中。

有人知道这种行为在 VS 2012 中是否是新的吗？或任何遭受它的人？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T19:08:39.567

当调试器找不到您的程序集的符号信息时，就会发生这种情况。由于 PDB 文件不会出现在 GAC 中，因此这种情况有点可能发生。使用 Debug + Windows + Modules 并在列表中找到程序集。右键单击它并选择符号加载信息以查看调试器在何处查找 PDB 文件。

请避免在您的开发机器上使用 GAC，这是一个纯粹的部署细节。它只会在您编程时造成事故。就像在处理 pdb 文件时遇到问题并获取加载的程序集的陈旧副本一样。调试时必须使用 GAC 应该只发生在奇数互操作场景中。

# python - 如何设置从“开始日”到“结束日”的索引范围并在 DataFrame 中循环

> ID：14093069
> 
> 赞同：0
> 
> 时间：2012-12-30T17:51:16.030
> 
> 标签：python, pandas

我正在尝试分配一个从 X 开始并在 Y 结束的索引。

例如：

```
startday -01.01.2012,
endday - 31.02.2012\. 
```

另一个 DataFrame 在该时间段内模拟了 14 个股票订单，其中包含以下列：
日期、股票代码、股票数量、价格（收盘价）、价值（`orders_df.Amount * orders_df.Price`）。

我正在计算投资组合的日终价值（现金 + 股票价值），起始现金等于 1,000,000。

我不确定如何为整个期间的 DataFrame（第一个 DataFrame）分配索引。到目前为止，我能够计算出 14 天股票订单的投资组合价值。

```
cash.append(1000000)
cash = pd.Series(index=timestamps)
day = startday
for i in orders_df.Date:
    if i == day:
        cash = cash + orders_df.Value 
```

# ruby-on-rails - 可以注释掉 `wrap_parameters` 初始化程序吗？

> ID：14093076
> 
> 赞同：3
> 
> 时间：2012-12-30T17:52:04.483
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, thin, foreman, rails-api

我在使用 Foreman 和 Thin 启动 Rails-API 应用程序时遇到此错误。

```
AM@~/Documents/RailsWS/app1229 >foreman start
09:47:39 web.1  | started with pid 773
09:47:44 web.1  | => Booting Thin
09:47:44 web.1  | => Rails 3.2.8 application starting in development on   
  http://0.0.0.0:5000
09:47:44 web.1  | => Call with -d to detach
09:47:44 web.1  | => Ctrl-C to shutdown server
09:47:45 web.1  | Exiting
09:47:45 web.1  | 
 /Users/AM/Documents/RailsWS/app1229/config/initializers/wrap_parameters.rb:8:in 
 `block in <top (required)>': undefined method `wrap_parameters' for 
 ActionController::API:Class (NoMethodError) 
```

在花了几个小时尝试调试它之后，我没有成功，所以最终决定尝试破解：我`initializers/wrap_parameters.rb`在项目的文件中注释掉了这一行，如下所示：

```
ActiveSupport.on_load(:action_controller) do
  #wrap_parameters format: [:json] 
end 
```

这似乎解决了当前的问题，瘦服务器启动并运行。但是，我不确定这会对应用程序产生什么影响。在使用 Rabl gem 服务 JSON 的 Rails-API 应用程序中这样做是否安全？

我还参考了[Agile Web Development with Rails (Ed. 4) 的 Active Resources 部分](http://intertwingly.net/projects/AWDwR4/checkdepot-193-40/section-24.3.html)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T04:05:35.563

我废弃了 rails api 项目，现在我将它重写为一个完整的 rails 应用程序。

# mysql - 获得有限的所需文件

> ID：14093085
> 
> 赞同：0
> 
> 时间：2012-12-30T17:52:46.613
> 
> 标签：mysql, mongodb, mongodb-php

我正在使用 Mongodb，但我可以迁移到 mysql，我的问题是，我有一个包含这样的数据的集合，

```
array(
"L"=>"cars",
"M"=>"wolkswagen"
)
array(
"L"=>"cars",
"M"=>"bmw"
)
array(
"L"=>"cars",
"M"=>"mercedes"
)

array(
"L"=>"bike",
"M"=>"bianchi"
)
array(
"L"=>"bike",
"M"=>"trek"
)
array(
"L"=>"bike",
"M"=>"brook"
) 
```

结果我想得到什么，任何自行车和汽车，但每个都有 2 个结果，所以结果应该是，

```
array(
"L"=>"cars",
"M"=>"some car"
)
array(
"L"=>"cars",
"M"=>"some car"
)

array(
"L"=>"bike",
"M"=>"some bike"
)
array(
"L"=>"bike",
"M"=>"some bike"
) 
```

我试图用 $in 来做这件事，但似乎没有用，有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T13:29:37.133

使用MongoDB 2.2+ 中的[聚合框架](http://docs.mongodb.org/manual/applications/aggregation/)有几种方法可以解决这个问题。

不幸的是，2.2.2 的聚合框架还不支持`$slice`or 数组子集运算符，因此需要一些额外的操作。

注意：下面的示例使用`mongo`shell，但应该可以直接转换为 PHP 驱动程序。

### 示例 #1：使用聚合框架提取两个匹配项（第一个和最后一个）

假设您不为每个分组获得哪两个元素而烦恼，您可以选择`$first`and `$last`：

```
db.cars.aggregate(

    // Group by $L and find the first and last elements
    { $group: {
        _id: '$L',
        first: { $first: "$M" },
        last: { $last: "$M" },
    }},

    // Add an extra $index for # of array elements
    { $project: {
        first: 1,
        last: 1,
        index: { $const:[0,1] }     
    }},

    // Split into document stream based on $index
    { $unwind: '$index' },

    // Re-group data using conditional to create array 
    { $group: {
        _id: '$_id',
        M: {
            $push: { $cond:[ {$eq:['$index', 0]}, '$first', '$last'] }
        }
    }}
) 
```

样本输出：

```
{
    "result" : [
        {
            "_id" : "cars",
            "M" : [
                "wolkswagen",
                "mercedes"
            ]
        },
        {
            "_id" : "bike",
            "M" : [
                "bianchi",
                "brook"
            ]
        }
    ],
    "ok" : 1
} 
```

### 示例#2：使用聚合框架创建一个集合，然后减少

上述方法的替代方法是使用更简单的管道`$addToSet`和后处理步骤来修剪数组元素：

```
var agg = db.cars.aggregate(
    { $group: {
        _id: '$L',
        'M': { $addToSet: "$M" },
    }}
)

// Iterate to trim each result to the desired # of elements
agg.result.forEach(function(doc) {
    // Note: you could randomly select 2 (or n) elements here
    doc.M = doc.M.slice(0,2);
}) 
```

输出格式将与示例 #1 相同，但示例 #2（如所写）选择前两个元素，而不是选择第一个和最后一个元素。

# javascript - 使用 Mongoose 和 Node.JS 的 MongoDB 查询，带有大小写和重音正则表达式

> ID：14093089
> 
> 赞同：4
> 
> 时间：2012-12-30T17:53:28.433
> 
> 标签：javascript, regex, mongodb

我正在尝试在 Node.JS 中使用 Mongoose 编写 MongoDB 查询，以获取与某个名称匹配的数据库中的所有名称。我希望查询忽略大小写和重音。

我在互联网上环顾四周，但找不到这样做的查询。

MongoDB 查询支持正则表达式，所以这就是我想要做的。

这就是我现在所拥有的。如果查询或查询的字符串有重音符号而另一个没有重音符号，它可以工作，但不匹配。

```
Passenger_record.find({$and: [{"FIRSTNAME": { $regex:req.query["firstname"], $options: 'i' }},{"LASTNAME": { $regex:req.query["lastname"], $options: 'i' }}]}).exec(function (err, person) 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T09:38:23.867

看看这个，[JavaScript 中的 Programatic Accent Reduction (aka text normalization or unaccenting)](https://stackoverflow.com/questions/227950/programatic-accent-reduction-in-javascript-aka-text-normalization-or-unaccentin)

你会发现一个函数来构建一个不区分重音的正则表达式。

# java - java修剪泛型数组

> ID：14093092
> 
> 赞同：2
> 
> 时间：2012-12-30T17:53:52.087
> 
> 标签：java, generics, casting

> **可能重复：**
> [在 Java 中创建泛型数组](https://stackoverflow.com/questions/4013683/creating-generic-arrays-in-java)

我想将一个通用的对象数组修剪到只有第一个 len 元素。这似乎应该工作：

```
@SuppressWarnings("unchecked")
public static <T> T[] trimArray(T[] data, int len){
    T[] result = (T[]) new Object[len];
    System.arraycopy(data, 0, result, 0, len);
    return result;
} 
```

但是如果我做类似的事情，它会抛出一个 ClassCastException

```
public class Foo{

    double f;

    public Foo(double f){
    this.f = f;
    }

}

public static void main(String[] args){

    Foo[] A = new Foo[10];
    A[0]= new Foo(1);
    A[1]= new Foo(2);
    A[2]= new Foo(3);
    Foo[] B = trimArray(A, 3);

} 
```

我不明白为什么这不起作用，但是[在泛型类中的 java 泛型转换中类似的东西](https://stackoverflow.com/questions/13960601/java-generic-casting-in-generic-classes)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-30T17:56:49.917

JDK 已经为此内置了一个：

```
Foo[] B = Arrays.copyOf(A, 3); 
```

[Javadoc](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#copyOf%28T%5B%5D,%20int%29)（从 1.6 开始）

但是请注意，如果源数组长度小于所需长度，它也会*扩展*数组（用 s 填充）。`null`您可以使用以下方法轻松解决此问题：

```
Foo[] B = Arrays.copyOf(A, Math.min(3, A.length)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T18:01:58.763

发生这种情况是因为数组是协变的，这意味着您可以自由地将子类型的数组视为超类型的数组，但反之则不然。

你*可以*做什么，虽然它是一个丑陋的黑客，是返回一个`Object[]`然后将每个元素转换为`T`（数组中的实际元素是协变的，但数组本身不是），但我*强烈*建议不要这样做。

使用其他答案中推荐的内置函数，例如`Arrays.copyOf`.

如果您想知道*为什么*，那是因为这很容易破坏类型安全。

例如：

```
Object[] bla = new Object[10];
bla[0] = new Integer(2);
bla[1] = "stillanObject"; 
```

你有一个对象数组，完全有效。

现在你把它转换成一个字符串数组......

```
return (String[])bla; 
```

并且地狱将在 JVM 上被释放，您实际上将拥有一个应该是`String`包含`String`和`Integer`对象类型的数组！\

类型安全是一件好事。

更新：

只是为了添加更多细节，您可以强制`String[]`转换为`Object[]`，但是`ArrayStoreException`如果您尝试存储任何不是`String`（或原始数组类型）的东西，这可能会发生。虽然读取原始数组`Object[]`是完全安全的。

# asp.net-mvc - 如何在 ASP.NET MVC 中调用具有强制/应用属性的控制器操作？

> ID：14093099
> 
> 赞同：4
> 
> 时间：2012-12-30T17:54:51.603
> 
> 标签：asp.net-mvc, controller, actionfilterattribute

当我尝试从另一个控制器操作（方法）中调用特定的控制器操作（方法）时，已应用于我正在调用的操作的属性不会被应用/强制执行。

例如，如果我有一个控制器操作，其中应用了一些属性，如下所示：

```
[Authorize]
[HttpPost]
public ActionResult SaveUsers(List<User> users) { .. } 
```

然后我从另一个控制器操作中调用此操作，属性未执行/强制执行。

MVC 似乎在其“ActionInvoker”的默认实现中管理这些 ActionFilterAttribute/ActionMethodSelectorAttribute 的执行，但不幸的是，当您直接使用 ActionInvoker 时，它不会返回操作方法的结果，而是简单地调用操作并直接写入到响应流。

**我的目标是**：

1.  调用特定的动作方法
2.  具有强制/执行的属性
3.  从 action 方法中获取结果

我设法做到了1和3，但没有做到2。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-29T11:44:22.990

您可以尝试显式地通过 ActionInvoker。这是正常执行您的操作的对象，但它由 MVC 管道调用。在您的源操作中，执行以下操作：

```
this.ActionInvoker.InvokeAction(this.ControllerContext, "TargetActionName"); 
```

这可能有效，但是您将操作名称作为字符串引入，这不是一件好事。

# ruby-on-rails - 应用程序控制器中的实例变量值未更改

> ID：14093104
> 
> 赞同：0
> 
> 时间：2012-12-30T17:55:42.900
> 
> 标签：ruby-on-rails, activerecord

我已经找到了解决我的问题的方法，但我仍然不明白为什么会出现这个问题。我想我错过了一些关于内部如何工作的东西。

我正在从几个控制器调用 *check_modify_rights* 方法，并且我想要一个具有适当名称的变量（@post 用于 post_controller 而不是通用变量，如 @object）

所以在 before_filter 运行之后，我希望有一个带有 Post 模型的 @post 实例变量。但是我得到了一个新的 Post 模型（因为@post = Post.new），当我在方法中检查 object_id 时，它们是不同的。

```
# post_controller
  before_filter do |f|
    @post = Post.new
    f.check_modify_rights @post
  end

# application_controller
  def check_modify_rights(obj)
    return redirect_to login_path, :notice => "Please login" unless @user

    p obj.object_id
    obj = obj.class.find(params[:id])
    p obj.object_id

    return if obj.user.id == @user.id or @user.is_admin?

    redirect_to posts_path, :notice => "You don't have permission for this action"
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:25:23.540

显然`@post = Post.new`将具有与新实例化对象不同的 id。

要检索新对象，您可以：

1）使用通用实例变量：`@resource = Post.new`

2) 或：

```
# in your before filter
@post = f.check_modify_rights @post
# in application controller
return obj if obj.user.id == @user.id or @user.is_admin? 
```

但基本上，你正在重做康康舞，我不推荐。

# zend-form - Zend Framework 2 翻译表单错误不起作用

> ID：14093111
> 
> 赞同：3
> 
> 时间：2012-12-30T17:56:27.953
> 
> 标签：zend-form, zend-framework2, zend-translate

我花了一整夜试图弄清楚为什么这段代码不起作用

```
$inputFilter = new InputFilter();
$factory = new InputFactory();

$translator = new \Zend\I18n\Translator\Translator();
//Copy of file found in resources/languages/es/Zend_Validate.php
$translator->addTranslationFile('phparray', './module/Product/language/zend_validate.php');

$inputFilter->add(
    $factory->createInput(
        array(
            'name' => 'idpro',
            'required' => true,
            'filters' => array(
                array('name' => 'Int'),
            ),
        )
    )
);

$inputFilter->add(
    $factory->createInput(
        array(
            'name' => 'nompro',
            'validators' => array(
                array(
                    'name' => 'EmailAddress',
                    'options' => array(
                        'translator' => $translator
                    )
                ),
            ),
        )
    )
); 
```

我已经安装了 php5-intl 并在 php.ini 中启用了它

但它不起作用我得到相同的消息*Value is required 并且不能为空*，但它应该是翻译的......

非常感谢你 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T18:30:14.663

这是我为正确翻译表单错误所做的工作：

模块.config.php

```
<?php
return array(
    'service_manager' => array(
        'factories' => array(
            'translator' => 'Zend\I18n\Translator\TranslatorServiceFactory'
        )
    ),
    'translator' => array(
        'locale' => 'en',
        'translation_file_patterns' => array(
            array(
                'type'        => 'gettext',
                'base_dir'    => __DIR__ . '/../language',
                'pattern'     => '%s.mo',
                'text_domain' => 'admin'
            ),
            array(
                'type'        => 'phparray',
                'base_dir'    => __DIR__ . '/../resources/languages',
                'pattern'     => '/%s/Zend_Validate.php',
                'text_domain' => 'default'
            )
        )
    )
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T19:48:31.497

您不能通过这种方式设置翻译器。

改用这个静态方法：

```
\Zend\Validator\AbstractValidator::setDefaultTranslator($translator, 'default'); 
```

希望这可以帮助。

# java - 如何将 XML 作为请求从 JSP 发送到 Servlet

> ID：14093115
> 
> 赞同：0
> 
> 时间：2012-12-30T17:56:47.703
> 
> 标签：java, xml, jsp, servlets

我想在 doPost 方法中将 XML 请求从 JSP 发送到 Servlet。我怎样才能做到这一点。

这是在 JSP 页面中。

```
username = request.getParameter("username");
pasword = request.getParameter("password");

xml = "<?xml version=\"1.0\" encoding=\"utf-8\" ?>"
     + "<login_credential><username>" + username + "</username>"
     + "<password>" + pasword + "</password></login_credential>"; 
```

这是在 Servlet 中。

```
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
     //HERE I want a xml which has sent from jsp page.
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:41:37.417

将 xml 放入隐藏的 HTML 文件并提交表单。作为替代方案，您可以创建 AJAX 请求。

# ruby - Rails update database after certain amount of time has gone by

> ID：14093117
> 
> 赞同：1
> 
> 时间：2012-12-30T17:57:02.250
> 
> 标签：ruby, ruby-on-rails-3

I am trying to update a column in my database if a book was created more than 25 seconds ago (when deploying, it will be 7 days ago, but I can't wait that long :)).

**Models:**

```
class Book < ActiveRecord::Base
  attr_accessible :author, :date, :description, :order, :title, :user_id, :author, :status, :queued
  belongs_to :user
end

class User < ActiveRecord::Base
  attr_accessible :email, :password, :password_confirmation, :remember_me, :user_id, :name, :bio
  has_many :books
end 
```

**Controller:**

```
class UsersController < ApplicationController

def show
  @user = User.find(params[:id])

  @book = Book.new

  @books = Book.select("DISTINCT name, id") # Not used right now

  @sequence = @user.books

  @sequence.each do |book|
    book.created_at >= 25.seconds.ago ? book.queued = false : nil
  end
end 
```

**User show view:**

```
<% @sequence.order("created_at DESC").where(:queued => false).each do |book| %> 
```

Am I even close to getting this to work? What am I doing wrong? As you can see, I want to change the "queued" attribute to false after 25 seconds...

**Edit**

I've been told I need to use something like Heroku's Scheduler for this to work. Is there no way for this to update the database without something like that?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:23:53.350

You could take a different approach. Instead of having a field to know if it' queued use a scope (a query for queued books)

```
class Book < ActiveRecord::Base
  scope :queued, where('created_at <= ?', 25.seconds.ago)
  scope :not_queued, where('created_at > ?', 25.seconds.ago)
end 
```

So now in your controller you can do something like:

```
class UsersController < ApplicationController

  def show
    @user = User.find(params[:id])

    @book = Book.new

    @not_queued_books = @user.books.not_queued
  end
end 
```

Does it resolve your problem or you really need to have that column? Because with a scope it totally works and it's away more flexible and easy to implement!

* * *

If you want to see the ones not_queue by default `Book.all` and have a scope to see the queued ones here is an example

```
class Book < ActiveRecord::Base
  scope :queued, where('created_at <= ?', 25.seconds.ago)
  scope :not_queued, unscoped.where('created_at > ?', 25.seconds.ago)
  scope :date_desc, order("created_at DESC")
  default_scope not_queued
end

class UsersController < ApplicationController

  def show
    @user = User.find(params[:id])

    @book = Book.new
  end
end 
```

So now in your view just do this:

```
<% @user.books.date_desc.each do |book| %> 
```

Notice now the default scope is books not queued and I moved the ordering also to a scope. Of course you can do this books.date_desc in your controller wich should preferable.

* * *

So as you said in the comment you have the issue of evaluation in scopes. Well, this is because the scope is "cached" when you start the app, so `25.seconds.ago` will be relative to the time you started the app instead of the 25 seconds ago from now as you want to. There are plenty resources explaining this, and you should go check them if you don't understand what I'm saying. For example in this railscast [http://railscasts.com/episodes/202-active-record-queries-in-rails-3](http://railscasts.com/episodes/202-active-record-queries-in-rails-3)

So what you have to do? You have to wrap your scopes with a lambda so it will be evaluated every time you use the scope instead of evaluating when you start the app.

Like this:

```
 scope :queued, lambda { where('created_at <= ?', 25.seconds.ago) }
  scope :not_queued, lambda { unscoped.where('created_at > ?', 25.seconds.ago) }
  scope :date_desc, order("created_at DESC")
  default_scope not_queued 
```

Also instead of `lambda { ... }` you can use the new 1.9 shorthand `-> { ... }` instead

# css - 无论滚动条如何都锁定固定标题以阻止它移动

> ID：14093131
> 
> 赞同：0
> 
> 时间：2012-12-30T17:58:32.120
> 
> 标签：css

我有一个网站，顶部标题固定为 100% 宽度，在该 DIV 内我有另一个 980 像素宽的 div，居中。

当我加载创建浏览器滚动条的 a 时（由于页面很长），页面加载和标题加载但随后跳转到左侧，以容纳滚动条。

我知道我可以添加`overflow-y:scroll;`到样式表以使滚动条始终存在，但是，这并不好，因为我使用的是 jquery fancybox v.2，如果你在一个长的fancybox 弹出窗口中执行此操作，它会给你两个滚动条。失败。

那么，有没有办法锁定标题的中间部分，就好像有滚动条但实际上没有滚动条一样？无论滚动条是否存在，它都处于相同的位置。

这是我现在使用的 CSS：

```
#topbar {
width:100%; 
height:51px;
margin:0;   
padding:0;  
position:fixed;
z-index:1000;
/*Making sure it sticks to left of window in IE7*/
top:0;
left:0;
float:left; 
background-color:#eeeeee;
border-bottom:1px solid #333;
box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.5);
}

.header { 
width:980px; 
margin:0 auto; 
position: fixed; 
z-index: 1001; 
left: 50%; 
margin-left: -490px; 
} 
```

它被称为例如`<div id="topbar"><div class="header">blah blah</div></div>`

有解决办法吗？

# javascript - javascript函数中出现意外的TypeError

> ID：14093135
> 
> 赞同：0
> 
> 时间：2012-12-30T17:59:38.820
> 
> 标签：javascript, if-statement, typeerror

目标：编写一个函数，确定对象数组是否包含具有给定字段的给定值的对象。如果存在这样的对象，则返回该对象，否则返回 false。

**编码**

```
var data = [
    {isle: 'VF', item: 'Ginger'},
    {isle: 'VF', item: 'Spinach'},
    {isle: 'Dairy', item: 'Milk'},
    {isle: 'Dairy', item: 'Yogurt'}
];

var objwithPropvalueInarr = function(propname, propvalue, arr){
    for(var i=0; i <= arr.length; i++){
        if (arr[i][propname] === propvalue) {
            // console.log('Found object with value ' + propvalue);
            return arr[i];
        }
    };
    return false;
}; 
```

我在 Google Chrome 控制台中输入了上述代码。以下对该函数的调用有效：

```
objwithPropvalueInarr('isle', 'VF', data) 
```

上面的行`data[0]`按预期返回。

但是，以下调用返回一个 TypeError（显示在调用之后）

```
objwithPropvalueInarr('isle', 'nonexistentpropvalue', data)

TypeError: Cannot read property 'isle' of undefined
arguments: Array[2]
get message: function () { [native code] }
get stack: function () { [native code] }
set message: function () { [native code] }
set stack: function () { [native code] }
type: "non_object_property_load"
__proto__: Error 
```

`data[0]['isle'] === 'nonexistentpropvalue'``false`按预期返回。如果`if`函数中的条件不是`false`每次检查都返回，然后`false`在最后返回值。如果有人可以解释错误，将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T18:01:03.013

改变

```
for(var i = 0; i <= arr.length; i++) { 
```

到

```
for (var i = 0; i < arr.length; i++) { 
```

使用`<=`将超出数组的范围。

***[jsFiddle 演示](http://jsfiddle.net/9mw3x/)***

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T18:03:45.843

这是因为您应该将代码更改为`for(var i=0; i < arr.length; i++){`：因为数组长度 = arr.length，最后一个元素索引是 arr.length - 1，所以您只需将 arr[arr.length] 作为空对象。

# android - 安卓应用不幸停止了

> ID：14093141
> 
> 赞同：0
> 
> 时间：2012-12-30T18:00:54.307
> 
> 标签：android, android-intent

我是 android 编程的新手，我编写了一个程序，在其中创建了一个按钮..单击它应该导航到其他页面我没有收到任何错误，但是当我启动应用程序时，它会立即打开并立即显示“不幸停止”并关闭该程序。

**这是我的代码**

```
 package com.hotel;

    import android.os.Bundle;
    import android.app.Activity;
    import android.content.Intent;
    import android.view.Menu;
    import android.view.View;
    import android.view.View.OnClickListener;
    import android.widget.Button;

    public class HotelActivity extends Activity implements OnClickListener {
        Button btnClick=null, button1;
        @Override
        protected void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_hotel);
            button1 = (Button)findViewById(R.id.button1);
            btnClick.setOnClickListener(this);

        }

        @Override
        public boolean onCreateOptionsMenu(Menu menu) {
            // Inflate the menu; this adds items to the action bar if it is present.
            getMenuInflater().inflate(R.menu.activity_hotel, menu);
            return true;
        }

        @Override
        public void onClick(View v) {
            if(R.id.button1==v.getId())

             {
                Intent i= new Intent(HotelActivity.this,MenuActivity.class);
                startActivity(i);
            }   
            // TODO Auto-generated method stub

        }

    } 
```

**这是它的相应 xml 文件**

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:tools="http://schemas.android.com/tools"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        tools:context=".HotelActivity" >

        <Button
            android:id="@+id/button1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_centerHorizontal="true"
            android:layout_marginBottom="162dp"
            android:text="@string/start" />

        <TextView
            android:id="@+id/textView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_above="@+id/button1"
            android:layout_centerHorizontal="true"
            android:layout_centerVertical="true"
            android:text="@string/hello_world" />

    </RelativeLayout> 
```

**这是第二页的代码**

```
 package com.hotel;

    import android.annotation.SuppressLint;
    import android.app.Activity;
    import android.os.Bundle;
    import android.view.View;
    import android.widget.AdapterView;
    import android.widget.AdapterView.OnItemClickListener;
    import android.widget.ListView;
    import android.widget.Toast;

    @SuppressLint("ShowToast") public class MenuActivity extends Activity implements OnItemClickListener{
        /** Called when the activity is first created. */

        ListView lv;

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.menu);

            lv = (ListView)findViewById(R.id.menu_settings);
            lv.setOnItemClickListener(this);
        }

     @Override
        public void onItemClick(AdapterView<?> arg0, View arg1, int arg2, long arg3) {
            String selValue= (String)lv.getItemAtPosition(arg2);
            Toast.makeText(getApplicationContext(), "Selected Item = "+selValue, 1000).show();

            // TODO Auto-generated method stub

        }

    } 
```

**这是它各自的xml文件**

```
 <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical" >

        <ListView
            android:id="@+id/listView1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content" 
            android:entries="@array/courses">

        </ListView>

    </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T18:09:11.907

我们需要您的 LogCat 堆栈跟踪才能更好地帮助您。然而，这是我目前看到的错误：

```
 btnClick.setOnClickListener(this); 
```

将给一个`NullPointerException`，因为你从来没有`findViewById()`为`btnClick`，只为`button1`。

**此外**，您的 xml 布局文件中实际上并不存在 btnClick，看来您决定`button1`改用它。

所以要么改变`OnClickListener`你正在使用的`button1`

```
button1.setOnClickListener(this); 
```

或者在您的 xml 中创建一个 ID 为 btnClick 的新按钮。然后在您的代码中，`setContentView()`添加此行之后：

```
 btnClick = (Button)findViewById(R.id.btnClick); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T09:36:21.717

button1 = (Button)findViewById(R.id.button1);

```
 btnClick.setOnClickListener(this);// btnClick is null 
```

利用

button1.setOnClickListener(this);

# ios - 如何将十六进制数组转换为 UIImage？

> ID：14093143
> 
> 赞同：1
> 
> 时间：2012-12-30T18:01:03.027
> 
> 标签：ios, image-processing, uiimageview, bluetooth, uiimage

有几个与使用 P25mi 动态打印图像相关的未解决问题，没有一个可以接受的答案。下面有几个链接。

[如何将图像转换为位图代码以在 iphone 中进行蓝牙打印](https://stackoverflow.com/questions/13838283/how-to-convert-image-to-bitmap-code-for-bluetooth-print-in-iphone)

[如何将图像转换为十六进制字节数组以将其发送到 iOS sdk 中的输出流](https://stackoverflow.com/questions/5879807/how-to-convert-image-into-hexa-decimal-bytes-array-to-send-it-to-output-stream-i)

下面的代码示例是将静态图像打印到 p25mi 的硬编码工作示例。数组中的前 10 个元素是 p25 的控制和格式命令。

我认为将下面的十六进制数组转换为可在 UIImageView 中显示的 UIImage 可能会对反向操作有所帮助。

如何确定下面代码示例中表示的图像的高度、宽度和深度？

如何将下面的十六进制数组转换为 UIImage？

```
unsigned char buffer3[796]={
    0x55 ,  0x66 ,  0x77 ,  0x88 ,  0x44 ,  0x1B ,  0x58 ,  0x31 ,  
    0x19, 0x20, 
    0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 
    ,0x00 ,0x00 ,0x00 ,0x80 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x01 ,0xC0 ,0x00
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x01 ,0x80 ,0x00 ,0x03 ,0x60 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x03
    ,0xA0 ,0x00 ,0x07 ,0xB0 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x05 ,0x60 ,0x00 ,0x07 ,0xD8 ,0x00
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x05 ,0xA0 ,0x00 ,0x13 ,0xEC ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x04 
    ,0x20 ,0x00 ,0x29 ,0xF4 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x03 ,0xC0 ,0x00 ,0x64 ,0xF9 ,0x00
    ,0x0F ,0xFF ,0x9C ,0x01 ,0xC0 ,0x19 ,0xFF ,0xC0 ,0x7F ,0xFC ,0x7F ,0xF9 ,0xC0 ,0x3D ,0xFF
    ,0xF1 ,0xFF ,0xE3 ,0xFF ,0xC0 ,0x00 ,0x00 ,0xF2 ,0x73 ,0x80 ,0x0F ,0xFF ,0x9C ,0x01 ,0xC0
    ,0x19 ,0xFF ,0xC0 ,0x7F ,0xFE ,0x7F ,0xFD ,0xE0 ,0x3D ,0xFF ,0xF1 ,0xFF ,0xE3 ,0xFF ,0xC0
    ,0x00 ,0x00 ,0x79 ,0x26 ,0xC0 ,0x0F ,0xFF ,0xDC ,0x01 ,0xC0 ,0x19 ,0xFF ,0xC0 ,0x7F ,0xFE
    ,0xFF ,0xFD ,0xF0 ,0x7D ,0xFF ,0xFB ,0xFF ,0xF7 ,0xFF ,0xE0 ,0x00 ,0x03 ,0x3C ,0x8F ,0x60
    ,0x0C ,0x01 ,0xDC ,0x01 ,0xC0 ,0x19 ,0x80 ,0x00 ,0x70 ,0x0E ,0xE0 ,0x1D ,0xF0 ,0x7D ,0x80
    ,0x3B ,0x80 ,0x77 ,0x00 ,0xE0 ,0x00 ,0x04 ,0x9E ,0x8F ,0xB0 ,0x0E ,0x01 ,0xDC ,0x01 ,0xC0
    ,0x19 ,0x80 ,0x00 ,0x70 ,0x0E ,0xE0 ,0x1D ,0xF8 ,0xFD ,0x80 ,0x33 ,0x80 ,0x77 ,0x00 ,0xE0
    ,0x00 ,0x0E ,0x4F ,0x27 ,0xD8 ,0x0F ,0xFF ,0x9C ,0x01 ,0xC0 ,0x19 ,0xFF ,0xC0 ,0x7F ,0xFC 
    ,0xE0 ,0x1D ,0xF9 ,0xFD ,0xFF ,0xF3 ,0x80 ,0x77 ,0x00 ,0xE0 ,0x00 ,0x0F ,0x26 ,0x53 ,0xC8
    ,0x0F ,0xFF ,0x9C ,0x01 ,0xC0 ,0x19 ,0xFF ,0xC0 ,0x7F ,0xFC ,0xEF ,0xFD ,0xDD ,0xDD ,0xFF
    ,0xF3 ,0x80 ,0x77 ,0x00 ,0xE0 ,0x00 ,0x07 ,0x90 ,0xC9 ,0xF0 ,0x0F ,0xFF ,0xDC ,0x01 ,0xC0
    ,0x19 ,0xFF ,0xC0 ,0x7F ,0xFE ,0xEF ,0xFD ,0xDF ,0x9D ,0xFF ,0xFB ,0x80 ,0x77 ,0x00 ,0xE0
    ,0x00 ,0x03 ,0xC9 ,0xE4 ,0xE0 ,0x0C ,0x00 ,0xDC ,0x01 ,0xC0 ,0x19 ,0x80 ,0x00 ,0x70 ,0x06 
    ,0xE7 ,0xFD ,0xCF ,0x9D ,0x80 ,0x3B ,0x80 ,0x77 ,0x00 ,0xE0 ,0x00 ,0x01 ,0xF0 ,0xF2 ,0x40
    ,0x0E ,0x01 ,0xDC ,0x00 ,0xC0 ,0x19 ,0x80 ,0x00 ,0x70 ,0x0E ,0xE0 ,0x1D ,0xCF ,0x1D ,0x80
    ,0x3B ,0x80 ,0x77 ,0x00 ,0xE0 ,0x00 ,0x00 ,0xE6 ,0x79 ,0x00 ,0x0F ,0xFF ,0xDF ,0xFC ,0xFF
    ,0xF9 ,0xFF ,0xC0 ,0x7F ,0xFE ,0xE0 ,0x1D ,0xC7 ,0x1D ,0xFF ,0xFB ,0xFF ,0xF7 ,0xFF ,0xE0
    ,0x00 ,0x00 ,0x49 ,0x3D ,0x00 ,0x0F ,0xFF ,0x9F ,0xFC ,0xFF ,0xF9 ,0xFF ,0xC0 ,0x7F ,0xFE
    ,0xE0 ,0x1D ,0xC2 ,0x1D ,0xFF ,0xF1 ,0xFF ,0xE3 ,0xFF ,0xC0 ,0x00 ,0x00 ,0x1C ,0x9E ,0x00 
    ,0x0F ,0xFF ,0x1F ,0xFC ,0x7F ,0xE1 ,0xFF ,0xC0 ,0x7F ,0xFC ,0xE0 ,0x1D ,0xC0 ,0x1D ,0xFF
    ,0xE0 ,0xFF ,0xC1 ,0xFF ,0x80 ,0x00 ,0x00 ,0x1E ,0x4C ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00
    ,0x00 ,0x00 ,0x0F ,0x20 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x07 ,0x90 ,0x00
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x03 ,0xE0 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 
    ,0x00 ,0x00 ,0x01 ,0xC0 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x80 ,0x00
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 
    ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 ,0x00 
    ,0x00 ,0x00 ,0x00   
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T19:56:54.507

查看[P25 开发指南 V3.4.1](http://bluebamboo.helpserve.com/Knowledgebase/Article/GetAttachment/27/8)。

我不明白前五个字符是干什么用的。但以下字符是转义序列：

```
 0x1B,  0x58,  0x31,  0x19, 0x20 
```

它们用于以水平模式打印位图。0x19 和 0x20 分别是水平尺寸（乘以 8）和垂直尺寸。所以图像是 200 x 32 像素。随后的 25 x 32 字节包含像素（黑白，每像素 1 位）。

我希望整个东西长 810 字节（5 字节未识别，5 字节转义序列，25 x 32 字节的像素数据）。我不太明白为什么它适用于 796。

**更新：**

要将 UIImage 转换为原始黑白数据（没有转义序列），以下代码应该会有所帮助。我希望仍然支持每像素 1 位的位图。

```
CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceGray();
size_t bytesPerRow = (uiImage.size.width + 7) / 8;
size_t imageDataSize = uiImage.size.height * bytesPerRow;
unsigned char* imgData = (unsigned char*) malloc(imageDataSize);
CGContextRef context =  CGBitmapContextCreate(imgData,
    uiImage.size.width, uiImage.size.height, 
    1, bytesPerRow, 
    colorSpace, kCGImageAlphaNone);

UIGraphicsPushContext(context);
[uiImage drawInRect: CGRectMake(0.0, 0.0, uiImage.size.width, uiImage.size.height)];
UIGraphicsPopContext();

CGContextRelease(context);
CGColorSpaceRelease(colorSpace);

for (int i = 0; i < imageDataSize; i++)
    imgData[i] = ~imgData[i];

... send the image (imgData) to the printer ...

free(imgData); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:00:13.610

最容易从黑白图像开始（我使用 .png）每个像素分配 4 个字节，您可以使用 CgContextRef 和 CgContextDrawImage 获取其数据（我使用 CGBitmapContextCreate 方法填充像素数据数组为以及从编辑的数据数组创建黑白图像。我平均每个像素的 rgb 值，然后根据 rgb 的平均值将所有像素值更改为黑色或白色（alpha == 255）。

然后您需要将每 8 个像素打包成 1 个打印字节（因此对于 4 个字节的像素，查看数据数组中的一组 32 个字节，并根据像素是否打开或关闭打印字节的二进制值黑色（添加 pow(2, 7 - (8 像素序列中像素的位置)）或白色（什么都不做）。

我将 .png 图像转换为黑白 .png，然后转换为二进制并在我的屏幕上打印这些值。尝试将 .png 的宽度保持在 8 的倍数，否则会遇到麻烦（因为您需要将 8 个字节转换为 1 个字节。

# jquery - 使图像背景从图像底部开始

> ID：14093144
> 
> 赞同：2
> 
> 时间：2012-12-30T18:01:05.663
> 
> 标签：jquery, css, jquery-ui

在这个例子中.. [http://jsfiddle.net/PKFyV/](http://jsfiddle.net/PKFyV/)

你可以看到我正在使用 jquery ui 来构建一个滑块。您可以上下拖动红色条以查看输入更改的值，但是当您这样做时，您会注意到红色图像保持其渐变透视的问题。Jquery 正在设置该 div 的高度，因此当它非常小时，它使用图像的顶端，即渐变的较亮端。我需要的是背景从底部开始并根据 div 的高度放大，这样当滑块设置为 1 或 2 时，底部条显示红色渐变图像的较暗端。有任何想法吗？

```
.ui-slider {
    position: relative;
    text-align: left;
}
#slider-vertical {
    background:url(http://qupload.com/images/ratingslid.png) no-repeat -30px 0;
    width:30px;
    height:161px;
}
.ui-slider-range {
    background:url(http://qupload.com/images/ratingslid.png) no-repeat 0 0;
    width:30px;
    height:161px;
}
.ui-slider-vertical .ui-slider-range-min {
    bottom: 0;
}
.ui-slider .ui-slider-range {
    position: absolute;
    z-index: 1;
    border: 0;
}
.ui-slider-vertical .ui-slider-range {
    left: 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T18:04:02.013

试试这个：

```
.ui-slider-range {
    background:url(http://qupload.com/images/ratingslid.png) no-repeat 0 bottom;
    width:30px;
    height:161px;
} 
```

[**演示**](http://jsfiddle.net/pVLVd/)

# ruby - 为什么我在 Ruby 中的反引号不起作用？

> ID：14093146
> 
> 赞同：3
> 
> 时间：2012-12-30T18:01:23.900
> 
> 标签：ruby, bash

我有这个代码

```
`ifconfig`

%x(ifconfig)

system("ifconfig") 
```

当我运行它时，只有“系统（“ifconfig”）”有效。我知道是因为我先分别运行它们。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T18:09:29.930

反引号和 %x 变体在变量中返回结果的输出。`system()`将调用命令并返回`!!return_code`。

```
1.9.3p327 :001 > `ifconfig`
 => "eth2: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>..."

1.9.3p327 :002 > %x(ifconfig)
 => "eth2: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>..."

1.9.3p327 :003 > system("ifconfig")
eth2: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
...
 => true 
```

# continuous-integration - 如何阻止 Chef 部署测试失败的代码？

> ID：14093147
> 
> 赞同：4
> 
> 时间：2012-12-30T18:01:44.340
> 
> 标签：continuous-integration, chef-infra, continuous-deployment

上周我一直在增加 Chef 并准备（在情感上和操作上）停止使用 Capistrano。（我们正在托管一个 Rails 应用程序。）

我们遵循 GitHub 流程，这意味着我们只有 master 和一系列功能分支。现在我们使用 Jenkins 进行持续集成和持续部署，我们使用 Capistrano 部署`master`到我们的服务器——但只有在我们的单元、集成和验收测试通过之后。

我正在使用 Chef 的`deploy_revision`资源，我对它的运行效果感到非常兴奋。我渴望从“推”到“拉”。但除非我们的测试通过，否则我不想部署代码。我坚持在实现这种效果的替代方法之间进行选择：

1.  将 Chef 指向一个标签（例如`2.0`），并在我们的部署方案中定期更新该标签。（我不喜欢这样，因为它不是真正的持续部署。我们现在又回到了每次想要发布代码时都手持代码的方式。）
2.  将 Chef 指向一个分支，`master -> release`在测试套件通过后让 Jenkins 合并。（我不喜欢这样，因为现在我的 Jenkins 服务器对我的存储库具有读/写访问权限。）
3.  不要将 Chef 配置为定期运行，而是让 Jenkins`chef-client`通过 SSH 运行。（我不喜欢这样，因为我期待有一天我们的 Jenkins 机器不再拥有对我们服务器的 SSH 访问权限。）
4.  部署代码，但如果之后测试失败，则恢复提交。（在我看来，太容易出错了。）

我确实认为我已经完成了足够多的功课。我一直在关注[Steve Jang 的详尽](http://tech.hulu.com/blog/2012/07/06/automating-system-provisioning-and-application-deployment-with-chef/)文章等，并且在[Chef 文档](http://docs.opscode.com)上花费了数小时的时间。但是在所有关于使用 Chef 进行持续部署的优秀社区教程中，我没有看到任何提及这个特定用例的内容。

我可以接受上述大多数选项，但如果我知道这是一种行之有效的方法，我会感觉更好。我相信其他组织已经解决了这个问题。你是怎么做到的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:17:04.700

您可以设置一个小脚本来侦听来自 Jenkins 的 prod 并为您运行 chef - 换句话说，为 Jenkins 进行有限形式的触发访问，不需要完全 SSH 访问。

另一种选择是拥有 Jenkins 合并的存储库的单独克隆`master`->`release`到，这不是您的开发存储库。然后让 Chef 从那里拉取（或者让 Chef 在那里查找修订版，并从原始存储库中提取该修订版，这会让您更加确信没有人在两者之间人为地弄乱了提交）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T22:59:31.860

我使用的一种解决方案是保护环境变量（特别是，`ENV['deploy_build']`）后面的厨师食谱中的实际代码部署。与实际部署代码无关的所有内容都留在了这些守卫之外的食谱中，厨师客户端每半小时愉快地运行一次，以确保基本系统已准备就绪。

当构建和测试运行成功时，构建系统会触发以下形式的 ssh：

`ssh deploy_system deploy_build=true chef-client`

这允许配方部署最新的构建。这特别有帮助，因为我们的构建系统需要以特定顺序将更新部署到服务器，因此可以从构建系统（jenkins）进行编排

# java - 链接异常是否有效

> ID：14093153
> 
> 赞同：2
> 
> 时间：2012-12-30T18:02:12.123
> 
> 标签：java, exception-handling

在测试类的过程中，我发现我的类构造函数可以采用“非法参数”。构造函数需要一个 URI。显然，如果没有任何迹象表明传递的参数是一个 URI，那么它会抛出一个`IllegalArgumentException`.

我的构造函数最初测试了传递的参数以查看它是否是有效的 URI（通过从中创建文件）。然后我对其进行了修改以尝试创建文件并捕获`IllegalArgumentException`. 在我的`catch`块的主体中​​，我只是这样做：

```
throw new URISyntaxException(passedArgument, message) 
```

这是捕获可能引发的异常的有效方法，还是我应该以其他方式进行？

另外，当我在测试时发现这个问题时，我是否有理由简单地修改代码以引发我期望的异常（这是一个更明显的错误呈现给用户，并放入日志中）？

**编辑1：**针对评论，这是我的代码示例：

```
public myClass (String fileName) throws URISyntaxException {
    try {
        fileToRead = new File(fileName);

        if ( !fileToRead.canRead() ) { //confirm we can read the passed file
            // if not, throw a URI error
            throw new URISyntaxException(fileName, 'bad filename passed, please check path and try again');
        }
    } catch ( IllegalArgumentException e ) {
        throw new URISyntaxException(fileName, 'bad filename passed, please check path and try again');
    }
} 
```

`catch`本质上我的问题是，在 ? 的块内抛出 URI 异常是否有效`IllegalArgumentException`？这是一种有效的做法，还是我可以做得更好？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T18:07:12.250

是的，它既有效又是最佳实践，但您应该抛出自定义异常或 IllegalArgumentException 说明构造函数参数错误，而不是 UriException

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-30T18:20:05.693

您所做的并不是真正的[异常链接](http://en.wikipedia.org/wiki/Exception_chaining)，除非您实际上将捕获的异常包装在您抛出的异常中。相反，您只是通过尝试一个您知道如果违反先决条件将引发特定异常的操作来检测违反先决条件，然后通过引发另一个异常来报告违规。

我看到的唯一潜在问题是您是否*真的*确定您正在尝试的操作只会抛出您在特定情况下捕获的异常。如果可能有多个原因导致此操作抛出`IllegalArgumentException`.无效，只是因为*其他*一些论点无效）。

基本上，每当您捕获一个通用异常并抛出一个更具体的异常时，您可能会误认为通用异常的原因。但是如果你*确定*不存在这样的风险——例如，如果你调用的代码清楚地记录了它在什么条件下可能抛出的异常——那么它应该没问题。

* * *

**将实际代码添加到问题后进行**编辑：****

 **大部分与上面讨论的一般原则无关，我看到你的代码有几个具体问题。

1.  First, if the `File` class your code uses is indeed [`java.io.File`](http://docs.oracle.com/javase/7/docs/api/java/io/File.html), and you're passing the filename to the constructor as a `String` rather than as a `URI` object, then [the constructor you're calling](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#File%28java.lang.String%29) isn't documented to throw an `IllegalArgumentException` in any case, so trying to catch one is pointless. The only `File` constructor that throws those is [this one](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#File%28java.net.URI%29).

2.  Second, the fact that [`File.canRead()`](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#canRead%28%29) returns false doesn't necessarily mean that the filename is invalid — it might be perfectly valid, and the file might even exist, but your program might not have the necessary permissions to read it.

3.  最后，正如其他人指出的那样，我不确定`URIException`您实际上抛出的 " " 是什么，除非它是您编写的自定义类（有一个[`javax.print.URIException`](http://docs.oracle.com/javase/7/docs/api/javax/print/URIException.html)，但那是一个接口，而不是一个类；唯一的另一个我可以从 Apache HTTP 客户端找到[一个](http://hc.apache.org/httpclient-3.x/apidocs/org/apache/commons/httpclient/URIException.html)），但至少该名称似乎完全不适合您用来报告无效（或不可读）*文件名*的异常。你真的应该为此使用其他一些例外。**

# javascript - 使用数组更改 video.src

> ID：14093154
> 
> 赞同：0
> 
> 时间：2012-12-30T18:02:32.260
> 
> 标签：javascript

我已经尝试让它工作了几天，研究如何做到这一点，一遍又一遍地改变它，但它就是行不通。我要么愚蠢要么盲目。我想编写一个简单的视频播放器...我认为对于初学者来说这很容易 T_T

这是html文件：

```
<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
<script language="JavaScript" src="player.js"></script>
</head>

<body onkeydown="GetKey()" onload="VideoList()">

<div style="text-align:center">
  <img src="images/Magipoka.jpg" onclick="window.location='Magipoka.html'">
  <img src="images/puni.jpg" onclick="window.location='puni.html'">
  <br>
  <video id="currentVideo" autoplay="true" preload="auto"    onended="Playnext()"   
 onclick="goFullscreen('currentVideo'); return false" ;=""> 

  <source src="Magipoka.mp4" type="video/mp4"> 
  <source src="Magipoka.ogv" type="video/ogv"> 
  Your browser does not support HTML5 video. 
  </video>
</div>

<div style="text-align:center"> 
   <button onclick="LoopToggle()">Loop</button>
   <button onclick="LoopToggleOff()">LoopOff</button>
   <button onclick="playPause()">Play/Pause</button> 
  </div>
  <script language="JavaScript" src="Body_Scripts.js"></script>

</body>
</html> 
```

正文 js 文件：

```
var Video=document.getElementById("currentVideo"); 
var VideoCount = 0;
var source = new Array();   

function VideoList(){
    source[0].src = "Magipoka.ogv";
    source[1].src = "puni.ogv";
}

function playPause()
{ 
 if (Video.paused) 
 Video.play(); 
 else 
 Video.pause(); 
}

function LoopToggle(){
  if (Video.ended)
    Video.play();
    if(Video.loop="false")
      video.loop=true;
      else
      video.loop=null;
      }

function Repeat(){
    if(Video.ended)
    Video.paused();
    Video.play();
}

function Playnext(){
 Video.src = source[VideoCount];
    //alert(VideoCount);
VideoCount++;
 alert(source[1]);
} 
```

头js文件：

```
function goFullscreen(id) {
// Get the element that we want to take into fullscreen mode
var element = document.getElementById(id);

// These function will not exist in the browsers that don't support fullscreen mode yet, 
// so we'll have to check to see if they're available before calling them.

if (element.mozRequestFullScreen) {
  // This is how to go into fullscren mode in Firefox
  // Note the "moz" prefix, which is short for Mozilla.
  element.mozRequestFullScreen();
} else if (element.webkitRequestFullScreen) {
  // This is how to go into fullscreen mode in Chrome and Safari
  // Both of those browsers are based on the Webkit project, hence the same prefix.
  element.webkitRequestFullScreen();
}
// Hooray, now we're in fullscreen mode!
}
//-----------------
function GetKey(e) { var code; if (!e) var e = window.event; if (e.keyCode)
code = e.keyCode; else if (e.which) code = e.which; var character =
String.fromCharCode(code); setTimeout('ShowTree('+code+');',100);
}
function ShowTree(character, a){
if (character == 49){
window.location='puni.html' }
if (character == 50){
window.location='magiPoka.html' }
} 
```

# ios - 如何在 iOS 分析 SDK 中使用 Google 的用户计时功能

> ID：14093155
> 
> 赞同：0
> 
> 时间：2012-12-30T18:02:41.420
> 
> 标签：ios, xcode, google-analytics, analytics

我在我的 iOS 应用程序中使用 Google Analytics，我正在尝试使用他们的用户计时功能来记录我的后端 HTTP 服务器的响应速度。代码如下图：

```
NSTimeInterval interval = [date timeIntervalSinceNow];
[self.tracker trackTimingWithCategory:@"request"
                            withValue:interval
                             withName:request.URL.absoluteString
                            withLabel:nil]; 
```

但是，Google Analytics 的报告中没有显示任何内容，知道吗？我该如何调试呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:17:54.087

我认为您在这里遇到的问题之一是第二个参数的负值。可以尝试这样的事情：

```
NSTimeInterval interval = -[date timeIntervalSinceNow];
[self.tracker trackTimingWithCategory:@"request"
                            withValue:interval
                             withName:request.URL.absoluteString
                            withLabel:nil]; 
```

注意第一行中多余的“-”。

另一种方法是使用其他跟踪机制之一，例如事件/自定义变量或指标。

# c++ - 为什么要模板 在 C++ 中评估为 Foo 而不是 Bar

> ID：14093157
> 
> 赞同：2
> 
> 时间：2012-12-30T18:02:59.050
> 
> 标签：c++, pointers, inheritance, polymorphism, generic-programming

在这段代码中，为什么 typename T（在 Test(...) 函数中）评估为类型 Foo 而不是类型 Bar？我怎样才能改变它，使它变成 Bar 类型？

```
#include <typeinfo>
using namespace std;

struct Foo
{
    virtual ~Foo() { }
};

struct Bar : public Foo
{
};

template<typename T>
bool Test(T foo)
{
    return (typeid(foo) == typeid(Bar));
}

int main()
{
    Bar bar;
    Foo *foo = &bar;
    bool THIS_IS_TRUE = (typeid(*foo) == typeid(Bar));
    bool WHY_ISNT_THIS = Test(*foo);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T18:06:51.513

模板是基于静态类型而不是动态类型推导出来的。代码是根据编译器在编译时知道的内容静态绑定和创建的，与运行时周围的类型无关。此外，当您`*foo`按值传递时，无论如何您都在对对象进行切片。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-30T18:06:55.990

模板是在编译时完成的，因此它们无法确定您传递给它们的运行时类型。

无论如何，由于您是按值传递的，因此您将转换和切片到对象，这将丢失有关原始类型的信息`Bar`。请尝试参考：

```
template<typename T>
bool Test(T& foo)
{
    return (typeid(foo) == typeid(Bar));
} 
```

`T`还是会被推到`Foo`，但`typeid(foo)`应该是`Bar`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T18:04:59.457

您必须保留指针或通过引用传递值，不能通过副本传递变量（按值传递）。

尝试这个 ：

```
template<typename T>
bool Test(T foo)
{
    return (typeid(*foo) == typeid(Bar));
}

int main()
{
    Bar bar;
    Foo *foo = &bar;
    bool THIS_IS_TRUE = (typeid(*foo) == typeid(Bar));
    bool WHY_ISNT_THIS = Test(foo);
    return 0;
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T20:04:53.733

你想做什么是行不通的。这是另一种方法，我基本上构建自己的类型基础设施：

```
#include <functional>
struct Base {
protected:
  virtual ~Base() {}
  Base() {}
public:
  virtual size_t SizeRequired() const = 0;
  virtual std::function<Base*(unsigned char* buffer)> Constructor() const = 0;
  // note that standard delete is not standards compliant, because the memory
  // was allocated as an array of unsigned char's
  void SelfDelete() {
    SelfDestroy();
    delete[] reinterpret_cast<unsigned char*>(this);
  }

  // you can also create these things in other storage locations:
  void SelfDestroy() {
    this->~Base();
  }
  static void Delete( Base* b ) {
    if (b)
      b->SelfDelete();
  }
  std::function<Base*()> AllocateAndConstructor() const {
    size_t required = this->SizeRequired();
    auto constructor = this->Constructor();
    return [required, constructor]()->Base* {
      unsigned char* buff = new unsigned char[ required ];
      return constructor( buff );
    };
  }
};

// CRTP class (google CRTP if you are confused what I'm doing)
template<typename Child>
struct BaseHelper: Base {
  static Base* Construct(unsigned char* buffer) {
    return new(buffer) Child();
  }
  static Base* Create() {
    unsigned char* buff = new unsigned char[ sizeof(Child) ];
    return Construct( buff );
  };
  virtual size_t SizeRequired() const {
    return sizeof(Child);
  }
  virtual std::function<Base*(unsigned char* buffer)> Constructor() const {
    return &BaseHelper<Child>::Construct;
  }
};

// use:

struct Bar: BaseHelper<Bar> {
};
struct Foo: BaseHelper<Foo> {
};

Base* test(Base* b) {
  auto creator = b->AllocateAndConstructor();
  return creator();
}
#include <iostream>
int main() {
  Base* b = Bar::Create(); // creates a Bar
  Base* b2 = test(b); // creates another Bar, because b is a Bar
  Base* f = Foo::Create(); // creates a Foo
  Base* f2 = test(f); // creates another Foo, because f is a Foo
  std::cout << (typeid(*b) == typeid(*b2)) << " == 1\n";
  std::cout << (typeid(*f) == typeid(*f2)) << " == 1\n";
  std::cout << (typeid(*f) == typeid(*b)) << " == 0\n";
  Base::Delete(b);
  Base::Delete(b2);
  Base::Delete(f);
  Base::Delete(f2);
  Base::Delete(0); // does not crash
}; 
```

这意味着 Base 的每个运行时实例都带有构造 Base 实例的能力。覆盖 new 和 delete 可能比使用上述替换创建和删除操作更好，并且会让某人在堆栈上创建这些东西。

除非您知道自己在做什么，否则我建议您不要使用这种技术。

然而，有一些相对常见的模式，如克隆和工厂，它们与上述模式接近，但不那么愚蠢。

# c# - WinRT 中的简单图像处理

> ID：14093164
> 
> 赞同：0
> 
> 时间：2012-12-30T18:03:47.970
> 
> 标签：c#, image, windows-runtime, processing

我正在开发一个需要一些图像处理的 WinRT 应用程序。到目前为止我已经做了类似的事情，但是在 Java 中，我也想在 WinRT 应用程序中做一些简单的事情......但我似乎无法使用 API 来管理我的方式......

长话短说，我在我的页面上的 xaml 中`image`有一个使用文件选择器获取图像的文件。然后，当我单击“否定”按钮时，图像应该被否定。

现在，否定按钮的方法，我想看起来像这样：

```
private void OnNegativateButtonClick(object sender, RoutedEventArgs e)
    {
        var imageToNegativate = ImagePanel.Source as WriteableBitmap ;

        if (imageToNegativate == null) //Actually is ALWAYS null :(
        {
            //Wrong code here...
            var bitmapSource = ImagePanel.Source as BitmapSource;
            imageToNegativate = new WriteableBitmap(imageToNegativate.PixelWidth, imageToNegativate.PixelHeight);
        }
        imageToNegativate = ImageUtil.Negativate(imageToNegativate);
        ImagePanel.Source = imageToNegativate;
    } 
```

[这与我在此处](http://code.msdn.microsoft.com/windowsdesktop/Metro-Style-lightweight-24589f50)找到的示例非常相似，但是该示例项目甚至无法加载，因此我尝试单独打开文件...我的代码是用于否定的方法，只是`wb = new WriteableBitmap(bs);`他的`if (wb==null) { ... }`.

从 中获取 WriteableBitmap 的方法是什么`image`，进行一些像素操作，然后使用新的 WriteableBitmap 设置图像的源...

我说的是`WriteableBitmap`因为我的否定方法使用一个作为输入，进行一些处理并输出它。（同类型，`WriteableBitmap`.

非常感谢任何建议或帮助，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:29:03.590

第一个问题是这些代码行：

```
var imageToNegativate = ImagePanel.Source as WriteableBitmap ;
if (imageToNegativate == null) //Actually is ALWAYS null :( 
```

null 告诉你*那*`ImagePanel.Source`不是type ; 您的类型转换失败。这是意料之中的；选择器会给你一些只读的东西，因为只读图像的性能更高（如果 WinRT 知道图像的内容不会改变，它可以做一些优化）。只有当您明确创建一个时，您才会得到一个。*`WriteableBitmap``WriteableBitmap`*

 *你的块的主体`if`也没有多大意义——你试图创建一个`WriteableBitmap`与原始图像大小相同的新的空图像，然后你尝试在那个*空图像上做一个反向视频。*即使你走了那么远，你也只会得到另一个空图像。您没有做任何事情来保留原始图像中的像素。

您确实需要一个`WriteableBitmap`来访问像素缓冲区，但您需要制作一个原始图像的副本。摆脱你的演员和`if`阻止，试试这个：

```
var imageToNegativate = new WriteableBitmap(ImagePanel.Source); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T07:26:26.793

Joe 说您的代码有什么问题是正确的，但是虽然他的答案可能适用于 WPF - 他提到的构造函数在 WinRT/XAML 中确实不存在。事实上，没有办法从 BitmapImage 创建 WriteableBitmap，唯一的攻击方法是从 BitmapImage 的源创建 WriteableBitmap。

一种方法是创建一个新的 1x1 大小的 WriteableBitmap，然后在 BitmapImage 的源上使用它的 SetSource 方法。由于 BitmapImage.UriSource 属性是一个 Uri 并且 WriteableBitmap.SetSource() 需要一个 Stream - 您需要使用它来查找或下载实际的图像文件并打开一个流来读取它。我的工具包有一些扩展方法（[WriteableBitmap.FromBitmapImage()](http://winrtxamltoolkit.codeplex.com/SourceControl/changeset/view/774de4ce5f1f#WinRTXamlToolkit/Imaging/WriteableBitmapFromBitmapImageExtension.cs)）来帮助你，以防你的图像来自你的应用程序包，并且你可以很容易地扩展它来处理下载的图像。

问题是——这样你会效率低下——一个是你需要打开和解码文件两次（对于 ARM 设备上的大图像，这可能会很慢——去过那里，做到了），第二个是你可能需要如果文件来自网络，请重新下载文件，第三，如果将关联的图像控件的 CacheMode 设置为 BitmapCache，则 WinRT/XAML 中存在导致 BitmapImage 的 UriSource 属性变为空的错误，因此您可能[需要](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/f2a2348d-49b5-404c-b932-dc60ffd5828a)无论如何单独跟踪您的来源。

在许多方面，最好的解决方案是简单地确保从一开始就将源图像作为 WriteableBitmap 打开，因此如果您想更改它甚至不必创建另一个位图。在您的情况下，用户选择了图像文件，因此只有一个文件，并且之后似乎很有可能被处理，因此将其作为 WriteableBitmap 打开听起来是正确的做法。

也许即使您想保留图像的原始版本和处理后的版本 - 创建相同大小的新 WriteableBitmap 并复制原始像素可能比解码大图像文件两次更快（尤其是在 ARM 设备上）。*

# web-services - Google Places 与 Qype 与其他

> ID：14093166
> 
> 赞同：0
> 
> 时间：2012-12-30T18:04:04.693
> 
> 标签：web-services, google-places

目前我正在研究区域评估系统。

我实际上想知道区域是如何组成的，假设给定一个经纬度坐标和一个半径。因此，我真的希望能够按类型分开，并且数据也必须是最新的。

因此，如果以下因素很重要，您推荐哪些基于 API 的服务：

*   支持带搜索半径的纬度/经度坐标
*   按位置类型区分
*   最新信息

据我所知，Google Places 和 qype.com 提供的 API 应该能够做到这一点。有没有更好的选择，或者您推荐两者中的哪一个，为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T11:08:57.653

据我所知，只有 Qype 和 Google Places 提供 API。Google 每天免费提供 1000 个请求，而 Qype 只提供 200 个请求，但一个人可以在 Qype 中申请多个密钥，这使您每天可以进行更多请求。

使用 Qype 可以检查范围内的全部商业机构（边界框或半径），而 google places 则限制每个请求最多 60 个位置。

这就是我决定使用 Qype 的原因。关于信息是否是最新的，我没有做评估，但是 Qype 在应用于慕尼黑时显示出合理的结果。

# objective-c - TableView reloadData 不调用 cellForRowAtIndexPath

> ID：14093169
> 
> 赞同：0
> 
> 时间：2012-12-30T18:04:28.317
> 
> 标签：objective-c, ios, uitableview

我有两个视图控制器/ 1\. SetupRingBoardViewController 2\. SetupRingBoard* *ADD* *ViewController

第一个视图控制器是 UITableViewController。当我们第一次启动视图时 - ViewController 有 1 个固定部分和 1 个固定行。在那个 ViewController 中，有一个 UIBarButton 正在调用 SetupRingBoardADDViewController（模式 - 默认，我正在使用情节提要）。

第二个视图控制器是 UIView 控制器。这个 viewController 包含一个 UITableView 和一个 UINavigationBar。UITableView 实际上是一个很大的表单，用户可以在其中输入数据。UINavigationBar 包含一个“添加”UIBarButton。按下此按钮时，将调用方法“addButton”。

'addButton' 方法应该刷新 SetupRingBoardViewController 中的 UITableView。 **最后，按下“addButton”按钮后，SetupRingBoardViewController 的 UITableView 中应该有 2 个部分：** 1\. 固定部分，其中有 1 行。2\. 一个有X行的部分，每一行都有一个标题：@“A Row！”；（X = 'addButton' 被按下的数量）。

最后，代码如下：

SetupRingBoardViewController.h：

```
//
//  SetupRingBoardViewController.h
// 
//
//  Created by  on 12/24/12.
//  Copyright (c) 2012 Noam. All rights reserved.
//

#import <UIKit/UIKit.h>
#import "SetupRingBoardADDViewController.h"
//#import "StudyHour.h"

@interface SetupRingBoardViewController : UITableViewController
@property (nonatomic, strong) NSMutableArray *listOfStudyHours;

@end 
```

SetupRingBoardViewController.m：

```
//
//  SetupRingBoardViewController.m
//  
//
//  Created by on 12/24/12.
//  Copyright (c) 2012 Noam. All rights reserved.
//

#import "SetupRingBoardViewController.h"
#import "SetupEmptyListViewController.h"
@interface SetupRingBoardViewController ()

@end

@implementation SetupRingBoardViewController

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {
        // Custom initialization
    }
    return self;
}

-(id)init
{
    self = [super init];
    if(self != nil)
    {
        if(!_listOfStudyHours) _listOfStudyHours = [[NSMutableArray alloc] init];
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    if(_listOfStudyHours) NSLog(@"%@",_listOfStudyHours);
    [self.tableView reloadData];
    // Uncomment the following line to preserve selection between presentations.
    // self.clearsSelectionOnViewWillAppear = NO;

    // Uncomment the following line to display an Edit button in the navigation bar for this view controller.
    // self.navigationItem.rightBarButtonItem = self.editButtonItem;

    //[self.tableView reloadData];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // Return the number of sections.
    if(![_listOfStudyHours count])
    {
        NSLog(@"numberOfSectionsInTableView: 1");
        return 1;
    }
    else return 2;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // Return the number of rows in the section.
    if(section == 0) return 1;
    else return [_listOfStudyHours count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    if(![indexPath section])
    {
        NSLog(@"It got to the first");
        static NSString *CellIdentifier = @"Cell";
        UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

        // Configure the cell...

        return cell;
    }
    else
    {
        NSLog(@"It got to the second");
        UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"Cell" forIndexPath:indexPath];
        cell.textLabel.text = [_listOfStudyHours objectAtIndex:indexPath.row];
        return cell;
    }
}

/*
// Override to support conditional editing of the table view.
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the specified item to be editable.
    return YES;
}
*/

/*
// Override to support editing the table view.
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete) {
        // Delete the row from the data source
        [tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationFade];
    }   
    else if (editingStyle == UITableViewCellEditingStyleInsert) {
        // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view
    }   
}
*/

/*
// Override to support rearranging the table view.
- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath toIndexPath:(NSIndexPath *)toIndexPath
{
}
*/

/*
// Override to support conditional rearranging of the table view.
- (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the item to be re-orderable.
    return YES;
}
*/

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    [tableView deselectRowAtIndexPath:indexPath animated:YES];
    // Navigation logic may go here. Create and push another view controller.
    /*
     <#DetailViewController#> *detailViewController = [[<#DetailViewController#> alloc] initWithNibName:@"<#Nib name#>" bundle:nil];
     // ...
     // Pass the selected object to the new view controller.
     [self.navigationController pushViewController:detailViewController animated:YES];
     */
}

@end 
```

SetupRingBoardADDViewController.h ：

```
//  SetupRingBoardADDViewController.h
//  
//
//  Created by on 12/26/12.
//  Copyright (c) 2012 Noam. All rights reserved.
//

#import <UIKit/UIKit.h>
#import "SetupRingBoardViewController.h"
#import "UITableViewCell+Checkmark.h"
//#import "StudyHour.h"

@interface SetupRingBoardADDViewController : UIViewController <UITableViewDataSource, UITableViewDelegate>

- (IBAction)addButton:(id)sender;
@end 
```

SetupRingBoardADDViewController.m：

```
- (IBAction)addButton:(id)sender {
        SetupRingBoardViewController *rbVC = [[SetupRingBoardViewController alloc] init];
        [rbVC.listOfStudyHours addObject:@"A row!"];
        NSLog(@"%@",rbVC.listOfStudyHours);
        [[rbVC tableView] reloadData];
        [self dismissViewControllerAnimated:YES completion:nil];
} 
```

（这不是完整的代码，但它是唯一相关的。）

**问题是当我调用 [tableView reloadData] 时没有调用方法 cellForRowAtIndexPath。**

我希望你能帮助我，我试图弄清楚很长一段时间：/

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T18:10:21.997

请检查您是否已将委托和数据源设置/连接到文件的所有者。

并检查模型的数组计数，如果它包含 not 的值？

NSLog 在`numberOfRowsInSection`方法中并通过使用**断点**和单**步**检查它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T19:04:46.913

我认为您需要进行 2 处更改。一，将数组的创建放在 viewDidLoad 而不是 init 中（如果您在情节提要中创建表视图控制器，则不会调用 initWithStyle: 或 init - initWithCoder: 将是，因此您可以使用它而不是 viewDidLoad）：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    if(!_listOfStudyHours) _listOfStudyHours = [[NSMutableArray alloc] init];
    if(_listOfStudyHours) NSLog(@"%@",_listOfStudyHours);
    [self.tableView reloadData];
} 
```

其次，在您的按钮方法中，您需要返回到您来自的同一个实例，而不是创建一个新实例。您可以使用 presentingViewController 属性来做到这一点：

```
- (IBAction)addButton:(id)sender {
    SetupRingBoardViewcontroller *rbVC = (SetupRingBoardViewcontroller *)self.presentingViewController;
    [rbVC.listOfStudyHours addObject:@"A row!"];
    NSLog(@"%@",rbVC.listOfStudyHours);
    [[rbVC tableView] reloadData];
    [self dismissViewControllerAnimated:YES completion:nil];
} 
```

# javascript - 如何创建包含自动完成框以选择条目的模式弹出窗口？

> ID：14093171
> 
> 赞同：1
> 
> 时间：2012-12-30T18:04:33.027
> 
> 标签：javascript, html, modal-dialog, jquery-autocomplete

是否可以在 Javascript 中创建某种包含 JQueryUI 自动完成功能的模式框？

用户单击一个图标，该框将打开，用户将选择一个值，javascript 将检索它并将其设置为`<div>`.

如果是，我应该如何进行？任何代码示例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:24:58.247

是的，这是可能的。只需将自动完成输入放在jquery对话框模态html中，例如：

```
<div id="dialog-form" title="Search">
    <div class="ui-widget">
        <label for="tags">Tags: </label>
        <input id="tags" />
    </div>
</div>

<button id="open-search">Open search</button>

<div id="result"></div> 
```

然后只需打开模式并在关闭时设置值：

```
$("#dialog-form").dialog({
    autoOpen: false,
    modal: true,
    close: function() {
        var value = $("#tags").val();
        $("#result").html(value);
    }             
});

$("#tags").autocomplete({
    source: ["ActionScript", "AppleScript", "Asp"]
});

// Maybe use this on your icon, to open the modal.
$("#open-search").click(function() {
    $("#dialog-form").dialog("open");
}); 
```

这是小提琴中的完整示例：http: [//jsfiddle.net/Uvx8s/2/](http://jsfiddle.net/Uvx8s/2/)

# android - 在活动和片段之间传递捆绑值时应用程序崩溃

> ID：14093175
> 
> 赞同：0
> 
> 时间：2012-12-30T18:04:54.553
> 
> 标签：android, android-intent, android-fragments

我正在尝试通过单个选项列表视图片段将一些数据从我的 ListView 发送到另一个活动。数据流应该是这样的：

**ListView（在选择一个选项时）-> 单个选项列表视图片段（再次，在选择一个选项时）-> AnotherActivity。**

将数据从 ListView 发送到 Fragment 的代码：

```
Bundle b = new Bundle();
b.putString("id", str_projectid);
Projectviewoptions pv = new Projectviewoptions();
pv.setArguments(b);

Projectviewoptions newFragment = new Projectviewoptions();
newFragment.show(getFragmentManager(), "projectoptions"); 
```

接收数据然后将其发送到其他活动的代码片段类：

```
public class Projectviewoptions extends DialogFragment {

String[] option_array = new String[] {"Project details","Edit","Delete","Mark Done"};
Bundle idbundle = getArguments(); 
String myid= idbundle.getString("id"); 

@Override
public Dialog onCreateDialog(Bundle savedInstanceState) {
    AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
    builder.setTitle("Options")
           .setItems(option_array, new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int which) {

                switch(which) {

                case 0: Intent intent = new Intent(getActivity(),ViewProjectDetails.class);
                        intent.putExtra("id", myid);
                        startActivity(intent);
                        break;

                }

           }
    });
    return builder.create();
}
} 
```

接收片段传递的数据的 OtherActivity 中的代码：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_view_project_details);

    String id = getIntent().getExtras().getString("id");
    Toast.makeText(this, id, Toast.LENGTH_LONG).show();
} 
```

**问题：** 当我从 ListView 中选择一个选项时，应用程序崩溃。如果我删除处理数据传递的代码，则该应用程序可以正常工作。也就是说，如果您在 ListView 中删除以下代码：

```
/*Bundle b = new Bundle();
      b.putString("id", str_projectid);
      Projectviewoptions pv = new Projectviewoptions();
      pv.setArguments(b);*/ 
```

以及以下，在片段类中：

```
//Bundle idbundle = getArguments(); 
//String myid= idbundle.getString("id"); 
```

这是LogCat：

```
12-30 23:21:09.620: W/dalvikvm(7406): threadid=1: thread exiting with uncaught
exception (group=0x409c01f8)
12-30 23:21:09.653: E/AndroidRuntime(7406): FATAL EXCEPTION: main
12-30 23:21:09.653: E/AndroidRuntime(7406): java.lang.NullPointerException
12-30 23:21:09.653: E/AndroidRuntime(7406):     at     
com.kk.project.Projectviewoptions.<init>(Projectviewoptions.java:14)
12-30 23:21:09.653: E/AndroidRuntime(7406):     at 
com.kk.project.ProjectExplorer.onListItemClick(ProjectExplorer.java:53)
12-30 23:21:09.653: E/AndroidRuntime(7406):     at 
android.app.ListActivity$2.onItemClick(ListActivity.java:319)
12-30 23:21:09.653: E/AndroidRuntime(7406):     at 
android.widget.AdapterView.performItemClick(AdapterView.java:292)
12-30 23:21:09.653: E/AndroidRuntime(7406):     at    
android.widget.AbsListView.performItemClick(AbsListView.java:1058)
12-30 23:21:09.653: E/AndroidRuntime(7406):     at  
android.widget.AbsListView$PerformClick.run(AbsListView.java:2514)
12-30 23:21:09.653: E/AndroidRuntime(7406):     at   
android.widget.AbsListView$1.run(AbsListView.java:3168)
12-30 23:21:09.653: E/AndroidRuntime(7406):     at 
android.os.Handler.handleCallback(Handler.java:605)
12-30 23:21:09.653: E/AndroidRuntime(7406):     at   
android.os.Handler.dispatchMessage(Handler.java:92)
12-30 23:21:09.653: E/AndroidRuntime(7406):     at     
android.os.Looper.loop(Looper.java:137)
12-30 23:21:09.653: E/AndroidRuntime(7406):     at  
android.app.ActivityThread.main(ActivityThread.java:4424)
12-30 23:21:09.653: E/AndroidRuntime(7406):     at   
java.lang.reflect.Method.invokeNative(Native Method)
12-30 23:21:09.653: E/AndroidRuntime(7406):     at 
java.lang.reflect.Method.invoke(Method.java:511)
12-30 23:21:09.653: E/AndroidRuntime(7406):     at  
com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
12-30 23:21:09.653: E/AndroidRuntime(7406):     at  
com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
12-30 23:21:09.653: E/AndroidRuntime(7406):     at    
dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T18:07:57.197

您不能在任何方法之外访问 Fragment 的参数，只需将此代码移入`onCreateDialog()`：

```
Bundle idbundle; 
String myid; 

@Override
public Dialog onCreateDialog(Bundle savedInstanceState) {
    idbundle = getArguments();
    myid = idbundle.getString("id");
    ... 
```

问题是`getArguments();`当您尝试在 Fragment 的生命周期开始之前访问它时返回 null，`idbundle.getString()`NPE 也是如此。

* * *

**添加**您正在创建名为and
的同一片段的两个不同副本，您应该完全显示和删除：`pv``newFragment``pv``newFragment`

```
Bundle b = new Bundle();
b.putString("id", str_projectid);
Projectviewoptions pv = new Projectviewoptions();
pv.setArguments(b);
pv.show(getFragmentManager(), "projectoptions"); 
```

 ~~~~```
Projectviewoptions newFragment = new Projectviewoptions();
newFragment.show(getFragmentManager(), "projectoptions"); 
```~~~~

# c++ - 同步和异步 API

> ID：14093176
> 
> 赞同：4
> 
> 时间：2012-12-30T18:04:55.627
> 
> 标签：c++, api, asynchronous, synchronous

我正在开发一个库，它提供一些耗时的服务。我需要每个 API 有两个版本，一个用于同步函数调用，另一个用于异步。

图书馆用户应决定使用哪个版本，服务结果可能对系统操作的继续（同步调用）至关重要。可能需要在不同的工作线程中完成相同的操作，因为结果不需要继续（异步调用）。

**这种方法有什么问题？**

**有没有更好的办法？**

**是否有流行的库为同一个 API 提供同步/异步（不使用外部事件或线程）？**

这是我将要提供的示例：

```
enum StuffStatus
{
    SUCCEED,
    FAILED,
    STILL_RUNNING
};
class IServiceCallback
{
public:
    void lengthyStuffCallback(StuffStatus status);
};

class MyServiceClass
{
public:
    StuffStatus doSomeLengthStuff(IServiceCallback* callback)
    {
        if( callback == NULL ) // user wants sync. call
        {
            // do all operations in caller context
            return SUCCEED;
        }else{
            // save the callback, queue the request in a separate worker thread. 
            // and after the worker thread finishes the job it calls callback->lengthyStuffCallback(SUCCEED) from its context.
            return STILL_RUNNING;
        }
    }
}; 
```

**编辑**：作为'Matthieu M.' 提到，在我的服务中，我需要使用延续传递样式进行异步（API 完成后的回调）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T18:15:52.177

如果用户想要调用的异步版本，您可能要考虑*仅*提供同步操作并建议用户使用`std::future<...>`（或类似的工具，如果您不能使用 C++ 2011）！

```
std::future<StuffStatus> async(std::async(&MyServiceClass::doSomeLengthyStuff,
                                          &service));
// do other stuff
StuffStatus status = async.get(); // get the result, possibly using a blocking wait 
```

# php - php链接到另一个页面

> ID：14093183
> 
> 赞同：1
> 
> 时间：2012-12-30T18:05:38.047
> 
> 标签：php, html, wordpress

我正在为我自己的个人网站编辑一个 wordpress 主题。该页面用于博客，当您单击“阅读更多”或博客标题时，它将在单独的页面中打开该博客以进行阅读。但是，当我单击这两件事时，我收到以下消息：

> 服务器错误 网站在检索 mywebsite/wordpress/?p=20 时遇到错误。它可能因维护而停机或配置不正确。以下是一些建议： 稍后重新加载此网页。HTTP 错误 500（内部服务器错误）：服务器尝试完成请求时遇到意外情况。

它以前工作过，所以我知道主题附带的代码有效。继承人的代码：

```
<div class="box">
<?php while ( have_posts() ) : the_post(); ?>
        <article>
            <h2><a href="<?php esc_url( the_permalink() ); ?>"<?php the_title(); ?>" rel="bookmark"><?php the_title(); ?></a></h2>
            <h7>BY LOUIS MOORE ON</h7> <time datetime="<?php the_time( 'Y-m-d' ); ?>" pubdate><?php the_date(); ?> <?php the_time(); ?></time><?php the_content(); ?>
<a href="<?php esc_url( the_permalink() ); ?>"/><h8>READ MORE</a></h8>  </br>   
</br><div class="h9"></div>
</article></br></br></br>
<?php endwhile; ?>

</div> 
```

我不是 php 最优秀的人，除了“阅读更多”、“路易斯·摩尔”、第二个 div 和`</br>`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:57:21.637

HTML 代码中有几个错误。也许这就是问题所在。

你可以试试这个：

```
<div class="box">
  <?php while ( have_posts() ) : the_post(); ?>
  <article>
    <h2><a href="<?php esc_url( the_permalink() ); ?>"> <?php the_title(); ?>" rel="bookmark"><?php the_title(); ?> </a></h2>
    <h7>BY LOUIS MOORE ON</h7>
    <time datetime="<?php the_time( 'Y-m-d' ); ?>"> pubdate><?php the_date(); ?> <?php the_time(); ?></time><?php the_content(); ?>
    <a href="<?php esc_url( the_permalink() ); ?>"> </a>
    <h8>READ MORE</a></h8>
    <br /><br />
    <div class="h9"></div>
  </article><br /><br /><br />
  <?php endwhile; ?>
</div> 
```

# numbers - Tesseract 将 7 混淆为 1，文本不返回任何内容。

> ID：14093184
> 
> 赞同：1
> 
> 时间：2012-12-30T18:05:39.593
> 
> 标签：numbers, field, ocr, tesseract, digits

我正在尝试 OCR 扫描的表格，其中包含数字字段和一些文本。但是，在裁剪后的文本上运行 tesseract 不会产生正确的结果。

例如，对于数字 7：![7 号](../Images/7e71ba49f98af907abc01882bc6409c1.png)

运行时给出的结果是 1：

```
tesseract -psm 10 7test.jpg out digits 
```

尽管中风通过了七。

同时，对于文本字段，它的难度更大，以下字段一无所获：

![测试名称](../Images/2aec9169ac4a125f074837177152e4bf.png)

有什么简单的方法可以提高这里的准确性吗？由于表单的手写性质，理想情况下避免产生大量的训练集。

在名称字段上，我可能可以改进方向并删除包围该字段的线条，但缺少任何输出令人担忧。

对于数字，我不知道，除了可能从表格中生成手动训练集。

# php - PHP MySQL INSERT 查询不再有效（昨天还在工作）

> ID：14093186
> 
> 赞同：0
> 
> 时间：2012-12-30T18:06:03.010
> 
> 标签：php, mysql, insert

我对 INSERT 查询有疑问。

这是问题所在：
昨天我正在使用此代码上传数据，它工作正常。今天，当我在表单上点击提交时，它只显示一个空白页面。没有错误，只是空白。错误日志中没有任何内容。所有 SELECT 查询都工作正常，因此 SELECT Count(id) 查询仍然有效。

这是我尝试过的：

*   重新上传到服务器
*   语法调整，例如 '".$v.'" 而不是 '$v'
*   添加打印行以检查所有变量是否为空。一切都好，所有数据都出现在 INSERT 查询之前。
*   通过我的管理员 PHP 测试插入，一切正常
*   函数调用是正确的 - 从昨天开始并保持不变

该函数获取物种、科和属的列表，然后将它们添加到数据库中。这是代码（未经处理的版本 - 昨天都在工作）：

```
error_reporting(E_ALL);
ini_set('display_errors', '1');

    function submit($family, $genus, $species){

        //require statement
        require 'databaseConnect.php';

        //get num of species
        if(!($result = mysql_query("SELECT Count(id) as num FROM speciesList", $connection))) mysql_error();
            $nums = mysql_fetch_row($result);
            $num=$nums[0];

        //parse species 
        $holder="";
        $array = Array();

        while(strlen($species)!=0){
            if($species[0]==';'){
                $array[] = $holder;
                $holder="";
            }else{
            $holder = $holder . $species[0];

            }

            $species=substr($species, 1);

        }

        foreach($array as $v){
            $num++;
            if(!(mysql_query("INSERT INTO speciesList VALUES($num, '$family', '$genus', '.$v')", $connection))){
                mysql_error();
            }else{
                print "success ";
            }
        }
        mysql_close($connection);
    } 
```

非常感谢您，这个问题对我来说相当神秘！恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:10:16.760

您永远*都*不想使用带参数的字符串替换来构建 SQL 语句，因为这会使您容易受到 SQL 注入攻击。相反，绑定您的参数。

您的代码没有返回错误，因为您调用`mysql_error()`并忽略了返回值。它返回错误字符串，因此您希望您的代码更像这样：

```
if(!(mysql_query("INSERT INTO speciesList VALUES($num, '$family', '$genus', '.$v')", $connection))){
    print_r( mysql_error() );
}else{
    print "success ";
} 
```

如果您在看到错误后需要帮助来理解错误，请在此处发布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T18:10:42.310

```
 if(!(mysql_query("INSERT INTO speciesList VALUES($num, '$family', '$genus', '.$v')", $connection))){
               echo mysql_error();
            }else{ 
```

可能还有其他问题，但 mysql_error() 函数返回一个字符串。您的脚本需要采取一些措施来显示字符串。

我发现这样做的更好方法是分别构造变量，以便显示它们。而且我不确定您是否想要$v 之前的那个点。看看这对你是否有意义。

```
foreach($array as $v)
{
    $num++;
    $sql = "INSERT INTO speciesList VALUES($num, '$family', '$genus', '$v')";
    $res = mysql_query($sql);
    if (!$res) die("FAIL: $sql BECAUSE: " . mysql_error());
    echo "<br/>SUCCESS: $sql";
} 
```

# oauth - 我怎样才能让谷歌oAuth自动登录

> ID：14093187
> 
> 赞同：1
> 
> 时间：2012-12-30T18:06:17.563
> 
> 标签：oauth

我访问过许多网站，我使用我的 google 帐户使用 oAuth 登录，但我从未进入过网站并让它自动让我登录到我的 google 帐户。

有些网站会自动登录到他们的系统帐户，但从不使用谷歌 oAuth 登录。

这可能吗？

这也可以通过 twitter 或 facebook 身份验证来实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T11:24:47.887

我一直在阅读它可以使用 Cookie 来完成。

只需使用一些参数（例如 google ID 和 emailadres）设置一个 cookie，当访问者返回时，您可以读取并使用这些值将其登录，甚至不会将它们重定向到 Google。

但是，由于潜在的安全隐患，我不建议这样做！

# javascript - jQuery Toggle 中断传播？

> ID：14093195
> 
> 赞同：0
> 
> 时间：2012-12-30T18:06:58.047
> 
> 标签：javascript, jquery, toggle, responsive-design, breakpoints

jQuery Toggle 会破坏传播吗？

我的问题是我正在构建一个响应式菜单，并且当我将浏览器调整为我拥有的唯一断点的宽度时。jQuery 的 Toggle 函数打破了我的传播。

这是示例： http: [//www.stlredtails.com/construction](http://www.stlredtails.com/construction)

如果您将浏览器的大小调整为小于或等于 1024 像素，请单击顶部的导航按钮，并在显示菜单后尝试单击联系人链接。它不会传播，然后如果您将浏览器的大小调整到 1024 像素以上... Contact 链接会传播。我不记得幻灯片切换有这个问题。

此外，如果您将浏览器的大小调整为 1024 像素或以下。单击导航按钮后，您必须刷新页面才能触发事件吗？jQuery 的 Toggle 是否也打破了这一点？

下面的jQuery：

```
 if((window.outerWidth && window.outerWidth > 1024) || (document.body.clientWidth && document.body.clientWidth > 1024)){
        jQuery(".navigation > ul > li").hoverIntent(
            function() {
               jQuery(this).children('ul').slideDown();
            },
            function(){
               jQuery(this).children('ul').slideUp();
            }
        );
        jQuery(".navigation > ul > li > ul").hover(
            function() {
               jQuery(this).children('ul').show();
            },
            function() {
               jQuery(this).children('ul').hide();
            }
        );
    }
    if((window.outerWidth && window.outerWidth <= 1024) || (document.body.clientWidth && document.body.clientWidth <= 1024)){
        jQuery(".navigation > ul > li > a").each( function() {
            if(jQuery(this).siblings("ul").length) {
                jQuery(this).removeAttr("href");
            }
        });
        jQuery(".navigation > span > a#navigation").toggle(
            function() {
               jQuery(this).parent().siblings("ul").css("display", "block");
            },
            function() {
               jQuery(this).parent().siblings("ul").css("display", "none");
            }
        );
        jQuery(".navigation > ul > li > a").toggle(
            function() {
               jQuery(this).siblings("ul").css("display", "block");
            },
            function() {
               jQuery(this).siblings("ul").css("display", "none");
            }
        );
    } 
```

有什么建议么？

谢谢！

# yii - 向 Yii 控制器中的 actionIndex 发送参数

> ID：14093196
> 
> 赞同：3
> 
> 时间：2012-12-30T18:07:04.683
> 
> 标签：yii, action, controllers

我想在 Yii 控制器中发送一个用于索引操作的 sql 字符串？例如：

```
index.php?r=staff/index&id=1 
```

我尝试了并将 actionIndex() 更改为 actionIndex($id) 但 Yii 给了我

```
error 400 : Your request is invalid. 
```

有可能还是我必须定义另一个动作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T18:10:42.383

不，您不需要这样做，在您的操作方法中接收 id 作为正常请求参数

```
public function actionIndex(){

     $id = $_GET['id'];

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-18T09:10:09.783

你可以得到如下参数。

```
 $key = Yii::app()->getRequest()->getParam('your_parameter_name'); 
```

您还可以从中获取所有参数

```
 $allParam = Yii::app()->getRequest()->restParams 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T19:14:58.043

或者

```
actionIndex($id = 0) 
```

在您的工作人员控制器中

# java - 如何创建Phasers的链/层

> ID：14093200
> 
> 赞同：3
> 
> 时间：2012-12-30T18:07:37.927
> 
> 标签：java, multithreading, executorservice, phaser

我正在编写使用 Phaser 来知道何时完成工作的多线程应用程序。问题是在 ExecutorCompletionService 中甚至可以有 100k 的线程在一个队列中，但在 Phaser 中的最大到达方数是 65535。当有 65536 方到达时我该怎么办？

我的示例代码：

```
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.concurrent.*;

public class Main {
public static void main(String[] args) throws Exception {
    ExecutorService ec = Executors.newFixedThreadPool(10);
    ExecutorCompletionService<List<String>> ecs = new ExecutorCompletionService<List<String>>(
            ec);
    Phaser phaser = new Phaser();

    // register first node/thread
    ecs.submit(new SimpleParser("startfile.txt"));
    phaser.register();

    Future<List<String>> future;
    do {
        future = ecs.poll();
        if(future!=null && future.get() != null) {
            addParties(phaser, future.get(), ecs);
            phaser.arriveAndDeregister();
        }

        if (phaser.isTerminated()) {
            ec.shutdown();
        }
    } while (!ec.isShutdown() && !phaser.isTerminated());
}

public static void addParties(Phaser p, List<String> filenames,
        ExecutorCompletionService<List<String>> ecs) {
    for (int i = 0; i < filenames.size(); i++) {
        ecs.submit(new SimpleParser(filenames.get(i)));
        //PROBLEM = What to do when Phaser has 65535+ unarrived parties
        p.register();
    }
}

static class SimpleParser implements Callable<List<String>> {

    String fileName;

    public SimpleParser(String fileName) {
        this.fileName = fileName;
    }

    @Override
    public List<String> call() throws Exception {
        return parseFile();
    }

    private List<String> parseFile() {
        return new ArrayList<String>(Arrays.asList(new String[] {
                "somefilename1.txt", "somefilename2.txt" }));
    }

}
} 
```

问题出在 addParties() 方法中。单线程（SimpleParser）可以返回即100个新文件名，将有100个新线程提交给ExecutorCompletionService，100个新方在Phaser中注册。我试图使用这样的东西：

```
if(p.getUnarrivedParties() == 65535)
            p = new Phaser(p); 
```

并创建一个相位器链，但它没有帮助，因为 p.getUnarrivedParties() 返回 0，但我无法注册下一个参与方...

```
 System.out.println(p.getUnarrivedParties());
        if(p.getUnarrivedParties() == 65535) {
            p = new Phaser(p);
            System.out.println(p.getUnarrivedParties());
        }
        p.register(); 
```

印刷：

65535

0

并抛出 IllegalStateException

那么如何创建与这个旧的Phaser 连接的新Phaser？

//编辑

谢谢@bowmore。我还有两个问题。

让我们看一下这个例子：

```
import java.util.concurrent.Phaser;

public class Test2 {
    public static void main(String[] args) {
        Phaser parent = new Phaser();
        Phaser child1 = new Phaser(parent);
        Phaser child2 = new Phaser(parent);
        child1.register();
        child2.register();

        System.out.println("Parent: "+parent.isTerminated());
        System.out.println("Child1: "+child1.isTerminated());
        System.out.println("Child2: "+child1.isTerminated()+"\n");

        child1.arriveAndDeregister();
        System.out.println("Parent: "+parent.isTerminated());
        System.out.println("Child1: "+child1.isTerminated());
        System.out.println("Child2: "+child2.isTerminated()+"\n");

        child2.arriveAndDeregister();
        System.out.println("Parent: "+parent.isTerminated());
        System.out.println("Child1: "+child1.isTerminated());
        System.out.println("Child2: "+child2.isTerminated()+"\n");
    }
} 
```

它打印：

```
Parent: false
Child1: false
Child2: false

Parent: false
Child1: false
Child2: false

Parent: true
Child1: true
Child2: true 
```

为什么在 child1.arriveAndDeregister(); 之后 child1 没有终止，如何检查它是否真的终止？

第二个问题。我在达到 65535 方后询问是否要创建新的 Phaser，因为我认为创建数千个新对象是没有用的 - 你认为这样做不会有内存问题，或者它甚至可以提高性能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T20:46:11.103

可以在新创建的原始子进程上注册，而不是在现有的`Phaser`新进程中注册。只需将父级提供给子级的构造函数即可`Phaser`创建子级。`Phaser``Phaser`

```
public static void addParties(Phaser p, List<String> filenames,
                              ExecutorCompletionService<List<String>> ecs) {
    Phaser newPhaser = new Phaser(p);
    for (int i = 0; i < filenames.size(); i++) {
        ecs.submit(new SimpleParser(filenames.get(i)));
        newPhaser.register();
    }
} 
```

如果您只想在达到某个阈值时创建子 Phaser，您可以检查已注册方的数量，而不是未到达者的数量：

```
public static void addParties(Phaser p, List<String> filenames, ExecutorCompletionService<List<String>> ecs) {
    Phaser toRegister = p.getRegisteredParties() > THRESHOLD ? new Phaser(p) : p;
    for (int i = 0; i < filenames.size(); i++) {
        ecs.submit(new SimpleParser(filenames.get(i)));
        //PROBLEM = What to do when Phaser has 65535+ unarrived parties
        toRegister.register();
    }
    System.out.println(p.getRegisteredParties());
} 
```

编辑 ：

跟进问题 1： Child`Phaser`与 root 共享终止状态`Phaser`，这里是实现`isTerminated()`

```
public boolean isTerminated() {
    return root.state < 0L;
} 
```

跟进问题 2：父 Phasers 实际上并没有保留对其子 Phasers 的引用。一旦不再引用子移相器，它就有资格进行垃圾收集。您最好遵循 javadoc 中的建议：

> TASKS_PER_PHASER 的最佳值主要取决于预期的同步速率。对于极小的每阶段任务主体（因此高速率），低至四的值可能适合，对于非常大的任务主体，可能适合高达数百。

分层的主要原因是减少繁重的同步争用，因此如果您有轻量级任务，则每个移相器的任务越少越好。配置不同的设置来调整这些东西永远不会有坏处。

# assembly - 装配流水线

> ID：14093201
> 
> 赞同：6
> 
> 时间：2012-12-30T18:07:45.283
> 
> 标签：assembly, mips

我需要多少档位才能正确执行以下指令。我对自己的所作所为有点困惑，所以我在这里看专家的答案。

```
lw $1,0($2);

beq $1,$2,Label; 
```

请注意，是否会发生分支的检查将在解码阶段完成。但是在这种情况下为 $1 的 beq 的源寄存器 rs 将在 lw 指令的回写阶段之后更新。那么我们是否需要将内存阶段的内存中的新数据转发到beq指令的解码阶段。

舞台是这样的：

![在此处输入图像描述](../Images/796fec5226e0e27092e6d6c4ef56f172.png)

IF：取指令；ID：指令解码 Ex：执行/ALU 阶段 MEM：从内存中读取数据 WB：将数据存储在目标寄存器中

这是我到目前为止所做的。

当 lw 处于 exec 阶段而 beq 处于解码阶段时，停顿条件变为真并创建了一个气泡。现在 lw 处于 Mem 阶段，并且由于气泡，beq 仍处于解码阶段，再次停止条件已变为真，并且发生了第二次停止。现在 lw 处于 WB（回写）并且 beq 处于解码阶段，但仍然是值1 美元的值将在 WB 阶段结束时更新，这最终意味着 beq 仍然可以使用错误的 1 美元值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:47:44.440

看起来您需要第三次停顿以允许在解码之前将寄存器写回寄存器文件，或者将数据从写回阶段转发到解码阶段。无论哪种方式，如果要写入的寄存器等于 ，则应该执行此操作`rs`。

您似乎需要太多的停顿，因为在解码阶段的早期检测到分支，这很好，因为它节省了获取无论如何都会被刷新的不必要的指令，但是您必须进行适当的危险检测才能进行。

# mysql - 使用where子句时mysql查询慢

> ID：14093204
> 
> 赞同：2
> 
> 时间：2012-12-30T18:08:22.737
> 
> 标签：mysql

我已经获取了一个邮政编码数据库，并预先计算了到某个半径内其他邮政编码的距离。数据库本身大约 2.5GB，所以没什么特别的。

这样做的目标是能够：

```
select * from zipcode_distances where zipcode_from=92101 and distance < 10; 
```

到目前为止，我定义的唯一索引是：

```
(zipcode_from, distance) 
```

但是，运行查询大约需要 20 秒才能获得结果。

当我删除“ `and distance < 10`”子句时，结果是即时的。

任何意见，将不胜感激。

编辑：

这是创建语句：

```
delimiter $$

CREATE TABLE `zipcode_distances` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `zipcode_from` char(5) COLLATE utf8_bin NOT NULL,
  `zipcode_to` char(5) COLLATE utf8_bin NOT NULL,
  `distance` double unsigned NOT NULL COMMENT 'stored in miles',
  PRIMARY KEY (`id`),
  KEY `idx_zip_from_distance` (`zipcode_from`,`distance`)
) ENGINE=MyISAM AUTO_INCREMENT=62548721 DEFAULT CHARSET=utf8 COLLATE=utf8_bin$$ 
```

这是解释：

```
explain extended select * from zipcode_distances where zipcode_from=90210 and distance < 10; 
```

结果：

> id, select_type, table, possible_keys, key, key_len, ref, rows, filtered, Extra 1, SIMPLE, zipcode_distances, ALL, idx_zip_from_distance, null, null, null, 62548720, 100.00, 使用 where

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T18:31:08.623

我认为 MySQL 使用索引进行查询没有问题。我想知道来自 92101 的类型转换是否会混淆它。

你会得到同样糟糕的表现吗？

```
select * from zipcode_distances where zipcode_from='92101' and distance < 10; 
```

另一个问题是你如何做计时。您必须运行多次以避免填充缓存的影响。

# mysql - 非常复杂的选择

> ID：14093213
> 
> 赞同：1
> 
> 时间：2012-12-30T18:09:38.183
> 
> 标签：mysql

我想在更多表（4+）之间进行复杂的 SELECT 排序和计数项目。

到目前为止，这就是我的路线：

```
SELECT
  myl_u.id, 
  myl_u.label_real_address, 
  myl_u.ext, 
  COUNT(myc_c.contact_id), 
  COUNT(myl_r_c.release_id) 
FROM
  myl_users myl_u  
  LEFT JOIN myc_contacts myc_c  ON myc_c.contact_type='l' AND myc_c.contact_id=myl_u.id 
  LEFT JOIN myl_releases myl_r ON myl_r.id=myl_u.id 
  LEFT JOIN myl_r_comments myl_r_c ON myl_r.release_id=myl_r_c.release_id 
GROUP BY myl_u.label_real_address 
ORDER BY COUNT(myc_c.contact_id) DESC 
```

它工作了一半，但是当我添加 SQL 的后半部分时，它会显示意外的值，并且它也会以某种方式将它们加倍。

基本上我有**myl_users**（唱片公司的集合） **myc_contacts**（用户有多少收藏夹，contact_type='l' 表示它是关于 myl_users 而不是其他表） **myl_releases**包含音乐发布（如 EP、专辑，具有唯一 ID **和 myl_r_comments**包含普通用户对这些版本的评论。

我设法按唱片公司有多少收藏夹（15、14、10、8..）来排序 - COUNT(myc_c.contact_id) 子句

但是当我添加下一个子句并使查询更大以按标签发布的总评论排序时，会出现意外。

有人可以指出我正确的方式吗？

我将根据您的需要评论和调整/澄清问题。

谢谢，新年快乐

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:19:48.187

问题是你在多个维度上求和，所以你得到一个叉积。最好的方法是独立地沿每个维度进行总结：

```
SELECT myl_u.id, myl_u.label_real_address, myl_u.ext, 
       sum(myc_c.cnt), 
       sum(myl_rc.cnt) 
FROM myl_users myl_u LEFT JOIN
     (select contact_id, count(*) as cnt
      from myc_contacts myc_c
      where myc_c.contact_type='l'
      group by contact_id
     ) myc_c
     ON myc_c.contact_id=myl_u.id LEFT JOIN
     (select myl_r.id, count(*) as cnt
      from myl_releases myl_r LEFT JOIN
           myl_r_comments myl_r_c
           ON myl_r.release_id=myl_r_c.release_id
      gropu by myl_r.id
     ) myl_rc
     ON myl_rc.id=myl_u.id 
GROUP BY myl_u.id, myl_u.label_real_address, myl_u.ext
ORDER BY 4 DESC 
```

`group by`从最后是否有必要的问题中不清楚。如果 myl_u 表中没有重复项，则根本不需要外部聚合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T18:15:02.417

我发现的至少一个问题是，如果要限制行，则需要 WHERE 子句。JOIN 应该只包含 JOIN 的条件。

```
SELECT
  myl_u.id, 
  myl_u.label_real_address, 
  myl_u.ext, 
  COUNT(myc_c.contact_id), 
  COUNT(myl_r_c.release_id) 
FROM
  myl_users myl_u  
  LEFT JOIN myc_contacts myc_c  ON myc_c.contact_id=myl_u.id 
  LEFT JOIN myl_releases myl_r ON myl_r.id=myl_u.id 
  LEFT JOIN myl_r_comments myl_r_c ON myl_r.release_id=myl_r_c.release_id 
WHERE
   myc_c.contact_types = '1'
GROUP BY myl_u.label_real_address 
ORDER BY COUNT(myc_c.contact_id) DESC 
```

另外，您确定它是您想要的左连接吗？即使右侧没有匹配的值，它也会返回“左侧”表中的所有行。尝试将 LEFT 更改为 INNER，看看是否得到了预期的结果。

# php - PHP 电子邮件脚本只打开 PHP 文件

> ID：14093216
> 
> 赞同：0
> 
> 时间：2012-12-30T18:10:05.017
> 
> 标签：php, html, linux, forms, apache

我在 Linux 服务器上托管一个网站，运行 Ubuntu Server 11.04（32 位）。Web 服务器是 Apache。该站点上的其中一个页面有一个表单，其中包含指向 PHP 电子邮件脚本的提交链接。表格代码：

```
<form id="contact_form" method="post" action="email.php">
<table>
<tr>
<td>Name:</td>
<td><input type="text" id="name" class="textbox"/></td>
</tr>
<tr>
<td>Email:</td>
<td><input type="text" id="email" class="textbox"/></td>
</tr>
</table>
<div id="message_box_header">Describe your problem:<br /></div>
<textarea class="textbox"></textarea><br />
<input type="submit" value="Submit!" id="submit" />
</form> 
```

Linux 服务器具有最新版本的 sendmail。我根本不了解 PHP，并且预先编写了脚本，所以我想我的问题可能就在那里。为了隐私，我用虚拟的网站/电子邮件替换了网站/电子邮件。这是email.php：

```
<?php
  $email = $_REQUEST['email'] ;
  $message = $_REQUEST['message'] ;

  mail( "myemail@gmail.com", "Form Data",
    $message, "From: $email" );
  header( "Location: http://mywebsite.com" );
?> 
```

当我点击实际网站上的提交按钮时，它只会下载 email.php。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:14:30.017

确保 PHP 实际安装在您的服务器上（这应该是您做的第一件事，遵循 cryptic 的说明）。

如果它已安装，但您仍然遇到问题，请将其添加到您的 apache 配置 ( `.htaccess`) 中：

```
AddType application/x-httpd-php .php 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T18:17:49.097

您应该设置`name`输入字段的属性，而不是`id`. 否则不发送数据。如果正在下载文件，这是网络服务器而不是脚本的配置错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T18:37:58.933

通过运行以下命令更新您的包管理器：

```
apt-get update 
```

并安装`mod_fcgid`并`php5-cgi`运行以下命令：

```
apt-get install libapache2-mod-fcgid php5-cgi 
```

`mod_fcgid`将由安装程序启用，否则运行此命令以启用它：

```
a2enmod fcgid 
```

现在您可以将这些预先配置的行添加到您的 apache 配置文件中：

```
AddHandler fcgid-script .php
FcgidIOTimeout 3600
FcgidInitialEnv PHP_FCGI_MAX_REQUESTS 1000 
FcgidMaxRequestLen 52428800
FcgidConnectTimeout 3600
FcgidMaxProcesses 12
FcgidOutputBufferSize 64
FcgidProcessLifeTime 3600
FcgidMaxRequestsPerProcess 500
FcgidMinProcessesPerClass 0
FcgidWrapper /usr/bin/php-cgi .php 
```

您的 apache 配置文件可能在`/etc/apache2/apache2.conf`

有关快速 cgi 处理程序的更多信息，请参阅：[http ://httpd.apache.org/mod_fcgid/mod/mod_fcgid.html](http://httpd.apache.org/mod_fcgid/mod/mod_fcgid.html)

# xamarin.ios - InternalsVisibleTo 是否可用于允许 MonoTouch 单元测试访问 MT Lib 的内部？

> ID：14093217
> 
> 赞同：2
> 
> 时间：2012-12-30T18:10:13.340
> 
> 标签：xamarin.ios, internalsvisibleto, touch.unit

您能否在 MonoTouch 库的 AssemblyInfo 文件中使用 InternalsVisibleTo 程序集属性来允许 MonoTouch 单元测试 (Touch.Unit) 访问 MonoTouch 库的内部？

这是非常适合在非 MonoTouch 世界中使用的东西，可以测试内部结构而无需跳过障碍。但是我无法让它与 MonoTouch 单元测试一起工作。所以在我继续之前，我想我会问它是否可能，因为这是一个作为测试运行器的 iOS 应用程序，所以不确定编译为本机代码的 iOS 应用程序是否可以做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:29:26.917

是的，它应该（或者它是一个错误），即使我不记得自己尝试过。

关键是这`[InternalsVisibleTo]`主要是一个编译器*技巧*，它由`smcs`MonoTouch 附带的 C# 编译器 ( ) 支持（因为它在 BCL 中使用）。因此，它没有理由不能在基于 Touch.Unit 的应用程序中运行。

现在请记住，所有其他规则仍然适用。例如，如果托管链接器在所有*未使用*的代码将被删除（即使用属性标记）时启用。

# asp.net-mvc-4 - 显示表格数据。除了遍历数据集并在剃刀中生成表格之外，还有其他选择吗？

> ID：14093221
> 
> 赞同：0
> 
> 时间：2012-12-30T18:10:30.317
> 
> 标签：asp.net-mvc-4, razor, dataset, tabular

在我的 MVC 应用程序中，我需要在其中一个 razor 视图中以表格格式（没有编辑，只有只读）显示数据。一些列应该是超链接，几列显示图像，其余列是纯文本。

我知道一种选择是遍历数据集（模型）中的每一行，并构建表格。任何人都知道是否有其他方法可以做到这一点？（没有任何第三方控制）

对此的任何建议，非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:13:58.300

我能想到的最接近的“非第三方”控件是[WebGrid](http://msdn.microsoft.com/en-us/magazine/hh288075.aspx)，但如果我没记错的话，即使它也不包含在 ASP.NET MVC 发行版中（你可能想检查一下，因为我不是 100% 确定）。

然而，使用一个简单`foreach`的方法来生成你的表格也不是一个坏的方法，特别是如果你需要做的只是显示一些数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T18:00:39.180

您可以在 aspx中使用[Phil Haack 的表格模板](http://haacked.com/archive/2010/05/05/asp-net-mvc-tabular-display-template.aspx)

或者[我在剃须刀中完成的更新版本](http://imaginarydevelopment.blogspot.com/2013/02/autoscaffold-indexcshtml-tabular-view.html)

[关于 Visual Studio 添加控制器和添加视图模板](http://blogs.msdn.com/b/webdev/archive/2009/01/29/t4-templates-a-quick-start-guide-for-asp-net-mvc-developers.aspx)

你也可以从`List.tt`模板中得到一些想法`[Visual Studio Install Directory]\Common7\IDE\ItemTemplates\[CSharp | VisualBasic]\Web\MVC\CodeTemplates\`

[我关于更改/自定义的文章](http://imaginarydevelopment.blogspot.com/2013/02/change-your-mvc-addview-template.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T18:13:50.417

为什么没有第三方控制？就个人而言，我喜欢[datatables.net](http://www.datatables.net/)。

# r - 将Dataframe转换为R中的键值对列表

> ID：14093224
> 
> 赞同：0
> 
> 时间：2012-12-30T18:10:50.100
> 
> 标签：r, ggplot2

> **可能重复：**
> [如何旋转/取消旋转（铸造/熔化）数据框？](https://stackoverflow.com/questions/7980030/how-to-pivot-unpivot-cast-melt-data-frame)

我有这个数据框

```
idx A  B  C  D
1   12 23 33 4
2   33 22 23 6 
```

我想将其转换为以下格式（`ggplot2`似乎更喜欢）

```
idx col value
1   A   12
1   B   23
1   C   33
1   D   4
2   A   33
2   B   22
2   C   23
2   D   6 
```

有没有办法用标准 R 代码（或`ggplot2`我缺少的函数）来做到这一点？

# signalr - “Uncaught TypeError: Cannot read property 'queue' of undefined”在主干和 signalR 集成期间发生

> ID：14093225
> 
> 赞同：1
> 
> 时间：2012-12-30T18:10:57.820
> 
> 标签：signalr, backbone-views, signalr-hub, signalr.client

我有一个 signalR 服务器队列 hab。当在我的 SearchResultListItemView 视图中单击按钮时，我正在尝试启动服务器并向服务器发送消息。但无法工作，我收到错误“Uncaught TypeError: Cannot read property 'queue'”。

这是我的 SearchResultListItemView 视图，当点击事件发生时，我必须在其中调用 signalR 服务器。我只想在点击时向服务器发送一些价值。然后我将向所有其他客户端发送响应以加载更改。我怎样才能做到这一点？或者这里有什么问题？

```
window.SearchResultListItemView = Backbone.View.extend({
tagName: "tr",

initialize: function () {

    var _this = this;
    this.model.bind("change", this.render, this);
    this.model.bind("destroy", this.close, this);
    // here is the error occured in this line:
    var queue = $.connection.queue;

    // Start the connection
    $.connection.hub.start(function () {
        queue.ReloadQueueMember("Hello World!", "hi all");
    });
},

events: {
    "click a": "JoinQueue"
},

JoinQueue: function (e) {       
    e.preventDefault();
    var name = this.model.get("QueueName");
    var Id = this.model.get("CustomerId");

     //SignalR Proxy created on the fly
      queue.send(name, 'hannan19')
      .done(function () {
            console.log('Success!')
       })
       .fail(function (e) {
            console.warn(e);
       });
},

render: function () {
    var data = this.model.toJSON();
    _.extend(data, this.attributes);
    $(this.el).html(this.template(data));
    return this;
}
}); 
```

这是我的 SignalR 服务器：

```
public class Queue : Hub
{
    public void Send(string QueueName, string UserName)
    {
        Clients.ReloadQueueMember(QueueName, UserName);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T20:17:45.250

要检查的几件事：

*   确保您使用的是 NuGet 的最新版本（目前为 1.0.0-rc1；您需要选中“包含预发布”才能看到它）。

*   如果`$.connection`未定义，请确保您正在加载静态 SignalR 客户端（目前，“jquery.signalR-1.0.0-rc1.js”）。检查您喜欢的浏览器的开发人员工具的“网络”选项卡，以确认已找到并加载它。

*   如果`$.connection.queue`未定义，请确保您正在加载动态 SignalR 客户端 (~/signalr/hubs)。

*   此行是错误的（如果您使用的是 1.0.0-rc1）：

`queue.ReloadQueueMember("Hello World!", "hi all");`

它应该是：

`queue.client.reloadQueueMember("Hello World!", "hi all");`

*   同样，这一行在 1.0.0-rc1 中也是错误的：

`queue.send(name, 'hannan19')`

它应该是：

`queue.server.send(name, 'hannan19')`

# windows-phone-7 - 如何组织 Windows 和 Windows Phone 项目以重用现有代码库？

> ID：14093227
> 
> 赞同：1
> 
> 时间：2012-12-30T18:11:22.573
> 
> 标签：windows-phone-7, .net-4.0, .net-3.5, projects-and-solutions, windows-phone-8

首先我想说的是，我已经阅读了这两个讨论： [如何组织 Windows Phone 代码库以同时针对 7.x 和 8 平台](https://stackoverflow.com/questions/13799646/how-to-organize-windows-phone-code-base-to-target-both-7-x-and-8-platforms)和 [Windows Phone 7/WPF - 共享代码库](https://stackoverflow.com/questions/5522355/windows-phone-7-wpf-sharing-a-codebase)。所以，我知道 Portable Class Librariy 项目类型，这可能是我的问题的答案。但这不是我的情况的答案。

## 问题

我的项目中有一些旧代码库`WindowsClassLibraryNetFw35`。我需要这个项目成为一个面向 .NET Framework 3.5 的类库。原因是一些依赖应用程序部署在客户的机器上，而这些机器没有安装 .NET Framework 4+。不幸的是，我不能强迫我的客户升级他们的环境。

现在我为 Windows 8 和 Windows Phone 8 创建新项目。如您所知，当我尝试引用我的旧库时，Windows Phone 8 项目将失败，因为它不是兼容的 Windows Phone 项目（见屏幕截图）。 ![在此处输入图像描述](../Images/25531b67ad24bd8b5d8b2aec49330e25.png)

## 问题

重组我的项目类型以便能够支持我的旧项目和新项目的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:36:16.153

我的目标仍然是让 PCL 工作，但如果失败，您可以在两个不同的项目中使用相同的代码。

创建两个不同的项目，一个是 Windows Phone，另一个是 Windows Store App。向其中添加一个文件，然后将该文件添加为另一个项目[*的链接。*](http://support.microsoft.com/kb/306234)这意味着您在两个不同的项目之间有一个源文件，但将使用各自的运行时工具进行编译。然后你可以在你的代码中做这样的事情：

```
void Foo()
{
    #if WinRT
        //WinRT specific code here
    #elif WindowsPhone
        //Silverlight specific code here
    #endif
} 
```

只需在 Windows Phone 和 WinRT 项目的 Build 选项卡上添加相应的编译器常量。这是一个更俗气的解决方案，但有时它是唯一有效的方法。

# firefox - Firefox 中的 JWPLayer 6 必须在播放前加载整个 OGG 文件？

> ID：14093228
> 
> 赞同：0
> 
> 时间：2012-12-30T18:11:25.973
> 
> 标签：firefox, streaming, jwplayer, ogg, webm

地点：

[http://www.chicagobluesnetwork.com/Shows/Listen/sharon-lewis-texas-fire-4](http://www.chicagobluesnetwork.com/Shows/Listen/sharon-lewis-texas-fire-4)

u：另一个测试 p：testpass1

在 FireFox 中：第一首曲目相对较小，但如果您尝试第二首曲目，您会注意到在播放之前有很长的停顿，因为在播放之前必须加载整个文件

在 Chrom 中：轨道在下载时立即播放

我已经在 Firefox 中看到了 html 5 嵌入式 ogg 播放，所以这只是 jwplayer 的问题还是我没有发送正确的 httpheaders？

我正在使用它来发送文件：

```
Response.AppendHeader("Content-Disposition", "attachment; filename=" + filename);
Response.AppendHeader("Content-Length", stream.Length.ToString());
Response.AddHeader("Accept-Ranges", "bytes");
Response.Headers.Remove("Cache-Control");
Response.AddHeader("Content-Range", "bytes 0-" + (stream.Length - 1).ToString() + "/" + stream.Length.ToString());
return File(stream, file.MimeType); 
```

有什么办法可以立即播放 OGG 文件吗？webm 视频也会发生同样的事情。

# ruby-on-rails - 使用 Rails 进行 Postgres 全文搜索的单词分隔符

> ID：14093230
> 
> 赞同：12
> 
> 时间：2012-12-30T18:11:42.070
> 
> 标签：ruby-on-rails, postgresql, pg-search

我正在使用[pg_search](https://github.com/Casecommons/pg_search)在我的模型中进行一些文本搜索。在其他属性中，我有一个`url`字段。

不幸的是，Postgres 似乎没有识别`/`和`.`作为单词分隔符，因此我无法在`url`.

`test`示例：在[http://test.com](http://test.com)中搜索不会产生任何结果。

有没有办法解决这个问题，也许使用另一个 gem 或一些内联 SQL ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T10:53:48.427

如文档中所述（并由 AJcodez 注意到），有一种解决方案可以为 tsvector 索引创建专用列。然后定义一个触发器来正确捕获对索引 url 的插入：

```
CREATE test_url (url varchar NOT NULL, url_tsvector tsvector NOT NULL); 
```

此方法会将任何非字母字符转换为单个空格并将字符串转换为 tsvector：

```
CREATE OR REPLACE FUNCTION generate_url_tsvector(varchar) 
RETURNS tsvector 
LANGUAGE sql 
AS $_$
    SELECT to_tsvector(regexp_replace($1, '[^\w]+', ' ', 'gi'));
$_$; 
```

现在创建一个调用此函数的触发器：

```
CREATE OR REPLACE FUNCTION before_insert_test_url()
RETURNS TRIGGER
LANGUAGE plpgsql AS $_$
BEGIN;
  NEW.url_tsvector := generate_url_tsvector(NEW.url); 

  RETURN NEW;
END;
$_$
;

CREATE TRIGGER before_insert_test_url_trig 
BEFORE INSERT ON test_url 
FOR EACH ROW EXECUTE PROCEDURE before_insert_test_url(); 
```

现在，当 url 被插入时，`url_tsvectorè 字段将被自动填充。

```
INSERT INTO test_url (url) VALUES ('http://www.google.fr');
TABLE test_url;

 id          url                     url_tsvector            

  2  http://www.google.fr  'fr':4 'googl':3 'http':1 'www':2 

(1 row) 
```

要在 URL 上进行 FT 搜索，您只需查询此字段。

```
SELECT * FROM test_url WHERE url_tsvector @@ 'google'::tsquery; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T10:44:47.900

我最终修改了[pg_search](https://github.com/Casecommons/pg_search) gem 以支持任意 ts_vector 表达式，而不仅仅是列名。变化在[这里](https://github.com/mihaifm/pg_search/commit/8026c102156f670dd1a9779da5acf5686c345588)

现在我可以写：

```
pg_search_scope :search, 
    against: [[:title , 'B'], ["to_tsvector(regexp_replace(url, '[^\\w]+', ' ', 'gi'))", 'A']],
    using: {tsearch: {dictionary: "simple"}} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-05T19:12:38.507

稍微简单的方法，将协议令牌类型添加到`simple`字典中：

```
ALTER TEXT SEARCH CONFIGURATION simple
    ADD MAPPING FOR protocol
        WITH simple; 
```

`english`如果需要词干，也可以将其添加到字典中

[https://www.postgresql.org/docs/13/textsearch-parsers.html](https://www.postgresql.org/docs/13/textsearch-parsers.html)

[https://www.postgresql.org/docs/13/sql-altertsconfig.html](https://www.postgresql.org/docs/13/sql-altertsconfig.html)

# ruby-on-rails - 在 Rails 中使用保留字？

> ID：14093232
> 
> 赞同：1
> 
> 时间：2012-12-30T18:11:49.197
> 
> 标签：ruby-on-rails, social-networking, social-stream

我在 Rails 3.2 应用程序中构建了一个名为“Subject”的模型。我使用了下面的脚手架命令。

```
rails g scaffold Subject subject singular:boolean gender:integer subject_masculine subject_feminine subject_neuter language:references --skip-stylesheets 
```

脚手架几乎运行到最后，但随后给出了一个关于助手的神秘错误：

**名称“SubjectsHelper”要么已在您的应用程序中使用，要么由 Ruby on Rails 保留。请选择一个替代方案并再次运行此生成器。**

我试过倒转脚手架并重建。最后我只是建了桌子，它似乎工作正常。没有**helpers/subjects_helper.rb**文件，但我不希望这个特定模型需要帮助器。

我在任何保留字列表中都找不到**主题**，但这本身就是一个问题。关于这个问题已经提出了另一个 SO 帖子。

[rails 中的保留字列表 *3*](https://stackoverflow.com/questions/13681409/list-of-reserved-words-in-rails-3)

为什么我会收到此错误，我可以忽略它吗？

**编辑**

我的 Gemfile 按要求

```
source 'https://rubygems.org'

gem 'rails', '3.2.8'
gem 'thin'
gem 'sinatra'
gem 'pg'
gem 'simple_form'
gem "nested_form"
gem 'thinking-sphinx'
gem 'devise'
gem 'haml-rails'
gem 'ruby_parser'
gem 'html2haml'
gem 'best_in_place'
gem 'carrierwave'
gem 'fog'
gem 'seed_dump'
gem 'bluecloth'
gem 'redcarpet'

group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'prototype-rails'
  gem 'uglifier', '>= 1.0.3'
  gem 'twitter-bootstrap-rails'
  gem 'therubyracer'
  gem 'less-rails'
  gem 'jquery-datatables-rails'
end

gem 'jquery-rails'
gem 'social_stream'
gem 'rails-footnotes', '>= 3.7.5.rc4', :group => :development

group :development do
  gem 'rails-erd'
  gem 'quiet_assets'
end

gem 'vestal_versions', :git => "git://github.com/futurechimp/vestal_versions.git"
gem 'diffy'
gem 'diffrent' 
```

**编辑2**

根据 Philip 的建议，我从 Rails 控制台运行了**Module.constants命令。**在输出中，有两个“主题”值：

```
:SubjectsHelper
:Subject 
```

我检查了几次没有帮助，所以我决定添加一个。我使用以下代码创建了**helpers/subjects_helper.rb**文件：

```
module SubjectsHelper
end 
```

Rails 现在已经重新启动好了。我仍然不明白发生了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T21:08:03.440

我找到了。我正在使用 Social Stream gem，它在路线中有一个主题。

```
subject_lrdd        /subjects/lrdd/:id(.:format) 
```

它必须埋在发动机的某个地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T10:04:34.927

正如您所说的，SubjectsHelper 已经由 Social Stream 提供。看：

[https://github.com/ging/social_stream/blob/master/base/app/helpers/subjects_helper.rb](https://github.com/ging/social_stream/blob/master/base/app/helpers/subjects_helper.rb)

Your solution is working because you are reopening the module, which is a valid action in Ruby.

# perl - 使用 LWP::UserAgent 损坏图像

> ID：14093237
> 
> 赞同：2
> 
> 时间：2012-12-30T18:13:02.827
> 
> 标签：perl, imagemagick, lwp, lwp-useragent

以下脚本循环运行，使用 检索图像[`LWP::UserAgent`](https://metacpan.org/module/LWP%3a%3aUserAgent)，并使用 调整它们的大小[`Image::Magick`](https://metacpan.org/module/Image%3a%3aMagick)。

`Image::Magick`读取下载的图像时出现此错误：

```
Exception 450: Unsupported marker type 0x54 
```

如果我将 LWP 下载的图像下载到我的计算机，在照片编辑器中打开它，另存为 .jpg 文件，上传并尝试阅读，`Image::Magick`那么一切都很好。这会让我相信图像没有正确保存。

我需要使用`LWP::UserAgent`，因为我连接的服务器不允许下载，除非它认为客户端正在请求数据。

```
use LWP::UserAgent;
use Image::Magick;  

$ua = new LWP::UserAgent;
$ua->agent("$0/0.1 " . $ua->agent);
$ua->agent("Mozilla/8.0");

my $PICURL  ="http://www.example.com/img.aspx?pid=cjfsaf79afffafhfah777af7";
my $PICDEST ="/var/vhosts/mysite.com/httpdocs/images";
my $PICNAME ="01.jpg";

my $response = $ua->get("$PICURL");

open(outfile, ">:raw", "$PICDEST/$PICNAME");
binmode outfile;

if ($response->is_success) {
  print outfile $response->content;
  $Pi++;
  $PTOT++;
}
else {
  die $response->status_line;
}

$image = new Image::Magick;
$image->Read("$PICDEST/$PICNAME");
$image->Scale(width=>800, height=>600);
$image->Write("$PICDEST/$PICNAME");
$image->Scale(width=>216, height=>163);
$image->Set(quality=>90);
$image->Write("$PICDEST/TH_$PICNAME"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T19:28:42.780

从不使用

```
$response->content() 
```

你要

```
$response->decoded_content( charset => 'none' ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T19:13:44.390

您可能会得到压缩或其他编码的结果；尝试 ->decoded_content 而不是 ->content。

来自[HTTP::Response](http://p3rl.org/HTTP%3a%3aResponse)文档：

> $r->内容（$字节）
> 
> 这用于获取/设置原始内容，它继承自 HTTP::Message 基类。有关可用于访问内容的详细信息和其他方法，请参阅 HTTP::Message。
> 
> $r->decoded_content(%options)
> 
> 这将在任何内容编码和字符集被解码后返回内容。有关详细信息，请参阅 HTTP::Message。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-08T18:44:38.520

我现在知道这很老了，但我也遇到了这个问题，实际上我在使用它之前将图像保存到磁盘，在这样做的同时，我需要设置我正在流式传输/写入的文件句柄到“binmode”。

```
open $fh....
binmode($fh)
print $fh .....
close $fh 
```

# ruby-on-rails-3 - 如何使 i18n 内容可搜索？

> ID：14093239
> 
> 赞同：1
> 
> 时间：2012-12-30T18:13:15.680
> 
> 标签：ruby-on-rails-3, internationalization, search-engine, i18n-gem

我想让我的多语言网站可搜索，它是完全静态的。该网站共享 3 种语言。我使用了一种技术，该技术使用其各自的语言环境文件（它在 yml 中）捕获独特的标签内容，例如

### 在我的视图文件中

```
<%= t ".unique_key" %> 
```

### 在我的语言环境文件中

```
en:
  filename:
    unique_key: "This is unquie content which i want to search" 
```

目前，我尝试谷歌搜索，但没有找到任何解决方案。我唯一想到的就是做一个我的本地站点爬虫。你是如何解决这个问题的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T06:05:09.047

Google 的这篇文章可能会有所帮助：[使用多语言网站](http://googlewebmastercentral.blogspot.ca/2010/03/working-with-multilingual-websites.html)。

**抓取和索引您的多语言网站**部分应该回答您的问题。

# android-intent - LibGdx 如何从 libgdx 类返回到 androidActivity

> ID：14093241
> 
> 赞同：1
> 
> 时间：2012-12-30T18:13:22.103
> 
> 标签：android-intent, initialization, libgdx

因此，在 libgdx android 项目中，我们有一个包含 android 活动的文件夹和另一个包含 libgdx 项目源代码的文件夹。

要从我们使用的 Android 活动开始“游戏”`initialize(new MyGdxGame(),cfg);`

现在我需要知道如何从游戏中的 libgdx 类返回到主菜单之类的 android 活动...

我尝试从 Activity 扩展类以获取`contextApplication`，但我无法填写第二个参数，因为程序无法识别 libgdx 类中的 android 类...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T18:19:29.557

在 libGDX 项目中使用 Android 特定代码的标准方法是在 libGDX 核心项目（例如`interface PlatformStuff`）中创建一个独立于平台的接口，然后在每个特定于平台的后端（例如，桌面或 Android）中使用平台特定对象（so `class AndroidPlatformStuff implements PlatformStuff`）。您可以在构造接口时将接口的平台特定实现传递到通用代码中（例如，`new MyGdxGame(new AndroidPlatformStuff())`.

调用更改活动和上下文的 Android 代码可能需要更多的工作（因为它与 libGDX 基础架构有一点交互），但也应该是可行的。您应该能够使用集成广告支持的教程来获得基本概念。请参阅[http://code.google.com/p/libgdx/wiki/AdMobInLibgdx](http://code.google.com/p/libgdx/wiki/AdMobInLibgdx)或[http://code.google.com/p/libgdx/wiki/ApplicationPlatformSpecific](http://code.google.com/p/libgdx/wiki/ApplicationPlatformSpecific)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-01T00:18:11.900

首先，您应该在核心文件夹中创建一个接口类。这通常与您的游戏类一起放置。例如，假设您的函数名称将是 LoginFacebook() 用于名为 ActionResolver 的接口类

接口类

```
package com.mygdx.game;

public  interface ActionResolver {
    public void LoginFacebook();

} 
```

现在在你的游戏类中，你应该有以下构造函数：

```
public SpaceXplorerGame(ActionResolver actionResolver)
{
    this.actionResolver = actionResolver;
} 
```

现在在你的 android 文件夹中，在 src -> com.mygdx.game.android （你的包名）中，你应该创建你的处理程序类，在我的例子中叫做 ActionResolverAndroid

```
public class ActionResolverAndroid implements ActionResolver {
    Handler handler;
    Context context;

    public ActionResolverAndroid(Context context) {
        handler = new Handler();
        this.context = context;
    }

public void LoginFacebook()
{
    handler.post(new Runnable() {
        @Override
        public void run() {
            Intent intent = new Intent(context, LoginActivity.class);
            context.startActivity(intent);
        }
    });

} 
```

}

现在从 LibGdx 调用函数 LoginFacebook() 将带你到你在 android 中的 LoginAcitivty.class。希望我没有错过任何东西

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-06T21:17:48.980

广告平台的 libGDX 文档正是您所需要的。它在 libGDX 核心中创建一个接口，并在 android 启动器中实现一个处理程序，该处理程序可以从核心部分调用。

**见这里**：[https ://github.com/libgdx/libgdx/wiki/Admob-in-libgdx](https://github.com/libgdx/libgdx/wiki/Admob-in-libgdx)

基本上跳过所有的广告内容。**向下滚动到“控制”并执行以下部分：**

*   **在您的 AndroidLauncher 中注册一个新的处理程序**。这是必要的，因此处理程序可以稍后在正确的android线程中处理接口的实现功能......（参见“HelloWorldAndroid”）
*   **在您的核心项目中创建一个接口**（如 IActivityRequestHandler）
*   **让您的 AndroidLauncher 实现该功能并使用处理程序在您的 android 线程中执行实际功能**

最后，您需要**传递**对您的 libGDX 核心代码的引用。我个人通过在我的核心项目中实现一个**单例类来使用它，如下所示：**

```
class SingletonData{
  private SingletonData(){
  }
  private static SingletonData instance;
  public static SingletonData getInstance(){
    if(instance==null){
      instance = new SingletonData(); // can only be assessed here. no other class can generate a second instance
    }
    return instance;
  } 

  private IActivityRequestHandler handler;

  public void setHandler(IActivityRequestHandler handler){
    this.handler=handler;
  }

  public IActivityRequestHandler getHandler(){
    return this.handler;
  }
} 
```

在您的 AndroidLauncher（即 HelloWorldAndroid）调用中，在它创建结束时调用以下内容来**注册它**：

```
SingletonData.getInstance().setHandler(this); 
```

现在你可以通过以下方式在任何你喜欢的核心类中**使用它：**

```
SingletonData.getInstance().getHandler().showAds(true); // showAds or whatever your interface handler implements 
```

PS：确保在游戏开始后调用 getHandler()，这样你就不会得到空引用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-16T13:05:11.080

你应该创建回调；创建一个接口并在android类上实现，然后将其传递给libgdx，当您需要调用相关方法时。

# python - scrapy 可以同时产生请求和项目吗？

> ID：14093242
> 
> 赞同：12
> 
> 时间：2012-12-30T18:13:24.903
> 
> 标签：python, scrapy

当我编写`parse()`函数时，我可以为一个页面同时生成请求和项目吗？

我想在页面A中提取一些数据，然后将数据存储在数据库中，并提取要跟踪的链接（这可以通过CrawlSpider中的规则来完成）。

我把A页面的链接页面称为B页面，所以我可以再写一个parse_item()来提取B页面的数据，但是我想提取B页面中的一些链接，**所以只能用rule来提取链接？如何处理 Scrapy 中的重复 URL？**

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-11T03:48:52.213

是的，您可以同时生成请求和项目。据[我所见](https://groups.google.com/forum/?fromgroups=#!topic/scrapy-users/QWd4DEVQ1Y0)：

```
def parse(self, response):
    hxs = HtmlXPathSelector(response)
    base_url = response.url
    links = hxs.select(self.toc_xpath)

    for index, link in enumerate(links):
        href, text = link.select('@href').extract(), link.select('text()').extract()
        yield Request(urljoin(base_url, href[0]), callback=self.parse2)

    for item in self.parse2(response):
        yield item 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-02T04:00:22.843

我不是 100% 我理解你的问题，但下面的代码使用 basespider 从起始 url 请求站点，然后扫描起始 url 以查找 href，然后循环每个调用**parse_url**的链接。**parse_url**中匹配的所有内容都会发送到您的项目管道。

```
def parse(self, response):
       hxs = HtmlXPathSelector(response)
       urls = hxs.select('//a[contains(@href, "content")]/@href').extract()  ## only grab url with content in url name
       for i in urls:
           yield Request(urlparse.urljoin(response.url, i[1:]),callback=self.parse_url)

def parse_url(self, response):
   hxs = HtmlXPathSelector(response)
   item = ZipgrabberItem()
   item['zip'] = hxs.select("//div[contains(@class,'odd')]/text()").extract() ## this bitch grabs it
   return item 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-05-09T20:43:09.930

来自谷歌群组的 Steven Almeroth：

你是对的，你可以产生请求并返回一个项目列表，但这不是你想要的。您正在尝试生成项目列表而不是返回它们。而且由于您已经使用 parse() 作为生成器函数，因此您不能同时使用 yield 和 return。但是你可以有很多收益。

试试这个：

```
def parse(self, response):
    hxs = HtmlXPathSelector(response)
    base_url = response.url
    links = hxs.select(self.toc_xpath)

    for index, link in enumerate(links):
        href, text = link.select('@href').extract(), link.select('text()').extract()
        yield Request(urljoin(base_url, href[0]), callback=self.parse2)

    for item in self.parse2(response):
        yield item 
```

# objective-c - ShareKit：为不同的共享者自定义文本（SHKActionSheet）

> ID：14093244
> 
> 赞同：0
> 
> 时间：2012-12-30T18:13:45.940
> 
> 标签：objective-c, subclass, sharekit

根据第 2 版的[官方常见问题解答](https://github.com/ShareKit/ShareKit/wiki/FAQ)，根据用户选择的共享者自定义您的文本/内容，您需要：

1.  SHKActionSheet 的子类并覆盖dismissWithClickedButtonIndex
2.  在配置器中设置新的子类名称（在 (Class)SHKActionSheetSubclass 中返回它；）。

它对我不起作用。但更重要的是：我把

```
NSLog(@"%@", NSStringFromSelector(_cmd)); 
```

在 (Class)SHKActionSheetSubclass 中查看它是否被调用。它不是 ;(( 所以 ShareKit 不关心这个配置选项......以前有人用过这个吗？

谢谢你！

**UPD1：我在这里放了一些代码。** 这是我的子类 ITPShareKitActionSheet 的样子。根据我需要覆盖的文档`dismissWithClickedButtonIndex:animated:`，但是为了跟踪我的类是否被调用，我还覆盖了`actionSheetForItem:`：

```
+ (ITPShareKitActionSheet *)actionSheetForItem:(SHKItem *)item
{
    NSLog(@"%@", NSStringFromSelector(_cmd));

    ITPShareKitActionSheet *as = (ITPShareKitActionSheet *)[super actionSheetForItem:item];

    return as;
}

- (void)dismissWithClickedButtonIndex:(NSInteger)buttonIndex animated:(BOOL)animate
{
    NSLog(@"%@", NSStringFromSelector(_cmd));

    NSString *sharersName = [self buttonTitleAtIndex:buttonIndex];
    [self changeItemForService:sharersName];
    [super dismissWithClickedButtonIndex:buttonIndex animated:animate];
} 
```

当用户按下“共享”按钮时，这是我在代码中创建操作表的操作：

```
- (IBAction)shareButtonPressed:(id)sender
{
    // Create the item to share
    SHKItem *item = [SHKItem text:@"test share text"];

    // Get the ShareKit action sheet
    ITPShareKitActionSheet *actionSheet = [ITPShareKitActionSheet actionSheetForItem:item];

    // Display the action sheet
    [actionSheet showInView:self.view]; // showFromToolbar:self.navigationController.toolbar];
} 
```

当我运行此代码时，按“共享”按钮并选择我希望在日志中获得两行的任何共享者：

1.  `actionSheetForItem:`- 创建了自定义操作表
2.  `dismissWithClickedButtonIndex:animated:`- 处理操作表按下按钮的自定义机制被调用。

但由于某种原因，我只记录了第一行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T20:34:25.140

编辑：到目前为止，实现这一目标的最佳方法是使用`SHKShareItemDelegate`. 更多信息在[ShareKit 的 FAQ](https://github.com/ShareKit/ShareKit/wiki/FAQ)中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T01:07:30.617

我遇到了同样的问题，但我突然成功地调用了我的子类。

首先我的配置器是这样设置的：

```
-(Class) SHKActionSheetSubclass{
    return NSClassFromString(@"TBRSHKActionSheet");
} 
```

现在我的子类：.h 文件

```
 #import "SHKActionSheet.h"
    @interface TBRSHKActionSheet : SHKActionSheet

    @end 
```

.m 实现覆盖：

```
#import "TBRSHKActionSheet.h"
#import "SHKActionSheet.h"
#import "SHKShareMenu.h"
#import "SHK.h"
#import "SHKConfiguration.h"
#import "SHKSharer.h"
#import "SHKShareItemDelegate.h"

@implementation TBRSHKActionSheet

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
if (self) {
    // Initialization code
}
return self;
}

    + (SHKActionSheet *)actionSheetForItem:(SHKItem *)i
{
        NSLog(@"%@", NSStringFromSelector(_cmd));

    SHKActionSheet *as = [self actionSheetForType:i.shareType];
    as.item = i;
    return as;
}

     - (void)dismissWithClickedButtonIndex:(NSInteger)buttonIndex animated:(BOOL)animated
{
   NSInteger numberOfSharers = (NSInteger) [sharers count];

    // Sharers
    if (buttonIndex >= 0 && buttonIndex < numberOfSharers)
    {
        bool doShare = YES;
        SHKSharer* sharer = [[NSClassFromString([sharers objectAtIndex:buttonIndex]) alloc] init];
        [sharer loadItem:item];
        if (shareDelegate != nil && [shareDelegate respondsToSelector:@selector(aboutToShareItem:withSharer:)])
        {
            doShare = [shareDelegate aboutToShareItem:item withSharer:sharer];
        }
        if(doShare)
            [sharer share];
    }

// More
else if ([SHKCONFIG(showActionSheetMoreButton) boolValue] && buttonIndex == numberOfSharers)
{
    SHKShareMenu *shareMenu = [[SHKCONFIG(SHKShareMenuSubclass) alloc] initWithStyle:UITableViewStyleGrouped];
    shareMenu.shareDelegate = shareDelegate;
    shareMenu.item = item;
    [[SHK currentHelper] showViewController:shareMenu];

}

[super dismissWithClickedButtonIndex:buttonIndex animated:animated];
} 
```

最后，在我的实现文件中，我没有像 Vilem 建议的那样修改对 SHKActionSheet 的调用，因为某些依赖项似乎对我造成了冲突。

所以这是我的来电者（直接来自教程）：

```
 NSURL *url = [NSURL URLWithString:@"http://getsharekit.com"];
    SHKItem *item = [SHKItem URL:url title:@"ShareKit is Awesome!" contentType:SHKURLContentTypeWebpage];

    // Get the ShareKit action sheet

    SHKActionSheet *actionSheet = [SHKActionSheet actionSheetForItem:item];

    // ShareKit detects top view controller (the one intended to present ShareKit UI) automatically,
    // but sometimes it may not find one. To be safe, set it explicitly
    [SHK setRootViewController:self];

    // Display the action sheet
    [actionSheet showFromToolbar:self.navigationController.toolbar]; 
```

这对我来说没有问题。

# regex - Htaccess 将 GET 请求重写为另一个 GET 请求和另一个带有 2 个 GET 变量的请求

> ID：14093248
> 
> 赞同：0
> 
> 时间：2012-12-30T18:13:55.837
> 
> 标签：regex, .htaccess

我有两个 url 我正在尝试重写，过去...... 4-5 小时（现在头痛）。

我正在尝试重写

```
/arts/tag/?tag=keyword 
```

到

```
/search/art?keywords=keyword 
```

看着其他问题，我像这样制定了我的重写

```
RewriteRule /arts/tag/?tag=([^&]+) search/art?keywords=$1 [L,R=301,NC] 
```

和

```
RewriteRule ^arts/tag/?tag=$ /search/art\?keywords=%1? [L,R=301,NC] 
```

我尝试使用反斜杠，没有，没有运气。

也试过

```
RewriteCond  %{QUERY_STRING} /arts/tag/?tag=([^&]+) [NC]
RewriteRule .* /search/art\?keywords=%1? [L,R=301,NC] 
```

* * *

第二个类似，

```
/arts/category?id=1&sortby=views&featured=1 
```

到

```
/art/moved?id=1&rearrange=view 
```

我更改 get 变量名称的原因是出于我自己的学习目的，因为我没有找到任何适合我的目的的教程。我还将类别更改为已移动，因为类别已更改，并且我必须在内部重定向一些 ID #。

```
RewriteCond %{QUERY_STRING} id=([^&]+) [NC] // I need the path in there though, not just query string, since I'll be redirecting /blogs/category and /art/category to different places.
RewriteRule .* /art/moved/id=%1? [L,R=301,NC] 
```

任何帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T22:52:51.050

假设原始 URL 中的查询与替换 URL 中的查询没有任何共同之处，也许这会做你想要的，使用`key`查询中的第一个作为条件并识别传入的 URL：

```
RewriteEngine On
RewriteBase /
# First case
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{QUERY_STRING}  \btag\b
RewriteRule .* http://example.com/search/art?keywords=keyword?  [L] 
```

将映射此： `http://example.com/arts/tag/?tag=keyword`

对此： `http://example.com/search/art?keywords=keyword`

```
# Second case
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{QUERY_STRING}  \bid\b
RewriteRule .* http://example.com/art/moved?id=1&rearrange=view?  [L] 
```

将映射此： `http://example.com/arts/category?id=1&sortby=views&featured=1`

对此： `http://example.com/art/moved?id=1&rearrange=view`

两者都被静默映射。如果要在浏览器的地址栏中显示新 URL，请像这样修改标志`[R,L]`。替换`R`为`R=301`永久重定向。

# python - 查看标签之间的 html 文本（python、lxml、urllib、xpath）

> ID：14093250
> 
> 赞同：1
> 
> 时间：2012-12-30T18:14:00.620
> 
> 标签：python, html, xpath, lxml, urllib

我正在尝试解析一些 html，并且我想检索标签之间的实际 html，但我的代码却给了我我认为是元素的位置。

到目前为止，这是我的代码：

```
import urllib.request, http.cookiejar
from lxml import etree
import io
site = "http://somewebsite.com"

cj = http.cookiejar.CookieJar()
request = urllib.request.Request(site)
opener = urllib.request.build_opener(urllib.request.HTTPCookieProcessor(cj))
request.add_header('User-agent', 'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:17.0) Gecko/20100101 Firefox/17.0')
html = etree.HTML(opener.open(request).read())

xpath = "//li[1]//cite[1]"
filtered_html = html.xpath(xpath)
print(filtered_html) 
```

这是一段html：

```
<div class="f kv">
<cite>
www.
<b>hello</b>
online.com/
</cite>
<span class="vshid">
</div> 
```

目前我的代码返回：

```
[<Element cite at 0x36a65e8>, <Element cite at 0x36a6510>, <Element cite at 0x36a64c8>] 
```

如何提取引用标签之间的实际 html 代码？如果我将“/text()”添加到我的 xpath 的末尾，它会让我更接近，但它会忽略 b 标签中的内容。我的最终目标是让我的代码给我“www.helloonline.com/”。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:25:13.037

用于从给定位置`//text()`获取*所有*文本元素：

```
text = filtered_html.xpath('//text()')
print ''.join(t.strip() for t in text)  # prints "www.helloonline.com/" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-19T14:11:42.927

这可以通过 just 来完成`requests`，`lxml`并`/text()`在您的`xpath`

```
import requests
from lxml import html

site = "http://somewebsite.com"
tree = html.fromstring(requests.get(site).content)
xpath = "//li[1]//cite[1]/text()"
data = tree.xpath(xpath) 
```

# php - PushState 不更新相关评论/facebook 喜欢每部漫画的计数

> ID：14093252
> 
> 赞同：1
> 
> 时间：2012-12-30T18:14:13.240
> 
> 标签：php, javascript

> **可能重复：**
> [如何向 AJAX 驱动的页面添加 Facebook “Like”按钮](https://stackoverflow.com/questions/4219729/how-to-add-a-facebook-like-button-to-an-ajax-driven-page)

我有一个漫画网站（[www.hittingtreeswithsticks.com](http://www.hittingtreeswithsticks.com)`window.history.pushState(null, null, '.?action=viewcomic&id=' + imgIndex);` ），每次有人获得下一个或上一个漫画时，我都会使用它来更新 URL id。

我还想将评论/喜欢功能与每个单独的漫画相关联，这样我就可以看到它们有多受欢迎。

我在查看漫画页面上放了以下 fb 点赞和评论代码（即将更改为 DISQUS）：

```
<center>
<div class="fb-like" data-href="http://www.hittingtreeswithsticks.com/" data-send="true" data-layout="button_count" data-width="450" data-show-faces="true" data-font="trebuchet ms"></div>         
<br />
<br />
<div class="fb-comments" data-href="http://www.hittingtreeswithsticks.com" data-num-posts="2" data-width="470"></div>
</center> 
```

到目前为止，点赞只与整个网站相关联，与特定漫画无关……所以如果我去下一个漫画，它的点赞数（645）和评论仍然相同。

![在此处输入图像描述](../Images/84a3fd95c6c325e98390bcab0da71aaa.png)

我可以做些什么来将喜欢/评论或其他任何与特定漫画 ID 关联起来？

谢谢！

# html - 无论窗口大小如何，都将图像置于中心并溢出

> ID：14093253
> 
> 赞同：1
> 
> 时间：2012-12-30T18:14:17.973
> 
> 标签：html, css, positioning, image

我`img`在我的网站上定位徽标 ( ) 时遇到了一些问题。我希望它始终居中并且窗口大小。同时，我希望它在它所在的 div 的底部重叠/溢出。

它被放置在 div 中`main`，我希望它越过名为`nav`. 我让它重叠没有任何问题，但它根本不会保持居中！

有什么建议么？

CSS

```
body {
    width:100%;
    font-family: Cusmyr, sans serif;
    font-size:2em;
    margin:0em;

}

@font-face {
    font-family:Cusmyr;
    src: url('font/myriadproregot.otf'), url('font/myriadproregsv.svg'), url('font/myriadproregtt.ttf');
}   

#nav {
    background:#ffffff;
    width:100%;
    height:4em;
    margin-top:-18px;

}    

#nav ul {
    list-style-type:none;
}

#nav li {
    display:inline;
    float:left;
    width:2%;
    margin-left:10%;
    margin-right:10%;
    margin-top:5%;
}

#nav a {
    display:block;
    width:20%;
    margin-right:0% auto;
    padding-left:0% auto;
    color:#5E09CB;
    text-decoration:none;
}

.clear {
    clear:both;
}

#logo {
    position: absolute;  
}

#main {
    width:100%;
    position:relative;
    border-top: 0.1em solid #000000;
}       

#main img {
    margin-bottom:-0.1em;
    padding:0em;
}           

#text-left p {
    position:absolute;
    color:#ffffff;
    padding-left:8%;
    padding-top:8%;
    letter-spacing:0.1em;
    line-height:1.1;
}

#text-right p {    
    position:absolute;
    color:#ffffff;
    padding-left:75%;
    padding-top:8%;
    letter-spacing:0.1em;
    line-height:1.1;
}

#enter {
    display:block;
    position:absolute;
    width:7em;
    height:1.5em;
    bottom:5%;
    left:0;
    right:0;
    margin-left:auto;
    margin-right:auto;
    background-color:#39895B;
    -moz-box-shadow: 0px 3px 14px #000000;
    -webkit-box-shadow: 0px 3px 14px #000000;
    box-shadow: 0px 3px 14px #000000;
    border-radius:3px;
    -moz-border-radius:3px;
}

#enter a {
    position:absolute;
    text-align:center;
    font-size:1em;
    line-height:0.0em;
    color:#ffffff;
    margin-top:0.8em;
    left:0;
    right:0;
    margin-left:auto;
    margin-right:auto;
    text-decoration:none;
}   

#donations p {
    position:absolute;
    color:#ffffff;
    font-size:0.65em;
    text-align:left;
    margin-bottom:10%;
    left:1%;
    width:12em;
}

#donations {
    position:relative;
    width:100%;
    height:8em;
    background-color:#333334;
    margin-top:-1%;
    border-top:0.1em solid #000000;
    overflow:hidden;
}

#donations a {
    display:block;
    position:absolute;
    text-align:center;
    font-size:0.8em;
    width:6em;
    padding:0.2em;
    height:1.1em;
    bottom:8%;
    left:10%;
    right:0;
    background-color:#5E09CB;
    color:#ffffff;
    -moz-box-shadow: 0px 3px 14px #000000;
    -webkit-box-shadow: 0px 3px 14px #000000;
    box-shadow: 0px 3px 14px #000000;
    border-radius:3px;
    -moz-border-radius:3px;
    text-decoration:none;       
}

.dontime p {
    position:absolute;
    text-decoration:underline;
    float:right;
    right:0;
    width:15em;
    top:-3%;
    margin-right:1%;
    color:#ffffff;
    font-size:0.65em;
}

.meter {
    height:20px;
    width:30%;
    position:relative;
    background:#555;
    -moz-border-radius:3px;
    -webkit-border-radius:3px;
    border-radius:3px;
    padding:3px;
    margin-top:1%;
    left:1%;
    -webkit-box-shadow: inset 0 -1px 1px rgba(255,255,255,0.3);
    -moz-box-shadow   : inset 0 -1px 1px rgba(255,255,255,0.3);
    box-shadow        : inset 0 -1px 1px rgba(255,255,255,0.3);
}

.meter > span {
    display: block;
    height: 100%;
       -webkit-border-top-right-radius: 3px;
    -webkit-border-bottom-right-radius: 3px;
           -moz-border-radius-topright: 3px;
        -moz-border-radius-bottomright: 3px;
               border-top-right-radius: 3px;
            border-bottom-right-radius: 3px;
        -webkit-border-top-left-radius: 3px;
     -webkit-border-bottom-left-radius: 3px;
            -moz-border-radius-topleft: 3px;
         -moz-border-radius-bottomleft: 3px;
                border-top-left-radius: 3px;
             border-bottom-left-radius: 3px;
    background-color: rgb(43,194,83);
    background-image: -webkit-gradient(
      linear,
      left bottom,
      left top,
      color-stop(0, rgb(43,194,83)),
      color-stop(1, rgb(84,240,84))
     );
    background-image: -webkit-linear-gradient(
      center bottom,
      rgb(43,194,83) 37%,
      rgb(84,240,84) 69%
     );
    background-image: -moz-linear-gradient(
      center bottom,
      rgb(43,194,83) 37%,
      rgb(84,240,84) 69%
     );
    background-image: -ms-linear-gradient(
      center bottom,
      rgb(43,194,83) 37%,
      rgb(84,240,84) 69%
     );
    background-image: -o-linear-gradient(
      center bottom,
      rgb(43,194,83) 37%,
      rgb(84,240,84) 69%
     );
    -webkit-box-shadow: 
      inset 0 2px 9px  rgba(255,255,255,0.3),
      inset 0 -2px 6px rgba(0,0,0,0.4);
    -moz-box-shadow: 
      inset 0 2px 9px  rgba(255,255,255,0.3),
      inset 0 -2px 6px rgba(0,0,0,0.4);
    position: relative;
    overflow: hidden;
}

        .animate > span:after {
            display: none;
        }

        @-webkit-keyframes move {
            0% {
               background-position: 0 0;
            }
            100% {
               background-position: 50px 50px;
            }
        }

        .orange > span {
            background-color:#5E09CB;
            background-image: -moz-linear-gradient(top, #8959c6, #5E09CB);
            background-image: -webkit-gradient(linear,left top,left bottom,color-stop(0, #8959c6),color-stop(1, #5E09CB));
            background-image: -webkit-linear-gradient(#8959c6, #5E09CB); 
        }

#gallery {
    position:relative;
    margin-top:0em;
    width:100%;
    padding-bottom:5em;
    background-color:#ffffff;
    border-top:0.1em solid #000000;
    overflow:hidden;

}

#gallerytext p {
    color:#DACB29;
    text-align:center;
    margin-top:4%;
}    

#kranz img {
    display:block;
    margin-top:-5%;
    margin-left:auto;
    margin-right:auto;    
}

#pic1 img {
    display:block;
    float:left;
    margin-left:10%;
    margin-top:-7%;
    -moz-box-shadow: 5px 5px 10x #000000;
    -webkit-box-shadow: 5px 5px 10px #000000;
    box-shadow: 5px 5px 10px #000000;           
}

#pic2 img {
    display:block;
    float:left;
    margin-left:10%;
    margin-top:10%;
    -moz-box-shadow: 5px 5px 10x #000000;
    -webkit-box-shadow: 5px 5px 10px #000000;
    box-shadow: 5px 5px 10px #000000;
}

#pic3 img {
    display:block;
    float:left;
    margin-left:10%;
    margin-top:-7%;
    -moz-box-shadow: 5px 5px 10x #000000;
    -webkit-box-shadow: 5px 5px 10px #000000;
    box-shadow: 5px 5px 10px #000000;
}

#pic4 img {
    display:block;
    float:left;
    margin-top:22%;
    margin-left:-80%;
    -moz-box-shadow: 5px 5px 10x #000000;
    -webkit-box-shadow: 5px 5px 10px #000000;
    box-shadow: 5px 5px 10px #000000;
}

#pic5 img {
    display:block;
    float:left;
    margin-top:35%;
    margin-left:-50%;
    -moz-box-shadow: 5px 5px 10x #000000;
    -webkit-box-shadow: 5px 5px 10px #000000;
    box-shadow: 5px 5px 10px #000000;       
}

#pic6 img {
    display:block;
    float:left;
    margin-top:22%;
    margin-left:-20%;
    -moz-box-shadow: 5px 5px 10x #000000;
    -webkit-box-shadow: 5px 5px 10px #000000;
    box-shadow: 5px 5px 10px #000000;       
}

#pic7 img {
    display:block;
    float:left;
    margin-top:50%;
    margin-left:-85%;
    -moz-box-shadow: 5px 5px 10x #000000;
    -webkit-box-shadow: 5px 5px 10px #000000;
    box-shadow: 5px 5px 10px #000000;
}

#pic8 img {
    display:block;
    float:left;
    margin-top:60%;
    margin-left:-55%;
    -moz-box-shadow: 5px 5px 10x #000000;
    -webkit-box-shadow: 5px 5px 10px #000000;
    box-shadow: 5px 5px 10px #000000;
}

#pic9 img {
    display:block;
    float:left;
    margin-top:55%;
    margin-left:-25%;
    -moz-box-shadow: 5px 5px 10x #000000;
    -webkit-box-shadow: 5px 5px 10px #000000;
    box-shadow: 5px 5px 10px #000000;
}

.clock {
    position:absolute;
    right:-1.5%;
    bottom:1%;
    width:25em;
}

.clock_days {
    margin-right:0.5%;
    float:left;
}
.clock_hours {
    margin-right:0.5%;
    float:left;
}
.clock_minutes {
    margin-right:0.5%;
    float:left;
}
.clock_seconds {
    margin-right:0.5%;
    float:left;
}

.bgLayer { 
    background-image:url(img/bg.png); 
    background-repeat:no-repeat;
    position:relative; 
}

.topLayer { 
    position:absolute; 
    background-image:url(img/top.png); 
    width:6em;
    height:6em;
    margin-bottom:5%;
    background-repeat:no-repeat;
}

.text { position:absolute; top:5%; left:5%; width:10%;  height:10%;}

.val {
    font-family:Myriad Pro;
    font-size:47px;
    font-weight:bold;
    color:#FFF;
    text-align:right;
    line-height:2em;
    margin-top:2%;
    width:10%;
}

.type_days {
    font-family:Myriad Pro;
    color:#ff6565;
    width:3%;
    text-align:center;
    font-size:13px;
    line-height:1.5em;
    font-weight:bold;
    text-transform:uppercase;
}

.type_hours {
    font-family: Myriad Pro;
    color:#378cff;
    width:3%;
    text-align:right;
    font-size:13px;
    line-height:1.5em;
    font-weight:bold;
    text-transform:uppercase;
}

.type_minutes {
    font-family: Myriad Pro;
    color:#9cdb7d;
    width:3%;
    text-align:right;
    font-size:13px;
    line-height:1.5em;
    font-weight:bold;
    text-transform:uppercase;
}

.type_seconds {
    font-family: Myriad Pro, Arial, Helvetica, sans-serif;
    color:#ffdc50;
    width:3%;
    text-align:right;
    font-size:13px;
    line-height:1.5em;
    font-weight:bold;
    text-transform:uppercase;
} 

#entergal a {
    position:absolute;
    text-align:center;
    font-size:1em;
    line-height:0.0em;
    color:#ffffff;
    margin-top:0.8em;
    left:0;
    right:0;
    margin-left:auto;
    margin-right:auto;
    text-decoration:none;
}

#entergal   {
    display:block;
    position:absolute;
    width:7em;
    height:1.5em;
    bottom:2%;
    left:0;
    right:0;
    margin-left:auto;
    margin-right:auto;
    background-color:#39895B;
    -moz-box-shadow: 0px 3px 14px #000000;
    -webkit-box-shadow: 0px 3px 14px #000000;
    box-shadow: 0px 3px 14px #000000;
    border-radius:3px;
    -moz-border-radius:3px;
}

#social {
    position:relative;
    width:100%;
    height:4em;
    background-color:#5E09CB;
    margin-top:-1%;
    border-top:0.1em solid #000000;
    overflow:hidden;
}

.table {
    display:table;
    margin:0 auto;
}

#social ul {
    list-style-type:none;
    padding-left:30%;
    padding-right:30%;
}

ul#sociallist {
    min-width:17em;
    list-style:none;
    padding-top:none;
}

ul#sociallist li {
    display:inline;
}

#foot {
    position:relative;
    width:100%;
    padding-bottom:0.5em;
    background-color:#333334;
    margin-top:-1%;
    border-top:0.1em solid #000000;
    overflow:hidden;        
}

.tablefoot {
    display:table;
    margin:0 auto;
}

#foot ul {
    list-style-type:none;
    padding-left:30%;
    padding-right:30%;    
}

ul#footnav {
    min-width:25em;
    padding-top:none;
    list-style:none;
    padding-left:25%;
}

ul#footnav li {
    display:inline;
    padding:0.5%;    
}

#foot a {
    text-decoration:none;
    color:#1D88B5;
}

#copy-text p {
    text-align:center;
    color:#FFFFFF;
    font-size:0.5em;
}

#create-text p {
    text-align:center;
    color:#1D88B5;
    font-size:0.25em;
} 
```

html

```
<body>
<div id="nav">
    <ul>
        <li><img src="images/thumb.png" alt="thumb" width="100px" /><a href="index.html">COMPETE</a></li>
        <li><img src="images/thumb.png" alt="thumb" width="100px" /><a href="index.html">SCORE</a></li>
        <li><img src="images/thumb.png" alt="thumb" width="100px" /><a href="index.html">SHOP</a></li>
        <li><img src="images/thumb.png" alt="thumb" width="100px" /><a href="index.html">MORE</a></li>
    </ul>
</div>
<div class="clear"> </div>
<div id="main">
    <div id="logo"> <img src="images/logorz.png" alt="logo" width="180px" /> </div>
    <div id="text-left">
        <p><strong>Good cause<br />marketplace<br />for limited<br />art-pieces</strong></p>
    </div>
    <div id="text-right">
        <p><strong>... produced by<br />the most<br />creative crowd<br />out there</strong></p>
    </div>
    <div id="enter"> <a href="index.html">Enter contest</a> </div>
    <img src="images/front-img.png" alt="gallery images" width="100%" />
</div>
<div id="donations">
    <div class="meter orange nostripes"> <span style="width:31.99%"></span> </div>
    <p><strong>$7.678</strong> of <strong>$24,000</strong> donated this month<br />
        This month's donations will help streetdogs in<br />
        Bulgaria to find new owners!</p>
    <div class="wrapper">
        <div class="clock"> 
            <!-- Days -->
            <div class="clock_days">
                <div class="bgLayer">
                    <div class="topLayer"></div>
                    <canvas id="canvas_days" width="188" height="188"> </canvas>
                    <div class="text">
                        <p class="val">0</p>
                        <p class="type_days">Days</p>
                    </div>
                </div>
            </div>
            <!-- Days --> 
            <!-- Hours -->
            <div class="clock_hours">
                <div class="bgLayer">
                    <div class="topLayer"></div>
                    <canvas id="canvas_hours" width="188" height="188"> </canvas>
                    <div class="text">
                        <p class="val">0</p>
                        <p class="type_hours">Hours</p>
                    </div>
                </div>
            </div>
            <!-- Hours --> 
            <!-- Minutes -->
            <div class="clock_minutes">
                <div class="bgLayer">
                    <div class="topLayer"></div>
                    <canvas id="canvas_minutes" width="188" height="188"> </canvas>
                    <div class="text">
                        <p class="val">0</p>
                        <p class="type_minutes">Minutes</p>
                    </div>
                </div>
            </div>
            <!-- Minutes --> 
            <!-- Seconds -->
            <div class="clock_seconds">
                <div class="bgLayer">
                    <div class="topLayer"></div>
                    <canvas id="canvas_seconds" width="188" height="188"> </canvas>
                    <div class="text">
                        <p class="val">0</p>
                        <p class="type_seconds">Seconds</p>
                    </div>
                </div>
            </div>
            <!-- Seconds --> 
        </div>
        <a href="index.html">More info</a> 
    </div>
</div>
<div id="gallery">
    <div id="gallerytext">
        <p>This week's<br />heroes</p>
    </div>
    <div id="kranz"> <img src="images/kranz.png" alt="kranz" width="310px" /> </div>
    <div id="pic1"> <img src="frontgallery/1.jpg" alt="gallery image 1" width="20%" /> </div>
    <div id="pic2"> <img src="frontgallery/2.jpg" alt="gallery image 2" width="20%" /> </div>
    <div id="pic3"> <img src="frontgallery/3.jpg" alt="gallery image 3" width="20%" /> </div>
    <div id="pic4"> <img src="frontgallery/4.jpg" alt="gallery image 4" width="20%" /> </div>
    <div id="pic5"> <img src="frontgallery/5.jpg" alt="gallery image 5" width="20%" /> </div>
    <div id="pic6"> <img src="frontgallery/6.jpg" alt="gallery image 6" width="25%" /> </div>
    <div id="pic7"> <img src="frontgallery/7.jpg" alt="gallery image 7" width="20%" /> </div>
    <div id="pic8"> <img src="frontgallery/8.jpg" alt="gallery image 8" width="20%" /> </div>
    <div id="pic9"> <img src="frontgallery/9.jpg" alt="gallery image 9" width="20%" /> </div>
    <div id="entergal"> <a href="index.html">Enter contest</a> </div>
</div>
<div id="social">
    <div class="table">
        <ul id="sociallist">
            <li><a href="http://eyeem.de" target="_blank"><img src="images/cam.png" alt="camera link" height="40%" /></a></li>
            <li><a href="http://facebook.com" target="_blank"><img src="images/facebook.png" alt="facebook link" height="40%" /></a></li>
            <li><a href="http://twitter.com" target="_blank"><img src="images/twitter.png" alt="twitter link" height="40%" /></a></li>
            <li><a href="http://youtube.com" target="_blank"><img src="images/youtube.png" alt="youtube link" height="40%" /></a></li>
        </ul>
    </div>
</div>
<div id="foot">
    <div class="tablefoot">
        <ul id="footnav">
            <li><a href="index.php"><strong>Compete</strong></a></li>
            <li><a href="index.php"><strong>Score</strong></a></li>
            <li><a href="index.php"><strong>Shop</strong></a></li>
            <li><a href="index.php"><strong>More</strong></a></li>
        </ul>
    </div>
    <div id="copy-text">
        <p><strong>Copyright © 2012 Artwork Heroes, Inc. All photos © their respective owners</strong>
        <p> 
    </div>
    <div id="create-text">
        <p><strong>Created with Scandinavian love in Copenhagen, Denmark</strong></p>
    </div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T17:09:03.750

如果要将绝对定位的图像居中，可以这样做：

```
#logo {
position:absolute;
width:200px;
left:50%;
margin-left:-100px;
} 
```

将宽度替换为徽标的实际宽度，负左边距是该宽度的一半。

如果您希望它以其父级为中心，则父级应该相对定位。

# python - Python：TypeError：不可散列类型：列表

> ID：14093259
> 
> 赞同：0
> 
> 时间：2012-12-30T18:15:27.630
> 
> 标签：python, numpy

我有一个代码，它基本上测试了盒子触摸中随机分布的圆圈中的哪些圆圈 - 触摸圆圈作为簇添加到字典中。运行此代码时，我不断收到 TypeError：

```
leftedge = 0
rightedge = 1
result = []
color = {}
parent = {}
clusters = {}
number = 0

def bfs(vertices, neighbours, source) :

    global number
    number +=1
    clusters[number] = set()
    color[source] = 'g'
    q = []

    q.append(source)

    while q != [] :
        v = q.pop(0)

        for v2 in neighbours[v] :
            if color[v2] == 'w' :
                 color[v2] = 'g'
                 parent[v2] = v
                 q.append(v2)
            color[v] = 'b'
            clusters[number].add(v)

def createclusters(vertices, neighbours) :

    for v in vertices :
        color[v] = 'w'
        parent[v] = -1

    while 'w' in color.values() :
            for v in color.keys() :
                if color[v] == 'w' :
                    bfs(vertices, neighbours, v)

def overlap(c1,c2,r) :
    if ((c1[0]-c2[0])**2 +(c1[0]-c2[0])**2)**0.5 > 2*radius :
         return 0
    return 1

def findclusters(array, radius) :
    d={}

    for c1 in array :
        d[c1]=[]
        for c2 in array :
            if overlap(c1, c2, radius) :
            d[c1].append(c2)

    createclusters(array,d)

    for cluster in clusters.values() :
        l = [i[0] for i in cluster]
        left = right = False

        x = max(l) 
        if x + radius > rightedge :
            right = True
        x = min(l)
        if x - radius < leftedge :
            left = True

        result.append((cluster,left,right))

import numpy.random as nr

array = nr.uniform(size=(10,2)).tolist
radius = 0.1

findclusters(array, radius)

print(clusters)

print(result) 
```

当我尝试运行它时，我收到此错误：

```
TypeError                                 Traceback (most recent call last)
/Users/annikamonari/<ipython-input-316-be6c65f2ce89> in <module>()
----> 1 findclusters(array,0.1)

/Users/annikamonari/<ipython-input-309-32f214b46080> in findclusters(array, radius)
      2     d={}
      3     for c1 in array:
----> 4         d[c1]=[]
      5         for c2 in array:
      6             if overlap(c1,c2,radius):

TypeError: unhashable type: 'list' 
```

对于我的生活，无法弄清楚为什么。任何人都可以弄清楚吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T18:19:53.343

首先，您可能需要调用`.tolist()`而不是离开括号。

* * *

另外，`array`是一个二维数组，这意味着当你做...

```
for c1 in array:
    d[c1]=[] 
```

...c1 是一个列表。列表是可变的，不是可散列的类型（因为如果它们是，散列可能会根据内容的变化随时更改，并且基于散列的数据结构并非旨在处理它），因此不能使用作为字典键。

如果您*打算*使用一系列值作为字典键，则需要首先使它们不可变（因此可散列）。最简单的方法是转换为`tuple`：

```
for c1 in array:
    d[tuple(c1)]=[] 
```

但是，通过阅读您的代码，似乎您可能只想遍历第一个数组的索引，这意味着您可能想要类似...

```
for index, values in enumerate(array):
    d[index] = []
    for c2 in values:
        # ... 
```

或类似的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T03:23:12.430

由于程序期望数组是 2d 可散列类型（2d 元组）的列表，因此最好在调用任何函数之前将数组转换为该形式。

```
temp = nr.uniform(size=(10,2)).tolist()

array = [tuple(i) for i in temp] 
```

这应该以所需的格式创建输入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T18:22:53.367

您实际上并没有在代码中调用 tolist 方法，您只需传递函数本身。

添加 () 来调用它：

```
array = nr.uniform(size=(10,2)).tolist() 
```

请注意，代码中的 c2 是两个数字的列表，而不是单个数字。

# objective-c - 缩放和合并的图像未正确保存（iOS）

> ID：14093261
> 
> 赞同：0
> 
> 时间：2012-12-30T18:15:40.260
> 
> 标签：objective-c, ios, uiimage

我截取了窗口的某个部分的屏幕截图，然后将其缩小并与同样缩小的图像合并。问题是当我转到它的路径时，有一个保存为 0KB 的 PNG 文件，所以图像没有保存。任何的想法？谢谢！

这是我当前的代码：

```
//Save images
- (void) saveimages {

    //Save small one (mini)
    NSString *docDir = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
    UIGraphicsBeginImageContextWithOptions((myImageView.bounds.size), NO, 0.5);
    [myImageView.layer renderInContext:UIGraphicsGetCurrentContext()];
    UIImage *mini = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    float miniVW = VView.image.size.width / 2;
    float miniVH = VView.image.size.height / 2;
    UIImage *miniV = [self imageWithImage:certain.image convertToSize:CGSizeMake(miniVW, miniVH)];
    UIImage *miniTotal = [self mergeIMG:miniV:mini];
    NSString *pngFilePath = [NSString stringWithFormat:@"%@/mini%i.png",docDir,number];
    NSData *data = [NSData dataWithData:UIImagePNGRepresentation(miniTotal)];
    [data writeToFile:pngFilePath atomically:YES];

}

//Merge two images in one
- (UIImage *) mergeIMG:(UIImage *)VextImg:(UIImage *)VintImg {

    //Create a new image from two
    CGSize newSize = CGSizeMake(VintImg.size.width, VintImg.size.width);
    [VintImg drawInRect:CGRectMake(0, 0, newSize.width, newSize.height)];
    [VextImg drawInRect:CGRectMake(0, 0, newSize.width, newSize.height) blendMode:kCGBlendModeNormal alpha:1.0];
    UIImage *finalIMG = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return finalIMG;
}

//Scale image
- (UIImage *) imageWithImage:(UIImage *)image convertToSize:(CGSize)size {

    //Change size
    UIGraphicsBeginImageContext(size);
    [image drawInRect:CGRectMake(0, 0, size.width, size.height)];
    UIImage *destImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return destImage;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T18:33:22.623

`mergeImage`不打电话`UIGraphicsBeginImageContextWithOptions`

# jquery - 如何打印保持CSS的div内容

> ID：14093262
> 
> 赞同：2
> 
> 时间：2012-12-30T18:15:41.193
> 
> 标签：jquery, css, html, printing

我想打印 div 内容，同时将 css 应用于 div 及其内部 html。

我正在使用 jQuery Print Element，但它剥离了 css。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T18:29:56.607

怎么样

```
function printDiv(id) {

  var html = "";

  $('link').each(function() { // find all <link tags that have
    if ($(this).attr('rel').indexOf('stylesheet') !=-1) { // rel="stylesheet"
      html += '<link rel="stylesheet" href="'+$(this).attr("href")+'" />';
    }
  });
  html += '<body onload="window.focus(); window.print()">+$("#"+id).html()+'</body>';
  var w = window.open("","print");
  if (w) { w.document.write(html); w.document.close() }

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-10T23:46:05.410

[https://github.com/jasonday/printThis](https://github.com/jasonday/printThis)

我为这个确切的场景创作的插件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T22:11:05.760

使用 .html() 方法。它将抓取所选元素内的所有 HTML。

```
var myDivContents = $("div").html(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T22:21:28.087

您可以访问 div 的所有内容

```
var $contents = $( 'div' ).contents(); 
```

这包括所有标签和文本。

如果您只对可以使用的代码感兴趣

```
var htmlContents = $( 'div' ).html(); 
```

这将为您提供字符串形式的内容。

要打印出代码，只需将其插入另一个元素

```
$( 'div.new' ).append( $contents );

$( 'div.new' ).html( htmlContents ); 
```

如果某些样式未应用，可能它们依赖于包装元素及其类，这是需要了解的重要事项。

# map - AngularJS - 范围搜索

> ID：14093264
> 
> 赞同：2
> 
> 时间：2012-12-30T18:16:00.283
> 
> 标签：map, angularjs, range, marker

我对 AngularJS 很陌生，但它绝对适合我的项目。

这是我的问题：
我的客户有一个静态编码地图（不是谷歌）。在这张地图上，我们有 15 个服装经销商（硬编码）。

我的 json 文件：

```
[
{
    "id": "2",
    "name": "Laden Dortmund",
    "zip": 12345,
    "stadt": "Dortmund",
    "land": "DE",
    "left": "200px",
    "top": "300px"
},
{
    "id": "1",
    "name": "Laden Unna",
    "zip": 45568
    "stadt": "Unna",
    "land": "DE",
    "left": "250px",
    "top": "400px"
}
] 
```

等等......
用“左”和“上”我用标记标记我的地图：

```
<div class="map" ng-controller="DealerDetailListCtrl">
    <a class="marker" id="{{marker.id}}" style="left:{{marker.left}};top:{{marker.top}}" ng-repeat="marker in dealer"></a>
</div> 
```

这对所有条目都有效。
现在我们的客户想要对条目进行邮政编码搜索。喜欢：
- Reseller1（邮政编码：45525）-> 应放置在地图的此区域。
- Reseller2（邮政编码：12345）-> 应放置在地图的 xx 区域。等等。

**我需要的是：**
Angular JS 是否有可能有这样的搜索框：

```
<input type="text" name="postalcode" class="postalcode" ngRequired> 
```

并搜索（例如）“45525”，我得到了这个邮政编码中+/-的所有标记？
也许每个条目都会得到两个新节点“RangeStart”（开始：40000“）和“RangeEnd”（结束：50000“），如果我搜索“45525”，所有条目都会显示，其中搜索词在范围内。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T20:32:52.637

我正在烤一个苹果派，所以我不能更快地回复你，但正如你在评论中提到的那样，使用自定义过滤器可以做到这一点。

```
myApp.filter("zipFilter", function() { return function(markers, zipCode) {

    var retMarkers = [];
    var lowRange = parseInt(zipCode, 10) - 1000;
    var highRange = parseInt(zipCode, 10) + 1000;

    // console.log('low: ' + lowRange);
    // console.log('high: ' + highRange);

    // loop through all the markers
    for(var i = 0, len = markers.length; i < len; ++i) {
        var singleMarker = markers[i];
        // if the marker falls within the range (+/- 1000)...
        if(singleMarker.zip >= lowRange && singleMarker.zip <= highRange) {
            retMarkers.push(singleMarker);
        }
    }

    return retMarkers;
}}); 
```

在这里在线查看它[http://jsfiddle.net/CWcxL/7/](http://jsfiddle.net/CWcxL/7/)并尝试输入“44100”并查看它如何根据一系列邮政编码过滤掉结果（在这种情况下，+/- 1000 从任何已输入）。

祝你好运！

# c#-4.0 - 列出 DLL 中的所有类

> ID：14093266
> 
> 赞同：0
> 
> 时间：2012-12-30T18:16:19.500
> 
> 标签：c#-4.0, reflection

我想列出 DLL 中的所有类，而无需加载依赖项。我不想执行任何功能，我只想（有问题地）找出给定 DLL 中的类。那可能吗？我尝试使用 assembly.GetTypes() 调用，但由于执行 DLL 的依赖关系而失败。有没有其他方法可以列出所有的公共课程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:24:15.400

我建议你使用 mono [Cecil](http://www.mono-project.com/Cecil%3aFAQ)库。这是基本示例：

```
//Creates an AssemblyDefinition from the "MyLibrary.dll" assembly
AssemblyDefinition myLibrary = AssemblyFactory.GetAssembly ("MyLibrary.dll");

//Gets all types which are declared in the Main Module of "MyLibrary.dll"
foreach (TypeDefinition type in myLibrary.MainModule.Types) {
    //Writes the full name of a type
    Console.WriteLine (type.FullName);
} 
```

这不会加载所有依赖项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T18:23:45.507

您可以使用[Assembly.ReflectionOnlyLoad](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.reflectiononlyloadfrom.aspx)方法加载程序集而不执行它。

[如何：将程序集加载到仅反射上下文中](http://msdn.microsoft.com/en-us/library/ms172331%28VS.80%29.aspx)

您还需要附加[AppDomain.ReflectionOnlyAssemblyResolve](http://msdn.microsoft.com/en-us/library/system.appdomain.reflectiononlyassemblyresolve.aspx) as 在仅反射上下文中，依赖项不会自动解析。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-01T00:10:59.857

好的，我找到了。这种组合可以获取所有类的列表，而无需处理依赖关系：

程序集程序集 = Assembly.LoadFrom(filename); Type[] types = assembly.GetTypes();

# windows - 来自 Windows GetLogicalProcessorInformationEx 函数的令人困惑的 ReturnLength

> ID：14093267
> 
> 赞同：3
> 
> 时间：2012-12-30T18:16:25.360
> 
> 标签：windows

我正在尝试在 Windows 中使用（相当新的）GetLogicalProcessorInformationEx 函数。它给出的 ReturnLength 没有意义。

较旧的 GetLogicalProcessorInformation 给出了合理的结果......

```
ReturnLength = 0;
Result = GetLogicalProcessorInformation(NULL, &ReturnLength);
printf("GLPI (%d): %d %d\n",
       Result,
       sizeof(SYSTEM_LOGICAL_PROCESSOR_INFORMATION),
       ReturnLength); 
```

这是输出（2 核，64 位，Win7 机器）： GLPI (0): 32 416

换句话说，该函数将使用 416/32=13 SYSTEM_LOGICAL_PROCESSOR_INFORMATION 结构填充我传递的缓冲区。

对于 GetLogicalProcessorInformationEx，这是我的电话...

```
ReturnLength = 0;
Result = GetLogicalProcessorInformationEx(RelationProcessorCore,
                                          NULL, &ReturnLength);
printf("GLPIX (%d): %d %d %d\n",
       Result,
       sizeof(PROCESSOR_RELATIONSHIP),
       sizeof(SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX),
       ReturnLength); 
```

这是输出（2 核，64 位，Win7 机器）： GLPIX (0): 40 80 96

Microsoft 文档 (http://msdn.microsoft.com/en-us/library/windows/desktop/dd405488(v=vs.85).aspx) 表明该函数将返回 PROCESSOR_RELATIONSHIP 或 SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX 结构，具体取决于第一个参数的值。ReturnLength 表明它也不会返回，尽管 - 96 不能被 sizeof(PROCESSOR_RELATIONSHIP) 或 sizeof(SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX) 整除。

我还为第一个参数尝试了 RelationAll，它给出了 768 的 ReturnLength - 也不是倍数或 40 或 80。

任何人都可以解释一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:51:22.130

您需要相信函数返回给您的内容。必然如此，联合中的结构具有*不可预测的大小*。特别是 PROCESSOR_RELATIONSHIP 的这个成员：

```
 GROUP_AFFINITY GroupMask[ANYSIZE_ARRAY]; 
```

ANYSIZE_ARRAY 宏是一个提示，它表示 GroupMask 数组的大小是可变的，并且取决于 GroupCount 成员的值。在结构上使用 sizeof 永远不会给你正确的大小，它会太小。请务必使用返回的大小为结构分配存储空间，如下所示：

```
SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX* buf = 
    (SYSTEM_LOGICAL_PROCESSOR_INFORMATION_EX*)malloc(ReturnLength); 
```

这种模式在 C 和 winapi 中很常见。

# iphone - 从 iPhone sdk 中的远程服务器获取内容的详细信息

> ID：14093270
> 
> 赞同：0
> 
> 时间：2012-12-30T18:16:49.670
> 
> 标签：iphone, ios, cfnetwork

我正在开发一个应用程序，我需要从远程服务器获取目录内容的详细信息（文件名、大小、修改日期）。我将获得目录的 url，例如[http://www.mywebsite.com/myfolder](http://www.mywebsite.com/myfolder)。

我检查了 FTPSample 代码，但它仅适用于 ftp，我想通过 http 进行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T18:21:57.467

这从文件中抓取内容并将其放入 NSData

```
NSString *str=@"http://your_web_server/your_file....";
NSURL *url=[NSURL URLWithString:str];
    NSData *data=[NSData dataWithContentsOfURL:url];
    NSError *error=nil;
    id *response=[NSJSONSerialization JSONObjectWithData:data options:
                            NSJSONReadingMutableContainers error:&error]; 

NSLog("Your JSON Object: %@ Or Error is: %@, response, error); 
```

基本上：`initWithContentsOfURL`或者`dataWithContentsOfURL`是你正在寻找的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T19:23:10.700

我认为如果您的网站允许来自公共在线用户的网页浏览操作，您只需使用 HTTP 访问网址，但据我所知，一个好的网站不允许在线用户这样做，所以，您必须编写一个网络服务或只是一个 PHP 代码文件，它从目录中获取文件列表并将文件信息作为 xml 响应（或您喜欢的 json）返回，然后您的 iOS 应用程序可以获取 xml 并解析它以获取文件信息，这应该是最好的解决方案如果您希望网站稳定，您的网站

# ruby-on-rails - 防止 CKEditor 过滤 Radiant 标签（无效的 HTML 标签）

> ID：14093272
> 
> 赞同：0
> 
> 时间：2012-12-30T18:17:09.417
> 
> 标签：ruby-on-rails, ckeditor, radiant

我将CKEditor与refinerycms（rails CMS）一起使用我还添加了对[半径标签](https://github.com/jlong/radius)的基本支持（它们是Radiant中使用的标签，另一个rails CMS）所以我可以在页面中列出模型中的一些元素插入代码。问题是半径标签模仿html：

```
<r:product_listing category="products" list_as="grid"/> 
```

当使用 CKEditor 修改页面内容时，它认为半径标签是无效的 HTML，这是正确的和预期的行为，但我找不到告诉 CKEditor 忽略这些标签的方法。

有任何想法吗？

提前致谢

编辑：原来标签正在被RefineryCMS调用的rails中的[sanitize方法过滤。](http://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T21:12:29.563

自定义标签有哪些问题？在哪些浏览器上？

我检查了 CKEditor 保留了这个标签，但是用它包装了整个内容。为避免这种情况，您必须编辑[`CKEDITOR.dtd`](http://docs.ckeditor.com/#!/api/CKEDITOR.dtd)，即：

```
CKEDITOR.dtd.$empty[ 'r:product_listing' ] = 1; 
```

但这可能还不够。为了获得更好的支持，您需要对此对象进行更多更改 - 特别重要的是定义可以是其父对象以及它是内联标记。例如：

```
CKEDITOR.dtd.p[ 'r:product_listing' ] = 1; // it is allowed in <p> tag
CKEDITOR.dtd.$inline[ 'r:product_listing' ] = 1; 
```

这可能还不够——例如，您很可能没有复制和粘贴支持。

因此，如果您需要更可靠的支持，我会尝试一些不同的方式。使用[CKEDITOR.dataProcessor](http://docs.ckeditor.com/#!/api/CKEDITOR.dataProcessor)，您可以在将数据加载到编辑器中并在检索数据时将其转换回该标签时将此标签转换为正常标签。

示例解决方案：

```
// We still need this, because this tag has to be parsed correctly.
CKEDITOR.dtd.p[ 'r:product_listing' ] = 1;
CKEDITOR.dtd.$inline[ 'r:product_listing' ] = 1;
CKEDITOR.dtd.$empty[ 'r:product_listing' ] = 1;

CKEDITOR.replace( 'editor1', {
    on: {
        instanceReady: function( evt ) {
            var editor = evt.editor;

            // Add filter for html->data transformation.
            editor.dataProcessor.dataFilter.addRules( {
                elements: {
                    'r:product_listing': function( element ) {
                        // Span isn't self closing element - change that.
                        element.isEmpty = false;
                        // Save original element name in data-saved-name attribute.
                        element.attributes[ 'data-saved-name' ] = element.name;
                        // Change name to span.
                        element.name = 'span';
                        // Push zero width space, because empty span would be removed.
                        element.children.push( new CKEDITOR.htmlParser.text( '\u200b' ) );
                    }
                }
            } );

            // Add filter for data->html transformation.
            editor.dataProcessor.htmlFilter.addRules( {
                elements: {
                    span: function( element ) {
                        // Restore everything.
                        if ( element.attributes[ 'data-saved-name' ] ) {
                            element.isEmpty = true;
                            element.children = [];
                            element.name = element.attributes[ 'data-saved-name' ];
                            delete element.attributes[ 'data-saved-name' ]
                        }
                    }
                }
            } );
        }
    }
} ); 
```

现在`r:product_listing`元素将被转换为跨度，其内部具有零宽度空间。在编辑器内部会有一个正常的跨度，但在源模式和通过`editor#getData()`方法获取的数据中，您会看到原始`r:product_listing`标签。

我认为这个解决方案应该是最安全的。例如复制和粘贴作品。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-02T10:07:28.100

您也可以添加为受保护的源，因此不会进行过滤或解析。

```
config.protectedSource.push(/<r:product_listing[\s\S]*?\/>/g); 
```

只需将这些行添加到您的 config.js（[\s\S]*? 用于任何随机内容）
查看[http://docs.ckeditor.com/#!/api/CKEDITOR.config-cfg-protectedSource](http://docs.ckeditor.com/#!/api/CKEDITOR.config-cfg-protectedSource)

# c# - 带螺纹闭合的套接字

> ID：14093273
> 
> 赞同：1
> 
> 时间：2012-12-30T18:17:18.460
> 
> 标签：c#, .net, winforms, sockets

我正在创建一个由套接字和线程管理的客户端/服务器应用程序。我想知道如何正确关闭套接字和相关线程。这是我的代码：

```
protected override void OnFormClosing(FormClosingEventArgs e)
{
    base.OnFormClosing(e);

    try
    {
        if (UserList.Count > 0)
        {
            foreach (User user in UserList)
            {
                Socket socketUser = user.getSocket();
                socketUser.Send(Encoding.ASCII.GetBytes("!close"));
                socketUser.Close();
            }
        }
        thrAccept.Abort();
        thrReceive.Abort();
        socket.Close();
        incoming.Close();

        Application.Exit();
    }
    catch
    {
        MessageBox.Show("aasa");
    }
}

private void connectBtn_Click(object sender, EventArgs e)
{
    string port=portNum.Text;
    string welcome = "Server up and running - " + System.DateTime.Now.GetDateTimeFormats()[0] + "  " + DateTime.Now.ToString("HH:mm") + "\n" + "Listening Port: " + port + "\n";
    socket.Bind(new IPEndPoint(IPAddress.Any, Convert.ToInt32(portNum.Text)));
    socket.Listen(3);

    thrAccept = new Thread(new ThreadStart(Accept));
    serverLog.AppendText(welcome + "\n");
    thrAccept.Start();
    connectBtn.Enabled = false;
}

private void Accept()
{
    while (true)
    {
        incoming = socket.Accept();
        thrReceive = new Thread(new ThreadStart(Receive));
        thrReceive.Start();
    }
}

private void Receive()
{
    User user = new User();//create an istance for the class User

    while (true)
    {
        byte[] buffer = new byte[64];
        incoming.Receive(buffer);
        // the program continue.... 
```

如何正确关闭套接字？

类用户

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Net.Sockets;
using System.Threading;

namespace HW2_SERVER
{
    class User
    {
        public string username;
        public Socket S;
        public string role;
        public bool managed;
        public User()
        {
            username = "";
            S = null;
            role = "";
            managed = false;

        }

        public void setManage(bool i)
        {
            managed = i;
        }
        public void setUsername(string u)
        {
            username = u;
        }
        public void setSocket(Socket sock)
        {
            S = sock;
        }
        public void setRole(string r)
        {
            role = r;
        }
        public bool getManaged()
        {
            return managed;
        }
        public string getUsername()
        {
            return username;

        }
        public Socket getSocket()
        {
            return S;
        }
        public string getRole()
        {
            return role;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:54:40.690

您似乎正在覆盖您对`socket`and的引用`incoming`。我假设这些是课堂上的字段。我认为您需要保留这些对象的集合，并在关闭时关闭所有这些对象。

此外，中止线程是一个坏主意，因为您不知道线程在中止时正在执行什么操作。通过设置标志并在循环中检查它来进行正常关闭被认为是一种更好的做法。这可能是您异常的原因。我建议您不要中止线程，而是找到一种适当的方法来关闭所有内容。通过这种方式，您更有可能找到一条没有错误的路径。

我会`while (true)`用`while (_isRunning)`. 将其设置为具有公共值的类上的字段。当您关闭时，将其设置为 false 并且线程将正常退出。

# html - 单击html中下拉菜单的任何选项时如何在同一选项卡中打开新页面

> ID：14093275
> 
> 赞同：1
> 
> 时间：2012-12-30T18:17:42.653
> 
> 标签：html

我有一个下拉列表。我在每个选项中都有链接，当用户更改选项时，我想在同一个选项卡中打开新页面。但此处页面在新标签中打开。

```
<html>
   <body>
      <form name="opennew">
         <select name="sites" id="sites">
            <option value="" selected>Select Site</option>
            <option value="http://www.yahoo.com">Yahoo!!!</option>
            <option value="http://www.gmail.com">Gmail</option>
            <option value="http://www.google.co.in">Google</option>
            <option value="http://www.facebook.com">Facebook</option>
         </select>

         <input type="button" name="Submit" value="Go!" onClick="window.open(sites.value)">
      </form>
   </body>
</html> 
```

**[现场演示](http://jsfiddle.net/ChU8G/)**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:30:50.957

`_parent`像这样添加`onClick`：

```
onClick="window.open(sites.value, '_parent')" 
```

所选站点将在同一窗口/选项卡的父框架中打开。

**[现场演示](http://jsfiddle.net/vule/p4W6v/)**

# c# - .NET Framework 4 中是否包含任务？

> ID：14093276
> 
> 赞同：0
> 
> 时间：2012-12-30T18:17:43.810
> 
> 标签：c#, .net, .net-4.0

我遇到了使用 .NET Framework 4.5（带有异步和等待）的任务，我需要知道它们是否是标准 .NET Framework 4 的一部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:37:02.367

[`Task`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task%28v=vs.100%29.aspx)和相关的类在.Net 4 中可用。Async 和await 是C# 5 的一部分，它们依赖于`Task`直到.Net 4.5 才定义的方法（例如GetAwaiter）。如果您使用[Async 目标包](http://www.microsoft.com/en-gb/download/details.aspx?id=29576)和 C# 5 编译器，则可以在目标 .Net 4 时使用 async/await。

# ascii - 在现代编程中使用 ASCII 分隔符 (29-31)

> ID：14093281
> 
> 赞同：7
> 
> 时间：2012-12-30T18:17:57.447
> 
> 标签：ascii

我目前正在构建一个哈希键字符串（从地图中折叠），其中的值由特殊的 ASCII 单元分隔符 31 (1F) 分隔。

这很好地解决了试图猜测哪些 ASCII 字符不会在字符串值中使用的问题，我不需要担心转义或引用值等。

然而，阅读它的历史似乎是 1960 年代的遗物，我还没有看到很多使用这个特殊字符构建和标记字符串的例子，所以这一切似乎都太容易了。

在现代应用程序中使用此分隔符是否有任何问题？

*我目前正在一个非 Unicode C++ 应用程序中执行此操作，但是我很想知道这通常如何应用于其他语言，例如 Java、C# 和 Unicode。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T18:27:02.090

ASCII 的低 128 个字符映射完全固定在 Unicode 标准中，包括字符 0->31。您没有经常在字符串中看到特殊 ASCII 字符的唯一原因仅仅是因为人机接口的限制：当显示到屏幕或写入文件时，它们不能很好地可视化（如果有的话），而且您不能轻易也可以从键盘输入它们。它们也不允许在各种流行的“人类可读”文件格式中以未转义的形式出现，例如 XML。

但是，对于程序中不需要最终用户交互的逻辑处理任务，它们非常适合您可以找到的任何用途。您的特殊用途听起来新颖而有效，我认为您绝对应该使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T18:22:03.900

您的应用程序可以自由地接受它喜欢的任何二进制格式。但是，如果您需要在输入中嵌入任意二进制数据，则需要转义格式使用的任何分隔符或其他特殊代码。无论您选择哪个，这都是正确的。

我也不会忽略 Unicode。现在是 2012 年，现在使用过时的模型来处理文本是相当愚蠢的。如果您的输入数据是文本的，请照此处理。

想到的一个问题是为什么要发明另一种格式而不是使用 XML 或 JSON？或者，如果您需要紧凑的编码，这两者的“二进制”变体（Fast Infoset，msgpack，谁知道还有什么），或者 ASN.1？在推出自己的产品时，您可能会遇到很多其他问题，而这些格式的设计和工具已经解决了。

# spring - 尝试使用 Spring Security + Spring MVC 进行身份验证时重定向到身份验证失败 url

> ID：14093290
> 
> 赞同：0
> 
> 时间：2012-12-30T18:18:27.143
> 
> 标签：spring, spring-mvc, spring-security

我在实现 Spring Security 以及 Spring MVC 和 Hibernate 时遇到了麻烦。

当我提供凭据并验证表单时，它会转到以下 URL： http://localhost:8080/test/login_error.htm;jsessionid=9BE14BCXXXXXXXXXXXXXXXX 所以它会将我重定向到我在我的配置中配置的 login_error.htm 页面弹簧安全.xml。看起来已经创建了一个会话，因此之后会出现问题。

我确实尝试调试以了解更多信息，这是交易：

由于在 spring-security.xml 中将 UserDetailsS​​ervice 配置为我的 authenticationProvider，因此它进入了 UserDetailsS​​erviceImpl 类中的 findByUserName 方法：

```
public UserDetails loadUserByUsername(String username)

    throws UsernameNotFoundException, DataAccessException {

        UserEntity userEntity = dao.findByName(username);

        if (userEntity == null)
            throw new UsernameNotFoundException("user not found");

        return (UserDetails)assembler.buildUserFromUserEntity(userEntity);

    } 
```

当它返回时，用户已正确加载，因此已建立与数据库的连接并且已找到用户，那一侧没有问题。我无法弄清楚问题出在哪里。

这是我正在使用的 UserEntityDAOImpl 类：

```
@Repository("userEntityDao")
public class UserEntityDAOImpl implements UserEntityDAO {

    private SessionFactory sessionFactory;

    @Autowired
    public void setSessionFactory(SessionFactory sessionFactory) {
        this.sessionFactory = sessionFactory;
    }

    public void addUser(UserEntity user) {
        sessionFactory.getCurrentSession().save(user);
    }

    public UserEntity findByName(String username) {
        Session session = sessionFactory.getCurrentSession();
        UserEntity user = (UserEntity)session.createQuery("select u from UserEntity u where u.username = '" + username + "'").uniqueResult();
        return user;
    }

...others methods like activate, listUsers, etc... 
```

**编辑：**

```
@Service("assembler")
public class Assembler {

    @Transactional(readOnly = true)
    User buildUserFromUserEntity(UserEntity userEntity) {

        String username = userEntity.getUsername();
        String password = userEntity.getPassword();
        boolean enabled = userEntity.getActive();
        boolean accountNonExpired = userEntity.getActive();
        boolean credentialsNonExpired = userEntity.getActive();
        boolean accountNonLocked = userEntity.getActive();

        Collection<SimpleGrantedAuthority> authorities = new ArrayList<SimpleGrantedAuthority>();

        for (SecurityRoleEntity role : userEntity.getSecurityRoleCollection()) {
            authorities.add(new SimpleGrantedAuthority(role.getName()));
        }

        User user = new User(username, password, enabled,
        accountNonExpired, credentialsNonExpired, accountNonLocked, authorities);
        return user;

    }

} 
```

它正在从数据库中正确检索角色（在我的情况下为 ROLE_Admin）。

这是我的spring-security.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
    xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
                        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                        http://www.springframework.org/schema/context 
                        http://www.springframework.org/schema/context/spring-context-3.0.xsd
                        http://www.springframework.org/schema/security 
                        http://www.springframework.org/schema/security/spring-security-3.1.xsd">

    <http pattern="/resources/**" security="none"/>
    <http auto-config='true' use-expressions='true'>
        <intercept-url pattern="/login*" access="isAnonymous()" />
        <intercept-url pattern="/secure/**" access="hasRole('ROLE_Admin')" />

        <logout logout-success-url="/home.htm" />

        <form-login login-page="/login.htm" login-processing-url="/j_spring_security_check"
            authentication-failure-url="/login_error.htm" default-target-url="/home.htm"
            always-use-default-target="true" />
    </http>

    <beans:bean id="com.daoAuthenticationProvider"
        class="org.springframework.security.authentication.dao.DaoAuthenticationProvider">
        <beans:property name="userDetailsService" ref="userDetailsService" />
    </beans:bean>

    <beans:bean id="authenticationManager"
        class="org.springframework.security.authentication.ProviderManager">
        <beans:property name="providers">
            <beans:list>
                <beans:ref local="com.daoAuthenticationProvider" />
            </beans:list>
        </beans:property>
    </beans:bean>

    <authentication-manager>
        <authentication-provider user-service-ref="userDetailsService">
            <password-encoder hash="plaintext" />
        </authentication-provider>
    </authentication-manager>
</beans:beans> 
```

这是 web.xml：

```
<web-app id="WebApp_ID" version="2.4"
    xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee 
    http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">

    <display-name>Spring MVC Application</display-name>

    <!-- Spring MVC -->
    <servlet>
        <servlet-name>mvc-dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>mvc-dispatcher</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>

</servlet> -->

    <!-- This listener creates the root application Context -->
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
    <listener>
        <listener-class>org.springframework.web.context.request.RequestContextListener</listener-class>
    </listener>

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/applicationContext.xml
            /WEB-INF/spring-security.xml
        </param-value>
    </context-param>

    <!-- Spring Security -->
    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

</web-app> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T20:13:07.743

我怀疑您的用户没有设置所需的权限（即`Authorities`）。启用[Spring Security 调试日志记录](http://static.springsource.org/spring-security/site/petclinic-tutorial.html)。做什么

```
assembler.buildUserFromUserEntity(userEntity); 
```

做？如果在将`loadUserByUsername`打印返回`UserDetails-getAuthorities()`到控制台之前的方法中，您会看到什么？

# ruby-on-rails-3 - 工厂女孩嵌套工厂

> ID：14093293
> 
> 赞同：13
> 
> 时间：2012-12-30T18:19:13.430
> 
> 标签：ruby-on-rails-3, factory-bot

我有一个属于角色模型的帐户模型。

```
factory :role do
  name "student"
end

factory :account do
  user
  role
end 
```

第一个工厂创建了一个名为“student”的角色。第二个工厂创建一个帐户，该帐户与在前一个工厂中创建的学生角色相关联。它还与用户相关联......这对于这个问题并不重要。

我有很多要测试的角色（管理员、学生、助理）......我不想在角色工厂中指定“学生”......那太静态了。如何在创建帐户工厂时指定要创建的角色？像：

```
 factory :account do
    user
    role_id { factory :role { name: "admin"} }
  end 
```

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-30T18:32:29.240

如果你想要一个纯粹的 FG 解决方案，你可以使用 Traits：

```
factory :account do
  user

  trait :student do
    association :role, :name => "student"
  end

  trait :admin do
    association :role, :name => "admin"
  end
end

FactoryGirl.create :account, :student
FactoryGirl.create :account, :admin 
```

但是，您可以在创建工厂对象时覆盖工厂的属性。这允许更大的灵活性：

```
FactoryGirl.create(:account,
  :role => FactoryGirl.create(:role, :name => "student")
) 
```

由于这显然很冗长，我将创建一个小辅助方法：

```
def account_as(role, options = {})
  FactoryGirl.create(:account,
    options.merge(:role => FactoryGirl.create(:role, :name => "student"))
  )
end 
```

然后在你的测试中：

```
let(:account) { account_as "student" } 
```

或者，你可以缩短你的角色生成器，这样你就可以像这样使用它：

```
def role(role, options = {})
  FactoryGirl.create :role, options.merge(:name => role)
end

account = FactoryGirl.create :account, :role => role("student") 
```

# android-ndk - 我的 OpenCV 开发库安装在哪里？

> ID：14093294
> 
> 赞同：1
> 
> 时间：2012-12-30T18:19:17.790
> 
> 标签：android-ndk

我正在使用 Open Cv 配置 CDT，但我不知道打开的 cv 包含库在哪里，当我打开 c++ 项目属性并转到设置然后工具设置时，它需要包含库但我不知道哪个路径我应该为开放的 cv 包含库

# .htaccess - 使用 .htaccess 对用户隐藏目录内容？

> ID：14093301
> 
> 赞同：-1
> 
> 时间：2012-12-30T18:20:06.847
> 
> 标签：.htaccess

如何隐藏整个目录，包括其中的所有文件和文件夹，使其不被列出。我想给出 404，而不是“403 Forbidden”。我可以在不使用 的情况下显示默认的 404 消息`errorDocument`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:21:20.277

在`.htaccess`所需目录中的 a 中：

```
Order Deny,Allow
Deny from all
Allow from 127.0.0.1 
```

它提供 403，但您可以像处理 404 一样处理它。

（不要忘记授予本地访问权限 ( `127.0.0.1`)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T18:25:42.560

在 .htaccess 文件中使用 DirectoryIndex 语句可能是个好主意。

这使您可以在访问时显示所需的任何文件：

```
 DirectoryIndex /404.php 
```

每当有人尝试列出目录内容时，这将在 404.php 处显示页面。

# java - 创建画布的 Java 挑战

> ID：14093303
> 
> 赞同：0
> 
> 时间：2012-12-30T18:20:31.213
> 
> 标签：java, graphics, java-canvas

这大概是个初级问题。但是，我已经阅读了面向绝对初学者的 Java 编程的第 9 章，并进入了挑战部分。我不太明白这个问题。

问题问：

```
"Create a Canvas that paints a gradient that’s dark on one side and slowly
gets lighter as it moves to the other side." 
```

这可能是有用的信息：在这个挑战问题之前，“梯度”这个词没有出现在代码方法或文本中。我还没有学到任何关于动画的知识，因为问题是“移动到另一边”。

这个问题的答案可能有助于许多新的 Java 程序员理解图形和画布。

我不想要编码答案（除非必要），只是用更基本的术语解释这个问题以及我必须采取的程序。非常感谢您在此问题上的时间和合作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T18:25:45.223

“渐变”是指[颜色渐变](http://en.wikipedia.org/wiki/Color_gradient)，即在二维区域中从一种颜色逐渐过渡到另一种颜色。

当他们说“慢慢地”和“随着它移动”时，他们不是指动画；图像本身将是静态的。您可以将其视为意味着，如果您的*眼睛*从该区域的一侧移到另一侧，您会慢慢看到颜色从暗变为亮。

也就是说——他们想要这样的东西：

![渐变，一侧暗，另一侧亮](../Images/e40f9f33b7fb97d2b531bf5a438b013c.png)

# css - 如何使用css创建带有水平子菜单的嵌套垂直菜单

> ID：14093304
> 
> 赞同：3
> 
> 时间：2012-12-30T18:20:38.457
> 
> 标签：css, menu

我想将列表更改为垂直，但是在更改了很多 css 代码之后，应该水平的内部列表变为垂直，我找不到原因。

```
nav ul ul { display: none;}

nav ul li:hover > ul {  display: block; }

nav ul {
    background: #efefef; 
    background: linear-gradient(top, #efefef 0%, #bbbbbb 100%);  
    background: -moz-linear-gradient(top, #efefef 0%, #bbbbbb 100%); 
    background: -webkit-linear-gradient(top, #efefef 0%,#bbbbbb 100%); 
    box-shadow: 0px 0px 9px rgba(0,0,0,0.15);
    padding: 0 20px;
    border-radius: 10px;  
    list-style: none;
    position: relative;
    display:list-item;
    }
    nav ul:after {
        content: ""; clear: both; display: block;
    }
    nav ul li {
    float: left;
}

nav ul li:hover {
    background: #4b545f;
    background: linear-gradient(top, #4f5964 0%, #5f6975 40%);
    background: -moz-linear-gradient(top, #4f5964 0%, #5f6975 40%);
    background: -webkit-linear-gradient(top, #4f5964 0%,#5f6975 40%);
}

nav ul li:hover a {
    color: #fff;
}

nav ul li a {
    display: block; padding: 25px 40px;
    color: #757575; text-decoration: none;
}

nav ul ul {
    background: #5f6975; border-radius: 0px; padding: 0;
    position: absolute; top: 100%;
}

nav ul ul li {
    display:list-item;
    float: right; 
    border-top: 1px solid #6b727c;
    border-bottom: 1px solid #575f6a;
    position: relative;
}

nav ul ul li a {
    padding: 15px 40px;
    color: #fff;
}   

nav ul ul li a:hover {
    background: #4b545f;
}

nav ul ul ul {
    position: absolute; left: 100%; top:0;
} 
```

这是 html 标记：

```
<nav>
    <ul>
        <li>
            <a href="Documents.php">Products</a>
            <ul>
                <li><a href="Documents.php?cat=Political">Books</a></li>
                <li><a href="Documents.php?cat=History">Magazines</a></li>
                <li><a href="Documents.php?cat=Culture">MusicCd's</a></li>
            </ul>
        </li>
        <li><a href="html/about.html">ABOUT</a></li>
        <li><a href="html/contact.html">CONTACT</a></li>
    </ul>
</nav> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T18:28:06.063

因此，您希望父菜单项垂直定位（彼此向下），嵌套子菜单水平定位（彼此向左）。

假设这是我们的 html 标记：

```
<nav>
    <ul>
        <li>Parent 1
            <ul>
                <li>Child 1</li>
                <li>Child 2</li>
                <li>Child 3</li>
            </ul>
        </li>
        <li>Parent 2
            <ul>
                <li>Child 4</li>
                <li>Child 5</li>
                <li>Child 6</li>
            </ul>
        </li>
    </ul>
</nav>​ 
```

定位父菜单项，我们只是告诉他们`clear`他们的`left`. 所以没有元素可以浮动到它们的右边：

```
nav > ul > li {
    clear: left;
} 
```

（还请注意，我们使用`>`了[Child 组合](http://www.w3.org/TR/selectors/#child-combinators)器来仅指定父菜单项。所以这种样式不会影响 inner `li`s。只有 parent `li`s 才能获得该 css 属性。）

然后我们隐藏子菜单项，让它们只在鼠标悬停时出现：

```
nav > ul > li ul {
    display: none;   
}

nav > ul > li:hover ul {
    display: block;
} 
```

最后一件事是告诉子菜单项向左浮动并显示为内联元素。所以这样我们就得到了想要的水平方向的子菜单项。

```
nav > ul > li ul li {
    float: left;
    display: inline-block;
}​ 
```

在这里，我们来到了相对于父级定位子菜单的棘手部分。为此，我们`absolute`为孩子使用定位并`position:relative`为他们的父母设置，所以孩子相对于这个父母而不是作为`body`元素的全局父母定位

```
nav > ul > li {
    position: relative;
}

nav > ul > li ul {
    position: absolute;
    left: 100px;
    top: 0;
} 
```

这是一个工作演示： http: [//jsfiddle.net/VCX7T/6/](http://jsfiddle.net/VCX7T/6/)这是完整的 CSS 代码：

```
nav > ul > li {
    clear: left;
    position: relative;
}

nav > ul > li ul {
     display: none;   
}

nav > ul > li:hover ul {
    display: block;
}

nav > ul > li ul {
    position: absolute;
    left: 100px;
    top: 0;
}

nav > ul > li ul li {
    float: left;
    display: inline-block;
}​ 
```

# php - 按字段值排序 mysql 结果

> ID：14093305
> 
> 赞同：0
> 
> 时间：2012-12-30T18:20:40.653
> 
> 标签：php, mysql

我试图按 X 列名的顺序从我的查询中过滤我的结果...

我有以下...

```
$sth = $conn->prepare("SELECT * FROM directory
                        WHERE user_active != '' 
                          AND County = :county 
                       ORDER BY' . $row['Date'] .'" ); 
```

我想获取所有结果并从日期列中的值排序，这存储为 XX/XX/XXXX

谁能看到我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:22:13.907

是什么`$row['Date']`？您只能按列名或列索引（1、2、3，...）排序

```
$sth = $conn->prepare("SELECT * FROM directory WHERE user_active != '' AND County = :county ORDER BY date" ); 
```

此外，您的查询遗漏了 ORDER BY 后面的空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T20:07:42.110

必须按特定字段值排序`FIELD( )`

在你的例子中

```
 $sth = $conn->prepare("SELECT * FROM directory
                    WHERE user_active != '' 
                      AND County = :county 
                   ORDER BY FIELD( date , '.$row['Date'].')   " ); 
                                     ^---------------------------------column name    
                                                  ^^-------------------field value 
```

[在这里举例](http://www.electrictoolbox.com/mysql-order-specific-field-values/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T18:25:46.613

像这样试试

```
$sth = $conn->prepare
        ("SELECT 
            * 
        FROM directory 
        WHERE user_active != '' 
        AND County = :county 
        ORDER BY '.$row['Date'].'

        DATE_FORMAT('$row['Date']','%m-%d-%Y'"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T18:24:39.807

Gordon 和 AmShegar 都为您提供了关于为什么这不起作用的线索。

要按日期排序结果，只需执行以下操作：

```
SELECT <fields>
FROM <table>
ORDER BY <datefield> 
```

并且您可以使用“ASC”或“DESC”作为后缀，具体取决于您想要较旧的日期还是较新的日期。这一切都假设日期字段实际上是一个日期字段。

# jquery - 在 jquery 对话框中显示 ASP MVC 视图

> ID：14093306
> 
> 赞同：3
> 
> 时间：2012-12-30T18:21:16.580
> 
> 标签：jquery, asp.net, asp.net-mvc, jquery-ui-dialog

我有一个 ASP.NET MVC 视图并希望在 jquery 对话框窗口中显示详细视图。最后，我的目标是在 jquery 数据表中显示一些链接以修改/删除或仅显示行项目的详细信息。

但基本上我试图显示没有任何表格的对话框，但它不起作用。我收到以下 javascript 错误：TypeError: $(...).dialog is not a function

以下是我观点的内容：

```
@model IList<CarRentalService.Core.DomainObjects.Car>

@{
ViewBag.Title = "Overview of existing Cars";
Layout = "~/Views/Shared/_LayoutPartially.cshtml";
}

@section PageScripts{

<script type="text/javascript">

    $(document).ready(function() {
        var carsTable = $('#CarsTable').dataTable(
            {
                "aoColumns": [
                    { "sWidth": "10%" }, // ID
                    { "sWidth": "20%" }, // Kennzeichen
                    { "sWidth": "15%" }, // Marke
                    { "sWidth": "15%" }, // Leistung
                    { "sWidth": "15%" }, // Marke
                    { "sWidth": "15%" }, // Sacharbeiter
                    { "sWidth": "10%" } // For later usage of buttons 
                ]
            });
    });

    function openProductDetailsDialog(id) {
        $.ajax({
            type: "GET",
            url: encodeURI('@Url.Action("EditCar", "Staffer")' + "?id=" + id),
            cache: false,
            dataType: 'html',
            error: function(XMLHttpRequest, textStatus, errorThrown) {
                $("#CarsDetailsDialogDiv").html(errorThrown);
            },

            success: function(data, textStatus, XMLHttpRequest) {
                $("#CarsDetailsDialogDiv").html(data);
            },

            complete: function(XMLHttpRequest, textStatus) {

                $('#CarsDetailsDialogDiv').dialog({
                    modal: true,
                    width: "300px"/*,
                    close: function(event, ui) { $("#ProductDetailsDialogDiv").html(""); },
                    buttons: {
                        "Ok": function() { $(this).dialog("close"); }
                    }*/
                });
            }
        });
    }

</script>
}

<h2>@ViewBag.Title</h2>
<h2>@ViewBag.Messsage</h2>
<a href="javascript:openProductDetailsDialog(1);">Edit car</a>

<div class="carsTableContainer">
<table id="CarsTable" class="carTable">
    <thead>
        <tr>
            <th class="id">
                Id
            </th>
            <th class="registration">
                Kennzeichen
            </th>
            <th class="trademark">
                Marke
            </th>
            <th class="modell">
                Modell
            </th>
            <th class="enginepower">
                Leistung
            </th>
            <th class="staffer">
                Sacharbeiter
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @{
            if (Model != null)
            {
                foreach (var item in Model)
                {
                    <tr>
                        <td>
                            @item.Id
                        </td>
                        <td>
                            @item.Registration
                        </td>
                        <td>
                            @item.Trademark
                        </td>
                        <td>
                            @item.Modell
                        </td>
                        <td>
                            @item.EnginePower
                        </td>
                        <td>
                            @item.Responsible.Username
                        </td>
                        <td>

                        </td>
                    </tr>
                }
            }
        }
    </tbody>
</table>

</div>

<div class="dummy">

</div>

<div id="CarsDetailsDialogDiv" title="Product details">
</div> 
```

我在网上找到了很多处理这个问题的线索——但对我没有任何帮助，所以我请求你在这个主题上提供一些帮助。

因为我发现的一些解决方案是包含错误的 javascript 库，这里是从 mvc 生成的呈现 html 的列表：

```
<link href="/Content/site.css" rel="stylesheet"/>
<link href="/Content/demo_table.css" rel="stylesheet"/>
<script src="/Scripts/modernizr-2.5.3.js"></script>
<script src="/Scripts/jquery-1.7.1.js"></script>
<script src="/Scripts/jquery.dataTables.js"></script>
<script src="/Scripts/jquery.unobtrusive-ajax.js"></script>
<script src="/Scripts/jquery.validate.js"></script>
<script src="/Scripts/jquery.validate.unobtrusive.js"></script>
<script src="/Scripts/jquery-ui-1.8.20.js"></script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T20:56:49.880

您是否尝试过初始化对话框`$(document).ready(function()` 然后调用`$("#CarsDetailsDialogDiv").dialog("open");`

```
$(document).ready(function() {
    $('#CarsDetailsDialogDiv').dialog({
                modal: true,
                width: "300px",
                autoOpen: false
     });
});

function openProductDetailsDialog(id) {
    $.ajax({
        type: "GET",
        url: encodeURI('@Url.Action("EditCar", "Staffer")' + "?id=" + id),
        cache: false,
        dataType: 'html',
        error: function(XMLHttpRequest, textStatus, errorThrown) {
            $("#CarsDetailsDialogDiv").html(errorThrown);
        },

        success: function(data, textStatus, XMLHttpRequest) {
            $("#CarsDetailsDialogDiv").html(data);
        },

        complete: function(XMLHttpRequest, textStatus) {
            $("#CarsDetailsDialogDiv").dialog("open");
        }
    });
} 
```

# c# - EF 框架中每个用户的不同数据集的设计模板

> ID：14093315
> 
> 赞同：1
> 
> 时间：2012-12-30T18:22:23.673
> 
> 标签：c#, database-design

我的问题是关于最佳实践。我正在开发一个 Web 服务，它将承载大约 500 个用户。每个用户只需要自己的数据，但所有数据都具有相同的结构。使用 EFM（模型优先，但可以更改为代码优先）、c#、Visual Studio、Web 服务、用于托管的 IIS）

我该如何设置？我能想象：

1.  每个用户一个数据库 - 似乎过多，需要找到一个支持他的主机
2.  用不同的用户登录到数据库......但这本身并不能屏蔽数据。
3.  对数据库中的用户进行建模（将所有项目链接到用户），并按用户过滤每个请求

3似乎是最可行的。这将需要我改变很多我的方法

*   还有其他更好的解决方案吗？
*   有没有一种简单的方法可以将此用户过滤器应用于表格的所有横截面？（我的意思是每个请求都将被“自动”过滤以仅返回发出请求的用户所拥有的项目）。

# php - 为什么使用 $_SERVER['PHP_SELF'] 而不是 ""

> ID：14093316
> 
> 赞同：43
> 
> 时间：2012-12-30T18:22:23.917
> 
> 标签：php, forms

在 PHP 页面上的表单中，您可以使用：

```
<form action="<?php echo $_SERVER['PHP_SELF']; ?>" ...> 
```

或者

```
<form action="#" ...> 
```

或者

```
<form action="" ...> 
```

在表单的 action 属性中。既然 echo`$_SERVER['PHP_SELF']`不传递变量来使用`GET`并且你必须使用`""`，你为什么要使用它`"#"`？

我问是因为我花了一些时间才弄清楚变量没有通过`$_SERVER['PHP_SELF']`. 谢谢。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-12-30T18:26:46.210

该`action`属性将默认为当前 URL。这是说“将表单提交到它来自的同一个地方”的最可靠和最简单的方式。

没有理由使用`$_SERVER['PHP_SELF']`，并且`#`根本不提交表单（除非`submit`附加了处理提交的事件处理程序）。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-12-30T18:27:40.573

使用空字符串非常好，实际上比简单地使用`$_SERVER['PHP_SELF']`.

使用`$_SERVER['PHP_SELF']`时很容易通过在 URL 部分`/<script>...`后附加来注入恶意数据，`whatever.php`因此您不应使用此方法并停止使用任何建议的 PHP 教程。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2014-09-06T18:03:04.983

当您将**ANY**变量插入 HTML 时，除非您希望浏览器将变量本身解释为 HTML，否则最好`htmlspecialchars()`在其上使用。除此之外，它还可以防止黑客在您的页面中插入任意 HTML。

的值`$_SERVER['PHP_SELF']`直接取自在浏览器中输入的 URL。因此，如果您不使用`htmlspecialchars()`.

例如，如果我通过电子邮件向您发送一个链接`http://example.com/"><script>malicious_code_here()</script><span class="`并且您拥有`<form action="<?php echo $_SERVER['PHP_SELF'] ?>">`，则输出将是：

```
<form action="http://example.com/"><script>malicious_code_here()</script><span class=""> 
```

我的脚本将运行，而您将一无所获。如果您已登录，我可能已经窃取了您的 cookie，或者从您的页面上抓取了机密信息。

但是，如果您使用`<form action="<?php echo htmlspecialchars($_SERVER['PHP_SELF']) ?>">`，输出将是：

```
<form action="http://example.com/&quot;&gt;&lt;script&gt;cookie_stealing_code()&lt;/script&gt;&lt;span class=&quot;"> 
```

当你提交表单时，你会有一个奇怪的 URL，但至少我的邪恶脚本没有运行。

另一方面，如果您使用`<form action="">`，那么无论我在链接中添加什么，输出都是相同的。这是我推荐的选项。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2015-11-25T13:57:35.537

我知道这个问题已经存在两年了，但这是我正在寻找的第一个结果。我找到了一个很好的答案，我希望我可以帮助其他用户。

[看这个](http://www.w3schools.com/php/php_form_validation.asp)

我将简要介绍一下：

*   将`$_SERVER["PHP_SELF"]`变量与`htmlspecialchars`() 一起使用：

    ```
    `htmlspecialchars($_SERVER["PHP_SELF"]);` 
    ```

*   PHP_SELF 返回当前执行脚本的文件名。

*   ( `htmlspecialchars`) 函数将特殊字符转换为 HTML 实体。--> 没有 XSS

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-25T23:17:48.663

除了上述答案之外，另一种方法是`$_SERVER['PHP_SELF']`或简单地使用空字符串是使用`__DIR__`.
**或者**
如果您使用的是较低的 PHP 版本（<5.3），更常见的替代方法是使用`dirname(__FILE__)`
~~两者都返回上下文中文件的文件夹名称。~~

**编辑**
正如 Boann 指出的那样，这将返回文件的磁盘位置。理想情况下，您不会将其公开为 url。在这种情况下，`dirname($_SERVER['PHP_SELF'])`可以在上下文中返回文件的文件夹名称。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2012-12-30T20:54:34.930

没有区别。$_SERVER['PHP_SELF'] 只是让执行时间慢了 0.000001 秒。

# c - C中的大型二维数组 - Thinbug

> ID：14093318
> 
> 赞同：3
> 
> 时间：2012-12-30T18:22:25.470
> 
> 标签：c, arrays, stack-overflow

我很长时间没有使用 C，并且在从 CSV 填充 2D 数组时遇到了问题。文件格式是这样的：

节点，输入，输出

1,200,10393

...

这本质上是一个链表的数组表示。有 150000 个元素，每当我尝试填充数组时，都会收到一条错误消息，提示“main.exe 中 0x000000013facb957 处的未处理异常：0xC00000FD：堆栈溢出。” 我在具有 16GB RAM 的 64 位机器上，并且正在使用具有 x64 构建配置的 VS C++ 2010 Express。

```
int main(int argc, char *argv[])
{

int counter = 0;
char line [ 1024 ];
int map[150000][2] = {0};
char *comma = ",";
char *token;
int index;
int in, out;
char* end;
int nodeID;
FILE *fp;

fp = fopen("mapsorted.txt","r"); // read mode

if( fp == NULL )
{
  perror("Error while opening the file.\n");
  exit(EXIT_FAILURE);
}

//Skip header line
fgets ( line, sizeof line, fp );

while ( fgets ( line, sizeof line, fp ) != NULL) /* read a line */
{
    //first part - the index for storage
    token = strtok(line,comma);
    index = strtol(token,&end,10);

    //second part
    token = strtok(NULL,comma);
    in = atoi(token);

    //third part
    token = strtok(NULL,comma);
    out = atoi(token);

    //store in array
    map[index][0] = in;
    map[index][1] = out;
}
fclose ( fp );
} 
```

当我分配一个较小的数组时，代码似乎可以工作，但是当它这么大时就失败了。我想我应该有足够的内存来处理这个大小的数组。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T18:29:04.950

```
int map[150000][2]; 
```

似乎至少 2 * 4 * 150000 字节（假设是现代 32 位架构），大约是 1.2MB。知道现代操作系统通常设置几兆字节的堆栈大小，这实际上可能是问题所在。您的计算机拥有数 GB 的 RAM 并不意味着所有这些 RAM 都可以被您的进程使用，尤其是不能在堆栈上。对于大型数组，尝试`malloc()`在堆上吃一些内存：

```
int (*map)[2] = malloc(sizeof(*map) * 150000); 
```

或者

```
int *map = malloc(150000 * 2 * sizeof(*map)); 
```

（注意第二种情况的尺寸！），或者将其声明为`static`将其移出堆栈空间：

```
static int map[150000][2]; 
```

或者干脆让它成为一个全局变量来实现类似的行为：

```
int map[150000][2];

void foo()
{
    ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T18:28:08.160

数组太大而无法放入堆栈。尝试将其移到函数之外：

```
static int map[150000][2] = {0};
int main(int argc, char *argv[])
{ 
```

等等。

# c++ - C++ 消息认证代码生成和指针问题

> ID：14093319
> 
> 赞同：0
> 
> 时间：2012-12-30T18:22:30.273
> 
> 标签：c++, pointers

我正在尝试创建一个基本的 MAC 生成程序。我将很快补充这一点，其中包括教育学。这是我的代码中不起作用的部分：

```
int inputsh(char inf)
{
    char input; 
    if (input == 'h')
    {
        cout << "winnow.ch is a program based off of the steganographic method coined by Ron Rivest.\nThough winnow.ch does not run off of standalone chaffing & winnowing, it runs through a multistep procedure.\nThe first step it takes after chaffing & winnowing the individual bits is to record and encrypt each bit\nvia a geosynchronous algorithm, and stores them personally on your computer so that nobody else may access the\ndata without having the encrypted UNIX timestamps on their hard drive.\nNext, the numbers are smacked into one huge number, and from there encrypted with 256-bit AES\nand stored inside a passcode-protected read-only file system." << endl;
        cout << "If you would like to read more about winnow.ch and its procedure, enter 'h'." << endl; 
        cout << "If you would like to encrypt text, enter 'e'." << endl;
        cout << "If you would like to decrypt text, enter 'd'." << endl;
        cout << "Choice: "; 
        cin >> input; 
        inputsh(input); 
    }
    else if (input == 'e')
    {
        char* string binary;
        binary = gVariable('c', 0);
        cout << "NOTICE: To begin working with winnow.ch, you must first convert ASCII to binary." << endl;
        cout << "Because it is rather tedious to implement this for a simple C++ program, you must use a convertor." << endl;
        cout << "http://bit.ly/bq2yy3 -- this is a tool programmed by Roubaix Interactive that can convert for you." << endl;
        cout << "I, Beau Perkins, do not own Roubaix Interactive, nor the program that was linked above." << endl; 
        cout << "Once you have converted your full text to binary, please paste it here: " << endl;
        cin >> binary; 
        cout << "Storing each bit inside an array..." << endl;
        int i;
        for(i=0;i<=strlen(binary);i++)
        {
            int* bits; 
            char* string binary;
            binary = gVariable('c', 0);
            bits = gVariable('b', strlen(binary)); 
            bits[i] = binary.substr(i, i); 
            cout << "Generating MAC (message authentication code) for bit..." << endl; 
            ofstream outfile ("MAC.txt"); 
            outfile << bits[i] << ":" << rand() % 1000 << endl;
            outfile.close();
        }
    }
} 
```

我转到终端，`g++ main.cpp`然后返回以下错误：

```
main.cpp: In function ‘int gVariable(char, int)’:
main.cpp:20:11: error: invalid conversion from ‘int* (*)[(((unsigned int)(((int)length) + -0x00000000000000001)) + 1)]’ to ‘int’ [-fpermissive]
main.cpp:19:8: warning: address of local variable ‘bits’ returned [enabled by default]
main.cpp:24:16: error: expected initializer before ‘binary’
main.cpp:25:3: error: ‘binary’ was not declared in this scope
main.cpp: In function ‘int inputsh(char)’:
main.cpp:46:16: error: expected initializer before ‘binary’
main.cpp:47:3: error: ‘binary’ was not declared in this scope
main.cpp:59:17: error: expected initializer before ‘binary’ 
```

我试图吞下一些我无法咀嚼的东西，但是，这只是经验。发生了什么？

这是gVariable：

```
int gVariable(char w, int length)
{
    if (w == 'b')
    {
        int* bits[length];
        return &bits;
    }
    if (w == 'c' && length == 0)
    {   
        char* string binary; 
        binary = ""; 
        return &binary;
    }
} 
```

# c# - 使用特定示例了解 C# 中的委托和事件

> ID：14093325
> 
> 赞同：4
> 
> 时间：2012-12-30T18:22:59.253
> 
> 标签：c#, events, delegates

所以我正处于理解事件和代表的地步。

我总体了解代表的用法。关于委托，我唯一担心的是委托是否可以配置为使用与事件无关的函数......**如果可以，我如何为委托定义的函数编写逻辑？**（我想这样的功能并没有多大意义，但很高兴知道。）

至于事件……我很难理解。我认为事件是一个函数，当代码中发生某些事情时会执行该函数。但是，我没有得到创建事件的过程。部分。

对于这个问题，我将使用**Gary Willoughby**的答案：[https](https://stackoverflow.com/a/803528/1104766) ://stackoverflow.com/a/803528/1104766 它发布在我试图理解整个主题的问题上。

我在上面的示例中没有得到什么：
`MyObject.OnMaximum += new MyEventHandler(MaximumReached);`
首先，**如何创建委托的实例，并在需要 2 个变量时只传递 1 个变量？**一定有我遗漏的东西......
关于这一行的第二件事是`new ...()`实例被**添加**到`OnMaximum`驻留在`MyObject`其中的实例的函数中`MyClass`-**如果可以完成这样的事情****到底是什么？`OnMaximum`**它也从未真正定义过！

```
 if(OnMaximum != null) {
        OnMaximum(this, new MyEventArgs("You've entered " +
          value.ToString() +
          ", but the maximum is " +
          Maximum.ToString()));
      } 
```

至于这部分，`OnMaximum`被调用了，但它的逻辑从未在代码中的任何地方真正定义过，那么结果会是什么？显然我猜它会是文本“你已经输入......”但我的问题是更具体地说，**函数/事件接收到的值到底会发生什么?**

为了清楚起见，我用**粗体**标记了所有问题。

PS，我知道这个问题**通常**已经发布了几次。
请注意，此特定问题是指另一位成员撰写的答案，此处提出的问题是针对此示例的。这就是为什么在谷歌中找不到这样的答案。
不过，为了记录，我在发布之前进行了搜索，并且确实尝试理解，但我想示例是我理解某些东西的最佳方式，尤其是在我缺乏英语 CS 词汇知识的情况下。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T18:34:27.310

我认为您可能患有过量的语法糖！

你看，一个事件就是一个代表。实际上，老实说，它可能是代表的集合`null`。

举个例子：

```
public class Alarm
{
    public delegate void AlarmEvent();

    // my secret stuff

    // raise it!
    public void Ring()
    {
        if(OnAlert != null)
           OnAlert();
    }

    public event AlarmEvent OnAlert;
} 
```

所有 event 关键字在这里给我们的，是添加和删除该事件的侦听器的能力......

```
Alarm a = new Alarm();
a.OnAlert += myevent;
a.OnAlert += myotherevent; 
```

另一方面，委托虽然工作方式与我们刚刚描述的完全一样，但其工作方式更类似于函数指针。想象一个抽象渲染器，我可以这样创建类：

```
public abstract class Renderer
{
    protected abstract void RenderImpl();
} 
```

这意味着，我一定会从那个渲染中派生出来。但是如果那个渲染器接受了一个委托呢？

```
public abstract class Renderer
{
    public delegate void RenderDelegate();

    public Renderer(RenderDelegate) { /* ... */ }
} 
```

我们现在正在分离组合物。

我在说什么？是不是更好？就事件而言，我允许公众成为我班级的观察员。他们可以做出反应。在第二种情况下，我定义了一个用户提供的委托来执行一个小众功能，同时我保留了大部分控制权。

代表和活动大多是同一件事——但我们所做的设计选择决定了哪一个是合适的。

为了解决您的其他观点，您提出了一个很好的事件与代表的例子。如果我们要更改上面的警报类，允许委托返回`true`or `false`，那么会发生什么？

我们会让几个观察者返回 true，但谁是对的，我们如何检查它们？

然而，沿着单一委托路线......“渲染成功”或“渲染失败”。改变这个单一的代表并不是什么大问题。我们可以预测地测试我们的渲染器是否完成了这项工作：

```
if(!delegate_->Invoke())
    fallBackCode(); 
```

我们真的不能用事件来做到这一点。嗯，不可预测。

更简单地说，当你想广播某事并让其他人在收到该事件时做某事时，事件就在那里。炸弹爆炸了……跑，躲起来，打电话给国民警卫队，关掉烤箱，或者躲起来躲起来。

委托允许您在不更改模型的情况下更改功能（委托遵循签名！）。代表的一个很好的例子是当你打电话时`List<T>.Sort`。那是代表。它有一个签名。

但是您也可以将它们用于更高级的事情，例如在`Renderer`不借助接口的情况下更改类，以及能够提供用户定义的“片段”。我想这里最简单的类比是 Win32 中的所有者绘制控件。无需重写整个类，无需提供接口，无需编写大量代码。只需更改在组合框中呈现项目的位。代表是您如何实现这一目标的好例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T18:44:14.930

MSDN 上的教程将回答您的所有问题：

代表： http: [//msdn.microsoft.com/en-us/library/aa288459 (v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa288459(v=vs.71).aspx)

事件： http: [//msdn.microsoft.com/en-us/library/aa645739 (v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa645739(v=vs.71).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-20T17:17:54.073

```
class Program
    {
        static void Main(string[] args)
        {
            Parent p = new Parent();
        }
    }

    ////////////////////////////////////////////

    public delegate void DelegateName(string data);

    class Child
    {
        public event DelegateName delegateName;

        public void call()
        {
            delegateName("Narottam");
        }
    }

    ///////////////////////////////////////////

    class Parent
    {
        public Parent()
        {
            Child c = new Child();
            c.delegateName += new DelegateName(print);
            //or like this
            //c.delegateName += print;
            c.call();
        }

        public void print(string name)
        {
            Console.WriteLine("yes we got the name : " + name);
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-27T09:14:58.177

拜托了伙计们！你们所有人都成功地使代表复杂化了:)！

我将尝试在这里留下一个提示：一旦我意识到 Javascript 中的 jquery ajax 调用，我就理解了代表。例如： ajax.send(url, data, successcallback, failcallback) 是函数的签名。如您所知，它将数据发送到服务器 URL，作为响应，它可能是 200OK 或其他错误。如果发生任何此类事件（成功/失败），您需要执行一个函数。因此，这就像一个函数的占位符，可以在成功或失败中提及。该占位符可能不是很通用 - 它可能接受一组参数并且可能/可能不会返回值。这种占位符的声明，如果在 C# 中完成，则称为代表！由于 javascript 函数对参数数量不严格，您只会将它们视为 GENERIC 占位符......但 C# 有一些 STRICT 声明......归结为 DELEGATE 声明！

希望能帮助到你！

# css - 使用 Impress js 的立方体 css3

> ID：14093326
> 
> 赞同：0
> 
> 时间：2012-12-30T18:23:07.117
> 
> 标签：css, impress.js

基于这里的演示 [https://github.com/bartaz/impress.js](https://github.com/bartaz/impress.js)

我已经尝试从立方体的正面移动到顶部，但我无法旋转到其他面.. 目标是在立方体的所有六个面上都有一些内容，并且按下空格键我应该能够切换到每个面

我的适用于两张脸的html代码如下

```
<!doctype html>

<html lang="en">
<head>
<link type ="text/css" href="css/customstyle.css" rel="stylesheet" />
</head>

<body> 
    <div id="impress">

    <div id="step-1" class="step slide" data-x="200" data-y="200">
        <p>
            <span class="text1">A</span> 
            <span class="text2">B</span>
            <span class="text3">C</span>

        </p>

     </div>

<div id="step-2" class="step slide"  data-x="100" data-y="145"  data-z="-1000" data-rotate-x="180" data-scale="1" >

  <p>
        Face 2 :) </p> </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T04:48:27.967

我在等人回答。

1 个耗时的选项是将文本放在图像上。图像将具有 1 种颜色的各种色调和色调以提供 3d 效果。使用 z-index 将文本放在图像上方。

另一种选择是直接联系开发人员。我想他可以在 Github 上联系到。也许他会有更好、更简单、更短的方法来获得所需的输出

# android - Android OpenGL ES：恢复/暂停活动

> ID：14093327
> 
> 赞同：2
> 
> 时间：2012-12-30T18:23:25.487
> 
> 标签：android, opengl-es, android-activity, lifecycle

我很难理解在 Activity、GLSurfaceView 和 Renderer 之间拆分应用程序状态的初始化和维护的正确方法。假设我有一个包含复杂对象、复杂状态的游戏，并且想要保留状态并将其加载到每个 onResume 上。我的初始化是这样的：

```
public class MyActivity extends Activity {
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
    gamescreenView = (GLGameScreenSurface) findViewById(R.id.GLGamescreenView);
    ...
    if (savedInstanceState == null) { 
        Game.init();
        resuming = false;
    } else {
        gamedata = (GameData) savedInstanceState.getSerializable("gamedata");
        resuming = true;
    }
    renderer = new MyRenderer(this, gamedata, gamescreenView,
            handle, resuming);
    gamescreenView.setRenderer(renderer);
}
@Override
public void onPause(){
    super.onPause();
    gamescreenView.onPause();
    gamedata = renderer.gamedata;
}
@Override
public void onResume(){
    super.onResume();
    gamescreenView.onResume();
    renderer.gamedata= gamedata;
}

@Override
public void onSaveInstanceState(Bundle savedInstanceState) {
  super.onSaveInstanceState(savedInstanceState);
  savedInstanceState.putSerializable("gamedata", renderer.gamedata);
}
@Override
public void onRestoreInstanceState(Bundle savedInstanceState) {
  super.onRestoreInstanceState(savedInstanceState);
  gamedata = (UniverseHolder) savedInstanceState.getSerializable("gamedata");
} 
```

这是我的渲染器：

```
public class MyRenderer implements GLSurfaceView.Renderer {
public WideOpenRenderer(Context context, UniverseHolder universe, GLGameScreenSurface gamescreenView, Handler handler, boolean resuming) {
    this.context = context;
    this.handler = handler;
    parent = gamescreenView;
    this.gamedata = gamedata;
    this.resuming = resuming;
}
public void onSurfaceCreated(GL10 unused, EGLConfig config) {
            GLES20.glClearColor(0.0f, 0.0f, 0.0f, 1.0f);
            Log.d("mydebug", "" + resuming);
            gamedata.init();
}
... 
```

但它不是这样工作的，根据日志，恢复总是错误的。

# generics - MonoTouch 和支持变体通用接口

> ID：14093332
> 
> 赞同：6
> 
> 时间：2012-12-30T18:23:58.457
> 
> 标签：generics, xamarin.ios, covariance, contravariance

以下示例在常规 Mono 2.10.9 中编译良好：

```
namespace covarianttest
{
    public interface ITest<out T> : IEnumerable<T>
    {
    }
} 
```

但是，当我尝试针对 MonoTouch 6.0.8 编译它时，我收到此错误：

错误 CS1961：协变类型参数“T”必须在“covarianttest.ITest”上始终有效

那么我是否假设 MonoTouch 不支持扩展协变/逆变通用接口呢？如果是这样，对于 MonoTouch 中的这种情况，推荐的解决方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T18:36:16.827

这实际上取决于编译器（和配置文件/运行时）而不是 Mono 版本。IOW 有些事情可能适用于 Mono 2.10 而不适用于 MonoTouch 6.x。

当前版本的 MonoTouch 附带`smcs`编译器和基于 2.1 的配置文件（主要是 Silverlight 和一些 .NET 4.0 添加）。

较新的特性，如协方差，需要完整的 4.0 编译器（例如`dmcs`在 Mono 2.10 或`mcs`Mono 3.0 中）和运行时。

MonoTouch 的未来版本（可能在今年春天在 2013 年初推出 alpha/beta）将提供 4.0/4.5 运行时和编译器。

# php - PHP pregmatch 在信息后提取值

> ID：14093333
> 
> 赞同：0
> 
> 时间：2012-12-30T18:23:59.263
> 
> 标签：php, regex, preg-match

我有一堆登录文本文件，我试图使用 pregmatch 在冒号后面直接提取信息，例如我有：

> 04:28:17.409 [Main:1 - Bootstrapper.LogSystemInfo] 操作系统架构：64 位 04:28:17.409 [Main:1 - Bootstrapper.LogSystemInfo] 操作系统服务包：服务包 1

我有这个代码，它适用于我以前使用过的类似代码，但我是一个正则表达式新手，它似乎在这里不起作用：

```
preg_match('/Operating System Architecture: (.+?)<br>/', $body, $os_bit);
preg_match('/Operating System Service Pack: (.+?)<br>/', $body, $os_service_pack); 
```

但是当我回应这个

```
echo $os_bit[1];
echo $os_service_pack[1]; 
```

我什么也没得到

正文是一个巨大的日志文件，所以我只是提取了上面的相关信息片段，希望这就足够了。像上面的例子一样，其中大约有 8 个都在新的行上，所以如果我得到一个病，就可以得到所有

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:32:34.137

你在使用`preg_match`日志文件吗？在这种情况下，行尾不应`<br>`只是换行符 ( `\n`)。由于点通常不匹配换行符，除非您`/s`在末尾使用，请尝试：

```
preg_match('/Operating System Architecture: (.*)/', $body, $os_bit);
preg_match('/Operating System Service Pack: (.*)/', $body, $os_service_pack); 
```

另外，请注意`$os_bit`and`$os_service_pack`将是数组，因此要调试您可能想要使用`print_r($os_bit);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T18:41:52.097

以下是我根据提供的数据量得出的结论：

```
<?php
$body = "
04:28:17.409 [Main:1 - Bootstrapper.LogSystemInfo] Operating System Architecture: 64 bits 
04:28:17.409 [Main:1 - Bootstrapper.LogSystemInfo] Operating System Service Pack: Service Pack 1
04:28:17.409 [Main:1 - Bootstrapper.LogSystemInfo] Operating System Architecture: 64 bits 
04:28:17.409 [Main:1 - Bootstrapper.LogSystemInfo] Operating System Service Pack: Service Pack 1
04:28:17.409 [Main:1 - Bootstrapper.LogSystemInfo] Operating System Architecture: 64 bits 
04:28:17.409 [Main:1 - Bootstrapper.LogSystemInfo] Operating System Service Pack: Service Pack 1";

preg_match_all('/(Operating System Architecture:.*)(\n|$)/i', $body, $os_bit);
preg_match_all('/(Operating System Service Pack:.*)(\n|$)/i', $body, $os_service_pack);

print_r($os_bit[1]);
print_r($os_service_pack[1]); 
```

然后导致：

```
Array
(
    [0] => Operating System Architecture: 64 bits
    [1] => Operating System Architecture: 64 bits
    [2] => Operating System Architecture: 64 bits
)
Array
(
    [0] => Operating System Service Pack: Service Pack 1
    [1] => Operating System Service Pack: Service Pack 1
    [2] => Operating System Service Pack: Service Pack 1
) 
```

# prolog - Prolog - 提取两个列表中的元素

> ID：14093339
> 
> 赞同：1
> 
> 时间：2012-12-30T18:24:27.240
> 
> 标签：prolog

我有一个问题，我有两个列表，我想提取所有相同的元素。例如 ：

```
> comparer([la_defense,etoile,chatelet,nation],[auber,chatelet,hotel_de_ville,nation],X).

comparer([],LSB,LI).
comparer([X|LS],LSB,LI):-member(X,LSB),!,comparer(LS,LSB,[LI|X]).
comparer([X|LS],LSB,LI):-comparer(LS,LSB,LI). 
```

我想要这个结果：

```
X = [chatelet,nation]. 
```

但是我制作的这段代码不起作用。我是新手，所以...有什么问题？：/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:14:54.110

您正在使用累加器，因此代码应该是

```
comparer(L1, L2, R) :-
    comparer(L1, L2, [], R).

comparer([], _, R, LR) :-
    reverse(R, LR).

comparer([X|LS],LSB,LI, R):-
    member(X,LSB),!,
    comparer(LS,LSB,[X | LI], R).
comparer([_X|LS],LSB,LI, R):-
    comparer(LS,LSB,LI, R). 
```

你可以试试这个

```
comparer([], _, []).

comparer([X|LS],LSB,LI):-
    comparer(LS, LSB, R),
    (   member(X, LSB) -> LI = [X | R]; LI = R). 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T21:22:01.643

[交集](http://www.swi-prolog.org/pldoc/doc_for?object=intersection/3)/3 正是你需要的。

```
?- intersection([la_defense,etoile,chatelet,nation],[auber,chatelet,hotel_de_ville,nation],X).
X = [chatelet, nation]. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-29T11:09:24.430

[我](https://stackoverflow.com/a/29819232/4609915)对类似问题[Intersection and union of 2 个列表](https://stackoverflow.com/questions/9615002/intersection-and-union-of-2-lists)的回答可能会让您感兴趣。

[与这里和那里](https://stackoverflow.com/questions/9615002/intersection-and-union-of-2-lists)发布的其他答案不同，我建议的实现在逻辑上是纯粹的和单调的，这使得它在泛化/专业化方面更加通用和健壮。

首先，让我们看看它是否适用于您上面给出的查询：

```
?- As = [la_defense,etoile,chatelet,nation],
   Bs = [auber,chatelet,hotel_de_ville,nation],
   list_list_intersection(As,Bs,Xs).
As = [la_defense, etoile, chatelet, nation],
Bs = [auber, chatelet, hotel_de_ville, nation],
Xs = [chatelet, nation]. 
```

但是，如果我们以不同（但在逻辑上等效）的方式编写查询呢？

```
?- As = [_,_,_,_],
   Bs = [_,_,_,_],
   list_list_intersection(As,Bs,Xs),
   As = [la_defense,etoile,chatelet,nation],
   Bs = [auber,chatelet,hotel_de_ville,nation].
As = [la_defense, etoile, chatelet, nation],
Bs = [auber, chatelet, hotel_de_ville, nation],
Xs = [chatelet, nation]. 
```

`list_list_intersection/3`我们得到相同的**结果**。

* * *

`intersection/3`现在，让我们考虑使用另一个答案中提出的内置函数。`intersection/3`在泛化方面也很稳健吗？

```
?- As = [_,_,_,_],
   Bs = [_,_,_,_],
   intersection(As,Bs,Xs),
   As = [la_defense,etoile,chatelet,nation],
   Bs = [auber,chatelet,hotel_de_ville,nation].
false. 
```

**不！** `intersection/3`失败，即使它在逻辑上等价的查询中成功，这表明实现`intersection/3`不是*monotone*。

**底线：** `intersection/3`比正确使用**更难**`list_list_intersection/3`；它迫使您在使用它时考虑声明性**和程序性方面。**

# html - 像 jqm 这样的引导列表视图

> ID：14093345
> 
> 赞同：5
> 
> 时间：2012-12-30T18:25:06.677
> 
> 标签：html, jquery-mobile, twitter-bootstrap, javascript

我希望重新创建一些本机移动列表功能，如列表视图、列表视图过滤器/搜索和复杂列表视图。

这是来自 jquery mobile 的示例。

[http://jquerymobile.com/test/docs/lists/lists-formatting.html](http://jquerymobile.com/test/docs/lists/lists-formatting.html)

有没有人有一个引导程序的库或扩展来模仿其中一些功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:25:53.937

这有帮助吗？ [http://www.iui-js.org/download](http://www.iui-js.org/download)

它适用于 iphone 应用程序！

# cross-browser - （最好是免费的）Web 开发人员的跨平台测试软件？

> ID：14093347
> 
> 赞同：-1
> 
> 时间：2012-12-30T18:25:23.070
> 
> 标签：cross-browser

你好 Stackoverflowers，

最近我在一个网站上工作，该网站涉及一些实验性功能，这些功能在不同的浏览器、平台和设备上呈现不同。是否有一个好的（最好是免费的）软件可以让我们消除设计/开发中的猜测，而无需实际在所有设备/平台上测试网站？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:03:11.583

您可以使用[Selenium](http://seleniumhq.org/)进行自动化测试，但它不会为您完成工作，您必须定义测试并让您的 CI 环境在所有相关平台上运行它们。好消息是，一旦您设置它，它就会自动运行，您不必在每个平台上手动重复自己。

这是您最接近无忧测试的方式。

# jsf - 有没有类似 h:selectOneCheckbox 的东西？

> ID：14093349
> 
> 赞同：0
> 
> 时间：2012-12-30T18:25:41.387
> 
> 标签：jsf, jsf-2, checkbox, selectoneradio

我想要一些像许多复选框这样的设计，用户必须只选择一个复选框。有`h:selectManyCheckbox`，但没有`h:selectOneCheckbox`。我也知道`h:selectOneRadio`用`<br/>` .`<f:selectItem>`

我怎样才能在 JSF 2.0 中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:34:18.150

您可以使用`h:selectOneRadio`with`layout`属性设置来`pageDirection`垂直呈现单选按钮。

# javascript - 为什么“代理”继承停止使用闭包？

> ID：14093355
> 
> 赞同：0
> 
> 时间：2012-12-30T18:26:22.667
> 
> 标签：javascript, node.js, inheritance, module, closures

对于那些不熟悉的人，代理继承如下所示：

```
var Surrogate = function () {}

var extend = function (Base, Sub) {
  Surrogate.prototype = Base.prototype;
  Sub.prototype = new Surrogate();
  Sub.prototype.constructor = Sub;
}

var Animal = function (name) {
  this.name = name;
};

Animal.prototype.speak = function () {
  return this.getSound() + ' ' + this.name;
};

Animal.prototype.getSound = function () {
  // Abstract
};

var Cat = function (name) {
  Animal.call(this, name);
};

extend(Animal, Cat);

Cat.prototype.getSound = function () {
  return 'Meow';
};

var kitty = new Cat('Maru');
console.log(kitty.speak()); // Logs "Meow Maru"
console.log(kitty instanceof Animal); // Logs true
console.log(kitty instanceof Cat); // Logs true
console.log(kitty.constructor == Cat); // Logs true 
```

基本上要创建一个继承自 的构造函数`Animal`，我们创建另一个构造函数（在本例中为），使用 的正确值`Cat`调用构造函数，然后使用该函数将的原型设置为没有名称属性。认为 using与except 相同是未定义的。`Animal``this``extend``Cat``Animal``extend(Animal, Cat)``Cat.prototype = new Animal()``Cat.prototype.name`

以上工作完美，我有一个关于它的附带问题稍后。

我想把它提升到一个新的水平并隐藏`Surrogate`在一个闭包中，所以我改变了 and 的声明，`Surrogate`看起来`extend`像这样：

```
var extend = (function () {
  var Surrogate = function () {};
  return function (Base, Sub) {
    Surrogate.prototype = Base.prototype;
    Sub.prototype = new Surrogate();
    Sub.prototype.constructor = Sub;
  };
}); 
```

现在，当我运行脚本时，它在第一个日志语句中失败：

```
TypeError: Object [object Object] has no method 'speak' 
```

`extend.js`但是，使用以下内容创建另一个文件：

```
var Surrogate = function () {};

module.exports = function (Base, Sub) {
  Surrogate.prototype = Base.prototype;
  Sub.prototype = new Surrogate();
  Sub.prototype.constructor = Sub;
} 
```

`extend`并将主脚本中的声明更改为`var extend = require('./extend');`有效，并且`Surrogate`按预期隐藏。

**对于主要问题：**据我所知，node 和其他 CommonJS 系统只是将模块包装在一个闭包函数中，就像我最初尝试做的那样。为什么模块版本有效，但我的闭包版本无效？

**对于上面提到的附带问题：**我很惊讶`Sub.prototype.constructor = Sub`。我认为应该是这样，`Sub.prototype.constructor = Base`但这会导致最后一个日志记录语句记录`false`。我想我已经为自己回答了这个问题，但我认为这`constructor`是构造对象的属性，而不是原型。是不是反过来？

**更新**

我刚刚使用 AMD 使用了一个名为`extend`如下定义的模块进行了尝试：

```
define(function () {
  var Surrogate = function () {};

  return function (Base, Sub) {
    Surrogate.prototype = Base.prototype;
    Sub.prototype = new Surrogate();
    Sub.prototype.constructor = Sub;
  };
}); 
```

它工作得很好。我觉得我在这里忽略了一些非常简单的东西……为什么这在模块系统中可以正常工作，但在普通闭包中却不行？我已经在 node.js、Chrome 和 Firefox 中测试了所有版本（普通、闭包和模块）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:11:59.417

```
var extend = (function () {
  var Surrogate = function () {};
  return function (Base, Sub) {
    Surrogate.prototype = Base.prototype;
    Sub.prototype = new Surrogate();
    Sub.prototype.constructor = Sub;
  };
}); 
```

应该

```
var extend = (function () {
  var Surrogate = function () {};
  return function (Base, Sub) {
    Surrogate.prototype = Base.prototype;
    Sub.prototype = new Surrogate();
    Sub.prototype.constructor = Sub;
  };
})(); 
```

（我只是附加`()`到它以执行该功能。）

或者，如果您想防止 Surrogate 损坏的可能性（某些东西可能会弄乱它的构造函数 - 让它做一些事情）：

```
var extend = function (Base, Sub) {
    var Surrogate = function () {};
    Surrogate.prototype = Base.prototype;
    Sub.prototype = new Surrogate();
    Sub.prototype.constructor = Sub;
}; 
```

# python - 当与 uwsgi 一起使用时，redis 追加值而不是设置它

> ID：14093356
> 
> 赞同：3
> 
> 时间：2012-12-30T18:26:43.823
> 
> 标签：python, nginx, redis, flask, uwsgi

我正在使用以下堆栈：

*   nginx
*   uwsgi
*   蟒蛇（烧瓶）

我已经建立了一个利用 redis 作为其主数据库的小应用程序。我只在我的代码中使用 GET、SET、EXISTS 和 EXPIRE。

在终端中尝试应用程序时，一切正常。在每次请求时，它都会检查内容是否可用 (EXISTS)。如果不是，则内容会被加载并保存一段时间（SET，EXPIRE）。之后，将内容呈现给用户 (GET)。

问题是，一旦我通过 nginx/uwsgi 运行应用程序，一段时间后 EXPIRE 似乎被忽略了。不是删除值并重新加载它，而是将新内容附加到旧内容 - 因为它似乎不仅是一次，而是几十次，导致非常大的值，有时甚至超时。

对我来说最奇怪的事情：一旦我重新启动 uwsgi，整个问题就消失了。
任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T11:19:46.980

我想通了！问题是我“回收”了这两个实例：

```
md = markdown.Markdown(safe_mode="escape", output_format='html4')
h2t = html2text.HTML2Text() 
```

[http://github.com/saibotd/hackerhub/blob/master/app.py](http://github.com/saibotd/hackerhub/blob/master/app.py) -> 第 22、23 行

我需要在每个请求中重新创建这些对象，并且它按预期工作。

# c# - keygen html5的私钥

> ID：14093364
> 
> 赞同：0
> 
> 时间：2012-12-30T18:27:42.337
> 
> 标签：c#, asp.net, html

对于加密，互联网上有几种可用的算法（例如 .net 中的 RSA），我们在其中提供以下

**弦乐：**塔哈祖拜尔

**钥匙：** 12456978

**结果：** AexcrX5TUOEpWKYSr7BPUlD8EoD17ijAGgyHQx4z==

在提交表单时，我们会得到类似上面的结果。

那么现在说说**Html5 keygen的特性**

keygen 元素表示密钥对生成器控件。当控件的表单提交时，私钥保存在本地keystore中，公钥打包发送给服务器。

这是html5 keygen的代码

```
<form method="get">
    Username:
    <input type="text" name="name" />
    <br/>
    Encryption: 
    <keygen name="encryption" />
    <br/>
    <input type="submit" value="Send" />
    <br/>
</form> 
```

从浏览器提交值 = 'taha' 我得到以下结果

**字符串/值：** taha

**关键：**？

**结果**：file:///D:/latest%20technologies/html5%20-%20working/html5-Forms.html?name= **taha**&encryption=MIICQD​​CCASgwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDHFLDvYzA5%0D%0ApeewYLYjedSAWMyFZwz4gZwhrQG2QRZI1jGtU9WqrWvpc37GpdWt5TKbUWKNXihH%0D%0AzvdRzC2knBQNh%2FX0Uq44mIYWFwAyaHUNyx6YdjkDR%2FVOs86FRNskdShPbIMQ7jnL%0D%0AsIKiJntztmVsquFgwhfDT6t3jLbFfPInukiS5Nuz%2FcISzLJH7YF8%2F6bPrwbCCOiC%0D%0AJM8scJMEMi3jaoVcQH6ffScrJUcnaFUm6x2AX1iqwtSEuBSRuvK3rrHgQXxeZ1ZT%0D%0AqjWBNEJNDkmWlHpRUTUR5GIPt2WUokjnokrXYmOyEAIyijkiNOrUA4WvYsBxpO26%0D%0A%2FA%2B6KIPE6IlhAgMBAAEWADANBgkqhkiG9w0BAQQFAAOCAQEAT2XIdAedDknlNFe1%0D%0AiOLPVi9f68zPYYvxanTSNPSPCLIBq%2BICQ3r%2Fevl1%2FqG3iOEyhk07RuCMfGgrxML7% 0D%0AIm87TJNZTHErYFmZ1wHcs3LPC2hQPJp2aiH%2B2pXmpN1LutKroN4aE%2BRJ%2Bb6%2BTu7B%0D%0AWguU0BGeIUSWOQl0eh9G8a2iAjzUFqLnBLKufH%2FKq8xg7C35NF2fAqdabnoN4XFd%0D%0A4wg8dI7lffsBwVLY6x6REt1R40lIUPfqeZwmJoh55BPeV2PZhMuFV8F49sr88aPg%0D%0Awp1WIQ56n9e3bKc3VFO48V3OZgCBi3Dk5NYWFxujFkOrK8hSNQAnTFVdVWoFZ5MI%0D%0AwXQcEQ%3D%3D

所以我得到了结果，但注意到输入 taha 很容易用加密文本显示

此外，最重要的问题是 html5 keygen 的密钥在哪里

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T18:31:37.233

生成的私钥存储在浏览器的密钥存储中（如果浏览器没有自己的，也可以添加到操作系统的密钥存储中）。它永远不会发送给您，因为您不应该访问它。

你在`encryption`参数中得到的（你应该`method="post"`顺便使用）是对应于私钥的公钥。您可以使用它来创建一个证书，然后您很可能会将其发送回客户端，以便他可以安装它。

# php - 如何使用 PHP 检查/确定会话年龄

> ID：14093368
> 
> 赞同：2
> 
> 时间：2012-12-30T18:27:52.153
> 
> 标签：php, session, session-cookies

我想知道是否可以使用 PHP 以某种方式检查会话年龄。我浏览了stackoverflow，没有找到任何东西。提前感谢所有答案。

*如果有人想知道为什么我需要知道这样的事情，我想在所有页面的屏幕顶部显示所有登录不到 30 分钟的人的通知。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T18:30:49.127

为什么不只设置`$_SESSION['logged_in_at'] = time()`用户登录时，然后检查`if( time() - $_SESSION['logged_in_at'] < 30*60)`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-02T03:54:42.833

```
$session_time = fileatime(session_save_path()."/sess_".session_id());
echo "Session Age (Seconds): ".(time()-$session_time); 
```

也许这不是最佳实践，但在没有像`session_time()`.

# android - 检查 sdk 版本和是否

> ID：14093369
> 
> 赞同：3
> 
> 时间：2012-12-30T18:27:56.540
> 
> 标签：android

我需要检查 android 的版本并使用 if 来运行一个或其他 alertdialog。使用此代码，“builder”底部最后一个如果不共享。最好的方法是什么？

我的代码：

```
int sdk = android.os.Build.VERSION.SDK_INT;
        if(sdk < android.os.Build.VERSION_CODES. HONEYCOMB) 
        {
            AlertDialog.Builder builder = new AlertDialog.Builder(this);
        }
        else if (sdk >= android.os.Build.VERSION_CODES. HONEYCOMB)
        {
            AlertDialog.Builder builder = new AlertDialog.Builder(this, animazione);
        }

        builder.setView(view).create();
        TextView text=(TextView) findViewById(R.id.infoView1);
        builder.setCancelable(false); 
        builder.setPositiveButton("Chiudi", new DialogInterface.OnClickListener() {  
               public void onClick(DialogInterface dialog, int id) {  
                   tips = 0;
                   dialog.cancel();
            }  
            });  
        builder.show();     
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T18:29:32.457

很简单，像这样：

```
AlertDialog.Builder builder;
if(sdk < android.os.Build.VERSION_CODES.HONEYCOMB) 
{
    builder = new AlertDialog.Builder(this);
}
else
{
    builder = new AlertDialog.Builder(this, animazione);
} 
```

正如*@Eric*指出的那样，一个简单的`else`就足够了，因为`else if`基本上是在测试与`if`.

# php - 如何使每个 php-script 实例的会话变量唯一？

> ID：14093372
> 
> 赞同：4
> 
> 时间：2012-12-30T18:28:32.333
> 
> 标签：php, session

好吧，假设我有一个 php 脚本，它有一些选择框，我想将选定的值存储在会话数组中。到目前为止，我使用以下构造将值分配给我的会话数组：

```
$_SESSION[SCRIPT_NAME]['filter_data'] 
```

SCRIPT_NAME 是我放置脚本名称的常量，这是为了使每个 php 脚本的会话变量都是唯一的。一切都很好，直到用户在两个或多个选项卡中打开相同的脚本以同时工作。在这种情况下，变量混合在一起，事情就出错了……

可能您有任何想法如何使每个脚本实例的会话变量绝对唯一？或者任何建议如何以不同的方式实现功能？

现在，我可以在 URL 中传递我的变量，但我不喜欢这个选项。我想使用会话，我希望我的网络应用程序的每个脚本在整个用户登录会话期间记住用户的选择

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T18:35:58.793

“...如何使每个脚本实例的会话变量绝对唯一？”

基本上答案是，“你不能。” 这是因为浏览器的所有实例（窗口和选项卡）共享同一个 cookie jar。因此，两个实例都返回相同的 cookie，并且它们连接到同一个会话。这在“现实生活”中很少出现问题，但正如您现在所看到的那样，它会让开发人员发疯；-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-07T18:27:31.057

```
 <?php
        //Start session
        session_start();
        //Check whether the session variable SESS_MEMBER_ID is present or not
        if (!isset($_SESSION['id']) || ($_SESSION['id'] == '')) {
            header("location: index.php");
            exit();
        }

        $session_id=$_SESSION['id'];
        ?> 
```

和文件连接

```
 <?php

 class DbConnector {

 var $theQuery;
 var $link;

 function DbConnector(){

    // Get the main settings from the array we just loaded
    $host = 'localhost';
    $db = '';
    $user = 'root';
    $pass = '';

    // Connect to the database
    $this->link = mysql_connect($host, $user, $pass);
    mysql_select_db($db);
    register_shutdown_function(array(&$this, 'close'));

}

   //*** Function: query, Purpose: Execute a database query ***
function query($query) {

    $this->theQuery = $query;
    return mysql_query($query, $this->link);

}

//*** Function: fetchArray, Purpose: Get array of query results ***
function fetchArray($result) {

    return mysql_fetch_array($result);

}

//*** Function: close, Purpose: Close the connection ***
function close() {

    mysql_close($this->link);

}

}

?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-22T16:26:00.530

*   为每个打开的页面生成一个唯一的 id
*   通过 get 方法将该唯一 ID 传递给脚本
*   使用该唯一 ID 而不是脚本名称

**这种方法的问题**

使用这种方法，如果您不清除未使用的变量并且用户在会话到期之前打开您的网站很多，那么存储的会话变量可能会随着时间的推移占用非常多的空间

**这些问题的解决方案**

*   为生成的每个唯一 ID 存储时间戳
*   每次用户在使用该唯一 ID 的页面上执行操作*时，将该时间戳更改为当前时间戳
*   如果用户在具有另一个唯一 ID 的页面中执行操作*，请检查自每个唯一 ID 的最后一次操作以来是否已过去 x 时间，如果是，则将其删除

*：可以在页面上执行的动作和页面刷新

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-21T11:38:02.697

您可以使用`session_name($unique_script_instance_name)`- [https://www.php.net/manual/en/function.session-name.php](https://www.php.net/manual/en/function.session-name.php)

您需要做的就是为脚本的每个实例定义一个唯一的名称，例如，如果您在共享服务器上有 2 个单独的应用程序安装，则为第一个提供名称 A，为第二个提供名称 B，您可以存储此值为`$unique_script_instance_name`。

然后在你打电话之前`session_start()`你需要打电话`session_name()`

```
// One script
$unique_script_instance_name "A";
session_name($unique_script_instance_name);
session_start();

...

// Second script
$unique_script_instance_name "B";
session_name($unique_script_instance_name);
session_start();

... 
```

这样，两个脚本都将拥有自己的会话“域”，并且彼此隔离。那样

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-23T09:18:16.347

请记住，会话只是一个变量。您绝对可以为每个页面创建一个唯一的会话变量。对于每个获取请求，将创建一个新的唯一会话变量。您需要做的就是创建唯一的会话名称。

```
<?php
 session_start();
 $_SESSION[$_GET['pid'].'_p1'] = "a session value";
 $_SESSION[$_GET['pid'].'_p2'] = "a session value";
 $_SESSION[$_GET['pid'].'_p3'] = "a session value";
?> 
```

例如，如果您访问`http://example.com/?pid=1232`

会话名称将类似于`$_SESSION['1232_p1'];`

对于每个获取请求，将创建一个新的唯一会话。

要查看所有会话变量，请在页面末尾使用以下代码：

```
<?php
echo '<pre>';
print_r($_SESSION);
echo '</pre>';
?> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-22T13:15:25.953

这是一个很老的问题，但我是写给其他程序员或新手朋友使用的。

只需为来自客户端的每个请求设置一个验证页面即可检查会话变量。例如：`valid_ref.php` 或者为您的源代码中的所有页面使用参考页面，并根据参考页面中的客户端请求调用其他页面。例如：`index.php or home.php or ref.php` 在 valid_ref.php 中检查是否`$_SESSION[SCRIPT_NAME]['filter_data']`在会话中，当客户端打开新选项卡时，您的 Web 应用程序使用's中的先前数据，`$_SESSION[SCRIPT_NAME]['filter_data']`通过这种方式，您不会对来自一个客户端的浏览器中的新选项卡有任何问题。

# ajax - 使用 getJSON 优于 AJAX 函数的优势

> ID：14093381
> 
> 赞同：2
> 
> 时间：2012-12-30T18:29:22.423
> 
> 标签：ajax, json

我正在寻找一个典型示例，其中调用 jQuery 函数 getJSON 比使用标准 AJAX 函数（来自 jQuery 或来自本机 JavaScript）具有很大优势。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T18:30:52.920

它更短。基本上 .getJSON 只是 jQuerys 的捷径

```
$.ajax({
  url: url,
  dataType: 'json',
  data: data,
  success: callback
}); 
```

现在你只做

```
$.getJSON(url, calllback); 
```

使用普通 AJAX 的优势应该是相当明显的，因为它的输入要少得多，并且可以处理所有烦人的浏览器特定差异。

# c# - 如何通过正则表达式从给定的字符串c#中剥离

> ID：14093389
> 
> 赞同：-2
> 
> 时间：2012-12-30T18:30:02.517
> 
> 标签：c#, regex

如何删除所有字符串，如下所示

```
<!-- ebanking log on --> 
```

第二个例子

```
<!-- 

end the bottom row with 'peace of mind garuntee' 

--> 
```

示例文档： http: [//pastebin.com/Y4gZdceK](http://pastebin.com/Y4gZdceK)

所以它应该删除所有以开头`<!--`和结尾的字符串块`-->`

我尝试`htmlagilitypack`了内部文本，但它没有删除

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:38:11.303

试试这个正则表达式：

```
<!--.*?--> 
```

请注意：您必须使用`RegexOptions.SingleLine`更改点 ( `.`) 的含义，使其匹配每个字符（而不是除 之外的每个字符`\n`）。

编辑：代码示例

```
var myRegex = new Regex(@"<!--.*?-->", RegexOptions.Singleline);
string strTargetString = @"[sample text here]";

string replacedText = myRegex.Replace(strTargetString, ""); 
```

# python - 随机顺序python

> ID：14093391
> 
> 赞同：1
> 
> 时间：2012-12-30T18:30:48.683
> 
> 标签：python, random

我必须为一个项目做一个测验。我有问题和 3 个答案，但正确的总是排在首位。如何随机播放我的答案？

```
QS = []
for row in data:
         row.append(2)
         QS.append(row)

while True:
    x=random.randint(0,len(QS)-1)
    if QS[x][2]>0:
        print QS[x][0]
        break

while True:
    if QS[x][2]>0:
        print QS[x][1]
        break

while True:
    xy=random.randint(0,len(QS)-1)
    if xy!=x:
        print QS[xy][1]
        break
while True:
    xyz=random.randint(0,len(QS)-1)
    if xyz!=xy and xyz!=xy:
        print QS[xyz][1]
        break 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T18:39:13.440

使用[random.shuffle](http://docs.python.org/2/library/random.html#random.shuffle)。首先创建一个有效答案列表并使用 random.shuffle 创建一个随机 shuffle

示例演示

```
>>> import random
>>> ans = ['ans1', 'ans2', 'ans3']
>>> random.shuffle(ans)
>>> ans
['ans1', 'ans3', 'ans2'] 
```

# html - 使用单个 arc() 函数调用绘制 pacman 形状？

> ID：14093400
> 
> 赞同：2
> 
> 时间：2012-12-30T18:32:34.777
> 
> 标签：html, canvas, html5-canvas

鉴于我目前对 arc() 函数如何工作的理解，试图弄清楚为什么我不能绘制 pacman 形状。

当我在 Chrome/Firefox 中尝试以下代码时，它绘制了一个完整的圆圈，这不是我所期望的。我怀疑这可能与非零缠绕规则有关？我的猜测是 -45 正在内部归一化，导致产生的角度扫描变为逆时针而不是顺时针。但是当我通过将最终 arg 更改为 CCW 来测试该假设时，Chrome 中没有任何变化（但是 FF 行为不同，因为没有绘制任何内容）

```
// draw pacman shape
ctx.arc(200,200,50, -45 * DEGREES, 45 * DEGREES, false);
ctx.stroke(); 
```

完整示例： http: [//pastebin.com/2ZkJXgJU](http://pastebin.com/2ZkJXgJU)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T18:38:38.637

这就是你要找的：

```
ctx.beginPath();
ctx.arc(100, 100, 50, 0.25 * Math.PI, 1.25 * Math.PI, false);
ctx.fillStyle = "rgb(255, 255, 0)";
ctx.fill();
ctx.beginPath();
ctx.arc(100, 100, 50, 0.75 * Math.PI, 1.75 * Math.PI, false);
ctx.fill();
ctx.beginPath();
ctx.arc(100, 75, 10, 0, 2 * Math.PI, false);
ctx.fillStyle = "rgb(0, 0, 0)";
ctx.fill(); 
```

来源：[http ://simeonvisser.hubpages.com/hub/HTML5-Tutorial-Drawing-Circles-and-Arcs](http://simeonvisser.hubpages.com/hub/HTML5-Tutorial-Drawing-Circles-and-Arcs)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-09-24T10:32:10.590

我知道这是一个老问题，并且已经得到解答，但我认为有一种更简单的方法可以用一条弧线绘制 pac-man。

```
// An arc with an opening at the right for the mouth
ctx.beginPath();
ctx.arc(100, 100, 50, 0.2 * Math.PI, 1.8 * Math.PI, false);

// The mouth
// A line from the end of the arc to the centre
ctx.lineTo(100, 100);

// A line from the centre of the arc to the start
ctx.closePath();

// Fill the pacman shape with yellow
ctx.fillStyle = "yellow";
ctx.fill();

// Draw the black outline (optional)
ctx.stroke();

// Draw the eye
ctx.beginPath();
ctx.arc(100, 75, 10, 0, 2 * Math.PI, false);
ctx.fillStyle = "rgb(0, 0, 0)";
ctx.fill(); 
```

接受的答案将起作用，但它使用两个半圆而不是单个弧。此方法还为您提供了绘制轮廓的选项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T18:51:43.440

您的第四和第五个论点是错误的，它们的范围从 -Math.PI 到 Math.PI，而不是度数。

我用来制作类似“pacman”的形状的技巧是将笔画的大小设置为等于圆的半径

```
ctx.lineWidth = 50;
ctx.arc(200,200,50,Math.PI*2.1,Math.PI*1.7, false);
ctx.stroke(); 
```

见：http: [//jsfiddle.net/8JaLY/2/](http://jsfiddle.net/8JaLY/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-08T07:50:00.107

请参考[https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/beginPath](https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/beginPath)了解什么是 PATH

```
var canvas = document.getElementById("myCanvas");
var ctx = canvas.getContext("2d");

var centerX = 100;
var centerY = 100;
var radius = 50; 
ctx.beginPath();
ctx.moveTo(centerX,centerY);
ctx.arc(
  centerX,centerY,radius,
  -Math.PI/4,Math.PI/4, // -45 deg to 45 deg
  true //anticlockwise
 );
ctx.lineTo(centerX,centerY);
ctx.stroke();//border
ctx.fillStyle = "rgb(255, 255, 0)";
ctx.fill();
ctx.closePath();
```

```
<canvas id="myCanvas" width="480" height="320"></canvas>
```

# ruby-on-rails - 从一个表中删除一行到另一个表

> ID：14093401
> 
> 赞同：0
> 
> 时间：2012-12-30T18:32:53.933
> 
> 标签：ruby-on-rails

我有两个表：Admin 和 Worker。它们具有相同的参数（电子邮件、密码等）。

我试图从 Worker 表中删除包含电子邮件的行：“foo@example.com”到 Admin 表中（并将其从 Worker 表中删除）。

我尝试了下一件事：

```
@email = 'foo@example.com'
@row_email_deleted = Worker.find_by_email(@email)
Admin.add(@row_email_deleted)
@row_email_deleted.destroy 
```

但它不起作用：/

有人可以帮我解决我的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:41:44.733

试试这个：

```
@email = 'alon@gmail.com'
@worker = Worker.find_by_email(@email)
@new_admin = @worker.becomes Admin
@new_admin.save
@worker.destroy 
```

但我建议您应该尝试重构为 STI，例如：[http ://blog.thirst.co/post/14885390861/rails-single-table-inheritance](http://blog.thirst.co/post/14885390861/rails-single-table-inheritance)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T18:45:43.323

除了apneadiving，我不知道'add'方法是由什么组成的。这并没有太多关于究竟是什么不起作用的细节使得很难知道它为什么不起作用。也就是说，忽略所有这些，我会做这样的事情：

```
Worker.transaction do
  @email = 'foo@example.com'
  @worker = Worker.find_by_email(@email)
  Admin.create(@worker.attributes.reject{|k,v| %w[id].include?(k)}) 
  @worker.destroy
end 
```

*   将整个事情包装在事务中，以确保您不会删除工作人员但不会添加管理员。 [http://api.rubyonrails.org/classes/ActiveRecord/Transactions/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/Transactions/ClassMethods.html)

*   'reject...' 位是删除您在 Admin 中不想要的任何工作人员属性（或无法整体传递）。

# android - Android AlarmManager 或服务？

> ID：14093404
> 
> 赞同：0
> 
> 时间：2012-12-30T18:33:04.297
> 
> 标签：android, android-service, alarmmanager

我有一个应用程序，它有一个 main.java 文件，该文件设置了一个警报来调用重复服务。但是，当我关闭应用程序时，由于某些奇怪的原因不再调用该服务。所以我正在阅读我应该为我的应用程序做些什么（基本上我想要的是 Twicca 之类的东西，即使你从“任务管理器”关闭它，twitter 应用程序也会继续运行）。看起来我需要做的是将我的整个应用程序部署为服务，以便它可以无限期地运行，除非系统关闭它。这是我应该做的吗？还是有更合适的方法来做到这一点？

我正在阅读 SO 并发现了一个与此相关的问题 - [http://android-codes-examples.blogspot.com/2011/11/running-service-in-background-on.html?m=1](http://android-codes-examples.blogspot.com/2011/11/running-service-in-background-on.html?m=1) - 是那我应该做什么？似乎在该示例中，用户基本上关闭了应用程序，但它继续在后台作为服务运行，对吗？

以下是我的文件供参考：

MainActivity.java

[https://gist.github.com/4414275](https://gist.github.com/4414275)

重复警报.java

[https://gist.github.com/4414277](https://gist.github.com/4414277)

我在清单中正确设置了它，因为警报的行为应该是该文件。

[https://gist.github.com/4414285](https://gist.github.com/4414285)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T20:21:33.763

你必须使用服务。ApiDemos 里面有一个完整的例子——名字是AlarmService_Service 和AlarmService。我将在这里为您发布代码：

```
 /*
 * Copyright (C) 2007 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.example.android.apis.app;

// Need the following import to get access to the app resources, since this
// class is in a sub-package.
import com.example.android.apis.R;

import android.app.Activity;
import android.app.AlarmManager;
import android.app.PendingIntent;
import android.content.Intent;
import android.os.SystemClock;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.Toast;

/**
 * This demonstrates how you can schedule an alarm that causes a service to
 * be started.  This is useful when you want to schedule alarms that initiate
 * long-running operations, such as retrieving recent e-mails.
 */
public class AlarmService extends Activity {
    private PendingIntent mAlarmSender;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // Create an IntentSender that will launch our service, to be scheduled
        // with the alarm manager.
        mAlarmSender = PendingIntent.getService(AlarmService.this,
                0, new Intent(AlarmService.this, AlarmService_Service.class), 0);

        setContentView(R.layout.alarm_service);

        // Watch for button clicks.
        Button button = (Button)findViewById(R.id.start_alarm);
        button.setOnClickListener(mStartAlarmListener);
        button = (Button)findViewById(R.id.stop_alarm);
        button.setOnClickListener(mStopAlarmListener);
    }

    private OnClickListener mStartAlarmListener = new OnClickListener() {
        public void onClick(View v) {
            // We want the alarm to go off 30 seconds from now.
            long firstTime = SystemClock.elapsedRealtime();

            // Schedule the alarm!
            AlarmManager am = (AlarmManager)getSystemService(ALARM_SERVICE);
            am.setRepeating(AlarmManager.ELAPSED_REALTIME_WAKEUP,
                            firstTime, 30*1000, mAlarmSender);

            // Tell the user about what we did.
            Toast.makeText(AlarmService.this, R.string.repeating_scheduled,
                    Toast.LENGTH_LONG).show();
        }
    };

    private OnClickListener mStopAlarmListener = new OnClickListener() {
        public void onClick(View v) {
            // And cancel the alarm.
            AlarmManager am = (AlarmManager)getSystemService(ALARM_SERVICE);
            am.cancel(mAlarmSender);

            // Tell the user about what we did.
            Toast.makeText(AlarmService.this, R.string.repeating_unscheduled,
                    Toast.LENGTH_LONG).show();

        }
    };
} 
```

和服务：

```
/*
 * Copyright (C) 2007 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.example.android.apis.app;

// Need the following import to get access to the app resources, since this
// class is in a sub-package.
import com.example.android.apis.R;

import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.app.Service;
import android.content.Intent;
import android.os.Binder;
import android.os.IBinder;
import android.os.Parcel;
import android.os.RemoteException;
import android.widget.Toast;

/**
 * This is an example of implementing an application service that will run in
 * response to an alarm, allowing us to move long duration work out of an
 * intent receiver.
 * 
 * @see AlarmService
 * @see AlarmService_Alarm
 */
public class AlarmService_Service extends Service {
    NotificationManager mNM;

    @Override
    public void onCreate() {
        mNM = (NotificationManager)getSystemService(NOTIFICATION_SERVICE);

        // show the icon in the status bar
        showNotification();

        // Start up the thread running the service.  Note that we create a
        // separate thread because the service normally runs in the process's
        // main thread, which we don't want to block.
        Thread thr = new Thread(null, mTask, "AlarmService_Service");
        thr.start();
    }

    @Override
    public void onDestroy() {
        // Cancel the notification -- we use the same ID that we had used to start it
        mNM.cancel(R.string.alarm_service_started);

        // Tell the user we stopped.
        Toast.makeText(this, R.string.alarm_service_finished, Toast.LENGTH_SHORT).show();
    }

    /**
     * The function that runs in our worker thread
     */
    Runnable mTask = new Runnable() {
        public void run() {
            // Normally we would do some work here...  for our sample, we will
            // just sleep for 30 seconds.
            long endTime = System.currentTimeMillis() + 15*1000;
            while (System.currentTimeMillis() < endTime) {
                synchronized (mBinder) {
                    try {
                        mBinder.wait(endTime - System.currentTimeMillis());
                    } catch (Exception e) {
                    }
                }
            }

            // Done with our work...  stop the service!
            AlarmService_Service.this.stopSelf();
        }
    };

    @Override
    public IBinder onBind(Intent intent) {
        return mBinder;
    }

    /**
     * Show a notification while this service is running.
     */
    private void showNotification() {
        // In this sample, we'll use the same text for the ticker and the expanded notification
        CharSequence text = getText(R.string.alarm_service_started);

        // Set the icon, scrolling text and timestamp
        Notification notification = new Notification(R.drawable.stat_sample, text,
                System.currentTimeMillis());

        // The PendingIntent to launch our activity if the user selects this notification
        PendingIntent contentIntent = PendingIntent.getActivity(this, 0,
                new Intent(this, AlarmService.class), 0);

        // Set the info for the views that show in the notification panel.
        notification.setLatestEventInfo(this, getText(R.string.alarm_service_label),
                       text, contentIntent);

        // Send the notification.
        // We use a layout id because it is a unique number.  We use it later to cancel.
        mNM.notify(R.string.alarm_service_started, notification);
    }

    /**
     * This is the object that receives interactions from clients.  See RemoteService
     * for a more complete example.
     */
    private final IBinder mBinder = new Binder() {
        @Override
        protected boolean onTransact(int code, Parcel data, Parcel reply,
                int flags) throws RemoteException {
            return super.onTransact(code, data, reply, flags);
        }
    };
} 
```

# javascript - javascript vs jQuery 自定义/全局变量范围

> ID：14093408
> 
> 赞同：1
> 
> 时间：2012-12-30T18:33:32.783
> 
> 标签：javascript, jquery, asp.net

由于我的项目有点超载`javascript`&`jQuery`脚本，我在尝试将其全部分成部分时遇到问题，......比如*分类*或*阶段*......

所以**在**这两个调用之前，它们是“当前项目”调用，

```
<head>
    //i am loading the jQuery & jQuery-UI... and then :

    // right after jQuery comes my first section of project
    <script type="text/javascript" src="jsV2\jQueryAjaxNoPostBack.js"></script>
    <script type="text/javascript" src="jsV2\stage1.js" ></script>
    <script type="text/javascript">
            // is valid in stage1.js , naturally...
            var jsTxtVal = document.getElementById("TBX_TableSelectorFirstStage");

            //and that won't work
            var jQueryTxtVal= $('#TBX_TableSelectorFirstStage').val();
    </script>
</head> 
```

在那个单独的文件中我尝试

```
//stage1.js

//---- before ready()-------
//won't work
var jQueryTxtVal= $('#TBX_TableSelectorFirstStage').val();

//works 
var jsTxtVal = document.getElementById("TBX_TableSelectorFirstStage");

$('document').ready(function () {

var TBX_TableSel = $('#TBX_TableSelectorFirstStage');
var jQueryTxtVal= $('#TBX_TableSelectorFirstStage').val();
var jsTxtVal = document.getElementById("TBX_TableSelectorFirstStage");

$('.someElement's Class).click(function () {

    // this will not work unless i will assign "jQueryTxtVal" right here .

    alert(jQueryTxtVal);

   //and... this will work no matter where the assignment took place .
   //either in main page (i call it "the globlas" of project)
   //or at the top of every "section" of project...

    alert(jsTxtVal );

   }); 
```

现在如果我使用 *plain* `JavaScript`，我什至可以为所有方法放置一段全局变量......几乎在任何地方，比如在`<sctipt></srctipt>`jquery下，在主页`.aspx`

所以我想知道，**我如何在 jQuery 中使用“全局变量”？** 或者它只是那个用例（？）..我不这么认为......

...我也尝试过`defer="defer"`通话`stage1.js`，在 head-main 页面内`.aspx` 我没有尝试成功

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:45:02.607

我认为问题在于您的线路：

```
var jQueryTxtVal= $('#TBX_TableSelectorFirstStage').val(); 
```

在 jQuery 文档就绪处理程序之外，几乎可以肯定在 dom 就绪之前执行。

尝试将其放入您的处理程序中。这也将有助于您的代码，因为变量 jQueryTxtVal 将是就绪处理函数的本地变量，并且不会污染全局范围（您应该真正避免的事情）

有很多模式可以帮助最小化全局范围内的变量，例如简单命名空间模式。但本质上，变量作用域就是函数作用域。

# php - 使用 AJAX 时未正确转义引号

> ID：14093411
> 
> 赞同：0
> 
> 时间：2012-12-30T18:33:40.960
> 
> 标签：php, html, mysql, ajax

这个 javascript/AJAX 在我的本地主机服务器上运行，但是当我将它移动到共享主机时，它现在会在 MySQL 调用中的非对象上抛出一个调用成员函数 execute() 的错误。

的HTML：

```
onclick="showTrending('page_views DESC', 'product.active= &quot;y&quot; 
AND product.deleted= &quot;n&quot; ', '12', 'popular')" 
```

然后是javascript：

```
function showTrending(mysql_order, mysql_limit, limit, trend)
{
$.ajax({ type: "POST", 
url: '/ajax/product_trending.php', 
data: {Mysql_Order: mysql_order, Mysql_Limit: mysql_limit, Limit: limit},
cache: false, 
success: function(result) {
 // if productSubType array is defined and has at least one element, display subcategory list
if(result != 0){... 
```

以及在出错的 AJAX 中调用的 PHP 文件：

```
//Retrieve subcategories for supplied product type
if(isset($_POST['Mysql_Order']) && isset($_POST['Mysql_Limit']) 
&& isset($_POST['Limit'])){
$mysql_order = $_POST['Mysql_Order'];
$mysql_limit = $_POST['Mysql_Limit'];
$limit = $_POST['Limit'];
//Overlay for wishlist
if(!isset($_SESSION['email'])){
    $item_wishlist = NULL;
} else{
    $item_wishlist = $_SESSION['id'];
}
//Get product records from db
require_once($GLOBALS['domain'].'includes/connection.inc.php');
$db = dbConnect();
$stmt = $db->stmt_init();

$stmt = $db->prepare("SELECT product.id, product.image_thumb, product.title,
    product.eng_title, product.price, seller.shop_name, seller.id FROM product 
    INNER JOIN seller ON product.seller_id=seller.id WHERE $mysql_limit ORDER BY
    $mysql_order LIMIT 0,$limit"); <-- This is the part that errors

$stmt->execute();
$stmt->bind_result($row['product_id'], $row['image_thumb'], $row['title'],
    $row['eng_title'], $row['price'], $row['shop_name'], $row['seller_id']);
$counter = 0;
$product_array = array();
while ($stmt->fetch()){
    ...store variables
    $counter++;
}
if($counter > 0){
    echo json_encode($product_array);
}else{
    echo json_encode(0);
}
} 
```

问题是当我插入从 HTML 传递的 POST 变量时，我没有正确准备 MySQL 字符串。如果我只为 MySQL 编写以下内容，我测试并确认它可以工作：

```
"SELECT product.id, product.image_thumb, product.title,
 product.eng_title, product.price, seller.shop_name, seller.id FROM product 
 INNER JOIN seller ON product.seller_id=seller.id WHERE product.active= 'y' 
AND product.deleted= 'n' ORDER BY
 page_views DESC LIMIT 0,12" 
```

我应该如何正确编写初始 HTML 调用，以便在 MySQL 中获得所需的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:39:53.867

您的主机可能有一个古老的 PHP 功能，称为`magic_quotes`启用，它会导致所有 GET/POST/etc 数据自动转义。这是（一种非常糟糕的）防止 SQL 注入的方法，现在已被弃用。

你的脚本有一个明显的 SQL 注入漏洞，这个特性确实在“保护”你免受它的侵害。重写您的脚本，以便不会将任何用户输入按原样添加到 SQL 字符串中 - 最好使用参数化查询（google it）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T18:43:11.273

我想提请您注意`$mysql_order`受 SQL 注入的影响。

仅仅因为您使用准备好的语句并不意味着查询是安全的。您需要为`$mysql_order part`.

# php - 如何在数据库中查询 IP - 错误

> ID：14093412
> 
> 赞同：3
> 
> 时间：2012-12-30T18:34:06.340
> 
> 标签：php, database, email, if-statement, ip

我正在努力做到这一点，如果他们的 IP 在数据库中，那么他们就无法发送电子邮件。在 php54_errors 文件中它说

```
[30-Dec-2012 18:25:26 Europe/Dublin] PHP Warning:  mysql_num_rows() expects parameter 1 to be resource, string given in C:\inetpub\wwwroot\Submit.php on line 6
[30-Dec-2012 18:25:26 Europe/Dublin] PHP Warning:  mysql_num_rows() expects parameter 1 to be resource, null given in C:\inetpub\wwwroot\Submit.php on line 7 
```

我的 PHP 代码是这样的

```
<?php
include("connect.php");
mysql_select_db("ip", $con);
$ip = mysql_real_escape_string($_SERVER['REMOTE_ADDR']);
$query = "SELECT * FROM ip WHERE ip='$ip'";
$result = mysql_num_rows($query);
if (mysql_num_rows($result) > 0) {
    echo "You have already registered!";
}
else { 
    echo"Your request has been sent!";
    $to = "admin@prisoneternity.org.uk";
    $subject = "Guard Application";
    $from = "guardapplication@prisoneternity.org.uk";
    $headers = "From:" . $from;
    $message = "IGN = " . $_POST["Username"] . "</br>\n\nage = " . $_POST["age"] . "</br>\n\nreason = " . $_POST["reason"] . "</br>\n\nHow many times have they been guard = " . $_POST["guard"] . "</br>\n\nOther Details = " . $_POST["text"];
    mail($to,$subject,$message,$headers);
    header ("Location: index.php?email=yes");
    session_start();
    mysql_query("INSERT INTO ip (IP) VALUES ('$ip')");
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:37:37.747

```
$result = mysql_num_rows($query);
if (mysql_num_rows($result) > 0) { 
```

应该：

```
$result = mysql_query($query);
if (mysql_num_rows($result) > 0) { 
```

您没有运行`mysql_query()`，而是调用`mysql_num_rows()`了两次。简单事故=o）顺便说一句，您应该使用[PDO](http://us3.php.net/manual/en/book.pdo.php)或[MySQLi](http://us3.php.net/manual/en/book.mysqli.php)。

还：

```
echo"Your request has been sent!";
$to = "admin@prisoneternity.org.uk";
$subject = "Guard Application";
$from = "guardapplication@prisoneternity.org.uk";
$headers = "From:" . $from;
$message = "IGN = " . $_POST["Username"] . "</br>\n\nage = " . $_POST["age"] . "</br>\n\nreason = " . $_POST["reason"] . "</br>\n\nHow many times have they been guard = " . $_POST["guard"] . "</br>\n\nOther Details = " . $_POST["text"];
mail($to,$subject,$message,$headers);
header ("Location: index.php?email=yes");
session_start();
mysql_query("INSERT INTO ip (IP) VALUES ('$ip')"); 
```

应该：

```
$to = "admin@prisoneternity.org.uk";
$subject = "Guard Application";
$from = "guardapplication@prisoneternity.org.uk";
$headers = "From:" . $from;
$message = "IGN = " . $_POST["Username"] . "</br>\n\nage = " . $_POST["age"] . "</br>\n\nreason = " . $_POST["reason"] . "</br>\n\nHow many times have they been guard = " . $_POST["guard"] . "</br>\n\nOther Details = " . $_POST["text"];
mail($to,$subject,$message,$headers);
//header ("Location: index.php?email=yes");
session_start();
echo"Your request has been sent!";
mysql_query("INSERT INTO ip (IP) VALUES ('$ip')"); 
```

您不能在`header()`或之前回显内容`session_start()`，在您进行重定向时也不会看到回显的文本。你需要选择你想做什么。我评论了`header()`上面的内容，但你可以做相反的事情。还要确保清理所有`$_POST`值`\r`和`\n`字符，以防止[邮件头注入攻击](http://phpsense.com/2006/php-email-injection-attacks/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T18:35:49.293

在第二行，`mysql_num_rows`返回一个**整数**，因为`$result`变量已经在调用函数，如果这有意义的话。将其更改为：

```
$result = mysql_num_rows($query);
if ($result > 0) { 
```

此外，您没有运行查询：

```
$query = "SELECT * FROM ip WHERE ip='$ip'"; 
```

将上面的行更改为：

```
$query = mysql_query("SELECT * FROM ip WHERE ip='$ip'"); 
```

在旁注中，`mysql_*`函数已被弃用。我会切换到`PDO`or `MySQLi`— 示例可以在[PHP 手册](http://php.net/manual "PHP 手册")中找到。

# algorithm - 求模素数的倒数

> ID：14093417
> 
> 赞同：3
> 
> 时间：2012-12-30T18:34:34.447
> 
> 标签：algorithm

我正在考虑一种算法来解决`ax = 1 mod p`与 p 素数的一致性。我正在考虑使用费马定理。既然我知道

`a ^ (p-1) = 1 mod p`

然后

`a ^ (p-1) = a * (a ^ (p-2))`

这意味着这`a ^ (p-2) mod p`就是解决方案。不幸的是，这个解决方案虽然在数学上是正确的，但对计算机来说并不好，因为对于大素数我必须这样做`a ^ (p-2)`，这通常是不可计算的。

哪种算法适合计算机科学？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-30T20:10:18.177

> 因为对于大素数我必须做`a ^ (p-2)`这通常是不可计算的。

您需要模幂运算，因此[通过 IVlad 提到的](https://stackoverflow.com/a/14093610/1011995)[平方求幂运算](http://en.wikipedia.org/wiki/Exponentiation_by_squaring) ，您最多只需要大小数的模乘。中间结果以 为界，因此尽管对于大素数不可计算，但通常是。该方法很容易实现：`Θ(log p)``p-1``p^2``a^(p-2)``(a ^ (p-2)) % p`

```
unsigned long long invert_mod(unsigned long long a, unsigned long long p) {
    unsigned long long ex = p-2, result = 1;
    while (ex > 0) {
        if (ex % 2 == 1) {
            result = (result*a) % p;
        }
        a = (a*a) % p;
        ex /= 2;
    }
    return result;
} 
```

但有一些缺点。`(p-1)^2`必须在使用的类型中可以表示（如果使用任意精度整数，这不是问题[除了**巨大的** `p`]），否则由于溢出而导致无效结果，并且它始终至少使用`log (p-2)/log 2`模乘。

[如user448810 所建议](https://stackoverflow.com/a/14093613/1011995)的扩展欧几里得算法，或等效的连分数法，永远不会产生大于 的中间值`p`，从而避免所有溢出问题，如果`p`是可表示的，并且通常需要更少的除法。此外，它不仅计算素数的模逆，还计算任何两个互素数的模逆。

```
unsigned long long invert_mod(unsigned long long a, unsigned long long p) {
    unsigned long long new = 1, old = 0, q = p, r, h;
    int pos = 0;
    while (a > 0) {
        r = q%a;
        q = q/a;
        h = q*new + old;
        old = new;
        new = h;
        q = a;
        a = r;
        pos = !pos;
    }
    return pos ? old : (p - old);
} 
```

代码稍长，但优化编译器应该将其编译为一个短循环，每次迭代只使用一个除法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-30T18:58:33.657

计算模逆的通常方法是通过扩展欧几里得算法：

```
function inverse(x, m)
    a, b, u := 0, m, 1
    while x > 0
        q, r := divide(b, x)
        x, a, b, u := b % x, u, x, a - q * u
    if b == 1 return a % m
    error "must be coprime" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T18:57:22.440

没有理由这对计算机来说不是一个好的算法，你只需要小心实现，我猜这并不是微不足道的，但也不难。

只需[通过平方使用取幂](http://en.wikipedia.org/wiki/Exponentiation_by_squaring)，那么它的大小很可能无关紧要`p`。

```
a^n = a^(n / 2) * a^(n / 2) for n even
    = a*a^(n - 1) for n odd 
```

# html - 为背景图像着色

> ID：14093418
> 
> 赞同：1
> 
> 时间：2012-12-30T18:34:41.513
> 
> 标签：html, css

我需要根据 rgb 值对便利贴图像（就像[这里的这个）进行着色。](http://www.rodsbot.com/images_maps_cache/3363-map-assoc.jpg)

我的问题如下：图像的外部部分需要是透明的，因为图像放置在不同背景颜色的前面。

其次，我需要将图像的当前黄色更改为给定的 rgb 值。（非动画）

我首先考虑使图像的黄色部分也透明，然后在其上放置一个彩色元素。但这也会使外部部分着色，这些部分应该与文档背景色保持一致。

有什么想法吗？

在此先感谢，沃伊采克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:53:20.757

`<canvas>`您可以通过为元素中绘制的图像着色来做到这一点。（参见[此处](https://stackoverflow.com/questions/2688961/how-do-i-tint-an-image-with-html5-canvas)的示例），然后生成可用于显示图像的数据 URI。

不确定这可以用纯 CSS 完成，但我很想被证明是错误的 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T00:40:14.297

感谢您的快速建议！

我相信它们也会起作用。[但我在这里](http://webdesignandsuch.com/posts/css3-post-it/index.html)遇到了另一个对我有用的好解决方案。

完全是 CSS，但它当然不像我之前尝试的那样使用图像。

# php - 如果数据库连接在配置文件中，PDO 准备好的语句将停止重定向

> ID：14093420
> 
> 赞同：3
> 
> 时间：2012-12-30T18:34:47.923
> 
> 标签：php, redirect, pdo, dbconnection

当数据库连接位于单独的文件 (config.php) 中时，PDO 准备好的语句停止重定向。查询正常工作（即正确插入等），并且当数据库连接在文档中而不是在单独的文件中时重定向工作正常，但是当数据库连接移动到另一个文件时它停止工作。它不会抛出任何错误消息。

为了排除类似问题中提到的其他问题（错误消息和 URL 路径）。我还删除了错误消息（因此它绝对不会在文档中打印任何内容）并尝试用完整的 URL 替换相对路径。当错误报告打开时，它被包装在一个 try/catch 块中，如图所示。

**更新 -** 下面的代码有效，但如果我`$conn = new PDO...`用`require_once('config.php');`它替换不再重定向（无论是否设置错误消息）。我还删除了任何可能导致问题的额外空格，以及关闭？>。

我还尝试在 catch 语句之前和之后进行重定向（以及删除 try/catch 块）

```
<?php
session_start();  

$conn = new PDO('mysql:host=localhost;dbname=click2fit', 'db_username', 'DB_Password');

try {
      $stmt = $conn->prepare('INSERT INTO customer_info (user_id, fname, lname) 
        VALUES(:user_id, :fname, :lname)');

        $stmt->bindParam(':user_id', $user_id);   
        $stmt->bindParam(':fname', $_POST['fname'], PDO::PARAM_STR);   
        $stmt->bindParam(':lname', $_POST['lname'], PDO::PARAM_STR);

       $stmt->execute(); 

      header("location: page2.html");         
      exit();
 } catch(PDOException $e) {
  echo 'Error: ' . $e->getMessage();
} 
```

配置.php：

```
<?php 
  $conn = new PDO('mysql:host=localhost;dbname=click2fit', 'db_username', 'DB_Password');
?> 
```

打开错误报告的 config.php：

```
<?php

  $salt = "XXXXXXXXXXXXXXXXXXX";

  try {
   $conn = new PDO('mysql:host=localhost;dbname=click2fit', 'db_username', 'DB_Password');
    $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
} catch(PDOException $e) {
echo 'ERROR: ' . $e->getMessage();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:20:51.470

我终于发现这个问题是由 UTF-8 编码页面的一个已知问题引起的，有时会在页面/包含文件的顶部创建一行额外的代码[（链接到 w3.org 对此问题的解释）](http://www.w3.org/International/questions/qa-utf8-bom.en.php)，因为这些不可见删除任何可见空格并不能纠正它。我什至不知道这是在任何地方设置的，因为我使用过的所有 Web 开发环境（Visual Web Developer 和其他几个）都会自动将文档保存为 UTF-8。

我发现的最佳解决方案是将文件在文本编辑器中保存为不带 BOM 的 UTF-8。在 Notepad++ 或 Visual Studio/Visual Web Developer（我使用的两个文本编辑器）中执行此操作的方法是：

*   **Notepad++ -**单击编码选项卡下的“转换为不带 BOM 的 UTF-8”选项，然后重新保存文档。
*   **Visual Studio/Visual Web Developer Express 2010 -**使用高级保存选项以正确的 UTF-8 编码进行保存 - Unicode（无签名的 UTF-8） - 代码页 65001。为了访问 Visual Web Developer Express 中的高级保存选项，选择“另存为”，然后单击“保存”按钮上的小向下箭头以“使用编码保存”。

当我从 php 回显到 html 文档时，我还必须更改 HTML 文档中的字符集以避免出现奇怪的字符。

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

它似乎适用于 html 中设置的 utf-8 和 PHP 中的 No BOM，但如果您也想在 HTML 中使用 No BOM，我发现 3 个在 Firefox 中有效的语法选项：charset=utf-8无物料清单；字符集=UTF-8 无 BOM；charset=UTF-8 encoding without BOM *（一旦我有机会测试代码，我会更新它）。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T21:03:21.143

您很有可能在函数之前将输出发送到浏览器`header()`，这会导致重定向失败。

您应该将查询包装在一个[`try/catch`](http://php.net/manual/en/language.exceptions.php)块中，以确保您正确处理和记录任何可能引发的[PDO 异常。](http://php.net/manual/en/class.pdoexception.php)

至于调试问题，请使用您的日志文件和/或`die("here")`浏览代码是我能提供的最好的，无需更多详细信息。您可能需要查看 apache/IIS 日志文件以查找任何异常。

最后，摆脱关闭`?>`以确保不会将空格输出到浏览器（您提到您已经清理了它，但这是您应该遵循的最佳实践）

# c# - 根据属性将元素反序列化为属性

> ID：14093422
> 
> 赞同：3
> 
> 时间：2012-12-30T18:35:06.963
> 
> 标签：c#, xml, serialization

我正在寻找是否有一种简单的方法可以将充满元素的 XML 文件反序列化回一类属性，特别是在元素属性“名称”上作为要附加到的属性。例如，我有一个 XML 文件格式，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<settings>
  <setting name="number_val_one">1</setting>
  <setting name="string_val_one">test</setting>
  <setting name="number_val_two">42</setting>
  <setting name="string_val_two">hello world</setting>
</settings> 
```

我想知道是否有一种简单的方法可以将其反序列化回类似于这种格式的类：

```
public class SomeObject
{
    [XmlElement("number_value_one")]
    public Int32 NumberValueOne { get; set; }

    [XmlElement("number_value_two")]
    public Int32 NumberValueTwo { get; set; }

    [XmlElement("string_value_one")]
    public String StringValueOne { get; set; }

    [XmlElement("string_value_two")]
    public String StringValueTwo { get; set; }
} 
```

我知道该格式不是序列化的最佳格式，但我无法更改该项目的文件格式。目前我正在手动读取每个元素的值，这是很多代码并且相当混乱。要将其序列化回 xml，我使用反射来解决手动编写每个元素的需要。但我想知道是否有一种简单的方法来处理这种格式。

并非所有元素都是字符串/整数，但有些是在读取后要解析的自定义类型等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T19:51:26.730

一方面，您可以使用 xslt 将输入字符串转换为可识别的数据`XmlSerializer`。

```
var transform = new XslCompiledTransform();
transform.Load(XmlReader.Create(new StringReader(transformText)));
var memoryStream = new MemoryStream();
transform.Transform(new XPathDocument(new StringReader(text)),null,memoryStream);
memoryStream.Seek(0, SeekOrigin.Begin);
var deserializer = new XmlSerializer(typeof(SomeObject)).Deserialize(memoryStream); 
```

在哪里

```
 var transformText = @"
<xsl:stylesheet version=""1.0"" xmlns:xsl=""http://www.w3.org/1999/XSL/Transform"">
    <xsl:output method=""xml"" encoding=""utf-8"" indent=""no""/>
    <xsl:template match=""/"">
        <SomeObject>
            <xsl:for-each select=""settings/setting"">
                <xsl:element name=""{@name}"">
                    <xsl:value-of select="".""/>
                </xsl:element>
            </xsl:for-each>
        </SomeObject>   
    </xsl:template>
</xsl:stylesheet>"; 
```

和

```
 var text = @"
<settings>
    <setting name=""number_val_one"">1</setting>
    <setting name=""string_val_one"">test</setting>
    <setting name=""number_val_two"">42</setting>
    <setting name=""string_val_two"">hello world</setting>
</settings>"; 
```

请注意，属性值必须与应用于`setting` `name`属性相匹配。`XmlElementAttribute`

如果您不了解 xslt，请搜索它，那里有很多示例和[参考资料](http://www.w3schools.com/xsl/xsl_w3celementref.asp)。

# css-float - 100% 宽度的 div 与框阴影重叠父 div

> ID：14093423
> 
> 赞同：0
> 
> 时间：2012-12-30T18:35:11.087
> 
> 标签：css-float, css, fluid-layout

我有一个居中的容器 div，里面目前有 3 个其他 div。它们都有盒子阴影（因此添加了大约 5px 的边距）。

我遇到的问题是第一个 div(upcoming) 是 100% 宽度，并且在右侧被切断（`overflow: hidden`设置）。或者它溢出它包含一点 div 。这没关系，但下面的其他 2 个 div 浮动并并排，因此不会溢出一点（如果大小设置为超过可用空间，则最近的 div 移动到最新的下方）。

填充没有帮助。除了将宽度设置为 98% 之外，还有其他解决方案吗？

这是我正在使用的CSS：

```
.mainSection{
    width:1020px;
    margin:70px auto 0px auto;
}

.widget{
    background-color:rgba(255, 255, 255, 0.5);
    -webkit-box-shadow:0 0 5px 2px #CCC;
    -moz-box-shadow:0 0 5px 2px #CCC;
    box-shadow:0 0 5px 2px #CCC;
    border:1px solid #CCC;
    margin:4px;
    overflow:hidden;
}

/* 3 child divs */

.widget.upcoming{
    float:left;
    width:100%;
    height:380px;
}

.widget.recent{
    float:right;
    width:260px;
    height:auto;
}

.widget.latest{
    float:left;
    width:740px;
    height:460px;
}

<section class="mainSection">
    <article class="widget upcoming">
        <header>
            <h3>Upcoming</h3>
        </header>
    </article>
    <article class="widget news">
        <article>
            <p>Some text</p>
        </article>
    </article>
    <article class="widget latest">
        <header>
            <h3>Latest</h3>
        </header>
    </article>
    <aside class="widget recent">
        <header>
            <h3>Recent</h3>
        </header>
    </aside>    
</section> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:35:16.643

所以如果我们改变改变

```
.widget.upcoming{
   float:left;
   width:100%;
   height:380px;
} 
```

至

```
 .widget.upcoming{
    height:380px;
 } 
```

我认为它应该工作

[http://jsbin.com/uharax/1](http://jsbin.com/uharax/1)

# jquery - 触发依赖下拉列表的ajax调用

> ID：14093426
> 
> 赞同：0
> 
> 时间：2012-12-30T18:35:19.867
> 
> 标签：jquery, ajax, yii

如何从 jquery 触发 ajax 调用？如果我在脚本中设置 $("select#country_id").prop("selectedIndex", idx); 和 POS::END 它在 jquery 之前用于下拉列表。我需要从下拉列表中选择一些项目，另一个列表填充数据。

```
 echo CHtml::dropDownList('country_id','', array(1=>'USA',2=>'France',3=>'Japan'),
       array(
        'ajax' => array(
          'type'=>'POST', //request type
          'url'=>CController::createUrl('currentController/dynamiccities'), 
          'update'=>'#city_id', //selector to update
    ))); 

   empty since it will be filled by the other dropdown
   echo CHtml::dropDownList('city_id','', array());

 <script type="text/javascript">

 $(function(){

  var idx = "<?php echo $smth ?>";
  $("select#country_id").prop("selectedIndex", idx);

 }) 

</script>

<script type="text/javascript">
  /*<![CDATA[*/
  jQuery(function($) {
  jQuery('a.tooltip').tooltip({'placement':'bottom'});
  jQuery('a[rel="popover"]').popover();
  $('body').on('change','#country_id',function(){jQuery.ajax({'type':'POST','url':'/currentController/dynamiccities','cache':false,'data':jQuery(this).parents("form").serialize(),'success':function(html){jQuery("#city_id").html(html)}});return false;});
  });
  /*]]>*/
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T00:10:28.717

我是否正确理解您要在更新下拉列表后选择该项目？

所以，首先，当您手动编写 jQuery 触发器并使用[dropDownList 时](http://www.yiiframework.com/doc/api/1.1/CHtml#dropDownList-detail)。你应该选择其中之一。我的回答是假设您正在手动编写 javascript，但这也可以很容易地放在 ajax 数组中以传递给`dropDownList`.

您是正确的，您当前的 jQuery 在您尝试执行的 AJAX 之前执行。 `idx`可以提前设置，但必须在填充下拉列表后设置所选选项，这就是我们将其移至您的成功功能的原因。您当前拥有它的方式（在 中`$(function(){`），将该脚本块放置在文档中准备就绪 -`$(function(){`是 真正的简写`$(document).ready(function() {`，这意味着该函数中的任何脚本都将在文档准备就绪时运行（而不是在您使用 AJAX 更新 DOM 时） . 可以在文档中阅读有关速记的详细信息，就在[Rate Me: Using AJAX](http://docs.jquery.com/Tutorials%3aGetting_Started_with_jQuery#Rate_me%3a_Using_Ajax)部分之前。

要让您的 javascript 按需要工作，请删除第一个`<script>`块并将第二个块更改为：

```
<script type="text/javascript">
  /*<![CDATA[*/
  var idx = "<?php echo $smth ?>";
  jQuery(function($) {
  jQuery('a.tooltip').tooltip({'placement':'bottom'});
  jQuery('a[rel="popover"]').popover();
  $('body').on('change','#country_id',
    function(){
        jQuery.ajax({'type':'POST',
                     'url':'/currentController/dynamiccities',
                     'cache':false,
                     'data':jQuery(this).parents("form").serialize(),
                     'success': function(html){
                                    jQuery("#city_id").html(html);
                                    jQuery("#country_id").prop("selectedIndex", idx);
                                }

                    });
        return false;});
  });
  /*]]>*/
</script> 
```

请注意，这仅`$smth`在您正在填充的下拉列表中确实是选项的索引时才有效。

就个人而言，如果我这样做，而不是使用 prop()，我会使用 attr() 和下拉列表的值，因为这比索引更容易跟踪，并执行以下操作：

```
<script type="text/javascript">
  /*<![CDATA[*/
  jQuery(function($) {
  jQuery('a.tooltip').tooltip({'placement':'bottom'});
  jQuery('a[rel="popover"]').popover();
  $('body').on('change','#country_id',
    function(){
        jQuery.ajax({'type':'POST',
                     'url':'/currentController/dynamiccities',
                     'cache':false,
                     'data':jQuery(this).parents("form").serialize(),
                     'success': function(html){
                                    jQuery("#city_id").html(html);
                                    var selectedCountry = "#country_id option[value='" + <?php echo $countryID ?> + "']";
                                    jQuery(selectedCountry).attr('selected', 'selected');
                                }

                    });
        return false;});
  });
  /*]]>*/
</script> 
```

更有可能的是，我会在 PHP 中执行此服务器端，并确保我为下拉菜单传回的 HTML 已经选择了正确的选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T08:55:02.353

谢谢ernie，你帮我处理这段代码。在我从下拉列表中选择某些项目后，您的代码试图（从同一个 ddl）选择某些内容。我写了类似的东西，它的工作原理。整个事情是关于在加载页面上选择值，然后我得到第二个 ddl 填充。

```
<script type="text/javascript">
  /*<![CDATA[*/
  var idx = "<?php echo $smth ?>";
  jQuery(function($) {
  jQuery('a.tooltip').tooltip({'placement':'bottom'});
  jQuery('a[rel="popover"]').popover();
  $('body').on('change','#country_id',
    function(){
        jQuery.ajax({'type':'POST',
                     'url':'/currentController/dynamiccities',
                     'cache':false,
                     'data':jQuery(this).parents("form").serialize(),
                     'success': function(html){
                                    jQuery("#city_id").html(html);
                                }

                    });
        return false;});

   if (idx!="")
   {
    jQuery("#country_id").prop("selectedIndex", idx);
    $('#country_id').trigger('change');
   }

  });
  /*]]>*/
</script> 
```

# actionscript-3 - 如何使用 Flash、Socket.IO 和 NodeJS 修复这个（可能）跨域策略错误

> ID：14093429
> 
> 赞同：0
> 
> 时间：2012-12-30T18:35:52.677
> 
> 标签：actionscript-3, node.js, cross-domain, socket.io

```
Error #2044: Unhandled SecurityErrorEvent:. text=Error #2048: Security sandbox violation: http://kipos.bluecodestudio.com/holdthebomb/HoldTheBombWeb.swf cannot load data from http://23.29.126.76:8000/socket.io/1/?t=1356891827452.
    at io::Socket/doHandshake()[/Users/airrider3/github/AS3-Socket.IO-XHR-Polling/xhr-polling/src/io/Socket.as:139]
    at io::Socket/connect()[/Users/airrider3/github/AS3-Socket.IO-XHR-Polling/xhr-polling/src/io/Socket.as:110]
    at io::Socket()[/Users/airrider3/github/AS3-Socket.IO-XHR-Polling/xhr-polling/src/io/Socket.as:90]
    at io::IO$/connect()[/Users/airrider3/github/AS3-Socket.IO-XHR-Polling/xhr-polling/src/io/IO.as:36]
    at MainController/endOfbluecodeSplash()[/Users/airrider3/Dropbox/Projects/Kipos/Minigames/HoldTheBombWeb/src/MainController.as:41]
    at bluecodeSplash/endOfSplash()[/Users/airrider3/Dropbox/Projects/Kipos/Minigames/HoldTheBombWeb/src/bluecodeSplash.as:55]
    at Function/http://adobe.com/AS3/2006/builtin::apply()
    at com.greensock.core::TweenCore/complete()[D:\_Flash\_AS3\src\com\greensock\core\TweenCore.as:178]
    at com.greensock::TweenLite/renderTime()[D:\_Flash\_AS3\src\com\greensock\TweenLite.as:477]
    at com.greensock.core::SimpleTimeline/renderTime()[D:\_Flash\_AS3\src\com\greensock\core\SimpleTimeline.as:93]
    at com.greensock::TweenLite$/updateAll()[D:\_Flash\_AS3\src\com\greensock\TweenLite.as:642] 
```

我正在使用 Flash Builder，这是一个 ActionScript 项目，它使用 Socket.IO 模块连接到运行 NodeJS 的服务器。

要将 Socket.IO 与 AS3 连接，我正在使用以下库[https://github.com/sbquinlan/AS3-Socket.IO-XHR-Polling](https://github.com/sbquinlan/AS3-Socket.IO-XHR-Polling) ，该库在本地测试时从 Flash Builder 中完美运行。

但是，如果托管在我的域[[http://kipos.bluecodestudio.com/holdthebomb/]](http://kipos.bluecodestudio.com/holdthebomb/)上，我想它会引发这个 SecurityErrorEvent 因为我没有正确使用任何 crossdomain.xml 文件？老实说，我从来没有与这个话题相处过，所以我不确定这是否是错误。

无论如何，我有以下 crossdomain.xml 文件：

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM "/xml/dtds/cross-domain-policy.dtd">
<cross-domain-policy>
   <site-control permitted-cross-domain-policies="master-only"/>
   <allow-access-from domain="*" to-ports="*"/>
</cross-domain-policy> 
```

我在服务器上的不同地方都有它。（应该在托管客户端上吗？）。是的，游戏托管在 bluecodestudio.com 上，而游戏的服务器在 IP 23.29.126.76 上，在端口 8000 上运行。

如果是跨域策略错误的情况，是否有人愿意解释应该采取什么措施来解决问题？

感谢您的关注。

**更新1：**

我设置了一个监听 843 端口的服务器，提供跨域文件，但我可以看到 Flash 没有尝试加载它。（我测试了命令`python -c 'print "<policy-file-request/>%c" % 0' | nc 23.29.126.76 843`并检查了策略服务器确实是如何工作的。

**为什么 SWF 不尝试加载跨域策略文件？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T18:54:56.170

跨域策略文件应该托管在运行服务器的机器上，即 23.29.126.76。对于套接字连接，Flash 播放器自动尝试从端口 843 加载主跨域策略文件（您可以从 adobe.com [http://www.adobe.com/cn/devnet/flashplayer/articles/socket_policy_files.html](http://www.adobe.com/cn/devnet/flashplayer/articles/socket_policy_files.html)获取简单的策略服务器脚本)

UPD：用于`Security.loadPolicyFile("xmlsocket://23.29.126.76:843");`直接加载策略文件，但正如我编写的 flash player 已经自动执行相同操作（对于端口 843），它发送字符串 request `"<policy-file-request/>\0"`。

**调试策略**

要调试策略服务器，请执行以下操作：

1.  确保您有[调试 Flash 播放器](http://www.adobe.com/support/flashplayer/downloads.html)。

2.  通过以下命令检查服务器安装是否正确（Windows 上的 linux、mac 或 cygwin）`echo -ne '<policy-file-request/>\0' | nc -v host port`：. 此命令应打印出您的 crossdomain.xml 文件

3.  `PolicyFileLog=1`通过在[mm.cfg](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf69084-7fc9.html)文件中设置 flag 来打开 flash player 策略日志（确保你有 flash player 的[调试版本](http://www.adobe.com/support/flashplayer/downloads.html)），运行 swf 文件并读取策略日志，它具有用户友好的格式，你将能够图在大多数情况下，通过此日志解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T18:38:48.427

哇。我刚刚在 Socket.IO 文档上阅读了这个：“flash policy port defaults to 10843

默认情况下，Socket.IO 客户端将检查服务器上的端口 10843 以查看是否允许 flashsocket 连接。Adobe Flash Player 通常使用 843 作为默认端口，但我们决定默认为非根端口。”

所以这就是为什么它没有尝试从端口 843 加载文件......

来源：[https ://github.com/LearnBoost/Socket.IO/wiki/Configuring-Socket.IO](https://github.com/LearnBoost/Socket.IO/wiki/Configuring-Socket.IO)

# algorithm - 快速排序和枢轴随机化

> ID：14093430
> 
> 赞同：-3
> 
> 时间：2012-12-30T18:35:57.373
> 
> 标签：algorithm, language-agnostic, quicksort

> **可能重复：**
> [快速排序：选择枢轴](https://stackoverflow.com/questions/164163/quicksort-choosing-the-pivot)

我读了一份声明：

> 如果枢轴不是随机的，则快速排序的性能落在已经排序/几乎排序的列表上。

请帮忙解释一下。我可能会期待更多的比较 - 但不会有更多的交换。我认为快速排序的最坏情况是对倒排数组进行排序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:58:37.573

我认为您有一个像 {29, 24, 20, 19, 16, ...} 这样的数字序列，该算法发现它是一个单调递减序列，如果我们想要升序排序，只需反转序列更有效.

# android - 旋转后，onCreate() Fragment 在 onCreate() FragmentActivity 之前被调用

> ID：14093438
> 
> 赞同：59
> 
> 时间：2012-12-30T18:36:35.517
> 
> 标签：android, android-fragments, oncreate, android-fragmentactivity, android-support-library

我正在使用 FragmentActivity 和 Fragments。

应用程序启动时：

```
FragmentActivity onCreate() <------
FragmentActivity onStart()
FragmentActivity onResume()
Fragment onAttach()
Fragment onCreate() <------
Fragment onCreateView()
Fragment onActivityCreated()
Fragment onStart()
Fragment onResume() 
```

一切正常，FragmentActivity onCreate() 在 Fragment onCreate() 之前被调用。当我旋转时：

```
Fragment onPause()
FragmentActivity onPause()
Fragment onStop()
FragmentActivity onStop()
Fragment onDestroyView()
Fragment onDestroy()
Fragment onDetach()
FragmentActivity onDestroy()
---
Fragment onAttach()
Fragment onCreate() <----------
FragmentActivity onCreate() <---------
Fragment onCreateView()
Fragment onActivityCreated()
Fragment onStart()
FragmentActivity onStart()
FragmentActivity onResume()
Fragment onResume() 
```

在 FragmentActivity onCreate() 之前调用 Fragment onCreate()。为什么不一致？

在 FragmentActivity onCreate() 我生成了一些数据，这些数据是 Fragment onCreate() 得到的。由于这种奇怪的行为，我不得不将我的代码从 Fragment onCreate() 移动到 Fragment onCreateView() 以确保我的数据之前已经生成。

我正在使用 FragmentStatePagerAdapter 来保存 Fragment，也许这就是原因？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-12-30T18:42:29.270

[`onActivityCreated()`](http://developer.android.com/reference/android/app/Fragment.html#onActivityCreated%28android.os.Bundle%29)在 Fragment 的生命周期中调用之前，您不应指望有效的 Activity 。

> 当片段的活动被创建并且这个片段的视图层次被实例化时调用。一旦这些部分到位，它就可以用来进行最终初始化，例如检索视图或恢复状态。

重建顺序不是线性的确切原因，我不能告诉你。允许每个组件以自己的速度重新启动而不是强制执行严格的命令可能更有效。例如，我希望我的 LoaderManager 尽早启动，我们稍后会担心它的内容*布局*。

（我喜欢好的图表。）

![在此处输入图像描述](../Images/f4d595867c0894edb43e76a8e76c0e84.png "图表！")

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2015-05-13T18:45:06.510

在 Activity 的`onCreate()`. 但重要的是，它们在基 Activity 类的`onCreate()`. 因此，如果您`super.onCreate()`先调用，则您的方法的所有其余部分`onCreate()`将在您的 Fragments 恢复后执行。

一种可能的解决方案是在调用***之前***恢复您的状态或计算您的 Fragment 需要的数据`super.onCreate()`

生命周期如下所示：

```
ACTIVITY onCreate (pre-super)
FRAGMENT onAttach
ACTIVITY onCreate (post-super) 
```

所以做这样的事情：

```
@Override
public void onCreate( final Bundle savedInstanceState )
{
    Log.d( TAG, "ACTIVITY onCreate (pre-super)" );
    // Do your processing here
    super.onCreate( savedInstanceState ); // Fragments will be restored here
    Log.d( TAG, "ACTIVITY onCreate (post-super)" );
} 
```

# monodevelop - 如何在 MonoDevelop 中启动一个新的 Vala 项目？

> ID：14093444
> 
> 赞同：2
> 
> 时间：2012-12-30T18:36:50.497
> 
> 标签：monodevelop, vala

我有 Ubuntu 12.04、MonoDevelop 2.8 和一些`valac`. 我知道 MD 支持 Vala 语言，但实际上我没有看到任何对 Vala 的支持。如果 C 解决方案是从头开始制作的，那么 GCC 将用于构建项目，因此该过程显然会失败。但是没有选择 Vala 解决方案的选项。

知道如何在那种环境中开始吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T16:08:01.750

MonoDevelop 的 Vala 插件在一个单独的包中。

# php - json_decode() 不适用于这个有效的 JSON 字符串

> ID：14093445
> 
> 赞同：1
> 
> 时间：2012-12-30T18:36:54.987
> 
> 标签：php, json, escaping, postmark

这是我的应用从 Postmark（一种入站电子邮件递送服务）接收的 JSON 字符串：

```
{
  "From": "me@mydomain.com",
  "FromFull": {
    "Email": "me@mydomain.com",
    "Name": "Jack"
  },
  "To": "\"test@email.mydomain.com\" <test@email.mydomain.com>",
  "ToFull": [
    {
      "Email": "test@email.mydomain.com",
      "Name": "test@email.mydomain.com"
    }
  ],
  "Cc": "",
  "CcFull": [],
  "ReplyTo": "",
  "Subject": "Brussel Sprouts",
  "MessageID": "a97fb074-338e-48c5-97db-d9c5155e9307",
  "Date": "Sun, 30 Dec 2012 18:10:54 +0000",
  "MailboxHash": "",
  "TextBody": "Are Nice",
  "HtmlBody": "",
  "Tag": "",
  "Headers": [
    {
      "Name": "X-Spam-Checker-Version",
      "Value": "SpamAssassin 3.3.1 (2010-03-16) onrs-iad-pm-inbound1.wildbit.com"
    },
    {
      "Name": "X-Spam-Status",
      "Value": "No"
    },
    {
      "Name": "X-Spam-Score",
      "Value": "0.0"
    },
    {
      "Name": "X-Spam-Tests",
      "Value": "RCVD_IN_DNSWL_BLOCKED"
    },
    {
      "Name": "Received-SPF",
      "Value": "None (no SPF record) identity=mailfrom; client-ip=209.85.212.175; helo=mail-wi0-f175.google.com; envelope-from=me@mydomain.com; receiver=test@email.mydomain.com.com"
    },
    {
      "Name": "X-Google-DKIM-Signature",
      "Value": "v=1; a=rsa-sha256; c=relaxed\/relaxed;        d=google.com; s=20120113;        h=x-received:from:content-type:content-transfer-encoding:subject         :message-id:date:to:mime-version:x-mailer:x-gm-message-state;        bh=JrLpPQqTnp0QixED2qZ5+zepXQXuPLJWqihFECt8uJ4=;        b=EJHac6BaGi3laxnMZZ3Lf\/ervtavKTG0+DHXRRCfGH2HSG42wN\/qIj6IQ0G36NFsjT         x2tnYRhj7aBRseky+YEyAF99kUOx\/p8qaCWo7wN1cf3dTJUrrQu\/vrdgdXezfheKW49z         x4\/d\/8f2bgJN5MvTtZj15WmqZRCDt8\/QJVZvP7J5hANdxqULgwAJCaCJFU3CTNu66nT+         M1tPSDfZwTdNsS70Pna75Y3bRtlJPxXF6gesYhXK\/cnDbqsCopcAiEc9guMVMnqAjIRu         XqBWLft4Bom5H2ViNj5V\/A3GCmP44h\/OM1h+h2zBTYJ3fJK4zyluok8K5GIjn9KN1o2w         v4eA=="
    },
    {
      "Name": "X-Received",
      "Value": "by 10.180.72.146 with SMTP id d18mr51711599wiv.33.1356891056971;        Sun, 30 Dec 2012 10:10:56 -0800 (PST)"
    },
    {
      "Name": "Content-Transfer-Encoding",
      "Value": "7bit"
    },
    {
      "Name": "Message-Id",
      "Value": "<224B85F9-B9C2-4273-A81C-7C340E8A66B2@mydomain.com>"
    },
    {
      "Name": "Mime-Version",
      "Value": "1.0 (Mac OS X Mail 6.2 \\(1499\\))"
    },
    {
      "Name": "X-Mailer",
      "Value": "Apple Mail (2.1499)"
    },
    {
      "Name": "X-Gm-Message-State",
      "Value": "ALoCoQl0eQmrBNRNbe7T06oTeDXcEA3LDLJurR2U0Yj64EyOA2Iy3YL6CyiTodGXtuJHIuMlm5a1"
    }
  ],
  "Attachments": []
} 
```

将其复制到任何 JSON 验证器中，您将看到它是有效的。

但是，当我`json_decode();`在 PHP 中运行此字符串时，它会静默失败。运行`echo json_last_error();`时返回的错误代码是`4`. 这对应于语法错误。

通过在我的代码编辑器中简单地查找替换`\`，`\\`我可以让它工作，但我怎样才能让 PHP 自动做到这一点？

**编辑：**正如在评论中发现的那样，我在上面发布的确切字符串在从文件中读取时可以正常工作，因为 PHP 不会尝试解析任何反斜杠等。但是，它似乎在读取时解析斜杠`file_get_contents('php://input)`是什么现在给我带来了问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T18:41:59.573

您可以对变量执行此操作：

```
$json = str_replace('\\', '\\\\', $json); 
```

# java - 为什么以“/WEB-INF”开头的请求不能映射到servlet/filter

> ID：14093446
> 
> 赞同：3
> 
> 时间：2012-12-30T18:36:55.940
> 
> 标签：java, jakarta-ee, tomcat, web.xml

*[上下文] tomcat 7 - java 1.7*

嘿大家; 我正面临着陌生人的工作。在我的 web.xml 文件中，我映射了这样的请求：

**web.xml**

```
<web-app>
    <filter>
        <filter-name>filter</filter-name>
        <filter-class>demo.DemoFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>filter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <servlet>
        <servlet-name>Servlet</servlet-name>
        <servlet-class>demo.DemoServlet</servlet-class>
    </servlet>

    <servlet-mapping>
        <servlet-name>Servlet</servlet-name>
        <url-pattern>/*</url-pattern>
    </servlet-mapping>
</web-app> 
```

**DemoFilter.java**（实现过滤器）

```
@Override
public void doFilter( ServletRequest req, ServletResponse res, FilterChain chain )
        throws IOException, ServletException
{
    try
    {
        chain.doFilter(req, res);
    }
    catch ( Exception e )
    {
        System.err.println("error");
        ((HttpServletResponse) res).setContentType("text/html");
        ((HttpServletResponse) res).setStatus(HttpServletResponse.SC_NOT_FOUND);
        res.getWriter().write("foo");
    }
} 
```

**DemoServlet.java**（扩展 HttpServlet）

```
@Override
protected void doGet( HttpServletRequest req, HttpServletResponse resp )
        throws ServletException, IOException
{
    System.err.println(req.getRequestURI());
    throw new RuntimeException("ERROR");
} 
```

* * *

**[1 = 预期结果]**首先，当我尝试请求“/foo/bar”时，过滤器和 servlet 被调用（并且页面显示单词 'foo'）。控制台结果：

```
/foo/bar    
error 
```

**[2 = Unexpected result]**然后，当我尝试请求“/WEB-INF/foo/bar”时，什么都没有调用（我的过滤器和我的 servlet 没有被命中）并且我得到一个 Tomcat 错误报告：

```
HTTP Status 404 -

type Status report

message

description The requested resource is not available.
Apache Tomcat/7.0.30 
```

**编辑：**在这里，我希望得到以下结果：

```
/WEB-INF/foo/bar    
error 
```

* * *

我的目标是使用我的过滤器来处理异常（包括“/WEB-INF”调用）。

*   **为什么以“/WEB-INF/”开头的请求永远不会命中映射在“/*”模式上的过滤器/servlet？**
*   **我们如何解决这个问题？**

提前致谢！

***PS**：我想保留我当前的 web.xml 配置（“url-pattern”=“/*”；不使用“error-page”）*

* * *

**编辑**： **我的问题被误解了。我不想在我的“WEB-INF”目录下提供文件访问。我想用我的过滤器和 Servlet (url-pattern='/*') 来处理每个请求，即使请求 URI 以“/WEB-INF/”开头。谢谢 ！**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T22:22:51.250

这里有一个重大的概念误解。中的资源`/WEB-INF`根本无法公开访问。您提出问题的方式表明并非如此。这个不对。[我相信您只是以错误的方式询问了具体问题](https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem)。

根据评论，我了解到您想要记录访问的文件`/WEB-INF`以及 404 错误。我*猜*您实际上的意思是要在直接请求的资源旁边记录转发、包含和错误的资源。通常，转发和包含的资源确实是隐藏的，`/WEB-INF`以防止直接访问。

*默认情况下*，过滤器仅在直接请求的资源上调用，而不是在转发和包含的资源上，也不是在错误的资源上（如您的 404 尝试）。为此，您需要将适当的`<dispatcher>`条目添加到映射中：

```
<filter-mapping>
    <filter-name>filter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
    <dispatcher>INCLUDE</dispatcher>
    <dispatcher>ERROR</dispatcher>
</filter-mapping> 
```

*（它们中的每一个都是可选的；`REQUEST`完全不存在时是默认的）*

这样，过滤器不仅会拦截直接请求的资源，还会拦截转发、包含和错误的资源。调度程序也将`ERROR`使其启动 404 错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T18:41:51.083

WEB-INF 目录是 Web 应用程序的私有区域，WEB-INF 目录下的任何文件都不能通过像您指定的方式指定 URL 直接从浏览器访问。

Web 容器不会提供此目录的内容。但是，类可以访问此目录的内容，例如您在应用程序内的 web.xml 中映射的 servlet。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T18:42:22.700

如果要限制对某些文件的直接 URL 访问，请将它们放在 WEB-INF 目录下。

从这里引用： [http ://www.servletworld.com/servlet-tutorials/web-application-directory-structure.html](http://www.servletworld.com/servlet-tutorials/web-application-directory-structure.html)

> WEB-INF 目录是 Web 应用程序的私有区域，**WEB-INF 目录下的任何文件都不能通过指定 URL 直接从浏览器访问，**如`http://somesite/WEB-INF/someresource.html`. Web 容器不会提供此目录的内容。但是，应用程序中的类可以访问 WEB-INF 目录的内容。因此，如果您不希望从 Web 浏览器直接访问 JSP 或 HTML 文档等任何资源，则应将其放在 WEB-INF 目录下。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T19:01:45.000

发布的两个答案都是正确的，这对于您使用的任何应用程序服务器和 JDK 都是一样的。尽管从 servlet 规范 3.0 web.xml 是可选的，或者您可以使用 web-framgment.xml 来破坏 web.xml。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-21T19:30:37.990

根据 servlet 规范，来自客户端的任何访问 WEB-INF/ 目录中资源的请求都必须返回一个 SC_NOT_FOUND(404) 响应。请参阅第 10.5 节目录结构。

[https://download.oracle.com/otn-pub/jcp/servlet-3_1-fr-eval-spec/servlet-3_1-final.pdf](https://download.oracle.com/otn-pub/jcp/servlet-3_1-fr-eval-spec/servlet-3_1-final.pdf) [https://download.oracle.com/otn-pub/jcp/servlet -3.0-fr-eval-oth-JSpec/servlet-3_0-final-spec.pdf](https://download.oracle.com/otn-pub/jcp/servlet-3.0-fr-eval-oth-JSpec/servlet-3_0-final-spec.pdf)

# php - SQL查询，出现错误无法修复

> ID：14093449
> 
> 赞同：1
> 
> 时间：2012-12-30T18:37:23.520
> 
> 标签：php, sql

我收到此查询错误：

```
"SELECT username 
and password 
FROM users 
WHERE username = $email , password = $password" 
```

它返回此错误：

> 错误 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 ''users' WHERE username = $email , password = $password LIMIT 0, 30' 附近使用正确的语法

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T18:40:24.833

在 $email 和 $password 周围加上引号。并使用 AND 代替 WHERE 子句中的逗号。更像这样的东西：

```
$sql = "SELECT username, password 
FROM users 
WHERE username = '$email' AND password = '$password' LIMIT 1"
; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T18:40:38.517

您正在使用 , 而不是 and

```
 "SELECT username ,password 
    FROM users 
       WHERE username = $email and password = $password" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T18:39:52.223

`SELECT username,password FROM users WHERE username=$email AND password=$password`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T18:41:44.087

用这个：

```
"SELECT username, password 
FROM users 
WHERE username = '$email' AND password = '$password'" 
```

列名必须用逗号分隔，并且引号之间的字符串值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-30T18:42:36.430

引用文本参数。

如果可能，请使用**准备好的语句。**为了避免注射问题，这些更为可取。

# grep - Grep 只匹配第一场比赛并停止

> ID：14093452
> 
> 赞同：441
> 
> 时间：2012-12-30T18:37:47.653
> 
> 标签：grep

我正在使用带有以下参数的 grep 递归搜索目录，希望只返回第一个匹配项。不幸的是，它返回的不止一个——实际上是我上次查看时返回的两个。似乎我有太多的争论，尤其是没有得到想要的结果。：-/

```
# grep -o -a -m 1 -h -r "Pulsanti Operietur" /path/to/directory 
```

返回：

```
Pulsanti Operietur
Pulsanti Operietur 
```

也许 grep 不是最好的方法？你告诉我，非常感谢。

* * *

## 回答 #1

> 赞同：660
> 
> 时间：2012-12-30T18:44:04.450

`-m 1`表示返回任何给定文件中的第一个匹配项。但它仍会继续在其他文件中搜索。此外，如果在同一行中有两个或更多匹配，则将显示所有这些。

### 你可以使用`head -1`来解决这个问题：

```
grep -o -a -m 1 -h -r "Pulsanti Operietur" /path/to/dir | head -1 
```

### 每个 grep 选项的解释：

```
-o, --only-matching, print only the matched part of the line (instead of the entire line)
-a, --text, process a binary file as if it were text
-m 1, --max-count, stop reading a file after 1 matching line
-h, --no-filename, suppress the prefixing of file names on output
-r, --recursive, read all files under a directory recursively 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2016-10-20T11:03:37.853

您可以将`grep`结果`head`与**stdbuf**结合使用。

请注意，为了确保在第 N 次匹配后停止，您需要使用`stdbuf`以确保`grep`不缓冲其输出：

```
stdbuf -oL grep -rl 'pattern' * | head -n1
stdbuf -oL grep -o -a -m 1 -h -r "Pulsanti Operietur" /path/to/dir | head -n1
stdbuf -oL grep -nH -m 1 -R "django.conf.urls.defaults" * | head -n1 
```

一旦`head`消耗了 1 行，它就会终止并`grep`接收，因为它在消失`SIGPIPE`时仍然输出一些东西到管道。`head`

这假设没有文件名包含换行符。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-12-30T18:50:27.023

我的 grep-a-like 程序[`ack`](http://beyondgrep.com)有一个`-1`选项，可以在任何地方找到第一个匹配项时停止。它也支持`-m 1`@mvp 所指的内容。我把它放在那里是因为如果我正在搜索一棵大树的源代码以找到我知道只存在于一个文件中的东西，那么没有必要找到它并且必须按 Ctrl-C。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2020-01-30T05:02:33.597

如果要在当前目录中出现特定单词时要打印整行和文件名，则可以使用以下命令。

```
grep -m 1 -r "Not caching" * | head -1 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2021-11-04T01:24:34.147

对于像我一样登陆这里的任何人，对于为什么`--max-count`在采取行动时似乎没有工作感到困惑`stdin`......

**TL;DR** -找到匹配项后*不会*`--max-count n`停止，它会在找到*行**上的*所有匹配项后停止。*`n`*`n`**

 *（而且`stdin`，即使它只是一个字符串，也算作一行。）

尽管事实上，`zsh 5.8`至少在`man grep`中以这种方式描述了该选项，但这是正确的：

```
-m num, --max-count=num
        Stop reading the file after num matches. 
```

**更长的解释**

就我而言，我试图仅获取相对路径的第一部分：

```
>  echo "some/path/here" | grep -E -o -m 1 '[^\/]+' 
```

当它把我还给我的时候很困惑

```
some
path
here 
```

感谢上面@harperville 的评论，我终于明白了：这不是关于*输出*，而是关于*输入*。

确实，当我尝试

```
>  echo "some/path/here\nanother/path/there" | grep -E -o -m 1 '[^\/]+' 
```

我得到了与上面相同的结果（即，仅`\n`在第二个示例中之前的部分）。

**笔记**

对于那些不太熟悉的人`grep`：

*   `-E`( `--extended-regexp`) 告诉它使用“扩展的”正则表达式，即您在大多数其他编程语言中习惯使用的正则表达式。“扩展”和“基本”之间的区别并不大——只是你需要在你的正则表达式中转义哪些字符——但作为主要是 TS 和 Python 开发人员的人，我总是使用`-E`这种方式，因为我不需要思考关于它。（专业提示：添加`alias grep="grep -E"`到您的`.zshrc`，您将永远不必再担心它！）
*   `-o`( `--only-matching`) 告诉它只打印匹配项，而不是找到匹配项的每一行。
*   `-m n`( `--max-count n`) 将其限制为搜索`n`行。（如果你已经读到这里，那么你显然已经知道了！）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2021-03-08T13:22:38.917

阅读 grep 手册（man grep），这是查找与扩展正则表达式的第一个匹配项的最少命令。获取我笔记本电脑中的以太网名称不是 eth0 的示例！

```
$ ifconfing | grep -E -o -m 1 "^[a-z0-9]+" 
```

说明：-E 表示扩展正则表达式，-o 只返回匹配项，-m 1 只看一行

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-02-02T16:40:47.760

单个衬里，使用`find`：

```
find -type f -exec grep -lm1 "PATTERN" {} \; -a -quit 
```*

# javascript - 比较 Div 值

> ID：14093454
> 
> 赞同：1
> 
> 时间：2012-12-30T18:37:58.933
> 
> 标签：javascript, jquery

我想创建一个网页，如果切尔西的进球数比阿森纳多，切尔西的得分就会增加 1，反之亦然。它不工作，我不知道为什么 - 然后我几天前才开始学习 JS/JQ。

代码有什么问题？另请注意，控制台中从未记录任何内容。:(

```
$(document).ready(function() {
    $("#play").click(function(){
            var chelsea = parseInt($('#chelsea-goals').val());
            var arsenal = parseInt($('#arsenal-goals').val());
        if (chelsea > arsenal) {
            parseInt($('#score-chelsea').val())++;
            console.log('Chelsea > Arsenal');
        }
        else if (arsenal > chelsea) {
            parseInt($('#score-arsenal').val())++;
            console.log('Arsenal > Chelsea');
        }
        else {
            console.log('Scores were equal');
        }       
   });
}); 
```

还请原谅格式 - 它在我的代码中是正确的 - 在这里看起来不太好。

**更新**

```
<div class="scores" id="score-chelsea">0</div>
<div class="scores" id="score-arsenal">0</div>
<div class="goals" id="chelsea-goals">{{chelsea.goals}}</div>
<div class="goals" id="arsenal-goals">{{arsenal.goals}}</div>
<button id ="play"></button> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T18:42:34.830

你不能增加一个`parseInt()`函数。将这些行更改为

```
$('#score-chelsea').val( parseInt( $('#score-chelsea').val() ) + 1 ); 
```

...与`#score-arsenal`.

演示：http: [//jsfiddle.net/2SVpE/](http://jsfiddle.net/2SVpE/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T18:43:29.927

以下行是导致问题的原因 -

```
parseInt($('#score-chelsea').val())++; 
```

你根本不能那样做......函数`parseInt`返回值。它不包含对您从中提取值的元素的引用。您需要先将该值放入变量中...

你会想做这样的事情

```
var increasedGoals = parseInt($('#score-chelsea').val());
increasesGoals++; 
```

的其他外观也是如此`parseInt(...)++`。

* * *

这里值得一提的是选择器缓存。您不止一次地使用选择器，那么为什么不缓存它们呢
`$('#score-chelsea')`！`$('#score-arsenal')`

```
$("#play").on('click',function(){
  var chelsea = $('#chelsea-goals');
  var arsenal = $('#arsenal-goals');
  ...
  var chelseaGoals = chelseaElement.val();
  chelseaGoals++;
  chelsea.val(chelseaGoals);
  ...
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T19:02:29.470

1）div的内容不等同于javascript中的变量，所以你不能像这样获取它的内容并对其调用++。您必须获取内容（将作为字符串获取）将其转换为数字（parseInt 部分），然后对其进行数学运算，然后使用新值设置 div 的内容（将自动转换为回到一个字符串，这就是你不必做那部分的原因）。

2）使用 .text() 而不是 .val()，.val() 用于表单字段的内容，而不用于 div 的内容（.html() 也可以，它获取整个 HTML 内容，而不仅仅是文本，在这种情况下，只有文本是整个 HTML 内容......所以它们的行为相同）。

```
var ch_goals = parseInt($('#score-chelsea').text());
ch_goals++;
$('#score-chelsea').text(ch_goals); 
```

这更好地概述了该过程，尽管有更短的方法来编写它，例如：

```
$('#score-chelsea').text( parseInt($('#score-chelsea').text())+1 ); 
```

# mongodb - 在 mongodb 的集合上调用 find() 函数时限制要返回的文档数

> ID：14093457
> 
> 赞同：0
> 
> 时间：2012-12-30T18:38:15.597
> 
> 标签：mongodb, find, document, node-mongodb-native

正如我的问题所暗示的，我想限制在这样`find()`的集合上调用函数时显示的文档数量：

```
exports.findAll = function(req, res) {
db.collection('temp', function(err, collection) {
        collection.find().toArray(function(err, items) {
            res.send(items);
        });
    });
}; 
```

上面的代码将显示临时集合中存在的所有文档。但是有没有办法可以将显示的文档数量限制为 10？我想发送最后十份文件（我的意思是最近添加的文件）

我真的很感激任何建议。

提前非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:52:50.100

find() 方法返回一个数据库游标。数据库游标有一个[`limit(n)`](http://docs.mongodb.org/master/reference/method/cursor.limit/)方法，它返回另一个仅迭代前 n 个文档的数据库游标。因此，您只需将第 3 行替换为：

```
collection.find().limit(10).toArray(function(err, items) { 
```

请注意，无法确定这 10 个文档将被任何可预测的优先级选中。通常是插入顺序，但这不能保证。所以你应该在前面`limit(n)`加上适当的[`.sort(your_sort_criterias)`](http://docs.mongodb.org/master/reference/method/cursor.sort/).

# mod-rewrite - urlrewriting 和 mod_auth_token (apache 模块)

> ID：14093459
> 
> 赞同：1
> 
> 时间：2012-12-30T18:38:32.100
> 
> 标签：mod-rewrite

我想重写一个 URL，如：

我的目标： `http://monsite.com/my_other_files/55e35373739efc04a34d408c7c28a7b9/50e084f6/my_video.mp4`

我的真实路径： `http://monsite.com/my_files/55e35373739efc04a34d408c7c28a7b9/50e084f6/my_video.mp4`

我的代码`.htaccess`：

```
RewriteRule ^my_other_files/([a-zA-z0-9_-]/[a-zA-z0-9_-]/[a-zA-z0-9_-]*)$
   my_files/$1/$2/$3 [QSA,L] 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:53:47.543

老实说，你快到了。

您需要重写规则中的前导`/`，并且您不允许每个路径组件中有多个字符。

尝试：

```
RewriteRule ^/my_other_files/([0-9a-f]+)/([0-9a-f]+)/([a-z0-9_.-]+)$
    /my_files/$1/$2/$3 [QSA,NC,L] 
```

我添加`[NC]`到最后，所以它不区分大小写，并添加`.`到最后一个组，所以它会匹配类似`my_video.mp4`

此外，看起来您的路径组件都是十六进制的，所以我对其进行了一些简化。如果这不是我的准确假设，请尝试以下方法：

```
RewriteRule ^/my_other_files/([a-z0-9_-]+)/([a-z0-9_-]+)/([a-z0-9_.-]+)$
    /my_files/$1/$2/$3 [QSA,NC,L] 
```

在这两种情况下，我都添加了换行符以提高可读性；这不应该存在于您的实际规则中。

另一种方法是接受任何内容`/my_other_files/`并将其重定向到`/myfiles/`，在这种情况下，您可以使用以下规则：

```
RewriteRule ^/my_other_files/(.+)$ /my_files/$1 [QSA,NC,L] 
```

我希望你能解决这个问题！:o)

# ios - 是否可以让 youtube iFrame api 在 iOS 上运行？

> ID：14093465
> 
> 赞同：0
> 
> 时间：2012-12-30T18:39:21.540
> 
> 标签：ios, youtube-api

有谁知道是否可以让 youtube iFrame API 在 iOS 上运行？

我可以通过创建本机应用程序并在 UIWebView 上设置适当的标志以启用自动播放来绕过 iOS*自动播放*限制，但是，即使这样做了，用于设置播放位置的操作（例如，seek 和 loadVideoById）根本不会工作。不清楚 Apple 或 Google 是否有人正在研究此问题，或者是否有解决办法？

# android - 显示地图错误

> ID：14093470
> 
> 赞同：0
> 
> 时间：2012-12-30T18:40:21.930
> 
> 标签：android, google-maps

尝试在我的项目中使用 MapView 显示地图时收到此错误消息。我已经注册了 Map API v1 密钥很长时间，并且我还使用我的指纹重新生成了 apikey，但我仍然收到错误消息“：**无法获取连接工厂客户端**”。

这是我的开发环境：android ver.:2.3.3 jre:1.6

下面的代码也包含在我的 AndroidManifest.xml 中

```
 <uses-library android:name="com.google.android.maps"/>       
<uses-permission android:name="android.permission.INTERNET" /> 
```

[我想知道哪里出了问题，因为该项目实际上是我书中的示例代码，可以下载[这里][1] - 标题是“Chap8-Where Am I 4”。](http://www.wrox.com/WileyCDA/WroxTitle/Professional-Android-2-Application-Development.productCd-0470565527,descCd-DOWNLOAD.html)

```
W/System.err(10003): IOException processing: 26
java.io.IOException: Server returned: 3
at android_maps_conflict_avoidance.com.google.googlenav.map.BaseTileRequest.readResponseData(BaseTileRequest.java:115)
at android_maps_conflict_avoidance.com.google.googlenav.map.MapService$MapTileRequest.readResponseData(MapService.java:1473)
at android_maps_conflict_avoidance.com.google.googlenav.datarequest.DataRequestDispatcher.processDataRequest(DataRequestDispatcher.java:1117)
at android_maps_conflict_avoidance.com.google.googlenav.datarequest.DataRequestDispatcher.serviceRequests(DataRequestDispatcher.java:994)
at android_maps_conflict_avoidance.com.google.googlenav.datarequest.DataRequestDispatcher$DispatcherServer.run(DataRequestDispatcher.java:1702) 
```

# parsing - 如何加快日期/时间解析？

> ID：14093471
> 
> 赞同：1
> 
> 时间：2012-12-30T18:40:23.227
> 
> 标签：parsing, matlab, csv

我有一个相当大的 CSV，我想将其导入 MATLAB。我曾经将日期时间值视为文本，并且解析速度很快。现在我已经开始使用格式字符串了`datetime`，解析需要将近一分钟的时间——不是很多，但很烦人。

我可以做些什么来加快导入数据工具中使用的日期时间解析？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T15:40:18.377

我建议编写一个函数来导入 CSV，而不是使用数据导入工具。这将允许您将导入和解析数据的过程拆分为两个不同的过程。然后，您可以独立优化它们。

如果您无法使用内置日期解析方法获得所需的性能，您可能会考虑编写一个 mex 文件来为您解析文件。如果您对 mex 不满意，您可以使用比 Matlab 更快的语言（如 Python、Java 等）编写预处理代码。让这段代码将日期字符串转换为 Matlab 可以快速处理的格式。从 Matlab 调用此预处理代码，然后导入其结果。

最后，您必须决定是否值得您花时间加快 1 分钟的操作。如果您要每天多次调用此代码，那么加速它可能符合您的最大利益。如果您每周只调用几次，请继续。将导入所需的时间用作茶歇。

# php - 自动事件调度

> ID：14093474
> 
> 赞同：1
> 
> 时间：2012-12-30T18:40:40.450
> 
> 标签：php, sql, scheduled-tasks

我正在做一个有日常活动的项目。我想让它在某个时间删除事件，然后在第二天添加一个新事件。所有活动每天都在同一时间开始和结束。

我无权访问 MySQL 中的事件调度程序，并且我的主机不会打开它。

有没有办法做到这一点，这样我就不必每天安排活动（其中 19 个）？

# c++ - 找不到程序入口点？

> ID：14093479
> 
> 赞同：3
> 
> 时间：2012-12-30T18:41:33.627
> 
> 标签：c++, visual-studio-2010, linker, ffmpeg, dynamic-linking

我遇到了一个奇怪的问题。更新到最新的[ffmpeg headers/lib/dll](http://ffmpeg.zeranoe.com/builds/)后，我不断收到错误消息：

```
The procedure entry point __glewProgramUniform1i could not be located in the dynamic link library 
```

如果我更改为使用静态链接链接到 glew，那么该特定错误就会消失，而是抱怨其他一些 dll 中的一些其他过程入口点，依此类推。

一旦恢复到旧的 ffmpeg headers/lib/dll，问题就会消失。

什么可能导致这种行为？我该如何调试？

注意：这只发生在发布版本期间，而不是在调试版本期间。

![在此处输入图像描述](../Images/1a67e05dd5c171bfc7bd381fd6951438.png)

![在此处输入图像描述](../Images/6cff99dfea79771b283ff20aa206ee19.png)

取决于配置文件日志：

```
Started "CONHOST.EXE" (process 0x1BBC) at address 0x000007F63CF60000\.  Successfully hooked module.
Loaded "NTDLL.DLL" at address 0x000007F945C30000\.  Successfully hooked module.
Loaded "KERNEL32.DLL" at address 0x000007F943400000\.  Successfully hooked module.
Loaded "KERNELBASE.DLL" at address 0x000007F942D10000\.  Successfully hooked module.
DllMain(0x000007F942D10000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "KERNELBASE.DLL" called.
DllMain(0x000007F942D10000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "KERNELBASE.DLL" returned 1 (0x1).
DllMain(0x000007F943400000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "KERNEL32.DLL" called.
DllMain(0x000007F943400000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "KERNEL32.DLL" returned 1 (0x1).
Injected "DEPENDS.DLL" at address 0x000000005ACD0000.
DllMain(0x000000005ACD0000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "DEPENDS.DLL" called.
DllMain(0x000000005ACD0000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "DEPENDS.DLL" returned 1 (0x1).
Loaded "GDI32.DLL" at address 0x000007F945970000\.  Successfully hooked module.
Loaded "USER32.DLL" at address 0x000007F943860000\.  Successfully hooked module.
Loaded "MSVCRT.DLL" at address 0x000007F945430000\.  Successfully hooked module.
Loaded "IMM32.DLL" at address 0x000007F945320000\.  Successfully hooked module.
Loaded "OLEAUT32.DLL" at address 0x000007F9454E0000\.  Successfully hooked module.
Loaded "COMBASE.DLL" at address 0x000007F9457C0000\.  Successfully hooked module.
Loaded "MSCTF.DLL" at address 0x000007F944FD0000\.  Successfully hooked module.
Loaded "RPCRT4.DLL" at address 0x000007F944CF0000\.  Successfully hooked module.
Entrypoint reached. All implicit modules have been loaded.
DllMain(0x000007F943860000, DLL_PROCESS_ATTACH, 0x00000019CF36F8C0) in "USER32.DLL" called.
DllMain(0x000007F945430000, DLL_PROCESS_ATTACH, 0x00000019CF36F8C0) in "MSVCRT.DLL" called.
DllMain(0x000007F945430000, DLL_PROCESS_ATTACH, 0x00000019CF36F8C0) in "MSVCRT.DLL" returned 1 (0x1).
DllMain(0x000007F943860000, DLL_PROCESS_ATTACH, 0x00000019CF36F8C0) in "USER32.DLL" returned 1 (0x1).
DllMain(0x000007F945970000, DLL_PROCESS_ATTACH, 0x00000019CF36F8C0) in "GDI32.DLL" called.
DllMain(0x000007F945970000, DLL_PROCESS_ATTACH, 0x00000019CF36F8C0) in "GDI32.DLL" returned 1 (0x1).
DllMain(0x000007F944FD0000, DLL_PROCESS_ATTACH, 0x00000019CF36F8C0) in "MSCTF.DLL" called.
DllMain(0x000007F944FD0000, DLL_PROCESS_ATTACH, 0x00000019CF36F8C0) in "MSCTF.DLL" returned 1 (0x1).
DllMain(0x000007F945320000, DLL_PROCESS_ATTACH, 0x00000019CF36F8C0) in "IMM32.DLL" called.
DllMain(0x000007F945320000, DLL_PROCESS_ATTACH, 0x00000019CF36F8C0) in "IMM32.DLL" returned 1 (0x1).
DllMain(0x000007F944CF0000, DLL_PROCESS_ATTACH, 0x00000019CF36F8C0) in "RPCRT4.DLL" called.
DllMain(0x000007F944CF0000, DLL_PROCESS_ATTACH, 0x00000019CF36F8C0) in "RPCRT4.DLL" returned 1154577921 (0x44D17601).
DllMain(0x000007F9457C0000, DLL_PROCESS_ATTACH, 0x00000019CF36F8C0) in "COMBASE.DLL" called.
DllMain(0x000007F9457C0000, DLL_PROCESS_ATTACH, 0x00000019CF36F8C0) in "COMBASE.DLL" returned 1 (0x1).
DllMain(0x000007F9454E0000, DLL_PROCESS_ATTACH, 0x00000019CF36F8C0) in "OLEAUT32.DLL" called.
DllMain(0x000007F9454E0000, DLL_PROCESS_ATTACH, 0x00000019CF36F8C0) in "OLEAUT32.DLL" returned 1 (0x1).
Loaded "UXTHEME.DLL" at address 0x000007F941950000\.  Successfully hooked module.
DllMain(0x000007F941950000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "UXTHEME.DLL" called.
DllMain(0x000007F941950000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "UXTHEME.DLL" returned 1 (0x1).
Error writing a breakpoint at the entrypoint return of "".  Entrypoint cannot be hooked. Invalid access to memory location (998).
Loaded "" at address 0x00000019D1220000\.  Successfully hooked module.
Unloaded "" at address 0x00000019D1220000.
Loaded "START8_64.DLL" at address 0x000007F93A130000\.  Successfully hooked module.
DllMain(0x000007F93A130000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "START8_64.DLL" called.
GetProcAddress(0x000007F943860000 [USER32.DLL], "CreateWindowInBand") called from "START8_64.DLL" at address 0x000007F93A1C0941 and returned 0x000007F943872C20.
LoadLibraryA("ADVAPI32.dll") called from "START8_64.DLL" at address 0x000007F93A1A1D5C.
Loaded "ADVAPI32.DLL" at address 0x000007F944E40000\.  Successfully hooked module.
Loaded "SECHOST.DLL" at address 0x000007F9439B0000\.  Successfully hooked module.
DllMain(0x000007F9439B0000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "SECHOST.DLL" called.
DllMain(0x000007F9439B0000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "SECHOST.DLL" returned 1 (0x1).
DllMain(0x000007F944E40000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "ADVAPI32.DLL" called.
DllMain(0x000007F944E40000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "ADVAPI32.DLL" returned 1 (0x1).
LoadLibraryA("ADVAPI32.dll") returned 0x000007F944E40000.
GetProcAddress(0x000007F944E40000 [ADVAPI32.DLL], "RegOpenKeyExW") called from "START8_64.DLL" at address 0x000007F93A1A1E59 and returned 0x000007F944E413D0.
GetProcAddress(0x000007F944E40000 [ADVAPI32.DLL], "RegQueryValueExW") called from "START8_64.DLL" at address 0x000007F93A1A1E59 and returned 0x000007F944E413F0.
GetProcAddress(0x000007F944E40000 [ADVAPI32.DLL], "RegCloseKey") called from "START8_64.DLL" at address 0x000007F93A1A1E59 and returned 0x000007F944E413B0.
GetProcAddress(0x000007F943860000 [USER32.DLL], "GetWindowBand") called from "START8_64.DLL" at address 0x000007F93A1C0A91 and returned 0x000007F943863210.
GetProcAddress(0x000007F943860000 [USER32.DLL], "SetWindowBand") called from "START8_64.DLL" at address 0x000007F93A1C0AC1 and returned 0x000007F943872BB0.
DllMain(0x000007F93A130000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "START8_64.DLL" returned 1 (0x1).
Loaded "DWMAPI.DLL" at address 0x000007F941120000\.  Successfully hooked module.
DllMain(0x000007F941120000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "DWMAPI.DLL" called.
DllMain(0x000007F941120000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "DWMAPI.DLL" returned 1 (0x1).
Loaded "COMCTL32.DLL" at address 0x000007F940010000\.  Successfully hooked module.
DllMain(0x000007F940010000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "COMCTL32.DLL" called.
DllMain(0x000007F940010000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "COMCTL32.DLL" returned 1 (0x1).
Loaded "OLE32.DLL" at address 0x000007F945AB0000\.  Successfully hooked module.
DllMain(0x000007F945AB0000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "OLE32.DLL" called.
DllMain(0x000007F945AB0000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "OLE32.DLL" returned 1 (0x1).
Loaded "CRYPTBASE.DLL" at address 0x000007F9429A0000\.  Successfully hooked module.
Loaded "BCRYPTPRIMITIVES.DLL" at address 0x000007F942940000\.  Successfully hooked module.
DllMain(0x000007F942940000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "BCRYPTPRIMITIVES.DLL" called.
DllMain(0x000007F942940000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "BCRYPTPRIMITIVES.DLL" returned 1 (0x1).
DllMain(0x000007F9429A0000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "CRYPTBASE.DLL" called.
DllMain(0x000007F9429A0000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "CRYPTBASE.DLL" returned 1 (0x1).
Loaded "SHCORE.DLL" at address 0x000007F941D20000\.  Successfully hooked module.
DllMain(0x000007F941D20000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "SHCORE.DLL" called.
DllMain(0x000007F941D20000, DLL_PROCESS_ATTACH, 0x0000000000000000) in "SHCORE.DLL" returned 1 (0x1). 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:45:00.893

您很可能已经更新了 .h 和 .lib 文件，但链接到了过期的 DLL。确保您的程序链接到的 DLL 与 .h 和 .lib 文件匹配。

您可以通过在配置文件模式下运行 Dependency Walker 来调试程序加载时发生的情况。这将显示实际加载的 DLL 的完整路径，然后您将能够找出问题所在。

# xslt - 如何检测 XSLT 中的换行符

> ID：14093485
> 
> 赞同：2
> 
> 时间：2012-12-30T18:41:52.750
> 
> 标签：xslt, xpath

我需要能够输出由换行符分隔的 XML 文档的文本。换句话说，XML：

```
<programlisting>
public static void main(String[] args){
    System.out.println("Be happy!");  
    System.out.println("And now we add annotations.");  
}
</programlisting> 
```

需要表示为：

```
<para>public static void main(String[] args){</para>
<para>    System.out.println("Be happy!"); </para>
<para>    System.out.println("And now we add annotations.");  </para>
<para>}</para> 
```

我认为我应该能够使用 substring-before(., '\n') 但由于某种原因它无法识别换行符。

我还尝试将每一行输出为一个 CDATA 部分，以便我可以单独提取它们，但遇到了这样一个事实，即它们都被混合到一个文本节点中。

我只是在这里使用常规 Java 进行转换。关于如何做到这一点的任何想法？

谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T20:13:09.637

正如[这个答案](https://stackoverflow.com/questions/2265966/xml-carriage-return-encoding#2266166)中所解释的，XML 中的所有换行符都被视为实体`&#10;`。这意味着，要在换行符处拆分字符串，您必须在此实体处拆分。

因此，纯 XSLT 1.0（无扩展）中的解决方案可能如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    version="1.0">
  <xsl:output indent="yes"/>

  <xsl:template match="@*|node()">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="programlisting/text()">
    <xsl:param name="text" select="."/>
    <para>
      <!-- Because we would rely on $text containing a line break when using 
           substring-before($text,'&#10;') and the last line might not have a
           trailing line break, we append one before doing substring-before().  -->
      <xsl:value-of select="substring-before(concat($text,'&#10;'),'&#10;')"/>
    </para>
    <xsl:if test="contains($text,'&#10;')">
      <xsl:apply-templates select=".">
        <xsl:with-param name="text" select="substring-after($text,'&#10;')"/>
      </xsl:apply-templates>
    </xsl:if>
  </xsl:template>
</xsl:stylesheet> 
```

`<para>`对于给定的 XML 源，这会在第一个和最后一个换行符处输出一些空元素。也可以检查空行（如 Dimitre 所做的那样）。然而，这也会删除代码列表中间某处的空行。如果在开头和结尾删除空行很重要，而在中间保留空行，则需要一些更聪明的方法。

这只是表明使用普通 XSLT 1.0 完成这项任务并不困难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T18:52:48.930

**一、XSLT 2.0 解决方案**：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="text()">
  <xsl:for-each select="tokenize(., '\n\r?')[.]">
   <para><xsl:sequence select="."></xsl:sequence></para>
  </xsl:for-each>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<programlisting>
public static void main(String[] args){
    System.out.println("Be happy!");
    System.out.println("And now we add annotations.");
}
</programlisting> 
```

**产生了想要的正确结果：**

```
<programlisting>
   <para>public static void main(String[] args){</para>
   <para>    System.out.println("Be happy!");</para>
   <para>    System.out.println("And now we add annotations.");</para>
   <para>}</para>
</programlisting> 
```

* * *

**二、XSLT 1.0 解决方案，使用[FXSL](http://fxsl.sf.net)[`str-split-to-words`](http://fxsl.cvs.sourceforge.net/viewvc/fxsl/fxsl-xslt2/f/strSplit-to-Words.xsl?revision=1.2&view=markup)模板：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common" exclude-result-prefixes="ext">
  <xsl:import href="strSplit-to-Words.xsl"/>
  <xsl:output indent="yes" omit-xml-declaration="yes"/>

   <xsl:strip-space elements="*"/>
   <xsl:output indent="yes" omit-xml-declaration="yes"/>

   <xsl:param name="pDelims" select="'&#xA;&#xD;'"/>

    <xsl:template match="/">
      <xsl:variable name="vwordNodes">
        <xsl:call-template name="str-split-to-words">
          <xsl:with-param name="pStr" select="/"/>
          <xsl:with-param name="pDelimiters"
                          select="$pDelims"/>
        </xsl:call-template>
      </xsl:variable>

      <xsl:apply-templates select=
      "ext:node-set($vwordNodes)/*[normalize-space()]"/>
    </xsl:template>

    <xsl:template match="word">
      <para><xsl:value-of select="."/></para>
    </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于同一个 XML 文档（如上）时，会产生相同的正确结果**：

```
<para>public static void main(String[] args){</para>
<para>    System.out.println("Be happy!");</para>
<para>    System.out.println("And now we add annotations.");</para>
<para>}</para> 
```

# c# - 问题 SocketException 未处理

> ID：14093489
> 
> 赞同：1
> 
> 时间：2012-12-30T18:42:11.530
> 
> 标签：c#, socketexception

我在 csharp 做工作，在那里我制作了一个在数据库中注册用户的表单，所以当我打开这个表单按钮时，它是用来指代实际查看数据库中用户的数据，但它是对`SocketException`,我知道网络错误并且我的代码是正确的所以我不知道如何解决这个问题有人可以帮助我吗？

```
namespace exercicio_sharp_banco
{
    class banco_clientes
    {
        MySqlConnection conexao;
        MySqlCommand comando;
        MySqlDataAdapter captura;
        DataTable tabClientes;

        public void conectaBanco()
        {
            conexao = new MySqlConnection("server=localhost;user id=root;database=t3it1_dbdados");
            conexao.Open();//here and the warning
        }

        public DataTable mostraRegistros()
        {
            captura = new MySqlDataAdapter(comando);
            tabClientes = new DataTable();

            captura.Fill(tabClientes);
            return(tabClientes);
        }

        public void fechaBanco()
        {
            conexao.Close();
        }

        public void Consulta()
        {
            comando = new MySqlCommand("select * from clientes",conexao);
        }

        public void ConsultaPoa()
        {
            comando = new MySqlCommand("select * from clientes where cidade='Porto Alegre'",conexao);
        }

        public void ConsultaDinamica(string textoConsulta)
        {
            comando = new MySqlCommand("select * from clientes where cidade like '%" +textoConsulta +"%' ",conexao);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T20:53:47.100

这可能有几个原因：

*   您的防火墙阻止了您的 MySQL 服务器
*   您的 MySQL 服务器没有运行
*   您的 MySQL-Server 配置不正确

# wikipedia - 从 dbpedia（或维基百科）中提取“外部链接”数据的最快方法是什么？

> ID：14093496
> 
> 赞同：3
> 
> 时间：2012-12-30T18:42:37.577
> 
> 标签：wikipedia, dbpedia, wikipedia-api

我需要从 jquery（首选）或 php 的数组中获取特定维基百科文章的“外部链接”链接。我已经浏览了 wikipedia api，但似乎没有办法做到这一点。似乎有一种方法可以在 dbpedia 中执行此操作（dbpedia.org/resource/etc 页面显示“dbpedia-owl:wikiPageExternalLink”部分），但我从未使用过 sparkql，也不知道如何在与 jquery 或 php 结合使用。

谁能帮我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T19:07:12.467

在[http://dbpedia.org/sparql的 sparql 查询表单中尝试以下查询](http://dbpedia.org/sparql)

```
select ?link where 
{
 <http://dbpedia.org/resource/Rome> 
 <http://dbpedia.org/ontology/wikiPageExternalLink> 
 ?link
} LIMIT 100 
```

然后查看结果页面的浏览器地址栏，了解如何通过 GET 对查询进行编码。

否则你可以看看[http://json.it.dbpedia.org](http://json.it.dbpedia.org)

玩得开心！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:02:37.957

您可能正在寻找 prop=extlinks。

这是一个获取英语维基百科中“德国”文章中所有链接的示例：

[https://en.wikipedia.org/w/api.php?action=query&prop=extlinks&format=json&ellimit=5000&titles=德国](https://en.wikipedia.org/w/api.php?action=query&prop=extlinks&format=json&ellimit=5000&titles=Germany)

您可以使用 API 沙箱对其进行调整：[https](https://en.wikipedia.org/wiki/Special:ApiSandbox) ://en.wikipedia.org/wiki/Special:ApiSandbox 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T20:03:40.873

您可以单独使用带有文本版本的转储 [0]，然后解析文本。例如，您可以在“== External links ==”之后的文本中搜索外部链接，或者外部链接的其他模板[1]。

0 - [http://dumps.wikimedia.org/](http://dumps.wikimedia.org/)

1 - [http://en.wikipedia.org/wiki/Template:External_links](http://en.wikipedia.org/wiki/Template:External_links)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-22T10:49:57.847

如果你想从维基百科（从所有页面）中提取所有外部链接，有一个工具可以做到这一点：[wikipedia-externallinks-fast-extraction](https://github.com/lovasoa/wikipedia-externallinks-fast-extraction)

# magento - Magento：如何在应用目录规则的情况下获取产品价格

> ID：14093500
> 
> 赞同：19
> 
> 时间：2012-12-30T18:42:55.273
> 
> 标签：magento, e-commerce, catalog

我正在开发一个脚本（Magento 外部，而不是模块），旨在输出所有可用产品、它们的价格和其他一些属性的文本列表。但是，目录价格规则似乎不适用于产品价格。如果我使用以下任何一种：

```
$_product->getPrice()
$_product->getFinalPrice() 
```

我得到正常价格（没有应用规则）。

如果我使用：

```
$_product->getSpecialPrice() 
```

我得到**null**除非产品实际上在产品本身中插入了特价（即，如果特价与目录规则无关）。

我也试过

```
Mage::getModel('catalogrule/rule')->calcProductPriceRule($product,$product->getPrice()) 
```

正如 Fabian Blechschmidt 给出的答案中所建议的那样，但有趣的是，它仅在产品受任何目录规则影响时才返回正常价格，否则返回**null**。

前段时间在[StackOverflow](https://stackoverflow.com/questions/9684964/how-can-get-final-price-with-applied-price-rule-in-magento)和[Magento 论坛](http://www.magentocommerce.com/boards/viewthread/210839/#t398210)中有一个类似的问题，但提供的答案（即插入下面的代码）对我不起作用（返回的价格保持不变）。

```
Mage::app()->loadAreaPart(Mage_Core_Model_App_Area::AREA_FRONTEND,Mage_Core_Model_App_Area::PART_EVENTS); 
```

有人知道如何实现这一目标吗？

我正在使用 Magento 1.6.2.0。提前致谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-30T20:25:34.560

谢谢你，我找到了一个新网站： http: [//www.catgento.com/magento-useful-functions-cheatsheet/](http://www.catgento.com/magento-useful-functions-cheatsheet/)

他们提到：

```
Mage::getModel('catalogrule/rule')->calcProductPriceRule($product,$product->getPrice()) 
```

高温高压

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-31T00:12:38.497

由于目录价格规则在很大程度上取决于时间、商店和访问客户，因此当您想要检索应用了价格规则的产品最终价格时，您需要设置这些参数。

因此，在您的情况下，请确保提供的产品与所需的商店和客户组 id 一起传递，可以将其设置为：

```
Mage::getModel('catalogrule/rule')->calcProductPriceRule($product->setStoreId('STORE_ID')->setCustomerGroupId('CUSTOMER_GROUP_ID'),$product->getPrice()) 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-12-31T02:57:48.420

我发现了问题。折扣价格在商店前端显示 Ok。问题是我正在为 Magento 开发一个“外部”脚本（因此不是 Magento 模块），例如：

```
<?php

set_time_limit(0);
ignore_user_abort();
error_reporting(E_ALL^E_NOTICE);
header("Content-Type: text/plain; charset=utf-8");

require_once "app/Mage.php";

// Get default store code
$default_store = Mage::app()->getStore();
... 
```

为了让一切正常工作，似乎必须遵循适当的 Magento 引导程序，并将一切作为一个模块进行开发。我的脚本非常简单，以至于我认为没有必要编写一个完整的模块。换句话说，Magento 中的一切都应该是一个模块。

最后，使用模块方法，所有方法都按预期工作：

```
$_product->getPrice()
$_product->getFinalPrice()
$_product->getSpecialPrice() 
```

谢谢大家的意见。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-04-23T23:11:43.133

这在这个问题上帮助了我：http: [//www.magentocommerce.com/boards/viewthread/176883/](http://www.magentocommerce.com/boards/viewthread/176883/) 。Jernej 的解决方案似乎是合理的，但它不处理通过使用“停止处理”覆盖其他规则的规则，因此可以应用多个规则。

```
$original_price = $_product->getPrice();
$store_id = 1; // Use the default store
$discounted_price = Mage::getResourceModel('catalogrule/rule')->getRulePrice( 
                        Mage::app()->getLocale()->storeTimeStamp($store_id), 
                        Mage::app()->getStore($store_id)->getWebsiteId(), 
                        Mage::getSingleton('customer/session')->getCustomerGroupId(), 
                        $_product->getId());

// if the product isn't discounted then default back to the original price
if ($discounted_price===false) {
    $discounted_price=$original_price;
} 
```

# git - 如何从 Heroku 上的另一个仓库“监听”生产分支？

> ID：14093502
> 
> 赞同：0
> 
> 时间：2012-12-30T18:43:04.933
> 
> 标签：git, node.js, heroku, hook, production

最近我正在使用 Heroku 来托管和部署一些 Node.js 应用程序，它非常适合我使用“git push”来上传所有内容并将其投入生产。

现在，我想知道如何将我的 Heroku 应用程序与另一个 git repo（即 github）链接，并“监听”生产分支以仅在正式版本中保持生产？

感谢您有一个愉快的一天。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T18:49:20.850

最简单的方法是使用为此目的设计的服务。[Strider](https://striderapp.com/)就是一个例子。

为此，您可以设置一个主机来响应来自 GitHub 的 post-receive 钩子，然后推送到 Heroku。

# javascript - 如何在 turn.js 中禁用剥离（悬停效果）？

> ID：14093505
> 
> 赞同：7
> 
> 时间：2012-12-30T18:43:18.000
> 
> 标签：javascript, turnjs

我不想要 turn.js 中的悬停动画。试过这个：

```
$('#flipbook').turn({
    width: 400,
    height: 300,
});

$('#flipbook').turn('peel', false);​ 
```

任何形式的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-11-25T09:43:21.163

我用这个：

```
flipbook.bind('start', 
    function (event, pageObject, corner)
    {
        if (corner == 'tl' || corner == 'tr' || corner == 'bl' || corner == 'br')
        {
            event.preventDefault();
        }
    }
); 
```

现在，它永远不会显示剥离效果:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-05T09:32:35.203

```
 corners = {
    backward: [],
    forward: [],
    all: []
  }, 
```

这应该可以解决您的问题。

# php - htaccess 仅使用 png、jpg 扩展名重写 url

> ID：14093506
> 
> 赞同：0
> 
> 时间：2012-12-30T18:43:29.583
> 
> 标签：php, image, .htaccess, rewrite, file-type

愚蠢的问题

怎么能放：

```
RewriteRule ^$ index.php?url=$1&%{QUERY_STRING} [QSA] 
```

进入 ：

```
RewriteRule ^$ index.php?url=*.(jpe?g|png|bmp)&%{QUERY_STRING} [QSA] 
```

重写网址 `http://site.com/folder/index.php?url=123.jpg&do=xxx`

至

`http://site.com/folder/123.jpg?do=xxx`

第一条规则可以做到这一点，但我需要阻止 gif 文件

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T19:14:11.503

因此，您希望允许浏览器向现有查询字符串提供类似`folder/123.jpg`（或 .gif、.png、.bmp）的图像 URL 并附加：`index.php?url=123.jpg`

```
RewriteEngine On
RewriteRule ^folder/([^.]+)\.(jpg|jpeg|png|bmp)$ folder/index.php?url=$1.$2 [L,QSA] 
```

该模式`([^.]+)`捕获到 in 的所有内容`.`，`$1`并且将扩展捕获到`$2`. `[QSA]`将附加现有的查询字符串`do=xxx`，而无需您手动附加它。

这可以在 Apache2 中使用非捕获组进行简化，`(?:)`因此整个事情都被`$1`.

```
RewriteRule ^folder/([^.]+\.(?:jpg|jpeg|png|bmp))$ folder/index.php?url=$1 [L,QSA] 
```

或者您可以有条件地应用它：

```
# If the request ends in .jpg, .bmp, .png...
RewriteCond %{REQUEST_URI} \.(jpe?g|bmp|png)$
RewriteRule ^folder/(.*)$ folder/index.php?url=$1 [L,QSA] 
```

# android - 使用 am start 命令/ADB shell 登录 Facebook 应用程序

> ID：14093509
> 
> 赞同：2
> 
> 时间：2012-12-30T18:43:53.307
> 
> 标签：android, facebook, android-intent, android-activity, adb

我想使用 am start 命令从 android shell 登录 Facebook 应用程序。

```
 am start -n com.facebook.katana/.LoginActivity 
```

该命令会调出 facebook 登录屏幕。但是如何填写电子邮件和密码字段并将其作为 android shell 的一行命令提交？

我已经尝试了以下......

```
 am start -n com.facebook.katana/.LoginActivity -e email my@email.com -e password mypassword 
```

无济于事，但我可能不正确理解附加功能的用法。

此外，如果我已经登录，这些命令可以完美运行

```
 am start -a android.intent.action.VIEW -d fb://notifications
     am start -a android.intent.action.VIEW -d fb://messages
     am start -a android.intent.action.VIEW -d fb://events 
```

但我想允许多人使用我的流程访问他们的 Facebook 帐户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T22:06:24.520

我认为您不能通过将用户名/密码附加信息传递给 Fb LoginActivity 来登录。

看一下 LoginActivity 的源代码，它不处理传递给它以进行身份​​验证的额外参数。

[https://github.com/facebook/facebook-android-sdk/blob/master/facebook/src/com/facebook/LoginActivity.java](https://github.com/facebook/facebook-android-sdk/blob/master/facebook/src/com/facebook/LoginActivity.java)

Fb 文档也没有记录您所询问的行为。

[https://developers.facebook.com/docs/reference/android/3.0/LoginActivity/](https://developers.facebook.com/docs/reference/android/3.0/LoginActivity/)

# python - 如何只使用一次 python 的选择？

> ID：14093510
> 
> 赞同：0
> 
> 时间：2012-12-30T18:43:54.893
> 
> 标签：python, list

考虑以下：

我正在使用 python 为我的家人制作一个明年的秘密圣诞老人脚本，虽然我已经知道如何绘制名字（见下面的代码），但我只需要执行一次。我打算使用烧瓶框架来创建一个页面倒计时直到抽奖的天数（我也想通了），但是我怎么做才能让它抽奖，只有一次，而不是每次有人登录到那个页面？明白我的意思吗？

无论如何，我会在这里向您展示我的代码：

```
# imports & initial Flask set up above

def do_matchup(names, draw, matches=None):
   if matches is None:
      matches = []

   while names:
       member = names.pop()
       recipient = choice(draw)

       if recipient != member:
           matches.append("%s=%s" % (member, recipient))
           draw.remove(recipient)
       else:
           names.append(member)

   return matches

@app.route("/")
def index():
    now = dt.datetime.now()
    draw_date = dt.datetime.strptime('10/1/2013', '%m/%d/%Y')
    days = draw_date - now
    family = ["member1", "member2", "member3", "member4", "member5", "Me"]
    hat_names = [name for name in family]
    matchup = do_matchup(family, hat_names)

    return render_template("base.html", now=now,
                                        draw_date=draw_date,
                                        days=days, 
                                        matchup=matchup) 
```

该模板是一个基本的 html 页面，上面写着 {% if now < draw_date %} “距离抽奖还有 x 天”，{% else %} “显示抽奖结果”。

每次加载页面时，它都会进行新的绘制。我怎样才能让它只抽一次而不给每个家庭成员不同的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:47:57.797

您需要有一种单独的方式来运行 shuffle - 例如通过访问特定页面。该代码还应该将洗牌保存到数据库中。另一种方法是检查当前年份是否已经存在随机播放，如果没有则仅生成并保存。

从根本上说，答案是将您的洗牌保存在例如数据库中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T18:49:51.710

如果您不使用数据库并且只需要少量保存的结果，则可以将匹配项腌制到文件中。然后在您的索引中，您只需检查该文件是否存在，如果存在，则读取该文件并返回该匹配项。否则，您将生成一个新的匹配，保存它并返回结果。

# ruby - ruby splat 运算符在多重赋值期间究竟如何获得数组的第一个和其余部分？

> ID：14093513
> 
> 赞同：1
> 
> 时间：2012-12-30T18:44:32.457
> 
> 标签：ruby

在 ruby​​ 中，可以将多个赋值与 splat 运算符结合起来，以模拟函数式语言中的 first 和 rest（或 head 和 tail）。

```
first, *rest = [1,2,3,4]  
first # output: 1
rest # output: [2,3,4] 
```

splat 操作员是如何实现这一点的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T19:49:48.207

在多重赋值中最多可以有一个 splat 运算符，splat 运算符将调整数组的长度以完全匹配右侧的内容。换句话说：

1）当左边的变量个数大于右边数组的长度时，带splat的变量会被赋值为一个空数组：

```
*a = []
# => a == []

*a, b = [1]
# => a == [], b == 1

a, *b = [1]
# => a == 1, b == []

*a, b, c = [1, 2]
# => a == [], b == 1, c == 2

a, *b, c = [1, 2]
# => a == 1, b == [], c == 2

a, b, *c = [1, 2]
# => a == 1, b == 2, c == []

... 
```

2) 否则，带有 splat 的变量将扩展以填充右侧的其余元素：

```
*a = [1, 2]
# => a == [1, 2]

*a, b = [1, 2, 3]
# => a == [1, 2], b == 3

a, *b = [1, 2, 3]
# => a == 1, b == [2, 3]

*a, b, c = [1, 2, 3, 4]
# => a == [1, 2], b == 3, c == 4

a, *b, c = [1, 2, 3, 4]
# => a == 1, b == [2, 3], c == 4

a, b, *c = [1, 2, 3, 4]
# => a == 1, b == 2, c == [3, 4]

.... 
```

# c# - 我可以通过 Web.Config 连接字符串优化我的数据库连接吗？

> ID：14093514
> 
> 赞同：0
> 
> 时间：2012-12-30T18:44:34.827
> 
> 标签：c#, asp.net, sql-server-2008, optimization

我只想知道我们的连接字符串字段中是否有属性或属性，以便我们可以与客户保持优化的数据库连接。就像我通常使用的那样。它只包含必需的信息。

```
<add name ="ConnectionString" connectionString="Data Source=118.225.221.7;Initial Catalog=mycatalogue;
User Id=dba; password=some_password"/> 
```

另一个场景，我们也可以增强 MARS 和异步操作的连接字符串：

```
MARS
Server=myServerAddress;Database=myDataBase;Trusted_Connection=True;
MultipleActiveResultSets=true;

Asynchronous Processing
Server=myServerAddress;Database=myDataBase;Integrated Security=True;
Asynchronous Processing=True; 
```

在我们的页面上，我有 4-5 个或有时 ~10 个连接来访问数据。`"SELECT"`假设代码正在执行语句并为每个客户端获取一些随机行，我有 100 个用户同时访问同一页面。然后一次将有 400-500 个连接访问数据库，我认为这肯定会降低服务器/应用程序的性能。

所以我想知道，我应该尽量减少查询的数量，还是留给 .Net 框架智能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T19:22:59.997

首先考虑优化您的 linq，确保当所有信息都可以通过一次调用提取时，您没有进行两次查询。

还要看缓存。在这里，您必须决定数据应缓存多长时间以及何时应使其无效（例如通过某人插入记录）以及您在什么级别执行此操作。如果您的页面很少更改并且插入/更新不是那么繁重，您可以在页面级别进行缓存（页面级别缓存）。

如果这不是一个选项，您可以查看使用类似`httpcontext.current.cache`的东西缓存从 linq 返回的数据，快速谷歌搜索将向您显示详细信息，但本质上您缓存从 linq 查询返回的数据，并在后续请求中检查先缓存看看数据有没有，有就用那个，没有就去数据库再请求。这限制了对您的数据库的访问。

# django - Django 动态字段和cleaned_data

> ID：14093517
> 
> 赞同：1
> 
> 时间：2012-12-30T18:44:52.473
> 
> 标签：django, forms, dynamic

I have a complex dynamic form , where fields are being generated based on previous fields multiple times (for example I have a select field with football/basketball, when I choose football, all countries select is being generated, when choose country, leagues are generated等等..）

我不会在这里粘贴代码，因为它太大了。但简单的结构是

```
 def __init__(self, data=None, *args, **kwargs):
       super(tipForm, self).__init__(data, *args, **kwargs)
       Based on some logic adding dynamic fields here..... 
```

这是字段之间的基本关系：`Country->league->match->other(dateAndTime field, home/away team fields)`

我的问题是，当提交表单并通过所有验证时，`cleaned_data`我拥有包括动态字段在内的所有字段键，但由于某种原因，国家和联赛值是`empty/None/Null`. 但是例如匹配/（其他）动态字段与值一起存在。所以我很困惑为什么最后一个有价值而其他人没有。

匹配和其他动态字段可能存在，因为它们基本上是最后渲染的动态字段。但我还是不明白。虽然`request.POST`有所有数据。

[这](https://stackoverflow.com/questions/4294431/django-dynamically-added-form-fields-are-removed-in-form-cleaned-data)是另一个stackoverflow问题。有人建议字段映射不正确。但我认为这不是我的形式的重点。

无论如何，如果您可能需要更多代码部分，我会尝试显示/解释更多。

* * *

**更新 1**

我发现如果只看form.cleaned_data里面的内容，那么字段联盟一个国家都不存在，如果写form.cleanded_data ['league']然后它打印一个联盟，但它打印的不是选择选项值，而是文本之间标签 一些文字....

这是 request.POST ，清理后的数据返回的内容....一些测试....：

**请求.POST：**

```
<querydict: {u'initial-league':="" [u'45'],="" u'league':="" u'bettype':="" [u'hda'],="" u'bookie':="" [u'10bet'],="" u'handicap':="" [u'1.25'],="" u'country':="" [u'40'],="" u'odds':="" [u'1.11'],="" u'stake':="" [u'1'],="" u'prediction':="" [u'home'],="" u'initial-country':="" u'totalgoals':="" [u'+0.00'],="" u'initial-match':="" [u'12'],="" u'sport':="" u'initial-sport':="" u'match':="" [u'12']}=""></querydict:> 
```

**form.cleaned_data：**

```
{'league': , 'bettype': u'hda', 'bookie': u'10bet', 'handicap': 1.25, 'country': , 'odds': 1.1100000000000001, 'stake': u'1', 'prediction': u'Home', 'sport': u'1', 'totalGoals': u'+0.00', 'match': u'12'} 
```

**form.cleaned_data ['联赛']：**

蓝色广场总理

**request.POST['联赛']：**

45

感觉数据就在那里，但是格式不同，如果你像 form.cleaned_Data 一样打印它，它表明联赛是空的，尽管如果你打印 form.cleaned_data['league']，那么它的值是'Blue square League' 来自 Blue square League，但值 45 应该在那里......

这非常令人困惑，也许现在有人知道这些动态字段会发生什么......

# php - 在没有缓慢页面加载的情况下发送大量电子邮件的最佳方法

> ID：14093524
> 
> 赞同：2
> 
> 时间：2012-12-30T18:46:07.903
> 
> 标签：php, email

我的脚本发送新评论的通知电子邮件，这可能是给 50 个成员，需要发送 50 封电子邮件，这可能需要 20 秒，这对于用户来说等待时间太长了！PHP中最好的方法是什么，有没有异步的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T18:48:34.410

一种简单的方法可能是将必要的信息（电子邮件地址、内容）存储在数据库中，并通过 cron 作业每分钟左右运行一个批处理。批处理过程可以查询数据库中的待处理电子邮件，如果有任何要发送的电子邮件，请检查它们，然后删除数据库条目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T18:48:20.727

> 有没有办法异步做？

就在这里！

```
exec('wget PATH_TO_YOUR_SCRIPT_THAT_SENDS_THE_NEWSLETTER > /dev/null &'); 
```

请注意，数据库替代方案也是一个非常好的替代方案。但是，如果您在 Linux 上（并且不需要数据库），这也应该可以工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T19:03:01.047

我会使用 RabbitMQ 之类的东西。您的网站就像一个生产者向 Rabbit 发送电子邮件请求；然后让一个消费者运行来处理来自 Rabbit 的请求。

优点 - 如果您的消费者摔倒了，那么当您重新启动时，它将从上次停止的地方拾取（最后确认的请求）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T18:48:37.923

事实上，它可以异步完成。

最简单的方法是将电子邮件数据插入数据库而不是实际运行电子邮件，然后有一个定期实际发送电子邮件的 cron 作业。

当然还有其他方法，但这可能是最直接的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-30T18:55:56.190

您可以使用 cURL POST 来启动异步脚本。将超时设置为较短的时间，以便您的脚本可以在发出 POST 请求后恢复。您可以在 POST 请求中设置电子邮件信息或将其存储在数据库表中。

# emacs - 如何禁用特定类型文件的语义

> ID：14093528
> 
> 赞同：3
> 
> 时间：2012-12-30T18:46:25.053
> 
> 标签：emacs, cedet, emacs-semantic

对于具有混合类型的编程语言的文件，例如 .html，语义难以分析代码。有没有办法专门禁用这些类型文件的语义自动分析？

我正在使用 Emacs 24 附带的内置 cedet：

```
CEDET Version:  1.0
            Requested   File        Loaded
  Package       Version     Version     Version
  ----------------------------------------------------------
  cedet:        1.0     nil     ok
  eieio:        1.3     nil     ok
  semantic:     2.0     nil     ok
  srecode:      1.0     nil     ok
  ede:          1.0     nil     ok
  speedbar:     1.0     nil     ok 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T21:42:53.753

使用`semantic-inhibit-functions`. 例如，这个：

```
(setq semantic-inhibit-functions
      (list (lambda () (not (and (featurep 'cc-defs)
                                 c-buffer-is-cc-mode))))) 
```

`cc-mode`应该在所有非缓冲区中禁用语义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-03T01:51:12.280

另一个示例，为特定模式禁用它：

```
(add-to-list 'semantic-inhibit-functions
             (lambda () (member major-mode '(html-mode)))) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-12-11T22:49:09.920

来自语义文档：

> 2.3.1 不要解析某些缓冲区
> 
> 您可以使用 semantic-inhibit-functions 变量来禁止解析。
> 
> — 变量：semantic-inhibit-functions 在语义设置缓冲区之前要调用的不带参数的函数列表。如果这些函数中的任何一个返回非零，则当前缓冲区未设置为使用语义。
> 
> 您可以在非常大的文件或导致特定语义问题的文件中禁止解析。

正确使用示例：

```
 ;; Disable Semantic's source referencing in lisp buffers.
  (add-hook 'semantic-inhibit-functions
            (lambda () (member major-mode '(emacs-lisp-mode)))) 
```

这会将其添加到列表中（而不是覆盖列表），并确保它仅在加载语义后运行。

您必须使用`with-eval-after-load`，因为在您的用户配置初始化时可能不会加载语义包。在这种情况下，您会收到一条错误消息，指出语义抑制函数变量不存在，并且不会应用您的覆盖。

这解决了这些问题，并且比@Tom 和@Dmitry 的答案更好。

哦，我强烈建议阻止 emacs-lisp-mode，因为否则 Semantic 会在触发自动完成时尝试解析正在运行的 Emacs 实例的整个源代码树，如果你有很多包，这将冻结 Emacs。

# java - 用于生成私钥和自签名证书的 Java 代码

> ID：14093534
> 
> 赞同：4
> 
> 时间：2012-12-30T18:47:58.350
> 
> 标签：java, ssl, ssl-certificate, keystore

> **可能重复：**
> [使用 Java 生成证书、公钥和私钥](https://stackoverflow.com/questions/925377/generate-certificates-public-and-private-keys-with-java)

我想使用 Java 代码生成私钥和自签名证书并将其导出到文件中。当我通过网络搜索时，我只能通过 openssl 或 keytool 命令获得详细信息，而不是通过 java 代码。我不想使用任何第三方库。

下面是创建密钥和自签名证书的命令，​​我想使用 java 代码来做同样的事情。

```
 openssl req -new -text -out server.req

       openssl rsa -in privkey.pem -out server.key

       openssl req -x509 -in server.req -text -key server.key -out server.crt 
```

任何形式的帮助或建议将不胜感激。

# git - 告诉 git 在特定文件上使用我们的合并策略

> ID：14093540
> 
> 赞同：23
> 
> 时间：2012-12-30T18:48:34.360
> 
> 标签：git, git-merge

我有以下目录结构：

```
/.git
/.git/info/attributes
/MyProject
/MyProject/pom.xml
/MyProject/MyCode.java 
```

我有分支大师和错误修复。在两个分支上 pom.xml 和 MyCode.java 都被修改了。我想只为 MyCode.java 合并从 bugfix 到 master 的更改，并保留 pom.xml 文件的主版本。

所以我添加了“/.git/info/attributes”，因为我不想在项目中提交 .gitattributes

```
$cat .git/info/attributes
pom.xml merge=ours
$git status
# On branch master
nothing to commit (working directory clean)
$git check-attr -a pom.xml
pom.xml: merge: ours 
```

最后解决问题：

当我做：

```
$git merge bugfix
Auto-merging MyProject/pom.xml
CONFLICT (content): Merge conflict in MyProject/pom.xml
Automatic merge failed; fix conflicts and then commit the result. 
```

Git 忽略了属性设置。我在这里想念什么？

[我不想根据这篇文章](https://stackoverflow.com/questions/928646/how-do-i-tell-git-to-always-select-my-local-version-for-conflicted-merges-on-a-s)定义“keepMine.sh”

这篇[文章](https://stackoverflow.com/questions/11674950/how-to-do-an-ours-merge-using-the-eclipse-git-merge-tool)是我需要的，但是如果我有一个简单的模式，我不喜欢逐个文件

谢谢！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-12-31T08:40:49.137

```
$ git config merge.ours.driver true 
```

甚至

```
$ git config --global merge.ours.driver true 
```

'ours' 不是内置的合并驱动程序之一，即使你和我都非常清楚它应该做什么，而且当自定义合并驱动程序未定义时，git 似乎不会出错。

（`true`上面只是 unix`true`命令，它的成功表明它使本地版本看起来正确，在这种情况下，它什么都不做。）

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-02-28T03:56:46.067

从我对 git 版本 1.7.1 的测试中，我发现除非需要合并，否则不会执行任何合并驱动程序（无论您在配置中放置了什么，也不管任何 git 属性）。

如果您从“master”分支到您自己的本地分支“bugfix”，然后在您自己的分支中编辑一堆东西，请提交。然后你再次签出“master”分支，然后执行以下操作：

```
git merge bugfix 
```

您可能希望“merge=ours”属性在这种情况下保护您。不会的！如果自“bugfix”从 master 分支之后，没有对 master 分支中的特定文件进行编辑，则分支“bugfix”将踩过分支“master”。没有编辑意味着不需要合并，这意味着不要运行合并驱动程序。这似乎是一个常见的问题，git 应该预先定义一个特定的属性，以在所有情况下为文件提供绝对的本地保护，防止外部合并。

FWIW，我读过其他人的意见，即配置文件应该是本地的和私有的，根本不检查到 git 中。我认为这有点夸张：当然，我确实想跟踪我的配置文件中的更改。当然，协作工具的想法是我希望能够将我的配置与团队中其他人正在运行的配置进行比较，或者将开发配置与生产配置进行比较。工具的整个想法是它可以帮助您完成工作。

作为一个笨拙的解决方案，我想出的最好的方法是一个配置目录，每个配置文件都有不同的名称（即 config/production config/test config/devel_joe config/devel_bill 等等），所有这些都进入 git . 然后在部署时，实际的工作配置文件会从该配置目录中复制出来。我认为这是一种丑陋的方法，因为它与命名分支的想法相去甚远，但至少它是安全的。

# android - android.view.InflateException 数组

> ID：14093543
> 
> 赞同：0
> 
> 时间：2012-12-30T18:49:00.310
> 
> 标签：android

错误第 21 行：第 21 行是：android:entryValues="@array/listValues"。此错误仅在 android < 3 上。有什么想法吗？Logcat 是关于当我启动应用程序和旋转模拟器的时候。

首选项.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">
        <PreferenceCategory

                android:title="sett"
                android:summary="Sett">

            <CheckBoxPreference
                        android:title="Notify"
                        android:defaultValue="true"
                        android:summary="on off"
                        android:key="checkboxPref" />

        </PreferenceCategory>

        <PreferenceCategory
            android:title="Animation" >

        <ListPreference
         android:entries="@array/listOptions"
         android:entryValues="@array/listValues"
         android:key="listpref"
         android:summary="time"
         android:title="time" />

        </PreferenceCategory>

</PreferenceScreen> 
```

arrayfade.xml：

```
<?xml version="1.0" encoding="utf-8"?>
     <resources xmlns:android="http://schemas.android.com/apk/res/android">
       <string-array name="listOptions">
         <item>Mezzo secondo</item>
         <item>Un secondo</item>
         <item>Un secondo e mezzo</item>
         <item>Due secondi</item>
         </string-array>

       <string-array name="listValues">
         <item>500</item>
         <item>1000</item>
         <item>1500</item>
         <item>2000</item>
       </string-array>
     </resources> 
```

日志猫：

```
I/ActivityManager(   52): Displayed activity com.example.app/.MainActivity: 2372 ms (total 2372 ms)
I/ActivityManager(   52): Config changed: { scale=1.0 imsi=310/260 loc=en_US touch=3 keys=2/1/2 nav=1/1 orien=2 layout=18}
I/UsageStats(   52): Unexpected resume of com.example.app while already resumed in com.example.app
W/SurfaceFlinger(   52): timeout expired mFreezeDisplay=1, mFreezeCount=0
I/WindowManager(   52): Setting rotation to 0, animFlags=0
I/ActivityManager(   52): Config changed: { scale=1.0 imsi=310/260 loc=en_US touch=3 keys=2/1/2 nav=1/1 orien=1 layout=18}
I/UsageStats(   52): Unexpected resume of com.example.app while already resumed in com.example.app
D/dalvikvm(  660): GC freed 3448 objects / 774776 bytes in 59ms
I/dalvikvm(  660): Stack overflow, expanding (0x41049200 to 0x41049000)
I/dalvikvm(  660): Shrank stack (to 0x41049200, curFrame is 0x41049488)
D/AndroidRuntime(  660): Shutting down VM
W/dalvikvm(  660): threadid=3: thread exiting with uncaught exception (group=0x4001b188)
E/ACRA    (  660): ACRA caught a StackOverflowError exception for com.example.app. Building report.
I/NotificationService(   52): enqueueToast pkg=com.example.app callback=android.app.ITransientNotification$Stub$Proxy@43bf7008 duration=1
D/dalvikvm(  660): GC freed 6838 objects / 1236840 bytes in 65ms
D/dalvikvm(  660): GREF has increased to 201
D/dalvikvm(   52): GREF has increased to 501
D/dalvikvm(   52): GC freed 6591 objects / 308072 bytes in 96ms
D/dalvikvm(  660): GREF has increased to 301
D/dalvikvm(  660): GC freed 10418 objects / 650872 bytes in 78ms
D/dalvikvm(   52): GC freed 2244 objects / 129800 bytes in 103ms
D/dalvikvm(  660): GC freed 3169 objects / 152248 bytes in 75ms
I/ACRA    (  660): READ_LOGS granted! ACRA can include LogCat and DropBox data.
D/ACRA    (  660): Retrieving logcat output...
D/ACRA    (  660): Writing crash report file 1356895743000.stacktrace.
D/dalvikvm(  660): GC freed 8682 objects / 1094864 bytes in 72ms
D/ACRA    (  660): About to start ReportSenderWorker from #handleException
D/ACRA    (  660): Mark all pending reports as approved.
D/ACRA    (  660): Looking for error files in /data/data/com.example.app/files
D/ACRA    (  660): #checkAndSendReports - start
D/ACRA    (  660): Looking for error files in /data/data/com.example.app/files
I/ACRA    (  660): Sending file 1356895743000-approved.stacktrace
D/dalvikvm(  660): DestroyJavaVM waiting for non-daemon threads to exit
D/ACRA    (  660): Waiting for Toast + worker...
D/dalvikvm(   52): GC freed 3929 objects / 166424 bytes in 157ms
D/dalvikvm(  660): GREF has decreased to 199
D/dalvikvm(  660): GC freed 495 objects / 497968 bytes in 165ms
D/ACRA    (  660): Sending report 569291c5-64df-4491-91f9-f89f01f7f053
D/ACRA    (  660): Connect to https://docs.google.com/spreadsheet/formResponse?formkey=dFNyNHJJQ1ZvdVhlblg3aVl1LVNOSGc6MQ&ifq
W/WindowManager(   52): App freeze timeout expired.
W/WindowManager(   52): Force clearing freeze: AppWindowToken{43d7b688 token=HistoryRecord{43cf1898 com.example.app/.MainActivity}}
D/dalvikvm(  660): GC freed 11315 objects / 1068344 bytes in 59ms
D/dalvikvm(  660): GC freed 1302 objects / 353824 bytes in 48ms
D/ACRA    (  660): Sending request to https://docs.google.com/spreadsheet/formResponse?formkey=dFNyNHJJQ1ZvdVhlblg3aVl1LVNOSGc6MQ&ifq
D/dalvikvm(   52): GREF has decreased to 399
D/dalvikvm(  100): GC freed 1096 objects / 64416 bytes in 65ms
D/dalvikvm(   52): GC freed 3276 objects / 134560 bytes in 84ms
D/ACRA    (  660): #checkAndSendReports - finish
D/ACRA    (  660): Wait for Toast + worker ended. Kill Application ? true
E/AndroidRuntime(  660): Uncaught handler: thread main exiting due to uncaught exception
E/AndroidRuntime(  660): java.lang.StackOverflowError
E/AndroidRuntime(  660):    at java.nio.HeapByteBuffer.<init>(HeapByteBuffer.java:49)
E/AndroidRuntime(  660):    at java.nio.HeapByteBuffer.<init>(HeapByteBuffer.java:41)
E/AndroidRuntime(  660):    at java.nio.ReadWriteHeapByteBuffer.<init>(ReadWriteHeapByteBuffer.java:45)
E/AndroidRuntime(  660):    at java.nio.BufferFactory.newByteBuffer(BufferFactory.java:40)
E/AndroidRuntime(  660):    at java.nio.ByteBuffer.wrap(ByteBuffer.java:87)
E/AndroidRuntime(  660):    at java.nio.charset.CharsetEncoder.isLegalReplacement(CharsetEncoder.java:692)
E/AndroidRuntime(  660):    at java.nio.charset.CharsetEncoder.replaceWith(CharsetEncoder.java:804)
E/AndroidRuntime(  660):    at java.nio.charset.CharsetEncoder.<init>(CharsetEncoder.java:205)
E/AndroidRuntime(  660):    at com.ibm.icu4jni.charset.CharsetEncoderICU.<init>(CharsetEncoderICU.java:75)
E/AndroidRuntime(  660):    at com.ibm.icu4jni.charset.CharsetICU.newEncoder(CharsetICU.java:74)
E/AndroidRuntime(  660):    at com.android.internal.util.FastXmlSerializer.setOutput(FastXmlSerializer.java:292)
E/AndroidRuntime(  660):    at com.android.internal.util.XmlUtils.writeMapXml(XmlUtils.java:180)
E/AndroidRuntime(  660):    at android.app.ApplicationContext$SharedPreferencesImpl.writeFileLocked(ApplicationContext.java:2757)
E/AndroidRuntime(  660):    at android.app.ApplicationContext$SharedPreferencesImpl.access$800(ApplicationContext.java:2510)
E/AndroidRuntime(  660):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImpl.commit(ApplicationContext.java:2695)
E/AndroidRuntime(  660):    at com.example.app.MainActivity.preferenze(MainActivity.java:3473)
E/AndroidRuntime(  660):    at com.example.app.MainActivity.access$0(MainActivity.java:3439)
E/AndroidRuntime(  660):    at com.example.app.MainActivity$1.onSharedPreferenceChanged(MainActivity.java:2302)
E/AndroidRuntime(  660):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImpl.commit(ApplicationContext.java:2703)
E/AndroidRuntime(  660):    at com.example.app.MainActivity.preferenze(MainActivity.java:3473)
E/AndroidRuntime(  660):    at com.example.app.MainActivity.access$0(MainActivity.java:3439)
E/AndroidRuntime(  660):    at com.example.app.MainActivity$1.onSharedPreferenceChanged(MainActivity.java:2302)
E/AndroidRuntime(  660):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImpl.commit(ApplicationContext.java:2703)
E/AndroidRuntime(  660):    at com.example.app.MainActivity.preferenze(MainActivity.java:3473)
E/AndroidRuntime(  660):    at com.example.app.MainActivity.access$0(MainActivity.java:3439)
E/AndroidRuntime(  660):    at com.example.app.MainActivity$1.onSharedPreferenceChanged(MainActivity.java:2302)
E/AndroidRuntime(  660):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImpl.commit(ApplicationContext.java:2703)
E/AndroidRuntime(  660):    at com.example.app.MainActivity.preferenze(MainActivity.java:3473)
E/AndroidRuntime(  660):    at com.example.app.MainActivity.access$0(MainActivity.java:3439)
E/AndroidRuntime(  660):    at com.example.app.MainActivity$1.onSharedPreferenceChanged(MainActivity.java:2302)
E/AndroidRuntime(  660):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImpl.commit(ApplicationContext.java:2703)
E/AndroidRuntime(  660):    at com.example.app.MainActivity.preferenze(MainActivity.java:3473)
E/AndroidRuntime(  660):    at com.example.app.MainActivity.access$0(MainActivity.java:3439)
E/AndroidRuntime(  660):    at com.example.app.MainActivity$1.onSharedPreferenceChanged(MainActivity.java:2302)
E/AndroidRuntime(  660):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImpl.commit(ApplicationContext.java:2703)
E/AndroidRuntime(  660):    at com.example.app.MainActivity.preferenze(MainActivity.java:3473)
E/AndroidRuntime(  660):    at com.example.app.MainActivity.access$0(MainActivity.java:3439)
E/AndroidRuntime(  660):    at com.example.app.MainActivity$1.onSharedPreferenceChanged(MainActivity.java:2302)
E/AndroidRuntime(  660):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImpl.commit(ApplicationContext.java:2703)
E/AndroidRuntime(  660):    at com.example.app.MainActivity.preferenze(MainActivity.java:3473)
E/AndroidRuntime(  660):    at com.example.app.MainActivity.access$0(MainActivity.java:3439)
E/AndroidRuntime(  660):    at com.example.app.MainActivity$1.onSharedPreferenceChanged(MainActivity.java:2302)
E/AndroidRuntime(  660):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImpl.commit(ApplicationContext.java:2703)
E/AndroidRuntime(  660):    at com.example.app.MainActivity.preferenze(MainActivity.java:3473)
E/AndroidRuntime(  660):    at com.example.app.MainActivity.access$0(MainActivity.java:3439)
E/AndroidRuntime(  660):    at com.example.app.MainActivity$1.onSharedPreferenceChanged(MainActivity.java:2302)
E/AndroidRuntime(  660):    at android.app.ApplicationContext$SharedPreferencesImpl$EditorImp
D/dalvikvm(  660): GC freed 8661 objects / 994800 bytes in 65ms
D/dalvikvm(  660): threadid=31 wakeup: interrupted
I/Process (   52): Sending signal. PID: 660 SIG: 3
I/dalvikvm(  660): threadid=7: reacting to signal 3
I/dalvikvm(  660): Wrote stack trace to '/data/anr/traces.txt'
I/Process (  660): Sending signal. PID: 660 SIG: 9
I/ActivityManager(   52): Process com.example.app (pid 660) has died.
I/UsageStats(   52): Unexpected resume of com.android.launcher while already resumed in com.example.app
W/InputManagerService(   52): Got RemoteException sending setActive(false) notification to pid 660 uid 10028 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T20:17:47.837

随着您的更新，您现在得到一个堆栈溢出错误：`onSharedPreferenceChanged`调用一个方法名称首选项，该方法名称调用提交而不是触发器`onSharedPreferenceChanged`。在像这样进行一定数量的“递归”调用之后，你就会用完堆空间。不要从那里调用提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T19:14:31.737

问题来自 MainActivity 的布局，而不是首选项 xml 文件。

检查您的片段是否使用 android:name 属性正确声明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T19:17:58.513

看看

```
Could not find class 'android.content.ClipboardManager', referenced from method com.example.app.MainActivity.Copia 
```

android.content.ClipboardManager 可从 API lvl 11 - Android 3.0 获得。我认为这可能与您的问题有关。

# java - Java NIO 和 SSL

> ID：14093546
> 
> 赞同：7
> 
> 时间：2012-12-30T18:49:17.940
> 
> 标签：java, ssl, nio, sslengine

我正在使用 java NIO 编写服务器，我有几个问题找不到答案。

一、关于SSLEngine，如何`NEED_TASK`在单独的线程中正确处理？当我在单独的线程中调用任务时，它们会完成，但我不知道如何返回执行另一个握手操作。一种选择是从执行委派任务的线程中调用该操作，但我想这不是这样做的方法。

`interestOps()`另一个问题是关于从不同的线程然后选择器线程调用。在尝试写入频道并没有写入所有数据后，我需要更改关键兴趣。我考虑过使用 ROX NIO 教程中的某种更改队列，但我在这里的另一个线程中读到这不是最好的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T19:00:22.067

> 首先关于 SSLEngine，如何在单独的线程中正确处理 NEED_TASK。当我在单独的线程中调用任务时，它们会完成，但我不知道如何返回执行另一个握手操作。

当引擎处于 NEED_TASK 状态时，它不能做任何其他事情。任务完成后，您应该重复最初返回 NEED_TASK 的操作，并让引擎告诉您下一步该做什么。在任务完成之前，您需要阻止或禁用其他线程对该引擎的使用，即不要在该通道上进行选择。

> 另一个问题是关于从不同线程然后选择器线程调用interestOps()。在尝试写入频道并没有写入所有数据后，我需要更改关键兴趣。我考虑过使用 ROX NIO 教程中的某种更改队列，但我在这里的另一个线程中读到这不是最好的方法。

那将是我。我讨厌那些排队。我只是唤醒（）选择器并更改了interestOps，从未遇到过问题。选择器线程必须正确处理准备好的零键，但它已经需要这样做了。

# authentication - 使用 [Authorize] 属性定义登录 URL

> ID：14093551
> 
> 赞同：0
> 
> 时间：2012-12-30T18:50:26.107
> 
> 标签：authentication, asp.net-mvc-4

我正在 MVC4 中制作一个仅限私有页面的应用程序。

我成功（几乎成功）使用基于 NHibernate 和我的域的实体/存储库的自定义会员提供程序创建了登录页面。

每个控制器`AuthController`都标有`[Authorize]`。

当我未经授权时，webapp 应该将我重定向到登录页面。我从头开始创建了整个应用程序，所以我知道在任何地方我都找不到`AuthController`要声明为未经身份验证用户的登陆 URL。

### 如何告诉 MVC？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:54:11.473

假设您使用的是内置表单身份验证，则 URL 进入`web.config`, 在元素的`loginUrl`属性中。`forms`

[http://msdn.microsoft.com/en-us/library/1d3t3c61(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/1d3t3c61(v=vs.71).aspx)

```
<configuration>
  <system.web>
    <authentication mode="Forms">
      <forms loginUrl="/membership/login" />
    </authentication> 
  </system.web>
</configuration> 
```

# macos - Vim Solarized 在 OS X Terminal.app 上不正确的颜色

> ID：14093554
> 
> 赞同：11
> 
> 时间：2012-12-30T18:51:16.047
> 
> 标签：macos, vim, color-scheme

> **可能重复：**
> [为什么大多数 vim 配色方案在我使用它们时看起来不像屏幕截图那样漂亮？](https://stackoverflow.com/questions/9832660/why-dont-most-vim-color-schemes-look-as-nice-as-the-screenshot-when-i-use-them)

我正在尝试将我的 vim 配置转移到仅从终端使用它。目前我正在使用 gVim，一切正常。

但是在 terminal.app 中，配色方案关闭了。我在终端.app 中使用 Solarized 256 主题，在 vim 中使用 Solarized 主题。

这就是他们的样子：

![gVim 左，Terminal.app 右](../Images/198998ae5e5964a10b3b04a609509e38.png)

我必须设置 g:solarized_termtrans = 1 才能让 ti 背景甚至显示正确的颜色。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-30T20:45:43.983

我自己曾经遇到过这个问题。

但是以下语句修复了所有问题，这是我在 .vimrc 文件中控制终端支持的方式：[https ://github.com/Greduan/dotfiles/blob/8b48b0d788c0fed6fc14720bbe3ae9def31af947/vim/vimrc.vim#L550-L556](https://github.com/Greduan/dotfiles/blob/8b48b0d788c0fed6fc14720bbe3ae9def31af947/vim/vimrc.vim#L550-L556)

```
if !has('gui_running')
    " Compatibility for Terminal
    let g:solarized_termtrans=1

    " Make Solarized use 16 colors for Terminal support
    let g:solarized_termcolors=16
endif 
```

如果您使用的是终端，这基本上可以为终端修复它。尝试使用`:let g:solarized_termcolors = 16`.

伪代码：

*   如果用户不使用 GUI：
    *   然后设置`termtrans`等于一。
    *   并告诉 Vim 只使用 16 种颜色，或者如果您的终端支持，则使用 256 种颜色（不知道有哪一种）。
*   万一

**编辑1：**

如果您确定您使用的是 256 色终端，那么您也可以不理会它，它会完美运行。像这样：[https ://github.com/Greduan/dotfiles/blob/6dac113d8281b0201399831bf62a2ea520d28154/vim/vimrc.vim#L551-L561](https://github.com/Greduan/dotfiles/blob/6dac113d8281b0201399831bf62a2ea520d28154/vim/vimrc.vim#L551-L561)

```
if !has('gui_running')
    " Compatibility for Terminal
    let g:solarized_termtrans=1

    if (&t_Co >= 256 || $TERM == 'xterm-256color')
        " Do nothing, it handles itself.
    else
        " Make Solarized use 16 colors for Terminal support
        let g:solarized_termcolors=16
    endif
endif 
```

它的作用是检查您是否有终端。如果确实设置了`termtrans`，则检查您的终端是否有 256 种颜色，如果没有，则将 Solarized 设置为使用 16 种颜色。这效果要好得多。

# javascript - 在 WinRT/Javascript 中以编程方式打开防火墙端口

> ID：14093555
> 
> 赞同：0
> 
> 时间：2012-12-30T18:51:16.873
> 
> 标签：javascript, windows-8, windows-runtime, client-server, server-side

我正在开发一个客户端/服务器 Javascript Windows 8 Metro 应用程序。操作服务器实例的用户可以更改服务器端口。我想在每次用户更改端口时向防火墙添加一条规则，这样当客户端无法连接到防火墙时，他就不会因为防火墙问题而感到困惑。甚至检查此端口是否可从外部访问的方法也很有用，因此我可以向用户显示消息以添加防火墙规则。

预先感谢您的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T08:18:48.553

您拥有的防火墙选项由[App 功能声明](http://msdn.microsoft.com/en-us/library/windows/apps/hh464936.aspx)控制。如果您指定`internetClientServer`声明，那么它将允许您使用任何非关键网络端口进行侦听。

这也可能有帮助

> 当应用程序尝试侦听入站未经请求的请求时，系统将检查其清单中为应用程序设置的功能，并决定允许或阻止来自远程 IP 地址的入站未经请求的请求。应用程序必须启用 InterentClientServer 或 privateNetworkClientServer 功能才能允许侦听入站未经请求的请求。如果启用了这些功能中的至少一项，则允许应用在一个或多个端口上侦听指定网络类型上的入站未经请求的请求。检查每个入站未经请求的请求尝试，以确定是否允许来自特定远程源 IP 地址的入站未经请求的请求。

通过[http://msdn.microsoft.com/en-us/library/windows/apps/hh770532.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh770532.aspx)

根据[文档](http://msdn.microsoft.com/en-us/library/windows/apps/windows.networking.sockets.streamsocketlistener.bindendpointasync.aspx)，如果端口已经打开，则连接将失败 - 我猜这就是他们谈论关键端口时的意思，但要确保我会避免使用标准端口（21,25,80,443,8080， ETC）

# ember.js - Ember.js：Ember.Select valueBinding 和延迟加载

> ID：14093558
> 
> 赞同：0
> 
> 时间：2012-12-30T18:51:22.640
> 
> 标签：ember.js, ember-data

我有一个禁用选择器的视图，一旦加载模型，就应该将其设置为 ember-data 中的值。

```
LocationSelectView: Ember.Select.extend({
    prompt: "Choose location",
    contentBinding: 'controller.locations',
    optionValuePath: 'content.id',
    optionLabelPath: 'content.title',
    valueBinding: 'controller.content.location_id'
}) 
```

并且视图在模板中被禁用

```
{{view view.LocationSelectView disabled="true"}} 
```

只要位置已加载到商店，一切都按预期工作，如果未加载，则内容按预期绑定（我可以通过启用选择器来验证），但所选值保持在“提示” .

我通过在控制器的初始化中预加载位置数据来解决这个问题，但我真的不喜欢这个解决方案。

我怎样才能解决这个问题 ？这是一个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T20:57:12.650

这里提到了这个问题： [https ://github.com/emberjs/ember.js/issues/1333](https://github.com/emberjs/ember.js/issues/1333)

我的解决方案是在视图中添加一个观察者，如下所示：

```
preselect: function () {
  var item = this.get('items.firstObject');
  this.set('currentItem', item);
}.observes('items.@each') 
```

假设使用 selectionBinding （我更喜欢）而不是 valueBinding

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-04T22:51:37.793

我为这个问题开发了一个解决方法。看下面的代码：

```
App.Select = Ember.Select.extend({
placeholder: '',
allowClear: false,

contentChanged: function() {
    if (this.get('value') === undefined && this.get('_iv') != undefined) {
        var v = this.get('_iv');
        var o = this.get('content').findProperty('id', v);

        if (o) {
            this.set('value', v);
        }
    }
}.observes('content.@each'),

init: function() {
    this._super();
    this.set('_iv', this.get('value'));
}, 
```

...

我希望它有帮助

# jquery - 替换空间或对其进行编码

> ID：14093563
> 
> 赞同：0
> 
> 时间：2012-12-30T18:51:38.413
> 
> 标签：jquery

我有以下 Jquery 电话。

```
$("#btnfindAddress").click(function() {
   var dataString = '';
        //built the data string that will be sent with ajax
        dataString += 'business_name='+$('#company').val()+'&';
        dataString += 'business_city='+$('#city').val()+'&';
        dataString += 'business_country='+$('#country').val()+'&';
        dataString += 'business_zipcode='+$('#zipcode').val();
$.ajax({
type: "GET",
url: "/locations/search",
contentType: "application/text; charset=utf-8",
data: dataString, 
success: function(data){ 
    var text_result="";
    text_result="<table  id=\"thetable\"><tbody>";
    $.each(data,function(index,value){
          text_result+="<tr>";
          text_result+="<td>"+value.name+"</td>";
          text_result+="<td>"+value.address+"</td>";
          text_result+="<td>"+value.zipcode+"</td>";
          text_result+="<td><a name="+ value.name+" address="+value.address+" city="+value.city+"href=>Select</a></td>";
          text_result+="</tr>";
    });
          $('#locations').html(text_result);
}
});
 return false; 
}); 
```

它生成以下html

```
<a href="" angeles="" city="Los" website="null" zipcode="90007"  st="" hoover="" s="" address="3303" coffee="" name="Starbucks">Select</a> 
```

这些值按空格分隔。

应该是

```
 <a href="" city="Los angeles"   address="3303 S Hoover st" coffee="" name="Starbucks">Select</a> 
```

我怎样才能解决这个问题 ？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T18:54:54.900

您需要在生成的 html 中添加引号：

```
text_result+="<td><a name=\""+ value.name+"\" address=\""+value.address+"\" city=\""+value.city+"\" href>Select</a></td>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:03:33.957

您不应该使用字符串操作来执行此操作。如果您执行以下操作，jQuery 会正确处理编码...

```
var $table = $('<table>').attr('id','theTable');
$.each(data,function(index,value) {
    $table.append(
       $('<tr>')
         .append($('<td>').text(value.name))
         .append($('<td>').text(value.address))
         .append($('<td>').text(value.zipcode))
         .append($('<td>').append(
           $('<a>').attr('name',value.name).attr('address',value.address)
         )
    );
});
$('#locations').html($('<div>').append($table).html()); 
```

更好的是使用 EJS 或 Moustache 之类的模板方法。

# extjs - ExtJS 4.1.1.a - TreePanel 的键盘导航问题

> ID：14093575
> 
> 赞同：0
> 
> 时间：2012-12-30T18:53:06.797
> 
> 标签：extjs, extjs4, extjs4.1

我正面临 TreePanel 的键盘导航问题。这是我的树形面板配置：

```
rootVisible: false,
animate: true,
autoScroll: true,
useArrows: true,
border: true,
singleExpand: true, 
```

最后我把树作为一个单一的窗口项目；然后展示它。

我不能使用键盘箭头来展开/折叠项目。我只能使用向上/向下箭头来上下。

这是一个错误还是我错过了什么？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:37:14.653

我找到了解决方案，我的情况的问题是将 selType 设置为 rowmodel。在我注释掉它之后，键盘导航按预期工作..

# python - 使用gevent时如何在Python中获取POST变量？

> ID：14093576
> 
> 赞同：8
> 
> 时间：2012-12-30T18:53:14.663
> 
> 标签：python, post, gevent

这就是问题：使用gevent时如何在Python中获取POST变量？

以下内容传递给应用程序：

```
def application(env, start_response): 
```

这是另一部分：

```
if __name__ == '__main__':
print 'Serving on 8080...'
WSGIServer(('', 8080), application).serve_forever() 
```

但是 env 不包含我的帖子！

请赐教-我的误解在哪里？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T21:16:33.460

您需要解析请求正文`environ['wsgi.input'].read()`。

但是，您最好使用 Web 框架来为您执行此操作。大多数支持 WSGI 的 Web 框架都可以很好地与 gevent 配合使用。如果你需要一些最小的东西，[瓶子](http://bottlepy.org/docs/dev/tutorial.html#request-data)很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:20:44.250

这是请求处理程序的示例代码：

定义

```
callback(request): 
    post_data = request.input_buffer.read(-1) 
```

# c# - 替换所有字符和第一个 0（零）

> ID：14093581
> 
> 赞同：0
> 
> 时间：2012-12-30T18:53:44.327
> 
> 标签：c#, regex

我正在尝试替换正则表达式中的所有字符，期望数字，但数字不应以 0 开头
如何使用正则表达式实现这一点？

我尝试了多种方法，例如`@"^([1-9]+)(0+)(\d*)"`and `"(?<=[1-9])0+"`，但这些都不起作用

文本的一些示例可能是`hej:\\\\0.0.0.22`、和`hej:22`，并且所有地方的结果都应该是`hej:\\\\?022``hej:\\\\?22``22`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:00:12.143

与其替换，不如尝试匹配`[1-9][0-9]*$`您的字符串。抓取匹配的文本。

请注意，如果您使用 .NET 正则表达式匹配 Unicode 数字字符`\d`，这里正则表达式将匹配的内容限制为简单字符类。

（注意：正则表达式仅假定在行尾匹配）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T20:20:45.040

根据您的评论之一`hej:\\\\0.011.0.022`应该 yield `110022`。首先选择从第一个非零数字到最后一个非零数字的相关字符串部分：

```
([1-9].*[1-9]\d*)|[1-9] 
```

`[1-9]`       是第一个非零数字
`.*`             是任意数量的任何字符
`[1-9]\d*`是数字，从第一个非零数字开始
`|[1-9]`     包括仅由一个非零数字组成的情况

然后删除所有非数字 ( `\D`)

```
Match match = Regex.Match(input, @"([1-9].*[1-9]\d*)|[1-9]");
if (match.Success) {
    result = Regex.Replace(match.Value, "\D", "");
} else {
    result = "";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T19:08:32.447

使用以下

```
[1-9][0-9]*$ 
```

您不需要进行任何递归，只需匹配即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T19:16:33.020

这是您可以尝试的东西 The87Boy，您可以随意玩耍或添加到图案中。

```
string strTargetString = @"hej:\\\\*?0222\";
string pattern = "[\\\\hej:0.?*]";
string replacement = " ";

Regex regEx = new Regex(pattern);
string newRegStr = Regex.Replace(regEx.Replace(strTargetString, replacement), @"\s+", " "); 
```

`Result from the about Example = 22`

# debugging - 在 lldb 中打印 FPU 寄存器

> ID：14093585
> 
> 赞同：3
> 
> 时间：2012-12-30T18:54:17.800
> 
> 标签：debugging, llvm, lldb, fpu

如何使用 lldb 打印 FPU 寄存器？

在 gdb 中，您会执行类似的操作`p $st0`，但是在 lldb 中执行相同操作会导致错误：`error: use of undeclared identifier '$st0'`.

`register read st0`也不起作用并给出错误`error: Invalid register name 'st0'.`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T22:32:01.993

通过`register read --all`按照建议使用`paulsm4`，我发现寄存器的名称实际上是`stmm0`to`stmm7`而不是`st0`to `st7`。

这样做`register read stmm0 --format b`会给你浮点数的二进制表示。

# c# - SingleOrDefault 返回 null 时的 LINQ 新实例

> ID：14093594
> 
> 赞同：14
> 
> 时间：2012-12-30T18:55:15.930
> 
> 标签：c#, asp.net, linq

我有这个简单的方法：

```
 #region Fields

    private Collection<Address> _addresses;

    #endregion

    #region Public methods

    public Address DeliveryAddress()
    {
        if (_addresses == null)
            if (this.Id > 0)
                _addresses = Core.Data.Addresses.GetClient(this.Id);

        return _addresses.SingleOrDefault(x => x.TypeId == AddressType.Delivery);
    }

    public Address InvoiceAddress()
    {
        if (_addresses == null)
            if (this.Id > 0)
                _addresses = Core.Data.Addresses.GetClient(this.Id);

        return _addresses.SingleOrDefault(x => x.TypeId == AddressType.Invoice);
    }

    #endregion 
```

如您所见，我试图为 a 返回一个结果，为 a 返回一个`DeliveryAddress`结果`InvoiceAddress`。我的问题是我希望链接表达式创建一个新的`Address()`if `SingleOrDefault`returns实例`null`。我对 linq 真的很陌生，所以我不确定是否`SingleOrDefault`应该使用正确的表达式。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-12-30T18:58:43.133

您可以[`DefaultIfEmpty`](http://msdn.microsoft.com/en-us/library/bb355419.aspx)将该实例用作默认值：

```
return _addresses.Where(x => x.TypeId == AddressType.Delivery)
                 .DefaultIfEmpty(new Adress())
                 .Single(); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-30T18:59:33.723

使用[空合并运算符](http://msdn.microsoft.com/en-us/library/ms173224.aspx)：

```
return _addresses
    .SingleOrDefault(x => x.TypeId == AddressType.Delivery) ?? new Address(); 
```

* * *

表达方式

```
x ?? y 
```

`x`如果`x`不是，则产生`null`，否则`y`。您可以链接运营商

```
x ?? y ?? z ?? t 
```

这将返回第一个非空值，或者`null`如果它们都是`null`.

* * *

**更新**

请注意，[`SingleOrDefault`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.singleordefault%28v=vs.90%29.aspx)如果序列包含多个元素，则会引发异常。如果您需要序列的第一个元素，可能没有或超过一个元素，请[`FirstOrDefault`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.firstordefault%28v=vs.90%29.aspx)改用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-30T19:01:07.497

您可以创建自己的扩展方法，如下所示：

```
public static T NewIfNull<T>(this T obj) where T: class, new()
{
   return obj ?? new T();
} 
```

...然后在 SingleOrDefault 的末尾添加一个用法：

```
var singleResult = myCollection.SingleOrDefault().NewIfNull(); 
```

...或者因为逻辑很简单，就像其他答案所说的那样内联它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T18:58:24.813

代替

```
return _addresses.SingleOrDefault(x => x.TypeId == AddressType.Delivery); 
```

做这样的事情：

```
var address = _addresses.SingleOrDefault(x => x.TypeId == AddressType.Delivery);

if(address == null)
    address = new Address();

return address; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-30T19:00:34.870

我倾向于将这两种方法都写为`IEnumerable<Address>`. `SingleOrDefault()`如果调用返回，您可以使用 null-coalesing 运算符返回一个新实例`null`。

```
public static class AddressExtensions
{
    public static Address DeliveryAddress(this IEnumerable<Address> addresses)
    {
        return addresses.SingleOrDefault(x => x.TypeId == AddressType.Delivery) 
               ?? new Address();
    }

    public static Address InvoiceAddress(this IEnumerable<Address> addresses)
    {
        return addresses.SingleOrDefault(x => x.TypeId == AddressType.Invoice) 
               ?? new Address();
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-30T19:16:36.920

除了其他答案中的替代方法外，您还可以创建自己的`SingleOrNew`扩展方法。

```
public static TSource SingleOrNew<TSource>(this IEnumerable<TSource> source, Func<TSource, bool> predicate ) where T:new()
{
     return source.SingleOrDefault(predicate) ?? new T();
} 
```

它可以用作

```
return _addresses.SingleOrNew(x => x.TypeId == AddressType.Delivery); 
```

# html - 有人可以帮我让两个工具栏的 div 出现在同一行吗？

> ID：14093599
> 
> 赞同：0
> 
> 时间：2012-12-30T18:55:54.657
> 
> 标签：html, line, toolbar

所以我的代码是这样的：

```
<div id="toolbar">
<div style='border: none; font-family: Arial, Helvetica, sans-serif;'>
    <font color="#fff">
        <marquee bgcolor="#000" direction="left" loop="25" width="95%">Welcome to 

the NabzZzolution Mercenarie Group of the AboveUltimate-HydraBlast Server! If you are a 

member please register yourself.</marquee>
    </font>
</div>
<div>
    <a style="text-align:left;"class="wsite-button wsite-button-small wsite-button-

highlight" href="http://aunabzzzolution.weebly.com/log-in.html" target="_blank">
    <span class="wsite-button-inner">Log In</span>
    </a>
</div>
</div> 
```

以及它们是如何出现的：[http](http://aunabzzzolution.weebly.com/) : //aunabzzzolution.weebly.com/ 所以我希望登录按钮位于工具栏的第一行，而 marqeee 则位于其右侧。有人能帮帮我吗？预先感谢您的任何帮助。

此致， Tasos Papalyras

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T18:59:40.897

使用 CSS 属性：`display`具有`inline`or的属性`inline-block`。

修改版（格式也正确）：

```
<div id="toolbar" style="display:inline">
    <div style='border: none; font-family: Arial, Helvetica, sans-serif;display:inline;'>
        <font color="#fff">
            <marquee bgcolor="#000" direction="left" loop="25" width="90%">
                Welcome to the NabzZzolution Mercenarie Group of the AboveUltimate-HydraBlast Server! If you are a member please register yourself.
            </marquee>
        </font>
    </div>
</div>

<div style="display:inline;">
    <a style="text-align:left;"class="wsite-button wsite-button-small wsite-button-highlight;" href="http://aunabzzzolution.weebly.com/log-in.html" target="_blank">
        <span class="wsite-button-inner">Log In</span>
    </a>
</div> 
```

示例：http: [//jsfiddle.net/L8JfJ/](http://jsfiddle.net/L8JfJ/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T18:59:46.343

采用`display:inline-block;`

```
button {
   display:inline-block;
   // other props here
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T19:11:39.370

改变：

```
<font style="display: inline-block; width:80%">  // <== inline-block and width.
  ...
</font>

... 

<div style="text-align:left; display:inline-block">      // <== inline-block
    <div style="height: 10px; overflow: hidden;"></div>

    <a class="wsite-button wsite-button-small wsite-button-highlight"  href="http://aunabzzzolution.weebly.com/log-in.html" target="_blank">
        <span class="wsite-button-inner">Log In</span>
    </a>
    <div style="height: 10px; overflow: hidden;"></div>
</div> 
```

# asynchronous - 使用可分页内存进行异步内存复制的效果？

> ID：14093601
> 
> 赞同：12
> 
> 时间：2012-12-30T18:56:09.273
> 
> 标签：asynchronous, cuda

在 CUDA C 最佳实践指南 5.0 版第 6.1.2 节中，写道：

> 与 cudaMemcpy() 相比，异步传输版本需要固定主机内存（请参阅固定内存），并且它包含一个附加参数，一个流 ID。

这意味着`cudaMemcpyAsync`如果我使用简单的内存，该功能应该会失败。

但这不是发生的事情。

仅出于测试目的，我尝试了以下程序：

# 核心：

```
__global__ void kernel_increment(float* src, float* dst, int n)
{
    int tid = blockIdx.x * blockDim.x + threadIdx.x;

    if(tid<n)   
        dst[tid] = src[tid] + 1.0f;
} 
```

# 主要的：

```
int main()
{
    float *hPtr1, *hPtr2, *dPtr1, *dPtr2;

    const int n = 1000;

    size_t bytes = n * sizeof(float);

    cudaStream_t str1, str2;

    hPtr1 = new float[n];
    hPtr2 = new float[n];

    for(int i=0; i<n; i++)
        hPtr1[i] = static_cast<float>(i);

    cudaMalloc<float>(&dPtr1,bytes);
    cudaMalloc<float>(&dPtr2,bytes);

    dim3 block(16);
    dim3 grid((n + block.x - 1)/block.x);

    cudaStreamCreate(&str1);
    cudaStreamCreate(&str2);

    cudaMemcpyAsync(dPtr1,hPtr1,bytes,cudaMemcpyHostToDevice,str1);
    kernel_increment<<<grid,block,0,str2>>>(dPtr1,dPtr2,n);
    cudaMemcpyAsync(hPtr2,dPtr2,bytes,cudaMemcpyDeviceToHost,str1);

    printf("Status: %s\n",cudaGetErrorString(cudaGetLastError()));

    cudaDeviceSynchronize();

    printf("Status: %s\n",cudaGetErrorString(cudaGetLastError()));

    cudaStreamDestroy(str1);
    cudaStreamDestroy(str2);

    cudaFree(dPtr1);
    cudaFree(dPtr2);

    for(int i=0; i<n; i++)
        std::cout<<hPtr2[i]<<std::endl;

    delete[] hPtr1;
    delete[] hPtr2;

    return 0;
} 
```

该程序给出了正确的输出。数组成功递增。

如何在`cudaMemcpyAsync`没有页面锁定内存的情况下执行？我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-30T19:50:33.187

`cudaMemcpyAsync`本质上是`cudaMemcpy`. 这意味着在发出复制调用时它不会阻塞调用主机线程。这是调用的基本行为。

*可选地*，如果调用启动到非默认流中，并且如果主机内存是固定分配，并且设备具有空闲的 DMA 复制引擎，则复制操作可以在 GPU 同时执行另一个操作时发生：内核执行或另一个副本（在具有两个 DMA 复制引擎的 GPU 的情况下）。如果不满足这些条件中的任何一个，*GPU 上的操作在*功能上与标准`cudaMemcpy`调用相同，即。它在 GPU 上序列化操作，不会同时执行复制内核或同时执行多个副本。唯一的区别是该操作不会阻塞调用主机线程。

在您的示例代码中，主机源和目标内存未固定。因此内存传输不能与内核执行重叠（即它们在 GPU 上序列化操作）。主机上的*调用*仍然是异步的。所以你所拥有的在功能上等同于：

```
cudaMemcpy(dPtr1,hPtr1,bytes,cudaMemcpyHostToDevice);
kernel_increment<<<grid,block>>>(dPtr1,dPtr2,n);
cudaMemcpy(hPtr2,dPtr2,bytes,cudaMemcpyDeviceToHost); 
```

除了所有调用在主机上都是异步的，因此主机线程在`cudaDeviceSynchronize()`调用时阻塞，而不是在每个内存传输调用时阻塞。

这是绝对预期的行为。

# iphone - iOS 6 外观 API UIBarButtonSystemItemAdd 不起作用？

> ID：14093603
> 
> 赞同：0
> 
> 时间：2012-12-30T18:56:29.680
> 
> 标签：iphone, objective-c, ios

在 iOS 6 中，您可以访问 Appearance API 中的一个新方法：

```
- (void)setBackgroundImage:(UIImage *)backgroundImage
              forState:(UIControlState)state
                 style:(UIBarButtonItemStyle)style
            barMetrics:(UIBarMetrics)barMetrics 
```

因此，您可以为每个导航按钮样式设置不同的背景。问题是，它看起来不适用于这种`UIBarButtonSystemItemAdd`风格，但它适用于`UIBarButtonItemStyleDone`. 这是我的代码片段：

```
if ([[[UIDevice currentDevice] systemVersion] floatValue] >= 6.0f)
{
    // Works well
    [barButton setBackgroundImage:[[UIImage imageNamed:@"nav-button-done.png"] stretchableImageWithLeftCapWidth:7 topCapHeight:0]
                         forState:UIControlStateNormal
                            style:UIBarButtonItemStyleDone
                       barMetrics:UIBarMetricsDefault];

    // Not working
    [barButton setBackgroundImage:[[UIImage imageNamed:@"nav-button-done.png"] stretchableImageWithLeftCapWidth:7 topCapHeight:0]
                         forState:UIControlStateNormal
                            style:UIBarButtonSystemItemAdd
                       barMetrics:UIBarMetricsDefault];
} 
```

有人知道为什么它不起作用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:23:34.450

注意 UIBarButtonItem 的方法声明：

```
- (void)setBackgroundImage:(UIImage *)backgroundImage forState:(UIControlState)state style:(UIBarButtonItemStyle)style barMetrics:(UIBarMetrics)barMetrics 
```

问题是 UIBarButtonSystemItemAdd 不是有效的 UIBarButtonItemStyle。支持的样式有：

```
typedef enum {
    UIBarButtonItemStylePlain,
    UIBarButtonItemStyleBordered,
    UIBarButtonItemStyleDone,
} UIBarButtonItemStyle; 
```

您将 UIBarButtonItemStyle 与 UIBarButtonSystemItem 混为一谈，它们并不完全相同，它只是忽略了您对其设置的值并恢复为默认类型。

# wordpress - Wordpress tinymce 插入文本

> ID：14093604
> 
> 赞同：2
> 
> 时间：2012-12-30T18:56:36.077
> 
> 标签：wordpress, tinymce

我在 wordpress 中遇到了 tinymce 的问题。我需要放入 tinymce 元素。在 tinymce 编辑器中，有两个选项卡“Visual”和“HTML”。当我在“HTML”中使用我的代码时，它的工作原理。但是当我想在“视觉”中使用它时它不起作用......

我正在尝试这样：

**JavaScript**

```
function insert_tag(text){
    var cont = document.getElementById('bbp_topic_content');
    cont.value += '<div>' + text + '</div>';
} 
```

**HTML**

```
<a onclick="insert_tag('HELLO')" >Insert text</a> 
```

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-01T20:13:57.590

你可以试试这个

```
function insert_tag(text){
    if(tinyMCE && tinyMCE.activeEditor)
    {
        tinyMCE.activeEditor.selection.setContent('<div>' + text + '</div>');
    }
    return false;
} 
```

也在`return`你的`a`标签中使用

```
<a onclick="return insert_tag('HELLO')" >Insert text</a> 
```

[参考](http://www.tinymce.com/wiki.php/API3%3amethod.tinymce.dom.Selection.setContent)。

# vector - 矢量背景图像与光栅背景图像

> ID：14093605
> 
> 赞同：1
> 
> 时间：2012-12-30T18:56:40.577
> 
> 标签：vector, svg, background-image, raster-graphics

我目前在我的一个网站上使用光栅图像的重复模式，它并没有那么复杂以至于无法转换为矢量，但到目前为止还没有放大到在 HiDPI/Retina 上看起来不错显示。

我正在考虑将光栅图案转换为矢量，并将生成的`.svg`图像设置为背景，但我想知道在网站背景中使用矢量图像是否有任何缺点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T06:27:41.133

*   根据图像的复杂性（滤镜、蒙版、渐变......），它可能会消耗更多的 CPU 来渲染图像；好消息是越来越多的图形任务被发送到 GPU，所以这不是一个大问题
*   与旧版浏览器不兼容
*   浏览器支持还不完善，所以如果您使用复杂的功能，最终图像的外观可能会有所不同

但我坚信矢量图形的优点多于缺点，所以去吧。

# asp.net - Global.asax + Application_Error 中捕获的未知错误

> ID：14093606
> 
> 赞同：1
> 
> 时间：2012-12-30T18:56:44.117
> 
> 标签：asp.net, exception-handling

当我启动我的程序时，我会立即在我的日志文件中记录一个“文件不存在”错误。然后，我尝试创建一个没有任何母版页的干净 Web 表单，但仍然收到此错误，这很奇怪，但可能对我有好处的是它不会像捕获的通常异常那样执行重定向。从记录的文件中，我无法从消息中看出任何内容。有人有线索吗？谢谢。

```
 void Application_Error(object sender, EventArgs e)
        {
            // Code that runs when an unhandled error occurs       
            Exception objErr = Server.GetLastError().GetBaseException();
            log.Error(objErr.Message, objErr);
            Response.Redirect("~/error.aspx");
        }

ERROR 11 GoogleMap_AutoFill_with_Obtain_LatLong.Global - File does not exist.
System.Web.HttpException (0x80004005): File does not exist.
   at System.Web.StaticFileHandler.GetFileInfo(String virtualPathWithPathInfo, String physicalPath, HttpResponse response)
   at System.Web.StaticFileHandler.ProcessRequestInternal(HttpContext context, String overrideVirtualPath)
   at System.Web.DefaultHttpHandler.BeginProcessRequest(HttpContext context, AsyncCallback callback, Object state)
   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

# javascript - 使用 doT.js 进行递归

> ID：14093607
> 
> 赞同：6
> 
> 时间：2012-12-30T18:57:09.807
> 
> 标签：javascript, templates, dot.js

假设我有这样的数据结构：

```
{ list: [ {
         name: "1",
         children: [{
               name: "1.1",
               children: []
            },
            {
               name: "1.2",
               children: [{
                     name: "1.2.1",
                     children: []
                  }
               ]
            }
         ]
      },
      {
         name: "2",
         children: [{
               name: "2.1",
               children: [{
                     name: "2.1.1",
                     children: []
                  },           
                  {
                     name: "2.1.2",
                     children: []
                  },               
                  {
                     name: "2.1.3",
                     children: []
                  }
               ]
            },
            {
               name:  "2.2",
               children: []
            },
            {
               name: "2.3",
               children: []
            }
         ]
      },
      {
         name: "3",
         children: [{
               name: "3.1",
               children: []
            }
         ]
      }
   ]
} 
```

我将如何使用 doT.js 创建一个模板，该模板将递归地遍历对象并构建嵌套列表？

使用递归函数直接在 JS 中构建 html 字符串非常简单：( [http://jsfiddle.net/fergal_doyle/WN8hZ/5/](http://jsfiddle.net/fergal_doyle/WN8hZ/5/) )

```
var html = "";
function buildList(a){

    if (a.length == 0){return};

    html += "<ul>";
    for (var i = 0; i < a.length; i++)
    {
        html += "<li>" + a[i].name;
        buildList(a[i].children);
        html += "</li>";
    }
    html += "</ul>";            
}
buildList(data.list);

$("#out").html(html); 
```

~~但是使用 doT.js 这就是我所拥有的，然后我就难住了！( [http://jsfiddle.net/fergal_doyle/BTZpu/4/](http://jsfiddle.net/fergal_doyle/BTZpu/4/) )~~

**编辑：** 我可以通过将一些 JS 与评估混合来做到这一点（[http://jsfiddle.net/fergal_doyle/he8AN/](http://jsfiddle.net/fergal_doyle/he8AN/)）

```
{{ function buildList(a) { }}

    {{?a.length}}
    <ul>
        {{~a :v}}
        <li>
            {{=v.name}}
            {{ buildList(v.children); }}
        </li>
        {{~}}
    </ul>
    {{?}}

{{ } }}

{{ buildList( it.list ); }} 
```

我试图使用部分来实现它。定义一个 ul 片段然后让该片段调用自己作为参数传入一个数组，但我得到一个“递归过多”错误。如果有任何方法可以使下面的工作，它比我认为的上面要整洁得多。( [http://jsfiddle.net/fergal_doyle/qazGe/4/](http://jsfiddle.net/fergal_doyle/qazGe/4/) )

```
{{##def.ul:a:
    <ul>
    {{~a :value}}
        <li>{{=value.name}}{{#def.ul:value.children}}</li>
    {{~}}
    </ul>
#}}

{{#def.ul:it.list}} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-08T01:16:58.660

问题是在编译时。doT.js 似乎没有处理部分递归。您的递归代码`{{#def.ul:value.children}}`使 doT.js 库无限地用您的函数内容解析/替换它。解决此问题的一种方法是使用**arguments.callee**在您的部分中引用您的部分。这是你的[**FIDDLE的一个分支**](http://jsfiddle.net/8LRPg/)

```
{{##def.ul:a:
  <ul>
  {{~a :value}}
    <li>{{=value.name}}{{=arguments.callee(value.children)}}</li>
  {{~}}
  </ul>
#}}

{{#def.ul:it}} 
```

库的作者可以通过以下方式（未经测试）在他们的库中实现相同的想法：

```
function resolveDefs(c, block, def) {
    return ((typeof block === 'string') ? block : block.toString())
    .replace(c.define || skip, function(m, code, assign, value) {
        if (code.indexOf('def.') === 0) {
            code = code.substring(4);
        }
        if (!(code in def)) {

            // HANDLE RECURSION START
            value = value.replace(c.use || skip, function(m, recursiveCode) {
                if (c.useParams) return recursiveCode.replace(c.useParams, function(m, s, d, param) {
                    if(d == code) {
                        var ret = s + "{{=arguments.callee(";
                        if(param)
                            ret += param;
                        return ret + ")}}";
                    }
                });

            })
            // HANDLE RECURSION END

            if (assign === ':') {
... 
```

# opengl - 计算机图形学的转变

> ID：14093609
> 
> 赞同：0
> 
> 时间：2012-12-30T18:57:15.133
> 
> 标签：opengl, graphics, transformation

我正在尝试学习这门有关计算机图形学的课程，但我被困在作业中 1\. 我不明白向量`eye`和`up`. 作业的描述可以[在这个链接](http://inst.eecs.berkeley.edu/~cs184/fa12/assignments/hw1.pdf)中找到，还有第一个作业的骨架。

到目前为止，我有以下代码：

```
// Transform.cpp: implementation of the Transform class.

#include "Transform.h"

//Please implement the following functions:

// Helper rotation function.  
mat3 Transform::rotate(const float degrees, const vec3& axis) {
  // Please implement this.
    float radians = degrees * M_PI / 180.0f;
    mat3 r1(cos(radians));
    mat3 r2(0, -axis.z, axis.y, axis.z, 0, -axis.x, -axis.y, axis.x, 0);
    mat3 r3(axis.x*axis.x, axis.x*axis.y, axis.x*axis.z,
            axis.x*axis.y, axis.y*axis.y, axis.y*axis.z,
            axis.x*axis.z, axis.z*axis.y, axis.z*axis.z);
    for(int i = 0; i < 3; i++){
        for(int j = 0; j < 3; j++){
            r2[i][j] = r2[i][j]*sin(radians);
            r3[i][j] = r3[i][j]*(1-cos(radians));
        }
    }
    return r1 + r2 + r3;
}

// Transforms the camera left around the "crystal ball" interface
void Transform::left(float degrees, vec3& eye, vec3& up) {
    eye = eye * rotate(degrees, up);
}

// Transforms the camera up around the "crystal ball" interface
void Transform::up(float degrees, vec3& eye, vec3& up) {
    vec3 newAxis = glm::cross(eye, up);
}

// Your implementation of the glm::lookAt matrix
mat4 Transform::lookAt(vec3 eye, vec3 up) {
    return lookAtMatrix;
}

Transform::Transform()
{

}

Transform::~Transform()
{

} 
```

对于该`left`方法，它似乎在做正确的事情，即围绕 y 轴旋转对象（实际上我不确定对象是在移动还是我正在移动的是相机，有人可以澄清一下吗？） .

对于`up`我无法使其工作的方法，它将围绕 x 轴旋转对象（或相机？）（至少我是这么认为的）。

最后，我不明白该`lookAt`方法应该做什么。

有人可以帮助我了解要执行的操作吗？有人可以解释向量`eye`和的作用是什么`up`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:11:36.687

视图转换通常使用“查看”功能来实现。这个想法是你指定相机在哪里，它正在看什么方向，以及在你的特定空间中哪个方向代表“向上”，然后你会得到一个代表该变换的矩阵。

看起来您正在尝试实现某种“旋转球”导航控制。这相当简单——水平运动应该围绕某个“Y”轴旋转，而垂直运动应该围绕“右”（或 X）轴旋转。通常，这些旋转围绕当前视图轴工作，而不是全局工作，因此移动是直观的。我不确定你在寻找什么。

查看功能的工作原理如下。

表示旋转的 3x3 矩阵可以被视为由您正在转换的空间的 3 个垂直单位轴组成。因此，如果您可以提供这些向量，则可以构建矩阵。

第一个轴很容易。相机通常朝向“Z”方向看，所以如果你从相机的位置取代表被观察物体方向的向量，然后对其进行归一化，这就是 Z 轴。

然后您需要定义一个不同的“向上”向量 - (0,1,0) 是典型的，但在 Z 轴指向同一方向的情况下，您需要选择不同的向量。

这个“向上”向量和“Z”轴的叉积给出了“X”轴——这是因为叉积给出了一个垂直向量，构成水平的方向将垂直于“向前”方向，并且“向上'。

然后“X”和“Z”轴的叉积得到“Y”轴（不一定与“Y”轴相同——考虑看向天花板或地板）。

这三个归一化的轴 (x,y,z) 直接形成一个旋转矩阵。

矩阵的平移部分通常是相机的位置，由旋转的逆转换（这样当通过观察矩阵本身转换相机位置时，它应该最终回到原点）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T21:11:17.743

1）你的课程使用的是OpenGL库，你的作业是填写骨架模块“Transform.cpp”。

2）您要询问的方法是“mat4 Transform::lookAt(vec3 eye, vec3 up)”：

> `lookAt`：最后，您需要在给定眼睛和向上向量的变换矩阵中进行编码。你可能需要参考课堂笔记来做到这一点。它可能有助于定义一个 uvw 坐标系（作为 3 个向量），并建立一个辅助 4 4 矩阵 M，该矩阵作为此函数的结果返回。请参阅本部分的课堂笔记和讲座。

3）在课堂笔记和讲座中应该提示“眼睛”和“向上”这两个论点的含义。

4) 另一个提示是“定义一个 uvw 坐标系（作为三个向量），并建立一个辅助 4x4 矩阵......作为结果返回......”。

5）最后的提示：

问：OpenGL mat3 和 mat4 有什么区别？

> A: [glsl 中提取 mat3(a mat4 matrix) 语句是做什么的？](https://stackoverflow.com/questions/10879864/what-extractly-mat3a-mat4-matrix-statement-in-glsl-do)
> 
> `mat3(MVI) * normal`
> 
> 从 4x4 矩阵返回上面的 3x3 矩阵，并将法线乘以该矩阵。该矩阵称为“正常矩阵”。你用它把你的法线从世界空间带到眼睛空间。
> 
> 原始矩阵是 4x4 而不是 3x3 的原因是因为 4x4 矩阵允许您进行仿射变换并包含透视渲染的有用信息。但是要从世界空间到眼睛空间的法线，您只需要 3x3 模型视图矩阵。

# arrays - 从主数组中抓取某些行以插入到另一个数组中以复制到目标表中

> ID：14093612
> 
> 赞同：2
> 
> 时间：2012-12-30T18:58:27.700
> 
> 标签：arrays, excel, vba, sorting

我有一个很大的电子表格，我会解析为其他电子表格。我有一些工作，虽然很慢。

我读到使用数组是一种更好的方法。

如何从主数组中获取某些行并将它们插入另一个数组以在最后复制到目标表中？

以下是原始的工作功能：

```
Private Function CopyValues(rngSource As Range, rngTarget As Range)
    rngTarget.Resize(rngSource.Rows.Count, rngSource.Columns.Count).Value = rngSource.Value
End Function

Private Function RESORT(FROMSHEET As Variant, Column As Variant, TOSHEET As Variant, EXTRA1 As Variant, EXTRA2 As Variant, EXTRA3 As Variant)
    Set i = Sheets(FROMSHEET)
    Set e = Sheets(TOSHEET)

    Dim d
    Dim j
    Dim q
    d = 1
    j = 2

    e.Select
    Cells.Select
    Selection.Clear
    i.Select
    Rows(1).Copy
    e.Select
    Rows(1).PasteSpecial

    Do Until IsEmpty(i.Range("G" & j))
        If i.Range(Column & j) = "Total" Then
            i.Select
            Rows(j).Copy
            e.Select
            Rows(2).PasteSpecial
            ' CopyValues i.Rows(j), e.Rows(2)
            Exit Do
        End If
        j = j + 1
    Loop

    d = 2
    j = 2

    Do Until IsEmpty(i.Range("G" & j))

        If i.Range(Column & j) = TOSHEET Or i.Range(Column & j) = EXTRA1 Or i.Range(Column & j) = EXTRA2 Or i.Range(Column & j) = EXTRA3 Then
            d = d + 1
            CopyValues i.Range(i.Cells(j, 1), i.Cells(j, 11)), e.Range(e.Cells(d, 1), e.Cells(d, 11)) 'e.Range("A" & d)

        ElseIf i.Range("A" & j) = e.Range("A" & d) And i.Range("I" & j) = "Total" Then
            d = d + 1
            e.Select
            Rows(2).Copy
            Rows(d).PasteSpecial
            ' CopyValues e.Rows(2), e.Rows(d)
        End If
        j = j + 1
    Loop
    e.Select
    Rows(2).Delete
    Range("A1").Select

End Function 
```

这就是我正在破解的内容，其中有许多不同的尝试：

```
Private Function RESORT2(FROMSHEET As Variant, Column As Variant, TOSHEET As Variant, EXTRA1 As Variant, EXTRA2 As Variant, EXTRA3 As Variant)
    ' Set i = Sheets(FROMSHEET)
    ' Set e = Sheets(TOSHEET)
    Dim d
    Dim j As Long
    Dim i As Long
    Dim k As Long

    Dim myarray As Variant
    Dim arrTO As Variant

    d = 1
    j = 1

    'myarray = Worksheets(FROMSHEET).Range("a1").Resize(10, 20)
    myarray = Worksheets(FROMSHEET).Range("a1:z220").Value 'Resize(10, 20)
    For i = 1 To UBound(myarray)
        If myarray(i, 9) = TOSHEET Then
            'arrTO = myarray
            '  Worksheets(TOSHEET).Range("A" & j).Resize(1, 20) = Application.WorksheetFunction.Transpose(myarray(i))
            Worksheets(TOSHEET).Range("A" & j).Value = Application.WorksheetFunction.Transpose(myarray)
            '   arrTO = j 'Application.WorksheetFunction.Index(myarray, 0, 1)

            j = j + 1

        End If

    Next
    Worksheets(TOSHEET).Range("a1").Resize(10, 20) = arrTO

End Function 
```

**第一次编辑**
我尝试清理：

```
Private Function RESORT(FROMSHEET As Variant, Column As Variant, TOSHEET As Variant, EXTRA1 As Variant, EXTRA2 As Variant, EXTRA3 As Variant)
    Set FRO = Sheets(FROMSHEET)
    Set TOO = Sheets(TOSHEET)

    Dim TOO_IND
    Dim FRO_IND
    Dim TotalRow

    TotalRow = 2
    TOO_IND = 2
    FRO_IND = 2

    TOO.Cells.Clear
    TOO.Rows(1).Value = FRO.Rows(1).Value

    Do Until IsEmpty(FRO.Range("G" & TotalRow))
        If FRO.Range(Column & TotalRow) = "Total" Then
            FRO.Select
            Rows(TotalRow).Copy
            TOO.Select
            Rows(2).PasteSpecial
            ' CopyValues FRO.Rows(j), TOO.Rows(2)
            Exit Do
        End If
        TotalRow = TotalRow + 1
    Loop

    Do Until IsEmpty(FRO.Range("G" & FRO_IND))

        If FRO.Range(Column & FRO_IND) = TOSHEET Or FRO.Range(Column & FRO_IND) = EXTRA1 Or FRO.Range(Column & FRO_IND) = EXTRA2 Or FRO.Range(Column & FRO_IND) = EXTRA3 Then
            TOO_IND = TOO_IND + 1
            TOO.Rows(TOO_IND).Value = FRO.Rows(FRO_IND).Value
        ElseIf FRO.Range("A" & FRO_IND) = TOO.Range("A" & TOO_IND) And FRO.Range("I" & FRO_IND) = "Total" Then
            TOO_IND = TOO_IND + 1
            TOO.Select
            Rows(2).Copy
            Rows(TOO_IND).PasteSpecial
         '   TOO.Rows(TOO_IND).PasteSpecial = FRO.Rows(2).PasteSpecial  ' this isn't working, I need format and formula, if I just do .formula it doesn't work
        End If
        FRO_IND = FRO_IND + 1
    Loop

    TOO.Rows(2).Delete
    'Range("A1").Select

End Function 
```

它更慢（在我最小的样本集上为 3.2 秒对 2.86 秒）。

我认为阵列将成为解决方案。我在同一个样本集上多次运行此例程，但使用不同的限定符，如果主要我将样本集转储到一个数组中，然后将此数组传递给此排序例程，我认为它会更快。我仍然不知道如何对数组进行操作，特别是从数组复制一行到数组。

**第二次编辑**
我现在更接近了！曾经需要约 133 秒，现在只需 10.51 秒！

我还在努力修剪一些时间。我还没有编写任何代码来抓取一次数组，然后将数组传递给 RESORT 函数，我正在研究下一个，看看这是否有助于加快速度。

有没有办法将公式和值复制到同一个数组中？我不喜欢我这样做的方式，但它确实有效。

```
Private Function RESORT(FROMSHEET As Variant, Column As Variant, TOSHEET As Variant, EXTRA1 As Variant, EXTRA2 As Variant, EXTRA3 As Variant)
    Set FRO = Sheets(FROMSHEET)
    Set TOO = Sheets(TOSHEET)

    Dim TotalRow

    TotalRow = 2
    TOO_IND = 2
    FRO_IND = 2

    Dim Col As Long
    Dim FROM_Row As Long
    Dim TO_Row As Long

    Const NumCol = 25

    Dim myarray As Variant
    Dim myarrayform As Variant
    Dim arrTO(1 To 1000, 1 To 2000)
    Dim arrTotal(1 To 1, 1 To NumCol)

    TO_Row = 2
    myarray = Worksheets(FROMSHEET).Range("a1:z1000").Value
    myarrayform = Worksheets(FROMSHEET).Range("a1:z1000").FormulaR1C1

    TOO.Cells.Clear

    For Col = 1 To NumCol
        arrTO(1, Col) = myarray(1, Col)
    Next

    For FROM_Row = 1 To UBound(myarray)
        If myarray(FROM_Row, Column) = "Total" Then
            For Col = 1 To NumCol
                arrTotal(1, Col) = myarrayform(FROM_Row, Col)
            Next
            Exit For
        End If
    Next

    For FROM_Row = 1 To UBound(myarray)
        If myarray(FROM_Row, Column) = TOSHEET Or myarray(FROM_Row, Column) = EXTRA1 Or myarray(FROM_Row, Column) = EXTRA2 Or myarray(FROM_Row, Column) = EXTRA3 Then
            For Col = 1 To NumCol
                arrTO(TO_Row, Col) = myarray(FROM_Row, Col)
            Next
            TO_Row = TO_Row + 1
        ElseIf myarray(FROM_Row, 1) = arrTO(TO_Row - 1, 1) And myarray(FROM_Row, Column) = "Total" Then
            For Col = 1 To NumCol
                arrTO(TO_Row, Col) = arrTotal(1, Col)
            Next
            TO_Row = TO_Row + 1
        End If
    Next
    Worksheets(TOSHEET).Range("a1").Resize(1000, 2000) = arrTO

End Function 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T01:07:31.667

在 VBA 中迭代数组不一定比迭代第一个方法使用的集合对象快。集合很可能被实现为链表，因此为了从头开始并循环它们，它们将与数组一样快。

高级别的答案是，您的排序算法*通常*比您的特定代码细节重要得多。也就是说，只要您的详细信息不会以某种方式增加运行该算法的复杂性。

根据我的经验，加速 VBA 的最佳方法是避开所有对 UI 有影响的函数。如果您的代码在选定的单元格周围移动，或切换积极查看的工作表等，那是最大的时间。我认为那些功能`Select`,`Copy()`和`PasteSpecial()`可能是有罪的。最好存储工作表和范围对象，并根据需要直接写入它们的单元格。您在第二种方法中这样做，我认为这比更改数据类型更重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T02:15:34.523

我同意@Seth Battin 的观点，但还有一些额外的东西要补充。

虽然数组可以更快，但如果您需要搜索它们，它们的扩展性并不好。您编写的代码将遍历您的数据集 n 次（其中 n 是`TOSHEET`您拥有的 s 的数量）。此外，您的代码为每一行将数据写入工作表一次（这很耗时），将所有数据放入单个二维数组并写入一次会更快（但代码更多）。

更好的程序流程可能是

读取每一行数据

将其分配给数据结构（我会使用包含二维数组的脚本字典）

读取所有数据后，迭代输出每个二维数组的脚本字典

这将最大限度地减少对电子表格的读取和写入，这是此类 vba 程序的性能瓶颈所在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T04:27:37.807

是的。您肯定会通过使用数组而不是单元格集合来加速您的代码。这是因为访问对象的属性需要时间。

老实说，您的代码可能不会从使用数组中受益匪浅，因为您的代码通过消除不必要的循环得到了更合理的修改。

我以更加以 Excel 为中心的方式重写了 RESORT 函数的开头，避免了一些陷阱，例如选择。我还建议尝试使用有意义的变量名，尤其是对于对象。

```
OPTION EXPLICIT
Private Function RESORT(FROMSHEET As Variant, Column As Variant, TOSHEET As Variant, EXTRA1 As Variant, EXTRA2 As Variant, EXTRA3 As Variant)
'Actually indicate variable types.
dim i as worksheet, dim e as worksheet
dim searchRange as Range

Set i = Sheets(FROMSHEET)
Set e = Sheets(TOSHEET)

Dim d as long
Dim j as long
dim lastRow as long 'Using a meaningful variable name
d = 1
j = 2

'I'm assuming you were using PasteSpecial because you only want values.
'I removed your unnecessary selects
e.Cells.Clear
'Move values directly instead of copy paste
i.Rows(1).value = e.Rows(1).value

'Check the first range
If Not IsEmpty(.Range("G" & j)) Then
    'Determine the last row to check.
    'This would break if j is equivalent to the last possible row... 
    'but only an example
    If IsEmpty(.Range("G" & j+1) then
        lastRow = j
    else 
        lastrow = i.Range("G" & j).End(xlDown).Row
    end if
    'Get the search Range
    'We might have used arrays here but it's less complicated to 
    ' use built in functions.
    Set searchRange = i.Range(i.Range(Column & j), _
                      i.Range(Column, lastrow).Find("Total"))
    If Not (searchRange Is Nothing) Then
        'Copy the values of the found row.
        e.Rows(2).value = searchRange.EntireRow.value
    End If
End If 
```

这样做之后，我意识到可能更合理地使用数组的部分是在我停止的地方之后。如果你想在这里使用数组，你需要做的是有效地将所有相关区域复制到一个数组中，然后像引用单元格一样引用数组。

例如：

```
myArray = i.Range("A1:B10")
MsgBox myArray(10, 2) 'Displays value of B10 (10th row, 2nd column)
MsgBox i.Cells(10, 2) 'Displays value of B10 (10th row, 2nd column) 
```

# c - 为什么 wav 文件头中的 0x4e0 而不是 0x0？

> ID：14093616
> 
> 赞同：0
> 
> 时间：2012-12-30T18:58:43.240
> 
> 标签：c, wav, binaryfiles

我有一个名为“file.wav”的 wav 文件，我想用 C 程序读取文件的一些规范。[我在这里](https://ccrma.stanford.edu/courses/422/projects/WaveFormat/)找到了 wav 文件的结构。根据这个文档，在普通的 wav 文件中，AudioFormat 字节应该是 0x1 和 0x0，或者 NumChannels 字节应该是（如果是单声道）0x1 和 0x0；有很多类似的部分应该看起来像这样。

现在，我的 C 程序非常简单：我以二进制模式打开文件，寻找 AudioFormat 部分（第 20 个字节），读取两个字节并将它们放入缓冲区；然后我打印到标准输入缓冲区内容。

```
#include <stdio.h>

main()
{
    void *buf[2];
    FILE *f;
    f=fopen("file.wav", "rb");

    fseek(f, 20, SEEK_SET); 
    fread(buf, 1, 2, f);
    printf("example: %#hx %#hx\n", buf[0], buf[1]);
/*the '#' flag stands for the 0x[···] format output, 
the 'h' says that the number is a short integer (2 bytes).*/

    return 0;
} 
```

我的问题是第二个字节而不是 0x0 始终是 0x4e0，对于每个应该为 0 的字节（例如 NumChannels 或 BitPerSamples 字节）。问题是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T19:02:12.577

如果幸运的话，您会在运行时收到编译警告或崩溃。尽管我认为对于这种特殊情况您不会，但我认为您所做的实际上并不是*undefined behavior*。你的问题的核心是当你声明这个时：

```
void *buf[2]; 
```

您将*buf 声明为指向 void 的指针的数组 2*。当您访问时，`buf[0]`您不是在读取*字节*，而是在读取*指针*。可以说更多来解释正在发生的事情，但我认为这对于您正在尝试做的事情已经足够了：

```
char buf[2]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:18:43.323

正如其他人所提到的，您正在读取指针数组。

其次是音频格式字段是 2 个字节。

```
FILE *f;
short afmt;

if((f = fopen("file.wav", "rb")) == NULL)
   err(1, "fopen");
fseek(f, 20, SEEK_SET);
fread(&afmt, sizeof(short), 1, f);
printf("audio format: 0x%hx\n", afmt);
fclose(f); 
```

# sql - 如何可视化存储过程

> ID：14093618
> 
> 赞同：-2
> 
> 时间：2012-12-30T18:58:56.517
> 
> 标签：sql, sql-server

提供可视化 SQL Server 存储过程的功能的工具有哪些？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:02:17.027

如果您的意思是编辑或创建它们，SQL Server Management Studio 将允许您执行此操作，并附带 SQL Server。SSMS 还允许您调试存储过程。安装了 SSDT（SQL Server 开发工具）的 Visual Studio 也将允许您执行此操作，并且实际上在允许您调试存储过程方面做得更好。在 SSMS 中调试存储过程对我来说一直是个问题。

SSDT 可以为 VS 2010 或 VS 2012 安装。事实上，你甚至不需要拥有 Visual Studio 来安装 SSDT。如果您在没有 VS 的情况下安装它，它将安装一个 VS shell，并允许您执行 SSDT 的全部功能，而无需安装 Visual Studio。

# html - 用边框制作截止角

> ID：14093619
> 
> 赞同：8
> 
> 时间：2012-12-30T18:58:59.060
> 
> 标签：html, css, shape, css-shapes

我想在 html 中制作一个具有截止角并在形状周围有边框的形状。

我可以制作没有边框的截断形状，如下所示：

html:

```
<div class="cut-off"></div> 
```

CSS：

```
 .cut-off{
   position:relative;
   top:400px;
   left:400px;
   height:155px;
   width:200px;
   background:red;
}
.cut-off:after{
   position:absolute;
   bottom:0px; right:-20px;
   content:".";
   text-indent:-999px; overflow:hidden;
   display:block;
   width:0px; height:0px;
   border-top: 20px solid green;
   border-right: 20px solid transparent;
}
.cut-off:before{
   position:absolute;
   top:0; right:-20px;
   content:"#";
   text-indent:-999px; overflow:hidden;
   display:block;
   background:blue;
   width:20px; height:135px;
} 
```

[小提琴在这里](http://jsfiddle.net/KR3XK/)

现在我想要一个围绕形状的边框。我该怎么做？

我想要一个像这样的形状：

![形状](../Images/3bd429effb6700f9a1076c06a01ac630.png)

充满了颜色。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T19:27:40.333

通过稍微改变你的 html 结构，我可以做到[这一点](http://jsfiddle.net/KR3XK/13/)

```
<div class="cut-off"></div>
<div class="cut-off2"></div>​

.cut-off{
position: relative;
width: 300px;
height: 150px;
border-bottom: 80px red solid;
border-right: 80px transparent solid;
}

.cut-off2{
position: absolute;
z-index: -1;
top:0;
left: 0;
width: 305px;
height: 150px;
border-bottom: 82px blue solid;
border-right: 80px transparent solid;
}

p{
position: absolute;
left: 0;
bottom:-40px;

} 
```

​</p>

基本上，它在现有的 div 下添加了另一个 div。对于 cuttof 效果，它使用边框尺寸。

编辑：我还提供了一种在该区域中包含内容的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T21:08:02.863

试试这个：

```
<div class="cut-off">content</div>​​​​​​​​​​​
.cut-off{
   position:relative;
   height:155px;
   width:200px;
   background:red;
}
.cut-off:after{
   position:absolute;
   bottom:0px; right:-20px;
   content:".";
   text-indent:-999px; overflow:hidden;
   display:block;
   width:0px; height:0px;
   border-top: 20px solid green;
   border-right: 20px solid transparent;
}
.cut-off:before{
   position:absolute;
   top:0; right:-20px;
   content:"#";
   text-indent:-999px; overflow:hidden;
   display:block;
   background:blue;
   width:20px; height:135px;
} 
```

顺便说一句，我在以下页面中找到了这个示例（因此我没有声称代码是我的）：[http ://www.wahnbriefe.net/web-design/css-cut-off-corners](http://www.wahnbriefe.net/web-design/css-cut-off-corners)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-30T20:13:09.963

我不确定这是否是您正在寻找的，但我认为您可以使用 CCS3 边界半径属性来实现它。也许值得一看。也许您可以尝试以下方法：

```
<div class="cut-off">
    <p class="text">Simple text</p>
</div>​

 .cut-off{
    position: relative;
    width: 300px;
    height: 150px;
    border: 1px solid #7A7764;
    border-radius: 0 75px 0 0;

}

.text {
    margin: 15px;
} 
```

​</p>

# css - 在锚点中将图像向右对齐

> ID：14093620
> 
> 赞同：-1
> 
> 时间：2012-12-30T18:59:02.597
> 
> 标签：css, alignment

有人可以帮我将`<a>`标签中的图像向右对齐吗？文字应该有`float: left`和图片`float: right`。图像也应该垂直居中。我不知道，我怎么能做到这一点。有人可以帮我吗？

这是我的代码[http://jsfiddle.net/Vf99v/](http://jsfiddle.net/Vf99v/)。

在此先感谢您的帮助！

亲切的问候，嘘

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T19:06:06.743

附加

```
#main-nav li a img {
    display: block;
    float: right;

}
​ 
```

在您的 CSS 中并尝试。

另外，也许您应该在 HTML 中编写图像的高度和宽度，以便更好地浏览器呈现。

# c++ - 派生对象地址分配给基指针和调用析构函数的机制

> ID：14093621
> 
> 赞同：0
> 
> 时间：2012-12-30T18:59:13.223
> 
> 标签：c++, destructor

假设我有一个基类指针，基类具有虚函数。如果我使用基类指针指向派生类对象，那么编译器如何知道它是要调用的该虚函数的派生版本，因为在分配时派生类地址将被转换为基类类型，为什么不't 编译器会产生错误，因为两者的内存布局可能不同。

而且，如果我已声明基类析构函数为虚拟并删除具有派生类地址的基指针，那么编译器如何知道我实际上正在删除派生对象。

```
class a{
public:
virtual ~a(){}
virtual void f(){}
};
class b:public a
{
  public:
  ~b(){}
  void f(){ cout<<"hi";}
};
main()
{
  a *aptr;
  aptr=new b;   //here aptr has the address of b;
  delete aptr;  //since pointer type is base class so how will compiler know that
                //it has to call derived's destructor,also their names are different
                //as one is a and another is b. 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:03:28.387

要通过基指针实际删除派生类，您需要将析构函数声明为虚拟的。否则会造成严重破坏（实际上是*未定义的行为*，大致相同）。

至于`virtual`功能如何实现：取决于实现。如果不询问具体的实现，就不可能得到真正的答案。最有可能的实现是[vtables](http://en.wikipedia.org/wiki/Virtual_method_table)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:03:35.670

它不会（或它会）。`virtual`通过指向没有析构函数的基类型的指针删除派生类型的对象是未定义的行为。

# algorithm - 在未排序的数组中查找特定比率。时间复杂度

> ID：14093623
> 
> 赞同：1
> 
> 时间：2012-12-30T18:59:16.813
> 
> 标签：algorithm, optimization, complexity-theory, big-o, mergesort

这是一个家庭作业。

目标是用伪代码提供一种算法，该算法将搜索数字数组（不指定整数或 > 0）并检查任何两个数字的比率是否等于给定的 x。时间复杂度必须低于 O(nlogn)。

我的想法是对数组进行归并排序（O(nlogn) 时间），然后如果 |x| > 1 开始按降序检查每个数字（使用二进制遍历算法）。检查每个数字也应该花费 O(logn) 时间，最坏的情况是 n 次检查总共需要 O(nlogn)。如果我没有遗漏任何东西，这应该给我们一个 O(nlogn) + O(nlogn) = O(nlogn) 的最坏情况，在分配的参数内。

我意识到排序后从哪里开始检查比率并不重要，但时间成本按 1/2 摊销）。

我的逻辑正确吗？有更快的算法吗？

一个例子，以防不清楚：

给定一个数组 { 4, 9, 2, 1, 8, 6 }

如果我们要搜索比率为 2：

1.  合并排序 { 9, 8, 6, 4, 2, 1 }

2.  由于给定的比率 >1，我们将从左到右搜索。

2a. 第一个数字是 9。检查 9 / 4 > 2。检查 9/6 < 2 下一个数字。2b。第二个数字是 8。检查 8 / 4 = 2。完成

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T05:27:56.037

要解决这个问题，只需要 O(nlgn) 就足够了

第一步，对数组进行排序。花费 O(nlgn)

step 2，检查比例是否存在，这一步只需要o(n)

你只需要两个指针，一个指向第一个元素（最小的），另一个指向最后一个元素（最大的）。

计算比率。

如果比率大于指定的比率，则将第二个指针移动到其前一个元素。

如果比率小于指定的比率，则将第一个指针移动到其下一个元素。

重复上述步骤，直到：

1.  你找到确切的比例，或者

2.  第一个指针到达终点，或者第二个指针到达起点

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T19:46:00.863

您提出的分析是正确的，是解决此问题的绝佳方法。排序确实在 O(n log n) 时间内起作用，并且 2n 二进制搜索也需要 O(n log n) 时间。也就是说，我认为您不想在这里使用“摊销”一词，因为它指的是不同类型的分析。

作为如何加快解决方案速度的提示，您的解决方案的总体思路是可以有效地查询任何数字，该数字是否存在于数组中。这样，您可以遍历所有数字并寻找任何可以使比率起作用的东西。但是，如果您在数组外部使用支持快速访问的辅助数据结构，则可能会以增加内存使用量为代价来减少运行时间。尝试考虑哪些数据结构支持非常快速的访问（例如，O(1) 查找），看看您是否可以在这里使用它们中的任何一个。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T21:50:05.977

(1) 建立这个数组的hashmap。时间成本：O(n)

(2) 对于每个元素 a[i]，在 HashMap 中搜索 a[i]*x。时间成本：O(n)。

总成本：O(n)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T19:49:05.813

你的算法的复杂度是 O( n²)，因为在对数组进行排序之后，你迭代每个元素（最多*n*次）并且在每次迭代中你最多执行*n - 1**个*除法。

相反，在对数组进行排序后，遍历每个元素，并在每次迭代中将元素除以比率，然后查看结果是否包含在数组中：

*   除法：O(1)
*   在排序列表中搜索：O(log *n* )
*   对每个元素重复：*n*次

导致时间复杂度 O( *n* log *n* )

在您的示例中：

*   9/2 = 4.5（未找到）
*   8/2 = 4（找到）

# symfony - Symfony2 和连接

> ID：14093625
> 
> 赞同：1
> 
> 时间：2012-12-30T18:59:25.783
> 
> 标签：symfony, doctrine

我现在完全失去了平衡，因为我花了几个小时在谷歌上搜索并没有找到任何可靠的东西。我想`leftJoin`在 Symfony2 中做一个（使用 Doctrine）。从文档中，我在这里：

```
$ownRepo = $this->getDoctrine()
    ->getRepository('GameShelfUsersBundle:Ownership');

$ownQuery = $ownRepo->createQueryBuilder('own')
    ->where('own.user = :user')
    ->andWhere('own.own = :type')
    ->setParameters(array(
        'user' => $user,
        'type' => $type
    ))
    ->orderBy('own.updated','desc')
    ->getQuery();

$own = $ownQuery->getResult(); 
```

现在，看在上帝的份上，我该怎么办`leftJoin`？我尝试添加

> ->leftJoin('GameShelfGamesBundle:Games','g')

有各种添加（`ON own.game = g.id`等），但它根本不起作用。有什么帮助吗？我还是这方面的新手 ;(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T20:16:19.927

[Symfony2 使用 Doctrine2 作为 ORM，所以在教义文档](http://docs.doctrine-project.org/en/latest/)中查找这个主题是个好主意。从[文档](http://docs.doctrine-project.org/en/latest/reference/query-builder.html#high-level-api-methods)：

```
leftJoin('own.games', 'g') 
```

这仅在您的 Ownership 类中的属性被调用时才有效`games`！

# matlab - 如何从终端运行 matlab 脚本的多个实例？

> ID：14093627
> 
> 赞同：1
> 
> 时间：2012-12-30T18:59:33.707
> 
> 标签：matlab, terminal

我的目标是从终端运行具有多个实例的相同 matlab 脚本是否可以用 matlab 做到这一点？如果是我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T19:32:01.097

在 Linux 中使用`&`不等待子进程结束。

```
n = 5;

for i=1:n
    system('matlab -desktop -r ls &');
end 
```

替换`ls`为您希望运行的函数的名称。

`system`,`unix`和`dos`命令是可以互换的。

# dart - 如何在 Dart 中找到未使用的 TCP 端口？

> ID：14093628
> 
> 赞同：6
> 
> 时间：2012-12-30T18:59:36.110
> 
> 标签：dart

我正在尝试启动一个进程并告诉它使用未使用的 TCP 端口。不幸的是，我正在启动的二进制文件不会探测未使用的端口。我有没有一种体面的方法来探测 Dart 中的端口，以便我可以将其用作我的进程的参数？

我能想到的最好的方法是创建一个`ServerSocket`端口为 0 的端口，然后关闭套接字并使用它的端口，但这对我来说似乎很棘手。

有人有更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T23:46:58.637

我将添加我的“hack”作为答案，因为我想不出另一种方式，而且它似乎工作得很好。

这是我的`getUnusedPort()`功能：

```
import 'dart:io';

Future<int> getUnusedPort(InternetAddress address) {
  return ServerSocket.bind(address ?? InternetAddress.anyIPv4, 0).then((socket) {
    var port = socket.port;
    socket.close();
    return port;
  });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-28T23:30:17.200

上面是活泼的，因为一旦套接字关闭，另一个进程可以回收端口。使用[https://chromium.googlesource.com/external/github.com/dart-lang/test/+/master/pkgs/test_core/lib/src/util/io.dart#147中的模式](https://chromium.googlesource.com/external/github.com/dart-lang/test/+/master/pkgs/test_core/lib/src/util/io.dart#147)

```
Future<T> getUnusedPort<T>(FutureOr<T> Function(int port) tryPort) async {
  T value;
  await Future.doWhile(() async {
    value = await tryPort(await getUnsafeUnusedPort());
    return value == null;
  });
  return value;
} 
```

# android - 对话框标题太高

> ID：14093631
> 
> 赞同：1
> 
> 时间：2012-12-30T18:59:42.503
> 
> 标签：android, android-layout, android-widget

如何降低绿色标题的高度？

活动：

```
final Dialog dialog = new Dialog(EditorActivity.this, R.style.dialog);
dialog.setContentView(R.layout.preference_timerange);
dialog.setTitle(getString(R.string.zmien_czas_wyprawy)); 
```

样式.xml

```
<style name="dialog" parent="@android:style/Theme.Dialog">
    <item name="android:windowTitleStyle">@style/dialog_title_style</item>
    <item name="android:windowBackground">@color/dialog_background</item>
    <item name="android:textColor">@color/dialog_text</item>
</style>

<style name="dialog_title_style" parent="android:TextAppearance.WindowTitle">
    <item name="android:textSize">16dp</item>
    <item name="android:background">@color/dialog_title_background</item>
    <item name="android:textColor">@color/dialog_title_text</item>
</style> 
```

[![截屏](../Images/a53ad8bac2f2cf24419d10215c73707f.png)](https://i.stack.imgur.com/HVUFj.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:23:10.917

我不知道如何更改对话框标题的高度，但您可以删除整个标题并在布局中创建一个较小的标题`preference_timerange.xml`：

```
final Dialog dialog = new Dialog(EditorActivity.this, R.style.dialog);
dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
dialog.setContentView(R.layout.preference_timerange);

// Set R.string.zmien_czas_wyprawy as the title in your layout now 
```

# javascript - 如何检查一个数字是否在一个数字中多次使用

> ID：14093632
> 
> 赞同：1
> 
> 时间：2012-12-30T18:59:44.850
> 
> 标签：javascript

示例：我们有数字`1122`。我想检查给定的数字是否多次包含该数字`1`。在这种情况下，它应该返回`true`.

我需要代码灵活，它必须与任何数字一起使用，例如`3340`,`5660`等`4177`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:07:42.443

您可以通过调用方法或连接轻松地*“强制”* JS 将任何数值强制转换为字符串：`toString`

```
var someNum = 1122;
var oneCount = (someNum + '').split('1').length; 
```

通过将数字连接到空字符串，变量被强制转换为字符串，因此您可以使用您喜欢的所有字符串方法（`.match`, `.substring`, `.indexOf`, ...）。
在这个例子中，我选择在每个`'1'`字符上拆分字符串，计算并使用结果数组的长度。如果长度 > 2，那么你就知道你需要知道什么了。

```
var multipleOnes = ((someNum + '').split('1').length > 2);//returns a bool, true in this case 
```

为了回应您的评论，使其灵活-编写一个简单的函数即可：

```
function multipleDigit(number, digit, moreThan)
{
    moreThan = (moreThan || 1) + 1;//default more than 1 time, +1 for the length at the end
    digit = (digit !== undefined ? digit : 1).toString();
    return ((someNum + '').split(digit).length > moreThan);
}
multipleDigit(1123, 1);//returns true
multipleDigit(1123, 1, 2);//returns false
multipleDigit(223344,3);//returns 3 -> more than 1 3 in number. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:07:28.923

```
function find(num, tofind) {
   var b = parseInt(num, 10);
   var c = parseInt(tofind, 10);
   var a = c.split("");
   var times = 0;
   for (var i = 0; i < a.length; i++) {
      if (a[i] == b) {
         times++;
      }
   }
   alert(times);
}

find('2', '1122'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T19:03:56.103

使用javascript的[`match()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/match)方法。本质上，您需要做的是首先将数字转换为字符串。数字没有 RegExp 方法。之后，全局匹配数字 1 并计算结果（匹配返回一个包含所有匹配结果的数组）。

```
​var number = 1100;
console.log(number.toString().match(/1/g).length);​ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T19:28:20.687

将数字转换为字符串并对其进行迭代。为提高效率，一旦找到第二个数字就返回 true。

```
function checkDigitRepeat(number, digit) {
    var i, count = 0;

    i = Math.abs(number);
    if(isNaN(i)) {
        throw(TypeError('expected Number for number, got: ' + number));
    }
    number = i.toString();

    i = Math.abs(digit);
    if(isNaN(i)) {
        throw(TypeError('expected Number for digit, got: ' + digit));
    }
    digit = i.toString();

    if(digit > 9) {
        throw(SyntaxError('expected a digit for digit, got a sequence of digits: ' + digit));
    }

    for(i = 0; i < number.length; i += 1) {
        if(number[i] === digit) {
            count += 1;
            if(count >= 2) { return true; }
        }
    }

    return false;
} 
```

如果您想检查一系列数字，您的解决方案可能在于使用正则表达式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-30T19:15:29.137

```
var myNum = '0011';

var isMultipleTimes = function(num) {
    return !!num.toString().match(/(\d)\1/g);
}

console.log(isMultipleTimes(myNum)); 
```

JavaScript[匹配](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/match)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-18T14:49:49.343

使用**@Aspiring Aqib**的答案，我制作了一个实际上以我想要的方式正常工作的功能。

它的工作方式是：

> 示例执行：`multDig('221','2')`

1.  `number` *将（第一个参数）*拆分为一个数组，其中每个元素都是一个数字。
    *输出：`['2','2','1']`*
2.  运行一个`for`循环，检查每个数组元素是否与`digit` *(第二个参数)*匹配，如果匹配则增加`times`变量。
    *输出：`2`*
3.  如果已经检测到匹配，请检查 for 循环内部以提高更长数字的性能，例如`2211111111111111`
4.  *`true`*如果多次找到该数字，则返回，否则返回*`false`*。

最后是代码本身：

```
function multDig(number, digit){
    var finalSplit = number.toString().split(''), times = 0;
    for (i = 0; i < finalSplit.length; i++){
        if (finalSplit[i] == digit){
            times++
        }
        if (times > 1){
            return true;
        }
    }
    return false;
} 
```

# google-analytics - 谷歌分析 op_scope 用于页面跟踪

> ID：14093633
> 
> 赞同：1
> 
> 时间：2012-12-30T18:59:45.757
> 
> 标签：google-analytics

Javascript Google Analytics 提供了一个 setCustomVar 方法，允许我们提交将出现在报告中的自定义数据。但是，我不清楚 opt_scope 参数：

```
opt_scope   Optional. The scope used for the custom variable. Possible values are 1 for visitor-level, 2 for session-level, and 3 for page-level. 
```

[https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiBasicConfiguration#_gat.GA_Tracker_._setCustomVar](https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiBasicConfiguration#_gat.GA_Tracker_._setCustomVar)

我在哪里可以找到有关这三个选项的更多信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T19:22:14.883

[Tracking Custom Variables](https://developers.google.com/analytics/devguides/collection/gajs/gaTrackingCustomVariables)很好地描述了 Google Analytics 中的自定义变量范围。

> 这三个交互级别中的每一个都定义了访问者参与的特定范围。这种区别对自定义变量很重要，因为每个自定义变量都被限制在一个特定的范围内。例如，您可能想知道访问者从购物车中移除商品的会话数。对于这种特殊情况，您可以将自定义变量定义到会话级别，以便将该访问者的整个会话标记为从在线购物车中删除项目的会话。

# javascript - JavaScript 在数组中查找项目的最有效函数？并解释这个棘手的代码

> ID：14093638
> 
> 赞同：4
> 
> 时间：2012-12-30T19:00:31.380
> 
> 标签：javascript, recursion

什么是在数组中查找项目的最有效方法，这是合乎逻辑的并且被 Web 开发人员理解？

我遇到了这段代码：

```
var inArray = function(a, b, c, d) {
    for (c in b) d |= b[c] === a;
    return !!d
}; 
```

它工作正常。有人可以解释一下代码吗？
我还遇到了一个[完全相同的问题](https://stackoverflow.com/questions/143847/best-way-to-find-an-item-in-a-javascript-array)，可能会使我的问题重复。但我真正的问题在于对上述代码的解释以及为什么在其中使用位运算符。
此外，是否有一种方法无需任何 for 循环或迭代来获取数组中项目的索引？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T19:18:40.667

```
var inArray = function(a, b, c, d) {
    for (c in b) d |= b[c] === a;
    return !!d
}; 
```

那是一些糟糕的代码，你应该远离它。位运算符在这里完全没有必要，`c`而且`d`作为参数根本没有意义（正如 Raymond Chen 指出的那样，代码的作者可能是为了声明局部变量的安全空间而这样做的——但问题是 if`true`被传入`d`代码突然被破坏，额外的参数破坏了看一眼声明会提供的任何理解感）。

我将解释代码，但首先，这是一个更好的选择：

```
function inArray(arr, obj) {
    for (var i = 0; i < arr.length; ++i) {
        if (arr[i] === obj) {
            return true;
        }
    }
    return false;
} 
```

请注意，这取决于数组是实际数组。您可以使用`for (k in arr)`类型循环将其推广到所有对象。

* * *

无论如何，继续解释：

```
for (c in b) d |= b[c] === a; 
```

这意味着对于 b 中的每个键（存储在 中`c`），我们将检查是否`b[c] === a`。换句话说，我们正在对数组进行线性扫描，并对照`a`.

`d |= val`是按位或。中的高位`val`将设置为高`d`。这在位比在 JS 中更暴露的语言中更容易说明，但它是一个简单的说明：

```
10011011
01000001
--------
11011011 
```

它只是将每个单独的位与另一个值中的相同位置位进行或运算。

它在这里被滥用的原因是它使代码复杂化并且它依赖于奇怪的隐式强制转换。

`x === y`返回一个布尔值。在按位表达式中使用布尔值没有什么意义。但是发生的事情是布尔值被转换为非零值（可能`1`）。

同样，将`undefined`是什么`d`。这意味着`d`它将被转换`0`为按位的东西。

`0 | 0 = 0`，但是`0 | 1 = 1`。所以基本上它是一个美化的：

```
for (c in b) d = (d || (b[c] === a)); 
```

至于`!!x`那只是用来将某些东西转换为布尔值。 `!x`将采用 x，将其隐式转换为布尔值，然后将其取反。然后额外的`!`将再次否定它。因此，它可能会隐式转换为布尔值（`!!x`为真意味着 x*至少*是松散的真（`1`,`"string"`等），并`!!x`暗示*至少*`x`是松散的假（,等）。*`0``""`*

 ** * *

[这个答案](https://stackoverflow.com/a/143863/567864)提供了更多选择。请注意，尽管所有这些都是为了回退到本机`indexOf`，这几乎肯定会比我们在脚本领域中编写的任何代码都要快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T19:19:12.010

> 什么是在数组中查找项目的最有效方法，这是合乎逻辑的并且被 Web 开发人员理解？

本机方法[`haystack.indexOf(needle) !== -1`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/indexOf)或尽快返回的循环方法

```
function inArray(needle, haystack) {
    var i = haystack.length;
    while (i) if (haystack[--i] === needle) return true;
    return false;
}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T19:04:22.663

这段代码写得很糟糕，几乎不可读。我不认为它是“真棒”...

这是一个重写的版本，希望更具可读性：

```
function inArray (aElt, aArray) {
  var key;
  var ret = false;
  for (key in aArray)
    ret = ret || (aArray[key] === aElt);
  return ret;
} 
```

for 循环似乎是最自然的方法。您可以递归地执行此操作，但这并不是这里最简单的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-30T20:03:37.660

你要求一个递归版本

```
var inArray = function(arr, needle, index) {
    index = index || 0;
    if (index >= arr.length)
        return false;
    return arr[index] === needle
         ? true
         : inArray(arr, needle, index + 1);
}

console.log(inArray([1,5,9], 9)); 
```*

# java - 如何在 Android 中创建 10x10 网格？

> ID：14093642
> 
> 赞同：4
> 
> 时间：2012-12-30T19:00:48.907
> 
> 标签：java, android, xml, gridview, imagebutton

我正在创建一个小型战舰游戏，对于 Android UI，我希望创建一个 10x10 的图像按钮网格或其他东西（任何简单的东西）。我正在关注[此链接提供的教程](http://developer.android.com/guide/topics/ui/layout/gridview.html)

我的问题是我无法以正确的 10x10 格式显示图像。使用 GridView，我在 XML 中将 num_columns 设置为“10”，但行数没有这样的属性。由于手机尺寸不同，有没有办法让 10x10 网格自动适应任何屏幕？

按照上面链接中的步骤，我可以显示 100 张可点击的图像，但我的问题在于格式。这是上述结果的屏幕截图： ![在此处输入图像描述](../Images/065badb36523ce3b32f7be72df6b436c.png)

我尝试更改 XML 中的值以缩小图像，但不知道如何做。抱歉缺少代码片段，但除了垂直和水平间距之外，我真的没有从上面链接中给出的示例中改变太多。

将不胜感激任何启示，即使只是说我完全错误地解决了这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T19:10:28.417

您可以通过表格布局来实现这一点：[http ://www.mkyong.com/android/android-tablelayout-example/](http://www.mkyong.com/android/android-tablelayout-example/)

GridViews，就像 ListViews 被设计为包含任意数量的行一样。

但我真的怀疑你想在游戏中使用视图，而不仅仅是使用画布、绘制任何东西并检测点击，而不依赖视图内置机制。这是更多的工作，但你最终会得到一些让你更自由地做你想做的事情的事情（例如，不必处理容器的行数......）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:33:47.557

转到此[链接](http://www.mkyong.com/android/android-gridview-example/)并尝试第二个示例自定义适配器示例。只需将 android:numColumns="auto_fit" 更改为 android:numColumns="10"。

```
<?xml version="1.0" encoding="utf-8"?>
<GridView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/gridView1"
    android:numColumns="10"
    android:gravity="center"
    android:columnWidth="100dp"
    android:stretchMode="columnWidth"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

</GridView> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T19:13:39.447

你可以用 a 做你想做的事`GridLayout`，但不能用 a `GridView`（它会自动垂直滚动）。使用 a `GridLayout`，将所有按钮的布局宽度和高度设置为 0dp，并将其布局重力设置为`fill`。

# c# - 如何从我的数据库中输出 html

> ID：14093643
> 
> 赞同：0
> 
> 时间：2012-12-30T19:01:02.377
> 
> 标签：c#, html, asp.net-mvc, razor

我正在显示我的“新闻”页面，我希望客户能够输出一些简单的 html。

我的观点是这样的：

```
@using SuburbanCustPortal.SuburbanService

    <br />

    @foreach (var item in (IEnumerable<TokenNews>) ViewBag.News)
    {
      <div class="fulldiv">
        <fieldset> 
          <legend>@item.Title</legend>
          <div>
            @item.Body
          </div>    
        </fieldset>
      </div>
    } 
```

当我这样做时，浏览器不会呈现 html，它只是将 html 显示为文本。

我可以输出浏览器呈现它的html的任何方式吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T19:03:27.183

您没有确切指定哪个部分显示为文本，但如果是`item.Body`，请`@Html.Raw(item.Body)`改为执行。这会将一个字符串变成一个 IHtmlString，其目的是告诉 Razor，这个东西可以保证按原样输出是安全的，并且不会包含像 XSS 攻击这样的讨厌的东西（在使用 Html.Raw 时确保这一点是你的工作）。所有不是 IHtmlString 的东西都会被 Razor 自动转义。

# javascript - 我的网站搜索表单的输入字段不接受输入

> ID：14093650
> 
> 赞同：0
> 
> 时间：2012-12-30T19:01:45.327
> 
> 标签：javascript, html, css

我的网站是[http://1stbirthdaypartytheme.com/](http://1stbirthdaypartytheme.com/) 我的网站搜索表单的输入字段不接受 FireFox 17.01 中的输入。搜索在 Chrome 和 IE 中正常工作 换句话说，如果您在 Firefox 中打开我的网站，标题的右上角有一个搜索字段，就在我的社交联系按钮下方。如果将光标放在输入框中并键入，则不会发生任何事情。当您单击放大镜时，您将返回主页。我该怎么做，或者我需要做什么来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:57:05.527

当我在 DOM Inspector 中覆盖这个位时，它开始在 Firefox 中工作：

```
<SCRIPT TYPE="text/javascript"> 
<!-- 
function disableselect(e){
    return false
} 
function reEnable(){
    return true
} 
document.onselectstart=new Function ("return false") 
if (window.sidebar){
    document.onmousedown=disableselect
    document.onclick=reEnable
}
// -->
</SCRIPT> 
```

也就是说，禁用网页上的“右键单击”只会使调试变得更加困难。不要禁用“右键单击”，这样做没有意义：

[如何禁用右键单击我的网页？](https://stackoverflow.com/questions/737022/how-do-i-disable-right-click-on-my-web-page)

[http://www.sitepoint.com/dont-disable-right-click/](http://www.sitepoint.com/dont-disable-right-click/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:07:50.047

此页面有很多验证错误。我假设其中一些导致该字段出现故障。[请通过此验证器](http://validator.w3.org/check)运行您的代码并消除错误。

# apache - 服务器如何维护会话

> ID：14093658
> 
> 赞同：2
> 
> 时间：2012-12-30T19:02:36.967
> 
> 标签：apache, session, web-applications, webserver

任何人都知道网络服务器（apache，tomcat）如何维护会话？

我知道如何创建/处理和销毁会话。我需要知道的是服务器如何在内部维护会话。

即如果有 10 个用户连接到服务器，服务器如何识别哪个会话属于特定用户

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:07:04.503

会话通常由具有每个用户唯一 ID 的 cookie 标识。ID 是在首次创建会话时生成并作为 cookie 发送的（即当用户还没有 cookie 时）。

有时看到的另一种方法是将会话 ID 保留在 URL 中，当客户端出于某种原因拒绝接受 cookie 时使用此方法。但是，这有许多缺点，例如如果用户将其 URL 粘贴到另一个用户时的安全问题，必须将 ID 添加到所有链接，以及丑陋的 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:12:09.797

严格来说，您的网络服务器（Apache）没有“会话”的概念；它只是[根据 HTTP 协议理解请求](http://www.garshol.priv.no/download/text/http-tut.html)。

事实上，HTTP 以“无状态协议”而闻名——没有“会话”的概念。这是 HTTP 可扩展性的基础，但也使得构建需要状态的 Web 应用程序变得困难。

所以不同的web应用框架都引入了“session”的概念。

Tomcat 严格来说并不是一个 Web 服务器，它是一个 servlet 容器。

# php - 固定链接不起作用

> ID：14093661
> 
> 赞同：0
> 
> 时间：2012-12-30T19:02:54.670
> 
> 标签：php, wordpress

我有一个博客页面，当您单击“阅读更多”或博客标题时，它将在单独的页面中打开该博客以进行阅读。但是，当我单击这两件事时，我收到以下消息：

> 服务器错误 网站在检索 mywebsite/wordpress/?p=20 时遇到错误。它可能因维护而停机或配置不正确。以下是一些建议： 稍后重新加载此网页。HTTP 错误 500（内部服务器错误）：服务器尝试完成请求时遇到了意外情况。

这是代码：

```
<div class="box">
<?php while ( have_posts() ) : the_post(); ?>
        <article>
            <h2><a href="<?php esc_url( the_permalink() ); ?>"<?php the_title(); ?>" rel="bookmark"><?php the_title(); ?></a></h2>
            <h7>BY LOUIS MOORE ON</h7> <time datetime="<?php the_time( 'Y-m-d' ); ?>" pubdate><?php the_date(); ?> <?php the_time(); ?></time><?php the_content(); ?>
<a href="<?php esc_url( the_permalink() ); ?>"/><h8>READ MORE</a></h8>  </br>   
</br><div class="h9"></div>
</article></br></br></br>
<?php endwhile; ?>
</div> 
```

我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:06:10.947

你应该尝试删除`esc_url`......
除了`</h8>`在`a`标签内移动

```
<a href="<?php the_permalink(); ?>"><h8>READ MORE</h8></a> 
```

**更新**

让我们调试，把它放在你的 wp-config 中：

```
define('WP_DEBUG', true);
define('WP_DEBUG_LOG', true); // creates and update wp-content/debug.log
define('WP_DEBUG_DISPLAY', true);
@ini_set('display_errors', 1); 
```

在屏幕上获取错误信息，这是一个开发阶段，对吧？

# java - Java图形绘制方法执行流程

> ID：14093664
> 
> 赞同：0
> 
> 时间：2012-12-30T19:02:57.183
> 
> 标签：java, class, action, paint, abstract

我遇到了这段代码。我想在我在编程过程中遇到任何问题之前，我可以缓解这种困惑。我无法理解绘画或 actionPerformed 方法是否首先在 Board 类中执行。我希望我的 java 评论是正确的。

问题是，我在夏天学习了 Java 入门，而图形是在课程结束时才介绍的。该类使用了 ImageIcon，我们从未接触过 drawImage 方法和 Image 抽象类。我也完全不懂绘画方法。这段代码比我参加的 Java 图形讲座更复杂。基于 Java API，paint 方法源自 JPanel 的超类 JComponent 类。

那么paint方法所采用的这个参数Graphics g是什么，我应该如何考虑呢？paint 方法如何知道要绘制图形类的哪个对象。我查看了 Java API，它说 Graphics 是一个抽象类。如果 g 的数据类型是抽象的，它怎么可能是一个对象？我说 g 是一个对象，因为代码正在调用对象 g 的 drawImage 方法。

附带说明一下，重绘方法是否意味着擦除 JPanel 中的内容并像渲染一样重绘整个组件？

```
public class Board extends JPanel implements ActionListener{

private Image apple;
private int apple_x;
private int apple_y;

// over-riding the paint method from the JComponent Class
public void paint(Graphics g){
                // recursively call the paint method
                super.paint(g);

                g.drawImage(apple, apple_x, apple_y, this); 
    }

 // does this method gets called first or the top one?
 public void actionPerformed(ActionEvent e) {

        repaint();
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:10:25.653

用 Java 绘图（以及基本上所有当前的窗口系统）遵循好莱坞原则：

> 你不给我打电话；我打电话给你。

即，您可以告诉系统某个区域需要重新绘制 ( `repaint()`)。但是您必须等到系统调用您进行绘图。在 Java 中，系统将调用该`paint()`方法并传递给您一个`Graphics`用于绘图的实例。

所以事件的顺序是：

1.  `actionPerformed()`
2.  `paint()`

`Graphics`通常称为图形上下文。它是用于绘图的对象。根据系统和当前要求，绘图可能会直接出现在屏幕上，也可能会进入屏幕外缓冲区，然后再复制到屏幕上。该`Graphics`实例负责处理细节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:10:17.950

如果我错了，有人可以纠正我。

是的，图形是一个抽象类。但是任何继承 Graphics 的类（如 Graphics2D）的实例都可以作为图形传递。如果我没记错的话，这是调用向上转换。g 由调用paint() 的UI 线程传递，因为对象已失效或必须更新。

图形对象是对显示给用户的实际位图的引用。

# android - http://localhost/GS 在 Android Emulator 的浏览器上不起作用

> ID：14093671
> 
> 赞同：-1
> 
> 时间：2012-12-30T19:03:29.510
> 
> 标签：android, browser, sencha-touch-2

我在此链接[http://docs.sencha.com/touch/2-0/#!/guide/getting_started](http://docs.sencha.com/touch/2-0/#!/guide/getting_started)上关注 Sencha touch 的官方文档，我下载了 Sencha Touch 2 SDK 和 SDK 工具，我已经生成了应用程序 GS .. /GS 命令，它工作正常。然后我在 Android 模拟器的浏览器中录制了 http:/localhost/GS/，但它显示错误。它不显示默认的 sencha 应用程序。谁能告诉我为什么？还有其他解决方案吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T19:21:20.150

在您的 Android 模拟器上尝试 10.0.2.2/GS/。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T19:22:54.880

找到您正在使用的电脑的本地 IP - 转到命令行并键入“ipconfig”来获取它。

使用您的本地 ip 为您的 android 设备连接到您的本地主机。

例如：192.168.1.x/GS .. 而不是“本地主机”

它对我有用。

# java - 从 JAX_WS Web 服务返回对象集合

> ID：14093677
> 
> 赞同：0
> 
> 时间：2012-12-30T19:04:06.247
> 
> 标签：java, jax-ws

在我的网络服务中，我想返回一个对象集合取决于客户端请求，例如（字符串集合、自定义类..），我的代码：

```
@XmlRootElement(name="ResultObject")
public class ResultObject
{
private Object _Contents;  // this object should contain the collection
private int _ErrorCode;

.....
} 
```

但是当尝试返回 ArrayList 或字符串数​​组时，会出现以下异常：

> 2012 年 12 月 30 日下午 5:49:21 com.sun.xml.ws.transport.http.servlet.WSServletDelegate doGet 严重：捕获可抛出的 javax.xml.ws.WebServiceException：javax.xml.bind.MarshalException - 带有链接异常： [javax.xml.bind.JAXBException: 类 java.util.ArrayList 或其任何超类在此上下文中是已知的。] 在 com.sun.xml.ws.message.jaxb.JAXBMe​​ssage.writePayloadTo(JAXBMe​​ssage.java:322 ) 在 com.sun.xml.ws.encoding.StreamSOAPCodec.encode(StreamSOAPCodec.java:108) 在 com.sun.xml 的 com.sun.xml.ws.message.AbstractMessageImpl.writeTo(AbstractMessageImpl.java:142)。 ws.encoding.SOAPBindingCodec.encode(SOAPBindingCodec.java:265) 在 com.sun.xml.ws.transport.http.HttpAdapter.encodePacket(HttpAdapter.java:320) 在 com.sun.xml.ws.transport.http。 HttpAdapter.access$100(HttpAdapter.java:93) 在 com.sun.xml.ws.transport.http.HttpAdapter$HttpToolkit.handle(HttpAdapter.java:454) 在 com.sun.xml.ws.transport.http.HttpAdapter.handle(HttpAdapter.java:244)在 com.sun.xml.ws.transport.http.servlet.ServletAdapter.handle(ServletAdapter.java:135) 在 com.sun.xml.ws.transport.http.servlet.WSServletDelegate.doGet(WSServletDelegate.java:129)在 com.sun.xml.ws.transport.http.servlet.WSServletDelegate.doPost(WSServletDelegate.java:160) 在 com.sun.xml.ws.transport.http.servlet.WSServlet.doPost(WSServlet.java:75)在 javax.servlet.http.HttpServlet.service(HttpServlet.java:641) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:722)java:244) 在 com.sun.xml.ws.transport.http.servlet.ServletAdapter.handle(ServletAdapter.java:135) 在 com.sun.xml.ws.transport.http.servlet.WSServletDelegate.doGet(WSServletDelegate. java:129) 在 com.sun.xml.ws.transport.http.servlet.WSServletDelegate.doPost(WSServletDelegate.java:160) 在 com.sun.xml.ws.transport.http.servlet.WSServlet.doPost(WSServlet. java:75) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:641) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:722)java:244) 在 com.sun.xml.ws.transport.http.servlet.ServletAdapter.handle(ServletAdapter.java:135) 在 com.sun.xml.ws.transport.http.servlet.WSServletDelegate.doGet(WSServletDelegate. java:129) 在 com.sun.xml.ws.transport.http.servlet.WSServletDelegate.doPost(WSServletDelegate.java:160) 在 com.sun.xml.ws.transport.http.servlet.WSServlet.doPost(WSServlet. java:75) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:641) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:722)160) 在 com.sun.xml.ws.transport.http.servlet.WSServlet.doPost(WSServlet.java:75) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:641) 在 javax.servlet.http .HttpServlet.service(HttpServlet.java:722)160) 在 com.sun.xml.ws.transport.http.servlet.WSServlet.doPost(WSServlet.java:75) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:641) 在 javax.servlet.http .HttpServlet.service(HttpServlet.java:722)

在搜索解决方案后，一些帖子建议使用注释，但 _Contents 对象是动态集合，我无法修复它的内容。

请指教，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T20:22:21.670

_Contents成员需要一个[@XmlAnyElement](http://docs.oracle.com/javaee/5/api/javax/xml/bind/annotation/XmlAnyElement.html)注释，但我对此不太熟悉。也许这篇文章会对您有所帮助：[使用@XmlAnyElement 构建通用消息](http://blog.bdoughan.com/2010/08/using-xmlanyelement-to-build-generic.html)

# android - 谷歌地图中的标记需要很长时间才能更新

> ID：14093683
> 
> 赞同：0
> 
> 时间：2012-12-30T19:05:03.200
> 
> 标签：android, performance, google-maps

我正在使用谷歌地图来标记几个以相等的时间间隔更新的位置。他们工作正常的标记没有问题。但是在更新标记和放大地图时，标记会消失并且需要很长时间才能在地图中标记。看样子，人好像一下子就消失了。

我正在使用计数器类以相等的间隔调用更新标记工作线程。

**柜台类**

```
 public class MyCount extends CountDownTimer{

    public MyCount(long millisInFuture, long countDownInterval) {
    super(millisInFuture, countDownInterval);
    }

    @Override
    public void onFinish() {
        new MapUpdater().execute("");
        resetTimer();                 
    }

    public void resetTimer()
    {
        counter = new MyCount(5000,1000);
            counter.start();
    }

    @Override
    public void onTick(long millisUntilFinished) {
    }

 } 
```

**MapUpdater 异步任务**

```
 private class MapUpdater extends AsyncTask<String, Integer, String> {
   @Override
   protected void onPreExecute() {
      Log.d("ASYN", "STARTED");
      map.invalidate();
         itemizedoverlay.doPopulate();
      }
   @Override
   protected String doInBackground(String... params) {
       updatePosition();
       return "finished";
   }

   @Override
   protected void onProgressUpdate(Integer... values) {
      super.onProgressUpdate(values);
   }

   @Override
   protected void onPostExecute(String result) {
         super.onPostExecute(result);
         itemizedoverlay.doPopulate();
         Log.d("ASYN", "ENDED");
   } 
```

}

**updatePosition() 方法**

```
 public void updatePosition()
     {
    try{
                lat_coordinates[]= CustomHttpClient.executeHttpPost("http://10.0.2.2/return_coord.php", postParameters);
                lng_coordinates[]= CustomHttpClient.executeHttpPost("http://10.0.2.2/return_coord.php", postParameters);
     }catch (Exception e) {
            e.printStackTrace();
     }
            itemizedoverlay.removeAllOverlay();
            itemizedoverlay.doPopulate();

             try{
                for(int i=0; i<lat_coordinates.length; i++)
                 {
                     GeoPoint point = new GeoPoint((int)(lat_coordinates[i]*1E6),(int)(lng_coordinates[i]*1E6));
                     try {
                        addresses = geocoder.getFromLocation(lat_coordinates[i],lng_coordinates[i], 1);
                    } catch (NumberFormatException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                        Log.d("update", "no format exception");
                    }catch (Exception e) {
                        Log.d("update", e.toString());
                    }
                     overlayitem = new OverlayItem(point,"title",addresses.get(0).getAddressLine(0));
                     itemizedoverlay.addOverlay(overlayitem);
                 }
             }catch(NullPointerException e){
                 e.getStackTrace();

             }
             finally{
                overlayList.add(itemizedoverlay);
         }

} 
```

有什么建议么？更新它需要很长时间才能破坏整个应用程序。

谢谢

# java - 如何使用 fill() 方法填充 Java 中特定对象的多维数组？

> ID：14093685
> 
> 赞同：2
> 
> 时间：2012-12-30T19:05:22.257
> 
> 标签：java, arrays, methods, multidimensional-array, fill

展示代码比谈论它更容易。我还在互联网上搜索了答案，但找不到任何答案，所以这是我的代码：

[http://pastebin.com/M606mXzR](http://pastebin.com/M606mXzR)

我还添加了一个输出，位于第 50-70 行。61-70 的输出是“正确的”一个，我想要的那个。

我使用 fill() 方法是错误的，还是什么？无法绕开我的头...

真的有区别吗？

```
ClassB[][] classB_2Array = new ClassB[10][10]; 
```

这之间：

```
for (ClassB[] classB_1Array : classB_2Array) {
            Arrays.fill(classB_1Array, new ClassB());
} 
```

对此：

```
for (int i = 0; i < classB_2Array.length; i++) {
    for (int j = 0; j < classB_2Array[0].length; j++) {
        classB_2Array[i][j] = new ClassB();
    }
} 
```

无论如何，只需查看我的代码并感谢大家的回答！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T19:09:16.073

回答您的问题：**是**的，有区别（请参阅[JavaDoc](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#fill%28java.lang.Object%5B%5D,%20java.lang.Object%29)）。

您的第一个版本将一个对象实例放入一行的每个数组元素中。因此，对该实例的更改在数组同一行中的每个元素中都是可见的。您`i` `ClassB`总共将拥有实例。

第二个版本将它自己的实例放入每个数组元素中。您`i*j` `ClassB`总共将拥有实例。

您的代码的第一个版本相当于

```
for (ClassB[] classB_1Array : classB_2Array) {
    ClassB instance = new ClassB();
    Arrays.fill(classB_1Array, instance);
} 
```

希望这些信息对您有所帮助，我没有查看您的 pastebin 代码。

**编辑：**

为了澄清您的误解，请仔细查看该程序的输出：

```
import java.util.Arrays;

public class ArrayFiller {
    public static void main(String[] args) {
        // your first version:
        Person[][] yourFirstVersion = new Person[2][2];
        for (Person[] array : yourFirstVersion) {
            Arrays.fill(array, new Person("Mike"));
        }
        System.out.println(Arrays.deepToString(yourFirstVersion));
        yourFirstVersion[0][1].setName("Paul");
        System.out.println(Arrays.deepToString(yourFirstVersion));
        System.out.println("-----");
        // equivalent: my version:
        Person[][] myVersion = new Person[2][2];
        for (Person[] array : myVersion) {
            Person person = new Person("John");
            Arrays.fill(array, person);
        }
        System.out.println(Arrays.deepToString(myVersion));
        myVersion[0][1].setName("Thomas");
        System.out.println(Arrays.deepToString(myVersion));
        System.out.println("-----");
        // your second version
        Person[][] yourSecondVersion = new Person[2][2];
        for (int i = 0; i < yourSecondVersion.length; i++) {
            for (int j = 0; j < yourSecondVersion[i].length; j++) {
                yourSecondVersion[i][j] = new Person("Max");
            }
        }
        System.out.println(Arrays.deepToString(yourSecondVersion));
        yourSecondVersion[0][1].setName("Chris");
        System.out.println(Arrays.deepToString(yourSecondVersion));
    }

    private static class Person {
        private String name;
        public Person(String name) {
            System.out.println("Constructor called for " + name);
            this.name = name;
        }
        public void setName(String name) {
            this.name = name;
        }
        @Override
        public String toString() {
            return name;
        }
    }
} 
```

这是输出：

```
Constructor called for Mike
Constructor called for Mike
[[Mike, Mike], [Mike, Mike]]
[[Paul, Paul], [Mike, Mike]]
-----
Constructor called for John
Constructor called for John
[[John, John], [John, John]]
[[Thomas, Thomas], [John, John]]
-----
Constructor called for Max
Constructor called for Max
Constructor called for Max
Constructor called for Max
[[Max, Max], [Max, Max]]
[[Max, Chris], [Max, Max]] 
```

# python - 为什么我的 python SIGPROF 不起作用？

> ID：14093687
> 
> 赞同：1
> 
> 时间：2012-12-30T19:05:51.200
> 
> 标签：python, signals

我正在安装 SIGPROF 信号并每 2 秒执行一次处理程序。有什么问题吗？

```
 1 #!/usr/bin/env python
  2 #-*-coding: utf-8 -*-
  3 #pylint: disable=W0141,W0613,W0603
  4 
  5 import os
  6 import sys
  7 import signal
  8 import time
  9 
 10 def myhandler(signum, frame):
 11     print "myhandler"
 12     sys.stdout.flush()
 13 
 14 signal.signal(signal.SIGPROF, myhandler)
 15 signal.setitimer(signal.ITIMER_PROF, 2, 2)
 16 print signal.getitimer(signal.ITIMER_PROF)
 17 
 18 while True:
 19     print "sleeping 1..."
 20     sys.stdout.flush()
 21     time.sleep(1) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:24:51.957

这些计时器仅在进程执行时递减，因为它大部分时间都在休眠，因此计时器到期需要很长时间，如果您从[文档](http://docs.python.org/2/library/signal.html#signal.ITIMER_PROF)中删除休眠它应该可以正常工作：

> signal.ITIMER_PROF 在进程执行和系统代表进程执行时减少间隔计时器。耦合

尝试：

```
while True:
    for i in xrange(100000):
        pass 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:29:16.890

不，它按预期工作。如[文档](http://docs.python.org/2.7/library/signal.html#signal.ITIMER_PROF)所述，ITIMER_PROF

> 当进程执行和系统代表进程执行时，都会减少间隔计时器。与 ITIMER_VIRTUAL 结合使用，此计时器通常用于分析应用程序在用户和内核空间中花费的时间。SIGPROF 在到期时交付。

由于`sleep`调用导致进程不执行任何操作，因此计时器会非常缓慢地递减。摆脱睡眠：

```
#!/usr/bin/env python
#-*-coding: utf-8 -*-
#pylint: disable=W0141,W0613,W0603

import os
import sys
import signal
import time

def myhandler(signum, frame):
    print "myhandler"
    sys.stdout.flush()

signal.signal(signal.SIGPROF, myhandler)
signal.setitimer(signal.ITIMER_PROF, 2, 2)
print signal.getitimer(signal.ITIMER_PROF)

while True:
    continue 
```

然后当它运行时，你可以看到信号在工作：

```
$ python prof.py 
(2.004125, 2.000125)
myhandler
myhandler 
```

如果您想“实时”计时（从问题中不清楚您的目标是什么）而不是处理器时间，请使用[ITIMER_REAL](http://docs.python.org/2.7/library/signal.html#signal.ITIMER_REAL)并捕获`SIGALRM`信号。

# memory - CUDA 共享内存和全局内存有什么区别？

> ID：14093692
> 
> 赞同：42
> 
> 时间：2012-12-30T19:06:18.270
> 
> 标签：memory, cuda, global, shared-memory

我对如何在 CUDA 中使用共享内存和全局内存感到困惑，尤其是在以下方面：

*   当我们使用`cudaMalloc()`时，我们得到一个指向共享内存或全局内存的指针吗？
*   全局内存是驻留在主机还是设备上？
*   任何一个都有大小限制吗？
*   哪个访问速度更快？
*   将变量存储在共享内存中与通过内核传递其地址相同吗？即而不是拥有

    ```
    __global__ void kernel() {
       __shared__ int i;
       foo(i);
    } 
    ```

    为什么不等效地做

    ```
    __global__ void kernel(int *i_ptr) {
       foo(*i_ptr);
    }

    int main() {
       int *i_ptr;
       cudaMalloc(&i_ptr, sizeof(int));
       kernel<<<blocks,threads>>>(i_ptr);
    } 
    ```

关于全局与共享内存中的特定速度问题存在许多问题，但没有一个包含在实践中何时使用其中任何一个的概述。

非常感谢

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-12-30T19:28:38.787

*   当我们使用 cudaMalloc()

    为了在 gpu 上存储可以传回主机的数据，我们需要分配内存，直到它被释放，将全局内存视为堆空间，直到应用程序关闭或被释放，它是可见的指向具有指向该内存区域的指针的任何线程和块。共享内存可以被视为具有生命的堆栈空间，直到内核的一个块完成，可见性仅限于同一块内的线程。所以 cudaMalloc 用于在全局内存中分配空间。

*   我们是否获得了指向共享内存或全局内存的指针？

    您将获得一个指向驻留在全局内存中的内存地址的指针。

*   全局内存是驻留在主机还是设备上？

    全局内存驻留在设备上。但是，有一些方法可以使用映射内存将主机内存用作“全局”内存，请参阅：[CUDA 零拷贝内存注意事项](https://stackoverflow.com/questions/5007556/cuda-zero-copy-memory-considerations)，但是，由于总线传输速度的限制，它可能会降低速度。

*   任何一个都有大小限制吗？

    全局内存的大小取决于卡与卡，从无到 32GB (V100)。而共享内存取决于计算能力。低于计算能力 2.x 的任何东西都具有每个多处理器最大 16KB 的共享内存（其中多处理器的数量因卡而异）。计算能力为 2.x 或更高的卡每个多处理器至少有 48KB 的共享内存。

    见[https://en.wikipedia.org/wiki/CUDA#Version_features_and_specifications](https://en.wikipedia.org/wiki/CUDA#Version_features_and_specifications)

    如果您使用映射内存，唯一的限制是主机有多少内存。

*   哪个访问速度更快？

    就原始数据而言，共享内存要快得多（共享内存~1.7TB/s，而全局内存~XXXGB/s）。然而，为了做任何你需要用一些东西填充共享内存的事情，你通常从全局内存中提取。如果对全局内存的内存访问是合并的（非随机的）和大字长，您可以实现接近数百 GB/s 的理论极限的速度，具体取决于卡及其内存接口。

    共享内存的使用是当您需要在一个线程块内重用已经从全局内存中提取或评估的数据时。因此，您无需再次从全局内存中提取，而是将其放入共享内存中，以供同一块内的其他线程查看和重用。

    它也很常见用作便笺簿，以减少影响可以同时运行多少个工作组的寄存器压力。

*   将变量存储在共享内存中与通过内核传递其地址相同吗？

    不，如果您传递任何地址，它始终是全局内存的地址。从主机您无法设置共享内存，除非您将其作为常量传递，内核将共享内存设置为该常量，或者将地址传递给内核在需要时将其拉出的全局内存。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-30T19:25:11.107

全局内存的内容对网格的所有线程都是可见的。任何线程都可以读取和写入全局内存的任何位置。

共享内存对于网格的每个块都是独立的。块的任何线程都可以读取和写入该块的共享内存。一个块中的线程不能访问另一个块的共享内存。

1.  `cudaMalloc`总是分配全局内存。
2.  全局内存驻留在设备上。
3.  显然，每个内存都有一个大小限制。全局内存是您正在使用的 GPU 的 DRAM 总量。例如，我使用具有 1536 MB DRAM 的 GTX460M，因此具有 1536 MB 全局内存。共享内存由设备架构指定，并基于每个块进行测量。计算能力 1.0 到 1.3 的设备默认具有`16 KB/Block`，计算 2.0 及更高版本具有`48 KB/Block`共享内存。
4.  共享内存的访问速度比全局内存快很多。它就像一个块的线程之间共享的本地缓存。
5.  不可以。只能将全局内存地址传递给从主机启动的内核。在您的第一个示例中，变量是从共享内存中读取的，而在第二个示例中，它是从全局内存中读取的。

**更新：**

Compute Capability 7.0（Volta 架构）的设备允许为每个块分配高达 96 KB 的共享内存，前提是满足以下条件。

*   共享内存是动态分配的
*   `cudaFuncSetAttribute`在启动内核之前，使用如下函数指定动态共享内存的最大大小。

* * *

```
__global__ void MyKernel(...)
{
    extern __shared__ float shMem[];
}

int bytes = 98304; //96 KB
cudaFuncSetAttribute(MyKernel, cudaFuncAttributeMaxDynamicSharedMemorySize, bytes);

MyKernel<<<gridSize, blockSize, bytes>>>(...); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-30T19:19:45.770

CUDA 共享内存是块内线程之间共享的内存，即网格中的块之间共享内存的内容是未定义的。它可以被认为是一个手动管理的二级缓存。

通常全局内存驻留在设备上，但最新版本的 CUDA（如果设备支持）可以将主机内存映射到设备地址空间，在这种情况下触发从主机到设备内存的原位 DMA 传输。

共享内存有大小限制，具体取决于设备。它在设备功能中报告，在枚举 CUDA 设备时检索。全局内存受限于 GPU 可用的总内存。例如，GTX680 提供 48kiB 共享内存和 2GiB 设备内存。

共享内存的访问速度比全局内存快，但访问模式必须仔细对齐（对于共享内存和全局内存）以提高效率。如果您无法正确对齐访问模式，请使用纹理（也是全局内存，但通过不同的循环和缓存访问，可以更好地处理未对齐的访问）。

> 将变量存储在共享内存中与通过内核传递其地址相同吗？

不，绝对不是。您提出的代码将是您使用原位传输的全局内存的情况。共享内存不能在内核之间传递，因为共享块的内容仅在线程的执行块中定义。

# javascript - 网页上带有文本区域的按钮

> ID：14093693
> 
> 赞同：0
> 
> 时间：2012-12-30T19:06:22.847
> 
> 标签：javascript, html

有人可以指点我一个资源，该资源显示如何将按钮添加到网页上的文本区域？类似于雅虎邮件，其中一个电子邮件地址变成了一个带有叉号的按钮，用于删除。事实上，标签是如何添加到本网站上的标签文本区域的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T19:17:41.227

有非常好的 jQuery 插件可以做到这一点。其中之一是[tag-it](http://aehlke.github.com/tag-it/)库。您可以在此页面上找到示例，以及有关如何使用它的源代码和[文档。](https://github.com/aehlke/tag-it/blob/master/README.markdown)您始终可以通过 css 根据您的需要对其进行样式设置。

# grails - Grails 中的实用石英

> ID：14093694
> 
> 赞同：0
> 
> 时间：2012-12-30T19:06:28.240
> 
> 标签：grails, quartz-scheduler

我有个问题。我想创建一个工作，但不是在应用程序启动时。我想从 pingServcie 调用方法但为空。

这是我的代码：

职位类别

```
class MyJob implements Job {

def pingService

 @Override
    void execute(JobExecutionContext context) throws JobExecutionException {
      pingService.checkPing()
   }
} 
```

我在某处读到我的 Service 类需要 bean，因为 Spring Autowire 在这种情况下不起作用，所以我创建了它（我从不使用 bean，所以如果这是正确的，我就不使用）。我创建`resources.xml`而不是`resources.groovy`

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
  <bean name="pingService" class="inzynierka.PingService" />
</beans> 
```

但这不起作用。

最后，我做了这样的事情。

```
class MyJob implements Job {

def PingService pingService

 @Override
    void execute(JobExecutionContext context) throws JobExecutionException {
      JobDataMap dataMap = context.getJobDetail().getJobDataMap();
      pingService = dataMap.getWrappedMap().get("pingService")
      pingService.checkPing()
   }
} 
```

我像这样在不同的班级传递参数

```
job.getJobDataMap().put("pingService", pingService) 
```

它有效。

# java - 允许用户在图像上手写标记 - Java、Swing

> ID：14093695
> 
> 赞同：2
> 
> 时间：2012-12-30T19:06:36.053
> 
> 标签：java, swing, handwriting

我正在使用 Java、Swing 开发应用程序。它将主要用于研究用于医学目的的五角星波形图。希望用户可以在图像上做笔记（大概类似于 Window 的油漆中使用的铅笔）。

请记住，每次用户加载图像时，都会附加以下鼠标运动侦听器（为了使图像可拖动以提高可用性）：

```
public class DragMouseListener implements MouseMotionListener {

    JLabel jl;
    int imageX, imageY;

    public DragMouseListener(JLabel jlabel) {
        this.jl = jlabel;
        jl.addMouseMotionListener(this);
    }

    @Override
    public void mouseDragged(MouseEvent e) {
        updateImagePosition(e);
    }

    @Override
    public void mouseMoved(MouseEvent e) {
    }

    private void updateImagePosition(MouseEvent e) {
        imageX = e.getX();
        imageY = e.getY();
        jl.setLocation(imageX, imageY);
    }
} 
```

到目前为止，我什至无法接近实现它的方法，而且我在 Internet 上找不到任何关于该问题的参考资料。任何帮助（甚至是粗略的想法）将不胜感激。提前致谢。

缺口

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T12:48:30.907

我尝试了您要求的内容，`DragMouseListener`但发现它非常不舒服，因此使用`JInternal Frame`它可以正常工作（但是您仍然可以在 JInternal Frame 中拖动图像，因为我实现了您的要求）。我使用了免手写`JEditorPane`（您可以添加手写如果你想要的话，但它会是一团糟）与可访问的父 JScrollPane，这样你就可以输入你想要多少。

![在此处输入图像描述](../Images/9954ff0c888d61fbd8ba305369e666ff.png) 您可以轻松拖动 JInternal Frame：

![在此处输入图像描述](../Images/a3cef2b314dd8aaa991be840130f5056.png)

注意：我为此使用了 NetBeans GUI Builder，并建议您也使用任何 GUI Builder，因为它使打字工作变得容易。

这是代码：

```
import java.awt.event.MouseEvent;

public class Move extends javax.swing.JFrame {

public Move() {
    initComponents();
}

@SuppressWarnings("unchecked")

private void initComponents() {

    jPanel1 = new javax.swing.JPanel();
    jInternalFrame1 = new javax.swing.JInternalFrame();
    jLabel1 = new javax.swing.JLabel();
    jScrollPane1 = new javax.swing.JScrollPane();
    jEditorPane1 = new javax.swing.JEditorPane();
    jInternalFrame2 = new javax.swing.JInternalFrame();
    jLabel2 = new javax.swing.JLabel();
    jScrollPane2 = new javax.swing.JScrollPane();
    jEditorPane2 = new javax.swing.JEditorPane();

    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

    jPanel1.setBackground(new java.awt.Color(0, 0, 0));

    jInternalFrame1.setVisible(true);

    jLabel1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images.jpg"))); // NOI18N
    jLabel1.setText("jLabel1");
    jLabel1.addComponentListener(new java.awt.event.ComponentAdapter() {
        public void componentMoved(java.awt.event.ComponentEvent evt) {
            jLabel1ComponentMoved(evt);
        }
    });
    jLabel1.addMouseMotionListener(new java.awt.event.MouseMotionAdapter() {
        public void mouseDragged(java.awt.event.MouseEvent evt) {
            jLabel1MouseDragged(evt);
        }
    });

    jScrollPane1.setViewportView(jEditorPane1);

    javax.swing.GroupLayout jInternalFrame1Layout = new javax.swing.GroupLayout(jInternalFrame1.getContentPane());
    jInternalFrame1.getContentPane().setLayout(jInternalFrame1Layout);
    jInternalFrame1Layout.setHorizontalGroup(
        jInternalFrame1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(jInternalFrame1Layout.createSequentialGroup()
            .addContainerGap()
            .addGroup(jInternalFrame1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 203, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addComponent(jLabel1, 0, 0, Short.MAX_VALUE))
            .addContainerGap())
    );
    jInternalFrame1Layout.setVerticalGroup(
        jInternalFrame1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(jInternalFrame1Layout.createSequentialGroup()
            .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
            .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, 250, Short.MAX_VALUE)
            .addContainerGap())
    );

    jInternalFrame2.setVisible(true);

    jLabel2.setIcon(new javax.swing.ImageIcon("E:\\untitled.png")); // NOI18N
    jLabel2.setText("jLabel2");

    jScrollPane2.setViewportView(jEditorPane2);

    javax.swing.GroupLayout jInternalFrame2Layout = new javax.swing.GroupLayout(jInternalFrame2.getContentPane());
    jInternalFrame2.getContentPane().setLayout(jInternalFrame2Layout);
    jInternalFrame2Layout.setHorizontalGroup(
        jInternalFrame2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(jInternalFrame2Layout.createSequentialGroup()
            .addContainerGap()
            .addGroup(jInternalFrame2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 222, Short.MAX_VALUE)
                .addComponent(jLabel2, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 222, Short.MAX_VALUE))
            .addContainerGap())
    );
    jInternalFrame2Layout.setVerticalGroup(
        jInternalFrame2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(jInternalFrame2Layout.createSequentialGroup()
            .addContainerGap()
            .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 36, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
            .addComponent(jLabel2)
            .addContainerGap(40, Short.MAX_VALUE))
    );

    javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
    jPanel1.setLayout(jPanel1Layout);
    jPanel1Layout.setHorizontalGroup(
        jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(jPanel1Layout.createSequentialGroup()
            .addContainerGap()
            .addComponent(jInternalFrame1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addGap(177, 177, 177)
            .addComponent(jInternalFrame2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addContainerGap(71, Short.MAX_VALUE))
    );
    jPanel1Layout.setVerticalGroup(
        jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
            .addGap(49, 49, 49)
            .addComponent(jInternalFrame1)
            .addGap(209, 209, 209))
        .addGroup(jPanel1Layout.createSequentialGroup()
            .addGap(31, 31, 31)
            .addComponent(jInternalFrame2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addContainerGap(166, Short.MAX_VALUE))
    );

    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
    getContentPane().setLayout(layout);
    layout.setHorizontalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
    );
    layout.setVerticalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
    );

    pack();
}

private void jLabel1ComponentMoved(java.awt.event.ComponentEvent evt) {

}

private void jLabel1MouseDragged(java.awt.event.MouseEvent evt) {
   updateImagePosition(evt);

}
private void updateImagePosition(MouseEvent evt) {
   int imageX = evt.getX();
 int   imageY = evt.getY();
    jLabel1.setLocation(imageX, imageY);
}
public static void main(String args[]) {
    java.awt.EventQueue.invokeLater(new Runnable() {
        public void run() {
            new Move().setVisible(true);
        }
    });
}

private javax.swing.JEditorPane jEditorPane1;
private javax.swing.JEditorPane jEditorPane2;
private javax.swing.JInternalFrame jInternalFrame1;
private javax.swing.JInternalFrame jInternalFrame2;
private javax.swing.JLabel jLabel1;
private javax.swing.JLabel jLabel2;
private javax.swing.JPanel jPanel1;
private javax.swing.JScrollPane jScrollPane1;
private javax.swing.JScrollPane jScrollPane2;

} 
```

**更新 ：**

请参阅@mKorbel 和 @trashgod 回答的这篇文章，以使 JInternal 框架最小化/最大化和调整大小。很好的答案[。](https://stackoverflow.com/questions/9414728/minimizing-jinternal-frame-without-clicking-the-button)

# java - Java Apache HttpComponents，如何读取 POST 响应？

> ID：14093698
> 
> 赞同：2
> 
> 时间：2012-12-30T19:07:08.063
> 
> 标签：java, apache, post

我正在使用 Java 中的 HttpComponents 将登录信息发布到网站。登录后，我想发送更多 POST 数据，具体取决于返回的网页。我不确定如何实际打印或查看服务器由于发送我的 POST 数据而返回的 html/网页（也许我正在寻找的是响应正文？）。

所有教程似乎只显示如何查看标头信息或服务器代码。我认为这可能是我缺少的一些简单的东西。可能我不太了解这个过程。

到目前为止我的代码：

```
public class httpposter {
    public static void main(String[] args) throws Exception {
        DefaultHttpClient httpclient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost("http://hroch486.icpf.cas.cz/cgi-bin/echo.pl");
        List <NameValuePair> nvps = new ArrayList <NameValuePair>();
        nvps.add(new BasicNameValuePair("username", "vip"));
        nvps.add(new BasicNameValuePair("password", "secret"));
        httpPost.setEntity(new UrlEncodedFormEntity(nvps));
        HttpResponse response2 = httpclient.execute(httpPost);
        try {
            System.out.println(response2);
            HttpEntity entity2 = response2.getEntity();
            // do something useful with the response body
            // and ensure it is fully consumed
            EntityUtils.consume(entity2);
        } finally {
            httpPost.releaseConnection(); }} } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T19:20:25.643

我猜你复制并粘贴了这段代码？

```
HttpEntity entity2 = response2.getEntity();
// do something useful with the response body
// and ensure it is fully consumed
EntityUtils.consume(entity2); 
```

Javadocs 是你的朋友：[HttpEntity Javadocs](http://hc.apache.org/httpcomponents-core-ga/httpcore/apidocs/org/apache/http/HttpEntity.html)

这`IOUtils`使这变得更加容易：

```
String body = IOUtils.toString(entity2.getContent(), "UTF-8"); 
```

# javascript - For 循环根本不循环（JavaScript）

> ID：14093699
> 
> 赞同：0
> 
> 时间：2012-12-30T19:07:08.797
> 
> 标签：javascript, dom, for-loop

我是 JavaScript 的初学者，但我无法弄清楚以下问题：我正在尝试创建一个简单的 JavaScript 游戏，它应该允许用户输入玩家的姓名。

我试图用'for'循环来解决这个问题，它会重复5次（根据用户之前的选择）。但是，当我尝试循环以下应该允许用户输入玩家姓名的代码时，它总是从 nr 开始。4 并且不再循环，而是结束。为什么呢？我怎样才能改进我的代码以使其正常工作？

```
for (var i=0; i<5;i++){
    document.getElementById('content').innerHTML = '<form name=players_name><p>Name of the player '+
                                                   i+
                                                   '</p><input type="text" name="player_name"></br><input type="button" value="Submit" onclick="somefunction()"></form>';
} 
```

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T19:08:13.013

使用`+=`运算符在每次迭代中附加 HTML：

```
document.getElementById('content').innerHTML += "..."; 
```

但是这样做会降低性能。相反，使用数组来收集字符串并将它们放入循环末尾的元素中：

```
for (var i = 0, html = []; i < 5; i++) {
    html.push( '..' );
}

document.getElementById('content') = html.join(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T19:10:13.457

尝试使用`alert()`or`console.log()`看看它是否真的是你的循环，或者，如果它是你在循环体内的代码。

```
for (var i=0; i<5;i++){
alert(i);
document.getElementById('content').innerHTML = '<form name=players_name><p>Name of the player '+i+'</p><input type="text" name="player_name"></br><input type="button" value="Submit" onclick="somefunction()"></form>';
} 
```

这将显示一个消息框，其中`i`包含每次迭代的变量值。

你也可以使用

```
console.log(i); 
```

使用浏览器的调试控制台（请注意，这与 IE < 8 存在一些兼容性问题）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T19:13:20.787

[![在此处输入图像描述](../Images/a34b9f109ce66ab17c2d864e7051a0cd.png)]

```
var content = "";                                          //create "content"
for (var i=0; i<5;i++){
    content += '...'+i+'...'+"<br>";                       //Add your HTML inside
}                                                          //¯¯¯
document.getElementById('content').innerHTML = content;    //Put it into DOM 
```

这样innerHTML 就不会每次都被覆盖。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T19:21:37.253

你的代码有错误。您覆盖了 id 为“content”的 HTML 元素内容的 4 倍。于是就有了答案，为什么你只看到了第四种形式。

这是固定代码：

```
// Make a variable what will contain the forms
var content_output = "";

for (var i=0; i<5;i++){
     content_output += '<form name=players_name><p>Name of the player ' + i + '</p><input type="text" name="player_name"></br><input type="button" value="Submit" onclick="somefunction()"></form>';
}

// Add the content_output variable's content to the HTML element width 'content' id
document.getElementById('content').innerHTML = content_output; 
```

# objective-c - iOS - 将文本附加到应用程序包中的文件

> ID：14093701
> 
> 赞同：0
> 
> 时间：2012-12-30T19:07:13.983
> 
> 标签：objective-c, ios, file, nsstring, append

我正在尝试使用以下代码将一些文本附加到驻留在应用程序包中的文件中：

```
NSString *dotsStr = [NSString stringWithFormat:@"%i", dots];

NSString *path = [[NSBundle mainBundle] pathForResource:[NSString stringWithFormat:@"%i_500", dots] ofType:@"txt"];
NSString *contents = [NSString stringWithContentsOfFile:path encoding:NSASCIIStringEncoding error:nil];

NSString *newpath = [[NSBundle mainBundle] pathForResource:[NSString stringWithFormat:@"%i_50", dots] ofType:@"txt"];
[contents appendToFile:newpath encoding:NSASCIIStringEncoding]; 
```

附加到文件时，我在 NSString 上使用了一个类别：

```
- (BOOL) appendToFile:(NSString *)path encoding:(NSStringEncoding)enc;
{
    BOOL result = YES;
    NSFileHandle *fh = [NSFileHandle fileHandleForWritingAtPath:path];
    if (!fh)
    {
        [[NSFileManager defaultManager] createFileAtPath:path contents:nil attributes:nil];
        fh = [NSFileHandle fileHandleForWritingAtPath:path];
    }
    if (!fh) return NO;
    @try {
        [fh seekToEndOfFile];
        [fh writeData:[self dataUsingEncoding:enc]];
    }
    @catch (NSException * e)
    {
        result = NO;
    }
    [fh closeFile];
    return result;
} 
```

这在模拟器上运行良好，但是，当我重新启动应用程序时，旧文件被加载，没有附加文本。我不知道这怎么可能。

有谁知道我如何更改此类别以使更改持续存在？

提前致谢！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T19:14:14.420

您无法写入应用程序包。

（顺便说一句，出于非常明显的安全原因。）

如果您打算更改文件，请将其复制到可写位置，例如在 Documents 目录中。

（哦，在你问之前：模拟器使用 OS X 的文件系统，没有这个限制，所以这就是它在模拟器上工作的原因。模拟器无法模拟的另一件事。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T19:14:06.770

应用程序包是只读的。在修改文件之前，您需要将文件复制到应用程序的 Documents 目录。

# php - php：遍历数字列表

> ID：14093702
> 
> 赞同：0
> 
> 时间：2012-12-30T19:07:15.933
> 
> 标签：php, wordpress, foreach

我有一个像这样的数组：

```
Array (
[0] => stdClass Object ( [ID] => 1 [user_id] => 1 [post_id] => 929,924,875,839,850,720,642,1109,917,935,911,1174,1173,1172,903,892,1189,865,1386 ) 
[1] => stdClass Object ( [ID] => 2 [user_id] => 75 [post_id] => 903,704,477,9,455 ) 
[2] => stdClass Object ( [ID] => 3 [user_id] => 78 [post_id] => 917,911 ) 
[3] => stdClass Object ( [ID] => 4 [user_id] => 80 [post_id] => 903,1109,642 )
) 
```

我写了一个 foreach 循环来遍历每个元素：

```
$apples = $wpdb->get_results("SELECT ID, user_id, post_id FROM table_name" );

foreach ( $apples as $apple ) 
    {
        $user_info = get_userdata($apple->user_id);
        $post_title = get_the_title($apple->post_id);

        echo '<ul><li>' . $user_info->user_login . '</li>';
        echo '<li>' . $post_title . '</li>';
        echo '</ul>';
    } 
```

如何循环遍历在 中找到的每个 ID `[post_id]`？现在它只显示第一个数字的标题`[post_id]`。不过，我需要它遍历它们中的每一个。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:17:21.320

就像是：

```
<?php
...
foreach( explode( ',', $apple->post_id ) as $post_id ) {
// Do your stuff
} 
```

会做

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T19:19:27.080

你可以试试

```
foreach ( $apples as $apple ) {
    $user_info = get_userdata($apple->user_id);
    echo '<h4>' . $user_info->user_login . '<h4>';
    echo "<ul>";
    foreach ( explode(",", $apple->post_id) as $postID ) {
        printf('<li>%s</li>', get_the_title($postID));
    }
    echo '</ul>';
} 
```

# ldap - 了解 LDAP OR 过滤器

> ID：14093703
> 
> 赞同：3
> 
> 时间：2012-12-29T21:22:36.067
> 
> 标签：ldap

我正在尝试了解 OR LDAP 查询（特别是盲 LDAP 注入）。

我是否正确地说，为了推断值 objectClass 可以假设（此处`U`）以下过滤器发送到 LDAP 服务器，是否正确？

```
(|(objectClass=void)(objectClass=U))(&(objectClass=void)(type=P*)) 
```

假设 Web 应用程序返回一个对象，我可以肯定地说 LDAP 目录包含一个名为 U 的类别吗？...我的推理是否正确？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:49:20.800

> 我的推理正确吗？

不，“或”就是“或”。正如您所写的那样，（i）对象类将是无效的（无论这意味着什么），或者（ii）对象类将是 U。

过滤器的其余部分无效。有一个内部`OR`过滤器和一个内部`AND`过滤器，但没有外部运算符来说明它们是如何连接的。例如，过滤器解析器可能有理由在第一个停止`))`，因为没有有效的解析继续。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-08-25T10:17:23.453

如果您的目标是了解 LDAP 查询中的 OR 运算符（本身），我发现文章“ [LDAP 查询中](https://social.technet.microsoft.com/Forums/windowsserver/en-US/45814a44-9f95-486c-b69d-2f204a7406b0/or-operator-in-ldap-queries?forum=winserverDS)的 OR 运算符”非常有帮助：

> 总而言之，“&”是“与”运算符，“！” 是“非”运算符，“|” 是“或”运算符，“*”是通配符。条件可以嵌套在括号中。通配符不能用于 DN 属性。

**示例**：`(|(givenName=foo*)(middlename=foo*)(mail=foo*))`实现一个三重`OR`回馈所有出现的地方，其中`foo`出现在给定名称、中间名或邮件地址中。有关更多详细信息，请参阅帖子“ [LDAP 多重或语法](https://stackoverflow.com/questions/6430597/)”。

# linux - 在 curl 获取的 2 个文件之间添加新行

> ID：14093705
> 
> 赞同：2
> 
> 时间：2012-12-30T19:07:33.320
> 
> 标签：linux, shell, curl, sed, posix

我有这个命令可以获取 2 个文件，执行一些格式化并输出结果。

```
curl https://www.cloudflare.com/ips-v{4,6} |
    sed 's/^/set_real_ip_from /;s/$/\;/' \ > /home/user/output.txt 
```

它工作得很好，问题是如何在文件 1 和文件 2 之间添加换行符（保留对格式的更改）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:09:08.087

像这样 ：

```
{
    curl -s https://www.cloudflare.com/ips-v4
    printf '\n\n'
    curl -s https://www.cloudflare.com/ips-v6
} | sed -r 's/^(.+)$/set_real_ip_from \1;/g' > /home/user/output.txt 
```

# opengl - 2D 精灵批处理

> ID：14093706
> 
> 赞同：0
> 
> 时间：2012-12-30T19:07:36.387
> 
> 标签：opengl, opengl-es, opengl-es-2.0, sprite

我目前正在调用`glDrawElements`2D 场景中的每个精灵。我想改变这一点。

场景由屏幕外渲染缓冲区（FBO）组成，目前只有一个精灵表纹理用于组成整个场景。

如果我将所有内容排队`glDrawElements`到一个大缓冲区中，我认为这会起作用，但是......将来（当我有多个精灵表纹理时）我每次调用时都必须提交当前缓冲区`glBindTexture`是必须的？

我问的原因（对于这个通常很明显的问题）是 FBO 有一个深度缓冲区，这让我想知道我绘制精灵的顺序是否无关紧要（这意味着我可以为一个纹理绘制所有精灵，然后绘制其他纹理的所有精灵，并忽略我绘制它们的顺序（使用 Z 轴对它们进行排序）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:18:36.860

如果不涉及混合，则顺序实际上并不重要。但是有一个更好的方法：使用文本图集。

这意味着使用一个绘图调用来绘制所有精灵并包含纹理坐标以选择要使用的精灵。（单个）纹理仅包含并排的所有精灵。

# postgresql - 数据库不活动时的 Heroku 数据库备份存储

> ID：14093707
> 
> 赞同：0
> 
> 时间：2012-12-30T19:07:38.717
> 
> 标签：postgresql, heroku

我正在考虑使用 Heroku 作为我正在从事的项目的平台。这个项目将有许多独立的数据库（postgres）。每个数据库都会在有人使用它时启动，然后将数据保存到转储文件中，并在没有人登录时停止运行（如果所有这些数据库始终处于活动状态，这将非常昂贵）。

不幸的是，我没有使用 Heroku 的经验，而且他们的文档有一种令人讨厌的营销倾向——我不知道这是否可能。如何支付备份存储费用？是否可以在没有关联的运行数据库的情况下存储备份？

我的替代方案是在亚马逊上构建它，但我不想自己做所有这些工程。

提前谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T12:07:44.373

[Postgres Schemas](http://www.postgresql.org/docs/9.1/static/ddl-schemas.html)方法可能非常适合您的多租户示例。

这篇[博客文章](http://blog.jerodsanto.net/2011/07/building-multi-tenant-rails-apps-with-postgresql-schemas/)和[RailsCast](http://railscasts.com/episodes/389-multitenancy-with-postgresql)可能会进一步帮助您。

启动多个数据库听起来像是在与默认值作斗争，这是出于哪些方面的考虑？

# objective-c - UITextview：如何缩进文本？

> ID：14093713
> 
> 赞同：1
> 
> 时间：2012-12-30T19:08:01.917
> 
> 标签：objective-c

好的，我正在尝试创建一个规则的笔记本视图。

创建它的代码如下

```
@interface QuickNoteNoteTextView ()
    @property (nonatomic) CGPoint startPoint;
    @property (nonatomic) CGPoint endPoint;
    @property (nonatomic, retain) UIColor *lineColor;
@end

@implementation QuickNoteNoteTextView

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
    }
    return self;
}

// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.
 - (void)drawRect:(CGRect)rect {
     // Drawing code
     // Get the graphics context
     CGContextRef ctx = UIGraphicsGetCurrentContext();

     [super drawRect:rect];

     // Get the height of a single text line
     NSString *alpha = @"ABCD";
     CGSize textSize = [alpha sizeWithFont:self.font constrainedToSize:self.contentSize lineBreakMode:NSLineBreakByWordWrapping ];
     NSUInteger height = textSize.height;

     // Get the height of the view or contents of the view whichever is bigger
     textSize = [self.text sizeWithFont:self.font constrainedToSize:self.contentSize lineBreakMode:NSLineBreakByWordWrapping ];
     NSUInteger contentHeight = (rect.size.height > textSize.height) ? (NSUInteger)rect.size.height : textSize.height;

     NSUInteger offset = 6 + height; // MAGIC Number 6 to offset from 0 to get first line OK ???
     contentHeight += offset;
     // Draw ruled lines
     CGContextSetRGBStrokeColor(ctx, 0, 0, 0, 1);
     for(int i=offset;i < contentHeight;i+=height) {
         CGPoint lpoints[2] = { CGPointMake(0, i), CGPointMake(rect.size.width, i) };
         CGContextStrokeLineSegments(ctx, lpoints, 2);
     }

     //vertical line
     self.startPoint = CGPointMake(22.0, self.frame.size.height * -1);
     self.endPoint = CGPointMake(22.0, self.frame.size.height * 2);
     self.lineColor = [UIColor redColor];

     CGContextSetShouldAntialias(ctx, NO);

     CGContextSetStrokeColorWithColor(ctx, [self.lineColor CGColor]);

     CGContextSetLineWidth(ctx, 1);

     CGContextBeginPath(ctx);
     CGContextMoveToPoint(ctx, self.startPoint.x, self.startPoint.y);
     CGContextAddLineToPoint(ctx, self.endPoint.x, self.endPoint.y);
     CGContextMoveToPoint(ctx, self.startPoint.x + 2.0f, self.startPoint.y);
     CGContextAddLineToPoint(ctx, self.endPoint.x + 2.0f, self.endPoint.y);

     CGContextDrawPath(ctx, kCGPathStroke);

 } 
```

此代码正确地在 UITextview 中绘制水平格线并在左侧绘制垂直边距线。

我要做的最后一件事是将文本视图中的文本向右移动，使其位于垂直线的右侧。

有任何想法吗？

![在此处输入图像描述](../Images/16877f06a078195237c7fb93e6970049.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T19:50:12.573

好的，我通过使用 contentInset 将文本向右推 20 像素解决了这个问题，然后修改了我的 drawRect 以将水平线延长 -20 以说明 contentInset

# apache - 是否可以在没有任何响应的情况下关闭 http 连接？

> ID：14093718
> 
> 赞同：3
> 
> 时间：2012-12-30T19:08:40.167
> 
> 标签：apache, security, connection

如何在没有任何响应的情况下关闭与 apache 的 http 连接？如果我检测到请求是黑客攻击，我想关闭连接而不对请求做出任何响应。

现在我有类似的东西：

```
GET / HTTP/1.0
User-Agent: Hacking-Tool

HTTP/1.1 403 Forbidden
Date: Sun, 30 Dec 2012 19:00:56 GMT
Server: Apache/2.2.0 (Linux/SUSE) mod_ssl/2.2.0 PHP/5.1.2 SVN/1.4.6
Content-Length: 13
Connection: close
Content-Type: plain/text; charset=utf-8

Stop hacking! 
```

我怎样才能简单地关闭连接，让黑客猜不到我正在运行一个 linux 系统。我知道我可以减少服务器签名这没关系。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T07:38:39.813

你问了两个问题，尽量避免:)。

首先是您要防止操作系统/应用程序指纹。您可以通过删除服务器标头并更改 apache 错误页面来做到这一点......并且仍然有一定的可能性攻击者能够猜测您的操作系统和 http 服务器。您可以使用[Apache Mod Security](http://www.modsecurity.org/)来帮助自己。

其次是在应用程序级别，逻辑执行（您的应用程序确定请求是否是黑客尝试）之后关闭连接而没有适当的 http 响应标头。在php中我认为你不能这样做。当解析器被执行时，我认为响应已经由 apache 准备好了，如果解析器没有返回任何空响应或错误响应将由 apache 本身发送。而且我认为，如果您使用一些标头过滤，并且只返回纯字符串“检测到黑客攻击。通知了管理员。法律后果可能会随之而来。” 你会很好地吓到一些脚本小子。

PS我很好奇您的应用程序能够检测到哪些黑客攻击？这是 CSRF 令牌验证吗？这是简单的未经身份验证的访问尝试，还是其他形式的授权检查？还是您开发的某种安全机制？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-09-06T04:06:00.057

可以在不向客户端发送任何响应的情况下关闭 http 连接。但是比较牵扯。它不应该这么困难。

IP 表规则：

```
iptables -t raw -I PREROUTING 1 -m recent --rsource --mask 255.255.255.0 --update --seconds 259200 --name DYN_DROP_IPv4 -j DROP
iptables -t raw -I OUTPUT 1 -m recent --rsource --mask 255.255.255.0 --update --seconds 259200 --name DYN_DROP_IPv4 -j DROP

ip6tables -t raw -I PREROUTING 1 -m recent --rsource --mask ffff:ffff:ffff:ffff:0:0:0:0 --update --seconds 259200 --name DYN_DROP_IPv6 -j DROP
ip6tables -t raw -I OUTPUT 1 -m recent --rsource --mask ffff:ffff:ffff:ffff:0:0:0:0 --update --seconds 259200 --name DYN_DROP_IPv6 -j DROP 
```

httpd 配置重写规则运行脚本：

```
# The network mask must be the same as the iptables rule mask
Define DynDropIP_QueryString '\
?action=+\
&addr=%{REMOTE_ADDR}\
&port=%{REMOTE_PORT}\
&mask_ipv4=255.255.255.0\
&mask_ipv6=ffff:ffff:ffff:ffff:0:0:0:0\
&remote_host=%{REMOTE_HOST}\
&server_name=%{SERVER_NAME}\
&server_port=%{SERVER_PORT}\
&request_method=%{REQUEST_METHOD}\
&request_uri=%{REQUEST_URI}\
&http_user_agent=%{HTTP_USER_AGENT}\
'

Define BAD_REQUESTS_REGEX '\
^/./|\
^/\.|\
^/[0-9]+|\
^/admin|\
'

Define BAD_BOTS_REGEX '\
^.$|\
11A465|\
Ahrefs|\
ArchiveBot|\
AspiegelBot|\
Baiduspider|\
'

RewriteCond %{REQUEST_URI} ${BAD_REQUESTS_REGEX} [NC,OR]
RewriteCond %{HTTP_USER_AGENT} ${BAD_BOTS_REGEX} [NC]

# Dynamic Drop IP Script
RewriteRule ^.* /cgi-bin/DynDropIP${DynDropIP_QueryString} [PT,E=dontlog,L,END]

UnDefine DynDropIP_QueryString
UnDefine BAD_REQUESTS_REGEX
UnDefine BAD_BOTS_REGEX 
```

`cgi-bin/DynDropIP`

```
#!/bin/sh

main() {
    # Pass query string trough to the named pipe (FIFO file) daemon; Redirect stderr to bit bucket
    fifo_dir='/var/run/DynDropIP/'
    fifo_file='xt_recent_fifo'

    if [[ -p "${fifo_dir}${fifo_file}" ]]; then
        printf "%s\n" "${QUERY_STRING}" 1>"${fifo_dir}${fifo_file}" 2>/dev/null
    fi

    response
}

response() {
    # Allow a few seconds for the firewall to be updated before responding (desire firewall to block the response)
    sleep 3

    # Set the HTTP response headers (404 and content type)
    # end of HTTP headers (empty line i.e. 2nd consecutive line feed)
    # Send 404 error page (duplicate of Apache 2.4.6 default 404 page (en))
    printf "%s\n%s\n\n%s\n" \
    "Status: 404 Not Found" \
    "Content-type: text/html; charset=iso-8859-1" \
"\
<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">
<html><head>
<title>404 Not Found</title>
</head><body>
<h1>Not Found</h1>
<p>The requested URL ${REQUEST_URI} was not found on this server.</p>
</body></html>\
"
}

main 
```

`/usr/local/libexec/DynDropIP/xt_recent_fifo.sh`
（运行此脚本以启动 fifo 和守护进程）

```
#!/bin/bash

fifo_dir='/var/run/DynDropIP/'
fifo_file='xt_recent_fifo'
daemon='/usr/local/libexec/DynDropIP/xt_recent_fifo_daemon.sh'

# Prep and clean first

# If fifo dir is not a dir remove and make dir
if [[ ! -d "${fifo_dir}" ]]; then
    rm -f "${fifo_dir}"
    mkdir -p "${fifo_dir}"
fi

# If fifo file exists remove
[ -a "${fifo_dir}${fifo_file}" ] || \
[ -e "${fifo_dir}${fifo_file}" ] || \
[ -f "${fifo_dir}${fifo_file}" ] || \
[ -h "${fifo_dir}${fifo_file}" ] || \
[ -p "${fifo_dir}${fifo_file}" ] && \
rm -f "${fifo_dir}${fifo_file}"

mkfifo -m 666 "${fifo_dir}${fifo_file}"

# For SELinux - Allow apache user to write to the fifo
chcon -t httpd_sys_rw_content_t "${fifo_dir}${fifo_file}"

tail -f "${fifo_dir}${fifo_file}" | "${daemon}" & 
```

`/usr/local/libexec/DynDropIP/xt_recent_fifo_daemon.sh`

```
#!/bin/bash

main() {
    # Initialize IP address regex pattern vars
    IP_RegEx

    # Expected query string parameters: action (+/-), addr, port, mask_ipv4, mask_ipv6
    while read QUERY_STRING
    do
        # Parse the query string into associative array
        while IFS='=' read -r -d '&' key value && [[ -n "$key" ]]; do
            declare $key="$value"
        done <<<"${QUERY_STRING}&"

        if validate; then
            if process_address; then
                update_iptables
                logit
#               response
                destroy_tcp_socket
            fi
        fi
    done < "${1:-/dev/stdin}"
}

# Validate action, address and mask parameters
validate() {
    # Verify action parameter
    if [[ "${action}" != "+" && "${action}" != "-" ]]; then
        return 1    # failed: invalid action
    fi

    # Verify address and mask, set ip version if okay
    if [[ "${addr}" =~ ^${IPV4ADDR}$ && "${mask_ipv4}" =~ ^${IPV4ADDR}$ ]]; then
        ipv=4
    elif [[ "${addr}" =~ ^${IPV6ADDR}$ && "${mask_ipv6}" =~ ^${IPV6ADDR}$ ]]; then
        ipv=6
    else
        return 2    # failed: invalid address or network mask
    fi
}

# Process IPvN address
process_address() {
    if [[ $ipv -eq 4 ]]; then
        ipv4_network_mask
        if ! [[ "${maddr}" =~ ^${IPV4ADDR}$ ]]; then
            return 4    # failed: invalid masked ipv4 address
        fi
    elif [[ $ipv -eq 6 ]]; then
        ipv6_expand_address
        ipv6_native_notation
        ipv6_network_mask
        if ! [[ "${maddr}" =~ ^${IPV6ADDR}$ ]]; then
            return 6    # failed: invalid masked ipv6 address
        fi
    fi
}

# Compress IPv6 address (retain IPv4 dotted decimal or IPv6 native notation)
compress_address() {
    if [[ $addr =~ ^((${IPV6SEG}:){6})((${IPV6SEG}:${IPV6SEG})|(${IPV4ADDR}))$ ]]; then
        local IPv6_Segments IPv4_Segments pattern

        IPv6_Segments=${BASH_REMATCH[1]}${BASH_REMATCH[4]}
        IPv4_Segments=${BASH_REMATCH[5]}

        # Suppress hextet leading zeros; Three passes to get each of three
        IPv6_Segments=${IPv6_Segments//:0/:} && IPv6_Segments=${IPv6_Segments//:0/:} && IPv6_Segments=${IPv6_Segments//:0/:}

        # Reconstitute empty hextets with single zero; Two passes to get every other one
        IPv6_Segments=${IPv6_Segments//::/:0:} && IPv6_Segments=${IPv6_Segments//::/:0:}

        # First hextet special cases (0:)
        [[ $IPv6_Segments =~ ^0*([[:xdigit:]]+)(.*) ]] && IPv6_Segments="${BASH_REMATCH[1]}${BASH_REMATCH[2]}"

        # Last hextet special cases (:0, only if not followed by IPv4 segment)
        [[ $IPv6_Segments =~ [^:]:$ && -z $IPv4_Segments ]] && IPv6_Segments=$IPv6_Segments'0'

        # Compress longest contiguous hextets of zero to "::" (leftmost tiebreaker).
        for (( i=7; $i>=1; i-- ))
        do
            pattern=''
            for (( j=0; $j<$i; j++ ))
            do
                pattern+=':0'
            done

            # Compress at beginning
            [[ $IPv6_Segments =~ ^0$pattern ]] && IPv6_Segments=${IPv6_Segments/0$pattern/::} && break

            # Compress in the middle or at end
            [[ $IPv6_Segments =~ $pattern:0 ]] && IPv6_Segments=${IPv6_Segments/$pattern:0/::} && break

        done

        # Put address together and remove extra triple colons
        addr=$IPv6_Segments$IPv4_Segments
        addr=${addr/:::/::}
    fi
}

# Expand IPv6 Address (retain dotted decimal or native notation)
ipv6_expand_address() {
    local hextests num_colons additional_hextets

    # Number of hextets in an expanded IPv6 address (native notation)
    hextets=8

    # How many colons in address
    num_colons=${addr//[^:]/}
    num_colons=${#num_colons}

    # Is address IPv4 dotted decimal notation
    [[ $addr =~ :${IPV4ADDR}$ ]] && hextets=$((hextets-1))      # ::ffff:0:0/96, ::ffff:0:0:0/96, 64:ff9b::/96

    # Fix up beginning and end
    [[ $addr =~ ^:: ]] && addr='0'$addr
    [[ $addr =~ ::$ ]] && addr=$addr'0'

    # Create additional hextets
    additional_hextets=':'
    for (( i=$num_colons; $i<$hextets; i++ ))
    do
        additional_hextets+='0:'
    done

    # Insert additional hextets (replace ::)
    addr=${addr/::/$additional_hextets}
}

# Convert from IPv4 dotted decimal to IPv6 native notation (retain compressed / expanded)
ipv6_native_notation() {
    local expanded_flag
    # Ensure working with an expanded address
    [[ $addr =~ :: ]] && ipv6_expand_address && expanded_flag=1

    # Is address IPv4 dotted decimal notation
    if [[ $addr =~ ^(.*:)(${IPV4ADDR})$ ]]; then
        local IPv6_Segments IPv4_Segments
        local s1 s2 s3 s4 s1s2 s3s4

        IFS=. read -r s1 s2 s3 s4 <<< ${BASH_REMATCH[2]}    # IPv4 Segments 1, 2, 3, & 4

        s1s2=$(( ($s1 * 0x100) + $s2 ))                     # Hextet 7
        s3s4=$(( ($s3 * 0x100) + $s4 ))                     # Hextet 8

        IPv6_Segments=${BASH_REMATCH[1]}                    # Hextets 1, 2, 3, 4, 5, 6
        IPv4_Segments=$( printf "%x:%x" "$s1s2" "$s3s4" )   # As Hextets 7 & 8

        # Return converted native notation address (expanded)
        if [[ -n $IPv6_Segments && -n $IPv4_Segments ]]; then
            addr=$IPv6_Segments$IPv4_Segments
        fi
    fi

    # Revert expansion
    [[ $expanded_flag -eq 1 ]] && compress_address
}

# Convert from IPv6 native to IPv4 dotted decimal notation (retain compressed / expanded)
ipv6_dotted_decimal_notation() {
    local expanded_flag
    # Ensure working with an expanded address
    [[ $addr =~ :: ]] && ipv6_expand_address && expanded_flag=1

    # Is address IPv6 native notation
    if [[ $addr =~ ^(.*:)(${IPV6SEG}:${IPV6SEG})$ ]]; then
        local IPv6_Segments IPv4_Segments
        local s1 s2 UB LB

        IFS=: read -r s1 s2 <<< ${BASH_REMATCH[2]}          # IPv6 Segments 7 & 8

        UB=$((0xFF00))                                      # Upper Byte mask
        LB=$((0x00FF))                                      # Lower Byte mask

        IPv6_Segments=${BASH_REMATCH[1]}                    # Hextets 1, 2, 3, 4, 5, 6
        IPv4_Segments=$(((16#$s1 & $UB) / $LB)).$((16#$s1 & $LB)).$(((16#$s2 & $UB) / $LB)).$((16#$s2 & $LB))

        # Return converted dotted decimal notation address (expanded)
        if [[ -n $IPv6_Segments && -n $IPv4_Segments ]]; then
            addr=$IPv6_Segments$IPv4_Segments
        fi
    fi

    # Revert expansion
    [[ $expanded_flag -eq 1 ]] && compress_address
}

# Apply IPv4 network mask
ipv4_network_mask() {
    local s1 s2 s3 s4
    local m1 m2 m3 m4
    mask=$mask_ipv4     # Mask is also used in logit

    IFS=. read -r s1 s2 s3 s4 <<< $addr
    IFS=. read -r m1 m2 m3 m4 <<< $mask

    maddr="$((s1 & m1)).$((s2 & m2)).$((s3 & m3)).$((s4 & m4))"
}

# Apply IPv6 network mask
ipv6_network_mask() {
    local s1 s2 s3 s4 s5 s6 s7 s8
    local m1 m2 m3 m4 m5 m6 m7 m8
    mask=$mask_ipv6     # Mask is also used in logit

    IFS=: read -r s1 s2 s3 s4 s5 s6 s7 s8 <<< $addr
    IFS=: read -r m1 m2 m3 m4 m5 m6 m7 m8 <<< $mask

    maddr=$( \
    printf "%x:%x:%x:%x:%x:%x:%x:%x" \
    "$((0x$s1 & 0x$m1))" "$((0x$s2 & 0x$m2))" "$((0x$s3 & 0x$m3))" "$((0x$s4 & 0x$m4))" \
    "$((0x$s5 & 0x$m5))" "$((0x$s6 & 0x$m6))" "$((0x$s7 & 0x$m7))" "$((0x$s8 & 0x$m8))" \
    )
}

# Update table
update_iptables() {
    # Add/Remove validated address to/from the xt_recent table (action parameter +/- determines add/remove)
    # Redirect both stdout & stderr to null device so as not to inadvertently provide it to web user
    if [[ -n $action && -n $maddr && -n $ipv ]]; then
        printf "%s%s" $action $maddr 2>/dev/null \
        |/usr/bin/tee /proc/net/xt_recent/DYN_DROP_IPv$ipv \
        1>/dev/null 2>/dev/null
    fi
}

# Log entry
logit() {
    local log_dir='/var/log/iptables/DYN_DROP_IP/'
    local log_file='DYN_DROP_IPv'$ipv'.log'

    mkdir -p "$log_dir"

    # Address field width padding (string length, field width, pad chr/str, pad chr/str width)
    local field_width=0
    [[ $ipv -eq 4 ]] && field_width=15
    [[ $ipv -eq 6 ]] && field_width=39

    local  apad=$( logit_pad ${#addr}  $field_width '   ' 4 )
    local  mpad=$( logit_pad ${#mask}  $field_width '   ' 4 )
    local mapad=$( logit_pad ${#maddr} $field_width '   ' 4 )

    # Write log entry
    printf '%s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s  %s\n' \
    "$( date +'%Y-%m-%d %H:%M:%S %a' )" \
    "$ipv" \
    "$action" \
    "$addr$apad" \
    "$maddr$mapad" \
    "$mask$mpad" \
    "$remote_host" \
    "$server_name" \
    "$server_port" \
    "$request_method" \
    "$request_uri" \
    "$http_user_agent" \
    >> "$log_dir$log_file"

#   # Truncate to last 200 entries (skip header row)
#
#   if [[ $ipv -eq 4 ]]; then
#       local log_header='Date       Time     Day   IPv Action  IP Address  Blocked Network Network Mask    Client  Web Site    Scheme  Method  URI User Agent'
#   elif [[ $ipv -eq 6 ]]; then
#       local log_header='Date       Time     Day   IPv Action      IP Address                          Blocked Network                         Network Mask                            Client  Web Site    Scheme  Method  URI User Agent'
#   fi
#
#   printf '%s\n%s\n' \
#   "$log_header" \
#   "$(tail -n +2 $log_dir$log_file | tail -n -200)" \
#   > "$log_dir$log_file"
}

# Field width padding
logit_pad() {
    local str_length=$1
    local field_width=$2
    local pad_chr=$3
    local pad_chr_width=$4  # e.g. tab width

    local pad_length=$(( ($field_width - $str_length)  / $pad_chr_width ))

    local pad_string=''
    for (( i=0; $i<$pad_length; i++ ))
    do
        pad_string+=$pad_chr
    done

    printf "%s" "$pad_string"
}    

IP_RegEx() {
    # IPv4 Regular Expressions
    IPV4SEG='(25[0-5]|(2[0-4]|1[0-9]|[1-9])?[0-9])'         # doted decimal notation; no leading 0 (octal) or 0x (hexadecimal)
    IPV4ADDR='(('${IPV4SEG}'\.){3,3}('${IPV4SEG}'){1,1})'
    IPV4CIDR='(3[0-2]|[12]?[0-9])'

    # IPv6 Regular Expressions
    IPV6SEG='[0-9a-fA-F]{1,4}'                              # colon hextet notation; leading 0 permitted

    IPV6SEG8='('${IPV6SEG}':){7,7}('${IPV6SEG}'){1,1}'      # 1:2:3:4:5:6:7:8
    IPV6SEG7='('${IPV6SEG}':){1,7}(:''){1,1}'               # 1::                                 1:2:3:4:5:6:7::
    IPV6SEG6='('${IPV6SEG}':){1,6}(:'${IPV6SEG}'){1,1}'     # 1::8               1:2:3:4:5:6::8   1:2:3:4:5:6::8
    IPV6SEG5='('${IPV6SEG}':){1,5}(:'${IPV6SEG}'){1,2}'     # 1::7:8             1:2:3:4:5::7:8   1:2:3:4:5::8
    IPV6SEG4='('${IPV6SEG}':){1,4}(:'${IPV6SEG}'){1,3}'     # 1::6:7:8           1:2:3:4::6:7:8   1:2:3:4::8
    IPV6SEG3='('${IPV6SEG}':){1,3}(:'${IPV6SEG}'){1,4}'     # 1::5:6:7:8         1:2:3::5:6:7:8   1:2:3::8
    IPV6SEG2='('${IPV6SEG}':){1,2}(:'${IPV6SEG}'){1,5}'     # 1::4:5:6:7:8       1:2::4:5:6:7:8   1:2::8
    IPV6SEG1='('${IPV6SEG}':){1,1}(:'${IPV6SEG}'){1,6}'     # 1::3:4:5:6:7:8     1::3:4:5:6:7:8   1::8

    IPV6SEG0=':((:'${IPV6SEG}'){1,7}|:)'                    #  ::2:3:4:5:6:7:8    ::2:3:4:5:6:7:8  ::8       ::

    IPV6LLZI='[fF][eE]80:(:'${IPV6SEG}'){0,4}%[0-9a-zA-Z]{1,}'  # fe80::7:8%eth0     fe80::7:8%1  (link-local IPv6 addresses with zone index)

    IPV6V4MAP='(::|(0{1,4}:){5})[fF]{4}:'${IPV4ADDR}        # ::ffff:d.d.d.d        (::ffff:0:0/96 IPv4-mapped IPv6 addresses)
    IPV6V4TRN='(::|(0{1,4}:){4})[fF]{4}:0{1,4}:'${IPV4ADDR} # ::ffff:0:d.d.d.d      (::ffff:0:0:0/96 IPv4-translated addresses)
    IPV6V4CMP='(::|(0:){6})'${IPV4ADDR}                     # ::d.d.d.d             (IPv4-compatible (0::/96 deprecated by RFC4291))
#   IPV6V4TRN='::([fF]{4}(:0{1,4}){0,1}:){0,1}'${IPV4ADDR}  # ::d.d.d.d  ::ffff:d.d.d.d  ::ffff:0:d.d.d.d   (IPv4-mapped IPv6 addresses and IPv4-translated addresses))

    IPV6V4AMP='64:[fF]{2}9b:(:|(0{1,4}:){4})'${IPV4ADDR}    # 64:ff9b::d.d.d.d      (64:ff9b::/96 IPv4 translation addresses (algorithmic mapping RFC6052))
    IPV6V4LUT='64:[fF]{2}9b:1:(:|(0{1,4}:){3})'${IPV4ADDR}  # 64:ff9b:1::d.d.d.d    (64:ff9b:1::/48 Local-Use IPv4/IPv6 Translation RFC8215)
#   IPV6V4EMB='('${IPV6SEG}':){1,4}:'${IPV4ADDR}            # 2001:db8:3:4::d.d.d.d 64:ff9b::d.d.d.d (IPv4-Embedded IPv6 Address)

    IPV6ADDR='('\
'('${IPV6SEG8}')|('${IPV6SEG7}')|('${IPV6SEG6}')|('${IPV6SEG5}')|('${IPV6SEG4}')|('${IPV6SEG3}')|('${IPV6SEG2}')|('${IPV6SEG1}')|('${IPV6SEG0}')|'\
'('${IPV6LLZI}')|('${IPV6V4MAP}')|('${IPV6V4TRN}')|('${IPV6V4CMP}')|('${IPV6V4AMP}')|('${IPV6V4LUT}')'\
')'

    IPV6CIDR='(12[0-8]|(1[01]|[1-9])?[0-9])'

    PORT='([0-9]{1,4}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])'
}

response() {
    # Allow a few seconds for the firewall to be updated before responding (desire firewall to block the response)
    sleep 3

    # Set the HTTP response headers (404 and content type)
    # end of HTTP headers (empty line i.e. 2nd consecutive line feed)
    # Send 404 error page (duplicate of Apache 2.4.6 default 404 page (en))
    printf "%s\n%s\n\n%s\n" \
    "Status: 404 Not Found" \
    "Content-type: text/html; charset=iso-8859-1" \
"\
<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">
<html><head>
<title>404 Not Found</title>
</head><body>
<h1>Not Found</h1>
<p>The requested URL ${REQUEST_URI} was not found on this server.</p>
</body></html>\
"
}

# On linux kernel >= 4.9 you can use the ss command from iproute2 with key -K
# ss -K dst 192.168.1.214 dport = 49029
# the kernel has to be compiled with CONFIG_INET_DIAG_DESTROY option enabled.
destroy_tcp_socket() {
#   if [[ "${port}" =~ ^${PORT}$ ]]; then           # Strictly Regex method

#   local -i port="10#${port}" 2> /dev/null         # Convert to integer method
#   if [[ $port -ge 1 && $port -le 65535 ]]; then

    # Is integer between 1 and 65535 (inclusive)
    local int_regex='^[0-9]+$'
    if [[ "$port" =~ $int_regex && $port -ge 1 && $port -le 65535 ]]; then
#       ss -K dst $addr dport = $port
        ss -K dst $addr:$port \
        1> /dev/null 2> /dev/null
    fi
}

main 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-30T15:29:25.113

我找到了一种简单的方法来实现我想要的：

```
# Default hosts which will simply drop the connection
<VirtualHost *:80>
    ServerAdmin webmaster@localhost
    DocumentRoot /var/www/public

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined

    SecRuleEngine On
    SecAction "id:1,drop,phase:1"
</VirtualHost> 
```

这需要安装 mod secure2 并将断开与未知主机的所有连接。请注意，在这种情况下，您无法通过 IP 访问您的服务器！如果您需要为您的服务器 IP 添加一个虚拟主机

# angularjs - AngularJS - 使用 jQuery 参数格式化资源 GET 动词查询字符串

> ID：14093722
> 
> 赞同：4
> 
> 时间：2012-12-30T19:09:23.257
> 
> 标签：angularjs, angular-resource

我有一个后端可以理解 jQuery`$.param`返回格式的查询字符串。例如，有一个像

```
{ search: "Miller", name: ["Felipe", "Fernanda"] } 
```

将使用以下查询字符串请求 URL：

```
http://theurl/path?search=Miller&name%5B%5D=Felipe&name%5B%5D=Fernanda 
```

基本上它使用`name[]=Felipe&name[]=Fernada`，但 URL 编码。

同一个对象，当被 AngularJS 解析时以这种格式结束：

```
http://theurl/path?search=Miller&name=Felipe,Fernanda 
```

我的后端不明白。

阅读[this other question](https://stackoverflow.com/questions/12190166/angularjs-any-way-for-http-post-to-send-request-parameters-instead-of-json "这个问题")，我认为使用 transformRequest 会有所帮助，但事实并非如此。这是我的测试代码：

**HTML**

```
<div ng-controller="UserCtrl">
    <pre>{{ data | json}}</pre>
</div> 
```

**JavaScript**

```
var myApp = angular.module('myApp',['ngResource']);

var transformFn = function(data, headersGetter) {
    console.debug('transformRequest', data);
    if (!data) return;
    console.debug('data in', data);
    var dataOut = $.param(data);
    console.debug('data out', dataOut);
    return dataOut;
};

myApp.config(['$httpProvider', function($httpProvider) {
    $httpProvider.defaults.transformRequest.push(transformFn);
}]);

myApp.factory('User', ['$resource', function($resource) {
    return $resource('/echo/:type/', {type:'json'}, {
        query: { method: 'GET' }
    });
}]);

myApp.controller('UserCtrl', ['$scope', 'User', function($scope, User) {
    User.query({ seach: 'Miller', name: ['Felipe', 'Fernanda']}, 
       function(data) {
           console.debug('data', data);
           $scope.data = data;
       });
}]); 
```

但是，当您尝试运行此代码时，您会注意到 data 属性`transformFn`始终未定义，并且查询字符串保持为 AngularJS 格式。

您也可以在 jsFiddle 中看到这一点：http: [//jsfiddle.net/fcoury/QKmnX/](http://jsfiddle.net/fcoury/QKmnX/)

知道如何强制查询字符串使用 jQuery 的 $.param 格式吗？

**编辑**：我正在检查分支 v1.0.x 的 AngularJS 代码，但找不到任何更改查询字符串构造代码的方法，这发生在这里：

[https://github.com/angular/angular.js/blob/v1.0.x/src/ngResource/resource.js#L299-L306](https://github.com/angular/angular.js/blob/v1.0.x/src/ngResource/resource.js#L299-L306)

有没有人有任何聪明的方法来覆盖 ngResource 类的那一部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-05T13:19:44.963

我的简单解决方案：

```
module.run(['$http', '$httpParamSerializerJQLike', function($http, $httpParamSerializerJQLike) {
  $http.defaults.paramSerializer = $httpParamSerializerJQLike;
}]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T19:24:55.293

你为什么使用推送？[这里](https://stackoverflow.com/a/12191613/1916258)的例子只是分配：

```
$httpProvider.defaults.transformRequest = function(data) {...}; 
```

# css - 什么工具用于创建、体验新的布局和设计？

> ID：14093723
> 
> 赞同：1
> 
> 时间：2012-12-30T19:09:28.123
> 
> 标签：css, layout, user-interface, editor, user-experience

我正在使用 Backbone、node、jQuery 等开发 WebApps。

在我开始时，我使用 Twitter Bootstrap 进行设计。然后我开始使用自己的设计，这些设计是通过 Chrome Addon Stylebit 创建的，它允许实时修改 CSS。

不幸的是，这最终会耗费大量时间。

所以我决定与一些编辑器一起开发设计，然后将这个设计手动重写为 CSS。我读过这是一种常见的做法，大多数人使用 Photoshop 来完成这项任务。

Photoshop仍然推荐还是应该使用其他工具？

（我实际上不想要一个完整的所见即所得。只是测试设计和布局的一般东西）

干杯和新年快乐，博多

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T06:06:18.423

对于简短的回答，不。据我所知，没有一个工具可以让您轻松地在代码中构建布局，它不是像 Dreamweaver、Aptana 等完整的 WSIWIG 解决方案。

为了测试设计，您通常会构建线框，例如您从 Balsamiq 看到的那些。还有其他工具，Axure、Pencil 等。搜索线框软件。

作为一名高级 UX 架构师，我听到并看到人们用 Html 和 CSS 模拟他们正在构建的东西。虽然这可以工作。如果您打算投入时间、精力和金钱来编写代码，您不妨继续构建它。

转到我在 Linkedin 上的[“用户体验”](http://www.linkedin.com/groups?gid=72842&trk=hb_side_g)组并在那里提问。你会得到很多答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T20:23:20.967

如果您正在寻找线框和模型工具。那么您可以使用**Balsamiq Mockups**

![在此处输入图像描述](../Images/149e87d7087662879ef557e59c0c1cc2.png)

**它具有以下功能**

1.  低保真草图线框

2.  点击原型

3.  UI 组件和图标

4.  导出为 PNG 或 PDF 等

您可以从[**Balsamiq Mockups Here获得更多详细信息**](http://www.balsamiq.com/)

我希望这能帮到您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T18:03:58.537

您可以试用 ForeUI ( [http://www.ForeUI.com/](http://www.ForeUI.com/) )，它允许您可视化地构建布局并将您的设计导出到 HTML5 模拟。您还可以手动修改生成的代码以满足您的需求。

![Mac OS 中的 ForeUI](../Images/2ee2290ebe41ee8d298296257dd596bf.png)

[http://www.foreui.com/store/](http://www.foreui.com/store/)上提供了一些有趣的示例

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T09:26:55.527

我正在为 Pidoco 工作。

这是一家总部位于柏林的德国公司，我们开发了一个在线原型制作工具。

我们有很好的功能，例如：

交互式原型 协作和邀请 iOS 应用程序来模拟移动原型（Android 即将推出） 您可以从 30 天免费试用开始，然后计划从每月 9 美元开始。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-11T06:41:22.900

以下是模型工具的完整列表： [http ://c2.com/cgi/wiki?GuiPrototypingTools](http://c2.com/cgi/wiki?GuiPrototypingTools)

# silverlight-4.0 - 将图像添加到 Infragistics XamGrid、Silverlight 中的列内容

> ID：14093725
> 
> 赞同：0
> 
> 时间：2012-12-30T19:09:50.973
> 
> 标签：silverlight-4.0, infragistics

我正在使用 Silveright 4。我创建了一个具有 Infragistics XamGrid 的 xaml 页面。网格有一个名为“状态”的列，它有 3 个值：完成、开始和正在进行。我想在后面的代码的状态列中的内容旁边添加一个图像。我做了这样的事情：

XamGrid1.columns[2].key

但这会返回列名而不是内容。我如何访问该列的内容..请建议

* * *

是的.. 我想在列的内容上加上一个 if else 条件。假设值是“开始”，那么它旁边应该有一个红旗。如果它的值为“已完成”，那么它应该有一个绿色标志..我想做这样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:19:02.987

要在网格单元格中有图像，您需要使用模板列或创建自己的自定义列。

如果您使用模板列，您可以将图像添加到模板中，然后您应该能够通过转换器使用绑定到该值的值来获取单元格中的正确图像。[有关如何创建模板列](http://help.infragistics.com/NetAdvantage/Silverlight/Current/CLR4.0/?page=xamGrid_Create_a_Template_Column.html)，请参阅帮助中的创建模板列。

如果您希望创建一个自定义列，那么您将遵循 Devin Rader 在其题为[为 xamGrid 创建自定义列的](http://www.infragistics.com/community/blogs/devin_rader/archive/2010/07/08/creating-custom-columns-for-xamgrid.aspx)博文中所写的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:01:50.683

这是模板列的示例和 xamGrid 文档的链接。在转换器中是它选择图像的地方。如果为真，转换器将返回一个图像，如果为空或假，它将返回空。

[http://help.infragistics.com/NetAdvantage/Silverlight/Current/CLR4.0/?page=xamGrid_Create_a_Template_Column.html](http://help.infragistics.com/NetAdvantage/Silverlight/Current/CLR4.0/?page=xamGrid_Create_a_Template_Column.html)

```
<ig:TemplateColumn Key="ISFAVORITE"
                   Width="auto"
                   HeaderText="Favorite">
      <ig:TemplateColumn.ItemTemplate>
          <DataTemplate>
              <Image HorizontalAlignment="Center" Source="{Binding ISFAVORITE, Converter={StaticResource selectFavImageConverter}}" />
          </DataTemplate>
      </ig:TemplateColumn.ItemTemplate>
</ig:TemplateColumn> 
```

# javascript - 使用 express 时无法获取 POST 数据

> ID：14093736
> 
> 赞同：2
> 
> 时间：2012-12-30T19:11:39.047
> 
> 标签：javascript, node.js

这是我的代码：

```
var express = require('express');
var app = express();

app.get('/:name', function(req,res){
    res.setHeader('Content-Type','text/html');
    res.send('<form action="/" method="POST"><input type="text" name="self"/><input type="submit"/></form>');
});

app.post('/',function(req,res){
    res.send(req.body.self);
});

app.listen(8080); 
```

我打电话给 localhost:8080/examplename

并在输入中写一些东西，然后单击提交按钮。它转到 localhost:8080 但节点返回错误如下：

```
TypeError: Cannot read property 'self' of undefined
    at /home/yusuf/MasaÃ¼stÃ¼/node/ue.js:10:19
    at callbacks (/home/yusuf/MasaÃ¼stÃ¼/node/node_modules/express/lib/router/index.js:160:37)
    at param (/home/yusuf/MasaÃ¼stÃ¼/node/node_modules/express/lib/router/index.js:134:11)
    at pass (/home/yusuf/MasaÃ¼stÃ¼/node/node_modules/express/lib/router/index.js:141:5)
    at Router._dispatch (/home/yusuf/MasaÃ¼stÃ¼/node/node_modules/express/lib/router/index.js:169:4)
    at Object.router [as handle] (/home/yusuf/MasaÃ¼stÃ¼/node/node_modules/express/lib/router/index.js:32:10)
    at next (/home/yusuf/MasaÃ¼stÃ¼/node/node_modules/express/node_modules/connect/lib/proto.js:190:15)
    at Object.expressInit [as handle] (/home/yusuf/MasaÃ¼stÃ¼/node/node_modules/express/lib/middleware.js:31:5)
    at next (/home/yusuf/MasaÃ¼stÃ¼/node/node_modules/express/node_modules/connect/lib/proto.js:190:15)
    at Object.query [as handle] (/home/yusuf/MasaÃ¼stÃ¼/node/node_modules/express/node_modules/connect/lib/middleware/query.js:44:5) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T19:27:31.787

您需要启用正文解析器中间件。在配置路由之前插入它。

```
app.use(express.bodyParser()); 
```

也可以在这里配置其他的东西，比如视图引擎、静态目录等。例如，

```
app.set('views', __dirname + '/views');
app.set('view engine', 'swig');
app.use(express.bodyParser());
app.use(express.methodOverride());
app.use(app.router);
app.use(express.static(__dirname + '/public')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:28:31.653

req.body 允许您获取在 POST 中发送的数据。然后，您可以使用 req.body.[name of data] 来实际访问数据。例如，如果您发送了“名字”：

```
req.body.firstname 
```

您还可以使用 res.render 将数据发送到您的模板页面。例如，这会将名字发送到您的模板语言呈现的索引页面。

```
res.render('index', {fname: req.body.firstname}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T21:53:39.420

你需要bodyParser。这是您的确切代码，添加了解析器，并按预期工作：

```
var express = require('express');
var app = express();

// parses POST bodies:
app.use(express.bodyParser());

app.get('/:name', function(req,res){
    res.setHeader('Content-Type','text/html');
    res.send('<form action="/" method="POST"><input type="text" name="self"/><input type="submit"/></form>');
});

app.post('/',function(req, res){
  res.send(req.body.self);
});

app.listen(8080); 
```

# javascript - AddThis 代码的自定义不起作用

> ID：14093737
> 
> 赞同：1
> 
> 时间：2012-12-30T19:11:50.930
> 
> 标签：javascript, social-networking, addthis

我正在尝试将[AddThis](https://www.addthis.com/)小部件添加到我的页面并根据此页面对其进行自定义：http: [//support.addthis.com/customer/portal/articles/381263-addthis-client-api](http://support.addthis.com/customer/portal/articles/381263-addthis-client-api)

但是，它似乎不起作用。

我正在尝试输出自定义的项目选择，我的代码是：

```
<div class="addthis_toolbox addthis_default_style ">
    <a class="addthis_button_preferred_1"></a>
    <a class="addthis_button_preferred_2"></a>
    <a class="addthis_button_preferred_3"></a>
    <a class="addthis_button_preferred_4"></a>
    <a class="addthis_button_compact"></a>
    <a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript">var addthis_config = {data_track_addressbar:true,services_compact:"facebook,twitter,google_plusone,pinterest,email"};</script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-xxxxxxxxxxxxxxxx"></script> 
```

您可能会发现我只是想显示这些服务：`facebook,twitter,google_plusone,pinterest,email`

但我得到的输出是：`print,twitter,facebook,email`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:16:02.397

当您将鼠标悬停在加号按钮上时，参数“services_compact”用于指定您希望在紧凑菜单中看到的服务。要按您想要的顺序指定按钮，请尝试以下操作：

```
<div class="addthis_toolbox addthis_default_style ">
    <a class="addthis_button_facebook"></a>
    <a class="addthis_button_twitter"></a>
    <a class="addthis_button_google_plusone"></a>
    <a class="addthis_button_email"></a>
    <a class="addthis_button_compact"></a>
    <a class="addthis_counter addthis_bubble_style"></a>
</div> 
```

默认情况下，小部件会尝试检测用户的首选服务，但您可以根据需要覆盖它。这是描述此内容的客户端 API 中的特定部分：

[http://support.addthis.com/customer/portal/articles/381263-addthis-client-api#rendering-preferred-services](http://support.addthis.com/customer/portal/articles/381263-addthis-client-api#rendering-preferred-services)

希望这对你有用。

# dart - WebUI中base64 img src导致报错

> ID：14093738
> 
> 赞同：0
> 
> 时间：2012-12-30T19:11:55.233
> 
> 标签：dart, dart-webui

这是模板有问题的部分：

```
<ul id="list">
  <template iterate='file in convertedfiles.files'>
    <li>{{file.filename}}
    <template if='file.isImage'>
      <img src="{{file.src}}" alt="{{file.filename}}"><br/>
      Source: {{file.src}}
     </template>
    </li>
  </template>
</ul> 
```

convertfiles 是 AndroidFile 的列表：

```
class AndroidFile {
File _file;  

String filename;
String src;
bool isImage;

AndroidFile(this._file) : isImage = false {
    filename = htmlEscape(_file.name);

    // If the file is an image, read and display its thumbnail.
    if (_file.type.startsWith('image')) {
    FileReader reader = new FileReader();
    reader.on.load.add((e) {
        src = reader.result.toString().trim();

        // prints the correct URL (data:image/png;base64,...)
        print(src);
        isImage = true;  
        watcher.dispatch();
      });

    reader.readAsDataUrl(_file);  
    }
  }
} 
```

模板显示出来。它显示文件名，它显示源，但图像标签看起来像

```
 <img alt="screenshot-1179.png" src="#"> 
```

哈希带有下划线（在 Chromium 源视图中），如果我单击它，它会显示“找不到文件：/web/out/”

转换为 JS 在 Chrome 中说：“资源解释为图像，但使用 MIME 类型 text/html 传输”

示例源在[GitHub 上](https://github.com/MikeMitterer/AndroidIconGenerator.DART)
有 任何提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T18:40:59.497

请注意，如果您知道自己正在处理不受 XSS 攻击的安全 URI，则可以使用 SafeUri 包装器（从 导入`web_ui/web_ui.dart`）来解决此问题。例如，将您的模板更改为：

```
<img src="{{file.src}}" alt="{{file.filename}}"> 
```

到：

```
<img src="{{new SafeUri.unsafe(file.src)}}" alt="{{file.filename}}"> 
```

或在内部更改 file.src 以存储 SafeUri。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T12:53:13.083

我发现了问题。

这是因为出于安全原因对 URI 进行了清理。sanitizer 将无效的 URI 转换为 hash `#`。

来自`web_ui/templating.dart`：

```
/**
 * Ensure that [usiString] is a safe URI. Otherwise, return a '#' URL.
 *
 * The logic in this method was based on the GWT implementation located at:
 * http://code.google.com/p/google-web-toolkit/source/browse/trunk/user/src/com/google/gwt/safehtml/shared/UriUtils.java
 */
String sanitizeUri(uri) {
  if (uri is SafeUri) return uri.toString();
  uri = uri.toString();
  return _isSafeUri(uri) ? uri : '#';
}

const _SAFE_SCHEMES = const ["http", "https", "ftp", "mailto"];

bool _isSafeUri(String uri) {
  var scheme = new Uri(uri).scheme;
  if (scheme == '') return true;

  // There are two checks for mailto to correctly handle the Turkish locale.
  //   i -> to upper in Turkish locale -> İ
  //   I -> to lower in Turkish locale -> ı
  // For details, see: http://www.i18nguy.com/unicode/turkish-i18n.html
  return _SAFE_SCHEMES.contains(scheme.toLowerCase()) ||
      "MAILTO" == scheme.toUpperCase();
} 
```

因此，sanitizer 会将您的`data:`方案 URI 转换为`#`. 数据 URI 可用于 XSS，但据我所知，当数据 URI 内容类型为`image/*`.

也许提交错误报告？

# java - Android 活动 startactivity

> ID：14093741
> 
> 赞同：-1
> 
> 时间：2012-12-30T19:11:59.713
> 
> 标签：java, android, class, android-intent, android-activity

> **可能重复：**
> [Android - 如何通过单击按钮打开 Activity](https://stackoverflow.com/questions/14094341/android-how-to-open-activity-by-clicking-button)

我想通过按钮从这个（KlikomaniaActivity）打开另一个活动（GameProcess），但是当我点击按钮时程序崩溃。我不是专业的android程序员，请说出我有什么错误：

```
packagecom.makeandroid.klikomania;
import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;

public class KlikomaniaActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    final Button Butstart = (Button)findViewById(R.id.butstart);
    final Button Butrez = (Button)findViewById(R.id.butrez);

    Butstart.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            Intent intent = new Intent("com.makeandroid.klikomania.GameProcess");
             // эапускаем деятельнсть 
             startService(intent);
        }
    });
}

} 
```

在这里 GameProcess 活动：

```
public class GameProcess extends KlikomaniaActivity {

private static int rezult = 0;
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.gameprocess);

        final Button Butklik = (Button)findViewById(R.id.klik);
        final TextView TextTime = (TextView)findViewById(R.id.texttime);
        final TextView TextKolvo = (TextView)findViewById(R.id.kolvo);

        Butklik.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
            rezult=rezult+1;    
            TextKolvo.setText(rezult);
            }
        });
 }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T19:58:14.347

首先确保您将活动添加到清单文件中：

```
<activity android:name="com.makeandroid.klikomania.GameProcess"></activity> 
```

其次，要启动活动，请使用以下代码：

```
final Intent gameProcessIntent= new Intent(this, GameProcess.class);
Butstart.setOnClickListener(new View.OnClickListener() {
    public void onClick(View v) {
        startActivity(gameProcessIntent);
    }
}); 
```

这应该可以正常工作

# colors - Color.FromNonPremultiplied 使用 BlendState.NonPremultiplied 进行不同的着色

> ID：14093742
> 
> 赞同：0
> 
> 时间：2012-12-30T19:12:05.390
> 
> 标签：colors, xna, alphablending, premultiplied-alpha

在我的 XNA 项目中，我使用未处理的图像并绘制它们，`BlendState.NonPremultiplied`使它们在边缘看起来很正常。但是当我在方法中使用非白色 ( `Color.FromNonPremultiplied(12, 34, 56, 78)`) 时`SpriteBatch.Draw`，它不会像`BlendState`设置为默认值时那样对精灵进行着色。

如何在不切换到默认混合状态的情况下实现与默认混合状态相同的着色？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T14:13:27.897

文档说[Color.FromNonPremultiplied Method](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.color.fromnonpremultiplied.aspx)：将非预乘 alpha 颜色转换为包含预乘 alpha 的颜色。

基于此，您应该使用 `BlendState.NonPremultiplied`或者`Color(12, 34, 56, 78)`

或者

`BlendState.AlphaBlend`和`Color.FromNonPremultiplied(12, 34, 56, 78)`

一起。

# c# - 获取颜色结构的 BLUE 分量值

> ID：14093743
> 
> 赞同：-4
> 
> 时间：2012-12-30T19:12:06.420
> 
> 标签：c#, .net

如何获得颜色的 BLUE 分量值？我希望看到自定义函数实现，而不是`Color.B`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:20:12.103

`Color.B`包含以下内容：

```
public byte B
{
  [TargetedPatchingOptOut("Performance critical to inline across NGen image boundaries")] get
  {
    return (byte) ((ulong) this.Value & (ulong) byte.MaxValue);
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T19:22:51.230

您可以使用[参考源](http://referencesource.microsoft.com/netframework.aspx)来获取 .NET 框架命名空间的源代码。

在 net\fx\src\CommonUI\System\Drawing\Color.cs 中有这个实现 Color.B 属性：

```
 public byte B {
       get {
           return(byte)((Value >> ARGBBlueShift) & 0xFF);
       }
   } 
```

ARGBBlueShift 在哪里：

```
 private const int ARGBBlueShift   = 0; 
```

在另一个以不同顺序存储颜色的操作系统上可能会出现不同*的*值。

# php - 如何从 GitHub 代理 PHP 网站的一部分？

> ID：14093749
> 
> 赞同：2
> 
> 时间：2012-12-30T19:12:57.377
> 
> 标签：php, github, web, proxy

我们有一个网站，其中包含一个页面[http://www.openehr.org/downloads/modellingtools](http://www.openehr.org/downloads/modellingtools)，其第一个表格行中的链接“下载和帮助页面”只是指向更多 PHP 内容 - 工具的文档，在相同的视觉样式为主要网站，包括顶部面板、菜单和底部菜单。

理想情况下，该工具的页面子树将存在于该工具的 GitHub 存储库中（而不是直接作为网站的一部分），并且主网站将代理来自 GitHub 的内容 - 这样我们将实现两个目标：

1.  工具文档由使用该工具的人员维护
2.  但它在视觉上集成到中央网站中。

我已经在主站点服务器上弄乱了各种 Apache 代理和重写规则来做到这一点，但到目前为止还没有运气。我不能是唯一一个想要这样做的人，所以希望有一个已知的策略。

# compiler-construction - Less 不使用 Twitter Bootstrap 编译文件

> ID：14093759
> 
> 赞同：0
> 
> 时间：2012-12-30T19:13:48.540
> 
> 标签：compiler-construction, twitter-bootstrap, compiler-errors, less

我在使用更少的文件和 Twitter Bootstrap 时遇到了奇怪的问题：

我已经进行了深入调查，但我仍然面临问题。

我已经下载了 less 和 Twitter Bootstrap 的最新版本，并以这种方式组织了我的文件：

无引导程序

```
/*!
 * Bootstrap v2.2.2
 *
 * Copyright 2012 Twitter, Inc
 * Licensed under the Apache License v2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Designed and built with all the love in the world @twitter by @mdo and @fat.
 */

// Core variables and mixins
@import "less/variables.less"; // Modify this for custom colors, font-sizes, etc
@import "less/mixins.less";

// CSS Reset
@import "less/reset.less";

// Grid system and page structure
@import "less/scaffolding.less";
@import "less/grid.less";
@import "less/layouts.less";

// Base CSS
@import "less/type.less";

// Utility classes
@import "less/utilities.less"; // Has to be last to override when necessary 
```

在我的文件夹中，我放了所有文件

*variables.less mixins.less reset.less layouts.less type.less utility.less scaffolding.less grid.less*

我读到如果文件是用 BOM 编码的，则可能会导致问题。我从 Sublime 切换到 Dreamweaver 以保存没有 BOM 的索引，但没有成功。

奇怪的是，Less 只是编译了一些文件，但也告诉我很少有未定义的变量，例如 : `@baseFontFamily , @baseFontSize, @gridColumnwidth, @gridGutterwidth`，但是这些变量是在我的 variables.less 中设置的，并且文件 bootstrap.less 和 variables.less 已成功加载。我上传了一个打印屏幕以更好地解释我的情况![在此处输入图像描述](../Images/48593a4ebab970b5250888cadde224e0.png)

什么可能导致问题？

谢谢你的耐心，我希望你明白我的问题

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T19:21:44.580

看起来您正在独立加载文件。而不是`less/*.less`只编译 compile `less/bootstrap.less`。

# wcf - 如何确定用户在 WCF 服务中是否经过身份验证

> ID：14093765
> 
> 赞同：1
> 
> 时间：2012-12-30T19:14:22.377
> 
> 标签：wcf

我是 wcf 的新手，所以有一个问题困扰着我，比如 wcf 和用户身份验证。通常在asp.net中，我发送用户名和密码，并在服务器端对数据库进行验证，如果用户有效，那么我将一些数据存储在会话中，在每个页面中我检查会话，如果会话存在并且存储为真对于该会话中的该用户，然后我让页面执行，否则我将用户重定向到登录页面。所以我想知道如何在 wcf 中实现这种用户身份验证。我希望当第一次用户调用我的服务的任何方法时，他将通过凭证，如果凭证很好，那么他可以调用我的服务的任何方法。请指导我如何在 wcf 中做到这一点。在 wcf 中，我如何为每个将调用我的服务的用户在会话中存储任何数据....有什么办法吗？

我搜索谷歌，发现一个像[http://blog.adnanmasood.com/2010/04/29/step-by-step-guide-for-authenticating-wcf-service-with-username-and-password-over-ssl /](http://blog.adnanmasood.com/2010/04/29/step-by-step-guide-for-authenticating-wcf-service-with-username-and-password-over-ssl/)

但是在这里有人注意到调用者传递了用户名和密码，但代码看起来像用户名和密码一样两次

```
private static void Main(string[] args)
 {
    ServicePointManager.ServerCertificateValidationCallback = new RemoteCertificateValidationCallback(
         delegate { return true; });

     var client = new WcfServiceClient();
     GetCredentials();
     client.ClientCredentials.UserName.UserName = username;
     client.ClientCredentials.UserName.Password = password;
     Console.Write(client.GetData(1));
     client.Close();
     Console.Read();
 } 
```

...但是为什么两个用户名和密码来了**UserName.UserName**它看起来很丑陋。给我一个最好的主意，当他们第一次调用我的服务时如何针对 DB 对用户进行身份验证，并且一旦通过身份验证，然后从下一次他可以调用我的服务的任何方法而无需提供凭据。

有人告诉我为验证用户开发服务。一旦用户验证，那么服务将为每个 wcf 客户端提供一些唯一的令牌 ID，客户端将在调用任何方法时将该令牌作为消息头传递......我不知道如何实施它，甚至我也不知道它是否是最好的。所以寻求指导和建议。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:40:51.153

处理 WCF 身份验证的最常见方法是让客户端程序要求用户名和密码一次（或从配置文件中检索），并让客户端程序为每个服务调用提供它。可以在[http://msdn.microsoft.com/en-us/library/ff405740.aspx](http://msdn.microsoft.com/en-us/library/ff405740.aspx)找到一些示例。

另一种方法是拥有用户会话，这通常是一个坏主意。会话不容易扩展，有客户端和服务器平台兼容性考虑等......

# ajax - 构建依赖于 Django pk 的类似但独特的 ajax 请求的最常用方法？

> ID：14093771
> 
> 赞同：1
> 
> 时间：2012-12-30T19:15:16.403
> 
> 标签：ajax, django, jquery, django-templates

（我正在使用 jquery 和 django）

假设我有一个待办事项列表，每个项目都有一个唯一的主键 (pk)。在模板中，我使用 for 循环列出这些项目，以便每个项目都是可点击的，以在页面的另一部分显示项目详细信息（当然无需重新加载整个页面）。

普遍接受的最佳方法是什么？

我已经尝试了多种“唯一化”每个 div 的方法，以及在 ajax 请求中传递这个 pk 的多种方法。

**第 1 部分 - 获取独特的 div：**

*   我把 pk 作为每个项目 div 的 id 的后缀。例如 {% for item in todolist %} stuff $('body').on('click',"#item_{{item.pk}}", function(){var id = {{item.pk}}, .ajax 东西 }) {% endfor %}
*   我没有添加 pk 后缀，而是添加了一个名为 data-id 的自定义 html 属性。这允许我使用 .attr("data-id") 从单击的 div 中获取 pk 并从 for 循环中删除 js。
*   我没有添加自定义 html 属性，而是添加了一个隐藏的表单字段。

**第 2 部分 - 将 pk 传递给 ajax 请求：**

*   在 $.ajax() 正文中，我将 url: id+"/details" 设置为空数据字段。在 Django 中，我从 url 正则表达式定义中获取 id。
*   在 $.ajax() 正文中，我将 url: "/details" 设置为 data: {id:id}。在 Django 中，我使用 request.POST['id'] 从 views.py 中获取 id。
*   在 js 中，我只是提交表单。Django 将 id 作为表单字段获取。

所以......有这么多（可能是坏的）这样做的方法，你会使用哪一种？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T19:42:03.973

我将使用单个 ajax 函数，它应该是：

```
{% for item in todolist %}
    <div id="{{item.id}}" class="item_ajax" >{{item.name}}</div>
{% endfor %}

<script>
    $('.item_ajax').click(function(){
        $.ajax({
              type: 'POST',
              url: '{% url item_url %}',
              data: {'id': $(this).attr('id'), 'csrfmiddlewaretoken': '{{csrf_token}}'},
              dataType: "text",
              success: function(response) {
                  // do something
              },
              error: function(rs, e) {
                  alert(rs.responseText);
              }
         }); 
    });
</script> 
```

I have used a `class` selector, obviously you can choose what ever you like e.g. having a custom attribute but it should be common.

# php - Wordpress：如何在发布时从自定义字段 ping URL

> ID：14093772
> 
> 赞同：-1
> 
> 时间：2012-12-30T19:15:18.853
> 
> 标签：php, wordpress, ping, custom-fields

我有一个源链接的自定义字段。帖子发布后，插入此自定义字段中的 URL 应该会被 ping 通。我知道有一个专用的引用字段，但我希望自动添加自定义字段中的 URL。

据我了解， $add_ping 就是这样。 [http://codex.wordpress.org/Function_Reference/add_ping](http://codex.wordpress.org/Function_Reference/add_ping)

我的问题是：我不知道在哪里添加它。我想如果我把它写到我显示源链接的主题中，每次访问帖子时都会对源进行 ping 操作。

那么添加 url 以在发布时被 ping 的正确方法是什么？

需要明确的是：这不是我想要 ping 的服务。更像是如果您将发布 B 的链接插入到帖子 A 的内容中。一旦帖子 A 发布，帖子 B（或其博客）就会被 ping 通。我想将链接插入到帖子 A 的自定义字段中，而不是其内容区域。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T20:59:23.237

我认为费利佩是对的。你可以尝试这样的事情：

```
function doCustomPing ($post_id) {
    $uri_to_ping = get_post_meta($post_id, 'FIELDNAME', true);
    add_ping($post_id, $uri_to_ping);
}

add_action ('publish_post', 'doCustomPing'); 
```

因此，每次发布帖子（包括是否已编辑）时，publish_post 的挂钩都会运行 doCustomPing 函数。如果您将此作为主题的一部分，请将上述代码放入您的 functions.php 文件中。如果您的自定义字段显示 FIELDNAME，请将名称放在其中。

# python - 访问 Django 中每个列表组件的模型属性

> ID：14093774
> 
> 赞同：0
> 
> 时间：2012-12-30T19:15:33.923
> 
> 标签：python, django

我正在尝试将我的对象列表传递`views.py`给我的 html 模板，但我无法访问我的 HTML 模板中的对象模型属性。请检查以下代码：

**类.py：**

```
class FOF(models.Model):
    user = models.ForeignKey(User)
    name = models.CharField(max_length=200)
    size = models.IntegerField()
    pub_date = models.DateTimeField('date published')
    view_count = models.IntegerField()
    def __unicode__(self):
        return self.name

class Frame(models.Model):
    url = models.CharField(max_length=200)
    fof = models.ForeignKey('FOF', related_name='frame_set')
    index = models.IntegerField()
    def __unicode__(self):
        return self.url 
```

**视图.py：**

```
def my_fof(request, fof_name_value):
    my_list = FOF.objects.all().order_by('-rank')
    ...
    return render_to_response('uploader/my_fof.html', {'my_list':my_list}, context_instance=RequestContext(request)) 
```

我通常可以在传递单个对象时访问 html 文件中的属性，但是一旦传递对象列表，似乎就无法访问这些属性。

例如，当我键入时，`alert({{ fof_list.0 }});`它会打印对象属性名称，因为它是在**models.py**中定义的：

```
def __unicode__(self):
    return self.name 
```

但是，一旦我尝试访问它的任何属性，如`pub_date`: `alert({{ fof_list.0.pub_date }});`它就会返回`undefined`，因为该属性不可用或无法访问。

关于在传递整个列表时如何继续达到这些属性的任何想法？或者如何正确通过该列表？

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:20:01.870

使用[`for`模板标签](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#for)迭代一个可迭代对象并依次获取每个元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:22:06.640

您首先需要将属性的内容放在 javascript 变量中。

```
<script>
    var pub_date = '{{my_list.0.pub_date}}';
    alert(pub_date);

    //this will also work
    alert('{{my_list.0.pub_date}}') # enclosed in single or double quotes
</script> 
```

使用 a`for loop`并对其进行迭代以获取模板中的每个对象。

```
{% for obj in my_list %}
   <span>{{obj.pub_date}}</span>
   <span>{{obj.size}}</span>
   ---
{% endfor %} 
```

# ios - Kobold2D KKInput 方向不正确？

> ID：14093777
> 
> 赞同：3
> 
> 时间：2012-12-30T19:15:37.870
> 
> 标签：ios, cocos2d-iphone, kobold2d

我在设备方向和输入方面遇到问题。使用 xcode->projects->orientation 设置，我禁用了除纵向之外的所有内容。当我转动设备时，图形保持在原位（如预期的那样），但 KKInput 手势（如平移）似乎提供了不正确的坐标和平移。我的第一个怀疑是我遗漏了与 KKInput 处理 convertToGL 相关的内容。在我看来，Cocos2d 似乎仍在读取设备的方向并将其考虑到计算中。如果有帮助，下面是一个插图。

来自正方形网格的两个“正方形”精灵。

```
**** | ****
*  * | *  *
**** | **** 
```

将我的手指平移到 XX 精灵上，向右拖动。

```
 **** | ****
  ->  *XX* | *  * (squares move horizontal)
      **** | **** 
```

将设备转为横向。

```
**** | ****
*  * | *  *
**** | **** 
```

将我的手指平移到 XX 精灵上，向右拖动。

```
 ^ (squares move vertical)
     ^

    **** |
    *XX* | 
    **** |
    ____ | ****
           *  *
    **** | ****
    *  * |
    **** | 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-27T03:28:51.060

是的，不幸的是 KKInput 使用操作系统的**UIDeviceOrientation**来转换用户输入。即使用户界面被锁定为纵向，设备方向也会返回横向，这会影响计算并导致此错误。

如果您的项目不是太旧，我建议迁移到 Cocos2d 3.0，它带有更简单的触摸处理。

# java - 让 XmlPullParser 忽略空格？

> ID：14093779
> 
> 赞同：0
> 
> 时间：2012-12-30T19:15:54.420
> 
> 标签：java, android, xml, xml-parsing, xmlpullparser

我正在使用 XmlPullParser 解析 Xml。我只想处理 Xml 标签和其中包含的文本，但是 XmlPullParser 读取标签之间的空白文本（空格和回车）。可以设置为忽略这个空格吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T21:35:17.197

我以前没有使用过 XmlPullParser （如果这是完全错误的，请道歉）但是看一下javadocs，看起来当你调用[nextToken()](http://developer.android.com/reference/org/xmlpull/v1/XmlPullParser.html#nextToken%28%29)时，你必须查看返回值并跳过[IGNORABLE_WHITESPACE](http://developer.android.com/reference/org/xmlpull/v1/XmlPullParser.html#IGNORABLE_WHITESPACE)。

以下是不合适的（感谢[Jeff](https://stackoverflow.com/users/8844/jeff-hubbard)）：~~顺便说一句，您是否被迫使用 XmlPullParser？根据您想要实现的目标，我会考虑使用更高级别的 API，**例如**[Simple](http://simple.sourceforge.net/)。我通常使用[JAXB](http://en.wikipedia.org/wiki/Java_Architecture_for_XML_Binding)，但这不是选择哈哈。~~

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-30T18:38:44.527

IDK 如果有忽略空白的设置。如果您将当前节点作为字符串跟踪，则可以编写代码以忽略空格。如果当前节点为空，则忽略文本。我的测试显示它只是转义换行等。我围绕它进行了如下优化。 **危险 这适用于我正在使用的 xml 它可能不适用于你的**

```
String N="";  // Yes I know its Capitalized but its the Current Node and very important to keep track of.

if (eventType == XmlPullParser.START_TAG) {
    N = xpp.getName();//save the name of the node.

...

} else if (eventType == XmlPullParser.END_TAG) {
    N = "";//clear the name of the node.
} else if (eventType == XmlPullParser.TEXT) {
    //if the name of the node is not blank then process it
if (!N.equals("")) {
        //I have a node so process it
    } 
```

祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-08T12:32:00.373

在自己寻找解决方案后添加一个迟到的答案。

解析器有一个`isWhiteSpace()`方法。它只能在与文本相关的事件类型（例如`TEXT`, `CDSECT`, `IGNORABLE_WHITESPACE`）上调用，否则会抛出。

您可以通过调用`next`推进解析器或`getEventType`.

调用`next`会自动跳过`IGNORABLE_WHITESPACE`事件。此事件类型仅在调用`nextToken`更细粒度并命中所有事件类型时才会被命中。即使我们通过调用 next 跳过了“可忽略”的空白，解析器仍然发现几乎所有的空白都是不可忽略的，因此需要您允许跳过它。

```
 boolean isEoD = false;

    do{
        switch (parser.next()){

            default:
                break;
            case XmlPullParser.TEXT:

                if(!parser.isWhitespace())  //Throws if called on wrong eventType
                    System.out.println("Text: " + parser.getText());

                break;
            case XmlPullParser.START_TAG:
            case XmlPullParser.END_TAG:
                System.out.println("TAG: " + parser.getName()+ "\n");
                break;

            case XmlPullParser.END_DOCUMENT:
                isEoD = true;
        }
    }while(!isEoD); 
```

# android - 如何在 Android 中创建 Twitter 分享按钮？

> ID：14093783
> 
> 赞同：5
> 
> 时间：2012-12-30T19:16:18.370
> 
> 标签：android, twitter, parameters

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T01:48:34.447

您不应在“appendQueryParameter”的第一个参数中提供与号 (&)，它将自动为您添加。将其用作：

```
b.appendQueryParameter("id", id); // instead of ("*&*id", id);
b.appendQueryParameter("view=article", null); // instead of ("*&*view=article", null); 
```

输出将是您期望的输出

```
https://twitter.com/intent/tweet?text=Hello title&url=http://www.mywebsite.com/index.php?option%3Dcom_content%26catid=40&id=12546&view%3Darticle=null 
```

请参阅[此处](http://dxr.mozilla.org/mozilla-central/mobile/android/base/tests/testHistoryTab.java.in.html#l263)的使用示例。

# opencv - 打开带有 CDT 错误的 CV？

> ID：14093787
> 
> 赞同：2
> 
> 时间：2012-12-30T19:16:36.017
> 
> 标签：opencv, android-ndk

我在工具设置中配置了一个 Openc CV 包含文件路径，但它仍然在我的代码中给出警告。警告是：

```
 Unresolved inclusion: <highgui.h> 
```

我的代码是：

```
#include <cv.h>
#include <highgui.h>
using namespace cv;
int main()
{
 Mat image;
 image = imread( argv[1], 1 );
 if( argc != 2 || !image.data )
  {
    printf( "No image data \n" );
    return -1;
   }
   namedWindow( "Display Image", CV_WINDOW_AUTOSIZE );
   imshow( "Display Image", image );
   waitKey(0);
 return 0;
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T08:30:11.123

如果您使用以下内容，则需要使用不同的包含`cv::Mat`：

```
#include <opencv2/core/core.hpp>
#include <opencv2/highgui/highgui.hpp> 
```

# linux - Linux TCP 在重负载下奇怪地无响应

> ID：14093793
> 
> 赞同：2
> 
> 时间：2012-12-30T19:17:47.873
> 
> 标签：linux, http, networking, tcp, load-testing

我正在尝试让我正在编写的 HTTP 服务器在重负载下表现良好，但是我遇到了一些我不太理解的奇怪行为。

我的测试包括`ab`在环回接口上以 1000 ( ) 的并发级别使用（Apache 基准程序）`ab -n 50000 -c 1000 http://localhost:8080/apa`，同时跟踪服务器进程。Strace 既能很好地减慢处理速度，让问题很容易重现，也能让我在某种程度上调试服务器内部完成后的工作。`tcpdump`我还在测试运行时捕获网络流量。

发生的事情是`ab`在测试中停止运行一段时间，抱怨连接返回`ECONNRESET`，我觉得这有点奇怪。我可以很容易地接受连接超时，因为服务器可能根本没有带宽来处理它们，但不应该合理地返回`ETIMEDOUT`，或者即使`ECONNREFUSED`不是所有连接都可以被接受？

我使用 Wireshark 提取构成第一个连接的数据包返回`ECONNRESET`，它的简要数据包列表如下所示：（ 此连接![数据包列表](../Images/909602f40112b1e4615e1ff31fff3167.png) 的整个`tcpdump`文件可[在此处](http://www.dolda2000.com/~fredrik/tmp/rstdump)获得。）

从这个转储中可以看到，连接被接受（在几次`SYN`重传之后），然后请求被重传几次，然后服务器重置连接。我想知道，什么可能导致这种情况发生？通常，Linux 的 TCP 实现会在读取过程之前 ACK 数据，甚至选择接收数据，只要它们在 TCP 窗口中有空间，那么这里为什么不这样做呢？是否有某种共享缓冲区快用完了？最重要的是，为什么内核`RST`会突然响应一个数据包，而不是简单地等待并让客户端进一步重新传输？

作为记录，进程的 strace 表明它甚至从不接受来自此连接中的端口（端口 56946）的连接，所以这似乎是 Linux 自己做的事情。还值得注意的是，只要 ab 的并发级别足够低，服务器就可以很好地工作（它可以很好地工作到大约 100，然后在 100-500 之间的某个地方开始间歇性失败），并且它的请求吞吐量是相当恒定的无论并发级别如何（只要不被跟踪，它每秒处理 6000-7000 个请求）。我没有发现问题发生的频率与我的积压设置之间有任何特定的相关性`listen()`（我目前使用的是 128，但我尝试了高达 1024 似乎没有任何区别）。

万一这很重要，我在这个 AMD64 机器上运行 Linux 3.2.0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T05:59:30.797

1.  积压队列已满：因此`SYN`重新传输。

2.  然后一个插槽变得可用：因此`SYN/ACK`.

3.  然后 GET 被发送，然后是四次重传，我无法解释。

4.  然后服务器放弃并重置连接。

我怀疑您的服务器中存在并发或吞吐量问题，这会阻止您足够快地接受连接。您应该有一个线程专门用于调用 accept() 并启动另一个线程来处理接受的套接字，或者将作业排队以将其处理到线程池。然后，我*推测*Linux 会重置积压队列中的连接以及正在接收 I/O 重试的连接，但这只是一个猜测。

# mysql - 从表A中选择所有记录并连接表B以获得A的属性

> ID：14093795
> 
> 赞同：1
> 
> 时间：2012-12-30T19:18:08.283
> 
> 标签：mysql

我不知道我该怎么做......

表“孩子”：

```
idchild | name | idability
--------------------------
   1    | Joe  |    1
   1    | Joe  |    2
   2    | Peter|    1
   2    | Peter|    3
   3    | Kate |    4 
```

表“能力”：

```
idability | ability
-------------------
     1    |   run
     2    |   read
     3    |   write
     4    |   swim 
```

例如，Joe 可以“跑步”和“阅读”，但不能“写作”或“游泳”。我需要这样一份关于乔能力的清单：

```
ability |  
-----------------
  run   |   +
  read  |   +
  write |   - 
  swim  |   - 
```

我以不同的方式尝试了几个 SQL 查询（使用“不存在”），但从未得到正确的结果。我希望有人能告诉我应该怎么做。

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T19:47:06.633

这应该没问题：

```
select ability.ability, if(child.idability,'+','-') from ability left join child on ability.idability =child.idability and child.name="joe"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T19:21:54.160

试试这个：

```
select `child`.`idChild`,`child`.`name`, `child`.`idability`, `ability`.`idAbility`,`ability`.`ability` from `child` inner join `ability` on `child`.`idAbility` = `ability`.`idability` order by `child`.`name`, `ability`.`ability` 
```

您可以删除不需要的列。

# android-intent - 使用 am start 命令从 adb shell 登录应用程序

> ID：14093808
> 
> 赞同：3
> 
> 时间：2012-12-30T19:19:11.447
> 
> 标签：android-intent, android-activity, adb

如果我正在测试应用程序，请在 android/adb shell 中使用 am start 命令。并且该应用程序要求用户在继续主要内容之前登录。如何使用 am start 命令从 android 命令行登录应用程序。

我缺乏理解是如何从 shell/am start 命令访问这些表单字段。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-04T05:16:47.320

亚历克斯的回答很好，我放弃了。更具体。这是我的一些代码在你的 am start 命令之后。

```
adb shell input keyevent 20  # or 61 for TAB, you might need to do more than once
adb shell input text "myusername"
adb shell input keyevent 66      #or 61 for TAB
adb shell input text "mypassword"
adb shell input keyevent 66    # or 61 to tab to the login button then add a 66 
```

我的问题是我必须先让屏幕聚焦才能使这段代码正常工作。我必须触摸一次屏幕，然后代码就可以了。否则它有时会起作用，但有时会不起作用。

我不知道什么代码可以实现“聚焦”功能。低级触摸事件会起作用，但是对于不同的android版本它是不同的，所以我不想使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T15:21:29.147

使用`input`命令

```
usage: input ...
   input text <string>
   input keyevent <key code number or name>
   input tap <x> <y>
   input swipe <x1> <y1> <x2> <y2> 
```

使用`input keyevent`DPAD 和/或 TAB 键代码来定位字段，然后`input text`填充它，然后`input keyevent`使用 ENTER 或 DPAD_CENTER 提交

# javascript - 显示数组中的图像，让用户选择一个并更改节点中的图像

> ID：14093813
> 
> 赞同：1
> 
> 时间：2012-12-30T19:19:58.347
> 
> 标签：javascript, arrays

好的，所以，我试图让用户查看图像的选择并单击一个以更改表中的图像。它当前的方式只是添加数组的最后一个图像。我知道为什么会这样（我认为！），但正在努力寻找解决方案。看评论。一如既往，所有帮助表示赞赏。

```
for (r = 0; r < howOften; r++) {
    row = table.insertRow(-1);
    for (c = 0; c < numDays; c++) {
        col = row.insertCell(-1);
        img = new Image();
        img.src = "../www/images/TEST.png";
        col.appendChild(img); 
        img.onclick = function () {
            var myImages = new Array();
            myImages[0] = "../www/images/TEST3.png";
            myImages[1] = "../www/images/TEST4.png";
            myImages[1] = "../www/images/TEST2.png";
            for (var i = 0; i < myImages.length; i++) {
                var allImages = new Image();
                allImages.src = myImages[i]; //I want to display this array to user somehow
                //and for them to be able to choose one and for this.src to point to that. 
                var gogetImages = allImages.src;
                this.src = (gogetImages); //I know this is wrong
            };
        };
    };
};

//LATEST VERSION STARTS FROM HERE
        function addImage (col) {
    var img = new Image();  // Note that a new img variable will be declared each time this function is called
    img.src = "../www/images/TEST.png";
    col.appendChild(img); 
    img.onclick = function () {
        var myImages = new Array();
        myImages[0] = "../www/images/TEST3.png";
        myImages[1] = "../www/images/TEST2.png";
        myImages[2] = "../www/images/TEST4.png";

        for (var i = 0; i < myImages.length; i++) {
            var allImages = new Image();
            allImages.src=myImages[i];

            var newList = document.createElement("ul");
            var newContent = allImages;
            newList.appendChild(newContent); 
            my_div = document.getElementById("showPics");
            document.body.insertBefore(newList, my_div);
            };

            allImages.onclick = function(){

            alert("the click is working");//it is but only for the last image...grrrrr
            //this.src = ????;
            };
        };
    };

for (r = 0; r < howOften; r++) {
    row = table.insertRow(-1);
    for (c = 0; c < numDays; c++) {
        col = row.insertCell(-1);
        addImage(col);
    };
};
    document.getElementById('holdTable').appendChild(table);
    }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T22:17:42.260

那么，在你的情况下，

您正在使用 img = new Image(); 将值分配给变量而不声明它“在函数中带有 var”会创建一个全局变量。

因此，在您的代码中，您正在创建一个全局“img”变量并将其重新分配给给您带来问题的新图像。

我建议您将代码拆分为如下函数。

```
function addImage (col) {
    var img = new Image();  // Note that a new img variable will be declared each time this function is called
    img.src = "../www/images/TEST.png";
    col.appendChild(img); 
    img.onclick = function () {
        var myImages = new Array();
        myImages[0] = "../www/images/TEST3.png";
        myImages[1] = "../www/images/TEST4.png";
        myImages[1] = "../www/images/TEST2.png";
        for (var i = 0; i < myImages.length; i++) {
            var allImages = new Image();
            allImages.src = myImages[i]; //I want to display this array to user somehow
            //and for them to be able to choose one and for this.src to point to that. 
            var gogetImages = allImages.src;
            this.src = (gogetImages); //I know this is wrong
        };
    };
}

for (r = 0; r < howOften; r++) {
    row = table.insertRow(-1);
    for (c = 0; c < numDays; c++) {
        col = row.insertCell(-1);
        addImage(col);
    };
}; 
```

希望它现在对你有用。

# sql - SQL 查询的计算复杂度

> ID：14093816
> 
> 赞同：7
> 
> 时间：2012-12-30T19:20:15.207
> 
> 标签：sql, sorting, time-complexity

如果我有一个包含诸如 post_id 和 author_id 列的博客文章表，并且我使用了 SQL“SELECT * FROM post_table where author_id = 34”，那么该查询的计算复杂度是多少？它会简单地查看每一行并检查它是否具有正确的作者 ID，O(n)，还是它会做一些更有效的事情？

我只是想知道，因为我处于一种情况，我可以使用这些数据搜索 SQL 数据库，或者加载带有帖子列表的 xml 文件，然后搜索这些，我想知道哪个会更快。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-30T21:13:31.980

有两种基本方式可以执行这样一个简单的查询。

首先是进行全表扫描。这将具有 O(n) 性能。

第二个是在索引中查找值，然后加载页面，并返回结果。索引扫描应该是 O(log(n))。加载页面应该是 O(1)。

对于更复杂的查询，很难做出如此笼统的陈述。但是任何 SQL 引擎通常都会采用这两条路径之一。哦，如果表在 author_id 上分区，还有第三种选择，但您可能对此不感兴趣。

也就是说，数据库的力量并不在于这些细节。它在内存管理中。数据库会将数据*和*索引缓存在内存中，因此您不必重新读取数据页。数据库将利用多个处理器和多个磁盘，因此您不必编写此代码。面对更新和删除，数据库保持一切一致。

至于你的具体问题。如果数据在数据库中，请在那里搜索。将所有数据加载到 xml 文件中，然后在内存中进行搜索需要大量开销。如果与数据库的连接速度很慢并且您正在执行许多此类查询，则您只想这样做。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-30T19:22:05.867

看看[EXPLAIN](http://dev.mysql.com/doc/refman/5.0/en/explain.html)命令。它向您展示了数据库在执行给定的 SELECT 查询时实际执行的操作。

# vim - Vim 相同的键绑定的行为略有不同

> ID：14093818
> 
> 赞同：2
> 
> 时间：2012-12-30T19:20:34.753
> 
> 标签：vim

因此，我的 .vimxc 中有两个命令，可用于使用 python 2.whatever 执行当前的 python 文件。Shift-e 工作正常，等待我按 Enter 键返回 vim。使用 F7 的人不等我按回车，而是打印到屏幕并直接返回 vim，除非出现错误，否则我看不到输出。为什么这些行为不同，我如何让 F7 绑定像 Se 绑定一样等待我按 Enter 键？

```
map <buffer> <S-e> :w<CR>:!/usr/bin/env python2 % <CR> 
map <buffer> <F7> :w<CR>:!/usr/bin/env python2 % <CR> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T10:14:26.587

在任何一种情况下，请确保在最后一个之后没有任何尾随空格`<CR>`；它会导致 vim 立即退出输出视图。

# linux - 关闭脚本中的回声

> ID：14093821
> 
> 赞同：0
> 
> 时间：2012-12-30T19:20:48.097
> 
> 标签：linux, bash, shell

我最近为我的 hostapd ap 编写了一个脚本。

```
#!/bin/bash
#DNS
sudo rc.d start dnsmasq
#Initial wifi interface configuration
sudo ifconfig wlan1 up 10.0.0.1 netmask 255.255.255.0

su -c "echo 1 > /proc/sys/net/ipv4/ip_forward"

#ip forwarding
sudo iptables --flush
sudo iptables --table nat --flush
sudo iptables --delete-chain
sudo iptables --table nat --delete-chain
sudo iptables --table nat --append POSTROUTING --out-interface wlan0 -j MASQUERADE
sudo iptables --append FORWARD --in-interface wlan1 -j ACCEPT

#start hostapd
sudo hostapd /home/monte/hostapd-test.conf 
```

它工作正常，但与我的问题有关；我怎样才能关闭/停止`echo 1 > /proc/sys/net/ipv4/ip_forward`，因为它使我的 CPU 保持运行，这有点烦人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:34:55.707

`/proc`可以通过向其写入 a 来启用布尔值`1`，并使用`0`. 因此，只需执行与脚本中相同的回显，而是使用`0`。

# javascript - 卸载前清除

> ID：14093826
> 
> 赞同：9
> 
> 时间：2012-12-30T19:21:36.637
> 
> 标签：javascript, ajax

我有一个`ajax`使用 onbeforeunload 提交的 textarea 来警告用户，如果他们尝试关闭浏览器，他们还没有提交 textarea。问题是我需要在提交成功时以某种方式清除 onbeforeunload，`ajax`以便 onbeforeunload 知道用户已成功提交表单。有没有办法用一行代码清除 onbeforeunload，类似于 clearTimeout 或 clearInterval？我将展示我目前拥有的 onbeforeunload 代码，即使我认为这并不重要 b/c 我正在寻找一个不同的函数来清除它。请不要框架。谢谢你。

函数调用

```
unsavedChangesWarning(); 
```

Onbeforeunload 函数

```
function unsavedChangesWarning(){
    window.onbeforeunload = function(){
        return 'If you close this page you will lose your stride update!';
    };
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-30T19:24:02.043

`window.onbeforeunload = null`将清除它。只需在尝试将用户重定向到任何地方之前添加它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-26T19:01:59.653

对于 jQuery，这看起来像：

```
$(window).on('beforeunload', function (e)
{
  return 'Please dont leave me';
});

$(window).off('beforeunload'); 
```

如果用户会话过期，我实际上将使用上述解决方案来允许彻底刷新。但是，对于您的用例，我认为在卸载前简单地设置 on 更有意义。

```
$('input, textarea, select').change(function()
{
  $(this).parents('form').addClass('dirty');
});
window.onbeforeunload = function()
{
  if ($('form.dirty').length)
  {
    var confirmationMessage = 'You have edited but not saved a form on this page.';

    (e || window.event).returnValue = confirmationMessage; //Gecko + IE
    return confirmationMessage; //Gecko + Webkit, Safari, Chrome etc.
  }
}; 
```

# r - 无法循环打开 png 设备

> ID：14093834
> 
> 赞同：11
> 
> 时间：2012-12-30T19:22:14.857
> 
> 标签：r, png

我一直在摆弄 R 中的一个函数，长话短说，我有一个`for`-loop，在每一步中，我使用 , 保存一个绘图`png`，然后立即`readPNG`提取 RGB 信息。然后我制作第二个图，然后`readPNG`我可以比较两个图像的 RGB。问题是我不断收到关于无法启动`png()`设备或打开文件进行写入的错误消息，经过多次循环（可以少至少数循环，或多至几千次） .

这是真正简化的代码，但它具有基本要素，并生成错误消息：

```
testfun<-function(beg,fini)
{
 library(png)
 setwd("D://mydirectory")
 for (i in beg:fini)
 {
  png("test.png",width=277,height=277) #candidate image
  par(mai=c(0,0,0,0))
  plot(1,type="n",ann=FALSE,xlim=c(0,255),ylim=c(0,255),
         xaxt="n",yaxt="n",frame.plot=F)
  polygon(x=c(10,60,60),y=c(10,10,60),col="red")
  graphics.off()

  image<-readPNG("test.png")
  #code where I get rgb values for original

  png("test2.png",width=277,height=277) #candidate image with diferent params
  par(mai=c(0,0,0,0))
  plot(1,type="n",ann=FALSE,xlim=c(0,255),ylim=c(0,255),
         xaxt="n",yaxt="n",frame.plot=F)
  polygon(x=c(10,60,60),y=c(10,10,60),col="blue")
  graphics.off()

  image<-readPNG("test2.png")
  #code where I get rgb values for second image, and compare
 }
} 
```

和错误信息：

```
Error in png("test.png", width = 277, height = 277) : 
  unable to start png() device
In addition: Warning messages:
1: In png("test.png", width = 277, height = 277) :
  Unable to open file 'test.png' for writing
2: In png("test.png", width = 277, height = 277) : opening device failed 
```

最初我有`graphics.off()`，`dev.off()`但后来认为循环可能太快了，以至于在需要再次打开之前关闭一个设备不够快，并且不知何故变得“混乱”。我也尝试`Sys.sleep(0.1)`在 each 之后使用`graphics.off`，但这也无济于事。我是否遗漏了一些愚蠢而明显的东西，或者这只是一个设备错误？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2014-09-30T14:07:24.860

我遇到了同样的问题，虽然不是在循环的情况下。就我而言，这是因为我将 .png 输出指向一个不存在的目录。

```
png('./tweets/graphics/unique words.png', width=12, height=8, units='in', res=300) 
```

一旦我创建了目录并正确引用它，错误就消失了，我得到了我的 .png 图像。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-03-26T04:22:53.997

我在循环保存绘图时也遇到了这个问题。@Dino Fire 给了我一个提示，我的循环生成的文件名包含一个非法字符......

确保文件名合法（查找斜线、& 符号、撇号等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-30T09:24:11.787

对我来说，`readPNG()`不起作用的原因是因为我是**从`Rmd`(RMarkdown) 文件**中运行它的。

只要我在 R 控制台或常规脚本中运行代码，它就会立即运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-15T11:57:51.290

如果您使用的是 RStudio（或 R）**，请将工作目录设置为图片所在的位置**(.jpg, .png) 。它应该是一个目录，而不仅仅是 (C:/)。

```
getwd()
setwd("C:/RCode/Deep Learning/Downloads/")
getwd() 
```

# filter - CGridView 中的过滤器和 CActiveDataProvider

> ID：14093839
> 
> 赞同：2
> 
> 时间：2012-12-30T19:22:59.590
> 
> 标签：filter, yii, cgridview

我在控制器的索引操作中有这些代码：

```
public function actionIndex()
{ 
  $cid = @$_GET['cid'];
  $country = Country::model()->findByPk($cid);

  if($cid)
    $dataProvider=new CActiveDataProvider('City', array(
      'criteria'=>array(
        'condition'=>'ci_co_id ='.$cid,
      ),
    ));
  else
     $dataProvider=new CActiveDataProvider('City'); 
  $this->render('index',array(
 'dataProvider'=>$dataProvider,
     'country' => $country
    ));
  } 
```

这些在 view/index.php 文件中：

```
<?php 
$this->widget('zii.widgets.grid.CGridView', array(
  'id'=>'city-grid',
  'dataProvider'=>$dataProvider,
  'filter' => $dataProvider,
  'columns'=>array(
    array(
        'name' => ' ',
        'value' => '$row + 1',
    ),  
    'ci_name',
    'ci_pcode',
    array(
        'class'=>'CButtonColumn',
    ),
   )
));

?> 
```

但是 Yii 给了我这个错误：

```
CActiveDataProvider and its behaviors do not have a method or closure named "getValidators". 
```

问题是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T22:09:38.010

过滤器必须是扩展 CModel 的类。但是，您似乎没有进行任何实际过滤，因此您可以`filter`将 CGridView 的行注释掉。

作为旁注，您的标准存在重大安全漏洞。您对 SQL 注入攻击敞开了大门。

按如下方式指定您的条件，以让数据库处理程序正确转义输入：

```
'criteria'=>array(
  'condition'=>'ci_co_id =:cid',
  'params'=>array(':cid'=>$cid),
), 
```

# javascript - 用 javascript 或 jquery 替换 php 脚本以解码 base64

> ID：14093843
> 
> 赞同：0
> 
> 时间：2012-12-30T19:23:28.167
> 
> 标签：javascript, jquery, html

我使用以下代码将我的画布作为 png 保存到服务器：现在，我想用 js 或 jquery 替换 php，但我不知道用 base64 解码来做到这一点。

文件夹：imgs

HTML：带有 id="save" 的链接以打开带有下载链接的缩略图

Javascript：

```
 $("#save").click(function () {
        $("#result").html("<img src=" + d.toDataURL() + ' /><br /><a href="#" id="get" class="minimal" >Download This</a>');
        $("#data").val(d.toDataURL());
        $("#get").click(function () {
            $("#frm").trigger("submit")
        })
    });
    $("#clear").click(function () {
        e.fillStyle = "#fff";
        e.fillRect(0, 0, d.width, d.height);
        e.strokeStyle = "red";
        e.fillStyle = "red"
    })
})

function saveRestorePoint() {
    var oCanvas = document.getElementById("can");
    var imgSrc = oCanvas.toDataURL("image/png");
    restorePoints.push(imgSrc);
} 
```

PHP：

```
<?php
if (isset($_POST['data'])) {

    $data = $_POST['data'];

    //removing the "data:image/png;base64," part
    $uri = substr($data, strpos($data, ",") + 1);

    $filenamex = time();

    $filename = 'imgs/' . $filenamex . '.png';

    // put the data to a file
    file_put_contents($filename, base64_decode($uri));
    ///*
    //force user to download the image
    if (file_exists($filename)) {
            // We'll be outputting a PNG
            header('Content-type: image/png');
            // It will be called wow.png
            header('Content-Disposition: attachment; filename="' . $filename . '"');
            // The PDF source is in wow.png
            readfile($filename);
            exit();
    }
}
?> 
```

# asp.net - 验证 MVC4 的下拉列表

> ID：14093845
> 
> 赞同：1
> 
> 时间：2012-12-30T19:23:35.197
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-4

我在尝试验证下拉列表时遇到问题，我在这里查看了类似的问题并尝试了这些建议，但仍然没有运气。我没有尝试过的一个是让我的福利 ID 可以为空，但这是个好主意吗？非常感谢

我正在尝试验证的模型：

```
public class Benefit
{
public int Id { get; set; }
public string Name { get; set; }

} 
```

查看型号：

```
public class LookupVm
{
    public SelectList Benefits { get; set; }
} 
```

控制器设置：

```
var model = new LookupVm
{

    Benefits = new SelectList(_repository.Benefits.OrderBy(n => n.Name).ToList(), "Id", "Name")
} 
```

风景：

```
 @Html.DropDownListFor(benefits => Model.Benefits.SelectedValue, Model.Benefits, "-Select-")
        @Html.ValidationMessageFor(benefits => Model.Benefits.SelectedValue) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T21:28:39.117

您可以将 SelectedBenefit 属性添加到您的视图模型

```
public class LookupVm
{
    public int SelectedBenefit { get; set;}
    public SelectList Benefits { get; set; }
} 
```

然后在视图顶部添加

```
@model LookupVm 
```

然后下拉列表必须是这样的：

```
@Html.DropDownListFor(model => model.SelectedBenefit, model.Benefits, "-Select-")
@Html.ValidationMessageFor(model => model.SelectedBenefit) 
```

您将在 SelectedBenefit 属性上获得选定的 id，这将是一个必填字段。

# java - 用于查找模式并从中获取价值的 Java 正则表达式？

> ID：14093849
> 
> 赞同：0
> 
> 时间：2012-12-30T19:24:17.940
> 
> 标签：java, regex

我正在开发一个插件。我将解析 HTML 文件。我有一个这样的命名约定：

```
<!--$include="a.html" --> 
```

或者

```
<!--$include="a.html"--> 
```

类似

根据这种模式（类似于服务器端包含）我想搜索一个 HTML 文件。问题是：

```
Find that pattern and get value (a.html at my example, it is variable) 
```

它应该是这样的：

```
while(!notFinishedWholeFile){
    fileName = findPatternFunc(htmlFile)
    replaceFunc(fileName,something)
} 
```

**PS：**在 Java 中使用正则表达式或以不同的方式实现它（就像使用一样`.indexOf()`）我不知道哪个更好。如果正则表达式通过性能擅长这种情况，我想使用它。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T19:28:57.527

你的意思是这样吗？

```
<!--\$include=\"(?<htmlName>[a-z-_]*).html\"\s?--> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T23:48:38.197

然后将文件读入字符串

```
str = str.replaceAll("(?<=<!--\\$include=\")[^\"]+(?=\" ?-->)", something); 
```

将用字符串替换文件名`something`，然后可以将字符串写回文件。
（注意：这会替换双引号内的任何文本，而不仅仅是有效的文件名。）

如果您只想用 html 扩展名替换文件名，请交换`[^\"]+`for `[^.]+.html`.

在这个任务中使用正则表达式在性能方面是很好的，但是请参阅 [如何使用正则表达式来解析 Java 中的 HTML？](https://stackoverflow.com/questions/677038/how-to-use-regular-expressions-to-parse-html-in-java)和[Java 正则表达式性能](https://stackoverflow.com/questions/3910514/java-regex-performance?rq=1)等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T20:01:25.983

我使用了这种模式：

```
"<!--\\$include=\"(.+)(.)(html|htm)\"-->" 
```

# java - 获取泛型类的 .class

> ID：14093851
> 
> 赞同：2
> 
> 时间：2012-12-30T19:24:38.203
> 
> 标签：java, generics

假设你有一个`C`支持泛型的类（所以`C<X>`定义了一个类型）。我想做类似的事情：

我想获得`Class<C<X>>`该类的一个实例。我想说这可以通过以下表达式获得：

```
C<X>.class 
```

但是编译器不同意我的观点：P

有什么提示吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T19:27:44.093

你能得到的最接近的是

```
@SuppressWarning("unchecked")
Class<C<X>> cxClass = (Class<C<X>>) (Class) C.class 
```

由于泛型是一个编译时特性，所以它并没有像你看到的那样做很多事情。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-30T19:29:38.637

[由于类型擦除](http://docs.oracle.com/javase/tutorial/java/generics/erasure.html)，这是不可能的。类型参数在运行时不可用 - 所有实例`C<Whatever>`实际上都是 simple 的实例`C`。因此，您只能编写像`C.class`.

但是，如果您使用定义具体类型参数的泛型类进行子类化，例如：

```
class StringC extends C<String> {} 
```

...实际上可以`String`通过反射获得类型参数（即）的值。请参阅这些博客：

*   [http://gafter.blogspot.cz/2006/12/super-type-tokens.html](http://gafter.blogspot.cz/2006/12/super-type-tokens.html)
*   [http://www.artima.com/weblogs/viewpost.jsp?thread=208860](http://www.artima.com/weblogs/viewpost.jsp?thread=208860)

# excel - 接下来没有 For VBA

> ID：14093853
> 
> 赞同：0
> 
> 时间：2012-12-30T19:24:48.843
> 
> 标签：excel, for-loop, compiler-errors, next, vba

当我尝试运行此代码时，我不断收到“编译错误：next without For”。但是，在多次检查所有内容后，我看不出它如何无法识别它们的存在。这是我的第一个 VBA 代码，因此将不胜感激。

```
Sub Naming()
'
' Naming Macro
' Assigns a category name in a cell based on values in a cell one column over 
'

Dim number As Double

For i = 9 To 200
    number = Cells(i, 3).Value
        If number = 0 Then
            GoTo Line1
        Else
            If number <= 199999 And number > 0 Then
            Cells(i, 2) = "EP-GEARING"
        Else    
            If number <= 399999 And number > 199999 Then
            Cells(i, 2) = "DRIVES"
        Else
            If number <= 499999 And number > 399999 Then
            Cells(i, 2) = "FLOW"
        Else
            If number <= 599999 And number > 499999 Then
            Cells(i, 2) = "SPARES"
        Else
            If number <= 699999 And number > 599999 Then
            Cells(i, 2) = "REPAIR"
        Else
            If number <= 799999 And number > 699999 Then
            Cells(i, 2) = "FS"
        Else
            If number <= 899999 Then
            Cells(i, 2) = "GC-GEARING"
        Else
            GoTo Line1
Line1:
        End If
Next i

End Sub 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T19:58:42.527

`ElseIf`是VB中的一个词。

```
If number = 0 Then
    'Do nothing
ElseIf number <= 199999 And number > 0 Then
    Cells(i, 2) = "EP-GEARING"
ElseIf number <= 399999 And number > 199999 Then
    ...
Else
    'Do nothing
End If 
```

但是，`Select Case`这里更适合：

```
Select Case number
    Case 0
        'Do nothing
    Case 1 To 199999
        Cells(i, 2) = "EP-GEARING"
    Case 200000 To 399999
        ...
    Case Else
        'Do nothing
End Select 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:33:43.643

您的代码应如下所示：

```
Sub Naming()
'
' Naming Macro
' Assigns a category name in a cell based on values in a cell one column over 
'

Dim number As Double

For i = 9 To 200
    number = Cells(i, 3).Value

    If number <= 199999 And number > 0 Then
        Cells(i, 2) = "EP-GEARING"
    ElseIf number <= 399999 And number > 199999 Then
        Cells(i, 2) = "DRIVES"
    ElseIf number <= 499999 And number > 399999 Then
        Cells(i, 2) = "FLOW"
    ElseIf number <= 599999 And number > 499999 Then
        Cells(i, 2) = "SPARES"
    ElseIf number <= 699999 And number > 599999 Then
        Cells(i, 2) = "REPAIR"
    ElseIf number <= 799999 And number > 699999 Then
        Cells(i, 2) = "FS"
    ElseIf number <= 899999 Then
        Cells(i, 2) = "GC-GEARING"
    End If

Next i

End Sub 
```

最初编写的代码的问题是，无论 Else 子句如何，编译器仍然期望每个 If 都有一个 End If，并且因为它们不存在而感到困惑。单个关键字最后`ElseIf`只需要一个`End If`语句。

很少建议使用 Goto。99% 的情况下，有一种更好、更简洁的方式来编写它，而无需使用 Goto。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T03:24:34.673

其他答案表明您如何修复您的`If`语句，以便 VBA 识别您的`For`和`Next`配对。

现在，就个人而言，如果您的循环是必要的，我建议使用`Select Case`GSerg 指示。

但这可能是我会做的。在单元格`B9`中放置以下公式：`=IF(C9=0,"",IF(C9<=199999,"EP-GEARING",IF(C9<=399999,"DRIVES",IF(C9<=499999,"FLOW",IF(C9<=599999,"SPARES",IF(C9<=699999,"REPAIR",IF(C9<=799999,"FS",IF(C9<=899999,"GC-GEARING",""))))))))`然后将其复制到您需要的地方。

或者如果你想用代码来做，你可以替换你的整个 sub 而没有循环我可以把它写成一个 1 班轮，但我希望它清晰易读：

```
Sub Naming()
'
' Naming Macro
' Assigns a category name in a cell based on values in a cell one column over
Dim theRange As Range
Set theRange = Range(Cells(9, 2), Cells(200, 2))
theRange.Value = "=IF(RC[1]=0,""""," & _
                "IF(RC[1]<=199999,""EP-GEARING""," & _
                "IF(RC[1]<=399999,""DRIVES""," & _
                "IF(RC[1]<=499999,""FLOW""," & _
                "IF(RC[1]<=599999,""SPARES""," & _
                "IF(RC[1]<=699999,""REPAIR""," & _
                "IF(RC[1]<=799999,""FS""," & _
                "IF(RC[1]<=899999,""GC-GEARING"",""""))))))))"
'Optional if you want only the values without the formula, uncomment next line
'theRange.Value = theRange.Value

Set theRange = Nothing

End Sub 
```

使用 Excel 公式解决此类问题通常更快、更清晰，而不是在 VBA 中写出逻辑并循环遍历单元格。

# algorithm - 修改后的 VlookUp，它返回与查找值对应的第 k 个值

> ID：14093856
> 
> 赞同：0
> 
> 时间：2012-12-30T19:25:06.323
> 
> 标签：algorithm, vba, excel, lookup, vlookup

我想修改这个函数：[来自单元格的自定义 Excel VBA 函数（修改后的 VLOOKUP）引用不同文件中的范围会给出错误](https://stackoverflow.com/questions/12524491/custom-excel-vba-function-modified-vlookup-from-cell-referring-to-a-range-in-d)

我需要的功能在概念上很简单 - 我需要 VlookUp 它的返回值对应于查找值的第 k 次出现而不是标准的第 1 次，例如：

如果第 k 次出现不存在，则函数应返回错误。

类似电子表格的数据：

```
 A       B   
1   "a"    "1a"   
2   "a"    "2a"    
3   "b"    "1b"
4   "a"    "3a"
5   "b"    "2a"

VLOOKUPnew(lookup_value =A1, table_array =A1:B3, 
        col_index_num = 2, exactMatch =0, k=1) should return 1a

VLOOKUPnew(lookup_value =A1, table_array =A1:B3, 
        col_index_num = 2, exactMatch =0, k=2) should return 2a

VLOOKUPnew(lookup_value =A1, table_array =A1:B3, 
        col_index_num = 2, exactMatch =0, k=3) should return 3a

VLOOKUPnew(lookup_value =A3, table_array =A1:B3, 
        col_index_num = 2, exactMatch =0, k=1) should return 1b

VLOOKUPnew(lookup_value =A3, table_array =A1:B3, 
        col_index_num = 2, exactMatch =0, k=2) should return 2b

VLOOKUPnew(lookup_value =A3, table_array =A1:B3, 
        col_index_num = 2, exactMatch =0, k=3) should return error 
```

我熟悉 R 和 Matlab，所以我的想法是面向向量的，我首先尝试通过重写一行代码（来自我链接到的帖子）来编写 case witk **k=1 或 2的代码：**

`row = .Match(lookup_value, table_array.Columns(1), 0)`

进入 ：

`If k =2 Then row_1 = .Match(lookup_value, table_array.Columns(1), 0) number_of_rows=table_array.Columns(1).Rows.Count`

`row = .Match(lookup_value, table_array.Columns(1).Rows( (row_1+1):number_of_rows ), 0)`

上面的行是伪代码，因为我不知道如何正确编写它（`.Rows( (row_1+1):number_of_rows )`是数字向量，看起来很有趣）

`else`
`row = .Match(lookup_value, table_array.Columns(1), 0)
End If`

对于 k > 2，将此代码放入 for 循环会很简单（但效率低下）。

我注意到修改后的 .Match() 也将**k**作为参数，这将使所有工作都需要。使用循环来查找第 k 个值出现的位置似乎很慢，或者我可能对 VBA 不太熟悉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:48:45.373

您可以尝试这两个基于 Excel 的公式：根据您的数据表进行调整。

*   方法一：

`CountIF`函数允许您计算查找值在列范围内的出现次数。

`=COUNTIF(columnRange,lookupvalue)`

假设这是您可能正在寻找的：从参考中提取的数据。

`CUST`使用填充列`=F78&COUNTIF($F$75:$F78,F78)`

```
Master Data Starts from `F75 to H84`    
Customer    CUST    Phone number
Smith   Smith1  320-966-4023
Smith   Smith2  686-612-7782
Jason   Jason1  122-617-7154
Albert  Albert1 547-436-7376
Nancy   Nancy1  956-633-7322
Smith   Smith3  132-716-5240
Grove   Grove1  340-267-0529
Andy    Andy1   531-413-4718
Jason   Jason2  613-228-4294
Nancy   Nancy2  272-525-2042 
```

最后第 n 次查找：

例如，客户第 4 次出现的电话号码 =`Smith`

`=VLOOKUP($D$74&"4",$G$75:$H$93,2,FALSE)`

```
Lookup  
Customer    Smith
Phone number    
1st 320-966-4023
2nd 686-612-7782
3rd 132-716-5240
4th 185-813-8883 
```

[来自 Chandoo 的参考： 4\. 查找列表中项目的第 2 次/第 3 次/第 4 次出现](http://chandoo.org/wp/2008/06/09/what-the-if-learn-6-cool-things-you-can-do-with-excel-if-functions/)。

*   方法2：用于以下公式的样本数据：

![在此处输入图像描述](../Images/d9888779c11e9a7d60781b507260c9e9.png)

公式：

```
=INDEX(ALTable,SMALL(IF(OFFSET(ALTable,0,0,ROWS(ALTable),1)=F90,
ROW(OFFSET(ALTable,0,0,ROWS(ALTable),1))-ROW(OFFSET(ALTable,0,0,1,1))+1,
ROW(OFFSET(ALTable,ROWS(ALTable)-1,0,1,1))+1),F91),2) 
```

[来自 CPearson Arbitary Lookups 的参考](http://www.cpearson.com/excel/TablesAndLookups.aspx)。就我个人而言，我不喜欢[volatile 函数](http://www.decisionmodels.com/calcsecretsi.htm)，例如`index()`......虽然......

# c - 当 str1 中的字符匹配时，如何删除 str2 中的字符？

> ID：14093859
> 
> 赞同：1
> 
> 时间：2012-12-30T19:25:20.643
> 
> 标签：c, algorithm, hashtable

当 str1 中的字符匹配时，我尝试删除 str2 中的字符。假设如果 string2 是“Haelloi Waoruld”并且 string1 是“aiu”，那么在从 string2 中的字符串 1 中删除每个字符之后，string2 看起来比如：“你好世界”

虽然我可以用普通的字符串操作来解决这个问题，但我被要求使用 C 语言中的哈希表概念来实现相同的功能。我不知道如何在哈希表中实现这一点。

任何人都可以帮助我使用相同的算法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T19:36:46.647

遍历 str1，如果字符在 str1 中，则创建一个按字符索引的布尔表。然后遍历 str2 并仅输出表中值为 false 的字符。

# applescript - Applescript 将文件附加到邮件消息。在 OSX 10.4 到 10.6 中工作将无法在 10.8 中工作

> ID：14093860
> 
> 赞同：-1
> 
> 时间：2012-12-30T19:25:31.497
> 
> 标签：applescript, osx-mountain-lion, email-attachments

在 10.8 中，我的 Applescript（在我运行 10.4 到 10.6 时开发）读取逗号分隔的文本文件，使用这些值创建新的邮件消息，然后使用 NSstring 路径名将 xx.pdf 文件附加到文件，仍然发送电子邮件，但不包括附件。我通过研究该问题了解到，10.8 安全增强功能已“沙盒化”邮件应用程序和 applescript 应用程序，因此路径名不再作为文件的有效、可传递链接。我找到了几个声称可以解决问题的示例，声称必须将 NSstring“文件名：”替换为 NSURL 格式的文件名，但代码看起来不像 applescript，并且不会在 applescript 编辑器中编译。你有一个applescript的例子，它将文件附加到一个新的，applescript 生成的电子邮件？我已经尝试了几天来解决这个问题，但没有成功。我什至拨打了 Apple 支持热线，但他们说不再支持 Applescript 相关问题。

我从文本文件传入的变量名为“theAttachment1”。我试图开始工作的路线是：

“在最后一段之后使用属性 {file name:theAttachment1} 创建新附件

同样，它在 10.4 到 10.6 中运行良好，但在 10.8 中无法运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T00:27:59.097

这适用于我 10.8

```
 set theAttachment1 to POSIX file "/Users/USERNAME/Desktop/Desktop--IMAGE/scooter-6.jpg"

tell application "Mail"
    set newMessage to make new outgoing message with properties {subject:"subject", content:"the_content" & return & return}
    tell newMessage

        set visible to false
        set sender to "myaddress@btinternet.com"
        make new to recipient at end of to recipients with properties {address:"someAddress@btinternet.com"}
        make new attachment with properties {file name:theAttachment1} at after the last paragraph

        (* change save to send to send*)
        save --<<<<---------------- change save to send to send
        (* change save to send to send*)
    end tell
end tell 
```

该路径可以是 Unix 路径：**“/Users/USERNAME/Desktop/Desktop--IMAGE/scooter-6.jpg”** 或 Posix 文件路径：**“Macintosh HD:Users:USERNAME:Desktop:Desktop--IMAGE:scooter -6.jpg"**

在此脚本中，我将路径从 Unix 路径转换为 ​​Posix 文件路径

# ubuntu - redis 命令行命令似乎不起作用

> ID：14093865
> 
> 赞同：2
> 
> 时间：2012-12-30T19:26:18.993
> 
> 标签：ubuntu, command-line, redis

我在 ubuntu 12 终端中运行 redis 命令时遇到了一个愚蠢的问题，也许我的问题很愚蠢，如果是这样，请考虑我是 redis 和 ubuntu 的新手用户。

我已经按照官方指南[http://redis.io/download安装了redis 2.6.7](http://redis.io/download)

现在我运行这些命令：

```
redis-server 
```

它说它现在已经连接，但是在我输入每个命令之后什么都没有发生，所以我按 (Ctrl + z) 然后键入：

```
redis-cli 
```

并且似乎连接成功并且出现类似这样的东西：

```
redis 127.0.0.1:6379> 
```

所以我输入了一些命令，但没有任何反应。例如这个命令：

```
get users:leto 
```

并且只出现一个空行。（似乎它正在等待某些东西来完成命令）

那么根据这个有什么问题呢？我错过了一个简单的点还是还有另一个问题？

谢谢你的帮助，我真的很困惑。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T21:38:54.087

在我看来，您已`redis-server`按暂停`Ctrl+Z`，因此它无法响应任何内容（`redis-cli`可能没有连接到服务器，但它被写入以便在这种情况下不会立即失败）。您可以`redis-server`在按 后发出`bg`命令在后台恢复`Ctrl+Z`。

我建议您阅读 UNIX shell 中的作业控制以更好地理解这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-08T10:00:04.410

**如果您赶时间，简单的解决方案在底部。**

我遇到了同样的问题，面对一个正在运行的 redis 服务器和类型命令，然后等到无聊。而且我什至不知道有 redis-cli 命令！

看到这个问题后。我回到我的终端并在我的 redis-sever 终端屏幕中输入 redis-cli。如您所知，仍然没有任何反应。

但是一个好主意击中了我。我打开另一个终端，然后输入 redis-cli。

```
redis-cli 
```

现在一个漂亮的redis界面提示出来了，看起来像

```
127.0.0.1:6379> 
```

哇！惊险。让我们试试它是否有效

```
127.0.0.1:6379>APPEND zen Solver_of_this_problem
(interger) 22
127.0.0.1:6379>GET zen
'Solver_of_this_problem' 
```

惊人的！我现在可以处理我的redis了！

所以秘诀是：

# 打开两个终端，一个用于 redis-sever，另一个用于 redis-cli。

# php - 奇怪的 pow() php 错误

> ID：14093866
> 
> 赞同：1
> 
> 时间：2012-12-30T19:26:28.927
> 
> 标签：php

我有这段 php 代码：

```
$skill_amount = round(pow($rarity,1.25)); 
```

应该注意的是，$rarity 是从查询中派生的。

我正在输入像 0,2,4,8,16,32,64 这样的值。

99% 的时间它都在工作，但在少数情况下，我的用户报告了巨大的价值，例如：

13771, 77936

这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T19:31:23.807

```
"What could possibly be causing this?" 
```

的大值或意外值`$rarity`。

如果您可以检查 $rarity 的所有可能值，您应该这样做。否则，您可以进行一些基本的调试。

```
if ($skill_amount > some sane value) {
    // log $skill_amount & $rarity to a file or email
    // maybe also some other investigative values, like stuff that assisted the derivation of $rarity
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:41:12.560

在这个脚本中没有发现任何问题，所以我同意需要对 $rarity 进行健全性检查。

```
<?php // RAY_temp_amy_neville.php
error_reporting(E_ALL);
echo '<pre>';

$range = range(1, 4096);
foreach ($range as $rarity)
{
    $skill_amount = round(pow($rarity,1.25));
    $out[$rarity] = $skill_amount;
}
print_r($out); 
```

# java - Arrays.asList 如何返回实例化的 List？

> ID：14093867
> 
> 赞同：1
> 
> 时间：2012-12-30T19:26:28.447
> 
> 标签：java, arrays, arraylist

`Arrays.asList`返回一个类型化的列表。但是 List 是一个接口，那么如何实例化呢？如果尝试实例化一个类型化的列表，我会收到一条错误消息，指出这是不可能的。

**编辑**

没关系，我看到发生了什么，只是被文档迷惑了一会儿。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T19:30:59.757

这是一个`Arrays.ArrayList`不应该与 混淆`java.util.ArrayList`。它是数组的包装器，这意味着您所做的任何更改都会更改原始数组，并且您无法添加或删除条目。通常它与 ArrayList 结合使用，例如

```
 List<String> words = new ArrayList<>(Arrays.asList("Hello", "There", "World")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T19:38:24.057

A`List`不能被实例化，当然。但是您可以实例化一个*实现* `List`的类——例如，一个`ArrayList`or`LinkedList`等​​。这些类实际上是`List`s。返回 a `List`（接口类型）的重点是该方法可以返回实现该`List`接口的任何对象，您不必担心它究竟是哪种具体类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T21:24:41.487

从类数组

```
public static transient List asList(Object aobj[])
{
    return new ArrayList(aobj);
} 
```

因此，当您执行 Arrays.asList(...) 时，您将采用实现 List 的 ArrayList。没有人会知道这一点，除了这个本身。

*   1 个例子

    字符串[] 数组 = 新字符串[] {"一","二","三"}; 列表列表 = Arrays.asList(array);

# javascript - 我怎么知道一个页面真的完全加载了？

> ID：14093870
> 
> 赞同：6
> 
> 时间：2012-12-30T19:26:58.523
> 
> 标签：javascript, python, webview, webkit, web-crawler

我正在使用 python webkit.WebView 和 gtk 来抓取网页。但是，网页是由 javascript 动态加载的。

WebView“加载完成”事件不足以处理此问题。是否有任何指标/事件让我知道即使是由 javascript 生成的内容，页面也确实已完全加载？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T20:09:28.320

没有真正的方法来确定该页面是否已完全加载。

一种方法是确定自上次请求以来的时间量。但是，有些页面会不断地重复请求。这在跟踪脚本和一些广告脚本中很常见。

我要做的是在网络视图说它完成加载后使用一定的时间...... 5 秒左右。它并不完美，但却是你得到的最好的，因为没有办法确定任意页面的“完全加载”是什么。

# php - WordPress Meta Box - 第二个字段未保存

> ID：14093873
> 
> 赞同：-1
> 
> 时间：2012-12-30T19:27:20.567
> 
> 标签：php, wordpress, meta-boxes

所以我一直在玩一些自定义元框和遵循教程等 - 我已经到了顶部元框字段正确保存但第二个（宽度）没有保存的地步 - 有什么明显的我在在这里做错了吗？我尝试将第二个字段的保存分隔到一个单独的函数中进行测试，但这也不起作用。

```
 add_action( 'add_meta_boxes', 'youtube_metaboxes' );

    function youtube_metaboxes() {
        add_meta_box('wpt_youtube', 'youtube URL', 'wpt_youtube', 'product', 'side', 'default');
    }

    function wpt_youtube() {
        global $post;
        echo '<input type="hidden" name="youtubemeta_noncename" id="youtubemeta_noncename" value="' .
        wp_create_nonce( plugin_basename(__FILE__) ) . '" />';
        $addyoutube = get_post_meta($post->ID, '_youtube', true);
        echo '<input type="text" name="_youtube" value="' . $addyoutube  . '" class="widefat" />';
        $youtubeWidth = get_post_meta($post->ID, '_width', true);
        echo 'Width: <br /><input type="text" name="_width" value="' . $youtubeWidth  . '" class="widefat" />';
    }

    // Save the Metabox Data
    function wpt_save_youtube_meta($post_id, $post) {
        if ( !wp_verify_nonce( $_POST['youtubemeta_noncename'], plugin_basename(__FILE__) )) {
        return $post->ID;
        }
        if ( !current_user_can( 'edit_post', $post->ID ))
            return $post->ID;
        $addyoutube_meta['_youtube'] = $_POST['_youtube'];
        foreach ($addyoutube_meta as $key => $value) {
            if( $post->post_type == 'revision' ) return;
            $value = implode(',', (array)$value); // If $value is an array, make it a CSV (unlikely)
            if(get_post_meta($post->ID, $key, FALSE)) {
                update_post_meta($post->ID, $key, $value);
            } else {
                add_post_meta($post->ID, $key, $value);
            }
            if(!$value) delete_post_meta($post->ID, $key);
        }

        $addWidth_meta['_width'] = $_POST['_width'];
        foreach ($addWidth_meta as $key => $value) {
            if( $post->post_type == 'revision' ) return;
            $value = implode(',', (array)$value); // If $value is an array, make it a CSV (unlikely)
            if(get_post_meta($post->ID, $key, FALSE)) {
                update_post_meta($post->ID, $key, $value);
            } else {
                add_post_meta($post->ID, $key, $value);
            }
            if(!$value) delete_post_meta($post->ID, $key);
        }
    }

add_action('save_post', 'wpt_save_youtube_meta', 1, 2); // save the custom fields 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T17:38:44.903

我浏览了这篇文章：

[http://wp.tutsplus.com/tutorials/reusable-custom-meta-boxes-part-1-intro-and-basic-fields/](http://wp.tutsplus.com/tutorials/reusable-custom-meta-boxes-part-1-intro-and-basic-fields/)

似乎是创建自定义元框的更好方法。

# multithreading - 如何在单独的线程（与主线程不同）中打开 ClientDataSet（主/详细信息）

> ID：14093874
> 
> 赞同：3
> 
> 时间：2012-12-30T19:27:22.917
> 
> 标签：multithreading, delphi, firebird, datasnap, dbexpress

使用：Delphi XE2、DBExpress、火鸟

我无法安全地访问主线程之外的任何 VCL 控件，包括表单、面板、编辑等以及 Timage 和 Timage 后代。我需要在单独的线程（与主线程不同）中打开 ClientDataSet（Master/Detail）。

我需要在访问数据库时创建动画启动画面

有人可以告诉我一个如何做到这一点的简单例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T13:57:45.797

~~我假设线程中的数据库访问对您来说没有问题。~~

有关对 dbExpress 数据库进行线程访问的完整示例（包括对主线程的反馈），请参见[Marco Cantù](https://stackoverflow.com/users/45145/marco-cantu)在此处制作的示例：[dbexpress_firebird_examples](http://blog.marcocantu.com/blog/dbexpress_firebird_examples.html)。

它涉及将所有数据库连接设置放入 a`TDataModule`并为每个线程访问创建此数据模块的实例。

无论如何，为了让 GUI 使用动画 Gif 了解后台线程进程，这里有一个示例：

![在此处输入图像描述](../Images/bf3997e6c48a0698b289c278b973d230.png)

```
unit TestAnimatedScreen;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.Imaging.GIFImg,
  Vcl.ExtCtrls;

type
  TMyEndNotify = procedure (value: Boolean) of object;

type
  TMyThread = class(TThread)
  private
    fEndNotification : TMyEndNotify;
    procedure NotifyEndOfThread;
  protected
    procedure Execute; override;
  public
    Constructor Create(endNotification : TMyEndNotify);
  end;

type
  TMainForm = class(TForm)
    Image1: TImage;
    Button1: TButton;
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
    FShowAnimation : Boolean;
    procedure SetShowAnimation(value : Boolean);
  public
    { Public declarations }
    property ShowAnimation : Boolean read FShowAnimation write SetShowAnimation;
  end;

var
  MainForm: TMainForm;

implementation

{$R *.dfm}

procedure TMyThread.NotifyEndOfThread;
begin
  if Assigned(fEndNotification) then
    fEndNotification(False);
end;

constructor TMyThread.Create(endNotification: TMyEndNotify);
begin
  Inherited Create(false);
  fEndNotification := endNotification;
  Self.FreeOnTerminate := True; // Free automatically
end;

procedure TMyThread.Execute;
begin
  try
    {Add your database access code here}
    Sleep(5000); // Simulate lengthy process
  finally
    Synchronize(NotifyEndOfThread);
  end;
end;

{ TMainForm }

procedure TMainForm.Button1Click(Sender: TObject);
begin
  ShowAnimation := True;
  TMyThread.Create(Self.SetShowAnimation);
end;

procedure TMainForm.SetShowAnimation(value: Boolean);
begin
  FShowAnimation := Value;
  if FShowAnimation then
  begin
    {Add animation code here}
    Button1.Enabled := false;
    Button1.Caption := 'Processing, please wait ...';
    (Image1.Picture.Graphic as TGIFImage).AnimateLoop := glEnabled;
    (Image1.Picture.Graphic as TGIFImage).Animate := true;
  end
  else
  begin
    {Stop animation}
    (Image1.Picture.Graphic as TGIFImage).Animate := false;
    Button1.Caption := 'Start lengthy process';
    Button1.Enabled := True;
  end;
end;

end. 
```

* * *

```
object MainForm: TMainForm
  Left = 0
  Top = 0
  Caption = 'MainForm'
  ClientHeight = 265
  ClientWidth = 236
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'Tahoma'
  Font.Style = []
  OldCreateOrder = False
  PixelsPerInch = 96
  TextHeight = 13
  object Image1: TImage
    Left = 8
    Top = 8
    Width = 200
    Height = 200
    AutoSize = True
    IncrementalDisplay = True
  end
  object Button1: TButton
    Left = 8
    Top = 224
    Width = 200
    Height = 25
    Caption = 'Start lengthy process'
    TabOrder = 0
    OnClick = Button1Click
  end
end 
```

如果您有比 Delphi 2007 更旧的 Delphi 版本，请参阅[如何以 delphi 形式使用动画 Gif 以](https://stackoverflow.com/q/9573572/576719)获取有关如何实现动画 GIF 的更多信息。

我使用的动画 GIF 可以在[这里](http://en.wikipedia.org/wiki/Graphics_Interchange_Format)找到。

# bash - 当在标准错误中看到特定字符串时，如何终止进程？

> ID：14093878
> 
> 赞同：9
> 
> 时间：2012-12-30T19:27:43.310
> 
> 标签：bash, grep, stderr

我需要开始一个过程，让我们说`foo`。我希望看到 stdout/stderr 正常，但`grep`stderr for string `bar`。一旦`bar`在 stderr 中发现`foo`应该被杀死。

这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T20:13:33.937

*我最初编写了一种涉及流混合的方法，但它不是很好。一些评论与该版本有关。如果您好奇，请查看历史。*

这是一种方法：

```
(PIDFILE=$(mktemp /tmp/foo.XXXXXX) && trap "rm $PIDFILE" 0 \
   && { foo \
           2> >(tee >(grep -q bar && kill $(cat $PIDFILE)) >&2) \
        & PID=$! && echo $PID >$PIDFILE ; wait $PID || true; }) 
```

老式的噩梦燃料。这里发生了什么事？

1.  最外面的括号把整个东西放在一个子shell中；出于卫生的目的，这限制了变量的范围
2.  我们使用适用于 GNU 和 BSD 的语法创建一个临时文件，`mktemp`并将其命名为`PIDFILE`
3.  我们设置了一个包罗万象的退出陷阱（当最外层的子shell退出时运行）以删除名为的文件`PIDFILE`，再次用于 hygeine
4.  我们跑`foo`；这是在复合语句中完成的，因此`&`绑定到`foo`而不是绑定到整个前面的管道
5.  我们将`foo`的标准错误重定向到等待`bar`出现然后终止的进程替换`foo`（稍后会更多）
6.  我们将 的 PID 捕获`foo`到一个变量中，将其写入以 命名的文件中`PIDFILE`，然后等待它，这样整个命令`foo`在自己退出之前等待退出；丢弃发生这种情况时的`|| true`错误退出状态`foo`。

进程替换中的代码如下工作：

1.  一、`tee`输入（`foo`的标准错误），将`tee`的标准输出重定向到标准错误，这样`foo`的标准错误确实出现在标准错误上
2.  将输入的副本发送到一个文件去另一个进程替换（[进程替换*中*的进程替换](http://inception.davepedu.com/)）
3.  在更深层次的进程替换中，首先`grep -q`在输入上运行，它查找指定的模式，并在找到它时立即退出（或者当它到达流的末尾时），不打印任何东西，之后（如果它找到字符串并成功退出）外壳继续...
4.  `kill`在名为的文件中捕获PID的进程`PIDFILE`，即`foo`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-30T21:26:32.840

[汤姆安德森的回答](https://stackoverflow.com/a/14094251)非常好，但`kill $(cat $PIDFILE)`只有在我的系统`foo`上自行终止或通过 Ctrl-C 终止时才会发生。以下解决方案对我有用

```
while read g
do
  if [[ $g =~ bar ]]
  then
    kill $!
  fi
done < <(
  exec foo 2> >(tee /dev/tty)
) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-31T22:57:20.843

### 使用 Expect 监控标准错误

Expect 旨在根据流程的输出采取行动。最简单的解决方案是让 Expect 启动进程，然后在看到预期输出时退出。例如：

```
expect -c 'set msg {Saw "foo" on stderr. Exiting process.}
           spawn /bin/bash -c "echo foo >&2; sleep 10"
           expect "foo" { puts $msg; exit }' 
```

如果生成的进程正常结束（例如，在看到“foo”之前），那么 Expect 脚本也会退出。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-30T20:56:31.677

作为另一个答案的替代方案，一种方法是使用 bash 的`coproc`工具：

```
{coproc FOO { foo; } 2>&1 1>&3; } 3>&1
CHILD=$!
while read line <&${FOO[0]}; do
    if echo "$line" | grep -q bar; then
        kill $CHILD
    else
        echo "$line"
    fi
done 
```

不过，这显然是特定于 bash 的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-30T21:54:29.500

实际上，我设法找到了一种无需 PID 文件或协同例程的方法，并且可以在所有与 POSIX 兼容的 shell 中工作（我已经尝试过`bash`）`dash`。至少在支持的系统上`/dev/fd/`，但这应该是几乎所有的系统。

不过，这有点令人费解，所以我不确定它是否符合您的喜好。

```
(                               # A
    (                           # B
        ( /tmp/foo 2>&1 1>&3 & echo $! >&4 ) |              # C
        ( tee /dev/fd/2 | ( grep -q bar && echo fin >&4 ) ) # D and E
    ) 4>&1 | (                  # F
        read CHILD
        read STATUS
        if [ "$STATUS" = fin ]; then
            kill $CHILD
        fi
    )
) 3>&1 
```

解释这里使用的众多子shell：

使用复制到 fd 3 的正常标准输出运行的主体`A`。它运行子shell `B`，`F`并将标准输出通过`B`管道传输到`F`.

在 fd 4 上重复`B`的管道运行的主体。`A`

`C`运行您的实际 foo 命令，其 stderr 连接到来自`C`to的管道`D`，其标准输出从 fd 3 复制；即恢复到全局标准输出。然后将 PID 写入`foo`fd 4；也就是说，到 subshel​​l`F`在其标准输入上的管道。

`D`运行一个`tee`命令，从管道接收`foo`其 stderr 上打印的任何内容。它将输出复制到`/dev/fd/2`（为了让它显示在全局标准错误上）和连接到 subshel​​l 的管道`E`。

`E`grep 查找 bar，然后在找到时写入`fin`fd 4，即写入`F`其标准输入的管道。请注意，如果 grep 遇到 EOF 而没有找到，请`&&`确保写入 no 。`fin``bar`

`F`，然后，从 中读取 PID 并从 中读取`C`终止`fin`符`E`。如果`fin`终止符被正确输出，它会杀死`foo`.

**编辑**：修复了`tee`将 foo 的 stderr 复制到真正的 stderr 的缺失。

# java - 如何在其中一个字段上对类对象列表进行排序？

> ID：14093883
> 
> 赞同：2
> 
> 时间：2012-12-30T19:28:30.117
> 
> 标签：java, class, sorting, comparator

我有一个 DataPoint 对象列表。类定义是：

```
public static class DataPoint
     {
         public Comparable X;
         public Comparable Y;
         public Comparable Z;

         public String text; 

               ...
          } 
```

“list”是 DataPoint 对象的 ArrayList。如何仅根据 X 值对列表进行排序？会在这里使用 Collections.sort(list, compare) 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T19:32:17.683

是的，您应该为每个字段创建特定的比较器。例子：

```
Comparator<DataPoint> compByX = new Comparator<DataPoint>() {
    @Override
    public int compare(DataPoint left, DataPoint right) {
        return left.X.compareTo(right.X);
    }
};
Collections.sort(list, compByX); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T19:33:44.173

你有两个选择：

*   [`Comparable<DataPoint>`](http://docs.oracle.com/javase/6/docs/api/java/lang/Comparable.html)为您的`DataPoint`班级实施
*   编写一个实现[`Comparator<DataPoint>`](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)然后使用的自定义比较器`Collections.sort`

如果您想对对象进行自然排序（这将是最常用的），第一个解决方案是有意义的。通常，它是您在需要额外订购时使用比较器时首先使用的那个。

它们的行为方式相同，但`Comparable<T>`本质上附加到对象，因为它是其默认比较算法。每当涉及排序时，除非您指定另一个排序，否则将使用默认排序。

```
class DataPoint implements Comparable<DataPoint> {
  @Override
  public int compareTo(DataPoint o) {
    return X.compareTo(o.X);
  }
} 
```

请注意，当您需要比较对象时，通常还需要对它们进行其他操作，因此请注意覆盖`hashCode()`和`equals(Object o)`. 后者用于排序，如文档所述：

> 当且仅当 e1.compareTo(e2) == 0 对于 C 类的每个 e1 和 e2 具有与 e1.equals(e2) 相同的布尔值时，C 类的自然排序被称为与 equals 一致。.. .**强烈建议（尽管不是必需的）自然排序与equals 一致。**

**这意味着如果您只是比较 X 变量，那么两个相同的不同`DataPoint`对象`X`将被认为是相等的`compareTo`。这可能会导致奇怪的情况。**

# javascript - 在无序列表中创建元素

> ID：14093889
> 
> 赞同：0
> 
> 时间：2012-12-30T19:29:04.110
> 
> 标签：javascript, javascript-events

我有一个在表单中创建无序列表的函数。我有另一个函数应该根据选择框的选定值将项目添加到列表中。第二个函数将项目添加到列表中，它们具有适当的 id 和诸如此类的东西，但没有文本。无论我尝试什么，我都无法让这些项目在其中包含文本。这是javascript函数的当前内容。

```
function anotherItem()
{

var textValue = document.forms['newForm'].selectBox1.value;
var ul = document.getElementById("newList");    
var new_item = document.createElement("li");
new_item.id = textValue;
new_item.innerHtml = textValue; // I've also tried new_item.value = textValue among variations.
ul.insertBefore(new_item, ul.firstChild);

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:35:43.127

```
5|    new_item.innerHtml = textValue; 
 |                  └┬─┘
 |                   └───Should be "HTML" 
```

[JavaScript 区分大小写。](http://en.wikipedia.org/wiki/JavaScript_syntax#Case_sensitivity)现在`textValue`应该写在 create 中`li`。

~~`innerHtml`（如果您在控制台中输入 ，它应该会产生错误。）~~

***测试一下：http:*** [//jsfiddle.net/DerekL/svUqG/](http://jsfiddle.net/DerekL/svUqG/)

# xna - 如何在矩形区域上廉价地绘制重复图案？

> ID：14093892
> 
> 赞同：2
> 
> 时间：2012-12-30T19:29:16.147
> 
> 标签：xna, textures, repeat, rectangles

我有小纹理（8×8、16×16、20×20，还有 10×20、24×32、64×16 和其他各种尺寸），我想填充屏幕上的某个矩形区域，重复而不是伸展。

问题是如果我只是通过多次绘制调用一个接一个地绘制足够的精灵，它只会消耗大量的 CPU。难道没有其他不需要这么多draw call的方法吗？

使用重复精灵的预制纹理不是解决方案——目标矩形区域具有不同的大小，并且在每个游戏中随机生成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T19:57:01.943

在您创建随机矩形区域时，您可以创建一个 RenderTarget2D 以及每个矩形。然后你将你的图块绘制到那个 RenderTarget2D 中一次。之后，您可以使用 RenderTarget2D（可以像 Texture2D 一样绘制）在一次 Draw 调用中绘制所有图块。

# css - 在两个 div 之间创建可调整大小的边框

> ID：14093893
> 
> 赞同：1
> 
> 时间：2012-12-30T19:29:18.230
> 
> 标签：css, html, web, webpage

在标题之后，我有一个 div，其中包含另外两个彼此相邻的 div。我想在它们之间创建一个边界。我尝试使用左 div 的右边框或右 div 的左边框，但它们不能正常工作。

右边的div可以有很多内容，所以我必须为它做**overflow:hidden**，这样我就可以滚动页面了。但是如果我只有很少的内容，div 不会垂直填充整个页面，所以左边框会很小。在这里-> [http://www-user.tu-cottbus.de/~carbusor/Red%20Diamond/html/index.html](http://www-user.tu-cottbus.de/~carbusor/Red%20Diamond/html/index.html)你可以看到我在说什么。

当右 div 垂直增加时，我希望边框到底部，以跟随它的大小。

HTML：

```
<div id="wrapper">
        <div id="leftsidebar">
            <form id="logoutForm" action="index.html">
                <h1 id="login_title">Logout</h1>
                <fieldset id="actions">
                    <input id="logout" type="submit" value="Log out" />
                </fieldset>
            </form>
        </div>
        <div id="main">
            <span id="location">Home</span>
            <a href="member_news.html" class="normal_link">News</a>
        </div>
    </div> 
```

CSS：

```
div#wrapper{
  position:absolute;
  top:25%;
  width:100%;
}

div#leftsidebar{
  /*position:absolute;
  top:25%;*/
  width:19.87%;
  height:100%;
  min-width:200px;
  float:left;
}

div#main{
  /*position:absolute;
  top:25%;
  left:20%;*/
  /*width:79.81%;
  float: left;*/
  font-size:1.2em;
  border-left-color:white;
  border-left-style:solid;
  border-left-width:3px;
  overflow:hidden;
  padding-bottom:2%;
} 
```

我怎样才能得到我想要的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:58:44.650

给包装器和主 div 正确的高度，你会得到结果。

```
div#wrapper{
    position:absolute; /*Stayed this whay cause you needed it*/
    top:25%;
    height: 75%; /**Make the wrapper contain all the needed space*/
    width:100%; 
}
div#main{
   height:96%; 
   /**Value actually needs be a bit less then 100 due to padding*/
   .... /**You're code here*/
}​ 
```

你可以在下面的 jsFiddle 上看到结果。 [http://jsfiddle.net/pY6nF/](http://jsfiddle.net/pY6nF/)

# php - 使用 Composer 添加包（通过 SVN）

> ID：14093900
> 
> 赞同：18
> 
> 时间：2012-12-30T19:31:02.973
> 
> 标签：php, svn, composer-php, packagist

我为我的个人 PHP 库创建了一个 SVN 存储库，并在根级别添加了一个 composer.json 文件：

```
{
        "name": "myPersonalLibrary/lib",
        "type": "library",
        "description": "Light MVC framework for PHP 5.4",
        "keywords": ["database","mvc"],
        "homepage": "http://mysite.com",
        "license": "MIT",
        "require": {
                "php": ">=5.3.0",
                "mustache/mustache": "dev-master"
        },
        "autoload": {
                "psr-0": {
                        "bbn": "src"
                }
        }
} 
```

然后我使用以下composer.json创建了一个项目：

```
{
    "require": {
        "monolog/monolog": "1.0.*",
        "zerkalica/php-code-sniffer": "dev-master",
        "mustache/mustache": "dev-master",
        "myPersonalLibrary/lib": "*"
    },
    "repositories": [
            {
                    "type": "svn",
                    "url": "https://mysite.com/svn/myPersonalLibrary",
                    "branches-path": false,
                    "tags-path": false,
                    "trunk-path": "src"
            }
    ]
} 
```

当我尝试更新我的项目时，我得到：`No valid composer.json was found in any branch or tag of https...`

我认为问题出在我的文件结构上，但我找不到任何关于此的文档：

```
/my_repo
  /src
    /lib
      /api
      /db
      /file
      /html
      ....
      /mvc.php
      /obj.php
  /composer.json 
```

我试图在 packagist.org 上发布我的 URL 并得到`No valid/supported repository was found at the given URL`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-07-23T18:41:53.077

如果您将官方推荐的存储库布局与“项目根目录”（其中包含三个子目录：`/trunk`、`/branches`和`/tags`）一起使用，那么这应该适合您：

对于您的 PHP 库`composer.json`，在主干的项目根目录中创建（并提交它）。例如：

```
{
    "name": "myProject/myLibrary",
    "description": "My Personal Library",
    "license": "proprietary",
    "require": {
        "php": ">=5.3"
    },
    "autoload": {
        "classmap": ["src/"]
    }
} 
```

假设您的库存储库位于`http://svn.example.com/path/to/myLibrary`. 那么布局将是：

```
/path/to/myLibrary
  /trunk
    /composer.json
    /src
      ...
  /branches
  /tags 
```

然后在您想要使用您的库的项目中，使用以下内容创建 composer.json：

```
{
    "repositories": [
        {
            "type": "vcs",
            "url": "http://svn.example.com/path/to/myLibrary"
        }
    ],
    "require": {
        "nette/nette": "~2.2",
        "myProject/myLibrary": "@dev"
    }
} 
```

`@dev`如果您只有`composer.json`主干，关键是用作您的图书馆所需的版本。从主干创建标签后，您可以开始使用版本号。例如，如果你`svn copy ^/trunk ^/tags/1.0.0`，那么你可以使用`"myProject/myLibrary": "~1.0"`你的版本号。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T16:52:33.967

尝试调用*composer update -v*获取更多信息，以获取您可以使用的可能版本字符串的列表。

例如，我得到了信息，获取主干的正确名称是这个配置：

```
{
    "name": "sample/test",
    "type": "library",
    "version": "0.0.0",
    "time" : "2013-04-16",
    "description": "Testing ...",
    "repositories": [
        {
            "type": "svn",
            "url": "http://framework.zend.com/svn/framework/standard"
        }
    ],
    "require": {
        "php": ">=5.3.3",
        "zendframework/zendframework1" : "dev-trunk"
    }
} 
```

*使用-v*作为参数调用 composer ，如果找到，您将获得分支、标签和主干的列表。我不知道是否允许*false*作为标签和分支的路径...

```
$ composer update -v
Loading composer repositories with package information
Reading composer.json of zendframework/zendframework1 (release-0.1.1)
Skipped tag 0.1.1, no composer file was found
Reading composer.json of zendframework/zendframework1 (release-0.1.2)
Skipped tag 0.1.2, no composer file was found
Reading composer.json of zendframework/zendframework1 (release-0.1.3)
Skipped tag 0.1.3, no composer file was found
....
Reading composer.json of zendframework/zendframework1 (release-1.9.6)
Importing tag 1.9.6 (1.9.6.0)
Reading composer.json of zendframework/zendframework1 (release-1.9.7)
Importing tag 1.9.7 (1.9.7.0)
Reading composer.json of zendframework/zendframework1 (release-1.9.8)
Importing tag 1.9.8 (1.9.8.0)
Reading composer.json of zendframework/zendframework1 (trunk)
Importing branch trunk (dev-trunk)
Reading composer.json of zendframework/zendframework1 (bughuntday)
Skipped branch bughuntday, no composer file was found
Reading composer.json of zendframework/zendframework1 (development-2.0)
Skipped branch development-2.0, no composer file was found
Reading composer.json of zendframework/zendframework1 (pdo_ibm_ids_support)
Skipped branch pdo_ibm_ids_support, no composer file was found
Reading composer.json of zendframework/zendframework1 (release-1.0)
Importing branch release-1.0 (dev-release-1.0)
Reading composer.json of zendframework/zendframework1 (release-1.10)
Importing branch release-1.10 (dev-release-1.10)
....
Reading composer.json of zendframework/zendframework1 (release-1.8)
Importing branch release-1.8 (dev-release-1.8)
Reading composer.json of zendframework/zendframework1 (release-1.9)
Importing branch release-1.9 (dev-release-1.9)
Reading composer.json of zendframework/zendframework1 (rob_allen)
Skipped branch rob_allen, no composer file was found
Reading composer.json of zendframework/zendframework1 (user)
Skipped branch user, no composer file was found
Updating dependencies (including require-dev) 
```

您可以放心地忽略此行所排除的所有内容，它会告诉您必须设置为请求的版本：

```
Importing branch trunk (dev-trunk) 
```

# asp.net - 在 asp.net 中处理 HTTP 404 错误请求错误

> ID：14093904
> 
> 赞同：1
> 
> 时间：2012-12-30T19:31:44.247
> 
> 标签：asp.net, webmatrix

我目前正在建立一个网站，我想添加`HTTP 404 not found`错误页面。我设计了错误的请求页面，它的链接是这样的，例如：

```
www.mysite.com/badr.cshtml 
```

问题是，我想在每个无效请求上显示此页面的内容，而不重定向到该链接。例如，如果我键入`www.mysite.com/noexistingpage`，则`badr.cshtml`应该加载而不重定向到它的内容。

为了您的信息，我正在使用 Webmatrix2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:42:25.463

您可以通过 web.config 和自定义错误部分执行此操作。

[http://www.localwisdom.com/blog/2010/08/how-to-setup-custom-404s-for-iis-and-asp-net-through-web-config/](http://www.localwisdom.com/blog/2010/08/how-to-setup-custom-404s-for-iis-and-asp-net-through-web-config/)

# asp.net - 获取html中文本框的值

> ID：14093905
> 
> 赞同：1
> 
> 时间：2012-12-30T19:31:52.913
> 
> 标签：asp.net, razor

我正在开发 ASP.Net 购物卡应用程序，其中我有一个产品详细信息页面，其中 an`input type="text"`用于数量，当用户单击“*添加到购物车* ”按钮时，产品将被添加到购物车。

```
<input type="text" id="quantity" value="">

<a href="/Cart.html?Id=@Id&Quantity=?">Add to Cart </a> 
```

当用户*在文本框中输入值时*，应该**更新**购物车链接的**查询字符串**。

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T19:37:30.080

您应该使用 Javascript 来实现这一点。尝试使用

```
document.getElementById['quantity'].value 
```

这应该返回文本字段的值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T20:01:04.433

我认为在服务器端做这个会更容易

```
<asp:TextBox ID="quantityTextBox" runat="server"></asp:TextBox>
<asp:Button ID="addToCartButton" runat="server" Text="Add to cart" /> 
```

然后在后面的代码上可以重定向用户

```
protected void addToCartButton_Click(object sender, EventArgs e)
{
       string id = "your id";
       string url = String.Format("/Cart.html?Id={0}&Quantity={1}", id, quantityTextBox.Text);
       Response.Redirect(url, false);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T01:10:06.223

你可以使用这个 jquery 函数：

```
$(document).ready(function () {

    $("#quantity").change(function (event) {

        var quantity = this.value;
        $("a[href^='/Cart.html?Id']")
        .each(function () {
            var index = this.href.lastIndexOf('=');
            var newUrl = this.href.substring(0, index);

            this.href = newUrl + "=" + quantity;
        });
    });
}); 
```**

# python - N 点之间距离计算的 pyCUDA 基准测试结果令人失望

> ID：14093907
> 
> 赞同：6
> 
> 时间：2012-12-30T19:32:02.850
> 
> 标签：python, cuda, scipy, pycuda

为基准测试目的设置了以下脚本。它使用欧几里得 L2 范数计算 N 点之间的距离。实现了三个不同的例程：

1.  `scipy.spatial.distance.pdist`使用该函数的高级解决方案。
2.  相当低级的 OpenMP 支持的`scipy.weave.inline`解决方案。
3.  pyCUDA 驱动的 GPGPU 解决方案。

以下是使用 GTX660（2GB RAM）在 i5-3470（16GB RAM）上的基准测试结果：

```
 ------------
    Scipy Pdist
    Execution time: 3.01975 s
    Frist five elements: [ 0.74968684  0.71457213  0.833188    0.48084545  0.86407363]
    Last five elements: [ 0.65717077  0.76850474  0.29652017  0.856179    0.56074625]
    ------------
    Weave Inline
    Execution time: 2.48705 s
    Frist five elements: [ 0.74968684  0.71457213  0.83318806  0.48084542  0.86407363]
    Last five elements: [ 0.65717083  0.76850474  0.29652017  0.856179    0.56074625]
    ------------
    pyCUDA
    CUDA clock timing:  0.713028930664
    Execution time: 2.04364 s
    Frist five elements: [ 0.74968684  0.71457213  0.83318806  0.48084542  0.86407363]
    Last five elements: [ 0.65717083  0.76850468  0.29652017  0.856179    0.56074625]
    ------------ 
```

我对 pyCUDA 的性能有点失望。由于我是 CUDA 的新手，因此我可能在这里缺少一些东西。那么问题的症结在哪里呢？我是否达到了全局内存带宽的限制？块和网格大小的选择不当？

```
import numpy,time,math
import pycuda.autoinit
import pycuda.driver as drv
from pycuda.compiler import SourceModule
from scipy.spatial.distance import pdist
from scipy import weave

def weave_solution(x):
    """
    OpenMP powered weave inline.
    """
    N,DIM     = numpy.shape(x)
    L         = ((N-1)**2+(N-1))/2
    solution  = numpy.zeros(L).astype(numpy.float32)
    ncpu      = 4
    weave_omp = {'headers'           : ['<omp.h>'],
                 'extra_compile_args': ['-fopenmp'],
                 'extra_link_args'   : ['-lgomp']}
    code = \
         r'''
         omp_set_num_threads(ncpu);
         #pragma omp parallel
         {            
            int j,d,pos;
            float r=0.0;

            #pragma omp for
               for (int i=0; i<(N-1); i++){
                  for (j=(i+1); j<N; j++){
                     r = 0.0;
                     for (d=0; d<DIM; d++){
                        r += (x[i*DIM+d]-x[j*DIM+d])*(x[i*DIM+d]-x[j*DIM+d]);
                     }
                     pos = (i*N+j)-(i*(i+1)/2)-i-1;
                     solution[pos] = sqrt(r);
                  }
               }

         }
         '''
    weave.inline(code,['x','N','DIM','solution','ncpu'],**weave_omp)
    return numpy.array(solution)

def scipy_solution(x):
    """
    SciPy High-level function
    """
    return pdist(x).astype(numpy.float32)

def cuda_solution(x):
    """
    pyCUDA
    """
    N,DIM     = numpy.shape(x)
    N         = numpy.int32(N)
    DIM       = numpy.int32(DIM)    
    L         = ((N-1)**2+(N-1))/2
    solution  = numpy.zeros(L).astype(numpy.float32)

    start = drv.Event()
    end   = drv.Event()       

    mod = SourceModule("""
    __global__ void distance(float *x,int N,int DIM,float *solution){

    const int i = blockDim.x * blockIdx.x + threadIdx.x;

    int j,d,pos;
    float r=0.0;

    if ( i < (N-1) ){

       for (j=(i+1); j<N; j++){

          r = 0.0;
          for (d=0; d<DIM; d++){
             r += (x[i*DIM+d]-x[j*DIM+d])*(x[i*DIM+d]-x[j*DIM+d]);
          }
          pos = (i*N+j)-(i*(i+1)/2)-i-1;
          solution[pos] = sqrt(r);
       }

    }
    }
    """)

    func = mod.get_function("distance")

    start.record()
    func(drv.In(x),N,DIM,drv.Out(solution),block=(192,1,1),grid=(192,1))
    end.record()
    end.synchronize()
    secs = start.time_till(end)*1e-3

    print "CUDA clock timing: ",secs
    return solution

if __name__ == '__main__':

    # Set up data points
    N   = 25000
    DIM = 3
    x   = numpy.random.rand(N,DIM).astype(numpy.float32)

    print "-"*12
    # Scipy solution
    print "Scipy Pdist"
    stime = time.time()
    spsolution = scipy_solution(x)
    stime = time.time()-stime
    print "Execution time: {0:.5f} s".format(stime)
    print "Frist five elements:", spsolution[:5]
    print "Last five elements:", spsolution[-5:]    
    print "-"*12

    # Weave solution
    print "Weave Inline"
    wtime = time.time()
    wsolution = weave_solution(x)
    wtime = time.time()-wtime
    print "Execution time: {0:.5f} s".format(wtime)
    print "Frist five elements:", wsolution[:5]
    print "Last five elements:", wsolution[-5:]
    print "-"*12

    # pyCUDA solution
    print "pyCUDA"
    ctime = time.time()
    csolution = cuda_solution(x)
    ctime = time.time()-ctime
    print "Execution time: {0:.5f} s".format(ctime)
    print "Frist five elements:", csolution[:5]
    print "Last five elements:", csolution[-5:]    
    print "-"*12 
```

编辑：

我添加了哈希爆炸线

```
#!/usr/bin/env python 
```

在文件的顶部并使其可执行。`weave.inline`使用和注释掉计算后`scipy.spatial.distance.pdist`，NVIDIA Visual Profiler 会提示以下结果：

![NVIDIA 视觉分析器](../Images/782b9b468141c17905d52ea6556df6e3.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T21:01:13.213

现在您有 192 个线程，每个线程更新 N-1 个位置，您可以轻松启动更多块/线程。

你想要做的不是这个循环`for (j=(i+1); j<N; j++){`，而是用 N-1 个线程替换它，只做内部循环。

如果你想更进一步，你可以让`N-1 *` `DIM`每个线程在内部循环中执行语句，将结果存储到共享内存，最后对其进行缩减。请参阅[在 CUDA 中优化并行归约](http://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDgQFjAA&url=http://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDgQFjAA&url=http%253A%252F%252Fdeveloper.download.nvidia.com%252Fcompute%252Fcuda%252F1.1-Beta%252Fx86_website%252Fprojects%252Freduction%252Fdoc%252Freduction.pdf&ei=-LHgUJ_mF-WF4AT66YHYDw&usg=AFQjCNFZmgdihbG17glvRmF-zPHfmUR4Aw&sig2=3kljFNGhVmIrUwlNc9FyNA&bvm=bv.1355534169,d.bGE&ei=-LHgUJ_mF-WF4AT66YHYDw&usg=AFQjCNFZmgdihbG17glvRmF-zPHfmUR4Aw&sig2=3kljFNGhVmIrUwlNc9FyNA&bvm=bv.1355534169,d.bGE)

看这一行：

```
r += (x[i*DIM+d]-x[j*DIM+d])*(x[i*DIM+d]-x[j*DIM+d]); 
```

内存事务和模式不统一和合并。也不知道 nvcc 是否会将您的表达式优化为仅两个内存事务而不是此处显示的四个，因为我不知道 pycuda 是否将 -O3 传递给 nvcc。放入`(x[i*DIM+d]-x[j*DIM+d])`一个寄存器变量以确保并自己平方。

否则，如果可能，您也可以尝试`#pragma unroll`在每个 for 循环之前放置它们以展开它们。

# regex - 正则表达式 - 是什么决定了条件的优先级？

> ID：14093910
> 
> 赞同：3
> 
> 时间：2012-12-30T19:32:16.033
> 
> 标签：regex

我想了解正则表达式如何确定特定条件的优先级。

拿下面的字符串**眼镜**和下面的正则表达式。

## 示例 1

```
(\b\w+?)(?=(?:es)\b) 
```

火柴是在**玻璃**上做的。

## 示例 2

```
(\b\w+?)(?=(?:s)\b) 
```

比赛是在**眼镜上**进行的。

## 示例 3

将两者结合起来：

```
(\b\w+?)(?=(?:es|s)\b) 
```

火柴是在**玻璃**上做的。

我想知道为什么 'es' 优先于 's' 当两者都在字符串的末尾时。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T19:47:51.267

`+?`是一个[**惰性**运算符](http://www.regular-expressions.info/repeat.html#lazy)，这意味着它会在继续之前尝试匹配尽可能少的字符。

通常，运算符会尝试从左到右尽可能多地匹配，如果表达式的其余部分失败，它们会*回溯*到更短的匹配。惰性运算符则相反：尝试匹配尽可能少的字符，如果剩余的表达式不匹配，则扩展当前匹配。

因此，第一部分 ,`(\b\w+?)`将尝试匹配 1 个字符 ( `g`)，并查看后面是 an`es`还是 an`s`以及一个单词边界。由于失败，它会再添加一个字母，依此类推，直到第一部分匹配`glass`。在此阶段，第二部分确实与剩余部分匹配`es`。

如果你用一个非懒惰的、[贪婪的运算符](http://www.regular-expressions.info/repeat.html#greedy)替换它，就像在 中一样`(\b\w+)(?=(?:es|s)\b)`，它会反过来。首先，它分配`glasses`给第一部分 ，`(\b\w+)`但未能匹配附加的`e`or `es`，因此它回溯到`glasse`，它成功地将剩余`s`部分与表达式的第二部分匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T20:06:58.380

这不是优先级问题。正则表达式引擎仅采用它找到的第一个匹配项。您正在使用不情愿的量词，因此在使用第一个字符后，请先`(\b\w+?)`查看`(?=(?:es|s)\b)`它是否可以匹配。那失败了，所以`(\b\w+?)`消耗了另一个角色并再次放手，依此类推。第一个`(?=(?:es|s)\b)`可以匹配的地方是 after `glass`，所以这就是你匹配的。

如果你使用的是正常的、贪婪的量词，情况会有所不同。 `(\b\w+)`最初会消耗整个字符串，但`(?=(?:es|s)\b)`会失败。所以它会后退，退还最后一个`s`. 然后，前瞻将成功匹配`s`，因此您最终将匹配`glasse`。

顺便说一句，您的正则表达式中没有条件。我不确定您到底指的是什么：前瞻`(?=(?:es|s)\b)`--或交替`(?:es|s)`---但条件[完全是另一回事](http://www.regular-expressions.info/conditional.html)。

# bash - awk + printf：用“#######”替换长值

> ID：14093913
> 
> 赞同：0
> 
> 时间：2012-12-30T19:32:38.570
> 
> 标签：bash, awk, printf

我从 mysql 中的查询中获取了一些数据，我需要将其转换为漂亮的表。然后我使用 awk 和 printf 来对齐列、格式化数字等。

```
cat /home/jm/mysql/pruebas/pruebat.txt | awk 'BEGIN { FS = ";" } ; {printf "%-'$A's %-'$B's %'\'''$C'd %'\'''$D'd %'\'''$E'd %'\'''$F'.2f %'\'''$F'.2f %'\'''$F'.2f\n", $1, $2, $3, $4, $5, $6, $7, $8 }' >> /home/jm/mysql/pruebas/prn.tx 
```

我的问题出现在某些字段太长时（例如，年份之间的百分比变化为 -12.345,67%）。在这种情况下，我宁愿只显示######。如果我在查询中使用 case/when/then/end，我可以用字符串 ###### 替换 long 值，但是当 awk+printf 将此字段读取为十进制数时，它会显示 0.00% 而不是所需 ＃＃＃＃＃＃。有没有办法写“如果这个变量太长，只打印######”？谢谢，

杰米

编辑：

我的源文件（忘记标题）：

```
S_V;NO INVENTARIABLES;-41.7000;-67.5200;-25.8200;61.91846523;100.00000000;100.00000000
S_A;ARTICULOS PROMOCIONES;54.4400;631.3200;576.8800;1059.66201323;-1412.30712711;-19.76018501
S_B;PRODUCTOS TECNICOS;975.6000;1951.2000;975.6000;100.00000000;36.01476015;34.61254613
S_S;MATERIAL ELECTRICO;2237.6600;5103.2500;2865.5900;128.06190395;40.21030898;43.42859942 
```

我的输出：

```
fam     nombre                               2011       2012        var        %   %mgn11   %mgn12
--------------------------------------------------------------------------------------------------
S_V     NO INVENTARIABLES                     -41        -67        -25    61.92   100.00   100.00
S_A     ARTICULOS PROMOCIONES                  54        631        576 1,059.66 -1,412.31   -19.76
S_B     PRODUCTOS TECNICOS                    975      1,951        975   100.00    36.01    34.61
S_S     MATERIAL ELECTRICO                  2,237      5,103      2,865   128.06    40.21    43.43 
```

我的愿望（或类似的）：

```
fam     nombre                               2011       2012        var        %   %mgn11   %mgn12
--------------------------------------------------------------------------------------------------
S_V     NO INVENTARIABLES                     -41        -67        -25    61.92   100.00   100.00
S_A     ARTICULOS PROMOCIONES                  54        631        576   ######   ######   -19.76
S_B     PRODUCTOS TECNICOS                    975      1,951        975   100.00    36.01    34.61
S_S     MATERIAL ELECTRICO                  2,237      5,103      2,865   128.06    40.21    43.43 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T08:19:13.680

让我们从用合理的 shell+awk 语法重写你的脚本开始，我能说得最好：

```
awk -F\; -v fmt="%-${A}s %-${B}s %'${C}d %'${D}d %'${E}d %'${F}.2f %'${F}.2f %'${F}.2f\n" '
{ printf fmt, $1, $2, $3, $4, $5, $6, $7, $8 }
' /home/jm/mysql/pruebas/pruebat.txt >> /home/jm/mysql/pruebas/prn.tx 
```

现在，您遇到的问题是，您的格式字符串专门说要打印一个数字，而实际上您想打印一个字符串，所以使用 sprintf 创建您的数字，然后如果您对结果不满意，请将其更改为输出字符串。像这样的东西（未经测试）：

```
awk -F\; -v fmt="%-${A}s %-${B}s %'${C}d %'${D}d %'${E}d %'${F}.2f %'${F}.2f %'${F}.2f\n" '
BEGIN{ split(fmt,fmtA,/ /) }
{
    for (i=1;i<=NF;i++) {
       $i = sprintf(fmtA[i],$i)
       if (gsub(/[^[:space:]]/,"&",$i) > 6) {
           $i = "######"
       }
    }
    print
}
' /home/jm/mysql/pruebas/pruebat.txt >> /home/jm/mysql/pruebas/prn.tx 
```

# redirect - 如何将参数添加到控制器重定向？

> ID：14093917
> 
> 赞同：1
> 
> 时间：2012-12-30T19:33:01.133
> 
> 标签：redirect, parameters, controller, action, zend-framework2

在 Zend Framework 2 中，我想在同一个控制器中将一组参数从一个动作传递到另一个动作，就像我在 ZF1 中以下列方式所做的那样：

```
$this->_helper->redirector->gotoSimple('foo', null, null, $params); 
```

在 fooAction 中：

```
$params = $this->_request->getParams(); 
```

在 ZF2 中，尝试了我在这里看到的各种答案，我想出了以下内容：

```
$this->redirect()->toRoute('home/default', array(
            'controller' => 'client',
            'action' => 'foo',
            'param' => 'bar'),
        array('param' => 'bar')); 
```

（尝试 toRoute() 的 $params 和 $options 参数）

在 fooAction 中：

```
$param = $this->getEvent()->getRouteMatch()->getParams(); 
```

或者

```
$param = $this->params()->fromRoute()); 
```

没有一个对我有用。有没有一种简单的方法来实现我想要的（通过重定向传递参数）或者我应该走使用容器、会话甚至全局变量的路线？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-18T16:24:13.233

最后，我所做的不是使用路由参数，而是使用查询参数，因为我使用的参数与路由无关。这解决了问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T11:57:03.833

您可以使用转发插件：

[http://framework.zend.com/manual/2.0/en/modules/zend.mvc.plugins.html#the-forward-plugin](http://framework.zend.com/manual/2.0/en/modules/zend.mvc.plugins.html#the-forward-plugin)

```
public function someAction()
{
    $returnValue = $this->forward()->dispatch('application/controller/index', array(
        'action' => 'other'
    ));

    return $returnValue;
}

public function otherAction()
{
    return 99;
} 
```

您也可以传递参数

# ruby - 检查超过 2GB 的文件中的重复项

> ID：14093921
> 
> 赞同：0
> 
> 时间：2012-12-30T19:33:23.880
> 
> 标签：ruby, list, parsing, memory, memory-management

我有一大串从各种来源编译而来的单词。来自这么多不相关的来源，我想有一些重复。即使在一些原始文件中，也有重复。我创建了一个脚本来对它们进行排序，但是此时文件变得如此笨拙，以至于我在尝试解析它时内存不足。来源如下。我正在使用 Ruby 1.9.3-p327 运行 Windows 8、64 位。

```
#!/usr/bin/env ruby

words = []
File.foreach( "wordlist.txt" ) do |line|
    words << line
end
words.uniq!()
words = words.sort()

wordFile = File.open( "wordlist.txt", "w" )

words.each do |word|
    wordFile << word + "\n"
    puts "Wrote to file: #{ word }"
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:52:27.143

有许多不同的方法可以删除重复项。您不需要在 ruby​​ 中这样做。如果单词适合记忆，您可以使用一组您看过一次的单词，而无需再次打印。如果集合太大，您总是可以使用`sort`命令在 ruby​​ 之外对文件进行排序（查看 -T 开关以使用临时目录而不是内存），并将输出通过管道传输到`uniq -c`.

# ruby-on-rails - update_attributes 未保存到数据库

> ID：14093922
> 
> 赞同：3
> 
> 时间：2012-12-30T19:33:25.140
> 
> 标签：ruby-on-rails, ruby-on-rails-3, update-attributes

提交表单后，我的调试功能中会显示正确的自定义参数，但是当我进入控制台时会显示默认参数。

**控制器**

```
def update
    current_user.update_attributes(params[:user])
    flash[:success] = "Your settings have been saved!"
    render new_status_update_path
end 
```

**模型**

```
attr_accessible :deficit_pct,
              :target_bf_pct,
              :activity_factor 
```

*笔记：*

*   我能在 SO 上找到的最接近的问题是改变通过关联存在的对象的属性的问题。

*   我尝试使用 Object.update 方法，尽管我收到一条错误消息：

    调用私有方法“更新”#

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T17:08:41.677

试试代码：-

```
def update
    if current_user.update_attributes(params[:user])
        flash[:success] = "Your settings have been saved!"
        render new_status_update_path
    else
        p 111111111111
        p  current_user.errors.inspect
    end
end 
```

在检查您的日志是否有任何错误之后。该活动记录的存在

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-31T00:31:07.297

在控制台中玩过之后，我发现即使我手动更改属性，在我退出控制台后属性也不会“粘住”。

所以我将进入控制台，更改用户属性，测试它们，它们将被更改。如果我存在并重新输入，那么测试它们，它们将恢复为默认值。

这使我相信用户模型中设置其默认值的“after_initialize”方法在每次保存后运行。我虽然它只会在第一次单独保存对象后运行，但现在我知道它每次保存时都会运行。

```
after_initialize :default_values 

def default_values
  self.goal = "Cut"
  self.measurement = "US"
  self.bmr_formula = "katch"
  self.fat_factor = 0.655
  self.protein_factor = 1.25 
  self.deficit_pct = 0.10
  self.target_bf_pct = 0.10
  self.activity_factor = 1.3
end 
```

一旦我删除了所有这些值和 after_initialize 方法，它就会永久保存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T21:10:54.300

就像是：

```
 def update
    if current_user.update_attributes(params[:user])
        flash[:success] = "Your settings have been saved!"
        render new_status_update_path
    else
        some_error_handling_code
    end
end 
```

保存失败时不会显示成功。作为一般规则，您应该在向最终用户报告成功之前检查保存或任何其他后端操作是否失败。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T19:43:56.163

您应该确保没有任何验证错误。您可以使用以下方法检查它们：

```
active_record_model.errors 
```

在你的情况下，这将是

```
current_user.errors 
```

此外，您应该打印返回值 from`update_attributes`以查看它是`true`还是`false`。如果得到`false`，则保存被取消。这很可能是由验证错误或回调返回引起的`false`。

# java - 我在哪里可以找到 Jersey API 罐子？

> ID：14093924
> 
> 赞同：-3
> 
> 时间：2012-12-30T19:33:41.647
> 
> 标签：java, jersey, jsr

我需要下载 JSR 311 Java 库 (Jersey) jar。Java.net 有可供下载的 API，但它莫名其妙地停机，似乎在其他任何地方都找不到。有人可以帮忙吗，因为没有泽西岛，我无法继续我目前的项目。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:42:10.983

[请参阅位于http://repo1.maven.org/maven2/org/jboss/spec/javax/ws/rs/jboss-jaxrs-api_1.1_spec/1.0.1.Final/](http://repo1.maven.org/maven2/org/jboss/spec/javax/ws/rs/jboss-jaxrs-api_1.1_spec/1.0.1.Final/)的 JAR 文件

在任何情况下，使用像 Maven 或 Ivy 这样的依赖管理系统来让事情变得更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T19:50:46.520

正如 Alessandro 在他的回答中指出的那样，您确实应该至少使用[maven](http://maven.apache.org/index.html)进行依赖管理。

话虽如此，即使不使用 maven，您也可以从 apache maven 中央存储库获取最新的 Jersey jar：

[http://search.maven.org/#artifactdetails%7Ccom.sun.jersey%7Cjersey-bundle%7C1.9%7Cjar](http://search.maven.org/#artifactdetails%7Ccom.sun.jersey%7Cjersey-bundle%7C1.9%7Cjar)

# ruby-on-rails - 如何在我的 rake 任务中将一个对象设置为另一个对象的子对象，而无需批量分配？

> ID：14093934
> 
> 赞同：0
> 
> 时间：2012-12-30T19:34:38.637
> 
> 标签：ruby-on-rails, activerecord, relationships

这是我的第一个 Rails 项目，这似乎是一个非常简单的问题，但我似乎找不到任何示例。

我不知道如何创建一个对象并将其设置为另一个已经存在的对象的子对象。在这种情况下，我有一个城市和一个国家，我不知道如何创建一个新城市并将其设置为与某个国家（已经在我的数据库中）相关。

```
Class City < ActiveRecord::Base
   attr_accessible #nothing
   belongs_to :country
end

Class Country < ActiveRecord::Base
   attr_accessible #nothing
   has_many :cities
end 
```

当我在 rake 任务中创建一个新的 Country 对象和一个新的 City 对象时，我应该如何关联这两个对象？

现在我能找到的最接近我想做的事情是：

```
city = City.new
city.name = "Chicago"
country = Country.find(1)
city_final = country.cities.create(city.attributes)
city_final.save 
```

这段代码的两个问题是我不想使用批量分配（我计划让这两个模型的 CRUD 操作仅可用于 rake 任务），而且我不确定它是如何工作的。假设我完全打开了大规模分配，这段代码会创建一个重复的城市对象吗？因为否则我为什么需要传递城市的属性？似乎我正在寻找的是通过直接分配将新城市添加到国家城市属性的某种方式，而无需通过控制器。

我查看了 RoR ActiveRecord 关系文档页面 (http://guides.rubyonrails.org/association_basics.html)，但我无法弄清楚这一点。

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T20:20:24.653

ActiveRecord 为您提供了一些集合的 getter 和 setter 方法，请参阅[http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#label-Auto-generated+methods](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#label-Auto-generated+methods)

所以你可以写

```
country = Country.find(1)
city = City.new
city.name = "Chicago"
city.country = country #Or Country.find(1) directly here
city.save 
```

希望它能如你所愿！

# android - 如何打开安卓项目？

> ID：14093935
> 
> 赞同：-1
> 
> 时间：2012-12-30T19:34:49.640
> 
> 标签：android, eclipse, sdk

我是 android 开发的业余爱好者。我不知道如何在我的电脑上打开任何项目。

[http://img202.imageshack.us/img202/3156/35673611.png](http://img202.imageshack.us/img202/3156/35673611.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T19:37:08.673

在 Eclipse 中， Use `File->Import->Existing Projects in Workspace`，然后输入项目根文件夹的路径

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T19:39:02.213

> 文件 > 新建 > 项目...
> 
> 在向导中，选择 android 项目
> 
> 下一步按钮
> 
> 新的 android 项目向导将打开。将单选按钮更改为“从现有源创建项目”
> 
> 使用浏览按钮查找您的项目。
> 
> 然后从向导底部选择完成按钮。

资料来源：[androidforums.com](http://androidforums.com/application-development/32654-how-open-project-eclipse.html#post229868)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T19:39:28.517

打开 Eclipse（或您使用的任何 IDE）并转到文件>打开

# c# - 如何仅在二维数组的边缘选择点

> ID：14093939
> 
> 赞同：5
> 
> 时间：2012-12-30T19:35:29.983
> 
> 标签：c#, arrays, multidimensional-array, xna

所以我有一个`float[,]`高度图，作为我的河流生成算法的一部分，我想选择两个点，只要它们是数组边缘之一的一部分。这似乎是一项简单的任务，但我似乎想不出一个不涉及太多 if 语句的解决方案。有没有办法从二维数组的边缘进行选择？（即，`x = 0`或`x = max`，或`y = 0`或`y = max`）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:43:01.710

您可以创建一个包含所有边缘索引（如 (0,10)）的数组，并将它们全部放在一个数组中，现在您可以简单地选择其中一个或多个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T20:19:07.540

只是为了新颖，这是一种不涉及存储所有索引或任何 if() 块的方法：

```
 static void randPoint(int width, int height, out int x, out int y, Random r)
    {
        int[] dim = {width,height};
        int[] res = new int[2];

        res[0] = r.Next(0, 2) * (width - 1);
        res[1] = r.Next(0, 2) * (height - 1);
        int hv = r.Next(0, 2);
        res[hv] = r.Next(0,dim[hv]);

        x = res[0];
        y = res[1];
    } 
```

# xml - 如何使用 XSLT 修改 XML 属性？

> ID：14093943
> 
> 赞同：2
> 
> 时间：2012-12-30T19:36:03.087
> 
> 标签：xml, xslt

我想知道 XSLT 中是否有办法修改/添加到属性值。

现在我只是替换属性值：

```
<a class="project" href="#">
  <xsl:if test="new = 'Yes'">
    <xsl:attribute name="class">project new</xsl:attribute>
  </xsl:if>
</a> 
```

但我不喜欢第`project`2 行中的重复。有没有更好的方法来做到这一点，例如简单地*添加* `new`到属性的末尾？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T19:39:53.213

您可以将`if`内部放入`attribute`而不是相反：

```
<a href="#">
  <xsl:attribute name="class">
    <xsl:text>project</xsl:text>
    <xsl:if test="new = 'Yes'">
      <xsl:text> new</xsl:text>
    </xsl:if>
  </xsl:attribute>
</a> 
```

An`<xsl:attribute>`可以包含任何有效的 XSLT 模板（包括`for-each`循环、应用其他模板等），唯一的限制是实例化此模板只能生成*文本节点*，而不是元素、属性等。属性值将是所有这些的串联文本节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T20:11:29.250

**在 XSLT 1.0 中，可以使用这种单线**：

```
<a class="project{substring(' new', 5 - 4*(new = 'Yes'))}"/> 
```

**这是一个完整的转换**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/*">
  <a class="project{substring(' new', 5 - 4*(new = 'Yes'))}"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时：**

```
<t>
 <new>Yes</new>
</t> 
```

**产生了想要的正确结果：**

```
<a class="project new"/> 
```

**说明**：

1.  **[AVT](http://www.w3.org/TR/xslt#attribute-value-templates)**（属性值模板）的使用

2.  要根据条件选择字符串，在 XPath 1.0 中，可以使用 substring 函数并指定一个表达式作为起始索引参数，当条件为时该表达式的值为 1`true()`并且某个数字大于字符串的长度 - - 否则。

3.  我们使用的事实是，在 XPath 1.0 中`*`（乘法）运算符的任何参数都转换为数字，`number(true()) = 1`并且`number(false()) = 0`

* * *

**二、XSLT 2.0 解决方案**：

**使用这个单线**：

```
 <a class="project{(' new', '')[current()/new = 'Yes']}"/> 
```

**这是一个完整的转换**：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/*">
  <a class="project{(' new', '')[current()/new = 'Yes']}"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当应用于同一个 XML 文档（上图）时，同样会产生相同的正确结果：**

```
<a class="project new"/> 
```

**说明**：

1.  正确使用**[AVT](http://www.w3.org/TR/xslt#attribute-value-templates)**。

2.  正确使用**[序列](http://www.w3.org/TR/xpath-datamodel/#sequences)**。

3.  正确使用 XSLT 的**[`current()`](http://www.w3.org/TR/xslt#function-current)**功能。

# c++ - C++ 中的 malloc 和 new 之间是否存在性能差异

> ID：14093945
> 
> 赞同：3
> 
> 时间：2012-12-30T19:36:09.530
> 
> 标签：c++, malloc, new-operator

我看过几篇关于 malloc 和 new 之间差异[的帖子，我确实理解这一点。](https://stackoverflow.com/questions/807939/what-is-the-difference-between-new-and-malloc-and-calloc-in-c)

但是，这些帖子都没有谈论性能，所以我想知道这两者之间是否存在任何性能差异，或者编译器是否本质上做同样的事情。

为了便于比较，假设我们在这里讨论的是原始类型（谢谢 Hans Passant）。

先感谢您。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T19:45:20.943

您可能想要比较`malloc()`and`free()`和`operator new()`and `operator delete()`（以及它们的数组形式）：这是独立于对象构造分配内存的方式。性能可能非常相似，并且很可能两种方法最终都使用相同的内存池：C++ 运算符可能是一个瘦包装器`malloc()`和`free()`（但不是相反：用户可以安全地实现`operator new()`和`operator delete()`和`malloc()`) `free()`。

要确定实际性能，您显然需要以合理的方式分析这两种方法。如果没有这样做，我不会期望大多数系统会有太大的不同。当然，结果将特定于不同的系统。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T19:38:39.220

唯一可以确定的方法是对编译器上的各种选项进行计时。不会有适用于所有编译器的硬性规定。

如果您正在谈论分配`int`or的数组`double`，那么对于任何体面的实现，您应该无法检测到性能差异。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-30T19:39:29.640

答案将取决于特定的编译器，但我怀疑 new 的大多数实现只是在幕后调用 malloc。malloc 通常会稍微快一些，因为它不调用任何额外的代码（不像 new，它调用对象的构造函数）。

# google-app-engine - 持久化对象覆盖最后一条记录，而不是使用 Spring MVC、Google App Engine、JDO3 创建新记录

> ID：14093948
> 
> 赞同：0
> 
> 时间：2012-12-30T19:36:29.623
> 
> 标签：google-app-engine, spring-mvc, jdo

我正在使用带有 Google App Engine 的 Spring MVC 3.1.2。我在使用 JDO3 将对象持久保存在数据存储中时遇到问题。奇怪的问题是，每当我持久化对象时（在短时间内），最后添加的对象不会保留在新记录中，它只会覆盖保持相同 id 的最后一条记录（最后一条记录的 id）。以下是可能涉及的文件。

用户.java

```
@Component
@PersistenceCapable
public class User {

    @PrimaryKey
    @Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
    private Long id;

    @Persistent
    private String firstName;
    @Persistent
    private String lastName;
    @Persistent
    private String email;
    @Persistent
    private String password;

    public Long getId() {
        return id;
    }
    public String getFirstName() {
        return firstName;
    }
    public String getLastName() {
        return lastName;
    }
    public String getEmail() {
        return email;
    }
    public String getPassword() {
        return password;
    }
    public void setId(Long id) {
        this.id = id;
    }
    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }
    public void setLastName(String lastName) {
        this.lastName = lastName;
    }
    public void setEmail(String email) {
        this.email = email;
    }
    public void setPassword(String password) {
        this.password = password;
    }   

} 
```

UserDaoImpl.java

```
@Repository
public class UserDaoImpl implements UserDao {

    private static PersistenceManager pm;

    @Override
    public void add(User user) {

        if (pm == null || pm.isClosed()) {
            pm = PMF.get().getPersistenceManager();
        }

        try {

        pm.makePersistent(user);    
        } finally {

        pm.close();

        }
    }

} 
```

PMF.java

```
public final class PMF {
    private static final PersistenceManagerFactory pmfInstance =
        JDOHelper.getPersistenceManagerFactory("transactions-optional");

    private PMF() {}

    public static PersistenceManagerFactory get() {
        return pmfInstance;
    }
} 
```

用户控制器.java

```
@Controller
public class UserController {

    @Autowired
    UserService userService;

    @Autowired
    User user;

    @RequestMapping(value="/adduser", method=RequestMethod.GET)
    String adduser(){

        return "adduser";

    }

    @RequestMapping(value="/adduser.do", method=RequestMethod.POST)
    String saveUserr(@RequestParam String firstname,@RequestParam String lastname,   @RequestParam String email, @RequestParam String password){

        this.user.setFirstName(firstname);
        this.user.setLastName(lastname);
        this.user.setEmail(email);
        this.user.setPassword(password);
        userService.add(user);//this invokes the UseDaoImpl add(user)

    }
} 
```

jdoconfig.xml

```
<?xml version="1.0" encoding="utf-8"?>
<jdoconfig xmlns="http://java.sun.com/xml/ns/jdo/jdoconfig_3_0.xsd"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/jdo/jdoconfig http://java.sun.com/xml/ns/jdo/jdoconfig_3_0.xsd">

   <persistence-manager-factory name="transactions-optional">
       <property name="javax.jdo.PersistenceManagerFactoryClass"
           value="org.datanucleus.api.jdo.JDOPersistenceManagerFactory"/>
       <property name="javax.jdo.option.ConnectionURL" value="appengine"/>
       <property name="javax.jdo.option.NontransactionalRead" value="true"/>
       <property name="javax.jdo.option.NontransactionalWrite" value="true"/>
       <property name="javax.jdo.option.RetainValues" value="true"/>
       <property name="datanucleus.appengine.autoCreateDatastoreTxns" value="true"/>
       <property name="datanucleus.appengine.singletonPMFForName" value="true"/>
   </persistence-manager-factory>
</jdoconfig> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T09:34:35.497

What I feel is you are not initializing the User Object, instead of Autowired annotation try the following code.

```
@RequestMapping(value="/adduser.do", method=RequestMethod.POST)
String saveUser(@RequestParam String firstname,@RequestParam String lastname,   @RequestParam String email, @RequestParam String password){
    User user = new User();
    user.setFirstName(firstname);
    user.setLastName(lastname);
    user.setEmail(email);
    user.setPassword(password);
    userService.add(user);//this invokes the UseDaoImpl add(user)
} 
```

# jquery - 如何使用 $.mobile.loading(); 用谷歌地图

> ID：14093949
> 
> 赞同：1
> 
> 时间：2012-12-30T19:36:38.817
> 
> 标签：jquery, load, message

我正在使用 jquerymobile 和电话差距构建一个 Web 应用程序。在低连接的情况下，但即使有任何类型的连接速度，我也希望收到一条加载消息。这特别是在慢速连接（边缘）和谷歌地图加载或刷新时。我注意到 googlemap 图片需要一点时间才能显示出来。

我看到有一个jquery方法

```
$.mobile.loading('show');$.mobile.loading('hide'); 
```

我尝试了以下方法在所有页面上都有它

```
$(document).live('pagebeforeload', function(){
    $.mobile.loading('show');
})

$(document).live('pageload', function(){
    $.mobile.loading('hide');
}) 
```

但我没有看到任何差异和加载消息。

你有什么建议吗？

感谢

# javascript - jquery填充数据问题

> ID：14093951
> 
> 赞同：0
> 
> 时间：2012-12-30T19:36:45.520
> 
> 标签：javascript, ajax, jquery-ui, jquery

伙计们我在从 ajax 获取数据的 jquery 中遇到一些问题 .. php 文件响应正确并在 jquery 文件警报框中以 json 格式发送数据也确认我从 php 文件中正确获取数据但是当我必须在 html 文件中显示数据时他们没有' t显示..伙计们指导我在脚本中犯了什么错误..

html:

```
<tr>                    
    <td colspan="6">
        <table border="1" width="100%" align="center" class="info">
        </table>
    </td>
</tr> 
```

jQuery：

```
$.ajax({
    type: "POST",
    url: "billingprocess.php",
    data: dataString,
    success: function (msg) {
        alert(msg);
        for (var x = 0; x < msg.length; x++) {
            var div = $("<tr>").appendTo(".info");
            $("<td>").addClass("cols").text(msg[x].B_account).appendTo(div);
            $("<td>").addClass("cols").text(msg[x].B_consumer).appendTo(div);
            $("<td>").addClass("cols").text(msg[x].month).appendTo(div);
            $("<td>").addClass("cols").text(msg[x].net_amount).appendTo(div);
            $("<td>").addClass("cols").text(msg[x].due_date).appendTo(div);
            $("<td>").addClass("cols").text(msg[x].gross_amount).appendTo(div);
        }
    }
}); 
```

php代码：

```
if ($rc > 0) {
    $i = 0;
    while ($i < $rc) {
        $r = mysql_fetch_assoc($squery);
        $temp[$i] = array("B_account" = > $r['B_account'],
                          "B_consumer" = > $r['B_consumer'],
                          "month" = > $r['month']."-".$r['year'],
                          "net_amount" = > $r['net_amount'],
                          "due_date" = > $r['due_date']."-".$r['month']."-".$r['year'],
                          "gross_amount" = > $r['gross_amount']);
        $i++;
    }
    echo json_encode($temp);
} 
```

JSON格式返回数据：

```
[
    {
        "B_account": "1014052480080",
        "B_consumer": "LA712722",
        "month": "Nov-11",
        "net_amount": "2107",
        "due_date": "30-Nov-11",
        "gross_amount": "2282"
    },
    {
        "B_account": "1014052480080",
        "B_consumer": "LA712722",
        "month": "Dec-11",
        "net_amount": "1217",
        "due_date": "30-Dec-11",
        "gross_amount": "1316"
    },
    {
        "B_account": "1014052480080",
        "B_consumer": "LA712722",
        "month": "Jan-12",
        "net_amount": "737",
        "due_date": "31-Jan-12",
        "gross_amount": "795"
    }
] 
```

这是我认为脚本中的错误的整个代码，但有人解决了这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:51:10.663

在您的`success`回调中，您有

```
success: function(msg) { // msg is json string here
    for (var x = 0; x < msg.length; x++) {...}
} 
```

但是在迭代之前，您应该将返回的数据转换为 an，`object`因为您只有`json`字符串并且没有`dataType`定义，因此可以使用`$.parseJSON`

```
var obj = $.parseJSON(msg); 
```

然后替换以下

```
for (var x = 0; x < msg.length; x++) {...} 
```

和

```
$.each(obj, function(k, v){
    // here k is key and v is the value, for example try following
    console.log(obj[k]);
    console.log(k);
    console.log(v);
}); 
```

# c++ - 用于跟踪 CreateFile 调用的 Pin 工具

> ID：14093952
> 
> 赞同：4
> 
> 时间：2012-12-30T19:37:00.533
> 
> 标签：c++, winapi, intel-pin

我制作了一个 pin 工具来转储 CreatFile win32 调用（在我的情况下为 CreateFileW）及其返回值。它看起来像这样：

```
/* ... */

VOID Image(IMG img, VOID *v)
{
    RTN cfwRtn = RTN_FindByName(img, "CreateFileW");
    if (RTN_Valid(cfwRtn))
    {
        RTN_Open(cfwRtn);

        RTN_InsertCall(cfwRtn, IPOINT_BEFORE, (AFUNPTR)CreateFileWArg,
        IARG_ADDRINT, "CreateFileW",
        IARG_FUNCARG_ENTRYPOINT_VALUE, 0,
        IARG_END);
        RTN_InsertCall(cfwRtn, IPOINT_AFTER, (AFUNPTR)CreateFileWafter,
        IARG_FUNCRET_EXITPOINT_VALUE, IARG_END);

        RTN_Close(cfwRtn);
    }
}

/* ... */

VOID CreateFileWArg(CHAR * name, wchar_t * filename)
{
    TraceFile << name << "(" << filename << ")" << endl;
}

VOID CreateFileWafter(ADDRINT ret)
{
    TraceFile << "\tReturned handle: " << ret << endl;
} 
```

它给出了有趣的结果。例如，在一个只打开一个现有文件并且什么都不做的小程序上，它给出：

```
CreateFileW(file.txt)
    Returned handle: 0
CreateFileW(file.txt)
    Returned handle: 0x74
    Returned handle: 0x74 
```

异常多。1.) 为什么有两个实际调用？2.）如果我没记错的话，CreateFile 永远不应该返回 0。 3.）第二次调用后，它返回两次（？）

我还尝试检测一个简单的 C++ 程序，它**直接**调用 CreateFileW***一次***，结果：

```
CreateFileW(file.txt)
    Returned handle: 0
CreateFileW(file.txt)
    Returned handle: 0xffffffff
    Returned handle: 0xffffffff 
```

我试图打开的文件不存在，所以返回值（-1 == INVALID_HANDLE_VALUE）至少是正确的。

有任何想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:33:14.840

好的，经过一段时间后，我终于弄清楚了这些问题的原因。

## 关于返回值似乎为 0：

好吧，PIN 文档说：

> 注意：IPOINT_AFTER 是通过在例程中检测每个返回指令来实现的。Pin 尝试查找所有返回指令，但不保证成功

如果你在返回时转储函数的地址，结果是CreateFileW*没有*返回 0。它是从 CreateFileW 调用的另一个函数返回的。PIN 的这种错误行为可以通过在您自己的版本中包装 CreateFileW 方法来修复（转储参数、调用原始函数、转储返回值）。

## 关于两个函数调用，而不仅仅是一个：

事实证明，在我的系统上，CreateFileW 调用了 Kernelbase.dll 的函数，该函数具有完全相同的名称。由于我按其名称检测例程，因此这是正确的行为。根据 kernel32.dll 检查图像名称解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-14T21:55:30.347

我会建议在系统调用级别捕获它，而不是在其中一个不确定的中间级别（无论它托管在哪个库中）。在windows上，系统调用号和接口都不是官方公开的，但无论如何都可以很容易地找到它们。

# php - mysql 错误您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册以获取正确的

> ID：14093958
> 
> 赞同：-1
> 
> 时间：2012-12-30T19:37:46.333
> 
> 标签：php, mysql, sql-update

执行查询时总是出现此错误：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'read =1 WHERE user_id_sender = 1 AND user_id_receiver = 33 AND OR user_id_sender' 附近使用正确的语法

这是我的查询：

```
mysql_query("UPDATE messages SET read =1 WHERE user_id_sender = $user_id AND user_id_receiver = $user_id_partner AND read = 0 OR user_id_sender = $user_id_partner AND user_id_receiver = $user_id  AND read = 0  ") or die (mysql_error()); 
```

有`table(messages)`这些列：

```
message_id(INT)(AI)
user_id_sender(INT)
user_id_receiver(INT)
message(TEXT)
read(INT) 
```

我真的不知道为什么会这样，我查看了网络，但我似乎无法为我的确切问题找到答案。也许有人可以帮助我。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-30T19:40:02.380

`READ`是一个[保留字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)。

始终将数据库、表和列名包含在反引号中以防止此类冲突：

```
UPDATE `messages` SET `read`=1 WHERE `user_id_sender`=$user_id AND... 
```

# objective-c - 如何正确加载和同步 Game Center 中的成就？

> ID：14093962
> 
> 赞同：1
> 
> 时间：2012-12-30T19:38:36.740
> 
> 标签：objective-c, sync, game-center, achievements

我现在正在与 Game Center 合作。我在 ITC 上创建了成就并登录了 Game Center。游戏通知我。没关系。但我必须从游戏中心加载所有成就并检查其进度。我阅读了 Apple Reference，这是类方法`loadAchivementsWithCompletionHandler:`。

我有类似的东西，但是当我调用它时，我没有任何结果-控制台中没有 NSLog。

```
[GKAchievement loadAchievementsWithCompletionHandler:^(NSArray *achievements, NSError *error) {

    if (error){
        NSLog(@"Error in syncing achievements: %@", error);
    }
    else {
        NSLog(@"Number of achievements: %d", [achievements count]);
    }
}]; 
```

如何正确从 Game Center 获得成就？我认为该`achivements`数组应该大于 0，但我不知道 - 不会调用任何 NSLog。

更新！！！

```
- (void)authenticateLocalUser:(void(^)(UIViewController *))delegate {

if (!_gameCenterAvailable) return;
NSLog(@"Authenticating local user...");
if (![GKLocalPlayer localPlayer].authenticated) {

    [[GKLocalPlayer localPlayer] setAuthenticateHandler:^(UIViewController *viewController, NSError *error) {

        if (viewController) {

            delegate((UIViewController *)viewController);
        }
        else {
            [NSThread sleepForTimeInterval:2];
            [sharedHelper syncAchivements:^(NSString *delegate) {

            }];
        }

        if (error) {
            NSLog(@"Error in AuthenticateLocalUser: %@", [error description]);
        }
    }];
} else {
    NSLog(@"Already authenticated!");
} 
```

}

我在身份验证后调用了我的上述`syncAchievement:`方法并且我得到了响应：`Number of achievements: 0`但是我的应用程序创建了 2 个成就。哪里有问题？

更新2！！！

我看到 loadAchievementWithCompletionHandler 方法只加载有一些进展的成就。这个我明白了。。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T21:02:43.560

我看到该方法`loadAchievementWithCompletionHandler:`仅加载取得了一些进展的成就。我明白这一点..这是一个答案。一切都是正确的。

# java - 如何从 Java 对象中获取元素

> ID：14093968
> 
> 赞同：0
> 
> 时间：2012-12-30T19:39:25.823
> 
> 标签：java

我有这个用于生成数据中心 ID 和数据中心名称的 Java 对象。

```
private List<listDatacentersObj> listDatacenters;

public void initListDatacenters() throws SQLException {
    // Generate List of Datacenters
    listDatacenters = new ArrayList<>();

    if (ds == null) {
        throw new SQLException("Can't get data source");
    }
    /* Initialize a connection to Oracle */
    Connection conn = ds.getConnection();

    if (conn == null) {
        throw new SQLException("Can't get database connection");
    }
    /* With SQL statement get all settings and values */
    PreparedStatement ps = conn.prepareStatement("select y.componentstatsid, y.name "
            + "FROM component x, componentstats y where x.componentstatsid = y.componentstatsid and y.componenttypeid = 1000");

    try {
        //get data from database
        ResultSet result = ps.executeQuery();
        while (result.next()) {
            /* Put the the data from Oracle into Hash Map */
            listDatacenters.add(new listDatacentersObj(result.getInt("COMPONENTSTATSID"), result.getString("NAME")));

        }
    } finally {
        ps.close();
        conn.close();
    }
}

public class listDatacentersObj {

    private int datacenterid;
    private String datacentername;

    public listDatacentersObj(int datacenterid, String datacentername){

        this.datacenterid = datacenterid;
        this.datacentername = datacentername;

    }

    public int getDatacenterid() {
        return datacenterid;
    }

    public void setDatacenterid(int datacenterid) {
        this.datacenterid = datacenterid;
    }

    public String getDatacentername() {
        return datacentername;
    }

    public void setDatacentername(String datacentername) {
        this.datacentername = datacentername;
    }
            @Override
    public String toString()
    {
        return datacentername;
    }

}

// Get the list with Datacenters
public List<listDatacentersObj> getlistDatacenters() throws SQLException {
    // Get the list of Datacenters from Oracle

    return listDatacenters;
} 
```

问题是如何使用数据中心密钥获取数据中心名称。与 hashmap 类似，我想根据键获取值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:46:23.817

好吧，如果您的键是`componentstatsid`，那么只需将检索`listDatacentersObj`到的对象存储在 a`HashMap`中，如下所示：

```
// private List<listDatacentersObj> listDatacenters; use the below map instead of this list
private Map<Integer, listDatacentersObj> listDatacenters =
                      new HashMap<Integer, listDatacentersObj>();

...

public void initListDatacenters() throws SQLException {

    ...

    try {
            //get data from database
            ResultSet result = ps.executeQuery();
            while (result.next()) {
                /* Put the the data from Oracle into Hash Map */
                final int id = result.getInt("COMPONENTSTATSID");
                listDatacenters.put(id, new listDatacentersObj(id, result.getString("NAME")));

            }
        } finally {
            ps.close();
            conn.close();
        }
    }
} 
```

# android - Android：更改 png 文件颜色的最简单方法

> ID：14093970
> 
> 赞同：7
> 
> 时间：2012-12-30T19:39:27.243
> 
> 标签：android, graphics, colors, png, drawable

我正在编写一个具有基本精灵（气球）的游戏 - 目前我创建了 2 个不同颜色的气球 PNG 文件，我需要创建更多（可能另外 5 个左右）并且不想拥有7个不同的png文件。（这将是 20 个额外的文件，因为我有 4 种不同的大小用于缩放目的）我宁愿坚持 1 - 我目前拥有的文件是黄色和红色的（几乎是实心的，但不完全是 - 它们有详细信息）。

问题 - 有没有一种简单的方法可以改变我现有 PNG 文件的颜色？我见过人们提到`setColor`，`setColorFilter`但我不知道如何使用这些。这些甚至可以在已经有颜色的PNG文件上工作，还是只能在白色PNG文件上工作（我认为我的PNG实际上不能只是白色）？

谢谢大家任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-30T20:26:19.193

您可以只使用黑色气球 png 文件来创建不同颜色的气球。

下面的代码使用一些花哨的混合模式技巧来设置颜色。

```
protected BitmapDrawable setIconColor(int color) {
    if (color == 0) {
        color = 0xffffffff;
    }

    final Resources res = getResources();
    Drawable maskDrawable = res.getDrawable(R.drawable.actionbar_icon_mask);
    if (!(maskDrawable instanceof BitmapDrawable)) {
        return;
    }

    Bitmap maskBitmap = ((BitmapDrawable) maskDrawable).getBitmap();
    final int width = maskBitmap.getWidth();
    final int height = maskBitmap.getHeight();

    Bitmap outBitmap = Bitmap.createBitmap(width, height, Bitmap.Config.ARGB_8888);
    Canvas canvas = new Canvas(outBitmap);
    canvas.drawBitmap(maskBitmap, 0, 0, null);

    Paint maskedPaint = new Paint();
    maskedPaint.setColor(color);
    maskedPaint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.SRC_ATOP));

    canvas.drawRect(0, 0, width, height, maskedPaint);

    BitmapDrawable outDrawable = new BitmapDrawable(res, outBitmap);
    return outDrawable;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T19:52:07.707

您可以尝试使用随机 rgb 值定义自定义 ColorMatrix：

```
Random rand = new Random();
int r = rand.nextInt(256);
int g = rand.nextInt(256);
int b = rand.nextInt(256);

ColorMatrix cm = new ColorMatrix();
cm.set(new float[] {
                   1, 0, 0, 0, r,
                   0, 1, 0, 0, g,
                   0, 0, 1, 0, b,
                   0, 0, 0, 1, 0 }); // last line is antialias
paint.setColorFilter(new ColorMatrixColorFilter(cm));
canvas.drawBitmap(myBitmap, toX, toY, paint); 
```

我希望它有所帮助。

# objective-c - 带有自定义阴影的自定义 NSWindow

> ID：14093975
> 
> 赞同：3
> 
> 时间：2012-12-30T19:39:41.907
> 
> 标签：objective-c, macos, cocoa, nswindow, nsshadow

我有一个 NSWindow 子类，看起来像这样

![在此处输入图像描述](../Images/b100d4433bd10f55da4eccea243905f3.png)

困扰我的是我想改变阴影。在标准窗口上，比如这里的 Xcode，对比度有点弱。

所以我想`NSShadow`对它应用更强的。

我在这里找到了这个：

[带有自定义阴影的 NSWindow](https://stackoverflow.com/questions/4861784/nswindow-with-custom-shadow)

显然，您不应该这样做，因为 UI 应该主要由操作系统处理。但是窗口已经是完全定制的，所以我想它会没问题的。

我怎样才能做到这一点？

* * *

## 编辑

我忘了提，我知道我可以重绘`NSWindow`，但我尽量避免这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T07:35:33.430

据我所知，如果不深入研究私有 API，就无法做到这一点。

如果你非常想改变阴影，唯一的方法是在你的窗口中设置根视图有一个层，在那个层上设置一个阴影，并插入内容为阴影腾出空间。但这也带来了一大堆问题，包括窗口捕获本应用于底层窗口的点击，以及调整手柄大小被关闭。

# ruby-on-rails - 如何根据情况切换js文件调用？

> ID：14093976
> 
> 赞同：1
> 
> 时间：2012-12-30T19:39:51.050
> 
> 标签：ruby-on-rails, ruby-on-rails-3, jquery

我有 3 个变量，我想调用位于不同视图中的不同 js 文件。

*   如果@community => 我想调用 /views/communities/refresh.js.erb
*   如果@community_topic => 我想调用 /views/community_topics/refresh.js.erb
*   如果@user => 我想调用 /views/users/refresh.js.erb

我怎样才能把它编码成这个？

```
 respond_to do |format|
        format.html { redirect_to @community, :notice => "comment added!"  }
        format.js { }
    end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T19:55:29.467

假设您只想渲染视图。

```
respond_to do |format|
  format.html { redirect_to @community, :notice => "comment added!"  }
  format.js do
    if @community.present?
      render 'communities/refresh' 
    elsif @community_topic.present?
      render 'community_topics/refresh'
    elsif @user.present?
      render 'users/refresh'
    end
  end
end 
```

但总而言之，我认为您的控制器违反了一些基本的 REST 规则，不是吗？因此，我认为您首先应该重新考虑控制器的结构，以便**您拥有三个方法，每个方法负责其中一个对象**（`@community`，`@community_topic`或`@user`）。

# android - 如何编辑错误不应该发生：找不到基于矩形的测试节点

> ID：14093978
> 
> 赞同：3
> 
> 时间：2012-12-30T19:39:58.580
> 
> 标签：android, jquery-mobile, android-4.2-jelly-bean

您好我收到以下错误（html5，jquery 应用程序）

```
Should not happen: no rect-based-test nodes found 
```

在下面的代码执行之后

```
$('#submit').unbind('click').click(function(){ code } 
```

单击上述按钮后，每次触摸都会发生错误...

我无法找出引发此错误的原因。

我怎样才能解决这个问题？

我遵循这个[Android WebView JellyBean - >不应该发生：没有找到基于矩形的测试节点](https://stackoverflow.com/questions/12090899/android-webview-jellybean-should-not-happen-no-rect-based-test-nodes-found)，但我不明白该怎么做......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T10:28:47.887

通过在首选项下的 config.xml 文件中添加以下首选项来禁止在您的应用中过度滚动

首选项名称="disallowOverscroll" 值="true"

# c++ - 显示列表、OpenGL、C++ 中的“R6025 - 纯虚拟调用”

> ID：14093984
> 
> 赞同：3
> 
> 时间：2012-12-30T19:41:09.090
> 
> 标签：c++, opengl, virtual

我正在`Display list`为我拥有的所有 GUI 对象创建一个，如下所示：

```
glNewList(displayList, GL_COMPILE);
    obj->draw();
glEndList(); 
```

但是当我尝试编译它时，我得到一个错误：

```
R6025 - pure virtual call 
```

该`draw()`方法是纯虚拟的。但我想知道，为什么我不能把虚函数放在里面`Display list`？

编辑：

这是 GUIObject 类：

```
class GUIObject
{
protected:
    int m_id;
    int m_parentId;
    int m_width;
    int m_height;

    Point m_position;
    Point m_drawPosition;

    bool m_bEnabled;
    bool m_bVisible;

    GLuint m_displayListId;                     // Id in display lists array in TGUIManager

    virtual void onDrawStart() = 0;         
    virtual void onDrawFinish() = 0;        
public:
    virtual bool draw() = 0;

    void setDisplayListId(GLuint id);
    GLuint getDisplayListId();

    virtual int getWidth() const;
    virtual int getHeight() const;
    virtual bool pointInObject(const TPoint& point);

    GUIObject();

    virtual ~GUIObject();
};

GUIObject::GUIObject() : 
    m_position(Point(0,0)),
    m_width(0),
    m_height(0),
{
    m_drawPosition = m_position;
    GUIManager::Instance().addObject(this);
}

GUIObject::~GUIObject()
{
} 
```

这里是`Button`类，它派生自`Component`which 派生自`GUIObject`：

```
class Button : public Component, public Clickable
{
private:
    std::string m_text;
    TBackground* m_pBackground;
public:
    void setText(std::string text);
    void setBackground(Background* pBg);
    Background* getBackground() const;
    void setBackgroundOnClick(Background* pBg);
    Background* getBackgroundOnClick() const;

    bool draw();

    int getFontSize() const;
    std::string getText() const;
    Button& operator=(const Button & button);

    // From Clickable
    bool wasClicked(const Point& clickPos);

    Button();
    ~Button();
};

bool Button::draw()
{
    onDrawStart();      // This needs to be called in each object

    if(!isClicked() && m_pBackground != nullptr)
    m_pBackground->draw(m_drawPosition, m_width, m_height);

    else if(m_pBackgroundOnClick != nullptr)
    m_pBackgroundOnClick->draw(m_drawPosition, m_width, m_height);

    FontManager::Instance().renderLineOfText(font, lineLength, pos, textToRender);

    onDrawFinish();     // This needs to be called in each object
    return true;
}

Button::Button() :
    TComponent(Point(0,0)),
    m_pBackground(nullptr),
    m_pBackgroundOnClick(nullptr),
    m_text("")
{
}

Button::~Button()
{
    if(m_pBackground != nullptr)
    {
        delete m_pBackground;
        m_pBackground = nullptr;
    }
}

Button& Button::operator=(const Button & button)
{
    m_position = Point(button.getPos());
    m_pBackground = new Background()

    return *this;
} 
```

好的，我想我包含了所有必需的代码部分。

绘图内容是 inside`Background`的`draw()`方法。

调用的对象是在构造函数内部的方法`obj`中作为参数传递的对象：`addObject()``GUIObject`

```
GUIManager::Instance().addObject(this); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T22:53:04.217

好的，所以这似乎是我犯的一个非常愚蠢的错误。正如我在对我的问题所做的编辑中解释的那样，`obj`object 是作为方法中的参数传递的，该方法`addObject()`在 ' 的构造函数中被调用，`GUIObject`这意味着`Button`' 的对象本身尚未创建。编译器没有抱怨，因为`GUIObject`类已经声明了`draw()`方法，但只有在运行时才发现该方法缺少定义。

但无论如何，谢谢大家告诉我，在显示列表中调用纯虚方法完全没问题。这帮助我找到了解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T20:29:41.160

到目前为止，我看到的唯一可能性是 if`Component`没有定义`virtual void onDrawStart() = 0`or `virtual void onDrawFinish() = 0`。但是，当您实例化`Button`.

你没有`m_pBackgroundOnClick`在任何地方声明。它应该是 的成员`Button`吗？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-30T20:51:14.697

> 但是我想知道，为什么我不能将虚函数放在显示列表中？

该问题与 OpenGL 显示列表无关。Heck OpenGL 显示列表是在运行时编译的，甚至不与编译单元级别的函数交互。

我的印象是，您可能认为 OpenGL 显示列表会“记录”其中的***所有***内容。不是这种情况。OpenGL 显示列表仅记录 OpenGL API 调用的子集。

* * *

发生的情况是，这`obj`是从基类派生的类的实例，其中`draw`已声明为纯虚拟。例如

```
class A {
    virtual void draw() = 0; // draw is a pure virtual function
}; 
```

和一个派生类

```
class B : public A {
    // does not implement draw()
}; 
```

现在，如果您的程序中有一些指向 A 的指针，即

```
A *pA; 
```

那么编译器当然会允许调用`draw`这个指针

```
pA->draw(); 
```

在有效的假设下，pA 实际上可能指向 B

```
B b;

A *pA = &b; 
```

但是b没有实现draw，所以调用到了nirvana。

# xpath - 查找其文本值与另一个节点匹配的节点

> ID：14093988
> 
> 赞同：1
> 
> 时间：2012-12-30T19:41:35.150
> 
> 标签：xpath

如何找到包含另一个节点名称的节点？

例如，如果`<a>`存在并`<b>`包含文本“a”，那么我希望选择`<b>`但如果给定的名称不存在则不选择。

```
<root>
    <a /> <!-- Do not care what is in this for now -->
    <b>a</b> <!-- Find this node only -->
    <b>c</b> <!-- This node is unwanted -->
</root> 
```

我知道我可以有效地比较`name()`和`text()`值，以下查找引用自己的节点并排除其他节点：

```
*[name() = text()] 
```

我尝试查找其他引用失败，因为`text()`在此查询中处于错误的上下文中：

```
b[../*[name() = text()]] 
```

`<b>`当至少有一个兄弟包含它自己的名字时，上面简单地返回 all ，也许如果有`<a>a</a>`.

我需要将节点的文本与[名称的集合进行](https://stackoverflow.com/a/8192829/471559)比较。我相信这应该是我正在寻找的，但`*/name()`会引发语法错误：

```
b[text() = ../*/name()] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T22:09:17.987

**我认为这在 XPath 1.0 中是不可能的**，因为 XPath 1.0 不提供用于定义范围变量的表达式/子句。此外，XPath 1.0 不允许将函数调用作为定位步骤。

**XPath 2.0 解决方案很简单**：

```
b[. = ../*//name()] 
```

# node.js - 缓冲区，套接字。节点.js

> ID：14093990
> 
> 赞同：4
> 
> 时间：2012-12-30T19:41:48.153
> 
> 标签：node.js, sockets, tcp, binary, buffer

我正在尝试利用 Node.js 中的 TCP 套接字与 Lua 程序进行通信。我试图解决两个问题。首先是缓冲。

**缓冲区**据我了解，当从套接字向您的代码提供数据时，它将是迄今为止接收到的任何数据（流而不是数据包）。因此，当您读取接收到的数据时，它可能与发送的数据不同。

即收到的数据{学校：[“长

vs数据发送{学校：[{“Longwood”，“Hillbrow”}]}

解决此问题的方法是将您的数据放入“缓冲区”中，并通过您用来显示该信息结尾的任何方法将其拆分。通常看起来是新行。

我的问题在这里：

1.  您最终能否在缓冲区中获得更多 2 个或更多完整的数据部分，您将如何处理？循环？
2.  离开套接字的数据似乎也存在同样的问题。然而，我注意到在其他代码示例中，人们在写入套接字之前使用 Node.js[缓冲区。](http://nodejs.org/api/buffer.html)为什么这不用于传入数据？
3.  如果写入的数据多于无法处理的数据，Node 是否会为您处理这个问题，或者您是否需要想出一个方法。

最后我似乎误解了数据方面。发送和接收的所有数据是否都需要转换为二进制并返回？我希望只来回发送 JSON 数据。我想这就是我的困惑。例如：

```
var myQuestion = "Is this acceptable and will I encounter any issues?
socket.write(myQuestion); 
```

非常感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T20:20:05.760

1.  是的，你肯定会得到几个数据部分。这完全取决于您在任一端编写的代码。
2.  我不太理解您所说的“在写入前使用缓冲区”的意思。缓冲区只是纯二进制数据，它们用于传入和传出数据。Node 通常也接受用于发送的字符串，如果没有给出编码，则假定它们是 UTF8。如果你打电话，你也可以在接收时得到字符串`setEncoding`。
3.  操作系统在 TCP 套接字上有用于传入数据的缓冲区，当缓冲区已满（被节点清空太慢）时，它将停止接受数据包，直到有空间为止。

首先，`Buffer`是二进制。缓冲区只是一个字节数组，仅此而已。缓冲区可以从字符串创建，并且在某些情况下节点会自动执行此操作。在您的情况下，我建议您致电`socket.setEncoding('utf8')`. 这将自动将传入的数据转换为字符串以简化您的解析。

至于处理和拆分数据，这取决于您。TCP 仅提供按发送顺序到达的字节流。正如您所说，您可以收集字节，当收到换行符时，您可以获取之前的所有内容并将其解析为 JSON。这应该可以正常工作。您可以使用任何不会在 JSON 中弹出的字符。只要执行 JSON 序列化的程序不添加换行符，就可以了。发出“数据”时，您可以检查字符串是否有换行符，如果没有，则将其添加到任何先前接收到的数据中，如果找到，则将其拆分，添加现有数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T20:19:20.503

缓冲区用于发送和接收信息。正如您所注意到的，收到的数据可能是零散的。将这些数据恢复到正确的部分始终取决于您的代码。

在缓冲区中接收到两个数据块是完全可能的。通常，您会有某种定界符（例如新行，就像您提到的那样）。我要做的是：

1.  当数据进入时，将其连接到接收数据缓冲区的末尾。
2.  有一个从这个缓冲区读取的函数，在你的逻辑数据包分隔符上拆分
3.  验证该逻辑数据包。
4.  如果该数据包有效且完整，则向代码的更高级别部分引发一个事件，表明已收到完整的信息。将您的 JSON 全部解析为常规对象来引发此事件。

# visual-studio-2012 - 如何创建发布配置？

> ID：14093994
> 
> 赞同：4
> 
> 时间：2012-12-30T19:42:16.990
> 
> 标签：visual-studio-2012

![](../Images/f808a0bc0b40ce396797fdd3475e1127.png)

我找到了配置管理器，创建了一个新配置，但是在配置管理器的“配置”列下我仍然只有一个配置？？那么我在哪里修改*真实的*配置呢？

每次我运行我的应用程序时，我都会收到这个烦人的提示：

![](../Images/1a13e0c34edc8c78aa9a54e50aafb9eb.png)

我*不想*启用调试！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-28T06:50:39.767

我有同样的问题。刚刚将一个项目升级到 VS2012，但是当我选择发布配置并尝试选择“发布”作为解决方案中主项目的配置时，它只有“调试”选项。我确保我的 web.config 没有启用任何仅用于调试的功能。还有其他我应该看的地方吗？

我刚刚在 Bing 上找到了这个搜索，它似乎解释了原因。我的主要项目是一个网站项目，它显然没有调试和发布不同的概念。如果是这种情况，我认为他们应该将其称为发布而不是调试。

这是链接： [http ://forums.asp.net/t/1845650.aspx/1?vs+2012+web+deployment+](http://forums.asp.net/t/1845650.aspx/1?vs+2012+web+deployment+)

# cocoa - 在 Cocoa 应用程序 OS X 中为对象设置动画

> ID：14093997
> 
> 赞同：0
> 
> 时间：2012-12-30T19:42:26.163
> 
> 标签：cocoa, animation, core-animation, osx-mountain-lion

我正在为 OS X 编写的 Cocoa 应用程序中创建简单的动画（淡入淡出、窗口滑开、图形移动或“填充”）。我尝试查找有关 Core Animation、Core Graphics、NSViewAnimation 的信息，和 Quartz Composer 以及如何在 Cocoa 应用程序中使用它们，但我很快就迷失了方向。还有一位消息人士称，从 MountainLion 开始不再支持 Core Animation。基本动画应该使用什么？是否有有用的特定框架或第三方库，或者动画生产力应用程序的最佳实践方法？

我很抱歉没有更具体，但我对究竟要查找什么感到有点困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T22:23:46.933

最简单的做法是修改视图层的属性。为此，您需要为您的视图设置“想要图层”的标志（这些天我主要在 iOS 中工作，所以我忘记了它的确切名称。）当您为视图执行此操作时，该视图及其所有内容子视图由 CALayer 对象支持。

默认情况下，对图层可动画属性的更改是“隐式”动画的。您还可以在 CATransaction 开始/结束块中包含对图层属性的更改，以更改图层时序和动画曲线等内容。

复杂性的下一步是创建 CAAnimation 对象并将它们添加到您的图层。从 CABasicAnimation 开始。您应该能够在网上找到向您展示如何使用 CABasicAnimations 为图层属性设置动画的教程。

恐怕文档很薄。

iOS 添加了一组视图动画方法，使动画视图变得非常容易。可悲的是，Mac OS 上没有等价物。您必须处理动画代理，这有点令人困惑。您可能会查看几本 Core Animation 书籍。一个是[Marcus Zarra](https://rads.stackoverflow.com/amzn/click/com/0321617754)的，另一个是[Bill Dudney](https://rads.stackoverflow.com/amzn/click/com/1934356107)的。

编辑：我在（相当旧的）帖子中没有提到的另一个选项：Mac OS 视图对象有一个叫做动画代理的东西。您可以将属性更改发送到视图的动画代理，系统会创建一个进行该更改的动画。

如果您使用自动布局，请注意更改视图的框架或边界不会按预期工作，因为自动布局会尝试接管视图对象的大小和位置。相反，您希望将出口添加到您的约束，并对约束的设置进行动画更改。