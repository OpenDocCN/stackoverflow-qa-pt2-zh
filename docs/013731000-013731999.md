# StackOverflow 问答 13731000-13731999

# sql - 结合 SQL 查询？

> ID：13731003
> 
> 赞同：0
> 
> 时间：2012-12-05T19:33:25.187
> 
> 标签：sql

如何组合以下 SQL 查询，以便在同一行的 3 个单独列中获得一个包含州、城市和邮政编码名称的输出表？我对 SQL 几乎没有经验，但是如果我可以只做一个单独的查询，那么做 3 个单独的查询对我来说似乎更好一些。

```
SELECT City_tx FROM City WHERE City_id = 11

SELECT StateProv_tx FROM StateProv WHERE StateProv_id = 12

SELECT PostalCode_tx FROM PostalCode WHERE PostalCode_id = 13 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T19:50:07.380

如果表之间没有任何关系。只需声明 3 个变量并设置它们（只是上述答案以外的另一种方法）；

```
DECLARE @City VARCHAR(100), @StateProv VARCHAR(100), @PostalCode VARCHAR(100)

SELECT @City = City_tx FROM City WHERE City_id = 11
SELECT @StateProv = StateProv_tx FROM StateProv WHERE StateProv_id = 12
SELECT @PostalCode = PostalCode_tx FROM PostalCode WHERE PostalCode_id = 13

SELECT @City City, @StateProv StateProv, @PostalCode PostalCode 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T19:44:14.217

```
select max(City_tx),max(StateProv_tx),max(PostalCode_tx) from
(
SELECT City_tx ,'' StateProv_tx, '' PostalCode_tx FROM City WHERE City_id = 11
union all
SELECT '' City_tx ,StateProv_tx, '' PostalCode_tx  FROM StateProv WHERE StateProv_id = 12
union all
SELECT '' City_tx ,'' StateProv_tx, PostalCode_tx FROM PostalCode WHERE PostalCode_id = 13
) t 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T19:49:26.463

假设`City_id`和都是唯一的`StateProv_id`，`PostalCode_id`那么只需使用交叉连接并且仅限制这些字段。如果您在其余数据之间没有其他关系，可能不是最有效的，但实际上不是任何其他好的选择：

```
SELECT City_tx, StateProv_tx, PostalCode_tx
FROM City, StateProv, PostalCode
WHERE City_id = 11 AND StateProv_id = 12 AND PostalCode_id = 13 
```

尽管如此，除非我们没有架构或任何有关数据布局方式的信息，否则这甚至可能无法为您工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T19:54:33.097

```
SELECT City_tx, (SELECT StateProv_tx FROM StateProv WHERE StateProv_id = 12) as sp_tx, (SELECT PostalCode_tx FROM PostalCode WHERE PostalCode_id = 13) as pc_tx FROM City WHERE City_id = 11 
```

它应该可以工作……至少在 MySQL 中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-05T20:29:54.327

`Cross join`假设您在每种情况下都返回了一行，这似乎是一个好方法：

```
select *
from (SELECT City_tx FROM City WHERE City_id = 11) c cross join
     (SELECT StateProv_tx FROM StateProv WHERE StateProv_id = 12) s cross join
     (SELECT PostalCode_tx FROM PostalCode WHERE PostalCode_id = 13) p 
```

# python - 在 python 中尝试

> ID：13731005
> 
> 赞同：-1
> 
> 时间：2012-12-05T19:33:29.673
> 
> 标签：python, try-catch

这是代码：

```
aList = []
for p in anotherList:
  aList.append(p)
  try:
    k=p.someMethod()
    aList.append(k) #getting error here
  except someException:
    continue
 return aList 
```

我收到“全局名称错误--aList 未定义。为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T19:48:46.153

如果`aList`未定义，您应该在进入 try-except 子句`aList.append(p)`之前在循环顶部收到错误。`aList.append(k)`你确定你没有错别字？

```
aList = []
for p in anotherList:
  aList.append(p) # <== should have gotten error here first!
  try:
    k=p.someMethod()
    aList.append(k) #getting error here
  except someException:
    continue
 return aList 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T19:46:04.830

这段代码没有任何问题。

```
>>> anotherList = [1, 2, 3, 4, 5]
>>> aList = []
>>> for p in anotherList:
...     aList.append(p)
...     try:
...             aList.append(9)
...     except someException:
...             continue
... 
>>> aList
[1, 9, 2, 9, 3, 9, 4, 9, 5, 9] 
```

如您所见，它有效。

如果您仍然有问题，请发布更多代码，您发布的部分没有错误。

# maven - Maven可以自动构建一个找不到的依赖吗？

> ID：13731007
> 
> 赞同：0
> 
> 时间：2012-12-05T19:33:36.730
> 
> 标签：maven, dependencies

我正在从事三个独立的项目（A、B 和 C）。

项目 B 和 C 依赖于项目 A 生成的 jar。

如果没有找到依赖项，Maven是否有能力自动构建项目A？

到目前为止，我发现的答案表明制作其他 2 个项目模块（我认为这意味着存储库布局并将它们合并到项目 A 中）并创建一个父/子 pom。

一个简单的“不”也是我的结论之一。

好像我在 B 和 C 中制作了项目 A 的模块，maven 并不喜欢那样。Maven 可以在构建期间查看当前项目范围之外的项目吗？对不起，如果这有点罗嗦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:00:30.410

如果 A、B 和 C 是公共容器项目的模块，则该方案可以正常工作。

从根 pom.xml：

```
<modules>
 <module>project-a</module>
 <module>project-b</module>
 <module>project-c</module>
</modules> 
```

其中“project-a”等是父文件夹内的 Maven 项目文件夹的名称。

父项目必须具有`<packaging>pom</packaging>`此功能。

然后您可以构建父项目，它将按顺序构建所有子项目，或者您可以使用高级 Maven 反应器标志之一。

例如`mvn clean install -pl project-b`，只会构建项目 B。

有关更多信息，请执行`mvn --help`并阅读Maven By Example 一书中[的多模块章节](http://www.sonatype.com/books/mvnex-book/reference/multimodule.html)。

* * *

但是对于这个问题：

> 如果没有找到依赖项，Maven是否有能力自动构建项目A？

... 答案始终是否定的。如果找不到依赖项，Maven 会失败，但它永远不会决定要构建哪些项目。你负责哪些项目需要建设。

# objective-c - 使用位置的隐形 Box2d 精灵？

> ID：13731015
> 
> 赞同：0
> 
> 时间：2012-12-05T19:34:13.650
> 
> 标签：objective-c, ios, cocos2d-iphone

创建一个 CCNode，将其设置为我的玩家的位置 - 在调试绘制中我看到了物理对象，但精灵是不可见的或 nil 或其他东西。它不会崩溃，精灵根本不会出现。炸弹也会通过正确的路径，并调用它的选择器方法。

没有出现：

```
GameObject *bomb = [_useBombArray nextSprite];
bomb.tag = kShipMissile;
[bomb stopAllActions];
NSLog(@"_bombSpawnPoint: %.0f, %.0f", _bombSpawnPoint.x, _bombSpawnPoint.y);
bomb.position = _bombSpawnPoint; 
```

通过这样做，我已经让它出现了：

```
GameObject *bomb = [_useBombArray nextSprite];
bomb.tag = kShipMissile;
[bomb stopAllActions];
bomb.position = ccp(_winSize.width * 0.5, _winSize.width * 0.5); 
```

_bombSpawnPoint 是在此之前设置的，我确实收到了正确的输出结果。

最初我以为我在更新的不合时宜的时候调用了创建对象。所以我稍微改变了函数，以确保在更新方法中以正确的顺序调用它。

不知道是什么原因造成的！请帮忙！我已经创建了这样的所有对象，并且到目前为止它们都运行良好！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T20:35:12.643

造成这种情况的原因是炸弹的纹理不在正确的 BatchNode 中。直到我删除了多余的子类并仅使用了精灵，该错误才触发。

收到的错误是：`'CCSprite is not using the same texture id'`

一旦我使用了另一个批处理节点，一切都完美无缺。希望这对某人有帮助！

# ios - 苹果以前的文档

> ID：13731018
> 
> 赞同：0
> 
> 时间：2012-12-05T19:34:23.747
> 
> 标签：ios, iphone, xcode, ios4

> **可能重复：**
> [iOS 4.3 库的 xcode4 文档](https://stackoverflow.com/questions/5529788/xcode4-documentation-for-ios-4-3-library)

我正在搜索苹果以前的（ios 4）文档指南。Apple 更改了故事板的所有文档。但我需要 xib。我在哪里可以找到以前的（ios 4）文档指南和其他材料。提前致谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T19:42:50.127

如果我打开 Xcode Preferences，选择 Downloads 和 Documentation 选项卡，我会看到可以下载的文档集列表。iOS 4.3 库就是其中之一。然后，当我在管理器窗口中搜索时，我可以限制它应该用于结果的集合。

# c# - 如何将我的简单 ASP.NET MVC 4 应用程序转换为 AJAX？

> ID：13731020
> 
> 赞同：0
> 
> 时间：2012-12-05T19:34:30.063
> 
> 标签：c#, asp.net, asp.net-mvc

如何将我的简单 MVC4 待办事项列表应用程序转换为 AJAX？

理想的答案将为我提供将这个示例成功转换为 AJAX 的步骤。

注意：我不需要 AJAX 教程，而是了解 ASP.NET MVC 架构如何支持它。

附带问题：为什么`@Html.EditorFor(model => model.TodoItemToCreate)`即使视图模型设置为 ，也会带回输入的值`this.TodoItemToCreate = null`？

**模型**

```
public class TodosViewModel
{
    List<string> todoItems;
    public List<string> TodoItems
    { 
        get { return this.todoItems ?? (todoItems = new List<string>()); } 
    }

    [Display(Name="What do you need to do?")]
    public string TodoItemToCreate { get; set; }

    public bool AcceptTodoItem()
    {
        bool isThereAnItemToAccept = !string.IsNullOrWhiteSpace(this.TodoItemToCreate);

        if (isThereAnItemToAccept)
        {
            this.TodoItems.Add(this.TodoItemToCreate);
            this.TodoItemToCreate = null;
        }

        return isThereAnItemToAccept;
    }
} 
```

**控制器**

```
public class TodosController : Controller
{
    public ActionResult Index()
    {
        return View(new TodosViewModel());
    }

    public ActionResult Create(TodosViewModel todosViewModel)
    {
        todosViewModel.AcceptTodoItem();
        return View("Index", todosViewModel);
    }
} 
```

**索引视图**

```
@model Programming.LearnWeb.Models.TodosViewModel

@{
    ViewBag.Title = "Todos";
}

@using (Html.BeginForm("Create", "Todos"))
{
    @Html.Partial("List")    
    @Html.LabelFor(model => model.TodoItemToCreate)
    @Html.EditorFor(model => model.TodoItemToCreate)
    <input type="submit" value="Create" />
}

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
} 
```

**列表显示**

```
@model Programming.LearnWeb.Models.TodosViewModel
    @{ int i = 0; }
<table>
    @foreach (var todoItem in Model.TodoItems)
    {
        <tr>
            <td>
                @Html.Hidden("TodoItems[" + i++ + "]", todoItem)
                @todoItem
            </td>
        </tr>
    }
</table> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-07T09:16:54.590

我自己完成了这项工作 -如果有人感兴趣或有任何意见 ，结果在[https://github.com/gabrielgreen/Todos.Mvc 。](https://github.com/gabrielgreen/Todos.Mvc)

我付出了相当多的努力，如果我做得对，我将不胜感激。

# javascript - 从元素触发的 Jquery 动态事件

> ID：13731021
> 
> 赞同：0
> 
> 时间：2012-12-05T19:34:31.603
> 
> 标签：javascript, jquery, html, jquery-selectors

我正在尝试获取与元素关联的事件并尝试触发相应的事件。例如，如果我为文本框传递了一个 id，并且它绑定了一个事件焦点，那么我想触发该焦点事件。我知道我们可以通过使用获取事件详细信息

```
 $.data('selector', 'events'); 
```

但是如何使用这个对象呢？这应该在 jquery 或 javascript 中。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T19:54:14.267

不知道为什么你需要这个。试试[triggerHandler](http://api.jquery.com/triggerHandler/ "触发器处理程序")

```
var item = $("selector"), 
    trigger = function(name){
        item.triggerHandler(name);
    };

$.each($.data(item[0], "events"), trigger); 
```

**警告**此代码不适用于委托事件等。它只触发绑定到匹配元素的处理程序。

# python - Python：服务器-客户端连接 - 错误：服务器崩溃

> ID：13731031
> 
> 赞同：0
> 
> 时间：2012-12-05T19:35:07.817
> 
> 标签：python

1.  我打开服务器
2.  我打开客户端
3.  客户端向服务器发送“连接请求”
4.  服务器接收“连接请求”
5.  服务器向客户端发送“已连接”
6.  客户端recvs从服务器“连接”
7.  客户端打印“已连接”！
8.  服务器崩溃，我找不到原因（我也看不到错误）。

服务器：

```
from socket import *;

iSocket = socket( AF_INET, SOCK_DGRAM );
iSocket.bind( ( "", 4325 ) );

while True:

    recv_data, addr = iSocket.recvfrom( 2048 );

    if addr[ 0 ] == "127.0.0.1":

        #stuff

    elif recv_data == "on":
        print "New connection:", addr[ 0 ];

    elif recv_data == "connectrequest":
        iSocket.sendto( "connected", addr ); 
```

客户：

```
import time;
import select;
from socket import *;

address = ( '192.168.0.101', 4325 );

iSocket = socket( AF_INET, SOCK_DGRAM );
iSocket.connect( address );

reconnect = 10;
last_reconnect = 0;
connected = False;

while connected == False:

    if last_reconnect <= int( time.time( ) ) + reconnect:
        print "Connecting...";
        iSocket.sendto( "connectrequest", address );

    data_available = select.select( [ iSocket ], [ ], [ ], 11 )

    if data_available[ 0 ]:
        recv_data, addr = iSocket.recvfrom( 2048 );

        if recv_data == "connected":
            connected = True;
            print "Connected!";

iSocket.sendto( "on", address );

while True:

    recv_data, addr = iSocket.recvfrom( 2048 );
    print recv_data, addr; 
```

# drools - drools 5：跨进程共享知识库时出现 NullPointerException

> ID：13731035
> 
> 赞同：2
> 
> 时间：2012-12-05T19:35:36.300
> 
> 标签：drools, mvel

我们有一个运行 drools 的 jboss 实例集群。我们在一个实例上生成知识库，然后将其存储在数据库中；然后其他实例可以从数据库中加载它，而不是自己生成它。

这在使用 drools 4 一段时间后效果很好，但我们最近升级到 drools 5.3.0 BRMS，并且该模式不再有效。知识库在生成它的应用程序实例中运行良好，但在其他任何地方都失败，但出现以下异常。请注意，在将事实插入工作内存时会发生此异常。

应用程序的所有实例都是相同的，它们在同一个 jvm 中运行，等等。“其他”实例不需要在不同的物理机器上——它可以在同一个硬件上，并且仍然会发生故障。

知识库为何会在与生成它的 jvm 实例不同的 jvm 实例中失败？有没有办法避免这个问题？谢谢。

这是似乎发生故障的 drl。我已经通过mvel代码做了一些调试，但我对它并不熟悉，我还没有弄清楚发生了什么。我认为发生故障的表达式是“this.fact.requirementId”。

```
rule "Find OutOfOrder PredicateSolutions for new LeafPredicateSolution in rule [Become Application Expired : 147]"
ruleflow-group "RuleGroup[Become Application Expired:147]"
agenda-group "leaf"
no-loop
salience -1001
when
    EngineDates($rewindToDate: engineEffectiveDate);

    lps:LeafPredicateSolution(
        ruleId==147,
        parent==null,
        $candidateId:candidateId,
        defunct==false,
        fact:fact,
        effectiveDate == $rewindToDate,
        $programId:programId,
        eval(!fact.getReused())); // only solutions created for the fact we're running on can trigger OoO

  oops : ArrayList() from accumulate(
    PredicateSolution(
      $sol:this,
      candidateId==$candidateId,
      effectiveDate > $rewindToDate,
      defunct==false,
      programId==$programId,
      parent!=null,
      solutionType!=SolutionType.RETIRED,
      eval(($sol instanceof LeafPredicateSolution) || ($sol instanceof NonCalcProgramSolutionChild))
    ),
    init(ArrayList items = new ArrayList();),
    action(items.add($sol);),
    reverse(items.remove($sol);),
    result(items));
    // Find ProgramPredicateSolutions in other programs that refer to this program.
    // These need to be rewound.
    oopps:ArrayList() from collect(
        ProgramPredicateSolution(
            this.fact.requirementId == $programId,
            candidateId==$candidateId,
            effectiveDate > $rewindToDate,
            defunct==false,
            parent!=null,
            solutionType!=SolutionType.RETIRED));

    eval((oops.size() > 0) || (oopps.size() > 0));

    eval(predicateSolutionFactory.oopEnabled());//Don't run oop if it is disabled (TimeMachine, Whatif)

then
    predicateSolutionFactory.addToOutOfOrder(lps, oops, oopps, new Long(65));
end 
```

堆栈跟踪：

```
java.lang.NullPointerException
        at org.mvel2.MVEL.executeExpression(MVEL.java:954)
        at org.drools.base.extractors.MVELClassFieldReader.getValue(MVELClassFieldReader.java:100)
        at org.drools.base.extractors.BaseObjectClassFieldReader.getHashCode(BaseObjectClassFieldReader.java:196)
        at org.drools.core.util.AbstractHashTable$DoubleCompositeIndex.hashCodeOf(AbstractHashTable.java:616)
        at org.drools.core.util.RightTupleIndexHashTable.getOrCreate(RightTupleIndexHashTable.java:451)
        at org.drools.core.util.RightTupleIndexHashTable.add(RightTupleIndexHashTable.java:332)
        at org.drools.reteoo.AccumulateNode.assertObject(AccumulateNode.java:263)
        at org.drools.reteoo.CompositeObjectSinkAdapter.doPropagateAssertObject(CompositeObjectSinkAdapter.java:458)
        at org.drools.reteoo.CompositeObjectSinkAdapter.propagateAssertObject(CompositeObjectSinkAdapter.java:386)
        at org.drools.reteoo.AlphaNode.assertObject(AlphaNode.java:135)
        at org.drools.reteoo.SingleObjectSinkAdapter.propagateAssertObject(SingleObjectSinkAdapter.java:59)
        at org.drools.reteoo.AlphaNode.assertObject(AlphaNode.java:135)
        at org.drools.reteoo.SingleObjectSinkAdapter.propagateAssertObject(SingleObjectSinkAdapter.java:59)
        at org.drools.reteoo.AlphaNode.assertObject(AlphaNode.java:135)
        at org.drools.reteoo.CompositeObjectSinkAdapter.doPropagateAssertObject(CompositeObjectSinkAdapter.java:458)
        at org.drools.reteoo.CompositeObjectSinkAdapter.propagateAssertObject(CompositeObjectSinkAdapter.java:376)
        at org.drools.reteoo.ObjectTypeNode.assertObject(ObjectTypeNode.java:214)
        at org.drools.reteoo.EntryPointNode.assertObject(EntryPointNode.java:244)
        at org.drools.common.NamedEntryPoint.insert(NamedEntryPoint.java:337)
        at org.drools.common.NamedEntryPoint.insert(NamedEntryPoint.java:298)
        at org.drools.common.AbstractWorkingMemory.insert(AbstractWorkingMemory.java:887)
        at org.drools.common.AbstractWorkingMemory.insert(AbstractWorkingMemory.java:846)
        at org.drools.impl.StatefulKnowledgeSessionImpl.insert(StatefulKnowledgeSessionImpl.java:267) 
```

# java - 我可以有一个定义类型 T 的 bean 和一个返回类型 T 的工厂 bean 吗？

> ID：13731039
> 
> 赞同：0
> 
> 时间：2012-12-05T19:35:50.477
> 
> 标签：java, spring, ioc-container

我有一个返回当前用户的请求范围 bean：

```
<bean id="currentUserResolver" class="com.shutup.CurrentUserResolver" />

<bean scope="request" factory-bean="currentUserResolver" factory-method="getCurrentUser">
    <aop:scoped-proxy/>
</bean> 
```

这样我就可以自动装配一个用户对象并获取当前用户。我还想做的是修改我的 User 类以具有 init 方法：

```
<bean id="user" class="com.shutup.model.User" init-method="postInitialize" /> 
```

如果我这样做，Spring 会抱怨：

```
No unique bean of type [com.shutup.model.User] is defined: expected single matching bean but found 2: [user, currentUserResolver$created#0] 
```

有没有办法以声明方式将我的 postInitialize 方法添加到用户？我相信我也可以选择 User 实现一个接口，但我不想将我的代码与 Spring 紧密联系起来。

当前用户解析器：

```
public class CurrentUserResolver
{
    static Log log = LogFactory.getLog(CurrentUserResolver.class.getName());

    @Autowired
    private UserFactory userFactory;

    public User getCurrentUser()
    {    
        log.info("attempting to get current user");

        User currentUser = null;

        if(SecurityContextHolder.getContext() != null &&
                SecurityContextHolder.getContext().getAuthentication() instanceof UserAuthentication)
        {
            UserAuthentication authentication = (UserAuthentication)SecurityContextHolder.getContext().getAuthentication();
            User serializedUser = (User)authentication.getPrincipal();
            currentUser = this.userFactory.getUserFromTwitterId(serializedUser.getTwitterId());
        }

        return currentUser;
    }
} 
```

# scala - 将日期字符串与 Scala 中的实际日期进行比较

> ID：13731041
> 
> 赞同：6
> 
> 时间：2012-12-05T19:35:55.483
> 
> 标签：scala

我正在寻找一种很好的方法来验证然后比较从 REST 服务传递的日期字符串。

如果我将 2012-12-25 (year-month-day) 作为字符串传递，那么确认它是有效日期然后说日期是将来还是过去的优雅方法是什么？

要在 Scala 中处理日期，显然可以使用现有的 Java 库。但是，在 Java 中处理日期一直就像是在为黑暗面服务，所以我不想将太多的遗留问题拖入我当前的编码风格中。[查看langref.org](http://langref.org/scala/dates)上的Scala Dates 示例，感觉如果我遵循这种编程风格，我将回到 Java 编码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T21:54:14.757

JodaTime 很好，很好，很好，不用担心阴暗面，它不存在（或者至少在这个特定的 Java 库中不存在）。

```
// "20121205".to_date
class String2Date(ymd: String) {
  def to_date = {  
    try{ Some(ymdFormat.parseDateTime(ymd)) } 
    catch { case e:Exception => None }
  }
  val ymdFormat = org.joda.time.format.DateTimeFormat.forPattern("yyyyMMdd")
}
@inline implicit final def string2Date(ymd: String) = new String2Date(ymd)

def dater(ymd: String) = {
  val other = new JodaTime
  ymd.to_date map{d=>
    if(d.isBefore other) ...
    else ...
  } getOrElse("bad date format")
} 
```

几乎可以做任何与 JodaTime 相关的日期/时间；这个库有多好是荒谬的：毫不含糊地竖起大拇指。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-05T20:14:26.810

您可以使用标准 Java SimpleDateFormat 库执行此操作：

```
def parseDate(value: String) = {
  try {
    Some(new SimpleDateFormat("yyyy-MM-dd").parse(value))
  } catch {
    case e: Exception => None
  }
} 
```

然后像这样使用它：

```
parseDate("2012-125")   // None
parseDate("2012-12-05") // Some(Wed Dec 05 00:00:00 EST 2012) 
```

然后你可以有一个测试未来日期的功能：

```
def isFuture(value: Date) = value.after(new Date) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T20:19:30.773

尽管使用 java 日期库有一些缺点，例如缺乏线程安全性（[为什么 Java 的 SimpleDateFormat 不是线程安全的？](https://stackoverflow.com/questions/6840803/simpledateformat-thread-safety)）和难以使用的 API，但您可以使用隐式使事情变得更容易接受：

```
implicit def stringToDate(date: String) = new {
  def parse(implicit format: String) = parse0(date)(format)
  private def parse0(date: String)(implicit format: String) = {
    val sdf = new SimpleDateFormat(format)
    sdf.setLenient(false)
    sdf.parse(date)
  }
  def isValid(implicit format: String) = try { parse0(date)(format); true } catch { case _ => false }
  def beforeNow(implicit format: String) = parse0(date)(format) before new Date()
  def afterNow(implicit format: String) = parse0(date)(format) after new Date()
} 
```

然后你可以像这样使用它：

```
implicit val format = "yyyy-MM-dd"
"2012-12-02" isValid // true
"2012-12-02" beforeNow // ?
"2012-12-25" afterNow // ? 
```

或者，您可以使用[scala-time](https://github.com/jorgeortiz85/scala-time)：

```
import org.joda.time.format.ISODateTimeFormat._
import org.joda.time.DateTime
for(date <- date.parseOption("2012-12-02")) yield date < new DateTime // Option(?) 
```

使用这种方法，您可以获得一个 Scala 友好的界面，并且您不必创建和解析新的 SimpleDateFormat 对象或将其存储在本地线程中以避免线程问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-05T21:40:40.060

如果您真的想完全避免使用任何日期时间库，您可以使用合适的正则表达式（例如此答案中的一个：[https](https://stackoverflow.com/a/7221570/227019) ://stackoverflow.com/a/7221570/227019 ）来验证字符串是确实是一个有效的 ISO 8601 格式日期，然后使用可以按字典顺序比较这些日期的事实来确定它们的时间顺序（只需将当前日期格式化为相同格式，并使用常规字符串比较将其与其他日期进行比较）。

# ms-access - MS Access如何更新当前行，移动到下一条记录，而不是第一条

> ID：13731043
> 
> 赞同：2
> 
> 时间：2012-12-05T19:35:57.547
> 
> 标签：ms-access, vba

我有一个连续的表单，页脚中有一个命令按钮，它使用一个值更新当前记录，一旦被请求，该记录将不再显示在表单中。我希望用户能够单击按钮，一旦记录更新，移动到下一条记录，而不是默认行为的第一条记录。我有我认为应该可以工作但没有工作的代码，它一直回到表单上的第一条记录。

```
Private Sub cmdCloseReq_Click()

Dim ReqID As String
ReqID = Me.txtReqID
Dim rst As Recordset
Dim strBookmark As Integer

Set rst = Me.RecordsetClone
rst.MoveNext
If Not rst.EOF Then                 ' if not end-of-file
  strBookmark = rst.Bookmark      ' ...save the next record's bookmark
  Dim cmd As New ADODB.Command
  With cmd
    .ActiveConnection = CurrentProject.Connection
    .CommandType = adCmdStoredProc
    .CommandText = "spUpdateLOG_ReqCompleteDate"
    .Parameters("@ReqID") = ReqID
    .Execute
  End With                 
Me.Requery
Me.Bookmark = strBookmark

End If
Set rst = Nothing   

End Sub 
```

好的，我根据 rene 的帖子找到了解决方案。我抓住下一条记录的主键，进行更新，然后在请求后找到下一条记录并将书签设置为该记录。这是代码：

```
Private Sub cmdCloseReq_Click()

Dim ReqID As String
ReqID = Me.txtReqID
Dim rst As New ADODB.Recordset
Dim strBookmark As String

Set rst = Me.RecordsetClone

With rst
 .Find "[ReqID] = '" & ReqID & "'"
 .MoveNext
 strBookmark = rst.Fields(0)

End With

If Not rst.EOF Then                 ' if not end-of-file
      ' ...save the next record's bookmark

  Dim cmd As New ADODB.Command

  With cmd
    .ActiveConnection = CurrentProject.Connection
    .CommandType = adCmdStoredProc
    .CommandText = "spUpdateLOG_ReqCompleteDate"
    .Parameters("@ReqID") = ReqID
    .Execute
  End With                 ' ...delete the record

  Me.Requery

 Set rst = Me.RecordsetClone
 With rst
      .Find "[reqID]= " & strBookmark
    Me.Bookmark = .Bookmark

End With

Else
  With cmd
    .ActiveConnection = CurrentProject.Connection
    .CommandType = adCmdStoredProc
    .CommandText = "spUpdateLOG_ReqCompleteDate"
    .Parameters("@ReqID") = ReqID
    .Execute
  End With                 ' ...delete the record
Me.Requery

End If
Set rst = Nothing 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T20:46:23.180

我记得书签在重新查询后失效。如果您有一个主键，您可以更好地获取该主键，然后在重新查询后将当前记录移动到先前获得的主键

# unit-testing - 如何模拟静态成员变量

> ID：13731049
> 
> 赞同：17
> 
> 时间：2012-12-05T19:36:23.840
> 
> 标签：unit-testing, junit, mocking, mockito

我有一个依赖于 ClassToMock 的 ClassToTest 类。

```
public class ClassToMock {

  private static final String MEMBER_1 = FileReader.readMemeber1();

  protected void someMethod() {
    ...
  }
} 
```

ClassToTest 的单元测试用例。

```
public class ClassToTestTest {
  private ClassToMock _mock;

  @Before
  public void setUp() throws Exception {
     _mock = mock(ClassToMock.class)
  }

} 
```

在 setUp() 方法中调用 mock 时，FileReader.readMemeber1(); 被执行。有没有办法避免这种情况？我认为一种方法是在方法中初始化 MEMBER_1 。还有其他选择吗？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-06T01:23:48.430

您`ClassToMock`与 紧密耦合`FileReader`，这就是您无法测试/模拟它的原因。而不是使用工具来破解字节码，以便您可以模拟它。我建议你做一些简单的重构来打破依赖。

## 步骤 1\. 封装全局引用

[Michael Feathers 的精彩著作《有效地使用遗留代码》](https://rads.stackoverflow.com/amzn/click/com/0131177052)中也介绍了这种技术。

标题几乎是自我解释的。不是直接引用全局变量，而是将其封装在方法中。

在您的情况下，`ClassToMock`可以重构为：

```
public class ClassToMock {
  private static final String MEMBER_1 = FileReader.readMemeber1();

  public String getMemberOne() {
    return MEMBER_1;      
  }
} 
```

~~然后你可以很容易地使用 Mockito 来模拟`getMemberOne()`.~~

**UPDATED** Old Step 1 不能保证`Mockito`安全地模拟，如果`FileReader.readMemeber1()`抛出异常，那么测试将惨遭失败。所以我建议添加另一个步骤来解决它。

## 步骤 1.5。添加 Setter 和 Lazy Getter

由于问题`FileReader.readMember1()`将在`ClassToMock`加载后立即调用。我们必须推迟它。所以我们懒惰地调用getter `FileReader.readMember1()`，并打开一个setter。

```
public class ClassToMock {
  private static String MEMBER_1 = null;

  protected String getMemberOne() {
    if (MEMBER_1 == null) {
      MEMBER_1 = FileReader.readMemeber1();
    }
    return MEMBER_1;      
  }

  public void setMemberOne(String memberOne) {
    MEMBER_1 = memberOne;
  }
} 
```

现在，`ClassToMock`即使没有`Mockito`. **但是，这不应该是您的代码的最终状态，一旦您准备好测试，您应该继续执行第 2 步。**

## 步骤 2\. 依赖注入

一旦你准备好你的测试，你应该进一步重构它。现在而不是`MEMBER_1`自己阅读。这个类应该接收`MEMBER_1`来自外部世界的信息。您可以使用 setter 或构造函数来接收它。下面是使用 setter 的代码。

```
public class ClassToMock {
  private String memberOne;
  public void setMemberOne(String memberOne) {
    this.memberOne = memberOne;
  }

  public String getMemberOne() {
    return memberOne;
  }
} 
```

这两步重构真的很容易做到，即使手头没有测试也可以做到。如果代码不是那么复杂，你可以做第2步。然后你可以很容易地测试`ClassToTest`

* * *

## 更新 12/8：回答评论

请参阅我在此问题中的另一个答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T05:02:18.987

## 更新 12/8：回答评论

> 问题：如果 FileReader 是非常基本的东西，比如 Logging，需要在每个类中都有。你会建议我在那里采用同样的方法吗？

***这取决于。***

在进行这样的大规模重构之前，您可能需要考虑一些事情。

1.  如果我搬到`FileReader`外面，我是否有一个合适的类可以从文件中读取并将结果提供给**每个**需要它们的类？

2.  除了使课程更容易测试之外，我还有其他好处吗？

3.  我有时间吗？

如果任何一个答案是“否”，那么你最好不要这样做。

**但是，我们仍然可以打破所有类之间的依赖关系，并且`FileReader`只需进行最小的更改。**

根据您的问题和评论，我假设您的系统`FileReader`用作从属性文件中读取内容的全局参考，然后将其提供给系统的其余部分。

[Michael Feathers 的精彩著作《有效地使用遗留代码》](https://rads.stackoverflow.com/amzn/click/com/0131177052)中也介绍了这种技术。

## 步骤 1\. 将静态方法委托`FileReader`给实例。

改变

```
public class FileReader {
  public static FileReader getMemberOne() {
    // codes that read file.
  }
} 
```

到

```
public class FileReader {
  private static FileReader singleton = new FileReader();
  public static String getMemberOne() {
    return singleton.getMemberOne();
  }

  public String getMemberOne() {
    // codes that read file.
  }
} 
```

通过这样做，`FileReader`现在的静态方法不知道如何`getMemberOne()`

## 步骤 2\. 提取接口`FileReader`

```
public interface AppProperties {
  String getMemberOne();
}

public class FileReader implements AppProperties {
  private static AppProperties singleton = new FileReader();
  public static String getMemberOne() {
    return singleton.getMemberOne();
  }

  @Override
  public String getMemberOne() {
    // codes that read file.
  }
} 
```

我们将所有方法提取到 中，并在现在使用`AppProperties`中的静态实例。`FileReader``AppProperties`

## 步骤 3\. 静态设置器

```
public class FileReader implements AppProperties {
  private static AppProperties singleton = new FileReader();

  public static void setAppProperties(AppProperties prop) {
    singleton = prop;
  }

  ...
  ...
} 
```

我们在 FileReader 中打开了一个接缝。通过这样做，我们可以设置更改底层实例，`FileReader`而它永远不会注意到。

## 步骤 4\. 清理

现在`FileReader`有两个职责。一种是读取文件并提供结果，另一种是为系统提供全局参考。

我们可以将它们分开并给它们一个好的命名。这是结果：

```
// This is the original FileReader, 
// now is a AppProperties subclass which read properties from file.
public FileAppProperties implements AppProperties {
  // implementation.
}

// This is the class that provide static methods.
public class GlobalAppProperties {

  private static AppProperties singleton = new FileAppProperties();

  public static void setAppProperties(AppProperties prop) {
    singleton = prop;
  }

  public static String getMemberOne() {
    return singleton.getMemberOne();
  }
  ...
  ...
} 
```

结尾。

在此重构之后，无论何时要进行测试。您可以将模拟设置`AppProperties`为`GlobalAppProperties`

我认为如果你想做的只是打破许多类中相同的全局依赖关系，这种重构会更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-01-18T11:02:43.020

Powermock 核心提供了一种方便的实用方法，可用于此目的。

添加`powermock-core`到您的项目中。

```
testImplementation group: 'org.powermock', name: 'powermock-core', version: '2.0.9' 
```

```
FileReader fileReader = mock(FileReader.class);
Whitebox.setInternalState(ClassToMock.class, "MEMBER_1", fileReader); 
```

`Whitebox.setInternalState`只是一种使用反射设置字段值的便捷方法。因此它可以与任何 Mockito 测试一起使用。

# c++ - 在 C++ 中获取 IP 地址的平台无关方式

> ID：13731054
> 
> 赞同：2
> 
> 时间：2012-12-05T19:36:41.447
> 
> 标签：c++, ip, platform-independent

> **可能重复：**
> [获取本地计算机的 IP 地址](https://stackoverflow.com/questions/122208/get-the-ip-address-of-local-computer)

我希望能够在不查询外部 www.whatsmyip.com 的情况下获取我在 C++ 中使用的机器的 IP 地址，但也希望以独立于平台的方式进行。我可以找到适用于 Windows 和 Linux 的特定示例，但想不出一种简单的方法来以独立于平台的方式执行此操作。如果这似乎是最好/唯一的方法，我还会考虑根据操作系统放置 if 语句的选项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T19:41:04.593

如果您能够使用 boost，我强烈推荐[boost::asio](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_asio.html)，它与您将获得的一样跨平台。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T19:50:36.807

boost::asio 的替代方案可能是[POCO Network Library](http://pocoproject.org/slides/200-Network.pdf)。

# c++ - 用于使用 Visual Studio 和 Windows 7 与 Amazon S3 交互的 C++ 库

> ID：13731066
> 
> 赞同：1
> 
> 时间：2012-12-05T19:38:19.000
> 
> 标签：c++, visual-studio-2010, amazon-s3

我在 S3 中有数据，我想要 Visual Studio 2010 和 Windows 7 的 C++ 库来获取/与该数据交互。我查看了许多在线开源库，但由于涉及的依赖项数量，编译它们一直是一场噩梦。是否有一步一步的指南来做同样的事情？

# javascript - 客户端 Web 应用程序的开发/构建工具

> ID：13731077
> 
> 赞同：2
> 
> 时间：2012-12-05T19:39:07.127
> 
> 标签：javascript, node.js, coffeescript, less, npm

我正在开发一个非常大的节点 Web 应用程序，并意识到我的工作流程不是最理想的。服务器端代码被很好地组织成节点模块。然而，应用程序中的大部分繁重工作都发生在客户端代码上。

该项目由jade、less 和javascript/coffeescript 代码组成。此外，还有许多来自库（jQuery、D3、Bootstrap 等）的 css/js 包含。我正在寻找但很难找到的是一个很好的工具链，它可以帮助我组织我的项目并在开发和生产之间切换：

*   开发模式：在node中即时编译jade、less和coffeescript，无需重新编译。将编译后的代码作为单独的文件包含在 html 中。在服务器端代码中设置一些调试参数。

*   生产模式：一个编译脚本（make/ant），将代码压缩并组合成静态的html/css/js。

目前，我正在手动使用一些用于开发的节点服务器代码和用于生产的 make 文件，例如：

```
cat javascript/*.js > build/client.js 
```

然而，这有点烦人，我根本不是制造/蚂蚁专家。还有一个问题是我为开发和生产维护单独的 html 文件，因为它们包含不同的 css/js 文件。

是否有任何好的框架或示例项目可以帮助我改进我的工作流程？Google 给了我诸如[hem](http://spinejs.com/docs/hem)、[buildr.npm](https://github.com/balupton/buildr.npm)、[grunt](http://gruntjs.com/)之类的东西，但我不太确定这些项目有多成熟，以及它们是否真的解决了我的问题或增加了更多复杂性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T14:55:45.760

你也可以看看[brunch](http://brunch.io/)，有很多插件支持

根据它支持以下内容的网站，如果需要，您还可以添加新插件...

*   编程语言：JavaScript、CoffeeScript、IcedCoffeeScript、LiveScript、Roy*   预编译模板：Handlebars.js、Jade、Mustache、Eco*   样式：CSS、Stylus、LESS、Sass*   短绒：JSHint，CoffeeLint*   缩小器：uglify.js、clean-css

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T19:42:55.417

我会看看[grunt](http://gruntjs.com/)。我们用它来处理我们项目的部署和测试。

# flash - 从 url 跳转到时间轴中的点

> ID：13731080
> 
> 赞同：0
> 
> 时间：2012-12-05T19:39:25.253
> 
> 标签：flash, web, adobe

我有一个网站将链接到一个用 Flash 构建的新网页。主站点将具有指向该一个 Flash 页面的链接。根据您在站点中的位置，我想在时间轴的不同点打开该闪光灯。这是可以做的事情吗？如果可以，我应该怎么做？

谢谢，马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:35:52.273

这是可能的，但您应该有权访问 Flash 源文件。在 Adob​​e 的 devnet 上查看这篇文章：http: [//www.adobe.com/jp/devnet/flash/articles/deep_linking.html](http://www.adobe.com/jp/devnet/flash/articles/deep_linking.html)

一般做法和Gone3d说的一样：

1.  您在 flash-source 中添加一个回调方法。
2.  您使用 javascript 访问一个 swf 对象并调用它的回调方法。

也看到这个[答案](https://stackoverflow.com/questions/6109077/trigger-a-actionscript-function-in-a-flash-object-from-javascript)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T20:23:24.510

您需要将 var 传递给网页的调用，然后将其作为 flashVar 传递给 .swf。它需要一点 js/jquery 才能正确创建页面并动态加载 .swf。

在 swf 中，您必须有一个接受 flashVar 的函数，即 'frameNum=40'，它会调用 gotoAndStop(frameNum);

您需要哪些方面的具体帮助？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T16:43:52.847

看起来 SWFObject 允许我做我需要的事情。我找到了这个[教程](http://www.flashkit.com/tutorials/Actionscripting/Passing_-Nuno_Mir-1815/index.php)。

# javascript - 隐藏/显示列表中的 div

> ID：13731081
> 
> 赞同：0
> 
> 时间：2012-12-05T19:39:24.740
> 
> 标签：javascript, html

我有一个包含任意数量项目的列表。每个项目都有许多可以对其执行的操作。我想在用户单击与特定列表项关联的链接时出现的 div 中显示这些操作。

我尝试了以下代码，但是当我单击链接时，它只显示第一个隐藏的 div，而不是与链接关联的隐藏 div。

```
<script language="javascript"> 
function toggleOptions() {
        var ele = this;
        var text = this.parentNode.getElementsByClassName("displayOptions");

    if(ele.style.display == "block") {
        ele.style.display = "none";
    text.innerHTML = "TESTING";
    }
    else {
    ele.style.display = "block";
    text.innerHTML = "Hide GPS";
    }
} 
```

这是 HTML。这个列表可能是无穷无尽的，这只是列表的摘录。

```
 <a href="javascript:toggleOptions();">
        ITEM 1 OPTIONS
     </a>
      <div class="toggleOptions" style="display: none">
        ITEM 1 OPTIONS
     </div>

     <a href="javascript:toggleOptions();">
        ITEM 2 OPTIONS
     </a>
     <div class="toggleOptions" style="display: none">
        ITEM 2 OPTIONS
     </div>

     <a href="javascript:toggleOptions();">
        ITEM 3 OPTIONS
     </a>
      <div class="toggleOptions" style="display: none">
        ITEM 2 OPTIONS
     </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T19:41:32.620

`.toggleOptions`不是有效的`id`DOM 属性值。您是否尝试通过其类名获取元素？然后你应该使用[`getElementsByClassName`](https://developer.mozilla.org/en-US/docs/DOM/document.getElementsByClassName)，或者删除文字中的前导点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T19:51:21.813

在每个组周围放置另一个 div 或其他内容：...将 toggleOptions() 函数放在 onclick 并传递 href a # 使其不为空...通过 toggleOptions(this) 以了解单击了哪个元素

```
<div>
    <a href="#" onclick="toggleOptions(this);" style="display:block;">
        SHOW
     </a>
      <div class="toggleOptions" style="display: none">
        ITEM 1 OPTIONS
     </div>
</div>
<div>
    <a href="#" onclick="toggleOptions(this);" style="display:block;">
        SHOW
     </a>
      <div class="toggleOptions" style="display: none">
        ITEM 2 OPTIONS
     </div>
</div>
<div>
    <a href="#" onclick="toggleOptions(this);" style="display:block;">
        SHOW
     </a>
      <div class="toggleOptions" style="display: none">
        ITEM 3 OPTIONS
     </div>
</div>​ 
```

在这里试试这个[http://jsfiddle.net/YE6XZ/1/](http://jsfiddle.net/YE6XZ/1/)

```
function toggleOptions(e) {
    var ele = e;
    var text = e.parentElement.querySelector('.toggleOptions')

if(text.style.display == "none") {
    //ele.style.display = "none";
    text.style.display = "block";
    text.innerHTML = "TESTING";
    ele.innerHTML = "hide";
}
else {
    text.style.display = "none";
    //text.innerHTML = "Hide GPS";
    ele.innerHTML = "show";
}

return false; 
```

}

# ios - 使用协议接口正确抽象核心数据模型？

> ID：13731086
> 
> 赞同：0
> 
> 时间：2012-12-05T19:39:39.713
> 
> 标签：ios, design-patterns, core-data, modeling, mogenerator

我正在使用 CoreData 和 mogenerator 并尝试使用适当的抽象级别。我的应用程序处理来自不同来源的搜索、下载和播放不同类型的媒体文件（视频和音频）。每个媒体文件都有不同级别的元数据和不同的下载/播放方式。我创建了一个名为 IMediaObject 的协议，它具有所有媒体文件的最少数量的元数据（名称、作者等）和方法（下载、播放、停止等）。我的具体类将符合此协议并从 NSManagedObject 继承，与 CoreData 一起使用，并使用 mogenerator 创建/修改。

两个问题：

*   我在这里使用接口协议是否偏离了轨道？

*   我是否应该为 Core Data 的每种类型的媒体文件（ITunesPodcast、VimeoVideo、TumblrMP4 等）创建具体的类，因为它们的实现细节会有所不同？或者我应该为 Core Data 使用单个 MediaObject 具体类并使用属性来描述每种媒体类型之间的差异？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T12:44:43.763

埃里克，

协议用于发布来自不同类的一组通用行为。继承做类似的事情。常见的现代 OOP 正统观念是更喜欢使用协议而不是继承。（为什么？继承是应用程序开发和维护生命周期中的一种僵硬机制。YMMV。）

在您的情况下，如果每种媒体类型的常见元数据名称/行为几乎没有重叠，那么协议可能是您的首选路径。

安德鲁

# linux - 使用共享库的问题

> ID：13731089
> 
> 赞同：2
> 
> 时间：2012-12-05T19:39:56.273
> 
> 标签：linux, gcc, ubuntu, shared-libraries, cross-compiling

我正在遵循此页面中的说明，[并且](http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html)此[页面](http://www.yolinux.com/TUTORIALS/LibraryArchives-StaticAndDynamic.html)尝试在 Ubuntu Linux 上构建和使用共享库。

我在我的 PC 上使用交叉编译器构建库和应用程序，而不是将文件复制到目标系统并在那里运行。

最后，我处于正确定义所有符号链接并且我能够运行应用程序的阶段 - 但不是以所需的形式。

假设我`libtest.so.1.0`在目录中有一个共享库`/home/ysap/libs`。然后我创建了符号链接`libtest.so.1`并`libtest.so`在同一个目录中，都指向库文件。

在目录中，我有一个使用该库`/home/ysap/apps`的应用程序。`app.e``test`

现在，要运行应用程序，我可以输入：

```
> LD_LIBRARY_PATH=/home/ysap/libs ./app.e 
```

并且应用程序运行良好。但是，我想消除分配，所以我尝试输入：

```
> export LD_LIBRARY_PATH=/home/ysap/libs
> ./app.e 
```

但不幸的是，我收到一条错误消息，说：

`./app.e: error while loading shared libraries: libtest.so.1: cannot open shared object file: No such file or directory`

我也尝试输入：

```
> ldconfig -n /home/ysap/libs 
```

和

```
> sudo ldconfig -n /home/ysap/libs 
```

但这无济于事。

**我究竟做错了什么？如何让 app.e 在没有变量分配的情况下运行？**

* * *

**更新 1**：

该应用程序使用该`mmap()`调用，因此它必须以*sudo*权限运行。实际的调用行是：

```
> sudo LD_LIBRARY_PATH=/home/ysap/libs ./app.e 
```

*sudo*环境中是否可能`export`没有更新 -ed 变量？

 ** * *

**更新 2**：

输出`ldd ./app.e`：

```
libtest.so.1 => /home/ysap/libs/libtest.so.1 (0xb6faa000)
libgcc_s.so.1 => /lib/arm-linux-gnueabi/libgcc_s.so.1 (0xb6f85000)
libc.so.6 => /lib/arm-linux-gnueabi/libc.so.6 (0xb6ea4000)
/lib/ld-linux.so.3 (0xb6fb7000) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T20:08:47.317

sudo 问题正如@duskwuff 所述，但是如果您要编译应用程序，并且不需要修改 LD_LIBRARY_PATH 变量，则在链接应用程序时可以使用该`$ORIGIN`变量，该变量已被最新版本的 linux 识别。

如果所有库都在当前目录中，那么当您链接应用程序时，您将使用额外选项：

```
-Wl,-R'$ORIGIN' 
```

您需要引用该选项以防止它在编译时被 shell 扩展。

如果您将其放入 a 中，`Makefile`则使用：

```
-Wl,-R\$$ORIGIN 
```

是`$$`为了让 make 使用 $，`\`是为了防止从命令行调用的 shell 在将变量传递给命令之前扩展变量。

您可以使用任何符号路径引用，因此如果您的结构中包含二进制文件`bin/`和库`lib/`，则可以使用`$ORIGIN/../lib`.

这也适用`dlopen`，因此它会在运行时动态加载库时找到它们

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T19:54:18.857

从用户指定的路径加载库存在安全风险，因此`sudo`请始终去除所有`LD_`环境变量，包括`LD_LIBRARY_PATH`.*

# r - R data.frame 字符列的行为不符合预期

> ID：13731095
> 
> 赞同：2
> 
> 时间：2012-12-05T19:40:07.577
> 
> 标签：r

我遇到了 data.frame 的问题。为了使它非常简单，我从

```
 test<-data.frame(char=character(10), numr=numeric(10))
    test$char[1]<-"ery" 
```

结果是

```
 Warning message:In `[<-.factor`(`*tmp*`, 1, value = c(NA, 1L, 1L, 1L, 1L, 1L, 1L,  :
   invalid factor level, NAs generated 
```

如果我这样做，`mode(test$char)`我会得到`[1] "numeric"`

如果我这样做，`mode(test$numr)`我会得到`[1] "character"`

我也可以做到`test$numr[1]<-"fjfj"`没有错误，并且数据存储在那个特定的地方。

如果我不使用设置 data.frame 而不是将`character(10)`所有内容都设置为数字，那么就像前面的示例一样，它将允许我将数字更改为字符，只需将字符串存储到列中的某个内容，即使它以前被定义为数字. 为什么 R 对待字符的方式与我在示例中所期望的不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:04:21.337

我对你上面发布的结果有点怀疑。

```
>     test<-data.frame(char=character(10), numr=numeric(10))
> str(test)
'data.frame':   10 obs. of  2 variables:
 $ char: Factor w/ 1 level "": 1 1 1 1 1 1 1 1 1 1
 $ numr: num  0 0 0 0 0 0 0 0 0 0
> mode(test$char)
[1] "numeric"
> mode(test$numr)
[1] "numeric" 
```

这告诉我这`char`是一个因子，`numr`是数字，并且两者都存储为数字（因子具有将数字级别代码映射到标签的附加属性）。您收到错误是因为您尝试设置的值`char`未包含在级别列表中（仅包含空白字符串`""`）。正如@GSee 在评论中所说，您可能想要`stringsAsFactors=FALSE`：

```
> test<-data.frame(char=character(10), numr=numeric(10), 
                   stringsAsFactors=FALSE)
> str(test)
'data.frame':   10 obs. of  2 variables:
 $ char: chr  "" "" "" "" ...
 $ numr: num  0 0 0 0 0 0 0 0 0 0
> test$char[1] <- "ery" ## no error 
```

您可以将其设置`options(stringsAsFactors=FALSE)`为您的全局默认行为。下次您忘记全局设置此选项时，在方便您自己和混淆之间进行权衡，在 StackOverflow 上提出问题，让每个人都想知道为什么您会得到不同的答案......

最后，正如您上面提到的，如果`char`以数字开头，当您尝试将元素设置为字符值时，R 会默默地将其强制转换为字符串。我认为这实际上是一个非常糟糕的设计，但它已经深深植根于 R 的行为中，现在无法改变......

```
> test<-data.frame(char=numeric(10), numr=numeric(10))
> test$char[1] <- "ery"
> str(test)
'data.frame':   10 obs. of  2 variables:
 $ char: chr  "ery" "0" "0" "0" ...
 $ numr: num  0 0 0 0 0 0 0 0 0 0 
```

# iphone - 重叠视图和手势识别器 iPhone

> ID：13731096
> 
> 赞同：1
> 
> 时间：2012-12-05T19:40:23.253
> 
> 标签：iphone, uiimageview, z-index, uitapgesturerecognizer

我有一个问题 - iPhone 中是否有任何可能让 UITapGestureRecognizer 仅响应 UIImageView 的一部分上的点击。实际上，问题如下 - 有一个带有手势识别器的 UIImageView 添加，并且这些 UIImageView 的某些部分被其他视图覆盖。当点击这个其他视图时，UIImageView 会识别点击。如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T21:28:32.663

我不确定我是否理解你的问题。您是否希望在点击与图像视图重叠的视图时触发手势识别器？如果是这样，我想您可以将手势识别器添加到重叠视图中。

如果您有两个重叠的视图并且只想在重叠部分被触摸时处理触摸，我建议将点击手势识别器添加到主视图并检查是否触摸了重叠。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    UITapGestureRecognizer *gestureRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(tapGestureRecognizerTriggered:)];
    [self.view addGestureRecognizer:gestureRecognizer];
}

- (void)tapGestureRecognizerTriggered:(UITapGestureRecognizer *)gestureRecognizer
{
    CGPoint location = [gestureRecognizer locationInView:self.view];
    if (CGRectContainsPoint(self.frontView.frame, location) &&
        CGRectContainsPoint(self.backView.frame, location))
    {
        // Handle touch
    }
} 
```

如果触摸发生在`CGRectContainsPoint(self.backView.frame, location)`条件语句的前面，则要处理触摸。

# objective-c - 如何找到无意的对象指针比较？

> ID：13731097
> 
> 赞同：5
> 
> 时间：2012-12-05T19:40:27.880
> 
> 标签：objective-c, ios, llvm, compiler-warnings

快速提问 - 有没有一种很好的方法来找到`==`with objects 而不是 的用途`isEqual:`？

全文：

我有一堆这样的代码：

```
typedef long DataKey;

DataKey x;
DataKey y;

if (x == y) {
    // do stuff
} 
```

我现在需要用一个对象替换使用 a `long`for my `DataKey`。创建类并进行大量全局搜索和替换后，我的代码现在有点像这样：

```
@interface DataKey : NSObject

DataKey *x;
DataKey *y;

if (x == y) { // uh-oh - this is now bad
    // do stuff
} 
```

我可以在编译器中启用一个警告，警告在指针中使用标量运算符吗？我将 Xcode 4.5.2 与 LLVM 4.1 编译器一起使用。我一直找不到。

还有其他建议可以帮助修复所有这些代码吗？这不是一个简单的代码库。有数百个源文件需要处理。这是一项重大的重构工作。

编辑：

如果有一个警告，就像在`if`条件中使用赋值而不是比较时一样，那就太好了。你可以得到一个警告并使用括号来停止警告。

更新：

根据评论中的建议，我将`-Weverything`编译器选项添加到测试项目中。将两个对象指针与`==`.

也许可以实现 C++、重载`operator==`方法以及在尝试使用该运算符时获得一些编译器警告/错误的组合。我可能会发布另一个关于此选项的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T21:21:32.673

I'm pretty sure there is no such warning, as comparing pointers for equality is pretty common and not all that commonly done in error. Your best bet will unfortunately be to go through any place DataKeys might be used this way and search for ==. Not very fun, I know.

# python - 多个输出要限制

> ID：13731099
> 
> 赞同：0
> 
> 时间：2012-12-05T19:40:58.733
> 
> 标签：python

这是我当前的代码：

```
while True:
    try:
        username = input("Username: ")

        if len(username) < 8:
            print ("Sorry, the username must be at least 8 characters long.")

        if username.isalnum() == False:
            print ("Sorry, your name can only contain alpha numeric characters")

        numupper = 0

        for c in username:

            if c.isupper() == True:
                numupper += 1

            if numupper > 0:
                print ("You have at least 1 uppercase in this username.")

            else:
                print ("You have no uppercase in this username.")

        numlower = 0

        for d in username:

            if d.islower() == True:
                numlower +=1
            if numlower > 0:
                print ("You have at least 1 lowercase in this username.")

            else:
                print ("You have no lowercase in this username.")

        numdigit = 0

        for e in username:

            if e.isdigit() == True:
                numdigit += 1
            if numdigit > 0:
                print ("You have at least one digit in this username.")

            else:
                print("You have no digits in this username.")

        else:
            print("Please try again")
            continue

    except:
        print ("Sorry, not valid. Try again.")
    else:
        print ("Thank you for your input")
        break 
```

当我使用我的主程序运行这个定义时：

```
import uservalidation

username = input("Username: ")

result, reason = uservalidation.valid_username(username)

if not(result):
    print (reason) 
```

我明白了（取决于我输入了多少个字母）：

```
Username: craig
Sorry, the username must be at least 8 characters long.
You have no uppercase in this username.
You have no uppercase in this username.
You have no uppercase in this username.
You have no uppercase in this username.
You have no uppercase in this username.
You have at least 1 lowercase in this username.
You have at least 1 lowercase in this username.
You have at least 1 lowercase in this username.
You have at least 1 lowercase in this username.
You have at least 1 lowercase in this username.
You have no digits in this username.
You have no digits in this username.
You have no digits in this username.
You have no digits in this username.
You have no digits in this username.
Please try again 
```

如何更改我的代码，使其仅显示诸如“您在此用户名中至少有小写字母”之类的语句一次。非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T19:49:03.830

您的缩进已关闭：

```
for c in username:
    if c.isupper() == True:
        numupper += 1

    if numupper > 0:
        print ("You have at least 1 uppercase in this username.")
    else:
        print ("You have no uppercase in this username.") 
```

因此，对于每个字符，您都在打印错误文本。您想要做的是将检查移动到循环*之外的数字：*

```
for c in username:
    if c.isupper() == True:
        numupper += 1

if numupper > 0:
    print ("You have at least 1 uppercase in this username.")
else:
    print ("You have no uppercase in this username.") 
```

因此，在计算完大写字符后（在循环中），您评估结果并打印一次错误文本。

这同样适用于小写和数字检查。

顺便提一句。您可以对不同的 for 循环使用相同的变量。所以你不需要使用`c`，`d`并且`e`，你可以继续使用`c`。此外，您应该考虑合并循环。在这三个中，您循环遍历用户名的字符，因此您可以同时执行所有操作：

```
numupper, numlower, numdigit = 0, 0, 0

for c in username:
    if c.isupper():
        numupper += 1
    if c.islower():
        numlower +=1
    if e.isdigit():
        numdigit += 1

# and now check numupper, numlower and numdigit 
```

此外，如您所见，我`== True`从 if 条件中删除了。通常将其排​​除在外是一个好习惯，因为`if`已经检查了表达式是否等于 true。所以基本上是多余的。

最后，您可以稍微不同地进行这些检查。例如，您可以通过将字符串转换为相同的字符串并将其与原始文本进行比较来检查大小写字符。So`username.lower() == username`表示其中没有大写字符；同样`username.upper() == username`意味着没有小写字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T19:46:20.740

“字符计数检查”行，如`if numupper > 0:`，位于 for-each-character-in-username 循环内。将它们放在循环之后而不是内部以产生所需的结果。

例如，

```
for c in username:
        if c.isupper() == True:
            numupper += 1
# Now we're outside the loop, because we've de-dented the lines below
if numupper > 0:
    print ("You have at least 1 uppercase in this username.")
else:
    print ("You have no uppercase in this username.") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T19:50:28.147

进行此更改：

```
for c in username:
    if c.isupper() == True:
        numupper += 1

if numupper > 0:
    print ("You have at least 1 uppercase in this username.")
else:
    print ("You have no uppercase in this username.")

numlower = 0

for d in username:
    if d.islower() == True:
        numlower +=1

if numlower > 0:
    print ("You have at least 1 lowercase in this username.")

else:
    print ("You have no lowercase in this username.") 
```

您想要`print`循环之外的语句。

我可能会这样写：

```
hasUpper = any([c.isupper() for c in username])
if hasUpper:
    print ("You have at least 1 uppercase in this username.")
else:
    print ("You have no uppercase in this username.") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T19:50:04.767

如果您不需要大写/小写/数字的计数，则可以跳出 for 循环。像这样：

```
 for d in username:
        if d.islower():
            print ("You have at least 1 lowercase in this username.")
            break
    else:
        # This executes only if the for loop doesn't end because of a break
        print ("You have no lowercase in this username.") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-05T19:55:42.830

如果删除块并用s`try...except`替换循环，则可以大大简化代码：`map()`

```
import string

while True:
    errors = []
    username = input("Username: ")

    if len(username) < 8:
        errors.append("The username must be at least 8 characters long.")

    if len(map(string.isupper, username)) == 0:
        errors.append("You have no uppercase in this username.")

    if len(map(string.isupper, username)) == 0:
        errors.append("You have no lowercase in this username.")

    if len(map(string.isdigit, username)) == 0:
        errors.append("You have no digits in this username.")

    if not username.isalnum():
        errors.append("Your name can only contain alpha numeric characters.")

    if not errors:
        print("Thank you for your input")
        break
    else:
        for error in errors:
            print(error)

        print("Sorry, not valid. Try again.") 
```

# sql - 访问 SQL 查询到 mailmerge

> ID：13731100
> 
> 赞同：0
> 
> 时间：2012-12-05T19:41:00.863
> 
> 标签：sql, ms-access, ms-word, mailmerge

我怎样才能从这个转换这个表

```
id name
1  sam
2  nick
3  ali
4  farah
5  josef
6  fadi 
```

到

```
id1   name1   id2   name2   id3   name3   id4  name4
1     sam     2     nick    3     ali      4   farah
5     josef   6     fadi 
```

我需要这个的原因是我有一个数据库，我需要使用 word 进行邮件合并，我想在一页上每 4 行打印一次，MS word 每页只能打印一行，所以使用 SQL 查询我想要一个行表示 4 行

提前致谢

阿里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:25:56.580

您无需在 Access 中为此创建查询。Word 有一个称为`<<Next Record>>`强制移动到下一条记录的合并字段。如果您查看如何使用“邮件合并向导”创建标签文档，您会发现它是如何完成的。

**更新 - 在 SQL 中执行此操作**

简单`SELECT`语句中的列派生自基础表/查询（或表达式）的列。如果要根据**数据**定义列，则需要使用交叉表查询。

首先为每个人创建一个带有运行计数的查询（例如您的表称为`People`），并根据运行计数计算行和列位置：

```
SELECT People.id, Count(*)-1 AS RunningCount, int(RunningCount/4) AS RowNumber, RunningCount Mod 4 AS ColumnNumber
FROM People 
LEFT JOIN People AS People_1 ON People.id >= People_1.id
GROUP BY People.id; 
```

（您将无法在查询设计器中查看此内容，因为`JOIN`不是与 比较，`=`而是与比较`>=`。）

此查询返回以下结果：

```
id  Rank  RowNumber  ColumnNumber
1   0     0          0
2   1     0          1
3   2     0          2
4   3     0          3
5   4     1          0
6   5     1          1 
```

假设此查询保存为`Positions`，以下查询将返回结果：

```
TRANSFORM First(Item) AS FirstOfItem
SELECT RowNumber
FROM (
    SELECT ID AS Item, RowNumber, "id" &( ColumnNumber + 1) AS ColumnHeading
    FROM Positions

    UNION ALL SELECT Name, RowNumber, "name" & (ColumnNumber +1)
    FROM Positions
    INNER JOIN People ON Positions.id = People.id
) AS AllValues
GROUP BY AllValues.RowNumber
PIVOT AllValues.ColumnHeading In ("id1","name1","id2","name2","id3","name3","id4","name4"); 
```

在`UNION`那里，因此表中的每条记录`People`将有两列 - 一列带有`id`，一列带有`name`。

该`PIVOT`子句将列强制为指定的顺序，而不是按字母顺序（例如`id1`，`id2`... `name1`，`name2`...）

# erlang - 在不同终端窗口上运行 Erlang 程序时出现异常

> ID：13731104
> 
> 赞同：0
> 
> 时间：2012-12-05T19:41:19.277
> 
> 标签：erlang, distributed, distributed-computing

我正在用 Erlang 开发一个简单的框架来处理 2 人回合制游戏。代码如下：

```
-module(game).
-export([start_server/0,generate_server/0,add_player/0,remove_player/0]).

generate_server() ->
Table_num = 0,
Player_num = 0,
io:format("Server generated...~n", []),
io:format("The current number of tables is ~w~n", [Table_num]),
io:format("The current number of players is ~w~n", [Player_num]),
receive
    login ->
        io:format("A new player has connected!~n", []),
        New = Player_num + 1,
        io:format("The current number of players is ~w~n", [New]);
    logout ->
        io:format("You have beeen succesfully disconnected~n", [])
end.

start_server() ->
    io:format("Welcome player!~nInitializing game...~n", []),
    io:format("Generating server...~n", []),
    register(server,spawn(game, generate_server, [])).

add_player() ->
    server ! login.

remove_player() ->
    server ! logout. 
```

运行此代码时有两个主要问题：

1.  当我执行 add_player() 然后 remove_player() 时，第二个函数崩溃并出现异常
2.  如果我在一个终端窗口上启动程序，然后在第二个终端窗口上执行 add_player() ，我会收到错误消息。我应该怎么做才能在多个终端窗口上运行它？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:04:22.200

1/您的服务器中没有循环。当您启动它时，经过一些打印后，它会等待接收语句。

当它收到登录消息时，它执行操作，然后服务器代码完成；该进程死亡并且未注册。所有变量都消失了，VM 清理了内存......

因此，稍后，任何向服务器发送消息的进程都会崩溃，因为您使用的是不再注册的名称。

要使其正常工作，您应该保留一个已连接玩家的列表（例如在列表中）并使用此列表作为参数调用服务器循环。

```
generate_server(Tlist,Plist) ->
io:format("The current number of tables is ~w~n", [length(Tlist)]),
io:format("The current number of players is ~w~n", [length(Plist)]),
receive
    {login,Name} ->
        io:format("A new player ~p has connected!~n", [Name]),
        generate_server(Tlist,[Name|Plist]);
    {logout,Name} ->
        io:format("You have beeen succesfully disconnected~n", []),
        generate_server(Tlist,lists:delete(Name,Plist))
end. 
```

并且对 generate_server 的调用由

```
register(server,spawn(game, generate_server, [[],[]])) 
```

2/ 为了在 2 个不同节点之间使用 erlang 消息，您需要：

*   共享同一个 erlang coockie
*   发现节点（例如使用 netadm）
*   获取服务器 pid 或使用全球注册名称

[请参阅http://learnyousomeerlang.com/distribunomicon#alone-in-the-dark](http://learnyousomeerlang.com/distribunomicon#alone-in-the-dark)上的示例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T05:57:49.047

您错过了`loop`服务器的主体。您的程序崩溃，因为服务器只收到一条消息并退出。考虑下面的另一个版本的服务器：

```
生成服务器（）->
    表数 = 0,
    Player_num = 0,
    io:format("服务器生成...~n", []),
    io:format("当前表数为~w~n", [Table_num]),
    io:format("当前玩家人数为~w~n", [Player_num]),
    环形（[]）。

循环（玩家）->
    收到
        {From,{login,PlayerId}} ->
            io:format("一个新玩家连接了！~n", []),
            io:format("当前玩家人数为~w~n", [New]),
            NewPlayers = 案例列表：成员（PlayerId,Players）
                            真->
                                从 ！{login_failed,exists},
                                球员；
                            假->
                                从 ！{login_success,true},
                                [玩家ID|玩家]
                        结尾，
            循环（新玩家）；
        {From,{logout,PlayerId}} ->
            NewPlayers = 案例列表：成员（PlayerId,Players）
                            真->
                                从 ！{注销，好的}，
                                玩家——[PlayerId]；
                            假->
                                从 ！{注销，失败}，
                                球员
                        结束，
            循环（新玩家）；
        _ -> 循环（玩家）
    结尾。

```

那里; 看起来好多了。

# c# - Linq any - 如何选择

> ID：13731107
> 
> 赞同：4
> 
> 时间：2012-12-05T19:41:35.777
> 
> 标签：c#, .net, linq, entity-framework

我有一些看起来像这样的简单类：

```
Class Favorites
Guid UserId
Guid ObjectId

Class Objects
Guid Id
String Name 
```

使用实体框架，我想选择所有被用户标记为收藏的对象。

所以我尝试了这样的事情

```
context.Objects.Where(
   x => x.Id == 
   context.Favorite.Where(f => f.UserId == UserId)
   .Select(f => f.ObjectId).Any()
); 
```

但我不明白。我也尝试过相交，但我最了解的是同一类型。一个用户可以拥有多个收藏对象

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T19:46:15.247

你可以使用连接子句：

```
context.Favorite
  .Where(f => f.UserId == UserId)
  .Join(context.Objects, t => t.ObjectId, u => u.Id, (t, u) => t); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-05T19:49:35.997

我会加入，我的 linq 看起来像：

```
var matches = from o in context.Objects
join f in context.Favorite on o.Id equals f.ObjectId
where f.UserId == UserId
select o; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T19:48:32.940

```
from o in context.Objects
join f in context.Favorites on o.Id equals f.ObjectId
where f.UserId == @userId
select //whatever you wants 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T19:44:41.720

使用 FirstOrDefault() 而不是 Any()

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-05T19:53:54.360

您的收藏夹类需要一个将其链接回对象的属性，而不是双 where 子句，您可以使用 Include

课程

```
Class Favorites
    Guid UserId
    Guid ObjectId
    [ForeignKey("Id")]
    Objects objs

Class Objects
    Guid Id
    String Name 
```

林克

```
context.Favorites.Include(objs).Where(x => x.UserID == UserID) 
```

然后您的收藏夹对象将在其下有一个对象集合。

# java - Java 将参数化泛型类型作为 valueType 发送

> ID：13731108
> 
> 赞同：2
> 
> 时间：2012-12-05T19:41:37.383
> 
> 标签：java, generics

我有一个返回给定类型的方法：

```
T foo(Class<T> valueType) {...};

String s = foo(Java.lang.String.class); 
```

我正在尝试将泛型类型作为我的类发送，但出现编译器错误。例如，假设我想返回一个字符串的 ArrayList：

```
ArrayList<String> list = foot(ArrayList<String>.class) 
```

参数“String”给出错误。无论如何我可以指定要返回的泛型类型吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T19:46:17.010

运行时`class`字段值不依赖于你应用的泛型类型，这种语法是非法的。更多关于这个[here](http://www.angelikalanger.com/GenericsFAQ/FAQSections/TypeParameters.html#FAQ401)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T22:00:12.570

假设您在这里只关心静态类型，这个技巧可能很有用：

```
@SuppressWarnings("unchecked")
public static <T>
Class<T> appropriateClass(T... args) {
    return (Class<T>) args.getClass().getComponentType();
}

Class<ArrayList<String>> c = appropriateClass();
ArrayList<String> list = foo(c); 
```

其实我对这个把戏并不感到骄傲。但你可能想试一试。

如果你测试它：

```
System.out.println(c); // prints "class java.util.ArrayList" 
```

所以它相当于一个丑陋的演员像`(Class<ArrayList<String>>) (Class<?>) ArrayList.class`。

如果您确实需要在运行时使用不同的令牌`ArrayList<String>`，`ArrayList`您应该使用`TypeToken`Sean Patrick Floyd 提到的技术。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T22:20:39.113

Type Erasure 抬起了丑陋的脑袋。本质上，Java 对通用`<…&gt;`子句进行编译时检查，然后将它们从运行时对象中*删除，从而永远丢失信息。*恶心，嗯？由于`.class`元对象在运行时被引用，它们也遭受擦除。

`ArrayList<String>.class`在编译时被擦除，为`ArrayList.class`.

如果你想要泛型的类型安全，你必须传入两个参数，例如

`ArrayList<String> foo = foot(ArrayList.class, String.class)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T19:47:32.643

这对你有用吗（已编辑）？

```
ArrayList list = foot(ArrayList.class) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-05T22:43:17.203

只需转换方法的输入或输出：

```
ArrayList<String> list = foot((Class<ArrayList<String>>)(Class<?>)ArrayList.class); 
```

或者

```
ArrayList<String> list = (ArrayList<String>)foot(ArrayList.class); 
```

基本上，`Class`该类不适用于泛型，因为它代表运行时事物，而泛型则在编译时工作。在运行时，程序中只有一个类对象`ArrayList`。即使你称它为`Class<ArrayList<String>>`or `Class<ArrayList<Integer>>`or `Class<ArrayList>`，它仍然是同一个对象。那么它应该是什么类型的呢？没有适用于所有事情的简单答案。

Java 语言决定类文字`ArrayList.class`应该只有 type `Class<ArrayList>`。但是当你想要一个类型的表达式时，这会导致问题`Class<ArrayList<String>>`，所以你必须改变类型。

# xpath - javascript的xpath查询

> ID：13731109
> 
> 赞同：0
> 
> 时间：2012-12-05T19:41:40.773
> 
> 标签：xpath

```
<script type="text/javascript">
    jwplayer('mediaspace').setup({
    'flashplayer': 'http://www.vidok.co/s-static/v2/player-sp.swf',
    'file': 'http://www.vidok.co/cfs-ak-snc6/2012-12-17457.mp4',
    'image': '',
    'logo': 'www.vidok.co/s-static/rsrc.php/logo-player-sp.png',
    link': 'http://www.facefou.co/videos/watch-TqcLqlKBd2'
});
</script> 
```

嗨，我需要 xpath 查询才能从此脚本中获取“文件：http: [//www.vidok.co/cfs-ak-snc6/2012-12-17457.mp4 ”。](http://www.vidok.co/cfs-ak-snc6/2012-12-17457.mp4)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T22:28:23.130

这是一种方法：

```
"substring-before(substring-after(/script, '&apos;file&apos;: '),
                    '&apos;image&apos;')" 
```

如果您真的想要“文件：”开头，请使用`concat('file : ', theaboveexpression)`.

但如果你问我，XPath 并不是完成这项工作的最佳工具。

最好使用正则表达式之类的东西来解析 Javascript。

# java - javax.el.PropertyNotFoundException：在类型 java.lang.String 上找不到属性“rollno”

> ID：13731111
> 
> 赞同：2
> 
> 时间：2012-12-05T19:41:46.243
> 
> 标签：java, jakarta-ee

我浏览了许多有关此异常的链接。不知道是action类有问题还是jsp有问题。

我的 DAO 是：

```
 {
            ReleaseData releaseData = new ReleaseData();
            releaseData.setRollno(resultSet.getInt("rollno"));
            releaseData.setName(resultSet.getString("name"));
            releaseData.setAge(resultSet.getInt("age"));
            myDataList.add(releaseData);
            System.out.println("the List has---"+myDataList);
        } 
```

我的 Servlet 是：

```
 public class DisplayServlet extends HttpServlet
          {
                public void doGet(HttpServletRequest request ,HttpServletResponse  response) throws ServletException,IOException
{
    List<ReleaseData> myDataList = new ReleaseDataDAO().getReleaseData();
    request.setAttribute("myDataList", myDataList);
    request.getRequestDispatcher("/showData.jsp").forward(request, response);
}
} 
```

这是我的jsp：

```
<c:forEach items="$(myDataList)" var="data">
             <tr>
               <td>${data.rollno}</td>
                 <td>${data.name}</td>
                <td>${data.age}</td>

              </tr>
             </c:forEach> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T19:53:06.843

嗯，我刚刚注意到，您使用的是，`$()`而不是`${}`jsp 不是 jQuery ：P 这`$(myDataList)`不是被解释为 EL 表达式并成为字符串，而是这样做：`${myDataList}`

还：

您需要创建 getter 和 setter 方法，在您提供的代码中，我可以看到一个 set 方法来 rollno 但没有 get 方法，它们也必须是公共的

```
public class ReleaseData{
    private int rollno = 0;
    private String name = "";
    private int age = 0;

    public int getRollno(){ return rollno; }
    public void setRollno(int rollno){ this.rollno = rollno; }

    public int getAge(){ return age; }
    public void setAge(int age){ this.age= age; }

    public String getName(){ return name; }
    public void setName(String name ){ this.name = name; }

} 
```

此外，逃避任何可以由人类输入的数据总是很好的。

```
<c:forEach items="${myDataList}" var="data">
 <tr>
   <td><c:out value="${data.rollno}" /></td>
     <td><c:out value="${data.name}" /></td>
    <td><c:out value="${data.age}" /></td>

  </tr>
 </c:forEach> 
```

# d - 为什么空类 8 字节和更大的类总是 > 8 字节？

> ID：13731112
> 
> 赞同：7
> 
> 时间：2012-12-05T19:41:47.103
> 
> 标签：d

```
class foo { }

writeln(foo.classinfo.init.length); // = 8 bytes 
```

* * *

```
class foo { char d; }

writeln(foo.classinfo.init.length); // = 9 bytes 
```

d 实际上是否在这 8 个字节中存储了任何内容，如果是，是什么？这似乎是一种巨大的浪费，如果我只是包装一些值类型，那么该类会使程序显着膨胀，特别是如果我使用了很多它们。char 变大 8 倍，而 int 变大 3 倍。

结构的最小大小为 1 个字节。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-05T20:19:50.187

在 D 中，对象有一个包含 2 个指针的标头（因此它可能是 8 字节或 16 字节，具体取决于您的架构）。

第一个指针是虚方法表。这是一个由编译器生成的填充了函数指针的数组，因此可以进行虚拟调度。同一个类的所有实例共享同一个虚方法表。

第二个指针是监视器。它用于同步。不确定该字段是否永远保留在这里，因为 D 强调本地存储和不变性，这使得许多对象上的同步毫无用处。由于此字段比这些功能更早，因此它仍然存在并且可以使用。但是，它可能会在未来消失。

对象上的此类标头非常常见，例如，您会在 Java 或 C# 中找到相同的标头。您可以在这里查看更多信息：[http ://dlang.org/abi.html](http://dlang.org/abi.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-05T20:19:54.387

D 在每个类实例中使用两个机器词：

1.  指向虚函数表的指针。这包含虚拟方法的地址。第一个入口指向类的[classinfo](http://dlang.org/property.html#classinfo)，动态转换也使用它。

2.  允许`synchronized(obj)`语法的监视器记录[在这里](http://dlang.org/statement.html#SynchronizedStatement)。

这些字段在[此处](http://dlang.org/class.html)（向下滚动到“类属性”）和[此处](http://dlang.org/abi.html)（向下滚动到“类”）的 D 文档中进行了描述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T19:50:46.887

我不知道 D 的细节，但是在 Java 和 .net 中，每个类对象都包含有关其类型的信息，并且还包含有关它是否是任何监视器锁的目标、是否有资格进行终结清理以及各种其他事情。拥有所有对象存储此类信息的标准方法可以使语言和/或框架的用户和实现者在许多事情上更加方便。顺便说一句，在 .net 的 32 位版本中，每个对象的开销为 8 个字节，但最小对象大小为 12 个字节。这个最小值源于这样一个事实，即当垃圾收集器移动对象时，

**编辑** 如果你想使用一个类，因为你需要能够持久化对数据项的引用，空间是非常宝贵的，并且你的使用模式是这样的，你会知道数据项何时仍然有用以及何时过时，您可以定义一个结构数组，然后将索引传递给数组元素。可以编写代码来非常有效地处理这个问题，而且开销基本上为零，前提是您的程序结构允许您确保每个被分配的项目都只被释放一次，并且一旦被释放就不会被使用。

如果您无法轻易确定对对象的最后一个引用何时超出范围，那么 8 个字节将是一个非常合理的开销水平。我希望大多数框架会强制对象在 32 位边界上对齐（所以我很惊讶添加一个字节会将大小推到九而不是十二）。如果一个系统将有一个比 Commodore 64(*) 工作得更好的垃圾收集器，那么每个对象需要绝对最小的一点开销来指示哪些东西被使用，哪些东西没有被使用。此外，除非想要为可以包含补充信息的对象和不能包含补充信息的对象设置单独的堆，否则每个对象要么包含用于补充信息指针的空间，要么包含用于所有补充信息的空间（锁定、放弃通知请求等）。虽然在某些情况下为两类对象设置单独的堆可能是有益的，但我怀疑这些好处通常会证明增加的复杂性是合理的。

(*) Commodore 64 垃圾收集器通过从内存顶部向下分配字符串来工作，而变量（未经过 GC 处理）是自下而上分配的。当内存已满时，系统将扫描所有变量以查找对存储在最高地址的字符串的引用。然后该字符串将被移动到内存的最顶部，并且对它的所有引用都将被更新。然后，系统将扫描所有变量以在它刚刚移动的地址下方的最高地址处找到对字符串的引用，并更新对该字符串的所有引用。该过程将重复，直到找不到更多要移动的字符串为止。该算法不需要将任何额外的数据与字符串一起存储在内存中，但它当然很慢。Commodore 128 垃圾收集器与 GC 空间中的每个字符串一起存储一个指向变量的指针，该变量包含一个引用和一个长度字节，可用于在 GC 空间中查找下一个较低的字符串；因此，它可以检查每个字符串以确定它是否仍在使用，如果是，则将其重新定位到内存的顶部。快得多，但代价是每个字符串需要三个字节的开销。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-05T19:50:57.523

您应该查看各种类型的存储要求。每条指令、存储分配（即：变量/对象等）都会占用特定数量的空间。在 c# 中，一个 Int32 类型的整数对象应该以 4 个字节（32 位）的形式存储整数信息。它也可能有其他信息，因为它是一个对象，但您的字符数据类型可能只需要 1 个字节的信息。如果你在课堂上有类似 for 或 while 的结构，这些东西也会占用空间，因为这些东西中的每一个都在告诉你的班级做某事。类本身需要在内存中创建许多指令，这将占 8 个初始字节。

参加汇编语言课程。您将了解所有您想知道的内容，然后了解为什么您的程序在编译时会使用多少内存或占用多少存储空间。

# objective-c - 监视目录时 dispatch_source_get_data 不返回正确的标志

> ID：13731114
> 
> 赞同：0
> 
> 时间：2012-12-05T19:41:57.930
> 
> 标签：objective-c, ios, ipad, ios5, ios6

有人可以告诉我这段代码不起作用吗？在 iOS 6.0 中监视应用程序文档目录时，它总是返回**DISPATH_VNODE_WRITE 。**(iPad) 下面是我的代码。无论文件被删除、重命名或添加，它总是返回 0x2 :(。这是因为它是我正在监视的目录吗？不是文件！！！有什么办法可以找出导致目录发送通知的原因?

```
int directoryFileDescripter = open([documentDirectory UTF8String], O_EVTONLY);

if (directoryFileDescripter < 0) {
    NSLog(@"Couldn't obtain file descripter from the system.");
    return;
}

dispatch_queue_t mainQueue = /*dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);*/dispatch_get_main_queue();
if (mainQueue == NULL) {
    NSLog(@"Couldn't obtain mainQueue from the system.");
    close(directoryFileDescripter);
    return;
}

dispSource = dispatch_source_create(DISPATCH_SOURCE_TYPE_VNODE, directoryFileDescripter, DISPATCH_VNODE_WRITE | DISPATCH_VNODE_DELETE | DISPATCH_VNODE_RENAME, mainQueue);
if (dispSource == NULL) {
    NSLog(@"Couldn't obtain dispatch source for directory from the system.");
    close(directoryFileDescripter);
    return;
}

dispatch_source_set_event_handler(dispSource, ^{

    NSLog(@"directory notification received.");
    int fileDes = dispatch_source_get_handle(dispSource);
    unsigned long mask = dispatch_source_get_data(dispSource);
    char path[PATH_MAX] = {0};
    int nRes = fcntl(fileDes, F_GETPATH, &path);
    if (nRes < 0) {
        return;
    }
if (mask & DISPATCH_VNODE_WRITE) {
        NSLog(@"A file has been written.");
    }

if (mask & DISPATCH_VNODE_DELETE) {
        NSLog(@"A file has been deleted.");
}

if (mask & DISPATCH_VNODE_RENAME) {
        NSLog(@"A file has been renamed.");
}
});

dispatch_source_set_cancel_handler(dispSource, ^{
    close(directoryFileDescripter);
});

dispatch_resume(dispSource); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T18:22:00.750

你对“为什么”是正确的。当文件被创建、重命名或删除时，目录会被修改。您正在查看目录，因此您会收到“WRITE”事件。

我通常会通过在每次将目录标记为已写入时重新扫描目录并自己记录更改来处理此问题。如果您不担心目录本身移动或被删除，您可以只关注 WRITE 事件。

您当然也可以查看每个文件的 VNODE，但我希望这对于此类问题的实现会更加复杂。

# lucene - 如何仅建议单个单词但索引短语

> ID：13731115
> 
> 赞同：0
> 
> 时间：2012-12-05T19:41:59.063
> 
> 标签：lucene, lucene.net, spell-checking

我现在有麻烦。我正在使用 ShingleAnalyzerWrapper 来索引短语。但我需要拼写检查器只建议我一个单词。

我如何索引短语但使用 SpellChecker 搜索短语和单个单词？

请给点建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T21:33:46.370

[为您的ShingleAnalyzerWrapper](http://lucene.apache.org/core/3_6_0/api/all/org/apache/lucene/analysis/shingle/ShingleAnalyzerWrapper.html#ShingleAnalyzerWrapper%28org.apache.lucene.analysis.Analyzer,%20int,%20int,%20java.lang.String,%20boolean,%20boolean%29)使用此构造函数

```
ShingleAnalyzerWrapper(Analyzer defaultAnalyzer, 
                       int minShingleSize, 
                       int maxShingleSize, 
                       String tokenSeparator, 
                       boolean outputUnigrams, 
                       boolean outputUnigramsIfNoShingles) 
```

`true`作为第五个参数（outputUnigrams）传递。无论您的 minSingleSize 是什么，这都会索引所有单个标记。如果您当前的 minShingleSize 为 2，您只需将其降低到 1 即可获得相同的结果。

# iframe - Rails RSpec 脚本无法识别元素（更新：因为它们在 iframe 中）

> ID：13731116
> 
> 赞同：2
> 
> 时间：2012-12-05T19:41:59.257
> 
> 标签：iframe, selenium-webdriver, rspec-rails, automated-tests

我是新手`Rails`，`Selenium`但使用过其他自动化测试工具。

我将一个脚本从 Selenium 2 IDE 导出到 Rails/RSpec，并正在修改代码以使其运行。该脚本无法找到特定链接。

从工作 IDE 脚本导出的原始 Ruby 代码是：

```
@driver.find_element(:link, "skip").click 
```

这失败了，所以我尝试使用 XPath 语句来识别元素。**（在我使用 XPath修复**的原始导出代码中还有其他元素失败，这就是我使用此策略的原因。）

我尝试了不同的替代方法来识别 Ruby 代码中的链接，例如：

尝试#1：`@driver.find_element(:XPath, "//*[@class='skip-link']").click`

尝试#2：`@driver.find_element(:XPath, "//*[@value='skip']").click`

所有情况下的结果：`Unable to locate element: {"method":"link text","selector":"skip"}`

每个 Firebug 报告的 HTML：

```
<a style="float: right; margin-right: 10px; text-decoration: none;" href="/yourfuture" class="skip-link"> skip </a> 
```

每个 Firebug 报告的 XPath：

```
/html/body/div[2]/div[2]/div/div/div[3]/div[4]/a 
```

我将超时设置为 60 秒，并且在脚本失败之前看到链接**跳过**显示了几秒钟，所以我不认为这是一个问题。

一个可能相关的事实：当应用程序显示包含所有控件的窗口时，最初不会出现**跳过。**根据程序设计，应用程序会在大约 5 秒之前等待。

我究竟做错了什么？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T19:58:21.230

原来没有看到的链接在 iFrame 中。iframe 的属性发生了变化，因此很难用静态属性来识别它，所以我只是在 Webdriver 无法“看到”的行之前插入了以下代码行：

```
@driver.switch_to.frame(0) 
```

`@driver.switch_to.frame("iframe-identifier-per-swtich")`如果有识别 iframe 的可靠方法，我也可以使用。

是的，你可能知道，但也许这会帮助另一个新手避免同样的问题。

# javascript - Coldfusion url 变量

> ID：13731119
> 
> 赞同：2
> 
> 时间：2012-12-05T19:42:12.733
> 
> 标签：javascript, coldfusion

我在这里有一个基本问题无法正确解决......我有一个 ColdFusion 表格 abc.cfm 并提交帖子到

```
<form name="MyForm" 
      method="post" 
      action="abc_action.cfm?vempnum=
                   <cfoutput>#qGetemplookup.emplid#&year=#form.year#</cfoutput>" 
```

现在我有一个文本框和一个选择框，我可以`emplid`在 url 中获取操作页面上的值，但无法获取年份（这是选择框值）......不知道我在做什么这里错了。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:03:24.173

当页面呈现到屏幕上时，ColdFusion 呈现动作。因此，`#form.year#`正在填充页面加载时设置的任何内容。

您通过 POST 方法提交，因此在处理页面 ( ) 收到表单提交`form.year`时会自动填充。`abc_action.cfm`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T20:08:07.490

`form.year`如果我正确理解了这个问题，那么您会在实际提交存在输入的表单之前尝试访问`year`。这将不起作用，因为`form`只有在实际提交表单后才会填充范围。

尝试添加`form.year`到操作的 URL 实际上是多余的，因为当您发布表单时，选择的值`year`将作为`form`结构的一部分提供给您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T19:56:12.937

Wrap your form tag with `CFOUTPUT` and place the variable in there.

For example:

```
<cfoutput>
<form name="MyForm" method="post" action="abc_action.cfm?vempnum=#qGetemplookup.emplid#&year=#form.year#">
</form>
</cfoutput> 
```

# javascript - Javascript createElement，修改输出

> ID：13731121
> 
> 赞同：2
> 
> 时间：2012-12-05T19:42:19.667
> 
> 标签：javascript, jquery, html

我为我的网站下载了一个 livesearch JavaScript 插件，它可以正常工作，但我需要帮助对其进行一些修改。

这是代码：

```
 $.ajax({url: $('base').attr('href') + 'index.php?route=product/search/ajax&keyword=' + keywords, dataType: 'json', type: 'GET', success: function(result) {
    if( result.length > 0 ) {
        var eList = document.createElement( 'ul' );
        eList.id = 'livesearch_search_results';
        var eListElem;
        var eLink;
        var eHref;
        for( var i in result ) {
            eListElem = document.createElement( 'li' );
            eLink = document.createElement( 'a' );
            if( result[i].img != null ) {
                var eImg = document.createElement( 'span' );
                eImg.className = "img_container";
                var img = new Image();
                img.src = result[i].img;
                eImg.appendChild( img );
            }
            else {
                eImg = document.createElement( 'span' );
                eImg.innerHTML = '&nbsp;';
            }
            eDiv = document.createElement( 'div' );
            eLink.appendChild( document.createTextNode(result[i].name) );
            if( typeof(result[i].href) != 'undefined' ) {
                eHref = result[i].href;
            }
            else {
                eHref = $('base').attr('href') + 'index.php?route=product/product&product_id=' + result[i].product_id + '&keyword=' + keywords;
            }
            eLink.href = eHref;
            eDiv.appendChild( eLink );
            eDiv.innerHTML = eDiv.innerHTML + result[i].desc;
            eListElem.appendChild( eImg );
            eListElem.appendChild( eDiv );
            eListElem.appendChild( document.createElement('br') );
            eListElem.setAttribute( 'rel', eHref );
            $(eListElem).bind('click', function(){
                var gto = $(this).attr( 'rel' );
                try {
                    if( gto != false && gto.length > 0 ) {
                        document.location = gto;
                    }
                }
                catch( e ) {}
            });
            eList.appendChild( eListElem );
        }
        if( $('#livesearch_search_results').length > 0 ) {
            $('#livesearch_search_results').remove();
        }
        $('#search_menu').append(eList);
    }
}}); 
```

输出是这样的（不带`<ul>`）：

```
 <li rel="http://url">
  <span class="img_container">
    <img src="http://url.jp">
  </span>
  <div>
    <a href="http://url">MONS 1.0 (CTM 2013)</a>
    Description...</div>
  <br>
  </li> 
```

有没有办法将输出修改为：

```
 <li rel="http://url">
  <a href="http://url">           <---- <a> tag here
  <span class="img_container">
    <img src="http://url.jp">
  </span>
  <span class="product-container">    <------ <span> tag here
    <span class="title">MONS 1.0 (CTM 2013)</span> <------ <span> tag here, remove <a> tag
    <span class="description">Description...</span> <------ <span> tag here
  </div>
  </a>
  </li> 
```

这超出了我的 JS 知识范围。

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:19:01.453

在严重的免责声明中，这是未经测试的，我会说*是*的！

代码被整齐地划分，易于阅读，让我们保持这种精神。

在顶部，我们看到以下内容：

```
var eList = document.createElement( 'ul' );
eList.id = 'livesearch_search_results';
var eListElem;
var eLink;
var eHref; 
```

这些变量已声明但未定义。它们将被一遍又一遍地用于构建每个`<li>`. 我们正在移动链接 ( `eLink`) 以便我们可以保留它，但我们也将 a 更改`<div>`为 a `<span>`，并添加了几个其他元素；即产品容器、标题和描述。让我们为这些变量添加一些变量，而我们在这里（原作者似乎没有在这里定义，无论如何`eDiv`我们将用 替换它）：`ePCont`

```
var eList = document.createElement( 'ul' );
eList.id = 'livesearch_search_results';
var eListElem;
var eLink;
var eHref;
var ePCont, eTitle, eDesc; 
```

下一步是双重的。

首先我们看到一堆`document.createElement`s（一些在 if 语句中，一些不是）。 `document.createElement`创建指定类型的新 DOM 元素。它不会*将*元素添加到文档中，它只是构建它的一个实例，因此它们的创建顺序无关紧要。这将我们带到第二部分： `[element].appendChild([element])`将树中的一个元素放在另一个元素之下。如果该树中的某个元素属于该文档，则会显示该元素。这意味着首先我们将创建一系列对象，然后将它们相互添加，最后将最顶层的元素添加到文档中。

我们将彻底重写这段代码的大部分，但第一部分（通过创建图像的位置）就可以了：

```
 eListElem = document.createElement( 'li' );
        eLink = document.createElement( 'a' );
        if( result[i].img != null ) {
            var eImg = document.createElement( 'span' );
            eImg.className = "img_container";
            var img = new Image();
            img.src = result[i].img;
            eImg.appendChild( img );
        }
        else {
            eImg = document.createElement( 'span' );
            eImg.innerHTML = '&nbsp;';
        } 
```

下一行定义了我们现在调用的容器 div `ePCont`，让我们适当地重写它（并给它一个类）：

```
ePCont = document.createElement( 'span' );
ePCont.className = "product-container"; 
```

THAT 之后的行在链接中放置了一些文本。我们将一个元素放入其中，因此我们可以安全地删除它，但*之后*的 if 语句（确保我们将使用犹太 url）保持：

```
 if( typeof(result[i].href) != 'undefined' ) {
            eHref = result[i].href;
        }
        else {
            eHref = $('base').attr('href') + 'index.php?route=product/product&product_id=' + result[i].product_id + '&keyword=' + keywords;
        }
        eLink.href = eHref; 
```

最后，让我们创建两个新的 span：

```
eTitle = document.createElement( 'span' );
eDesc = document.createElement( 'span' ); 
```

并填充它们：

```
eTitle.appendChild( document.createTextNode(result[i].name) );
eDesc.appendChild( document.createTextNode(result[i].desc) ); 
```

并设置他们的课程：

```
ePCont.className = "title";
ePCont.className = "description"; 
```

现在是时候将所有内容附加到其他所有内容上。我们将从最低的元素开始，然后向上工作。

```
ePCont.appendChild(eTitle);
ePCont.appendChild(eDesc);
eLink.appendChild(eImg);
eLink.appendChild(ePCont);
eListElem.appendChild(eLink); 
```

文档的其余部分应该或多或少地像它那样流动：

```
 eListElem.setAttribute( 'rel', eHref );
    $(eListElem).bind('click', function(){
        var gto = $(this).attr( 'rel' );
        try {
            if( gto != false && gto.length > 0 ) {
                document.location = gto;
            }
        }
        catch( e ) {}
    });
    eList.appendChild( eListElem );

    ... 
```

同样，完全未经测试，但我希望我的描述能让您对该插件的工作原理有足够的了解，以便解决它！

# backbone.js - 了解backbone.geppetto

> ID：13731124
> 
> 赞同：3
> 
> 时间：2012-12-05T19:42:28.960
> 
> 标签：backbone.js, marionette, robotlegs, backbone.geppetto

关于[backbone.gepetto](https://github.com/ModelN/backbone.geppetto)插件的一些问题

1.  我有一个布局和一些内部视图。如何将视图生成的事件传递给布局？layout:onRender 中的实例视图，将 parentContext 传递给 view，并使用 this.context.dispatchToParent 向 layout 发送消息或监听 layout 中的 view.context 事件？什么策略更好：父母听孩子或孩子向父母发送事件（说，渲染我）？

2.  在 geppetto 示例中，我看到每个视图只有一个上下文，但没有看到多个视图的一个上下文，如何在小部件之间共享代码和数据？

3.  何时使用 dispatch、dispatchToParent、dispatchGlobally ？

4.  上下文的主要思想是什么？没有上下文，小部件可以监听事件，可以将它们发送给父级或父级可以像上下文一样监听它们，有什么区别？

5.  如何确定上下文中应该有什么逻辑以及视图项中应该有什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T05:26:45.300

Geppetto 的作者，在这里。我已经在 GitHub 存储库问题列表中回答了这个问题。见这里：[https ://github.com/ModelN/backbone.geppetto/issues/5#issuecomment-11155226](https://github.com/ModelN/backbone.geppetto/issues/5#issuecomment-11155226)

# c++ - fstream 运算符 << & 运算符 >> 有什么问题？

> ID：13731126
> 
> 赞同：0
> 
> 时间：2012-12-05T19:42:46.850
> 
> 标签：c++

我需要将一个 int 序列化为本地文件并将其读入内存。这是代码

```
#include "stdafx.h"
#include <iostream>
#include <fstream>
using namespace std;
int _tmain ( int argc, _TCHAR* argv[] )
{
    ofstream fileout;
    fileout.open ( "data,txt" );
    fileout << 99999999;
    fileout << 1;
    cout << fileout.tellp() << endl;
    fileout.flush();
    fileout.close();
    ifstream fileint;
    fileint.open ( "data,txt" );
    int i, a;    
    fileint >> i >> a;   //i != 99999999   a!= 1 WHY?
    cout << fileint.tellg() << endl;
    return 0;
} 
```

但它不能正常工作，我无法得到 i==99999999 或 a==1。那有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T19:49:08.383

问题是它`operator <<`不是`operator >>`对偶的——`operator <<`直接输出没有填充或分隔符的东西，同时`operator >>`解析空格分隔的输入。因此，您需要在输出中的内容之间手动添加空格分隔符以使其正确回读。您也不能输出包含空格的内容并期望它们正确回读。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-05T19:48:29.180

也许`fileout << 99999999 << ' ' << 1;`会奏效。

# ruby-on-rails - Rails 创建仅 json 的 api 和路由

> ID：13731130
> 
> 赞同：3
> 
> 时间：2012-12-05T19:42:54.643
> 
> 标签：ruby-on-rails, api, routes

我正在向现有应用程序添加一个 api。

我创建了一个控制器“api”并使用 rabl 来处理我的视图并返回 json。

理想情况下，我希望路线是这样的：（我们有一个用户控制器和模型设置）。

/api/users/show.json?id=1 等...

我有 api/index.json 工作并返回我的 rabl 模板，但我似乎无法让 /api/users/show.json 做任何事情

我设置了这个：

```
scope "/api" do
  resources :users
end 
```

但这会从“/api/users”重定向到“/users/new”

我想保留 api 部分中的所有内容，而不必在视图/用户或用户控制器中混合我的 rabl 模板。

感谢您可能对此有所了解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T19:48:43.243

我不确定我是否遇到了您的问题，但我认为您的路线可能是错误的。

它应该是这样的

```
/api/users/1.json 
```

# android-layout - 指定的孩子已经有一个父母。你必须调用 removeView()

> ID：13731131
> 
> 赞同：-1
> 
> 时间：2012-12-05T19:42:55.943
> 
> 标签：android-layout, android-view

出于某种原因，我不断收到以下错误：

> java.lang.IllegalStateException：指定的孩子已经有一个父母。您必须在孩子的父视图上调用 removeView()

我正在使用以下代码：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.listitem);
    //url is fetched from another class
    readWebpage(imdbUrl);
}

private class DownloadWebPageTask extends AsyncTask<String, Void, String> {
    @Override
    protected String doInBackground(String... urls) {

    }

    @Override
    protected void onPostExecute(String result) {
        //textView.setText(result);
        displayMoviesList(result);
    }
}

public void readWebpage(String imdbUrl) {
}

public void displayMoviesList(String result) {
    JSONObject responseObj = null; 
    try {
        responseObj = new JSONObject(result);
        JSONObject Obj = responseObj.getJSONObject("results");
        JSONArray moviesListObj = Obj.getJSONArray("result");

        for(int i=0 ;i<moviesListObj.length();i++) {
            JSONObject e = moviesListObj.getJSONObject(i);
            cover[i] = e.getString("cover");
            title[i] = e.getString("title");
            year[i] = e.getString("year");
            director[i] = e.getString("director");
            rating[i] = e.getString("rating");
            details[i] = e.getString("details");
        }

        tl = (TableLayout) findViewById(R.id.main_table);
        imgView = (ImageView)findViewById(R.id.imageID);
        progressbar = (ProgressBar) findViewById(R.id.loadingBar);
        //new loadImageTask().execute(cover[i].toString());
        new loadImageTask().execute( URL);// it calls another function..
        TextView title = (TextView)findViewById(R.id.titleID);
        title.setText("TEXT");
        TableRow tr = new TableRow(this);
        tr.addView(imgView);
        tr.addView(title);
        tl.addView(tr, new TableLayout.LayoutParams(LayoutParams.WRAP_CONTENT,     LayoutParams.WRAP_CONTENT));
    } catch(JSONException e) {
        //Log.e("log_tag", "Error parsing data " + e.toString());
    } 
```

我不确定为什么我会收到错误，但它似乎是在我将它添加到视图时生成的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T06:40:45.647

解决方案是我们要么在 .xml 文件中定义行，要么在 .java 文件中定义行。我在我的java文件中动态添加行并使用addView。所以在 .xml 文件中我们不能添加另一个视图（我们不应该添加相同的行）。

# css - 可调整大小的图表

> ID：13731132
> 
> 赞同：0
> 
> 时间：2012-12-05T19:42:56.740
> 
> 标签：css, jqplot

我有一个条形图（jqplot）。无论屏幕分辨率如何，如何让它填满整个屏幕？像这个：[https://www.desmos.com/calculator](https://www.desmos.com/calculator)。当窗口改变时，它会自动调整图表的大小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:36:09.153

对我有用的是这个（改编自[http://www.jqplot.com/deploy/dist/examples/area.html](http://www.jqplot.com/deploy/dist/examples/area.html)）：

```
<!DOCTYPE html>
<html>
<head>    
    <title>Filled (Area) Charts</title>

    <script class="include" type="text/javascript" src="../jquery.min.js"></script>
    <script class="include" type="text/javascript" src="../jquery.jqplot.min.js"></script>
    <script class="include" type="text/javascript" src="../plugins/jqplot.categoryAxisRenderer.min.js"></script>

    <script language="javascript" type="text/javascript">
        $(document).ready(function(){
            var l2 = [11, 9, 5, 12, 14];
            var l3 = [4, 8, 5, 3, 6];
            var l4 = [12, 6, 13, 11, 2]; 

            var plot = $.jqplot('chart1b',[l2, l3, l4],{
               stackSeries: true,
               showMarker: false,
               seriesDefaults: {
                   fill: true
               },
               axes: {
                   xaxis: {
                       renderer: $.jqplot.CategoryAxisRenderer,
                       ticks: ["Mon", "Tue", "Wed", "Thr", "Fri"]
                   }
               }
            });

            resizePlot(plot);

            $(window).bind('resize', function(event, ui) {
                resizePlot(plot);
            });
        });

        function resizePlot($plot) {
            $($plot.targetId).height($(window).height() * 0.75);
            $plot.replot( { resetAxes: true } );
        }
    </script>
</head>
<body>
    <div class="example-content">
        <div id="chart1b"></div>
    </div>
</body>
</html> 
```

关键是将处理程序绑定`resize`到`window`. 有了这个，您可以获得窗口的大小，进而修改绘图容器的高度。我们需要以这种方式修改高度，因为`resize`事件似乎只影响绘图的宽度。

我在这里的示例将绘图设置为窗口高度的 75% - 您需要对其进行调整以满足您的要求。

# c++ - OpenGL 裁剪空间截锥体剔除错误结果

> ID：13731133
> 
> 赞同：2
> 
> 时间：2012-12-05T19:42:57.667
> 
> 标签：c++, opengl, glm-math

我在 CPU 上实现了 Clip-Space Frustum Culling。在一个简单的简化案例中，我只是创建了一个基于 4 个不同点的矩形，我将在 GL_LINES 模式下进行渲染。

但有时，在我看来，我得到了错误的结果。这是一个例子：

[![](../Images/12a9305a578585471cb6469e20c8207f.png)](https://web.archive.org/web/20160225080311/http://s7.directupload.net/images/121205/imawbhoh.png)

在这个渲染过程中，我的平截头体剔除计算检测到，所有点都将在 NDC 坐标中的正 y 坐标之外。

这是输入：

要点：

```
P1: -5000, 3, -5000
P2: -5000, 3,  5000
P3:  5000, 3,  5000
P4:  5000, 3, -5000 
```

MVP（四舍五入）：

```
 1.0550   0.0000  -1.4521   1138.9092
 -1.1700   1.9331  -0.8500  -6573.4885
 -0.6481  -0.5993  -0.4708  -2129.3858
 -0.6478  -0.5990  -0.4707  -2108.5455 
```

以及计算（MVP * Position）

```
P1       P2       P3       P4
3124     -11397   -847     13674
3532     -4968    -16668   -8168
3463     -1245    -7726    -3018
3482     -1225    -7703    -2996 
```

最后，通过透视划分（w-component）进行转换

```
P1       P2       P3       P4
0.897    9.304    0.110    -4.564
1.014    4.056    2.164    2.726
0.995    1.016    1.003    1.007
1.0      1.0      1.0      1.0 
```

如您所见，所有变换点的 y 分量都大于 1，并且应该在视锥体之外。

我已经仔细检查了我的矩阵。我还在顶点着色器中做了一个变换反馈，可以肯定的是，我在 CPU 和 GPU 上使用相同的矩阵进行计算。甚至 MVP * Point 的结果在我的 Vertex Shader 中与在 GPU 上的结果相同。我的渲染管道尽可能简单。

顶点着色器是

```
vColor = aColor; 
gl_Position = MVP * aVertexPosition;

//With Transform Feedback enabled
//transOut = MVP * aVertexPosition 
```

和片段着色器

```
FragColor = vColor; 
```

所以顶点着色器的结果与我的 CPU 计算结果相同。但是，它们仍然是在屏幕上绘制的线条！任何想法为什么有线条？我对透视鸿沟做错了吗？

我该怎么做才能检测到这个矩形不应该被剔除，因为至少有一条线可见（在这个例子中基本上另一条线也是可见的）

如果有帮助：可见的红线是 P1 和 P2 之间的线...

**[编辑]**现在我通过计算相机平截头体法线和黑森法线方程来实现世界空间剔除。这适用于正确识别。遗憾的是，我确实需要在剪辑空间中进行正确的计算，因为我将使用这些点进行其他计算。有人有什么想法吗？

这是我的计算代码：

```
int outOfBoundArray[6] = {0, 0, 0, 0, 0, 0};
std::vector<glm::dvec4> tileBounds = activeElem->getTileBounds(); //Same as I use for world space culling
const glm::dmat4& viewProj = cam->getCameraTransformations().viewProjectionMatrix; //Same camera which I use for world space culling.

for (int i=0; i<tileBounds.size(); i++) {

    //Apply ModelViewProjection Matrix, to Clip Space
    glm::dvec4 transformVec = viewProj * tileBounds[i];

    //To NDC space [-1,1]
    transformVec = transformVec / transformVec[3];

    //Culling test
    if ( transformVec.x >  1.0 ) outOfBoundArray[0]++;
    if ( transformVec.x < -1.0 ) outOfBoundArray[1]++;
    if ( transformVec.y >  1.0 ) outOfBoundArray[2]++;
    if ( transformVec.y < -1.0 ) outOfBoundArray[3]++;
    if ( transformVec.z >  1.0 ) outOfBoundArray[4]++;
    if ( transformVec.z < -1.0 ) outOfBoundArray[5]++;

    //Other computations...
}

for (int i=0; i<6; i++) {
    if (outOfBoundArray[i] == tileBounds.size()) {
        return false;
    }
}
return true; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T00:01:58.400

问题会出现在 P1 和 P2 之间 w（第三个分量）的符号不同。由于射影几何的性质，这将导致各种麻烦。

尽管这些点在 NDC 的同一侧，但绘制的线实际上是无穷大：考虑在 P1 和 P2 之间进行线性插值并在每个点分别除以 w 时会发生什么；发生的情况是，当 w 接近零时，y 值不完全为零，因此线会缩小到无穷大。然后从另一边绕过去。

射影几何是一个奇怪的东西:)

但是，对于一个解决方案，请确保在该平面的正面剪裁那些穿过 w=0 平面的线，并且您已设置好 - 您的代码应该可以工作。

# c# - 条件绑定重定向

> ID：13731135
> 
> 赞同：2
> 
> 时间：2012-12-05T19:43:04.387
> 
> 标签：c#

我正在尝试实现（条件）绑定重定向。我希望绑定重定向以使用特定版本的程序集，具体取决于是否已经存在另一个更新版本。

为清楚起见，该项目当前引用版本 1.1.0.0，但如果不存在，我希望它引用版本 1.0.0.0。

此重定向当前成功重定向到 1.0.0.0，但只有 1.1.0.0 的环境无法正常运行（此帖子的程序集名称和 publicKeyToken 已更改）。

```
<runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
        <dependentAssembly>
            <assemblyIdentity name="MyAssembly" culture="neutral" publicKeyToken="blahblahblah"/>
            <bindingRedirect oldVersion="1.1.0.0" newVersion="1.0.0.0"/>
            <codeBase version="1.0.0.0" href="file://C:\Windows\assembly\GAC_MSIL\MyAssembly"/>
    </dependentAssembly>
</assemblyBinding> 
```

在不需要的情况下如何取消/忽略此重定向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-07-31T13:13:10.310

恐怕它不能在运行时完成，但如果它是特定于环境的，你可以在构建时完成。在构建管道上，您可以检查版本 1.1 的程序集 x 是否存在，如果存在，请更新配置文件以使用该版本。

# ssis - 在 SSIS 2008 r2 的派生列中替换星号

> ID：13731137
> 
> 赞同：0
> 
> 时间：2012-12-05T19:43:16.960
> 
> 标签：ssis

我试过了

```
replace(myfield,"/*/","")
replace(myfield,"/*","")
replace(myfield,"[*]","") 
```

没有任何效果.....它正在替换整个字段，就好像“*”是通配符一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:04:13.290

您正在派生列转换中进行替换，是吗？`REPLACE(myfield,"*","")`对我来说很好。

![在此处输入图像描述](../Images/69d48f6c84e6acc2676ba43dc226b0a4.png)

# c# - C# 访问 T 的静态成员

> ID：13731139
> 
> 赞同：2
> 
> 时间：2012-12-05T19:43:25.437
> 
> 标签：c#, generics

我发现了很多关于此的类似主题，但没有一个可以直接回答我的问题。我正在制作一个游戏，其中涉及放置不同类型的房间。我有一个 Room 类，然后是几个继承自该类的房间，例如 Bedroom、Canteen 等。

每个房间都有一定的静态参数来设置它的属性。例如：

```
public class Room : WorldEntity
{
    public static string Name = "Room";
    public static uint MinHeight = 0;
    public static uint MinWidth = 0;
    //...
}

public class Bedroom : Room
{
    new public static string Name = "Bedroom";
    new public static uint MinHeight = 4;
    new public static uint MinWidth = 4;  
     //...
} 
```

创建房间时，我首先通过所需房间的类型，例如

`public static void PlaceRoom(Type T){//begin room creation process}`

我想知道的是，如何从我的 PlaceRoom 函数中获取 T 的属性？例如，如何获得 T.MinHeight（当 T 为 Bedroom 类型时将返回 4）？还是有更好的方法来解决这个问题？

直到稍后，我才打算初始化我的类 T（其中 T : Room），所以这就是为什么成员是静态的并且我正在尝试使用泛型。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T19:47:28.053

一种选择是创建一个`IRoom`接口，将这些值定义为属性。每个类都会实现这些属性并返回一个硬编码的结果。

另一种选择是创建一个或多个[属性](http://msdn.microsoft.com/en-us/library/aa288454%28v=vs.71%29.aspx)并将它们应用于您的类。该`PlaceRoom`函数将使用反射来读取属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T21:11:21.573

首先，您创建了公共静态字段，这是非常糟糕的设计。公共静态字段应该是只读的。由于您不能将静态字段/属性设为虚拟，并且您不想在调用 PlaceRoom 之前创建实例，因此您可以使用属性来注释您的类型：

```
class Program
{
    static void Main(string[] args)
    {
        PlaceRoom<Room>();
        Console.ReadKey(true);
    }

    public static void PlaceRoom<T>()
        where T : Room
    {
        string name = ((NameAttribute)typeof(T).GetCustomAttributes(false).First(x => x is NameAttribute)).Name;

        Console.WriteLine(name);
    }
}

[Name("Room")]
public class Room
{
}

[Name("Bedroom")]
public class Bedroom : Room
{
}

[AttributeUsage(AttributeTargets.Class, Inherited = false)]
public class NameAttribute : Attribute
{
    public string Name { get; set; }

    public NameAttribute(string name)
    {
        Name = name;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T20:17:10.760

如果您总是覆盖（或新建）属性并且从未实际放置实际`Room`类型，则可以将 Room 及其所有属性都设为抽象，然后让您的方法签名成为`public static void PlaceRoom<T>(T room) where T : Room`并对其进行适当的通用化。然后让你的 Bedroom、Bathroom 和其他东西从 Room 继承。

如果您要添加新属性，这在逻辑上是有缺陷的，因为您不能对实际上不是通用的事物进行通用。

# git - 如何在 git svn create-ignore 之后获取单个 .gitignore

> ID：13731144
> 
> 赞同：16
> 
> 时间：2012-12-03T09:59:21.347
> 
> 标签：git, svn, git-svn

我已经使用 Git 导入了 SVN 存储库：

```
git svn clone --preserve-empty-dirs --stdlayout svn+ssh://... SVN.git 
```

它最终确实成功了，尽管在途中它确实失败了几次，我不得不“重新开始”

```
git svn fetch 
```

然而，似乎最终一切都很好。（尽管现在在写作时我开始怀疑我是否应该`--preserve-empty-dirs`在附加的`fetch`es 中也提供？**编辑：** *不，我不应该。请参阅下面的评论。*）

然后我想创造`.gitignore`，所以我做了

```
git svn create-ignore 
```

这也成功了。

但最终的结果并不令人满意。它确实`.gitignore`在许多文件夹中生成了大量文件。似乎每次 SVN 有一个`svn:ignore`属性时，Git 都会创建相应的`.gitignore`文件。

虽然我想让它们合并到一个根`.gitignore`文件中。这对于 git 来说是可能的，因为它的忽略更加灵活，允许在带有通配符（或没有通配符）的子目录中忽略。我认为任何方式都可以自动将这些“子`.gitignore`”转换为根处的单个子。

我想拥有它，因为“SVN 人”不会对我提交超过 20 个`.gitignore`文件感到满意......

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-12-05T05:55:17.417

我找到了解决方案。您必须使用`show-ignore`而不是`create-ignore`将输出保存到文件中。

所以在克隆存储库后执行以下命令：

```
git svn show-ignore > .gitignore 
```

从您拥有该目录的存储库根`.git`目录。

# jquery - 用于匹配两个 ip 地址之间的连字符的正则表达式

> ID：13731148
> 
> 赞同：0
> 
> 时间：2012-12-05T19:44:23.497
> 
> 标签：jquery

我已经尝试使用以下正则表达式，但无法满足我的要求。任何人都可以帮助我......必须匹配以下示例格式的 IP 地址 Example- 111.222.222.111- 222.112.1.2 （假设）或单个 IP 地址。这是我的正则表达式：

```
(^((([0-9]{1,2})|(1[0-9]{2,2})|(2[0-4][0-9])|(25[0-5])|\\*)\\.){3}(([0-9]{1,2})|(1[0-9]{2,2})|(2[0-4][0-9])|(25[0-5])|\\*)$) | ^((([0-9]{1,2})|(1[0-9]{2,2})|(2[0-4][0-9])|(25[0-5])|\\*)\\.){3}(([0-9]{1,2})|(1[0-9]{2,2})|(2[0-4][0-9])|(25[0-5])|\\*))(\\-)^(([0-9]{1,2})|(1[0-9]{2,2})|(2[0-4][0-9])|(25[0-5])|\\*)\\.){3}(([0-9]{1,2})|(1[0-9]{2,2})|(2[0-4][0-9])|(25[0-5])|\\*)$") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T19:46:53.363

您可能要考虑不使用正则表达式。[这是一个用split](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/split)解决的更容易和更易读的问题：

```
var ips = '111.222.222.111-222.112.1.2';

ips = ips.split('-');
var ip1 = ips[0].split('.');
var ip2 = ips[1].split('.');

// ip1 is the array ["111", "222", "222", "111"]
// ip2 is the array ["222", "112", "1", "2"] 
```

要验证它们，您只需要确保结果数组中有四个元素，并 parseInt 每个元素并检查它是否介于两者之间`0`（`255`对于 ip1）：

```
var i, temp;
if(ip1.length != 4){
    console.log("Invalid IP");
}
for(i = 0; i < 4; i++){
    temp = parseInt(ip1[i], 10);
    if(0 > temp || temp > 255){
        console.log("Invalid IP");
        break;
    }
} 
```

对两个 IP 都执行此操作，并确保 ips ( `ips.length == 2`) 中只有 2 个 IP。

# orchardcms - 无法使用 Orchard 创建自定义主题

> ID：13731149
> 
> 赞同：1
> 
> 时间：2012-12-05T19:44:34.293
> 
> 标签：orchardcms

我正在尝试在本地机器上的 Orchard 设置上编写自定义主题。我需要源代码，因为我们将检查源代码控制的进出代码。我已经从 CodePlex (http://orchard.codeplex.com/SourceControl/list/changesets?branch=default) 下载了 Orchard 1.6 的源代码。

我有一个基本站点正在运行。但是，我想创建一个自定义主题。基于本教程：[http](http://docs.orchardproject.net/Documentation/Writing-a-new-theme) ://docs.orchardproject.net/Documentation/Writing-a-new-theme ，我需要使用 codegen 命令行工具。我的挑战是，当我尝试执行 /src/Tools/Orchard/bin/Release/Orchard.exe 中的 orchard.exe 命令行工具时。我收到一条错误消息：

*初始化 Orchard 会话。（这可能需要几秒钟...）错误：目录“C:\Website\src\Tools\Orchard\bin\Release”似乎不包含 Orchard 安装*

我不明白。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T19:58:17.070

您正在运行错误的果园公用线工具。

你需要运行的是 `~\src\Orchard.Web\bin\`

# php - 一般调试

> ID：13731151
> 
> 赞同：0
> 
> 时间：2012-12-05T19:44:40.410
> 
> 标签：php, mysql

我的代码可以呼出某人的名字，它适用于某些 id，但不适用于其他人。这是代码：

```
$sid = $_SESSION['id'];
$sql = mysql_query("SELECT * FROM users WHERE id='$sid'");
$row = mysql_fetch_array($sql);
$fname = $row['fname'];
.
.
.
<?php echo $fname; ?>'s Profile 
```

知道这只能在某些时候起作用吗？我正在使用 PHP 和 MySQL。我回应了 $sid，它给出了正确的 ID。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:05:26.343

值 IS 可能来自数据库列并包含空字符串或为 NULL。您应该使用特定的 id 直接检查数据库，以确定具体期望什么。

这将解释你的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T19:50:30.540

您没有检查查询是否返回任何结果。

先做个检查：

```
if ($sql) { // the query worked,
    while($row = mysql_fetch_array($sql)) {
        $fname = $row['fname'];
        ....
    }
}else {
    .. there was an error ...
    echo "Error: ".mysql_error();
} 
```

你可以做一个`var_dump($row)`来看看内容。

# iphone - Sqlite 日期时间大于特定月份

> ID：13731153
> 
> 赞同：1
> 
> 时间：2012-12-05T19:44:51.823
> 
> 标签：iphone, ios, xcode, sqlite

我正在尝试使用以下查询根据 SQLITE 中的一个月年是否大于另一个月年来选择数据：

```
SELECT id, start_date, end_date FROM recur WHERE strftime('%m%Y', start_date) <= '122012' AND strftime('%m%Y', end_date) >= '122012'

I have a row in the database with:
  start_date = 2012-12-01
  end_date = 2015-05-01 
```

问题似乎与大于功能有关，并且更改周围的数据后似乎无法进行大于。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:35:21.003

您必须将年份放在首位，以便它在字符串比较中获得更大的权重：

```
strftime('%Y%m') 
```

# c# - 动态排列控件以平铺在面板内

> ID：13731162
> 
> 赞同：2
> 
> 时间：2012-12-05T19:45:59.320
> 
> 标签：c#, winforms, devexpress

我有一个显示在控件中的 3D 图像，我可以对它做几件事（旋转、缩放、绘制东西等）。这个控件是 Dock 填充到一个面板和工具栏允许我们控制图像操作。

我希望能够通过动态平铺图像来同时查看多张图像。所以 ：

*   如果用户打开 1 张图片，它会占用 100% 的空间
*   如果用户选择 2 张图片，它们会并排显示
*   如果用户选择了 4 张图像，它们将被平铺。
*   ETC...

基本上，这可以通过 MDI 表单轻松实现，但此模块嵌套在应用程序中，因此这是不可能的。我*可以*通过计算大小和使用 TableLayoutPanel 手动完成这一切，但我认为肯定有一些东西可以解决这个问题。

有什么建议么？

*注意：我在 winform 中，我有 DevExpress 11*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:42:56.777

如果您只需要 Tiling，`TableLayoutPanel`完全可以为您做到：

```
 private void btnNewImage_Click(object sender, EventArgs e)
    {
        if (imgCount == 0)
            tlp.Controls.Add(new Button { Text = "Image " + ++imgCount, Dock = DockStyle.Fill }, 0, 0);
        else
        {
            // tlp is the TableLayoutPanel which is docked as Dock.Fill
            if (tlp.RowCount == tlp.ColumnCount)
            {
                tlp.ColumnCount++;
                for (int i = 0; i < tlp.RowCount; i++)
                    tlp.Controls.Add(new Button { Text = "Image " + ++imgCount, Dock = DockStyle.Fill }, tlp.ColumnCount - 1, i);
                tlp.ColumnStyles.Clear();
                for (int i = 0; i < tlp.ColumnCount; i++)
                    tlp.ColumnStyles.Add(new ColumnStyle(SizeType.Percent, (float)100.0 / (float)tlp.ColumnCount));
            }
            else
            {
                tlp.RowCount++;
                for (int i = 0; i < tlp.ColumnCount; i++)
                    tlp.Controls.Add(new Button { Text = "Image " + ++imgCount, Dock = DockStyle.Fill }, i, tlp.RowCount - 1);
                tlp.RowStyles.Clear();
                for (int i = 0; i < tlp.RowCount; i++)
                    tlp.RowStyles.Add(new RowStyle(SizeType.Percent, (float)100.0 / (float)tlp.RowCount));
            }
        } 
```

您可以`new Button`用您的控件名称替换，我使用按钮作为示例控件。此代码假定通过点击添加新按钮，应将一行或一列添加到布局中。你可以自定义它来做任何你想做的事情。

希望这可以帮助。

# iphone - GLSL 片段着色器将无法编译

> ID：13731168
> 
> 赞同：1
> 
> 时间：2012-12-05T19:46:21.877
> 
> 标签：iphone, ios6, opengl-es-2.0

我在这里完全被难住了。我有以下片段着色器工作：

```
varying lowp vec4 fposition;
varying lowp vec4 fcolor;
varying lowp vec2 ftexturecoordinates;

void main() {
    gl_FragColor = fcolor;
} 
```

如果我尝试添加*任何内容*（例如`vec4 light position = vec4(-2.0, 2.0, 1.0, 1.0)`：），它将无法编译。我无法弄清楚如何获取错误代码/描述，但我无法让任何正常的 OpenGL ES 着色器工作。我在这个应用程序中的着色器编译代码与我在所有其他应用程序中的相同，所以我知道该部分工作正常。如果有的话，我可以做些什么来找到有关该问题的信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:14:34.487

编译着色器后，您可以检查`GL_COMPILE_STATUS`if it is `GL_FALSE`，您可以使用 use`glGetShaderInfoLog`获取有关编译错误的其他信息。

这是一个展示如何使用 glGetShaderInfoLog 的片段：

（我留下了项目特定的错误检查以供参考，但将其注释掉，因为如果没有围绕它的框架，它将无法工作。）

```
glCompileShader(shader);
//mada_check_gl_error();

GLint compiled;
glGetShaderiv(shader, GL_COMPILE_STATUS, &compiled);
//mada_check_gl_error();
if (!compiled)
{
    GLint length;
    glGetShaderiv(shader, GL_INFO_LOG_LENGTH, &length);
    //mada_check_gl_error();
    if (length > 0)
    {
        GLint infoLength;
        char* infoBuf = (char*) malloc(sizeof(char) * length);
        glGetShaderInfoLog(shader, length, &infoLength, infoBuf);
        //mada_check_gl_error();
        //mada_log(logERROR, infoBuf);
        free(infoBuf);
        //SysUtils::error("Error compiling shader. See log for info.");
    }
    //SysUtils::error("Failed to compile shader. No further info available.");
} 
```

# knockout.js - KnockoutJS 映射子属性的问题

> ID：13731171
> 
> 赞同：0
> 
> 时间：2012-12-05T19:46:35.017
> 
> 标签：knockout.js, knockout-mapping-plugin, knockout-2.0

我刚刚开始学习 KnockoutJS，所以我可能遗漏了一些简单的东西，但这是我的问题。

下面是我的 ClassType 类

```
public class ClassType
{
    [HiddenInput(DisplayValue = false)]
    public int ID { get; set; }

    [Required(ErrorMessage = "Please enter a description")]
    public string Description { get; set; }

    [Display(Name = "Class Slots")]
    public int ClassSlots { get; set; }
} 
```

我的控制器中有一个方法可以返回一个名为 GetAll 的所有类型的列表

```
public JsonResult GetAll()
    {
        var classtypes = classtypeRepository.All;
        return Json(classtypes, JsonRequestBehavior.AllowGet);
    } 
```

在我看来，我有以下代码将数据加载到我的视图模型中

```
<script type="text/javascript">
$(document).ready(function () {
    $.get("/ClassTypes/GetAll/", "", function (data) {
        var viewModel = {
            classtypes: ko.observableArray()
        };
        viewModel.classtypes = ko.mapping.fromJS(data);
        ko.applyBindings(viewModel);
    });
});
</script> 
```

我已将以下 div 放入我的视图中，以确保返回某些内容

```
<div data-bind="text: ko.toJSON($data)"></div> 
```

返回以下内容

```
{"classtypes":[{"ID":1,"Description":"Online","ClassSlots":30},{"ID":2,"Description":"In-House","ClassSlots":15},{"ID":3,"Description":"Hands-On","ClassSlots":10}]} 
```

如果我尝试将任何东西绑定到视图模型，它似乎不理解属性

```
 <tbody>
    <!-- ko.foreach: classtypes -->
         <tr>
            <td></td>
            <td data-bind="text: Description">
            </td>
            <td data-bind="text: ClassSlots">
            </td>
        </tr>
    <!-- /ko -->
</tbody> 
```

我使用了 knockoutJS 映射插件来带来我认为会为我创建视图模型结构的数据。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T21:00:06.547

您的代码是正确的，除了一件事。
要从 Array 获取特定属性，您应该调用`$data.YOUR_SPECIFIC_PROPERTY_NAME`
**HTML CODE：**

```
<table style="border: 1px solid #222;">
  <tr data-bind="foreach: classtypes">
    <td></td>
    <td data-bind="text: $data.Description"></td>
    <td data-bind="text: $data.ClassSlots"></td>
  </tr>
</table> 
```

**Javascript代码**

```
var ViewModel = function(data) {
  var self = this;
  self.classtypes = ko.observableArray(initialData);
};

var initialData = [{"ID":1,"Description":"Online","ClassSlots":30},
                   {"ID":2,"Description":"In-House","ClassSlots":15},
                   {"ID":3,"Description":"Hands-On","ClassSlots":10}];

ko.applyBindings(new ViewModel(initialData)); 
```

我还为你创建了 jsFiddle**[点击这里查看演示](http://jsfiddle.net/pkysylevych/9aSqc/)**

**开始更新**
它也适用于 foreach 评论，但你在`ko.foreach`评论中有一个错字，实际上你应该像这样将一个点 ('.') 更改为空白 ('') `<!-- ko foreach -->`，这里也将是你正确的 HTML 代码：

```
<table style="border: 1px solid #222;">
  <tbody>
    <!-- ko foreach: classtypes -->
    <tr >
      <td></td>
      <td data-bind="text: $data.Description"></td>
      <td data-bind="text: $data.ClassSlots"></td>
    </tr>
    <!-- /ko -->
  <tbody>
</table> 
```

**结束更新**

# javascript - jQuery .blur() - 不要隐藏活动的 div

> ID：13731177
> 
> 赞同：2
> 
> 时间：2012-12-05T19:46:55.493
> 
> 标签：javascript, jquery, html, blur

如果我在其中单击，为什么这段代码会隐藏在 blur() 上用作 jQuery 选择器的 div？Blur() 只有在我点击它外部时才应该隐藏它。

**HTML 触发器：**

```
<div class="header">To-Do <a class="triggernewtodo">Add a task...</a></div> 
```

**li 显示/隐藏：**

```
<li class="addnewtodo">
<form>
    <textarea class="addtodotextarea"></textarea>
    <div class="controlarea">
    <input class="primary" name="commit" type="submit" value="Add" />
    </div>
</form>
</li> 
```

**jQuery：**

```
// Show/Hide New Todo form
$('a.triggernewtodo').click(function() {
    $('li.addnewtodo').show()
    $('textarea.addtodotextarea').focus();
});

$('li.addnewtodo').live("blur", function() {
    $(this).hide();
}) 
```

我的猜测是它与放置在 textarea 上的 .focus() 有关，因为如果我取出那个 .focus()，它会正常工作，直到我在 textarea 内单击然后单击 out（仍在列表项内）它隐藏了整个列表项。有任何想法吗？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:55:28.503

我怀疑您正在看到从该 LI 中“冒泡”的事件。本质上，来自 INPUT 的“模糊”事件会触发该输入上的所有“模糊”处理程序。 *然后*它触发 FORM 上的所有“模糊”处理程序。然后它触发 LI 上的“模糊”处理程序 - 隐藏它。

[除非您调用stopPropagation](http://api.jquery.com/event.stopPropagation/)来阻止这种情况，否则该事件会一直沿 DOM 树向上继续。在您的情况下，您应该能够使用[event.target](http://api.jquery.com/event.target/)属性来查看事件是否实际上起源于 LI，并且仅在这种情况下将其隐藏（警告：未经测试）：

```
$('li.addnewtodo').live("blur", function(event) {
    if(event.target == this)
    {
        $(this).hide();
    }
}); 
```

希望有帮助！

**PS：**有关其他警告，请参阅[模糊事件页面。](http://api.jquery.com/blur/)

# powershell - 签到用户和签到评论

> ID：13731178
> 
> 赞同：1
> 
> 时间：2012-12-05T19:46:56.017
> 
> 标签：powershell, build-automation

我在 TFS 2012 中创建了一个使用 PowerShell 脚本的构建定义。在此脚本中，我想在代码签入后检索签入用户和签入评论。

有没有这样的宏可以在构建过程中使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:11:31.813

`Compile, Test, and Associate Changesets and Work Items` 并行活动之外的工作流序列定义了一个名为`associatedChangesets`IList 的变量。尝试将其传递到您的脚本中。我只将简单的字符串变量传递到我的脚本中，例如：

```
"-NonInteractive -NoProfile -Command ""& {" + SourcesDirectory + "\Build\MakeSdkZip.ps1 " + SourcesDirectory + " " + SdkDbgZipPath + " -TeamBuild -IncludeSource}""" 
```

这是我的 PowerShell 调用之一的参数值。请注意，SourcesDirectory 和 SdkDbgZipPath 是工作流定义的变量。还要记住，每个构建可以有多个签入（因此是变更集的集合）。

# django - 在 IIS 上部署 Django 应用程序的推荐方法是什么？

> ID：13731179
> 
> 赞同：7
> 
> 时间：2012-12-05T19:47:02.670
> 
> 标签：django, iis, azure

我最近注册了一个 Azure 帐户，因为我正在开发一个 Django 应用程序并从 Heroku 移植它。我在 Azure 上创建了一个 Windows Server 2012 虚拟机，并且成功地复制了我的应用程序并将其依赖项安装在虚拟机上。我还设法直接在命令行上运行它。现在我想在 IIS 下运行它。我在网上搜索过，似乎有很多方法可以剥这只猫的皮。我想知道最好的方法。部署生产站点的专业人员会使用哪种方法？我很难找出最好的方法是什么。据报道，Django 站点上的文档已经过时，它指向另一个站点，该站点解释了如何使用性能工具安装 Django。MSDN 上的文档仅包含显示在 Windows 下安装和从命令行运行或安装到 Ubuntu VM 的教程。我希望从做过这件事的人那里得到一些指导，并且可以解释一种方法相对于另一种方法的优缺点。提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-06T07:21:30.400

查看官方 Windows Azure 网站上的不同选项：

*   [Django Hello World Web 应用程序](https://www.windowsazure.com/en-us/develop/python/tutorials/web-app-with-django/)：本教程介绍了如何在虚拟机上的 IIS 中安装 Django 应用程序。请注意，这是 IaaS，因此如果您想将其用于生产部署，您可能需要横向扩展。这意味着您可以添加所需的虚拟机、在所有这些虚拟机上部署应用程序、管理更新、管理安全性……

*   [使用 Django 创建网站](https://www.windowsazure.com/en-us/develop/python/tutorials/web-sites-with-django/)：本教程介绍了如何将 Django 应用程序部署到 Windows Azure 网站。我想这就是你要找的。这里的好处是您可以免费开始（与其他网站共享，适合测试），然后转到共享（仍然是共享主机，自定义域名，非常适合您想要启动应用程序时），最后转到保留（专用机器）。此处的优势是您可以轻松横向扩展，甚至可以扩展到多个预留实例，而无需担心部署或管理虚拟机。您可以使用 Visual Studio 或 Git/Bitbucket/TFS 集成进行部署，Windows Azure 网站将确保您的站点立即部署（即使您在保留模式下运行多个实例）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-09T17:15:43.730

本周我们参加了[DjangoCon ，帮助人们在 Azure 上获取 Django 站点。](https://2015.djangocon.us/)

我们创建了一个教程和 repo 来帮助人们使用最少的代码开始。

*   [教程](http://djangocon.azurewebsites.net/)
*   [基础回购](https://github.com/timmyreilly/YourDjangoSiteResume)

查看分叉项目以找到与会者制作的一些甜蜜示例：

*   [Batavia](http://batavia.azurewebsites.net/) - 浏览器中的 Python 3 -[回购](https://github.com/freakboy3742/batavia-azure)
*   [Webcat](http://webcat.azurewebsites.net/webcat) - 浏览器中的 Ascii 小猫 -[回购](https://github.com/cackovic/YourDjangoSiteResume)
*   [DJReader](http://djreader.azurewebsites.net) - 阅读器克隆 -[回购](https://github.com/dcwatson/reader/tree/azure)
*   [健康建议](http://djangocon-us-2015.azurewebsites.net/)-[回购](https://github.com/karthikbgl/YourDjangoSiteResume)

# python - 蟒蛇请求

> ID：13731189
> 
> 赞同：2
> 
> 时间：2012-12-05T19:47:58.837
> 
> 标签：python, json, python-requests, html-post

我正在为 RESTful API POST-verb 编写测试，它将多部分表单数据发送到服务器。我想对数据进行 json 编码。这样做的正确方法是什么？以下是 3 个测试，其中前 2 个通过，第三个（我需要的场景）失败。任何帮助，将不胜感激。

```
import requests
import json

print "test 1, files+data/nojson"
requests.post('http://localhost:8080', files={'spot[photo]': open('test.jpg', 'rb')}, data={'spot': 'spot_description'})

print "test 2, only data/json"
requests.post('http://localhost:8080',data=json.dumps({'spot': 'spot_description'}))

print "test 3, only files+data/json"
requests.post('http://localhost:8080', files={'spot[photo]': open('test.jpg',
'rb')}, data=json.dumps({'spot': 'spot_description'})) 
```

代码输出：

```
$ /cygdrive/c/Python27/python.exe -B test.py
test 1, files+data/nojson
test 2, only data/json
test 3, only files+data/json
Traceback (most recent call last):
  File "test.py", line 12, in <module>
    'rb')}, data=json.dumps({'spot': 'spot_description'}))
  File "C:\Python27\lib\site-packages\requests\api.py", line 98, in post
    return request('post', url, data=data, **kwargs)
  File "C:\Python27\lib\site-packages\requests\safe_mode.py", line 39, in wrapped
    return function(method, url, **kwargs)
  File "C:\Python27\lib\site-packages\requests\api.py", line 51, in request
    return session.request(method=method, url=url, **kwargs)
  File "C:\Python27\lib\site-packages\requests\sessions.py", line 241, in request
    r.send(prefetch=prefetch)
  File "C:\Python27\lib\site-packages\requests\models.py", line 532, in send
    (body, content_type) = self._encode_files(self.files)
  File "C:\Python27\lib\site-packages\requests\models.py", line 358, in _encode_files
    fields = to_key_val_list(self.data)
  File "C:\Python27\lib\site-packages\requests\utils.py", line 157, in to_key_val_list
    raise ValueError('cannot encode objects that are not 2-tuples')
ValueError: cannot encode objects that are not 2-tuples 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:12:57.083

错误是因为您的`data`参数是字符串。

在`models.py::send()`：

```
 # Multi-part file uploads.
    if self.files:
        (body, content_type) = self._encode_files(self.files) 
```

在`models.py::_encode_files()`：

```
 fields = to_key_val_list(self.data)
    files = to_key_val_list(files) 
```

在`utils.py::to_key_val_list()`：

```
if isinstance(value, (str, bytes, bool, int)):
    raise ValueError('cannot encode objects that are not 2-tuples') 
```

这在使用 self.data 的通话中受到了打击。您正在传递字典的字符串表示形式，但它需要字典本身，如下所示：

```
requests.post('http://localhost:8080',
              files={'spot[photo]': open('test.jpg', 'rb')},
              data={'spot': 'spot_description'}) 
```

因此，如果为文件参数分配了任何内容，则数据参数不能是 str、bytes、bool 或 int 类型。您可以按照源代码进行操作：[https ://github.com/kennethreitz/requests/blob/master/requests/models.py#L531](https://github.com/kennethreitz/requests/blob/master/requests/models.py#L531)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T22:59:39.443

`POST`可以通过将 JSON 数据嵌入到表单编码字段中来解决这些问题，如下所示：

```
post(url, data={'data': json.dumps(actual_data)}, files={'myfile': open('foo.data')}) 
```

另外，我认为您可以像这样放入所有内容`files`：

```
post(url, files={'data': json.dumps(actual_data), 'myfile': open('foo.dat')}) 
```

...这应该相当于第一个片段。

# security - 用于检测网络流中 exe 的 Snort 配置

> ID：13731191
> 
> 赞同：1
> 
> 时间：2012-12-05T19:48:18.057
> 
> 标签：security, networking, exe, root, snort

这个问题参考了[Detecting exe 32/64bit](https://stackoverflow.com/questions/10326331/detecting-exe-32-64bit)问题。在网络流中，exe 下载是否仍会为每个数据包维护此信息？

如何在 snort 中利用 PE 00 00 64 86 或 PE 00 00 4C 01 逻辑？我是否必须使用某种流重组器（如 snort 附带的 stream5）将数据包映射到文件然后查找内容？

在开箱即用的 snort 中尝试此操作时，我收到了有关下载的每个 exe 数据包的警报。我试图了解文件数据是如何分成数据包的，我们如何验证单个数据包是否包含属于 exe（32/64 位）一部分的数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T00:00:50.540

找出每个 exe 下载数据包触发的警报。Snort 默认使用 stream5，并在您发布内容匹配规则时为您重新组装所有数据包。

因此发生的情况是，每次有原始数据包进来时，它都会与流中较早的数据包重新组合，并与规则中的属性相匹配。因此，每次数据包进入时都会重复此操作。

在 snort.conf 中设置 stream5_global: show_rebuilt_packets 将在重建数据包时显示它们。您还可以尝试使用 snort -A cmg .. 运行 snort 以查看日志的来源，即查看每个阶段的组装数据包。

然而，仍然不清楚 snort 如何轻松与数据雕刻工具集成以从数据包捕获中提取文件，以及是否可以内联完成。

# android - YouTube 意图，错误 400

> ID：13731192
> 
> 赞同：11
> 
> 时间：2012-12-05T19:48:24.810
> 
> 标签：android, android-intent, youtube, android-4.0-ice-cream-sandwich

我发现我可以通过这种方式在 YouTube 播放器中播放 YouTube 视频：

```
Intent i = new Intent(Intent.ACTION_VIEW, Uri.parse("vnd.youtube:U79wVTdnMpw")); 
startActivity(i); 
```

但它不起作用。YouTube 播放器已启动，但出现错误：

> 网络出现问题 [400]

我已经更新了 YouTube 应用，但没有任何变化。

我正在使用 Android ICS 4.0.1。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2014-05-14T11:46:22.190

[我在这个谷歌产品论坛](https://productforums.google.com/d/msg/youtube/FQoBYsObhBQ/7TVtMuGxyk8J)上找到了答案，这有助于解决我的问题——这正是你遇到的问题:)

解决方案：只提供**YouTube ID**，而不是整个 YouTube URL 给`loadVideo()`函数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-06-24T14:55:14.553

在 loadvideo 上不要放：

```
loadvideo(https://www.youtube.com/watch?v=gQy4I5y1ldg12) 
```

就放

```
loadvideo(gQy4I5y1ldg12); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T20:49:32.563

这似乎是 youtube 应用程序的一个常见问题，在[此处](http://productforums.google.com/forum/#!topic/youtube/21R-bX-bqpY)和[此处](http://productforums.google.com/forum/#!topic/youtube/FQoBYsObhBQ)也有描述。我找到的唯一答案是退出 youtube 应用程序，然后再次登录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-10T11:58:00.227

单击 youtube 视频下方的**分享**按钮 -> 它将显示链接 -> 使用此链接。

**注意：不要使用 youtube 的 url**

***示例链接分享截图：***

[![在此处输入图像描述](../Images/5ba213ab7eccba82b529acca7ec3f5de.png)](https://i.stack.imgur.com/ckt0X.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-27T07:09:43.000

Youtube 400 网络错误：关闭并打开清除数据和缓存

设置应用程序管理应用程序清除数据和缓存

您每次都需要登录。不幸的是，我仍然不能发帖，但可以在 g+ 上分享评论

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-01-25T05:52:50.317

请检查视频 ID 在 json 中是否正确解析，并且完全符合意图

# java - yql google.tranlate 解析java

> ID：13731193
> 
> 赞同：1
> 
> 时间：2012-12-05T19:48:23.983
> 
> 标签：java, xml, json, translation, yql

我通过 YQL 获取数据。我到达使用 java 解析的答案来自[Parsing XML document YQL query in Java](https://stackoverflow.com/questions/5835845/parsing-xml-document-yql-query-in-java) for a request yahoo.finance.quotes

但是当请求 google.translate 时，我遇到了 Java 解析器结果的问题。

感谢您帮助我完成脚本工作。我有以下课程。

```
import java.io.InputStream;
import java.net.URL;
import java.net.URLEncoder;
import javax.xml.bind.JAXBContext;
import javax.xml.bind.Marshaller;
import javax.xml.bind.Unmarshaller;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Stock.class);

        Unmarshaller unmarshaller = jc.createUnmarshaller();

        String text = "this is a test";
        String target = "de";

        String root = "http://query.yahooapis.com/v1/public/yql?env=http%3A%2F%2Fdatatables.org%2Falltables.env&format=json&q=";
        String yql = "select * from google.translate where q='"+text+"'"+"and target='"+target+"'";
        String yqlquerytranslation = "http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20google.translate%20where%20q%3D%22"+text+"%22%20and%20target%3D%22"+target+"%22%3B&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys";

        //URL url = new URL("http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.quotes%20where%20symbol%20in%20(%22YHOO%22%2C%22GOOG%22)&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys");
        URL url = new URL(root+URLEncoder.encode(yql));
        InputStream xmlStream = url.openStream();
        System.out.println(xmlStream);
        Stock stock = (Stock) unmarshaller.unmarshal(xmlStream);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(stock, System.out);
    }

} 
```

二等

```
import java.util.List;
import javax.xml.bind.annotation.XmlAccessType;
import javax.xml.bind.annotation.XmlAccessorType;
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlElementWrapper;
import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement(name="query")
@XmlAccessorType(XmlAccessType.FIELD)
public class Stock {

    @XmlElementWrapper(name="results")
    @XmlElement(name="quote")
    private List<Quote> quotes;

} 
```

最后一堂课

```
import java.util.Date;
import javax.xml.bind.annotation.XmlAccessType;
import javax.xml.bind.annotation.XmlAccessorType;
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlSchemaType;

@XmlAccessorType(XmlAccessType.FIELD)
public class Json {

    @XmlElement(name="json")
    private String json;

} 
```

# c# - 如何从另一个用户控件中隐藏用户控件？

> ID：13731195
> 
> 赞同：1
> 
> 时间：2012-12-05T19:48:26.207
> 
> 标签：c#, .net, winforms, user-controls

我在 C# 的一个学校项目中工作，但我有一个问题。我制作了一个用户控件，其中有一些按钮，这就像一个带有按钮的横幅。这些按钮应该显示和隐藏其他用户控件

这是我在具有按钮的用户控件中的代码：

```
 Reports ra = new Reports();
 PurchaseReport rb = new PurchaseReport(); 
```

比在其中一个按钮中我编写了以下代码：

```
 ra.Hide();

 rb.Show();
 this.Controls.Add(rb);
 rb.Location = new Point(130, 153); 
```

但问题是它不会隐藏报告 (ra)。而且它不显示购买报告 (rb)。问题是什么？

```
public partial class MenuUserC : UserControl
{

    Reports ra = new Reports();
    PurchaseReport rb = new PurchaseReport();

    public MenuUserC()
    {
        InitializeComponent();
    }

    private void ButtonItem15_Click(object sender, EventArgs e)
    {
        rb.Hide();

        ra.Show();
        this.Controls.Add(ra);
        ra.Location = new Point(130, 153);
    }

    private void ButtonItem1_Click(object sender, EventArgs e)
    {

        ra.Hide();

        rb.Show();
        this.Controls.Add(rb);
        rb.Location = new Point(130, 153);

    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T20:01:41.150

通常，您不希望一个控件知道另一个控件。让您的自定义控件在发生有趣的事情时公开事件，并让应用程序代码处理逻辑以显示/隐藏其他控件。

例如：

```
MyUserControl ctl = new MyUserControl;
ctl.OnHideReports += OnHideReports;
ctl.OnShowReports += OnShowReports;
... 
```

然后在 OnHideReports 的事件处理程序中，处理逻辑：

```
void OnHideReports(...)
{
    _reports.Hide();
    _purchaseReports.Show();
    ...
} 
```

此外，尝试使用 WinForm 设计器将用户控件添加到表单。与直接在代码中声明它们相比，使用设计器的控件要容易得多。

更新：

此示例在表单上有两个按钮以及两个用户控件。单击按钮 1 时，它显示用户控件 1 并隐藏用户控件 2。单击按钮 2 时，它会执行相反的操作。请注意，按钮和用户控件是使用表单设计器添加到表单中的，而不是在代码中手动添加。这将负责定位，将它们作为子控件添加到主窗体等。除非您有充分的理由这样做，否则不要使用您自己的代码手动添加它们。

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void UiButtonOneClick(object sender, EventArgs e)
    {
        myUserControlOne.Show();
        myUserControlTwo.Hide();
    }

    private void UiButtonTwoClick(object sender, EventArgs e)
    {
        myUserControlOne.Hide();
        myUserControlTwo.Show();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-05T22:03:54.647

尝试隐藏方法以及其他对象的显示方法

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T19:57:35.117

您正在创建用户控件的新实例

相反，您需要这样的东西

```
Reports ra = (Reports)Page.FindControl("Reports1");//Reports1 should be the name the controls renders in the browser 
```

这将使您可以访问页面上的实例我的语法可能有点偏离，上次我这样做是在 VB 中

# python - 高性能计算所有可能组合的最小二乘差（n 个列表）

> ID：13731200
> 
> 赞同：2
> 
> 时间：2012-12-05T19:48:38.517
> 
> 标签：python, performance, dictionary, combinations, least-squares

我正在寻找一种非常有效的方法来计算 n 个列表中的所有可能组合，然后保持组合具有最小的最小二乘差。

我已经有一个代码可以做到这一点，但是当它达到数百万个组合时，事情就会变慢。

**Candidates_len**包含长度为 [[500, 490, 510, 600][300, 490, 520][305, 497, 515]] 的列表的列表**Candidate_name**包含名称为 [['a', ' 的列表的列表b', 'c', 'd']['mi', 'mu', 'ma']['pi', 'pu', 'pa']]

两个列表都有**n 个**列表。

```
#    Creating the possible combinations and store the lists of lengths in vector r
r=[[]]
for x in candidates_len:
    r = [ i + [y] for y in x for i in r ]
#Storing the names of the combinations and store the lists of identifiers in vector z
z=[[]]
for x in candidates_name:
    z = [ i + [y] for y in x for i in z ]          
#Calculating distances and storing the minimum one
min_index = 0
min_dist = 0
list_best = []
for index, item in enumerate(r):
    n = 0
    dist = 0
    while n < len(candidates_len):
        for i in range(n,len(candidates_len)):
            dist = dist + (item[n]-item[i])**2
        n=n+1
    if index==0:
            min_dist = dist
            min_index = index
            list_best.append(item)
    elif dist < min_dist:
        min_dist = dist
        min_index = index
        list_best = []
        list_best.append(z[index])
least_combination = min_index 
```

一个硬案例： http: [//pastebin.com/BkVQTQWK](http://pastebin.com/BkVQTQWK)

以下是一些测试时间。不到一分钟左右会很好。我不知道这是否可能。

> ```
> combinations time(s)
> 77760   1.255663
> 41184   1.580333
> 69120   6.214786
> 8960   1.131834
> 537600  14.855361
> 89100   1.264126
> 16384   3.247404
> 4199040 666.853284
> 226800   3.935878
> 9289728 679.064149 
> ```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T20:16:22.477

我在这里的第一个想法是您花费大量时间来建立您不需要的列表。至少，废弃它们会使事情变得更简单，但不能保证它实际上会让事情变得更快：

```
r = itertools.product(*candidates_len)
z = itertools.product(*candidates_name)

min_dist = None
for item, names in itertools.izip(r, z):
  dist = 0
  for n in range(len(item)):
    for i in range(n, len(item)):
      dist += (item[n]-item[i])**2
  if min_dist is None or dist < min_dist:
    min_dist = dist
    best = item, names

print(best) 
```

对于您的测试数据，显式列表占用了千兆字节的内存。我不确定有多少——我可怜的 4GB 笔记本电脑甚至在它完成生成`z`列表之前就进入了交换颠簸地狱，一切都慢了下来。与没有它的设置部分相比，整个操作所花费的时间更少`itertools`……在一台拥有 16GB RAM 的机器上可能不是这样，但是，如果你不需要它，为什么还要使用它呢？

我的下一个想法是，您所做的只是在一堆数组上计算 LSD。你有大量的小阵列吗？如果是这样，您可以对它们进行去锯齿（例如，用 None 填充它们）和`numpy`整个事情吗？另一方面，如果它是一个大数组的数组，您可能需要一个数组列表（或者，如上所述，一个迭代器）`numpy`，所以至少您可以向量化一个维度。

无论哪种方式，向量化都是优化任何涉及对大数组进行简单操作的关键，并且`numpy`通常比专业的 C++-and-Fortran-and-platform-specific-assembly 编码器可能手动执行的任何事情都做得更好。

在没有仔细考虑代码或试图深入理解算法的情况下，我的第一次尝试是生成`r`一个序列（如我上面的代码）但`numpy`行向量（类似于`matrix(x, dtype=int) for x in itertools.product(*candidates_len)`）。`item`然后你可以通过 just计算每个的差异`item - item.T`，然后总结下三角形的平方（我必须查一下才能弄清楚如何做）。然后，您可能可以通过首先找出仅计算下三角形的方法来进一步提高性能。典型的技巧是弄清楚如何将下三角形和作为矢量化操作的一部分放入对角线，然后您只需提取对角线，但这并不总是合适的。请参阅[广播文档](http://docs.scipy.org/doc/numpy/user/basics.broadcasting.html)有关如何在不创建显式矩阵的情况下矢量化内部循环的一些想法。最后，看看是否有一种方法可以从整个事物中创建一个 3D 数组（这可能意味着将各个项目填充到固定宽度），然后对整个操作进行矢量化。（内存使用不会那么糟糕，因为`numpy`只需要为每个值而不是一个整体分配 4 个字节`PyObject`......但它可能仍然很糟糕，你失去的比你得到的多。）对不起，如果这只是一点点含糊不清，但希望它足以让你开始实验。

另一个想法是你可能可以并行化这个。任何有足够内存来处理大量列表的机器，我敢打赌它至少有 4 个内核。而且你有一长串完全独立的操作，这是世界上最容易并行化的事情。作为第一步，创建一个`multiprocessing.Pool`, 并使外部循环将作业提交到池中，而不是直接完成工作。您可能会发现作业太小，因此您淹没在开销中，但是您始终可以将每 N 个项目批量处理（明确地，或查看文档`grouper`中的配方`itertools`），并使作业成为“循环在这 N 个项目上，并返回具有最小 LSD 的项目”。（可能需要一些调整才能找到最佳 N。）您甚至可以与顶层一起执行此操作`numpy`，通过沿 x 轴将巨型阵列分成块并将它们作为工作进行耕种。

再想一想：您的算法从 N*M 的乘积开始，其中每个元素的长度为 N。然后，对于每个元素，您循环两次。因此，最好的性能将是 O(N^3*M)。这真的是正确的算法吗？如果是这样，您实际上是否从您的算法中获得了 N^3*M 的性能？如果这两个问题的答案是否定的，则您不应该尝试对其进行微优化。只有当你实际上得到了最有效的算法并且编码正确时，才值得做一些事情，比如矢量化、避免多余的工作、将紧密循环移动到 C++ 和 Fortran 中等等。否则，你只会回来说“但是当我达到上次测试运行的 4 倍时，它仍然会爆炸。”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T20:20:13.570

我要做的第一件事就是尽可能多地把它放在 Numpy 数组中。Numpy 中基于数组的操作以或多或少的 C 速度执行。看起来大部分事情都可以在 Numpy 中完成......

如果这不能让你的血液流动，那么我会分析代码，并在 Cython 中为瓶颈创建一个函数。假设你可以在列表/数组上放置一个静态类型，如果你想留在 Pythonic 世界，Cython 可能是你最好的选择。我亲眼目睹了使用 Cython 的一些瓶颈的 100 倍加速。

这是 他们文档中[使用 Cython 进行图像卷积的示例。](http://docs.cython.org/src/userguide/numpy_tutorial.html#the-first-cython-program)

# android - 为什么在 Android 上使用 getCacheDir()

> ID：13731203
> 
> 赞同：20
> 
> 时间：2012-12-05T19:48:41.707
> 
> 标签：android

一旦系统内存不足，Android 可能会自动删除 CacheDir 中的文件。但是文档说我们不应该依赖系统清除这个缓存，因此编写额外的代码来进行轮询和删除。

`getCacheDir()`如果是这种情况，为什么要选择`getFilesDir()`呢？两者都在内存中，后者在清理内容和时间方面为开发人员提供了更多权力。

谢谢！

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-12-05T23:49:46.667

> 一旦系统内存不足，Android 可能会自动删除 CacheDir 中的文件。

正确的。第三方应用程序还可以从应用程序的缓存目录中删除文件。而且，正如 zapl 所说，用户可以从“设置”中手动清除应用程序的缓存。

> 但是文档说我们不应该依赖系统清除这个缓存，因此编写额外的代码来进行轮询和删除。

也正确。

> 如果是这种情况，为什么要选择 getCacheDir() 而不是 getFileDir() ？

因为操作系统、第三方应用程序和用户*可以*清除缓存。但是，这些东西*能*清缓存，并不代表它们*会*自动清缓存，所以你需要时常自己清理缓存。同样，虽然您的母亲*可以*打扫您的房间，但如果您不想被扫帚击中，您最好自己打扫房间。

> 后者在清理内容和何时清理方面为开发人员提供了更多权力......

不，不是的。`getCacheDir()`返回一个`File`对象。`getFilesDir()`返回一个`File`对象。它们在“开发人员在清理内容和时间方面的权力”方面是等价的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-05T19:54:53.327

`getCacheDir()`返回缓存文件`getFilesDir()`的路径，同时返回创建和存储在应用程序内部存储中的文件的路径。内部存储是持久的：它不能被系统删除。

# mysql - 删除每个人除最后一个条目之外的所有条目

> ID：13731205
> 
> 赞同：1
> 
> 时间：2012-12-05T19:48:46.580
> 
> 标签：mysql, sql, sybase

我的数据库包含一个大约每月一次的条目，这些条目是由 ID 标识的一些个人的。日期存储在标题为 YEAR 和 WEEK 的字段中。我有一个二进制标志，称为 BINARY_FLAG。我想抓住二进制标志打开的特定年份中每个人的最后一周。

我提取初始数据的代码如下：

```
select ID, year, week, binary_flag
from my_table
where year = 2000 and
binary_flag = 1 
```

这将返回 2000 年二进制标志为 1 的所有条目。但是，如果二进制标志连续数周为 1，许多个人将有多个条目。我如何删除除上周以外的所有内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T19:54:14.313

```
select * from my_table t1
join 
(select ID, year, max(week) maxWeek
from my_table
where year = 2000 and
binary_flag = 1
group by Id,year) t2
on
(t1.Id=t2.id) and (t1.year=t2.year) and (t1.week=t2.maxWeek) 
```

# facebook - 错误检查 URL：检查 URL 时发生内部错误

> ID：13731206
> 
> 赞同：28
> 
> 时间：2012-12-05T19:48:53.437
> 
> 标签：facebook, debugging, facebook-opengraph, lint

如何**调试**facebook**调试器**？

问题的详细描述：

我使用“帖子和页面中的开放图形协议”插件为我自托管的 wordpress 网站上的帖子手动输入 OG 数据。在 Facebook 上分享它们之前，我在 FB 调试器工具中测试了帖子的 url，结果总是正确的。

但是，最近调试器返回了此错误消息：“错误检查 URL：检查 URL 时发生内部错误”，我好几天都无法摆脱它。我又试了几次调试，还是没用。它卡住了。我搜索了一个解决方案，但我找不到任何解决方案。我可能错了，但这个错误消息似乎很少见。

我不是专家，但我认为调试器工具不知何故被我帖子中的双 OG 数据弄糊涂了：

1.  我手动插入插件“在帖子和页面中打开图形协议”的 OG 信息。
2.  将视频插入帖子时，JWPLayer wordpress 插件自动生成的 OG 信息。

我只需要第一个，我通常删除 JWPlayer 的自定义字段，但这次我忘了这样做。

调试器返回错误消息后，我删除了 JWP 自定义字段，希望它们引起一些冲突，我保存了帖子并再次尝试调试。调试器再次返回错误消息。

Graph API 会看到关于我的帖子的过时信息，它不会刷新它，尽管我更正了帖子中的所有内容，之后我又调试了几次。在我看来，调试器在我的 url 中看到了一个错误并且不会忘记它。

我什至删除了帖子，将其内容复制并粘贴到了新帖子中，并给了它相同的标题（失去了那些可能会关注简短固定链接的访问者，但无论如何）。调试器对重新发布的帖子的反应方式相同。再次出现错误信息。我在调试器中测试了我的其他帖子，一切都很完美。很明显，调试器记住了这个特定的 url。如果我在 url 中以不同的标题重新发布帖子，问题就会消失。

我将那个有问题的网址分享给了 Facebook，奇怪的是它显示了正确的数据。一切似乎都正常：标题、描述、缩略图等……但是，我测试了帖子中的分享按钮，它在 Facebook 上显示了错误的数据，尽管我已经更正了。调试器会看到不再出现在帖子中的数据。出于这个原因，我被迫删除了分享按钮，这样访问者就不会在 Facebook 上分享错误的信息。

现在我处于一个矛盾的境地，试图找到一种方法来**调试调试器**。如何刷新它的内存以便它可以忘记我的 url 并且我可以从零开始重新开始？

如你所见，我不是这些问题的专家。我花了很多时间和资源来构建我的网站，而以前没有任何 php 和 css 知识，现在由于这些 facebook 错误，一切都陷入了困境。我正在浪费宝贵的时间来处理这种无稽之谈。为什么一切都必须如此复杂？我要求所有的开发人员，请制定一个好的、简单的、用户友好的和工作的标准并坚持下去。请停止复杂化。现在这个错误信息是什么？调试器绝对不提供任何解释和解决方案。它没有解决问题，而是陷入困境并成为问题本身。唯一能做的就是等待，希望错误会自行消失。这纯粹是胡说八道。

额外细节：

**这就是 Graph API 在我的网址中看到的内容。尽管该数据不再有效，但调试器仍会记住它。可以看到JWPLayer插件自动插入的视频OG：**

```
{
   "url": "http://mydomain/post-title/",
   "type": "video.movie",
   "title": "",
   "image": [
      {
         "url": "http://mydomain/uploads-folder/post-title-video-thumbnail.jpg"
      },
      {
         "url": "http://mydomain/uploads-folder/post-thumbnail.jpg"
      }
   ],
   "video": [
      {
         "url": "http://mydomain/uploads-folder/jw-player-plugin-for-wordpress/player/player.swf?file=http\u00253A\u00252F\u00252Fmydomain\u00252Ffiles\u00252Fvideo-title.flv&controlbar=bottom&dock=false&autostart=false&height=331&width=545&captions.back=false&captions.fontsize=12&captions.state=true&icons=true&playlist.position=none&playlistsize=180&repeat=none&shuffle=false&bufferlength=1&smoothing=true&stretching=uniform&wmode=opaque&mute=false&volume=90&plugins=captions-1\u00252Cgapro-2\u00252C&gapro.accountid=UA-76476476476-1&gapro.trackstarts=true&gapro.trackpercentage=true&gapro.tracktime=true",
         "type": "application/x-shockwave-flash",
         "width": 545,
         "height": 331
      }
   ],
   "description": "",
   "site_name": "here's the name",
   "updated_time": "2012-12-05T20:09:40+0000",
   "id": "754654658476545" 
```

**这是调试器在更正后现在应该看到的，但它没有这样做。但是，当 url 粘贴到 Facebook 时，它会正确显示：**

```
{
   "url": "http://mydomain/post-title/",
   "type": "website",
   "title": "here's the title",
   "image": [
      {
         "url": "http://mydomain/uploads-folder/post-thumbnail.jpg"
      }
   ],
   "description": "This is a story about...",
   "site_name": "my site",
   "updated_time": "2012-12-05T20:11:56+0000",
   "id": "754654658476545"
} 
```

**通过按钮共享时，它会显示以前的错误数据。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-29T10:29:19.773

强制 Facebook 爬虫重新获取您的数据：

[https://developers.facebook.com/docs/sharing/opengraph/using-objects#update](https://developers.facebook.com/docs/sharing/opengraph/using-objects#update)

> Facebook 爬虫将重新抓取（并因此更新）对象：
> 
> 在对象调试器中输入对象 URL 时 第一次抓取后每 30 天应用程序使用 API 端点触发抓取时 此 Graph API 端点只是对以下内容的调用：
> 
> `POST /?id={object-instance-id or object-url}&amp;scrape=true`
> 
> id 参数可以是对象的规范 URL，也可以是图中对象实例的 ID。

# javascript - window.onload 适用于 Firefox+Greasemonkey 脚本但不适用于 Chrome 用户脚本？

> ID：13731209
> 
> 赞同：7
> 
> 时间：2012-12-05T19:49:00.490
> 
> 标签：javascript, google-chrome, cross-browser, greasemonkey, userscripts

有一个页面[http://example.com/1.php](http://example.com/1.php)像往常一样包含 javascript 文件：

```
<script type="text/javascript" src="/util.js?1354729400"></script> 
```

该文件包含名为**exampleFunction**的函数，我需要在我的用户脚本中使用它。我还有一个用户脚本：

```
// ==UserScript==
// @name          SomeName
// @namespace     http://example.com/userscripts
// @description   Greets the world
// @include       http://example.com/*
// ==/UserScript==
window.onload = function () {
        console.log(exampleFunction);
      alert("LOADED!");
} 
```

它在 Firefox 中完美运行并在 Chrome 中返回错误：

```
Uncaught ReferenceError: exampleFunction is not defined 
```

我如何使它工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-06T00:09:59.750

未定义的原因`exampleFunction`是 Chrome 用户脚本在沙箱（[“孤立世界”](https://stackoverflow.com/a/10828021/331508)）中运行。请注意，Greasemonkey 脚本也经常在沙箱中运行，但您的*当前*正在使用[隐式`@grant none`](http://wiki.greasespot.net/@grant).
如果你的脚本要使用一个`GM_`函数，它也会在 Firefox 中停止工作。

要使此脚本在两种浏览器（以及其他一些浏览器）上都可以工作，请使用[类似于此答案的](https://stackoverflow.com/a/13485650/331508)*脚本注入* 。

*但是*，还有另一个问题，因为该脚本使用`window.onload`. [具有默认执行启动模式的 Chrome 用户脚本通常永远不会看到该`onload`事件。](http://developer.chrome.com/extensions/content_scripts.html#run_at)

要解决这个问题，请添加[`// @run-at document-end`](http://wiki.greasespot.net/Metadata_Block#.40run-at)到元数据块。

所以脚本变成了：

```
// ==UserScript==
// @name            SomeName
// @namespace       http://example.com/userscripts
// @description     Greets the world
// @include         http://example.com/*
// @run-at          document-end
// @grant           none
// ==/UserScript==

function GM_main () {
    window.onload = function () {
        console.log(exampleFunction);
        alert("LOADED!");
    }
}

addJS_Node (null, null, GM_main);

//-- This is a standard-ish utility function:
function addJS_Node (text, s_URL, funcToRun, runOnLoad) {
    var D                                   = document;
    var scriptNode                          = D.createElement ('script');
    if (runOnLoad) {
        scriptNode.addEventListener ("load", runOnLoad, false);
    }
    scriptNode.type                         = "text/javascript";
    if (text)       scriptNode.textContent  = text;
    if (s_URL)      scriptNode.src          = s_URL;
    if (funcToRun)  scriptNode.textContent  = '(' + funcToRun.toString() + ')()';

    var targ = D.getElementsByTagName ('head')[0] || D.body || D.documentElement;
    targ.appendChild (scriptNode);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-01-10T02:00:40.450

如果你想要等价于`onLoad`，它在页面上的所有图像都加载完毕后才会触发，你想`// @run-at document-idle`在你的元数据块中使用。默认值 document-end 在加载 DOM 时触发，相当于 document.ready。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T20:41:11.247

你试过用括号调用 examplefunction 吗？：） 像这样：

```
console.log(exampleFunction()); 
```

如果你在 chrome 控制台中尝试，你必须添加括号来调用函数。

# c++ - extern 可以解决这个问题，或者我可以通过什么其他方式解决这个问题？

> ID：13731212
> 
> 赞同：0
> 
> 时间：2012-12-05T19:49:13.750
> 
> 标签：c++, global-variables, extern

我正在重构一个相当大的代码库。以旧方式，有两个库：`FooFactory`和`BarLib`. `BarLib`依赖于`FooFactory`哪个又依赖于很多`Foo1`, `Foo2`,`Foo3`代码等...在构建时，`FooFactory`拉入所有`Foo`依赖项，然后`BarLib`可以`FooFactory`用来请求构建，例如 a `Foo7`。在我的重构中，我让所有的`FooX`人都依赖`FooFactory`（而不是相反），如果makefile碰巧链接了他们，我会静态地注册他们自己。`BarLib`仍然依赖于`FooFactory`但只有在`Foo7`它被链接并因此静态注册到`FooFactory`.

我遇到了以下问题：

有一个特殊`Foo14`的 ，主要工厂文件`FooFactory.C`用`FooFactory`一个`BarLib`设置的字符串构造。它的工作方式是`FooFactory.H`公开一个名为的全局函数`setString(const std::string&);`，并且在`.C`文件中它`std::string theString`在匿名命名空间中有一个变量。然后一个方法`BarLib`可能会也可能不会使用这个函数来设置这个字符串。而在 的语料库中`FooFactory.C`，这个字符串在 的构建过程中会被检查`Foo14`。

问题是，随着依赖关系的反转，这些`Foo`人的所有构造代码都保存在他们各自的库中，并且只有在他们静态注册时才会被调用。我没有简单的方法将其传递`std::string`给，`Foo14`因为它遵守为构造`Foo`. 如果我将字符串`theString`放入`Foo14.C`然后将强制`BarLib`依赖`Foo14`以设置它......所以我想知道我是否可以将它保留在中`FooFactory.C`，但将其`Foo14`声明为 extern 并使用它。即使`theString`在匿名命名空间中，这是否有效`FooFactory.C`？或者它现在必须是一个全球性的生活在标题中？或者什么是替代解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T22:07:55.677

您不能从另一个文件引用匿名命名空间中定义的变量，请在此处查看更多信息：[匿名命名空间](https://stackoverflow.com/questions/3363684/anonymous-namespace)

不必在共享标头中定义全局变量。为了允许从其他文件中引用，将它们定义为不在匿名命名空间中并且不是静态的就足够了。

# jquery - 动态创建鼠标悬停效果

> ID：13731215
> 
> 赞同：0
> 
> 时间：2012-12-05T19:49:31.700
> 
> 标签：jquery

我正在创建一个可以包含随机数量的画廊项目的照片库。代码如下所示：

```
<div class="gallery-item">
   <div id="gal-img1"><a href=""><img src="15.jpg"></a></div>
   <div class="gal-desc" id="gal-desc1"><h5>Title</h5></div>
</div> 
.........

<div class="gallery-item">
   <div id="gal-imgn"><a href=""><img src="15.jpg"></a></div>
   <div class="gal-desc" id="gal-descn"><h5>Title</h5></div>
</div> 
```

“gal-desc”类的“display”设置为“none”，在 gal-img(1) 到 gal-img(n) 鼠标悬停时，我想将其相应 gal-desc 的“display”设置为“block” (1) 到 gal-desc(n)。

我可以手动插入从 1 到 100 的以下代码，但如果我将获得 40 个画廊项目，我将有 60 个鼠标悬停不可用。如果我有 110 个画廊项目，那么 10 个项目不会产生预期的效果。

```
$("#gal-img1").mouseover(function(){  
    $("#gal-desc1").css('display','block'); 
}); 
```

我用 $("div[id^=gal-img]").length 获得的画廊项目的最大数量，但从这里开始我被卡住了。

请你们给我一个想法，我必须朝哪个方向走。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:02:11.317

改变

```
<div id="gal-imgn"> 
```

至

```
<div class="gal-img"> 
```

然后这样做：

```
$(".gal-img").mouseover(function(){  
    $(this).next(".gal-desc").show(); 
}); 
```

另外，您可以像这样添加 mouseout：

```
$(".gal-img").mouseover(function(){  
    $(this).next(".gal-desc").show(); 
}).mouseout(function(){
    $(this).next(".gal-desc").hide();
}; 
```

这是这个（低效）代码的乐趣。 [http://jsfiddle.net/d27Nn/1/](http://jsfiddle.net/d27Nn/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T19:54:31.567

我不确定我是否理解这个问题，也许你正在寻找一些 CSS？就像是：

```
.gallery-item > div:first-child:hover{display:block;} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T19:54:50.287

您可以使用相同的选择器来定位所有元素，以获取正确数量的元素，然后在函数内部使用上下文仅定位`.gal-desc`悬停元素父级内的元素`.gallery-item`等：

```
$("div[id^=gal-img]").on('mouseenter', function() {
    $(this).closest('.gallery-item').find('.gal-desc').show();
}); 
```

或在鼠标进入/离开时切换可见性

```
$("div[id^=gal-img]").on('mouseenter mouseleave', function(e) {
    $(this).closest('.gallery-item').find('.gal-desc').toggle(e.type=='mouseenter');
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-05T19:58:33.650

使用事件委托，它在 jQuery 中使用 $.on 可用。将所有 .gallery-items 包装在一个容器中，使其像我在下面对 .gallery 所做的那样工作。这将允许无限数量的 .gallery-items 并且非常高效。

```
<div class="gallery">
    <div class="gallery-item">
        <div id="gal-imgn"><a href=""><img src="15.jpg"></a></div>
        <div class="gal-desc" id="gal-descn"><h5>Title</h5></div>
    </div> 
    .....
</div>
.....
$('.gallery').on('mouseenter mouseleave', '.gallery-item', function (e) {
    if (e.type === 'mouseenter') {
        $(this).find('.gal-desc').show();
    }
    else {
        $(this).find('.gal-desc').hide();
    }
}); 
```

# java - 如何从 Java 中的纪元（1970-01-01）获得毫秒？

> ID：13731218
> 
> 赞同：93
> 
> 时间：2012-12-05T19:49:42.940
> 
> 标签：java, date

我需要获取从 1970-01-01 UTC 到现在 Java 中的 UTC 的毫秒数。

我还希望能够获得从 1970-01-01 UTC 到任何其他 UTC 日期时间的毫秒数。

* * *

## 回答 #1

> 赞同：185
> 
> 时间：2012-12-05T19:52:09.967

怎么样[`System.currentTimeMillis()`](http://docs.oracle.com/javase/6/docs/api/java/lang/System.html#currentTimeMillis%28%29)？

来自 JavaDoc：

**返回：** *当前时间与 UTC 1970 年 1 月 1 日午夜之间的差值，以毫秒为单位*

**Java 8**引入了该[`java.time`](https://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)框架，特别是[`Instant`](https://docs.oracle.com/javase/8/docs/api/java/time/Instant.html)“ *...对时间线上的 ... 点进行建模...* ”的类：

```
long now = Instant.now().toEpochMilli(); 
```

**返回：** *自 1970-01-01T00:00:00Z 纪元以来的毫秒数*——即与上面几乎相同:-)

干杯，

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2015-12-23T14:14:51.857

# java.time

使用[`java.time`](http://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)Java 8 及更高版本中内置的框架。

```
import java.time.Instant;

Instant.now().toEpochMilli(); //Long = 1450879900184
Instant.now().getEpochSecond(); //Long = 1450879900 
```

这在 UTC 中有效，因为`Instant.now()`它确实是调用`Clock.systemUTC().instant()`

[https://docs.oracle.com/javase/8/docs/api/java/time/Instant.html](https://docs.oracle.com/javase/8/docs/api/java/time/Instant.html)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-12-05T19:52:36.637

也试试`System.currentTimeMillis()`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-09-02T15:46:43.497

你也可以试试

```
 Calendar calendar = Calendar.getInstance();
  System.out.println(calendar.getTimeInMillis()); 
```

getTimeInMillis() - 当前时间，距纪元的 UTC 毫秒数

# node.js - nodejs，如何检查是否在每个页面上都定义了会话

> ID：13731220
> 
> 赞同：1
> 
> 时间：2012-12-05T19:49:45.140
> 
> 标签：node.js, session, express

我正在使用 express 开发一个简单的网站。我只是对如何在渲染任何页面之前让 nodejs 检查会话感到困惑，这样如果用户没有登录，他就看不到任何东西。

我认为在 Rails 中这很简单，只需在应用程序控制器中添加一些代码即可。但是如何在nodejs中处理这样的事情？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T19:59:28.040

定义一个中间件函数以在您的路由之前检查身份验证，然后在您的每个路由上调用它。例如在你的 app.js

```
// Define authentication middleware BEFORE your routes
var authenticate = function (req, res, next) {
  // your validation code goes here. 
  var isAuthenticated = true;
  if (isAuthenticated) {
    next();
  }
  else {
    // redirect user to authentication page or throw error or whatever
  }
} 
```

然后在你的路由中调用这个传递这个方法（注意 authenticate 参数）：

```
app.get('/someUrl', authenticate, function(req, res, next) {
    // Your normal request code goes here
});

app.get('/anotherUrl', authenticate, function(req, res, next) {
    // Your normal request code goes here
}); 
```

# azure - Azure VM CSUPLOAD RDP

> ID：13731221
> 
> 赞同：0
> 
> 时间：2012-12-05T19:49:52.620
> 
> 标签：azure, rdp, vhd

我正在尝试使用 CSUPLOAD 将 VM 上传到 Azure。

我已经尝试了 Add-Disk 和 Add-PersistentVMImage 并且都成功地配置和启动了 VM，但我无法使用远程桌面连接到它。

现在，我尝试上传的 VM 是全新安装的 Server 2008 R2，启用了远程桌面并进行了 sysprep。（我确认我能够在我的本地网络上远程访问它）。

我在 VM 上有一个端点，公共端口和私有端口都是 3389。

我可以看到我的 VM 与我从图库中创建的 VM 之间的唯一区别是图库中的 VM 具有 RDP 证书指纹，而我的则没有。

丢失的指纹是否会导致 RDP 无法工作。我该如何配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T15:21:56.043

我之前使用 Windows 7 来创建图像。我尝试使用 Hyper V 创建映像，最终修复了 Add-PersistantImage 和 Add-Disk

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T07:00:21.277

查看这篇文章：http: [//msdn.microsoft.com/en-us/library/windowsazure/gg465385.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/gg465385.aspx)。

基本上，您必须首先使用门户上传管理证书，然后执行上传，将证书的指纹作为参数传递：

`csupload Set-Connection "SubscriptionId=[SubscriptionId];CertificateThumbprint=[CertThumbprint];ServiceManagementEndpoint=https://management.core.windows.net"`

# iphone - 如何从目标 c 类调用以查看 iphone 中的控制器类

> ID：13731222
> 
> 赞同：1
> 
> 时间：2012-12-05T19:49:51.643
> 
> 标签：iphone, objective-c

我正在从视图控制器类调用方法到目标 c 'dbhelper' 类，反之亦然。当我从视图控制器类调用 dbhelper 类的方法时。像这样我在视图控制器中为按钮创建了一个方法，在这个方法中我像这样调用 dbhelper 类

```
- (IBAction) clickme 
{
dbhelper *dbhelp = [[dbhelper alloc] init];
[dbhelp dbhelperclassmethod];
} 
```

它工作正常但是当我从 dbhelper 类调用视图控制器类的方法时，方法调用不能像这样工作我已经在 dbhelper 类中创建了方法，我从那里调用 viewcontroller 类方法

```
 -(void) disableview
    {
       ViewController *Controller = [[ViewController alloc] init];
        [Controller ViewControllerclassmethod];

  } 
```

所以这个方法不调用viewcontroller类方法，上面的代码不是原始代码，但我写这个代码是为了你的理解，这样你就可以回答我是什么问题。所以请告诉我为什么我不能调用viewcontroller来自 dbhelper 的课程谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T22:19:19.683

在我看来，您正在类中创建一个新实例`ViewController`，`dbhelper`并将其发送`ViewControllerclassmethod`到该新实例，而不是您期望的实例。如果你想让你的实例在你调用的实例中调用`dbhelper`方法，那么你必须告诉在哪里发送消息。就像是：`ViewController``dbhelper``dbhelper`

```
dbhelp.callingViewController = self; 
```

在您的 ViewController 实例中。然后`dbhelper`可以做

```
[self.callingViewController ViewControllerclassmethod]; 
```

当然，在 中`dbhelper.h`，必须有一个

```
@property (strong) ViewController * callingViewController; 
```

`Controller`您在上面的方法中所指的是`disableview`一个全新的 ViewController，与调用`dbhelper`.

另一个提示：关于目标 C 中的命名约定实际上非常有用。您调用的类`dbhelper`最好称为`DatabaseHelper`（大写“D”），而局部变量`Controller`最好称为`controller`. 其他人，很快你，会发现更容易遵循你的代码。同样，`disableView`and `viewControllerInstanceMethod`（而不是类方法，这是完全不同的事情）。

# actionscript-3 - 需要帮助 AS3 navigateToURL 打开新窗口

> ID：13731223
> 
> 赞同：1
> 
> 时间：2012-12-05T19:50:02.033
> 
> 标签：actionscript-3, navigatetourl

AS3 菜鸟在这里。我正在使用以下代码成功地将 var 发送到我的 php/数据库。当然，我的问题是，当我单击 Flash 电影中的按钮时，浏览器会导航到“http://www.mydomain.com/charity.php?id=c”网址。

```
 function onPressHandlerc(evt:MouseEvent):void { 
    var url:String = "http://www.mydomain.com/charity.php?id=c";
    var request:URLRequest = new URLRequest(url);
    try {
    navigateToURL(request, '_blank');
    } catch (e:Error) {
    trace("Error occurred!");
    }
    } 
```

如何将 navigateToURL() 设置为不尝试打开“_blank”窗口而只是静默传递 var？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:08:03.467

啊，认为您实际上想在这种情况下使用 URLLoader 而不是 navigateToURL。如果您熟悉， navigateToURL 与 js 中的 window.open 非常相似，您想要更像 AJAX 的东西，我认为这就是 URLLoader 的用武之地。

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/URLLoader.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/URLLoader.html)

[http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118a9b90204-7cfd.html#WS5b3ccc516d4fbf351e63e3d118a9b90204-7cf5](http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118a9b90204-7cfd.html#WS5b3ccc516d4fbf351e63e3d118a9b90204-7cf5)

# jquery - .on() 方法在某些情况下不会触发

> ID：13731231
> 
> 赞同：1
> 
> 时间：2012-12-05T19:50:31.223
> 
> 标签：jquery

在某些情况下 .on() 事件方法不会触发，但 .live() 会触发。
但是，从 jQuery 1.7 开始，不推荐使用 .live() 方法。
所以最好使用 .on() 方法来附加事件处理程序。

所以这里是问题 - [http://jsfiddle.net/rGRdT/2/](http://jsfiddle.net/rGRdT/2/)
您可以看到当您单击按钮时调用了一次 .one() 方法，但是当您单击刚刚创建的第二个按钮时， .on() 不会被调用。

```
$('#button2').on('click', function() {
    $('div').append('<input type="button" value="add2" id="button3" />'); 
}); 
```

你可以在这里看到 - [http://jsfiddle.net/GFCt9/](http://jsfiddle.net/GFCt9/)
当你点击第二个按钮时， .live() 方法被完美地调用了。

```
$('#button2').live('click', function() {
    $('div').append('<input type="button" value="add2" id="button3" />');
});​ 
```

那么我怎样才能使用 .on() 方法，让它像上面示例中的 .live() 方法一样工作呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T19:51:59.170

```
$('#button2').live('click', function() { 
```

不等于

```
$('#button2').on('click', function() { 
```

但要

```
$(document).on('click', '#button2', function() { // you may replace document with something more precise but existing 
```

`button2`如果您调用 id 时不存在您的元素，则`$('#button2').on`您没有绑定任何内容。这与`live`. 您必须调用`on`非空集合。

[`Sample`](http://jsfiddle.net/rGRdT/6/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T19:59:57.657

您的示例“非工作” jsfiddle 脚本有一个错误阻止它工作：一个简单的 javascript 错误`('di'v).on(`阻止*所有*脚本运行。

试试[你的小提琴，更新](http://jsfiddle.net/rGRdT/7/)后看到`.on()`语法按你期望的那样工作。在您提供的简单案例中，不需要使用`.live()`也不需要新方法`.on('event', 'selector', fn)`。

# android - 如何处理 json 对象的空响应

> ID：13731236
> 
> 赞同：2
> 
> 时间：2012-12-05T19:50:46.763
> 
> 标签：android, json

我得到一个 JSON 响应

```
{
"edges": [],
"nodes": []
} 
```

如何检查对象是否具有空值并处理案例？

```
JSONObject jobj = new JSONObject(line);
JSONArray jArray = jobj.getJSONArray("edges");
if(jArray.length()!=0)
{    
  for(int i=0;i<jArray.length();i++){
  JSONObject json_data = jArray.getJSONObject(i);
  x.add((float) json_data.getInt("x"));
  y.add((float) json_data.getInt("y"));
end 
```

这让我返回：org.json.JSONException: end of input at character 0 of

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T21:03:40.723

试试这个：

```
String jsonString = "{ "edges": [], "nodes": [] }";

JSONObject jsonObject = new JSONObject(jsonString);

if( jsonObject.isNull("edges") == false) {
//do sth
}

if( jsonObject.isNull("nodes") == false) {
//do sth
} 
```

您还可以通过 jsonObject.has("edges") 检查您的 json 中是否有一些特定的键

您将一些 \line\ 变量传递给 JSONObject 构造函数。确保此变量包含您的整个 json 字符串，例如我的示例中的这个字符串，而不是像 "{" 或 ' "edges": [] ' 可能问题出在您的 json 源中，如评论中建议的 dokkaebi

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T11:02:17.123

试试这个。我仅显示一个数组的示例，具体取决于标志值，您可以显示正确的错误消息，或者成功后您可以将解析的数据绑定到 UI 组件。

```
String impuStr = "{\"edges\": [],\"nodes\": []}"; 
```

字符串标志 = serverResponse(impuStr);

私人字符串服务器响应（字符串jsonStr）{字符串标志=“成功”；

```
 JSONObject jobj;
    try {
        jobj = new JSONObject(jsonStr);

        JSONArray jArrayEdges = jobj.getJSONArray("edges");
        if(jArrayEdges != null && jArrayEdges.length() > 0)
        {    
          for(int i=0;i<jArrayEdges.length();i++)
          {
              JSONObject json_data = jArrayEdges.getJSONObject(i);
              // process data here
          }
         }else
             flag = "edges_list_empty";

    } catch (JSONException e) 
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
        flag = "failure";
    }

    return flag;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-05T19:55:41.317

您可以检查为：

```
JSONObject jobj = new JSONObject(line);
if (jobj.getJSONArray("edges").length() == 0) {

    System.out.println("JSONArray is null");      
 }
 else{
      System.out.println("JSONArray is not null");
      //parse your string here         
     } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T19:52:27.917

使用简单的 java 规则。检查数组是否为空，如果数组不存在并且您尝试获取它，它只会返回 null。只要处理它。如果您知道它会失败，请不要继续解析。只是优雅地存在。

```
if (myObj != null)
{
  ... process
} 
```

# algorithm - 基于正方形瓦片直角三角形象限的坐标系边界框

> ID：13731240
> 
> 赞同：2
> 
> 时间：2012-12-05T19:51:06.367
> 
> 标签：algorithm, math, data-structures, language-agnostic, geometry

我正在为游戏创建一个基于图块的 2D 地形系统。但是，我也在使用游戏中的坐标，它需要能够将边界框映射到“图块坐标”并点击边界框接触的每个图块（别担心，有一个 kd-tree 和所有这些工作美好的）。使用定点“真实世界”坐标，我可以将每个图块计为 2^n 个，然后简单地将位右移以截断到图块坐标。我使用最小的 x,y 对和最大的 x,y 对形成一个边界框。我会分别给他们`R0`打电话`R1`。

这是一个边界框，其中包含要映射到图块的`R0: 0.8, 0.7`坐标`R1: 2.2, 1.7`。

![在此处输入图像描述](../Images/495619d291201c2b147bc7db017309c8.png)

现在，这很简单。但是，我想将我的图块分成 4 个三角形象限，这让我可以制作更有趣的东西。由于每个图块变成了 4 个三角形，我假设它们可以以某种方式被 2 位引用（不一定是我展示的那个）。我想使用尽可能少的位来“标记”这些三角形。我将把我的三角形标签放在它的平铺坐标旁边，以 [XX] 的形式，其中 XX 是指示它是哪个三角形的位。

![在此处输入图像描述](../Images/276bf9d8b17f3c885737bbf3d302303a.png)

但是，我在使用它时遇到了几个问题。我需要能够将我的真实世界边界框坐标转换为“三角形坐标”，但似乎完全描述边界框太有损了。三角形区域中的相同坐标可以描述与不同三角形碰撞的边界框。

我在左边有和以前一样的第一个边界框：`R0: 0.8, 0.7`to`R1: 2.2, 1.7`
在右边，我有一个新的边界框`R0: 0.8, 0.3`to `R1: 2.2, 1.7`，所以左上角的 y 分量向上移动。它们都转换为相同的三角形坐标，但如果在现实世界坐标中完成，则会与不同的三角形发生碰撞。但是，在三角坐标中没有区别，因此数据丢失并生成了一组不正确的碰撞。

![在此处输入图像描述](../Images/4454fca824064f7b3ca9dfb415d15118.png)

此外，在同一个三角形中开始和结束的边界框也会出现同样的问题。相同的三角形坐标描述了有时完全在该三角形中的边界框，有时则不在。

![在此处输入图像描述](../Images/11f774002c91f897abd117d6cf2da25d.png)

必须有一种方法来映射这些，可能使用更多位，以便在 kd-tree 范围查询中执行的所有三角形坐标比较可以匹配真实世界边界框与真实世界坐标中的相同三角形的碰撞方式。但我不知所措。

我沿着兔子洞创建了“子图块”，将每个图块分成 4 个轴对齐的正方形，这也将每个象限图块沿着它穿过的轴分成 2 个，因为我注意到很多情况是由于不知道哪一侧造成的我的坐标映射到的每个三角形。

![在此处输入图像描述](../Images/ab4c403f8eab29613dd49be426b4a4e3.png)

但是当我遵循一个又一个例外的例外规则时，我最终将我的子图块变成了相同的 4 个三角形象限设计，并在我开始的地方结束，除了更小的图块。

我知道必须*有*可能实现这种“压缩”并进行适当的比较，但每当我尝试时，我都会一直在兜圈子。怎么做到呢？？

**编辑：**
[Alexey 提出了一个解决方案](https://stackoverflow.com/questions/13731240/bounding-boxes-in-coordinate-system-based-on-right-triangle-quadrants-of-square/13733010#13733010)，可以让我描述边界框，但它与使用 kd-tree 查找边界框重叠不兼容。使用我的 kd-tree（存储左上角和右下角坐标）范围查询和搜索区域`[x0, y0], [x1, y1]`，我进行范围查询：

`[0, 0, x1, y1]`至`[x1, y1, xmax, ymax]`

但 Alexey 的解决方案不适用于此，即使我试图补偿 8 维坐标。

我真的不介意坐标系是否与我最初考虑的有所不同，只要它仍然可以在三角形象限中表现出相同的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T21:42:40.890

似乎您需要的最小细分是将每个正方形分成八分圆。每个正方形应被两条对角线和水平和垂直中线分开。如果对于盒子的**每个角**（不仅是左上角和右下角，而是所有四个角），您存储它最终位于哪个图块的哪个八分圆中，您将有足够的信息来查找与所有原始三角形图块的碰撞（但不是所有的八分圆）。

# c++ - Windows XP 中的 inet_pton 或 InetPton 是什么？

> ID：13731243
> 
> 赞同：9
> 
> 时间：2012-12-05T19:51:19.677
> 
> 标签：c++, c, windows-xp, ip, ip-address

我需要确定一个特定的字符串是有效的 IPv4 还是 IPv6 地址文字。如果我理解正确，在 POSIX 系统上执行此操作的正确方法是使用`inet_pton`将其转换为网络地址结构并查看它是否成功。Windows Vista 和更高版本具有`InetPton`基本相同的功能。但据我所知，Windows XP 没有声明其中任何一个，我需要能够在 XP 上正确执行此操作。那么，问题是使用什么系统功能来做到这一点？

最坏的情况，我可以编写一个函数来自己解析它，但我更喜欢一个标准的系统函数，因此它已经过彻底测试并正确处理所有极端情况等等。微软不能`inet_pton`像其他人一样宣布并`InetPton`支持他们的新操作系统，这已经够糟糕的了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-12-28T16:55:03.693

在 Windows XP 中，您可以使用以下功能：

```
#include <stdlib.h>
#include <string.h>
#include <stdio.h>

#include <winsock2.h>
#include <ws2tcpip.h>

int inet_pton(int af, const char *src, void *dst)
{
  struct sockaddr_storage ss;
  int size = sizeof(ss);
  char src_copy[INET6_ADDRSTRLEN+1];

  ZeroMemory(&ss, sizeof(ss));
  /* stupid non-const API */
  strncpy (src_copy, src, INET6_ADDRSTRLEN+1);
  src_copy[INET6_ADDRSTRLEN] = 0;

  if (WSAStringToAddress(src_copy, af, NULL, (struct sockaddr *)&ss, &size) == 0) {
    switch(af) {
      case AF_INET:
    *(struct in_addr *)dst = ((struct sockaddr_in *)&ss)->sin_addr;
    return 1;
      case AF_INET6:
    *(struct in6_addr *)dst = ((struct sockaddr_in6 *)&ss)->sin6_addr;
    return 1;
    }
  }
  return 0;
}

const char *inet_ntop(int af, const void *src, char *dst, socklen_t size)
{
  struct sockaddr_storage ss;
  unsigned long s = size;

  ZeroMemory(&ss, sizeof(ss));
  ss.ss_family = af;

  switch(af) {
    case AF_INET:
      ((struct sockaddr_in *)&ss)->sin_addr = *(struct in_addr *)src;
      break;
    case AF_INET6:
      ((struct sockaddr_in6 *)&ss)->sin6_addr = *(struct in6_addr *)src;
      break;
    default:
      return NULL;
  }
  /* cannot direclty use &size because of strict aliasing rules */
  return (WSAAddressToString((struct sockaddr *)&ss, sizeof(ss), NULL, dst, &s) == 0)?
          dst : NULL;
} 
```

而已。与 ws2_32 库链接。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-13T17:24:55.930

> 但据我所知，Windows XP 没有声明其中任何一个，我需要能够在 XP 上正确执行此操作。

**[InetPton 文档](http://msdn.microsoft.com/en-us/library/windows/desktop/cc805844.aspx)**说明了以下要求：

*   **支持的最低客户端：** Windows Vista [仅限桌面应用程序]
*   **支持的最低服务器：** Windows Server 2008 [仅限桌面应用程序]

> 最坏的情况，我可以编写一个函数来自己解析它，但我更喜欢一个标准的系统函数，因此它已经过彻底测试并正确处理所有极端情况等等。

**[依赖 OSS 网络工具Wireshark](http://www.wireshark.org/)**的部分代码怎么样？

您可以在他们的**[源代码存储库](https://github.com/wireshark/wireshark/blob/90644c83725f979f82e7990792faaf6e847f74ea/wsutil/inet_pton.c)****中找到他们对inet_pton**的重新实现。

许可证（见下文）非常宽松，因此可能是一个不错的选择。

> 只要上述版权声明和本许可声明出现在所有副本中，特此授予以任何目的收费或免费使用、复制、修改和分发本软件的许可。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-06T11:16:44.300

`inet_pton()`查看我发现在“c:\Program Files\Microsoft SDKs\Windows\v7.1\Include\WS2tcpip.h”中声明 的 SDK 头文件。`InetPton`只是一个#define。

所以，看起来微软毕竟提供了正确的界面，但只是从 Vista 开始。但是如果我没记错的话，XP 没有值得一提的 IPv6 支持。

另一种选择是自己用两个调用来包装它`WSAAddressToString()`，一个用`AF_INET`，一个用`AF_INET6`。我从文档中猜到这里，还没有尝试过。

# javascript - Appfog，nodejs，环境变量：服务在某一点不包含，但在另一点包含

> ID：13731246
> 
> 赞同：1
> 
> 时间：2012-12-05T19:51:24.010
> 
> 标签：javascript, node.js, object, appfog

我的 server.js 中有以下代码：

```
throw new Error('The databasenumber was wrong, or you didn\'t bind one.' + process.env.VCAP_SERVICES + " === " + process.env.VCAP_SERVICES["mysql-5.1"]); 
```

此时的输出是：

```
node.js:201
    throw e; // process.nextTick error, or 'error' event on first tick
          ^
Error: The databasenumber was wrong, or you didn't bind one.{"mysql-5.1":[{"name":"squarific-data","label":"mysql-5.1","plan":"free","tags":["mysql","mysql-5.1","relational","mysql-5.1","mysql"],"credentials":{"name":"d3d440f0f5eef44ceb9c5e27a94666b58","hostname":"eu01-user01.cbxizyg0fwcn.eu-west-1.rds.amazonaws.com","host":"eu01-user01.cbxizyg0fwcn.eu-west-1.rds.amazonaws.com","port":3306,"user":"uzb6UEDnb5huk","username":"uzb6UEDnb5huk","password":"***"}}]} === undefined
at Object.<anonymous> (/mnt/var/vcap.local/dea/apps/squarific-0-230c9a683dff6b045aa2a237ae9bf515/app/server.js:12:9)
at Module._compile (module.js:441:26)
at Object..js (module.js:459:10)
at Module.load (module.js:348:31)
at Function._load (module.js:308:12)
at Array.0 (module.js:479:10)
at EventEmitter._tickCallback (node.js:192:40) 
```

虽然这当然应该是：

```
node.js:201
    throw e; // process.nextTick error, or 'error' event on first tick
          ^
Error: The databasenumber was wrong, or you didn't bind one.{"mysql-5.1":[{"name":"squarific-data","label":"mysql-5.1","plan":"free","tags":["mysql","mysql-5.1","relational","mysql-5.1","mysql"],"credentials":{"name":"d3d440f0f5eef44ceb9c5e27a94666b58","hostname":"eu01-user01.cbxizyg0fwcn.eu-west-1.rds.amazonaws.com","host":"eu01-user01.cbxizyg0fwcn.eu-west-1.rds.amazonaws.com","port":3306,"user":"uzb6UEDnb5huk","username":"uzb6UEDnb5huk","password":"***"}}]} === [{"name":"squarific-data","label":"mysql-5.1","plan":"free","tags":["mysql","mysql-5.1","relational","mysql-5.1","mysql"],"credentials":{"name":"d3d440f0f5eef44ceb9c5e27a94666b58","hostname":"eu01-user01.cbxizyg0fwcn.eu-west-1.rds.amazonaws.com","host":"eu01-user01.cbxizyg0fwcn.eu-west-1.rds.amazonaws.com","port":3306,"user":"uzb6UEDnb5huk","username":"uzb6UEDnb5huk","password":"***"}}]
at Object.<anonymous> (/mnt/var/vcap.local/dea/apps/squarific-0-230c9a683dff6b045aa2a237ae9bf515/app/server.js:12:9)
at Module._compile (module.js:441:26)
at Object..js (module.js:459:10)
at Module.load (module.js:348:31)
at Function._load (module.js:308:12)
at Array.0 (module.js:479:10)
at EventEmitter._tickCallback (node.js:192:40) 
```

它不应该是未定义的，因为您可以清楚地看到 ["mysql-5.1"] 实际上是一个数组。我不知道它为什么会出现这种奇怪的行为，而且我在任何地方都找不到它为什么会这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T06:05:40.200

服务变量作为 JSON 字符串而不是 appfog 的对象传递。

# java - 使用脚本运行 java jar 文件

> ID：13731249
> 
> 赞同：0
> 
> 时间：2012-12-05T19:51:32.687
> 
> 标签：java, linux, shell, threadpool

我有一个我不知道如何解决的问题。我使用 1 个单线程的执行程序服务制作了一个 java 轮询应用程序。该服务进行一些文件操作和数据库交互。

如果我们使用命令 promt/executable jar 中的 java -jar myapp.jar 运行，它会运行。我们可以随时阻止它。

现在我需要为用户制作 2 个脚本（比如 tomcat）。一个用于启动应用程序，另一个用于停止。

但想法是当用户执行脚本停止时，该进程不会被杀死，直到执行器服务的所有作业/线程完成。因为，如果我们在运行状态下终止进程，执行该作业的系统将停止可能处于不一致状态（例如在移动文件期间）。

问题是，我无法从 shell 脚本访问 ExecutorService 结果。

如何制作两个脚本来运行此应用程序并控制和访问行为。?

## 编辑：

我的 myapp.jar 运行定期执行器服务。我需要制作一个停止脚本，它只允许在执行程序服务未运行任务后停止，而不是终止进程。因为，如果我在运行过程中杀死进程，我就会失去系统的一致性。我的系统读取文件并将其移动到另一个目录中。如果我在中间杀死，有些文件会被处理，有些则不会。我需要一个解决方案，如果用户从 UNIX 系统执行停止脚本，该脚本要么不会终止进程，要么等到作业完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:31:21.723

我想 Shutdown Hook 是您需要的解决方案。Shutdown Hooks 让用户可以完全控制执行关闭操作的线程。可以在适当的线程组中创建线程，给定正确的优先级、上下文和特权等。

### 示例程序

```
public class ShutDownHook {

    public static void main(String[] args) {

        final Thread mainThread = Thread.currentThread();
        Runtime.getRuntime().addShutdownHook(new Thread() {
            public void run() {
                // Add your cleanup logic here
                System.out.println("Shutdown hook is executing");
                try {
                    mainThread.join();
                } catch (InterruptedException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
        });

        System.exit(0);
    }
} 
```

### 输出

```
Shutdown hook is executing 
```

*   `Runtime.getRuntime().addShutdownHook(Thread h)`添加钩子和
*   `Runtime.getRuntime().removeShutdownHook(Thread h)`删除作为参数给出的指定钩子。

您只需要在上面指定的关闭挂钩中添加正确的代码逻辑。

参考链接[javadoc](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Runtime.html)，[一篇博文](http://weblogs.java.net/blog/dwalend/archive/2004/05/shutdown_hooks_2.html)

# nssavepanel - NSSavepanel 字段编辑器

> ID：13731250
> 
> 赞同：2
> 
> 时间：2012-12-05T19:51:35.027
> 
> 标签：nssavepanel

我有一些代码可以在 NSSavePanel 中选择没有扩展名的名称，我很久以前就离开了网络，当时似乎工作正常。我只是重用了代码，现在失败了。错误是“[mySavePanel fieldEditor: NO forObject: nil]”返回 nil。如果我将“NO”更改为“YES”，它会返回一个 NSText 项，但它不是 NSSavePanel 中的名称编辑器。

```
NSSavePanel *mySavePanel = [NSSavePanel savePanel];
[mySavePanel setTitle: @"Restore File"];
[mySavePanel setMessage: @"Select a location and name to restore the file as:"];
[mySavePanel setNameFieldStringValue: currentRecord.originalName];

NSText *editor = [mySavePanel fieldEditor: NO forObject: nil];
if (editor)
{
    NSString *nameFieldString = [mySavePanel nameFieldStringValue];
    NSString *nameFieldExt = [nameFieldString pathExtension];
    if (nameFieldExt != nil)
    {
        NSInteger newLength = [nameFieldString length] - [nameFieldExt length] - 1;
        [editor setSelectedRange: NSMakeRange(0, newLength)];
    }
} 
```

这里有点难过，有人知道为什么它会返回 nil 吗？

# asp.net-mvc - Ajax.BeginForm 总是触发 OnSuccess 方法，即使数据不正确

> ID：13731254
> 
> 赞同：2
> 
> 时间：2012-12-05T19:51:51.533
> 
> 标签：asp.net-mvc, forms, razor, ajax.beginform

我正在尝试将表单提交给控制器操作并根据 OnSuccess 或 OnFailure 处理响应。问题是，即使数据无效并且我未能通过 ModelState.IsValid 测试，也会调用 OnSuccess 方法。应该调用 OnFailure 方法。

我的观点：

```
@using (Ajax.BeginForm("UpdateCategory", "Home", null, new AjaxOptions { HttpMethod = "Post", UpdateTargetId = "categoryForm", OnSuccess = "alert('success');", OnFailure = "alert('failure');" }, new { id = "formEditCategory" }))
{
    @Html.ValidationSummary(true)

    @Html.HiddenFor(model => model.CategoryID)

    <div>
        <div class="editor-label">
            @Html.LabelFor(model => model.CategoryName)
        </div>
        <div class="small-multiline-field">
            @Html.EditorFor(model => model.CategoryName)
        </div>
        <div class="validationMsg">
            @Html.ValidationMessageFor(model => model.CategoryName)
        </div>
    </div>
} 
```

我的控制器动作：

```
[HttpPost]
public ActionResult UpdateCategory(CategoryVM category)
{
    try
    {
        if (ModelState.IsValid)
        {
            var itemService = new ItemViewModels();
            itemService.UpdateCategory(category);
        }
    }
    catch (DataException)
    {
        //Log the error (add a variable name after DataException)
        ModelState.AddModelError("", "Unable to save changes. Try again, and if the problem persists, see your system administrator.");
    }

    return PartialView("EditCategoryInfo", category);
} 
```

我的视图模型：

```
public class CategoryVM
{
    public int CategoryID { get; set; }

    [StringLength(75, ErrorMessage = "Category Name must be under 75 characters.")]
    [DataType(DataType.MultilineText)]
    [Display(Name = "Name")]
    public string CategoryName { get; set; }

    [StringLength(3800, ErrorMessage = "Category Description must be under 3800 characters.")]
    [DataType(DataType.MultilineText)]
    [Display(Name = "Description")]
    [AllowHtml]
    public string CategoryDesc { get; set; }

    [Display(Name = "Display on Web")]
    public bool DisplayOnWeb { get; set; }
} 
```

因此，如果我在 CategoryName 字段中输入超过 75 个字符的字符串，我可以看到该表单未通过 ModelState.IsValid 测试，并且视图被发回，并带有“类别名称必须小于 75 个字符”的注释。错误信息。但它不是触发 OnFailure 事件，而是触发 OnSuccess 事件。为什么？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T23:31:59.713

由于您已捕获异常，因此您返回的是 HTTP 状态代码为 200 的 PartialView。这就是触发 OnSuccess 的原因。

您可以做的是将响应代码显式设置为 400（错误请求）

```
[HttpPost]
public ActionResult UpdateCategory(CategoryVM category)
{
    try
    {
        if (ModelState.IsValid)
        {
            var itemService = new ItemViewModels();
            itemService.UpdateCategory(category);
        }
    }
    catch (DataException)
    {
        //Log the error (add a variable name after DataException)
        ModelState.AddModelError("", "Unable to save changes. Try again, and if the problem persists, see your system administrator.");
        Response.StatusCode = 400;
    }

    return PartialView("EditCategoryInfo", category);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T21:24:24.537

`OnSuccess`如果服务器返回成功的 HTTP 响应（例如 200 OK）并且客户端成功接收到响应并更新页面（如[MSDN](http://msdn.microsoft.com/en-us/library/system.web.mvc.ajax.ajaxoptions.onsuccess%28v=vs.108%29.aspx)中所述） ，则调用该方法

由您来处理响应的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T22:47:40.470

通过更多的研究（以及下面 Lukas 的帮助），我发现了[这个](https://stackoverflow.com/questions/7328977/asp-net-mvc-ajax-beginform-executes-onsuccess-even-though-model-is-not-valid)，它解决了我的问题。

# linq - 查找子集合不包含项目的所有项目

> ID：13731255
> 
> 赞同：5
> 
> 时间：2012-12-05T19:51:53.657
> 
> 标签：linq, ravendb

鉴于：

```
public class Order
{
    public string Name {get;set;}
    public List<LineItem> LineItems {get; set;}
}

public class LineItem
{
   public string Product {get; set;}
   public int Quantity {get; set;}
} 
```

我试图弄清楚如何构建一个查询，该查询将返回所有**没有**LineItem 的订单，其产品名为“Apple”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T21:58:24.683

我一直在考虑这个问题。它出现了几次。问题是 Raven 当前不处理 !.Any() 或 .All() 查询。

这个特殊的例子充分简化了问题，让我想到了一条不同的道路。我相信有一个解决方案。它需要针对静态索引的 lucene 查询：

```
public class Orders_ByProduct : AbstractIndexCreationTask<Order>
{
  public Orders_ByProduct()
  {
    Map = orders => from order in orders
                    select new
                    {
                        Product = order.LineItems.Select(x => x.Product)
                    };
  }
}

var ordersWithoutApple = session.Advanced
                                .LuceneQuery<Order, Orders_ByProduct>()
                                .Where("*:* AND -Product: Apple") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-05-02T22:40:17.337

`!.Any`我们能够通过显式比较来解决 RavenDB 缺乏对 的支持`false`，例如：

```
orders.Where(x => x.LineItems.Any(y => y.Product == "Apple") == false) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-06T06:52:11.917

您可以通过为查询创建索引来做到这一点

```
public class GetOrdersByProductIndex: AbstractIndexCreationTask<Order,GetOrdersByProductIndex.Result>
{
  public class Result
  {
     public string Product {get; set;}
  }

  public GetOrdersByProductIndex()
  {
    Map = orders => from order in orders
                    select new
                    {
                        Product = order.LineItems.Select(x => x.Product)
                    };
  }
} 
```

现在您可以使用此索引来获取您的订单。您的查询应如下所示

```
 using(IDocumentSession session = docStore.OpenSession())
{
   var orders  = session.Query<GetOrdersByProductIndex.Result,GetOrdersByProductIndex>
                        .Where(x=>x.Product != "Apple")
                        .As<Order>()
                        .ToList()
} 
```

请注意，默认情况下它只会返回 128 条记录（由于 ravendb 设置的限制），如果您的查询结果超过 128 条记录，您应该使用`Take(recordsNeeded)`函数来获取数据。

# jquery - 使用 Jquery 保持中心固定的缩放图像

> ID：13731259
> 
> 赞同：0
> 
> 时间：2012-12-05T19:52:05.340
> 
> 标签：jquery, jquery-ui

我有一个脚本，它将使用 jquery 滑块调整图像的大小。该图像位于溢出隐藏容器内。但是我在缩小或缩小图像的中心时遇到了问题。我知道这可以通过在缩小时加上减去左边和顶部的值来完成。但无法找到一种方法来做到这一点。你可以查看我的脚本-

```
var globalElement_width;
var globalElement_height;
$(document).ready(function(){
   $img=$('.canvas img');
   globalElement_width=$img.width();
   globalElement_height=$img.height();

   $( ".slider" ).slider({
       step: 1, 
       min: 0,
       max: 100,
       value: 0,
       slide: function( event, ui )
       {
        resize_img(ui.value);
       }
  });

  $('.canvas img').draggable();

});
function resize_img(val)
{
    var width=globalElement_width;
    var zoom_percen=width * 0.5; // Maximum zoom 50%
    var ASPECT = zoom_percen / 50;
    var zoom_value = val / 2;
    var size= width + ASPECT * zoom_value;

    $img = $('.canvas img');
    $img.stop(true).animate({
        width: size
    }, 250);
} 
```

Jsfiddle-

[http://jsfiddle.net/hirenbg89/Qv35B/5/](http://jsfiddle.net/hirenbg89/Qv35B/5/)

有什么帮助吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:00:15.193

您可以尝试将移位值更改一半`margin-top`：`margin-left`

```
var d = ASPECT*zoom_value/2;
$img.stop(true).animate({
    marginTop: -d,
    marginLeft: -d,
    width: size
}, 250); 
```

[http://jsfiddle.net/dfsq/Qv35B/6/](http://jsfiddle.net/dfsq/Qv35B/6/)

# python - 将 PHP HTML 文件解析到数据库中

> ID：13731261
> 
> 赞同：0
> 
> 时间：2012-12-05T19:52:13.830
> 
> 标签：python, beautifulsoup

我有需要包含可搜索 PHP 手册的应用程序。查看 Chmlib 和我手头的时间，看起来我无法通过制作 CHM 查看器来实现。所以我虽然我会发现我是否可以获得manul的XML版本......不存在。作为最后的手段，我决定使用 Python 和 beautifulsoup 将文件解析到数据库中，但后来我遇到了知道 PHP 手册在记录其功能时遵循的格式以及我认为整个想法是否实用的问题

在您看来，这甚至可能吗？有什么可以帮助我完成任务的指针吗？有没有其他方法可以将 PHP 文档打包到数据库中（如 SQLite3）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T12:57:02.637

我按照 Paladin 的建议使用了来自 SVN 的 PHP XML，并从那些 DocBook XML 中使用了在 docs 目录中找到的 PHP Manual builder 脚本来配置然后构建我需要的格式

检查[博士页面中的说明](https://wiki.php.net/doc/phd#phd_--_building_the_php_manual_with_php)

# mysql - 更新语句上的 MySQL 语法错误

> ID：13731263
> 
> 赞同：0
> 
> 时间：2012-12-05T19:52:16.977
> 
> 标签：mysql, sql, mysql-workbench

我有当前的代码，

```
UPDATE i
SET LeadInventor = 
    CASE 
        WHEN gs.FirstInventorName IS NULL THEN 'No' 
        ELSE 'Yes' 
    END
FROM patentdb.Inventor i
    LEFT JOIN patentdb.generalsource gs
    ON i.InventorFirst + ' ' + i.InventorLast = gs.FirstInventorName 
```

而且我不明白为什么会引发以下错误：

```
Error Code: 1064\. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM patentdb.Inventor i     LEFT JOIN patentdb.generalsource gs     ON i.Invent' at line 7 
```

FROM 语句是 MYSQL 的下划线

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T19:54:27.683

这是因为 FROM 子句在 MySQL UPDATE 语句中无效：

[http://dev.mysql.com/doc/refman/5.6/en/update.html](http://dev.mysql.com/doc/refman/5.6/en/update.html)

你可能会有更好的运气：

```
UPDATE Inventor i, generalsource gs
SET i.LeadInventor = CASE
  WHEN gs.FirstInventorName IS NULL THEN 'No'
  ELSE 'Yes'
END
WHERE i.InventorFirst + ' ' + i.InventorLast = gs.FirstInventorName 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:34:36.937

语法不正确。看看这个查询：

```
UPDATE patentdb.Inventor i
  LEFT JOIN patentdb.generalsource gs
  ON CONCAT(i.InventorFirst, ' ', i.InventorLast) = gs.FirstInventorName
SET LeadInventor = 
  CASE WHEN gs.FirstInventorName IS NULL THEN 'No' ELSE 'Yes' END 
```

另外，我想说的是，在 MySQL 中，最好使用 CONCAT 函数来创建新字符串。

# html - 无法删除表格内两个图像之间的 5px 间隙

> ID：13731269
> 
> 赞同：0
> 
> 时间：2012-12-05T19:52:28.787
> 
> 标签：html, css, html-email

我似乎无法将这两个图像放在一起。它们都在 HTML 表中有自己的行（我正在制作 html 电子邮件），但我似乎无法删除它们之间的 5px。

这是我的代码

```
<table width="200" height="200" cellpadding="0" cellspacing="0" border="0" style="border-    spacing: 0; border-collapse: collapse;border-collapse: seperate;">
<tbody>
<tr>
<td width="100" height="100"><img width="100" height="100" src="https://img.createsend1.com/img/templatebuilder/placeholder-image.png" /></td>
</tr>
<tr>
<td width="100" height="100"><img width="100" height="100" src="https://img.createsend1.com/img/templatebuilder/placeholder-image.png" /> </td>
</tr>
</tbody>
</table>​ 
```

如果有帮助，它也在[jsfiddle上](http://jsfiddle.net/JpdQ2/1/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T19:54:43.440

将图像设置为`vertical-align: top`。默认情况下，它们会`baseline`在图像下方为低于基线的文本中的字符留出空间。`baseline`除了应该工作（底部，中间等）之外，几乎任何值。

```
img{
  vertical-align: top;   
} 
```

[http://jsfiddle.net/JpdQ2/2/](http://jsfiddle.net/JpdQ2/2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T19:55:17.023

或者，将图像设置为`display: block`. 由于垂直对齐，内联图像总是存在间距问题。

[http://jsfiddle.net/JpdQ2/3/](http://jsfiddle.net/JpdQ2/3/)

# grails - 脚本库圣杯

> ID：13731271
> 
> 赞同：0
> 
> 时间：2012-12-05T19:52:36.480
> 
> 标签：grails, libraries

我有一个标准的 GSP，我正在尝试包含 scriptaculous ajax 搜索。

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="layout" content="main" />
<title>Search</title>
<g:javascript library="scriptaculous" />
</head>
<body>
    <h2>Entry Search</h2>
    <input type="text" id="autocomplete" name="autocomplete_parameter" />
    <span id="indicator1" style="display: none"> <img
        src="/images/spinner.gif" alt="Working..." />
    </span>
    <div id="autocomplete_choices" class="autocomplete"></div>
    <script type="text/javascript">
    new Ajax.Autocompleter("autocomplete", "autocomplete_choices", "mySearch", {paramName: "value" indicator: 'indicator1'});
  </script>
</body>
</html> 
```

我在尝试比较的数据库中有条目（我知道查找有效，因为我可以在地址栏中进行 ajax 搜索并返回）

因此，在页面上执行检查元素后，我注意到 scriptaculous 仍未包含在生成的页面中。scriptaculous JScript 脚本文件位于 web-app\js\prototype 目录下。我是否遗漏了导致 scriptaculous 不包含在内的任何内容，并且我的 Ajax.Autocompleter 抛出异常并且不包含在页面中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T22:44:14.463

由于 jQuery 是 Grails 2 的标准 javascript 库，因此包含原型的“认可”方式是删除 jQuery 并安装[原型插件](http://grails.org/plugin/prototype)。

`js/prototype`通过将所有文件（prototype.js、scriptaculous.js、effects.js 等）放入并在文件中添加一个模块，我能够让它在不这样做的情况下工作`conf/ApplicationResources.groovy`：

```
modules = {
  application {
    resource url:'js/application.js'
  }
  myCustomModuleName {
    resource url: [dir: "js/prototype", file: "prototype.js"], disposition: "head"
    resource url: [dir: "js/prototype", file: "scriptaculous.js"], disposition: "head"
  }
} 
```

然后将其包含在您的 gsp 中

`<r:require modules="myCustomModuleName" />`

一旦我这样做并重新启动应用程序，我就可以使用 scriptaculous 摇动效果：

```
<div id="shakeMe">
  <a href="#" onclick="new Effect.Shake('shakeMe'); return false;">Shake!</a>
</div> 
```

这使用 Grails 资源框架来包含 javascript 文件。

希望这对你有用！

# sql - On 条款中的条件

> ID：13731273
> 
> 赞同：2
> 
> 时间：2012-12-05T19:52:38.680
> 
> 标签：sql, sql-server, join

我正在使用 SQL Server 2008。

有什么区别：

在`Where`子句中有条件

```
select customer.Id,
       order.Id
  from Customer customer
      left outer join Order order on order.customerId = customer.Id
  where 
      order.deleted =0 
```

带有`ON`条款的条件

```
select customer.Id,
       order.Id
  from Customer customer
      left outer join Order order 
           on order.customerId = customer.Id 
           and order.deleted =0 
```

以及两者如何比较

```
select customer.Id,
       order.Id
  from Customer customer
      inner join Order order on order.customerId = customer.Id
  where 
      order.deleted =0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:02:33.683

让我们给你两张桌子

**顾客**

```
ID  
1   
2   
3 
```

**命令**

```
ID  Customer
------------    
1   1
2   2
3   2 
```

客户 3 没有任何订单。

`CUSTOMER`并且当对表中`ORDER`的列进行左连接时`ORDER`，客户 3 将为空。因此，如果条件在 where 语句上，则不会返回没有订单的客户。如果条件为“开”，则不包括这些订单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T19:55:57.510

Put them all in a query window in SSMS and type `ctrl+l` (or turn the option on that shows the actual execution plan after the query runs) and see the plans SQL generates. It will tell you how it's different. SQL will make decisions about queries to make it optimally perform, which can vary depending on your system (i.e. indexes, etc).

Doing a LEFT JOIN may end up with a different execution plan unless SQL can say "hey, you're saying LEFT JOIN but your WHERE clause basically makes it function like an INNER JOIN" and fixes/optimizes things for you.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T20:01:06.807

我觉得你应该了解一下`sql joins`。这是一个[很好](http://blog.sqlauthority.com/2009/04/13/sql-server-introduction-to-joins-basic-of-joins/)的开始链接。

基本上，

*   **案例 1**：您正在过滤`order.deleted =0`可能`null`是`right table of a left join`. 如果右表没有映射行，则该表中的列将为空。它应该是`ISNULL(order.deleted,0)=0`或`order.delete IS NULL or order.delete=0`

*   **案例2**：`ON`是两个表正在加入的条件，并且`order.deleted =0`在加入之前检查了条件（我认为）

*   **案例 3**：简单`JOIN or INNER JOIN`的从两侧映射精确行的地方

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T20:09:11.750

让我具体回答你的问题。

如果不是在执行计划中，第一个和第三个查询的结果是相同的。该`where`子句正在查看 a 的第二个表中的字段`left outer join`。第一个表中的任何行但不是第二个表中的任何行都将具有 NULL 值并被过滤掉。

第二个查询将保留第一个表中的所有行及其所有订单（如果有）。

# c++ - 删除向量

> ID：13731283
> 
> 赞同：-1
> 
> 时间：2012-12-05T19:53:19.277
> 
> 标签：c++, memory-management, vector

如果 a`vector`包含一堆使用分配`new`然后取消引用的元素，那么`vector`删除时是否释放了这些元素的内存？例如：

```
vector<Obj> a = *(new vector<Obj>());
a.push_back(*(new Obj()));
delete &a; 
```

新`Obj`创建的是否已解除分配？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-05T19:57:34.747

这一切都将大错特错。首先，第一行的赋值，“a”现在在堆栈上（而不是堆上），你的`new`语句分配的内存现在丢失、泄露、消失了。

其次，同样的情况再次发生。Obj() 将被构造和复制。你第二次的记忆`new`永远消失在空间和时间的深处。

然后您尝试删除分配在堆栈上的对象。这是您的程序崩溃和烧毁的地方，所有这些内存丢失都是无关紧要的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-05T20:22:12.000

```
vector<Obj> a;
Obj o;
a.push_back(o); 
```

注意：没有`new`或`delete`在视线范围内。C++ 不是 Java。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-05T20:03:06.670

不; 一般来说，您似乎在所有权方面遇到了一些麻烦。在此声明中：

```
vector<Obj> a = *(new vector<Obj>()); 
```

您正在分配一个新的`vector`，复制它，然后扔掉原来的。由于您不再有指向它的指针，因此您无法删除它。这称为内存泄漏。此外，这：

```
delete &a; 
```

是未定义的行为，因为您不是删除通过分配的对象`new`，而是本地分配的。你的意思可能是这样的：

```
vector<Obj*> a;
// ... 
```

也就是说，分配一个`vector<Obj>`名为的本地`a`，当它超出范围时，它的存储会自动回收。

现在对于您的实际问题，不，`vector`唯一拥有指针，而不是它们指向的内存。考虑否则会发生什么：

```
vector<Obj*> a;
Obj x;
a.push_back(&x); 
```

如果`vector`调用`delete`了它的所有指针元素，那么当`a`被销毁（再次，自动）时，`x`也将被删除。由于它不是通过分配的`new`，这是未定义的行为。幸运的是，事实并非如此！

如果您想要一个指针向量，该向量在销毁时会自动销毁其所指对象`vector`，请使用以下向量`unique_ptr`：

```
vector<unique_ptr<Obj>> a;
a.push_back(unique_ptr(new Obj())); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T20:05:13.977

该`vector<Obj> a`部分在堆栈上分配一个空向量。

`= *(new vector<Obj>());`在堆上分配另一个空向量并将其分配（复制）到堆栈向量。堆上分配的内存没有引用，被泄露了。

`a.push_back(*(new Obj()));`在堆上分配一个`Obj`并将其复制到堆栈向量中。堆上分配的内存泄漏。

`delete &a;`尝试删除分配在堆栈上的向量，这是一个错误。

也许这就是你想要做的：

```
vector<Obj*>* a = new vector<Obj*>();
a.push_back(new Obj());
delete a; 
```

不，推回向量中的对象不会被释放，它们会被泄露。在向量指针上调用 delete 时，`a`它​​将默认解构向量，这不涉及释放动态分配的内存。

提示：不要使用裸指针，最好使用**unique_ptr**或**shared_ptr**。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-05T19:58:23.027

不。该`*(new Obj())`语句将堆分配对象的副本推送（到向量中）。**复制**的对象（在向量中）稍后被销毁（当向量被销毁时），但**原始堆分配的 Obj 对象**永远不会被删除（并且堆分配的内存永远不会被释放）。

# c# - 选择 Word 互操作标题范围会导致 Word 切换到草稿视图

> ID：13731290
> 
> 赞同：3
> 
> 时间：2012-12-05T19:53:42.690
> 
> 标签：c#, view, range, office-interop

使用 选择页眉范围时`.Select()`，Microsoft Word 会自动从我当前的视图类型（打印布局）切换到草稿视图。如何阻止 Word 切换到草稿视图？

下面的代码示例演示了我在做什么：

```
 // this.Document is a Microsoft.Office.Interop.Word.Document
 Section section = this.Document.Sections.First;
 foreach (HeaderFooter header in section.Headers)
 {
   if (header.Exists) 
   {
     header.Range.Select(); // When I call this, Word switches to Draft View.
     break;
   }
 } 
```

**编辑（3）：**

显然保存视图类型并重置它确实有效。但是，当 Word 切换到草稿视图然后返回到打印布局时，这会导致令人讨厌的闪烁。此外，当我双击主文档空间以退出页眉部分时，Word 切换回草稿视图。

```
 WdViewType viewType = this.Document.ActiveWindow.View.Type;
 range.Select();
 this.Document.ActiveWindow.View.Type = viewType; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T13:44:42.787

`View.SeekView`在选择范围之前，必须为除 wdNormalView（草稿视图）之外的所有视图类型设置该属性。

```
var window = this.Document.ActiveWindow;
// wdNormalView == Draft View, where SeekView can't be used and isn't needed.
if (window.View.Type != WdViewType.wdNormalView)
{
  // -1 Not Header/Footer, 0 Even page header, 1 Odd page header, 4 First page header
  // 2 Even page footer, 3 Odd page footer, 5 First page footer
  int rangeType = range.Information[WdInformation.wdHeaderFooterType];
  if (rangeType == 0 || rangeType == 1 || rangeType == 4)
    window.View.SeekView = WdSeekView.wdSeekCurrentPageHeader;
  if (rangeType == 2 || rangeType == 3 || rangeType == 5)
    window.View.SeekView = WdSeekView.wdSeekCurrentPageFooter;
}
header.Range.Select(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-07-31T17:51:06.770

7 年后，但在我的 中使用 Joe W 的答案时`Word VSTO Addin`，我遇到了一个问题并决定在此处发布修复：

Before`View.SeekView`设置为`WdSeekView.wdSeekCurrentPageHeader`or `WdSeekView.wdSeekCurrentPageFooter`，检查是否`View.SeekView`已设置为页眉或页脚值。如果是，则抛出异常，因为当前`View.SeekView`无法更改为`wdSeekCurrentPageHeader`if`View.SeekView`已设置为页眉值，并且当前`View.SeekView`无法更改为`wdSeekCurrentPageFooter`if`View.SeekView`已设置为页脚值。如果在执行代码以调整视图设置（例如，在 Word VSTO 插件中）时用户正在编辑页眉或页脚，则可能会出现这种情况。

此代码有效。它包括`View.SeekView`在调用之前保存设置的代码，`SetView`并在调用`SetView`. 这考虑到用户在`SetView`被调用时正在编辑页眉或页脚的场景，这可能是`Word VSTO Addin`.

```
// ... some Word VSTO Addin code that calls SetView 

Word.WdSeekView enumSavedSeekView = Globals.ThisAddIn.Application.ActiveDocument.ActiveWindow.View.SeekView;

bool viewResetNeeded = SetView(workingStoryRange);

if (viewResetNeeded)
{
    Globals.ThisAddIn.Application.ActiveDocument.ActiveWindow.View.SeekView = enumSavedSeekView;
}

// ... end of some Word VSTO Addin code that calls SetView 

private bool SetView(Word.Range range)
{
    bool viewResetNeeded = false;

    // wdNormalView == Draft View, where SeekView can't be used and isn't needed.
    if (Globals.ThisAddIn.Application.ActiveDocument.ActiveWindow.View.Type != Word.WdViewType.wdNormalView)
    {
        // -1 Not Header/Footer, 0 Even page header, 1 Odd page header, 4 First page header
        // 2 Even page footer, 3 Odd page footer, 5 First page footer

        switch (range.Information[Word.WdInformation.wdHeaderFooterType])
        {
            case 0:
            case 1:
            case 4:

                if ((Globals.ThisAddIn.Application.ActiveDocument.ActiveWindow.View.SeekView != Word.WdSeekView.wdSeekEvenPagesHeader) && (Globals.ThisAddIn.Application.ActiveDocument.ActiveWindow.View.SeekView != Word.WdSeekView.wdSeekFirstPageHeader) && (Globals.ThisAddIn.Application.ActiveDocument.ActiveWindow.View.SeekView != Word.WdSeekView.wdSeekPrimaryHeader))
                {
                    Globals.ThisAddIn.Application.ActiveDocument.ActiveWindow.View.SeekView = Word.WdSeekView.wdSeekCurrentPageHeader;
                    viewResetNeeded = true;
                }

                break;

            case 2:
            case 3:
            case 5:

                if ((Globals.ThisAddIn.Application.ActiveDocument.ActiveWindow.View.SeekView != Word.WdSeekView.wdSeekEvenPagesFooter) && (Globals.ThisAddIn.Application.ActiveDocument.ActiveWindow.View.SeekView != Word.WdSeekView.wdSeekFirstPageFooter) && (Globals.ThisAddIn.Application.ActiveDocument.ActiveWindow.View.SeekView != Word.WdSeekView.wdSeekPrimaryFooter))
                {
                    Globals.ThisAddIn.Application.ActiveDocument.ActiveWindow.View.SeekView = Word.WdSeekView.wdSeekCurrentPageFooter;
                    viewResetNeeded = true;
                }

                break;

            default:
                break;
        }
    }

    return viewResetNeeded; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-06T17:48:47.743

您可以利用范围对象中的 Words 集合来选择标题

```
 Section section = this.Document.Sections.First;
 foreach (HeaderFooter header in section.Headers)
 {
   if (header.Exists) 
   {
     header.Range.Words.First.Select()
     break;
   }
 } 
```

# javascript - 在 Javascript 中比较两个 64 位整数

> ID：13731292
> 
> 赞同：0
> 
> 时间：2012-12-05T19:53:58.927
> 
> 标签：javascript, comparison, 32bit-64bit

Twitter API 返回 64 位整数的 ID，例如 276403573577891842。我想通过比较它们的 ID 来查看一条推文是否比另一条推文更新。

有没有一种聪明的方法来比较两个 64 位整数，看看在仅支持 32 位整数的 JavaScript 中哪个更大？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:27:09.453

假设 API 返回字符串，然后将其解析为整数，有两种方法可以做到这一点 - 拆分方式和填充方式；

**分裂**。这里的想法是将数据拆分为环境可以处理的大小。最大的 32 位数字是`0xFFFFFFFF`或`4294967295`。现在`4294967295..toString().length === 10`。所以所有 str 长度 <= 9 的 dec 都应该是 32 位安全的。

```
function compare(a,b){
    var aa = [0,0,0], ba = [0,0,0], i = 3;
    while (a.length) aa[--i] = parseInt(a.slice(-9)), a = a.slice(0,-9);
    i = 3;
    while (b.length) ba[--i] = parseInt(b.slice(-9)), b = b.slice(0,-9);
    if (aa[0] === ba[0]){
        if (aa[1] === ba[1]) {
            if (aa[2] === ba[2]) return 0;
            else if (aa[2] > ba[2]) return 1;
            return -1;
        } else if (aa[1] > ba[1]) return 1;
        return -1;
    } else if (aa[0] > ba[0]) return 1;
    return -1;
}
// a > b: 1, a = b: 0, a < b: -1 
```

**垫**。这次的想法是进行字符串比较，但要做到这一点，我们必须首先确保（字符串）数字具有相同的长度；即用0填充它们。这次`'18446744073709551615'.length === 20`这么

```
function pad(str, len) { // Your fav. padding fn
    var pre = '0';
    len = len - str.length;
    while (len > 0) {
        if (len & 1) str = pre + str;
        len >>= 1;
        pre += pre;
    }
    return str;
};

a = pad('276403573577891842',20);
b = pad('50',20); 
```

现在您可以`a === b, a < b, a > b`正常使用了（除非您使用的是字符串而不是 int）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T19:58:57.537

如果它们确实是数字最高的数字 id 是最新的推文，而最低的 id 是最旧的推文，那么进行文本`<`或比较应该没有任何问题`>`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T23:36:22.840

这是我根据接受的答案使用的：

就这样称呼它：`if( compare_64('124567891234567890', '>', '124567891234567891') )`

```
function compare_64(a, type, b)
{
var result = false;

var pad_len = (a.length > b.length) ? a.length : b.length;      
var aa = pad(a, pad_len);       
var bb = pad(b, pad_len);

switch(type)
{
    case '<':   
        result = (aa < bb) ? true : false;
        break;
    case '<=':  
        result = (aa <= bb) ? true : false;
        break;
    case '>':   
        result = (aa > bb) ? true : false;
        break;
    case '>=':  
        result = (aa >= bb) ? true : false;
        break;                      
    case '==':  
        result = (aa == bb) ? true : false;
        break;          
}   
return result;
}

// Pad with zeros
function pad(str, len)
{
  var pre = '0';
  len = len - str.length;
  while (len > 0)
{
    if (len & 1) str = pre + str;
    len >>= 1;
    pre += pre;
  }
  return str;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T20:00:53.040

如果一切都失败了，您始终可以将 ID 存储为字符串并将其分成两半，然后您可以将它们分别作为整数进行比较。

# php - Jquery 函数只执行第一项

> ID：13731301
> 
> 赞同：1
> 
> 时间：2012-12-05T19:54:38.677
> 
> 标签：php, jquery, mysql, ajax

我想知道是否有人可以帮助我。我对 jQuery 很陌生，但喜欢学习它。我似乎有一个小问题，我想知道是否有人可以帮助我。我正在使用以下 jQuery 将用户 ID 和属性 ID 添加到 MySQL（如“添加到收藏夹”）该函数在第一个属性上执行良好，但在其下方的另一个上却没有。

查询

```
$(document).ready(function(){
$("#clickme").delegate("#insert", "click", function(){

var ruid=$("#ruid").val();
var propid=$("#propid").val();

$.post('inc.saveprop.php', {ruid: ruid, propid: propid},
function(data){
$("#message").html(data);
$("#message").hide();
$("#message").fadeIn(1500); //Fade in the data given by the insert.php file
});
return false;
});
});
</script> 
```

html：以下是循环的

```
<? while { 
<input id=\"ruid\" type=\"hidden\" value=\"".$uid."\" />
<input id=\"propid\"  type=\"hidden\" value=\"".$props['propid']."\" />
<a class=\"insert\" title=\"Insert Data\" href=\"#\">Save to Favourites</a>
 <!-- For displaying a message -->

<div id=\"message\"></div>";
} etc  ?> 
```

该脚本将适用于循环中的第一项，但随后不适用于其他项目。我知道其中一个问题是我有多个具有相同 ID 的隐藏类型（在循环中），大禁忌但不知道谁更改代码以访问 id=name+ID 或使用 Class= 或 Name = 相反。

如果有人能帮助我，我会非常感激（谷歌搜索了几个小时尝试不同的东西并把它弄坏了 4 次哈）

感谢您花时间阅读

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T19:59:39.797

您在选择器中使用了 ID：

```
$("#clickme") 
```

ID 是唯一的，jQuery 只会获取该特定 ID 的第一个实例，而不是全部。

你只需要稍微改变你的循环来使用类：

```
<input class=\"ruid\" type=\"hidden\" value=\"".$uid."\" /> 
```

然后在选择器中使用类：

```
$(".clickme") 
```

继续前进`on()`而不是`delegate()`

```
$("#insert").on("click", ".clickme", function(){ ... } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T20:46:11.050

一个问题是您需要存储这两个 ID，以便它们可以通过 AJAX 调用传递到您的服务器。一种方法是使用 jquery 的[data()](http://api.jquery.com/data/)命令，它允许您读取/写入绑定到特定 HTML 元素的键值数据。在这种情况下，您可以将两个 ID 直接存储在`<a>...</a>`元素中。

```
<a class="insert" title="Insert Data" data-ruid="ruid1" data-propid="propid1" href="#">Save to Favourites</a> 
```

您需要解决的另一个问题是如何拥有任意数量的这些“保存到收藏夹”链接，而无需对它们进行唯一命名。这是通过使用类和 jquery 类选择器来完成的。

**示例 HTML：**

```
<div class='clickme'>
    <a class="insert" title="Insert Data" data-ruid="ruid1" data-propid="propid1" href="#">Save to Favourites</a>
    <div class="message"></div>
</div>

<div class='clickme'>
    <a class="insert" title="Insert Data" data-ruid="ruid2" data-propid="propid2" href="#">Save to Favourites</a>
    <div class="message"></div>
</div>

<div class='clickme'>
    <a class="insert" title="Insert Data" data-ruid="ruid3" data-propid="propid3" href="#">Save to Favourites</a>
    <div class="message"></div>
</div> 
```

**示例 javascript：**

```
$(document).ready(function(){
    $(".clickme").delegate(".insert", "click", function(){
        // the 'this' variable refers to whatever was clicked, in this case 
        // it is the <a> ... </a> element with the class 'insert'

        // use the jquery data() command to retrieve the saved IDs         
        var ruid=$(this).data('ruid');
        var propid=$(this).data('propid');

        var data = "ruid: " + ruid + " propid: " +  propid;

        // find the sibling of the <a> ... </a> element that has the class 'message'
        // and update it with the retrieved information
        var message = $(this).siblings(".message");

        message.html(data);
        message.hide();
        message.fadeIn(1500);

        //$.post('inc.saveprop.php', {ruid: ruid, propid: propid}, function(data){
        //    $("#message").html(data);
        //    $("#message").hide();
        //    $("#message").fadeIn(1500); //Fade in the data given by the insert.php file
        //});

        return false;
    });
}); 
```

这个例子的jsfiddle：http: [//jsfiddle.net/wQjhN/7/](http://jsfiddle.net/wQjhN/7/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T20:10:02.180

最重要的是，修复 HTML 生成，并为重复的相似元素使用类，为唯一元素使用 ID。

点击处理程序不会附加到具有相同 ID 的多个项目，因为它只希望找到一个。

您可以使用@adeneo 的修复程序来解决这个问题，但是您的 ruid 和 propid 会遇到类似的问题，并且无法正确读取这些值 - 您将再次获得 ruid 的第一个实例和propid 在页面上，因为您使用的是 ID 而不是类。

虽然你可以想出一些 hacky 选择器 - 可能在输入元素或其他东西上循环，例如`$(this).find('input')`然后循环，假设第一个是 ruid，第二个是 propid。这是一个黑客，充其量是脆弱的 - 如果 HTML 顺序发生变化，一切都会中断。

修复 HTML，然后您就可以使用正确的选择器（可能`$(this).find('.ruid')`或类似的东西）

# javascript - 表行 jquery 抛出错误信息 too much recursion

> ID：13731306
> 
> 赞同：1
> 
> 时间：2012-12-05T19:54:56.230
> 
> 标签：javascript, jquery

我收到错误消息太多递归。为什么？

以下[代码](http://jsfiddle.net/AzZw4/43/)应该在单击图像时展开/折叠表格行。如果图像不存在，则单击最后一行将展开/折叠时会有一个 div

```
$(document).ready(function() {
    $(".ui-dialog-titlebar").hide(); 
    //$(".lvlcollapse .level4").hide();
    $("tr.lvlcollapse").click(function() {
        //alert($(this).find("img").attr("src"));
        if ($(this).find("img").attr("src") != undefined) {
            var tnow = $.now();
            var allClass = $(this).attr('class');
            var level = getLevel($(this));
            var state = getClass($(this), '^clicked\\d+$');
            if (state == undefined) {
                state = "closing";
                $(this).addClass("clicked" + tnow);
            }
            else {
                $(this).removeClass(state);
                tnow = state.substr(6);
            }
            switchImage($(this));
            $(this).nextAll(".lvlcollapse").each(function() {
                var sublvl = getLevel($(this));
                var subtnow = 0;
                var substate = getClass($(this), '^closed\\d+$');
                if (substate != undefined) subtnow = substate.substr(5);
                if (sublvl > level) {
                    if (state == "closing" && subtnow == 0) {
                        $(this).addClass("closed" + tnow);
                        $(this).toggle();
                    }
                    else if (subtnow == tnow) {
                        $(this).removeClass(substate);
                        $(this).toggle();
                    }
                }
                else {
                    return false;
                }
            });

        } else {
            //alert('No Image ');
            $(".button").click(function(event) {
                //var $this2 = $(this);
                var allLevel4 = $(this).next(".lvlcollapse.level4");
                $($(this)).toggle('fast', function() {
                    if (allLevel4.is(":visible")) {
                        $(this).html("Show Attempts");
                        alert('hello2');
                        return false;
                    } else {
                        $(this).html("Hide Attempts");
                        alert('hello3');
                        return false;
                    }

                }) event.preventDefault();
            }).trigger("click");
        }
    });
    $(".lvlcollapse.level2").filter(function() {
        return $(this).next(".lvlcollapse.level3").is(":visible");
    }).trigger("click");
    //$(".button").filter(function() { return $(this).next(".lvlcollapse.level4").is(":visible"); }).hide();
});​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:03:28.517

你被注释掉的那些警报会发生什么？如果您取消注释它们，您是否看到它们一遍又一遍地重复？else 中的 $('.button').click() 看起来很糟糕。您只需要注册一次，但您在点击侦听器中有它，因此每次用户单击链接时都会注册它。将其拉出并在文件准备好或建表时注册。不是响应用户点击某些东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:03:42.910

一件看起来很有趣的事情是，您正在为单击处理程序中的按钮添加一个单击处理程序`tr.lvlcollapse`。每次单击它都会创建一个新的处理程序，并且在您调用时会触发所有以前的处理程序`trigger.click()`

由于点击事件冒泡，它也会触发所有父母的点击处理程序。如果按钮在里面`tr.lvlcollapse`，那可能是你的问题。

你需要做两件事：

*   不要从处理程序中设置处理程序，除非您真的知道自己在做什么并且您有计划解除处理程序的绑定，或者至少在绑定之前删除现有的绑定。请注意，这不太常见，您通常不会从处理程序中添加处理程序。

*   `event.stopPropagation()`如果您不希望祖先节点处理单击，请调用

# android - getExternalCacheDir() 如何在 Android 上工作？

> ID：13731307
> 
> 赞同：11
> 
> 时间：2012-12-05T19:55:00.760
> 
> 标签：android, file, caching

据我了解，我们将经常访问的对象缓存在比普通磁盘读取更容易访问的内存段中。

`getExternalCacheDir()`，而不是`getCacheDir()`指向外部文件系统——在我看来这很正常`getExternalFilesDir()`。

Android 如何优化对 ExternalCacheDir 的访问？是不是类似于 Linux 上的“交换”空间？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-05T20:03:44.033

`getExternalCacheDir()`并且`getExternalFilesDir()`是两个不同的目录。

不同的是，第一个仅用于临时文件或缓存文件，可以被系统或用户删除（通过设置相应按钮）以重新获得空间。

第二个用于永久文件。无论如何，您必须考虑文档中有关[`getExternalCacheDir()`](http://developer.android.com/reference/android/content/Context.html#getExternalCacheDir%28%29).

# android - 备份用于在 Eclipse 中签署 Android 应用程序的签名密钥

> ID：13731308
> 
> 赞同：4
> 
> 时间：2012-12-05T19:55:03.517
> 
> 标签：android, backup, code-signing

因此，我的第一个 Android 应用程序开发良好并继续前进。我有一个签名密钥，用于在 Eclipse 中对其进行签名以进行市场分发。

现在我正在考虑重建我的计算机，但我担心密钥。备份此密钥并恢复它的正确方法是什么？

我可以只复制其中包含**签名密钥**`Keystore`文件的目录，然后在下次编译我的 APK 时重建后将 Eclipse 指向新目录吗？

 **还是比这更复杂？

此处的屏幕指示将是要备份的正确文件，对吗？我只是想确定一下，因为我还在`S:\Documents`目录中看到了一个名为**.keystore**的文件。

![在此处输入图像描述](../Images/36310364f66eebd6b4cad5c5784edb43.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T19:58:47.500

您用来签署您的 apk 的密钥只是一个文件，您可以像对待任何其他文件一样对待它。

你可以复制它、重命名它、移动它等等，没有任何问题，只要你下次签名时指向新的位置。

例如，我的密钥文件称为 key.keystore。我在我的主目录中创建了它，但是在从桌面更新到 macbook pro 之后，我只是将它复制到我的新系统上。无需复制整个目录。只需要密钥文件，在您的情况下是`signingkey`文件。

下次要构建发布版本时，只需指向 的新位置`signingkey`，然后输入您之前使用的密码和别名。**

# java - 准备好的语句中的可选顺序

> ID：13731316
> 
> 赞同：0
> 
> 时间：2012-12-05T19:55:20.160
> 
> 标签：java, mysql, prepared-statement

我正在重构我的应用程序。我实际上正在做的一件事是：

```
String sql = "select column1 from table2";
boolean isOrderbyAdded = false;
for(int i=1; i<N; i++) { // N is a known integer (e.g. 5)
    if(column[i]!=null) {
        if(!isOrderbyAdded) {
            sql += " order by "
            isOrderbyAdded = true;
        } else {
            sql += ", "
        }
        sql += column[i];
    }
} 
```

我想将其更改为准备好的声明。有没有办法编写一个语句来检查是否在最终对结果进行排序之前指定了每个列名？

我的查询每天执行数百万次。我认为准备好的语句可以为我节省一些编译时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:10:32.003

这不能使用基本的 SQL 库来完成。你被卡住了，但你有几个选择。

1.  使用`String.format`可能对您来说更快。
2.  使用`StringBuilder`with**肯定**`.append`会更快。 ***   永远不要将 += 用于`String`s，除非它不经常使用（那么没关系）。`StringBuilder`总是更快，尤其是如果您可以预测[`capacity`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuilder.html#StringBuilder%28int%29)井。但是这里默认的多 16 个字符可能就足够了（不过，如果不是，请使用更大的字符）。** 
***   最快的可能是开始使用 Spring。即使用这个[排序](http://static.springsource.org/spring-data/data-commons/docs/current/api/org/springframework/data/domain/Sort.html)类。**

 **这是您使用的代码版本`StringBuilder`，尽管 Spring 方式可能是最好的，但您需要做更多的工作。[在这里查看春天。](http://www.springsource.org)

```
StringBuilder sqlsb = new StringBuilder("select column1 from table2");
boolean isOrderbyAdded = false;
for(int i=1; i<N; i++) { // N is a known integer (e.g. 5)
  if(column[i]!=null) {
    if(!isOrderbyAdded) {
      sqlsb.append(" order by ");
          isOrderbyAdded = true;
    } else {
      sqlsb.append(", ");
    }
    sqlsb.append(column[i]);
  }
}
String sql = sqlsb.toString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:31:38.560

在您的代码中，SELECT 列是 ORDER BY 列的候选者。

所以：**你在 java 中有一个半 DB 模型**，如果你不想要一个更完整的模型，你可以有一个用 XML 写出的 SQL 语句池，就像在[mybatis](http://code.google.com/p/mybatis/wiki/Welcome)中一样。收集 SQL，并按表对它们进行分组可能会有所帮助。

寻找一个完整的模型：在 JPA 中（例如使用 eclipseLink），你有一个标准 api 用于类型安全的查询构建。

然而，遗留代码的重构应该*在任何改进之前*使旧的东西变得干净和可维护。从表示中拆分数据查询，删除丑陋的嵌套查询循环，在同一张表上收集查询。诸如此类。

是的，如果仅用于 SQL 注入和引号转义，使用准备好的语句会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T21:18:19.583

> 我的查询每天执行数百万次。我认为准备好的语句可以为我节省一些编译时间。

“编译”是什么意思？如果您的意思是构建 SQL 字符串，那么与数据库对话的成本将始终支配字符串构建（我在不到三秒的时间内运行了您的原始代码一百万次）。担心使那部分代码变得可读。

一个更重要的问题是查询计划是否会被正确缓存——它可能是，尽管对于排序顺序的每个组合都有一个单独的缓存条目。这并不奇怪，因为排序顺序很可能会改变执行计划。**

# maven - 安装时编译失败

> ID：13731317
> 
> 赞同：0
> 
> 时间：2012-12-05T19:55:27.920
> 
> 标签：maven, tycho

在安装过程中，我收到以下错误：

```
[错误] 无法在项目 com.iwaysoftware.eclipse.common 上执行目标 org.eclipse.tycho:tycho-compiler-plugin:0.16.0:compile (default-compile)：编译失败：编译失败：
[错误] /home/akravets/dev/workspaces/trunk/com.iwaysoftware.eclipse.common/src/com/iwaysoftware/eclipse/common/model/BaseTreeNode.java:[317,0]
[错误] public int getChildIndex(ITreeNode child) {
[错误] ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[错误] BaseTreeNode 类型的方法 getChildIndex(ITreeNode) 必须覆盖超类方法
[错误] /home/akravets/dev/workspaces/trunk/com.iwaysoftware.eclipse.common/src/com/iwaysoftware/eclipse/common/util/NamespaceUpdater.java:[13,0]
[错误] 公共布尔访问（IResourceDelta 增量）抛出 CoreException {
[错误] ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ ^
[错误] NamespaceUpdater 类型的方法 visit(IResourceDelta) 必须覆盖超类方法

```

我不明白的是，在 Eclipse 工作区中我看不到这些错误。我第一次运行安装所有编译好的插件。这是我的父母 POM [http://pastebin.com/U8J180J0](http://pastebin.com/U8J180J0)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:44:58.853

看起来有些项目设置为 1.5，我正在针对 1.6 进行编译：[@Override 编译错误，实现接口（eclipse jdk1.6.0_23 linux）](https://stackoverflow.com/questions/4995780/override-compile-error-implementing-an-interface-eclipse-jdk1-6-0-23-linux)

还需要添加到父POM

```
<plugin>
  <groupId>org.eclipse.tycho</groupId>
  <artifactId>tycho-compiler-plugin</artifactId>
  <version>0.16.0</version>
  <configuration>
    <source>1.6</source>
    <target>1.6</target>
  </configuration>
</plugin> 
```

# java - XML 解析和反序列化

> ID：13731322
> 
> 赞同：4
> 
> 时间：2012-12-05T19:55:45.950
> 
> 标签：java, xml, xml-parsing, xml-deserialization

我有一个 xml 文件，我从我的班级中读取它

```
<Testclasses>
<Class>new SomeClass1()</class>
<class>new SomeClass2()</class>
</Testclasses> 
```

所以我在类中有一个方法，它将参数作为对象，如下所示

```
public List<Object> retriveValuesFromXml(){
    ....
    This method parses the values from xml and reads the different object and returns a
    list of objects.
}

@Test
public void someMethod1(){

   ArrayList<Object> list_of_objects= retriveValuesFromXml();

   for(Object x :list_of_objects){
      someMethod2(x); //for example : x = new SomeClass1() or x = new SomeClass2()
   }
}

public void someMethod2(Object target){
   .....
} 
```

其中 target 是创建的新 SomeClass() 对象，我们从 xml 中读取该对象。我可以知道如何将文件中的 xml 值解析为对象并将其存储在列表中吗？我只想使用我项目中所有类对象的列表并将它们发送到这个测试类。以后即使任何新类被添加到项目中，我也应该能够添加到这个 xml 文件并将类对象传递给这个测试。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T19:59:11.263

您可能想要使用简单的 Java 库，例如[**XStream**](https://x-stream.github.io/)，它使用起来非常简单。您只需要定义一个 POJO 类来保存来自 XML 的解析值，然后使用该库来解析 XML 并为您生成转换后的 java 对象。

```
 XStream xstream = new XStream();

     //converting object to XML
     String xml = xstream.toXML(myObject);

     //converting xml to object
     MyClass myObject = (MyClass)xstream.fromXML(xml); 
```

请看一下它的[**两分钟教程**](https://x-stream.github.io/tutorial.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-05T20:08:55.240

它就像我想象的那样

```
DocumentBuilder db = dbf.newDocumentBuilder();
org.w3c.dom.Document doc = db.parse("name_of_file.xml");

Element rootElement = doc.getDocumentElement();
NodeList nl=rootElement.getElementsByTagName("TestClass"); 
```

# c++ - 如何从课程队列中“推送”和“弹出”？

> ID：13731323
> 
> 赞同：0
> 
> 时间：2012-12-05T19:55:48.287
> 
> 标签：c++, class, queue, simulation

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:01:03.347

```
queue<job> CPUqueue[10], waitQueue[10]; 
```

这将创建两个包含 10 个队列的数组。这可能不是你想要的。

尝试 ：

```
queue<job> CPUqueue, waitQueue; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T19:58:29.767

您有一个队列数组，而不是一个队列，并且 push 不适用于数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T20:04:02.620

除了@otibom 的回答：

```
non-class type ‘std::queue<job> [10]’ 
```

只是意味着：`waitQueue`被声明为一个数组。数组中的对象是`queue`s，但可验证的不是。

# ruby-on-rails - Generate requests to my webapp from different countries

> ID：13731325
> 
> 赞同：1
> 
> 时间：2012-12-05T19:55:50.190
> 
> 标签：ruby-on-rails, internationalization, geolocation

I am testing the I18n and L10n of my webapp and I'am doing some handling with [http://www.rubygeocoder.com/](http://www.rubygeocoder.com/) to retrieve the country that has originated the request and then set a proper locale. I'am using Rails 3.2 in Linux.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:13:17.240

这有点小技巧，但是有许多服务器监控服务的节点遍布全球。Pingability.com 提供免费试用，Alertra.com 也提供免费试用，两者都提供了相当复杂的工具，用于在需要时执行非平凡请求（例如 POST）。我确信还有许多其他类似的服务，但这些都是我使用过的。

# coffeescript - for...in if not null or undefined

> ID：13731341
> 
> 赞同：2
> 
> 时间：2012-12-05T19:57:32.947
> 
> 标签：coffeescript

In my Javascript code, I process many json objects with properties that may be null:

```
if (store.departments != null) {
    for(var i = 0; i < store.departments.length; i++) {
        alert(department.name);
    }
} 
```

In porting my app to coffeescript, I came up with the following shortcut using the existential operator:

```
for department in store.departments ? []
    alert department.name 
```

Is this acceptable coffeescript? Is there any scenario in which this would not work as intended?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:03:13.433

那这个呢？

```
if store.departments  
  alert department.name for department in store.departments 
```

或者

```
alert department.name for department in store.departments if store.departments 
```

两个语句都编译为：

```
var department, _i, _len, _ref;

if (store.departments) {
  _ref = store.departments;
  for (_i = 0, _len = _ref.length; _i < _len; _i++) {
    department = _ref[_i];
    alert(department.name);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T23:28:23.097

如果我了解您的要求，则此代码不会按照您的想法进行。

```
for department in store.departments ? [] 
```

看起来您正在使用`?`类似于三元运算符的存在运算符`a?b:c`。来自咖啡脚本.org：

> 在 JavaScript 中检查变量是否存在有点困难。if (variable) ... 接近，但因零、空字符串和 false 而失败。CoffeeScript 的存在运算符 ? 除非变量为 null 或未定义，否则返回 true，这类似于 Ruby 的 nil?

如果我以后想使用这些名称，我会写如下内容：

```
if store.departments?
    names = (department.name for department in store.departments) 
```

您可以将所有内容放在一行中，但是使用列表理解，这变得非常难以理解。存在运算符将测试 null && undef 并且仅在它确实存在时才返回 true。

如果你想在 coffeescript 中使用三元运算符，它就不那么简洁了：

```
for department in if store.departments? then store.departments else [] 
```

也许不完全是你想要的，因为它在这里非常冗长。

# c - 使用 C 在网络上获取数据包计数的方法

> ID：13731345
> 
> 赞同：0
> 
> 时间：2012-12-05T19:57:35.087
> 
> 标签：c, networking, wireshark, libpcap, sniffing

是否可以编写一种方法来为整个网络制作数据包计数器，类似于 Wireshark 在选择接口时的数据包计数。主要的是我想要整个 LAN 的数据包计数，而不仅仅是实际的机器。我听说 libpcap 是最好的起点，尽管我想在这里询问它是否正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T22:35:07.167

我在本文档中找到了答案：http: [//eecs.wsu.edu/~sshaikot/docs/lbpcap/libpcap-tutorial.pdf](http://eecs.wsu.edu/~sshaikot/docs/lbpcap/libpcap-tutorial.pdf)

只需将参数设置为 0 以外的任何值，以在混杂模式下启动接口。

# perl - Perl：一口气检查hashref的引用的正确方法？

> ID：13731346
> 
> 赞同：1
> 
> 时间：2012-12-05T19:57:38.437
> 
> 标签：perl, ref

给定示例代码：

```
foo(bar=>"test");
foo(bar=>["test"]);

sub foo {
   my $args = {@_};

   say ref($args->{bar});
   say ref(\$args->{bar});
} 
```

输出：

> {预期为空白}
> 标量
> 数组
> REF

* * *

我想测试的是检查传递的是标量还是数组的最佳方法。就像是：

```
given( ref($args->{bar}) ){
   when "SCALAR" { }
   when "ARRAY"  { }
} 
```

我可以连接这两种 ref 类型并执行 regex-when，但这是低效的。我也可以像下面这样测试它，但不确定这是否是首选：

```
if    ( ref(\$args->{bar}) eq "SCALAR" ) { ... }
elsif ( ref( $args->{bar}) eq "ARRAY"  ) { ... }
else  { return; } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:16:24.677

您不是要区分标量和数组。在这两种情况下你都会得到一个标量。您试图区分非引用和对数组的引用。

```
if (!ref($x) || ref($x) eq 'ARRAY') {
   # Non-ref or ref to array.
   ...
} 
```

或者

```
if (!ref($x)) {
   # Non-ref
   ...
}
elsif (ref($x) eq 'ARRAY') {
   # Ref to array.
   ...
} 
```

或者

```
for (ref($x)) {
   if (!$_) {
      # Non-ref
      ...
   }
   elsif ($_ eq 'ARRAY') {
      # Ref to array.
      ...
   }
} 
```

或者

```
my $ref_type = ref($x);
if (!$ref_type) {
   # Non-ref
   ...
}
elsif ($ref_type eq 'ARRAY') {
   # Ref to array.
   ...
} 
```

或（假设这些是唯一允许的两种类型的值）

```
if (ref($x)) {
   # Ref to array.
   ...
} else {
   # Non-ref
   ...
} 
```

（请注意，Scalar::Util`reftype`实际上获取 ref 类型。`ref`可以返回类名而不是引用类型。）

请注意，根据存储类型区分值在 Perl 中是一个糟糕的设计。它必然是错误的，因为它破坏了重载的对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T20:54:01.683

给定一个 pragma 的范围

```
use feature qw/ say switch /; 
```

你可以使用

```
sub foo {
  my($args) = { @_ };

  given (ref $args->{bar}) {
    say "plain scalar '$args->{bar}'"
      when "";

    say "array, length=@{[scalar @{ $args->{bar} }]}"
      when "ARRAY";

    default { die "unexpected: $args->{bar}" }
  }
} 
```

输出：

```
纯标量“测试”
数组，长度=1
```

您的问题很抽象，但如果您对您想做什么有更多的了解，我们可以针对您的具体情况提供更具体、更有帮助的建议。

# c# - bool 类型的字段数组

> ID：13731351
> 
> 赞同：1
> 
> 时间：2012-12-05T19:57:47.397
> 
> 标签：c#

我有 4 个 bool 类型的字段：

```
private bool f1;
public bool F1 {
get{return this.f1;}
set
 {
 this.f1=value;
 onPropertyChanged("F1");
 }
}

private bool f2;
public bool F2 {
get{return this.f2;}
set
 {
  this.f2=value;
  onPropertyChanged("F2");
 }
}
private bool f3;
public bool F3 {
get{return this.f3;}
set
 {
 this.f3=value;
 onPropertyChanged("F3");
 }
}
private bool f4;
public bool F4 {
get{return this.f4;}
set
 {
  this.f4=value;
  onPropertyChanged("F4");
 }
} 
```

其中只有一个可能是真的。我想要一种将它们设置在 for 循环中的方法。我尝试了以下方法：

```
bool[] myFields =
{
    F1,F2,F3,F4
};

int Answer = 1; 
for (int index = 0; index < myFields.Length; index++)
{
    if(index == Answer)
    {
        myFields[index] = true;
    }
    else
    {
        myFields[index] = false;
    }
} 
```

但这只会将 myFields 数组中的值设置为真/假，而不是属性 F2 本身。关于如何使它更好/工作的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T20:15:03.753

使用`enum`. 这样，您可以允许值 F1、F2、F3、F4（和“无”，如果适用）。这就是它的样子：

```
public enum FValue { None, F1, F2, F3, F4 }

public class Foo
{
    public FValue Value { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-05T20:01:52.993

我想你不想要这里的自动属性。这个怎么样：

```
public bool F1 {
    get { return myFields[0]; }
    set { myFields[0] = value; }
}
etc... 
```

?

顺便说一句，您的`for`循环可以简化为：

```
for (int index = 0; index < myFields.Length; index++) {
     myFields[index] = (index == Answer);
} 
```

# xcode - Xcode 助手视图标题和源不匹配

> ID：13731354
> 
> 赞同：0
> 
> 时间：2012-12-05T19:57:59.833
> 
> 标签：xcode

直到今天，我一直在使用助手视图，主视图左侧是源，然后是助手视图右侧的标题。当我更改源文件时，它曾经在助手视图中显示正确的头文件，但现在它就像两个单独的视图一样。

我做了什么来破坏它，我该如何修复它？

编辑。我关闭它并再次打开它并修复它。所以问题解决了，但问题仍然有效。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:12:17.810

助手编辑器窗口顶部有一个弹出窗口：

*   “手动”：助手编辑器只是一个独立的独立编辑器窗口，
*   “对应物”：自动显示主视图的对应对应物，
*   还有更多选择...

# java - 从另一个类管理 adView

> ID：13731357
> 
> 赞同：0
> 
> 时间：2012-12-05T19:58:15.477
> 
> 标签：java, android, android-activity, admob, adview

我有一个应用程序。有课。例如我有这些课程：

-MainActivity.java

-AppName.java

-GameScreen.java

-GamePlayScreen.java

我在 MainActivity.java 中进行了广告编码，如下所示，

```
public class MainActivity extends AndroidApplication
{
    protected AdView adView;

    @Override
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    RelativeLayout layout = new RelativeLayout(this);

    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,      WindowManager.LayoutParams.FLAG_FULLSCREEN);
    getWindow().clearFlags(WindowManager.LayoutParams.FLAG_FORCE_NOT_FULLSCREEN);

    AndroidApplicationConfiguration cfg = new AndroidApplicationConfiguration();
    cfg.useGL20 = false;
    View gameView = initializeForView(new AppName(), cfg);

    AdView adView = new AdView(this, AdSize.BANNER, "xxxxxxxxxxxxxxxx");

    AdRequest request = new AdRequest();
    request.addTestDevice("xxxxxxxxxxxxxxxx");
    adView.loadAd(request);

    layout.addView(gameView);

    RelativeLayout.LayoutParams adParams = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT, RelativeLayout.LayoutParams.WRAP_CONTENT);
    adParams.addRule(RelativeLayout.ALIGN_PARENT_TOP);
    adParams.addRule(RelativeLayout.CENTER_HORIZONTAL);

    layout.addView(adView, adParams);

    setContentView(layout);
    }
} 
```

我有一个横幅顶部中心。这很好。这是 AppName.java：

```
public class AppName extends Game
{
@Override
public void create() 
{
    Assets.load();
    setScreen(new GameScreen(this, Settings.STATE_START));
}

@Override
public void resize(int width, int height)
{
    super.resize(width, height);
}

@Override
public void pause() 
{

}

@Override
public void resume() 
{

}

@Override
public void dispose()
{
    Assets.dispose();
    getScreen().dispose();
}
} 
```

一切都很好，我仍然有一个横幅。但问题从这里开始。在我的 GameScreen 中，有一个指向 GamePlayScreen 的链接：

它去 GamePlayScreen 没有问题。

```
game.setScreen(new GamePlayScreen(game, i + 1)); 
```

现在我在玩游戏。但我不想在这里看到横幅。

问题是，如何在 GamePlayScreen 中禁用我的 adView？我的经验是，如果您尝试从另一个类修改 MainActivity.java，您会看到非常好的异常。

感谢您的回答和评论。我认为对于想要在他们的应用程序中集成广告的人来说，这是一个很好的例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:04:06.407

声明您的 adView 公共静态，您应该可以通过 activityName.AdView.setVisibility(View.GONE) 访问它；

确保你在你的活动中实例化它 -

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T21:38:17.173

例如，您可以考虑使用战略模式来改变运行时的行为

```
public class Game { 
    ShowAdBehavior showAdBehavior;

    void setShowAdBehavior(ShowAdBehavior qb)
    {
        showAdBehavior = qb;
    }   

    void performAd(){
        showAdBehavior.AdArea();
    }   

    public void display() {

    }
}

public class AppName extends Game {
    public AppName()
    {
        //set you default behaviour
        showAdBehavior = new CanShowAd();       
    }

}

public interface ShowAdBehavior {
    public void AdArea();
}

public class CantShowAd implements ShowAdBehavior{
    @Override
    public void AdArea() {
        // you can pass adView as a paramater here and setvisibility VISIBLE
        System.out.println("dont show ad");         
    }
}

public class CanShowAd implements ShowAdBehavior{

    @Override
    public void AdArea() {
       // you can pass adView as a paramater here and setvisibility GONE
        System.out.println("show ad");      
    }
}

public class MainClass {

    public static void main(String[] args) {

           // In your activity you can set the behavior

        AppName appName = new AppName();
        appName.performAd();        
        appName.setShowAdBehavior(new CantShowAd());        
        appName.performAd();        
    }
} 
```

**输出**

显示广告 不显示广告

# php - 任何仅适用于手机的 PHP 用户代理检测脚本？

> ID：13731358
> 
> 赞同：0
> 
> 时间：2012-12-05T19:58:17.333
> 
> 标签：php, android, ios, user-agent

> **可能重复：**
> [移动站点的用户代理，域更改](https://stackoverflow.com/questions/1034222/user-agents-for-mobile-site-domain-changing)

我有一个针对手机的网站的优化版本，我想向他们使用手机访问的访问者推荐它。我知道依赖屏幕分辨率是个坏主意，因为今天的许多平板电脑在分辨率方面都与台式机相似。

是否有建议的仅适用于手机的 PHP 用户代理检测脚本？

# mysql - Mysql 按日期排序，但过滤结果

> ID：13731360
> 
> 赞同：2
> 
> 时间：2012-12-05T19:58:16.813
> 
> 标签：mysql

假设我有 4 个表，每个表中都有`A,B,C,D`记录和`datetime`字段。

目前我正在使用`UNION ALL`和`ORDER BY Date DESC`。

问题是如果一个表`A`今天添加了 10 条记录，而表`B`昨天添加了 10 条记录，那么前 10 个结果都来自 table `A`。

是否可以获得按日期排序的记录，但在所有 4 个表之间混合它们？

第一条记录将是从表中添加的最新记录`A`，然后是从表中添加的最新记录，然后`B`是. 像这样循环它们？`C``D`

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:14:19.680

我不确定这是您要找的东西，但我认为您可以使用以下内容：

```
SELECT
  A.*,
  datediff((select max(`date`) from A), `date`) as d_diff,
  1 as tab
FROM A
UNION ALL
SELECT
  B.*,
  datediff((select max(`date`) from B), `date`) as d_diff,
  2 as tab
FROM B
ORDER BY d_diff, tab, `date` desc 
```

或者这个：

```
SELECT * FROM (SELECT  A.* FROM A ORDER BY `date` desc limit 5) a
UNION ALL
SELECT * FROM (SELECT  B.* FROM B ORDER BY `date` desc limit 5) b
ORDER BY `date` DESC 
```

根据您的评论，这应该可行，但也可能很慢：

```
SELECT
  A.*,
  (select count(*) from A A1 where A1.dat>A.dat) as i,
  1 as tab
FROM A
UNION ALL
SELECT
  B.*,
  (select count(*) from B B1 where B1.dat>B.dat) as i,
  2 as tab
FROM B
order by i, tab 
```

（可以使用变量更快，但我更喜欢纯 SQL）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T20:32:48.963

不幸的是，MySQL 没有排名功能——但你可以用变量来模拟它。我建议尝试以下方法：

```
SELECT * FROM 
(select *, @rownum := @rownum + 1 AS rank, 'A' as tbl 
 from (SELECT * FROM (SELECT  A.* FROM A ORDER BY `date` desc) sa) a, 
      (SELECT @rownum := 0) r
 union all
 select *, @rownum2 := @rownum2 + 1 AS rank, 'B' as tbl 
 from (select * from (SELECT  B.* FROM B ORDER BY `date` desc) sb) b, 
      (SELECT @rownum2 := 0) r2
 union all
 select *, @rownum3 := @rownum3 + 1 AS rank, 'C' as tbl 
 from (select * from (SELECT  C.* FROM C ORDER BY `date` desc) sc) c, 
      (SELECT @rownum3 := 0) r3
 union all
 select *, @rownum4 := @rownum4 + 1 AS rank, 'D' as tbl 
 from (select * from (SELECT  D.* FROM D ORDER BY `date` desc) sd) d, 
      (SELECT @rownum4 := 0) r4
) s
order by rank, tbl 
```

或者，尝试类似：

```
SELECT * FROM 
(SELECT S.*, 
        @rownum := CASE WHEN @tblvar <> S.tbl THEN 0 ELSE @rownum+1 END AS rank, 
        @tblvar := S.tbl AS tblvar 
 FROM 
 (SELECT * FROM 
  (SELECT  A.*, 'A' as tbl FROM A
   UNION ALL
   SELECT  B.*, 'B' as tbl FROM B
   UNION ALL
   SELECT  C.*, 'C' as tbl FROM C
   UNION ALL
   SELECT  D.*, 'D' as tbl FROM D) U
  ORDER BY tbl, `date` desc) S,
 (SELECT @rownum := 0) R,
 (SELECT @tblvar := '!') T
) Q
order by rank, tbl 
```

# django - 有没有办法预览 django-allauth 模板（用于样式）

> ID：13731364
> 
> 赞同：3
> 
> 时间：2012-12-05T19:58:29.673
> 
> 标签：django, templates, django-templates

我在应用程序中使用 django-allauth，并希望自定义模板。

我已经复制了一些我想要更改到我的模板目录的内容，它适用于 /login 之类的页面，我可以通过 url 轻松查看，但对于所有错误状态和其他事情，它真的很难，因为我'd 必须登录/注销/创建/销毁与各种用户的连接才能查看所有模板并为其设置样式。

有没有办法查看所有各种模板状态的列表以使样式更容易？

# c# - 当我们有多个同名但属性不同的元素时，如何使用 Xdocument 从 xml 中删除元素

> ID：13731374
> 
> 赞同：17
> 
> 时间：2012-12-05T19:59:08.667
> 
> 标签：c#, xml, linq, linq-to-xml

我有一个如下所示的 xml 文档：

```
<Applications>
  <myApp>
    <add key="ErrorDestinationEventLog" value="EventLog" />
    <add key="version" value="5.0.0.0" />
    <add key="DebugMode_RUN" value="true" />
  </myApp>
</Applications> 
```

所有元素具有相同的元素名称但不同的属性。如何使用 C# 中的 XDocument 从此 xml 中删除一个特定元素及其属性？

```
xd.Element("Applications").Element("myApp").Element(xe.Name).RemoveAll(); 
```

上述命令不起作用，因为所有元素都具有相同的名称。

除了名称之外，还有什么方法可以识别元素吗？如果是这样，我如何使用它从 XDocument 中删除它？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-12-05T20:02:57.230

```
string key = "version";
XDocument xdoc = XDocument.Load(path_to_xml);
xdoc.Descendants("add")
    .Where(x => (string)x.Attribute("key") == key)
    .Remove(); 
```

*更新*您几乎完成了这项工作。您错过的是按属性值过滤元素。这是您过滤和删除选定元素的代码：

```
xd.Element("Applications")
  .Element("myApp")
  .Elements("add")
  .Where(x => (string)x.Attribute("key") == key)
  .Remove(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-05T20:04:52.243

```
xd.Descendants("add")
    .First(a => a.Attribute("key").Value == "version")
    .Remove(); 
```

如果您有除`myApp`under contains 以外`Applications`的标签`add`，您可能更喜欢更安全的版本

```
xd.Descendants("myApp").First()
    .Descendants("add")
    .Where(x => (string)x.Attribute("key") == "version")
    .Remove(); 
```

* * *

您还可以使用**XPath** (System.Xml.XPath)

```
string key="version";
xd.XPathSelectElement(String.Format("//myApp/add[@key='{0}']",key)).Remove(); 
```

# qt - 你如何扩展级联 ui 控件

> ID：13731377
> 
> 赞同：0
> 
> 时间：2012-12-05T19:59:28.183
> 
> 标签：qt, qml, blackberry-10, blackberry-cascades

我正在尝试使用以下代码在级联中扩展 webview 控件

```
#include <bb/cascades/WebView>

namespace mopub {

class BrowserView : public WebView { 
```

我的编译错误是*'{' 标记之前的预期类名*

我试图扩展 QWebView 和 #include 但没有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T22:42:10.087

您必须使用 bb::cascades 指定

```
using namespace bb::cascades; 
```

或完全合格的超类

```
class BrowserView : public bb::cascades::WebView { 
```

# cygwin - 在 Cygwin 和 MINTTY 中打开 PostgreSQL

> ID：13731384
> 
> 赞同：3
> 
> 时间：2012-12-05T19:59:48.890
> 
> 标签：cygwin, mintty

我似乎无法使用 MINTTY 或使用默认的 Cygwin 终端打开 PSQL 的交互模式，它只是在命令下停止`psql databasename`并且什么都不做。让它响应的唯一方法是 ctrl+C 退出它。它在命令提示符下工作正常。

我知道对于 Python，您需要输入 -i 参数 - Cygwin 是否有类似的技巧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-19T00:29:06.193

我在 Mercurial (hg)+OpenSSH、Python 和 MinTTY 上遇到了类似的问题，但在 MSYS 而不是 CygWin 下。我也有同样的问题`mysql`。尽管如此，据我所知，这和我的问题都是由 MinTTY 没有处理使用本机 Windows 控制台功能的应用程序引起的。

[我按照https://code.google.com/p/mintty/issues/detail?id=56#c64](https://code.google.com/p/mintty/issues/detail?id=56#c64)的评论 64 中的解决方案解决了我的问题

在我的路径中编译并安装了 winpty ( [https://github.com/rprichard/winpty](https://github.com/rprichard/winpty) ) 项目后，我能够从 MinTTY shell运行**本机**Python（以交互模式）、Mercurial 和 MySQL，而无需特殊构建或开关（如`python -i`）。我所需要的只是在or命令之前附加`console.exe`or 。为方便起见，我添加了别名，这样无论我在 Linux shell 还是 Windows MinTTY bash shell 中，我都可以使用相同的命令。`console``python``hg``alias hg="console.exe hg"`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-28T04:24:54.067

我有同样的问题。由于某些原因

```
psql -l -h localhost -U postgres 
```

返回数据库列表，但 psql 上的任何其他变体都只是挂起，静默。

* * *

编辑：我在这里找到了答案：[如何在 cygwin 中设置 psql 命令？](https://stackoverflow.com/questions/14489594/how-to-set-up-the-psql-command-in-cygwin)

> Windows psql 使用 Windows 控制台功能；Cygwin 在不支持 Windows 控制台 API 的 Console2 等终端中运行最好。所以 psql 根本不能与 Cygwin 一起工作。需要的是一个 Cygwin 构建的客户端工具，如 psql

# php - CURL POST 显示为 put

> ID：13731385
> 
> 赞同：1
> 
> 时间：2012-12-05T19:59:49.353
> 
> 标签：php, post, curl, amazon-mws

我正在尝试向 Amazon MWS Feeds API 发布请求，并且我正在使用以下 php：

```
 private function submit_feed_request($xml)
{
    $feed_handle = @fopen('php://temp', 'rw+');
    fwrite($feed_handle, $xml);
    rewind($feed_handle);
    $md5 = base64_encode(md5(stream_get_contents($feed_handle, true)));
    $options_string = '';
    $count = 0;
    foreach ($this->options as $k => $v)
    {
        $options_string .= rawurlencode($k) . "=" . rawurlencode($v);
        $options_string .= ($count == count($this->options) -1)? '': "&";
        $count++;
    }
    $this->options['PurgeAndReplace'] = false;
    $this->options['Version'] = '2009-01-01';

    $curl_options = array(
            CURLOPT_CAINFO=>$_SERVER['DOCUMENT_ROOT'] . "\public\amazon_api\cacert_pem.crt",
            CURLOPT_RETURNTRANSFER=>true,
            CURLOPT_POST=>1,
            CURLOPT_PORT=>443,
            CURLOPT_POSTFIELDS=> $options_string,
            CURLOPT_SSL_VERIFYHOST=>2,
            CURLOPT_SSL_VERIFYPEER=> TRUE,
            CURLOPT_FOLLOWLOCATION => 1,
            CURLOPT_PROTOCOLS=> CURLPROTO_HTTPS,
            CURLINFO_HEADER_OUT =>true,
            CURLOPT_HTTPHEADER=> array('Content-Type: text/xml','User-Agent: ADS EV 1.0', 'Transfer-Encoding: chunked', 'Host: mws.amazonservices.com', 'Content-MD5: ' . $md5),        
            CURLOPT_INFILE => $feed_handle,
            CURLOPT_UPLOAD=>true,
            //CURLOPT_CUSTOMREQUEST =>'POST_UPLOAD',
            CURLOPT_VERBOSE => true,
            CURLOPT_HEADER =>true,
    );
    $session = curl_init($this->url);
    curl_setopt_array($session, $curl_options);
    $results = curl_exec($session);
    $errors = curl_error($session);
    $info = curl_getinfo($session);
    curl_close($session);
    var_dump($results);
    echo "<br /><br />";
    print_r($info); 
} 
```

这将输出以下内容：

```
HTTP/1.1 400 Bad Request
Date: Wed, 05 Dec 2012 19:38:36 GMT
Server: Server
x-mws-request-id: 83644d83-e813-41f3-b6b5-191456798dd8
x-mws-timestamp: 2012-12-05T19:38:37.078Z
x-mws-response-context: vnqPDVXwzbo4KhVB8nJQHAOp1IP8QRp44zAQEwX8G+lNJRHEy6Uawfb87j7Kv5giG/cS2Ov9iZw=
Content-Type: text/xml
Content-Length: 324
Cneonction: close
Vary: Accept-Encoding,User-Agent
nnCoection: close

<?xml version="1.0"?>
<ErrorResponse xmlns="https://mws.amazonservices.com/">
  <Error>
    <Type>Sender</Type>
    <Code>InvalidParameterValue</Code>
    <Message>Either Action or Operation query parameter must be present.</Message>
  </Error>
  <RequestID>83644d83-e813-41f3-b6b5-191456798dd8</RequestID>
</ErrorResponse>
"
<br /><br />Array
(
    [url] => https://mws.amazonservices.com/
    [content_type] => text/xml
    [http_code] => 400
    [header_size] => 424
    [request_size] => 218
    [filetime] => -1
    [ssl_verify_result] => 0
    [redirect_count] => 0
    [total_time] => 1.591
    [namelookup_time] => 0.016
    [connect_time] => 0.094
    [pretransfer_time] => 1.342
    [size_upload] => 733
    [size_download] => 324
    [speed_download] => 203
    [speed_upload] => 460
    [download_content_length] => 324
    [upload_content_length] => -1
    [starttransfer_time] => 1.435
    [redirect_time] => 0
    [certinfo] => Array
        (
        )

    [request_header] => PUT / HTTP/1.1
Accept: */*
Content-Type: text/xml
User-Agent: ADS EV 1.0
Transfer-Encoding: chunked
Host: mws.amazonservices.com
Content-MD5: NTI0YTUwNzgyMTc4OTk4MDIxYTg4YjhjZDRjOGRjZDg=
Expect: 100-continue
) 
```

为什么在设置 POST 选项时，我的请求标头显示为 Put 请求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T23:12:38.650

使用该`CURLOPT_INFILE`选项时，方法会自动更改为 PUT。我没有意识到我使用的 API 要求您使用`CURLOPT_CUSTOMREQUEST = "POST"`

# php - PHP：拆分复杂的字符串

> ID：13731386
> 
> 赞同：1
> 
> 时间：2012-12-05T19:59:50.157
> 
> 标签：php, regex

我正在尝试编写一个函数，该函数将接受一个字符串并创建一个下拉列表。

这是一个示例字符串：

```
Primary[Blue|0000FF,Red|FF0000,Yellow|FFFF00],Secondary[Green|00FF00,Orange|FF9900,Purple|663399],Brown|A52A2A,Silver|C0C0C0 
```

我想变成这样：

```
<select>
<optgroup label="Primary">
<option value="0000FF">Blue</option>
<option value="FF0000">Red</option>
<option value="FFFF00">Yellow</option>
</optgroup>
<optgroup label="Secondary">
<option value="00FF00">Green</option>
<option value="FF9900">Orange</option>
<option value="663399">Purple</option>
</optgroup>
<option value="A52A2A">Brown</option>
<option value="C0C0C0">Silver</option>
</select> 
```

我一直在尝试将字符串转换为如下内容：

```
[0] => Primary
[0][0] => Blue|0000FF
[0][1] => Red|FF0000
[0][2] => Yellow|FFFF00
[1] => Secondary
[1][0] => Green|00FF00
[1][1] => Orange|FF9900
[1][2] => Purple|663399
[2]
[2][0] => Brown|A52A2A
[3]
[3][0] => Silver|C0C0C0 
```

我不确定如何拆分初始字符串。我尝试了explode和preg_split，但似乎都没有在我需要的地方分裂。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:09:03.697

`json_decode`不知道你是怎么用这个字符串结束的，我建议你考虑一下`json_encode`

对于当前格式，您可以使用：

```
$string = 'Primary[Blue|0000FF,Red|FF0000,Yellow|FFFF00],Secondary[Green|00FF00,Orange|FF9900,Purple|663399],Brown|A52A2A,Silver|C0C0C0';
preg_match_all("/([a-z]+)(\[([a-z0-9|,]+)\])|([a-z0-9|,]+)$/i", $string, $m);

printf("<select>");
for($i = 0; $i < count($m[1]); $i ++) {
    if (! empty($m[1][$i])) {
        printf("\n\t<optgroup label=\"%s\">", $m[1][$i]);
        foreach ( array_filter(explode(",", $m[3][$i])) as $var ) {
            list($color, $hex) = explode("|", $var);
            printf("\n\t\t<option value=\"%s\">%s</option>", $hex, $color);
        }
        printf("\n\t</optgroup>");
    }
}
foreach ( array_filter(explode(",", $m[4][2])) as $var ) {
    list($color, $hex) = explode("|", $var);
    printf("\n\t<option value=\"%s\">%s</option>", $hex, $color);
}
printf("\n</select>"); 
```

输出

```
<select>
    <optgroup label="Primary">
        <option value="0000FF">Blue</option>
        <option value="FF0000">Red</option>
        <option value="FFFF00">Yellow</option>
    </optgroup>
    <optgroup label="Secondary">
        <option value="00FF00">Green</option>
        <option value="FF9900">Orange</option>
        <option value="663399">Purple</option>
    </optgroup>
    <option value="A52A2A">Brown</option>
    <option value="C0C0C0">Silver</option>
</select> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:17:37.113

您可以尝试在[此正则表达式](https://stackoverflow.com/a/9435857)上拆分: `(?![^\[]+\]),`。

然后从那里，查看字符串是否包含`[]`.

```
$array = preg_split('/(?![^\[]+\]),/', $string);

$return = array();

foreach($array as $val){
    if(preg_match('/(.*)\[(.*)\]/', $val, $match) === 1){
        $return[$match[1]] = explode(',', $match[2]);
    }
    else{
        $return[] = $val;
    }
} 
```

演示：http: [//ideone.com/BM0ewX](http://ideone.com/BM0ewX)

# jquery - 按文件名过滤图像

> ID：13731389
> 
> 赞同：0
> 
> 时间：2012-12-05T20:00:00.117
> 
> 标签：jquery

我目前有以下 jQuery snipplet，它将在特定 div 中查找图像并排除具有特定类的图像：

```
var postImgs = $('#primary img');
var classes = new Array(".skip", ".block", ".ignore");    

postImgs.each(function (){  
   if(!$(this).is(classes.join(", "))) {
      //Do Something
   }
}); 
```

我还需要做的是检查特定文件名以不将该功能应用于任何一个。所以我尝试了一些东西......但它没有用：

```
postImgs.not('img[src$="uniquefile.jpg"]').each(function (){ } 
```

即便如此，我更愿意提供一个文件名数组，就像我的 classes 一样。

那么，除了保留我已经使用的类过滤器之外，我还如何指定要跳过的文件名数组呢？这样我就可以做这样的事情：

```
var fileNames = new Array("uniquefile.jpg", "somename.png", "anotherfile.gif"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:08:31.250

```
var fileNames = new Array("uniquefile.jpg", "somename.png", "anotherfile.gif");

postImgs.each(function (idx, elem){  
    var ok = true;
    $.each(fileNames, function(i, filename) {
        if (elem.src.indexOf(filename) != -1) ok = false;
    });

    if (ok) {
        //image file is not excluded, do something
    }

}); 
```

或者您可以过滤选择器：

```
var fileNames = new Array("uniquefile.jpg", "somename.png", "anotherfile.gif");

postImgs.filter(function() {
    return $.inArray(this.src, fileNames); //requires exact match
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:11:07.890

你可以在选择器中做这样的事情

```
var filenames = ['google.com','msn.com','yahoo.com'];

$('img').not('[src$="' + filenames.join('"],[src$="') + '"]'); // <-- gets images that are not specified in array 
```

[http://jsfiddle.net/DF9rx/](http://jsfiddle.net/DF9rx/)

# javascript - Sencha Touch 2，阿贾克斯承诺

> ID：13731390
> 
> 赞同：2
> 
> 时间：2012-12-05T20:00:02.557
> 
> 标签：javascript, ajax, sencha-touch-2

我正在寻找一个用例中的最佳实践（使用 sencha touch 2 框架）：

我有多个 ajax 调用（JSONP 响应），我想在所有这些响应之间按**日期过滤提要数据。**问题是我不知道什么时候开始过滤。我想知道所有ajax何时完成。

在 jQuery 中，我会使用**"promises"**，例如：

```
 $.when($.ajax("/page1.php"), $.ajax("/page2.php"), ... $.ajax("/pageN.php")).done(function(a1,  a2){
      // do something
    }); 
```

，我在 sencha touch 2 中找不到任何类似的“延迟”，或者您可以建议我另一种检测和加载数据的方法。

在这种情况下，我感谢任何建议帮助或最佳实践。

**更新：**

***是的，我在任何地方都使用煎茶触摸“Ext.Ajax.request”。***

我尝试使用类似的东西来捕获所有请求：

```
 Ext.Ajax.on('beforerequest', this.dosomething, this);
    Ext.Ajax.on('requestcomplete', this.dosomething, this);
    Ext.Ajax.on('requestexception', this.dosomething, this); 
```

但是在这三种情况中的任何一种情况下，都没有被解雇，

PS：当我“午餐”整个应用程序时，我试图在我的主法师“初始化”上执行此事件，在任何情况下它都不会触发任何东西。

我尝试触发事件的时间和方式是否有问题。

谢谢指教！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T21:59:40.040

假设您正在使用 Ext.Ajax.request，并且想要同时发出所有请求，有几种方法可以做到这一点。当每个请求发出时，您可以增加一个简单的计数器，并在请求回调函数中减少该计数器。在回调函数中还检查计数器是否归零 - 如果是，则所有请求都已完成，您现在可以合并所有数据。比较简单。

另一种选择是利用 Ext.Ajax.requests 对象 - 它包含所有当前尚未完成的请求。只要在这些请求开始/完成之间没有其他请求开始，您就可以在回调函数中检查此对象，如果没有请求，则您可以处理您的数据。

[有关 Ext.Ajax 的文档，请参阅此链接](http://docs.sencha.com/touch/2-1/#!/api/Ext.Ajax)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-10T10:37:21.360

它并不完美，但这对我来说永远不会失败：

```
 function removeMaskIfNoAjaxCalls() {
        //clean up mask with timer, because in the Ext.Ajax.request there is one request (current) 
        setTimeout(function() {
            if (Object.keys(Ext.Ajax.requests).length == 0) Ext.Viewport.setMasked(false);
        }, 2000)
    } 
```

# ruby-on-rails - M Hartl 的 Ruby on Rails 教程第 5 章主页自定义标题

> ID：13731391
> 
> 赞同：1
> 
> 时间：2012-12-05T20:00:01.547
> 
> 标签：ruby-on-rails, ruby

在 Michael Hartl 的 RoR 教程中：第 5 章末尾的练习涉及简化 RSpec 测试。

5.37 ( [http://ruby.railstutorial.org/chapters/filling-in-the-layout#sec-layout_exercises](http://ruby.railstutorial.org/chapters/filling-in-the-layout#sec-layout_exercises) ) 为主页定义了几个测试。在文件 spec/helpers/application_helper_spec.rb 中：

```
require 'spec_helper'

describe ApplicationHelper do

  describe "full_title" do
  .
  .
  .
  .
    it "should not include a bar for the home page" do
      full_title("").should_not =~ /\|/
    end
  end
end 
```

要通过此测试，我需要显示主页标题：“Ruby on Rails 教程示例应用程序”而不是“Ruby on Rails 教程示例应用程序 | 主页”

但是，本教程并没有引导我完成如何编写该更改的代码。

这是我尝试过的：

在 app/views/static_pages/home.html.erb 中：

1.  消除：

    `<% provide(:title, 'Home') %>`

在 app/views/layouts/application.html.erb 中将标签编辑为：

```
<title>
 <% if :title
  full_title = "Ruby on Rails Tutorial Sample App | " && yield(:title)
 else
  full_title = "Ruby on Rails Tutorial Sample App"
 end %>
 <%= print full_title %>
</title> 
```

以及我的菜鸟大脑可以召集的其他变化。这是我要完成的工作：

如果页面没有提供标题，则返回“Ruby on Rails Tutorial Sample App”

如果提供了标题，则返回“Ruby on Rails 教程示例应用程序 | #PageTitle”

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T20:12:19.937

那这个呢？

```
module ApplicationHelper

  # Returns the full title on a per-page basis.
  def full_title(page_title)
    base_title = "Ruby on Rails Tutorial Sample App"
    if page_title.empty?
      base_title
    else
      "#{base_title} | #{page_title}"
    end
  end
end 
```

[http://ruby.railstutorial.org/chapters/rails-flavored-ruby#code-title_helper](http://ruby.railstutorial.org/chapters/rails-flavored-ruby#code-title_helper)

只需在您的视图中调用该方法。所以应该像 `<title><%= full_title(yield(:title)) %></title>` 他说的那样。

# http - 用于检测网站已关闭的最佳 http 代码是什么？

> ID：13731392
> 
> 赞同：0
> 
> 时间：2012-12-05T20:00:10.187
> 
> 标签：http, web, monitoring

我们想知道我们的网站是否从客户端关闭，基本上我们所做的就是发出一个 httpclient 调用来获取我们网站的根域页面。我们得到了不同的 http 状态码，如下所示。问题是以下哪一项肯定表明我们的网站暂时关闭了？

404 500 503

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T22:50:34.797

*   404 未找到
*   500 是内部服务器错误
*   503 是服务不可用

请参阅[http://en.wikipedia.org/wiki/List_of_HTTP_status_codes](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes)

除非您对用于检查网站状态的 URL 进行了重定向，否则您应该只期望得到 200 OK 响应。

# ruby-on-rails - 回形针无法为没有扩展名的文件设置附件内容类型

> ID：13731394
> 
> 赞同：0
> 
> 时间：2012-12-05T20:00:20.173
> 
> 标签：ruby-on-rails, ruby-on-rails-3, amazon-s3, paperclip

我正在使用 rails 3 + paperclip + s3（私人存储桶）来允许用户上传文件。

问题是用户可以上传不带扩展名的文件，例如 rails gemfile，它只是“gemfile”而不是“gemfile.txt”当您上传此文件时，回形针不会设置附件内容类型。

我正在确定 content_type 像这样：

```
self.attachment.instance_write(:content_type, MIME::Types.type_for(self.attachment_file_name).to_s) 
```

有没有更好的方法可以更可靠地解决上述错误？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:09:17.133

您要求 MIME::Types 查找具有给定文件名的类型。它希望在 attachment_file_name 中具有文件扩展名（例如`image_12.jpg`：扩展名是`.jpg`，因此`MIME::Types.type_for`知道该文件是图像）。

**你在找什么：**

```
params[:image].content_type # return the content_type
# assuming :image is the name of the form file field 
```

一点研究：

> **根据文件扩展名**返回属于文件的 MIME::Types 列表。

[http://mime-types.rubyforge.org/MIME/Types.html](http://mime-types.rubyforge.org/MIME/Types.html) + ctrl-F "type_for"

# jquery - 类似在python中为jquery枚举的东西？

> ID：13731398
> 
> 赞同：1
> 
> 时间：2012-12-05T20:00:34.260
> 
> 标签：jquery, each

我需要在 python 中枚举之类的东西，但在 JQuery 中。

我有这个小片段：

```
array_of_urls = [....];

items = $('p[id^="gallery_thumb"]'); // get all <p> which id begins with gallery_thumb

for(var i=0; i<items.length; i++) {
    // something something with items, i and array_of_urls 
    // like:

    items[i].load( array_of_urls[i] );
} 
```

有没有办法避免 for 循环并内联？就像 jquery .each 和 python 中的枚举之间的混合..

或者一些更干净的方法来面对这样的问题..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:04:25.367

该[`each`方法](http://api.jquery.com/each/)为您提供了可用于访问数组的索引：

```
array_of_urls = [....];

$('p[id^="gallery_thumb"]').each(function(i, e){
  $(e).load(array_of_urls[i]);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:03:17.433

我认为最接近的是：

```
$("p[id^=gallery_thumb]").each(function (idx) {
   $(this).load(array_of_urls[idx]);
}); 
```

# javascript - 我的函数未执行 onClick，并警告输入值

> ID：13731399
> 
> 赞同：0
> 
> 时间：2012-12-05T20:00:42.187
> 
> 标签：javascript, html

```
<HTML>
<HEAD>
<TITLE>Test Input</TITLE>
<script type="text/javascript">
function go (form) {
  var Tid = document.upperform.inputbox.value;
  alert ("You typed: " + Tid);
    //window.location.href = 'http://serverpage=' + Tid + '&tab=0';
</script>

</HEAD>
<BODY>
<FORM NAME="upperform" ACTION="" METHOD="GET">Go to this Task ID:
    <INPUT TYPE="text" NAME="inputbox" VALUE="" OnBlur="validate(this.form)">
    <INPUT TYPE="button" NAME="button" Value=" Go " onClick="go(this.form)">
</FORM>
</BODY>
</HTML> 
```

我不能让它工作。看起来它应该可以工作，但我一定错过了一些东西。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:02:27.957

您的函数缺少一个结束括号。除此之外，代码有效：http: [//jsfiddle.net/45paz/](http://jsfiddle.net/45paz/)

```
function go (form) {
  var Tid = document.upperform.inputbox.value;
  alert ("You typed: " + Tid);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:02:40.840

缺少右括号

```
<script type="text/javascript">
function go (form) {
  var Tid = document.upperform.inputbox.value;
  alert ("You typed: " + Tid);
    //window.location.href = 'http://serverpage=' + Tid + '&tab=0';
}// <- missing bracket
</script> 
```

# jquery-ui - jQueryUI 工具提示正在与 Twitter Bootstrap 竞争

> ID：13731400
> 
> 赞同：152
> 
> 时间：2012-12-05T20:00:45.497
> 
> 标签：jquery-ui, twitter-bootstrap

我已经能够获得一些*最终*使用以下代码的工具提示：

```
<a href="#" rel="tooltip" title="Tool tip text here">Hover over me</a> 
```

接着

```
<script>
    $('[rel=tooltip]').tooltip();
</script> 
```

我遇到的问题是它使用 jQueryUI 工具提示（没有箭头，大而丑陋的工具提示）而不是 Bootstrap。

我需要做什么才能使用引导工具提示而不是 jQueryUI？

* * *

## 回答 #1

> 赞同：200
> 
> 时间：2013-10-08T12:40:13.150

jQuery UI 和 Bootstrap 都使用`tooltip`插件的名称。用于`$.widget.bridge`为 jQuery UI 版本创建不同的名称，并允许 Bootstrap 插件保持命名工具提示（尝试使用`noConflict`Bootstrap 小部件上的选项只会导致很多错误，因为它不能正常工作；[该问题已在此处报告](https://github.com/twbs/bootstrap/issues/6303#issuecomment-12715745)):

```
// Resolve name collision between jQuery UI and Twitter Bootstrap
$.widget.bridge('uitooltip', $.ui.tooltip); 
```

所以使它工作的代码：

```
// Import jQuery UI first
<script src="/js/jquery-ui.js"></script>
// Resolve name collision between jQuery UI and Twitter Bootstrap
$.widget.bridge('uitooltip', $.ui.tooltip);
// Then import bootstrap
<script src="js/bootstrap.js"></script> 
```

很好的复制粘贴代码，也可以处理按钮冲突：

```
<script type="application/javascript" src="/js/jquery.js"></script>
<script type="application/javascript" src="/js/jquery-ui.js"></script>
<script>
/*** Handle jQuery plugin naming conflict between jQuery UI and Bootstrap ***/
$.widget.bridge('uibutton', $.ui.button);
$.widget.bridge('uitooltip', $.ui.tooltip);
</script>
<script type="application/javascript" src="/js/bootstrap.js"></script> 
```

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2014-10-20T23:18:54.047

一个简单的解决方案是在 jquery-ui.js 之后加载 bootrap.js，以便 bootstrap .tooltip 方法优先。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2016-08-04T22:12:22.603

如果您必须`jquery-ui.js`在`bootstrap.js`此处加载，请执行以下操作：

```
<script type="application/javascript" src="/js/jquery.js"></script>
<script type="application/javascript" src="/js/bootstrap.js"></script>

<script>var _tooltip = jQuery.fn.tooltip;</script>
<script type="application/javascript" src="/js/jquery-ui.js"></script>
<script>jQuery.fn.tooltip = _tooltip;</script>
```

这将覆盖 jquery-ui 的工具提示并始终使用引导程序。

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2014-02-28T05:46:17.183

这对我有用：

如果您需要使用 JQuery-UI 但又想使用引导程序的工具提示，只需从该[网站](http://jqueryui.com/download/)获取自定义版本的 JQuery-UI 即可。

只需取消选中“工具提示”选项，然后下载它（它将类似于“jquery-ui-1.10.4.custom.js”）。

只需将其添加到您的项目而不是您当前使用的版本中，您就可以参加派对了。这样可以避免冲突。它对我来说就像一个魅力！

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2016-06-09T12:34:25.823

假设 UI 将在 bootsrap 初始化后调用

在 UI 初始化之前存储引导函数

```
jQuery.fn.bstooltip = jQuery.fn.tooltip; 
```

然后调用它如下

```
$('.targetClass').bstooltip(); 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2013-12-17T09:41:37.530

不如只使用 Bootstrap 弹出框来代替？BS 弹出框不会产生相同的冲突，尽管它们需要相同的 tooltip.js 组件。是的，它们更加风格化，但不会导致我的 JQuery UI 按钮出现问题。

我仅将 Jquery UI 用于自定义自动完成/组合框（因此不能声称其他 JQ-UI 控件没问题），并且上述方法都无法解决调用 BS 工具提示时组合框按钮变为“无样式”的 CSS 问题。切换到 BS Popovers 提供了基本相同的效果，没有冲突，没有重新排序我的脚本导入，也不需要显式的桥接语句。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2013-06-04T03:25:25.113

[这个解决方案](https://github.com/twitter/bootstrap/issues/6303#issuecomment-12715745)似乎对我很有效。

```
// handle jQuery plugin naming conflict between jQuery UI and Bootstrap
$.widget.bridge('uibutton', $.ui.button);
$.widget.bridge('uitooltip', $.ui.tooltip); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-12-05T20:15:03.983

尝试使用[jQuery.noConflict()](http://api.jquery.com/jQuery.noConflict/)看看是否对你有帮助。看起来 bootstrap 和 jQuery 使用相同的命名空间，并且可能 bootstrap 和 jQuery 工具提示被加载到同一个函数中，或者先加载一个。

您还可以检查首先加载哪个库。通常，如果您在 javascript 中两次声明相同的函数，则第二个就是使用的函数。

第三，检查 jQueryUI 包（[在他们的网站上）](http://jqueryui.com/download/)，看看是否可以下载不包含工具提示的版本（我检查过，这是完全可行的）。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-08-22T14:01:09.430

有一个简单而好的解决方案，只需重新排列您的引导程序和 jquery ui 文件链接，如下所示：

```
 <script src="/js/jquery-ui.min.js" type="text/javascript"></script>
 <script src="/js/bootstrap.min.js" type="text/javascript"></script> 
```

只需在加载 boostrap js 文件之前加载 jQueryui。这对我有用。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-06-30T23:14:17.153

An easy way is to load bootstrap.js after jquery-ui.js, so that the bootstrap .tooltip overrides jquery UI's. If you're using a module loader like requirejs, then you could make bootstrap dependent upon jquery-ui, as such:

```
requirejs.config({
    baseUrl: 'js',
    waitSeconds: 30,
    shim: {
        'bootstrap': {
            deps: [ 'jquery', 'jquery-ui' ]
        },... 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-02-18T16:09:01.040

万一你...

1.  不想在 jQuery UI 和
2.  `$.widget.bridge`并且`noConflict`不为你工作
3.  您不想覆盖 jQuery UI 工具提示

那么另一种重新启用引导工具提示的方法如下：

```
<script src="/js/bootstrap.js"></script>

<script>
    var bsTooltip = $.fn.tooltip;
</script>

<script src="/js/jquery-ui.js"></script> 
```

然后您可以通过这种方式初始化引导工具提示：

```
// initialize tooltips
bsTooltip.call( $( "[data-toggle='tooltip']" ) ); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-06-08T07:52:05.953

另一种方法是下载自定义构建的 jquery UI。

排除不需要的内容，在本例中为工具提示。

可以从这里下载[https://jqueryui.com/download/](https://jqueryui.com/download/)

这样你就可以在任何地方包含它

# javascript - jquery 插件架构

> ID：13731402
> 
> 赞同：0
> 
> 时间：2012-12-05T20:00:53.920
> 
> 标签：javascript, jquery, jquery-plugins

您好我正在创建一个具有一些重型 Javascript 功能的应用程序我对如何构建它有疑问。

我有一个与插件 B 通信的 Jquery 插件 A。插件 B 中有一些函数可以在插件 A 中发生事件时调用。这是一个基本设置。

但如果用户愿意，他们可以使用插件 C 而不是插件 B 并覆盖插件 B 的默认行为。但不能更改函数名称或插件 A 中默认调用插件 B 的任何内容。

有什么方法可以轻松实现这一目标吗？以及我应该遵循什么架构。我希望在插件 B 初始化时引发一个事件，然后我可以通过插件 C 中的函数覆盖它。

任何帮助将不胜感激。

**编辑**

考虑下面的例子。

我订阅了一个活动

```
 A.subscribe(Event, function(topic, data) {
            $.defaultfunction(Event, data, Value);
          }); 
```

默认情况下，它调用插件 B 中的函数。插件 B 具有默认函数。

现在我需要一种方法来用另一个插件 C 中的另一个函数覆盖插件 B 中的 defaultfunction 中的默认行为。

我希望我的问题很清楚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:35:26.407

不要让插件 A 调用插件 B，而是让插件 A 触发插件 B 和 C 都在监听的事件。这允许插件 A 将其事件广播给正在使用的 B 或 C 中的任何一个。

# ios - 更新轴标题属性

> ID：13731403
> 
> 赞同：1
> 
> 时间：2012-12-05T20:00:56.600
> 
> 标签：ios, ios5, ios-simulator, core-plot

我有一个正在 iPad 上测试的核心图。我最初使用以下代码设置图表：

```
CPTXYAxis *x;
x.title = @"something"; 
```

然后稍后在一些用户交互之后，我想简单地更改轴标题。我已经尝试了下面的代码，但它不起作用：

```
x.title = @"Something Else"; 
```

和

```
[x setAxisTitle [[CPTAxisTitle alloc] initWithText:@"Something Else" textStyle:titleStyle]; 
```

其中 titleStyle 只是所需 textStyle 接口的基本设置。有谁知道我应该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:37:55.127

我的错...

```
[x setAxisTitle [[CPTAxisTitle alloc] initWithText:@"Something Else" textStyle:titleStyle]; 
```

实际上确实有效，我在代码的其他地方犯了一个错误。

# python - 计算矩阵乘法的子集

> ID：13731405
> 
> 赞同：4
> 
> 时间：2012-12-05T20:01:00.070
> 
> 标签：python, numpy, scipy, sparse-matrix

当我有两个非稀疏矩阵`A`和 我有存储在[此处](http://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csc_matrix.html#scipy.sparse.csc_matrix)指定的 CSC 格式的所需索引。`B``C=A.T.dot(B)``C``C`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T12:54:36.037

如果您事先知道您想要 C 的哪些部分并且其中一些部分是连续的矩形区域*，那么您可以使用与分区矩阵乘法 ( [1](http://www.math.nyu.edu/%7Eneylon/linalgfall04/project1/jme/index.htm) ) 或块矩阵乘法 ( [2](https://en.wikipedia.org/wiki/Block_matrix) ) 相关的矩阵代数规则来加速这些计算中的一些。因此，例如，您可以使用与@GaryBishop 相同的基本逻辑，但是您可以使用由 i_start、i_end 和 j_start、j_end 组成的四元组的列表（或数组）来代替“i”和“j”元素的列表定义 C 的子矩阵，那么您可以使用这些索引（尽管在这些链接中建立规则）来找出您需要求解所需的 C 块的 A 和 B 的子矩阵。

举个简单的例子，假设你只想要 C 的中间块，所以我们将 C 按行划分为 C1、C2 和 C3，我们只关心 C2。如果 A^{T} 同样被划分为三组行 A1、A2、A3 则 C2 = A2 * B。这个想法推广到任何形状的矩形，它只需要 A 和 B 的不同划分来计算。这个想法是一样的。

*   - 这是微不足道的，但如果区域大于单个元素，您只会节省时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T23:23:15.600

您可以让 numpy 进行循环，而不是使用 Python（GaryBishop 的回答）对坐标进行迭代，这构成了显着的加速（时间如下）：

```
def sparse_mult(a, b, coords) :
    rows, cols = zip(*coords)
    rows, r_idx = np.unique(rows, return_inverse=True)
    cols, c_idx = np.unique(cols, return_inverse=True)
    C = np.dot(a[rows, :], b[:, cols])
    return C[r_idx, c_idx]

>>> A = np.arange(12).reshape(3, 4)
>>> B = np.arange(15).reshape(3, 5)
>>> np.dot(A.T, B)
array([[100, 112, 124, 136, 148],
       [115, 130, 145, 160, 175],
       [130, 148, 166, 184, 202],
       [145, 166, 187, 208, 229]])
>>> sparse_mult(A.T, B, [(0, 0), (1, 2), (2, 4), (3, 3)])
array([100, 145, 202, 208]) 
```

`sparse_mult`返回您作为元组列表提供的坐标处的值的扁平数组。我对稀疏矩阵格式不是很熟悉，所以我不知道如何从上述数据中定义 CSC，但以下工作：

```
>>> coords = [(0, 0), (1, 2), (2, 4), (3, 3)]
>>> sparse.coo_matrix((sparse_mult(A.T, B, coords), zip(*coords))).tocsc()
<4x5 sparse matrix of type '<type 'numpy.int32'>'
    with 4 stored elements in Compressed Sparse Column format> 
```

这是各种替代方案的时间安排：

```
>>> import timeit
>>> a = np.random.rand(2000, 3000)
>>> b = np.random.rand(3000, 5000)
>>> timeit.timeit('np.dot(a,b)[[0, 0, 1999, 1999], [0, 4999, 0, 4999]]', 'from __main__ import np, a, b', number=1)
5.848562187263569
>>> timeit.timeit('sparse_mult(a, b, [(0, 0), (0, 4999), (1999, 0), (1999, 4999)])', 'from __main__ import np, a, b, sparse_mult', number=1)
0.0018596387374678613
>>> np.dot(a,b)[[0, 0, 1999, 1999], [0, 4999, 0, 4999]]
array([ 758.76351111,  750.32613815,  751.4614542 ,  758.8989648 ])
>>> sparse_mult(a, b, [(0, 0), (0, 4999), (1999, 0), (1999, 4999)])
array([ 758.76351111,  750.32613815,  751.4614542 ,  758.8989648 ]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T16:50:32.437

忽略 CSC 业务，也许回答一个比你问的更简单的问题。在给定 C 索引值的元组列表的情况下，我将如何计算 C 元素的子集。

由于您正在评估 C=ATdot(B) ，因此您将 A 的列乘以 B 的列。所以，

```
for i, j in indexList:
    C[i, j] = np.dot(A[:,i], B[:,j]) 
```

我猜这不是你要找的，但我发现简单的答案有时有助于澄清问题。

# android - 在 Android 上使用 Canvas 在两条线之间绘制区域

> ID：13731406
> 
> 赞同：0
> 
> 时间：2012-12-05T20:01:01.213
> 
> 标签：android, graphics, canvas, statistics

我正在为我的应用程序开发一个简单的统计图形类。我已经尝试过 aChartEngine 和其他更多，但我更喜欢使用我自己的类。我正在使用包含 Android 的 Canvas 类绘制图形，但问题是我不知道如何填充线条和底部边框之间的区域。现在，矩形并没有填满所有区域，显然，你知道任何解决方案吗？非常感谢。

![这是我的图表](../Images/07e792ea008c8ab2e2df0c9c54ec833e.png)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-05T20:05:48.007

将 a[`Path`](http://developer.android.com/reference/android/graphics/Path.html)与[`Paint`](http://developer.android.com/reference/android/graphics/Paint.html)已[`.setStyle(Paint.Style.FILL);`](http://developer.android.com/reference/android/graphics/Paint.html#setStyle(android.graphics.Paint.Style))调用的 a 一起使用。

```
Path fillPath = new Path();
fillPath.moveTo(0, 0); // Your origin point
fillPath.lineTo(x1, y1); // First point
// Repeat above line for all points on your line graph
fillPath.lineTo(xN, yN); // Final point
fillPath.lineTo(xN, 0); // Draw from final point to the axis ++
fillPath.lineTo(0, 0); // Same origin point
yourCanvas.drawPath(fillPath, /* Your paint */); 
```

*++ 感谢[@TheCapn](https://stackoverflow.com/users/804773/thecapn)的这一点。*

# java - 电话号码链接不可点击的android

> ID：13731409
> 
> 赞同：1
> 
> 时间：2012-12-05T20:01:08.260
> 
> 标签：java, android, html

```
x = (TextView)findViewById(R.id.xLink);
x.setOnTouchListener(new View.OnTouchListener() {

        @Override
        public boolean onTouch(View v, MotionEvent event) {
            AlertDialog x = new AlertDialog.Builder(this.this).create();

            x.setMessage(Html.fromHtml(getString(R.string.text)));

            x.setButton(AlertDialog.BUTTON_NEUTRAL, "Ok", new DialogInterface.OnClickListener() {

                @Override
                public void onClick(DialogInterface dialog, int which) {
                    dialog.dismiss();
                }
            });

            x.show();

            return false;
        }
    });

  <TextView
    android:id="@+id/xLink"
    android:text="Click"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:textColor="@color/blue1"
    android:paddingTop="30dip"
    android:paddingRight="10dip"
    android:layout_gravity="right"
    android:textSize="16dip" />

 <string name = "text">at&lt;br /&gt;&lt;a href="tel:18004455667"&gt;1-800-445-5667 lt;/a&gt;.</string> 
```

所以基本上，当您单击链接时，会出现一个对话框，其中的数字似乎是一个链接，但是当您单击时，它什么也不做。这可能发生的任何原因？我已经尝试过使用 ascii 字符进行更改，但什么也没做/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:09:41.187

我相信 HTML 锚是问题所在，特别是如果您没有将资源设置`text`为`fromHTML()`：`textView.setText(HTML.fromHTML(getString(R.string.text)));`

使电话号码可点击的最简单方法是`autoLink`直接文本：

```
<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:autoLink="phone"
    android:text="My Number: 1-800-762-2035"
     /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:15:44.067

尝试阅读以下文档：

[http://developer.android.com/reference/android/text/util/Linkify.html](http://developer.android.com/reference/android/text/util/Linkify.html "链接文档")

您可能需要清理文本，因为它周围的垃圾**可能**会导致问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T21:38:25.343

这是你的答案，它已经过测试。

```
public class MainActivity extends Activity {

    private AlertDialog dialog;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        AlertDialog.Builder builder = new Builder(MainActivity.this);

        Spanned message = Html.fromHtml(getString(R.string.text));
        final SpannableString str = new SpannableString(message);
        Linkify.addLinks(str, Linkify.ALL);

        builder.setMessage(str);

        builder.setPositiveButton("OK", new OnClickListener() {

            @Override
            public void onClick(DialogInterface dialog, int which) {
                // TODO Auto-generated method stub
                dialog.dismiss();
            }
        });

        dialog = builder.create();

        TextView t = (TextView) findViewById(R.id.textView1);
        t.setOnTouchListener(new OnTouchListener() {

            @Override
            public boolean onTouch(View v, MotionEvent event) {

                dialog.show();

                // This must be called after dialog.show();
                ((TextView)dialog.findViewById(android.R.id.message)).setMovementMethod(LinkMovementMethod.getInstance());

                return false;

            }
        });

    }

} 
```

# c# - 即使我指定了自己的 Entity Framework 也会自动生成 ID

> ID：13731413
> 
> 赞同：0
> 
> 时间：2012-12-05T20:01:26.060
> 
> 标签：c#, asp.net, asp.net-mvc, entity-framework

我有一个带有名为 Node 的表的 SQL 数据库。它有一个组合键：NodeId、DocId。两列都设置为标识规范 = 否。我在 Visual Studio 中生成了一个 EDMX，以将节点从 EF 保存到数据库。VS 生成的 Node 对象有两个字段设置为 StoreGeneratedPattern = None。我指定的 NodeId 已正确放入数据库中，但 DocId 是自动生成的。每次我插入一些新节点时，它们都会得到相同的 DocId。这是正确的，但它不是我在对象中指定的 DocId。这是一个自动生成的。我指定的 NodeId 已正确保存到数据库 - 此字段不会自动生成。我看不出这两个领域有什么区别。

这是我的代码：

```
using (MyEntities db = new MyEntities())
{
    // Delete old nodes using my own extension method
    db.DeleteObjects(db.Nodes.Where(n => n.DocId == doc.DocId));

    // Create EF doc object
    Document newDbDoc = docDTO.ToDbDoc();

    // Add new nodes using my own extension method
    db.Nodes.AddObjects(newDbDoc.Nodes);

    try
    {
        db.Connection.Open();

        using (var transaction = db.Connection.BeginTransaction())
        {
            try
            {
                db.SaveChanges();

                transaction.Commit();

                return Json("Success");
            }
            catch
            {
                transaction.Rollback();

                return Json("Error");
            }
        }
    }
    catch
    {
        return Json("Error");
    }
} 
```

我自己的扩展方法：

```
public static class ObjectContextExtensions
{
    public static void DeleteObjects(this ObjectContext context, IEnumerable<EntityObject> entities)
    {
        foreach (var ent in entities)
        {
            context.DeleteObject(ent);
        }
    }

    public static void AddObjects<TEntity>(this ObjectSet<TEntity> objectSet, IEnumerable<TEntity> entities) where TEntity : class
    {
        foreach (var ent in entities)
        {
            objectSet.AddObject(ent);
        }
    }
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:42:10.813

Ack... 我发现发生了什么。每次我添加节点时，都会在 Document 表中创建一个新 Document，即使我从未添加过调查对象。我猜 EF 足够“智能”来创建文档本身，因为每个节点都有对调查的引用。我通过仅创建一个引用现有 DocId 而不包括 Document 对象本身的节点列表来解决它。

# javascript - 使用 JavaScript 向 HTML5 画布上的图像添加碰撞检测

> ID：13731416
> 
> 赞同：0
> 
> 时间：2012-12-05T20:01:40.123
> 
> 标签：javascript, html5-canvas, draggable

我有以下 JavaScript 函数，我用它来尝试在 HTML5 画布周围拖放图像：

```
function canvasState(myGameCanvas){

var bounding_box = myGameCanvas.getBoundingClientRect();
//var mouseX = (mouse_event.clientX-bounding_box.left) * (myGameCanvas.width/bouding_box.width);
//var mouseY = (mouse_event.clientY-bounding_box.top) * (myGameCanvas.height/bounding_box.height);
//var pixels = context.getImageData(mouseX, mouseY, 1, 1);

this.valid = false; /*When set to true, the canvas will redraw everything */
this.allImagesArray; /*This is the array holding all of the images to be drawn */
this.dragging = false; /*Keep track of when the current selected object is being dragged */
this.selection = null;
this.dragOffX = 0; /*See mousedown and mousemove events for explanation */
this.dragOffY = 0;

this.interval = 30; /*This variable will be used to determine how often the draw method is called. */

/*Save a reference to the canvasState so that I'm still using this particular canvasState. */
var myState = this;

/*This stops double clicking on the canvas selecting text on the canvas */
myGameCanvas.addEventListener('selectstart', function(e) {e.preventDefault(); return false; }, false);
console.log("Event Listener 'selectstart' added to canvas.");
/*Up, down and move are for dragging */
myGameCanvas.addEventListener('mousedown', function(e){
    console.log("Event Listener 'mousedown' added to canvas");
    //var mouse = myState.getMouse(e);
    var mX = e.clientX;
    var mY = e.clientY;
    console.log("ClientX = " + mX + "clientY = " +mY);
    var allImages = myState.allImagesArray;
    var NoOfImages = allImages.length;
    for (var i = 1-1; i >= 0; i--){
        /*At the moment this is looking for coordinates in the array. It should
            be looking for images at that position. I want to get coordinates for 
            all images in the array, and calculate whether the click is on one of those.*/
        if(allImages[i].contains(mX, mY)){
            var mySelection = allImages[i];
            /*Keep track of where in the object was clicked, so that it can be 
                moved smoothly (see mousemove) */
                alert("test");
            myState.dragOffX = mX - mySelection.x;
            myState.dragOffY = mY - mySelection.y;
            myState.dragging = true;
            myState.selection = mySelection;
            myState.valid = false;
            return;
        }
    }
    /*If the code hasn't returned, it means that nothing has been selected.
    If there was an object selected, then deselect it. */
    if (myState.selection){
        myState.selection = null;
        myState.valid = false; /*Need to clear the old selection border */

    }
}, true);

/*This event checks to see if the dragging flag has been set to true. If it has, it gets the
current mouse position and moves the selected object to that position, remembering the offset
where it was selected. If the dragging flag is false, the event does nothing. */
myGameCanvas.addEventListener('mousemove', function(e){
    console.log("Event listener 'mousemove' added to canvas.");
    if(myState.dragging){
        var mouse = myState.getMouse(e);
        /*I don't want to drag the object by its top left corner, I want to drag from where the
        object was clicked. That's why I saved the offset and use it here. */
        myState.selection.x = e.clientX - myState.dragOffX;
        myState.selection.y = e.clientY - myState.dragOffY;
        myState.valid = false; /*Something's dragging, so I must redraw */
    }
}, true);

/*All the mouseup event has to do is update the canvas state so that it is no longer dragging.
So, once the mouse button is lifted, the mousemove event should be back to doing nothing. */
myGameCanvas.addEventListener('mouseup', function(e){
    console.log("Event listener 'mouseup' added to canvas.");
    myState.dragging = false;
}, true);

//setInterval(function(){ myState.draw(); }, myState.interval);

canvasState.prototype.draw = function(){
    /*If the state is invalid,redraw and validate. */
    if (!this.valid){
        var context = this.context;
        var images = this.images;
        this.clear();

        /*Redraw the game elements here */
        drawLevelOneElements();
    }
}

} 
```

但是，由于某种原因，当我在浏览器中查看我的网页时，尽管所有图像都显示在画布上，并且控制台日志显示当您单击时光标在画布上的位置，由于某种原因，该行

```
selectedImage.draggable = "true"; 
```

似乎没有使任何图像可拖动。谁能看到我在这里做错了什么？

**编辑 06-12-2012 @ 10:40 以显示更改的代码**

单击开始按钮时，所有图像仍显示在画布上 - 我在控制台中有一个从 0 开始的打印输出，并且每次从数组中将图像绘制到画布时递增 1。

一旦所有图像都被绘制到画布上（并且打印输出已达到 33 - 因为数组中有 34 个图像），然后我将“添加到画布的事件侦听器'mousemove'”这一行打印到控制台几次（可能大约 30 次）。如果我再次单击画布，则会再次调用该循环，再打印该行大约 30 次。也没有任何图像是可拖动的。有任何想法吗？

# c - 了解用于接收 UDP 消息和打开 TCP 套接字的 Select 循环

> ID：13731418
> 
> 赞同：2
> 
> 时间：2012-12-05T20:01:45.133
> 
> 标签：c, sockets, networking, tcp, udp

嗨，我正在为网络类工作一个项目，我们正在网络中创建节点，这些节点通过 udp 从控制应用程序接收消息，然后与其他节点创建 tcp 连接。基本顺序如下： 1) 控制管理器向节点 A 发送 udp 消息，告诉它连接到节点 B 2) 节点 A 接收到 udp 消息并将 udp 消息转发给节点 B 3) 节点 B 接收到 udp 消息，随机选择一个端口号，在该端口上打开一个侦听 tcp 套接字，并使用端口号将 udp 消息发送回 A 4) 节点 A 接收到 udp 消息并在该 tcp 端口上打开与节点 B 的连接。

基本上，我想循环接收到的 udp 消息并跳转到我的消息解析函数，同时循环 tcp 连接。这部分看起来很简单，但我真的不明白如何将监听套接字添加到文件描述符列表中。以下代码是我放在一起的，我想知道基本结构是否正确？我真的不明白如何创建监听 tcp 套接字并将其添加到 fd 列表中？

```
SOCKET udpsock;
udpsock = initudp(port); //setup udp socket
SOCKET tcpsock;
FD_ZERO(&rdsocks);

max = udpsock + 1;
while(1)
{
    SOCKET temp;

    FD_SET(udpsock,&rdsocks);//setup udp macros
    FD_SET(tcpsock,&rdsocks);

    if( select(max,&rdsocks,NULL,NULL,NULL) == SOCKET_ERROR )
    {
        perror("Select error");
        WSACleanup();
        return 1;
    }
    for(temp = 0; temp<=max;temp++) // loop on TCP sockets
    {
        if(FD_ISSET(temp,&rdsocks))
        {
            printf("Socket %d is ready \n",temp);
            // process tcp messages
        }

    }
    if(FD_ISSET(udpsock,&rdsocks)) // udp connection, parse control message
    {
        int ret = 0;
        res = recvfrom(udpsock, buff,sizeof(buff),0,(struct sockaddr*)&udpclient,lenaddr);
        //process udp message, setup tcp connection here if requested and add to file descriptor list?
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:18:14.037

创建侦听 TCP 套接字 ( [`socket(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/socket.2.html), [`bind(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/bind.2.html), [`listen(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/listen.2.html)) 后，将其标记为非阻塞[`setsockopt(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/setsockopt.2.html)，并将其添加到[`select(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/select.2.html).

当它变得“可读”时，这意味着您有客户端连接挂起，请致电[`accept(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/accept.2.html). 也将新连接的套接字添加到读取集中。

您可能希望保留这些客户端套接字的列表/哈希/任何内容，因为必须在每次调用之前重新初始化读取集[`select(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/select.2.html)并计算其第一个参数（最大 fd）。

[注意 0：我在这里参考 Linux 手册页，但逻辑几乎是跨平台的。[您可以在MSDN](http://msdn.microsoft.com/e)上找到 Windows 参考资料。] [注 1：Windows[`select()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740141%28v=vs.85%29.aspx)忽略它的第一个参数。]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T02:01:55.557

您需要在调用and`FD_ZERO()`之前调用每个循环迭代。此外，在您首先尝试连接它之前，不要将 TCP 套接字添加到它。保留您创建的 TCP 套接字列表，以便您可以将它们重新添加到每次循环迭代中。`FD_SET()``select()``fd_set``fd_set`

尝试这样的事情：

```
udpsock = initudp(port); //setup udp socket

std::vector<SOCKET> tcpsocks;
SOCKET tcpsock;

while(1)
{
    FD_ZERO(&rdsocks);
    FD_SET(udpsock, &rdsocks);
    max = udpsock;

    for(size_t i = 0; i < tcpsocks.size(); ++i)
    {
        tcpsock = tcpsocks[i];
        FD_SET(tcpsock, &rdsocks);

        if( tcpsock > udpsock )
            max = tcpsock;
    }

    if( select(max+1, &rdsocks, NULL, NULL, NULL) == SOCKET_ERROR )
    {
        perror("Select error");
        WSACleanup();
        return 1;
    }

    for(size_t i = 0; i < tcpsocks.size(); ++i) // loop on TCP sockets
    {
        tcpsock = tcpsocks[i];            
        if( FD_ISSET(tcpsock, &rdsocks) )
        {
            printf("Socket %d is ready \n", tcpsock);
            // process tcp message
        }
    }

    if( FD_ISSET(udpsock, &rdsocks) )
    {
        int ret = 0;
        res = recvfrom(udpsock, buff, sizeof(buff), 0, (struct sockaddr*)&udpclient, lenaddr);
        // process udp message...
        if( setup tcp connection is requested )
        {
            tcpsock = ...;
            if( tcpsock != INVALID_SOCKET )
                tcpsocks.push_back(tcpsock);
        }
    }
} 
```

# c++ - 当 std::map::insert 找到元素时，它仍然构造对象的实例。我怎样才能阻止这个？

> ID：13731423
> 
> 赞同：1
> 
> 时间：2012-12-05T20:01:54.880
> 
> 标签：c++, standard-library

我有一个对象的 std::map，其实例的构造成本非常高。（在现实生活中，他们需要多次访问数据库。）

我想访问地图的一个元素，或者如果它不存在就创建它。这听起来像是 std::map::insert 的工作，除了昂贵的对象是不必要地构造的，然后如果元素存在则丢弃。为了显示：

```
#include <iostream>
#include <map>
#include <string>

struct CexpensiveObject
{    
    CexpensiveObject(const char* args="default"):args_(args)
    {
        std::cout << "Constructor: CexpensiveObject(" << args << ")" << std::endl;
    }
    CexpensiveObject( const CexpensiveObject& other )
    {
        std::cout << "Copy Constructor: CexpensiveObject other.args_ = " << other.args_ << "." << std::endl;
        args_ = other.args_;
    }
    ~CexpensiveObject()
    {
        std::cout << "Destructor: CexpensiveObject args_ = " << args_ << "." << std::endl;
    }
    const char* args_;
};

// entry point
int main() 
{
    typedef std::map<std::string, CexpensiveObject> mymaptype;   
    mymaptype mymap;
    std::pair<mymaptype::iterator, bool> insertionResult;

    std::cout << "First insertion" << std::endl;
    insertionResult = mymap.insert( mymaptype::value_type( "foobar", CexpensiveObject("first") ) );
    std::cout << "Was it inserted? " << (insertionResult.second?"yes":"no") << std::endl;

    std::cout << "Second insertion" << std::endl;
    insertionResult = mymap.insert( mymaptype::value_type("foobar", CexpensiveObject("second") ) );
    std::cout << "Was it inserted? " << (insertionResult.second?"yes":"no") << std::endl;
} 
```

结果：

```
First insertion
Constructor: CexpensiveObject(first)
Copy Constructor: CexpensiveObject other.args_ = first.
Copy Constructor: CexpensiveObject other.args_ = first.
Destructor: CexpensiveObject args_ = first.
Destructor: CexpensiveObject args_ = first.
Was it inserted? yes
Second insertion
Constructor: CexpensiveObject(second)
Copy Constructor: CexpensiveObject other.args_ = second.
Destructor: CexpensiveObject args_ = second.
Destructor: CexpensiveObject args_ = second.
Was it inserted? no
Destructor: CexpensiveObject args_ = first. 
```

复制和破坏的次数比我预期的要多，但关键是构造了一个实例 CexpensiveObject，然后如果 ma 中存在具有相同键的元素，则将其丢弃。

我是在滥用 std::map::insert，还是在实例化 CexpensiveObject 实例之前必须使用 std::map::find 来检查是否存在具有相同键的元素？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-05T20:09:12.510

`insert`它是在你调用之前构建的`CexpensiveObject("second")`。您正在*传递*无关的对象！`value_type`（然后它在传递给时被复制`insert`。）

而不是`insert`，使用`find`. 如果您在所需的键处找到该项目，那么您就完成了。如果没有，*则*插入它。

```
auto it = mymap.find("foobar");
if (it == mymap.end())
  mymap.insert(mymaptype::value_type("foobar", CexpensiveObject("second"))); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T20:35:24.783

如果对象已经存在，使用 find 检查是否应该插入元素以节省一些工作。

可悲的是 map::insert 多次调用您的复制构造函数。如果这是不可接受的，并且您可以使用 c++11，请查看 map::emplace_insert。如果您必须使用 C++03，IIRC[升压容器](http://www.boost.org/doc/libs/1_52_0/doc/html/container.html)有一个地图，它使用内部[升压移动](http://www.boost.org/doc/libs/1_52_0/doc/html/move.html)来模拟移动语义。

# node.js - 在低端 VPS 上为 Node.js 应用程序选择数据库

> ID：13731425
> 
> 赞同：3
> 
> 时间：2012-12-05T20:02:08.393
> 
> 标签：node.js, vps

我正在寻找一个低端的 VPS 盒子并将其设置为 Node.js Web 服务器。我将主要做业余爱好，没有什么太挑剔（还）。我可能会选择 512MB RAM VPS，但理想情况下，它也应该在 256MB 上运行。我想我会运行一个 Node.js 进程和一个数据库。

我最大的问题是数据库——你会为低内存机器推荐什么？我可以从 SQLite 之类的东西开始，然后使用 ORM 让我以后可以轻松地迁移到 PostgreSQL 之类的更大的东西吗？

还是人们主要使用 NoSQL 数据库？哪些适合这样的服务器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T09:07:49.160

我通常使用 NoSQL 数据库。

当我开始使用 node.js 时，我也有一个小型 VPS 可以玩。我不是系统管理员，我只是想玩 node。因此，我很快意识到使用自己的服务器让我无法做我真正想做的事 -> 使用 node.js。

虽然你在使用自己的服务器时会学到很多东西，比如 SSH、upstart、vim、用户管理、安装包、shell 等。

今天我使用 paas / saas 代替我自己的服务器。我最喜欢的 node.js 托管服务提供商是[nodejitsu](http://nodejitsu.com/)。您可以免费试用 nodejitsu 30 天。[Heroku](http://www.heroku.com/)也很有名。对于 mongoDB 数据库，我使用[mongolab](https://mongolab.com/)和[mongoHQ](https://www.mongohq.com)。为了存储用户会话，我更喜欢使用[RedisToGo](http://redistogo.com/)的 redis 。可以在[heroku#data-stores](https://addons.heroku.com/#data-stores)上找到对 db paas/saas 的一个很好的概述。

# google-maps - BalloonStyle 中的 KML 实体替换在 GoogleMaps 中失败，但在 GoogleEarth 中则不然

> ID：13731428
> 
> 赞同：2
> 
> 时间：2012-12-05T20:02:14.503
> 
> 标签：google-maps, google-maps-api-3, kml, google-earth

从 GEarth 与 Google 地图中调试 KML 花费了太多时间。有人可以给我一个提示，说明为什么下面的“实体替换”在 GE 中可以正常工作，但在 GMaps 中却失败了。

我运行了 XMLValidate 并且文件很好，但是 [CDATA] 中的标签不会被 GoogleMaps API 替换，只有在 GEarth 中。[我阅读了有关BalloonStyle 实体替换](http://developers.google.com/kml/documentation/extendeddata#entityreplacement)的最佳实践 KML 文档，以及[OGC KML 2.2 标准](http://portal.opengeospatial.org/files/?artifact_id=27810)中令人麻木的描述，并调整和修剪了文件，但我仍然感到困惑。在以下情况下，我无法让实体替换在 GMaps API 中工作。

有任何想法吗？-谢谢

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2" xmlns:gx="http://www.google.com/kml/ext/2.2" xmlns:kml="http://www.opengis.net/kml/2.2" xmlns:atom="http://www.w3.org/2005/Atom">
    <Document>
        <name>ParcelsJoinedx.kml</name>
        <Style id="outline">
            <PolyStyle>
                <color>00ff0000</color>
                <fill>1</fill>
                <outline>1</outline>
            </PolyStyle>
            <BalloonStyle>
                <bgColor>ffffffff</bgColor>
                <text>
                <![CDATA[
                    <head>
                    <title></title>
                    <STYLE TYPE="text/css">
                    <!-- TD{font-family: Arial; font-size: 9pt;} --->
                    </STYLE>
                    </head>
                    <body>
                      <table >
                      <tr><td valign='top'><font color="#aa0000">$[ParcelJoined/Location/displayName]:</font></td><td>$[ParcelJoined/Location]</td>
                      <tr><td><font color="#aa0000">$[ParcelJoined/ParcelID/displayName]:</font></td><td>$[ParcelJoined/ParcelID]</td>
                     </tr></table>
                     </body>
                     ]]>
                 </text>
            </BalloonStyle>
        </Style>
        <Schema name="ParcelJoined" id="ParcelJoinedID">
            <SimpleField type="string" name="Name"></SimpleField>
            <SimpleField type="string" name="Description"></SimpleField>
            <SimpleField type="string" name="Location">
                <displayName><![CDATA[<b>Location</b>]]></displayName>
            </SimpleField>
            <SimpleField type="string" name="ParcelID">
                <displayName><![CDATA[<b>ParcelID</b>]]></displayName>
            </SimpleField>
            <SimpleField type="string" name="Zone"></SimpleField>
            <SimpleField type="string" name="AssessArea"></SimpleField>
            <SimpleField type="string" name="Owner"></SimpleField>
            <SimpleField type="string" name="CoOwner"></SimpleField>
            <SimpleField type="string" name="Address1"></SimpleField>
            <SimpleField type="string" name="Address2"></SimpleField>
            <SimpleField type="string" name="City"></SimpleField>
            <SimpleField type="string" name="State"></SimpleField>
            <SimpleField type="string" name="ZIP"></SimpleField>
            <SimpleField type="string" name="AcctNum"></SimpleField>
            <SimpleField type="string" name="YearBuilt"></SimpleField>
            <SimpleField type="string" name="LandValue"></SimpleField>
            <SimpleField type="string" name="BldgValue"></SimpleField>
            <SimpleField type="string" name="OtherValue"></SimpleField>
            <SimpleField type="string" name="TotalValue"></SimpleField>
            <SimpleField type="string" name="MainBldgDesc"></SimpleField>
            <SimpleField type="string" name="StateCode"></SimpleField>
            <SimpleField type="string" name="SaleDate"></SimpleField>
            <SimpleField type="string" name="Rooms"></SimpleField>
            <SimpleField type="string" name="Beds"></SimpleField>
            <SimpleField type="string" name="Baths"></SimpleField>
        </Schema>
        <Folder>
            <name>ParcelJoinedFldr</name>
            <Placemark>
                <styleUrl>#outline</styleUrl>
                <ExtendedData>
                    <SchemaData schemaUrl="#ParcelJoinedID">
                        <SimpleData name="Location">68 WALCOTT AVE</SimpleData>
                        <SimpleData name="ParcelID">9-459</SimpleData>
                        <SimpleData name="Zone">R40$39</SimpleData>
                        <SimpleData name="AssessArea">3.72 AC</SimpleData>
                        <SimpleData name="Owner">CXXX, CXX R ET</SimpleData>
                        <SimpleData name="CoOwner">CXXX, GLXXA G</SimpleData>
                        <SimpleData name="Address1">32 EAST 88TH STREET</SimpleData>
                        <SimpleData name="Address2"></SimpleData>
                        <SimpleData name="City">NEW YORK</SimpleData>
                        <SimpleData name="State">NY</SimpleData>
                        <SimpleData name="ZIP">10021</SimpleData>
                        <SimpleData name="AcctNum">2421</SimpleData>
                        <SimpleData name="YearBuilt">1910</SimpleData>
                        <SimpleData name="LandValue">2036060</SimpleData>
                        <SimpleData name="BldgValue">479800</SimpleData>
                        <SimpleData name="OtherValue">1500</SimpleData>
                        <SimpleData name="TotalValue">2517360</SimpleData>
                        <SimpleData name="MainBldgDesc">CONVNTL</SimpleData>
                        <SimpleData name="StateCode">1100 - SEASONAL &amp; BEACH</SimpleData>
                        <SimpleData name="SaleDate">04/07/1995</SimpleData>
                        <SimpleData name="Rooms">0</SimpleData>
                        <SimpleData name="Beds">0</SimpleData>
                        <SimpleData name="Baths">4 Full / 0 H</SimpleData>
                    </SchemaData>
                </ExtendedData>
                <Polygon>
                    <outerBoundaryIs>
                        <LinearRing>
                            <coordinates>-71.363000752291924,41.489279023867283 -71.364928267362686,41.489246551445632 -71.364928271377551,41.48924655145035 -71.366127398895557,41.489226333780891 -71.366980322431843,41.489211945621989 -71.366980559667908,41.489218729506135 -71.366992415755973,41.489658359975031 -71.363335128398276,41.489691230204564 -71.36332242991972,41.489681182960041 -71.36320151947757,41.489583338563875 -71.363080572769988,41.489488329510586 -71.363012929798629,41.48940065703426 -71.363000855378388,41.489285011997865 -71.363000752291924,41.489279023867283</coordinates>
                        </LinearRing>
                    </outerBoundaryIs>
                </Polygon>
            </Placemark>
        </Folder>
    </Document>
</kml> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T21:49:50.803

我认为如果你使用简单的`<ExtendedData>`和`<Data>`元素来提供数据，它可能会起作用，以及或而不是`<Schema>`和`<SchemaData>`元素。

看它，你甚至需要模式数据吗？您是否在需要将数据作为类型字符串的其他应用程序中使用 KML？

谷歌地球和谷歌地图忽略了类型数据，所以如果它对你没有其他用途，它只会让你的 kml 膨胀。

您链接到的文档的前半部分涉及此问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-22T23:21:19.260

回答你关于为什么这在谷歌地图中不起作用的问题：谷歌地图 API 正式不支持`<Schema>`两者。完全支持和部分支持（[参考](https://developers.google.com/maps/documentation/javascript/kmllayer#supported-elements "这里")）。`<SchemaData>``<Data>``<ExtendedData>`

该参考提供了一个表格，详细说明了 API 支持的 KML 功能。以下是相关行：

```
+----------------+-----------------------+----------------------------+
|  KML element   | Supported in the API? |         Comment            |
+----------------+-----------------------+----------------------------+
| <BalloonStyle> | partially             | only <text> is supported   |
| <Data>         | yes                   |                            |
| <ExtendedData> | partially             | untyped <Data> only, no    |
|                |                       | <SimpleData> or <Schema>,  |
|                |                       | and entity replacements of |
|                |                       | the form $[dataName] are   |
|                |                       | not supported.             |
| <Schema>       | no                    |                            |
| <SchemaData>   | no                    |                            |
+----------------+-----------------------+----------------------------+ 
```

如果链接断开，请参阅 Google Maps JavaScript API 开发人员文档中“KML 和 GeoRSS”指南的“支持的 KML 元素”部分。

# mysql - 这个 SQL 语句有什么问题？在同一事务中选择和删除

> ID：13731429
> 
> 赞同：-2
> 
> 时间：2012-12-05T20:02:17.247
> 
> 标签：mysql

我收到此语句的语法错误。知道为什么吗？

我唯一的猜测是会话记录可能已从选择中锁定，因此无法在同一事务中删除。但这似乎不会导致语法错误。

```
insert into sessions_history 
      select * 
      from sessions 
      where session_id = 'jjmn6hmuor8mqa2j1vb4gdpno0'; 

delete from sessions 
     where session_id = 'jjmn6hmuor8mqa2j1vb4gdpno0'; 
```

这是错误：

错误号：1064

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'delete from sessions where session_id = 'vk744qiebkfr0el7tesi65us04'' at line 1

insert into sessions_history select * from sessions where session_id = 'vk744qiebkfr0el7tesi65us04'; delete from sessions where session_id = 'vk744qiebkfr0el7tesi65us04'; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:08:46.507

在 insert into ... select .. 语句中不能有括号。

```
insert into sessions_history 
      select * 
      from sessions 
      where session_id = 'jjmn6hmuor8mqa2j1vb4gdpno0'; 
```

# python - 是否有用于合并 dicts 的 python 内置函数，当出现关键冲突时，我可以传递函数以运行？

> ID：13731432
> 
> 赞同：1
> 
> 时间：2012-12-05T20:02:23.587
> 
> 标签：python

正是它在锡上说的。

有没有内置的python函数可以做到这一点？

```
la = {'a':[1,2,3],'b':[4,5,6]}
na = {'a':[7,8,9],'b':[1,2,3]}

la = la.update(na, merge=lambda a,b: a.extend(b)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:10:14.740

不是内置的，但以下应该做你想要的：

```
for k, v in na.items():
    la.setdefault(k, []).extend(v) 
```

例子：

```
>>> la = {'a':[1,2,3],'b':[4,5,6]}
>>> na = {'a':[7,8,9],'b':[1,2,3]}
>>> for k, v in na.items():
...     la.setdefault(k, []).extend(v)
...
>>> la
{'a': [1, 2, 3, 7, 8, 9], 'b': [4, 5, 6, 1, 2, 3]} 
```

# neo4j - 我可以获取所有组中的平均用户数，然后在 neo4j 的密码查询中返回具有更多用户的组吗？

> ID：13731434
> 
> 赞同：0
> 
> 时间：2012-12-05T20:02:31.543
> 
> 标签：neo4j, cypher

如果我想找到用户数超过平均用户数的组，我添加了 where 子句，但我们不能在 where 中使用聚合......这是我的密码查询：

```
params.put("query", "name:*");
ExecutionResult result = engine.execute( "start n=node:groups({query}) 
match n<-[:Members_In]-x 
with n,count(distinct x) as numberOfUsers
where numOfUsers>avg(numOfUsers) 
return  n.name,numOfUsers ", params ); 
```

`n`是组名，x 是每个组的用户。如何获取组用户的平均数量，然后返回具有更多用户的组？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T10:01:30.443

尝试使用 WITH，例如

```
start n=node(*) 
match n<-[:Members_In]-x 
with n, count(distinct x) as countOfUsers
with n, avg(countOfUsers) as avg 
where avg<3 
return  n.name, avg 
```

例如[http://tinyurl.com/czkpmws](http://tinyurl.com/czkpmws)

# python - Python 中的聊天机器人数据库

> ID：13731441
> 
> 赞同：1
> 
> 时间：2012-12-05T20:02:56.653
> 
> 标签：python, machine-learning, artificial-intelligence, chatbot

目前，我正在编写一个试图模拟某种对话的聊天机器人。作为 Python 中的一个 n00b，我目前依靠列表和字典来对一组标准查询进行一些标准响应。随着我了解更多，我意识到列表/字典/函数还不够，我必须使用某种数据库。目前，当我遇到来自用户的新问题时，我只是不断地将项目添加到我的列表/字典中。我的问题是，我使用什么数据库来存储/查询来自用户的数据。我在答案中浏览了[这个](https://stackoverflow.com/questions/7450560/how-best-to-store-data-for-a-chatbot)及其后续链接，但我没有提到使用了哪个数据库。（我的这个小项目旨在自学机器学习和 NLP 的概念）

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:10:09.143

**[Google n-grams](http://storage.googleapis.com/books/ngrams/books/datasetsv2.html)**可能是您可以获得的最好的数据库之一，它不仅可以为您提供单词的频率，还可以为您提供带有频率的 n-grams，这将使您可以获取短语！

您还可以将[维基百科转储文件](http://en.wikipedia.org/wiki/Wikipedia%3aDatabase_download)用于各种用途，例如单词/术语的语义分析，如 Markovitch 和 Gabrilovich 在他们的（出色的）论文中所述：[基于维基百科的自然语言处理语义解释](http://www.cs.technion.ac.il/~shaulm/papers/abstracts/Gabrilovich-2009-WBS.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T20:06:16.800

可能想调查一下[`redis`](http://redis.io/)。它非常快（这对于聊天机器人很重要）并且非常易于使用。不过，它只是一个键值存储，所以如果您正在寻找像 XML 示例那样的分层逻辑，这不一定是您的答案——但话又说回来，您可能不想将逻辑存储在无论如何数据库。

基本上，看看 Redis，但没有更多关于你在做什么的细节，这有点难以帮助。

# joomla - 带龙门的 Joomla 2.5 在 IE9 中不起作用

> ID：13731449
> 
> 赞同：0
> 
> 时间：2012-12-05T20:03:22.620
> 
> 标签：joomla, frameworks, joomla2.5

我将 Joomla 2.5 与龙门框架一起使用，而我的模板在 IE9 上不起作用。徽标是唯一加载的部分。

问题： [http ://www.wmi9.com.br/aprova/](http://www.wmi9.com.br/aprova/)

有谁知道可以是什么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T22:20:10.090

在 64 位的 IE 9.0.8 中完美加载。

有趣的是，我遇到了一个问题，即问题不在于 IE 本身。但是安装了所有插件和工具栏后，它会影响页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:51:11.143

问题在于控制台的幻灯片显示了一些错误：

```
Unsafe JavaScript attempt to access frame with URL http://www.wmi9.com.br 
from frame with URL http://player.vimeo.com/video/2203727?wmode=transparent. 
Domains, protocols and ports must match. 
```

尝试删除 VIMEO 和 YOUTUBE 幻灯片。

# android - 将音频从一部 Android 手机流式传输到另一部

> ID：13731453
> 
> 赞同：1
> 
> 时间：2012-12-05T20:03:29.330
> 
> 标签：android, audio-streaming

我正在制作两个应用程序 - 接收器和发送器，每个应用程序都在 Android 设备上运行。发送方应该能够通过 Wifi 将本地音频文件流式传输到接收方，最好使用 UDP 或 RTP。

我已经制作了接收器应用程序，它在互联网广播电台和所有地方运行良好，但现在的问题在于制作发送器应用程序。我一直无法在网上找到任何可靠的资源。我提到的一些资源以及为什么它们没有帮助：

[#1](http://rxwen.blogspot.in/2010/04/streaming-audio-on-android.html) Audiotrack 不支持 mp3，这将是一个主要缺点。

[#2](https://stackoverflow.com/questions/9770565/streaming-real-time-audio) 这使用了一个叫做 ParcelFileDescriptor 的东西。无论这是否是阅读太多不熟悉的 API 的结果，我都无法理解该行在`ParcelFileDescriptor socketedFile = ParcelFileDescriptor.fromSocket(socket)`做什么。它似乎正在创建一个新`parcelfiledescriptor`的 from `socket`，但我认为代码应该将它发送到`socket`.

那么任何人都可以建议替代方案或修改上述适用于我的应用程序的代码类型吗？供您参考，我附上了接收方应用程序的源代码。

```
package com.example.audioclient;

import java.io.IOException;

import android.media.*;
import android.media.MediaPlayer.*;
import android.media.MediaPlayer.OnPreparedListener;
import android.net.Uri;
import android.os.Bundle;
import android.app.Activity;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class RTPClient extends Activity implements MediaPlayer.OnCompletionListener, MediaPlayer.OnPreparedListener, MediaPlayer.OnErrorListener, MediaPlayer.OnBufferingUpdateListener{

String URL_OF_FILE = "http://fr3.ah.fm:9000";
private String TAG = getClass().getSimpleName();
private MediaPlayer mp = null;

private Button play;
private Button pause;
private Button stop;

private EditText tv; 

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    play = (Button) findViewById(R.id.play);
    //pause = (Button) findViewById(R.id.pause);
    stop = (Button) findViewById(R.id.stop);

    tv = (EditText) findViewById(R.id.editText1);

    //URL_OF_FILE = tv.getText().toString();

    play.setOnClickListener(new View.OnClickListener() {
           public void onClick(View view) {
            play();
           }
    });

    /*pause.setOnClickListener(new View.OnClickListener() {
           public void onClick(View view) {
            pause();
           }
    });*/

    stop.setOnClickListener(new View.OnClickListener() {
               public void onClick(View view) {
                stop();
               }
    });
}

private void play() {
      //Uri myUri = Uri.parse("http://currentstream1.publicradio.org:80/");
        URL_OF_FILE = tv.getText().toString();
        Uri myUri = Uri.parse(URL_OF_FILE);
      try {
          if (mp == null) {
              this.mp = new MediaPlayer();
          } else {
              mp.stop();
              mp.reset();
          }
          mp.setDataSource(this, myUri); // Go to Initialized state
          mp.setAudioStreamType(AudioManager.STREAM_MUSIC);
          mp.setOnPreparedListener(this);
          mp.setOnBufferingUpdateListener(this);

          mp.setOnErrorListener(this);
          mp.prepareAsync();

          Log.d(TAG, "LoadClip Done");
            } catch (Throwable t) {
                Log.d(TAG, t.toString());
            }
        }

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

    @Override
public boolean onError(MediaPlayer mp, int what, int extra) {
        StringBuilder sb = new StringBuilder();
        sb.append("Media Player Error: ");
        switch (what) {
        case MediaPlayer.MEDIA_ERROR_NOT_VALID_FOR_PROGRESSIVE_PLAYBACK:
            sb.append("Not Valid for Progressive Playback");
            break;
        case MediaPlayer.MEDIA_ERROR_SERVER_DIED:
            sb.append("Server Died");
            break;
        case MediaPlayer.MEDIA_ERROR_UNKNOWN:
            sb.append("Unknown");
            break;
        default:
            sb.append(" Non standard (");
            sb.append(what);
            sb.append(")");
        }
        sb.append(" (" + what + ") ");
        sb.append(extra);
        Log.e(TAG, sb.toString());
        return true;
        }

@Override
public void onPrepared(MediaPlayer mp) {
      Log.d(TAG, "Stream is prepared");
      mp.start();
}

private void pause() {
      mp.pause();
}

private void stop() {
    mp.stop();

}

 @Override
 public void onDestroy() {
     super.onDestroy();
     stop();

 }

 public void onCompletion(MediaPlayer mp) {
      stop();
 }

 public void onBufferingUpdate(MediaPlayer mp, int percent) {
     Log.d(TAG, "PlayerService onBufferingUpdate : " + percent + "%");
 }

} 
```

# python - 'Manager' 对象在 Django 分页上是不可订阅的错误

> ID：13731454
> 
> 赞同：0
> 
> 时间：2012-12-05T20:03:32.553
> 
> 标签：python, django, django-pagination

在 Django 1.4.2 中，我使用了[官方文档中给出](https://docs.djangoproject.com/en/dev/topics/pagination/?from=olddocs#using-paginator-in-a-view)的简单分页代码：

```
...
paginator = Paginator(songs, 25) # Show 25 songs per page

page = request.GET.get('page')
try:
    songs = paginator.page(page)
except PageNotAnInteger:
    # If page is not an integer, deliver first page.
    songs = paginator.page(1)
except EmptyPage:
    # If page is out of range (e.g. 9999), deliver last page of results.
    songs = paginator.page(paginator.num_pages)
... 
```

当我运行该视图时，我在线收到“ ***'Manager' object is unsubscriptable*** ”错误`songs = paginator.page(1)`。我搜索了错误，但找不到任何解决方案。问题是什么？

**编辑：**

`songs`是 django 模型对象列表。全视图代码是这样的：

```
def index(request):
    songs = Song.objects

    #filter params
    q_name = request.GET.get('name', None)
    if q_name:
        songs = songs.filter(name__contains=q_name)

    q_composer = request.GET.get('composer', None)
    if q_composer:
        songs = songs.filter(composer__name__contains=q_composer)

    q_composer_id = request.GET.get('composer_id', '')
    if q_composer_id != '':
        songs = songs.filter(composer__id=q_composer_id)

    paginator = Paginator(songs, 25) # Show 25 contacts per page

    page = request.GET.get('page')
    try:
        songs = paginator.page(page)
    except PageNotAnInteger:
        # If page is not an integer, deliver first page.
        songs = paginator.page(1)
    except EmptyPage:
        # If page is out of range (e.g. 9999), deliver last page of results.
        songs = paginator.page(paginator.num_pages)

    return render(request, 'index.html', {'songs': songs}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:23:32.267

当没有提供过滤器时会发生什么。然后，您尝试对 AuditManger 而不是查询集进行分页。您应该将第一个查询更改为：

```
songs = Song.objects.all() 
```

# c - C中的灵活结构

> ID：13731455
> 
> 赞同：0
> 
> 时间：2012-12-05T20:03:35.297
> 
> 标签：c, arrays, pointers

我看到一些代码如下：

```
struct Hello
{
   int age;
   int time;
   int data[1];
};

struct Element
{
   int a;
   int b;
};

struct Element element_[5] = (/* Initiate the array */);
struct Hello* hello = (struct Hello*)malloc(sizeof(Element)*5);
struct Element * element_p = NULL;

element_p = (struct Element *)hello->data;

for(int i = 0; i<5; i++)
{
   memcpy(element_p, &element_[i], sizeof(struct Element));
} 
```

对于这一行：`element_p = (struct Element *)hello->data;`，为什么我们需要强制转换`hello->data to (struct Element *)`？这是否意味着对`element_p`will指针的操作对`hello->data`? 这一行是否会将每个元素的地址填充`struct Element element_[5]`到 的每个元素`hello->data`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-05T20:06:50.987

~~这是可怕的**可怕**的C++。~~演员表是必需的，因为`hello->data`实际上是一个`int[]`，所以不能直接转换为一个`Element*`。

此外，它是未定义的行为，因为`hello`未初始化，但您取消引用它（通过`->data`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:39:25.577

`element_p`必须是指向`struct Element`but `hello->data`is的指针`int data[1]`，所以你需要强制转换。假设您将`hello`“强制”初始化`element_p`为指向单个整数所在的内存区域的指针，因为实际上`hello->data`将指向数组中“包含”的第一个也是唯一一个整数`hello->data[]`。由于`struct Element`“包含” 2 个整数，`element_p->a`应该访问`hello->data[0]`，但`element_p->b`会尝试访问`hello->data[1]`超出数组范围的访问。

`2*sizeof(int)`for 循环将从每个已初始化的 struct 中获取的 struct Element 大小的数据（很可能）复制`element_`到所指向的数据`element_p`中，正如我们所说，并且由于缺少部分（参见下面的 hack），有空间只需 1 个整数。由于`element_p`保持不变，您将覆盖该内存，并且只有最后一个复制的“结构”将继续存在。

正如您向我们展示的那样，它看起来像是一个很好的崩溃方法。无论如何，如果`hack` 乔在评论中谈论的内容到位，`element_p`将指向其他几个“整数”中的第一个整数。由于 int 只不过是内存，因此它们足以容纳`struct Element`您可以使用`element_p[0]`第一个、`element_p[1]`第二个等访问的结构。可能像

```
 hello = malloc(sizeof (*hello) + sizeof (struct Element) * 6); 
```

或类似的。现在，`element_p = (struct Element *)hello->data`可以使用了。

无论如何，for循环继续写入同一区域，`element_p`需要提前1（1个整个结构`Element`）以便每次填充不同的区域（`element_p+i`应该去）。

# clojure - 如何在 Clojure 中将 max 应用于具有预定义顺序的值列表？

> ID：13731456
> 
> 赞同：3
> 
> 时间：2012-12-05T20:03:37.217
> 
> 标签：clojure

我需要将 max 运算符应用于以下列表

```
[Tier20 Tier10 Tier30] 
```

它应该给我

```
Tier30 
```

预定义的有序列表（从低到高）是

```
[Tier5 Tier10 Tier20 Tier30 Tier40 Tier50] 
```

在 Clojure 中实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T21:59:52.453

首先定义排序：

```
user> (def order '[Tier5 Tier10 Tier20 Tier30 Tier40 Tier50])
#'user/order 
```

然后我们将订单映射到可以通过创建一个排序的东西上`map`

```
user> (def order-map (zipmap order (range)))
{Tier50 5, Tier40 4, Tier30 3, Tier20 2, Tier10 1, Tier5 0} 
```

**如果您只需要最大/最小值，请**使用 order-map 来减少输入：****

 **```
user> (reduce #(if (< (order-map %1) (order-map %2)) %1 %2) 
              '[Tier20 Tier10 Tier30])
Tier30 
```

* * *

或者如果您需要完整排序，则使用 sort-by 函数，它与常规排序函数类似，只是它让您有机会在比较之前翻译输入：

```
user> (sort-by (zipmap order (range)) '[Tier20 Tier10 Tier30])
(Tier10 Tier20 Tier30) 
```

如果您需要大量修改此地图而不是每次都重新排序，则使用数据`sorted-set-by`结构来存储您的输入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T20:06:04.960

使用减少。例如，要找到列表 L 的最大值，您可以：

```
(reduce max L) 
```

这里真正的问题是您的层是字符串还是更复杂的对象，因为从您的帖子中并不完全清楚。无论哪种方式，您都可以用 lambda 表达式替换 max 以提取字符串的数字部分，如下所示：

```
(reduce (fn [x y] ...) L) 
```

其中 ... 将是从数据中提取数字部分的表达式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T20:08:18.173

这是我刚刚尝试过的。杠杆的要点是实例方法`.indexOf`。`clojure.lang.Vector`

```
user> (def x ['Tier5 'Tier10 'Tier20 'Tier30 'Tier40 'Tier50])
#'user/x
user> (index-of x 'Tier10)
; Evaluation aborted.
user> (.indexOf x 'Tier10)
1
user> (def y ['Tier20 'Tier10 'Tier30])
#'user/y
user> (reduce #(max %1 (.indexOf x %2)) y)
; Evaluation aborted.
user> (x (reduce #(max %1 (.indexOf x %2)) 0 y))
Tier30
user> 
```

当然，这是 O(n ² )。如果您要大规模执行此操作，那么从 TierN 到其排序索引的哈希映射会为您提供更好的服务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T20:31:47.623

如果数组是这样的，`java.lang.String`则具有一些互操作性：

```
user=> (def array ["Tier5" "Tier10" "Tier20" "Tier30" "Tier40" "Tier50"])
#'user/array
user=> (defn find-max [m] (reduce #(if (> (.compareTo %1 %2) -1) %1 %2) m))
#'user/find-max
user=> (find-max array)
"Tier50"
user=> (find-max "a")
\a 
```

如果不只是让它们实现`Comparable`，或者创建一个 `Comparator`.**

# javascript - 如何在 plunker 中维护我的下划线模板设置？

> ID：13731460
> 
> 赞同：3
> 
> 时间：2012-12-05T20:03:43.760
> 
> 标签：javascript, backbone.js, underscore.js, plunker

我已经使用 plunker 大约一个月了。我正在制作一个backbonejs plunker，我看到Underscore 丢失了我的模板设置并回退到ERB 样式模板，而我想要Mustache 样式语法`{{ myData }}`。我在我的 app.js 中设置值（我总是在我的应用程序中这样做），但由于某种原因，它不断变回 ERB `<%=boo%>`。有人可以帮我理顺我的模板设置吗？ [plunker 使用下划线模板](http://plnkr.co/edit/1X0Tn3?p=preview)，您需要在 chrome 开发工具或 firebug 或 equiv 中查看控制台输出...

感谢您提供任何提示或技巧。我试过了

```
_.templateSettings = { 
   interpolate: /\{\{(.+?)\}\}/g,
   evaluate: /\[\[(.+?)\]\]/g
 }; 
```

当我`console.log(_.templateSettings)`在我的 app.js 文件中设置后，一切似乎都是正确的，但我的模板没有被处理。我可以在视图内部中断并运行相同的 console.log()，我看到它已切换回 ERB 样式。有谁知道如何使我的设置保持不变？也许这是一个笨拙的问题，因为我已经多次使用这种方法而没有问题。

这通常可以解决问题。我什至尝试... window._ = _;

感谢您提供任何帮助、提示、技巧等...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T22:43:12.700

你只是有一个执行顺序问题。你`app.js`这样说：

```
var app = {
  init: function () {
    _.templateSettings = {
      interpolate: /\{\{(.+?)\}\}/g,
      evaluate: /\[\[(.+?)\]\]/g
    };
    window._ = _;
  },
  //... 
```

因此在有人调用之前不会应用您的模板设置`app.init()`。如果我们在 中查看您的某个观点`main.js`，我们会看到如下内容：

```
Zurg.Views.AltContent = app.View.extend({
  #...
  template: _.template([...].join('')),
  #... 
```

因此，您的`_.template`调用`main.js`在加载和解析时发生，但`app.init()`直到稍后才会调用。

您需要做的就是按以下顺序安排事情发生：

1.  加载库（jQuery、Underscore、Backbone、...）
2.  调整`_.templateSettings`以使用您的分隔符。
3.  加载您的视图。

如果你把它`_.templateSettings`移到外面`app.init`：

```
_.templateSettings = {
    interpolate: /\{\{(.+?)\}\}/g,
    evaluate: /\[\[(.+?)\]\]/g
};

var app = {
  init: function () {
    // Whatever you really need to initialize things goes here...
  },
  //... 
```

那么一切都会好起来的。顺便说一句，你的`window._ = _;`把戏没有做任何有用的事情，所以我把它拿出来了。你也应该包含一个`escape`正则表达式`_.templateSettings`，你可能不需要它，但完整性很好。

# ruby-on-rails - 无法在 Rails 上的 Backbone 模型上访问 id？

> ID：13731461
> 
> 赞同：0
> 
> 时间：2012-12-05T20:04:01.460
> 
> 标签：ruby-on-rails, ruby-on-rails-3, backbone.js

**问题：** 我正在使用 Backbone.js 在 Rails 中镜像资源丰富的模型。我正在尝试将当前用户 ID 获取到 Backbone Workshop.Models.User 模型，以便我可以通过 Rails 用户 RESTful 资源将用户保存到数据库。我无法从 Currentuser 模型中检索 id。?

当我尝试在 Backbone 中检索当前用户模型的实例的 id 时，我的返回值未定义。我可以在服务器日志上看到获取成功，如果我将本地实例输出到日志中，我可以检查对象。我什至可以使用控制台运行相同的代码并成功获取 id。它只是在运行时。

我怀疑我应该以不同的方式配置我的模型或在我的视图中绑定一些东西。帮助？

[在这里查看我的要点](https://gist.github.com/4218882)

**楷模：**

```
# singleton model gets current user

class Workshop.Models.Currentuser extends Backbone.Model
idAttribute: '_id'
urlRoot: -> '/user/currentuser/'

# classic Rails RESTful resource

class Workshop.Models.User extends Backbone.Model
urlRoot: '/users/show' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T21:38:51.963

在您的要点中，您有以下代码

```
current_user = new Workshop.Models.Currentuser
current_user.fetch()
console.log(current_user.id) 
```

但是， fetch 是异步的，并且`id`在 ajax 调用完成之前不会被填写。

试试这个（道歉，因为我的 ruby​​ 技能为零，而且我的咖啡脚本也不是很好，所以不能保证语法）

`current_user.fetch({ success: -> console.log(current_user.id) });`

# linux - Linux shell 脚本：使用当前日期名称创建一个文件夹

> ID：13731463
> 
> 赞同：6
> 
> 时间：2012-12-05T20:04:02.043
> 
> 标签：linux, bash, shell

我正在尝试制作一个简单的备份脚本，但在创建名称为当前日期的文件夹时遇到问题

我的脚本就是这样，基本上问题出在最后一行

```
drivers=$(ls /media/)

declare -i c=0
for word in $drivers
do
    echo "($c)$word"
    c=c+1
done

read -n 1 drive
echo

c=0
for word in $drivers
do
    if [ $c -eq $drive ]
    then
        backuppath="/media/$word/backup"
    fi
    c=c+1
done

echo "doing back up to $backuppath"

cp -r /home/stefanos/Programming $backuppath/$(date +%Y-%m-%d-%T) 
```

输出：

```
(0)0362-BA96
(1)Data
(2)Windows
0
doing back up to /media/0362-BA96/backup
cp: cannot create directory `/media/0362-BA96/backup/2012-12-05-21:58:37': Invalid argument 
```

在 /media/0362-BA96/ 之前存在的路径经过三次检查

**已解决： janisz**所说的最终脚本看起来像吗

```
drivers=$(ls /media/)

declare -i c=0
for word in $drivers
do
    echo "($c)$word"
    c=c+1
done

read -n 1 drive
echo

c=0
for word in $drivers
do
    if [ $c -eq $drive ]
    then
        backuppath="/media/$word/backup"
    fi
    c=c+1
done
echo "doing back up to $backuppath"

backup(){
  time_stamp=$(date +%Y_%m_%d_%H_%M_%S)
  mkdir -p "${backuppath}/${time_stamp}$1"
  cp -r "${1}" "${backuppath}/${time_stamp}$1"

  echo "backup complete in $1"
}

#####################The paths to backup####################

backup "/home/stefanos/Programming"
backup "/home/stefanos/Android/Projects"
backup "/home/stefanos/Dropbox" 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-05T20:09:06.243

尝试将其更改为：

```
time_stamp=$(date +%Y-%m-%d-%T)
mkdir -p "${backuppath}/${time_stamp}"
cp -r /home/stefanos/Programming "${backuppath}/${time_stamp}" 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-12-05T20:55:08.860

`:`在 FAT 上无效（用于指定磁盘）。一些 M$ 无效字符适用于 GNU/Linux 系统，但避免它们更安全（只需替换为`.`）。使用以下日期格式

```
date +%Y_%m_%d_%H_%M_%S 
```

它应该适用于大多数文件系统，但对于 MS DOS FAT 来说可能太长了。[您可以在此处](http://en.wikipedia.org/wiki/Filename)找到更多信息。

# emacs - How do I access the result of eval-buffer?

> ID：13731470
> 
> 赞同：3
> 
> 时间：2012-12-05T20:04:26.293
> 
> 标签：emacs

Two questions:

1.  Where does the result of `eval-buffer` get stored? How do I access it?
    For example:

    ```
    (+ 2 2) 
    ```

2.  Functions like `(forward-word)` are executed by `eval-buffer`, but do not move the cursor? Why is that?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-05T20:17:57.800

1.  `eval-buffer` is usually used for side-effects, rather than return value. For example, in your .emacs file, `eval-buffer` will re-load all our config settings. By default, and when used interactively, it will always return `nil`. If you want to get the return value of code in a buffer, this is the wrong way to do it. `eval-last-sexp`, bound to `C-x C-e`, is one way to do so. Calling it with a prefix, `C-u C-x C-e` will insert the return value into the current buffer.

2.  `eval-buffer` preserves the value of point. So functions like `forward-word` will have no visible effect.

# java - 按钮导致致命异常：main，以及如何插入“$”

> ID：13731471
> 
> 赞同：1
> 
> 时间：2012-12-05T20:04:37.183
> 
> 标签：java, android

我正在编写一个气体计算器，它有两个输出（总气体成本和总加仑数）；我怎样才能在前面加上“$”`totalCost`而不是前面`totalGas`？

此外，当我在模拟器中运行程序时，当我单击重置按钮时，它会强制关闭程序并出现`FATAL EXCEPTION: main`错误。

编辑：我想通了。我忘记在重置按钮上导入 myClickHandler。

这是java文件：

```
package com.example.gas;
import java.text.DecimalFormat;
import java.text.NumberFormat;
import com.example.gas.R;
import android.os.Bundle;
import android.app.Activity;
import android.view.View;
import android.widget.EditText;
import android.widget.TextView;

public class MainActivity extends Activity 
{

    private EditText totalMiles;
    private EditText price;
    private EditText mpg;
    private TextView totalGas;
    private TextView totalCost;

    @Override
    protected void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        totalMiles = (EditText) findViewById(R.id.milesTxt);
        totalCost = (EditText) findViewById(R.id.costTxt);
        totalGas = (EditText) findViewById(R.id.gasTxt);
        price = (EditText) findViewById(R.id.priceTxt);
        mpg = (EditText) findViewById(R.id.mpgTxt);
    }

    public void myClickHandler(View view)
    {
        NumberFormat nf = new DecimalFormat("#,###.00");
        switch (view.getId())
        {
            case R.id.calcBtn:
                float inputMiles = Float.parseFloat(totalMiles.getText().toString());
                float inputMPG = Float.parseFloat(mpg.getText().toString());
                float inputPrice = Float.parseFloat(price.getText().toString());
                float result1 = inputMiles/inputMPG;
                String output1 = nf.format(result1);
                totalGas.setText(output1);
                float result = result1 * inputPrice;
                String output = nf.format(result);
                totalCost.setText(output);
                break;

            case R.id.resetBtn:
                totalMiles.setText("");
                totalCost.setText("");
                totalGas.setText("");
                price.setText("");
                mpg.setText("");
                break;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:07:47.690

您应该将其预先附加到 String 变量：

```
totalCost.setText(output); 
```

至

```
totalCost.setText("$"+output); 
```

# android - 最专业的编辑 EditText 边框的方法

> ID：13731475
> 
> 赞同：0
> 
> 时间：2012-12-05T20:04:53.413
> 
> 标签：android

简单地说，我想更改 EditText 的边框。

我不知道我是否可以通过放置 /res/drawable/editborders.xml 之类的东西来做到这一点

```
<item>
    <shape android:shape="rectangle" >
        <corners
            android:bottomLeftRadius="2dp"
            android:bottomRightRadius="2dp"
            android:topLeftRadius="2dp"
            android:topRightRadius="2dp" />

        <stroke
            android:width="2dp"
            android:color="#8b3732" />

        <solid android:color="#ff000000" />
    </shape>
</item> 
```

请不要说上面的代码只是我尝试的一个例子。

我希望边框更像是渐变而不是简单的颜色。例如：

![在此处输入图像描述](../Images/4a303dd164cb6abfbacec09eb30196ff.png)

如果我们仔细观察，我们会注意到一个渐变：

![在此处输入图像描述](../Images/6bc1bbb44274ac4f8283559c6f34d56c.png)

这就是我想要的方式，专业的方式，任何专家都可以解决我的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:06:48.017

您可以使用 9-patch 图像作为`EditText`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:44:56.683

您可以使用渐变来实现类似的效果：

```
<gradient
android:angle="270"
android:startColor="#67e203"
android:centerColor="#51b500"
android:endColor="#59c601"
android:type="linear"
/> 
```

希望能帮助到你。

# c# - C#如何调整图像大小并以尽可能高的质量保存它们 - 批处理作业

> ID：13731483
> 
> 赞同：2
> 
> 时间：2012-12-05T20:05:52.283
> 
> 标签：c#, image, c#-4.0, resize

> **可能重复：**
> [如何调整图像大小并保存在文件夹中？](https://stackoverflow.com/questions/11375187/how-to-resize-image-and-save-in-folder)

我想调整大小并保存为给定文件夹中的图像。但我想以尽可能高的质量做到这一点。我愿意使用第三方软件。

像paint.net 或photoshop。

那么实现这一目标的最佳方法是什么？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:55:22.433

免责声明：以下链接/代码来自我的博客：

你应该看看我网站上的这篇文章[http://samuelhaddad.com/2011/01/26/net-high-quality-thumbnail-generation/](http://samuelhaddad.com/2011/01/26/net-high-quality-thumbnail-generation/)

帖子中的代码如下所示：

```
//Image Resize Helper Method
private static Bitmap ResizeImage(String filename, int maxWidth, int maxHeight)
{
    using (Image originalImage = Image.FromFile(filename))
    {
        //Caluate new Size
        int newWidth = originalImage.Width;
        int newHeight = originalImage.Height;
        double aspectRatio = (double)originalImage.Width / (double)originalImage.Height;
        if (aspectRatio <= 1 && originalImage.Width > maxWidth)
        {
            newWidth = maxWidth;
            newHeight = (int)Math.Round(newWidth / aspectRatio);
        }
        else if (aspectRatio > 1 && originalImage.Height > maxHeight)
        {
            newHeight = maxHeight;
            newWidth = (int)Math.Round(newHeight * aspectRatio);
        }
        Bitmap newImage = new Bitmap(newWidth, newHeight);
        using (Graphics g = Graphics.FromImage(newImage))
        {
            //--Quality Settings Adjust to fit your application
            g.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.HighQualityBilinear;
            g.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.HighQuality;
            g.PixelOffsetMode = System.Drawing.Drawing2D.PixelOffsetMode.HighQuality;
            g.CompositingQuality = System.Drawing.Drawing2D.CompositingQuality.HighQuality;
            g.DrawImage(originalImage, 0, 0, newImage.Width, newImage.Height);
            return newImage;
        }
    }
} 
```

您可以将其包装在 for 循环中以进行批处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T22:35:04.400

**编辑：**实际上，为了更好地介绍和描述我在下面讨论的信息类型，请参阅[这个库](http://www.codeproject.com/Articles/11143/Image-Resizing-outperform-GDI)和[这篇文章](http://www.codinghorror.com/blog/2007/07/better-image-resizing.html)。

但我也想[大多数图像库](https://stackoverflow.com/questions/885186/image-library-software)都有可用的 lanczos。我使用过[FreeImage](http://freeimage.sourceforge.net/)，它似乎有一个非常不错的 C# 包装器。

* * *

质量主要与使用的插值算法和调整大小的比率有关。在 Paint.net 和 Photoshop 中，它们有一个下拉菜单可供选择。每种算法在它最擅长的方面会有所不同（缩小规模、扩大规模、按整数比例调整大小......）并且每种算法都有不同的速度。Paint.net 也有“最佳质量”选项，它会告诉你它决定使用什么（虽然我不确定超级采样指的是什么......），用你的一些图像和目标大小手动执行此操作看看它使用什么可能会帮助您选择更快的算法。

@SamPlusPlus 的答案使用 HighQualityBilinear，IIRC 非常适合调整大小和添加少量模糊（因此算法会消除锐利的线条），其中 Bicubic 将保留更多的线条清晰度。所以在这两者中，双线性通常更适合升迁，而双三次通常更适合缩小规模。

我相信[Lanczos](http://en.wikipedia.org/wiki/Lanczos_resampling)算法是最好的全能算法之一（在任何规模的扩大或缩小方面都非常好），但也是速度较慢的算法之一。如果您将图像缩小 7%（100:93 的比例很难缩小），我强烈建议您这样做。

如果你做 50%、25%、200% 等，所有的算法都会得到非常相似的结果，唯一的区别是速度。

如果输入或输出文件的大小变化很大，我建议寻找一个具有 Lanczos 调整大小算法的库，因为无论调整大小的类型如何，它都非常好，而且因为你没有提到速度是重要，只有质量。我没有在 C# 中使用过这样的库，所以我没有任何直接的建议。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-05T21:04:18.203

你应该看看颜色量化。我为此实现了一个库，并且效果很好。进行搜索，您应该会找到很多。今天晚些时候我可能会发布一些代码。

[.NET 中的彩色图像量化](https://stackoverflow.com/questions/6623077/color-image-quantization-in-net)

[C# 中的简单调色板量化器](http://www.codeproject.com/Articles/66341/A-Simple-Yet-Quite-Powerful-Palette-Quantizer-in-C)

[http://msdn.microsoft.com/en-us/library/aa479306.aspx](http://msdn.microsoft.com/en-us/library/aa479306.aspx)

# image - matlab中的图像对齐

> ID：13731485
> 
> 赞同：1
> 
> 时间：2012-12-05T20:06:10.287
> 
> 标签：image, image-processing, alignment, matlab

我正在尝试在 matlab 中对齐多个图像，但我无法让 matlab 正确对齐它们。我想对齐它们，以便我可以通过将它们拼接/平均在一起来叠加它们以制作更大的图像。[我在这里](http://imageshack.us/g/1/9903605/)张贴了几张图片。虽然手动对齐 5 个图像并不难，但我想制作一个脚本来完成它，这样我也不需要手动对齐数百个相似的图像。

在过去的几天里，我尝试了几种方法来让它工作。我的想法是，如果我可以对图像进行足够的过滤，那么我可以为字母制作一个蒙版，然后将它们对齐就很容易了——但我无法让它发挥作用。

我尝试使用局部自适应阈值来补偿图片中不均匀的亮度级别，但它不允许我正确对齐它们。对于实际的图像对齐，我一直在使用 imregister() 和 normxcorr2() 但两者都没有正确对齐图像。

我不认为这应该是那么难做到，但我一直没能做到。任何想法或见解将不胜感激。

* * *

[编辑：在此处](http://imageshack.us/g/1/9905169/)执行各种操作后上传的图像

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T06:54:30.600

我会做一些特征检测，然后是 RANSAC 算法来找到任何一对图像之间的转换。

请在 Mathworks 网站上查看此演示：http: [//www.mathworks.com/videos/feature-detection-extraction-and-matching-with-ransac-73589.html](http://www.mathworks.com/videos/feature-detection-extraction-and-matching-with-ransac-73589.html)

# c# - C# - Application.EnableVisualStyles()

> ID：13731487
> 
> 赞同：3
> 
> 时间：2012-12-05T20:06:26.930
> 
> 标签：c#, visual-studio-2010

一旦`Application.EnableVisualStyles()`在 Visual Studio 2010 (C#) 中使用，是否可以禁用然后重新启用？

我喜欢它在某些地方的外观，但在其他地方不喜欢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:09:51.950

不会。通常，您在应用程序启动时调用一次（在 Main 方法中），然后为应用程序打开它。你不能再把它关掉。

但是，您可以选择不将它们用于某些表单 - 使用`VisualStyleState`- [http://msdn.microsoft.com/en-us/library/system.windows.forms.application.visualstylestate.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.visualstylestate.aspx)

# java - logstash 启动问题

> ID：13731496
> 
> 赞同：2
> 
> 时间：2012-12-05T20:07:03.307
> 
> 标签：java, linux, logstash

我正在阅读[http://cookbook.logstash.net/recipes/faster-startup-time/](http://cookbook.logstash.net/recipes/faster-startup-time/)

我确实解压缩了 jar 并尝试运行，但我不知道我做错了什么？

```
#unzip logstash-1.1.5-monolithic.jar -d  dest_dir
#java -jar -cp /past/to/extracted/logstash/dest_dir logstash.runner agent -f /path/to/logstash/config.conf -- web --backend elasticsearch:///?local
Unable to access jarfile logstash.runner 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T16:16:20.633

现在可以通过使用 flatjar 来实现更快的启动时间。这个 jar 以不同的方式打包 logstash，这样 ruby​​ 在启动时不必扫描这么多路径，从而减少启动时间。这比解压缩 jar 更容易，并且在启动时间上相当。

[使用 FlatJar](http://cookbook.logstash.net/recipes/faster-startup-time/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-22T17:53:06.777

如果您使用嵌入式“网络”模式，您可能会遇到此问题 - [https://logstash.jira.com/browse/LOGSTASH-1316?focusedCommentId=20134&page=com.atlassian.jira.plugin.system.issuetabpanels：评论标签面板#comment-20134](https://logstash.jira.com/browse/LOGSTASH-1316?focusedCommentId=20134&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-20134)

# ms-office - 在 PowerPoint 2010 中嵌入视频不起作用

> ID：13731497
> 
> 赞同：-1
> 
> 时间：2012-12-05T20:07:04.257
> 
> 标签：ms-office, embed, powerpoint

我正在尝试在 powerpoint 2010 中嵌入一个视频，以便在我看到那张幻灯片时自动播放（理想）。

或者......如果这不起作用，我想将演示文稿中的图像超链接到视频......当我点击它时，它会自动播放（意思是，我不必点击播放按钮） .

我遵循了本教程： http: [//www.howtogeek.com/howto/10552/how-to-add-video-from-the-web-in-powerpoint-2010/](http://www.howtogeek.com/howto/10552/how-to-add-video-from-the-web-in-powerpoint-2010/)

在 vimeo 上，我将提供的 iFrame 代码复制并粘贴到我的演示文稿中：

```
<iframe src="http://player.vimeo.com/video/20241459?badge=0" width="500" height="375" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe> 

<p><a href="http://vimeo.com/20241459">Rick Astley - Never gonna give you up</a> from <a href="http://vimeo.com/zunebock">zunebock</a> on <a href="http://vimeo.com">Vimeo</a>.</p> 
```

但它抛出了这个错误......我不明白这是怎么可能的，因为我复制并粘贴了嵌入代码。

```
Powerpoint cannot insert video from this embed code. Verify that the embed code is correct, and then try again. 
```

这是一张图片：

![在此处输入图像描述](../Images/b23e9b3b904f1209a0cf8f87b9fcdc15.png) **所以，重申我的问题：**

1) 为什么 powerpoint 不接受给定的嵌入代码？

2）如果它不起作用......如何在页面加载时自动启动 vimeo 视频？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T02:36:41.720

Vimeo 的代码使用了一个 iframe，这是行不通的；它有点希望您在浏览器中播放视频，而不是 PPT。它甚至在嵌入代码下方的网站上提到它适用于 iphone 等。

如果您改用 YouTube，PPT 的帮助指出您需要使用 Old Embed code 选项，它会为您提供如下内容：

```
<object width="420" height="315"><param name="movie" value="http://www.youtube.com/v/Q7vsoVR5NX4?version=3&amp;hl=en_US"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/Q7vsoVR5NX4?version=3&amp;hl=en_US" type="application/x-shockwave-flash" width="420" height="315" allowscriptaccess="always" allowfullscreen="true"></embed></object> 
```

下一个问题：视频不会自动播放，因为它是一个对象（即PPT除了让它做任何它要做的事情之外不知道的“东西”），你不能强迫它播放（除了可能有代码）。

最后，托管视频的网站可能会限制您在 PPT 中播放视频的能力。我尝试了几个 YouTube 视频来测试这个；由于版权限制，两者都不会在 ppt 中播放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-02T06:31:29.253

为了避免此错误，推荐的解决方案是在 PowerPoint 中嵌入下载的 YouTube 视频。

[下面的这篇文章只是为了介绍一个专业的 YouTube 到 PowerPoint 转换器，以及如何下载 YouTube 并将其转换为 PowerPoint](http://mostraining.com/how-to-insert-a-youtube-video-into-powerpoint-2010/)支持的格式以成功地将 YouTube 嵌入 PowerPoint 以便于播放的分步指南。

# servlets - glassfish 中的 Cometd servlet 正在返回意外响应 302

> ID：13731498
> 
> 赞同：0
> 
> 时间：2012-12-05T20:07:05.007
> 
> 标签：servlets, push, cometd

我是使用 cometd 的新手，我正在尝试使用它在我的 Web 应用程序中启用推送消息。在使用 jetty 8 成功测试后，我尝试将 cometd 直接插入我的 Web 应用程序，因此我以这种方式更改了我的 web.xml：

```
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xmlns="http://java.sun.com/xml/ns/javaee"
     xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
     id="erp-hm" version="3.0">
<display-name>ERP HM</display-name>
<welcome-file-list>
    <welcome-file>inicio.xhtml</welcome-file>
</welcome-file-list>
<servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>2</load-on-startup>
</servlet>
<servlet>
    <servlet-name>Logout Servlet</servlet-name>
    <servlet-class>com.hrgi.web.seguranca.ControladorLogout</servlet-class>
    <load-on-startup>3</load-on-startup>
</servlet>
<servlet>
    <servlet-name>push</servlet-name>
    <servlet-class>org.cometd.server.CometdServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
    <async-supported>true</async-supported>
</servlet>
<servlet>
    <servlet-name>Download Servlet</servlet-name>
    <servlet-class>com.hrgi.web.erp.DownloadArquivoServlet</servlet-class>
    <load-on-startup>4</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>Logout Servlet</servlet-name>
    <url-pattern>/j_spring_security_logout</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>push</servlet-name>
    <url-pattern>/push/*</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>Download Servlet</servlet-name>
    <url-pattern>*.pdf</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping>
<context-param>
    <param-name>com.sun.faces.expressionFactory</param-name>
    <param-value>com.sun.el.ExpressionFactoryImpl</param-value>
</context-param>
<context-param>
    <param-name>com.sun.faces.enableMissingResourceLibraryDetection</param-name>
    <param-value>true</param-value>
</context-param>
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/spring/appContext.xml</param-value>
</context-param>
<context-param>
    <description>State saving method: 'client' or 'server' (=default). See JSF Specification 2.5.2</description>
    <param-name>javax.faces.STATE_SAVING_METHOD</param-name>
    <param-value>server</param-value>
</context-param>
<context-param>
    <param-name>javax.servlet.jsp.jstl.fmt.localizationContext</param-name>
    <param-value>resources.application</param-value>
</context-param>
<context-param>
    <param-name>javax.faces.PROJECT_STAGE</param-name>
    <param-value>Production</param-value>
</context-param>
<context-param>
    <param-name>javax.faces.FACELETS_SKIP_COMMENTS</param-name>
    <param-value>true</param-value>
</context-param>
<context-param>
    <param-name>javax.faces.VALIDATE_EMPTY_FIELDS</param-name>
    <param-value>false</param-value>
</context-param>
<context-param>
    <param-name>javax.faces.DEFAULT_SUFFIX</param-name>
    <param-value>.xhtml</param-value>
</context-param>
<context-param>
    <param-name>org.apache.myfaces.ERROR_HANDLING</param-name>
    <param-value>true</param-value>
</context-param>
<context-param>
    <param-name>javax.faces.PARTIAL_STATE_SAVING</param-name>
    <param-value>true</param-value>
</context-param>
<context-param>
    <param-name>javax.faces.FULL_STATE_SAVING_VIEW_IDS</param-name>
    <param-value>/inicio.xhtml</param-value>
</context-param>
<listener>
    <listener-class>com.hrgi.web.erp.DataServletContextListener</listener-class>
</listener>
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>
<listener>
    <listener-class>org.springframework.web.context.request.RequestContextListener</listener-class>
</listener>
<listener>
    <listener-class>org.springframework.security.web.session.HttpSessionEventPublisher</listener-class>
</listener>
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    <async-supported>true</async-supported>
</filter>
<filter>
    <filter-name>filtroLimpadorCache</filter-name>
    <filter-class>com.hrgi.web.seguranca.FiltroLimpadorCache</filter-class>
    <async-supported>true</async-supported>
</filter>
<filter-mapping>
    <filter-name>filtroLimpadorCache</filter-name>
    <url-pattern>/login*</url-pattern>
    <dispatcher>FORWARD</dispatcher>
    <dispatcher>REQUEST</dispatcher>
</filter-mapping>
<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>FORWARD</dispatcher>
    <dispatcher>REQUEST</dispatcher>
</filter-mapping>
<error-page>
    <error-code>403</error-code>
    <location>/acesso_negado.xhtml</location>
</error-page>
<error-page>
    <error-code>404</error-code>
    <location>/endereco_invalido.xhtml</location>
</error-page>
<session-config>
    <session-timeout>600</session-timeout>
</session-config>
</web-app> 
```

javascript 客户端第一次尝试连接时出现 400 错误：

```
jQuery(document).ready(function ($) {
cometd = $.cometd;
cometd.configure('https://localhost:8181/erp-web/push/');   
cometd.handshake();
}); 
```

当 java 客户端尝试在频道中发布时，我得到了这个：

```
[#|2012-12-05T19:54:35.543+0000|INFO|oracle-glassfish3.1.2|javax.enterprise.system.std.com.sun.enterprise.server.logging|_ThreadID=122;_ThreadName=Thread-8;|05/12/2012 - 19:54:35 [HttpClient-122] INFO org.cometd.client.BayeuxClient.2002219263 - Messages failed [{id=12, supportedConnectionTypes=[long-polling], channel=/meta/handshake, version=1.0}]
java.net.ProtocolException: Unexpected response 302: TransportExchange@5f331f10=POST//localhost:8181/erp-web/push/handshake#CONTENT(1ms)->COMPLETED(0ms)sent=22ms
at org.cometd.client.BayeuxClient$PublishTransportListener.onProtocolError(BayeuxClient.java:1161)
at org.cometd.client.transport.LongPollingTransport$TransportExchange.onResponseComplete(LongPollingTransport.java:324)
at org.eclipse.jetty.client.HttpExchange$Listener.onResponseComplete(HttpExchange.java:1158)
at org.eclipse.jetty.client.HttpExchange.setStatus(HttpExchange.java:305)
at org.eclipse.jetty.client.AbstractHttpConnection$Handler.messageComplete(AbstractHttpConnection.java:337)
at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:861)
at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:240)
at org.eclipse.jetty.client.AsyncHttpConnection.handle(AsyncHttpConnection.java:133)
at org.eclipse.jetty.io.nio.SslConnection.handle(SslConnection.java:196)
at org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:628)
at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:52)
at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608)
at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543)
at java.lang.Thread.run(Thread.java:722)
|#] 
```

有什么我可以解决的吗？或者我应该使用jetty来实现cometd服务器？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T22:39:42.927

对于 JS 客户端问题，我怀疑您应该在客户端禁用 WebSocket，因为 Glassfish 不支持 WebSocket，而 CometD 仅适用于 Jetty 的 WebSocket 实现。请参阅[此处](http://docs.cometd.org/reference/#javascript_transports)了解如何配置 JS 客户端 WebSocket 传输。

对于 Java 客户端问题，如果您得到 302 可能是因为您用于配置的`BayeuxClient`URL 不是 CometD URL。CometD servlet 从不回复 302，因此您一定打错了 URL。

# iphone - 在 Sprint 3G 网络上剥离的 Content-Length http 标头

> ID：13731499
> 
> 赞同：1
> 
> 时间：2012-12-05T20:07:10.497
> 
> 标签：iphone, ios, wcf, iis, 3g

我有一个正在与之通信的服务器，当我通过 WiFi 或 Web 浏览器连接我的 iPhone 4S 时，我在响应中得到一个 Content-Length 标头。如果我在 iPhone 4S 上禁用 WiFi 并使用我的 Sprint 3G 连接，则响应中的 Content-Length 标头丢失。

服务器在 IIS 7.5 下运行 WCF ...

有谁知道为什么会发生这种情况？

# objective-c - 如何在主线程外渲染 MKMapView？

> ID：13731502
> 
> 赞同：5
> 
> 时间：2012-12-05T20:07:21.590
> 
> 标签：objective-c, ios, performance, mkmapview

大家好！

我正在为 iPhone 开发应用程序。我有需要向用户显示的表格视图和位置列表。为此，我在每个表格视图单元格中使用了 MKMapView。但是当有很多位置时，这个解决方案变得非常慢。我想提高 UI 性能并将 MKMapView 替换为 UIImageView。所以我需要在一些非主线程中将地图从 MKMapView 渲染到 UIImage 。我试着这样做：

```
UIGraphicsBeginImageContext(CGSizeMake(64, 64));
CGContextRef context = UIGraphicsGetCurrentContext();
[[mapView layer] renderInContext:context];
thumbnail_image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

但是此代码仅呈现地图的黄色背景和指定位置上方的图钉。没有街道、房屋等地图数据。我做错了什么？谢谢你的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T01:43:27.120

您没有获得任何地图数据的原因是您没有等待地图数据加载。等到地图视图的`mapViewDidFinishLoadingMap:`委托方法被调用，然后拍照。在调用委托方法后，您可能需要在一小段延迟（一两秒）后拍照，因为我发现有时委托方法调用得有点早，正如我在[这个问题](https://stackoverflow.com/questions/12700011/mapviewdidfinishloadingmap-called-too-early)中提到的那样。

```
- (void)mapViewDidFinishLoadingMap:(MKMapView*)mapView {
    double delayInSeconds = 2.0;
    dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, delayInSeconds * NSEC_PER_SEC);
    dispatch_after(popTime, dispatch_get_main_queue(), ^(void){
        UIGraphicsBeginImageContext(CGSizeMake(64, 64));
        CGContextRef context = UIGraphicsGetCurrentContext();
        [mapView.layer renderInContext:context];
        thumbnail_image = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();
    });
} 
```

注意：您需要将地图视图的尺寸设置为方形，这样当您将其渲染为方形图像时，它不会被尴尬地拉伸。

# ide - 有没有办法显示程序的“目录”？

> ID：13731504
> 
> 赞同：0
> 
> 时间：2012-12-05T20:07:38.640
> 
> 标签：ide, organization, performance

对于一个运行数千行的程序，如果有某种方法可以在旁边放一个“目录”，即程序的（用户定义的）“章节”的列表，那将会很有帮助。

例如，Adobe Acrobat Pro 可以弹出一个目录侧边栏，您可以在其中来回浏览一本书，同时仍然可以查看该书的页面。

不过，我意识到划分代码很重要，而不是将所有内容都放在一个大文件中。但我仍在寻找一些目录/章节系统。

除了代码内分段之外，是否还有类似的东西，例如注释各种代码段然后展开/折叠段？并不是说这种方法有什么问题；它仍然需要向上/向下/围绕实际文件本身滚动，而不是单独的列表。

它不必严格地是“目录”——它可以是某种类型的代码图、概述或布局——只是程序部分/片段的一些视觉概述，两者都是为了快速跳转到各个部分，而且还能够看到程序到目前为止的概览的好处。

编辑：

我目前专注于 PHP、Python 和 Java 编程。任何针对其中任何一个的 IDE 建议都会有所帮助——我不一定要寻找适合所有人的（我猜 Visual Studio 中的一些技巧将是最可能的解决方案）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:10:07.307

我发现使用 Visual Studio 中的区域可以快速组织代码并找到我要查找的内容。使用 C#，您也可以在区域内嵌套区域。

```
#region Something Cool

#region Alpha code
#endregion

#region Beta Code
#endregion

#endregion 
```

您没有提及您使用的是哪个 IDE，但这可能对您有用。

# jquery - 如何使用 jquery 和 css :not() 选择器定位除一个标签之外的所有标签

> ID：13731508
> 
> 赞同：2
> 
> 时间：2012-12-05T20:08:02.730
> 
> 标签：jquery, jquery-selectors

我想捕获所有点击事件，除非它们是在 a-tag 上完成的。

我建立这个小提琴来显示我的问题：http: [//jsfiddle.net/vwyFg/7/](http://jsfiddle.net/vwyFg/7/)

为什么这不起作用？

```
$('.three').on('click',':not(a)',function(e){
    $('body').append('<b>i did not click on a a-tag!</b><br>');
    e.preventDefault();
    e.stopPropagation();
}); 
```

html:

```
<div class="wrap three">
    <div class="wrap two">
        <div class="wrap one">
            <a href="javascript:$('body').append('i DID click on a a-tag!!<br>');;return false;">klick me!</a>
        </div>
    </div>
</div>​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:16:16.440

您需要检查点击事件的来源：

```
$('div.three').on('click',function(e){    
    if (e.target.tagName.toLowerCase() == 'a') return;
    $('body').append('<b>i did not click on a a-tag!</b><br>');
    e.preventDefault();
    e.stopPropagation();
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T20:11:33.603

将您的代码更改为此，注意 :not -

```
$('.three:not(a)').on('click',function(e){
    $('body').append('<b>i did not click on a a-tag!</b><br>');
    e.preventDefault();
    e.stopPropagation();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T20:17:18.967

我添加了这段代码：

```
$(".three a").click(function(e) {
    e.stopPropagation();
});​ 
```

看这里：[JSFiddle](http://jsfiddle.net/h89dc/1/)

# c# - 尽管订阅了事件，如何让对象/控件被 GC

> ID：13731509
> 
> 赞同：2
> 
> 时间：2012-12-05T20:08:06.540
> 
> 标签：c#, .net, winforms

我有订阅自定义事件的对象，因此我可以一次更改它们。麻烦的是，这永远不会让它们超出范围并被垃圾收集。即使使控件为空也不会使其中包含的控件为空。事实上，即使是无效的控件也不会被收集！（如果我在任何一点上错了，请纠正我。）

所以我想到了一个解决方案，将事件包装在一个类中，创建该类的一个实例并使用它，然后在我想让对象获得 GC 时将其设为空，并创建它的一个新实例接着说。

但是，我对此有两个问题：

1.  它会真正起作用，还是对象仍然会逃避被 GC 处理？
2.  有没有更简单、更直接的方法来实现这一点？

编辑：第 2 部分已得到回答（在对答案的评论中）。简单地做：`event_name = null;`。不过，我仍然想知道关于第 1 部分 - 它会起作用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:10:53.293

您需要取消订阅您的活动。这就像订阅一样工作，但使用`-=`运算符而不是`+=`.

例子：

```
foo.SomeEvent-= new EventHandler(foo_SomeEvent); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T11:37:25.903

第 2 部分的答案（根据 Servy 的评论）：

```
event_name = null; 
```

# sql - sql 查找存在一种类型的记录但另一种类型不存在的匹配项

> ID：13731511
> 
> 赞同：0
> 
> 时间：2012-12-05T20:08:09.893
> 
> 标签：sql, join

我有以下（精简架构） - 3 个表 - 用户、作业、作业类型

```
TABLE: job_type
COLUMN: job_type_id
1           
2

TABLE: user
COLUMN: user_id
101
102
103

TABLE: job
COLUMNS: job_id | user_id | job_type_id
              4 |     101 |           1
              5 |     101 |           2
              6 |     102 |           1
              7 |     103 |           2 
```

我想编写一个查询，返回所有在 job_type_id = 1 的工作表中有工作的用户，但如果他们也有 job_type_id = 2 的工作，则将它们从结果中排除。因此，目标结果集应该只返回用户 102。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:11:24.200

```
select *
  from user u
 where exists (select * from job j
                where j.user_id=u.user_id
                  and j.job_type_id=1)
   and not exists (select * from job j
                    where j.user_id=u.user_id
                      and j.job_type_id=2) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T20:14:07.697

您还没有说明您正在使用什么 DBMS，但这里有一些几乎可以在任何情况下使用的查询：

```
SELECT DISTINCT user_id
  FROM job j1
 WHERE job_type_id = 1
   AND NOT EXISTS
        ( SELECT 1
            FROM job j2
           WHERE job_type_id = 2
             AND j2.user_id = j1.user_id
        )
;

SELECT DISTINCT user_id
  FROM job
 WHERE job_type_id = 1
   AND user_id NOT IN
        ( SELECT DISTINCT user_id
            FROM job
           WHERE job_type_id = 2
        )
;

SELECT DISTINCT j1.user_id
  FROM job j1
  LEFT
 OUTER
  JOIN job j2
    ON j1.user_id = j2.user_id
   AND j1.job_type_id = 1
   AND j2.job_type_id = 2
 WHERE j2.user_id IS NULL
; 
```

一些 DBMS 还提供您可以使用的特殊`MINUS`功能`EXCEPT`。看起来像这样：

```
SELECT user_id
  FROM job
 WHERE job_type_id = 1
MINUS                          -- or EXCEPT
SELECT user_id
  FROM job
 WHERE job_type_id = 2
; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T20:14:39.900

尝试：

```
Select * from
user U inner join Job J
on 
  J.user_id = U.user_id
inner join job_type T
on 
  T.job_type_id = 1
Where 
T.job_type_id <> 2 
```

# mysql - 本地连接时不允许主机连接到这个mysql服务器

> ID：13731514
> 
> 赞同：8
> 
> 时间：2012-12-05T20:08:22.153
> 
> 标签：mysql, database, putty

当我尝试连接腻子时，我得到“不允许主机连接到这个 mysql 服务器”。为什么会这样？主机和客户端在我的机器上。

当我连接命令行时，它会连接。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-12-05T20:43:01.923

您需要更改配置的设置方式。

注释掉 MySQL 配置中的 skip-networking 部分：`# skip-networking`如果有`skip-networking`，它将丢弃任何 TCP/IP 连接，这可能是您失败的原因。

启用 TCP/IP 连接后，您需要授予用户从其他计算机连接的权限：

`GRANT ALL PRIVILEGES ON *.* TO <username>@'%' IDENTIFIED BY '<password>';`

这将使用户名使用适当的密码从任何机器连接到您的数据库。

# html - 如何强制表格仅在单元格内显示 1 行数据

> ID：13731515
> 
> 赞同：1
> 
> 时间：2012-12-05T20:08:23.027
> 
> 标签：html, css, html-table

[http://jsbin.com/ebiteh/3/edit](http://jsbin.com/ebiteh/3/edit)

 `我希望该表仅显示第一行数据，因此例如单元格应显示为：“hi”、“in”、“this is a really”、“another cell”。我发现这里 24px 的高度是合适的。如何强制表格的行只有 24px 高？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:14:03.063

`overflow`不适用于`td`. 您可以将文本包装`td`在 a 中`div`并将高度应用`overflow`到a 中`div`。`

# sitecore - 如何本地化 Sitecore 中菜单项的名称？

> ID：13731518
> 
> 赞同：0
> 
> 时间：2012-12-05T20:08:37.677
> 
> 标签：sitecore, sitecore6

我正在为 Sitecore 网站创建本地化版本（西班牙语和中文）。原始语言是英语。我已经学会了如何创建我的特定语言版本的页面。但我不知道如何更改导航项本身的名称。例如，当我预览我的西班牙语页面 (http://content.example.com/?sc_lang=es) 时，页面内容是西班牙语，但导航项本身（例如主页、关于、产品等）仍然是英文的。我在内容编辑器或页面编辑器中的什么地方解决了这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:32:32.147

您需要修改主页功能区中项目的“显示名称”。请注意，这也会影响所选语言的项目 url。

**编辑：**也许我的回答太快了，我可能过度阅读了一些内容，因为我的建议更改了 Url（如果您有设置“useDisplayName = true”，如 jammykam 更正）和特定语言的内容树中的项目名称.

如果您在导航中显示的名称基于项目名称，那么可以按照我的建议进行操作，将显示项目的名称更改为当前语言，并使代码查看显示名称而不是项目名称。

另一种选择是为菜单标题使用单独的字段，以防您希望您的标题与您的 url 不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T21:54:00.697

当您说导航项本身仍然是英文时，您是什么意思？就像在页面顶部运行的菜单一样？

如果是这样，那么您需要确定这些项目在内容树中的位置，然后添加相关语言版本/翻译，并确保它们不是“共享”内容。

@Martijn，我相信它只会影响 URL，是您在 config.linkManager 设置中设置“useDisplayName=true”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T20:55:14.460

我们通常在基本内容模板中添加一个名为 MenuTitle 的字段，然后指示我们的导航控件从该字段中读取

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T13:54:05.693

对于菜单，我们通常为页面标题和页面导航标题使用不同的字段。这允许作者为菜单指定较短的版本。

一旦你有了它，你只需要确保你在你的标题控件中构建代码来找到菜单链接的目标项目（我假设它是一个通用链接，或者其他一些项目引用）并拉出目标项目的导航标题。

当代码执行此操作时，它应该根据当前语言自动提取该目标项目的版本，这意味着您将获得正确语言的导航标题。

# ruby-on-rails - 如何并排使用 simple_form 和 formtastic (active_admin)？

> ID：13731525
> 
> 赞同：3
> 
> 时间：2012-12-05T20:08:53.240
> 
> 标签：ruby-on-rails, simple-form, formtastic

我有一个使用 active_admin gem 的 rails 项目。这个 active_admin 取决于 formtastic gem。但是，我想在我的应用程序中使用 simple_form 而不是 formtastic（在 active_admin 之外的所有部分）。

问题：simple_form 和 formtastic 都声明了“simple_form_for”帮助器，并且通常具有非常相似的 DSL。

如何在我的应用程序中使用 simple_form，同时仍然保留 active_admin（及其 formtastic）？

如果你问自己，为什么我需要这么麻烦的设置：我使用 twitter bootstrap，simple_form 很好地支持 bootstrap，而 formtastic 不支持。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-29T22:42:57.463

我认为如今*(2015+)*`SimpleForm` ，确保与`Formtastic`（包括`ActiveAdmin`依赖项）兼容的最简单和最合适的方法是将您的自定义`SimpleForm`输入包装在*命名空间*中：

```
# If needed, you can namespace your custom inputs in a module and tell `SimpleForm`
# to look for their definitions in this module. This can avoid conflicts with other
# form libraries (like `Formtastic`) that look up the global context to find inputs
# definition too.

# app/inputs/custom_inputs/numeric_input.rb
module CustomInputs
  class NumericInput < SimpleForm::Inputs::NumericInput
    def input_html_classes
      super.push 'no-spinner'
    end
  end
end

# config/initializers/simple_form.rb
config.custom_inputs_namespaces << 'CustomInputs' 
```

查看[文档的](https://github.com/plataformatec/simple_form)[自定义输入](https://github.com/plataformatec/simple_form#user-content-custom-inputs)部分以获取更多详细信息。`SimpleForm`

# c# - 使用 DoEvents 在 Outlook 加载项中挂起进度对话框

> ID：13731528
> 
> 赞同：2
> 
> 时间：2012-12-05T20:09:03.060
> 
> 标签：c#, .net, outlook, add-in, doevents

**背景：**

我在 Outlook 加载项中使用一个简单的进度对话框来显示执行长时间操作的进度。由于我无法在单独的线程中运行使用 Outlook 对象的代码，因此我无法实现更传统的后台工作进程。我的加载项一直工作正常，直到 Outlook 2013 在某些情况下我的进度对话框挂起。当我在 VS 调试器中运行加载项并导致挂起，然后中断时，它似乎卡在尝试强制更新进度条的 DoEvents() 行上。

**我的问题：**

有人可以建议一个更好的系统来显示上述限制的进展（长时间运行的代码必须在主 Outlook 线程中运行）。有没有更好的方法可以在不使用 DoEvents() 的情况下使进度对话框响应？

下面的简单代码演示了我现在是如何做到这一点的。在对 Outlook 对象执行长操作的加载项代码中：

```
private void longRunningProcess()
{
    int max = 100;

    DlgStatus dlgstatus = new DlgStatus();
    dlgstatus.ProgressMax = max;
    dlgstatus.Show();

    for (int i = 0; i < max; i++)
    {
        //Execute long running code that MUST best run in the main (Outlook's) thread of execution...
        System.Threading.Thread.Sleep(1000); //for simulation purposes

        if (dlgstatus.Cancelled) break;
        dlgstatus.SetProgress("Processing item: " + i.ToString(), i);
    }
} 
```

这是简单进度对话框窗口的代码：

```
public partial class DlgStatus : Form
{
    private bool _cancelled;

    public DlgStatus()
    {
        InitializeComponent();
    }

    public int ProgressMax
    {
        set 
        {
            progress.Maximum = value;
            Application.DoEvents();
        }
    }

    public bool Cancelled
    {
        get { return _cancelled; }
    }

    public void SetProgress(string status, int val)
    {
        lblStatus.Text = status;
        progress.Value = val;
        Application.DoEvents();  //Seems to hang here
    }

    private void btnCancel_Click(object sender, EventArgs e)
    {
        _cancelled = true;
        Application.DoEvents();
        this.Visible = false;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T14:36:26.663

通过执行以下操作，我能够做到这一点。自定义表单有一个进度条，其样式设置为 Marquee。

我从[http://social.msdn.microsoft.com/Forums/en/vsto/thread/59993421-cbb5-4b7b-b6ff-8a28f74a1fe5](http://social.msdn.microsoft.com/Forums/en/vsto/thread/59993421-cbb5-4b7b-b6ff-8a28f74a1fe5)获得了通用方法，但发现我不需要使用所有自定义窗口句柄。

```
private void btn_syncContacts_Click(object sender, RibbonControlEventArgs e)
{
     Thread t = new Thread(SplashScreenProc);
     t.Start();

     //long running code
     this.SyncContacts();

     syncingSplash.Invoke(new Action(this.syncingSplash.Close), null);
}

private SyncingContactsForm syncingSplash = new SyncingContactsForm();

internal void SplashScreenProc(object param)
{
    this.syncingSplash.ShowDialog();
} 
```

请务必注意，该表单不适用于 Outlook 对象模型。Microsoft 不建议在单独的线程上使用对象模型。

# coldfusion - 由于 Machii Redirect 事件，Chrome 中的 310 重定向循环错误

> ID：13731537
> 
> 赞同：1
> 
> 时间：2012-12-05T20:09:38.550
> 
> 标签：coldfusion, coldfusion-9, mach-ii

我在运行我的网站时收到 310：Chrome 中出现太多重定向错误。但是，对于 IE 或 Firefox，情况并非如此。

我正在使用 Mach-ii 框架，这就是我在事件处理程序中使用重定向的情况。

例如：

```
<event-handler event="A">
    <announce event="B">
    <announce event="C">
</event-handler>

<event-handler event="C">
    <redirect event="D">
</event-handler>

<event-handler event="D">
    <view-page name="foo">
</event-handler> 
```

所以，如果我到达这个页面，它会完美呈现。但是，如果我返回浏览器然后再次单击下一步按钮，我会收到错误消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T07:54:15.223

Chrome 对此类错误的一些常见解决方案可能是

*   删除所有网站的 cookie 并重新启动浏览器。
*   同步您的计算机时间。在计算机的日期和时间设置中，将其同步到时间服务器。

我还听说不同的更新渠道有问题，而其他渠道没有。因为在 Chrome 的 Beta 通道中不会有这个问题，但稳定版确实有这个问题。我听说插件（chrome 脚本）是个问题。我想作为最后的解决方案，完全删除 Chrome 并重新安装它。

我个人认为这不是 Mach-ii 或 Coldfusion 问题。希望你来对了。

# javascript - 从 google maps api v3 获取带有自动完成服务的邮政编码

> ID：13731539
> 
> 赞同：9
> 
> 时间：2012-12-05T20:09:44.227
> 
> 标签：javascript, google-maps-api-3

我正在使用来自 google maps api V3 的自动完成服务来进行自定义自动完成输入。我基本上调用这个函数来检索城市建议。

```
function getPlaces(st){
    gService.getQueryPredictions({input:st,types:['geocode']},function(predictions,status)      {
        if(status != google.maps.places.PlacesServiceStatus.OK) return false;
        for(var i = 0, prediction; prediction = predictions[i]; i++){
            console.log(prediction);
        }
        return predictions;
    });
} 
```

这很好用，但我想获取与城市相关的邮政编码。就像 V2 api 所做的那样，[请参阅这个示例](http://maps.googleapis.com/maps/api/js/GeocodeService.Search?4sbeau&7sFR&9sfr-FR&callback=_xdc_._rmc2d7&token=103359)。

我试图将类型选项更改为城市，但结果是一样的。知道怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-09-03T09:08:59.860

检查此代码段：

```
 var geocoder;
var map;
function initialize() {  
  var input = document.getElementById('id_address');
  var options = {
    types: ['address'],
    componentRestrictions: {
      country: 'in'
    }
  };

  autocomplete = new google.maps.places.Autocomplete(input, options);

  google.maps.event.addListener(autocomplete, 'place_changed', function() {
    var place = autocomplete.getPlace();

    for (var i = 0; i < place.address_components.length; i++) {
      for (var j = 0; j < place.address_components[i].types.length; j++) {
        if (place.address_components[i].types[j] == "postal_code") {
          document.getElementById('postal_code').innerHTML = place.address_components[i].long_name;

        }
      }
    }
  })
}
google.maps.event.addDomListener(window, "load", initialize)
```

```
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyDxcRPSsACIjdvMWRcfJBMzp4pKQXPJjj0&libraries=places"></script>
<input id="id_address" type="text" value="" />
<div id="postal_code"></div>
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T03:01:05.390

在新的 API 中，AutocompleteService 仅搜索与您目前输入的文本匹配的猜测字符串。要获取包含地址和其他数据的实际 Place 对象，您需要使用在将 autocomplete() 函数附加到文本框时创建的 Autocomplete 对象。在此处查看文档：[https ://developers.google.com/maps/documentation/javascript/places#getting_place_information](https://developers.google.com/maps/documentation/javascript/places#getting_place_information)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-15T17:08:05.193

如果返回的预测是一个地方，那么它将有一个`place_id`属性。您需要将该 id 传递给该类的`getDetails`方法，`PlacesService`这将返回您的邮政信息。获取邮政编码的方法有点绕，但这是我发现的唯一适用于`AutocompleteService`

PlacesService 类的[文档](https://developers.google.com/maps/documentation/javascript/reference/places-service?hl=en_US)

# matlab - 如何使用MATLAB对积分中嵌入未知数的方程进行数值求解？

> ID：13731547
> 
> 赞同：3
> 
> 时间：2012-12-05T20:10:16.427
> 
> 标签：matlab, equation, integral

我一直在尝试使用 MATLAB 来解决这样的方程：

> B = alpha*Y0*sqrt(epsilon)/(pi*ln(b/a)*sqrt(epsilon_t))*从0到pi的整数(2*sinint(k0*sqrt(epsilon*(a^2+b) ^2-2abcos(theta))-sinint(2*k0*sqrt(epsilon)*a*sin(theta/2))-sinint(2*k0*sqrt(epsilon)*b*sin(theta/2)) ) 关于 theta

epsilon是未知数*。*

我知道如何使用`int()`and符号地求解嵌入在积分中的未知方程`solve()`，但是对于如此复杂的方程，使用符号积分器`int()`需要太长时间。当我尝试使用`quad()`, `quadl()`and`quadgk()`时，我无法处理未知数如何嵌入积分中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T12:54:01.973

这种事情变得非常复杂。尽管可以在一个内联方程中完成所有操作，但我建议您将其拆分为多个嵌套函数，如果只是为了便于阅读。

为什么可读性很重要的最好例子：你在你发布的方程式中有一个括号问题；没有足够的右括号，所以我不能完全确定等式在数学符号中的样子:)

无论如何，这是使用我认为的版本的一种方法 - 你的意思是：

```
function test

    % some random values for testing    

    Y0 = rand;
    b  = rand;
    a  = rand;
    k0 = rand;
    alpha     = rand;
    epsilon_t = rand;

    % D is your B
    D = -0.015;

    % define SIMPLE anonymous function 
    Bb = @(ep) F(ep).*main_integral(ep) - D;

    % aaaand...solve it!
    sol = fsolve(Bb, 1)

    % The anonymous function above is only simple, because of these: 

    % the main integral    
    function val = main_integral(epsilon)

        % we need for loop through epsilon, due to how quad(gk) solves things
        val = zeros(size(epsilon));
        for ii = 1:numel(epsilon)

            ep = epsilon(ii);

            % NOTE how the sinint's all have a different function as argument:
            val(ii) = quadgk(@(th)...
                2*sinint(A(ep,th)) - sinint(B(ep,th)) - sinint(C(ep,th)), ...
                0, pi);            
        end

    end

    % factor in front of integral
    function f = F(epsilon)        
        f = alpha*Y0*sqrt(epsilon)./(pi*log(b/a)*sqrt(epsilon_t)); end

    % first sinint argument
    function val = A(epsilon, theta)
        val = k0*sqrt(epsilon*(a^2+b^2-2*a*b*cos(theta))); end

    % second sinint argument
    function val = B(epsilon, theta)
        val = 2*k0*sqrt(epsilon)*a*sin(theta/2); end

    % third sinint argument
    function val = C(epsilon, theta)
        val = 2*k0*sqrt(epsilon)*b*sin(theta/2); end    

end 
```

上面的解决方案仍然会很慢，但我认为对于如此复杂的积分来说这是很正常的。

我不认为实现你自己的`sinint`会有多大帮助，因为大部分速度损失是由于具有非内置函数的 for 循环......如果你想要它的速度，我会用你自己的 Gauss 去实现 MEX -Kronrod 自适应正交例程。

# math - 数学：增加整数 x 返回 0 和 1 的交替的方程是什么？

> ID：13731550
> 
> 赞同：-4
> 
> 时间：2012-12-05T20:10:38.660
> 
> 标签：math, equation

在增加整数 x 时返回 0 和 1 的交替的方程是什么

例子

x = 22

结果 1

x = 23

结果 0

x = 24

结果 1

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T20:11:55.730

根据示例数据，它将是模 2。假设`x`是一个 int（和 C/C++/C#）：

```
(x + 1) % 2; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-05T20:12:52.177

在 C 或 C++ 中，这将是

```
int y = (x+1)%2; 
```

数学上，

```
y = (x+1) modulo 2 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-05T20:13:54.993

它称为[**模数**](http://en.wikipedia.org/wiki/Modulo_operation)。`2`您可以在值中添加一个后使用 mod 。

```
 x = 22
   result = (x+1) modulo 2 
```

在编程语言中，它通常被称为`%`：

```
 x = 22
 result = (x+1) % 2    //<< result 1

 x = 23
 result = (x+1) % 2    //<< result 0 
```

等等..

# css - 对齐图像下有边框的文本框以使它们一起移动的问题

> ID：13731552
> 
> 赞同：2
> 
> 时间：2012-12-05T20:10:50.117
> 
> 标签：css, image, html, alignment

目前在尝试将这些带边框的文本框起来以与上述图像保持对齐时遇到问题，当我重新调整页面大小时，它们会与预期图像保持一致。目前，我让它们被迫贴在带有边距 css 的图像下方，但是一旦我重新调整框的大小，所有框都在图像下方逃逸。

编辑：更新的代码 - 仍然有类似的问题，但这看起来更有希望 - 附上当前状态的照片。 ![更新代码后的当前问题](../Images/d40eb7bc86bcb847444d39697a051db4.png)

```
 <body>

        <div id="container">

            <div id="header">
                <img class="leaf" src="images/freshleaf.png" height="150px" alt="freshtext"/>
                <!--<button class="navbutton"> <strong> TEST </strong> </button>-->
            </div>

            <div id="body">
                <div id="main" class="">
                    <div class="column">
                        <img class="smart" src="images/phone1.png" height="500px" alt="phone1"/>
                        <div class="box1"> <h3>Pie is tasty Mmmmm...</h3> </div>
                    </div>

                    <div class="column">
                        <img class="smart" src="images/phone2.png" height="500px" alt="phone2"/>
                        <div class="box2"> <h3>Pie is tasty Mmmmm...</h3> </div>
                    </div>

                    <div class="column">
                        <img class="smart" src="images/phone3.png" height="500px" alt="phone3"/>
                        <div class="box3"> <h3>Pie is tasty Mmmmm...</h3> </div>
                    </div>
                </div>
            </div>

        </div>

#body{
   text-align: center;
}

#header {
   padding-bottom: 50px;
   text-align: center;
}

#main{
    margin: 0 auto;
    text-align:left;
    width: 770px;
}

.column{
   float:left;
   padding-left: 10px;
}

.column:first-child {
   padding-left: 0px;
}

.box1{
   border: dotted;
   border-color: gray;
   padding: 2px 5px 2px 5px;
   max-width: 250px;
   text-align: center;
}

img.smart{
   margin-left: auto;
   margin-right: auto;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T21:30:24.463

将每个图像和对应的文本包装在一个容器中并`float:left`在 css 中设置。摆脱`#textboxes`div。`#main`然后通过将其设置为所有图像的宽度（加上填充 - 如果需要）来居中您的div。请参阅使用所有代码的示例：

[http://jsfiddle.net/QLvt7/4/](http://jsfiddle.net/QLvt7/4/)

# php - php函数从上传的照片中删除空格

> ID：13731555
> 
> 赞同：0
> 
> 时间：2012-12-05T20:10:58.100
> 
> 标签：php, function, upload

我正在使用 Jquery 上传器将图像上传到我的网站。它使用一个名为uploadhandler.php 的文件来操作这些文件。在 uploadhandler.php 内部是以下函数，它似乎对文件名的格式等进行了更改。我遇到的问题是，如果我上传文件名中带有空格的文件，它似乎不会删除其中的空格文件名。有谁知道我如何编辑它以添加一个额外的命令来删除文件名中的任何空格，或者指出我如何做到这一点的正确方向？

```
 protected function trim_file_name($name, $type, $index, $content_range) {

    // Remove path information and dots around the filename, to prevent uploading

    // into different directories or replacing hidden system files.

    // Also remove control characters and spaces (\x00..\x20) around the filename:

    $file_name = trim(basename(stripslashes($name)), ".\x00..\x20");

    // Add missing file extension for known image types:

    if (strpos($file_name, '.') === false &&

        preg_match('/^image\/(gif|jpe?g|png)/', $type, $matches)) {

        $file_name .= '.'.$matches[1];

    }

    while(is_dir($this->get_upload_path($file_name))) {

        $file_name = $this->upcount_name($file_name);

    }

    $uploaded_bytes = $this->fix_integer_overflow(intval($content_range[1]));

    while(is_file($this->get_upload_path($file_name))) {

        if ($uploaded_bytes === $this->get_file_size(

                $this->get_upload_path($file_name))) {

            break;

        }

        $file_name = $this->upcount_name($file_name);

    }

    return $file_name;

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T20:25:03.280

该行：

```
$file_name = trim(basename(stripslashes($name)), ".\x00..\x20"); 
```

将删除文件名“周围”的空格，例如“foo”，因为该`x20`位是空格。您可以直接在此行之后添加：

```
$file_name = str_replace(" ", "", $file_name); 
```

就这么简单！还请记住，当您使用第二个参数时，`trim()`您会删除手册中列出的“默认”字符列表 ( [http://php.net/trim](http://php.net/trim) ) 并将其替换为您自己的...

我还要指出，我**永远不会**使用浏览器给出的文件名`$_FILES[$x]['name']`......它只会打开太多的问题和可能性。完全避免该问题的一种技术可能是简单地使用文件*内容*`md5()`的或`sha1()`类似的，例如：

 *```
$file_name = md5_file($_FILES['your_file_tag_name']['tmp_name']); 
```

这样理论上，文件中永远不会有空格或“脏”文件名……此外，如果用户上传了两个内容完全相同的文件，您只需检查文件是否存在，如果它已经存在，您已经拥有*完全相同的文件*。希望这会有所帮助，这一切都假设您正在上传文件，我不能 100% 确定您是。*

# shell - 如何在mac上使用Shell脚本检查是否安装了subversion

> ID：13731556
> 
> 赞同：2
> 
> 时间：2012-12-05T20:11:01.593
> 
> 标签：shell, unix

我正在编写一个小 shell 脚本来帮助为我们的一些软件设置生产/开发环境，其中一部分需要颠覆。

我需要一种方法来检查 *nix（通常是 mac）机器上是否安装了 subversion。

我正在考虑检查**export SUBVERSION_HOME=/opt/subversion**是否存在于 .profile 中，因为这是开发人员在这里使用的，但是还有更具体的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T20:37:10.503

你可以做一些粗略的事情：

```
which svn 
```

在测试中：

```
if [[ -n $(which svn) ]]; then
    # do something
fi 
```

**警告：**即使有人`svn`安装了实际上不是 Subversion 的安装，这也不太可能失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T20:37:19.200

像这样简单的事情可能吗？

```
which svn > /dev/null
if [ $? -eq 1 ]; then
    echo "subversion is not installed"
    exit 1
fi 
```

# java - 线程通知问题

> ID：13731557
> 
> 赞同：0
> 
> 时间：2012-12-05T20:11:04.813
> 
> 标签：java, multithreading

从主线程，我启动了一个子线程，在子线程`run()`方法里面，调用`wait()`方法在main方法`join()`中为子线程调用方法，而不通知子线程。

我注意到，主线程和子线程仍在运行，这是一种已知的行为吗？为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T20:15:47.310

通过调用`wait`阻塞子线程直到子线程结束`notify`，调用`join`阻塞主线程直到子线程结束。因此，您有一个可预测的死锁。我不会将这种行为称为“已知”，而是“按规定”。

# ruby-on-rails - 我可以在 has_many :through 声明中使用扩展的活动记录关联吗？

> ID：13731560
> 
> 赞同：0
> 
> 时间：2012-12-05T20:11:11.043
> 
> 标签：ruby-on-rails, activerecord, ruby-on-rails-3.2

我已经扩展了我的许多 has_many 声明来过滤/加入/预加载关联。当我声明 has_many :through 关系时，我想重新使用其中的一些扩展。这可能吗？我应该采取不同的方法吗？

例子：

我的图书馆模型中有这个：

```
class Library < ActiveRecord::Base
  has_many :meals, :dependent => :destroy do
    def enabled
      where(:enabled => true)
    end
  end
end 
```

我的膳食模型有这个：

```
class Meal < ActiveRecord::Base
  has_many :servings, :inverse_of => :meal, :dependent => :destroy
end 
```

我希望我的图书馆有很多份，但仅限于启用的膳食。有几种方法可以做到这一点：

```
# repeat the condition in the has_many :servings declaration
class Library < ActiveRecord::Base
  has_many :servings, :through => :meals, :conditions => ["meals.enabled = ?", true]
end

# declare a different meals association for only the enabled meals
class Library < ActiveRecord::Base
  has_many :enabled_meals, :class_name => "Meals", :conditions => [:enabled => true]
  has_many :servings, :through => :enabled_meals
end 
```

**有没有办法重新使用我现有的 :meals 声明的扩展？**（在第一个代码块中启用了def）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T21:00:58.590

看起来很像您想使用 activerecord-association-extensions，如此处所述[http://blog.zerosum.org/2007/2/8/activerecord-association-extensions.html](http://blog.zerosum.org/2007/2/8/activerecord-association-extensions.html)。

我还没有尝试过，但我认为你可以这样做：

```
 module LibraryMealExtensions
  def enabled?
    where(:enabled=>true)
  end

  def standard_includes
    includes(:servings)
  end
end

class Library < ActiveRecord::Base
  has_many :meals, :dependent => :destroy, :extend=>LibraryMealExtensions
  has_many :servings, :through => :meals, :extend=>LibraryMealExtensions
end 
```

不确定那里的“启用=>真” - 你可能不得不说

```
where("meals.enabled=true") 
```

b/c 与别名混淆。

# javascript - 从两个绝对路径构造 JavaScript 中的相对路径

> ID：13731565
> 
> 赞同：4
> 
> 时间：2012-12-05T20:11:40.093
> 
> 标签：javascript, path

给定两条绝对路径，例如

```
/var/data/stuff/xyz.html
/var/data 
```

如何创建以第二条路径为基础的相对路径？在上面的示例中，结果将是： stuff/xyz.html

另一个例子：

```
/relative/sub/foo/sub/file
/relative/path
../../../path 
```

这类似于[这个问题](https://stackoverflow.com/questions/204784/how-to-construct-a-relative-path-in-java-from-two-absolute-paths-or-urls)，但我正在寻找最佳的 JavaScript 解决方案而不是 Java。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-05T20:20:23.977

如果您使用 node.js 在服务器上运行它：

[http://nodejs.org/api/path.html#path_path_relative_from_to](http://nodejs.org/api/path.html#path_path_relative_from_to)

这是他们的实现：

[https://github.com/joyent/node/blob/master/lib/path.js#L233](https://github.com/joyent/node/blob/master/lib/path.js#L233)

这应该可以在浏览器中正常工作，而无需进行任何更改。它已经过实战测试，因此它已经可以处理边缘情况。它不是单行的，但它可以完美地工作，我认为这更重要。POSIX 版本还不错，如果这是您需要支持的唯一想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T20:14:41.350

URL 处理很容易出错，所以我强烈建议使用库来处理所有细节。

[URI.js](http://medialize.github.com/URI.js/)使这变得简单：

```
URI('/var/data/stuff/xyz.html').relativeTo('/var/data'); 
```

# node.js - 如何添加可以调用 Meteor 代码的服务器端路由？

> ID：13731568
> 
> 赞同：1
> 
> 时间：2012-12-05T20:11:59.067
> 
> 标签：node.js, meteor

我正在尝试允许用户将图像上传到我使用 Meteor 构建的站点，这需要我可以将数据发布到的服务器端路由。有没有办法设置路由服务器端，以便我可以从中调用 Meteor 代码（例如，我可以从中调用 this.userId 或 Meteor.userId() 的路由）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T03:04:55.827

[服务器端路由已在路线图上](https://trello.com/board/meteor-roadmap/508721606e02bb9d570016ae)，但尚未按您需要的方式提供。（在那个链接上，服务器端渲染设置为 1.0 版）。

在此期间，您可以使用 Tom Coleman 出色的[meteor-router mrt 包进行](https://github.com/tmeasday/meteor-router#server-side-routing)*一些*服务器端渲染。我不清楚其中有多少会进入 Meteor 核心。

然而，更有可能的是，对于文件上传问题，这个[问题](https://github.com/meteor/meteor/issues/222)描述了这个问题，看起来人们很幸运地实现[了 imgur 的 xhr api](http://api.imgur.com/examples#uploading_js)，或者甚至更好的是[这个聪明的想法](https://gist.github.com/3922137)。

希望这可以帮助。

# wordpress - 二十二只显示标签、类别、归档结果的标题和元

> ID：13731569
> 
> 赞同：1
> 
> 时间：2012-12-05T20:12:11.187
> 
> 标签：wordpress, tags, title, categories

我只想在结果页面上显示帖子标题和元数据（猫、标签、日期）。我已经使用 Esmi 在 wp-forums 上发布的这段代码来部分实现这一点。

```
<?php if ( is_search() ) : // Only display Excerpts for Search ?>
<div class="entry-summary">
<?php the_excerpt(); ?>
</div><!-- .entry-summary -->
<?php elseif( !is_category() ) : ?>
<div class="entry-content">
<?php the_content( __( 'Continue reading <span class="meta-nav">&rarr;</span>',    'twentytwelve' ) ); ?>
<?php wp_link_pages( array( 'before' => '<div class="page-links">' . __( 'Pages:', 'twentytwelve' ), 'after' => '</div>' ) ); ?>
</div><!-- .entry-content -->
<?php endif; ?> 
```

子主题的 content.php 中的此代码将在搜索页面结果中生成摘录，但仅在类别结果中生成标题和元。

我试过添加 !is_tag || !is_archive 到 elseif 语句.. 然后一切都返回完整的帖子。我已经用 elsif !is_tag 替换了 elseif !is_category 并且我再次在标签页面上获得了标题和元结果，这正是我想要的。

似乎我应该能够将此列表添加到 else if 语句以获得我想要的东西，但我不能使用正确的代码来执行此操作。

我还尝试用 is_search || 替换顶部字符串 php if is_search is_tag || is_archive || is_category 也给了我整个帖子。

这应该很简单..但我被卡住了。任何帮助将不胜感激。

# c# - Log4NET、ADONetAppender 和自定义字段

> ID：13731571
> 
> 赞同：4
> 
> 时间：2012-12-05T20:12:19.307
> 
> 标签：c#, asp.net-mvc, log4net, adonetappender

我可以使用 ADONetAppender 设置 log4NET，当我想通过 log.Info(message) 记录消息时捕获事物的状态时，一切正常。

由于我将根据在整个应用程序中更改的 ActionID 从应用程序中的各个位置进行日志记录，因此我如何扩展事物以便我可以发出诸如 log.Info(ActionID, message) 之类的调用，而 ActionID 最终在数据库？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-05T21:32:21.763

您可以`GlobalContext.Properties`在调用之前`log.Info()`通过执行以下操作将自定义字段添加到 log4net：

```
GlobalContext.Properties["ActionID"] = ActionID; 
```

然后，在您的 ADONetAppender 配置中，您可以使用`%property{ActionID}`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-05T23:35:51.370

我认为@bcwood 可能有最好/最简单的想法，即简单地使用 GlobalContext.Properties 来存储您要记录的 id。

但是，如果 id 对您非常重要，并且如果您想简化 id 的设置（例如通过向各种日志记录方法添加参数而不是必须添加单独的调用来设置 GlobalContext 中的 id 值），那么您可能会在 log4net 存储库中查看此文件夹。

[http://svn.apache.org/viewvc/logging/log4net/trunk/extensions/net/1.0/log4net.Ext.EventID/cs/src/](http://svn.apache.org/viewvc/logging/log4net/trunk/extensions/net/1.0/log4net.Ext.EventID/cs/src/)

它包含一个如何扩展 log4net 记录器以添加“EventID”参数的示例。

这对我来说似乎很重要（子类化 log4net 记录器，创建你自己的 LogManager 来分配你的记录器等）。

如果您选择包装 log4net，并在内部使用 log4net 的记录器进行记录，您可能会更简单一些。

使用我上面链接的方法（或类似但更简单的包装 log4net 记录器的方法）的优点是您的日志记录调用站点可以看起来像您建议的那样：

```
logger.Info(123, "Hello");
logger.Info(321, "Good bye"); 
```

与@bcwood 的建议相比，这将使您的日志调用站点看起来像这样：

```
GlobalContext.Properties["ActionID"] = 123;
logger.Info("Hello");
GlobalContext.Properties["ActionID"] = 321;
logger.Info("Good bye"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T20:23:07.283

尝试通过包装 info 方法来创建自定义函数。

```
void InfoLog(int ActionID, string message)
{
   log.info(String.Format("{0}:{1}",ActionID.ToString(),message));
} 
```

# ruby-on-rails-3 - rails 3 flash消息未显示在移动设备上

> ID：13731582
> 
> 赞同：1
> 
> 时间：2012-12-05T20:13:25.943
> 
> 标签：ruby-on-rails-3, mobile

我的应用程序支持图像上传。如果成功，用户会收到一条成功消息：

控制器：

```
def create
    @rating = Rating.new(params[:rating])

    respond_to do |format|
      if @rating.save
        format.html { redirect_to @rating, :notice => 'Got It!',
                                  :flash => {:notice_small => 'Your photo has been uploaded. good luck with its coolness rating!'} }
        format.json { render :json => @rating, :status => :created, :location => @rating }
      else
        format.html { render :action => "new" }
        format.json { render :json => @rating.errors, :status => :unprocessable_entity }
      end
    end
  end 
```

风景：

```
<br>
<br>
<div style="height: 100px;" class="visible-tablet visible-phone"></div>
<p id="notice" class="big_notice"><%= notice %></p>
<% if defined? flash[:notice_small]  %>
    <p id="small_notice" class="small_notice"><%= flash[:notice_small] %></p>
<% end %> 
```

在桌面上运行良好。但不是在手机上:-(图片已上传，但我没有收到确认消息

编辑：我在移动设备上查看了源代码并像这样显示 html

```
<p id="notice" class="big_notice"></p>
<p id="small_notice" class="small_notice"></p> 
```

表示`flash[:notice_small]`已定义（注意`if defined? flash[:notice_small]`条件）但它只是空的

# visual-studio-2010 - 如何从 CruiseControl.Net 触发 NuGet v2.x 包还原

> ID：13731583
> 
> 赞同：7
> 
> 时间：2012-12-05T20:13:25.560
> 
> 标签：visual-studio-2010, msbuild, cruisecontrol.net, nuget

尝试使用 CruiseControl.Net 构建 VS2010 解决方案时是否可以触发 NuGet v2.x 包还原？

我们最近建立了 CCNET，只是试图触发我们主要解决方案的测试构建。主解决方案中的许多项目都启用了 NuGet 包还原。包文件夹未提交给我们的 VCS。由于必须同意 Visual Studio 中的包还原这一新“功能”，MSBuild 在遇到 nuget.targets 文件中的还原包目标时会失败。

如果可以不对使用 NuGet 或编写自定义构建脚本的每个项目进行重大更改，那么完成包还原的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-05T23:06:43.107

来自[http://docs.nuget.org/docs/workflows/using-nuget-without-committing-packages](http://docs.nuget.org/docs/workflows/using-nuget-without-committing-packages) 要为未安装 Visual Studio 的构建服务器启用包还原，您还可以将环境变量 EnableNuGetPackageRestore 设置为“true”。

# sql - SQL Server 空逻辑异或

> ID：13731586
> 
> 赞同：6
> 
> 时间：2012-12-05T20:13:35.063
> 
> 标签：sql, sql-server, tsql, constraints, xor

我正在（Microsoft）Sql Server 2008 表上创建一个约束。我有两列是不同的数据类型。一列必须始终为空，但不能同时为空（逻辑异或/异或）。我目前有一个工作表达。

```
(@a is null or @b is null) and not (@a is null and @b is null) 
```

我的问题是**编写此代码是否有更简洁或更短的方法？**

要测试它，您可以使用此代码...

```
declare @a int
declare @b varchar(5)

set @a=1
set @b='XXXXX'

if (@a is null or @b is null) and not (@a is null and @b is null)
  select 'pass'
else
  select 'fail' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T20:16:29.223

我会选择

```
if (@a is null and @b is not null) or (@a is not null and @b is null) 
```

我认为这更清楚一些

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-05T20:49:51.930

好的，如果您正在使用所有字符串，这是一个（尽管很愚蠢）建议。它可以扩展到大于 2 的倍数，您需要特定数量的非空值。再说一次，它很愚蠢，而且不是很短，但是太有趣了，不能提...

```
where LEN(ISNULL(right(@a+'x',1),'')+ISNULL(right(@b+'x',1),'')) = 1 
```

为了让它与你的东西一起工作，我想你必须 CAST [int]。在匹配之前在 where 子句中执行字符串“手术”是邪恶的，并且可能会很慢。但是，如果您有 6 列并且恰好需要 1 不为空，则此技巧将扩大。

基本上，我们使用 LEN 来计算非空值。`+'x'`确保您不会将 a视为`''`空值。您可以在测试 [char] 列时将其关闭。

# restlet - 一个有趣的 Restlet 属性行为

> ID：13731587
> 
> 赞同：0
> 
> 时间：2012-12-05T20:13:41.553
> 
> 标签：restlet, restlet-2.0

使用 Java EE 的 Restlet 2.1，我发现了一个有趣的问题，即它处理属性的能力。

假设您有如下代码：

```
cmp.getDefaultHost().attach("/testpath/{attr}",SomeServerResource.class); 
```

并在您的浏览器上提供以下 URL：

```
http://localhost:8100/testpath/command 
```

然后，当然，attr 属性设置为“命令”。

不幸的是，假设您希望属性类似于命令/测试，如以下 URL：

```
http://localhost:8100/testpath/command/test 
```

或者，如果您想动态添加不同级别的内容，例如：

```
http://localhost:800/testpath/command/test/subsystems/network/security 
```

在这两种情况下，attr 属性仍设置为“命令”！

在restlet应用程序中是否有某种方法可以制作一个可以保留“斜线”的属性，例如，可以将attr属性设置为“command/test”？我希望能够在 testpath 之后抓取所有内容并将整个字符串作为属性。

这可能吗？有人请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T19:31:04.540

您可以通过使用 url 编码来做到这一点。

我在路由器中添加了以下附件：

```
router.attach("/test/{cmd}", TestResource.class); 
```

我的测试资源类看起来像这样，在[Apache Commons Codec URLCodec的帮助下](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/net/URLCodec.html)

```
@Override
protected Representation get() {
    try {
    String raw = ResourceWrapper.get(this, "cmd");
    String decoded = new String(URLCodec.decodeUrl(raw.getBytes()));
    return ResourceWrapper.wrap(raw + " " + decoded);
    } catch(Exception e) { throw new RuntimeException(e); }
} 
```

请注意，我的资源包装类只是实用方法。get返回url参数的字符串，wrap返回一个StringRepresentation。

现在，如果我做这样的事情：

```
http://127.0.0.1/test/haha/awesome 
```

我得到一个404。

相反，我这样做：

```
http://127.0.0.1/test/haha%2fawesome 
```

我已经对文件夹路径进行了 URLEncoded。这导致我的浏览器说：

```
haha%2fawesome haha/awesome 
```

第一个是原始字符串，第二个是结果。我不知道这是否适合您的需求，因为这是一个简单的示例，但是只要您对属性进行 URLEncode，就可以在另一端对其进行解码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T00:42:23.117

对于同样的情况，我通常会更改变量的类型：

```
Route route = cmp.getDefaultHost().attach("/testpath/{attr}",SomeServerResource.class);
route.getTemplate().getVariables().get("attr") = new Variable(Variable.TYPE_URI_PATH); 
```

# c# - 在 C# 中创建一个隐藏 int 值的安全哈希

> ID：13731588
> 
> 赞同：2
> 
> 时间：2012-12-05T20:13:47.120
> 
> 标签：c#, .net, encryption, hash, cryptography

我正在尝试为我的 C# 2.0 桌面应用程序创建一个注册码，这是一个按使用付费的应用程序。注册码必须在其中隐藏一个 int 值（int 值代表应用程序的使用次数）。

为了从我的机器生成代码，我有一个单独的应用程序，它使用名称、随机数和使用次数作为输入。例如：

```
Name:  BOBSMITH  
Random number:  51728  
Number of Uses: 50  
Concatenated String: BOBSMITH_51728_50 
```

如果我对连接字符串（例如 MD5 哈希）进行哈希处理，我会得到一个 32 十六进制字符串（我将其称为 Reg 代码），类似于： `ABCD 1234 EFGH 5678 IJKL 9012 MNOP 3456`

现在，在我的用户方面，当他们注册应用程序时，我需要验证注册代码并从注册代码/名称/随机数中确定使用次数。所以用户将输入这些值：

```
Name: BOBSMITH  
Random Number: 51728  
Reg Code: ABCD 1234 EFGH 5678 IJKL 9012 MNOP 3456 
```

**我的问题：**我的应用程序如何确定（仅基于名称、随机数和注册码）：

*   注册码是否正确
*   我的机器最初给出的使用次数

* * *

我想到的一个简单想法是仅基于名称和随机数（我们称之为代码 A）生成一个哈希，然后将使用次数添加到此哈希（代码 B）中。例如：

```
Code A: ABCD 1234 EFGH 5678 IJKL 9012 MNOP **1184**  
Code B: ABCD 1234 EFGH 5678 IJKL 9012 MNOP **11B6** 
```

如果我们从代码 B 中减去代码 A，我们得到 50。因此，我的用户将输入这些值：

```
Name:BOBSMITH  
Random Number: 51728  
Reg Code: ABCD 1234 EFGH 5678 IJKL 9012 MNOP 11B6  (Code B) 
```

为了验证 Reg 代码和使用次数（从用户端），我的应用程序将采用 Name & Random Number 的哈希值，这将给出与 Code A 相同的值。然后我将从 Reg Code 中减去 Code A用户输入并看到差异是 50。因此，我知道给用户 50 次使用。然而，这个解决方案似乎太不安全了。我会很感激任何人的建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T20:46:36.470

TL;DR 版本：这是不可能的。“按使用付费”和“桌面应用程序”不能混用。

* * *

隐藏数字实际上是目标，还是您假设隐藏它有助于防止篡改？（您是否试图不向消费者展示他们已经支付了多少次使用费用？听起来不诚实。）您可以使用消息验证码来验证该值没有被篡改，即使该数字存储在显而易见的地方，因为更改将使 MAC 无效。

但是，这仍然不能解决您的问题。如果用户可以篡改已使用次数的计数器，则对保护已购买的使用次数没有任何好处。在最简单的攻击中，用户只需在第二台计算机上输入相同的注册码，就可以使使用次数翻倍。并且这个计数器必须由用户计算机上运行的软件增加，因此他必须拥有更新它所需的所有信息。

即使您将计数器存储在您控制下的某个安全中央服务器上（这也消除了保护允许使用计数的问题），您仍然无法阻止用户修补调用 home 的软件部分。您唯一能做的就是将软件托管在云中，这样您就可以在没有用户合作的情况下计算使用次数。

请参阅[#1 软件许可法](https://stackoverflow.com/a/4532568/103167)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:30:40.587

安全哈希的定义不允许任何取回数字的可能性。

但这并不意味着您可以散列其他所有内容，然后以另一种方式隐藏散列码中的数字。您在哈希末尾添加一个数字的示例可以工作，但是如果您这样做，我还建议您还从结果值计算校验和并将其附加到代码中以使篡改变得困难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T23:52:49.407

散列只是单向的，所以你将无法取回你散列的任何东西。加密是双向的，因此您将能够取回您加密的任何内容。

为防止有人更改加密号码，您还需要进行身份验证。要么使用 AES-GCM（包括身份验证），要么使用 AES-CTR 或 AES-CBC（不包括身份验证）与 HMAC-SHA-256 一起进行身份验证。

计算机安全并不容易。很多问题已经解决了，但解决方案并不总是那么简单。显然，微小的错误可能会导致重大的安全漏洞。

# google-apps-script - 如何为谷歌应用脚 本功能创建自定义键盘快捷键？

> ID：13731589
> 
> 赞同：53
> 
> 时间：2012-12-05T20:13:51.760
> 
> 标签：google-apps-script, google-sheets, keyboard-shortcuts

我试图了解用 Google Doc Spreadsheets 替换我的一些 Microsoft Excel 电子表格的可行性。如何在谷歌文档电子表格中为谷歌应用脚​​本函数创建自定义键盘快捷键？这是我通常用 VBA 和 Excel 做的事情。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-05T20:29:07.777

Apps 脚本仅公开[服务器端事件](https://developers.google.com/apps-script/understanding_events)。不幸的是，您今天无法注册诸如键盘敲击之类的客户端事件。请在我们的[问题跟踪器中记录问题](http://code.google.com/p/google-apps-script-issues/issues/list)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-05-11T17:57:16.797

现在在表格中支持此功能（请参阅[https://issuetracker.google.com/issues/36752620](https://issuetracker.google.com/issues/36752620)），但在 Docs 中尚不支持。查看并加注星[标 https://issuetracker.google.com/issues/36752620](https://issuetracker.google.com/issues/36752620)以获得文档支持

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2018-04-20T16:39:15.440

最近（2018 年 4 月）谷歌推出了一个宏记录器，其中包括一种分配键盘快捷键来触发宏的方法，以及一种将现有脚本作为宏导入的方法。请参阅[Google 表格宏](https://developers.google.com/apps-script/guides/sheets/macros)

注意：此功能目前正在推出，因此可能需要几周时间才能供所有人使用。就我而言，它首先在我的个人 Google 帐户上可用，从昨天开始，它在我的一个 G Suite 帐户上可用。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-06-01T22:08:04.957

解决方案已在[issue 306](https://code.google.com/p/google-apps-script-issues/issues/detail?id=306#c33)上发布！对于懒人来说，这里是：

HtmlService 中的新 IFRAME 模式确实允许将密钥代码传递给附加组件......

```
$(document).keydown(function(e){
  //CTRL + V keydown combo
  if(e.ctrlKey && e.keyCode == 86){
    $( '#output' ).html("I've been pressed!");
  }
}) 
```

必须先单击/激活侧边栏才能发生这种情况。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2018-07-05T16:10:30.523

好消息 :) 您可以按照以下简单步骤为 google app 脚本功能实现自定义键盘快捷键：

1.  在 Google 表格 UI 中，选择**工具 > 宏 > 录制宏**。
2.  记录任何动作。例如，更改 A1 中的颜色背景。按**保存**。
3.  使用随机标题和首选快捷方式保存它。**您可以稍后更改它**。
4.  选择**工具 > 脚本编辑器**以在 Apps 脚本编辑器中打开绑定到工作表的脚本。
5.  在新的编辑器选项卡中，选择**查看 > 显示清单文件**
6.  TA - 达！:D 将**functionName**值更改为所需的值；)

记住宏函数不应该接受参数并且不返回任何值。更多信息，请访问[https://developers.google.com/apps-script/guides/sheets/macros#importing_functions_as_macros](https://developers.google.com/apps-script/guides/sheets/macros#importing_functions_as_macros)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-12-30T18:28:54.340

刚刚更新，现在可能是 The Guy 提到的解决方法，通过 IFRAME，您可以创建一个侧边栏，一个 STUB 只是为了输入键盘命令，用 jquery 处理它们，并运行适当的功能，已经在使用它了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-11-25T07:00:41.887

一种可能的解决方法是为“触发文本”指定一个列，为您尝试执行的每个操作定义不同的基于文本的触发器，然后创建一个检查值并根据“触发文本”。然后，您可以在脚本编辑器的“资源”下的项目触发器中为您的热键功能设置 onEdit 事件触发器。

这种方法的最大缺点是（至少对我而言）onEdit 触发器需要大约 7 秒的时间来捕获更改并执行更新。如果您需要更快地处理某些内容，则可能需要寻找替代方法。

我在下面提供了一个示例，说明如何根据指定的“触发器”列中的触发器文本更改行颜色。您可以使用它来执行任何可以通过脚本在工作表上完成的操作，例如更改值、设置字体粗细、复制数据，甚至在检查触发文本输入后运行其他功能。

```
/*you will need to add an onEdit trigger to your project 
  for this to run when you edit the cell*/

//function to update row color using entered text in a specified "trigger" column

function hotKey(){ 

  //get the cell you edited and the associated column and row number
  var cell = sheet.getActiveCell(); 
  var thisCol = cell.getColumn(); 
  var thisRow = cell.getRow(); 

  //set a range variable for the entire row
  var colorRow = sheet.getRange(thisRow,thisCol,1,Cols); 

  //get the edited value for the cell as a string
  var val = cell.getValue().toString(); 

  //check that the edited cell is in the trigger column
  if (thisCol = 1){

    //update the row color based on the entered value 
    if(val == "g"){ 
      colorRow.setBackground("#00ff00"); //sets row color to green
      cell.clearContent(); //delete the trigger cell value

    }else if(val == "r"){
      colorRow.setBackground("#ff0000");
      cell.clearContent();
    }else if(val == "fd"){
      colorRow.setBackground("#fff2cc");
      cell.clearContent();
    }else if(val == "pr"){
      colorRow.setBackground("#ffff00");
      cell.clearContent();
    }else if(val == "cn"){
      colorRow.setBackground("#6fa8dc");
      cell.clearContent();
    }
  }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-24T03:30:28.367

长话短说：编写一个 html 服务，它使用按键事件处理程序来捕获按键事件并将它们与您想要的热键快捷方式进行比较，然后在应用程序脚本中调用服务器端的适当子例程以内联调用的按键、格式或文件更改。

就可行性而言，它不像您已经熟悉的 vba 那样容易，但是一旦您通过了不同的做事方式，就不是那么困难了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-03-21T19:52:00.427

我正在为类似的问题而苦苦挣扎，虽然我还没有得到太多解决，但我认为可以通过[Class Textbox 下的这个 keypress 事件处理程序找到前进的方向](https://developers.google.com/apps-script/reference/ui/text-box#addKeyPressHandler%28Handler%29)

我不知道这是否仅解决了 Arun 指出的服务器端问题，但我肯定希望如此。在我浪费太多时间尝试这个之前，请随时纠正我的推理！:)

# android - Actionbarsherlock - 标题不显示

> ID：13731590
> 
> 赞同：0
> 
> 时间：2012-12-05T20:13:54.540
> 
> 标签：android, actionbarsherlock

我看过一些关于让标题与图标一起显示在 actionbarsherlock 中的帖子。图标显示正常，但标题旁边没有显示。

目前它显示主页图标及其旁边的所有选项卡。我正在寻找的是主页图标，然后是标题，在所有这些下方都有标签显示。这是我的代码。

**活动**

```
public class MainActivity extends SherlockFragmentActivity {

@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        mJsonHandler = JsonHandler.getInstance(this);
    }

 @Override
    public boolean onCreateOptionsMenu(Menu menu)
    {
        com.actionbarsherlock.view.MenuInflater inflater = getSupportMenuInflater();

        ActionBar ab = getSupportActionBar();

        ab.setDisplayHomeAsUpEnabled(true);
        ab.setDisplayShowTitleEnabled(true);
        ab.setDisplayShowHomeEnabled(true);
        ab.setDisplayUseLogoEnabled(true);

        ab.setTitle("TITLE TO SHOW");

        inflater.inflate(R.menu.activity_main, menu);

        return super.onCreateOptionsMenu(menu);     
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item)
    {
        switch(item.getItemId()) {
        case R.id.menu_item0:

            break;
        case R.id.menu_item1:

            break;
        case R.id.menu_item2:

            break;
        case R.id.menu_item3:

            break;
        case R.id.menu_item4:

            break;
        case R.id.menu_item5:

            break;
        default:
            this.onBackPressed();
            break;
        }
        return false;
    }
} 
```

**activity_main.xml（用于菜单）**

```
<menu xmlns:android="http://schemas.android.com/apk/res/android">

<item
    android:id="@+id/menu_item0"
    android:orderInCategory="1"
    android:showAsAction="always"
    android:title="@string/menu_item0"/>

<item
    android:id="@+id/menu_item1"
    android:orderInCategory="2"
    android:showAsAction="always"
    android:title="@string/menu_item1"/>

<item
    android:id="@+id/menu_item2"
    android:orderInCategory="3"
    android:showAsAction="always"
    android:title="@string/menu_item2"/>

<item
    android:id="@+id/menu_item3"
    android:orderInCategory="4"
    android:showAsAction="always"
    android:title="@string/menu_item3"/>

<item
    android:id="@+id/menu_item4"
    android:orderInCategory="5"
    android:showAsAction="always"
    android:title="@string/menu_item4"/>

 <item
    android:id="@+id/menu_item5"
    android:orderInCategory="6"
    android:showAsAction="always"
    android:title="@string/menu_item5"/> 
```

**显现**

```
<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/Sherlock.Theme" >
    <activity
        android:name=".activities.MainActivity"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
  </application>

</manifest> 
```

**夏洛克主题**

```
<style name="Sherlock.Theme" parent="Theme.Sherlock.Light.DarkActionBar"> 
</style> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:33:07.247

您设置了太多菜单项以`always`显示在`ActionBar`. 您应该只设置最重要的那些。您应该通读 Android 设计指南，了解设置`ActionBar`

[Android 设计指南 - 操作栏组织](http://developer.android.com/design/patterns/actionbar.html#organization)

此外，您应该设置`ActionBar`in`onCreate`和 leave`onCreateOptionsMenu`只为您的菜单充气。这只是一个一般性提示，旨在实现更好、更专业的代码格式。

# wpf - 水平或垂直 WPF 行限制为 125,000 像素？

> ID：13731593
> 
> 赞同：6
> 
> 时间：2012-12-05T20:14:03.173
> 
> 标签：wpf

水平或垂直 WPF 行是否限制为 125,000 像素？查看以下代码，绿线显示正确，但红线根本不显示，尽管只长了 0.01。知道为什么吗？

```
<Window x:Class="DCView.Window11"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window11" Height="300" Width="300">
    <ScrollViewer>
        <Grid Width="150000">
            <Line X1="0" X2="125000.00" Y1="10" Y2="10" StrokeThickness="1" Stroke="Green"></Line>
            <Line X1="0" X2="125000.01" Y1="20" Y2="20" StrokeThickness="1" Stroke="Red"></Line>
        </Grid>     
    </ScrollViewer>
</Window> 
```

安德鲁

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T20:30:50.840

这似乎是 WPF 处理矢量图形的一个限制。

为了使它更复杂，请尝试更改`StrokeThickness`- 如果您将`StrokeThickness`红线的设置`1`为`2`，它会再次显示...直到您将长度增加到 250000 以上。然后它再次消失。

```
<Grid>
    <Line X1="0" X2="125000.00" Y1="10" Y2="10" StrokeThickness="1" Stroke="Green"></Line>
    <Line X1="0" X2="250000.00" Y1="20" Y2="20" StrokeThickness="2" Stroke="Red"></Line>
    <Line X1="0" X2="250000.01" Y1="30" Y2="30" StrokeThickness="2" Stroke="Blue"></Line>
</Grid> 
```

随着笔画粗细的增加，最大长度也会增加。

另请注意，如果线条不是完全水平或垂直的，则长度限制似乎消失了：

```
<Grid>
    <Line X1="0" X2="125000.00" Y1="10" Y2="10" StrokeThickness="1" Stroke="Green" />
    <Line X1="0" X2="125000.01" Y1="20" Y2="20.0001" StrokeThickness="1" Stroke="Red" />
</Grid> 
```

您可以在 connect 上找到写的错误：[Disappearing Path (WPF)](http://connect.microsoft.com/VisualStudio/feedback/details/731467/disappearing-path-wp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:27:44.993

它肯定会绘制超过 150,000 像素，在这种情况下看不到这条线有点奇怪，因为例如如果你这样做

```
<Line X1="0" X2="125000.01" Y1="20" Y2="20" StrokeThickness="2" Stroke="Red"></Line> 
```

或这个

```
<Line X1="0" X2="125000.01" Y1="21" Y2="20" StrokeThickness="1" Stroke="Red"></Line> 
```

一切正常，可能有一个关于为什么的答案，但是很好的发现，因为如果你为 X2 的值设置动画，这会导致明显的闪烁。

# google-app-engine - 向 appengine 发送邮件时电子邮件退回

> ID：13731604
> 
> 赞同：2
> 
> 时间：2012-12-05T20:14:54.940
> 
> 标签：google-app-engine

我已将 appengine 设置为允许传入邮件，如果我的 web.xml 文件包含

```
 <servlet>
    <servlet-name>mailhandler</servlet-name>
    <servlet-class>VerifyReply</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>mailhandler</servlet-name>
    <url-pattern>/_ah/mail/*</url-pattern>
</servlet-mapping>

<security-constraint>
    <web-resource-collection>
        <url-pattern>/_ah/mail/*</url-pattern>
    </web-resource-collection>
    <auth-constraint>
        <role-name>admin</role-name>
    </auth-constraint>
</security-constraint> 
```

它可以工作并运行 VerifyReply servlet，但如果我想将传入的电子邮件限制为仅发送到 verifyreply@... 的电子邮件地址（请注意 url 模式与上述不同）

```
 <servlet>
    <servlet-name>mailhandler</servlet-name>
    <servlet-class>VerifyReply</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>mailhandler</servlet-name>
    <url-pattern>/_ah/mail/v*</url-pattern>
</servlet-mapping>

<security-constraint>
    <web-resource-collection>
        <url-pattern>/_ah/mail/*</url-pattern>
    </web-resource-collection>
    <auth-constraint>
        <role-name>admin</role-name>
    </auth-constraint>
</security-constraint> 
```

它停止工作，我收到一封退回给发件人的电子邮件。我的日志页面显示服务器运行 /_ah/mail/verifyreply@... 但它不运行 servlet 并退回电子邮件。

任何想法，我想我都在遵循[https://developers.google.com/appengine/docs/java/mail/receiving上的指南](https://developers.google.com/appengine/docs/java/mail/receiving)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T13:48:47.640

根据[文档](https://developers.google.com/appengine/docs/java/mail/receiving)，不支持过滤地址：

`When App Engine moved to a standard Java Web Server, the ability to specify richer matching patterns was lost (e.g. one used to be able to specify a url-pattern like /_ah/mail/support*). If such pattern matching is desired, consider using a filter-based approach based on the following code snippets.`

它会认为它是一个错误，指定完整地址确实有效。该页面包含有关如何在邮件处理程序过滤器（servlet 意义上的过滤器）中进行地址匹配的示例。如果您不想接受该消息，您应该匹配那里的地址并返回 404。或者，如果您不关心退回邮件，则可以忽略不想要的邮件。

# android - webview 使用屏幕缩放控件和捏拉缩小重新换行文本，但不使用捏拉放大

> ID：13731606
> 
> 赞同：1
> 
> 时间：2012-12-05T20:14:54.847
> 
> 标签：android, webview

这里发生了一些奇怪的事情......

我的应用程序中有一个 WebView，我正在使用

```
getSettings().setBuiltInZoomControls(true);
getSettings().setUseWideViewPort(true); 
```

在 API 级别 10 的设备上，当我使用内置控件（+ 和 -）进行放大/缩小时，文本会在缩放后自动重新换行，以便它仍然适合屏幕。同样，如果我捏拉缩小（使文本变小），它会自动重新换行。但是如果我捏放大，文本会变大，但不会重新换行。有趣的是，此时双击将重新换行文本。

内置放大控件和双击事件处理的实现内部发生了什么，而捏拉放大处理中没有发生，我可以通过编程方式实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T10:24:25.980

有同样的问题，补充说：

```
 wv.getSettings().setLoadWithOverviewMode(true);
    wv.getSettings().setUseWideViewPort(true); 
```

这应该可以完成工作 - 停止重新包装的东西：\

# java - Android - 自适应比特率流。(HLS) 流的质量

> ID：13731607
> 
> 赞同：4
> 
> 时间：2012-12-05T20:14:58.043
> 
> 标签：java, android, streaming, media-player, http-live-streaming

我是自适应比特率流媒体的新手。基本上，我正在尝试编写一个应用程序来显示有关 Android 设备上连接质量的信息。

从 HoneyComb(3.0) 开始，Android 通过 HTTP Live Streaming (HLS) 支持自适应比特率流式传输。它似乎支持帮助开发人员验证此连接设备端的质量非常有限。

我想知道的是有关流的一些低级信息。如：段数、段时长、请求更改码率的次数、媒体播放器看到的码率（方便更改）等。

[我已经能够从MediaPlayer](http://developer.android.com/reference/android/media/MediaPlayer.html)、 [MediaController](http://developer.android.com/reference/android/widget/MediaController.html)、[MediaMetaDataRetriever](http://developer.android.com/reference/android/media/MediaMetadataRetriever.html)、[CamcorderProfile](http://developer.android.com/reference/android/media/CamcorderProfile.html)、[MediaFormat](http://developer.android.com/reference/android/media/MediaFormat.html)、[MediaExtractor](http://developer.android.com/reference/android/media/MediaExtractor.html)类获得一些关于流质量的信息。但是，我正在寻找的东西甚至更低。如果可能的话，我希望能够真正看到玩家是如何与服务器通信的。

我刚开始查看 MediaCodec 类，但是我不知道如何从媒体播放器获取 MediaCodec。或者也许我只是不知道如何正确使用它，因为我找不到任何好的文档和示例。

有谁知道是否可以访问我正在寻找的 Android 上的低级信息？MediaCodec 是要走的路吗？如果是这样，是否有人有任何工作示例说明我如何获取当前使用的 MediaCodec 并从中提取我正在寻找的信息？（或者至少指出我正确的方向）

非常感谢对此的任何帮助。

干杯

# linux - 从制表符分隔的文件中提取最后一列

> ID：13731610
> 
> 赞同：2
> 
> 时间：2012-12-05T20:15:05.357
> 
> 标签：linux, perl, unix, awk

我在文本文件中有以下数据。

```
10993   39750   11002
10993   39751   10995
10993   39752   48981
10993   39750   344417  79600
10985   39750   344417  475879
110010  39750   59816 
```

我可以使用哪些 unix 命令来执行诸如“SELECT LAST_COLUMN WHERE FIRST_COLUMN = '10993'”之类的操作，那么结果将是：

```
11002
10995
48981
79600 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-05T20:18:09.207

不知道，`perl`但这里有一个`awk`解决方案：

```
awk '$1==10993 {print $NF}' file
11002
10995
48981
79600 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T20:57:38.120

Perl 有一个奇怪的自动[拆分模式](http://perldoc.perl.org/perlrun.html#%2a-a%2a)，可以简单地解决您的问题。

> **-一种**
> 
> `-n`与 a或一起使用时打开自动拆分模式`-p`。对数组的隐式拆分命令是在or`@F`产生的隐式 while 循环中的第一件事。`-n``-p`
> 
> ```
> perl -ane 'print pop(@F), "\n";' 
> ```
> 
> 相当于
> 
> ```
> while (<>) {
>     @F = split(' ');
>     print pop(@F), "\n";
> } 
> ```
> 
> 可以使用 指定备用分隔符`-F`。

让它在你的情况下工作看起来像

```
$ perl -lane 'print $F[-1] if $F[0] == 10993' input
11002
10995
48981
79600 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T09:58:47.120

我不认为当你可以使用命令行时，你应该更喜欢它的脚本。

```
perl -F -lane 'if($F[0]==10993){print $F[(scalar @F)-1]}' your_file 
```

测试如下：

```
> cat temp
10993   39750   11002
10993   39751   10995
10993   39752   48981
10993   39750   344417  79600
10985   39750   344417  475879
110010  39750   59816
> perl -F -lane 'if($F[0]==10993){print $F[(scalar @F)-1]}' temp
11002
10995
48981
79600 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T20:19:48.827

许多可能的方法之一是 awk：

```
awk '-F\t' 'if ($1 == "wanted-first-column-value") { print $NF }' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-05T20:22:51.710

看到你用 perl 标记了你的问题，这里有一些例子：

在 perl 中硬编码：

```
#!/usr/bin/perl
use warnings;
use strict;

open INFILE,"<somefilename";
while (<INFILE>)
{
    my @cols = split(/\s+/,$_);
    if ($cols[0] eq '10993') {      print $cols[-1] . "\n"; }
} 
```

再次使用 perl，但取而代之的是从 STDIN 获取它，因此您可以将输出通过管道传输到它：

```
#!/usr/bin/perl
use warnings;
use strict;

while (<>)
{
    my @cols = split(/\s+/,$_);
    if ($cols[0] eq '10993') {      print $cols[-1] . "\n"; }
} 
```

perl 中的另一个示例，将文件名作为第一个参数，将所需的第一个字段作为第二个参数：

```
#!/usr/bin/perl
use warnings;
use strict;

unless ($ARGV[0])    { die "No filename specified\n" }
unless ($ARGV[1])    { die "No required field specified\n" }
unless (-e $ARGV[0]) { die "Can't find file $ARGV{0]\n" }
open INFILE,"<ARGV{0]";
while (<INFILE>)
{
    my @cols = split(/\s+/,$_);
    if ($cols[0] eq $ARGV[1]) {     print $cols[-1] . "\n"; }
} 
```

但是，只使用 awk 可能更容易：

```
awk '{if ($1 == 10993) {print $NF}}' someFileName 
```

# dynamic-programming - 动态规划：自上而下与自下而上的比较

> ID：13731612
> 
> 赞同：5
> 
> 时间：2012-12-05T20:15:18.200
> 
> 标签：dynamic-programming

您能否指出一些自下而上比自上而下更有益的动态编程问题陈述？（即简单的 DP 更自然地工作，但记忆化会更难实现？）

我发现使用记忆的递归要容易得多，并且希望解决自下而上是更好/也许唯一可行的方法的问题。

我知道理论上两者都是等价的，所以即使是易于实现之类的东西也可以算作好处。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-13T06:30:13.907

您将根据手头的问题应用自下而上的记忆或自上而下的记忆递归。

例如，如果您必须找到路径图的最小权重无关路径，您将使用自下而上的方法，因为您必须解决所有可能的子问题。

但是如果你必须解决背包问题，你可能想使用递归自上而下的记忆，因为你必须解决有限数量的子问题。自下而上处理背包问题将导致算法解决许多原始子问题中未使用的冗余问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-12-06T08:26:00.593

决定使用哪种算法时要考虑的两件事

1.  时间复杂度。**两种方法通常具有相同的时间复杂度，但因为 for 循环比递归函数调用便宜，如果以机器时间**来衡量，自底向上可以更快。
2.  空间复杂性。（在自顶向下时不考虑额外的调用堆栈分配）通常两种方法都需要为所有子解决方案建立一个表，但自底向上遵循拓扑顺序，它的辅助空间成本有时可以减少到问题的大小直接依赖。例如：`fibonacci(n) = fibonacci(n-1) + fibonacci(n-2)`，我们只需要存储过去的两次计算

话虽如此，自下而上并不总是最好的选择，我将尝试举例说明：

1.  （@Nikunj Banka 提到）自上而下仅解决您的解决方案使用的子问题，而自下而上可能会在冗余子问题上浪费时间。一个愚蠢的例子是[0-1 背包](http://www.geeksforgeeks.org/knapsack-problem/)和 1 件物品......运行时间差是 O(1) 与 O(重量)
2.  您可能需要执行额外的工作才能获得自下而上的拓扑顺序。在[Matrix 中的最长增加路径中](http://www.geeksforgeeks.org/longest-increasing-path-matrix/)，如果我们想在它们的依赖关系之后处理子问题，我们必须按降序对矩阵的所有条目进行排序，这是`nmlog(nm)`DP 之前的额外预处理时间

# c# - C# .Net 中的参数化 SQL

> ID：13731613
> 
> 赞同：1
> 
> 时间：2012-12-05T20:15:19.090
> 
> 标签：c#, .net, sql, .net-3.5, ado.net

如果我有这样的代码：

```
public T ExecuteQuery<T>(Func<IDataReader, T> getResult, string query, params IDataParameter[] parameters)
{
        using (SqlConnection conn = new SqlConnection(this.DefaultConnectionString))
        {
            conn.Open();

            // Declare the parameter in the query string
            using (SqlCommand command = new SqlCommand(query, conn))
            {
                foreach (var parameter in parameters)
                {
                    command.Parameters.Add(parameter);
                }

                command.Prepare();

                using (SqlDataReader dr = command.ExecuteReader())
                {
                    return getResult(dr);
                }
            }
        }
    }

    public string GetMySpecId(string dataId)
    {
        return ExecuteQuery(
            dr =>
            {
                if (dr.Read())
                {
                    return dr[0].ToString();
                }

                return string.Empty;
            },
            @"select ""specId"" from ""MyTable"" where ""dataId"" = :dataId",
            new SqlParameter("dataId", dataId));
    }
} 
```

我如何确保

```
new SqlParameter("dataId", dataId)); 
```

一段代码是在传递一个文本还是一个整数？还有`@"select..."`我熟悉的实际工作方式：

```
 select id from mytable where dataId = @dataID; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:30:23.877

我不确定参数是否正确。看看下面修改过的代码，它将确保正确添加参数并简化调用的构造`ExecuteQuery`（当然在我看来）。这很简单。select 语句已正确参数化，因为它使用以下`@varname`语法：

```
"select \"specId\" from \"MyTable\" where \"dataId\" = @dataId" 
```

此外，由于该方法，参数输入正确`AddWithValue`：

```
command.Parameters.AddWithValue(parameter.Key, parameter.Value); 
```

最后，使用字典发送参数使得从任何结构构造参数变得非常简单，无论是参数值，甚至是对象。

```
public T ExecuteQuery<T>(Func<IDataReader, T> getResult, string query, Dictionary<string, object> parameters)
{
    using (SqlConnection conn = new SqlConnection(this.DefaultConnectionString))
    {
        conn.Open();

        // Declare the parameter in the query string
        using (SqlCommand command = new SqlCommand(query, conn))
        {
            foreach (var parameter in parameters)
            {
                command.Parameters.AddWithValue(parameter.Key, parameter.Value);
            }

            command.Prepare();

            using (SqlDataReader dr = command.ExecuteReader())
            {
                return getResult(dr);
            }
        }
    }
}

public string GetMySpecId(string dataId)
{
    return ExecuteQuery(
        dr =>
        {
            if (dr.Read())
            {
                return dr[0].ToString();
            }

            return string.Empty;
        },
        "select \"specId\" from \"MyTable\" where \"dataId\" = @dataId",
        new Dictionary<string, object>() { { "@dataId", dataId } });
} 
```

PS -`@`您示例中的字符串之前只是 C# 中使用的转义序列。

# ruby-on-rails - 如何在 Heroku 中设置额外的服务器？

> ID：13731619
> 
> 赞同：0
> 
> 时间：2012-12-05T20:16:13.850
> 
> 标签：ruby-on-rails, heroku, heroku-toolbelt

我想为 QA 目的设置一个新的 Heroku 服务器。我已经完成了大部分工作，但我错过了一些东西：

1) 我使用 CLI Heroku 工具带制作了一个新应用程序：

```
heroku apps:create myapp-qa 
```

2) 我在本地机器上复制了现有的 git 存储库：

```
git clone git@github.com:me/myapp.git 
```

3）为aq服务器添加了远程：

```
git remote add myapp-qa git@github.com:myrepo/myapp.git 
```

3）然后我尝试通过以下方式推送我的新应用程序：

```
cd myapp

git push myapp-qa master 
```

我收到消息“已经是最新的”

4) 如果我在浏览器中访问应用程序[http://myapp-qa.herokuapp.com/](http://myapp-qa.herokuapp.com/)，它会显示“Heroku | 欢迎使用您的新应用程序！” 而不是显示我的任何应用程序页面。

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T00:32:33.390

Heroku 有一个专门为此设计的插件。

[https://github.com/heroku/heroku-pipeline](https://github.com/heroku/heroku-pipeline)

它允许您指定服务器的“管道”

`Dev -> Staging -> Production`并允许您部署到开发，然后将该构建提升到登台，然后将其提升到生产。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:37:37.627

设置需要：

```
git remote add myapp-qa git@heroku.com:myapp-qa.git

git push origin myapp-qa 
```

# r - 使用 stepAIC 进行样本预测

> ID：13731621
> 
> 赞同：1
> 
> 时间：2012-12-05T20:16:20.667
> 
> 标签：r, linear-regression, predict

刚刚有一个关于使用 Step AIC 进行预测的快速问题。我是R的初学者，所以如果解决方案很明显，请原谅。尝试四处寻找，但无法真正找到我要找的东西。

所以我试图预测响应变量，在主模型上运行逐步 AIC 之后（主模型具有所有解释变量）。stepAIC 给出了一个变量数量减少的新模型。我的问题是如何使用新的简化模型进行样本外预测。换句话说，我如何减少数据集，以便当我将其输入 predict.lm 时，它只有在减少模型中选择的变量。

下面是我的代码：

* * *

```
# Specify start and end row of the first 5 year window
start_row=1
end_row=60

#declare matrix that will contain the predicted returns by specifying dimensions
predicted=matrix(0,179,7)

y_var=as.matrix(orig_data[start_row:end_row,2:7])
x_var=as.matrix(orig_data[start_row:end_row,8:27])

# Perform linear regression on all factors and then select factors using stepwise AIC     method

initial_model<-    lm(y_var[,1]~x_var[,1]+x_var[,2]+x_var[,3]+x_var[,4]+x_var[,5]+x_var[,6]+x_var[,7]+x_var[,8]+x_var[,9]+x_var[,10]+x_var[,11]+x_var[,12]+x_var[,13]+x_var[,14]+x_var[,15]+x_var[,16]+x_var[,17]+x_var[,18]+x_var[,19]+x_var[,20])

reduced_model<-stepAIC(initial_model, direction="both")
reduced_coefs<-t(as.matrix(coef(reduced_model)))
x_input<-as.matrix(x_var[60,]) 
```

* * *

基本上我如何将从简化模型中得到的系数乘以“x_var”中的相应解释变量（它具有所有解释变量）

非常感谢你的帮助！

# django - 模型的django实现

> ID：13731624
> 
> 赞同：1
> 
> 时间：2012-12-05T20:16:23.840
> 
> 标签：django, model, foreign-keys

我必须在 django 项目中实现两个模型 --> Country 和 Continent。可以从使用这两个表填充数据库的 XML 文件中导入有关国家和大洲的所有信息。

我已经以这种方式实现了它们

```
from django.db import models

    class Continent(models.Model):
        name = models.CharField(max_length=255, unique=True)
        code = models.CharField(max_length=255, unique=True)
        countries = ?

        class Meta:
            ordering = ['name']

    class Country(models.Model):
        name = models.CharField(max_length=255)
        capital = models.CharField(max_length=255)
        code = models.CharField(max_length=255, unique=True)
        population = models.IntegerField(default=0)
        area = models.IntegerField(default=0)
        continent = models.ForeignKey(Continent)

        class Meta:
            ordering = ['name'] 
```

你可以看到一个？在 Continent.countries 中标记，因为我不明白如何实现它。问题是：“一个大陆的国家应该可以通过 Continent 类的属性国家访问”

这意味着可以这样做：

```
from MyApplication.model import Country, Continent
europe = Continent.object.get(code=u'eu')
finland = europe.countries.get(code=u'fi') 
```

我试过`models.ForeignKey`了，但它不起作用。它说“Nonetype 对象没有任何 get 方法”有人可以帮我吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:20:45.600

Django 不直接支持一对多，相反，您可以使用一对一关系的反向来获得一对多关系。

因此，通过在与大陆相关的国家/地区添加外键来继续使用多对一的另一种方法。现在，您可以一对一地从国家到大陆。接下来，从 's 对象进行反向查询`Continent`以获得所需的关系。看一看：

```
class Continent(models.Model):
    ...

class Country(models.Model):
    ...
    continent = models.ForeignKey(Continent, related_name="countries")
    ...

europe = Continent.object.get(code=u'eu')
finland = europe.countries.get(code=u'fi') 
```

# css - 1140格ipad头像

> ID：13731626
> 
> 赞同：1
> 
> 时间：2012-12-05T20:16:32.430
> 
> 标签：css, responsive-design

我正在尝试使用 cssgrid.net 中的 1140 网格，但遇到了问题。在 768px - 795px 之间的屏幕上，.container div 上的右填充不起作用。相反，内容开始与浏览器窗口的右边缘对接。我在 Mac 上使用最新版本的 Chrome 浏览我的网站（这个范围的主要问题是纵向的 iPad 是 768 像素）。

[cssgrid.net](http://cssgrid.net)上似乎也发生了同样的事情，右上角的“下载”按钮。

[我在我正在处理的网站](http://future.thefutureforward.com/~conant/sliced/)上提出了一个临时解决方法，将这种大小的屏幕上的填充更改为 5px 而不是 1140.css 中的 20：

```
@media only screen and (min-width : 768px) and (max-width : 795px){ 
.container{ padding-left: 5px; padding-right: 5px; } 
} 
```

但这似乎是一个不必要的工作（我更希望有 20px 的填充，因为 5 有点接近舒适）。

如果您对此有任何见解，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T05:01:51.553

问题在于最小宽度。将此添加到网格样式

```
@media only screen and (max-width: 1023px) {
    .row {
        min-width: 720px;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T21:59:38.403

这是一个丑陋的修复，但您可以使用 php 检查用户是否在 iPad 上，然后将其更改`viewport`为 1024px 宽。将您当前的视口元标记替换为以下内容：

```
<?
    $is_ipad = false;
    // check if user agent is an iPad
    if ( strpos($_SERVER['HTTP_USER_AGENT'],'iPad') ){
        $is_ipad = true;
    }

    // if it's an ipad, set viewport to 1024px wide
    if ($is_ipad){
        echo '<meta name = "viewport" content="width=1024">';
    }

    // if not an ipad, use device width
    else {
        echo '<meta name="viewport" content="width=device-width">';
    }

?> 
```

# git - 合并不同语言的 git 存储库

> ID：13731628
> 
> 赞同：0
> 
> 时间：2012-12-05T20:16:38.687
> 
> 标签：git, github

> **可能重复：**
> [组合多个 git 存储库](https://stackoverflow.com/questions/277029/combining-multiple-git-repositories)

我正在将应用程序从 PHP 重新编码为 Ruby。有没有办法合并两个存储库，同时保留每个版本的提交？理想情况下，它会是这样的

**[红宝石存储库]**

```
commit 1
commit 2
commit 3
... 
```

**[php 存储库]**

```
...
commit 54
commit 55
commit 56 
```

**[新存储库]**

```
...
commit 54
commit 55
commit 56
commit 1
commit 2
commit 3
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T21:38:49.117

只需在 php/master 之上 rebase ruby​​/master：

```
git rebase php/master ruby/master 
```

# dart - 在 Dart 中创建具有可变数量的参数或参数的函数

> ID：13731631
> 
> 赞同：43
> 
> 时间：2012-12-05T20:16:49.963
> 
> 标签：dart

我正在寻找一种在 Dart 中创建具有可变数量的参数或参数的函数的方法。我知道我可以创建一个数组参数，但我不想这样做，因为我正在开发一个语法简洁很重要的库。

例如，在纯 JavaScript 中，我们可以做这样的事情（从[这里](http://terrainformatica.com/sciter/js-dart-tis.htm)借用）：

```
function superHeroes() {
  for (var i = 0; i < arguments.length; i++) {
    console.log("There's no stopping " + arguments[i]);
  }
}

superHeroes('UberMan', 'Exceptional Woman', 'The Hunk'); 
```

但是，在 dart 中，该代码不会运行。有没有办法在飞镖中做同样的事情？如果不是，这是路线图上的内容吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-12-05T21:07:15.440

你暂时不能这样做。

我真的不知道*varargs*是否会回来——它们之前就在那里，但[已被删除](https://groups.google.com/a/dartlang.org/d/msg/misc/0cQZpHs5D-g/NrKOuizLnqEJ)。

但是，可以使用[Emulating functions来模拟](http://www.dartlang.org/articles/emulating-functions/)*varargs*。请参阅下面的代码片段。

```
typedef OnCall = dynamic Function(List arguments);

class VarargsFunction {
  VarargsFunction(this._onCall);

  final OnCall _onCall;

  noSuchMethod(Invocation invocation) {
    if (!invocation.isMethod || invocation.namedArguments.isNotEmpty)
      super.noSuchMethod(invocation);
    final arguments = invocation.positionalArguments;
    return _onCall(arguments);
  }
}

main() {
  final superHeroes = VarargsFunction((arguments) {
    for (final superHero in arguments) {
      print("There's no stopping ${superHero}");
    }
  }) as dynamic;
  superHeroes('UberMan', 'Exceptional Woman', 'The Hunk');
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2020-05-26T18:20:31.313

Dart 确实间接支持 var-args，只要您不太注重语法简洁性。

```
void testFunction([List<dynamic> args=[]])
{
  for(dynamic arg:args)
  {
    // Handle each arg...
  }
}

testFunction([0, 1, 2, 3, 4, 5, 6]);
testFunction();
testFunction([0, 1, 2]); 
```

**注意：**您可以对命名参数执行相同的操作，但您必须在内部处理事情，以防万一用户（该函数的用户；可能是您）决定不向该命名参数传递任何值。

* * *

我要感谢@Ladicek 间接让我知道英语中存在像 **简洁**这样的词。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-12-05T23:17:03.023

我对 Alexandre Ardhuin 的回答进行了一些尝试，发现我们可以调整一些东西以使其在当前版本的 Dart 中工作：

```
class VarArgsClass {
  noSuchMethod(InvocationMirror invocation) {
    if (invocation.memberName == 'superheroes') {
      this.superheroes(invocation.positionalArguments);
    }
  }

  void superheroes(List<String> heroNames) {
    for (final superHero in heroNames) {
      print("There's no stopping ${superHero}!");
    }
  }
}

main() {
  new VarArgsClass().superheroes('UberMan', 'Exceptional Woman', 'The Hunk');
} 
```

这有很多问题，包括：

*   `superheroes()`由于签名与您的参数不匹配，因此无论您在哪里调用都会生成警告。
*   需要进行更多的手动检查，以确保传递给超级英雄的参数列表确实是`List<String>`.
*   如果您更改方法名称，则需要检查成员名称`noSuchMethod()`使得您更有可能忘记更改“超级英雄”字符串。
*   反射使代码路径更难追踪。

但是，如果您对所有这些问题都满意，那么就可以完成工作。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-10-30T14:01:48.393

这个版本：

1.  适用于位置和关键字参数。
2.  支持输入返回值。
3.  适用于现代飞镖。

```
typedef VarArgsCallback = void Function(List<dynamic> args, Map<String, dynamic> kwargs);

class VarArgsFunction {
  final VarArgsCallback callback;
  static var _offset = 'Symbol("'.length;

  VarArgsFunction(this.callback);

  void call() => callback([], {});

  @override
  dynamic noSuchMethod(Invocation inv) {
    return callback(
      inv.positionalArguments,
      inv.namedArguments.map(
        (_k, v) {
          var k = _k.toString();
          return MapEntry(k.substring(_offset, k.length - 2), v);
        },
      ),
    );
  }
}

void main() {
    dynamic myFunc = VarArgsFunction((args, kwargs) {
      print('Got args: $args, kwargs: $kwargs');
    });
    myFunc(1, 2, x: true, y: false); // Got args: [1, 2], kwargs: {x: true, y: false}
} 
```

谢谢，亚历山大的[回答](https://stackoverflow.com/a/13732459/7061265)！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-06T05:21:58.760

如果您真的很喜欢简洁的语法，只需声明一个带有 10 个可选位置参数的函数/方法即可。不太可能有人会用超过 10 个参数来调用它。

如果它听起来像一个黑客，那是因为它*是*一个黑客。但我看到 Dart 团队也在做同样的事情 :-)

*例如*：

```
void someMethod(arg0, [arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9]) {
  final args = [arg0, arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9];

  args.removeWhere((value) => value == null);

  /* do something the the args List */
  print(args);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-12-05T23:01:13.123

对于您编写的示例，我认为您最好使用列表。对于那个很抱歉！

我正在查看 dartbug.com，但我没有看到对此的功能请求。绝对欢迎您创建一个！

# xcode - 在 Xcode Core Data 中一对多添加多个对象

> ID：13731634
> 
> 赞同：0
> 
> 时间：2012-12-05T20:16:54.443
> 
> 标签：xcode, core-data, one-to-many

我在核心数据中有两个元素：

*   新闻（包括主题、消息、日期等项目）
*   图片（有一项：链接到图片网址）

每条新闻都可以有多张图片（即一对多的关系）。

在 Xcode 中，元素设置正确。

我使用 XML 导入新闻数据。在每个新闻项目上，我都有两个数组：

*   `newsArray`
*   `ImageArray`

`newsArray`加载了 News 元素的所有信息。`imageArray`加载了属于该新闻元素的图像的 URL 。

我已经整理了如何将newsArray的信息放入Core Data，但我的问题如下：

如何将`imageArray`与我刚刚添加的新闻项目相关的对象输入并保存到 Core Data Pictures 元素中？

我现在使用一些代码来保存新闻元素，但它有点过载 XML 加载内容等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T10:50:11.667

您遍历您的`imageArray`并将图像作为关系一一添加到新闻项目中。在生成`NSManagedObject`子类时，Xcode 应该会自动为您创建这些 setter 和 accessor 方法：

```
for (NSDictionary *d in imageArray) {
  Image *i = [NSEntityDescription insertNewObjectForEntityForName:@"Image"
      inManagedObjectContext:_managedObjectContext];
  i.url = d[@"imageURL"];
  [newsItem addImagesObject:i];  // Xcode generated method
}
// save 
```

# jquery - jQuery：是否可以从常规列表创建选项卡？

> ID：13731636
> 
> 赞同：0
> 
> 时间：2012-12-05T20:17:03.227
> 
> 标签：jquery

我是 jQuery 和 JS 的新手，并试图弄清楚是否可以从基本的无序列表创建简单的选项卡。我有以下动态生成的 HTML（我无法更改列表标记，但可以插入按钮标记）。

我读过的所有选项卡教程都只讨论了对按钮使用无序列表，对选项卡本身使用 div。`li`是否可以使用 parent s 作为选项卡并使用 s 作为按钮以相反的方式执行此操作`div`？

```
<div>tab 1</div>
<div>tab 2</div>
<div>tab 3</div>

<ul id="lists">
  <li>
    <h2>Title 1</h2>
    <ul>
      <li>An item</li>
      <li>An item</li>
      <li>An item</li>
    </ul>
  </li>
  <li>
    <h2>Title 2</h2>
    <ul>
      <li>An item</li>
      <li>An item</li>
      <li>An item</li>
    </ul>
  </li>
  <li>
    <h2>Title 3</h2>
    <ul>
      <li>An item</li>
      <li>An item</li>
      <li>An item</li>
    </ul>
  </li>
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:25:51.667

HTML

```
<div class="tab">tab 1</div>
<div class="tab">tab 2</div>
<div class="tab">tab 3</div>

<ul id="lists">
<li>
  <ul>
    <li><h2>Title 1</h2></li>
    <li>An item</li>
    <li>An item</li>
    <li>An item</li>
  </ul>
</li>
<li>
  <ul>
    <li><h2>Title 2</h2></li>
    <li>An item</li>
    <li>An item</li>
    <li>An item</li>
  </ul>
</li>
<li>
  <ul>
    <li><h2>Title 3</h2></li>
    <li>An item</li>
    <li>An item</li>
    <li>An item</li>
  </ul>
</li>
</ul> 
```

CSS

```
.tab {
  display: inline-block;
}

#lists {
  margin: none;
  padding: none;
}

#lists > li {
  list-style: none;
  margin: none;
  padding: none;
  display: none;
} 
```

Javascript (jQuery)

```
var tabs = $('#lists>li');

$('.tab').click(function (e) {
  e.preventDefault();
  var current_tab = tabs.eq($(this).index()).show();
  tabs.not(current_tab).hide();
}); 
```

# c - C、时间、月份、年份等

> ID：13731638
> 
> 赞同：3
> 
> 时间：2012-12-05T20:17:12.577
> 
> 标签：c, time, cross-platform

我有问题。我需要获取诸如一年中的某天、某月的某天、某年的某月等。我使用以下代码：

```
#include <stdio.h>
#include <time.h>
int main(void)
{    
    time_t liczba_sekund;
    struct tm strukt;
    time(&liczba_sekund);
    localtime_r(&liczba_sekund, &strukt); 
    printf("today is %d day of year\nmonth is %d, month's day %d\n", strukt.tm_yday+1, strukt.tm_mon+1, strukt.tm_mday); 
    return 0;
} 
```

第一件事：为什么 gcc -std=c99 -pedantic -Wall 返回这个警告：

我的输入： gcc test_data.c -o test_data.out -std=c99 -pedantic -Wall

输出：

test_data.c：在函数'main'中：

test_data.c:11:3：警告：函数“localtime_r”的隐式声明 [-Wimplicit-function-declaration]

第二件事：如何使它在Windows上工作？在尝试使用 Dev-C 编译它时，我得到了这个：http: [//imgur.com/U7dyE](http://imgur.com/U7dyE)

@@EDIT -------------------- 我为您的本地时间建议找到了一个示例：

```
#include <stdio.h>
#include <time.h>

int main ()
{
    time_t time_raw_format;
    struct tm * ptr_time;

    time ( &time_raw_format );
    ptr_time = localtime ( &time_raw_format );
    printf ("Current local time and date: %s", asctime(ptr_time));
    return 0;
} 
```

如何将其更改为如下日期格式：5.12.2012 或 5-12-2012？以及如何获得一年中的一天？

如果该解决方案同时适用于 Windows 和 linux，我会很高兴。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-05T20:20:55.060

`localtime_r`不是 C 标准的一部分。也许你在找[`localtime`](http://en.cppreference.com/w/c/chrono/localtime)？

[`localtime_r`](http://linux.die.net/man/3/localtime_r)在许多 linux 系统上确实可用：

> 线程安全版本 asctime_r()、ctime_r()、gmtime_r() 和 localtime_r() 由 SUSv2 指定，从 libc 5.2.5 开始可用

但是，由于它不是标准的一部分，因此您不能在 Windows 上使用它。

> 如何将其更改为如下日期格式：5.12.2012 或 5-12-2012？以及如何获得一年中的一天？

您必须使用[`strftime`](http://en.cppreference.com/w/c/chrono/strftime)而不是`asctime`：

```
int main ()
{
    time_t time_raw_format;
    struct tm * ptr_time;
    char buffer[50];

    time ( &time_raw_format );
    ptr_time = localtime ( &time_raw_format );
    if(strftime(buffer,50,"%d.%m.%Y",ptr_time) == 0){
        perror("Couldn't prepare formatted string");
    } else {
        printf ("Current local time and date: %s", buffer);
    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:29:36.947

Windows 上的本地时间应该是线程安全的：http: [//msdn.microsoft.com/en-us/library/bf12f0hc%28VS.80%29.aspx](http://msdn.microsoft.com/en-us/library/bf12f0hc%28VS.80%29.aspx)

> 32 位和 64 位版本的 gmtime、mktime、mkgmtime 和 localtime 都对每个线程使用单个 tm 结构进行转换。对这些例程之一的每次调用都会破坏前一次调用的结果。

# objective-c - 在 annotation 和 MKMapView 之间添加一个 CAShapeLayer

> ID：13731639
> 
> 赞同：0
> 
> 时间：2012-12-05T20:17:13.397
> 
> 标签：objective-c, ios, mkmapview, mkannotation, cashapelayer

我正在尝试在 MKMapView 的注释下方添加动画，但没有运气。我尝试更改 CAShapeLayer zPosition，但圆圈最终位于地图下方。这是我当前将动画添加到地图的代码：

```
int radius = 55;
CAShapeLayer *circle = [CAShapeLayer layer];

circle.path = [UIBezierPath bezierPathWithRoundedRect:CGRectMake(0, 0, 2.0*radius, 2.0*radius)
                                         cornerRadius:radius].CGPath;

circle.position = CGPointMake(CGRectGetMidX(self.view.frame)-radius,
                              CGRectGetMidY(self.view.frame)-radius);

circle.fillColor = [UIColor clearColor].CGColor;
circle.strokeColor = [UIColor blackColor].CGColor;
circle.lineWidth = radius*2;
circle.opacity = 0.5;

[self.mapView.layer addSublayer:circle];

CABasicAnimation *drawAnimation = [CABasicAnimation animationWithKeyPath:@"strokeEnd"];
drawAnimation.duration            = 2.5; // "animate over 10 seconds or so.."
drawAnimation.repeatCount         = 100.0;  // Animate only once..
drawAnimation.removedOnCompletion = YES;   // Remain stroked after the animation..

drawAnimation.fromValue = [NSNumber numberWithFloat:0.0f];
drawAnimation.toValue   = [NSNumber numberWithFloat:1.0f];

functionWithName:kCAMediaTimingFunctionEaseIn];

[circle addAnimation:drawAnimation forKey:@"drawCircleAnimation"]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T18:46:14.120

在 3 天没有答案后，我决定从 mkview 中删除我的注释，并将动画和与注释对应的图像放在地图上方的另一个视图中。

# javascript - 使用按钮将标签添加到输入字段

> ID：13731649
> 
> 赞同：0
> 
> 时间：2012-12-05T20:18:27.220
> 
> 标签：javascript, jquery, html, input, tags

我正在使用一个名为 WP User Frontend 的 Wordpress 插件。基本上它允许用户从网站的前端发布。

有一个功能允许用户自己添加标签，但是，这只是一个普通的输入文本字段，我不希望他们创建无数的新标签。

**所以基本上我想要的是让他们能够点击几个按钮，这些按钮会将标签添加到输入字段，同时也禁用他们的手动输入。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T01:37:04.820

您将需要一个脚本，将复选框输入转换为原始标签输入所需的任何格式（例如，由空格分隔的字符串）。这是一个示例脚本，它将复选框插入到原始输入下方的页面中，并将结果值放入原始字段中，确保以相同的方式发布。（如果您不想显示原始字段，则可以隐藏它。）[http://jsfiddle.net/zLVTp/8/](http://jsfiddle.net/zLVTp/8/)

```
var tags = ['cows', 'sheep', 'dogs'],
    inp, label, ch = document.createElement('fieldset'),
    f = document.getElementById('tagField'); 
        // ^ The original input has id=tagField
f.readOnly = true;
for (var i = 0; i < tags.length; i++) {
    inp = document.createElement('input');
    label = document.createElement('label');
    label.innerHTML = tags[i];
    label.htmlFor = 'tag_' + tags[i];
    inp.type = "checkbox";
    inp.name = "tagSet";
    inp.className = 'tagCBs';
    inp.value = tags[i];
    inp.id = 'tag_' + tags[i];
    ch.appendChild(inp);
    ch.appendChild(label);
    inp.onchange = (function() {
        var th = inp;
        return function() {
            var sp, r = [];
            if (th.checked && f.value.indexOf(th.value) == -1) {
                if (f.value == '') f.value = th.value;
                else f.value += ' ' + th.value;
            }
            else if (!th.checked) {
                sp = f.value.split(' ');
                for (var j = 0; j < sp.length; j++) {
                    if (sp[j] != th.value) r.push(sp[j]);
                }
                f.value = r.join(' ');
            }
        }
    })();
}
f.parentNode.appendChild(ch);​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T22:04:09.047

html 复选框似乎符合您的需要，不是吗？您必须修改表单并用复选框替换文本区域（脏但简单）

# javascript - 根据页面中的某些条件插入 css

> ID：13731650
> 
> 赞同：1
> 
> 时间：2012-12-05T20:18:29.763
> 
> 标签：javascript, css

我有一个页面可以在 sharepoint 中作为弹出窗口。现在我可以使用这个 javascript 来识别它是否是一个弹出窗口 if ( `window.location.search.match("[?&]IsDlg=1")`) 但我无法弄清楚如何插入一些基于 css如果这个条件为真。

我想的一种方法是在页面中有一个标签，然后使用后面的代码来识别条件并插入 css，但我也想通过 javascript 检查这是否可能。有人可以指导我。

我想我可以像这样用 jQuery 做一些事情

```
$('<style type="text/css">#foo { background: #000; } </style>').appendTo("head"); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:22:10.633

不确定我是否理解您的问题，也许您可​​以显示一些代码？使用 jQuery，您可以像这样设置 css：

```
$('.my-div').css('display','block'); 
```

或者您可以只编写 css 并将其放入样式表中，然后在元素上设置类，如下所示：

```
$('.my-div').addClass('yellow-border'); 
```

# java - 如何在每一行的新行中获取 settext 输出？

> ID：13731651
> 
> 赞同：0
> 
> 时间：2012-12-05T20:18:29.093
> 
> 标签：java, android

我有这段代码，它以文本格式从网上获取日期。

这是我的代码

```
package com.zv.android;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.MalformedURLException;
import java.net.URL;

import android.app.Activity;
import android.os.Bundle;
import android.widget.TextView;

public class ZipActivity extends Activity {

    TextView textMsg, textPrompt;
    final String textSource = "https://docs.google.com/spreadsheet/pub?key=0iojoI1OogsdiojdsiosdSdzZlbmZqOHdijoQkE&single=true&gid=0&range=A2%3AA200&output=txt";

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        textPrompt = (TextView)findViewById(R.id.textprompt);
        textMsg = (TextView)findViewById(R.id.textmsg);

        textPrompt.setText("Wait...");

        URL CPSE;
        try {
            CPSE = new URL(textSource);
            BufferedReader bufferReader = new BufferedReader(new InputStreamReader(CPSE.openStream()));
            String StringBuffer;
            String stringText = "";
            while ((StringBuffer = bufferReader.readLine()) != null) {
                stringText += StringBuffer;
            }
            bufferReader.close();
            textMsg.setText(stringText);
        } catch (MalformedURLException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            textMsg.setText(e.toString());
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            textMsg.setText(e.toString());
        }

        textPrompt.setText("Finished!");

    }
} 
```

我在 Google 电子表格上有文本文件。它会自动更新。

我能够将数据获取到 android 应用程序，但它以单行而不是换行符输出所有内容，因为它在电子表格中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:27:35.370

`\n`在您阅读的每一行之后附加换行符

```
 while ((StringBuffer = bufferReader.readLine()) != null) {
            stringText += StringBuffer + "\n";
 } 
```

# java - 在 xml 编组期间保留

> ID：13731652
> 
> 赞同：1
> 
> 时间：2012-12-05T20:18:38.003
> 
> 标签：java, xml, jaxb, marshalling, xsl-fo

我通过编组 xsd 来生成 xml，并且我有 xsl-fo 来生成 pdf。我有一个必须分解为新行的描述字段。类似于此线程中的内容[在使用 <xsl:value-of> 从 XSL FO 生成的 PDF 中插入换行符](https://stackoverflow.com/questions/3661483/inserting-a-line-break-in-a-pdf-generated-from-xsl-fo-using-xslvalue-of)

这是我要编组的代码

```
JAXBContext context = JAXBContext.newInstance(List.class);
            Marshaller m = context.createMarshaller();
            m.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, Boolean.TRUE);
            m.setProperty("com.sun.xml.bind.xmlDeclaration", Boolean.FALSE);
            m.marshal(OrderList, stream);
            StringWriter sw = new StringWriter();
            m.marshal(OrderList, sw);
            String val = sw.toString();
            System.out.println(val); 
```

当我编组时，生成的 xml 不会保留，`&#xA;`而是添加`&amp;#xA;`，结果是这样的 `<description>REPAIR CAB DOOR&amp;#xA;REPAIR &amp;#xA;</description>`。如果我`&#xA`在 xml 中没有，我将无法在我的 pdf 中创建换行符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T23:44:12.830

好吧，我猜这里（虽然有点受过教育）。无论您对生成`<description>`元素的输入是什么，它都不应包含`&#xA`，而应仅包含`'\n'`。即，而不是：

```
"This is a List:&#xA;List item 1&#xA;List item 2&#xA;List item 3&#xA;List item 4" 
```

应该是

```
"This is a List:\nList item 1\nList item 2\nList item 3\nList item 4" 
```

# sharepoint - 用户控制和功能激活

> ID：13731655
> 
> 赞同：1
> 
> 时间：2012-12-05T20:18:52.573
> 
> 标签：sharepoint, deployment, user-controls

我有一个共享点解决方案包，里面有一个自定义用户控件。当我部署 .wsp 时，用户控件被放置在 CONTROLTEMPLATES 目录中。有没有办法“延迟”这一步，直到功能被激活？换句话说，我希望我的自定义用户控件仅在激活该功能后才可用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T23:08:13.870

据我所知，这是不可能的。在部署时，所有需要的文件都被复制到正确的位置。它实际上与功能无关，因为您甚至不需要功能来部署文件。你会看到当你 for ex 时自动创建了一个特性。将 Web 部件添加到您的解决方案。当您添加映射文件夹时不会。

你想通过延迟用户控件来实现什么？如果某个功能处于活动状态，您可以检查您的用户控件，并相应地调整您的用户控件的呈现。前任。显示在使用控件之前应激活该功能的消息。

# wpf - 无法加载组件，库引用与主项目

> ID：13731656
> 
> 赞同：1
> 
> 时间：2012-12-05T20:18:56.913
> 
> 标签：wpf, exception, reference, prism

我有一个由其他几个库项目和一个主应用程序组成的项目（使用 Prism 构建一个复合应用程序）。我正在使用 Telerik.Reporting，它在我的应用程序库之一中使用 Telerik.Windows.Controls。

我收到一个异常，它无法加载控件库

“无法加载文件或程序集'Telerik.Windows.Controls，PublicKeyToken=5803cfa389c90ce7'或其依赖项之一。系统找不到指定的文件。”：“Telerik.Windows.Controls，PublicKeyToken=5803cfa389c90ce7”}”

如果我在我的主项目中引用 Telerik.Windows.Controls，这个错误就会消失。但是，我不明白为什么我需要这样做并且我不想这样做。我觉得我的主项目（它不使用任何 Telerik 控件）没有必要引用 Telerik 控件库，因为它使用的是使用 Telerik 控件的库。

**有没有办法避免在我的主项目中引用 Telerik 库，它甚至不使用这些控件？**

我尝试将库添加到 GAC，但没有帮助。事实上，它使情况变得更糟。我尝试将库重新添加到主项目并得到同样的异常！我不得不去 GAC 注销它才能让它工作。

# file - 这个简单的批处理如何在 bash shell 中重命名？

> ID：13731661
> 
> 赞同：0
> 
> 时间：2012-12-05T20:19:08.923
> 
> 标签：file, bash, syntax, rename

我正在尝试将所有文​​件重命名`*_[m|f].txt`为`*.txt`. 如果一个实例`_[m|f]`出现在文件名中，我们可以假设它总是出现在`.txt`扩展名之前。

例子：

```
+-----------------------+---------------------+
|        input          |       output        |
+-----------------------+---------------------+
| hello_hi_wefwef_f.txt | hello_hi_wefwef.txt |
+-----------------------+---------------------+
| ya_yo_sup_m.txt       | ya_yo_sup.txt       |
+-----------------------+---------------------+ 
```

我目前正在尝试这个：

```
for i in *_[m|f].txt ; do
   mv "$i" "${i/-_[m|f].txt/.txt}"
done 
```

但它抱怨没有| 正则表达式的运算符。有没有一种简单的方法可以做我想做的事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:25:51.043

像这样修改你的脚本：

```
for i in *_[mf].txt; do
   mv "$i" "${i/_[fm]\.txt/\.txt}"
done 
```

# mysql - When inserting SQL how to enable UTF-8 encoding?

> ID：13731663
> 
> 赞同：-1
> 
> 时间：2012-12-05T20:19:26.850
> 
> 标签：mysql, utf-8, mysql-error-1064

I am trying to import data from `MySQL 5.1.30` to `Mysql 5.5.8`.

However I get this error message:

```
ERROR 1064 (42000) at line 2209: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''à¤—' at line 163 
```

I think because of the Persian language it requires UTF-8 encoding. How do I import with UTF-8 enabled?

```
INSERT INTO `language_data` (`id`, `lang_variable`, `English`, `Spanish`, `Hindi`, `Chinese`, `Farsi`) VALUES
(1343, '#my_challenges_button_find_challenges', 'Find challenges', 'Buscar desafÃ­os', 'à¤šà¥<81>à¤¨à¥Œà¤¤à¤¿à¤¯à¥‹à¤‚ à¤•à¤¾ à¤ªà¤¤à¤¾ à¤²à¤—à¤¾à¤&lt;8f>à¤‚', '', ''), 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:27:50.593

It was a wrong literal value. The literal quote symbol (') must be repeated in string values -

```
INSERT INTO table VALUES(..., 'some text ''à¤—') 
```

You need to find and fix this error in your script.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T20:39:08.697

`INSERT INTO language_data (id, lang_variable, English, Spanish, Hindi, Chinese, Farsi) VALUES (1343, '#my_challenges_button_find_challenges', 'Find challenges', 'Buscar desafÃ­os', 'à¤šà¥<81>à¤', 'à¤šà¥<81>à¤', 'à¤šà¥<81>à¤');`

# foursquare - 错误：无法连接 Foursquare 网络服务

> ID：13731664
> 
> 赞同：0
> 
> 时间：2012-12-05T20:19:28.720
> 
> 标签：foursquare

我尝试连接到 Foursquare 网络服务以解析查找某些位置，但我的程序无法连接到 Foursquare 网络服务。这是我的代码：

公共类 GetLocation {

```
public static void main (String [] args ) throws IOException
{

    //Set up for output locations in a .txt file
    String fileNameOut = "locations.txt" ; 
    FileOutputStream fos = new FileOutputStream( fileNameOut );
    PrintStream ps = new PrintStream(fos);
    String client_id = "Y2LZCJTR4LJBXZOXAB3F22VOLAV3GXRS5TSXRXXXXXXXXXXX";
    String client_secret = "PJY2QM4CLZITAUMGOQCM2QYTOKATTCH3VXXXXXXXXXXX";

    double latitude = 33.823712;
    double longtitude = -117.958931;
    String restaurantName = "Cafe Casse Croute";
    String V = "20121205";

            String API_URL = "http://api.foursquare.com/v2/venues/search?ll=";
        String queryStatement = latitude+","+longtitude+"&match="+restaurantName;

           try {
                 String url = (API_URL+queryStatement+"&client_id="+client_id+"&client_secret="+client_secret + "&v="+V);

           URL url = new URL(sURL);

           URLConnection httpc = url.openConnection();
       //HttpURLConnection httpc = (HttpURLConnection) url.openConnection();    
           httpc.setDoInput(true);
           httpc.connect();

        BufferedReader in = new BufferedReader(new InputStreamReader(httpc.getInputStream()));

        String inputLine = "";
        String content="";
        while ((inputLine = in.readLine()) != null){
             content=content+inputLine;

        }
        in.close();

        return content;
    } catch (Exception e) {
        return ("Exception: " + e.getMessage());
    }

} 
```

}

我也尝试使用 URLConnection httpc = (URLConnection) url.openConnection(); 但它没有连接到 FoureSquare 服务。

还有其他方法可以连接到 FoureSquare 服务吗？

# javascript - 您将如何实现 1\. 具有事件合并功能的异步事件队列 2.

> ID：13731670
> 
> 赞同：2
> 
> 时间：2012-12-05T20:19:45.333
> 
> 标签：javascript, web-applications, asynchronous

环境：

假设三个事件发生在某个应用程序的三个独立部分中，该事件应由两个控制器处理。应用调度器负责从应用程序的所有部分发送/接收事件，并且这个调度器应该有一个异步事件队列。

在某些情况下，三个事件中的两个与某个属性相关但名称不同，只有一个应该传递给控制器​​，另一个可能会被丢弃。

问题：

目前，我有一个“队列”，它实际上只是将事件反弹到控制器，这无济于事，因为如果队列中只有一个事件，我无法比较队列中的两个事件。

那么如何确保事件应该在队列中停留一段时间呢？我想超时功能可以解决问题，但有更好的方法吗？

值得称赞的是，合并事件的想法是受到 Cocoa 的启发，我基本上是在尝试做类似的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T21:33:11.767

我对 Cocoa 了解不多，但我假设它会用最新事件替换旧事件，直到事件能够被分派给应用程序（即，如果应用程序由于某种原因忙）。我不确定您的特定用例是什么，但是如果您想对事件进行速率限制，我会这样使用`setTimeout`：

```
function Dispatcher(controllers) {
    this.controllers = controllers;
    this.events = [];
    this.nextController = 0;
}
Dispatcher.prototype = {
    _dispatch: function (i) {
        var ev = this.events.splice(i, 1);
        this.controllers[this.nextController].handle(ev);
        this.nextController = (this.nextController + 1) % this.controllers.length;
    },
    notify: function (ev) {
        var index = -1, self = this, replace;

        function similer(e, i) {
            if (e.type === ev.type) {
                index = i;
                return true;
            }
        }

        replace = this.events.some(similar);
        if (replace) {
            this.events[i] = ev;
        } else {
            // it's unique
            index = this.events.push(ev) - 1;
            setTimeout(function () {
                self._dispatch(index);
            }, 100);
        }
    }
}; 
```

只需调用`notify`事件（确保有`type`属性或类似属性），它就会处理魔法。不同类型的事件将用自己的`setTimeout`.

我还没有测试过这段代码，所以可能有错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T21:26:05.753

> 我想超时功能可以解决问题，但有更好的方法吗？

不，真的没有。

`setTimeout(..., 0)`如果您的事件在同一个运行循环中分派，通常要使用的方法是使用。所以实现看起来像这样：

```
var eventQueue = [];
var handlerTimer = -1;
function fireEvent(event, params) {
    eventQueue.push([event, params]);
    window.clearTimeout(handlerTimer);
    handlerTimer = window.setTimeout(resolveQueue, 0);
}

function resolveQueue() {
    // process eventQueue and remove unwanted events...
    // then dispatch remaining events

    eventQueue = [];
} 
```

如果您需要处理来自不同运行循环的事件（例如`mouseup`和之类的本机事件`click`），则需要使用 0 以外的超时值。确切的值取决于您希望累积事件的时间。

# mysql - mySQL 不断切换列和参数

> ID：13731674
> 
> 赞同：-1
> 
> 时间：2012-12-05T20:19:59.517
> 
> 标签：mysql

尝试运行查询，不断得到`ERROR 1054`：

```
SELECT *
    from my_table
    WHERE 1=1
    AND MYCITY = CHICAGO
; 
```

现在，我使用`WHERE 1=1`and`AND`因为我正在运行多个参数。这是唯一能把一切都堵住的论点。完整读取错误：

```
ERROR 1054 (42S22): Unknown column 'CHICAGO' in 'where class' 
```

它正在寻找列`CHICAGO`而不是列中的值`CHICAGO`，`MYCITY`我不知道为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:21:15.717

需要引用您的字符串值

```
SELECT *
    from my_table
    WHERE 1=1
    AND MYCITY = 'CHICAGO'
; 
```

# java - java：最大容量的队列

> ID：13731677
> 
> 赞同：1
> 
> 时间：2012-12-05T20:20:11.980
> 
> 标签：java, collections, queue

> **可能的重复：**
> [包含 Java](https://stackoverflow.com/questions/5498865/size-limited-queue-that-holds-last-n-elements-in-java)
> [Java 中最后 N 个元素的大小受限队列 - 环形缓冲区](https://stackoverflow.com/questions/7266042/java-ring-buffer)

我对上面的有界队列感兴趣，每当遇到对象插入时，如果插入会导致“溢出”，它将首先删除最旧的对象。我希望添加为 O(1) 并且内存使用量尽可能少。我正在考虑在 LinkedList 上覆盖 add 方法，但理想情况下，我会实现一个循环的、基于数组的列表，并捕获前/后指针。每当加法超过容量时，前指针前进，然后是后指针。有没有类似的实现？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-05T20:30:52.893

链表浪费内存，因为 next 指针使用 mem，而 ArrayList 没有。

高性能实现基于 ArrayList 或更好的数组。如果您的循环缓冲区大小是固定的，您将使用数组。

我使用内部数组实现了一个循环缓冲区，带有开始和结束位置索引变量。我没有找到循环列表/缓冲区的实现，这就是我想要的。

实现起来并不难，但我建议使用大量单元测试用例，以证明您的 circ 缓冲区按预期工作。

# php - 如何定义字符串的结尾

> ID：13731686
> 
> 赞同：1
> 
> 时间：2012-12-05T20:20:47.270
> 
> 标签：php

我想`"/info"`在网址末尾添加。如果`"/info"`已经存在，我想保持原样。

我目前正在使用：

```
if(strpos($url, "/info") === false){
    $url .= "/info";
} 
```

但是上面的代码只有在 url 结尾不包含`"/"`的情况下才有效。

例如：如果 url 是`http://www.domain.com`那么它工作得很好，输出是`http://www.domain.com/info`. 如果 url 是`http://www.domain.com/`那么它显示`http://www.domain.com//info`.

如何避免这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:27:57.367

修剪域，然后检查最后五个字符（以防“/info”字符串出现在 URL 的其他位置）。

```
$url = rtrim($url,'/');
if(substr($url,-5)!='/info') $url .= '/info'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T20:24:42.650

你只需要考虑到这一点。

```
if(substr($url, -5) != '/info') {
  if(substr($url, -1) == "/")
      $url.="info";
  else
      $url.="/info";
} 
```

注意我将第一个修改`if`为仅`'/info'`在 url 末尾检查；正如加雷斯所做的那样；）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T20:33:56.953

考虑以下网址： http: [//www.domain.com/info/test/](http://www.domain.com/info/test/)

如果你`strpos`以这种方式使用，你会得到错误的结果。相反，您可以使用 substr 和 rtrim ：

```
$url = (substr($url,-5) != '/info') ? rtrim($url, "/") . '/info' : $url; 
```

# c++ - 与参数中的默认值聚合

> ID：13731689
> 
> 赞同：2
> 
> 时间：2012-12-05T20:20:53.453
> 
> 标签：c++, c++11

为什么不能提供在结构参数列表中定义的默认值？也就是说，为什么这行得通

```
struct C {int i;};
C cc = {0};

foo(C c=cc) {} 
```

但不是

```
foo(C c={0}) {} 
```

请注意，我注意到数组也是如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:35:38.387

好的，这似乎是旧 GCC 的编译器问题。

# c# - RestSharp 执行同步，而不是异步

> ID：13731691
> 
> 赞同：4
> 
> 时间：2012-12-05T20:21:12.877
> 
> 标签：c#, httpwebrequest, restsharp

有没有办法同步使用restsharp？我在 Visual Studio 中看到的每个方法都有“异步”后缀和 restsharp 主页，（具有以下示例）：

```
// execute the request
RestResponse response = client.Execute(request);
var content = response.Content; // raw content as string 
```

明确区分同步和异步请求：

```
// easy async support
client.ExecuteAsync(request, response => {
    Console.WriteLine(response.Content);
}); 
```

如何访问此“执行”同步方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T20:18:22.960

我在他们的 googlegroups 中问过，他们说这是因为使用 wp7 时的“平台限制”。很整洁吧？

# javascript - 将 json 对象附加到 json 数组中

> ID：13731693
> 
> 赞同：1
> 
> 时间：2012-12-05T20:21:15.057
> 
> 标签：javascript, jquery

我有一个表单，想将它的内容附加到现有数组中。
我正在使用`JSON.stringify( $('#myForm').serializeObject() )`将表单元素转换为`json`对象。
该表单具有我想附加的用户信息，`myArr`然后将此列表附加到现有数组中。

`myArr`填充得很好，它只是将它附加到`existingJsonArray`我似乎有问题。

我[看到了这一点](https://stackoverflow.com/questions/617036/appending-to-a-json-object)，但是由于`JSON.stringify`创建了完整的 json 数组，我需要淘汰`[{`and`}]`吗？

这是正确的方法吗？

```
var existingJsonArray = [];
var myArr = [];

myArr.unshift( JSON.stringify( $('#myForm').serializeObject() ) );

existingJsonArray.unshift(myArr); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:26:51.780

请注意[JSON](http://json.org/)是对象的*字符串表示*形式 - 不适合操作它们。

```
var array = [], // an Array literal in JavaScript code
    formObject;
formObject = $('#myForm').serializeObject(); // an object representing the form
array.unshift([formObject]); // not sure why you need the nested array
// create string containing JSON representation of the array:
var jsonString = JSON.stringify(array); 
```

# javascript - 在 d3js 中为这个元素设置动画

> ID：13731695
> 
> 赞同：0
> 
> 时间：2012-12-05T20:21:17.557
> 
> 标签：javascript, d3.js

好的，所以我有以下代码示例，其中我在 svg 元素中有圆圈。每个圆圈都有一个点击事件，我正在尝试为被点击的圆圈设置动画。目前所有圆圈都有动画，因为我指的是气泡对象。我想要的是引用单击的对象其自身而不是其他对象：

```
 var data_items=[100,200,300];

 var svg = d3.select("#chart")
        .append("svg").attr("width", 800).attr("height", 600);

 var g = svg.selectAll(".bubbleContainer")
      .data(data_items)
      .enter().append("g")
      .attr("class","bubbleContainer");

 var bubble = g.append("circle")
       .attr("class","bubble")
       .attr("cx", function(d) {
              return d;
       })
       .attr("cy", function(d) { 
         return d
        })
       .attr("r", function(d) {
            return d/2
        })
        .on("click",function(d){
        bubble
        .transition()
        .duration(1000)
        .attr("r",1000)
    }) 
```

非常感谢任何帮助
谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T21:09:59.493

您可以使用`d3.event.target`来访问在事件处理程序中被单击的元素。参见例如[这个 jsfiddle](http://jsfiddle.net/nrabinowitz/NsLkz/7/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T21:14:59.140

Lars Kotthoff 写的东西会起作用。或者——我不确定哪个更惯用：

在点击处理程序中，`this`上下文引用了被点击的 DOM 元素。

所以以下也可以做到：

```
.on("click",function(d){
  d3.select(this)
    .transition()
    .duration(1000)
    .attr("r",1000)
}); 
```

# android - 当我单击列表视图内容时，它们正在使用不在我的应用程序中的网络浏览器打开

> ID：13731708
> 
> 赞同：1
> 
> 时间：2012-12-05T20:22:24.533
> 
> 标签：android, listview, webview, android-listview

我的 android 应用程序在列表视图中显示我网站的 rss 提要。起初，我的应用程序会在最新的 20 篇文章的标题出现在列表视图中之后显示一个“加载”页面。当我单击主题名称时，主题正在使用不在我的应用程序中的网络浏览器打开。

```
this is my MainActivity.java

    public class MainActivity extends ListActivity {

 private MyFeed myRssFeed = null;

 /** Called when the activity is first created. */
 @Override
 public void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.activity_main);

  new MyTask().execute();

 }
 private class MyTask extends AsyncTask<Void, Void, Void>{

  @Override
  protected Void doInBackground(Void... arg0) {
   try {
    URL rssUrl = new URL("http://mywindows8.org/windows-8-tutorials/feed/");
    SAXParserFactory mySAXParserFactory = SAXParserFactory.newInstance();
    SAXParser mySAXParser = mySAXParserFactory.newSAXParser();
    XMLReader myXMLReader = mySAXParser.getXMLReader();
    MyWindows myRSSHandler = new MyWindows();
    myXMLReader.setContentHandler(myRSSHandler);
    InputSource myInputSource = new InputSource(rssUrl.openStream());
    myXMLReader.parse(myInputSource);

    myRssFeed = myRSSHandler.getFeed(); 
   } catch (MalformedURLException e) {
    e.printStackTrace(); 
   } catch (ParserConfigurationException e) {
    e.printStackTrace(); 
   } catch (SAXException e) {
    e.printStackTrace();
   } catch (IOException e) {
    e.printStackTrace(); 
   }

   return null;
  }

  @Override
  protected void onPostExecute(Void result) {
   if (myRssFeed!=null)
   {

  ArrayAdapter<Topic> adapter =
          new ArrayAdapter<Topic>(getApplicationContext(), R.layout.custom_list_item,myRssFeed.getList());
    setListAdapter(adapter); 

   }else{

    TextView textEmpty = (TextView)findViewById(android.R.id.empty);
    textEmpty.setText("No Feed Found!");
   }

   super.onPostExecute(result);
  }

 }

 @Override
 protected void onListItemClick(ListView l, View v, int position, long id) {

  Uri feedUri = Uri.parse(myRssFeed.getItem(position).getLink());
  Intent myIntent = new Intent(Intent.ACTION_VIEW, feedUri);
  startActivity(myIntent);

 }

} 
```

这是 activity_main.xml 文件

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <TextView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="@string/hello" 
        android:textSize="20sp"
        android:background="@layout/button5"
        android:orientation="vertical"
        android:textColor="#D5D5D5"
        android:gravity="center"/>

    <ListView
        android:id="@android:id/list"
        android:layout_width="fill_parent"
        android:layout_height="match_parent"
        android:textColor="#000000"
        android:background="@layout/back2"
        android:orientation="vertical"
        android:divider="@layout/list_divider"
        android:dividerHeight="2dp"

        />

    <TextView
        android:id="@android:id/empty"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="@string/loading"
        android:gravity="center"
       />
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:34:44.640

这应该有效：

ListView listView = new ListView(this);

```
listView.setOnItemClickListener(new OnItemClickListener() {

    @Override
    public void onItemClick(AdapterView<?> arg0, View listItemView, int positionOfItem, long idOfItem) {
        // Here you put what you want to do when a listItem is clicked
        Intent k = new Intent(this, Contenturl.class);
                k.putExtra(org.core.mywindows8.Contenturl.URL, "http://mywindows8.org/windows-8-themes/");
                MainActivity.this.finish();
                startActivity(k);

    }
}); 
```

更多文档：

*   [列表显示](http://developer.android.com/reference/android/widget/ListView.html)
*   [OnItemClickListener](http://developer.android.com/reference/android/widget/AdapterView.OnItemClickListener.html)

# java - 允许“Enter”键按下提交按钮，而不是仅使用 MouseClick

> ID：13731710
> 
> 赞同：54
> 
> 时间：2012-12-05T20:22:39.520
> 
> 标签：java, swing, keylistener

我现在正在学习 Swing 课程以及有关它的一切。我有一个我一直在整理的玩具程序，它会提示输入名称，然后显示一个带有消息“您已输入（您的姓名）”的 JOptionPane。我使用的提交按钮只能单击，但我也想让它与 Enter 按钮一起使用。我已经尝试添加一个 KeyListener，正如我正在使用的 Java 书籍（Eventful Java、Bruce Danyluk 和 Murtagh）中所推荐的那样。

![名称提示](../Images/219ee4ef6e741c754fa4335328c75a10.png) ![在此处输入图像描述](../Images/0d56d1c3583ba8c220751b3a06901869.png)

这是我的代码：

```
import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;

public class NamePrompt extends JFrame{

    private static final long serialVersionUID = 1L;

    String name;

    public NamePrompt(){

        setLayout(new BorderLayout());

        JLabel enterYourName = new JLabel("Enter Your Name Here:");
        JTextField textBoxToEnterName = new JTextField(21);
        JPanel panelTop = new JPanel();
        panelTop.add(enterYourName);
        panelTop.add(textBoxToEnterName);

        JButton submit = new JButton("Submit");
        submit.addActionListener(new SubmitButton(textBoxToEnterName));
        submit.addKeyListener(new SubmitButton(textBoxToEnterName));
        JPanel panelBottom = new JPanel();
        panelBottom.add(submit);

        //Add panelTop to JFrame
        add(panelTop, BorderLayout.NORTH);
        add(panelBottom, BorderLayout.SOUTH);

        //JFrame set-up
        setTitle("Name Prompt Program");
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        pack();
        setLocationRelativeTo(null);

    }

    public static void main(String[] args) {
        NamePrompt promptForName = new NamePrompt();
        promptForName.setVisible(true); 
    }

} 
```

这是actionListener，keyListener类：

```
import java.awt.Component;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;

import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JTextField;

public class SubmitButton implements ActionListener, KeyListener {

    JTextField nameInput;

    public SubmitButton(JTextField textfield){
        nameInput = textfield;
    }

    @Override
    public void actionPerformed(ActionEvent submitClicked) {

        Component frame = new JFrame();
        JOptionPane.showMessageDialog(frame , "You've Submitted the name " + nameInput.getText());
    }

    @Override
    public void keyPressed(KeyEvent e) {
        if (e.getKeyCode()==KeyEvent.VK_ENTER){
            System.out.println("Hello");
        }
        Component frame = new JFrame();
        JOptionPane.showMessageDialog(frame , "You've Submitted the name " + nameInput.getText());

    }

    @Override
    public void keyReleased(KeyEvent arg0) {
        // TODO Auto-generated method stub

    }

    @Override
    public void keyTyped(KeyEvent arg0) {

    }
} 
```

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2012-12-05T20:24:34.770

有一个简单的技巧。在您使用所有按钮构建框架后，请执行以下操作：

```
frame.getRootPane().setDefaultButton(submitButton); 
```

对于每一帧，您可以设置一个默认按钮，该按钮将自动侦听 Enter 键（可能还有其他一些我不知道的事件）。当您在该框架中按 Enter 键时，`actionPerformed()`将调用 ActionListeners 他们的方法。

* * *

据我所知，您的代码的问题是每次按下键时都会弹出对话框，因为您没有将其放入 if-body 中。尝试将其更改为：

```
@Override
public void keyPressed(KeyEvent e) {
    if (e.getKeyCode()==KeyEvent.VK_ENTER){
        System.out.println("Hello");

        JOptionPane.showMessageDialog(null , "You've Submitted the name " + nameInput.getText());
    }

} 
```

* * *

**更新：**我发现你的代码有什么问题。您将关键侦听器添加到提交按钮而不是文本字段。将您的代码更改为：

```
SubmitButton listener = new SubmitButton(textBoxToEnterName);
textBoxToEnterName.addActionListener(listener);
submit.addKeyListener(listener); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-12-05T20:29:05.073

您可以使用顶级容器根窗格设置默认按钮，这将允许它响应输入。

```
SwingUtilities.getRootPane(submitButton).setDefaultButton(submitButton); 
```

当然，这假设您已将按钮添加到有效容器中；）

**更新**

这是使用`JRootPane#setDefaultButton`和键绑定 API的基本示例

```
public class DefaultButton {

    public static void main(String[] args) {
        new DefaultButton();
    }

    public DefaultButton() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new TestPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }

        });
    }

    public class TestPane extends JPanel {

        private JButton button;
        private JLabel label;
        private int count;

        public TestPane() {

            label = new JLabel("Press the button");
            button = new JButton("Press me");

            setLayout(new GridBagLayout());
            GridBagConstraints gbc = new GridBagConstraints();
            gbc.gridy = 0;
            add(label, gbc);
            gbc.gridy++;
            add(button, gbc);
            gbc.gridy++;
            add(new JButton("No Action Here"), gbc);

            button.addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    doButtonPressed(e);
                }

            });

            InputMap im = button.getInputMap(WHEN_ANCESTOR_OF_FOCUSED_COMPONENT);
            ActionMap am = button.getActionMap();

            im.put(KeyStroke.getKeyStroke(KeyEvent.VK_SPACE, 0), "spaced");
            am.put("spaced", new AbstractAction() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    doButtonPressed(e);
                }

            });

        }

        @Override
        public void addNotify() {
            super.addNotify();
            SwingUtilities.getRootPane(button).setDefaultButton(button);
        }

        protected void doButtonPressed(ActionEvent evt) {
            count++;
            label.setText("Pressed " + count + " times");
        }

    }

} 
```

当然，这假设具有焦点的组件不使用有问题的键事件（如第二个按钮使用`space`或`enter`键

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-08T17:44:17.570

在 ActionListener 类中，您可以简单地添加

```
public void actionPerformed(ActionEvent event) {
    if (event.getSource()==textField){
        textButton.doClick();
    }
    else if (event.getSource()==textButton) {
        //do something
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-20T06:53:16.353

```
 switch(KEYEVENT.getKeyCode()){
      case KeyEvent.VK_ENTER:
           // I was trying to use case 13 from the ascii table.
           //Krewn Generated method stub... 
           break;
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-29T19:18:32.653

没有框架，这对我有用：

```
JTextField tf = new JTextField(20);
tf.addKeyListener(new KeyAdapter() {

  public void keyPressed(KeyEvent e) {
    if (e.getKeyCode()==KeyEvent.VK_ENTER){
       SwingUtilities.getWindowAncestor(e.getComponent()).dispose();
    }
  }
});
String[] options = {"Ok", "Cancel"};
int result = JOptionPane.showOptionDialog(
    null, tf, "Enter your message", 
    JOptionPane.OK_CANCEL_OPTION,
    JOptionPane.QUESTION_MESSAGE,
    null,
    options,0);

message = tf.getText(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-30T13:05:47.983

我知道这不是最好的方法，但是右键单击有问题的按钮，事件，键，键类型。这是一种简单的方法，但对任何键都有反应

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-22T10:42:35.937

```
textField_in = new JTextField();
textField_in.addKeyListener(new KeyAdapter() {

    @Override
    public void keyPressed(KeyEvent arg0) {
        System.out.println(arg0.getExtendedKeyCode());
        if (arg0.getKeyCode()==10) {
            String name = textField_in.getText();
            textField_out.setText(name);
        }

    }

});
textField_in.setBounds(173, 40, 86, 20);
frame.getContentPane().add(textField_in);
textField_in.setColumns(10); 
```

# javascript - 无法使用 javascript 制作正则表达式

> ID：13731713
> 
> 赞同：1
> 
> 时间：2012-12-05T20:22:54.120
> 
> 标签：javascript, regex

我想为我的大学注册号做一个正则表达式。我成功率达到了 75%。我是新手，不知道怎么做。这就是我正在做的事情。

```
<!DOCTYPE html>
<html> 
<body>

<script>
str = "l1s10bscs"; //successfully tested
                   //but i want to append any 4 digits at the end of l1s10bscs

re = /[a-zA-Z]\d{1}[s|S|f|F]\d{2}[bscs]/g;

result = re.test(str);

document.write(result);

</script>

</body>
</html> 
```

我试过了，但它不起作用。

```
re = /[a-zA-Z]\d{1}[s|S|f|F]\d{2}[bscs][0-9]{4}/g;  // this doesn't work 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:35:24.667

```
/[a-z]\d[sf]\d{2}bscs\d{4}/i 
```

根据你的描述，应该是合适的。

我更改了以下内容：

*   [bscs] 表示“b or s or c or s”（所以“b or s or c”，多余的s是没有意义的）。您只需要文字四字符字符串“bscs”
*   \d{1} 与 \d 相同 - 这不是错误，但没有理由明确定义一个字符只出现一次。
*   您有一个 \g 标志但没有 \i，因此您将在一个较大的字符串中多次匹配您要查找的字符串，但您的搜索不区分大小写。
*   [s|S|f|F] 的意思是“s or | or S or |...” 你的意思是“s or S or f...”，写成 [sSfF]。
*   由于 \i 用于使搜索不区分大小写，因此我将 [sSfF] 简化为 [sf]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:35:51.710

`[bscs]`不需要在方括号中：方括号表示`b`or`s`或`c`or `s`。它可以在没有数字的情况下工作，因为它匹配“l1s10b”，但下一个字符不是数字，因此查找 4 位数字失败。尝试这个：

```
re = /[a-zA-Z]\d{1}[s|S|f|F]\d{2}bscs[0-9]{4}/g; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T20:37:59.897

你似乎很困惑`[]`和`()`。

`()`创建一个组，而`[]`意味着“匹配内部的任何字母”。

`[s|S|f|F]`意味着`'s' OR '|' OR 'S' OR 'f' OR 'F'`。那应该是`(s|S|f|F)`or `[sSfF]`。

注意：您可以使用`i`修饰符使其不区分大小写。

```
re = /[a-z]\d[sf]\d{2}bscs\d{4}/gi; 
```

# javascript - 了解 JSON 并显示

> ID：13731721
> 
> 赞同：2
> 
> 时间：2012-12-05T20:23:23.700
> 
> 标签：javascript, jquery, ajax

我有以下ajax请求...

**阿贾克斯**

```
function initUpdate()
{
    var id = $(this).attr('id').split('_')[1];
    //grab id from link update_xxxx

    //get all gallery information
    $.ajax(
    {
        type: 'POST',
        url: 'ajax/update',
        data: {"id": id},
        dataType: 'json',
        success: function(json)
        {

            //query was successful now populate form
            $("input[name='galleryName']").val(/*what goes here?*/);
        }
    });
} 
```

这将返回以下数据

```
{
    "selected_gallery": [
        {
            "id": "4004",
            "name": "Album Proofer Sample Gallery",
            "clientRef": "205",
            "clientName": "Mike "
        }
    ]
} 
```

我将如何访问“名称”以插入 val()？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T20:25:30.300

你试过什么？我认为您可以通过以下方式获得它：

```
json.selected_gallery[0].name 
```

`selected_gallery`是一个 JavaScript 数组，因此您可以访问集合中的第一项`[0]`，以便访问第一项的属性。

**更新**

如果它们存在，您可以访问数组中的其他项目：

```
{
    "selected_gallery": [
        {
            "id": "4004",
            "name": "Album Proofer Sample Gallery",
            "clientRef": "205",
            "clientName": "Mike "
        },
        {
            "id": "5005",
            "name": "blah",
            "clientRef": "405",
            "clientName": "Dave "
        },
        {
            "id": "6006",
            "name": "boo",
            "clientRef": "605",
            "clientName": "Doug"
        }
    ]
} 
```

要获取数组中的第二项，您可以将其引用为：

`json.selected_gallery[1].name`（或`id`或`clientRef`或...）。您可以通过 获得第三项`json.selected_gallery[2].name`。

希望这可以帮助。

# r - 是否有一种矢量化的方式来删除所有交易，但每个客户 ID 的最新 N 除外？

> ID：13731725
> 
> 赞同：3
> 
> 时间：2012-12-05T20:23:37.307
> 
> 标签：r, subset

我有一个交易样本 - customer `ID`, transaction `DATE`, transaction `VALUE`（每天最多一笔交易）......所有这些都`ID`按`DATE`.

我只需要保留`N`每个客户的最新交易（比如 3 个最新交易）。有没有一种矢量化的方式来做到这一点？在原始示例中，我有数百万个事务 - FOR 循环执行时间过长。

```
ID  DATE    VALUE
205 18.10.2010  19
209 30.09.2010  19
209 21.10.2010  19
209 07.11.2010  19
228 08.11.2010  159
237 24.10.2010  159
237 13.11.2010  200
248 30.09.2010  25
274 05.10.2010  19
274 11.10.2010  10
274 25.10.2010  19
274 05.11.2010  19
292 25.09.2010  159
292 03.10.2010  159
292 10.10.2010  159
292 26.10.2010  159
292 07.11.2010  159
310 18.10.2010  19
310 07.11.2010  19
310 19.11.2010  19
354 23.10.2010  19
354 02.11.2010  19
354 14.11.2010  19
354 22.11.2010  19
368 18.10.2010  19
369 25.09.2010  25
369 26.09.2010  25
369 27.09.2010  25
369 02.10.2010  25
369 04.10.2010  159
369 11.10.2010  20
369 15.10.2010  10
369 16.10.2010  19
369 23.10.2010  10
369 26.10.2010  10
369 29.10.2010  10
369 01.11.2010  10
369 02.11.2010  30
369 08.11.2010  10
369 13.11.2010  20
369 15.11.2010  70
369 23.11.2010  20
375 14.11.2010  159
382 11.10.2010  18
382 16.11.2010  20
387 26.10.2010  19
407 26.09.2010  25
407 04.10.2010  25
407 10.10.2010  70
407 25.10.2010  19 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T21:43:14.703

由于您有很多数据并且速度是一个问题，因此您应该使用[data.table](http://datatable.r-forge.r-project.org/)包

如果您`data.frame`在一个名为 的对象中`dat`，请将其强制为`data.table`这样

```
DT <- as.data.table(dat) 
```

由于您的`DATE`列的当前格式不容易排序，让我们首先创建一个包含实际日期的新列。在`data.table`包中，`:=`是引用运算符的赋值。

```
DT[, DATE2:=as.Date(DATE, "%d.%m.%Y")] 
```

现在我们有了一个名为`DATE2`Dates 的新列。我们可以`order`按日期，然后拆分 `ID`并获取最后 3 个值 ( `tail(.SD, 3)`)。 `.SD`代表 data.table 包中的“数据子集”

```
> DT[order(DATE2), tail(.SD, 3), by=ID]
     ID       DATE VALUE      DATE2
 1: 292 10.10.2010   159 2010-10-10
 2: 292 26.10.2010   159 2010-10-26
 3: 292 07.11.2010   159 2010-11-07
 4: 369 13.11.2010    20 2010-11-13
 5: 369 15.11.2010    70 2010-11-15
 6: 369 23.11.2010    20 2010-11-23
 7: 407 04.10.2010    25 2010-10-04
 8: 407 10.10.2010    70 2010-10-10
 9: 407 25.10.2010    19 2010-10-25
10: 209 30.09.2010    19 2010-09-30
11: 209 21.10.2010    19 2010-10-21
12: 209 07.11.2010    19 2010-11-07
13: 248 30.09.2010    25 2010-09-30
14: 274 11.10.2010    10 2010-10-11
15: 274 25.10.2010    19 2010-10-25
16: 274 05.11.2010    19 2010-11-05
17: 382 11.10.2010    18 2010-10-11
18: 382 16.11.2010    20 2010-11-16
19: 205 18.10.2010    19 2010-10-18
20: 310 18.10.2010    19 2010-10-18
21: 310 07.11.2010    19 2010-11-07
22: 310 19.11.2010    19 2010-11-19
23: 368 18.10.2010    19 2010-10-18
24: 354 02.11.2010    19 2010-11-02
25: 354 14.11.2010    19 2010-11-14
26: 354 22.11.2010    19 2010-11-22
27: 237 24.10.2010   159 2010-10-24
28: 237 13.11.2010   200 2010-11-13
29: 387 26.10.2010    19 2010-10-26
30: 228 08.11.2010   159 2010-11-08
31: 375 14.11.2010   159 2010-11-14
     ID       DATE VALUE      DATE2 
```

或者，您可以设置一个`key`

这将是等效的，但可能更快

```
setkey(DT, DATE2, ID)
DT[, tail(.SD, 3), by=ID] 
```

# python - Python中的吉他弦代码？

> ID：13731726
> 
> 赞同：4
> 
> 时间：2012-12-05T20:23:37.523
> 
> 标签：python, vpython, guitar

我是 Python 的新手，但对编写可以模拟吉他弦的代码非常感兴趣。我该怎么做呢？或者至少我将如何开始这样做？任何帮助表示赞赏！

谢谢！

编辑：

我想看看弹奏不同琴弦、音符等时的声波。我也对演奏两个不同琴弦时的声波感兴趣，以及当它们是不和谐音符和辅音音符时的变化。我感兴趣的另一件事是，有时琴弦在不被弹拨时会如何振动（共振）。

任何帮助表示赞赏，谢谢！！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T21:05:32.540

这确实是[声音合成](http://en.wikipedia.org/wiki/Synthesizer)的问题，没有简单的答案。有很多可能的方法——这是一个完整的研究领域。 [JO Smith 的Physical Audio Signal Processing](https://ccrma.stanford.edu/~jos/pasp/)是一个很好的起点，Miller Puckette[的 The Theory and Technique of Electronic Music 也是如此。](http://crca.ucsd.edu/~msp/techniques.htm)[对于吉他，您可能对Karpus-Strong 方法](http://en.wikipedia.org/wiki/Karplus%E2%80%93Strong_string_synthesis)特别感兴趣。也许您应该搜索它的 Python 实现。这是音乐技术课程学生的共同项目；我敢肯定有很多。

# prolog - 满足公式值 PROLOG

> ID：13731727
> 
> 赞同：0
> 
> 时间：2012-12-05T20:23:39.757
> 
> 标签：prolog

我试图编写一个谓词来返回该谓词的所有令人满意的组合。例如...`val_form(F,L1,L2)`因为 F 是谓词，L1 是其变量列表，L2 是输出。

例如：

```
val_form(q & (r -> p),[p,q,r],L2). 
```

Prolog 应该返回：

```
L2=[0, 1, 0], L2=[1, 1, 0] e L2=[1,1,1] 
```

在结果之间键入“;”。

我已经定义了运算符“->”、“&”以及它们的“0”和“1”的情况。如果它找不到任何有效的解决方案，它会返回 False。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T14:10:52.700

尝试为此使用 findall 谓词

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:14:22.793

[我曾经改编过关于真值表制造商](http://www.csupomona.edu/~jrfisher/www/prolog_tutorial/2_13.html)的JRFischer 教程页面，它解释了与您需要的任务非常相似的任务。我使用了不同的运算符，除了含义之外，它们非常适合 (->)/2。

```
formula(N,_,_,N) :-
    member(N,[0,1]).
formula(X,Vars,A,Val) :-
    atom(X),
    lookup(X,Vars,A,Val).
formula(X + Y,Vars,A,Val) :-
    formula(X,Vars,A,VX),
    formula(Y,Vars,A,VY),
    and(VX,VY,Val).
formula(X * Y,Vars,A,Val) :-
    formula(X,Vars,A,VX),
    formula(Y,Vars,A,VY),
    or(VX,VY,Val).
formula(X -> Y,Vars,A,Val) :-
    formula(X,Vars,A,VX),
    formula(Y,Vars,A,VY),
    imply(VX,VY,Val).
formula(- X,Vars,A,Val) :-
    formula(X,Vars,A,VX),
    not(VX,Val).

lookup(X,[X|_],[V|_],V).
lookup(X,[_|Vars],[_|A],V) :- lookup(X,Vars,A,V).

and(0,0,0).
and(1,1,1).
and(0,1,0).
and(1,0,0).

or(0,0,0).
or(0,1,1).
or(1,0,1).
or(1,1,1).

not(0,1).
not(1,0).

imply(0,0,1).
imply(0,1,1).
imply(1,0,0).
imply(1,1,1). 
```

这段代码比要求的更通用，要获得所需的分配，我们必须限制调用：

```
?- lenght(A,3),formula(q + (r -> p), [p,q,r], A, 1).
Correct to: "length(A,3)"? yes
A = [0, 1, 0] ;
A = [1, 1, 0] ;
A = [1, 1, 1] ;
false. 
```

# objective-c - 结合 UIWindows？

> ID：13731729
> 
> 赞同：0
> 
> 时间：2012-12-05T20:23:43.063
> 
> 标签：objective-c, ios, macos

我将向每个窗口添加 50 个带有 4 个 UIButtons（带文本）和 1 个 UILabel（也带文本）的窗口。我需要这样做吗？有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:59:10.893

不要浪费时间创建 50 个窗口（如果这是 MacOS 问题）或视图（如果这是 iOS 问题）。哇，那太可怕了。

相反，创建一个具有四个按钮和至少一个标签的单一视图。

然后，您可以从问题和答案列表中为每个项目填充字符串值。您可以将这些问题保存在 plist 文件或 CoreData 数据库或一些可解析的平面文件等中。通过“ `IBAction`”方法将四个按钮连接到（游戏？）控制器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T21:00:16.250

如果可以的话，创建额外的窗口绝不是一个好主意，尤其是在几乎不需要这样做的 iOS 上。您应该创建一个 UIViewController 子类并使其成为您的根视图控制器（这已在单视图应用程序模板中设置）。然后，创建一个 UIView 的子类——我们称之为“MyQuizView”。“MyQuizView”应该有一个自定义初始化程序，它需要五个 NSStrings（一个用于问题，四个用于答案）和一个整数来确定哪个答案是正确的。UIViewController 子类可以实例化其中的 50 个视图，将模型中的值传递给它们，并使其成为主视图的子视图。

编辑：这是 UIView 子类的自定义初始化程序的示例。

```
- (id) initWithFrame:(CGRect)frame question:(NSString*)ques answers:(NSArray*)ans correctAnswer:(int)correctAns{
    self = [super initWithFrame: frame];
    if (self) {
        self.question = ques;
        self.answers = ans;
        self.correctAnswerNumber = correctAns;
        [self setup];
    }
    return self;
} 
```

自定义初始化程序以`init`. 它设置`self`为其超类的指定初始化器的返回值，然后，如果`self`不是 nil，它会初始化其状态——通常使用传递的参数来这样做。最后它返回`self`。这个假设你有正确的属性并调用一个名为`setup`将属性设置为正确的值后，允许您使用它们来创建标签等。或者，您可以获取传入的值并使用它们立即创建标签和按钮，设置目标操作并将它们放置为子视图，这样您就不需要将参数保留为属性。每个按钮都可以被赋予一个数字标签，以便您知道答案是否正确（基于传递给初始化程序的整数，您必须*将*其存储在某处）。这一切都来自记忆，但希望它是正确的。

# css - 为什么 Firefox 和 IE 不将图像完整地放在一个 li 中

> ID：13731731
> 
> 赞同：1
> 
> 时间：2012-12-05T20:23:48.240
> 
> 标签：css, internet-explorer, firefox, html-lists, quirks-mode

我想将图像放置在幻灯片中（两个单独的滑块）并为此使用 li……它在 Chrome 和 Safari 中运行良好，但在 Firefox 和 IE 中存在问题

在 Firefox 中，它在 quirks 模式下工作正常，但在标准模式下不起作用：请参见以下示例：

怪癖模式适用于 Firefox： http: [//www.newmen-agency.com/](http://www.newmen-agency.com/)

但在标准模式下不起作用：http: [//www.newmen-agency.com/index_doct.html](http://www.newmen-agency.com/index_doct.html)

我必须在标准模式下工作……我做错了什么？

见下面的CSS代码：

```
/* Photo slider */

#slider1 {
    position: absolute;
    height: 100%;
    left: 0%;
    top: 0%;
    width: 57%;
    z-index:100;
}    

#slider2 {
    position: absolute;
    height: 100%;
    left: 82%;
    top: 0%;
    width: 57%;
    z-index:100;
}

#slider1 ul, #slider2 ul {
    margin: 0;
    padding: 0;
}

#slider1 img, #slider2 img {
    height:100%;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:35:31.483

添加一个最大宽度似乎有帮助（顺便说一句，Opera 不喜欢这两个版本的页面）：

```
#slider1 img, #slider2 img {
    height:100%;
    max-width:100%;
} 
```

# debugging - 如何在运行时调试 EF5 生成的 SQL？

> ID：13731733
> 
> 赞同：3
> 
> 时间：2012-12-05T20:24:00.650
> 
> 标签：debugging, .net-4.5, entity-framework-5

所以我对 EntityFramework 很陌生，实际上现在处于 POC 阶段，我试图回答的问题之一是如何通过调试器或其他可附加过程的工具可视化 EF 生成的查询？

我试图解决的情况是，在尝试调试 QA 或生产问题时，开发人员需要能够通过远程调试器附加到进程，并且需要可视化 EF 创建的查询以查看它是否包含在框架中最有效的方式。

在开发过程中也可以这样说，我需要能够可视化 EF 进行的查询。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T17:07:30.853

您可以：

1.  使用 Sql Server Management Studio 查询分析器查看进入数据库的流量（可能是侵入性最小的）
2.  将 VS 附加到您的进程并使用 IntelliTrace 应该显示发送到数据库的命令
3.  尝试使用 EF 跟踪提供程序 ( [http://code.msdn.microsoft.com/EFProviderWrappers](http://code.msdn.microsoft.com/EFProviderWrappers) )
4.  对于查询，您可以在调试时对 ObjectQuery 对象执行 .ToTraceString() 并对 DbQuery 对象执行 .ToString()。

**编辑**

EF6 包含一项新功能，允许您[将流量记录到数据库](http://blog.oneunicorn.com/2013/05/08/ef6-sql-logging-part-1-simple-logging/)

# entity-framework - 无法使用实体框架（版本 4.3.1）代码优先调试到我的 DbContext 派生类代码

> ID：13731744
> 
> 赞同：1
> 
> 时间：2012-12-05T20:24:56.103
> 
> 标签：entity-framework, debugging, mstest, code-first, breakpoints

这是我使用 VS 2012 Ultimate 设置的解决方案：

我有一个项目（例如 MyDomainModel），其中包含使用 POCO 类的所有业务领域类型。我有另一个引用 MyDomainModel 项目的项目（例如 MyEntity），并且派生的 DbContext 类（例如 MyDbContext）在 SaveChanges 方法中实现自定义业务逻辑（例如，用于插入和修改数据时的自动时间戳）。

我有另一个基于 mstest 的项目（例如 MyEntity_Tests），它将使用已知的种子数据测试派生的 DbContext（例如 MyDbContext），作为数据库初始化的一部分。

我的问题是在调试测试时，MyDbContext的c#代码上设置的断点没有命中。但是，如果我在文件中放入诸如 Debug.Print("xxx") 之类的行并调试相同的测试，则测试输出将包含那些预期的输出“xxx”。

我知道实体框架运行时会在后台生成代理 dll 来包装这些 dll（例如 MyDomainModel.dll）。但是，无法像在 MyDbContext 中那样调试我自己的代码对我来说确实是一个大问题。其他人在使用 EF 代码优先时是否有类似的问题以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T23:48:05.217

在派生的 DbContext 类中的一行上设置断点开始调试并将鼠标悬停在它上面，看看为什么它没有被命中。最有可能的符号未加载。调试时转到加载的模块窗口，右键单击您的程序集，您可以检查 VS 尝试从何处加载符号。您也可以手动加载符号。请注意，如果符号与程序集不匹配，您需要重新构建项目以获取最新的符号。没有命中断点的另一个原因可能是您的源代码与程序集不匹配。您可以取消选中“设置”->“调试”中的复选框以启用对与程序集不匹配的源的调试，但这样的调试既痛苦又适得其反。再次重建应该会有所帮助。我假设您正在尝试调试程序集的调试版本而不是发布版本。

# php - PHP SoapClient - 属性中的多行

> ID：13731747
> 
> 赞同：2
> 
> 时间：2012-12-05T20:25:05.497
> 
> 标签：php, soap, attributes, soap-client

我需要帮助，因为在 PHP 创建的任何地方都找不到具有多个值和行的 SOAP 属性。

我正在尝试使用 PHP 5.3.x 重现此 SOAP 请求。我对这部分有困难。

除了属性部分，我的 php 数组 $parameters 可以创造奇迹：

```
$parameters = array(
                            'requests' => array(

                            'proposal_trans_request' =>  array (
                                        'TransType' => array( 'tc'=>'100'),
                                        'company' => array( 'tc'=>'500'),
                                        'product' => array( 'tc'=>'auto'),
                                        'inception' => array (
                                             'p_year' => '2012',
                                             'p_month' => '12',
                                             'p_day' => '20'
                                         ), // inception
                                        'p_number' => '0',

                                        'attributes' => array(

                                          'att' => $att

                                     ),//attributes
                                        'warnings' => array ()

                              ), //proposal_trans_request

                      ), //requests

                    ); //proposal_multitrans; 
```

==============SOAP请求=============

```
<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" >
  <soap:Header/>
  <soap:Body>
     <proposal_multitrans xmlns="***">
         <requests>
           <proposal_trans_request>
              <TransType tc="100"/>
              <company tc="500"/>
              <product tc="auto"/>
              <inception>
                 <p_year>2012</p_year>
                 <p_month>8</p_month>
                 <p_day>1</p_day>
              </inception>
              <p_number>0</p_number>
              <attributes>
        <att val="2" name="periodos" />
        <att val="2012-8-1" name="DateEna" />
        <att val="0" name="chkcabrio" />
        <att val="0" name="chksinag" />
        <att val="0" name="chkimmob" />
        <att val="00" name="xrisi" />
        <att val="" name="Anane" />
        <att val="0" name="Axia" />
        <att val="0" name="chkgarage" />
        <att val="1359" name="oximacc" />
        <att val="10" name="kritirio" />
        <att val="2011-01-01" name="Datekatas" />
        <att val="1" name="oxilyear" />
        <att val="0" name="Xozim" />
        <att val="" name="HlikiaodN" />
        <att val="2002-01-01" name="DateDipl" />
        <att val="" name="DateDiplP" />
        <att val="" name="DateDiplMP" />
        <att val="0,00" name="OmDisc" />
        <att val="F" name="Ekpidio" />
        <att val="1" name="radfilo" />
        <att val="1980-01-01" name="DateGen" />
        <att val="" name="DateGenP" />
        <att val="" name="DateGenMP" />
        <att val="0" name="chkmonaz" />
        <att val="0" name="chkdyoa" />
        <att val="09" name="Paketa" />
        <att val="01" name="NOMOS_I" />
        <att val="0" name="Metat" />
        <att val="0" name="chkpantrz" />
        <att val="" name="Eidikatim" />
        <att val="1" name="AstEf" />
        <att val="0" name="chkpiros" />
        <att val="0" name="Idzim" />
        <att val="0" name="chkkalerg" />
        <att val="0" name="chkthrafsi" />
        <att val="0" name="chkkairika" />
        <att val="1" name="chkodiboi" />
        <att val="1" name="chkodiatix" />
        <att val="0" name="chkodiboat" />
        <att val="0" name="chkanasfal" />
        <att val="0" name="chkatodid" />
        <att val="0" name="chkzones" />
        <att val="0" name="chkenoik" />
        <att val="0" name="chkolikiklo" />
        <att val="0" name="chkstuv" />
        <att val="0" name="chkmerikiklo" />
        <att val="0" name="chkaxant" />
        <att val="1" name="chkassist" />
        <att val="0" name="chkbomal" />
        <att val="0" name="chkolikat" />
        <att val="0" name="chkixos" />
        <att val="0" name="chkkakov" />
        <att val="997976100" name="IDNUM_I" />
        <att val="ΙΚΤ123" name="Arkikl" />
              </attributes>
<warnings>
</warnings>
           </proposal_trans_request>
        </requests>
     </proposal_multitrans>
  </soap:Body>
</soap:Envelope> 
```

# php - 我可以在php的switch语句中调用函数吗？

> ID：13731749
> 
> 赞同：0
> 
> 时间：2012-12-05T20:25:07.757
> 
> 标签：php

不能在switch语句中调用函数吗？当我尝试执行以下操作时，我收到未定义的函数通知。

```
class MyClass {
    function myfunction($var)
    {
        unset($var);
    }

    function checkValue($val)
    {
        switch ($val) {
            case 'hello':
                myfunction($val);
                break;
            case 'goodbye':
                echo "i equals 1";
                break;
         }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:29:21.707

是的，您的假设是正确的，您需要：

```
$this->myfunction($val); //Calls the instance method myFunction 
```

# mysql - diff 主机（计算机）上 MySQL 数据库的简单数据库备份

> ID：13731750
> 
> 赞同：1
> 
> 时间：2012-12-05T20:25:08.647
> 
> 标签：mysql, mysqldump, mysql-workbench

有人可以告诉我如何在差异主机（计算机）上为 MySQL 数据库做简单的数据库备份。我正在尝试将我的数据库从一台主机（服务器）移动到一台新主机（服务器）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T08:21:51.753

如果你只是需要在服务器之间传输一个数据库，使用phpMyAdmin，你可以`Export`在源上使用数据库生成一个.SQL脚本，然后`Import`在目标服务器上使用来传输它。

或者，如果数据库太大，您可以使用类似[SQLDumper](http://www.mysqldumper.net/)的东西。

# html - 如何在浮动的相邻 div 上获得 100% 的高度？

> ID：13731751
> 
> 赞同：2
> 
> 时间：2012-12-05T20:25:11.970
> 
> 标签：html, css

```
​&lt;div id='container'>
    <div class='left'></div>
    <div class='right'></div>
    <div class='clear'></div>
</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

鉴于上面的简单标记，可以[**在 jsFiddle**](http://jsfiddle.net/6XagR/)的操作中看到，如何让浮动`right`div 占据其父容器的剩余高度，而该父容器没有明确的高度？父容器的最终高度由浮动`left`div 决定。

通常，我通过 Javascript 解决此问题，并在页面加载后修复高度。但是，必须有一种替代的、标准的和最佳的方法来处理这种情况。

我认为这只是以这种方式构建布局的一个固有问题，那么除了使用 a 之外还有什么替代方法`<table>`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:31:36.840

如果没有使用浮点数在父级上显式高度，则无法完成。

但是，您可以使用`display: table-;`and `table-cell`which 模仿表的行为，而无需实际使用它们：

```
#container { 
    width: 200px;
    background-color: green;
    display: table;
}
.left {
    display: table-cell;
    width: 30px;
    height: 200px;
    background-color: red;
}
.right {
    display: table-cell;
    height: 100%;
    width: 30px;
    background-color: blue;
} 
```

这样，您就不需要清除元素，并且两个 div 将始终占据 100% 的高度，只要它被声明即可。

[http://jsfiddle.net/6XagR/4/](http://jsfiddle.net/6XagR/4/) ​</p>

# javascript - 在水平上下文中设置 height() 会拉伸图形，同时保留重叠图缩放

> ID：13731752
> 
> 赞同：2
> 
> 时间：2012-12-05T20:25:13.883
> 
> 标签：javascript, d3.js, graphite, cubism.js

在立体派示例中，将 context.horizo​​n() 的 height 参数更改为较小的值会导致图形过度绘制自身。增加值的情况正好相反 - 过度绘制的情况较少。

但是，当我更改高度参数时，我的图表保留了相同级别的过度绘图，并且它们只是相应地向上和向下缩放。当我减小高度时，这些图表实际上会失去分辨率。

我该如何解决？

这是我的代码：

`var context = cubism.context().step(1000000).size(1000);`

 ````
var graphite = context.graphite("http://graphite.example.com");
var horizon = context.horizon().metric(graphite.metric).height(200);

var metrics = [
    "summarize(example0,'10s')",
    "summarize(example1,'10s')",
    "summarize(example2),'10s')",
    "summarize(example3),'10s')"
]   

d3.select("#supergraph").append("div")
    .attr("class", "axis")
    .call(context.axis().ticks(4).orient("top"));

d3.select("#supergraph").append("div")
    .attr("class", "rule")
    .call(context.rule());

d3.select("#supergraph").selectAll(".horizon")
    .data(metrics)
.enter().append("div")
    .attr("class", "horizon")
    .call(horizon); 
````  `* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T17:15:05.303

Cubism 将始终绘制与您为其设置的颜色数量相等的波段数，除非您明确设置范围，否则它将始终将最高波段顶部的最大值设置为数据的最大值。这意味着您有两个选项可以在更改大小时保持相同的分辨率：

1）您可以`horizon.extent([min, max])`在缩放高度时显式设置范围并缩放最小值和最大值。换句话说，如果您将图表的高度加倍，那么您的范围内的最小值和最大值也会加倍。

2）你可以改变你给它的颜色数量，这将改变它创建的波段数量。换句话说，如果你把图表的高度加倍，给它一个新的颜色数组，颜色数量的一半。`

# javascript - 在 for 循环中使用 setTimeout 和整数

> ID：13731759
> 
> 赞同：2
> 
> 时间：2012-12-05T20:25:39.323
> 
> 标签：javascript, jquery, for-loop

我有一个带有 id 的按钮`play`。

我想用这段代码在那个按钮上倒计时。但由于某种原因，我无法让它工作。

```
var timeoutTime = 500, seconds = 5;
var countdown = $("#play h4");
for(var i = seconds; i>0; i--)
{
    setTimeout(function() {
    countdown.text("" + i); },timeoutTime);
    timeoutTime += 1000;
} 
```

我尝试了很多东西，我能得到的最好的结果只是一个 1 而不是 5 4 3 2 1。使用此代码，我在按钮上得到一个 0。

有什么问题 ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T20:27:05.370

用这个 ：

```
for(var i = seconds; i>0; i--) {
    (function(i){
      setTimeout(function() {
          countdown.text("" + i); }, timeoutTime);
    })(i);
    timeoutTime += 1000;
} 
```

你的问题是 i 改变了，你总是用 i 的最后一个值调用，因为你传递给 setTimeout 的回调是在循环完成后调用的。

经典的解决方案是使用闭包来保持另一个变量（这里同名 i）具有所需的值。它之所以有效，是因为对于每次迭代，这是一个不同的函数（变量的范围是全局范围或声明它的函数）。

# c++ - 冒泡排序数组中的字符串

> ID：13731760
> 
> 赞同：0
> 
> 时间：2012-12-05T20:25:41.590
> 
> 标签：c++, arrays, bubble-sort

我正在尝试使用冒泡排序对数组的 LastName 属性（在结构 StudentRecord 下，因此是名称）进行冒泡排序。但我在这样做时遇到了麻烦。

我收到错误消息（我正在使用 MinGW 进行编译）：

```
Invalid array assignment 
```

这是我的代码：

```
void option2 (StudentRecord student[], int n)
{
   int pass = 1;
   bool done = false;
   StudentRecord temp;
   while (!done && pass <= n-1)
   {
      done = true;
      for (int i = n-1; i >= pass; i--)
      {
         if (student[i].lastName < student[i-1].lastName)
         {
            temp.lastName = student[i].lastName;
            student[i].lastName = student[i-1].lastName;
            student[i-1].lastName = temp.lastName;
            done = false;
         }
      }
      pass++;
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:32:16.793

它看起来像`lastName`一个字符数组。

您不能将整个数组分配给彼此；您需要使用`strcpy()`(#include `<cstring>`) 将一个复制到另一个。此外，使用`<`with 字符数组将导致比较每个数组中第一个元素的内存地址，而不是整个字符串；用于`strcmp`此（如果第一个参数按字典顺序<第二个参数，则返回<0）。

Note you can (and probably should) use `std::string` instead (#include `<string>`), which will automatically provide copying, comparison, and dynamic growth for you transparently.

# sql - 在同一查询中选择不同过滤器上的聚合

> ID：13731761
> 
> 赞同：0
> 
> 时间：2012-12-05T20:25:45.043
> 
> 标签：sql, sql-server, sql-server-2008, tsql

这是我的查询

```
 SELECT
    client_id,
   TimesTested,
    CAST(COUNT(*) AS varchar(30)) AS count,
    CAST(AVG(testfreq) as varchar(30)) as TestFreq,
    CAST(STDEV(TestFreq) as varchar(30)) Stdv
  FROM counted
  GROUP BY
    client_id,
    TimesTested 
```

有用; 但是，我需要过滤 testfreq>0 的 AVG 和 STDEV，但我需要不过滤 count(*)。

最接近的是：

```
 SELECT
    client_id,
   TimesTested,
    CAST(COUNT(*) AS varchar(30)) AS count,
    CAST(AVG(testfreq) as varchar(30)) as TestFreq,
    CAST(STDEV(TestFreq) as varchar(30)) Stdv
  FROM counted
  where testfreq>0  --however I don't want this filtered applied to count(*)
  GROUP BY
    client_id,
    TimesTested 
```

非常感谢您的指导！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:29:17.213

您应该能够`CASE`在聚合中使用类似于以下内容的语句：

```
SELECT client_id,
   TimesTested,
   CAST(COUNT(*) AS varchar(30)) AS count,
   CAST(AVG(case when testfreq>0 then testfreq end) as varchar(30)) as TestFreq,
   CAST(STDEV(case when testfreq>0 then TestFreq end) as varchar(30)) Stdv
FROM counted
GROUP BY client_id,  TimesTested 
```

我不确定为什么需要将这些值作为 varchars，是否有理由需要将这些值转换为`varchar`？

我将保持原样的值：

```
SELECT client_id,
   TimesTested,
   COUNT(*) AS count,
   AVG(case when testfreq>0 then testfreq end) as TestFreq,
   STDEV(case when testfreq>0 then TestFreq end) Stdv
FROM counted
GROUP BY client_id,  TimesTested 
```

# r - R绘图轴刻度标签

> ID：13731765
> 
> 赞同：2
> 
> 时间：2012-12-05T20:25:56.000
> 
> 标签：r

当我在 R 中执行绘图功能时，我会在轴上得到标记，例如：

```
set.seed(123)
plot(matrix(rnorm(100),50,2)) 
```

在 {-2,-1,0,1,2} 的（y 轴）上放置标记。

我的问题是：

如何将这些值作为向量返回？就像是：

```
> GetTickMarkValues()
[1] -2 -1  0  1  2 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:40:50.870

这为您提供了刻度线的极值以及它们之间的间隔数：

```
x <- 1:5
y <- 1:5
plot(x,y)  
par("xaxp")
[1] 1 5 4 
```

# ios - REST NSMutableURLRequest 与 httpmethod PUT 或 DELETE

> ID：13731767
> 
> 赞同：1
> 
> 时间：2012-12-05T20:25:58.587
> 
> 标签：ios, rest, nsurlrequest, nsmutableurlrequest

POST 请求一切正常，但找不到使用 PUT 或 DELETE 的方法？

```
 NSMutableURLRequest *mutableRequest = [[NSMutableURLRequest alloc] init];        
[mutableRequest setURL:[NSURL URLWithString:[NSString 

    stringWithFormat:@"http://abc.com/update/27"]]];
            [mutableRequest setHTTPMethod:@"PUT"];
            [mutableRequest addValue:@"application/json" forHTTPHeaderField:@"Accept"];
            [mutableRequest addValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
            [mutableRequest addValue:@"PUT" forHTTPHeaderField:@"X-HTTP-Method-Override"];
            [mutableRequest addValue:sessionId forHTTPHeaderField:@"ZURMO_SESSION_ID"];
            [mutableRequest addValue:token forHTTPHeaderField:@"ZURMO_TOKEN"];
            [mutableRequest addValue:@"REST" forHTTPHeaderField:@"ZURMO_API_REQUEST_TYPE"];
            NSString *postLength = [NSString stringWithFormat:@"%d",[postdata3 length]];
            [mutableRequest addValue:postLength forHTTPHeaderField:@"Content-Length"];
            [mutableRequest setHTTPBody:postdata3] 
```

这就是服务器端 (PHP) 使用 PUT、GET、POST 和 DELETE 处理 api 调用的方式。任何帮助将不胜感激谢谢

```
public static function createApiCall($url, $method, $headers, $data = array())
    {
        if ($method == 'PUT')
        {
            $headers[] = 'X-HTTP-Method-Override: PUT'; //also tried this one to add header
        }

        $handle = curl_init();
        curl_setopt($handle, CURLOPT_URL, $url);
        curl_setopt($handle, CURLOPT_HTTPHEADER, $headers);
        curl_setopt($handle, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($handle, CURLOPT_SSL_VERIFYHOST, false);
        curl_setopt($handle, CURLOPT_SSL_VERIFYPEER, false);

        switch($method)
        {
            case 'GET':
                break;
            case 'POST':
                curl_setopt($handle, CURLOPT_POST, true);
                curl_setopt($handle, CURLOPT_POSTFIELDS, http_build_query($data));
                break;
            case 'PUT':
                curl_setopt($handle, CURLOPT_CUSTOMREQUEST, 'PUT');
                curl_setopt($handle, CURLOPT_POSTFIELDS, http_build_query($data));
                break;
            case 'DELETE':
                curl_setopt($handle, CURLOPT_CUSTOMREQUEST, 'DELETE');
                break;
        }
        $response = curl_exec($handle);
        return $response;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:35:42.280

不知道明确的错误很难说。

PUT 或DELETE 的使用通常由称为_method 的“隐藏参数”实现。它不仅特定于例如 Spring MVC 的标签库，而且还被其他一些客户端框架使用。Spring 只是遵循惯例，就像它一样。

为了正确使用它，您必须知道后端如何处理 PUT 或 DELETE 请求。

例如，在 spring 中，您需要定义一个过滤器（HiddenHttpMethodFilter，参见 javadoc），它将 _method 参数转换为 HttpServletRequest 中的“真实”HTTP 方法表示。这是作为过滤器完成的，以强调缺少 PUT 和 DELETE 是浏览器问题的事实 - servlet API 很好地支持它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T17:00:13.033

在第 5 行，尝试使用：

**[mutableRequest setHTTPMethod:@"POST"];**

由于您使用“x-http-method-override”HTTP 标头，我认为实际的 HTTP 请求应该是 POST。但正如上一个答案中所述，它实际上取决于 API 服务器中使用的后端框架。“x-http-method-override”在 PHP/Symfony 上运行良好。

# css - Firebug/Console 风格的悬停效果

> ID：13731768
> 
> 赞同：1
> 
> 时间：2012-12-05T20:25:59.043
> 
> 标签：css, console, firebug, highlight

我想我知道这个问题的答案，但只是认为可能有一些天才知道如何做到这一点......

基本上，我正在制作一种网站编辑器，如果我可以复制 Firebug 和 Chrome 控制台突出显示元素的方式，当您将鼠标悬停在这些检查器的 html/元素选项卡中的代码上时，这将非常方便......

它不是我可以用背景效果做的，因为它不会突出显示整个 Div（内容显示在突出显示的上方）而且我认为无论如何都不会在所有内容的顶部制作一个 div 叠加层，但它没有阻止鼠标悬停在底层元素上...

有人有什么想法吗？是否有任何浏览器特定的代码可以实现这种事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:34:31.913

一般来说，Firefox 扩展主要是 JavaScript。[由于 Firebug 是 BSD 许可的，因此您可以在其项目站点](http://code.google.com/p/fbug/)上浏览其源代码。也许您会找到相关代码并了解如何解决您的特定任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:55:36.630

您可以在鼠标悬停时在 CSS 中添加一个`outline`- 这将突出显示元素而不改变其位置，因为`outline`不会影响布局。A`box-shadow`也可以类似地工作。

事实上，在我看来，Firebug`box-shadow`为元素添加了深蓝色以突出显示它们。

# c# - 如何在网格视图中将负数放在括号中

> ID：13731770
> 
> 赞同：-1
> 
> 时间：2012-12-05T20:26:04.293
> 
> 标签：c#, asp.net, sql

> **可能重复：**
> [如何在显示日期时阻止时间在 GridView 中显示？](https://stackoverflow.com/questions/711004/how-can-i-stop-the-time-from-displaying-in-a-gridview-when-displaying-a-date)

我在名为“总计”的列中有负数的网格视图，我喜欢将所有负数放在括号中。

### 例如

```
Total
76  
(-66)
646  
(-76)  
(-10)  
(-6) 
16  
676 
```

我正在使用带有 C# 的 ASP.NET，我应该如何去做。

或者我可以在 SQL 查询中做吗？因为网格视图是通过 sql 数据源填充的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T21:46:54.630

看看这个简单的例子。我正在使用 Gridview：

C＃

```
public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        List<int> x = new List<int>() { 76, -66, 646, -76, -10, -6, 16, 676 };
        this.GridView1.DataSource = x;
        this.GridView1.DataBind();
    }
    protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowType == DataControlRowType.DataRow)
        {
            if (Convert.ToInt32(e.Row.Cells[0].Text) < 0)
            {
                e.Row.Cells[0].Text = "(" + e.Row.Cells[0].Text + ")";
            }
        }

    }
} 
```

输出：

```
Item
76
(-66)
646
(-76)
(-10)
(-6)
16
676 
```

祝你好运

编辑：我不会修改 SQL 的输出以使其仅用于此目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T21:57:23.293

我会做一些类似于 Hanlet Escano 的事情，但不是解析，我会像这样处理数据对象：

默认.aspx

```
<asp:GridView ID="gvGrid" runat="server" AutoGenerateColumns="false" OnRowDataBound="gvGrid_RowDataBound">
  <Columns>
    <asp:TemplateField>
      <ItemTemplate>
        <asp:Literal ID="litData" runat="server" />
      </ItemTemplate>
    </asp:TemplateField>
  </Columns>
</asp:GridView> 
```

默认.aspx.cs

protected void Page_Load(object sender, EventArgs e) { if (!IsPostBack) { //生成数据 var data = new List() { 76, -66, 646, -76, -10, -6, 16, 676 };

```
 gvGrid.DataSource = data;
      gvGrid.DataBind();
    }
  }

  protected void gvGrid_RowDataBound(object sender, GridViewRowEventArgs e)
  {
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
      //Strongly Type Controls
      var litData = (Literal)e.Row.FindControl("litData");

      //Strongly Type Data
      var data = (int)e.Row.DataItem;

      //Display Data
      if (data < 0)
      {
        litData.Text = "[" + data.ToString() + "]";
      }
      else
      {
        litData.Text = data.ToString();
      }
    }
  } 
```

这样做有几个优点，数据已经以其本机形式 (int) 存储，它只是在对象变量中。

其次，如果将来您需要处理具有更复杂数据对象（Person/Business/Foo/Bar 对象）的多个列，则可以使用相同的技术。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T21:43:08.707

使用gridview的onRowDataBound事件并根据需要更新单元格，添加括号和东西:)

一探究竟：

[http://www.dotnetfunda.com/forums/thread9403-get-the-particular-value-in-gridview-using-rowdatabound-in-csharpnet.aspx](http://www.dotnetfunda.com/forums/thread9403-get-the-particular-value-in-gridview-using-rowdatabound-in-csharpnet.aspx)

# android - Android Assetmanager 字符串解析

> ID：13731776
> 
> 赞同：0
> 
> 时间：2012-12-05T20:26:34.887
> 
> 标签：android

我正在尝试使用assetmanager解析字符串引用的xml文件，多亏了SO，我得到了很多帮助，这就是我到目前为止所拥有的。

```
Document doc = db.parse(assetManager.open(Resources.getSystem().getString(R.string.FileName))); 
```

字符串文件名是我的 questions.xml 文件，我正在这样做，所以最终我可以在我的应用程序上为多个 xml 文件强制本地化。但是我的应用程序无法读取 R.string.FileName，并且应用程序出错。有谁可以帮我离开这里吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T20:43:41.730

[`Resources.getSystem()`](http://developer.android.com/reference/android/content/res/Resources.html#getSystem%28%29)仅读取系统资源 ( `android.R.x.x`)。

如果您的代码在 中`Activity`，请使用以下内容：

```
String fname = getResources().getString(R.string.FileName);
Document doc = db.parse(assetManager.open(fname)); 
```

否则，使用这个：

```
String fname = context.getResources().getString(R.string.FileName); // `context` is a Context object which you need to pass to this.
Document doc = db.parse(assetManager.open(fname)); 
```

# ruby-on-rails - 如何在 OS X Mountain Lion 上彻底卸载 RailsInstaller

> ID：13731783
> 
> 赞同：1
> 
> 时间：2012-12-05T20:26:53.353
> 
> 标签：ruby-on-rails, ruby, macos, osx-mountain-lion

它像 rm -rf /opt/sm 一样简单，还是我应该查看其他文件夹？

我还需要改变什么？是否有可以下载/执行的干净卸载程序？

我正在使用 RailsInstaller 1.0.3。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T20:34:00.913

[卸载 Engine Yard 的 RailsInstaller](http://rachelober.com/2012/10/03/uninstall-engine-yards-os-x-railsinstaller/)

如果您运行的是旧版本

`/opt/rix/uninstall.app`

除此以外

`open /Applications/RailsInstallerOSX-Uninstaller.app`

# c++ - 快速排序后我的数据库的最终值损坏

> ID：13731793
> 
> 赞同：0
> 
> 时间：2012-12-05T20:27:13.773
> 
> 标签：c++, database, qsort

因此，我设法编写了一个程序，将 OpAmp 数据存储在一个小型数据库（10 条数据）中，一切似乎都很好，直到我执行快速排序，按 Slew Rate 升序排序。当我这样做时，我数据库中的最后一条数据作为一系列与输入的数据无关的符号返回。这不会在按名称快速排序时发生。有人知道出了什么问题吗？这是我的代码...

```
//File: Task1.cpp
//Title: Structured Programming in C++
//Created: 05/12/2012
//Author: Nicole ...
//ID Number: ...
//Accompanying Files: database.txt
//Description:A program which allows 
#include <iostream>
#include <fstream>
#include <string.h>
using namespace std;

// the format of each of the elements in the database
struct OpAmps {
  char Name[20];  // the name of the op-amp (e.g. "741")
  unsigned int PinCount;  // the number of pins in the package
  double SlewRate;  // the slew rate in volts per microsecond
};

// the length of the fixed array to be used for database - must be at least one
// and no greater the maximum value allowed in an unsigned long (see the file limits.h)
#define DATABASE_MAX 10

// file used for the database
#define DATABASE_FILENAME "database.txt"

// function prototypes
void Enter(OpAmps&, unsigned long&);
void Save(OpAmps[], unsigned long);
void Load(OpAmps[], unsigned long&);
void Sort(OpAmps[], unsigned long);
void Display(OpAmps[], unsigned long);
void QuickSortName (OpAmps[], unsigned long);
void QuickSortSlewRate (OpAmps[], unsigned long);

// Control the entering, saving, loading, sorting and displaying of elements in the database
// Arguments: None
// Returns: 0 on completion
int main()
{
  OpAmps OpAmp[DATABASE_MAX];   // the database
  unsigned long database_length = 0;  // the number of elements in the database
  char UserInput;

  // loop until the user wishes to exit
  while (1) {

    // show the menu of options
    cout << endl;
    cout << "Op-amp database menu" << endl;
    cout << "--------------------" << endl;
    cout << "1\. Enter a new op-amp into the database" << endl;
    cout << "2\. Save the database to disk" << endl;
    cout << "3\. Load the database from disk" << endl;
    cout << "4\. Sort the database" << endl;
    cout << "5\. Display the database" << endl;
    cout << "6\. Exit from the program" << endl << endl;

    // get the user's choice
    cout << "Enter your option: ";
    cin >> UserInput;
    cout << endl;

    // act on the user's input
    switch(UserInput) {
      case '1':
            Enter(OpAmp[database_length], database_length);
         break;

      case '2':
            Save(OpAmp, database_length);
        break;

      case '3':
            Load(OpAmp, database_length);
        break;

      case '4':
            Sort(OpAmp, database_length);
        break;

      case '5':
            Display(OpAmp, database_length);
        break;

      case '6':
        return 0;

      default:
            cout << "Invalid Entry" << endl << endl;
        break;
    }
  }
}

void Enter(OpAmps& eOpAmp, unsigned long& database_length)
{
    cout<<"1) Enter Data"<<endl;

        if (database_length == DATABASE_MAX)
        {
            cout <<endl << "Database is full!!!" << endl;
        }
        else
        {
            cout << endl << "Name of OpAmp: ";
            cin >> eOpAmp.Name;
            cout << endl << "Number of Pins on OpAmp: ";
            cin >> eOpAmp.PinCount;
            cout << endl << "Slew Rate of OpAmp: ";
            cin >> eOpAmp.SlewRate;
            cout << endl<< "All Items Added!" << endl << "Now Save Your Data!" << endl;
            database_length++;
        }
}

void Save(OpAmps sOpAmp[], unsigned long database_length)
{
    cout<<"2) Save Data"<<endl;
    fstream output_file; 
    output_file.open(DATABASE_FILENAME, ios::out);

    if (!output_file.good())
        {
            cout << "Error Loading File!!!" << endl;
            return;
        }
    else
        {
            int i;
            output_file << database_length<< endl<<endl;
            for(i=0;i<=database_length-1;i++)
        {
            output_file << sOpAmp[i].Name << endl; 
            output_file << sOpAmp[i].PinCount<< endl;
            output_file << sOpAmp[i].SlewRate;
        }
            cout << endl << "Data Saved" <<endl;
        }
    output_file.close();
}

void Load(OpAmps lOpAmp[], unsigned long& database_length)
{
    cout<<"3) Load Data"<<endl; 
    fstream input_file;
    input_file.open(DATABASE_FILENAME, ios::in);
    if (!input_file.good())
        {
            cout << "Error Loading File!!!" << endl;
            return;
        }
    else
        {
            input_file >> database_length;
            for(int i=0;i<=database_length-1;i++)
                {
                    input_file >> lOpAmp[i].Name; 
                    input_file >> lOpAmp[i].PinCount;
                    input_file >> lOpAmp[i].SlewRate;
                }
        }
    input_file.close();
}

void Sort(OpAmps qOpAmp[], unsigned long database_length)
{
  cout<<"4) Sort Data"<<endl;
  char UserInput;
  // show the menu of options
    cout << endl;
    cout << "Sorting options" << endl;
    cout << "---------------" << endl;
    cout << "1\. To sort by name" << endl;
    cout << "2\. To sort by slew rate" << endl;
    cout << "3\. No sorting" << endl << endl;
    // get the user's choice of sorting operation required
    cout << "Enter your option: ";
    cin >> UserInput;
    // act on the user's input
    switch (UserInput) {
        case '1':
            cout <<"Sort By Name"<<endl;
            QuickSortName (qOpAmp, database_length);
        break;
        case '2':
            cout <<"Sort By Slew Rate"<<endl;
            QuickSortSlewRate (qOpAmp, database_length);
        break;
        case '3':
            cout <<"No Sort"<<endl;
        break;
        default:
            cout <<"Invalid Entry"<< endl;
            return;
        break;
    }
}

void QuickSortName (OpAmps nOpAmp[], unsigned long database_length)
{
    OpAmps temp;    // Local variable used to swap records
    for(int i=0; i<database_length; i++)
    {
        for(int i=0; i<database_length; i++)
        {
            if(strcmp(nOpAmp[i].Name, nOpAmp[i+1].Name)>0)
            {
                temp = nOpAmp[i];
                nOpAmp[i] = nOpAmp[i+1];
                nOpAmp[i+1] = temp;
            }
        }
    }
    Display (nOpAmp, database_length);
}
void QuickSortSlewRate (OpAmps rOpAmp[], unsigned long database_length)
{
    OpAmps temp;    // Local variable used to swap records
    for(int i=0; i<database_length; i++)
    {
        for(int i=0; i<database_length; i++)
        {
            if(rOpAmp[i].SlewRate > rOpAmp[i+1].SlewRate)
            {
                temp = rOpAmp[i];
                rOpAmp[i] = rOpAmp[i+1];
                rOpAmp[i+1] = temp;
            }
        }
    }
    Display (rOpAmp, database_length);
}

void Display(OpAmps dOpAmp[], unsigned long database_length)
{
    cout<<"5) Display Data"<<endl;
    if (database_length == 0)
    {
        cout<<endl<< "Database is Empty!!!" <<endl;
    }
    else
    {   
        cout <<endl<<database_length<<" items are in the database" << endl;
        for (unsigned long i = 0; i <= (database_length-1); i++)
        {
            cout << endl << "Database Entry Number: " << i+1<< endl;
            cout << "Name: " << dOpAmp[i].Name <<endl;
            cout << "PinCount: " << dOpAmp[i].PinCount<<endl;
            cout << "Slew Rate: " << dOpAmp[i].SlewRate<< endl <<endl;

        }
    }
} 
```

在您输入每条数据后，选择保存，然后输入下一条，一旦您输入了任意数量的项目，加载数据，然后对数据进行排序。你会看到这个问题。任何帮助都可以解决这个错误！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:40:21.460

```
void QuickSortSlewRate (OpAmps rOpAmp[], unsigned long database_length)
{
    OpAmps temp;    // Local variable used to swap records
    for(int i=0; i<database_length; i++)
    {
        for(int i=0; i<database_length; i++)
        { 
```

您的嵌套循环使用相同的变量 (i)。

```
if(rOpAmp[i].SlewRate > rOpAmp[i+1].SlewRate) 
```

当 i 等于 (database_length - 1) 时，您将在此处离开数组的末尾。

```
void Save(OpAmps sOpAmp[], unsigned long database_length)
{
    ...
        for(i=0;i<=database_length-1;i++)
        {
            output_file << sOpAmp[i].Name << endl; 
            output_file << sOpAmp[i].PinCount<< endl;
            output_file << sOpAmp[i].SlewRate;         // **missing endl**
        } 
```

并且您的文件格式可能已损坏 -`endl`您的保存功能中缺少文件。

既然您使用的是 C++，为什么不使用`std::sort`慢速冒泡排序呢？

```
// compare function for std::sort
bool CompareSlewRate(const OpAmps& a, const OpAmps& b)
{
    return a.SlewRate < b.SlewRate;
}

void QuickSortSlewRate (OpAmps rOpAmp[], unsigned long database_length)
{
    std::sort(rOpAmp, rOpAmp + database_length, CompareSlewRate);
    Display (rOpAmp, database_length);
} 
```

# c# - 在 linq 中创建批处理

> ID：13731796
> 
> 赞同：141
> 
> 时间：2012-12-05T20:27:36.840
> 
> 标签：c#, linq

有人可以建议一种在 linq 中创建一定大小的批次的方法吗？

理想情况下，我希望能够以可配置数量的块执行操作。

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2012-12-05T20:29:25.560

您无需编写任何代码。使用[MoreLINQ](https://github.com/morelinq/MoreLINQ/blob/master/MoreLinq/Batch.cs) Batch 方法，它将源序列批处理成大小合适的存储桶（MoreLINQ 可作为 NuGet 包提供，您可以安装）：

```
int size = 10;
var batches = sequence.Batch(size); 
```

其实现为：

```
public static IEnumerable<IEnumerable<TSource>> Batch<TSource>(
                  this IEnumerable<TSource> source, int size)
{
    TSource[] bucket = null;
    var count = 0;

    foreach (var item in source)
    {
        if (bucket == null)
            bucket = new TSource[size];

        bucket[count++] = item;
        if (count != size)
            continue;

        yield return bucket;

        bucket = null;
        count = 0;
    }

    if (bucket != null && count > 0)
        yield return bucket.Take(count).ToArray();
} 
```

* * *

## 回答 #2

> 赞同：105
> 
> 时间：2012-12-05T20:31:03.767

```
public static class MyExtensions
{
    public static IEnumerable<IEnumerable<T>> Batch<T>(this IEnumerable<T> items,
                                                       int maxItems)
    {
        return items.Select((item, inx) => new { item, inx })
                    .GroupBy(x => x.inx / maxItems)
                    .Select(g => g.Select(x => x.item));
    }
} 
```

用法是：

```
List<int> list = new List<int>() { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 };

foreach(var batch in list.Batch(3))
{
    Console.WriteLine(String.Join(",",batch));
} 
```

**输出：**

```
0,1,2
3,4,5
6,7,8
9 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2016-12-21T21:23:00.363

如果您从`sequence`定义为 an开始`IEnumerable<T>`，并且您知道它可以安全地被多次枚举（例如，因为它是一个数组或列表），您可以使用这个简单的模式来批量处理元素：

```
while (sequence.Any())
{
    var batch = sequence.Take(10);
    sequence = sequence.Skip(10);

    // do whatever you need to do with each batch here
} 
```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2017-06-12T17:26:34.270

这是一个完全惰性、低开销、单功能的 Batch 实现，不做任何累加。在EricRoller 的帮助下，基于 Nick Whaley 的[解决方案（并修复了其中的问题）。](https://stackoverflow.com/a/17598878/213246)

迭代直接来自底层的 IEnumerable，因此元素必须以严格的顺序枚举，并且访问不超过一次。如果某些元素没有在内部循环中使用，它们将被丢弃（并尝试通过保存的迭代器再次访问它们将抛出`InvalidOperationException: Enumeration already finished.`）。

[您可以在.NET Fiddle](https://dotnetfiddle.net/FEVQpX)测试完整的示例。

```
public static class BatchLinq
{
    public static IEnumerable<IEnumerable<T>> Batch<T>(this IEnumerable<T> source, int size)
    {
        if (size <= 0)
            throw new ArgumentOutOfRangeException("size", "Must be greater than zero.");
        using (var enumerator = source.GetEnumerator())
            while (enumerator.MoveNext())
            {
                int i = 0;
                // Batch is a local function closing over `i` and `enumerator` that
                // executes the inner batch enumeration
                IEnumerable<T> Batch()
                {
                    do yield return enumerator.Current;
                    while (++i < size && enumerator.MoveNext());
                }

                yield return Batch();
                while (++i < size && enumerator.MoveNext()); // discard skipped items
            }
    }
} 
```

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2013-07-11T16:36:54.253

以上所有方法在大批量或低内存空间的情况下都表现得非常糟糕。必须编写我自己的管道（注意任何地方都没有项目积累）：

```
public static class BatchLinq {
    public static IEnumerable<IEnumerable<T>> Batch<T>(this IEnumerable<T> source, int size) {
        if (size <= 0)
            throw new ArgumentOutOfRangeException("size", "Must be greater than zero.");

        using (IEnumerator<T> enumerator = source.GetEnumerator())
            while (enumerator.MoveNext())
                yield return TakeIEnumerator(enumerator, size);
    }

    private static IEnumerable<T> TakeIEnumerator<T>(IEnumerator<T> source, int size) {
        int i = 0;
        do
            yield return source.Current;
        while (++i < size && source.MoveNext());
    }
} 
```

**编辑：**这种方法的已知问题是，在移动到下一个批次之前，必须对每个批次进行枚举和完全枚举。例如，这不起作用：

```
//Select first item of every 100 items
Batch(list, 100).Select(b => b.First()) 
```

* * *

## 回答 #6

> 赞同：25
> 
> 时间：2021-06-21T00:34:08.747

.NET 6.0 添加了一个[`Enumerable.Chunk()`](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.chunk?view=net-6.0)扩展方法。

例子：

```
var list = new List<int> { 1, 2, 3, 4, 5, 6, 7 };

var chunks = list.Chunk(3);
// returns { { 1, 2, 3 }, { 4, 5, 6 }, { 7 } } 
```

对于那些无法升级[的人，源代码在 GitHub 上可用](https://github.com/dotnet/runtime/blob/main/src/libraries/System.Linq/src/System/Linq/Chunk.cs)。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2019-06-27T08:37:49.870

我想知道为什么没有人发布过老式的 for 循环解决方案。这是一个：

```
List<int> source = Enumerable.Range(1,23).ToList();
int batchsize = 10;
for (int i = 0; i < source.Count; i+= batchsize)
{
    var batch = source.Skip(i).Take(batchsize);
} 
```

这种简单性是可能的，因为 Take 方法：

> ... 枚举`source`并产生元素，直到`count`元素被产生或`source`不再包含元素。如果`count`超过 中的元素个数，则返回`source`的所有元素`source`

免责声明：

在循环内使用 Skip 和 Take 意味着可枚举对象将被枚举多次。如果 enumerable 被延迟，这是很危险的。它可能会导致多次执行数据库查询、Web 请求或文件读取。此示例明确用于未延迟的 List 的使用，因此问题较小。它仍然是一个缓慢的解决方案，因为每次调用它时，skip 都会枚举集合。

这也可以使用该`GetRange`方法解决，但它需要额外的计算来提取可能的剩余批次：

```
for (int i = 0; i < source.Count; i += batchsize)
{
    int remaining = source.Count - i;
    var batch = remaining > batchsize  ? source.GetRange(i, batchsize) : source.GetRange(i, remaining);
} 
```

这是处理这个问题的第三种方法，它适用于 2 个循环。这确保集合仅被枚举 1 次！：

```
int batchsize = 10;
List<int> batch = new List<int>(batchsize);

for (int i = 0; i < source.Count; i += batchsize)
{
    // calculated the remaining items to avoid an OutOfRangeException
    batchsize = source.Count - i > batchsize ? batchsize : source.Count - i;
    for (int j = i; j < i + batchsize; j++)
    {
        batch.Add(source[j]);
    }           
    batch.Clear();
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2019-07-26T16:48:56.133

这是 Nick Whaley 的 ( [link](https://stackoverflow.com/a/17598878/11178549) ) 和 infogulch 的 ( [link](https://stackoverflow.com/a/44505349/11178549) ) 惰性`Batch`实现的尝试改进。这个很严格。您要么以正确的顺序枚举批次，要么得到异常。

```
public static IEnumerable<IEnumerable<TSource>> Batch<TSource>(
    this IEnumerable<TSource> source, int size)
{
    if (size <= 0) throw new ArgumentOutOfRangeException(nameof(size));
    using (var enumerator = source.GetEnumerator())
    {
        int i = 0;
        while (enumerator.MoveNext())
        {
            if (i % size != 0) throw new InvalidOperationException(
                "The enumeration is out of order.");
            i++;
            yield return GetBatch();
        }
        IEnumerable<TSource> GetBatch()
        {
            while (true)
            {
                yield return enumerator.Current;
                if (i % size == 0 || !enumerator.MoveNext()) break;
                i++;
            }
        }
    }
} 
```

这是`Batch`type 来源的惰性实现`IList<T>`。这对枚举没有任何限制。批次可以按任何顺序部分列举，也可以多次列举。尽管如此，在枚举期间不修改集合的限制仍然存在。这是通过`enumerator.MoveNext()`在产生任何块或元素之前进行虚拟调用来实现的。不利的一面是枚举器未处理，因为不知道枚举何时结束。

```
public static IEnumerable<IEnumerable<TSource>> Batch<TSource>(
    this IList<TSource> source, int size)
{
    if (size <= 0) throw new ArgumentOutOfRangeException(nameof(size));
    var enumerator = source.GetEnumerator();
    for (int i = 0; i < source.Count; i += size)
    {
        enumerator.MoveNext();
        yield return GetChunk(i, Math.Min(i + size, source.Count));
    }
    IEnumerable<TSource> GetChunk(int from, int toExclusive)
    {
        for (int j = from; j < toExclusive; j++)
        {
            enumerator.MoveNext();
            yield return source[j];
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-05-04T19:04:05.333

与 MoreLINQ 相同的方法，但使用 List 而不是 Array。我还没有做过基准测试，但可读性对某些人来说更重要：

```
 public static IEnumerable<IEnumerable<T>> Batch<T>(this IEnumerable<T> source, int size)
    {
        List<T> batch = new List<T>();

        foreach (var item in source)
        {
            batch.Add(item);

            if (batch.Count >= size)
            {
                yield return batch;
                batch.Clear();
            }
        }

        if (batch.Count > 0)
        {
            yield return batch;
        }
    } 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2021-08-24T06:42:36.323

`Batch`这是我能想到的最干净的版本：

```
public static IEnumerable<IEnumerable<T>> Batch<T>(this IEnumerable<T> source, int count)
{
    if (source == null) throw new System.ArgumentNullException("source");
    if (count <= 0) throw new System.ArgumentOutOfRangeException("count");
    using (var enumerator = source.GetEnumerator())
    {
        IEnumerable<T> BatchInner()
        {
            int counter = 0;
            do
                yield return enumerator.Current;
            while (++counter < count && enumerator.MoveNext());
        }
        while (enumerator.MoveNext())
            yield return BatchInner().ToArray();
    }
} 
```

使用此代码：

```
Console.WriteLine(String.Join(Environment.NewLine,
    Enumerable.Range(0, 20).Batch(8).Select(xs => String.Join(",", xs)))); 
```

我得到：

```
0,1,2,3,4,5,6,7
8,9,10,11,12,13,14,15
16,17,18,19 
```

* * *

请务必注意，在“”和“”的答案中，此代码失败：

```
var e = Enumerable.Range(0, 20).Batch(8).ToArray();

Console.WriteLine(String.Join(Environment.NewLine, e.Select(xs => String.Join(",", xs))));
Console.WriteLine();
Console.WriteLine(String.Join(Environment.NewLine, e.Select(xs => String.Join(",", xs)))); 
```

根据他们的回答，它给出了：

```
19
19
19

19
19
19 
```

由于内部可枚举没有被计算为数组。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-04-16T10:12:10.210

因此，戴上功能性帽子，这似乎微不足道....但在 C# 中，有一些明显的缺点。

你可能会认为这是 IEnumerable 的展开（谷歌它，你可能会在一些 Haskell 文档中结束，但可能有一些 F# 的东西使用展开，如果你知道 F#，眯着眼睛看 Haskell 文档，它会让感觉）。

展开与折叠（“聚合”）相关，除了不是遍历输入 IEnumerable，而是遍历输出数据结构（IEnumerable 和 IObservable 之间的关系类似，实际上我认为 IObservable 确实实现了一个称为生成的“展开”。 ..)

无论如何，首先你需要一个展开方法，我认为这是可行的（不幸的是，它最终会为大型“列表”炸毁堆栈......你可以在 F# 中使用 yield! ​​而不是 concat 安全地编写它）；

```
 static IEnumerable<T> Unfold<T, U>(Func<U, IEnumerable<Tuple<U, T>>> f, U seed)
    {
        var maybeNewSeedAndElement = f(seed);

        return maybeNewSeedAndElement.SelectMany(x => new[] { x.Item2 }.Concat(Unfold(f, x.Item1)));
    } 
```

这有点迟钝，因为 C# 没有实现一些功能性语言认为理所当然的东西......但它基本上需要一个种子，然后生成 IEnumerable 和下一个种子中下一个元素的“也许”答案（也许在 C# 中不存在，所以我们使用 IEnumerable 来伪造它），并连接其余的答案（我不能保证“O（n？）”的复杂性）。

一旦你这样做了；

```
 static IEnumerable<IEnumerable<T>> Batch<T>(IEnumerable<T> xs, int n)
    {
        return Unfold(ys =>
            {
                var head = ys.Take(n);
                var tail = ys.Skip(n);
                return head.Take(1).Select(_ => Tuple.Create(tail, head));
            },
            xs);
    } 
```

这一切看起来都很干净......您将“n”元素作为 IEnumerable 中的“下一个”元素，而“尾部”是未处理列表的其余部分。

如果头部什么都没有……你就结束了……你返回“Nothing”（但伪装成一个空的 IEnumerable>）……否则你返回头部元素和尾部以进行处理。

您可能可以使用 IObservable 来执行此操作，可能已经存在类似“批处理”的方法，您可能可以使用它。

如果堆栈溢出的风险令人担忧（它可能应该），那么您应该在 F# 中实现（并且可能已经有一些 F# 库（FSharpX？））。

（我只对此进行了一些基本测试，因此可能存在一些奇怪的错误）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-04-12T06:57:20.003

我很晚才加入，但我发现了一些更有趣的东西。

所以我们可以在这里使用`Skip`以`Take`获得更好的性能。

```
public static class MyExtensions
    {
        public static IEnumerable<IEnumerable<T>> Batch<T>(this IEnumerable<T> items, int maxItems)
        {
            return items.Select((item, index) => new { item, index })
                        .GroupBy(x => x.index / maxItems)
                        .Select(g => g.Select(x => x.item));
        }

        public static IEnumerable<T> Batch2<T>(this IEnumerable<T> items, int skip, int take)
        {
            return items.Skip(skip).Take(take);
        }

    } 
```

接下来我检查了 100000 条记录。循环仅在以下情况下需要更多时间`Batch`

控制台应用程序的代码。

```
static void Main(string[] args)
{
    List<string> Ids = GetData("First");
    List<string> Ids2 = GetData("tsriF");

    Stopwatch FirstWatch = new Stopwatch();
    FirstWatch.Start();
    foreach (var batch in Ids2.Batch(5000))
    {
        // Console.WriteLine("Batch Ouput:= " + string.Join(",", batch));
    }
    FirstWatch.Stop();
    Console.WriteLine("Done Processing time taken:= "+ FirstWatch.Elapsed.ToString());

    Stopwatch Second = new Stopwatch();

    Second.Start();
    int Length = Ids2.Count;
    int StartIndex = 0;
    int BatchSize = 5000;
    while (Length > 0)
    {
        var SecBatch = Ids2.Batch2(StartIndex, BatchSize);
        // Console.WriteLine("Second Batch Ouput:= " + string.Join(",", SecBatch));
        Length = Length - BatchSize;
        StartIndex += BatchSize;
    }

    Second.Stop();
    Console.WriteLine("Done Processing time taken Second:= " + Second.Elapsed.ToString());
    Console.ReadKey();
}

static List<string> GetData(string name)
{
    List<string> Data = new List<string>();
    for (int i = 0; i < 100000; i++)
    {
        Data.Add(string.Format("{0} {1}", name, i.ToString()));
    }

    return Data;
} 
```

所用时间是这样的。

**首先 - 00:00:00.0708 , 00:00:00.0660**

**第二个（接受并跳过一个） - 00:00:00.0008、00:00:00.0008**

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-12-02T23:10:34.127

我编写了一个自定义的 IEnumerable 实现，它在没有 linq 的情况下工作，并保证对数据进行单一枚举。它还可以完成所有这些，而不需要在大型数据集上导致内存爆炸的后备列表或数组。

以下是一些基本测试：

```
 [Fact]
    public void ShouldPartition()
    {
        var ints = new List<int> {0, 1, 2, 3, 4, 5, 6, 7, 8, 9};
        var data = ints.PartitionByMaxGroupSize(3);
        data.Count().Should().Be(4);

        data.Skip(0).First().Count().Should().Be(3);
        data.Skip(0).First().ToList()[0].Should().Be(0);
        data.Skip(0).First().ToList()[1].Should().Be(1);
        data.Skip(0).First().ToList()[2].Should().Be(2);

        data.Skip(1).First().Count().Should().Be(3);
        data.Skip(1).First().ToList()[0].Should().Be(3);
        data.Skip(1).First().ToList()[1].Should().Be(4);
        data.Skip(1).First().ToList()[2].Should().Be(5);

        data.Skip(2).First().Count().Should().Be(3);
        data.Skip(2).First().ToList()[0].Should().Be(6);
        data.Skip(2).First().ToList()[1].Should().Be(7);
        data.Skip(2).First().ToList()[2].Should().Be(8);

        data.Skip(3).First().Count().Should().Be(1);
        data.Skip(3).First().ToList()[0].Should().Be(9);
    } 
```

对数据进行分区的扩展方法。

```
/// <summary>
/// A set of extension methods for <see cref="IEnumerable{T}"/>. 
/// </summary>
public static class EnumerableExtender
{
    /// <summary>
    /// Splits an enumerable into chucks, by a maximum group size.
    /// </summary>
    /// <param name="source">The source to split</param>
    /// <param name="maxSize">The maximum number of items per group.</param>
    /// <typeparam name="T">The type of item to split</typeparam>
    /// <returns>A list of lists of the original items.</returns>
    public static IEnumerable<IEnumerable<T>> PartitionByMaxGroupSize<T>(this IEnumerable<T> source, int maxSize)
    {
        return new SplittingEnumerable<T>(source, maxSize);
    }
} 
```

这是实现类

```
 using System.Collections;
    using System.Collections.Generic;

    internal class SplittingEnumerable<T> : IEnumerable<IEnumerable<T>>
    {
        private readonly IEnumerable<T> backing;
        private readonly int maxSize;
        private bool hasCurrent;
        private T lastItem;

        public SplittingEnumerable(IEnumerable<T> backing, int maxSize)
        {
            this.backing = backing;
            this.maxSize = maxSize;
        }

        public IEnumerator<IEnumerable<T>> GetEnumerator()
        {
            return new Enumerator(this, this.backing.GetEnumerator());
        }

        IEnumerator IEnumerable.GetEnumerator()
        {
            return this.GetEnumerator();
        }

        private class Enumerator : IEnumerator<IEnumerable<T>>
        {
            private readonly SplittingEnumerable<T> parent;
            private readonly IEnumerator<T> backingEnumerator;
            private NextEnumerable current;

            public Enumerator(SplittingEnumerable<T> parent, IEnumerator<T> backingEnumerator)
            {
                this.parent = parent;
                this.backingEnumerator = backingEnumerator;
                this.parent.hasCurrent = this.backingEnumerator.MoveNext();
                if (this.parent.hasCurrent)
                {
                    this.parent.lastItem = this.backingEnumerator.Current;
                }
            }

            public bool MoveNext()
            {
                if (this.current == null)
                {
                    this.current = new NextEnumerable(this.parent, this.backingEnumerator);
                    return true;
                }
                else
                {
                    if (!this.current.IsComplete)
                    {
                        using (var enumerator = this.current.GetEnumerator())
                        {
                            while (enumerator.MoveNext())
                            {
                            }
                        }
                    }
                }

                if (!this.parent.hasCurrent)
                {
                    return false;
                }

                this.current = new NextEnumerable(this.parent, this.backingEnumerator);
                return true;
            }

            public void Reset()
            {
                throw new System.NotImplementedException();
            }

            public IEnumerable<T> Current
            {
                get { return this.current; }
            }

            object IEnumerator.Current
            {
                get { return this.Current; }
            }

            public void Dispose()
            {
            }
        }

        private class NextEnumerable : IEnumerable<T>
        {
            private readonly SplittingEnumerable<T> splitter;
            private readonly IEnumerator<T> backingEnumerator;
            private int currentSize;

            public NextEnumerable(SplittingEnumerable<T> splitter, IEnumerator<T> backingEnumerator)
            {
                this.splitter = splitter;
                this.backingEnumerator = backingEnumerator;
            }

            public bool IsComplete { get; private set; }

            public IEnumerator<T> GetEnumerator()
            {
                return new NextEnumerator(this.splitter, this, this.backingEnumerator);
            }

            IEnumerator IEnumerable.GetEnumerator()
            {
                return this.GetEnumerator();
            }

            private class NextEnumerator : IEnumerator<T>
            {
                private readonly SplittingEnumerable<T> splitter;
                private readonly NextEnumerable parent;
                private readonly IEnumerator<T> enumerator;
                private T currentItem;

                public NextEnumerator(SplittingEnumerable<T> splitter, NextEnumerable parent, IEnumerator<T> enumerator)
                {
                    this.splitter = splitter;
                    this.parent = parent;
                    this.enumerator = enumerator;
                }

                public bool MoveNext()
                {
                    this.parent.currentSize += 1;
                    this.currentItem = this.splitter.lastItem;
                    var hasCcurent = this.splitter.hasCurrent;

                    this.parent.IsComplete = this.parent.currentSize > this.splitter.maxSize;

                    if (this.parent.IsComplete)
                    {
                        return false;
                    }

                    if (hasCcurent)
                    {
                        var result = this.enumerator.MoveNext();

                        this.splitter.lastItem = this.enumerator.Current;
                        this.splitter.hasCurrent = result;
                    }

                    return hasCcurent;
                }

                public void Reset()
                {
                    throw new System.NotImplementedException();
                }

                public T Current
                {
                    get { return this.currentItem; }
                }

                object IEnumerator.Current
                {
                    get { return this.Current; }
                }

                public void Dispose()
                {
                }
            }
        }
    } 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-11-28T07:22:56.990

另一种方法是使用[Rx](http://reactivex.io/) [Buffer 运算符](http://reactivex.io/documentation/operators/buffer.html)

```
//using System.Linq;
//using System.Reactive.Linq;
//using System.Reactive.Threading.Tasks;

var observableBatches = anAnumerable.ToObservable().Buffer(size);

var batches = aList.ToObservable().Buffer(size).ToList().ToTask().GetAwaiter().GetResult(); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-11-28T09:18:16.157

只是另一个单行实现。它甚至适用于空列表，在这种情况下，您将获得零大小的批次集合。

```
var aList = Enumerable.Range(1, 100).ToList(); //a given list
var size = 9; //the wanted batch size
//number of batches are: (aList.Count() + size - 1) / size;

var batches = Enumerable.Range(0, (aList.Count() + size - 1) / size).Select(i => aList.GetRange( i * size, Math.Min(size, aList.Count() - i * size)));

Assert.True(batches.Count() == 12);
Assert.AreEqual(batches.ToList().ElementAt(0), new List<int>() { 1, 2, 3, 4, 5, 6, 7, 8, 9 });
Assert.AreEqual(batches.ToList().ElementAt(1), new List<int>() { 10, 11, 12, 13, 14, 15, 16, 17, 18 });
Assert.AreEqual(batches.ToList().ElementAt(11), new List<int>() { 100 }); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2020-10-28T06:19:20.603

一个易于使用和理解的版本。

```
 public static List<List<T>> chunkList<T>(List<T> listToChunk, int batchSize)
    {
        List<List<T>> batches = new List<List<T>>();

        if (listToChunk.Count == 0) return batches;

        bool moreRecords = true;
        int fromRecord = 0;
        int countRange = 0;
        if (listToChunk.Count >= batchSize)
        {
            countRange = batchSize;
        }
        else
        {
            countRange = listToChunk.Count;
        }

        while (moreRecords)
        {
            List<T> batch = listToChunk.GetRange(fromRecord, countRange);
            batches.Add(batch);

            if ((fromRecord + batchSize) >= listToChunk.Count)
            {
                moreRecords = false;
            }

            fromRecord = fromRecord + batch.Count;

            if ((fromRecord + batchSize) > listToChunk.Count)
            {
                countRange = listToChunk.Count - fromRecord;
            }
            else
            {
                countRange = batchSize;
            }
        }
        return batches;
    } 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-08-24T04:48:16.790

作为 .NET 6 中 LINQ 的新辅助方法，您可以将任何 IEnumerable 分块：

```
int chunkNumber = 1;
foreach (int[] chunk in Enumerable.Range(0, 9).Chunk(3))
{
    Console.WriteLine($"Chunk {chunkNumber++}");
    foreach (var item in chunk)
    {
        Console.WriteLine(item);
    }
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-10-20T18:26:03.427

`IAsyncEnumerable`这是一个在 C# 中通过- [https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/tutorials/generate-consume-asynchronous-stream](https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/tutorials/generate-consume-asynchronous-stream)使用异步迭代的实现

```
public static class EnumerableExtensions
{
    /// <summary>
    /// Chunks a sequence into a sub-sequences each containing maxItemsPerChunk, except for the last
    /// which will contain any items left over.
    ///
    /// NOTE: this implements a streaming implementation via <seealso cref="IAsyncEnumerable{T}"/>.
    /// </summary>
    public static async IAsyncEnumerable<IEnumerable<T>> ChunkAsync<T>(this IAsyncEnumerable<T> sequence, int maxItemsPerChunk)
    {
        if (sequence == null) throw new ArgumentNullException(nameof(sequence));
        if (maxItemsPerChunk <= 0)
        {
            throw new ArgumentOutOfRangeException(nameof(maxItemsPerChunk), $"{nameof(maxItemsPerChunk)} must be greater than 0");
        }

        var chunk = new List<T>(maxItemsPerChunk);
        await foreach (var item in sequence)
        {
            chunk.Add(item);

            if (chunk.Count == maxItemsPerChunk)
            {
                yield return chunk.ToArray();
                chunk.Clear();
            }
        }

        // return the "crumbs" that 
        // didn't make it into a full chunk
        if (chunk.Count > 0)
        {
            yield return chunk.ToArray();
        }
    }

    /// <summary>
    /// Chunks a sequence into a sub-sequences each containing maxItemsPerChunk, except for the last
    /// which will contain any items left over.
    /// </summary>
    public static IEnumerable<IEnumerable<T>> Chunk<T>(this IEnumerable<T> sequence, int maxItemsPerChunk)
    {
        if (sequence == null) throw new ArgumentNullException(nameof(sequence));
        if (maxItemsPerChunk <= 0)
        {
            throw new ArgumentOutOfRangeException(nameof(maxItemsPerChunk), $"{nameof(maxItemsPerChunk)} must be greater than 0");
        }

        var chunk = new List<T>(maxItemsPerChunk);
        foreach (var item in sequence)
        {
            chunk.Add(item);

            if (chunk.Count == maxItemsPerChunk)
            {
                yield return chunk.ToArray();
                chunk.Clear();
            }
        }

        // return the "crumbs" that 
        // didn't make it into a full chunk
        if (chunk.Count > 0)
        {
            yield return chunk.ToArray();
        }
    }
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-10-03T04:03:48.093

我知道每个人都使用复杂的系统来完成这项工作，我真的不明白为什么。`Func<TSource,Int32,TResult>`Take 和 skip 将允许使用带有转换功能的公共选择的所有这些操作。像：

```
public IEnumerable<IEnumerable<T>> Buffer<T>(IEnumerable<T> source, int size)=>
    source.Select((item, index) => source.Skip(size * index).Take(size)).TakeWhile(bucket => bucket.Any()); 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-10-05T22:30:32.080

另一种执行批处理的方法：

```
public static class Extensions
{
    public static IEnumerable<TOut> Batch<T, TOut>(this IEnumerable<T> source, Func<T, T, TOut> func)
    {
        using (var enumerator = source.GetEnumerator())
        {
            while (true)
            {
                bool state;

                state = enumerator.MoveNext(); if (!state) break; var v0 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v1 = enumerator.Current;

                yield return func(v0, v1);
            }
        }
    }

    public static IEnumerable<TOut> Batch<T, TOut>(this IEnumerable<T> source, Func<T, T, T, TOut> func)
    {
        using (var enumerator = source.GetEnumerator())
        {
            while (true)
            {
                bool state;

                state = enumerator.MoveNext(); if (!state) break; var v0 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v1 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v2 = enumerator.Current;

                yield return func(v0, v1, v2);
            }
        }
    }

    public static IEnumerable<TOut> Batch<T, TOut>(this IEnumerable<T> source, Func<T, T, T, T, TOut> func)
    {
        using (var enumerator = source.GetEnumerator())
        {
            while (true)
            {
                bool state;

                state = enumerator.MoveNext(); if (!state) break; var v0 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v1 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v2 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v3 = enumerator.Current;

                yield return func(v0, v1, v2, v3);
            }
        }
    }

    public static IEnumerable<TOut> Batch<T, TOut>(this IEnumerable<T> source, Func<T, T, T, T, T, TOut> func)
    {
        using (var enumerator = source.GetEnumerator())
        {
            while (true)
            {
                bool state;

                state = enumerator.MoveNext(); if (!state) break; var v0 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v1 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v2 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v3 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v4 = enumerator.Current;

                yield return func(v0, v1, v2, v3, v4);
            }
        }
    }

    public static IEnumerable<TOut> Batch<T, TOut>(this IEnumerable<T> source, Func<T, T, T, T, T, T, TOut> func)
    {
        using (var enumerator = source.GetEnumerator())
        {
            while (true)
            {
                bool state;

                state = enumerator.MoveNext(); if (!state) break; var v0 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v1 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v2 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v3 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v4 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v5 = enumerator.Current;

                yield return func(v0, v1, v2, v3, v4, v5);
            }
        }
    }

    public static IEnumerable<TOut> Batch<T, TOut>(this IEnumerable<T> source, Func<T, T, T, T, T, T, T, TOut> func)
    {
        using (var enumerator = source.GetEnumerator())
        {
            while (true)
            {
                bool state;

                state = enumerator.MoveNext(); if (!state) break; var v0 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v1 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v2 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v3 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v4 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v5 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v6 = enumerator.Current;

                yield return func(v0, v1, v2, v3, v4, v5, v6);
            }
        }
    }

    public static IEnumerable<TOut> Batch<T, TOut>(this IEnumerable<T> source, Func<T, T, T, T, T, T, T, T, TOut> func)
    {
        using (var enumerator = source.GetEnumerator())
        {
            while (true)
            {
                bool state;

                state = enumerator.MoveNext(); if (!state) break; var v0 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v1 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v2 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v3 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v4 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v5 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v6 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v7 = enumerator.Current;

                yield return func(v0, v1, v2, v3, v4, v5, v6, v7);
            }
        }
    }

    public static IEnumerable<TOut> Batch<T, TOut>(this IEnumerable<T> source, Func<T, T, T, T, T, T, T, T, T, TOut> func)
    {
        using (var enumerator = source.GetEnumerator())
        {
            while (true)
            {
                bool state;

                state = enumerator.MoveNext(); if (!state) break; var v0 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v1 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v2 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v3 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v4 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v5 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v6 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v7 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v8 = enumerator.Current;

                yield return func(v0, v1, v2, v3, v4, v5, v6, v7, v8);
            }
        }
    }

    public static IEnumerable<TOut> Batch<T, TOut>(this IEnumerable<T> source, Func<T, T, T, T, T, T, T, T, T, T, TOut> func)
    {
        using (var enumerator = source.GetEnumerator())
        {
            while (true)
            {
                bool state;

                state = enumerator.MoveNext(); if (!state) break; var v0 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v1 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v2 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v3 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v4 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v5 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v6 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v7 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v8 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v9 = enumerator.Current;

                yield return func(v0, v1, v2, v3, v4, v5, v6, v7, v8, v9);
            }
        }
    }

    public static IEnumerable<TOut> Batch<T, TOut>(this IEnumerable<T> source, Func<T, T, T, T, T, T, T, T, T, T, T, TOut> func)
    {
        using (var enumerator = source.GetEnumerator())
        {
            while (true)
            {
                bool state;

                state = enumerator.MoveNext(); if (!state) break; var v0 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v1 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v2 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v3 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v4 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v5 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v6 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v7 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v8 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v9 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v10 = enumerator.Current;

                yield return func(v0, v1, v2, v3, v4, v5, v6, v7, v8, v9, v10);
            }
        }
    }

    public static IEnumerable<TOut> Batch<T, TOut>(this IEnumerable<T> source, Func<T, T, T, T, T, T, T, T, T, T, T, T, TOut> func)
    {
        using (var enumerator = source.GetEnumerator())
        {
            while (true)
            {
                bool state;

                state = enumerator.MoveNext(); if (!state) break; var v0 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v1 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v2 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v3 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v4 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v5 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v6 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v7 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v8 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v9 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v10 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v11 = enumerator.Current;

                yield return func(v0, v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11);
            }
        }
    }

    public static IEnumerable<TOut> Batch<T, TOut>(this IEnumerable<T> source, Func<T, T, T, T, T, T, T, T, T, T, T, T, T, TOut> func)
    {
        using (var enumerator = source.GetEnumerator())
        {
            while (true)
            {
                bool state;

                state = enumerator.MoveNext(); if (!state) break; var v0 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v1 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v2 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v3 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v4 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v5 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v6 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v7 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v8 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v9 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v10 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v11 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v12 = enumerator.Current;

                yield return func(v0, v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12);
            }
        }
    }

    public static IEnumerable<TOut> Batch<T, TOut>(this IEnumerable<T> source, Func<T, T, T, T, T, T, T, T, T, T, T, T, T, T, TOut> func)
    {
        using (var enumerator = source.GetEnumerator())
        {
            while (true)
            {
                bool state;

                state = enumerator.MoveNext(); if (!state) break; var v0 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v1 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v2 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v3 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v4 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v5 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v6 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v7 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v8 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v9 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v10 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v11 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v12 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v13 = enumerator.Current;

                yield return func(v0, v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13);
            }
        }
    }

    public static IEnumerable<TOut> Batch<T, TOut>(this IEnumerable<T> source, Func<T, T, T, T, T, T, T, T, T, T, T, T, T, T, T, TOut> func)
    {
        using (var enumerator = source.GetEnumerator())
        {
            while (true)
            {
                bool state;

                state = enumerator.MoveNext(); if (!state) break; var v0 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v1 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v2 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v3 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v4 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v5 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v6 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v7 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v8 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v9 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v10 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v11 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v12 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v13 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v14 = enumerator.Current;

                yield return func(v0, v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14);
            }
        }
    }

    public static IEnumerable<TOut> Batch<T, TOut>(this IEnumerable<T> source, Func<T, T, T, T, T, T, T, T, T, T, T, T, T, T, T, T, TOut> func)
    {
        using (var enumerator = source.GetEnumerator())
        {
            while (true)
            {
                bool state;

                state = enumerator.MoveNext(); if (!state) break; var v0 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v1 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v2 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v3 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v4 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v5 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v6 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v7 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v8 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v9 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v10 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v11 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v12 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v13 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v14 = enumerator.Current;
                state = enumerator.MoveNext(); if (!state) break; var v15 = enumerator.Current;

                yield return func(v0, v1, v2, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14, v15);
            }
        }
    }
} 
```

这是一个示例用法：

```
using System;
using System.Linq;

namespace TestProgram
{
    class Program
    {
        static void Main(string[] args)
        {
            foreach (var item in Enumerable.Range(0, 12).ToArray().Batch((R, X1, Y1, X2, Y2) => (R, X1, Y1, X2, Y2)))
            {
                Console.WriteLine($"{item.R}, {item.X1}, {item.Y1}, {item.X2}, {item.Y2}");
            }
        }
    }
} 
```

* * *

## 回答 #21

> 赞同：-3
> 
> 时间：2015-07-02T16:33:10.067

```
 static IEnumerable<IEnumerable<T>> TakeBatch<T>(IEnumerable<T> ts,int batchSize)
    {
        return from @group in ts.Select((x, i) => new { x, i }).ToLookup(xi => xi.i / batchSize)
               select @group.Select(xi => xi.x);
    } 
```

# c# - 结构与类中使用的泛型

> ID：13731798
> 
> 赞同：15
> 
> 时间：2012-12-05T20:27:45.710
> 
> 标签：c#, class, generics, struct

假设我们有以下`struct`使用泛型的定义：

```
public struct Foo<T>
{
    public T First; 
    public T Second;

    public Foo(T first)
    {
        this.First = first;
    }

} 
```

编译器说

> 在将控制权返回给调用者之前，必须完全分配“Foo.Second”

但是，如果`Foo`是一个类，那么它编译成功。

```
public class Foo<T>
{
    public T First; 
    public T Second;

    public Foo(T first)
    {
        this.First = first;
    }

} 
```

为什么？为什么编译器会以不同的方式对待它们？此外，如果第一个没有定义构造函数，`Foo`那么它会编译。为什么会有这种行为？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-05T20:30:08.523

这是因为编译器规则强制必须在控制离开任何构造函数之前分配结构中的所有字段。

您可以通过执行以下操作使您的代码正常工作：

```
public Foo(T first)
{
    this.First = first;
    this.Second = default(T);
} 
```

另请参阅[为什么必须使用非默认构造函数初始化 C# 结构中的所有字段？](https://stackoverflow.com/questions/721246/why-must-i-initialize-all-fields-in-my-c-sharp-struct-with-a-non-default-constru)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-12-05T20:29:16.527

这是一般结构的要求——它与泛型无关。您的构造函数必须为所有字段赋值。

请注意，这里也会发生同样的错误：

```
struct Foo
{
    public int A;
    public int B;

    public Foo()
    {
        A = 1;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-05T20:30:11.627

因为 C# 中的一条规则是，必须为结构（内联或构造函数）分配所有字段。这是因为结构性质。它与通用或非通用无关。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T20:34:19.120

其他答案正确解释了行为，但忽略了提及问题的第二部分，所以这里是为了完成。

对于类，当您没有显式定义构造函数时，编译器将生成一个默认构造函数，该构造函数为每个字段分配默认值（例如`null`对象、`0`数字等）。

对于结构，结构*总是*有一个隐式的无参数构造函数来分配默认值。

# php - 将 PHP 变量发送到 javascript 函数

> ID：13731800
> 
> 赞同：14
> 
> 时间：2012-12-05T20:27:52.310
> 
> 标签：php, javascript, post, get

我有一个生成变量的 php 文件，我希望将变量放入一个 javascript 函数中，该函数由主页上的 onclick 调用。这可以从 PHP 发送到 javascript 吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-05T20:31:01.790

您可以执行以下操作：

```
<script type='text/javascript'>
    document.body.onclick(function(){
        var myVariable = <?php echo(json_encode($myVariable)); ?>;
    };
</script> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-05T20:31:38.150

写吧：

```
<script>
    var my_variable_name = <?php echo(json_encode($php_string)); ?>;
</script> 
```

现在它可以作为 JavaScript 变量`my_variable_name`在上述代码下方的任何位置使用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-05T20:30:42.073

您的 JavaScript 必须在 PHP 解析的文件中定义。

例如，在 index.php 中，您可以放置

```
<?php
$time = time();
?>
<script>
    document.write(<?php echo $time; ?>);
</script> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-05T20:30:09.900

如果我对您的理解正确，您应该能够按照以下方式做一些事情：

```
function clicked() {
    var someVariable="<?php echo $phpVariable; ?>";
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-05T20:41:26.377

一个很好的选择是使用 jQuery/AJAX。 [查看这些示例](https://stackoverflow.com/questions/13499559/make-div-text-change-on-click-based-on-php-data-using-ajax/13501242#13501242)并在您的服务器上试用它们。在此示例中，在 FILE1.php 中，请注意它传递了一个空白值。如果你愿意，你可以传递一个值，它可能看起来像这样（假设 javascript vars 称为`username`and `password`：

```
data: 'username='+username+'&password='+password, 
```

在 FILE2.php 示例中，您将检索这些值，如下所示：

```
$uname = $_POST['username'];
$pword = $_POST['password']; 
```

然后进行 MySQL 查找并返回值：

```
echo 'You are logged in'; 
```

这会将消息传递`You are logged in`给 FILE1.php 中的成功函数，并且消息字符串将存储在名为“data”的变量中。因此，`alert(data);`成功函数中的行会提醒该消息。当然，您可以选择`echo`任何您喜欢的内容，甚至是大量的 HTML，例如整个表格结构。

[这是另一个值得](https://stackoverflow.com/questions/13502638/submit-form-and-pass-values-with-ajax/13502872#13502872)回顾的好例子。

方法是创建表单，然后使用 jQuery 检测按钮按下并通过 AJAX 将数据提交到辅助 PHP 文件。上面的例子展示了如何做到这一点。

辅助 PHP 文件接收变量（如果已发送）并返回响应（无论您选择发送什么）。然后，该响应将作为“数据”出现在您的 AJAX 调用的 Success: 部分中（在这些示例中）。

jQuery/AJAX 代码是 javascript，因此您有两种选择：您可以将其放在`<script type="text/javascript"></script>`PHP 主文档的标签中，或者您可以`<?php include "my_javascript_stuff.js"; ?>`放在 PHP 文档的底部。如果您使用的是 jQuery，请不要忘记在给出的示例中包含 jQuery 库。

在您的情况下，听起来您几乎可以反映我建议的第一个示例，不发送数据并在 AJAX 成功函数中接收响应。但是，无论您需要对这些数据做什么，都必须在 success 函数中执行。起初看起来有点奇怪，但它确实有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-05T20:31:40.240

您可以将 PHP 值传递给 JavaScript。PHP 将在服务器端执行，因此将计算该值，然后您可以将其回显到包含 javascript 的 HTML。然后，javascript 将在客户端浏览器中执行，并使用 PHP 在服务器端计算的值。

```
<script type="text/javascript">
    // Do something in JavaScript
    var x = <?php echo $calculatedValue; ?>;
    // etc..
</script> 
```

# asp.net-mvc - 为什么没有使用 EF CodeFirst 在 ASP.NET MVC4 中创建我的数据库

> ID：13731804
> 
> 赞同：0
> 
> 时间：2012-12-05T20:28:01.313
> 
> 标签：asp.net-mvc, entity-framework

我一直在关注 Julie Lerman 关于使用 EF CodeFirst 从代码生成数据库的教程。我正在使用 MVC4 并使用默认控制器。我要做的就是生成数据库。然而，在她的教程中，她使用控制台应用程序并在她的 Main 函数中调用 create_blog 方法。顾名思义，create_blog 函数完成创建数据库的工作。

在我的 Global.asax 中，我有这个：

```
Database.SetInitializer(new CIT.Models.SampleData()); 
```

这是我的 SampleData 类：

```
 public class SampleData : CreateDatabaseIfNotExists<Context>
    {
        protected override void Seed(Context context)
        {
            base.Seed(context);

            new List<Software> {
                    new Software { Title = "Adobe Creative Suite", Version = "CS6", SerialNumber = "1234634543", Platform = "Mac", Notes = "Macs rock!", PurchaseDate = "2012-12-04", Suite = true, SubscriptionEndDate = null, SeatCount = 4, SoftwareTypes = new List<SoftwareType> { new SoftwareType { Type="Suite" }}, Locations = new List<Location> { new Location { LocationName = "Paradise" }}, Publishers = new List<SoftwarePublisher> { new SoftwarePublisher { Publisher = "Adobe" }}},
                    new Software { Title = "Apple iLife", Version = "2012", SerialNumber = "123463423453", Platform = "Mac", Notes = "Macs still rock!", PurchaseDate = "2012-11-04", Suite = true, SubscriptionEndDate = null, SeatCount = 4, SoftwareTypes = new List<SoftwareType> { new SoftwareType { Type="Suite" }}, Locations = new List<Location> { new Location { LocationName = "81st Street" }}, Publishers = new List<SoftwarePublisher> { new SoftwarePublisher { Publisher = "Apple" }}},
                    new Software { Title = "Microsoft Office", Version = "2012", SerialNumber = "12346231434543", Platform = "PC", Notes = "Macs really rock!", PurchaseDate = "2011-12-04", Suite = true, SubscriptionEndDate = null, SeatCount = 4, SoftwareTypes = new List<SoftwareType> { new SoftwareType { Type="Suite" }}, Locations = new List<Location> { new Location { LocationName = "Paradise" }}, Publishers = new List<SoftwarePublisher> { new SoftwarePublisher { Publisher = "Microsoft" }}}
                }.ForEach(s => context.Software.Add(s));

        }
    } 
```

编译时没有错误。我只是没有数据库。我查看了我的 App_Data，那里的所有内容都是默认数据库。我有一个被调用的 dbContext，因为当我在其中出现错误时，它们指向了该文件。我是否需要在网站首次编译时调用某种创建方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:33:52.210

SetInitializer 只设置初始化策略，策略在你第一次访问数据库时执行。调用 SetInitializer 后尝试添加以下内容

```
using (var context = new Context()) { context.Database.Initialize(true); } 
```

# python - 一个窗口中的多个 QButtonGroups

> ID：13731809
> 
> 赞同：2
> 
> 时间：2012-12-05T20:28:17.333
> 
> 标签：python, radio-button, pyqt, radio-group, buttongroup

我正在用 PyQt 编写一个向导。在第一页上，我想让用户在两个选项之间选择两次。因此，我决定制作 Buttongroups。但是虽然我将前两个单选按钮添加到第一个 Buttongroup 并将另外两个添加到第二个按钮组，但这些按钮仍然是独占的（我只能在页面上选择一个按钮）。

这是我的代码：

```
 # Setup UI
    layout = QtGui.QVBoxLayout()

    gBBackupFromIntExt = QtGui.QGroupBox()
    layout.addWidget(gBBackupFromIntExt)

    bGBackupFromIntExt = QtGui.QButtonGroup()

    self.rBBackupFromExt = QtGui.QRadioButton()
    bGBackupFromIntExt.addButton (self.rBBackupFromExt)
    layout.addWidget(self.rBBackupFromExt)

    self.rBBackupFromInt = QtGui.QRadioButton()
    bGBackupFromIntExt.addButton (self.rBBackupFromInt)
    layout.addWidget(self.rBBackupFromInt)

    gBBackupToIntExt = QtGui.QGroupBox()
    layout.addWidget(gBBackupToIntExt)

    bGBackupToIntExt = QtGui.QButtonGroup()

    self.rBBackupToExt = QtGui.QRadioButton()
    bGBackupToIntExt.addButton (self.rBBackupToExt)
    layout.addWidget(self.rBBackupToExt)

    self.rBBackupToInt = QtGui.QRadioButton()
    bGBackupToIntExt.addButton (self.rBBackupToInt)
    layout.addWidget(self.rBBackupToInt) 
```

你知道我的错误在哪里，我必须改变什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T21:09:30.013

问题是 QButtonGroups 从未成为层次结构的一部分，因此它们没有效果。

顺便说一句：发布代码时尝试添加必要的部分以使其可运行：

```
from PyQt4 import QtGui
import sys

class Test(QtGui.QWidget):
    def __init__(self):
        super().__init__()
        layout = QtGui.QVBoxLayout(self)

        gBBackupFromIntExt = QtGui.QGroupBox()
        layout.addWidget(gBBackupFromIntExt)

        bGBackupFromIntExt = QtGui.QButtonGroup(self)

        self.rBBackupFromExt = QtGui.QRadioButton()
        bGBackupFromIntExt.addButton(self.rBBackupFromExt)
        layout.addWidget(self.rBBackupFromExt)

        self.rBBackupFromInt = QtGui.QRadioButton()
        bGBackupFromIntExt.addButton(self.rBBackupFromInt)
        layout.addWidget(self.rBBackupFromInt)

        gBBackupToIntExt = QtGui.QGroupBox()
        layout.addWidget(gBBackupToIntExt)

        bGBackupToIntExt = QtGui.QButtonGroup(self)

        self.rBBackupToExt = QtGui.QRadioButton()
        bGBackupToIntExt.addButton (self.rBBackupToExt)
        layout.addWidget(self.rBBackupToExt)

        self.rBBackupToInt = QtGui.QRadioButton()
        bGBackupToIntExt.addButton (self.rBBackupToInt)
        layout.addWidget(self.rBBackupToInt)

a = QtGui.QApplication(sys.argv)
t = Test()
t.show()
a.exec() 
```

这应该可以解决问题。

# java - jar 中的 jRuby gem 生成目录而不是 jar

> ID：13731813
> 
> 赞同：1
> 
> 时间：2012-12-05T20:28:47.287
> 
> 标签：java, rubygems, jruby

我正在使用 jruby 并且一直将我的宝石放在这样的罐子里

`java -jar jruby_complete.jar -S gem install -i gem_jar.jar nokogiri erubis`

这会创建一个 jar“文件”并正确安装 gem。我可以将此 jar“文件”添加到我的搜索路径中，我的项目将运行，但是当我在 netbeans 中进行分发构建时，它抱怨 gem_jar 是一个目录。

.jar 只是一个压缩目录，或者我是这么想的，所以我跑了

```
zip gem_jar.zip gem_jar; mv gem_jar.jar gem_jar.old; mv gem_jar.zip gem_jar.jar 
```

Netbeans 不再抱怨，但项目不会运行。我如何无法将我的 gem jar 强制转换为实际的压缩 jar 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:42:10.727

问题是`-i`jruby 上的标志没有创建一个 jar。那是我的错误假设。正确的方法是这样

```
java -jar jruby_complete.jar -S gem install -i gem_jar nokogiri erubis
jar cf gem_jar.jar -C gem_jar . 
```

# c# - 将默认参数约束为编译时常量的基本原理

> ID：13731814
> 
> 赞同：1
> 
> 时间：2012-12-05T20:28:54.217
> 
> 标签：c#, default-parameters

我想知道为什么这不会编译：

```
public static void SomeFunction(Guid someGuid = Guid.NewGuid())
{
        // Do stuff
} 
```

与消息

> “'someGuid' 的默认参数值必须是编译时常量”

而重载的版本将编译：

```
 public static void SomeFunction()
    {
        SomeFunction(Guid.NewGuid());
    }

    public static void SomeFunction(Guid someGuid)
    {
        // Do stuff
    } 
```

换句话说，为什么编译器不把第一种情况翻译成第二种呢？这种设计选择背后的原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:30:38.853

默认参数值被编译为只能保存文字值的 CIL 元数据（如属性）。

C# 编译器在那里做了一些魔术来允许小数。

# python - 无论实际 y 位置如何，Mouse.event 都会发生在任何 y 位置

> ID：13731816
> 
> 赞同：0
> 
> 时间：2012-12-05T20:29:03.043
> 
> 标签：python, mouseevent, pygame

pygame 应用程序有两排按钮。可以通过单击按钮来打开或关闭这些按钮。

问题在于，无论鼠标垂直位于何处，它都会同时单击该列的所有按钮，而不仅仅是一个；（就像一次单击整个 y 轴一样）。我在每次单击时打印了鼠标事件的 x 和 y 坐标，但坐标正常地在一个按钮的位置内。那么，为什么要打开或关闭多个按钮而不是一个按钮呢？我什至在任何按钮的垂直范围下方单击，只要 x 坐标仍在范围内，它们仍然被激活。无论如何，这是代码的一部分（对糟糕的编号系统感到抱歉）：

```
 if event.type == pygame.MOUSEBUTTONUP:
        if event.pos < (130,130) and event.pos > (100,100):
            if seq01[0] == 0:
                seq01[0] = 1
                block_00 = block_on
            else:
                seq01[0] = 0
                block_00 = block_off
            print event.pos

        if event.pos < (170,130) and event.pos > (140,100):
            if seq01[1] == 0:
                seq01[1] = 1
                block_01 = block_on
            else:
                seq01[1] = 0
                block_01 = block_off

        #### this is the start of the second row ####
        if event.pos < (130,200) and event.pos > (100,170):
            if seq02[0] == 0:
                seq02[0] = 1
                block_2_00 = block_on
            else:
                seq02[0] = 0
                block_2_00 = block_off 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:39:01.960

问题是您正在将鼠标位置（一对整数）与按钮角（另一对整数）进行比较。Python 按元素比较序列，因此您的测试实际上只检查第一个轴 (X)。

我强烈建议为每个按钮创建一个 pygame.Rect，然后您可以更简单地测试按钮是否在该区域内。

然后你的代码看起来更像这样，

```
if event.type == pygame.MOUSEBUTTONUP:
    if rect_00.collidepoint(event.pos):
        if seq01[0] == 0:
            seq01[0] = 1
            block_00 = block_on
        else:
            seq01[0] = 0
            block_00 = block_off
        print event.pos

    if rect_01.collidepoint(event.pos):
        if seq01[1] == 0:
            seq01[1] = 1
            block_01 = block_on
        else:
            seq01[1] = 0
            block_01 = block_off

    #### this is the start of the second row ####
    if rect_2_00.collidepoint(event.pos):
        if seq02[0] == 0:
            seq02[0] = 1
            block_2_00 = block_on
        else:
            seq02[0] = 0
            block_2_00 = block_off 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:40:33.893

你的比较是有缺陷的。考虑以下成绩单：

```
In [278]: pos=(120, 0)
In [279]: pos > (100,100)
Out[279]: True
In [280]: pos < (130,130)
Out[280]: True
In [281]: pos < (130,200)
Out[281]: True
In [282]: (100,170)
Out[282]: (100, 170)
In [283]: (129,300) < (130,130)
Out[283]: True
In [284]: (130,300) < (130,130)
Out[284]: False 
```

显然，您预计这些比较都不是真的。然而，在比较元组时，决定结果的是元素中最左边的差异。在您的代码中，满足的额外比较会导致激活额外的按钮。

# c# - 为已经执行的任务创建延续的可靠方法是什么？

> ID：13731829
> 
> 赞同：2
> 
> 时间：2012-12-05T20:29:53.173
> 
> 标签：c#, task-parallel-library

让我们有正在运行的任务`mainTask`。然后发生了一些事情，我想安排继续。

```
mainTask.ContinueWith(continuationTask); 
```

但是如果此时 mainTask 完成，这将不起作用。<- 错误声明
好的，我们可以进行一些检查：

```
if (mainTask.IsCompleted)
{
    continuationTask.Start();
}
else 
{
    mainTask.ContinueWith(continuationTask);
} 
```

这也不安全，因为我们可以在创建延续之前检查并完成任务时未完成任务。
**因此，问题是如何动态地继续任务？**

我现在看到的唯一解决方案是创建第三个任务：

```
var waitingTask = new Task ( () => mainTask.Wait());
waitingTask.ContinueWith(continuationTask);
waitingTask.Start(); 
```

但我想知道是否存在更优雅的方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T20:58:41.070

> 但是如果此时 mainTask 完成，这将不起作用。

这不是真的。

You need to create a self-contained repro to find help. By doing that you'll find out that your assumption is false and that there is a bug somewhere.

# c++ - 分解来自文件 C++ 的输入

> ID：13731833
> 
> 赞同：1
> 
> 时间：2012-12-05T20:30:02.550
> 
> 标签：c++, fstream

我有一个文件，其中包含每一行的员工信息（id、部门、薪水和姓名）。这是一个示例行：

```
45678 25 86400 Doe, John A. 
```

现在我正在使用 fstream 阅读每个单词，直到我到达名称部分。我的问题是，从整体上获取该名称的最简单方法是什么？

```
Data >> Word;
while(Data.good())
{
    //blah blah storing them into a node
    Data >> Word;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:55:56.223

```
#include <fstream>
#include <iostream>
int main() {
  std::ifstream in("input");
  std::string s;
  struct Record { int id, dept, sal; std::string name; };
  Record r;
  in >> r.id >> r.dept >> r.sal;
  in.ignore(256, ' ');
  getline(in, r.name);
  std::cout << r.name << std::endl;
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T21:22:14.233

您可能想要定义一个`struct`来保存员工的数据，定义一个重载`operator>>`来从您的文件中读取其中一个记录：

```
struct employee { 
    int id;
    int department;
    double salary;
    std::string name;

    friend std::istream &operator>>(std::istream &is, employee &e) { 
       is >> e.id >> e.department >> e.salary;
       return std::getline(is, e.name);
    }
};

int main() { 
    std::ifstream infile("employees.txt");

    std::vector<employee> employees((std::istream_iterator<employee>(infile)),
                                     std::istream_iterator<employee>());

    // Now all the data is in the employees vector.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T21:24:34.613

我会创建一条记录并定义输入运算符

```
class Employee
{
    int id;
    int department;
    int salary;
    std::string name;

    friend std::istream& operator>>(std::istream& str, Employee& dst)
    {
        str >> dst.id >> dst.department >> dst.salary;
        std::getline(str, dst.name); // Read to the end of line
        return str;
    }
};

int main()
{
    Employee  e;
    while(std::cin >> e)
    {
         // Word with employee
    }
} 
```

# c++ - 用 C++ 编写高效的实体系统

> ID：13731839
> 
> 赞同：5
> 
> 时间：2012-12-05T20:30:24.813
> 
> 标签：c++, performance, architecture, data-driven

我正在尝试用 C++ 制作一个高效的“实体系统”，我在互联网上阅读了很多博客/文章/文档以获取大量信息，但我又遇到了一些问题。

我发现了两个有趣的主题：

*   数据驱动系统
*   实体组件系统

对我来说，这两个系统看起来非常相似。

所以，我找到了亚当·史密斯的这个例子：[https ://stackoverflow.com/a/2021868](https://stackoverflow.com/a/2021868)

我需要有一个像这样的灵活系统：

```
// Abstract class
class Component
{
     // data here
}

// exemple
class Car : public Component
{
    // Data here
}

// Entity with components
class Entity
{
   std::vector<Component*> components;
} 
```

那么，如果我的实体有以下组件：Car、Transform、Sprite， **我的组件数组是否会有像数据驱动系统这样的线性数据？**

现在，我有系统：

```
class System 
{
     virtual void init();
     virtual void clear();
     virtual void update();

     std::unordered_map< const char*, Entity*> entities;
}

class RendererSystem : public System
{
    // Methods's definition (init, clear, …).

    void update()
    {
       for( entity, … )
       {
           Sprite* s = entity->getComponent('sprite');
           ...
       }
    }
} 
```

*   我读过虚拟功能很糟糕，在那种情况下很糟糕？
*   获取组件需要一个 static_cast，这很糟糕吗？
*   在数据驱动系统中，我到处都看到指针，si 哪里是“原始”变量，我需要在任何地方放置新变量，否则我将拥有一个包含相同数据数组的类？
*   我做对了吗？

在我看来，所有这些观点都显得“模糊”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:36:36.383

1.  虚函数确实有一些开销，但除非你每秒进行数百万次调用，否则你应该不关心任何事情，所以忽略这个事实。
2.  静态转换本身并不坏，但它会破坏静态类型检查，因此如果您可以在您转换的对象内移动行为，那么您只需调用适当的方法而无需知道特定的运行时实例反对那就更好了
3.  不清楚你在问什么，即使你在数据驱动的方法中有元素向量，集合中的每个元素都需要分配一个`new`（如果它是一个指针）。然后，一旦你分配了它，你就不需要再做一次，只要你将引用传递给周围的项目

# gps - GPS历书信息如何使用？

> ID：13731840
> 
> 赞同：1
> 
> 时间：2012-12-05T20:30:32.423
> 
> 标签：gps

我需要使用该站点的数据： [http](http://www.navcen.uscg.gov/?Do=gpsArchives&path=2012) : //www.navcen.uscg.gov/?Do=gpsArchives&path=2012 来开发一个绘制有关卫星可用性图表的小软件，如下所示：[http://i。 stack.imgur.com/X0iGL.jpg](http://i.stack.imgur.com/X0iGL.jpg)

用户必须设置一天、纬度/经度位置和时区，然后我的应用程序必须绘制 7 天（从用户日开始）的卫星可用性以选择最佳日期。

我不是 GPS 专家，所以我不知道哪些以及如何使用年历中的数据来制作情节。

任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:42:52.073

历书包含描述一颗卫星环绕地球的曲线的椭圆参数。使用这些参数，您可以确定卫星在特定时间和位置的位置。

假设天空的能见度为 170°：5° 被地平线上的房屋或山脉隐藏。

参考：

[http://www.navcen.uscg.gov/?pageName=gpsAlmanacs](http://www.navcen.uscg.gov/?pageName=gpsAlmanacs)

和

[http://www.navcen.uscg.gov/pdf/gps/Programmatically%20Accessing.pdf](http://www.navcen.uscg.gov/pdf/gps/Programmatically%20Accessing.pdf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T14:49:29.470

如果你擅长 Matlab，你可以[尝试使用这个](http://www.mathworks.in/matlabcentral/fileexchange/36355-gps-satellites-visibility-prediction-by-exerting-google-earth-terrain)

> 该程序通过施加地形来计算GPS可见卫星以进行高精度预测。
> 
> 输入：
> 
> 1.  地球站坐标。
> 2.  GPS年历文件。
> 3.  “txt”格式的地形数据（仅用于 DSM 计算）。

* * *

或者您可以通过[gpstk 代码](http://sourceforge.net/projects/gpstk/files/)并参考如何实现[ComputeStationSatelliteVisibility](http://www.gpstk.org/bin/view/Documentation/ComputeStationSatelliteVisibilityManua) l

# asp.net-mvc - 使用控制器和列表中的 viewModel 填充视图中的下拉列表

> ID：13731841
> 
> 赞同：0
> 
> 时间：2012-12-05T20:30:34.927
> 
> 标签：asp.net-mvc, drop-down-menu, model

这个看似简单的任务，似乎从来没有人做过。

我有一个**控制器**，它有一个操作来检索包含我的语言信息的表文化：

```
 [HandleError]
    [ChildActionOnly]
    public ActionResult LanguageDropdownlist()
    {
        var languageDropdownlist = _unitOfWork.CulturesRepository.Get();
        return PartialView("_LanguageSelectionPartial", languageDropdownlist.ToList());
    } 
```

languageDropdownlist 的结构如下：

```
List languageDropdownlistItems 
[0]
    - display_name
    - id
    - name
    - ...
[1]
    - display_name
    - id
    - name
    - ...
[2]
    - display_name
    - id
    - name
    - ...
[3]
    - display_name
    - id
    - name
    - ... 
```

我将一个列表传递给**视图**。

在**视图**中执行以下操作：

```
@model List<ArtWebShop.Models.cultures>

<p>
    @Html.DropDownList("name", (IEnumerable<SelectListItem>)Model)
</p> 
```

看在上帝的份上，我如何填充下拉列表，位于视图中的上述代码显然不起作用，但我似乎无法从控制器和视图中找到带有代码的单一解释。

PS：我不想使用 viewData 或 viewBag。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T16:59:26.930

请看：[如何从 ASP.NET MVC 中的枚举创建下拉列表？](https://stackoverflow.com/questions/388483/how-do-you-create-a-dropdownlist-from-an-enum-in-asp-net-mvc)

我喜欢`<%: Html.EnumDropDownListFor(model => model.MyEnumProperty) %>`

为你工作了吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T18:41:11.650

我找到了我的解决方案。我的灵感来自： [http](http://forums.asp.net/t/1817879.aspx/1) ://forums.asp.net/t/1817879.aspx/1其实很简单。

在我的**控制器**中：

```
 public ActionResult LanguageDropdownlist()
    {
        var culturelist = (_unitOfWork.CulturesRepository.Get()).ToArray();
        var list = new List<SelectListItem>();
                    for (int i = 0; i < culturelist.Count(); i++)
        {
            list.Add(new SelectListItem { Text = culturelist[i].name, Value = culturelist[i].id.ToString() });
        }

        return PartialView("_LanguageSelectionPartial", list);

    } 
```

在这里，我将它们添加到我的视图中，以便我可以在那里访问它们。

最后在我的**部分观点**中：

```
@model List<SelectListItem>

<p> 
    @Html.DropDownList("language-dropdown",  Model)
</p> 
```

我通过@model 访问它们并将它们放在@Html.DropDownList 中。

# php - php正则表达式解析端口数据

> ID：13731842
> 
> 赞同：0
> 
> 时间：2012-12-05T20:30:37.043
> 
> 标签：php, regex

我有以下字符串：

```
$teststring = " 

                                         Flow Link          Back   Mdix 
```

端口类型 Duplex Speed Neg ctrl State Pressure Mode

* * *

fa1 100M-铜线 -- -- -- -- 向下 -- --
fa2 100M- 铜线 -- -- -- -- 向下 -- --
fa3 100M- 铜线 -- -- -- -- 向下 -- - -
fa4 100M-铜线 -- -- -- -- 向下 -- --
fa5 100M- 铜线 -- -- -- -- 向下 -- --
fa6 100M- 铜线 -- -- -- -- 向下 -- --
fa7 100M-Copper -- -- -- -- Down -- --
fa8 100M-Copper -- -- -- -- Down -- --
gi1 1G-Combo-C -- -- -- --向下 - -
gi2 1G-Combo-C Full 100 启用 Off Up Disabled Off

```
 Flow    Link 
```

Ch Type Duplex Speed Neg control State

* * *

Po1 -- -- -- -- -- 不存在 Po2 -- -- -- -- -- 不存在 Po3 -- -- -- -- -- 不存在 Po4 -- -- -- -- --不存在 Po5 -- -- -- -- -- 不存在 Po6 -- -- -- -- -- 不存在 Po7 -- -- -- -- -- 不存在 Po8 -- -- -- -- - 不存在 ” ;

我正在尝试解析每个字段。这是我到目前为止的代码：

```
$teststring = explode("<BR>", $teststring);     
$vlandetailsArray = array();
foreach ($teststring as $vlandetails) 
{            
  //              port     space    type     space   duplex          speed       space  neg         
  $pattern = '/([a-z0-9]*)(\s*)([a-z0-9\-]*)(\s*)[(Full)|(\-{2})](\s*)[(\-)+|(100)](\s*)[(--)*|(Enabled)](\s*)[(--)*|(Off)]/i';

  if (preg_match($pattern, $vlandetails, $matches)) 
  {  
       echo 'match 0: '.$matches[0].'<br>';  //0 index always returns all matches
      } 
```

这将返回以下内容：

```
match 0: -------- ---- 
match 0: fa1 100M-Copper -- -- 
match 0: fa2 100M-Copper -- -- 
match 0: fa3 100M-Copper -- -- 
match 0: fa4 100M-Copper -- -- 
match 0: fa5 100M-Copper -- -- 
match 0: fa6 100M-Copper -- -- 
match 0: fa7 100M-Copper -- -- 
match 0: fa8 100M-Copper -- -- 
match 0: gi1 1G-Combo-C -- -- 
match 0: -------- ----
match 0: Po1 -- -- -- 
match 0: Po2 -- -- -- 
match 0: Po3 -- -- --
match 0: Po4 -- -- -- 
match 0: Po5 -- -- -- 
match 0: Po6 -- -- --
match 0: Po7 -- -- -- 
match 0: Po8 -- -- -- 
```

我不明白为什么它没有拿起看起来像这样的线：

```
gi2      1G-Combo-C   Full    100   Enabled  Off  Up          Disabled Off 
```

你能告诉我我错过了什么/做错了吗？
供参考。我还在玩我的正则表达式，所以你会注意到有时我使用模式 (-{2}) 和其他时候 -+ 等。

**编辑 1**

我已经修改了测试字符串。以前，我有以下代码将任何 CR LF 替换为
.

```
 $this->_data  = str_replace(chr(10),"<BR>",$this->_data ,$count);//strip New line
        $this->_data  = str_replace(chr(13),'',$this->_data ,$count);//strip carriage return 
```

对不起，我忽略了这些代码行——我的页面中有太多的“测试”。您现在看到的测试字符串是“原始”内容。我只是将所有内容保存到一个文件中，如下所示：

```
 $fp = fopen('/var/www/lsm/application/logs/showinterfacesstatus.txt', 'w');
 fwrite($fp, $this->_data);
 fclose($fp); 
```

其中 $this->_data 包含原始数据。我打开了这个文件并复制了所有内容......然后粘贴到我的 teststring 变量中。
话虽如此，我已经在文本编辑器中分析了文件，我可以看到原始字符串和修改后的字符串之间唯一不同的是它已被剥离所有 CRLF。但如果它有帮助，我已经删除了这个逻辑。我还在文本编辑器中包含了未修改数据的屏幕截图。谢谢。 ![原始数据](../Images/54821040a7c12d918c6aacfd151fee8a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T21:46:39.040

试试这个：

```
#[a-z]{2}\d\s[^\s]+ [a-z\-]+[^\s]+ ([^\s]+) ([^\s]+) ([^\s]+) ([^\s]+) ([^\s]+) ([^\s]+)#si 
```

您必须启用不区分大小写的模式。

另一个，捕获...接口名称？

```
#[a-z]{2}\d ([^\s]+) [a-z\-]+[^\s]+ ([^\s]+) ([^\s]+) ([^\s]+) ([^\s]+) ([^\s]+) ([^\s]+)#si 
```

完整代码示例：

```
<?php

$teststring = " 
Flow Link Back Mdix 
Port Type Duplex Speed Neg ctrl State Pressure Mode 
-------- ------------ ------ ----- -------- ---- ----------- -------- ------- 
fa1 100M-Copper -- -- -- -- Down -- -- 
fa2 100M-Copper -- -- -- -- Down -- -- 
fa3 100M-Copper -- -- -- -- Down -- -- 
fa4 100M-Copper -- -- -- -- Down -- -- 
fa5 100M-Copper -- -- -- -- Down -- -- 
fa6 100M-Copper -- -- -- -- Down -- -- 
fa7 100M-Copper -- -- -- -- Down -- -- 
fa8 100M-Copper -- -- -- -- Down -- -- 
gi1 1G-Combo-C -- -- -- -- Down -- -- 
gi2 1G-Combo-C Full 100 Enabled Off Up Disabled Off 

Flow Link 
Ch Type Duplex Speed Neg control State 
-------- ------- ------ ----- -------- ------- ----------- 
Po1 -- -- -- -- -- Not Present 
Po2 -- -- -- -- -- Not Present 
Po3 -- -- -- -- -- Not Present 
Po4 -- -- -- -- -- Not Present 
Po5 -- -- -- -- -- Not Present 
Po6 -- -- -- -- -- Not Present 
Po7 -- -- -- -- -- Not Present 
Po8 -- -- -- -- -- Not Present";

$pattern = '#[a-z]{2}\d ([^\s]+) [a-z\-]+[^\s]+ ([^\s]+) ([^\s]+) ([^\s]+) ([^\s]+) ([^\s]+) ([^\s]+)#si';

preg_match_all($pattern, $teststring, $matches, PREG_SET_ORDER);

foreach ($matches as $match) {
    echo '<pre>';
    var_dump($match);
    echo '</pre>';
}

/* EOF */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T15:08:14.017

这是有效的正则表达式模式：

$pattern = '/([az]{2}\d)(\s*)([0-9a-z-] *)(\s* )([az-] *)(\s* ) ([0-9- ] *)(\s* )([az-] *)(\s* )([az-] *)(\s* )([az-] *)(\s* )([az-] *)(\s* )([az- ]*）/一世';

# c++ - 是否可以对浮点数近似的不同形式进行分类

> ID：13731846
> 
> 赞同：0
> 
> 时间：2012-12-05T20:30:44.547
> 
> 标签：c++, double, floating

我只是想知道我们是否可以为使用浮点数逼近实数的形式制定规则。

例如，一个浮点数可以被终止`1.xxx777777`（因此由无限 7 终止，最后是一个随机数字）？

我相信只有这种形式的浮点数：

**1.**准确值。

**2.**像`1.23900008721`.... 这样的值，所以 where`1.239`用显示为“噪声”的数字来近似，但在精确值和这个噪声之间有 0

**3.**值 like `3.2599995`，其中`3.26`通过加上`9999..`一个最后的数字（like `5`）来近似，所以用一个在实数下方的浮点数来近似

**4.**像 的值`2.000001`，其中`2.0`用一个浮点数近似，刚好在实数之上

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:53:46.743

您正在考虑十进制数，即可以表示为 的数字，`n*(10^e)`正`e`数或负数。由于与十根手指有关的历史原因，这些数字自然地出现在您的思维过程中。

出于与存在或不存在电信号有关的技术原因，计算机数字以二进制表示。

当您处理较小的整数时，计算机表示与您自己的表示不匹配并不重要，因为您正在考虑数学数字的准确近似，计算机也是如此，因此通过传递性，您和计算机正在考虑同样的事情。

对于非常大或非常小的数字，你会倾向于以十的幂来思考，而计算机肯定会以二的幂来思考。在这些情况下，您可以观察到您的直觉与计算机所做的事情之间的差异，而且您的分类是无稽之谈。二进制浮点数在恰好具有十进制数的紧凑表示的数字附近既不是更密集也不是更不密集。它们简单地用二进制表示`n*(2^p)`，`p`无论是正面的还是负面的。许多实数只有十进制的近似表示，许多实数只有二进制的近似表示。这些数字不相同（二进制数字可以用十进制表示，但并不总是紧凑的。一些十进制数字根本不能用二进制精确表示，例如 0.1）。

如果你想了解计算机的浮点数，你**必须**停止思考十进制。`1.23900008721....`不是特别的，也不是`1.239`。`3.2599995`不是特别的，也不是`3.26`。你**认为**它们很特别，因为它们要么是精确的，要么接近于紧凑的十进制数。但这对二进制浮点没有任何影响。

* * *

由于您标记了您的问题 C++，因此这里有一些信息可能会让您感到有趣：

如果您使用 格式打印一个双精度数字`%.16e`，您会得到一个转换回原始 的十进制数字`double`。但它并不总是代表原始的确切值`double`。要查看十进制的确切值`double`，您必须使用`%.53e`. 如果您`0.1`在程序中编写，编译器会将其解释为含义`1.000000000000000055511151231257827021181583404541015625e-01`，这是一个相对紧凑的二进制数。您的问题谈到 3.2599995 和 2.000001 好像这些是浮点数，但它们不是。如果在程序中编写这些数字，编译器会将它们解释为 3.25999950000000016103740563266910612583160400390625 和 2.00000100000000013977796697872690856456756591796875。因此，您正在寻找的模式很简单：浮点数的十进制表示始终是 17 个有效数字，后跟 53-17=36 个“噪声”数字，正如您所说的那样。噪声数字有时全为零，有效数字也可以以一堆零结尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:34:03.583

浮点数由位表示。这意味着：

1.  小数点后翻转 1 位是 0.5 或 1/2
2.  01 位是 0.25 或 1/4
3.  等等

这意味着当以机器可以处理的内容表示时，如果浮点数不是 2 的精确幂，则它总是近似接近但不精确。

[机器可以非常准确地表示有理数](http://en.wikipedia.org/wiki/Rational_number)（如果不是小数点以下的 2 的幂，当然不能精确地表示），但[无理数](http://en.wikipedia.org/wiki/Irrational_number)总是会出错。`c++`就此而言，您的问题与to没有太大关系`computer architecture`。

# java - 将新的代码模板应用于现有的 java 文件

> ID：13731848
> 
> 赞同：3
> 
> 时间：2012-12-05T20:30:48.267
> 
> 标签：java, eclipse

我们有很多使用`code formatter`, `code style`（具有版权信息）模板开发的 java 文件。现在我们决定更新格式化程序和样式模板。是否可以根据新模板`code formatter`和`code style`模板更新所有 java 文件？

手动编辑 java 文件中的所有版权声明是一个繁琐的过程。因此，如果我们能快速做到这一点，这对我们将非常有帮助。

我们正在使用`eclipse v3.4`我们的开发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T22:27:06.640

Eclipse 3.4 已经很老了，所以我不能 100% 确定这个功能是否可用......

右键单击要格式化的项目或包，然后选择*Source* > *Format*。

这只会应用在 Preferences/Java/Code Style/Formatter 中选择的格式设置。它不会添加或更改代码或注释。创建新类/文件时选择模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:35:20.010

是的，手动这与 Ctrl-Shift-f 一起使用，它使用格式化规则自动格式化当前代码/类。

要通过批处理进行全自动重新格式化，您需要进一步的答案。但要注意有时 rukles 会破坏某些特殊类的可读性。我宁愿手动浏览所有类，然后应用 Ctrl-Shift-f。
在此期间，您可能会看到，应该调整一些格式规则。

# asp.net-mvc - 如何将硬编码的 html 网站转换为 asp mvc4？

> ID：13731851
> 
> 赞同：1
> 
> 时间：2012-12-05T20:30:54.500
> 
> 标签：asp.net-mvc

我有一个 5 页的硬编码 html 网站，并希望将其转换为 mvc4。

我需要做什么？是否有教程或分步指南概述了如何通过 MVC 使 .html 文件动态化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:35:10.430

您将希望在更改 MVC 之前对 MVC 尤其是路由有一个基本的了解 - 您将在未来避免很多混乱和陷阱。

基本上，您需要做的就是为您的 html 创建控制器（暂时是虚拟的），并将 html 复制到相应的视图中。当您了解 global.asax 文件中的路由时，这一切都会变得有意义。然后我会更新`@Html.ActionLink`语法的链接并从那里移动——接下来可能会提取一个`_Layout`通用设计等。

基本上，至少阅读一个快速教程，否则你只会让自己感到沮丧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:36:52.227

如果页面上有唯一的数据，那么您可以为每个页面、模型和视图创建一个控制器。

如果所有页面都有类似的信息，您可以拥有一个具有各种视图的控制器。

# android - 自定义微调器，如 android 4.0

> ID：13731855
> 
> 赞同：-3
> 
> 时间：2012-12-05T20:31:05.503
> 
> 标签：android, spinner

我尝试使自定义微调器看起来像在 android 4.0 中，但我不知道如何替换微调器下拉选择列表。欢迎任何帮助。

我从 android 4.0 sdk 获取资源文件，但 dopdown 选择列表没有改变。

```
<Spinner
       android:id="@+id/update_frequency_spinner"
       android:layout_width="75dp"
       android:layout_height="wrap_content"
       android:layout_alignParentRight="true"
       android:spinnerMode="dropdown" 

       android:background="@drawable/spinner_background_holo_light"
       android:dropDownSelector="@drawable/list_selector_holo_light"
       android:popupBackground="@drawable/menu_dropdown_panel_holo_light">
</Spinner> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T23:50:22.803

*   这个[如何从微调器下拉菜单中自定义样式？](https://stackoverflow.com/questions/8077767/how-to-customize-style-from-spinner-dropdown-choices)可以回答你的问题。
*   如果你想要一个用于全息前设备的全息主题应用程序，你也可以考虑使用 HoloEverywhere [https://github.com/ChristopheVersieux/HoloEverywhere](https://github.com/ChristopheVersieux/HoloEverywhere)

# javascript - 使用 JS 动态改变元素样式 - Joomla ChronoForms

> ID：13731857
> 
> 赞同：0
> 
> 时间：2012-12-05T20:31:12.800
> 
> 标签：javascript, jquery, joomla, mootools

请帮我填写我正在尝试做的表格。

我有一个下拉选择，<select> 中的所有选项都有 ID，例如：一个选项有 id="hide_me"，另一个选项有 id="hide_none"。

这是我为表单提供的 JS：

```
<?php
$script = "window.addEvent('domready', function() {
$('recipe').addEvent('change', function(event) {
  if ( $('recipe')document.getElementById('hide_it').selected === true ) {
     $('hide_me1').setStyle('opacity', '1');
     $('hide_me2').setStyle('opacity', '1');
  }
});
$('recipe').addEvent('change', function(event) {
  if ( $('recipe')document.getElementById('hide_none').selected === true ) {
     $('hide_me1').setStyle('opacity', '0');
     $('hide_me2').setStyle('opacity', '0');
  }
});
});
";
$doc =&JFactory::getDocument();
$doc->addScriptDeclaration( $script );
?> 
```

“recipe”是下拉列表的名称和 ID < select >

目前它给了我一个像“SyntaxError：Unexpected identifier”这样的JS错误，有人可以帮我解决这个问题吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T00:11:16.890

您生成的 js 如下所示：

```
window.addEvent('domready', function() {
    $('recipe').addEvent('change', function(event) {
        if ($('recipe') document.getElementById('hide_it').selected === true) {
            $('hide_me1').setStyle('opacity', '1');
            $('hide_me2').setStyle('opacity', '1');
        }
    });
    $('recipe').addEvent('change', function(event) {
        if ($('recipe') document.getElementById('hide_none').selected === true) {
            $('hide_me1').setStyle('opacity', '0');
            $('hide_me2').setStyle('opacity', '0');
        }
    });
}); 
```

如果你使用 jslint / jshint 之类的东西，甚至粘贴到 jsfiddle 并按下 jslint 按钮，它会立即报告问题。

然而：

`$('recipe') document.getElementById('hide_it').selected === true)`没有意义。我猜您正在尝试读取 ID 为 hide_it 的选项，它是配方的子项？

这是错误的做法，但这将是这样的：

```
$('recipe').getElement('#hide_it').get('selected'); // pointless as by id alone is faster and id is meant to be unique
document.getElement('#receipe #hide_id').get('selected'); // also pointless like above, alt syntax that allows you to combine selectors.
$('hide_it').get('selected'); // works but also wrong, not how you work with selects. 
```

使用 mootools获取 a 值的正确方法`select`很简单：

```
$('receip').addEvent('change', function(){
    // within this function, this === $('recipe');
    var opacity = this.get('value') === 'hide_it' ? 1 : 0;
    $$('#hide_me1,#hide_me2').setStyle('opacity', opacity);

    // w/o a reference you could do in a single line:
    $$('#hide_me1,#hide_me2').setStyle('opacity', +(this.get('value') == 'hide_it'));
}); 
```

这仍然有些无效，因为当它们可能是静态的时，它会在每个更改事件中查找 2 个 hide_me els。

您还应该停止使用基于类的 id 和模式，id 不能很好地扩展。

# html - 尝试制作 CSS 下拉菜单，但无法让下拉元素排列在左侧

> ID：13731859
> 
> 赞同：1
> 
> 时间：2012-12-05T20:31:26.077
> 
> 标签：html, css, drop-down-menu, cascadingdropdown

我正在尝试制作一个下拉菜单来显示移动设备（即智能手机）上以前隐藏的元素。目前，我的下拉菜单的子元素在其父元素的右侧产生问题。我附上了一张图片来说明这种行为。我非常想让这些子元素生成到左侧，这样它们就不会增加智能手机或其他移动设备上视口的大小。有人可以在这件事上帮助我吗？

![CSS下拉情况](../Images/c86e7667ab539abe3b7f0c3389deae1c.png)

这是我的 HTML 代码和一些 Razor 代码：

```
<nav>
<ul>
    <li class="@(controllerName == "Home" && actionName == "Index"?" CurrentActiveLink":"")">@Html.ActionLink("Hjem", "Index", "Home")</li>
    <li class="@(controllerName == "Home" && actionName =="Tickets"?" CurrentActiveLink":"")">@Html.ActionLink("Billetter", "Tickets", "Home")</li>
    <li class="no-portrait yes-landscape@(controllerName =="Activities" && actionName == "Index"?" CurrentActiveLink":"")">@Html.ActionLink("Aktiviteter", "Index", "Activities")</li>
    <li class="@(controllerName == "Home" && actionName =="InfoAndFAQ"?"CurrentActiveLink":"")">@Html.ActionLink("Info og FAQ", "InfoAndFAQ", "Home")</li>
    <li class="no-portrait @(controllerName == "Home" && actionName == "Parents"?"CurrentActiveLink":"")">@Html.ActionLink("Til de foresatte", "Parents", "Home")</li>
    <li class="no-portrait"><a href="http://banzaicon.net/forum">Forum</a></li>
    <li class="no-portrait@(controllerName == "Home" && actionName =="ContactUs"?" CurrentActiveLink":"")">@Html.ActionLink("Kontakt arrangørene", "Contact", "Home")</li>
    <li class="only-mobile"><a href="#">&gt;</a>
        <ul>
            <li>@Html.ActionLink("Til de foresatte", "Parents", "Home")</li>
            <li><a href="http://banzaicon.net/forum">Forum</a></li>
            <li>@Html.ActionLink("Kontakt arrangørene", "Contact", "Home")</li>
        </ul>
    </li>
</ul> 
```

这是我的 CSS 代码：

```
nav 
{
 width:100%;
 text-align:right;
 margin-bottom:2px;
}

nav ul 
{
 margin:0;
 padding:0;
}

nav ul li 
{
 list-style-type:none;
 display:inline-block;
 border-top-left-radius:5px;
 border-top-right-radius:5px;
 background-color:#CCC;
 padding:10px;
 font-size:16px;
 font-weight:bold;
 position:relative;
}

nav ul li:hover, nav ul li.CurrentActiveLink
{
 background-color:White;
}

nav a, nav a:visited 
{
 color:Blue;
 text-decoration:none;
}

nav ul li:hover ul
{
 display:block;
 position:absolute;
}

nav ul li ul li 
{
 display:block;
 float:none;
 left:0;
}

nav ul li ul a, nav ul li ul a:visited
{
 white-space:nowrap;
}

nav ul li ul 
{
 display:none;
 margin:none;
 padding:none;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:37:08.520

我认为您可以使用以下方法解决此问题：

```
nav ul li ul li {
    display: block;
    float: none;
    left: 0;
    /*change to fit*/ margin-left: -300px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T20:47:23.243

丹尼尔的回答让我的思绪朝着正确的方向前进，这个片段解决了它：

```
nav ul li:hover ul
{
 display:block;
 position:absolute;
 right:15%; /* <-- This line right here did the trick! */
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T20:46:49.023

试试这个：

```
nav ul ul li a {
    display:block;
    text-align:left;
} 
```

# jquery - jQuery 旋转 - IE7 和 IE8 问题

> ID：13731867
> 
> 赞同：11
> 
> 时间：2012-12-05T20:31:51.693
> 
> 标签：jquery, rotation, image-rotation, jquery-rotate

我正在使用 Jquery Rotate 将图像旋转一米，效果很好，但在 IE7 和 IE8 中，它被推高了大约 200 像素，并且图像周围有黑色笔触/边框。

我正在使用它工作的 jQueryRotate3.js，但位置已关闭，并且不确定黑色边框来自哪里？

JS：

```
 var start = 0;
        // Sets the Value of the City for now   
            var angle = 1 + Math.floor(Math.random() * 180);

            $("img.pointer").rotate({
                 angle: start,
                 animateTo: angle,
                 easing: $.easing.easeInOutSine
            }) 
```

HTML：

```
<div class="city-details">
   <div class="details">
     <img class="pointer" src="http://demo.omnigon.com/christian_bovine/shamelesscity/images/pointer.png" alt="" />
    </div>
</div>​ 
```

你可以在这里看到代码：http: [//jsfiddle.net/xtian/6gcS8/1/](http://jsfiddle.net/xtian/6gcS8/1/)

我真的很想让这个在 IE7 和 IE8 中工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T11:29:49.980

[**jsFiddle 演示**](http://jsfiddle.net/6gcS8/9/)

我查看了您使用的**jQuery Rotate v3.1**脚本，它很稀疏，只需为 IE 完成工作所需的最少内容，考虑到这一点很好。

只需包含两个 CSS 规则`top`和`left`，根据您的`margin-top`和`margin-left`值让它在 IE 系列非 CSS3 浏览器中工作。

例子：

```
img.pointer{
    display: block;
    width: 192px;
    height: 11px;
    top: 211px;
    left: 48px;    
    margin: 211px 0 0 48px;
} 
```

请注意，无需设置 CSS `position`，因为此脚本将其设置为`absolute`覆盖您提供的任何内容。

解决IE 浏览器中**图像黑色边框**问题的一种方法是将`background-color`属性设置为与背景匹配的值...期望在您的情况下，中间部分有 3 种蓝色和白色...*所以这不是好主意*。

相反，请使用最常见的解决方案，即 a `PNG8 Filetype Image with Transparency`，如本[**SO Answer**](https://stackoverflow.com/a/5362565/1195891)中所述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T23:07:00.677

我设法通过删除边距并使用相对定位设置位置来使其工作，例如：

```
img.pointer{
    display: block;
    width: 192px;
    height: 11px;
    margin: 211px 0 0 48px;
} 
```

到

```
img.pointer{
    display: block;
    width: 192px;
    height: 11px;
    position: relative;
    top: 218px;
    left: 50px;
} 
```

我没有安装 ie7/8，但我可以使用 IE9 兼容性视图设置，它显示原始小提琴中的针放错了位置（它在 Chrome 和 Firefox 中仍然按预期运行）。

试试这个更新的小提琴，如果你还有问题，请告诉我：http: [//jsfiddle.net/6gcS8/4/](http://jsfiddle.net/6gcS8/4/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T23:14:33.933

在 IE7/8 中执行旋转或淡入淡出等操作总是可能产生不希望的副作用，因为它超出了浏览器的标准功能。在所有其他浏览器中，这非常容易，但对于旧的 IE，您的 jQuery 插件将做一些非常 hacky 的东西来使其工作。这种骇人听闻的东西在某些情况下可能会起作用，但往往非常脆弱且容易损坏。

IE 的旋转机制非常笨拙。所描述的图像被向上移动 200 像素的问题听起来像是旋转中心点可能不正确。这是我在 IE 中尝试使用旋转时经常遇到的问题。我本来希望您的 jQuery 插件能够透明地处理它，但是如果它出错了，那么我不确定您如何在不完全绕过插件或为 IE 使用高 200 像素的不同图像或其他东西的情况下纠正它像那样。

关于黑色边框，这可能是处理 PNG 图像上的 alpha 通道的问题。您可能想通过使用 GIF 图像来确认这一点（尽管它看起来不太好）。

但总的来说，我的主要建议是完全避免在旧 IE 中做这种事情。它只是有太多的问题，使它值得付出努力。

查看您的 jsFiddle 示例，您似乎这样做是为了绘制速度计类型的仪表并为其设置动画。

我可以建议一种替代方法，它可以完全消除旋转 DOM 元素的麻烦。

有一个名为[Raphael](http://raphaeljs.com/)的 Javascript 库，它可以绘制矢量图形。它适用于所有浏览器，包括旧的 IE 版本。使用拉斐尔很容易画出好看的速度表。事实上，我在 SO 上的另一个答案中提供了一个 4 行 JS 脚本来做到这一点。请参阅此处：[绘制半量规/速度计（需要 JavaScript Canvas 或 Java Swing 示例）](https://stackoverflow.com/questions/5083221/drawing-a-half-gauge-speedometer-javascript-canvas-or-java-swing-example-needed/5632389#5632389)。您可以使用该脚本，修改它以使用您现有的仪表背景图像，以及宾果游戏，一个在所有浏览器中工作的速度仪表，没有任何试图让 IE 做事的错误不是设计的。

希望有帮助。

# c# - 从 C# 中的重写类调用父方法

> ID：13731868
> 
> 赞同：0
> 
> 时间：2012-12-05T20:31:55.280
> 
> 标签：c#, oop, inheritance

我有以下代码：

```
class ClassA
{
    public virtual void DoSomething()
    {
        DoSomething(1); // when called from ClassB, it calls DoSomething from ClassA with an infinite recursion
    }

    public virtual void DoSomething(int someInt)
    {
        // do something
    }
}

class ClassB : ClassA
{
    public override void DoSomething()
    {
        DoSomething(1);
    }
    public override void DoSomething(int someInt)
    {
         base.DoSomething(someInt);

        // do something
    }
}

class Program
{
    void someMethod()
    {
        ClassB instance = new ClassB();
        instance.DoSomething(); // stack overflow caused by infinite recursion
    }
} 
```

我的问题是，当我调用`ClassB.DoSomething();`它并调用它时，`base.DoSomething(someInt);`我希望派生 ClassB 的父类调用 ClassA 的方法，而不是被覆盖的方法。

有没有办法在不复制/粘贴重复代码的情况下以干净的方式做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T22:09:33.187

您可以像这样修改基类：

```
class ClassA
{
    public virtual void DoSomething()
    {
        DoSomethingHelper(1); // when called from ClassB, it calls DoSomething from ClassA with an infinite recursion
    }

    public virtual void DoSomething(int someInt)
    {
        DoSomethingHelper(someInt);
    }

    private void DoSomethingHelper(int someInt)
    {
        // do something
    }
} 
```

通过将整个方法重构为私有方法，您提供了一种调用当前类的方法定义的方法，同时仍然为子类提供了一个虚拟方法来访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T21:08:41.463

当您覆盖虚拟方法时，您无法在没有 base 关键字的情况下调用它，因此您无法从该类中调用 if。您可以尝试使用 Jon B 所说的并使用方法阴影而不是覆盖。

```
class ClassA
{
    public void DoSomething()
    {
        DoSomething(1); 
    }

    public void DoSomething(int someInt)
    {
        Console.WriteLine("a");
    }
}

class ClassB : ClassA
{
    public new void DoSomething()
    {
        DoSomething(1);
    }

    public new void DoSomething(int someInt)
    {
        base.DoSomething();
    }
} 
```

# datagrid - 在数据网格列中显示关联模型的属性

> ID：13731869
> 
> 赞同：0
> 
> 时间：2012-12-05T20:31:56.500
> 
> 标签：datagrid, model-associations

我有两个模型：`User`和`Dog`. 我希望能够在单个 Datagrid 报告中显示它们。使用该方法时，我使用什么语法来引用用户模型的特定属性`column()`？现在我只是显示对象，`User`但我想显示模型的各种列`:name`和属性。`:gender``:age``User`

```
class User < ActiveRecord::Base
  attr_accessible :email, :age, :gender, :name
  has_many :dogs

class Dog < ActiveRecord::Base
  attr_accessible :name, :age
  belongs_to :user

class DogReport
    include Datagrid

  #
  # Scope
  #

  scope do
    Dog.includes(:user)
  end

  #
  # Filters
  #

  filter(:dog_id, :integer)

  #
  # Columns
  #

  column(:id)
  column(:name)
  column(:age)
  column(:user)
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:49:44.003

```
column(:user, :header => "user.name") do
  self.user.name
end 
```

# vb.net - 将日期时间从本地转换为 UTC，反之亦然

> ID：13731871
> 
> 赞同：0
> 
> 时间：2012-12-05T20:31:59.710
> 
> 标签：vb.net, datetime, utc, datetime-format

我以为我想出了如何做到这一点，但似乎我做错了。我有两个日期，一个是发布的日期时间，它是从 json 提要中检索到的，并以 UTC 设置。然后我使用我被告知的 MSQM.message.arrivedtime 设置为其他日期的计算机时间（本地）作为获取日期，但我将其转换为 UTC。现在的问题是，有时获取日期早于发布的日期时间，这不应该是这种情况。这是我的工作流程的一部分：

```
 fetchDate as string = message.ArrivedTime.ToString
     ("yyyy-MM-dd hh:mm:ss",  CultureInfo.CreateSpecificCulture("en-US")) 
```

....示例日期：2012-12-05 07:59:12 然后是更多代码和其他功能...这是解析出来的发布日期时间

2012-12-05 12:59:34

所以现在我将 fetchDate 转换为 UTC：

```
Dim nowDate As DateTime = DateTime.ParseExact
    (fetchDate, "yyyy-MM-dd HH:mm:ss", Globalization.CultureInfo.InvariantCulture)
fetchDate = nowDate.ToUniversalTime.ToString
 ("yyyy-MM-dd HH:mm:ss", CultureInfo.InvariantCulture) 
```

现在 fetchDate = 2012-12-05 12:59:12

这是一个案例。为什么会这样，谁能看到我在这里做错了什么？

# java - 为什么 java Class 对象在作为 Class 变量访问时具有不同的 API/签名，而不是通过 .getClass() 方法？

> ID：13731879
> 
> 赞同：1
> 
> 时间：2012-12-05T20:32:34.813
> 
> 标签：java, lang

我看到 Class 实例具有不同的签名，至少在`getAnnotation`方法方面，比较 Class 对象和`<some-object>.getClass()`对象。

以下代码显示了一个示例案例。

```
@Bar("hello")
public class Foo {

    public static void main(String[] args) {

        Foo foo=new Foo();
        Bar bar1,bar2,bar3;

        Class clazz=foo.getClass();

        //This compiles and work (as expected)
        bar1=foo.getClass().getAnnotation(Bar.class);

        //This does not compile!
        bar2=clazz.getAnnotation(Bar.class);

        //This one copiles and work!
        bar3=(Bar) clazz.getAnnotation(Bar.class);

    }
}

@Retention(RetentionPolicy.RUNTIME)
@interface Bar {
    String value();
} 
```

注意：整个示例是从我的编辑器中复制和粘贴的。

--------修改以更好地展示场景

我忘了在示例中显示“代码”不知道 Foo 的存在，例如外部库：

```
class SomeExternalLibrary{
    public static void someMethod(Class clazz){        
        Bar bar2,bar3;        

        bar2=clazz.getAnnotation(Bar.class);        

        //This one copiles and work!
        bar3=(Bar) clazz.getAnnotation(Bar.class);
    }
} 
```

使用这个外部库的代码是这样的：

```
SomeExternalLibrary.someMethod(Foo.class); 
```

很抱歉没有那么清楚我的场景现实:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:36:27.647

这个问题是关于泛型的。

编译错误的原因是你没有在`clazz`变量中包含类信息。

将代码更改为此将解决问题：

```
Class<Foo> clazz = foo.getClass(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T20:39:43.510

另一个答案是正确的，因为它与泛型有关，但代码更改应该是：

```
Class<? extends Foo> clazz = foo.getClass(); 
```

* * *

在您的第二种情况下，同样的事情正在发生。由于您没有使用泛型，因此`getAnnotation(Bar.class)`只返回一个`Annotation`. 如果您要使用下面的泛型，它将起作用：

```
public static <T> void someMethod(Class<T> clazz) { ... } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T20:43:35.990

getAnnotation 使用泛型定义为

```
<T> T getAnnotation(Class<T> clazz) 
```

这意味着只要可以在编译时解析泛型，注释就不需要类型转换。在第二个示例中，`Class clazz`变量已存储为原始类型。如果您将其限定为`Class<? extends Foo> clazz`第二个示例将起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-20T12:54:31.197

我不知道为什么，但如果你使用它会起作用：

```
Class<?> clazz 
```

代替

```
Class clazz 
```

# ajax - django/ajax：无法在 views.py 中获取 Ajax 发布数据

> ID：13731880
> 
> 赞同：4
> 
> 时间：2012-12-05T20:32:44.983
> 
> 标签：ajax, django, post

我从 django 后端获取 ajax 发布数据时遇到问题，我不知道如何传递值，请帮忙。

在 html 中我有这个：

```
<form id="get_vulns_from_family">
    <label for="family_content">Enter a family name to display the NVTs</label>
    <input id="family_content" />
    <input type="submit" value="search" />
</form> 
```

在javascript中我写了这个：

```
$(function() {
    $("#get_vulns_from_family").submit(function(event) {
        var family_text = $("#family_content").val();
        var family_data = {"family": family_text};
        $.ajax({
            url: "/template_conf/get_vulns_from_family",
            type: "POST",
            data: family_data,
            success: function(response) {
                console.log(response);
            },
            error: function(response) {
                console.log("failed!");
            }
        });
        // prevent default posting of form
        event.preventDefault();
    });
}); 
```

在对应于 url 的 Django 方法中`/template_conf/get_vulns_from_family`，我尝试了这个：

```
def get_vuln_from_family(request):
    family = request.POST['family']
    # some other operations to get value for variable "json_data"
    return HttpResponse(simplejson.dumps(json_data)) 
```

但是 django 说：`MultiValueDictKeyError: "Key 'family' not found in <QueryDict: {}>"`，这意味着 POST 字典是空的。我是否使用错误的方式获取帖子数据？如果是这样，我该怎么办？谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-05T20:37:02.850

您的网址`"/template_conf/get_vulns_from_family"`缺少尾部斜杠。django 通常会将其重定向到`"/template_conf/get_vulns_from_family/"`，删除`POST`数据

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-21T05:01:02.437

如果您的 CSRF 启用，那么简单的 ajax 发布将不起作用。您必须添加 csrf 令牌并将其设置为 ajax 请求标头。

对于 Ajax POST 请求，您必须将 CSRF 令牌作为 POST 数据与每个 POST 请求一起传递。因此，您必须先获取 CSRF 令牌。由于您已启用 CSRF 保护，因此您将从 csrftoken cookie 中获取令牌。CSRF 令牌 cookie 默认命名为 csrftoken。获取令牌非常简单，可以使用下面的代码片段来实现。

```
function getCookie(name) {  
    var cookieValue = null;  
    if (document.cookie && document.cookie != '') {  
        var cookies = document.cookie.split(';');  
        for (var i = 0; i < cookies.length; i++) {  
            var cookie = jQuery.trim(cookies[i]);  

            if (cookie.substring(0, name.length + 1) == (name + '=')) {  
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));  
                break;  
            }  
        }  
    }  
    return cookieValue;  
}  

function csrfSafeMethod(method) {  

    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));  
}  

function sameOrigin(url) {  

    var host = document.location.host; // host + port  
    var protocol = document.location.protocol;  
    var sr_origin = '//' + host;  
    var origin = protocol + sr_origin;  

    return (url == origin || url.slice(0, origin.length + 1) == origin + '/') ||  
        (url == sr_origin || url.slice(0, sr_origin.length + 1) == sr_origin + '/') ||  

        !(/^(\/\/|http:|https:).*/.test(url));  
}  

$(function() {  

        $("#person_form_id").submit(function(event){  

            event.preventDefault();  
            $.ajax({  
                type:$(this).attr('method'),  

                url:"",  
                data:$(this).serialize(),  
                success: function(){  
                    $('#message').html("<h2 style='color:green;'>Person Form Submitted!</h2>")  
                },  
                error: function(){  
                    $('#message').html("<h2 style='color:red;'>Can't submit form</h2>")  
                }  
            });  
            return false;  
        });  

    });  
    $.ajaxSetup({  
        beforeSend: function(xhr, settings) {  
            if (!csrfSafeMethod(settings.type) && sameOrigin(settings.url)) {  
                // Send the token to same-origin, relative URLs only.  
                // Send the token only if the method warrants CSRF protection  
                // Using the CSRFToken value acquired earlier  

                xhr.setRequestHeader("X-CSRFToken", csrftoken);  
            }  
        }  
    }); 
```

# javascript - DrawImage 不会在第一帧加载

> ID：13731882
> 
> 赞同：0
> 
> 时间：2012-12-05T20:32:47.793
> 
> 标签：javascript, html, canvas

我的画布有一个简单的绘图图像，但它不会显示在第一帧上。

这让我很生气，我不知道为什么它不会这样做！

这是我的脚本：

```
img = new Image();
img.src = 'images/0.png'; //preLoad the image

window.requestAnimFrame = (function(){
  return  window.requestAnimationFrame       || 
          window.webkitRequestAnimationFrame || 
          window.mozRequestAnimationFrame    || 
          window.oRequestAnimationFrame      || 
          window.msRequestAnimationFrame     || 
          function( callback,  element){
            window.setTimeout(callback, 1000 / 60);
          };
})(); //frames per second

function gameUpdate(){ 
    previous = 0;
    requestAnimFrame( gameUpdate ); 
    draw(); 
} 
```

然后`draw()`函数有这个：

```
//doesn't display on first fame
canvas['canvas1'].ctx.drawImage(img, 100, 150); 

//displays on first frame           
canvas['canvas1'].ctx.fillStyle = "rgba(255, 255, 255, 0.8)";
canvas['canvas1'].ctx.fillRect (30, 30, 55, 50); 
```

FillRect 工作正常，但不是第一帧的 drawImage，任何想法为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:34:26.033

我认为您应该通过在函数`requestAnimFrame` *外部*调用来启动动画循环`gameUpdate`

```
requestAnimFrame(gameUpdate) 
```

您可能还需要确保实际加载了图像

```
var img = new Image();
img.onload = function() {
    // do the draw image here
}
img.src = 'images/0.png'; //preLoad the image 
```

# css - 如何将最小宽度集中在空 div 上

> ID：13731886
> 
> 赞同：3
> 
> 时间：2012-12-05T20:32:56.293
> 
> 标签：css, layout, html, grid

我正在尝试显示一些“对齐”的文本——我决定使用 6 列布局，但它并不是真正的列布局，因为每行可以有一个单元格（如表格中）跨越多个列。但是，我只使用这样做。

我的 CSS 如下所示，只要有内容，它就可以工作。但是，如果没有内容，它会失败。请帮忙！

.p_row { 宽度：900px; 填充顶部：0px；清除：左；}

```
 .p_col1 { min-width: 140px; }
    .p_col2 { min-width: 280px; }
    .p_col3 { min-width: 420px; }
    .p_col4 { min-width: 560px; }
    .p_col5 { min-width: 700px; }
    .p_col6 { min-width: 840px; }

    .labeldesc {
        display: inline-block; 
        float: left;
        text-align: left; 
        vertical-align: top; 
        margin-right: 0px; 
    }

    .field {
        display: inline;  
        float: left;
        text-align: left; 
        vertical-align: top; 
        margin-right: 0px; 
    } 
```

样本数据：

```
<div class="Row Container">
    <div class="p_row">
        <div class="p_col1 labeldesc">Condition:</div>
        <div class="p_col1 field">@clinicalCondition.Description</div>
        <div class="p_col1 labeldesc">Is Chronic:</div>
        <div class="p_col1 field">@clinicalCondition.ChronicIndicatorString</div>
        <div class="p_col1 labeldesc">Date</div>
        <div class="p_col1 field">@clinicalCondition.DateString</div>
    </div>

    <div class="p_row">
        <div class="p_col1 labeldesc">Comment:</div>
        <div class="p_col5 field">@clinicalCondition.Comments</div>
    </div>
</div> 
```

在上面，我希望所有标签/字段对齐，但如果字段值之一是 string.empty，则最小宽度不起作用。如果我删除浮动：左，它也不起作用。并且 display: inline-block 似乎没有做任何事情，最小宽度也没有。

任何帮助将不胜感激！我正在使用 FireFox 和 IE，但没有运气。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T21:01:32.773

为了跟进 Shmiddty 的评论，我添加了一个 min-height: 1px; 它就像一个魅力。

# c# - 接口有什么方法可以导致不同的行为？

> ID：13731889
> 
> 赞同：1
> 
> 时间：2012-12-05T20:33:01.927
> 
> 标签：c#

假设我有以下代码：

```
class Foo: IFoo {
    public string fooProp { get; set; }
}

interface IFoo {
    string fooProp {get; set; }
} 
```

是否有可能在以下之间存在不同的行为：

```
Foo x = new Foo();
someMethod(x); 
```

和：

```
IFoo x = new Foo();
someMethod(x); 
```

?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T21:20:51.050

我认为可能会有所不同。如果有人使用了糟糕的编程风格，即：

```
public void someMethod(IFoo f)
{
    if (f is Foo)
    {
        Foo f1 = (Foo)f;
        //Do smth with unique Foo members
    }
    //Do anything with IFoo members
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-05T20:38:47.467

是的，如果和`someMethod`具有不同的重载，`IFoo`则会有所不同`Foo`。

```
public void someMethod(Foo f)
{
    // Overload 1
}

public void someMethod(IFoo f)
{
    // Overload 2
}

Foo x = new Foo();
someMethod(x); // Matches overload 1
IFoo x = new Foo();
someMethod(x); // Matches overload 2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T20:36:00.807

（我不是专家）但在您的第一个场景中，您可以访问 Class Foo 中的所有内容。在第二种情况下，您将只能访问 IFoo 成员。因此，如果 Foo 有其他方法（不是接口的一部分），您将能够在第一个场景中访问它们，但不能在第二个场景中访问它们。

我相信使用接口名称而不是类名称只是封装数据的另一种方式，并且只提供对接口成员的访问。例如，你可以有 Foo 和 Bar，它们都实现了 IFoo。你可以将它们都添加到一个列表中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-05T20:47:52.947

如果你有两个接口并且每个接口都有一个通用的方法名，那么实现类可以不同地实现相同的方法。这取决于如何调用方法 - 通过接口与否以及通过哪个接口。

有关类似问题，请参见此处：

[从具有相同方法名称的多个接口继承](https://stackoverflow.com/questions/2371178/inheritance-from-multiple-interface-with-the-same-method-name-in-c-sharp)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-05T20:38:15.023

永远不会有任何区别。

请记住，接口是**合约**。通过派生`Foo`，`IFoo`您正在实施该*合同*。

在这两种情况下，因为`Foo` *是*一个`IFoo`并且遵守**合同**，所以行为总是相同的。

当然，任何人都猜测 Foo 是*如何实现该合同的。*但是接口的签名也遵守了合同。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-05T20:38:18.293

不同的行为*可以*，但在里面`someMethod`。

说你有

```
class Foo: IFoo {
    public fooProp { get; set; }
}

interface IFoo {
    fooProp {get; set; }
    myCustomProp {get;set}
} 
```

如果你有

```
public void someMethod(Foo _foo){
     _foo.myCustomProp; //CAN DO THIS, AS YOUR TYPE IS _FOO_
} 
```

如果定义了方法的参数，则无法做到这一点。

```
public void someMethod(IFoo _foo){
     _foo.myCustomProp; //NO SUCH METHOD INFO
} 
```

除非你不投。所以不同之处在于 decaring IFoo，decalre 通用访问参数，但在数据访问方面获得的“潜力”较少，但在架构中的类型抽象方面具有*巨大*潜力。

因此，差异仅在于*架构*和程序工作流程。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-05T20:55:57.047

你可以在 Foo 中有一个显式实现的接口。

```
class Foo: IFoo {
    private string _fooprop;
    private string _ifooprop;

    public string fooProp       
    {
        get {return "IFoo";}
        set {_fooprop=value;}
    }
    string IFoo.fooProp 
    {
        get {return "Foo";}
        set {_ifooprop=value;}
    }
}

interface IFoo {
    string fooProp {get; set; }
} 
```

有了这个，你将拥有：

```
IFoo foo1=new Foo();
Foo foo2=new Foo();

Console.WriteLine(foo1.fooProp); // Foo
Console.WriteLine(foo2.fooProp); // iFoo 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-05T21:03:18.463

如果您明确实施，则有可能`IFoo`：

```
public class Foo : IFoo
{
    public string Prop
    {
        get { return "Hello Foo"; }
    }

    string IFoo.Prop
    {
        get { return "Hello IFoo"; }
    }
}

public static void SomeMethod<T>(T foo) where T : IFoo
{
    var prop = typeof(T).GetProperty("Prop");
    Console.WriteLine(prop.GetValue(foo));
} 
```

# ios - 如何在while循环中完成顺序步骤？

> ID：13731892
> 
> 赞同：0
> 
> 时间：2012-12-05T20:33:08.243
> 
> 标签：ios, if-statement, while-loop, uideviceorientation

我需要一个一个地完成一系列步骤。总之，我有三个步骤要完成，它们都在一个 while 循环中。一旦完成了三个测试，那么只有在那时，用户才应该退出 while 循环。问题是这些步骤需要按顺序完成，并且要求用户按顺序进行每个测试，如果通过，则继续进行下一步。

以下是相关代码：

```
int passCount = 0;
    BOOL flatPass = FALSE;
    BOOL landscapePass = FALSE;
    BOOL portraitPass = FALSE;

while (passCount < 3) {

        if (flatPass == FALSE) {

            if (device.orientation == UIDeviceOrientationFaceUp || device.orientation == UIDeviceOrientationFaceDown) {

                [self pushSound];

            }

        }

        else if (landscapePass == FALSE) {

            if (device.orientation == UIDeviceOrientationLandscapeLeft || device.orientation == UIDeviceOrientationLandscapeRight) {

                [self pushSound];

            }

        }

        else if (portraitPass == FALSE) {

            if (device.orientation == UIDeviceOrientationPortrait || device.orientation == UIDeviceOrientationPortraitUpsideDown) {

                [self pushSound];

            }

        }

    } 
```

我需要用户将 iOS 设备定位在每个位置，并播放哔声表示测试成功。一旦按顺序完成所有三个测试，我希望用户退出循环。我认为每次清除测试时，我都会将 passCount 计数器增加 1，直到达到 3，这将使我退出循环。不过，我的问题是如何按顺序进行每个测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:36:26.143

假设这没有在主 UI 线程上运行，删除`while`循环，用条件替换每个和，`if`当测试通过时将适当的布尔标志设置为 true，然后你就完成了。`else if``while`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:47:42.690

你可以在

> deviceDidRotate()

您需要一个对象变量来保存当前进度，或者像您所做的那样使用枚举：

```
int step; 
```

然后在 deviceDidRotate 你检查：

```
 if (step == 0 && device.orientation == UIDeviceOrientationFaceUp ) {
     step = 1;
   } else if (step == 1 && device.orientation == UIDeviceOrientationLandscapeLeft) {
     step = 2;
   } else if (step == 2 && device.orientation == UIDeviceOrientationPortrait ) {
     // successful!
     // now do action, reset step? call method 
   } 
```

# javascript - 告诉视频从一秒而不是零开始的 JavaScript

> ID：13731893
> 
> 赞同：0
> 
> 时间：2012-12-05T20:33:14.470
> 
> 标签：javascript, jquery, css

我有一个使用 iframe 的 HTML 页面上的视频，我正在寻找 JavaScript 或 jQuery 来从 2\. 秒而不是零开始视频。因为在单击播放之前，视频预览在屏幕上看起来是黑色的，而不是在预览中看到人。

这是一个 HTML 脚本：

```
<iframe width="111" height="63" src="video/videoclip.m4v" frameborder="0"></iframe> 
```

这是使用 html、css 和 JS 的 iphone 应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T21:20:11.160

您可以使用[HTML5 视频](http://www.html5rocks.com/en/tutorials/video/basics/)标签和 JavaScript

```
<video id="videoClip" width="111" height="63" controls="controls" autoplay="autoplay">
  <source src="video/videoclip.m4v" type="video/m4v">
</video> 
```

此 JavaScript 将等到视频加载完毕，然后在 2 秒后开始。

```
document.getElementById('videoClip').addEventListener('loadedmetadata', function() {
  this.currentTime = 2;
}, false); 
```

可以使用 CSS 设置视频标签的样式，使其看起来像您的 iframe 解决方案。

# javascript - JQuery 鼠标悬停事件的兼容性问题

> ID：13731895
> 
> 赞同：0
> 
> 时间：2012-12-05T20:33:23.050
> 
> 标签：javascript, jquery, html, css, drop-down-menu

我试图想出一种方法来制作一个下拉框，该下拉框通过 jquery 鼠标悬停事件显示，嵌套下拉框通过悬停在原始下拉框的元素上显示。我写了一些非常低效的代码，我正在努力寻找简化它的方法，以便我知道为什么它不能在 IE 和 Firefox 中工作。如果有人有任何建议可以帮助我更好地了解这些兼容性问题的情况，请提供帮助。

链接在这里：

[http://jsfiddle.net/xZNU2/](http://jsfiddle.net/xZNU2/)

[http://cs-dev.dreamhosters.com/dropd.php](http://cs-dev.dreamhosters.com/dropd.php)

```
$(document).ready(function(){
$(".tab, .drop").hover(function(){
$(".tab").css("color","#FF7722");
$(".drop").css("display","block");
$("#tv, .droptv").hover(function(){
        $(this).css("color","#FF7722");
        $(".droptv").css("display","block");
        $(".droptv").hover(function(){
                $("#tv, .droptv").css("color","#FF7722");
                },function(){
                $(".droptv").css("color","#005BAB");
                });
        },function(){
        $(this).css("color","#005BAB");
        $(".droptv").css("display","none");
        });
$("#interact").hover(function(){
        $(this).css("color","#FF7722");
        },function(){
        $(this).css("color","#005BAB");
        });
$("#online").hover(function(){
        $(this).css("color","#FF7722");
        },function(){
        $(this).css("color","#005BAB");
        });
$("#vod, .dropvod").hover(function(){
        $(this).css("color","#FF7722");
        $(".dropvod").css("display","block");
        $(".dropvod").hover(function(){
                $("#dai").hover(function(){
                    $(this).css("color","#FF7722");
                    },function(){
                    $(this).css("color","#005BAB");
                    });
                $("#iguide").hover(function(){
                    $(this).css("color","#FF7722");
                    },function(){
                    $(this).css("color","#005BAB");
                    });
                $("#vod").css("color","#FF7722");
                },function(){
                $(".dropvod").css("color","#005BAB");
                });
        },function(){
        $(this).css("color","#005BAB");
        $(".dropvod").css("display","none");
        });
$("#tablet").hover(function(){
        $(this).css("color","#FF7722");
        },function(){
        $(this).css("color","#005BAB");
        });
$("#mobile").hover(function(){
        $(this).css("color","#FF7722");
        },function(){
        $(this).css("color","#005BAB");
        });
},function(){
$(".tab").css("color","#005BAB");
$(".drop").css("display","none");
 });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T21:26:23.647

您的第一个问题是您将事件附加到事件上，例如：

```
$(".dropvod").hover(function(){
    $("#dai").hover(function(){
        ... 
```

将事件附加到 DOM 元素非常慢，更不用说`$("#dai)`每次鼠标进入`.dropvod`元素时都会重新附加事件。

我的建议是获取要与之交互的元素的句柄，并使用委托事件来更新元素，例如：

```
/* It would be better to create an association between the elements
 * For example data-index="1" would relate to the hover to the element to show
 */
$('.drop').on('mouseenter', '.dropl', function (e) {
    var id = $(this).attr('id');
    $('.drop' + id).show();

}).on('mouseleave', '.dropl', function (e) {
    var id = $(this).attr('id');
    $('.drop' + id).hide();

}).on('mouseenter', '.hoverable', function () {
    $(this).css("color","#FF7722");

}).on('mouseleave', '.hoverable', function () {
    $(this).css("color","#005BAB");
}); 
```

关于跨浏览器，您的代码似乎可以在 FF 中运行，我认为 IE 只是在自欺欺人:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T21:06:08.703

您应该使用`<ul> <li>`or`<dl> <dt> <dd>`而不仅仅是 div。但是，如果您想保持原样，您可以通过查找某些部分的所有子元素来使其更具动态性：（不是实际代码）

```
$('dropl').hover(
    function(){$(this).find)('.otherclass').slideDown(300);},
    function(){$(this).find)('.otherclass').slideUp(300);}
); 
```

此外，如果您只使用 css 来更改悬停时的颜色，则效率会更高，如下所示：

```
.dropl {
    color: #005BAB;
}

.dropl:hover {
    color: #FF7722;
} 
```

你明白吗？您不需要编写所有代码，只需为您想要的东西使用不同的类，jQuery 可以处理该类中的所有内容。

# jquery - codeigniter jquery表单提交

> ID：13731897
> 
> 赞同：1
> 
> 时间：2012-12-05T20:33:25.813
> 
> 标签：jquery, codeigniter

大家好，我的表单似乎在提交和 jquery 中正常工作，尽管有两件事：它似乎没有通过信息，因为它不断添加 0、0、0、0，而不是我在表单中提交的内容。接下来它不会刷新页面吗？可能缺少一些jquery？

在模型中插入函数：

```
 function entry_insert(){
    $this->load->helper('form'); 
    $this->load->helper('html'); 
    $this->load->database();
    $data = array(
              'title'=>$this->input->post('title'),
              'url'=>$this->input->post('url'),
          'jscore'=>$this->input->post('jscore'),
          'kscore'=>$this->input->post('kscore')
            );
    $this->db->insert('movies',$data);
  } 
```

这是加载模型的 jquery 调用的控制器函数：

```
 public function addmovie()
{
        $this->load->model('Movie_model', '', TRUE);
        $this->Movie_model->entry_insert();
        return true;

} 
```

视图内的html表单：

```
<form class="form-signin" method="post" id="form-signin">
    <h4 class="form-signin-heading">Add a Movie</h4>
    <input type="text" class="input-block-level" placeholder="Movie Title" id="title">
    <input type="text" class="input-block-level" placeholder="URL" id="url">
    <input type="number" class="" min="1" max="100" placeholder="Jamies Score" id="jscore">
    <input type="number" class="" min="1" max="100" placeholder="Kellys Score" id="kscore">
    <button class="btn btn-large btn-primary" type="submit">Add</button>
  </form> 
```

最后是jQuery：

```
<script>
$(function(){
   $("#form-signin").submit(function(){
     dataString = $("#form-signin").serialize();

     $.ajax({
       type: "POST",
       url: "http://xxx.com/xx/index.php/welcome/addmovie",
       data: dataString,

       success: function(data){
           alert('Successful!');
       }

     });

     return false;  //stop the actual form post !important!

  });
});
</script> 
```

谁能发现我做错了什么？也许可以帮助我的 jquery 刷新？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:51:45.290

您的所有输入都没有`name`属性，这是读取服务器端值所必需的，并且您的`serialize()`调用也可能没有返回任何内容。我猜你以为那`id`是为了，但事实并非如此。

例子：

```
<input placeholder="Kellys Score" id="kscore"> 
```

应该：

```
<input placeholder="Kellys Score" name="kscore" id="kscore">
<!--                   Needs this ^^^^^^^^^^^^^          --> 
```

# php - 在 MySQL 中存储错误日志

> ID：13731898
> 
> 赞同：1
> 
> 时间：2012-12-05T20:33:32.333
> 
> 标签：php, mysql, logging

我想将我的 PHP 创建的错误日志存储到 MySQL 表中，但没有插入任何内容。

我用于错误日志的代码是..

```
function myHandler($code, $msg, $file, $line) 
   {
      echo "An error occurred while processing your request. Please visit our site and try again.";  
      // log error to file, with context
      $logData = date("d-M-Y h:i:s", mktime()) . ", $code, $msg, $line, $file\n";
      die("Error");
   } 
```

用线条

```
$insert = "INSERT INTO error_logs (error_message)"."VALUES ('$logData')";   
mysql_query($insert)or die(); 
```

将日志插入到 error_logs 表中的 error_message 列中，该表设置为 VARCHAR，最大字符数为 250

我以为它只是在那里设置了一个东西，但显然我离题了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:38:01.300

您插入语句可以解析为：

> 插入错误日志 (error_message) 值 ('foo')

这是**无效**的。

确保把那个空间放在那里。

您可能希望将 MySQL 错误语句放入 中，`die(..)`以便下次更好地查看错误。

另外 – 请*在将您的数据输入语句之前**先***转义它……您现在这样做的方式可能会导致一些大的[Bobby Tables](http://bobby-tables.com/)问题……

> [**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护，并且已经开始[弃用过程。](http://news.php.net/php.internals/53799)看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

# javascript - 如何通过它的索引分配一个Javascript数组

> ID：13731899
> 
> 赞同：0
> 
> 时间：2012-12-05T20:33:32.643
> 
> 标签：javascript, arrays, initialization

> **可能重复：**
> [在 javascript 关联数组中动态创建键](https://stackoverflow.com/questions/351495/dynamically-creating-keys-in-javascript-associative-array)

通常我们像这样初始化一个数组：

var ar = ['你好'，'世界'];

为了访问它的值，我们这样做：

警报（ar[0]）；// 你好

但我想要一个自定义索引来分配，例如：

var ar = ['first' => 'Hello', 'second' => 'World'];

接着

警报（ar['first']）；

但我找不到怎么做，我可以为分配做这样的事情吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:35:30.390

您可以使用[Object](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object)而不是 Array，您可以为对象指定命名属性

```
var ar = {
  first: 'hello',
  second: 'world'
};
alert(ar['first']); 
```

您也可以将带有字符串键的属性分配给您的数组，这也可以：

```
var ar = [];
ar['first'] = 'first';
alert(ar['first']); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T20:35:52.560

你需要使用一个对象。

```
var obj = {'first': 'hello', 'second': 'world'};

alert(obj.first); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T20:36:01.243

JavaScript 中的对象只是属性包（哈希表）。

你可以：

```
var ar = {};
ar["name"] = "Dave";
ar["salary"] = "Millions";

alert(ar.name);  //Dave
alert(ar["salary"]);  //millions 
```

JavaScript 允许您非常灵活地创建这些对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-05T20:36:08.387

JavaScript 本身没有关联数组，但有对象字面量：

```
var obj = {foo:'bar'};
obj.something = 'else';
//or:
obj['foo'] = 'BAR'; 
```

如果您在数组上创建命名索引（因为 Array 对象可追溯到 Object 原型），JS 不会大惊小怪，但您将失去所有`Array`功能的使用（例如`sort`，方法或魔法`length`属性，仅举几例） )

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-05T20:35:01.057

你可以这样做：

```
var ar = {
   'first' :'Hello', 
   'second' : 'World'
 }; 
```

如您所见，这是您在 Javascript 中初始化对象的方式。Javascript 模糊了关联数组和对象之间的界限。

然后，您可以通过以下方式访问它：

```
ar['first'] 
```

甚至：

```
ar.first 
```

此外，您可以省略键初始化中的引号，如下所示：

```
var ar = {
   first :'Hello', 
   second : 'World'
 }; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-05T20:36:22.577

只需使用

```
 var h = new Object(); // or just {}
h['one'] = 1;
h['two'] = 2;
h['three'] = 3;

// show the values stored
for (var k in h) {
    // use hasOwnProperty to filter out keys from the Object.prototype
    if (h.hasOwnProperty(k)) {
        alert('key is: ' + k + ', value is: ' + h[k]);
    }
} 
```

# api - 无法从雅虎检索所有联系人

> ID：13731902
> 
> 赞同：0
> 
> 时间：2012-12-05T20:33:55.333
> 
> 标签：api, contacts, yahoo

我按照[本](http://developer.yahoo.com/yap/guide/other-code-exs.html#my_social)教程从雅虎检索联系人。它工作正常，但问题是它不检索我已导入雅虎的联系人，只是我手动添加的联系人。有谁知道您是否可以以某种方式导入导入的联系人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T14:33:34.900

打印它，复制粘贴到excel中，用“包含@”过滤并将电子邮件放入一列，与“不包含@”和另一列相同。然后在数据选项卡中对列执行文本并将名字/姓氏分成两列。现在将其粘贴为正确的格式以导入 gmail。

关键是导入的联系人仍然显示在打印中。

# r - 为什么我的分隔符在 read.table 中停止工作

> ID：13731905
> 
> 赞同：0
> 
> 时间：2012-12-05T20:33:59.603
> 
> 标签：r, parsing

我有一个文本文件（myFile.txt），我试图将其转换为 data.frame

这是一个摘录

```
 <li>

                    <a title="Data table: Grand Falls-Windsor (Census Agglomeration), Newfoundland and Labrador" href="../../details/page.cfm?Lang=E&amp;Geo1=CMA&amp;Code1=010&amp;Geo2=PR&amp;Code2=01&amp;Data=Count&amp;SearchText=Grand%20Falls-Windsor&amp;SearchType=Begins&amp;SearchPR=01&amp;B1=All&amp;GeoLevel=PR&amp;GeoCode=010&amp;TABID=1">Grand Falls-Windsor&nbsp;(<acronym title="Census Agglomeration">CA</acronym>)</a> [<a href="../../details/page_Map_Carte_Detail.cfm?Lang=E&amp;G=1&amp;Geo1=CMA&amp;Code1=010&amp;Geo2=PR&amp;Code2=01&amp;Data=Count&amp;SearchText=&amp;SearchType=Begins&amp;SearchPR=01&amp;B1=All&amp;Custom=&amp;TABID=1&amp;geocode=010" title="Map: Grand Falls-Windsor (Census Agglomeration), Newfoundland and Labrador">map</a>]

         </li>

<li>

                    <a title="Data table: St. John's (Census Metropolitan Area), Newfoundland and Labrador" href="../../details/page.cfm?Lang=E&amp;Geo1=CMA&amp;Code1=001&amp;Geo2=PR&amp;Code2=01&amp;Data=Count&amp;SearchText=St.%20John's&amp;SearchType=Begins&amp;SearchPR=01&amp;B1=All&amp;GeoLevel=PR&amp;GeoCode=001&amp;TABID=1">St. John's&nbsp;(<acronym title="Census Metropolitan Area">CMA</acronym>)</a> [<a href="../../details/page_Map_Carte_Detail.cfm?Lang=E&amp;G=1&amp;Geo1=CMA&amp;Code1=001&amp;Geo2=PR&amp;Code2=01&amp;Data=Count&amp;SearchText=&amp;SearchType=Begins&amp;SearchPR=01&amp;B1=All&amp;Custom=&amp;TABID=1&amp;geocode=001" title="Map: St. John's (Census Metropolitan Area), Newfoundland and Labrador">map</a>]

         </li>

df <- read.table("myFile.txt",sep="\n") 
```

这一直有效到大瀑布提取物结束，但`\n`似乎没有生效。这是一行控制台读数，您可以看到`\n`末尾有 s 没有生效。

```
\t\t\t\t\t\t<a title=Data table: St. John's (Census Metropolitan Area), Newfoundland and Labrador href=../../details/page.cfm?Lang=E&amp;Geo1=CMA&amp;Code1=001&amp;Geo2=PR&amp;Code2=01&amp;Data=Count&amp;SearchText=St.%20John's&amp;SearchType=Begins&amp;SearchPR=01&amp;B1=All&amp;GeoLevel=PR&amp;GeoCode=001&amp;TABID=1>St. Johns&nbsp;(<acronym title="Census Metropolitan Area">CMA</acronym>)</a> [<a href="../../details/page_Map_Carte_Detail.cfm?Lang=E&amp;G=1&amp;Geo1=CMA&amp;Code1=001&amp;Geo2=PR&amp;Code2=01&amp;Data=Count&amp;SearchText=&amp;SearchType=Begins&amp;SearchPR=01&amp;B1=All&amp;Custom=&amp;TABID=1&amp;geocode=001" title="Map: St. Johns (Census Metropolitan Area), Newfoundland and Labrador>map</a>]\n\t\t\t\t\t\n             </li>\n\t\t\t \n 
```

对此演示文稿表示歉意，但我在尝试从控制台复制时遇到了很多 Rstudio 崩溃的问题

有人可以在这里帮忙。也许`read.table()`无论如何都是不正确的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:37:47.023

看起来你可能有一个未封闭的开放式报价`"`

也许它只存在于您在此处复制和粘贴的内容中，还是存在于数据本身中？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T22:03:35.693

您可以使用以下任何一种：

```
read.table("test.txt", sep="\n", quote="")
readLines(con=file("test.txt")) 
```

你有一个不匹配的单引号问题。

# javascript - 如何检测在文本区域中输入的文本是 RTL

> ID：13731909
> 
> 赞同：16
> 
> 时间：2012-12-05T20:34:06.193
> 
> 标签：javascript, jquery, html, css, right-to-left

我有一个文本区域，用户可以在其中输入英文（或任何其他从左到右的语言）或 RTL 语言的文本。

当用户在 RTL 中书写时，用户必须按 Right-shift + ctrl 才能使文本向右对齐并成为 rtl。但是，在 Windows（可能还有其他现代操作系统）中，用户可以设置任何组合键来切换语言和文本方向。

我知道如何将文本显示为 RTL，但我如何知道显示的方向？

有没有办法检测在 textarea/text-field 中输入的文本是否被输入为 RTL？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-11-20T14:11:47.233

我想出了一个更简单和更好的解决方案。只需添加`dir="auto"`元素，浏览器就会完成它的工作！

见：[http ://www.w3schools.com/tags/att_global_dir.asp](http://www.w3schools.com/tags/att_global_dir.asp)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-08-03T10:18:09.973

尝试这个：

```
var rtl_rx = /[\u0591-\u07FF]/;
$('textarea').on('keyup',function(){
    this.style.direction = rtl_rx.test(this.value) ? 'rtl' : 'ltr';
}); 
```

我使用简化的 RegExp 来检测 RTL

```
/[\u0591-\u07FF]/ 
```

虽然它不会捕获 Unicode 表中的每一个 RTL 字符，但它可能涵盖了所有现实生活中的情况。它包括所有正常的希伯来语和阿拉伯语字符，包括元音字符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-13T22:29:53.993

您可以使用正则表达式快速编写一小段 JavaScript/jQuery 代码。正则表达式在 JavaScript 中是有限的，所以你需要使用完全支持 Unicode的[XRegExp库——如果你添加](http://xregexp.com/)[插件的](http://xregexp.com/plugins/)话。**然后，您可以使用\p{Hebrew}**之类的表达式检查字符以查看它们属于哪个 Unicode 块。[http://www.regular-expressions.info/unicode.html](http://www.regular-expressions.info/unicode.html)

面对同样的困境，我为自己编写了一个函数，该函数循环遍历每个字符串中的字符并计算希伯来字符的出现次数（我的网站是意第绪语/英语双语）。然后字符串得到一个分数，并将一个'rtl'类应用于具有高分的元素。您可以轻松地将 Unicode 中的所有 RTL 语言添加到 for 循环中，以使其更通用。

[http://jsfiddle.net/Swyu4/9/](http://jsfiddle.net/Swyu4/9/)

请注意外部资源链接到 jsfiddle 中的 XRegExp 库。

```
$('p').each(function() {
    if(isRTL($(this).text()))
        $(this).addClass('rtl');
});

function isRTL(str) {
    var isHebrew = XRegExp('[\\p{Hebrew}]');
    var isLatin = XRegExp('[\\p{Latin}]');
    var partLatin = 0;
    var partHebrew = 0;
    var rtlIndex = 0;
    var isRTL = false;

    for(i=0;i<str.length;i++){
        if(isLatin.test(str[i]))
            partLatin++;
        if(isHebrew.test(str[i]))
            partHebrew++;
    }
    rtlIndex = partHebrew/(partLatin + partHebrew);
    if(rtlIndex > .5) {
        isRTL = true;
    }
/*
console.log('Latin score: ' + partLatin);
console.log('Hebrew score: ' + partHebrew);
console.log('trlIndex score: ' + rtlIndex);
console.log('isRTL: ' + isRTL);
*/

    return isRTL;
} 
```

# neo4j - 在 Neo4j 中，如何在 Cypher 查询语言中使用类似 SQL 的 GROUP BY？

> ID：13731911
> 
> 赞同：1
> 
> 时间：2012-12-05T20:34:09.573
> 
> 标签：neo4j, cypher

我想找出公司中所有用户的数量以及男性和女性的数量。我的查询是：

```
 start n=node:company(name:"comp")
 match n<-[:Members_In]-x, n<-[:Members_In]-y  
 where x.Sex='Male' and y.Sex='Female' 
 return n.name as companyName, count(distinct x) as NumOfMale,
 count(distinct y) as NumOfFemale" ); 
```

我的查询是正确的，但我知道我不应该`n<-[:Members_In]-y`在 match 子句中使用。

如何获取男性人数、女性人数和总用户数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T11:22:14.893

Peter 在这里创建了一个叉积：

我认为这更适合您的用例

```
start n=node:node_auto_index(name='comp')
match n<-[:Members_In]-x
with  n.name as companyName, collect(x) as employees
return length(filter(x in employees : x.Sex='Male')) as NumOfMale,
length(filter(x in employees : x.Sex='Female')) as NumOfFemale,
length(employees) as Total 
```

见[http://console.neo4j.org/r/msamaa](http://console.neo4j.org/r/msamaa)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T09:52:42.080

尝试

```
start n=node:node_auto_index(name='comp')
match n<-[:Members_In]-x, n<-[:Members_In]-y  
where x.Sex='Male' and y.Sex='Female' 
with 
n.name as companyName, 
count(distinct x) as NumOfMale,
count(distinct y) as NumOfFemale
return NumOfMale, NumOfFemale, NumOfMale + NumOfFemale as Total 
```

有关示例，请参见[http://tinyurl.com/cjpxrax 。](http://tinyurl.com/cjpxrax)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-20T11:18:23.470

实际上有一种更简单的方法可以实现该结果

```
START n=node:node_auto_index(name='comp') 
MATCH n<-[:Members_In]-x 
RETURN count(x.name), x.Sex 
```

看看[http://architects.dzone.com/articles/neo4jcypher-sql-style-group](http://architects.dzone.com/articles/neo4jcypher-sql-style-group) 应该很有帮助，认为我的回答有点晚了......

# wordpress - 如何让子类别以树的方式在 wordpress 的侧栏上显示其父类别的“下方”？

> ID：13731916
> 
> 赞同：1
> 
> 时间：2012-12-05T20:34:27.140
> 
> 标签：wordpress, categories

我想知道如何让子类别在 wordpress 的侧栏上显示“在”其父类别下？理想情况下，这将是一种类似树的时尚。

我很惊讶这不是标准的。html 标记似乎甚至没有任何可用的 css 类，我可以设置样式来区分类别的级别。这就是我所拥有的：

```
<h3 class="widget-title">Categories</h3>        
<ul>
    <li class="cat-item cat-item-3"><a href="http://localhost/sites/wordpress/?cat=3" title="View all posts filed under test parent">test parent</a> </li>
    <li class="cat-item cat-item-4"><a href="http://localhost/sites/wordpress/?cat=4" title="View all posts filed under test sub 1">test sub 1</a> </li>
    <li class="cat-item cat-item-1"><a href="http://localhost/sites/wordpress/?cat=1" title="View all posts filed under Uncategorized">Uncategorized</a> </li>
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:47:45.810

您需要在类别小部件的选项中选中“显示层次结构”。

# c# - 构建通用应用程序 - 允许客户特定的选项

> ID：13731918
> 
> 赞同：4
> 
> 时间：2012-12-05T20:34:32.553
> 
> 标签：c#, oop, design-patterns, architecture

我已经构建了一个开源应用程序，我很想知道其他人如何处理客户特定的请求。让应用程序保持简单对我来说很重要；我并不是想为所有人创造一切。以这种方式，应用程序可能会变得臃肿、复杂并且几乎无法使用。但是，有一些特定于客户的选项会很好（它只是不适用于所有客户）。例如...

假设我们有一个名为 Server 的域实体。在 UI 中，我们让客户从服务器列表中进行选择。对于一家公司，按位置（美国、德国、法国等）过滤服务器会很有帮助。添加这样的服务器属性很容易：

```
public class Server
{
    public Location Location { get; set; }
    // other properties here
} 
```

我担心的是，随着时间的推移，服务器可能会因属性而变得臃肿。即使我只添加位置，也不是所有客户都会关心该属性。

一种选择是允许用户定义的字段：

```
public class Server
{
    public string UserField1 { get; set; }
    public string UserField2 { get; set; }
    public string UserField3 { get; set; }
    // etc...
    // other properties here
} 
```

这是处理这个问题的最好方法吗？我不喜欢通过将所有内容都设为字符串来消除类型安全性的事实。人们是否有其他/更好的方式来处理此类问题？甚至有这样的设计模式吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:45:01.060

在我看来，一个好的设计模式是在数据库级别使用模式，然后在类级别使用基本继承。

```
CREATE TABLE dbo.A (
    ColumnA INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    ColumnB VARCHAR(50),
    ColumnC INT,
    etc.
) 
```

现在我们有一个需要一些特定功能的客户端，所以让我们在不同的模式中创建这个表的扩展：

```
CREATE TABLE CustomerA.A (
    ColumnA INT NOT NULL PRIMARY KEY,
    Location VARCHAR(50)
) 
```

但是现在我们有另一个客户需要以不同的方式扩展它：

```
CREATE TABLE CustomerB.B (
    ColumnA INT NOT NULL PRIMARY KEY,
    DataCenterID INT
) 
```

尽管这些字段可能不相关，但您明白了，所以现在我们需要在这里构建客户特定的域模型：

```
public abstract class A
{
    public int ColumnA { get; set; }
    public string ColumnB { get; set; }
    public int ColumnC { get; set; }
}

public class CustomerA_A : A
{
    public string Location { get; set; }
}

public class CustomerB_A : A
{
    public int DataCenterID { get; set; }
} 
```

因此，现在当我们需要为客户 A 构建某些东西时，我们将构建他们的子类，并为客户 B 构建他们的子类，依此类推。

现在，仅供参考，这是一个非常动态的系统的开始。我之所以这么说，是因为缺少的那部分还不是动态的，是用户界面。有很多方法可以完成，但超出了这个问题的范围。这是你必须考虑的事情。我这么说是因为你管理接口的方式将决定你如何知道构建哪个子类。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T20:45:41.120

早期的常用方法是使用配置 XML 文件来处理这类事情。但是针对特定客户的需求进行编程需要围绕您的编程方式进行全面思考。请参阅[this answer](https://stackoverflow.com/a/4928527/120955)到类似的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T20:51:37.913

当然，这始终取决于您要允许多少自定义。在我们的产品中，我们甚至使用户能够完全定义他们自己的实体以及它们之间的属性和关系。基本上，我们称之为实体的每个 EntityObject 最终都包含一个值集合和对描述其中值的元模型的引用。我们设计了自己的查询语言，允许我们查询数据库并使用可翻译成任何目标语言的表达式（尽管我们目前只使用 SQL 和 .net）。

游戏并没有就此结束，您很快就会发现验证规则、权限、默认值等成为必须具备的。当然，所有这些都需要 UI 支持，至少对于元模型的执行而言。

因此，这实际上取决于最终用户应该能够执行的调整量。我猜在大多数情况下，如您所描述的，简单的用户字段就足够了。在这种情况下，我将提供一个字段并在其中存储 JSON 文本。然后，在 UI 中，您可以提供至少一个允许结构和可扩展性的半体面的 UI。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-05T20:55:37.067

**选项1：**说“不”。:-)

虽然我这么说（一半）是开玩笑的，但这是有道理的。开发人员经常通过允许一两个自定义功能来让自己接受无休止的自定义，从而使雪球滚滚而来。

当然，这必须是平衡的，听起来你可能在某种程度上这样做了。但是如果你真的想让你的应用程序简单，那就保持简单，避免添加这样的自定义。

**选项2：**继承。

如果您真的需要添加自定义，我会倾向于构建具有所有“标准”选项的基类，然后构建包含客户特定优化的客户特定类。

例如：

```
public class Server
{
    // all standard properties here
} 
```

那么对于 Joe's Pizza，您可以拥有：

```
public class JoesPizzaServer : Server
{
    public Location Location { get; set; }
} 
```

这样做的附带好处是，它将允许您基于特定于客户端（或基本）模型的演示视图。

例如，在 MVC 中，您可以像这样设置视图模型，然后您可以为每个客户提供特定的视图。

例如，Bob's Burgers 对基本模型有自己的看法：

```
@model MyApp.Server
@* implement the base form *@ 
```

Joe's Pizza 的视图将使用自定义模型：

```
@model MyApp.JoesPizza
@* implement the base form -- a partial view -- with addtional custom fields 
```

MVC 在支持这种模式方面做得非常好。如果您不使用 MVC（可能是 WPF 或 Web 窗体），仍然有一些方法可以利用部分“视图”文件来完成类似的事情。

当然，您的数据库可以（并且可能应该）支持类似的继承模型。Entity Framework 甚至支持像这样的各种继承模型。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-05T20:56:26.537

我在这里可能错了，但看起来您想使用相同的代码库处理不同版本的软件。我可以想到两种方法：

1.  实际上为它定义不同的版本并为每个客户端处理更改。从域建模的角度来看，这不会给您带来问题，但需要一个支持基础架构，该基础架构必须根据您的客户要求进行扩展。有一些相关的问题（例如[this](https://stackoverflow.com/questions/4200324/what-is-the-best-way-to-handle-release-management-for-software-with-multiple-ver)、[this](https://stackoverflow.com/questions/3194452/how-do-you-manage-multiple-versions-of-the-same-software-for-each-customer)和[this](https://softwareengineering.stackexchange.com/questions/60393/how-to-maintain-different-customized-versions-of-the-same-software-for-multiple)）。
2.  在域模型级别处理它，作为用户定义的配置。这种方法的优点是您不必合并软件的多个版本，但这是以使您的模型更通用且可能更复杂为代价的。此外，您的测试肯定必须适应处理不同的场景。如果您朝着那个方向前进，我将建模一个表示属性的对象（带有名称和值）并将`Server`类视为具有属性的集合。这样，您的模型仍然以 OO 风格捕获您的需求。

高温高压

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-05T21:50:52.717

我从 Python 接近，我认为会很好听的是字典。键是您的字段名称，值是 errrrr... 值；）

在数据库中表示也很简单。

# javascript - 脚本错误：在子元素关闭之前无法修改父容器元素

> ID：13731921
> 
> 赞同：6
> 
> 时间：2012-12-05T20:34:47.763
> 
> 标签：javascript, jquery, yui, yahoo-api

脚本错误：在关闭子元素之前无法修改父容器元素。我应该怎么办？我单击是，但我的网页未显示。

在我的产品页面代码的开头，我有： http: [//pastebin.com/iiUfMq1v](http://pastebin.com/iiUfMq1v)

除了 IE8 之外，所有浏览器都可以正常工作，这是唯一一个抛出任何类型错误的浏览器。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-24T09:08:24.943

请检查这些链接

[http://answers.microsoft.com/en-us/ie/forum/ie8-windows_other/html-parsing-error-unable-to-modify-the-parent/e64759e0-d344-42d6-b1d8-0ce27504dd71](http://answers.microsoft.com/en-us/ie/forum/ie8-windows_other/html-parsing-error-unable-to-modify-the-parent/e64759e0-d344-42d6-b1d8-0ce27504dd71)

[http://afewguyscoding.com/2010/03/message-html-parsing-error-unable-to-modify-the-parent-container-element-before-the-child-element-is-closed-kb927917/](http://afewguyscoding.com/2010/03/message-html-parsing-error-unable-to-modify-the-parent-container-element-before-the-child-element-is-closed-kb927917/)

基本上，当您尝试通过作为当前元素的父级的 javascript 更新元素或该元素根本不呈现时，就会发生这种情况。我遇到了这个问题，并通过在页面加载后运行脚本来修复。即在里面`$(document).ready()`

希望这可以帮助某人..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T21:20:54.153

IE 历来不允许在 domReady 事件之后修改 DOM。

# java - Eclipse 中的度量 Zip 文件未正确导入

> ID：13731928
> 
> 赞同：1
> 
> 时间：2012-12-05T20:35:13.393
> 
> 标签：java, eclipse, metrics

我打算使用 Java Metrics 库进行性能测试。[我从https://github.com/codahale/metrics/downloads](https://github.com/codahale/metrics/downloads)下载了包作为 Ubuntu 中的 zip 文件。我通过选择添加外部 jar 将它放在 eclipse 中的 java 构建路径中。当我在我的代码中编写 import com.yammer.metrics.core 时，我似乎无法访问核心包中的任何类，我应该将下载的文件转换为 jar 文件还是有其他解决方法? 任何帮助将非常感激。

# android - 使用输入法服务的子类

> ID：13731941
> 
> 赞同：1
> 
> 时间：2012-12-05T20:35:47.957
> 
> 标签：android

我扩展了 InputMethodService，希望使用此服务来显示软键盘，即使连接了硬键盘（基于以下帖子[显示软键盘，即使连接了硬件键盘](https://stackoverflow.com/questions/11602209/show-soft-keyboard-even-though-a-hardware-keyboard-is-connected)）。有没有办法在应用程序中绑定到此服务而无需在清单中声明它？最终结果是让 InputMethodService.onEvaluateInputViewShown 返回 true，这样即使连接了硬键盘，软键盘也会显示。

我想将扩展类 MultiInputMethodService 与 show/hideSoftKeyboard 中的 inputmethodmanager 一起使用：

```
public class MultiInputMethodService extends InputMethodService {

        @Override
        public boolean onEvaluateInputViewShown () {
            Log.i("onEvaluateInputViewShow","onEvaluateInputViewShown");
             return true;
        }   
} 
```

我的活动：

```
 private void showSoftKeyboard() {
        InputMethodManager imm = (InputMethodManager) this.getSystemService(Context.INPUT_METHOD_SERVICE);
        imm.toggleSoftInput(InputMethodManager.SHOW_FORCED,InputMethodManager.HIDE_IMPLICIT_ONLY );
    }

    private void hideSoftKeyboard() {
        InputMethodManager imm = (InputMethodManager) this.getSystemService(Context.INPUT_METHOD_SERVICE);
        imm.hideSoftInputFromWindow(this.myInput.getEditText().getWindowToken(), 0);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T21:10:37.083

IMS 框架确实需要作为一个整体来使用。如果你想成为键盘，用户需要通过设置选择你作为默认键盘。如果您尝试直接与服务绑定，我不确定结果会是什么，但我的猜测是它的结局很糟糕。通过让用户将您设置为默认键盘，您将自动用作所有应用程序的键盘。

当然，出于安全目的，您不能只自己设置。否则键盘会为设置而战。用户必须手动设置。

编辑：我找到了您所指的文档（在“安全部分”下）：

[http://developer.android.com/reference/android/view/inputmethod/InputMethodManager.html](http://developer.android.com/reference/android/view/inputmethod/InputMethodManager.html)

> 客户端应用程序可以要求系统让用户选择一个新的 IME，但不能以编程方式切换到它自己。这避免了恶意应用程序将用户切换到他们自己的 IME，当用户导航到另一个应用程序时，它仍然在运行。另一方面，允许 IME 以编程方式将系统切换到另一个 IME，因为它已经完全控制了用户输入。
> 
> 用户必须先在设置中显式启用新的 IME，然后才能切换到它，以向系统确认他们知道它并希望它可以使用。

# sql - 一起使用校验和和异或

> ID：13731942
> 
> 赞同：0
> 
> 时间：2012-12-05T20:35:50.307
> 
> 标签：sql, sql-server-2005

请看下面的SQL：

```
 create table ChecksumTest (id int not null identity, string1 varchar(10), 
string2 varchar(10), string3 varchar(10), string4 varchar(10), checksumvalue int)

insert into ChecksumTest (string1,string2,string3,string4) values ('Ian', 'Marie', 'Sharon', 'Mark')
insert into ChecksumTest (string1,string2,string3,string4) values ('Steven', 'Robert', 'Amy', 'Andy')
insert into ChecksumTest (string1,string2,string3,string4) values ('Sharon', 'Mark','Ian','Marie')

select distinct checksum1 ^ checksum2 As xor from (
select CHECKSUM(string1,string2) as checksum1, CHECKSUM(string3,string4) as checksum2
from ChecksumTest) As Checksums 
```

select 语句返回两个不同的 XOR 值，因为表中的第一行和第三行包含相同的值。这是我所期望的。

我已经在大约一百万行中运行了 SELECT 语句，并且不同 XOR 值的数量比我想象的要少。我意识到 CHECKSUM 并不总是唯一的，但是当两个不同的 CHECKSUM 字符串（具有多个参数，例如 CHECKSUM (String1, String2) 可以生成相同的 XOR 值时，这样使用它是否安全？

像这样将字符串连接在一起更安全：CHECKSUM (String1 + String2) 还是二进制 CHECKSUM？

**更新** 每个四个值的组合包含两行： Row1：String1、String2、String3、String4 Row 2：String3、String4、String1、Strin2

我只想为每个组合返回一行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T11:18:32.117

我的解决方案在这里找到：[How to do bitwise Exclusive OR in sql server between two binary types？](https://stackoverflow.com/questions/4833807/how-to-do-bitwise-exclusive-or-in-sql-server-between-two-binary-types). 它涉及将每 8 个字节拆分为二进制（8）。

# android - 如何在 Android 中向 Facebook Feed Dialog 添加超链接（即“属性”）？

> ID：13731944
> 
> 赞同：0
> 
> 时间：2012-12-05T20:35:50.057
> 
> 标签：android, facebook, facebook-android-sdk

我的 Android 应用调用 Facebook [Feed 对话框](https://developers.facebook.com/docs/reference/dialogs/feed/)并对其进行自定义，如下所示：

```
Bundle feedDialogParameters = new Bundle();
feedDialogParameters.putString("name", "My Name");
feedDialogParameters.putString("link", "My Link");
feedDialogParameters.putString("picture", "My Picture");
feedDialogParameters.putString("caption", "My Caption");
feedDialogParameters.putString("description", "My Description");

facebook.dialog(getActivity(), "feed", feedDialogParameters, new PostDialogListener()); 
```

这很好用，但现在我想在对话框中添加一些文本和超链接。我知道这可以通过 JavaScript Facebook API 通过包含一个`"properties"`参数来实现，但我一直无法找到适用于 Android 的等价物。如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:41:38.700

你可以试试这个，看看是否有帮助：`parameters.putString("link", "http://www.google.com");`

# c# - MediaLibrary.SavePicture 在输入使用过的流时失败

> ID：13731953
> 
> 赞同：0
> 
> 时间：2012-12-05T20:36:17.897
> 
> 标签：c#, silverlight, windows-phone-7, stream, cameracapturetask

我需要将使用 CameraCaptureTask 捕获的照片保存在手机的媒体库中，同时我想在图像控件中显示这张照片。问题是我首先尝试通过访问其 Exif 数据来旋转图像，以便它在 Image 控件中以正确的方向显示。

```
private void cameraTask_Completed(object sender, PhotoResult e)
    {
        if (e.TaskResult == TaskResult.OK)
        {
            int angle = GetAngleFromExif(e.ChosenPhoto);
            WriteableBitmap currentImage = DecodeImage(e.ChosenPhoto, angle);
            photoImage.Source = currentImage;

            MediaLibrary medialibrary = new MediaLibrary();
            medialibrary.SavePicture("test.jpg", e.ChosenPhoto);
        }
    } 
```

代码在最后一行崩溃，并出现错误：

> 值不在预期范围内。

这里可能出了什么问题？

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T21:09:52.243

在调用`SavePicture`方法之前，你应该把`Stream`后面设置在开头，像这样：

```
e.ChosenPhoto.Seek(0, System.IO.SeekOrigin.Begin); 
```

# php - 尝试使用 PHP 在 box.net 中创建共享链接

> ID：13731955
> 
> 赞同：2
> 
> 时间：2012-12-05T20:36:19.833
> 
> 标签：php, curl, put, box-api

这是我的代码：

```
$params = array();
$params['shared_link'] = array("access"=> "Open");
$params = json_encode($params);
echo $params;
$key = "[key]";
$token = "[token]";
$ch = curl_init();

curl_setopt($ch, CURLOPT_URL, "https://api.box.com/2.0/folders/[folder_id]/");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'PUT');
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_POSTFIELDS, $params);
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: application/json',                                                                                
   "Authorization: BoxAuth api_key=$key&auth_token=$token",'Content-Length: ' . strlen($params), 'X-HTTP-Method-Override: PUT'));
$result = curl_exec($ch);
curl_close($ch);
print_r($result); 
```

我无法创建共享链接。我从 box.net 得到这个回复：

```
{"type":"error","status":500,"code":"internal_server_error","help_url":"http:\/\/developers.box.com\/docs\/#errors","message":"Internal Server Error","request_id":"79086734650bfaf56c7894"} 
```

有人可以帮我吗？

谢谢！

马塞洛

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T03:30:52.463

幸运的是，我可以解决我的问题。

问题是我想用企业令牌创建一个“开放”共享链接，显然这是不可能的（我不是 100% 确定，但根据我的尝试，我认为是这样）。

感谢大家的帮助。

马塞洛

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T20:42:02.653

查看响应中返回的 URL，他们给出了 500 个错误的信息：

```
5xx
The request is fine, but something is wrong on Box’s end 
```

所以听起来你需要就这个问题联系 Box。

# jquery - 链接单击时的 JQuery 函数

> ID：13731961
> 
> 赞同：5
> 
> 时间：2012-12-05T20:36:36.383
> 
> 标签：jquery

我试图在链接点击时调用 jquery 函数但没有成功：

这是我的html：

```
<a href="..." id="removeItem" checkID="12" >Delete</a>
<a href="..." id="removeItem" checkID="13" >Delete</a>
<a href="..." id="removeItem" checkID="14" >Delete</a>

    $("#removeItem").click(function(checkID) {
    return false;
    var checkID = $(this).attr("checkID");
    $("#removeDialog").dialog( {
        buttons: {
            "No" : function () {
                $(this).dialog("destroy");
                $('input#CheckName').focus();
            },
            "Yes": function () {
                $.ajax({
                    url: "itemRemoveWS.html?id=checkID",
                    data: {
                        "action" : "remove",
                        "id" : checkID
                    },
                    success: function (data) {
                        $("#removeDialog").dialog("destroy");
                        var ang = '';
                        var obj = $.parseJSON(data);
                        $.each(obj, function() {
                           ang += '<table class="form"><tr><td width="45">' + this["CheckID"] + '</td><td width="140">' + this["Name"] + '</td><td width="95">' + this["CheckNumber"] + '</td><td align="right" width="70">$' + this["Amount"] + '</td><td width="220" style="padding-left: 15px;">' + this["Description"] +'</td><td><a href="#">Delete</a></td></tr></table>';
                        });
                        $('#container').html(ang);
                        $("input#Amount").val('');
                        $("input#CheckName").val('');
                        $("input#Check_Number").val('');
                        $("select#Company").val('MMS');
                        $("th#dept").hide();
                        $('input#CheckName').focus();
                    }
                });
            }
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-05T20:38:18.370

您`return false;`在点击事件回调函数中有第一条指令。这意味着你什么都不做。

将其放在逻辑的最后一行，或者更好地将其更改为`e.preventDefault();` 使用

```
$("#removeItem").click(function(e) {...} 
```

作为旁注，`$("#removeItem").click(function(checkID) {}` checkID 将是此处触发事件的引用，而不是元素 id 属性。

同样，每个 html 页面上的每个元素的 ID 属性必须是唯一的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T20:42:30.610

要在链接单击上调用函数，请使用 javascript:void(0) 作为您的 href，然后将函数调用添加到链接的 onclick 事件中：

```
<a runat="server" id="myButton" href="javascript:void(0);" onclick="myFunction();" ></a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T20:40:14.193

而不是使用`return false`，请执行以下操作：

```
checkID.preventDefault(); 
```

此外，您不允许有两个具有相同 ID 的元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-05T20:40:27.813

正如烤的所说， return false 可能是您的问题。可能你的意思是这样的：

```
checkID.preventDefault(); 
```

# node.js - 使用 passportjs、Express 和 monogodb 存储会话

> ID：13731967
> 
> 赞同：1
> 
> 时间：2012-12-05T20:36:53.623
> 
> 标签：node.js, mongodb, express, passport.js

我无法让与 mongodb 的会话正常工作。我已经设置了以下代码，它可以毫无问题地创建用户。

我还可以看到我的`sessions`数据库正在填充，如下所示：

[http://wes.io/LNbg/content](http://wes.io/LNbg/content)

问题是，我从来没有处于登录状态。如果我只使用内存来存储会话，它工作正常，但是当移动到 mongodb 时，它不起作用。这是我认为问题代码所在的位置，但您可以在此处查看整个应用程序：[http ://wes.io/LNVg](http://wes.io/LNVg)

```
passport.use(new LocalStrategy(
  function(username, password, done) {
    console.log('Trying to log in as '.green, username);

    User.findOne({ name: username }, function(err, user) {
      if (err) {return done(err); }

      if(user) {
        console.log('Found user with the username of'.green,user); 
        done(null, user);
      } 

      else {
        console.log('No user found...  '.red.inverse, username, password);
        var user = new User();
        user.name = username;
        user.username = username;
        user.password = password;
        user.save(function(err){
          if(err) { throw err; }
          console.log('User created and saved'.green, user)
          done(null, user);
        })
      };

    });
  }
));

passport.serializeUser(function(user, done) {
  done(null, user);
});

passport.deserializeUser(function(user, done) {
  done(null, user);
});

app.configure(function(){
  app.set('port', process.env.PORT || 3000);
  app.set('views', __dirname + '/views');
  app.set('view engine', 'jade');
  app.use(express.cookieParser());
  app.use(express.static(path.join(__dirname, 'public')));
  app.use(require('less-middleware')({ src: __dirname + '/public' }));
  app.use(express.favicon());
  app.use(express.bodyParser());
  app.use(express.logger('dev'));
  app.use(express.methodOverride());
  app.use(express.session({ 
        store: store
      , secret: 'applecake'
      , cookie : {
            maxAge : 604800 // one week
        }
  }));
  app.use(passport.initialize());
  app.use(passport.session()); 
  app.use(app.router);
}); 
```

编辑：这是会话存储的代码：

```
var express = require('express')
  , colors = require('colors')
  , routes = require('./routes')
  , mongoose = require('mongoose')
  , SessionStore = require("session-mongoose")(express)
  , store = new SessionStore({
        url: "mongodb://localhost/fb-session",
        interval: 120000 // expiration check worker run interval in millisec (default: 60000)
    })
  , Schema = mongoose.Schema
  , flash = require('connect-flash')
  , userz = require('./routes/user')
  , http = require('http')
  , path = require('path')
  , passport = require('passport')
  , LocalStrategy = require('passport-local').Strategy; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T22:04:45.640

原来这是序列化和反序列化方法的问题。这是我的名称示例，尽管它将更改为用户 ID

```
passport.serializeUser(function(user, done) {
    done(null, user.name);
});
passport.deserializeUser(function(name, done) {
    done(null, { name: name });
}); 
```

# jquery - jQuery - 在“选择器”和作为选择器传递的字符串之间感到困惑

> ID：13731970
> 
> 赞同：1
> 
> 时间：2012-12-05T20:37:02.303
> 
> 标签：jquery

我有以下我编写的代码，我个人认为它非常好。它需要 a`<ul>`并在单击时下拉内容。但是我在理解上存在脱节，我必须做我认为是“肮脏的黑客”来解决的问题。

问题是我不希望类“sidebar-dropdown-open”在插件中如此“硬连线”。但是我发现两者之间有非常明显的区别......

`$('.sidebar-dropdown-open')`甚至. `'sidebar-dropdown-open`_`'.sidebar-dropdown-open`

我通过在我的插件中包含两个不同的“参数”来“解决”这个问题，但我想知道是否有人可以让我了解如何更好地执行此操作，以及为什么会这样。

# 接线（文件加载）

```
$(document).ready(function () {
                $('[data-role="sidebar-dropdown"]').drawer({
                    open: 'sidebar-dropdown-open',
                    css: '.sidebar-dropdown-open'
                });
        }); 
```

# html

```
<ul>
    <li class=" dropdown" data-role="sidebar-dropdown">
        <a href="pages/.." class="remote">Link Text</a>
        <ul class="sub-menu light sidebar-dropdown-menu">
            <li><a class="remote" href="pages/...">Link Text</a></li>
            <li><a class="remote" href="pages/...">Link Text</a></li>
            <li><a class="remote" href="pages/...">Link Text</a></li>
        </ul>
    </li>
</ul> 
```

# javascript

```
(function ($) {
    $.fn.drawer = function (options) {
        // Create some defaults, extending them with any options that were provided
        var settings = $.extend({
            open: 'open',
            css: '.open'
        }, options);

        return this.each(function () {
            $(this).on('click', function (e) {
                // slide up all open dropdown menus
                $(settings.css).not($(this)).each(function () {
                    $(this).removeClass(settings.open);
                    // retrieve the appropriate menu item
                    var $menu = $(this).children(".dropdown-menu, .sidebar-dropdown-menu");
                    // slide down the one clicked on.
                    $menu.slideUp('fast');
                    $menu.removeClass('active');
                });

                // mark this menu as open
                $(this).addClass(settings.open);

                // retrieve the appropriate menu item
                var $menu = $(this).children(".dropdown-menu, .sidebar-dropdown-menu");
                // slide down the one clicked on.
                $menu.slideDown(100);
                $menu.addClass('active');
                e.preventDefault();
                e.stopPropagation();

            }).on("mouseleave", function () {
                $(this).children(".dropdown-menu").hide().delay(300);
            });

        })
    };

})(jQuery); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T20:43:49.203

jQuery 选择器的样式与 css 选择器完全一样，这使得设计人员和开发人员都非常容易学习。在我看来，你应该只使用一个参数并要求它是一个类名，而不是一个选择器，因为如果它是一个选择器，有人可能会认为他们可以使用 ID 选择器或更复杂的选择器，这会破坏你的代码。

# node.js - 在 Makefile 上设置 PATH - Node.js

> ID：13731977
> 
> 赞同：0
> 
> 时间：2012-12-05T20:37:43.570
> 
> 标签：node.js, path, makefile, vows

我想使用[api-easy](https://github.com/flatiron/api-easy)来测试我的 REST 应用程序。我在 package.json 中的依赖项中有它，所以当我运行 npm install 时，它安装在 ./node_modules

我正在尝试将 api-easy 添加到 [这个问题的路径中。](https://stackoverflow.com/questions/9679932/how-to-use-package-installed-locally-in-node-modules)

由于我使用的是 Makefile 我有这个：

```
test:
    @PATH="./node_modules/api-easy/node_modules/.bin:$PATH"
    @echo $PATH
    vows
    @node ./test/tests.js 
```

注意：api-easy 取决于 vows

PATH var 未更新，当我执行 echo 时，它返回我“ATH”（不是值），然后命令发誓未找到。如何在 Makefile 中正确设置 PATH？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T22:29:54.637

在`make`配方中，每个命令都作为单独的进程执行，因此在一个命令中设置环境变量不会影响其他命令。为了做你想做的事，你需要确保所有相关的命令都在一个 shell 实例中运行，其中环境变量按照你的预期传递：

```
test:
    @PATH="./node_modules/api-easy/node_modules/.bin:$$PATH"; \
    echo $$PATH; \
    vows; \
    node ./test/tests.js 
```

尾随反斜杠`make`表示将一行与后面的行连接起来。另请注意，`$`如果您希望 shell 解释字符，则需要引用字符。因此`$$`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-05T20:53:06.393

我认为应该这样做：

```
export PATH="./node_modules/api-easy/node_modules/.bin:$PATH"

test:
  vows
  @node ./test/tests.js 
```

# winforms - 如何确定正在运行的 WinForm 应用程序中的哪个窗体、事件或方法进行调试

> ID：13731980
> 
> 赞同：2
> 
> 时间：2012-12-05T20:37:55.803
> 
> 标签：winforms, visual-studio

这种情况以前出现过，我想知道是否有任何方法可以确定主动运行的表单在代码中的执行位置？问题是，当我继承了一个我还不完全熟悉的非常大的应用程序并且我让它通过 VS.NET 2010 运行时。我可能会打开一个特定的屏幕，然后“哎呀，如果我可以开始调试就好了当我做'x'时”。

如果这*是*一个带有一些按钮的简单表单，我什至不会在这里问；我不是那个新手。但是耗时的任务是，当我查看具有拖放功能、右键单击选项等的大型多项目解决方案中的选项卡式屏幕时，我必须花费 5-10 分钟跟踪在何处放置断点以进行调试。

我想知道是否有一种方法可以让 WinForms 应用程序通过 IDE 运行并执行“某些操作”来告诉 VS.NET 在下一个操作中闯入代码（显然没有断点，因为我不知道在哪里放一个）。这将为我节省大量时间来尝试以不那么简单的形式或一系列形式发生的事件。

我希望这是有道理的...

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T20:43:51.957

是的，这有点可能。当您使用 Debug + Break All 时，99.9% 的可能性是您不会闯入作为项目一部分的代码。Winforms 应用程序通常处于空闲状态，循环发送消息并等待 Windows 告诉它发生了什么事。您将在 Application.Run() 语句处中断。

然后使用 Debug + Step Over 的技巧。程序恢复正常运行。然后给出一个 UI 命令（在您的问题中执行“x”），调试器将在实际代码的第一条语句处中断，通常在该命令的事件处理程序的开始处。不能完全保证该代码是相关的，例如，您可能会在 MouseMove 事件处理程序处中断。所以YMMV。

# java - 蛇自食优化

> ID：13731981
> 
> 赞同：2
> 
> 时间：2012-12-05T20:37:58.700
> 
> 标签：java

我编写了自己的 Snake 游戏，Snake 在哪里`ArrayList of Points`，我使用这种方法来检查自食：

```
public void checkSelfEating() {
    for (int i = 1; i < body.size(); i++) {
        if (body.get(i).equals(body.get(0))) {
            sgv.setGameOverState(true);
            sgv.setMessage("Game over!");
            System.out.println("SelfEatingdetected");

        }
    }
} 
```

[视频（从 35 秒开始。）](http://www.youtube.com/watch?v=dniY76Y1RL8&feature=youtu.be)

![VisualVM 结果](../Images/afd61c2e77016e6b5a9b99f4a856fc24.png)

但它太慢了，蛇大约走 5 步直到游戏结束。有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T20:40:44.287

将 body 单元存储在`HashSet`via`add`和`remove`调用中。 `O(1)`. 此外，如果您使用 a `LinkedHashSet`，管理头部和尾部将非常容易（根据评论）。

说了这么多，虽然这是正确的数据结构并回答了您的问题，但我完全不知道为什么必须对几十个元素执行 for 循环会使您的程序如此缓慢。我强烈建议分析并找到实际的瓶颈，因为我什至不确定哈希集在这种规模下会更快。

# javascript - 如何刷新页面并设置一个counterto tableview

> ID：13731993
> 
> 赞同：1
> 
> 时间：2012-12-05T20:38:22.410
> 
> 标签：javascript

我有一个 HTMLB 表格视图。每 3 分钟我需要将它的`firstRowVisible`属性设置为一个动态值，即如果它第一次为零，那么在 3 分钟后它应该设置为 21，依此类推。

您能告诉我设置此参数的可能解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T20:43:23.047

使用回调和`setTimeout`

例如：

```
var callback = function(){
   //do something with firstRowVisible
};
setTimeout(callback, 3 * 60 * 1000); //after 3 minutes 
```

# prolog - 使用序言将元素添加到列表中

> ID：13731995
> 
> 赞同：0
> 
> 时间：2012-12-05T20:38:28.703
> 
> 标签：prolog

我遇到了这个问题我想列出目标位置，就像我输入

```
?- extractIndices([5,6,7,8,9,5,6],6,List). 
```

它应该返回

```
List = [1,6] 
```

这给出了该列表中 6 的所有位置。我写了这样的代码：

```
extractIndices(List , Item, [Index | Indecis]) :- 
    indexOf(List , Item, Index).

indexOf([Item | _], Item, 0).
indexOf([_ |Tail], Item, Index):-
    indexOf(Tail, Item, Index1),
    Index is Index1+1. 
```

这给了我

```
?- extractIndices([5,6,7,8,9,5,6],6,L).
L = [1|_G2870] ;
L = [6|_G2870] ;
false. 
```

如果有人能帮我解决这个问题，将非常感激......谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T20:54:30.410

您为 提供了两条规则`indexOf`，一条处理列表的*头部*，忽略尾部，另一条处理*尾部*，忽略头部。这会为您的查询产生两种不同的解决方案，如图所示。

谓词`nth0`可用于将位置映射到列表中的项目。

使用它的最简单方法是`findall`：

```
extractIndices(List , Item, Indices) :-
     findall(N, nth0(N, List, Item), Indices). 
```

您还可以使用类似`indexOf`. 但是您可能想要提供两种不同的规则：一种用于*基本情况*（通常是一个空列表），另一种用于解决头部问题的*递归情况*，然后`indexOf`在尾部再次调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T21:06:00.747

我将使用与 Edmund 相同的代码（即 findall + nth0），但为了学习目的，对您的代码进行更正是值得展示的：

```
extractIndices(List , Item, Indices) :- 
    indexOf(List, Item, 0, Indices).

indexOf([X|Items], Item, I, Is) :-
    ( X == Item -> Is = [I|Rs] ; Is = Rs ),
    J is I + 1,
    indexOf(Items, Item, J, Rs).
indexOf([], _, _, []). 
```

测试：

```
?- extractIndices([5,6,7,8,9,5,6],6,L).
L = [1, 6]. 
```

# windows-8 - winrt有手势生成器吗

> ID：13731996
> 
> 赞同：0
> 
> 时间：2012-12-05T20:38:30.117
> 
> 标签：windows-8, windows-runtime, gesture

在 android 世界中有一个很酷的实用程序，称为[Gesture Builder](http://android-coding.blogspot.ca/2011/09/gestures-builder-create-your-gestures.html)，它允许您将预先录制的手势与命令相关联。例如，他们可以在屏幕上做一个 X 并关闭应用程序，或者画一颗心并让应用程序发送一封情人节电子邮件。

WinRT 有类似的功能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T21:03:01.627

我认为没有内置任何东西，但您可以尝试 $1、N$ - One Dollar 和 N Dollar 识别器：

*   [http://depts.washington.edu/aimgroup/proj/dollar/](http://depts.washington.edu/aimgroup/proj/dollar/)
*   [http://depts.washington.edu/aimgroup/proj/dollar/ndollar.html](http://depts.washington.edu/aimgroup/proj/dollar/ndollar.html)
*   [http://blogs.claritycon.com/kevinmarshall/2008/11/21/beginning-multi-touch-on-windows-7-amp-basic-gesture-recognition/](http://blogs.claritycon.com/kevinmarshall/2008/11/21/beginning-multi-touch-on-windows-7-amp-basic-gesture-recognition/)
*   [http://employees.claritycon.com/kmarshall/DollarMultiTouch.zip](http://employees.claritycon.com/kmarshall/DollarMultiTouch.zip)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T18:45:45.727

这不完全是您想要的，但可能对 Windows.UI.Input.GestureRecognizer 有所帮助。

# java - Resteasy + Maven，REST 调用返回服务器 415 响应码

> ID：13731998
> 
> 赞同：0
> 
> 时间：2012-12-05T20:38:38.590
> 
> 标签：java, spring, resteasy

我正在使用 maven 开发一个 java 项目，我想使用 RESTeasy 来构建一个 RESTful Web 服务。我编写了一个测试来检查 RESTeasy 的功能，但我总是收到 HTTP 错误 415 不支持的媒体类型。我认为问题是我没有将 Content-Type 标头定义为 JSON，所以它会失败，但我不知道该怎么做。做什么？

BoardingPassProxy.java：

```
package com.boardingpass.clients.rest;

import javax.ws.rs.Consumes;
import javax.ws.rs.POST;
import javax.ws.rs.Produces;
import javax.ws.rs.core.Response;

import com.BoardingPassRequest;

public interface BoardingPassProxy {

@POST
@Produces("application/json")
@Consumes("application/json")
public Response getBoardingPassImage(BoardingPassRequest boardingPassRequest);

} 
```

BoardingPassService.java：

```
package com.boardingpass.clients.rest;

import org.jboss.resteasy.client.ProxyFactory;
import org.jboss.resteasy.plugins.providers.RegisterBuiltin;
import org.jboss.resteasy.spi.ResteasyProviderFactory;

public class BoardingPassService {

public BoardingPassService() {
    RegisterBuiltin.register(ResteasyProviderFactory.getInstance());
}

public BoardingPassProxy getProxy(String endpoint) {
        BoardingPassProxy proxy = ProxyFactory.create(BoardingPassProxy.class, endpoint);
        return proxy;
    }
} 
```

pom.xml：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
<modelVersion>4.0.0</modelVersion>

<parent>
    <groupId>boardingpass</groupId>
    <artifactId>boardingpass-parent</artifactId>
    <version>2.1-SNAPSHOT</version>
</parent>
<packaging>jar</packaging>
<artifactId>boardingpass-client</artifactId>
<name>Boarding Pass Client</name>

<properties>
  <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
</properties>

<repositories>
    <repository>
        <id>JBoss repository</id>
        <url>https://repository.jboss.org/nexus/content/groups/public-jboss/</url>
    </repository>
</repositories>

<dependencies>
  <dependency>
    <groupId>org.json</groupId>
    <artifactId>json</artifactId>
    <version>20080701</version>
  </dependency>

      <dependency>
          <groupId>junit</groupId>
          <artifactId>junit</artifactId>
          <version>4.8.2</version>
          <scope>test</scope>
      </dependency>

      <dependency>
          <groupId>boardingpass</groupId>
          <artifactId>boardingpass-core</artifactId>
      </dependency>

      <dependency>
          <groupId>org.jboss.resteasy</groupId>
          <artifactId>resteasy-jaxrs</artifactId>
          <version>2.3.3.Final</version>
       </dependency>

       <dependency>
           <groupId>org.mockito</groupId>
           <artifactId>mockito-all</artifactId>
           <version>1.8.5</version>
           <scope>test</scope>
       </dependency>

       <dependency> 
            <groupId>org.jboss.resteasy</groupId>
            <artifactId>resteasy-jackson-provider</artifactId>
            <version>2.2.1.GA</version>
        </dependency>
    </dependencies>

</project> 
```