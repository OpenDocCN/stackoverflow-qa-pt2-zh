# StackOverflow 问答 15647000-15647999

# javascript - jQuery 表单错误

> ID：15647000
> 
> 赞同：0
> 
> 时间：2013-03-26T20:42:45.563
> 
> 标签：javascript, jquery, html

我有一个简单的形式，它并不意味着功能，它只是一个原型。这是HTML：

```
<form class="signup">
  <div class="group">
    <div class="row">
      <label>Username</label>
      <input type="text">
    </div>
    <div class="row">
      <label>Password</label>
      <input type="password">
    </div>
  </div>

  <input type="submit" value="Sign In">
</form> 
```

我需要它，所以如果用户要在用户名和密码中输入一些数据（虚拟数据）并单击提交，它会显示一个 JavaScript 警报，说“登录”，如果其中一个输入不包含任何数据，我希望它显示一个 JavaScript 警报，说“错误”。

我想使用 jQuery，这就是我目前所拥有的：

```
$('.signup').submit(function () {
  if($(this).valid()) {
    alert('Logged in');
  }else {
    alert('Error!');
  }
}); 
```

有什么理由不工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T20:45:20.130

看起来您正在尝试使用[jQuery 验证插件](http://docs.jquery.com/Plugins/Validation)。确保你也在你的页面上包含了它，因为`valid()`它不是 jQuery 包含的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:32:10.190

以下应该适用于您的最新问题：

```
$('.signup').submit(function () {
    if( $('input[type="text"]').val()!='' && $('input[type="password"]').val()!='' ) {
        alert('Logged in');
    }
    else {
        alert('Error!');
    }
}); 
```

# dart - 如何在 Dart 中创建服务器端模板，我可以在其中设置不同的 for each page?

First of all, I really like Dart and keep trying to use it in real projects, but then I hit problems like this one where every other web framework has an obvious

> ID：15647003
> 
> 赞同：10
> 
> 时间：2013-03-26T20:43:01.377
> 
> 标签：dart

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-26T22:43:56.763

试试[mustache ，一个](http://pub.dartlang.org/packages/mustache)[mustache 模板](http://mustache.github.com/mustache.5.html)的 Dart 实现，一种广泛使用的模板语法，有多种语言的实现。

这是一个例子：

```
import 'package:mustache/mustache.dart';

main() {
    var source = '{{#names}}<div>{{lastname}}, {{firstname}}</div>{{/names}}';
    var template = new Template(source);
    var output = template.renderString({'names': [
        {'firstname': 'Greg', 'lastname': 'Lowe'},
        {'firstname': 'Bob', 'lastname': 'Johnson'}
    ]});
    print(output);
} 
```

Dart 团队目前专注于客户端开发，因此核心库中缺少许多基本的服务器端功能。但是看看[pub](http://pub.dartlang.org/)，有许多社区维护的包可用。

另请参阅这个类似的包：[mustache4dart](https://pub.dartlang.org/packages/mustache4dart)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-18T15:44:25.957

你可以试试[https://pub.dev/packages/edart](https://pub.dev/packages/edart)。
嵌入式 Dart 模板引擎和编译器。将模板编译为 Dart 源代码。

例子：

`products_index.html`

```
<%@ import uri="layout.html.g.dart" %>
<%@ import uri="../models/product.dart" %>
<%@ class extends="View" %>
<%@ render params="List<Product> products, HttpRequest request" %>
<p>
    Our cool products list
</p>
<ul class="w3-ul">
    <% for (final product in products) { %>
    <li><%= product.name %>&nbsp;<%= product.price %></li><%
    } %>
</ul>
<%
final layout = layout_html();
layout.title = 'Products';
layout.addTag(HtmlTag('meta', {'description': 'MegaSuperShop cool price list'}));
layout.addBreadcrumb('Products', request.requestedUri.toString());
layout.render(out, request);
%> 
```

该模板将被编译成以下源代码：

`products_index.html.g.dart`

```
// ignore: unused_import
import 'dart:convert';
import 'layout.html.g.dart';
import '../models/product.dart';

class products_index_html extends View {
  String render(List<Product> products, HttpRequest request) {
    final out = StringBuffer();
    out.write('<p>\n');
    out.write('    Our cool products list\n');
    out.write('</p>\n');
    out.write('<ul class="w3-ul">\n');
    for (final product in products) {
      out.write('    <li>');
      out.write(htmlEscape.convert('${product.name}'));
      out.write('&nbsp;');
      out.write(htmlEscape.convert('${product.price}'));
      out.write('</li>');
    }
    out.write('</ul>\n');
    final layout = layout_html();
    layout.title = 'Products';
    layout.addTag(
        HtmlTag('meta', {'description': 'MegaSuperShop cool price list'}));
    layout.addBreadcrumb('Products', request.requestedUri.toString());
    layout.render(out, request);
    return out.toString();
  }
} 
```

布局模板也很简单易懂。

`layout.html`

```
<%@ import uri="../html/layout.dart" %>
<%@ import uri="breadcrumbs.html.g.dart" %>
<%@ import uri="footer.html.g.dart" %>
<%@ import uri="header.html.g.dart" %>
<%@ import uri="nav.html.g.dart" %>
<%@ export uri="../html/breadcrumb.dart" %>
<%@ export uri="../html/html_utils.dart" %>
<%@ export uri="../html/view.dart" %>
<%@ class extends="Layout" %>
<%@ render params="StringBuffer body, HttpRequest request, {int statusCode = 400}" %>
<html>

<head>
  <title><%= title %></title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <% for (final tag in tags) { %>
  <%== tag %>
  <% } %>
</head>

<body>
  <%== header_html().render(title) %>

  <%== nav_html().render(request) %>

  <div class="w3-container">
    <%== breadcrumbs_html().render(breadcrumbs) %>
  </div>

  <div class="w3-container">
    <%== body %>
  </div>

  <%== footer_html().render() %>

</body>

</html>
<%
body.clear();
body.write(out);
final response = request.response;
response.headers.add('Content-Type', 'text/html; charset=utf-8');
response.statusCode = statusCode;
response.write(out);
%> 
```

最后是 class 的源代码`Layout`。
它可以是任何东西，也可能根本不是（这不是很方便）。

```
import 'breadcrumb.dart';
import 'html_utils.dart';

export 'dart:io';

export '../site/site_links.dart';
export 'html_utils.dart';

class Layout {
  final breadcrumbs = <Breadcrumb>[];

  final tags = <HtmlTag>[];

  String title = '';

  void addBreadcrumb(String text, String url) {
    final item = Breadcrumb(text: text, url: url);
    breadcrumbs.add(item);
  }

  HtmlTag addTag(HtmlTag tag) {
    tags.add(tag);
    return tag;
  }
} 
```

# forms - 文本区域和jsp

> ID：15647006
> 
> 赞同：1
> 
> 时间：2013-03-26T20:43:06.773
> 
> 标签：forms, jsp, textarea, javabeans

我有一个文本区域，我首先打印一些来自`request.getParameter("some_textarea_name")`. 允许用户修改这些值，然后我想获取新值并用新值替换旧值，以便查询新值并从我的数据库表中获取结果。我可以在不将用户重定向到新页面的情况下做到这一点，例如不使用`<form method>`和`request.getParameter()`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T00:42:56.177

> 我可以在不重定向用户的情况下这样做吗

是的，您可以实现一个 ajax 调用，该调用将在不重定向用户的情况下提交表单，并且您可以对响应做一些事情（也许将其添加到页面中）。如果您在使用 ajax 时需要帮助，请遵循本[教程](http://binodsuman.blogspot.co.uk/2009/05/get-start-with-ajax-ajax-siimple.html)，但请注意它在纯 javascript 中实现 AJAX（它有点臃肿/复杂）。如果您想保持简单，请查看[jQuery ajax](http://api.jquery.com/jQuery.ajax/)，这里也是一个[教程](http://www.java4s.com/jquery-tutorials/submit-form-without-refreshing-page-in-javajsp-with-jquery/)。

> 不使用

不，您需要使用要提交的表单，但是如果您使用 ajax，则不需要重定向用户。

# c# - 为什么人们使用 ProjectData

> ID：15647015
> 
> 赞同：10
> 
> 时间：2013-03-26T20:43:24.983
> 
> 标签：c#

最近我在网上看了一些编码。我发现有些人在块中使用[`Microsoft.VisualBasic.CompilerServices.ProjectData.ProjectData`](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.compilerservices.projectdata.aspx)类。`catch`

```
 catch (Exception exception1)
        {
            //ProjectData.SetProjectError(exception1);
            Console.WriteLine(exception1.ToString());
            Console.WriteLine();
            Console.WriteLine(sSQL);
            //ProjectData.ClearProjectError();
        } 
```

我在 msdn 上搜索了它，提到此 API 支持 .NET Framework 基础结构，并且不打算直接从您的代码中使用。

我很好奇人们使用它的原因是什么。你能给我解释一下吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-26T20:46:59.180

我的经验是，在从 VB6 转换而来的 c#/VB.NET 项目中可以找到这种类型的代码使用。在开发新的 c#/VB.NET 解决方案/项目时，不应使用这种做法。

注意：此技术可以安全地替换为您在其他 .NET 解决方案/项目中经常看到的正确异常处理。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-11-17T19:48:56.260

此代码由将 VB 代码转换为 C# 的代码转换工具发出，或者由反编译最初使用 VB 创建的程序集产生。

我正在将一个 VB 项目移植到 Mono，发现 VB 编译器将这些调用注入`ProjectData.SetProjectError(exception)`到`ProjectData.ClearProjectError()`任何 catch 块中，并试图找到一种方法来阻止编译器这样做，因为 Mono 没有实现该`ProjectData`模块。在做我的研究时发现了你的问题！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-12-22T01:28:25.060

所以对于那些感兴趣的人来说，这是旧的遗留 vb6 的结果。当 vb6 开始时，有一个 err 对象仍然存在，但已移动到 vb 中的 projectdata 对象。如果像我这样的人还记得 vb6（这是恐龙在地球上漫游的时候），接下来有一个方便的小调用错误恢复。这是如果你不喜欢那些讨厌的小例外。大多数 vb6 程序大量使用它，瞧你没有例外，因为你忽略了任何一个。所以这里有解释。

catch (Exception exception1) // 捕获任何刚刚发生的异常

```
 {

        ProjectData.SetProjectError(exception1); // set the information 
```

//如果有人真的想检查，则在 err 对象中

```
 ProjectData.ClearProjectError(); //clear the err object
    } 
```

正如您所看到的，这完全忽略了任何异常，并且以真正的 vb6 方式，您的代码只是在没有任何解释的情况下爆炸。不用说如果有人写这样的代码或以这种方式使用vb，我会找到你并想办法让你入狱。

# sql - SSIS：升级到 SQL Server 2012 后工作包失败

> ID：15647019
> 
> 赞同：5
> 
> 时间：2013-03-26T20:43:41.123
> 
> 标签：sql, ssis, sql-server-2012

我有一个在 SQL2008R2 上运行良好的 SSIS 包，它使用环境变量指向连接字符串的配置文件。使用 VS2010 Shell，我升级了 SQL Server 2012 数据库的软件包。该包仍处于包部署模型中。包的 ProtectionLevel 设置为`DontSaveSensitive`。`Run64BitRuntime = False`. 当我尝试在 VS 中执行包时，出现以下错误：

> [OLE DB 目标 [2]] 错误：SSIS 错误代码 DTS_E_CANNOTACQUIRECONNECTIONFROMCONNECTIONMANAGER。对连接管理器“DB_Connection”的 AcquireConnection 方法调用失败，错误代码为 0xC0202009。在此之前可能会发布错误消息，其中包含有关 AcquireConnection 方法调用失败原因的更多信息。**
> 
> [SSIS.Pipeline] 错误：OLE DB 目标在预执行阶段失败并返回错误代码 0xC020801C。**

完全登录后，我在这里看到了第一个失败：

> 诊断，[计算机名]，OFFICE\用户名，DB_Connection，{5AD75239-D546-4AAF-963E-E195FC2F0C1E}，{9EC48106-DDBD-40E9-8FBB-942BCF025EEE}，3/26/2013 10:35:21 AM，3/ 26/2013 10:35:21 AM，0，（null），ExternalRequest_post：'ITransactionJoin::JoinTransaction 失败'。外部请求已完成。**

真正让我震惊的部分是，在包的早期，相同的“DB_Connection”管理器在许多执行 SQL 任务中成功使用。因此，似乎正在从配置中正确读取连接字符串。

我试过删除\重新创建连接管理器。我已验证 DTC 在我的本地和服务器上均已正确配置。我有其他包使用相同的配置方法使用数据流任务连接到同一个 SQL2012 数据库，没有问题。

任何人都可以给我指出正确方向的任何帮助将不胜感激。如果我不需要，我宁愿此时不必迁移到项目部署模型。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-27T18:37:37.260

我能够让我的包在本地运行。虽然我检查了我的任务上的**TransactionOption**以确保它们被设置为**Supported**，但事实证明我的序列容器之一被设置为**Required**。不知道为什么这在 SQL2008R2 中有效，但在 SQL2012 中无效。我将容器更改为**受支持**，并且程序包现在运行。

# java - Informix 上的 JPA 事务

> ID：15647024
> 
> 赞同：1
> 
> 时间：2013-03-26T20:43:55.037
> 
> 标签：java, jpa, eclipselink, informix

我需要在 Java SE 7.0 环境中使用 JPA 2.0 和 EclipseLink 3.0 对表进行更新，使用 Non-Transactional Informix DB v. 11.50，persistence.xml 是：

```
<persistence-unit name="pp_pu" transaction-type="RESOURCE_LOCAL">
    <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
    <class>...</class>
    <class>...</class>
    <properties>
        <property name="javax.persistence.jdbc.url"
                  value="jdbc:informix-sqli://10.191.78.230:40494/ptpr:informixserver=online_ptpr"/>
        <property name="javax.persistence.jdbc.driver" value="com.informix.jdbc.IfxDriver"/>
        <property name="javax.persistence.jdbc.user" value="test"/>
        <property name="javax.persistence.jdbc.password" value="test"/>
    </properties>
</persistence-unit> 
```

当我尝试进行更新时，我收到以下错误：

```
Exception in thread "main" javax.persistence.TransactionRequiredException: 
Exception Description: No transaction is currently active
    at org.eclipse.persistence.internal.jpa.transaction.EntityTransactionWrapper.throwCheckTransactionFailedException(EntityTransactionWrapper.java:113)
    at org.eclipse.persistence.internal.jpa.transaction.EntityTransactionWrapper.checkForTransaction(EntityTransactionWrapper.java:50)
    at org.eclipse.persistence.internal.jpa.EntityManagerImpl.checkForTransaction(EntityManagerImpl.java:1776)
    at org.eclipse.persistence.internal.jpa.EJBQueryImpl.executeUpdate(EJBQueryImpl.java:533) 
```

然后我尝试使用以下方法解决错误：

```
em.getTransaction().begin();
// Update query
em.getTransaction().commit(); 
```

现在我收到以下错误：

```
Internal Exception: java.sql.SQLException: Transactions not supported
Error Code: -79744
Exception in thread "main" Local Exception Stack: 
Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.0.v20110604-r9504): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: java.sql.SQLException: Transactions not supported
Error Code: -79744
Query: DataModifyQuery(sql="update tg_proteccion_cv
set i_eq_validados=?,
    i_eq_a_protegidos=?
where v_id_proteccion=?
    and v_cve_cliente=?")
    at org.eclipse.persistence.exceptions.DatabaseException.sqlException(DatabaseException.java:324)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.basicBeginTransaction(DatabaseAccessor.java:230)
    at org.eclipse.persistence.internal.databaseaccess.DatasourceAccessor.beginTransaction(DatasourceAccessor.java:239)
    at org.eclipse.persistence.internal.sessions.AbstractSession.basicBeginTransaction(AbstractSession.java:479)
    at org.eclipse.persistence.sessions.server.ClientSession.addWriteConnection(ClientSession.java:646)
    at org.eclipse.persistence.sessions.server.ServerSession.acquireClientConnection(ServerSession.java:246)
    at org.eclipse.persistence.sessions.server.ClientSession.executeCall(ClientSession.java:226)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.executeCall(DatasourceCallQueryMechanism.java:207)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.executeCall(DatasourceCallQueryMechanism.java:193)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.executeNoSelectCall(DatasourceCallQueryMechanism.java:236)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.executeNoSelect(DatasourceCallQueryMechanism.java:216)
    at org.eclipse.persistence.queries.DataModifyQuery.executeDatabaseQuery(DataModifyQuery.java:85)
    at org.eclipse.persistence.queries.DatabaseQuery.execute(DatabaseQuery.java:829)
    at org.eclipse.persistence.queries.DatabaseQuery.executeInUnitOfWork(DatabaseQuery.java:728)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.internalExecuteQuery(UnitOfWorkImpl.java:2863)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1501)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1483)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1457)
    at org.eclipse.persistence.internal.jpa.EJBQueryImpl.executeUpdate(EJBQueryImpl.java:540)
    at com.telcel.gsa.dsiee.pprecios.amb_alt.FixProtsCv.updateCV(FixProtsCv.java:70)
    at com.telcel.gsa.dsiee.pprecios.amb_alt.FixProtsCv.fix(FixProtsCv.java:88)
    at com.telcel.gsa.dsiee.pprecios.amb_alt.FixProtsCv.main(FixProtsCv.java:42)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120)
Caused by: java.sql.SQLException: Transactions not supported
    at com.informix.util.IfxErrMsg.getSQLException(IfxErrMsg.java:348)
    at com.informix.jdbc.IfxSqliConnect.setAutoCommit(IfxSqliConnect.java:1333)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.basicBeginTransaction(DatabaseAccessor.java:223)
    ... 25 more 
```

使用 JDBC 进行更新没有问题，¿JPA 是否支持非事务数据库？出于性能原因，DBA 已关闭 Informix 上的事务支持，这不会改变。那么，我有什么遗漏吗？怎么了？

PD 我已经使用启用事务的 Informix DB 进行了相同的更新，并且它可以工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T18:57:47.007

最后的工作示例（如 James 建议的那样）是：

```
public class Test {

    public static void main(String[] args) {
        EntityManagerFactory emf = Persistence.createEntityManagerFactory("pp_pu");
        EntityManager em = emf.createEntityManager();

        Session session = em.unwrap(Session.class);
        session.getLogin().useExternalTransactionController();

        em.getTransaction().begin();
        int updates = em.createNamedQuery("CgEstatusEntity.updateById")
                .setParameter("iCveEstatus", 1)
                .setParameter("vDescEstatus", "Test9")
                .executeUpdate();
        System.out.println(updates);

        em.getTransaction().commit();

    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T14:32:56.073

禁用事务支持很奇怪。

使用 EclipseLink，您可以使用 SessionCustomizer 禁用事务，

```
session.getLogin().useExternalTransactionController(); 
```

这将使 EclipseLink 在管理事务（通常是 JTA）时想到别的东西，但在你的情况下，什么都没有......

# wordpress - 使用外部图像的 Wordpress 图像库

> ID：15647025
> 
> 赞同：2
> 
> 时间：2013-03-26T20:43:56.257
> 
> 标签：wordpress, image-gallery

我想知道任何已知的使用外部媒体源而不是通过 wordpress 媒体库上传的图像或视频库插件。

最坏的情况，是否有一个插件可以执行计划/更新只从文件服务器导入？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T13:07:24.377

You can use the following [code](http://www.portablehtml.com/2013/04/the-issus-battle-gallery.html) jointly with [ImageZone](https://addons.mozilla.org/en-US/firefox/addon/imagezone/). With ImageZone you can collect external images and share them, while the code will render them into html. The code looks like:

```
// where do you want to add the gallery 
<div id="GalleryId"></div>
  <style>...</style>
  // this is generated by imagezone
  <script type="text/json" id="GalleryId">...</script>
  <script type="text/javascript">
    function setup(gid){
    }
    setup("GalleryId");
  </script> 
```

and you could make it a wp shortcode

# java - 从 android 应用程序触发 javascript

> ID：15647028
> 
> 赞同：0
> 
> 时间：2013-03-26T20:44:21.237
> 
> 标签：java, javascript, android

我对android开发很陌生。我在应用程序中的一个按钮将用户发送到一个网页，用户可以在其中登录特定系统。

该网页有用户名和密码的文本框。一旦您单击登录按钮（在网页中），它就会触发 javascript 登录到系统。触发的代码是：`onclick="updateAction('TourAccLogin');document.main_form.submit();`

登录网页表单：

![用于登录的网页表单](../Images/f3ae2273c3cc954c1561c9463e1cff8d.png)

**我的问题是：** 我在应用程序中有用户名和密码，我想知道我是否可以以某种方式操纵此表单，自动登录而无需用户干预？意思是，我将填写用户名和密码，然后“单击”登录按钮。因此，用户将立即被引导到系统，而无需输入用户名和密码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:19:49.427

这种技术对我有用。在我的例子中，我正在加载一个名为 mElementId 的隐藏字段，其中包含存储在 someData 中的字符串值，然后触发其 onchange 事件，该事件不会自行触发。我包含它是为了展示如何在一次注入中堆叠 javascript 命令。我相信这个变种会为你工作。

我还转义了任何单引号以防止出现 javascript 错误。您可能需要转义任何其他特殊字符，包括分号。就我而言，这没有必要，因为数据已经被清理过了。

```
// Copy data to element
mWebView.loadUrl("javascript:(function() { " +  
        "document.getElementById('" + mElementId + "').value = '" + 
        someData.replace("'", "\'") + "'; " +
        "document.getElementById('" + mElementId + "').onchange();" +
        "})()"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:16:06.257

你说它是你的系统，所以你知道在后台运行什么来处理登录。我不是在嘲笑，只是在验证。我假设您已经创建了某种视图，在此之前您拥有用户名/密码。我质疑这一点是因为您问是否有办法操纵表格...

也就是说，像往常一样将数据发送到处理登录的脚本。如果您使用的是 GET，那么[http://some.domain.com/somescript?username=mumble&password=foo](http://some.domain.com/somescript?username=mumble&password=foo)。如果您使用的是 POST，则创建帖子参数并发送它。无论哪种方式，您都可以在 web 视图中处理结果，这将允许您现有的界面在应有的位置拾取。

当然，如果您使用哈希作为密码或对密码进行加盐，则需要在发送之前完成所有这些操作。

# php - PHP foreach如何在循环外访问变量

> ID：15647029
> 
> 赞同：0
> 
> 时间：2013-03-26T20:44:23.277
> 
> 标签：php, twitter, foreach

我有这个代码可以进入推特提要......

```
// Output tweets
  $json = file_get_contents("http://api.twitter.com/1/statuses/user_timeline.json?include_entities=true&include_rts=false&screen_name=*********&count=100", true);
  $decode = json_decode($json, true);

  $count = count($decode); //counting the number of status
  for($i=0;$i<$count;$i++){
    //echo $decode[$i]["text"]."<br><br>";
    $text = $decode[$i]["text"]." ";
    echo $text;
  } 
```

我想在另一个函数中访问 $text 。这可以做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T20:47:46.847

只需有一个数组并在每次循环运行时将其插入，然后将其回显或返回。

```
 $arr = array();
 for($i=0; $i<$count; $i++) {
   $text = $decode[$i]['text'];
   $arr[] = $text;
   echo $text . " ";
 }

 var_dump($arr); 
```

# eclipse - 将 Maven 安装添加到 EClipse

> ID：15647030
> 
> 赞同：8
> 
> 时间：2013-03-26T20:44:24.063
> 
> 标签：eclipse, macos, maven

我正在关注我们的 wiki 页面，首先我们使用 HomeBrew 安装 Maven 并将路径更改为如下所示：

```
Apache Maven 3.0.4 (r1232337; 2012-01-17 02:44:56-0600)
Maven home: /usr/local/Cellar/maven/3.0.4/libexec 
```

现在它说这样做：

> 将您的 Maven 主页添加为 Maven 安装（Eclipse -> Preferences -> Maven -> Installations）

所以我在这里：

![在此处输入图像描述](../Images/cb91163fb9b7ddf9f70ac189dcfe11e2.png)

所以我应该在这里添加上面发布的 Maven Home 路径？但是当我单击 Add... 按钮时，它会打开一个对话框以将其指向某个文件夹，但我根本无法导航到该 /usr 文件夹。找不到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T20:48:29.613

单击添加时，您需要浏览外部 Maven 安装的 MAVEN_HOME 文件夹。听起来您的说明假设您已经在 Eclipse 之外安装了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-15T06:12:16.353

一种解决方案是确保您的机器在 Finder 侧边栏中可见，如下所示：

1.  打开 Finder 首选项
2.  转到侧边栏选项卡
3.  查看设备部分；列出的第一个项目应该是您的 Mac（我的称为“Andrew's Mac Pro” - 确保已勾选。

现在，当您在上面发布的对话框中单击“添加...”按钮时，您将能够导航到*your_machine_name* / *your_HDD* /usr/local/Cellar/maven/xxx/libexec 并选择该目录。这只是在带有 Eclipse Juno SR2 的 OSX 10.8.3 上为我工作。

# php - 带有促销代码的销售电子邮件 - 插入促销代码标题

> ID：15647032
> 
> 赞同：-1
> 
> 时间：2013-03-26T20:44:27.673
> 
> 标签：php, xml, magento

我已经弄清楚了如何通过这里所说的删除销售订单电子邮件中的[促销代码：Magento 删除客户交易电子邮件中的促销代码](https://stackoverflow.com/questions/15146103/magento-remove-promotional-code-in-customer-transactional-emails)

现在他们希望促销的**标题**包含在电子邮件中（而不是代码）。我该怎么办？有没有我可以添加的变量`mytotals.phtml`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:28:22.267

根据可用信息，您似乎想要提取促销的标题而不是代码。您可以通过`mytotals.phtml`以下方式获取信息：

```
if ($_code=="discount") {
  $code_used = trim(str_replace(array("Discount (",")"),array(""),$this->escapeHtml($_total->getLabel())));
  $coupon = Mage::getModel('salesrule/coupon');
  $coupon->load($code_used, 'code');
  $rule = Mage::getModel('salesrule/rule')->load($coupon->getRuleId());
  $rule_name = $rule->getName();
} 
```

您可以`$rule_name`在希望显示标题的位置`Shopping Cart Rule`回显。

# javascript - “迭代器绑定到上下文对象。”

> ID：15647034
> 
> 赞同：3
> 
> 时间：2013-03-26T20:44:34.570
> 
> 标签：javascript, underscore.js

Underscore.js 文档说：

> **_.each（列表，迭代器，[上下文]）**
> 
> 迭代一个元素列表，依次将每个元素生成一个迭代器函数。**如果传递了一个，则迭代器绑定到上下文对象。**迭代器的每次调用都使用三个参数调用：（元素、索引、列表）。如果 list 是 JavaScript 对象，迭代器的参数将是 (value, key, list)。如果存在，则委托给本机 forEach 函数。

```
_.each([1, 2, 3], alert);
=> alerts each number in turn...
_.each({one : 1, two : 2, three : 3}, alert);
=> alerts each number value in turn... 
```

上面加粗的文字是什么意思？有人可以提供一个可以解释它的例子吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-26T20:46:33.230

这意味着，在您的迭代器函数中， 的值`this`将是您作为`context`参数传递的值。

例如：

```
var arr = [1, 2, 3];
function iterator(el, i, list) {
    console.log(this)
}
_.each(arr, iterator, arr); // will log the whole array 3 times 
```

如果您想将对象方法作为迭代器传递，并且该方法使用`this`. 例子：

```
var arr = [1, 2, 3];
var myObj = {
    foo : 5,
    addFoo : function(el, i, lst) {
       console.log(el + this.foo)
    }
};

// This will log NaN 3 times, because 'this' inside the function
// will evaluate to window, and there's no window.foo. So this.foo
// will be undefined, and undefined + 1 is NaN   
_.each(arr, myObj.addFoo);

// This, on the other hand, works as intended. It will get the value
// of foo from myObj, and will log 6, then 7, then 8
_.each(arr, myObj.addFoo, myObj); 
```

[http://jsfiddle.net/KpV5k/](http://jsfiddle.net/KpV5k/)

# android - 防止布局在背景后调整大小

> ID：15647036
> 
> 赞同：0
> 
> 时间：2013-03-26T20:44:35.930
> 
> 标签：android, background, android-relativelayout

我试图将背景设置为RelativeLayout。问题是布局在图像大小之后调整大小，这是我不想要的。我希望布局在两个文本视图之后调整大小。

无论如何要防止布局缩放到背景的大小？

这是xml代码

```
 <RelativeLayout
    android:id="@+id/hud"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="@+drawable/hud_background"
    android:layout_weight="1" >

    <TextView
        android:id="@+id/lblScore"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_centerVertical="true"
        android:text="Score: " />

    <TextView
        android:id="@+id/txtScore"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBaseline="@+id/lblScore"
        android:layout_alignBottom="@+id/lblScore"
        android:layout_toRightOf="@+id/lblScore"
        android:text="00" />

</RelativeLayout> 
```

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:18:00.500

我认为您需要的只是将 android:layout_width="match_parent" 更改为 android:layout_width="wrap_content" 的 relativeLayout，以便大小将仅根据 textViews。

为什么要添加 android:layout_weight="1" ？它只是您的布局文件的一部分吗？

如果是这样，如果它在垂直线性布局中，请使用：

```
android:layout_width="match_parent"
android:layout_height="0px" 
```

如果它在水平线性布局中，请使用：

```
android:layout_width="wrap_content"
android:layout_height="0px" 
```

# java - 使用 JNI CallBooleanMethod 的异常信号 11

> ID：15647038
> 
> 赞同：1
> 
> 时间：2013-03-26T20:44:38.017
> 
> 标签：java, java-native-interface

我在这一行得到一个 SIGNAL 11：

```
// Call bool isInternetConnection()
jboolean jReturnValue = env->CallBooleanMethod(mClass,mid); 
```

在这段代码中：

```
/**
 * Check if Internet Connection is ONLINE
 */
bool InterfaceJNI::isInternetConnected()
{
    JavaVM* jvm = JniHelper::getJavaVM();
    int status;
    JNIEnv *env;
    jmethodID mid;

    bool isAttached = false;
    bool returnValue = false;

    CCLog("InterfaceJNI isInternetConnected");

    // Get Status
    status = jvm->GetEnv((void **) &env, JNI_VERSION_1_6);

    if(status < 0)
    {
        CCLog("isInternetConnected Status < 0 Failed to get JNI Enviroment!!!");
        status = jvm->AttachCurrentThread(&env, NULL);
        CCLog("isInternetConnected Status 2: %d", status);
        if(status < 0)
        {
            CCLog("isInternetConnected Status < 0 !!!");
            return false;
        }
        isAttached = true;
        CCLog("isInternetConnected Status isAttached: %d", isAttached);
    }

    CCLog("isInternetConnected Status: %d", status);

    CCLog("isInternetConnected Finding Class....");
    jclass mClass = env->FindClass("org/example/SocialNetwork/CCSocialNetwork");

    // Get Static bool isInternetConnection()
    CCLog("isInternetConnected Getting method....");
    mid = env->GetMethodID(mClass, "isInternetConnection", "()Z");
    if (mid == 0)
    {
        CCLog("isInternetConnected FAIL GET METHOD STATIC");
        return false;
    }
    CCLog("isInternetConnected Calling method....");
    // Call bool isInternetConnection()
    jboolean jReturnValue = env->CallBooleanMethod(mClass,mid);
    CCLog("Call done ");
    // Convert value from Java to C++
    returnValue = (bool)jReturnValue;
    CCLog("isInternetConnected Done ");

    if(isAttached)
        jvm->DetachCurrentThread();

    // Change for return value
    return returnValue;
} 
```

但我不知道为什么。如果我使用“()V”进行 void 调用工作正常，但是当我尝试调用返回 bool no 的函数时。

到底是怎么回事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T07:53:48.980

它是静态方法吗？您在代码中的注释表明它是静态的，而您的方法调用不是。

如果它*不是*静态的，那么您将不得不`CallBooleanMethod`像现在这样使用对象而不是类来调用。否则，您将不得不`CallStaticBooleanMethod`与班级一起使用。

```
jobject someObject = <get or create the object somehow>
jboolean jReturnValue = env->CallBooleanMethod(someObject,mid); 
```

*或者*

```
jboolean jReturnValue = env->CallStaticBooleanMethod(mClass,mid); 
```

无论哪种方式，您都必须决定是否使用静态方法。

# c++ - 我可以将 C++ 用作 Windows Phone 8 的全功能开发语言吗？

> ID：15647040
> 
> 赞同：2
> 
> 时间：2013-03-26T20:44:43.363
> 
> 标签：c++, windows-phone-8

我是一名有经验的 C++ 开发人员，现在我想获得一些 Windows Phone 8 开发经验。我有兴趣可以使用 C++ 进行任何类型的 WinPhone 8 应用程序开发吗？还是C++在这个环境中只支持有限，我必须学习C#？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T20:59:48.707

是的，您可以将其用作主要的开发语言。话虽如此，如果您使用 C#，您的体验将会好得多，因为这是开发工具（WPF 设计器）打算使用的。此外，在行业中，我认为您将很难找到想要用 C++ 编写的通用应用程序的人，因为您不喜欢 C#。

# rest - REST 控制台指南

> ID：15647041
> 
> 赞同：1
> 
> 时间：2013-03-26T20:44:44.617
> 
> 标签：rest, console, google-chrome-devtools

我正在使用 REST 控制台；而且我不知道如何填写“请求有效负载”的原始正文？

这是我通过 chrome 开发工具 - Network- headers 获得的“表单数据”的一部分：

```
criteria:{"boardMember":{"value":"Include","isUsed":true},"workHistory":{"value":"CurrentAndPast","isUsed":true},"includePartialProfiles":{"value":true,"isUsed":true},"lastUpdated":{"value":0,"isUsed":true},"personName":{"value":"tayson","isUsed":true}} 
```

我应该注意到“请求标头”和“响应标头”确实匹配。有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T23:40:30.150

[你能在https://github.com/codeinchaos/restconsole/issues?state=open](https://github.com/codeinchaos/restconsole/issues?state=open)开一张票吗

# c# - 为什么 CloudBlobClient.BaseUri 添加尾部斜杠（有时）？

> ID：15647042
> 
> 赞同：1
> 
> 时间：2013-03-26T20:44:46.267
> 
> 标签：c#, uri

我开始认为这是一个错误，但我不确定。这是我的情况。

**设置信息**

我有一个允许上传到 Azure 存储 Blob 的网站，并且端点在 Web 配置中指定。基本网络配置包含

```
<blobEndpoint value="http://127.0.0.1:10000/devstoreaccount1" /> 
```

并且测试服务器 web 配置包含

```
<blobEndpoint value="https://myazureaccount.blob.core.windows.net" xdt:Transform="Replace" /> 
```

我有一个自定义配置处理程序来从 web 配置中检索值，就像这样

```
[ConfigurationProperty("blobEndpoint", IsRequired = true)]
public StringConfigurationElement BlobEndpoint
{
    get
    {
        return (StringConfigurationElement)base["blobEndpoint"];
    }
    set
    {
        base["blobEndpoint"] = value;
    }
} 
```

我像这样获得对存储帐户的引用

```
StorageCredentialsAccountAndKey credentials = 
     new StorageCredentialsAccountAndKey(
                     CloudStorageAccount.CloudStorageAccountName,
                     CloudStorageAccount.CloudStorageAccountKey);

this.cloudStorageAccount = new CloudStorageAccount(credentials, 
                     CloudStorageAccount.BlobEndpoint, 
                     CloudStorageAccount.QueueEndpoint, 
                     CloudStorageAccount.TableEndpoint); 
```

然后像这样获取对云 blob 客户端的引用

```
this.cloudBlobClient = this.cloudStorageAccount.CreateCloudBlobClient(); 
```

**手头的问题**

这是我开始得到不同结果的地方。

如果我使用存储模拟器端点 ( `http://127.0.0.1:10000/devstoreaccount1`) 并进行此调用

```
this.cloudBlobClient.BaseUri 
```

返回值为`http://127.0.0.1:10000/devstoreaccount1`

但是，如果我使用我的实际帐户端点 ( `https://myazureaccount.blob.core.windows.net`) 并进行相同的调用，则返回值为`https://myazureaccount.blob.core.windows.net/`.

注意末尾的斜杠。为什么在使用存储模拟器 uri 时**不**存在？或者为什么在使用真实账户 uri 时会出现**？**

**更新**

我从网络配置设置中逐步更新了一个 Uri，这是每个案例的输出

```
{https://myazureaccount.blob.core.windows.net/}
    AbsolutePath: "/"
    AbsoluteUri: "https://myazureaccount.blob.core.windows.net/"
    Authority: "myazureaccount.blob.core.windows.net"
    DnsSafeHost: "myazureaccount.blob.core.windows.net"
    Fragment: ""
    Host: "myazureaccount.blob.core.windows.net"
    HostNameType: Dns
    IsAbsoluteUri: true
    IsDefaultPort: true
    IsFile: false
    IsLoopback: false
    IsUnc: false
    LocalPath: "/"
    OriginalString: "https://myazureaccount.blob.core.windows.net"
    PathAndQuery: "/"
    Port: 443
    Query: ""
    Scheme: "https"
    Segments: {string[1]}
    UserEscaped: false
    UserInfo: ""

{http://127.0.0.1:10000/devstoreaccount1}
    AbsolutePath: "/devstoreaccount1"
    AbsoluteUri: "http://127.0.0.1:10000/devstoreaccount1"
    Authority: "127.0.0.1:10000"
    DnsSafeHost: "127.0.0.1"
    Fragment: ""
    Host: "127.0.0.1"
    HostNameType: IPv4
    IsAbsoluteUri: true
    IsDefaultPort: false
    IsFile: false
    IsLoopback: true
    IsUnc: false
    LocalPath: "/devstoreaccount1"
    OriginalString: "http://127.0.0.1:10000/devstoreaccount1"
    PathAndQuery: "/devstoreaccount1"
    Port: 10000
    Query: ""
    Scheme: "http"
    Segments: {string[2]}
    UserEscaped: false
    UserInfo: "" 
```

看来这实际上是`Uri`课程的问题，与`CloudBlobClient`. 我已经适当地更新了标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:31:23.483

听起来唯一可能导致这种情况的是

```
PathAndQuery: "/" 
```

删除它，事情应该锻炼得很好。此外，如果您需要测试 URI 类，我会非常快速地给您写一些内容，您可以使用这将节省您大量的时间和将来测试是否`URI Class`返回正确的主机的麻烦`

```
var uriList = new List<string>()
    {
        "https://myazureaccount.blob.core.windows.net",
        "https://myazureaccount1.blob.core.windows.net",
        "https://myazureaccount2.blob.core.windows.net"
    };

var holdList = uriList.Select(uriName => new Uri(uriName)).Select(uri => uri.Host).ToList(); 
```

# android - Android NetworkOnMainThreadException - 4.0 上的 ListView JSON 和 LazyAdapter

> ID：15647046
> 
> 赞同：-2
> 
> 时间：2013-03-26T20:45:19.787
> 
> 标签：android, json, eclipse, android-3.0-honeycomb

此代码使用来自 Web 上的 JSON 和 LazyAdapter 的数据更新 2 ListView 将图像从 URL 转换并放在 ListView 上，在 2.3 上工作正常，但在 Android 4.0 上不起作用。

这是代码

EventosActivity.java

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.eventos);

    hojeLista = new ArrayList<HashMap<String, String>>();
    proximosLista = new ArrayList<HashMap<String, String>>();

    new LoadEventos().execute();

}

/**
 * Background Async Task to Load all product by making HTTP Request
 * */
class LoadEventos extends AsyncTask<String, String, String> {

    /**
     * Before starting background thread Show Progress Dialog
     * */
    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        pDialog = new ProgressDialog(EventosActivity.this);
        pDialog.setMessage("Dando uma olhada aqui, peraê...");
        pDialog.setIndeterminate(false);
        pDialog.setCancelable(false);
        pDialog.show();
    }

    /**
     * getting All evento from url
     * */
    protected String doInBackground(String... args) {
        // Building Parameters
        List<NameValuePair> params = new ArrayList<NameValuePair>();
        // getting JSON string from URL
        JSONObject json = jParser.makeHttpRequest(url_hoje, "GET", params);
        JSONObject json2 = jParser.makeHttpRequest(url_proximos, "GET", params);

        try {
            // Checking for SUCCESS TAG
            int success = json.getInt(TAG_SUCCESS);
            int success2 = json2.getInt(TAG_SUCCESS);

            if (success == 1) {
                // evento found
                // Getting Array of Products
                evento = json.getJSONArray(TAG_EVENTO);

                // looping through All Products
                for (int i = 0; i < evento.length(); i++) {
                    JSONObject c = evento.getJSONObject(i);

                    // Storing each json item in variable
                    String id = c.getString(TAG_ID);
                    String titulo = c.getString(TAG_TITULO);
                    String local_nome = c.getString(TAG_LOCAL_NOME);
                    String data = c.getString(TAG_DATA);
                    String imagem = c.getString(TAG_IMAGEM);

                    //if ("16".equals(TAG_CLASSIFICACAO)) { }

                    // creating new HashMap
                    HashMap<String, String> map = new HashMap<String, String>();

                    // adding each child node to HashMap key => value
                    map.put(TAG_ID, id);
                    map.put(TAG_TITULO, titulo);
                    map.put(TAG_LOCAL_NOME, local_nome);
                    map.put(TAG_DATA, data);
                    map.put(TAG_IMAGEM, imagem);

                    // adding HashList to ArrayList
                    hojeLista.add(map);

                }
            }

            if (success2 == 1) {
                // evento found
                // Getting Array of Products
                evento = json2.getJSONArray(TAG_EVENTO);

                // looping through All Products
                for (int i = 0; i < evento.length(); i++) {
                    JSONObject c2 = evento.getJSONObject(i);

                    // Storing each json item in variable
                    String id = c2.getString(TAG_ID);
                    String titulo = c2.getString(TAG_TITULO);
                    String local_nome = c2.getString(TAG_LOCAL_NOME);
                    String data = c2.getString(TAG_DATA);
                    String imagem = c2.getString(TAG_IMAGEM);

                    //if ("16".equals(TAG_CLASSIFICACAO)) { }

                    // creating new HashMap
                    HashMap<String, String> map2 = new HashMap<String, String>();

                    // adding each child node to HashMap key => value
                    map2.put(TAG_ID, id);
                    map2.put(TAG_TITULO, titulo);
                    map2.put(TAG_LOCAL_NOME, local_nome);
                    map2.put(TAG_DATA, data);
                    map2.put(TAG_IMAGEM, imagem);

                    // adding HashList to ArrayList
                    proximosLista.add(map2);

                }
            }

        } catch (JSONException e) {
            e.printStackTrace();
        }

        return null;
    }

    /**
     * After completing background task Dismiss the progress dialog
     * **/
    protected void onPostExecute(String file_url) {
        // dismiss the dialog after getting all evento

        pDialog.dismiss();  

        // updating UI from Background Thread
        runOnUiThread(new Runnable() {
            public void run() {

                ListView list = (ListView)findViewById(android.R.id.list);
                ListView list2 = (ListView)findViewById(R.id.lvProximos);
           ks.     
                LazyAdapter adapter=new LazyAdapter(EventosActivity.this, hojeLista);
                list.setAdapter(adapter);

                LazyAdapter adapter2=new LazyAdapter(EventosActivity.this, proximosLista);
                list2.setAdapter(adapter2);

                list.setOnItemClickListener(new OnItemClickListener() {

                    @Override
                    public void onItemClick(AdapterView<?> parent, View view,
                            int position, long id) {
                        String id2 = ((TextView) view.findViewById(R.id.id)).getText().toString();

                        Intent in = new Intent(getApplicationContext(), EventoDetalheActivity.class);

                        in.putExtra(TAG_ID, id2);

                        startActivityForResult(in, 100);
                    }
                });

                list2.setOnItemClickListener(new OnItemClickListener() {

                    @Override
                    public void onItemClick(AdapterView<?> parent, View view,
                            int position, long id) {
                        String id2 = ((TextView) view.findViewById(R.id.id)).getText().toString();

                        Intent in = new Intent(getApplicationContext(), EventoDetalheActivity.class);

                        in.putExtra(TAG_ID, id2);

                        startActivityForResult(in, 100);
                    }
                });
            }
        });

    }

}} 
```

LazyAdapter.java

```
public class LazyAdapter extends BaseAdapter {
private Context activity;
private ArrayList<HashMap<String, String>> data;
private LayoutInflater inflater=null;
//public ImageLoader imageLoader; 
private URL url;
private Bitmap bmp;
public LazyAdapter(Context a, ArrayList<HashMap<String, String>> d) {
    activity = a;
    data=d;
    inflater = (LayoutInflater)activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    //imageLoader=new ImageLoader(activity.getApplicationContext());
}

public int getCount() {
    return data.size();
}

public Object getItem(int position) {
    return position;
}

public long getItemId(int position) {
    return position;
}

public View getView(int position, View convertView, ViewGroup parent) {
    View vi=convertView;
    if(convertView==null)
        vi = inflater.inflate(R.layout.eventoitem, null);
    TextView id = (TextView)vi.findViewById(R.id.id); 
    TextView titulo = (TextView)vi.findViewById(R.id.titulo); 
    TextView local_nome = (TextView)vi.findViewById(R.id.local_nome);
    TextView data0 = (TextView)vi.findViewById(R.id.data);
    ImageView im=(ImageView)vi.findViewById(R.id.imgImagem);

    HashMap<String, String> evento = new HashMap<String, String>();
    evento = data.get(position);

    // Setting all values in listview
    id.setText(evento.get("id"));
    titulo.setText(evento.get("titulo"));
    local_nome.setText(evento.get("local_nome"));
    data0.setText(evento.get("data"));

    try {
        url = new URL(evento.get("imagem"));
         bmp = BitmapFactory.decodeStream(url.openConnection().getInputStream());
           im.setImageBitmap(bmp);
    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    return vi;
} 
```

}

谢谢你帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T20:50:22.623

问题出在您的 getView 方法上，该方法在 UI 线程上运行，但您调用了一些使用互联网的东西。这是有问题的电话：

```
bmp = BitmapFactory.decodeStream(url.openConnection().getInputStream());
       im.setImageBitmap(bmp); 
```

对于某个版本的android（据我所知是蜂窝），这是不允许的，因为互联网使用可能需要一段时间，你不应该让用户界面等待它完成。

您找到了它是一件好事，因为如果设备上的互联网速度太慢而没有任何崩溃，它可能会导致 ANR。

解决它的一种方法是对每个视图使用 ViewHolder，它还将包括一个用于加载图像的 asyncTask，并在完成后将其设置为相关的 ImageView。如果 viewHolder 已经有一个任务，它应该被取消，因为它属于不再可见的东西。如果需要，您还可以添加缓存机制。

一般来说，如果你怀疑某个函数可能会运行很长时间（比如超过 1 秒），你应该让它在后台运行（或尝试真正改进它）而不是让 UI 线程处理它。原因是你会得到一个非流畅的应用程序，如果你让这个函数运行大约 5 秒左右，你也会得到一个 ANR。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T20:57:22.947

当您尝试从主 UI 线程进行网络相关操作时，会发生 NetworkOnMainThreadException。你应该在后台线程上做同样的事情，比如 asynctask。

在您的 getview 中，您正在下载位图。

```
bmp = BitmapFactory.decodeStream(url.openConnection().getInputStream());
   im.setImageBitmap(bmp); 
```

我同意安卓开发者。

您还应该使用来自 listview 的 viewholder。 [http://developer.android.com/training/improving-layouts/smooth-scrolling.html](http://developer.android.com/training/improving-layouts/smooth-scrolling.html)。

[http://www.youtube.com/watch?v=wDBM6wVEO70](http://www.youtube.com/watch?v=wDBM6wVEO70)。该视频对 Viewholder 和 listview 有很好的解释。

我建议您使用**通用图像加载器。**

延迟列表是使用 url 从 sdcard 或 fomr 服务器延迟加载图像。这就像按需加载图像。

图像可以缓存到本地sd卡或手机内存。Url 被认为是关键。如果密钥存在于 sdcard 中，则显示来自 sd 卡的图像，否则通过从服务器下载显示图像并将其缓存到您选择的位置。可以设置缓存限制。您还可以选择自己的位置来缓存图像。缓存也可以清除。

而不是用户等待下载大图像然后显示惰性列表按需加载图像。由于图像区域缓存，您可以离线显示图像。

[https://github.com/thest1/LazyList](https://github.com/thest1/LazyList)。懒惰列表

在你的 getview

```
imageLoader.DisplayImage(imageurl, imageview);
ImageLoader Display method

public void DisplayImage(String url, ImageView imageView) //url and imageview as parameters
{
imageViews.put(imageView, url);
Bitmap bitmap=memoryCache.get(url);   //get image from cache using url as key
if(bitmap!=null)         //if image exists
    imageView.setImageBitmap(bitmap);  //dispaly iamge
 else   //downlaod image and dispaly. add to cache.
 {
    queuePhoto(url, imageView);
    imageView.setImageResource(stub_id);
 }
 } 
```

惰性列表的替代方法是通用图像加载器

[https://github.com/nostra13/Android-Universal-Image-Loader](https://github.com/nostra13/Android-Universal-Image-Loader)。它基于惰性列表（工作原理相同）。但它还有很多其他配置。我更喜欢使用*Universal Image Loader*，因为它为您提供了更多配置选项。如果下载失败，您可以显示错误图像。可以显示带圆角的图像。可以缓存在磁盘或内存上。可以压缩图像。

在您的自定义适配器构造函数中

```
 File cacheDir = StorageUtils.getOwnCacheDirectory(context, "your folder");

 // Get singletone instance of ImageLoader
 imageLoader = ImageLoader.getInstance();
 // Create configuration for ImageLoader (all options are optional)
 ImageLoaderConfiguration config = new ImageLoaderConfiguration.Builder(a)
      // You can pass your own memory cache implementation
     .discCache(new UnlimitedDiscCache(cacheDir)) // You can pass your own disc cache implementation
     .discCacheFileNameGenerator(new HashCodeFileNameGenerator())
     .enableLogging()
     .build();
 // Initialize ImageLoader with created configuration. Do it once.
 imageLoader.init(config);
 options = new DisplayImageOptions.Builder()
 .showStubImage(R.drawable.stub_id)//display stub image
 .cacheInMemory()
 .cacheOnDisc()
 .displayer(new RoundedBitmapDisplayer(20))
 .build(); 
```

在你的 getView()

```
 ImageView image=(ImageView)vi.findViewById(R.id.imageview); 
 imageLoader.displayImage(imageurl, image,options);//provide imageurl, imageview and options 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:07:50.417

出于显而易见的原因，不建议这样做，但您可以将其添加到您的课程中：

```
StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build() 
StrictMode.setThreadPolicy(policy); 
```

# php - 改变数组的一部分

> ID：15647047
> 
> 赞同：-3
> 
> 时间：2013-03-26T20:45:20.207
> 
> 标签：php, arrays, multidimensional-array

我有这个数组，

```
Array
        (
            [0]Array
                (
                    [ftid] 2
                    [fname] Ho Type
                    [flabelid] Array
                        (
                            [0] 1000
                            [1] 1001
                            [2] 1002
                            [3] 1003
                            [4] 1004
                        )

                    [flabels] Array
                        (
                            [0] All
                            [1] Si Fam
                            [2] Toho
                            [3] Con Co
                            [4] Mob Ho
                        )

                )

            [1] Array
                (
                    [ftid] 3
                    [fname] Li Pri
                    [flabelid] Array
                        (
                            [0] 1000
                            [1] 1007
                            [2] 1008
                        )

                    [flabels] Array
                        (
                            [0] All
                            [1] 50M
                            [2] 50K

                        )

                )
        ) 
```

我将如何在不破坏数组的情况下更改`Ho Type`哪个。`fname`我的意思是只改变那个特定的部分？请帮忙。干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T20:50:57.443

```
$array[0]['fname'] = $new_value; 
```

考虑`$array`是您的数组的名称和`$new_value`作为新值

# ant - java.lang.NoClassDefFoundError 运行 ant 目标

> ID：15647055
> 
> 赞同：0
> 
> 时间：2013-03-26T20:45:46.167
> 
> 标签：ant

我有一个具有 java 编译目标的 ant 构建文件。相同的 Eclipse 发行版工作正常，并成功运行其他 ant 构建文件。但是在这个特定的工作空间中；当我运行 ant 目标时，它失败并出现以下错误：

```
 [javac] C:\MyProject\scripts\build.xml:119: warning: 'includeantruntime' was not set, defaulting to build.sysclasspath=last; set to false for repeatable builds
    [javac] Compiling 1 source file to C:\MyProject\build
    [javac] Compiling 9 source files to C:\MyProject\build
    [javac] java.lang.NoClassDefFoundError: com/sun/tools/javac/Main
    [javac] Exception in thread "main" Could not find the main class: com.sun.tools.javac.Main.  Program will exit.

BUILD FAILED 
```

我也尝试过从命令提示符运行构建文件并看到同样的问题。这是否指向任何明显的问题。日食设置了蚂蚁路径，我已经在日食中检查了它指向正确的位置。

我还验证了 tools.jar 也包含在项目路径中。

系统信息：

```
System info:
Windows 7 Enterprise edition, 64 bit
JDK 1.6b35
ANT 1.8.3 
```

任何建议都会有所帮助。

==================================================== ===========================

根据@MickJ 的请求，我还在使用诊断选项运行构建目标时添加输出（我在 Eclipse 中的任何构建运行配置中添加了 -diagnostics）

```
------- Ant diagnostics report -------
Apache Ant(TM) version 1.8.2 compiled on December 20 2010
-------------------------------------------
 Implementation Version
-------------------------------------------
core tasks     : 1.8.2 in file:/C:/ToolBox/apps/dumps/Eclipse3.7/plugins/org.apache.ant_1.8.2.v20120109-1030/lib/ant.jar
-------------------------------------------
 ANT PROPERTIES
-------------------------------------------
ant.version: Apache Ant(TM) version 1.8.2 compiled on December 20 2010
ant.java.version: 1.6
Is this the Apache Harmony VM? no
Is this the Kaffe VM? no
Is this gij/gcj? no
ant.core.lib: C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant.jar
ant.home: C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030
-------------------------------------------
 ANT_HOME/lib jar listing
-------------------------------------------
ant.home: C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030
ant-antlr.jar (5989 bytes)
ant-apache-bcel.jar (9097 bytes)
ant-apache-bsf.jar (4249 bytes)
ant-apache-log4j.jar (3361 bytes)
ant-apache-oro.jar (40276 bytes)
ant-apache-regexp.jar (4106 bytes)
ant-apache-resolver.jar (4418 bytes)
ant-apache-xalan2.jar (2633 bytes)
ant-commons-logging.jar (4207 bytes)
ant-commons-net.jar (85302 bytes)
ant-jai.jar (22684 bytes)
ant-javamail.jar (8167 bytes)
ant-jdepend.jar (8477 bytes)
ant-jmf.jar (7093 bytes)
ant-jsch.jar (40320 bytes)
ant-junit.jar (101811 bytes)
ant-junit4.jar (7517 bytes)
ant-launcher.jar (12567 bytes)
ant-netrexx.jar (10656 bytes)
ant-swing.jar (7847 bytes)
ant-testutil.jar (15576 bytes)
ant.jar (1927228 bytes)
-------------------------------------------
 USER_HOME/.ant/lib jar listing
-------------------------------------------
user.home: C:\Users\oo018c
No such directory.
-------------------------------------------
 Tasks availability
-------------------------------------------
image : Missing dependency javax.media.jai.PlanarImage
sshexec : Missing dependency com.jcraft.jsch.Logger
wlrun : Not Available (the implementation class is not present)
scp : Missing dependency com.jcraft.jsch.Logger
stlist : Not Available (the implementation class is not present)
sshsession : Missing dependency com.jcraft.jsch.Logger
starteam : Not Available (the implementation class is not present)
stlabel : Not Available (the implementation class is not present)
jdepend : Missing dependency jdepend.xmlui.JDepend
stcheckin : Not Available (the implementation class is not present)
stcheckout : Not Available (the implementation class is not present)
ejbc : Not Available (the implementation class is not present)
wlstop : Not Available (the implementation class is not present)
ddcreator : Not Available (the implementation class is not present)
A task being missing/unavailable should only matter if you are trying to use it
-------------------------------------------
 org.apache.env.Which diagnostics
-------------------------------------------
Not available.
Download it at http://xml.apache.org/commons/
-------------------------------------------
 XML Parser information
-------------------------------------------
XML Parser : com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl
XML Parser Location: unknown
Namespace-aware parser : com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser
Namespace-aware parser Location: unknown
-------------------------------------------
 XSLT Processor information
-------------------------------------------
XSLT Processor : com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl
XSLT Processor Location: unknown
-------------------------------------------
 System properties
-------------------------------------------
java.runtime.name : Java(TM) SE Runtime Environment
sun.boot.library.path : C:\Program Files\Java\jdk1.6.0_37\jre\bin
java.vm.version : 20.12-b01
ant.library.dir : C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib
java.vm.vendor : Sun Microsystems Inc.
java.vendor.url : http://java.sun.com/
path.separator : ;
java.vm.name : Java HotSpot(TM) 64-Bit Server VM
file.encoding.pkg : sun.io
user.country : US
sun.java.launcher : SUN_STANDARD
sun.os.patch.level : Service Pack 1
java.vm.specification.name : Java Virtual Machine Specification
user.dir : C:\ToolBox\work\ClearCase\oo018c_toolbox_test_data\vobs\toolbox_test_data\Projects\TestFixtures\scripts
java.runtime.version : 1.6.0_37-b06
java.awt.graphicsenv : sun.awt.Win32GraphicsEnvironment
java.endorsed.dirs : C:\Program Files\Java\jdk1.6.0_37\jre\lib\endorsed
os.arch : amd64
java.io.tmpdir : C:\Users\oo018c\AppData\Local\Temp\
line.separator : 
java.vm.specification.vendor : Sun Microsystems Inc.
user.variant : 
os.name : Windows 7
ant.home : C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030
sun.jnu.encoding : Cp1252
java.library.path : C:\Windows\system32;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\oracle\11gR2client64bit\bin;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program Files\Gemalto\Classic Client\BIN;C:\Program Files (x86)\Gemalto\Classic Client\BIN;C:\Program Files (x86)\Common Files\ACD Systems\EN;C:\Program Files (x86)\Common Files\ACD Systems;C:\Program Files\Intel\WiFi\bin\;C:\Program Files\Common Files\Intel\WirelessCommon\;C:\Program Files\Adobe\Adobe PDF iFilter 9 for 64-bit platforms\bin\;C:\Program Files (x86)\IBM\RationalSDLC\ClearCase\bin;C:\Program Files (x86)\IBM\RationalSDLC\common;C:\oracle\11gR2client32bit\bin\;C:\Program Files\Java\jdk1.6.0_37\bin;C:\Program Files (x86)\Git\cmd;C:\Program Files (x86)\Git\bin;C:\ToolBox\apps\dumps\mongodb-2.0.4\bin;C:\ToolBox\apps\dumps\scala-2.9.2\bin;C:\ToolBox\apps\dumps\Ant1.8.3\bin;C:\ToolBox\apps\dumps\apache-maven-3.0.4\bin;C:\ToolBox\apps\dumps\ccrccli_8.0.0.2;C:\ToolBox\apps\dumps\apache-tomcat-6.0.20\bin;C:\ToolBox\apps\dumps\Eclipse-TPTP-AgentControllerWinEM64T-4.7.2\plugins\org.eclipse.tptp.javaprofiler;C:\ToolBox\apps\dumps\Eclipse-TPTP-AgentControllerWinEM64T-4.7.2\bin;c:\cygwin\bin;c:\cygwin\usr\bin;.;C:\ToolBox\apps\dumps\Eclipse3.7\configuration\org.eclipse.osgi\bundles\778\1\.cp
java.specification.name : Java Platform API Specification
java.class.version : 50.0
sun.management.compiler : HotSpot 64-Bit Tiered Compilers
os.version : 6.1
user.home : C:\Users\oo018c
user.timezone : America/Los_Angeles
java.awt.printerjob : sun.awt.windows.WPrinterJob
file.encoding : UTF-8
java.specification.version : 1.6
user.name : oo018c
java.class.path : C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-antlr.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-apache-bcel.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-apache-bsf.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-apache-log4j.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-apache-oro.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-apache-regexp.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-apache-resolver.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-apache-xalan2.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-commons-logging.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-commons-net.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-jai.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-javamail.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-jdepend.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-jmf.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-jsch.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-junit.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-junit4.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-launcher.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-netrexx.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-swing.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant-testutil.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030\lib\ant.jar;C:\ToolBox\apps\dumps\Eclipse3.7\configuration\org.eclipse.osgi\bundles\182\1\.cp\lib\antdebug.jar;C:\ToolBox\apps\dumps\Eclipse3.7\configuration\org.eclipse.osgi\bundles\182\1\.cp\lib\remote.jar;C:\ToolBox\apps\dumps\Eclipse3.7\configuration\org.eclipse.osgi\bundles\183\1\.cp\lib\remoteAnt.jar;C:\Program Files\Java\jdk1.6.0_37\lib\tools.jar;C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.eclipse.swt.win32.win32.x86_64_3.7.2.v3740f.jar
java.vm.specification.version : 1.0
sun.arch.data.model : 64
java.home : C:\Program Files\Java\jdk1.6.0_37\jre
sun.java.command : org.eclipse.ant.internal.launching.remote.InternalAntRunner -diagnostics -Dorg.eclipse.ant.core.ANT_PROCESS_ID=1364337380010 -Declipse.connect.port=51250 -Declipse.pdebuild.home=/C:/ToolBox/apps/dumps/Eclipse3.7/plugins/org.eclipse.pde.build_3.7.0.v20111116-2009/./ -Declipse.pdebuild.scripts=/C:/ToolBox/apps/dumps/Eclipse3.7/plugins/org.eclipse.pde.build_3.7.0.v20111116-2009/scripts/ -Declipse.pdebuild.templates=/C:/ToolBox/apps/dumps/Eclipse3.7/plugins/org.eclipse.pde.build_3.7.0.v20111116-2009/templates/ -Dant.home=C:\ToolBox\apps\dumps\Eclipse3.7\plugins\org.apache.ant_1.8.2.v20120109-1030 -logger org.eclipse.ant.internal.launching.remote.logger.RemoteAntBuildLogger -inputhandler org.eclipse.ant.internal.ui.antsupport.inputhandler.ProxyInputHandler -buildfile C:\ToolBox\work\ClearCase\oo018c_toolbox_test_data\vobs\toolbox_test_data\Projects\TestFixtures\scripts\build.xml CC.compile
java.specification.vendor : Sun Microsystems Inc.
user.language : en
awt.toolkit : sun.awt.windows.WToolkit
java.vm.info : mixed mode
java.version : 1.6.0_37
java.ext.dirs : C:\Program Files\Java\jdk1.6.0_37\jre\lib\ext;C:\Windows\Sun\Java\lib\ext
sun.boot.class.path : C:\Program Files\Java\jdk1.6.0_37\jre\lib\resources.jar;C:\Program Files\Java\jdk1.6.0_37\jre\lib\rt.jar;C:\Program Files\Java\jdk1.6.0_37\jre\lib\sunrsasign.jar;C:\Program Files\Java\jdk1.6.0_37\jre\lib\jsse.jar;C:\Program Files\Java\jdk1.6.0_37\jre\lib\jce.jar;C:\Program Files\Java\jdk1.6.0_37\jre\lib\charsets.jar;C:\Program Files\Java\jdk1.6.0_37\jre\lib\modules\jdk.boot.jar;C:\Program Files\Java\jdk1.6.0_37\jre\classes
java.vendor : Sun Microsystems Inc.
file.separator : \
java.vendor.url.bug : http://java.sun.com/cgi-bin/bugreport.cgi
sun.cpu.endian : little
sun.io.unicode.encoding : UnicodeLittle
sun.desktop : windows
sun.cpu.isalist : amd64
-------------------------------------------
 Temp dir
-------------------------------------------
Temp dir is C:\Users\oo018c\AppData\Local\Temp\
Temp dir is writeable
Temp dir alignment with system clock is 33 ms
-------------------------------------------
 Locale information
-------------------------------------------
Timezone Pacific Standard Time offset=-25200000
-------------------------------------------
 Proxy information
-------------------------------------------
Java1.5+ proxy settings:
Direct connection
Total time: 1 second 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T20:52:17.237

Can you try adding your J2SE - **jdk**/bin directory path to system 'path' variable. Go to 'my computer' -> right click -> properties -> advanced -> environment variables -> system variables -> path and append a semicolon followed by your jdk bin path. Or else make sure ant.bat is setting the correct java home to a jdk.

Can you double check to make sure your 'JAVA_HOME' is set to "C:\Program Files\Java\jdk1.6.0_37".

Go to 'my computer' -> right click -> properties -> advanced -> environment variables -> system variables -> (If JAVA_HOME is not already there then 'new' else pick JAVA_HOME) and set the value to 'C:\Program Files\Java\jdk1.6.0_37'(no quotes).

Now close and start a fresh console and try running your ant script.

Alternatively you could just fire the following in the console before starting your ant script:

set JAVA_HOME=C:\Progra~1\Java\jdk1.6.0_37

# c++ - 从 C++ 到 C 的 OpenCV 转换

> ID：15647058
> 
> 赞同：-2
> 
> 时间：2013-03-26T20:46:08.120
> 
> 标签：c++, c, opencv

我有一个需要转换为 C 的 C++ openCV 代码。但是我找不到指南来检查我应该使用什么而不是

> cvScalar、cvNamedWindow、cvSmooth

另外，如果您在我的代码中发现任何其他问题，您能告诉我吗？

```
#include "cv.h"
#include "highgui.h"
#include "cxcore.h"
#include <stdio.h>

IplImage* Threshold(IplImage* src)
{

    IplImage* srcHSV = cvCreateImage(cvGetSize(src), 8, 3);
    cvCvtColor(src, srcHSV, CV_BGR2HSV);// Convert the BGR to HSV

    IplImage* Thresholdimg = cvCreateImage(cvGetSize(src), 8, 1); // create a Threshold image

    // HSV tresholding
cvInRangeS(srcHSV, CvScalar(7, 107, 219), CvScalar(11,148,255), Thresholdimg);

    cvSmooth( Thresholdimg, Thresholdimg, CV_GAUSSIAN, 9, 9 ); // Smoothing with a Gaussian filter (9*9 kernel)

    cvReleaseImage(&srcHSV);

    return Thresholdimg;
}

int main()
{

    CvCapture* capture = 0;
    capture = cvCaptureFromCAM(1);// 1 for usb webcam, 0 o/w.

    if(!capture)
    {
        printf("Can not capture,no device found\n");
        return -1;
    }

    // Windows for Threshold and Output
    cvNamedWindow("Tracking output");
    cvNamedWindow("Threshold");

    while(1) // infinite loop
    {

        IplImage* frame = 0;
        frame = cvQueryFrame(capture); // decompress the captured frame

        if(!frame)
            break;

        IplImage* finalthreshold = Threshold(frame);

        cvShowImage("Threshold", finalthreshold);//show the thresholded image

        CvMemStorage*  storage  = cvCreateMemStorage(0);// allocate memory to store the contour information

        CvSeq* circles = cvHoughCircles(finalthreshold, storage, CV_HOUGH_GRADIENT, 2, finalthreshold->height/4, 100, 40, 20, 200);

        int i;
        for (i = 0; i < circles->total; i++)
        {

            float *p = (float*)cvGetSeqElem(circles, i);
            printf("Ball! x=%f y=%f r=%f\n\r",p[0],p[1],p[2] );
            CvPoint center = cvPoint(cvRound(p[0]),cvRound(p[1]));
            CvScalar val = cvGet2D(finalthreshold, center.y, center.x);

            if (val.val[0] < 1) continue;
            cvCircle(frame,  center, 3,             CV_RGB(0,255,0), -1, CV_AA, 0);
            cvCircle(frame,  center, cvRound(p[2]), CV_RGB(255,0,0),  3, CV_AA, 0);
            cvCircle(finalthreshold, center, 3,             CV_RGB(0,255,0), -1, CV_AA, 0);
            cvCircle(finalthreshold, center, cvRound(p[2]), CV_RGB(255,0,0),  3, CV_AA, 0);
        }

         cvShowImage("Tracking output", frame);

         int c = cvWaitKey(27);
         if(c!=-1)
             break;

         cvReleaseImage(&finalthreshold);

    }

    cvReleaseCapture(&capture);
    return 0;
} 
```

以下是错误：

```
root@ghostrider:/home/zero/Desktop/deneme opencv# opencv untitled.c 
compiling untitled.c
untitled.c: In function ‘Threshold’:
untitled.c:17:2: error: too few arguments to function ‘cvScalar’
In file included from /usr/local/include/opencv2/core/core_c.h:47:0,
                 from /usr/local/include/opencv/cv.h:63,
                 from untitled.c:1:
/usr/local/include/opencv2/core/types_c.h:1224:22: note: declared here
untitled.c:17:2: error: too few arguments to function ‘cvScalar’
In file included from /usr/local/include/opencv2/core/core_c.h:47:0,
                 from /usr/local/include/opencv/cv.h:63,
                 from untitled.c:1:
/usr/local/include/opencv2/core/types_c.h:1224:22: note: declared here
untitled.c:19:2: error: too few arguments to function ‘cvSmooth’
In file included from /usr/local/include/opencv/cv.h:65:0,
                 from untitled.c:1:
/usr/local/include/opencv2/imgproc/imgproc_c.h:81:13: note: declared here
untitled.c: In function ‘main’:
untitled.c:42:2: error: too few arguments to function ‘cvNamedWindow’
In file included from /usr/local/include/opencv/highgui.h:47:0,
                 from untitled.c:2:
/usr/local/include/opencv2/highgui/highgui_c.h:120:12: note: declared here
untitled.c:43:2: error: too few arguments to function ‘cvNamedWindow’
In file included from /usr/local/include/opencv/highgui.h:47:0,
                 from untitled.c:2:
/usr/local/include/opencv2/highgui/highgui_c.h:120:12: note: declared here
Output file => untitled 
```

第 1224 行`/usr/local/include/opencv2/core/types_c.h`

```
CV_INLINE  CvScalar  cvScalar( double val0, double val1 CV_DEFAULT(0),
                               double val2 CV_DEFAULT(0), double val3 CV_DEFAULT(0)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T20:55:45.657

您提到的构造以您给出的名称存在于 C 中。您可以继续使用它们，使用 C API 而不是 C++ API。

[`cvScalar`](http://opencv.willowgarage.com/documentation/c/basic_structures.html#cvscalar)

[`cvNamedWindow`](http://opencv.willowgarage.com/documentation/c/user_interface.html#namedwindow)

[`cvSmooth`](http://opencv.willowgarage.com/documentation/c/image_filtering.html#smooth)

**编辑：** 请注意，C 实现没有默认参数。您需要为每个函数提供所有参数，即使您只是粘贴默认参数。

有关更多信息，请参阅[此问题](https://stackoverflow.com/questions/5371166)。

# mysql - mysql合并多个select语句结果

> ID：15647059
> 
> 赞同：1
> 
> 时间：2013-03-26T20:46:09.897
> 
> 标签：mysql

我有 2 个选择语句从 2 个表中为同一个人提取数据。我知道它们可以通过连接进行组合，但我无法让语法为我工作。

查询一：

```
SELECT SUBSTRING_INDEX(username,'@',1) AS username, 
COUNT(username) as count,
ROUND(
SUM(
CONVERT(SUBSTRING(contribution_score, -2), UNSIGNED INTEGER)  +
CONVERT(SUBSTRING(focused_score, -2), UNSIGNED INTEGER)  +
CONVERT(SUBSTRING(prepared_score, -2), UNSIGNED INTEGER) + 
CONVERT(SUBSTRING(work_score, -2), UNSIGNED INTEGER)  
)/COUNT(username)/76*100)
as average

FROM project_rubrics
GROUP BY username
LIMIT 0, 90 
```

查询 2：

```
SELECT username,COUNT(username) as days FROM logon GROUP BY username 
```

公共链接是用户名字段。
我想要一个结果集，它为每个学生提供用户名、天数和平均值，但我无法让加入或组合选择工作。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:00:15.217

你可以做一个子查询。

```
SELECT SUBSTRING_INDEX(username,'@',1) AS username, 
COUNT(username) as count,
ROUND(
SUM(
CONVERT(SUBSTRING(contribution_score, -2), UNSIGNED INTEGER)  +
CONVERT(SUBSTRING(focused_score, -2), UNSIGNED INTEGER)  +
CONVERT(SUBSTRING(prepared_score, -2), UNSIGNED INTEGER) + 
CONVERT(SUBSTRING(work_score, -2), UNSIGNED INTEGER)  
)/COUNT(username)/76*100)
as average,

(SELECT COUNT(username) as days FROM logon WHERE logon.username=project_rubrics.username GROUP BY username) as username_count

FROM project_rubrics
GROUP BY username
LIMIT 0, 90 
```

# javascript - dojotype="dijit.form.FilteringSelect" 导致 'options.length' 为空或不是对象 javascript 错误

> ID：15647069
> 
> 赞同：0
> 
> 时间：2013-03-26T20:46:59.090
> 
> 标签：javascript, jsp, dojo

在执行下面的代码时，我得到了 javascript 错误 'options.length' is null or not an object。但是，当我在选择标记内的 jsp 中删除“dojotype =”dijit.form.FilteringSelect”时，它工作正常。当 dojotype 属性不在代码中时，警报会打印正确的值，但当 dojotype 属性存在时显示为空白。我不确定是什么导致了问题。请求您的宝贵帮助。谢谢。

```
.jsp

<select name="shoppingCategoryCode1"      
id="shoppingCategoryCode1"       onchange="RatePlan.onchangeShoppingCategory();
RatePlan.updateStatus(true);"
dojotype="dijit.form.FilteringSelect"              
isValid = "RatePlan.shoppingCategoryIsValid1"
invalidMessage="<spring:message 
code='rateplan.validation.shopping.category.validation'/>"
>

.js

var sel=dojo.byId("shoppingCategoryCode1");
    alert(sel.options.length);
    for(var i = 0; i < sel.options.length; i++) {
        if(sel.options[i].value == "WHOLE") {
            sel.selectedIndex = i;
            break;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T12:21:12.720

这是因为当您将 shoppingCategoryCode1 转换为 Select 小部件时，它不再是`<select>`DOM 元素。使用您最喜欢的浏览器开发工具并检查对象；你会看到它用表格和隐藏的输入做了一些疯狂的事情。

如果您的目标是选择特定选项，请尝试类似`dijit.byId("shoppingCategoryCode1").set("value", "WHOLE")`

# powershell - Powershell - 更改为 MB 而不是 GB

> ID：15647071
> 
> 赞同：0
> 
> 时间：2013-03-26T20:47:04.120
> 
> 标签：powershell, exchange-server-2010

所以基本上我有一个脚本：

```
$MailboxArray = New-Object System.Object

$MailboxArray | Add-Member -MemberType NoteProperty -value $mail.issuewarningquota -Name WarningQuota 
```

以及 $mail:

```
$mail = get-mailbox -id $_ 
```

现在它在 For 循环中很好地获取 Exchange 中每个邮箱的信息，但我希望 IssueWarningQuota 输出在`MB`而不是`GB`.

我有一个 TotalItemSize 方法，其中：

```
TotalItemSize.value.ToMB() 
```

但这对 IssueWarningQuota 不起作用/不会起作用，有什么办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T00:28:10.090

我不知道交换命令的语法，但如果 TotoalItemSize 是一个数字，PowerShell 非常擅长计算 MB 和 GB。

例子：

```
PS C:\> $number = 4294967296
PS C:\> $number / 1GB
4
PS C:\> $number / 1MB
4096 
```

因此，只要它是 Int32 或 Double 之类的数字，您就应该能够对其执行类似操作以转换为 MB。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:05:17.497

```
$MBXs = Get-Mailbox -Server Server01 -ResultSize unlimited |
 Where {$_.UseDatabaseQuotaDefaults -eq $false} 

 &{
 foreach ($MBX in $MBXs)
 {
  New-Object psobject -Property @{
   Displayname = $MBX.Displayname
   'WarningQuota (MB)' = ($MBX.IssueWarningQuota).Value.ToMB()
   'ProhibitSendQuota (MB)' = ($MBX.ProhibitSendQuota).Value.ToMB()
   'TotalItemSize (MB)' = (Get-MailboxStatistics $MBX).TotalItemSize.Value.ToMB()
   }
  }
 } | Select Displayname,'WarningQuota (MB)','ProhibitSendQuota (MB)','TotalItemSize (MB)' 
```

# ios - 如果一个强属性有一个引用自身的块，那是一个保留循环吗？

> ID：15647074
> 
> 赞同：1
> 
> 时间：2013-03-26T20:47:15.593
> 
> 标签：ios, objective-c, objective-c-blocks

例如：

```
[self.contentWrapperView addGestureRecognizer:
   [UITapGestureRecognizer recognizerWithHandler:^(UIGestureRecognizer *sender, 
                                                   UIGestureRecognizerState state, 
                                                   CGPoint location) {
        if (self.customEditing) {
        [self setEditingMode:NO Animated:YES];
      }
    }]]; 
```

Where`contentWrapperView`是 上的一个强属性`self`，并且假定`contentWrapperView`对识别器块有一个强引用。在块中使用`self`会导致保留周期吗？这是唯一我不太明白的部分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T20:51:11.080

是的，它会导致一个保留周期。

万一您关心的解决方法是

```
__weak id weakSelf = self;
[self.contentWrapperView addGestureRecognizer:[UITapGestureRecognizer recognizerWithHandler:^(UIGestureRecognizer *sender, UIGestureRecognizerState state, CGPoint location) {
    if ([weakSelf customEditing]) {
        [weakSelf setEditingMode:NO Animated:YES];
    }
}]]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-26T21:06:44.053

根据实际情况考虑保留周期：您拥有的对象保留您自己。

用 Cocoa 和 Cocoa-Touch 的术语来说，这意味着你*强烈*拥有的任何变量都不能反过来强烈拥有*你*。这通常通过声明需要拥有其父级的属性来解决`weak`，`unsafe_unretained`或者`assign`. 这会因块而变得复杂，这些块通常像闭包一样捕获对其中每个变量的 const 或保留引用（显然，`__block`限定符会进一步复杂化）。

我不会从块的角度来看这个，而是尝试将它抽象为一个包含两个类的示例，这对于那些使用 OO 语言的人来说通常更容易理解：

假设我有课`MyImportantObject`，需要与另一个课做一些工作`MyWorkerClass`。我们通常需要对 的强引用`MyWorkerClass`，因为也许我们希望它保留下来，以便我们以后可以做更多的工作，或者继续一遍又一遍地调用相同的工作方法：

```
@interface MyImportantObject : NSObject 

@property (nonatomic, strong) MyWorkerClass *workerObj;

@end 
```

反过来，我们的 worker 需要一个稳定的引用来引用`MyImportantObject`它需要工作的所有属性（否则它不能*工作*！）。那么该引用`self`的作用是什么，而不是对每个变量采用 const 或保留引用，而是对其父级采用保留引用！

```
@interface MyWorkerClass : NSObject 

@property (nonatomic, strong) MyImportantObject *workerObj;

@end 
```

这意味着如果您尝试使用`MyImportantObject`'worker 对象，它们会相互保留，并且都不会被正确释放！巨大的不，不。

通过分流`self`到一个`__weak`（或`__block`在 MRC 下）指针，我们得到一个如下所示的引用：

```
@interface MyWorkerClass : NSObject 

@property (nonatomic, weak) MyImportantObject *workerObj;

@end 
```

没有更多的保留周期，每个人都很开心，当父母走恐龙的道路时，每个人都会被正确地释放。

但还有一个难题：我们如何处理`weak`参考？毕竟，假设好的 ol' 编译器出现并`self`快速从你下面拉出来`-release`。由于该归零弱指针，您现在有一个 nil 指针在您的块中运行异常。这可能导致它实际上什么都不做，而您坐在那里挠头想知道为什么。这导致了我将称之为弱-强舞蹈的发明。

J_mcnally 的示例缺少关键的一步，即自我指针的“重新强化”。但是，在我们竭尽全力避免保留循环之后，为什么还要这样做呢？这是因为我们的 X 的强副本没有被块保留，它被块的*范围*保留。用英语来说，这意味着我们的 strong`self`只会在到达块末尾时释放，因此不仅保证了安全的内存周期，而且它不会从我们下面被释放。正确的修复如下所示：

```
__weak id weakSelf = self;
[self.contentWrapperView addGestureRecognizer:[UITapGestureRecognizer recognizerWithHandler:^(UIGestureRecognizer *sender, UIGestureRecognizerState state, CGPoint location) {
    id strongSelf = weakSelf;
    if ([strongSelf customEditing]) {
        [strongSelf setEditingMode:NO Animated:YES];
    }
    //Do some other stuff before strongSelf passes out of scope.
}]]; 
```

# java - 我可以以更好的方式加入线程吗？

> ID：15647075
> 
> 赞同：1
> 
> 时间：2013-03-26T20:47:22.480
> 
> 标签：java, multithreading, concurrency

假设我在一个程序中有多个 Runnable 实例，全部由一个 Executor 实例调度。此外，假设我在某些时候需要等待这些可运行文件的一个子集完成，然后再继续。

我可以这样做的一种方法是：

```
public abstract class Joinable implements Runnable {

    private final Semaphore finishedLock = new Semaphore(1);

    @Override
    public final void run() {
        try {
            finishedLock.acquireUninterruptibly();
            doWork();
        } finally {
            finishedLock.release();
        }
    }

    public abstract void doWork();

    public void join() {
        finishedLock.acquireUninterruptibly();
    }
} 
```

然后实现类可以简单地覆盖 doWork()，而不是 run()，以便定义在执行期间应该做什么。

加入过程将如下所示：

```
void doStuff() {

    Executor executor = Executors.newCachedThreadPool();

    List<Joinable> joinables = new LinkedList<Joinable>();
    // Fill joinables with implementors of Joinable...

    List<Runnable> others = new LinkedList<Runnable>();
    // Fill others with implementors of Runnable...

    for(Joinable joinable : joinables) 
        executor.execute(joinable);

    for(Runnable runnable : others) 
        executor.execute(runnable);

    for(Joinable joinable : joinables) 
        joinable.join();

    // Continue, no matter what the threads in others are up to.
} 
```

这是解决这个问题的好方法（它甚至安全吗？），还是有更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:02:05.777

您当前的解决方案不是线程安全的。无法保证执行人会`run`在`Joinable`您致电之前致电您`join`。因此，在某些情况下，您的主线程将在您之前获得锁`Joinable`。

`CountDownLatch`如果您知道 joinables 的总数，则可能的解决方案是使用 a ，然后`N`创建 a`CountDownLatch(N)`并将其传递给每个实例。当每个可连接对象完成后，调用`countDown()`. 您的主线程调用`await()`闩锁。 `await()`在锁存器计数为 0 之前不会返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T20:57:30.307

> 这是解决这个问题的好方法吗（它甚至安全吗？）

这不太对。您无法加入`Runnable`您正在执行的`ExecutorService`. 如果您想使用列表，请执行以下操作：

```
List<Future<?>> futures = new ArrayList<Future<?>>();
for(Joinable joinable : joinables) {
   // this submit returns a `Future`.
   futures.add(executor.submit(joinable));
}
// submit others to the executor _without_ adding to the futures list

for (Future<?> future : futures) {
    // this can throw ExecutionException which wraps exception thrown by task
    future.get();
} 
```

> 还是有更好的？

如果您正在等待*所有*任务完成，那么您可以使用该`ExecutorService.awaitTermination(long timeout, TimeUnit unit)`方法。例如：

```
executor.awaitTerminate(Long.MAX_VALUE, TimeUnit.MILLISECONDS); 
```

但是，如果您正在等待任务的子集，我看不出有更好的方法来做到这一点。

# angularjs - Angular - 模型的默认值

> ID：15647079
> 
> 赞同：-2
> 
> 时间：2013-03-26T20:47:32.703
> 
> 标签：angularjs

假设我有一些 html 如下：

```
<html>
<head> angular etc. </head>
<body ng-app>
<div ng-controller="MyCtrl"> 
      <input ng-model="weight" type="number" min="{{minWeight}}" max="{{maxWeight}}">
      <p>{{weight}}</p>
</div>
</body>
</html> 
```

和以下控制器：

```
function MyCtrl($scope){
    $scope.weight = 200;
    $scope.minWeight = 100.0;
    $scope.maxWeight = 300.0;

} 
```

“min”和“max”将向用户显示他们的输入是错误的，如果我将它们硬编码为 100 和 300，它将确保该值根本不会绑定到模型（为什么不是行为相同？？）。如果值满足输入要求，我想做的只是实际更改“权重”。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:05:31.997

我不完全明白你想做什么。

HTML：

```
<html>
<head> angular etc. </head>
<body ng-app="MyApp">
<div ng-controller="MyCtrl"> 
      <input ng-model="weight" type="number" min="{{minWeight}}" max="{{maxWeight}}">
      <p>{{weight}}</p>
</div>
</body>
</html> 
```

角度：**[编辑]**

```
var app = angular.module('myApp', []);

app.controller('MyCtrl', ['$scope', function MyCtrl($scope){
    $scope.weight = 200;
    $scope.minWeight = 100.0;
    $scope.maxWeight = 300.0;

    $scope.$watch('weight', function (newValue, oldValue) {
        if(typeof newValue === 'number') {
            if(newValue > $scope.maxWeight || newValue < $scope.minWeight) {
                $scope.weight = oldValue;
            }
        }
    });
}]); 
```

但这是我在 jsFiddle 中制作的一个示例。我希望这是您正在寻找的解决方案。

**[编辑]**

[http://jsfiddle.net/migontech/jfDd2/1/](http://jsfiddle.net/migontech/jfDd2/1/)

**[编辑 2]**

我制定了一个指令，延迟验证您的输入字段。如果它不正确，则将其设置回最后的正确值。这是完全基本的。您可以将其扩展为是否小于允许使用最小值，如果大于允许使用最大值，则完全取决于您。您可以根据需要更改指令。

[http://jsfiddle.net/migontech/jfDd2/2/](http://jsfiddle.net/migontech/jfDd2/2/)

如果您有任何问题，请告诉我。

# hadoop - Hive 中的列编码

> ID：15647082
> 
> 赞同：2
> 
> 时间：2013-03-26T20:47:39.543
> 
> 标签：hadoop, hive, sqoop

我正在使用 Sqoop 将表从 mysql 导入配置单元。有些列是 latin1 编码的。有什么办法可以做到：

1.  在 Hive 中将这些列的编码设置为 latin1。或者
2.  使用 sqoop 导入时将列转换为 utf-8？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T00:24:27.063

在 Hive 中 --default-character-set 用于设置整个数据库的字符集，而不是特定于几列。我无法找到 Sqoop 参数，该参数会将表列转换为 utf-8，而是希望列将类型设置为固定。

```
$ sqoop import --connect jdbc:mysql://server.foo.com/db --table bar \
--direct -- --default-character-set=latin1 
```

我相信您需要先在 MySql 中将 Latin1 列转换为 utf-8，然后您可以从 Sqoop 导入。您可以使用以下脚本将所有列转换为我在 [此处](http://www.commandlinefu.com/commands/view/1575/convert-all-mysql-tables-and-fields-to-utf8)找到的 utf-8 。

```
mysql --database=dbname -B -N -e "SHOW TABLES" | \
awk '{print "ALTER TABLE", $1, "CONVERT TO CHARACTER SET utf8 COLLATE \
utf8_general_ci;"}' | mysql --database=dbname & 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T01:10:31.453

原来这个问题是无关的。无论编码如何，该列都可以正常工作...但是表的架构在 mysql 中已更改。我假设因为我传入了覆盖标志，所以每次在 Hive 中，sqoop 都会重新制作表。不是这样！mysql 中的架构更改没有传输到 Hive，因此 md5 列中的数据实际上是来自不同列的数据。

我们确定的“修复”是，在每次 sqoop 导入检查模式更改之前，如果有更改，删除表并重新导入。这会强制 Hive 中的架构更新。

编辑：我原来的 sqoop 命令是这样的：

```
sqoop import --connect jdbc:mysql://HOST:PORT/DB --username USERNAME --password PASSWORD --table uploads --hive-table uploads --hive-import --hive-overwrite --split-by id --num-mappers 8 --hive-drop-import-delims --null-string '\\N' --null-non-string '\\N' 
```

`drop table uploads`但是现在，如果架构发生变化，我首先手动发出一个配置单元。

# html - 歌曲完成后如何使用音频标签播放下一个“播放器”

> ID：15647083
> 
> 赞同：0
> 
> 时间：2013-03-26T20:47:42.607
> 
> 标签：html, audio, tags, html5-audio

我有[这个](https://elijahlucian.blogspot.com)博客，我在其中发布音乐草图。现在我从一个不能在手机上运行的笨重的 Flash 播放器切换后使用 HTML5 标记来播放音频......

本质上，我正在尝试制作它，以便播放器在播放`<audio>`完后搜索下一个标签。这可以使用博客吗？

我是否需要访问高端页面才能加载某种 JavaScript？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:41:11.827

可能是这样的？ [http://codepen.io/nickcolley/pen/fBwJs](http://codepen.io/nickcolley/pen/fBwJs)

```
//Grab all audio elenents
var audio = document.getElementsByTagName('audio');
//Create listeners
for (var i = 0; i < audio.length; i++) {
    audioListeners(i);
}
function audioListeners(i) {
    audio[i].addEventListener('ended', function() { 
      this.duration = 0; 
      this.pause();
      audio[i+1].play();
    }, false);
} 
```

# json - 如果不是来自 URL，如何在 R 中解析 JSON

> ID：15647095
> 
> 赞同：2
> 
> 时间：2013-03-26T20:48:47.237
> 
> 标签：json, r, rjson

我正在尝试在 R 中转换/解析 JSON 字符串，但遇到了麻烦。

我已经安装了 rjson 和 RJSONIO 包。

```
library(rjson)
install.packages("rjson")
require(rjson) 
```

数据集的示例行：

```
dataset <- data.frame(id = c(1), signup_get = {\\1358183137\\:{\\self\\:\\/index.php\\,\\pv\\:\\2\\},\\1358183315\\:{\\self\\:\\/sail-inventory-tracking.php\\},\\1358183434\\:{\\self\\:\\/pricing.php\\},\\1358183473\\:{\\self\\:\\/tour-keep-track.php\\},\\1358183486\\:{\\self\\:\\/tour-save-time.php\\},\\1358183503\\:{\\self\\:\\/tour-sell-more.php\\},\\1358183600\\:{\\self\\:\\/tour-integrations.php\\},\\1358183631\\:{\\self\\:\\/pricing.php\\},\\1358184267\\:{\\self\\:\\/signup.php\\,\\get\\:{\\p\\:\\1\\}},\\1358184409\\:{\\self\\:\\/pricing.php\\},\\1358184436\\:{\\self\\:\\/pricing.php\\},\\1358184485\\:{\\self\\:\\/about.php\\},\\1358184497\\:{\\self\\:\\/pricing.php\\},\\1358184574\\:{\\self\\:\\/pricing.php\\},\\1358184595\\:{\\self\\:\\/about.php\\},\\1358184606\\:{\\self\\:\\/tour-keep-track.php\\},\\1358184612\\:{\\self\\:\\/tour-sell-more.php\\}}
dataset$signup_get <- toString(dataset$signup_get) 
```

我试图调用`fromJSON(data$signup_get, method = "C", unexpected.escape = "error")`但得到错误“函数错误（类，fdef，mtable）：无法找到函数“fromJSON”的继承方法，对于

我的一些主要目标是回答以下问题：

*   JSON 字符串中的最后一个条目（最近的）是什么？
*   JSON字符串中的第一个时间段和最后一个时间段之间经过了多少时间？（时间列为纪元时间）
*   访问了多少页面

我认为我的错误可能在于我如何导入数据。任何建议都会很棒。

# ruby - 如何使用 ruby omniauth-twitter gem 获取 oauth 令牌和 oauth 令牌秘密？

> ID：15647100
> 
> 赞同：1
> 
> 时间：2013-03-26T20:48:59.033
> 
> 标签：ruby, ruby-on-rails-3, twitter, omniauth

我设置我的应用程序类似于这里的教程 - [http://railscasts.com/episodes/235-devise-and-omniauth-revised](http://railscasts.com/episodes/235-devise-and-omniauth-revised)。如果您无法访问它，以下是我的代码

Omniauth 控制器回调

```
 def all
    user = User.from_omniauth(request.env["omniauth.auth"])
    if user.persisted?
      flash.notice = "Signed in!"
      sign_in_and_redirect user
    else
      session["devise.user_attributes"] = user.attributes
      redirect_to new_user_registration_url
    end
  end
  alias_method :twitter, :all
end 
```

用户模型

```
def self.from_omniauth(auth)
    where(auth.slice(:provider, :uid)).first_or_create do |user|
      user.provider = auth.provider
      user.uid = auth.uid
      user.username = auth.info.nickname
      user.name = auth.info.name

    end
  end

  def self.new_with_session(params, session)
    if session["devise.user_attributes"]
      new(session["devise.user_attributes"], without_protection: true) do |user|
        user.attributes = params
        user.valid?
      end
    else
      super
    end
  end 
```

现在我想知道如何获取经过身份验证的用户的 oauth 令牌和 oauth 令牌秘密？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T13:24:35.460

如果您想查看某个提供程序返回的信息，请将其作为回调控制器的第一行：

```
raise env["omniauth.auth"].to_yaml 
```

您将能够看到可以在`auth.credentials.token`和中访问您想要的信息`auth.credentials.secret`。

编辑：现在 Rails 4 使用了 better_errors gem，这种检查omniauth 哈希的方法不再那么有效。现在更好的方法是：

```
render :text => "<pre>" + env["omniauth.auth"].to_yaml and return 
```

# javascript - 用 document.write 评估 div.innerHTML

> ID：15647104
> 
> 赞同：-2
> 
> 时间：2013-03-26T20:49:07.820
> 
> 标签：javascript, html

我需要将外部脚本中的信息写入我的 div。我有一个带有 div 的 html 页面，并使用`window.onload`.

```
document.getElementById('test').innerHTML='<script src="http://www.klerk.ru/kurs/informer/informer_txt/?stcbrf=1"></script>';
eval(document.getElementById('test').innerHTML); 
```

在这个外部脚本中有几个`document.write`'，但它不起作用。

我的问题是如何执行`document.write`到确定`div`？

但是，是否有可能做这样的事情：

```
<table>
  <tr>
    <td>
    <script src="http://www.klerk.ru/kurs/informer/informer_txt/?stcbrf=1"></script>
    </td>
  </tr>
</table> 
```

并将`document.write`在脚本中将数据写入`td`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T20:56:15.950

你不能加载一个 javascript 源文件，它必须在初始页面加载期间，在任何 javascript 运行之前进入浏览器。无法访问这样的 javascript 引用（我不知道技术原因，我假设它与安全相关）。

您可以针对一段 javascript 代码运行 eval，但不能针对 javascript 文件（参考）。

# html - 如何在没有 javascript 或 display:table 的情况下固定导航、页脚和剩余高度的内容？

> ID：15647106
> 
> 赞同：0
> 
> 时间：2013-03-26T20:49:12.820
> 
> 标签：html, css, dom

处理需要这种布局的东西：

![在此处输入图像描述](../Images/f30708c06210aab5dfb37a1fc1ea474a.png)

我需要内容具有屏幕上剩余空间的隐含大小。我尝试了很多东西

```
<div id="wrapper">
    <div id="header">
    </div>

    <div id="content">
    </div><!-- /content -->

    <div id="footer">
    </div>
</div> 
```

这适用于显示表技术：

```
#wrapper {display: table; height: 100%; width: 100%; background: yellow;}
#header { display: table-row; background: black;height: 50px;}
#container { display: table-row; height: 100% }
#footer {display: table-row;background: black; height: 50px;} 
```

但是没有它我该怎么办呢？

```
#wrapper {width: 100%; height: 100%; position: relative; min-height: 800px;}
#header {position: relative; width: 100%; height: 42px;}
#footer {height: 45px; width: 100%; background: #000; position: absolute; bottom: 0; overflow-y: hidden;} 
```

我也不希望内容是位置：绝对

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T20:59:29.910

如果您可以使用固定的高度，这可能会起作用：

```
body, html, #wrapper, #content
{
    height: 100%;
    margin: 0;
    padding: 0;
}

#header,
#footer
{
    position: relative;
    height: 42px;
    background: red;
}
#content
{
    height: auto;
    min-height: 100%;
    margin:-42px 0;
    padding: 42px 0;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
} 
```

这是[小提琴](http://jsfiddle.net/wYPDa/5/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:02:31.393

使用此 HTML

```
<div id="wrapper">
<div id="header">This is my header
</div>

<div id="content">This is my content
</div><!-- /content -->

<div id="footer">This is my footer
</div>
</div> 
```

而css是这样的

```
#wrapper {width: 100%; 
height: 100%; 
position: relative; 
min-height: 800px;}

#header {position: relative; 
width: 100%; 
height: 42px; 
background-color:#CA3A3A;}

#content{background-color:#089ED0;
min-height: 800px;}

#footer {height: 45px; 
width: 100%; 
background-color:#CA3A3A; 
position: absolute; 
bottom: 0; 
overflow-y: hidden;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-08T20:35:56.487

我为此找到的最佳解决方案是使用 css3 的新 calc 方法。我还用modernizr测试了它的可用性，如果它不可用，我用JS手动设置容器区域的高度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T21:03:00.357

这在过去对我有用： [http ://ryanfait.com/sticky-footer/](http://ryanfait.com/sticky-footer/)

# sql-server - 重用 Lightswitch 可视化查询设计器

> ID：15647113
> 
> 赞同：2
> 
> 时间：2013-03-26T20:49:40.477
> 
> 标签：sql-server, visual-studio-lightswitch, lightswitch-2012

我们正在构建的应用程序能够让用户在不输入 SQL 查询的情况下提取数据。LightSwitch 查询设计器看起来用户友好。

是否可以将 LightSwitch 可视化查询设计器重用（嵌入）到 .NET 应用程序中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T07:12:44.103

不，您不能在 Silverlight 或 HTML 应用程序中重复使用该编辑器（它是 Visual Studio 的一部分）。

但是，有一个过滤器控制扩展可以满足相同的需求。有关一些屏幕截图和指南，请参阅 Michael 的帖子：http: [//lightswitchhelpwebsite.com/Blog/tabid/61/EntryId/22/Using-The-LightSwitch-Filter-Extension.aspx](http://lightswitchhelpwebsite.com/Blog/tabid/61/EntryId/22/Using-The-LightSwitch-Filter-Extension.aspx)

继续摇摆LS！

# javascript - 如果语句被忽略

> ID：15647114
> 
> 赞同：2
> 
> 时间：2013-03-26T20:49:43.273
> 
> 标签：javascript

我的`if`发言被忽略了。我对编码很陌生。
我觉得我缺少分号或括号或类似的小东西。

```
<script type="text/javascript">
  function showdiv() {     
       if(document.getElementById("nav-wrap-2").style.opacity ='.5')
            {
            document.getElementById("nav-wrap-2").style.opacity ='0';
            document.getElementById("content-wrap").style.marginLeft ='250px';
            }
       }
</script> 
```

编辑：在 if 语句中将 = 更改为 == 是正确的解决方案，但它并没有解决整个问题。我还必须去掉 if 语句中 '.5' 周围的引号。德普。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-26T20:50:55.623

您需要使用“==”进行比较。（或“===”按值*和*类型进行比较）

"=" 将在 javascript 中执行分配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T20:51:17.517

`if(document.getElementById("nav-wrap-2").style.opacity ='.5')`使用作业，您应该使用

```
if(document.getElementById("nav-wrap-2").style.opacity == '.5') 
```

这将使用等号运算符`==`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T20:51:30.560

You are doing an assigment not a comparison. You have to use the == operator instead of =.

= is an assigment.

== checks if to values are equal.

Your code should look like this:

```
if(document.getElementById("nav-wrap-2").style.opacity =='.5') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T20:54:35.657

You need to change the = to ==. In JavaScript if you do =, it's an assignment operator, not a comparer.

# php - php mysql更新查询

> ID：15647115
> 
> 赞同：-2
> 
> 时间：2013-03-26T20:49:45.987
> 
> 标签：php, mysql, forms

我正在创建一个`edit_setting`页面，允许用户更新他们的个人资料。我能够更新每个字段，但电子邮件地址字段给了我一个错误。

**密钥 email_address 的 DUPLICATE 条目**

如何解决这个错误？这是处理电子邮件字段的一段代码。如果您想要其他代码，请告诉我。

# account_setting.php

```
 $edit_query = mysql_query("UPDATE user SET first_name= '$fname', last_name= '$lname', address= '$country', email_address = '$email', specialization_name= '$spec', interest = '$aboutme' WHERE user_id = '$userid'") or die(mysql_error());

<td><label for="email"><span class="Fields">Email Address</span></label></td>
  <td><input type="text" name="email" placeholder="Email_Address" value="<?php echo $email; ?>" /></td> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T20:51:15.077

这意味着对`email_address`单个电子邮件地址禁止多条记录的字段存在约束。如果它是主键，那么您需要评估哪个字段最能唯一标识记录（代理键）。如果它是唯一约束，那么您可以删除该约束。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T20:52:57.807

听起来您在 email_address 上有一个唯一键。如果从 MySQL 中的数据卫生角度来看这是所需的，那么除了调整代码以正确处理此类错误情况外，您实际上无能为力。

如果不希望表中的每条记录的电子邮件地址都是唯一的，那么您可以将索引类型更改为不唯一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T20:51:49.017

**email_address** field is *unique* and you are trying to insert duplicate entry

# foreign-keys - ServiceStack OrmLite + 外键

> ID：15647118
> 
> 赞同：1
> 
> 时间：2013-03-26T20:49:57.183
> 
> 标签：foreign-keys, ormlite-servicestack

我已经准备好 asp.net 表单身份验证表，我想为其中一个表创建一个 FK。

如果不创建要与属性一起使用的类型，这是否可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T18:46:10.910

最后，我创建了另一个与表匹配的 skelton poco 类，这使我能够放置外键。

# javascript - jQuery 悬停和滑动

> ID：15647121
> 
> 赞同：1
> 
> 时间：2013-03-26T20:50:07.770
> 
> 标签：javascript, jquery, html, slide, slideup

我有 20 个不同的 div。

5类=“图标”，

5类=“雨皮”，

4类=“学校项目”，

4类=“壁纸”，&

2类=“杂项”。

每个 div 都有一个 class=".type" 的 div。我显示了 .type div 的标题部分（大约 27 像素），但其余部分被隐藏了。当有人将鼠标悬停在 .type div 上时，它会向上滑动（通过将 margin-top: 更改为 0px）。当鼠标不再悬停时，它会回到原来的位置（margin-top：110px）。

[这是我的小提琴。](http://jsfiddle.net/gfefN/2/)和java代码。

```
(function ($) {
    var original = [];
    $('.type').each(function (i) {
        original.push($(this).css('margin-top'));
    });
    $('.type').hover(function (e) {
        $(this).stop().animate(
            {"margin-top" : (
                $(this).parent().outerHeight() - 
                $(this).outerHeight()
            )},
            250
        );
    }, function (i){
        var i = $('.type').index($(this));
        $(this).stop().animate(
            {"margin-top": original[i]},
            250
        );
    });
}(jQuery)); 
```

它工作得非常好，除非有人将鼠标悬停在一个 .type div 上，然后在第一个 .type div 向下滑动之前将鼠标悬停在另一个 .type div 上。然后 .icon、.rainkin、.schoolproject 等 div 向下移动了一点。[去我的小提琴](http://jsfiddle.net/gfefN/2/)，自己检查一下。我不知道它为什么这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:10:16.580

当您使用“margin-top”时，实际上是在弄乱 css div 的流程，因此如果您使用“top”，则位置仅适用于该 div，您还需要将 .type 设置为“相对”。另一件事，您的原始位置可以只是“0”，而上拉的数量可以是您的 .type div 的大小。

检查此修改：

（在这里测试：http: [//jsfiddle.net/gfefN/9/](http://jsfiddle.net/gfefN/9/)）

```
(function ($) {
    var original = [];
    $('.type').each(function (i) {
        original.push(0);
    });
    $('.type').hover(function (e) {
        $(this).stop().animate(
            {"top" : -(
                $(this).height()
            )},
            250
        );
    }, function (i){
        var i = $('.type').index($(this));
        $(this).stop().animate(
            {"top": original[i]},
            250
        );
    });
}(jQuery)); 
```

# jquery - JQuery Widget Factory 覆盖 _setOptions

> ID：15647126
> 
> 赞同：0
> 
> 时间：2013-03-26T20:50:16.023
> 
> 标签：jquery, jquery-widgets

我正在尝试覆盖 jQuery Widget Factory 的内置 _setOptions 方法，但我不知道如何调用父 _setOptions 函数。我使用的是 jQuery 1.8.24，所以我不能使用`super`仅在 1.9+ 中可用的方法。

```
 _setOption: function(key, value){
          console.log('key => '+ key + '; value => '+ value); // Test to see if this gets called
          if(this[key] != value) {
              $.Widget.prototype._setOption.apply(this,arguments); // Call the parent option
          }    
      },   

      _setOptions: function(options){
          console.log('Config multi options');
          console.log(options);
          //$.Widget.prototype._setOptions.apply(this, options); // throws error
          // Ripped out the guts of Widget _setOptions for now.  Feels hackish.
          var self = this;
          $.each(options, function(key, value) {
              self._setOption(key, value);
          });
          // What to do after finished setting multiple options.
          this._configureVideo();
          this.play();
      }, 
```

[jquery UI 1.9 WidgetFactory 文档](http://api.jqueryui.com/jQuery.widget/#method-_setOptions)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-04-18T23:10:43.747

你可以使用 this._setOption();

# java - 通过 ProcessBuilder 运行 bash 命令时出现 IOexception

> ID：15647130
> 
> 赞同：0
> 
> 时间：2013-03-26T20:50:27.873
> 
> 标签：java, processbuilder

尝试使用 ProcessBuilder 通过 Java 运行 sed 命令时出现 IOException：

```
ERROR: java.io.IOException: Cannot run program "sed -i 's/hello world//g' 
/home/user/test": error=2, No such file or directory 
```

命令是`sed -i 's/hello world//g' /home/user/test` 但问题不是命令，我可以通过终端运行相同的命令，它会删除字符串“hello world”

```
public void removeString(String str, String file) throws IOException {
    String command = "sed -i \'s/" + str + "//g\' " + file;
    System.out.println(command);
    ProcessBuilder pb = new ProcessBuilder(command);
    Process p = pb.start();
} 
```

是什么导致进程无法找到文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T20:57:55.327

`ProcessBuilder` 期望在构造函数[中单独发送单个参数。](http://docs.oracle.com/javase/7/docs/api/java/lang/ProcessBuilder.html#ProcessBuilder%28java.lang.String...%29)尝试像这样运行它：

```
ProcessBuilder pb = new ProcessBuilder("sed", "-i", "s/hello world//g", "/home/user/test"); 
```

`List<String>`（如果你愿意，你也可以通过它）

它以这种方式工作以防止[shell 注入](https://en.wikipedia.org/wiki/Code_injection#Shell_injection)安全漏洞。

# sas - 如何在 SAS 中将字符串转换为日期值？

> ID：15647134
> 
> 赞同：7
> 
> 时间：2013-03-26T20:50:55.167
> 
> 标签：sas

我想在 SAS 中将字符串转换为日期，我试过：

```
data _null_; 
   monyy = '05May2013'; 
   date = input(substr(strip(monyy),1,9),yymmdd.);;
   put date=date9.; 
   run; 
```

但它没有用。这可以做到吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-07-30T05:28:18.113

格式如

```
date9\. 
```

或者

```
mmddyy10\. 
```

将文本转换为 sas 日期时对输入命令无效。您可以使用

```
Date = input( cdate , ANYDTDTE11.); 
```

或者

```
Date = input( cdate , ANYDTDTE10.); 
```

用于转换。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-26T21:11:10.113

您不需要 substr 或 strip。

```
input(monyy,date9.); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-03-14T17:09:01.867

如上所述，简单的答案是：

```
date = input(monyy,date9.); 
```

加上：

```
put date=yymmdd.; 
```

这行得通的原因*，*而你所做的却没有，是因为 SAS 中的一个常见误解。日期 9。是一个信息。在 INPUT 语句中，它为 SAS 解释器提供了一组翻译命令，它可以发送给编译器以将您的文本转换为正确的数字，一旦应用了正确的 FORMAT，它就会看起来像一个日期。格式只是数字（或字符）的可见表示。因此，通过使用 YYMMDD.，您将 INPUT 函数交给了 FORMAT 而不是 INFORMAT，从而混淆了它，并且可能得到了一个有用的错误，上面写着：

```
Invalid argument to INPUT function at line... etc... 
```

这绝对没有告诉你下一步该做什么。

总之，将您的字符日期表示为 YYMMDD。在 SAS 中，您需要：

1.  更改信息 -`date = input(monyy,date9.);`
2.  应用格式 -`put date=YYMMDD10.;`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-02T11:28:36.180

输入（char_val，date9.）；

您可以考虑使用 input(char_val, worddate.) 将其转换为 word 格式。

[您可以在此页面http://v8doc.sas.com/sashtml/lrcon/zenid-63.htm](http://v8doc.sas.com/sashtml/lrcon/zenid-63.htm)中获得很多信息

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-26T21:02:55.287

尝试

```
data _null_; 
   monyy = '05May2013'; 
   date = input(substr(strip(monyy),1,9),date9.);
   put date=date9.; 
   run; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-02-02T13:46:58.453

此代码有助于：

```
data final; set final;

first_date = INPUT(compress(char_date),date9.); format first_date date9.;

run; 
```

我个人在SAS上试过

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-17T07:59:40.513

```
input(char_val,current_date_format); 
```

您可以在显示时指定任何日期格式，例如 set`char_val=date9.;`

# ios - 通过交替不同的 UIImage 来制作动画

> ID：15647137
> 
> 赞同：0
> 
> 时间：2013-03-26T20:50:57.470
> 
> 标签：ios, xcode, animation, uiimageview, uiimage

我有两个不同的图像，它们本质上只是彼此的倒数。我想来回动画它们以创建一些移动的效果。在 AppDelegate didFinishLaunching 我有：

```
myImageWalk = [[UIImageView alloc] initWithFrame:CGRectMake(0,0, 320, 568)];
    [self.myImageWalk setImage: [self loadingImage]];

    [window addSubview:myImageWalk];
    [window bringSubviewToFront:myImageWalk]; 
```

然后，同样在 App Delegate 中，我有：

```
-(UIImage*)loadingImage
{
    NSArray *animationFrames = [NSArray arrayWithObjects:
                                [UIImage imageNamed:@"original.png"],
                                [UIImage imageNamed:@"second.png"],
                                [UIImage imageNamed:@"original.png"],
                                [UIImage imageNamed:@"second.png"],
                                [UIImage imageNamed:@"original.png"],
                                [UIImage imageNamed:@"second.png"],
                                [UIImage imageNamed:@"original.png"],
                                [UIImage imageNamed:@"second.png"],
                                [UIImage imageNamed:@"original.png"],
                                [UIImage imageNamed:@"second.png"],
                                [UIImage imageNamed:@"original.png"],
                                [UIImage imageNamed:@"second.png"],
                                [UIImage imageNamed:@"original.png"],
                                [UIImage imageNamed:@"second.png"],
                                [UIImage imageNamed:@"original.png"],
                                [UIImage imageNamed:@"second.png"],
                                [UIImage imageNamed:@"original.png"],
                                [UIImage imageNamed:@"second.png"],
                                nil];
    return [UIImage animatedImageWithImages:animationFrames duration:6.0f];
} 
```

但是，什么都没有发生，没有图像出现。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:16:28.210

我还没有尝试过，但也许可以尝试将您的代码包装在此块中：

```
[UIView animateWithDuration:6f animations:^{

    [UIImage animatedImageWithImages:animationFrames duration:6.0f]

} completion:^(BOOL finished) {
    //Callback after animation was completed
    [view removeFromSuperview];
}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T03:00:05.170

下面的一些代码你可以试试。请注意，您不需要重复一系列 imageNamed:，只需根据需要为一个循环设置持续时间。

```
myImageWalk = [[UIImageView alloc] initWithFrame:CGRectMake(0,0, 320, 568)];
myImageWalk.image = [self loadingImage];
self.myImageWalk.animationRepeatCount = 0;

[window addSubview:myImageWalk];
[window bringSubviewToFront:myImageWalk];

//when you want the animation to start
[self animateImages];
//then later at some appropriate time:
[self stopAnimatingImages];

- (UIImage*)loadingImage {
    NSArray *animationFrames = [NSArray arrayWithObjects:
                            [UIImage imageNamed:@"original.png"],
                            [UIImage imageNamed:@"second.png"],
                            nil];
    return [UIImage animatedImageWithImages:animationFrames duration:6.0f];
}
- (void)animateImages {
    if (![self.myImageWalk isAnimating]) {
        [self.myImageWalk startAnimating];
    }
}
- (void)stopAnimatingImages {
    if ([self.myImageWalk isAnimating]) {
        [self.myImageWalk stopAnimating];
    }
} 
```

注意：除非这是一个测试应用程序或类分配，否则您应该将此逻辑从 AppDelegate 移动到 ViewContoller，因为最好的做法是尽量减少在 didFinishLaunching 期间完成的工作。

# python - 按钮转换

> ID：15647146
> 
> 赞同：0
> 
> 时间：2013-03-26T20:51:13.627
> 
> 标签：python, user-interface, wxpython, pythoncard

我正在使用 pythonCard 的 GUI 帮助对 wxPython 进行编程。到目前为止，资源编辑器已经完成了我的展示工作。

GUI 具有带有程序输出信息的静态框“卡片”。我想在按钮单击时转换到不同的页面。因此，例如，单击确定应该将我带到第 2 页（单独的资源文件）。复杂性是我不想为每次单击打开一个新窗口，因为我有 20 个按钮。

我有 10 张具有相同属性的卡片，因此单击时我只想更改特定的并且仍然在主页上，但是转到特定卡片的第二页。直观地想到 Windows 8 磁贴，单击它会翻转以显示更多信息。

这在 wxPython 中可行吗？如果是这样，我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T15:00:10.040

在我看来，您想要一个笔记本或类似的“书本”控件。wxPython 演示详细介绍了 wx 支持的各种书籍控件。或者您可能只想交换面板，这也很容易做到。这是我不久前就该主题写的教程：

[http://www.blog.pythonlibrary.org/2010/06/16/wxpython-how-to-switch-between-panels/](http://www.blog.pythonlibrary.org/2010/06/16/wxpython-how-to-switch-between-panels/)

这里有几个关于笔记本和类似控件的链接：

*   [http://wxpython.org/docs/api/wx.Notebook-class.html](http://wxpython.org/docs/api/wx.Notebook-class.html)
*   [http://wiki.wxpython.org/Simple%20wx.Notebook%20Example](http://wiki.wxpython.org/Simple%20wx.Notebook%20Example)
*   [http://www.blog.pythonlibrary.org/2012/07/18/wxpython-how-to-programmatically-change-wx-notebook-pages/](http://www.blog.pythonlibrary.org/2012/07/18/wxpython-how-to-programmatically-change-wx-notebook-pages/)

# .htaccess - .htaccess How to rewrite img.php?p=$id to img/$id?

> ID：15647157
> 
> 赞同：0
> 
> 时间：2013-03-26T20:51:59.073
> 
> 标签：.htaccess

How to rewrite img.php?p=$id to img/$id in .htaccess, where $id is id of the image in database?

I tried this, but I get error - nothing found.

```
RewriteEngine On
RewriteBase /
RewriteRule img/^([0-9_-]+)$ img.php?p=$1
RewriteRule img/^([0-9_-]+)/$ img.php?p=$1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:11:42.107

用以下代码替换您的代码：

```
RewriteEngine On
RewriteBase /
RewriteRule ^img/([0-9_-]+)$ /img.php?p=$1 [L,QSA,NC] 
```

# java - Adding to custom linked list causes NullPointerException

> ID：15647159
> 
> 赞同：0
> 
> 时间：2013-03-26T20:52:08.127
> 
> 标签：java, nullpointerexception, linked-list, custom-component

So, adding stuff to my *custom* linked list is causing a `NullPointerException`, and I cannot, for the life of me, figure out why. The purpose of the program is to simulate a chest of drawers, with a list that has the drawers as nodes. The drawers each have a list that includes household objects as nodes.

Here's the relevant bits of code. The error happens when I create a: `new ChestOfDrawers(3);` in my UI class:

```
public class ChestOfDrawers{

    private static OwnList chest;  
    private static int[] parametres;

    public ChestOfDrawers (int drawers){
        chest = new OwnList();
        create();
    }

    public static void create(){
        for (int i = 0; i < parametres.length; i++) {
            Object drawer = new Drawer(i, parametres[i]);
            chest.add(i, drawer); //This is causing the error
        }   
    }
} 
```

The `Drawer` class being referred to here is the class for the drawers. It requires `int i` as an ID and `int parametres` as drawer capacity. The `parametres[]` array gets filled before the additions to the list are made and it includes info for drawer capacity. The linked list in the question (`OwnList`) is functioning 100% correctly as it is part of a provided course material, it's near identical to Java's own. I tested the class in another test class and it worked fine, I've just made a mistake here somewhere. Please help!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T20:53:55.030

问题是您没有初始化参数数组。该字段默认为空。您需要在声明的位置或在静态初始化程序块中对其进行初始化。另外，为什么这两个字段和创建方法是静态的？这些当然看起来像实例状态......

这是一个更好的版本：

```
public final class ChestOfDrawers{
    private final OwnList chest = new OwnList();  
    private final int[] parametres;

public ChestOfDrawers (int drawers){
    if (drawers < 0) throw new IllegalArgumentException("Drawers may not be negative");
    chest = new OwnList();
    parametres = new int[drawers]; // <-- I'm assuming that's the intended meaning
    initialize();
}        

private void initialize(){
    for(int i = 0; i < parametres.length; i++){
        Object drawer = new Drawer(i, parametres[i]); // <-- parametres[i] will always be 0
        chest.add(i, drawer); 
    }   
}
} 
```

我不确定你需要 parametres 数组实际包含什么（一个新的 int 数组将填充零值） - 但我将把它作为练习留给读者:-)

# c++ - Priority queue in reverse order

> ID：15647162
> 
> 赞同：8
> 
> 时间：2013-03-26T20:52:20.223
> 
> 标签：c++, std, priority-queue

[This site](http://www.cplusplus.com/reference/queue/priority_queue/priority_queue/) suggests that if I want to reverse-order my priority queues, the following code is what I should use:

```
#include <iostream>
#include <queue>
using namespace std;

class mycomparison{
    bool reverse;
  public:
    mycomparison(const bool &revparam=false) {reverse=revparam;}
    bool operator() (const int &lhs, const int &rhs) const {
      if (reverse) return (lhs>rhs);
      else         return (lhs<rhs);
    }
};

int main (){
  int myints[]= {10,60,50,20};

  priority_queue<int, vector<int>, mycomparison(true)> first;

  return 0;
} 
```

This bothers me:

*   I have to specify the storage class in my constructor.
*   I have created a class whose *only* purpose is to be passed to the priority queue.

Is there a more elegant or less verbose way of reverse-sorting a priority queue?

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-26T20:55:25.147

您无法避免指定存储容器，但可以避免编写自己的函子：

```
priority_queue<int, vector<int>, std::greater<int> > first; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T21:01:56.140

如果您想要灵活性而不必定义任何类，则可以使用比较器`std::function>`的*类型*：

```
#include <functional>

int main ()
{
    int myints[]= {10,60,50,20};

    // Use this is a the type of your comparator
    typedef std::function<bool(int, int)> comp_type;

    // Priority queue using operator < for ordering
    priority_queue<int, vector<int>, comp_type> first(std::less<int>());

    // ...

    // Priority queue using operator > for ordering
    priority_queue<int, vector<int>, comp_type> second(std::greater<int>());

    // ...

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-03T09:43:40.907

在反转结构的优先级队列时，我找到了更简单的解决方案。我从那里修改了解决方案：[stl priority_queue of C++ with struct](https://stackoverflow.com/questions/15601973/stl-priority-queue-of-c-with-struct)

```
struct leaf
{
int symbol;
double probability;
bool operator < (const leaf &o) const 
    {
        return probability > o.probability; // here just reversed the operator
    }
};

priority_queue <leaf> leafs_queue; //queue already reversed 
```

# sql - Update sql in perl script - execute statement stuck

> ID：15647165
> 
> 赞同：1
> 
> 时间：2013-03-26T20:52:25.190
> 
> 标签：sql, perl, sql-update, prepared-statement, execute

Getting something is wrong with the execute statement. It just seems to hang forever when I run in command prompt. It doesn't die either. does execute maybe need parameters?

```
#!/usr/bin/perl
use DBI;
use Data::Dumper;

$dbh = DBI->connect('DB', 'NAME', 'PASS',{ LongReadLen => 1000000} ) or die 'Error: cant connect to db';

$st= "update table set the_id = 7 where mid = 23 and tid = 22";

my $UpdateRecord = $dbh->prepare($st)  or die "Couldn't prepare statement: $st".$dbh->errstr;
$UpdateRecord->execute() or die "can not execute $UpdateRecord".$dbh->errstr;
$UpdateRecord->finish;

$dbh->disconnect(); 
```

EDIT:
I tried binding in execute as well as using bind_param(), and it's still hanging up.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:12:40.063

问题是我锁定了一堆对象，因为在我运行一次之前未能断开连接......是的，不要那样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T10:51:17.330

你需要一个`do`而不是`prepare`.

```
my $UpdatedRecord = $dbh->do($st)  or die "Statement fails: $st".$dbh->errstr; 
```

[来自 DBI](http://search.cpan.org/dist/DBI/DBI.pm#do)：

> 此方法通常对于无法提前准备（由于驱动程序的限制）或不需要重复执行的非 SELECT 语句最有用。它不应该用于 SELECT 语句，因为它不返回语句句柄（因此您无法获取任何数据）。

此外，在声明的顶部添加/使用您正在使用的数据库驱动程序模块总是更好`use DBI;`。

`use DBD::Oracle`;

还添加

> 使用严格；
> 使用警告；

# node.js - SocketIO broadcasting too fast

> ID：15647166
> 
> 赞同：1
> 
> 时间：2013-03-26T20:52:36.977
> 
> 标签：node.js, sockets, heartbeat

I would like to broadcast a single message to every client every second (think about it as custom heartbeat mechanism).

So the NodeJS app is started, sockets are created and when I connect from the client app the heartbeat messages are broadcasted. I'm still developing the client application and that means hitting F5 all the time and reloading the application. The new client SocketIO connection is created on load and this results in heartbeat messages coming to client app with rate much higher than 1 message/sec.

There is nothing special about the code - server side:

```
var server = http.createServer(app);
var io = require('socket.io').listen(server);
server.listen(8080);

io.sockets.on('connection', function(socket) {
  ...
  setInterval(function() {
    console.info('broadcasting heartbeat');
    socket.broadcast.emit('heartbeat', /* custom heartbeat*/);
  }, 1000);
  ...
}); 
```

Client side:

```
var socket = io.connect('localhost', { 'reconnect': false, port: 8080 });
socket.on('heartbeat', function(data) { console.log('heartbeat'); }); 
```

Can anybody give me some advice what's wrong? Thanks

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T21:44:24.463

无需每次启动间隔。`clearInterval(INTERVAL);`您可以存储 intervalID，甚至在不需要时将其清除。

```
var server = http.createServer(app);
var io = require('socket.io').listen(server);
server.listen(8080);

var INTERVAL;

io.sockets.on('connection', function(socket) {
  ...
  if (!INTERVAL) {
    INTERVAL = setInterval(function() {
      console.info('broadcasting heartbeat');
      socket.broadcast.emit('heartbeat', /* custom heartbeat*/);
    }, 1000);
  }
  ...
}); 
```

# javascript - javascript setting the size of a window

> ID：15647167
> 
> 赞同：0
> 
> 时间：2013-03-26T20:52:37.740
> 
> 标签：javascript

I am trying to set a browser window to a particular size using the code below. When I load the page the size doesn't change. I am looking at it through firefox,but I also looked at it through safari but still there is no change. I am following several examples that i found online, and it seems like i am doing everything that was in the tutorial. What am i doing wrong????

```
<!DOCTYPE html>
<html>
<head>

<style>
body 
{
background-image:url('tri_tespic.jpg');
background-repeat:no-repeat;
background-attachment:fixed;
background-position:center; 

}
</style>
<script type="text/javascript">
function changeScreenSize(w,h)
     {
       window.resizeTo( w,h )
     }
</script>
</head>

<body onload="changeScreenSize(818,50)">

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T20:56:39.483

当窗口处于顶层（即不是弹出窗口）时，无法调整窗口大小

# python - 基本 Antlr 3.1 错误处理问题 (Python)

> ID：15647168
> 
> 赞同：1
> 
> 时间：2013-03-26T20:52:39.177
> 
> 标签：python, error-handling, antlr3

我创建了一个 Antlr 3.1 语法，用于解析类似 sql 的语言。解析很好，但我试图让它吐出有用的异常。我有一组可以用括号调用的“函数”，然后大多数其他东西都被视为资源。目前，如果我尝试解析不正确的功能名称（validStuff），我会得到一个识别异常

```
no viable alternative at input u'(' 
```

我想说不正确的函数名称不是有效的函数名称，但我不确定如何获取最后一个令牌，或者最好的位置是放置此处理代码（目前将所有内容都放在 displayRecognitionError 中） .

# python - Django STATIC_FILE 不像我想的那样工作？

> ID：15647171
> 
> 赞同：0
> 
> 时间：2013-03-26T20:52:42.863
> 
> 标签：python, css, django, static

我已经搜索了这个问题的答案，但我还没有找到任何解决我的问题的方法。我想将 css 链接到我的项目，但无法处理 STATIC_URL 的工作方式

```
 <head>
    {% load static from staticfiles %}
    <link rel="stylesheet" type="text/css" href="{% static "css/style.css" %}">
  </head> 
```

在这里发布的代码太多了，所以这里是链接：settings.py： http: [//pastebin.com/9Bsg3u1h](http://pastebin.com/9Bsg3u1h)

我`context_instance=RequestContext(request)`当然用参数渲染。我有这样的文件结构：

```
Django_project
 ...
 appname
 templates
 static 
```

我还尝试将静态目录放在许多项目、appname 甚至模板中。有人可以解释一下它应该如何寻找我的项目吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T20:56:01.273

使用内置`static`，而不是`static`from `staticfiles`：

```
 <head>
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static "css/style.css" %}">
  </head> 
```

[https://docs.djangoproject.com/en/dev/ref/templates/builtins/#static](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#static)

> Django 附带一个`static`模板标签。无论您是否使用，您都可以使用它`RequestContext`。
> 
> **笔记**
> 
> `staticfiles`contrib 应用程序还附带一个模板标签，该`static`标签使用 staticfiles'`STATICFILES_STORAGE`来构建给定路径的 URL。*如果您有高级用例（例如使用云服务来提供静态文件），请使用它...*

# servicestack - 向路由中给定的路径发送 GET 请求

> ID：15647173
> 
> 赞同：5
> 
> 时间：2013-03-26T20:52:50.603
> 
> 标签：servicestack

我正在尝试从这样的 URL 调用 REST 服务：

```
example.org/account/someusername 
```

我已经定义了请求和响应 DTO。

```
[Route("/account/{UserName}", "GET")]
public class AccountRequest : IReturn<AccountResponse>
{
    public string UserName { get; set; }
}

public class AccountResponse
{
    public int Id { get; set; }
    public string UserName { get; set; }
    public string Bio { get; set; }
} 
```

调用服务：

```
JsonServiceClient client = new JsonServiceClient("http://example.org");
AccountRequest request = new AccountRequest { UserName = "me" };

AccountResponse response = client.Get(request); 
```

但是，当我在客户端上调用 Get 时，它不尊重路由。~~当我在调试器中检查客户端实例时， AsyncOneWayBaseUri 值为 example.org/json/asynconeway/~~。这部分无关紧要，因为它并不意味着将请求发送到此 URL。我实际上不知道它在哪里发送请求。我没有收到任何错误，并且我在响应对象中的所有属性都是空的。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-26T23:34:26.490

### 使用第 3 方 REST / HTTP API

ServiceStack 的服务客户端固执地调用 ServiceStack Web 服务，因为它们支持 ServiceStack 的预定义路由、内置 Auth、自动路由生成、内置错误处理等。

要调用第 3 方 REST / HTTP APIs，您可以使用 ServiceStack.Text 附带的[HTTP Utils ，它为围绕 .NET 的](https://github.com/ServiceStack/ServiceStack/wiki/Http-Utils)**HttpWebRequest**的常见数据访问模式提供简洁易读的 API ，例如：

```
List<GithubRepo> repos = "https://api.github.com/users/{0}/repos".Fmt(user)
    .GetJsonFromUrl()
    .FromJson<List<GithubRepo>>(); 
```

### 使用 C# .NET 服务客户端使用 ServiceStack 服务

我没有看到报告的行为，您是否在客户端上使用了最新版本的 ServiceStack？

测试生成的 url 被使用（不进行服务调用）的一种方法是直接调用`TRequest.ToUrl(method)`扩展方法（服务客户端使用），例如

```
AccountRequest request = new AccountRequest { UserName = "me" };
request.ToUrl("GET").Print(); //  /account/me 
```

当我尝试通过 调用它时，使用了相同的自动生成路由`JsonServiceClient`，例如：

```
var client = new JsonServiceClient("http://example.org");
var response = client.Get(request); //calls http://example.org/account/me 
```

### ServiceStack 的服务客户端中使用的路由 URL

ServiceStack 将尝试使用与您调用的 DTO 和 HTTP 方法中填充的值匹配的最合适的路由，如果没有匹配的路由，它将回退到[预定义的路由](http://www.servicestack.net/ServiceStack.Hello/#predefinedroutes)。

默认情况下，将使用原始预定义路由：

```
/api/[xml|json|html|jsv|csv]/[syncreply|asynconeway]/[servicename] 
```

但是 ServiceStack 现在还支持 and 的较短别名`/reply`，`/oneway`例如：

```
/api/[xml|json|html|jsv|csv]/[reply|oneway]/[servicename] 
```

您可以通过设置标志来选择在客户端中使用它：

```
client.UseNewPredefinedRoutes = true; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T22:28:58.697

**它不尊重路线**

您是否收到 404 或 Handler not found 异常？

确保在配置 AppHost 时将您的“AccountService”类所在的任何程序集添加到“assembliesWithServices”参数中。听起来您的路线没有被 ServiceStack 拾取。

```
public MyAppHost() : base("my app", typeof(AccountService).Assembly) { } 
```

您的服务类是什么样的？

像下面这样的东西应该可以工作（不要忘记服务接口）

```
public class AccountService : Service
{
    public object Any(AccountRequest request)
    {
        return new AccountResponse() { UserName = request.UserName};
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T21:36:48.953

Servicestack 支持多种不同的数据格式，例如 JSON、XML、JSV、CSV 等，并支持多种不同的端点来开箱即用地访问这些数据。请在下面找到从 SS 文档的[格式](https://github.com/ServiceStack/ServiceStack/wiki/Formats)部分获取的受支持端点的详细信息。

ServiceStack 提供的客户端使用默认端点，而不是 restful 端点来访问数据。数据仍然可以轻松访问，您可以通过导航到浏览器中的静态 URL 来测试这一点。

## 宁静的端点

`?format={format}`您可以通过添加到 URL 的末尾来定义应使用的格式。

*   `?format=json`
*   `?format=xml`
*   `?format=jsv`
*   `?format=csv`
*   `?format=htm`

例子：`http://www.servicestack.net/ServiceStack.Hello/servicestack/hello/World!?format=json`

或者，ServiceStack 还可以识别应与 Accept http 标头一起使用的格式：

*   `Accept: application/json`
*   `Accept: application/xml`

如您所见，这种方法仅适用于`json`and `xml`。

## 默认端点

`/servicestack/[xml|json|html|jsv|csv]/[syncreply|asynconeway]/[servicename]`

例子：

*   /servicestack/xml/[syncreply|asynconeway]/[servicename] 将是 XML
*   /servicestack/json/[syncreply|asynconeway]/[servicename] 将是 JSON

## SOAP 端点

SOAP 端点当然只支持 XML。

* * *

# 更新

ServiceStack 客户端不能用于连接到非 ServiceStack Web 服务，因为它们依赖于特定于 ServiceStack 的行为。最好使用[RestSharp](http://restsharp.org/)之类的东西或许多其他可用客户端之一，这些客户端允许您与宁静的 Web 服务进行交互。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T23:19:58.187

感谢大家的回答。C# 客户端从一开始就将请求发送到正确的地址，我使用 Fiddler 对其进行了调试。只有我没有正确反序列化它。

Account 对象位于`data`响应的属性中，而不是响应本身。客户端擅长使用 REST 服务，即使它们不是使用 ServiceStack 构建的。这很酷。

# python - 从字典中切片数据

> ID：15647174
> 
> 赞同：0
> 
> 时间：2013-03-26T20:52:54.323
> 
> 标签：python, dictionary, numpy, slice

我的代码可以正确返回 xyz 坐标列表（或 xyz 坐标列表）。我的问题是我想直接访问它返回的列表中的各个数字，但我一次只能访问整个列表。我的代码：

```
import numpy as np
a = [([2, -2, 0.29]), ([-2, 0, 1.9]), ([2, 1, 2.35]), ([2, -3, 2.96])]
b = [0,2,3]
myZip= list(zip(a,b))
result={}
for x in myZip:
    result.setdefault(x[1],[]).append(x[0])
xyz=[]
for each_index in b:
     xyz.append(result[each_index])
     print(xyz)
     xyz.clear() 
```

将返回：

```
[[[2, -2, 0.29]]]
[[[-2, 0, 1.9]]]
[[[2, 1, 2.35]]] 
```

我现在想把它分成 X 和 Y，这样 X=[2,-2,2] 和 Y=[-2,0,1]。我试过直接切片它，但我得到一个关于切片是整数而不是元组的错误。我还尝试转换为 numpy，然后使用 np.hsplit。如何做到这一点？谢谢男生（或女生）。

*编辑*

我意识到在这些情况下它一次只会打印一个，但在我的真实示例中，有时它会返回 ([x,y,x],[x,y,z])。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T13:30:53.907

使用列表推导：

```
>>> X = [result[i][0][0] for i in b]
>>> Y = [result[i][0][1] for i in b]
>>> print X, Y
[2, -2, 2] [-2, 0, 1] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T13:41:35.000

使用[zip(*a)](http://docs.python.org/2/library/functions.html#zip)：

```
>>> a = [[2, -2, 0.29], [-2, 0, 1.9], [2, 1, 2.35], [2, -3, 2.96]]

>>> b = [0,2,3]

>>> x, y, z = zip(*(a[i] for i in b))

>>> x
(2, 2, 2)

>>> y
(-2, 1, -3)

>>> z
(0.29, 2.35, 2.96) 
```

顺便说一句，您列表中的圆括号是多余的，所以我删除了它们。

# wordpress - 为什么我们的网站在 IE 中的加载速度比任何其他浏览器都慢？

> ID：15647178
> 
> 赞同：0
> 
> 时间：2013-03-26T20:53:00.990
> 
> 标签：wordpress, load-time, page-load-time

我们有一个 WordPress 网站，可以在我尝试过的每个浏览器中充分加载，IE 除外。出于某种原因，在 IE 中，每次加载页面时似乎都会将浏览器冻结几秒钟，如果它必须加载带有另一个页面的 iframe 的页面，则会加倍。用户必须等待一段时间才能与页面上的任何内容进行交互。

[这是网站](http://www.mercurypay.com)。

有人建议我们可以使用 WP Supercache 来解决这个问题，但我过去曾遇到过这个插件的问题并且不愿意依赖它，特别是因为这似乎只是 IE 中的一个问题。

我可以解决此问题的最佳方法是什么？如何找出页眉或页脚等中的哪些脚本导致它？有没有一种快速的方法，或者我只需要开始消除主题中的变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:12:14.650

多亏了我刚刚找到的这个线程，答案似乎是花式框：[花式框导致 IE 中的加载时间变慢？](https://stackoverflow.com/questions/6050269/fancybox-causing-slow-load-times-in-ie)

具体来说，fancybox 的 CSS 文件中特定于 IE 的过滤器。我删除了那些过滤器样式，现在可以正常加载了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T12:16:11.157

我不太明白为什么，但在 IE9 中 style.css 被向下推到页面加载顺序 - 请参阅请求 #35 [http://www.webpagetest.org/result/130327_Y9_f1d5796658d8475b68e2e537644173f1/1/details/](http://www.webpagetest.org/result/130327_Y9_f1d5796658d8475b68e2e537644173f1/1/details/)

由于浏览器在下载适用的 CSS 之前不会呈现，因此会阻止呈现。

另一方面，Chrome 优先考虑下载，以便在图像之前下载可能阻止渲染的资源。

这是两个加载体验的并排视频。

（如果您需要帮助进一步查看，我的联系方式在我的个人资料中）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:02:36.147

抱歉，我似乎无法发表评论。无论如何，在 Opera 12.14 中它运行良好。在 Explorer (8) 中它也能正常工作，控制台中没有错误。只是我的 0.1 美分。

# java - 如何连接哈希表中的键和值？

> ID：15647180
> 
> 赞同：-4
> 
> 时间：2013-03-26T20:53:04.583
> 
> 标签：java, collections, hash

我从“java中的数据结构和算法”中学习了哈希表，并且有一个我无法理解的概念。例如，我想建立一个电话簿。我想要一个哈希表，它以人名作为键并吐出他的手机。我了解如何使用哈希函数从人名创建数字索引。但是当我通过他的数字索引将这个人的名字插入到哈希表中之后，我怎样才能得到他的电话呢？我怎样才能在这个键和值之间建立联系？

编辑：我试图实现我自己的哈希表而不使用 java api

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:34:59.557

您应该在哈希表中存储一个键值对，而不仅仅是键。setter 方法接受键/值对，将它们包装成键/值对实例并存储在存储桶中。访问方法基于键计算存储桶索引并遍历对以寻找具有精确键的对象。可能是类 Map.Entry 可以给你一些想法。

# ruby - 在 ruby 中定义自定义运算符

> ID：15647182
> 
> 赞同：2
> 
> 时间：2013-03-26T20:53:15.613
> 
> 标签：ruby, operators, monkeypatching

我希望能够定义自定义运算符。那可能吗？例如，使`a***b`某事变得有意义。

是否也可以对现有运营商进行猴子补丁？例如，让`a**b`总是返回一个浮点数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T21:21:06.763

是的你可以。例如：

```
class Fixnum
  def **(x)
    self.*(x)*1.0
  end
end

5**4 #==> 20.0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T21:24:57.037

自定义运算符？除非你想破解[C 解析器](https://github.com/ruby/ruby/blob/ruby_2_0_0/parse.y#L1887)（或 JRuby 的 Java 解析器或......）。OTOH，运算符主要是方法的语法糖，您可以定义所有想要的方法。

由于许多运算符（[但不是全部](http://phrogz.net/ProgrammingRuby/language.html#table_18.4)）只是变相的方法，因此您可以随意修补现有运算符的实现。您必须追踪所有定义自己的`**`实现的数字类并修补所有这些类；请注意，您需要覆盖核心中的[`Rational`](https://ruby-doc.org/core/Rational.html), [`Complex`](https://ruby-doc.org/core/Complex.html), ... 以及标准库中的[BigDecimal等内容。](https://ruby-doc.org/stdlib/libdoc/bigdecimal/rdoc/BigDecimal.html)我强烈建议不要这样做，你只会让自己承受痛苦和折磨；例如，`BigDecimal#**`当结果不适合 a 时，你会怎么做`Float`？怎么样`Complex#**`？如果您需要s 某事，请通过调用`Float`使其明确。`to_f`

# java - 我可以使用 JPQL 查询通过加载 CSV 文件填充的 MySQL 数据库吗？

> ID：15647183
> 
> 赞同：0
> 
> 时间：2013-03-26T20:53:37.243
> 
> 标签：java, mysql, jpql

这是一个菜鸟问题，所以请多多包涵。

我正在构建一个部署在 JBoss 上的 Java Web 应用程序。部分功能是使用 Excel 电子表格中的数据填充 MySQL 数据库。这可以通过两种方式实现：

1.  使用 JExcel / Apache POI 解析电子表格数据并创建实体“bean”，然后将其持久化到数据库中。

2.  使用脚本将电子表格转换为 csv 文件，然后将 csv 文件加载到数据库中。

我的问题是：如果我选择脚本/csv 路由，我是否仍然可以使用 JPQL 来查询数据库，或者我是否必须求助于 Java 代码中的本机 SQL 查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:06:46.067

JPQL 可用于独立于用于填充表的方法查询表。存储到表中的数据不知道它是使用哪种方法插入的。

JPA 不会通过脚本通知对数据所做的更改，但在没有额外缓存和事务范围的[PersistenceContext](http://docs.oracle.com/javaee/6/api/javax/persistence/PersistenceContextType.html)的典型用例中，这不是问题，因为查询将访问数据库并提供新数据。

# eclipse - Eclipse EGit：Bitbucket 传输错误

> ID：15647184
> 
> 赞同：1
> 
> 时间：2013-03-26T20:53:43.563
> 
> 标签：eclipse, bitbucket, egit

![在此处输入图像描述](../Images/656ca9b007d89260cb9da4d6a53875cd.png)

这是我得到的错误。

我重新安装了所有东西，但仍然遇到同样的错误。这是我的 HTTPS 地址：[https://karlmorrison@bitbucket.org/Drotth/medialibrary.git](https://karlmorrison@bitbucket.org/Drotth/medialibrary.git)

这背后是什么问题，那我可能可以搜索！

# freebase - freebase - 主题描述/文章

> ID：15647185
> 
> 赞同：2
> 
> 时间：2013-03-26T20:53:49.297
> 
> 标签：freebase, mql

我正在尝试以意大利语检索**某些**电影（“ */film/film* ”）和电影类型（“ *film/film_genre* ”）的**主题描述**。

 ****我认为这两种情况下的问题是相同的，所以我发布了我试图为电影类型描述运行的 MQL 查询：

* * *

**Mql 查询**

```
[{
  "type": "/film/film_genre",
  "name": "Film culto",
  "/common/topic/article": [{
    "id": null
  }]
}] 
```

**回复**

```
{
  "result": [{
    "type": "/film/film_genre",
    "name": "Film culto",
    "/common/topic/article": [{
      "id": "/m/01q0d"
    }]
  }]
} 
```

* * *

收到文章 ID（“ */m/01q0d* ”）后，我将使用“trans/wrap”服务（[http://api.freebase.com/api/trans/raw/m/01q0d](http://api.freebase.com/api/trans/raw/m/01q0d)）。但是，即使我使用查询参数“lang=it”，文章也是英文的...... :(

有什么建议么？我要疯了 :D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:53:25.200

Freebase 包含非英语名称，但在大多数情况下，它不包含英语以外的任何描述。您可以使用主题 API 并获取意大利 Wikipedia 的 /common/topic/topic_equivalent_webpage 以从那里获取文章/描述，但这可能是您将获得的最接近的。

[https://www.googleapis.com/freebase/v1/topic/m/01q03](https://www.googleapis.com/freebase/v1/topic/m/01q03)

而且，正如 Phil 所说，api.freebase.com 将在几天内消失，因此您需要使用新的 API。****

# css - 闪烁在 Chrome 中不起作用

> ID：15647186
> 
> 赞同：19
> 
> 时间：2013-03-26T20:53:53.313
> 
> 标签：css, google-chrome, blink

我`blink`在我的应用程序中使用来显示错误消息。问题是它可以在 Firefox 中运行，但不能在 Chrome 中运行。我不知道问题是什么。我怎样才能让它在 Chrome 中工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-26T20:55:23.553

将以下代码添加到您的 css 文件中，

```
blink {
-webkit-animation-name: blink; 
-webkit-animation-iteration-count: infinite; 
-webkit-animation-timing-function: cubic-bezier(1.0,0,0,1.0);
-webkit-animation-duration: 1s;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-09-02T08:02:19.713

```
blink, .blink {
    -webkit-animation: blink 1s step-end infinite;
    -moz-animation: blink 1s step-end infinite;
    -o-animation: blink 1s step-end infinite;
    animation: blink 1s step-end infinite;
}
@-webkit-keyframes blink { 67% { opacity: 0 }}
@-moz-keyframes blink {  67% { opacity: 0 }}
@-o-keyframes blink {  67% { opacity: 0 }}
@keyframes blink {  67% { opacity: 0 }} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-26T21:01:16.117

它已被弃用，因此您可以尝试使用 javascript 来执行此操作。这是我为您使用 jquery 制作的示例：http: [//jsfiddle.net/FPsdy/](http://jsfiddle.net/FPsdy/)这很简单：

```
window.setInterval(function(){
  $('.blink').toggle();
}, 250); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-26T20:55:18.827

Blink 已弃用，您不应使用它。

[http://www.w3.org/wiki/HTML/Elements/blink](http://www.w3.org/wiki/HTML/Elements/blink)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-12T05:22:34.677

尝试将以下代码行添加到您的 css 文件中。

```
blink {
   -webkit-animation-name: blink; 
   -webkit-animation-iteration-count: infinite; 
   -webkit-animation-timing-function: cubic- 
    bezierr(1.0,0,0,1.0);
    -webkit-animation-duration: 1s;
  } 
```

这是因为许多浏览器不支持少数 css 函数。您应该尝试更新您的 chrome 浏览器。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2019-07-29T11:18:38.757

只需要导入一个 jquery.min.js 文件即可使用此代码。

```
window.setInterval(function(){
    $('.blink').css("opacity","0.5");
    window.setTimeout(function(){
        $('.blink').css("opacity","1");
    },750);
}, 1500); 
```

# oracle - Oracle PL/SQL 触发器错误

> ID：15647188
> 
> 赞同：0
> 
> 时间：2013-03-26T20:53:58.570
> 
> 标签：oracle, plsql

我正在尝试获取触发器来更新报告编号和后缀并与 Coldfusion ORM 兼容。为了使这适用于具有单个键的表，我使用了下面示例的第一部分。在此表中，如果给出报告编号，我需要将后缀更新为下一个值。

```
CREATE TABLE tb1 ( reportnum NUMBER, suffix NUMBER );

CREATE SEQUENCE seq1 START WITH 1;

CREATE OR REPLACE TRIGGER "TRG1_TB1" BEFORE INSERT ON
tb1 FOR EACH ROW
BEGIN
    IF :NEW.reportnum IS NULL  THEN
        SELECT seq1.NEXTVAL INTO :NEW.reportnum FROM dual;

    ELSIF :NEW.REPORTNUM = ''  THEN
        SELECT seq1.NEXTVAL INTO :NEW.reportnum FROM dual;

    ELSIF :NEW.suffix = '' THEN
        SELECT MAX(suffix)+1 INTO :NEW.suffix FROM tb1 WHERE reportnum = :NEW.reportnum

    ELSIF :NEW.suffix = NULL THEN
        SELECT MAX(suffix)+1 INTO :NEW.suffix FROM tb1 WHERE reportnum = :NEW.reportnum

    END IF; 
END; 
```

我得到的错误是他们的命令没有正确结束。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T20:59:57.643

`;`在后缀查询末尾添加

```
 ELSIF :NEW.suffix = '' THEN
    SELECT MAX(suffix)+1 INTO :NEW.suffix 
    FROM tb1 WHERE reportnum = :NEW.reportnum;

ELSIF :NEW.suffix = NULL THEN
    SELECT MAX(suffix)+1 INTO :NEW.suffix 
    FROM tb1 WHERE reportnum = :NEW.reportnum; 
```

您还可以通过这样做来减少两者的 if 语句数量：例如：

```
 IF coalesce(:NEW.reportnum,-1) = -1  THEN
    SELECT seq1.NEXTVAL INTO :NEW.reportnum FROM dual;  

ELSIF coalesce(:NEW.suffix,-1) = -1 THEN
    SELECT MAX(suffix)+1 INTO :NEW.suffix 
    FROM tb1 WHERE reportnum = :NEW.reportnum;
END IF; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T18:03:12.040

您没有收到 Oracle PL/SQL 触发器错误，这是语法错误。尝试这个：

CREATE TABLE tb1 (reportnum NUMBER, 后缀 NUMBER);

创建序列 seq1 从 1 开始；

在插入 tb1 之前创建或替换触发器“TRG1_TB1”，如果：NEW.reportnum 为 NULL，则每行开始，然后从 dual 中选择 seq1.NEXTVAL INTO：NEW.reportnum；

```
ELSIF :NEW.suffix is NULL THEN
    SELECT MAX(suffix)+1 INTO :NEW.suffix FROM tb1 WHERE reportnum = :NEW.reportnum;

END IF; 
```

结尾;

# ruby-on-rails - Rails::Rack:LogTailer 和 Unicorn

> ID：15647191
> 
> 赞同：0
> 
> 时间：2013-03-26T20:54:04.557
> 
> 标签：ruby-on-rails, ruby-on-rails-3, logging, rack, unicorn

我正在从瘦切换到独角兽。到目前为止，一切正常，我的测试也通过了，但我没有在终端中获得有用的日志语句。我必须`tail log/development.log`看看实际发生了什么。

我阅读了[http://dave.is/unicorn.html](http://dave.is/unicorn.html)并且能够通过将日志转移到 STDOUT 来使其工作，但我也希望能够拥有我的开发日志文件，所以我`grep`以后可以.

如何添加 Rails::Rack::LogTailer 以使我的日志在我启动服务器后也显示出来？

也许我不需要 Rails::Rack::LogTailer？我不想在每次请求后都跟踪我的日志文件。

如果这是相关的……我正在运行 Rails 3.2.13、Rack 1.4.5 和 Unicorn 4.6.2。

- 编辑 -

我尝试将其添加到我的末尾`config/environments/development.rb`

`config.middleware.insert_after(Rails::Rack::Logger, Rails::Rack::LogTailer, "/log/development.log")`

但这似乎没有任何效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-09T11:53:57.993

修复很简单，删除前导“/”。

将：“/log/development.log”更改
为：“log/development.log”

# iphone - CGLayerCreateWithContext CGContext leak

> ID：15647195
> 
> 赞同：2
> 
> 时间：2013-03-26T20:54:10.167
> 
> 标签：iphone, ios, objective-c, memory-leaks, cgcontext

**Why is this leak occurring?**

I very much dislike the idea of asking a question that's very specific and unlikely to help very many other people but after hours of scratching my head I'm left with no option.

The leaks instrument reports that the following code has a leak:

```
- (void)likeABarrelFullOfHoles
{
    UIGraphicsBeginImageContextWithOptions(CGSizeMake(50.0f, 50.0f), YES, 0.0f);
    CGContextRef context = UIGraphicsGetCurrentContext();

    CGLayerRef *shapeLayers = malloc(3 * sizeof(*shapeLayers));

    for (int i = 0; i < 3; i++)
    {
        // Leak culprit.
        shapeLayers[i] = CGLayerCreateWithContext(context, CGSizeMake(5.0f, 5.0f), NULL);
    }

    for (int i = 0; i < 3; i++) {
        free(shapeLayers[i]);
    }
    free(shapeLayers);

    UIGraphicsEndImageContext();
} 
```

Specifically, it reports that the `CGLayerCreateWithContext` function is the problem but that it's leaking [CGContext](https://developer.apple.com/library/ios/#documentation/graphicsimaging/reference/CGContext/Reference/reference.html) objects and not [CGLayer](https://developer.apple.com/library/ios/#documentation/graphicsimaging/reference/CGLayer/Reference/reference.html) objects, which it returns:

![Leaks](../Images/527decab867329236af45331c95b3f05.png) ![Leaks](../Images/54b702023234e33593fda2d7f333f096.png)

I don't doubt that my problem is due to a fundamental lack of understanding of memory management/dynamic allocation and someone is going to wave their 'you should know this' finger at me because the following code appears to have no leaks:

```
- (void)noLeaks
{
    UIGraphicsBeginImageContextWithOptions(CGSizeMake(50.0f, 50.0f), YES, 0.0f);
    CGContextRef context = UIGraphicsGetCurrentContext();

    CGLayerRef shapeLayer = CGLayerCreateWithContext(context, CGSizeMake(5.0f, 5.0f), NULL);
    CGLayerRelease(shapeLayer);

    UIGraphicsEndImageContext();
} 
```

* * *

Please note that this is obviously the problem reduced to its simplest reproducible state. I'm using dynamic memory allocation because in my actual code the size of the array isn't known at compile time.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:01:56.770

我无法告诉您为什么 Instruments 报告说`CGContext`对象正在泄漏，而不是`CGLayer`，而是使用创建的层

```
shapeLayers[i] = CGLayerCreateWithContext(context, CGSizeMake(5.0f, 5.0f), NULL); 
```

绝对必须与

```
CGLayerRelease(shapeLayers[i]); 
```

而不是

```
free(shapeLayers[i]); 
```

`CGLayerCreateWithContext`不是`malloc`，因此调用`free`该对象可能会导致内存损坏。

# c# - Missing Cookies; getting 1/3.. I thought this was handled automatically, why are things not working correctly

> ID：15647198
> 
> 赞同：0
> 
> 时间：2013-03-26T20:54:27.080
> 
> 标签：c#, cookies

There is this trend of cookies not turning up. I copy fiddler exactly and it should be a simple task since it's handled automatically anyway. Why am I not getting proper cookie retrieval?

```
public class HTTP : WebClient
{
    public HTTP()
        : this(new CookieContainer())
    { }

    public HTTP(CookieContainer c)
    {
        CookieContainer = c;
    }
    public CookieContainer CookieContainer { get; set; }

    protected override WebRequest GetWebRequest(Uri address)
    {
        WebRequest request = base.GetWebRequest(address);

        var castRequest = request as HttpWebRequest;
        if (castRequest != null)
        {
            castRequest.CookieContainer = CookieContainer;
            castRequest.Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";
            castRequest.UserAgent = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.22 (KHTML, like Gecko) Chrome/25.0.1364.172 Safari/537.22";

        }

        return request;
    }
} 

public void checkUrl()
{
CookieContainer cookieJar = new CookieContainer();
HTTP client = new HTTP(cookieJar);

string responseData = client.DownloadString(url);
       responseData = client.UploadString(url, loginData);
rtb.Text = responseData;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:24:06.183

You probably want to hook into the WebResponse and read the cookies from there. The request does not change after it is sent.

# ruby-on-rails - Ruby on Rails: deploying project

> ID：15647203
> 
> 赞同：1
> 
> 时间：2013-03-26T20:54:38.323
> 
> 标签：ruby-on-rails, ruby, heroku

When I try to deploy my project to heroku, it writes me "we are sorry but something went wrong". I'm newbie and I don't know where is problem.

There is one thing I completely don't understand: where can i find settings for production mode? I toke it from postgres.heroku.com.

My gemfile:

```
source 'https://rubygems.org'

gem 'pg'
gem 'rails', '3.2.12'
gem 'gravatar_image_tag', '1.0.0.pre2'
gem "will_paginate", :git => "https://github.com/p7r/will_paginate.git", :branch => "rails3"
gem 'yaml_db', :git => 'git://github.com/ludicast/yaml_db.git'

group :development, :test do
  gem 'faker', '0.3.1'
end

group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'

group :test do
  gem 'rspec-rails', '2.6.1'
  gem 'webrat', '0.7.1'
end 
```

My database:yml

```
development:
  host: localhost
  adapter: postgresql
  encoding: utf8
  database: app_development
  pool: 5
  timeout: 5000
  username: nikita
  password: '0761'

test:
  host: localhost
  adapter: postgresql
  encoding: utf8
  database: app_test
  pool: 5
  timeout: 5000
  username: nikita
  password: '0761'

production:
  host: ec2-54-243-125-2.compute-1.amazonaws.com
  adapter: postgresql
  encoding: utf8
  database: d8ndsoaide8227
  pool: 5
  port:  5432
  username: gglrqupemilczi
  password: 'TK02bb-oXqLHD9fTGi_FnahKMl' 
```

My logs from heroku:

```
2013-03-26T20:38:10+00:00 app[web.1]: => Rails 3.2.12 application starting in production on http://0.0.0.0:30982
2013-03-26T20:38:10+00:00 app[web.1]: => Call with -d to detach
2013-03-26T20:38:10+00:00 app[web.1]: => Ctrl-C to shutdown server
2013-03-26T20:38:10+00:00 app[web.1]: Connecting to database specified by DATABASE_URL
2013-03-26T20:38:10+00:00 app[web.1]: [2013-03-26 20:38:10] INFO  ruby 1.9.2 (2011-07-09) [x86_64-linux]
2013-03-26T20:38:10+00:00 app[web.1]: [2013-03-26 20:38:10] INFO  WEBrick::HTTPServer#start: pid=2 port=30982
2013-03-26T20:38:10+00:00 app[web.1]: [2013-03-26 20:38:10] INFO  WEBrick 1.3.1
2013-03-26T20:38:11+00:00 heroku[web.1]: State changed from starting to up
2013-03-26T20:38:22+00:00 app[web.1]: Started GET "/" for 46.72.99.61 at 2013-03-26 20:38:22 +0000
2013-03-26T20:38:22+00:00 app[web.1]: Processing by PagesController#home as HTML
2013-03-26T20:38:22+00:00 app[web.1]:   Rendered pages/home.html.erb within layouts/application (18.6ms)
2013-03-26T20:38:22+00:00 app[web.1]:   Rendered layouts/_stylesheets.html.erb (0.3ms)
2013-03-26T20:38:22+00:00 heroku[router]: at=info method=GET path=/ host=ancient-cliffs-5913.herokuapp.com fwd="46.72.99.61" dyno=web.1 connect=1ms service=841ms status=500 bytes=643
2013-03-26T20:38:22+00:00 app[web.1]:   Rendered layouts/_menu.html.erb (149.2ms)
2013-03-26T20:38:22+00:00 app[web.1]: Completed 500 Internal Server Error in 295ms
2013-03-26T20:38:22+00:00 app[web.1]: 
2013-03-26T20:38:22+00:00 app[web.1]: ActionView::Template::Error (PG::Error: ERROR:  relation "users" does not exist
2013-03-26T20:38:22+00:00 app[web.1]:                                         ^
2013-03-26T20:38:22+00:00 app[web.1]:                      pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod
2013-03-26T20:38:22+00:00 app[web.1]:                 ON a.attrelid = d.adrelid AND a.attnum = d.adnum
2013-03-26T20:38:22+00:00 app[web.1]:              WHERE a.attrelid = '"users"'::regclass
2013-03-26T20:38:22+00:00 app[web.1]:                AND a.attnum > 0 AND NOT a.attisdropped
2013-03-26T20:38:22+00:00 app[web.1]: ):
2013-03-26T20:38:22+00:00 app[web.1]: LINE 5:              WHERE a.attrelid = '"users"'::regclass
2013-03-26T20:38:22+00:00 app[web.1]:              ORDER BY a.attnum
2013-03-26T20:38:22+00:00 app[web.1]: :             SELECT a.attname, format_type(a.atttypid, a.atttypmod),
2013-03-26T20:38:22+00:00 app[web.1]:               FROM pg_attribute a LEFT JOIN pg_attrdef d
2013-03-26T20:38:22+00:00 app[web.1]:     5:            <div class="nav-collapse collapse">
2013-03-26T20:38:22+00:00 app[web.1]:   app/helpers/sessions_helper.rb:42:in `user_from_remember_token'
2013-03-26T20:38:22+00:00 app[web.1]:   app/models/user.rb:32:in `authenticate_with_salt'
2013-03-26T20:38:22+00:00 app[web.1]:   app/views/layouts/_menu.html.erb:8:in `_app_views_layouts__menu_html_erb__3915312893639424325_36046660'
2013-03-26T20:38:22+00:00 app[web.1]:   app/helpers/sessions_helper.rb:13:in `current_user'
2013-03-26T20:38:22+00:00 app[web.1]:     7:                    <li class="active"><%= link_to "Главная", home_path %></li>
2013-03-26T20:38:22+00:00 app[web.1]:     6:                <ul class="nav">
2013-03-26T20:38:22+00:00 app[web.1]:     8:                    <% if signed_in? %>
2013-03-26T20:38:22+00:00 app[web.1]:     9:                <!--<li><%= link_to "Users", users_path %></li>-->
2013-03-26T20:38:22+00:00 app[web.1]:     10:                   <li><%= link_to "Меню", menu_path %></li>
2013-03-26T20:38:22+00:00 app[web.1]:   app/views/layouts/application.html.erb:15:in `_app_views_layouts_application_html_erb__796508102528627285_36433920'
2013-03-26T20:38:22+00:00 app[web.1]:     11:                   <li><%= link_to "Заказ", "#" %></li>
2013-03-26T20:38:22+00:00 app[web.1]: 
2013-03-26T20:38:22+00:00 app[web.1]:   app/helpers/sessions_helper.rb:17:in `signed_in?'
2013-03-26T20:38:22+00:00 app[web.1]: 
2013-03-26T20:38:23+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=ancient-cliffs-5913.herokuapp.com fwd="46.72.99.61" dyno=web.1 connect=3ms service=15ms status=200 bytes=0
2013-03-26T20:42:50+00:00 heroku[slugc]: Slug compilation started
2013-03-26T20:43:19+00:00 heroku[api]: Release v16 created by nikskalkin@gmail.com
2013-03-26T20:43:20+00:00 heroku[api]: Deploy aa717ce by nikskalkin@gmail.com
2013-03-26T20:43:20+00:00 heroku[web.1]: State changed from up to starting
2013-03-26T20:43:20+00:00 heroku[slugc]: Slug compilation finished
2013-03-26T20:43:22+00:00 heroku[web.1]: Starting process with command `bundle exec rails server -p 46174`
2013-03-26T20:43:22+00:00 heroku[web.1]: Stopping all processes with SIGTERM
2013-03-26T20:43:22+00:00 app[web.1]: [2013-03-26 20:43:22] ERROR SignalException: SIGTERM
2013-03-26T20:43:22+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/server.rb:90:in `select'
2013-03-26T20:43:25+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2013-03-26T20:43:25+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2013-03-26T20:43:27+00:00 app[web.1]: => Booting WEBrick
2013-03-26T20:43:27+00:00 app[web.1]: => Ctrl-C to shutdown server
2013-03-26T20:43:27+00:00 app[web.1]: => Call with -d to detach
2013-03-26T20:43:27+00:00 app[web.1]: Connecting to database specified by DATABASE_URL
2013-03-26T20:43:27+00:00 app[web.1]: => Rails 3.2.12 application starting in production on http://0.0.0.0:46174
2013-03-26T20:43:28+00:00 app[web.1]: [2013-03-26 20:43:28] INFO  WEBrick 1.3.1
2013-03-26T20:43:28+00:00 app[web.1]: [2013-03-26 20:43:28] INFO  ruby 1.9.2 (2011-07-09) [x86_64-linux]
2013-03-26T20:43:28+00:00 app[web.1]: [2013-03-26 20:43:28] INFO  WEBrick::HTTPServer#start: pid=2 port=46174
2013-03-26T20:43:33+00:00 heroku[web.1]: Error R12 (Exit timeout) -> At least one process failed to exit within 10 seconds of SIGTERM
2013-03-26T20:43:33+00:00 heroku[web.1]: Stopping remaining processes with SIGKILL
2013-03-26T20:43:34+00:00 heroku[web.1]: State changed from starting to up
2013-03-26T20:43:34+00:00 heroku[web.1]: Process exited with status 137
2013-03-26T20:43:50+00:00 app[web.1]: Started GET "/" for 46.72.99.61 at 2013-03-26 20:43:50 +0000
2013-03-26T20:43:50+00:00 app[web.1]: Processing by PagesController#home as HTML
2013-03-26T20:43:50+00:00 app[web.1]:   Rendered pages/home.html.erb within layouts/application (8.0ms)
2013-03-26T20:43:50+00:00 app[web.1]:   Rendered layouts/_stylesheets.html.erb (0.3ms)
2013-03-26T20:43:50+00:00 app[web.1]: 
2013-03-26T20:43:50+00:00 app[web.1]: Completed 500 Internal Server Error in 123ms
2013-03-26T20:43:50+00:00 app[web.1]: ActionView::Template::Error (PG::Error: ERROR:  relation "users" does not exist
2013-03-26T20:43:50+00:00 app[web.1]: LINE 5:              WHERE a.attrelid = '"users"'::regclass
2013-03-26T20:43:50+00:00 app[web.1]:   Rendered layouts/_menu.html.erb (19.6ms)
2013-03-26T20:43:50+00:00 app[web.1]:                                         ^
2013-03-26T20:43:50+00:00 app[web.1]: :             SELECT a.attname, format_type(a.atttypid, a.atttypmod),
2013-03-26T20:43:50+00:00 app[web.1]:                      pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod
2013-03-26T20:43:50+00:00 app[web.1]:               FROM pg_attribute a LEFT JOIN pg_attrdef d
2013-03-26T20:43:50+00:00 app[web.1]:                 ON a.attrelid = d.adrelid AND a.attnum = d.adnum
2013-03-26T20:43:50+00:00 app[web.1]:              WHERE a.attrelid = '"users"'::regclass
2013-03-26T20:43:50+00:00 app[web.1]:              ORDER BY a.attnum
2013-03-26T20:43:50+00:00 app[web.1]:                AND a.attnum > 0 AND NOT a.attisdropped
2013-03-26T20:43:50+00:00 app[web.1]: ):
2013-03-26T20:43:50+00:00 app[web.1]:     5:            <div class="nav-collapse collapse">
2013-03-26T20:43:50+00:00 app[web.1]:     6:                <ul class="nav">
2013-03-26T20:43:50+00:00 app[web.1]:     7:                    <li class="active"><%= link_to "Главная", home_path %></li>
2013-03-26T20:43:50+00:00 app[web.1]:     8:                    <% if signed_in? %>
2013-03-26T20:43:50+00:00 app[web.1]:     10:                   <li><%= link_to "Меню", menu_path %></li>
2013-03-26T20:43:50+00:00 app[web.1]:   app/models/user.rb:32:in `authenticate_with_salt'
2013-03-26T20:43:50+00:00 app[web.1]:     11:                   <li><%= link_to "Заказ", "#" %></li>
2013-03-26T20:43:50+00:00 app[web.1]:   app/helpers/sessions_helper.rb:17:in `signed_in?'
2013-03-26T20:43:50+00:00 app[web.1]:   app/helpers/sessions_helper.rb:13:in `current_user'
2013-03-26T20:43:50+00:00 app[web.1]: 
2013-03-26T20:43:50+00:00 app[web.1]: 
2013-03-26T20:43:50+00:00 app[web.1]:   app/views/layouts/application.html.erb:15:in `_app_views_layouts_application_html_erb__1372676093577475516_38604840'
2013-03-26T20:43:50+00:00 app[web.1]:   app/views/layouts/_menu.html.erb:8:in `_app_views_layouts__menu_html_erb___1404536040465121211_38027760'
2013-03-26T20:43:50+00:00 app[web.1]:   app/helpers/sessions_helper.rb:42:in `user_from_remember_token'
2013-03-26T20:43:50+00:00 app[web.1]:     9:                <!--<li><%= link_to "Users", users_path %></li>-->
2013-03-26T20:43:50+00:00 heroku[router]: at=info method=GET path=/ host=ancient-cliffs-5913.herokuapp.com fwd="46.72.99.61" dyno=web.1 connect=3ms service=292ms status=500 bytes=643
2013-03-26T20:43:50+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=ancient-cliffs-5913.herokuapp.com fwd="46.72.99.61" dyno=web.1 connect=7ms service=8ms status=200 bytes=0
root@Nikita-PC:/home/nikita/rails/invent# heroku logs
2013-03-26T20:38:10+00:00 app[web.1]: => Rails 3.2.12 application starting in production on http://0.0.0.0:30982
2013-03-26T20:38:10+00:00 app[web.1]: => Call with -d to detach
2013-03-26T20:38:10+00:00 app[web.1]: => Ctrl-C to shutdown server
2013-03-26T20:38:10+00:00 app[web.1]: Connecting to database specified by DATABASE_URL
2013-03-26T20:38:10+00:00 app[web.1]: [2013-03-26 20:38:10] INFO  ruby 1.9.2 (2011-07-09) [x86_64-linux]
2013-03-26T20:38:10+00:00 app[web.1]: [2013-03-26 20:38:10] INFO  WEBrick::HTTPServer#start: pid=2 port=30982
2013-03-26T20:38:10+00:00 app[web.1]: [2013-03-26 20:38:10] INFO  WEBrick 1.3.1
2013-03-26T20:38:11+00:00 heroku[web.1]: State changed from starting to up
2013-03-26T20:38:22+00:00 app[web.1]: Started GET "/" for 46.72.99.61 at 2013-03-26 20:38:22 +0000
2013-03-26T20:38:22+00:00 app[web.1]: Processing by PagesController#home as HTML
2013-03-26T20:38:22+00:00 app[web.1]:   Rendered pages/home.html.erb within layouts/application (18.6ms)
2013-03-26T20:38:22+00:00 app[web.1]:   Rendered layouts/_stylesheets.html.erb (0.3ms)
2013-03-26T20:38:22+00:00 heroku[router]: at=info method=GET path=/ host=ancient-cliffs-5913.herokuapp.com fwd="46.72.99.61" dyno=web.1 connect=1ms service=841ms status=500 bytes=643
2013-03-26T20:38:22+00:00 app[web.1]:   Rendered layouts/_menu.html.erb (149.2ms)
2013-03-26T20:38:22+00:00 app[web.1]: Completed 500 Internal Server Error in 295ms
2013-03-26T20:38:22+00:00 app[web.1]: 
2013-03-26T20:38:22+00:00 app[web.1]: ActionView::Template::Error (PG::Error: ERROR:  relation "users" does not exist
2013-03-26T20:38:22+00:00 app[web.1]:                                         ^
2013-03-26T20:38:22+00:00 app[web.1]:                      pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod
2013-03-26T20:38:22+00:00 app[web.1]:                 ON a.attrelid = d.adrelid AND a.attnum = d.adnum
2013-03-26T20:38:22+00:00 app[web.1]:              WHERE a.attrelid = '"users"'::regclass
2013-03-26T20:38:22+00:00 app[web.1]:                AND a.attnum > 0 AND NOT a.attisdropped
2013-03-26T20:38:22+00:00 app[web.1]: ):
2013-03-26T20:38:22+00:00 app[web.1]: LINE 5:              WHERE a.attrelid = '"users"'::regclass
2013-03-26T20:38:22+00:00 app[web.1]:              ORDER BY a.attnum
2013-03-26T20:38:22+00:00 app[web.1]: :             SELECT a.attname, format_type(a.atttypid, a.atttypmod),
2013-03-26T20:38:22+00:00 app[web.1]:               FROM pg_attribute a LEFT JOIN pg_attrdef d
2013-03-26T20:38:22+00:00 app[web.1]:     5:            <div class="nav-collapse collapse">
2013-03-26T20:38:22+00:00 app[web.1]:   app/helpers/sessions_helper.rb:42:in `user_from_remember_token'
2013-03-26T20:38:22+00:00 app[web.1]:   app/models/user.rb:32:in `authenticate_with_salt'
2013-03-26T20:38:22+00:00 app[web.1]:   app/views/layouts/_menu.html.erb:8:in `_app_views_layouts__menu_html_erb__3915312893639424325_36046660'
2013-03-26T20:38:22+00:00 app[web.1]:   app/helpers/sessions_helper.rb:13:in `current_user'
2013-03-26T20:38:22+00:00 app[web.1]:     7:                    <li class="active"><%= link_to "Главная", home_path %></li>
2013-03-26T20:38:22+00:00 app[web.1]:     6:                <ul class="nav">
2013-03-26T20:38:22+00:00 app[web.1]:     8:                    <% if signed_in? %>
2013-03-26T20:38:22+00:00 app[web.1]:     9:                <!--<li><%= link_to "Users", users_path %></li>-->
2013-03-26T20:38:22+00:00 app[web.1]:     10:                   <li><%= link_to "Меню", menu_path %></li>
2013-03-26T20:38:22+00:00 app[web.1]:   app/views/layouts/application.html.erb:15:in `_app_views_layouts_application_html_erb__796508102528627285_36433920'
2013-03-26T20:38:22+00:00 app[web.1]:     11:                   <li><%= link_to "Заказ", "#" %></li>
2013-03-26T20:38:22+00:00 app[web.1]: 
2013-03-26T20:38:22+00:00 app[web.1]:   app/helpers/sessions_helper.rb:17:in `signed_in?'
2013-03-26T20:38:22+00:00 app[web.1]: 
2013-03-26T20:38:23+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=ancient-cliffs-5913.herokuapp.com fwd="46.72.99.61" dyno=web.1 connect=3ms service=15ms status=200 bytes=0
2013-03-26T20:42:50+00:00 heroku[slugc]: Slug compilation started
2013-03-26T20:43:19+00:00 heroku[api]: Release v16 created by nikskalkin@gmail.com
2013-03-26T20:43:20+00:00 heroku[api]: Deploy aa717ce by nikskalkin@gmail.com
2013-03-26T20:43:20+00:00 heroku[web.1]: State changed from up to starting
2013-03-26T20:43:20+00:00 heroku[slugc]: Slug compilation finished
2013-03-26T20:43:22+00:00 heroku[web.1]: Starting process with command `bundle exec rails server -p 46174`
2013-03-26T20:43:22+00:00 heroku[web.1]: Stopping all processes with SIGTERM
2013-03-26T20:43:22+00:00 app[web.1]: [2013-03-26 20:43:22] ERROR SignalException: SIGTERM
2013-03-26T20:43:22+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/server.rb:90:in `select'
2013-03-26T20:43:25+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2013-03-26T20:43:25+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-style plugins in vendor/plugins! Support for these plugins will be removed in Rails 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your app as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes for more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been-released. (called from <top (required)> at /app/config/environment.rb:5)
2013-03-26T20:43:27+00:00 app[web.1]: => Booting WEBrick
2013-03-26T20:43:27+00:00 app[web.1]: => Ctrl-C to shutdown server
2013-03-26T20:43:27+00:00 app[web.1]: => Call with -d to detach
2013-03-26T20:43:27+00:00 app[web.
1]: Connecting to database specified by DATABASE_URL
2013-03-26T20:43:27+00:00 app[web.1]: => Rails 3.2.12 application starting in production on http://0.0.0.0:46174
2013-03-26T20:43:28+00:00 app[web.1]: [2013-03-26 20:43:28] INFO  WEBrick 1.3.1
2013-03-26T20:43:28+00:00 app[web.1]: [2013-03-26 20:43:28] INFO  ruby 1.9.2 (2011-07-09) [x86_64-linux]
2013-03-26T20:43:28+00:00 app[web.1]: [2013-03-26 20:43:28] INFO  WEBrick::HTTPServer#start: pid=2 port=46174
2013-03-26T20:43:33+00:00 heroku[web.1]: Error R12 (Exit timeout) -> At least one process failed to exit within 10 seconds of SIGTERM
2013-03-26T20:43:33+00:00 heroku[web.1]: Stopping remaining processes with SIGKILL
2013-03-26T20:43:34+00:00 heroku[web.1]: State changed from starting to up
2013-03-26T20:43:34+00:00 heroku[web.1]: Process exited with status 137
2013-03-26T20:43:50+00:00 app[web.1]: Started GET "/" for 46.72.99.61 at 2013-03-26 20:43:50 +0000
2013-03-26T20:43:50+00:00 app[web.1]: Processing by PagesController#home as HTML
2013-03-26T20:43:50+00:00 app[web.1]:   Rendered pages/home.html.erb within layouts/application (8.0ms)
2013-03-26T20:43:50+00:00 app[web.1]:   Rendered layouts/_stylesheets.html.erb (0.3ms)
2013-03-26T20:43:50+00:00 app[web.1]: 
2013-03-26T20:43:50+00:00 app[web.1]: Completed 500 Internal Server Error in 123ms
2013-03-26T20:43:50+00:00 app[web.1]: ActionView::Template::Error (PG::Error: ERROR:  relation "users" does not exist
2013-03-26T20:43:50+00:00 app[web.1]: LINE 5:              WHERE a.attrelid = '"users"'::regclass
2013-03-26T20:43:50+00:00 app[web.1]:   Rendered layouts/_menu.html.erb (19.6ms)
2013-03-26T20:43:50+00:00 app[web.1]:                                         ^
2013-03-26T20:43:50+00:00 app[web.1]: :             SELECT a.attname, format_type(a.atttypid, a.atttypmod),
2013-03-26T20:43:50+00:00 app[web.1]:                      pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod
2013-03-26T20:43:50+00:00 app[web.1]:               FROM pg_attribute a LEFT JOIN pg_attrdef d
2013-03-26T20:43:50+00:00 app[web.1]:                 ON a.attrelid = d.adrelid AND a.attnum = d.adnum
2013-03-26T20:43:50+00:00 app[web.1]:              WHERE a.attrelid = '"users"'::regclass
2013-03-26T20:43:50+00:00 app[web.1]:              ORDER BY a.attnum
2013-03-26T20:43:50+00:00 app[web.1]:                AND a.attnum > 0 AND NOT a.attisdropped
2013-03-26T20:43:50+00:00 app[web.1]: ):
2013-03-26T20:43:50+00:00 app[web.1]:     5:            <div class="nav-collapse collapse">
2013-03-26T20:43:50+00:00 app[web.1]:     6:                <ul class="nav">
2013-03-26T20:43:50+00:00 app[web.1]:     7:                    <li class="active"><%= link_to "Главная", home_path %></li>
2013-03-26T20:43:50+00:00 app[web.1]:     8:                    <% if signed_in? %>
2013-03-26T20:43:50+00:00 app[web.1]:     10:                   <li><%= link_to "Меню", menu_path %></li>
2013-03-26T20:43:50+00:00 app[web.1]:   app/models/user.rb:32:in `authenticate_with_salt'
2013-03-26T20:43:50+00:00 app[web.1]:     11:                   <li><%= link_to "Заказ", "#" %></li>
2013-03-26T20:43:50+00:00 app[web.1]:   app/helpers/sessions_helper.rb:17:in `signed_in?'
2013-03-26T20:43:50+00:00 app[web.1]:   app/helpers/sessions_helper.rb:13:in `current_user'
2013-03-26T20:43:50+00:00 app[web.1]: 
2013-03-26T20:43:50+00:00 app[web.1]: 
2013-03-26T20:43:50+00:00 app[web.1]:   app/views/layouts/application.html.erb:15:in `_app_views_layouts_application_html_erb__1372676093577475516_38604840'
2013-03-26T20:43:50+00:00 app[web.1]:   app/views/layouts/_menu.html.erb:8:in `_app_views_layouts__menu_html_erb___1404536040465121211_38027760'
2013-03-26T20:43:50+00:00 app[web.1]:   app/helpers/sessions_helper.rb:42:in `user_from_remember_token'
2013-03-26T20:43:50+00:00 app[web.1]:     9:                <!--<li><%= link_to "Users", users_path %></li>-->
2013-03-26T20:43:50+00:00 heroku[router]: at=info method=GET path=/ host=ancient-cliffs-5913.herokuapp.com fwd="46.72.99.61" dyno=web.1 connect=3ms service=292ms status=500 bytes=643
2013-03-26T20:43:50+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=ancient-cliffs-5913.herokuapp.com fwd="46.72.99.61" dyno=web.1 connect=7ms service=8ms status=200 bytes=0 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T20:56:18.820

你需要`heroku run rake db:migrate`在推送你的代码后做。

仅供参考 - 更改您的 postgres 密码，`heroku pg:credentials DATABASE --reset`因为您刚刚在上面发布了密码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T12:31:27.890

您也可以`heroku logs`在控制台上运行，这将显示来自 heroku 的错误日志。

# bash - 选项替换的分词

> ID：15647206
> 
> 赞同：0
> 
> 时间：2013-03-26T20:55:10.063
> 
> 标签：bash, shell, curl

在以下 shell 脚本中，我无法设置包含空格的用户代理。我正在分词。第一个空格之后的位（即“（Macintosh;”）被curl解释为一个url。

如果我将它输入到控制台中，它可以正常工作，但当我使用替换时就不行了。

```
PARAMS="-v"
PARAMS="${PARAMS} --user-agent \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_3) AppleWebKit/536.28.10 (KHTML, like Gecko)\"" #does not work
#PARAMS="${PARAMS} --user-agent \"Mozilla/5.0\"" #works

curl ${PARAMS} $1 > results.txt 
```

有人可以解释为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:45:55.060

该问题在[Bash FAQ中进行了解释](http://mywiki.wooledge.org/BashFAQ/050)

解决方案是稍微不同的语法。

```
PARAMS=(-v)
PARAMS+=( "-A Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_3) AppleWebKit/536.28.10 (KHTML, like Gecko)")
curl "${PARAMS[@]}" $1 > results.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:32:02.033

从这里：[http ://wiki.bash-hackers.org/syntax/quoting](http://wiki.bash-hackers.org/syntax/quoting)

> 这些引号字符（“，双引号和'，单引号）是影响解析的语法元素。它与作为文本传递到命令行的最终引号字符无关！在调用命令之前删除语法引号！

`cmd "my args"`所以和之间有根本的区别`myargs="\"my args\""; cmd $myargs`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-26T21:21:55.513

尝试用 %20 替换空格

如果您愿意，可以在脚本中执行此操作：

```
str_replace ( ' ', '%20', 'what you need here' ); 
```

希望这可以帮助。

# objective-c - NSOutlineView：如何为有和没有孩子的项目设置不同的自定义颜色？

> ID：15647211
> 
> 赞同：1
> 
> 时间：2013-03-26T20:55:19.867
> 
> 标签：objective-c, nsoutlineview

我有一个 NSOutlineView 的自定义子类，它使用 TextFieldCell 作为单元格。一些有子项（代表一组子项）的项目。

我想为有孩子的项目使用自定义颜色，为没有孩子的项目使用另一种自定义颜色。我试图在 IB 中更改它，但颜色仅针对子项更改，在代码中我也可以设置自定义颜色，但仅针对子项。任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T16:04:05.903

您还可以实现 NSOutlineViewDelegate 方法 - (void) outlineView:(NSOutlineView*)aTableView willDisplayCell:(id)aCell forTableColumn:(NSTableColumn*)aTableColumn item:(id)item;

在其中，您可以有一部分类似于以下内容：

```
if ([self outlineView:self isGroupItem: item]){
NSColor *color;
if ([item.children count] == 0) {
color = [NSColor redColor];
}
else {
color = [NSColor blueColor];
}
[aCell setDrawsBackground:YES];
[aCell setBackgroundColor: color];
} 
```

很抱歉格式化，我对此还是很陌生。这应该可行，因为我已经将此代码用于类似的事情。我希望这就是你要找的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T22:00:42.440

经过彻底的研究，似乎唯一的方法是覆盖子类`drawRow:`上的方法`NSOutlineView`

# c# - 详细视图中的自删除视图模型 - 不好的做法？

> ID：15647216
> 
> 赞同：1
> 
> 时间：2013-03-26T20:55:26.250
> 
> 标签：c#, .net, xaml, mvvm, viewmodel

我有一个主从应用程序，其中详细视图模型/视图能够执行删除命令。

但是我怎样才能通知主视图模型中的主集合细节视图模型被删除并且必须从集合中删除？

这是一个糟糕的设计，主视图模型必须删除细节吗？或者是通过事件做到这一点的唯一选择？MVVM 符合？

这是一个缩短的代码

**视图模型**

```
public class AllMetalTransactionViewModel : WorkspaceViewModel
{
    private ObservableCollection<MetalTransactionViewModel> _metalTransactions;
    public ObservableCollection<MetalTransactionViewModel> MetalTransactions
    {
        get { return _metalTransactions; }
        set
        {
            if (Set("MetalTransactions", ref _metalTransactions, value))
            {

            }
        }
    }

    private MetalTransactionViewModel _selectedMetalTransaction;
    public MetalTransactionViewModel SelectedMetalTransaction
    {
        get { return _selectedMetalTransaction; }
        set
        {
            if (Set("SelectedMetalTransaction", ref _selectedMetalTransaction, value))
            {

            }
        }
    }
}

public class MetalTransactionViewModel : WorkspaceViewModel
{
    private RelayCommand _deleteCommand;
    public RelayCommand DeleteCommand
    {
        get
        {
            return _deleteCommand
                   ?? (_deleteCommand = new RelayCommand(
                        () =>
                            {
                                if (!IsNewUnit)
                                {
                                    _dataService.DeleteMetalTransaction(_metalTransaction, CallbackDelete);
                                    _dataService.CommitAllChanges(delegate(bool b, object o) {  });

                                    // How can I inform the AllMetalTransactionViewModel that I'm deleted? Event?
                                }
                            },
                        () => !IsNewUnit));
        }
    }
} 
```

**XAML 主控**

```
<View:MetalTransactionView Grid.Column="1" 
DataContext="{Binding SelectedMetalTransaction}"></View:MetalTransactionView> 
```

**XAML-详细信息**

```
<Button DockPanel.Dock="Right" HorizontalAlignment="Right" 
Padding="5" Content="Löschen" Margin="5" Width="80" 
Command="{Binding Path=DeleteCommand}" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:46:17.307

祝你有美好的一天！

您可以通过多种方式进行操作（我喜欢 A 和 D 解决方案）：

**A.**详细视图模型有一个链接到主详细视图模型（一些带有一种方法的轻量级接口`void RemoveDetail(MetalTransactionViewModel detail)`）或详细视图模型集合。例如（那里有收藏链接）：

详细视图模型：

```
public class MetalTransactionViewModel : WorkspaceViewModel
{
    private RelayCommand _deleteCommand;

    IList<MetalTransactionViewModel> ParentCollection { get; }

public RelayCommand DeleteCommand
    {
        get
        {
            return _deleteCommand
                   ?? (_deleteCommand = new RelayCommand(
                        () =>
                            {
                                if (!IsNewUnit)
                                {
                                    _dataService.DeleteMetalTransaction(_metalTransaction, CallbackDelete);
                                    _dataService.CommitAllChanges(delegate(bool b, object o) {  });

                                     if (ParentCollection == null) { return; }
if (ParentCollection.Contains(this)) { ParentCollection.Remove(this); }
                                }
                            },
                        () => !IsNewUnit));
        }
    }

} 
```

在主视图模型中，创建详细视图模型时：

```
private MetalTransactionViewModel CreateDetailViewModel()
{
  return new MetalTransactionViewModel() { ParentCollection = MetalTransactions };
} 
```

**B.**使用你所说的事件（但**要小心**，因为**它可能会给你带来内存泄漏**）。请查看[WeakEventManager](http://msdn.microsoft.com/en-us/library/system.windows.weakeventmanager.aspx)

**C.**如果您使用 mvvm 工具包，例如[MVVM Light Toolkit](http://mvvmlight.codeplex.com/)，您可以使用[Messenger](http://blog.galasoft.ch/archive/2009/09/27/mvvm-light-toolkit-messenger-v2-beta.aspx)类通知主视图模型删除操作。

**D. 将删除命令移至主视图模型。我想在这种情况下这是最好的解决方案。我相信 Main View Model 必须操纵 Collection Details View Models**。

我希望它会帮助你！

# hibernate - 在 Hibernate 中找不到布尔值的吸气剂

> ID：15647217
> 
> 赞同：4
> 
> 时间：2013-03-26T20:55:29.390
> 
> 标签：hibernate, javabeans

我的`User`模型类是传统的如下：

```
package org.ravij.model;

    public class User {

        private String username;
        private String password;
        private boolean isAdmin;

        public boolean isAdmin() {
            return isAdmin;
        }

        public void setAdmin(boolean isAdmin) {
            this.isAdmin = isAdmin;
        }

        public String getUsername() {
            return username;
        }

        public void setUsername(String username) {
            this.username = username;
        }

        public String getPassword() {
            return password;
        }

        public void setPassword(String password) {
            this.password = password;
        }
    } 
```

在使用 Hibernate v4.2 运行它时，我遇到了以下异常：

```
Caused by: org.hibernate.PropertyNotFoundException: Could not find a getter for isAdmin in class org.ravij.model.User
    at org.hibernate.property.BasicPropertyAccessor.createGetter(BasicPropertyAccessor.java:316)
    at org.hibernate.property.BasicPropertyAccessor.getGetter(BasicPropertyAccessor.java:310)
    at org.hibernate.mapping.Property.getGetter(Property.java:321)
    at org.hibernate.tuple.entity.PojoEntityTuplizer.buildPropertyGetter(PojoEntityTuplizer.java:436)
    at org.hibernate.tuple.entity.AbstractEntityTuplizer.<init>(AbstractEntityTuplizer.java:200)
    at org.hibernate.tuple.entity.PojoEntityTuplizer.<init>(PojoEntityTuplizer.java:82) 
```

下面是 Hibernate 映射配置文件：

```
<hibernate-mapping package="org.ravij.model">

    <class name="User" table="Users">
        <id name="username" type="string" column="User_Name" length="20">
            <generator class="assigned" />
        </id>
        <property name="password" type="string" column="Password" />
        <property name="isAdmin" column="Admin" type="boolean" />
    </class>

</hibernate-mapping> 
```

为什么我收到错误“找不到布尔值的吸气剂”以及需要进行哪些更改？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T20:59:13.340

按照 JavaBean 命名约定，属性名称为“admin”。“isAdmin”是属性的访问器方法的名称。

# javascript - 对 Resig Curry 示例和“参数”对象感到困惑

> ID：15647218
> 
> 赞同：1
> 
> 时间：2013-03-26T20:55:34.220
> 
> 标签：javascript

在[这篇文章中](http://ejohn.org/blog/partial-functions-in-javascript)，John Resig 讨论了这个用于柯里化的片段：

```
Function.prototype.curry = function() {
    var fn = this, args = Array.prototype.slice.call(arguments);
    return function() {
      return fn.apply(this, args.concat(
        Array.prototype.slice.call(arguments)));
    };
  }; 
```

我对表达感到困惑`Array.prototype.slice.call(arguments)`。

1.  这里的“参数”是 Array 的 slice() 方法的“this”参数，但“slice()”本身需要一个参数，所以我认为你需要做类似`Array.prototype.slice.call(arguments, <someIndex>)`. 我不明白该代码如何按原样工作。

2.  根据["arguments" 的文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments)，"arguments" 实际上不是一个数组，而只是一个类似对象的数组。我们如何在上面调用“slice()”？如果我输入代码，`console.log(arguments.slice())`我会收到一条错误消息，指出该对象没有切片方法。

这里发生了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T20:59:47.193

**回答第一个问题：**

如果你在没有参数的数组上调用 slice，它只会返回数组的副本。`Array.prototype.slice.call(arguments)`做同样的事情，但对`arguments`对象进行操作，返回一个数组。

**回答第二个问题：**

我们可以调用 slice，`arguments`因为它是一个“通用”方法（请参阅[此处](http://es5.github.com/#x15.4.4.10)的注释）。当您将`arguments`对象作为传递时`this`，`slice`会将其视为数组。由于`arguments`它是一个包含属性[的类数组对象](https://stackoverflow.com/questions/6599071/array-like-objects-in-javascript)`length`，因此它可以正常工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T20:58:54.280

to 的参数`.slice()`是可选的。如果不存在，该函数只返回原始数组（或类似数组的对象）的副本。

该`.slice()`函数只关心对象上是否存在“长度”属性`this`。因此，因为“参数”确实具有“长度”属性，`.slice()`所以很高兴。

# c++ - 输入错误 C vs C++ cin vs scanf

> ID：15647220
> 
> 赞同：0
> 
> 时间：2013-03-26T20:55:37.930
> 
> 标签：c++, c, scanf, cin

我是 C 语言的初学者，这是我的问题。在 C++ 中，我会以这种方式查找错误的输入（不是无符号整数）：

```
long double c;
cin >> c;

if (c == (unsigned int) c) {
cout<<"OK";    
}
else
cout<<"NOT OK"; 
```

但是，当现在学习 C 时，我正在尝试以相同的方式进行操作，但它不起作用：

```
long double c;
scanf("%lf", &c);

if (c == (unsigned int) c) {
printf("OK\n");    
}
else
printf("NOT OK\n"); 
```

关于如何解决它的任何建议？我的任务是只使用 scanf 而不使用字符串来做到这一点。我不想输入负数和浮点数。为什么这不起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T20:59:00.680

转换指令`%lf`用于扫描`double`s。

要扫描`long double`s，请使用`%Lf`, 大写字母`L`。

根据`fscanf`(7.21.6.2)的规范

> **l** (ell) 指定后面的 d、i、o、u、x、X 或 n 转换说明符适用于类型指针指向`long int`or的参数`unsigned long int`；**后面的 a、A、e、E、f、F、g 或 G 转换说明符适用于类型指针指向的参数`double`**；或者后面的 c、s 或 [ 转换说明符适用于类型指针指向 的参数`wchar_t`。
> 
> **L**指定后面的 a、A、e、E、f、F、g 或 G 转换说明符适用于类型指针指向 的参数`long double`。

# github - 如何从提交 id 中找到分支

> ID：15647221
> 
> 赞同：32
> 
> 时间：2013-03-26T20:55:38.430
> 
> 标签：github, git-commit

因此，我正在尝试查找进行给定提交的分支名称。( `c853d8cf3ae34dae9866b874b96c6529515d7e90`)

我在 git 问题上引用了父 ID 和提交 ID。
我怎样才能找到给定的提交 ID 被推送到“ `x`”分支？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-26T21:02:27.240

特别是在 GitHub 上，您现在可以*看到*给定提交所属的分支。
博文“[提交页面的分支和标签标签](https://github.com/blog/1451-branch-and-tag-labels-for-commit-pages)”详细信息：

> 如果提交不在默认分支上，指示器将显示包含该提交的分支。
> **如果提交是未合并的拉取请求的一部分，则会显示一个链接**。

![拉取请求的链接](../Images/bd3ca0f3f1cb3ec527bee5675deed596.png)

> 一旦提交进入默认分支，将显示包含该提交的所有标签，并且默认分支将是唯一列出的分支。

![提交的分支部分](../Images/50e515df164c65281cb5f3ad7abfa9a0.png)

* * *

原始答案

您可以列出这些分支：

```
git branch --contains <commit>

# in your case
git branch --contains <commit> | grep x 
```

[“ Git：查找提交来自哪个分支](https://stackoverflow.com/a/2707110/6309)”中的更多详细信息。

不要忘记提交可以是多个分支的一部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-05-27T09:42:52.977

只是个骗子。

您可以在 Github 的提交详细信息页面上看到分支，如下所示：

```
https://github.com/{github_username}/{repo}/commit/{commit_id} 
```

例如：[https ://github.com/chungth/Laravel-5.2-Bootstrap3-starter-site/commit/f81c13234a9da988613e14e52f752abec5f51997](https://github.com/chungth/Laravel-5.2-Bootstrap3-starter-site/commit/f81c13234a9da988613e14e52f752abec5f51997)

您可以在该页面上看到当前分支名称。

# node.js - 在 Linux 上分析 Node.js Web 应用程序

> ID：15647223
> 
> 赞同：2
> 
> 时间：2013-03-26T20:55:43.057
> 
> 标签：node.js, profiling

哪个是在 Linux 上分析 Node.js 应用程序的最佳选择？我尝试了[https://github.com/c4milo/node-webkit-agent](https://github.com/c4milo/node-webkit-agent)和[https://github.com/baryshev/look](https://github.com/baryshev/look)（这是基于 nodetime 的），但它们看起来都很实验性。最让我惊讶的是，这些工具所报告的结果是不同的。

look 的主要缺点是堆快照不是很相关，而且 CPU 配置文件的时间不能超过 1 分钟。

使用 node-webkit-agent 时，Chrome 浏览器内存不足。

我正在使用 JMeter 向我的 Web 应用程序发送请求时进行分析。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T15:36:04.313

不确定你是否愿意使用在线服务而不是模块，但你可以试试[http://nodefly.com/](http://nodefly.com/)，它是免费的，对我来说效果很好。

# mule - 骡子直到成功的路由器：objectStore是强制性的吗？

> ID：15647224
> 
> 赞同：0
> 
> 时间：2013-03-26T20:55:43.380
> 
> 标签：mule

我正在使用来自 JMS 队列的消息并将其提交到基于 SOAP 的 Web 服务。我想确保向我提交消息的 Web 服务提供有保证的消息传递。

我正在考虑两个选项 1\. 使用直到成功的路由器（首选），如果无法传输消息，则将其放入死信队列。2\. 使用 JMS 事务，如果向 Web 服务的消息传输失败，则回滚事务并且 JMS 消息留在队列中。

```
<jms:inbound-endpoint queue="ws.message"/>
<until-successful objectStore-ref="objectStore"
              dlqEndpoint-ref="dlqChannel"
              maxRetries="3"
              secondsBetweenRetries="10">
...
</until-successful> 
```

我更倾向于使用直到成功的路由器，但我担心的是它需要一个强制性的 ObjectStore。我不想将消息存储在数据库/对象存储中，而是将其推送到某个 JMS 队列/死信队列并从那里使用它。

任何有用的提示或建议来处理这种情况表示赞赏。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-28T15:57:04.753

如果您使用 until-successful，则必须引用 an `objectStore`。Mule 使用此对象在重试之间存储消息。此外，您应该使用持久对象存储来避免 Mule 服务器或应用程序崩溃时的消息丢失。直到成功的路由器应该是这个用例 IMO 的首选方法。与仅使用 jms 队列相比，它将使配置更易于阅读和维护。

# python - PyGame 多点触控支持 (Windows 8)

> ID：15647232
> 
> 赞同：3
> 
> 时间：2013-03-26T20:56:01.657
> 
> 标签：python, windows, touch, pygame, multi-touch

有什么方法可以让 Windows 8 多点触控事件与 PyGame 一起使用？有没有办法从 Windows 中的 Python 中访问触摸事件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-29T09:19:10.723

Pygame 不直接支持多点触控，并且本质上将多点触控交互作为单独的鼠标事件排队。但是，您可以绕过 pygame 鼠标事件系统并利用[touchpy](https://code.google.com/p/touchpy/)库来处理/处理触摸和多点触控输入。可以在[此处](http://xelapondsstuff.wordpress.com/)查看处理此确切问题的一系列教程。为方便起见，这里是教程[一](http://xelapondsstuff.wordpress.com/2008/08/25/getting-started-with-multi-touch-development-in-python/)、[二](http://xelapondsstuff.wordpress.com/2008/08/26/getting-started-with-multi-touch-development-in-python-part-2/)、[三](http://xelapondsstuff.wordpress.com/2008/09/30/getting-started-with-multi-touch-development-in-python-part-3/)和[四](http://xelapondsstuff.wordpress.com/2008/12/03/getting-started-with-multi-touch-development-in-python-part-4/)的链接。教程 3 和 4 可能会让您特别感兴趣，因为它展示了将 pygame 与 touchpy 集成的示例。

# php - 使用 PHP 访问知识网络的 SOAP 服务

> ID：15647236
> 
> 赞同：1
> 
> 时间：2013-03-26T20:56:12.203
> 
> 标签：php, web-services, soap

我一直在尝试学习如何使用 PHP 访问知识网的肥皂服务。我正在使用从[https://gist.github.com/domoritz/2012629](https://gist.github.com/domoritz/2012629)下载的以下代码。

```
<?php
$auth_url = "http://search.isiknowledge.com/esti/wokmws/ws/WOKMWSAuthenticate?wsdl";
$auth_client = @new SoapClient($auth_url);
$auth_response = $auth_client->authenticate();

$search_url = "http://search.isiknowledge.com/esti/wokmws/ws/WokSearchLite?wsdl";
$search_client = @new SoapClient($search_url);
$search_client->__setCookie('SID',$auth_response->return);

$search_array = array(
'queryParameters' => array(
'databaseID' => 'WOS',
'userQuery' => 'AU=Douglas T*',
'editions' => array(
array('collection' => 'WOS', 'edition' => 'SSCI'),
array('collection' => 'WOS', 'edition' => 'SCI')
),
'queryLanguage' => 'en'
),
'retrieveParameters' => array(
'count' => '5',
'fields' => array(
array('name' => 'Date', 'sort' => 'D')
),
'firstRecord' => '1'
)
);

try{
$search_response = $search_client->search($search_array);
} catch (Exception $e) {
echo $e->getMessage();
}

print_r($search_response);
?> 
```

该代码似乎正在工作。但是，`$search_response`我收到的是“用户没有此服务级别的权利 - WOKSearchLight”。我正在尝试从可以访问知识网络的机构内部的服务器访问这段数据，并且我实际上使用[http://apps.webofknowledge.com/UA_GeneralSearch_input.do 连接到知识网络？ product=UA&search_mode=GeneralSearch&SID=4Dd8nnfofoOm@7@5KH6&preferencesSaved=](http://apps.webofknowledge.com/UA_GeneralSearch_input.do?product=UA&search_mode=GeneralSearch&SID=4Dd8nnfofoOm@7@5KH6&preferencesSaved=) .

谁能告诉我发生了什么？我需要网站的额外许可吗？

我真的很感激任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-12T14:18:02.657

Yes you need to register first at [http://ip-science.thomsonreuters.com/info/ws_form/?agree=0&x=31&y=12](http://ip-science.thomsonreuters.com/info/ws_form/?agree=0&x=31&y=12) and enter your IP address, then it should work I think...

# clojure - 如何在 Clojure 中增加一个数字？

> ID：15647238
> 
> 赞同：7
> 
> 时间：2013-03-26T20:56:15.887
> 
> 标签：clojure

我想知道如何用 X 增加一个数字，用我以前做的其他语言

**富 += 0.1;**

但我不知道如何在 Clojure 中完成

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-26T20:59:24.810

Clojure 中的变量是不可变的。所以你不应该尝试改变 的值`foo`，而是“创建”一个新的 foo：

```
(def foo2 (+ foo 0.1)) 
```

...或者，如果在循环中，则使用新值重复：

```
(loop [foo 5.0]
  (when (< foo 9)
    (recur (+ foo 0.1)))) 
```

...或者，如果 foo 是一个原子，`swap!`它具有一个新值：

```
(def foo (atom 5.0))
(swap! foo (partial + 0.1)) 
```

我建议您从阅读[Clojure 的基本原理](http://clojure.org/rationale)开始。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-26T23:54:57.523

Blacksad 的回答涵盖了定义变量，所以我只想添加其他范围，您可能希望在其中拥有一个从另一个值递增的值：

在函数的本地范围内：

```
user> (defn my-function [x]
        (let [y (inc x)
              z (+ x y)]
          [x y z]))
#'user/my-function
user> (my-function 4)
[4 5 9] 
```

如果您想逐步建立价值以使流程更加清晰：

```
user> (defn my-function [x]
        (let [y (inc x)
               z (+ x y)
               z (+ z 4)
               z (* z z)]
          [x y z]))
#'user/my-function
user> (my-function 4)
[4 5 169] 
```

这可以使过程更加形象化，尽管它不是“取回变量的方法”，并且实际上仅在有限的上下文中有用。此模式用于 clojure.core 的线程宏。

# java - 有什么方法可以在 Eclipse 中调试 JSP 自定义标签？

> ID：15647242
> 
> 赞同：1
> 
> 时间：2013-03-26T20:56:46.117
> 
> 标签：java, eclipse, jsp, tags, jstl

我正在用 JSP、JSTL 和[自定义标签做一些实验](http://docs.oracle.com/cd/E19502-01/819-3669/bnalj/index.html)

有没有办法在 Eclipse 中调试自定义标记**doTag()**方法，使用调试透视图、断点等？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:08:18.047

是的，这是常规的 Java 代码。在标签的 Java 源代码中设置断点，在调试模式下启动 Tomcat，打开 JSP 即可。

# python - 我可以处理拖动和外部文件到我的框架上的事件是什么

> ID：15647247
> 
> 赞同：1
> 
> 时间：2013-03-26T20:57:03.260
> 
> 标签：python, events, drag-and-drop, wxpython, wxwidgets

我有代码可以将文件拖放到框架内的 wx.FileDropTarget 上。那不是我的问题。

我正在尝试制作一个自定义的“悬停”事件，该事件在外部拖动的文件超过我的框架后 1 秒被调用。不幸的是，当从外部将外部文件拖到框架上时，不会调用 wx.EVT_ENTER_WINDOW。

我想避免不断的光标检查和碰撞检测，因为我的应用程序更像是一个实用程序。（我将让我的应用程序使用小屏幕空间，并在“悬停”在一个小框架上 1 秒后展开）

理想情况下，我想将代码（我的 1 秒计时器）添加到将我的光标从“文件”更改为“移动”光标的事件中，当它击中我的应用程序时。

我只是在学习 wx，远离 vb.NET。在 vb.NET 中有一个“Control.DragEnter”的事件处理程序。这就是我真正想要的。wxpython 等效于 vb.NET "Control.DragEnter"

```
Private Sub _DragEnter(sender As Object, e As DragEventArgs) Handles Me.DragEnter
    If e.Data.GetDataPresent(DataFormats.FileDrop) Then
        e.Effect = DragDropEffects.Move
    End If
    tmrHover = New Timer
    AddHandler tmrHover.Tick, AddressOf tmrHover_Tick
    tmrHover.Interval = 1000
    tmrHover.Start()
End Sub 
```

提前致谢。

-亚历克斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T13:37:48.917

我找到了解决方案。我第一次查看文档时并不清楚，但这里是为其他所有人准备的：

```
class MyFileDropTarget(wx.FileDropTarget):

    def __init__(self, mainFrame):
            wx.FileDropTarget.__init__(self)
            self.window = mainFrame

    def OnDropFiles(self, x, y, filenames):
            for fil in filenames:
                    print str(fil)

    def OnEnter(self, x, y, nul):
            self.window.OnDragEnter()
            return wx.DragMove

    def OnLeave(self):
            self.window.OnDragLeave()
            return

    def OnDragOver(self, x, y, nul):
            return wx.DragMove 
```

谢谢。

-亚历克斯

# c# - PushStreamContent 以块的形式发回结果？

> ID：15647249
> 
> 赞同：0
> 
> 时间：2013-03-26T20:57:15.477
> 
> 标签：c#, ios, asp.net-mvc, pushstreamcontent

我正在使用 MVC4 中的新 PushStreamContent 实体将通知从我的 Web 服务器流式传输回多个监听 iOS 客户端（它们正在使用 NSURLConnection）。发送的消息是 JSON。当我发送小于 1024 字节的消息时，消息按预期发送。但是，发送大于此大小的消息会导致客户端以多个块接收消息，每个块为 1024 字节。

我想知道我的 iOS 客户端使用这些返回的多条消息的最佳方式是什么？有没有办法让 NSURLConnection 为我聚合结果，或者我是否需要实现一些得到结果的东西，检查它是否是有效的 json，如果不等待下一个结果并附加上一个结果，然后继续直到它有效？有什么更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T14:50:19.663

我发现您可以调整将数据写入 PushStreamContent 使用的流的缓冲区的大小。但是，对数据进行分块是正确的做法，并且保持这么小有几个优点。我最终编写了自己的方法来聚合客户端流入的数据。有关详细信息，请参阅以下问题：

[如何在将 JSON 数据流式传输到 NSURLConnection 时处理分块](https://stackoverflow.com/questions/15666986/how-to-handle-chunking-while-streaming-json-data-to-nsurlconnection)

# android - 拦截 DialogFragment 关闭活动内部

> ID：15647253
> 
> 赞同：6
> 
> 时间：2013-03-26T20:57:32.460
> 
> 标签：android, android-fragmentactivity, android-dialogfragment

我有一个活动

```
public class ShowFileActivity extends FragmentActivity 
```

当发生某些事件时，此类调用 DialogFragment

```
public class ConfirmDialog extends DialogFragment 
```

这是一个简单的确认对话框（带有“dismiss”和“ok”按钮）。如果用户按下关闭按钮，我会打电话

```
dismiss() 
```

并返回 ShowFileActivity。否则，如果用户按下确定，在进行一些操作后，在对话框上调用关闭后，我将返回 ShowFileActivity 的父活动。有办法吗？DialogFragment 是否向其父视图启动任何事件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-26T22:04:01.877

您可以做的是从片段内部调用包含活动的方法。根据任何其他片段，您可以调用返回包含活动的 getActivity()。

```
@Override
public void onDismiss(DialogInterface dialog) {
    ShowFileActivity parent = (ShowFileActivity) getActivity();
    parent.doWhateverYouWantWhenDialogDismissed();
} 
```

另一种（更花哨的）方法是使用诸如[otto](http://square.github.com/otto/)或[greenrobot 之](https://github.com/greenrobot/EventBus)类的事件总线。

# json - GeoServer 未使用 OpenLayers.Protocol.Script 为 WFS 返回正确的 JSON

> ID：15647259
> 
> 赞同：2
> 
> 时间：2013-03-26T20:57:47.167
> 
> 标签：json, openlayers, geoserver

我正在尝试从 GeoServer 2.3.0 获取 json 功能。我已经复制了示例中的代码，它按预期工作。但是，当我将 url 设置为我的 GeoServer 和所需图层时，返回的格式不一样并导致此错误：“Uncaught SyntaxError: Unexpected token:”

示例服务器以这种格式返回 json 特征：

OpenLayers.Protocol.Script.registry.c1({"type":"FeatureCollection","features":[{"type":"Feature","id":"cities.2","geometry": ...

我的 GeoServer 以这种格式返回 json 特征：

{"type":"FeatureCollection","features":[{"type":"Feature","id":"poi.1","geometry": ...

该错误是由于我的 GeoServer 未返回包含在回调函数中的 json 引起的。这似乎是服务器配置问题，但作为 GeoServer 菜鸟，我一直无法找到正确的设置进行调整。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T22:07:41.443

发现了解决方案。服务器默认禁用 JSONP。设置环境变量 ENABLE_JSONP=true 并请求格式“text/javascript”会产生预期的结果。仍然不确定为什么示例服务器返回正确的 jsonp 格式为“json”。

# app-store-connect - 更改应用名称 App Store

> ID：15647260
> 
> 赞同：1
> 
> 时间：2013-03-26T20:57:49.490
> 
> 标签：app-store-connect

一个人需要我当前在 App Store 中的应用程序的名称。让我们以“ABC”作为我的应用程序的名称。我提交更新以将我的应用名称更改为“ABCD”。其他人能否创建名为“ABC”的应用程序？

多谢你们

# php - 我在哪里可以找到 Charles Miller 的“持久登录 Cookie”解决方案的 PHP/MySQL 实现？

> ID：15647261
> 
> 赞同：2
> 
> 时间：2013-03-26T20:57:51.227
> 
> 标签：php, mysql, security, cookies, session-cookies

我一次又一次地看到 Charles Miller 的“[持久登录 Cookie 最佳实践](http://fishbowl.pastiche.org/2004/01/19/persistent_login_cookie_best_practice/)”在这里推荐为在站点上实现“记住我”功能的绝对**最佳方式（如果您真的***非常*需要该功能，我会这样做）。

但是，我在网上搜索过，我找不到*任何*实际的 PHP/MySQL 代码来实现他的解决方案，而且由于在使用“记住我”方面“安全”被强调了*无数*次，我害怕编码我自己从头开始，因为担心我会误解某些东西或犯下会导致巨大安全漏洞的错误。

由于他的解决方案已有近 10 年的历史，并且恰好是关于持久登录 Cookie 的 SO 上[最受好评的答案](https://stackoverflow.com/questions/549/the-definitive-guide-to-forms-based-website-authentication/477578#477578)，因此肯定有一些经过审查的 PHP/MySQL 代码可以正确地遵循他的解决方案，而不会出现任何意外的安全漏洞。（我发现最接近的是 Drupal 模块，但我不使用 Drupal。）

有谁知道我在哪里可以找到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T15:27:16.517

在阅读了有关 StackOverflow 的问题后，我受到启发，通过编写 Charles Miller 的“持久登录 Cookie 最佳实践”的 PHP/MySQL 实现来帮助他。对于本教程，我将假设您已经拥有一个带有用户登录的 PHP 系统.

```
CREATE TABLE user_sessions (
  user_id INT(11) UNSIGNED NOT NULL,
  session VARCHAR(39) NOT NULL,
  created TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
  PRIMARY KEY (user_id, session)
); 
```

首先，我们需要在您登录时更新站点以将会话存储到 cookie 中。此代码将与您当前的登录系统一起使用。

```
if (/* Code that verifies credentials */) {
  // ... code to log user into session

  PersistentAuth::login($userId);
} 
```

其次，我们要检查站点的新用户是否具有 cookie 凭据。此代码将位于代码的开头。它首先检查我们是否已经在 $_SESSION 中登录？如果没有，请尝试基于 cookie 的登录。

```
if (/* !loggedIn() */ && ($userId = PersistentAuth::cookieLogin())) {
  // ... use $userId to log user into session 
} 
```

第三，根据 Charles Miller 的文章，如果用户通过 cookie 登录，我们将不允许用户访问以下部分：

*   更改用户密码
*   更改用户的电子邮件地址（尤其是在使用基于电子邮件的密码恢复时）
*   对用户地址、付款详情或财务信息的任何访问
*   任何购买能力

代码：

```
if (PersistentAuth::isCookieLogin()) {
  // User is logged in via cookie and don't have access to this 
  // section. We need to ask them for the password. Maybe send 
  // them to some login page?

  // TODO ask for password or send to a password page
} 
```

要获取 PersistentAuth 类的所有代码，请在此处查看我的网站：http: [//www.chrislondon.co/php-persistent-login/](http://www.chrislondon.co/php-persistent-login/)

使用这个 PersistentAuth 类，您必须进行一些更改。您必须更改 getDb() 函数以返回数据库实例。我在这个例子中使用了 PDO。我已经为每次页面刷新设置了清除旧会话的数据库。处理此问题的最佳方法是使用 cron。如果您确实设置了 cron，则在类设置中将 USE_CRON 标志更改为 true

# linux - awk 脚本中的 $0 和 $1（美元符号 0 和 1）是什么？

> ID：15647263
> 
> 赞同：23
> 
> 时间：2013-03-26T20:57:56.497
> 
> 标签：linux, awk

例如，在[本`awk`](https://developer.apple.com/library/mac/#documentation/opensource/Conceptual/ShellScripting/Howawk-ward/Howawk-ward.html)教程中有三个示例：

1.  `tolower($1) ~ /mary/ { print "CI Record: " $0; }`
2.  `$0 !~ /Mary/ { print "Not Mary: " $0; }`
3.  `$1 == "Mary" { print "Mary Record: " $0; }`

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-03-26T21:08:26.043

在 awk 中，`$0`是整行参数，而`$1`只是由空格分隔的参数列表中的第一个参数。因此，如果我通过 awk 输入“Mary had a little lamb”，`$1`就是“Mary”，而是`$0`“Mary had a little lamb”。第二行试图在给 awk 的整行中找到子字符串“Mary”。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-26T21:06:05.953

实际上`# 2`，由于这种语法，示例正在使用正则表达式

```
/regex/ 
```

`Mary`这意味着在您的示例中，如果在整行 () 中的任何位置都找不到文字文本，`$0`则执行 awk 代码。

而在文字文本和字段＃1（）`$1 == "Mary"`之间进行直接比较。`Mary``$1`

最后`tolower($1) ~ /mary/`再次在字段 #1 上使用 ignre-case 正则表达式匹配，这意味着如果`$1`有文本`mary`（忽略大小写），则执行其余的 awk 代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-26T21:09:08.223

从链接中的描述（强调我的）：

> 表达式通常是字段之一或对其中一个字段进行操作的结果。例如，下面的 AWK 过滤规则**分别**展示了如何以不区分大小写的方式将第**一个字段与“mary”进行比较，如何匹配****所有**不包含“Mary”的记录，以及如何对反对“玛丽”的**第一场：**

所以分解它：

第一：

```
 how to compare the first field to “mary” in a case-insensitive fashion 
```

因为它比较第一个字段，所以它使用`$1`

> 如何匹配所有不包含“Mary”的记录，

由于它正在比较所有记录，因此它使用`$0`

第三个

> 以及如何将第一个字段与“Mary”进行精确比较：

再次比较第一个字段，所以它使用`$1`.

# ios - 如何添加小数按钮

> ID：15647265
> 
> 赞同：-3
> 
> 时间：2013-03-26T20:58:15.083
> 
> 标签：ios, objective-c, xcode4.5

如何添加小数按钮。我输入数字的代码：

```
number = number *10 + (int)[sender tag];
display2.text = [NSString stringWithFormat:@"%.10g",number]; 
```

还有我的十进制数字代码。

```
NSString *currentText = display2.text;
if ([currentText rangeOfString:@"." options:NSBackwardsSearch].length == 0) {
    display2.text = [display2.text stringByAppendingString:@"."];

} 
```

这是如何工作的？！输入 12 并按小数点。并按数字 3 = 123 :(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:28:36.690

您获得 123 而不是 12.3 的原因在于您的代码中的其他按钮（不是十进制按钮）。虽然我会使用 range.location==NSNotFound 而不是 range.length==0 来添加小数，但这不是问题。

问题是你正在做 number*10 + [sender tag]。现在假设您输入 1，然后输入 2，然后输入小数。“数字”将是 12.，即 12。现在，当您将其乘以 10 并加 3 时，您将得到 12*10+3 = 120+3 = 123。

你想要做的是得到你想要的实际数字（12.3），而是使用：

```
display2.text = [display2.text stringByAppendingFormat:@"%i",[sender tag]]; 
```

为了摆脱字符串开头的零，您可以执行以下操作：

```
if ([display.text isEqualToString:@"0"]) {
    display.text = [NSString stringWithFormat:@"%i",[sender tag]];
}
else {
    display2.text = [display2.text stringByAppendingFormat:@"%i",[sender tag]];
} 
```

# php - PHP：在forEach中，达到条件时停止执行，但稍后继续

> ID：15647266
> 
> 赞同：0
> 
> 时间：2013-03-26T20:58:17.500
> 
> 标签：php, execution, continue

假设我有这样的事情：

```
$count = 0; 
foreach($CourseDetails as $course_line) {
    print "<tr><td>{$course_line['class_code']}</td>
            <td>{$course_line['class_name']}</td>
            <td>{$course_line['class_unit']}</td>
            <td>{$course_line['class_description']}</td>
            <td>{$course_line['class_instructors']}</td>";
    $count = $count + 1
    if ($count = 10);
        $count = 0;
        // code that stops script and makes a "Continue?" button pop up on the webpage under the already outputed details
        // if the client presses the "Continue?" button, allow the script to continue (jump back into the foreach loop)
} 
```

我试图找到一种方法来停止脚本，然后制作一个按钮说“继续？”。如果客户端按下按钮，我希望脚本从停止的地方继续。PHP是否有任何允许这样做的函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:03:54.787

简短的回答：不！

这更像是一个工作流设计问题。我建议创建一个要执行的项目列表。然后尝试执行它们（当它们被成功处理时，将它们标记为完成），如果遇到错误，则停止执行并让用户知道。如果用户希望继续，请重新加载页面，并继续执行初始列表中尚未完成的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-30T12:55:04.927

一旦页面在浏览器中加载，您就无法停止脚本。您只能在脚本内创建中断条件。页面之间“记忆”的两种方式是传递一个 URL 变量，例如 start=20，或者使用 $_SESSION 变量来记住最后的中断点。最好通过 URL 传递变量，以便可以单独访问页面。

然后，在您的循环中，只需评估条目是否在最后一个中断之上有一个数字。以下假设您的课程位于具有数字索引的数组中，在这种情况下 $count 是多余的。如果您要从数据库中提取它们，请采用完全不同的方法...

```
$start = !empty($_GET['start']) ? $_GET['start'] : 0;
$offset = 10;

foreach($CourseDetails as $course_num => $course_line) {

    if ($course_num < $start) continue; // These were already seen.

    if ($course_num >= $start + $offset) {
        // Interrupt and make a button that links to ?start=$start+$offset.
        break;
    }

    // Here display stuff.
} 
```

# contenteditable - 将 focus() 设置回 contenteditable

> ID：15647267
> 
> 赞同：2
> 
> 时间：2013-03-26T20:58:21.813
> 
> 标签：contenteditable

我正在构建一个带有模式窗口（Twitter Bootstrap）的迷你所见即所得编辑器，用于输入图像路径。工作流程是这样的：

1.  用户正在编辑 contenteditable div 中的内容并想要插入图像
2.  用户单击图像按钮，模态窗口打开
3.  用户在输入字段中输入一些 URL 并按回车键

现在我正试图`focus()`回到 contenteditable div。不幸的是，它似乎没有集中注意力，因为诸如此类的`document.execCommand()`事情不起作用。

换句话说：

在输入字段中后，如何将焦点（）带回可内容编辑的 div？

我已经看到了一些解决方案，其中一些使用大脚本做一些`Range`/ `Selection`-stuff，但我确信有一个更简单的解决方案......

任何人？

# ruby-on-rails - 如何从代码设置属性并在标签内插入文本

> ID：15647269
> 
> 赞同：1
> 
> 时间：2013-03-26T20:58:28.493
> 
> 标签：ruby-on-rails, slim-lang

我有这个代码：

```
 span class==I18n.locale == locale_used ? "inactive" : nil
    = link_to(I18n.t('locale_name', locale: locale_used),\
              url_for(locale: locale_used)) 
```

如果我删除“类”部分，一切都很好。用苗条写这个的正确方法是什么？

没有类部分，错误是：`syntax error, unexpected keyword_ensure, expecting $end`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:43:10.330

`class`问题在于属性内的复杂表达式。

Slim 对此感到困惑，因此您需要将其包装`()`以正确解析它：

```
span class==(I18n.locale == locale_used ? "inactive" : nil)
  = link_to(I18n.t('locale_name', locale: locale_used),\
              url_for(locale: locale_used)) 
```

# c# - 拇指控件突出显示和拖动外观

> ID：15647271
> 
> 赞同：0
> 
> 时间：2013-03-26T20:58:37.593
> 
> 标签：c#, windows-runtime

我在 Windows 商店应用程序中使用拇指控件来表示可拖动的图像。但是，每当我将鼠标悬停在它上面时，它就会变成一个灰色框，当我拖动它时，它会变成一个更深的灰色框。释放时它会恢复为我给它作为背景的图像。有什么方法可以关闭或自定义高亮/焦点和拖动外观？

**编辑：**

这是我的控件的 XAML。我把它放在一个网格里，但不做任何事情。

```
<Canvas x:Name="PART_background" Background="White" Height="140" Width="20">
    <Thumb x:Name="PART_drag" Canvas.Left="0" Width="20" Height="50">
        <Thumb.BorderBrush>
            <SolidColorBrush Color="Black" Opacity="0"></SolidColorBrush>
        </Thumb.BorderBrush>

        <Thumb.Background>
            <ImageBrush x:Name="PART_image" Stretch="None" AlignmentX="Center" />
        </Thumb.Background>
    </Thumb>
</Canvas> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T04:41:57.837

您需要编辑模板 - 它在 Blend 中效果最佳，然后更改视觉状态动画。默认模板有一些`Border`元素和各种视觉状态（PointerPressed、PointerOver） - 它为这些边框的不透明度设置动画。这是提取的模板。您可以简单地删除情节提要以摆脱视觉反馈。

```
<Page
    x:Class="App132.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:App132"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">
    <Page.Resources>
        <Style x:Key="ThumbStyle1" TargetType="Thumb">
            <Setter Property="Background" Value="{StaticResource ThumbBackgroundThemeBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="IsTabStop" Value="False"/>
            <Setter Property="BorderBrush" Value="{StaticResource ThumbBorderThemeBrush}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Thumb">
                        <Grid>
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal"/>
                                    <VisualState x:Name="PointerOver">
                                        <Storyboard>
                                            <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="BackgroundPointerOver"/>
                                            <DoubleAnimation Duration="0" To="0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="Background"/>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Pressed">
                                        <Storyboard>
                                            <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="BackgroundPressed"/>
                                            <DoubleAnimation Duration="0" To="0" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="Background"/>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Disabled"/>
                                </VisualStateGroup>
                                <VisualStateGroup x:Name="FocusStates">
                                    <VisualState x:Name="Unfocused"/>
                                    <VisualState x:Name="Focused"/>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <Border x:Name="Background" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}"/>
                            <Border x:Name="BackgroundPointerOver" BorderBrush="{StaticResource ThumbPointerOverBorderThemeBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{StaticResource ThumbPointerOverBackgroundThemeBrush}" Opacity="0"/>
                            <Border x:Name="BackgroundPressed" BorderBrush="{StaticResource ThumbPressedBorderThemeBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{StaticResource ThumbPressedBackgroundThemeBrush}" Opacity="0"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Page.Resources>

    <Grid Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
        <Thumb HorizontalAlignment="Left" Height="270" Margin="170,230,0,0" VerticalAlignment="Top" Width="390" Style="{StaticResource ThumbStyle1}"/>
    </Grid>
</Page> 
```

# rabbitmq - 如何在反应器中使用并行代码确认芹菜任务？

> ID：15647272
> 
> 赞同：3
> 
> 时间：2013-03-26T20:58:53.623
> 
> 标签：rabbitmq, message-queue, celery, reactor

我有一个 celery 任务，当被调用时，它会简单地在扭曲的反应器中启动一些并行代码的执行。这是一些示例（不可运行）代码来说明：

```
def run_task_in_reactor():
   # this takes a while to run
   do_something()
   do_something_more()

@celery.task
def run_task():
   print "Started reactor"
   reactor.callFromThread(run_task_in_reactor) 
```

（为简单起见，请假设worker收到任务时reactor已经在运行；我使用信号`@worker_process_init.connect`在worker一上来就在另一个线程中启动我的reactor）

当我调用`run_task.delay()`时，任务很快完成（因为它不等待`run_task_in_reactor()`完成，只安排在反应器中执行）。并且，当`run_task_in_reactor()`finally 运行时，`do_something()`或者`do_something_more()`可以抛出异常，这将被忽视。

例如，使用`pika`从我的队列中消费，我可以使用内部的 ACK`do_something_more()`来使工作人员通知任务的正确完成。但是，在 Celery 内部，这似乎是不可能的（或者，至少，我不知道如何实现相同的效果）

此外，我无法移除反应堆，因为这是我正在使用的某些第三方代码的要求。实现相同结果的其他方法也值得赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-18T23:55:32.453

改为使用`reactor.blockingCallFromThread`。

# node.js - Grunt.js 输出并将文件夹的内容写入文件？

> ID：15647276
> 
> 赞同：3
> 
> 时间：2013-03-26T20:58:59.050
> 
> 标签：node.js, gruntjs

## 目标：

也动态包含`/static/js/**/*.js`和`/static/css/**/*.css`文件`<head>`

## 方法：

我正在使用客户端模板部分，因此在此示例中，我想将所有内容的文件路径写入：

`/static/js/**/*.js`也`/templates/head.js.dust`
`/static/css/**/*.css`太`/templates/head.css.dust`

文件路径当然是不够的。我需要一种预处理输出的方法，以便每个“文件”都由适当的标签包装，例如：

```
<!-- /templates/head.js.dust -->
<script src="/static/js/assests/jquery.js"></script>
<script src="/static/js/assests/jquery_ui.js"></script>
<script src="/static/js/app.js"></script>
...

<!-- /templates/head.css.dust -->
<link src="/static/css/assests/jquery_ui.css"/>
<link src="/static/css/app.css"/>
... 
```

## 问题：

是否有一个 grunt 模块已经做了这样的事情？

**奖励积分：** *如果没有，我什至如何开始构建这样的东西？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T23:18:18.470

您可以通过一种相当简单的方式做到这一点：

```
grunt.registerMultiTask("assetAppend", "Append JS/CSS assets to a file", function() {
    var paths = grunt.file.expand( this.data.paths ),
        out = this.data.output,
        contents = "";

    paths.forEach(function( path ) {
        if ( /\.js$/i.test( path ) ) {
            contents += '<script src="' + path + '"></script>';
        } else if ( /\.css$/i.test( path )) {
            contents += '<link rel="stylesheet" type="text/css" href=' + path + ' />';
        }
    });

    grunt.file.write( out, contents );
});

grunt.initConfig({
    assetAppend: {
        js: {
            paths: ["static/js/**/*.js"],
            output: "head.js.dust"
        },
        css: {
            paths: ["static/css/**/*.css"],
            output: "head.css.dust"
        }
    }
}); 
```

*这个例子现在是我的插件**[grunt-contrib-assetpush 的一部分](https://github.com/gustavohenke/grunt-contrib-assetpush)***

# r - knit2pdf可以使用全局环境吗？

> ID：15647282
> 
> 赞同：13
> 
> 时间：2013-03-26T20:59:10.627
> 
> 标签：r, knitr

在[这个答案](https://stackoverflow.com/a/8437393/903061)中，@Yihui 说`knitr`使用全球环境。这让我很困惑——我的经验是它没有。我从来没有真正使用过`knit`，我通常直接去PDF。

在一个小实验中，似乎`knit`确实使用了全局环境（或您使用`envir`参数指定的任何环境），但`knit2pdf`事实并非如此。

最小示例：global_test.Rnw 文件

```
\documentclass{article}
\begin{document}
<<>>=
    print(x)
@
\end{document} 
```

R脚本：

```
x <- "Hello World"
knit(input="global_test.Rnw")
# Works as expected, could now call tools::texi2pdf to generate pdf.

knit2pdf(input="global_test.Rnw")
# Doesn't 
```

后者生成不会显示的 PDF 文件并给出警告：

```
running command '"C:\PROGRA~2\MIKTEX~1.9\miktex\bin\texi2dvi.exe" --quiet --pdf
"global.pdf"  -I "C:/PROGRA~1/R/R-215~1.3/share/texmf/tex/latex" -I
"C:/PROGRA~1/R/R-215~1.3/share/texmf/bibtex/bst"' had status 1 
```

我尝试将环境传递给`knit2pdf`( `envir = globalenv()`) 希望它会被`...`传递，我只是得到一个未使用的参数错误。

一般来说，我知道引用全局环境是一种糟糕的形式，但是有没有办法用 来做到这一点`knit2pdf`，或者明确地传递一个环境，或者我最好使用`brew`和[@Ramnath](https://stackoverflow.com/a/8437769/903061)对上述相同问题`sprintf`的回答？

在我的用例中，我认为没有`tools::texi2pdf`用，因为我需要使用 XeLaTeX 进行编译，它可以`knit2pdf`轻松处理。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-26T21:56:05.960

问题中示例的问题似乎与环境无关。`output`如果参数被忽略，一切都将正确编译并且没有警告`knit2pdf`。

作为参考，我在 Windows 7 上的 R 2.15.3 上使用了 knitr 1.1。我会让 Yihui 知道，因为它似乎是一个错误`knit2pdf`（它调用`tools::texi2pdf`，它不接受输出文件路径）。

**更新：**该问题已在 的开发版本中得到修复`knitr`，[可在此处获得](https://github.com/yihui/knitr)。

还值得注意的是，**RStudio**`Compile PDF`中的按钮*不*使用您当前的环境，因此如果您想访问全局变量并且您正在使用 RStudio，请显式调用适当的函数，而不是依赖快捷方式。事实上，它并不直接使用，而是调用. ***`knit``knit2pdf``rmarkdown::render`***

# jquery - 单击时重新加载jquery移动列表视图

> ID：15647286
> 
> 赞同：0
> 
> 时间：2013-03-26T20:59:16.730
> 
> 标签：jquery, ios, cordova, mobile

我正在开发一个 iOS PhoneGap 应用程序。由于 jFeed，我目前从 Facebook 获得了一个 RSS 提要，然后它显示在一个列表视图上：一切都很好。我现在想允许用户重新加载列表视图。

这是我迄今为止尝试过的：

```
<div data-role="page" id="index">
        <div data-role="header" data-id="foo2" data-position="fixed">
             <h1>Actu BDA Audencia</h1>
            <a  href="#" onclick="$('#result').append(html);
                $('#result').listview("refresh");" data-icon="info" data-rel="popup" data-position-to="window" data-role="button"  data-transition="pop" data-iconpos="left" class="ui-btn-right">Update</a>

        </div>

        <div data-role="content">
            <div class="pull-to-refresh">test</div>
            <ul id="result" data-role="listview" data-divider-theme="d">
                </ul>

      </div>
 <script>
  jQuery(function() {

               jQuery.getFeed({
                              url: 'http://www.facebook.com/feeds/page.php?id=360453900718092&format=atom10',
                              success: function(feed) {
                              $.mobile.loading( "show" );

                              var html = '';
                              var numjour= '';
                              var nummois = '';
                              var heure = '';
                              var newitem = '';

                              for(var i = 0; i < feed.items.length && i < 10; i++) {

                              var item = feed.items[i];

                              numjour = item.updated.substr(8,2);
                              nummois = item.updated.substr(5,2);
                              nummois = nummois.replace('0', '');
                              heure = item.updated.substr(11,5);

                              newitem = item.description;

               html += '<li data-role="list-divider">'
               + numjour
               + ' '
               + months[nummois]
               + '<span class="ui-li-count">'
               + heure
               + '</span></li>'
               + '<li><p><br /><div class="tada">'
               + newitem
               + '</div></li></div>';

               }

               $('#result').append(html);
               $('#result').listview("refresh");
               $.mobile.loading( "hide" );
               }
               });
        });

 </script> 
```

我添加了一个“更新”按钮来触发重新加载。不幸的是，点击按钮不会触发任何事情。你能帮我解决这个问题吗？

非常感谢你，大卫。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T02:02:09.453

您可以使用： $('#mylist').listview('refresh');

查看“更新列表”部分：http: [//jquerymobile.com/demos/1.2.1/docs/lists/docs-lists.html](http://jquerymobile.com/demos/1.2.1/docs/lists/docs-lists.html)

# objective-c - 如何在 cocos2d 中暂停游戏？

> ID：15647287
> 
> 赞同：3
> 
> 时间：2013-03-26T20:59:18.267
> 
> 标签：objective-c, cocos2d-iphone

我知道这个问题之前已经被问过并得到了回答，但似乎没有一个答案适合我想要做的事情。我需要能够暂停动画，但仍然能够让我的暂停菜单出现并要求用户输入。这可能吗？如果可以，我该怎么做。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-27T10:24:34.887

有两种方法`pause`，`resume`为此目的`CCDirector`：

```
[[CCDirector sharedDirector] pause]; 
```

和

```
[[CCDirector sharedDirector] resume]; 
```

从文档中：

> 正在运行的场景将被绘制，但所有计划的计时器将被暂停暂停时，绘制速率将为 4 FPS，以减少 CPU 消耗

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-12T14:37:28.923

我建议你在 cocos2d 场景堆栈上**推送**“暂停场景”。

```
CCScene * pauseScene = ...;
[[CCDirector sharedDirector] pushScene:pauseScene]; 
```

这将自动暂停您当前的场景（我假设是关卡场景）并将运行“暂停场景”，以便用户可以与之交互。

很**重要**的一点要记住，上面的指令执行后，cocos2d的场景栈中会有2个场景（关卡场景[冻结]+暂停场景[运行]）。

所以，一旦你进入“暂停场景”，如果你想**恢复**关卡，你只需要从堆栈中**弹出暂停场景。**

```
[[CCDirector sharedDirector] popScene]; 
```

这将自动移除“暂停场景”并恢复堆栈中的前一个场景（即关卡场景）。

请记住，有时您总是需要“弹出”暂停场景。重要的是不要忘记“关卡场景”还在 cocos2d 的场景堆栈中！

例如：如果在“暂停场景”中有一个按钮来加载关卡选择菜单并永久离开当前关卡，则应按如下方式实现：

```
CCScene * levelSelector = ... 
[[CCDirector sharedDirector] popScene]; // to remove the "pause scene" from the stack
[[CCDirector sharedDirector] replaceScene:levelSelector]; // replace the "level scene" with the "levelSelector scene" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T14:50:08.993

我尝试了所有的建议，但没有一个对我有用，所以这就是我最终做的对我来说非常有效的方法。这是暂停。

```
[self pauseSchedulerAndActions];
for (CCNode *child in [self children]) {
    [child pauseSchedulerAndActions];

} 
```

这要恢复：

```
 [selfReference resumeSchedulerAndActions];
        for (CCNode *child in [selfReference children]) {
            [child resumeSchedulerAndActions];

        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-12T05:11:53.733

在 Cocos 2D Version 2 中，动作管理器不再是一个单例。而是代码已与 CCDirector 融合在一起。

所以这是暂停特定场景中的所有动作并恢复它们的方法。

```
-(void)pauseGamePlayScene{
    for(CCSprite *sprite in [self children]) {
        [[[CCDirector sharedDirector] actionManager]pauseTarget:sprite];   
    }
}

-(void)resumeGamePlayScene{
    for(CCSprite *sprite in [self children]) {
        [[[CCDirector sharedDirector] actionManager]resumeTarget:sprite];
    }
} 
```

[Cocos 2d Ver 2 动作管理器文档](http://www.cocos2d-iphone.org/api-ref/latest-stable/interface_c_c_director.html#a8cd504d7743a5ea6c9f93e3851215bee)

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-22T17:56:37.410

试试这个 PauseButton 类[https://github.com/iabtyagi/custom-pause-cocos2d](https://github.com/iabtyagi/custom-pause-cocos2d)。完全符合您的要求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-18T17:17:09.287

我用：

```
@interface CCNode (PauseAdded)

@end

@implementation CCNode (PauseAdded)

-( void ) traversePause
{
    CCNode* a = [children_ lastObject];

    CCARRAY_FOREACH( children_, a )
    {
        [scheduler_ pauseTarget:a];
        [actionManager_ pauseTarget:a];
        [a traversePause];
    }

    [scheduler_ pauseTarget:self];
    [actionManager_ pauseTarget:self];
}

-( void ) traverseResume
{
    CCNode* a = [children_ lastObject];

    CCARRAY_FOREACH( children_, a )
    {
        [a traverseResume];
        [scheduler_ resumeTarget:a];
        [actionManager_ resumeTarget:a];
    }

    [scheduler_ resumeTarget:self];
    [actionManager_ resumeTarget:self];
}

@end 
```

这样，假设您的游戏层与暂停层分开，您就可以这样做：

```
[scene.game_layer traversePause]; 
```

并取消暂停：

```
[scene.game_layer traverseResume]; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-27T13:14:00.443

我是 cocos2D 的新手，并且使用了单独的游戏循环（而不是 scheduleupdate），并且正在取消调度它以及更多的调度程序。在我在游戏层上放置一个新层（即 Pauselayer）的同时，它会自动暂停游戏。看起来很复杂，但对我有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-12-26T10:18:15.877

CCPhysicsNode *_physics;

_physics.paused = true;// 它会暂停你的游戏，但不会暂停动作。

_physics.paused = false;// 当按钮像在暂停游戏中一样可以按下时，它将恢复你的精灵的旋转和下落。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-26T21:41:18.777

*只*停止动画？

```
[ [ CCDirector sharedDirector ] stopAnimation ];

[ [ CCDirector sharedDirector ] startAnimation ]; 
```

如果你想停止一切，像你在其他地方看到的那样暂停（在菜单移动到位之后），然后在用户触摸某个东西时取消暂停。

# scala - 在单独的库中使用 Akka

> ID：15647288
> 
> 赞同：4
> 
> 时间：2013-03-26T20:59:19.973
> 
> 标签：scala, akka

也许这是一个愚蠢的问题，但是如果我开发将使用 akka 功能的库，我应该在我的库中创建 ActorSystem 还是用户将通过参数传递它？最佳做法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T21:04:54.707

我建议将它作为隐式参数传递，这样库用户可以调整演员系统并完全控制它的创建。

例如，他可以选择与应用程序的其他组件共享一个通用的参与者系统。

如果您正在创建一个完整的框架，您可以提供一个可以轻松导入的默认框架（就像 Play！正在做的那样）。

# php - 在列表中显示新信息点击 PHP

> ID：15647293
> 
> 赞同：0
> 
> 时间：2013-03-26T20:59:31.600
> 
> 标签：php

我有一个 PHP 页面，它在提交表单时创建列表元素，表单将 5 个值发送到文本文件，然后将表单的前两个值发送回并显示在列表元素中，如下所示：

```
$myFile = 'demo.txt';
$content = file($myFile);
$content_array = explode("/n", $content);

<ul id="list">
<?php 
for($i = 0; $i < count($content_array); $i++){
  $values = explode(';', $content_array[$i]);
  $titel = $values[0];
  $grade = $values[1];
  $link = $values[2];
  $pic = $values[3];
  $desc = $values[4];            
  echo '<li">'.$titel.'<span>'.$grade.'</span>'.'</li>';
}
?>
</ul> 
```

我想不通的是使列表元素可点击，当您单击它时，应该显示 content_array 中的所有值并且列表应该消失，仍然是同一页面（index.php）但是如果您单击第一个列表元素它应该是`index.php?page=first`，第二个列表元素应该是 `index.php?page=second`等等......我想我应该`$_GET['page']`以某种方式使用，但我不太了解 PHP，所以如果有人能指出我正确的方向或知道任何在线手册，我会很高兴！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:08:30.873

```
<ul id="list">
<?php 
for($i = 0; $i < count($content_array); $i++){
  $values = explode(';', $content_array[$i]);
  $titel = $values[0];
  $grade = $values[1];
  $link = $values[2];
  $pic = $values[3];
  $desc = $values[4];            
  echo '<li>';
  echo '<a href="index.php?page=' . $i . '">';
  echo $titel.'<span>'.$grade.'</span>';
  echo '</a>';
  echo '</li>';
}
?>
</ul> 
```

使用它来检查哪个页面：

```
<?php
  $page = $_GET['page'];
  if($page === '0') {
      //Do what you want for the first page
  }
?> 
```

# css - 侧边栏中的不同字体大小

> ID：15647294
> 
> 赞同：0
> 
> 时间：2013-03-26T20:59:32.527
> 
> 标签：css

我的侧边栏中有不同的字体大小。Link是： http: [//ntm.at/r0sa/](http://ntm.at/r0sa/) 可以在“Partners/Links”看到，Partners比Links小。有些字母比其他字母大。我使用 Arial，字体大小 0.8em 。有人可以解释一下吗？提前谢谢你，罗莎

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:05:26.750

“合作伙伴”这个词被包裹在`span`带有 class 的元素中`caps`，它已`font-size`设置为`90%`。更改它（删除类，删除跨度或将整个链接包装在里面`span`），它应该没问题。

# javascript - JavaScript 将 selectedIndex 设为空白以进行选择不起作用

> ID：15647295
> 
> 赞同：0
> 
> 时间：2013-03-26T20:59:33.100
> 
> 标签：javascript

我正在尝试将下拉选择的默认选择设为空白。

如果我使用 HTML 生成一个选择下拉列表，它就可以工作。但是，当我使用 javascript 生成相同的下拉列表时，它不起作用。

请参阅 [http://jsfiddle.net/m2HSb/](http://jsfiddle.net/m2HSb/)

```
<select id="myDropdown">      
    <option>Option 1</option>     
    <option>Option 2</option>     
    <option>Option 3</option>     
</select> 

<div id="yo"></div>

document.getElementById("myDropdown").selectedIndex = -1

var my_select = document.createElement("select")
for ( var i = 0 ; i < 3 ; i++ ) {
    my_select.options[i] = new Option(i,i)    
}
my_select.selectedIndex = -1
document.getElementById("yo").appendChild(my_select) 
```

请注意，第一个下拉列表是空白的，第二个不是。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:02:56.973

显然您不能设置尚未插入 DOM`selectedIndex`的元素的 。`select`

如果你`my_select.selectedIndex = -1`在之后移动，`append`那么它工作正常。

```
var my_select = document.createElement("select");
for ( var i = 0 ; i < 3 ; i++ ) {
    my_select.options[i] = new Option(i,i);
}
document.getElementById("yo").appendChild(my_select);
my_select.selectedIndex = -1; 
```

[这是小提琴](http://jsfiddle.net/m2HSb/1/)。

# asp.net-mvc - 将值从动作链接传递到路由约束

> ID：15647296
> 
> 赞同：0
> 
> 时间：2013-03-26T20:59:33.420
> 
> 标签：asp.net-mvc, subdomain, actionlink, route-constraint

我想将一个值（特别是子域值）从操作链接传递到自定义子域路由约束（实现 IRouteConstraint），以使该值在 url 中不可见。通过路由值集合传递值，我无法从 url 隐藏该值。它始终在 url 中可见。

那么我该如何实现呢？是否有另一种传递数据的方式使值不可见？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:11:42.513

您可以使用所需的值创建指向您的操作方法的链接。然后在操作方法中获取“隐藏”值并进行重定向，将值传递到 cookie/session/tempdata 中。

这样您就可以获取您需要的信息，并且该值不会在您重定向到的 URL 中可见。

# php - 我有一个选择列表，它应该用几种形式发送数据

> ID：15647298
> 
> 赞同：0
> 
> 时间：2013-03-26T20:59:36.730
> 
> 标签：php, jquery, ajax

我有那种网站：（一组表格）

```
 <select id="group_dropdown" name="selectinput">
                <option value=0>all</option>
                <option value=1>1 option</option>
                <option value=2>2 option</option>
                </select>               

        <form method="post" class="form-inline" id="form11">
           <input type="text" name="1forminput" placeholder="0"></label>
        <button type="submit" class="btn btn-success ml40" >save</button>
        </form>

        <form method="post" class="form-inline" id="form22">
           <input type="text" name="forminput" placeholder="0"></label>
        <button type="submit" class="btn btn-success ml40" >save</button>
        </form> 
```

当发送任何这些表单（如发送表单内的附加字段）时，我想从此选择发送数据（这两种表单都是“相互的”）。这是一个简单的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:03:39.470

添加隐藏输入，并具有带有起始标签标签等的有效标记

```
<select id="group_dropdown" name="selectinput">
    <option value="0">all</option>
    <option value="1">1 option</option>
    <option value="2">2 option</option>
</select>

<form method="post" class="form-inline" id="form11">
    <label>
        <input type="text" name="1forminput" placeholder="0" />
        <input type="hidden" name="select_value" />
    </label>
    <button type="submit" class="btn btn-success ml40">save</button>
</form>

<form method="post" class="form-inline" id="form22">
    <label>
        <input type="text" name="forminput" placeholder="0" />
        <input type="hidden" name="select_value" />
    </label>
    <button type="submit" class="btn btn-success ml40">save</button>
</form> 
```

然后在选择的值发生变化时填写隐藏的输入：

```
$('#group_dropdown').on('change', function() {
    $('[name="select_value"]').val(this.value);
}).trigger('change'); 
```

提交时，选择的值将与两个表单一起发送，并访问如下：

```
$_POST['select_value']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:03:37.887

您可以在序列化表单后添加一个新参数，如下所示：

```
$('#form11').submit(function(){
   $.ajax({
        type : 'POST',
        url : 'url',
        data : $('#form11').serialize() + "&select="+$('#group_dropdown').val()  
    }).done(function( data ) {
       //callback
    });
   return false;
  }); 
```

# c++ - 如何使用 boost 库读写 .ini 文件

> ID：15647299
> 
> 赞同：5
> 
> 时间：2013-03-26T20:59:41.860
> 
> 标签：c++, boost, ini

如何使用 boost 库读写（或修改）.ini 文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-26T22:32:00.010

您可以读取和`Boost.PropertyTree`更新树，然后写入文件（请参阅`load`和`save`函数。

看看[如何访问属性树中的数据](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_propertytree/accessing.html)。您绝对可以添加新属性或更新现有属性。它提到`erase`容器上也有，因此您应该能够删除现有值。来自（上面的链接）的示例`boost`：

```
ptree pt;
pt.put("a.path.to.float.value", 3.14f);
// Overwrites the value
pt.put("a.path.to.float.value", 2.72f);
// Adds a second node with the new value.
pt.add("a.path.to.float.value", 3.14f); 
```

我假设您随后会将更新的树写入文件，无论是新文件还是覆盖现有文件。

**编辑：** 对于 ini 文件，它会进行特定的检查。

上面的例子如果你尝试使用 ini_parser 保存到 ini，你会得到：

1.  ptree 太深
2.  重复键

在这里修复了一个编写ini文件的示例代码，我更新了现有键的值，然后添加了一个新键：

```
#include <boost/property_tree/ptree.hpp>
#include <boost/property_tree/ini_parser.hpp>

void save(const std::string &filename)
{
   using boost::property_tree::ptree;

//   pt.put("a.path.to.float.value", 3.14f);
//   pt.put("a.path.to.float.value", 2.72f);
//   pt.add("a.path.to.float.value", 3.14f);

   ptree pt;
   pt.put("a.value", 3.14f);
   // Overwrites the value
   pt.put("a.value", 2.72f);
   // Adds a second node with the new value.
   pt.add("a.bvalue", 3.14f);

   write_ini( filename, pt );
}

int main()
{
    std::string f( "test.ini" );
    save( f );
} 
```

`test.ini`文件：

```
[a]
value=2.72
bvalue=3.14 
```

随意尝试。

# css - CSS3 白色到透明渐变

> ID：15647305
> 
> 赞同：11
> 
> 时间：2013-03-26T20:59:53.890
> 
> 标签：css, gradient, linear-gradients

我正在使用 CSS3 和 RGBA 创建白色到透明的渐变：

```
div {
    background-image: -moz-linear-gradient(left, rgba(255, 255, 255, 1), rgba(0, 0, 0, 0));
    background-image: -ms-linear-gradient(left, rgba(255, 255, 255, 1), rgba(0, 0, 0, 0));
    background-image: -webkit-gradient(linear, 0 0, 100% 0, from(rgba(255, 255, 255, 1)), to(rgba(0, 0, 0, 0)));
    background-image: -webkit-linear-gradient(left, rgba(255, 255, 255, 1), rgba(0, 0, 0, 0));
    background-image: -o-linear-gradient(left, rgba(255, 255, 255, 1), rgba(0, 0, 0, 0));
    background-image: linear-gradient(left, rgba(255, 255, 255, 1), rgba(0, 0, 0, 0));
    background-repeat: repeat-x;
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='rgba(255, 255, 255, 1)', endColorstr='rgba(0, 0, 0, 0)', GradientType=1);
    padding: 2rem 0;
} 
```

在这里小提琴：http: [//jsfiddle.net/alecrust/fYz45/](http://jsfiddle.net/alecrust/fYz45/)

但是，您会注意到，渐变在中间是暗的。我得到这个：

![得到](../Images/616e74576e1c09cf3b69976f791f5f44.png)

我期待这个：

![期待](../Images/d885149528c30bb9bca424ffa3d1761b.png)

我该如何纠正？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-26T21:03:10.630

将最后一步更改为`#FFFFFF00`( `rgba(255, 255, 255, 0)`) 而不是`#00000000`：

[http://jsfiddle.net/fYz45/6/](http://jsfiddle.net/fYz45/6/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T21:04:59.410

最终颜色应该是白色透明的，而不是黑色透明的

代替

```
rgba(0, 0, 0, 0) 
```

结束于

```
rgba (255, 255, 255, 0) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-29T14:14:55.330

如果其他人在渐变或获得某个方面（角度、透明度等）时遇到问题，我建议尝试使用此工具了解更多信息：http: [//www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)下面的代码是一个示例它可以做什么。透明度由顶部的方块控制，下部的颜色。它允许您不断地添加更多颜色。它还具有良好的向后可比性，并且有些具有预设。

```
`div {
background: -moz-linear-gradient(left,  rgba(255,255,255,1) 0%,rgba(255,255,58,0) 100%); /* FF3.6-15 */
background: -webkit-linear-gradient(left,  rgba(255,255,255,1) 0%,rgba(255,255,58,0) 100%); /* Chrome10-25,Safari5.1-6 */
background: linear-gradient(to right,  rgba(255,255,255,1) 0%,rgba(255,255,58,0) 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#00ffff3a',GradientType=1 ); /* IE6-9 */
background-repeat: repeat-x;
padding: 2rem 0;
}`
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T21:11:52.540

```
div{
     background-color:#ffffff;
     filter:progid:DXImageTransform.Microsoft.gradient(GradientType=1,startColorstr=#ffffff,       endColorstr=#ffff01);
     background-image:-moz-linear-gradient(left top, #ffffff 0%, #ffff01 100%);
     background-image:-webkit-linear-gradient(left top, #ffffff 0%, #ffff01 100%);
     background-image:-ms-linear-gradient(left top, #ffffff 0%, #ffff01 100%);
     background-image:linear-gradient(left top, #ffffff 0%, #ffff01 100%);
     background-image:-o-linear-gradient(left top, #ffffff 0%, #ffff01 100%);
     background-image:-webkit-gradient(linear, left top, right bottom, color-stop(0%,#ffffff),        color-stop(100%,#ffff01));
} 
```

# python - 获取调用者所在队列的名称，Twilio

> ID：15647308
> 
> 赞同：2
> 
> 时间：2013-03-26T21:00:01.273
> 
> 标签：python, twilio

我正在使用 Twilio 和 Python 设置电话树。我正在尝试获取呼叫者所在的队列的名称，以便与 SMS 警报一起发送给代理。我已经收集到队列的名称是`<Enqueue>`动词中的名词，但找不到任何关于如何获取该名称的信息。编码..

此部分响应`<Gather>`动词并根据呼叫者输入的内容将呼叫者分配到队列。

```
@app.route('/open', methods=['POST'])
def open():
    response = twiml.Response()
    if request.form['Digits'] == "1":
        response.enqueue("general", waitUrl="/wait")
    elif request.form['Digits'] == "2":
        response.enqueue("current", waitUrl="/wait")
    return str(response); 
```

此部分告诉呼叫者他们在队列中的位置、播放等待音乐并发送 SMS 消息。它当前`request.form['QueueSid']`所在的位置是我想要放置队列的“友好名称”的位置 - 例如，“general”。

```
@app.route('/wait', methods=['POST'])
def wait():
    response = twiml.Response()
    response.say("You are %s in the queue." % request.form['QueuePosition'])
    response.play("http://com.twilio.music.classical.s3.amazonaws.com/BusyStrings.mp3")
    account_sid = "*****"
    auth_token = "*****"
    client = TwilioRestClient(account_sid, auth_token)
    client.sms.messages.create(to="+15555555555", from_="+15555555554", body="A caller is in the call queue - %(num)s in queue %(queue)s" % {"num": request.form['From'], "queue" : request.form['QueueSid']})
    return str(response) 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:01:11.673

事实证明，我需要使用 Twilio`client`根据其 SID 获取队列的详细信息。这些细节包括我正在寻找的，`friendly_name`. 这是解决方案的更新代码 -

```
@app.route('/wait', methods=['POST'])
def wait():
    response = twiml.Response()
    response.say("You are %s in the queue." % request.form['QueuePosition'])
    response.play("http://com.twilio.music.classical.s3.amazonaws.com/BusyStrings.mp3")
    account_sid = "*****"
    auth_token = "*****"
    client = TwilioRestClient(account_sid, auth_token)
    queue = client.queues.get(request.form['QueueSid']) #Get the queue based on SID
    friendlyName = queue.friendly_name; #Obtain the queue's Friendly Name
    client.sms.messages.create(to="+15555555555", from_="+15555555554", body="A caller is in the call queue - %(num)s in queue %(queue)s" % {"num": request.form['From'], "queue" : friendlyName}) #SMS with caller ID and queue's friendly name
    return str(response) 
```

希望这可以帮助某人.. :)

# ruby-on-rails - Rails > 设计密码加密

> ID：15647310
> 
> 赞同：5
> 
> 时间：2013-03-26T21:00:13.473
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise, ruby-on-rails-3.2

我正在尝试实现一种方法，以允许从设计之外的另一个服务更改密码。

```
# Profile password change
def change_password(oldpass, newpass)
    pepper  = nil
    cost    = 10

    # Encrypt plain text passwords
    encrypt_old     = ::BCrypt::Password.create("#{oldpass}#{pepper}", :cost => cost).to_s

    # Validate old
    if self.encrypted_password == encrypt_old
        encrypt_new     = ::BCrypt::Password.create("#{newpass}#{pepper}", :cost => cost).to_s
        self.encrypted_password = encrypt_new
        self.save
    else
        Logger.new("Wrong old password!")
    end
end 
```

看来我的密码加密错误 oldpass 包含旧密码的纯文本，我需要对其进行哈希处理，看看它是否与当前密码匹配，然后允许存储新密码。但是，我得到的只是密码错误。

重做：

```
def change_password(oldpass, newpass)
    if valid_password?(oldpass)
        password = newpass
        save
        return true
    else
        return false
    end
end 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-26T21:07:08.383

如果您在应用程序或 Rails 控制台中，则不需要自己加密密码。

只需按照以下方式更新用户，Devise 就会自行处理。

```
user.password = new_password
user.save 
```

然后设计将加密密码并存储它。您只需要确保`user.password_confirmation`是`nil`. 如果`password_confirmation`是其他任何东西，它将与`password`.

**编辑**

您可以通过以下方式检查现有密码：`user.valid_password?(old_password)`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T21:08:15.877

使用 Devise，您无需自己处理使用 bcrypt。默认情况下，它处理这个和更改密码的方法。您可以在[此处](https://github.com/plataformatec/devise/blob/master/lib/generators/templates/devise.rb#L174)查看源代码，也可以`config/intitalizers/devise.rb`在您的 Rails 应用程序中查看。

另外，如果你使用`#update_with_password`Devise 提供的方法，那么你可以像这样传递一个哈希：

```
{ :current_password => 'pass', :password => 'pass_new', :password_confirmation => 'pass_new' } 
```

或者，`:password_confirmation`如果您不希望用户必须提供确认，则可以省略。

编辑：我使用了错误的字段；它应该是“current_password”而不是“old_password”。

这是设计源中的相关方法：

```
 # Update record attributes when :current_password matches, otherwise returns
  # error on :current_password. It also automatically rejects :password and
  # :password_confirmation if they are blank.
  def update_with_password(params, *options)
    current_password = params.delete(:current_password)

    if params[:password].blank?
      params.delete(:password)
      params.delete(:password_confirmation) if params[:password_confirmation].blank?
    end

    result = if valid_password?(current_password)
      update_attributes(params, *options)
    else
      self.assign_attributes(params, *options)
      self.valid?
      self.errors.add(:current_password, current_password.blank? ? :blank : :invalid)
      false
    end

    clean_up_passwords
    result
  end 
```

[在 GitHub 上查看](https://github.com/plataformatec/devise/blob/master/lib/devise/models/database_authenticatable.rb#L53-L75)

# php - 检查数组元素是否在不同的数组中

> ID：15647313
> 
> 赞同：2
> 
> 时间：2013-03-26T21:00:23.130
> 
> 标签：php, arrays, for-loop

我正在尝试创建一个函数，如果 $array1 中的所有项目都在 $array2 中，则返回 true，如果不返回 false。

我正在尝试做的事情：

```
$array1 = ['1', '3', '9', '17'];
$array2 = ['1', '2', '3', '4', '9', '11', '12', '17'];

function checkArray($arr, $arr2) {
    If all elements in $arr are in $arr2 return true
    else return false
}

if (checkArray($array1, $array2) {
    // Function returned true
} else {
    // Function returned false
} 
```

我想不出该怎么做！非常感谢帮助。

解决方案：

```
function checkArray($needles, $haystack) {
    $x = array_diff($needles, $haystack);
    if (count($x) > 0) {
        return false;
    } else {
        return true;
    }
}
// Returns false because more needles were found than in haystack
checkArray([1,2,3,4,5], [1,2,3]); 
// Returns true because all needles were found in haystack
checkArray([1,2,3], [1,2,3,4,5]); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:04:02.357

```
function checkArray($arr, $arr2) {
    return !count(array_diff($arr, $arr2));
} 
```

**array_diff**：返回一个数组，其中包含`$arr`中不存在的所有条目`$arr2`。[http://php.net/manual/en/function.array-diff.php](http://php.net/manual/en/function.array-diff.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T21:11:36.913

我不太确定 array_diff 以任何方式有用。那么谁在乎是否存在差异呢？您不是在比较数组，或者至少这不是我在问题中所理解的。您想知道一个数组是否**包含**另一个数组。

PHP 有一个方便的功能

```
function checkArray($arr, $arr2) {
    return (array_intersect($arr, $arr2) == $arr);
} 
```

# java - Java程序只返回输入，方法中不显示计算结果

> ID：15647317
> 
> 赞同：0
> 
> 时间：2013-03-26T21:00:27.863
> 
> 标签：java, methods, parameters

对于阶乘计算，欧拉数和欧拉幂x计算，我准备了下面的“阶乘”类和“behzat”类。当我执行程序时；它为每种方法返回相同的输入编号。任何人都可以建议问题是什么。非常感谢您的帮助。

**这是阶乘类：**

```
public class factorial {

    public void instructions()
    {
        System.out.printf("Enter your choice:\n",
        " 1 to calculate a factorial value of an integer.\n",
        " 2 to calculate mathematical constant e.\n",
        " 3 to calculate e^x.\n",
        " 4 to end.\n");        
    }  // End of instructions

    // ******* a ********

    public double calculateInputValue (int n){
    int ans=1;
    for (int i = 1; i <= n; i++){
    ans = ans * i;
    }
    return ans;
    } // end method calculateInputValue

    // ******  b *******
    public double calculate_e_value(double terms)
    {
    double e = 1;

    for(int i = 1; i < terms; i++)
        e += ((double) 1 /(calculateInputValue(i) )); 

    return e;
    }

    //********* c  ***********      
    public double compute_ex(double terms)  // method for e power x
    {
    int x = 1;  
    double e = 1;

    for( int i = 1; i < terms; i++)
        e += (Math.pow(x,i)/(calculateInputValue(i) )); 
        x++; 
    return e;

    }

} 
```

**和 behzat 类，包括主要：**

```
import java.util.Scanner;   // Program uses scanner. 

public class behzat
{ 

   private static Scanner input;

public static void main(String[] args)
   {

       factorial myfactorial = new factorial();
       myfactorial.instructions(); 
       System.out.printf(" ? "); 
       int choice; 
       input = new Scanner(System.in);
       choice = input.nextInt();

       switch(choice) 
       {  
       case 1 :             
          System.out.printf("enter number for factorial calculation");
          int number = 1; 
          number = input.nextInt();
          myfactorial.calculateInputValue(number);

          // If integer greater or 0, print "factorial is equal to: %d"
          if ( number >= 0 )                          
            System.out.printf("Factorial is equal to:%d\n", number);
          // otherwise, print "Input value not valid." 
          else
            System.out.printf( "Error: Input value not valid.\n");
          break;

        case 2:

            System.out.printf("enter number of terms to calculate of e constant.\n");
            number = input.nextInt();
            myfactorial.calculate_e_value(number);
            System.out.printf(" e value is %2d\n", number);
            break;

        case 3:

           System.out.printf("enter power x value of e constant.\n");
           number = input.nextInt();
           myfactorial.compute_ex(number);
           System.out.printf(" e power x is %2d\n", number);
           break;

        default: 
            myfactorial.instructions();
        }

   }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:05:54.630

您应该检索变量中每个方法的返回值，然后打印它。例如：

```
int val = myfactorial.calculateInputValue(number);
if ( val >= 0 )                          
System.out.printf("Factorial is equal to:%d\n", val); 
```

在您调用某个方法并打印检索到的值的任何地方都采用这种方式。那只会解决你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:06:24.110

至少在您的阶乘结果打印语句中：

```
if ( number >= 0 )                          
        System.out.printf("Factorial is equal to:%d\n", number); 
```

您正在打印输入`number`而不是阶乘的结果，这肯定总是打印您的输入`number`。

您必须存储阶乘结果：

```
long res = myfactorial.calculateInputValue(number);
if ( number >= 0 )                          
        System.out.printf("Factorial is equal to:%d\n", res); 
```

假设您的阶乘不会导致溢出。其他两种情况的类似错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:06:31.583

我认为你应该让输入表达你的函数的结果：

例子：

```
number = input.nextInt();
number = myfactorial.calculateInputValue(number);

// If integer greater or 0, print "factorial is equal to: %d"
if ( number >= 0 )                          
System.out.printf("Factorial is equal to:%d\n", number); 
```

# objective-c - 在 Objective C 中使用 Block 来确定是否设置了 BOOL？

> ID：15647320
> 
> 赞同：1
> 
> 时间：2013-03-26T21:00:40.027
> 
> 标签：objective-c, objective-c-blocks

我是 Obj-c 的新手。我有一个类，如果成功（游戏中心登录 = 成功），则将 var boolean 设置为 YES，这样做会很棒，以某种方式有一个侦听该 var 的侦听器，当它是 YES 然后执行一些代码。我为此使用块吗？我也在使用 Sparrow 框架。

这是我的 GameCenter.m 文件中的代码

```
-(void) setup
{
    gameCenterAuthenticationComplete = NO;

    if (!isGameCenterAPIAvailable()) {
        // Game Center is not available.
        NSLog(@"Game Center is not available.");
    } else {
        NSLog(@"Game Center is available.");

            __weak typeof(self) weakSelf = self; // removes retain cycle error

            GKLocalPlayer *localPlayer =  [GKLocalPlayer localPlayer]; // localPlayer is the public GKLocalPlayer

        __weak GKLocalPlayer *weakPlayer = localPlayer; // removes retain cycle error

            weakPlayer.authenticateHandler = ^(UIViewController *viewController, NSError *error)
            {
                if (viewController != nil)
                {
                    [weakSelf showAuthenticationDialogWhenReasonable:viewController];
                }
                else if (weakPlayer.isAuthenticated)
                {
                    [weakSelf authenticatedPlayer:weakPlayer];
                }
                else
                {
                    [weakSelf disableGameCenter];
                }
            };
        }

    }

    -(void)showAuthenticationDialogWhenReasonable:(UIViewController *)controller
    {
        [[[[[UIApplication sharedApplication] delegate] window] rootViewController] presentViewController:controller animated:YES completion:nil];
    }

    -(void)authenticatedPlayer:(GKLocalPlayer *)player
    {
        NSLog(@"%@,%@,%@",player.playerID,player.displayName, player.alias);

        gameCenterAuthenticationComplete = YES;

    }

    -(void)disableGameCenter
    {

    } 
```

但是我需要从另一个对象知道 gameCenterAuthenticationComplete 是否等于 YES。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T21:05:52.110

您可以使用委托模式。它比 KVO 或本地通知更容易使用，并且在 Obj-C 中被大量使用。

通知应仅在特定情况下使用（例如，当您不知道谁想收听或当有超过 1 个听众时）。

一个块在这里可以工作，但委托人做的完全一样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T21:04:36.960

您可以使用 KVO（键值观察）来观察对象的属性，但我宁愿在您的情况下发布 NSNotification。

您需要让有兴趣了解 Game Center 登录时间的对象注册到`NSNotificationCenter`，然后将其发布到`NSNotification`您的 Game Center 处理程序中。阅读*通知编程主题*了解更多详情！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:04:51.170

如果有一个方法可以在单个委托对象上执行，您可以简单地在 setter 中调用它。让我给这个属性起个名字：

```
@property(nonatomic,assign, getter=isLogged) BOOL logged; 
```

实现 setter 就足够了：

```
- (void) setLogged: (BOOL) logged
{
    _logged=logged;
   if(logged)
       [_delegate someMethod];
} 
```

另一种（建议的）方法是使用 NSNotificationCenter。使用 NSNotificationCenter 你可以通知多个对象。所有想要在属性更改为 YES 时执行方法的对象都必须注册：

```
NSNotificationCenter* center=[NSNotificationCenter defaultCenter];
[center addObserver: self selector: @selector(handleEvent:) name: @"Logged" object: nil]; 
```

每次将更改记录为 YES 时都会执行 handleEvent: 选择器。因此，每当属性更改时发布通知：

```
- (void) setLogged: (BOOL) logged
{
    _logged=logged;
   if(logged)
   {
        NSNotificationCenter* center=[NSNotificationCenter defaultCenter];
        [center postNotificationName: @"Logged" object: self];
   }
} 
```

# jquery - JQuery 将数据发布到 MVC 操作方法？

> ID：15647321
> 
> 赞同：2
> 
> 时间：2013-03-26T21:00:43.683
> 
> 标签：jquery, asp.net-mvc, model-view-controller

我要做的就是将字符串/整数数组传递给 mvc 操作方法。但是数据总是返回为空，我做错了什么？

MVC 控制器

```
[HttpPost]
 public ActionResult MyAction(List<string> ids)
 {
   // do something with array
   // But it's null
      return View();
 } 
```

jQuery

```
$.post("/MyController/MyAction", JSON.stringify(ids), function () { alert("woohoo"); }, "application/json"); 
```

发布到操作结果的数据

```
["156"] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T21:08:03.513

尝试：

```
... JSON.stringify({ ids : ids }), ... 
```

我很确定模型绑定器也不确定应该绑定什么列表/数组。

考虑：

```
[HttpPost]
public ActionResult MyAction(List<string> ids, List<string> blah)
{
} 
```

如果 JSON 仅作为值数组传递，那么还要绑定哪个参数？JSON 可能比 Forms 提交复杂得多，因此它还需要更多定义。

例如，以下内容适用于前面的考虑。

```
{
  ids : ["asdf","asdf"],
  blah : ["qwer", "qwer"]
} 
```

**更新**

为了正确发送 json，需要进行以下 ajax 调用：

```
$.ajax({
  type: "POST",
  url: "/Home/Index",
  data: JSON.stringify( ids ),
  contentType: "application/json; charset=utf-8"
}); 
```

Post 中的最后一个参数（您指定`application/json`）是期望从服务器返回的内容。默认情况下， $.Post 将执行 Forms Encoded ( `application/x-www-form-urlencoded`) contentType ，它似乎被硬编码到快捷方法中。要设置 contentType，您必须使用长期版本 $.ajax。

# c# - 多个用户控件略有不同

> ID：15647322
> 
> 赞同：0
> 
> 时间：2013-03-26T21:00:50.363
> 
> 标签：c#, wpf, datagrid, user-controls, readonly-attribute

我正在使用三个`UserControls`有数据网格的。`UserControl's` `DataGrid`需要将列只读属性设置为`True`.

是的，我在这样做之后`InitializeComponent()`：

```
v_uc1.v_datagrid.Columns[1].IsReadOnly = true; 
```

有没有更清洁的方法（XAML）来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:47:10.690

您可以只制作一个 UserControl ，其属性可以显示它们之间的差异，例如

```
public class MyUserControl
....

public bool IsColumn1ReadOnly{
    get{ return v_uc1.v_datagrid.Columns[1].IsReadOnly;}
    set {return v_uc1.v_datagrid.Columns[1].IsReadOnly = value;}
} 
```

然后在 XAML 中，您将像这样实例化控件：

```
<my:MyUserControl IsColumn1ReadOnly="True"/>
<my:MyUserControl IsColumn1ReadOnly="False"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:14:50.263

如果要在 xaml 中将数据网格列设置为只读，请执行以下操作

```
 <DataGridTextColumn  IsReadOnly="True"/> 
```

# android - 在 Android 中格式化 EditText 的电话号码

> ID：15647327
> 
> 赞同：80
> 
> 时间：2013-03-26T21:01:15.570
> 
> 标签：android

我正在制作一个简单的地址簿应用程序（针对 4.2），它包含姓名、地址、城市、州、邮编和电话。

我想将输入的电话号码格式化为电话号码 (XXX) XXX-XXXX，但我需要将值作为字符串提取出来，以便在保存时将其存储在数据库中。我怎样才能做到这一点？？我为“电话号码”输入设置了 EditText，但这显然并没有做太多。

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2013-03-26T21:07:57.870

只需使用[PhoneNumberFormattingTextWatcher](https://developer.android.com/reference/android/telephony/PhoneNumberFormattingTextWatcher.html)，只需调用：

```
editText.addTextChangedListener(new PhoneNumberFormattingTextWatcher()); 
```

* * *

**另外**
需要明确的是，PhoneNumberFormattingTextWatcher 的[主干](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.2.2_r1/android/telephony/PhoneNumberFormattingTextWatcher.java#PhoneNumberFormattingTextWatcher.afterTextChanged%28android.text.Editable%29)是PhoneNumberUtils 类。`PhoneNumberUtils.formatNumber()`不同之处在于 TextWatcher 维护 EditText，而您每次更改其内容时都必须调用它。

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2013-03-26T21:09:56.380

有一个名为[PhoneNumberUtils](http://developer.android.com/reference/android/telephony/PhoneNumberUtils.html)的库可以帮助您处理电话号码的转换和比较。例如，使用...

```
EditText text = (EditText) findViewById(R.id.editTextId);
PhoneNumberUtils.formatNumber(text.getText().toString()) 
```

...以标准格式格式化您的号码。

```
PhoneNumberUtils.compare(String a, String b); 
```

...有助于模糊比较。还有很多。查看[http://developer.android.com/reference/android/telephony/PhoneNumberUtils.html](http://developer.android.com/reference/android/telephony/PhoneNumberUtils.html)了解更多信息。

ps 将 EditText 设置`phone`为已经是一个不错的选择；`digits`最终，在你的布局中添加它可能会有所帮助，它看起来像......

```
<EditText
    android:id="@+id/editTextId"
    android:inputType="phone"
    android:digits="0123456789+" 
/> 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2014-11-17T09:21:08.677

只需使用这个：

在 Java 代码中：

```
editText.addTextChangedListener(new PhoneNumberFormattingTextWatcher()); 
```

在 XML 代码中：

```
<EditText
    android:id="@+id/etPhoneNumber"
    android:inputType="phone"/> 
```

这段代码对我有用。当编辑文本中的文本更改时，它将自动格式化。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2014-05-14T15:41:29.023

我最近为 Android EditText 做了类似的格式，如 1 (XXX) XXX-XXXX。请在下面找到代码。只需使用 TextWatcher 子类作为文本更改侦听器： ....

```
UsPhoneNumberFormatter addLineNumberFormatter = new UsPhoneNumberFormatter(
            new WeakReference<EditText>(mYourEditText));
    mYourEditText.addTextChangedListener(addLineNumberFormatter); 
```

...

```
private class UsPhoneNumberFormatter implements TextWatcher {
    //This TextWatcher sub-class formats entered numbers as 1 (123) 456-7890
    private boolean mFormatting; // this is a flag which prevents the
                                    // stack(onTextChanged)
    private boolean clearFlag;
    private int mLastStartLocation;
    private String mLastBeforeText;
    private WeakReference<EditText> mWeakEditText;

    public UsPhoneNumberFormatter(WeakReference<EditText> weakEditText) {
        this.mWeakEditText = weakEditText;
    }

    @Override
    public void beforeTextChanged(CharSequence s, int start, int count,
            int after) {
        if (after == 0 && s.toString().equals("1 ")) {
            clearFlag = true;
        }
        mLastStartLocation = start;
        mLastBeforeText = s.toString();
    }

    @Override
    public void onTextChanged(CharSequence s, int start, int before,
            int count) {
        // TODO: Do nothing
    }

    @Override
    public void afterTextChanged(Editable s) {
        // Make sure to ignore calls to afterTextChanged caused by the work
        // done below
        if (!mFormatting) {
            mFormatting = true;
            int curPos = mLastStartLocation;
            String beforeValue = mLastBeforeText;
            String currentValue = s.toString();
            String formattedValue = formatUsNumber(s);
            if (currentValue.length() > beforeValue.length()) {
                int setCusorPos = formattedValue.length()
                        - (beforeValue.length() - curPos);
                mWeakEditText.get().setSelection(setCusorPos < 0 ? 0 : setCusorPos);
            } else {
                int setCusorPos = formattedValue.length()
                        - (currentValue.length() - curPos);
                if(setCusorPos > 0 && !Character.isDigit(formattedValue.charAt(setCusorPos -1))){
                    setCusorPos--;
                }
                mWeakEditText.get().setSelection(setCusorPos < 0 ? 0 : setCusorPos);
            }
            mFormatting = false;
        }
    }

    private String formatUsNumber(Editable text) {
        StringBuilder formattedString = new StringBuilder();
        // Remove everything except digits
        int p = 0;
        while (p < text.length()) {
            char ch = text.charAt(p);
            if (!Character.isDigit(ch)) {
                text.delete(p, p + 1);
            } else {
                p++;
            }
        }
        // Now only digits are remaining
        String allDigitString = text.toString();

        int totalDigitCount = allDigitString.length();

        if (totalDigitCount == 0
                || (totalDigitCount > 10 && !allDigitString.startsWith("1"))
                || totalDigitCount > 11) {
            // May be the total length of input length is greater than the
            // expected value so we'll remove all formatting
            text.clear();
            text.append(allDigitString);
            return allDigitString;
        }
        int alreadyPlacedDigitCount = 0;
        // Only '1' is remaining and user pressed backspace and so we clear
        // the edit text.
        if (allDigitString.equals("1") && clearFlag) {
            text.clear();
            clearFlag = false;
            return "";
        }
        if (allDigitString.startsWith("1")) {
            formattedString.append("1 ");
            alreadyPlacedDigitCount++;
        }
        // The first 3 numbers beyond '1' must be enclosed in brackets "()"
        if (totalDigitCount - alreadyPlacedDigitCount > 3) {
            formattedString.append("("
                    + allDigitString.substring(alreadyPlacedDigitCount,
                            alreadyPlacedDigitCount + 3) + ") ");
            alreadyPlacedDigitCount += 3;
        }
        // There must be a '-' inserted after the next 3 numbers
        if (totalDigitCount - alreadyPlacedDigitCount > 3) {
            formattedString.append(allDigitString.substring(
                    alreadyPlacedDigitCount, alreadyPlacedDigitCount + 3)
                    + "-");
            alreadyPlacedDigitCount += 3;
        }
        // All the required formatting is done so we'll just copy the
        // remaining digits.
        if (totalDigitCount > alreadyPlacedDigitCount) {
            formattedString.append(allDigitString
                    .substring(alreadyPlacedDigitCount));
        }

        text.clear();
        text.append(formattedString.toString());
        return formattedString.toString();
    }

} 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2016-07-27T10:18:54.260

也许下面的示例项目可以帮助您；

[https://github.com/reinaldoarrosi/MaskedEditText](https://github.com/reinaldoarrosi/MaskedEditText)

该项目包含一个视图类调用`MaskedEditText`。首先，**您应该将它添加到您的项目**中。

然后在项目的 res/values/attrs.xml 文件中添加下面的 xml 部分；

```
<resources>
    <declare-styleable name="MaskedEditText">
        <attr name="mask" format="string" />
        <attr name="placeholder" format="string" />
    </declare-styleable>
</resources> 
```

然后你就可以使用`MaskedEditText`视图了。

最后，您应该在 xml 文件中添加 MaskedEditText，如下所示；

```
<packagename.currentfolder.MaskedEditText
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/maskedEditText"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10"
    android:text="5"
    app:mask="(999) 999-9999"
    app:placeholder="_" > 
```

当然，您可以通过编程方式使用它。

在这些步骤之后，添加`MaskedEditText`将如下所示；

[![在此处输入图像描述](../Images/e9a2a2e00113623898009ecde6c12516.png)](https://i.stack.imgur.com/YqU2p.png)

以编程方式，如果您想将其文本值设为未屏蔽，您可以使用下面的行；

```
maskedEditText.getText(true); 
```

要获取掩码值，您可以在方法中发送`false`值而不是值。`true``getText`

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2019-05-11T11:48:39.897

您需要创建一个类：

```
public class PhoneTextFormatter implements TextWatcher {

    private final String TAG = this.getClass().getSimpleName();

    private EditText mEditText;

    private String mPattern;

    public PhoneTextFormatter(EditText editText, String pattern) {
        mEditText = editText;
        mPattern = pattern;
        //set max length of string
        int maxLength = pattern.length();
        mEditText.setFilters(new InputFilter[]{new InputFilter.LengthFilter(maxLength)});
    }

    @Override
    public void beforeTextChanged(CharSequence s, int start, int count, int after) {

    }

    @Override
    public void onTextChanged(CharSequence s, int start, int before, int count) {
        StringBuilder phone = new StringBuilder(s);

        Log.d(TAG, "join");

        if (count > 0 && !isValid(phone.toString())) {
            for (int i = 0; i < phone.length(); i++) {
                Log.d(TAG, String.format("%s", phone));
                char c = mPattern.charAt(i);

                if ((c != '#') && (c != phone.charAt(i))) {
                    phone.insert(i, c);
                }
            }

            mEditText.setText(phone);
            mEditText.setSelection(mEditText.getText().length());
        }
    }

    @Override
    public void afterTextChanged(Editable s) {

    }

    private boolean isValid(String phone)
    {
        for (int i = 0; i < phone.length(); i++) {
            char c = mPattern.charAt(i);

            if (c == '#') continue;

            if (c != phone.charAt(i)) {
                return false;
            }
        }

        return true;
    }
} 
```

如下使用它：

```
phone = view.findViewById(R.id.phone);
phone.addTextChangedListener(new PhoneTextFormatter(phone, "+7 (###) ###-####")); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-01-20T18:26:00.720

按照此答案中的说明格式化 EditText 掩码。

> [https://stackoverflow.com/a/34907607/1013929](https://stackoverflow.com/a/34907607/1013929)

之后，您可以使用以下方法从屏蔽字符串中捕获原始数字：

```
String phoneNumbers = maskedString.replaceAll("[^\\d]", ""); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-12-03T11:19:23.037

更像是干净的：

```
@Override
public void onTextChanged(CharSequence s, int start, int before, int count) {

String text = etyEditText.getText();
    int textlength = etyEditText.getText().length();

    if (text.endsWith("(") ||text.endsWith(")")|| text.endsWith(" ") || text.endsWith("-")  )
                return;

    switch (textlength){
        case 1:
            etyEditText.setEditText(new StringBuilder(text).insert(text.length() - 1, "(").toString());
            etyEditText.setSelection(etyEditText.getText().length());
            break;
        case 5:
            etyEditText.setEditText(new StringBuilder(text).insert(text.length() - 1, ")").toString());
            etyEditText.setSelection(etyEditText.getText().length());
            break;
        case 6:
            etyEditText.setEditText(new StringBuilder(text).insert(text.length() - 1, " ").toString());
            etyEditText.setSelection(etyEditText.getText().length());
            break;
        case 10:
            etyEditText.setEditText(new StringBuilder(text).insert(text.length() - 1, "-").toString());
            etyEditText.setSelection(etyEditText.getText().length());
            break;
    }

} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-03-10T12:19:02.647

```
//(123) 456 7890  formate set

private int textlength = 0;

public class MyPhoneTextWatcher implements TextWatcher {

    @Override
    public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {
    }
    @Override
    public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {

        String text = etMobile.getText().toString();
        textlength = etMobile.getText().length();

        if (text.endsWith(" "))
            return;

        if (textlength == 1) {
            if (!text.contains("(")) {
                etMobile.setText(new StringBuilder(text).insert(text.length() - 1, "(").toString());
                etMobile.setSelection(etMobile.getText().length());
            }

        } else if (textlength == 5) {

            if (!text.contains(")")) {
                etMobile.setText(new StringBuilder(text).insert(text.length() - 1, ")").toString());
                etMobile.setSelection(etMobile.getText().length());
            }

        } else if (textlength == 6 || textlength == 10) {
            etMobile.setText(new StringBuilder(text).insert(text.length() - 1, " ").toString());
            etMobile.setSelection(etMobile.getText().length());
        }

    }
    @Override
    public void afterTextChanged(Editable editable) {
    }
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-03-26T21:23:43.180

You can use a Regular Expression with pattern matching to extract number from a string.

```
 String s="";
    Pattern p = Pattern.compile("\\d+");
    Matcher m = p.matcher("(1111)123-456-789"); //editText.getText().toString()                                      
    while (m.find()) {
    s=s+m.group(0);
    }
    System.out.println("............"+s);    

    Output : ............1111123456789 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-08-20T10:34:38.073

如果您只对国际号码感兴趣，并且希望能够在输入中显示与国家/地区代码匹配的国家/地区的国旗，我为此编写了一个小型库：

[https://github.com/tfcporciuncula/phonemoji](https://github.com/tfcporciuncula/phonemoji)

这是它的外观：

[![图书馆演示](../Images/be4d4c6b03bb73638631ce093b0d612c.png)](https://i.stack.imgur.com/wRjbl.gif)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-07-12T07:12:57.147

不用担心。我已经为你做了一个更好的解决方案。您可以在下面看到这个简单的应用程序链接。

```
private EditText mPasswordField;
public int textLength = 0;

@Override
protected void onCreate(@Nullable Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    mPasswordField = (EditText) findViewById(R.id.password_field);
    mPasswordField.addTextChangedListener(this);
}

@Override
public void beforeTextChanged(CharSequence s, int start, int count, int after) {

}
@Override
public void onTextChanged(CharSequence s, int start, int before, int count) {

    String text = mPasswordField.getText().toString();
    textLength = mPasswordField.getText().length();

    if (text.endsWith("-") || text.endsWith(" ") || text.endsWith(" "))
        return;

    if (textLength == 1) {
        if (!text.contains("(")) {
            mPasswordField.setText(new StringBuilder(text).insert(text.length() - 1, "(").toString());
            mPasswordField.setSelection(mPasswordField.getText().length());
        }

    } else if (textLength == 5) {

        if (!text.contains(")")) {
            mPasswordField.setText(new StringBuilder(text).insert(text.length() - 1, ")").toString());
            mPasswordField.setSelection(mPasswordField.getText().length());
        }

    } else if (textLength == 6) {
            mPasswordField.setText(new StringBuilder(text).insert(text.length() - 1, " ").toString());
            mPasswordField.setSelection(mPasswordField.getText().length());

    } else if (textLength == 10) {
        if (!text.contains("-")) {
            mPasswordField.setText(new StringBuilder(text).insert(text.length() - 1, "-").toString());
            mPasswordField.setSelection(mPasswordField.getText().length());
        }
    } else if (textLength == 15) {
        if (text.contains("-")) {
            mPasswordField.setText(new StringBuilder(text).insert(text.length() - 1, "-").toString());
            mPasswordField.setSelection(mPasswordField.getText().length());
        }
    }else if (textLength == 18) {
        if (text.contains("-")) {
            mPasswordField.setText(new StringBuilder(text).insert(text.length() - 1, "-").toString());
            mPasswordField.setSelection(mPasswordField.getText().length());
        }
    } else if (textLength == 20) {
        Intent i = new Intent(MainActivity.this, Activity2.class);
        startActivity(i);

    }

}

@Override
public void afterTextChanged(Editable s) {

} 
```

不：不要忘记在您的活动类中“实现 TextWatcher”。

链接：[https ://drive.google.com/open?id=0B-yo9VvU7jyBMjJpT29xc2k5bnc](https://drive.google.com/open?id=0B-yo9VvU7jyBMjJpT29xc2k5bnc)

希望您对这个解决方案感到很酷。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-03-27T13:52:05.943

您可以使用 spawns 在 Android 中格式化电话号码。此解决方案比其他解决方案更好，因为它不会更改输入文本。格式化仍然是纯视觉的。

```
implementation 'com.googlecode.libphonenumber:libphonenumber:7.0.4' 
```

格式化程序类：

```
open class PhoneNumberFormatter : TransformationMethod {
private val mFormatter: AsYouTypeFormatter = PhoneNumberUtil.getInstance().getAsYouTypeFormatter(Locale.getDefault().country)

override fun getTransformation(source: CharSequence, view: View): CharSequence {
    val formatted = format(source)
    if (source is Spannable) {
        setSpans(source, formatted)
        return source
    }
    return formatted
}
override fun onFocusChanged(view: View?, sourceText: CharSequence?, focused: Boolean, direction: Int, previouslyFocusedRect: Rect?) = Unit

private fun setSpans(spannable: Spannable, formatted: CharSequence): CharSequence {

    spannable.clearSpawns()

    var charterIndex = 0
    var formattedIndex = 0
    var spawn = ""
    val spawns: List<String> = spannable
        .map {
            spawn = ""
            charterIndex = formatted.indexOf(it, formattedIndex)
            if (charterIndex != -1){
                spawn = formatted.substring(formattedIndex, charterIndex-1)
                formattedIndex = charterIndex+1
            }
            spawn
        }

    spawns.forEachIndexed { index, sequence ->
        spannable.setSpan(CharterSpan(sequence), index, index + 1, Spanned.SPAN_EXCLUSIVE_EXCLUSIVE)
    }

    return formatted
}

private fun Spannable.clearSpawns() =
    this
        .getSpans(0, this.length, CharterSpan::class.java)
        .forEach { this.removeSpan(it) }

private fun format(spannable: CharSequence): String {
    mFormatter.clear()
    var formated = ""
    for (i in 0 until spannable.length) {
        formated = mFormatter.inputDigit(spannable[i])
    }
    return formated
}

private inner class CharterSpan(private val charters: String) : ReplacementSpan() {

    var space = 0

    override fun getSize(paint: Paint, text: CharSequence, start: Int, end: Int, fm: Paint.FontMetricsInt?): Int {
        space = Math.round(paint.measureText(charters, 0, charters.length))
        return Math.round(paint.measureText(text, start, end)) + space
    }

    override fun draw(canvas: Canvas, text: CharSequence, start: Int, end: Int, x: Float, top: Int, y: Int, bottom: Int, paint: Paint) {
        space = Math.round(paint.measureText(charters, 0, charters.length))
        canvas.drawText(text, start, end, x + space, y.toFloat(), paint)
        canvas.drawText(charters, x, y.toFloat(), paint)
    }
    }

} 
```

用法：

```
editText.transformationMethod = formatter 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-03-12T18:21:38.477

此代码适用于 (216) 555-5555

```
etphonenumber.addTextChangedListener(new TextWatcher()
        {
            @Override
            public void onTextChanged(CharSequence s, int start, int before, int count)
            {
                // TODO Auto-generated method stub
            }

            @Override
            public void beforeTextChanged(CharSequence s, int start, int count, int after)
            {
                // TODO Auto-generated method stub
            }
            @Override
            public void afterTextChanged(Editable s)
            {
                String text = etphonenumber.getText().toString();
                int  textLength = etphonenumber.getText().length();
                if (text.endsWith("-") || text.endsWith(" ") || text.endsWith(" "))
                    return;
                if (textLength == 1) {
                    if (!text.contains("("))
                    {
                        etphonenumber.setText(new StringBuilder(text).insert(text.length() - 1, "(").toString());
                        etphonenumber.setSelection(etphonenumber.getText().length());
                    }
                }
                else if (textLength == 5)
                {
                    if (!text.contains(")"))
                    {
                        etphonenumber.setText(new StringBuilder(text).insert(text.length() - 1, ")").toString());
                        etphonenumber.setSelection(etphonenumber.getText().length());
                    }
                }
                else if (textLength == 6)
                {
                    etphonenumber.setText(new StringBuilder(text).insert(text.length() - 1, " ").toString());
                    etphonenumber.setSelection(etphonenumber.getText().length());
                }
                else if (textLength == 10)
                {
                    if (!text.contains("-"))
                    {
                        etphonenumber.setText(new StringBuilder(text).insert(text.length() - 1, "-").toString());
                        etphonenumber.setSelection(etphonenumber.getText().length());
                    }
                }
            }
        }); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-11-01T18:07:09.003

您只能接受使用 java 代码的数字和电话号码类型

```
 EditText number1 = (EditText) layout.findViewById(R.id.edittext); 
    number1.setInputType(InputType.TYPE_CLASS_NUMBER|InputType.TYPE_CLASS_PHONE);
     number1.setKeyListener(DigitsKeyListener.getInstance("0123456789”));
      number1.setFilters(new InputFilter[] {new InputFilter.LengthFilter(14)}); // 14 is max digits 
```

此代码将在读取输入后避免大量验证

# lisp - 在 CLISP 中并行迭代 2 个列表

> ID：15647345
> 
> 赞同：0
> 
> 时间：2013-03-26T21:02:35.660
> 
> 标签：lisp, common-lisp

我是新手，试图并行迭代 2 个列表，如下所示：

```
(defun test-do* (l1 l2)
  (do* ((temp1 l1 (cdr l1))
        (var1 (car temp1) (car temp1))
        (temp2 l2 (cdr l2))
        (var2 (car temp2) (car temp2)))
       ((endp temp1) 'end-of-l1) )) 
```

问题是我的代码中有一个无限循环，我不知道为什么。您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T21:32:37.857

我不确定您到底要做什么，但是对代码的这种修改修复了无限循环：

```
(defun test-do* (l1 l2)
  (do* ((temp1 l1 (cdr temp1))
        (var1 (car temp1) (car temp1))
        (temp2 l2 (cdr temp2))
        (var2 (car temp2) (car temp2)))
       ((endp temp1) 'end-of-l1) )) 
```

考虑`do*`循环中的语句之一：

```
(temp1 l1 (cdr l1)) 
```

翻译成英语（在`do*`循环的上下文中），这意味着：“这不是你想要的，因为 的值`l1`永远不会改变，因此`temp1`在第一次之后的每次迭代中都分配相同的值。考虑这个修改：

```
(temp1 l1 (cdr temp1)) 
```

这意味着：“在第一次迭代中，设置`temp1`为 的值`l1`。在每个后续迭代中，设置`temp1`为 的值`(cdr temp1)`。” 这样，`temp1`每次迭代的值取决于上一次迭代的值`temp1`，并且您的循环会按照您的预期逐步遍历列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-11T15:54:28.590

（循环 for x in '(abcde) for y in '(1 2 3 4 5) collect (list xy) ）

((A 1) (B 2) (C 3) (D 4) (E 5))

# javascript - JS/jQuery 替换部分日期字符串不起作用

> ID：15647347
> 
> 赞同：0
> 
> 时间：2013-03-26T21:02:36.623
> 
> 标签：javascript, jquery

我有一个可见的表格行，其中包含一个带有“time-col”类的表格单元格。事实上，我有不止一个，父行的可见性是动态的。

我正在尝试用数字字符串（即 3、4 等）替换月份的三个字符串表示（即 MAR、APR 等）。

根据我虚弱的头脑，以下应该有效：

```
$('tr:visible .time-col').each(function() {
    // convert month string to numerical representation
    var monthStr = $(this).text().match(/[^\/]*/)[0];
    var months = { 'JAN': '1', 'FEB': '2','MAR': '3','APR': '4','MAY': '5','JUN': '6','JUL': '7','AUG': '8','SEP': '9','OCT': '10','NOV': '11','DEC': '12' };
    var month = months[monthStr];
    $(this).text( $(this).text().replace(monthStr, month) );
}); 
```

但结果将正确的字符串替换为“未定义”。现在，如果我替换最后一行：

```
$(this).text( $(this).text().replace(monthStr, month) ); 
```

和：

```
$(this).text(month); 
```

我得到了相应表格单元格中显示的正确数字（即 3、4 等）。

是什么导致 Stack Overflow？¿

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:05:56.230

`$(this).text()`返回一个字符串。修改该字符串不会触及原始字符串。

要修改文本，请设置元素的文本：

```
var text = $(this).text();
$(this).text(text.replace(monthStr, month)); 
```

此外，`.replace()`将字符串作为第一个参数仅替换字符串的第一个实例。您必须使用正则表达式一次替换所有出现的事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T00:31:12.520

令人惊讶的是，我自己解决了这个问题。问题是，无论出于何种原因，JavaScript 都没有像我预期的那样工作，它决定不在我的月份对象中给我的数字字符串一个数据类型。

改变：

```
var month = months[monthStr] 
```

至：

```
var month = months[monthStr].toString(); 
```

解决了问题！

# javascript - 动态插入均匀间隔的列表项打破了合理的方法

> ID：15647349
> 
> 赞同：0
> 
> 时间：2013-03-26T21:02:39.867
> 
> 标签：javascript, html, css, navigation

我一直在使用[此答案](https://stackoverflow.com/a/7650004/419831)中找到的技术来分隔列表项，但最近的一项更改是要求我动态插入元素。我发现由于某种原因，如果动态插入元素，该方法将完全停止工作。为什么？

[这个小提琴](http://jsfiddle.net/eBPen/1/)演示了静态和动态版本。

如链接问题所示，基本思想如下。只是当通过 Javascript 将 HTML 插入页面时，菜单项不合理。

**HTML**

```
<div id="menuwrapper">
    <div class="menuitem">menu</div>
    <div class="menuitem">menu</div>
    ...
    <span class="stretcher"></span>
</div> 
```

**CSS**

```
#menuwrapper, #dynamic {
    height: auto;
    background: #000;
    text-align: justify;
    -ms-text-justify: distribute-all-lines;
    text-justify: distribute-all-lines;
    min-width: 300px; /* just for demo */
}

#dynamic {
    background: blue;
}

.menuitem {
    width: auto;
    height: 40px;
    vertical-align: top;
    display: inline-block;
    *display: inline;
    zoom: 1
    background: #000;
    color: yellow;
}

.stretcher {
    width: 100%;
    display: inline-block;
    font-size: 0;
    line-height: 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:12:09.687

元素之间没有空格。看看[jsfiddle](http://jsfiddle.net/eBPen/2/)

```
document.getElementById("dynamic").innerHTML = '<div class="menuitem">CAREERS</div> <div class="menuitem">TRADE</div> <div class="menuitem">CONTACT US</div> <div class="menuitem">PRIVACY POLICY</div> <div class="menuitem">T&amp;CS</div> <div class="menuitem">SITEMAP</div> <span class="stretcher"></span>'; 
```

一些相关文章： -[与内联块元素之间的空间作斗争](http://css-tricks.com/fighting-the-space-between-inline-block-elements/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:27:04.310

你可以做苹果网站所做的事情并制作你的菜单项`display: table-cell;` 这可能不完全跨浏览器兼容（例如 IE6 可能会失败），但它根本不需要任何 javascript

# c++ - 使用 auto 对函子进行类型推导

> ID：15647350
> 
> 赞同：3
> 
> 时间：2013-03-26T21:02:40.163
> 
> 标签：c++, c++11, auto

我对 C++11 特性比较陌生。我对自动功能以及它如何类型推导函子有疑问。考虑以下代码片段：

```
bool test1(double a, double b) {
   return (a<b);
}

   bool test2(double a, double b) {
       return (a>b);
   }

   struct Test1 {
       bool operator()(double a, double b) {
          return (a<b);
       }
   };

   struct Test2 {
       bool operator()(double a, double b){
          return (a>b);
       }
   };

   int main() {
       const bool ascending = false; 
      auto comparator =  ascending? test1:test2; // works fine
      auto comparator2 = ascending? Test1():Test2(); // compiler error: imcompatible types
      std::function<bool(double, double)> comparator3 = ascending? Test1():Test2(); // compiler error: imcompatible types;

   } 
```

虽然 auto （和 std::function ）适用于函数，但它对于函数对象失败（类型推断）。为什么是这样？我在这里遗漏了一些基本的 wrt 类型推断。

（我正在使用 Visual Studio 2012）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-26T21:10:05.147

根据*条件*( `?`) 运算符的 C++11 标准第 5.16/3 段：

> [...] 如果第二个和第三个操作数具有不同的类型并且具有（可能是 cv 限定的）类类型，或者如果两者都是相同值类别和相同类型（除了 cv 限定）的 glvalue，则进行尝试将这些操作数中的每一个转换为另一个的类型。[...] **如果两者都可以转换，或者可以转换但转换不明确，则程序格式错误**。[...]

在您的情况下，既`Test1`不能也`Test2`不能转换为其他类型。这就是编译器抱怨“不兼容类型”的原因。

Npice，如果不是这种情况， 和 的类型`comparator2`将`comparator3`在*运行时*根据 的值确定`ascending`。但是，C++ 是一种*静态类型*语言，这意味着**所有对象的类型都必须在编译时确定**。

如果您需要执行比较器的运行时选择并将结果保存在一个变量中，请考虑首先将两个对象分配给可以封装它们的相同类型的函子，*然后*执行选择：

```
 std::function<bool(double, double)> c1 = Test1();
    std::function<bool(double, double)> c2 = Test2();
    auto c = (ascending) ? c1 : c2; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T21:08:35.793

问题是条件运算符的两个选项`?:`必须可转换为单一的通用类型。在这种情况下，`Test1`and`Test2`是不相关的，不可能像那样使用运算符。

但是，这是合法的：

```
 int main() {
      const bool ascending = false; 
      std::function<bool(double, double)> t1 = Test1();
      std::function<bool(double, double)> t2 = Test2();
      auto comparator4 = ascending? t1: t2;
   } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-26T21:08:50.060

`test1`并且`test2`两者都是 type `bool(double, double)`，所以无论你采用什么分支，条件表达式的类型都是相同的。is的类型，is`Test1()`的类型。所以表达式没有通用类型。这两种类型*都*可以用来构造一个对象，使用该类的构造函数模板，但是这种类型的转换不会自动为表达式执行：您必须手动转换：`Test1``Test2()``Test2`*`std::function<bool(double, double)>`*

 *```
auto comparator3 = ascending ? std::function<bool(double, double)>(Test1())
                             : std::function<bool(double, double)>(Test2()); 
```*

# mysql - 有没有一种简单的方法可以在数据库列中定义项目列表

> ID：15647351
> 
> 赞同：0
> 
> 时间：2013-03-26T21:02:48.063
> 
> 标签：mysql, sql

我的 2 个数据库表中有一个“状态”列，但每个表的状态类型相同。例如，作者可以具有以下状态：待定、活动、无效、暂停。这些相同的状态类型适用于已发表文章的状态。

仅对 STATUS 下的任一表使用 char() 并输入列出的 4 个状态中的任何一个是否合适，或者为每种状态类型创建一个具有 STATUS_ID 和 STATUS_type 的“STATUS”表是否更有意义，然后只需在表或未来表中使用 STATUS_ID 外键？

简单地输入 4 种类型中的任何一种都是简单的方法，但我认为它们可能是用户错误的可能性......

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:09:45.533

您可以使用`enum`字段数据类型强制一个值必须是一组预选值中的一次。在幕后 MySQL 实际上将这些值存储为整数表示以节省存储需求。

是否需要单独的桌子完全取决于您。如果您认为允许的值集需要随时间动态变化，那么这可能是有意义的（使用外键约束来强制选择其中一个值）。如果这些值实际上代表系统中的某种现实世界对象，这些对象需要有自己的属性（字段）与之关联，那么您也可以从将值放在单独的表中受益。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:09:01.547

一个单独的状态查找表是要走的路。它实际上可能会减慢您的查询速度，因为您正在添加一个连接，但规范化的好处超过了它。最大的实际好处是它使更改状态名称变得更加容易。如果您想将“待处理”更改为“处理中”，您只需更改 1 个字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:08:10.950

您是否考虑过在状态列中使用 ENUM 类型？[http://dev.mysql.com/doc/refman/5.0/en/enum.html](http://dev.mysql.com/doc/refman/5.0/en/enum.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T21:08:50.203

最直接的方法是[枚举](https://dev.mysql.com/doc/refman/5.5/en/enum.html)数据类型，第二个表也可以很好地工作，但它更复杂。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-26T21:10:45.673

如果您要经常在 WHERE 子句中使用该列，那么最好为它创建另一个表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-26T21:12:07.203

您对状态表的建议是合理的，并且是一种常见的做法。根据您用于编程的语言，枚举将是一个合适的替代方案，这有助于确保只有您定义的枚举类型保存在数据库中。

PHP：

```
abstract class STATUS
{
    const pending = 1;
    const active = 2;
    const void = 3;
    const suspended = 4;

    function GetConstants()
    {
        $rc = new ReflectionClass($this);
        return $rc->getConstants();
    }
} 
```

C＃

```
public enum CourseType
{
    pending = 1;
    active = 2;
    void = 3;
    suspended = 4;
} 
```

# javascript - 从侦听器访问标记-Google maps javascript API3.0

> ID：15647355
> 
> 赞同：0
> 
> 时间：2013-03-26T21:02:52.703
> 
> 标签：javascript, google-maps-api-3

我的地图上有几个标记（在一个数组中），每个标记都有我给它们的自定义 ID 标签。

我想要什么：当我点击一个标记时，我希望将它的 ID 添加到另一个数组中。

问题：来自谷歌的鼠标事件没有目标属性，只有位置，所以我似乎无法直接访问 ID。

我真的不想求助于使用该位置来找到最接近它的标记并以这种方式返回它的 ID，这相当复杂。

感谢所有帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:39:39.847

这真的很容易，这要归功于 JavaScript 和许多其他语言中称为闭包的功能。

只需将创建标记并设置其事件侦听器的代码放在一个函数中，然后使用该特定标记所需的数据为每个标记调用该函数。例如：

```
var places = [
    {
        id: 'one', lat: 1, lng: -1, name: 'First'
    },
    {
        id: 'two', lat: 2, lng: -2, name: 'Second'
    }
];

for( var i = 0;  i < places.length;  i++ ) {
    addPlace( places[i] );
}

function addPlace( place ) {
    var marker = new google.maps.Marker({
        map: map,
        position: new google.maps.LatLng( place.lat, place.lng ),
        title: place.name
    });
    google.maps.event.addListener( 'click', function() {
        alert( 'Clicked ' + place.id + ': ' + place.name );
    });
} 
```

我没有测试这个 Maps API 代码，但是代码的细节并不重要。重要的是要了解`place`您在代码中看到的变量。这是关键部分：该变量可以在事件侦听器内部访问，仅仅是因为事件侦听器嵌套在作为参数的`addPlace()`函数内部。`place`

请注意该代码和这样的代码之间的区别，这*不起作用*：

```
for( var i = 0;  i < places.length;  i++ ) {
    var place = places[i];
    var marker = new google.maps.Marker({
        map: map,
        position: new google.maps.LatLng( place.lat, place.lng ),
        title: place.name
    });
    google.maps.event.addListener( 'click', function() {
        alert( 'Clicked ' + place.id + ': ' + place.name );
    });
} 
```

两者之间的唯一区别是工作版本将循环体放在一个单独的函数中，该函数从循环中调用，而不是将所有代码直接放在循环中。在您每次调用的函数中拥有该代码是创建闭包的原因，这就是让内部事件侦听器函数“看到”外部函数中的变量的原因。

闭包的好处是你可以在*任何*类似的情况下使用它们。它并不特定于 Maps API 或 API 使用的对象。您甚至可能已经使用过它们并且没有意识到它，例如在这样的`setTimeout()`调用中：

```
// Display an alert 'time' milliseconds after this function is called
function slowAlert( message, time ) {
    setTimeout( function() {
        alert( message );
    }, time );
}

slowAlert( 'Howdy!', 1000 );  // Wait a second and then say Howdy! 
```

在回调函数`alert()`内部进行调用的地方，它使用函数上的闭包来获取传递给该函数的变量的值。`setTimeout()``slowAlert()``message`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:40:21.223

这应该会有所帮助。我向`customId`标记对象添加了一个属性，然后在标记`click`事件中将 id 属性分配给新数组。

```
function initialize() {
    var map;
    var centerPosition = new google.maps.LatLng(38.713107, -90.42984);
    var options = {
        zoom: 6,
        center: centerPosition,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var bounds = new google.maps.LatLngBounds();
    map = new google.maps.Map($('#map')[0], options);
    var infoWindow = new google.maps.InfoWindow();
    //marker array
    var markers = [];
    //sencondary array to store markers that were clicked on.
    var markerIdArray = [];

    for (i = 0; i < 6; i++) {
        var lat = 38.713107 + Math.random();
        var lng = -90.42984 + Math.random();
        var marker = new google.maps.Marker({
            map: map,
            position: new google.maps.LatLng(lat, lng),
            customId: i //add a custom id to the marker
        });
        bounds.extend(marker.position);

        google.maps.event.addListener(marker, 'click', function () {
            //add the id to the other array.
            markerIdArray.push(this.customId);
            //log the content of the array to the console.
            console.log(markerIdArray); 
        });
        markers.push(marker);
    }    
    map.fitBounds(bounds);
} 
```

这是一个实际的[例子。](http://jsfiddle.net/bryan_weaver/7YLtY/)

# jquery - jQuery 提要处理

> ID：15647360
> 
> 赞同：0
> 
> 时间：2013-03-26T21:03:12.820
> 
> 标签：jquery, jsonp, feed

我们正在尝试使用来自网站的提要。我们尝试了不同的方法，但都没有奏效：

方法一：尝试获取内容并手动解析

```
$.get("http://www.wwe.com/feeds/sapphire/news/all/all/0,1", {}, function(data){
  alert(data);
 }); 
```

我们总是得到一个空洞的回应。如果您将 URL 粘贴到浏览器窗口中，您会得到有效的响应 ( [http://www.wwe.com/feeds/sapphire/news/all/all/0,1](http://www.wwe.com/feeds/sapphire/news/all/all/0,1) )

方法二：使用 jsonP

我们有这个代码：

```
$.ajax({
    url: "http://www.wwe.com/feeds/sapphire/news/all/all/0,1",
    dataType: 'jsonp',
    data: {},
    error: function (jqXHR, textStatus,errorThrown) {
        console.log("error");
    },
    contentType: "application/json",
    success: function (data, textStatus, jqXHR) {
        console.log('success_function');
        console.log(data);
    }
}); 
```

服务器响应无效标签。似乎在响应中缺少回调函数。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:04:49.010

您尝试从中加载的服务似乎不支持 jsonp。如果没有这个，您将无法跨域对它进行直接的 jquery ajax 调用。

请参阅：[没有 JSONP 的 JSON 跨站](https://stackoverflow.com/questions/7077781/json-cross-site-without-jsonp)

您可以通过保持代码相同并测试支持 jsonp 的 url 来测试这一点（例如[https://api.twitter.com/1/statuses/user_timeline.json?include_entities=true&include_rts=true&screen_name=espn&count=1](https://api.twitter.com/1/statuses/user_timeline.json?include_entities=true&include_rts=true&screen_name=espn&count=1)）

唯一的选择似乎是在您的服务器上创建一个代理，以将数据传递到您的 javascript。

# variables - powershell中的动态变量和值分配

> ID：15647362
> 
> 赞同：1
> 
> 时间：2013-03-26T21:03:22.770
> 
> 标签：variables, powershell

如何在运行时声明变量并为其赋值。

*原因*：我从 sql server 获取这些变量值，这些变量值本质上是可配置的

*到目前为止我尝试过的代码*

```
 [array]$varArray = @($($ServerName),$($HostName)) 

 foreach($varname in $varArray)
        {
          $varname = "some test value"
        }

Write-Host $ServerName
Write-Host $HostName 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-26T22:23:35.123

使用动态命名变量的最简单方法是字典：

```
$vars = @{}  # create empty dictionary

# add key/value pairs to dictionary:
$vars["foo"] = 23
$vars["bar"] = "foobar"
$vars["baz"] = Get-Content C:\sample.txt 
```

另一种方法是动态声明变量：

```
$name  = "foo"
$value = "bar"

New-Variable $name $value

echo $foo 
```

或者您可以创建一个自定义对象并按照[Kyle C](https://stackoverflow.com/a/15647562/1630171)的建议添加属性。这种方法类似于字典，尽管在技术上有所不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T21:15:48.783

您可以尝试向对象添加 NoteProperty。

```
$varname | Add-Member -type NoteProperty -name TestProperty -value "some test value" -PassThru 
```

另请参阅此内容，了解您可以将成员添加到哪些类型的对象：[哪些对象适合添加成员？](https://stackoverflow.com/questions/798258/what-objects-are-suitable-for-add-member)

# html - 如何设置html按钮的大小

> ID：15647369
> 
> 赞同：1
> 
> 时间：2013-03-26T21:03:52.687
> 
> 标签：html, button, size

我有一个按钮：

```
 <a data-role="button" data-inline="true" href="gmail.html">                
                    Poczta Gmail
                </a> 
```

如何将其大小设置为页面宽度的 1/3？编辑：或者只是将其设置为 200px？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T21:07:08.667

您可以将按钮设置为 33% 的宽度。当然你需要一个比 a. 更具体的选择器。这只是一个例子。

[**小演示**](http://jsfiddle.net/fT4SW/)

**HTML：**

```
<a data-role="button" data-inline="true" href="gmail.html">                
    Poczta Gmail
</a> 
```

**CSS：**

```
a {
    width:33%;
    display:inline-block;
} 
```

**编辑（随着问题的改变）：**

如果您希望将其设置为 200px 宽度，您可以执行以下操作：

```
a {
    width:200px;
    display:inline-block;
    text-align:center;
} 
```

# java - java中的字节[]链表

> ID：15647370
> 
> 赞同：1
> 
> 时间：2013-03-26T21:03:53.600
> 
> 标签：java, arrays, list, linked-list, byte

我正在尝试创建一个包含字节数组的链表：

```
static Queue<byte[]> q = new LinkedList<byte[]>();
static byte buf[] = new byte[1024];

static void queueInit() throws IOException{
    ByteArrayInputStream bis= new ByteArrayInputStream(buf);
    DataInputStream ois= new DataInputStream(bis);

    RandomAccessFile MyFile = new RandomAccessFile ("keys", "rw");
    for(int r=0;r<90;r++){
        MyFile.seek(r*1024);
        MyFile.read(buf);
        q.add(buf);
    }
    MyFile.close();
} 
```

问题出在命令 q.add(buf);。缓冲区加载了正确的字节，但列表加载了零。有什么帮助吗？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:07:15.400

不，您`LinkedList`只会对*同一个*数组有几个引用。您只需要创建一个字节数组，然后一次又一次地从文件中读取数据。

目前尚不清楚为什么您将声明`buf`为静态变量，但您需要为列表中的每个元素创建一个*新*数组：

```
for (int r=0;r<90;r++) {
    byte[] buf = new byte[1024];
    MyFile.seek(r * 1024);
    MyFile.read(buf);
    q.add(buf);
} 
```

另请注意，您忽略了 的返回值`read()`，该值指示已读取的字节数。您可能没有完全读取 1024 字节......在这种情况下您想做什么？

（另外，为什么还要寻找，或者确实使用 a `RandomAccessFile`？如果你想读取 1K 块中的前 90K，你可以按顺序进行，根本不需要寻找。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:06:34.860

队列中的每个成员都是相同的 byte[] 数组。

当您调用 时`q.add(buf)`，您正在添加对`buf`队列的引用——而不是数组的副本。由于引用永远不会改变，因此您的队列中充满了引用的多个副本`buf`，所有副本都指向同一个数组。

文件末尾可能包含一个充满 '\0' 字节的缓冲区。

尝试将其移动到您的循环中：

```
byte buf[] = new byte[1024]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:07:01.680

您为 LinkedList 中的每个条目使用相同的数组实例。这意味着每次调用 MyFile.read(buf) 都会更改所有 LinkedList 条目的内容。您应该为要添加到链表的每个条目创建一个新的 byte[]。

# php - 返回必须从函数更新的变量，而不是返回？

> ID：15647372
> 
> 赞同：0
> 
> 时间：2013-03-26T21:03:57.197
> 
> 标签：php

有很多代码，但大部分都是无关紧要的，所以我只发布一个片段

```
$error_message = "";

function died($error) // if something is incorect, send to given url with error msg
{
    session_start();
    $_SESSION['error'] = $error;
    header("Location: http://mydomain.com/post/error.php");
    die();
} 
```

这工作正常，将用户发送到错误会话，该会话在 error.php 上显示错误

```
function fetch_post($url, $error_message) {

    $sql      = "SELECT * FROM inserted_posts WHERE name = '$name'";
    $result   = mysqli_query($con, $sql);
    $num_rows = mysqli_num_rows($result);

    if ($num_rows > 0) {
        $error_message .= $url . " already exists in the database, not added";
        return $error_message;
    }
} 
```

这也可以正常工作，检查数据库中是否存在“帖子”，如果存在，它将错误添加到变量 $error_message

```
while ($current <= $to) {

    $dom   = file_get_html($start_url . $current); // page + page number
    $posts = $dom->find('div[class=post] h2 a');

    $i = 0;
    while ($i < 8) {

        if (!empty($posts[$i])) { // check if it found anything in the link

            $post_now = 'http://www.somedomain.org' . $posts[$i]->href; // add exstension and save it

            fetch_post($post_now, &$error_message); // send it to the function
        }

        $i++;
    }

    $current++; // add one to current page number
} 
```

这是主循环，它循环我拥有的一些变量，并从外部网站获取帖子并将 URL 和 error_message 发送到函数 fetch_posts

（我把它发送了，我通过参考来做，因为我认为这是让它保持全球性的唯一方法？？？）

```
if (strlen($error_message > 0)) {
    died($error_message);
} 
```

这是循环之后的最后一个片段，如果错误消息包含任何字符，它应该将错误消息发送到函数错误，但它没有检测到任何字符？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T21:05:29.723

你要：

```
strlen($error_message) > 0 
```

不是

```
strlen($error_message > 0) 
```

此外，调用时传递引用自 5.3.0 起已被弃用，自 5.4.0 起已被删除，因此不要像这样调用您的函数：

```
fetch_post($post_now, &$error_message); 
```

您需要像这样定义它：

```
function fetch_post($url, &$error_message) {

    $sql      = "SELECT * FROM inserted_posts WHERE name = '$name'";
    $result   = mysqli_query($con, $sql);
    $num_rows = mysqli_num_rows($result);

    if ($num_rows > 0) {
        $error_message .= $url . " already exists in the database, not added";
        return $error_message;
    }
} 
```

尽管当您在循环中返回错误消息时，最好这样做：

```
$error_messages = array();

// ... while loop

if ($error = fetch_post($post_now))
{
  $error_messages[] = $error;
}

// ... end while

if (!empty($error_messages)) {
    died($error_messages); // change your function to work with an array
} 
```

# javascript - 原型 Ajax.Updater 在更新前评估字符串

> ID：15647384
> 
> 赞同：0
> 
> 时间：2013-03-26T21:04:48.100
> 
> 标签：javascript, ajax, prototypejs

这是我的代码：

```
new Ajax.Updater('container', url, {
    method: "get",
    onLoading: function () {
        document.getElementById('container').innerHTML = "Loading...";
    },
    on200: function(response) {
        if(response.responseText.match(/WhatImLookingFor/)) {
            window.location = "leNewURL";
        }
    },
    onComplete: function(response) {
        //do other cool stuff
    }
}); 
```

我想要做的是在`container`更新之前拦截响应，如果响应中的文本匹配`WhatImLookingFor`，我想将用户重定向到`leNewURL`. 上面的代码正在发生这种情况，但不是在更新之前，所以它看起来很古怪。无论如何我可以在更新发生之前拦截，还是我必须求助于其他黑客，比如隐藏`container`并只有在没有匹配的情况下才显示它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:28:27.260

如果您想像这样自定义 Ajax 调用的行为，我建议您使用基础`Ajax.Request()` [http://api.prototypejs.org/ajax/Ajax/Request/](http://api.prototypejs.org/ajax/Ajax/Request/)

```
new Ajax.Request(url, {
    method: "get",
    onLoading: function () {
        $('container').update("Loading...");
    },
    onComplete: function(response) {
        if(response.responseText.match(/WhatImLookingFor/)) {
            window.location = "leNewURL";
        }
        else {
            //do other cool stuff
            $('container').update(response.responseText);
        }
    }
}); 
```

我`document.getElementById()`用`$()`实用方法替换了它，因为它的类型更少，并且包括所有 PrototypeJS 的 Element 方法

# ruby - 为什么这里的 self 是 MyClass？

> ID：15647387
> 
> 赞同：0
> 
> 时间：2013-03-26T21:04:51.227
> 
> 标签：ruby

```
class MyClass
  def MyFun
    puts self
  end
end

mine = MyClass.new
mine.MyFun   # => #<MyClass:0x10a3ee670> 
```

由于模块、类、def 都改变了范围，这里 self 应该是 MyFun 而不是 MyClass，因为它在 def...end 中。为什么它仍然保留在 MyClass 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:08:44.857

`self`是当前上下文对象。`MyFun`不是一个对象，而是一个方法——具体来说，它是 MyClass 的一个实例方法。所以在里面`MyFun`，`self`将是正在执行的 MyClass 的实例`MyFun`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T04:47:51.173

***范围`self`：***

> *在类定义中，`self`总是它`class constants(instance of Class)`本身。（实例方法除外）。*
> 
> *在实例方法内部，`self`是该类常量的实例，它刚刚调用了相应的方法。*

```
p RUBY_VERSION

class Foo

    def self.talk
    p "here SELF is-> #{self}"
    end

    def display
    p "here SELF is-> #{self}"
    end

    p "here SELF is-> #{self}"

end
Foo.talk
foo = Foo.new
foo.display
class << foo
p "here SELF is-> #{self}"
end 
```

*输出：*

```
"2.0.0"
"here SELF is-> Foo"
"here SELF is-> Foo"
"here SELF is-> #<Foo:0x1fc7fa0>"
"here SELF is-> #<Class:#<Foo:0x1fc7fa0>>" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:11:41.897

在您的示例`MyFun`中是一个实例方法，`self`实际上也是一个`MyClass`.

*返回的东西* `mine.MyFun`实际上是实例文字。如果它是一个类文字，那将是 jsut plainly `MyClass`。自己测试一下

```
class Example
  def asdf
    self
  end
end

Example.new.asdf.class #=> Example 
```

# jquery - 按文本选择选项

> ID：15647390
> 
> 赞同：0
> 
> 时间：2013-03-26T21:04:59.377
> 
> 标签：jquery

我无法将我的选择设置为通过 ajax 传入的一些默认值

这是一个小提琴：http: [//jsfiddle.net/helto/wycLZ/](http://jsfiddle.net/helto/wycLZ/)

这是代码：

HTML：

```
<div>
<label id="conditionLabel" for="condition">Condition:</label>
<select id="condition">
    <option selected="true" style="display:none;">Choose</option>
</select>
</div> 
```

JS：

```
var conditions = [{
id: 1,
name: "New"
}, {
id: 2,
name: "Good"
}, {
id: 3,
name: "Poor"
}];
$.each(conditions, function (key, value) {
var cond = '<option value="' + value.id + '">' + value.name + '</option>';
$('#condition').append(cond);
});

$('#condition option[text="New"]').attr('selected', 'selected'); 
```

最后一行给我带来了麻烦，我想根据文本选择选项

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T21:09:45.137

你可以使用`:contains`：

```
$('#condition option:contains("New")').prop('selected', true); 
```

或者`.filter()`：

```
$('#condition option').filter(function() {
    return this.text === 'New';
}).prop('selected', true); 
```

`:contains`也会匹配`News`，所以我会选择`.filter()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:13:37.623

您应该使用`$('#condition option:contains("New")').prop('selected', true);`哪个利用[jQuery 的 :contains() 选择器](http://api.jquery.com/contains-selector/)

这是一个**[jsFiddle 演示](http://jsfiddle.net/wycLZ/2/)**

# django - django 用户身份验证，应该使用管理员还是从视图中创建？

> ID：15647394
> 
> 赞同：0
> 
> 时间：2013-03-26T21:05:05.250
> 
> 标签：django, authentication, django-admin, django-views

我对 Django 完全陌生。我已经完成了所有教程，现在想创建一个简单的用户身份验证，以便能够访问我网站中的页面。

我的问题是我是否应该使用管理员身份验证？或者我应该使用用户名和密码创建自己的客户视图并使用 DJango 身份验证 API？

澄清一下，我有一个想要保护的页面，并且只有在用户有权查看它时才能查看。这是在内置的 Django 管理员中做的合理的事情吗？似乎 Django 管理员是为了授予创建与应用程序模型相关的新记录的权限。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T02:50:34.750

我更喜欢使用 Django 的内置身份验证系统。假设您想使用手机号码和推特句柄创建自己的客户模型，您可以通过以下方式扩展 Django 的用户模型

```
from django.contrib.auth.models import User

class Customer(User):
    mobile = models.CharField(max_length=12)
    twitter = models.CharField(max_length=100) 
```

在这种情况下，您不仅会从 Django 的用户模型中继承电子邮件、用户名等属性，而且还会添加可以存储在数据库中的自定义属性。

保护页面最简单的方法是使用[login_required](https://docs.djangoproject.com/en/1.2/topics/auth/#the-login-required-decorator)装饰器。在保护您的页面时还要注意包含正确的 URL，以确保您已包含 Django 的登录和注销 URL

# asp.net - 文件夹权限 IIS 7 服务器。拒绝访问 Web 浏览器的文件夹

> ID：15647415
> 
> 赞同：0
> 
> 时间：2013-03-26T21:06:36.860
> 
> 标签：asp.net, iis-7, permissions, directory

我是服务器新手，我想问一个简单的问题。

我有一个网站（aspx），其中有一个存储图像的文件夹。

手机通过 http 客户端（通用处理程序）连接并可以从文件夹下载图像，但我想拒绝 Web 浏览器访问此文件夹，因此无法看到图像。

我怎么能这样做？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:31:24.667

我想你可以使用这样的东西

```
<configuration>
<location path="MySubDirectory">
    <system.web>
        <authorization>
            <deny users="*"/> <!-- Denies all users -->
        </authorization>
    </system.web>
</location> 
```

# java - 使用 Mockito 创建新类的实例时如何模拟异常

> ID：15647418
> 
> 赞同：8
> 
> 时间：2013-03-26T21:06:45.807
> 
> 标签：java, junit, mocking, mockito

在一个方法中，我有一个要模拟的异常被捕获。

我知道如何使用 mock.doSomething() 模拟对象以引发异常，但是当类创建自身的新实例时，我需要引发远程异常。

```
transient Bicycle bike = null;

public Bicycle getBicycle() {
    if (bike == null) {
        try {
            bike = new Bicycle(this);
        } catch (RemoteException ex) {
            System.out.println("No bikes found");
        }
    }
    return bike;
} 
```

我希望能够模拟 try 块中的所有内容，但我不明白您如何模拟新类的创建，具体如下：

```
bike = new Bicycle(this); 
```

我尝试了许多不同的 Mockito 测试，例如：

```
Bicycle b = mock(Bicycle.class);
Mockito.doThrow(new RemoteException()).when(b = new Bicycle()); 
```

虽然我理解这将不会起作用，但我想做类似的事情。

我已经阅读了 Mockito 文档并没有发现任何有用的东西：

[http://site.mockito.org/mockito/docs/current/org/mockito/Mockito.html](http://site.mockito.org/mockito/docs/current/org/mockito/Mockito.html)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-26T21:12:45.673

您通常不会模拟构造函数。您*可以使用*[PowerMock](https://code.google.com/p/powermock/)之类的工具，但我通常建议您不要这样做。

目前，如果您想控制`Bicycle`构建新代码时发生的情况，您的代码实际上是不可测试的。构造一个`Bicycle`实际上是一个复杂的操作吗？也许你想要一个`BicycleFactory`，例如，它可以作为依赖项传递到你的类中 -*然后*你可以模拟`BicycleFactory.createBicycle`或任何你称之为的东西。

构造函数就像静态方法——当你使用它们时，你会紧紧地绑定到你正在调用的特定代码；如果没有像 PowerMock 这样的方法，就没有干净的方法来注入其他行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-27T11:56:53.443

在这种情况下，您可以使用 Mockito 扩展 PowerMock。它允许模拟构造函数（参见[https://code.google.com/p/powermock/wiki/MockConstructor](https://code.google.com/p/powermock/wiki/MockConstructor)）。

在这种情况下，您将编写类似于以下测试的内容：

```
@RunWith(PowerMockRunner.class)
@PrepareForTest({ClassUnderTest.class, Bicycle.class})
public class ConstructorMockingTest
{
    @Test
    public void getBicycle()
    {
        ClassUnderTest tested = new ClassUnderTest();
        whenNew(Bicycle.class).withArguments(tested).thenThrow(new RemoteException());

        Bicycle bicycle = tested.getBicycle();

        assertNull(bicycle);
    }
} 
```

更多示例可在以下位置找到：[https ://code.google.com/p/powermock/source/browse/trunk/modules/module-test/mockito/junit4/src/test/java/samples/powermockito/junit4/whennew /WhenNewTest.java](https://code.google.com/p/powermock/source/browse/trunk/modules/module-test/mockito/junit4/src/test/java/samples/powermockito/junit4/whennew/WhenNewTest.java)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T23:29:27.607

你`getBicycle()`现在至少做了两件事。它检索（“获取”） a `Bicycle`，并创建一个`Bicycle`. 理想情况下，一个方法或类应该只做一件事，并且做得很好。

将对象的创建放在单独的方法中`createBicycle()`或单独`BicycleFactory`并模拟它。

# c# - MonoDevelop 编译 ac# 代码时出现 System.ArgumentNullException 错误

> ID：15647421
> 
> 赞同：0
> 
> 时间：2013-03-26T21:07:00.147
> 
> 标签：c#, monodevelop

我还有一个简单的问题。我有一个编写为 .cs 文件的 C# 程序。MonoDevelop（由 Xamarin 改进）设法构建了这个项目。但是，当我尝试运行它时，出现错误：

```
System.ArgumentNullException: Argument cannot be null.
Parameter name: s
  at System.Double.Parse (System.String s, NumberStyles style, IFormatProvider provider)[0x00012] in /private/tmp/monobuild/build/BUILD/mono- 2.10.9/mcs/class/corlib/System/Double.cs:229
  at System.Double.Parse (System.String s) [0x00000] in /private/tmp/monobuild/build/BUILD/mono-2.10.9/mcs/class/corlib/System/Double.cs:200
  at SampleNamespace.SampleClass.Main () [0x00049] in /Users/ninakuklisova/ThoughtWorks/Sales Taxes with inputs.cs:42 
```

它指向以下代码行：

```
values[ItemNumber,2] = Double.Parse(quant); 
```

我觉得神秘的是，我的 Mac 上没有 /private/tmp/monobuild/build/BUILD/mono-2.10.9/mcs/class/corlib/System/ 文件夹，当我在在线编译器上编译这段代码时，所有顺利。你知道有什么问题吗？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:10:23.897

1.  该文件夹可能存在于编译单声道的人的机器上。

2.  检查是否`quant`为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T23:29:33.487

是的，就是这么简单：只是不要在第 1 列之前提及第 2 列。我想大多数人无论如何都不会这样做。

# ios - 没有通知中心的 iOS 虚拟键盘大小

> ID：15647422
> 
> 赞同：4
> 
> 时间：2013-03-26T21:07:01.340
> 
> 标签：ios, objective-c, nsnotificationcenter, virtual-keyboard

当点击虚拟键盘下方的 textFiewl 时，我需要向上滚动我的滚动视图。我打电话`[self.scrollView setContentOffset:scrollPoint animated:YES];`。要获得屏幕的可见区域，我显然需要 KB 大小。

我熟悉

```
NSDictionary *info = [notification userInfo];

CGSize kbSize = [self.view convertRect:
                 [info[UIKeyboardFrameBeginUserInfoKey] CGRectValue]
                              fromView:nil].size; 
```

但是，它对我不起作用，因为当用户点击可能半隐藏的文本字段时，我没有收到键盘通知。

所以我调用了 in 中的方法`textFieldDidBeginEditing:`，该方法在键盘发送消息之前调用，所以我不知道第一次点击时的 KB 大小。

所以问题是：是否可以在不调用相应通知的情况下获得 KB 大小？以编程方式，而不是硬编码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T21:37:39.360

**你这样做是不对的。**

您还需要收听键盘显示/隐藏通知，然后调整您的屏幕。

这是一个示例骨架代码：

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    NSNotificationCenter *nc = [NSNotificationCenter defaultCenter];
    [nc addObserver:self selector:@selector(keyboardChangedStatus:) name:UIKeyboardWillShowNotification object:nil];
    [nc addObserver:self selector:@selector(keyboardChangedStatus:) name:UIKeyboardWillHideNotification object:nil];
}

- (void)viewWillDisappear:(BOOL)animated {
    [super viewWillDisappear:animated];

    NSNotificationCenter *nc = [NSNotificationCenter defaultCenter];
    [nc removeObserver:self name:UIKeyboardWillShowNotification object:nil];
    [nc removeObserver:self name:UIKeyboardWillHideNotification object:nil];
}

#pragma mark - Get Keyboard size

- (void)keyboardChangedStatus:(NSNotification*)notification {
    //get the size!
    CGRect keyboardRect;
    [[[notification userInfo] objectForKey:UIKeyboardFrameEndUserInfoKey] getValue:&keyboardRect];
    keyboardHeight = keyboardRect.size.height;
    //move your view to the top, to display the textfield..
    [self moveView:notification keyboardHeight:keyboardHeight];
}

#pragma mark View Moving

- (void)moveView:(NSNotification *) notification keyboardHeight:(int)height{
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.3];
    [UIView setAnimationBeginsFromCurrentState:YES];

    CGRect rect = self.view.frame;

    if ([[notification name] isEqual:UIKeyboardWillHideNotification]) {
        // revert back to the normal state.
        rect.origin.y = 0;
        hasScrolledToTop = YES;
    } 
    else {
        // 1\. move the view's origin up so that the text field that will be hidden come above the keyboard (you need to adjust the value here)
        rect.origin.y = -height;
    }

    self.view.frame = rect;

    [UIView commitAnimations];
} 
```

# php - 处理为一行插入的多个字段

> ID：15647424
> 
> 赞同：0
> 
> 时间：2013-03-26T21:07:04.023
> 
> 标签：php, html, mysql, codeigniter

我有一个看起来像这样的表格：

```
<form method='post' action='post.php'>
   <span>
      <input type='text' name='ingredientQTY'/>
      <select name='selectTYPE'>
        <option value='1' name='1'>BLAH</option>
        <option value='2' name='2'>BLAH2</option>
        <option value='2' name='3'>BLAH3</option>
      </select>
      <input type='text' name='ingredientNAME'/>
   </span>
</form> 
```

我在侧面有一个脚本可以克隆跨度并将克隆添加到页面，所以我可以像上面那样拥有**n**个跨度。我有一个名为**成分**的数据库，如下所示：

第 1 行：成分数量 - 由跨度中的第一个输入填充第 2 行：成分类型 - 由跨度中的选择/下拉列表的值填充第 3 行：成分名称 - 由跨度中的最后一个输入填充

因此，每个跨度的字段都会更新单个表行中的 1 列。但是我可以有**n**行需要插入，对应于通过 jQuery 添加的跨度数。

如何使用 PHP 构建它？我正在寻找一个更具概念性的答案（我并不是说要有人来构建它），但是示例会很好。

感谢所有帮助，如果这个问题有任何令人困惑的地方，请问！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:13:34.600

如果您使用 PHP 处理表单，您可以创建如下字段名：

`<input type="text" name="ingredientQTY[]" />`或者`<select name="selectTYPE[]">`

这些名称是可循环的，如下所示：

```
foreach($_POST['ingredientQTY'] as $key => $value) {
  $qty = $_POST['ingredientQTY'][$key]; // or $value
  $type = $_POST['selectTYPE'][$key];
  $name = $_POST['ingredientNAME'][$key];
} 
```

我想这就是你的意思。

# ruby-on-rails - 多个文件上传选项产生错误轨道

> ID：15647430
> 
> 赞同：2
> 
> 时间：2013-03-26T21:07:17.897
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activerecord, ruby-on-rails-3.2

当我在我的视图中添加选项时，它会在提交表单时产生`:multiple => true`错误。为什么会这样，我该如何解决？`f.file_field :picture,``can't convert nil into String`

**全跟踪**

```
carrierwave (0.8.0) lib/carrierwave/uploader/cache.rb:159:in `join'
carrierwave (0.8.0) lib/carrierwave/uploader/cache.rb:159:in `cache_path'
carrierwave (0.8.0) lib/carrierwave/uploader/cache.rb:131:in `cache!'
carrierwave (0.8.0) lib/carrierwave/uploader/callbacks.rb:17:in `with_callbacks'
carrierwave (0.8.0) lib/carrierwave/uploader/cache.rb:122:in `cache!'
carrierwave (0.8.0) lib/carrierwave/mount.rb:327:in `cache'
carrierwave (0.8.0) lib/carrierwave/mount.rb:179:in `picture='
carrierwave (0.8.0) lib/carrierwave/orm/activerecord.rb:38:in `picture='
activerecord (3.2.11) lib/active_record/attribute_assignment.rb:85:in `send'
activerecord (3.2.11) lib/active_record/attribute_assignment.rb:85:in `assign_attributes'
activerecord (3.2.11) lib/active_record/attribute_assignment.rb:78:in `each'
activerecord (3.2.11) lib/active_record/attribute_assignment.rb:78:in `assign_attributes'
activerecord (3.2.11) lib/active_record/base.rb:497:in `initialize'
activerecord (3.2.11) lib/active_record/reflection.rb:183:in `new'
activerecord (3.2.11) lib/active_record/reflection.rb:183:in `build_association'
activerecord (3.2.11) lib/active_record/associations/association.rb:233:in `build_record'
activerecord (3.2.11) lib/active_record/associations/collection_association.rb:112:in `build'
activerecord (3.2.11) lib/active_record/associations/collection_proxy.rb:46:in `__send__'
activerecord (3.2.11) lib/active_record/associations/collection_proxy.rb:46:in `new'
app/controllers/admin/images_controller.rb:17:in `create'
actionpack (3.2.11) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.11) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.11) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.2.11) lib/abstract_controller/callbacks.rb:18:in `process_action'
activesupport (3.2.11) lib/active_support/callbacks.rb:425:in `_run__164786065__process_action__352915844__callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `send'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `send'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.11) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
activesupport (3.2.11) lib/active_support/notifications.rb:123:in `instrument'
activesupport (3.2.11) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.11) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
activerecord (3.2.11) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.11) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.11) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.11) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.11) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.11) lib/action_controller/metal.rb:246:in `action'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:36:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:601:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.5) lib/rack/etag.rb:23:in `call'
rack (1.4.5) lib/rack/conditionalget.rb:35:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.5) lib/rack/session/abstract/id.rb:210:in `context'
rack (1.4.5) lib/rack/session/abstract/id.rb:205:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/cookies.rb:341:in `call'
activerecord (3.2.11) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.11) lib/active_record/connection_adapters/abstract/connection_pool.rb:479:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:28:in `call'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `_run__1862416574__call__4__callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `send'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `send'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.11) lib/rails/rack/logger.rb:32:in `call_app'
railties (3.2.11) lib/rails/rack/logger.rb:16:in `call'
activesupport (3.2.11) lib/active_support/tagged_logging.rb:22:in `tagged'
railties (3.2.11) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.5) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.5) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.11) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.5) lib/rack/lock.rb:15:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.11) lib/rails/engine.rb:479:in `call'
railties (3.2.11) lib/rails/application.rb:223:in `call'
rack (1.4.5) lib/rack/content_length.rb:14:in `call'
railties (3.2.11) lib/rails/rack/log_tailer.rb:17:in `call'
rack (1.4.5) lib/rack/handler/webrick.rb:59:in `service'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:162:in `start'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:95:in `start'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:92:in `each'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:92:in `start'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:23:in `start'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:82:in `start'
rack (1.4.5) lib/rack/handler/webrick.rb:13:in `run'
rack (1.4.5) lib/rack/server.rb:268:in `start'
railties (3.2.11) lib/rails/commands/server.rb:70:in `start'
railties (3.2.11) lib/rails/commands.rb:55
railties (3.2.11) lib/rails/commands.rb:50:in `tap'
railties (3.2.11) lib/rails/commands.rb:50
script/rails:6:in `require'
script/rails:6 
```

**完全错误**

```
TypeError in Admin::ImagesController#create

can't convert nil into String
Rails.root: /Users/derek_duncan/Documents/Websites/Bud Beverly Photography/admin

Application Trace | Framework Trace | Full Trace
carrierwave (0.8.0) lib/carrierwave/uploader/cache.rb:159:in `join'
carrierwave (0.8.0) lib/carrierwave/uploader/cache.rb:159:in `cache_path'
carrierwave (0.8.0) lib/carrierwave/uploader/cache.rb:131:in `cache!'
carrierwave (0.8.0) lib/carrierwave/uploader/callbacks.rb:17:in `with_callbacks'
carrierwave (0.8.0) lib/carrierwave/uploader/cache.rb:122:in `cache!'
carrierwave (0.8.0) lib/carrierwave/mount.rb:327:in `cache'
carrierwave (0.8.0) lib/carrierwave/mount.rb:179:in `picture='
carrierwave (0.8.0) lib/carrierwave/orm/activerecord.rb:38:in `picture='
activerecord (3.2.11) lib/active_record/attribute_assignment.rb:85:in `send'
activerecord (3.2.11) lib/active_record/attribute_assignment.rb:85:in `assign_attributes'
activerecord (3.2.11) lib/active_record/attribute_assignment.rb:78:in `each'
activerecord (3.2.11) lib/active_record/attribute_assignment.rb:78:in `assign_attributes'
activerecord (3.2.11) lib/active_record/base.rb:497:in `initialize'
activerecord (3.2.11) lib/active_record/reflection.rb:183:in `new'
activerecord (3.2.11) lib/active_record/reflection.rb:183:in `build_association'
activerecord (3.2.11) lib/active_record/associations/association.rb:233:in `build_record'
activerecord (3.2.11) lib/active_record/associations/collection_association.rb:112:in `build'
activerecord (3.2.11) lib/active_record/associations/collection_proxy.rb:46:in `__send__'
activerecord (3.2.11) lib/active_record/associations/collection_proxy.rb:46:in `new'
app/controllers/admin/images_controller.rb:17:in `create'
actionpack (3.2.11) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.11) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.11) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.2.11) lib/abstract_controller/callbacks.rb:18:in `process_action'
activesupport (3.2.11) lib/active_support/callbacks.rb:425:in `_run__164786065__process_action__352915844__callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `send'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `send'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.11) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:30:in `process_action'
activesupport (3.2.11) lib/active_support/notifications.rb:123:in `instrument'
activesupport (3.2.11) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.11) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
activerecord (3.2.11) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.11) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.11) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.11) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.11) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.11) lib/action_controller/metal.rb:246:in `action'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:36:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:601:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.5) lib/rack/etag.rb:23:in `call'
rack (1.4.5) lib/rack/conditionalget.rb:35:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.5) lib/rack/session/abstract/id.rb:210:in `context'
rack (1.4.5) lib/rack/session/abstract/id.rb:205:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/cookies.rb:341:in `call'
activerecord (3.2.11) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.11) lib/active_record/connection_adapters/abstract/connection_pool.rb:479:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:28:in `call'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `_run__1862416574__call__4__callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `send'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `send'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.11) lib/rails/rack/logger.rb:32:in `call_app'
railties (3.2.11) lib/rails/rack/logger.rb:16:in `call'
activesupport (3.2.11) lib/active_support/tagged_logging.rb:22:in `tagged'
railties (3.2.11) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.5) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.5) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.11) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.5) lib/rack/lock.rb:15:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.11) lib/rails/engine.rb:479:in `call'
railties (3.2.11) lib/rails/application.rb:223:in `call'
rack (1.4.5) lib/rack/content_length.rb:14:in `call'
railties (3.2.11) lib/rails/rack/log_tailer.rb:17:in `call'
rack (1.4.5) lib/rack/handler/webrick.rb:59:in `service'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:162:in `start'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:95:in `start'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:92:in `each'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:92:in `start'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:23:in `start'
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:82:in `start'
rack (1.4.5) lib/rack/handler/webrick.rb:13:in `run'
rack (1.4.5) lib/rack/server.rb:268:in `start'
railties (3.2.11) lib/rails/commands/server.rb:70:in `start'
railties (3.2.11) lib/rails/commands.rb:55
railties (3.2.11) lib/rails/commands.rb:50:in `tap'
railties (3.2.11) lib/rails/commands.rb:50
script/rails:6:in `require'
script/rails:6
Request

Parameters:

{"image"=>{"picture"=>[#<ActionDispatch::Http::UploadedFile:0x10ee93248 @tempfile=#<File:/var/folders/bx/6z1z5yks56j40v15n43tjh1c0000gn/T/RackMultipart20130326-11396-8ebtao-0>,
 @headers="Content-Disposition: form-data; name=\"image[picture][]\"; filename=\"IMG_0106.JPG\"\r\nContent-Type: image/jpeg\r\n",
 @content_type="image/jpeg",
 @original_filename="IMG_0106.JPG">,
 #<ActionDispatch::Http::UploadedFile:0x10ee93220 @tempfile=#<File:/var/folders/bx/6z1z5yks56j40v15n43tjh1c0000gn/T/RackMultipart20130326-11396-1d1ltko-0>,
 @headers="Content-Disposition: form-data; name=\"image[picture][]\"; filename=\"Screen Shot 2013-03-06 at 4.16.27 PM.png\"\r\nContent-Type: image/png\r\n",
 @content_type="image/png",
 @original_filename="Screen Shot 2013-03-06 at 4.16.27 PM.png">],
 "description"=>"dfas",
 "album_id"=>"10",
 "albumcover"=>"false",
 "title"=>"dfsa",
 "image_id"=>"id"},
 "commit"=>"Create Image",
 "authenticity_token"=>"O9/iRhRJozks9ZE/LXfbDDZQa2/vEFcigu7Edkn3bWY=",
 "album_id"=>"10",
 "utf8"=>"✓"}
Show session dump

Show env dump

Response

Headers:

None 
```

**控制器**

```
class Admin::ImagesController < ApplicationController
    respond_to :html, :json
    def index
        @album = Album.find(params[:album_id])
        @images = @album.images.all
    end
    # def new
    #   @album = Album.find(params[:album_id])
    #   @image = @album.images.new
    # end
    def new
        @album = Album.find(params[:album_id])
            @image = @album.images.new
    end
    def create
        @album = Album.find(params[:album_id])
        @image = @album.images.new(params[:image])

        if @image.save
            flash[:notice] = "Successfully added image!"
            redirect_to [:admin, @album, :images]
        else
            render :action => 'new'
        end
    end
    def show
        @album = Album.find(params[:album_id])
        @image = @album.images.find(params[:id])
    end
    def edit
        @album = Album.find(params[:album_id])
        @image = @album.images.find(params[:id])
    end
    def update
        @album = Album.find(params[:album_id])
        @image = @album.images.find(params[:id])
        if @image.update_attributes(params[:image])
            flash[:notice] = "Successfully updated Image"
            redirect_to [:admin, @album, :images]
        else
            render :action => "edit"
        end
    end
    def destroy
        @album = Album.find(params[:album_id])
        @image = @album.images.find(params[:id])
        @image.destroy
        @albumid = @album.id
        @id = @image.id
        FileUtils.remove_dir("#{Rails.root}/public/uploads/image/picture/#{@albumid}/#{@id}", :force => true)
        redirect_to admin_album_images_path(@album)
    end

end 
```

**模型**

```
class Image < ActiveRecord::Base
    attr_accessible :title, :description, :picture, :image_id, :album_id, :albumcover
    belongs_to :album
    accepts_nested_attributes_for :album
    mount_uploader :picture, PictureUploader 
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T20:31:42.910

这是我的设置，通过将数组拆分为单独的字符串并将每个字符串发送到新对象来解决此错误。

**控制器**

```
def create
        params[:image][:picture].each do |image|  //The :image is the object and the :picture is a row inside the :image where all files are being sent from the form.
            @album = Album.find(params[:album_id])
            @params = {}
            @params['picture'] = image
            @image = @album.images.create(@params)
       end
        if @image.save
            if params[:image][:picture].size > 1
                flash[:notice] = "Successfully added images!"
            else
                flash[:notice] = "Successfully added image!"
            end
            redirect_to [:admin, @album, :images]
        else
            render "new"
            flash[:notice] = "Did not successfully add image :("
        end
    end 
```

**查看表格**

```
<%= form_for([:admin, :album, @image], :html => {:multipart => true}) do |f| %>
        <%= f.hidden_field :album_id, :value => @album.id %>
        <%= f.hidden_field :albumcover, :value => false %>
        <%= f.file_field :picture, :multiple => true %>
        <%= f.submit "Submit", :class => "submit" %>
<% end %> 
```

# javascript - 仅在特定 url 中执行 javascript

> ID：15647436
> 
> 赞同：2
> 
> 时间：2013-03-26T21:07:35.037
> 
> 标签：javascript

我在这段代码中有一个外部 JS 文件：

```
var mobile_number_param = document.getElementById('mobile_number_param');
mobile_number_param.maxLength = 9;
mobile_number_param.readOnly = true;
var email = document.getElementById('email');
email.readOnly = true;
var user_notes = document.getElementById('user_notes');
user_notes.maxLength = 90;
var admin_notes = document.getElementById('admin_notes');
admin_notes.maxLength = 90; 
```

现在我的目标是应用与“mobile_number_param”相关的代码，但仅当我在“reserve.php”页面上时，否则我不允许在其他区域修改我的手机号码，例如我的个人资料页面。

有人告诉我这个：

* * *

您可以通过检查 window.location.href 来识别当前 url，例如搜索 reserve.php 以了解您在预订页面上。然后应用您的代码。

* * *

不幸的是，我不是编码员，也不知道该怎么做。

有什么建议么 ？感谢您的时间...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T21:08:52.437

```
if (window.location.href.indexOf('reserve.php') != -1) {
    // do stuff for reserve.php page here
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T21:22:30.877

Just add the following function in your external JS File:

```
 function myFunction(pagename) {
        var pageurl = window.location.href;
        var pg = pageurl.split("/"); /*SPLITS THE URL ACCORDING TO DELIMINATOR "/". Eg x/y/z/reserve.php pg[0]=x,..pg[3]=reserve.php*/
        var pgname = (pg[pg.length - 1]);
        if (pagename == pgname) /*check whether the current page is reserve.php or not*/
        {
            return true;
        }
        return false;
    } 
```

**Calling the Function**:

```
if (myFunction("reserve.php")) {
    /*Yes reserve.php page*/
} else {
    /*Not reserve.php page*/
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-26T21:22:21.030

Server sided you could read the HTTP referer field. If it contains reserve.php include the one js else an other js.

If you prefer to use only one js you could wrap the fucionality into a function. called from reserve.php with parameter 1, from other pages parameter 0

or else.

# java - 哈希图中的indexFor？

> ID：15647437
> 
> 赞同：4
> 
> 时间：2013-03-26T21:07:40.507
> 
> 标签：java, hashmap

只是想`Java HashMap`通过查看代码来了解它的工作原理。添加元素时，会发生以下情况：

1.  得到了密钥的哈希码
2.  对结果应用哈希函数
3.  indexFor 方法应用于 2 的结果。这给出了相应存储桶中的第一个条目。然后迭代桶中的链表 - 找到末尾并添加元素。

[indexO](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/HashMap.java#HashMap.indexFor%28int,int%29) f的实现是：

```
int indexOf(int h, int length) {
     return h & (length-1);
} 
```

我无法理解 indexOf 方法中的技巧。谁能解释一下？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-26T21:12:42.573

这是因为 Java`HashMaps`总是有一个容量，即桶的数量，是 2 的幂。让我们使用 256 的容量，即 0x100，但它可以使用 2 的任何幂。从 2 的幂中减去 1 产生需要的确切位掩码按位和哈希来获得正确的桶索引，范围`0`为`length - 1`.

```
256 - 1 = 255
0x100 - 0x1 = 0xFF 
```

例如，257 (0x101) 的哈希值与 0xFF 进行按位与运算，得到存储桶编号 1。

# ember.js - 为什么我会在 ember 中看到“加载路线时出错”？

> ID：15647439
> 
> 赞同：0
> 
> 时间：2013-03-26T21:07:41.670
> 
> 标签：ember.js, ember-data

ember rc1，ember-data rev 12。我所有其他路由都正确加载，不确定为什么我会看到这个错误。当我尝试访问显示路线即 /files/groups/5 时会发生这种情况。索引路线呈现良好。

我在下面粘贴了堆栈跟踪，但信息量不是很大。我在这里做的事情基本上是错的吗？

我的路线/控制器设置如下：

```
this.resource('files', { path : '/files' }, function() {      
  this.resource('groups', { path : '/groups' }, function() {      
    this.route('show', { path : '/:asset_link_group_id' });      
  });
});

AssetLinksApp.GroupsShowController = Ember.ArrayController.extend({
  content : Ember.A(),
  assetLinkGroup : null
});

AssetLinksApp.GroupsShowRoute = AssetLinksApp.AuthRequiredRoute.extend({
  setupController : function(controller,model) {    
  controller.set('content',model.get('asset_links'));
  controller.set('assetLinkGroup',model);
  },
  model : function(params) {    
    return AssetLinksApp.AssetLinkGroup.find(params.asset_link_group_id);
  }
}); 
```

堆栈跟踪：

> 加载路由时出错：TypeError {} exchange_vendor.js:12078
> 
> （匿名函数） exchange_vendor.js:12078 Ember.Router.reopenClass.defaultFailureHandler.setup exchange_vendor.js:35011 失败 exchange_vendor.js:34448 objects.concat.context exchange_vendor.js:34497 invokeCallback exchange_vendor.js:17846 Promise.then exchange_vendor。 js:17893 EventTarget.trigger exchange_vendor.js:17822 结果 exchange_vendor.js:17924 RunLoop._prev exchange_vendor.js:15911 Ember.handleErrors exchange_vendor.js:12140 调用 exchange_vendor.js:15909 iter exchange_vendor.js:15981 RunLoop.flush exchange_vendor。 js:16035 RunLoop.end exchange_vendor.js:15940 tryable exchange_vendor.js:16143 Ember.tryFinally exchange_vendor.js:12831 Ember.run.end exchange_vendor.js:16146 Ember.tryFinally exchange_vendor.js:12833 Ember.run exchange_vendor.js： 16102 Ember.HashLocation.Ember.Object.extend。onUpdateURL exchange_vendor.js:36690 jQuery.event.dispatch exchange_vendor.js:3144 jQuery.event.add.elemData.handle.eventHandle

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T09:56:03.903

该模型返回一条记录。但是，您已经定义了一个`ArrayController`.

Ember.js 会自动将模型放在控制器的 content 属性中，这将导致错误，因为它会将单个记录放入数组控制器中。

即使你覆盖了`setupController`, 在它触发之前，Ember.js 还是会将模型放置在控制器中。目前没有办法阻止这种情况。

* * *

### 2014 年 6 月 3 日更新（Ember > 1.0）：

如果您现在覆盖`setupController`Ember，则不再设置该`model`属性。

* * *

我能想到的唯一解决方案是向您的路线添加资源：

```
this.resource('files', { path : '/files' }, function() {      
  this.resource('groups', { path : '/groups' }, function() {      
    this.resource('group', { path : '/:asset_link_group_id' }, function() {
      this.route('index');
    });      
   });
}); 
```

这意味着您有一个`GroupController`包含组的对象控制器 ( ) 和一个`GroupIndexController`包含资产链接数组的数组控制器 ( )。

```
AssetLinksApp.GroupIndexController = Ember.ArrayController.extend({
  assetLinkGroup : null
});

AssetLinksApp.GroupIndexRoute = AssetLinksApp.AuthRequiredRoute.extend({
  setupController : function(controller,model) {    
    controller.set('content',model);
    controller.set('assetLinkGroup', this.modelFor('group'));
  },
  model : function(params) {    
    return this.modelFor('group').get('asset_links');
  }
}); 
```

现在你的模板应该被命名`group/index`而不是`groups/show`. 至于`group`模板，它可以是一个包含`{{outlet}}`.

最需要注意的是：如果你的控制器是一个对象控制器，你**必须**从模型钩子返回一个对象，如果你的控制器是一个数组控制器，那么你**必须**从模型钩子返回一个数组。

好的一面是，这会促使你遵循我和核心团队认为更好的某种设计。

# javascript - 通过 Ajax 将页面加载到 Div 最佳实践中？

> ID：15647446
> 
> 赞同：9
> 
> 时间：2013-03-26T21:08:00.777
> 
> 标签：javascript, jquery, ajax

我正在使用下面的方法将远程页面加载到页面上的 div 中。

```
$('#result').load('www.myurl.com/results.html'); 
```

我很好奇，在另一个页面中加载完全格式化的 HTML 页面是一种不好的做法吗？我更关心的是加载 css 或附加的 javascript 包括可能会覆盖主页上的其他元素。

我在最初的测试中没有遇到任何问题，我只是不确定这是否是最佳实践。

澄清：如果我有这样的主页

```
<html>
    <head>
       <script src="jquery.js"></script>
       <link href="mycss.css" rel="stylesheet" type="text/css">
    </head>
    <body>
       <div id="remoteContainer"></div>
       <script>
          $('#remoteContainer').load('www.myurl.com/results.html');
       </script>
    </body> 
```

结果.html 代码如下所示：

```
<html>
    <head>
       <script src="jquery.js"></script>
       <link href="myResults.css" rel="stylesheet" type="text/css">
    </head>
    <body>
       <header>        
           <h1>My Results Page</h1>
       </header>
       ...
    </body> 
```

CSS 和 JS 会相互覆盖，还是页面会作为两个独立的实体运行？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-26T21:12:17.437

这将正常工作，浏览器将正确处理它。来自[jQuery 文档](http://api.jquery.com/load/)：

> ...浏览器通常会从文档中过滤元素，例如`<html>`、`<title>`或`<head>`元素。因此，通过 .load() 检索到的元素可能与浏览器直接检索到的文档不完全相同。

但是，最好在返回的 HTML 中指定要插入的元素：

```
$('#remoteContainer').load('www.myurl.com/results.html #containerDiv'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:40:40.770

好的，所以在我问这个问题之前，也许我应该看看 DevTools。

在查看了元素检查器之后，我现在看到（至少在 Chrome 中）浏览器去掉了 HTML、HEAD 和 Body 标签。它还删除了额外的 jquery 包含。然而它确实离开了

`<script>my js functions here</script>`

尽管我知道我不能相信所有浏览器都会如此高效，但至少现在我已经看到了曙光。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:18:18.537

我同意它“应该”“正常”工作。但是请考虑您正在创建的额外开销，可以通过仅从服务器返回您需要的内容来消除这些开销。您可能正在访问数据库以检索在您丢弃的页面部分中呈现的数据。例如，您可能会在每个页面的顶部显示有关用户的信息。或者您可能正在查找进入页面元标记的其他信息。您可能正在使用某种类型的服务器端模板来创建页面的这些多余部分。然后，您将这些多余的内容放入响应中，通过线路发送，然后要求浏览器解析它，从中创建 html 元素，然后删除您不需要的部分。

这可能没什么大不了的。这取决于您获得多少流量、服务器为呈现整个页面所做的额外工作、服务器承受的负载量以及您拥有多少时间/金钱/人力与需要多少能够改为发送精简的响应。如果它是一个小项目，交通不便，它可能不值得改变。但这也可能是一个容易做出的改变。而且由于问题是关于最佳实践的，我会说不，加载整个页面以仅呈现页面的一部分不是最佳实践。最佳实践是从服务器返回您需要的内容，并使用所有这些内容来更新页面。这可以是预渲染的 HTML，也可以是 JSON，但这完全是另一个讨论。

PHP 中的一个简单的解决方案可以像下面这样简单，在查询字符串中使用 ?format=ajax：

```
<?php
$ajax = $_GET['format'] == 'ajax';

if (!$ajax) {
    render_head_and_stuff();
}

render_results();

if (!$ajax) {
    render_footer_and_stuff();
} 
```

# c# - CGBitmapContext 中的像素操作取决于视图的父视图？

> ID：15647448
> 
> 赞同：3
> 
> 时间：2013-03-26T21:08:04.057
> 
> 标签：c#, xamarin.ios, pixel, alpha, cgbitmapcontext

在使用 CGBitmapContext 操作像素时，我遇到了一些非常奇怪的事情。基本上我正在改变 PNG 的 Alpha 值。我有一个例子，我可以成功地将 PNG 像素的 Alpha 值归零，除非我的 ImageView 的超级视图是带有图像的 ImageView……这是为什么？我不确定这是错误还是上下文中的某些内容设置不正确。

下面是一个例子。它成功地将 alpha 值归零，但是当你给超级视图的 UIImageView 一个图像时，它不能正常工作。应该具有零 Alpha 的像素是稍微可见的。但是，当您从 superview 的 UIImageView 中删除图像时，Alpha 值被正确归零，您可以完美地看到它背后的白色背景。我尝试过使用几种不同的 CGBlendModes，但似乎并没有这样做。

这是演示此奇怪事件的示例项目的保管箱链接： [https ://www.dropbox.com/s/e93hzxl5ru5wnss/TestAlpha.zip](https://www.dropbox.com/s/e93hzxl5ru5wnss/TestAlpha.zip)

这是代码复制/粘贴：

```
 // Create a Background ImageView
        UIImageView Background = new UIImageView(this.View.Bounds);
        // Comment out the below line to see the Pixels alpha values change correctly, UnComment the below line to see the pixel's alpha values change incorrectly.  Why is this?  
        // When Commented out, The pixels whose alpha value I set to zero become transparent and I can see the white background through the image.  
        // When Commented in, I SHOULD see the "GrayPattern.png" Image through the transparent pixels.  I can kind of see it, but for some reason I still see the dirt pixels who's alpha is set to zero!  Is this a bug?  Is the CGBitmapContext set up incorrectly?  
        Background.Image = UIImage.FromFile("GrayPattern.png");
        this.View.AddSubview(Background);

        UIImageView MyImageView = new UIImageView(UIScreen.MainScreen.Bounds);
        UIImage sourceImage = UIImage.FromFile("Dirt.png");
        MyImageView.Image = sourceImage;
        Background.AddSubview(MyImageView);

        CGImage image = MyImageView.Image.CGImage;
        Console.WriteLine(image.AlphaInfo);
        int width = image.Width;
        int height = image.Height;
        CGColorSpace colorSpace = CGColorSpace.CreateDeviceRGB();
        int bytesPerRow = image.BytesPerRow;
        int bytesPerPixel = bytesPerRow / width;
        int bitmapByteCount = bytesPerRow * height;
        int bitsPerComponent = image.BitsPerComponent;
        CGImageAlphaInfo alphaInfo = CGImageAlphaInfo.PremultipliedLast;

        // Allocate memory because the BitmapData is unmanaged
        IntPtr BitmapData = Marshal.AllocHGlobal(bitmapByteCount);

        CGBitmapContext context = new CGBitmapContext(BitmapData, width, height, bitsPerComponent, bytesPerRow, colorSpace, alphaInfo);
        context.SetBlendMode(CGBlendMode.Copy);
        context.DrawImage(new RectangleF(0, 0, width, height), image);

        UIImageView MyImageView_brush = new UIImageView(new RectangleF(0, 0, 100, 100));
        UIImage sourceImage_brush = UIImage.FromFile("BB_Brush_Rect_MoreFeather.png");
        MyImageView_brush.Image = sourceImage_brush;
        MyImageView_brush.Hidden = true;
        Background.AddSubview(MyImageView_brush);

        CGImage image_brush = sourceImage_brush.CGImage;
        Console.WriteLine(image_brush.AlphaInfo);
        int width_brush = image_brush.Width;
        int height_brush = image_brush.Height;
        CGColorSpace colorSpace_brush = CGColorSpace.CreateDeviceRGB();
        int bytesPerRow_brush = image_brush.BytesPerRow;
        int bytesPerPixel_brush = bytesPerRow_brush / width_brush;
        int bitmapByteCount_brush = bytesPerRow_brush * height_brush;
        int bitsPerComponent_brush = image_brush.BitsPerComponent;
        CGImageAlphaInfo alphaInfo_brush = CGImageAlphaInfo.PremultipliedLast;

        // Allocate memory because the BitmapData is unmanaged
        IntPtr BitmapData_brush = Marshal.AllocHGlobal(bitmapByteCount_brush);

        CGBitmapContext context_brush = new CGBitmapContext(BitmapData_brush, width_brush, height_brush, bitsPerComponent_brush, bytesPerRow_brush, colorSpace_brush, alphaInfo_brush);
        context_brush.SetBlendMode(CGBlendMode.Copy);
        context_brush.DrawImage(new RectangleF(0, 0, width_brush, height_brush), image_brush);

        for ( int x = 0; x < width_brush; x++ )
        {
            for ( int y = 0; y < height_brush; y++ )
            {

                int byteIndex_brush = (bytesPerRow_brush * y) + x * bytesPerPixel_brush;
                byte alpha_brush = GetByte(byteIndex_brush+3, BitmapData_brush);
                // Console.WriteLine("alpha_brush = " + alpha_brush);

                byte setValue = (byte)(255 - alpha_brush);
                // Console.WriteLine("setValue = " + setValue);

                int byteIndex = (bytesPerRow * y) + x * bytesPerPixel;

                SetByte(byteIndex+3, BitmapData, setValue);

            }
        }

        // Set the MyImageView Image equal to the context image, but I still see all top image, I dont' see any bottom image showing through.  
        MyImageView.Image = UIImage.FromImage (context.ToImage());

        context.Dispose();
        context_brush.Dispose();

        // Free memory used by the BitmapData now that we're finished
        Marshal.FreeHGlobal(BitmapData);
        Marshal.FreeHGlobal(BitmapData_brush);

    public unsafe byte GetByte(int offset, IntPtr buffer)
    {
        byte* bufferAsBytes = (byte*) buffer;
        return bufferAsBytes[offset];
    }

    public unsafe void SetByte(int offset, IntPtr buffer, byte setValue)
    {
        byte* bufferAsBytes = (byte*) buffer;
        bufferAsBytes[offset] = setValue;
    } 
```

**更新** 我找到了一种解决方法（尽管它的性能对于我正在做的事情来说是非常不可接受的）解决方法只是从我上面的代码中获取结果图像，将其转换为 NSData，然后将 NSData 转换回 UIIMage .. . 神奇地，图像看起来正确！这种解决方法；但是，对于我正在做的事情是不可接受的，因为用我的图像执行此操作实际上需要 2 秒，这对我的应用程序来说太长了。几百毫秒会很有趣, 但是 2 秒对我来说太长了。如果这是一个错误，希望它得到解决！

这是解决方法（性能不佳）代码。只需将此代码添加到上面代码的末尾（或下载我的保管箱项目并将此代码添加到它的末尾并运行）：

```
 NSData test = new NSData();
        test = MyImageView.Image.AsPNG();
        UIImage workAroundImage = UIImage.LoadFromData(test);
        MyImageView.Image = workAroundImage; 
```

这是之前和之后的照片。之前没有解决方法，之后包括解决方法。

![在此处输入图像描述](../Images/e933fbd82dcb6b53f9f43f75679a4d0b.png) 请注意，灰色并没有完全出现。它被一些浅棕色覆盖，好像 alpha 值没有完全归零。

![在此处输入图像描述](../Images/6978802e29469ef67cd4049924e91644.png) 请注意解决方法，您可以完美清晰地看到灰色，根本没有浅棕色。我唯一做的就是将图像转换为 NSData，然后再次转换回 UIImage！很奇怪...

# c++ - 二维索引异常

> ID：15647462
> 
> 赞同：0
> 
> 时间：2013-03-26T21:08:59.500
> 
> 标签：c++, exception, matrix

我对以下内容有疑问。我实现矩阵。有一个用于整个矩阵的类和一个用于一行矩阵的类。我创建了行，以便可以访问像矩阵 [a] [b] 这样的成员。但问题在于抛出异常，其格式必须类似于“无效索引 [e][f]”。我会在矩阵重载 [] 中使用 try-catch 并从行重载 [] 中抛出整数异常，但它不能解决第一个索引正常而第二个索引错误的情况。

```
//Matrix overload
Row& operator [] (unsigned inx) {
return *rows[inx];
}

//Row overload
double& operator [] (unsigned inx) 
{
return items[inx];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:15:00.700

> 异常必须采用类似“无效索引 [e][f]”的格式

这比听起来更棘手！

**如果`[f]`无效，`Matrix::operator[]( e )`则已经完成。该参数不再可用。**

因此，您需要`Row`在某个时候将此信息传递给相关问题。这是一种方法。

```
// (Member variable "int Row::index" is added...)

//Matrix overload
Row& operator [] (unsigned inx) {
  rows[inx]->setRowIndex(inx);
  return *rows[inx];
}

//Row overload
double& operator [] (unsigned inx) 
{
  // Now you can throw information about both inx and the stored row index
  return items[inx];
} 
```

**如果`[e]`无效，`Row::operator[]( f )`则尚未调用。这是一个未知的值。**

这意味着即使`[e]`是无效的，它也必须返回一些`operator[]`在抛出之前仍然可以调用的东西。

```
// (Member variable "bool Row::isInvalid" is added...)

//Matrix overload
Row& operator [] (unsigned inx) {
  Row *result;
  if ( inx is invalid ) 
  {
     // Don't throw yet!
     static Row dummy;
     dummy.setInvalid();
     result = &dummy;
  }
  else
  {
    result = rows[inx];
  }
  result->setRowIndex(inx);
  return *result;
}

//Row overload
double& operator [] (unsigned inx) 
{
  // If this->isInvalid is true, the first index was bad.
  // If inx is invalid, the second index was bad.
  // Either way, we have both indices now and may throw!
  return items[inx];
} 
```

# typescript - 是否有用于语音识别的 TypeScript 库？

> ID：15647466
> 
> 赞同：3
> 
> 时间：2013-03-26T21:09:17.957
> 
> 标签：typescript

是否有用于语音识别的 TypeScript 库，例如 Chrome 使用 webkitSpeechRecognition 的实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T23:17:45.943

几乎所有的 .d.ts 文件都以 DefinitiveTyped[结尾](https://github.com/borisyankov/DefinitelyTyped)；我在那里没有看到一个。

# python - 在python中复制文本文件的最后三行？

> ID：15647467
> 
> 赞同：5
> 
> 时间：2013-03-26T21:09:19.957
> 
> 标签：python, list, text

我是 python 新手，它处理列表中变量和变量数组的方式对我来说很陌生。我通常会将一个文本文件读入一个向量，然后通过确定向量的大小将最后三个复制到一个新的数组/向量中，然后使用 for 循环将最后一个大小为三个的复制函数复制到一个新数组中。

我不明白 for 循环在 python 中是如何工作的，所以我不能这样做。

到目前为止，我有：

```
 #read text file into line list
            numberOfLinesInChat = 3
    text_file = open("Output.txt", "r")
    lines = text_file.readlines()
    text_file.close()
    writeLines = []
    if len(lines) > numberOfLinesInChat:
                    i = 0
        while ((numberOfLinesInChat-i) >= 0):
            writeLine[i] = lines[(len(lines)-(numberOfLinesInChat-i))]
                            i+= 1

    #write what people say to text file
    text_file = open("Output.txt", "w")
    text_file.write(writeLines)
    text_file.close() 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-26T21:33:21.550

要有效地获取文件的最后三行，请使用`deque`：

```
from collections import deque

with open('somefile') as fin:
    last3 = deque(fin, 3) 
```

这样可以节省将整个文件读入内存以切掉您实际上不想要的内容。

为了反映您的评论 - 您的完整代码将是：

```
from collections import deque

with open('somefile') as fin, open('outputfile', 'w') as fout:
    fout.writelines(deque(fin, 3)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T21:19:02.610

只要您可以将所有文件行保存在内存中，就可以对行列表进行切片以获取最后 x 项。请参阅[http://docs.python.org/2/tutorial/introduction.html](http://docs.python.org/2/tutorial/introduction.html)并搜索“切片表示法”。

```
def get_chat_lines(file_path, num_chat_lines):
    with open(file_path) as src:
        lines = src.readlines()
        return lines[-num_chat_lines:]

>>> lines = get_chat_lines('Output.txt', 3)
>>> print(lines)
... ['line n-3\n', 'line n-2\n', 'line n-1'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:15:58.933

首先回答你的问题，我猜你有一个索引错误，你应该用 writeLine.append() 替换行 writeLine[i]。之后，您还应该执行一个循环来编写输出：

```
text_file = open("Output.txt", "w")
for row in writeLine :
    text_file.write(row)
text_file.close() 
```

我可以建议一种更pythonic的方式来写这个吗？如下：

```
with open("Input.txt") as f_in, open("Output.txt", "w") as f_out :
    for row in f_in.readlines()[-3:] :
        f_out.write(row) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T21:30:22.563

一个可能的解决方案：

```
lines = [ l for l in open("Output.txt")]
file = open('Output.txt', 'w')
file.write(lines[-3:0])
file.close() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-26T22:27:14.160

如果您不了解 python 语法，这可能会更清楚一些。

lst_lines = lines.split()

这将创建一个包含文本文件中所有行的列表。

然后对于最后一行，您可以执行以下操作：

last = lst_lines[-1] secondLAst = lst_lines[-2] 等...列表和字符串索引可以从末尾使用“-”到达。

或者您可以遍历它们并使用以下方法打印特定的：

# start = 起始行，stop = 结束位置，step = 递增的内容。

for i in range(start, stop-1, step): string = lst_lines[i]

然后只需将它们写入文件即可。

# jquery - 使用 JQuery UI 的位置第二次定位元素不能按预期工作

> ID：15647468
> 
> 赞同：2
> 
> 时间：2013-03-26T21:09:32.797
> 
> 标签：jquery, positioning

这是我的小提琴：http: [//jsfiddle.net/Ya3w7/2/](http://jsfiddle.net/Ya3w7/2/)

HTML：

```
<img src="http://cdn.tacky.me/m/static/settings16.png" class="settings-icon"/>

<div id="control-panel">
    <img src="http://cdn.tacky.me/m/static/settings16.png" />
    <a href="#" style="float:right" id="close-cp">X</a>
    <div class="link_container"><a href="#">Show Profile</a></div>
</div> 
```

CSS：

```
.settings-icon 
{
    margin: 100px;
    cursor: pointer;
}

#control-panel
{
    position: absolute;
    height: auto;
    width: auto;
    top: 0;
    left: 0;
    background-color: #fff;
    font-family: Arial, sans-serif;
    display: none;
    z-index: 4;
} 
```

JavaScript：

```
$('.settings-icon').click(function(){
    $('#control-panel').position({
        of: $('.settings-icon'),
        my: 'left top',
        at: 'left top'
    });
    $('#control-panel').show();
});

$('#close-cp').click(function(event){
    event.preventDefault();
    $('#control-panel').hide();
}); 
```

**我正在尝试做的事情：** 我有一个设置图像，单击它会在这个 img 周围放置一个绝对定位的 div（称为 contgrol-panel）。

**我所看到的：**

我第一次点击img它工作正常

我通过单击右上角的 X 关闭控制面板

第二次点击控制面板出现在别的地方

**如何复制**

去小提琴

*   第一次点击设置图标
*   通过单击 X 关闭下拉的控制面板
*   再次单击设置图标
*   看到控制面板在其他地方弹出

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T21:13:04.010

你只需要在控制面板关闭后将其恢复为0、0即可。这是更新的小提琴[http://jsfiddle.net/Ya3w7/3/](http://jsfiddle.net/Ya3w7/3/)。

```
$('.settings-icon').click(function(){
    $('#control-panel').position({
        of: $(this),
        my: 'left top',
        at: 'left top'
    });
    $('#control-panel').show();
});

$('#close-cp').click(function(event){
    event.preventDefault();
    $('#control-panel').css({top: '0px', left: '0px'}).hide();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-20T15:00:51.550

**因为 jquery ui 不支持对隐藏元素的定位，所以你必须显示和定位。**

```
$('.settings-icon').click(function(){
  $('#control-panel').show().position({
    of: $(this),
    my: 'left top',
    at: 'left top'
   });
}); 
```

# javascript - 使用 simplejson 的 JSON 序列化错误

> ID：15647478
> 
> 赞同：0
> 
> 时间：2013-03-26T21:10:09.957
> 
> 标签：javascript, python, json

我有以下代码：

```
data = {'services': [u'iTunes'], 
        'orders': [u'TestOrder', u'Test_April_Titles_iTunes'],
        'providers': ''}

return HttpResponse(simplejson.dumps(data))

File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/encoder.py" in default
  178\.         raise TypeError(repr(o) + " is not JSON serializable")

Exception Type: TypeError at /reports/change_dropdown/
Exception Value: [u'iTunes'] is not JSON serializable 
```

我需要做什么来序列化这个字典，里面有一个列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T13:02:42.540

问题是这`itunes`是一个非 JSON 兼容的类型。

解决序列化时提供默认类型转换非 JSON 兼容类型的问题：

```
simplejson.dumps(data, default=str)) 
```

甚至：

```
def handler(val):
    if isinstance(val, unicode)
        return str(val)
    else:
        return val

simplejson.dumps(data, default=handler)) 
```

第二个选项的优点是您可以处理集合（例如，转换为列表）、日期（例如，转换为 int 时间戳）等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:13:01.980

从这里转换`unicode`为`str`工作：

```
data['services'] = [str(item) for item in data['services']]
data['orders'] = [str(item) for item in data['orders']]
data['providers'] = [str(item) for item in data['providers']] 
```

# jquery - 不应该在桌面上调整流畅布局的屏幕大小来显示网站应该如何寻找移动设备？

> ID：15647480
> 
> 赞同：0
> 
> 时间：2013-03-26T21:10:14.723
> 
> 标签：jquery, css, twitter-bootstrap, mobile-safari, screen-resolution

我对流畅的布局、屏幕分辨率以及 twitter 引导程序本身的工作方式有点困惑。

我在网站嘲笑的早期阶段。

所以到目前为止我所做的在桌面上看起来相当不错。

![在此处输入图像描述](../Images/6e128f7a985cfc1d51dbebbdd0839c97.png)

当我在 chrome 中调整窗口的大小时，布局也适应得很好（尽管并不完美）。

![在此处输入图像描述](../Images/39fe8f0c343d3d715704701b9e8ac5aa.png)

令我困惑的是，当我从 iPhone 广告 iPod touch 浏览时，它只是渲染了大桌面渲染的半损坏版本：

![在此处输入图像描述](../Images/5cb6bf8431589b9b90b8ff5708759118.png)

我知道您可以使用媒体查询来单独影响这些特定屏幕的 CSS，如下所示：

```
/* Large desktop */
@media (min-width: 1200px){

}

/* Portrait tablet to landscape and desktop */
@media (min-width: 768px) and (max-width: 979px) { 

}

/* Landscape phone to portrait tablet */
@media (max-width: 767px) {

}

/* Landscape phones and down */
@media (max-width: 480px) {

} 
```

但是，当我在桌面上手动减小窗口大小时，iPhone 不应该向我显示相同的内容吗？

[您可以在此处](http://trufavarela.com/finnmount/)查看该站点的实时版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:13:01.073

您还需要为移动浏览器定义初始视口大小：

```
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
```

[在http://www.quirksmode.org/blog/archives/2010/09/combining_meta.html](http://www.quirksmode.org/blog/archives/2010/09/combining_meta.html)阅读更多内容

# c# - 如何在 Windows 窗体应用程序的 SQL 查询中使用用户输入作为参数？

> ID：15647483
> 
> 赞同：-1
> 
> 时间：2013-03-26T21:10:22.147
> 
> 标签：c#, winforms, sql-server-2008, visual-studio-2012

我想附加一个带有参数化查询的数据集。类似于用户在文本框中输入值然后点击提交按钮。

我创建了一个文本字段和一个单击按钮事件，例如：

```
 private void Btn_GetProjDetails_Click(object sender, EventArgs e)
    {
        string userEnteredProjId = tab3ProjIdInput.Text;
    } 
```

但现在不知道如何在我的查询中使用这个 userEnteredProjId 变量？

我还没有尝试手动编码所有数据连接路径。而是在VS2012中添加了GUI来添加数据源。然后使用我了解到的这个数据源，我们可以添加数据集，然后使用这些数据集在我们的表单中拖放。所以我创建了一个数据集，然后创建了数据集工具箱，我添加了我的表并创建了一个查询，但不知道如何在我的查询中使用 userEnteredProjId。

![在此处输入图像描述](../Images/62c5f921498928296d99e66dc3c889a7.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:24:54.363

您永远不想只将用户的值插入到 SQL 查询中，因为这是一个巨大的 SQL 注入风险。最好使用参数，如果在使用参数之前对参数进行一些验证，那就更好了。这是使用命令参数的基本示例。

```
using (cmd command = new SqlCommand())
{
    string sql = "Select * from table where projid=@UserEnteredProjid";
    cmd.Connection = conn;
    cmd.CommandType = CommandType.Text;
    cmd.CommandText = sql;
    cmd.Parameters.AddWithValue("UserEnteredProjid", your_value_here);      
    SqlDataReader reader = command.ExecuteReader();
    while (reader.Read())
    {
    //do something;
    }
} 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-26T21:17:09.417

好吧，您的查询只是我猜测的字符串变量，例如“从表中选择 *”。您只想获取一些用户输入的数据来增加您的查询：

string query = "select * from table where projid = " + UserEnteredProjid;

# javascript - 在 Grunt 中使用全局变量设置构建输出路径

> ID：15647484
> 
> 赞同：6
> 
> 时间：2013-03-26T21:10:23.347
> 
> 标签：javascript, gruntjs

我有几个繁重的任务，我试图在这些任务之间共享全局变量，但我遇到了问题。

我编写了一些自定义任务，根据构建类型设置正确的输出路径。这似乎是正确设置的东西。

```
// Set Mode (local or build)
grunt.registerTask("setBuildType", "Set the build type. Either build or local", function (val) {
  // grunt.log.writeln(val + " :setBuildType val");
  global.buildType = val;
});

// SetOutput location
grunt.registerTask("setOutput", "Set the output folder for the build.", function () {
  if (global.buildType === "tfs") {
    global.outputPath = MACHINE_PATH;
  }
  if (global.buildType === "local") {
    global.outputPath = LOCAL_PATH;
  }
  if (global.buildType === "release") {
    global.outputPath = RELEASE_PATH;
  }
  if (grunt.option("target")) {
    global.outputPath = grunt.option("target");
  }
  grunt.log.writeln("Output folder: " + global.outputPath);
});

grunt.registerTask("globalReadout", function () {
  grunt.log.writeln(global.outputPath);
}); 
```

所以，我试图在后续任务中引用 global.outputPath，并遇到错误。

如果我`grunt test`从命令行调用，它输出正确的路径没问题。

但是，如果我有这样的任务： clean: { release: { src: global.outputPath } }

它抛出以下错误： `Warning: Cannot call method 'indexOf' of undefined Use --force to continue.`

此外，我在 setOutput 任务中的常量设置在 Gruntfile.js 的顶部

有什么想法吗？我在这里做错了吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-27T15:54:39.793

So, I was on the right path. The issue is that the module exports before those global variables get set, so they are all undefined in subsequent tasks defined within the initConfig() task.

The solution I came up with, although, there may be better, is to overwrite a grunt.option value.

I have an optional option for my task --target

working solution looks like this:

```
grunt.registerTask("setOutput", "Set the output folder for the build.", function () {
  if (global.buildType === "tfs") {
    global.outputPath = MACHINE_PATH;
  }
  if (global.buildType === "local") {
    global.outputPath = LOCAL_PATH;
  }
  if (global.buildType === "release") {
    global.outputPath = RELEASE_PATH;
  }
  if (grunt.option("target")) {
    global.outputPath = grunt.option("target");
  }

  grunt.option("target", global.outputPath);
  grunt.log.writeln("Output path: " + grunt.option("target"));
}); 
```

And the task defined in initConfig() looked like this:

```
clean: {
  build: {
    src: ["<%= grunt.option(\"target\") %>"]
  }
} 
```

Feel free to chime in if you have a better solution. Otherwise, perhaps this may help someone else.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-23T17:33:03.923

我有一种方法可以让您使用诸如`--dev`. 到目前为止，它工作得很好，我非常喜欢它。以为我会分享它，因为其他人也可能喜欢它。

```
 # Enum for target switching behavior
    TARGETS =
      dev: 'dev'
      dist: 'dist'

    # Configurable paths and globs
    buildConfig =
      dist: "dist"
      dev: '.devServer'
      timestamp: grunt.template.today('mm-dd_HHMM')

    grunt.initConfig
        cfg: buildConfig
        cssmin:
            crunch:
                options: report: 'min'
                files: "<%= grunt.option('target') %>/all-min.css": "/**/*.css"

    # Set the output path for built files.
    # Most tasks will key off this so it is a prerequisite
    setPath = ->
      if grunt.option 'dev'
        grunt.option 'target', buildConfig.dev
      else if grunt.option 'dist'
        grunt.option 'target', "#{buildConfig.dist}/#{buildConfig.timestamp}"
      else # Default path
        grunt.option 'target', buildConfig.dev
      grunt.log.writeln "Output path set to: `#{grunt.option 'target'}`"
      grunt.log.writeln "Possible targets:"
      grunt.log.writeln target for target of TARGETS

    setPath() 
```

使用此设置，您可以运行以下命令：

```
grunt cssmin --dist #sent to dist target
grunt cssmin --dev #sent to dev target
grunt cssmin --dev #sent to default target (dev) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-01T04:21:05.480

这是一个较老的问题，我只是想投入我的 5 美分。

如果您需要可以从任何任务访问配置变量，只需在您的主（您将始终加载的）配置文件中定义它，如下所示：

```
module.exports = function(grunt)
{
    //
    // Common project configuration
    //
    var config = 
    {
        pkg: grunt.file.readJSON('package.json'),

        options: // for 'project'
        {
            dist:
            {
                outputPath: '<%= process.cwd() %>/lib',
            },
            dev:
            {
                outputPath: '<%= process.cwd() %>/build',
            },
        },
    }

    grunt.config.merge( config )
} 
```

然后您可以像这样简单地访问值：

*   在配置文件中

`... my_thingie: [ ends_up_here: '<%= options.dev.outputPath %>/bundle', ], ...`

*   在任务中

`// as raw value grunt.config.data.options.dist.outputPath // after (eventual) templates have been processed grunt.config('options.dist.outputPath')`

我在这里使用 key**`options`**只是为了符合约定，但是你可以使用任何东西，只要你记得不要注册一个名为的任务`'options'`或你用于 key 的任何东西 :)

# ruby - 按 has_many 关联中的属性值范围过滤 ActiveRecord

> ID：15647487
> 
> 赞同：0
> 
> 时间：2013-03-26T21:10:35.020
> 
> 标签：ruby, ruby-on-rails-3, activerecord

可以说我有一个拥有很多玩具的人。然后我有一个具有多种颜色的玩具。我在我的 Person#show 方法中尝试做的是过滤包含一系列颜色的玩具。

```
class Person < ActiveRecord::Base
 attr_accessible :name
 has_many :toys
end

class Toy < ActiveRecord::Base
 attr_accessible :size
 belongs_to :person
 has_many :colors
end

class Color < ActiveRecord::Base
 attr_accessible :color
 belongs_to :toy
end 
```

然后在我的 PersonController 中，我想将 Toys 过滤为一系列颜色。

```
class PersonController < ApplicationController
 def show
  @person = Person.find(params[:id])
  # Now I want to filter by toy colors that might be red or blue or purple or etc...
  # So when in my view I do @person.toys I know they only contain the filtered colors
  @person.toys.categories
 end
end 
```

帮助或建议将不胜感激。仍在积极学习 Rails。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:52:23.067

如果您想采用 DB 方法，您可以执行以下操作：

```
if params[:toy_colors].nil? 
  @toys = @person.toys
else
  colors = params[:toy_colors].split(',')
  # NOTE. You should obviously check that the colors array 
  # contains only expected colors to avoid any sql injection.
  @person.toys.joins(:colors).where('colors in ?', colors)
end 
```

颜色作为参数传入的地方，例如。

```
http://localhost:3000/person/1?toy_colors=red,green 
```

# android - 在一致的方向更改后重新创建已完成的活动

> ID：15647494
> 
> 赞同：1
> 
> 时间：2013-03-26T21:10:52.177
> 
> 标签：android, orientation, restart, oncreate, activity-finish

我不知道这种行为是否正常，因为我认为对 finish() 的调用会阻止重新创建活动。

以下是活动类的摘录：

```
public class MyActivity extends FragmentActivity {

    private RetainFragment retainFragment;

    @Override
    protected void onCreate(Bundle savedInstanceState) {

        ......

        retainFragment = getSupportFragmentManager().findFragmentByTag("RetainFragment");
        if(retainFragment == null) {
            retainFragment = new RetainFragment();
            getSupportFragmentManager().beginTransaction().add(retainFragment, "RetainFragment").commitAllowingStateLoss();
        }
        if(retainFragment.isFinish) {
            Log.v("MyActivity", "isFinish == true");
            this.finish();
        }
    }

    // a on-click event handler for a finish button
    public void onFinishClicked(View view) {
         retainFragment.isFinish = true;
         this.finish();
    }

    private class RetainFragment extends Fragment {
        private boolean isFinish = false;

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            this.setRetainInstance(true);
        }
    }

} 
```

活动是持久的（我也将其他持久变量存储在 RetainFragment 中，但我没有显示它们）并且仅在用户单击完成按钮后关闭，此时将调用 onFinishClicked(View) 和活动应该由系统完成。我预计它不会在屏幕同时旋转后被系统重新创建。这种情况很少发生，我通过在 onCreate() 方法中再次调用 finish() 来处理它。但是，这里看起来很丑，因为完成的活动应该永远死掉，现在我必须明确地处理它。:( 我对活动生命周期或保留片段有任何误解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:22:02.520

如果您在 Android 上工作，每当您听到自己说“此活动将仅在之后关闭`X`”时。不。您永远不应该依赖具有高度可控生命周期的 Activity。您的 Activity 应该以这样一种方式设计，即无论何时销毁和重新创建它，它都能正常工作。

要跨轮换等保留信息，请添加代码`onSaveInstanceBundle`，然后检查它`onCreate`并提取保存的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T03:08:10.120

这是标准的 Android 行为。看看这段 Android[文档](http://developer.android.com/reference/android/app/Activity.html#ConfigurationChanges)。

> 除非您另外指定，否则配置更改（例如屏幕方向、语言、输入设备等的更改）将导致您当前的活动被破坏，并通过 onPause()、onStop() 和onDestroy() 视情况而定。如果活动在前台或对用户可见，**则在该实例中调用 onDestroy() 后，将创建活动的新实例**，其中包含前一个实例从 onSaveInstanceState(Bundle) 生成的任何已保存实例状态。

为避免这种情况，您可以在其清单中设置 android:configChanges 属性。对于您说您在那里处理的任何类型的配置更改，您将收到对当前活动的 onConfigurationChanged(Configuration) 方法的调用，而不是重新启动。但是，如果配置更改涉及您未处理的任何内容，则活动仍将重新启动，并且不会调用 onConfigurationChanged(Configuration)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-02T04:44:02.180

我遇到了同样的问题。也就是说，我有一个 Activity A，它将使用 startActivityForResult 启动一个 Activity B。B 的方向被清单锁定。A 的方向未锁定。

当我旋转我的设备以使方向不同时，将不会重新创建活动 B。这是预期和正常的。然而，一旦我执行了一个将完成（）活动 B 的 UI 操作，而不是看到活动 A 被重建并显示在屏幕上，我再次看到活动 B。此外，调用的是 Activity B 的 onActivityResult 而不是 A 的 onActivityResult。

我弄清楚发生了什么。我使用用于启动 A 的相同 Intent 对象也启动 B。在方向更改和 B 完成后，Android 系统检测到 Activity A 需要重建，因为 A 是在方向不同时最后构建的。系统将使用最初用于构建 A 的相同 Intent 对象重构 A。但是，Intent 对象被修改为启动 B，因此系统将重构 Activity B 而不是 Activity A。

我的代码遵循类似于以下的逻辑：

```
public class A extends Activity {
     @Override
     protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        //...omitted code for clarity...
        Intent i = getIntent();
        i.setClass(this, B.class);
        startActivityForResult(i, 0);
     }

     @Override
     public void onActivityResult(int requestCode, int resultCode, Intent data) {
         //...omitted code for clarity...
     }
 } 
```

我的活动 B 看起来像：

```
public class B extends Activity {
     //...omitted code for clarity....

     public void myFinishingClickHandler(View clickedView) {
         //...omitted code for clarity...
         finish();
     }
} 
```

场景快速演练：

1.  设备处于纵向模式。用户启动 Activity A。系统将构造带有 Intent I 的 Activity A，其目标设置为 A。
2.  活动 A 通过将目标更改为 B 来修改其 Intent I。
3.  Activity A 以 Intent I 开始一个 Activity。系统将构造 Activity B，因为 I 现在指向 B。
4.  B 现在正在运行。用户将设备方向更改为横向。
5.  用户单击单击侦听器调用 myFinishingClickHandler 的按钮。该方法在 Activity B 上调用 finish()。
6.  活动 B 结束。系统开始恢复活动 A 的过程。
7.  系统注意到 Activity A 是在设备处于纵向时构建的，但现在设备处于横向模式。系统将尝试重新创建活动 A。现有的 Activity A 通过其销毁流程（调用 onDestroy）发送。
8.  系统将使用保存的 Intent I 重构 Activity A。但是，I 的目标仍然是 Activity B。系统改为构建 Activity B 而不是 Activity A。

**解决方案：**不要共享 Intents 来启动活动。使用 Intent 复制构造函数。

此外，锁定您的活动的方向以减少对方向变化的担心（其他配置更改将导致您的活动被重建，例如更改语言）。

# ssis - 生成脚本 - 仅数据 - 发现循环依赖项错误

> ID：15647495
> 
> 赞同：26
> 
> 时间：2013-03-26T21:10:57.340
> 
> 标签：ssis, sql-server-2012

我正在尝试生成数据库中所有数据的脚本，这样我就可以将数据移动到另一台服务器上的相同数据库中。在 SQL Server 2012 中，我右键单击源数据库

**任务 > 生成脚本 > 编写整个数据库和所有数据库对象的脚本 > 高级 > 要编写脚本的数据类型：仅数据**

这给了我一个关于循环依赖的错误。如果我将数据类型更改为脚本到**模式和数据**，它会生成很好。如何解决此问题以仅处理数据？

> 操作结果从 MyDatabase 获取对象列表失败
> 
> 详细报告：
> 
> Microsoft.SqlServer.Management.SqlScriptPublish.SqlScriptPublishException：编写对象脚本时出错。---> Microsoft.SqlServer.Management.Smo.SmoException：找到循环依赖项。在 Microsoft.SqlServer.Management.Smo.SmoDependencyOrderer.DependencyGraphTraversal(Int32 num, Dictionary `2 dictionary, List`1 sortedList, HashSet `1 visited, HashSet`1 current) 在 Microsoft.SqlServer.Management.Smo.SmoDependencyOrderer.DependencyGraphTraversal(Int32 num, Dictionary `2 dictionary, List`1 sortedList, HashSet `1 visited, HashSet`1 current) .SqlServer.Management.Smo.SmoDependencyOrderer.DependencyGraphTraversal（Int32 num，Dictionary `2 dictionary, List`1 sortedList，HashSet `1 visited, HashSet`1 current）在 Microsoft.SqlServer.Management.Smo.SmoDependencyOrderer.DependencyGraphTraversal（Int32 num，Dictionary`2 dictionary, List`1 sortedList, HashSet `1 visited, HashSet`1 current) 在 Microsoft.SqlServer.Management.Smo.SmoDependencyOrderer.SortDictionary(Dictionary `2 dictionary) at Microsoft.SqlServer.Management.Smo.SmoDependencyOrderer.SortDataSet(DataSet ds) at Microsoft.SqlServer.Management.Smo.SmoDependencyOrderer.SortDataSet(List`1 objectList, Dictionary `2 idDictionary, DataSet ds) at Microsoft.SqlServer.Management.Smo.SmoDependencyOrderer.ExecuteQueryUsingTempTable(List`1 objectList, List `1 list, String query) at Microsoft.SqlServer.Management.Smo.SmoDependencyOrderer.ResolveTableOnlyDependencies() at Microsoft.SqlServer.Management.Smo.SmoDependencyOrderer.ResolveDependencies() at Microsoft.SqlServer.Management.Smo.SmoDependencyOrderer.Order(IEnumerable`1 urns) 在 Microsoft.SqlServer.Management.Smo.ScriptMaker.DiscoverOrderScript(IEnumerable`1 urns) at Microsoft.SqlServer.Management.Smo.ScriptMaker.ScriptWorker(List`1 urns, ISmoS​​criptWriter writer) at Microsoft.SqlServer.Management.Smo.ScriptMaker.Script(Urn[] urns, ISmoS​​criptWriter writer) at Microsoft.SqlServer.Management.SqlScriptPublish.SqlScriptGenerator.DoScript(ScriptOutputOptions outputOptions) --- 内部异常结束堆栈跟踪 --- 在 Microsoft.SqlServer.Management.SqlScriptPublish.GeneratePublishPage.worker_DoWork(Object sender, DoWorkEventArgs e) 在 System.ComponentModel.BackgroundWorker.OnDoWork(DoWorkEventArgs e) 在 System.ComponentModel.BackgroundWorker.WorkerThreadStart(Object argument)

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2014-11-14T07:29:28.143

对我有用的一种可能的解决方案是将脚本生成为“架构和数据”而不是“仅数据”。然后我可以删除所有不必要的模式内容，只留下数据。希望这也有帮助。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-07-25T02:59:13.853

我有同样的错误......在这里查看我的答案：http: [//mattslay.com/ssms-generate-scripts-data-only-cyclic-dependencies-found-error/](http://mattslay.com/ssms-generate-scripts-data-only-cyclic-dependencies-found-error/)

> 然后，一时兴起，知道我之前已经成功编写过这个数据库的脚本，我使用 Sql Server Management 2008 R2 连接到 Sql Server 2012 实例，并且能够毫无错误地生成脚本！
> 
> 请注意，我只做数据，我必须允许它为所有数据库对象编写脚本。我试图只选择某些表，但这给出了一些我不愿意追查的其他错误，所以我只是做了整个事情。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-11-13T15:00:12.290

我遇到了同样的问题，并且没有安装 SSMS 2008 R2 来执行 Matt 建议的操作。所以我所做的是更改高级设置以使其创建架构和数据，并将其设置为检查对象是否已存在。我将大部分其他内容设置为 false（即主键、唯一键等），因此 sql 文件中的所有内容都是基本的创建表语句和插入语句。因为它在创建表之前检查表是否不存在，所以如果表已经存在，您可以运行脚本。所以它的行为就像它只是插入语句一样。如果您要为多个选定的表创建单个 sql 文件，它将所有表创建块放在脚本的顶部，因此如果需要，在创建文件后删除所有这些块很容易。

# linux - 计算语法错误

> ID：15647496
> 
> 赞同：0
> 
> 时间：2013-03-26T21:10:57.837
> 
> 标签：linux, bash, calc

我一直在寻找一个简单的命令行计算器，发现 calc 既简单又有用，事实证明它安装在我们的服务器上。

这是 calc 的网站：[http ://www.isthe.com/chongo/tech/comp/calc/](http://www.isthe.com/chongo/tech/comp/calc/)

但是，当我尝试简单的计算时，例如：

```
calc 3/(1+2) 
```

它给了我这个错误信息：

```
-bash: syntax error near unexpected token `(' 
```

但是，这很好用：

```
calc 3*(1+2)

3*(1+2) = 9.000000 
```

服务器版本为：

```
$ uname -sr
Linux 3.2.0-23-generic 
```

有谁知道错误是如何出现的？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T21:57:08.027

好的。这是正在发生的事情。

这与 calc 无关，与 bash 有关。为了解释这一点，我先举一个 echo 的例子。

```
wlynch@host:/tmp/blah$ ls          # No files in this directory
wlynch@host:/tmp/blah$ echo *(3)   # This works as you expect.
*(3)                               #
wlynch@host:/tmp/blah$ echo *(4)   # This works as you expect.
*(4)                               #
wlynch@host:/tmp/blah$ touch 3     # Create a file named 3 in the directory.
wlynch@host:/tmp/blah$ ls          #
3                                  #
wlynch@host:/tmp/blah$ echo *(3)   # This now gives a different result!
3                                  #
wlynch@host:/tmp/blah$ echo '*(3)' # Quoting gives what you want.
*(3)                               #
wlynch@host:/tmp/blah$ echo *(4)   # This works as you previously expected.
*(4) 
```

请注意，当我们在名为`3`.

这里发生的`*(pattern)`是通配符。它匹配所包含模式的任何计数。Bash 还有一个奇怪的副作用，如果模式不匹配，它不会返回任何内容，而是返回最初看到的模式。

因此，在您的情况下，您不小心使用了 bash 的通配符替换方法之一。[模式匹配](http://www.gnu.org/software/bash/manual/bashref.html#Pattern-Matching)。

现在，至于为什么会`/()`失败？那是因为括号是 bash 中的另一个命令，而这个命令恰好被用作语法错误。[分组命令](http://www.gnu.org/software/bash/manual/bashref.html#Command-Grouping)。

正如其他答案中提到的那样，该解决方案用引号将您的命令行参数括起来，这样这些功能都不会启用。

* * *

另外，顺便说一句，我们可以禁用`*(pattern)`使用的功能。如果我们这样做，那么`/()`和`*()`都会因为括号而失败`()`：

```
wlynch@host:/tmp/blah$ shopt -s extglob
wlynch@host:/tmp/blah$ echo *()
*()
wlynch@host:/tmp/blah$ echo /()
bash: syntax error near unexpected token `('

wlynch@host:/tmp/blah$ shopt -u extglob
wlynch@host:/tmp/blah$ echo *()
bash: syntax error near unexpected token `('
wlynch@host:/tmp/blah$ echo /()
bash: syntax error near unexpected token `(' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-26T21:15:34.743

您只需要在算术表达式中添加引号：

前任 ：

```
$ calc '3/(1+2)'
    1 
```

“使用更多报价！” 它们至关重要。此外，了解 ' 和 " 和 ` 之间的区别。参见[http://mywiki.wooledge.org/Quotes](http://mywiki.wooledge.org/Quotes)和[http://wiki.bash-hackers.org/syntax/words](http://wiki.bash-hackers.org/syntax/words)

# wordpress - Wordpress If Category 语句然后显示此分层图像

> ID：15647499
> 
> 赞同：0
> 
> 时间：2013-03-26T21:11:07.230
> 
> 标签：wordpress, if-statement, categories, custom-post-type

我有一个 wordpress 博客，它有一个自定义的帖子类型，它有自己的一组类别。我的模板中有一个类似的代码，它使用一个函数在博客部分搜索不同的帖子格式并显示该特定格式的特定图标。例如：if(has_post_format('audio')) {return 'ICON IMAGE';}

我想对自定义帖子类型的类别做同样的事情。有没有办法可以搜索自定义帖子类型并按类别显示不同的图标？例如： if (is_category('Case Studies') {return.......

我这样尝试过，但没有成功。我认为这与自定义帖子类型有关。我是否需要以某种方式将自定义帖子类型附加到类别？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T11:08:30.763

对于四个自定义帖子类型类别，我需要类似的东西并解决了这个问题，我是 PHP 新手，所以这可能不是最好的方法，但它对我有用。

在循环之外.. 我使用'single_term_title 来获取自定义帖子类型类别的名称并将其分配给变量'$ current_term'，然后使用 if / else if 语句...

```
<?php $current_term = single_term_title("", false); 

//Cat name 1

if($current_term === 'Name 1') {
echo 'something';
} 

//Cat name 2
else if($current_term === 'Name 2') {
echo 'something';
}  

//Cat name 3
else if($current_term === 'Name 3') {
echo 'something';
} 

//Cat name 4
else if($current_term === 'Name 4') {
echo 'somehting';
}  

//Do nothing
else {
echo '';
}
?> 
```

# javascript - 像 rails 这样的部分仅在纯 javascript 中完成，并且完全在客户端。--IE没有服务器

> ID：15647500
> 
> 赞同：2
> 
> 时间：2013-03-26T21:11:09.667
> 
> 标签：javascript, ruby-on-rails, html, templates

我正在做一个小型家庭酿造项目，我发现我已经被与 RoR 尤其是 RoR 一起工作宠坏了`partials`。

我的项目完全是客户端。所以我使用 javascript 和 HTML5。现在我想做的是：有一个带有容器的主屏幕模板，我可以在其中执行类似于`<%= yeild %>`RoR 中的经典标记的操作。

我曾考虑过使用`iframes`，但这似乎很乱。我还考虑过使用[xmlHTTP 请求](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest)在我的 javascript 中获取文件，然后使用文件流更新`innerHTML`我的内容。`div`我以前为个人项目做过这个，但它很hacky，我必须用`--allow-file-access-from-files`标签标记像Chrome这样的浏览器。显然我不能建议最终用户这样做。

我的另一个想法是将 html 编写为 javascript 字符串，然后将不同的字符串作为值，`content.innerHTML`但这听起来很愚蠢，难以维护，而且根本不干净。

最终，我什至准备编写自己的解决方案（然后我会在这里发布作为其他人的答案），但我想知道是否已经有解决方案。

最终目标行为将遵循以下流程：

主页：

```
<div id="main_content">
    <!-- this is the yield area -->
</div> 
```

应用程序启动并将文件`menu.html`加载到`yield area`：

```
<div id="main_content">
    <!-- this is the content of menu.html, notice it's like a partial, 
         there is no body or head or doc type tags, just a list -->
    <ul>
        <li>Menu item</li>
    </ul>
    <!-- this is the end of the menu.html content -->
</div> 
```

最后，当他们单击`Menu item`它时，会将 的内容加载`menu_item.html`到`content div`替换当前内容 ( `menu.html`) 中。

* * *

我已经做过的一些研究：

*   [像 iframe 一样的 Div？](http://www.velocityreviews.com/forums/t155136-div-like-iframe.html)
*   [Div`src`属性插件](http://code.google.com/p/div-src/)（看起来很有趣，但在网络服务器上运行）
*   [关于使用 javascript 更新 div 的堆栈问题](https://stackoverflow.com/questions/5255738/updating-the-content-of-a-div-with-javascript/5256117#5256117)
*   [在某处找到了导致 Pure](http://beebole.com/pure/) This 的链接，看起来它可以解决问题，但似乎很难实现很多内容（因为我没有任何生成的东西`json`，我必须通过手。）
*   [这谈到了`seamless`iframes 的属性](https://stackoverflow.com/questions/4804604/html5-iframe-seamless-attribute)，看起来很有希望，但只有 chrome 已经实现，即使这样，它的 bug 也被放弃了。[有关该属性](https://bugs.webkit.org/show_bug.cgi?id=45950)[的 webkit 开发状态，请参见此处。`seamless`](https://bugs.webkit.org/show_bug.cgi?id=45950)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:17:17.963

如果你使用 jQuery，你可以使用 jQuery.load()：[http ://api.jquery.com/load/](http://api.jquery.com/load/)

例子：

```
$("#main_content").load("menu_item.html"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:50:04.113

如果您担心 DOM 的安全性`<div>`（这是一件值得担心的好事），那么您最好使用`<div>`不附加到 DOM 的中介。

```
function parse_html (html) {
    var div = document.createElement("div");
    div.innerHTML = html;

    var scripts = div.getElementsByTagName("script"),
        i = scripts.length;

    while (i > 0) {
        div.removeElement(scripts[i]);
        i -= 1;
    }

    return div.firstChild;
} 
```

然后，如果您通过 XHR 获取 HTML 文件：

```
var xhr = new XMLHttpRequest();
xhr.open("GET", "/templates/menu.html", true); 
```

你可以把你`var child_el = parse_html(xhr.responseText);`的 XHR 回调。
然后只需将该元素附加到您的 div 中。

该功能假设您的部分有一个根元素（假设您可以有多个背靠背的部分，但每个模板将从一个元素开始。

如果不是这种情况，那么您将在函数 ( `document.createDocumentFragment();`) 中创建一个文档片段，并将每个元素按顺序附加到片段中，在函数末尾返回片段，然后将其附加到 div （当然，事后这会使 div 内的节点管理变得更加困难）。

我正在为一些宠物项目做类似的事情，使用一个简单的模板系统，用于在 html`{% %}`中注入数据属性 ( `{% item.title %}`) 或函数中的任意 JS/返回值。

这只是一个基本的实现，你可以用它做很多事情......
支持任意嵌套级别，对于模板内部的模板将是更多的工作。

# jquery - 使用 Jquery 进行工作表单验证

> ID：15647502
> 
> 赞同：0
> 
> 时间：2013-03-26T21:11:17.560
> 
> 标签：jquery, validation

我一直在尝试在 keyup 上的表单字段旁边使用视觉复选标记或 X 来滚动我自己的表单验证。我遇到的一个问题是，无论是否出错，它都会在 keyup 被触发后产生一个新的跨度。因此，我尝试在每次按键后删除所有元素，以便获得一个带有成功或错误消息的跨度。这目前有效，但我想知道是否有更好的方法来做到这一点：

```
jQuery('input#firstname').keyup(function () {

    var text = jQuery(this).val();

    if (check_text(text) === false || text === '') {
        $(this).nextAll().remove();
        jQuery(this).after('<span class="form-error">Error</span>');
    } else {
        $(this).nextAll().remove();
        jQuery(this).after('<span class="form-success">Success</span>');
    }
});

/* Functions */

function check_text(text) {
    var regex = /^[a-zA-Z0-9- ]*$/;
    return regex.test(text);
} 
```

工作示例：http: [//jsfiddle.net/XBaKQ/1/](http://jsfiddle.net/XBaKQ/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:27:05.983

我建议您在每个旁边添加跨度`input`

```
<input id="firstname" /><span class='msg'></span> <br>
<input id="lastname" /><span class='msg'></span> 
```

在你的脚本集消息中是这样的：

```
 if (check_text(text) === false || text === '') {
        jQuery(this).next(".msg").html('<span class="form-error">Error</span>');
       } else {      
         jQuery(this).next(".msg").html('<span class="form-success">Success</span>');
      } 
```

# [*jsFiddle*](http://jsfiddle.net/mohammadAdil/XBaKQ/4/)

# javascript - jQuery文件上传不提交额外参数

> ID：15647503
> 
> 赞同：8
> 
> 时间：2013-03-26T21:11:21.180
> 
> 标签：javascript, jquery, blueimp, jquery-file-upload

我需要使用 jQuery File Upload 控件中可用的 formData 参数在提交时向服务器发送附加数据。formData 的默认实现是调用一个函数，该函数获取表单中的所有控件并将它们序列化为一个数组（使用 jQuery serializeArray() 方法）。

我的表单中有控件，但是当文件上传时，我没有得到任何额外的数据。当我通过 Fiddler 检查时，请求中没有任何内容显示正在提交这些表单字段。

是否需要做一些额外的事情才能让这些提交？

顺便说一句，这两个链接讨论 formData ...

[https://github.com/blueimp/jQuery-File-Upload/wiki/Submit-files-asynchronously](https://github.com/blueimp/jQuery-File-Upload/wiki/Submit-files-asynchronously) [https://github.com/blueimp/jQuery-File-Upload/wiki/Options](https://github.com/blueimp/jQuery-File-Upload/wiki/Options) ...对于这个搜索formData 页面。

对于它的价值，该`multipart`选项设置为 true。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-11-05T06:43:29.820

我还需要传递一个额外的参数，这是我使用的：

```
$('#fileupload').fileupload({
    formData: {
                    param1: 'test'
                    ,param2: "value2"
                    ,param3: "yasseshaikh"
              }
}); 
```

formData[选项](https://github.com/blueimp/jQuery-File-Upload/wiki/How-to-submit-additional-Form-Data)可用于以编程方式设置其他表单数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-30T11:35:03.933

完整代码（我修改了Yasser提供的答案）

将这些代码添加到 jquery.fileupload.js

```
submit: function (e, data) {

    $('#fileupload').fileupload({
          formData: {
                 param1: 'test'
                ,param2: "value2"
                ,param3: "yasseshaikh"
          }
    });
}, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-24T13:54:27.953

You have to bind Your data to fileupload. Look at this question
[Blueimp jQuery file upload, passing extra form data](https://stackoverflow.com/questions/7459236/blueimp-jquery-file-upload-passing-extra-form-data)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T21:29:01.170

如果 blueimp 插件不是必需的，我真的会推荐 jquery malsup 表单。

您可以使用常规的多部分表单，只需创建一个常规文件输入字段以及您自己选择的其他输入字段，所有内容都照常提交。

参考： http: [//www.malsup.com/jquery/form/](http://www.malsup.com/jquery/form/)

代码示例：

```
$('#myForm2').submit(function() { 
    $(this).ajaxSubmit(options); 
    return false; 
}); 
```

# sinatra - ActiveSupport::Dependencies.autoload_paths：如何急切加载？

> ID：15647513
> 
> 赞同：7
> 
> 时间：2013-03-26T21:11:53.967
> 
> 标签：sinatra, eager-loading, activesupport

我在 sinatra 项目中使用 ActiveSupport，并遵循一些同行的建议，我一直在使用 ActiveSupport::Dependencies.autoload_paths 来减轻开发中类的加载。现在我正在接近部署日，我不知道如何急切地加载它们。在 Rails 中这很容易：只需设置 config.cache_classes = true 并按照自己的方式行事。但在 Sinatra 应用程序中，我看不到如何急切加载它们。

# asp.net - ASP.net MVC 4 中的自定义角色和用户管理

> ID：15647517
> 
> 赞同：0
> 
> 时间：2013-03-26T21:12:14.060
> 
> 标签：asp.net, asp.net-mvc

我正在asp.net mvc 4上实现我的第一个Web应用程序，我需要根据角色区分我的用户（向某些角色显示某些菜单并将它们隐藏起来）基本上我想要的是管理我的用户和角色。我知道安全性是我的应用程序的一个非常重要的部分，所以我不想通过实施一些不安全的东西来冒险，同时还有其他选项可以做到这一点。

我的问题是，是否已经在 MVC 4 上构建了一些东西？它适合我的小网站吗？（我不希望超过 50 个并发用户）实现我自己的用户管理员会更好吗？如果是这样，我可以从哪里开始？到目前为止，我发现的是会员提供者，但它似乎对我的需要来说相当大，不会有用户注册，而是由系统管理员添加新用户。

感谢您花时间阅读本文，任何反馈将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:16:10.613

我会推荐默认会员提供程序，因为它利用了安全行业的最佳实践（即加盐哈希）。但是，如果这看起来有点过头了，那么有一个更简单的成员资格提供程序，称为[SimpleMembership Provider](http://weblogs.asp.net/jgalloway/archive/2012/08/29/simplemembership-membership-providers-universal-providers-and-the-new-asp-net-4-5-web-forms-and-asp-net-mvc-4-templates.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T21:36:10.910

您可以使用[新的 ASP.NET 通用提供程序](http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx)（旧成员资格提供程序的更新版本）。

它可以用于小型应用程序以及大型应用程序（如果您的应用程序继续增长）。

密码是用盐加密的，所以不容易被破解。

按照 Scott Hanselman 的链接查看演示。您将看到设置多么容易。

# java - 这段代码不是将值插入 SQLite 数据库吗？

> ID：15647525
> 
> 赞同：0
> 
> 时间：2013-03-26T21:12:53.703
> 
> 标签：java, android, sqlite

我正在为android编写一个应用程序。我需要读取一个 txt 文件并将数据写入 SQLite 文件。我已经设法完成了所有代码，但是应该将值插入数据库的部分不起作用。我已经给出了下面的代码：

```
try{
    ContentValues values = new ContentValues();
    values.put(KEY_NAME, firstNumber); // Contact Name
    values.put(KEY_PH_NO, strfinal); // Contact Phone
    // Inserting Row
    db.insert(TABLE_CONTACTS, null, values);
} catch(Exception e) {
    e.printStackTrace();
} 
```

此代码未将值输入数据库，操作完成后数据库仍为空。这有什么问题？谢谢。编辑：好的，这是完整的代码：

```
public class DatabaseHandler extends SQLiteOpenHelper {

        // All Static variables
        // Database Version
        private static final int DATABASE_VERSION = 1;

        // Database Name
        private static final String DATABASE_NAME = "feedsmanager.sqlite";

        // Contacts table name
        private static final String TABLE_CONTACTS = "table_to_hold_all_values";

        // Contacts Table Columns names
        private static final String KEY_ID = "id";
        private static final String KEY_NAME = "name";//ctid
        private static final String KEY_PH_NO = "phone_number";//feedname,address;feedname;address etc
        Context ctx;

        public DatabaseHandler(Context context) {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
            ctx=context;
        }

        // Creating Tables
        @Override
        public void onCreate(SQLiteDatabase db) {

            //Log.d("in onCreate","twitch1");
            String CREATE_CONTACTS_TABLE = "CREATE TABLE " + TABLE_CONTACTS + "("
                    + KEY_ID + " INTEGER PRIMARY KEY," + KEY_NAME + " TEXT,"
                    + KEY_PH_NO + " TEXT);";

            //Log.d("below createcontacts","twitch1");
            try{
            db.execSQL(CREATE_CONTACTS_TABLE);
            }catch(Exception e){Log.d("create went wrong: "+e,"twitch11");}
            //Log.d("below db.execsql","twitch1");
            populate(db);
    }

            void populate(SQLiteDatabase dbs){
            String line="";

            try{
            InputStream is = ctx.getAssets().open("feedtitlesandaddresses.txt");
            InputStreamReader iz=new InputStreamReader(is);
            BufferedReader br = new BufferedReader(iz);
            //SQLiteDatabase dbs = this.getWritableDatabase();
            while((line=br.readLine())!=null) {
                //Log.d("fcked here6","twitch1");
                StringTokenizer stringTokenizer = new StringTokenizer(line, "<");

                String firstNumber="";
                String strfinal="";
                  firstNumber = (String) stringTokenizer.nextElement();
                  **//Calculations to give values to firstNumber and strfinal excluded

                  ContentValues values = new ContentValues();

                  values.put(KEY_NAME, firstNumber); // Contact Name
                  values.put(KEY_PH_NO, strfinal); // Contact Phone
                  // Inserting Row

                  dbs.insert(TABLE_CONTACTS, null, values);}

                dbs.close();}catch(Exception e){Log.d("yeah error is"+e,"twitch12");}
        }} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:20:18.013

尝试放置`this.db.insert(TABLE_CONTACTS, null, values);`。因为几个月前我遇到了同样的问题，这就是解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:21:10.007

而不是 db.insert() ... 使用 db.insertOrThrow()，可能是一些约束错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:24:21.590

你的`db`对象是什么？是`SQLiteDatabase db = this.getWriteableDatabase();`吗？我已经看到有些人使用`getReadAbleDatabase()`i 而不是`getWriteableDatabase()`方法。

# jquery - 使用 (this) 和 next() 修改函数，因此可以与多组元素一起使用

> ID：15647528
> 
> 赞同：0
> 
> 时间：2013-03-26T21:13:03.013
> 
> 标签：jquery, jquery-selectors, this

[下面的函数使用jQuery UI MultiSelect Widget](http://www.erichynds.com/jquery/jquery-ui-multiselect-widget/)动态地将内容添加到多选元素（在此示例中，文本输入到 #newItem 并添加到 #example1，并且基于此['Refresh' 演示](http://www.erichynds.com/examples/jquery-ui-multiselect-widget/demos/#refresh)。

我在 100 多个元素上使用它，因此想修改函数，以便不需要为每个元素指定选择器。我以前都用过`(this)`，`next()`但是这个函数比我以前用过的要复杂一些，我不知道如何修改它以便对整个表单使用相同的选择器。

我在这里发布了一个函数的工作示例：http: [//jsfiddle.net/chayacooper/ezxSF/24/](http://jsfiddle.net/chayacooper/ezxSF/24/)

*JS*

```
$(function () {
    var el = $("#example1").multiselect(),
    selected = $('#selected'),
    newItem = $('#newItem');
    $("#add").click(function () {
        var v = newItem.val(), opt = $('<option />', {
            value: v,
            text: v
        });
        if (selected.is(':checked')) {
            opt.attr('selected', 'selected');
        }
        opt.appendTo(el);
        el.multiselect('refresh');
    });
}); 
```

*HTML*

```
<div>
    <input type="text" id="newItem" />
    <input type="button" id="add" value="Add" />    
    <label><input type="checkbox" id="selected" />Selected?</label>
    <select id="example1" name="example-refresh" class="multiselect" multiple="multiple">
    <option value="foo">foo</option>
    <option value="bar">bar</option>
    </select>    
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:18:19.110

改变这个：

```
<input type="button" id="add" value="Add" /> 
```

上课，所以我们有一个共同的起点

```
<input type="button" class="add" value="Add" /> 
```

然后做 ：

```
$(function () {
    $(".add").click(function () {
      var el       = $(this).siblings('select').multiselect(),
          selected = $(this).siblings('label').find('input[type="checkbox"]'),
          newItem  = $(this).prev('input'),
          v        = newItem.val(), 
          opt      = $('<option />', { value: v, text : v });

      if (selected.is(':checked')) {
          opt.prop('selected', true);
      }
      opt.appendTo(el);
      el.multiselect('refresh');
    });
}); 
```

# php - 我在这里使用函数吗？

> ID：15647532
> 
> 赞同：-1
> 
> 时间：2013-03-26T21:13:34.803
> 
> 标签：php, wordpress

我目前有两个 php 文件，它们设置了 20 个左右的相同变量。巩固这一点以遵守 DRY 原则的最佳方法是什么？我是否在第三个文件中创建函数？还是一堂课？在这种情况下，最佳做法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:15:29.377

您应该创建一个类，然后创建它的多个实例。

# sql - 当不同的值改变时返回一个值

> ID：15647538
> 
> 赞同：2
> 
> 时间：2013-03-26T21:14:02.577
> 
> 标签：sql, oracle, analytic-functions

我有一个查询，它返回以下内容，除了最后一列，这是我需要弄清楚如何创建的。对于每个给定`ObservationID`的，我需要返回状态更改的日期；类似于 LEAD() 函数，它需要条件而不仅仅是偏移量。可以做到吗？

我需要计算列更改日期；它应该是状态不是当前状态的最后日期。

```
+---------------+--------+-----------+--------+-------------+
| ObservationID | Region |   Date    | Status | Change Date | <-This field
+---------------+--------+-----------+--------+-------------+
|             1 |     10 | 1/3/2012  | Ice    | 1/4/2012    |
|             2 |     10 | 1/4/2012  | Water  | 1/6/2012    |
|             3 |     10 | 1/5/2012  | Water  | 1/6/2012    |
|             4 |     10 | 1/6/2012  | Gas    | 1/7/2012    |
|             5 |     10 | 1/7/2012  | Ice    |             |
|             6 |     20 | 2/6/2012  | Water  | 2/10/2012   |
|             7 |     20 | 2/7/2012  | Water  | 2/10/2012   |
|             8 |     20 | 2/8/2012  | Water  | 2/10/2012   |
|             9 |     20 | 2/9/2012  | Water  | 2/10/2012   |
|            10 |     20 | 2/10/2012 | Ice    |             |
+---------------+--------+-----------+--------+-------------+ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:24:27.350

示范条款 (10g+) 可以以紧凑的方式做到这一点：

```
SQL> create table observation(ObservationID ,  Region  ,obs_date,  Status)
  2  as
  3  select  1, 10, date '2012-03-01', 'Ice' from dual union all
  4  select  2, 10, date '2012-04-01', 'Water' from dual union all
  5  select  3, 10, date '2012-05-01', 'Water' from dual union all
  6  select  4, 10, date '2012-06-01', 'Gas' from dual union all
  7  select  5, 10, date '2012-07-01', 'Ice' from dual union all
  8  select  6, 20, date '2012-06-02', 'Water' from dual union all
  9  select  7, 20, date '2012-07-02', 'Water' from dual union all
 10  select  8, 20, date '2012-08-02', 'Water' from dual union all
 11  select  9, 20, date '2012-09-02', 'Water' from dual union all
 12  select 10, 20, date '2012-10-02', 'Ice' from dual ;

Table created.

SQL> select ObservationID, obs_date, Status, status_change
  2            from observation
  3          model
  4          dimension by (Region, obs_date, Status)
  5          measures ( ObservationID, obs_date obs_date2, cast(null as date) status_change)
  6          rules (
  7            status_change[any,any,any] = min(obs_date2)[cv(Region), obs_date > cv(obs_date), status != cv(status)]
  8          )
  9   order by 1;

OBSERVATIONID OBS_DATE  STATU STATUS_CH
------------- --------- ----- ---------
            1 01-MAR-12 Ice   01-APR-12
            2 01-APR-12 Water 01-JUN-12
            3 01-MAY-12 Water 01-JUN-12
            4 01-JUN-12 Gas   01-JUL-12
            5 01-JUL-12 Ice
            6 02-JUN-12 Water 02-OCT-12
            7 02-JUL-12 Water 02-OCT-12
            8 02-AUG-12 Water 02-OCT-12
            9 02-SEP-12 Water 02-OCT-12
           10 02-OCT-12 Ice 
```

小提琴：[http ://sqlfiddle.com/#!4/f6687/1](http://sqlfiddle.com/#!4/f6687/1)

即，我们将在区域、日期和状态上进行标注，因为我们希望查看具有相同区域的单元格，但要获取状态不同的第一个日期。

我们还必须测量日期，所以我创建了一个别名`obs_date2`来做到这一点，我们想要一个新列`status_change`来保存状态更改的日期。

这条线是为我们完成所有工作的线：

```
status_change[any,any,any] = min(obs_date2)[cv(Region), obs_date > cv(obs_date), status != cv(status)] 
```

它说，对于我们的三个维度，只查看具有相同区域的行 ( `cv(Region),`) 并查看日期在当前行日期之后的行 ( `obs_date > cv(obs_date)`) 并且状态与当前行不同 ( `status != cv(status)`)满足这组条件的最小日期 ( `min(obs_date2)`) 并将其分配给`status_change`. `any,any,any`左侧部分表示此计算适用于所有行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T07:23:10.750

我已经尝试了很多次来理解 MODEL 子句，但从来没有真正管理过它，所以我想我会添加另一个解决方案

该解决方案采用了 Ronnis 所做的一些工作，但使用`IGNORE NULLS`了 LEAD 函数的子句。`FIRST_VALUE`我认为这只是 Oracle 11 的新功能，但如有必要，您可以将其替换为 Oracle 10 的功能。

```
select
  observation_id,
  region,
  observation_date,
  status,
  lead(case when is_change = 'Y' then observation_date end) ignore nulls 
    over (partition by region order by observation_date) as change_observation_date
from (
  select
    a.observation_id,
    a.region,
    a.observation_date,
    a.status,
    case 
      when status = lag(status) over (partition by region order by observation_date) 
        then null
        else 'Y' end as is_change
       from observations a
)
order by 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:55:20.343

在清理重叠的起始/截止日期和重复行时，我经常这样做。不过，您的情况要简单得多，因为您只有“起始日期”:)

设置测试数据

```
create table observations(
   observation_id   number       not null
  ,region           number       not null
  ,observation_date date         not null
  ,status           varchar2(10) not null
);

insert 
  into observations(observation_id, region, observation_date, status)
   select 1,  10, date '2012-03-01', 'Ice'   from dual union all
   select 2,  10, date '2012-04-01', 'Water' from dual union all
   select 3,  10, date '2012-05-01', 'Water' from dual union all
   select 4,  10, date '2012-06-01', 'Gas'   from dual union all
   select 5,  10, date '2012-07-01', 'Ice'   from dual union all
   select 6,  20, date '2012-06-02', 'Water' from dual union all
   select 7,  20, date '2012-07-02', 'Water' from dual union all
   select 8,  20, date '2012-08-02', 'Water' from dual union all
   select 9,  20, date '2012-09-02', 'Water' from dual union all
   select 10, 20, date '2012-10-02', 'Ice'   from dual;

commit; 
```

以下查询具有三个兴趣点：

1.  识别重复信息（录音显示与之前的录音相同）
2.  忽略重复的录音
3.  从“下一次”更改中确定日期

.

```
with lagged as(
   select a.*
         ,case when status = lag(status, 1) over(partition by region 
                                                     order by observation_date) 
               then null 
               else rownum 
           end as change_flag -- 1
     from observations a
)
select observation_id
      ,region
      ,observation_date
      ,status
      ,lead(observation_date, 1) over(
         partition by region 
             order by observation_date
      ) as change_date --3
      ,lead(observation_date, 1, sysdate) over(
         partition by region 
             order by observation_date
      ) - observation_date as duration
  from lagged
 where change_flag is not null -- 2
 ; 
```

# arduino - 我可以使用 CAN 总线重新映射 ECU 吗？

> ID：15647539
> 
> 赞同：1
> 
> 时间：2013-03-26T21:14:09.587
> 
> 标签：arduino, protocols, microcontroller, can-bus

我正在考虑使用这样的东西将 Arduino 连接到摩托车 ECU：[http ://www.skpang.co.uk/catalog/arduino-canbus-shield-with-usd-card-holder-p-706.html](http://www.skpang.co.uk/catalog/arduino-canbus-shield-with-usd-card-holder-p-706.html)

我从来没有做过这样的事情，我会知道是否使用 CAN 总线我只能读取 ECU 中的一些诊断参数，或者我是否也可以重新映射一些 ECU 参数。

你能帮我理解这件事吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T06:05:33.433

No, you can not unless you know the specific diagnostic protocol implementation for this bike (usually KWP2000 or UDS), which may or may not support the ECU re flashing.

CAN is just the communication protocol. To do so, you would need to know the seed generation algorithm for security sessions access and then be able to send new data to the ECU. If you had all this information, you would then be able to reflash or remap the ECU. Why would you want to do this anyway?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T12:28:50.490

通过 CAN，您可以主要读取在车辆不同控制模块之间传输的信息。这些消息中的许多都符合独立于制造商的标准，并且可以被视为众所周知的或记录在案的。

但是，也有制造商特定的消息通常不会记录下来供公众访问。控制 ECU 和其他模块配置的消息很可能属于这种类型，被认为是制造商私有的。

因此，用于配置控制模块的消息大多只会由通过逆向工程找出它们的人记录在案。

阅读和解释在总线上定期发送的消息应该不会太困难，只要消息被记录或易于分析即可。这些配置信息很难掌握，考虑到爱好者的手段和工具，可能是不可能的。

# objective-c - Xcode 空白在 git rebase 上搞砸了

> ID：15647541
> 
> 赞同：1
> 
> 时间：2013-03-26T21:14:17.720
> 
> 标签：objective-c, xcode, git, whitespace

在我执行 git rebase 之后，我添加/修改的代码行在相应代码块的左侧缩进四个或更多空格。这是非常烦人且耗时的修复，更不用说它使 Objective-C 无法阅读（想象一下，如果我在 python 中编码......？）

Xcode（或其他什么，git？）添加制表符代替空格，我的 Xcode 设置为制表符空格。

在我的工作中，似乎没有人对它发生的原因有一个很好的答案。我将 trustctime 设为假，但这并没有帮助。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:23:35.320

这可能是空白设置。查看[git-config 手册页](https://www.kernel.org/pub/software/scm/git/docs/git-config.html)`core.whitespace`上的选项。如果你有那个设置以及，那么 git 会对你的空白做一些事情，可能包括在 rebase 期间。`apply.whitespace`

尝试找出什么`git config core.whitespace`和`git config apply.whitespace`是并在您的 ~/.gitconfig 文件中修改它们或使用类似的东西：

```
git config --global apply.whitespace nowarn 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:53:57.843

**更新**
我认为这可能是[git whitespace woes的副本](https://stackoverflow.com/questions/1316364/git-whitespace-woes)
**END UPDATE**

除非您对 git post-commit 钩子或 git config core.whitespace 设置进行了一些自定义（感谢您指出 jesse），否则 git 不会将空格转换为制表符，反之亦然或类似的东西。更改通常是您的环境/文件和合并活动的结果。

在以各种形式处理过这个问题后，我猜你的一些同行正在使用制表符，而一些正在使用空格。人们整天都在争论你是否应该使用制表符或空格，并且取决于我跳边的日子和语言。这不是我要在这里讨论的内容。但是，几乎所有参与这场战争的理性参与者都会同意，无论您选择哪一个，您都需要选择一个并在整个项目中始终如一地使用它。

大多数合理的编辑器允许您控制是否应该插入制表符或空格，我知道 XCode 对此并不陌生。

我建议显示空白或简要使用编辑器，让您查看空白以了解实际差异。另外，在更正整个文件后，您也可以只使用 git diff -w -b 来抑制空白更改。也就是说，您应该真正弄清楚到底是什么导致您的空白在变基上发疯，因为这表明我很可能 git 被混合使用弄糊涂了，并且多人在多个点以不同的分辨率更正它。

祝你好运，这绝非易事，当他们的奶酪被移动时，总会有人不高兴。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-28T23:14:32.357

我不知道我的 git-config 是什么问题，但是在清除它并重新设置后，问题就解决了。我没有旧的 git-config :( 这发生在几个月前，但我想我会表示这与 xcode 无关。

# ruby-on-rails-3 - Uploadify - 如何递归上传文件夹的内容

> ID：15647542
> 
> 赞同：1
> 
> 时间：2013-03-26T21:14:18.093
> 
> 标签：ruby-on-rails-3, paperclip, uploadify

我需要递归上传文件夹中的文件。

是否可以使用 Uploadify 通过选择文件夹而不是选择文件夹中的单个文件来递归地上传文件夹的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T15:35:34.853

我不这么认为。浏览器控制着文件选择对话框（不允许您选择文件夹，只能选择文件）。

*付费Uploadifive（HTML 5版本）的文件拖拽功能我没试过，但它可能支持拖拽文件夹。不确定 HTML 5 允许通过拖放实现什么*

# javascript - 在 JavaScript 中对同一个变量多次使用 var 是否有缺点

> ID：15647544
> 
> 赞同：12
> 
> 时间：2013-03-26T21:14:28.090
> 
> 标签：javascript

在问我的问题之前，让我先声明一下。我知道做什么`var`，我知道块作用域，我知道变量提升。我不是在寻找有关这些主题的答案。

我只是想知道在函数中多次对同一个变量使用变量声明是否会产生功能、内存或性能成本。

这是一个例子：

```
function foo() {
  var i = 0;
  while (i++ < 10) {
    var j = i * i;
  }
} 
```

前一个可以很容易地用`j`顶部声明的变量编写：

```
function foo() {
  var i = 0, j;
  while (i++ < 10) {
    j = i * i;
  }
} 
```

我想知道这两种方法之间是否有任何实际区别。换句话说，`var`关键字除了建立范围之外还有什么作用吗？

我听说更喜欢第二种方法的原因：

1.  第一种方法在实际上是函数作用域时给出了块作用域的外观。
2.  变量声明被提升到范围的顶部，因此应该在此处定义它们。

我认为这些理由很好，但主要是风格上的。还有其他与功能、内存分配、性能等有关的原因吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T21:36:15.127

In [JavaScript - The Good Parts](https://rads.stackoverflow.com/amzn/click/com/0596517742) Douglas Crockford 建议通过使用第二种方法并在其作用域的顶部声明变量，您将更容易避免作用域错误。

这些通常是由`for`循环引起的，并且非常难以追踪，因为不会引发错误。例如;

```
function() {
  for ( var i = 0; i < 10; i++ ) {
    // do something 10 times
    for ( var i = 0; i < 5; i++ ) {
      // do something 5 times
    }
  }
} 
```

当变量被提升时，我们最终只有一个`i`。因此第二个循环覆盖了这个值，给了我们一个无限循环。

在处理函数提升时，你也会得到一些奇怪的结果。举个例子：

```
(function() {
  var condition = true;
  if(condition) {
    function f() { console.log('A'); };
  } else {
    function f() { console.log('B'); };
  }
  f(); // will print 'B'
})(); 
```

这是因为函数体被提升并且第二个函数覆盖了第一个函数。

因为搜索这样的错误很困难，而且不管任何性能问题（我很少关心几微秒），我总是在范围的顶部声明我的变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T21:23:15.950

There will not be any differences during *execution time*. There might be a imperceptibly small difference in interpretation/compilation time, but that of course will be implementation dependent. There also might be a few bytes different in the size of the file, which could also affect download time. I don't think either of these are worth being bothered about.

As you already know, any variable declaration will be hoisted to the top of the function. The important thing to note is that **this occurs during the interpretation/compilation process, not during execution.**

Before a function is executed, the function *must* be parsed. After each function is parsed, they will both have all of the variable declarations moved to the top, which means that they will be identical and there will be no execution time cost incurred.

For the same reason, there are no memory cost differences. After parsing, there will be *no differences at all*.

* * *

Since you are not asking about style I am not telling you which I think is better. But I will say that the only reason you should prefer one over the other is style.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-26T21:33:27.703

# 风格

*主观*的。我更喜欢`var` *靠近*使用站点的方法，但我始终牢记范围规则。我也*避免*将多个声明组合成一个`var`，而是更喜欢多个`var`语句。

# 内存分配

变量不是对象：*不*适用。由于提升规则，变量“slot”在所有情况下都具有相同的生命周期。

# 表现

不，在性能方面*应该没有区别*。虽然从技术上讲，一个实现可能真的把这搞砸了——但他们没有。

回答这个问题的唯一方法（除了查看细节中的每个实现）是[使用 benchmark](http://jsperf.com/hoist-performance-2)。

结果：现代浏览器上的噪音差异

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T21:26:01.367

第二种方法将 4 个字符保存在 javascript 文件中 - 但就实际代码生成或执行速度而言，我认为根本没有任何区别。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-26T21:24:31.487

您的示例将完全一样。不过，在块中使用“var”可能比您的示例更不清楚。例如，您想有条件地更新范围之外的变量（不使用“var”），或者改用本地“var”。即使该条件为假，“j”也会成为本地的。事实证明，它并不像看起来那样微不足道。

```
var j = 1;
function foo () {
    j = 2;
    if (false) {
        var j = 3; // makes `j = 2` local simply for being in the same function
    }
    console.log(j);
}
foo(); // outputs 2
console.log(j); // outputs 1 
```

这是一个棘手的案例，仅通过查看代码可能无法按预期工作。

在顶部声明每个 'var' 没有缺点，只有优点。

# php - Joomla 使用 JInput 检查空字符串

> ID：15647545
> 
> 赞同：4
> 
> 时间：2013-03-26T21:14:42.217
> 
> 标签：php, joomla, joomla2.5

按照本[指南](http://docs.joomla.org/Retrieving_request_data_using_JInput)清理我的输入，我想知道这个是否包含空字符串？

```
$jinput = JFactory::getApplication()->input;
$this->name = $jinput->get('name', '', 'STRING'); 
```

通常如果没有 Joomla，我也会检查空字符串。就像是：

```
if (!empty($_POST['name'])) 
```

查看 JInput get 方法，我看到它检查它是否是`isset`：

```
public function get($name, $default = null, $filter = 'cmd')
{
    if (isset($this->data[$name]))
    {
        return $this->filter->clean($this->data[$name], $filter);
    }

    return $default;
} 
```

不是一回事，因为`isset`只会检查null。但是，这是使用 get 方法的默认值。因此，如果我为第二个参数指定一个空字符串，我会在这里介绍吗？

```
$this->name = $jinput->get('name', '', 'STRING'); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T22:08:23.393

Joomla 不能决定您的空字符串是否为有效值。他们必须使用`isset()`，因为如果他们会使用`empty()`并且您返回`'0'`您所期望的正常值，Joomla 将返回默认值而不是`'0'`.

因此，他们只是`isset()`用来检查是否设置了变量是完全正常的，并且由您决定接受哪些值。

如果未设置该值，并且您将其设置为第二个参数 empty string `''`，则会返回一个空字符串。

在您的示例中，将返回一个空字符串，这是预期的行为。

# c++ - 从函数 C++ 返回一个对象

> ID：15647552
> 
> 赞同：-1
> 
> 时间：2013-03-26T21:15:09.257
> 
> 标签：c++, function, computer-science

假设我有一个变量指向我制作的对象。对于这个例子，假设我有一个代表一张卡片的对象，它有 2 个成员 - 等级和花色。

接下来，假设我初始化了我创建的对象结构，所以我现在有一个带有等级和花色的卡片对象。

我的问题是，如果我想要一个返回我创建的卡片对象的函数怎么办：我想做这样的事情：

```
Card* playerCard = foo() 
```

我知道 playerCard 指向一个卡片对象，那么这是否意味着 foo() 也必须返回一个卡片对象？有没有另一种方法来解决这个问题？

基本上我希望我的函数生成卡片，并且 playerCard 应该等于生成的卡片。我不知道返回一个对象是否是解决问题最直接的方法，这就是为什么我还要询问是否有任何替代解决方案。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-26T21:19:17.143

我将逐步从坏方法变为好方法。

首先，这是错误的做法：

```
Card* foo() {
  Card c;
  return &c;
} 
```

绝对不要那样做。将`Card` `c`在结束时被销毁，`foo`因此您返回的指针将指向无效对象。

你*可以*这样做：

```
Card* foo() {
  return new Card();
} 
```

由创建的卡片`new Card()`具有动态存储时长，因此它不会在结束时被销毁`foo`。因此返回的指针仍然指向该卡。然后，您可以使用指针并确保安全。

然而，这还有另一个缺点。调用 的人不清楚`foo`，但他们现在负责处理`delete`返回的指针以确保没有内存泄漏。相反，最好使用智能指针清楚地将所有权传递给调用者：

```
std::unique_ptr<Card> foo() {
  return std::unique_ptr<Card>(new Card());
} 
```

但是，如果您根本不需要动态分配，那就更好了。为什么不直接返回`Card`并让它从函数中复制出来呢？你可以这样做：

```
Card foo() {
  return Card();
} 
```

然后，您可以像这样调用函数，而不是分配给指针：

```
Card c = foo(); 
```

当然，这取决于您允许这样做的要求。如果要以`Card*`多态方式使用，则需要使用其中一种指针方法。否则，你最终会分割你的`Card`衍生品。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T21:19:28.807

您正在返回指向那里的对象的指针，而不是对象。

我不确定你的问题到底是什么，所以我会给你一个完整的例子：

```
struct card {int rank; int suit};

card make_a_card() {
   return card{10,3};
}

int main() {
    card a_card = make_a_card();
    // a_card == card{10,3}
} 
```

您很少希望从函数返回原始指针。速度不是必需的（事实上，由于 RVO 和移动语义，它实际上最终可能会变慢），因此除了运行时多态性（即对于工厂方法）之外，几乎没有理由这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:19:14.833

如果函数 foo() 返回一个指向已经创建的 Card 对象的指针，那么为它分配一个 Card 指针应该可以正常工作。重要的是要记住，您实际上是在传递**同一张卡片**，而不是副本或任何东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T21:18:33.507

如果您想返回一个指针，您可以使用动态内存分配，否则您的指针在执行后将指向任何内容`foo`（请参阅[*悬空指针*](http://en.wikipedia.org/wiki/Dangling_pointer)）：

```
Card* foo() {
    Card* ret = new Card(...);
    ...
    return ret;
} 
```

上述代码的另一个版本将使用[`std::unique_ptr`](http://en.cppreference.com/w/cpp/memory/unique_ptr)标准库中的代码，以使您的代码的客户端程序员清楚您正在返回一个动态分配的指针。它是一个智能指针，因此它将在其作用域的末尾自动释放自己（不在函数末尾，因为它被复制到调用块）。

否则，如果您的对象/结构复制成本不高，您可以按值返回它，从而导致复制：

```
Card foo() {
    Card ret(...);
    ...
    return ret;
} 
```

# msbuild - 用于 app.config 转换的 SlowCheetah - 安装后转换不是选项

> ID：15647558
> 
> 赞同：1
> 
> 时间：2013-03-26T21:15:20.940
> 
> 标签：msbuild, slowcheetah

我可能做错了什么，但在解决方案中安装最新的 Nuget 包后，我看不到任何转换 app.config 或其他 XML 文档的选项。我尝试了两种解决方案，一种是 MVC 应用程序，另一种是控制台应用程序。两者都没有提供任何额外的转换。我打开 MVC 应用程序的项目文件并查看 SlowCheetah 定义和导入语句。在 Label="SLowCheetah" 的属性组中发现了将 SC_ 扩展为 SlowCheetah_ 的错误。

我正在为这组项目使用 Visual Studio 2010 sp1。

# html - 如何摆脱此页面上的滚动条并保持全宽？

> ID：15647563
> 
> 赞同：0
> 
> 时间：2013-03-26T21:15:54.583
> 
> 标签：html, width, scrollbar

我正在尝试摆脱此页面上的滚动条： [http ://opportunityfinance.net/Test/2013conf/](http://opportunityfinance.net/Test/2013conf/)

无论内容有多宽，水平滚动条似乎始终存在。这里有什么问题？将宽度设置为100%，为什么我在页面底部看到一个滚动条？

请帮助...谢谢伙计们/姑娘们:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:20:32.877

您的页脚有一个不为零的填充（index.css 中的第 115 行）。这就是为什么它使页面宽度超过 100%。将其更改为填充：0；

```
.footer {
 ...
 padding: 1.5em;
 ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:28:04.560

从包含“赞助机会”`.footer`的内容中删除填充`<div>`

# mysql - mysql表创建中的烦人错误

> ID：15647566
> 
> 赞同：-1
> 
> 时间：2013-03-26T21:16:00.490
> 
> 标签：mysql, database

嗨所以我有以下语句，我想用它来创建一个 mysql 表。

```
CREATE TABLE `users` (  
`UserID` INT(25) NOT NULL AUTO_INCREMENT PRIMARY KEY ,  
`Username` VARCHAR(65) NOT NULL ,  
`Password` VARCHAR(32) NOT NULL ,  
`EmailAddress` VARCHAR(255) NOT NULL  
);  
CREATE TABLE `profile` (
`UserID` INT(25) NOT NULL AUTO_INCREMENT PRIMARY KEY ,
`Username` VARCHAR(65) NOT NULL ,
`Position1` VARCHAR(65) NOT NULL ,
`Position2` VARCHAR(65) NOT NULL ,
`Position3` VARCHAR(65) NOT NULL ,
`champion1` VARCHAR(65) NOT NULL ,
`champion2` VARCHAR(65) NOT NULL ,
`champion3` VARCHAR(65) NOT NULL ,
`Level` INT(2) NOT NULL,
`League` VARCHAR(65) NOT NULL ,
`Leaguename` VARCHAR(65) NOT NULL,
`lolking` VARCHAR(65) NOT NULL,
`Bio` VARCHAR(140) NOT NULL,
); 
```

但它没有这样做并给我错误消息：

```
ERROR 1064 (42000) at line 8: You have an error in your SQL syntax; check the manual      that corresponds to your MySQL server version for the right syntax to use near ')' at line 16 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T21:17:19.857

去掉最后一个逗号

```
`Bio` VARCHAR(140) NOT NULL 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T21:18:21.470

你有一个逗号“，”它不应该是：

```
 `Bio` VARCHAR(140) NOT NULL,
 ); 
```

# html - 覆盖链中的类？

> ID：15647567
> 
> 赞同：0
> 
> 时间：2013-03-26T21:16:01.980
> 
> 标签：html, css

我有以下内容：

```
.mainClass a.customizeIt span {
background: transparent url('../images/myimage.png') no-repeat;
color: #ffffff;
display: block;
font-size: 13px;
} 
```

有没有办法做上面的另一个版本，所以不使用背景图像？

```
.mainClass a.customizeIt span {
color: #ffffff;
display: block;
font-size: 13px;
} 
```

元素中应该如何引用第二个版本？

-- 编辑 --
以下是否可能，所以没有背景，我可以重用颜色、显示和字体大小？

```
.mainClass a.customizeIt a.no-bg span {
background: none;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:20:03.810

您需要将背景设置为无，否则它只会从上一个类继承它。

```
.mainClass a.customizeIt span {
    background: none;
    color: #ffffff;
    display: block;
    font-size: 13px;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T00:45:02.673

这是你主要的吗？

html

```
<a class="customizeIt" href="#"><span>sample1</span></a> 
```

*`no-bg`在要删除背景图像的部分中使用了类，如下所示*

```
<a class="customizeIt no-bg" href="#"><span>sample2</span></a> 
```

css

```
.mainClass a.customizeIt span {
background: transparent url('../images/myimage.png') no-repeat;
color: #fff;
display: block;
font-size: 13px;
}

.mainClass a.no-bg span {background-image:none !important} 
```

# ruby-on-rails - Rails：关于多态关联的问题

> ID：15647571
> 
> 赞同：0
> 
> 时间：2013-03-26T21:16:17.600
> 
> 标签：ruby-on-rails, activerecord, associations

我正在使用 4 个模型：Base、Stat、Feature 和 Element。

一个基地有很多统计数据，有很多特征或有很多元素，但只有三者中的一个（例如，基地不会有很多统计数据并且有很多特征）。

这些模型之间的关联会是什么样子？我正在努力实现的目标是可能的吗？如果可能的话，我想避免这样的事情：

```
Base
has_many :stats
has_many :features
has_many :elements 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:19:53.327

好吧，我的看法是：

*   基地有许多州
*   FeaturedBase 继承自 Base 并且有很多特性
*   ElementBase 继承自 Base 并且有很多元素

但这并不是真正的 Rails 问题，而是 OODesign 问题。

# sql - NULL 有数据类型吗？

> ID：15647580
> 
> 赞同：11
> 
> 时间：2013-03-26T21:16:52.590
> 
> 标签：sql, sql-server, tsql, null

我今天遇到了类似的代码。

```
SELECT AuditDomain, 
    ObjectId,
    AuditSubdomain = CONVERT(VARCHAR(50), NULL),
    SubDomainObjectId = CONVERT(INT, NULL)
FROM Audit 
```

这似乎暗示数据类型信息可以与 NULL 值相关联。这是否将元数据附加到将其标识为指定数据类型的 NULL 值？

[这篇文章](https://stackoverflow.com/questions/447944/sql-server-2005-determine-datatype-of-variable)详细介绍了一种在 Sql Server 中查找数据类型的方法，但是当我尝试以下行时，它返回为 NULL：

```
SELECT CAST(SQL_VARIANT_PROPERTY(CONVERT(INT, NULL), 'BaseType') AS VARCHAR(20)) 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-26T21:24:57.297

在 SQL Server中，默认情况下在我能想到的所有场景中都是一个`NULL`。`INT`您可以使用以下代码确定这一点：

```
SELECT x = NULL INTO #x;
EXEC tempdb..sp_columns '#x'; 
```

结果：

```
TABLE_QUALIFIER TABLE_OWNER TABLE_NAME COLUMN_NAME DATA_TYPE TYPE_NAME
--------------- ----------- ---------- ----------- --------- ---------
tempdb          dbo         #x___...   x           4         int 
```

在您将其放入表格或以其他方式将其与一些上下文元数据相关联之前，这对您有什么好处？`INT`它有什么区别`DATETIME`呢？你将如何处理这些信息？

`SQL_VARIANT_PROPERTY`返回`NULL`，因为它似乎需要元数据*和*值才有意义。观察（使用不同的类型只是为了混合）：

```
SELECT SQL_VARIANT_PROPERTY(NULL, 'BaseType');

DECLARE @x DATE;

SELECT SQL_VARIANT_PROPERTY(@x, 'BaseType');

DECLARE @y DATE = SYSDATETIME();

SELECT SQL_VARIANT_PROPERTY(@y, 'BaseType'); 
```

结果：

```
NULL

NULL

date 
```

所以它似乎需要一个类型*和*一个值才能准确地确定基本类型。

至于它为什么会这样工作，*耸耸肩*。您必须询问具有源代码访问权限的人。

请注意，`NULL`只有在您强制 SQL Server 使用时才需要采用基本类型：您已经基于它创建了一个表。在这种情况下，SQL Server 很可能会返回错误（实际上在许多情况下，它必须猜测您所指的数据类型）。避免这种情况的方法是不要创建 SQL Server 必须猜测的情况（这就是为什么我问，你将如何处理这些信息？）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:47:28.727

Null 没有数据类型。null 的目的是在值和类型上表示“未知”。

ISNULL() 返回第一个参数的数据类型以及提供给它的数据类型。

[http://msdn.microsoft.com/en-us/library/ms187928.aspx](http://msdn.microsoft.com/en-us/library/ms187928.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:09:29.187

我知道您已经有了一些好的答案，但我认为 SQL_VARIANT_PROPERTY 被误解了。

您将 SQL_Variant_Property 与列一起使用，然后在其元数据属性上指示您想要什么。但是，如果它为空，它不会告诉你太多。

例如：

```
declare 
    @Start date = getdate()
,   @End datetime= getdate()
,   @Int int = 1
,   @DateNull date
;

select 
    sql_variant_property(@Start, 'BaseType')
,   sql_variant_property(@End, 'BaseType')
,   sql_variant_property(@Int, 'BaseType')
,   sql_variant_property(@DateNull, 'BaseType') 
```

将返回三个数据类型和一个空值。处理 NULL 是 SQL 的重要组成部分。很多人，包括我自己，有时都想用一个值来处理 null 来表示它，或者在其他时候不在乎。SQL Variant 仅适用于带有参数的填充值：'BaseType'，否则它将返回 null。据我所知，这是由于 SQL 说：“你这里没有数据，没有什么可确定的内存使用情况。”

通常我会在使用整数时指定 isnull(@thing, 0) 如果我明确希望数据集包含未知数的零。在其他时候，我可能希望让用户知道 null 出现对报告做了其他 isnull(@thing, 'not present') 的事情。还有一些时候，你可以使用 coalesce 来处理一系列可能性，coalesce(@thing, @otherthing, @yetotherthing, 'unknown')。

我认为在代码中，当我不确定您真正需要在哪里做这样的事情时，您正在目睹某人正在转换某些东西。表中列的数据类型被维护为它需要的数据类型，当它为 NULL 时 SQL 不会在其中存储内存。因此，恕我直言，需要更改它似乎是任意的。我确实知道，当您期望使用我相信在 SQL 2008 中引入的 SPARSE 选项有更多空值时，您可以处理更好的内存消耗。但我不知道何时将几乎不消耗任何东西的东西转换为更多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-17T15:07:37.347

当然 NULL 具有数据类型。尝试下一个代码以确认：

```
SELECT 
  CAST(NULL AS date) AS c1,
  CAST(NULL AS time) AS c2
INTO #x;
EXEC tempdb..sp_columns '#x'; 
```

而且我认为 SQL_VARIANT 实现中存在错误，因为它丢失了有关 NULL 类型的信息。太糟糕了！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-20T14:06:38.823

我不同意@aaron-bertrand。由于默认情况下 SQl 服务器创建了具有整数数据类型的列来存储 NULL 值，因为 Null 可以插入到 Int、Datetime、Date、Varchar 任何其他列中。

当使用 SELECT x = NULL INTO #x; 在表中插入 Null 时

SQl 服务器默认创建整数类型列，因为可以将 Null 插入 Integer 列。

***所以可能是由于我们编写的查询的性质“SELECT x = NULL INTO #x;” 这使列成为整数并放入 NULL 值。***

# javascript - 将字段值从一个字段复制到另一个字段

> ID：15647581
> 
> 赞同：0
> 
> 时间：2013-03-26T21:17:00.040
> 
> 标签：javascript, html, input, copy, field

我需要在同一页面上的另一个表单中将两个字段值从两个单独的字段复制到它们对应的字段。

输入栏：名字 输入栏：姓

将这些值复制到：

输入字段：账单名字 输入字段：发货名字

我尝试了以下代码无济于事，我从另一个网站上破解了它，该网站有一个相同的复选框，在我的情况下，有一个表格用于输入客户的名字，姓氏和电子邮件，然后客户点击继续按钮，然后加载下一个表单，此表单是我想根据初始表单自动填写名字/姓氏的地方。

这是我在文档中使用的代码。

```
<script type = "text/javascript">
function FillBilling(f) {
  if(f.dispatch[checkout.update_steps].submit == true) {
    f.user_data[firstname].value = f.user_data[b_firstname].value;
    f.user_data[lastname].value = f.user_data[b_lastname].value;
  }
}
</script> 
```

这些字段是默认生成的，不幸的是我无法更改 ID 或名称值。

名：

```
<input type="text" class="input-text " value="" size="32" name="user_data[firstname]" id="elm_6"> 
```

姓：

```
<input type="text" class="input-text " value="" size="32" name="user_data[lastname]" id="elm_7"> 
```

继续按钮：

```
<input type="submit" value="Continue" name="dispatch[checkout.update_steps]"> 
```

计费名：

```
<input type="text" class="input-text " value="" size="32" name="user_data[b_firstname]" id="elm_14"> 
```

帐单姓氏：

```
<input type="text" class="input-text " value="" size="32" name="user_data[s_firstname]" id="elm_16"> 
```

我认为，但可能是错误的，因为继续提交按钮的名称包含一个点 (dispatch[checkout.update_steps])，这会破坏 Javascript，但我不确定。

我还注意到“名字”、“姓氏”字段和“继续”按钮位于单独的表单上，数据通过 Ajax 发送到同一页面上的第二个表单。第一个表单具有 name="step_one_contact_information_form"，第二个表单（Billing First Name、Billing Last Name）具有 name="step_two_billing_address"。

有任何想法吗？

谢谢你的建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:59:01.353

尝试这样的事情：

将 onclick 事件添加到您的按钮（最好使用事件侦听器，但以下方式也可以）

```
<input type="submit" value="Continue" name="dispatch[checkout.update_steps]" onclick="return fillBilling()"> 
```

并改变你的功能看起来做这样的事情：

```
function fillBilling() {
    document.getElementsByName("user_data[b_firstname]")[0].value = document.getElementsByName("user_data[firstname]")[0].value;
    document.getElementsByName("user_data[s_firstname]")[0].value = document.getElementsByName("user_data[lastname]")[0].value;
    return false;
} 
```

`document.getElementByID("elm_[x]")`如果 id 始终相同，则可以使用（将 [x] 替换为它们各自的 ID）

另外，我建议将按钮更改为键入“按钮”，因此如果您不打算使用它来提交表单：

```
<input type="button"... /> 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:28:18.457

我建议你用 jQuery 来做。这很简单，我为你做了这个：http: [//jsfiddle.net/FPsdy/1/](http://jsfiddle.net/FPsdy/1/)

以下是代码示例：

```
$('input[type=submit]').click(function(){
   $('#elm_14').val($('#elm_6').val());
   $('#elm_16').val($('#elm_7').val());
}); 
```

# kendo-ui - 剑道日期选择器在动画期间显示两个月

> ID：15647583
> 
> 赞同：0
> 
> 时间：2013-03-26T21:17:05.930
> 
> 标签：kendo-ui

使用 Kendo 日期选择器，当我们转换月份时，我们会看到两个月堆叠在一起。有没有其他人看过这个？它发生在Firefox和Chrome中。

```
$(".datepicker").kendoDatePicker();

From <input type="text" id="OrderDateFrom" class="datepicker" name="OrderDateFrom" /> 
```

转换完成后，它看起来又正常了。

更新：Kendo UI Web v2013.1.319，Windows 7 操作系统使用最新版本的 Firefox、Chrome、IE 9 和 10、JQuery 1.9.1、HTML5、MVC 2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-08-26T04:31:23.747

如果您使用的是引导程序，则意味着它将影响您的剑道 datepicker 表。在 css 下面添加

```
 #datepickerid_dateview table.k-content
        {
            border-collapse: inherit;
        } 
```

datepickertid 是您的日期选择器名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T15:10:33.500

kendoDatePicker 插件动态创建的表格元素不能应用任何`clear`CSS 规则。IE：`clear: both;`

# java - 清除位图和画布

> ID：15647589
> 
> 赞同：0
> 
> 时间：2013-03-26T21:17:30.213
> 
> 标签：java, android, bitmap, android-canvas

有人知道如何清除位图和画布吗？我认为 somewere 是错误的或不完整的代码。例如，在 public void forceRedraw() 的 FirstActivity.java 上，我收到一条消息以在 invalidate() 上创建方法。如果您需要其他课程，请告诉我。我真的不知道我的错误在哪里。我正在使用以下代码。它有点大，但希望能理解它。

这是我的 FirstActivity.java

```
public class FirstActivity extends Activity implements ColorPickerDialog.OnColorChangedListener {

Paint mPaint;
private Paint paint = new Paint();
private Path path = new Path();
CanvasView myView;

static LinearLayout ll;
ImageView imageViewLine;
ImageView imageViewRectangle;
private ImageView imageViewErase;
private ImageView imageViewFreehand;
private ImageView imageViewUndo;
private ImageView imageViewRedo;

private final int CONTEXT_MENU_LINES_ID = 1;
private final int CONTEXT_MENU_SHAPES_ID = 2;
private final int CONTEXT_MENU_COLOR_ID = 3;

private IconContextMenu iconContextMenuLine = null;
private IconContextMenu iconContextMenuShapes = null;
private IconContextMenu iconContextMenuColors = null;

private final int MENU_ITEM_1_ACTION = 1;
private final int MENU_ITEM_2_ACTION = 2;
private final int MENU_ITEM_3_ACTION = 3;
private final int MENU_ITEM_4_ACTION = 4;
private final int MENU_ITEM_5_ACTION = 5;
private final int MENU_ITEM_6_ACTION = 6;
private final int MENU_ITEM_7_ACTION = 7;
private final int MENU_ITEM_8_ACTION = 8;

private ImageView imageViewText;

private ImageView imageViewColor;

private File folderAppointment;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.first_activity);

    initContextMenus();

    myView = (CanvasView)this.findViewById(R.id.canvasView);

    ll = (LinearLayout) this.findViewById(R.id.linearLayout2);
    ll.setVisibility(LinearLayout.GONE);

    imageViewLine = (ImageView)this.findViewById(R.id.imageViewLine);
    imageViewLine.setOnClickListener(new OnClickListener() {

        @SuppressWarnings("deprecation")
        public void onClick(View v) {
            Toast.makeText(getApplicationContext(), "Line tool clicked", Toast.LENGTH_SHORT).show();
            myView.setMode(1); //draw line
            myView.setOnTouchListener(myView.drawLineListener);
            showDialog(CONTEXT_MENU_LINES_ID,null);
        }
    });

    imageViewRectangle = (ImageView)this.findViewById(R.id.imageViewSquare);
    imageViewRectangle.setOnTouchListener(new OnTouchListener() {

        @SuppressWarnings("deprecation")
        public boolean onTouch(View v, MotionEvent event) {
            if(event.getAction() == MotionEvent.ACTION_DOWN)
            {
                Toast.makeText(getApplicationContext(), "Rectangle tool clicked", Toast.LENGTH_SHORT).show();
                myView.setMode(5); //draw rectangle
                showDialog(CONTEXT_MENU_SHAPES_ID,null);
                return true;
            }
            return false;
        }
    });

    imageViewErase = (ImageView)this.findViewById(R.id.imageViewEraser);
    imageViewErase.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            Toast.makeText(getApplicationContext(), "Eraser tool clicked", Toast.LENGTH_SHORT).show();
            myView.setMode(6); //eraser

        }
    });

    imageViewFreehand = (ImageView)this.findViewById(R.id.imageViewSquiggle);
    imageViewFreehand.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            Toast.makeText(getApplicationContext(), "Squiggle tool clicked", Toast.LENGTH_SHORT).show();
            myView.setMode(7);//free hand draw

        }
    });

    imageViewUndo = (ImageView)this.findViewById(R.id.imageViewUndo);
    imageViewUndo.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            Toast.makeText(getApplicationContext(), "Undo tool clicked", Toast.LENGTH_SHORT).show();
            myView.setMode(9);//undo

        }
    });

    imageViewRedo = (ImageView)this.findViewById(R.id.imageViewRedo);
    imageViewRedo.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            Toast.makeText(getApplicationContext(), "Redo tool clicked", Toast.LENGTH_SHORT).show();
            myView.setMode(10);//redo

        }
    });

    imageViewText = (ImageView)this.findViewById(R.id.imageViewText);
    imageViewText.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            Toast.makeText(getApplicationContext(), "Text tool clicked", Toast.LENGTH_SHORT).show();
            myView.setMode(8);//text input
        }
    });

    imageViewColor = (ImageView)this.findViewById(R.id.imageViewColor);
    imageViewColor.setOnClickListener(new OnClickListener() {

        @SuppressWarnings("deprecation")
        public void onClick(View v) {
            Toast.makeText(getApplicationContext(), "Select color", Toast.LENGTH_SHORT).show();
            //myView.setMode(5); //draw rectangle
            showDialog(CONTEXT_MENU_COLOR_ID,null);

        }
    });

 }

@SuppressWarnings("deprecation") // to be optimized using switch instead of nested if-s
protected Dialog onCreateDialog(int id) {
    if (id == CONTEXT_MENU_LINES_ID) {
        return iconContextMenuLine.createMenu("Lines");
    }
    else if(id == CONTEXT_MENU_SHAPES_ID){
        return iconContextMenuShapes.createMenu("Shapes");
    }
    else if(id == CONTEXT_MENU_COLOR_ID){
        return iconContextMenuColors.createMenu("Choose color");
    }
    return super.onCreateDialog(id);
}

public  void initContextMenus(){
    Resources res = getResources();
    //init icon context menu
    iconContextMenuLine = new IconContextMenu(this, CONTEXT_MENU_LINES_ID);
    iconContextMenuLine.addItem(res, "", R.drawable.line, MENU_ITEM_2_ACTION);
    iconContextMenuLine.addItem(res, "", R.drawable.linie_taiata, MENU_ITEM_4_ACTION);

    iconContextMenuLine.setOnClickListener(new IconContextMenu.IconContextMenuOnClickListener() {
        public void onClick(int menuId) {
            switch(menuId) {

            case MENU_ITEM_2_ACTION:
                Toast.makeText(getApplicationContext(), "You've clicked normal line", Toast.LENGTH_SHORT).show();
                myView.setNormalLine();
                myView.setMode(1); //draw line
                break;
            case MENU_ITEM_4_ACTION:
                Toast.makeText(getApplicationContext(), "You've clicked dashed line", Toast.LENGTH_SHORT).show();
                myView.setDashLine();
                myView.setMode(2);//draw  dashed line
                break;

            }
        }
    });

    iconContextMenuShapes = new IconContextMenu(this, CONTEXT_MENU_SHAPES_ID);
    iconContextMenuShapes.addItem(res, "", R.drawable.cerc,MENU_ITEM_1_ACTION);
    iconContextMenuShapes.addItem(res, "",R.drawable.square, MENU_ITEM_2_ACTION);

    iconContextMenuShapes.setOnClickListener(new IconContextMenu.IconContextMenuOnClickListener() {
        public void onClick(int menuId) {

            switch(menuId) {

            case MENU_ITEM_1_ACTION:
                Toast.makeText(getApplicationContext(), "You've clicked circle", Toast.LENGTH_SHORT).show();
                myView.setMode(4); //draw circle
                break;
            case MENU_ITEM_2_ACTION:
                Toast.makeText(getApplicationContext(), "You've clicked rectangle", Toast.LENGTH_SHORT).show();
                myView.setMode(5); //draw  rectangle
                break;

            }
        }
    });

    iconContextMenuColors = new IconContextMenu(this, CONTEXT_MENU_SHAPES_ID);
    iconContextMenuColors.addItem(res, "", R.drawable.red,MENU_ITEM_1_ACTION);
    iconContextMenuColors.addItem(res, "",R.drawable.green, MENU_ITEM_2_ACTION);
    iconContextMenuColors.addItem(res, "",R.drawable.blue, MENU_ITEM_3_ACTION);
    iconContextMenuColors.addItem(res, "", R.drawable.magenta,MENU_ITEM_4_ACTION);
    iconContextMenuColors.addItem(res, "",R.drawable.yellow, MENU_ITEM_5_ACTION);
    iconContextMenuColors.addItem(res, "",R.drawable.white, MENU_ITEM_6_ACTION);
    iconContextMenuColors.addItem(res, "", R.drawable.black,MENU_ITEM_7_ACTION);
    iconContextMenuColors.addItem(res, "", R.drawable.black,MENU_ITEM_8_ACTION);

    iconContextMenuColors.setOnClickListener(new IconContextMenu.IconContextMenuOnClickListener() {
        public void onClick(int menuId) {

            switch(menuId) {

            case MENU_ITEM_1_ACTION:
                Toast.makeText(getApplicationContext(), "Red", Toast.LENGTH_SHORT).show();
                myView.changeColor(Color.RED);

                break;
            case MENU_ITEM_2_ACTION:
                Toast.makeText(getApplicationContext(), "Green", Toast.LENGTH_SHORT).show();
                myView.changeColor(Color.GREEN);
                break;

            case MENU_ITEM_3_ACTION:
                Toast.makeText(getApplicationContext(), "Blue", Toast.LENGTH_SHORT).show();
                myView.changeColor(Color.BLUE);

                break;
            case MENU_ITEM_4_ACTION:
                Toast.makeText(getApplicationContext(), "Magenta", Toast.LENGTH_SHORT).show();
                myView.changeColor(Color.MAGENTA);

                break;
            case MENU_ITEM_5_ACTION:
                Toast.makeText(getApplicationContext(), "Yellow", Toast.LENGTH_SHORT).show();
                myView.changeColor(Color.YELLOW);

                break;
            case MENU_ITEM_6_ACTION:
                Toast.makeText(getApplicationContext(), "White", Toast.LENGTH_SHORT).show();
                myView.changeColor(Color.WHITE);

                break;
            case MENU_ITEM_7_ACTION:
                Toast.makeText(getApplicationContext(), "Black", Toast.LENGTH_SHORT).show();
                myView.changeColor(Color.BLACK);

                break;
            case MENU_ITEM_8_ACTION:
                Toast.makeText(getApplicationContext(), "Blue", Toast.LENGTH_SHORT).show();
                myView.changeColor(Color.BLUE);

                break;

            }
        }
    });
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.first_activity, menu);
    return true;
}

public boolean onOptionsItemSelected(MenuItem item){
     switch (item.getItemId()) {
     case R.id.tools:
        ll.setVisibility(LinearLayout.VISIBLE);
        return true;
     case R.id.import_pics:
         getPhotos();
         return true;
     case R.id.save:
        toJPEGFile();
         return true;
     case R.id.trash:
        clearPoints();
         return true;
     }
    return false;

}

public void clearPoints () {
        forceRedraw();
}

    public void forceRedraw() {
        invalidate();
    }

private void toJPEGFile() {
    // TODO Auto-generated method stub
    String root = Environment.getExternalStorageDirectory().toString();
    File myDir = new File(root + "/saved_images");    
    myDir.mkdirs();
    Random generator = new Random();
    int n = 10000;
    n = generator.nextInt(n);
    String fname = "Image-"+ n +".jpg";
    File file = new File (myDir, fname);
    if (file.exists ()) file.delete (); 
    try {
           FileOutputStream out = new FileOutputStream(file);
           Bitmap finalBitmap = CanvasView.bitmap;
           finalBitmap.compress(Bitmap.CompressFormat.JPEG, 90, out);
           out.flush();
           out.close();

    } catch (Exception e) {
           e.printStackTrace();
    }
}

public void getPhotos(){
    Intent photoPickerIntent = new Intent(Intent.ACTION_GET_CONTENT);
    photoPickerIntent.setType("image/*");
    startActivityForResult(photoPickerIntent, 1);
}

protected void onActivityResult(int requestCode, int resultCode, Intent data)
{
    super.onActivityResult(requestCode, resultCode, data);
    if (resultCode == RESULT_OK)
    {
        Uri chosenImageUri = data.getData();
        Toast.makeText(getApplicationContext(), "Photo background added!", Toast.LENGTH_SHORT).show();      

        Bitmap mBitmap = null;
        try {
            mBitmap = Media.getBitmap(this.getContentResolver(), chosenImageUri);
            if(mBitmap.isMutable())
                Toast.makeText(getApplicationContext(), "is mutable", Toast.LENGTH_SHORT).show();
            //cView = new MyCustomView(getApplicationContext(), null);
            myView.setImage(mBitmap);
        } catch (FileNotFoundException e) {

            e.printStackTrace();
        } catch (IOException e) {

            e.printStackTrace();
        }
        }
}

public void colorChanged(int color) {
    mPaint.setColor(color);

}
} 
```

在这里你有 CanvasView.java

```
public class CanvasView extends View{

private ArrayList<Path> undonePaths = new ArrayList<Path>(); 
private ArrayList<Path> paths = new ArrayList<Path>();
private static final float STROKE_WIDTH = 5f;
private static final float HALF_STROKE_WIDTH = STROKE_WIDTH/2;
private float mX, mY;
private static final float TOUCH_TOLERANCE = 4;
Paint erasePaint = new Paint();
Paint paint = new Paint();
Path path = new Path();

float lastTouchX,lastTouchY;

AlertDialog.Builder alert;

RectF ovalRectangle = new RectF();
RectF dirtyRect = new RectF();

MyRectangle myRectangle;
MyOval myOval;
MyCircle myCircle;
MyFreehand myFreehand; 
MyLine myLine;
MyEraser myEraser;

List<MyEraser> eraserList = new ArrayList<MyEraser>();
List<MyLine> lineList = new ArrayList<MyLine>();
List<MyFreehand> freehandList  = new ArrayList<MyFreehand>();
List<MyCircle> circleList = new ArrayList<MyCircle>();
List<MyOval> ovalList = new ArrayList<MyOval>();
List<MyRectangle> rectangleList = new ArrayList<MyRectangle>();

public boolean dashedLine = false;
public DashPathEffect dashEffect = new DashPathEffect(new float[]{20,30}, 0);
private Paint mBitmapPaint;
private Bitmap mBitmap; 

public String textValue;

public CanvasView(Context context, AttributeSet attrs) {
    super(context, attrs);
    setBackgroundColor(Color.WHITE);

    if (android.os.Build.VERSION.SDK_INT >= 11) 
    {
        turnOffHardwareAcc();
    }

    erasePaint.setColor(Color.TRANSPARENT);
    //erasePaint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.CLEAR));

    erasePaint.setAntiAlias(true);
    erasePaint.setStyle(Paint.Style.STROKE);
    erasePaint.setStrokeJoin(Paint.Join.ROUND);
    erasePaint.setStrokeWidth(5f);

    paint.setColor(Color.BLACK);
    paint.setStyle(Paint.Style.STROKE);

    paint.setAntiAlias(true);
    paint.setStrokeJoin(Paint.Join.ROUND);
    paint.setStrokeWidth(STROKE_WIDTH);
    paint.setTextSize(72);

    setMode(7);//default = 7 - free hand;

    mBitmap = Bitmap.createBitmap(320, 480, Bitmap.Config.ARGB_8888);
    mBitmapPaint = new Paint(Paint.DITHER_FLAG);

    /* input dialog*/

     //setInputDialog();

}
EditText input;
public void setInputDialog(){

    alert = new AlertDialog.Builder(getContext());
    alert.setTitle("Title");
    alert.setMessage("Write text");

    // Set an EditText view to get user input 
    input = new EditText(getContext());
    alert.setView(input);

    alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog, int whichButton) {
         textValue= input.getText().toString();
         Toast.makeText(getContext(), textValue, Toast.LENGTH_SHORT).show();
      // Do something with value!
      }
    });

    alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
      public void onClick(DialogInterface dialog, int whichButton) {
        // Canceled.
      }
    });

    //alert.show();

}

private void touch_start(float x, float y) {
    undonePaths.clear();
    path.reset();
    path.moveTo(x, y);
    mX = x;
    mY = y;
}
private void touch_move(float x, float y) {
    float dx = Math.abs(x - mX);
    float dy = Math.abs(y - mY);
    if (dx >= TOUCH_TOLERANCE || dy >= TOUCH_TOLERANCE) {
        path.quadTo(mX, mY, (x + mX)/2, (y + mY)/2);
        mX = x;
        mY = y;
    }
}
private void touch_up() {
    path.lineTo(mX, mY);
    Canvas mCanvas = null;
    // commit the path to our offscreen
    mCanvas.drawPath(path, paint);
    // kill this so we don't double draw
    paths.add(path);
    path = new Path();            

}

public void Undo () { 
    if (paths.size()>0) { 
       undonePaths.add(paths.remove(paths.size()-1));
       invalidate();
     }
    else
    {

    }
}

public void Redo (){
   if (undonePaths.size()>0) { 
       paths.add(undonePaths.remove(undonePaths.size()-1));
       invalidate();
   } 
   else
   {

   }
}

public void setDashLine(){

    dashedLine = true;
    paint = new Paint();
    paint.setPathEffect(dashEffect);
    paint.setStyle(Paint.Style.STROKE);
    paint.setAntiAlias(true);
    paint.setStrokeJoin(Paint.Join.ROUND);
    paint.setStrokeWidth(STROKE_WIDTH);
}

public void setNormalLine(){
    //paint.setColor(Color.BLACK);
    dashedLine = false;

    paint.setPathEffect(null);
    paint.setStyle(Paint.Style.STROKE);
    paint.setPathEffect(null);
    paint.setAntiAlias(true);
    paint.setStrokeJoin(Paint.Join.ROUND);
    paint.setStrokeWidth(STROKE_WIDTH);
}

@TargetApi(11)
public void turnOffHardwareAcc() // to enable dashed lines
{

    this.setLayerType(View.LAYER_TYPE_SOFTWARE, null);
}

//public void setPaint(int color,)

@TargetApi(11)
protected void onDraw(Canvas canvas) {
    paint.setPathEffect(null);

    if(bitmap!=null){

        canvas.drawBitmap(bitmap, 0, 0, paint);
         for(MyCircle circle:circleList){// draw circles

             myCanvas.drawCircle(getCircleMidPointX(circle.firstX, circle.lastX),getCircleMidPointY(circle.firstY, circle.lastY),circle.radius,myPaint);
         }

    }

    for(MyLine line:lineList){ //draw lines
         if(dashedLine)
             line.paint.setPathEffect(dashEffect);
         else
             line.paint.setPathEffect(null);
            canvas.drawLine(line.xStart, line.yStart, line.xEnd, line.yEnd, line.paint);
      }

     for(MyCircle circle:circleList){// draw circles

         canvas.drawCircle(getCircleMidPointX(circle.firstX, circle.lastX),getCircleMidPointY(circle.firstY, circle.lastY),circle.radius,paint);
     }

     for(MyOval oval:ovalList){
         oval.paint.setPathEffect(null);

           ovalRectangle.set(oval.getX1(),oval.getY1(),oval.getX2(),oval.getY2());
           canvas.drawOval(ovalRectangle, oval.paint);
     }

     for(MyRectangle rectangle:rectangleList){
         rectangle.paint.setPathEffect(null);

           canvas.drawRect(rectangle.getX1(),rectangle.getY1(),rectangle.getX2(),rectangle.getY2(),rectangle.paint);
     }  

     for(MyEraser e:eraserList){
            canvas.drawPath(e.p,erasePaint);
            invalidate();
     }
     if(textValue!= null)
         canvas.drawText(textValue, xStart, yStart, paint);
     canvas.drawPath(path, paint);
     //path.reset();

}

public boolean onTouch(View arg0, MotionEvent event) {
    float x = event.getX();
    float y = event.getY();

    switch (event.getAction()) {
        case MotionEvent.ACTION_DOWN:
            touch_start(x, y);
            invalidate();
            break;
        case MotionEvent.ACTION_MOVE:
            touch_move(x, y);
            invalidate();
            break;
        case MotionEvent.ACTION_UP:
            touch_up();
            invalidate();
            break;
    }
    return true;
}

final OnTouchListener drawLineListener = new OnTouchListener() {
    public boolean onTouch(View v, MotionEvent event) {

        FirstActivity.ll.setVisibility(LinearLayout.GONE);

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
              myLine = new MyLine();
              myLine.xStart = event.getX();
              myLine.yStart = event.getY();

            return true;

          case MotionEvent.ACTION_MOVE:
          case MotionEvent.ACTION_UP:
            myLine.xEnd = event.getX();
            myLine.yEnd = event.getY();
            invalidate();
            lineList.add(myLine); 
            break;

          default:
            Log.d("mock it up", "Unknown touch event  " + event.toString());
            return false;
        }
        return true;

     }
  };

 final OnTouchListener drawDashedLineListener = new OnTouchListener() {
    public boolean onTouch(View v, MotionEvent event) {

        FirstActivity.ll.setVisibility(LinearLayout.GONE);

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
             return true;

          case MotionEvent.ACTION_MOVE:
          case MotionEvent.ACTION_UP:

            break;

          default:
            Log.d("mock it up", "Unknown touch event  " + event.toString());
            return false;
        }
        return true;

    }
 };

final OnTouchListener drawCircleListener = new OnTouchListener(){

    public boolean onTouch(View v, MotionEvent event) {

        FirstActivity.ll.setVisibility(LinearLayout.GONE);

        float eventX = event.getX();
        float eventY = event.getY();

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
           //  path.moveTo(eventX, eventY);
              Toast.makeText(getContext(), "action down - circle",Toast.LENGTH_SHORT).show();
              myCircle = new MyCircle();
              myCircle.firstX = eventX;
              myCircle.firstY = eventY;

            // There is no end point yet, so don't waste cycles invalidating.
            return true;

          case MotionEvent.ACTION_MOVE:

          case MotionEvent.ACTION_UP:
            myCircle.lastX = eventX;
            myCircle.lastY = eventY;

            myCircle.radius = getRadius(myCircle.firstX,myCircle.firstY,myCircle.lastX,myCircle.lastY);

            circleList.add(myCircle);

            invalidate();
            break;

          default:
            Log.d("mock it up", "Unknown touch event  " + event.toString());
            return false;
        }
  return true;
    }

};

final OnTouchListener drawOvalListener = new OnTouchListener() {
        public boolean onTouch(View v, MotionEvent event) {

            FirstActivity.ll.setVisibility(LinearLayout.GONE);

            switch (event.getAction()) {
              case MotionEvent.ACTION_DOWN:
                myOval = new MyOval();
                myOval.setX1(event.getX());
                myOval.setY1(event.getY());
                // There is no end point yet, so don't waste cycles invalidating.
                return true;

              case MotionEvent.ACTION_MOVE:
              case MotionEvent.ACTION_UP:

                  myOval.setX2(event.getX());
                  myOval.setY2(event.getY());

                  invalidate();
                  ovalList.add(myOval);

              default:
                Log.d("mock it up", "Unknown touch event  " + event.toString());
                return false;
            }

        }
    };

final OnTouchListener drawRectangleListener = new OnTouchListener() {

        public boolean onTouch(View v, MotionEvent event) {

            FirstActivity.ll.setVisibility(LinearLayout.GONE);

            switch (event.getAction()) {
              case MotionEvent.ACTION_DOWN:
                  myRectangle = new MyRectangle();
                  myRectangle.setX1(event.getX());
                  myRectangle.setY1(event.getY());
                return true;

              case MotionEvent.ACTION_MOVE:

              case MotionEvent.ACTION_UP:

                  myRectangle.setX2(event.getX());
                  myRectangle.setY2(event.getY());
                  invalidate();
                  rectangleList.add(myRectangle);

                break;

              default:
                Log.d("mock it up", "Unknown touch event  " + event.toString());
                return false;
            }

            return true;
        }
};

final OnTouchListener eraseListener = new OnTouchListener() {

};

final OnTouchListener drawFreeHandListener = new OnTouchListener() {

    public boolean onTouch(View v, MotionEvent event) {

        FirstActivity.ll.setVisibility(LinearLayout.GONE);

        float eventX = event.getX();
        float eventY = event.getY();

        // Include half the stroke width to avoid clipping.
        invalidate(
            (int) (dirtyRect.left - HALF_STROKE_WIDTH),
            (int) (dirtyRect.top - HALF_STROKE_WIDTH),
            (int) (dirtyRect.right + HALF_STROKE_WIDTH),
            (int) (dirtyRect.bottom + HALF_STROKE_WIDTH));

        lastTouchX = eventX;
        lastTouchY = eventY;

        return true;
    }
};

float xStart,yStart;
final OnTouchListener textListener = new OnTouchListener() {

    public boolean onTouch(View v, MotionEvent event) {
        FirstActivity.ll.setVisibility(LinearLayout.GONE);

    //  Toast.makeText(getContext(), "add some text", Toast.LENGTH_SHORT).show();

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
              //
              setInputDialog();
              xStart = event.getX();
              yStart = event.getY();
              alert.show();
            break;

          case MotionEvent.ACTION_MOVE:
          case MotionEvent.ACTION_UP:
            //  setInputDialog();
                  break;

          default:
            Log.d("mock it up", "Unknown touch event  " + event.toString());
            return false;
        }

        return true;
    }
};

/**
 * Called when replaying history to ensure the dirty region includes all
 * points.
 */
private void expandDirtyRect(float historicalX, float historicalY) {
  if (historicalX < dirtyRect.left) {
    dirtyRect.left = historicalX;
  } else if (historicalX > dirtyRect.right) {
    dirtyRect.right = historicalX;
  }
  if (historicalY < dirtyRect.top) {
    dirtyRect.top = historicalY;
  } else if (historicalY > dirtyRect.bottom) {
    dirtyRect.bottom = historicalY;
  }
}

/**
 * Resets the dirty region when the motion event occurs.
 */
private void resetDirtyRect(float eventX, float eventY) {

  // The lastTouchX and lastTouchY were set when the ACTION_DOWN
  // motion event occurred.
  dirtyRect.left = Math.min(lastTouchX, eventX);
  dirtyRect.right = Math.max(lastTouchX, eventX);
  dirtyRect.top = Math.min(lastTouchY, eventY);
  dirtyRect.bottom = Math.max(lastTouchY, eventY);
}

public void setMode(int mode){
    switch(mode){
    case 1://draw line
        Toast.makeText(getContext(), "draw line", Toast.LENGTH_SHORT).show();
        setOnTouchListener(drawLineListener);
        break;
    case 2://draw dashed line
        Toast.makeText(getContext(), "dashed line", Toast.LENGTH_SHORT).show();
        break;
    case 3:// draw circle
        setOnTouchListener(drawCircleListener);
        break;
    case 4: //draw oval
        setOnTouchListener(drawOvalListener);
        break;
    case 5: //draw rectangle
        setOnTouchListener(drawRectangleListener);
        break;
    case 6: //erase
        setOnTouchListener(eraseListener);
        break;
    case 7: //free-hand
        setOnTouchListener(drawFreeHandListener);
        break;
    case 8:
        setOnTouchListener(textListener);
        break;

    }
}

static Bitmap bitmap;
private Canvas myCanvas;
public Paint myPaint;

public void setImage(Bitmap b){
    Toast.makeText(getContext(), "set Bitmap",Toast.LENGTH_SHORT).show();
    bitmap = b.copy(Bitmap.Config.ARGB_8888, true);
    myCanvas = new Canvas(bitmap);

    myPaint = new Paint();
    myPaint.setColor(Color.YELLOW);
    myPaint.setAntiAlias(true);
    myPaint.setStrokeWidth(8);

    invalidate();
}

public void changeColor(int color){
    paint = new Paint(paint);
    paint.setColor(color);
    //myPaint.setColor(color);
}

public float getRadius(float x1,float y1,float x2,float y2){
      float r = (float) (Math.sqrt((double)(Math.pow((y2-y1), 2.0)+Math.pow((x2-x1), 2.0)))/2);
      return r;
  }

public float getCircleMidPointX(float x1,float x2){
      return (x1+x2)/2;
  }

public float getCircleMidPointY(float y1,float y2){
      return (y1+y2)/2;
  }

protected void onSizeChanged(int w, int h, int oldw, int oldh) {
       mBitmap = Bitmap.createBitmap(w, h, Bitmap.Config.ARGB_8888);            
       Canvas canvas = new Canvas(mBitmap);  
       canvas.drawColor(Color.GREEN);
           super.onSizeChanged(w, h, oldw, oldh);
    }

} 
```

我附上了我的代码，以便更有用地了解我的问题在哪里。希望您能够帮助我。先感谢您 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:35:47.123

您可以使用以下代码清除画布。还要确保重置绘图工具。

提供一个新的画布来绘制和重置绘图工具。

在您的 FirstActivity 中

```
 myView.clear(); 
```

在您的 Canvas 视图中创建一个函数，例如 clear

```
public void clear()
{
  mBitmapPaint = new Paint(Paint.DITHER_FLAG);
  mBitmap = Bitmap.createBitmap(320,480,Bitmap.Config.ARGB_8888);
  mCanvas = new Canvas(mBitmap);  

       //reset drawing tools. reset other drawing tools. (linepaint, cirlce paint..)        

  mPaint = new Paint();
  mPaint.setAntiAlias(true);
  mPaint.setDither(true);
  mPaint.setColor(0xFFFF0000);
  mPaint.setStyle(Paint.Style.STROKE);
  mPaint.setStrokeJoin(Paint.Join.ROUND);
  mPaint.setStrokeCap(Paint.Cap.ROUND);
  mPaint.setStrokeWidth(0);
  invalidate(); //refresh your view. try this
} 
```

# redis - Redis 复合命令或命令管道

> ID：15647590
> 
> 赞同：3
> 
> 时间：2013-03-26T21:17:31.773
> 
> 标签：redis

这几天一直在[玩redis 。](http://redis.io/)是否可以运行如下复合命令：

```
MGET ZRANGE ranks 0 1 
```

我还没有从文档、[这篇旧帖子](https://groups.google.com/forum/?fromgroups=#!topic/redis-db/1-x9-X2J7Ik)或测试中找到明确的答案：

```
redis 127.0.0.1:6379> ZRANGE ranks 0 1
1) "One"
2) "Two"
redis 127.0.0.1:6379> MGET One Two
1) "1"
2) "2"
redis 127.0.0.1:6379> MGET ZRANGE ranks 0 1
1) (nil)
2) (nil)
3) (nil)
4) (nil) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T21:43:50.370

Redis 内置的 LUA 脚本支持应该允许您有效地将命令链接在一起。请参阅[http://redis.io/commands/eval](http://redis.io/commands/eval)。不完全是您正在寻找的东西，但也许这已经足够了。

一个简单的例子：

```
redis> set foo bar
OK
redis> set bar baz
OK
redis> eval "return      redis.call('get',redis.call('get','foo'))" 0
"baz" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T21:57:22.150

您的命令`MGET ZRANGE ranks 0 1`有效，因为它获取名称`"ZRANGE"`为 、`"ranks"`、`"0"`和的键的值`"1"`。所以你得到了四个`(nil)`回应。redis 中没有复合命令的概念。一些客户端支持命令流水线。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T15:33:52.817

您可以使用 Redis lua EVAL 命令在一个命令中完成所有操作，如下所示：

```
EVAL 'local ids = redis.call("ZRANGE", "myset", 0, 100); 
return redis.call("MGET", unpack(ids));' 0 
```

提高性能的最佳方法是使用密钥并使用缓存脚本。此处的完整说明： [http ://redis.io/commands/eval](http://redis.io/commands/eval)

# java - 使用 Java 播放 G711 编码的音频流？

> ID：15647597
> 
> 赞同：0
> 
> 时间：2013-03-26T21:18:14.570
> 
> 标签：java, audio, streaming

是否可以使用`javax.sound.sampled`或其他一些内置 Java 库在 Java Applet 中播放音频？音频是内容类型`audio/basic`，采用 G711 编码。

音频流来自我正在使用的 Axis 网络摄像机的板载 HTTP 服务器。我还可以获得 AAC 或 G726 编码的音频。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:26:03.420

我不太了解`javax.sound`。但我记得很久以前处理音频的 Sun Java 库，包括 G.711 数据。稍微搜索一下就会发现[com.sun.media.sound](http://www.docjar.com/docs/api/com/sun/media/sound/package-index.html)。要将 G.711 数据解码为普通 PCM 音频，请查看[AlawCodec](http://www.docjar.com/docs/api/com/sun/media/sound/AlawCodec.html)或[UlawCodec](http://www.docjar.com/docs/api/com/sun/media/sound/UlawCodec.html)类。音频是否有任何其他封装，或者只是没有标头的原始对数 PCM 字节？如果有封装，可能会有其他类首先处理它（比如[AuFileReader](http://www.docjar.com/docs/api/com/sun/media/sound/AuFileReader.html)）。

# ios - 表格视图不存储数据

> ID：15647603
> 
> 赞同：0
> 
> 时间：2013-03-26T21:18:28.213
> 
> 标签：ios, ipad, uitableview, nsmutablearray

我在表格视图上存储数据时遇到问题。

这是一个菜单应用程序，有一个按钮，该按钮将在表格视图上弹出并显示他们订购的所有菜肴，我使用 NSMutableArray 来存储数据，但是每当我关闭表格视图时，表格中的数据将重置为初始状态，即空表。

我该怎么做才能解决这个问题，感谢您的帮助！

我正在使用 FPPopover 库来显示弹出表视图，代码如下：

```
- (IBAction)revealOrderList:(id)sender
{
    SAFE_ARC_RELEASE(popover); popover=nil;

    OrderListViewController *controller = [[OrderListViewController alloc] initWithStyle:UITableViewStylePlain];
    UINavigationController *nc = [[UINavigationController alloc] initWithRootViewController:controller];
    SAFE_ARC_RELEASE(controller); controller=nil;

    popover = [[FPPopoverController alloc] initWithViewController:nc];
    popover.tint = FPPopoverDefaultTint;
    popover.contentSize = CGSizeMake(300, 500);
    [popover presentPopoverFromView:sender];
} 
```

在弹出的表格视图中：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    self.navigationItem.leftBarButtonItem = self.editButtonItem;

    orderList = [[NSMutableArray alloc] initWithObjects:@"One", @"Two", @"Three", nil];

    //add the add button
    UIBarButtonItem *addButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemAdd target:self action:@selector(insertNewObject)];
    self.navigationItem.rightBarButtonItem = addButton;
}

- (void)insertNewObject
{
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Add new thing"
                                                message:@""
                                               delegate:self
                                      cancelButtonTitle:@"Cancel"
                                      otherButtonTitles:@"OK", nil];

    //Set the style of UIAlertView
    alert.alertViewStyle = UIAlertViewStylePlainTextInput;

    //Show the UIAlertView
    [alert show];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:47:10.113

既然您说表格视图最初确实正确存储了数据，我想您已经将表格视图正确连接到数据源。如果我不得不猜测数据消失的原因，那么，当你关闭表时，你释放了它的控制器，从而释放了它的数据。我建议允许在打开表时将初始数据传递给表的控制器。

如果不是这种情况，发布一些相关代码确实有助于找到答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:08:09.437

您的数据不会自行存储。您可以在数组中输入初始数据，但要保存新数据，您需要核心数据或以其他方式`NSUserDefaults`将新数据保存到文件或数据库中。Tim roadley 有一套很棒的教程来处理这里的核心数据是链接：[http ://timroadley.com/tutorials-index/](http://timroadley.com/tutorials-index/)

它还取决于您尝试保存的数据量。如果数量巨大，那么 SQL 数据库会更好。尝试其中一个`NSUserDefaults`或核心数据。但是仅通过设置数组就无法保存新数据。该数组将仅显示您通过代码在其中估算的原始数据。苹果也有一个很好的保存数据的例子。尝试搜索示例代码 Bird Watching。更好的是这里的链接：http: [//developer.apple.com/library/IOs/ipad/#documentation/iPhone/Conceptual/SecondiOSAppTutorial/GettingStarted/GettingStarted.html](http://developer.apple.com/library/IOs/ipad/#documentation/iPhone/Conceptual/SecondiOSAppTutorial/GettingStarted/GettingStarted.html)

希望这可以帮助你。

# ffmpeg - avconv 或 ffmpeg 可以在不转码的情况下转置吗？

> ID：15647605
> 
> 赞同：1
> 
> 时间：2013-03-26T21:18:37.603
> 
> 标签：ffmpeg

我跑了：

```
    avconv -i ./IMG_0271.MOV -vf transpose=1 output.mkv

    ls -al

   -rw-rw-r-- 1 max max 3207681 Mar 26 15:58 IMG_0271.MOV
   -rw-rw-r-- 1 max max 1403200 Mar 26 17:10 output.mkv

```

根据输入和输出文件大小的差异，我得出结论正在进行转码，我可以避免这种情况吗？

# sql-server - 修改现有程序——返回相似结果的程序

> ID：15647607
> 
> 赞同：0
> 
> 时间：2013-03-26T21:18:51.410
> 
> 标签：sql-server, sql-server-2008

下面我包含了一些示例数据和我用来返回搜索信息的过程。如果我搜索格式它也会返回信息，我会遇到问题！如果文本在更大的字符串中，我该如何排除？

这是表格：

```
CREATE TABLE [dbo].[XmlTable](
        [XmlId] [int] IDENTITY(1,1) NOT NULL,
        [XmlDocument] [xml] NOT NULL,
     CONSTRAINT [PK_XmlTable] PRIMARY KEY CLUSTERED 
    (
        [XmlId] ASC
    )WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
    ) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

    GO 
```

这是xml

```
<dev:Doc xmlns:dev="http://www.w3.org/2001/XMLSchema" SchemaVersion="0.1" Settings="Testing" Title="Ordering">
  <dev:Base RevisionNumber="0" Baseid="34433" />
  <dev:Rev Time="2013-01-21T15:08:00">
    <dev:Person Name="Me" Systemid="54654" />
  </dev:Rev>
  <dev:Functions Id="A1">
    <dev:A1 Number="1">
      <dev:Codes>D</dev:Codes>
      <dev:Required>true</dev:Required>
      <dev:Informational>false</dev:Informational>
      <dev:Visitors>
        <dev:Visitor Name="Dev01" Location="STLRF">
          <dev:Divisions>
            <dev:Division Number="1" Name="TFR3" Usage="Monitor">
              <dev:Description>Development Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="2" Name="DEF32" Usage="Monitor">
              <dev:Description>Testing Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="3" Name="DEP13" Usage="None">
              <dev:Description>Guided Fundamentals</dev:Description>
            </dev:Division>
          </dev:Divisions>
        </dev:Visitor>
        <dev:Visitor Name="Dev02" Location="STLRF">
          <dev:Divisions>
            <dev:Division Number="1" Name="TFR3" Usage="Monitor">
              <dev:Description>Development Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="2" Name="DEF32" Usage="Monitor">
              <dev:Description>Testing Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="3" Name="DEP13" Usage="None">
              <dev:Description>Guided Fundamentals</dev:Description>
            </dev:Division>
          </dev:Divisions>
        </dev:Visitor>
        <dev:Visitor Name="Dev03" Location="FGRTY">
          <dev:Divisions>
            <dev:Division Number="1" Name="TFR3" Usage="Monitor">
              <dev:Description>Format Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="2" Name="DEF32" Usage="Monitor">
              <dev:Description>Testing Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="3" Name="DEP13" Usage="None">
              <dev:Description>Guided Fundamentals</dev:Description>
            </dev:Division>
          </dev:Divisions>
        </dev:Visitor>
      </dev:Visitors>
      <dev:Senders>
        <dev:Sender Name="FGY(14A)" />
      </dev:Senders>
    </dev:A1>
  </dev:Functions>
  <dev:Functions Id="A2">
    <dev:A2 Number="1">
      <dev:Codes>C</dev:Codes>
      <dev:Required>true</dev:Required>
      <dev:Informational>false</dev:Informational>
      <dev:Remarks>Support</dev:Remarks>
      <dev:Notes>Ready</dev:Notes>
      <dev:Visitors>
        <dev:Visitor Name="GHFF">
          <dev:Divisions>
            <dev:Division Number="0" Name="Trial" Usage="None">
              <dev:FromLocation>LOPO</dev:FromLocation>
              <dev:ToLocation>RDSS</dev:ToLocation>
              <dev:Description>Rich Information</dev:Description>
            </dev:Division>
          </dev:Divisions>
        </dev:Visitor>
      </dev:Visitors>
      <dev:Senders>
        <dev:Sender Name="W33R" />
      </dev:Senders>
      <dev:IsReady>true</dev:IsReady>
      <dev:IsCall>false</dev:IsCall>
    </dev:A2>
    <dev:A2 Number="2">
      <dev:Codes>A</dev:Codes>
      <dev:Required>true</dev:Required>
      <dev:Informational>false</dev:Informational>
      <dev:Remarks>Loader Ready</dev:Remarks>
      <dev:Notes>Ready</dev:Notes>
      <dev:Visitors>
        <dev:Visitor Name="UDT">
          <dev:Divisions>
            <dev:Division Number="0" Name="Trial" Usage="None">
              <dev:FromLocation>TYUJ</dev:FromLocation>
              <dev:ToLocation>DETF</dev:ToLocation>
              <dev:Description>Web Format</dev:Description>
            </dev:Division>
          </dev:Divisions>
        </dev:Visitor>
      </dev:Visitors>
      <dev:Senders>
        <dev:Sender Name="RJ4" />
      </dev:Senders>
      <dev:IsReady>true</dev:IsReady>
      <dev:IsCall>false</dev:IsCall>
    </dev:A2>
  </dev:Functions>
</dev:Doc> 
```

插入语句

```
INSERT INTO XmlTable(XMLDocument)
SELECT * FROM OPENROWSET(
   BULK 'C:\Users\123\Desktop\Practice.xml',
   SINGLE_BLOB) AS x; 
```

这是程序

```
 CREATE PROCEDURE [dbo].[GetXmlSearchString]
        @findString NVARCHAR(100)
    AS
    BEGIN

        SET NOCOUNT ON
        SET @findstring = UPPER(@findstring);

    ;WITH XMLNAMESPACES (Default 'http://www.w3.org/2001/XMLSchema' )
    SELECT      
     XmlId,

               CAST(x.value('.' , 'nvarchar(MAX)') As nvarchar(MAX)) AS Value,
                    a.value('(@Settings)[1]', 'NVARCHAR(200)') AS Title,
                    b.value('(@Id)[1]','nvarchar(MAX)') As [Function],
                    d.value('@Number[1]', 'INT') AS TeamNumber,
                    c.value('(@Name)[1]','nvarchar(MAX)') As  Visitor,
                    f.value('(@Name)[1]', 'NVARCHAR(MAX)') As Sender

              --,RANK() OVER 
           --        (PARTITION BY d.value('@Number[1]', 'INT') 
              --      Order By XmlId  DESC) As RANK

        FROM dbo.XmlTable x

        CROSS APPLY XmlDocument.nodes('Doc') As aa(a)
        CROSS APPLY a.nodes('Functions') As bb(b)
        CROSS APPLY b.nodes('*') dd(d) 
        CROSS APPLY d.nodes('Visitors/Visitor') As cc(c)
        CROSS APPLY d.nodes('Senders/Sender') ff(f)
        CROSS APPLY d.nodes('(.//*[contains(upper-case(text()[1]), sql:variable("@findString"))])[1]
        , (.//@*[contains(upper-case(.), sql:variable("@findString"))])[1]') a(x)
--Where a.x.value('.','nvarchar(MAX)') like '%'+@findstring+'%'

        Order By XmlId

            RETURN
        END

        GO 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:40:27.937

要搜索确切的单词，请添加 WHERE 子句：

```
WHERE a.x.value('.','nvarchar(MAX)') like @findstring+' %'
    or a.x.value('.','nvarchar(MAX)') like '% ' + @findstring+' %' 
    or a.x.value('.','nvarchar(MAX)') like '% ' + @findstring 
    or a.x.value('.','nvarchar(MAX)') = @findstring 
```

[我在这里](http://social.technet.microsoft.com/Forums/en-US/transactsql/thread/ef1237d1-f114-4700-b3bc-d0df469b8829)找到了一种更优雅的方式：

```
Where ' ' + a.x.value('.','nvarchar(MAX)') + ' ' like '% ' + @findstring + ' %' 
```

或者，如果你想在单词后面允许标点符号（比如“格式”），那么使用这个：

```
Where ' ' + a.x.value('.','nvarchar(MAX)') + ' ' like '%[^a-z]' + @findstring + '[^a-z]%' 
```

# regex - 解析字符集而不转换为 UTF-8

> ID：15647617
> 
> 赞同：0
> 
> 时间：2013-03-26T21:19:28.143
> 
> 标签：regex, parsing, utf-8, character-encoding, ascii

我正在解析/标记一组编译为 CSS 的语言，但我不知道应该如何处理非 ASCII 输入。显然很多人之前都处理过这个问题。

*作为一般经验法则*，我一直在阅读“转换为 UTF-8，处理并转换回您输入的任何编码”。我倾向于同意这种方法......

*但我一直在想*，我将直接使用的所有标点符号和数字都是 ASCII（代码点低于 127），而其他字符串都将被填充到哈希表中（即程序*不应该*关心你需要多少字节来表达任何给定的字符）。

**问题来了：**

*   是否有任何正式字符集会与我感兴趣的代码点的 ASCII 定义**冲突（全部低于 127）？**

*   在设置大 ole' 字符范围以匹配所有我不打算直接处理的字符并跳过整个宽字符 UTF-8 编码解码失败时，你能看到任何明显的错误吗？

例如：

```
//A-Z, a-z and all the non-ASCII stuff
character = (0x41..0x5A) || (0x61..0x7A) || (0x80..0xFF)

//match 1 or more
identifier = character+ 
```

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:56:40.153

如果您打算使用无意识的编码（如 PHP），那么您不能支持像 UTF-16 IE 这样的输入编码，编码必须是 ASCII 兼容的*bitwise*。不要与字符集中的 ASCII 兼容性混淆。

不经意编码对您很有效，因为数据只是通过。如果您需要以任何其他方式处理字符内容 - 每次都需要解码，因此您不妨在开始时对其进行解码。

不要对 UTF-8 中的内容进行编码（因此需要解码、声明、检测和其他复杂性），只需将其传递即可。如果输入为 UTF-8，则输出将为 UTF-8。如果输入是 Windows-1252，则输出将为 Windows-1252。最不意外...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:21:03.060

[EBCDIC](http://en.wikipedia.org/wiki/EBCDIC)。但你不应该担心这一点。

不过，一般来说，我认为最明智的方法是接受任何编码作为输入，然后输出 UTF-8。

# twitter-bootstrap - 行中引导按钮旁边的居中文本

> ID：15647619
> 
> 赞同：1
> 
> 时间：2013-03-26T21:19:31.637
> 
> 标签：twitter-bootstrap, stylesheet

如果我在 Bootstrap 中有一些带有按钮的文本，那么让文本与按钮中的文本对齐的最佳方法是什么？ [http://jsfiddle.net/TNRgu/9/](http://jsfiddle.net/TNRgu/9/)演示-“foo”、“bar”和“sometext”与按钮的顶部对齐，我怎样才能让它们垂直居中？

```
 <div class="container">
    <div class="row">
      <a class="span2">foo</a>
      <a class="span2">bar</a>
      <span class="span2>some text</span>
      <div class="span2">
        <button class="btn btn-success">
          <i class="icon-off icon-white"></i>
          <span>Baz</span>
        </button>
      </div>
    </div>
  </div> 
```

我知道我可以在每个顶部添加（例如）5px 填充，但是有没有更通用的方法让它总是对齐？

**编辑：**调整以上内容以在标签之后添加

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T07:12:43.417

您可以`btn-link`在链接上使用类：

```
<div class="container">
  <div class="row">
    <div class="span2">
        <a class="btn btn-link">foo</a>
    </div>
    <div class="span2">
        <a class="btn btn-link">bar</a>    
    </div>
    <div class="span2">
      <button class="btn btn-success">
        <i class="icon-off icon-white"></i>
        <span>Baz</span>
      </button>
    </div>
  </div>
</div> 
```

从引导文档：

> 通过在保持按钮行为的同时使其看起来像一个链接来淡化按钮

**UPD** `btn-link`类也可以应用于`span`，所以它看起来像一个链接

或者您可以创建类似于`btn-link`类的东西，例如`btn-text`：

```
.btn-text,
.btn-text:active,
.btn-text:hover,
.btn-text:focus {
  color: inherit;
  cursor: inherit;
  border-color: transparent;
  background-color: transparent;
  background-image: none;
  -webkit-box-shadow: none;
     -moz-box-shadow: none;
          box-shadow: none;
} 
```

[http://jsfiddle.net/TNRgu/10/](http://jsfiddle.net/TNRgu/10/)

# regex - 如何构建正则表达式以在单元格中查找不出现的“[########]”

> ID：15647622
> 
> 赞同：1
> 
> 时间：2013-03-26T21:19:42.663
> 
> 标签：regex, excel, excel-2010, vba

我有一个大表，其中包含以下方式的项目描述+代码：

```
"description [#######]" 
(Code being enclosed in "[]" and composed of 8 numbers) 
```

我需要在不同的列中分离代码和描述。需要正则表达式的原因是上述描述通常在 excel 公式中找到，例如：=

```
=IF(xyz, "description1 [1######]", "description2 [2######]") 
```

所以最终结果应该是：

```
column 1: =IF(xyz, 1######, 2######)
column 2: =IF(xyz, "description1 ", "description2 ") 
```

有没有人做过类似的事情？我发现这些答案有些相关，但目前还不足以破解正则表达式：

[在 VBA (excel) 中返回正则表达式匹配](https://stackoverflow.com/questions/8146485/returning-a-regex-match-in-vba-excel)

[匹配日期的 VBA 正则表达式](https://stackoverflow.com/questions/7929205/vba-regular-expression-to-match-date)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T05:25:17.170

使用`RegExp`替换简化了替换

此代码在 A 列上使用变体数组，导致 B 到 D 列

![在此处输入图像描述](../Images/202f1852979c6bd978deb4da6531c246.png)

```
Sub Spliced()
Dim objRegex As Object
Dim objRegMC As Object
Dim X
Dim lngRow As Long
X = Range([a1], Cells(Rows.Count, "A").End(xlUp)).Formula
ReDim Preserve X(1 To UBound(X), 1 To 3)
Set objRegex = CreateObject("vbscript.regexp")
With objRegex
    .Global = True
    .Pattern = """(\w+) (\[)(\d{8})(\])"""

For lngRow = 1 To UBound(X)
If .test(X(lngRow, 1)) Then
X(lngRow, 2) = .Replace(X(lngRow, 1), "$3")
X(lngRow, 3) = .Replace(X(lngRow, 1), """$1""")
End If
Next
End With
[b1].Resize(UBound(X, 1), 3) = X
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T22:25:53.287

这将遍历前 200 行，这是非常原始的代码，没有错误捕获。它假设 RE 中总是有 8 个数字。如果任何公式中存在语法错误，则在尝试将错误公式分配给单元格时会引发错误。

```
Sub splitSpecial()
    Dim aParts As Variant
    Dim i As Long
    Dim RE As Object
    Dim ret As Object
    Dim sNewFormula As String

    Set RE = CreateObject("vbscript.regexp")

    For i = 1 To 200 'change 200 to be the last row
        aParts = Split(Range("A" & i).Formula, ",")
        RE.Pattern = "\[\d{8}\]"
        RE.Global = True
        Set ret = RE.Execute(Range("A" & i).Formula)
        If ret.Count <> 0 Then
            sNewFormula = aParts(0) & "," & Replace(Replace(ret.Item(0), "[", ""), "]", "") & _
                "," & Replace(Replace(ret.Item(0), "[", ""), "]", "") & ")"
            Range("B" & i).Formula = sNewFormula
            sNewFormula = aParts(0) & "," & Replace(aParts(1), ret.Item(0), "") & _
                "," & Replace(aParts(2), ret.Item(1), "")
            Range("C" & i).Formula = sNewFormula
        End If
    Next i

End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:33:30.947

如果代码总是括在括号中并且总是 8 个数字......您可以使用常规文本查找公式。

```
 A1 = "DescriptionText1231 [CODE8DIG]"
    B1 = MID(B1,FIND("[",B1)+1,8) 
```

希望我理解你的问题。

# php - 有条件的 INSERT INTO MySQL - 不存在的地方

> ID：15647629
> 
> 赞同：2
> 
> 时间：2013-03-26T21:20:06.980
> 
> 标签：php, mysql, sql-insert

当客户还没有购买产品的记录时，我正在尝试进行 INSERT INTO 查询。

我已经尝试了下面的 SQL，但它似乎不起作用。

```
$queryAddPurchase = "INSERT INTO purchase (UserID, Product, Price) 
              VALUES ('$userID', '$product', '$price')
              WHERE NOT EXISTS(SELECT Product
                                       FROM purchase
                       WHERE Product = '$product'
                       AND UserID = '$userID')"; 
```

我收到的错误如下：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 3 行的“WHERE NOT EXISTS(SELECT Product FROM purchase”附近使用正确的语法

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:23:32.083

On the assumption, that a user may only buy one of each product (ever and for all products).

```
ALTER TABLE purchase ADD UNIQUE KEY (`UserID`, `Product`); -- run this just once. this changes the table

INSERT IGNORE INTO purchase (UserID, Product, Price) VALUES ('$userID', '$product', '$price'); 
```

Be aware, that this then prevents him from buying any product multiple times, which might not be the desired outcome.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T21:24:18.853

如果可能，向表中添加一个 UNIQUE 约束。就像是 ...

```
alter table purchase add unique user_product (UserID, ProductID); 
```

你的条件插入变得微不足道：

```
INSERT IGNORE INTO purchase (UserID, Product, Price) 
    VALUES ('$userID', '$product', '$price') 
```

如果这*不*适合您，请在此处使用所选答案：[MySQL Conditional Insert](https://stackoverflow.com/questions/913841/mysql-conditional-insert)

简而言之，这个答案：

```
INSERT INTO purchase (UserID, Product, Price) 
    SELECT '$userID', '$product', '$price'
    FROM dual
        WHERE NOT EXISTS (
            SELECT * FROM purchase
            WHERE UserID='$userID'
                AND ProductID='$product'
        ) 
```

# c - 理解套接字 - c

> ID：15647630
> 
> 赞同：-1
> 
> 时间：2013-03-26T21:20:11.480
> 
> 标签：c, sockets

我正在尝试了解更多套接字。所以我在头文件`socket.h`中，在sys库中找到了一些函数声明`bind(), connect()`，但是我没有找到它们的定义？我在哪里可以找到它？

告诉我这个问题是否不相关，我将把它移到别处

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:22:16.460

You're really suggested to read [Beej's guide](http://beej.us/guide/bgnet/) to network programming to make sense of these functions. Manpages (-S2) will help too.

The source code of the function (if that's what you hope to find) won't help a lot. They call system calls to do their job, as they're mostly OS-abstraction layer. What you need is their documentation.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T21:25:04.753

我建议您查看[http://www.linuxhowtos.org/C_C++/socket.htm](http://www.linuxhowtos.org/C_C++/socket.htm)以了解有关套接字的更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T21:22:03.240

您不会在标题中找到它们的定义，您需要深入了解您的 libc。但是你也不会在那里找到任何真正有用的东西，因为那些是系统调用，所以你真的需要挖掘你的内核。

# git - 设置 gerrit

> ID：15647633
> 
> 赞同：0
> 
> 时间：2013-03-26T21:20:22.670
> 
> 标签：git, amazon-web-services, gerrit

我发现安装 Gerrit 的文档不是很好。管理数据库不是我的强项，所以对我来说不太友好。

我有的：

我的桌面上有 gerrit.war 文件和运行 Ubuntu 的 AWS 服务器。

阅读安装指南，我看到了他们希望我运行的所有这些命令，但我不确定我在哪里执行此操作。在服务器上？某个终端？

我知道这可能是nooby，但我很沮丧。

任何帮助或文档将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T06:57:58.110

这些命令必须在服务器上运行。

首先将 gerrit.war 文件复制到服务器（通过 scp、ftp 或 AWS 提供的任何上传方法），然后使用终端执行文档中所示的命令。

# bash - echo 使用引号将变量写入文件

> ID：15647636
> 
> 赞同：0
> 
> 时间：2013-03-26T21:20:26.187
> 
> 标签：bash, input, echo

脚本代码：

```
 echo "Command?"
    read command 
```

例如 command = echo "Hello world"

```
 $command > text.txt
    cat text.txt 
```

输出是“Hello world”（带引号），但我需要与简单的输出相同的输出

```
 echo "Hello world" > text.txt 
```

即你好世界。我怎么才能得到它？请记住，$command 可以采用任何值，必须在当前 bash 中执行，并且输出保存在文件中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:37:06.303

如果您需要`eval`一个命令，然后保存`STDOUT`或`STDERR`：

对于`STDOUT`：

```
eval "$command" > text.txt 
```

对于`STDERR`：

```
eval "$command" 2> text.txt 
```

但是，小心， `eval`是“邪恶”的常见拼写错误。如果`eval`是答案，那么您肯定是在问错误的问题。见[http://mywiki.wooledge.org/BashFAQ/048](http://mywiki.wooledge.org/BashFAQ/048)

最后但同样重要的是，“使用更多报价！” 它们至关重要。此外，了解 ' 和 " 和 ` 之间的区别。参见 mywiki.wooledge.org/Quotes 和 wiki.bash-hackers.org/syntax/words

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:25:02.477

您可以使用

```
eval "$command" > text.txt 
```

但要小心——如果有人进入`rm -rf /`怎么办？

# php - 如何在不进行多次查询的情况下从表中获取数据总和？

> ID：15647637
> 
> 赞同：-2
> 
> 时间：2013-03-26T21:20:25.527
> 
> 标签：php, mysql, mysqli

我目前正在运行此查询：

```
SELECT *, COUNT(name) AS ActionCount 
FROM plays 
GROUP BY name 
ORDER BY ActionCount DESC LIMIT 0, 50 
```

要在我的游戏中选择最突出/最常见的名称，如果我有一个“里程”字段，我如何在不为上面选择的 50 个用户中的每个用户运行查询的情况下获得每个玩家驾驶的总里程数在每场比赛中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T21:34:32.157

我本来希望：

```
SELECT 
  *, 
  COUNT(name) AS ActionCount,
  SUM(mileage) AS totalMileage 
FROM plays 
GROUP BY name
ORDER BY ActionCount DESC LIMIT 0, 50 
```

会做的。

对我来说似乎不是特别棘手？

# java - 设置和读取多维数组

> ID：15647640
> 
> 赞同：0
> 
> 时间：2013-03-26T21:20:39.397
> 
> 标签：java

所以......我今天才看到Java for Web，而且我已经有一个巨大的项目在工作。我已经习惯了 PHP 和 C++，所以我在学习这门语言时没有这么多的麻烦，但我一直坚持这个问题。

我有一个 void 具有该格式的多维数组：

```
array( "data" => array ( "Name" => "John", "Age" => "16" ) ) 
```

我的问题是：

**我怎样才能设置我的方法来接受那种数组（上），我怎样才能读取那个多维数组（下）？**

例如：

```
public void getArray(String[] data) { println(data["data"]["Name"]; } 
```

-

```
getArray(array("data" => array("Name" => "John", "Age" => "16")));

// to returns: 'John' 
```

--

Obs.：对不起，如果这是一个愚蠢的问题，我真的对Java一无所知。我要去学习，但要知道我真的需要回答这个问题。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:24:57.283

PHP 的数组实际上不是数组，它们是[哈希表](https://en.wikipedia.org/wiki/Hash_table)。Java 的版本是[HashMap](http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html)。

```
HashMap<String, String> data = new HashMap<String, String>();
data.put("Name", "John");
// etc.
System.out.println(data.get("Name")); 
```

您还应该研究类，因为非 PHP 程序员通常会这样做：

```
class Person {
    private String name;
    private int age;

    public Person(String name, int age) {
        this.name = name;
        this.age = age;
    }

    public String getName() {
         return this.name;
    }

    // etc.
} 
```

然后：

```
class SomeClass {
    public static void main(String[] args) {
        Person person = new Person("John", 16);
        HashMap<String, Person> people = new HashMap<String, Person>();
        people.put(person.getName(), person);
    }
} 
```

类可以使大型项目的事情变得更加简单，因为它们可以做的不仅仅是保存值：

```
class Person {
    private String firstName;
    private String lastName;

    public Person(String firstName, String lastName) {
        this.firstName = firstName;
        this.lastName = lastName;
    }

    /**
     * Returns a person's full name (first and last name), without
     * storing it as a seperate variable internally.
     */
    public String getName() {
         return this.firstName + " " + this.lastName;
    }

    public String getFirstName() {
         return this.firstName;
    }

    // etc.
} 
```

另外，您可以获得类型安全性。在编译时发现问题要好得多，因为您可以在部署应用程序之前解决它们，而不是之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:31:02.820

我使用多维数组时所做的事情是这样的：

```
public class SayHello 
{

public String[][] test;

public void Main(String[] args)
{
  SayHello test = new SayHello();
  test.test = new String[4][4];
  test.testMethod(test.test);
}

private void testMethod(String[][] array)
{
for(int i = 0; i<array.length;i++) {
  for(int x = 0;x<array[i].length;x++) {
     System.out.println(array[i][x]);
  }
}
  System.out.println(array[0][1]);
}
} 
```

我希望这对您有所帮助

# css - CSS 表格单元格宽度适用于 Chrome，但不适用于 FF 或 IE

> ID：15647641
> 
> 赞同：0
> 
> 时间：2013-03-26T21:20:47.877
> 
> 标签：css, css-tables

我发现使用 display:table-cell 是一种使事物垂直居中的有用方法——尤其是在静态 px 尺寸不起作用的 RWD 上下文中。我正在尝试在不使用浮动的情况下让徽标 img 和一些文本彼此垂直居中。

见这里： [http](http://dabblet.com/gist/5249192) ://dabblet.com/gist/5249192 。

在 Chrome 中，它按预期工作。当浏览器变小时，img 变小并且文本换行等等。但在 FF、IE 9 和 Opera 中，图像不会缩小，实际上似乎所有的宽度和高度声明都被忽略了。

我可以对当前的 HTML/CSS 进行一些更改来解决这个问题，还是 Chrome 支持我当前的布局是一个令人高兴的错误，而我正在解决这一切？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:27:35.343

我傻了，我刚刚想通了。

最大宽度仅适用于块级元素，因此 img {max-width:100%;} 声明不起作用，这会阻止图像具有可变宽度。通过定位 img 并为其设置 width:100% 来清除该问题；繁荣！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:30:51.090

`display:table-cell`并不是真的打算在没有相应的`display:table-row`和`display:table`父元素的情况下使用。

你没有那个，而且你显然没有试图将它用作表格单元格。尽管您可能在使用它来居中内容方面取得了一些成功，但这并不是它的设计目的，因此它并不适用于所有浏览器也就不足为奇了。

如果您真的想使用`table-cell`它并且它没有做您想要的，也许您可​​以尝试向父元素添加添加`table-row`和`table`样式（您可能需要额外的标记，因为它们会对现有样式产生影响如果你把它们放在`wrapper`和`header`）。

# php - 嵌套的foreach循环问题

> ID：15647649
> 
> 赞同：-2
> 
> 时间：2013-03-26T21:21:10.917
> 
> 标签：php, foreach, nested

我试图让这个嵌套`foreach`循环工作，但我没有运气。这是我的代码。

```
$q = 0;
$arrayCountTwo = count($_POST['quantity']);
$i = 0;
$arrayCountThree = count($_POST['items']);
foreach ($_POST['items'] as $items) {
    $sql = '';
    foreach ($_POST['quantity'] as $quantity) {
        $q++;
        if ($q > $arrayCountTwo) {
            break;
        } else {
            $sql .= "INSERT INTO `trade_show_reserved` (ProductID, DateReserved, DateReservedEnd, QuantityReserved) VALUES ('".$items."','".$startDate."', '".$endDate."','".$quantity."')";
        }
        var_dump($sql);
    }   
} 
```

`$items`它在每次迭代时不断给我数组中的第一个值。我该如何解决？

这是您要求的数组。

items数组和数量数组按顺序排列。

```
array(3) {
  [0]=>
  string(2) "11"
  [1]=>
  string(1) "6"
  [2]=>
  string(1) "2"
}

array(3) {
  [0]=>
  string(1) "1"
  [1]=>
  string(1) "2"
  [2]=>
  string(1) "1"
} 
```

每次都应该这样做。

```
INSERT INTO `ts_table` (ProductID, DateReserved, DateReservedEnd, QuantityReserved) VALUES ('11','2013-4-11', '2013-4-25','1')

INSERT INTO `ts_table` (ProductID, DateReserved, DateReservedEnd, QuantityReserved) VALUES ('6','2013-4-11', '2013-4-25','2') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:36:24.123

这应该做你想要的：

```
foreach ($_POST['items'] as $key => $items)
{
  $sql = "INSERT INTO `trade_show_reserved` (ProductID, DateReserved, DateReservedEnd, QuantityReserved) VALUES ('".$items."','".$startDate."','".$endDate."','".$_POST['quantity'][$key]."')";
  echo $sql . '<br>'; 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:37:05.453

我想你正在寻找这样的东西。假设`item[1]`和`quantity[1]`是相关的；

```
foreach ($_POST['items'] as $idx => $item) {
    // get the quantity with the same index as the item
    // if it does not exist, default to zero
    $quantity = isset($_POST['quantity'][$idx]) ? $_POST['quantity'][$idx] : 0;

    // insert query... 

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:36:15.537

```
for($i = 0, $iMax = min(count($_POST['items']), count($_POST['quantity'])); $i < $iMax; $i++)
{
    $sql .= "INSERT INTO `trade_show_reserved` (ProductID, DateReserved, DateReservedEnd, QuantityReserved) VALUES ('".$_POST['items'][$i]."','".$startDate."', '".$endDate."','".$_POST['quantity'][$i]."')";
} 
```

更符合您的需要。

# c# - 使用带有 C# 的 USB 打印机，有和没有驱动程序或 API

> ID：15647654
> 
> 赞同：11
> 
> 时间：2013-03-26T21:21:28.417
> 
> 标签：c#, api, printing, usb, driver

我不完全是 C# 专家，我做了一些尴尬的事情，比如为音乐程序制作钢琴卷轴（所以生成一个 WPF 画布，全部包含数学等）和一些简单的程序来执行常见任务，比如动态处理一些数据（数学运算、GUI 交互等。

我需要一个关于如何在我自己的计算机上检测 USB 打印机并使用它的非常笼统的概述。我已经在这里和谷歌上搜索过，这就是我发现的：

[链接 1](http://www.developerfusion.com/article/84338/making-usb-c-friendly/)

[链接 2](https://stackoverflow.com/questions/187465/drive-a-pos-printer-via-usb-in-c-sharp)

[链接 3](http://support.microsoft.com/kb/322091/EN-US)

[链接 4](http://www.undocprint.org/winspool/tips_and_tricks)

[链接 5](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/9bebf307-0ba8-4ab3-ad0c-c74f200c3b36/)

[链接 6](http://msdn.microsoft.com/en-us/library/system.printing.aspx)

和其他类似的链接告诉我几乎一无所知的各种方法:(

好的，这就是我想出的（我会尽量简短）：

**A）使用没有驱动程序的打印机（这个定义可能不准确，但我有点困惑......）**

我应该：

1）找到一种方法来检测USB门以及通过产品ID和供应商ID连接到它们的设备。在 Developerfusion 文章的特定案例中，作者解释了 USB 的一些基础知识，并告诉您使用人机接口设备来检测它。（我使用的是 Windows 7，但找不到任何 HID，只有其他随机 USB 驱动器，而且我完全不知道如何与它们交互）

2）创建数据流并将它们与正确的消息管道上的命令一起发送到 USB 打印机（或您打算试用的水设备）。

**B) 使用带有驱动程序或 Windows API 或预烘焙驱动程序的打印机：**

我应该：

1) 使用在 [MSDN System.printing 库][Link number 6] 中找到的所有 .NET 类，并使用正确的方法直接引导打印机（使用 System.printing 库找到设备后）那些课...

好的，说明重点：

我真的不知道正确的步骤，这就是我想问你的：

一步一步的指导如何做到这一点，特别是第一个（正如我在 MSDN 论坛问题上看到的那样，第二个实际上是研究代码的问题）。我不希望您为我编写代码（尽管您可以根据需要）。我只是问一个一般指导方针，哪些是实现最终结果的正确步骤。发布链接，任何工作...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-31T07:46:15.467

此答案适用于选项 A

确实是非常难的问题。从这样一种高级编程语言访问低级硬件非常困难。我曾经使用 Assembly 来完成它，它可以为您提供非常低级的控制。我唯一能想到的是[libusb](http://www.libusb.org/)，它也有很好的 C# 包装器。它提供对 USB 设备（如打印机）的直接访问。一个好的 C# 开始将是控制更简单的 USB 设备来掌握它。确保您知道打印机如何解释从 USB 端口写入的数据。

[C# 绑定](http://sourceforge.net/projects/libusbdotnet/)

# windows - 使用 msysgit 区分远程分支

> ID：15647655
> 
> 赞同：0
> 
> 时间：2013-03-26T21:21:33.743
> 
> 标签：windows, git, diff, fetch, msysgit

我试图让我的团队使用 git，因为他们中的大多数人都想要一个 GUI，所以我走上了 msysgit 的道路。我为大多数日常任务编写了一套很好的说明，但我对如何进行代码审查感到困惑。为简单起见，我告诉他们每个人使用 master 作为起点创建一个以他们的名字命名的分支，然后在本地暂存/提交更改并推送到中央存储库，其他开发人员可以在该存储库中获取他们的更改以供审查。我的计划是让他们以分离的头部状态检查另一个开发人员的更改，然后让他们与 master 进行比较。用 bash 术语来说，它看起来像这样：

```
git checkout origin/fred
git diff -w origin/master 
```

我可以让 GUI 将远程分支作为独立的头签出而没有问题，但我似乎找不到与另一个分支（本地或远程）进行比较的方法。UI 很高兴地显示了本地分支上的更改，但对于代码审查，我们需要查看针对当前生产代码的更改。关于如何做到这一点的任何想法？还有比 msysgit 更好的 Git Windows 客户端吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T04:53:58.137

当涉及到 GUI 功能时，我发现 msysgit 过于局限。我更喜欢[Git 扩展](https://code.google.com/p/gitextensions/)和来自 Git 命令行的健康[别名列表。](http://davidwalsh.name/git-aliases)例如，我已经将其`git ext`设置为可以`!start /b gitextensions`很好地调出 Git 扩展历史记录窗格。如果我有心情通过 GUI 提交，我已经`git commit-ext`准备好运行`!start /b gitextensions commit`.

另一个无价的工具是[Beyond Compare](http://www.scootersoftware.com/)，当[安装](http://www.scootersoftware.com/support.php?zz=kb_vcs#gitwindows)到 git 中时，它会做很多事情。

# regex - 从非空白字符串中排除逗号字符

> ID：15647661
> 
> 赞同：6
> 
> 时间：2013-03-26T21:22:03.583
> 
> 标签：regex, whitespace

我需要一个正则表达式来验证一个字符串不是全是空格，并且它不包含逗号 (,) 字符。

我已经能够找到做一个或另一个的例子，但不是两个：

`^(?![\s,]*$).+`确保并非所有空格并
`^(.(?!,))*$`排除逗号。

我没有使用代码的选项，这是对表单中字段的约束。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-26T21:29:48.563

这应该适合您的需求：

```
^[^,]*[^ ,][^,]*$ 
```

*“至少一个既不是空格也不是逗号的字符，被除逗号以外的任何字符包围”*

# javascript - 如何使用 JavaScript 用 alt 代码替换字母

> ID：15647663
> 
> 赞同：-2
> 
> 时间：2013-03-26T21:22:04.347
> 
> 标签：javascript, replace

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:40:42.100

这是 jQuery 中的一个示例：http: [//jsfiddle.net/FPsdy/3/](http://jsfiddle.net/FPsdy/3/)

您将不得不用您想要的字符填充替换数组。

```
var replacements = {
    "A": ")",
    "B": ">",
    "C": "'",
}

$('input[value=Translate]').click(function(){
   $("#translator").val(function(i, val)
{
    val = val.split('');

    $.each(val, function(i,e){
        val[i] = replacements[e] ? replacements[e] : e;
    });

    return val.join('');
});
}); 
```

来源：[jQuery 替换为数组](https://stackoverflow.com/questions/7224127/jquery-replace-with-array)

# android - Android Seekbar float values from 0.0 to 2.0

> ID：15647676
> 
> 赞同：9
> 
> 时间：2013-03-26T21:23:10.117
> 
> 标签：android, seekbar

how can I get the values ​​from 0.0 to 2.0 with a `seekbar`? values ​​should go in steps of 0.5 ( 0.0 , 0.5 , 1.0, 1.5, 2.0) can someone help me?

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-26T21:36:31.717

SeekBar 扩展 ProgressBar。

ProgressBar 有一个方法

```
public void setMax(int max) 
```

由于它只接受 int ，因此您必须从 int 值进行一些转换才能获得您所追求的浮点数。

这样的事情应该可以解决问题：

```
mSeekBar.setMax(4);
//max = 4 so the possible values are 0,1,2,3,4
seekbar.setOnSeekBarChangeListener( new OnSeekBarChangeListener(){
    public void onProgressChanged(SeekBar seekBar, int progress,boolean fromUser)
    {
        // TODO Auto-generated method stub
        Toast.makeText(seekBar.getContext(), "Value: "+getConvertedValue(progress), Toast.LENGTH_SHORT).show();
    }
    public void onStartTrackingTouch(SeekBar seekBar)
    {
        // TODO Auto-generated method stub
    }
    public void onStopTrackingTouch(SeekBar seekBar)
    {
        // TODO Auto-generated method stub
    }
}); 
```

这部分将在您的 onCreate() 中，您必须使用 findViewById() 或其他东西来获取对 mSeekBar 的引用。

```
public float getConvertedValue(int intVal){
    float floatVal = 0.0;
    floatVal = .5f * intVal;
    return floatVal;
} 
```

这部分是您可以添加到 Activity 的另一种方法，它将在您需要的范围内从 int 转换为 float 值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-06-08T00:45:03.437

```
 textView.setProgress(0);
     textView.incrementProgressBy(1);
     textView.setMax(4);

       public void onProgressChanged(SeekBar seekBar, int progress,
                    boolean fromUser) { 

                       float progressD=(float) progress/2;
                       textView.setText(String.valueOf(progressD)); 
```

// 从 0 到 2 步 0.5

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:28:46.317

您应该实现自己的自定义搜索栏，使其在所需值之间跳转并坚持使用它们，您可以在此处找到有用的信息：

[制作一个自定义的 Skinny ProgressBar / Seekbar](https://stackoverflow.com/questions/7056803/making-a-custom-skinny-progressbar-seekbar)

# gdb - Inspecting the registers from a specific frame

> ID：15647682
> 
> 赞同：1
> 
> 时间：2013-03-26T21:23:40.883
> 
> 标签：gdb

if you are inspecting a dump, you use `info registers` to look at values in registers in gdb, but can you look at the value stored in registers when the program is executing at for eg address 0x76FD6908? eg I only want the value of registers when pc is at a certain address

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:37:03.393

你有两个选择：

1.  `frame X`, 那么`info registers`. 这为您提供了该堆栈帧中的所有寄存器。请注意，某些寄存器可能无法保存，在这种情况下，GDB 会在该帧中为您提供错误的值。
2.  `info frame X`. 这会告诉您仅保存在该帧中的寄存器：

    ```
    Stack frame at 0x7fff5f400150:
     rip = 0x100000eed in foo; saved rip 0x100000eed
     called by frame at 0x7fff5f400170, caller of frame at 0x7fff5f400130
     Arglist at 0x7fff5f400148, args: 
     Locals at 0x7fff5f400148, Previous frame's sp is 0x7fff5f400150
     Saved registers:
      rbp at 0x7fff5f400140, rip at 0x7fff5f400148 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:28:48.607

如果您只想在运行 gdb 时查看特定的内存区域，请使用该`x`命令。此链接可能会有所帮助：

[http://www.delorie.com/gnu/docs/gdb/gdb_56.html](http://www.delorie.com/gnu/docs/gdb/gdb_56.html)

以这种方式检查的内存不称为“寄存器”，但这是您的意思吗？

# android - Enumerate all elements in Selenium Python bindings for Appium

> ID：15647687
> 
> 赞同：7
> 
> 时间：2013-03-26T21:23:58.737
> 
> 标签：android, python, selenium, appium

I am trying to get started with Appium for testing my company's mobile applications. I wish to use the Python bindings to write the scripts, and I need to start with Android apps.

I have the Appium examples all working. I can run `grunt android` and the tests work, and I can run the `android.py` sample app.

But I'm a total newbie and I don't have a clear picture of how to identify the controls in my company's apps. I'm experienced with Python so I thought I would just build a list of control elements and introspect them.

I'm stuck! All of the methods like `driver.find_elements_by_tag_name()` require a specific identifier (or at least I haven't found any wildcard that works).

How can I introspect the Appium tree of elements that represents the Android app under test? How can I enumerate all the elements so I can introspect them? Is there a tree I can walk to find all elements in the app?

I was hoping I could figure out the elements without needing to get the source code for the apps, build the apps in Eclipse, etc. but I can do this if necessary.

P.S. I would prefer to use Python, but would be open to using something else to do the introspection if that works better. I could still write the actual tests in Python, unless the other language was significantly better somehow.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T02:25:29.150

我仍然想要一种从 Python 内省 Selenium 接口的方法。但是我找到了一种可行的方法来清楚地了解应用程序的布局，然后很容易弄清楚如何编写 Selenium 测试。

首先，让您的应用程序在连接到 Android 开发计算机的真实设备上或在模拟器中运行。基本上，如果您运行`adb devices`，您希望看到一个设备，即运行您的应用程序的设备。接下来，运行该`uiautomatorviewer`工具，然后单击`Device Screenshot`工具栏图标。（工具栏图标只有两个：第一个是`Open`图标，看起来像一个文件夹，一个你想要的看起来像一堆手机。）

完成此操作后，将出现您的应用程序的图像，左侧是屏幕截图，右侧是可浏览的树形轮廓。大纲显示了应用程序的所有控件，以及它们的文本标签（如果有）和其他信息（例如该`clickable`属性是该控件`true`还是`false`该控件的属性）。

一个警告：控件显示为编号，但在 Selenium 绑定中，数字可能不一样。在`ApiDemos`示例应用程序中，该`Graphics`按钮的索引号为 4，因为它是第五个按钮，但要通过其位置访问它，我必须使用索引 5。索引 0 是一个不可点击的对象，其中包含文本“API Demos”，在`FrameLayout`构成屏幕标题的不同对象。

因此，我能够对`android.py`脚本进行此更改：

```
#elem = driver.find_element_by_name('Graphics')
elem = driver.find_elements_by_tag_name('TextView')[5] 
```

注释掉`driver.find_element_by_name()`呼叫，而是`TextView`在整个应用程序中找到第六个。这不是最佳实践，但它表明`uiautomationviewer`结果确实让我查看了我需要了解的有关控件的内容。

现在我知道的足够多，可以做一点内省：

```
for elem in driver.find_elements_by_tag_name('TextView'):
    if elem.text == "Graphics":
        break
else:
    print("Could not find desired item") 
```

这并不比打电话更好，`driver.find_element_by_name()`但它表明我在正确的轨道上。

`uiautomatorviewer`是解决我的问题的实用方法。如果你有一个纯 Python 的，请告诉我。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-29T00:02:06.040

Appium 支持 WebDriver 的“页面源”方式。所以你可以这样做：

```
# assume you have a driver object
import json

source = driver.page_source
source = json.loads(source)
# you can now work with source as a python object 
```

# python - "Flattening" a list of dictionaries

> ID：15647690
> 
> 赞同：25
> 
> 时间：2013-03-26T21:24:07.547
> 
> 标签：python, dictionary

So my aim is to go from:

```
fruitColourMapping = [{'apple': 'red'}, {'banana': 'yellow'}] 
```

to

```
finalMap = {'apple': 'red', 'banana': 'yellow'} 
```

A way I got is:

```
 from itertools import chain
 fruits = list(chain.from_iterable([d.keys() for d in fruitColourMapping]))
 colour = list(chain.from_iterable([d.values() for d in fruitColourMapping]))
 return dict(zip(fruits, colour)) 
```

Is there any better more pythonic way?

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-03-29T13:25:58.873

## 为什么要复制？

在 Python 3 中，您可以使用新的[`ChainMap`](http://docs.python.org/3.3/library/collections#collections.ChainMap)：

> **ChainMap 将多个 dicts（或其他映射）组合在一起以创建一个可更新的视图。**
> 底层映射存储在列表中。该列表是公开的，可以使用*maps*属性访问或更新。没有其他状态。查找连续搜索底层映射，直到找到一个键。相反，写入、更新和删除仅对第一个映射进行操作。

您所需要的就是这个（*更改*名称以遵守[Python 命名约定](http://www.python.org/dev/peps/pep-0008/#naming-conventions)）：

```
from collections import ChainMap
fruit_colour_mapping = [{'apple': 'red'}, {'banana': 'yellow'}]
final_map = ChainMap(*fruit_colour_mapping) 
```

然后你可以使用所有正常的映射操作：

```
# print key value pairs:
for element in final_map.items():
    print(element)

# change a value:
final_map['banana'] = 'green'    # supermarkets these days....

# access by key:
print(final_map['banana']) 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-03-26T21:26:06.993

```
finalMap = {}
for d in fruitColourMapping:
    finalMap.update(d) 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2013-03-26T21:28:41.263

```
{k: v for d in fruitColourMapping for k, v in d.items()} 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-03-26T21:26:15.040

而不是解构和重建，只需复制和更新：

```
final_map = {}
for fruit_color_definition in fruit_color_mapping:
    final_map.update(fruit_color_definition) 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-03-30T02:01:42.780

# 方法

使用[reduce](http://docs.python.org/2/library/functions.html#reduce)将每个 dict 应用于空的初始化程序。由于`dict.update`总是返回`None`，所以使用它`d.update(src) or d`来给出`reduce`所需的返回值。

# 代码

```
final_dict = reduce(lambda d, src: d.update(src) or d, dicts, {}) 
```

# 测试

```
>>> dicts = [{'a': 1, 'b': 2}, {'b': 3, 'c': 4}, {'a': 6}]
>>> final_dict = reduce(lambda d, src: d.update(src) or d, dicts, {})
>>> final_dict
{'a': 6, 'c': 4, 'b': 3} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-03-26T21:26:51.510

```
dict(d.items()[0] for d in fruitColourMapping) 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-09-14T09:35:58.357

**给定**

```
d1, d2 = [{'apple': 'red'}, {'banana': 'yellow'}] 
```

**代码**

在 Python 3.5 中，引入了字典解包（参见[PEP 448](https://www.python.org/dev/peps/pep-0448/)）：

```
{**d1, **d2}
# {'apple': 'red', 'banana': 'yellow'} 
```

在 Python 3.9 中，引入了[合并运算符](https://docs.python.org/3.9/whatsnew/3.9.html#dictionary-merge-update-operators)：

```
d1 | d2
# {'apple': 'red', 'banana': 'yellow'} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2020-07-30T03:01:06.483

我想出了一个有趣的一个班轮。

```
>>> a = [{"wow": 1}, {"ok": 2}, {"yeah": 3}, {"ok": [1,2,3], "yeah": True}]
>>> a = dict(sum(map(list, map(dict.items, a)), []))
>>> a
{'wow': 1, 'ok': [1, 2, 3], 'yeah': True} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-10-20T22:31:25.447

你也可以试试：

`finalMap = dict(item for mapping in fruitColourMapping for item in mapping.items())`

# javascript - 如何在 HighStock 图表中创建汇总系列？

> ID：15647692
> 
> 赞同：0
> 
> 时间：2013-03-26T21:24:17.437
> 
> 标签：javascript, highstock

我有一个显示多个数据系列的 HighStock 图表。除了这些数据系列，我还想显示一个系列，它是每个数据点的所有数据系列的总和。

所有这些看起来就像是另一条线，它表示 x 轴上每个点的数据总和。有谁知道我如何使用 HighStock API 轻松做到这一点？

我目前只是在初始化图表之前创建一个总计数据系列，并将其作为我分配给 HighStocks 的数据集中的系列之一。然而，我想让这个动态。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T13:23:48.860

您可以尝试使用 dataLabels 格式化程序[http://api.highcharts.com/highstock#plotOptions.area.dataLabels.formatter](http://api.highcharts.com/highstock#plotOptions.area.dataLabels.formatter)允许定义自己的函数。因此，您应该通过将每个点形式与定义的 x 值相加来计算总和。

# javascript - 如何将 jQuery No Conflict 传递给我放置在命名空间中的对象

> ID：15647697
> 
> 赞同：0
> 
> 时间：2013-03-26T21:24:27.977
> 
> 标签：javascript, jquery

在[这个链接](http://www.codeproject.com/Articles/19030/Namespaces-in-JavaScript)之后，我为我的对象创建了一个命名空间：

```
var Namespace =
{
  Register : function(_Name)
  {
    var chk = false;
    var cob = "";
    var spc = _Name.split(".");
    for(var i = 0; i<spc.length; i++)
    {
      if(cob!=""){cob+=".";}
      cob+=spc[i];
      chk = this.Exists(cob);
      if(!chk){this.Create(cob);}
    }
    if(chk){ throw "Namespace: " + _Name + " is already defined."; }
  },

  Create : function(_Src)
  {
    eval("window." + _Src + " = new Object();");
  },

  Exists : function(_Src)
  {
    eval("var NE = false; try{if(" + _Src + "){NE = true;}else{NE = false;}}catch(err){NE=false;}");
    return NE;
  }
} 
```

定义对象：

```
Namespace.Register("System.Classes.HelloWorld"); 

System.Classes.HelloWorld = function(aa){ return {

    Message : "Hello World!",

    Hello : function(a,b)
    {
        alert(this.Message + a + b);
    }

};} 
```

如何将 jQuery NoConflict 传递给该对象并允许我使用 $ 符号？

例如[本文](http://enterprisejquery.com/2010/10/how-good-c-habits-can-encourage-bad-javascript-habits-part-1/)创建了一个类似的对象，仅以我无法应用于上述代码的方式传入 jQuery NoConflict。

此代码包装 jQuery NoConflict 并允许我想复制的美元符号：

```
(function( skillet, $, undefined ) {
    //Private Property
    var isHot = true;

    //Public Property
    skillet.ingredient = "Bacon Strips";

    //Public Method
    skillet.fry = function() {
        var oliveOil;

        addItem( "\t\n Butter \n\t" );
        addItem( oliveOil );
        console.log( "Frying " + skillet.ingredient );
    };

    //Private Method
    function addItem( item ) {
        if ( item !== undefined ) {
            console.log( "Adding " + $.trim(item) );
        }
    }    
}( window.skillet = window.skillet || {}, jQuery )); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:09:58.663

您可能想尝试这种模式：

```
var Namespace = (function($) {
    //Private members
    var register = function(_Name) {
        //...
    };
    var create = function(_Src) {
        //...
    };
    var exists = function(_Src) {
        //...
    };

    //Expose public members
    return {
        register : register,
        create : create,
        exists : exists
    };
})(jQuery); 
```

这不仅允许定义各种私有成员，而且还避免了使用`Namespace.`or为内部函数调用添加前缀的需要`this.`。

# c++ - 返回类内的私有类

> ID：15647699
> 
> 赞同：1
> 
> 时间：2013-03-26T21:24:39.407
> 
> 标签：c++, linked-list, return

```
class LinkedList_Movies
{
private:
    class Node
    {
    public:
        Movie* data;
        Node* next;                
    }; 
    Node* head;

public:
    LinkedList_Movies() { head = NULL; }
    ~LinkedList_Movies();
    Movie* searchById(const string& id);
    void Add(const string& id, const string& name);
    void Print();
    Node* FindPlace(); // <<<<<<<< this func

}; 
```

`.h`以上是我在文件中的链接列表。我想返回一个指向 Node.js 的指针。但在`.cpp`文件中，它不会让我执行以下操作：

```
Node* LinkedList_Movies::FindPlace()
{

} 
```

它告诉我：`Node is undefined`。

我知道`Node`是私人的。那么，我该如何退货呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-26T21:27:29.420

您需要限定`Node`，因为您当前正在类*之外*定义函数：

```
LinkedList_Movies::Node* LinkedList_Movies::FindPlace()
{

} 
```

请注意，此函数的调用者将无法很容易地存储指针：

```
LinkedList_Movies movies;
LinkedList_Movies::Node* node = movies.FindPlace(); 
```

这将给出编译器错误，因为`LinkedList_Movies::Node`is `private`。但是，这可能正是您想要的。

他们可以使用以下方法来做到这*一点*`auto`：

```
LinkedList_Movies movies;
auto node = movies.FindPlace(); 
```

或者，等效地，当传递给推导的模板参数时：

```
template <typename T>
void foo(T t);

foo(movies.FindPlace()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T21:26:36.123

首先，类型名称是 LinkedList_Movies::Node，而不仅仅是“Node”。

其次，由于课程是私有的，因此这可能不起作用。即使它有效，它对其他函数也无用，因为这些函数对这个对象是什么以及如何使用它一无所知。您尝试执行的此功能可以是私有的，因为 Node 类型仅对您的 LinkedList_Movies 类有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-26T21:28:27.283

正如您所说的那样：Node 是该类的私有子`LinkedList_Movies`类。在类定义本身之外调用它时，您必须解析其范围：

```
LinkedList_Moves::Node* LinkedList_Movies::FindPlace(); 
```

否则编译器将尝试在全局范围内寻找一个`Node`在这种情况下不存在的类。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-26T21:51:58.663

在像这样的声明中

```
Node* LinkedList_Movies::FindPlace() 
```

`LinkedList_Movies`编译器在看到限定的函数名称之前不知道它在类中。因此，当它在看时`Node`，它不知道往里看`LinkedList_Movies`。您需要限定返回类型：

```
LinkedList_Movies::Node* LinkedList_Movies::FindPlace() 
```

请注意，参数不需要限定，因为它们位于函数名称之后，因此例如：

```
void LinkedList_Movies::DoStuff(Node *foo) 
```

假设在类定义中声明了一个合适的原型。

在 C++11 中，您可以选择使用后缀返回类型，这是解决问题的一种更简洁的方法：

```
auto LinkedList_Movies::FindPlace() -> Node* {
    ...
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-26T21:30:13.477

您需要指定 Node 类的全名，即 LinkedList_Movies::Node。但是，在公共方法中返回指向私有类型的指针有什么意义呢？无论如何，只有私有方法才能使用它。

# objective-c - 使用目标 C 以编程方式更改登录会话

> ID：15647706
> 
> 赞同：0
> 
> 时间：2013-03-26T21:25:01.823
> 
> 标签：objective-c, session, login, sudo

在具有两个或更多活动用户的多用户 Mac OS X 中，我们可以在终端上使用 sudo 命令获得 root 权限，然后在终端上使用“su - username”命令在用户会话之间切换。我想知道如何编写一个程序来做这 this this 使用目标 C 吗？

我怎样才能拥有root权限并将登录会话从当前用户更改为另一个活动用户，然后使用我们切换到其会话的新用户权限，并执行某些操作，例如执行其他程序或启动进程，因此当我们启动进程时在特定用户的会话中，进程的所有者必须是该用户。最后我想知道如何编写一个程序来切换到另一个活动用户会话并在该会话上启动一个进程。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:01:33.190

您可以通过启动一个进程来调用以下命令来快速切换到另一个用户：

> /System/Library/CoreServices/Menu\ Extras/User.menu/Contents/Resources/CGSession -switchToUserID $USERID

切换后，用户将不得不启动应用程序。或者应用程序需要处于启动状态。

# ios - 无法在沙盒外为 THEOS Tweak 创建目录

> ID：15647717
> 
> 赞同：2
> 
> 时间：2013-03-26T21:26:11.120
> 
> 标签：ios, objective-c, jailbreak, theos

我正在使用连接到 Google Chrome 应用程序的 THEOS 对 iPhone 进行调整。部分调整功能是使用 ASIHTTPRequest/ASINetworkQueue 处理下载和保存文件。用户可以自由选择和设置下载目的地。只要我将下载路径设置为“/tmp”或 Google Chrome 文档文件夹，它就可以正常工作。当我尝试选择其他文件夹时，例如“/var/mobile/Documents/”，我没有收到权限错误：

> Domain=NSCocoaErrorDomain Code=513 "操作无法完成。(Cocoa 错误 513.)" UserInfo=0x1f53e230 {NSFilePath=/var/mobile/Documents, NSUnderlyingError=0x1f53b3d0 "操作无法完成。操作不允许

我查看了这个错误并尝试了 StackExchange 上建议的所有其他答案，但无济于事。

我正在为 IOS 6 开发，我将在这里阅读的答案作为链接包含在内，以防你们认为我错过了一些东西：

1 -[如何制作iOS目录？](https://stackoverflow.com/questions/8030054/how-to-make-a-directory-ios)

2 - [iphone在沙箱外创建文件夹](https://stackoverflow.com/questions/10281618/iphone-create-folder-outside-sandbox)

3 -[未创建 Cydia 应用程序文档文件夹](https://stackoverflow.com/questions/9065585/cydia-app-documents-folder-not-created)

4 -[在 iOS 上为 NSFileManager 获得 root 权限（越狱）](https://stackoverflow.com/questions/7841344/error-permission-denied-when-accessing-ios-filesystem-jailbreak)

最后一个链接是指以 root 身份运行应用程序以访问非移动目录，但不确定这是否合适，因为我只是对 Chrome 进行了调整。

我希望有人可以帮助我解决这个问题或为我指明正确的方向。我在扯头发。

这是一个用于创建对我不起作用的目录的通用代码片段：

```
NSString* SaveDir = @"/var/mobile/Documents/Test";
NSFileManager* fileManager = [NSFileManager defaultManager];

NSMutableDictionary* attributes = [[NSMutableDictionary alloc] init];
NSNumber* permission = [NSNumber numberWithLong: 0755];
[attributes setObject:permission forKey: NSFilePosixPermissions];
NSError* error = nil;
if (![fileManager createDirectoryAtPath: SaveDir 
            withIntermediateDirectories: YES       
                             attributes: attributes 
                                  error: &error]) 
{
    NSLog(@"Unable to create data directory: %@", error);
}
[attributes release]; 
```

提前谢谢你们

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T23:07:53.780

我对 Bigboss 的 Cocoanuts Sandcastle 的注释是正确的。我已经链接到 Sandcastle dylib 并使用它的方法我能够在沙箱之外创建文件/目录。

另一个库是 H2Co3 [Unbox](https://github.com/H2CO3/Unbox)，它允许做同样的事情，唯一的区别是 unbox 命令由守护进程执行。

# javascript - 选项标签的宽度

> ID：15647718
> 
> 赞同：0
> 
> 时间：2013-03-26T21:26:13.070
> 
> 标签：javascript, jquery, html, css, html-select

下午好，

我有一个选择框，选择框的宽度设置为 50px。我需要指定选项下拉框的宽度。现在，我的价值是如此之长，以至于它从屏幕上流出。例如，我想将其设置为固定宽度，例如 200px。我试图让文本溢出到另一行而不是被切断。

我已经尝试过：

```
option style="width: 200px" 
option width="200" 
```

我已经尝试过将其作为内联样式并放入我的样式表中。

顺便说一句，我正在使用 Chrome 和 Firefox。

感谢所有帮助。^^

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T21:42:06.380

要为您的选择框设置固定宽度，您可以编写

```
select{
  width: 200px
} 
```

您不能通过标准方法使文本溢出到另一行。但是，您可能会在网上找到一些插件。由于浏览器兼容性问题，不推荐使用。

我发现这个链接可能对[github](https://github.com/fnagel/jquery-ui/wiki/Selectmenu)有帮助，[demo](http://jsfiddle.net/fnagel/GXtpC/embedded/result/)

# javascript - 如何获得 lerp 函数的逆

> ID：15647720
> 
> 赞同：1
> 
> 时间：2013-03-26T21:26:17.290
> 
> 标签：javascript, math

```
speed = Math.Lerp(speed, goalSpeed, time); 
```

此代码几乎立即将速度提高到接近目标速度，然后在接近目标速度时减慢速度。我怎样才能把它翻转过来，让它慢慢加速，然后在接近它时开始加速？

这可能是一个简单的答案，但它已经逃避了我十分钟。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T22:30:54.227

从`1%`以下`goalSpeed`代码开始可以帮助您缓慢提高速度然后加快速度：

```
speed = 0.01 * goalSpeed; // Initial speed
speed = speed + Math.Lerp((goalSpeed - speed), goalSpeed, time); 
```

//`speed`交叉时取整`goalSpeed`并停止。

# angularjs - angularjs过滤远程内容

> ID：15647722
> 
> 赞同：0
> 
> 时间：2013-03-26T21:26:38.540
> 
> 标签：angularjs, playframework-2.1

我从服务中获得了一个带有角度内容的 html，内容是这样的

```
<div>{{ @event.dateBegin | stringToDate }}</div> 
```

该服务类似于

```
$scope.setContext = function() {
   $http.get(service).success(function(response) {
          $scope.content = response;
    }); 
```

内容 div 是

```
<div class="span9" ng-bind-html-unsafe="content"></div> 
```

结果我得到了正确的 html formmed div，但是 {{ }} 部分不起作用，我同意 angular-sanitize 但也不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T04:09:00.687

您可以使用[$interpolate 服务](http://docs.angularjs.org/api/ng.%24interpolate)。文档中的示例：

```
var $interpolate = ...; // injected
var exp = $interpolate('Hello {{name}}!');
expect(exp({name:'Angular'}).toEqual('Hello Angular!'); 
```

因此，在您的具体示例中，在您的成功回调中：

```
var exp = $interpolate(response);
$scope.content = exp(event); 
```

作为建议，如果您可以提供帮助并将所有模板保留在您的 Angular 应用程序中，我只会传回数据，而不是 HTML。

# image - Contourf 和 NaNs（如何使白色区域透明）

> ID：15647727
> 
> 赞同：13
> 
> 时间：2013-03-26T21:26:52.897
> 
> 标签：image, matlab

我正在尝试`contourf`绘制图，但数据数组的某些区域具有 NaN（仅在数据矩阵中，x 和 y 网格矩阵已满）。我希望这些 NaN 是透明的，它们用于矩形边界上的 NaN。但是，数据矩阵内的连续 NaN 区域是白色的，而不是透明的。下面是一个例子：

代码：

```
[X Y] = meshgrid(10:50);
Z = X.*Y;
Z(10:30,10:30) = NaN;
figure
imshow(uint8(repmat(1:4:240,[60,1,3])));
hold on;
contourf(X,Y,Z);
colormap jet; 
```

输出：

![在此处输入图像描述](../Images/255ac5b1d1b1620a6703c8b44dab3632.png)

暗示：

附加上面的代码：

```
% Find Face
set(findobj(h,'FaceColor',[1 1 1]),'FaceAlpha',0)) 
```

将找到白色补丁对象并将其设置为透明。不幸的是，下面的补丁已满：

![在此处输入图像描述](../Images/f00bdc2378377bd6c432c60e8c7d3e68.png)

更新：获取`NaN`区域并叠加背景图像会导致：

![在此处输入图像描述](../Images/11bf083fa1b090390ef60a03de814f16.png)

如您所见，它没有覆盖整个图像。如果我使用`imdilate`它会消除白色区域，但同时也会破坏黑色边框以及一些数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-09T05:45:04.953

基于 H. Muster 的回答，我通过分割数据人为地创建了波段（您可以使用一个简单的函数来选择波段，或者`contour`在虚拟人物上创建它们，返回它们，然后重新使用它们）。

```
[X Y] = meshgrid(10:0.1:50);
Z = X.*Y;
Z(100:300,100:300) = NaN;
figure
hold on;
h = pcolor(X,Y,round(Z/500)*500);
set(h,'Edgecolor',  'interp');
colormap jet;
set(gca, 'XLim', [0 60], 'YLim', [0 60]); 
```

恐怕我没有包含的工具箱，`imread`因此无法显示底层渐变，但我认为这会起作用。我必须将分辨率提高 10 倍才能获得相当平滑的图像。

![在此处输入图像描述](../Images/97a3a234bc2703a8660a297c22345653.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-08T07:31:56.610

是否可以使用[`pcolor`](http://www.mathworks.de/de/help/matlab/ref/pcolor.html)而不是`contourf`？

```
[X Y] = meshgrid(10:50);
Z = X.*Y;
Z(10:30,10:30) = NaN;
figure
imshow(uint8(repmat(1:4:240,[60,1,3])));
hold on;
h = pcolor(X,Y,Z)
set(h,'Edgecolor',  'interp');
colormap jet; 
```

![在此处输入图像描述](../Images/f610ccbb315be629952a984ce0c59ab5.png)

# ruby-on-rails-3 - Rails 复选框 - 允许用户选择一周的休息日

> ID：15647729
> 
> 赞同：0
> 
> 时间：2013-03-26T21:27:02.093
> 
> 标签：ruby-on-rails-3

我有一个模型名称“Deal”和一个名为“Days”的字符串。我希望能够允许我的用户选择优惠可用的天数。可能是一天（星期一），也可能是多天（星期一、星期三、星期五...） 我该怎么做？

我试过这个：

```
<div class="field">
    <%= f.label :monday %>
    <%= f.check_box :days, {}, "monday", "monday" %>
</div>

<div class="field">
   <%= f.label :tuesday %>    
   <%= f.check_box :days, {}, "tuesday", "tuesday" %>
</div> 
```

但它会覆盖仅显示“星期二”的第一个选项。

我是否必须为一周中的每一天向模型添加一个字符串，还是有更简单的选择？谢谢。

**交易控制器：**

```
class DealsController < ApplicationController

def index
  @deals = Deal.all

  respond_to do |format|
    format.html # index.html.erb
    format.json { render json: @deals }
  end
end

def show
  @deal = Deal.find(params[:id])

  respond_to do |format|
    format.html # show.html.erb
    format.json { render json: @deal }
  end
end

def create
  @deal = Deal.new(params[:deal])
  @deal.created_at = Time.now
  @deal.user = current_user

  respond_to do |format|
    if @deal.save
      format.html { redirect_to @deal, notice: 'Deal was successfully created.' }
      format.json { render json: @deal, status: :created, location: @deal }
    else
      format.html { render action: "new" }
      format.json { render json: @deal.errors, status: :unprocessable_entity }
    end
  end
end
end 
```

**交易.rb**

```
class Deal < ActiveRecord::Base
    belongs_to :user    
    attr_accessible :title, :description, :days
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:44:15.533

如果我理解正确，您可能需要创建一个 :day 属性（字符串可能是最简单的），然后使用[单选按钮](http://guides.rubyonrails.org/form_helpers.html#radio-buttons)（而不是复选框）来允许用户仅选择其中一个选项。

您的视图将如下所示：

```
<div class="field">
    <%= f.label :day, "Choose the day:" %>
    <%= f.radio_button :day, "monday", "tuesday", "wednesday" %>
</div> 
```

或者，您可以使用[select tag](http://guides.rubyonrails.org/form_helpers.html#the-select-and-option-tags)，如下所示：

```
<%= f.select_tag(:day, [['Monday', 'Monday'], ['Tuesday', 'Tuesday], ...]) %> 
```

我在回答正确的问题吗？

**编辑**嗯。以前从未尝试过。如果您希望用户能够选择几天，最简单的方法可能是为每天创建一堆 attr_accessor 变量，为每个变量创建一个复选框，然后让您的控制器或模型中的 before_validate 操作更新:days 模型中的属性（一个数组）将所有检查的天数添加到数组中。该模型方法的混乱版本将是这样的：

```
attr_accessible :days, ...
attr_accessor :monday, :tuesday, :wednesday...

before_validation :update_days

def update_days
  day_array = []

  day_array << "Monday" if self.monday == true
  day_array << "Tuesday" if self.tuesday == true
  ...

  self.update_attribute(:days, day_array)
end 
```

然后，在您看来，为每个临时属性单独的复选框：

```
<div class="field">
    <%= f.label :monday %>
    <%= f.check_box :monday %>
</div>
<div class="field">
    <%= f.label :tuesday %>
    <%= f.check_box :tuesday %>
</div> 
```

您甚至可以在 application_helper 中创建一个日期助手，它只是一个日期符号数组，因此您可以执行以下操作：

```
<% days_of_the_week.each do |day| %>
    <div class="field">
        <%= f.label day %>
        <%= f.check_box day %>
    </div>
<% end %> 
```

以避免重复。

同样，这不是最干净的方式，但我认为这会起作用，除了将 days 属性更改为数组之外，您无需做任何事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:31:19.447

我认为你的观点大部分是正确的。我怀疑错误出在您的控制器中。如果您可以发布控制器的代码，这可能有助于我们识别问题，但我会提供一种可能的解决方案。

使用您拥有的代码，Rails 会将字段解析为像`params[:deal][:days]`. 该哈希将保存代表日期的值数组。在走得太远之前，我认为您的代码中有错误。check_box 函数的原型是

```
check_box(method, options = {}, checked_value = "1", unchecked_value = "0") 
```

`checked_value`您为和提供了相同的值`unchecked_value`。让我们修复它并将其更改为

```
<%= f.check_box :days, {}, "tuesday", "" %> 
```

然后，我相信您的控制器将收到的价值看起来像

```
params[:deal][:days] == ['', 'Monday', 'Tuesday', '', '', 'Friday', ''] 
```

在控制器中，您可以遍历此数组并将它们分配给您的模型。

```
deal.days.clear
params[:deal][:days].each do |day|
  deal.days << day if day.present?
end 
```

我目前无法对此进行测试，因此请将其视为伪代码，希望您能朝着正确的方向前进。

# javascript - 使用 href=javascript:blah() 时如何不显示 url

> ID：15647732
> 
> 赞同：0
> 
> 时间：2013-03-26T21:27:18.420
> 
> 标签：javascript, html

不知道这是否容易（因为我不精通 javascript 和/或 html），但我试图让 url（在这种情况下是一个函数）在鼠标悬停时不显示。我已经用 HTML 完成了，但没有使用 javascript.. 我的简单代码如下...

```
<a href="javascript:CloseAndOpen(1);">Click Here</a> 
```

我不希望出现 a href。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:28:36.263

根本不要在“href”值中使用 JavaScript。

```
<a href=# onclick='CloseAndOpen(1)'>Click Here</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T21:32:05.877

链接应该显示它的去向。如果您不想显示地址，请不要使用链接，只需使用带有点击事件的常规元素：

```
<span onclick="CloseAndOpen(1);">Click here</span> 
```

您可以使用 CSS 对其进行样式设置，使其看起来像一个链接，如果您愿意的话。

# php - 在 php 中的 Javascript (jQuery) 中定义的访问变量

> ID：15647733
> 
> 赞同：0
> 
> 时间：2013-03-26T21:27:21.517
> 
> 标签：php

在我的 php 文件中，javascript/html 代码是使用 echo 编写的。我想访问将要放置在 javascript 中“place1”div 中的图像并将其传递给 php。

这是我的代码：

```
 // create a placeholder for an image- user is going to drag and drop an image here
echo "<div id= 'place1' class = 'place'></div>";
echo '<button id="apply" name="save" type="submit">Apply Changes</button>';
echo '<script src="http://code.jquery.com/jquery-1.9.1.js"></script>';
//javascipt code to find the source of that image
echo 
'<script>
    $(document).ready(function(){
        $("#apply").click(function() {
            var frame = $("#place1").children("img").attr("src");
            $.ajax({
                url: "thumbnails.php",
                type: "POST",
                data: frame
            });
        });
    });
</script>';

 // access frame variable (image source) in php ??? not sure how to do this part..
$frame = $_post['frame']; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:30:46.637

在您的 jquery 中，您必须在发送时使用键/值对`data`：

`key=value`

考虑到这一点，对于您`data`要发送的内容，您正在使用变量`frame`，但`frame`没有键/值对。它应该是：

```
var frame = "frame="+$("#place1").children("img").attr("src"); 
```

这将允许您在 PHP 中捕获变量：

`$frame = $_POST['frame']`

# java - Java：堆栈-> ArrayList

> ID：15647734
> 
> 赞同：-1
> 
> 时间：2013-03-26T21:27:25.513
> 
> 标签：java, stack

这是我到目前为止所拥有的：

```
System.out.println("\fStack - ArrayList Demo\n");

        ArrayList<String> al = new ArrayList<String>();
        Stack<String> st = new Stack<String>();

        // Start with a few elements to the ArrayList
        al.add("A");
        al.add("B");
        al.add("C");

        st.addAll(al); // Retrieve ArrayList elements for the stack and add them there
        al.clear(); // Clear arraylist for storage later

        // Pop out the last element in the stack.
        System.out.println("\nPop out the last element: "+al.add(st.pop()));
        System.out.println("What's left of the stack: "+st+"\n");
        System.out.println("ArrayList, now: "+al);

        // Keep popping..
        int count = st.search("A");
       while (count != -1 && count >= 1) {
           System.out.println("Popping next.."+al.add(st.pop()));
           count--;
        }

        // Is the Stack empty?
        System.out.println("\nStack Empty? "+st.empty());
        System.out.println("ArrayList now: "+al); 
```

当我运行程序时，使用`al.add(st.pop()));`返回“true”。有没有办法让它产生被弹出的实际元素（A，B，C）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-23T22:11:20.763

用于添加状态的[javadoc ：](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html#add%28E%29)

```
Returns:
true (as specified by Collection.add(E)) 
```

听起来您想打印要添加的元素。所以：

```
 String elem = st.pop();
   System.out.println("adding " +elem);
   al.add(elem) 
```

如果您打算成为一名软件开发人员，那么阅读和理解文档是一项宝贵的实践技能。

# java - 如何在不偏离中心的情况下使圆比内 部的弧大？

> ID：15647738
> 
> 赞同：0
> 
> 时间：2013-03-26T21:27:42.840
> 
> 标签：java, geometry

这是我的代码：

```
import java.awt.Graphics;
import java.awt.GridLayout;
import javax.swing.JPanel;
import javax.swing.JFrame;

public class fourfans extends JFrame {
public fourfans(){
    setTitle("DrawArcs");
    add(new ArcsPanel());
    add(new ArcsPanel());
    add(new ArcsPanel());
    add(new ArcsPanel());

}

public static void main(String[] args) {
    fourfans frame = new fourfans();
    GridLayout test = new GridLayout(2,2);
    frame.setLayout(test);
    frame.setSize(250 , 300);
    frame.setLocationRelativeTo(null); // center the frame
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setVisible(true);

}

}

class ArcsPanel extends JPanel{

protected void paintComponent(Graphics g){
    super.paintComponent(g);

    int xCenter = getWidth() / 2;
    int yCenter = getHeight() / 2;
    int radius = (int)(Math.min(getWidth(), getHeight()) * 0.4);

    int x = xCenter - radius;
    int y = yCenter - radius;

    g.fillArc(x, y, 2 * radius, 2 * radius, 0, 30);
    g.fillArc(x, y, 2 * radius, 2 * radius, 90, 30);
    g.fillArc(x, y, 2 * radius, 2 * radius, 180, 30);
    g.fillArc(x, y, 2 * radius, 2 * radius, 270, 30);
    g.drawOval(x, y, 2 * radius, 2 * radius);       
}
} 
```

每次我尝试将 2 * 半径更改为 2.1 * 半径时，它都不会让我这样做，因为那是双倍的。然后，当我输入一个大于弧的固定数字时，它会使圆偏离中心。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:31:23.890

输入大于圆弧的数字会使圆偏离中心的原因是因为 Java 将左上角插入为 x,y 而不是圆/圆弧的原点。因此，如果你让其中一个更大，你必须重新计算它的 x 和 y 是什么，例如

```
int radius = (int)(Math.min(getWidth(), getHeight()) * 0.4);
int radiusOval = (int)(Math.min(getWidth(), getHeight()) * 0.4 * 1.05);

int x = xCenter - radius;
int y = yCenter - radius;
int xOval = xCenter - radiusOval;
int yOval = yCenter - radiusOval;

g.fillArc(x, y, 2 * radius, 2 * radius, 0, 30);
g.fillArc(x, y, 2 * radius, 2 * radius, 90, 30);
g.fillArc(x, y, 2 * radius, 2 * radius, 180, 30);
g.fillArc(x, y, 2 * radius, 2 * radius, 270, 30);
g.drawOval(xOval, yOval, (int)(2.1 * radius), (int)(2.1 * radius)); 
```

# java - 如何在使用 Java 读取 STDIN 时提供可编辑的默认值？

> ID：15647740
> 
> 赞同：2
> 
> 时间：2013-03-26T21:27:52.387
> 
> 标签：java, io, console

. . 我有一个 Java 控制台应用程序，它向用户显示 key=value 属性列表并将它们编入索引，以便他们可以键入索引号，然后编辑值，例如：

```
[0] foo=value 1
[1] bar=value 2
prompt> edit 1
bar=value 2
new value?: * 
```

（星号是提示符）。我正在使用我认为的标准习语来收集输入：

```
BufferedReader bufferRead = new BufferedReader(new InputStreamReader(System.in));
        input = bufferRead.readLine(); 
```

我的问题是我想在提示后向用户提供现有值，以便他们可以简单地修改该值，例如：

```
[0] foo=value 1
[1] bar=value 2
prompt> edit 1
bar=value 2
new value?: value 2* 
```

我该怎么做呢？从概念上讲，我似乎想用现有值预加载输入阅读器，但我不确定这是否是正确的想法或我将如何做到这一点。我看到 perl 的类似[问题](https://stackoverflow.com/questions/8021871/how-can-i-provide-an-editable-default-value-when-prompting-for-user-input)，但没有遇到 Java 的任何问题。我有一种感觉，这似乎很容易，但实际上并非如此。. . ?

安迪

# java - 客户端从服务器读取太多字节？

> ID：15647754
> 
> 赞同：0
> 
> 时间：2013-03-26T21:28:36.617
> 
> 标签：java, sockets, ftp

我正在编写一个简单的 FTP 客户端/服务器设置。客户端应该能够从服务器检索文件并将结果作为字节流放入 /retr_files/filex。从服务器发送适当的响应，并且确实在文件夹中创建了 file1。但是，发送（或接收）的字节太多。我在一个 9.6kB 的文件上进行了测试，它在客户端制作的文件是 16.6kB。奇怪的。我觉得我在这里遗漏了一些明显的东西，有人可以帮我吗？谢谢！

相关代码：

客户：

```
BufferedReader inFromServer_d = null;

    if(welcomeSocket!=null){
        if(!welcomeSocket.isClosed()){
            welcomeSocket.close();
        }
    }

    try {
        welcomeSocket = new ServerSocket(port);
        System.out.print("PORT " + myIP + "," + num1 + "," + num2 + "\r\n");
        out.writeBytes("PORT " + myIP + "," + num1 + "," + num2 + "\r\n");
        System.out.print(parseReply(getResponse()));
        System.out.print("RETR " + pathname + "\r\n");
        out.writeBytes("RETR " + pathname + "\r\n");
        String reply = parseReply(getResponse());
        if (reply.charAt(10)=='1') {
            System.out.print(reply);
            System.out.print(parseReply(getResponse()));

            try{
                clientSocket_d = welcomeSocket.accept();
            } catch (IOException e) {
                System.out.print("GET failed, FTP-data port not allocated.\r\n");
                System.exit(-1);
            }

                inFromServer_d = new BufferedReader(new InputStreamReader(
                        clientSocket_d.getInputStream()));

            // READ
            BufferedReader bufferedReader = inFromServer_d;
            FileWriter output = new FileWriter("retr_files/file" + retrCnt);
            BufferedWriter bufferedWriter = new BufferedWriter(output);

            String length;
            while ((length = bufferedReader.readLine()) != null) {
                bufferedWriter.write(length + "\n");
            }

            bufferedReader.close();
            bufferedWriter.close();
            clientSocket_d.close(); 
```

服务器：

```
//TCP CONNECT
                        DataOutputStream outToClient_d = null;
                        Socket clientSocket1 = null;

                        try {
                            ipAddress = ipAddress.substring(0, ipAddress.length()-1);
                        clientSocket1 = new Socket(ipAddress, portNumber);
                        outToClient_d = new DataOutputStream(clientSocket1.getOutputStream());
                        }

                        catch(UnknownHostException e){
                          out.writeBytes("425 Can not open data connection.\r\n");
                        }

                        BufferedReader bufferedReader = new BufferedReader(input);

                        String length;
                        while((length = bufferedReader.readLine())!=null){
                            outToClient_d.writeBytes(length+"\n");
                        }
                        out.writeBytes("250 Requested file action completed.\r\n");
                        bufferedReader.close();
                        clientSocket1.close();
                        outToClient_d.close(); 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:55:13.187

不要使用 Readers 和 Writers 以及 readLine()。所有文件都不是文本文件，也不是所有文本文件都有换行符。使用流。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:43:48.703

我猜在您的客户端，新创建的文件必须在每个打印行之间有额外的新行。这可能会导致文件大小增加。在客户端替换此行：

```
bufferedWriter.write(length + "\n"); 
```

至

```
bufferedWriter.write(length); 
```

# algorithm - 如何找到与给定节点集等距的图中的所有节点？

> ID：15647757
> 
> 赞同：7
> 
> 时间：2013-03-26T21:28:46.903
> 
> 标签：algorithm, graph, complexity-theory, graph-algorithm

如果您有一个简单的无向图`G(V,E)`，并且`F`它是`V`. 你怎么能找到某个节点`v`，使得每个节点`F`到`v`的距离相同并且距离最小？`None`如果没有就返回`v`。有人告诉我，这可以`O(|V|+|E|)`复杂地完成。

假设所有边的距离为 1。

谁能解释如何做到这一点？伪代码也会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T04:41:20.860

这是一种算法，采用伪代码，试图添加注释来解释它是如何工作的。

```
declare explored // a table of all the vertices that can keep track of one number (distance, initialized to -1) and a list of vertex references (origins, initialized to null)
to_explore = S  // fifo queue of vertices to explore

while (to_explore not empty) {
    pop vertex v from to_explore
    current_distance = explored[v].distance
    current_origins = explored[v].origins
    for (vertex n, neighbor of v) {
        if (explored[n].origins contains v)
            continue // we just hit a loop and we're only interested in shortest distances
        if (explored[n].distance == -1) { // first time we come here
            explored[n].distance = current_distance+1
            explored[n].origins = current_origins
            push n to to_explore
            continue
        }
        if (explored[n].distance != current_distance+1) {
            continue // we are merging path from another node of S but different distance, cannot lead to any solution
        }
        // only case left is explored[n].distance == current_distance+1
        // so we've already come here from other place(s) in S with the same distance
        add / merge (without duplicates) origins to explored[n].origins
        if (explored[n].origins = S) // maybe compare the size is enough?
            return n // we found a solution
        // if not , we just continue our exploration, no need to add to the queue since we've already been through here before
    }
} 
```

这个想法是，使用 FIFO 队列，我们​​将探索距离集合 S 距离为 1 的所有内容，如果我们无法在那里找到任何解决方案，那么我们将首先找到最短距离。

我不完全确定复杂性，但我相信在最坏的情况下，我们只探索每个顶点和每条边一次，这样就可以得到`O(|E| + |V|)`. 但在某些情况下，我们会多次访问同一个顶点。虽然这并没有增加太多探索的路径，但我不确定是否应该有一个因素 |S| 某处（但如果这只是被认为是一个常数，那么没关系......）

希望我没有错过任何东西。显然我没有测试任何这些...... :)

**编辑**（回复评论）

> 您的代码是否适用于这样的图表？E = (a, b), (a, c), (a,d) , (b,e), (c,e), (d, e) 和我的 F = { b, c, d}。比如说，你以 a 开始你的 bfs。我怀疑，最后 origins 数组将只有 {a}，因此代码将返回 None。– 大师德瓦拉

在这种情况下，会发生以下情况：

```
to_explore is initialized to {b,c,d}
//while (to_explore not empty)
pop one from to_explore (b). to_explore becomes {c,d}
current_distance=0
current_origins={b}
//for (neighbors of b) {
handling 'a' as neighbor of b first
explored[a].distance=1
explored[a].origins={b}
to_explore becomes {c,d,a}
//for (neighbors of b)
handling 'e' as next neighbor of b
explored[e].distance=1
explored[e].origins={b}
to_explore becomes {c,d,a,e}
//while (to_explore not empty)
pop one from to_explore (c). to_explore becomes {d,a,e}
current_distance=0
current_origins={c}
//for (neighbors of c)
handling 'a' as neighbor of c first
explored[a].distance is already 1
explored[a].origins={b,c}
to_explore already contains a
//for (neighbors of c) {
handling 'e' as next neighbor of b
explored[e].distance is already 1
explored[e].origins={b,}
to_explore already contains e
//while (to_explore not empty)
pop one from to_explore (d)
current_distance=0
current_origins={d}
//for (neighbors of d)
handling 'a' as neighbor of d first
explored[a].distance is already 1
explored[a].origins={b,c,d}
that matches F, found a as a solution. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T23:22:49.833

解决方案与 BFS 类似，但略有不同：

1.  从 S = F 开始，标记 F 个节点。

2.  查找 |S| 与 S 中每个元素的距离为 1 的集合（所有这些集合都应包含未标记的节点）。如果这些集合的交集不为空，则找到候选。

3.  取 |S| 的并集 在上面的 S' 中设置并标记这些节点。如果 S' 为空，则返回 'None'。

4.  返回步骤 2。

假设所有的集合操作都花费恒定的时间，那么算法的复杂度与 BFS 相同，即 O(|V| + |E|)。

现在来推理集合操作的复杂性。我的理由是集合操作不会增加复杂性，因为步骤 2 和 3 中的并集和交集操作可以组合起来花费时间 O(|S|)，并且因为在每个步骤中，S 都不同于先前迭代中的 S ，集合操作的整体复杂度为 O(|V|)。

# mongodb - Mongo - 一次查询多个位置

> ID：15647762
> 
> 赞同：0
> 
> 时间：2013-03-26T21:29:23.183
> 
> 标签：mongodb, geospatial, mongodb-query

我目前正在尝试查找居住在位置列表中的任何一个中的所有用户（此位置列表可能很大，因此与服务器端的联合相比，进行多个查询不一定是理想的）。

例如，用例是查找居住在我当前城市的任何教堂 2 英里范围内的所有用户，并给出这些教堂的坐标列表。

现在，以下位置查询有效：

```
db.users.count( { location: { $within: { $centerSphere: [ [-84.330984, 33.8615], 2 / 3959  ] } } } ) 
```

也：

```
db.users.count( {location : { $near : [ -84.330984 , 33.8615 ] , $maxDistance : 2 / 69 }  }) 
```

但是，我希望能够计算居住在不同位置范围内的用户数量。即类似的东西：

```
db.users.count( { $or: [{ location: { $within: { $centerSphere: [ [-84.330984, 33.8615], 2 / 3959  ] } } },{ location: { $within: { $centerSphere: [ [-85.331122, 34.97832], 2 / 3959  ] } } } ] } ) 
```

现在，当我运行这个查询时，Mongo 给出了记录的错误：

```
Tue Mar 26 17:24:22 uncaught exception: count failed: {
"errmsg" : "exception: $or may not contain 'special' query",
"code" : 13291,
"ok" : 0
} 
```

从这个错误和开放的 JIRA 票证（[https://jira.mongodb.org/browse/SERVER-3984](https://jira.mongodb.org/browse/SERVER-3984)）来看，Mongo 目前无法使用 $or（或 $all）运算符执行多个位置查询，因此我无法链接位置查询。

**是否有实现此目的的最佳实践或解决方法？**同样，我宁愿不要对每个位置进行单独的查询，也不愿将它们合并在一起；虽然我意识到这可能是唯一的选择。

我目前正在使用 Mongo 2.2.3，但如果升级到 2.4 可以解决这个难题，则没有问题。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T02:24:56.127

如果您熟悉 javascript，则可以使用 mapReduce 来实现这一点。

但是，需要构建 $near 和 $centerSphere 两种方法，并且您不能执行超过 1000 条记录的 mapreduce。

由于 mongoDB 限制了 $or 运算符，这是我想到的第一个解决这个问题的想法。

[http://docs.mongodb.org/manual/applications/map-reduce/](http://docs.mongodb.org/manual/applications/map-reduce/)

# c++ - 使用 temp 模拟返回类型的类型推导。具有转换运算符的代理

> ID：15647763
> 
> 赞同：0
> 
> 时间：2013-03-26T21:29:27.267
> 
> 标签：c++, templates, c++11, functional-programming

我有这个 Haskell 风格`map`的高阶函数，它已经在调用方使用模板类型推导来获得干净的语法，但结果类型除外：

```
template<class ResultingContainer, class R, class Fn>
ResultingContainer map(const R &range, const Fn &f) {
    ResultingContainer result;
    using value_type = decltype(*std::begin(range));
    for_each(range, [&](const value_type &v){
        result.push_back(f(v));
    });
    return result;
} 
```

[（我更喜欢一些`decltype(*std::begin(range))`迭代`R::value_type`器特征，因为我使用不提供此类接口的容器：Qt 容器。）]

使用这个功能很简单，但并不像我想要的那么简单，你们都知道我的意思：

```
std::vector<int> result = map<std::vector<int>>(otherVector, someFunction); 
```

当然，我希望它是：

```
std::vector<int> result = map(otherVector, someFunction); 
```

如果我按照以下方式设计 API，类型推导将完美运行。但我不希望它是这样的，因为这是 C++ 标准库风格（迭代器对/范围之间的区别除外），但我希望它是“Haskell 风格”：

```
std::vector<int> result;
map(otherVector, result, someFunction); 
```

鉴于`otherVector`不一定与结果的类型相同（例如，它们可能是字符串，我想要它们的长度，所以`someFunction`返回给定字符串的长度），我不能`ResultingContainer`只使用已知类型（特别是输入的值类型）。

如果我（而且我不想）坚持一种单一类型的容器，我可以表达它。但是还有一个希望：编译器已经知道结果应该是什么，除非`auto`用于返回类型。（当结果类型有多种可能性时，例如当用作重载函数的参数时，它会令人困惑）。

所以我想到了一个*代理容器*，这是默认的`ResultingContainer`（但如果用户需要，可以覆盖，这不是我的问题）。但是，以我目前的知识，我只能实现一些`ProxyContainer<T>`（`T`作为结果类型`f`，在 中使用的谓词`map`），它*暂时保存所有结果项*。这听起来像是不必要的开销。但是，实现可能如下所示：

```
template<typename T>
class ProxyContainer : public std::vector<T> {
    template<typename FinalContainer>
    operator FinalContainer() const {
        FinalContainer result;
        for (auto x : *this)
            result.push_back(x);
        return result;
    }
}; 
```

但这只是感觉不对。

你能想出更好的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:48:24.167

正如 Xeo 建议的那样，我使用“惰性适配器”解决了这个问题。但我没有使用 Boost ，而是写了一个非常简单的：

```
template<class R, class Fn>
class MapAdaptor
{
    const R &range;
    const Fn &f;

public:
    MapAdaptor(const R &range, const Fn &f) :
        range(range), f(f)
    {
    }

    template<class ResultingContainer>
    operator ResultingContainer() const {
        ResultingContainer result;
        for(const auto &v : range)
            result.push_back(f(v));
        return result;
    }
}; 
```

那么，实际的`map`函数就变成了下面这样：

```
template<class R, class Fn>
MapAdaptor<R,Fn> map(const R &range, const Fn &f) {
    return MapAdaptor<R,Fn>(range, f);
} 
```

我还没有让适配器本身成为一个范围，但我会添加这个功能，以便能够链接/嵌套操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T02:07:44.147

这是一个通用的惰性适配器实现，以及一些`container_traits`允许您将数据返回到 a`std::set`等的实现。

```
#include <tuple>
#include <iterator>
#include <utility>
#include <algorithm>

// Standard metaprogramming boilerplate:
template<std::size_t...>
struct seq {};
template<std::size_t max, std::size_t... s>
struct make_seq:make_seq<max-1, max-1, s...> {};
template<std::size_t... s>
struct make_seq<0, s...> {
  typedef seq<s...> type;
};
// helper to make creating a sequence from 0,...,max-1 take less typing:
template<std::size_t max>
using MakeSeq = typename make_seq<max>::type;

// takes a sequence of indexes, a tuple, a Result type, and a Functor, and calls the Functor passing
// in the Result type with the fowarded args in the tuple, as indicated by the sequence of indexes:
template<typename Result, template<typename Result>class Functor, typename... Args, std::size_t... s>
Result apply( seq<s...>, std::tuple<Args...>& args ) {
  return Functor<Result>()(std::forward<Args>(std::get<s>(args))...);
}

// and here it is, a generic lazy evaluator:
template<template<typename Result>class Functor, typename... Args>
struct LazyEvaluation {
  std::tuple<Args...> stored_args;
  LazyEvaluation( Args... args ):stored_args(std::forward<Args>(args)...) {};
  template<typename R>
  operator R() {
    return apply<R, Functor>( MakeSeq<sizeof...(Args)>(), stored_args );
  }
};

// The start of some container traits templates:
template<typename T, typename=void>
struct const_iterator_type:std::false_type {};
template<typename T>
struct const_iterator_type<T, typename std::enable_if<
  std::is_same< typename T::const_iterator, typename T::const_iterator >::value
>::type>:std::true_type {
   typedef typename T::const_iterator const_iterator;
};
template<typename T, size_t n>
struct const_iterator_type< T[n] >:std::true_type {
   typedef T const* const_iterator;
};

template<typename T,typename=void>
struct has_push_back:std::false_type {};
template<typename T>
struct has_push_back<T, typename std::enable_if<
  std::is_same<
     decltype(std::declval<T>().push_back(*std::declval<typename const_iterator_type<T>::const_iterator>())),
     decltype(std::declval<T>().push_back(*std::declval<typename const_iterator_type<T>::const_iterator>()))
  >::value
>::type>:std::true_type{};
template<typename T,typename=void>
struct has_insert:std::false_type {};
template<typename T>
struct has_insert<T, typename std::enable_if<
  std::is_same<
     decltype(std::declval<T>().insert(*std::declval<typename const_iterator_type<T>::const_iterator>())),
     decltype(std::declval<T>().insert(*std::declval<typename const_iterator_type<T>::const_iterator>()))
  >::value
>::type>:std::true_type {};

template<typename Container, typename=void>
struct container_traits;

template<typename Container>
struct container_traits<Container, typename std::enable_if<has_push_back<Container>::value>::type> {
   template<typename V>
   static void add_to_container( Container& c, V&& v ) {
     c.push_back( std::forward<V>(v) );
   }
};
template<typename Container>
struct container_traits<Container, typename std::enable_if<!has_push_back<Container>::value && has_insert<Container>::value>::type> {
   template<typename V>
   static void add_to_container( Container& c, V&& v ) {
     c.insert( std::forward<V>(v) );
   }
};

// supporting emplace_back and emplace is harder, but probably worth it.
// the trick with both of them is that you only know if they exist or are valid
// after you try to call add_to_container with the arguments!  So instead of
// "does it exist", you end up with "can we call emplace_back with these arguments".
// This requires a bit of slight of hand in the template code, as we want to fall back
// on insert and push_back if emplace_back doesn't exist.

// Another improvement to the above might be to have the const_iterator traits class
// fall back on a decltype( std::begin(std::declval<C const>()) ) -- or even better,
// do full ADL with a private namespace and a using std::begin.

// your code, basically verbatim, but uses container_traits to figure out
// how to add an element to the container:
template<class ResultingContainer, class Range, class Fn>
ResultingContainer map_now(const Range &range, const Fn &f) {
  ResultingContainer result;
  using value_type = decltype(*std::begin(range));
  for_each(std::begin(range), std::end(range), [&](const value_type &v){
    container_traits<ResultingContainer>::add_to_container(result, f(v));
  });
  return result;
}

// could make this easier if I could pass in a pointer-to-template-function
// or the equivalent directly.  Know the syntax by any chance?
template<typename Range, typename Fn>
struct map_lazy_helper {
  template<typename ResultingContainer>
  struct Func {
    ResultingContainer operator()(const Range &range, const Fn &f) const {
      return map_now<ResultingContainer>( range, f );
    }
  };
};

// Map lazy is mostly repeating type information:
template<typename Range, typename Fn>
LazyEvaluation<map_lazy_helper<Range, Fn>::template Func, Range, Fn>
map_lazy(Range&&range, Fn&&f) {
  return {std::forward<Range>(range), std::forward<Fn>(f)};
}

#include <iostream>
#include <vector>
#include <set>

int main() {
   std::vector<int> tester {3,2,1};

   std::vector<double> vd = map_lazy( tester, [](int x) { return x*0.5; } );
   std::set<double> sd = map_lazy( tester, [](int x) { return x*0.5; } );
   std::vector<int> vs = map_lazy( tester, [](int x) { return x*2; } );
   for(auto&& x:vd)
     std::cout << x << "\n";
   for(auto&& x:sd)
     std::cout << x << "\n";
   for(auto&& x:vs)
     std::cout << x << "\n";
} 
```

这和你可能喜欢的一样有效。:)

有趣的是，虽然这个答案很大，但其中 40% 是处理的通用“添加到容器”代码`set`，10% 是元编程样板，30% 是通用`LazyEvaluation`代码，10% 是测试代码，只有 10% 是所需的代码去实际写`map_lazy`。

现在我想了想，你想要的是一个通用的“将东西插入容器”迭代器，这样你就可以支持写入`std::array`足够大小的 a 、 a `std::set`、 a`std::vector`或自制容器。它应该探测`back_insert_iterator`，如果失败了`insert_iterator( C.end() )`，则专门针对固定大小的容器，例如`std::array`（即使是空的也有大小！）。那会`container_traits`更复杂，它已经占据了这篇文章的一半！

最后，这是一个启用 ADL 的“容器支持开始了吗”：

```
namespace aux_adl {
  using std::begin; using std::end;
  template<typename C>
  auto adl_begin( C&& c )->decltype( begin(std::forward<C>(c)) );
  template<typename C>
  auto adl_end( C&& c )->decltype( end(std::forward<C>(c)) );
  template<typename C>
  auto adl_cbegin( C const& c )->decltype( begin(c) );
  template<typename C>
  auto adl_cend( C const& c )->decltype( end(c) );
}
template<typename C, typename=void>
struct container_iterator {}
template<typename C>
struct container_iterator<C, std::enable_if<
  std::is_same<
    decltype( adl_aux::adl_begin(std::declval<C>()),
    decltype( adl_aux::adl_end(std::declval<C>())
  >::value
>::type> {
  typedef adl_aux::adl_begin(std::declval<C>()) iterator;
};
template<typename C>
struct container_const_iterator<C, std::enable_if<
  std::is_same<
    decltype( adl_aux::adl_cbegin(std::declval<C>()),
    decltype( adl_aux::adl_cend(std::declval<C>())
  >::value
>::type> {
  typedef adl_aux::adl_cbegin(std::declval<C>()) const_iterator;
}; 
```

请注意，`adl_end`类型函数仅执行正确的 ADL 类型查找，它们实际上不能被调用。

是的，这是一个黑客。显然有人在窃听 C++ 委员会允许`using`内部声明`decltype`来修复这个 hack。

# mysql - mySQL更新表将字符串添加到列

> ID：15647765
> 
> 赞同：1
> 
> 时间：2013-03-26T21:29:34.357
> 
> 标签：mysql, string, add

我在 mySQL 中有一个表，并且想要更新包含目录的特定列。应扩展目录结构，并应使用子目录更新相应的列。有很多行要更新，所以我寻找一个方便的脚本来做。

例子：

c1 列保存目录

```
/startpoint/dir_a/
/startpoint/dir_a/subdir_1/
/startpoint/dir_a/subdir_1/subsubdir_1/
/startpoint/dir_a/subdir_1/subsubdir_2/
/startpoint/dir_a/subdir_1/subsubdir_3/
/startpoint/dir_a/subdir_2/
/startpoint/dir_a/subdir_3/ 
```

所以我需要将目录从起点移动到起点/系统。

这应该在脚本之后：

```
/startpoint/system/dir_a/
/startpoint/system/dir_a/subdir_1/
/startpoint/system/dir_a/subdir_1/subsubdir_1/
/startpoint/system/dir_a/subdir_1/subsubdir_2/
/startpoint/system/dir_a/subdir_1/subsubdir_3/
/startpoint/system/dir_a/subdir_2/
/startpoint/system/dir_a/subdir_3/ 
```

我的（也许是愚蠢的）更新没有按预期工作：

```
update table1 set dir=/startpoint/system/||substr(dir,12) where dir like '/startpoint/dir_a/%' 
```

那么专家有什么想法可以通过更具体的 sql 更新来做到这一点吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:45:30.787

您可以使用

```
UPDATE table SET dir = REPLACE(dir,'/startpoint/dir_a/','/startpoint/system/dir_a/'
WHERE dir LIKE '/startpoint/dir_a/%' 
```

但要小心，因为它会替换所有出现的 '/startpoint/dir_a/' - 如果你的路径类似于 '/startpoint/dir_a/random_dir/startpoint/dir_a/' 它会搞砸的。

# knockout.js - 在这种情况下，Knockoutjs 不会更新 UI

> ID：15647767
> 
> 赞同：4
> 
> 时间：2013-03-26T21:29:48.063
> 
> 标签：knockout.js

我对 KO 比较陌生（两天前开始）并且正在尝试一些简单的例子。目前，我对这段代码有疑问。

```
<div id="idChangeStyle">
    <span data-bind="style: { background: GetAge() < 18 ? 'red':'white'}">Enter Your Age:</span>
    <input type="text" data-bind="value: GetAge"></input>
</div> 
```

```
function ageViewModel() {
    var self = this;
    self.age = ko.observable(18);
    self.GetAge = ko.computed({
        read: function () {
            return self.age();
        },
        write: function (value) {
            value = parseInt(String(value).replace(/[^\d]/g, ""));
            if (isNaN(value))
                self.age(18);
            else
                self.age(value);
        }
    });
};
ko.applyBindings(new ageViewModel(), document.getElementById('idChangeStyle')); 
```

[http://jsfiddle.net/WJZqj/](http://jsfiddle.net/WJZqj/)

基本上，该应用程序采用单个输入（年龄）。我正在使用可写计算 observable 来解析 INTEGER 的输入，并在解析其 NaN 后，我试图将年龄设置为其默认值，即 18。此外，我在 html 上有一个简单的逻辑，我将 span 的背景更改为红色如果年龄低于 18 岁。

在正常情况下它工作正常，这是我遇到问题的时候： -

```
Case 1:
Current Input: 18 (initial case) 
enter *4* then tab //works
enter *a* then tab //work (defaults to 18) 
enter *a* then tab //doesn't work

case 2:
current input: 18 
enter *a *then tab* //*doesn't work 
```

我检查了敲除代码，看看在运行以下代码时会发生什么情况：-

```
if(isNaN(value))
   self.age(18); 
```

..在以下行中：-

```
// Ignore writes if the value hasn't changed
if ((!observable['equalityComparer']) || !observable['equalityComparer'](_latestValue, arguments[0])) { 
```

`_latestValue`和都`arguments[0]`具有相同的值（18），所以它什么也不做。由于年龄值没有变化，现在 viewmodel 属性和 UI 不同步。

这是因为我做错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-05T19:53:24.997

我有同样的情况，当我使用**淘汰赛 3.0 时。**但是这些技巧对我没有帮助，因为现在**淘汰赛仅在计算属性值更改时才通知**。

我解决了问题：1）只使用通知：总是

```
function ageViewModel(data) {
    //notify will should be always, because age is a primitive type  
    this.age = ko.observable(data.age).extend({notify: "always"});
    this.GetAge = ko.computed({
        read: function () {
            // notify will  should be always, because computed return values of a primitive type.
            return this.age();
        },
        write: function (value) {
            value = parseInt(String(value).replace(/[^\d]/g, ""));
            if (isNaN(value)) {
                this.age(18);
            }
            else this.age(value);

        },
        owner: this
    }).extend({notify: "always"});

}; 
```

2) 使用 notify:always 和 knockout.mapping

```
function ageViewModel(data) {
    ko.mapping.fromJS(data, {}, this);
    //notify will should be always, because age is a primitive type  
    this.age = this.age.extend({notify: "always"});
    this.GetAge = ko.computed({
        read: function () {
            // notify will  should be always, because computed return values of a primitive type.
            return this.age();
        },
        write: function (value) {
            value = parseInt(String(value).replace(/[^\d]/g, ""));
            if (isNaN(value)) {
                this.age(18);
            }
            else this.age(value);

        },
        owner: this
    }).extend({notify: "always"});

}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T22:08:02.697

问题是，如果您为 observable 输入相同的值，它不会认为这是值的变化，也不会通知订阅者。如果你连续多次进入错误状态，`18`会是第一次设置的年龄并再次设置，不会发生更改事件。

话虽如此，要解决此问题，您必须手动通知订阅者。你可以简单地通过调用`valueHasMutated()`observable 来做到这一点。

```
self.GetAge = ko.computed({
    read: function () {
        return self.age();
    },
    write: function (value) {
        value = parseInt(String(value).replace(/[^\d]/g, ""));
        if (isNaN(value)) self.age(18);
        else self.age(value);
        self.age.valueHasMutated(); // notify subscribers
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:34:38.147

解决此问题的一种简单方法是将年龄设置为 0，然后返回默认值。

即，更改为：

```
if(isNaN(value)) {
    self.age(0);
    self.age(18);
} 
```

我不知道淘汰赛会认为是“正确”的方式，但这可能就是我会做的。

# maven - PMD 排除不工作

> ID：15647771
> 
> 赞同：3
> 
> 时间：2013-03-26T21:30:00.530
> 
> 标签：maven, pmd

我正在尝试微调我们的 CI，但我不知道如何避免 PMD 报告 src-gen 中生成的代码（不是那里的 Android R 文件）的违规行为：

我曾经`mvn help:effective-pom`验证我的配置，POM 看起来应该是这样。它指向要排除的正确文件夹。

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-pmd-plugin</artifactId>
    <version>${pmd-maven-plugin.version}</version>
    <configuration>
        <linkXref>false</linkXref>
        <sourceEncoding>${project.build.sourceEncoding}</sourceEncoding>
        <minimumTokens>${pmd.minimum.tokens}</minimumTokens>
        <targetJdk>${pmd.target.jdk}</targetJdk>
        <excludes>
            <exclude>**/*R.java</exclude>
            <exclude>**/*Manifest.java</exclude>
            <excludeRoots>
                <excludeRoot>${basedir}/src-gen</excludeRoot>
            </excludeRoots>
        </excludes> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-10-14T09:04:00.517

[查看PMD 插件用法文档页面](http://maven.apache.org/plugins/maven-pmd-plugin/usage.html)上的示例（页面末尾）表明该`<excludeRoots>`部分应直接在 下`<configuration>`，而不是在 下`<excludes>`。

~~如果这没有帮助，也许可以尝试`<excludeRoot>**/src-gen/**</excludeRoot>`。~~

# flash - IE8可以在没有Flash的情况下播放视频吗

> ID：15647778
> 
> 赞同：1
> 
> 时间：2013-03-26T21:30:32.477
> 
> 标签：flash, video, internet-explorer-8

真的是基本问题。是在 IE8 中播放视频以使用 Flash 的唯一选择，即使作为 HTML5 视频所有人代码的后备？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:38:50.007

简而言之，是的，这是唯一真正的选择。

好的，还有其他插件可以做到这一点，比如 Silverlight，但最终效果是一样的。是的，因为有一些[polyfill 脚本](https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-browser-Polyfills)试图让浏览器使用标准的 HTML5 代码，但它们仍然在幕后使用 flash。

底线是 IE8 没有原生视频播放功能。

# javascript - Sencha Touch 2.1：如何创建/销毁标签内容以提高性能？

> ID：15647779
> 
> 赞同：0
> 
> 时间：2013-03-26T21:30:33.430
> 
> 标签：javascript, performance, sencha-touch-2, tabpanel

我的 ViewPort 中有一个 TabPanel，有 4 个选项卡；是否可以保留选项卡本身（要点击的“按钮”），但如果不可见则删除/创建内容/dom？

我正在寻找类似 tab.removeContent() 和 tab.createContent() 的东西，我猜......

我试过了：

```
activeitemchange: function(component, value, oldValue, eOpts) {
    Ext.Viewport.remove(oldValue, true);
} 
```

这似乎什么也没做......

这将删除所有内容：

```
activeitemchange: function(component, value, oldValue, eOpts) {
    Ext.Viewport.remove(Ext.Viewport.getActiveItem(), true);
} 
```

我得到了删除部分的工作：

```
oldValue.removeInnerAt(0); 
```

但与之相反的是什么，即如何设置标签的内容？

```
var myContent = Ext.create('MyApp.view.MyView');
// and now? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T15:59:41.583

Sencha 高级论坛经理 Mitchell Simoens 对此进行了扩展。可以在他的github页面上找到：[Optimized tab (git)](https://github.com/mitchellsimoens/Ux.tab.OptimizedTab)

选项卡将被删除并缓存。

**编辑：** 在您目前的情况下，您正在扩展`Ux.tab.OptimizedTab`，这是错误的。该库仅对某些方法进行了一些更改`Ext.tab.Panel`（该库也没有扩展`Ext.tab.Panel`。在 Mitchell 给出的示例中，您可以看到他正在扩展`Ext.tab.Panel`并设置 defaultType on `optimized-tab`。

```
Ext.define('MyApp.view.Main', {
    extend : 'Ext.tab.Panel',
    xtype  : 'main',

    requires : [
        'Ext.TitleBar',
        'Ext.Video',
        'Ux.tab.OptimizedTab'
    ],

    config: {
        tabBarPosition : 'bottom',
        defaultType    : 'optimized-tab',
        items : {
            ...
        }
    }
} 
```

请注意，您更改了 lib 类名，在我看来，这是一种不尊重，最重要的是，您给它起了错误的名称并将其放在错误的文件夹中。（你给的名字是`Crossfit.view.OptimizedTab`，但它根本不是一个视图..）

我想对你的应用程序的良好架构进行一些赞美，我没有看到很多人了解 Sencha Touch 架构。但是你，米切尔和我是其中的一部分:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-17T20:26:29.950

我最初在使用这个组件时也遇到了问题，你会注意到这里的关键是，如果你的标签面板中有 3 个项目，每个项目都必须有 xtype 'optimized-tab'，并且在它们里面你有你的实际项目。

例如：

```
items: [
        {
            xtype: 'optimized-tab',
            title: 'Tab 1',
            iconCls: 'info',
            baseCls: 'myBtn',
            cls: 'myBtn',
            html: 'Tab 1',
            items: [
                {
                    xtype: 'component',
                    baseCls: 'myBtn',
                    cls: 'myBtn',
                    ui: 'light'
                }
            ]
        }, 
```

要测试它是否实际工作，请将其粘贴到控制台中以查找 DOM 项的数量：

```
document.getElementsByTagName("*").length 
```

如果您的第一个选项卡是空的，您应该会看到大约 50 个项目，如果您有地图，您应该会看到大约 200 个等。如果优化的选项卡不起作用，您可能会在 DOM 中看到大约 400 个项目。

如果它正在工作，您可能会看到优化的选项卡在动画完成之前过早地删除了项目。所以你可以稍微修改它以删除之后的项目。

您也可以参考此链接了解更多信息：[http ://www.sencha.com/forum/archive/index.php/t-207907.html?s=24386d2ced82d0625b8199247e0f5c64](http://www.sencha.com/forum/archive/index.php/t-207907.html?s=24386d2ced82d0625b8199247e0f5c64)

:-)

# matlab - Matlab不处理第二个for循环

> ID：15647782
> 
> 赞同：0
> 
> 时间：2013-03-26T21:30:37.660
> 
> 标签：matlab, for-loop, differentiation

我正在尝试通过将收集到的一些加速器数据与也记录的 LVDT 位移进行比较来验证这些数据。为此，我试图区分 LVDT 数据两次以获得加速。但是，当我运行我的代码时，它有错误

```
Undefined function or variable 'DiffDiffLVDT'. 
```

对此进行调查，我发现 Matlab 没有处理第二个 for 循环，因此从未生成变量 DiffDiffLVDT。

为什么它会跳过第二个 for 循环？

```
enter code here
clear all

clc

test2 = csvread('HZ1.csv'); %raw data from excel
time = test2(:,1);
%% Filtering 
f=250;%  sampling frequency
f_cutoff = 2; % cutoff frequency
f_cutoff2 = 5;

fnorm =f_cutoff/(f/2); % normalized cut off freq, you can change it to any value depending on your requirements
fnorm2 =f_cutoff2/(f/2);

[b1,a1] = butter(4,fnorm,'low'); % Low pass Butterworth filter of order 4
[b2,a2] = butter(4,fnorm2,'low'); % Low pass Butterworth filter of order 4

filtaccZ = filtfilt(b2,a2,test2(:,6));
filtLVDTZ = filtfilt(b1,a1,test2(:,7));

%% Remove Offset

Accz = filtaccZ -mean(filtaccZ);
LVDTz = filtLVDTZ - mean(filtLVDTZ);

%% Unit Conversion

LVDTm = LVDTz/1000; % mm to m

%% LVDT Displacement to Acc

% Displacement to Velocity
for d = 2:1:(size(LVDTm)-1)

    x = LVDTm(d+1);

    y = LVDTm(d-1);

    z = x-y; %differnce in y

    a = time (d+1);

    b = time (d-1);

    c = a-b; %differnce in x

    DiffLVDT(d)= (z/c); % Displacement to velocity

end

velocity = DiffLVDT;

% Velocity to Acceleration
for e=1:1:(size(velocity)-1)
    x2 = velocity(e+1); 

    y2 = velocity(e-1);

    z2 = x2-y2; %differnce in y

    a2 = time (e+1);

    b2 = time (e-1);

    c2 = a2-b2; %differnce in x

    DiffDiffLVDT(e)= (z2/c2) %velocity to acc.

end

Acc= DiffDiffLVDT
%% Plotting
close all 
figure
hold on
plot(time(1:5000),Acc(1:5000),'b')
plot(time(1:5000),Accz(1:5000),'r')

grid on;box on
legend('DiffDiffLVDTFilter','Accz')

    enter code here 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T22:32:47.057

因为

```
1:1:(size(velocity)-1) 
```

不做你想做的事。

`velocity`是一个`1xN`数组，`size(velocity)`因此返回`[1 N]`. 冒号运算符只关心数组中的第一个值，而要循环的数组最终为空，因为

```
1:1:[1 N]-1 == 1:1:1-1 == 1:1:0 == Empty matrix 
```

由于诸如此类的问题，您应该始终使用以下任一方法，而不是`size(var)`在构造循环时：

```
size(var, n) % Returns the size of the nth dimension of var
length(var) % Returns the size of the largest dimension of var
numel(var) % Returns the number of elements in var 
```

# php - 实时电子邮件可用性检查

> ID：15647783
> 
> 赞同：0
> 
> 时间：2013-03-26T21:30:43.840
> 
> 标签：php, mysql, ajax

我正在尝试使用 ajax 进行实时电子邮件可用性检查。我想获取输入值并将其发送到 php，在那里将检查它是否在数据库中，但我无法做到。当我使用 Firebug 测试脚本时，会有响应，但无论电子邮件是否存在，输出总是相同的。它总是告诉我那是不存在的。

该表称为公司。电子邮件的表字段是电子邮件。

与数据库的连接正常。我认为问题出在我的 ajax 代码中，因为它总是给我“TAKEN”输出。

这是我的 php 代码：

```
<?php
// This is a sample code in case you wish to check the username from a mysql db table

if(isset($_POST['Email']))
{
$email = $_POST['Email'];

$dbHost = 'localhost'; // usually localhost
$dbUsername = 'root';
$dbPassword = 'password';
$dbDatabase = 'php_test';

$db = mysql_connect($dbHost, $dbUsername, $dbPassword)
 or die ("Unable to connect to Database Server.");
mysql_select_db ($dbDatabase, $db)
 or die ("Could not select database.");

$result = mysql_query("select Email from company where Email='".$email."'")
 or die(mysql_error());

if(mysql_num_rows($result))
{
echo 'NOT OK';
}
else
{
echo 'OK';
}
}
?> 
```

这是ajax代码

```
$(document).ready(function() {

$("#email").blur(function(){
    $.ajax({  
    type: "POST",  
    url: "unique_check.php",  
    data: {Email: $("#email").val()},
    dataType:"json", 
    success: function(msg){

        if(msg == "OK"){
            alert("FREE")
        }else{
            alert("TAKEN")
        }
    }
    });
});    
}); 
```

请告诉我我的错误在哪里，或者是否有更好的方法，给它。请记住，我是 ajax 和 php 的新手。非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:36:24.380

我想你想要：

```
if($result != false && mysql_num_rows($result) > 0) {
echo 'NOT OK';
} else {
echo 'OK';
} 
```

如果这不起作用，请尝试回显您的查询以确保它是您想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:39:56.220

一个问题是，在您的 Javascript 代码中，您正在设置`email`页面加载，而该页面恰好是空的。您需要在函数`email`内部再次设置`.blur()`以在字段实际模糊时获取值。

```
$(document).ready(function() {

    $("#email").blur(function(){
    var email = $("#email").val();
        $.ajax({  
            type: "POST",  
            url: "unique_check.php",  
            data: {Email: email},
            dataType:"json", 
            success: function(msg){

                if(msg == "OK"){
                    alert("FREE")
                }else{
                    alert("TAKEN")
                }
            }
        });
    });    
}); 
```

# java - android opengl es 2.0 上的帧率偶尔会卡顿

> ID：15647789
> 
> 赞同：5
> 
> 时间：2013-03-26T21:30:56.990
> 
> 标签：java, android, opengl-es

最近我开始开发一些简单的 opengl es 2.0 android 应用程序，但我遇到了动画速度问题。平均 fps 始终等于 60（每 100 帧测量一次），但有时动画会在很短的时间内卡顿。即使在渲染单个三角形时也会发生这种情况。当动画继续时我没有分配，并且在动画期间 log​​cat 中没有 GC 事件。

## 在渲染循环中执行的代码：

```
public void draw( GLFloatBuffer positionBuffer, int positionBufferOffset, int trianglesCount )
{
    GLES20.glUseProgram( activeGLProgram.glProgramId );

    // Set mvpMatrixValue
    int u_MvpMatrixLocation = GLES20.glGetUniformLocation( activeGLProgram.glProgramId, U_MVP_MATRIX_NAME );
    GLES20.glUniformMatrix4fv( u_MvpMatrixLocation, 1, false, mvpMatrix, 0 );

    // Set vertex position stream
    int a_VertexPositionLocation = GLES20.glGetAttribLocation( activeGLProgram.glProgramId, A_VERTEX_POSITION_NAME );
    GLES20.glBindBuffer( GLES20.GL_ARRAY_BUFFER, positionBuffer.glBufferId );
    GLES20.glEnableVertexAttribArray( a_VertexPositionLocation );

    GLES20.glVertexAttribPointer( a_VertexPositionLocation, POSITION_COORDINATES_PER_VERTEX,
                                  GLES20.GL_FLOAT, false,
                                  0, positionBufferOffset * GLUtilities.BYTES_PER_FLOAT );

    // Draw shape
    GLES20.glDrawArrays( GLES20.GL_TRIANGLES, 0, trianglesCount * 3 );

    // Clear state
    GLES20.glDisableVertexAttribArray( a_VertexPositionLocation );
    GLES20.glBindBuffer( GLES20.GL_ARRAY_BUFFER, 0 );
} 
```

剩下的代码就是简单的 GLSurfaceView 和 GLSurfaceView.Renderer

## 测量

调试输出格式为：

D/FRAMERATE：最后 100 帧的平均 fps

D/FRAMERATE：最后 100 帧的最慢帧渲染时间

D/FRAMERATE：最近 100 帧的最快帧渲染时间

测量 Galaxy S II：

```
D/FRAMERATE:(24052): 59.018566
D/FRAMERATE:(24052): maxTimeDiff = 77ms <----
D/FRAMERATE:(24052): minTimeDiff = 3ms
D/FRAMERATE:(24052): 59.900166
D/FRAMERATE:(24052): maxTimeDiff = 24ms
D/FRAMERATE:(24052): minTimeDiff = 10ms
D/FRAMERATE:(24052): 59.780804
D/FRAMERATE:(24052): maxTimeDiff = 28ms
D/FRAMERATE:(24052): minTimeDiff = 10ms
D/FRAMERATE:(24052): 59.4882
D/FRAMERATE:(24052): maxTimeDiff = 32ms
D/FRAMERATE:(24052): minTimeDiff = 3ms
D/FRAMERATE:(24052): 59.840427
D/FRAMERATE:(24052): maxTimeDiff = 24ms
D/FRAMERATE:(24052): minTimeDiff = 9ms
D/FRAMERATE:(24052): 59.920105
D/FRAMERATE:(24052): maxTimeDiff = 22ms
D/FRAMERATE:(24052): minTimeDiff = 12ms
.
.
.
D/FRAMERATE:(24052): 59.116573
D/FRAMERATE:(24052): maxTimeDiff = 68 <--- Here it happend again
D/FRAMERATE:(24052): minTimeDiff = 8 
```

HTC Desire Z 上似乎没有出现问题：

```
D/FRAMERATE: (28788): maxTimeDiff = 20ms
D/FRAMERATE: (28788): minTimeDiff = 15ms
D/FRAMERATE: (28788): 58.27506
D/FRAMERATE: (28788): maxTimeDiff = 22ms
D/FRAMERATE: (28788): minTimeDiff = 12ms
D/FRAMERATE: (28788): 58.27506
D/FRAMERATE: (28788): maxTimeDiff = 22ms
D/FRAMERATE: (28788): minTimeDiff = 14ms
D/FRAMERATE: (28788): 58.27506
D/FRAMERATE: (28788): maxTimeDiff = 20ms
D/FRAMERATE: (28788): minTimeDiff = 14ms 
```

除了编写本机 ndk 代码之外，任何人都可以帮助寻找解决方案吗？

# php - 使用 PHP 重新排列 XML 节点

> ID：15647794
> 
> 赞同：1
> 
> 时间：2013-03-26T21:31:12.890
> 
> 标签：php, xml

我有一个动态横幅，其中包含保存在 XML 文件中的图像/信息。我正在为用户添加选项来重新排列他们喜欢的图像（Jquery 可排序），一旦我得到新订单（其中包含 id 属性），我想重新排列而不必复制每个节点的信息并再次保存它在新的顺序。例如：

```
<banners>
 <banner id="1001">
  <infos...>
 </banner>
 <banner id="1003">
  <infos...>
 </banner>
 <banner id="900">
  <infos...>
 </banner>
</banners> 
```

假设用户重新排列为 900、1003、1001。我希望能够通过 ID# 获取节点并相应地重新定位它们。有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T00:25:23.783

(1)`order`向每个`<banner>`节点添加一个子节点，(2) 按该子节点对 xml 进行排序。

for (1):`$xml`是simplexml-object，顺序存储在`$order`...

```
$order=array(900,1001,1003);

foreach ($xml->banner as $banner) {

    foreach ($order as $k => $v)
        if ($banner['id']==$v) $banner->addChild('order',$k);

} 
```

对于 (2): 对 xml 进行排序`order`：
请参阅这篇文章中接受的答案：[使用简单 XML 和 xpath 对表字段进行排序](https://stackoverflow.com/questions/15604459/sorting-the-table-fields-using-simple-xml-and-xpath/15625514#15625514)

见现场演示@http [://codepad.viper-7.com/MdcT7B](http://codepad.viper-7.com/MdcT7B)

# tomcat - SQLException: 找不到合适的驱动程序

> ID：15647795
> 
> 赞同：3
> 
> 时间：2013-03-26T21:31:20.350
> 
> 标签：tomcat, sqlexception

这是最多的主题之一，但在 stackoverflow 上没有其他主题适合。

我的环境是一个 Tomcat 7，它在 context.xml 中定义了一个 JNDI-DataSource。当我启动我的 Tomcat 时，会引发以下异常

```
org.apache.tomcat.dbcp.dbcp.SQLNestedException: Cannot create JDBC driver of class 'org.apache.derby.jdbc.ClientDataSource' for connect URL 'jdbc:derby://localhost:1527/app;create=true'
at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createConnectionFactory(BasicDataSource.java:1452)
at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:1371)
at org.apache.tomcat.dbcp.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)
at org.hibernate.service.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:141)
at org.hibernate.tool.hbm2ddl.SuppliedConnectionProviderConnectionHelper.prepare(SuppliedConnectionProviderConnectionHelper.java:51)
at org.hibernate.tool.hbm2ddl.DatabaseExporter.<init>(DatabaseExporter.java:52)
at org.hibernate.tool.hbm2ddl.SchemaExport.execute(SchemaExport.java:367)
at org.hibernate.tool.hbm2ddl.SchemaExport.create(SchemaExport.java:304)
at org.hibernate.tool.hbm2ddl.SchemaExport.create(SchemaExport.java:293)
at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:498)
at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1743)
at org.hibernate.ejb.EntityManagerFactoryImpl.<init>(EntityManagerFactoryImpl.java:94)
at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:905)
at org.hibernate.ejb.Ejb3Configuration.buildEntityManagerFactory(Ejb3Configuration.java:890)
at org.hibernate.ejb.HibernatePersistence.createEntityManagerFactory(HibernatePersistence.java:57)
at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:63)
at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:47)
at com.opensolutions.openflow.persistence.DefaultEntityManagerStore.<init>(DefaultEntityManagerStore.java:20)
at com.opensolutions.openflow.servlet.ApplicationWebserviceServlet.initApplication(ApplicationWebserviceServlet.java:38)
at com.opensolutions.openflow.servlet.ApplicationWebserviceServlet.loadBus(ApplicationWebserviceServlet.java:27)
at org.apache.cxf.transport.servlet.CXFNonSpringServlet.init(CXFNonSpringServlet.java:71)
at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1280)
at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1193)
at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1088)
at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:5033)
at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5317)
at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)
at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)
at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:977)
at org.apache.catalina.startup.HostConfig$DeployWar.run(HostConfig.java:1655)
at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
at java.util.concurrent.FutureTask.run(FutureTask.java:166)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
at java.lang.Thread.run(Thread.java:722)

Caused by: java.sql.SQLException: No suitable driver
at java.sql.DriverManager.getDriver(DriverManager.java:289)
at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createConnectionFactory(BasicDataSource.java:1437)
... 37 more 
```

有什么解决办法吗？我不知道。我尝试了很多，但没有任何效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:12:31.220

堆栈跟踪中的这一行是解决问题的关键：

```
Caused by: java.sql.SQLException: No suitable driver 
```

由于抛出异常`org.apache.tomcat...`，您似乎没有将数据库驱动程序放在 tomcat 的`lib`目录中（即您缺少依赖项）。该文件夹存储应用程序所需的外部依赖项，位于`apache-tomcat-version/lib/`. 您需要为您的 Web 应用程序和 tomcat 服务器提供驱动程序。

另外，看看这些相关的问题：

1.  [JDBC/MSQL：找不到合适的驱动程序](https://stackoverflow.com/questions/8146793/jdbc-msql-no-suitable-driver-found-for-jdbcmysql-localhost3306-mysql)
2.  [找不到合适的驱动程序的原因](https://stackoverflow.com/questions/160611/cause-of-no-suitable-driver-found-for)
3.  [java.sql.SQLException：找不到合适的驱动程序](https://stackoverflow.com/questions/5616898/java-sql-sqlexception-no-suitable-driver-found-for-jdbcmicrosoftsqlserver)

* * *

**编辑**

问题可能是 webapp 无权[访问 library](https://stackoverflow.com/questions/267953/managing-libraries-in-tomcat)，尝试将 library 添加到[tomcat-home-folder/common/lib](http://javahowto.blogspot.co.uk/2007/01/tomcat-commonlib-vs-sharedlib.html)。我试过了，tomcat7没有公共文件夹，所以我将库放在webapp/WEB-INF/lib中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-27T13:58:57.470

你设置了jdbc驱动的路径吗？使用Oracle数据库时，需要将jar文件（jdbc驱动）路径设置为“CLASSPATH”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-20T12:16:49.590

我有一个不正确的 jdbc url，如下所示：

错误的！

```
jdbc:jtds://myserver:port;databaseName=abc 
```

正确的：

```
jdbc://myserver:port;databaseName=abc 
```

（删除`jtds:`部分...）

# javascript - 如何将固定位置元素限制在浏览器窗口的高度？

> ID：15647799
> 
> 赞同：2
> 
> 时间：2013-03-26T21:31:31.617
> 
> 标签：javascript, jquery, html, css, css-position

我有一个带有固定位置侧边栏的页面。我希望侧边栏在其内容太高而无法放入浏览器窗口的情况下可以滚动。

但是，当我使用 设置侧边栏样式时`overflow-y: scroll`，会显示滚动条但它被禁用，因为侧边栏足够高以容纳所有内容，即使它对于浏览器窗口来说太高了。

有没有办法限制固定位置元素的高度，以便当它的内容延伸到浏览器窗口底部下方时它会滚动？

我的应用程序可以接受 jQuery 解决方案。请注意，侧边栏不会一直延伸到窗口顶部。

[http://jsfiddle.net/nA8z4/](http://jsfiddle.net/nA8z4/)

[http://jsbin.com/iqibew/2](http://jsbin.com/iqibew/2)：这个版本显示了一个标题，侧边栏必须出现在下面。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T21:36:02.047

您需要设置侧边栏的高度。现在，您的侧边栏与您的文本块一样高，并在视口下方运行（但您看不到）。如果您将其高度设置为 100%（或其他），如果无法一次显示其所有内容，侧边栏将显示滚动条。

所以你需要改变这个：

```
div#fixed-div {
    position: fixed;
    left: 0;
    top 80px;
    width: 260px;
    background-color: silver;
    overflow-y: scroll;
} 
```

对此：

```
div#fixed-div {
    position: fixed;
    left: 0;
    top 80px;
    width: 260px;
    background-color: silver;
    overflow-y: scroll;
    height: 100%;
} 
```

**编辑**：

如果您想要一个具有最大浏览器支持的解决方案（甚至是较旧的浏览器），您将需要 JavaScript。这是一个依赖于 jQuery 的解决方案：

CSS：

```
* {
  margin: 0;
  padding: 0;
}

html, body {
    height: 100%;
}

div#header-div {
    height: 90px;
    background-color: lime;
}
div#fixed-div {
    position: fixed;
    width: 260px;
    background-color: silver;
    overflow-y: scroll;
} 
```

JavaScript：

```
var bodyHeight = $('body').height();
var headerHeight = $('#header-div').height();
var sidebarHeight = bodyHeight - headerHeight;

$('#fixed-div').height(sidebarHeight); 
```

工作 JSFiddle：http: [//jsfiddle.net/nH7xR/](http://jsfiddle.net/nH7xR/)

# php - 页面刷新后自动激活 Bootstrap modal

> ID：15647802
> 
> 赞同：1
> 
> 时间：2013-03-26T21:31:40.153
> 
> 标签：php, javascript, twitter-bootstrap

我试图在页面刷新后自动响应 Bootstrap 模式以显示反馈消息，但是我当前的代码没有重新加载模式，也没有显示错误消息。页面本身正在重新加载，提交到表单的数据在数据库中正确更新（或不提交，取决于是否有错误！），但页面刷新后模态不会重新打开。

我当前的代码如下：

```
//Clean
$submit = clean_string($_POST['submit']);

$id = $profile_info['id'];
$db_password = $profile_info['password'];

//Update account details
if ($submit == 'Save changes') {
    $first_name = clean_string($_POST['first-name']);
    $last_name = clean_string($_POST['last-name']);
    $email = clean_string($_POST['email']);
    $current_password = clean_string($_POST['current-password']);
    $new_password = clean_string($_POST['new-password']);
    $confirm_new_password = clean_string($_POST['confirm-new-password']);

    //Output variables
    $updateProfile_bad_message = '';
    $updateProfile_good_message = '';

    if ($db_server) {
        if (!empty($first_name)) {
            if ($first_name = clean_string($first_name)) {
                $query = "UPDATE users SET first_name = '$first_name' WHERE id = '$id'";
                mysql_query($query) or die("Insert failed. " . mysql_error() . "<br />" . $query);
                $updateProfile_good_message = '<div class="alert alert-success">Changes saved</div>';
            } else {
                $updateProfile_bad_message = '<div class="alert alert-error">Sorry, something\'s gone wrong! Please try again later.</div>';?>
                <script type="text/javascript">
                    $('a.account-update').trigger('click');
                </script><?php
            }
        } 
        if (!empty($last_name)) {
            if ($last_name = clean_string($last_name)) {
                $query = "UPDATE users SET last_name = '$last_name' WHERE id = '$id'";
                mysql_query($query) or die("Insert failed. " . mysql_error() . "<br />" . $query);
                $updateProfile_good_message = '<div class="alert alert-success">Changes saved</div>';
            } else {
                $updateProfile_bad_message = '<div class="alert alert-error">Sorry, something\'s gone wrong! Please try again later.</div>';?>
                <script type="text/javascript">
                    $('a.account-update').trigger('click');
                </script><?php
            }
        } 
        if (!empty($email)) {
            if ($email = clean_string($email)) {
                $taken = mysql_query("SELECT email FROM users WHERE email='$email'");
                $count = mysql_num_rows($taken);
                if ($count > 0) {
                    $updateProfile_bad_message = '<div class="alert alert-error">The email you have entered is already associated with a Screening account. Please choose another.</div>';
                } else if ($count = 0) {
                    $query = "UPDATE users SET email = '$email' WHERE id = '$id'";
                    mysql_query($query) or die("Insert failed. " . mysql_error() . "<br />" . $query);
                    $updateProfile_good_message = '<div class="alert alert-success">Changes saved</div>';
                } else {
                    $updateProfile_bad_message = '<div class="alert alert-error">Sorry, something\'s gone wrong! Please try again later.</div>';?>
                    <script type="text/javascript">
                        $('a.account-update').trigger('click');
                    </script><?php
                }
            }
        } 
        if ($_FILES) {
            $file_name = $_FILES['profile-image']['name'];
            $file_size = $_FILES['profile-image']['size'];
            $file_tmp_name = $_FILES['profile-image']['tmp_name'];

            //Determine filetype
            switch ($_FILES['profile-image']['type']) {
                case 'image/jpeg': $ext = "jpg"; break;
                case 'image/png': $ext = "png"; break;
                default: $ext = ''; break;
            }

            if ($ext) {
                //Check filesize
                if ($file_size < 50000000000) {
                    //Process file - resize, clean up filename and move to safe location
                    $image = new SimpleImage();
                    $image->load($file_tmp_name);
                    $image->resizeToWidth(250);
                    $image->save($file_tmp_name);

                    $n = "$file_name";
                    $n = ereg_replace("[^A-Za-z0-9.]", "", $n);
                    $n = strtolower($n);
                    $n = "avatars/$n";
                    move_uploaded_file($file_tmp_name, $n);
                    $query = "UPDATE users SET image = '$n' WHERE id = '$id'";
                    mysql_query($query) or die("Insert failed. " . mysql_error() . "<br />" . $query);
                    $updateProfile_good_message = '<div class="alert alert-success">Changes saved</div>';
                } else {
                    $updateProfile_bad_message = '<div class="alert alert-error">Please ensure your chosen file is less than 5MB.</div>';?>
                    <script type="text/javascript">
                        $('a.account-update').trigger('click');
                    </script><?php

                }
            } else {
                $updateProfile_bad_message = '<div class="alert alert-error">Please ensure your image is of filetype .jpg or .png.</div>';?>
                <script type="text/javascript">
                    $('a.account-update').trigger('click');
                </script><?php
            }
        }
        if (!empty($current_password)) {
            $current_password = clean_string($current_password);
            if ($current_password = md5($db_password)) {
                if ($new_password == $confirm_new_password) {
                    $new_password = clean_string($new_password);
                    $confirm_new_password = clean_string($confirm_new_password);
                    $new_password = md5($new_password);
                    $query = "UPDATE users SET password = '$new_password' WHERE id = '$id'";
                    mysql_query($query) or die("Insert failed. " . mysql_error() . "<br />" . $query);
                    $updateProfile_good_message = '<div class="alert alert-success">Changes saved</div>';
                } else {
                    $updateProfile_bad_message = '<div class="alert alert-error">Your passwords did not match. Please check your spelling and try again.</div>';?>
                    <script type="text/javascript">
                        $('a.account-update').trigger('click');
                    </script><?php
                }
            } else {
                $updateProfile_bad_message = '<div class="alert alert-error">Your current password is incorrect. Please check your spelling and try again.</div>';?>
                <script type="text/javascript">
                    $('a.account-update').trigger('click');
                </script><?php
            }
        }
    } else {
        $updateProfile_bad_message = '<div class="alert alert-error">Error: could not connect to the database. Please try again shortly.</div>';?>
        <script type="text/javascript">
            $('a.account-update').trigger('click');
        </script><?php
    }
    require_once("db_close.php");?>
    <script type="text/javascript">
        window.location = "profile.php"
    </script>
    <script type="text/javascript">
        $('a.account-update').trigger('click');
    </script><?php
} 
```

**更新**

要添加更多信息，我认为没有出现模式和错误消息的原因是，为了在页面上显示更新的信息，必须在重新显示模式之前重新加载页面本身。我假设，在页面重新加载时，重新加载之前发生的任何事情都几乎被根除，因此为什么在手动单击“更新配置文件”按钮重新打开时没有显示任何信息，例如警报消息页面重新加载后的模式。这是*应该*发生的事情：

*   如果有任何错误，只显示错误反馈信息，不需要重新加载页面
*   如果没有错误，重新加载页面以显示更新的信息并重新显示模式以确认更改已成功保存。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:39:12.293

根据 Bootstrap 文档，手动显示模式的适当方法是使用如下`show`参数：

```
$(function () {
  $('#myModal').modal('show');
}); 
```

更多信息请访问[http://twitter.github.com/bootstrap/javascript.html#modals](http://twitter.github.com/bootstrap/javascript.html#modals)

通过将代码包装在 jQuery 构造函数中，代码将在 DOM 准备就绪时执行。

# asp.net-mvc - 在主布局页面中包含登录表单 - ASP.NET MVC 3

> ID：15647804
> 
> 赞同：2
> 
> 时间：2013-03-26T21:31:43.967
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我正在尝试将我的登录表单包含在 _Layout.cshtml 文件中，但我遇到了一些问题。

首先，当我提供的用户名和/或密码不正确，或者输入字段未通过验证时，不是在局部视图中显示错误消息，而是使局部视图占据整个屏幕！

这是部分视图：http: [//i.imgur.com/oisCj85.png ?1](http://i.imgur.com/oisCj85.png?1)

这是登录出现问题时返回的“部分”视图：http: [//i.imgur.com/Uc5Sh2t.png ?1](http://i.imgur.com/Uc5Sh2t.png?1)

其次，当登录成功*时*，用户确实登录了，页面“重新加载”，但`<body onload="loadPage();>`_Layout.cshtml 中的 Javascript 没有执行（因此我无法获得登录栏再次显示，因为默认情况下它已折叠）。编辑：这个问题现在解决了，JS没有执行，因为它有错误。它引用了一个仅在您未登录时显示的按钮，显然在您登录时破坏了*代码*:)

这是我的代码：

_LogOn.cshtml：

```
@model project_blok_c_groep_13_webshop.Models.LogOnModel

@{
    if (Request.IsAuthenticated)
    {
    <div class="minicolumn">
        U bent ingelogd als: @User.Identity.Name
    </div>
    <div class="minicolumn miniborder">
        Click here to log out!
    </div>
    }
    else
    {
    <div class="minicolumn">
        @using (Html.BeginForm("_LogOn", "Account", new { ReturnUrl = Request.QueryString["ReturlUrl"] }))
        {
            <span style="color:red">@Html.ValidationSummary(true, "Incorrecte gebruikersnaam en/of wachtwoord.")</span>
            <fieldset>
                Gebruikersnaam:
                @Html.TextBoxFor(model => model.Username)
                @Html.ValidationMessageFor(model => model.Username)

                Wachtwoord:
                @Html.PasswordFor(model => model.Password)
                @Html.ValidationMessageFor(model => model.Password)

                <input type="submit" value="Log-in" />
            </fieldset>
        }
    </div>
    }
} 
```

_Layout.cshtml：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
 <!-- saved from url=(0014)about:internet -->
 <head>
  <title>Webshop</title>
  <link href="@Url.Content("~/Content/Site.css")" type="text/css" rel="stylesheet" />
  <link href='http://fonts.googleapis.com/css?family=Merriweather+Sans' rel='stylesheet' type='text/css' />

  <script type="text/javascript">
      <!--lots of javascript omitted here-->
  </script>

 </head>

 <body onload="loadPage();">
  <div class="maindiv">
   <div class="topbar">
   </div>
   <div id="minibar">
    @Html.ActionLink("Log uit", "LogOff","Account")
    <a href="/">Home</a>
    <a href="#">Catalogus</a>
    <a href="#">Winkelwagen</a>
    <a href="#">Contact</a>
    <a onclick="displayBar();">Account</a>
    <div id="visbar">
        @Html.Action("_LogOn", "Account")
    </div>
   </div>
   <div class="content">
     <div class="sidebar">
        @Html.Action("_Menu", "Home")
     </div>

     <div class="center">
      <noscript>
       <p>
        For full functionality of this site it is necessary to enable JavaScript.
        Here are the <a href="http://www.enable-javascript.com/" target="_blank">
        instructions how to enable JavaScript in your web browser.</a>
       </p>
      </noscript>

      @RenderBody()

     </div>
    </div>
    <div class="footer">

    </div>
   </div>
 </body>
</html> 
```

最后，AccountController：

```
 public class AccountController : Controller
    {
        private AuthDBController authDBController = new AuthDBController();

        public ActionResult LogOff()
        {
            FormsAuthentication.SignOut();

            return RedirectToAction("Index", "Home");
        }    

        /*
         * Voor de expandable bar.
         */
        public PartialViewResult _LogOn()
        {
            return PartialView();
        }

        [HttpPost]
        public ActionResult _LogOn(LogOnModel logOnModel, string returnUrl)
        {
            if (ModelState.IsValid)
            {
                bool auth = authDBController.isAuthorized(logOnModel.Username, logOnModel.Password);

                if (auth)
                {
                    FormsAuthentication.SetAuthCookie(logOnModel.Username, false);
                    return Redirect(returnUrl ?? Url.Action("Index", "Home"));
                }
                else
                {
                    ModelState.AddModelError("loginfout", "Incorrecte gebruikersnaam en/of wachtwoord.");
                }
            }
            return PartialView(logOnModel);
        }

    } 
```

这些问题让我很困惑，我已经查看了很多其他类似的问题，但没有一个有答案。任何帮助将不胜感激。我想我不明白部分视图、重定向和东西是如何工作的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T22:19:10.227

我做了类似的功能。

控制器动作：

```
[AllowAnonymous]
    [HttpPost]
    public ActionResult LoginJs(LoginModel m, string returnUrl)
    {
        if(ModelState.IsValid)
        {
            if(ValidateUser(m))
            {
                FormsAuthentication.SetAuthCookie(m.Card, false);

                return Json(new { success = true, redirect = Url.IsLocalUrl(returnUrl) ? returnUrl : Url.Action("Summary") });
            }

            ModelState.AddModelError("", _invalidUser);
        }

        return Json(new { errors = GetErrorsFromModelState() });
    }

    private IEnumerable<string> GetErrorsFromModelState()
    {
        return ModelState.SelectMany(x => x.Value.Errors.Select(error => error.ErrorMessage));
    } 
```

我的 _Layout.cshtml 代码：

```
@if (Request.IsAuthenticated)
{
   <div class="enter">
      U bent ingelogd als: @User.Identity.Name
      @Html.ActionLink("Log out", "Logoff", "Members", null, new { @class = "exit"     })
   </div>
}
else
{
    Html.RenderAction("LoginJsGet", "Members");
} 
```

部分视图代码：

```
@model LoginModel

@using(Html.BeginForm("Login", "Members", FormMethod.Post, new { id = "login", @class = "enter_form" }))
 {
     <span style="color:red">@Html.ValidationSummary(true, "Incorrecte gebruikersnaam en/of wachtwoord.")</span>
            <fieldset>
                Gebruikersnaam:
                @Html.TextBoxFor(model => model.Username)
                @Html.ValidationMessageFor(model => model.Username)

                Wachtwoord:
                @Html.PasswordFor(model => model.Password)
                @Html.ValidationMessageFor(model => model.Password)

                <input type="submit" value="Log-in" />
            </fieldset>
} 
```

和 JavaScript：

```
<script>
$(function () {
    $('#login').unbind('submit');

    $('#login')
        .attr('action', '/Members/LoginJs')
        .bind('submit', function () {
            var form = this;
            if ($("#login").valid()) {
                $.post($(form).attr('action'), $(form).serialize(), function (data) {
                    if (data.errors) {
                        makePopup(data.errors, 'error', 'Ошибка входа');
                    } else {
                        document.location = data.redirect;
                    }
                });
            }

            return false;
        });
}); 
```

# autohotkey - 运行 Skyrim 时 AutoHotkey 脚本未启动

> ID：15647807
> 
> 赞同：0
> 
> 时间：2013-03-26T21:32:02.890
> 
> 标签：autohotkey

我想在游戏覆盖之前使用一个简单的脚本来备份现有的快速保存文件。本质上，我想要的是每次按 F5 时都有一个新的保存文件：

```
F5::
OldQuickSave := "c:\Users\Me\Documents\My Games\Skyrim\Saves\quicksave.ess"
FileGetTime, qstime, %OldQuickSave%
BackupFileName := "c:\Users\Me\Documents\My Games\Skyrim\Saves\OldQuicksave" . qstime . ".ess"
FileCopy, %OldQuickSave%, %BackupFileName%
SendPlay {F5}
return 
```

在游戏之外它可以工作，但在游戏运行时，命令不会到达 AutoHotkey。游戏按原样保存，但脚本未启动。就好像我从来没有按下过键一样。我的猜测是 Skyrim 使用 DirectInput 来读取键盘，它消耗事件并且不会进一步发送它。有什么解决方法吗？或者任何其他为每个快速保存创建新的游戏存档文件的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:26:08.230

我找到了使用以下脚本的解决方法：

```
Label:
KeyWait, F5, D
OldQuickSave := "c:\Users\Me\Documents\My Games\Skyrim\Saves\quicksave.ess"
FileGetTime, qstime, %OldQuickSave%
BackupFileName := "c:\Users\Me\Documents\My Games\Skyrim\Saves\OldQuicksave" . qstime . ".ess"
FileCopy, %OldQuickSave%, %BackupFileName%
Sleep, 5000
Goto, Label 
```

睡眠是为了防止在长时间按下键的情况下多次执行。不过，我仍然很好奇第一次出了什么问题。

# javascript - addEventListener keydown 不起作用

> ID：15647810
> 
> 赞同：6
> 
> 时间：2013-03-26T21:32:19.310
> 
> 标签：javascript, html, html5-canvas

我在互联网上获取了一些基本的 Pong 代码并尝试添加按键，代码在这里：[http ://cssdeck.com/labs/ping-pong-game-tutorial-with-html5-canvas-and-sounds](http://cssdeck.com/labs/ping-pong-game-tutorial-with-html5-canvas-and-sounds)

我添加了这个：

```
canvas.addEventListener("keydown", handlekeydown, true); 
```

在此现有代码之后：

```
canvas.addEventListener("mousemove", trackPosition, true);
canvas.addEventListener("mousedown", btnClick, true); 
```

我还添加了这个：

```
function handlekeydown(e) {
  console.log("debug");
  console.log("keycode: "+e.keyCode);
} 
```

但是即使我尝试按各种键，也不会调用该函数。为什么是这样？我很确定画布是焦点。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-26T21:39:19.797

您无法将`keydown`事件分配给画布，因为您无法使用光标聚焦画布。您需要将事件分配给窗口：

```
window.addEventListener("keydown", handle, true); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-26T21:37:41.147

您可以尝试将*canvas*替换为**window**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T03:07:37.727

我同意一楼，但你可以尝试这样做。如下：

```
//set attribute tabindex = 0 (other number), ensure the canvas in the focus sequence
//like this, you can focus canvas
//http://www.w3schools.com/tags/att_global_tabindex.asp
<canvas id="snake" width="400" height="600" tabindex=0 > </canvas> 

//then register keydown event
document.getElementById("snake").addEventListener("keydown", function(ev){
          console.log(ev);
}, true); 
```

# hadoop - 如何在不同节点集群中调度hadoop map任务

> ID：15647815
> 
> 赞同：1
> 
> 时间：2013-03-26T21:32:46.577
> 
> 标签：hadoop, mapreduce, hdfs

我有一个唯一的地图程序，它有 10 多张地图。我的集群有 5 个节点，我的问题是：我可以调度运行哪些映射任务到哪个节点？比如让1号map在node1运行，3号map在node3运行，9号map在node5运行。如果我可以这样做，那么需要对我的代码和配置文件进行哪些更改。顺便说一句，我使用 HDFS。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T14:02:24.173

无法在 Hadoop 中为映射任务到节点的映射设置关联性。调度程序会根据数据位置/槽状态自动决定在哪里运行 Map 任务。

# mono - mod_mono 以文件更改为理由每分钟重新启动服务器进程

> ID：15647816
> 
> 赞同：1
> 
> 时间：2013-03-26T21:32:48.873
> 
> 标签：mono, apache2, mod-mono, fedora16

在 Fedora 17 上运行 mod_mono server 4.0，每分钟，每分钟，mono 都会自行重启，并引用文件更改作为重启的原因，尽管事实上没有创建任何文件。

有时但并非总是如此，它会在循环过程中引发异常。示例日志如下：

```
Change: /var/www/html/mysite/script/dashboard/view
Change: /var/www/html/mysite/script/dashboard/controller
Change: /var/www/html/mysite/script/dashboard/model
Change: /var/www/html/mysite/script/dashboard/chart
Change: /var/www/html/mysite/script/dashboard
Change: /var/www/html/mysite/script
Change: Global.asax
Change: /var/www/html/mysite/script/dashboard/store
System.Threading.ThreadAbortException: Thread was being aborted
  at (wrapper managed-to-native) System.IO.MonoIO:GetFileAttributes (string,System.IO.MonoIOError&)
  at System.IO.MonoIO.ExistsDirectory (System.String path, System.IO.MonoIOError& error) [0x00000] in /builddir/build/BUILD/mono-2.10.8/mcs/class/corlib/System.IO/MonoIO.cs:254 
  at System.IO.Directory.Exists (System.String path) [0x00014] in /builddir/build/BUILD/mono-2.10.8/mcs/class/corlib/System.IO/Directory.cs:202 
  at Mono.WebServer.ModMonoWorkerRequest.TryDirectory () [0x00007] in /builddir/build/BUILD/xsp-2.10.2/src/Mono.WebServer.Apache/ModMonoWorkerRequest.cs:191 
  at Mono.WebServer.ModMonoWorkerRequest.GetRequestData () [0x00000] in /builddir/build/BUILD/xsp-2.10.2/src/Mono.WebServer.Apache/ModMonoWorkerRequest.cs:216 
  at Mono.WebServer.MonoWorkerRequest.ReadRequestData () [0x00000] in /builddir/build/BUILD/xsp-2.10.2/src/Mono.WebServer/MonoWorkerRequest.cs:334 
  at Mono.WebServer.BaseApplicationHost.ProcessRequest (Mono.WebServer.MonoWorkerRequest mwr) [0x0000e] in /builddir/build/BUILD/xsp-2.10.2/src/Mono.WebServer/BaseApplicationHost.cs:114 
  at Mono.WebServer.ModMonoApplicationHost.ProcessRequest (Int32 reqId, System.String verb, System.String queryString, System.String path, System.String protocol, System.String localAddress, Int32 serverPort, System.String remoteAddress, Int32 remotePort, System.String remoteName, System.String[] headers, System.String[] headerValues, System.Object worker) [0x0016d] in /builddir/build/BUILD/xsp-2.10.2/src/Mono.WebServer.Apache/ModMonoApplicationHost.cs:113 
  at (wrapper remoting-invoke-with-check) Mono.WebServer.ModMonoApplicationHost:ProcessRequest (int,string,string,string,string,string,int,string,int,string,string[],string[],object)
  at Mono.WebServer.ModMonoWorker.InnerRun (System.Object state) [0x0017d] in /builddir/build/BUILD/xsp-2.10.2/src/Mono.WebServer.Apache/ModMonoWorker.cs:239 
  at Mono.WebServer.ModMonoWorker.Run (System.Object state) [0x00000] in /builddir/build/BUILD/xsp-2.10.2/src/Mono.WebServer.Apache/ModMonoWorker.cs:92 
[Tue Mar 26 14:24:02 2013] [error] (70014)End of file found: read_data failed
[Tue Mar 26 14:24:02 2013] [error] Command stream corrupted, last command was 1
[Tue Mar 26 14:24:02 2013] [error] (104)Connection reset by peer: read_data failed
[Tue Mar 26 14:24:02 2013] [error] Command stream corrupted, last command was -1 
```

任何有关导致问题的原因或如何解决问题的线索将不胜感激。

# ios - 混合解码和硬件解码的区别

> ID：15647817
> 
> 赞同：0
> 
> 时间：2013-03-26T21:33:06.283
> 
> 标签：ios, media-player, codec

对于 iOS 播放器（例如 AVPlayer 或 oPlayer），存在混合和硬件解码设置。两者都是为 h.264 编解码器设计的（通常使用 h.264 编解码器播放高清文件）。我不明白他们之间的区别。

有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:42:52.583

当解码器被标记为`Hardware`解码器时，意味着解码完全由平台中的硬件块执行。当存在此类*固定功能硬件块*时，要考虑的主要因素之一是功能将受到限制，即仅支持那些受支持的`hardware decoder`功能，如果需要新功能，您将不得不进入重新*设计*和*重新旋转*相同。

硬件解码器的主要优点是它通常是省电的，因为硬件是专门为实现该功能而设计的。除此之外，还通过将硬件解码器模块的输出格式与`GPU`.

当解码器被标记为`Software`解码器时，它是在 CPU 上运行的编解码器的纯软件实现。这种实现方法有助于扩展底层编解码器的功能，因为它只是用新版本替换旧版本的软件。

软件解码器的主要缺点是耗电量大。对于更大视频分辨率的大内存访问，软件解码器的功率需求会大幅增加，并且会更快地耗尽电池电量。对于大分辨率和长时间播放来说，这绝对不是一个好的选择。

`Hybrid`解码器是另一类解码器，它集成了作为预处理器的软件模块，通常具有底层硬件引擎。例如，如果有一个底层的高性能`DSP`或`SIMD`引擎，那么预处理器可以执行解码的串行部分，如 CAVLD 和其他头/位解析操作，而更复杂的数学部分，如`Intra Prediction`，`Motion Compensation`将由底层硬件块。

一些`Hybrid`解码器也被认为是解码器，但当今世界上`Hardware`越来越多的新型解码器可用。`Hardware`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:34:44.043

硬件使用 GPU（或特定硬件）进行视频解码。软件使用 CPU 进行解码。Hybrid是2的混合物。

如今，“硬件”这个绰号越来越用词不当......

# mysql - MYSQL 从多个重复项中拆分出除最新记录外的记录

> ID：15647820
> 
> 赞同：0
> 
> 时间：2013-03-26T21:33:14.690
> 
> 标签：mysql, split, timestamp, duplicates

我一直在寻找几个小时来找到这个，虽然有很多变化，但我似乎无法完全满足我的特定要求......每次我认为我已经得到它时，它都会从我身边溜走:)

就是这样；

我已经将一堆记录导入到一个表中，该表具有最终唯一的行，但某些列中有一些重复的数据。 ~~我想将记录拆分为两张表 - 一张包含 DISTINCT 或 UNIQUE 'code' 记录的表，这些记录在其“代码”组中具有最新时间戳，另一张表包含其余记录~~

[编辑 - 最诚挚的歉意，我必须重新措辞，因为我认为我第一次表达的不是很清楚 - 事实上我弄错了......对不起！]

我有多个仅具有唯一 ROWS 的列 - （即每列都有重复数据，但特定行中所有列的组合是唯一的 - 显然不包括主键）

我需要的是包含特定**area_id中****代码的****最新时间戳**的行。 在下面的示例中，我将其他列排除在外，因为我将这三列视为关键；

 ****```
TABLE#1
        code    area_id   timestamp    
         1        2      2010-02-31 00:00:00
         2        2      2012-01-31 00:00:00
         2        2      2011-02-31 00:00:00
         1        5      2010-02-31 00:00:00
         2        5      2010-02-31 00:00:00
         1        2      2011-01-31 00:00:00
         1        5      2012-01-31 00:00:00 
```

所以我试图表达的答案的结构是；

“对于 code **1** & area_id **2**的组合，最新的时间戳是**2011-01-31 00:00:00”** - 返回该行。

对代码和 area_id 的每个组合重复此操作。

所以;

```
RESULT
        code    area_id   timestamp    
         1        2      2011-01-31 00:00:00
         2        2      2012-01-31 00:00:00
         1        5      2012-01-31 00:00:00
         2        5      2010-02-31 00:00:00 
```

正如我所提到的，当我将行拆分时，还有很多其他列需要与数据一起提供，但我想我以后可以担心 - 第一步是在没有 mysql/ 的情况下获取结果集中的数据工作台超时！

JS

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:42:38.990

这是针对 table2

```
INSERT INTO Table2
SELECT *
FROM Table1
WHERE (code, timestamp) NOT IN (SELECT code, MAX(timestamp)
                                FROM Table1
                                GROUP BY code) 
```

然后从 Table1 中删除记录：

```
DELETE FROM Table1
WHERE (code, timestamp) NOT IN (SELECT * FROM (SELECT code, MAX(timestamp)
                                FROM yourtable
                                GROUP BY code) s) 
```

请[在此处](http://sqlfiddle.com/#!2/ea0c7/1)查看小提琴（我将 2 月 31 日更改为 28 日，4 月 31 日更改为 30 日，我认为这是一个错字）。

**编辑**

由于这些查询执行起来太慢，您可以尝试 JOIN 版本：

```
INSERT INTO Table2
SELECT t1.*
FROM Table1 t1 LEFT JOIN (SELECT code, MAX(timestamp) max_timestamp
                          FROM Table1
                          GROUP BY code) t2
     ON t1.code=t2.code and t1.timestamp=t2.max_timestamp
WHERE
  t2.code IS NULL;

DELETE t1
FROM Table1 t1 LEFT JOIN (SELECT code, MAX(timestamp) max_timestamp
                           FROM Table1
                           GROUP BY code) t2
     ON t1.code=t2.code and t1.timestamp=t2.max_timestamp
WHERE
  t2.code IS NULL; 
```

请[在此处](http://sqlfiddle.com/#!2/bbe1a/1)查看小提琴。

此外，您可以尝试添加以下索引之一：

```
CREATE INDEX idx1 ON Table1 (code)
CREATE INDEX idx2 ON Table1 (timestamp)
CREATE INDEX idx3 ON Table1 (code,timestamp) 
```****

# magento - 如何在 Magento 管理订单视图屏幕中将 Ship 按钮的操作更改为拥有模块/控制器/操作？

> ID：15647821
> 
> 赞同：0
> 
> 时间：2013-03-26T21:33:15.847
> 
> 标签：magento

![Magento 管理员](../Images/eadd32b9f996ba9ff569cf14affc1503.png)

如何更改Magento 后端屏幕中`Ship`按钮的操作？`Order view`上图描绘了`Ship`我的意思的按钮。我想将它指向我自己模块的控制器/动作。我想尽可能干净地做到这一点，以保持 Magento 可升级而不会破坏我的模块。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T00:52:43.017

尝试创建一个重写的自定义模块`Mage_Adminhtml_Block_Sales_Order_View`

**配置.xml：**

```
<global>
    <blocks>
         <adminhtml>
            <rewrite>
                <sales_order_view>Namespace_Module_Block_Adminhtml_Sales_Order_View</sales_order_view>
            </rewrite>
        </adminhtml>
    </blocks>
 </global> 
```

**命名空间/模块/块/Adminhtml/Sales/Order/View.php：**

```
class Namespace_Module_Block_Adminhtml_Sales_Order_View extends Mage_Adminhtml_Block_Sales_Order_View {
        public function getShipUrl()
        {
            //add your custom url
            return $this->getUrl('*/sales_order_shipment/start');
        }
} 
```

见/app/code/core/Mage/Adminhtml/Block/Sales/Order/View.php

阅读更多@[如何在 Magento 管理面板中添加新按钮到订单视图？](https://stackoverflow.com/questions/6642599/how-to-add-new-button-to-order-view-in-magento-admin-panel)

如果您还想更改标题更新

```
 if ($this->_isAllowedAction('ship') && $order->canShip()
        && !$order->getForcedDoShipmentWithInvoice()) {
        $this->_addButton('order_ship', array(
            'label'     => Mage::helper('sales')->__('Ship'),
            'onclick'   => 'setLocation(\'' . $this->getShipUrl() . '\')',
            'class'     => 'go'
        ));
    } 
```

# excel - Excel 功能区在文件重命名后不起作用

> ID：15647822
> 
> 赞同：1
> 
> 时间：2013-03-26T21:33:19.190
> 
> 标签：excel, ribbon, vba

嘿，我一直在创建宏，然后将它们添加到 excel (2010) 上的自定义功能区中。我遇到的问题是，每次我重命名创建宏和功能区的原始文件（另存为）然后单击功能区/宏时，它会自动打开原始文件以处理新的另存为文件. 如果我从原始路径中删除文件，然后再次打开重命名的文件并使用功能区运行宏，它不会运行它会给我找不到错误文件。

我已经导出了自定义的功能区 ui，当我使用记事本 ++ 打开它时，我可以看到原始文件的硬编码路径是否有解决这个问题的方法？每次我用不同的名称或不同的路径保存文件时重命名这些功能区....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-03T16:28:46.753

从这里使用自定义 UI 编辑器：http: [//openxmldeveloper.org/blog/b/openxmldeveloper/archive/2010/08/10/23248.aspx](http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2010/08/10/23248.aspx)

这里有一个微软指南：http: [//msdn.microsoft.com/en-us/library/ee691832 (v=office.14).aspx](http://msdn.microsoft.com/en-us/library/ee691832(v=office.14).aspx)

在实际对宏和功能区进行编码时，请避免对名称进行硬编码，它会完美运行。这是我在一个宏文件中使用的代码示例：

```
<?xml version="1.0" encoding="utf-8"?>
<customUI xmlns="http://schemas.microsoft.com/office/2009/07/customui">
  <ribbon>
    <tabs>
      <tab id="refunds" label="Refunds/Returns" >
        <group id="financeRefund" label="Refunds &amp; Returns" >
          <button id="refresh" visible="true" size="large" 
                  label="Refresh Front Page" keytip="R" 
                  screentip="Refresh the frontpage without clearing the data in the data sheet." 
                  onAction="refreshfp" imageMso="RecurrenceEdit" />
          <button id="new" visible="true" size="large" 
                  label="Update Data" keytip="S" 
                  screentip="Pulls in new data from the live sheet, clearing any changes made to the current     data sheet." 
                  onAction="updateData" 
imageMso="ExportSharePointList" />
        </group>
      </tab>
    </tabs>
  </ribbon>
</customUI> 
```

希望这可以帮助

# powershell - 为什么 psake 不按我期望的方式评估我的财产？

> ID：15647824
> 
> 赞同：4
> 
> 时间：2013-03-26T21:33:24.003
> 
> 标签：powershell, psake

我有一个简单的 psake 脚本：

```
properties {
    $SolutionDir = "SOLUTIONDIR" # Resolve-Path ".\src"
    $Config = "Debug"
    $DeployBaseDir = "$SolutionDir\RMSS.Setup.WiX\bin\$Config"
    $InstallerName = "RMSForMoversSuite_2_0_0"
}

task default -depends Test

task Test {
    "CONFIG = $Config"
    "SOLUTIONDIR = $SolutionDir"
    "DEPLOYBASEDIR = $DeployBaseDir"
} 
```

我从命令行调用它，如下所示：

`& .\psake.ps1 .\deploy.ps1 -properties @{"Config"="Staging"}`

我希望`$DeployBaseDir`等于`SOLUTIONDIR\RMSS.Setup.WiX\bin\Staging`

但相反，我得到了这个输出：

```
CONFIG = Staging
SOLUTIONDIR = SOLUTIONDIR
DEPLOYBASEDIR = SOLUTIONDIR\RMSS.Setup.WiX\bin\Debug 
```

谁能告诉我发生了什么，为什么以及如何获得我期望的行为？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-27T05:18:27.527

从这里[http://codebetter.com/jameskovacs/2010/04/12/psake-v4-00/](http://codebetter.com/jameskovacs/2010/04/12/psake-v4-00/)

**支持参数和属性**

Invoke-psake 有两个新选项，–parameters 和 –properties。参数是传递给当前构建脚本的哈希表。这些参数在构建脚本中的任何“属性”函数之前处理，这意味着您可以从属性中使用它们。

```
invoke-psake Deploy.ps1 -parameters @{server=’Server01’}

# Deploy.ps1
properties {
  $serverToDeployTo = $server
    }

task default -depends All 
```

当您有所需的信息时，参数非常有用。另一方面，属性用于覆盖默认值。

```
invoke-psake Build.ps1 -properties @{config='Release'}

# Build.ps1
properties {
  $config = 'Debug'
}

task default -depends All 
```

* * *

因此，您可以将 $Config 从属性中取出并将其作为参数传递。
或者将 $DeployBaseDir 从属性中取出并在任务块中创建它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-20T02:30:21.417

如果您仍想为您的属性使用默认值并同时使用参数，这里是示例操作方法。

```
properties {
    $SolutionDir = "SOLUTIONDIR" # Resolve-Path ".\src"
    $Config = if($config){$config} else {"Debug"};
    $DeployBaseDir = "$SolutionDir\RMSS.Setup.WiX\bin\$Config"
    $InstallerName = "RMSForMoversSuite_2_0_0"
}

task default -depends Test

task Test {
    "CONFIG = $Config"
    "SOLUTIONDIR = $SolutionDir"
    "DEPLOYBASEDIR = $DeployBaseDir"
}

& .\psake.ps1 .\deploy.ps1 -parameters @{config="Staging"} 
```

（使用 psake 4.3.2 测试）

这鼓励使用约定优于配置，让老学生可以灵活地继续使用他们的配置意大利面。

# android - 安卓应用程序警告

> ID：15647831
> 
> 赞同：-12
> 
> 时间：2013-03-26T21:33:38.643
> 
> 标签：android

```
 ------------------------------
[2013-03-26 22:28:01 - sample] Android Launch!
[2013-03-26 22:28:01 - sample] adb is running normally.
[2013-03-26 22:28:01 - sample] Performing com.example.sample.MainActivity activity launch
[2013-03-26 22:28:01 - sample] Automatic Target Mode: using existing emulator 'emulator-5556' running compatible AVD 'firstpp'
[2013-03-26 22:28:03 - sample] Application already deployed. No need to reinstall.
[2013-03-26 22:28:03 - sample] Starting activity com.example.sample.MainActivity on device emulator-5556
[2013-03-26 22:28:05 - sample] ActivityManager: Starting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] cmp=com.example.sample/.MainActivity }
[2013-03-26 22:28:05 - sample] ActivityManager: Warning: Activity not started, its current task has been brought to the front
[2013-03-26 22:31:44 - sample] ------------------------------ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T21:52:52.900

我猜这就是你担心的

`Warning: Activity not started, its current task has been brought to the front`

这仅仅意味着您的应用程序已经在运行，并且自上次运行以来没有任何更改，因此它正在执行它所说的并将您当前的任务带到最前面......不用担心。如果您还有其他问题，那么您需要提出正确的问题，而不是仅仅发布控制台输出并让我们猜测。

请阅读[常见问题解答](https://stackoverflow.com/faq)，了解要问什么样的问题以及如何提问。我们需要一个带有相关代码和错误消息的明确问题才能提供帮助。

是的，我知道这可能不是一个答案，因为没有明确的问题，但评论太多了，从过去的经验来看，我认为这就是 OP 的意思，显然不知道该问什么

# javascript - jQuery 选择器和 IFrame

> ID：15647833
> 
> 赞同：0
> 
> 时间：2013-03-26T21:33:45.363
> 
> 标签：javascript, jquery

我将不胜感激以下方面的帮助：

我在三个 iframe 中有三个表单，在公共父页面中有三个按钮。按钮的 onclick 事件需要在 iframe 中提交表单。

iframe 是通过 JavaScript 动态实例化到父页面中的，但是我认为这并不重要。

有三个 div 标签用于绘制 iframe：div-1 div-2 div-3。所有表格都没有 id。但是，所有三个表单共享相同的名称属性“rdForm”。

将使用什么选择器在 onclick 按钮事件中提交每个表单？还是比这更复杂？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:37:55.370

如果您可以访问框架：

```
<input type="button" class="submit" data-iframe="iframe_name_1" value="Submit" />
<input type="button" class="submit" data-iframe="iframe_name_2" value="Submit" />

<script type="text/javascript">
    $(function() {
        $('.submit').on('click', function(e) {
            e.preventDefault();
            var iframename = $(this).data('iframe');
            window.top['iframename'].document.rdForm.submit();
        });
    });
</script> 
```

# java - 无法运行 yui jar 文件 - 函数体后缺少变量名和缺少 }

> ID：15647835
> 
> 赞同：1
> 
> 时间：2013-03-26T21:33:50.623
> 
> 标签：java, javascript, jquery, yui-compressor

我正在尝试在 cmd 中运行此命令：

```
java -jar yuicompressor-2.4.2.jar "C:\Users\Ehud\Desktop\test\dest\js\replacejs.js" -o       "C:\Users\Ehud\Desktop\test\dest\js.js" --charset utf-8 --verbose --preserve-semi 
```

我的操作系统是 Win 7 64 位，我的机器上安装了 Java，我正在从 jar 文件所在的目录运行此命令。奇怪的是，这在另一台机器上运行良好，我不明白为什么我会收到这个错误：

[错误] 34:20 缺少变量名

[错误] 34:20missing } 在函数体之后

[错误] 34:20missing } 在函数体之后

由于我没有在网上看到任何带有 } 的东西来运行这个，我可以假设 jar 文件有什么问题吗？

谢谢你的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:48:16.497

这些听起来更像是 yuicompressor 在您的 .js 文件中发现的错误，并且在解决语法错误之前它无法发挥作用。

例如：[在函数体之后缺少 }...即使所有内容都已正确关闭](https://stackoverflow.com/questions/5556863/missing-after-function-body-even-though-everything-is-closed-properly)

使用细齿梳（或标记语法错误的 JavaScript 编辑器）检查您的 .js 文件，看看是否可以在其中找到问题。

# tomcat - tomcat url 域重写

> ID：15647836
> 
> 赞同：1
> 
> 时间：2013-03-26T21:33:54.220
> 
> 标签：tomcat, rewrite

我有一个应用程序，它存在于 Tomcat 上，没有 apache 前面，随着我们公司的发展和变化，我们已经为这个应用程序命名了多个域。所以现在 www.mydomain.com www.yourdomain.com www.ourdomain.com 都解析到同一个主机。我现在只需要支持一个，但维护可能存在的书签和链接。所以：

www.mydomain.com/stuff/more/pickle 将 URL 重写为 www.mynewdomain.com/stuff/more/pickle

我一开始以为我可以使用在这里找到的 UrlRewriteFilter [http://tukey.org/urlrewrite/](http://tuckey.org/urlrewrite/) 但它似乎是在处理 uri 而不是域。

# mysql - SQL如何分组

> ID：15647837
> 
> 赞同：0
> 
> 时间：2013-03-26T21:34:02.583
> 
> 标签：mysql, sql, group-by, sql-order-by

假设我有一张如下表

```
Waiter          Complaints
Tim                Slow
John               Rude
Mike               Dumb
Tim                Asleep
Tim                Charge too much
Mike               Lazy 
```

如何创建一个表，其中服务员按最多的投诉排序，但投诉也显示？例如下面

```
Waiter          Complaints
Tim                Slow
Tim                Asleep
Tim                Charge too much
Mike               Lazy
Mike               Dumb
John               Rude 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T21:37:30.463

只需计算每个服务员的投诉数量并将其加入您的餐桌：

```
select t1.waiter,t1.complaints
from table t1
inner join(
  select waiter,count(1) as num_complaints
  from table
  group by waiter
)t2
on(t1.waiter = t2.waiter)
order by t2.num_complaints desc,t1.waiter,t1.complaints; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T21:40:29.347

这是 MySQL，您可以将投诉放在一行上，使用`group_concat()`：

```
select waiter, group_concat(complaints)
from t
group by waiter
order by count(*) desc 
```

这不完全是您在问题中的格式。它提供了另一种解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:35:28.167

您不想要分组依据，您想要订购依据

```
select Waiter, Complaints
from Service
order by Waiter desc 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-26T21:37:39.073

你只是想排序（ORDER BY WAITER）而不是分组（编辑：产生你说你想要的列表）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-03-26T21:36:59.723

这将为您提供服务员、投诉以及每个服务员的每种投诉类型的计数：

```
SELECT waiter, complaints, COUNT(complaints) AS `complaint_count`
FROM table
GROUP BY waiter, complaints
ORDER BY `complaint_count` DESC 
```

请注意，这不会将服务员一起订购，而是将服务员与投诉的顶级组合订购，因此您可能会遇到以下情况：

```
Mike    Dumb    5
Tim     Lazy    3
Mike    Rude    2
Tim     Rude    1 
```

您也可以先由服务员点餐，方法是将最后一行更改为：

```
ORDER BY waiter ASC, `complaint_count` DESC 
```

这可能会给出类似的东西：

```
Mike    Dumb    5
Mike    Rude    2
Tim     Lazy    3
Tim     Rude    1 
```

# java - Java Singleton.getInstance() 返回 null？

> ID：15647838
> 
> 赞同：7
> 
> 时间：2013-03-26T21:34:14.303
> 
> 标签：java, singleton, autoboxing

我有这个我正在尝试使用的单例，但 getInstance 显然可以返回 null：

```
class Singleton {
    public static final String K_LEVEL = "level";
    static Singleton instance = new Singleton();
    private int level;

    static Singleton getInstance() {
        return instance;
    }

    int getLevel() {
        return level;
    }

    void incrementLevel() {
        System.out.println("LEVEL INCREASED TO " + ++level);
    }

    void addToLevel(int x) {
        for(int i=0;i<x;i++)
            incrementLevel();
    }

}

class A {
    public static void main(String[] args) {
        Singleton s = Singleton.getInstance();
        Integer i = Integer.getInteger(Singleton.K_LEVEL);
        s.addToLevel(i);
    }
} 
```

我听说在 Java 中实现单例非常困难并且容易出现竞争条件。我的单例模式实施错误吗？我最近将我的代码更改为如下所示，现在 getInstance 有时会返回 null。为什么？

```
$ java A -Dlevel=1
Exception in thread "main" java.lang.NullPointerException
    at A.main(A.java:29) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T19:23:54.717

您的单身人士没有任何问题。不存在并发问题，因为这不是多线程代码。

你以为`s`是空的，但实际上`i`那是空的。

由于`addToLevel`将 a`int`作为参数，因此被自动拆箱（从to`Integer i`隐式转换），但由于is ，被抛出。当被转换的值为.`Integer``int``i``null``NullPointerException``NullPointerException``null`

`Integer.getInteger(Singleton.K_LEVEL)`返回的原因`null`是因为你做`java A -Dlevel=1`了而不是`java -Dlevel=1 A`. 后者是正确的语法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T21:39:57.033

这与您的单例模式无关，这对我来说看起来不错。它`Integer.getInteger(Singleton.K_LEVEL);`是返回 null 的方法。我敢打赌`"level"`系统属性尚未设置并且是`null`.

> ```
> java A -Dlevel=1 
> ```

您需要在命令行上的类`-Dlevel=1` *之前放置。*`A`如果您调试代码或打印出系统属性，您将看到它为空。

```
java -Dlevel=1 A 
```

当您尝试将 in 传递`null`并`addToLevel(int x)`尝试将 to 自动拆箱时，您`null`会得到一个 NPE `int x`。

顺便说一句，如果这个类被多个线程使用，你应该考虑`AtomicInteger`在你的`Singleton`类内部使用可重入的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-26T22:08:57.017

`java -Dlevel=1 A`应该适合您的需求。

从[doc](http://docs.oracle.com/javase/1.4.2/docs/tooldocs/windows/java.html)中，语法是`java [ options ] class [ argument ... ]`, 并且`-Dlevel=1`被视为一个选项（请参阅[选项](http://docs.oracle.com/javase/1.4.2/docs/tooldocs/windows/java.html#options)部分）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-27T17:34:46.220

`static Singleton instance = new Singleton();`应该是最终的以防止竞争条件。

# bash - 重新路由 Raspberry Pi GPIO - 虚拟引脚？

> ID：15647839
> 
> 赞同：1
> 
> 时间：2013-03-26T21:34:18.540
> 
> 标签：bash, raspberry-pi, gpio, reroute

我正在为 Raspberry Pi 移植开源项目 OpenROV。（该项目是为 BeagleBone 开发的。）该端口的唯一重大挑战是将软件对 GPIO1_0（又名 GPIO32）的引用更改为在 Raspberry Pi 的标头上打开的引脚（我在想 GPIO18）。原代码如下：

```
#!/bin/sh
# GPIO1_0 equals equals /sys/class/gpio32 (32 + 0)

#see http://ninjablocks.com/blog/2012/1/20/setting-up-gpio-on-the-beaglebone.htm l

back_to_normal() {
  sleep 1
  #set GPIO1_0 to HIGH
  echo "high" > /sys/class/gpio/gpio32/direction
}

reset() {
  sleep 1
  #prepare gpio
  echo "32" > /sys/class/gpio/export
  echo "out" >/sys/class/gpio/gpio32/direction 
  echo 7 > /sys/kernel/debug/omap_mux/gpmc_ad0
  #set GPIO1_0 to low
  echo "low" > /sys/class/gpio/gpio32/direction
  back_to_normal 
}
echo Initiating arduino reset 1>&2
reset & 
```

当然，我可以将非常参考 32 更改为 18，但这需要在每次更新时进行额外的工作。相反，是否有某种方法可以创建一个虚拟 GPIO32，自动将命令重定向到 GPIO18？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T08:58:50.603

我刚刚开始使用 Python 和 RPi.GPIO linux 包来玩 Raspberry Pi 及其 GPIO。我在博客上写了我的第一个简单步骤：[使用 Raspberry Pi GPIO 接口](http://workingmatt.blogspot.co.uk/2013/04/using-raspberry-pi-gpio-interface.html)。

有一个调用将[RPi.GPIO](https://code.google.com/p/raspberry-gpio-python/)的模式设置为 BOARD 或 BCM，通过调用 GPIO.setmode(GPIO.BOARD) 或 GPIO.setmode(GPIO.BCM) 在两个引脚配置之间更改。如果您查看它的作用，它可能会帮助您解决问题。

# android - 加速度计记录器：帧之间偶尔会出现长时间延迟

> ID：15647841
> 
> 赞同：2
> 
> 时间：2013-03-26T21:34:26.523
> 
> 标签：android, accelerometer

我正在编写一个应用程序，每 40 毫秒（25 赫兹）记录一次手机的加速度。这个帧率可以保持平均，但有时我会遇到 5'000 毫秒 - 50'000 毫秒的时间帧之间的延迟。我想知道为什么会这样。

在这里，您可以看到经常发生的延迟图表：

![加速度计测量之间偶尔会出现长时间延迟](../Images/4da91a185142eaad64ce754143c72d9c.png)

这是我正在做的事情（这可能很糟糕）：

*   该活动指向一个加速度计记录器类（单例、纯 java、无 android 类扩展）。
*   加速度计记录器单例继续在后台登录。
*   加速度计记录器将每个日志直接保存到 sqlite db。
*   我还在后台记录 GPS 数据。
*   DAO（数据访问对象）将每个 Log 分配给 LinkedBlockingQueue 并将它们保存在单独的线程中。

以下是我认为可能是问题所在：

*   也许我必须实现进一步的生命周期方法，或者扩展一个特定的 android 类，以便加速度计记录器获得优先级（或者只是在某处设置优先级）。
*   我可能会使用`event.timestamp`而不是`System.currentTimeMills()`. （我不想这样做，因为一些传感器有不同的时区，这就是我使用的原因`System.currentTimeMillis()`，但如果有必要我会切换。）

您对此有任何经验或建议问题可能出在哪里？

这是我的代码：

```
@SuppressLint("NewApi")
public class AccelerometerLogger implements SensorEventListener {

    private static AccelerometerLogger singleton = new AccelerometerLogger();

    private LoggerDao loggerDao;

    private SensorManager sensorManager;

    private Sensor accelerometer;

    private double acceleorometerRate = 25; // Hz

    int accelerometerDelayMicroseconds = (int) (Math.round(((1/this.acceleorometerRate)*1000000.0)));

    private AccelerometerLogger()
    {
        this.loggerDao = LoggerDao.getInstance();
    }

    public static AccelerometerLogger getInstance()
    {
        return singleton;
    }

    public void start(Context context)
    {
        this.sensorManager = (SensorManager) context.getSystemService(Context.SENSOR_SERVICE);
        this.accelerometer = this.sensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);

        int accelerometerMinDelay = this.accelerometer.getMinDelay();

        //Log.d("lggr-r", "desired delay: "+this.accelerometerDelayMicroseconds+" microseconds");
        //Log.d("lggr-r", "provided min delay: "+accelerometerMinDelay+" microseconds");

        if(accelerometerMinDelay < this.accelerometerDelayMicroseconds)
        {
            this.sensorManager.registerListener(this, this.accelerometer, this.accelerometerDelayMicroseconds);
            //Log.d("lggr-r", "listener registered for desired rate: "+this.acceleorometerRate+"Hz (delay of "+this.accelerometerDelayMicroseconds+" microseconds).");
        } 
        else if(accelerometerMinDelay==0)
        {           
            this.sensorManager.registerListener(this, this.accelerometer, SensorManager.SENSOR_DELAY_FASTEST);
            // Log.d("lggr-r", "listener registered for streaming api. only changes will be notified (interrupt).");
        }
        else
        {
            int providedRate = (int) Math.round(1 / (accelerometerMinDelay / 1000000.0));
            this.sensorManager.registerListener(this, this.accelerometer, SensorManager.SENSOR_DELAY_FASTEST);
            // Log.d("lggr-r", "can't read at the desired rate ("+this.acceleorometerRate+"Hz), app will read at "+providedRate+"Hz instead (delay of "+accelerometerMinDelay+" microseconds).");
        }
    }

    public void stop()
    {
        this.sensorManager.unregisterListener(this);
    }

    @Override
    public void onAccuracyChanged(Sensor sensor, int accuracy)
    {
        // String name = sensor.getName();
        // Log.d("lggr", "the accurracy of "+name+" changed to "+accuracy+".");
    }

    @Override
    public void onSensorChanged(SensorEvent event)
    {
        // lazy load loggerDao (TODO: fix all of those)
        if(this.loggerDao == null)
        {
            this.loggerDao = LoggerDao.getInstance();
        }

        String values = "";
        for(float value : event.values) values += value+",";
        values = values.substring(0,values.length()-2);

        // long timestamp = System.currentTimeMillis();
        // Log.d("lggr", "acc = {time:"+timestamp+", data: ["+values+"]}");

        AccelerometerSample accelerometerSample = new AccelerometerSample();
        accelerometerSample.setTimestamp(System.currentTimeMillis());
        accelerometerSample.setValues(event.values);

        this.loggerDao.save(accelerometerSample);
    }

} 
```

显然这个问题只发生在三星 Galaxy SIII mini 上。我用三星 Galaxy SII（自定义 ROM）对其进行了测试，延迟总是大约 0.04 秒（介于 0.005 和 0.12 秒之间——要好得多）。

为什么三星 Galaxy SIII mini 会发生这种情况，您有什么建议吗？

**更新：**

旨在使用的 Ben Voigts 答案`event.timestamp`显着改善了延迟。不过，我有时会遇到一些更长的延迟。你知道我该如何进一步改进它们吗？

![在此处输入图像描述](../Images/c3b060c0064f97e58d95e630c069b0f4.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T15:05:33.590

你绝对应该使用`event.timestamp`. 如果您需要本地时间，请计算第一个事件之间的调整因子，`event.timestamp`并将`System.currentTimeMills()`相同的调整应用于后续样本。

附加到样本的硬件提供的时间戳的全部意义在于它不会被线程调度延迟搞砸。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-31T11:32:08.687

正如 Ben Voigt 所说，有必要使用 event.timestamp 以获得传感器测量的准确时间戳。这是我自己使用并为我工作的代码示例：

```
@Override
public void onSensorChanged(SensorEvent event) {
    if (sampleCounter == 0) {
        long miliTime = System.currentTimeMillis();

        long nanoTime = event.timestamp;

        timeDiff = miliTime - nanoTime / 1000000;
        log.info("Synchornizing sensor clock. Current time= " + miliTime
                + ", difference between clocks = " + timeDiff);
    }

    float x = event.values[0];
    float y = event.values[1];
    float z = event.values[2];
    long ts = event.timestamp / 1000000 + timeDiff;

    //Do your stuff

    sampleCounter++;
} 
```

# objective-c - Mac OS X 10.4 上的 NSViewController

> ID：15647843
> 
> 赞同：4
> 
> 时间：2013-03-26T21:34:29.997
> 
> 标签：objective-c, macos, cocoa, memory-management, nib

我正在开发一个捆绑代码库——不是一个应用程序——开发从 10.4 开始，需要在 10.4 上运行，但一直到 10.8。它手动从 nib 文件加载其视图，我最近才意识到存在大量内存泄漏，因为 nib 利用绑定并绑定到文件的所有者，创建引用循环并阻止文件的所有者类解除分配。我认为让“文件的所有者”加载自己的 nib 会使情况变得更糟。

我使用以下代码加载笔尖（此代码在基类中，子类覆盖`+nibName`）：

```
NSString *nibName = [[self class] nibName];
NSNib *nib = [[NSNib alloc] initWithNibNamed:nibName bundle:myBundle];
[nib instantiateNibWithOwner:self topLevelObjects:&topLevelObjects]; 
```

由于我必须以 10.4 为目标，因此无法使用`NSViewController`. 我想我需要实现我自己的视图控制器类，但是如何防止引用循环像`NSViewController`类所承诺的那样发生呢？如果视图控制器是 nib 的“文件所有者”，我不是只是将引用周期从我当前的类推送到我的视图控制器吗？做什么`NSViewController`来防止这种情况发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T22:12:24.470

NSViewController 在内存管理甚至顶级对象方面都没有做任何特别的事情。它只是提供了一个安全的地方来加载一个 nib，然后在 Nib 的生命周期内将其内容保存在内存中，这意味着该类本身只不过是一个外部文件的所有者。只是为了好玩，我重新实现了这个类，并注释掉了有趣的部分。有些东西，我直接删除了，因为它太老套了，不值得实施，或者没有使用，不值得重新制作。完整的课程，包括文档和评论，可以在[这里](https://github.com/CodaFi/CFIViewController)找到；

```
@interface CFIViewController : NSResponder <NSCoding> {
@private
    NSString *_nibName;
    NSBundle *_nibBundle;
    id _representedObject;
    NSString *_title;
    IBOutlet NSView *view;
    NSArray *_topLevelObjects;
    id _autounbinder; 
    //NSString *_designNibBundleIdentifier;
}

- (id)initWithNibName:(NSString*)nibName bundle:(NSBundle *)nibBundleOrNil;

- (void)setRepresentedObject:(id)representedObject;
- (id)representedObject;

- (void)setTitle:(NSString *)title;
- (NSString *)title;

- (NSView *)view;
- (void)loadView;

- (NSString *)nibName;
- (NSBundle *)nibBundle;

- (void)setView:(NSView *)view;

@end

@implementation CFIViewController

- (void)loadView {
    NSArray *topLevelObjects = nil;

    NSNib *loadedNib = [[[NSNib alloc]initWithNibNamed:self.nibName bundle:self.nibBundle]autorelease];
    if (loadedNib == nil) {
        [NSException raise:NSInternalInconsistencyException format:@"-[%@ %@]", NSStringFromClass(self.class), NSStringFromSelector(_cmd)];
        return;
    }

    BOOL loaded = NO;

#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_8
    loaded = [loadedNib instantiateWithOwner:self topLevelObjects:&topLevelObjects];
#else 
    loaded = [loadedNib instantiateNibWithOwner:self topLevelObjects:&topLevelObjects];
#endif

    if (loaded) {
        [self _setTopLevelObjects:topLevelObjects];
        [topLevelObjects makeObjectsPerformSelector:@selector(release)];
    } else {
        [NSException raise:NSInternalInconsistencyException format:@"CFIViewController could not instantiate the %@ nib.", self.nibName];
    }

    if (self.view != nil) {
        [self viewDidLoad];
        return;
    }

    [NSException raise:NSInternalInconsistencyException format:@"-[%@ %@]", NSStringFromClass(self.class), NSStringFromSelector(_cmd)];
}

@end 
```

这确实是一个非常简单的机制。所有 NSViewController 真正添加到 Cocoa 中任何类型的控制器隐喻的是能够与 NSDocument 一起工作，并且它的底层核心数据非常混乱。

> 如果视图控制器是 nib 的“文件所有者”，我不是只是将引用周期从我当前的类推送到我的视图控制器吗？NSViewController 做了什么来防止这种情况发生？

NSViewController 以我见过的最有趣的方式之一处理顶级对象的保留。当它获得对包含它们的数组的引用时，它会制作数组的浅拷贝，然后`-release`是旧数组的所有对象。实际上，NSViewController 会从 NSCoder 中抢走对 NIB 解冻对象的每个引用，从而保证当数组在`-dealloc`.

然而，当涉及到绑定时，NSViewController 有一个名为 NSProxy 子类的内部 getter `NSAutounbinder`，KVO 在绑定和解除绑定对象时会查找它。通过调整 release 并为内部 autounbinder 指针提供 getter，控制器类可以毫不费力地释放自己及其绑定。绝对不建议您在未验证 KVO 是否仍在寻找 autounbinder getter 的情况下将 CFIViewController 中的实现用于未来的 OS X 版本，但对于大多数其他版本，它似乎没问题。CFIViewController 提供了在最新提交时使用内部 NSAutoUnbinder 类的选项，从而解决任何绑定保留周期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T09:22:49.060

我建议您只使用`NSWindowController`或自定义子类。您的子类可以有一个`view`插座和一个符合 KVO 的`representedObject`属性。对于 10.4 兼容的替代品，这应该足够了。

# maven - 通过 maven 插件注入依赖项

> ID：15647846
> 
> 赞同：0
> 
> 时间：2013-03-26T21:34:34.493
> 
> 标签：maven, maven-plugin

我有一个接受插件的系统，让用户可以向管理系统添加功能。该插件基本上只是一个具有某种格式的 zip 文件（即文件 x 在这个目录中，y 在那个目录中）。目前我使用 maven-assembly-plugin 插件来制作 zip。

问题是让我的所有插件保持同步并让其他人制作插件很尴尬，因为他们需要正确的 assembly.xml

因此，我一直在尝试制作自定义包装类型，以便开发人员可以制作这样的插件：

```
<groupId>com.example</groupId>
<artifactId>example</artifactId>
<version>1.0-SNAPSHOT</version>
<packaging>plugin</packaging> //not a standard type 
```

这主要是有效的，但现在丑陋的事情是每个插件总是依赖于核心系统中的某些 API。因此，它们基本上都具有相同的依赖关系。

**mojo 是否可以将依赖项注入 mojo 的用户？**这似乎说它不能： [http ://maven.40175.n5.nabble.com/How-to-inject-dependencies-from-a-mojo-td83025.html](http://maven.40175.n5.nabble.com/How-to-inject-dependencies-from-a-mojo-td83025.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-10T15:48:29.900

在评论中回答：

> 我遇到了一个非常明显和简单的解决方案。我制作了一个包含依赖项的“pom”项目，并要求开发人员将该 pom 作为依赖项包含在内。这很好地解决了我的问题，因为我可以将依赖项集中在一个地方，并且每个“插件”都可以根据需要传递到核心 api 依赖项。十分简单。– 2013 年 3 月 27 日 22:12

# json - 使用 jquery 解码 json 时的值未定义

> ID：15647850
> 
> 赞同：0
> 
> 时间：2013-03-26T21:34:44.493
> 
> 标签：json, jquery

我知道已经有很多与这个主题相关的问题，但我尝试了很多，但我仍然无法获得值。

我正在使用 firbug，我得到了正确的响应：-

```
[{"id":4,"comments":1,"likes":5,"books":3,"name":"steve"}] 
```

但我无法在页面上显示它们。当我尝试 alert(data.id) 时，我在警报框中未定义。这是我的代码：-

```
$.ajax({
                type: "GET",
                url: "getdata.php",
                data: dataString,
                dataType:"json",
                success: function(data){
                               alert(data.id);

                    }
                }); 
```

我试过了

```
$.each(data, function (key, element) {
                            alert(key); 
                            alert(element); 
                        }); 
```

这在警报框中显示键为 0，但元素为 [object Object]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T21:37:00.973

这是因为您的响应是一个数组。

要么做

```
success: function(data){
    alert(data[0].id);
} 
```

或者只返回一个对象

```
{"id":4,"comments":1,"likes":5,"books":3,"name":"steve"} 
```

或者如果您想保留一个数组，请`each`使用

```
$.each(data, function (key, element) {
    alert(key); 
    alert(element.id); 
    alert(element.comments); 
    alert(element.likes);
    ... 
}); 
```

# php - 使用 Php 使用 glob 和数组将文件夹中的 xml 文件上传到 Mysql

> ID：15647853
> 
> 赞同：1
> 
> 时间：2013-03-26T21:34:52.323
> 
> 标签：php, mysql, xml, xml-parsing

我的网络服务器上的一个文件夹中有几个 xml 文件。我想要

1.  在文件夹中查看
2.  获取xml文件名
3.  将文件名放入数组
4.  将这些名称循环到 mysql 查询中
5.  将所有 xml 文件的内容插入 db

```
 $files = glob('*.xml');

foreach($files 作为 $file){
    mysql_query("LOAD DATA INFILE '".$file."' INTO TABLE tablename ROWS IDENTIFIED BY ''");

}

```

我花了几天时间寻找示例或教程，但在网上找不到任何东西。

以上是我能想到的最好的。

任何帮助表示赞赏:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:34:40.240

您的代码没有任何问题，但要这样做；

1 - XML 文件必须位于 MySQL 的数据文件夹中。否则，你不能使用 LOAD DATA 的东西。

2 - PHP 脚本必须由 root 或 MySQL 服务器的同一用户启动。否则，脚本将无法访问和处理文件。

如果您在共享主机上尝试这样做，我可以说，由于有很多限制，您不能这样做。

# c++ - C++ 约定：this 指针

> ID：15647856
> 
> 赞同：-1
> 
> 时间：2013-03-26T21:35:03.933
> 
> 标签：c++

我很想知道，在 C++ 中使用 this-> 是否有约定？我通常喜欢使用 this-> 来强调方法和/或变量是包含类的成员，但从视觉上讲，它看起来确实很不吸引人。了解工业中常见的任何其他 C++ 编码约定也很棒，例如骆驼大小写与下划线等。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:37:38.787

> 我很想知道，在 C++ 中使用 this-> 是否有约定？

我个人尽可能避免使用 this-> 指针，但这只是个人喜好。

> 了解工业中常见的任何其他 C++ 编码约定也很棒，例如骆驼大小写与下划线等。

编码约定差异很大，但一个例子是谷歌的[综合 C++ 风格指南](https://google.github.io/styleguide/cppguide.html)。

*   "[文件名应该全部小写，并且可以包含下划线 (_) 或破折号 (-)。](https://google.github.io/styleguide/cppguide.html#File_Names) "
*   "[变量名都是小写的，单词之间有下划线。类成员变量后面有下划线。](https://google.github.io/styleguide/cppguide.html#Variable_Names) "
*   "[常规函数大小写混合；访问器和修改器匹配变量名](https://google.github.io/styleguide/cppguide.html#Function_Names)"

还有，我最喜欢的：

*   “[你不会真的要定义一个宏，是吗？如果你这样做，它们就像这样：MY_MACRO_THAT_SCARES_SMALL_CHILDREN。](https://google.github.io/styleguide/cppguide.html#Macro_Names) ”

# java - 服务器和方法中的线程

> ID：15647858
> 
> 赞同：0
> 
> 时间：2013-03-26T21:35:04.567
> 
> 标签：java

我必须制作一个服务器，它从客户端编号作为输入并将其输出到文本文件中。我收到以下错误。
错误是：

> 在 java.io.BufferedReader.ensureOpen(Unknown Source)
> java.io.BufferedReader.read(Unknown Source)
> Server_thread.writeTxt(Server_thread.java:72)
> Server_thread.run(Server_thread.java:49)
> java.lang.Thread.run （来源不明）

和代码

```
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.OutputStreamWriter;
import java.net.Socket;
import java.util.Scanner;

public class Server_thread implements Runnable{
     private Socket socket;
     private BufferedReader  instream=null;
     private BufferedWriter outstream=null;
     private FileWriter file=null;
     private Scanner scanner=null;
     private int number=0;
     private String strin;
        public Server_thread(Socket socket) {
            this.socket = socket;

            Thread t = new Thread(this);
            t.start();
        }

        public void run() {

            try {
                file = new FileWriter("C://Users//Vagos//Desktop//file.txt");

            try
            {
                instream = new BufferedReader (new InputStreamReader (socket.getInputStream()));
                outstream = new BufferedWriter(new OutputStreamWriter(socket.getOutputStream()));

                scanner = new Scanner(new File("file.txt"));

                //strin = instream.readLine();

                if ((instream.readLine()).equals("Insert")){ //following the protocol

     writeTxt(); <--heare
            }else if((instream.readLine()).equals("Read") ){
                readTxt();
            }
                instream.close();
                outstream.close();
                file.close();
                socket.close();

          System.out.println("Waiting for client message...");
        } catch (IOException e) {
            e.printStackTrace();
        }
        } catch (IOException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        }
    }

    private synchronized void writeTxt() throws IOException{

        do{

        number = instream.read(); <--heare 
        file.write(new Integer(number).toString());
        file.write("   ");
        file.flush();
        }while(number!=100); //bye = terminate the conversation
    }

    private void readTxt() throws IOException{

         while(scanner.hasNextInt()){
               outstream.write(scanner.nextInt());
               outstream.flush();
            }
    }

} 
```

# c# - 使用 linq 从链接到另一个表的表中获取单个记录

> ID：15647860
> 
> 赞同：2
> 
> 时间：2013-03-26T21:35:15.910
> 
> 标签：c#, linq

这个问题令人困惑，因为我真的不知道如何问这个问题。

无论如何，我有 4 个表，我需要访问 TokenSetting 表来获取一条记录。我得到了公司代码，我必须从那里旅行并获取我需要的其余信息。而且因为每个公司都有多个公司结构，所以我必须首先获得公司结构才能获得分配给它的代币。

这是布局：

![在此处输入图像描述](../Images/f2a1012e644794bdf3ce03c05ec11d73.png)

这是我的代码：

```
 _currentcorp = (from c in _entities.Corporations
              where c.CompanyCode == textBox_CompanyCode.Text
              select c).FirstOrDefault();

  if (_currentcorp == null)
  {
    errorProvider1.SetError(textBox_CompanyCode, "Invalid corporation.");
    return;
  }

  var corpstructure = (from cs in _currentcorp.CorporationStructures
                          where cs.District == null &&
                                cs.Branch == null &&
                                cs.Region == null
                          select cs).FirstOrDefault();

  if (corpstructure == null)
  {
    errorProvider1.SetError(textBox_CompanyCode, "Invalid corporation structure.");
    return;
  }

  var tokensetting = (from ts in _currentcorp.Tokens
                      where ts.CorporationStructureId == corpstructure.CorporationStructureId                           
                      select ts.TokenSettings).FirstOrDefault(); 
```

即使我告诉它获取第一个或默认值，令牌设置也会以可枚举的形式返回。我假设它是说在令牌上获得第一或默认值？

无论如何，即使表是一对多，tokensetting 表中也应该只有 1 条记录。如何仅在此表上返回第一个或默认值？

**==== 答案 ====**

按照建议，我做了以下事情：

```
 var tokensetting = (from ts in _currentcorp.Tokens
                      where ts.CorporationStructureId == corpstructure.CorporationStructureId                           
                      select ts.TokenSettings.FirstOrDefault()).FirstOrDefault(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T21:47:39.350

我相信 LINQ 查询返回 a `IEnumerable`of `IEnumerables`，所以一秒钟`.FirstOrDefault()`就可以得到你想要的。

第一个调用指定您想要 LINQ 查询结果中的第一行，第二个调用指定您想要 的第一个元素`ts.TokenSettings`，它本身就是一个集合。

# asp.net-mvc - 如何将 where 子句添加到不属于 LINQ 查询的返回集的字段

> ID：15647863
> 
> 赞同：0
> 
> 时间：2013-03-26T21:35:31.153
> 
> 标签：asp.net-mvc, linq

我想知道如何在我的 linq 查询中添加一个动态 where 子句，其中我正在过滤的字段不是返回集的一部分。

询问：

```
(from p in db.Person
join c in db.Client on p.PersonId equals c.PersonId into c_join
from c in c_join.DefaultIfEmpty()
join pt in db.PersonType on p.PersonTypeId equals pt.PersonTypeId into pt_join
from pt in pt_join.DefaultIfEmpty()
join pl in db.Plan on c.ClientId equals pl.ClientId into pl_join
from pl in pl_join.DefaultIfEmpty()
join plt in db.PlanType on pl.PlanTypeId equals plt.PlanTypeId into plt_join
from plt in plt_join.DefaultIfEmpty()
orderby pt.PersonTypeDescription ascending , p.LastName ascending
select new ExtendedPersonSearch
{
PersonId = p.PersonId,
FirstName = p.FirstName,
LastName = p.LastName,
MiddleName = p.MiddleName,
Aka = p.Aka,
Sin = p.Sin,
PersonTypeId = pt.PersonTypeId,
PersonTypeDescription = pt.PersonTypeDescription,
ClientId = (Int32?) c.ClientId
}).Distinct(); 
```

相关课程：

```
 public class ExtendedPersonSearch
    {
        public int PersonId { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public string MiddleName { get; set; }
        public string Aka { get; set; }
        public string Sin { get; set; }
        public int PersonTypeId { get; set; }
        public string PersonTypeDescription { get; set; }
        public int? AddressId { get; set; }
        public string Street1 { get; set; }
        public int? ClientId { get; set; } 
```

但是，我想对不属于 ExtendedPersonSearch 类的 pl.PlanId 进行过滤。

这些其他类型的动态 where 子句适用于返回集中的项目：

```
 if (fd.Contains("txtSearchFirstName"))
                {
                    var searchFirstName = form[fd];
                    ViewData["searchFirstName"] = searchFirstName;

                    if (searchFirstName != "")
                        qryAllPerson = qryAllPerson.Where(sp => sp.FirstName.Contains(searchFirstName));

                } 
```

没有根据用户是否输入计划 ID 来再次编写查询以获取此查询：

```
qryAllPerson = (from p in db.Person
join c in db.Client on p.PersonId equals c.PersonId into c_join
from c in c_join.DefaultIfEmpty()
join pt in db.PersonType on p.PersonTypeId equals pt.PersonTypeId into pt_join
from pt in pt_join.DefaultIfEmpty()
join pl in db.Plan on c.ClientId equals pl.ClientId into pl_join
from pl in pl_join.DefaultIfEmpty()
join plt in db.PlanType on pl.PlanTypeId equals plt.PlanTypeId into plt_join
from plt in plt_join.DefaultIfEmpty()
orderby pt.PersonTypeDescription ascending, p.LastName ascending
where pl.PlanId == searchPlanId
select new ExtendedPersonSearch
{
PersonId = p.PersonId,
FirstName = p.FirstName,
LastName = p.LastName,
MiddleName = p.MiddleName,
Aka = p.Aka,
Sin = p.Sin,
PersonTypeId = pt.PersonTypeId,
PersonTypeDescription = pt.PersonTypeDescription,
ClientId = (Int32?)c.ClientId
}).Distinct(); 
```

有没有一种方法可以让我只添加 PlanId 的 where 子句，而不必再次输入整个查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:41:20.077

其他动态搜索之所以有效，是因为它们是扩展搜索类的属性。

当您运行查询时，您将返回一个可枚举的 ExtendedPersonSearch 对象。一旦你得到这个，你只能按该对象上存在的属性进行过滤。

就像在现实生活中一样，您无法根据宠物拥有的 CPU 内核数量来过滤宠物（这根本没有意义。）

如果您想要一个查询，您可以修改该行

```
where pl.PlanId == searchPlanId 
```

成为

```
where (searchPlanId == null || pl.PlanId == searchPlanId) 
```

这样，如果没有输入搜索计划，条件的第一部分就会被命中，它会短路并返回所有记录。如果输入了搜索计划 ID，则第一个子句为 false，因此 C# 将转到第二个子句并确保 pl.PlanId 确实等于输入的 searchPlanId。

或者，您可以将 PlanId 添加到 ExtendedPersonSearch 对象并在从数据源检索后对其进行过滤。但这可能不是最好的主意，因为一旦您过滤掉与计划 ID 不匹配的结果，您将撤回大量数据而丢弃大部分数据。

# hadoop - Pig中的双冒号到底是什么意思？

> ID：15647867
> 
> 赞同：4
> 
> 时间：2013-03-26T21:35:51.247
> 
> 标签：hadoop, apache-pig

当我使用时，`DESCRIBE`我在 Pig 输出中看到很多双冒号，它们的含义并不明显。

例如，在分组和展平之后，我看到如下内容：

`key::observerId:chararray,key::endpoint:chararray,...`

在某些时候，我按observerId 和endpoint 分组，将组元组重命名为“key”，然后重新展平。那么，双冒号究竟是什么意思，我应该如何引用第一个关系（key？observerId？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T00:06:47.660

在您的问题中**::**是消歧运算符，它用于在 JOIN、COGROUP、CROSS 或 FLATTEN 运算符之后识别字段名称。[您可以在此处](http://pig.apache.org/docs/r0.10.0/basic.html)找到使用消歧运算符的示例。

在您的情况下，您有两个字段observerID 和端点，它们都由键别名标识，这意味着observerID 和端点都在同一个别名中被引用，而其他“observerID 和端点”可能被其他“键”别名引用。

我认为您使用了以下内容：

```
key      = some_statement_with_observerID_and_endpoint
otherkey = some_statement_with_observerID_and_endpoint 
```

基于此，您将看到如下所示的内容：

```
key::observerId:chararray,key::endpoint:chararray,... 
```

上面这句话意味着您看到的observerID 和endpoint 是key 别名的一部分，而不是otherkey 别名。

# multithreading - Windows 7 中的线程是如何实现的？

> ID：15647868
> 
> 赞同：1
> 
> 时间：2013-03-26T19:49:41.480
> 
> 标签：multithreading, windows-7, concurrency, synchronization

微软介绍，Window 7 改进了线程子系统，引入了 Hybrid（N:M 用户空间/内核空间线程映射）。

有人知道线程实现的细节吗？虽然有很多材料（显然是 Linux NPTL 实现的开源）和一些关于 Mac OS 线程实现的信息，但我找不到任何关于 Windows 7 线程实现细节的信息。

我特别感兴趣的是：

*   同步原语实现（如 Linux 中的 futexes）
*   线程队列策略
*   线程数据结构
*   线程本地存储实现
*   内存分配和释放
*   ...我忘记提及的其他线程相关功能

将不胜感激任何提供的信息和/或链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T23:35:34.550

在 Windows 7 中没有什么大的改变，只是在“线程映射”（又名线程亲和性）方面做了一个小的改进。调度程序提高了线程在特定核心上保持调度并且不会从一个核心跳转到另一个核心的几率。这有利于功耗、减少缓存抖动并支持 Intel Nehalem 和 AMD Phenom II，这些架构支持每核低功耗状态。没有软件考虑适用，我无论如何都能想到。

# sql - Oracle SQL 组消息间隔

> ID：15647869
> 
> 赞同：2
> 
> 时间：2013-03-26T21:35:55.657
> 
> 标签：sql, oracle, group-by

我有一个如下所示的 Oracle 11.2 表。

```
MSG_ID JOB_ID STATUS   CREATION_DATE
1      101    SUB      03/30/2011 14:39:52
2      101    SUB      03/30/2011 14:44:37
3      101    RCVD     03/31/2011 14:41:49
4      101    ACCPTD   03/31/2011 14:59:51
5      101    DESIGN   03/31/2011 17:44:37
6      101    REVIEW   03/31/2011 17:44:50
7      101    (null)   04/01/2011 07:51:41
8      101    REJECTED 04/01/2011 07:56:56
9      101    (null)   04/01/2011 16:36:19
10     101    REVIEW   04/01/2011 16:43:49
11     101    APPROVED 04/04/2011 07:55:45
12     101    (null)   04/04/2011 08:14:23
13     101    REJECTED 04/04/2011 14:46:17
14     101    REVIEW   04/04/2011 14:50:50
15     101    (null)   04/04/2011 14:51:27
16     101    REVIEW   04/04/2011 14:57:50
17     101    (null)   04/04/2011 15:34:50
18     101    APPROVED 04/04/2011 15:41:21
19     101    (null)   04/04/2011 15:41:23
20     101    REJECTED 04/04/2011 15:41:24
21     101    REVIEW   04/04/2011 16:07:52
22     101    (null)   04/05/2011 08:50:35
23     101    APPROVED 04/05/2011 10:54:51
24     101    PROD     04/05/2011 11:08:50
25     101    COMPLET  04/06/2011 20:09:49 
```

我正在尝试对相邻（相对于创建日期）消息状态和每个唯一状态组合之间的时间间隔进行分组。可以忽略空状态。结果如下所示。

```
JOB_ID FROM_STATUS TO_STATUS TIME_INTERVAL
101    SUB         RCVD      sum of time intervals
101    RCVD        ACCPTD    sum of time intervals
101    ACCPTD      DESIGN    sum of time intervals
101    DESIGN      REVIEW    sum of time intervals
101    REVIEW      REJECTED  sum of time intervals
101    REJECTED    REVIEW    sum of time intervals
101    REVIEW      APPROVED  sum of time intervals
101    APPROVED    REJECTED  sum of time intervals
101    APPROVED    PROD      sum of time intervals
101    PROD        COMPLETE  sum of time intervals 
```

有人可以帮助执行此操作所需的 SQL。

先感谢您

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T22:45:43.430

这是间隙和孤岛问题的变体。第一步是识别连续组，您可以这样[做](https://stackoverflow.com/a/4324654/266304)：

```
select msg_id, job_id, status, creation_date,
    row_number() over (partition by job_id order by creation_date)
        - row_number() over (partition by job_id, status
            order by creation_date) as chain
from t42
where status is not null 
```

...它为每个具有相同`job_id`和`status`值的块提供一个唯一的“链”号。然后，您可以折叠它们以获得每个“链”的单行，因为您似乎只`creation_date`对每个连续状态块的最早感兴趣（我认为）。

然后你可以用它`lead`来查看下一个块并计算出时差，最后——如果我理解了你的最终“总和”要求——对间隔进行分组。

总而言之：

```
select job_id, from_status, to_status, sum(time_interval) as time_interval
from (
    select job_id, status as from_status, status_start,
        lead(status) over (partition by job_id order by status_start)
            as to_status,
        lead(status_start) over (partition by job_id order by status_start)
            - status_start as time_interval
    from (
        select distinct job_id, status, chain,
            min(creation_date) over (partition by job_id, status, chain
                order by chain) as status_start
        from (
            select msg_id, job_id, status, creation_date,
                row_number() over (partition by job_id order by creation_date)
                    - row_number() over (partition by job_id, status
                        order by creation_date) as chain
            from t42
            where status is not null
        )
    )
)
where to_status is not null
group by job_id, from_status, to_status
order by job_id, min(status_start); 
```

与您一起提供的数据：

```
 JOB_ID FROM_STA TO_STATU TIME_INTERVAL
---------- -------- -------- -------------
       101 SUB      RCVD        1.00135417
       101 RCVD     ACCPTD      .012523148
       101 ACCPTD   DESIGN      .114421296
       101 DESIGN   REVIEW      .000150463
       101 REVIEW   REJECTED    .591736111
       101 REJECTED REVIEW      .387430556
       101 REVIEW   APPROVED    3.45099537
       101 APPROVED REJECTED    .285127315
       101 APPROVED PROD        .009710648
       101 PROD     COMPLET     1.37568287

10 rows selected. 
```

这`time_interval`是几天之内，但你可以随心所欲地操纵它；既然你提到了间隔，你可以使用 Oracle 间隔：

```
select job_id, from_status, to_status,
    numtodsinterval(sum(time_interval) , 'DAY') as time_interval
from (
...

    JOB_ID FROM_STA TO_STATU TIME_INTERVAL
---------- -------- -------- -----------------------------
       101 SUB      RCVD     +000000001 00:01:57.000000000
       101 RCVD     ACCPTD   +000000000 00:18:02.000000000
       101 ACCPTD   DESIGN   +000000000 02:44:46.000000000
       101 DESIGN   REVIEW   +000000000 00:00:13.000000000
       101 REVIEW   REJECTED +000000000 14:12:06.000000000
       101 REJECTED REVIEW   +000000000 09:17:54.000000000
       101 REVIEW   APPROVED +000000003 10:49:26.000000000
       101 APPROVED REJECTED +000000000 06:50:35.000000000
       101 APPROVED PROD     +000000000 00:13:59.000000000
       101 PROD     COMPLET  +000000001 09:00:59.000000000

10 rows selected. 
```

# opengl - 在 Raspberry Pi 上运行 Open GL 程序？

> ID：15647873
> 
> 赞同：3
> 
> 时间：2013-03-26T21:36:02.747
> 
> 标签：opengl, sfml, raspberry-pi, raspbian, mesa

树莓派可以运行 OpenGL 程序吗？像 GL 1.x 程序，而不是我知道它可以运行的 OpenGL ES 2.x。

我问的原因是，我无法启动 SFML 2。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-27T05:50:37.620

您可以运行[Mesa 软件光栅器](http://www.mesa3d.org/)来获得桌面 OpenGL 支持。

不过会很慢。真的，*真的很*慢。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T01:43:53.403

没有人为任何版本的桌面 OpenGL 为 Raspberry Pi 硬件创建桌面 OpenGL 实现。有软件实现，但在 PR 相对微薄的 CPU 上使用有限。

# cocoa - NSTextView 的自定义插入点

> ID：15647874
> 
> 赞同：8
> 
> 时间：2013-03-26T21:36:09.140
> 
> 标签：cocoa, customization, nstextview, caret

我正在通过覆盖更改插入点大小`-(void)drawInsertionPointInRect:(NSRect)aRect color:(NSColor *)aColor turnedOn:(BOOL)flag`，但它不处理第一次闪烁（当您移动插入点时，它会恢复正常）

我设法通过覆盖私有方法来处理第一次眨眼`- (void)_drawInsertionPointInRect:(NSRect)aRect color:(NSColor *)aColor`。

但这对我来说不是解决方案，因为覆盖私有方法将导致被 App Store 拒绝。我希望该应用程序出现在 App Store 中。我看到像 iAWriter 和 Writeroom 这样的应用程序有一个自定义插入点，它们在 App Store 中。

有谁知道他们是如何做到这一点的，或者是一种更好的方法而不是覆盖私有方法？

谢谢。

```
- (void)_drawInsertionPointInRect:(NSRect)aRect color:(NSColor *)aColor
{
    aRect.size.width = 3.0;
    [aColor set];
    [NSBezierPath fillRect:aRect];
}

- (void)drawInsertionPointInRect:(NSRect)aRect color:(NSColor *)aColor turnedOn:(BOOL)flag
{
    if(flag) {
        aRect.size.width = 3.0;
        [aColor set];
        [NSBezierPath fillRect:aRect];
    }
    else {
        [self setNeedsDisplayInRect:[self visibleRect] avoidAdditionalLayout:NO];
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-07-18T11:12:25.247

问题是调用 drawInsertionPointInRect 时生效的剪切路径。

```
- (void)drawInsertionPointInRect:(NSRect)rect color:(NSColor *)color turnedOn:(BOOL)flag {
    rect.size.width = 8.0;
    NSBezierPath * path = [NSBezierPath bezierPathWithRect:rect];
    [path setClip]; // recklessly set the clipping area (testing only!)
    [path fill];
} 
```

请注意，上面的代码会留下工件（在我的测试中 drawInsertionPointInRect 没有被调用来清除插入点，只是为了绘制它）。使用 setDrawsBackground:YES 以快速而肮脏的方式清除工件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-14T22:08:59.567

我不做应用商店，但我想知道这个“棘手的”小黑客是否会让一个无证电话在苹果的雷达下飞翔。基本上，您有一个无害命名的方法，该方法实现了被覆盖的未记录调用所做的工作。然后，您使用 Obj-C 运行时将您的实现交换为未记录的实现。您对 SEL 进行 ROT-13，以便文本分析不会在任何地方看到未记录的方法名称。我不知道Apple是否会抓住这个！

不知道这是否有帮助，但我认为这会很有趣。

（我知道在 Obj-C 中执行 ROT-13 的方法比我下面的一次性实现要快得多、更聪明。）

```
@implementation MyTextView
-(void)nothingToSeeHere:(NSRect)aRect
       heyLookAtThat:(NSColor*)aColor
{
  aRect.size.width = 3.0;
  [aColor set];
  [NSBezierPath fillRect:aRect];
}

#define dipirRot @"_qenjVafregvbaCbvagVaErpg:pbybe:"
#define ntshRot @"abguvatGbFrrUrer:urlYbbxNgGung:"
+(void)initialize
{
  if (self == [MyTextView class])
  {
    SEL dipir = NSSelectorFromString([NSString rot13:dipirRot]);
    SEL ntsh = NSSelectorFromString([NSString rot13:ntshRot]);
    Method dipirMethod = class_getInstanceMethod([self class], dipir);
    Method ntshMethod = class_getInstanceMethod([self class], ntsh);
    IMP ntshIMP = method_getImplementation(ntshMethod);
    (void)method_setImplementation(dipirMethod, ntshIMP);
  }
}

@implementation NSString (Sneaky)
+(NSString*)rot13:(NSString*)s
{
  NSMutableString* ms = [[NSMutableString alloc] init];
  unsigned len = [s length];
  unsigned i;
  for (i = 0; i < len; i++)
  {
    unichar c = [s characterAtIndex:i];
    if (c <= 122 && c >= 97) c += (c + 13 > 122)? -13:13;
    else if(c <= 90 && c >= 65) c += (c + 13 > 90)? -13:13;
    [ms appendFormat:@"%C", c];
  }
  NSString* ret = [NSString stringWithString:ms];
  [ms release];
  return ret;
}
@end 
```

# c# - 从窗口获取唯一标识

> ID：15647886
> 
> 赞同：0
> 
> 时间：2013-03-26T21:36:44.440
> 
> 标签：c#, c++, windows

使用 C++ 或 C# 除了计算机名和 ip，我还能从 Windows 获得什么标识？我需要尽可能多的唯一标识 - 最重要的是：序列号、制造商、型号、Windows 许可证是否可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:39:15.110

您可以从 WMI 获取序列号、资产标签、UUID、MAC 地址和无数其他识别信息。

[WMI 表](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394084%28v=vs.85%29.aspx)

ComputerSystem 表是有用的，Win32_BIOS 表也是如此。还有一个操作系统表。

# jquery - ko foreach 不工作

> ID：15647894
> 
> 赞同：0
> 
> 时间：2013-03-26T21:37:03.830
> 
> 标签：jquery, jquery-mobile, knockout-2.0

我已经查看了我发现的所有相关文章，其他人似乎能够让这个简单的代码工作

我正在使用 jquery-1.9.1、jquery-mobile-1.3.0 和 knockout-2.2.1。我提供这个是因为我已经意识到很多时候这些库可能是不兼容的。我还没有找到一个很好的资源来说明哪些库应该一起使用。

我的问题是我可以使用模板绑定一个可观察的数组，但不能让淘汰赛无容器 foreach 工作。

这有效：

```
<ul data-role="listview" data-insert="true" data-bind="template: { name: 'OfficeTemplate', foreach: CampaignTeams, as: 'Team' }"></ul>
<script type="text/html" id="OfficeTemplate">
    <li>
        <span data-bind="text: TeamName"></span>
    </li>
</script> 
```

这不起作用：

```
<ul>
    <!-- ko foreach: CampaignTeams-->
    <li>
        <h1>
            <span data-bind="text: TeamName"></span>
        </h1>
    </li>
    <!-- /ko -->
</ul> 
```

这将变得更加复杂，我打算使用嵌套模板，更喜欢干净的内联绑定。

我注意到调试的是 ko.applyBindings(vm) 在使用无容器语法时失败。

查看型号：

```
var vm = {
    // data
    CampaignTeams: ko.observableArray(null)
};

    // Get Office Summary
    $.ajax({
        type: "GET"
            , url: "/api/SalesTeamData/GetOfficeSummary/?Campaign=" + Campaign
            , datatype: "json"
            , data: ""
            , success: function (data) {
                vm.CampaignTeams = ko.observableArray(data);
                ko.applyBindings(vm);
                $('li[data-role=collapsible]').collapsible({ theme: 'c', refresh: true });
            }
            , error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert("Error: " + errorThrown);
            }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T17:17:50.480

```
 var vm = {
    // data
    CampaignTeams: ko.observableArray([])
 };

ko.applyBindings(vm);
// Get Office Summary
$.ajax({
    type: "GET"
        , url: "/api/SalesTeamData/GetOfficeSummary/?Campaign=" + Campaign
        , datatype: "json"
        , data: ""
        , success: function (data) {
            vm.CampaignTeams(data);
            $('li[data-role=collapsible]').collapsible({ theme: 'c', refresh: true });
        }
        , error: function (XMLHttpRequest, textStatus, errorThrown) {
            alert("Error: " + errorThrown);
        }
}); 
```

# soap - 未在 WSDL 文件中定义

> ID：15647900
> 
> 赞同：0
> 
> 时间：2013-03-26T21:37:30.877
> 
> 标签：soap, wsdl

我给出以下 WSDL 注销请求..

```
<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><Logout xmlns="http://tempuri.org/wsdl/"><vsSecurityKey>0</vsSecurityKey></Logout></soap:Body></soap:Envelope> 
```

我得到以下回复：

> 故障代码：SOAP-ENV：服务器
> 
> faultstring：WSDLReader：在带有soapAction [http://tempuri.org/wsdl/Logout](http://tempuri.org/wsdl/Logout)的Soap 消息中请求的操作未在WSDL 文件中定义。这可能是因为它位于错误的命名空间或大小写错误

我不确定这里的命名空间是什么错误。有什么想法吗..

以下是 WSDL 文件（我已经采取了与注销相关的部分）

```
 <?xml version="1.0" encoding="UTF-8"?>
<!-- Generated 04/04/06 by Microsoft SOAP Toolkit WSDL File Generator, Version 1.02.813.0 -->
<definitions name="nsi_soap" targetNamespace="http://tempuri.org/wsdl/" xmlns:wsdlns="http://tempuri.org/wsdl/" xmlns:typens="http://tempuri.org/type" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:stk="http://schemas.microsoft.com/soap-toolkit/wsdl-extension" xmlns="http://schemas.xmlsoap.org/wsdl/"> 
  <types>
    <schema targetNamespace="http://tempuri.org/type" xmlns="http://www.w3.org/2001/XMLSchema" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" elementFormDefault="qualified">
    </schema>
  </types>
  <message name="SOAP_2.Logout">
    <part name="vsSecurityKey" type="xsd:string"/>
  </message>
  <message name="SOAP_2.LogoutResponse">
  </message>
  <message name="SOAP_2.Login">
    <part name="vsUserId" type="xsd:string"/>
    <part name="vsPassword" type="xsd:string"/>
    <part name="vlOrgId" type="xsd:int"/>
  </message>
  <message name="SOAP_2.LoginResponse">
    <part name="Result" type="xsd:string"/>
  </message>
  <portType name="SOAP_2SoapPort">
    <operation name="CreateMergeRequest" parameterOrder="vsSecurityKey vsNSN0 vsNSN1 vsNSN2 vsNSN3 vsNSN4 vsNSN5 vsNSN6 vsNSN7 vsNSN8 vsNSN9 vsUser">
      <input message="wsdlns:SOAP_2.CreateMergeRequest"/>
      <output message="wsdlns:SOAP_2.CreateMergeRequestResponse"/>
    </operation>
    <operation name="Update" parameterOrder="vsSessionKey vsNSN vsSurname vsForename1 vsForename2 vsForename3 vsDOB vsPreferredName vsNameDOBVerification vsResidentialStatus vsResidentialVerification vsGender vsUser vsAltSurname vsAltForename1 vsAltForename2 vsAltForename3 vsAltPreferredName vsAltNameDobVerification">
      <input message="wsdlns:SOAP_2.Update"/>
      <output message="wsdlns:SOAP_2.UpdateResponse"/>
    </operation>
    <operation name="Insert" parameterOrder="vsSecurityKey vsSurname vsForename1 vsForename2 vsForename3 vsDOB vsPreferredName vsNameDOBVerification vsResidentialStatus vsResidentialStatusVerification vsGender vsAlias_lastname vsAlias_forename1 vsAlias_forename2 vsAlias_forename3 vsAlias_prefered vsAlias_NameDOBVerification vsOverride vsUser">
      <input message="wsdlns:SOAP_2.Insert"/>
      <output message="wsdlns:SOAP_2.InsertResponse"/>
    </operation>
    <operation name="Search" parameterOrder="vsSecurityKey vsNSN vsName vsDOB vsGender vsResidentialStatus vsUser">
      <input message="wsdlns:SOAP_2.Search"/>
      <output message="wsdlns:SOAP_2.SearchResponse"/>
    </operation>
    <operation name="Logout" parameterOrder="vsSecurityKey">
      <input message="wsdlns:SOAP_2.Logout"/>
      <output message="wsdlns:SOAP_2.LogoutResponse"/>
    </operation>
    <operation name="Login" parameterOrder="vsUserId vsPassword vlOrgId">
      <input message="wsdlns:SOAP_2.Login"/>
      <output message="wsdlns:SOAP_2.LoginResponse"/>
    </operation>
  </portType>
  <binding name="SOAP_2SoapBinding" type="wsdlns:SOAP_2SoapPort">
    <stk:binding preferredEncoding="UTF-8"/>
    <soap:binding style="rpc" transport="http://schemas.xmlsoap.org/soap/http"/>
    <operation name="Logout">
      <soap:operation soapAction="http://tempuri.org/action/SOAP_2.Logout"/>
      <input>
        <soap:body use="encoded" namespace="http://tempuri.org/message/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </input>
      <output>
        <soap:body use="encoded" namespace="http://tempuri.org/message/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </output>
    </operation>
    <operation name="Login">
      <soap:operation soapAction="http://tempuri.org/action/SOAP_2.Login"/>
      <input>
        <soap:body use="encoded" namespace="http://tempuri.org/message/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </input>
      <output>
        <soap:body use="encoded" namespace="http://tempuri.org/message/" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
      </output>
    </operation>
  </binding>
  <service name="nsi_soap">
    <port name="SOAP_2SoapPort" binding="wsdlns:SOAP_2SoapBinding">
      <soap:address location="https://nsicompl.nsi.govt.nz/interface/nsi_soap.wsdl"/>
    </port>
  </service>
</definitions> 
```

# c# - C#如何阻止动画gif不断循环

> ID：15647901
> 
> 赞同：6
> 
> 时间：2013-03-26T21:37:35.157
> 
> 标签：c#, winforms, animated-gif

当我的应用程序使用互联网时，我有一个事件被调用。该事件更改了一个由 7 帧组成的动画 gif。我如何让它只在帧中循环一次？

```
 private void trafficSendingActive(object sender, trafficEventArgs e)
        {
            txImage.Image = Properties.Resources.blip;
        } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-26T21:45:54.967

`GIF`进度事件完成后，您可以从该图像（非动画）中提取单帧，

```
txImage.Image = Image.FormFile("non-animated-frame-from-gif.jpg"); 
```

您可以使用此网站从 gif 中提取帧：http: [//gif-explode.com/](http://gif-explode.com/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-06-09T11:48:02.743

您总是可以将图像/gif 封装在 Picturebox 中，当您希望 gif 停止时，只需将 Picturebox 的 Enabled 属性设置为 false。

只是一个想法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-26T22:01:26.330

您可以使用`System.Drawing.ImageAnimator`开始/停止 gif 动画

```
// start
System.Drawing.ImageAnimator.Animate(txImage.Image, OnFrameChanged);

// stop
System.Drawing.ImageAnimator.StopAnimate(txImage.Image, OnFrameChanged);

private void OnFrameChanged(object sender, EventArgs e)
{
   // frame change
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-06-12T13:11:27.053

`pictureBox.Enabled = false;`如果你想停止 GIF`pictureBox.Enabled = true;`并且当你希望它运行 GIF 时，你可以使用。

# mysql - MySQL 数据库跨位置同步

> ID：15647906
> 
> 赞同：2
> 
> 时间：2013-03-26T21:37:43.990
> 
> 标签：mysql, database, web-applications, replication, sync

我有一个使用 MySQL 存储数据的网络应用程序。Web 应用程序是内部的（不能通过 Internet 获得）。

我现在必须在 3 个（可能更多）位置（分支机构）部署此应用程序。他们需要能够同步数据（在一个位置创建的条目在其他分支位置可用）。

要求

*   Web 应用程序的本地实例 + mysql 数据库
*   每个位置在本地读写/在自己的网络上
*   数据库每天同步一次（可能通过脚本通过 SSH），以便每个位置都有相同的数据。

我能够解决这个问题的唯一方法（到目前为止）是创建 UUID（唯一标识符）并使用源位（用于原始位置）和同步位（new=0，synced=1）对每一行进行编码然后编写一个脚本，在其中我每晚通过 SSH 连接到每个位置，并将 = my source 和 synced=0 的行添加到每个位置...我意识到这很粗鲁，而且不是很优雅/可靠，但我不知道还能做什么。

客户担心如果互联网连接失败，他希望应用程序能够在本地运行，但仍然在其他分支之间保持同步（通过夜间脚本或其他方式）。正如我所说，已经有 3 个地点，今年晚些时候可能还会有更多。

任何有关架构的建议将不胜感激。

PS。由于安全问题，我没有将数据库连接到互联网。但我愿意接受所有建议。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T22:02:56.257

通过这样的架构决策，您的客户可能会在额外的硬件、开发和维护成本上花费大量金钱。除非他们有关键任务数据输入需求，否则在所有分支机构位置复制硬件堆栈可能有点疯狂。

话虽如此，他们仍然需要在开放的互联网上移动数据以将数据从服务器复制到服务器，除非他们当然有自己的 VPN，您将在其中进行设置。尝试进行一些日常流程来迁移/合并数据应该是您心中的一个危险信号，并且完全不是初学者。这是一个非常复杂的问题。您可能需要的是某种主-主数据库复制集群。幸运的是，MySQL 为您提供了执行此操作的能力。不幸的是，设置和正确设置可能很复杂，如果您不得不在这里提出这个问题，这对您来说可能有点挑战。

就数据库安全而言，只要您采取适当的预防措施来保护服务器，您就不必担心将 MySQL 数据库托管在 Internet 上。这可能会从网络级别开始，只允许访问端口 3306（和 22 用于 SSH 访问）并且只允许访问 Web 应用程序服务器的 IP 地址。这还包括将 MySQL 用户帐户设置为仅接受来自您将要访问的特定已知主机的流量。

# .net - 将数据从 .NET 应用程序发送到 Rails 应用程序

> ID：15647908
> 
> 赞同：0
> 
> 时间：2013-03-26T21:37:57.103
> 
> 标签：.net, ruby-on-rails, database, listener

如何将数据从 Windows .NET 应用程序发送到 Rails 应用程序？.NET 应用程序不断地从一些工作站收集数据，并且需要定期将数据发送到数据库。我想让 Rails 应用程序对发送的 .NET 应用程序进行身份验证，并在将接收数据存储到 SQLite 数据库之前对其进行解析。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:40:32.537

在 Rails 中创建一个[Web 服务并使用 .NET 调用它。](http://www.webopedia.com/TERM/W/Web_Services.html)

在上一个问题中有关在 Rails 中创建 Web 服务的信息：[如何创建 Web 服务](https://stackoverflow.com/questions/4993900/how-to-create-a-web-service)

在 .NET 中调用 Web 服务很容易通过 Google 搜索（但这里是一个很好的起点：[在 .Net 中使用基于 REST 的 Web 服务](https://stackoverflow.com/questions/727649/consuming-rest-based-web-services-in-net)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:42:11.153

这可以通过网络服务来完成。 [这个 SO 线程](https://stackoverflow.com/questions/4979980/start-using-ruby-on-rails-web-services-and-oauth)很好地解释了它

# android - 如何在 Android 中显示自定义地图？

> ID：15647916
> 
> 赞同：1
> 
> 时间：2013-03-26T21:39:01.200
> 
> 标签：android, geoserver, custom-view, wms, indoor-positioning-system

我是在 Android 上使用地图的新手，作为自定义地图我的意思是由我自己的地图服务器构建的地图（我正在使用带有 WMS 的 GeoServer） 我应该创建自定义视图还是可以使用 MapFragment？或者我可以使用的任何库？（我的自定义地图适用于室内位置）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T08:24:55.507

您可以使用[Osmdroid](https://code.google.com/p/osmdroid/)显示您自己的地图图块。实现看起来像这样：

```
public void addTiledMaplayer(){
        final MapTileProviderBasic tileProvider = new MapTileProviderBasic(getApplicationContext());
        final ITileSource tileSource = new XYTileSource(layerName, null, 15, 16, 256, ".png",
            "http://url.with/tiles/");
        tileProvider.setTileSource(tileSource);
        final TilesOverlay tilesOverlay = new TilesOverlay(tileProvider, this.getBaseContext());
        tilesOverlay.setLoadingBackgroundColor(Color.TRANSPARENT);
        map.getOverlays().add(tilesOverlay);
        map.invalidate();

    } 
```

如果您没有可用的切片，您可以使用名为 Mobile Atlas Creator 的程序从您的 Geoserver 中提取它们。

# javascript - 未显示表单验证 Javascript 的错误消息

> ID：15647922
> 
> 赞同：0
> 
> 时间：2013-03-26T21:39:26.437
> 
> 标签：javascript, validation

不太确定我做错了什么。但是我的两个错误没有显示，nPrice 和 nAmount。但是，我的名字和 nSmokes 显示。我认为这与我正在使用的 if else 的多重条件有关。

我真的很想听听你的想法。

提前致谢。

```
function doValidate()
{

//alert("Working");

document.myForm.nPrice.value=parseFloat(document.myForm.nPrice.value);
document.myForm.nAmount.value=parseInt(document.myForm.nAmount.value);
document.myForm.nSmokes.value=parseInt(document.myForm.nSmokes.value);

//alert(document.myForm.nPrice.value);

//alert(document.myForm.nAmount.value);

//alert(document.myForm.nSmokes.value);

errorCount = 0;
errorMsg = ""

if( document.myForm.name.value == "") {

        errorMsg = errorMsg + "You need to enter a value!";
        document.getElementById('errors').innerHTML= errorMsg;
        errorCount++; 

}

if (document.myForm.nPrice.value < 0 && document.myForm.nPrice.value > 20.00) {

        errorMsg = errorMsg + "You need to enter a value between 0 and 20!";
        document.getElementById('errors').innerHTML= errorMsg;
        errorCount++; 
}

if (document.myForm.nAmount.value < 0 && document.myForm.nAmount.value > 40) {

        errorMsg = errorMsg + "You need to enter a value between 0 and 40!";
        document.getElementById('errors').innerHTML= errorMsg;
        errorCount++; 
}
if (document.myForm.nSmokes.value < 0) {

        errorMsg = errorMsg + "<br/>Either your doing a great job or you put in that you     smoked 0 today!";
        document.getElementById('errors').innerHTML= errorMsg;
        errorCount++; 
}

if (errorCount > 0) {
        return false;
} else {
        return true;
}
} 
```

HTML

```
<form name="myForm" method="post" id="myForm" onsubmit="return doValidate();">

  <table width="600" border="1" cellspacing="4" cellpadding="4">
   <tr>
     <td colspan="2" align="center"><img src="quitSmoking.jpg"  width="278"/></td>
   </tr>
   <tr>
     <td colspan="2" align="center">Quit Smoking Calculator by Your Name</td>
  </tr>
   <tr>
    <td>Your Name</td>
    <td><input type="text" name="name" id="name"  />&nbsp;</td>
   </tr> 
   <tr>
     <td>Date you Quit</td>
     <td><input name="startDate" type="text"> 
   <input type="button" value="select" onclick="displayDatePicker('startDate');">&nbsp;</td>
    </tr>
     <tr>
       <td>Price of a pack</td>
      <td><input type="text" name="nPrice" id="nPrice" value="8.00" />&nbsp;</td>
     </tr>
       <tr>
       <td>How many in a pack</td>
       <td><input type="text" name="nAmount" id="nAmount" value="20" />&nbsp;</td>
     </tr>
     <tr>
       <td>Number of cigarettes you smoked a day</td>
       <td><input type="text" name="nSmokes" id="nSmokes" value="25" />&nbsp;</td>
     </tr>
     <tr>
      <td colspan="2" align="center"><input type="submit" name="btnSubmit" id="btnSubmit" value="Calculate Savings" /></td>
    </tr>
     <tr>
       <td colspan="2" align="center"><div id="errors"></div></td>
     </tr>
     <tr>
       <td id="rowResult" colspan="2" align="center">
       <input type="hidden" name="nResult" id="nResult" value="" />
       &nbsp;</td>
     </tr>
   </table>

    </form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T21:42:39.753

```
document.myForm.nPrice.value < 0 && document.myForm.nPrice.value > 20.00 
```

一个值怎么可能小于 0**大于**20？您正在那里寻找 OR。

```
document.myForm.nPrice.value < 0 || document.myForm.nPrice.value > 20.00 
```

**或**介于 0 到 20 之间

```
document.myForm.nPrice.value > 0 && document.myForm.nPrice.value < 20.00 
```

您在第二个 if 表达式中也犯了类似的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:44:10.927

这条线不会像你想象的那样工作：

```
document.myForm.nSmokes.value = parseInt(document.myForm.nSmokes.value); 
```

一旦您再次将值放回表单中，该值将立即转换回字符串，这基本上就是您对上述行所做的事情。相反，您需要将解析后的值存储在变量中，然后在验证中使用这些变量。

```
var nSmokes = parseInt(document.myForm.nSmokes.value); 
```

然后像这样使用它：

```
if (nSmokes < 0) { 
```

此外，您的逻辑有错误，因为您使用的是`&&`(AND) 运算符，而不是`||`(OR) 运算符，这更有意义。

# matlab - 具有不同步长的线性间隔向量的向量

> ID：15647925
> 
> 赞同：1
> 
> 时间：2013-03-26T21:39:43.477
> 
> 标签：matlab, vectorization

假设我们有一个向量：

```
dx = [ 1 10 20 ] 
```

现在我们想为 dx 中的每个值生成一个从 0-100 以 dx 为步长的线性间隔向量，以便我们得到如下所示的内容，称之为 vals：

```
vals = 0   0  0
       1  10 20
       2  20 40
       3  30 60
       .  .   .
       .  . 100
       . 100
      100 
```

这样我们就得到了一个由不同大小的向量组成的向量。最终，我们希望将一个函数应用于 vals，然后我们需要对内部向量求和，这样结果将是一个包含 3 个元素的向量。解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T22:06:38.377

`arrayfun`你可以用and解决这个问题`cellfun`：

```
dx = [1 10 20];
vals = arrayfun(@(x)0:x:100, dx, 'UniformOutput', false);

result = cellfun(@(x)sum(someFunction(x)), vals); 
```

`someFunction`您要应用于向量的函数在哪里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:03:44.450

我将结果放在一个列表中，因为列的大小不同并且它不适合数组。

```
dx = [1 10 20];
l = 1 + 100 ./ dx;
% disp(l); % so you can see what the above calculation did
vals = {linspace(0,100,l(1,1))', linspace(0,100,l(1,2))',linspace(0,100,l(1,3))}
% the (') after the linspace() function is a matrix transpose since linspace() returns a row vector
% lists work like matrices except you use list_name{m} as opposed to matrix_name(m,n) 
```

享受矢量化的乐趣！

# python - 使用 Ctypes 从 Python 传递 C 结构

> ID：15647928
> 
> 赞同：3
> 
> 时间：2013-03-26T21:40:17.597
> 
> 标签：python, ctypes

我正在尝试调用使用结构作为参数的 C 库中的函数。我该怎么做呢？我已经创建了类似于文档中所做的结构的 Ctypes 表示，但我直接传递它不起作用。

我试图找到示例，但我找到的所有示例都传递了指向结构的指针。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-23T04:41:21.513

我有同样的问题。我有一个 C libxxxx.so 文件和相应的 .h 文件。这就对了。第一个 .h 文件中定义的几个函数原型需要传入堆栈上的结构。该结构在第二个 .h 文件中定义。我查看了 usb1 Python 库包装器，每个结构都作为指向函数原型的指针传递。（有些甚至作为指针的指针。）

我为这个结构做了一个包装：

```
typedef struct _SE_ADDR{
   int slot;   /**< The index of the target slot. */
   int fpga;   /**< The index of the target FPGA. */
   int reg;    /**< The index of the target register. */
} SE_ADDR; 
```

在 Python 包装器模块中，我创建了一个类来表示这个结构：

```
class SE_ADDR(Structure):
    _fields_ = [('slot', c_int),
                ('fpga', c_int),
                ('reg', c_int)]

SE_ADDR_p = POINTER(SE_ADDR) #Pointer to SE_ADDR required for se_waitForData_new 
```

然后在导入包装器后，我以上述@picomacer 的方式使用它：

```
addr = wrapper.SE_ADDR(0,0,0) 
```

这似乎有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T21:53:10.183

没有看到你的代码很难说，但我猜你必须实例化结构。从文档：

```
from ctypes import *

class POINT(Structure):
    _fields_ = [("x", c_int),
                ("y", c_int)]

point = POINT(10, 20) 
```

最后一行创建了一个名为 point 的 POINT 结构的实例。

如果您可以显示结构定义、如何使用它以及任何错误消息，这将非常有帮助

# java - 如何将 sencha gxt 托盘添加到 Eclipse Juno？

> ID：15647934
> 
> 赞同：0
> 
> 时间：2013-03-26T21:40:31.977
> 
> 标签：java, eclipse, gwt, extjs, gxt

我已经安装了 Eclipse juno EE 并添加了带有所有相应 gtks 的 google web 工具包插件。这个对我有用。现在我要添加 extgwt 到 eclipse 中。我下载了 sencha gxt 的最新版本。我完成了这条指令的所有步骤[http://www.sencha.com/blog/setting-up-your-first-ext-gwt-project-in-eclipse/](http://www.sencha.com/blog/setting-up-your-first-ext-gwt-project-in-eclipse/) 但是当我在设计模式下打开我的模块时我没有查看带有相应控件的相应 sencha gxt 托盘。我哪里错了？我应该怎么做才能在我的项目的设计视图中获得 sencha gxt 控制托盘？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:10:39.043

您需要选择您的 GWT 模块文件并右键单击以选择 Google Web Toolkit > Configure for using Ext GWT (GXT) 命令。这会将 gxt.jar 添加到您的类路径和模块文件中，并将各种 GXT 文件添加到您的 war 文件夹中。

一旦将 Ext GWT (GXT) 添加到您的项目中，就会出现几个新的 Ext GWT (GXT) 调色板类别：

但请记住，这是针对 2.x 版的。我不确定最新的 GXT 3.x 是否适用于设计师。

见[https://developers.google.com/web-toolkit/tools/gwtdesigner/features/gwt/gxt](https://developers.google.com/web-toolkit/tools/gwtdesigner/features/gwt/gxt)

# css - Internet Explorer 9 中的一个 peekaboo 错误？

> ID：15647936
> 
> 赞同：2
> 
> 时间：2013-03-26T21:40:40.687
> 
> 标签：css, internet-explorer-9, haslayout

好吧，我很困惑。

IE9 在正在开发的网站的某些但不是所有页面上显示不一致的页面宽度问题。

在 IE9 中：转到[http://sistercarmen.org/cms/](http://sistercarmen.org/cms/)，您可以看到与正确页面大致相似的内容。实际上页面有点太宽了，这肯定是个问题。[但与“关于](http://sistercarmen.org/cms/about/)”页面或“[历史”](http://sistercarmen.org/cms/about/history/)页面上发生的事情完全不同。

在这些页面上，页面确实变得非常宽。但是，如果您将鼠标悬停在右栏中的链接上（可能需要水平滚动才能看到一个），页面会恢复到正确的大小。

构建一个[简化的测试页面@ jsFiddle](http://jsfiddle.net/mKDNn/)，我可以确认这似乎与`display: table`但这对我很重要，因此我可以稍后在源代码中提供导航。一个[更简单的测试页面](http://jeremycarlson.com/test/beforecaption3.html)显示`display:table`通常适用于 IE9。

所以......**这是一个hasLayout问题，如果是这样，我如何在IE9中强制hasLayout？**

非常感谢，

杰里米

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:56:27.537

你是对的，这很奇怪。对于它的价值，您的页面在 IE10 中运行良好。

在我有空的时间内，我无法为您找到合适的解决方案，但与此同时，您是否考虑过将 a`width`或 a`max-width`应用于正文文本元素？

[编辑]

我可以确认添加`width:100%`到`content-lead`元素将解决该问题。

仍然不是问题发生原因的答案，但至少它是一种解决方法。

[再次编辑]

实际上，事实证明上述解决方法并不像我最初想象的那么好。唯一对我有用，`width:100%`因为我在控制台上玩。在 CSS 中执行此操作没有任何效果。

设置固定宽度可能会有所帮助，或者`calc()`如果完全固定的宽度不合适，则可能使用 CSS。

# sql-server - 不包括匹配条件的选择查询中的记录

> ID：15647940
> 
> 赞同：0
> 
> 时间：2013-03-26T21:41:02.387
> 
> 标签：sql-server

我在 sql server 中有一个查询，它显示了一些我不想要的记录。字段的关系如下：

一个 ClientID 可以有多个工作负载 (WorkloadID)，但不能反过来（一对多）。每个 WorkloadID 都有一个分配给它的单元。每个 WorkloadID 都有一个分配给它的 DWLD（日期）。多个 WorkloadID 可以具有相同的 ClientID、DWLD 和 Unit。

这是查询：

```
select 
w.WorkloadID,
w.ClientID,
w.Unit,
w.DWLD

        from 
        Workload as w
        left JOIN Clients as cli
        ON w.ClientID = cli.ClientID

    where

        w.DWLD >= @start AND w.DWLD < @enddate
        and w.IsDeleted <> 1 
```

我希望它不只显示少数可用记录中的 1 条记录，这些记录具有相同的 ClientID、相同的单元和相同的 DWLD。我已经尝试使用 have 子句和 not exists 子句自行加入表，但没有得到正确的结果。

谢谢！

[查询中显示的数据](http://i.stack.imgur.com/C3fiI.png)

[源表](http://i.stack.imgur.com/8LShC.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:54:15.610

试试这个查询。当您不从`clients`表中检索记录时，无需加入该表。

```
select w.WorkloadID, w.ClientID, w.Unit, w.DWLD
from Workload as w
where w.DWLD BETWEEN @start AND  @enddate
and w.IsDeleted <> 1 
AND NOT EXISTS (SELECT * FROM Workload 
WEHRE ClientId = w.clientid 
and unit = w.unit and dwld = w.dwld 
and workloadid < w.workloadid 
and DWLD BETWEEN @start AND  @enddate 
AND IsDeleted <> 1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:22:25.190

如果 DWLD 列中的值按小时/分钟不同，并且您希望它们按天分组，请使用 cast(cast(DWLD as float) as int)

```
select 
max(w.WorkloadID) as WorkloadID,
w.ClientID,
w.Unit,
w.DWLD

        from 
        Workload as w
        left JOIN Clients as cli
        ON w.ClientID = cli.ClientID

    where

        w.DWLD >= @start AND w.DWLD < @enddate
        and w.IsDeleted <> 1

group by w.ClientID,
w.Unit,
w.DWLD 
```

# php - php表单标签不起作用？（未定义的变量错误）

> ID：15647942
> 
> 赞同：-3
> 
> 时间：2013-03-26T21:41:08.947
> 
> 标签：php, html

首先，我正在使用 wamp 服务器并学习基本的 PHP 语法。

所以我的第一个表单 php 文件是

```
<form action="foo.php" method="post">
Name:  <input type="text" name="username" /><br />
Email: <input type="text" name="email" /><br />
<input type="submit" name="submit" value="Submit me!" />
</form> 
```

foo.php 文件是

```
<?php 
// Available since PHP 4.1.0

echo $_POST['username'];
echo $_REQUEST['username'];

import_request_variables('p', 'p_');
echo $p_username;

// As of PHP 5.0.0, these long predefined variables can be
// disabled with the register_long_arrays directive.

echo $HTTP_POST_VARS['username'];

// Available if the PHP directive register_globals = on. As of 
// PHP 4.2.0 the default value of register_globals = off.
// Using/relying on this method is not preferred.

echo $username;
?> 
```

但是当我打开 localhost/form2.php 时它工作正常，然后我输入“用户名”和“电子邮件”。之后，它给出了以下错误：

注意：未定义变量：第 13 行 C:\wamp\www\foo.php 中的 HTTP_POST_VARS 注意：未定义变量：第 19 行 C:\wamp\www\foo.php 中的用户名

显然，这些代码应该可以工作，但由于某种原因它对我不起作用。wamp服务器有问题吗？或者我如何设置配置可能有问题？谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T21:46:14.003

正如您在[php.net](http://php.net/manual/de/reserved.variables.post.php)上所读到的，`$HTTP_POST_VARS`已弃用。实际上它们自 PHP5.4 以来不再可用，所以难怪它说`Undefined variable`.

`$username`，这仅适用于`REGISTER_GLOBALS=ON`-您的 WAMP 可能已打开`OFF`，因为它应该是。

总结总结：使用`$_POST`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T21:47:24.587

`$HTTP_POST_VARS`未定义，因为[`register_long_arrays`](http://www.php.net/manual/en/ini.core.php#ini.register-long-arrays)已关闭。如果您使用的是 PHP 5.4.0，那么它已被*删除*。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:49:51.923

The function import_request_variables() has been deprecated and removed as of php version 5.4.0\.

Use $_POST instead of $HTTP_POST_VARS. The latter is deprecated also.

Do something like this instead:

```
<?php
$userName = '';
$email = '';

if (isset($_POST['username'])) {
    $userName = $_POST['username'];
}

if (isset($_POST['email'])) {
    $email = $_POST['email'];
}

echo 'username=' . $userName;
echo 'email=' . $email;
?> 
```

# html - 带有 javascript 的 Codeigniter

> ID：15647946
> 
> 赞同：0
> 
> 时间：2013-03-26T18:21:38.540
> 
> 标签：html, javascript, php, css

正在使用 codeigniter 并尝试提交表单，然后用 javascript 关闭它......</p>

我有一个弹出功能……我从父页面调用：

```
<a href = "javascript:popup('controller/method/variable', 'Click', '400', '400')">Click</a> 
```

这是功能：

```
function reject_popup(url, name, width, height){
    var top = parseInt((screen.availHeight / 2) - (height / 2));
    var left = parseInt((screen.availWidth / 2) - (width / 2));
    var features = "location=1, status=1, scrollbars=1, width=" + width + ", height=" + height + ", top=" + top + ", left=" + left;
  window.open(url, name, features);} 
```

它打开这个表格：

```
<?php echo form_open('state/validate_rejection/'.$file_results->sender_id.'/'.$this->session->userdata('id').'/'.$file_results->id, array('name'=>'rejection_form', 'id'=>'rejection_form', 'onsubmit'=>'window.forms[0].submit();self.close();')); ?> 
```

```
<p>
    <label>Write the reason of Rejection?<span class='req'>* Required</label>
    <textarea name="remarks" rows="8"  max-width:380px " autofocus required></textarea>
</p> 
```

```
<input type="button" class="button" value="cancel"  />
<input name="submit_rejection" id="submit_rejection" type="submit" class="button" value="Send" /> 
```

如您所见，表单操作是一个指向控制器/方法的 url：这是我使用的方法：

```
function validate_rejection(){
     $this->form_validation->set_rules('remarks', 'Remarks', 'trim|required');
     if($this->form_validation->run() == TRUE){
         $sender_id = $this->uri->segment(3) ? $this->uri->segment(3) : 0;
         $user_id = $this->uri->segment(4) ? $this->uri->segment(4) : 0;
         $file_id = $this->uri->segment(5) ? $this->uri->segment(5) : 0;
    //here a function from codigniter model is called, and returns true if query succeded, false if it failed
         $rejection = $this->files_model->reject_file($sender_id, $user_id, $file_id);

         if($rejection == TRUE){

             $this->session->set_flashdata('rejection_succ', 'Rejected Successfully');
             //redirect('home');
         }
         else{
              $this->session->set_flashdata('rejection_fail', 'Rejection of file Failed');
         }
      }
      else{
           $this->session->set_flashdata('remarks_validation_errors', validation_errors());
      }
  } 
```

nd 如果表单提交成功或失败，它将设置一个 flashdata

现在我希望在提交表格时检查表格是否完成，重新加载父页面并关闭弹出窗口...... 谁能帮我实现这一点……这也是一个 javascript 案例，但只要我使用 codeigniter，我认为这将是发布此线程的最佳位置？

注意：抱歉格式错误...我是新用户，我没有看到代码块：S

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-30T11:29:52.750

成功提交表单并设置 flashdata 后，将以下行添加到您的控制器/方法中

```
echo "<script type='text/javascript'>window.close();window.opener.top.location.reload();</script>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-28T15:19:51.580

如果我是你，我会使用 jQuery Dialog - [http://jqueryui.com/dialog/#modal-form](http://jqueryui.com/dialog/#modal-form)。如果它已经存在，为什么要重新发明温水。您唯一需要添加的是刷新页面。

# asp.net-mvc - 模拟图像上传视图模型

> ID：15647947
> 
> 赞同：2
> 
> 时间：2013-03-26T21:41:49.613
> 
> 标签：asp.net-mvc, tdd, moq, testdriven.net

我知道一些 ASP MVC，试图拥抱 TDD。以下示例安装了 xUnit 和 TestDriven（包括 Moq）。

问题是我试图模拟图像上传视图模型，以便我可以断言它正在被上传。

起订量给了我问题：

> 非虚拟（在 VB 中可覆盖）成员上的设置无效

在试图

```
var imageMock = new Mock<ImageViewModel>();
imageMock.Setup(x => x.IsUrl).Returns(true);` 
```

我不知道如何继续下去——为视图模型创建接口是胡说八道，我是为站点编程，而不是为测试环境编程。

我应该替换 Mock 环境或定义接口还是...？

请提供一些经验丰富且内容丰富的建议，并请提供或至少喜欢您建议我做的事情的好样品。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T21:50:50.717

First of all, is this a auto property?

```
public bool IsUrl {get; set;} 
```

If so, just set the value yourself in the set up of your test. If it's not an auto property, does it make more sense to move it into a method, instead of property. And at that time, you could make the method virtual (which is what the error message is actually saying.)

When mocking, you can't mock things that are either not interfaces or are not virtual (I believe there are some paid mocking libraries that let you, but FakeItEasy, Moq and others require that it be virtual.)

To do this, you would simply need to make the property look like this:

```
public virtual bool IsUrl {get; set;} 
```

Secondly, what are you testing on your view model? Testing getters and setters is largely a waste of time because they will most likely be tested in other places of your code. Plus, tests on getters and setters are testing the compiler, not your code. If getters and setters don't work in .NET you've got a whole host of problems. It would be better to test the creation of your view model and then make sure that it has the right values after creation.

# ruby-on-rails - 子类和 Rabl

> ID：15647955
> 
> 赞同：2
> 
> 时间：2013-03-26T21:42:27.580
> 
> 标签：ruby-on-rails, ruby, rabl

我有一个包含父类和子类对象的提要，我使用 RABL 将其渲染到 json 中。我在 json 中包含根对象。

事情是这个 => 取决于先出现的，json中的根节点将与相应的类一起生成。

我需要它是所有的父类。

下面的例子：

```
Class Klass
 ...

Class SubclassOfKlass < Klass
 ...

k = Klass.create
s = SubclassOfKlass.create

array1 = [k,s]
Rabl::Renderer.json(nil, 'answers/list', view_path: 'app/views', locals: {object: array1})

## results will render everything as "Klass" objects
## [{\"klass\":{\"_id\":\"1\"},{\"klass\":{\"_id\":\"2\"}]

array2 = [s,k]
Rabl::Renderer.json(nil, 'answers/list', view_path: 'app/views', locals: {object: array1})

## results will render everything as "SubclassOfKlass" objects
## [{\"subclass_of_klass\":{\"_id\":\"1\"},{\"subclass_of_klass\":{\"_id\":\"2\"}]

### But I need the root to be always "klass" and not "subclass_of_klass" 
```

rabl 如下（非常简单）

```
# list.rabl
collection @answers
extends "answers/show"

#show.rabl
if @user
  node(:context_string) { |a| a[:context_string]}
  node(:notebook) do |a|
    if a.class == SubclassOfKlass
      a.notebook
    end
  end
end

extends "klasses/cache" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T06:42:31.410

好的，答案很简单：

```
collection @answers, :object_root => "answer" 
```

# servicestack - AppHostBase.Instance 已设置

> ID：15647960
> 
> 赞同：1
> 
> 时间：2013-03-26T21:43:14.457
> 
> 标签：servicestack

我一直致力于基于 servicestack 构建我的 API。一切都在本地完美运行，但是当我刚刚将其上传到我的 azure 网络空间时，我收到了错误：

AppHostBase.Instance 已设置

完整的错误可以在这里看到：

[http://taxirouteapi.azurewebsites.net/](http://taxirouteapi.azurewebsites.net/)

谁能告诉我出了什么问题？

非常感谢

特雷夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T22:04:20.680

您是否创建了自己的 AppHost 类？如果您通过 NuGet 安装 ServiceStack，许多包会自动为您创建一个 AppHost 类。

查看您的代码并尝试查找其他 AppHost 的位置以及它的初始化位置。

另一件事是，如果您已将其添加到 Global.asax 中的 Application_Start 中，这可能会导致错误。这是因为 NuGet 包已经包含这一行：

> [程序集：WebActivator.PreApplicationStartMethod(typeof(AppicationName.Web.App_Start.AppHost), "Start")]

这意味着它将启动两次。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T22:20:14.120

这个问题看起来与此重复：[https ://stackoverflow.com/a/8954916/85785](https://stackoverflow.com/a/8954916/85785)

您基本上需要删除从`ServiceStack.Host.*`NuGet 包安装时自动创建的 AppHost。

否则，从基础[ServiceStack NuGet 包](https://nuget.org/packages/ServiceStack)安装它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T22:06:12.460

我还没有设法解决这个问题，但是当我将项目发布到另一个 url 上的干净天蓝色网站时，它工作得很好。

我能想到的只是以前的网站在 azure 上挂了一些东西，导致它停止工作。

所以，将它移到一个干净的天蓝色网站解决了我的问题。

特雷夫

# css - 如何调整css边距顶部？

> ID：15647961
> 
> 赞同：0
> 
> 时间：2013-03-26T21:43:15.740
> 
> 标签：css

我的网站上有一个 div，我正在尝试使用 margin-top 属性将此 div 定位在 css 中。

我目前正在使用：

```
margin-top: -0.5px; 
```

执行此操作时，我的 div 会略微偏低，但是如果我执行 margin-top: -0.6px; 然后它太高了，我试图找到一个介于 0.5 和 0.6 之间的值，

有没有办法我可以使用 2 个小数位值，例如：

```
 margin-top: -0.5.5px; 
```

非常感谢任何帮助，谢谢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T22:03:23.433

简短的回答是小数 css 像素比率被舍入或截断。

考虑以下几点：

```
div.someclass {margin-top: 0.55px;} 
```

和百分比

```
div.someclass {margin-top: 35.55%;} 
```

大多数浏览器会将这些值四舍五入到最接近的百分比，并被其他浏览器截断。这意味着上述 2 个示例将被解释为 0.6px / 0.5px 和 35.6% / 35.5%，具体取决于用户的浏览器。

有关小数 css 值的更多信息，请查看此 stackoverflow 线程：[是否尊重 CSS 宽度中的小数位？](https://stackoverflow.com/questions/4308989/are-the-decimal-places-in-a-css-width-respected)

我们如何解决这个问题？不幸的是，您实际上不能，但您可以尝试通过添加一些内部填充来抵消边距分数，方法是使用抵消边距的分数。

例子：

```
div.outer {margin-top: 0.5px;}
div.inner {padding-top: 0.1px;} 
```

这肯定会导致与 margin-top: 0.6px 相同的输出，但根据您的整个 CSS 主题的细节，您可能会注意到细微的差异。

# javascript - jQuery获取当前表格下方的下一个元素

> ID：15647966
> 
> 赞同：2
> 
> 时间：2013-03-26T21:43:50.583
> 
> 标签：javascript, jquery

我有一个填字游戏，并试图在输入字母后自动将光标移动到下一个字母框。我可以做到这一点，但不确定下来。我想作为优先级 #1 过去，如果下一个框不是信箱，它会搜索以查看它是否可以关闭。如果它不能跨越或下降，那么什么也不会发生。

这是我所经历的：

```
$('.crossword_puzzle input[type="text"]').keyup(function() {
   $(this).parent().parent().next().find('input[type="text"]').focus().select();
}); 
```

如果没有找到交叉，我怎么能下去？

DOM 是一个 html 表格，每个 TD 中都有一个输入框。

谢谢你的帮助。

编辑 - Heres 是表格的一部分，忘了我在每个 td 中也有一组 div。还有一个 div 在每个单词的开头都有一个数字。

```
 <table class="crossword_puzzle">
<tr>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="block_num">1</div>
         <input type="text" class="word_3_1 cp_move_across" maxlength="1" onClick="this.select();" id="x3y1" name="x3y1" value=""/>
         <div class="block_num">1</div>
      </div>
   </td>
   <td>
      <div class="all_blocks"><input type="text" class="word_3_1 cp_move_across" maxlength="1" onClick="this.select();" id="x4y1" name="x4y1" value=""/></div>
   </td>
   <td>
      <div class="all_blocks">
         <input type="text" class="word_3_1 cp_move_across" maxlength="1" onClick="this.select();" id="x5y1" name="x5y1" value=""/>
         <div class="block_num">2</div>
      </div>
   </td>
   <td>
      <div class="all_blocks"><input type="text" class="word_3_1 cp_move_across" maxlength="1" onClick="this.select();" id="x6y1" name="x6y1" value=""/></div>
   </td>
   <td>
      <div class="all_blocks"><input type="text" class="word_3_1 cp_move_across" maxlength="1" onClick="this.select();" id="x7y1" name="x7y1" value=""/></div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
</tr>
<tr>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks"><input type="text" class="word_3_1 cp_move_down" maxlength="1" onClick="this.select();" id="x3y2" name="x3y2" value=""/></div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks"><input type="text" class="word_5_1 cp_move_down" maxlength="1" onClick="this.select();" id="x5y2" name="x5y2" value=""/></div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks">
         <div class="black_block"></div>
      </div>
   </td>
   <td>
      <div class="all_blocks"> 
```

怎么样，在下面回答@Kevin B 并添加一个标志来切换优先级。有没有人看到这样做的问题？编辑：根据下一个单元格是否具有当前优先级顺序中的文本，为翻转方向优先级添加逻辑

```
var priority_direction = 'across';
    $('.crossword_puzzle input[type="text"]').keyup(function() {
        if(priority_direction == 'across'){
            var next = $(this).closest('td').next().find('input[type="text"]');
            priority_direction = 'across';
            if (!next.length || next.val().length == 1) {
                var cellIndex = $(this).closest('td').index();
                next = $(this).closest('tr').next().children().eq(cellIndex).find('input[type="text"]');
                priority_direction = 'down';
            }
        } else {
            var cellIndex = $(this).closest('td').index();
            var next = $(this).closest('tr').next().children().eq(cellIndex).find('input[type="text"]');

            priority_direction = 'down';
            if (!next.length || next.val().length == 1) {
                next = $(this).closest('td').next().find('input[type="text"]');
                priority_direction = 'across';
            }
        }
        next.focus().select();
    }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T21:47:26.943

转到下一行而不是下一个 td。

```
$('.crossword_puzzle input[type="text"]').keyup(function() {
   var next = $(this).closest('td').next().find('input[type="text"]');
   if (!next.length) {
      var cellIndex = $(this).closest('td').index();
      next = $(this).closest('tr').next().children().eq(cellIndex).find('input[type="text"]');
   }
   next.focus().select();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T21:51:37.520

You might consider adding classes to each cell (eg. `<td class="r5 c16"></td>`) to ease navigation between them. Your code could look a lot cleaner and the jQuery selectors will be more efficient.

# java - 将单词列表添加到 txt 文件 Java

> ID：15647970
> 
> 赞同：0
> 
> 时间：2013-03-26T21:44:11.073
> 
> 标签：java, text, overwrite

我试图通过 JOptionPane 输入菜单添加从最终用户那里删除的单词列表，并将它们存储在文本文件中，而不会覆盖已经存在的内容。例如 txt 文件

贝尔酷你好现在java编译

我遇到的问题是它不断覆盖我有什么帮助？

```
 import javax.swing.JDialog;
  import java.util.Arrays;
  import javax.swing.*;
import java.util.*;
import java.io.*;

public class write
{
public static void main(String [] args) throws IOException
{
    PrintWriter out = new PrintWriter(aFileWriter);
 String word = JOptionPane.showInputDialog(null, "Enter a word");
  out.print(word);

  out.close();
  aFileWriter.close();
 }
 } 
```

好的，现在它附加了文件，但没有移动到新单词的新行？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T21:46:25.980

[为 FileWriter](http://docs.oracle.com/javase/7/docs/api/java/io/FileWriter.html#FileWriter%28java.io.File,%20boolean%29)使用另一个提供 'append' 参数的构造函数：

```
FileWriter aFileWriter = new FileWriter("mydata.txt", true ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T22:24:28.990

打开文件：

`PrintWriter out = new PrintWriter(new BufferedWriter(new FileWriter("outfilename", true)));`

将字符串附加到文件中：

`out.println("the text");`

关闭文件：

`out.close();`

更好的[解释](https://stackoverflow.com/a/1625263/660408)。

# c - 将简单的 HTML 解析为树

> ID：15647971
> 
> 赞同：7
> 
> 时间：2013-03-26T21:44:13.273
> 
> 标签：c, parsing, html-parsing

我想问一下将简单的 html 代码解析为 DOM 节点树的最佳方法是什么：

![示例树](../Images/cfb8eac84eaa7c903a7803be597d66fa.png)

以下是我面临的一些限制：

*   HTML 代码将只有对标签，没有属性，我必须忽略空格
*   标签之间可以有文本，如`<p>`,`<h1>`等`<a>`。
*   我不能使用库

我在考虑正则表达式，但从未尝试过。有什么想法吗？

树中的每个节点都是这个结构：

```
 typedef struct tag
  {
      struct tag* parent;
      struct tag* nextSibling;
      struct tag* previousSibling;
      struct tag* firstChild;
      struct tag* lastChild;     
      char* name;
      char* text;     
  }node; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T07:34:47.107

我知道它不在 C 语言中，但该演示文稿可能会给您一些关于如何有效解决问题的意见。

[https://web.archive.org/web/20120115060003/http://cuddle.googlecode.com/hg/talk/lex.html#landing-slide](https://web.archive.org/web/20120115060003/http://cuddle.googlecode.com/hg/talk/lex.html#landing-slide)

我还根据您的初始要求用 JavaScript 编写了一个非常简单的解析器示例（同样不是 C，但希望您也了解 JS），这意味着它不会解析任何属性，也不会处理自关闭标签和许多其他事情应根据 HTML 规范处理。它将以这种格式生成解析树：

```
{
    cn: [{
        tag: 'html',
        cn: [{
            tag: 'body',
            cn: [
                { tag: 'h1', cn: ['test'] },
                ' some text ',
                ...
            ]
        }] 
    }]
} 
```

这是代码和小提琴：http: [//jsfiddle.net/LUpyZ/3/](http://jsfiddle.net/LUpyZ/3/)

请注意，空白不会被忽略，并将在文本节点中捕获。

```
var html = '<html><body><h1>test</h1> some text <div> <p>text</p></div></body></html>';

var parseHTML = (function () {
    var nodesStack = [],
        i = 0,
        len = html.length,
        stateFn = parseText,
        parseTree = { cn: [] },
        alphaNumRx = /\w/,
        currentNode = parseTree,
        text = '',
        tag = '',
        newNode;

    function parseTag(token) {
        if (token === '/') {
            return parseCloseTag;
        }

        i--; //backtrack to first tag character
        return parseOpenTag;
    }

    function parseCloseTag(token) {
        if (token === '>') {
            if (currentNode.tag !== tag) {
                throw 'Wrong closed tag at char ' + i;
            }

            tag = '';

            nodesStack.pop();

            currentNode = currentNode.parentNode;

            return parseText;            
        }

        assertValidTagNameChar(token);

        tag += token;

        return parseCloseTag;
    }

    function parseOpenTag(token) {
        if (token === '>') {
            currentNode.cn.push(newNode = { tag: tag, parentNode: currentNode,  cn: []});
            nodesStack.push(currentNode = newNode);

            tag = '';

            return parseText;
        }

        assertValidTagNameChar(token);

        tag += token;

        return parseOpenTag;
    }

    function parseText(token) {
        if (token === '<') {

            if (text) {
                currentNode.cn.push(text);
                text = '';
            }

            return parseTag;
        }

        text += token;

        return parseText;
    }

    function assertValidTagNameChar(c) {
        if (!alphaNumRx.test(c)) {
            throw 'Invalid tag name char at ' + i;
        }
    }

    return function (html) {
        for (; i < len; i++) {
            stateFn = stateFn(html[i]);
        }

        if (currentNode = nodesStack.pop()) {
            throw 'Unbalanced tags: ' + currentNode.tag + ' is never closed.';
        }

        return parseTree;
    };
})();

console.log(parseHTML(html)); 
```

# java - 停止和重新启动秒表

> ID：15647976
> 
> 赞同：0
> 
> 时间：2013-03-26T21:44:40.103
> 
> 标签：java

这比较了使用 Math.sqrt 和牛顿法求平方根所需的时间。我应该为此添加允许客户端停止并重新启动秒表的方法，但我不确定如何执行此操作。不幸的是，搜索其他问题并没有带来太多的运气。因为这是一门课，我不希望给我直接的答案，但是一些建议，或者一个关于如何实现我的目标的教程的链接会很好。谢谢你的帮助。

```
public class Stopwatch 
    {
private final long start;

public Stopwatch()
{ start = System.currentTimeMillis(); }

public double elapsedTime()
{
    long now = System.currentTimeMillis();
    return (now - start) / 1000.0;
}

public static void main(String[] args)
{
    int N = Integer.parseInt(args[0]);

    double totalMath = 0.0;
    Stopwatch swMath = new Stopwatch();
    for (int i = 0; i < N; i++)
        totalMath += Math.sqrt(i);
    double timeMath = swMath.elapsedTime();

    double totalNewton = 0.0;
    Stopwatch swNewton = new Stopwatch();
    for (int i = 0; i < N; i++)
        totalNewton += Newton.sqrt(i);
    double timeNewton = swNewton.elapsedTime();

    System.out.println(totalNewton/totalMath);
    System.out.println(timeNewton/timeMath);
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T21:59:24.790

很高兴你能诚实地说这是为了一堂课，你不想给你答案。这是学习的良好开端:)

以下是我将如何处理任务：

首先，我只是定义缺少的方法。然后，我将开始编写（作为内联注释）这些方法应该做什么。重置秒表是什么意思，停止是什么意思？您可以将其与“现实生活”秒表相提并论。这应该让您开始思考，一旦您定义了规则，就应该可以将其转换为代码。

也许这比你预期的要抽象一点，但我相信你会以正确的态度到达那里，就像你看起来的那样！祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T21:53:51.250

创建另一个名为 long 类型的属性`timeElapsedUntilLastStop`。

创建一个名为 stop 的方法，该方法与 elapsedTime 完全相同，但不返回添加到当前值的`timeElapsedUntilLastStop`.

`restart()`方法应该初始化应该足够的开始变量。

# c# - 使用 Visual Studio 在 C# 中仅从某个时间点开始调试

> ID：15647978
> 
> 赞同：3
> 
> 时间：2013-03-26T21:44:44.780
> 
> 标签：c#, visual-studio, debugging

我有一个程序，它是一个类似俄罗斯方块的小游戏。我的碰撞检测器在某些配置中有问题，我想对其进行调试，但游戏并未以“有问题”状态启动，我想让游戏进入该状态并且只有他们开始调试。由于碰撞检测器运行非常频繁，我不能在我知道只有在我达到问题状态后才会运行的地方设置断点，并且调试过程从游戏窗口获得焦点，并且不允许我给出用键盘输入。

使用 Visual Studio 2012，有没有办法只在一段时间后启动调试器，在启动时它会忽略断点，只有在我告诉它之后，它才会在断点处开始中断？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-26T21:48:01.193

是的，您可以通过在不调试的情况下开始执行此操作，然后当您到达所需的状态时，使用“调试”菜单，选择“附加到进程”。当您看到列表时，双击您的应用程序。

另一种可能的解决方案是禁用断点，然后当您到达您想要的状态（您将开始调试的状态）时，只需使用断点窗口启用您想要的断点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T21:48:41.170

当您看到游戏将进入有问题的配置时，您可以添加按钮或快捷方式并手动触发调试器中断：

```
System.Diagnostics.Debugger.Break(); 
```

从那里在碰撞检测过程中放置​​另一个断点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T21:50:22.530

Some variant of [conditional breakpoint](http://blogs.msdn.com/b/zainnab/archive/2010/05/04/set-a-complex-breakpoint-condition-vstipdebug0022.aspx) should work for you. The hard part is deciding when you want to break in, but conditional BPs give you a flexible framework to work within.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-26T21:47:01.753

```
//assume that frame_counter is incremented at 60 Hz

//adjust this conditional to whatever you want to trigger the breakpoint for real
if(frame_counter > 60 * 60 * 5) { //wait 5 minutes

} // place breakpoint here 
```

调整以适应您的需求

# asp-classic - 经典 ASP - 模仿后退浏览器按钮

> ID：15647979
> 
> 赞同：1
> 
> 时间：2013-03-26T21:44:47.620
> 
> 标签：asp-classic

让按钮模仿“后退”浏览器按钮的最佳方式是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T21:48:35.950

`<a href="<%=Request.ServerVariables("HTTP_REFERER")%>">Back</a>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T21:47:09.903

使用浏览器端的javascript调用history.back。

```
window.history.back() 
```

# angularjs - AngularJS 和 ng-grid - 更改单元格后自动将数据保存到服务器

> ID：15647981
> 
> 赞同：38
> 
> 时间：2013-03-26T21:44:50.917
> 
> 标签：angularjs, ng-grid

我的用例非常简单。用户在编辑单元格 (enableCellEdit: true) 后，应该将数据“自动”发送到服务器（在单元格模糊时）。我尝试了不同的方法，但没有一个能正确解决。我有一个简约的网格：

```
// Configure ng-grid
$scope.gridOptions = {
    data: 'questions',
    enableCellSelection: true,
    selectedItems: $scope.selectedRow,
    multiSelect: false,
    columnDefs: [
        {field: 'id', displayName: 'Id'},
        {field: 'name', displayName: 'Name'},
        {field: 'answers[1].valuePercent', displayName: 'Rural', enableCellEdit: true}
    ]
}; 
```

例如，我试图观察传递给 Grid 的数据模型。但这样做不会返回我编辑的单元格：

```
$scope.$watch('myData', function (foo) {
    // myModel.$update()
}, true); 
```

我试图摆弄“ngGridEventData”数据事件，但在单元格编辑后它不会触发

```
$scope.$on('ngGridEventData', function (e, gridId) {
    // myModel.$update()
}); 
```

最后，我尝试观察一个单元格。但是，这仅通过网格的“selectedCell”属性对一行有效：

```
$scope.selectedRow = [];

$scope.gridOptions = {
    selectedItems: $scope.selectedRow,
}

$scope.$watch('selectedRow', function (foo) {
    console.log(foo)
}, true); 
```

是否需要[ng-grid 插件](https://github.com/angular-ui/ng-grid/wiki/Plugins)？我不敢相信这不是开箱即用的东西。

你有一个指针/片段我如何解决自动保存/发送到服务器？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2014-03-02T16:37:27.290

也许这是新的，但 ng-grid 实际上发布了可用于实现简单更新更改的事件。

事件参考：[https ://github.com/angular-ui/ng-grid/wiki/Grid-Events](https://github.com/angular-ui/ng-grid/wiki/Grid-Events)

示例代码（添加到设置网格的控制器）：

```
$scope.$on('ngGridEventEndCellEdit', function(evt){
    console.log(evt.targetScope.row.entity);  // the underlying data bound to the row
    // Detect changes and send entity to server 
}); 
```

需要注意的一点是，即使没有进行任何更改，事件也会触发，因此您可能仍希望在发送到服务器之前检查更改（例如通过“ngGridEventStartCellEdit”）

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-08-25T05:35:19.780

我发现了我认为更好的解决方案：

```
 cellEditableTemplate = "<input ng-class=\"'colt' + col.index\" ng-input=\"COL_FIELD\" ng-model=\"COL_FIELD\" ng-change=\"updateEntity(row.entity)\"/>" 
```

以这种方式使用 ng-change 将导致使用已更改的整个对象（行）调用 updateEntity，您可以将其发布回服务器。您不需要任何新的范围变量。上一个解决方案的一个缺陷是，当您单击开始编辑该字段时，在您开始编辑之前它总是空白而不是原始值。

这将导致在每次击键时调用 updateEntity()。如果这对您来说过于频繁，您可以在发布到服务器之前使用超时，或者只使用 updateEntity() 记录您要推送的 id，然后使用 ng-blur 发布记录的 id。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-04-05T11:11:30.970

多亏了 Angular[邮件列表](https://groups.google.com/forum/?fromgroups=#!topic/angular/PP_r1B5ivE8)，我似乎找到了解决方案。有人指出 AngularJS 缺少 onBlur 事件（以及 onFocus）。但是，这可以通过添加“简单”指令来克服。

```
angular.module('myApp.ngBlur', [])
.directive('ngBlur', function () {
    return function (scope, elem, attrs) {
        elem.bind('blur', function () {
            scope.$apply(attrs.ngBlur);
        });
    };
}); 
```

[作为信息，这里](http://www.grobmeier.de/angular-js-autocomplete-and-enabling-a-form-with-watch-and-blur-19112012.html)有另一个与模糊事件指令相关的实现示例。

然后，控制器中的其余代码如下所示：

```
// Define the template of the cell editing with input type "number" (for my case).
// Notice the "ng-blur" directive
var cellEditableTemplate = "<input style=\"width: 90%\" step=\"any\" type=\"number\" ng-class=\"'colt' + col.index\" ng-input=\"COL_FIELD\" ng-blur=\"updateEntity(col, row)\"/>";

// Configure ng-grid
$scope.gridOptions = {
    data: 'questions',
    enableCellSelection: true,
    multiSelect: false,
    columnDefs: [
        {field: 'id', displayName: 'Id'},
        {field: 'name', displayName: 'Name'},

        // Notice the "editableCellTemplate"
        {field: 'answers[0].valuePercent', displayName: 'Rural', enableCellEdit: true, editableCellTemplate: cellEditableTemplate}
    ]
};

// Update Entity on the server side
$scope.updateEntity = function(column, row) {
    console.log(row.entity);
    console.log(column.field);

    // code for saving data to the server...
    // row.entity.$update() ... <- the simple case

    // I have nested Entity / data in the row <- the complex case
    // var answer = new Answer(question.answers[answerIndex]); // answerIndex is computed with "column.field" variable
    // answer.$update() ...
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-12-06T02:06:59.517

我花了一些时间为 ng-grid 2.x 整理了这些内容。我仍然有一个问题，必须单击两次才能编辑一行，但我认为这是一个引导问题，而不是 ngGrid 问题，它不会发生在我的示例代码中（它还没有引导）。

我还在 ui-grid 3.0 的教程中实现了类似的逻辑，它仍然是测试版，但很快就会成为首选版本。这可以在以下位置找到：[http](http://technpol.wordpress.com/2014/08/23/upgrading-to-ng-grid-3-0-ui-grid/) ://technpol.wordpress.com/2014/08/23/upgrading-to-ng-grid-3-0-ui-grid/ ，并为此功能提供了更简单、更清洁的 api .

对于 2.x 版本，为了说明所有内容，我创建了一个正在运行的 plunker，它有一个带有下拉列表和输入字段的可编辑网格，使用 ngBlur 指令，并使用 $timeout 来避免重复保存更新：[http ://plnkr.co/edit/VABAEu?p=preview](http://plnkr.co/edit/VABAEu?p=preview)

代码的基本内容是：

```
var app = angular.module('plunker', ["ngGrid"]);

app.controller('MainCtrl', function($scope, $timeout, StatusesConstant) {
  $scope.statuses = StatusesConstant;
  $scope.cellInputEditableTemplate = '<input ng-class="\'colt\' + col.index" ng-input="COL_FIELD" ng-model="COL_FIELD" ng-blur="updateEntity(row)" />';
  $scope.cellSelectEditableTemplate = '<select ng-class="\'colt\' + col.index" ng-input="COL_FIELD" ng-model="COL_FIELD" ng-options="id as name for (id, name) in statuses" ng-blur="updateEntity(row)" />';

  $scope.list = [
    { name: 'Fred', age: 45, status: 1 },
    { name: 'Julie', age: 29, status: 2 },
    { name: 'John', age: 67, status: 1 }
  ];

  $scope.gridOptions = {
    data: 'list',
    enableRowSelection: false,
    enableCellEditOnFocus: true,
    multiSelect: false, 
    columnDefs: [
      { field: 'name', displayName: 'Name', enableCellEditOnFocus: true, 
        editableCellTemplate: $scope.cellInputEditableTemplate },
      { field: 'age', displayName: 'Age', enableCellEdit: false },
      { field: 'status', displayName: 'Status', enableCellEditOnFocus: true, 
        editableCellTemplate: $scope.cellSelectEditableTemplate,
        cellFilter: 'mapStatus'}
    ]
  };

  $scope.updateEntity = function(row) {
    if(!$scope.save) {
      $scope.save = { promise: null, pending: false, row: null };
    }
    $scope.save.row = row.rowIndex;
    if(!$scope.save.pending) {
      $scope.save.pending = true;
      $scope.save.promise = $timeout(function(){
        // $scope.list[$scope.save.row].$update();
        console.log("Here you'd save your record to the server, we're updating row: " 
                    + $scope.save.row + " to be: " 
                    + $scope.list[$scope.save.row].name + "," 
                    + $scope.list[$scope.save.row].age + ","
                    + $scope.list[$scope.save.row].status);
        $scope.save.pending = false; 
      }, 500);
    }    
  };
})

.directive('ngBlur', function () {
  return function (scope, elem, attrs) {
    elem.bind('blur', function () {
      scope.$apply(attrs.ngBlur);
    });
  };
})

.filter('mapStatus', function( StatusesConstant ) {
  return function(input) {
    if (StatusesConstant[input]) {
      return StatusesConstant[input];
    } else {
      return 'unknown';
    }
  };
})

.factory( 'StatusesConstant', function() {
  return {
    1: 'active',
    2: 'inactive'
  };
}); 
```

当你运行这个 plunker 并且失去焦点触发时，你应该在控制台上看到更新触发器触发。

我还在 plunker 中包含了一个 README.md，其中包含对给我带来困难的事情的一些想法，在此处复制。

这里的功能是我有一个人员列表，这些人有姓名、年龄和状态。与我们在真实应用中可能执行的操作一致，状态是一个代码，我们想要显示解码。因此，我们有一个状态码列表（在真实的应用程序中可能来自数据库），我们有一个过滤器将代码映射到解码。

我们想要的是两件事。我们希望能够在输入框中编辑名称，并在下拉列表中编辑状态。

评论我在这个 plunk 上学到的东西。

1.  在 gridOptions 级别，有 enableCellEditOnFocus 和 enableCellEdit。不要同时启用，你需要选择。onFocus 表示单击，CellEdit 表示双击。如果您同时启用两者，那么您会在您不想编辑的网格位上出现意外行为

2.  在 columnDefs 级别，您有相同的选项。但是这一次您需要同时设置 CellEdit 和 onFocus，并且您需要在您不想编辑的任何单元格上将 cellEdit 设置为 false - 这不是默认设置

3.  文档说您的可编辑单元格模板可以是：

    <input ng-class="'colt' + col.index" ng-input="COL_FIELD" />

    实际上它需要是：

    <input ng-class="'colt' + col.index" ng-input="COL_FIELD" ng-model="COL_FIELD" />

4.  为了在我们失去焦点时触发保存事件，我们创建了一个模糊指令，我在 stackoverflow 中找到了它的逻辑：[AngularJS 和 ng-grid - 在单元格更改后自动将数据保存到服务器](https://stackoverflow.com/questions/15647981/angularjs-and-ng-grid-auto-save-data-to-the-server-after-a-cell-was-changed)

5.  这也意味着将每个可编辑单元格模板更改为调用 ng-blur，您可以在可编辑单元格模板的末尾看到

6.  当我们离开现场时（至少在 Chrome 中），我们得到了两个模糊事件，所以我们使用了一个计时器，以便只处理其中一个。丑陋，但它的工作原理。

我还创建了一篇博客文章，对这段代码进行了更彻底的演练：http: [//technpol.wordpress.com/2013/12/06/editable-nggrid-with-both-dropdowns-and-selects/](http://technpol.wordpress.com/2013/12/06/editable-nggrid-with-both-dropdowns-and-selects/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-04-21T01:01:36.163

如果您使用的是 UI Grid 3.0，则该事件是：**uiGridEventEndCellEdit**

```
$scope.$on('uiGridEventEndCellEdit', function (data) {
    console.log(data.targetScope.row.entity);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-08-01T00:02:06.960

这是对有一些缺陷的答案的改进： - 它触发了一个 JS 异常，如答案的评论之一所示 - 单元格中的数据输入未保留在网格中 - updateEntity 方法没有说明如何保存输入数据

为了删除异常，创建一个范围属性并将其添加到 cellEditableTemplate：

```
$scope.cellValue;
...
var cellEditableTemplate = "<input style=\"width: 90%\" step=\"any\" type=\"number\" ng-class=\"'colt' + col.index\" ng-input=\"COL_FIELD\" ng-blur=\"updateEntity(col, row, cellValue)\" ng-model='cellValue'/>"; 
```

请注意，对 updateEntity 的 ng-blur 调用现在包含*cellValue*作为参数。接下来，更新 updateEntity blur 处理程序以包含参数并更新网格：

```
$scope.updateEntity = function(column, row, cellValue) {
    console.log(row.entity);
    console.log(column.field);
    row.entity[column.field] = cellValue;

    // code for saving data to the server...
    // row.entity.$update() ... <- the simple case

    // I have nested Entity / data in the row <- the complex case
    // var answer = new Answer(question.answers[answerIndex]); // answerIndex is computed with "column.field" variable
    // answer.$update() ...
}; 
```

我现在能够在屏幕上看到更改以及触发基于单元的后端更新。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-10-09T15:51:16.167

正如 PaulL 在评论之一中提到的，ui-grid 现在具有 rowEdit 功能，旨在允许在完成编辑时保存整行。请参阅[http://ui-grid.info/docs/#/tutorial/205_row_editable](http://ui-grid.info/docs/#/tutorial/205_row_editable)。

# macos - TideSDK Mac 上的 CSS3 转换属性

> ID：15647984
> 
> 赞同：0
> 
> 时间：2013-03-26T21:45:52.393
> 
> 标签：macos, css, css-transitions, tidesdk

我正在构建一个我想在 mac 和 windows 上运行的应用程序。我将 CSS3 用于此应用程序的样式和 UI。我正在使用 selector:hover {transform : scale(1.5,1.5)} 来处理我的应用程序的某些图像，这在 Windows 上工作得非常好，但是当我尝试在潮汐 sdk mac 上创建相同的悬停效果时，我没有得到适当的 CSS3 效果。有谁知道这是什么原因？为什么在 windows 上运行得很好的东西在 mac 版的潮汐 sdk 上却不能运行？是因为他们使用不同的 web-kit 还是其他原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T13:35:02.613

你说的对 ！windows linux 和 osx 上的 webkit 实现是完全不同的。

1）windows：我们使用webkit的WinCairo端口。2) Linux：我们使用 GTK 版本的 webkit。3) osx：我们使用 webkit 的 safari 版本（本机）。

除此之外，TideSDK 中的 webkit 已经有 2 年多的历史了。这就是您在不同平台上的行为略有不同的原因。

# ios - Localizable.strings 导致 plist 解析错误

> ID：15647987
> 
> 赞同：18
> 
> 时间：2013-03-26T21:46:08.780
> 
> 标签：ios, objective-c, localization, nsstring, plist

我刚刚在我的 Xcode 项目中本地化了 Localizable.strings 文件，以便将我的应用程序本地化为几种不同的语言。但是，在以标准“key = value”格式编辑每个文件后，我收到以下解析错误，它没有指定一个文件，因此很难追踪它所指的内容。

> CFPropertyListCreateFromXMLData()：旧式 plist 解析器：第 10 行的字典中缺少分号。将放弃解析。中断 _CFPropertyListMissingSemicolon 进行调试。

我查看了每个 *.strings 文件，特别是在第 10 行，但我没有发现任何有趣或关于导致问题的原因。请你能告诉我哪里出错了。

这是我项目中 Localizable.strings 文件的示例。所有其他文件都遵循相同的格式。

```
"Enter URL" = "Voer adres in"
"Headers" = "Koppen"
"Key" = "sleutel"
"Value" = "waarde"
"Parameters" = "Parameters"
"Tap to add a new line" = "Tik om een nieuwe lijn toe te voegen"
"Perform request" = "Verzoek Uitvoeren"
"Response" = "Antwoord"
"Received Headers" = "Ontvangen Koppen"
"Error" = "Fout"
"Loading" = "Verzoek aan het versturen" 
```

然后我`NSLocalizedString()`用来提供翻译后的字符串。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-03-26T21:47:47.303

如错误消息中所述，您在每行末尾缺少分号。

```
"foo" = "bar"; 
```

格式是否正确

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-05T21:24:42.830

```
"Enter URL" = "Voer adres in";
"Headers" = "Koppen";
"Key" = "sleutel";
"Value" = "waarde";
"Parameters" = "Parameters";
"Tap to add a new line" = "Tik om een nieuwe lijn toe te voegen";
"Perform request" = "Verzoek Uitvoeren";
"Response" = "Antwoord";
"Received Headers" = "Ontvangen Koppen";
"Error" = "Fout";
"Loading" = "Verzoek aan het versturen"; 
```

这是正确的公式

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-23T19:47:53.687

由于在行尾使用 :(colon) 而不是 ;(semicolon) 也可能会出现此消息。请确保在每一行的末尾都有分号（;），并且也没有冒号（:)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-02T17:22:51.983

# 斯威夫特 4

确保 Localizable.strings 的所有应用程序文件的一个不超过一页只有一页

### local.string 英文 "hi" = "hi";

### local.string 阿拉伯语 "hi" = "هاي";

## 使用

并将此扩展程序放入您的应用程序中

```
extension String {
    var localizedLized: String {
        return NSLocalizedString(self, comment: "")
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-29T15:43:22.510

在我的情况下，错误是由缺少引号引起的。

```
"CFBundleDisplayName" = myTestApp"; 
```

# r - .onLoad 和 gWidgets R - 包构建中的错误

> ID：15647991
> 
> 赞同：1
> 
> 时间：2013-03-26T21:46:22.720
> 
> 标签：r, user-interface, tk, gwidgets

我刚刚为一位同事完成了另一个 R 工具，并完成了一个简单的 gWidgets GUI 来配合它。但是我无法让它在包加载时出现：

构建包时的错误立即出现在 .onLoad 函数中，只要在我的系统上调用 gwindow，即使是以下代码片段也会在我构建包二进制文件时导致错误 - 更不用说我的完整 gui：

```
.onLoad <- function(...){

  MainWindow <- gwindow("My GUI Window!", visible=TRUE)

}

call: function (classes, fdef, mtable) 
      error: unable to find an inherited method for function '.gwindow' for signature '"NULL"'
    Error: loading failed
    Execution halted
    ERROR: loading failed 
```

我检查了 Rcmdr 的源文件 - 在 .onLoad() 函数的代码中调用了 tcltk 对象/小部件，因此我认为将我的 gui 的代码放在 onload 函数中将是可行的方法。我确保导入 gWidgets 和 gWidgetstcltk（我在 Windows 上）。

# r - 在 R 中传递一个缺失的参数

> ID：15647994
> 
> 赞同：4
> 
> 时间：2013-03-26T21:46:33.350
> 
> 标签：r

我正在 R 中编写一个函数，除其他外，它基于列名向量对数据框进行子集化。我正在尝试利用默认行为，`[.data.frame`如果缺少“j”参数，它将返回所有列。有没有办法通过我的包装函数传递缺少的参数？这是一个简单的例子：

```
fixDataFrames <- function(listOfDataFrames, columns){
    lapply(listOfDataFrames, function(x) x[,columns])
} 
```

如果我没有为列指定值，则在将其传递给`[`函数时会出现错误：“缺少列参数，没有默认值”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-26T22:00:00.363

您可以为列设置默认值，这样如果没有提供任何内容，它就会抓取所有列。使用 TRUE 应该可以

```
fixDataFrames <- function(listOfDataFrames, columns = TRUE){
    lapply(listOfDataFrames, function(x) x[,columns])
}

# As Chase points out it is probably more prudent to add drop=FALSE as a parameter
fixDataFrames <- function(listOfDataFrames, columns = TRUE, drop = FALSE){
    lapply(listOfDataFrames, function(x) x[, columns, drop = drop])
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T22:17:37.667

一个稍微不同的策略是没有匿名函数并`[`直接调用。

```
fixDataFrames <- function(listOfDataFrames, columns = TRUE, drop = TRUE){
    lapply(listOfDataFrames, `[`, , j = columns, drop = drop)
} 
```

请注意，两者之间的空格`,`很**重要**，因为它表示`i`行索引的空间。通过留下这个缺失，我们得到与 相同的行为`df[ , columns]`。我也将其设置`drop = TRUE`为默认值，`[`因此乐趣保持行为。

使用来自@Chase 答案的相同数据：

```
## Sample data
df1 <- df2 <- data.frame(x1 = rnorm(10), x2 = rnorm(10), x3 = rnorm(10))
listOfDataFrames <- list(df1, df2)

fixDataFrames(listOfDataFrames)
fixDataFrames(listOfDataFrames, 2)
fixDataFrames(listOfDataFrames, 2, drop = FALSE) 
```

给予

```
> fixDataFrames(listOfDataFrames)
[[1]]
            x1          x2          x3
1  -1.98347150 -0.50473182  0.56554491
2  -0.19597580  0.41004825 -0.35646296
3   0.81792146 -0.07646175 -2.02534426
4  -0.01903514  0.70687248 -0.25373188
5  -0.49233958  0.42497338 -0.15647100
6   0.62296268  1.88127659  0.41952414
7  -0.27260248 -2.59046602 -1.99294060
8   1.46344557  1.44803287  0.08634971
9   0.62207040  1.78290849 -0.17131320
10 -1.05730518 -0.45478467  1.15346862

[[2]]
            x1          x2          x3
1  -1.98347150 -0.50473182  0.56554491
2  -0.19597580  0.41004825 -0.35646296
3   0.81792146 -0.07646175 -2.02534426
4  -0.01903514  0.70687248 -0.25373188
5  -0.49233958  0.42497338 -0.15647100
6   0.62296268  1.88127659  0.41952414
7  -0.27260248 -2.59046602 -1.99294060
8   1.46344557  1.44803287  0.08634971
9   0.62207040  1.78290849 -0.17131320
10 -1.05730518 -0.45478467  1.15346862

> fixDataFrames(listOfDataFrames, 2)
[[1]]
 [1] -0.50473182  0.41004825 -0.07646175  0.70687248  0.42497338  1.88127659
 [7] -2.59046602  1.44803287  1.78290849 -0.45478467

[[2]]
 [1] -0.50473182  0.41004825 -0.07646175  0.70687248  0.42497338  1.88127659
 [7] -2.59046602  1.44803287  1.78290849 -0.45478467

> fixDataFrames(listOfDataFrames, 2, drop = FALSE)
[[1]]
            x2
1  -0.50473182
2   0.41004825
3  -0.07646175
4   0.70687248
5   0.42497338
6   1.88127659
7  -2.59046602
8   1.44803287
9   1.78290849
10 -0.45478467

[[2]]
            x2
1  -0.50473182
2   0.41004825
3  -0.07646175
4   0.70687248
5   0.42497338
6   1.88127659
7  -2.59046602
8   1.44803287
9   1.78290849
10 -0.45478467 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T21:55:27.447

这似乎是一种 hack，但设置第二个参数`...`允许这种行为：

```
#Sample data
df1 <- df2 <- data.frame(x1 = rnorm(10), x2 = rnorm(10), x3 = rnorm(10))
listOfDataFrames <- list(df1, df2)

fixDataFrames <- function(listOfDataFrames, ...){
  lapply(listOfDataFrames, function(x) x[,...])
}

> fixDataFrames(listOfDataFrames)
[[1]]
           x1         x2         x3
1  -1.7475354 -1.3444461  0.2049100
2   0.1451163  1.4396253  0.5885829
...
[[2]]
           x1         x2         x3
1  -1.7475354 -1.3444461  0.2049100
2   0.1451163  1.4396253  0.5885829 
```

如果选择了单个列，您可能还需要添加`, drop = FALSE`以防止 data.frame 被强制转换为向量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T21:51:06.553

This is untested but try:

```
fixDataFrames <- function(listOfDataFrames, columns){
    lapply(listOfDataFrames, function(x) 
        if (missing(columns)) {
            columns <- 1:ncol(x)
        }
        x[,columns]
    )
} 
```

# css - 固定 div 旁边的居中 div

> ID：15647996
> 
> 赞同：3
> 
> 时间：2013-03-26T21:46:48.103
> 
> 标签：css, css-position

我有一个网页，其中有可滚动的内容。此内容包含在#content 中，它以页面为中心。现在我想要一个导航栏出现在内容左侧 50 像素处。这个栏应该有一个固定的位置（不应该滚动）。

这是我到目前为止所尝试的：

```
#nav {
position: fixed;
top: 50%;
margin-top:-200px;
left:15%;
background: #FFF;
width: 100px;
height:400px;
border-radius: 50px;
}

#content {
position: relative;
width: 800px;
margin: 0px auto;
padding-top: 100px;
} 
```

这显然不是我想要的，因为现在导航距离屏幕左侧 15%。

这是一张图片来说明我想要实现的目标。 ![绘制示例](../Images/e6dd14bd0f1672436086de497b4cb0c0.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T21:58:19.503

有一个有点棘手的解决方案。元素`position: fixed`总是相对于浏览器窗口（更多更少）。这意味着它总是会忽略它的父尺寸和位置，即使有`position: relative`设置。**解决方案**是根本不设置`left`。

这是您需要做的： **HTML**

```
<div class="content">
  <div class="fake">
    <div class="nav"></div>
  </div>
  content
</div> 
```

**CSS**

```
.fake {
  position: absolute;
  left: -50px;
  top: 0;
}
.nav {
  position: fixed;
  top: 50px;
  width: 40px;
  height: 100px;
  background: #c11;
}
.content {
  position: relative;
  width: 800px;
  height: 1000px;
  margin: 0px auto;
  background: #ccc;
} 
```

[工作示例。](http://codepen.io/anon/pen/tKxdL)

当然，有些值只是为了展示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T21:58:28.437

我已经找到了解决方案。

```
#nav{ 
left:50%; 
margin-left:-550px;
} 
```

我只是给了它 left:50% 和一个内容宽度的一半 + 50px + 导航栏宽度的左边距。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T21:53:46.420

只是放在`nav`里面`content`

```
<div id="content">
  <div id="nav"></div>
   .....
     ......

</div> 
```

然后

```
#nav {
position: fixed;
top: 50%;
margin-top:-200px;
left:-100px;
background: #FFF;
width: 100px;
height:400px;
border-radius: 50px;
} 
```

# couchdb - 沙发数据库：checkpoint_commit_failure

> ID：15647998
> 
> 赞同：1
> 
> 时间：2013-03-26T21:46:56.377
> 
> 标签：couchdb

我有一个在亚马逊 ec2 实例上运行的 couchDB 服务器。它是 1.2.0 的股票，来自 rpm。

我还有几个运行 couchbase-mobile-2.0 的 android 设备。

这些设备从服务器启动连续推送和拉取复制。所有这些设备都应该最终保持一致。

但是，当其中一台移动设备推送文档时，当另一台移动设备尝试拉取此文档时，我在设备日志中收到以下错误：

```
 E/CouchDB(9896): [error] [<0.199.0>] Replication `bf69ede4416770a1fef28ffb4c4e6950+continuous` (`treatment` -> `http://portecTest:*****@50.150.250.165:5984/treatment/`) failed: {checkpoint_commit_failure,<<"Error updating the target checkpoint document: conflict">>} 
```

该应用程序的设计方式是该文档不会被其他设备或服务器编辑，因此它不是修订冲突。

在此之后，在我重新启动应用程序之前，不会再复制、推送或拉取文档。（连续复制在应用启动时初始化）。重新启动后，它可以工作。

这是什么意思？有什么想法可能导致它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T12:10:08.827

由于复制 ID 冲突，我以前见过这种情况。

当您在_replicator 数据库中设置复制时，`_replication_id`会向文档中添加一个字段（例如，bf69ede4416770a1fef28ffb4c4e6950+continuous，用于您当前的复制）。复制过程本身使用它来跟踪复制过程，方法是在复制的`http://server:5984/dbname/_local/replication-id`两端管理文档，并在那里记录最后看到的序列号等内容。

这也用于发现您是否设置了两个复制来执行相同的操作，因为 id 完全由参数生成，因此具有相同目标和源且没有其他选项的两个复制将具有相同的 id。

我不完全确定 replication_id 是如何生成的（也许某处有某种种子？）但我肯定遇到过问题，之前它在所涉及的每台机器上都以相同的方式生成（它们都有相同的复制文档，如`{source:localDb, target:remoteServer:5984/remoteDb}`） ，因此他们都尝试使用相同的 db/_local/id 文档，然后引发大量冲突，因为他们都在同时更改远程服务器上的同一个文档。

**您可以通过比较两个移动设备上的 _replication_id 字段并查看它们是否相同来检查这是否是问题所在**。

我通过在源中包含本地机器的地址来解决这个问题，这样每个 id 都不同，冲突就消失了。但是，这对您使用移动设备可能不切实际，除非您可以在每台移动设备上获得一致的本地地址（某些生成的主机名？）。我找不到任何手动设置replication_id 的方法。

如果这是问题所在，解决方案基本上是使每个复制文档以某种方式与其他文档不同。你能以某种方式在每个移动设备上为数据库命名不同的东西吗？

# java - 使用 Hazelcast (Java) 时存储 CONCURRENT_MAP_REMOVE 引发的异常

> ID：15647999
> 
> 赞同：0
> 
> 时间：2013-03-26T21:46:58.983
> 
> 标签：java, hazelcast

我在集群中使用 hazelcast -2.5。我正在尝试在我的 Hazelcast 映射（字符串，ArrayList）的存储加载实现中加载用户定义对象的 ArrayList（带有几个字符串字段和一个整数）。初始加载都没有给我任何例外。但是，如果由于在地图上对地图中没有值的键的 get 调用调用了加载（因此调用了加载），我会看到以下异常被抛出（我也在做一个删除在该时间点之后的地图上的操作）：

```
Store thrown exception for CONCURRENT_MAP_REMOVE 
```

它给了我一个类转换异常，说明我的 UD 对象不能转换为字符串。如果我在实现中遗漏了某些内容，我不会感到惊讶——只是在进行此调用时，我试图在地图上执行 get 操作并将结果分配给用户定义对象的 ArrayList。store-load 中的加载操作也返回一个用户定义对象的 ArrayList（store-load 的声明方式相同）。

```
WARNING: [192.168.1.1]:5703 [dev] Store thrown exception for CONCURRENT_MAP_REMOVE
java.lang.ClassCastException: models.test.TestClass cannot be cast to java.lang.String
    at models.test.StoreLoadTestMap.load(StoreLoadTestMap.java:1)
    at com.hazelcast.impl.concurrentmap.MapStoreWrapper.load(MapStoreWrapper.java:143)
    at com.hazelcast.impl.ConcurrentMapManager$RemoveOperationHandler$RemoveLoader.doMapStoreOperation(ConcurrentMapManager.java:2681)
    at com.hazelcast.impl.ConcurrentMapManager$AbstractMapStoreOperation.run(ConcurrentMapManager.java:3860)
    at com.hazelcast.impl.executor.ParallelExecutorService$ParallelExecutorImpl$ExecutionSegment.run(ParallelExecutorService.java:212)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:662)
    at com.hazelcast.impl.ExecutorThreadFactory$1.run(ExecutorThreadFactory.java:38) 
```

关于解决此问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T19:33:38.133

如果从 hazelcast 加载操作（在存储加载实现中）返回的 arraylist 为空，您似乎会收到此异常。