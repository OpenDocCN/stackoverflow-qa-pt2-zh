# StackOverflow 问答 13479000-13479999

# git - Git - 分离头、修改提交和推送时落后的问题？

> ID：13479007
> 
> 赞同：1
> 
> 时间：2012-11-20T17:46:08.903
> 
> 标签：git, push, pull, git-submodules, git-amend

我们的团队正在使用 git 子模块，但是我们在 pull 时遇到了一些错误，这告诉我们即使我们最近更新了（并且从那以后没有远程提交/推送），我们还是落后了。这发生在两种情况下：

1.  在我们的子模块中分离`HEAD`，或
2.  使用时`git commit --amend`。

我将尝试展示这些事情发生的场景。我的问题是，有谁知道具体错误在哪里，以及修复它们的简单方法（比我们的肮脏黑客更好）？

**场景 1 - 分离式`HEAD`**

1.  我们发行：
    1.  `git clone --recursive $REPO $DIR`
    2.  `git sfe 'git pull origin master'`
    3.  `git submodule update --recursive`- 我们实际上并没有使用这么多，因为它往往使我们处于分离`HEAD`状态
2.  我们检查所有分支是否都打开`master`（或至少不处于分离`HEAD`状态）`git sfe 'git branch'`。如果没有，我们发出一个`git sfe 'git checkout master'`. （我们目前都（约 4 人）在 master 上开发，只是为了尽量减少合并和启动和运行）
3.  如果我们处于 detached `HEAD`，进行更改，然后切换到`master`（因此我们的未暂存文件保留在工作目录中），暂存并提交这些更改，然后尝试推送，Git 说我们必须拉动，因为我们落后了。我们可以通过以下方式解决这个问题：
    *   说“拧它”，检查一个完全干净的超级模块，确保我们没有处于分离状态`HEAD`，然后从那里开始工作
    *   获取修订号，`git checkout master`然后发出 a`git merge $REV`并经历重新合并当前更改与似乎存在的过去更改冲突的痛苦。

**场景 2 - 修改提交**

1.  这个不多。我将自己开发，发布 a `git commit --amend`，然后尝试推动这些更改。但是，当我这样做时，它告诉我我落后了，必须合并。当我这样做时，将所有当前更改与过去的修订重新合并，这又是一个痛苦的过程。
    *   这是因为我试图推送基于不再是的提交的东西`HEAD`吗？

*注意*：`git sfe`是我们的别名`git submodule foreach --recursive`（我们有一些嵌套的子模块，只是为了自虐[或者更确切地说，我们需要能够将代码分离出来并且子子模块的放置是有意义的事实]）

# video - 通过 Android 意图调用/调用 Kindle Fire 的本机 AwesomePlayer - 可能吗？

> ID：13479011
> 
> 赞同：2
> 
> 时间：2012-11-20T17:46:27.917
> 
> 标签：video, youtube, kindle-fire

我正在尝试在 Kindle Fire HD 上播放 YouTube 视频。在常见的 Android 设备上很简单，因为 Intent.ACTION_VIEW 调用预安装的 YouTube 应用程序。根据日志，在缺少 YouTube 应用程序的 Kindle 上，Intent.ACTION_VIEW 调用加载 YouTube 页面的本机 Silk 浏览器，当单击播放按钮（与视频缩略图重叠）时，Kindle 将调用本机 AwesomePlayer .

11-20 11:23:45.392: I/AwesomePlayer(107): Awsomeplayer 已创建

...

11-20 11:23:46.431: D/AwesomePlayer(107): Mime = video/avc

11-20 11:23:46.431: D/AwesomePlayer(107): Mime = 音频/mp4a-latm

11-20 11:23:46.431: D/AwesomePlayer(107): getTrackAudioVideoProfile audioOrVideo=2

11-20 11:23:46.431: D/AwesomePlayer(107): 播放 - 音频/视频

...

我想绕过 Silk 浏览器，直接从我的 android 活动中启动 Kindle 的原生“AwesomePlayer”。那可能吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-09T16:02:46.617

以下是来自亚马逊的回答：

您无法绕过 Silk Web 浏览器，直接调用“Awesomeplayer”组件在 Kindle Fire HD 上播放 Youtube 视频。

问题是您无权访问实际的 Youtube 视频文件 - 您有一个指向播放视频文件的页面的链接。如果没有视频文件本身的路径，则无法直接在视频文件上调用播放器。因此，在没有 Youtube 应用程序的情况下，您需要调用 Silk Web 浏览器。

希望这些信息对您有所帮助。

请参阅[http://forums.developer.amazon.com/forums/thread.jspa?threadID=459](http://forums.developer.amazon.com/forums/thread.jspa?threadID=459)

# iphone - Objective C：类接口中的 C int 数组？

> ID：13479012
> 
> 赞同：0
> 
> 时间：2012-11-20T17:46:30.040
> 
> 标签：iphone, objective-c, c, arrays, interface

我试图`int`在我的类接口中将 C 数组定义为实例变量，以便类中的任何方法都可以访问它。

写累了

```
@interface aVCofMine : UIViewController{
   int[] myArray;
} 
```

和

```
@interface aVCofMine : UIViewController{
   int myArray[];
} 
```

但无济于事。

实际上是否可以将 C 数组 [而不是 NSArray] 定义为类接口中的实例变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T17:55:34.597

C 数组需要动态分配或固定大小。所以你可以这样做：

```
@interface AVCOfMine : NSViewController {
    int myArray[5];
}
@end 
```

或者你可以做

```
@interface AVCOfMine : NSViewController {
    int *myArray;
}
@end

@implementation AVCOfMine

- (void)viewDidLoad {
    myArray = malloc(sizeof(int) * 5);
}

- (void)dealloc {
    free(myArray);
    [super dealloc]; // include this line only if not using ARC
}
@end 
```

前者强制数组始终具有相同的大小。后者允许您在运行时选择大小，但显然要复杂一些。哪个更好取决于情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T17:50:17.757

采用

```
@interface aVCofMine : UIViewController{
   int *myArray;
} 
```

然后，在您的实现代码中，为了实际为您的数组分配内存：

```
myArray = malloc(sizeof(int) * numberOfElements); 
```

记得释放它`free(myArray);`

# python - 使用 Python 和 Flask 长时间运行的任务

> ID：13479013
> 
> 赞同：2
> 
> 时间：2012-11-20T17:46:35.440
> 
> 标签：python, flask

我有一个相当大的数据库导入作业，我从 Web 界面（Flask）开始。在访问触发数据库导入的 URL 时，我在进行数据库插入之前分叉。

问题是，当我尝试停止 Web 服务（内置开发服务器上的 Ctrl+C）时，子进程反而停止，并且 Web 服务器继续在后台运行。不知何故，似乎 Web 服务器作业突然被推为后台守护进程，而子进程现在是主进程。

我想要实现的是一种“启动子进程然后忘记它”的方法，其中 Web 服务器只是启动子进程，然后再也不会打扰它，尤其是在涉及异常和类似情况时。

关于如何最好地解决这个问题的任何想法？

目前导入功能的测试代码为：

```
def import_start():
    try:
            pid = os.fork()
    except OSError as e:
            print "Exception in import_start"
            sys.exit(1)
    if pid == 0:
          with open("/tmp/web_out.txt", "w") as f:
                for x in range(100):
                      f.write("line %d\n" % (x))
                      f.flush()
                      sleep(10) 
```

代码在烧瓶路由处理程序中启动：

```
import_start() 
```

之后使用 Ctrl+C 将终止 import_start() 进程而不是 Web 服务器。我希望它是相反的，因为这两个进程在启动后应该完全独立。

更新：

我最终做了：

```
def start_import():
            subprocess.Popen([sys.executable,__file__],stdout=subprocess.PIPE,stderr=subprocess.STDOUT)

def do_import():
    with open("/tmp/web_out.txt", "w") as f:
            for x in range(100):
                    f.write("line %d\n" % (x))
                    f.flush()
                    sleep(10)

if __name__ == "__main__":
    do_import() 
```

这有效（除了在我的网络服务器被杀死时杀死生成的进程），但我有点担心不以某种方式清理进程。我可能会研究 MQ 方法来解决这个问题，尽管这比仅仅产生一个新进程需要更多的复杂性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T17:54:11.540

也许[python-daemon](http://pypi.python.org/pypi/python-daemon/)可以提供帮助。这主要用于启动一个python程序作为守护进程。Afaik 它具有双叉魔法并将进程与当前进程分离。

# ruby-on-rails - Rails 3：复杂的创建函数

> ID：13479018
> 
> 赞同：1
> 
> 时间：2012-11-20T17:46:48.243
> 
> 标签：ruby-on-rails, ruby-on-rails-3, controller, nested-forms

我有一个嵌套表单，它通过我的“帖子”控制器中的创建函数提交。一个帖子有很多位置。我的问题是我想将位置设置为“Find_Or_Create_by_name”，而不是帖子。

我认为这样的解决方案是：

**post_controller.rb**

```
def create
  @post = current_blogger.blog_posts.new(params[:post])    
  @post.locations = Location.find_or_create_by_name(params[:post])

  if @post.save
    redirect_to @post, notice: 'Blog post was successfully created.'
  else
    render action: "new"
  end
end 
```

但我得到一个“每个”错误。

```
 undefined method `each' for #<Location:0x007fc5c1c2e5c8> 
```

我在正确的轨道上吗？下一步是什么？我应该遍历每个“位置”吗？

任何帮助都会很棒。

编辑：这是日志：

```
Parameters: {"utf8"=>"✓",     authenticity_token"=>"Ffk65s3/aZqVcBvh9S/hOt7zYSighzyt6CSNDIuNt1Q=", "post"=>{"title"=>"This
  is about London", "body"=>"This is about London", "tag_list"=>"", "locations_attributes"=>
  {"0"=>{"_destroy"=>"false", "name"=>"London", "longitude"=>"-0.1276831", "la
  titude"=>"51.5073346"}}}, "_wysihtml5_mode"=>"1", "name"=>"London", "legname"=>"London",
 "longitude"=>"-0.1276831", "latitude"=>"51.5073346", "commit"=>"Submit"} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:06:52.373

在您的位置模型中

```
def self.find_or_initialize_location_set(location_set)
  locations = []
  location_set.each do |key, location|
    locations << find_or_initialize_by_name location
  end
  locations
end 
```

然后在您的创建操作中

```
def create
  location_set = params[:post].delete(:locations_attributes) unless params[:post][:locations_attributes].blank?
  @post = current_blogger.blog_posts.new(params[:post])
  @post.locations = Location.find_or_initialize_location_set(location_set) unless location_set.nil?
  if @post.save
    redirect_to @post, notice: 'Blog post was successfully created.'
  else
    render action: "new"
  end 
```

结尾

# java - 双重检查锁定从检查样式中消失了-为什么？

> ID：13479021
> 
> 赞同：3
> 
> 时间：2012-11-20T17:46:56.200
> 
> 标签：java, checkstyle, double-checked-locking

从[发行说明](http://checkstyle.sourceforge.net/releasenotes.html)中，checkstyle 删除了双重检查锁定检查。

我很难理解为什么。他们不仅在发行说明中而且在[问题跟踪器](http://sourceforge.net/p/checkstyle/feature-requests/603/)中都回答了这个问题：

> 删除了 DoubleCheckedLocking 检查，就像在 Java 5（及更高版本）中一样，使用 volatile 关键字解决了这个问题。

我假设，如果 checkstyle 正在删除此警告，那是因为它不再有用。也就是说，要么错误不再发生，要么另一个警告完成了这项工作。但

我不明白为什么 Java 5 中不会再发生这样的错误，或者它是如何被另一个警告补充的。有人可以解释一下吗？

编辑：我了解添加 volatile 关键字如何解决问题。我担心的是：这个警告难道不值得吗？我正在考虑程序员使用上述锁定模式但忘记声明变量 volatile 的情况。checkstyle 不应该仍然警告它吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T17:50:23.400

描述几乎解释了这个决定。从 Java 1.5 开始，您可以使用`volatile`实例变量。它将正确处理内存可见性问题，并且使用双重检查锁定不再是一个错误。

这并不意味着使用`volatile`就是解决方案。但是在 1.5 Java Memory Model 被重新定义，使得`volatile`足够了。

# 也可以看看

*   [*“双重检查锁定被破坏”声明*](http://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html)

# c# - 在这种情况下使用哪个计时器

> ID：13479022
> 
> 赞同：1
> 
> 时间：2012-11-20T17:46:59.560
> 
> 标签：c#

我有`do/while`以下类似：

```
do {

  //1.look for a report

  //2.either use interops to run an xl macro report or run a batch file report or run vbs file report

  //3.then sleep/pause program for 150seconds 

} while (look for next report to run) 
```

这都是一个`Console`应用程序。

如何创建 150 秒暂停/睡眠？第 2 步可能涉及运行各种进程，我有点担心简单地使用`Thread.Sleep`可能会很麻烦，因为它不是线程安全的。

* * *

我是否应该以某种方式将这种代码放入结构中，即将步骤 1 和 2 放入`CallMeBack`方法中？

```
static void Main(string[] args) {
    var t = new System.Timers.Timer(1000);
    t.Elapsed += (s, e) => CallMeBack();
    t.Start();

    Console.ReadLine();
}
public static void CallMeBack() {

    //1.look for a report
    //2.either use interops to run an xl macro report or run a batch file report or run vbs file report

    Console.WriteLine("Doing some consuming time work using sleep");
} 
```

（以上取自[这里](https://stackoverflow.com/questions/2430930/c-sharp-how-to-pause-suspend-a-thread-then-continue-it)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T17:54:25.187

使用[计时器](http://msdn.microsoft.com/en-us/library/system.timers.timer(v=vs.110).aspx)而不是循环。步骤 1 和 2 将在以您指定的时间间隔触发的事件内完成。

如果您需要一个半常规计时器，您可以将 Timer 对象设置为不自动重置并在事件结束时手动启用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T17:52:19.443

这在毫秒内起作用，您可以在它被中断的情况下捕获它，但这通常不会发生。

```
System.Threading.Thread.Sleep(150000); 
```

编辑：

如果您只是想等到其他人完成，或者如果您想每 150 秒执行一次，则另一种选择是使用 join，您自己的答案会起作用。在问之前确保你知道你想要什么。

如果您想要线程安全的暂停，请使用：

```
task.Wait(150000); 
```

# android - 适用于 Android 的主题 Google 地图

> ID：13479025
> 
> 赞同：11
> 
> 时间：2012-11-20T17:47:17.457
> 
> 标签：android, google-maps, ingress-game

我最近设法获得了 Ingress 邀请，并且喜欢其中的地图主题方式。

我知道可以在浏览器中对 Google 地图进行类似的主题化，[如此处所示](http://codecanyon.net/item/5-color-themes-for-google-maps-api/2500863)。

有人知道 Ingress 如何在 Android 上以地图为主题吗？这是只有谷歌才有的功能，还是我们可以通过标准地图库在我们的应用程序中使用它？

![在此处输入图像描述](../Images/8a35d0fcbf80bf738ea0034f58a6b7e6.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:22:57.367

老实说，这是一个猜测（对我来说比平时更多的猜测）

MapView 本身就是一个视图。有构造函数可以接受上下文和属性。您也许可以使用 ContextThemeWrapper 或扩展地图视图并使用 onDraw() 执行操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-08T19:07:13.823

自 2016 年 9 月 21 日起，Google 发布了一项功能，允许您以非常灵活的方式对地图进行主题化，使用 JSON 文件为主题提供各种元素的颜色。他们还发布了一个小型网络应用程序，让您可以尝试主题，他们已在以下位置发布：[样式向导](https://mapstyle.withgoogle.com/ "造型向导")

您还可以找到有关此功能的 Google[文档。](https://developers.google.com/maps/documentation/android-api/styling)

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-26T13:48:25.950

我不认为谷歌地图有主题。但我们有一种获取 android 应用主题地图的方法是 MapBoxSDK。

[https://www.mapbox.com](https://www.mapbox.com)

mapbox sdk 在函数名称和其他内容方面与 google map 类似。唯一的变化是您必须在 android 中使用 mapboxview 而不是 mapView。

这个给你定制的地图皮肤。

# ruby-on-rails - 当我从命令提示符运行“rails s”时，我收到 MySQL2::Error

> ID：13479029
> 
> 赞同：1
> 
> 时间：2012-11-20T17:47:23.973
> 
> 标签：ruby-on-rails, ruby

我对使用 Ruby on Rails 运行网站非常陌生。一点背景故事：

所以我正在做一个项目，并且我已经获得了该网站的代码。我正在运行 Windows，所以我知道它不是 RoR 的最佳操作系统，但切换到不同的操作系统对我来说是最后的手段。

我从 railsinstaller.org 获得了 RailsInstaller，然后运行了它。一切安装顺利。

我`bundle install`从我的站点目录中运行，遇到了 gem "therubyracer" 的问题。做了一堆搜索，发现Windows不需要gem。我认为。所以我将 Gemfile 中的 gem 注释掉，然后`bundle install`再次运行。一切安装正常。

我尝试`rails s`通过命令提示符运行并收到错误：

```
The program can't start because LIBMYSQL.dll is missing from your computer. 
```

所以我对此做了一些研究，发现我必须将文件复制到 RailsInstaller 目录下的 Ruby/bin 文件夹中。错误消失了。

最后我又跑`rails s`了，服务器放到了localhost下。我认为。无论如何，我去`localhost:3000`并收到了 MySQL2::Error 和`Can't connect to MySQL server on 'localhost' (10061)`. 当我点击`Full Trace`我得到代码：

```
development/ruby/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/client.rb:44:in `connect'
development/ruby/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/client.rb:44:in `initialize'
development/ruby/1.9.1/gems/activerecord-3.2.3/lib/active_record/connection_adapters/mysql2_adapter.rb:16:in `new'
development/ruby/1.9.1/gems/activerecord-3.2.3/lib/active_record/connection_adapters/mysql2_adapter.rb:16:in `mysql2_connection'
development/ruby/1.9.1/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:303:in `new_connection'
development/ruby/1.9.1/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:313:in `checkout_new_connection'
development/ruby/1.9.1/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:237:in `block (2 levels) in checkout'
development/ruby/1.9.1/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:232:in `loop'
development/ruby/1.9.1/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:232:in `block in checkout'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
development/ruby/1.9.1/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:229:in `checkout'
development/ruby/1.9.1/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:95:in `connection'
development/ruby/1.9.1/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:398:in `retrieve_connection'
development/ruby/1.9.1/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_specification.rb:168:in `retrieve_connection'
development/ruby/1.9.1/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_specification.rb:142:in `connection'
development/ruby/1.9.1/gems/activerecord-3.2.3/lib/active_record/query_cache.rb:67:in `rescue in call'
development/ruby/1.9.1/gems/activerecord-3.2.3/lib/active_record/query_cache.rb:61:in `call'
development/ruby/1.9.1/gems/activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:467:in `call'
development/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
development/ruby/1.9.1/gems/activesupport-3.2.3/lib/active_support/callbacks.rb:405:in `_run__132547094__call__984979790__callbacks'
development/ruby/1.9.1/gems/activesupport-3.2.3/lib/active_support/callbacks.rb:405:in `__run_callback'
development/ruby/1.9.1/gems/activesupport-3.2.3/lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
development/ruby/1.9.1/gems/activesupport-3.2.3/lib/active_support/callbacks.rb:81:in `run_callbacks'
development/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/middleware/callbacks.rb:27:in `call'
development/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/middleware/reloader.rb:65:in `call'
development/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
development/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
development/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
development/ruby/1.9.1/gems/railties-3.2.3/lib/rails/rack/logger.rb:26:in `call_app'
development/ruby/1.9.1/gems/railties-3.2.3/lib/rails/rack/logger.rb:16:in `call'
development/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/middleware/request_id.rb:22:in `call'
development/ruby/1.9.1/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'
development/ruby/1.9.1/gems/rack-1.4.1/lib/rack/runtime.rb:17:in `call'
development/ruby/1.9.1/gems/activesupport-3.2.3/lib/active_support/cache/strategy/local_cache.rb:72:in `call'
development/ruby/1.9.1/gems/rack-1.4.1/lib/rack/lock.rb:15:in `call'
development/ruby/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/middleware/static.rb:62:in `call'
development/ruby/1.9.1/gems/railties-3.2.3/lib/rails/engine.rb:479:in `call'
development/ruby/1.9.1/gems/railties-3.2.3/lib/rails/application.rb:220:in `call'
development/ruby/1.9.1/gems/rack-1.4.1/lib/rack/content_length.rb:14:in `call'
development/ruby/1.9.1/gems/railties-3.2.3/lib/rails/rack/log_tailer.rb:14:in `call'
development/ruby/1.9.1/gems/rack-1.4.1/lib/rack/handler/webrick.rb:59:in `service'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

我对此进行了一些研究，发现[Rails development - Can't connect to MySQL server on 'localhost' (10061)](https://stackoverflow.com/questions/10792862/rails-development-cant-connect-to-mysql-server-on-localhost-10061)。

当我尝试`ping localhost`使用命令提示符时，我得到了最上面的评论：

```
Reply from ::1: time<1ms 
```

而且我不确定如何更改配置以使主机成为 127.0.0.1。

抱歉，这有点长，我不确定它有多大帮助。正如我在标题中所说，我对此很陌生 - 我仍然不确定 a`host`是什么。

我真的只想让网站运行起来，这样我终于可以开始工作了。我做的一切都正确吗？我真的需要`therubyracer`吗？我做了什么/没有做哪些可以帮助我开始的事情？错误显示什么问题？

如果还有什么我需要提供的，请告诉我！谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:01:36.633

您可以使用[MySQL 工作台](http://www.mysql.com/products/workbench/)检查服务器状态。

DBMS 的配置是在`db/database.yml`Rails 项目的文件中设置的。

我建议您阅读一些有关 Rails 和一般数据库存储的信息。您可以从使用 SQLite的[本教程开始。](http://guides.rubyonrails.org/getting_started.html)MySQL 和 SQLite 是不同风格的[RDBMS](http://en.wikipedia.org/wiki/Relational_database_management_system)，Rails 通常会使用它们来存储需要长期保存的信息。

# xcode - 如何在 Xcode 中调试 NSAPI 插件

> ID：13479030
> 
> 赞同：1
> 
> 时间：2012-11-20T17:47:26.940
> 
> 标签：xcode, nsapi

如何在 Xcode 中调试 NSAPI 插件？

Apple 开发人员文档中用于 Safari 的基于 NSAPI 的 WebKit 插件声明这些可以在 Xcode 中调试。我能找到的唯一文档已经过时了：

[https://developer.apple.com/library/archive/qa/qa1500/_index.html](https://developer.apple.com/library/archive/qa/qa1500/_index.html)

虽然我能够配置 Xcode 4.5 来构建 NSAPI 插件、启动 Safari（带有将加载插件的测试页面），并将调试构建的符号链接复制到库/Internet 插件中，但我实际上无法调试插件. 调试器与 Safari 进程相关联，而不是与插件相关联。

# asp.net-mvc - 为所有 Umbraco 4.10 MVC 路由输出自定义 RenderModel

> ID：13479031
> 
> 赞同：0
> 
> 时间：2012-11-20T17:47:28.180
> 
> 标签：asp.net-mvc, asp.net-mvc-routing, umbraco

有没有办法覆盖默认的 RenderMvcController 来为每个路由输出一个自定义的 RenderModel。这可能是通过劫持路线，但我想放置一些将在每个页面上使用的自定义数据。

例如，在电子商务网站上，每个页面都显示购物篮信息。理想情况下，这将在每个视图的 RenderModel 中可用。有没有办法将默认控制器更改为自定义控制器，它将输出具有篮子属性的扩展渲染模型？

**更新：**

Umbraco 6.1.0+ 现在支持此功能，文档位于本页末尾：http: [//our.umbraco.org/documentation/Reference/Mvc/custom-controllers](http://our.umbraco.org/documentation/Reference/Mvc/custom-controllers)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T19:36:51.540

我会考虑的解决方案不是尝试将自定义数据撬入 Umbraco 的默认页面模型，而是考虑使用 a`BasketSurfaceController`并将购物篮内容呈现到屏幕上`@Html.Action("HeaderDisplay", "BasketSurface")`或类似的东西。这样，您可以保持视图模型独立，并将其显示为`_Layout.cshtml`您需要的特定页面或特定页面的一部分。

同样使用这种方法，您可以维护一组特定的篮子相关视图，这些视图都由同一个控制器提供，并且与 Umbraco 的模型完全分离。

有关详细信息，请参阅有关[子操作](http://our.umbraco.org/documentation/reference/mvc/child-actions/)的文档。

**更新：**

在重新阅读文档时，我可以看到这在 4.10+ 中是可能的，而且非常容易。文档在[此处，](http://our.umbraco.org/documentation/Reference/Templating/Mvc/custom-controllers)但简而言之，您可以通过替换默认控制器来覆盖对每种文档类型的请求或覆盖所有请求。

尽管我仍会提倡`ChildAction`这种特定场景的方法，但重写文档类型控制器以传递自定义视图模型对于传递特定于页面的预制模型是理想的（例如，带有评论的博客条目。相关类别）和/或传递一个模型，该模型包含页面本身不可用但每个页面都需要的数据（例如站点名称、域、区域设置、全局跟踪/附属代码、元数据）。

# windows - Windows 上的异步定时器回调

> ID：13479033
> 
> 赞同：0
> 
> 时间：2012-11-20T17:47:34.190
> 
> 标签：windows, asynchronous, timer, signals

我正在寻找 *nix 的 Windows 替代品`SIGALRM`。我已经看到建议（例如[这里](https://stackoverflow.com/questions/4511732/alarm-function-on-linux-and-windows-cant-find-a-equivalent-for-windows-c)）使用`timeSetEvent`，但这并不完全一样。在与我的（单线程）程序的其余部分*相同的线程上*`SIGALRM`调用回调函数，据我所知，在*新*线程上调用它。*`timeSetEvent`*

 **我对这种区别是正确的吗？如果是这样，有没有办法在 Windows 上实现 *nix 类型的行为？**

# ruby-on-rails - 如何使用包含列名的 Rails ActiveRecord 获取任意结果集

> ID：13479038
> 
> 赞同：1
> 
> 时间：2012-11-20T17:47:39.283
> 
> 标签：ruby-on-rails, ruby, activerecord

我需要做一个复杂的 SQL 查询，它跨越多个模型并连接数据；这是我的应用程序中的一种一次性临时报告，因此我无法通过标准模型语法来做到这一点。

我看了看`ActiveRecord::Base.connection.select_rows`，这正是我想要的，但它返回一个或多个直接向上的数组，而不包括列名。理想情况下，我想要的工作方式与 相同`select_rows`，但返回更多信息，类似于字典数组，以便在构建报告页面时可以使用键值查找。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T17:52:01.390

您可以使用[`ActiveRecord::Base.connection.select_all()`](http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/DatabaseStatements.html#method-i-select_all).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T17:58:01.663

您可以改为使用`results = ActiveRecord::Base.connection.exec_query(sql)`和使用`results.rows`来获取行`results.columns`数组和列名数组。

# url-rewriting - 主页的 G-WAN URL 重写不起作用

> ID：13479044
> 
> 赞同：0
> 
> 时间：2012-11-20T17:47:58.583
> 
> 标签：url-rewriting, handlers, g-wan

我正在尝试为站点主页进行 URL 重写。这是我的处理程序的简化版本。

```
int init(int argc, char *argv[])
{
   u32 *states = (u32*)get_env(argv, US_HANDLER_STATES);
   *states =  (1 << HDL_AFTER_READ);
   return 0;
}

int main(int argc, char *argv[])
{
   xbuf_t *read_xbuf = (xbuf_t*)get_env(argv, READ_XBUF);
   xbuf_replfrto(read_xbuf, read_xbuf->ptr, read_xbuf->ptr + 16, " / ", " /?home ");
   return 255;
}

void clean(int argc, char *argv[]) 
{} 
```

基本上它只是用“ /?home ”替换“ / ”。所以当用户加载“www.domain.com”时，它会给他们“home.c”的内容。这是重写的结果。一切看起来都正确我不确定是什么导致了这个问题。

原始请求：

```
GET / HTTP/1.1
Host: localhost:8000
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:12.0) Gecko/20100101 Firefox/12.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive 
```

重写请求：

```
GET /?home HTTP/1.1
Host: localhost:8000
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:12.0) Gecko/20100101 Firefox/12.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive 
```

改写后就是这样的结果。

```
GET http://localhost:8000/

 -- response --
0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:27:18.127

你忘了`return 255;`在`main()`函数中。

请记住，连接处理程序返回代码具有以下含义：

```
return 255; // execute next connection step
return   0; // close connection 
```

此外，即使它仍然为空，您也必须`clean()`在连接处理程序中声明一个函数：

```
void clean(int argc, char *argv[]) 
{} 
```

最后，您必须在`main()`.

这给了我们下面的测试代码：

```
// ============================================================================
// Handler C script for the G-WAN Web Application Server (http://gwan.ch/)
// ----------------------------------------------------------------------------
// main.c: basic rewrite example
// ============================================================================
#include "gwan.h"    // G-WAN exported functions

#include <stdio.h> // puts(), printf()
// ----------------------------------------------------------------------------
// init() will initialize your data structures, load your files, etc.
// ----------------------------------------------------------------------------
// init() should return -1 if failure (to allocate memory for example)
int init(int argc, char *argv[])
{
   // define which handler states we want to be notified in main():
   // enum HANDLER_ACT { 
   //  HDL_INIT = 0, 
   //  HDL_AFTER_ACCEPT, // just after accept (only client IP address setup)
   //  HDL_AFTER_READ,   // each time a read was done until HTTP request OK
   //  HDL_BEFORE_PARSE, // HTTP verb/URI validated but HTTP headers are not 
   //  HDL_AFTER_PARSE,  // HTTP headers validated, ready to build reply
   //  HDL_BEFORE_WRITE, // after a reply was built, but before it is sent
   //  HDL_HTTP_ERRORS,  // when G-WAN is going to reply with an HTTP error
   //  HDL_CLEANUP };
   u32 *states = (u32*)get_env(argv, US_HANDLER_STATES);
   *states =  (1 << HDL_AFTER_READ);
   return 0;
}
// ----------------------------------------------------------------------------
// clean() will free any allocated memory and possibly log summarized stats
// ----------------------------------------------------------------------------
void clean(int argc, char *argv[])
{}
// ----------------------------------------------------------------------------
// main() does the job for all the connection states below:
// (see 'HTTP_Env' in gwan.h for all the values you can fetch with get_env())
// ----------------------------------------------------------------------------
int main(int argc, char *argv[])
{
   // HDL_HTTP_ERRORS return values:
   //   0: Close the client connection
   //   2: Send a server reply based on a custom reply buffer
   // 255: Continue (send a reply based on the request HTTP code)
   const int state = (long)argv[0];
   if(state != HDL_AFTER_READ)
      return 255;

   xbuf_t *read_xbuf = (xbuf_t*)get_env(argv, READ_XBUF);
   printf("req_1: %.20s\n", read_xbuf->ptr);
   xbuf_replfrto(read_xbuf, read_xbuf->ptr, read_xbuf->ptr + 16, " / ", " /?home ");
   printf("req_2: %.20s\n-------------------\n\n", read_xbuf->ptr);

   return 255; // continue G-WAN's default execution path
}
// ============================================================================
// End of Source Code
// ============================================================================ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T04:30:18.300

此问题已在 G-WAN 版本 4+ 上得到解决

# git - 在 git 中删除分支的最佳方法，这样我就可以恢复它

> ID：13479046
> 
> 赞同：3
> 
> 时间：2012-11-20T17:48:01.013
> 
> 标签：git

在 svn 中，我经常删除包含我不再感兴趣的工作的分支，我知道如果我真的需要，我可以在以后的任何时间恢复它们。

在 git 中，这似乎是不可能的。这意味着我现在在 'git branch -a' 中有大约 50 个分支，我不希望再次使用它们，但不想永远失去它们。

git 中真的没有办法以版本控制的方式删除分支吗？在没有听起来反git的情况下，为什么git设计成几乎需要（在我看来）以无法恢复的方式丢弃旧分支？这不违背版本控制的想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T17:55:59.557

一种可能性是为要归档的分支创建一个标签，然后您可以删除该分支。

`git tag -a <tagname> <branchname>`

然后，如果您想恢复分支，您可以从标签创建一个新分支。

`git checkout -b <branchname> <tagname>`

它还可能有助于为标签开发命名方案，以便所有存档的分支标签在一起并位于标签列表的顶部或底部。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T17:57:40.290

我有时做的一件事是用前缀重命名分支：

```
git branch -m foo old/foo 
```

您可以做的另一件事是将要保存的分支推送到另一个裸 Git 存储库以进行保管，然后在本地存储库中删除它们：

```
git remote add archive /path/to/archive/repo.git
git push archive foo
git branch -D foo 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-20T20:11:51.200

您可以为 git 使用的正常命名空间之外的分支头创建一个 ref。这将阻止`git branch`列出分支，但会确保该分支的提交不会被垃圾收集，并且如果您稍后决定您确实需要它，仍然会提供一个名称来取回该分支。

```
git update-ref refs/attic/old_topic_branch old_topic_branch
git branch -D old_topic_branch 
```

这个阁楼空间中的分支可以列出：

```
git for-each-ref refs/attic 
```

并且可以通过以下方式恢复分支：

```
git checkout -b old_topic_branch refs/attic/old_topic_branch 
```

但是，如果您打算在任何时候放弃旧的存储库（例如移动到新计算机），您仍然需要小心地将这些引用移动到新的存储库，因为在克隆存储库时这些引用不会被复制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T18:37:43.110

另一种可能性是简单地重命名“死”分支，可能与“命名空间”它们一起使用。例如，如果我不再需要该分支`topicbranch42`，但将来可能需要它以供参考，请执行以下操作：

```
git checkout master # or any other branch that isn't topicbranch42
git branch -m topicbranch42 deprecated/topicbranch42 
```

这样，您可以保留所有分支，但它们的名称提供了一个非常清晰的指示，它们没有处于积极的开发/使用中

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-08T18:11:26.743

我今天早上才意识到这个问题的正确答案：

.git/refs 下的所有内容都是参考，因此不会被修剪，但只有 refs/heads 是分支，refs/tags 是标签等。所以只需将分支分流到“归档”参考目录。真正的蛮力方法是`mkdir -p .git/refs/archive/heads; mv .git/refs{,/archive}/heads/master`踩踏该分支的任何先前存档的版本；这是一个更彻底的版本：

```
#!/bin/sh
# archive a branch, by committing it to .git/refs/archive/heads/
# to unarchive the branch, say 'git branch mybranch archive/heads/mybranch~'
# ---- NOIICE the parent link in the branch command above ----------------/
# any second parent of the archive ref is the previous archive header commit

getopts x x && set -x -v && shift

while test $# -ne 0; do
    branch="refs/heads/$1"
    archive="refs/archive/heads/$1"
    git rev-parse -q --verify "$branch" >&- \
    || { echo >&2 archive-branch ignored nonexistent branch: $1; shift; continue; }
    previously=`git rev-parse -q --verify "$archive"`
    git mktree </dev/null | xargs git commit-tree \
        -p "`git rev-parse "$branch"`" \
        ${previously:+ -p $previously} \
        -m "Parent is the archived tip of branch '$1'" \
        ${previously:+ -m 'Second parent is the previous commit like this one.'} \
    > "`git rev-parse --git-dir`/$archive"
    rm "`git rev-parse --git-dir`/$branch"
    shift
done 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-11-20T17:50:21.673

删除 git 分支只会删除引用提交的标签。
您可以运行`git checkout <commit-hash>`以恢复已删除的分支，只要您在某处写下哈希即可。

运行`git gc`将永久删除这些孤立的提交。

# python - Box Api v2 SSL 版本 Python

> ID：13479052
> 
> 赞同：1
> 
> 时间：2012-11-20T17:48:19.083
> 
> 标签：python, ssl, openssl, box-api, python-requests

在尝试通过`box.net api v2.0`.

我正在使用 Python 2.7、OpenSSL 1.0.1c 和[`requests`](http://docs.python-requests.org/en/latest/)库。

```
 payload = {"action":"get_auth_token", "api_key":self.box_apikey, "ticket":self.box_ticket['status'], "verify":False}
    r = requests.get(self.box_secure_endpoint+"rest", params=payload)
  File "/usr/lib/python2.7/site-packages/requests/api.py", line 65, in get
    return request('get', url, **kwargs)
  File "/usr/lib/python2.7/site-packages/requests/safe_mode.py", line 39, in wrapped
    return function(method, url, **kwargs)
  File "/usr/lib/python2.7/site-packages/requests/api.py", line 51, in request
    return session.request(method=method, url=url, **kwargs)
  File "/usr/lib/python2.7/site-packages/requests/sessions.py", line 241, in request
    r.send(prefetch=prefetch)
  File "/usr/lib/python2.7/site-packages/requests/models.py", line 641, in send
    raise SSLError(e)
requests.exceptions.SSLError: _ssl.c:316: Invalid SSL protocol variant specified. 
```

笔记：

*   我也在更深入地研究`requests`lib，看看是否有某种解决 SSL ver 请求功能的方法。
*   如果我没记错的话，SSL 证书中的第二位应该指示 SSL 版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T14:04:35.253

该问题导致验证服务器 ssl 版本支持（显式 ssl.PROTOCOL_SSLv3 | [http://docs.python.org/2.7/library/ssl.html#ssl.wrap_socket](http://docs.python.org/2.7/library/ssl.html#ssl.wrap_socket)）。

我将把请求转发给 lib devs 或创建一个补丁来启用显式指定协议的功能。

谢谢你的帮助。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:55:38.570

您看到此错误是因为您将`verify`参数作为请求中的 URL 参数发送，即您要访问的实际 URL 是

```
https://api.box.com/1.0/rest?action=get_auth_token&api_key=APIKEY&ticket=ticket&verify=False 
```

verify 应该作为关键字参数发送到请求 get 函数的实际调用中，即

```
r = requests.get(self.box_secure_endpoint+"rest", params=payload, verify=True) 
```

# php - 比较 PHP DateInterval

> ID：13479056
> 
> 赞同：3
> 
> 时间：2012-11-20T17:48:29.013
> 
> 标签：php, date

如何比较两个 DateInterval 对象？就像是：

```
$d1 = new DateInterval("P1M");
$d2 = new DateInterval("P2M");

if($d2 > $d1)
{
    do something ...
} 
```

我可以将 DateIntervals 转换为秒，但有什么更好的方法吗？

感谢您的帮助！

最好的祝福，

弗雷迪

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T18:07:26.273

到目前为止，转换为秒是唯一的方法。

# objective-c - 从后台返回时有没有办法重新启动应用程序？

> ID：13479059
> 
> 赞同：0
> 
> 时间：2012-11-20T17:48:35.213
> 
> 标签：objective-c, ios, cocoa-touch, multitasking

我希望能够在从后台返回时重新启动应用程序。因此，如果用户再次选择应用程序，它应该像第一次打开一样启动。我一直在谷歌搜索，但找不到这样做的方法。

我想在中添加应用程序的主视图`applicationWillEnterForeground`，但如果我可以释放资源，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T17:50:43.647

您无法重新启动应用程序。您可以做的是禁用后台支持，因此您的应用程序在关闭时总是完全终止。

> **“...您可以通过将UIApplicationExitsOnSuspend**键添加到应用程序的**Info.plist**文件并将其值设置为**YES**来明确选择退出后台执行模型。”

资料来源：[选择退出后台执行](http://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html#//apple_ref/doc/uid/TP40007072-CH4-SW5)。

# php - 服务器无法识别 PHP 样式表

> ID：13479068
> 
> 赞同：0
> 
> 时间：2012-11-20T17:48:57.303
> 
> 标签：php, wordpress, css

我目前正在使用一个使用 PHP 文件作为主要样式表 (style.php) 的 Wordpress 主题。我想这是因为您可以通过主题的 CMS 进行大量 css 样式设置。

现在的问题是我的服务器无法将 php 文件识别为主要样式表，因此加载网站时没有任何样式元素。

有人可以告诉我如何解决这个问题吗？（可能通过使用 .htaccess 文件？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T17:59:32.677

您必须确保将正确的“text/css”标题添加到 php 页面的顶部，以便将其解析为 CSS。

```
header("Content-type: text/css"); 
```

然后您可以将 php 文件包含为 css 包含：

# php - 通过 AJAX 将用户输入插入 DB 会导致空字段

> ID：13479069
> 
> 赞同：0
> 
> 时间：2012-11-20T17:48:59.783
> 
> 标签：php, ajax, forms

我有一个 PHP 脚本，插入部分如下（我知道，没有 PDO 或 mysqli，这只是为了我的个人测试）：

```
<?php
  $user = $_POST['user'];
  $comments = $_POST['comment'];

  $con = mysql_connect("localhost","root","") or die(mysql_error());
  mysql_select_db('localh',$con);

  $query = mysql_query("INSERT INTO content (Title, Article)
    VALUES('$user', '$comments')");

  if(!$query){die(mysql_error());}

  mysql_close($con);
?> 
```

如果我在表单操作中使用此脚本，它将正常工作，输入值将被添加到数据库中。

这是表格：

```
<form>
  <p>User: <input type="text" id="user" /></p>
  <p>Comment:<input type="text" id="comment" /></p>
  <input type="button" id="submit" onClick="insertData();" />
</form> 
```

而 AJAX 部分，位于 head 标签之间：

```
function insertData(){
  var ajaxRequest = new XMLHttpRequest();

  var usr = document.getElementById("user").value;
  var cmnt = document.getElementById("comment").value;

  ajaxRequest.open("POST", "insert.php", true);
  ajaxRequest.send(usr, cmnt);
} 
```

结果将是数据库中的空行。我不知道为什么会这样，我一无所知。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T17:54:21.853

实际上，这是我真正推荐某人使用 jQuery 的唯一非常具体的案例之一。

AJAX 可能是实现最模糊的特性。每个浏览器都有其实现的怪癖。jQuery 可以用来解决那些跨浏览器的不兼容问题。

**[jQuery`$.ajax`文档页面](http://api.jquery.com/jQuery.ajax/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:01:09.090

您实际上并没有将变量的键发送到脚本：

```
ajaxRequest.send(usr, cmnt); 
```

所以你的`$_POST`数组不会包含`user`nor `comment`。

虽然切换到 jQuery 可能是一个好主意，但您可以发送变量，例如：

```
var vars = encodeURI("user="+usr+"&comment="+cmnt);
ajaxRequest.send(vars); 
```

但是你必须测试一下，因为我通常使用 jQuery 来处理我的 ajax 请求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T18:03:26.087

检查您是否收到了`$_POST`可验证`user`的`comments`数据，只需在您的 php 文件中添加类似的内容

> print_r($_POST); 出口（）;

如果您在服务器端没有它们，请检查您的`ajax`

如果没问题，请检查您的 mysql 查询：

# javascript - 从列表中的列表中提取信息。

> ID：13479073
> 
> 赞同：0
> 
> 时间：2012-11-20T17:49:07.827
> 
> 标签：javascript, jquery

在我的 js 中，我得到一个看起来像这样的列表“数据”：

```
data = {test: 'test', test2:'test2', test3 : buffer} 
```

我的“缓冲区”有这种形式：

```
buffer =[{testa: 'testa', testb : 'testb'}, {testc: 'testc', testd : 'testd'}, {teste: 'teste', testf : 'testf'} ... ] 
```

我想做的是对于缓冲区的每个元素，使用它包含的数据并像这样进行追加。

```
$('.try').append('<div> <p> '+testa+' </p> <p> '+testb+' </p> <div>')
$('.try').append('<div> <p> '+testc+' </p> <p> '+testd+' </p>)
... 
```

html:

```
<div class='try' > 
```

关于如何做到这一点的任何想法？

我知道我可以使用“data.buffer”访问“缓冲区”。但是，我需要为“缓冲区”的每个元素创建一个循环，然后为缓冲区的每个元素，提取其中的数据并创建一个新的 div ...

任何帮助都会非常受欢迎。

编辑：这是我尝试过的：

```
 for (var i in data.buffer) $('.try').append('<div> <p> '+i.testa' </p> <p> '+i.testb' </p> </div>') 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T17:59:08.250

用于`$.each`迭代您的对象..

试试这个

```
var buffer=[{testa: 'testa', testb : 'testb'}, 
            {testc: 'testc', testd : 'testd'}, 
            {teste: 'teste', testf : 'testf'}]​;

var html = '';
$.each(buffer ,function(i, v){ // Iterate over the Array
    html += '<div>' ;
    $.each(v, function(j,value) { // Iterate over each object
        html += '<p> '+ value+' </p>' ;
    });   
    html += '</div>' ;        
});

$('.try').append(html); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/JxJsR/)**

**更新**

 **对于您要问的第二种格式..删除最里面的`$.each`

```
var html = '';
$.each(buffer, function(i, v) { // Iterate over the Array
    html += '<div>';
    var k = 0;
    $.each(v, function(j, value) { // Iterate over each object
        if (k == 0) {
            html += '<p> ' + value + ' </p>';
        }
        else {
            html += '<img src="' + value +'" />';
        }
        k++;
    });
    html += '</div>';
});

$('.try').append(html);​ 
```

**[小提琴](http://jsfiddle.net/sushanth009/JxJsR/1/)****

# ruby-on-rails - rails spec/spec_helper 中的 require 'capybara/rails' 和 'capybara/rspec' 有什么区别？

> ID：13479076
> 
> 赞同：2
> 
> 时间：2012-11-20T17:49:33.953
> 
> 标签：ruby-on-rails, rspec, capybara

与 capybara2.0 有什么区别，在我的新应用中哪个更好？

我的理解，`require 'capybara/rails'`更好，并在下面使用：

```
spec/{controllers,models,...} #=> rspec
spec/requests #=> rspec
spec/features #=> capybara 
```

`capybara/rspec`是capybara1，老而`spec/requests #=> rspec, capybara`，这不简单。

[https://github.com/jnicklas/capybara/blob/master/lib/capybara/rails.rb](https://github.com/jnicklas/capybara/blob/master/lib/capybara/rails.rb) [https://github.com/jnicklas/capybara/blob/master/lib/capybara/rspec.rb](https://github.com/jnicklas/capybara/blob/master/lib/capybara/rspec.rb)

# javascript - 从 Sharepoint 2007 的权限掩码中读取个人权限

> ID：13479078
> 
> 赞同：2
> 
> 时间：2012-11-20T17:49:40.327
> 
> 标签：javascript, permissions, sharepoint-2007

我正在尝试使用 SPServices jQuery 库来读取 Sharepoint 2007 站点上用户的权限掩码。我可以成功获得权限掩码的编号，但我无法将权限掩码响应转换为有意义的内容。

我正在使用以下 Javascript 获取权限掩码：

```
function getPermissions(url, sobj) {

  $().SPServices.defaults.webURL = url;

  //FIRST DO SITE

  $().SPServices({

     operation: "GetPermissionCollection",

     async: false,

     objectName: url,

     objectType: "Web",

     completefunc: function(xData, Status){

        $(xData.responseXML).find("Permission").each(function(){

           sobj.Permissions.push($(this).attr("UserLogin"));

           sobj.PermissionsLevel.push($(this).attr("Mask"));

        });

     }

  });

  //NOW DO LISTS

  for (x in sobj.Lists) {

      $().SPServices({

          operation: "GetPermissionCollection",

          async: false,

          objectName: sobj.Lists[x].InternalName,

          objectType: "List",

          completefunc: function(xData, Status){

              $(xData.responseXML).find("Permission").each(function(){

                 sobj.Lists[x].Permissions.push($(this).attr("UserLogin"));

                 sobj.Lists[x].PermissionsLevel.push($(this).attr("Mask"));

              });

          }

      });

   }

} 
```

几个例子是：A）-2013006751 B）-1140590865

这些对应的二进制值是（假设使用二进制补码）： A) 10001000000000111111010001100000 B) 10111100000000111111011011101110

我无法理解这些数字如何等同于用户实际拥有的权限。使用来自[http://jamestsai.net/Blog/post/Understand-SharePoint-Permissions-Part-1-SPBasePermissions-in-Hex2c-Decimal-and-Binary-The-Basics.aspx](http://jamestsai.net/Blog/post/Understand-SharePoint-Permissions-Part-1-SPBasePermissions-in-Hex2c-Decimal-and-Binary-The-Basics.aspx)的权限表，它只是没有t 似乎与用户实际拥有的权限相匹配。

我现在不在工作，所以我会用更多信息更新它，但有人能从我目前掌握的信息中发现我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T20:17:27.140

逐位比较是您所追求的。

例如

```
var permissionMask = -2013006751;
var viewPages = 131072; // 100000000000000000
if((permissionMask & viewPages)===viewPages)
{
    alert('person has view pages permission');
} 
```

[有关更详细的说明，](http://www.vipan.com/htdocs/bitwisehelp.html)请参见此处。

# sqlite - 将 sqlite 与 node.js 一起使用 - 工作模块

> ID：13479079
> 
> 赞同：0
> 
> 时间：2012-11-20T17:49:43.867
> 
> 标签：sqlite, node.js

我正在开发一个 node.js 项目，我想使用某种数据库来存储应用程序数据。我搜索了各种 DBMS 并选择了 SQLite，因为我希望我的项目能够在不安装繁重的 DBMS 的情况下运行，并且因为我希望它能够在 linux 和 windows 上运行。但是，我们发现的所有将节点与 SQLite 连接的模块要么非常旧，要么由于错误而无法安装。

所以，我想问一下现在，2012 年，是否有一个用于 SQLite 的功能齐全的 node.js 模块。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:17:22.213

我去年 7 月（2012 年）在 Node.JS v0.8.8 中做了一个项目，使用该`node-sqlite`模块（参见[https://github.com/developmentseed/node-sqlite3](https://github.com/developmentseed/node-sqlite3)），它工作得很好。

而且，我在 Heroku 上成功部署并使用了这个模块。然而，项目的部署部分只涉及读取 SQLite 数据库，而不是写入。我怀疑写入部署在 Heroku 上的 SQLite 会导致一些问题，因为它涉及修改文件系统中的 SQLite 文件，而 AFAIK Heroku 不允许您这样做。

# google-drive-api - 无法打开“共享”对话框

> ID：13479082
> 
> 赞同：0
> 
> 时间：2012-11-20T17:49:57.573
> 
> 标签：google-drive-api

我正在尝试利用驱动器“共享对话框”。打开对话框时，我可以在 JS 控制台中看到这些异常：

```
Uncaught Error: SYNTAX_ERR: DOM Exception 12 3566089298-v2-doclist_share.js:454
nK.sendMessage 3566089298-v2-doclist_share.js:454
Mj 3566089298-v2-doclist_share.js:455
z.Yh 3566089298-v2-doclist_share.js:481
_createShareApplication 3566089298-v2-doclist_share.js:482
init share:53
(anonymous function) share:82
Refused to display document because display forbidden by X-Frame-Options. 
```

对话框打开，但在加载状态大约 1 分钟后，我收到消息“抱歉，此时无法共享。请稍后再试。” 有任何想法吗？我在 Chrome 版本 23.0.1271.64 m

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:17:40.620

共享对话框有一些限制，使其非常敏感（不幸的是很难调试）。本质上：

1.  该应用程序必须由用户安装
2.  创建对话框时必须设置应用ID
3.  主机页面的 JS 来源必须与 Drive SDK 设置中的创建或打开 URL 的来源相匹配（协议/主机/端口必须匹配）

检查以确保满足这些条件。

# c# - Sketchflow 计时器触发器

> ID：13479084
> 
> 赞同：1
> 
> 时间：2012-11-20T17:50:02.130
> 
> 标签：c#, expression-blend, sketchflow

有谁知道如何在 Expression Blend Sketchflow 中的 c# 中创建计时器触发器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T03:09:47.940

如果您指的是动作/触发器/行为意义上的触发器，请将动作拖到画板或时间轴上，选择它，然后在属性窗格中找到触发器部分并单击新按钮，选择计时器触发器。

# flash - 在 Flash 移动站点中，对数据库的调用在哪里？

> ID：13479085
> 
> 赞同：0
> 
> 时间：2012-11-20T17:50:02.143
> 
> 标签：flash, apache-flex, flash-builder, database-connection, super

我有一个不是我创建但需要编辑的 Flash 移动网站。单击提交按钮时，它会检查登录名和密码是否在 SQL 数据库中。问题是，我找不到在数据库上运行查询的方法，甚至找不到数据库连接的位置。我尝试在代码中搜索“SQL”、“数据库”和“连接”等词，但没有成功。我单步执行代码，在其中找到对方法“super”的调用，但随后它返回到原始方法，然后用户登录。有人可以解释对数据库的调用在哪里吗？

我想知道的其他事情是：SQL 连接在哪里？在主要（非移动站点）中，有一个 web.config 有一行说

```
<add name="TPConnectionString1"
connectionString="DataSource=xxx.xx.xxx.xx,xxxx\sqlexpress;Initial Catalog=TP;Persist Security
Info=True;User ID=xxxxx" providerName="System.Data.SqlClient"/> 
```

移动代码中的类似行在哪里（什么文件：例如 web.config、xyz.as 等）？

super(type, bubbles, cancelable) 有什么作用？

这是提交按钮的方法：LoginView.mxml

```
 private function btnclicked():void{
            techController.username = txtUsername.text;
            techController.password = txtPassword.text;
            var evt:TechEvent = new TechEvent(TechEvent.LOGIN_USER);
            this.dispatchEvent(evt);
        } 
```

这是调用的 TechEvent 函数：TechEvent.as

```
 public function TechEvent(type: String, bubbles:Boolean=true, cancelable:Boolean=false)
    {
        super(type, bubbles, cancelable);
    } 
```

这是 dispatchEvent 方法： UIComponent.as

```
override public function dispatchEvent(event:Event):Boolean
{
    if (dispatchEventHook != null)
        dispatchEventHook(event, this);

    return super.dispatchEvent(event);
} 
```

# windows - 如何创建并格式化具有 NTFS 文件系统的卷？

> ID：13479087
> 
> 赞同：1
> 
> 时间：2012-11-20T17:50:10.720
> 
> 标签：windows, winapi, format, ntfs

创建分区然后在此卷中格式化 NTFS 卷的首选方法是什么？

我宁愿坚持使用 Win32 API，而不是使用 WMI 或脚本

这可能吗？API/IOCTL 的任何线索？（一个例子会很棒）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:58:39.027

你需要知道的一切都在 MSDN 上：

[磁盘管理](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363978.aspx)

[虚拟磁盘服务](http://msdn.microsoft.com/en-us/library/windows/desktop/bb986750.aspx)

[Windows 存储管理 API](http://msdn.microsoft.com/en-us/library/windows/desktop/hh830613.aspx)

[IVdsAdvancedDisk 接口](http://msdn.microsoft.com/en-us/library/windows/desktop/aa381669.aspx)

# ruby-on-rails - 在不使用 Rake 的情况下运行 Rake 任务

> ID：13479088
> 
> 赞同：1
> 
> 时间：2012-11-20T17:50:13.180
> 
> 标签：ruby-on-rails, rake, helper

我有一个用户可以互相下注的应用程序，当结果加载到应用程序中时，我使用 Rake 任务来结算赌注。我在 Heroku 上运行，所以我每半小时使用他们的调度服务来执行这个 Rake 任务。

这工作正常，但我更想在数据库中保存/更新结果时运行 Rake 作业。

如何转换 Rake 任务，以便可以从我的模型中运行它，如下所示。如果我可以从控制器运行它也可能会很好，因为我可能有几种需要结算过程的情况。

```
class Spotprice < ActiveRecord::Base
  belongs_to :spotarea
  belongs_to :product

  after_save   :settlement
end 
```

我的 Rake 任务现在看起来像这样：

```
task :settlement => :environment do
  puts "Settlement in progress..."
  puts "-------------------------"
  puts " "
  puts " "
  puts "BETS:"
  puts "-------------------------"

  # Bet settlement
  @bets = Bet.where(:settled => false)

  @bets.find_each do |bet|

    if not bet.choice.spotprice.nil?

      case 
      when bet.choice.spotprice.value > bet.choice.value && bet.buy == true
        profitloss  = 10
        puts "#{bet.id}: Win (1)"
      when bet.choice.spotprice.value < bet.choice.value && bet.buy == false 
        profitloss  = 10
        puts "#{bet.id}: Win (2)"
      when bet.choice.spotprice.value > bet.choice.value && bet.buy == false
        profitloss  = -10
        puts "#{bet.id}: Loose (3)"
      when bet.choice.spotprice.value < bet.choice.value && bet.buy == true 
        profitloss  = -10
        puts "#{bet.id}: Loose (4)"
      when bet.choice.spotprice.value == bet.choice.value
        profitloss  = -10
        puts "#{bet.id}: Loose (5)"
      end

      if profitloss  
        bet.settled    = true
        bet.profitloss = profitloss 
        bet.save
      end 

    end

    if bet.choice.settled == true
      bet.choice.settled = false
      bet.choice.save
    end

  end

  # Pusher update
  Pusher["actives"].trigger("updated", {:message => "Settlement completed"}.to_json)

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:40:21.010

只需将我对原始问题的评论放入答案即可。

我有类似的情况，我有一个 rake 任务，我想从 rake 之外调用。您想要做的是将代码从 rake 任务移到 ruby​​ 类中，最好的地方是`lib`. 你的课程看起来像这样：

```
# lib/settlement.rb
class Settlement
  def self.settle_bets
    # all the code that used to be in the rake task
  end
end 
```

然后在代码中你可以做这样的事情（随机例子）：

```
# app/controllers/bets_controller.rb
#...
  def settle_bets
    require "settlement"
    Settlement.settle_bets
  end
# ... 
```

或者（另一个随机示例）：

```
# app/models/bet.rb
class Bet ...
  after_update: update_some_bets

  # ... more code here

  private
    def update_some_bets
      require "settlement"
      Settlement.settle_bets
    end 
```

如果你愿意，你仍然可以使用 rake 任务：

```
# lib/tasks/settlement.task
require "settlement"
# require "#{Rails.root}/lib/settlement.rb" # use this if the above won't work

task :settlement => :environment do
  Settlement.settle_bets
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:12:29.360

如果您希望在更新（或保存）时计算结果，为什么不将大部分代码从您的 rake 任务移动到您的 Bet 模型的方法中，然后调用它并通过`after_update`回调调用它

在`bet.rb`

```
# class method that settles the given bet
def self.settle(bet)
  message = nil
  if not bet.choice.spotprice.nil?
    case 
    when bet.choice.spotprice.value > bet.choice.value && bet.buy == true
      profitloss  = 10
      message =  "#{bet.id}: Win (1)"
    when bet.choice.spotprice.value < bet.choice.value && bet.buy == false 
      profitloss  = 10
      message =  "#{bet.id}: Win (2)"
    when bet.choice.spotprice.value > bet.choice.value && bet.buy == false
      profitloss  = -10
      message =  "#{bet.id}: Lose (3)"
    when bet.choice.spotprice.value < bet.choice.value && bet.buy == true 
      profitloss  = -10
      message =  "#{bet.id}: Lose (4)"
    when bet.choice.spotprice.value == bet.choice.value
      profitloss  = -10
      message =  "#{bet.id}: Lose (5)"
    end

    if profitloss  
      bet.settled    = true
      bet.profitloss = profitloss 
      bet.save
    end 
  end

  if bet.choice.settled == true
    bet.choice.settled = false
    bet.choice.save
  end
  # return message
  message
end 
```

在`spot_price.rb`

```
class SpotPrice
  after_update Bet.settle(self)
  after_save   Bet.settle(self)

  ....
end 
```

这不处理我们其他输出的 Pusher 东西（保存并返回到`message`变量中）。另外，我情不自禁，但我认为你的意思是“失去”，而不是“松散”。

这是你要找的吗？

# python - 在 python 中找出一个奇怪的分隔符

> ID：13479092
> 
> 赞同：3
> 
> 时间：2012-11-20T17:50:26.347
> 
> 标签：python

我在文本文件中有以下形式的数据：

```
371012200010401^A218032263303^A2011-09-27^A10:26:04.000^A75.00^A1^A0^A
371010032020101^A792392400085^A2011-09-29^A15:15:04.000^A150.00^A0^A0^A 
```

现在我想根据分隔符拆分这个字符串。

我试过这个：

```
print "before ",line
line = line.split("\u001")
print "after ",line, type(line)

before  3710100008800☺2067400044☺2012-09-01☺09:10:05.000☺488.60☺0☺0☺
after  ['3710100008800\x012067400044\x012012-09-01\x0109:10:05.000\x01488.60\x010\x010\x01'] <type 'list'> 
```

所以首先，我在开窗机上……之前的那个笑脸应该是^A

所以我确实看到拆分后的行类型是列表

但它是一个奇怪的列表（有 \x0 作为分隔符？？）并且 line[1] 不可访问，所以我的猜测是它只是整个字符串的列表。

我想要的只是按照这个分隔符分割这条线

有什么线索吗？谢谢

# objective-c - 浮点的东西工作......大部分时间

> ID：13479093
> 
> 赞同：0
> 
> 时间：2012-11-20T17:50:25.963
> 
> 标签：objective-c, ios, floating-point, nsstring

> **可能重复：**
> [更正浮点数](https://stackoverflow.com/questions/10049533/correcting-floating-point-numbers)

```
float randNum = arc4random()%(100)-1; 
```

我在某处读到这会给我1-100之间的随机数。或者类似的东西。

这条线似乎一直有效，但我将此数字转换为 NSString 以存储/打印为文本，然后将其转换回浮点数以进行排序和其他计算。但是当我得到那个浮动时，有时它看起来像是胡言乱语。在变量视图中像这样：

```
9   float   9.75303731e-41 
```

为什么转换为 NSString 并返回到 float 会破坏我正在使用的 float 值？（例如，我可能搞砸了什么？或者我应该改用 CGFloat 吗？）

我认为这是所有相关的代码：

```
NSMutableArray *stringArray = [[NSMutableArray alloc] init];
floatArray[30];
// put three random floats into an NSMutableArray of NSStrings
for(int i = 0; i < 3; i++)
{
    float randNum = arc4random()%(100)-1;
    NSString *randString = [NSString stringWithFormat:@"%.3f", randNum];
    [stringArray addObject:randString];
}

// convert NSStrings back to float
for(NSString *string in stringArray)
{
    float temp = [string floatValue];
    floatArray[iterator] = temp;
} 
```

提前感谢您的任何帮助/建议。

编辑：当我单步执行代码时，浮点值看起来很正常，直到“float temp = [string floatValue]”行，这就是值似乎被垃圾的地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:00:38.060

当 arc4random() 的结果是 uint32_t 时，为什么要使用浮点数？切换到整数类型几乎肯定会解决所有这些问题，因为我怀疑问题是因为转换为字符串形式只允许 3 个有效数字。如果你使用 %.15f 作为你的格式会发生什么？

旁注：使用 arc4random_uniform() - 它更简单，并且保证在该范围内是均匀随机分布。

# maven - 如何让 Maven 从修改的代码（delombok'd）而不是从 src/main/java 编译

> ID：13479099
> 
> 赞同：1
> 
> 时间：2012-11-20T17:50:51.990
> 
> 标签：maven, lombok, maven-compiler-plugin

使用 delombok maven 插件将我的所有文件放在“target/generated-sources/delombok”中。~~当我尝试运行 maven 编译器时，它会抱怨重复的类，所以我按照[这个问题的建议](https://stackoverflow.com/questions/11329965/how-to-ignore-the-java-source-directory-during-maven-compilation)将 addOutputDirectory 设置为 false 。~~现在的问题是 delombok 的文件被忽略了，因此编译器抱怨缺少方法。

如何告诉 maven 编译器插件忽略默认的“src/main/java”目录，而是使用“target/generated-sources/delombok”目录进行编译？

当编译器运行时，运行 mvn compile -X 会产生以下输出：

```
[DEBUG]   (f) compileSourceRoots = [C:\Users\Jamey.Holden\workspace\Apollo\Website\src\main\java, C:\Users\Jamey.Holden\workspace\Apollo\Website\target\generated-sources\java]
[DEBUG]   (f) compilerId = javac
[DEBUG]   (f) debug = true
[DEBUG]   (f) encoding = UTF-8
[DEBUG]   (f) failOnError = true
[DEBUG]   (f) forceJavacCompilerUse = false
[DEBUG]   (f) fork = false
[DEBUG]   (f) generatedSourcesDirectory = C:\Users\Jamey.Holden\workspace\Apollo\Website\target\generated-sources\annotations
[DEBUG]   (f) mojoExecution = org.apache.maven.plugins:maven-compiler-plugin:3.0:compile {execution: default-compile}
[DEBUG]   (f) optimize = false
[DEBUG]   (f) outputDirectory = C:\Users\Jamey.Holden\workspace\Apollo\Website\target\classes
[DEBUG]   (f) proc = none
[DEBUG]   (f) projectArtifact = ic.apollo:website:war:0.1
[DEBUG]   (f) showDeprecation = false
[DEBUG]   (f) showWarnings = false
[DEBUG]   (f) skipMultiThreadWarning = false
[DEBUG]   (f) source = 1.6
[DEBUG]   (f) staleMillis = 0
[DEBUG]   (f) target = 1.6
[DEBUG]   (f) verbose = false
[DEBUG]   (f) mavenSession = org.apache.maven.execution.MavenSession@393e6226
[DEBUG]   (f) session = org.apache.maven.execution.MavenSession@393e6226 
```

然后再往下打印命令行选项，我可以看到 -sourcepath 参数是：`-sourcepath C:\Users\Jamey.Holden\workspace\Apollo\Website\src\main\java;C:\Users\Jamey.Holden\workspace\Apollo\Website\target\generated-sources\java;` 这些都不是 delombok 目录，所以它在尝试编译时找不到所有的 getter 和 setter 是很公平的。

**更新** 我想我已经找到了问题的根源。我正在设置 proc=none 以防止注释处理，因为我正在使用 queryDSL 生成元实体，并且当未设置此项以避免注释处理时，编译器发现重复实体错误。删除 proc=none 和 querydsl 注释处理器解决了这个问题。现在我只是去让 m2e 再次工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T10:05:18.180

看起来您没有阅读[文档](http://awhitford.github.com/lombok.maven/lombok-maven-plugin/usage.html)，因为插件需要像这样正确配置，这是 generate-sources 生命周期阶段，之后生成的源文件将由 maven-compiler-plugin 自动拾取.

```
<build>
  <plugins>
    <plugin>
      <groupId>org.projectlombok</groupId>
      <artifactId>lombok-maven-plugin</artifactId>
      <version>0.11.6.0</version>
      <executions>
        <execution>
          <phase>generate-sources</phase>
          <goals>
            <goal>delombok</goal>
          </goals>
        </execution>
      </executions>
    </plugin>
  </plugins>
</build> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-14T13:25:51.930

这不会对每个人都有用。但是如果你使用 lombok*编写自己的注解处理器*，那么你需要有不同的配置。

要创建没有 lombok 的编译器，您需要将 proc 设置为 none：

```
 <plugins>
        <plugin>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>${maven-compiler-plugin.version}</version>
            <configuration>
                                    <proc>none</proc>
                <source>${java.version}</source>
                <target>${java.version}</target>
            </configuration>
        </plugin>
    </plugins> 
```

并且使用 lombok 您必须明确设置注释处理器：

```
 <plugins>
        <plugin>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>${maven-compiler-plugin.version}</version>
            <configuration>
                <source>${java.version}</source>
                <target>${java.version}</target>
                <annotationProcessors>
                    <annotationProcessor>lombok.core.AnnotationProcessor</annotationProcessor>
                </annotationProcessors>
            </configuration>
        </plugin>
    </plugins> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T11:34:20.780

做类似的事情

```
 <plugin>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-compiler-plugin</artifactId>
      <version>3.0</version>
      <configuration>
        <includes>
            <include>target/generated-sources/delombok/*.java</include>
        </includes>
        <excludes>
            <exclude>src/main/java</exclude>
        </excludes>         
      </configuration>
    </plugin> 
```

# .net - 防止用户在.net windows 窗体应用程序中同时单击同一个按钮？

> ID：13479104
> 
> 赞同：1
> 
> 时间：2012-11-20T17:51:07.910
> 
> 标签：.net, vb.net, concurrency, windows-forms-designer

有没有办法防止用户在 VB.net windows 窗体应用程序中同时单击同一个按钮。

在每台用户机器上本地安装的应用程序，当 2 个或更多用户单击同一个按钮调用相同的功能或 Web 服务时，我们会遇到一些问题。

非常感谢

莫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:01:48.557

您需要在 web 服务（或任何其他共享的中央组件）中处理并充分处理它。

让 Web 服务检测到另一个调用已经开始并返回一个独特的错误代码或其他消息（或等待，然后在第一个请求完成时执行第二个请求）。

当您处理多个系统或程序无法直接控制的多个资源时，您需要认识到，再多的预检查也无法阻止竞争条件的发生：

您可以执行检查（确定没有其他人正在执行操作`X`）然后尝试执行操作`X`- 在检查和执行之间的一小部分时间内，其他人可能已经开始执行操作`X`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T17:57:30.697

您可以使用[远程对象](http://www.codeproject.com/Articles/14791/NET-Remoting-with-an-easy-example)的状态来启用或禁用按钮，但我强烈建议引入[异步](http://www.codeproject.com/Articles/14662/Access-Web-Services-Asynchronously-in-NET-Design-P)性，以便您可以阻止操作，直到其他用户完成对资源的独占使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:53:06.443

我建议在服务器端实现像观察者这样的设计模式（参见[http://en.wikipedia.org/wiki/Observer_pattern](http://en.wikipedia.org/wiki/Observer_pattern)以获取参考）。您也可以使用单例来执行此操作。论文只是处理这些问题的现有想法。

在 Observer 中，它将保存一组允许调用方法的对象。当一个正在执行时，您可以通知所有其他人禁用调用它的按钮，并在处理完成时通知回来。

如果您需要更多信息，请询问我会尽量使其更清楚。

# r - ggplot上的抛物线参考线

> ID：13479105
> 
> 赞同：5
> 
> 时间：2012-11-20T17:51:11.360
> 
> 标签：r, ggplot2

我正在将我的情节移动到 ggplot 中。除了这个（代码来自[上一个问题](https://stackoverflow.com/questions/6155588/add-95-confidence-limits-to-cumulative-plot)）之外几乎都存在：

![ggplot 图应该是这样的](../Images/aed71ac5cb8e9df7248cc940e8587a10.png)

```
#Set the bet sequence and the % lines
betseq <- 0:700 #0 to 700 bets
perlin <- 0.05 #Show the +/- 5% lines on the graph

#Define a function that plots the upper and lower % limit lines
dralim <- function(stax, endx, perlin) {
  lines(stax:endx, qnorm(1-perlin)*sqrt((stax:endx)-stax))
  lines(stax:endx, qnorm(perlin)*sqrt((stax:endx)-stax))
}

#Build the plot area and draw the vertical dashed lines
plot(betseq, rep(0, length(betseq)), type="l", ylim=c(-50, 50), main="", xlab="Trial Number", ylab="Cumulative Hits")
abline(h=0)
abline(v=35, lty="dashed") #Seg 1
abline(v=185, lty="dashed") #Seg 2
abline(v=385, lty="dashed") #Seg 3
abline(v=485, lty="dashed") #Seg 4
abline(v=585, lty="dashed") #Seg 5

#Draw the % limit lines that correspond to the vertical dashed lines by calling the
#new function dralim.
dralim(0, 35, perlin) #Seg 1
dralim(36, 185, perlin) #Seg 2
dralim(186, 385, perlin) #Seg 3
dralim(386, 485, perlin) #Seg 4
dralim(486, 585, perlin) #Seg 5
dralim(586, 701, perlin) #Seg 6 
```

我可以显示我已经走了多远（不远）：

```
ggplot(a, aes(x=num,y=s, colour=ss)) +geom_line() +stat_smooth(method="lm", formula="y~poly(x,2)") 
```

![我的尝试](../Images/ebce8afe33a0857e220b3d838f19aef9.png)

要清楚。我正在将我的数据绘制在参考线上（上图）。底部图像显示了我的数据以及我在获取参考线方面的糟糕尝试（显然没有奏效）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:10:23.067

您所做的是为您的数据拟合抛物线，而不是绘制先前定义的抛物线。适应你必须适应的东西并不难`ggplot`。

与您相同的开始（尽管`betseq`实际上并未在任何地方使用）

```
#Set the bet sequence and the % lines
betseq <- 0:700 #0 to 700 bets
perlin <- 0.05 #Show the +/- 5% lines on the graph 
```

不要代替绘制线条的函数，而是创建一个返回`geom_line`您想要的 s （在列表中）的函数。`aes(x=x, y=y)`稍后将在声明中给出一个暗示`ggplot`，但这定义了构成抛物线的数据点。

```
#Define a function that plots the upper and lower % limit lines
dralim <- function(stax, endx, perlin) {
  c(geom_line(data = data.frame(x=stax:endx, 
                                y=qnorm(1-perlin)*sqrt((stax:endx)-stax))),
    geom_line(data = data.frame(x=stax:endx, 
                                y=qnorm(perlin)*sqrt((stax:endx)-stax))))
} 
```

为了避免重复，定义垂直线的位置（`edges`），也可以用来定义抛物线的左右端点（`ranges`）。

```
edges <- data.frame(x=c(0, 35, 185, 285, 485, 585, 700))
ranges <- data.frame(left = edges$x[-nrow(edges)],
                     right = edges$x[-1] + 1) 
```

现在构建`ggplot`. 有一个`geom_vline`可以绘制所有垂直线（因为我们在单个数据集中定义了位置）。不寻常的步骤是遍历 of 的行（索引）并使用相应的左值和右值（和）`ranges`调用。这将返回 的列表列表，但可以以正常方式将其添加到绘图中，并添加所有行。最后两个 scale 调用只是设置标签，如果是 y 轴，则设置范围。`dralim``perlin``geom_lines`

```
ggplot(mapping=aes(x=x,  y=y)) +
  geom_vline(data=edges, aes(xintercept = x), linetype="dashed") +
  lapply(seq_len(nrow(ranges)), 
         function(r) {dralim(ranges$left[r], ranges$right[r], perlin)}) +
  scale_y_continuous("Cumulative Hits", lim=c(-50,50)) +
  scale_x_continuous("Trial Number") 
```

![在此处输入图像描述](../Images/c4260f79231be781ebf8112999931f7c.png)

# domain-driven-design - CQRS + 事件溯源。更改聚合根历史记录

> ID：13479110
> 
> 赞同：4
> 
> 时间：2012-11-20T17:51:44.580
> 
> 标签：domain-driven-design, cqrs, event-sourcing

我有以下问题。给定。CQRS + EventSourcing 应用程序。这怎么可能改变历史中聚合根的状态？

例如，会计申请，会计想申请交易但日期已过。将存储在事件存储中的事件将具有比最近事件更早的日期，但该事件的序列号会更大。

存储库将通过按序列号对事件进行排序来恢复聚合根的状态。如果我们将拍摄过去日期的快照 - 我们将拥有没有此事件的聚合根。

我们当然可以将存储库的逻辑更改为按日期对事件进行排序，但是我们使用 CQRS 的外部框架，这是不可取的。

这种情况有一些优雅的解决方案吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-20T23:33:25.887

您正在寻找的是双时间实现。

例如，在 12 月 3 日，我们认为 X == 12 (as-at)，但在 12 月 5 日，我们纠正了错误，现在知道 X == 14 在 12 月 3 日 (as-of)

有两种方法可以实现这一点

1) 事件存储保存原始数据，投影保存原始数据（可能的变化是原始和原始投影）

2) 聚合有一个重载方法，指示对事件存储中的 as-of 与 as-at 值的需求。这很可能涉及使用自定义辅助快照流来获取当前数据值。

您的解决方案很可能同时使用这两种实现，因为一种以命令为中心，另一种以查询为中心。

当收到纠正事件时，需要重建第二个选项中聚合根的最新快照。

[Martin Folwler 在本文](http://www.martinfowler.com/eaaDev/EventSourcing.html)中谈到了这一点

注意：事件存储仍然只是附加的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-20T18:47:54.050

在会计方面，如果您更改过去的预订，您可能最终会入狱。不要改变过去。请改用补偿命令。

抱歉，但您提出了会计示例，这可能是一个非常严格地摆弄过去数据而不明确更改的领域。

如果上述内容不适用于您的域，您可以轻松地在旧事件之上应用新事件，从而更改域对象的状态（可能还有历史记录）。

以预订帐户为例。该事件可能发生在今天，但它可以将实际预订日期设置为过去的某个时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T18:52:15.290

对此的一种解决方案是将事件视为明确的补偿动作。例如，当您的银行撤销费用时，他们不会删除现有交易，而是添加补偿交易。该交易可以引用他们希望通过各自的约会来补偿的交易。通过这种方式，事件是现实的适当表现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T18:41:07.840

会计不允许你改变历史。它只允许您添加条目。您可以根据自己的意愿解释这些事件的日期，这取决于您的业务逻辑。在这种情况下，事件序列不仅仅是与事件溯源一样的持久性技巧，而是域的实际内容！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-20T18:29:20.983

您已声明您的业务逻辑允许您添加回溯交易；现在我不知道你为什么想要那个，但是没有什么限制你的聚合不接受它。当然，该事件将获得稍后的事件序列号/版本，但这是意料之中的。

你不需要摆弄基础设施、存储库或其他任何东西来做到这一点。

# c# - WPF 中的基本数据绑定

> ID：13479117
> 
> 赞同：1
> 
> 时间：2012-11-20T17:52:20.050
> 
> 标签：c#, wpf, xaml

我目前正在编写一个用于绘制类图的程序，并且正在使用 MVVM 模式。我的类在用户界面中的宽度和高度设置为自动，因为我让包含的元素定义大小。

问题是我需要模型中的宽度和高度来进行一些计算，所以我需要反向绑定或其他东西来更新模型中的属性，我对此不太了解。我该怎么做呢？

我试过这个，但没有奏效：

**XAML：**

```
Width="{Binding Width, Mode=OneWayToSource}" Height="{Binding Height,
Mode=OneWayToSource}"> 
```

**C＃**

```
private int width;
    public int Width {
        get { return width; }
        set {
            width = value;
        }
    }
    private int height;
    public int Height {
        get { return height; }
        set {
            height = value;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:28:39.303

当您调整 XAML 指向的任何元素的大小时，您所拥有的应该正确更新您的宽度和高度成员变量。

如果您还想更新代码中的值并将其反映在 XAML 元素中，则需要[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)和 TwoWay 绑定。您也可以使用依赖属性，但您可能不想在 ViewModel 代码中这样做。

编辑：根据我下面的评论，您似乎想绑定到 ActualWidth 和 ActualHeight 属性。MS Silverlight 文档指出：

> 出于 ElementName 绑定的目的，ActualWidth 在更改时不会发布更新（由于其异步和运行时计算性质）。不要尝试将 ActualWidth 用作 ElementName 绑定的绑定源。如果您有需要基于 ActualWidth 进行更新的方案，请使用 SizeChanged 处理程序。

.NET Framework 4.5 文档没有说明相同的警告，但它似乎暗示了 ReadOnly DP。我还看到了使用 XAML 中的触发器在线解决此问题的方法。[请参阅此处](https://stackoverflow.com/questions/1749253/wpf-readonly-dependency-properties-using-mvvm)接受的答案之后的讨论。该讨论表明 MS 无意使用 ReadOnly DP 解决此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:26:46.450

编辑：

您可能需要做 3 件事。

1.  您的类（定义了 Width 和 Height 属性的模型或视图模型）需要实现 INotifyPropertyChanged 接口。

2.  您还需要两种方式绑定，因为您想从代码中设置宽度/高度以及从用户那里获取它。

3.  您需要绑定 ActualWidth 和 ActualHeight - [WPF 中的 Width 和 ActualWidth 有什么区别？](https://stackoverflow.com/questions/607827/what-is-the-difference-between-width-and-actualwidth-in-wpf)

有关 INotifyPropertyChanged 的​​更多信息 - [http://msdn.microsoft.com/en-us/library/ms743695.aspx](http://msdn.microsoft.com/en-us/library/ms743695.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:29:52.103

确保您的视图模型设置为视图的 DataContext。您需要在视图模型中实现*INotifyPropertyChanged*。然后，将您的属性更新为如下所示：

```
 public int Width 
    {
        get { return width; }
        set 
          {
            if(width != value)
              {
                 width = value;
                 NotifyPropertyChanged();
              }
          }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T06:34:21.870

你可以试试

```
ActualWidth="{Binding Width, Mode=OneWayToSource}" ActualHeight="{Binding Height,
Mode=OneWayToSource}"> 
```

但是此代码可能并非每次都有效，因为在呈现 UI 之前，实际的宽度和高度不可用。

或者，您可以在 VM 中创建依赖属性并将其与宽度和高度绑定，Mode=OneWay。但是当您使用 MVVM 时，您的框架应该支持这一点。

# extjs - Sencha ExtJS 关联 POST 错了吗？

> ID：13479120
> 
> 赞同：0
> 
> 时间：2012-11-20T17:52:38.930
> 
> 标签：extjs

所以，我在使用 Sencha ExtJs 4.1 关联时遇到了问题。

我有类似的东西：

**楷模**

```
Ext.define('Tpl.model.User', {
    extend: 'Ext.data.Model',
    requires: ['Tpl.model.PostTemplate'],
    fields: [
        { name: 'id', type: 'int' },
        { name: 'name', type: 'string' },
        { name: 'postTemplate', type: 'int' }
    ],
    associations: [
        { type: 'belongsTo', name: 'postTemplate', model:'Tpl.model.PostTemplate', associationKey: 'postTemplate', primaryKey: 'id', foreignKey: 'postTemplate' }
    ]
});

and

Ext.define('Tpl.model.PostTemplate', {
    extend: 'Ext.data.Model',

    fields: [
        { name: 'id', type: 'int' },
        { name: 'blah', type: 'string' }
    ],

    associations: [
        { type: 'hasMany', model: 'Tpl.model.User' }
    ]

}); 
```

**专卖店**

```
Ext.define('Tpl.store.Users', {
    extend: 'Ext.data.Store',
    model: 'Tpl.model.User',
    autoLoad: true,
    proxy: {
        type: 'rest',
        url: '../users',
        reader: {
            type: 'json',
            root: ''
        },
        writer: {
            type: 'json'
        }
    }
});

Ext.define('Tpl.store.PostTemplate', {
    extend: 'Ext.data.Store',
    model: 'Tpl.model.PostTemplate',
    autoLoad: true,
    proxy: {
        type: 'rest',
        //appendId: true,
        url: '../postTemplates/',
        reader: {
            type: 'json',
            root: ''
        },
        writer: {
            type: 'json'
        }
    }
}); 
```

问题是我收到这样的帖子：

```
{
    "postTemplate": 1,
    "id": 0,
    "name": "foo"
} 
```

但我需要这样的帖子：

```
{
    "postTemplate": {
        "id": 1,
        "blah": "foo"
    },
    "id": 0,
    "name": "bar"
} 
```

此外，像“setPostTemplate”这样的评估功能不存在，我认为它应该自动创建。

已经尝试过类似“record.data.postTemplate = (...)”的东西，但我得到了一个无限循环，抛出了一个执行......

有人可以建议吗？另外，如果您需要其他可能对答案有用的东西，请告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:03:38.343

开箱即用的关联对象不会像您期望的那样序列化回服务器。这个问题已经被提过很多次了。最好的事情可能是关注这个线程：

[http://www.sencha.com/forum/showthread.php?141957-Saving-objects-that-are-linked-hasMany-relation-with-a-single-Store](http://www.sencha.com/forum/showthread.php?141957-Saving-objects-that-are-linked-hasMany-relation-with-a-single-Store)

该线程讨论了在 JSON 编写器类中覆盖 getRecordData。

# javascript - 使用 PHP 函数的文本区域的弹出预览

> ID：13479122
> 
> 赞同：1
> 
> 时间：2012-11-20T17:52:42.027
> 
> 标签：javascript, popup, textarea, preview

我想在弹出窗口中使用 PHP 函数对 textarea 进行弹出预览。

假设您在 textarea 中键入“Hello world”，然后单击“预览”，然后在弹出窗口中通过 PHP 函数将文本转换为“Hey you”（当然函数不是那么简单，这就是为什么我无法在纯 javascript 中调整它）。

有可能这样做吗？

我知道它可以轻松地将表单发送到中间页面，但我必须将表单保留在后台......这就是我需要快速预览的原因。

我做了以下事情：

```
 function PreviewMe() {
          var newWin = window.open("", "_blank");
         newWin.document.write("<html><body>"+document.getElementById('myText').value+"</body></html>");
          newWin.document.close();
        } 
```

和

```
<textarea id="myText"  ... /> 
<input type="submit" ... onclick="PreviewMe();"> 
```

显然它不需要重新格式化任何东西就可以工作，那么如何在弹出窗口中重新格式化这个结果呢？

是否有可能（并且可能是更好的选择）使用 XMLHttpRequest ？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T11:15:51.270

是的，您应该使用`XHR`请求将数据发送到脚本，该脚本将返回您要在客户端操作的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T12:24:18.123

谢谢，到最后就轻松多了。

如果它可能对其他人有所帮助，这就是我所做的。Js函数变成了：

```
function PreviewMe() {
    var xhr = null;
    if (window.XMLHttpRequest || window.ActiveXObject) {
        if (window.ActiveXObject) {
            try {
                xhr = new ActiveXObject("Msxml2.XMLHTTP");
            } catch(e) {
                xhr = new ActiveXObject("Microsoft.XMLHTTP");
            }
        } else {
            xhr = new XMLHttpRequest(); 
        }
    } else {
        alert("XMLHTTPRequest not supported...");
        return;
    }
    xhr.open("POST", "page.php", true);
    xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");

    xhr.onreadystatechange = function() {
        if (xhr.readyState == 4 && (xhr.status == 200 || xhr.status == 0)) {
            document.getElementById('show').innerHTML = xhr.responseText;
        } 
    };      

    xhr.send("var="+document.getElementById('myText').value+"");
    return;
} 
```

当然`page.php`包括我的php函数，`show`就是打印结果的div的id。

# mysql - MySQL 随机连接

> ID：13479125
> 
> 赞同：2
> 
> 时间：2012-11-20T17:52:48.863
> 
> 标签：mysql, join, random

这是我的 MySQL 数据库：

![在此处输入图像描述](../Images/7adbd8eff137c2a9d053b07e2df2684f.png)

我的查询以获取所有子类别：

```
SELECT `a`.`id`, `a`.`name`, `a`.`url_segment`, `a`.`categories_id`, `b`.`image` AS supplements_image
FROM (`subcategories` AS a)
LEFT JOIN `supplements` AS b ON `b`.`subcategories_id` = `a`.`id`
LEFT JOIN `reviews` AS c ON `c`.`supplements_id` = `b`.`id`
GROUP BY `a`.`id`
ORDER BY `a`.`categories_id` ASC, COUNT(c.id) DESC, `b`.`image` ASC 
```

问题在于子类别图像，它应该是该子类别中随机产品的图像，但我总是得到第一个产品的图像。知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T17:56:32.477

```
SELECT `a`.`id`, `a`.`name`, `a`.`url_segment`, `a`.`categories_id`, 
        (SELECT `image` 
         FROM `supplements` 
         WHERE `subcategories_id` = `a`.`id` 
         ORDER BY RAND() LIMIT 1
        ) AS supplements_image
FROM (`subcategories` AS a)
LEFT JOIN `reviews` AS c ON `c`.`supplements_id` = `a`.`id`
GROUP BY `a`.`id`
ORDER BY `a`.`categories_id` ASC, COUNT(c.id) DESC 
```

编辑了未指定的别名`b`，现在效果很好：[见小提琴！](http://sqlfiddle.com/#!2/ba784/4)

# haskell - 如何停止 Gloss 需要越来越多的内存？

> ID：13479126
> 
> 赞同：5
> 
> 时间：2012-11-20T17:52:48.267
> 
> 标签：haskell, graphics

我在 Haskell 中使用 Gloss 创建 RTS 游戏，但我注意到即使是非常简单的程序在运行时也会占用越来越多的内存。例如，以下程序将逐渐增加其内存使用量（它将需要 ~0.025mb per second ）。

```
module Main (
    main
)
where

import Graphics.Gloss
import Graphics.Gloss.Interface.IO.Game

main = 
    playIO (InWindow "glossmem" (500, 500) (0,0)) white 10 0
    (\world -> return (translate (-250) 0 (text $ show world)))
    (\event -> (\world -> return world))
    (\timePassed -> (\world -> return $ world + timePassed)) 
```

我尝试在运行时限制堆大小，但这只会导致程序在达到限制时崩溃。我担心当我有一个更复杂的世界时，这种行为会成为一个性能问题，有没有办法使用光泽度这样这不会成为问题？还是我使用了错误的工具来完成这项工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T05:30:54.780

谢谢，我在gloss-1.7.7.1 中修复了这个问题。这是管理动画帧时间的代码中典型的惰性引起的空间泄漏。您的示例程序现在在恒定空间中运行。

# php - 如何在PHP中对值进行反向排序？

> ID：13479127
> 
> 赞同：1
> 
> 时间：2012-11-20T17:52:56.040
> 
> 标签：php, arrays, sorting

我在数据库中有这些值：

|12||3||28||7||54|

我的代码（见下文）返回这些字符串：

用户名_12

用户名_3

用户名_28

如何反向排序？

如何获得这些值：

用户名_54

用户名_7

用户名_28

```
function display_user_friends($profileuserid,$friends,$base_url,$rewrite,$template_directory,$default_avatar) {
  if(!empty($friends)){
        $x = 0;
        $friends = explode("|",$friends);
        foreach($friends as $friend) {
          if($friend>0 && (strpos($already_displayed,"|$friend|")===false) && ($x < 3) {
              $sql_query = "SELECT username,userid FROM users WHERE userid = $friend && userstatus = 1 LIMIT 1";
              $result = @mysql_query($sql_query);
              if(mysql_num_rows($result))
              {
              while($row = mysql_fetch_array($result))
              {
                $x++;

                $already_displayed.="|$friend|";

                $username = stripslashes($row['username']);
                $userid = $row['userid'];
                $content.="<b>$username</b><br>";
              }                  
            }
          }
        }
  }
  else
    $content = "No friends found.";

  return $content;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T17:57:32.937

您的查询，添加`order by`到它。

```
 $sql_query = "SELECT username,userid 
               FROM users 
               WHERE userid = $friend && userstatus = 1 
               ORDER BY userid DESC
               LIMIT 1"; 
```

或类似的东西。

注意：许多答案总是建议您不要使用 mysql，而是使用 PDO 或 mysqli。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T17:57:40.830

更改您的查询。添加 ORDER BY something DESC

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T17:58:04.183

我想你正在寻找**[`array_reverse()`](http://php.net/manual/en/function.array-reverse.php)**.

> ```
> array array_reverse ( array $array [, bool $preserve_keys = false ] ) 
> ```
> 
> 接受一个输入数组并返回一个元素顺序颠倒的新数组。

# cognos - 刚果错误的搜索路径

> ID：13479131
> 
> 赞同：0
> 
> 时间：2012-11-20T17:53:03.873
> 
> 标签：cognos, search-path

在刚果...我导航到我的报告文件夹并单击报告。我收到错误消息：内容管理器没有为请求的搜索路径返回对象...而且我看到该路径确实不是当前文件夹。cognos 从哪里得到这个搜索路径？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:34:30.417

谢谢。在报告中有一个组件布局参考，它指的是一条损坏的路径。在我的预期中，这不应该阻止报告的开放。它应该在报告工作室中打开报告，并且参考应显示为“未找到组件参考”。

但是无论如何，如果组件引用引用了损坏/移动的路径等，Cognos 甚至都不会打开报告。

为了解决这个问题，我重新创建了损坏的路径，然后打开了报告，然后更正了组件引用。

# opencl - 私有内存索引 OpenCL

> ID：13479134
> 
> 赞同：2
> 
> 时间：2012-11-20T17:53:07.593
> 
> 标签：opencl

我正在努力解决 OpenCL[规范](http://www.khronos.org/registry/cl/specs/opencl-1.0.pdf "规格")，因为我发现它有时模棱两可，有人可以尝试回答以下问题吗？

考虑以下代码：

```
__kernel void myKernel(...)
{    
    // Buffer 1
    __local float *buffer1[64];

    // Buffer 2
    __local float *buffer2;

    // Buffer 3
    __private float *buffer3[64];

    // Buffer 4
    float *buffer4[64];

    int var1 = 1, var2 = 2;
    nonKernelFunction(&var1, &var2);

    // ...

}

void nonKernelFunction(int *pvar1, int *pvar2)
{
    int *pvar;
    if (someRunTimeCondition)
        pvar = pvar1;
    else
        pvar = pvar2;
    *pvar += 1; 
} 
```

1) buffer1 和 buffer2 之间是否有区别（静态或动态）？

2) buffer3 和 buffer4 的声明是否等效（它们用于变量，但我不确定指针）？

3）在GPU上（我认为私有内存只是寄存器），编译器将在哪里分配资源？如果它在全局内存中，是否可以从主机知道运行时将使用多少内存？

4) 假设 buffer3 和 buffer4 存储在寄存器中，如何允许诸如 buffer3[i] = buffer4[i] （其中 i 在运行时已知）之类的指令？

5）如果buffer3和buffer4没有存入寄存器，那么，如何允许nonKernelFunction代码（var1和var2肯定不在内存中）？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:33:49.323

AFAIK ：

1）内核代码中的静态规范与主机通过缓冲区的“动态”规范之间没有技术差异；

2）默认变量是 __private 所以这应该没有任何区别；

3) 私有内存可以分配在寄存器中，如果很小，否则将使用全局内存；您可以使用 clGetKernelWorkGroupInfo 查询内核的最低内存要求；

4）为什么不允许它们，因为它可能导致超出范围的错误？

5) var1 和 var2 在 GPU 的地址空间中，即使不在私有内存中；访问可能会更慢，仅此而已。

EDIT1：var1 和 var2 在寄存器中的事实，比如 reg1 和 reg2，不应该是一个问题，因为代码可能会导致伪汇编，如：

```
myKernel:
    ...
    push reg1
    push reg2
    call nonKernelFunction
    ...

nonKernelFunction:
    test someRunTimeCondition
    jz ko
        mov [SP+2] reg1
        jmp end:
    ko:
        mov [SP+1] reg1
    end:
    mov [reg1] reg2
    inc reg2
    mov reg2 [reg1] 
```

我不知道 GPU 组件/核心架构是否有很大不同，但在标准 CPU 上没有问题，因为您使用堆栈来抽象有效位置。

请注意，这里有更新版本的规范 :) [http://www.khronos.org/registry/cl/specs/opencl-1.2.pdf](http://www.khronos.org/registry/cl/specs/opencl-1.2.pdf)

# java - 带有类名的Java字符串到类

> ID：13479137
> 
> 赞同：1
> 
> 时间：2012-11-20T17:53:23.950
> 
> 标签：java, reflection

对不起，奇怪的主题名称，找不到合适的。对于我的问题，我想在 Java 中创建一些动态的东西，它是一个非常简单的类，可以接受一个事件并将其扔掉，遗憾的是我正在使用的系统是这样的，所以每个事件都必须有它自己的事件所在的方法方法的参数，但好消息是我们可以添加任意数量的事件监听器类！我希望我的程序能够通过添加和删除监听类来动态添加和删除正在监听的方法。

我不擅长 Java，但对 C# 有相当多的过期时间，所以我像在那里一样攻击了我的问题并创建了这个类。

```
public class TESPluginDynListener<T> implements Listener {

    TESPlugin plugin;

    public TESPluginDynListener(TESPlugin plugin){
        this.plugin = plugin;
    }

    @EventHandler(ignoreCancelled=false, priority = EventPriority.LOW)
    public void onDynEvent(T event){
        if(event instanceof Event)
            plugin.onEvent((Event)event);
    }
} 
```

这似乎工作正常，但我的问题是，我必须注册的事件是否作为字符串得到，例如“some.package.someEvent”，我不知道如何将其转换为 T 型，所以我可以添加监听器类。

那么如何在我的类 TESPluginDynListener 中创建一个实例，其中 T 是从字符串翻译的？我对做很多 if else 不感兴趣，因为我希望它尽可能动态！

这是我想要做的事情的一个想法

```
String eventClass = "some.package.someEvent";

TESPluginDynListener listener = new TESPluginDynListener<Type.FromName(eventClass)>(this);
eventhandeler.RegisterListener(listener); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T17:54:48.583

听起来您正在寻找[`Class.forName`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#forName%28java.lang.String%29)and [`Class.newInstance`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#newInstance%28%29)。

另一方面，请记住，泛型中的类型擦除意味着您实际上不需要知道`T`就可以构建`TESPluginDynListener`...您可能希望接受`Class<T>`构造函数 for`TESPluginDynListener`和 use[`Class.isInstance`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#isInstance%28java.lang.Object%29)而不是`instanceof`within `onDynEvent`。

# erlang - 什么时候适合从零增加异步线程大小？

> ID：13479142
> 
> 赞同：15
> 
> 时间：2012-11-20T17:53:34.037
> 
> 标签：erlang

我一直在阅读文档，试图了解何时通过 +AN 开关增加异步线程池大小是有意义的。

我完全准备好进行基准测试，但我想知道是否有一个经验法则，当人们应该怀疑将池大小从 0 增加到 N（或 N 到 N+M）会有所帮助时。

谢谢

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-11-21T16:30:22.977

*BEAM 在调用调度*程序的特殊线程中运行 Erlang 代码。默认情况下，它将为处理器中的每个内核启动一个调度程序。这可以控制和启动时间，例如，如果您不想在所有内核上运行 Erlang，而是“保留”一些用于其他事情。通常，当您执行文件 I/O 操作时，它会在调度程序中运行，并且由于文件 I/O 操作相对较慢，它们会在运行时阻塞该调度程序。这会影响实时属性。通常你不会做那么多的文件 I/O，所以这不是问题。

*异步线程池*是用于 I/O 操作的操作系统线程。通常池是空的，但如果您`+A`在启动时使用，那么 BEAM 将为该池创建**额外的线程。**然后这些线程将仅用于文件 I/O 操作，这意味着调度程序线程将不再阻塞等待文件 I/O，并且实时属性得到改善。当然，这是因为操作系统线程不是免费的。线程不会混合，因此调度程序线程只是调度程序线程，而异步线程只是异步线程。

如果您正在为端口编写*链接驱动程序*，这些驱动程序也可以使用异步线程池。但是您必须自己检测它们何时启动。

您需要多少取决于您的应用程序。默认情况下没有启动。像@demeshchuk 一样，我也听说 Riak 在打开许多文件时喜欢拥有一个大型异步线程池。我唯一的建议是尝试并测量。与所有优化一样？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T08:50:29.263

默认情况下，正在运行的 Erlang VM 中的线程数等于处理器逻辑核心数（当然，如果您使用的是 SMP）。

根据我的经验，当您同时进行许多文件 I/O 操作时，增加 +A 参数可能会提高一些性能。而且我怀疑增加 +A 可能会提高整体流程的性能，因为 BEAM 的调度程序非常快速且经过优化。

说到确切的数字——我认为这完全取决于你的应用程序。比如说，在 Riak 的情况下，打开文件的最大数量或多或少是可预测的，您可以将 +A 设置为这个最大值，或者如果它太大（默认为 64，顺便说一句），则可以少几倍。如果您的应用程序包含数百万个文件，并且您将它们提供给 Web 客户端 - 那是另一回事；最有可能的是，您可能希望使用自己的代码和自己的环境运行一些基准测试。

最后，我相信我从来没有见过+A超过一百。并不意味着你不能设置它，但它可能没有意义。

# php - 为什么这个 MySQL INSERT 在 CI 中不起作用？

> ID：13479143
> 
> 赞同：1
> 
> 时间：2012-11-20T17:53:35.960
> 
> 标签：php, codeigniter

由于某种原因，此 SQL 语句不起作用。谁能告诉我为什么？（如果重要的话，这是一个 Codeigniter 网站）

这是我的模型（我的错误指向我）

```
public function edit_profile($ID, $field, $new_info)
{
    $sql = "UPDATE users SET ?=? WHERE id=?";
    $query = $this->db->query($sql, array($field, $new_info, $ID)); // <<<< LINE 42
    return $query;
} 
```

这是我得到的错误

```
Error Number: 1064
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''first_name'='oooo' WHERE id='151'' at line 1
UPDATE users SET 'first_name'='oooo' WHERE id='151'
Filename: /Applications/MAMP/htdocs/MY_SITE/models/member_model.php
Line Number: 42 
```

我的表被称为“用户”，我有一个“名字”和“ID”列。

想法？

**编辑**

仅仅因为它似乎出现了一点，我想澄清一下我在这里传递的变量没有引号或反引号。它们被添加到某个地方（它似乎是 ->query 方法，但我无法想象这是真的？.. 不知道，因为这是我的第一个 CI 项目）

这是传递给模型的控制器...

```
public function profileEdit()
{
    $ID = $this->the_user->id;
    $field = $this->input->post('edit_field')
    $field = strstr($field,'_edit', true);
    $new_info = $this->input->post('new_info');

    $this->load->model('Member_model');
    if( $this->Member_model->edit_profile( $ID, $field, $new_info )){
        echo 'success';
    }
    else
    {
        echo 'error';
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T17:58:27.887

我建议这样使用：

```
public function edit_profile($ID, $field, $new_info)
{
    $sql = "UPDATE users SET $field =? WHERE id=?"; # UPDATED (remove $this->db->escape())
    $query = $this->db->query($sql, array($new_info, $ID)); // <<<< LINE 42
    return $query;
} 
```

如果 $field 不安全，您可以使用转义函数。
编辑：
$this->db->e​​scape() 将在变量周围添加引号，因此您将再次收到错误。

# matlab - 为什么matlab在iwishrnd(A,df)函数中调用A为协方差矩阵？

> ID：13479145
> 
> 赞同：0
> 
> 时间：2012-11-20T17:53:49.957
> 
> 标签：matlab, linear-algebra

当我调用 iwishrnd() 函数时出现此错误： 正如我在上一个问题中解释的那样：[为什么 eig(A) 函数（其中 A 是半正定函数）返回负双精度数？](https://stackoverflow.com/questions/13478359/why-does-eiga-function-in-which-a-is-a-positive-semidefinite-function-return)
`??? Error using ==> iwishrnd at 41
Covariance matrix must be symmetric and positive definite.`

我想知道，为什么matlab将此参数称为*协方差矩阵*？

我知道，该矩阵用作多元正态分布的协方差矩阵的共轭先验，但它与该协方差矩阵的均值成正比（如您在[http://en.wikipedia.org/wiki/中所见）逆-Wishart_distribution](http://en.wikipedia.org/wiki/Inverse-Wishart_distribution)）。那么，将其称为分布的平均值而不是协方差矩阵不是更好吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:08:22.750

这是一个命名问题；将 Wishart 分布中的 A 参数称为“协方差矩阵”是相对常见的，因为它 (1) 必须具有协方差矩阵的所有属性，(2) Wishart 分布的输出几乎总是用作协方差矩阵（例如，Wishart 是高斯的共轭先验，参见下面的链接）和 (3) A 表示从 Wishart 分布输出的预期协方差矩阵的平均值。

如果您想知道的话，A 并不代表 Wishart 分布的协方差。

[http://en.wikipedia.org/wiki/Conjugate_prior#Table_of_conjugate_distributions](http://en.wikipedia.org/wiki/Conjugate_prior#Table_of_conjugate_distributions)

# string - 从表中的 Note 列中查找并返回 Urls

> ID：13479154
> 
> 赞同：1
> 
> 时间：2012-11-20T17:54:27.247
> 
> 标签：string, sqlite, url, return, substring

我有一个带有列（注）的 sqlite 数据库，其中包含各种内容。有些行中有 URL，我想得到这些的列表。

我可以这样找到它们：SELECT SUBSTR(Note,'http') FROM PersonTable WHERE Note LIKE 'http%'

但是，当它找到一个 Url 时，它会返回 Note 列中的整个字符串。我想要的是只返回 URL 没有别的。

我知道这对于任何熟悉 SQL 的人来说一定很简单，但它对我来说是新的。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:57:01.563

该[`SUBSTR`函数](http://www.sqlite.org/lang_corefunc.html#substr)期望它的第二个参数是开始位置；`'http'`只会被解释为`0`.

SQLite 没有内置函数可以允许找到 URL 的结尾；您应该在程序中拆分返回的列值。

# javascript - 现有导航的主要内容滑块建议

> ID：13479155
> 
> 赞同：0
> 
> 时间：2012-11-20T17:54:34.807
> 
> 标签：javascript, jquery, html, slider, navbar

我正在尝试在现有的 html 页面上制作内容滑块。基本上，当用户单击导航链接时，内容将“滑出”当前页面并“滑入”相应页面。

我过去使用过滑块，但没有绑定到已经存在的导航栏。

有什么建议吗？

我的html结构是这样的：

```
<div id="wrapper">
  <ul class="nav">
    <li class="navlink">item</li>
    <li class="navlink">item</li>
    <li class="navlink">item</li>
    <li class="navlink">item</li>
  </ul>
  <div class="content">
     content
  </div>
</div> 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:02:33.780

你的意思是“页面转换”吗？有很多不同的方法可以做到这一点，包括[这个以前的 SO 帖子](https://stackoverflow.com/questions/10166510/how-to-slide-an-entire-page-on-load-with-jquery)，或者[这个 fading one](http://www.onextrapixel.com/2010/02/23/how-to-use-jquery-to-make-slick-page-transitions/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T18:28:13.403

你可以看看这个，做了一个非常简单的脚本。

**工作示例：http:** [//jsfiddle.net/9rde7/6/](http://jsfiddle.net/9rde7/6/)

**HTML：**

```
<div id="wrapper">
  <ul class="nav">
    <li class="navlink" page="page1">item</li>
    <li class="navlink" page="page2">item</li>
    <li class="navlink" page="page3">item</li>
  </ul>
  <div class="content">
     <div class="content-page active" id="page1">Content 1</div>
     <div class="content-page" id="page2" style="background:#666">Content 2</div>
     <div class="content-page" id="page3">Content 3</div>
  </div>
</div>​​​​​​ 
```

**CSS：**

```
.content{
    background:#efefef;
    position:relative;
    width:99%;
    height:500px;
    margin:0 auto;
    overflow:hidden;
}

.content-page{
    background:#dddddd;
    position:absolute;
    width:100%;
    height:100%;
    left:100%;
}

.content-page.active{
    left:0;
} 
```

**Javascript：**

```
$('.nav li').bind('click', function(){
    $page = $('#'+$(this).attr("page"));
    if($page.hasClass("active")) return;

    $('.content-page.active').animate({left:"100%"},200);
    $('.content-page').removeClass("active");
    $page.animate({left:"0"},200, function(){$page.addClass("active");});
}); 
```

# mysql - 无法更改mysql连接限制

> ID：13479156
> 
> 赞同：1
> 
> 时间：2012-11-20T17:54:39.620
> 
> 标签：mysql, connection, limit

我在只运行 8 核和 16GB 内存的 mysql 的 linux 机器上。所有连接都来自同一网络中另一台机器上的 web 服务器，该机器使用 codeigniter 运行 php。

我无法在 mysql 上获得超过 150 个连接。

我的 my.cnf 是：

```
[mysqld]
user=mysql
port            = 3306
socket          = /tmp/mysql.sock
datadir = /usr/local/mysql/var/
skip-external-locking
max_connections=500
max_user_connections=500
open-files-limit = 500
key_buffer_size = 2048M
max_allowed_packet = 32M
table_open_cache = 512
sort_buffer_size = 2M
read_buffer_size = 2M
read_rnd_buffer_size = 16M
myisam_sort_buffer_size = 128M
thread_cache_size = 250
table_definition_cache = 1024

query_cache_size = 32M
query_cache_limit = 32M
table_cache=1024
max_heap_table_size=1024M
key_buffer=2048M
wait_timeout=60
thread_concurrency = 16
long_query_time = 1
tmp_table_size=256M 
```

show status 返回 max_connections 和 max_user_connections 为 500。

由于 mysql 说连接限制为 500，我认为 PHP、apache 或 codeigniter 中还有其他设置限制了对 mysql 的请求，但我找不到任何设置。我已经在谷歌搜索了几天试图找到答案，但没有任何运气。

是否对上述任何软件设置了限制？如有必要，我将发布配置。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T17:57:23.517

检查 httpd.conf 中的最大 Apache 工作进程数（ServerLimit 和 MaxClients）。假设每个工作人员的连接数固定，您可能会最大化工作人员的数量，因此没有请求新的 MySQL 连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-13T20:00:16.287

抱歉，刚刚在 Google 上找到了这个，但你的配置是 foobar

```
max_connections=500
open-files-limit = 500
table_open_cache = 512
table_definition_cache = 1024 
```

打开文件限制：500 #; 不好！

table_open_cache: 512... * 每个表 2+ 个打开文件 = 最少使用 1024 个打开文件

max_connections: 500 每个打开的连接都会启动一个新的文件句柄来缓冲。

您的 mysql 将打开大约 130 个表以启动（核心表），这使您只有 240 个文件句柄可以在数据查询和连接之间共享。对于表查询的每个连接，都会消耗 3 个以上的文件句柄（连接、数据表、索引文件）。在您获得 150 个连接之前，这会使您的打开文件最大化。对于这种数据库使用，open-files-limit 需要从 >2048 开始。

更多帮助：

```
show global status like '%open%';
show global status like '%onnect%'; 
```

亲自查看实际使用了多少文件/连接。某些操作系统 (Windows XP) 硬限制文件/网络连接。尝试谷歌搜索“mysql 'YOUR-OS' 150 connections”，看看这是否是限制因素。

# c# - 裁剪具有不同屏幕分辨率的图像

> ID：13479159
> 
> 赞同：0
> 
> 时间：2012-11-20T17:54:53.197
> 
> 标签：c#, .net

我需要的是在同一个地方以不同的分辨率裁剪图像。

例如：

使用 1024 x 768 创建的图像 1

使用 1440 x 900 创建的图像 2

现在我必须裁剪图像但在同一个地方让我们说它将是

X = 10% Y = 10% 宽度 = 30% 高度 = 20%

我使用下面的代码来做到这一点，但它不像我需要的那样工作。

有什么线索吗？

谢谢你！！！

```
int x = 0;
int y = 0;
int w = 0;
int h = 0;

int inputX = 10;
int inputY = 10;
int inputW = 20;
int inputH = 30;

x = int.Parse(Math.Round(decimal.Parse((__Bitmap.Width * inputX / 100).ToString()), 0).ToString());
y = int.Parse(Math.Round(decimal.Parse((__Bitmap.Height * inputY / 100).ToString()), 0).ToString());

w = int.Parse(Math.Round(decimal.Parse((__Bitmap.Width * inputW / 100).ToString()), 0).ToString());
h = int.Parse(Math.Round(decimal.Parse((__Bitmap.Height * inputH / 100).ToString()), 0).ToString());

Rectangle cropArea = new Rectangle(x, y, w,h);
Bitmap bmpCrop = __Bitmap.Clone(cropArea, __Bitmap.PixelFormat); 
```

我的意思是如果有技术上的逻辑来做到这一点？

我想我可以这样做（伪代码）

```
if (Resolution == "1024x768")
    int inputX = 10;
    int inputY = 10;
    int inputW = 20;
    int inputH = 30;
else if (Resolution == "1440x900")
    int inputX = 8;
    int inputY = 8;
    int inputW = 19;
    int inputH = 28;

 and etc... 
```

我不确定是否有任何系数可以根据分辨率重新计算 % ......这就像一个[crop-factor](http://en.wikipedia.org/wiki/Crop_factor)。

更新：

![在此处输入图像描述](../Images/7c3731ab7e09a389f788ed2772e5be5c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:40:17.387

我的意思是一个快速而肮脏的例子，当你用百分比计算你的裁剪窗口时，你总是会得到相同的图像部分：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

        // 100x80 image
        Image asdf = Image.FromFile("asdf.bmp", true);

        // twice the size, 200x160
        Image asdf2 = Image.FromFile("asdf2.bmp", true);

        // same image, different aspect ratio: 200x80
        Image asdf3 = Image.FromFile("asdf3.bmp", true);

        Bitmap asdfBmp = new Bitmap(asdf);
        Bitmap asdf2Bmp = new Bitmap(asdf2);
        Bitmap asdf3Bmp = new Bitmap(asdf3);

        pictureBox1.Image = cropImage(asdfBmp);
        pictureBox2.Image = cropImage(asdf2Bmp);
        pictureBox3.Image = cropImage(asdf3Bmp);
    }

    private Bitmap cropImage(Bitmap sourceBitmap)
    {
        double x = 0;
        double y = 0;
        double w = 0;
        double h = 0;

        double inputX = 10;
        double inputY = 10;
        double inputW = 50;
        double inputH = 50;

        // integer division " 10 / 100 " will return 0, use doubles or floats.
        // furthermore you don't have to convert anything to a string or back here.
        x = sourceBitmap.Width * inputX / 100.0;
        y = sourceBitmap.Height * inputY / 100.0;

        w = sourceBitmap.Width * inputW / 100.0;
        h = sourceBitmap.Height * inputH / 100.0;

        // casting to int will just cut off all decimal places. you could also round.
        Rectangle cropArea = new Rectangle((int)x, (int)y, (int)w, (int)h);
        return sourceBitmap.Clone(cropArea, sourceBitmap.PixelFormat);
    }
} 
```

资料来源：

![asdf.bmp](../Images/025314415f9bcb9215f89b03cef35bea.png) ![asdf2.bmp](../Images/c4d198681a701970839053744f4f0ec7.png) ![asdf3.bmp](../Images/66dbb9feeadbcc91b75ae8372e27aca3.png)

结果：

![结果](../Images/99645e257650077d9650dffefe442bfc.png)

如您所见，所有结果图像都显示图像的同一部分。所以我要么仍然没有得到你的目标，要么你的错误必须在其他地方。

考虑到您不必要的类型转换和整数除法错误，您或许应该看看[有关 types 的 c# 教程](http://www.csharp-station.com/Tutorials/lesson02.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T23:42:02.183

首先计算作物的中心。我假设您以某种方式获得了所需的 x,y,w,h 值。然后这个中心点需要重新计算到第二张图像的中心：即如果中心是[25;50]，那么对于1024x768的图像来说它分别是[25/1024;50/768]，得到[2.44% ;6.51%]。所以在第二张图片上，假设 1440x900 它给了我们 [1440*2.44%;900*6.51%] => [35;59] 当然以像素为单位。

现在您需要新图像的宽度和高度。如果纵横比相同，则很容易，因为您可以将尺寸计算为 a `cropWidth/firstImageWidth*secondImageWidth`，否则您需要将其乘以正确的纵横比。

无论如何，我认为你不明白这个问题。如果相似图像的纵横比不同，则要么是图像的不同部分，要么是图像失真。

下面我纠正了你的例子。我不会解释它，因为它很明显......我希望。看看透明的黑白区域所覆盖的部分......

![在此处输入图像描述](../Images/795d99a38f4d70e58b9555e2b05ab5bb.png)

# javascript - AJAX 滑块控件...需要第二个标签来反映百分比

> ID：13479160
> 
> 赞同：1
> 
> 时间：2012-11-20T17:54:58.963
> 
> 标签：javascript, asp.net, slider, ajaxcontroltoolkit

你会怎么做？我不是javascript wiz，所以我还没有找到解决方案......

我有一个滑块，我想指示将用于项目管理与设计的项目预算百分比。因此，在默认位置，项目管理和设计之间的比例为 50/50。如果他们以一种方式滑动它，它会使设计的百分比偏斜，而另一种方式则偏向 PM ......你明白了。

因此，常规标签显示的范围为 0-100。例如，我可以将其用于项目管理预算的百分比。

现在，我想要的是第二个标签来反映设计百分比。（从 100 中减去 PM 标签值。）你会怎么做？

这是我到目前为止所拥有的：

```
Campaign Budget:
<br />
<table>
    <tr>
        <td>
            Total Dollars:
        </td>
        <td colspan="3">
            Use the slider to modify the percentage between Project Management and Design.
        </td>
    </tr>
    <tr>
        <td>
            <asp:TextBox ID="totaldollarsbid" runat="server"></asp:TextBox>
        </td>
        <td>
            WANT DESIGN PERCENTAGE LABEL HERE
        </td>
        <td>
            <asp:TextBox ID="SliderBox" runat="server" Text="50" ClientIDMode="Static"></asp:TextBox>
            <ajaxToolkit:SliderExtender ID="SliderExtender" runat="server" TargetControlID="SliderBox"
                Minimum="0" Maximum="100" BoundControlID="SliderLabel" />
        </td>
        <td>
            <asp:Label ID="SliderLabel" runat="server"></asp:Label>
        </td>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T17:23:23.267

好的，我试过了......我添加了一个按钮来“更新设计值”......所以当点击按钮时，一个 jquery 函数将设计标签更新为 100 减去 PM 标签......

```
<asp:TextBox ID="SliderBox" runat="server" Text="50"></asp:TextBox>

<ajaxToolkit:SliderExtender ID="SliderExtender" runat="server"
TargetControlID="SliderBox"
Minimum="0"
Maximum="100" Steps="21"
BoundControlID="SliderPMLabel" 

/>
<asp:Button ID="btnTest" runat="server" Text="Update Design Value" />
<br /> <asp:Label ID="SliderPMLabel" runat="server"></asp:Label>% Project Management
<br /><asp:Label ID="SliderDesLabel" runat="server"></asp:Label>% Design

<script type="text/javascript">
$(function () {

    $('#<%= btnTest.ClientID %>').click(function () {
    var labelText = $('#<%= SliderPMLabel.ClientID %>').html();
        $('#<%=SliderDesLabel.ClientID%>').html(100 - labelText);
        return false;
    });

}); 

</script> 
```

它工作正常。但我希望设计标签值随着滑块的移动而动态变化。

一点是，当页面加载时不会发生这种情况......当用户从下拉列表中选择客户端时，就会出现此选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:04:13.767

将此标签放置在您需要具有设计价值的位置：`<asp:Label runat="server" ID="DesignValueLabel" Text="50" />`并在页面下方添加脚本：

```
<script type="text/javascript">
    function pageLoad() {
        var extender = $find("<%= SliderExtender.ClientID %>");
        extender.remove_valueChanged(updateDesignValue);
        extender.add_valueChanged(updateDesignValue);
    }

    function updateDesignValue(sender, eventArgs) {
        var design = 100 - sender.get_Value();
        $get("<%= DesignValueLabel.ClientID %>").innerHTML = design;
    }
</script> 
```

如果滑块没有放在更新面板中，那么`pageLoad`您可以使用下面的脚本代替函数（必须放在 ScriptManager 或 ToolkitScriptManager 控件之后）

```
Sys.Application.add_load(function () { $find("<%= SliderExtender.ClientID %>").add_valueChanged(updateDesignValue); }); 
```

# opengl - glStencilFunc(GL_NEVER, 0, 0) 仍然呈现？

> ID：13479162
> 
> 赞同：3
> 
> 时间：2012-11-20T17:55:04.873
> 
> 标签：opengl, stencil-buffer

我在使用模板缓冲区时遇到了问题，它似乎归结为根本不起作用。给定以下代码：

```
 glEnable(GL_STENCIL_TEST);
  glClearStencil(0);
  glClear(GL_STENCIL_BUFFER_BIT | GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
  glColor4f(1, 1, 1, 1);
  glStencilFuncSeparate(GL_FRONT_AND_BACK, GL_NEVER, 0, 0);
  glStencilOpSeparate(GL_FRONT_AND_BACK, GL_INCR, GL_INCR, GL_INCR);
  glBegin(GL_TRIANGLES);
  { draw something }
  glEnd(); 
```

三角形还在画！？我在这里错过了一些微不足道的事情吗？

*注意：我没有渲染到帧缓冲区，我正在使用 glStencil...Separate 只是为了确保它与正面\背面无关，我保留了一些对我来说似乎不相关的代码。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:08:13.033

您没有模板缓冲区。并按照规范（来自 4.3 核心，对开页 432）：

> 如果没有模板缓冲区，则不会发生模板修改，就好像模板测试总是通过，而不管对 StencilFunc 的任何调用。

# python - 将浮点数舍入到 x 小数？

> ID：13479163
> 
> 赞同：97
> 
> 时间：2012-11-20T17:55:05.057
> 
> 标签：python, math, rounding

有没有办法将 python 浮点数舍入到 x 小数？例如：

```
>>> x = roundfloat(66.66666666666, 4)
66.6667
>>> x = roundfloat(1.29578293, 6)
1.295783 
```

我找到了修剪/截断它们的方法（66.666666666 --> 66.6666），但不是圆形（66.666666666 --> 66.6667）。

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2014-03-03T19:43:37.403

我觉得有必要对 Ashwini Chaudhary 的回答提出反驳。`round`尽管看起来，该函数的两个参数形式*不会*将 Python 浮点数四舍五入到给定的小数位数，而且它通常不是您想要的解决方案，即使您认为它是。让我解释...

将（Python）浮点数四舍五入到小数位数的能力是经常要求的，但实际上很少需要。令人着迷的简单答案`round(x, number_of_places)`有点令人讨厌：它*看起来*好像在做你想做的事，但由于 Python 浮点数在内部以二进制形式存储，它做的事情相当微妙。考虑以下示例：

```
>>> round(52.15, 1)
52.1 
```

天真地理解是什么`round`，这看起来是错误的：当然它应该*向上*`52.2`取整而不是*向下*取整到`52.1`? 要理解为什么不能依赖这样的行为，您需要了解虽然这看起来像是一个简单的十进制到十进制运算，但它远非简单。

所以这就是上面例子中*真正*发生的事情。（*深呼吸*）我们将最接近的*二进制*浮点数的*十进制*表示显示为最接近的点后*数字十进制*数到以*十进制编写的数字文字的**二进制*浮点近似值。因此，为了从原始数字文字到显示的输出，底层机器在二进制和十进制格式之间进行了*四次单独的转换，每个方向两次。*将其分解（以及关于假设 IEEE 754 binary64 格式、舍入到偶数舍入和 IEEE 754 规则的常见免责声明）：*`n`*

 ***1.  首先，数字文字`52.15`被解析并转换为 Python 浮点数。实际存储的数字是`7339460017730355 * 2**-47`或`52.14999999999999857891452847979962825775146484375`。

2.  作为操作的第一步`round`，Python 在内部计算最接近存储数字的点后 1 位十进制字符串。由于存储的数字略低于 的原始值`52.15`，因此我们最终向下舍入并得到一个字符串`52.1`。这解释了为什么我们得到`52.1`的是最终输出而不是`52.2`.

3.  然后在操作的第二步中`round`，Python 将该字符串转换回浮点数，得到最接近的二进制浮点数`52.1`，即现在`7332423143312589 * 2**-47`，或`52.10000000000000142108547152020037174224853515625`。

4.  最后，作为 Python 的 read-eval-print 循环 (REPL) 的一部分，将显示浮点值（十进制）。这涉及将二进制值转换回十进制字符串，`52.1`作为最终输出。

在 Python 2.7 及更高版本中，我们遇到了令人愉快的情况，即第 3 步和第 4 步中的两次转换相互抵消。这是由于 Python 选择的`repr`实现，它产生保证正确舍入到实际浮点数的最短十进制值。该选择的一个后果是，如果您从任何（不太大，也不太小）具有 15 个或更少有效数字的十进制文字开始，则将显示相应的浮点数，显示这些完全相同的数字：

```
>>> x = 15.34509809234
>>> x
15.34509809234 
```

不幸的是，这进一步加深了 Python 以十进制存储值的错觉。但在 Python 2.6 中并非如此！这是在 Python 2.6 中执行的原始示例：

```
>>> round(52.15, 1)
52.200000000000003 
```

我们不仅朝相反的方向四舍五入，得到`52.2`而不是`52.1`，而且显示的值甚至不打印为`52.2`！此行为已导致向 Python 错误跟踪器报告大量报告，如“圆坏了！”。但这并不是`round`破坏了，而是用户的期望。（好吧，好吧，在 Python 2.6`round`中*有点*破，因为它没有使用正确的舍入。）

简短版本：如果您使用双参数回合，并且您期望从*二进制*近似到*十进制*循环的可预测行为，*二进制*近似到*十进制*中途情况，那么您就是在自找麻烦。

“两轮论证不好”的论点就足够了。你*应该*改用什么？有几种可能性，具体取决于您要执行的操作。

*   如果您出于显示目的四舍五入，那么您根本不需要浮点结果；你想要一个字符串。在这种情况下，答案是使用字符串格式：

    ```
    >>> format(66.66666666666, '.4f')
    '66.6667'
    >>> format(1.29578293, '.6f')
    '1.295783' 
    ```

    即使这样，也必须了解内部二进制表示，以免对明显的十进制中途情况的行为感到惊讶。

    ```
    >>> format(52.15, '.1f')
    '52.1' 
    ```

*   如果您在一个很重要的上下文中操作，其中小数中位数的四舍五入很重要（例如，在某些金融环境中），您可能希望使用该`Decimal`类型来表示您的数字。对类型进行十进制四舍五入`Decimal`比对二进制类型更有意义（同样，四舍五入到固定数量的二进制位对二进制类型非常有意义）。此外，该`decimal`模块使您可以更好地控制舍入模式。在 Python 3 中，`round`直接完成这项工作。在 Python 2 中，您需要该`quantize`方法。

    ```
    >>> Decimal('66.66666666666').quantize(Decimal('1e-4'))
    Decimal('66.6667')
    >>> Decimal('1.29578293').quantize(Decimal('1e-6'))
    Decimal('1.295783') 
    ```

*   `round`在极少数情况下，真的*是*你想要的两个参数版本：也许你正在将浮动分箱到 size 的箱中`0.01`，而你并不特别关心边界情况的走向。但是，这些情况很少见，仅基于这些情况很难证明存在两个参数版本的`round`内置函数。

* * *

## 回答 #2

> 赞同：105
> 
> 时间：2012-11-20T17:56:40.630

使用内置函数`round()`：

```
In [23]: round(66.66666666666,4)
Out[23]: 66.6667

In [24]: round(1.29578293,6)
Out[24]: 1.295783 
```

帮助`round()`：

> round(number[, ndigits]) -> 浮点数
> 
> 将数字四舍五入到十进制数字的给定精度（默认为 0 位）。这总是返回一个浮点数。精度可能为负。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-22T13:40:34.817

Mark Dickinson 的答案虽然完整，但不适用于 float(52.15) 案例。经过一些测试，有我正在使用的解决方案：

```
import decimal

def value_to_decimal(value, decimal_places):
    decimal.getcontext().rounding = decimal.ROUND_HALF_UP  # define rounding method
    return decimal.Decimal(str(float(value))).quantize(decimal.Decimal('1e-{}'.format(decimal_places))) 
```

（'value' 到 float 和 string 的转换非常重要，这样，'value' 的类型可以是 float、decimal、integer 或 string！）

希望这对任何人都有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-04T19:21:07.930

python和numpy中的默认舍入：

```
In: [round(i) for i in np.arange(10) + .5]
Out: [0, 2, 2, 4, 4, 6, 6, 8, 8, 10] 
```

我用它来获得整数舍入以应用于熊猫系列：

`import decimal`

并使用这条线将四舍五入设置为“一半”，也就是学校教的四舍五入： `decimal.getcontext().rounding = decimal.ROUND_HALF_UP`

最后我做了这个函数来将它应用到熊猫系列对象

```
def roundint(value):
    return value.apply(lambda x: int(decimal.Decimal(x).to_integral_value())) 
```

所以现在你可以做`roundint(df.columnname)`

对于数字：

```
In: [int(decimal.Decimal(i).to_integral_value()) for i in np.arange(10) + .5]
Out: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] 
```

信用：[卡雷斯](https://stackoverflow.com/a/52607477/4289062)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-26T12:14:17.870

我编写了一个函数（在 Django 项目中用于 DecimalField），但它可以在 Python 项目中使用：

这段代码：

*   管理**整数位**以避免数字太大
*   管理**小数位**以避免数字太低
*   管理**有符号和无符号**号码

带有测试的代码：

```
def convert_decimal_to_right(value, max_digits, decimal_places, signed=True):

    integer_digits = max_digits - decimal_places
    max_value = float((10**integer_digits)-float(float(1)/float((10**decimal_places))))

    if signed:
        min_value = max_value*-1
    else:
        min_value = 0

    if value > max_value:
        value = max_value

    if value < min_value:
        value = min_value

    return round(value, decimal_places)

value = 12.12345
nb = convert_decimal_to_right(value, 4, 2)
# nb : 12.12

value = 12.126
nb = convert_decimal_to_right(value, 4, 2)
# nb : 12.13

value = 1234.123
nb = convert_decimal_to_right(value, 4, 2)
# nb : 99.99

value = -1234.123
nb = convert_decimal_to_right(value, 4, 2)
# nb : -99.99

value = -1234.123
nb = convert_decimal_to_right(value, 4, 2, signed = False)
# nb : 0

value = 12.123
nb = convert_decimal_to_right(value, 8, 4)
# nb : 12.123 
```***

# c#-4.0 - Office 互操作在 Windows 服务中不起作用

> ID：13479164
> 
> 赞同：5
> 
> 时间：2012-11-20T17:55:05.447
> 
> 标签：c#-4.0, windows-services, vsto, office-interop

我对 Microsoft Office 有一个非常奇怪的问题。

我有一个公共库，其唯一目的是打开传递给它的任何 Word 文档文件类型（通过完整文件路径......）并将打开的 Word 文档另存为 pdf 文件。

奇怪的问题是，如果我从 Windows 服务中使用该库，则每当它尝试打开 word 文档时，我都会得到一个空值……也就是说，word 文档永远不会被打开。

但是，如果我使用 WPF 或 Windows 窗体应用程序中的库，我永远不会遇到任何问题。我知道线程存在问题，（单线程公寓）但是我不知道如何修复它以摆脱 Windows 服务。:( :( :(

我将不胜感激任何帮助！我得到的错误如下：

异常消息：{“对象引用未设置为对象的实例。”}（指的是 word 文档）。内部异常：空；H结果：-2147467261。数据：ListDictionaryInternal，有 0 个条目；堆栈跟踪：在 c:\Project Files...\DocumentConverter.cs:line 209 中的 DocumentConverter.ToPdf(String currentWorkingFolderPath, String pathToDocumentToConvert)

所以这里是库函数。它需要由 Visual Studio Tools for Office 创建的 Microsoft Office 参考。

```
private string ToPDF(string currentWorkingFolderPath, string pathToDocumentToConvert)
{
    string temporaryPdfFolderPath = Path.GetFullPath(currentWorkingFolderPath + "\\pdf\\");
    string temporaryPdfFilePath = Path.GetFullPath(temporaryPdfFolderPath + "\\pdffile.pdf");

    if (!FileSystem.CreateDirectory(temporaryPdfFolderPath))
    {
        return null;
    }

    try
    {
        Microsoft.Office.Interop.Word.Application wordApplication = new Microsoft.Office.Interop.Word.Application();

        object objectMissing = System.Reflection.Missing.Value;

        wordApplication.Visible = false;
        wordApplication.ScreenUpdating = false;

        FileInfo wordFile = new FileInfo(pathToDocumentToConvert);

        Object fileName = (Object)wordFile.FullName;

        // This is where it breaks when called from windows service. Use the dummy value as a placeholder for optional arguments
        Document wordDocument = wordApplication.Documents.Open(ref fileName, ref objectMissing,            
            true, ref objectMissing, ref objectMissing, ref objectMissing, ref objectMissing,            
            ref objectMissing, ref objectMissing, ref objectMissing, ref objectMissing, ref objectMissing,            
            ref objectMissing, ref objectMissing, ref objectMissing, ref objectMissing);

        object outputFileName = (object)temporaryPdfFilePath;
        object fileFormat = WdSaveFormat.wdFormatPDF ;

        // Save document into PDF Format
        wordDocument.SaveAs(ref outputFileName,
            ref fileFormat, ref objectMissing, ref objectMissing,
            ref objectMissing, ref objectMissing, ref objectMissing, ref objectMissing,
            ref objectMissing, ref objectMissing, ref objectMissing, ref objectMissing,
            ref objectMissing, ref objectMissing, ref objectMissing, ref objectMissing);

        // Close the Word document, but leave the Word application open.
        // doc has to be cast to type _Document so that it will find the
        // correct Close method.                
        object saveChanges = WdSaveOptions.wdDoNotSaveChanges;
        ((_Document)wordDocument).Close(ref saveChanges, ref objectMissing, ref objectMissing);

        wordDocument = null;

        // word has to be cast to type _Application so that it will find
        // the correct Quit method.
        ((Microsoft.Office.Interop.Word._Application)wordApplication).Quit(ref objectMissing, ref objectMissing, ref objectMissing);

        wordApplication = null;

    }
    catch (Exception ex)
    {
        //logging code
        return null;
    }

    return temporaryPdfFilePath;
} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-11-21T16:23:08.763

根据@Sameer S 在他的帖子中：[Windows server 2008 是否支持 Office 2003 互操作 ..？](https://stackoverflow.com/questions/4438121/is-office-2003-interop-supported-on-windows-server-2008)

Microsoft 正式在 Windows server 2008 上不支持 Microsoft Office 2003 Interop。

但是在对代码和搜索进行大量排列和组合之后，我们遇到了一种适用于我们场景的解决方案。

解决方案是弥补 Windows 2003 和 2008 维护其文件夹结构的方式之间的差异，因为 Office Interop 依赖于桌面文件夹在中间打开/保存文件。2003 系统在 systemprofile 下包含 2008 年不存在的桌面文件夹。

因此，当我们在 2008 年在相应层次结构下创建此文件夹时，如下所示；office Interop 能够根据需要保存文件。此桌面文件夹需要在下创建

C:\Windows\System32\config\systemprofile

和

C:\Windows\SysWOW64\config\systemprofile

多谢你们..！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-10-05T11:28:24.447

创建这些文件夹后：

> C:\Windows\System32\config\systemprofile\Desktop C:\Windows\SysWOW64\config\systemprofile\Desktop

确保计划任务正在使用有权访问这些文件夹的**配置文件运行。**

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-20T19:04:04.037

在类似服务器的场景（如 ASP.NET 或 Windows 服务或类似情况）中，MS**不支持**Office 互操作- 请参阅[http://support.microsoft.com/default.aspx?scid=kb;EN-US;q257757#kb2](http://support.microsoft.com/default.aspx?scid=kb;EN-US;q257757#kb2)！

您将需要使用一些库来实现您想要的：

*   [MS 提供 OpenXML SDK V 2.0](http://msdn.microsoft.com/en-us/library/bb448854%28office.14%29.aspx)（免费）
*   [Aspose.Words](http://www.aspose.com/categories/.net-components/aspose.words-for-.net/default.aspx)（商业）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T17:59:35.757

您的 Windows 服务是否启用了“以交互模式运行”选项？它可能会失败，因为 Word 正在尝试显示 UI，但出于显而易见的原因，它不能这样做。

另一种可能性（也是人们遇到的一个非常常见的问题）是您的 Windows 服务在一个无权访问您尝试传递给它的文件/文件夹的帐户下运行。相比之下，WPF/Winforms 程序在用户凭据下运行。

如果这不是问题，是否有任何错误被抛出？检查 Windows 事件日志和/或添加一些日志以查看是否有一些错误被静默抛出。

编辑：我浏览了 MSDN 文档（[用于 Word Interop](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.document_members.aspx)），似乎不需要使用 VSTO。您可以尝试使用纯单词互操作来执行此操作并查看它是否有效吗？[这篇文章有一个例子](http://omegacoder.com/?p=555)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-25T07:58:01.713

按照以下链接中的说明操作后，我的 ASP.net 2.0 办公自动化应用程序在 Windows 2008 Server 64 位中运行良好。希望对大家有所帮助。

[http://emalvass.blogspot.com/2010/01/how-to-use-office-2007-automation-in.html](http://emalvass.blogspot.com/2010/01/how-to-use-office-2007-automation-in.html)

我的示例程序如下：

```
Imports Microsoft.Office.Interop.Word

Dim Result As Boolean = False

    Dim appWord As New Microsoft.Office.Interop.Word.Application
    Dim wordDocument As Microsoft.Office.Interop.Word.Document

    Try
        Dim oFile As New FileInfo(sPDFFile), sFilePath As String, sFileName As String, sFileNameArr() As String
        Dim sActualFileName As String

        sFileName = oFile.Name
        sFileNameArr = sFileName.Split(".")
        sActualFileName = sFileNameArr(0)
        sFilePath = oFile.DirectoryName & "\" & sActualFileName & ".pdf"

        wordDocument = appWord.Documents.Open(sPDFFile)

        wordDocument.ExportAsFixedFormat(sFilePath, WdExportFormat.wdExportFormatPDF)
        'wordDocument.ExportAsFixedFormat(sFilePath, 17)

        Result = True
        oFile = Nothing

    Catch ex As COMException
        sErrMsg = ex.InnerException.ToString
        Result = False
    Finally
        wordDocument.Close()
        wordDocument = Nothing
        appWord.Application.Quit()
        appWord = Nothing

    End Try

    Return Result 
```

# mysql - 产品表映射到事务

> ID：13479167
> 
> 赞同：0
> 
> 时间：2012-11-20T17:55:24.457
> 
> 标签：mysql, database

我正在设计一个数据库并想知道：将事务映射到多个产品的最佳方法是什么？例如，如果客户在一次交易中购买了产品 x、y、z（交易 id 123）。将交易链接到产品表的最佳方式是什么？

我还考虑使用一种方法将所有选定项目（产品）的数组存储在事务表中，但这会使以后在处理时检索每个产品的价格变得困难。

需要你的经验

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:13:07.280

类似以下模型的东西应该适合您的需求：

```
DROP TABLE IF EXISTS `tTransaction`;
CREATE TABLE `tTransaction` (
    `transactionId`     INT UNSIGNED NOT NULL AUTO_INCREMENT,
    `transactionAmount` NUMBER(10,2) NOT NULL,
    /* Other Data */
    PRIMARY KEY (`transactionId`)
);

DROP TABLE IF EXISTS `tProduct`;
CREATE TABLE `tProduct` (
    `productId`   INT UNSIGNED NOT NULL AUTO_INCREMENT,
    `productName` VARCHAR(32) NOT NULL,
    /* Other Data */
    PRIMARY KEY (`productId`)
);

DROP TABLE IF EXISTS `tTransactionProductMap`;
CREATE TABLE `tTransactionProductMap` (
    `transactionId` INT UNSIGNED NOT NULL,
    `productId`     INT UNSIGNED NOT NULL,
    FOREIGN KEY (`transactionId`) REFERENCES tTransaction (`transactionId`),
    FOREIGN KEY (`productId`) REFERENCES tProduct (`productId`)
); 
```

# r - 从直方图中应用函数 - 在 R 中

> ID：13479170
> 
> 赞同：2
> 
> 时间：2012-11-20T17:55:25.063
> 
> 标签：r, statistics, histogram, frequency-distribution

我对统计数据有非常基本的掌握，对 R 也有非常基本的掌握，所以请多多包涵。

我有调查数据，其中显示了一些受访者的每周支出。我已将其放入直方图中，并绘制了密度函数。到目前为止，一切都很好。

然后我如何将这条曲线应用于更大的人群？假设我知道我所在城镇的人口为 25000。如何将其应用于密度曲线以得出新的直方图及其背后的数据表？

我希望这是一个适当的问题，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:10:40.707

目前还不清楚你想做什么。

如果您只有样本数据，那么您对总体直方图/密度的最佳估计是样本的直方图/密度，唯一的区别是 y 轴上的比例。就我个人而言，我认为 y 轴上的刻度线应该被忽略（我的偏好是从未绘制过刻度线标签），因为直方图/密度的形状确实很重要，并且刻度线标签可以根据事物而改变不会改变意思。如果您真的觉得需要让刻度标签代表人口值，请查看该`axis`功能。

如果您想要更多的东西，那么请给我们更好地描述您想要完成的事情。

# c++ - 如何通过引用传递结构？

> ID：13479172
> 
> 赞同：2
> 
> 时间：2012-11-20T17:55:25.330
> 
> 标签：c++, queue

我想不通，这是我目前所拥有的。

但是该函数`Enqueue()`不会更改主方法中的`Head`&`Tail`对象。

我该怎么做呢？

```
#include <stdio.h>

typedef struct queuenode{
    int data;
    struct queuenode *next;
} Queue_type;

void Enqueue( Queue_type *head, Queue_type *tail , int item)
{
    Queue_type *temp;
    temp->data = item;
    temp->next = NULL;
    if (tail == NULL){//if first node
        head=temp;
        tail=temp;
    }
    else{
        tail->next = temp;
        tail = temp;
    }
}

void main(void)
{
    Queue_type *Head;
    Queue_type *Tail;

    Head = NULL;
    Tail = NULL;

    printf("\n[*]Enter Number to Enqueue : ");
    scanf("%d", &item);
    Enqueue(Head, Tail, item);

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T17:56:57.590

如何通过引用传递指针？通过引用传递它：

```
void Enqueue( Queue_type *&head, Queue_type *&tail , int item) 
```

其他问题：

```
Queue_type *temp;
temp->data = item; 
```

是未定义的行为。

[强制链接。](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list)您正在 C++ 环境中编写 C 代码。只是不要。

# asp.net-mvc - ValidationMessageFor 用于不同的对象

> ID：13479176
> 
> 赞同：0
> 
> 时间：2012-11-20T17:55:42.557
> 
> 标签：asp.net-mvc, razor

我正在使用 mvc4，在我看来我有一个声明

```
 @model IEnumerable<UserDisplay> 
```

在**同一个**视图上，我想要一个带有“创建”帖子的表单，用于不同的对象类型名称“评论”

如何使用 EditorFor 和`ValidationMessageFor`？原因模型是不同的类型。

这是行不通的

```
 @using (Html.BeginForm()) {
@Html.ValidationSummary(true)

<fieldset>
    <legend>Review</legend>

    <div class="editor-label">
        @Html.LabelFor(model => model.Info) 
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Info)
        @Html.ValidationMessageFor(model => model.Info)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.FromId)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.FromId)
        @Html.ValidationMessageFor(model => model.FromId)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.ToId)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.ToId)
        @Html.ValidationMessageFor(model => model.ToId)
    </div>

    <p>
        <input type="submit" value="Create" />
    </p>
</fieldset> 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:16:22.857

您可以使用包含两个对象的视图模型。

```
public class MyViewModel
{
    public IEnumerable<UserDisplay> { get; set; }
    public Review Review { get; set; }
} 
```

然后您在视图中的模型声明变为：

```
@model TheNamespace.For.MyViewModel 
```

这将允许您使用`@Html.EditorFor`和`@Html.ValidationMessageFor`助手。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:16:43.963

为该表单创建一个局部视图，该视图使用所需类型的 @model 声明，然后使用`@Html.Partial("mySubFormView")`. 不要在你的视图中混合模型类型，这会让生活变得太复杂。

# mysql - 动态mysql查询两张表

> ID：13479178
> 
> 赞同：0
> 
> 时间：2012-11-20T17:55:47.867
> 
> 标签：mysql, sql

我有一个带有两个表的 mysql 数据库，它是一对多的关系。

`table1`有元素`{A,B,C...,N}`
`table2`有元素`{A1,A2,...,AX,B1,B2,...BX,C1,C2,C3,...,CX,...,N1,N1,N3,...,NX}`

我对表一进行了查询，它返回了元素的子集，即。`{A,D,T}` （这个子集可能很大，100 个元素）

现在我想查询第二个表以获取映射到第一个子集的所有元素，并且它们需要按两列排序。

当第一个查询的子集大小是动态的时，进行第二个查询的最佳方法是什么？我需要一个带有一堆 OR 的字符串吗？

```
SELECT * FROM table2 WHERE ID = A or ID = D ..... ORDER BY X,Y 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T17:57:44.573

试试这个

```
SELECT * FROM table2 WHERE ID IN (SELECT ID FROM table1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:03:21.077

```
SELECT DISTINCT table2.*
FROM
  table2 INNER JOIN
  (Select ID from table1 where ..your conditions..) filtered_table1
  on table2.ID = filtered_table1.ID
ORDER BY table2.field1, table2.field2 
```

# apache-pig - Pig Latin - for 循环中的不同计数和字符串比较

> ID：13479181
> 
> 赞同：0
> 
> 时间：2012-11-20T17:55:57.213
> 
> 标签：apache-pig

我正在尝试按个人资料中至少有两个国家或来自美国的用户来过滤用户，我在 Pig 中尝试过

```
 B = group A by userid;
    C = foreach B  {
                count = $1.country;
                count2 = distinct count;
                GENERATE (((SIZE(count2) > 1 OR count2.$0 != 'USA') ? group : null)));
        } 
```

但它伴随着这个错误

```
incompatible types in NotEqual Operator left hand side:bag :tuple(country:chararray)  right hand side:chararray 
```

我尝试了各种其他组合，但没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:17:45.870

试试这个：

```
C =
    foreach (group A by userid)
    generate
        group as userid,
        COUNT(A) AS count,
        FLATTEN(A) as country;
D = filter C by count > 1 OR country == 'US'; 
```

C 是与模式 {userid:chararray, count:long, country:chararray} 的关系，其中 count 是与 userid 关联的国家/地区的数量。D 根据您的标准进行过滤。

# google-apps-script - 使用 HtmlService 从谷歌应用脚 本中使用谷歌关闭库

> ID：13479187
> 
> 赞同：1
> 
> 时间：2012-11-20T17:56:06.827
> 
> 标签：google-apps-script, google-closure-library

是否可以通过 HtmlService 从谷歌应用脚​​本访问谷歌闭包库函数？谷歌脚本中的 html 文件似乎过滤掉了与闭包库相关的任何内容。

项目：我正在使用 HtmlService 从 Google 应用脚本中探索 Google Closure 库中的 DOM 操作实用程序。我打算将其作为独立的网络应用程序运行。

闭包函数在从其本地客户端环境直接加载到浏览器时起作用 - 但在通过 HtmlService 实用程序从 GAS 应用程序注入时它们不起作用。

这是我在 GAS 中使用的代码。

### .html 文件

```
<html>
  <head>
  <script src="http://closure-library.googlecode.com/svn/trunk/closure/goog/base.js"></script>
  <script>
    goog.require('goog.dom');
    function c_sayHi() {
      var newHeader = goog.dom.createDom('h1', {'style': 'background-color:#EEE'},'Hello world!');
      goog.dom.appendChild(document.body, newHeader);
    }
  </script>
  </head>

  <script>
    function c_updateButton(date, button) {
      button.value = "clicked at " + date;
    }
  </script>

  <body onload="c_sayHi()">
    <input type='button' value='Never Clicked'
    onclick='google.script.run.withSuccessHandler(c_updateButton).withUserObject(this).s_getCurrentDate()'>

    <input type='button' value='Never Clicked'
    onclick='google.script.run.withSuccessHandler(c_updateButton).withUserObject(this).s_getCurrentDate()'>
  </body>
</html> 
```

### 谷歌脚本文件

```
function s_getCurrentDate() {
  return new Date().toString();
}

function doGet(e) {
  return HtmlService.createTemplateFromFile('hello').evaluate();
} 
```

我为客户端函数添加了前缀 c_，为服务器端 fns 添加了前缀。将其作为 Web 应用程序运行时，

1.  函数 c_sayHi 没有效果 - 我不确定它是否被调用。

2.  函数 s_getCurrentDate 和 c_updateButton 工作正常，如谷歌文档[https://developers.google.com/apps-script/html_service](https://developers.google.com/apps-script/html_service)中所述。

有没有办法让闭包库像上面尝试的那样从网络应用程序中工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:38:06.937

这里有几件事 -

1.  所有 .gs 文件都是在服务器端运行的 JavaScript。所以 DOM 在那里并不真正相关。
2.  [您可以通过在HtmlService](https://developers.google.com/apps-script/html_service)中返回代码来运行客户端 JavaScript 。这就是我相信你想要做的。但是，jQuery 是这种方法中最受支持的库。闭包最终可能会起作用，但团队并未专门针对该库进行测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-24T20:25:05.217

问题是Closure的依赖结构是在window load事件之前执行的，否则就不起作用了。因此，任何 require 和 provide 语句都会在窗口加载之前得到处理。当您通过 HTML 服务注入它们时，您会强制它们在所需的不同阶段执行，这会导致一切失败。

如果您将使用编译的 Closure 库源，则运行 Closure 不会有任何问题。了解如何使用 Compiler 和 Builder 使 Closure 正常工作。此外，您可以使用延迟加载来模拟您的 HTML 服务。

有了它，**你可以让 javascript 动态加载 onclick、onload 或任何你想要的东西**。这称为延迟加载，它被用作所有大型 Web 应用程序的标准做法。通过 Gmail 或 Facebook 浏览时监控 Firebug 的网络选项卡。

Arun Nagarajan 是对的，jQuery 是更简单的解决方案**，但是**如果您正在做一些需要广度、规模和速度的适当的事情，那么 jQuery 对孩子们来说是一个玩具。

# c# - 如何用零格式化双精度值

> ID：13479192
> 
> 赞同：0
> 
> 时间：2012-11-20T17:56:23.313
> 
> 标签：c#, double, string-formatting, tostring

我想知道是否有一种简单的方法可以将双精度值转换为 C# 中的字符串？我使用`.ToString("R")`并默认`.ToString()`，但它不起作用。

这是一些测试示例**0.00000000000000000000000001**给我字符串**1.0E-26**和**29.999999999999999999994**转换为**30.0**。我不想要那个。如何避免这种代表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:02:32.833

你要什么代表？

检查 MSDN 以获取[标准](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)和[自定义](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)格式化字符串。

# objective-c - invokeSelector:withObject: 在 Release 中崩溃

> ID：13479196
> 
> 赞同：0
> 
> 时间：2012-11-20T17:56:40.927
> 
> 标签：objective-c, ios

我有代码

```
[target invokeSelector:handler.successAction withObject:object]; 
```

它可能会调用一些方法。有或无。它在 Debug 中完美运行，但在 Release 中崩溃：

```
Nov 20 21:55:13 efpies project[7202] <Warning>: >>>> selector: successfulLogin
Nov 20 21:55:13 efpies project[7202] <Warning>: >>>> target: <AppDelegate: 0x1f595a90>
Nov 20 21:55:13 efpies project[7202] <Warning>: >>>> object: <7b226d65 73736167 65223a22 5c753034 31325c75 30343435 5c753034 33655c75 30343334 205c7530 3434305c 75303433 305c7530 3433375c 75303434 305c7530 3433355c 75303434 385c7530 3433355c 75303433 64227d> NSConcreteMutableData
Nov 20 21:55:13 efpies project[7202] <Error>: -[AppDelegate invokeSelector:withObject:]: unrecognized selector sent to instance 0x1f595a90

Nov 20 21:56:12 efpies project[7205] <Warning>: >>>> selector: driversUpdated:
Nov 20 21:56:12 efpies project[7205] <Warning>: >>>> target: <DriversList: 0x1cd5ffd0>
Nov 20 21:56:12 efpies project[7205] <Warning>: >>>> object: (
    ) __NSArrayM
Nov 20 21:56:12 efpies project[7205] <Error>: -[DriversList invokeSelector:withObject:]: unrecognized selector sent to instance 0x1cd5ffd0 
```

这些方法是可用的（甚至出现在头文件中）。怎么了？数据和对象是 100% 正确的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:03:47.147

采用

```
[target performSelector:handler.successAction withObject:object]; 
```

这就是在 cocoa-touch 中执行此操作的方法，因为`NSObject`它将为您处理。查看[Apple 文档](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Protocols/NSObject_Protocol/Reference/NSObject.html#//apple_ref/occ/intfm/NSObject/performSelector%3awithObject)以获取更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:03:53.277

事实证明，`invokeSelector:withObject:`是静态库中的一个类别方法。静态库中的类别不会自动加载，因此您应该编写

`-force_load $(BUILD_ROOT)/$(CONFIGURATION)$(EFFECTIVE_PLATFORM_NAME)/lib_name.a`

如果它编译为目标的依赖项，则指向目标中`Other linker flag`的字段。`Build settings`

# perl - 从文本文件 perl 中对第二个字段进行降序排序

> ID：13479198
> 
> 赞同：1
> 
> 时间：2012-11-20T17:56:40.700
> 
> 标签：perl, sorting, file-io, text-files, numeric

我有一个以制表符分隔的文本文件，其格式、名称和年龄如下所示：

```
chris     19
bobby     29
doofus    67 
```

我想拉入文本文件，然后通过第二个字段进行排序。我可以拉入文本文件并格式化数据，但我无法正确排序，因此删除了我拥有的排序代码......

这是简单的文件拉取：我该如何修改它？

```
open (FILEHERE, 'ages.txt');
while (<FILEHERE>) {
chomp;
my($n, $s) = split("\t");
print "$a\t $s";
}
close (FILEHERE); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T18:15:09.373

[施瓦茨变换](http://en.wikipedia.org/wiki/Schwartzian_transform)(ST) 在这里可以提供帮助：

```
use strict;
use warnings;

my $data = <<END;
chris     19
doofus    67
bobby     29
END

open my $fh, '<', \$data or die $!;

print map $_->[0],
sort { $a->[1] <=> $b->[1] }
map { [ $_, /(\d+)$/ ] }
<$fh>;

close $fh; 
```

输出：

```
chris     19
bobby     29
doofus    67 
```

从 ST 的底部向上阅读。该例程获取一个文件行，然后`map`将该行作为匿名数组的第一个元素放在其中。第二个元素是从第二列捕获的数值。采用`sort`匿名子例程对匿名数组的第二个元素进行排序（因此，取消引用箭头运算符`$a->[1]`）。结果被传递给`map`访问排序的行，最终打印出来。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:11:59.663

您可以将文件读入数组引用数组，然后根据每个数组的第二个字段进行排序：

```
my @lines;
open (FILEHERE, 'ages.txt');
while(<FILEHERE>) {
    push @lines, [split /\t/];
}

my @sorted = sort { $b->[1] <=> $a->[1] } @lines; 
```

或者，假设您的数据已正确排序，并且只需从标准输入中读取，则可能更容易编写 Perl 脚本：`sort -grk2 ages.txt | perl yourscript.pl`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-25T20:47:27.410

来自[如何在 perl 中按列对数组或表进行排序？](https://stackoverflow.com/questions/27112465/how-to-sort-an-array-or-table-by-column-in-perl/27135781#27135781)应该管用：

```
perl -anE 'push @t,[@F]}{ say "@$_" for sort {$a->[1] <=> $b->[1]} @t' names.txt 
```

与@reo katoa 一样，它使用数组数组 - 但利用`-a`将行自动拆分为`@F`第一个。有关[`perlrun`](http://perldoc.perl.org/perlrun.html)自动拆分的详细信息，请参阅。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-02T05:40:17.937

您还可以调用`sort -k 2,2`perl 对第二个字段的文件进行排序，当然`-n`如果它们是数字则使用并`-r`进行反向排序。

我使用以下单线查看 squid 访问日志，它在顶部显示最长的会话

```
sort -rn -k 2,2 access.log | perl -lpe 's/^([0-9]{10})(.\d{3})/scalar localtime$1/e' 
```

# mysql - 使用 Rails 和 Ruby 确保新对象的值大于所有其他对象

> ID：13479202
> 
> 赞同：0
> 
> 时间：2012-11-20T17:56:48.277
> 
> 标签：mysql, ruby-on-rails, ruby-on-rails-3, activerecord

我正在创建一个类似于 eBay 的拍卖行。我的问题是我的出价资源。它将跟踪所有的出价。但是，我必须确保对一件物品的每个新出价都高于当前出价，否则会破坏拍卖的目的。

我目前想要执行此操作的方式是在投标控制器内创建一个事务，该事务将检查一个项目的投标金额是否大于同一项目的其他投标的最大值。

```
def create
    bid.transaction 
      @bid = Bid.new(params[:bid])
      @bid.user = current_user
       @bid.item = current_item
       # DO STUFF TO CHECK ITS GREATER THAN MAX OF BIDS FOR CURRENT_ITEM
       # ON ERROR, ROLLBACK TRANSACTION AND THROW ERROR

    end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:04:09.970

我肯定会在模型中处理这个问题。创建自定义验证，例如：

```
#Bid Model
validate :bid_is_higher_than_current_highest

private
def bid_is_higher_than_current_highest
  bid > item.current_highest_bid
end 
```

类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:01:15.500

首先确保您使用的`InnoDB`表类型`MyISAM`不支持事务。

但你基本上是对的，你只想在你的交易中运行一个查询来确定最高出价：

```
max_bid_amount = Bid.where(:id => item.id).maximum(:bid_amount)
if @bid.bid_amount > max_bid_amount
  # proceed with bid placement
else
  # do something, return some flag, nil or whatever
end 
```

然后检查该值并相应地进行。我认为您不想出于流量控制目的而引发异常。

我还建议您将此逻辑移到控制器之外，并移至模型或其他管理层，可能有一个通用的 Ruby 类，例如`BidManager`其中包含投标放置的流逻辑。

# automapper - Automapper：dto 对象的自动映射集合属性

> ID：13479208
> 
> 赞同：7
> 
> 时间：2012-11-20T17:57:01.597
> 
> 标签：automapper

我有一个域对象

```
public class ProductModel
{
    public long Id {get;set;}
    public string Name {get;set;}
    public string SerialNumber {get;set;}
} 
```

单 Dto 类：

```
public class ProductDto
{
    public long Id {get;set;}
    public string Name {get;set;}
    public string SerialNumber {get;set;}
} 
```

单个 Dto 类，它是 Dto 对象的列表：

```
public class ProductListDto : List<ProductDto>
{
    public List<ProductDto> Products;

    public ProductListDto()
    {
        Products = new List<ProductDto>();
    }
} 
```

我想将域对象列表映射到 Dto 对象列表，以便 ProductListDto 对象的“产品”属性自动映射到 ProductModel 对象列表：

```
ProductListDto dto = new ProductListDto();  

Mapper.CreateMap<ProductModel, ProductDto>();

/* dto = (ProductListDto) Mapper.Map<List<ProductModel>, List<ProductDto>>((List<ProductModel>)model);  this code line causes error. It is commented out. */ 

dto.Products = Mapper.Map<List<ProductModel>, List<ProductDto>>((List<ProductModel>)model);  // (*)  works OK but need to specify "Products" property 
```

代码行（*）工作正常，但我想知道是否有另一种方法可以自动（隐式）映射除代码行（*）之外的 dto 对象的“产品”属性？

这意味着我不必像代码行 (*) 的左侧那样编写代码。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-21T18:05:17.100

您将需要为它创建一个映射。像这样的东西应该工作：

```
namespace StackOverflow
{
    using System.Collections.Generic;

    using AutoMapper;

    public class MyProfile : Profile
    {
        public override string ProfileName
        {
            get
            {
                return "MyProfile";
            }
        }

        protected override void Configure()
        {
            Mapper.CreateMap<ProductModel, ProductDto>();

            Mapper.CreateMap<List<ProductModel>, ProductListDto>()
                .ForMember(dest => dest.Products,
                           opt => opt.MapFrom(
                               src => Mapper.Map<List<ProductModel>,
                                                 List<ProductDto>>(src)));
        }
    }
} 
```

然后在您的代码中，您可以执行以下操作：

```
dto = Mapper.Map<List<ProductModel>, ProductListDto>((List<ProductModel>)model); 
```

这里有几个单元测试来展示它是如何工作的：

```
namespace StackOverflow
{
    using System.Collections.Generic;

    using AutoMapper;

    using NUnit.Framework;

    [TestFixture]
    public class MappingTests
    {
        [Test]
        public void AutoMapper_Configuration_IsValid()
        {
            Mapper.Initialize(m => m.AddProfile<MyProfile>());
            Mapper.AssertConfigurationIsValid();
        }

        [Test]
        public void AutoMapper_DriverMapping_IsValid()
        {
            Mapper.Initialize(m => m.AddProfile<MyProfile>());
            Mapper.AssertConfigurationIsValid();

            var products = new List<ProductModel>
                {
                    new ProductModel
                        {
                            Id = 1,
                            Name = "StackOverflow Rocks",
                            SerialNumber = "1234"
                        },
                    new ProductModel
                        {
                            Id = 2,
                            Name = "I Also Rock",
                            SerialNumber = "4321"
                        }
                };

            var productsDto =
                    Mapper.Map<List<ProductModel>, ProductListDto>(products);

            Assert.That(productsDto, Is.Not.Null);
            Assert.That(productsDto.Products, Is.Not.Null);
            Assert.That(productsDto.Products.Count, Is.EqualTo(2));
        }
    }
} 
```

# java - 将 Websphere 7 配置为对所有请求使用单个 JAX-WS 服务实例

> ID：13479209
> 
> 赞同：0
> 
> 时间：2012-11-20T17:57:04.087
> 
> 标签：java, web-services, caching, jax-ws, websphere-7

虽然众所周知 Websphere 的 JAX-WS 实现基于 Axis2，但我在查找如何为服务设置“范围”的信息时遇到了麻烦。

在轴 2 中，可以使用 services.xml 定义范围。这个文件在 Websphere 中是否也可用？

[http://axis.apache.org/axis2/java/core/docs/axis2config.html](http://axis.apache.org/axis2/java/core/docs/axis2config.html)

**scope：（**可选属性）已部署服务的运行时信息可用的时间段。范围有几种类型——“应用程序”、“soapsession”、“transportsession”、“请求”。默认值（如果您不输入任何值）将是“请求”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:24:44.623

似乎可以在 WebSphere 中做你想做的事（不使用 services.xml）： [使用 wsadmin 脚本配置 Web 服务端口的范围](http://pic.dhe.ibm.com/infocenter/wasinfo/v7r0/topic/com.ibm.websphere.nd.doc/info/ae/ae/txml_scopewsadmin.html)

自己也没有尝试过，也无法在管理控制台或某种部署描述符中找到此类设置，但这也可能是可能的。

# jquery - 页面刷新后 jQuery 表单保持禁用状态

> ID：13479210
> 
> 赞同：0
> 
> 时间：2012-11-20T17:57:06.683
> 
> 标签：jquery, forms, refresh

我有一个带有一些选择输入字段的表单，如果选择器等于它会禁用其他一些输入字段。这工作得很好。

但是当表单刷新（使用预加载的输入）时，例如在表单无效的情况下，其他字段不会被禁用。

我的代码：

```
 $('#some_selector_id').change(function() {
            var val = $(this).val();
            if (val == "something")
            {
                  $('#other_field').prop('disabled', true);
            } else {
                  $('#other_field').prop('disabled', false);
            }
      }); 
```

为了保持代码干燥，我不想重复代码，有一种方法可以遵循： if`.change`或`.val_is`do `this`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T17:59:59.070

采用

```
$('#some_selector_id').change(); 
```

在 document.ready 中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:00:13.270

在 dom 就绪事件中，绑定更改事件后，您应该手动触发该事件：

```
$('#some_selector_id').change(); 
```

这将导致更改处理程序运行。

# php - PHP - 在类的所有公共属性上使用一个 setter

> ID：13479226
> 
> 赞同：1
> 
> 时间：2012-11-20T17:57:39.340
> 
> 标签：php, oop, properties, getter-setter

似乎有很多关于 PHP 中的 setter 和 getter 的问题。但是，它们似乎都没有提到它们不适用于公共变量。

我有一系列公共变量，在设置时需要相同类型的数据检查（主要是`strip_tags()`）。

***在保持变量公开***的同时，最有效的代码方法是什么？

似乎可用的唯一选项是为我的所有变量创建一个方法“setPropertyName”，这对我来说似乎没有必要。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:00:31.743

您**可以**将它们设为私有，并使用公共`__set()`并`__get()`获取变量（如果存在），并在设置时应用验证/清理操作。

例如：

```
class Foo {
    private $variable;
    private $otherVariable;

    public function __get($key) {
        return $this->$key;
    }

    public function __set($key, $value) {
        $this->$key = strip_tags($value);
    }
}

$foo = new Foo;
$foo->variable = "test"; //Works.
echo $foo->variable; //test 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:04:10.273

您可以尝试的一件事是魔术方法`__call($name,$args)`，然后您就不需要编写 setPropertyName 和 getPropertyName 函数：

```
function __call($name,$args){
    $variable=lcfirst(substr($name,3));
    if(!isset($this->$variable))
        return false;
    if(substr($name,0,3)=='set')
        $this->$variable=$args[0];
    else
        return $this->$variable;
    return true;
} 
```

话虽如此，如果使用得当，魔术方法`__get`和公共变量的工作效果很好。`__set`以下是我如何使用它们：

```
public $variables=array();
function __get($name){
    return isset($this->variables[$name])?$this->variables[$name]:false;
}
function __set($name,$value){
    $this->variables[$name]=$value;
} 
```

然后您可以通过使用`$this->name;`而不是`$this->getName();` 将它们放在一起来访问它们，然后您可以随心所欲地进行操作。

再次，这是一个骨干。如果要去除标签，可以将其放入代码中的 setter 或 getter 函数中，或者修改调用函数以检查将去除标签的第二个参数`$this->setName($value,true);//strip tags`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:06:37.300

实际上，明确定义您的 getter 和 setter 可能是最佳实践。话虽如此，您可以使用`__set()`和`__get()`魔术方法为从类外部（受保护和私有）无法访问的属性的请求提供通用处理。

因此，您需要做的就是使您的属性受保护/私有并指定`__get()`方法`__set()`（也可能需要`__isset()`以及`__unset()`如果您将使用`isset()`或尝试检查`unset()`属性）。

同样，最好的做法 (IMO) 使所有类属性都无法从类外部访问，并根据需要显式设置 setter/getter 以提供访问权限。

# sql - Oracle 自动添加当前日期

> ID：13479229
> 
> 赞同：10
> 
> 时间：2012-11-20T17:57:42.190
> 
> 标签：sql, oracle

我想创建一个表“产品”并有一列`date`，当我向表中添加一些信息时，是否可以添加当前日期？

如果是，请举这个表的例子

```
create table products (
id number not null,
date number not null
); 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-20T18:03:04.927

假如说

1.  您的列实际上没有命名`date`，因为这是一个保留字
2.  您的列实际上被定义为 a`date`而不是 a`number`
3.  您希望在插入新行时填充该列

您可以为该列定义一个默认值。

```
SQL> ed
Wrote file afiedt.buf

  1  create table products (
  2  id number not null,
  3  dt date   default sysdate not null
  4* )
SQL> /

Table created.

SQL>
SQL> insert into products( id ) values( 1 );

1 row created.

SQL> select * from products;

        ID DT
---------- ---------
         1 20-NOV-12 
```

如果要在行时修改`dt`列`UPDATE`，则需要触发器

```
CREATE OR REPLACE TRIGGER trg_products
  BEFORE INSERT OR UPDATE ON products
  FOR EACH ROW
BEGIN
  :new.dt := sysdate;
END; 
```

触发器将覆盖作为列的`INSERT`or`UPDATE`语句的一部分传入的任何值`dt`。默认值不会。

# d3.js - d3.js 双击

> ID：13479236
> 
> 赞同：1
> 
> 时间：2012-11-20T17:57:53.223
> 
> 标签：d3.js, double-click

我正在寻找一些关于 d3js 和移动事件的文档？我基本上是在尝试避免双击缩放，然后触发单独的功能。目前我正在使用这个 jquery 插件来删除移动链接上的双击/缩放
[到代码](https://stackoverflow.com/questions/10614481/disable-double-tap-zoom-option-in-browser-on-touch-devices)
但我无法在 d3js 中找到双击绑定的任何地方。有一个双击事件将在双击时触发，但鉴于当前的 jquery 插件覆盖缩放，我的双击事件不会触发。
非常感谢任何帮助

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T15:13:31.383

好的，答案是您可以添加一个触摸启动事件。所以像这样

`g.append("rect").on("touchstart",function(){
var t2 = e.timeStamp,
t1 = $(this).data('lastTouch') || t2,
dt = t2 - t1,
fingers = e.originalEvent.touches.length;
$(this).data('lastTouch', t2);
if (!dt || dt > 500 || fingers > 1) return; // not double-tap`

 ````
 e.preventDefault(); // double tap - prevent the zoom 
```` 

`})`

请注意，此代码最初由此[gist](https://gist.github.com/2047491)提供，并由[Wouter Konecny](https://stackoverflow.com/users/662564/wouter-konecny)
修改， 我只是将其添加为 touchstart 事件。顺便说一句，就像一个魅力

# iphone - 目标C：循环问题

> ID：13479237
> 
> 赞同：1
> 
> 时间：2012-11-20T17:57:56.647
> 
> 标签：iphone, objective-c, loops, while-loop

我刚从objective c（来自java）开始，我正在开发一个计算器程序，只是为了练习语法和一些基本的东西。我的方法是让用户输入一个字符串并查找运算符（考虑操作顺序），然​​后找到围绕该运算符的术语，计算它，用答案替换术语，然后重复所有条款；但是，我用于计算术语的方法存在问题。我传入运算符的索引并让它向后循环，直到它碰到另一个运算符以找到它之前的数字，并对后面的数字执行相同的转发。我的问题是循环在遇到运算符时不会停止，而是会一直持续到两个方向的字符串末尾。它' s 可能是我忽略的非常简单的事情，但我一直试图弄清楚这一点，但似乎无法理解。我只包含了该方法前半部分的 SSCCE，其中包含预定的字符串和运算符索引。（还有一个次要问题：有没有更好的方法在这个网站上发布代码块，而不是在每行之前手动放置 4 个空格？）

```
#import <Foundation/Foundation.h>
int firstNumInTerm(int index);
NSString *calculation;
int main(int argc, const char * argv[])
{
    @autoreleasepool {
        calculation = @"51-43+378*32";
        int firstNumber = firstNumInTerm(9);
        NSLog(@"The number before the term is: %i", firstNumber);    
    }
    return 0;
}

int firstNumInTerm(int index){
    int firstNumIndex = index - 1;
    int firstNumLength = 1;
    NSRange prevChar = NSMakeRange(firstNumIndex - 1, 1);
    while ([calculation substringWithRange:prevChar] != @"*" &&
           [calculation substringWithRange:prevChar] != @"/" &&
           [calculation substringWithRange:prevChar] != @"+" &&
           [calculation substringWithRange:prevChar] != @"-" &&
           firstNumIndex > 0) {
        NSLog(@"prevChar: %@", [calculation substringWithRange:prevChar]);//TEST
        firstNumIndex--; firstNumLength++;
        prevChar = NSMakeRange(firstNumIndex - 1, 1);
    }
    NSRange firstRange = NSMakeRange(firstNumIndex, firstNumLength);
    int firstNum = [[calculation substringWithRange:firstRange] intValue];

    NSLog(@"firstNum String: %@", [calculation substringWithRange:firstRange]);//TEST
    NSLog(@"firstNum int: %i", firstNum);//TEST

    return firstNum;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:06:29.887

在 Objective-C 中你不能这样做：`[calculation substringWithRange:prevChar] != @"*"` 相反，你需要这样做：

`[[calculation substringWithRange:prevChar] compare:@"*"] != NSOrderedSame`

（我知道，它更长，但算术运算符不会像在 Java 中那样重载字符串）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:12:40.290

我看到其他人已经回答了这个问题以纠正您的字符串比较操作的问题，但是拆分此字符串的更好方法是使用 NSString 的本机解析方法。例如：

```
 NSArray *numbers = [ calculation componentsSeparatedByCharactersInSet: 
 [ NSCharacterSet characterSetWithCharactersInString: @"*/+-" ] ]; 
```

将为您提供一个包含字符串中每个数字（按顺序）的数组。你可以想出自定义解析例程，但使用 NSString 可能会更直接，而且错误更少。其他人也更容易阅读和理解。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T18:12:59.867

```
while((![[calculation substringWithRange:prevChar] isEqualToString:@"*"]) && …){

} 
```

或者

```
NSArray *operators = @[@"+", @"-", @"*", @"/"];
while(![operators contains:[calculation substringWithRange:prevChar]]) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T05:23:50.050

这一行的问题 `[calculation substringWithRange:prevChar] != @"*"`是：您正在比较两个指针的值。`[calculation substringWithRange:prevChar]`返回一个指向`NSString`对象的指针，就像`NSString`文字语句一样`@"*"`。比较两个字符串的最简单方法是`isEqualToString:`使用`NSString`. 例如：

```
NSString *myName = @"Stephen";
NSString *yourName = @"Matt";

if([myName isEqualToString:yourName]){
    printf("We have the same name!");
}
else{
    printf("We do not have the same name");
} 
```

如果您要进行大量字符串比较，最好编写一个宏，例如： `#define STREQ(x,y) [x isEqualToString:y]`

**关于将代码复制/粘贴到 StackOverflow 中：**

由于我 99% 的时间都在使用 XCode，因此我发现选择要复制的文本然后点击`Cmd-]`. 这会将文本向右移动一个制表符宽度。然后我`Cmd-c`复制然后`Cmd-[`撤消右移。

# python - 如何创建一个在后台运行并且可以干净地停止的 Python 脚本？

> ID：13479243
> 
> 赞同：4
> 
> 时间：2012-11-20T17:58:20.050
> 
> 标签：python, loops, daemon, shutdown

我有一个不断运行的 python 脚本（它有一个无限循环），但我希望它在运行时仍然能够接受输入。它将在后台运行，然后在任何时候我都希望能够输入

```
scriptname stop 
```

并停止它（或类似的东西）。这样它就可以调用关闭方法来保存信息并退出。

目前它在终端的前台运行，并且无法通过键盘中断来停止，所以杀死它的唯一方法是关闭终端或杀死python。

我怎么能做这样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:01:04.363

使用`supervisord`. 它的存在是为了管理进程，并提供一个命令界面来启动和停止它们。

当主管杀死一个进程时，它会发送 SIGTERM （或您选择的任何其他信号）。因此，要干净地关闭，您需要处理该信号。

请参阅有关如何处理 SIGTERM 的问题：[Python - 捕获所有信号](https://stackoverflow.com/questions/2148888/python-trap-all-signals)

进程仍然可以在自己的管道上监听输入，并以这种方式发送输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-16T23:09:20.527

如果您在 Windows 中，那么您来对地方了...

只需将您的文件重命名**`script.py`**为**`script.pyw`**并正常使用即可。
您的脚本将在后台运行。

要关闭该脚本：
转到**Task Manager**，单击**Process Tab** ，注意**python**，**End Task**。

如果您需要更多信息，我已准备好为您提供……
我不确定 Linux 或 Ubuntu。
谢谢。

# perl - 当从 Perl 模块调用方法时，为什么 '::' 和 '->' 可以互换工作（某种程度上）？

> ID：13479246
> 
> 赞同：8
> 
> 时间：2012-11-20T17:58:31.017
> 
> 标签：perl, oop, module

从模块调用子例程时，我一直感到`::`困惑。`->`我知道这`::`与路径以及模块/子例程在哪里以及`->`用于对象的位置更相关，但我真的不明白为什么我似乎可以互换两者并且不会立即出现错误。我有 perl 模块，它们是更大包的一部分，例如`FullProgram::Part1`

我只是要掌握模块，但在涉及 Perl 对象时仍然处于不稳定的状态，但我一直不小心这样做：

```
FullProgram::Part1::subroutine1(); 
```

代替

```
FullProgram::Part1->subroutine1(); 
```

因此，当我一直将哈希引用传递给 subroutine1 并小心使用`$class/$self`来处理对象引用并意外使用`::`时，我最终拉出我的头发，想知道为什么我的哈希引用似乎消失了。我已经吸取了教训，但真的很想解释一下差异。我已经阅读了关于这些的 perldocs 和各种网站，但我没有看到两者之间的任何比较（谷歌很难......）所有帮助表示赞赏 - 总是很高兴了解我在做什么！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-20T18:08:47.560

vanilla sub和一个方法之间没有内在的区别。这一切都在你如何称呼它。

* * *

```
Class::foo('a'); 
```

这将调用`Class::foo`. 如果`Class::foo`不存在，则不会检查继承树。`Class::foo`将仅传递提供的参数 ( `'a'`)。

它与以下内容大致相同：`my $sub = \&Class::foo; $sub->('a');`

* * *

```
Class->foo('a'); 
```

这将调用`Class::foo`, 或`foo`在其基类之一中调用（如果`Class::foo`不存在）。调用者（左边的`->`）将作为参数传递。

它与以下内容大致相同：`my $sub = Class->can('foo'); $sub->('Class', 'a');`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-20T18:08:37.797

```
FullProgram::Part1::subroutine1(); 
```

调用带有空参数列表`subroutine1`的包的子例程，而`FullProgram::Part1`

```
FullProgram::Part1->subroutine1(); 
```

使用包名称作为第一个参数调用相同的子例程（请注意，当您进行子类化时它会变得有点复杂）。此语法由需要类名来构建子类对象的构造函数使用，例如

```
sub new {
    my ($class, @args) = @_;
    ...
    return bless $thing, $class;
} 
```

仅供参考：在 Perl OO 中，您会看到`$object->method(@args)`哪些调用`Class::method`以对象（祝福引用）作为第一个参数而不是包/类名。在这样的方法中，子程序可以这样工作：

```
sub method {
    my ($self, $foo, $bar) = @_;
    $self->do_something_with($bar);
    # ...
} 
```

它将`do_something_with`再次以对象作为第一个参数调用子例程，然后`$bar`是您最初传递给`method`in的第二个列表元素的值`@args`。这样对象本身就不会丢失。

有关调用方法时继承树如何变得重要的更多信息，请参阅[ikegami 的回答](https://stackoverflow.com/a/13479403/1184510)！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-20T19:57:03.573

两者都用！

```
use Module::Two;

Module::Two::->class_method(); 
```

请注意，这有效，但也可以保护您免受歧义；简单的

```
Module::Two->class_method(); 
```

将被解释为：

```
Module::Two()->class_method(); 
```

（在 Module 中调用子例程 Two 并尝试在其返回值上调用 class_method - 可能导致运行时错误或调用某个完全不同的类中的类或实例方法）*如果*Module 中恰好有一个 sub Two - 你不应依赖于一种或另一种方式，因为Module 中的内容与*您的代码无关。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T18:18:17.953

从历史上看，Perl 没有任何 OO。以及使用`FullProgram::Part1::subroutine1();`sytax 调用的包中的函数。甚至在使用`FullProgram'Part1'subroutine1();`语法之前（已弃用）。

后来，他们用`->`符号实现了OOP，但实际上并没有太大变化。`FullProgram::Part1->subroutine1();`调用`subroutine1`并`FullProgram::Part1`作为第一个参数。您可以在创建对象时看到它的用法：`my $cgi = CGI->new()`. 现在，当您从此对象调用方法时，左侧部分也作为函数的第一个参数：`$cgi->param('')`。这就是如何`param`获取他调用的对象（通常命名为`$self`）。就是这样。`->`是面向 OOP 的 hack。因此，Perl 没有类（包像它们一样工作），但确实有对象（“对象”也被破解了——它们是有福的标量）。

Offtop：您也可以使用`my $cgi = new CGI;`语法调用。这与`CGI->new`. 你说的也一样`print STDOUT "text\n";`。是的，只是打电话`IOHandle::print()`。

# java - Spring Batch：针对不同工作的不同工作启动器

> ID：13479249
> 
> 赞同：7
> 
> 时间：2012-11-20T17:58:40.330
> 
> 标签：java, spring, spring-batch, spring-batch-admin

我有 2 份不同的工作（实际上更多，但为简单起见假设 2 份）。每个作业都可以与另一个作​​业并行运行，但同一作业的每个实例都应按顺序运行（否则实例将蚕食彼此的资源）。

基本上我希望这些作业中的每一个都有自己的作业实例队列。我想我可以使用两个不同的线程池作业启动器（每个都有 1 个线程）并将作业启动器与每个作业相关联来做到这一点。

从 Spring Batch Admin Web UI 启动作业时，是否有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T18:36:23.753

有一种方法可以为特定作业指定特定的作业启动器，但我发现这样做的唯一方法是使用 JobStep。

如果您有一个名为“specificJob”的作业，这将创建另一个作业“queueSpecificJob”，因此当您通过 Quartz 或 Spring Batch Web 管理员启动它时，它将排队执行“specificJob”。

```
<bean id="specificJobLauncher" class="org.springframework.batch.core.launch.support.SimpleJobLauncher">
    <property name="jobRepository" ref="jobRepository"/>
    <property name="taskExecutor">
        <task:executor id="singleThreadPoolExecutor" pool-size="1"/>
    </property>
</bean>

<job id="queueSpecificJob">
    <step id="specificJobStep">
        <job ref="specificJob" job-launcher="specificJobLauncher" job-parameters-extractor="parametersExtractor" />
    </step>
</job> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T13:32:46.620

@ahbutfore

工作是如何触发的？您是否有机会使用石英触发器？如果是的话，在你所有的工作中实现/扩展 org.quartz.StatefulJob 接口会为你工作吗？

请参阅此处的 Spring beans 配置：[https](https://github.com/regunathb/Trooper/blob/master/examples/example-batch/src/main/resources/external/shellTaskletsJob/spring-batch-config.xml) ://github.com/regunathb/Trooper/blob/master/examples/example-batch/src/main/resources/external/shellTask​​letsJob/spring-batch-config.xml 。查看 org.trpr.platform.batch.impl.spring.job.BatchJob 的源代码

您可以使用合适的“Leader Election”实现进行更复杂的序列化（包括跨 Spring 批处理节点）。我在我的项目中使用了 Netflix Curator（一个 Apache Zookeeper 配方）。这里有一些指示：[https ://github.com/regunathb/Trooper/wiki/Useful-Batch-Libraries](https://github.com/regunathb/Trooper/wiki/Useful-Batch-Libraries)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T09:33:45.063

使用 shell 脚本，您可以并行启动不同的作业。

在每个命令行的末尾添加一个“&”。shell 将与它自己的执行并行执行它们。

# php - PHP 确定的 HTML 类

> ID：13479250
> 
> 赞同：1
> 
> 时间：2012-11-20T17:58:42.260
> 
> 标签：php, html

我正在尝试确定使用 PHP 分配选项卡式菜单项的类的最佳方式。

到目前为止，我在这里和其他地方所读到的关于这个主题的内容似乎只能确定非常简单的案例。当您在其页面上时，我需要为选项卡设置一个活动类，并且我还需要为无法访问该功能的帐户上的选项卡设置一个禁用类（基于会话标志）。

最初，我只是回应了这样的一切：

```
 <?php  
    echo '<li class="some-tab ';if($pageName === "somepage.php"){echo'active';}
            if(!$_SESSION['some_flag']){echo'disabled';
            echo'"><a href="">Link</a>';}
   ?> 
```

但随后代码耻辱设置，我正试图真正开始使用 PHP 像模板引擎。也就是说，我不想使用实际的模板引擎。

对于 HTML 的任何其他部分，跳入和跳出 PHP 很容易且相对优雅，但在让类工作时，感觉很笨拙。它完全污染了标记，并在我的模板中留下了太多的逻辑。

像这样：

```
<li class="some-tab <? if($pageName === "somepage.php"){echo'active';} ?></li> 
```

不可怕，但添加更多规则，它变得一团糟。

我的第一个想法是创建一个关联数组并回显它的内容：

```
<?  if(some condition){
       $class = array("sometab" => "sometab active disabled");
    }
    else{
       $class = array("sometab" => "sometab");
    }
 ?>
<li class="<?= $class['sometab'] ?>"> </li> 
```

但我觉得它可能[太聪明了](http://en.wikipedia.org/wiki/KISS_principle)。

我想避免将信息存储在正文类中或某些人建议的 Javascript cookie 中，因为我不只是获取 URL。

有没有我错过的选项？

类数组是否合适？我没有经验知道这是否是一个可怕的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:32:52.097

我想你自己回答了这个问题。

如果你想让它像模板引擎一样运行，你需要一个*模板**引擎*

话虽如此，但您可能会觉得很简洁的是速记逻辑语句：

```
if($x > 10){echo 'BlahBlah';}else{ echo 'NahNah';} 
```

变成：

```
echo ($x>10?'BlahBlah':'NahNah'); 
```

这些可以在您提到的逻辑门中派上用场

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:54:03.753

你的最后一个选择对我来说是最优雅的。无论如何，如果您可以将 MVC 模式与某些框架一起使用，我强烈推荐给您。

在任何情况下，如果您不想为每个 CSS 样式创建变量，您很可能必须在模板中的某个时间点处理这些内容。

# objective-c - 为什么这个 @synthesize 实现会在 Objective-C 中返回错误？

> ID：13479251
> 
> 赞同：0
> 
> 时间：2012-11-20T17:58:50.360
> 
> 标签：objective-c, ios, xcode, synthesize

```
#import "CLSViewController.h"

@implementation CLSViewController

@synthesize statusText = _statusText;

- (void)viewDidUnload {
    [self setStatusText:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (IBAction)buttonPressed:(UIButton *)sender {
    NSString *title = [sender titleForState:UIControlStateNormal];
->  statusText.text = [NSString stringWithFormat:@"%@ button pressed.", title];
}

@end 
```

表示 statusText.text = ... 的行

我没有正确合成它吗？`= _statusText;`从中删除它可以消除错误，但我认为我们应该将其设置为某些东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T18:02:22.013

如果你想访问该属性，你应该使用

```
self.statusText.text = .... 
```

您还可以使用 _statusText 直接访问变量：

```
_statusText.text = .... 
```

如果您从综合行中删除 _statusText，实例变量名称将被假定为“statusText”，这就是您删除它时您的情况有效的原因。

```
@synthesize statusText
....
statusText.text = [NSString stringWithFormat:@"%@ button pressed.", title]; // this works 
```

IMO 您应该始终将其作为属性（例如 self.statusText）访问，除非在 init/dealloc 中，因为您是这样声明的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:11:03.917

编码：

```
@synthesize statusText = _statusText; 
```

表示 statusText 是您班级的公共字段， _statusText 是私有符号。因为所以你必须像这样修改你的代码：

```
self.statusText.text = [NSString stringWithFormat:@"%@ button pressed.", title]; 
```

或这个：

```
_statusText.text = [NSString stringWithFormat:@"%@ button pressed.", title]; 
```

# graphics - 从 d3d11 中的渲染目标读取像素数据

> ID：13479259
> 
> 赞同：8
> 
> 时间：2012-11-20T17:59:20.080
> 
> 标签：graphics, textures, direct3d, direct3d11

我将 a 设置`texture2d`为设备渲染目标。绘制后，如何直接从渲染目标读取和写入像素，然后呈现。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-20T13:27:20.500

如果您打算将其用作另一个着色器的输入： - 只需确保您使用 D3D11_BIND_RENDER_TARGET 和 D3D11_BIND_SHADER_RESOURCE 创建了 texture2D。

*   将纹理绑定为渲染目标并渲染到它。
*   将其解绑为渲染目标并将其绑定为着色器资源并在下一个着色器中使用。
*   请注意，纹理不能同时绑定为目标和资源。

如果您的意图是使用 C++ 作为像素数组访问 CPU 上的纹理，那么您必须做一些工作。不幸的是，由于当前的 GPU 架构，不可能直接访问纹理 2D 的像素，因为像素实际上以特殊格式（混合格式）存在于 GPU 内存潜力中。

*   创建 GPU 可以渲染到的纹理。
*   创建将用于接收 GPU 输出的暂存纹理 (D3D11_USAGE_STAGING)。
*   渲染到 GPU 纹理。
*   发出 ID3D11DeviceContext::CopyResource() 或 ID3D11DeviceContext::CopySubresource()
*   在暂存资源上调用 ID3D11DeviceContext::Map() 以访问像素。
*   在暂存资源上调用 ID3D11DeviceContext::Unmap()。
*   调用 ID3D11DeviceContext::UpdateSubresource() 来更新 GPU 拥有的资源的版本。

正如您所看到的，这当然不是一组微不足道的操作，并且与当今 GPU 架构的优化目标背道而驰。我当然不会推荐它。

如果您最终走上了这条路，请务必阅读有关 GPU 内存回读附带的所有性能问题：http: [//msdn.microsoft.com/en-us/library/windows/desktop/bb205132 (v =vs.85).aspx#Performance_Considerations](http://msdn.microsoft.com/en-us/library/windows/desktop/bb205132(v=vs.85).aspx#Performance_Considerations)

# java - 如何从单独的类java调用方法

> ID：13479263
> 
> 赞同：3
> 
> 时间：2012-11-20T17:59:39.297
> 
> 标签：java, class, methods

我试图从java中的一个单独的类中调用一个方法，但它似乎不起作用，或者我做错了什么。我想要实现的是`Race`将类中的方法调用`RacingEvent`到我的主程序中（检查主程序中的注释）。

这是课程：

```
import java.util.Random;

public class RacingEvent {
    private SimpleWindow w;
    private RaceTrack track;
    private Turtle t1 = new Turtle(w, 200, 400);
    private Turtle t2 = new Turtle(w, 300, 400);

    public RacingEvent(RaceTrack track, Turtle t1, Turtle t2) {
        this.t1 = t1;
        this.t2 = t2;
        this.track = track;
 }

    public void Race() {
        t1.penDown();
        t2.penDown();
        Random rand = new Random();

        Turtle t1 = new Turtle(w, 200, 400);
        Turtle t2 = new Turtle(w, 300, 400);

        while (t1.getY() > track.getyFinish() && t2.getY() > track.getyFinish()) {
            int turtle1 = rand.nextInt(3);
            int turtle2 = rand.nextInt(3);
            t1.forward(turtle1);
            t2.forward(turtle2);

            SimpleWindow.delay(10);
        }

        int diff1 = t1.getY() - track.getyFinish();
        int diff2 = t2.getY() - track.getyFinish();

        SimpleWindow w = new SimpleWindow(200, 100, "Winner");

        if (t1.getY() <= track.getyFinish()) {
            w.moveTo(20, 40);
            w.writeText("T1 won with a " + diff2 + " step(s) lead!");
        } else if (t2.getY() <= track.getyFinish()) {
            w.moveTo(20, 40);
            w.writeText("T2 won with a " + diff1 + " step(s) lead!");
        }
    }
} 
```

这是我需要调用该方法的主程序：

```
public class TurtleRace {
    public static void main(String[] args) {
        SimpleWindow w = new SimpleWindow(600, 600, "TurtleRace");
        int yStart = 400; 
        int yFinish = 100; 

        RaceTrack track = new RaceTrack(w, yStart, yFinish);
        ColorTurtle t1 = new ColorTurtle(w, 250, yStart, java.awt.Color.RED);
        ColorTurtle t2 = new ColorTurtle(w, 350, yStart, java.awt.Color.BLUE);

        track.draw(w);
        w.waitForMouseClick();

        RacingEvent event = new RacingEvent(track, t1, t2);
        /*Call Race Method*/
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:06:33.630

当你这样做时

```
RacingEvent event = new RacingEvent(track, t1, t2); 
```

您只是在创建和实例化 RacingEvent 类的对象。

尚未进行函数调用。

你应该写这个来调用函数。

```
event.Race(); 
```

希望它能解决问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T18:09:24.093

`RacingEvent`不初始化其`w`字段。您可能希望将调用者（`w`也在那里调用）可用的值传递给构造函数并设置`w`为传入的参数。

详细地：

将构造函数更改为

```
public RacingEvent(SimpleWindow w, RaceTrack track, Turtle t1, Turtle t2) {
        this.w = w;
        this.t1 = t1;
        this.t2 = t2;
        this.track = track;
 } 
```

并这样称呼它：

```
 RacingEvent event = new RacingEvent(w, track, t1, t2);
 event.race(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:20:46.717

简化解决方案：

```
import java.awt.*;
import java.util.Random;

class SimpleWindow {
  public SimpleWindow(int i, int i1, String winner) {
    //To change body of created methods use File | Settings | File Templates.
  }

  public static void delay(int i) {
    //To change body of created methods use File | Settings | File Templates.
  }

  public void moveTo(int i, int i1) {
    //To change body of created methods use File | Settings | File Templates.
  }

  public void writeText(String s) {
    //To change body of created methods use File | Settings | File Templates.
  }

  public void waitForMouseClick() {
    //To change body of created methods use File | Settings | File Templates.
  }
}
class ColorTurtle extends Turtle {
  public ColorTurtle(SimpleWindow w, int i, int yStart, Color red) {
    //To change body of created methods use File | Settings | File Templates.
  }

  public ColorTurtle(SimpleWindow w, int i, int i1) {
    super(w, i, i1);
  }
}

class RaceTrack {
  private int yFinish;

  public RaceTrack(SimpleWindow w, int yStart, int yFinish) {
    //To change body of created methods use File | Settings | File Templates.
  }

  public int getyFinish() {
    return yFinish;
  }

  public void draw(SimpleWindow w) {
    //To change body of created methods use File | Settings | File Templates.
  }
}
class Turtle {
  private int y;

  public Turtle(SimpleWindow w, int i, int i1) {
    //To change body of created methods use File | Settings | File Templates.
  }

  Turtle() {
  }

  public void penDown() {
    //To change body of created methods use File | Settings | File Templates.
  }

  public int getY() {
    return y;
  }

  public void forward(int turtle1) {
    //To change body of created methods use File | Settings | File Templates.
  }
}
class RacingEvent {
  private SimpleWindow w;
  private RaceTrack track;
  private Turtle t1 = new Turtle(w, 200, 400);
  private Turtle t2 = new Turtle(w, 300, 400);

  public RacingEvent(RaceTrack track, Turtle t1, Turtle t2) {
    this.t1 = t1;
    this.t2 = t2;
    this.track = track;
  }

  public void Race() {
    t1.penDown();
    t2.penDown();
    Random rand = new Random();

    Turtle t1 = new Turtle(w, 200, 400);
    Turtle t2 = new Turtle(w, 300, 400);

    while (t1.getY() > track.getyFinish() && t2.getY() > track.getyFinish()) {
      int turtle1 = rand.nextInt(3);
      int turtle2 = rand.nextInt(3);
      t1.forward(turtle1);
      t2.forward(turtle2);

      SimpleWindow.delay(10);
    }

    int diff1 = t1.getY() - track.getyFinish();
    int diff2 = t2.getY() - track.getyFinish();

    SimpleWindow w = new SimpleWindow(200, 100, "Winner");

    if (t1.getY() <= track.getyFinish()) {
      w.moveTo(20, 40);
      w.writeText("T1 won with a " + diff2 + " step(s) lead!");
    } else if (t2.getY() <= track.getyFinish()) {
      w.moveTo(20, 40);
      w.writeText("T2 won with a " + diff1 + " step(s) lead!");
    }
  }
}
public class TurtleRace {
  public static void main(String[] args) {
    SimpleWindow w = new SimpleWindow(600, 600, "TurtleRace");
    int yStart = 400;
    int yFinish = 100;

    RaceTrack track = new RaceTrack(w, yStart, yFinish);
    ColorTurtle t1 = new ColorTurtle(w, 250, yStart, java.awt.Color.RED);
    ColorTurtle t2 = new ColorTurtle(w, 350, yStart, java.awt.Color.BLUE);

    track.draw(w);
    w.waitForMouseClick();

    RacingEvent event = new RacingEvent(track, t1, t2);
    /*Call Race Method*/
    event.Race();
  }
} 
```

# iphone - 锁定 UIDatePicker 列

> ID：13479265
> 
> 赞同：1
> 
> 时间：2012-11-20T17:59:47.283
> 
> 标签：iphone, ios, xcode, uidatepicker

我有一个设置了日期模式的 UIDatePicker，我想锁定月份和年份选择，这样你只能更改日期，这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T05:29:25.830

适当地设置`maximumDate`和`minimumDate`。几个月之间的过渡可能是非常需要处理的边缘情况......

请注意，微调器的顺序会因地区而异，因此尝试捕捉触摸可能会失败。

一个快速的替代方法是创建自己的，您可以根据月份/闰年`UIPickerView`传递一个数组。`1...[28-31]`对于用户来说可能更直观，而不是拥有 2 个不允许他们旋转的微调器。

# c# - 数据绑定列表 > 进入中继器

> ID：13479269
> 
> 赞同：0
> 
> 时间：2012-11-20T18:00:03.320
> 
> 标签：c#, asp.net, repeater, bind, tuples

好的，我无法`System.Tuple'2[System.DateTime,System.Boolean]`转换（系统在我在下面的代码中添加注释***错误***`System.Collections.Generic.List'1[System.Tuple'2[System.DateTime,System.Boolean]]`的行中显示异常）

 *但是我怎么能`List<Tuple>`在我的中继器中绑定我的。

如果不为此任务创建接口或类，就无法完成此任务。

**这是我的代码**

```
#region Fields
ControllerProg controllerProg = new ControllerProg();
List<Tuple<DateTime, Boolean>> lstDatePagination = new List<Tuple<DateTime, Boolean>>();
List<DateTime> dtPag = new List<DateTime>();
#endregion

dtPag = controllerProg.ListDates(15);
if (dtPag.Count > 0)
{
    double j = 1;
    for (int i = 0; i < 15; i++)
    {
        if (dtPag.Count > i && dtPag[i] != null)
        {
            lstDatePagination.Add(Tuple.Create(dtPag[i], true));
        }
        else
        {
            lstDatePagination.Add(Tuple.Create(dtPag.Last().AddDays(j), false));
            j++;
        }
    }
    rptPagination.DataSource = lstDatePagination;
    rptPagination.DataBind();
}

protected void rptPagination_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
    {
        // Error
        List<Tuple<DateTime, Boolean>> datePagination = (List<Tuple<DateTime, Boolean>>)e.Item.DataItem;
        // InvalidCastException was unhandled by user code

        Label lblDay = (Label)e.Item.FindControl("lblDay");
        lblDay.Text = datePagination[0].Item1.ToString("dd/MM/yyyy");
        lblDay.Enabled = datePagination[0].Item2;
    }
} 
```

创建关于代码的简短解释是，我在一个特定的选择中获取所有日期，填补空白`for`

我的问题实际上是关于如何将列表绑定到`RepeaterItemEventArgs`没有接口和类的列表中。（就像我们对 List<> 所做的那样）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:08:01.860

当然，您不能将 a`Tuple<DateTime, Boolean>`转换为`List<Tuple<DateTime, Boolean>>`. 尝试：

```
protected void rptPagination_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
    {
        // Error
        Tuple<DateTime, Boolean> datePagination = (Tuple<DateTime, Boolean>)e.Item.DataItem;

        Label lblDay = (Label)FindControl("lblDay");
        lblDay.Text = datePagination.Item1.ToString("dd/MM/yyyy");
        lblDay.Enabled = datePagination.Item2;
    }
} 
```*

# sql - ID 号的 SQL 检查约束

> ID：13479270
> 
> 赞同：1
> 
> 时间：2012-11-20T18:00:05.553
> 
> 标签：sql, sql-server-2008-r2

我正在尝试对 ID 号执行 SQL 检查约束

```
Name: EmployeeID
Data Type: char
Size: 10 
```

我正在使用 Microsoft SQL Server 2008 R2，我无法理解它如何使用一些可以在查询中工作的 SQL 命令，但由于某种原因不能作为检查约束。

我正在尝试使用 LIKE 来做到这一点，例如

```
EmployeeID LIKE '[0-9] [0-9] [0-9] [0-9] [0-9] [0-9] [0-9] [0-9] [0-9] [0-9]' 
```

但它不接受这一点，有没有更好的方法来解决这种约束？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:06:48.920

方括号之间没有空格，它应该可以工作：

```
EmployeeID LIKE '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T18:07:13.697

您的约束当前需要存在 9 个空格。尝试：

```
EmployeeID LIKE '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]' 
```

或许：

```
LEN(EmployeeID) = 10 and EmployeeID not like '%[^0-9]%' 
```

这表示没有字符在组之外，`0-9`并且长度为 10 个字符 - 如果将来需要更改长度，则更易于维护。

# julia - 如何使用分布式数组计算运行 Julia 并行代码

> ID：13479274
> 
> 赞同：8
> 
> 时间：2012-11-20T18:00:14.680
> 
> 标签：julia

我在 Windows 上运行[文档](http://docs.julialang.org/en/latest/manual/parallel-computing/#distributed-array-computations)中的示例：

```
julia> function compute_something(A::DArray)
           B = darray(eltype(A), size(A), 3)
           for i = 1:size(A,3)
              @spawnat owner(B,i) B[:,:,i] = sqrt(A[:,:,i])
           end
           B
       end

julia> A = drand(10, 15, 4)

julia> compute_something(A) 
```

但我收到一个错误：

```
in compute_something: B not defined 
```

为什么我会收到此错误？

在[Web REPL](http://julia.forio.com)中，此示例有效。

# ios - GCD 阻止异步队列继续进行

> ID：13479275
> 
> 赞同：1
> 
> 时间：2012-11-20T18:00:26.760
> 
> 标签：ios, multithreading, grand-central-dispatch, afnetworking

我正在使用`AFHTTPRequestOperation`来自很棒的[AFNetworking](http://afnetworking.com/)下载文件。

我正在下载大型 zip 文件，下载完成后需要解压缩。但是由于`AFHTTPRequestOperation`' 的完成块发生在主线程上，并且这些文件相对较大，我需要在后台线程上解压缩，这是我用 GCD 实现的。

但是在这个后台线程中解压可能会出错，如果是这种情况，我需要能够阻止线程继续......有没有办法用 GCD 来做，或者我必须把所有东西都放在声明`if`？

```
[operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *theOperation, id responseObject){

    NSLog(@"*** TP DOWNLOADER: Finished downloading");

    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^{

        //Unzip the file:
        ZipArchive *za = [[ZipArchive alloc] init];

        BOOL unzipOpenFileSuccessful = [za UnzipOpenFile:operation.targetPath Password:@"thepassword"];
        if(!unzipOpenFileSuccessful){

            NSLog(@"Problems unzipping!");

            //should return here and not keep doing work!
        }

        //keep doing work... 

    });
]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:30:21.650

如果发生错误，您可以“返回”。

# java - (Java) 错误：类 MinimaxThread 中的构造函数 MinimaxThread 不能应用于给定类型

> ID：13479277
> 
> 赞同：1
> 
> 时间：2012-11-20T18:00:31.003
> 
> 标签：java, compiler-errors

我在尝试编译我的 Java 代码时遇到了一个我真的无法解释的错误：

```
error: constructor MinimaxThread in class MinimaxThread cannot be applied to given types;
        MinimaxThread mmt = new MinimaxThread(board.clone(), 2, true);
                            ^
  required: no arguments
  found: MCBoard,int,boolean
  reason: actual and formal argument lists differ in length 
```

这个错误没有意义，因为我有一个构造函数，它接受一个 MCBoard、int 和 boolean：

```
public class MinimaxThread implements Runnable {
    public MCBoard board;
    public int depth;
    public HashMap<Tuple, Integer> moveEvals;
    boolean cont = true;
    boolean verbose = false;

    public MinimaxThread(MCBoard board, int initialDepth, boolean verbose) {
        this.board = board;
        depth = initialDepth;
        moveEvals = new HashMap<Tuple, Integer>();
        for (Tuple t : board.legalMoves) {
            moveEvals.put(t, new Integer(0));
        }
        this.verbose = verbose;
    } 
```

这是一个重载的构造函数（有一个只有 MCBoard，一个有 MCBoard 和 int），但我不明白这有什么关系。有任何想法吗？这是调用代码：

```
public static void testMinimax(){
    MCBoard board = new MCBoard();
    board.move(5,0);
    board.move(4,0);
    board.move(5,2);
    MinimaxThread mmt = new MinimaxThread(board.clone(), 2, true);
    mmt.run();
} 
```

编辑：`board.clone()`被覆盖：

```
public MCBoard clone() {
    // irrelevant code removed
    return new MCBoard(gridClone, turn, legalMovesClone, moveListClone);
} 
```

编辑#2：这是我的 git 存储库，为了重现性：https://github.com/cowpig/MagneticCave

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T18:02:02.137

编辑：现在您已经给了我们您的 github URL，我们可以看到[`MinimaxThread`](https://github.com/cowpig/MagneticCave/blob/master/MinimaxThread.java)真正的样子 - 至少在最新推送的代码中：

```
public class MinimaxThread extends Thread {
    public MCBoard board;
    public int depth;

} 
```

是的，我明白为什么编译器会在那个构造函数调用中抱怨......

编辑：在我们知道它`MCBoard.clone()`被覆盖之前，下面的答案是有道理的。然而，现在我看不出编译器有什么理由抱怨。事实上，使用你给出的代码（但忽略实际的实现，这是无关紧要的）它都编译得很好：

MinimaxThread.java：

```
public class MinimaxThread implements Runnable {
    public MinimaxThread(MCBoard board, int initialDepth, boolean verbose) {
    }

    public void run() {
    }
} 
```

MCBoard.java：

```
public class MCBoard {
    public MCBoard clone() {
        return null;
    }
} 
```

测试.java：

```
public class Test {
    public static void main(String[] args) throws Exception {
        MCBoard board = new MCBoard();
        MinimaxThread mmt = new MinimaxThread(board.clone(), 2, true);
    }
} 
```

所以我怀疑你没有构建你提供的代码。尝试构建上面的代码，如果可行，看看你是否能弄清楚它和你的*实际*代码之间的区别。

**原始答案**

大概编译器“认为”`board.clone()`返回`Object`，因为这是由 . 声明的`Object.clone()`。因此，您需要将结果转换为`MCBoard`：

```
MinimaxThread mmt = new MinimaxThread((MCBoard) board.clone(), 2, true); 
```

Alternatively, you could override `clone()` within `MCBoard`, declaring that it returns `MCBoard` rather than `Object`.

# windows-7 - Windows 资源管理器错误消息？

> ID：13479280
> 
> 赞同：3
> 
> 时间：2012-11-20T18:00:37.060
> 
> 标签：windows-7, iis-7.5, webdav, windows-explorer

我想知道 Windows 资源管理器从哪里得到它的错误消息。*我的情况*非常具体，因为我使用的是自定义 WebDAV 实现，但我认为这个问题可以更广泛地应用（任何映射驱动器）。

所以假设我有一个映射到我的 WebDAV 共享的驱动器。我在 Windows 资源管理器中打开映射驱动器窗口，然后从那里尝试创建一个新文件夹。现在在我的自定义 WebDAV 实现中，我正在寻找`MKCOL`创建文件夹的 WebDAV 动词，在这种情况下，我想阻止创建文件夹。所以我返回一个 400 (Bad Request) 作为 HTTP 响应。

问题是，现在无论我如何处理，Windows 资源管理器都会弹出一条错误消息，上面写着：

> 文件过大。文件“<%1 NULL:NameDest>”对于目标文件系统来说太大了。

*请求尝试创建文件夹*时哪个*文件*太大？

 *我想弄清楚的是 Windows 资源管理器从哪里得到的？我可以看到我如何使用 Fiddler 处理响应的所有详细信息（例如，我可以在 400 响应中返回自定义异常详细信息），那么它如何将我的 400 连接到我上面收到的消息？有什么方法可以格式化 HTTP 响应，以便 Windows 资源管理器获取我提供的详细信息并在错误消息中使用它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T16:11:25.343

Explorer 将`ERROR_INVALID_PARAMETER`其视为“文件太大”，因为这就是某些文件系统报告该错误情况的方式。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-06-28T08:19:42.347

请以管理员权限 [1] 启动命令提示符 (cmd.exe) 并运行 sfc [2]：

sfc.exe /scannow*

# mysql - iOS中数据库连接的首选方式

> ID：13479284
> 
> 赞同：1
> 
> 时间：2012-11-20T18:00:47.653
> 
> 标签：mysql, ios, cocoa-touch, sqlconnection

我是一名初学者 iOS 开发人员，我正在尝试构建一个 CRM 系统来学习开发的不同方面。

我对连接到外部 SQL 服务器的首选方式有疑问。顺便说一句，我正在使用 Karl Krafts 的 Obj-C MySQL 连接器。现在我在我的应用程序委托（didFinishLaunchingWithOptions）中初始化了数据库控制器（它反过来创建，然后空闲到服务器的连接）对象，这给了我一些不需要的副作用。屏幕很长一段时间都是黑色的如果与数据库的连接速度很慢，则启动，有时应用程序“太快”并且查询在连接完全建立之前尝试执行 - 导致抛出异常。

我想要的行为（并且猜测是首选）是首先加载 GUI，然后在后台线程中建立 DB 控制器和连接的初始化 - 在获取数据后更新 GUI。

我将如何实现这一目标？我已经尝试了许多不同的方法，我在我的研究中遇到过，dispatch_queues 并直接从 viewDidLoad 等中初始化它，但是没有一个给我想要的“GUI 然后数据”效果。

此外，在程序会话期间最好有一个空闲连接 - 还是每个查询都应该“连接 - 做它的事情 - 断开连接”？

问候，克里斯托弗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:09:46.870

戒律一：不要在主线程上做网络——它是为 UI 保留的。否则，您的应用程序将有一个滞后和冻结的 UI。

戒律二：不要使用大量的顺序同步调用，而是使用异步调用（GCD、后台线程等）、事件和回调。Cocoa (Touch) 的设计考虑到了这一点，所以很容易做到。

戒律三：如果你自动启动某些东西，让它在应用程序完全准备好时启动。让对 Web 服务的调用成为`application:didFinishLaunchingWithOptions:`. 更好的是，让用户有可能通过用户操作启动登录，即按下“登录”按钮。

诫命四：再次阅读前三诫并牢记在心。练习它们，直到你熟悉它们。

# python - 通过 Facebook 登录 Django 站点

> ID：13479286
> 
> 赞同：0
> 
> 时间：2012-11-20T18:00:56.347
> 
> 标签：python, django, facebook

我正在使用 Django。

我曾经`facebook-connect`在我的页面上放了一个 Facebook 登录按钮。这个功能很好用。任何用户都可以点击按钮，直接登录Facebook。我还可以在我的站点数据库中存储 Facebook 用户信息，例如姓名和电子邮件地址。

但我希望用户能够点击 Facebook 登录按钮并登录到我的网站。目前他们只能登录 Facebook。如何使用 Facebook 登录按钮对我网站上的用户进行身份验证？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:27:04.323

您可以查看 django 文档：

[其他认证来源](https://docs.djangoproject.com/en/dev/topics/auth/#other-authentication-sources)

并编写一个自定义后端：

```
class MyBackend(object):
    def authenticate(self, username=None, password=None):
        # Check the fb user is logged in, create User if needed and return a User by fbid. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:10:41.330

看看广泛使用的[django-facebook](http://pypi.python.org/pypi/django-facebook)应用程序。

# asp.net - 使用 WCF 进行表单身份验证和访问 Authentication_JSON_AppService.axd 时返回错误 302

> ID：13479287
> 
> 赞同：1
> 
> 时间：2012-11-20T18:00:56.310
> 
> 标签：asp.net, .net, wcf

我有一个客户端和应用程序，它们设置为使用 ClientFormAuthenticationMembershipProvider 进行身份验证。在客户端，当应用程序启动时，系统会提示输入用户名和密码。服务器设置为接受这一点，并且 Web 应用程序应该允许该应用程序工作。我们正在建立一个新环境，但服务器端出现了一些问题（如果我们将客户端指向另一台服务器，它可以正常工作）。我们煞费苦心地检查了我们能想到的每一个细节，结果都是一样的：对 ValidateUser() 的调用会引发异常。我已经下载了一个网络嗅探器，在后台我可以看到当我尝试调用 Authentication_JSON_AppService.axd 时正在返回一条 302 消息。在服务器端，

## 客户端配置：

从我们的 FormMain.cs （它试图调用提供者）

```
if (!System.Web.Security.Membership.ValidateUser(null, null))
    System.Windows.Forms.Application.Exit();
else
{
       DoStartUp();
....
} 
```

从我们的 FormLogin.cs（提示输入用户名和密码）注意：类继承 IClientFormsAuthenticationCredentialsProvider

```
 public System.Web.ClientServices.Providers.ClientFormsAuthenticationCredentials GetCredentials()
    {
        if (this.ShowDialog() == DialogResult.OK)
        {
            return new ClientFormsAuthenticationCredentials(
                textEditUsername.Text, textEditPassword.Text,
                false);
        }
        else
        {
            return null;
        }

    } 
```

从 app.config：

```
 <membership defaultProvider="ClientAuthenticationMembershipProvider">
      <providers>
        <clear />
        <add name="ClientAuthenticationMembershipProvider" type="System.Web.ClientServices.Providers.ClientFormsAuthenticationMembershipProvider, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" serviceUri="http://SERVERNAME/APPNAME/Authentication_JSON_AppService.axd" credentialsProvider="APPNAME.Windows.FormLogin, APPNAME.Windows" savePasswordHashLocally="False" />
      </providers>
    </membership> 
```

## 在服务器端：

已为此应用程序配置 IIS 以进行匿名身份验证和表单身份验证。（我们正在运行 IIS 7.5、.NET 4.0、Windows Server 2008 R2）。我们在服务器上安装了 WCF 激活和 HTTP 激活功能。ApplicationPool 设置为 v4.0 Framework，未启用 32 位应用程序，Integrated PipelineMode，大多数其他值设置为默认值。

web.config 文件：

```
 <system.web.extensions>
    <scripting>
      <webServices>
         <authenticationService enabled="true" />
         <roleService enabled="true" />
       </webServices>
     </scripting>
   </system.web.extensions>
     <authentication mode="Forms">
       <forms name=".MDPSApp" loginUrl="~/Connect/Login.aspx" slidingExpiration="true" timeout="600000">
       </forms>
     </authentication>
     <authorization>
       <deny users="?" />
     </authorization>
     <membership defaultProvider="XYZ">
       <providers>
         <add name="XYZ" type="APPNAME.Web.Providers.MembershipProvider, APPNAME.Web" />
       </providers>
     </membership>
 <system.serviceModel>
     <bindings>
       <wsHttpBinding>
         <binding name="DisableAutoCookieManagement" maxReceivedMessageSize="2147483647" allowCookies="false">
           <readerQuotas maxDepth="64" maxStringContentLength="2147483647" maxArrayLength="2147483647" maxBytesPerRead="4096" maxNameTableCharCount="16384" />
           <security mode="None" />
         </binding>
       </wsHttpBinding>
     <behaviors>
 <serviceBehaviors>
         <behavior name="APPNAME.Application.Web.Services.AgenceMaster.ServiceAgenceMasterBehavior">
           <serviceMetadata httpGetEnabled="true" />
           <serviceDebug includeExceptionDetailInFaults="true" />
           <serviceAuthorization principalPermissionMode="None">
           </serviceAuthorization>
         </behavior>
         <behavior name="APPNAME.Application.Web.Services.Agence.ServiceAgenceBehavior">
           <serviceMetadata httpGetEnabled="true" />
           <serviceDebug includeExceptionDetailInFaults="true" />
         </behavior>
       </serviceBehaviors>
     </behaviors>
 <services>
       <service behaviorConfiguration="APPNAME.Application.Web.Services.AgenceMaster.ServiceAgenceMasterBehavior" name="APPNAME.Application.Web.Services.AgenceMaster.ServiceAgenceMaster">
         <endpoint address="" binding="wsHttpBinding" bindingConfiguration="DisableAutoCookieManagement" contract="APPNAME.Services.AgenceMaster.IServiceAgenceMaster">
           <identity>
             <dns value="localhost" />
           </identity>
         </endpoint>
         <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
       </service>
       <service behaviorConfiguration="APPNAME.Application.Web.Services.Agence.ServiceAgenceBehavior" name="APPNAME.Application.Web.Services.Agence.ServiceAgence">
         <endpoint address="" binding="wsHttpBinding" bindingConfiguration="DisableAutoCookieManagement" contract="APPNAME.Services.Agence.IServiceAgence">
           <identity>
             <dns value="localhost" />
           </identity>
         </endpoint>
         <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
       </service>
     </services>
     <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
   </system.serviceModel> 
```

APPNAME.Web.Providers.MembershipProvider 类扩展 System.Web.Security.MembershipProvider 并使用自定义代码覆盖 ValidateUser(string username, string password)。这个类在场景中没有被实例化或调用。

服务器端没有正确配置某些东西，否则服务器会知道如何正确解析 Authentication_JSON_AppService.axd 调用（在我看来不是这样）。任何想法或帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T20:11:09.540

这让我发疯了。在 FireFox 中——如果我输入了调用 WCF REST 调用的 *.aspx 页面的 URL——一切正常。如果我然后执行 shift-reload - 我会得到一个 302，它将我重定向到一个不存在的表单登录页面。

在 Safari 和 Chrome 中 - 无需重新加载。第一次加载时 302 会失败。

[我在 ASP.NET 博客上](http://blog.alexonasp.net/post/2011/08/23/Basic-Authentication-with-WCF-Web-API-hosted-in-IIS-Getting-a-404-Disable-Forms-Authentication-Redirection.aspx)的 Alex 中找到了基本答案

简短回答：更改 web.config 以删除表单身份验证：

```
<modules runAllManagedModulesForAllRequests="true">
  <remove name="FormsAuthentication" />
</modules> 
```

# java - 在 SQLCipher 中设置密码

> ID：13479288
> 
> 赞同：5
> 
> 时间：2012-11-20T18:01:03.393
> 
> 标签：java, sql, database, sqlite, sqlcipher

我想用 SQLCipher 创建一个新的加密数据库，由于以下链接，我真的不明白如何设置密钥：http: [//sqlcipher.net/sqlcipher-api/#key](http://sqlcipher.net/sqlcipher-api/#key)

正如文档所解释的，我必须使用 PRAGMA 设置一个键，但是我从哪里执行该命令？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T13:46:19.063

对于 Android，您只需要调用 openOrCreateDatabase 来提供加密密钥。第二个参数是要使用的密码。

```
SQLiteDatabase database = SQLiteDatabase.openOrCreateDatabase(databaseFile, "test123", null); 
```

使用 SQLCipher 的命令行版本时，“PRAGMA key”接口提供相同的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:19:21.793

您应该阅读以下内容：sqlcipher.net/introduction 构建说明应该为您提供一个实用程序，该实用程序将是 SQLCipher 的命令行 shell（基于 sqlLite）。

# objective-c - UIWebView 中的 YouTube 只播放一次

> ID：13479292
> 
> 赞同：1
> 
> 时间：2012-11-20T18:01:14.017
> 
> 标签：objective-c, ios, uiwebview, youtube

我有一个 UIWebView，其中包含一些通过 iframe 代码嵌入的 YouTube 视频：

```
<iframe width="190" height="102" src="http://www.youtube.com/embed/...?showinfo=0" frameborder="0" allowfullscreen></iframe> 
```

首次加载时，每个视频只能观看一次。查看后，该区域是黑色的，里面有白色的“Youtube”。

有任何想法吗？当然在观看视频后重新加载 UIWebView 可以修复它，但我不喜欢这样......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T21:43:43.780

我做到了！以下 Javascript 完成了这项工作：

```
<script>
 VideoIDs = new Array(...some ids here...);

 function getFrameID(id){
  var elem = document.getElementById(id);
  if (elem) {
   if(/^iframe$/i.test(elem.tagName))
    return id;
   var elems = elem.getElementsByTagName("iframe");
   if (!elems.length)
    return null;
   for (var i=0; i<elems.length; i++) {
    if (/^https?:\/\/(?:www\.)?youtube(?:-nocookie)?\.com(\/|$)/i.test(elems[i].src))
     break;
   }
   elem = elems[i];
   if (elem.id)
    return elem.id;
   do {
    id += "-frame";
   } while (document.getElementById(id));
   elem.id = id;
   return id;
  }
  return null;
 }

 var YT_ready = (function(){
  var onReady_funcs = [], api_isReady = false;
  return function(func, b_before){
   if (func === true) {
    api_isReady = true;
    for (var i=0; i<onReady_funcs.length; i++){
     onReady_funcs.shift()();
    }
   } else if(typeof func == "function") {
    if (api_isReady)
     func();
    else
     onReady_funcs[b_before?"unshift":"push"](func);
   }
  }
 })();

 function onYouTubePlayerAPIReady() {
  YT_ready(true)
 }

 (function(){
  var s = document.createElement("script");
  s.src = "http://www.youtube.com/player_api";
  var before = document.getElementsByTagName("script")[0];
  before.parentNode.insertBefore(s, before);
 })();

 var players = new Array();
 YT_ready(function() {
  for(index in VideoIDs) {
   var frameID = getFrameID(VideoIDs[index]);
   if (frameID) {
    players[frameID] = new YT.Player(frameID, {
     events: {
      "onStateChange": stateChange
     }
    });
   }
  }
 });

 function youtube_parser(url){
  var regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/;
  var match = url.match(regExp);
  if (match&&match[7].length==11){
   return match[7];
  }
 }

 function stateChange(event) {
  if(event.data == YT.PlayerState.ENDED){
   document.location = 'callback:finished';
   document.getElementById(youtube_parser(event.target.getVideoUrl())).contentWindow.location.reload(true);
  }
 }
 </script> 
```

# .net - 为什么我的 .csproj 文件在 git rebase 后变得混乱？

> ID：13479294
> 
> 赞同：15
> 
> 时间：2012-11-20T18:01:26.903
> 
> 标签：.net, git, git-rebase, csproj

在一个使用 GIT 进行源代码控制的 .NET C# 项目中，我在重新定位以获取最近提交的代码后，不断收到格式错误的 csproj 文件。这是我的过程：

1.  提交我的代码
2.  构建和运行测试
3.  变基以“获取最新”
4.  诅咒天堂，因为 csproj 文件被搞砸了......再次

这是变基的输出：

```
D:\GitHub\AwesomeProject>git rebase master
First, rewinding head to replay your work on top of it...
Applying: added getstatus call
Using index info to reconstruct a base tree...
M       Host/Host.csproj
M       Host/packages.config
M       Trees/Trees.csproj
M       Trees/packages.config
M       UnitTests/UnitTests.csproj
<stdin>:1229: trailing whitespace.
  <!-- To modify your build process, add your task inside one of the targets bel
ow and uncomment it.
warning: 1 line adds whitespace errors.
Falling back to patching base and 3-way merge...
Auto-merging UnitTests/UnitTests.csproj
Auto-merging Trees/packages.config
CONFLICT (content): Merge conflict in Trees/packages.config
Auto-merging Trees/Trees.csproj
Auto-merging Host/packages.config
CONFLICT (content): Merge conflict in Host/packages.config
Auto-merging Host/Host.csproj
Failed to merge in the changes.
Patch failed at 0001 added getstatus call

When you have resolved this problem run "git rebase --continue".
If you would prefer to skip this patch, instead run "git rebase --skip".
To check out the original branch and stop rebasing run "git rebase --abort". 
```

存在冲突，但正如您所见，它自动合并了 csproj 文件，但它做错了！！csprojfile 的 XML 无效，项目未加载。这是它的外观的精简版：

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  ... most of one version the project file
  <Import Project="$(SolutionDir)\.nuget\nuget.targets" />
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  ... most of the other version the project file
  <Import Project="$(SolutionDir)\.nuget\nuget.targets" />
</Project> 
```

为什么会这样？以及如何改进我的流程来处理它？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-20T22:52:35.050

You may want to use a .gitattributes file to use a slightly different merge driver. I have found that this has helped with mine:

```
*.csproj -text merge=union
*.sln -text merge=union 
```

You can read more about it [here](http://www.kernel.org/pub/software/scm/git/docs/gitattributes.html) to see if there are options you like better.

You can also tell git to take a little longer thinking about its merges with the `patience` option like this: ([read more here](http://www.kernel.org/pub/software/scm/git/docs/git-rebase.html#_merge_strategies))

```
git rebase -s recursive -X patience 
```

The only other thing that I can think of is to make sure that you pull code often so that the merges git has to do are smaller.

FYI, if you want you can do a `rebase` on the same line at the same time that you do a pull like this: (and you can still pass in the `recursive` and `patience` options the same)

```
git pull --rebase origin master 
```

# python - Python 使用 basicConfig 方法登录到控制台和文件

> ID：13479295
> 
> 赞同：87
> 
> 时间：2012-11-20T18:01:40.007
> 
> 标签：python, file, logging, console, screen

我不知道为什么这段代码会打印到屏幕上，而不是文件上？文件“example1.log”已创建，但没有写入任何内容。

```
#!/usr/bin/env python3
import logging

logging.basicConfig(level=logging.DEBUG,
                    format='%(asctime)s %(message)s',
                    handlers=[logging.FileHandler("example1.log"),
                              logging.StreamHandler()])
logging.debug('This message should go to the log file and to the console')
logging.info('So should this')
logging.warning('And this, too') 
```

我通过创建一个日志对象“绕过”了这个问题，但它一直困扰着我为什么`basicConfig()`方法失败了？

PS。如果我将 basicConfig 调用更改为：

```
logging.basicConfig(level=logging.DEBUG,
                    filename="example2.log",
                    format='%(asctime)s %(message)s',
                    handlers=[logging.StreamHandler()]) 
```

然后所有日志都在文件中，控制台中不显示任何内容。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2014-05-15T14:43:49.190

试试这个工作正常（在python 2.7中测试）**控制台和文件**

```
# set up logging to file
logging.basicConfig(
     filename='log_file_name.log',
     level=logging.INFO, 
     format= '[%(asctime)s] {%(pathname)s:%(lineno)d} %(levelname)s - %(message)s',
     datefmt='%H:%M:%S'
 )

# set up logging to console
console = logging.StreamHandler()
console.setLevel(logging.DEBUG)
# set a format which is simpler for console use
formatter = logging.Formatter('%(name)-12s: %(levelname)-8s %(message)s')
console.setFormatter(formatter)
# add the handler to the root logger
logging.getLogger('').addHandler(console)

logger = logging.getLogger(__name__) 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-11-20T18:14:05.630

我无法在 Python 3.3 上重现它。消息同时写入屏幕和`'example2.log'`. 在 Python <3.3 上，它会创建文件，但它是空的。

编码：

```
from logging_tree import printout  # pip install logging_tree
printout() 
```

显示`FileHandler()`未附加到 Python <3.3 上的根记录器。

文档[`logging.basicConfig()`](http://docs.python.org/dev/library/logging.html#logging.basicConfig)说该`handlers`参数是在 Python 3.3 中添加的。`handlers`Python 3.2 文档中没有提到该参数。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-07-27T12:37:36.400

在下面的示例中，您可以根据其级别指定日志目标。例如，下面的代码让**INFO**级别以上的所有日志都进入日志文件，而**ERROR**级别以上的所有日志都进入控制台。

```
import logging
logging.root.handlers = []
logging.basicConfig(format='%(asctime)s : %(levelname)s : %(message)s', level=logging.INFO , filename='ex.log')

# set up logging to console
console = logging.StreamHandler()
console.setLevel(logging.ERROR)
# set a format which is simpler for console use
formatter = logging.Formatter('%(asctime)s : %(levelname)s : %(message)s')
console.setFormatter(formatter)
logging.getLogger("").addHandler(console)

logging.debug('debug')
logging.info('info')
logging.warning('warning')
logging.error('error')
logging.exception('exp') 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2019-11-13T00:05:41.613

使用的另一种技术`basicConfig`是在语句中设置所有处理程序并在事后检索它们，如...

```
import logging

logging.basicConfig(level=logging.DEBUG,
                    format='%(asctime)s %(levelname)s %(module)s %(funcName)s %(message)s',
                    handlers=[logging.FileHandler("my_log.log", mode='w'),
                              logging.StreamHandler()])
stream_handler = [h for h in logging.root.handlers if isinstance(h , logging.StreamHandler)][0]
stream_handler.setLevel(logging.INFO) 
```

更明智的做法是在外部构造流处理程序实例并将它们配置为独立对象，然后将它们传递给处理程序列表，如...

```
import logging

stream_handler = logging.StreamHandler()
stream_handler.setLevel(logging.INFO)

logging.basicConfig(level=logging.DEBUG,
                    format='%(asctime)s %(levelname)s %(module)s %(funcName)s %(message)s',
                    handlers=[logging.FileHandler("my_log.log", mode='w'),
                              stream_handler]) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-10-24T11:22:16.657

***哇！***

我只花了大约 20 分钟的时间对此感到困惑。

最终我发现`StreamHandler`正在输出到`stderr`，而不是`stdout`（在“打盹 DOS 屏幕中，它们具有相同的字体颜色！）。

这导致我能够完美地运行代码并获得合理的结果，但是在 pytest 函数中事情出错了。直到我改变了这个：

```
out, _ = capsys.readouterr()
assert 'test message check on console' in out, f'out was |{out}|' 
```

对此：

```
_, err = capsys.readouterr()
assert 'test message check on console' in err, f'err was |{err}|' 
```

注意 StreamHandler 的构造函数是

```
class logging.StreamHandler(stream=None) 
```

并且，正如[文档](https://docs.python.org/3/library/logging.handlers.html#logging.StreamHandler)所说，“如果指定了流，则实例将使用它来记录输出；否则，将使用 sys.stderr。”

注意似乎提供`level`关键字不会`setLevel`在处理程序上运行：如果对您很重要，您需要迭代生成的处理程序并`setLevel`在每个处理程序上运行。

# vim - 在 VIM 中转换和恢复尾注 {author , #XXX} 引用？

> ID：13479297
> 
> 赞同：2
> 
> 时间：2012-11-20T18:01:43.907
> 
> 标签：vim, plugins

我在转换具有以下内容的文档时遇到问题：

> 这位作者 {john, #99} 说 ... ... bla bla 另一个作者提到 {barlic, #1508} ...

我希望 vim 将其转换为：

> 这个作者 \cite{latexref99} 说... ... bla bla 这个其他作者提到 \cite{latexref1508} ...

知道该怎么做吗？还有如何恢复到：

> > 这位作者 {,#99} 说 ... ... bla bla 这个其他作者提到 {, #1508} ..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:11:32.460

转换成：

```
:%s/{[^#]*#\(\d\+\)}/\\cite{latexref\1}/g 
```

转换回来：

```
:%s/\\cite{latexref\(\d\+\)}/{,#\1}/g 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:28:45.140

您不需要可以使用 sed 的插件：

```
sed -e 's/{[^}]*\#\([0-9]*\)}/\\cite\{latexref\1\}/g' < file.tex >new_ref.tex 
```

您也可以将其映射到 vim 中的快捷方式

```
nmap n :%w ! cat % \| sed -e 's/{[^}]*\#\([0-9]*\)}/\\cite\{latexref\1\}/g' > % <CR> 
```

# excel - 具有多个条件的水平查找

> ID：13479299
> 
> 赞同：2
> 
> 时间：2012-11-20T18:01:49.843
> 
> 标签：excel, libreoffice, vlookup

我正在尝试在 excel 中开发公式以查找多个标准。具体来说，我如何为位置 (B) 提取纽约市苹果的价值？

```
 Northeast                                        NYC            
     (A)     (B)         (C)     (D)         (A)     (B)    (C)      (D)

Grapes   3,000   2,073   751     2,000       4,253   3,500   1,832   2,500 
Apples   400     3,076   2,298   900         27,250  19,000  14,250  9,000 
Oranges  6.0     3.1     3.9     5.0         28.4    20.0    13.8    10.0 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T15:04:00.427

我已经得到以下公式来处理您的数据，但有一个小问题，您需要填写标题列（东北/纽约）以允许匹配工作

```
=VLOOKUP(A9,A1:I5,MATCH((B9&C9),(A1:I1&A2:I2),0),FALSE) 
```

**注意：因为公式使用的是数组函数，所以您需要使用 Crl-Shift-Enter 命令执行它:)

这是一个屏幕截图，可让您破译参考文献:)

![床单](../Images/618f019d8a8face4d3cfd33205c36509.png)

我希望这是有帮助的

# asp.net - IIS 7.5 / Windows 7 家庭高级版中的 RavenDB 错误

> ID：13479300
> 
> 赞同：2
> 
> 时间：2012-11-20T18:01:55.733
> 
> 标签：asp.net, .net, windows, iis, ravendb

我无法让 RavenDB 在我的本地 IIS 副本中运行，而且我似乎找不到任何有关它的信息。我在文件夹和文件上设置了适当的权限，并按照设置说明调整了应用程序池，但它似乎仍然不起作用。我得到的唯一（无用）错误是：

```
Could not authenticate against the server

Message: [HttpWebRequest_WebException_RemoteServer]
Arguments: NotFound
Debugging resource strings are unavailable. Often the key and arguments provide sufficient information to diagnose the problem. See http://go.microsoft.com/fwlink/?linkid=106663&Version=5.1.10411.0&File=System.Windows.dll&Key=HttpWebRequest_WebException_RemoteServer
Uri: /databases?database=Default
Server Uri: http://localhost:82/docs/Raven/Databases/Kiosk

-- Error Information --
System.Net.WebException: [HttpWebRequest_WebException_RemoteServer]
Arguments: NotFound
Debugging resource strings are unavailable. Often the key and arguments provide sufficient information to diagnose the problem. See http://go.microsoft.com/fwlink/?linkid=106663&Version=5.1.10411.0&File=System.Windows.dll&Key=HttpWebRequest_WebException_RemoteServer
   at System.Net.Browser.ClientHttpWebRequest.EndGetResponse(IAsyncResult asyncResult)
   at System.Func`2.Invoke(T arg)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise)

Inner StackTrace: 
   at Raven.Studio.Infrastructure.InvocationExtensions.Catch(Task parent, Action`1 action)
   at Raven.Studio.Infrastructure.InvocationExtensions.Catch(Task parent)
   at Raven.Studio.Commands.CreateDatabaseCommand.<>c__DisplayClass3.<Execute>b__0(Task`1 task)
   at System.Threading.Tasks.ContinuationTaskFromResultTask`1.InnerInvoke()
   at System.Threading.Tasks.Task.Execute()
   at System.Threading.Tasks.Task.ExecutionContextCallback(Object obj)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
   at System.Threading.Tasks.Task.ExecuteEntry(Boolean bPreventDoubleExecution)
   at System.Threading.Tasks.Task.System.Threading.IThreadPoolWorkItem.ExecuteWorkItem()
   at System.Threading.ThreadPoolWorkQueue.Dispatch()
   at System.Threading._ThreadPoolWaitCallback.PerformWaitCallback() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:36:04.713

这通常表明您没有在 IIS 中安装/启用 Windows Auth

# iphone - 将视图从普通视图切换到 TabBarController 中的选定选项卡

> ID：13479301
> 
> 赞同：1
> 
> 时间：2012-11-20T18:01:59.800
> 
> 标签：iphone, objective-c, ios, cocoa-touch, uitabbarcontroller

我正在开发一个应用程序，它有一个带有图标的主屏幕（如图 1 所示），当触摸任何这些图标时，视图将变为 TabBar 视图。

我正在努力的是切换到 TabBar 视图中与主屏幕中的图标匹配的特定选项卡（图 1 和图 2 将更有希望地解释）

![在此处输入图像描述](../Images/2631313faa1f31ede177d58a3bcc59cd.png)

![在此处输入图像描述](../Images/813e956826790431138bebc7dded45c1.png)

正如您从图像中看到的那样，当我按下标题为“ *item 3* ”的图标时，我想查看以更改为索引 2 处的 TabBar 视图，这是第三个选项卡

到目前为止，我所做的是为 item 3 按钮创建了一个操作方法，并在其中编写了以下代码：

```
TB_ViewController *vc = [self.storyboardinstantiateViewControllerWithIdentifier:@"HomeView"];
[self presentViewController:vc animated:YES completion:NULL];
[self.tabBarController setSelectedIndex:2]; 
```

我知道这是不正确的，但这就是我得出的全部结论，我希望你们能一如既往地帮助我。

# c# - 遍历 DirectoryInfo.EnumerateFiles 会引发异常吗？

> ID：13479304
> 
> 赞同：1
> 
> 时间：2012-11-20T18:02:15.147
> 
> 标签：c#, exception, io

调用`DirectoryInfo.EnumerateFiles`可能会引发异常，例如`DirectoryNotFoundException`. 这只能在我获取`IEnumerable`对象时发生，或者在迭代文件时（即`foreach`调用时`IEnumerator<FileInfo>.MoveNext`）发生吗？

换句话说，下面的代码安全吗？

```
 IEnumerable<FileInfo> fileInfos;
 try
 {
     fileInfos = directoryInfo.EnumerateFiles();
 }
 catch // snip
 {
    // snip
 }

 foreach (FileInfo fileInfo in fileInfos)
 {
     // Do something
 } 
```

或者我是否也需要将 foreach 部分放入 try 块中（如果我想要`yield return`一些东西，这会变得非常讨厌，这在 try 块中是不允许的）？

假设枚举器没有抛出异常，那么在迭代文件时删除目录时会发生什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:20:32.587

不幸的是，这个 API 可以在`EnumerateFiles`/`EnumerateDirectories`调用**和**调用上都抛出异常`MoveNext`。无论哪种情况，一旦抛出异常，您就不能继续使用该枚举器。

不只是`DirectoryNotFoundException`；它也可以抛出`UnauthorizedAccessException`,`PathTooLongException`和其他的。

这已[报告给 Microsoft](http://connect.microsoft.com/VisualStudio/feedback/details/512171/directory-enumeratedirectory-etc-unusable-due-to-frequent-unauthorizedaccessexceptions-even-runas-administrator)，但没有关于修复的消息。与此同时，[CodePlex 上有替代 API](http://rwtools.codeplex.com/)，或者[StackOverflow 上有不同的方法](https://stackoverflow.com/questions/5098011/directory-enumeratefiles-unauthorizedaccessexception)。

# iphone - 如何开始在中间视图中显示启用分页的 UIScrollView？

> ID：13479307
> 
> 赞同：0
> 
> 时间：2012-11-20T18:02:25.003
> 
> 标签：iphone, ios, uiwebview, uiscrollview, scroll-paging

我有一个简单的问题，但我无法弄清楚。我有一个带有三个嵌套 UIWebViews 的 UIScrollView。我需要能够“回收”这些视图以实际滚动浏览大量内容。

我的主要问题是我无法弄清楚如何显示不是第一个视图，这意味着您可以立即从那里滑回来。现在我有三个视图分页，但它从第一个开始，你可以向右移动两个。

我该怎么做才能让我始终处于中间位置？能够始终向右或向左滑动？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:23:02.500

在viewController的`viewDidLoad`or方法中，尝试添加以下代码：`viewWillAppear`

```
[self.myMainScrollView setContentOffset:CGPointMake(0,self.view.frame.size.width) animated:NO]; 
```

这将滚动您较大的滚动视图，以便中间`UIWebView`可见。

如果这没有帮助，请在[UIScrollView](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIScrollView_Class/Reference/UIScrollView.html)和[UIScrollViewDelegate](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIScrollViewDelegate_Protocol/Reference/UIScrollViewDelegate.html#//apple_ref/occ/intf/UIScrollViewDelegate)文档中进行挖掘——你应该在那里找到一些好东西。

# c# - 每秒重新计算 50 个对象的“状态”

> ID：13479308
> 
> 赞同：1
> 
> 时间：2012-11-20T18:02:26.340
> 
> 标签：c#

我想每秒重新计算某个对象的“StrategyState”。我不想为此创建一个计时器，因为同时，我可以从另一个线程访问“StrategyState”属性（另外，对于我的简单问题来说，计时器可能太重了）。我以这种方式自己定义了 StrategyState 类型：

```
public enum StrategyState
{
    OnlyKill,
    Working,
    ClosingStage1,
    ClosingStage2,
    Closed
} 
```

我不确定从一个线程写入这样的对象并从另一个线程读取是否是“线程安全的”。

所以我想“延迟更新”我的`StrategyState State`领域，就像这样：

```
....
if ( /* State was not updated for one second or more. */ ) {
    RecalculateState()
}
switch (State) {
    .... // Work 
```

如何在不增加太多延迟的情况下测试状态未更新一秒或更长时间？

我显然可以创建秒表，但请注意，我需要为不同线程中的不同对象完全更新大约 50 个状态。我不确定是否应该在系统中添加 50 个秒表。可能，最好添加一个 Stopwatch 并共享它，因为我猜 Stopwatch 类可能是线程安全的。

你有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:09:42.507

只需添加`DateTime`最后一次评估时间：

```
private DateTime m_lastStateEvaluation = DateTime.MinValue; 
```

接着

```
if ((DateTime.Now - m_lastStateEvaluation).TotalSeconds >= 1))
{ 
    // Evaluate state
    m_lastStateEvaluation = DateTime.Now;
} 
```

这根本不会给操作增加太多时间。

顺便说一句，`lock`如果您使用计时器，则使用语句将解决任何线程问题。如果你愿意，你可以让一个计时器处理所有 50 个对象。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-20T20:22:06.393

我已经这样实现了：

```
private long recalculateStateTimestamp;
private const long oneSecond = 10000000;

.....
long newTime = DateTime.Now.Ticks;
if (newTime - recalculateStateTimestamp < oneSecond)
{
    return;
}
recalculateStateTimestamp = newTime; 
```

我认为这是实现它的最快方法之一。此外，它部分是线程安全的（对我来说足够了）。

# jquery - jQuery 脚本加载队列

> ID：13479316
> 
> 赞同：0
> 
> 时间：2012-11-20T18:03:04.193
> 
> 标签：jquery, scripting, loading, external

所以这个问题是我最近问的另一个问题的一个分支，这更像是一个好奇心。

我的另一个问题涉及在外部 js 库中动态加载。在我的示例中，我使用 .getScript() 导入了 jQuery 模板，然后是 Knockout.js。每次完成加载后，我都会发出警报，以确保它们正确加载。

这是我使用的大致代码（似乎在 jsFiddle 上“按顺序”工作，所以它以前可能是我的代码。但问题仍然存在。）：

```
$.getScript("https://raw.github.com/jquery/jquery-tmpl/master/jquery.tmpl.js", function(){ alert('tmpl finished loading!'); });
$.getScript("http://cloud.github.com/downloads/SteveSanderson/knockout/knockout-2.2.0.js", function(){ alert('Knockout finished loading!'); }); 
```

当我加载页面时，我发现 Knockout 的警报在 tmpl 库之前触发，即使它列在第二位。

我的假设是它们会以队列方式同步加载，等待前一个完成后再加载下一个。看来情况并非如此。

**所以我要求验证这个假设，并解释为什么会/不是这样。我还想知道是否有另一种[更好的]方法来排队脚本加载，这样我就不会因为依赖未加载的脚本而遇到未定义的问题。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:20:22.613

您的测试显然与您的假设相矛盾。没有队列，它们每个都同时运行。哪个先完成取决于文件大小、网络时间等。

如果要确保一个接一个地加载，请将加载第二个库的调用放在第一个库的回调函数中：

```
$.getScript("https://raw.github.com/jquery/jquery-tmpl/master/jquery.tmpl.js", function(){
    alert('tmpl finished loading!');
    $.getScript("http://cloud.github.com/downloads/SteveSanderson/knockout/knockout-2.2.0.js", function(){ 
        alert('Knockout finished loading!');
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-18T15:37:38.477

You could but all your libraries in a single js file in the order you would want to load them. This reduces the number of requests that need to be made as an added bonus!

# image - 自动编号图片

> ID：13479320
> 
> 赞同：1
> 
> 时间：2012-11-20T18:03:10.790
> 
> 标签：image, autonumber

我有一个有很多图片的娱乐博客。有人可以帮我编写一个自动编号帖子中图片的代码吗？（例如：www.chive.com、www.acidcow.com）

这是我的图片CSS，如果它对任何事情都有帮助......

```
 .post-body img, .post-body .tr-caption-container, .Profile img, .Image img,

 .BlogList .item-thumbnail img {
 padding: $(image.border.small.size);

 background: $(image.background.color);
 border: 0px solid $(image.border.color);

-webkit-border-radius: 18px;
-moz-border-radius: 18px;
border-radius: 18px; 

-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .5);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .5);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .5);} 
```

# vb.net - 如何从 vb.net 中的另一个类中引用一个类变量

> ID：13479321
> 
> 赞同：2
> 
> 时间：2012-11-20T18:03:11.433
> 
> 标签：vb.net, byref

我有以下内容（简化以使其易于阅读）

头等舱：

```
Class MainWindow
     Private mFile As myFile 'myFile is a class containing a bunch of stuff

     Sub go()
          dim editFiles as New EditFiles(mFile)
     End Sub
End Class 
```

二等：

```
Public Class EditFiles
    Private mFile As myFile 'myFile is a class containing a bunch of stuff
Sub New(ByRef passedFile As myFile)

    ' This call is required by the designer.
    InitializeComponent()

    ' Add any initialization after the InitializeComponent() call.

    mFile = passedFile

End Sub 
```

我想要发生的是我在第二类中对 mFile 所做的任何更改，以在第一类中也更改 mFile，我认为通过在初始化中传递它 ByRef 会发生但显然不会。

我想知道的是使这项工作的适当方法是什么？我知道我可以创建一个全局变量，但必须有一种方法可以从第一类传递 mFile 的指针，以便第二类中的 mFile 基本相同。

如果您可以通过编辑上面的代码向我展示一个简单的示例，我将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T19:01:44.917

您应该在第二类中创建第一类的对象。您还需要一种方法来更改第一类中 mFile 的值。它应该类似于以下内容。

```
Class MainWindow
     Private  mFile As myFile 'myFile is a class containing a bunch of stuff

     Sub go()
          dim editFiles as New EditFiles(mFile)

     End Sub

     sub setMFile(_mfile as myfile)
        me.mfile = _mfile
End Class 
```

二等舱

```
Public Class EditFiles
    Private mFile As myFile 'myFile is a class containing a bunch of stuff
    Sub New(ByRef passedFile As myFile)

    ' This call is required by the designer.
    InitializeComponent()

    ' Add any initialization after the InitializeComponent() call.

    mFile = passedFile
    dim newObject as new MainWindow
    newobject.setMFile(mFile)
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T19:30:55.037

您需要确保在将 MainWindow 的 mFile 变量传递给 EditFiles 对象**之前对其进行初始化。**

此外，如果 myFile 是一个类，您甚至不需要通过 ByRef 传递它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T13:32:49.280

这是我最终解决问题的方法：

```
 Class MainWindow
 Private  mFile As myFile 'myFile is a class containing a bunch of stuff

 Sub go()
      dim editFiles as New EditFiles(me, mFile)
 End Sub

 sub setMFile(_mfile as myfile)
    me.mfile = _mfile
 End Class 
```

二等舱

```
Public Class EditFiles
Private mainWindow As mainWindow
Private mFile as myFile
Sub New(ByVal sourceWindow As mainWindow, byVal sourceFile as myFile)

     ' This call is required by the designer.
    InitializeComponent()

    ' Add any initialization after the InitializeComponent() call.
    mainWindow = sourceWindow
    mFile = sourceFile

end Sub
Sub setFile
    mainWindow.setMFile(mFile)
End Sub 
```

# android - 如何在 Android Dropbox sdk 1.5.1 中验证多个帐户？

> ID：13479324
> 
> 赞同：9
> 
> 时间：2012-11-20T18:03:22.333
> 
> 标签：android, dropbox, dropbox-api

我需要验证多个帐户

搜了一下论坛，好像可以，所以试了一下，失败了

我曾尝试使用相同的 API APP_KEY 和 APP_SECRET，但失败了我的两个会话都返回相同的访问令牌对

所以我尝试在同一个Dropbox帐户下使用不同的API APP_KEY & APP_SECRET，它也失败了

所以我再次尝试使用来自不同 Dropbox 帐户的不同 API APP_KEY 和 APP_SECRET，它仍然失败

任何人都可以为我提供解决方案吗？提前致谢

下面是我的代码，主要来自DBroulette的例子

onCreate (安卓)

```
AndroidAuthSession session = buildSession();
mApi = new DropboxAPI<AndroidAuthSession>(session);
AndroidAuthSession session2 = buildSession2();
mApi2 = new DropboxAPI<AndroidAuthSession>(session2); 
```

onResume (安卓)

```
AndroidAuthSession session = mApi.getSession();
if (session.isLinked()) {
dbsetLoggedIn(true);
} else {
dbsetLoggedIn(false);
}
if (session.authenticationSuccessful()) {
try {
session.finishAuthentication();
TokenPair tokens = session.getAccessTokenPair();
dbstoreKeys(tokens.key, tokens.secret);
dbsetLoggedIn(true);
statusTv.append("Dropbox authentication successful\n");
} catch (IllegalStateException e) {
Log.i("Dropbox Error", "Error authenticating", e);
}
}

AndroidAuthSession session2 = mApi2.getSession();
if (session2.isLinked()) {
dbsetLoggedIn2(true);
} else {
dbsetLoggedIn2(false);
}
if (session2.authenticationSuccessful()) {
try {
session2.finishAuthentication();
TokenPair tokens = session2.getAccessTokenPair();
dbstoreKeys2(tokens.key, tokens.secret);
dbsetLoggedIn2(true);
statusTv.append("2Dropbox authentication successful\n");
} catch (IllegalStateException e) {
Log.i("Dropbox Error", "Error authenticating", e);
}
} 
```

其他代码

```
private AndroidAuthSession buildSession() {
AppKeyPair appKeyPair = new AppKeyPair(Constants.APP_KEY, Constants.APP_SECRET);
AndroidAuthSession session;
String[] stored = getKeys();
if (stored != null) {
AccessTokenPair accessToken = new AccessTokenPair(stored[0], stored[1]);
session = new AndroidAuthSession(appKeyPair, Constants.ACCESS_TYPE, accessToken);
} else {
session = new AndroidAuthSession(appKeyPair, Constants.ACCESS_TYPE);
}
return session;
}

private AndroidAuthSession buildSession2() {
AppKeyPair appKeyPair = new AppKeyPair(Constants.APP_KEY2, Constants.APP_SECRET2);
AndroidAuthSession session;
String[] stored = getKeys2();
if (stored != null) {
AccessTokenPair accessToken = new AccessTokenPair(stored[0], stored[1]);
session = new AndroidAuthSession(appKeyPair, Constants.ACCESS_TYPE, accessToken);
} else {
session = new AndroidAuthSession(appKeyPair, Constants.ACCESS_TYPE);
}
return session;
}

private String[] getKeys() {
SharedPreferences prefs = getSharedPreferences(Constants.ACCOUNT_PREFS_NAME, 0);
String key = prefs.getString(Constants.ACCESS_KEY_NAME, null);
String secret = prefs.getString(Constants.ACCESS_SECRET_NAME, null);
if (key != null && secret != null) {
String[] ret = new String[2];
ret[0] = key;
ret[1] = secret;
return ret;
} else {
return null;
}
}

private String[] getKeys2() {
SharedPreferences prefs = getSharedPreferences(Constants.ACCOUNT_PREFS_NAME, 0);
String key = prefs.getString(Constants.ACCESS_KEY_NAME2, null);
String secret = prefs.getString(Constants.ACCESS_SECRET_NAME2, null);
if (key != null && secret != null) {
String[] ret = new String[2];
ret[0] = key;
ret[1] = secret;
return ret;
} else {
return null;
}
} 
```

我注意到我可能需要在添加另一个时在清单中添加一些东西但是我不能在具有不同 APP KEY 的 android 清单中添加第二个活动，因为它会导致重复错误我该怎么做？

```
<activity
android:name="com.dropbox.client2.android.AuthActivity"
android:configChanges="orientation|keyboard"
android:launchMode="singleTask" >
<intent-filter>
<data android:scheme="db-XXXXXXXXXXXX" />

<action android:name="android.intent.action.VIEW" />

<category android:name="android.intent.category.BROWSABLE" />
<category android:name="android.intent.category.DEFAULT" />
</intent-filter>
</activity> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-20T16:57:33.310

我不确定这是否会对您的用例有所帮助，但也许编写自己的身份验证器以使用 Android 内置帐户管理来分离身份验证过程可能是一种解决方法。这是一个例子：[http ://udinic.wordpress.com/2013/04/24/write-your-own-android-authenticator/](http://udinic.wordpress.com/2013/04/24/write-your-own-android-authenticator/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-28T01:32:44.423

我遇到了类似的要求，这就是我的工作方式。

**第**
一个应用程序使用正常的 Dropbox 流程访问您的第一个应用程序。

**注意：** 需要 2 个 Dropbox 应用程序的可能情况是使用不同的 Dropbox 应用程序从您的服务器访问用户帐户。请注意，您可以与您的服务器共享第一个应用程序的访问令牌并安全地重复使用这些凭据，前提是您在服务器上使用相同的 Dropbox 应用程序。如果您无法忍受，请继续阅读。

**第二个应用**
**选项 1：**使用另一个 Android 应用

1.  为第二个保管箱应用程序的 oAuth 流程创建另一个 Android 应用程序。
2.  使用 Intent 从 app1 触发 app2 中的 oAuthflow。
3.  同样，使用意图将令牌数据从 app2 发送回 app1

一些提示，如果你要使用这个：

1.  使 App2 oAuth Activity 的背景透明
2.  删除 app1 <-> app2 转换的 Intent 更改动画
3.  在 App2 Activity 的 onCreate 中触发 oAuth

**选项 2：**如果您只使用一个 Android 应用程序继续执行此操作，我找到了一种可能的解决方法，如下所述。

1.  提示您的用户打开此网址： [https ://www.dropbox.com/1/oauth2/authorize?response_type=code&client_id=APP2_CLIENT_ID](https://www.dropbox.com/1/oauth2/authorize?response_type=code&client_id=APP2_CLIENT_ID)

2.  他们必须复制 Dropbox 返回的授权码

3.  此授权码可用于获取第二个应用的 access_tokens

如果您要在服务器端上下文中使用第二个应用程序，只需与您的服务器共享授权代码。您可以在 python 流程中从授权代码中获取令牌，如下所示：

```
flow = client.DropboxOAuth2FlowNoRedirect(app2_key, app2_secret)
authorize_url = flow.start()
access_token, user_id = flow.finish(auth_code_from_client) 
```

有关从授权密钥获取 access_tokens 的更通用方法，[请查看此](https://www.dropbox.com/developers/blog/45/using-oauth-20-with-the-core-api)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-03T17:54:36.090

Dropbox API 有一些问题，或者你可以说一个你需要使用的技巧来进行多次登录。

**1\. 将 sAuthenticatedUid 声明为 String[]**

`private static final String[] sAuthenticatedUid = { "dummy"}; // Keeping only one Auth Id to keep last authenticated item`

**2\. 使用不同的方法启动 OAuth**

用于`session.startOAuth2Authentication(act, "", sAuthenticatedUid)`身份验证而不是 startOAuth2Authentication()

**3.维护认证成功的变量**

```
sAuthenticatedUid[0] = sessionApi.getSession().finishAuthentication();  // Save the last successful UID
String oauth2AccessToken = sessionApi.getSession().getOAuth2AccessToken();
AuthActivity.result = null;  // Reset this so that we can login again, call only after finishAuthentication() 
```

AuthActivity 是 com.dropbox.client2.android.AuthActivity ，它存储上次身份验证的结果，并且可能会产生问题，因为这是静态变量。

您现在应该可以进行尽可能多的登录。

# sql - 来自 select 语句的用户值并插入数据库

> ID：13479327
> 
> 赞同：1
> 
> 时间：2012-11-20T18:03:31.817
> 
> 标签：sql, sql-server-2005

我正在尝试创建一个将返回 set is 结果的存储过程，然后使用这些结果插入数据库，我知道如何单独执行此操作，但不是作为组合存储过程： ![表格图像](../Images/af07f1ee0e7998a9e2ada1300484dd31.png)

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:09:29.223

尝试这样的事情：

```
INSERT INTO tbl_userlist (assocuser, userID)
SELECT @id, ID
FROM tbl_login
WHERE type = 'user' and assocuser = @userid 
```

对于您的编辑，您似乎想使用[UNPIVOT](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)。

这是一个基本的 UNPIVOT 示例，直接从 MSDN UNPIVOT 示例修改：

```
SELECT ID, AssocUser, UserID
FROM tbl_login
UNPIVOT
   (UserID FOR Col IN 
      (User1, User2)
)AS unpvt; 
```

您应该能够从那里扩展它。

# nsdate - 如何存储 NSDate 加上 7 个日历日？

> ID：13479332
> 
> 赞同：0
> 
> 时间：2012-11-20T18:04:03.533
> 
> 标签：nsdate, nsdateformatter, nsdatecomponents

我需要能够存储当前的 NS 日期加上 7 天。我已经存储了当前的 NSDate。然后我想比较这两个日期，以获取两者之间的天数差异并显示在标签内。这个想法是从 7 天倒计时，到 6 天，到 5 天，等等，直到它显示 0，我将从我的 tableview 中删除它。

我一直很难找到编写代码，所以任何帮助将不胜感激！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T16:21:41.020

此代码将从今天起 7 天后计算日期。

```
NSDateComponents *comps = [NSDateComponents new];
comps.day = 7;

NSDate *today = [NSDate date];

NSCalendar *c = [NSCalendar currentCalendar];
NSDate *dateAfter7days = [c dateByAddingComponents:comps toDate:today options:0]; 
```

对于您的日期差异，代码是：-

```
 // c is calendar object
    NSDateComponents *comps = [c components:NSDayCalendarUnit fromDate:startDate toDate:currentDate options:0];
    int diffrence = [comps day]; 
```

# jquery - 如何在谷歌应用引擎上将帖子从数据库异步加载到 django 模板？

> ID：13479337
> 
> 赞同：0
> 
> 时间：2012-11-20T18:04:10.297
> 
> 标签：jquery, python, django, google-app-engine, django-templates

我有一个网页，正在将数据库中的记录提供给 Google App Engine 中的 Django html 模板。是否可以异步加载帖子，例如当用户在页面上向下滚动 10 个帖子时，它会加载另外 10 个帖子？我应该使用某种 jQuery 在模板中执行此操作，还是异步数据库获取？

```
class MainHandler(webapp2.RequestHandler):
    def get(self):
        records_query = db.GqlQuery("SELECT * FROM Record order by date desc")
        records = records_query.fetch(10)
        self.response.out.write(records_query)
        template_values = {
           'records': records,
        }
        path = os.path.join(os.path.dirname(__file__), 'index.html')
        self.response.out.write(template.render(path, template_values))

class Page(webapp2.RequestHandler):
     def get(self,page):
        numberOfPages = int(page)
        records_query = db.GqlQuery("SELECT * FROM Record order by date desc")
        records = records_query.fetch(numberOfPages * 10)
        records = records[((numberOfPages- 1) * 10):]
        template_values = {
           'records': records,
        }
        path = os.path.join(os.path.dirname(__file__), 'index.html')
        self.response.out.write(template.render(path, template_values)) 
```

在模板中，它只是对从 DB 发送的记录进行的普通循环

```
{% for record in records %}
{{ record.title }} {{ record.body }}
{% endfor %} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T18:50:20.920

这是我的解决方案。现在，当您滚动到底部时，它会异步加载。它基于[此站点的第二个示例](http://www.jquery4u.com/tutorials/jquery-infinite-scrolling-demos/)

模板.html：

```
<div id="postswrapper">
           <div class="item">content</div>
           <div id="loadmoreajaxloader" style="display:none;"><center><img src="ajax-loader.gif" /></center></div>
    </div>
    <script type="text/javascript">
        var pageCounter = 2;
        $(window).scroll(function()
        {
            if (pageCounter > 0)
            {
                if($(window).scrollTop() == $(document).height() - $(window).height())
                {
                    $('div#loadmoreajaxloader').show();
                    $.ajax({  url: "./page/" + pageCounter , success: function(html)  {
                            if(html)
                            {
                                $("#postswrapper").append(html);
                                $('div#loadmoreajaxloader').hide();
                                pageCounter++;
                            }else
                            {
                                pageCounter = -1;
                                $('div#loadmoreajaxloader').html('<center>No more posts to show.</center>');
                            }
                        }
                    });
                    pageCounter = -1;
                }
            }
        });
    </script> 
```

这是 main,py 中从数据库加载帖子的方法。

```
class Page(webapp2.RequestHandler):
    def get(self,page):
        numberOfPages = int(page)
        records_query = db.GqlQuery("SELECT * FROM Record order by date desc")
        records = records_query.fetch(numberOfPages * 10)
        records = records[((numberOfPages- 1) * 10):]
        if len(records) > 0:
            template_values = {
             'records': records,
            }
            path = os.path.join(os.path.dirname(__file__), 'posts.html')
            self.response.out.write(template.render(path, template_values)) 
```

这是加载到主模板中的模板。帖子.html

```
<!DOCTYPE html>
<html>
<head>
    <title></title>
</head>
<body>
{% for record in records %}
<div class="oneRecord">
    <img src="{{ record.imageCacheURL }}" />
    <a href ="./{{ record.imageID }}"> {{ record.title|escape }}</a>
</div>
{% endfor %}
</body>
</html> 
```

# jquery - 当我添加 Dropkick 或 MultiSelect 插件以设置 Select 元素的样式时，更改功能停止工作

> ID：13479342
> 
> 赞同：1
> 
> 时间：2012-11-20T18:04:25.647
> 
> 标签：jquery, onchange, multi-select, jquery-dropkick

当我添加用于设置 Select 或 Multi-Select 元素样式的插件/小部件（Dropkick - [http://jamielottering.github.com/DropKick/](http://jamielottering.github.com/DropKick/)和 jQuery UI MultiSelect Widget [http://www. erichynds.com/jquery/jquery-ui-multiselect-widget/](http://www.erichynds.com/jquery/jquery-ui-multiselect-widget/) ) :-(

知道如何解决这个问题吗？

我在将插件添加到小提琴时遇到了一些麻烦，所以我创建了单独的小提琴： http: [//jsfiddle.net/chayanyc/Dhaat/201/](http://jsfiddle.net/chayanyc/Dhaat/201/) - 有效的功能 [http://jsfiddle.net/chayanyc/vWLEn/89/](http://jsfiddle.net/chayanyc/vWLEn/89/) - Dropkick 样式的 Select 元素的功能（不起作用） [http://jsfiddle.net/chayanyc/3jr2v/69/](http://jsfiddle.net/chayanyc/3jr2v/69/) - UI MultiSelect Widget 样式的 Multi-Select 元素的功能（不起作用）

```
var $increase_priority1 = $(".increase_priority1");
$(".trigger_rank1, .complaint select").change(function () {
var name = $(this).data("name"); 
if ($("#Shoulders select").val() === "Too_small" && $(this).val() == 1 && !$(this).data("increase_priority1")) {
    $("<option>", {
        text: name,
        val: name
    }).appendTo($increase_priority1);
    $(this).data("increase_priority1", true); 
}    
if ($(this).data("increase_priority1") && $(this).val() != 1) {
    $("option[value=" + name + "]", $increase_priority1).remove();
    $(this).removeData("increase_priority1");
}
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T18:27:23.483

由于 DropKick 插件和 MultiSelect Widget`<select>`用新的 html 元素（主要是`<div>`'s）替换了您的原始元素，因此您附加到原始元素的更改事件`<select>`不会触发，因为它已被替换。

因此，您必须使用插件 api 来分配更改事件处理程序。您链接的两个站点都有此记录。

DropKicks 看起来像这样：

```
$('.change').dropkick({
   change: function (value, label) {
   alert('You picked: ' + label + ':' + value);
  }
}); 
```

Multiselect Widget 有一个如下所示的单击事件：

```
$("#multiselect").bind("multiselectclick", function(event, ui){
/*
event: the original event object

ui.value: value of the checkbox
ui.text: text of the checkbox
ui.checked: whether or not the input was checked
    or unchecked (boolean)
*/
}); 
```

您必须以这种方式附加您的更改事件逻辑

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:32:28.040

我想为其他 Dropkick 用户留下完整的代码

```
var $increase_priority1 = $(".increase_priority1");
$('.trigger_rank1, .complaint select').dropkick({
change: function () {
    var name = $(this).data("name");
    if ($("#Shoulders select").val() === "Too_small" && $(this).val() == 1 && !$(this).data("increase_priority1")) {
        $("<option>", {
            text: name,
            val: name
        }).appendTo($increase_priority1);
        $(this).data("increase_priority1", true);
    }
    if ($(this).data("increase_priority1") && $(this).val() != 1) {
        $("option[value=" + name + "]", $increase_priority1).remove();
        $(this).removeData("increase_priority1");
    }
}
}); 
```

# c# - 您可以为 WebSocket4Net websocket 指定活动超时吗

> ID：13479346
> 
> 赞同：4
> 
> 时间：2012-11-20T18:04:49.640
> 
> 标签：c#, websocket4net

使用 WebSocket4Net 客户端针对相对安静的服务器打开 WebSocket。4 分钟后，套接字收到一条关闭消息。4 分钟后，如果套接字上没有收到其他消息活动，则套接字将收到关闭消息。

WebSocket 中是否定义了超时？我试图确定 WebSocket 正在从超时关闭，因为服务器没有设置活动超时，因此将允许套接字无限期地保持连接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T18:44:20.497

根据 Kerry Jiang 在这个线程上的说法，[http://websocket4net.codeplex.com/discussions/403988](http://websocket4net.codeplex.com/discussions/403988)，答案是否定的。问题在于 websocket 服务器断开连接。

# java - JMeter中线程与控制器的关系

> ID：13479347
> 
> 赞同：1
> 
> 时间：2012-11-20T18:04:55.343
> 
> 标签：java, http, web-applications, jmeter, load-testing

我正在研究`JMeter`并试图理解这些概念。令我特别困惑的是线程与控制器。
我知道线程代表用户，控制器是采样器的容器并确定它们的执行。
但是线程和控制器的关系是什么？线程是否执行作为线程组子级的所有控制器？
所以一个线程（为了简化）调用每个控制器，然后触发样本？[但是例如在我的线程组中指定循环计数为 20 和使用While 控制器](http://jmeter.apache.org/usermanual/component_reference.html#While_Controller)触发请求 20 次
之间有什么区别？ 任何帮助清除这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:13:32.747

你很好理解，一个线程代表一个用户，一个控制器是采样器的容器并决定它们的执行。

是的，它是否执行（如果控制器在 IfController 中）所有子控制器。

是的，一个线程（为了简化）调用每个控制器，然后依次触发样本。

但是例如在我的线程组中指定循环计数为 20 和使用 While 控制器触发请求 20 次之间有什么区别？很简单，很多人加了一个 WhileController，而只设置循环计数就足够了。

如果要在主迭代中重复一组样本，通常需要一个 While 控制器。

阅读[JMeter 组件参考](http://jmeter.apache.org/usermanual/component_reference.html)和[测试计划元素](http://jmeter.apache.org/usermanual/test_plan.html)

另请阅读[范围规则](http://jmeter.apache.org/usermanual/test_plan.html#scoping_rules)以了解配置元素的应用方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T09:47:27.963

它就像在 Java 中一样。**线程表示执行线程**，**控制器代表控制结构**。因此，如果您想决定对测试应用程序施加多少压力，主要是线程数。每个线程按顺序执行其子线程。如果您想多次测试同一件事，因为控制器是您的伴侣，如果您想并行执行此操作，则需要线程（具有给定线程数的线程组）。

* * *

**当您想要参数化您的测试时**，您需要了解的一个主要区别就是图片。

例如，您有一个 Web 应用程序，并且有 100 个演示用户。每个用户只能登录一次。这种情况下你需要一些东西，告诉你的测试线程，他们应该使用哪个用户。这通常是一个[CVS 数据集](http://jmeter.apache.org/usermanual/component_reference.html#CSV_Data_Set_Config)，它可以以某种方式使用，线程可以为自己获取一行，并且他们使用它。您也可以说，当 CSV 中没有更多行时，您的测试应该停止。同样的概念（在 for 循环中为每次迭代提供一个数据）更难用 for 循环或其他控制器实现。

# php - JSON 编码 PHP AJAX jQuery 响应错误

> ID：13479348
> 
> 赞同：2
> 
> 时间：2012-11-20T18:05:02.743
> 
> 标签：php, javascript, jquery, ajax, json

我在从我的 PHP 代码中取回响应时遇到问题。JavaScript 文件说 JSON 对象的长度为 0。

这是我从**getalbums.php**脚本返回的 JSON：

```
[
  {
    "album_id": "50ab2c3db9396",
    "username": "tusik",
    "title": "testalbum",
    "cover_photo_url": "http:\/\/s3.amazonaws.com\/Looking_Glass_Images\/tusik_testalbum_testpic.jpeg"
  },
  {
    "album_id": "50ab3b75a46fe",
    "username": "tusik",
    "title": "test",
    "cover_photo_url": "http:\/\/s3.amazonaws.com\/Looking_Glass_Images\/tusik_test_test.png"
  }
]
```

* * *

**获取相册.php**

```
<?php

session_start();
include("db.php");

$albumsArray = array();

$username = $_GET['uid'];
//Preventing MySQL injection
$username = stripslashes($username);
$username = mysql_real_escape_string($username);

$sql = "SELECT album_id,username,title,cover_photo_url FROM albums WHERE   albums.username='$username'";
$result = mysql_query($sql) or die(mysql_error());

echo $count;

while ($row = mysql_fetch_object($result)) {

    $albumsArray[] = $row;
}

echo json_encode( $albumsArray );
?> 
```

如果我输入`/getalbums.php?uid=tusik`，我会从上面得到 JSON，所以我知道该页面有效。

* * *

**相册.js**

```
$.urlParam = function(name){
var results = new RegExp('[\\?&amp;]' + name + '=([^&amp;#]*)').exec(window.location.href);
return results[1] || 0;
}

var username = $.urlParam('uid');

var data = "uid=" + username;    
$.ajax({
  type: "GET",
  url: "getalbums.php",
  data: data,
  dataType: "json",
  processData: false
}).done(function(data) {
    //Do work

}).fail(function(jqXHR, textStatus) {
  alert( "Request failed: " + textStatus );
}); 
```

代码给了我这个错误。

```
TypeError: Cannot read property 'album_id' of undefined 
```

谁能看到我做错了什么？

**编辑：** 修复了我的问题 jeroen 的建议部分正确。`{'uid':username}`应该读`{"uid":username}`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T18:10:59.667

如果设置`dataType: 'json'`,`data`应该已经包含解析的数据，而不是 JSON 字符串。所以调用`parseJSON()`是一个不必要的步骤——它会尝试解析你的（已经解析的）Javascript数组，这当然不是包含JSON的字符串，所以它失败并返回`null`。

您还可以[在手册页上查看`.ajax()`](http://api.jquery.com/jQuery.ajax/)（强调我的）：

> ### 数据类型
> 
> **"json"**：将响应评估为 JSON 并***返回一个 JavaScript 对象***。在 jQuery 1.4 中，JSON 数据以严格的方式解析；任何格式错误的 JSON 都会被拒绝并引发解析错误。（有关正确的 JSON 格式的更多信息，请参阅 json.org。）

这意味着您应该能够简单地编写：

```
...
}).done(function(data) {
    console.log(data[0].album_id);
})
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T20:07:42.897

您需要在 ajax 调用中将键和值都发送到服务器：

```
$.ajax({
  type: "GET",
  url: "getalbums.php",
  data: {'uid': username},    // here
  dataType: "json",
  processData: false
}).done(function(data) { 
```

您只是在没有密钥的情况下发送数据，这就是为什么`$_GET['uid']`为空/未设置并且您的查询返回 0 行的原因。

**编辑：**您还使用此行使您的 json 无效：

```
echo $count; 
```

您需要确保只有该`json_encode`行被回显/返回到 jQuery 回调函数，因此只需将其删除或将其注释掉。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-20T18:28:04.267

你能试试简单的 eval() 函数吗？如果您想了解有关 JSON 和 eval() 的更多详细信息，请[单击此处。](http://mycodeprograms.blogspot.in/p/json.html)

```
var test = eval("(" + data + ")"); OR var test = eval(data); 
```

我已经在我的很多应用程序中尝试过这个，这对我来说很好。

# jquery - 你管视频 asp.net

> ID：13479349
> 
> 赞同：2
> 
> 时间：2012-11-20T18:05:06.660
> 
> 标签：jquery, asp.net, youtube

在 aspx 页面中显示来自 youtube 的类似视频列表时，我有点卡住了。我可以播放所需的视频，我还希望在屏幕上显示类似的视频。

你能帮我用aspx得到同样的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:09:01.927

您看过[YouTube 数据 API](https://developers.google.com/youtube/getting_started#data_api)吗？

> 数据 API 允许程序执行 YouTube 网站上提供的许多操作。可以搜索视频、检索标准提要并**查看相关内容**。程序还可以验证用户身份以上传视频、修改用户播放列表等。

[您可以在.NET Developer's Guide](https://developers.google.com/youtube/2.0/developers_guide_dotnet)中找到示例代码。

# java - Java 实体定位

> ID：13479350
> 
> 赞同：2
> 
> 时间：2012-11-20T18:05:11.793
> 
> 标签：java, entity

我是一个完全的编程初学者，但上个月我一直在阅读和浏览教程。

我被困在我目前的项目中。我设置了一个实体包，里面有一个名为 Mob 的类。在 Mob 中，我创建了 Player 和一个名为 Slime 的怪物类。

现在，我真的很难让史莱姆随机移动，但在我担心之前，我必须弄清楚为什么我不能正确定位他。

当我在我的主类中使用 ax 和 y 参数执行 addEntity(Slime) 时，它会忽略它并将他置于 1,1。

这是我的史莱姆怪物课： http: [//pastie.org/5404386](http://pastie.org/5404386)

我的带有 addEntity 函数的实体类：http: [//pastie.org/5404390](http://pastie.org/5404390)

以及我调用粘液并（尝试）设置其位置参数的主类：

```
slime = new Slime(level, "Slime", 5, 5, 1);
level.addEntity(slime);
player = new Player(level, 11,11, input,JOptionPane.showInputDialog(this,"Please enter a Username."));
level.addEntity(player); 
```

谢谢你的帮助！

# string - Lua模式查询

> ID：13479351
> 
> 赞同：2
> 
> 时间：2012-11-20T18:05:21.403
> 
> 标签：string, lua, lua-patterns

我需要从一个更大的字符串中检测出一个单词say **john ，say** **john is a good man** 所以我有这个模式来找到这个词

```
[j][o][h][n] 
```

并按如下方式使用它：

```
local pattern = "[j][o][h][n]"
local str = "john is a good man"
print(str:find(pattern)) 
```

为了接受字母是否出现多次（例如**jooohn 是个好人**），我将模式修改为

```
[j]+[o]+[h]+[n]+ 
```

我需要忽略单词之间可能出现的空格（或其他非字母字符）（例如**joh;n is a good man**），所以我将 [^az]* 添加到每个字母，结果模式是

```
[j]+[^a-z]\*[o]+[^a-z]\*[h]+[^a-z]\*[n]+[^a-z]\* 
```

现在这非常适合像“jooh!n is a good man”这样的词。但如果**!** 符号出现在重复字母中，则模式失败。例如，在***jo!ohn is a good man***中，没有检测到模式。我如何修改我的模式以实现这一目标？

**编辑**

例子：

```
local str = "jooohn is a good man"
local pattern = "[j]+[^a-z]*[o]+[^a-z]*[h]+[^a-z]*[n]+[^a-z]*"
print(str:find(pattern)) 
```

这将打印 `1 7`

但

```
 local str = "joo!ohn is a good man"
 local pattern = "[j]+[^a-z]*[o]+[^a-z]*[h]+[^a-z]*[n]+[^a-z]*"
 print(str:find(pattern)) 
```

将只打印`nil` 我需要一个允许我在场景 2中检测**joo!ohn的模式**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T19:30:04.237

这应该这样做`"j[j%W]*o[o%W]*h[h%W]*n[n%W]*"`：

```
local str = "joo!ohn is a good man"
local pattern = "j[j%W]*o[o%W]*h[h%W]*n[n%W]*"
print(str:find(pattern)) 
```

打印`1 8`。

# c# - 使用 Entity Framework 5 和存储库模式和工作单元过滤内部集合

> ID：13479352
> 
> 赞同：0
> 
> 时间：2012-11-20T18:05:31.573
> 
> 标签：c#, linq, entity-framework, entity-framework-5

我将存储库和工作单元模式与 Entity Framework 5 一起使用

我想获取所有带有“汽车”的“代理商”，但只有那些在参数发送的列表中具有 id 并且属于参数发送的状态的汽车。

例如

```
public IEnumerable<Agency> GetList(int stateId, string idCarList)

var ids = idTiposTarjetasList.Split(',');
var intIds = ids.Select(int.Parse); 
```

然后我有

```
Uow.Agencies.GetAll() 
```

和

```
Uow.Agencies.GetAllIncluding(a => a.Cars) 
```

它检索一个 IQueryable< T >

无论如何，我是否可以在一个查询中检索包含其 Cars 的机构，但只有那些在 intIds 列表中包含 id 且 stateId 与 stateId 参数匹配的机构？

我已经看过这个[Stackoverflow question](https://stackoverflow.com/questions/3981417/how-to-sort-inner-list-that-is-returned-by-entity-framework)，但是 IQueryable 的检索让我很难让它工作。

如果我在 Uow.Agencies.GetAllIncluding(c => c.Cars) 中写这个 var sortedList = from x 则无法完成选择（表示无法从查询中推断出参数

这不起作用：

```
var ids = idCars.Split(',');
var intIds = ids.Select(int.Parse);

var agencies =  from agency in
                Uow.Agencies.GetAllIncluding(c => c.Cars).Where(c => intIds.Contains(c.Cars.Id)).OrderBy(s => s.Id)
                 select agency;

if (agencies.Any())
{
    return agencies;
} 
```

我该怎么做？谢谢！吉列尔莫。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:48:49.027

您无法使用部分加载的集合获取对象（至少，不是在一个语句中）。因此，您必须分别创建一个包含`agent`对象和选定汽车的类型：

```
var agencies =  from agency in Uow.Agencies.GetAll()
                select new { Agency = agency,
                             Cars = agency.Cars.Where(c => intIds.Contains(c.Id))
                           }; 
```

# google-maps - 鼠标悬停而不是点击（标记）

> ID：13479353
> 
> 赞同：0
> 
> 时间：2012-11-20T18:05:32.077
> 
> 标签：google-maps, google-maps-api-3, google-maps-markers, mousehover

我想用 onmouseover 事件而不是 onclick 事件显示信息窗口。

问题是当我将光标位置更改为标记之外时，我的信息窗口消失了，而我的信息窗口中有一个链接。

```
<!DOCTYPE html>
<html> 
<head> 
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" /> 
  <title>multi-marqueurs</title> 
  <script src="http://maps.google.com/maps/api/js?sensor=true"
          type="text/javascript"></script>
</head> 
<body>
  <div id="map" style="width: 800px; height: 700px;"></div>

  <script type="text/javascript">
<!--
var locations = [
     ['<span id="ss">Jérôme et Catherine Blondel</span>', 49.898729,3.13606, 5],
      ['Laurent et Sabine Blondel', 50.684142,3.1360678, 4],
      ['Noël et Anne Marie Blondel', 49.953802, 2.360237, 3],
      ['Jean Luc et Catherine Blondel<br /> <a href="http://www.google.com/">GOOGLE</a>', 48.606369,2.886894, 2]
    ];

    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 6,
      center: new google.maps.LatLng(48.4,1.6),
          mapTypeControl: true,
        mapTypeControlOptions: {
      style: google.maps.MapTypeControlStyle.DROPDOWN_MENU
    },
    navigationControl: true,
     navigationControlOptions: {
        style: google.maps.NavigationControlStyle.SMALL,
        position: google.maps.ControlPosition.TOP_RIGHT
    },
        scaleControl: true,
    streetViewControl: false,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    var infowindow = new google.maps.InfoWindow();

    var marker, i;

   for (i = 0; i < locations.length; i++) { 
    /*var pictureLabel = document.createElement("img");
     pictureLabel.src = "home.jpg";*/
      marker = new google.maps.Marker({
        position: new google.maps.LatLng(locations[i][1], locations[i][2]),
        map: map,
        /*title    : "CRIAQ",
        icon     : "disk.png"*/
      });

      google.maps.event.addListener(marker, 'mouseover', (function(marker, i) {
        return function() {
          infowindow.setContent(locations[i][0]);
          infowindow.open(map, marker);
        }
      })(marker, i));

      google.maps.event.addListener(marker, 'mouseout', (function(marker, i) {
        return function() {
          infowindow.close(map, marker);
        }
      })(marker, i));
    }​
-->
  </script>
</body>
</html> 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:52:40.530

我重写你的代码：

```
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <title>multi-marqueurs</title>
    <script src="http://maps.google.com/maps/api/js?sensor=true"
    type="text/javascript"></script>
  </head>
  <body>
    <div id="map" style="width: 800px; height: 700px;"></div>

    <script type="text/javascript">
      var infowindow;
      function initialize() {

        var locations = [['<span id="ss">Jérôme et Catherine Blondel</span>', 49.898729, 3.13606, 5], ['Laurent et Sabine Blondel', 50.684142, 3.1360678, 4], ['Noël et Anne Marie Blondel', 49.953802, 2.360237, 3], ['Jean Luc et Catherine Blondel<br /> <a href="http://www.google.com/">GOOGLE</a>', 48.606369, 2.886894, 2]];

        var map = new google.maps.Map(document.getElementById('map'), {
          zoom : 6,
          center : new google.maps.LatLng(48.4, 1.6),
          mapTypeControl : true,
          mapTypeControlOptions : {
            style : google.maps.MapTypeControlStyle.DROPDOWN_MENU
          },
          navigationControl : true,
          navigationControlOptions : {
            style : google.maps.NavigationControlStyle.SMALL,
            position : google.maps.ControlPosition.TOP_RIGHT
          },
          scaleControl : true,
          streetViewControl : false,
          mapTypeId : google.maps.MapTypeId.ROADMAP
        });

        infowindow = new google.maps.InfoWindow();

        var marker, i;

        for ( i = 0; i < locations.length; i++) {
          /*var pictureLabel = document.createElement("img");
           pictureLabel.src = "home.jpg";*/
          marker = new google.maps.Marker({
            position : new google.maps.LatLng(locations[i][1], locations[i][2]),
            map : map,
            idx : i,
            location : locations[i]
            /*title    : "CRIAQ",
             icon     : "disk.png"*/
          });

          google.maps.event.addListener(marker, 'mouseover', onMarker_mouseOver);

          google.maps.event.addListener(marker, 'mouseout', onMarker_mouseOut);
        }
      }
      function onMarker_mouseOver() {
        var marker = this;
        console.log();
        infowindow.setContent(marker.get("location")[0]);
        infowindow.open(marker.getMap(), marker);
      }
      function onMarker_mouseOut() {
        infowindow.close();
      }

      google.maps.event.addDomListener(window, "load", initialize);
    </script>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:08:27.023

将 onmouseover 添加到您的信息窗口并调用使其出现在第一个实例中的相同代码或调用另一个使您的 div 可见的函数。如果您的信息窗口触摸您的标记，这将有效

```
function onMarker_mouseOut() {
        infowindow.close();
      } 
```

删除这个`infowindow.close();`

并在您想要参加另一个活动时将其称为

# google-chrome - 从 chrome 应用程序窗口打开另一个 chrome 应用程序窗口

> ID：13479355
> 
> 赞同：0
> 
> 时间：2012-11-20T18:05:40.933
> 
> 标签：google-chrome, window, manifest

我有一个作为 Chrome 安装扩展程序打开的登录窗口（将是一个独立的 chrome Web 应用程序，所以我使用 manifest.json 设置 .js 文件，然后打开小登录窗口。

我想要它，以便当用户输入正确的凭据并单击登录时，我可以打开主应用程序窗口。

我的登录窗口可以正常打开，但无法打开下一个窗口。我确定这与沙盒有关，但我不知道我哪里出错了。

到目前为止，这是我的代码，没有 CSS。

* * *

清单.json

```
{
    "name": "CAD",
    "description": "A CAD Call Sheet",
    "manifest_version": 2,
    "minimum_chrome_version": "23",
    "version": "0.1",
    "offline_enabled": true,
    "app": {
        "background": {
            "scripts": ["mainInfo.js"]
        }
    },

    "icons": {
        "16": "assets/icon-128x128.png",
        "128": "assets/icon-128x128.png"
    }
} 
```

* * *

mainInfo.js

```
chrome.app.runtime.onLaunched.addListener(function() {
  chrome.app.window.create('CADLogin.html', {
    width: 250,
    height: 250,
    maxWidth: 250,
    minWidth: 250,
    minHeight: 250,
    maxHeight: 250,
  });
}); 
```

* * *

CADLogin.html

```
<!DOCTYPE html>
<html>
    <head>
        <title>Login</title>
        <link rel='stylesheet' href="CADLogin.css" type='text/css' />
        <script type="text/javascript" src="CADLogin.js"></script>
    </head>

    <body>
        <header>
            <h1 class="loginHeader">CAD Login</h1>
        </header>

        <form id="loginForm">
            <br />
            <div id="loginUsernamediv">
                <input class="loginFields" type="text" id="loginUsername" name="loginUsername" placeholder="Username" />
            </div>

            <div id="loginPassworddiv">
                <input class="loginFields" type="password" id="loginPassword" name="loginPassword" placeholder="Password" />
            </div>

            <br />

            <div id="loginButtonsdiv">
                <button class="loginButton" id="loginButton">
                    Login
                </button>
                <button class="loginButton" id="cancelButton">
                    Cancel
                </button>
            </div>

            <br />
            <br />

        </form>
    </body>

</html> 
```

* * *

CADLogin.js

```
window.onload = function() {

    document.getElementById("cancelButton").onclick = function() {
        window.close();
    }

    document.getElementById("loginButton").onclick = function() {
        var username = document.getElementById("loginUsername");
        var password = document.getElementById("loginPassword");
        if (username=="brian" && password=="letmein") {
            chrome.app.window.create('MainSelections.html', {
                width: 100,
                height: 250,
                maxWidth: 100,
                minWidth: 100,
                minHeight: 250,
                maxHeight: 250
            });
        }
    }
} 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T18:00:20.823

好的，所以检查我的代码中的错别字会有所帮助。texxt/javascript 和 text/javascript 不一样...第一个实际上会使代码不起作用。

# .net - CloudConfigurationManager GetSetting 方法是否缓存？

> ID：13479357
> 
> 赞同：12
> 
> 时间：2012-11-20T18:05:47.897
> 
> 标签：.net, azure

有谁知道调用 CloudConfigurationManager GetSetting 方法是否会影响性能？例如，它是重新解析 azure 文件还是被缓存？不确定我是否应该添加自己的缓存/静态变量来提高性能，例如连接字符串。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-25T07:47:35.383

[源代码](https://github.com/Azure/azure-sdk-for-net/blob/master/src/Common/Configuration/AzureApplicationSettings.cs)可在 github 上找到。

如果您查看源代码，您会发现它没有进行任何缓存，因此如果您遇到性能问题，您可能需要实现自己的缓存。

的正文`GetSetting`显示了一个简单的返回：

```
value = GetValue("ServiceRuntime", name, GetServiceRuntimeSetting);

if (value == null)
{
    value = GetValue("ConfigurationManager", name, n => ConfigurationManager.AppSettings[n]);
}

return value; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-03-15T23:49:48.450

接受的答案可能不正确。

确实它`CloudConfigurationManager`本身不缓存，但那是因为它在内部委托`ConfigurationManager`or `WebConfigurationManager`，它**会缓存值**。

来自[MSDN](https://msdn.microsoft.com/en-us/library/system.web.configuration.webconfigurationmanager.aspx)：

> 对于`<appSettings>`和`<connectionStrings>`，您使用 AppSettings 和 ConnectionStrings 属性。这些方法执行只读操作，使用配置的单个缓存实例，并且支持多线程。

因此，即使您`CloudConfigurationManager`直接访问，也很可能不会发生 IO 操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T18:34:18.190

不，它没有被缓存，因为您建议您必须创建自己的缓存以提高性能。

# javascript - 环境声明样式和模块

> ID：13479358
> 
> 赞同：5
> 
> 时间：2012-11-20T18:05:48.440
> 
> 标签：javascript, typescript

有些人正在使用 Backbone.d.ts 编写 Backbone 应用程序。我想讨论两个用例。

1.  使用 AMD 加载器（或者我想也是 CommonJS）创建带有模块的主干应用程序
2.  使用纯 JS 创建主干应用程序

对于营地 1 中的那些，有必要将主干模块定义为外部模块，以便能够导入模块并将其包含在`define()`包装器中。

对于阵营 2 中的那些，有必要将骨干模块定义为内部模块，以便使用智能感知并且不需要使用`import`语句/`define()`包装器。

**问题：**是否有其他方式来定义模块以便在这两种情况下都可以使用它？

* * *

我真的不想创建一个分叉，这样你就可以拥有

```
// required for those using import (1)
declare module "Backbone" { 
```

或者

```
// required for those not using import (2) and backbone already exists in the global scope
declare module Backbone { 
```

并且仍然能够与您的代码/智能感知相处。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T01:36:21.700

这不能仅使用一个`.d.ts`文件来完成，因为编译器需要知道您正在为骨干使用哪种模块系统才能知道要生成哪种代码。您可以在单个文件中混合和匹配内部和外部模块，并且无法正确猜测您将哪个模块用于主干。

您也许可以使用`interface`声明来实现，这样您就可以在一个地方声明大部分内容，并拥有一个引用该常见内容的“backbone-internal.d.ts”和“backbone-external.d.ts”文件声明文件，但您可以做到的程度将取决于 API 的表面积究竟是什么样的。

TL;DR：Camp 1 和 Camp 2 并不相互排斥，即使在同一个文件中也是如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T19:39:29.967

我已经向 TypeScript 团队提出了这个问题，他们已经打开了一个工作项。

我建议如果您使用...编写所有模块

```
module MyModule {
} 
```

...包装器，如果您将模块标志发送给编译器，如果它与文件名匹配，它应该剥离模块声明。这样你就可以编写一个模块，无需修改就可以编译为在 web、CommonJS 或 AMD 上工作。

最初的讨论在这里，它已被移到一个工作项中：

[http://typescript.codeplex.com/discussions/401397](http://typescript.codeplex.com/discussions/401397)

# ruby-on-rails - @article.save 似乎保存旧内容而不是更新内容

> ID：13479359
> 
> 赞同：1
> 
> 时间：2012-11-20T18:05:48.400
> 
> 标签：ruby-on-rails

我在文章中有一个名为 merge_with(other_article_id) 的模型实例方法：

```
 def merge_with(other_article_id)
    self.comments << Article.find(other_article_id).comments
    self.body_and_extended << Article.find(other_article_id).body_and_extended
    return self   
  end 
```

在我的控制器中，我已合并定义：

```
 def merge #ypw
    @article = Article.find(params[:id])
    unless @article.access_by? current_user
      redirect_to :action => 'index'
      flash[:error] = _("Error, you are not allowed to perform this action")
      return
    end
    if params[:merge_with] and params[:merge_with] != ""
      @article = @article.merge_with(params[:merge_with])
debugger      
      if @article.save
debugger
        destroy_the_draft unless @article.draft
        set_the_flash
        redirect_to :action => 'index'
        return
      end
    end
    flash[:error] = 'merge articles did not succeed!'
    redirect_to :action => 'index'   
    end 
```

问题：在第一个调试器断点之前，我检查了@article.body，显示它已经将两篇文章的正文“A”和“B”完美地合并为一个“AB”。但是在第二个调试器断点处继续运行@article.save（@article.save 确实返回True 以允许进入if 语句）后，我发现实际上只有原始文章被保存，即@article.body = =“一个”。谁能帮我理解发生了什么？为什么@article.save 后，更新后的@article.body 内容又变回了更新前的原始内容？

非常感谢你的帮助。

* * *

嗨，Yoshiji 先生，感谢您的建议。我都试过了：保存和保存！

```
debugger
      #if @article.save
      if @article.merge_with(params[:merge_with]).save!
debugger
        destroy_the_draft unless @article.draft
        set_the_flash
        redirect_to :action => 'index'
        return
      end 
```

没有引发错误。正如您在第二个调试器断点处所预期的那样，我检查了@article.body，现在确实显示了“AB”。但是当它通过redirect_to :action => 'index' 运行回到文章列表页面时，如果我点击合并文章的链接，那么在编辑器中，它仍然显示“A”，只有“B”消失了。在旧内容再次保存之间是否有可能？

* * *

嗨 phoet，是的，当我在 rails 控制台中运行时（实际上我在 rails server --debug 中）并且 merge_with 行为符合预期。事实上，<< comments 和 << body 这两个行为都被检查过了，但有趣的是，将其插入代码后，只有 << comments 部分存活，<< body 部分丢失了！？神秘地重定向到之后.....

---关于这个谜的更多信息----- 请查看在 rails server --debug 控制台中以交互方式输入命令。请在保存后立即查看 Article.find(33).body 内容中“32”的神奇/神秘消失（但仍存在于@article.body 内容中）......任何合理的解释？谢谢。

```
(rdb:65) @article.body
"<p>\r\n\t33</p>\r\n<p>\r\n\t32</p>\r\n"
(rdb:65) Article.find(33).body << Article.find(32).body
"<p>\r\n\t33</p>\r\n<p>\r\n\t32</p>\r\n"
(rdb:65) Article.find(33).body
"<p>\r\n\t33</p>\r\n<p>\r\n\t32</p>\r\n"
(rdb:65) Article.find(33).save
true
(rdb:65) Article.find(33).body
"<p>\r\n\t33</p>\r\n"
(rdb:65) @article.body
"<p>\r\n\t33</p>\r\n<p>\r\n\t32</p>\r\n"
(rdb:65) @article.id
33
(rdb:65) Article.find(33).body
"<p>\r\n\t33</p>\r\n"
(rdb:65) @article.save!
true
(rdb:65) @article.body
"<p>\r\n\t33</p>\r\n<p>\r\n\t32</p>\r\n"
(rdb:65) Article.find(33).body
"<p>\r\n\t33</p>\r\n"
(rdb:65) Article.find(32).body
"<p>\r\n\t32</p>\r\n"
(rdb:65) Article.find(33).body << Article.find(32).body
"<p>\r\n\t33</p>\r\n<p>\r\n\t32</p>\r\n"
(rdb:65) Article.find(33).save
true
(rdb:65) Article.find(33).body
"<p>\r\n\t33</p>\r\n"
(rdb:65) @article.body
"<p>\r\n\t33</p>\r\n<p>\r\n\t32</p>\r\n"
(rdb:65) 
```

* * *

嗨，Doug，所以 attr_accessible 的唯一一行是在 traceback.rb 中（实际上这是来自 Typo 博客开源）

```
require_dependency 'spam_protection'

class Trackback < Feedback
  belongs_to :article
  content_fields :excerpt
  validates_presence_of :title, :excerpt, :url

  attr_accessible :url, :blog_name, :title, :excerpt, :ip, :published, :article_id
  ........ 
```

在所有其他模型中都没有，包括主题的文章模型。

# php - 使用 PHPExcel 和 NginX 上传和解析文件

> ID：13479361
> 
> 赞同：1
> 
> 时间：2012-11-20T18:05:54.277
> 
> 标签：php, file-upload, nginx, yii, phpexcel

所以，我正在尝试将 xls 和 xlsx 文件上传到我的服务器（Yii 框架上的 NginX），它有一个 php 脚本来解析数据并将其添加到数据库中。

很简单。

但是，我在第一个街区绊倒了；上传文件时，PHPExcel 似乎找不到该文件 - 老实说，我不确定它是否存在，因为我无法深入了解它*应该*在哪里。下面是我的代码

```
<code>
<?php
spl_autoload_unregister(array('YiiBase','autoload')); 

/** Include path **/

set_include_path(get_include_path() . PATH_SEPARATOR . '/usr/share/nginx/www/dashboard/protected/extensions/phpexcel/Classes/');

/** PHPExcel_IOFactory */

include 'PHPExcel/IOFactory.php';
spl_autoload_register(array('YiiBase','autoload'));

echo $_FILES . "<br />";

$inputFileName = $_POST;

foreach ($inputFileName as $key => $value) {
    echo "Key: $key; Value: $value<br />\n";
    }
    echo $inputFileName["file"] . "<br />";

echo 'Loading file ',pathinfo($inputFileName["file"],PATHINFO_BASENAME),' using IOFactory to identify the format<br />'; 

//This is where it breaks  
$objPHPExcel = PHPExcel_IOFactory::load($inputFileName["file"]);
</code> 
```

当它中断时，它会给我这个错误：

```
<code>
Could not open Active, Telemetered, Electricity Accounts 17-10-2012.xlsx for reading! File does not exist.
</code> 
```

这个堆栈跟踪：

```
<code>
 /**  
225      * Can the current PHPExcel_Reader_IReader read the file?  
226      *  
227      * @param     string         $pFileName  
228      * @return     boolean  
229      * @throws Exception  
230      */
231     public function canRead($pFilename)  
232     {  
233         // Check if file exists  
234         if (!file_exists($pFilename)) {  
235             throw new Exception("Could not open " . $pFilename . " for reading! File does not exist.");  
236         }  
237 
238         // Check if zip class exists  
239         if (!class_exists('ZipArchive',FALSE)) {  
240             throw new Exception("ZipArchive library is not enabled");  
241         }  
</code> 
```

现在，据我了解， pathinfo() 应该已经为 PHP 提供了查找文件所需的内容，并且一旦我点击上传按钮，该文件应该位于 php 的临时文件夹中（简单的 html 表单；我可以从 $ 获取文件名_POST，所以我知道它已经走了那么远），但要么它实际上没有*上传*，要么一旦它启动它就会丢失。

任何帮助深表感谢！

编辑：html上传表单：

```
<code>
<form action="testFile" method="post">
<label for="file" />
<input type="file" name="file"   />
<br />
<input type="submit">
</form>
</code> 
```

编辑：

html 上传表单有问题；因为我没有设置 enctype，所以 $_FILES 没有被填充。将编码设置为多部分/表单数据让我获得所需的信息。谢谢你们俩！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:17:18.343

由于您使用的是 Yii`CUploadedFile`类，请调用`getInstance`以获取有关上传文件的访问权限和信息。根据[关于 CUploadedFile 的 Yii 文档](http://www.yiiframework.com/doc/api/1.1/CUploadedFile)

> CUploadedFile 表示上传文件的信息。
> 
> 调用 getInstance 获取上传文件的实例，然后使用 saveAs 将其保存在服务器上。您还可以查询文件的其他信息，包括名称、临时名称、类型、大小和错误。

例如：

```
$form->model->xlsx = CUploadedFile::getInstance($form->model, 'xlsx');
//save the file, as an example I am assuming that file is an xlsx
$file = '/importedfiles/'.uniqid().".xlsx";
if($model->xlsx->saveAs($file))
{
//import PHPExcel if you have not already done so
Yii::import('sharedLibraries.PHPExcel.PHPExcel',true);

$inputFileType = PHPExcel_IOFactory::identify($file);
$objReader = PHPExcel_IOFactory::createReader($inputFileType);
$objPHPExcel = $objReader->load($file);
$objWorksheet = $objPHPExcel->getActiveSheet();
..........
}
else
{
//handle the error as file could not be saved
} 
```

# php - PHP 重定向消息 - 使用分析出站链接进行跟踪

> ID：13479362
> 
> 赞同：0
> 
> 时间：2012-11-20T18:05:56.520
> 
> 标签：php, analytics, tracking, urldecode, outbound

我需要跟踪一个重定向到另一个 url 的动态按钮。每次发生这种情况时，我都需要进行跟踪，并确切知道用​​户正在重定向到哪个 url。

按钮代码：

```
 <a target="_blank" href="/out.php?url=<?php echo urlencode($this->product['from'])?>">
 <img src="http://xxx.com/data/images/buy.jpg" alt="buy"/>
 </a> 
```

文件“out.php”

```
 <?php
 $url = urldecode($_GET['url']);
  header("Location: ".$url);
  exit;?> 
```

我希望这样，例如，如果用户点击购买，它会重定向到“out.php”并显示一条消息，例如“U are beeing in a few seconds are redirected”，然后发送到 url。

我需要这个来通过分析跟踪用户登陆该页面的次数以及他们来自哪里，获得一些关于出站点击的指标。

有谁知道该怎么做？

提前致谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:26:51.260

完成此操作的最简单方法是使用 Google Analytics。它可以让您跟踪出站点击、重定向等。

根据您当前的实现，只需将变量 $url 保存到数据库中。

另一种方法是使用 AJAX，监听 javascript 事件 window.onbeforeunload，让它调用 PHP 脚本（通过 AJAX），并将 URL 保存到数据库。这将使用户不​​必看到“您现在要离开”页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:24:20.140

如果您正在使用事件跟踪器来确定单击了哪个链接，则可以过滤所有要跟踪的链接，并向链接添加事件调用：

```
var links = document.getElementsByTagName("a");

for(var i=0,l=links.length;i<l;i++){
   if (filter your links to only the external ones){
         links[i].onclick = function(){
             _gaq.push([your track event code here]);
         }
   }
} 
```

由于您的链接有 target="_blank"; 无需添加延迟，因此 gaq 调用已完成。如果它们没有在新窗口中打开，您可以执行以下操作：

```
links[i].onclick = function(){
    _gaq.push([your track event code here]);
    var url = this.href;
    setTimeout(function () {
        window.location.href = url;
    },500); // redirect in 500 milliseconds

    return false;
} 
```

# jdbc - 不完整的结果集

> ID：13479364
> 
> 赞同：1
> 
> 时间：2012-11-20T18:06:23.350
> 
> 标签：jdbc, resultset, jtds

我的查询类似于下面针对 SQL Server 2008 运行的查询

**从客户 P 中选择 *，其中客户 ID >= '1-458-20100500' 并且 P.CUSTOMERID <= '153294-301-5000713'**

当我在 sql studio 中运行此查询时返回的记录数为 29000+ 条记录，而当我在我的应用程序中使用 jdbc 运行相同的查询时，结果集中的行数为 4,500+。数据快照如下：

**客户 ID**

1-458-20100500
100002-104-19831017
100005-029-19831024
XXX
XXX
145817-297-19981115
145821-298-19981025
145822-299-19981025

跳过从 100002-104-19831017 和 145817-297-19981115 开始的所有记录。我知道这与 CustomerId 和内部 sql 比较有关。作为一个仅供参考，我正在使用 jtds 驱动程序。此外，如果我排除第一个客户（1-458-20100500）被选中，则结果集包含所有行。

如果有人可以分享他们对结果集为何不完整的想法，将不胜感激。谢谢大家。

# magento - 自定义客户属性未保存到数据库（来自前端注册表单）

> ID：13479365
> 
> 赞同：2
> 
> 时间：2012-11-20T18:06:28.207
> 
> 标签：magento

我在注册表单中添加了 2 个自定义属性，以在前端收集客户的输入。

我的问题是前端注册表单中的数据没有存储在数据库中。

我在管理区域中为这些字段输入的任何数据都将被存储，但我需要从客户那里收集信息。这是我的代码：

**app/code/local/Symphony/Khaos/sql/khaos_setup/mysql4-upgrade-0.1.12-0.1.13.php**（是的，我已经尝试过几次了；））

```
<?php 

$installer = $this;

$installer->startSetup();

$installer->addAttribute('customer', 'source', array(
    'input' => 'text',
    'type' => 'varchar',
    'label' => 'Where did you hear about us?',
    'visible' => 1,
    'required' => 0,
    'position' => 1,
    'sort_order' => 80,        
));

$installer->addAttribute('customer', 'practitioner_referrer', array(
    'input' => 'text',
    'type' => 'varchar',
    'label' => 'Referring practitioner',
    'visible' => 1,
    'required' => 0,
    'position' => 1,
    'sort_order' => 80,        
));

$installer->endSetup();

$customer = Mage::getModel('customer/attribute')->loadByCode('customer', 'source');
$forms= array('customer_account_edit', 'customer_account_create', 'adminhtml_customer', 'checkout_register');
$customer->setData('used_in_forms', $forms);
$customer->save(); 

$customer = Mage::getModel('customer/attribute')->loadByCode('customer', 'practitioner_referrer');
$forms= array('customer_account_edit', 'customer_account_create', 'adminhtml_customer', 'checkout_register');
$customer->setData('used_in_forms', $forms);
$customer->save(); 
```

**app/code/local/Symphony/Khaos/Model/Entity/Setup.php**

```
 <?php 
class Symphony_Khaos_Model_Entity_Setup extends Mage_Customer_Model_Entity_Setup
{
    public function getDefaultEntities(){

        return array(

                'source'=>array(
                        'type'=> 'static',
                        'label'=> 'source',
                        'visiable' => true,
                        'required' => false,
                        'sort_order' => 80,
                ),

                'practitioner_referrer'=>array(
                        'type'=> 'static',
                        'label'=> 'practitioner_referrer',
                        'visiable' => true,
                        'required' => false,
                        'sort_order' => 80,
                )

        );
    }
} 
```

**应用程序/代码/本地/交响乐/Khaos/etc/config.xml**

```
 <?xml version="1.0"?>
<!-- 
/**
 * @category   Symphony
 * @package    Symphony_Khaos
 * @author     ModuleCreator
 * @license    http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)
 */
 -->
<config>
    <modules>
        <Symphony_Khaos>
            <version>0.1.13</version>
        </Symphony_Khaos>
    </modules>
    <frontend>
        <routers>
            <khaos>
                <use>standard</use>
                <args>
                    <module>Symphony_Khaos</module>
                    <frontName>khaos</frontName>
                </args>
            </khaos>
        </routers>
        <layout>
            <updates>
                <khaos>
                    <file>khaos.xml</file>
                </khaos>
            </updates>
        </layout>
    </frontend>
    <admin>
        <routers>
            <khaos>
                <use>admin</use>
                <args>
                    <module>Symphony_Khaos</module>
                    <frontName>khaos</frontName>
                </args>
            </khaos>
        </routers>
    </admin>
    <adminhtml>
        <menu>
            <khaos module="khaos">
                <title>Khaos</title>
                <sort_order>71</sort_order>               
                <children>
                    <items module="khaos">
                        <title>Manage Items</title>
                        <sort_order>0</sort_order>
                        <action>khaos/adminhtml_khaos</action>
                    </items>
                </children>
            </khaos>
        </menu>
        <acl>
            <resources>
                <all>
                    <title>Allow Everything</title>
                </all>
                <admin>
                    <children>
                        <Symphony_Khaos>
                            <title>Khaos Module</title>
                            <sort_order>10</sort_order>
                        </Symphony_Khaos>
                    </children>
                </admin>
            </resources>
        </acl>
        <layout>
            <updates>
                <khaos>
                    <file>khaos.xml</file>
                </khaos>
            </updates>
        </layout>
    </adminhtml>   
    <global>
        <models>
            <khaos>
                <class>Symphony_Khaos_Model</class>
                <resourceModel>khaos_mysql4</resourceModel>
            </khaos>
            <khaos_mysql4>
                <class>Symphony_Khaos_Model_Mysql4</class>
                <entities>
                    <khaos>
                        <table>khaos</table>
                    </khaos>
                </entities>
            </khaos_mysql4>
        </models>
        <resources>
            <khaos_setup>
                <setup>
                    <module>Symphony_Khaos</module>
                    <class>Symphony_Khaos_Model_Entity_Setup</class>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </khaos_setup>
            <khaos_write>
                <connection>
                    <use>core_write</use>
                </connection>
            </khaos_write>
            <khaos_read>
                <connection>
                    <use>core_read</use>
                </connection>
            </khaos_read>          
        </resources>
        <blocks>
            <khaos>
                <class>Symphony_Khaos_Block</class>
            </khaos>
        </blocks>
        <helpers>
            <khaos>
                <class>Symphony_Khaos_Helper</class>
            </khaos>
        </helpers>   
        <fieldsets>
            <customer_account>
                <source><create>1</create><update>1</update></source>
                <practitioner_referrer><create>1</create><update>1</update></practitioner_referrer>
            </customer_account>
        </fieldsets>   
    </global>
</config> 
```

**app/design/frontend/metabolics/default/template/persistent/checkout/onepage/billing.phtml**

```
<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2012 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
/** @var Mage_Checkout_Block_Onepage_Billing $this */
?>
<form id="co-billing-form" action="">
<fieldset>
    <ul class="form-list">
    <?php if ($this->customerHasAddresses()): ?>
        <li class="wide">
            <label for="billing-address-select"><?php echo $this->__('Select a billing address from your address book or enter a new address.') ?></label>
            <div class="input-box">
                <?php echo $this->getAddressesHtmlSelect('billing') ?>
            </div>
        </li>
    <?php endif; ?>
    <li id="billing-new-address-form"<?php if ($this->customerHasAddresses()): ?> style="display:none;"<?php endif; ?>>
        <fieldset>
            <input type="hidden" name="billing[address_id]" value="<?php echo $this->getAddress()->getId() ?>" id="billing:address_id" />
            <ul>
                <li class="fields"><?php echo $this->getLayout()->createBlock('customer/widget_name')->setObject($this->getAddress()->getFirstname() ? $this->getAddress() : $this->getQuote()->getCustomer())->setForceUseCustomerRequiredAttributes(!$this->isCustomerLoggedIn())->setFieldIdFormat('billing:%s')->setFieldNameFormat('billing[%s]')->toHtml() ?></li>
                <li class="fields">
                    <div class="field">
                        <label for="billing:company"><?php echo $this->__('Company') ?></label>
                        <div class="input-box">
                            <input type="text" id="billing:company" name="billing[company]" value="<?php echo $this->escapeHtml($this->getAddress()->getCompany()) ?>" title="<?php echo $this->__('Company') ?>" class="input-text <?php echo $this->helper('customer/address')->getAttributeValidationClass('company') ?>" />
                        </div>
                    </div>
        <?php if(!$this->isCustomerLoggedIn()): ?>
                    <div class="field">
                        <label for="billing:email" class="required"><em>*</em><?php echo $this->__('Email Address') ?></label>
                        <div class="input-box">
                            <input type="text" name="billing[email]" id="billing:email" value="<?php echo $this->escapeHtml($this->getAddress()->getEmail()) ?>" title="<?php echo $this->__('Email Address') ?>" class="input-text validate-email required-entry" />
                        </div>
                    </div>
        <?php endif; ?>
                </li>
        <?php $_streetValidationClass = $this->helper('customer/address')->getAttributeValidationClass('street'); ?>
                <li class="wide">
                    <label for="billing:street1" class="required"><em>*</em><?php echo $this->__('Address') ?></label>
                    <div class="input-box">
                        <input type="text" title="<?php echo $this->__('Street Address') ?>" name="billing[street][]" id="billing:street1" value="<?php echo $this->escapeHtml($this->getAddress()->getStreet(1)) ?>" class="input-text <?php echo $_streetValidationClass ?>" />
                    </div>
                </li>
        <?php $_streetValidationClass = trim(str_replace('required-entry', '', $_streetValidationClass)); ?>
        <?php for ($_i = 2, $_n = $this->helper('customer/address')->getStreetLines(); $_i <= $_n; $_i++): ?>
                <li class="wide">
                    <div class="input-box">
                        <input type="text" title="<?php echo $this->__('Street Address %s', $_i) ?>" name="billing[street][]" id="billing:street<?php echo $_i ?>" value="<?php echo $this->escapeHtml($this->getAddress()->getStreet($_i)) ?>" class="input-text <?php echo $_streetValidationClass ?>" />
                    </div>
                </li>
        <?php endfor; ?>
                <?php if ($this->helper('customer/address')->isVatAttributeVisible()) : ?>
                <li class="wide">
                    <label for="billing:vat_id"><?php echo $this->__('VAT Number') ?></label>
                    <div class="input-box">
                        <input type="text" id="billing:vat_id" name="billing[vat_id]" value="<?php echo $this->escapeHtml($this->getAddress()->getVatId()) ?>" title="<?php echo $this->__('VAT Number') ?>" class="input-text <?php echo $this->helper('customer/address')->getAttributeValidationClass('vat_id') ?>" />
                    </div>
                </li>
                <?php endif; ?>
                <li class="fields">
                    <div class="field">
                        <label for="billing:city" class="required"><em>*</em><?php echo $this->__('City') ?></label>
                        <div class="input-box">
                            <input type="text" title="<?php echo $this->__('City') ?>" name="billing[city]" value="<?php echo $this->escapeHtml($this->getAddress()->getCity()) ?>" class="input-text <?php echo $this->helper('customer/address')->getAttributeValidationClass('city') ?>" id="billing:city" />
                        </div>
                    </div>
                    <div class="field">
                        <label for="billing:region_id" class="required"><em>*</em><?php echo $this->__('State/Province') ?></label>
                        <div class="input-box">
                            <select id="billing:region_id" name="billing[region_id]" title="<?php echo $this->__('State/Province') ?>" class="validate-select" style="display:none;">
                                <option value=""><?php echo $this->__('Please select region, state or province') ?></option>
                            </select>
                            <script type="text/javascript">
                            //<![CDATA[
                                $('billing:region_id').setAttribute('defaultValue',  "<?php echo $this->getAddress()->getRegionId() ?>");
                            //]]>
                            </script>
                            <input type="text" id="billing:region" name="billing[region]" value="<?php echo $this->escapeHtml($this->getAddress()->getRegion()) ?>"  title="<?php echo $this->__('State/Province') ?>" class="input-text <?php echo $this->helper('customer/address')->getAttributeValidationClass('region') ?>" style="display:none;" />
                        </div>
                    </div>
                </li>
                <li class="fields">
                    <div class="field">
                        <label for="billing:postcode" class="required"><em>*</em><?php echo $this->__('Zip/Postal Code') ?></label>
                        <div class="input-box">
                            <input type="text" title="<?php echo $this->__('Zip/Postal Code') ?>" name="billing[postcode]" id="billing:postcode" value="<?php echo $this->escapeHtml($this->getAddress()->getPostcode()) ?>" class="input-text validate-zip-international <?php echo $this->helper('customer/address')->getAttributeValidationClass('postcode') ?>" />
                        </div>
                    </div>
                    <div class="field">
                        <label for="billing:country_id" class="required"><em>*</em><?php echo $this->__('Country') ?></label>
                        <div class="input-box">
                            <?php echo $this->getCountryHtmlSelect('billing') ?>
                        </div>
                    </div>
                </li>
                <li class="fields">
                    <div class="field">
                        <label for="billing:telephone" class="required"><em>*</em><?php echo $this->__('Telephone') ?></label>
                        <div class="input-box">
                            <input type="text" name="billing[telephone]" value="<?php echo $this->escapeHtml($this->getAddress()->getTelephone()) ?>" title="<?php echo $this->__('Telephone') ?>" class="input-text <?php echo $this->helper('customer/address')->getAttributeValidationClass('telephone') ?>" id="billing:telephone" />
                        </div>
                    </div>
                    <div class="field">
                        <label for="billing:fax"><?php echo $this->__('Fax') ?></label>
                        <div class="input-box">
                            <input type="text" name="billing[fax]" value="<?php echo $this->escapeHtml($this->getAddress()->getFax()) ?>" title="<?php echo $this->__('Fax') ?>" class="input-text <?php echo $this->helper('customer/address')->getAttributeValidationClass('fax') ?>" id="billing:fax" />
                        </div>
                    </div>
                </li>
                <?php if(!$this->isCustomerLoggedIn()): ?>

        <?php $_dob = $this->getLayout()->createBlock('customer/widget_dob') ?>
        <?php $_gender = $this->getLayout()->createBlock('customer/widget_gender') ?>
            <?php if ($_dob->isEnabled() || $_gender->isEnabled()): ?>
                <li class="fields">
                <?php if ($_dob->isEnabled()): ?>
                    <div class="field">
                        <?php echo $_dob->setDate($this->getQuote()->getCustomerDob())->setFieldIdFormat('billing:%s')->setFieldNameFormat('billing[%s]')->toHtml() ?>
                    </div>
                <?php endif; ?>
                <?php if ($_gender->isEnabled()): ?>
                    <div class="field">
                        <?php echo $_gender->setGender($this->getQuote()->getCustomerGender())->setFieldIdFormat('billing:%s')->setFieldNameFormat('billing[%s]')->toHtml() ?>
                    </div>
                <?php endif ?>
                </li>
            <?php endif ?>

            <?php if ($this->isTaxvatEnabled()):?>
                <li><?php echo $this->getTaxvatHtml() ?></li>
            <?php endif; ?>

            <div class="fieldset">
            <ul class="form-list">
                <li class="fields">
                    <div class="field">
                        <label for="source" class="required"><em>*</em><?php echo $this->__('Where did you hear about us?') ?></label>
                        <div class="input-box">
                            <input type="text" name="source" id="source" title="<?php echo $this->__('source') ?>" class="input-text required-entry" />
                        </div>
                    </div>
                    <div class="field">
                        <label for="practitioner_referrer"><?php echo $this->__('Were you referrered by a practitioner, if so, who?') ?></label>
                        <div class="input-box">
                            <input type="text" name="practitioner_referrer" id="practitioner_referrer" title="<?php echo $this->__('practitioner_referrer') ?>" class="input-text" />
                        </div>
                    </div>
                </li>
            </ul>
        </div>

                <li class="fields" id="register-customer-password">
                    <div class="field">
                        <label for="billing:customer_password" class="required"><em>*</em><?php echo $this->__('Password') ?></label>
                        <div class="input-box">
                            <input type="password" name="billing[customer_password]" id="billing:customer_password" title="<?php echo $this->__('Password') ?>" class="input-text required-entry validate-password" />
                        </div>
                    </div>
                    <div class="field">
                        <label for="billing:confirm_password" class="required"><em>*</em><?php echo $this->__('Confirm Password') ?></label>
                        <div class="input-box">
                            <input type="password" name="billing[confirm_password]" title="<?php echo $this->__('Confirm Password') ?>" id="billing:confirm_password" class="input-text required-entry validate-cpassword" />
                        </div>
                    </div>
                </li>
                <?php echo $this->getChildHtml('persistent.remember.me'); ?>
                <?php endif; ?>
                <?php if ($this->isCustomerLoggedIn() && $this->customerHasAddresses()):?>
                    <li class="control">
                        <input type="checkbox" name="billing[save_in_address_book]" value="1" title="<?php echo $this->__('Save in address book') ?>" id="billing:save_in_address_book" onchange="if(window.shipping) shipping.setSameAsBilling(false);"<?php if ($this->getAddress()->getSaveInAddressBook()):?> checked="checked"<?php endif;?> class="checkbox" /><label for="billing:save_in_address_book"><?php echo $this->__('Save in address book') ?></label>
                    </li>
                <?php else:?>
                    <li class="no-display"><input type="hidden" name="billing[save_in_address_book]" value="1" /></li>
                <?php endif; ?>
                <?php echo $this->getChildHtml('form.additional.info'); ?>
            </ul>
            <?php echo $this->getChildHtml('persistent.remember.me.tooltip'); ?>
        </fieldset>
     </li>
    <?php if ($this->canShip()): ?>
        <li class="control">
            <input type="radio" name="billing[use_for_shipping]" id="billing:use_for_shipping_yes" value="1"<?php if ($this->isUseBillingAddressForShipping()) {?> checked="checked"<?php }?> title="<?php echo  $this->__('Ship to this address') ?>" onclick="$('shipping:same_as_billing').checked = true;" class="radio" /><label for="billing:use_for_shipping_yes"><?php echo  $this->__('Ship to this address') ?></label></li>
        <li class="control">
            <input type="radio" name="billing[use_for_shipping]" id="billing:use_for_shipping_no" value="0"<?php if (!$this->isUseBillingAddressForShipping()) {?> checked="checked"<?php }?> title="<?php echo $this->__('Ship to different address') ?>" onclick="$('shipping:same_as_billing').checked = false;" class="radio" /><label for="billing:use_for_shipping_no"><?php echo $this->__('Ship to different address') ?></label>
        </li>
    <?php endif; ?>
    </ul>
    <?php if (!$this->canShip()): ?>
        <input type="hidden" name="billing[use_for_shipping]" value="1" />
    <?php endif; ?>
    <div class="buttons-set" id="billing-buttons-container">
        <p class="required"><?php echo $this->__('* Required Fields') ?></p>
        <button type="button" title="<?php echo $this->__('Continue') ?>" class="button" onclick="billing.save()"><span><span><?php echo $this->__('Continue') ?></span></span></button>
        <span class="please-wait" id="billing-please-wait" style="display:none;">
            <img src="<?php echo $this->getSkinUrl('images/opc-ajax-loader.gif') ?>" alt="<?php echo $this->__('Loading next step...') ?>" title="<?php echo $this->__('Loading next step...') ?>" class="v-middle" /> <?php echo $this->__('Loading next step...') ?>
        </span>
    </div>
</fieldset>
</form>
<script type="text/javascript">
//<![CDATA[
    var billing = new Billing('co-billing-form', '<?php echo $this->getUrl('checkout/onepage/getAddress') ?>address/', '<?php echo $this->getUrl('checkout/onepage/saveBilling') ?>');
    var billingForm = new VarienForm('co-billing-form');

    //billingForm.setElementsRelation('billing:country_id', 'billing:region', '<?php echo $this->getUrl('directory/json/childRegion') ?>', '<?php echo $this->__('Select State/Province...') ?>');
    $('billing-address-select') && billing.newAddress(!$('billing-address-select').value);

    var billingRegionUpdater = new RegionUpdater('billing:country_id', 'billing:region', 'billing:region_id', <?php echo $this->helper('directory')->getRegionJson() ?>, undefined, 'billing:postcode');
    if ($('onepage-guest-register-button')) {
        Event.observe($('onepage-guest-register-button'), 'click', function(event) {
            var billingRememberMe = $('co-billing-form').select('#remember-me-box');
            if (billingRememberMe.length > 0) {
                if ($('login:guest') && $('login:guest').checked) {
                    billingRememberMe[0].hide();
                } else if ($('login:register') && ($('login:register').checked || $('login:register').type == 'hidden')) {
                    billingRememberMe[0].show();
                }
            }
        });
    }
//]]>
</script> 
```

任何帮助是极大的赞赏。

亲切的问候，

詹姆士

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T04:23:22.523

您的解决方案很好，它接近一个有效的解决方案，但是它缺少一些最后的润色。

请注意，客户可以通过两种方式注册 - 通过“注册”链接或在结帐期间。您只为 Checkout 过程提供了模板代码，所以我将只讨论它。“注册”链接的实现要简单得多，似乎在上面已经提供的文章中得到了很好的描述：[http ://www.fontis.com.au/blog/magento/know-more-about-your -customers-adding-custom-signup-attributes](http://www.fontis.com.au/blog/magento/know-more-about-your-customers-adding-custom-signup-attributes)

好的，关于结帐。当前解决方案的问题是：

1.  输入的名称错误。应该是`billing[<attribute_name>]`。
2.  数据需要在结帐过程中存储在某个地方（需要报价表中的新列）并在下订单时保存到客户资料中（需要字段集规则）

让我们来处理这些问题。

**模板文件**的修复很简单 - 只需重命名输入，它们应该是：

```
...

<input type="text" name="billing[source]" id="source" title="<?php echo 
$this->__('source') ?>" class="input-text required-entry" />

...

<input type="text" name="billing[practitioner_referrer]" id="practitioner_referrer"
title="<?php echo $this->__('practitioner_referrer') ?>" class="input-text" />

... 
```

这将使 Magento 在预期的位置找到输入的数据。

正确的 sql 文件（即**mysql4-upgrade-0.1.12-0.1.13.php**）应如下所示：

```
$installer->startSetup();

$installer->getConnection()->addColumn(
    $installer->getTable('sales/quote'),
    'customer_source',
    array(
        'type'      => Varien_Db_Ddl_Table::TYPE_TEXT,
        'length'    => '64K',
        'comment'   => 'Customer Source'
    )
);

$installer->getConnection()->addColumn(
    $installer->getTable('sales/quote'),
    'customer_practitioner_referrer',
    array(
        'type'      => Varien_Db_Ddl_Table::TYPE_TEXT,
        'length'    => '64K',
        'comment'   => 'Customer Practitioner Referrer'
    )
);

$installer->addAttribute('customer', 'source', array(
    'input' => 'text',
    'type' => 'varchar',
    'label' => 'Where did you hear about us?',
    'visible' => 1,
    'required' => 0,
    'position' => 1,
    'sort_order' => 80
));

$installer->addAttribute('customer', 'practitioner_referrer',
    array(
        'input' => 'text',
        'type' => 'varchar',
        'label' => 'Referring practitioner',
        'visible' => 1,
        'required' => 0,
        'position' => 1,
        'sort_order' => 80
    )
);

$installer->endSetup();

$customer = Mage::getModel('customer/attribute')->loadByCode('customer', 'source');
$forms= array('customer_account_edit', 'customer_account_create', 'adminhtml_customer', 'checkout_register');
$customer->setData('used_in_forms', $forms);
$customer->save();

$customer = Mage::getModel('customer/attribute')->loadByCode('customer', 'practitioner_referrer');
$forms= array('customer_account_edit', 'customer_account_create', 'adminhtml_customer', 'checkout_register');
$customer->setData('used_in_forms', $forms);
$customer->save(); 
```

在该文件中，我们不仅创建了客户属性，还创建了报价表中的相应列，输入的值将在结帐过程中存储在其中。

字段集应包括将数据从客户转换为报价的规则，反之亦然。这就是**config.xml**的样子：

```
<?xml version="1.0"?>
<!--
/**
 * @category   Symphony
 * @package    Symphony_Khaos
 * @author     ModuleCreator
 * @license    http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)
 */
 -->
<config>
    <modules>
        <Symphony_Khaos>
            <version>0.1.13</version>
        </Symphony_Khaos>
    </modules>
    <frontend>
        <routers>
            <khaos>
                <use>standard</use>
                <args>
                    <module>Symphony_Khaos</module>
                    <frontName>khaos</frontName>
                </args>
            </khaos>
        </routers>
        <layout>
            <updates>
                <khaos>
                    <file>khaos.xml</file>
                </khaos>
            </updates>
        </layout>
    </frontend>
    <admin>
        <routers>
            <khaos>
                <use>admin</use>
                <args>
                    <module>Symphony_Khaos</module>
                    <frontName>khaos</frontName>
                </args>
            </khaos>
        </routers>
    </admin>
    <adminhtml>
        <menu>
            <khaos module="khaos">
                <title>Khaos</title>
                <sort_order>71</sort_order>
                <children>
                    <items module="khaos">
                        <title>Manage Items</title>
                        <sort_order>0</sort_order>
                        <action>khaos/adminhtml_khaos</action>
                    </items>
                </children>
            </khaos>
        </menu>
        <acl>
            <resources>
                <all>
                    <title>Allow Everything</title>
                </all>
                <admin>
                    <children>
                        <Symphony_Khaos>
                            <title>Khaos Module</title>
                            <sort_order>10</sort_order>
                        </Symphony_Khaos>
                    </children>
                </admin>
            </resources>
        </acl>
        <layout>
            <updates>
                <khaos>
                    <file>khaos.xml</file>
                </khaos>
            </updates>
        </layout>
    </adminhtml>
    <global>
        <models>
            <khaos>
                <class>Symphony_Khaos_Model</class>
                <resourceModel>khaos_mysql4</resourceModel>
            </khaos>
            <khaos_mysql4>
                <class>Symphony_Khaos_Model_Mysql4</class>
                <entities>
                    <khaos>
                        <table>khaos</table>
                    </khaos>
                </entities>
            </khaos_mysql4>
        </models>
        <resources>
            <khaos_setup>
                <setup>
                    <module>Symphony_Khaos</module>
                    <class>Mage_Customer_Model_Entity_Setup</class>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </khaos_setup>
            <khaos_write>
                <connection>
                    <use>core_write</use>
                </connection>
            </khaos_write>
            <khaos_read>
                <connection>
                    <use>core_read</use>
                </connection>
            </khaos_read>
        </resources>
        <blocks>
            <khaos>
                <class>Symphony_Khaos_Block</class>
            </khaos>
        </blocks>
        <helpers>
            <khaos>
                <class>Symphony_Khaos_Helper</class>
            </khaos>
        </helpers>
        <fieldsets>
            <customer_account>
                <source><to_quote>customer_source</to_quote></source>
                <practitioner_referrer><to_quote>customer_practitioner_referrer</to_quote></practitioner_referrer>
            </customer_account>
            <checkout_onepage_quote>
                <customer_source><to_customer>source</to_customer></customer_source>
                <customer_practitioner_referrer><to_customer>practitioner_referrer</to_customer></customer_practitioner_referrer>
            </checkout_onepage_quote>
        </fieldsets>
    </global>
</config> 
```

注意两点：

*   `<create>`和`<update>`指令已被删除，因为 Checkout 注册不需要它们。如果需要，您可以将它们添加回来。
*   自定义设置模型`Symphony_Khaos_Model_Entity_Setup` 已被删除，取而代之的是`Mage_Customer_Model_Entity_Setup`. 客户设置模型足以完成所有任务。具有自定义设置模型的文件可能会被完全删除。如果您需要它用于其他任务，您可以返回自定义模型。

瞧——就是这样！这些修复将使客户在结帐注册期间看到两个额外的字段。提交订单时，数据将保存到他的个人资料中。

然而，实现并不是最好的，因为它是基于这种方法的，它有一些缺点。该方法需要将数据存储在 Quote 表中，而这些数据条目与 Quote 模型无关。他们只是将其用作交通工具。此外，将来添加新属性需要做太多工作 - 必须对 sql 文件、配置和模板进行修改。

一个正确的方法是构建一个更抽象的实现。该解决方案应将属性数据存储在 EAV 或自定义表中，并在需要时通过观察到的事件将它们添加到客户/报价模型中。模板应该显示一个通用的属性列表，可能需要特殊设计的特殊渲染模型。

但是对于只有 2 个属性，您的方法很好。

祝您与 Magento 的进一步合作顺利:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:15:15.590

我认为您已经引用了旧文章，因此您对创建的属性进行了错误配置。

```
$installer->addAttribute('customer', 'practitioner_referrer', array(  
   'type' => 'int',  
   'input' => 'select',  
   'label' => 'Referer Name',
   'global' => 1,
   'visible' => 1,
   'required' => 0,
   'user_defined' => 1,
   'default' => '0',
   'visible_on_front' => 1  
)); 
```

试试这个，让我知道结果。

# jboss - 将 JBoss BRMS (Drools) 更改为使用 Oracle 11g：无法构建包

> ID：13479369
> 
> 赞同：0
> 
> 时间：2012-11-20T18:06:32.953
> 
> 标签：jboss, oracle11g, drools, guvnor

我正在使用 Guvnor (JBoss BRMS) 来管理部署在 JBoss EAP 5.3 中的 drools 规则引擎。我已将 Guvnor 更改为使用 Oracle 11g 实例作为它的 RDBMS。我使用 Guvnor 生成了一个新的 repository.xml 并将其放入 JBoss 目录的“bin”文件夹中。Guvnor 和 Drools 运行良好，似乎很高兴连接到 Oracle 11g 实例。

然后我继续创建一个包并添加一个新规则。我添加的规则如下：

```
dialect "mvel"

rule "TimeToClearRule"
when
    #conditions
then
    #actions
end 
```

我验证了这个规则，然后重建了包。一切正常！

但是，我随后在规则上方添加了一个函数，目的是在规则中使用它。规则更改为以下内容：

```
dialect "mvel"

function double logNormalPdf(double mu, double sigma, double timeT) {
    return 0.0;
}

rule "TimeToClearRule"
when
    #conditions
then
    #actions
end 
```

我验证了这个规则并重建了包。但是，随后抛出了一个错误。它无法“保存项目”。在我的 JBoss 日志中，显示了以下错误（注意：不是完整的堆栈跟踪，仅添加了我认为是根本原因的内容）

```
 17:59:51,815 ERROR [BundleWriter] Error while storing blob. id=9d26c61c-4dde-4009-a518-1f226431aa80/{http://www.jboss.org/drools-repository/1.0}compiledPackage idx=0 size=4353
 java.lang.IllegalStateException: Unable to insert index for string: compiledPackage
at org.apache.jackrabbit.core.persistence.pool.NGKDbNameIndex.insertString(NGKDbNameIndex.java:66)
at org.apache.jackrabbit.core.persistence.pool.DbNameIndex.stringToIndex(DbNameIndex.java:95)
at org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager$DbBlobStore.createId(BundleDbPersistenceManager.java:1334)

Caused by: java.sql.SQLIntegrityConstraintViolationException: ORA-01400: cannot insert NULL into ("DROOLS"."PM_WS_DEFAULT_NAMES"."ID")

at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:445)
at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:396)
at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:879) 
```

当 Drools/Guvnor 使用默认 DBMS 解决方案时，规则验证并构建良好。自从将 DBMS 移至 Oracle 11g 后，无法再验证规则并构建包。

我不知道为什么会这样。提供的任何帮助将不胜感激。

谢谢

**更新**是的，我发现我认为是问题所在。我在上面的示例中遗漏了一些东西，我发现这是导致错误的原因。我正在使用“数学”函数（java.lang.Math），这似乎导致了上面显示的错误。我正在创建的规则如下：

```
import java.lang.Math

dialect "mvel"

function double logNormalPdf(double mu, double sigma, double timeT) {
    return Math.log(2);
}

rule "TimeToClearRule"
when
    #conditions
then
    #actions
end 
```

drools/guvnor 可以处理数学函数吗？如果没有，我该如何使用它？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T21:35:15.067

您的数据库配置似乎有问题，guvnor / jackrabbit 可能无法在 oracle 存储库中创建所有必要的表。尝试与新的 oracle 模式建立新的数据库连接。

# c# - 如何验证进程文件名可以在开始之前执行？

> ID：13479371
> 
> 赞同：0
> 
> 时间：2012-11-20T18:06:38.170
> 
> 标签：c#, system.diagnostics

编辑：我并不是要把这个问题钉在一个特定的可执行文件上。我希望这适用于任何可执行文件。如果我要在运行对话框中输入 FileName，结果是“Windows 找不到 ...”对话框，那么我不想启动该过程。下面更新...

我想在我的程序中执行“可执行文件”，但如果用户没有安装可执行文件，我想运行另一个进程。如何在实际启动 visio 安装在系统上的 visio 进程之前检查？我不想弹出“Windows 找不到”可执行文件“...

这是我的代码。但这确实会弹出“Windows 找不到“可执行文件”..”错误。

```
System.Diagnostics.Process myProc = new System.Diagnostics.Process();
myProc.StartInfo.FileName = "an executable.exe";
myProc.StartInfo.Arguments = "MyDoc.txt";
myProc.StartInfo.WorkingDirectory = "C:\MyFolder";

try
{
    if( !myProc.Start() )
    {
        myProc.StartInfo.FileName = "another process.exe";
        myProc.Start();
    }
}
catch (Exception ex)
{
    ...
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:23:18.440

我会在注册表中查找 HKEY_CLASSES_ROOT\Visio.Application 。如果不存在，则不安装。如果它确实存在，CurVer 子键会给你类似 Visio.Application.12 告诉你安装的默认版本（可能是其他版本）

HKEY_CLASSES_ROOT\Visio.Application.12 Sub Key CLSID 会给你一个 guid：{00021A20-0000-0000-C000-000000000046}

HKEY_CLASSES_ROOT\CLSID{00021A20-0000-0000-C000-000000000046} 会依次为您提供子密钥“LocalServer32”，其中将包含 EXE 的路径。

C:\PROGRA~1\MICROS~4\Office12\VISIO.EXE /自动化

您还可以查看此 API 以及[GetBinaryType Function (Windows)](http://msdn.microsoft.com/en-us/library/aa364819%28VS.85%29.aspx)

如果您知道应该安装程序的实际文件路径，您还可以进行以下检查

好吧，如果您想查看某个程序是否存在于您要查找的位置（例如 Visio.exe），您可以调用：

```
System.IO.File.Exists("path_to_program.exe"); 
```

如果它返回 true，那么您知道您的程序存在并且您可以使用您的流程运行程序代码运行它。如果它返回 false，那么您知道它不存在并且您不应该启动您的进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:20:29.527

首先要做的是在计算机上找到 visio.exe。这可能意味着从注册表中读取安装位置，然后验证该位置是否存在 visio.exe。如果找不到正确的注册表项或文件不存在，则可以合理地假设未安装 Visio。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T18:35:18.963

**tldr; *其他*原因导致“Windows 找不到 ..”对话框- 异常处理代码是什么**样的？

在没有 Visio 的系统上，代码

```
System.Diagnostics.Process myProc = new System.Diagnostics.Process();
myProc.StartInfo.FileName = "visio.exe";
myProc.StartInfo.Arguments = "MyVisioDoc.vsd";
myProc.StartInfo.WorkingDirectory = "C:\\MyVisioFolder"; // fixed literal
myProc.Start(); 
```

导致抛出有用的异常

> Win32Exception: 系统找不到指定的文件

虽然这将导致 Visio 在找到时运行*，但*如果未找到 Visio，则显示对话框消息框没有内在原因。这不是正常的行为。

现在，如果`MyVisioDoc.vsd`直接通过（例如使用[Open Verb](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.verb.aspx)）启动，那么是的，这将传递给 Windows 系统，并且如果`.vsd`文件与丢失的 Visio 应用程序*相关联*，则可能会导致这样的对话框。但是，这是与本文中介绍的情况*不同*的情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T18:32:28.210

您可以在注册表中检查这一点。

试试这个代码：

```
 public static class ProgramHelper
    {
        public static bool IsProgramInstalled(string displayName, bool x86Platform)
        {
            string uninstallKey = x86Platform
                                      ? @"SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall"
                                      : @"SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall";

            using (RegistryKey rk = Registry.LocalMachine.OpenSubKey(uninstallKey))
            {
                if(rk != null)
                    foreach (string skName in rk.GetSubKeyNames())
                    {
                        using (RegistryKey sk = rk.OpenSubKey(skName))
                        {
                            if (sk != null && sk.GetValue("DisplayName") != null &&
                                sk.GetValue("DisplayName").ToString().ToUpper().Equals(displayName.ToUpper()))
                            {
                                return true;
                            }

                        }
                    }
            }
            return false;
        }
    } 
```

您可以像这样调用它：

```
ProgramHelper.IsProgramInstalled("Microsoft Visio Standard 2010", true);
ProgramHelper.IsProgramInstalled("Microsoft Visio Premium 2010", true); 
```

# jquery - jQuery .each() 循环变得疯狂

> ID：13479373
> 
> 赞同：1
> 
> 时间：2012-11-20T18:06:45.283
> 
> 标签：jquery, each

我有大约 25 组 div 容器，其子容器共享相同的父/子类名称，每个组还有一个空的 div 容器。

```
<div class="parent">
    <div class="child">
        child content1
    </div>
</div>
<div class="empty"></div>

<div class="parent">
    <div class="child">
        child content2
    </div>
</div>   
<div class="empty"></div>

.....

<div class="parent">
    <div class="child">
        child content25
    </div>
</div>  
<div class="empty"></div> 
```

我想将每个“子”div 元素附加到“空”div 容器中，这样它看起来像：

```
<div class="parent">
    <div class="child">
        child content1
    </div>
</div>
<div class="empty">
    <div class="child">
        child content1
    </div>
</div>

<div class="parent">
    <div class="child">
        child content2
    </div>
</div>
<div class="empty">
    <div class="child">
        child content2
    </div>
</div>

....

<div class="parent">
    <div class="child">
        child content25
    </div>
</div>
<div class="empty">
    <div class="child">
        child content25
    </div>
</div> 
```

我使用了以下代码：

```
$('.parent').each(function(){    
    $(this).find('div').appendTo('.empty');
}); 
```

但结果显示“子” div 元素及其内容对于每个组循环到“空” div 25 次，即 25x25=625 个新的“子” div！快疯了！！！！！！！！！！！！

有人可以帮忙吗？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:09:05.387

.next() 可能会更好吗？

```
$('.parent').each(function(){   
       var parent = $(this);
       var child = parent.children('.child');
       parent.next('.empty').append(child.clone());
}); 
```

在稍微弄乱了实现之后，这是一个小提琴-> [http://jsfiddle.net/g9G85/8/](http://jsfiddle.net/g9G85/8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:25:25.677

[这](http://jsfiddle.net/tf3HM/)看起来像你想要的：

```
<div class="parent">
    <div class="child">
        child content1
    </div>
</div>
<div class="empty"></div>

<div class="parent">
    <div class="child">
        child content2
    </div>
</div>   
<div class="empty"></div>​ 
```

JS：

```
$('.parent').each(function() {
    var parent= $(this);
    var child = parent.children('.child');
    parent.next('.empty').append(child.clone());
});​ 
```

# php - 在 Zend_Form 类中的 addElement() 上使用 Between 验证器

> ID：13479375
> 
> 赞同：2
> 
> 时间：2012-11-20T18:07:01.230
> 
> 标签：php, validation, zend-framework

我正在 Zend 1.12 中构建一个基本的 Zend_Form 来获取新员工的出生日期和雇用日期。我想对日期做一个非常基本的验证——此时我并不关心像 2 月 30 日这样的胡说八道的日期；我只想在各个输入字段上获得 1900-9999、1-12、1-31 之类的范围。

表单将加载下面的代码，但如果年份 (1982) 或无效 (2)，我在提交时收到应用程序错误：“缺少选项。必须给出‘min’和‘max’”

我认为我的语法不正确。

```
$this->addElement('text', 'byear', array(
        'label'      => 'Birth Date :: Year:',
        'required'   => true,
        'style' => 'width:75px;',
        'filters'    => array('StringTrim'),
        'decorators' => array('Label',
        'ViewHelper'),
        'validators' => array(
            array('Between', 1900, 9999))
    )); 
```

这也不起作用：

```
'validators' => array(array('Between', 'min' => 1900, 'max' => 9999)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:18:29.700

尝试

```
'validators' => array(
    array('Between', false, array('min' => 1900, 'max' => 9999))
 ) 
```

# java - Android 测试：检查 LeftDrawable 图像是否正确

> ID：13479377
> 
> 赞同：2
> 
> 时间：2012-11-20T18:07:05.707
> 
> 标签：java, android, testing, button, activityunittestcase

**被测试的方法**（在主要活动中）

```
//This Method allows you to set the LeftDrawable Image to a grayed out (drawableDown)
//image for 300 millseconds then returns the LeftDrawable Image back to the orignal 
//(drawableUp).On a button.

void buttonPressFeedbackLeft(final Button button, final int drawableDown,
        final int drawableUp) {
    button.setCompoundDrawablesWithIntrinsicBounds(drawableDown, 0, 0, 0);

    button.postDelayed(new Runnable() {
        public void run() {
            button.setCompoundDrawablesWithIntrinsicBounds(drawableUp, 0,
                    0, 0);
        }
    }, 300);
} 
```

**测试项目中的测试：（**活动和 i（意图）已设置）

```
public void testbuttonPressFeedback(){
         /*
          * Start activity
          */
         activity = startActivity(i, null, null);

         /*
          * get the backButton
          */
         Button backButton = (Button) activity.findViewById(R.id.bottem_bar_prev);

         /*
          * get the backButton image (up and down image) as a Drawable
          */
         int drawableDown = R.drawable.ic_menu_back_gray;
         int drawableUp = R.drawable.ic_menu_back;
         /*
          * create a Drawable with the ResId
          */
         Drawable drawableDownImage = activity.getResources().getDrawable(drawableDown);
         Drawable drawableUpImage = activity.getResources().getDrawable(drawableDown);

         /*
          * Simulate button being pressed (running the buttonPressFeedback() method)
          */
         activity.buttonPressFeedbackLeft(prevButton, drawableDown, drawableUp);

         /*
          * get the drawable array [left, top, right, bottom]
          * compare drawable with the drawable found on the button.
          */
         Drawable[] d = prevButton.getCompoundDrawables();
         assertEquals(drawableDownImage,d[0]);
 } 
```

堆栈跟踪：

> junit.framework.AssertionFailedError：预期：android.graphics.drawable.BitmapDrawable@413e7428 但是：android.graphics.drawable.BitmapDrawable@413e75c0

**问题**

我假设对象不一样。所以我试图研究获取资源 ID 并比较它们，但我认为这不可能？

还有另一种方法来比较按钮上显示的 Drawable 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T23:24:48.193

遗憾的是，如果您的代码中没有任何工作，这是不可能的，因为您正确地注意到没有办法从中获取可绘制资源 ID。你要做的是在你的代码中设置drawable让它做一些事情，比如在imageview上设置一个标签，并用它来检查它是否有正确的标签。尽管这可能是对您的欺骗，并且不是一个精确的测试，但只要您测试此按钮的所有状态以及应该显示什么可绘制对象，它可能就足够了。因此，在同一视图上设置 Drawable id 后，调用 setTag(R.id.xxx) 为其提供与您期望的 drawabe 相关的 int。

# magento - Magento sales_order_payment_pay 观察者不触发

> ID：13479378
> 
> 赞同：5
> 
> 时间：2012-11-20T18:07:07.937
> 
> 标签：magento, observers

我正在尝试将信息从我的 magento 安装发送到 dropshipper。这显然应该在付款完成后立即发生。据我所知，Magento 有观察者，付款完成后应该被解雇。

我有以下文件，但观察者似乎从未被解雇：app/etc/modules/SPB_Coreextended.xml：

```
<?xml version="1.0"?>
<config>
    <modules>
        <SPB_Coreextended>
            <active>true</active>
            <codePool>local</codePool>          
        </SPB_Coreextended>
    </modules>
</config> 
```

应用程序/代码/本地/SPB/Coreextend/etc/config.xml：

```
<?xml version="1.0"?>
<config>
    <modules>
        <SPB_Coreextended>
            <version>0.2.0</version>
        </SPB_Coreextended>
    </modules>
    <frontend>
        <routers>
            <checkout>
                <args>
                    <modules>
                        <SPB_Coreextended before="Mage_Checkout">SPB_Coreextended_Checkout</SPB_Coreextended>
                    </modules>
                </args>
            </checkout>
        </routers>
    </frontend>
    <global>
        <models>
            <SPB_Coreextended>
                <class>SPB_Coreextended_Model</class>
            </SPB_Coreextended>
        </models>      
        <events>
            <sales_order_payment_pay>
                <observers>
                    <SPB_Coreextended>
                        <type>singleton</type>
                        <class>SPB_Coreextended/Observer</class>
                        <method>sendOrder</method>
                    </SPB_Coreextended>
                </observers>
            </sales_order_payment_pay>     
        </events>
     </global>
</config> 
```

应用程序/代码/本地/SPB/Coreextend/Model/Observer.php：

```
<?php
class SPB_Coreextended_Model_Observer 
{
    public function sendOrder($observer) {
        Mage::log("New order");
        $order = $observer->getInvoice()->getOrder(); // Mage_Sales_Model_Order
        Mage::log("New order");     
    }
}
?> 
```

如您所见，我还从 config.xml 调用了另一个方法，该方法确实有效。所以我很确定问题出在我的观察者的 config.xml 部分。我似乎无法找到它失败的地方。

谢谢您的帮助！

# c++ - 有什么可以区分在用户与 C++ 的会话中运行的微软系统进程吗？

> ID：13479384
> 
> 赞同：1
> 
> 时间：2012-11-20T18:07:29.710
> 
> 标签：c++, windows, winapi, process

只是好奇，比如说，如果我枚举一个用户会话中运行的所有进程，有没有办法分辨哪些是 Windows 系统进程（例如 explorer.exe、taskhost.exe、dwm.exe 等）以及哪些是已启动的进程由用户？

# git - 将 Git 提交移动到目录

> ID：13479385
> 
> 赞同：0
> 
> 时间：2012-11-20T18:07:31.320
> 
> 标签：git, directory, commit, rebase

我有 4 个存储库，每个存储库都有系统模块的源代码。

现在，我想将它们全部加入一个保存历史的存储库中。但是，在这四个 repos 中，代码位于根文件夹中，在新的 repo 中，我需要将每个模块放在它自己的子文件夹中。

我希望，在历史上，看起来提交总是在子文件夹中进行。诸如“重新设置文件夹内的所有提交”之类的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:13:39.957

有一个类似的东西，它被称为`git submodule`。

# html - 在表格单元格内显示 div 并调整大小

> ID：13479386
> 
> 赞同：0
> 
> 时间：2012-11-20T18:07:31.287
> 
> 标签：html, css

我在一个表格单元格中有一个 div，其 css 值为 display:none。当我 $.show() 它时，单元格会稍微向右扩展。当我使用可见属性而不是 display:none 时，这可以正常工作，但如果不需要，我不想保留高度。我尝试了各种显示属性以及重新排列 css 宽度、边距和填充，以及删除背景图像。

```
 <div id='1'>
<table>
    <tr>
        <td>
            <div class='container'>
                <div class='error'>I am some long ass error that breaks my layout and I can't figure out what to do.</div>
                <div>header</div>
                <div>
                    <input type='button' value='add to cart'/>
                </div>
            </div>

        </td>
        <td>
<div class='container'>
                <div class='error'>I am some long ass error that breaks my layout and I can't figure out what to do.</div>
                <div>header</div>
                <div>
                    <input type='button' value='add to cart'/>
                </div>
            </div>
        </td>
        <td>
            <div class='container'>
                <div class='error'>I am some long ass error that breaks my layout and I can't figure out what to do.</div>
                <div>header</div>
                <div>
                    <input type='button' value='add to cart'/>
                </div>
            </div>
        </td>
    </tr>
</table>
</div>

    #1{width:400px;}
table {width:100%;}
tr {border: solid grey;}
.container{
    border-right: 1px dotted #A5A5A5;
    margin: 25px 0;
}
div {

    display:block;
    margin:auto;
    text-align:center;
}
.error {
    display:none;
    padding-left:20px;
    width:80px;
    table-layout:fixed;
} 
```

这是一个[显示问题的小提琴](http://jsfiddle.net/kv6DS/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:55:36.720

对 CSS 执行此操作。当表格宽度未定义或非常小时，这可能不起作用。

```
table {width:100%; table-layout: fixed;} 
```

或者

```
td {width: 33.33%;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:51:35.557

虽然向 .container 添加静态宽度将解决您的问题，如下所示：

```
.container{
   border-right: 1px dotted #A5A5A5;
   float: left;
   margin: 25px 0;
   width: 250px; 
} 
```

我可能会建议将表格和其中一些 div 包装器一起取消，并使用更具语义性的东西。看起来它更像是一个项目列表而不是表格数据，因此您可以考虑将其放入无序列表中。

我在这里提出了一个工作示例：http: [//jsfiddle.net/ZYztj/](http://jsfiddle.net/ZYztj/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:09:29.503

添加两个属性`cellspacing="0"`,`cellpading="0"`到`<table>`, 和 CSS 规则：

```
tr, td {
    margin: 0;
    padding: 0;
} 
```

将完全解决您的问题并跨浏览器。

[这是小提琴](http://jsfiddle.net/mArvb/)

此外，切勿使用以数字开头的 id 名称，例如`#1`，因为它在某些浏览器中可能会失败。

# performance - PHP5-FPM 进程在访问大型 PHP 文件时消耗 100% 的 CPU

> ID：13479387
> 
> 赞同：0
> 
> 时间：2012-11-20T18:07:35.937
> 
> 标签：performance, nginx, php

我有一个非常奇怪的问题。服务器上有一个 test.php 文件，它有大约 3k 行代码 (100 kB)。代码什么都不做，它是一个具有许多参数和函数的相当大的类的定义，但该类永远不会被实例化或以任何方式使用。

我以每秒 100 个请求的速率访问 test.php，直到它被访问 1000 次。之后，我确保服务器平静并再次运行测试。前几次运行通常很好。然后以下运行有一些超时请求。下一次运行有更多的超时请求。然后如果我再做一次，几乎所有请求都会失败，同时`top`显示几个 php5-fpm 正在做一些需要 100% CPU 的事情。服务器通常需要几分钟才能平静下来，在这种状态下，任何尝试执行 HTTP 请求都会导致 504 错误。

使用静态文件（例如 test.html）或只有 php 开闭标签的空 test2.php 进行相同的测试，不会产生有趣的结果，一切运行顺利。

服务器是 Nginx AWS EC2 实例。到目前为止，我尝试使用配置但没有运气。以下是一些可能相关的参数。

```
root@ip-...:~# cat /proc/cpuinfo
processor   : 0
vendor_id   : GenuineIntel
cpu family  : 6
model       : 23
model name  : Intel(R) Xeon(R) CPU           E5430  @ 2.66GHz
stepping    : 10
cpu MHz     : 2659.994
cache size  : 6144 KB
fdiv_bug    : no
hlt_bug     : no
f00f_bug    : no
coma_bug    : no
fpu     : yes
fpu_exception   : yes
cpuid level : 13
wp      : yes
flags       : fpu tsc msr pae cx8 cmov pat pse36 clflush dts mmx fxsr sse sse2 ss ht pbe nx lm constant_tsc up arch_perfmon pebs bts aperfmperf pni dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm dca sse4_1 lahf_lm dts tpr_shadow vnmi flexpriority
bogomips    : 5319.98
clflush size    : 64
cache_alignment : 64
address sizes   : 38 bits physical, 48 bits virtual
power management:

root@ip-...:~# nproc
1 
```

**www.conf**

```
pm.max_requests = 500
pm.max_children = 5
pm = dynamic 
```

**nginx.conf**

```
worker_processes 4;
events {
    worker_connections 768;
}
http {
    gzip on;
    client_body_timeout 300;
    client_header_timeout 300;
    send_timeout 300;
    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout 65;
    types_hash_max_size 2048;
} 
```

我尝试将其减少到 1 个 nginx worker + 1 个 php child 以及玩其他一些东西，但这些东西似乎都没有任何区别。据我所知，内存永远不会被交换。任何关于其他可以调试或检查的想法，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T10:52:44.360

使用`apc`. 这会将解析后的 PHP 文件缓存为操作码，并一遍又一遍地跳过解析它。

# c# - 专门填充 DataGridView 中的组合框

> ID：13479390
> 
> 赞同：-1
> 
> 时间：2012-11-20T18:07:43.423
> 
> 标签：c#, .net

我在网格的特定列中添加了一个组合框，并且我已经填充了它。因此，当网格填充时，组合框也会填充预定义的值。我正在尝试像这样过滤特定的行：如果第 1 列的值为“一”，我需要用“一”、“二”和“三”填充组合框，否则我的组合框需要具有预定义的值。从某种意义上说，我需要访问每一行中的控件。这有可能吗？

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:14:00.367

我想我明白你想要什么，你可以在数据网格事件的表单加载事件中填充你的组合框，你可以访问网格中每一行的组合框

```
private void form1_load(object sender, EventArg e)
{
     for (int i = 0; i < gridView1.Rows.Count; ++i)
     {
         DataGridViewComboBoxCell cell = gridView1.Rows[i].Cells[5] as DataGridViewComboBoxCell;
         if (gridView1.Rows[i].Cells[1].Value.ToString() == "one")
         {
             cell.Items.Clear();
             cell.Items.Add("one");
             cell.Items.Add("two");
             cell.Items.Add("three");
         }
     }
} 
```

我假设带有组合框的列在网格中的索引为 5。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:16:16.317

如果您正在寻找自动完成，请尝试设置 ComboBox Prorperties 的以下值

```
1\. Set AutoCompleteMode = SuggestAppend
2\. Set AutoCompleteSource = ListItems 
```

如果您从数据源绑定，那么您可以在后面的代码中进行设置

# android - SoundPool 流

> ID：13479391
> 
> 赞同：2
> 
> 时间：2012-11-20T18:07:44.150
> 
> 标签：android, soundpool

所以我有 soundpool OnLoadCompleteListener ，它有这个代码 mStreamId = soundPool.play(sampleId, 1, 1, 1, 0, 1f); 我有 2 个按钮可以播放不同的声音池。我使用 mStreamId 来停止声音池。我的问题是，当我单击第一个按钮并播放声音并且单击第二个按钮时，它将停止第一个按钮的声音。这是我的代码：

```
 public class MainActivity extends Settings {
        SoundPool mSoundPool;
        int mSoundId;
        int mStreamId = 0;
    @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);
            this.setVolumeControlStream(AudioManager.STREAM_MUSIC);
    mSoundPool = new SoundPool(5, AudioManager.STREAM_MUSIC, 0);
            mSoundPool
                    .setOnLoadCompleteListener(new SoundPool.OnLoadCompleteListener() {
                        public void onLoadComplete(SoundPool soundPool,
                                int sampleId, int status) {
                            mStreamId = soundPool.play(sampleId, 1, 1, 1, 0, 1f);
}
                });

    }
//OnClick
public void button1(View view) {
        if (mStreamId != 0) {
            mSoundPool.stop(mStreamId);
        }

        String path = getFullFilePath(getApplicationContext(), et1.getText()
                .toString());
        mSoundId = mSoundPool.load(path, 1);
    }
public void button2(View view) {
        if (mStreamId != 0) {
            mSoundPool.stop(mStreamId);
        }

        String path = getFullFilePath(getApplicationContext(), et2.getText()
                .toString());
        mSoundId = mSoundPool.load(path, 1);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T15:40:00.783

将 soundId 和 streamId 分开保存。

onLoadComplete 在加载后调用，所以当你按下 button2 时，streamId 就是 button1 播放的声音的 id。

# php - 跨页面的 PHP 会话

> ID：13479392
> 
> 赞同：1
> 
> 时间：2012-11-20T18:07:53.737
> 
> 标签：php, session

有这个问题。我知道互联网上有很多这样的问题，但似乎没有一个对我有用:(

所以我打算在网站上制作一个管理面板。您通过登录屏幕进入，当名称+密码正确时，会进行会话。在其他管理页面上，我将测试是否设置了此会话，由此我将知道用户是否可以访问该页面。

Inlog.php（简化版）

```
<?php session_start(); ?> <html ... 
```

然后经过大量控制

```
 if ($adminpwd == $pass) {
    session_regenerate_id();
    $_SESSION["mysessionname"] = $name;
    $tijd = date('H:i:s', strtotime('+ 30 minutes'));
    $_SESSION["E4A_einde"] = $tijd;
    session_write_close();
echo "<script type='text/javascript'>window.location = 'myotheradminpage'</script>";
} 
```

我的其他 php 页面包括此脚本

```
<?php session_start();
if (!isset($_SESSION["mysessionname"])) {

session_destroy();
echo '<SCRIPT LANGUAGE="JavaScript"> window.alert("no session found") </SCRIPT>';
echo "<script type='text/javascript'>window.location = 'myloginpage'</script>";
        } 
```

使用此元素，如果未设置会话，则会进行重定向，如果设置了会话，则将触发 php 页面上的其他代码。

但事实是，每次我再次被重定向到我的登录页面。所以我的会话没有设置：s 不知道为什么，所以请帮帮我。

我在每个页面上都尝试了很多方法来添加 session_start() 方法，我尝试在设置会话之前重新生成会话 ID，但没有任何效果..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:13:29.660

在 HTML 之前的初始`session_start`设置中，尝试设置：

```
<?php session_start();  
$_SESSION["mysessionname"]; ?>
<html ... 
```

这将在任何运行之前声明您的会话变量。

让我知道这个是否奏效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:19:50.283

放下`session_regenerate_id`. 它发送另一个 cookie，但输出已经发送。

同时挂断电话`session_write_close`。无论如何，它都会发生在脚本的末尾，并且这种微优化会对代码库的质量产生负面影响。如果您有并发问题，请使用`memcached`会话存储，但您离那里还很远。

也挂断`session_destroy`电话。如果他没有被授权，那么他就没有被授权。您在这里的逻辑建议清除已经为空的会话。

# javascript - 获取最后一个事件数据

> ID：13479394
> 
> 赞同：0
> 
> 时间：2012-11-20T18:08:03.893
> 
> 标签：javascript, jquery

我正在使用一个外部 jquery 插件（iosSlider。但它没有遇到）。当我单击鼠标并移动它时，插件会触发一个事件。该插件触发事件并向侦听器提供数据。但是，它不提供原始事件对象。原始事件对象包含插件提供的数据中没有的数据。有什么办法可以获取最后一个事件发生的数据吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:00:08.897

获取插件源，找到将“原始事件”转换为您所获得的“淡化”版本的代码，并将原始事件作为附加字段添加到淡化版本中。

前：

```
handleOriginalEvent(e) {
    // ...
    var wateredDownEvent = { /*...*/ };
    // call event handler with wateredDownEvent
} 
```

后

```
handleOriginalEvent(e) {
    // ...
    var wateredDownEvent = { /*...*/, original: e };
    // call event handler with wateredDownEvent, now with added original event
} 
```

# python - Python PDB 只进入单个文件？

> ID：13479397
> 
> 赞同：2
> 
> 时间：2012-11-20T18:08:09.397
> 
> 标签：python, pdb

我正在尝试调试一个相当复杂的 django 项目，该项目显然对内置函数、其他类和其他自定义方法有大量调用。我想要做的就是将 pdb.set_trace() 放在我关心的文件中（即产品的价值），当我在 PDB 中执行步骤命令时，让它去我的其他功能在该文件中调用。我不希望它转到任何其他文件、django 方法或 python 低级代码。

这可能吗？

作为说明，我已经在使用令人惊叹的[pdb++](http://pypi.python.org/pypi/pdbpp/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:16:42.967

当然。只需将`set_trace()`调用放在该模块中，如果需要，使用该`b`命令为其他函数添加额外的断点，或使用多个`set_trace()`调用。

然后，在单步执行代码时，使用`n`(或`next`) 跳过可能会将您带出模块的函数调用。或者使用`unt`( `until`) 运行代码，直到执行下一行（使用它来退出长循环）。每当解释器遇到您的一个断点或`set_trace()`调用它时，它都会停在那里，无论如何。

# javascript - 如何在 Javascript/Ajax 中调用特定文件夹

> ID：13479399
> 
> 赞同：0
> 
> 时间：2012-11-20T18:08:16.757
> 
> 标签：javascript, ajax

我创建了一个组合 ajax 选择菜单并在 localhost 上运行它。我只是尝试将文件移动到将其设置为模板的 wordpress 配置中，但由于 .js 文件调用其他文件的路径，我遇到了问题。

有没有办法可以调用直接路径？JS 看起来像这样：

```
 $(document).ready(function(){
        $("select#direction").attr("disabled","disabled");
        $("select#route").change(function(){
        $("select#direction").attr("disabled","disabled");
        $("select#direction").html("<option>wait...</option>");
        var id = $("select#route option:selected").attr('value');
        $.post("select_direction.php", {id:id}, function(data){
            $("select#direction").removeAttr("disabled");
            $("select#direction").html(data);
        });
    });
}); 
```

我想从 wordpress 主题文件夹/includes/select_direction.php 中调用它

该 JS 文件也存在于包含文件夹中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:17:41.543

您可以使用从网站文档根目录直接到要调用的文件的路径。可能是这样的：

```
"/theme_folder/includes/select_direction.php" 
```

任何以斜杠“/”开头的路径都是源自文档根目录的路径。如果路径相对于您的 JavaScript 代码所在的页面，您可以使用点-点“..”来表示一个目录：

```
"../../theme-folder/includes/select_direction.php" 
```

如果你想从你的 PHP 脚本中传递这个路径，最好的选择是把路径放在一个 HTML 元素属性中：

```
<body data-script-path="/theme_folder/includes/select_direction.php"> 
```

然后在您的 JavaScript 代码中，您可以通过以下方式获取路径：

```
var path = $("body").data("script-path"); 
```

有很多方法可以将数据从服务器端传递到客户端，您可以使用 PHP 解析 JavaScript——但这是一个丑陋的解决方案。HTML5 数据属性更加清晰。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-20T18:10:54.583

JavaScript 代码不知道它在包含文件夹中。它运行在它运行的页面所在的任何位置。

因此，您可以像使用页面所在位置的任何相对路径一样引用文件。

# hover - 为什么这个元素在悬停时部分突出显示？

> ID：13479404
> 
> 赞同：0
> 
> 时间：2012-11-20T18:08:47.027
> 
> 标签：hover, image, html

我现在正在处理一个包含两个按钮的页面。这些按钮是一个跨度的组合，带有按钮标题，被两个半圆的图像包围：

```
<td align="right">
<a href="#" title="Reset" onclick="resetForm();">
        <img src="images/btnBlueL.gif"><span style="background-image:url('images/btnBlueM.gif');color:white;font-weight:bold;height:22px;vertical-align:top;text-align:center;padding-top:5px;text-decoration:none;cursor:pointer;display:inline-block;">
         Reset
         </span><img src="images/btnBlueR.gif">
    </a>

     <a href="#" title="Clear all fields" onclick="clearForm()">
         <img src="images/btnBlueL.gif"><span style="background-image:url('images/btnBlueM.gif');color:white;font-weight:bold;height:22px;vertical-align:top;text-align:center;padding-top:5px;text-decoration:none;cursor:pointer;display:inline-block;">
          Clear
         </span><img src="images/btnBlueR.gif">
      </a> 
```

当我将鼠标悬停在按钮上时，按钮的右下角会出现一条非常小的红线。这适用于所有浏览器。看起来它部分突出了“a”元素，但只突出了几个像素。有没有人见过这样的事情？你是怎么让它消失的？

[http://jsfiddle.net/jmlane/VHFwB/](http://jsfiddle.net/jmlane/VHFwB/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:11:23.360

应该是边界吧。试试这个 CSS 规则来删除超链接的边框：

```
a {
    border: 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:22:02.283

确保链接没有应用 CSS：

```
a{
    text-decoration:none;
}
a img{
    border:0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T19:08:59.343

有时会添加不必要的边框，所以我会在我的 CSS 中使用以下几行：

```
a { border: 0; }
img { border: 0; display: block; } 
```

默认情况下，图像是内联的。并避免使用内联样式！:)

# javascript - PassportJS 和 ExpressJS 条件 URL 重定向

> ID：13479405
> 
> 赞同：0
> 
> 时间：2012-11-20T18:08:48.373
> 
> 标签：javascript, node.js, express, passport.js

我正在使用 ExpressJS 和 PassportJS 的 Facebook 策略来尝试对缺少某些属性时应该调用的身份验证回调执行一些条件重定向。

我的用户架构：

```
var UserSchema = new Schema({
  id: ObjectId,
  uid: String,
  facebookToken: String,
  username: String,
  password: String,
  salt: String,
  firstName: String,
  lastName: String,
  email: String,
  birthday: Date,
  gender: String,
  location: String,
  phone: Number,
  verifiedPhone: Boolean,
  interests: {
    culture: Boolean,
    food: Boolean,
    business: Boolean,
    family: Boolean,
    learning: Boolean,
    sports: Boolean,
    movies: Boolean,
    music: Boolean,
    events: Boolean,
    nightlife: Boolean,
    health: Boolean,
    beauty: Boolean,
    fashion: Boolean,
    motoring: Boolean,
    electronics: Boolean,
    groceries: Boolean,
    travel: Boolean,
    decor: Boolean
  },
  weeklyNotifcation: Number,
  weeklyNotificationSent: Number,
  created: {type: Date, default: Date.now}
}); 
```

我的回调：

```
app.get('/auth/facebook/callback', passport.authenticate('facebook', { failureRedirect: '/login' }), function(req, res) {
  User.findOne({uid: req.session.uid}, function(err, user) {
    if(user.email || user.location || user.phone || user.location == undefined) {
      res.redirect('/register');
    } else {
      res.redirect('/');
    }
  });
}); 
```

调用后数据存储到mongo`/auth/facebook`中。我检查数据库是否使用会话并检查它是否未定义，因为它不会返回字段，因为它们没有存储在数据库中。回调失败并且没有返回接收到的数据。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:58:35.733

```
if(user.email === undefined || user.location === undefined || user.phone === undefined || user.location === undefined) { 
```

可能是你的意思。此外，您可能应该检查`err`变量以查看是否有错误。

# jquery - 使用实用函数加载图像时修改元素

> ID：13479406
> 
> 赞同：1
> 
> 时间：2012-11-20T18:08:59.040
> 
> 标签：jquery

我想迭代一组元素并为每个`p`元素添加一个动态创建的元素。`img`编辑添加的图像后，`load`我想`p`使用名为`addText`.

我的非工作代码：（在[http://jsbin.com/abebof/2/edit](http://jsbin.com/abebof/2/edit)上查看它的实际操作）

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>Example</title>
    <style>img { max-width: 100%; }</style>
  </head>
  <body>
    <p>Image #1</p>
    <p>Image #2</p>
    <p>Image #3</p>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

    <script>

function addText(paragraph, text) {
  paragraph.text(paragraph.text() + '. ' + text);
  console.log('called');
}

$('p').each(function (i) {
  jthis = $(this);
  jthis.css('border', '5px solid');
  addText(jthis, 'The function works!');

  var jimg = $('<img src="http://i.imgur.com/IH38U.png class="loading" />');

  jimg.load(function () {
    addText(jthis, 'Loaded!');
  });
  jimg.appendTo(this);
});

    </script>
  </body>
</html> 
```

我正在寻求帮助的问题：

1.  没有图像加载到`Image #3`段落中。为什么不？
2.  该`Loaded!`消息将打印到`Image #3`每个图像的段落中。它应该打印到包含图像的段落中。我该如何纠正它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:19:12.197

您需要在定义负载后添加图像并使用允许显示的图像

最后你需要一个 jthis 的闭包！我使用 parent() 代替并附加而不是替换内容

[演示](http://jsfiddle.net/mplungjan/zVGLM/)

```
function addText(paragraph, text) {
  paragraph.append(text);
  console.log('called');
}
$(function() {      
  $('p').each(function (i) {
    jthis = $(this);
    jthis.css('border', '5px solid');
    addText(jthis, 'The function works!');
    var jimg = $('<img />');
    jimg.addClass("loading");
    jimg.on("load",function () {
      addText($(this).parent(), 'Loaded!');
    });
    jimg.appendTo(jthis);
    jimg.attr("src","http://lorempixel.com/output/nature-q-c-640-480-6.jpg" );

  });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T09:53:58.057

非常感谢[mplungjan](https://stackoverflow.com/users/295783/mplungjan)帮助我1 因为我觉得他的答案可以进一步改进并更接近我提供的原始代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>Example</title>
    <style>img { max-width: 100%; }</style>
  </head>
  <body>
    <p>Image #1</p>
    <p>Image #2</p>
    <p>Image #3</p>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

    <script>

function addText(paragraph, text) {
  paragraph.append(' ' + text); // #1 below
  console.log('called');
}

$('p').each(function (i) {
  jthis = $(this);
  jthis.css('border', '5px solid');
  addText(jthis, 'The function works!');

  var jimg = $('<img class="loading" />'); // #2 below.

  jimg.load(new function () {  // #3 below                  new, it creates a new closure each time.
    addText(jthis, 'Loaded!'); // WORKS now since I added
  });
  jimg.attr("src","http://i.imgur.com/IH38U.png");

  jimg.appendTo(this);
});

    </script>
  </body>
</html> 
```

OP 源中的错误修复说明：

1.  `paragraph.text()`检索 中的纯文本`paragraph`，过滤掉所有其他 DOM 节点。我试图通过简单地`paragraph.text('the new text')`设置文本来简单地更改文本。我错了。它有效地设置纯文本并删除那里的所有其他内容。如果我考虑一下，这是合乎逻辑的。毕竟，如果它只是简单地更改文本并保留其他所有内容，它将无法知道*我*想要文本的位置（即在 img 节点之前或之后）。
2.  创建的`img`节点会尽快开始加载其图像。它不会等到它被包含在 DOM 中。因此，我们必须首先创建它没有图像 URL，然后设置加载事件函数，最后设置图像 URL。如果我们立即设置 URL，则可能会错过加载事件。
3.  每次在函数 A 中创建函数 B 时，都会使用闭包。A 中的变量可以从 B 访问。问题是如果创建了许多内部函数 (B)，它们都共享 A 中的*当前*变量。为了解决这个问题，使用`new function`. 令人困惑？这也是给我的。[在此处](https://stackoverflow.com/questions/111102/how-do-javascript-closures-work)阅读第二个答案（不是已接受的答案，这是错误的）以获取更多信息。

# visual-studio-2010 - SharePoint 列表项到数据表中

> ID：13479407
> 
> 赞同：0
> 
> 时间：2012-11-20T18:08:58.767
> 
> 标签：visual-studio-2010, sharepoint

我想将 SharePoint 列表项加载到数据表中。

```
SPWeb oWebsite = SPContext.Current.Web;
SPList oList = oWebsite.Lists["List_Name"];
SPListItemCollection collListItems = oList.Items;

DataGrid1.DataSource = collListItems.GetDataTable();
DataGrid1.DataBind(); 
```

上面的代码片段将列表中的所有项目加载到数据表中，但我只需要将特定列表项/列加载到数据表中。怎么做到呢？寻找一些建议。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:39:23.573

您可以使用 SPView 并创建一个包含您要查找的列表项的视图来执行此操作：

```
SPWeb oWebsite = SPContext.Current.Web;
SPList oList = oWebsite.Lists["List_Name"];

SPView oView = oList.Views["ViewName"];
DataGrid1.DataSource = oList.GetItems(oView).GetDataTable();
DataGrid1.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:23:30.363

尝试这个：

```
DataTable dt = collListItems.GetDataTable();
dt.Columns.RemoveAt(3); // or string name as argument
DataGrid1.DataSource = dt;
DataGrid1.DataBind(); 
```

或使用特定的 CAML 查询

# entity-framework - 部署到 IIS 时出现连接字符串格式错误

> ID：13479412
> 
> 赞同：3
> 
> 时间：2012-11-20T18:09:14.983
> 
> 标签：entity-framework, iis, connection-string

我在 Web.config 中有以下连接字符串：

```
<add name="CTRS2Entities" connectionString="metadata=res://*/Edmx.CTRS2.csdl|res://*/Edmx.CTRS2.ssdl|res://*/Edmx.CTRS2.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=SYS2-PC;Initial Catalog=CTRS2;user id=**;password=***;Integrated Security=True;MultipleActiveResultSets=True&quot;" providerName="System.Data.EntityClient" /> 
```

它在开发模式下运行良好。但是，当我将其部署到 IIS 时，出现以下错误：

```
Format of initialization string does not conform to specification starting at index 0. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T12:25:40.830

用单引号替换`&quot;`连接字符串中的值，您就可以了。

请参阅：[不支持关键字：“数据源”初始化实体框架上下文](https://stackoverflow.com/questions/6997035/keyword-not-supported-data-source-initializing-entity-framework-context)

# maven - 无法在存储库中心找到资源 (http://repo1.maven.org/maven2)

> ID：13479413
> 
> 赞同：8
> 
> 时间：2012-11-20T18:09:23.557
> 
> 标签：maven

一般来说，我该怎么做才能解决在 maven 存储库中找不到的资源，是否有另一个我可以添加到 pom.xml 的存储库列表？我尝试了列为命令行的解决方案，但它不起作用，即使 maven 报告它是成功的。

```
I tried to build test-analytics, but got error:

[INFO]    task-segment: [install]
[INFO] ------------------------------------------------------------------------
[INFO] [resources:resources {execution: default-resources}]
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 6 resources
Downloading: http://repo1.maven.org/maven2/com/google/code/gwt-dnd/gwt-dnd/3.1.1/gwt-dnd-3.1.1.pom
[INFO] Unable to find resource 'com.google.code.gwt-dnd:gwt-dnd:pom:3.1.1' in repository central (http://repo1.maven.org/maven2)
Downloading: http://repo1.maven.org/maven2/com/google/code/gwt-dnd/gwt-dnd/3.1.1/gwt-dnd-3.1.1.jar
[INFO] Unable to find resource 'com.google.code.gwt-dnd:gwt-dnd:jar:3.1.1' in repository central (http://repo1.maven.org/maven2)
[INFO] ------------------------------------------------------------------------
[ERROR] BUILD ERROR
[INFO] ------------------------------------------------------------------------
[INFO] Failed to resolve artifact.

Missing:
----------
1) com.google.code.gwt-dnd:gwt-dnd:jar:3.1.1

  Try downloading the file manually from the project website.

  Then, install it using the command: 
      mvn install:install-file -DgroupId=com.google.code.gwt-dnd -DartifactId=gwt-dnd -Dversion=3.1.1 -Dpackaging=jar -Dfile=/path/to/file

  Alternatively, if you host your own repository you can deploy the file there: 
      mvn deploy:deploy-file -DgroupId=com.google.code.gwt-dnd -DartifactId=gwt-dnd -Dversion=3.1.1 -Dpackaging=jar -Dfile=/path/to/file -Durl=[url] -DrepositoryId=[id]

  Path to dependency: 
    1) com.google.testing.testify.risk.frontend:test-analytics:war:1.0-SNAPSHOT
    2) com.google.code.gwt-dnd:gwt-dnd:jar:3.1.1

----------
1 required artifact is missing.

for artifact: 
  com.google.testing.testify.risk.frontend:test-analytics:war:1.0-SNAPSHOT

from the specified remote repositories:
  central (http://repo1.maven.org/maven2)

[INFO] ------------------------------------------------------------------------
[INFO] For more information, run Maven with the -e switch
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1 second
[INFO] Finished at: Sun Nov 18 21:24:23 EST 2012
[INFO] Final Memory: 16M/238M
[INFO] ------------------------------------------------------------------------ 
```

这是命令和错误：

```
 mvn deploy:deploy-file -DgroupId=com.google.code.gwt-dnd -DartifactId=gwt-dnd -Dversion=3.1.1 -Dpackaging=jar -Dfile=gwt-dnd-3.1.1.jar
[INFO] Scanning for projects...
[INFO] Searching repository for plugin with prefix: 'deploy'.
[INFO] ------------------------------------------------------------------------
[INFO] Building test-analytics
[INFO]    task-segment: [deploy:deploy-file] (aggregator-style)
[INFO] ------------------------------------------------------------------------
[INFO] ------------------------------------------------------------------------
[ERROR] BUILD ERROR
[INFO] ------------------------------------------------------------------------
[INFO] One or more required plugin parameters are invalid/missing for 'deploy:deploy-file'

[0] Inside the definition for plugin 'maven-deploy-plugin' specify the following:

<configuration>
  ...
  <url>VALUE</url>
</configuration>

-OR-

on the command line, specify: '-Durl=VALUE'

[INFO] ------------------------------------------------------------------------
[INFO] For more information, run Maven with the -e switch
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1 second
[INFO] Finished at: Tue Nov 20 14:10:37 EST 2012
[INFO] Final Memory: 14M/238M
[INFO] ------------------------------------------------------------------------ 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-21T15:35:49.403

您对 Maven 世界缺乏一些基本的了解。因此，回购的简短摘要应该对您有所帮助。

对于初学者，当您“开箱即用”运行 maven 时，有两个可用的存储库，这就是您所做的。您有 1) maven Central 和 2) 您的本地仓库，即 ~/.m2/repository。本地存储库是一种缓存，您在本地构建的工件将通过“mvn install”命令“安装”到。请注意，“mvn deploy”命令“部署”一个工件，这类似于安装，但它意味着将工件放入“远程存储库”。Maven Central 是一个远程存储库，除了您的单个本地存储库之外的所有存储库都是如此，但您不会随意部署到它。它用于经过审查的、发布质量的工件。

因此，您的构建找不到 google 工件。这意味着它们不在 Maven Central 中，尽管您可以检查一下。[http://search.maven.org/](http://search.maven.org/)

如果他们不在那里，您有几个选择。

1）在你的本地仓库中“安装”工件（这应该是你的第一步，因为它非常轻量级）

2）运行自己的repository server，比如nexus。这是您自己的“远程存储库”，您可以将 google 的东西“部署”到它。

3）找出谷歌的东西是否在另一个公开可用的远程存储库中——有几个重要的不在开箱即用的maven repo定义中，但你可以添加它们。

请注意，这三个选项与其说是针对不同情况的解决方案，不如说是替代方案。如果您只是在扣球或打球，我肯定会选择＃1。如果你正在建立一个将使用这些工件的严肃的开发工作，你必须至少做 #3 并且可能 #2；如果您真的要大量使用 maven，那么 #2 对于让您的生活更轻松至关重要。这也是一种很好的教育体验，因为大多数 maven 东西在概念上都假设您拥有自己的 repo 服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:42:02.323

您需要阅读有关如何在 POM 文件中配置[存储库部分的信息。](http://maven.apache.org/pom.html#Repositories)

最好还是考虑设置一个 Maven 存储库管理器（如 Nexus）来缓存和聚合构建所需的第 3 方存储库。

# jquery - 如何在 jquery UI datetimepicker 上设置“现在”按钮来设置 UTC 时间？

> ID：13479416
> 
> 赞同：5
> 
> 时间：2012-11-20T18:09:25.370
> 
> 标签：jquery, datepicker, jquery-ui-datepicker, datetimepicker, timepicker

我在[这里](http://trentrichardson.com/examples/timepicker/)使用 datetimepicker 。如何设置现在按钮，以便它现在设置时间 UTC 而不是每个浏览器的当前时间？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-24T11:50:16.967

打开您的 jQuery timepicker 插件文件并转到以下函数

```
/*
* override "Today" button to also grab the time.
*/
$.datepicker._base_gotoToday = $.datepicker._gotoToday;
$.datepicker._gotoToday = function (id) {
    var inst = this._getInst($(id)[0]),
        $dp = inst.dpDiv;
    this._base_gotoToday(id);
    var tp_inst = this._get(inst, 'timepicker');
    selectLocalTimezone(tp_inst);
    var now = new Date();
    this._setTime(inst, now);
    $('.ui-datepicker-today', $dp).click();
}; 
```

并简单地添加以下更改，

```
var now = new Date();
var utcNow = new Date(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate(), now.getUTCHours(), now.getUTCMinutes(), now.getUTCSeconds());
this._setTime(inst, utcNow); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:08:45.420

这适用于设置时间，但不适用于设置日历上的实际日期。

```
$.datepicker._gotoToday = function (id) {
    var inst = this._getInst($(id)[0]),
    $dp = inst.dpDiv;
    this._base_gotoToday(id);
    var tp_inst = this._get(inst, 'timepicker');
    var now = new Date();
    var now_utc = new Date(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate(), now.getUTCHours(), now.getUTCMinutes(), now.getUTCSeconds());
    this._setTime(inst, now_utc);
    $('.ui-datepicker-today', $dp).click();
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-27T18:04:14.377

我遇到了类似的问题，最后我不得不用自定义按钮替换“现在”按钮。我知道这很讨厌，但见鬼，否则你可能需要在每个新版本上触摸库。

```
 window.date = "<?php echo $time; ?>";

    Date.prototype.addHours = function(h) {    
        this.setTime(this.getTime() + (h*60*60*1000)); 
        return this;   
    }
    var previous_time = new Date();
    previous_time.addHours(-1);
    var cur_time = new Date();
    $(".timepicker_from").datetimepicker({
        dateFormat: "mm/dd/yy",
        timeFormat: 'hh:mm:ss',
        showSecond: true,
        hour: previous_time.getUTCHours(),
        minute: previous_time.getUTCMinutes()
    });

    $('.timepicker_from').focus(function(){
        var timezone = jstz.determine();
        $('#timezone').val(timezone.name());
          $( ".ui-datepicker-current" ).replaceWith('<button type="button" style="float: left; margin: .5em .2em .4em; \n\
                                                                               cursor: pointer; padding: .2em .6em .3em .6em;\n\
                                                                               width:auto; overflow:visible;" onclick="set_utc_time_from(date);" > Now </button>' );
    });

    $( ".timepicker_to" ).datetimepicker({
        dateFormat: "mm/dd/yy",
        timeFormat: 'hh:mm:ss',
        showSecond: true,
        hour: cur_time.getUTCHours(),
        minute: cur_time.getUTCMinutes()
    });

    $('.timepicker_to').focus(function(){
        $( ".ui-datepicker-current" ).replaceWith('<button type="button" style="float: left; margin: .5em .2em .4em; \n\
                                                                               cursor: pointer; padding: .2em .6em .3em .6em;\n\
                                                                               width:auto; overflow:visible;" class="" onclick="set_utc_time_to(date);"> Now </button>' );
    });

    function set_utc_time_from(utc){
        var $from = $('input#cdr_from').val(utc);
    };

    function set_utc_time_to(utc){
        var $from = $('input#cdr_to').val(utc);
    }; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-07T10:54:39.507

我的解决方案是用from 方法包装原始 datepicker 的`_gotoToday`函数，然后进行时间调整。`_.wrap``underscore.js`

```
$.datepicker._gotoToday = _.wrap($.datepicker._gotoToday, function (originalHandler) {
    originalHandler.apply(this, _.rest(arguments));
    //utc adjustment:
    var date = new Date();
    date.setMinutes(date.getMinutes() + date.getTimezoneOffset());
    element.datetimepicker('setDate', date);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-17T11:18:00.090

查找并替换此代码，单击“现在”按钮后显示当前当地时间。

```
/*
 * override "Today" button to also grab the time and set it to input field.
 */
$.datepicker._base_gotoToday = $.datepicker._gotoToday;
$.datepicker._gotoToday = function(id) {
    var inst = this._getInst($(id)[0]);
    this._base_gotoToday(id);
    var tp_inst = this._get(inst, 'timepicker');
    var tzoffset = $.timepicker.timezoneOffsetNumber(tp_inst.timezone);
    var now = new Date();
    var utcNow = new Date(now.getFullYear(), now.getMonth(), now.getDate(), now.getHours(), now.getMinutes(), now.getSeconds());
    this._setTime(inst, utcNow);
    tp_inst._onSelectHandler();
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-15T07:55:53.933

对许多人来说仍然是一个问题......虽然您可以将源代码更改为始终使用 UTC 时间，但在许多情况下这不是解决方案，因为您可能需要在同一页面上同时使用 UTC 功能和标准（本地时间）功能。所以..我的解决方案是隐藏UTC时间选择器类型上的现在按钮。

**注意**！我知道，它并不完美，因为在显示 now 按钮后会触发超时，它可能会短暂“闪烁”.. 但对我来说还可以。它隐藏了我需要的选择器中的“现在按钮”，我不需要更改 datetimepicker 脚本！

```
 // hides the "now" button (as fast as possible) for the 
    // datetimepickerUTC, as that button only works with local time!
    var datetimepickerUTCNowHider = function( currentDateTime ){
        setTimeout(function () { 
           $('.datetimepickerUTC').datepicker("widget").find(".ui-datepicker-current").hide();
        }, 0.001 );
    };

    //the utc time
    var dateNow = new Date();
    var utc = new Date(dateNow.getTime() + dateNow.getTimezoneOffset() * 60000);

    // the datetimepicker
    $('.datetimepickerUTC').datetimepicker({            
        dateFormat: 'yymmdd', 
        timeFormat: 'HH:mm',
        controlType: 'select',  
        hour: utc.getHours(),
        minute: utc.getMinutes(),
        beforeShow: datetimepickerUTCNowHider,
        onSelect: datetimepickerUTCNowHider,
        showWeek: true      
    }); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-11T01:31:12.967

您可以劫持日期函数以将所有日期设置为 UTC

```
var daysInMonth     = new Array(31,28,31,30,31,30,31,31,30,31,30,31);
var daysInWeek      = new Array("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat");
var daysInWeekLong  = new Array("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday");
var months          = new Array("January","February","March","April","May","June","July","August","September","October","November","December");
var monthsShort     = new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");
var dateReg         = new RegExp("^(\\d{4})(\\d{2})(\\d{2})$");
var dateTimeReg     = new RegExp("^(\\d{4})(\\d{2})(\\d{2})(\\d{2})(\\d{2})(\\d{0,2})$");
var timeReg         = new RegExp("^(\\d{2})(\\d{2})\\d{0,2}$");

function twoDigit(d) {
   return (d < 10 ? "0" + d : "" + d);
}

Date.prototype.format = function(f) {
   var day         = twoDigit(this.getDate()); 
   var dayWeek     = daysInWeek[this.getDay()]; 
   var dayWeekLong = daysInWeekLong[this.getDay()]; 
   var month       = twoDigit(this.getMonth() + 1); 
   var yearLong    = twoDigit(this.getFullYear()); 
   var yearShort   = twoDigit(this.getFullYear().toString().substring(3,4));
   var year        = (f.indexOf("yyyy") > -1 ? yearLong: yearShort);
   var hour24      = this.getHours(); 
   var hour_am_pm  = twoDigit((hour24 > 12 ? hour24 - 12 : hour24));
   var am_pm       = (hour24 >= 12 ? "PM" : "AM");
   var hour24      = twoDigit(hour24);
   var minute      = twoDigit(this.getMinutes()); 
   var second      = twoDigit(this.getSeconds()); 
   var monthShort  = monthsShort[this.getMonth()]; 
   var monthLong   = months[this.getMonth()]; 

   var dateString  = f.replace(/month/ig, monthLong).replace(/mon/ig, monthShort).replace(/dd/ig, day).replace(/dy/ig, dayWeek).replace(/day/ig, dayWeekLong).replace(/mm/ig, month).replace(/y{2,4}/ig, year).replace(/hh24/ig, hour24).replace(/hh/ig, hour_am_pm).replace(/am_pm/ig, am_pm).replace(/mi/ig, minute).replace(/ss/ig, second);
   return dateString;
} 

var _f = function(item) {
   Date.prototype["get" + item] = Date.prototype["getUTC" + item];
   Date.prototype["set" + item] = Date.prototype["setUTC" + item];
}
var _d = ['Milliseconds', 'Seconds', 'Minutes', 'Hours', 'Date', 'Month', 'FullYear', 'Year', 'Day'];
_d.forEach(_f);

Date = class extends Date {
   constructor(...options) {
      if (options.length == 1 && options[0].constructor == Date) {
         if (!isNaN(options[0])) {
            super(options[0]);
         } else {
            super();
         }
      } else if (options.length > 0) {
         if (!isNaN(options[0])) {
            super(Date.UTC(...options));
         } else {
            super();
         }
      } else {
         super();
      }
   }
}; 
```

# javascript - jQuery 1.5.2 的引导导航下拉菜单

> ID：13479422
> 
> 赞同：1
> 
> 时间：2012-11-20T18:09:47.367
> 
> 标签：javascript, jquery, twitter-bootstrap

我将引导程序与 XenForo 结合使用，它只喜欢旧版本的 jQuery。问题是 twitter 引导插件不向后兼容，并且在运行时会导致问题。我不想降级引导程序，因为已经对该特定组件进行了大量错误修复。主要问题是[.on 函数](http://api.jquery.com/on/)，它在早期版本的 jQuery 中不存在。

我很想自己写（看起来很简单），但想知道是否有更简单的方法来做事。我可以在某处插入 .on 函数的 jQuery 代码吗？

升级 jQuery 也不是一种选择，因为它破坏了 XenForo - 这是[他们关于此的社区线程](http://xenforo.com/community/threads/upgrade-jquery.25126/)。有任何想法吗？

也可以看看

*   [http://twitter.github.com/bootstrap/assets/js/bootstrap-dropdown.js](http://twitter.github.com/bootstrap/assets/js/bootstrap-dropdown.js)
*   [http://code.jquery.com/jquery-1.5.2.js](http://code.jquery.com/jquery-1.5.2.js)

# java - 我得到以下代码的部分输出

> ID：13479425
> 
> 赞同：0
> 
> 时间：2012-11-20T18:09:54.900
> 
> 标签：java, event-handling, keyevent

由于我是一个真正的编程菜鸟，我试图编写这段代码并得到部分输出。这个想法是打印在小程序上键入的字符，如果按下 alt 或 shift 键，它必须显示在状态栏中。问题是小程序上没有响应，但是在按 alt 或 shift 键时，我在状态栏上得到了适当的响应。这是代码：

```
import java.awt.*;
import java.applet.*;
import java.awt.event.*;

/* <applet code="MyKeyApplet.class"
           width = "400"
           height = "400">
   </applet>*/

public class MyKeyApplet extends Applet implements KeyListener{
    char ch;
    String str=" ";

    public void init(){
        this.addKeyListener(this);
        requestFocus();
    }

    public void keyPressed(KeyEvent k){
        int x = k.getKeyCode();
        if(x==KeyEvent.VK_SHIFT)
            showStatus("You pressed Shift Key");
        else if (x==KeyEvent.VK_ALT)
            showStatus("You pressed Alt Key");
    }

    public void paint(Graphics g){
        g.drawString(str,40,40);
    }

    public void keyTyped(KeyEvent k){
        ch=k.getKeyChar();
        str="You Pressed" + ch;
        repaint();
    }

    public void keyReleased(KeyEvent k){
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:22:13.483

没有测试过自己，但这个答案可能会有所帮助：[https ://stackoverflow.com/a/12483507/877472](https://stackoverflow.com/a/12483507/877472)

从我在您的代码中可以看出，您只检查修饰键按下（ctrl、alt、shift 等），但您没有处理其他键的任何情况。同样，我没有对此进行测试，但您可能希望修改您的代码，以便您有两个单独的处理操作：一个用于检查修改键是否被按下，然后另一个用于处理不是修改器的任何按键. 像这样的东西：

```
public void keyPressed(KeyEvent k){
    int x = k.getKeyCode();
    if(x==KeyEvent.VK_SHIFT)
        showStatus("You pressed Shift Key");
    else if (x==KeyEvent.VK_ALT)
        showStatus("You pressed Alt Key");
    else
      str += k.getKeyChar(); // Add the pressed key to the string.
} 
```

顺便说一句，虽然我不是 100% 清楚你的程序应该做什么，但是如果你打算连续构建一个字符串，你可能会发现使用[StringBuffer 类](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuffer.html)有更好的性能。

# php - 如何正确注释被覆盖的类或方法

> ID：13479426
> 
> 赞同：1
> 
> 时间：2012-11-20T18:09:55.663
> 
> 标签：php, comments

评论重写的类或方法时公认的最佳实践是什么。

1.  是否应该复制父类或方法的注释并添加一个简短的注释来解释为什么以及如何修改它。
2.  是否应该使用 @see 标记链接到父元素（php docblock）
3.  任何其他公认的标准

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:11:54.937

使用`@see`标签，但添加任何可能偏离扩展/覆盖类/方法的信息。例如，@author 可能不同，该方法会做一些额外的事情（假设它没有定义抽象方法）所以请注意这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:16:07.333

这取决于您使用的文档，他们应该在其中概述它的细节，但是如果您使用“php docblock”，那么是的，如果没有阅读您使用的手册，请使用@see

# ruby-on-rails - rails 中的 params 散列是什么以及如何使用和更改它？

> ID：13479429
> 
> 赞同：-4
> 
> 时间：2012-11-20T18:10:06.263
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec

params[:id] 和 params[:zombie_id] 有什么区别？参数哈希中的 :id 是什么？params[:zombie] 呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T18:16:00.940

我希望您先阅读[http://guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)。

`params`请参阅传递给控制器​​操作的请求参数列表。

你可以将zombie_id传递为，`your_valid_routing_path(:zombie_id=>1)`

:id in params 通常在 rails 中指的是您所指的“成员”

例如

`link_to profile_obj`

默认情况下会路由类似的东西，`/profile/4`其中 4 是 profile_obj.id

在您的操作中，您可以使用 params[:id] 访问 4

# jquery - Jquery - 使用 jquery 传递 asp 按钮命令参数

> ID：13479430
> 
> 赞同：5
> 
> 时间：2012-11-20T18:10:08.363
> 
> 标签：jquery, asp.net, eventargs

我有asp按钮：

```
<asp:button ID="btn1" runat="server" CommandArgument="" CssClass="btn1" OnClick="button_click"></asp:button> 
```

和脚本：

```
$("a").click(function () {
            var val = $(this).attr('id').toString();                            
            $('.btn1').attr('CommandArgument',val);
            alert($('.btn1').attr('CommandArgument').toString());
            $('.btn1').click();
        }); 
```

单击后它会提醒我命令参数。但是在下一步中-当我使用 jquery 触发 btn1 单击时，它会转到代码隐藏并且命令参数为空。我可以用 jquery 以某种方式传递命令参数吗？

我试图将值保存到全局变量，但回发后它们都是空的。我不想为此使用 cookie 或视图状态。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-20T21:38:05.017

`CommandArgument`完全是服务器端属性，不呈现任何 html 属性。所以你不能改变任何按钮的属性并点击它。好消息是您可以使用客户端 __doPostBack 函数触发回发，并将您的自定义值作为第二个参数传递：

```
<script type="text/javascript">
    $("a").click(function () {
        var val = $(this).attr('id').toString();
        __doPostBack("<%= btn1.UniqueID %>", val);
    });
</script> 
```

您可以从 Request.Form 集合中获取服务器单击处理程序中传递的参数：

```
protected void button_click(object sender, EventArgs e)
{
    var argument = Request.Form["__EVENTARGUMENT"];
} 
```

如果上面的脚本不起作用，那么页面上可能没有定义 __doPostBack 函数。在这种情况下，将此代码添加到 Page_PreRender 方法：`ClientScript.GetPostBackEventReference(btn1, string.Empty);`这将强制页面`__doPostBack`在页面上定义方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-11-04T21:11:37.400

我发现在提交按钮上使用 __doPostBack('id','args') 会创建一个完整的页面回发。我发现更容易的是在页面中添加一个隐藏字段，设置值，然后调用 button.click() 事件

```
 <asp:Button ID="btnTrigger" runat="server" ClientIDMode="Static" OnClick="btnTrigger_Click" />
    <asp:HiddenField ID="CommandArg" runat="server" ClientIDMode="Static" />

    $('#CommandArg').val('my argument');
    $('#btnTrigger').click(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-07T12:57:54.087

或者你可以试试这个：

```
<script type="text/javascript">
    function MaybeThisWorks(obj)
    {
        __doPostBack( obj.id, 'OtherInformation' );
        return true;
    }
</script>

...

<asp:Button Text="ButtonValue" ID="RepP1" runat="server" OnClientClick="MaybeThisWorks(this);" OnClick="CodeBehindFunction" /> 
```

'OtherInformation' 可以替换为任何字符串或变量。
例如
$('#calendar').fullCalendar('getDate').getMonth()+','+$('#calendar').fullCalendar('getDate').getFullYear()

CodeBehindFunction 是当您单击按钮时在服务器上执行的代码隐藏函数（例如，打印报告并需要代码隐藏函数中的 jquery 值的按钮）。
在代码隐藏函数中，您可以通过 Request.Form["__EVENTARGUMENT"] 获取参数

```
protected void CodeBehindFunction(object sender, EventArgs e)
{
 string arguments = Request.Form["__EVENTARGUMENT"];
 ...
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-16T14:35:57.907

我通常只是在后面的代码中为按钮添加一个属性，然后通过 Javascript 或 jQuery 中的 DOM 访问它。

```
 mybutton.Attributes.Add("MyVar", "MyValue"); 
```

这将呈现到页面，然后您可以使用 Javascript 访问该值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-01-30T15:35:00.740

尝试这个。它对我有用。

//客户端JQuery：

```
$('#btnTrigger').val('MyParameter');
$('#btnTrigger').click(); 
```

//服务器端点击方法

```
String Param = Request.Form(btnTrigger.UniqueID) 
```

# sql - 解释计划显示使用分析函数和不同的查询所需的 15 Exabyte 空间量

> ID：13479431
> 
> 赞同：1
> 
> 时间：2012-11-20T18:10:08.457
> 
> 标签：sql, oracle, optimization, query-optimization, sql-execution-plan

附件是一个[小提琴](http://sqlfiddle.com/#!4/ab10a/45)，它在每个表旁边用注释来布置我的模式，以指示上述每个表中的行数。查询看起来像这样，以防小提琴被阻塞：

```
select distinct cat_name,cat_age, co_cat_owners_id,cat_weight,cs_is_alive,os_is_current, cos_is_current,
      sum(cat_age) over(partition by co_cat_owners_id) running_total
from
   (
         select co.cat_owners_id co_cat_owners_id,
               co.cat_id co_cat_id,
               co.owner_id co_owner_id,
               co.vet_id co_vet_id, 
               cos.is_current cos_is_current,
               os.is_current os_is_current,
               cs.is_alive cs_is_alive,
               cat.name cat_name,
               cat.age cat_age,
               cat.weight cat_weight
         from cat_owners co,
              cat_owner_statuses cos,
              cat_statuses cs,
              cats cat,
              owners o,
              owner_statuses os
         where o.owner_id = co.owner_id
         and cat.cat_id = co.cat_id
         and cos.last_visit >= sysdate - 4/24
    )
where cs_is_alive = '1' 
and (cos_is_current = '1' OR os_is_current='1')
group by cat_name,cat_age,cat_weight,cs_is_alive,os_is_current,co_cat_owners_id,cos_is_current; 
```

在我的开发环境中，解释计划在步骤方面与小提琴内部的内容非常接近，但是我确实有几个步骤，其中内存大小为 15E（EB），行数为 4000P（PB）。我的问题是，在创建索引/错误 SQL 的过程中，我是否设法生成了一个 15 EB 的解决方案来解决应该可以在更少的空间和时间内解决的问题。我注意到调整一些复合索引创建步骤会产生稍微不同的结果，但我仍然被 Exabyte 空间要求所阻止。

**笔记**

如果将来有人没有阅读所有评论，请结合正确的连接运行以下功能：

```
analyze table table_name_here compute statistics; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:34:41.520

您的查询在子句中有 6 个表，`FROM`但您只指定了两个连接条件。 `OWNERS`有 1000 万行，`CAT_OWNERS`有 1.2 亿行，所以我猜测连接会产生 1.2 亿行。然后你加入`CATS`其中有 100 万行，所以我假设此时你有 1.2 亿行。但是，从那里，您没有更多的加入条件。因此，您的 1.2 亿行中间结果与 5 亿行表进行笛卡尔连接，该`CAT_OWNER_STATUSES`表产生 1.2 亿 * 5 亿行，即 60 万亿行。笛卡儿将其加入到 1000 万行`CAT_STATUSES`表中，最终得到 60 万亿 * 1000 万行，现在我们达到 6 * 10^23 行。然后你笛卡尔再次加入`OWNER_STATUSES`它有 9000 万行，为您提供 5.4 * 10^31 行。如果您想要合理数量的结果，您将需要指定额外的连接条件以避免笛卡尔积。

不幸的是，要遵循小提琴中的数据模型有点困难，因为似乎有许多可能相互矛盾的方法可以将您的表连接在一起。 `CAT_VETS`例如，将猫映射到兽医，但也是如此`CAT_OWNERS`。如果没有数据和预期结果，那么很难猜测应该如何连接表。我的猜测是你想要[这个修改过的小提琴](http://sqlfiddle.com/#!4/ab10a/47)

```
select distinct cat_name,cat_age, co_cat_owners_id,cat_weight,cs_is_alive,os_is_current, cos_is_current,
      sum(cat_age) over(partition by co_cat_owners_id) running_total
from
   (
         select co.cat_owners_id co_cat_owners_id,
               co.cat_id co_cat_id,
               co.owner_id co_owner_id,
               co.vet_id co_vet_id, 
               cos.is_current cos_is_current,
               os.is_current os_is_current,
               cs.is_alive cs_is_alive,
               cat.name cat_name,
               cat.age cat_age,
               cat.weight cat_weight
         from cat_owners co,
              cat_owner_statuses cos,
              cat_statuses cs,
              cats cat,
              owners o,
              owner_statuses os,
              cat_vets cv,
              owner_vets ov
         where o.owner_id = co.owner_id
         and cat.cat_id = co.cat_id
         and cos.cat_owners_id = co.cat_owners_id
         and cs.cat_vets_id = cv.cat_vets_id
         and os.owner_vets_id = ov.owner_vets_id
         and ov.owner_id = o.owner_id
         and co.vet_id = ov.vet_id
         and co.vet_id = cv.vet_id
         and cos.last_visit >= sysdate - 4/24
    )
where cs_is_alive = '1' 
and (cos_is_current = '1' OR os_is_current='1')
group by cat_name,cat_age,cat_weight,cs_is_alive,os_is_current,co_cat_owners_id,cos_is_current; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T18:32:50.910

由于您没有使用您错过的连接语法将 cat_statuses、cat_owner_statuses 和 owner_statuses 的任何行与任何剩余的表连接起来。这将导致这些表和连接表之间的交叉连接。两个“状态”表包含多少行？

考虑加入每个表，而不是用逗号列出它们，然后使用 where 过滤掉。我不确定 SQL 如何处理逗号分隔的表（也可能是交叉连接）......

```
 from owners o,
          join cat_owners co on o.owner_id = co.owner_id
          join cats cat on cat.cat_id = co.cat_id
          join cat_owner_statuses cos on XXXXX
          join cat_statuses cs on XXXXX,
          join owner_statuses os on XXXXX
     where cos.last_visit >= sysdate - 4/24 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:33:00.497

您的几个表（例如`cat_statuses`）没有关系，因此产品连接返回数以亿计的行。也许您需要通过`cat_vets`Fiddle 示例中命名的表进行连接。

至少，您应该将外部`where`条件移动到派生表查询中；把它放在外面是低效的。

# c++ - 如何从 'char const*' 中删除 const

> ID：13479433
> 
> 赞同：6
> 
> 时间：2012-11-20T18:10:13.843
> 
> 标签：c++, c++11

似乎 std::remove_const 无法删除`const char*`. 考虑以下代码：

```
#include <iostream>
#include <type_traits>
#include <typeinfo>

template< typename T >
struct S
{
    static void foo( ) {
        std::cout << typeid(T).name() << std::endl;
        std::cout << typeid( std::remove_const<T>::type ).name() << std::endl;
    }
};

int main( )
{
    S<char const*>::foo();
} 
```

该程序的输出（在 Visual Studio 2010 上）：

```
char const *
char const * 
```

在 gcc 中，我们有可读的输出（[这里](http://ideone.com/Vd25T8)的代码）：

```
PKc
PKc 
```

我希望能进入`char *`微软编译器的第二行，以及 gcc 上的任何东西（但不同于第一行）。我究竟做错了什么？我该如何`char const*`转向`char*`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-20T18:15:20.790

`char const*`是指向 a 的指针`const char`，但指针本身不是`const`。要从所指向的类型中删除 constness，您可以这样做：

```
std::add_pointer<typename std::remove_const<typename std::remove_pointer<T>::type>::type>::type 
```

或者：

```
typename std::remove_const<typename std::remove_pointer<T>::type>::type* 
```

我们从 get 中删除指针`const char*`，`const char`然后将 const 删除到 get `char`，然后将指针添加回 get `char*`。不是特别漂亮。去测试：

```
typedef const char * type_before;
std::cout << typeid(type_before).name() << std::endl;
typedef typename std::remove_const<typename std::remove_pointer<type_before>::type>::type* type_after;
std::cout << typeid(type_after).name() << std::endl; 
```

在我的系统上使用 g++，输出：

```
PKc
Pc 
```

这应该给你一个关于“PKc”意味着什么的提示。P 代表指针，c 代表`char`，K 代表`konst`;)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-20T18:28:53.747

如果要删除所有 const 限定符，则需要一个从所有级别递归删除 const 的解决方案：

```
template<typename T> struct remove_all_const : std::remove_const<T> {};

template<typename T> struct remove_all_const<T*> {
    typedef typename remove_all_const<T>::type *type;
};

template<typename T> struct remove_all_const<T * const> {
    typedef typename remove_all_const<T>::type *type;
};

int main() {
    std::cout << typeid(remove_all_const<int const * * const>::type).name() << '\n';
} 
```

# ruby - 如果匹配特定的 ID，提升轮胎中的查询结果？

> ID：13479434
> 
> 赞同：0
> 
> 时间：2012-11-20T18:10:15.740
> 
> 标签：ruby, search, elasticsearch, tire

我有一个 ElasticSearch 数据库，其中包含“页面”。

```
class Page
  field :domain_id 
  field :page_id 
  field :title 
  field :description 
  field :filetype 
  field :content
end 
```

每个页面都有一个域的 ID。我希望能够在所有查询中提升特定域的结果。因此，如果它与 X 的 domain_id 匹配，静态设置，它将在我们返回的每个搜索结果中更加相关。

其次，我想基于匹配标题或描述的文本（可以是多个单词）进行提升，而不是匹配内容。

我目前在轮胎宝石中有以下查询。

```
query { text :_all, search_term } 
```

我应该添加什么来做上面的两件事？如果用户输入“title:policy manuals”（显然没有引号），这将如何影响事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:23:32.717

第一个问题可以通过使用带有匹配 domain_id 的过滤器的[自定义过滤器评分查询来解决。](http://www.elasticsearch.org/guide/reference/query-dsl/custom-filters-score-query.html)第二个问题可以通过分别搜索每个字段并应用适当的提升因子来解决。总而言之，它可能看起来像这样：

```
{
  "custom_filters_score": {
    "query": {
      "bool": {
        "should": [
          {
            "text": {
              "title": "SEARCH_TERM",
              "boost": 2
            }
          },
          {
            "text": {
              "description": "SEARCH_TERM",
              "boost": 2
            }
          },
          {
            "text": {
              "content": "SEARCH_TERM",
              "boost": 1
            }
          }
        ]
      }
    },
    "filters": [
      {
        "filter": { "term": {"domain_id": "X"}},
        "boost": 3
      }
    ]
  }
} 
```

# eclipse - 之后将移动的文件附加到其先前的历史记录

> ID：13479437
> 
> 赞同：0
> 
> 时间：2012-11-20T18:10:31.387
> 
> 标签：eclipse, mercurial, mercurialeclipse

由于[MercurialEclipse 插件的缺陷](https://bitbucket.org/mercurialeclipse/main/issue/77/renaming-of-a-file-brokes-the-history)，我丢失了移动文件的历史记录。

现在已经有一段时间了，我已经切换到更新版本的 MercurialEclipse 来修复这个错误。

我想将此文件连接到其以前的位置/版本。

我怎样才能做到这一点？在 Eclipse 中还是在命令行中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:45:44.207

在匿名分支中创建干净的“移动变更集”并将`graft`其放入所需的位置？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-21T15:25:41.127

如果您只想找出特定文件的所有历史记录，无论是在重命名/移动/复制之前/之后，一个简单的“hg log --follow filename”就可以做到这一点。

```
luke@luke-linux:~/work/hg$ hg init test
luke@luke-linux:~/work/hg$ cd test
luke@luke-linux:~/work/hg/test$ echo a > a.txt
luke@luke-linux:~/work/hg/test$ hg add a.txt
adding a.txt
luke@luke-linux:~/work/hg/test$ hg ci -m a.txt
a.txt
committed changeset 0:552282c32ac4
luke@luke-linux:~/work/hg/test$ hg mv a.txt b.txt
moving a.txt to b.txt
luke@luke-linux:~/work/hg/test$ hg ci -m "a.txt-->b.txt"
b.txt
committed changeset 1:10dda3a3b48a
luke@luke-linux:~/work/hg/test$ hg mv b.txt c.txt
moving b.txt to c.txt
luke@luke-linux:~/work/hg/test$ hg ci -m "b.txt-->c.txt"
c.txt
committed changeset 2:f79245e6c0fe
luke@luke-linux:~/work/hg/test$ hg log --follow c.txt
changeset:   2:f79245e6c0fe
tag:         tip
user:        Luke Luo <luke.jf.luo@gmail.com>
date:        Wed Nov 21 23:23:16 2012 +0800
files:       b.txt c.txt
description:
b.txt-->c.txt

changeset:   1:10dda3a3b48a
user:        Luke Luo <luke.jf.luo@gmail.com>
date:        Wed Nov 21 23:22:56 2012 +0800
files:       a.txt b.txt
description:
a.txt-->b.txt

changeset:   0:552282c32ac4
user:        Luke Luo <luke.jf.luo@gmail.com>
date:        Wed Nov 21 23:22:34 2012 +0800
files:       a.txt
description:
a.txt 
```

# ruby - ruby 块中定义的常量的常量定义的上下文是什么？

> ID：13479438
> 
> 赞同：2
> 
> 时间：2012-11-20T18:10:38.200
> 
> 标签：ruby, metaprogramming

这是一个迷惑你的面条的问题。

`class_eval`在使用类作为接收器进行评估的块中，方法声明和常量声明之间似乎存在差异。这是一些演示差异的代码：

```
module X
  def save_block(&block)
    @block = block
  end
end

module Y
  extend X
  save_block do
    SOME_CONSTANT = 1
    def meth
      "a method"
    end
  end
  def self.included(m)
    m.class_eval &@block
  end
end

class Z
  include Y
end

class W
  include Y
end 
```

至少在 Ruby 1.9.3 中执行此代码会导致以下错误：

```
warning: already initialized constant SOME_CONSTANT 
```

这是我没想到的。首先考虑`meth`位于哪里：

```
Z.instance_methods(false)
=> [:meth]

W.instance_methods(false)
=> [:meth] 
```

并且`Y`没有任何实例方法：

```
Y.instance_methods(false)
=> [] 
```

这是有道理的，因为该块是使用`Z`并`W`作为`class_eval`. 但是，常量是不同的，因此会出现错误消息，如下所示：

```
Y.constants(false)
=> [:SOME_CONSTANT]

Z.constants(false) 
=> []

W.constants(false)
=> [] 
```

在这里，常量最终被定义在`Y`（出于某种奇怪的原因），因此当第二次执行块时，常量`SOME_CONSTANT`已经定义了。

我非常期待一些启示。

**更新（2012/11/19）：**

正如@phoet 在下面指出的（对我对他的回答的评论的回应），常量是在块的[词法范围内](http://en.wikipedia.org/wiki/Scope_%28computer_science%29#Lexical_scoping)定义的，也就是说，在最初定义块的范围内。在我的示例中，这将是 Y。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:00:53.170

如本问题所述，[访问常量](https://stackoverflow.com/questions/10078744/accessing-a-constant)常量处理在其“词法范围”内，即定义它们的上下文，而不是执行它们的上下文。

# c# - 带有两个初始化器的 StructureMap

> ID：13479442
> 
> 赞同：1
> 
> 时间：2012-11-20T18:10:41.797
> 
> 标签：c#, asp.net, asp.net-mvc-3, structuremap

我有3个项目。

```
 1
 / \   - inheritance
2   3 
```

1 个项目有 ObjectFactory.Initialize... 我有 1 个接口和两个实现。我想为 2 和 3 个项目使用两种不同的实现。我应该怎么做？可以使用 StructureMap 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:20:02.537

StructureMap 不是这里的限制因素。您的 2 个接口实现存在于哪些项目中？

如果它们在项目 2 和 3 中，那么您需要在项目 2 和 3 中执行 ObjectFactory.Initialize，您知道要使用哪个接口实现。

如果它们在项目 1 中，您可以在项目 1 中创建两个新类，以项目 2 和 3 所需的方式初始化容器，然后确保为每个项目使用正确的类。

在这两种情况下，您需要两种不同的方法来构建容器以支持最终结果，在您的情况下是项目 2 和 3。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T16:01:32.383

找到解决方案。在基础项目中，我应该初始化：

```
ObjectFactory.Initialize(x => x...) 
```

但在依赖项目中，我应该在基础项目初始化后进行配置：

```
ObjectFactory.Configure(x => x...) 
```

# javascript - 防止 jQuery 操作动态插入的 XML 字符串

> ID：13479443
> 
> 赞同：2
> 
> 时间：2012-11-20T18:10:48.503
> 
> 标签：javascript, jquery, xml, parsexml

[这个答案](https://stackoverflow.com/questions/4262960/is-it-possible-to-add-delete-xml-nodes-with-jquery-ajax#answer-4263390)简要地谈到了这个话题，但没有提到我遇到的问题。

看看[这个小提琴](http://jsfiddle.net/F6nkk/1/)。

正如您从警报消息中看到的那样，jQuery 进行了许多我没有预料到的更改：

*   将原件折叠`<node></node>`成一个自闭合标签 ( `<node />`)
*   `$('<SelfClosingNode />')`变成了`<selfclosingnode xmlns="http://www.w3.org/1999/xhtml"></selfclosingnode>`，例如。使标签名称小写，添加 xmlns 属性，并将其拆分为开始和结束标签

我需要能够插入 EXACT xml，我不想让 jQuery 弄乱我的标记结构！

在此先感谢您的帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T01:09:20.550

好消息是您可以强制区分大小写`SelfClosingNode`。见下文：

```
var xml_string = $("#xml-data").html();
try{
    var xml = $.parseXML(xml_string);
    var $xml = $(xml);

    var newStuff = $.parseXML("<SelfClosingNode />");
    var $newStuff = $(newStuff.documentElement);
    $xml.find("project").append($newStuff);

    console.log(xml.documentElement);    

    // Needed if you are running in IE
    if (window.ActiveXObject) {
      var new_xml_string = xml.xml;
    } else {
      var new_xml_string = (new XMLSerializer()).serializeToString(xml);
    }

    alert( new_xml_string );

} catch(e){

    alert(e);

} 
```

不幸的是，强制使用自闭合标签的是 XMLSerializer，而不是 JQuery。自闭标签被认为对 XML 有效，但对 XHTML 无效。如果您查看控制台日志输出（参见`console.log`上面的语句），您可以看到标签实际上并没有在 DOM 中自我关闭。

一种快速而肮脏的方法是更改`<node></node>`​​为`<node><!-- comment --></node>`.

否则，您的外部程序可能必须更灵活地读取这些自闭合标签，因为它们是有效的 XML。在现有 XML 中替换自闭合标签存在一些问题，例如[Replace XML self-closing tag with empty one](https://stackoverflow.com/questions/5939165/replace-xml-self-closing-tag-with-empty-one)

# c# - FormView 中的文件上传（作为参数）

> ID：13479447
> 
> 赞同：1
> 
> 时间：2012-11-20T18:10:56.517
> 
> 标签：c#, asp.net, file-upload, formview

我有三种状态的 FormView：ItemTemplate、EditItemTemplate 和 InsertItemTemplate。在 ItemTemaplate 中，我可以通过外部方式从数据库下载文件：

```
<asp:LinkButton runat="server" OnCommand="GetBenefitPdf" CommandArgument='<%# Eval("benefit_id") %>' Text="Get PDF" /> 
```

和：

```
protected void GetBenefitPdf(object sender, CommandEventArgs e)
{
    int benefit_id = int.Parse(e.CommandArgument.ToString());
    Response.Redirect("GetPdf.aspx?id=" + benefit_id + "&page=ManageBenefits.aspx");
} 
```

但是我还需要在InsertItemTemplate和EditItemTemplate中上传一个文件（附件）。在上述两个中，我都做了：

```
<asp:FileUpload ID="filedata" runat="server" /> 
```

但是 SQL 命令（给出了参数）是个例外：

> 字符串或二进制数据将被截断。该语句已终止。

我该如何处理？

编辑：给出了 SQL：

```
<asp:SqlDataSource ID="SqlDataSourceManageBenefits" runat="server" ConnectionString="<%$ ConnectionStrings:validConnectionString %>"
SelectCommand="SELECT [min_buyers], [active], [benefit_id], [name], [description], [price], [avail_pcs], [type], [months], [link], [family], [start_date], [end_date], [months_cancel], [price_month], [price_full], [payroll], [payroll_add], [payroll_sub], [price_all], [labor_id], [filedata] FROM [benefits]"
FilterExpression=" type='{0}' " ConflictDetection="CompareAllValues" DeleteCommand="DELETE FROM [benefits] WHERE [benefit_id] = @original_benefit_id AND (([min_buyers] = @original_min_buyers) OR ([min_buyers] IS NULL AND @original_min_buyers IS NULL)) AND [active] = @original_active AND (([name] = @original_name) OR ([name] IS NULL AND @original_name IS NULL)) AND (([description] = @original_description) OR ([description] IS NULL AND @original_description IS NULL)) AND (([price] = @original_price) OR ([price] IS NULL AND @original_price IS NULL)) AND (([avail_pcs] = @original_avail_pcs) OR ([avail_pcs] IS NULL AND @original_avail_pcs IS NULL)) AND (([type] = @original_type) OR ([type] IS NULL AND @original_type IS NULL)) AND (([months] = @original_months) OR ([months] IS NULL AND @original_months IS NULL)) AND (([link] = @original_link) OR ([link] IS NULL AND @original_link IS NULL)) AND (([family] = @original_family) OR ([family] IS NULL AND @original_family IS NULL)) AND (([start_date] = @original_start_date) OR ([start_date] IS NULL AND @original_start_date IS NULL)) AND (([end_date] = @original_end_date) OR ([end_date] IS NULL AND @original_end_date IS NULL)) AND (([months_cancel] = @original_months_cancel) OR ([months_cancel] IS NULL AND @original_months_cancel IS NULL)) AND (([price_month] = @original_price_month) OR ([price_month] IS NULL AND @original_price_month IS NULL)) AND (([price_full] = @original_price_full) OR ([price_full] IS NULL AND @original_price_full IS NULL)) AND (([payroll] = @original_payroll) OR ([payroll] IS NULL AND @original_payroll IS NULL)) AND (([payroll_add] = @original_payroll_add) OR ([payroll_add] IS NULL AND @original_payroll_add IS NULL)) AND (([payroll_sub] = @original_payroll_sub) OR ([payroll_sub] IS NULL AND @original_payroll_sub IS NULL)) AND (([price_all] = @original_price_all) OR ([price_all] IS NULL AND @original_price_all IS NULL)) AND (([labor_id] = @original_labor_id) OR ([labor_id] IS NULL AND @original_labor_id IS NULL)) AND (([filedata] = @original_filedata) OR ([filedata] IS NULL AND @original_filedata IS NULL))" InsertCommand="INSERT INTO [benefits] ([min_buyers], [active], [name], [description], [price], [avail_pcs], [type], [months], [link], [family], [start_date], [end_date], [months_cancel], [price_month], [price_full], [payroll], [payroll_add], [payroll_sub], [price_all]), [labor_id], [filedata] VALUES (@min_buyers, @active, @name, @description, @price, @avail_pcs, @type, @months, @link, @family, @start_date, @end_date, @months_cancel, @price_month, @price_full, @payroll, @payroll_add, @payroll_sub, @price_all, @labor_id, @filedata)" OldValuesParameterFormatString="original_{0}" UpdateCommand="UPDATE [benefits] SET [min_buyers] = @min_buyers, [active] = @active, [name] = @name, [description] = @description, [price] = @price, [avail_pcs] = @avail_pcs, [type] = @type, [months] = @months, [link] = @link, [family] = @family, [start_date] = @start_date, [end_date] = @end_date, [months_cancel] = @months_cancel, [price_month] = @price_month, [price_full] = @price_full, [payroll] = @payroll, [payroll_add] = @payroll_add, [payroll_sub] = @payroll_sub, [price_all] = @price_all, [labor_id] = @labor_id, [filedata] = @filedata WHERE [benefit_id] = @original_benefit_id AND (([min_buyers] = @original_min_buyers) OR ([min_buyers] IS NULL AND @original_min_buyers IS NULL)) AND [active] = @original_active AND (([name] = @original_name) OR ([name] IS NULL AND @original_name IS NULL)) AND (([description] = @original_description) OR ([description] IS NULL AND @original_description IS NULL)) AND (([price] = @original_price) OR ([price] IS NULL AND @original_price IS NULL)) AND (([avail_pcs] = @original_avail_pcs) OR ([avail_pcs] IS NULL AND @original_avail_pcs IS NULL)) AND (([type] = @original_type) OR ([type] IS NULL AND @original_type IS NULL)) AND (([months] = @original_months) OR ([months] IS NULL AND @original_months IS NULL)) AND (([link] = @original_link) OR ([link] IS NULL AND @original_link IS NULL)) AND (([family] = @original_family) OR ([family] IS NULL AND @original_family IS NULL)) AND (([start_date] = @original_start_date) OR ([start_date] IS NULL AND @original_start_date IS NULL)) AND (([end_date] = @original_end_date) OR ([end_date] IS NULL AND @original_end_date IS NULL)) AND (([months_cancel] = @original_months_cancel) OR ([months_cancel] IS NULL AND @original_months_cancel IS NULL)) AND (([price_month] = @original_price_month) OR ([price_month] IS NULL AND @original_price_month IS NULL)) AND (([price_full] = @original_price_full) OR ([price_full] IS NULL AND @original_price_full IS NULL)) AND (([payroll] = @original_payroll) OR ([payroll] IS NULL AND @original_payroll IS NULL)) AND (([payroll_add] = @original_payroll_add) OR ([payroll_add] IS NULL AND @original_payroll_add IS NULL)) AND (([payroll_sub] = @original_payroll_sub) OR ([payroll_sub] IS NULL AND @original_payroll_sub IS NULL)) AND (([price_all] = @original_price_all) OR ([price_all] IS NULL AND @original_price_all IS NULL)) AND (([labor_id] = @original_labor_id) OR ([labor_id] IS NULL AND @original_labor_id IS NULL)) AND (([filedata] = @original_filedata) OR ([filedata] IS NULL AND @original_filedata IS NULL))"> 
```

还有参数：

```
<asp:Parameter Name="original_filedata" Type="Byte" />
<asp:Parameter Name="filedata" Type="Byte" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:09:06.183

好的，我解决了。解决方案是使用：

```
<asp:Parameter Name="original_filedata" DbType="Binary" />
<asp:Parameter Name="filedata" DbType="Binary" /> 
```

并制作 OnInserting 和 OnUpdating 命令：

```
protected void Attach(object sender, SqlDataSourceCommandEventArgs e)
{
    var file = ((FileUpload)FormViewManageBenefits.FindControl("filedata")).FileBytes;
    e.Command.Parameters["@filedata"].Value = file;
} 
```

# arduino - 尝试将缺少的关键字添加到 SD 库“keywords.txt”文件中

> ID：13479452
> 
> 赞同：1
> 
> 时间：2012-11-20T18:11:08.537
> 
> 标签：arduino

我搜索了这个问题，但我找不到任何关于它的信息。但是，当我写草图时，我注意到一些关键字没有在 Arduino IDE 中突出显示。

具体来说，我使用的是 SD 卡库（基于[sdfatlib](http://code.google.com/p/sdfatlib/)），我注意到`isDirectory()`,`openNextFile()`和其他几个方法没有突出显示。因此，我打开了`keywords.txt`文件并将它们添加到相应的部分 ( `KEYWORDS2`)。它没有用。我的问题是：

1.  为什么他们失踪了？
2.  我如何添加它们（或者我应该添加它们）并让它们工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T04:47:19.287

缺少这些关键字可能是疏忽。您可以将它们添加到`keywords.txt`文件中以突出显示。

除此之外，您还可以向官方[Arduino GitHub 存储库](https://github.com/arduino/Arduino)发送拉取请求。

# plugins - 如何在 UberMenu 中调整菜单项的宽度

> ID：13479458
> 
> 赞同：1
> 
> 时间：2012-11-20T13:24:17.620
> 
> 标签：plugins, menu

我在我的网站上安装了 Ubermenu 插件：

[aep.gov.tr](http://www.aep.gov.tr)

菜单项的宽度太宽。因此，菜单不适合其容器，如下所示：

![在此处输入图像描述](../Images/6a29169052b3ec52fa7bb1afc9d47c13.png)

如何使菜单项的宽度变窄？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T14:26:27.840

这更像是一个 CSS 问题/问题，而不是与 Wordpress 相关的问题。您的主要问题是 style.css 的第 36 行：

```
.navigation ul li a{display:block; float:left; color:#666; text-decoration:none; padding:15px 0 0 0; height:28px; width:130px;} 
```

您需要在`<li>`此处删除标签的宽度属性。这将把你的菜单放在一行上。

因此，您将拥有的是：

```
.navigation ul li a{display:block; float:left; color:#666; text-decoration:none; padding:15px 0 0 0; height:28px;} 
```

我建议使用您的宽度属性和高度属性来强制菜单看起来正确。另一个建议是使用 Firebug for Firefox 或 Google Chrome 来帮助调试 CSS 问题。它可以帮助您快速找到它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-16T08:38:06.583

转到**admin.css**文件并注意您可能会失去保修，更改以下内容：

```
#megaMenu.megaFullWidth
{
    width:100%;
} 
```

至

```
#megaMenu.megaFullWidth
{
    width:auto;
} 
```

希望它会有所帮助。

# xml - oracle dbms_xmldom.ISNULL 10G和11G有什么区别？

> ID：13479465
> 
> 赞同：2
> 
> 时间：2012-11-20T18:12:08.390
> 
> 标签：xml, oracle, plsql, database, isnull

对于下面的代码，在 Oracle 10g 中，它说节点是空的，在 11g 中，它不是空的。在 side 之间有一个换行符。如果里面有空格，两个版本的结果是一样的。一旦里面什么都没有，两个版本都不会有输出。为什么会这样？

```
DECLARE
   v_doc                dbms_xmldom.DOMDocument;
   v_elem               dbms_xmldom.DOMElement;
   v_nelem              dbms_xmldom.DOMNode;    
BEGIN
   -- create the DOMDocument
   v_doc := dbms_xmldom.newDOMDocument(xmlType('<XMLDATA>
                         </XMLDATA>'));
   v_nelem := DBMS_XMLDOM.MAKENODE(v_doc);
   v_nelem := DBMS_XSLPROCESSOR.SELECTSINGLENODE(v_nelem,'XMLDATA/text()');
   IF NOT(dbms_xmldom.ISNULL(v_nelem)) THEN      
      DBMS_OUTPUT.PUT_LINE('The node is not empty');
   END IF; 
END;
/ 
```

# haskell - Haskell - 缺乏伴随绑定

> ID：13479469
> 
> 赞同：0
> 
> 时间：2012-11-20T18:12:13.907
> 
> 标签：haskell

```
genSuffixes::[Char]->[[Char]]
getSuffixes (xs) = suffix 0 (xs)
suffix::Int->[Char]->[[Char]]
suffix n (xs) = if n==length(xs)
           then(xs)
           else drop n (xs) ++ suffix (n+1) (xs) 
```

`genSuffixes`尝试编译代码时，我得到“缺少伴随绑定的类型签名”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:17:29.750

检查你的拼写：你给`genSuffixes`(with an ) 一个类型签名，但是给(with a )`n`一个定义。`getSuffixes``t`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T18:16:49.393

您拼错了`genSuffixes`或之一`getSuffixes`。

# objective-c - NSImage drawInRect:fromRect:operation:fraction: 坐标系

> ID：13479472
> 
> 赞同：1
> 
> 时间：2012-11-20T18:12:17.650
> 
> 标签：objective-c, pixel, point, nsimage, nsrect

文档说第一个参数是

> "绘制图像的矩形，在当前坐标系中指定"

这是什么意思？我应该假设该矩形的大小是像素还是点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:53:11.133

它位于当前上下文的坐标系中。

Quartz 图形上下文定义了一个具有初始大小的坐标系，并在其上应用了额外的变换。所以你必须知道你在哪个上下文中绘制以及当前的变换矩阵（CTM）是什么。

在 NSViews 中绘制时，当前上下文以您指定点坐标的方式设置。这与非视网膜显示器上的像素相同。y 轴的方向取决于视图的翻转度 ( `-[NSView isFlipped]`)。

# javascript - 计算上个月

> ID：13479473
> 
> 赞同：0
> 
> 时间：2012-11-20T18:12:18.420
> 
> 标签：javascript, calendar

所以我有这个函数，它基本上接受一个整数的输入，并根据今天的日期，它可以追溯到那个“n”个月。例如，今天的日期是 2012 年 11 月 20 日。如果 'n' = 1，则返回 2012 年 10 月 20 日，依此类推。

我面临的问题是每个月份都在 2 月至 5 月之间，年份变量减一。例如，如果 n = 6，它应该返回 2012 年 5 月 20 日。相反，它返回 2011 年 5 月 20 日。

我认为这可能是闰年问题，但是当我用 n = 18 对其进行测试时，它返回 2010 年 5 月 20 日而不是 2011 年 5 月 20 日，并且 2011 年不是闰年。

有谁知道我可以在这里做些什么来避免这种情况？

```
lastNmonths = function(n) {
   var date = new Date();

   if (n <= 0)
       console.log( [date.getFullYear(), date.getMonth() + 1 , date.getDate()].join('-'));

  var years = Math.round(n / 12);
  var months = n % 12;

   if (years > 0)
       date.setFullYear(date.getFullYear() - years);

   if (months > 0) {
       if (months >= date.getMonth()) {
           date.setFullYear(date.getFullYear() );
           months = 12 - months;
           date.setMonth(date.getMonth() + months );
       } else {
           date.setMonth(date.getMonth() - months);
       }
   }

   console.log( [date.getFullYear(), date.getMonth() + 1, date.getDate()].join('-'));
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:32:09.457

你的方法是不必要的复杂，必然容易出错。`Date`改用实例的内置溢出控制：

```
var n = 6;
var d = new Date();
d.setMonth(d.getMonth() - n); 
```

# java - 如何遍历数组并添加某些值？

> ID：13479474
> 
> 赞同：0
> 
> 时间：2012-11-20T18:12:19.270
> 
> 标签：java

我会尝试更好地解释它。

所以 k = 2\. In[]profits = new {1, 2, 3, 1, 6, 10}

对于第一部分，它应该是：

1,2,3

然后在 {1,2,3} 中寻找最小值，即 1。然后将其添加到下一个值 1。所以它将是 1+1。结果将是 {2,3,2}。再次寻找最小值 2 并将其添加到下一个值 6。所以它将是 2+6。结果将是 {3, 2, 8}。最后，对于 {3,2,8} 中的最小值并将其添加到下一个值 10。所以它将是 10+2。结果是 {2, 8, 10}。然后在 2 中寻找最小值。

如果你们至少可以指导我如何做到这一点？

这是测试仪：

```
import java.util.Arrays ;

 /**
 Presents some problems to the BillBoard class.
 */

public class BillboardTester {

    public static void main(String[] args) {
    int[] profits = new int[]{1, 2, 3, 1, 6, 10} ;

        int k = 2 ;

        System.out.println("Profits: " + Arrays.toString(profits) + "   k = " + k)  ;

        Billboard bb = new Billboard(profits, k) ;
        System.out.println("Maximum Profit = " + bb.maximumProfit()) ;
        System.out.println(bb) ;

        k = 3 ;
        profits = new int[]{7, 4, 5, 6, 1, 7, 8, 9, 2, 5} ;
        System.out.println("Profits: " + Arrays.toString(profits) + "   k = " + k)  ;
        bb = new Billboard(profits, k) ;
        System.out.println("Maximum Profit = " + bb.maximumProfit()) ;
        System.out.println(bb) ;
    }
} 
```

这是我到目前为止的课程：

```
public class Billboard {
    private int maximumprofit; // The max profit 
    private int finalcost; // The final cost of removing the billboards

    public Billboard(int[]profits, int k) {
        for (int i = 0; i < profits.length; i++) {
            maximumprofit+= profits[i];
        }
    }

    public int maximumProfit() {
        return maximumprofit;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:30:13.717

如果我正确理解您的问题，那么您就有`k+1`可能的总计，并且无论它是什么，您都将每个新的利润元素添加到最低的当前总利润中。所以在你的例子中，它真的

*   `1, 2, 3`
*   `1+1=2, 2, 3`
*   `2+6=8, 2, 3`
*   `8, 2+10=12, 3`

对于最终数组

*   `8, 12, 3`-> 最低值实际上是`3`

如果这就是你的意思（你从未说过是什么`k`），那么这段代码就可以完成这项工作。我在那里留下了一行调试代码来帮助您检查正确性。

```
public class Billboard
{
    private int[] profits;
    private int k;
    public Billboard(int[]profits, int k)
    {
        this.profits = profits;
        this.k = k+1; // I changed this to k+1 because you have 3 totals with k = 2
    }
    public int maximumProfit() {
        int[] bottom = new int[k];

        for(int i = 0; i < profits.length; i++) {
            int minIndex = 0;
            int min = Integer.MAX_VALUE;
            for (int j = 0; j < k; j++) {
                if (bottom[j] < min) {
                    minIndex = j;
                    min = bottom[j];
                }
            }
            bottom[minIndex] += profits[i];
        }

        int min = Integer.MAX_VALUE;
        for(int i = 0; i < k; i++) {
            System.out.println("TestDump: #"+i+" is: " + bottom[i]);
            if (bottom[i] < min) {
                min = bottom[i];
            }
        }

        return min;
    }

    public static void main(String args[]) {
        Billboard bb = new Billboard(new int[]{1,2,3,1,6,10}, 2);
        System.out.println("Maximum profit = " + bb.maximumProfit());
    }
} 
```

此代码输出

```
TestDump: #0 is: 8
TestDump: #1 is: 12
TestDump: #2 is: 3
Maximum profit = 3 
```

要更改`Billboard`类在放入时输出的内容`System.out.println(bb)`，您必须重写类的`toString`方法`Billboard`，即

```
@Override
public String toString() {
    return (new StringBuider(totalProfit - maxProfit)).toString();
} 
```

假设您之前将类中的字段设置为具有正确的值。

# javascript - 图表渲染后，从图表对象更改 Highcharts 工具提示格式化程序

> ID：13479476
> 
> 赞同：12
> 
> 时间：2012-11-20T18:12:24.883
> 
> 标签：javascript, tooltip, highcharts, formatter

我发现我可以使用 setData 更改系列，并且我知道我可以使用 .setExtremes 修改 Max 值，但我无法弄清楚如何从图表对象设置工具提示格式化程序。如何更新该字段？如果我有一个图表对象，如何更新其工具提示格式化程序属性？以及 plotOptions 工具提示格式化程序怎么样？

我尝试过的：

```
chart1.tooltip.formatter = function() {return ''+this.series.name +'example: '+ this.y      +'example';}; 
```

但是当我在图表定义（用于测试）之后添加它时，我的工具提示没有任何变化。另外，我注意到这

```
console.log (chart1.tooltip.formatter); 
```

返回未定义，但我不知道为什么。

小提琴，所以你可以试试。

[http://jsfiddle.net/pCuUW/5/](http://jsfiddle.net/pCuUW/5/) 在此先感谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-20T19:12:18.390

您可以`chart.tooltip.options.formatter`改用，例如

```
chart.tooltip.options.formatter = function() {
    var xyArr=[];
    $.each(this.points,function(){
        xyArr.push('Serie: ' + this.series.name + ', ' +'X: ' + this.x + ', Y: ' +this.y);
    });
    return xyArr.join('<br/>');
} 
```

**[动态更改工具提示格式化程序 | Highchart & Highstock @ jsFiddle](http://jsfiddle.net/jugal/zAGGT/)**

**更新** 在新的（5.0.0+）版本的highcharts中，这也可以使用[`chart.update()`](http://api.highcharts.com/highcharts/Chart.update)方法来完成

```
 chart.update({
    tooltip: {
      formatter: function() {
        var xyArr = [];
        $.each(this.points, function() {
          xyArr.push('Serie: ' + this.series.name + ', ' + 'X: ' + this.x + ', Y: ' + this.y);
        });
        return xyArr.join('<br/>');
      }
    }
  }); 
```

**[使用 chart.update 动态更改工具提示格式化程序 | Highchart & Highstock @ jsFiddle](http://jsfiddle.net/jugal/8x4dp2c2/1/)**

# jquery - jQuery removeclass 不起作用

> ID：13479477
> 
> 赞同：0
> 
> 时间：2012-11-20T18:12:27.393
> 
> 标签：jquery, css

```
$('.shortcode').removeClass('.shortcode');
$('.shortcode').hide(); 
```

为什么`.shortcode`物品还是被隐藏了？在源代码中，它们仍然有短代码类。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-20T18:13:33.800

删除点“。”。这将起作用

```
$('.shortcode').removeClass('shortCode'); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-20T18:13:40.447

您不应该`.`在传递给的字符串中使用`removeClass`：this...

```
$('.shortcode').removeClass('shortCode'); 
```

... 足够了。想一想：如果方法无论如何都打算删除一个*类*，为什么要用类 sigil ( `.`) 标记它的参数？:)

在真正的 className 前面加上点，jQuery 会尝试删除`'.shortCode'`class - 显然，这里是无操作的。

# sql-server - LINQ查询，使用Union还是Intersect？

> ID：13479479
> 
> 赞同：0
> 
> 时间：2012-11-20T18:12:31.467
> 
> 标签：sql-server, linq-to-entities

我正在开发一个 asp mvc 应用程序。我正在整理一个查询，其中包含来自 2 个不同表的 2 个名称列表，然后应该将它们放在一起。该查询在一个方法中，因此我可以轻松调用它。我遇到的问题是我得到一个错误，无论我是尝试联合还是相交。错误是：

“Model.PersonAttributes 不包含联合（或相交）和最佳重载的定义，等等等等……”

这是我的代码：

```
 public List<SearchAndMergeViewModel> SearchForMerge(string FName, string LName, string DOB)
    {
        var query = from p in _Elig_DB.PersonAttributes.ToList()
                            where p.getDateOfBirth == DOB &&
                             (p.FirstName.Contains(FName) || p.FirstName.StartsWith(FName) &&
                             p.LastName.Contains(LName) || p.LastName.StartsWith(LName))
                            select p;

        var queryb = from a in _Elig_DB.PersonAlias.ToList()
                     join e in _Elig_DB.PersonAttributes.ToList() on a.PersonID equals e.PersonID
                     where a.FirstName == FName && a.LastName == LName
                     select new SearchAndMergeViewModel
                     {
                         FirstN = a.FirstName,
                         LastN = a.LastName,
                         DOB = e.DOB
                     };

        var results = query.Intersect(queryb);

        return results.ToList();
    } 
```

上述错误与“var results = query.Intersect(queryb);”行有关。

我还收到一个错误，“无法从用法中推断出方法 Enumerable.ToList 的类型参数。”

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:58:02.230

试试这个：

```
 public List<SearchAndMergeViewModel> SearchForMerge
       (string firstName, string lastName, string dateOfBirth)
    {
        var queryA =
            from a in _Elig_DB.PersonAttributes.ToList()
            where
                a.getDateOfBirth == dateOfBirth 
                && a.FirstName.Contains(firstName)
                && a.LastName.Contains(lastName)
            select new SearchAndMergeViewModel
            {
                FirstN = a.FirstName,
                LastN = a.LastName,
                DOB = a.getDateOfBirth
            };

        var queryB = 
            from b in _Elig_DB.PersonAlias
            join a in _Elig_DB.PersonAttributes
                on new { b.PersonID, b.FirstName, b.LastName }
                equals new { a.PersonID, a.FirstName, a.LastName }
            select new SearchAndMergeViewModel
            {
                FirstN = a.FirstName,
                LastN = a.LastName,
                DOB = a.getDateOfBirth
            };

        var results = queryA.Intersect(queryB);

        return results.ToList();
    } 
```

我在处理时对您的代码进行了一些修改，但重要的是我也将**第一个**结果转换为 SearchAndMergeViewModel。

此外，删除了多余的 StartsWith(...) 过滤器。

我假设 PersonAttributes.getDateOfBirth 是一个计算属性。如果没有，您也应该从第一个查询中删除 ToList()。如果不需要，您不想将整个表加载到 EF 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:37:03.027

我想到了。我需要在第一个查询中指定返回的列，所以它们都匹配：

```
 public List<SearchAndMergeViewModel> SearchForMerge(string FName, string LName, string DOB)
    {
        var query = from p in _Elig_DB.PersonAttributes.ToList()
                    where p.getDateOfBirth == DOB &&
                     (p.FirstName.Contains(FName) || p.FirstName.StartsWith(FName) &&
                     p.LastName.Contains(LName) || p.LastName.StartsWith(LName))
                    select new SearchAndMergeViewModel
                    {
                        FirstName = p.FirstName,
                        LastName = p.LastName,
                        DOB = p.DOB,
                        PersonID = p.PersonID
                    };

        var queryb = from a in _Elig_DB.PersonAlias.ToList()
                     join e in _Elig_DB.PersonAttributes.ToList() on a.PersonID equals e.PersonID
                     where a.FirstName == FName && a.LastName == LName
                     select new SearchAndMergeViewModel
                     {
                         FirstName = a.FirstName,
                         LastName = a.LastName,
                         DOB = e.DOB,
                         PersonID = a.PersonID
                     };

        var results = query.Union(queryb).ToList();

        return results;
    } 
```

# vb.net - vb.net 中的加密/解密并不总是返回相同的值

> ID：13479483
> 
> 赞同：1
> 
> 时间：2012-11-20T18:12:50.950
> 
> 标签：vb.net, encryption, rijndaelmanaged

我有一个程序，我可以在其中编写和读取配置文件。当我写作时，我使用 vb.net 中的 RijndaelManaged 对象加密整个文件，当我阅读时，我使用相同的密钥和初始化向量值解密。

在我的开发机器和许多其他机器上一切正常。但是，某些 PC 无法使用相同的程序加密/解密文件。

这个加密对象中是否有任何东西可以阻止它，你会推荐使用什么？

谢谢

编辑：这是我用来加密和解密的代码：据我所知，如果我从我的主机加密字节，我可以从任何 PC 上解密它。但是，如果我从另一台 PC 加密字节，我无法从任何 PC 解密它。另外，当我查看文件的内容时，它们看起来根本不一样。请注意，我通常采用的方法是从文件（通常是 XML）创建一个内存流，然后加密/解密。

```
Public Shared Function EncryptBytes(ByVal strContenu() As Byte, ByVal initVectorBytes() As Byte, ByVal saltValueBytes() As Byte) As Byte()

    ' Convert our plaintext into a byte array.
    ' Let us assume that plaintext contains UTF8-encoded characters.
    Dim plainTextBytes As Byte() = strContenu
    'plainTextBytes = System.Text.Encoding.Unicode.GetBytes(strMessage)

    Dim strPassPhrase As String = "d%6&?76dhd8?532LDhds8!7?&?8&?dhcv77"

    Dim strHashAlgorithm As String = "SHA1"

    Dim intPswdIterations As Integer = 2

    ' First, we must create a password, from which the key will be derived.
    ' This password will be generated from the specified passphrase and 
    ' salt value. The password will be created using the specified hash 
    ' algorithm. Password creation can be done in several iterations.
    Dim password As PasswordDeriveBytes
    password = New PasswordDeriveBytes(strPassPhrase, _
                                       saltValueBytes, _
                                       strHashAlgorithm, _
                                       intPswdIterations)

    ' Use the password to generate pseudo-random bytes for the encryption
    ' key. Specify the size of the key in bytes (instead of bits).
    Dim keyBytes As Byte()
    keyBytes = password.GetBytes(32)

    ' Create uninitialized Rijndael encryption object.
    Dim symmetricKey As RijndaelManaged
    symmetricKey = New RijndaelManaged()

    ' It is reasonable to set encryption mode to Cipher Block Chaining
    ' (CBC). Use default options for other symmetric key parameters.
    symmetricKey.Mode = CipherMode.CBC

    ' Generate encryptor from the existing key bytes and initialization 
    ' vector. Key size will be defined based on the number of the key 
    ' bytes.
    Dim encryptor As ICryptoTransform
    encryptor = symmetricKey.CreateEncryptor(keyBytes, initVectorBytes)

    ' Define memory stream which will be used to hold encrypted data.
    Dim memoryStream As System.IO.MemoryStream
    memoryStream = New System.IO.MemoryStream()

    ' Define cryptographic stream (always use Write mode for encryption).
    Dim cryptoStream As CryptoStream
    cryptoStream = New CryptoStream(memoryStream, _
                                    encryptor, _
                                    CryptoStreamMode.Write)
    ' Start encrypting.
    cryptoStream.Write(plainTextBytes, 0, plainTextBytes.Length)

    ' Finish encrypting.
    cryptoStream.FlushFinalBlock()

    ' Convert our encrypted data from a memory stream into a byte array.
    Dim cipherTextBytes As Byte()
    cipherTextBytes = memoryStream.ToArray()

    ' Close both streams.
    memoryStream.Close()
    cryptoStream.Close()

    ' Convert encrypted data into a base64-encoded string.
    'Dim cipherText As String
    'cipherText = 
    Return cipherTextBytes

    ' Return encrypted string.
    'Return cipherText

End Function

Public Shared Function DecryptBytes(ByVal strContenuEncrypte() As Byte, ByVal initVectorBytes() As Byte, ByVal saltValueBytes() As Byte) As Byte()

    ' Convert strings defining encryption key characteristics into byte
    ' arrays. Let us assume that strings only contain ASCII codes.
    ' If strings include Unicode characters, use Unicode, UTF7, or UTF8
    ' encoding.

    ' Convert our ciphertext into a byte array.
    Dim cipherTextBytes As Byte() = strContenuEncrypte

    Dim strPassPhrase As String = "d%6&?76dhd8DSDhds8!7?&?8&?dhcv77"

    Dim strHashAlgorithm As String = "SHA1"

    Dim intPswdIterations As Integer = 2

    ' First, we must create a password, from which the key will be 
    ' derived. This password will be generated from the specified 
    ' passphrase and salt value. The password will be created using
    ' the specified hash algorithm. Password creation can be done in
    ' several iterations.
    Dim password As PasswordDeriveBytes
    password = New PasswordDeriveBytes(strPassPhrase, _
                                       saltValueBytes, _
                                       strHashAlgorithm, _
                                       intPswdIterations)

    ' Use the password to generate pseudo-random bytes for the encryption
    ' key. Specify the size of the key in bytes (instead of bits).
    Dim keyBytes As Byte()
    keyBytes = password.GetBytes(32)

    ' Create uninitialized Rijndael encryption object.
    Dim symmetricKey As RijndaelManaged
    symmetricKey = New RijndaelManaged()

    ' It is reasonable to set encryption mode to Cipher Block Chaining
    ' (CBC). Use default options for other symmetric key parameters.
    symmetricKey.Mode = CipherMode.CBC

    ' Generate decryptor from the existing key bytes and initialization 
    ' vector. Key size will be defined based on the number of the key 
    ' bytes.
    Dim decryptor As ICryptoTransform
    decryptor = symmetricKey.CreateDecryptor(keyBytes, initVectorBytes)

    ' Define memory stream which will be used to hold encrypted data.
    Dim memoryStream As System.IO.MemoryStream
    memoryStream = New System.IO.MemoryStream(cipherTextBytes)

    ' Define memory stream which will be used to hold encrypted data.
    Dim cryptoStream As CryptoStream
    cryptoStream = New CryptoStream(memoryStream, _
                                    decryptor, _
                                    CryptoStreamMode.Read)

    ' Since at this point we don't know what the size of decrypted data
    ' will be, allocate the buffer long enough to hold ciphertext;
    ' plaintext is never longer than ciphertext.
    Dim plainTextBytes As Byte()
    ReDim plainTextBytes(cipherTextBytes.Length)

    ' Start decrypting.
    Dim decryptedByteCount As Integer
    decryptedByteCount = cryptoStream.Read(plainTextBytes, _
                                           0, _
                                           plainTextBytes.Length)

    ' Close both streams.
    memoryStream.Close()
    cryptoStream.Close()

    ' Convert decrypted data into a string. 
    ' Let us assume that the original plaintext string was UTF8-encoded.
    Dim plainText As String
    plainText = System.Text.Encoding.Unicode.GetString(plainTextBytes, _
                                        0, _
                                        decryptedByteCount)

    ' Return decrypted string.
    Return plainTextBytes

End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:05:58.980

如果您使用 Mono 而不是普通的 .NET 作为运行时，那么`PasswordDeriveBytes`任何高于 20 的输出都会失败。`PasswordDeriveBytes`当请求的输出多于哈希输出可以提供的输出时，使用未知的、专有的、非确定性的、损坏的、密码不安全的方法内`PasswordDeriveBytes`。[这已被 Mono 开发人员标记为不可修复。](https://bugzilla.novell.com/show_bug.cgi?id=372893#c1).

最好的办法是升级到`Rfc2898DeriveBytes`，它实现了 PBKDF2 而不是 PBKDF1。PBKDF2 定义了如何扩展输出量，因此所有实现都应该按照指定的方式运行。

如果您需要比散列函数提供的更多输出，那么使用 KBKDF（例如 HKDF）比 PBKDF2 的输出更安全。PKBDF2 需要另一轮完整的轮次来创建更多数据，这可能有利于攻击者而不是普通用户，并且会根据请求的字节数增加两倍或三倍的 CPU 负载。

[编辑]

另请注意，它的构造函数`PasswordDeriveBytes`采用密码*字符串*并没有指定要使用的字符编码，因此最好在将其提供给构造函数之前将其转换为字节。

根据大多数观察结果，两者似乎都使用 UTF-8 - 请注意其他运行时（例如 Java）在这方面可能会有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-28T10:23:15.127

您不能将 120Gb 文件上传到 byte()。或者你有一些疯狂的机器。尝试在 Ram 中逐字节上传

```
Dim fStream As FileStream = New FileStream("Encrypted.Encrypted", FileMode.Create)
        Dim cryptoStream As New CryptoStream(fStream, Encryptor, CryptoStreamMode.Write)
        Using UploadFile As FileStream = New FileStream(OpenfileDialog.FileName, FileMode.Open)
            For i = 0 To UploadFile.Length - 1
                Dim NewByte As New Byte
                NewByte = UploadFile.ReadByte
                cryptoStream.WriteByte(NewByte)
            Next
        End Using

        cryptoStream.FlushFinalBlock()
        cryptoStream.Close()
        fStream.Close() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:29:34.900

一个疯狂的猜测：您是在文本模式下编写和读取文件吗？当加密数据恰好包含 0x1A（EOF，ctrl-z）时，读取可能会过早停止，并且您解密到几个字节。

# mongodb - MongoDB密码和Lithium框架

> ID：13479484
> 
> 赞同：0
> 
> 时间：2012-11-20T18:12:59.747
> 
> 标签：mongodb, passwords, lithium

我遇到了从数据库中删除 MongoDB 密码的场景。然后锂显示“连接已重置..”，而不是锂错误。

我将逐步向您解释：

在`Connections.php`

```
Connections::add('default', array(
 'type' => 'MongoDb',
 'host' => 'localhost',
 'database' => 'CWMG'
)); 
```

在 Mongo 中添加用户：

```
C:\>Mongo
> use CWMG
> db.addUser('mongo','awesomeness'); 
```

改变`Connections.php`

```
Connections::add('default', array(
  'type' => 'MongoDb',
  'host' => 'localhost',
  'database' => 'CWMG',
  'login' => 'mongo',
  'password' => 'awesomeness'
)); 
```

现在从 Mongo 中删除用户

```
db.removeUser('mongo'); 
```

更改连接`Connections.php`- 现在不使用密码...

```
Connections::add('default', array(
 'type' => 'MongoDb',
 'host' => 'localhost',
 'database' => 'CWMG'
)); 
```

现在，Connections.php 将不起作用；如果您浏览该网站.. 我们收到错误：“连接已重置”，有时它会重定向到另一个网站。

![页面失去连接](../Images/364f4755a6a32afa039111b473978b03.png)

我发现唯一的解决方案是在 MongoDB 中重新添加用户，在 Lithium 中也是如此。

所以我的问题是如何从 MongoDB 中删除用户，一旦添加？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T09:41:41.443

最后，我找到了解决方案。存储密码关联的是MongoDB。要删除它，我首先尝试

1.  导出 Mongo 数据库
2.  停止服务
3.  删除 Mongo 数据库
4.  启动服务
5.  导入的 Mongo 数据库

检查解决方案。

**同样的问题**

所以我尝试了最终也是唯一的解决方案：

1.  导出 Mongo 数据库
2.  停止服务
3.  删除了 MongoDB 文件夹
4.  再次安装Mongo
5.  启动服务
6.  导入的 Mongo 数据库

是的！现在工作正常！

# android - 从 android 到 webservice .net SOAP 的图像

> ID：13479486
> 
> 赞同：1
> 
> 时间：2012-11-20T18:13:06.627
> 
> 标签：android, .net, web-services, base64

我需要将图像从 android 应用程序发送到 webservice .net soap。

从android发送图像的方法：

```
ByteArrayOutputStream bytes = new ByteArrayOutputStream();
bitmap.compress(Bitmap.CompressFormat.PNG, 100, bytes);                 
byte[] b = bytes.toByteArray();
String base64String = Base64.encode(b); 
```

在 .net 网络服务上接收：

```
public void startApp(string bases){
   Image convertedImage = Base64ToImage(bases);
   convertedImage.Save(Server.MapPath("generated_image.jpg"), System.Drawing.Imaging.ImageFormat.Jpeg);
}
public static Image Base64ToImage(string base64String)
{
 // Convert Base64 String to byte[]
    byte[] imageBytes = Convert.FromBase64String(base64String);
    using (var ms = new MemoryStream(imageBytes, 0,
                                     imageBytes.Length))
    {
        // Convert byte[] to Image
        ms.Write(imageBytes, 0, imageBytes.Length);
        Image image = Image.FromStream(ms, true);
        return image;
    }
} 
```

Image.FromStream 中的错误（毫秒，真）；

参数无效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T13:27:55.080

我用 FTPClient 解决了我的问题。

# php - 什么是 SQL 注入攻击。？关于如何通过基本示例预防它们的一些提示

> ID：13479488
> 
> 赞同：-2
> 
> 时间：2012-11-20T18:13:10.980
> 
> 标签：php, mysql, sql-injection

> **可能重复：**
> [防止 SQL 注入的最佳方法？](https://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection)

我正在一个使用 MYSQL 数据库的 PHP 项目中工作。我阅读了有关 SQL 注入的信息，但希望有一些基本示例。如果攻击会发生什么。？

我是这个话题的新手。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T18:17:11.610

有很多话要说，但我只想说：

*   你应该看看这里：[Bobby Tables](http://bobby-tables.com/about.html)。

作为总结：

![在此处输入图像描述](../Images/025403fc22abc0063a207edf2248f7bc.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T18:17:21.520

基本上，如果您有这样的 SQL 调用：

```
"DELETE FROM Users WHERE InputtedName = '$name'" 
```

人们可以在表格上输入：`My Name' OR InputtedName != 'My Name`

当 $name 替换为表单中输入的名称时，这将导致以下 SQL 调用：

```
"DELETE FROM Users WHERE InputtedName = 'My Name' OR InputtedName != 'My Name'" 
```

那将删除您表中的所有内容！不好！因此，为了防止这种情况，您应该对所有用户输入的数据使用 mysql_real_escape_string() 函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T18:19:14.927

假设我有一个“用户”表，并且有人正在我的网站上注册一个帐户。他们输入他们的用户名，`'); drop table Users`这将提前终止我的 INSERT 语句并导致用户表被删除。

一个好的经验法则是“清理”您从用户那里收到的任何数据。为此，您需要使用 PHP 的[mysql_real_escape_string](http://php.net/manual/en/function.mysql-real-escape-string.php)（已弃用）。一个更好的选择是[准备好的语句](http://php.net/manual/en/book.mysqli.php)，尽管它们更长并且并不总是优雅的。

```
$stmt = $mysqli->prepare('select name from users where id = ?');
$stmt->bind_param($id,'s');
$id = 'some_id';
$stmt->execute();
$stmt->bind_result($name);
$stmt->fetch(); //variable $name now has the value of the first result 
```

# jquery - $.trim 文本输入值开头和结尾的空格

> ID：13479495
> 
> 赞同：2
> 
> 时间：2012-11-20T18:13:42.130
> 
> 标签：jquery

所以我试图在文本输入值之前和之后修剪任何空格......

有任何想法吗？使我抓狂。我试着继续阅读`$.trim()`。但不能让它正常工作。

代码：

```
var campaign_values = {
        name : $.trim($('.nameField').val().toLowerCase().replace(/\s/g, "_")),
        // other variables...
}; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T18:16:27.787

不确定您在使用 trim 时遇到了什么问题，但您应该可以像这样使用它：

```
var campaign_values = {
        name : $.trim($('.nameField').val()).toLowerCase().replace(/\s/g, "_"),
        // other variables...
}; 
```

虽然在这种情况下，我认为使用 javascript 更清晰`trim()`

```
var campaign_values = {
        name : $('.nameField').val().trim().toLowerCase().replace(/\s/g, "_"),
        // other variables...
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T18:17:52.777

`$.trim`在调用`replace`函数之前尝试使用：

```
name : $.trim($('.nameField').val()).toLowerCase().replace(/\s/g, "_"), 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:15:54.650

标准的 JavaScript String.trim() 将从字符串中删除开头和结尾的空格。

```
"   string  ".trim() ==  "string" 
```

# c - 如何在 C、linux 中启动 FTP 客户端的活动模式

> ID：13479499
> 
> 赞同：0
> 
> 时间：2012-11-20T18:14:00.480
> 
> 标签：c, linux, networking, ftp, ip

我必须在 C 中为 linux 编写一个小命令行 FTP 客户端。它适用于常见用途（目录管理、检索和存储文件等），我想添加活动模式（目前每次传输都是在被动模式下制作）。
我知道我必须发送以下形式的命令：

```
PORT a,b,c,d,e,f 
```

`a b c d`IP地址块和`e f`端口号在哪里。但是，据我了解，该 ip 必须是运行我的客户端的机器的 ip，但有人建议我使用`getsockname()`. 根据我的测试，`getsockname()`获取我的套接字使用的接口的本地 ip，而不是我从互联网上看到的 ip。所以我不能给服务器连接这个IP地址。

问题是：我`PORT`是否正确理解了命令，以及如何获得正确的 ip 来发送它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:29:07.060

FTP 主动模式意味着服务器打开与客户端的连接并自行发送数据。这通常是不切实际的，因此发明了被动模式：服务器打开一个额外的端口来监听传入的连接并在有人连接时开始传输。

因此，被动模式会话如下所示：

```
$ telnet localhost 21
220 Welcome to EarlGray FTP
USER ftp
331 Please specify the password.
PASS ftp
230 Login successful.
PASV 
227 Entering Passive Mode (127,0,0,1,185,37).
LIST
150 Here comes the directory listing.
            ---> here client opens another telnet session, 
            ---> connecting to the same server on port 185*256+37, specified by server:
              $ telnet localhost $((185 * 256 + 37))
              Trying 127.0.0.1...
              Connected to localhost.
              Escape character is '^]'.
              drwxrwxr-x    2 121      1003         4096 Aug 21 10:57 incoming
              drwxrwxr-x    7 0        1003         4096 Nov 09 21:04 pub
              Connection closed by foreign host.
            <---- end of data transfer session

226 Directory send OK. 
```

而活动会话的示例：

```
$ telnet localhost 21
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
220 Welcome to EarlGray FTP
USER ftp
331 Please specify the password.
PASS ftp
230 Login successful.
PORT 127,0,0,1,45,45                      (ports are specified by client)
200 PORT command successful. Consider using PASV.
LIST
150 Here comes the directory listing.

        ---> here client listens for an incoming connection on port 45*256+45
          $ nc -l 0.0.0.0 $((45 * 256 + 45))
          drwxrwxr-x    2 121      1003         4096 Aug 21 10:57 incoming
          drwxrwxr-x    7 0        1003         4096 Nov 09 21:04 pub
        <--- data are rececived

226 Directory send OK. 
```

PS FTP 是一个非常古老的协议（从大约 1970 年开始定义），在没有路由器、网关和其他传输级别的好东西时定义，通常有几台机器直接连接，所以主动模式工作得很好，被动模式是如何该协议在今天仍然存在。

所以，是的，你已经得到了正确的 PORT 命令，但是没有统一的方法来获取你的外部 IP（本地机器上的几个不同网络中可能有几个你的 IP，可能有几个门在路上有自己的网络服务器，您要使用哪一个？）。问题的第二部分，如何获取服务器看到的 IP，无法回答（这就是被动模式的用途）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T20:15:38.300

如果您在 NAT 后面，则 NAT 有责任打破端到端原则^W^W^W^WNAT PORT/226 命令/响应中的地址。那个 NAT 应该明确支持 FTP。

# android - SecurityException：无法找到 dex.jar 的字段

> ID：13479503
> 
> 赞同：17
> 
> 时间：2012-11-20T18:14:11.540
> 
> 标签：android, eclipse, error-handling, securityexception

我该如何解决这个错误？我试过了：

1.  刷新项目并重建。

2.  清理项目并重建。

3.  关闭和重新打开项目，并重建

4.  删除项目（但不删除文件 - 这是项目删除确认对话框上的复选框），并将其作为现有项目重新导入，然后清理和重建。

5.  删除项目，删除项目中的`.project`和`.classpath`文件，并使用我的文件作为现有源创建一个新项目。

这些都不起作用。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-12T09:20:06.400

将平台 sdk 版本更新到 rev 21 即可解决。我将平台 SDK 从 rev 20 更新到 rev 21，然后重新启动 eclipse，它就解决了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T10:41:47.403

这是否发生在您更新 Android-SDK 或类似的东西之后？您是否尝试过卸载并重新安装？

我刚刚遇到了同样的问题，我找到的唯一解决方案是： - 卸载 Android SDK（也作为 Eclipse 中的插件并手动删除您可以在 Eclipse 目录中找到的任何相关文件） - 获取最新的 Android-SDK - 再次安装

我希望它对你的情况也有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T07:32:01.880

此错误可能源于 android sdk 中的错误批处理文件。

以下固定对我有用

1.  打开`find_java.bat`找到的文件`android-sdk\tools\lib`
2.  找到线`for /f %%a in ('%~dps0\find_java.exe -s -w') do set javaw_exe=%%a`
3.  删除*“-s”*；`for /f %%a in ('%~dps0\find_java.exe -w') do set javaw_exe=%%a`
4.  保存文件，然后重新启动 eclipse。

# c++ - 将 NULL 作为参数传递给函数

> ID：13479504
> 
> 赞同：5
> 
> 时间：2012-11-20T18:14:14.813
> 
> 标签：c++

我创建了一本书课，作为我作业的一部分，我正在学习它，但它似乎有一个问题，我在下面的代码中无法理解，这是我的代码

```
private:
Book (string N = " ", int p = 100, string A = "",
        string P = "", string T = "", int Y = 2000)
{
    cout << "Book constructor start " << N << endl;
    Title=N;
    pages=p;
    Author=A;
    Publisher=P;
    Type=T;
    Yearpublished=Y;
}

~Book(void)
{
    cout << "Book destructor start " << Title << endl;
    system("pause");
}

public:
static Book * MakeBook(string N = "", int p = 100, string A = "",
        string P = "",string T = "",int Y = 2000)
{
    return new Book(N,p,A,P,T,Y);
}

static void DelBook(Book * X) {
    delete X;
} 
```

在上面的代码中是构造函数和析构函数，我的问题是当我`NULL`在函数中传递 a 作为参数时会发生什么`stactic void DelBook`？像下面这样

```
static void DelBook(NULL)
{
    delete NULL;
} 
```

如果可以传递 NULL 值，我该如何编译？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T18:16:19.253

只要`DelBook`只调用`delete`- 什么都不会发生，它就是无操作。（并且可以将您的`DelBook`with`NULL`作为参数值调用，无需额外操作）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:22:13.140

`NULL`是一个有效的指针：它指向内存位置零。因此，您可以将 NULL 传递给接受指针的函数`Book*`，因为它是一个`Book*`指针。

此外，NULL 是特殊的，不需要强制转换为`Book*`- 你不需要说`DelBook((Book*)NULL)`. 因此，该程序应该已经编译。

删除空指针没有任何作用，因此您不需要进行完整性检查。但是，如果您需要对`Book`类成员执行某些操作，则必须首先检查它是否为 NULL：

```
static void DelBook(Book * X)
{
    if (X){
        x->tidyUpBeforeDeletion();
        delete X;
    }
} 
```

未能检查这将导致段错误 - 这是取消引用空指针并且是非常坏的消息。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-20T18:17:17.397

传递 NULL 本身通常不是问题。基本上是0。删除NULL大概没有效果

# javascript - Javascript延迟加载div元素中的内容

> ID：13479505
> 
> 赞同：2
> 
> 时间：2012-11-20T18:14:15.443
> 
> 标签：javascript

我有一些代码会延迟我网站的一般页面加载，这些代码包含在页面的最顶部（广告是具体的，跟踪器脚本有时会很慢地完全加载。）这些广告加载缓慢会延迟其他 JS 脚本/效果/功能从工作到完成..例如滚动条/滑块等

我想知道，在页面加载之后将内容加载到这些特定 div 元素中的代码是什么？（编辑：更改为仅询问何时加载页面的其余部分，以修改下面的评论）

（我见过与此类似的代码示例......但从未完全让它正常运行）

这是原始代码

```
<div id="ad-header"><script type='text/javascript' src='http://url.com'></script> 
```

然后尝试更改为，而我一直在进行的更改未能成功。需要将广告加载到 ad-header id 位置

```
var delay = 3000;
setTimeout(
    function()
    {
        var oScript;
        oScript = document.createElement("script");
        oScript.type = "text/javascript";
        oScript.src = "http://url.com";
        document.body.appendChild(oScript);
    },
    delay
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:18:29.993

而不是`document.body.appendChild(oScript);`你应该做`document.getElementById('ad-header').appendChild(oScript);`

您的代码的其余部分看起来是正确的。

# c# - EF5 中实现的多线程计数器的主键违规

> ID：13479507
> 
> 赞同：0
> 
> 时间：2012-11-20T18:14:18.800
> 
> 标签：c#, ef-code-first

我正在尝试使用 EF5 Code First 实现一致的多读写器计数器，并且遇到了并发异常（这是我预期的），但我也遇到了主键约束违规，这是我没想到的。这只发生在计数器由代码**创建的情况***下；*如果它已经存在，则按预期进行计数。

 **这是我正在使用的代码（也带有调试代码）：

```
public class EFCounter
{
    private static int UpdateExceptionCount = 0;
    private const int StartValue = 1000001;

    public int CreateOrIncrement(Guid counterId)
    {
        using (var context = new EFCounterContext("MsSqlViewModel"))
        {
            if (context.Counters.Any(cntr => cntr.CounterId == counterId) == false)
            {
                try
                {
                    context.Counters.Add(
                        new Counter
                            {
                                CounterId = counterId,
                                Value = StartValue
                            }
                        );
                    context.SaveChanges();
                    return StartValue;
                }
                catch (Exception e)
                {
                    //fall through
                }
            }
            var objectContext = ((IObjectContextAdapter) context).ObjectContext;
            var counter = context.Counters.First(cntr => cntr.CounterId == counterId);
            do
            {
                try
                {
                    lock (this)
                    {
                        counter.Value += 1;
                        objectContext.SaveChanges(SaveOptions.DetectChangesBeforeSave);
                        return counter.Value;
                    }
                }
                catch (OptimisticConcurrencyException ex)
                {
                    objectContext.Refresh(RefreshMode.StoreWins, counter);
                }
                catch (UpdateException ex)
                {
                    var ueCount = Interlocked.Increment(ref UpdateExceptionCount);
                    objectContext.Detach(counter);
                    counter = context.Counters.First(cntr => cntr.CounterId == counterId);
                    Console.WriteLine("UpdateExceptions: {0}", ueCount);
                }

            } while (true);
        }
    }
}

public class Counter
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.None)]
    public Guid CounterId { get; set; }
    [ConcurrencyCheck]
    public int Value { get; set; }
} 
```

我只是`Parallel.For`用来调用它：

```
EFCounter counter1 = new EFCounter();
EFCounter counter2 = new EFCounter();

Guid counterId = Guid.NewGuid();
Parallel.For(
    1,
    10,
    i =>
        {
            Console.WriteLine("1: {0}", counter1.CreateOrIncrement(counterId));
            Console.WriteLine("2: {0}", counter2.CreateOrIncrement(counterId));
        }
    ); 
```

作为参考，连接字符串：

```
<add name="MsSqlViewModel" providerName="System.Data.SqlClient" connectionString="Data Source=localhost;Initial Catalog=ESRaffleViewModels;Integrated Security=SSPI" /> 
```

这是在我的机器上运行的代表的输出；我从来没有真正完成过出现 UpdateExceptions 的运行：

```
1：1000001
2：1000002
更新异常：1
1：1000003
更新异常：2
2：1000004
更新异常：3
1：1000005
更新异常：4
2：1000006
更新异常：5
更新异常：6
更新异常：7
更新异常：8
更新异常：9
更新异常：10
更新异常：11
更新异常：12
更新异常：13
更新异常：14
更新异常：15
更新异常：16
更新异常：17
更新异常：18
更新异常：19
更新异常：20
更新异常：21
更新异常：22
更新异常：23
更新异常：24
更新异常：25
更新异常：26
更新异常：27
更新异常：28
更新异常：29
更新异常：30
更新异常：31
更新异常：32
更新异常：33
更新异常：34
更新异常：35
更新异常：36
更新异常：37
更新异常：38
更新异常：39
更新异常：40
更新异常：41
更新异常：42
更新异常：43
更新异常：44
更新异常：45
更新异常：46
更新异常：47
更新异常：48
更新异常：49
更新异常：50
更新异常：51
更新异常：52
更新异常：53
更新异常：54
更新异常：55
更新异常：56
更新异常：57
更新异常：58
更新异常：59
更新异常：60
更新异常：61
更新异常：62
更新异常：63
更新异常：64
更新异常：65
更新异常：66
更新异常：67
更新异常：68
更新异常：69
更新异常：70
更新异常：71
更新异常：72
更新异常：73
更新异常：74
更新异常：75
更新异常：76
更新异常：77
更新异常：78
更新异常：79
更新异常：80
更新异常：81
更新异常：82
更新异常：83
更新异常：84
更新异常：85
更新异常：86
更新异常：87
更新异常：88
更新异常：89
更新异常：90
更新异常：91
更新异常：92
更新异常：93
更新异常：94
更新异常：95
更新异常：96
更新异常：97
更新异常：98
更新异常：99
更新异常：100

```

我在这里错过了一些基本的东西吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-20T18:35:27.593

锁定 (this) 并不是 EFCounter 的两个实例独有的，因此这基本上是无用的。你需要一个静态对象。

您需要使用数据库来处理数据库并发。**

# c# - 用于测试任何委托的性能的通用函数

> ID：13479512
> 
> 赞同：2
> 
> 时间：2012-11-20T18:14:59.173
> 
> 标签：c#, generics, reflection, lambda

在测试不同方法实现的相对性能时，我发现自己重写了类似的函数。

```
private static long Measure(
    int iterations,
    Func<string, string> func,
    string someParameter)
{
    var stopwatch = new Stopwatch();
    stopwatch.Start();
    for (var i = 0; i < iterations; i++)
    {
        func(someParameter);
    }

    stopwatch.Stop();
    return stopwatch.ElapsedTicks;
} 
```

与其为我测试的每个方法签名重写此函数，是否可以编写一个通用实现来测试任何 delagate 的性能？类似的东西

```
 private static long Measure(
    int iterations,
    Delegate func,
    params object[] parameters)
{
    ...
} 
```

或者

```
 private static long Measure<TDelegate>(
    int iterations,
    TDelegate func,
    params object[] parameters)
{
    if (!typeof(TDelegate).IsSubclassOf(typeof(Delegate)))
    {
        throw new ArgumentException("Not a delegate", "func");
    }

    ...
} 
```

[`Compile`](http://msdn.microsoft.com/en-us/library/bb345362.aspx)如果我能做到这一点，[`Expression<TDelegate>`](http://msdn.microsoft.com/en-us/library/bb335710.aspx)在执行迭代之前是否有意义？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T18:21:46.653

为什么不使用 Action，您可以在 lambda 中设置参数。

```
private static long Measure(int iterations, Action action)
{
    var stopwatch = new Stopwatch();
    stopwatch.Start();
    for (var i = 0; i < iterations; i++)
    {
        action();
    }

    stopwatch.Stop();
    return stopwatch.ElapsedTicks;
} 
```

然后你称之为

```
Measure(100, () => MyMethod(arg1,arg2,...)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T18:19:02.243

您可以只使用匿名函数来传递参数：

```
var p1 = ..
var p2 = ..
var p3 = ..
var p4 = ..
var p5 = ..
Measure(1000, (x) => MyTestFunc(p1, p2, p3, p4, p5), str); 
```

# python - 如何让 Python Argparse 只列出一次选择？

> ID：13479513
> 
> 赞同：17
> 
> 时间：2012-11-20T18:15:00.123
> 
> 标签：python, argparse

我的代码如下所示：

```
list_of_choices = ["foo", "bar", "baz"]
parser = argparse.ArgumentParser(description='some description')
parser.add_argument("-n","--name","-o","--othername",dest=name,
    choices=list_of_choices 
```

我得到的输出看起来像：

```
-n {foo,bar,baz}, --name {foo,bar,baz}, -o {foo,bar,baz}, 
--othername {foo,bar,baz} 
```

我想要的是：

```
-n, --name, -o, --othername {foo,bar,baz} 
```

就上下文而言，我们需要为同一个选项提供两个名称是有历史原因的，而实际的选项列表有 22 个元素长，所以它看起来比上面的要糟糕得多。

这个问题与 Python argparse 略有不同[：很多选择会导致难看的帮助输出](https://stackoverflow.com/questions/9366369/python-argparse-lots-of-choices-results-in-ugly-help-output)，因为我没有使用两个单独的选项，并且可以将它们全部放在上面。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-20T18:24:34.963

我认为您可能想要多个`add_arguments()`，并且只设置`choices`在您想要选择的那个上。

```
list_of_choices = ["foo", "bar", "baz"]
parser = argparse.ArgumentParser(description='some description')
parser.add_argument("-n")
parser.add_argument("--name")
parser.add_argument("-o")
parser.add_argument("--othername", dest='name',
    choices=list_of_choices) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T19:15:37.733

谢谢，@thomas-schultz。我不知道 add_argument 的顺序方面，您的评论使我走上了正确的轨道，并结合了来自其他线程的评论。

基本上，我现在所做的是将所有四个放在一个互斥组中，抑制前三个的输出，然后将它们包含在组的描述中。

输出如下所示：

```
group1
   use one of -n, --name, -o, --othername
-n {foo,bar,baz} 
```

这比原来的干净得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T20:20:02.307

这是我经过更多调整后确定的代码：

```
parser = argparse.ArgumentParser(description='some description', 
    epilog="At least one of -n, -o, --name, or --othername is required"
           " and they all do the same thing.") 
parser.add_argument('-d', '--dummy', dest='dummy',
    default=None, help='some other flag')
stuff = parser.add_mutually_exclusive_group(required=True)
stuff.add_argument('-n', dest='name', 
    action='store', choices=all_grids, help=argparse.SUPPRESS)
stuff.add_argument('-o', dest='name', 
    action='store', choices=all_grids, help=argparse.SUPPRESS)
stuff.add_argument('--name', dest='name', 
    action='store', choices=all_grids, help=argparse.SUPPRESS)
stuff.add_argument('--othername', dest='name', 
    action='store', choices=all_grids, help='')
args = parser.parse_args() 
```

输出`-h`是用法，然后是选项列表，然后是：

```
--othername {foo,bar,baz}

At least one of -n, -o, --name, or --othername is required and they all do the same thing. 
```

# javascript - 更新热图数据，简单的google HeatMap

> ID：13479514
> 
> 赞同：8
> 
> 时间：2012-11-20T18:15:01.927
> 
> 标签：javascript, html, google-maps, heatmap

我已经构建了这个 android 应用程序来为我的班级项目收集经度、纬度和电话信号。我的目标是将此信息移植到一个简单的热图网页。我的问题是在此示例中更新热图数据变量的最佳方法是什么：

[https://google-developers.appspot.com/maps/documentation/javascript/examples/layer-heatmap](https://google-developers.appspot.com/maps/documentation/javascript/examples/layer-heatmap)

特别是这个变量：

```
 var taxiData = [
          new google.maps.LatLng(37.782551, -122.445368),
          new google.maps.LatLng(37.782745, -122.444586), ...
          ]; 
```

我对所有建议持开放态度，我几乎是网络开发的新手。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-20T18:29:33.573

谷歌地图使这非常简单。您稍后可能会注意到，在此示例中，taxiData 被加载到此处的特定 google 数组中 -

```
 pointArray = new google.maps.MVCArray(taxiData); 
```

然后将其作为热图放入地图中：

```
heatmap = new google.maps.visualization.HeatmapLayer({
    data: pointArray
});
heatmap.setMap(map); 
```

MVCArray 可以更新，地图会自动更新。因此，如果您需要在热图中添加新的 LatLng，只需输入：

```
pointArray.push(new LatLng(<coordinates>)); 
```

并且地图会更新。

# javascript - Kendo UI Grid：如何更改滚动条的样式？

> ID：13479519
> 
> 赞同：1
> 
> 时间：2012-11-20T18:15:34.903
> 
> 标签：javascript, jquery, kendo-ui

我有一个带有简单滚动条的剑道 UI 网格，我该如何改变他的风格？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T19:36:39.377

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-17T13:34:38.677

您可以在网格内容上使用 jQuery 自定义内容滚动条 ( [http://manos.malihu.gr/jquery-custom-content-scroller/ ) 并禁用 css 中的垂直滚动条。](http://manos.malihu.gr/jquery-custom-content-scroller/)

例子：

```
$(".k-grid-content").css("overflow-y", "hidden").mCustomScrollbar(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-26T09:38:13.857

就像'Lopo's answer一样，我建议您使用相同的解决方案，但使用另一个插件。Gromo 的 Jquery.scrollbar 是更好的一个。我使用了两者（Jquery.scrollbar 和 mCustomScrollbar），差异很多。

[Gromo 的 Jquery 滚动条](https://github.com/gromo/jquery.scrollbar)

[**滚动条插件的区别**](https://docs.google.com/spreadsheets/d/1sjb7nGrTtflPNtPRkL6fryUEaT4Ls0CrGrpMiAl3YQw/edit#gid=0)

# ruby - 用于比较两个值的 Ruby 习语

> ID：13479520
> 
> 赞同：0
> 
> 时间：2012-11-20T18:15:39.683
> 
> 标签：ruby

是否有类似的红宝石成语：

```
a==b || a==c 
```

我认为以下应该有效，但它没有

```
a == b||c 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T18:18:49.543

有时我会用`Array#include?`一长串值来检查是否相等。

```
[1,2,3].include? 2 # true
[1,2,3].include? 4 # false 
```

但是对于 2 个值，通常`a == 1 || a == 2`更容易和更简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:18:04.183

也被广泛使用：

```
[b, c].include?(a) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T18:16:55.883

`a==b || a==c`是正确的方法。

Ruby 将不支持`a == b||c`.

# actionscript-3 - 未定义属性 AS3 的访问，我不明白

> ID：13479526
> 
> 赞同：0
> 
> 时间：2012-11-20T18:16:11.263
> 
> 标签：actionscript-3, flash

好的，所以我正在观看本教程：[http](http://as3gametuts.com/2012/01/08/platformer-3/) ://as3gametuts.com/2012/01/08/platformer-3/以及何时

由于某种原因，此代码不起作用：

```
xSpeed -= scrollY;
ySpeed -= scrollX;

back.x = scrollX;
back.y = scrollY; 
```

并呼吁

1120：访问未定义的属性scrollX 1120：访问未定义的属性scrollY

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:20:51.070

您是否已将变量 scrollX 和 scrollY 添加到您的代码中？在源代码中，它们在第 16 行附近的 xSpeed 上方被声明。

# c# - 如何在 RichTextBox 的旁边插入段落索引？

> ID：13479527
> 
> 赞同：0
> 
> 时间：2012-11-20T18:16:11.470
> 
> 标签：c#, wpf, richtextbox

标题说明了一切。我希望用户知道段落的索引，他正在编辑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T11:04:41.920

你应该处理`onLayoutUpdated()`事件。请参阅此链接：[创建编号 RichtextBox 的最佳方法是什么？](https://stackoverflow.com/questions/13334306/what-is-the-best-way-to-create-a-numbered-richtextbox). 当然，链接并不能解释一切。例如，您应该处理 onMouseScroll 事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T20:47:44.723

将该信息放在当前段落运行的工具提示中。例如，我的 Richtextbox 设置如下：

```
<RichTextBox Name="rEdit"
             TextChanged="rEdit_TextChanged"
             IsDocumentEnabled="True"> 
```

然后在 TextChanged 上，我设置了一个工具提示，它为我提供了段落中的总字数，当我将鼠标悬停在段落上时会显示：

```
 private void rEdit_TextChanged(object sender, TextChangedEventArgs e)
   {

      if (rEdit.Selection != null)
      {
         var startpos = rEdit.Selection.Start;

         if (startpos != null)
         {
            var run = startpos.Parent as Run;

            if (run != null)
            {
               int count = 0;

               if (string.IsNullOrWhiteSpace(run.Text) == false)
                  count = run.Text.Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries).Count();

               run.ToolTip = new Run("Words: " + count);
            }
         }
      }

   } 
```

# java - 使用 docx4j-java 生成 docx 文件

> ID：13479528
> 
> 赞同：1
> 
> 时间：2012-11-20T18:16:14.233
> 
> 标签：java, ms-word, docx, docx4j

我正在使用 docx4j 生成一个包含动态数据的 docx 文件。从数据库中检索示例 docx 文件。现在我需要修改文档中的动态数据。

我正在使用 xstream 生成带有动态数据的 xml。

谁能告诉我如何将此 xml 映射到 doc 文件中使用的内容控件？

我还发现了一个映射到现有内容控件的 xpath。这个 xpath 是如何生成的以及如何修改 xpath 以便我可以添加新的内容控件并映射动态数据？

如果有人能告诉我如何使用 docx4j 生成具有动态数据的文档，那将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T09:16:51.297

**披露：我管理 docx4j 项目，并编写了 OpenDoPE 约定**

要“绑定”内容控件，通常使用 Word 加载项：

*   [Word 内容控制工具包](http://dbe.codeplex.com/)
*   Word 2007/2010 （Word 2013 的一部分）的[XML 映射任务窗格](http://xmlmapping.codeplex.com/)

docx4j 还支持重复和条件，使用[OpenDoPE 约定](http://www.opendope.org/)。如果要设置这些类型的内容控件，则需要使用支持它们的创作插件，而不是上述任何一种。进一步查看 OpenDoPE 网站和[docx4j 数据绑定论坛](http://www.docx4java.org/forums/data-binding-java-f16/)。

如果您使用的是 docx4j，我建议您使用加载项[http://www.opendope.org/downloads/authoring-friendly/setup.exe](http://www.opendope.org/downloads/authoring-friendly/setup.exe)

至于您关于 docx4j 如何处理这些文件的问题，请参阅 docx4j 入门指南以及[名称前缀为“ContentControls”的各种示例](https://github.com/plutext/docx4j/tree/master/src/main/java/org/docx4j/samples)

# c# - 什么时候应该使用 skydrive，什么时候应该使用 azure 来进行简单的 DataStorage？

> ID：13479533
> 
> 赞同：2
> 
> 时间：2012-11-20T18:16:24.893
> 
> 标签：c#, azure-storage, winrt-xaml, onedrive

我正在做 windows 商店应用程序，应用程序的主要目标是，它具有存储、更新和检索的能力，所以我想将这些信息存储在云中，这对我来说 skydrive 或 windows azure 是更好的选择？我什么时候应该选择天蓝色，什么时候选择 SkyDrive？我是 c# 和 windows 商店应用程序的新手，如果有人提供参考，那将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:28:35.993

> 对我来说，skydrive 或 windows azure 哪个更好？

没有任何。这是不同的，不是更好。

SkyDrive 是一个用户文档空间。它不适用于设置文件（根据定义和协议）。它适用于用户对操作感兴趣的东西 - 文档，时间表等。

Azure 和您编写的数据库是您的应用程序存储。

这个问题很少出现。基本上你可以问“用户是否想在另一台计算机上打开这些文件”。如果不是 - 没有理由将它们放入用户空间。

查看

[http://msdn.microsoft.com/en-us/library/live/hh826545.aspx](http://msdn.microsoft.com/en-us/library/live/hh826545.aspx)

最后一段（与 SkyDrive 交互的应用程序指南）。

# json - 无法安装 json-.0.4.4 - 内存分配失败

> ID：13479538
> 
> 赞同：1
> 
> 时间：2012-11-20T18:16:40.550
> 
> 标签：json, haskell, ghc, cabal

我尝试在 Mac OS 10.5.8 上安装 json-0.4.4 包，并收到此错误：

```
$ sudo cabal install "json-0.4.4"
Building json-0.4.4...
[1 of 7] Compiling Text.JSON.Types  ( Text/JSON/Types.hs,
dist/build/Text/JSON/Types.o )
[2 of 7] Compiling Text.JSON.Pretty ( Text/JSON/Pretty.hs,
dist/build/Text/JSON/Pretty.o )
[3 of 7] Compiling Text.JSON.ReadP  ( Text/JSON/ReadP.hs,
dist/build/Text/JSON/ReadP.o )

Text/JSON/ReadP.hs:104:21:
    Warning: A do-notation statement discarded a result of type b.
             Suppress this warning by saying "_ <- n",
             or by using the flag -fno-warn-unused-do-bind
[4 of 7] Compiling Text.JSON.Parsec ( Text/JSON/Parsec.hs,
dist/build/Text/JSON/Parsec.o )
ghc: memory allocation failed (requested 2097152 bytes)
cabal: Error: some packages failed to install:
json-0.4.4 failed during the building phase. The exception was:
ExitFailure 1 
```

这是在具有 16GB RAM 的机器上。

我认为 [http://www.haskell.org/cabal/FAQ.html#cabal-goes-into-an-infinite-loop--runs-out-of-memory](http://www.haskell.org/cabal/FAQ.html#cabal-goes-into-an-infinite-loop--runs-out-of-memory)不 适用，因为我使用的版本高于那里提到：

```
$ ghc --version
The Glorious Glasgow Haskell Compilation System, version 6.12.3
$ cabal --version
cabal-install version 0.8.2
using version 1.8.0.6 of the Cabal library 
```

为什么我没有安装最新版本的 JSON 包？

```
$ sudo cabal install json
Resolving dependencies...
cabal: dependencies conflict: base-3.0.3.2 requires syb ==0.1.0.2 however
syb-0.1.0.2 was excluded because json-0.7 requires syb >=0.3.3 
```

更新基础 IIUC 将意味着更新我的整个 Haskell 平台安装，并且我已经拥有最新版本的 Mac OS 10.5 二进制文件可用。我可以从源代码构建，或者使用端口或 brew，但我宁愿只构建 json 包。

我知道 Mac OS 10.5.8 是旧的，但不幸的是升级这台特定的机器不是一个选项。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T19:17:36.443

它可能不是一个无限循环——由于简单的内存不足，我的安装（特别是在 RAM 有限的 VPS 上的 HSX）失败了。我会尝试使用压缩收集器（它解决了我的问题）：

```
sudo cabal install json-0.4.4 --ghc-options="+RTS -c -RTS" 
```

如果即使这样也失败了，您可以尝试使用 -M 设置堆大小（同样在 RTS 选项中），但我可以提供的帮助较少。

# core-data - NSPredicate：将 CONTAINS 与 IN 结合

> ID：13479542
> 
> 赞同：11
> 
> 时间：2012-11-20T18:16:46.103
> 
> 标签：core-data, nspredicate

我在 CoreData 中有一组用户，在我的应用程序中有一个搜索字段。用户具有属性 firstname 和 name。

目前我有一个谓词，如“user.name CONTAINS[c] %@ OR user.firstname CONTAINS[c] %@”

这一直有效，直到用户键入像“john smith”这样的全名。即使他键入“john sm”，也应该找到 John Smith-Object。

将搜索词数组 (IN) 与 CONTAINS 组合的谓词是什么？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-11-20T20:21:54.747

我认为您不能在谓词中将“IN”与“CONTAINS”结合起来。但是您可以将搜索字符串拆分为单词，并创建一个“复合谓词”：

```
NSString *searchString = @"John  Sm ";
NSArray *words = [searchString componentsSeparatedByString:@" "];
NSMutableArray *predicateList = [NSMutableArray array];
for (NSString *word in words) {
    if ([word length] > 0) {
        NSPredicate *pred = [NSPredicate predicateWithFormat:@"user.name CONTAINS[c] %@ OR user.firstname CONTAINS[c] %@", word, word];
        [predicateList addObject:pred];
    }
}
NSPredicate *predicate = [NSCompoundPredicate andPredicateWithSubpredicates:predicateList];
NSLog(@"%@", predicate); 
```

此示例生成谓词

```
(user.name CONTAINS[c] "John" OR user.firstname CONTAINS[c] "John") AND
(user.name CONTAINS[c] "Sm" OR user.firstname CONTAINS[c] "Sm") 
```

这将匹配“约翰史密斯”，但不匹配“约翰米勒”。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-05-25T17:55:29.790

2.5 年后，我可以用 swift 中更复杂的示例来回答我的问题：

```
var predicateList = [NSPredicate]()

let words = filterText.componentsSeparatedByString(" ")

for word in words{

     if count(word)==0{
           continue
     }

     let firstNamePredicate = NSPredicate(format: "firstName contains[c] %@", word)
     let lastNamePredicate = NSPredicate(format: "lastName contains[c] %@", word)
     let departmentPredicate = NSPredicate(format: "department contains[c] %@", word)
     let jobTitlePredicate = NSPredicate(format: "jobTitle contains[c] %@", word)

     let orCompoundPredicate = NSCompoundPredicate(type: NSCompoundPredicateType.OrPredicateType, subpredicates: [firstNamePredicate, lastNamePredicate,departmentPredicate,jobTitlePredicate])

     predicateList.append(orCompoundPredicate)
}

request.predicate = NSCompoundPredicate(type: NSCompoundPredicateType.AndPredicateType, subpredicates: predicateList) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-02-24T13:20:10.343

**斯威夫特 4 更新：**

```
let firstName = NSPredicate(format: "firstName CONTAINS[c] %@", searchText)
let lastName = NSPredicate(format: "lastName CONTAINS[c] %@", searchText)

let orCompoundPredicate = NSCompoundPredicate(orPredicateWithSubpredicates: 
[firstNamePredicate,lastNamePredicate] 
```

在获取数据时使用**orCompoundPredicate 。**

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-28T19:32:33.597

我遇到了同样的问题并像这样解决了它：

在我的 NSManagedObject 类（用户）中，我添加了以下方法，将两个值合并为一个字符串：

```
- (NSString *)name
{
    return [NSString stringWithFormat:@"%@ %@", self.firstname, self.lastname];
} 
```

然后你只需要以下几行来匹配你的列表，在我的例子中是一个带有用户对象的 NSArray：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"name contains[c] %@", searchString];
NSArray *filteredUsers = [users filteredArrayUsingPredicate:predicate]; 
```

# php - PHP数据库文件上传错误

> ID：13479544
> 
> 赞同：-2
> 
> 时间：2012-11-20T18:16:46.567
> 
> 标签：php, mysql, sql, database, file-upload

我正在使用以下代码上传图像文件，当将过程上传到路径时效果很好，但是当文件路径插入到数据库表字段时出现错误

上传者.php

```
<?php
$db = mysql_connect('localhost', 'root', '') or die('Could not connect:' . mysql_error());
mysql_select_db('fileupload4',$db);
$allowed_filetypes = array('.jpg','.gif','.bmp','.png');
$max_filesize = 10000000;
$upload_path = 'images/'; 
$filename = $_FILES['userfile']['name'];
$extension = substr($filename, strpos($filename,'.'), strlen($filename)-1);
if(!in_array($extension , $allowed_filetypes)) {
    die('The file you attempted to upload is not allowed.');
}
if(filesize($_FILES['userfile']['tmp_name']) > $max_filesize) {
    die('The file you attempted to upload is too large.');
}
if(!is_writable($upload_path)) {
   die('You cannot upload to the specified directory, please CHMOD it to 777.');
}
if(move_uploaded_file($_FILES['userfile']['tmp_name'], $upload_path.$filename)) {
    echo 'Your file upload was successful, view the file <a href="'.$upload_path.$filename.'" title="Your File">Here</a>';
} else {
    echo 'There was an error during the file upload.  Please try again.'; // It failed
}
$sql = "UPDATE students SET image = '".$upload_path."' WHERE id = 'student_id'";
mysql_query($sql) OR die(mysql_error());
?> 
```

这是我上传图片时遇到的错误

```
Unknown column 'id' in 'where clause' 
```

谢谢你的帮助...

我的表结构

```
CREATE TABLE IF NOT EXISTS `students` (
  `student_id` int(11) NOT NULL AUTO_INCREMENT,
  `image` varchar(64) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL DEFAULT '',
  PRIMARY KEY (`student_id`),
  KEY `student_id` (`student_id`),
  KEY `image` (`image`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:19:21.150

检查您的 MYSQL 表结构，显然该列`id`不存在。

也许发布你的 SQL 表？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:32:42.100

正如您在此处发布的查询，您似乎没有使用`id`列（正如我之前在评论中已经告诉您的那样），正如@saratis 告诉您的那样，所以您的查询应该是

```
UPDATE students SET image = '".$upload_path."' WHERE student_id= 'pass your id here'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:32:30.813

它看起来像线

```
$sql = "UPDATE students SET image = '".$upload_path."' WHERE id = 'student_id'"; 
```

需要改为

```
$sql = "UPDATE students SET image = '".$upload_path."' WHERE student_id = 'student_id'"; 
```

因为您没有名为 id 的列，但您有一个名为 student_id 的列

# c++ - 为什么要有 const 和非 const 访问器？

> ID：13479548
> 
> 赞同：5
> 
> 时间：2012-11-20T18:17:00.410
> 
> 标签：c++, constants, getter

为什么 STL 容器定义访问器的 const 和非 const 版本？

定义`const T& at(unsigned int i) const`并且`T& at(unsigned int)`不仅是非常量版本有什么好处？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-20T18:18:05.573

因为您将无法调用`at`矢量`const`对象。

如果您只有非`const`版本，则以下内容：

```
const std::vector<int> x(10);
x.at(0); 
```

不会编译。拥有`const`版本使这成为可能，同时阻止您实际更改`at`返回的内容 - 这是根据合同，因为向量是`const`.

`const`可以在非对象上调用非版本`const`，并允许您修改返回的元素，这也是有效的，因为向量不是 const。

```
const std::vector<int> x(10);
      std::vector<int> y(10);

int z = x.at(0);          //calls const version - is valid
x.at(0) = 10;             //calls const version, returns const reference, invalid

z = y.at(0);              //calls non-const version - is valid
y.at(0) = 10;             //calls non-const version, returns non-const reference
                          //is valid 
```

# asp.net - SHA1密码加密错误

> ID：13479549
> 
> 赞同：1
> 
> 时间：2012-11-20T18:17:03.610
> 
> 标签：asp.net, sql-server-2008, sha1

我正在尝试对存储在数据库中的凭据执行登录检查，其中电子邮件是纯文本，密码保存为 SHA1。目前，用户是手动创建的。为了检查登录详细信息，我决定使用存储过程。这是问题所在：

以下查询在 SHA1 中返回密码：

```
SELECT HASHBYTES('SHA1', 'password') 
 // returns 0x5BAA61E4C9B93F3F0682250B6CF8331B7EE68FD8 
```

以下查询确认用户存在：

```
SELECT COUNT(*) from users where email='test@gmail.com'
 and password='0x5BAA61E4C9B93F3F0682250B6CF8331B7EE68FD8' // returns 1 
```

现在出现了存储过程（从整个过程中提取的 select 语句，其中 'password' 是一个占位符），它似乎没有返回 1，因为它应该：

```
SELECT COUNT(*) from users where email='test@gmail.com'
 and password=(SELECT HASHBYTES('SHA1', 'password')) // returns 0 
```

有谁知道为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:22:32.530

SELECT HASHBYTES() 返回类型 varbinary 并且您的密码列似乎是 varchar。

为 OP 工作的解决方案：

```
SELECT COUNT(*) from users where email='test@gmail.com' and password=(master.dbo.fn_varbintohexsubstring(0, HashBytes('SHA1', 'password'), 1, 0)) 
```

# objective-c - NSString 以可能的最佳精度浮动

> ID：13479553
> 
> 赞同：1
> 
> 时间：2012-11-20T18:17:08.050
> 
> 标签：objective-c, xcode, floating-point

我有一个 NSString，@“48.23456789”，floatValue 方法给了我“48.234568”

有没有办法让它更精确？

感谢您的时间 ！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T18:20:31.837

尝试使用`doubleValue`而不是`floatValue`获得两倍的精度。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T18:20:38.743

使用`doubleValue`. 更好的是，使用`NSScanner`：

```
NSScanner *scn = [NSScanner scannerWithString:@"3.14159265358979323846"];
double applePie;
[scn scanDouble:&applePie]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T11:52:49.387

事实上，我的问题来自我打印浮点数（或双精度）的方式。

使用 NSLog 打印精确的浮点数/双精度数。用这个 ：

```
NSLog(@"float : %.8f", myFloat); 
```

.8 确定昏迷后的位数。

# .net - SignalR - connection.hubName 未定义

> ID：13479568
> 
> 赞同：6
> 
> 时间：2012-11-20T18:17:50.733
> 
> 标签：.net, asp.net-mvc-3, ssl, https, signalr

我有以下 SignalR 集线器类（仅显示顶部）：

```
[HubName("DataServiceHub")]
public class DataServiceHub : Hub, IDataServiceHub, IDisconnect, IConnected
{
.
. 
```

然后，我在主函数中使用以下代码在控制台应用程序中自行托管集线器：

```
string hubsUrl = appSettingsReader.GetValue("hubsUrl", typeof(string)).ToString();
var hubsServer = new Server(hubsUrl);
hubsServer.Configuration.DisconnectTimeout = TimeSpan.Zero;
hubsServer.MapHubs();
hubsServer.Start(); 
```

hubsUrl 的值为“http://localhost:4322/”

运行控制台应用程序后，如果我在 Chrome 中浏览“http://localhost:4322/signalr/hubs”，我可以在底部看到 SignalR javascript 和我的集线器：

```
signalR.dataServiceHub = {
    _: {
        hubName: 'dataServiceHub', 
```

我正在尝试从在 HTTPS/SSL 设置上运行的 MVC3 应用程序连接到此集线器（即站点 url 前缀是“https://localhost/”

在我的 Razor 页面中，我肯定包含 SignalR js：

```
<script src="/Website/Scripts/kendo/2012.2.710/jquery.min.js" type="text/javascript"></script>
<script src="/Website/Scripts/jquery.signalR-0.5.3.min.js" type="text/javascript"></script>
<script src="http://localhost:4322/signalr/hubs" type="text/javascript"></script> 
```

请注意，我们使用的是剑道，所以 jquery js 包含是通过它。

然后在 $(document).ready(function () { 我有以下内容：

```
jQuery.support.cors = true;
var connection = $.hubConnection('http://localhost:4322');
var hub = connection.dataServiceHub; 
```

但是“集线器”始终是“未定义的”。

我在这里想念什么？

如果这是跨域问题 - 我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T10:04:03.900

集线器有 2 种编程模型，您正在混合它们：

1.  [http://www.asp.net/signalr/overview/hubs-api/hubs-api-guide-javascript-client](http://www.asp.net/signalr/overview/hubs-api/hubs-api-guide-javascript-client)
2.  [http://www.asp.net/signalr/overview/guide-to-the-api/hubs-api-guide-javascript-client](http://www.asp.net/signalr/overview/guide-to-the-api/hubs-api-guide-javascript-client)

如果您滚动到这些页面的底部，则会有一个示例向您展示在每个模型中使用跨域所需的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T20:41:34.337

确保您引用的是 jquery 1.6.4

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-25T09:47:43.673

检查您的`global.asax`文件，如果该行`routes.Clear();`存在，请删除该行，因为它会清除信号路径。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2020-02-14T12:26:32.020

如果您使用 https，则既不要通过参数也不要通过 'url'-property 指定 url，以防您的集线器在同一个 url 上工作。否则，您的集线器将是未定义的。

UPD

我搞砸了伙计们。我很急于发布我刚刚检测到的特定行为，所以我没有检查任何可能的版本。

但是，应用程序中存在一个错误，它向集线器提供了错误的 url，而另一个端口超出了所需的端口。因此关闭集线器代理的属性设置 url 使我的客户端工作正常。

注意您的应用程序提供的链接...

# javascript - 以干净的方式扩展主干视图和继承选项

> ID：13479571
> 
> 赞同：6
> 
> 时间：2012-11-20T18:17:52.000
> 
> 标签：javascript, backbone.js

这是我关于 SO 的第一个问题，所以我希望我没有搞砸。我已经检查了有关此问题的其他主题，但它们并未涵盖我遇到的情况。

我正在 Backbone 之上构建一个库来创建移动应用程序。我将所有组件定义为主干视图的主要原因是因为我想对滚动进行内存优化（隐藏内容/从 DOM 中删除内容）。

让我从最理想情况的防守开始

定义一个基类供其他组件使用，其中包含一些我在每个组件上需要的默认属性和一些方便的方法。

```
UI.Component = Backbone.View.extend({
    viewOptions: ['children'],

    children: [],

    add: function(child) {
        this.children.push(child);
    }
}); 
```

定义具有一些默认属性的组件

```
UI.Header = UI.Component.extend({
    viewOptions: ['titleBarChildren', 'secondaryBarChildren', 'title', 'backButtonTitle'],

    titleBarChildren: [],

    secondaryBarChildren: [],

    title: '',

    backButtonTitle: 'Back'
}); 
```

制作一个默认标题以在我的应用程序中使用

```
MyApp.Headers.Default = UI.Header.extend({
    backButtonTitle: 'Terug',

    titleBarChildren: [
        new UI.SegmentedController({
            children: [
                new UI.Button('Lame example')
            ]
        })
    ]
}); 
```

使用我的导航栏

```
var homePageNavbar = new MyApp.Header.Default({
    title: 'Homepage'
}); 
```

现在让我们运行

```
console.log(homePageNavbar); 
```

想象一下我们得到这个输出

```
// My properties, all nicely inherited
viewOptions: Array[5] //['children', 'titleBarChildren', 'secondaryBarChildren', 'title', 'backButtonTitle']
children: Array[0],
titleBarChildren: Array[1],
secondaryBarChildren: Array[0],
title: "Homepage",
backButtonTitle: "Terug"

// Some stuff that backbone assigns
$el: jQuery.fn.jQuery.init[1]
cid: "view12"
el: HTMLDivElement
options: Object
__proto__: ctor 
```

这就是我最终想要得到的结果，但这需要一些超出我经验的魔法。

附带说明一下，我尝试对所有自定义内容使用“选项”属性，但问题是当我创建多个视图实例时，选项是“共享的”/相互引用。

所以现在我希望我对“viewOptions”方法有更多的运气，然后覆盖[_configure 方法](https://github.com/documentcloud/backbone/blob/7b51c224bc0c10fcc968e6ace3f8fc1b19159215/backbone.js#L1312-L1319)

最好这一切都在 UI.Component 或其子级中完成。我不希望这个库的用户在他们的标题定义（MyApp.Headers.Default = UI.Header.extend）中添加一些“样板代码”来扩展选项或其他任何东西。

现在我必须以某种方式从所有“后代”中获得所有属性。我完全不知道该怎么做。我曾尝试跟踪骨干中幕后发生的事情，但我无法理解它。

因此，非常感谢有关完成此操作的提示/技巧，也非常欢迎替代方法或不符合我的确切要求的方法。

**编辑 1**

看起来我有一些“有点”有效的东西，这就是它的样子

我重写了 _configure 方法，将选项添加到实例中，注意 this.getDefaultOptions() 作为 _.extend 中的第一个参数

```
UI.Component = Backbone.View.extend({
  _configure: function(options) {
    var viewOptions = this.viewOptions;
    options = _.extend(this.getDefaultOptions ? this.getDefaultOptions() : {}, this.options || {}, options || {});
    for (var i = 0, l = viewOptions.length; i < l; i++) {
      var attr = viewOptions[i];
      if (options[attr]) this[attr] = options[attr];
    }
    this.options = options;
  }
}); 
```

我将这个新方法添加到我的所有组件中，并且没有将“共享”属性放在我的基础对象（UI.Component）中，因为我无法让它发挥得很好。

```
UI.Header = UI.Component.extend({

  viewOptions: ['children', 'backButtonTitle', 'title'],

  getDefaultOptions: function() {
    return {
      children: []
    };
  },
}); 
```

现在，我用这样的东西来定义我的标题

```
MyApp.Headers.Default = UI.Header.extend({
  options: {
    backButtonTitle: 'Terug',
    titleBarChildren: [
      new UI.SegmentedController({
        children: [
          new UI.Button('Lame example')
        ]
      })
    ]
  }
}); 
```

我会保持它现在的样子，看看这个“解决方案”是否存在，并会报告。如果您认为自己有更好的答案，请不要犹豫发布它=）

**编辑**

这是我最新的方法，使用 jQuery 的深拷贝，似乎可以正常工作

```
var UI = {};
var App = {
  Headers: {}
};

UI.Component = Backbone.View.extend({
  blockDefaults: {
    children: []
  },

  initialize: function(options) {
    var combinedDefaultsAndOptions = $.extend(true, {}, this.blockDefaults || {}, this.defaults || {}, this.options || {}, options || {});
    _.defaults(this, combinedDefaultsAndOptions);
  }
});

UI.Header = UI.Component.extend({
  defaults: {
    backButton: null,
    backButtonTitle: null,
    secondaryBarChildren: []
  }
});

App.Headers.Default = UI.Header.extend({
  options: {
    backButtonTitle: "App back",
    secondaryBarChildren: ["App child"]
  }
});

var header1 = new UI.Header({
  backButtonTitle: "Header 1 Back",
  secondaryBarChildren: ["Header 1 child"]
});

var header2 = new UI.Header({
  backButtonTitle: "Header 2 Back",
  secondaryBarChildren: ["Header 2 child"]
});

var header3 = new App.Headers.Default({
});

var header4 = new App.Headers.Default({
  backButtonTitle: "Overrided App Back"
});

header1.secondaryBarChildren.push('a child for header 1');

console.log(header1, header2, header3, header4); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:01:30.877

我想你想为你的例子覆盖初始化函数，但你有很多事情要做，所以我不确定；如果关闭，请原谅我。而且我可能只是将我认为您正在尝试做的事情整理成一个更“骨干”风格的系统。

从您的基本组件开始，如下所示：

```
UI.Component = Backbone.View.extend({
    defaults : { 'children' : [] },
    initialize : function (options) {
        _.defaults(options, this.defaults);
        _.keys(this.defaults).forEach(function(key) {
              this[key] = this.options[key];
        }.bind(this));
        Backbone.View.prototype.initialize.call(this, options);
    },
    add: function(child) {
        this.children.push(child);
    }
}); 
```

然后你可以继续以类似的方式扩展它们：

```
UI.Header = UI.Component.extend({
    defaults : { 
        'titleBarChildren' : [], 
        'secondaryBarChildren' : [], 
        'title' : '', 
        'backButtonTitle' : 'Back' 
    },
    initialize : function (options) {
        _.defaults(options, this.defaults);
        _.keys(this.defaults).forEach(function(key) {
              this[key] = this.options[key];
        }.bind(this));
        UI.Component.prototype.initialize.call(this, options);
    }
}); 
```

这是我在代码中尝试执行的操作的细分：

**Defaults**创建一个对象，干净地保存所有默认属性

```
 defaults : { 'children' : [] }, 
```

**初始化**覆盖允许您继续在视图之间传递选项，但每个组件都使用您的`defaults`对象来填补空白。

```
 initialize : function (options) {
        // merges your defaults in with the options passed
        _.defaults(options, this.defaults);
        // loop through your required defaults for this view
        // assigning the attributes to the passed options
        _.keys(this.defaults).forEach(function(key) {
              this[key] = this.options[key];
        }.bind(this));
        // Finally pass all your options up the chain of inheritance
        UI.Component.prototype.initialize.call(this, options);
    }, 
```

# centos - CentOS 上的 Red5 应用程序设置

> ID：13479573
> 
> 赞同：3
> 
> 时间：2012-11-20T18:18:01.693
> 
> 标签：centos, red5

我在我的 Windows 计算机上编写了一个简单的 Red5 应用程序，它运行良好。

我正在尝试在我的 VPS (CentOS) 上运行它。我已阅读以下教程并更改了需要更改的内容，但没有成功。

[http://leonell24.wordpress.com/2010/10/20/how-to-create-new-red5-0-8-application-on-centos/](http://leonell24.wordpress.com/2010/10/20/how-to-create-new-red5-0-8-application-on-centos/)

我想要一种在 CentOS 上逐步设置 Red5 应用程序的简单方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T15:02:07.817

这在 CentOS VPS 上适用于我：

**安装java（如果尚未安装）**

```
yum -y install java-1.6.0-openjdk java-1.6.0-openjdk-devel
export JAVA_HOME=/usr/lib/jvm/java
export CLASSPATH=.:$JAVA_HOME/lib/classes.zip
echo 'export JAVA_HOME=/usr/lib/jvm/java' >> /etc/bashrc
echo 'export CLASSPATH=.:$JAVA_HOME/lib/classes.zip' >> /etc/bashrc 
```

**安装red5**

```
cd /tmp/
wget http://red5.org/downloads/red5/1_0_1/red5-1.0.1.tar.gz
untar red5-1.0.1.tar.gz
mv red5-server-1.0 /usr/local 
```

**开始 red5**

```
cd /usr/local/red5-server-1.0
./red5.sh 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T14:32:29.713

Red5 可以作为独立服务器或战争部署安装。

过程是创建red5版本0.8（旧版本）的war部署。（冗长，请多多包涵）。

在 linux 上下载并安装 jdk1.6、glassfish2.1 和 netbeans 6.5。

下载“Red5War_0.8.0.war”。

我分享希望以下内容可以帮助社区按照 Netbeans 6.5 中使用的步骤在 glassfish2.1 上创建可部署的 war red5 版本 0.8：

第 1 步：解压缩 Red5War_0.8.0.war

第 2 步：在 Netbeans 中创建一个名为“red5”的 Web 项目

第三步：复制膨胀的war文件夹“/WEB-INF/classes”的内容，粘贴到Netbeans项目的“Source Packages”中。

第4步：右键单击“库”，添加“JAR/Folder”，导航到膨胀的war文件夹的“/WEB-INF/lib”，选择所有依赖jar，然后单击Netbeans项目的“打开”。

第 5 步：删除 Netbeans 项目的 WEB-INF（注意：忽略警告/错误）。

第6步：删除膨胀文件夹的META-INF。

第7步：将膨胀文件夹的剩余内容（“/WEB-INF/classes”和“/WEB-INF/lib”）复制到Netbeans项目的“Web Pages”中。

第八步：在防火墙中打开以下端口 TCP/843,TCP/1935,TCP/5229,TCP/5080

第 9 步：运行项目

第 10 步：在 Netbeans 项目文件夹 (../NetBeansProjects/red5/dist/) 中创建可部署的 war 文件“red.war”

当我遇到错误时，我请求您使用新版本的 netbeans、jdk 为新版本的 glassfish 服务器（3.x）创建新版本（1.0、1.0.1、1.02）战争部署。

阿鲁姆甘 AV

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T07:49:55.527

Red5的安装与windows没有区别。Red5 以 ZIP 文件的形式提供。您解压它然后运行 ​​red5.bat 或 red5.sh，这取决于您使用的操作系统类型。

有关您的应用程序出了什么问题的更多详细信息，您基本上应该研究日志文件和产生的错误。没有任何人可以告诉你的“魔术”:) 你只需要像任何其他软件开发一样调试问题 => 研究日志文件，最终更改日志级别，包含你自己的调试消息，测试 + 运行

塞巴斯蒂安

# android - Android - 自定义 IME 操作按钮

> ID：13479580
> 
> 赞同：0
> 
> 时间：2012-11-20T18:18:36.707
> 
> 标签：android, android-edittext, ime

如何自定义在 EditTextView 的 IME 操作按钮中显示的文本。我尝试使用 setImeActionLabel 但它不起作用。

```
public class TestIMEActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        LinearLayout layout = new LinearLayout(this);
        layout.setOrientation(LinearLayout.VERTICAL);
        LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT);
        final EditText ed1 = new EditText(this);
        ed1.setSingleLine(true);
        ed1.setImeActionLabel("test", 0);
        layout.addView(ed1, params);
        setContentView(layout);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T21:04:36.643

我试图动态设置它。尝试在您的 xml 上设置它：

```
android:imeActionLabel="@string/myCustomActionLabel" 
```

它对我有用。

请注意，您的文本仅在横向模式下可见。

# uitextfield - 如果委托，NSUserDefaults 不会保存 UITextFields 中的字符串

> ID：13479583
> 
> 赞同：0
> 
> 时间：2012-11-20T18:18:51.353
> 
> 标签：uitextfield, nsuserdefaults

源代码：

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController

@property IBOutlet UILabel *label;
@property IBOutlet UITextField *textField1;
@property IBOutlet UITextField *textField2;
@property NSInteger textFieldInt1, textFieldInt2;
@property NSString *textFieldStr1, *textFieldStr2;

-(IBAction)Summarize:(id)sender;
-(IBAction)textFieldChanged:(id)sender;

-(void)loadLastActions;

@end

#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController

@synthesize label, textField1, textField2, textFieldInt1, textFieldInt2, textFieldStr1, textFieldStr2;

-(IBAction)Summarize:(id)sender {
textFieldInt1=[textField1.text integerValue];
textFieldInt2=[textField2.text integerValue];
label.text=[NSString stringWithFormat: @"%d", textFieldInt1+textFieldInt2];
[self.view endEditing:YES];
}

-(BOOL)textFieldShouldReturn:(UITextField *)textField {
//Do whatever you need to to save etc...
[textField resignFirstResponder];
return NO;
}

-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
if(![string intValue] && ![string isEqualToString:@""] && ![string isEqualToString:@"0"])
{
    return NO;
} else {
    return YES;
}
}

-(IBAction)textFieldChanged:(id)sender {
[[NSUserDefaults standardUserDefaults] setObject: textField1.text forKey: @"textField1"];
[[NSUserDefaults standardUserDefaults] setObject: textField2.text forKey: @"textField2"];

}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
// Dispose of any resources that can be recreated.
}

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
[self.view endEditing:YES];
[super touchesBegan:touches withEvent:event];
}

- (void)loadLastActions
{
if ([[NSUserDefaults standardUserDefaults] objectForKey: @"textField1"] != nil)
{
    textField1.text = [[NSUserDefaults standardUserDefaults] stringForKey: @"textField1"];
}

if ([[NSUserDefaults standardUserDefaults] objectForKey: @"textField2"] != nil)
{
    textField2.text = [[NSUserDefaults standardUserDefaults] stringForKey: @"textField2"];
}
}

- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.

[self.textField1 setReturnKeyType:UIReturnKeyDone];
[self.textField2 setReturnKeyType:UIReturnKeyDone];
[self loadLastActions];
}
@end 
```

问题是：操作 ​​textFieldChanged 不会影响“textField1” NSUserDefaults 键来保存数据。如果我使用 [[NSUserDefaults standardUserDefaults] setObject: textField1.text forKey: @"textField1"]; 在 Summarize 操作中，它工作正常。我的应用程序有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:25:58.190

我认为您需要以下内容：

```
-(IBAction)textFieldChanged:(id)sender {
  [[NSUserDefaults standardUserDefaults] setObject: textField1.text forKey: @"textField1"];
  [[NSUserDefaults standardUserDefaults] setObject: textField2.text forKey: @"textField2"];
  [[NSUserDefaults standardUserDefaults] synchronize];  // THIS LINE
} 
```

# php - 从 MySQL 结果中获取数组时出错

> ID：13479584
> 
> 赞同：-2
> 
> 时间：2012-11-20T18:18:51.620
> 
> 标签：php, mysql

> **可能重复：**
> [警告：mysql_fetch_array() 期望参数 1 是资源，布尔值在](https://stackoverflow.com/questions/5473981/warning-mysql-fetch-array-expects-parameter-1-to-be-resource-boolean-given-i)

在我的详细视图页面上，并在 URL 栏中获取正确的 ID，如下所示：

```
http://localhost/attractions/details.php?ID=1 
```

我的页面标题和侧边栏已加载，但在我想要记录详细信息的空间中，我收到以下错误消息：

```
Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given in /Applications/XAMPP/xamppfiles/htdocs/attractions/details.php on line 41 
```

这是“details.php”页面代码（删除了不必要的 html）：

```
<?php
include 'page-start.php';
$myQuery  = "SELECT Attraction.*, Type.TypeName ";
$myQuery .= "FROM Attraction ";
$myQuery .= "INNER JOIN Type ON Attraction.Type = Type.TypeID";
$myQuery .= "WHERE AttractionID=" . $_GET['ID'];
$result = mysql_query($myQuery);
if (!result) {
    die('Query error: ' . mysql_error());
} 
?>

<body>
<div class="container">
        <h2>List of Attractions</h2>

        <?php
            //display attractions row by row
            while($row = mysql_fetch_array($result))
            {
                echo '<div class="attraction">';
                echo '<h4><a href="details.php?ID=' . $row['AttractionID'] . '">' . $row['Name'] . '</a></h4>';
                echo '<div class="featureimage">';
                echo '<img src="'. $row['ImageUrl'] . '" />';
                echo '</div>';
                echo '<p>' . $row['TypeName'] . '</p>';
                echo '<h5>' . $row['Summary'] . '</h5>';
                echo '</div>';  
            }
        ?>
</div><!-- container -->
</body>
</html>
<?php
include 'page-end.php';
?> 
```

第 41 行是这一行：

```
while($row = mysql_fetch_array($result)) 
```

我只知道我会在这里忽略一些如此简单的事情，但是我很困惑，我真的无法弄清楚是什么导致了错误，请有人能对我的情况有所了解，我已经搜索过类似的问题，但是没有人可以帮助我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:24:38.270

当您使用作为关键字EG的**表名时，对于连接代码，您在 MySQL 中缺少反引号**`Type | TYPE | TyPE...`

```
$myQuery  = "SELECT `Attraction`.*, `Type`.`TypeName` ";
$myQuery .= "FROM `Attraction` ";
$myQuery .= "INNER JOIN `Type` ON `Attraction`.`Type` = `Type`.`TypeID`";
$myQuery .= "WHERE `AttractionID` =" . $_GET['ID']; 
```

正如 Jeffrey 所说，如果查询无效，它将返回 false

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T18:24:39.187

请注意，它`mysql_query()`可能会返回布尔值。在将其结果用作结果类型之前，您需要检查是否`mysql_query()`有效（如果不是则返回 false）。

在您的情况下，查询显然失败并返回 false 不能用作`resource`. 你应该和

```
if (!$result) { /* we have a database error */ } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:25:10.403

看看这部分：`if (!result) {`你错过了`$`. 这本身应该会产生一个错误，也许你没有显示通知。无论如何，您的 SQL 返回错误，但由于我提到的错误，您没有发现它。因此，修复该错误并检查您的 SQL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T18:29:55.290

如果您的 mysql_query 只是失败了，可能的解释是给变量 $result 一个 FALSE 值（这是一个布尔值），然后 mysql_fetch_array() 在那个 BOOLEAN 上窒息。验证您的查询是否有效。您没有触发查询错误条件，因为您缺少 $ on`if (!result) {`

此外，最佳实践是使用 PDO 或 MYSQLI 而不是 mysql_ 函数。（[他们（将要 - 感谢马丁）已弃用。](http://www.php.net/manual/en/mysqlinfo.api.choosing.php)）

# c++ - 在 C++ 中同时执行多个功能

> ID：13479587
> 
> 赞同：0
> 
> 时间：2012-11-20T18:19:04.397
> 
> 标签：c++, function

我目前正在使用 C++。我需要制作一个数字捕手游戏，因此必须同时做两件事

1.  移动角色
2.  数字不断从顶部下降。

此外，我需要一次抛出多个数字。我怎样才能同时做所有这些事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T18:21:58.710

你是基于一个*非常*错误的前提。这并不要求同时做任何这样的事情。你所要做的就是做每一件事然后更新。你需要一本关于非常基本的游戏架构的书。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:22:10.007

我相信你需要从你的项目开始，同时向别人学习。基本上，您不需要同时执行所有这些操作，如果您在后台同时执行这些操作，没人会注意，您只需要在将结果呈现给用户之前完成所有操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:31:20.443

我将从其他提倡研究游戏编程的答案中稍微详细说明一下，并提供一些基本的见解。

程序的主要任务是循环（直到游戏结束，或者玩家累了），并且在每次迭代时：

*   计算游戏的当前状态，
*   渲染视图，
*   读取玩家输入。

您不必按此顺序执行此操作，游戏应该运行得足够快，以使一切看起来都在同时发生。

游戏的状态实际上是游戏中所有元素的状态：

*   背景，
*   仍然对象，
*   移动物体，
*   生成其他对象的对象，
*   破坏其他物体的物体，
*   播放器，
*   等等

可能存在管理所有这些对象的规则、针对不同对象的不同规则、对象之间的交互等等。您可以在引擎中编写这些规则，并确保所有对象都得到更新。最简单的方法是遍历所有对象列表并一一更新。

渲染基本上是遍历所有对象并根据它们的状态（颜色、位置等）在屏幕上绘制它们（如果它们可见）。

轮询输入就是：验证玩家是否使用键盘、鼠标、触摸屏或您希望处理的任何其他输入设备进行了输入。

在您的项目中，您的对象列表将只是下降字符的列表，主要规则是重力（或以恒定速度向下移动到屏幕底部），输入是键盘。

如果您希望游戏以文本模式运行，主要障碍将是移动光标、获得非阻塞输入、清除屏幕。在 UNIX 上，查找提供所有必要功能的*curses库。*

鉴于游戏的简单性，您的程序肯定会运行得非常快，因此您需要在循环中包含一个小的休眠期。但是，最好具有一致的帧速率（至少 30hz），这样您就可以测量完成工作所花费的时间，并让进程在剩余时间内休眠以达到一个循环的正确时间。

最后一件事：不要为这个项目研究线程或并发编程，这无济于事。在大多数图形设置中，渲染必须由单个线程完成，并且您最终会进行大量同步，除非您使用线程之间的消息传递（这将是一个有趣的练习，但保留在版本 2 中）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T14:43:46.613

![矩阵下降数字](../Images/dff0ccd30a211ea26aa389ac86f01bd6.png)

如果您在 Windows 上，则代码：

```
/* The Matrix  falling numbers */

#include <iostream>
#include <windows.h> 

#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <conio.h>
using namespace std;

#define KB_UP 72
#define KB_DOWN 80
#define KB_LEFT 75
#define KB_RIGHT 77
#define KB_ESCAPE 27
#define KB_F8 66

/* Variables*/

char screen_buffer[2000]={' '};
int y_coord[2000]={0};
int x=0, y=0,dy=0;
int XMAX=77;
int YMAX=23;
int KB_code=0;
bool QuitGame=false;
int platformX=35, platformY=23;

/* function prototypes*/

void gotoxy(int x, int y);
void clrscr(void);
void setcolor(WORD color); 
void simple_keyboard_input();  
void draw_falling_numbers();
void draw_platform();

/*  main  */

int main(void)
{
  /* generate random seed */
  srand ( time(NULL) );

  /* generate random number*/
  for(int i=0;i<XMAX;i++) y_coord[i]=   rand() % YMAX;

  while(!QuitGame)
  {
      /* simple keyboard input */
      simple_keyboard_input();

      /* draw falling numbers */
      draw_falling_numbers();

  }

  /* restore text color */
  setcolor(7);
  clrscr( );
  cout<<" \n";

  cout<<" \nPress any key to continue\n";
  cin.ignore();
  cin.get();

   return 0;
}

/* functions  */

void draw_falling_numbers()
{

    for(x=0;x<=XMAX;x++)
    {
        /* generate random number */
        int MatixNumber=rand() % 2 ;

        /* update falling number */
        y_coord[x]=y_coord[x]+1;

        if (y_coord[x]>YMAX) y_coord[x]=0;

        /* draw dark color */
        setcolor(2);
        gotoxy(x ,y_coord[x]-1); cout<<"  "<<MatixNumber<<"   ";

        /* draw light color */
        setcolor(10);
        gotoxy(x ,y_coord[x]); cout<<"  "<<MatixNumber<<"   ";
    }
    /* wait some milliseconds */
    Sleep(50);
    //clrscr( );
}

void draw_platform()
{
  setcolor(7);
 gotoxy(platformX ,platformY);cout<<"       ";

 gotoxy(platformX ,platformY);cout<<"ÜÜÜÜÜÜ";
 setcolor(7);
 Sleep(5);
}

void simple_keyboard_input()
{
    if (kbhit())
      {
            KB_code = getch();
            //cout<<"KB_code = "<<KB_code<<"\n";

            switch (KB_code)
            {

                case KB_ESCAPE:

                    QuitGame=true;

                break;

                case KB_LEFT:
                           //Do something
                    platformX=platformX-4;if(platformX<3) platformX=3;
                break;

                case KB_RIGHT:
                           //Do something     
                    platformX=platformX+4;if(platformX>74) platformX=74;
                break;

                case KB_UP:
                           //Do something                     
                break;

                case KB_DOWN:
                           //Do something                     
                break;

            }        

      }

}

void setcolor(WORD color)
{
    SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE),color);
    return;
}

void gotoxy(int x, int y)
{
  static HANDLE hStdout = NULL;
  COORD coord;

  coord.X = x;
  coord.Y = y;

  if(!hStdout)
  {
    hStdout = GetStdHandle(STD_OUTPUT_HANDLE);
  }

  SetConsoleCursorPosition(hStdout,coord);
}

void clrscr(void)
{
  static HANDLE hStdout = NULL;      
  static CONSOLE_SCREEN_BUFFER_INFO csbi;
  const COORD startCoords = {0,0};   
  DWORD dummy;

  if(!hStdout)               
  {
    hStdout = GetStdHandle(STD_OUTPUT_HANDLE);
    GetConsoleScreenBufferInfo(hStdout,&csbi);
  }

  FillConsoleOutputCharacter(hStdout,
                             ' ',
                             csbi.dwSize.X * csbi.dwSize.Y,
                             startCoords,
                             &dummy);    
  gotoxy(0,0);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T18:22:27.930

在某些情况下，我们需要调用多个功能。这就是线程发挥作用的地方。例如，在 Windows 上，您可以使用`CreateThreadEx`函数同时调用多个函数。但是您必须处理线程的复杂性。

阅读有关线程的文章，您将了解其基本概念。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-11-20T18:24:06.553

研究将包括使用 openmp 或 pthreads 的并发编程方法。我建议使用 openmp 的唯一原因是，如果你的时间有限，它很容易学习，并且在某种程度上 pthreads 也很容易让你理解。此外，了解您使用的平台也会有所帮助，以便每个人都以更具体的方式回答问题。

# java - 将字母表示为数字

> ID：13479596
> 
> 赞同：2
> 
> 时间：2012-11-20T18:19:49.073
> 
> 标签：java

有人可以帮忙吗？我对 Java 编程完全陌生，我需要将字母表示为数字，以便我可以用数字而不是字母来执行操作（比如匹配两个数字）。例如 A = 1; B = 2; c = 3;...非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:28:37.870

```
System.out.println((int)'A'); 
```

会给你65（A的ASCII码是65）

```
System.out.println((int)'A' - 64); 
```

会将数字偏移到 1。

如果您希望使用上述方法也将较低的 'a' 打印为 1，只需使用`Character.toUppserCase('a')`;将其转换为大写即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T18:30:08.660

创建如下转换器方法：

```
public class Test {
    public static void main(String[] args) {
        Test t = new Test();

        System.out.println(t.alphabetToNumber('A'));
        System.out.println(t.numberToAlphabet(1));
    }

    public int alphabetToNumber(char a) {
        return a - 64;
    }

    public char numberToAlphabet(int i) {
        return (char) (i + 64);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T18:36:23.313

考虑到您是编程新手，您必须知道有一种叫做[ASCII Code](http://en.wikipedia.org/wiki/ASCII)的东西。此代码描述了哪个字符是如何编码的。如您所见，字符“a”由数字 97 表示。所以在 Java 中

```
System.out.println((char)(97)); 
```

将打印字符'a'。`(char)`就是所谓的演员表。这意味着数字 97 被“强制”显示为一个字符。反之亦然

```
System.out.println((int)'a'); 
```

这会强制将字符“a”显示为其 ASCII 数字值 97。

所以如果你想用 1-26 来表示从 a 到 z 的字符，你必须这样做：

```
char yourChar = 'z';
int yourCharInt = (int)yourChar - (int)'a' + 1; 
```

# maven - 无法使用 netbeans 解决 Maven 依赖项

> ID：13479599
> 
> 赞同：-1
> 
> 时间：2012-11-20T18:20:06.067
> 
> 标签：maven, netbeans

我是一个 Maven 新手，我无法下载一些我认为应该可用的依赖项。有人可以告诉我他们认为错误的地方以及如何解决吗？我收到以下错误消息：

```
 Failed to execute goal on project gallery: Could not resolve dependencies for project
 com.prospinghibernate.gallery:gallery:war:1.0.0-SNAPSHOT: Failed to collect
 dependencies for [log4j:log4j:jar:1.2.15 (compile), org.slf4j:slf4j-api:jar:1.6.0
(compile), org.slf4j:jcl-over-slf4j:jar:1.6.0 (compile), org.slf4j:slf4j-log4j12:jar:1.6.0 (compile), 
org.aspectj:aspectjrt:jar:1.6.9.M2 (compile), javax.servlet:servlet-api:jar:2.5 (provided), 
commons-fileupload:commons-fileupload:jar:1.2.1 (compile), javax.media:jai-core:jar:1.1.3 (compile), org.springframework:spring-core:jar:3.0.2.RELEASE (compile),
org.springframework:spring-test:jar:3.0.2.RELEASE (test), org.springframework:spring-context:jar:3.0.2.RELEASE (compile),
org.springframework:spring-context-support:jar:3.0.2.RELEASE (compile), org.springframework:spring-aop:jar:3.0.2.RELEASE (compile), org.springframework:spring-aspects:jar:3.0.2.RELEASE (compile), 
org.springframework:spring-tx:jar:3.0.2.RELEASE (compile), org.springframework:spring-web:jar:3.0.2.RELEASE (compile), 
org.springframework:spring-webmvc:jar:3.0.2.RELEASE (compile), org.springframework:spring-oxm:jar:3.0.2.RELEASE (compile), 
jstl:jstl:jar:1.2 (compile), com.h2database:h2:jar:1.2.131 (compile), net.sf.ehcache:ehcache:jar:1.6.2 (compile), org.hibernate:hibernate-core:jar:3.5.0-Final (compile), 
org.hibernate:hibernate-entitymanager:jar:3.5.0-Final (compile),
org.hibernate.javax.persistence:hibernate-jpa-2.0-api:jar:1.0.0.Final (compile),
org.hibernate:hibernate-validator:jar:4.0.2.GA (compile), javax.validation:validation-api:jar:1.0.0.GA (compile), cglib:cglib-nodep:jar:2.2 (compile),
javax.transaction:jta:jar:1.1 (compile), org.springframework:spring-jdbc:jar:3.0.2.RELEASE (compile), 
org.springframework:spring-orm:jar:3.0.2.RELEASE (compile), commons-pool:commons-pool:jar:1.5.4 (compile), 
 commons-dbcp:commons-dbcp:jar:1.3 (compile), org.hibernate:hibernate-search:jar:3.2.1.Final (compile), net.sf.dozer:dozer:jar:5.2.2 (compile),
 org.apache.xmlbeans:xmlbeans:jar:2.4.0 (compile), junit:junit:jar:4.8.1 (test),
 org.jmock:jmock-junit4:jar:2.5.1 (test)]: Failed to read artifact descriptor for org.aspectj:aspectjrt:jar:1.6.9.M2: Could not transfer artifact org.aspectj:aspectjrt:pom:1.6.9.M2 from/to JBoss Repo (http://repository.jboss.com
 /maven2): Access denied to: http://repository.jboss.com/maven2/org/aspectj/aspectjrt
 /1.6.9.M2/aspectjrt-1.6.9.M2.pom, ReasonPhrase:Forbidden. -> [Help 1] 
```

消息末尾的“ReasonPhrase:Forbidden”是否意味着我缺乏对某些库的授权？什么是替代品？

这是pom：

```
 <?xml version="1.0" encoding="UTF-8" standalone="no"?>
 <project xmlns="http://maven.apache.org/POM/4.0.0"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">

<modelVersion>4.0.0</modelVersion>
<groupId>com.prospinghibernate.gallery</groupId>
<artifactId>gallery</artifactId>
<packaging>war</packaging>
<version>1.0.0-SNAPSHOT</version>
<name>gallery</name>

<properties>
    <spring.version>3.0.2.RELEASE</spring.version>
    <hibernate.version>3.5.0-Final</hibernate.version>
</properties>

<repositories>
    <repository>
        <id>JBoss Repo</id>
        <url>http://repository.jboss.com/maven2</url>
        <name>JBoss Repo</name>
    </repository>
    <repository>
        <id>ibiblio mirror</id>
        <url>http://mirrors.ibiblio.org/pub/mirrors/maven2/</url>
    </repository>
    <repository>
        <id>jboss-public-repository-group</id>
        <name>JBoss Public Maven Repository Group</name>
        <url>https://repository.jboss.org/nexus/content/groups/public/</url>
        <layout>default</layout>
        <releases>
            <enabled>true</enabled>
            <updatePolicy>never</updatePolicy>
        </releases>
        <snapshots>
            <enabled>true</enabled>
            <updatePolicy>never</updatePolicy>
        </snapshots>
    </repository>
</repositories>

<dependencies>

    <!-- General dependencies -->
    <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.15</version>
        <!-- Exclusions only required for version 1.2.15 of log4j -->
        <exclusions>
            <exclusion>
                <groupId>javax.mail</groupId>
                <artifactId>mail</artifactId>
            </exclusion>
            <exclusion>
                <groupId>javax.jms</groupId>
                <artifactId>jms</artifactId>
            </exclusion>
            <exclusion>
                <groupId>com.sun.jdmk</groupId>
                <artifactId>jmxtools</artifactId>
            </exclusion>
            <exclusion>
                <groupId>com.sun.jmx</groupId>
                <artifactId>jmxri</artifactId>
            </exclusion>
        </exclusions>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>1.6.0</version>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>jcl-over-slf4j</artifactId>
        <version>1.6.0</version>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>1.6.0</version>
    </dependency>
    <dependency>
        <groupId>org.aspectj</groupId>
        <artifactId>aspectjrt</artifactId>
        <version>1.6.9.M2</version>
    </dependency>
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>servlet-api</artifactId>
        <version>2.5</version>
        <scope>provided</scope>
    </dependency>

    <!-- file upload dependencies -->
    <dependency>
        <groupId>commons-fileupload</groupId>
        <artifactId>commons-fileupload</artifactId>
        <version>1.2.1</version>
    </dependency>

    <!-- image processing dependencies -->
    <dependency>
        <groupId>javax.media</groupId>
        <artifactId>jai-core</artifactId>
        <version>1.1.3</version>
    </dependency>

    <!-- Spring dependencies -->
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-core</artifactId>
        <version>${spring.version}</version>
        <exclusions>
            <exclusion>
                <groupId>commons-logging</groupId>
                <artifactId>commons-logging</artifactId>
            </exclusion>
        </exclusions>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-test</artifactId>
        <version>${spring.version}</version>
        <scope>test</scope>
        <exclusions>
            <exclusion>
                <groupId>commons-logging</groupId>
                <artifactId>commons-logging</artifactId>
            </exclusion>
        </exclusions>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-context</artifactId>
        <version>${spring.version}</version>
    </dependency>
     <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-context-support</artifactId>
        <version>${spring.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-aop</artifactId>
        <version>${spring.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-aspects</artifactId>
        <version>${spring.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-tx</artifactId>
        <version>${spring.version}</version>
    </dependency>

    <!-- Spring MVC dependencies -->
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-web</artifactId>
        <version>${spring.version}</version>
        <exclusions>
            <exclusion>
                <groupId>commons-logging</groupId>
                <artifactId>commons-logging</artifactId>
            </exclusion>
        </exclusions>
    </dependency>

    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-webmvc</artifactId>
        <version>${spring.version}</version>
        <exclusions>
            <exclusion>
                <groupId>commons-logging</groupId>
                <artifactId>commons-logging</artifactId>
            </exclusion>
        </exclusions>
    </dependency>

    <!--Spring OXM-->
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-oxm</artifactId>
        <version>${spring.version}</version>
    </dependency>

    <!-- JSP dependencies -->
    <dependency>
        <groupId>jstl</groupId>
        <artifactId>jstl</artifactId>
        <version>1.2</version>
    </dependency>

    <!-- H2 dependencies -->
    <dependency>
        <groupId>com.h2database</groupId>
        <artifactId>h2</artifactId>
        <version>1.2.131</version>
    </dependency>

    <!-- ehcache dependencies -->
    <dependency>
        <groupId>net.sf.ehcache</groupId>
        <artifactId>ehcache</artifactId>
        <version>1.6.2</version>
    </dependency>

    <!-- Hibernate dependencies -->
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>${hibernate.version}</version>
        <exclusions>
            <exclusion>
                <groupId>cglib</groupId>
                <artifactId>cglib</artifactId>
            </exclusion>
            <exclusion>
                <groupId>net.sf.ehcache</groupId>
                <artifactId>ehcache</artifactId>
            </exclusion>
            <exclusion>
                <groupId>asm</groupId>
                <artifactId>asm</artifactId>
            </exclusion>
            <exclusion>
                <groupId>asm</groupId>
                <artifactId>asm-attrs</artifactId>
            </exclusion>
            <exclusion>
                <groupId>javax.transaction</groupId>
                <artifactId>jta</artifactId>
            </exclusion>
        </exclusions>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>${hibernate.version}</version>
        <exclusions>
            <exclusion>
                <groupId>cglib</groupId>
                <artifactId>cglib</artifactId>
            </exclusion>
            <exclusion>
                <groupId>dom4j</groupId>
                <artifactId>dom4j</artifactId>
            </exclusion>
        </exclusions>
    </dependency>
    <dependency>
        <groupId>org.hibernate.javax.persistence</groupId>
        <artifactId>hibernate-jpa-2.0-api</artifactId>
        <version>1.0.0.Final</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-validator</artifactId>
        <version>4.0.2.GA</version>
        <exclusions>
            <exclusion>
                <groupId>javax.xml.bind</groupId>
                <artifactId>jaxb-api</artifactId>
            </exclusion>
            <exclusion>
                <groupId>com.sun.xml.bind</groupId>
                <artifactId>jaxb-impl</artifactId>
            </exclusion>
        </exclusions>
    </dependency>
    <dependency>
        <groupId>javax.validation</groupId>
        <artifactId>validation-api</artifactId>
        <version>1.0.0.GA</version>
    </dependency>
    <dependency>
        <groupId>cglib</groupId>
        <artifactId>cglib-nodep</artifactId>
        <version>2.2</version>
    </dependency>
    <dependency>
        <groupId>javax.transaction</groupId>
        <artifactId>jta</artifactId>
        <version>1.1</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-jdbc</artifactId>
        <version>${spring.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-orm</artifactId>
        <version>${spring.version}</version>
    </dependency>
    <dependency>
        <groupId>commons-pool</groupId>
        <artifactId>commons-pool</artifactId>
        <version>1.5.4</version>
        <exclusions>
            <exclusion>
                <groupId>commons-logging</groupId>
                <artifactId>commons-logging</artifactId>
            </exclusion>
        </exclusions>
    </dependency>
    <dependency>
        <groupId>commons-dbcp</groupId>
        <artifactId>commons-dbcp</artifactId>
        <version>1.3</version>
        <exclusions>
            <exclusion>
                <groupId>commons-logging</groupId>
                <artifactId>commons-logging</artifactId>
            </exclusion>
            <exclusion>
                <groupId>commons-pool</groupId>
                <artifactId>commons-pool</artifactId>
            </exclusion>
            <exclusion>
                <groupId>xerces</groupId>
                <artifactId>xerces</artifactId>
            </exclusion>
            <exclusion>
                <groupId>xerces</groupId>
                <artifactId>xercesImpl</artifactId>
            </exclusion>
            <exclusion>
                <groupId>xml-apis</groupId>
                <artifactId>xml-apis</artifactId>
            </exclusion>
        </exclusions>
    </dependency>

    <!--Hibernate Search-->
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-search</artifactId>
        <version>3.2.1.Final</version>
    </dependency>

    <!--Dozer -->
    <dependency>
        <groupId>net.sf.dozer</groupId>
        <artifactId>dozer</artifactId>
        <version>5.2.2</version>
    </dependency>
    <dependency>
        <groupId>org.apache.xmlbeans</groupId>
        <artifactId>xmlbeans</artifactId>
        <version>2.4.0</version>
    </dependency>

    <!-- Testing dependencies -->
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.8.1</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>org.jmock</groupId>
        <artifactId>jmock-junit4</artifactId>
        <version>2.5.1</version>
        <scope>test</scope>
    </dependency>
</dependencies>

<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-war-plugin</artifactId>
            <version>2.1-beta-1</version>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.1</version>
            <configuration>
                <source>1.6</source>
                <target>1.6</target>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-assembly-plugin</artifactId>
            <version>2.2-beta-5</version>
            <configuration>
                <descriptorRefs>
                    <descriptorRef>jar-with-dependencies</descriptorRef>
                </descriptorRefs>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-deploy-plugin</artifactId>
            <version>2.5</version>
        </plugin>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>tomcat-maven-plugin</artifactId>
            <version>1.0</version>
        </plugin>
        <plugin>
            <groupId>org.mortbay.jetty</groupId>
            <artifactId>maven-jetty-plugin</artifactId>
            <version>6.1.22</version>
        </plugin>
    </plugins>
</build> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:26:13.280

问题是 aspectjrt.1.6.9.M2 不可用。我将其更改为 1.6.11，一切正常。

# ruby-on-rails-3 - Rails 3 的 Michael Hartls 教程中请求规范的标题测试失败

> ID：13479601
> 
> 赞同：2
> 
> 时间：2012-11-20T18:20:16.920
> 
> 标签：ruby-on-rails-3, integration-testing, capybara

我遵循 Michael Hartl 的 Ruby On Rails 3 教程并使用 Capybara 进行集成规范。到目前为止的集成规格如下

```
require 'spec_helper'

describe "StaticPages" do
  describe "Home page" do
    it "should have the h1 'Sample App'" do
      visit '/static_pages/home'
      page.should have_selector('h1',:text => 'Sample App')
    end

    it "should have the title 'Home'" do
      visit '/static_pages/home'
      page.should have_selector('title',:text => "Ruby on Rails Tutorial Sample App | Home")
    end
  end

  describe "Help page" do
    it "should have the h1 'Help'" do
      visit '/static_pages/help'
      page.should have_selector('h1',:text => 'Help')
    end

    it "should have the title 'Help'" do
      visit '/static_pages/help'
      page.should have_selector('title',:text => "Ruby on Rails Tutorial Sample App | Help")
    end
  end

  describe "About page" do
    it "should have the h1 'About Us'" do
      visit '/static_pages/about'
      page.should have_selector('h1',:text => 'About Us')
    end

    it "should have the title 'About'" do
      visit '/static_pages/about'
      page.should have_selector('title',:text => "Ruby on Rails Tutorial Sample App | About Us")
    end
  end
end 
```

当我运行这些测试时，我得到：

```
 1) StaticPages Home page should have the title 'Home'
     Failure/Error: page.should have_selector('title',:text => "Ruby on Rails Tutorial Sample App | Home")
       expected #has_selector?("title") to return true, got false
     # ./spec/requests/static_pages_spec.rb:12:in `block (3 levels) in <top (required)>'

  2) StaticPages Help page should have the title 'Help'
     Failure/Error: page.should have_selector('title',:text => "Ruby on Rails Tutorial Sample App | Help")
       expected #has_selector?("title") to return true, got false
     # ./spec/requests/static_pages_spec.rb:24:in `block (3 levels) in <top (required)>'

  3) StaticPages About page should have the title 'About'
     Failure/Error: page.should have_selector('title',:text => "Ruby on Rails Tutorial Sample App | About Us")
       expected #has_selector?("title") to return true, got false
     # ./spec/requests/static_pages_spec.rb:36:in `block (3 levels) in <top (required)>' 
```

我希望帮助和关于页面的标题测试失败，但我的 home.html.erb 如下

```
<html>
<head>
  <title>Ruby on Rails Tutorial Sample App | Home</title>
</head>
<body>
<h1>Sample App</h1>
<p>
This is the homepage for the sample app
</p>
</body>
</html> 
```

另外，我看到了标题“Ruby on Rails 教程示例应用程序 | '/static_pages/home' 上的主页'。是什么导致房屋所有权测试失败？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-01T17:22:20.227

Capybara 2.1 更改了对查询标题元素的支持。因此，使用 have selector in 以这种方式查询 html 文档头部的 title 元素将失败**"page.should have_selector('title', :text => 'Some text')**。

使用**“page.should have_title('Some text')”**来查询标题元素应该可以工作。这是 2.1 API 实现的用于查询标题元素的新方法。

此外，如果您使用 capybara 2x，建议将位于“spec”文件夹（spec/folder）中名为“requests”的子文件夹中的文件移动到名为“features”（spec/features）的新文件夹中。

希望这行得通。

编码快乐！！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T13:42:09.383

在您的 gemfile 中，更改

```
gem 'capybara' 
```

进入

```
gem 'capybara', '1.1.2' 
```

并运行“捆绑更新”。

# javascript - Kmz 使用安全 URL 时不加载

> ID：13479605
> 
> 赞同：1
> 
> 时间：2012-11-20T18:20:23.253
> 
> 标签：javascript, asp.net-mvc, asp.net-mvc-3, google-maps, google-earth-plugin

我有一个返回 kmz 文件的 URL，该文件是通过具有以下形式的控制器返回的[http://dominio.com/File/Kmz/archivo.kmz](http://dominio.com/File/Kmz/archivo.kmz) 在尝试加载以下 kmz 时

```
var link = ge.createLink('');
            var href = encodeURI("http://dominio.com/File/Kmz/archivo.kmz");
            link.setHref(href);
            var networkLink = ge.createNetworkLink(type + "-" + name);
            networkLink.set(link, true, true);
            ge.getFeatures().appendChild(networkLink); 
```

尝试加载时，会发出以下请求， [http://dominio.com/File/Kml/files/TABLA%20of%20SIMBOLOGIA%20-%20copia_3_1_8_3_2.png](http://dominio.com/File/Kml/files/TABLA%20of%20SIMBOLOGIA%20-%20copia_3_1_8_3_2.png)这是 KMZ 中的文件。

控制器代码如下：

```
public FileResult(string id){
/*...........*/
return File(uri,"application/vnd.google-earth.kmz",string.Format("{0}-{1}","Kmz",id));
} 
```

仅当不加载 kmz 包含多边形和标记（如果显示）内的图片时才会发生。

# r - 时间数据子集

> ID：13479606
> 
> 赞同：1
> 
> 时间：2012-11-20T18:20:28.980
> 
> 标签：r, time, subset

我正在尝试基于 POSIXct 变量制作一个简单的 df 子集，但它不起作用......

```
a2001 <- subset(anillas, anillas$data=="21-03-2001") 
```

它给出“0 obs. of 74 variables”

我不知道这些变量有什么不同吗？

谢了。

好的，所以这是一部分`str(anillas)`

```
 $ rc          : num  NA NA NA NA NA NA NA NA NA NA ...
 $ ss          : num  NA NA NA NA NA NA NA NA NA NA ...
 $ tg          : num  NA NA NA NA NA NA NA NA NA NA ...
 $ ug          : num  NA NA NA NA NA NA NA NA NA NA ...
 $ data        : POSIXct, format: "2001-03-21" "2001-03-23" ... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T08:18:51.830

您必须与可比较的东西进行比较。在您的尝试中，您将`POSIXct`对象与`character`字符串进行了比较。
您需要首先将要使用子集的日期转换`anillas`为`POSIXct`：

```
date1 <- strptime("21-03-2001","%d-%m-%Y")
a2001 <- subset(anillas, data==date1) 
```

# python - 使用python字典在gephi上生成朋友图

> ID：13479610
> 
> 赞同：1
> 
> 时间：2012-11-20T18:20:32.220
> 
> 标签：python, gephi

我正在尝试使用 gephi (http://gephi.org/) 生成朋友地图。目前我的数据存储在一个字典中，如下所示：

```
{id1 : [friend_id, friend_id2 etc],
id2 : [friend_id3],
id3 : ... } 
```

gephi 需要的数据结构是什么，看起来像这样 [https://gephi.org/wp-content/themes/gephi/images/screenshots/layout2-mini.png](https://gephi.org/wp-content/themes/gephi/images/screenshots/layout2-mini.png)

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T06:46:20.260

您可以在多个之间进行选择。最简单的方法是使用 Excel 图表并将其保存为 CSV。在第一列中放入 person1id，在 column2 中放入 person2id：

```
 person1id  person2id
 Adam       Maria
 Maria      Ben
 Ben        Adam 
```

您还可以使用以下任何格式：[https](https://gephi.org/users/supported-graph-formats/) ://gephi.org/users/supported-graph-formats/ 从您的数据中最容易生成的可能是 GML 或 GraphML。

另请参阅我对这个问题的回答，概述如何使用 GML：[Data structure for Visualizing organizations and individual using Gephi？](https://stackoverflow.com/questions/9592370/data-structure-for-visualizing-organizations-and-individuals-using-gephi/10772810#10772810)

# sql - 从两个 Select 语句返回重叠的 SQL 语句

> ID：13479612
> 
> 赞同：2
> 
> 时间：2012-11-20T18:20:39.963
> 
> 标签：sql, sql-server, tsql

我在 SQL 服务器上有一个表和两个具有不同 WHERE 条件的 Select 语句

我想要的是匹配两个 Select 语句的结果，而不仅仅是一个。

我尝试过嵌套的 SELECT 语句，但运气不佳。

我的表如下所示

```
ID    Name    Field2    Field3

1     John     100       NULL
2     Dave     150       NULL
3     Tim      NULL      150
4     Dave     NULL      150 
```

我的 SELECT 语句如下：

```
SELECT * FROM table WHERE Field2 = 150
SELECT * FROM table WHERE Field3 = 150 
```

但我只想返回“Dave”，因为只有他出现在两个 SELECT 语句的结果中。

我如何实现这一目标？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T18:22:03.017

使用[`INTERSECT`](http://msdn.microsoft.com/en-us/library/ms188055.aspx)：

```
SELECT Name FROM table WHERE Field2 = 150
INTERSECT
SELECT Name FROM table WHERE Field3 = 150 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:25:45.007

您可以使用`EXISTS`：

```
SELECT t1.name
FROM table1 t1
WHERE (Field2 = 150) 
  and exists (select *
              from table1 t2
              where Field3 = 150
               and t1.name = t2.name); 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/fcdb0/6)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:33:54.483

或者只是`inner join`：

```
select name from (
(SELECT name FROM table WHERE Field2 = 150) f2 inner join
(SELECT name FROM table WHERE Field3 = 150) f3 on 
f2.name = f3.name 
```

# jsp - jsp forward 没有按预期工作

> ID：13479618
> 
> 赞同：4
> 
> 时间：2012-11-20T18:21:30.493
> 
> 标签：jsp, forward

我有 jsp，具体取决于我正在转发到另一个页面的某些条件。

我有 /myjsp/first.jsp ，其代码为，

```
<%
if(some condtion){
   somelogic                
}
else
{
       application.getRequestDispatcher("/myjsp/another.jsp").forward(request,response);
}
%>
<div>
    <jsp:include page='header.jsp' />
</div> 
```

在这段代码中，如果流程来了，否则条件控制将转到另一个.jsp。

但它也显示在 /myjsp/first.jsp 的 div 标签下方。

我想在 another.jsp 到达那里后继续控制它，它不应该显示当前页面中的任何内容，即来自 /myjsp/first.jsp 的 div 标记

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T04:50:43.860

利用：

```
<jsp:forward page="pageName.jsp"></jsp:forward> 
```

而不是 application.getRequestDispatcher("/myjsp/another.jsp").forward(request,response);

或者

response.sendRedirect("pagenName.jsp");

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:09:16.220

把`div`里面的`if`。

或者更好的是，不要使用 scriptlet，也不要从 JSP 转发。JSP 应该用作视图组件，并且只生成标记。工作流应该从您首选的 MVC 框架的 servlet 或操作内部完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-28T23:13:31.927

我同意，您不应该在 jsp 中使用 'forward'（或 sendRedirect），因为使用 scriptlet 在响应缓冲区中有 HTML 代码，可以通过使用 <%@ page autoFlush 增加缓冲区大小来修复（或隐藏）问题="true" 缓冲区="2000kb"%>; 我所做的是使用 JavaBeans。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T07:15:21.937

利用

```
 response.sendRedirect(); 
```

反而

```
 forward(); 
```

我认为它会解决你的问题。

# java - 为 ListViews 使用自定义 BaseAdapter - 多个片段？

> ID：13479629
> 
> 赞同：0
> 
> 时间：2012-11-20T18:22:14.280
> 
> 标签：java, android, android-listview, android-fragments, android-adapter

我已经设法组装了一个自定义 BaseAdapter。此适配器用于为每个列表项显示三个 TextView。*当活动中有一个*ListView时，工作绝对完美。

但是，我正在使用带有 3 个片段的碎片活动 - 其中 2 个包含需要使用我的自定义适配器和 XML 的 ListView。

在加载这两个 ListView 时，在加载的*第一个*ListView 上触发 onItemClickListener 会导致以下错误：

```
11-20 18:02:15.295: E/AndroidRuntime(18563): java.lang.IllegalStateException: 
The content of the adapter has changed but ListView did not receive a 
notification. Make sure the content of your adapter is not modified from 
a background thread, but only from the UI thread. [in ListView(2131165192, 
class android.widget.ListView) with 
Adapter(class com.my.project.Adapter_CustomList)] 
```

我不希望适配器发生变化 - 每个 ListView 适配器都使用一个新的 Adapter_CustomList() 所以我不确定为什么它们被引用为同一个适配器？

适配器将 getActivity() 作为上下文 - 因为这对两者都是一样的，这会导致问题吗？有没有办法解决这个问题，或者这是碎片的另一个缺点？

自定义适配器大致如下，我已经取出了一些任意的代码块......

```
public class Adapter_CustomList extends BaseAdapter {

private static ArrayList<Custom> results;

private LayoutInflater mInflater;

public Adapter_CustomList(Context context, ArrayList<Custom> res) {
    results = res;
    mInflater = LayoutInflater.from(context);
}

public int getCount() {
    return results.size();
}

public Object getItem(int position) {
    return results.get(position);
}

public long getItemId(int position) {
    return position;
}

public View getView(int position, View convertView, ViewGroup parent) {
    ViewHolder holder;
    if (convertView == null) {
        convertView = mInflater.inflate(R.layout.custom_row_view, null);
        holder = new ViewHolder();

        //Set ViewHolder vars from inflated view

        convertView.setTag(holder);
    } else {
        holder = (ViewHolder) convertView.getTag();
    }

    //Sets the TextViews

    return convertView;
}

static class ViewHolder {
    //Contains the TextView text vars
}
} 
```

该活动正在使用 FragmentPagerAdapter（由 Eclipse 生成）：

```
public class SectionsPagerAdapter extends FragmentPagerAdapter {

    public SectionsPagerAdapter(FragmentManager fm) {
        super(fm);
    }

    @Override
    public Fragment getItem(int i) {
        Fragment fragment;
        switch (i){
            case 1: 
                fragment = new Frag_ListOne();
                break;
            case 2:
                fragment = new Frag_ListTwo();
                break;
            default:
                fragment = new Frag_Temporary();
                break;
        }
        return fragment;
    }

    @Override
    public int getCount() {
        return 3;
    }

    @Override
    public CharSequence getPageTitle(int position) {
        switch (position) {
            case 0: return getString(R.string.main_fragment1).toUpperCase();
            case 1: return getString(R.string.main_fragment2).toUpperCase();
            case 2: return getString(R.string.main_fragment3).toUpperCase();
        }
        return null;
    }
} 
```

片段示例，两者几乎相同，但具有独特的布局文件。

```
public class Frag_ListOne extends Fragment {

private ListView ListView;
private Adapter_CustomList listAdapter;

private Fetcher fetcher;

public Frag_ListOne(){}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState){
    return inflater.inflate(R.layout.frag_list_one, container, false);
}

@Override
public void onStart(){
    super.onStart();
    ListView = (ListView) getActivity().findViewById(R.id.frag_one_list);
    ListView.setEmptyView(getActivity().findViewById(R.id.frag_one_list_spinner));
    if (listAdapter != null){
        setListAdapter();
    } else {
        //This will always be called for now....
        sendRequest();
    }
}

private void sendRequest(){
    fetcher = new Fetcher();
    fetcher.execute("http://myapiurl.com");
}

private void cancelFetch(){
    if (fetcher != null && 
            (fetcher.getStatus() == AsyncTask.Status.PENDING || fetcher.getStatus() == AsyncTask.Status.RUNNING)){
        fetcher.cancel(true);
    }
}

private void displayError(String errMsg){
    //Log errMsg
}

private void createListAdapter(ArrayList<Result> res){
    listAdapter = new Adapter_CustomList(getActivity(), res);
    setListAdapter();
}

private void setListAdapter(){
    ListView.setAdapter(listAdapter);
    ListView.setOnItemClickListener(new OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> a, View v, int position, long id) {
            Result r = (Result) ListView.getItemAtPosition(position);
            Intent intent = new Intent(getActivity(), ViewResultActivity.class);
            intent.putExtra(F_List.INTENT_VIEW_RESULT_OBJ, r);
            startActivity(intent);
        }
    });
}

//Extended AsyncTask, essentially
public class Fetcher extends JSONRequest{

    @Override
    protected void onSuccess(JSONObject req, JSONObject res){
        if (req != null && res != null){
            try{
                JSONArray jsons = res.getJSONArray("results");
                ArrayList<Result> res = new ArrayList<Result>();
                if (jsons.length() > 0){
                    for (int i=0;i<jsons.length();i++){
                        JSONObject jo = jsons.getJSONObject(i);
                        r = new Result();
                        r.setLineOne(jo.getInt("line1"));
                        r.setLineTwo(jo.getString("line2"));
                        r.setLineThree(jo.getString("line3"));
                        res.add(r);
                    }
                    createListAdapter(res);
                } else {
                    //Nothing found
                }
            } catch (JSONException e){}
        } else {
            //Null received
        }
    }

    @Override
    protected void onError(String errMsg){}

    @Override
    protected void onCancel(){}

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:51:17.463

适配器代码看起来不错——我做了类似的事情，在不同的片段中运行两个列表视图。（我假设结果实际上等于 offerResults）

也许您附加到列表视图的方式存在问题？

*   确保 Adapter 和 listViews 都在片段而不是活动中被引用。

*   检查您是否设置了适配器，然后更改驱动它的列表而不调用 adapter.notifyDataSetChanged()

参考 Fragments 和适配器的声明方式可以更有用:)

**编辑：**

我正在运行一个系统，我将使用 FragmentManager 而不是 FragmentPagerAdapter 将 2 个片段膨胀到 FrameLayouts 中。

我会仔细检查片段是否在片段寻呼机适配器中正确创建和访问。您可以通过从 getItem() 记录 fragmentId 来做到这一点

还要小心 getItem(...) 的编写方式，因为如果你不断产生新的片段，这会很快导致内存不足错误。相反，我会考虑使用片段管理器和标签来管理新片段的创建。

另一个想法是考虑在滑动抽屉内设置您的列表，以便他们可以根据需要将它们拉出。

编辑 2：尝试以下更改 - 这样列表存在于片段的内存中，而不是 AsyncTask 的一部分，完成后可能会被 GC。

```
 private ArrayList<Result> resultList = new ArrayList<Result>();
 private Adapter_CustomList adapter = null;

 @Override
 public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState){
     View v = inflater.inflate(R.layout.frag_list_one, container, false);
     listView = (ListView) v.findViewById(R.id.frag_one_list);
     listView.setEmptyView(v.findViewById(R.id.frag_one_list_spinner));
     adapter = new Adapter_CustomList(getActivity(), resultList);
     listView.setAdapter(adapter);
 }

 @Override
 public void onStart(){
     super.onStart();
 }

 //Extended AsyncTask, essentially
 public class Fetcher extends JSONRequest{

@Override
protected void onSuccess(JSONObject req, JSONObject res){
    if (req != null && res != null){
        try{
            JSONArray jsons = res.getJSONArray("results");
            if (jsons.length() > 0){
                for (int i=0;i<jsons.length();i++){
                    JSONObject jo = jsons.getJSONObject(i);
                    r = new Result();
                    r.setLineOne(jo.getInt("line1"));
                    r.setLineTwo(jo.getString("line2"));
                    r.setLineThree(jo.getString("line3"));
                    resultList.add(r);
                }
                adapter.notifyDataSetChanged();
            } else {
                //Nothing found
            }
        } catch (JSONException e){}
    } else {
        //Null received
    }
}

@Override
protected void onError(String errMsg){}

@Override
protected void onCancel(){}

} 
```

# php - php中的支付网关集成

> ID：13479633
> 
> 赞同：0
> 
> 时间：2012-11-20T18:22:30.097
> 
> 标签：php, paypal, payment, gateway

我正在尝试将支付网关集成到我由 PHP 开发的网站中。为此，我正在使用 PayPal。我的代码如下：

```
<form name="frm" action="https://www.sandbox.paypal.com/cgi-bin/webscr" method="post">
    <div style="padding-left:250px;">
         <input type="hidden" name="cmd" value="_xclick" />
         <input type="hidden" name="business" value="MY_BUSINESS_MAIL_ID" />
         <input type="hidden" name="amount" value="<?php echo $amount; ?>" />
         <input type="hidden" name="no_shipping" value="1" />
         <input type="hidden" name="no_note" value="1" />
         <input type="hidden" name="currency_code" value="USD" />
         <input type="hidden" name="lc" value="USD" />
         <input type="hidden" name="item_name" value="Registration" />
         <input type="hidden" name="bn" value="PP-BuyNowBF" />
         <input type="hidden" name="return" value="<?php echo FRONT_END_PATH;?>payment-over.php?user_id=<?php echo $username;?>&req_amt=<?php echo $amount; ?>&role_name=<?php echo $role;?>&inramnt=<?php echo $inrAmnt; ?>" />
         <input type="hidden" name="rm" value="2" />
         <input type="submit"  border="0" name="submit" value="Order" alt="Make payments with PayPal - it's fast, free and secure!" class="additional_height button" title="Make payments with PayPal - it's fast, free and secure!" />
         <img alt="" border="0" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1" /> 
     </div>
</form> 
```

现在我的问题是，如果客户尝试在印度境内付款，此代码是否正确。另外，用户可以使用他们的信用卡付款吗？我的最后一个问题是用户可以通过网上银行付款吗？

请帮我。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:26:18.807

您的代码与用户付款方式无关。这一切都由贝宝处理。我不确定其他国家。但在印度，用户无法通过 Netbanking 向贝宝付款。

他们只能通过信用卡/借记卡付款。

你也知道

印度贝宝账户，**不能**接受来自另一个印度贝宝账户的任何付款。

# python - TypeError：“str”对象不可调用

> ID：13479634
> 
> 赞同：0
> 
> 时间：2012-11-20T18:22:30.847
> 
> 标签：python, string-matching

我对 Python 有一个奇怪的问题。出于某种原因，当我从命令行调用它时，我可以尽可能多地使用 replace() 函数，但我不能在特定类中使用它。该代码产生以下（众所周知的）错误：

```
 File "/homes/mmj11/malice/lexer.py", line 96, in replaceInTree
    tree[i] = tree[i].replace("  "," ")
    TypeError: 'str' object is not callable 
```

我正在使用的功能如下：

```
 def replaceInTree(self, tree):
    for i in range(len(tree)):
      if type(tree[i] is str):
         tree[i] = tree[i].replace("  "," ")
         tree[i] = tree[i].replace(tree[i], self.getToken(tree[i]))
      else:
         tree[i] = self.replaceInTree(tree)
    return tree 
```

我真的认为这不应该发生，因为我可以在命令行中做完全相同的事情。我非常确定 str 是可调用的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T18:26:01.457

代替

```
 if type(tree[i] is str): 
```

你不是故意的吗

```
 if type(tree[i]) is str: 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:26:01.463

我会这样做：

```
if type(tree[i]) is str: 
```

而不是这个：

```
if type(tree[i] is str): 
```

您编写它的方式评估为`if type(false)`，相当于`if bool`，这将始终是真实的。

# jquery - 在 Grails 中使用 Twitter 引导程序，看起来不同

> ID：13479636
> 
> 赞同：0
> 
> 时间：2012-11-20T18:22:50.613
> 
> 标签：jquery, css, grails, twitter-bootstrap, color-picker

我按照[icodeya](http://www.icodeya.com/2012/10/grails-how-do-i-add-color-picker-in-my.html)的教程在文本字段中添加颜色选择器。不同的是，我使用了[twitter bootstrap](http://www.eyecon.ro/bootstrap-colorpicker/)而不是 miniColor.js。但我无法让它工作。

这是我的代码：

配置文件

```
grails.resources.modules = {
jQuery{
resource url:'http://code.jquery.com/jquery-1.8.2.min.js', disposition: 'head'
}

colorPicker{
dependsOn 'jQuery'

resource url: '/js/jquery.twitterBootstrap.js', disposition: 'head'
resource url: '/css/jquery.twitterBootstrap.css'
}
} 
```

/css/twitterBootStrap.css

```
 /*
    Colorpicker for Bootstrap
    Copyright 2012 Stefan Petre 
    Licensed under the Apache License v2.0
    http://www.apache.org/licenses/LICENSE-2.0
*/
 .colorpicker-saturation { width: 100px; height: 100px; background-image: url(/img/saturation.png); cursor: crosshair; float: left; } .colorpicker-saturation i { display: block; height: 5px; width: 5px; border: 1px solid #000; -webkit-border-radius: 5px; -moz-border-radius: 5px; border-radius: 5px; position: absolute; top: 0; left: 0; margin: -4px 0 0 -4px; } .colorpicker-saturation i b { display: block; height: 5px; width: 5px; border: 1px solid #fff; -webkit-border-radius: 5px; -moz-border-radius: 5px; border-radius: 5px; } .colorpicker-hue, .colorpicker-alpha { width: 15px; height: 100px; float: left; cursor: row-resize; margin-left: 4px; margin-bottom: 4px; } .colorpicker-hue i, .colorpicker-alpha i { display: block; height: 1px; background: #000; border-top: 1px solid #fff; position: absolute; top: 0; left: 0; width: 100%; margin-top: -1px; } .colorpicker-hue { background-image: url(/img/hue.png); } .colorpicker-alpha { background-image: url(/img/alpha.png); display: none; } .colorpicker { *zoom: 1; top: 0; left: 0; padding: 4px; min-width: 120px; margin-top: 1px; -webkit-border-radius: 4px; -moz-border-radius: 4px; border-radius: 4px; } .colorpicker:before, .colorpicker:after { display: table; content: ""; } .colorpicker:after { clear: both; } .colorpicker:before { content: ''; display: inline-block; border-left: 7px solid transparent; border-right: 7px solid transparent; border-bottom: 7px solid #ccc; border-bottom-color: rgba(0, 0, 0, 0.2); position: absolute; top: -7px; left: 6px; } .colorpicker:after { content: ''; display: inline-block; border-left: 6px solid transparent; border-right: 6px solid transparent; border-bottom: 6px solid #ffffff; position: absolute; top: -6px; left: 7px; } .colorpicker div { position: relative; } .colorpicker.alpha { min-width: 140px; } .colorpicker.alpha .colorpicker-alpha { display: block; } .colorpicker-color { height: 10px; margin-top: 5px; clear: both; background-image: url(/img/alpha.png); background-position: 0 100%; } .colorpicker-color div { height: 10px; } .input-append.color .add-on i, .input-prepend.color .add-on i { display: block; cursor: pointer; width: 16px; height: 16px; } 
```

在我的 gsp 文件中，我添加了：

```
<r:require module="colorPicker" / >
<script> 
jQuery.noConflict();
jQuery(document).ready( function() {
jQuery('#myColorPicker').colorpicker();
});
</script>
<br/><br/> 
```

我还在grails的js文件夹中添加了js文件。但是，它看起来像这样：

![在此处输入图像描述](../Images/2ed75ed11e01697a0d04a48df8a4312a.png)

我看不到从黑色到粉红色的渐变；只是全是粉红色的。但是当我点击一个点时，比如在右下角，我会得到预期的深色。我的代码的结果并没有显示出来。

我正在使用 Google Chrome 的 21.0.1180.75 版本。它看起来确实与 eyecon.ro 网站上演示的不同。

为什么这不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T21:25:22.020

图像的路径不正确。假设 colorpicker 文件夹在您下载它时是完整的，那么指向文件的 css 链接应该是`../img/*`而不是`/img/*`. 原始的css是错误的。但是，包含的 .less 文件是正确的。

# wordpress - WordPress：发布的工作流程是什么？

> ID：13479637
> 
> 赞同：1
> 
> 时间：2012-11-20T18:22:54.543
> 
> 标签：wordpress

我是 WP 新手，这些是我的步骤：

*   我下载了 wp 并安装了它（我还安装了一对插件和一个主题......）。
*   我在远程主机中创建了一个 git 存储库，并推送了 wp 项目。在远程主机中，我将 git repo 克隆到 `/var/www/my_wp_project`.
*   我请求网址 `http://my_remote_host/my_wp_project`，但它询问我是否**再次安装 wp** ...
*   那么重新安装wp后，主题**与本地不一样**......！

任何人都可以提供一些建议吗？

# android - Android：如何在不同的变量中获取 JSONArray 字符串

> ID：13479638
> 
> 赞同：1
> 
> 时间：2012-11-20T18:22:55.230
> 
> 标签：android, json, arrays

我正在构建一个应用程序，在其中我以`["anything","everthing"]`这种格式使用服务器端 JSON 数据。我正在尝试将两个字符串存储到不同的不同变量中，我尝试了这些代码：

```
try {
        URL API = new URL(
                "http://......com/asd.php");
        URLConnection tc = API.openConnection();
        BufferedReader in = new BufferedReader(new InputStreamReader(
                tc.getInputStream()));
        String line;
        while ((line = in.readLine()) != null) {
            JSONArray ja = new JSONArray(line);
            for (int i = 0; i < ja.length(); i++) {
                Log.i(i);
                Log.i("JSONArray String here " + ja.toString());
            }
        }
    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (JSONException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

我要一串串出来。谁能帮我将这两个字符串存储在不同的变量中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:37:11.213

将您的代码更改为：

```
BufferedReader in = new BufferedReader(new InputStreamReader(
                tc.getInputStream()));
StringBuilder sb = new StringBuilder();
String line;
    while ((line = in.readLine()) != null) {
        sb.append(line);
    }
    in.close();
JSONArray ja = new JSONArray(sb.toString());
for (int i = 0; i < ja.length(); i++) {
    Log.i(i);
    Log.i("JSONArray String here " + ja.getString(i));
 }
//Your Code... 
```

# r - 针织者——！LaTeX 错误：找不到文件“figure/unnamed-chunk-1”

> ID：13479641
> 
> 赞同：3
> 
> 时间：2012-11-20T18:23:03.280
> 
> 标签：r, latex, knitr

我是 knitr 和 Latex 的新手。

我不断收到错误“！LaTeX 错误：找不到文件‘figure/unnamed-chunk-1’。” 错误消息说：

```
>! LaTeX Error: File `figure/unnamed-chunk-1' not found.
> See the LaTeX manual or LaTeX Companion for explanation.
> Type H <return> for immediate help.
...
> l.77 ...[width=\textwidth]{figure/unnamed-chunk-1}
> I could not locate the file with any of these extensions:
> .png,.pdf,.jpg,.mps,.jpeg,.jbig2,.jb2,.PNG,.PDF,.JPG,.JPEG,.JBIG2,.JB2,.eps 
```

我有一个简单的 tex 文件

```
\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage{graphicx}
\usepackage[font={small}]{caption}
\author{My Name }
\title{knitr example}
\begin{document}
\maketitle

<<loading,echo=F>>=
library(ggplot2)
@

<< message=F,fig.width=9,fig.height=6,out.width='\\textwidth',cache= TRUE>>=
mydata  <- data.frame(year = seq(1901: 1950), debt = rnorm(50))
plot(mydata$year, mydata$debt, main = "Debt")
@
\end{document} 
```

我似乎找不到任何似乎相关的东西。显然“figure/unnamed-chunk-1”应该出现在某处，但我在 knitr options 文档中没有看到任何建议保存它的具体方法，到目前为止，我对 knitr 的了解还不够，无法弄清楚命名要导入的绘图的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T17:22:48.550

It has been solved in the [knitr mailing list](http://groups.google.com/group/knitr/browse_thread/thread/fecc38b00b4b9284). The problem was due to use of absolute paths in the `output` argument in `knit()`, so figures and tex output were not in the same directory. It is not recommended to use absolute paths in general; see more discussion in the mailing list.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-13T02:40:37.657

一个老问题，但我最近偶然发现了这些问题，无论是在 MacOS 还是 Win 上。我已经尝试了上面的解决方案，但没有奏效。对我有用的是删除`figure-latex`文件夹内的所有图形并重新运行编织。

# java - 如何使用 Jsoup 从 HTML 解析新行

> ID：13479645
> 
> 赞同：4
> 
> 时间：2012-11-20T18:23:11.437
> 
> 标签：java, html-parsing, jsoup

当我使用 jsoup 解析 HTML 文件时，HTML 文件中的多行文本（带`< br />`）显示为单行，不带新行（`\n`）。我如何将多行 HTML 文档解析为多行字符串？

我正在使用以下方法：`Element.text()`

例如：

HTML 包含在 HtMl 文件的多行中正确显示的 C 代码，但是当我获取文本数据时，所有数据都显示在一行中，没有换行符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T00:25:35.420

替换`<br />`为其他内容并返回，如下所示：

```
Document doc = Jsoup.connect("http://www.ejemplo.html").get(); //Here included the <br>'s
String temp = doc.html().replace("<br />", "$$$"); //$$$ instead <br>
doc = Jsoup.parse(temp); //Parse again

String text = doc.body().text().replace("$$$", "\n").toString()); //example
//I get back the new lines (\n) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T20:43:42.710

`text()`Element (and `TextNode`) 调用的方法`appendWhitespaceIfBr(...)`将用空格替换每个`<br />`（或空格）。不幸的是，我看不到在不处理代码的情况下关闭它的机制。

但也许您可以尝试将所有`<br />`标签替换为`Node`.

# css - Global Permissions-Based Navigation Sharepoint Foundation 2010

> ID：13479647
> 
> 赞同：0
> 
> 时间：2012-11-20T18:23:17.460
> 
> 标签：css, sharepoint, sharepoint-2010, master-pages, web-parts

我正在使用 SharePoint Foundation 2010，我想创建一个多级导航。（类似于发布网站在 SharePoint Standard 中允许的内容。我意识到这可能是使用自定义站点地图提供程序构建的，我已经研究过了。

这里的关键是，我希望它只显示登录用户有权访问的页面和站点。

目前，我已经开始开发 Web 部件。在此 Web 部件中，我编写了一些 c# 代码来循环并获取所有站点和子页面（并检查用户是否具有权限），然后将它们添加到标签中。最终我想将它们添加到 asp:menu 或创建一个然后使用一些 css 或 jquery 来操纵它来执行下拉功能。

这是我的一些代码：

```
using (SPWeb oWebsite = new SPSite(webUrl).OpenWeb())
        {
            SPWebCollection collWebsite = oWebsite.Webs;

            foreach (SPWeb subSite in collWebsite)
            {
                if (subSite.DoesUserHavePermissions(SPContext.Current.Web.CurrentUser.LoginName, SPBasePermissions.Open))
                {
                    Label1.Text += SPEncode.HtmlEncode(subSite.Title) + "<BR>";
                }

                SPList pagelist = subSite.Lists["Site Pages"];

                foreach (SPListItem item in pagelist.Items)
                {
                    if (item.DoesUserHavePermissions(SPContext.Current.Web.CurrentUser, SPBasePermissions.Open))
                                            {
                        Label1.Text += item.Name + "<BR>";
                    }
                }

                Label1.Text += "<BR><BR>";

                subSite.Close();
            }

            Label1.Text += "<BR><BR><BR><BR>";
        }

    } 
```

我不想将站点或页面添加到标签，而是在这里创建列表。最终目标是将此 Web 部件放在母版页上，并允许它根据权限为用户提供一些导航。

我还发现了一些 css 可以通过简单地添加元素来允许多级导航工作

*   这里唯一的问题是，一旦我将它放在母版页上，当我将鼠标悬停在第一个项目上时会显示第二级，但在将鼠标移到那里时会消失。（当 web 部件被放置到页面本身时，这很有效）

    我是在正确的轨道上还是有另一种可能同样有效甚至更好的方法？

    TIA。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T18:25:04.007

```
 SPSecurity.RunWithElevatedPrivileges(delegate
          {

        SPSite oSiteCollection = SPContext.Current.Site;

        using (SPWeb oWebsite = new SPSite(webUrl).OpenWeb())
        {
            SPWebCollection collWebsite = oWebsite.Webs;

            foreach (SPWeb subSite in collWebsite)
            {
                var newItem = new MenuItem();
                if (subSite.DoesUserHavePermissions(SPContext.Current.Web.CurrentUser.LoginName, SPBasePermissions.Open))
                {
                    newItem.NavigateUrl = subSite.Url;
                    newItem.Text = SPEncode.HtmlEncode(subSite.Title);
                    newItem.Value = SPEncode.HtmlEncode(subSite.Title);
                }

                SPList pagelist = subSite.Lists["Site Pages"];

                foreach (SPListItem item in pagelist.Items)
                {

                    if (item.DoesUserHavePermissions(SPContext.Current.Web.CurrentUser, SPBasePermissions.Open))
                    {
                        var subItem = new MenuItem();
                        subItem.Value = SPEncode.HtmlEncode(item.Name);
                        subItem.Text = SPEncode.HtmlEncode(item.Name);
                        subItem.NavigateUrl = item.Url;
                        newItem.ChildItems.Add(subItem);
                    }

                }

                mnNAv.Items.Add(newItem);
                subSite.Close();
           }

        }
}); 
```

# jquery - 在 Ext JS 3.4 中的初始化之外禁用 GridPanel LoadMask

> ID：13479649
> 
> 赞同：0
> 
> 时间：2012-11-20T18:23:20.300
> 
> 标签：jquery, extjs, extjs3

有没有办法在初始化配置之外禁用 GridPanel 的 LoadMask？我知道我可以`gridPanel.getView().setLoading(false)`从 Ext JS 4 开始。但是有 Ext JS 3.4 的解决方案/解决方法吗？

之前或之前的任何事件`afterrender`都应该这样做。

另外，这可以通过jquery完成吗？（鉴于对象层次结构问题）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:29:10.520

试试这个：

```
Ext.apply(gridPanel,{
  loadMask: false
}); 
```

# c# - 更改访问修饰符解决方法

> ID：13479654
> 
> 赞同：1
> 
> 时间：2012-11-20T18:23:42.170
> 
> 标签：c#

我对 C# 还很陌生，所以如果这是一个愚蠢的问题，请原谅我。我遇到了一个错误，但我不知道如何解决它。我正在使用 Visual Studio 2010。我已经实施了社区成员的几个修复，但问题似乎不断出现。

它从这个代码行开始

```
public class GClass1 : KeyedCollection<string, GClass2> 
```

我给了我错误

```
'GClass1' does not implement inherited abstract member 'System.Collections.ObjectModel.KeyedCollection<string,GClass2>.GetKeyForItem(GClass2)' 
```

从我读过的内容来看，这可以通过在继承类中实现抽象成员来解决，就像这样

```
public class GClass1 : KeyedCollection<string, GClass2>
{
  public override TKey GetKeyForItem(TItem item);
  protected override void InsertItem(int index, TItem item)
  {
    TKey keyForItem = this.GetKeyForItem(item);
    if (keyForItem != null)
    {
        this.AddKey(keyForItem, item);
    }
    base.InsertItem(index, item);
} 
```

然而，这给了我错误，说“找不到类型或命名空间名称 TKey/TItem 找不到。” 所以我替换了占位符类型。

目前代码是

```
public class GClass1 : KeyedCollection<string, GClass2>
{

  public override string GetKeyForItem(GClass2 item);
  protected override void InsertItem(int index, GClass2 item)
  {
    string keyForItem = this.GetKeyForItem(item);
    if (keyForItem != null)
    {
      this.AddKey(keyForItem, item);
    }
  base.InsertItem(index, item);
 } 
```

我完全忘记了 GetKeyForItem 是受保护的。新错误告诉我在覆盖 System.Collections.ObjectModel.KeyedCollection.GetKeyForItem(GCl‌​ass2) 时无法更改访问修饰符。

我也收到一个奇怪的错误，说“GClass1.GetKeyForItem(GClass2)”必须声明一个主体，因为它没有被标记为抽象、外部或部分的

访问修饰符问题是否有任何解决方法，有人可以解释“声明一个主体，因为它没有被标记”错误吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:27:20.867

[`GetKeyForItem`](http://msdn.microsoft.com/en-us/library/ms132454.aspx)在基抽象类中受到保护，因此它必须在派生类中受到保护。（另外，我想你会想要实现它——这是你的第二个错误的根源，因为方法必须有一个主体，除非它们是抽象的。）

这应该编译：

```
protected override string GetKeyForItem(GClass2 item)
{
    throw new NotImplementedException();

    // to implement, you'd write "return item.SomePropertyOfGClass2;"
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T18:30:33.863

您需要完全按照定义的方式实现抽象方法。如果您希望该方法可以公开访问，而不是仅具有`protected`它定义的可访问性，您需要添加一个新的、单独的方法来使用它：

```
public class GClass1 : KeyedCollection<string, GClass2>
{
    protected override string GetKeyForItem(GClass2 item)
    {
        throw new NotImplementedException();
    }

    public string GetKey(GClass2 item)
    {
        return GetKeyForItem(item);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:29:51.767

该错误`'GClass1.GetKeyForItem(GClass2)' must declare a body because it is not marked abstract, extern, or partial'`可能意味着您需要*实现*该方法，而不是简单地在您的类中声明它。实际上，您需要在其中添加一段代码

```
protected override string GetKeyForItem(GClass2 item)
{
     // some code
} 
```

即使它什么也不做。

# knockout.js - 淘汰赛模板，allBindingsAccessor

> ID：13479662
> 
> 赞同：0
> 
> 时间：2012-11-20T18:24:13.680
> 
> 标签：knockout.js

有没有办法访问模板中的其他绑定属性，类似于自定义绑定的 allBindingsAccessor？

例如，像在 Knockout 站点上的自定义绑定示例中一样传递 slideDuration。

```
<div data-bind="template: { name: 'person-template', data: buyer, slideDuration:600  }"></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T20:57:55.020

没有办法直接访问您传递给模板的“额外”属性。使用 jQuery 模板时，可以使用[此处](http://www.knockmeout.net/2011/03/quick-tip-reusing-template-by-passing.html)`templateOptions`描述的参数。本机模板引擎不支持此功能。

完成您所追求的最简单的方法是将其作为数据的一部分传递。您甚至可以匿名执行此操作，例如：

```
data-bind="template: { name: 'person-template', data: { data: buyer, slideDuration:600 }  }" 
```

在您的模板中，您需要引用`data`而不是直接引用数据的属性。

# performance - $ORDER 与计数扫描全局范围

> ID：13479673
> 
> 赞同：1
> 
> 时间：2012-11-20T18:25:02.790
> 
> 标签：performance, intersystems-cache

我可以在两种扫描大型全局数组中的关键级别的方法之间进行选择，并试图弄清楚一种方法是否比另一种更有效。

这是 Intersystems Caché 数据库平台上供应商提供的应用程序和数据库。它是用旧的 MUMPS 风格编写的，不使用任何 Caché 的对象持久性功能：所有数据直接存储在全局变量中，任何索引都由应用程序维护。

重复附加到实体的数据元素有一个通用约定，其中第一条记录将包含子记录的计数，然后每个子记录在下一个关键级别按顺序编号。例如：

```
^GBDATA(12345,100)="3"
^GBDATA(12345,100,1)="A^Record"
^GBDATA(12345,100,2)="B^Record"
^GBDATA(12345,100,3)="C^Record" 
```

其中“12345”是实体键，“100”是附加的详细信息类型之一。请注意，没有其他键的第一个“100”记录具有子记录数。附加的子记录可能介于 0 到数百个之间。实体通常非常宽，并且除了此子记录类型之外还有很多其他数据（示例中未显示）。

给定一个实体键，我想扫描一种类型的所有子记录。使用 $ORDER 遍历子键或使用 FOR 循环来预测键值会更快吗？有关系吗？

$ORDER 方法：

```
SET EKEY=12345
SET SEQ=""

FOR
{
 SET SEQ=$ORDER(^GBDATA(EKEY,100,SEQ), 1, ROWDATA)
 QUIT:SEQ=""

 WRITE ROWDATA,!
} 
```

FOR 计数方法：

```
SET EKEY=12345
SET LIM=^GBDATA(EKEY,100)

FOR SEQ=1:1:LIM
{
 WRITE ^GBDATA(EKEY,100,SEQ),!
} 
```

有谁知道 $ORDER vs $GET 在 Caché 内部是如何实现的？

我无法凭经验对此进行测试，因为我们只有一个具有适当数据的生产实例，并且我无法将其脱机以清除缓存。我最感兴趣的是从磁盘性能而不是从缓存性能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:48:17.650

您可以使用 %SYS.MONLBL 来确定。我的猜测是 $ORDER 稍微好一点。

[http://docs.intersystems.com/cache20122/csp/docbook/DocBook.UI.Page.cls?KEY=GCM_monlbl](http://docs.intersystems.com/cache20122/csp/docbook/DocBook.UI.Page.cls?KEY=GCM_monlbl)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-21T20:05:47.957

关于您的问题，“有人知道 $ORDER 与 $GET 是如何在 Caché 内部实现的吗？” 两者是完全不同的功能。$Order 用于查看您的 ^Global 时的前进方向。$Get 用于拉取 ^Global 中的数据。下面是它的使用示例。我使用缓存 ObjectScript；然而，这应该给你一个大致的想法

**全球结构**

```
^People(LastName,FirstName)="Phone" 
```

**全球数据**

```
^People(Doe,John)="1035001234"
^People(Smith,Jane)="7405241305"
^People(Wood,Edgar)="7555127598" 
```

**代码示例**

```
SET LASTNAME=0
FOR QUIT:LASTNAME?." "  DO
.SET LASTNAME=$ORDER(^People(LASTNAME)) QUIT:LASTNAME?." "
.SET FIRSTNAME=0
.FOR QUIT:FIRSTNAME?." "  DO
..SET FIRSTNAME=$ORDER(^People(LASTNAME,FIRSTNAME)) QUIT:FIRSTNAME?." "
..SET PHONE=$GET(^People(LASTNAME,FIRSTNAME)) 
```

在上面提供的示例中，它将从 ^People 全局中的第一条记录开始，然后使用 $Order 从姓氏中的第一条记录开始。然后它将 $Get ^People(LASTNAME,FIRSTNAME) 节点的数据，即电话号码。

对于一些示例和参考区域，请查看以下链接：

[$获取信息](http://docs.intersystems.com/cache20121/csp/docbook/DocBook.UI.Page.cls?KEY=RCOS_fget#RCOS_B56034)

[$订单信息](http://docs.intersystems.com/cache20121/csp/docbook/DocBook.UI.Page.cls?KEY=RVBS_forder#RVBS_B77485)

# asp.net - ASP.NET Active Directory 成员身份登录问题

> ID：13479674
> 
> 赞同：1
> 
> 时间：2012-11-20T18:25:03.617
> 
> 标签：asp.net, vb.net, active-directory

这是一个非常奇怪的问题。我已经设置了一个 Web 应用程序，它使用 Active Directory 身份验证来对应用程序的用户进行身份验证。它不使用 ASP.NET 成员资格提供程序。它工作得很好——除了一位用户。他们尝试使用他们的 AD 用户名和密码登录（我坐下来看着他们这样做），他们从登录控件中收到以下错误消息：

> 您的登录尝试不成功。请再试一次。

现在，我在其他地方看到此问题可能是由于[在使用 ASP.NET 成员资格提供程序时](http://weblogs.asp.net/scottgu/archive/2006/04/22/443634.aspx)未在 web.config 文件中设置 applicationName而我没有使用 ASP.NET 成员资格提供程序。

他们可以毫无问题地登录所有其他 AD 应用程序。包括通过 PHP 和本机 Windows 登录等集成的，但不集成到此应用程序中的。帮助！

进一步说明：

安全角色（控制权限）被嵌入到应用程序中......因此它根本不使用 AD 权限来确定访问权限，它只是确保用户是可以向 AD 进行身份验证的有效 AD 用户，一旦这样做它使用本地应用程序来确定安全角色并提供有效权限...但是用户在应用程序尝试向 AD 进行身份验证时遇到登录错误...即使他们输入了正确的信息。并且能够访问所有其他 AD 系统（为了安全起见，我们甚至进行了密码重置）。

# java - Java 未定义的泛型类型

> ID：13479676
> 
> 赞同：2
> 
> 时间：2012-11-20T18:25:08.940
> 
> 标签：java, generics, types

我有一个泛型类，它扩展了另一个泛型类。

抽象类有 2 个类型参数，但我的函数中只需要一个。

只是为它分配一个随机的字符串类型是否可以节省，或者这有什么缺点吗？

```
public abstract class AbstractFoo<T, B>
{
   public abstract void read(T item);
}

public class LittleFoo extends AbstractFoo<byte[], String>
{
   @Override
   public void read(byte[] item)
   {
      // work here
   }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T18:43:49.360

或者您可以使用`java.lang.Void`而不是`String`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T18:40:58.667

不，这确实没有任何缺点，在我看来，这似乎是一种简单的方法。

此外，您可能需要考虑使用*composition*而不是*extension*。例如，看一下以下的[`HashSet`实现](http://www.docjar.com/html/api/java/util/HashSet.java.html)：`java.util`

```
87   public class HashSet<E>
88       extends AbstractSet<E>
89       implements Set<E>, Cloneable, java.io.Serializable
90   {
91       static final long serialVersionUID = -5024744406713321676L;
92   
93       private transient HashMap<E,Object> map;
94   
95       // Dummy value to associate with an Object in the backing Map
96       private static final Object PRESENT = new Object(); 
```

A`HashSet`基本上是 a `HashMap`，但只考虑键集（因此虚拟变量`PRESENT`，它只是一个占位符）。你也许可以做类似的事情。

# c# - 使用 C# 解密 WebSocket 客户端通信

> ID：13479677
> 
> 赞同：1
> 
> 时间：2012-11-20T18:25:08.827
> 
> 标签：c#, websocket

我正在尝试为我们工作中的一个新项目演示 Web 套接字通信，并且我一直在尝试修改我很久以前编写的旧 Web 套接字服务器程序。

它进行了正确的握手并可以正确地向客户端发送数据（这是它真正需要做的一切），但是返回的客户端数据是在特殊的 Web 套接字通信协议中，我不太擅长使用二进制文件或十六进制或加密算法。

我从研究中知道，我收到的文本周围包含一个框架，并且它是 sha1 加密的，但我的问题是我不知道如何读取或删除这个框架或解密它。

到目前为止，这是 Web 服务器的完整代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Net.Sockets;
using System.Net;
using System.IO;
using System.Web;
using System.Collections.Specialized;
using System.Text.RegularExpressions;
using System.Threading;
using System.Security.Cryptography;

namespace WebSocks
{
    public class WebSockServer
    {

                /// <summary>
    /// Port number to listen on
    /// </summary>
        private const int PortNumber = 8181;

                /// <summary>
    /// Socket which awaits connections
    /// </summary>
        private Socket ListenerSocket;

                /// <summary>
    /// Thread in which we await for incomming connections.
    /// </summary>
        private System.Threading.Thread _serverThread;

        public delegate void ClientConnectedHandler (Socket Sock);
        public delegate void ReceivedDataHandler(Socket Sock, string Message);
        public event ClientConnectedHandler ClientConnected;
        public event ReceivedDataHandler ReceivedData;

        static WebSockServer() { }

                /// <summary>
    /// Starts thread with listening socket.
    /// </summary>
                            public void Start()
    {
        System.Threading.ThreadStart ts = new System.Threading.ThreadStart(Listen);
        _serverThread = new System.Threading.Thread(ts);
        _serverThread.Start();
    }

                /// <summary>
    /// Stops listening for connections.
    /// </summary>
                        public void End()
    {
        _serverThread.Abort();
        ListenerSocket.Dispose();
    }

                                                                                                                                                                                                                                                                                                                                                                                                                                public void Listen()
    {
        //Start listening
        ListenerSocket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
        EndPoint ep = new IPEndPoint(IPAddress.Parse("0.0.0.0"), PortNumber);
        ListenerSocket.Bind(ep);
        ListenerSocket.Listen(5);

        while (true)
        {
            //New client
            Socket client = ListenerSocket.Accept();
            //Receiving clientHandshake
            string clientHandshake = String.Empty;
            byte[] buffer = null;
            int readBytes = 0;
            do
            {
                buffer = new byte[client.Available];
                readBytes = client.Receive(buffer);
                clientHandshake += Encoding.UTF8.GetString(buffer);
            }
            while (client.Available > 0);

            //Last eight bytes are body of requets (we should include it in response)
            byte[] secKey3 = buffer.Skip(readBytes - 8).Take(8).ToArray();

            //Variables we can extract from clientHandshake
            string clientOrigin = String.Empty;
            string secKey1 = String.Empty;
            string secKey2 = String.Empty;
            string WebSocketVersion = String.Empty;
            int WSV = 0;
            string WebSocketKey = String.Empty;

            //Extracting values from headers (key:value)
            string[] clientHandshakeLines = Regex.Split(clientHandshake, Environment.NewLine);
            foreach (string hline in clientHandshakeLines)
            {
                int valueStartIndex = hline.IndexOf(':') + 2;
                if (valueStartIndex > 0)
                {
                    if (hline.StartsWith("Origin"))
                    {
                        clientOrigin = hline.Substring(valueStartIndex, hline.Length - valueStartIndex);
                    }
                    else if (hline.StartsWith("Sec-WebSocket-Key2"))
                    {
                        secKey2 = hline.Substring(valueStartIndex, hline.Length - valueStartIndex);
                    }
                    else if (hline.StartsWith("Sec-WebSocket-Key1"))
                    {
                        secKey1 = hline.Substring(valueStartIndex, hline.Length - valueStartIndex);
                    }

                    if (hline.StartsWith("Sec-WebSocket-Version"))
                    {
                        WebSocketVersion = hline.Replace("Sec-WebSocket-Version: ", "");
                        WSV = Convert.ToInt32(WebSocketVersion);
                    }

                    if (hline.StartsWith("Sec-WebSocket-Key"))
                    {
                        WebSocketKey = hline.Replace("Sec-WebSocket-Key: ", "");
                    }
                }
            }

            if (!String.IsNullOrEmpty(WebSocketVersion)) //WebSocketVersion 8 and up handshake check
            {
                //New WebSocketVersion number, included after Version 8
                StringBuilder mResponse = new StringBuilder();
                mResponse.AppendLine("HTTP/1.1 101 Switching Protocols");
                mResponse.AppendLine("Upgrade: WebSocket");
                mResponse.AppendLine("Connection: Upgrade");
                mResponse.AppendLine(String.Format("Sec-WebSocket-Accept: {0}", ComputeWebSocketHandshakeSecurityHash09(WebSocketKey)) + Environment.NewLine);

                byte[] HSText = Encoding.UTF8.GetBytes(mResponse.ToString());

                client.Send(HSText, 0, HSText.Length, 0);
            }
            else
            {
                //This part is common for all websockets editions (v. 75 & v.76)
                client.Send(Encoding.UTF8.GetBytes("HTTP/1.1 101 Web Socket Protocol Handshake" + Environment.NewLine));
                client.Send(Encoding.UTF8.GetBytes("Upgrade: WebSocket" + Environment.NewLine));
                client.Send(Encoding.UTF8.GetBytes("Connection: Upgrade" + Environment.NewLine));

                if (String.IsNullOrEmpty(secKey1) && String.IsNullOrEmpty(secKey2))  //75 or less handshake check
                {
                    client.Send(Encoding.UTF8.GetBytes(String.Format("WebSocket-Origin: {0}", clientOrigin) + Environment.NewLine));
                    client.Send(Encoding.UTF8.GetBytes("WebSocket-Location: ws://localhost:8181/websock" + Environment.NewLine));
                    client.Send(Encoding.UTF8.GetBytes(Environment.NewLine));
                }
                else //76 handshake check
                {
                    //Keys present, this means 76 version is used. Writing Sec-* headers 
                    client.Send(Encoding.UTF8.GetBytes(String.Format("Sec-WebSocket-Origin: {0}", clientOrigin) + Environment.NewLine));
                    client.Send(Encoding.UTF8.GetBytes("Sec-WebSocket-Location: ws://localhost:8181/websock" + Environment.NewLine));
                    client.Send(Encoding.UTF8.GetBytes(Environment.NewLine));

                    //Calculating response body
                    byte[] secret = CalculateSecurityBody(secKey1, secKey2, secKey3);
                    client.Send(secret);
                }
            }
            if (ClientConnected != null)
            {
                ClientConnected(client);
            }
            Thread t = new Thread(new ParameterizedThreadStart(WaitForMessages));

            t.Start(client);
        }
    }

                                                                                                                                                                                                                        private static void SendMessage(string Msg, Socket client, int WebSockVersion)
    {
        if (WebSockVersion >= 8)
        {
            bool IsFinal = true;
            int OpCode = 1;
            int? Mask = null;
            byte[] payload = Encoding.UTF8.GetBytes(Msg);
            int PayloadLength = payload.Length;
            byte[] buffer = new byte[64]; // for working out the header

            int offset = 0;
            buffer[offset++] = (byte)((IsFinal ? 128 : 0) | ((int)OpCode & 15));
            if (PayloadLength > ushort.MaxValue)
            { // write as a 64-bit length
                buffer[offset++] = (byte)((Mask.HasValue ? 128 : 0) | 127);
                buffer[offset++] = 0;
                buffer[offset++] = 0;
                buffer[offset++] = 0;
                buffer[offset++] = 0;
                buffer[offset++] = (byte)(PayloadLength >> 24);
                buffer[offset++] = (byte)(PayloadLength >> 16);
                buffer[offset++] = (byte)(PayloadLength >> 8);
                buffer[offset++] = (byte)(PayloadLength);
            }
            else if (PayloadLength > 125)
            { // write as a 16-bit length
                buffer[offset++] = (byte)((Mask.HasValue ? 128 : 0) | 126);
                buffer[offset++] = (byte)(PayloadLength >> 8);
                buffer[offset++] = (byte)(PayloadLength);
            }
            else
            { // write in the header
                buffer[offset++] = (byte)((Mask.HasValue ? 128 : 0) | PayloadLength);
            }
            if (Mask.HasValue)
            {
                int mask = Mask.Value;
                buffer[offset++] = (byte)(mask >> 24);
                buffer[offset++] = (byte)(mask >> 16);
                buffer[offset++] = (byte)(mask >> 8);
                buffer[offset++] = (byte)(mask);
            }
            // you might want to manually combine these into 1 packet
            client.Send(buffer, 0, offset, SocketFlags.None);
            client.Send(payload, 0, payload.Length, SocketFlags.None);

        }
        else
        {
            client.Send(new byte[] { 0x00 });
            client.Send(Encoding.UTF8.GetBytes(Msg));
            client.Send(new byte[] { 0xFF });
        }
    }

                                            private void WaitForMessages(object client)
    {
        Socket sock = (Socket)client;
        byte[] buffer = new byte[1024];

        while (true)
        {
            sock.Receive(buffer);

            ReceivedData(sock, Encoding.UTF8.GetString(buffer));
        }
    }

                                                                                                                public byte[] CalculateSecurityBody(string secKey1, string secKey2, byte[] secKey3)
    {
        //Remove all symbols that are not numbers
        string k1 = Regex.Replace(secKey1, "[^0-9]", String.Empty);
        string k2 = Regex.Replace(secKey2, "[^0-9]", String.Empty);

        //Convert received string to 64 bit integer.
        Int64 intK1 = Int64.Parse(k1);
        Int64 intK2 = Int64.Parse(k2);

        //Dividing on number of spaces
        int k1Spaces = secKey1.Count(c => c == ' ');
        int k2Spaces = secKey2.Count(c => c == ' ');
        int k1FinalNum = (int)(intK1 / k1Spaces);
        int k2FinalNum = (int)(intK2 / k2Spaces);

        //Getting byte parts
        byte[] b1 = BitConverter.GetBytes(k1FinalNum).Reverse().ToArray();
        byte[] b2 = BitConverter.GetBytes(k2FinalNum).Reverse().ToArray();
        //byte[] b3 = Encoding.UTF8.GetBytes(secKey3);
        byte[] b3 = secKey3;

        //Concatenating everything into 1 byte array for hashing.
        List<byte> bChallenge = new List<byte>();
        bChallenge.AddRange(b1);
        bChallenge.AddRange(b2);
        bChallenge.AddRange(b3);

        //Hash and return
        byte[] hash = MD5.Create().ComputeHash(bChallenge.ToArray());
        return hash;
    }

                                                        public String ComputeWebSocketHandshakeSecurityHash09(String secWebSocketKey)
    {
        const String MagicKEY = "258EAFA5-E914-47DA-95CA-C5AB0DC85B11";
        String secWebSocketAccept = String.Empty;
        // 1\. Combine the request Sec-WebSocket-Key with magic key.             
        String ret = secWebSocketKey + MagicKEY;
        // 2\. Compute the SHA1 hash             
        SHA1 sha = new SHA1CryptoServiceProvider();
        byte[] sha1Hash = sha.ComputeHash(Encoding.UTF8.GetBytes(ret));
        // 3\. Base64 encode the hash             
        secWebSocketAccept = Convert.ToBase64String(sha1Hash);
        return secWebSocketAccept;
    }

    }
} 
```

我知道它非常粗糙，它不会自行清理，也不会正确分离不同的连接并将它们保存在列表或任何东西中，这纯粹是为了演示项目。

所以我需要帮助的主要部分是 WaitForMessages 函数：

```
 private void WaitForMessages(object client)
    {
        Socket sock = (Socket)client;
        byte[] buffer = new byte[1024];

        while (true)
        {
            sock.Receive(buffer);

            //Remove Frame and decrypt here

            ReceivedData(sock, Encoding.UTF8.GetString(buffer));
        }
    } 
```

我真的只是想在这里放一些可以工作的代码，如果您指出“演示有点像您的代码，并且您应该能够从中弄清楚”，我真的不会理解它，我几乎可以向你保证。我是一名应用程序开发人员，而不是 API 开发人员，我只是不想等到 Microsoft 最终开始将 API 写入 .NET 6.0 或其他用于此功能的东西。

# c - 无法加载共享库：未定义的符号

> ID：13479679
> 
> 赞同：1
> 
> 时间：2012-11-20T18:25:14.227
> 
> 标签：c, linux, opencv, dynamic-linking, undefined-symbol

我在 linux (ubuntu) 系统上有自己的带有插件（动态共享库）的程序。我的库（插件）使用 OpenCV（可能不那么重要）。

我的插件位于 /usr/local/lib/mysoft/。

即使使用库，我也成功编译了我的程序，成功安装，所以到目前为止一切似乎都很好。

当我运行我的程序时，它会根据一些配置文件加载一堆这些库。我有几个已成功加载的库，但我无法加载一个库。加载时出现错误（使用 dlopen() 打开库）：

```
/usr/local/lib/mysoft/libMyPlugin2.so: undefined symbol: _ZN2cv6resizeERKNS_11_InputArrayERKNS_12_OutputArrayENS_5Size_IiEEddi
Segmentation fault (core dumped)
Tue Nov 20 19:11:29 CET 2012 
```

显然，要找到作为 OpenCV 一部分的 cv::resize 存在一些问题，但我不明白为什么。

我检查了以下内容：

*   OpenCV 可能已正确安装，因为其他库也使用它并且加载时没有问题
*   我的程序没有依赖项，libMyPlugin2.so 或 OpenCV 丢失（用 ldd 检查）
*   所有库和二进制文件的架构似乎都是相同的（我用 objdump -f 检查了它）

有人知道我在做什么错吗？

这篇文章似乎很相关，但仍然没有帮助： [Linux shared library that uses a shared library undefined symbol](https://stackoverflow.com/questions/2991572/linux-shared-library-that-uses-a-shared-library-undefined-symbol)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T18:15:30.620

嗯，我找到了问题，希望它可以帮助其他人......

问题 - 编译时我缺少一个 OpenCV 库。所以我用“opencv_core opencv_imgproc opencv_highgui”替换了“opencv_core opencv_highgui”，一切正常。

因此，尽管我能够编译它，但缺少一个依赖项 - 我猜 OpenCV 中发生了一些变化，因为这些源代码与旧版本的 OpenCV 完美配合（即使是构建）。

# android - 是否可以通过代码控制键盘类型？（安卓）

> ID：13479682
> 
> 赞同：0
> 
> 时间：2012-11-20T18:25:24.193
> 
> 标签：android

是否可以通过 java android 代码控制键盘类型？

例如：如果 flag=1 并且焦点在 TextView 上，则键盘将是数字

如果 flag=0，键盘将是字母数字

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:27:25.513

[您可以通过TextView.setInputType](http://developer.android.com/reference/android/widget/TextView.html#setInputType%28int%29)方法以编程方式设置输入类型

例如，对于数字输入：

```
textView.setInputType(InputType.TYPE_CLASS_NUMBER) 
```

或者：

```
textView.setInputType(InputType.TYPE_CLASS_TEXT) 
```

用于标准文本输入

# c# - 从 WinJS 调用已等待的 C# 方法

> ID：13479685
> 
> 赞同：1
> 
> 时间：2012-11-20T18:25:38.733
> 
> 标签：c#, windows-8, microsoft-metro, winjs

我在 C# 类中有一个异步方法

```
namespace ImageHolder
{
    public sealed class BlankFilter
    public async Task<InMemoryRandomAccessStream> applyFilter()
    {
        inputStream = await file.OpenAsync(Windows.Storage.FileAccessMode.ReadWrite);
        decoder = await Windows.Graphics.Imaging.BitmapDecoder.CreateAsync(inputStream);

        /* more code */
    }
} 
```

我通过以下方式从 WinJS 类调用此函数

```
filter.applyFilter().then(function (memStream) {
            var msStream = MSApp.createStreamFromInputStream("image/jpeg", memStream);
            var imageURL = URL.createObjectURL(msSteam);
            id("imageInput").src = imageURL;

        }); 
```

但是，这不起作用，Visual Studio 抱怨返回类型应更改为 IAsyncAction。这样做也无济于事。

那么，从 WinJS 代码调用具有 await 的 C# 函数的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:29:40.143

WinJS 不能调用返回的方法`Task<T>`——这是你用 async/await 方法得到的。正如错误所说，您需要将返回类型（或创建一个新的包装方法）更改为`IAsyncOperation<T>`. 从`Task<T>`to转换`IAsyncOperation<T>`很简单（`AsAsyncOperation`在结果任务上调用）。

此[博客文章](http://blogs.msdn.com/b/windowsappdev/archive/2012/06/14/exposing-net-tasks-as-winrt-asynchronous-operations.aspx)包含有关此问题的更多信息。

# javascript - 在 MVC 3 视图中调试 javascript

> ID：13479689
> 
> 赞同：3
> 
> 时间：2012-11-20T18:25:49.600
> 
> 标签：javascript, jquery, asp.net-mvc

我们可以在 asp.net MVC 3 视图中的 javascript(jquery) 代码中设置断点吗？我想调试它，因为我必须这样做。

我在 IE 9 中使用了 F12 但没有任何线索。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:27:31.100

Visual Studio 不能很好地处理 javascript 调试，IE 也不能。

尝试在 FireBug 中使用 Firefox 的脚本选项卡，您可以在那里设置断点，然后刷新或重新加载页面以命中断点。它允许逐步执行。

或者在 chrome 中，尝试转到源，然后使用选项卡左上角的小图标，选择要调试的脚本。单击其中一个行号将为该项目设置断点。您会注意到，在执行此操作后单击刷新时，有几个选项。任何都可以，但正常刷新可以达到断点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:29:31.560

您可以使用浏览器的开发者工具.... 只需按 F12 (chrome, ie)

必须在 js 源代码上设置断点...并使用您的页面。

我用 chrome... [Chrome 开发者工具教程](https://developers.google.com/chrome-developer-tools/)

# python - Python插值错误

> ID：13479690
> 
> 赞同：2
> 
> 时间：2012-11-20T18:25:52.367
> 
> 标签：python, interpolation

我正在尝试使用 python 中的插值方法（不是内置方法）来获取给定间隔的函数的根。

我已经完成了以下操作并且不知道我哪里出错了，我已经通过二分法完成了它，尽管唯一的区别是测试点。

x1 和 x2 是区间的两端，f 是函数，epsilon 是公差

```
def interpolation (x1,x2,f,epsilon):
 i = 1
 n = 100
 while i<n:
    m =  (f(x2)- f(x1))/(x2-x1)
    b = f(x2) - m*(x2) 
    p = b
    print (i,p,f(p))
    if f(p) == 0 or b< epsilon:
        print ('The root is at ',p,'after',i,'iterations')
        break
    i+= 1
    if f(x1)*f(p) > 0:           #Equal signs
        x1 = p
    else:
        x2 = p 
```

使用 f = sin(x^2) 运行它只会返回 100 次振荡迭代，如下所示：

# 代码

```
 (80, 1.3266674970489443, 0.98214554271216425)
  (81, 1.4900968376899661, 0.79633049173817871)
  (82, 1.3266674970489443, 0.98214554271216425)
  (83, 1.4900968376899661, 0.79633049173817871) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:17:13.930

看起来您正在尝试使用割线方法解决此问题。插值法需要三个初始值。

我不太确定您使用代码的方向，但我可以对其进行一些调整，如下所示：

```
i = 1
n = 100
while i<n:
    print x1, x2
    m =  (f(x2)- f(x1))/(x2-x1)
    b = f(x2) - m*(x2) 
    p = -b/m #root for this line

    # are we close enough?
    if abs(f(p)) < epsilon:
        print ('The root is at ',p,'after',i,'iterations')
        break
    i+= 1

    x1 = x2
    x2 = p 
```

根据我的起始位置 1,2，它在 4 次迭代中解决了它：

```
1 2
2 1.52648748495
1.52648748495 1.75820676726
1.75820676726 1.7754676477
('The root is at ', 1.7724406948343991, 'after', 4, 'iterations') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:44:14.150

如果您真正想要的是解决问题（而不是开发练习解决方案），我建议您使用现成的模块。

我的第一选择是`scipy.optimize.bisect()`（[文档](http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.bisect.html#scipy.optimize.bisect)）

该模块也有其他方法，例如 Newton-Raphson 等。

# php - PHP Spintax 处理器

> ID：13479696
> 
> 赞同：6
> 
> 时间：2012-11-20T18:26:16.190
> 
> 标签：php, regex, string, spintax

我一直在使用 recurisve SpinTax 处理器，如此处所示[，](http://www.codedevelopr.com/articles/php-spintax-function/)它适用于较小的字符串。但是，当字符串超过 20KB 时，它开始耗尽内存，这成为一个问题。

如果我有这样的字符串：

```
{Hello|Howdy|Hola} to you, {Mr.|Mrs.|Ms.} {Smith|Williams|Austin}! 
```

而且我想将单词的随机组合放在一起，而**不是**使用上面链接中看到的技术（通过字符串递归直到大括号中没有更多单词），我该怎么做？

我在想这样的事情：

```
$array = explode(' ', $string);
foreach ($array as $k=>$v) {
        if ($v[0] == '{') {
                $n_array = explode('|', $v);
                $array[$k] = str_replace(array('{', '}'), '', $n_array[array_rand($n_array)]);
        }
}
echo implode(' ', $array); 
```

但是，当 spintax 的选项之间有空格时，它就会分崩离析。`RegEx`似乎是这里的解决方案，但我不知道如何实现它**并**具有更高效的性能。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T18:36:48.520

您可以创建一个函数，该函数在其中使用回调来确定将创建和返回许多潜力的哪个变体：

```
// Pass in the string you'd for which you'd like a random output
function random ($str) {
    // Returns random values found between { this | and }
    return preg_replace_callback("/{(.*?)}/", function ($match) {
        // Splits 'foo|bar' strings into an array
        $words = explode("|", $match[1]);
        // Grabs a random array entry and returns it
        return $words[array_rand($words)];
    // The input string, which you provide when calling this func
    }, $str);
}

random("{Hello|Howdy|Hola} to you, {Mr.|Mrs.|Ms.} {Smith|Williams|Austin}!");
random("{This|That} is so {awesome|crazy|stupid}!");
random("{StackOverflow|StackExchange} solves all of my {problems|issues}."); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T18:43:01.060

您可以使用`preg_replace_callback()`来指定替换功能。

```
$str = "{Hello|Howdy|Hola} to you, {Mr.|Mrs.|Ms.} {Smith|Williams|Austin}!";

$replacement = function ($matches) {
    $array = explode("|", $matches[1]);
    return $array[array_rand($array)];
};

$str = preg_replace_callback("/\{([^}]+)\}/", $replacement, $str);
var_dump($str); 
```

# android - 将搜索功能添加到 android 中的 ListView

> ID：13479698
> 
> 赞同：0
> 
> 时间：2012-11-20T18:26:24.627
> 
> 标签：android, listview, filter, simpleadapter, searchbar

我想将搜索功能添加到我的 listView 。我想按歌名搜索。但我没有办法包含这个功能。

这是我的代码：

```
ArrayList<HashMap<String, String>> songsListData = new ArrayList<HashMap<String, String>>();
        Cursor cursor = managedQuery(MediaStore.Audio.Media.EXTERNAL_CONTENT_URI,null , null, null, null);          
          if (cursor == null) 
          {
              //Query Failed , Handle error.
          }
          else if (!cursor.moveToFirst()) 
          {
             //No media on the device.
          }
          else
          {

              int titleColumn = cursor.getColumnIndex(android.provider.MediaStore.Audio.Media.TITLE);
              int idColumn = cursor.getColumnIndexOrThrow(android.provider.MediaStore.Audio.Media.DATA);
              int artistcolumn = cursor.getColumnIndex(android.provider.MediaStore.Audio.Media.ARTIST);
              int durationcolumn =cursor.getColumnIndex(android.provider.MediaStore.Audio.Media.DURATION);

              for(int i=0;i<cursor.getCount();i++)
              {
                    String thisTitle = cursor.getString(titleColumn);
                    String path = cursor.getString(idColumn);
                    String artist = cursor.getString(artistcolumn);
                    Long duration = cursor.getLong(durationcolumn);
                    Utilities objUtilities = new Utilities();
                    String timeDuration = objUtilities.milliSecondsToTimer(duration);

                   HashMap<String, String> song = new HashMap<String, String>();
                   song.put("songTitle",thisTitle);
                   song.put("songPath", path);
                   song.put("artist", artist);
                   song.put("duration",timeDuration);

                   // Adding each song to SongList
                   songsList.add(song);
                   cursor.moveToNext();
              }
          }

        // looping through playlist
        for (int i = 0; i < songsList.size(); i++) {
            // creating new HashMap
            HashMap<String, String> song = songsList.get(i);

            // adding HashList to ArrayList
            songsListData.add(song);
        }

        // Adding menuItems to ListView
        String[] from = {"songTitle", "artist" , "duration"};
            int[] to={R.id.songTitle,R.id.songArtist, R.id.duration};
         adapter = new SimpleAdapter(this, songsListData,
                R.layout.playlist_item, from, to);

        setListAdapter(adapter); 
```

我没有得到如何过滤我的列表视图的解决方案。

然后我还添加了以下代码：

```
inputSearch = (EditText) findViewById(R.id.inputSearch);
        inputSearch.addTextChangedListener(new TextWatcher() {

            public void onTextChanged(CharSequence cs, int arg1, int arg2, int arg3) {
                // When user changed the Text
                ((SimpleAdapter) PlayListActivity.this.adapter).getFilter().filter(cs); 
            }

            public void beforeTextChanged(CharSequence arg0, int arg1, int arg2,
                    int arg3) {
                // TODO Auto-generated method stub

            }

            public void afterTextChanged(Editable arg0) {
                // TODO Auto-generated method stub                          
            }
        }); 
```

但我无法为我的这个列表视图找到 filterng 代码。任何人都可以帮我找到解决方案吗？提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:03:06.757

我测试了这个示例代码，它似乎工作。也许它会帮助你解决你的问题：

```
public class TestActivity extends ListActivity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    EditText inputSearch = new EditText(this);
    inputSearch.addTextChangedListener(new TextWatcher() {

        public void onTextChanged(CharSequence cs, int arg1, int arg2, int arg3) {
            // When user changed the Text
            ((SimpleAdapter)getListAdapter()).getFilter().filter(cs); 
        }

        public void beforeTextChanged(CharSequence arg0, int arg1, int arg2,
                int arg3) {
            // TODO Auto-generated method stub

        }

        public void afterTextChanged(Editable arg0) {
            // TODO Auto-generated method stub                          
        }
    });     
    getListView().addHeaderView(inputSearch);

    ArrayList<HashMap<String, String>> songsListData = new ArrayList<HashMap<String, String>>();

    {
        HashMap<String, String> song = new HashMap<String, String>();
        song.put("songTitle", "We are made of stars");
        song.put("artist", "Moby");
        songsListData.add(song);
    }
    {
        HashMap<String, String> song = new HashMap<String, String>();
        song.put("songTitle", "Californication");
        song.put("artist", "Red hot chili peppers");
        songsListData.add(song);
    }

    // Adding menuItems to ListView
    String[] from = { "songTitle", "artist" };
    int[] to = { R.id.songTitle, R.id.songArtist };
    SimpleAdapter adapter = new SimpleAdapter(this, songsListData, R.layout.playlist_item, from, to);

    setListAdapter(adapter);
}
} 
```

使用以下 playlist_item.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/songTitle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />

    <TextView
        android:id="@+id/songArtist"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textSize="10sp" />

    <TextView
        android:id="@+id/duration"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textSize="10sp" />

</LinearLayout> 
```

# ios - viewcontrller 中的应用程序委托功能 - Facebook

> ID：13479699
> 
> 赞同：0
> 
> 时间：2012-11-20T18:26:24.200
> 
> 标签：ios, xcode, facebook

我有一个带有标头和实现文件以及两个 appDelegate 文件的示例代码。我想将项目的功能添加到我的应用程序中。前两个文件是一个ViewController文件，所以我只要把它拖进去，但是另外两个是AppDelegate，我显然不能有两个app delegate。但是在这个示例应用程序的情况下，应用程序委托被用作适当的视图控制器，因为在 UIViewController 文件的 .m 文件中，有以下代码：

```
AppDelegate *appDelegate = [[UIApplication sharedApplication] delegate]; 
```

由于 AppDelegate 没有实现 applicationWillBecomeActive: 等方法，如何将文件转换为 UIViewController 文件？我需要在上面的代码中更改什么来调用控制器而不是委托（我的 AppDelegate 将保持不变）。

代码在[GitHub 上](https://github.com/fbsamples/ios-3.1-howtos/tree/master/SendRequestsHowTo)

这就是我所做的（代码需要包含 Facebook API）。转到下载选项卡并下载 Archive.zip 和[AppDelegate.zip：https://github.com/Alexmitico45/FacebookRequests/downloads](https://github.com/Alexmitico45/FacebookRequests/downloads)

基本上控制器 ContactFBSViewController 链接到情节提要中的视图控制器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:43:26.133

AppDelegate 是实现协议 UIApplicationDelegate 的单例，因为不能复制它，它必须是唯一的。您可以创建自己的单例来存储整个应用程序中可用的信息。你可以谷歌“objective-c singleton”并获得一些很好的链接来做到这一点

# java - 提供 equals() 的替代方法？

> ID：13479702
> 
> 赞同：2
> 
> 时间：2012-11-20T18:26:40.227
> 
> 标签：java

假设我有一个名为 的类`Number`，我打算对对象进行大量的相等比较`Number`。我担心泛型`Number::equals(Object o)`方法的“开销”（类比较等）。`Number::isEqualTo(Number other)`在这种情况下，提供一种方法是否有用，例如`Number::equals(Object o)`? 这是一种常见的模式吗？或者 JVM 当前是否优化得足够好以至于这样做没有优势？

这是一个代码示例：

```
public class Number {
    int _value;

    Number(int value) {
        _value = value;
    }

    @Override
    public boolean equals(final Object o) {
        if (o == this) return true;
        if (o == null) return false;
        if (o.getClass() != getClass()) return false;
        return isEqualTo((Number)o);
    }

    public boolean isEqualTo(final Number other) {
        return _value == other._value;
    }

    public static void main(String[] args) {
        Number one = new Number(1);
        Number two = new Number(2);
        if (!one.isEqualTo(two)) {
            System.out.println("fast comparison?");
        }
        if (!one.equals(two)) {
            System.out.println("slow comparison?");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T18:38:04.823

这两种方法有不同的语义：

*   `equals``Object::equals`具有合同规定的语义，而
*   `isEqualTo`具有仅适用于`Number`对象的语义

由于比较不是苹果对苹果，因此`equals`需要更多 CPU 周期是公平的。但是，您不太可能注意到差异。

像您这样的类实现[`Comparable<T>`](http://docs.oracle.com/javase/6/docs/api/java/lang/Comparable.html). 那里的语义要求进行排序检查，而不仅仅是相等性检查，而且不需要获取未知类的对象，从而可以节省 CPU 周期。

您应该有充分的理由提供平等的替代方案（例如，分析器运行指出`equals(Object)`瓶颈，由于更改而对可读性的感知改进，或者由于采用更多功能的接口而实现更丰富的语义）。这样做是为了减少几个 CPU 周期会过早优化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T18:37:28.750

具有最不利场景（`equals`总是调用`isEqualTo`）的快速微基准显示（以毫秒为单位）：

> 等于：1014
> isEqualTo：1010

底线：除非您的程序不做任何其他事情，否则这不会成为性能瓶颈，您应该坚持优化的第一原则：首先配置文件，然后优化需要优化的内容。

测试代码：

```
public class TestPerf {

    private static int NUM_RUN;
    private static List<Number> list = new ArrayList<>();

    public static void main(String[] args) {
        NUM_RUN = 100_000;

        for (int i = 0; i < 10000; i++) {
            list.add(new Number(i));
        }

        long sum = 0;
        System.out.println("Warmup");

        for (int i = 0; i < NUM_RUN; i++) {
            sum += method1(17);
            sum += method2(17);
        }

        System.gc();

        System.out.println("Starting");

        sum = 0;
        long start = System.nanoTime();
        for (int i = 0; i < NUM_RUN; i++) {
            sum += method1(17);
        }
        long end = System.nanoTime();
        System.out.println("equals: " + (end - start) / 1000000);

        System.gc();

        start = System.nanoTime();
        for (int i = 0; i < NUM_RUN; i++) {
            sum += method2(17);
        }
        end = System.nanoTime();
        System.out.println("isEqualTo: " + (end - start) / 1000000);

        System.out.println(sum);
    }

    private static int method1(int target) {
        int sum = 0;
        Number comparison = new Number(target);
        for (Number n : list) {
            if (n.equals(comparison)) sum++;
        }
        return sum;
    }

    private static int method2(int target) {
        int sum = 0;
        Number comparison = new Number(target);
        for (Number n : list) {
            if (n.isEqualTo(comparison)) sum++;
        }
        return sum;
    }

    public static class Number {

        int _value;

        Number(int value) {
            _value = value;
        }

        @Override
        public boolean equals(final Object o) {
            if (o == this) return true;
            if (o == null) return false;
            if (o.getClass() != getClass()) return false;
            return isEqualTo((Number) o);
        }

        public boolean isEqualTo(final Number other) {
            return _value == other._value;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T18:30:57.923

这取决于您想在哪里使用比较方法。

也许您可以使用 Comparator 接口的不同实现？

这些可以用于例如。排序列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T18:32:27.327

您甚至可以提供`equals`自身的重载：`equals(Number)`. 如果您**非常仔细地**实现它（在行为上与 没有区别`equals(Object)`），您可以通过在某些情况下避免检查向下转换来实现微不足道的加速。请注意，您仍然需要检查`a.getClass() == b.getClass()`，因此差异非常小。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T18:33:58.643

`xx.isEqualTo.yy`是“对象”级别的比较。它只是检查这两个对象是否引用同一个对象。

为特定类编写“方程式方法”总是更好。例如，在这种情况下，最佳比较很简单`==`。

# mysql - 如何计算具有相似值的字段数

> ID：13479703
> 
> 赞同：-1
> 
> 时间：2012-11-20T18:26:40.510
> 
> 标签：mysql

我在数据库中有很多重复自己的单词，..我需要知道每个单词重复了多少..我尝试了不同的查询..

```
 SELECT word_name,SUM(`word_name`) AS word_count
FROM `words` 
WHERE `search_id`=5 
GROUP BY word_count 
```

但它不起作用..它给了我：#1056 - 不能在 'word_count' 上分组

好的，我找到了一个方法：

```
 SELECT word_name,COUNT(`tweet_id`) AS word_count
FROM `words` 
WHERE `search_id`=5 
GROUP BY word_name 
```

大声笑..现在需要订购整个东西..最好的方法是什么..是放入子查询吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:28:27.043

你想要`count()`相似的数量`word_name`：

```
SELECT count(`word_name`) AS word_count, `word_name` 
FROM `words` 
WHERE `search_id`=5 
GROUP BY `word_name`
ORDER BY word_count 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/f8130/2)

我会添加`word_name` 到最终结果中，以便您知道每个单词与哪个计数相关联

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:29:00.333

而不是`SUM()`尝试`COUNT()`。

`GROUP BY word_name`之前还要加`ORDER BY`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:29:12.453

尝试这个：-

```
 SELECT count(`word_name`) AS word_count, `word_name` 
FROM `words` 
WHERE `search_id`=5 
GROUP BY `word_name`
 ORDER BY word_count 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T18:30:24.403

尝试

```
SELECT word_name,count(`word_name`) AS word_count
FROM `words` 
WHERE `search_id`=5 
GROUP BY count(`word_name`) 
```

您不能在 GROUP BY 或 WHERE 子句中使用别名，除非它们在 SUB-QUERY 中

# c++ - 在从该位置的文件中找到一行之后复制，直到 C++ 中该文件的末尾

> ID：13479705
> 
> 赞同：-4
> 
> 时间：2012-11-20T18:26:43.427
> 
> 标签：c++, string, file, copy

我有一个文件，其中包含蛋白质坐标以及它之前的其他信息。我的目标是查找名为“$PARAMETERS”的特定行，然后从那里复制它之后的每一行，直到文件末尾。

我怎样才能做到这一点？这是我编写的整个程序的一部分的小代码（几年前别人写的，我接手升级他的代码以进行研究）：

```
ifstream InFile;
InFile.open (DC_InFile.c_str(), ios::in);

while ( not InFile.eof() )
{
    Line = NextLine (&InFile);

    if (Line.find ("#") == 0) continue;   // skip lines starting with # (comments)
    if (Line.length()   == 0) continue;   // skip empty lines
    size_t pos = Line.find("$PARAMETERS");
    Line.copy(Line.begin("$PARAMETERS")+pos, Line.end("$END"));
    &Line.copy >> x_1 >> y_2 >> z_3;

} 
```

请记住，我将 Line 定义为`string`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:39:45.053

我不确定你在复制文件的第一行想要什么，但假设你明白这一点并且你没有阅读超出当前行的内容，你可以复制你正在阅读的 fike 的尾部，如下所示：

```
out << InFile.rdbuf(); 
```

这`out`是`std::ostream`您要将数据发送到的地方。

请注意，您不应该**使用**来`InFile.eof()`确定是否有更多数据！相反，您应该阅读您想阅读的内容，*然后*检查阅读是否成功。您需要在阅读后进行检查，因为在您这样做之前，流无法知道您要阅读的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:49:49.167

跟进 Dietmar 的回答：在我看来，您应该一直使用它，`std::getline`直到找到与您的模式相匹配的线条。如果您希望该行作为输出的一部分，则输出它，然后使用 Dietmar 的解决方案复制文件的其余部分。就像是：

```
while ( std::getline( in, line ) && ! isStartLine( line ) ) {
}
if ( in ) {         //  Since you might not have found the line
    out << line << '\n';    //  If you want the matching line
                            //  You can also edit it here.
    out << in.rdbuf();
} 
```

并且不要将各种复杂的解析信息与`continue`and`break`放在循环中。结果既不可读也不可维护。把它分解成一个简单的函数，如上所述：你也有更好的机会把它弄好。（在你的情况下，你应该匹配`"$PARAMETERS # xxx"`还是不匹配？）在一个单独的函数中，更容易让它正确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:28:37.893

我想您需要在 and 之间读取数据，`$PARAMETERS`而`$END`不是从`$PARAMETERS`文件末尾读取数据。如果是这样，您可以使用以下代码：

```
string str;
while (getline(InFile, str))
{
    if (str.find("#") == 0)
        continue;
    if (str.length() == 0)
        continue;
    if (str.find("$PARAMETERS") == 0)
    {
        double x_1, y_2, z_3; // you want to read numbers, i guess
        while (getline(InFile, str))
        {
            if (str.find("$END") == 0)
                break;
            stringstream stream(str);
            if (stream >> x_1 >> y_2 >> z_3)
            {
                // Do whatever you want with x_1, y_2 and z_3
            }
        }
    }
} 
```

这将处理多个数据部分；不确定您是否真的想要这种行为。

例如：

```
# comment
$PARAMETERS
1 2 3
4 5 6
$END
#unrelated data
100 200 300
$PARAMETERS
7 8 9
10 11 12
$END 
```

# python - TypeError：“模块”对象不可调用 API

> ID：13479709
> 
> 赞同：1
> 
> 时间：2012-11-20T18:26:55.170
> 
> 标签：python

> **可能重复：**
> [无法实例化子目录中定义的类](https://stackoverflow.com/questions/13389687/unable-to-instantiate-a-class-defined-in-a-subdirectory)

我有：

测试.py

```
#!/usr/bin/python
# -*- coding: utf-8 -*-

import WykopLinks 
import WykopAPI

API = WykopAPI.WykopAPI('apikey')
Links = WykopLinks.WykopLinks(API)
List =  Links.getPromoted(); 
for Znalezisko in List:
print Znalezisko.id 
print Znalezisko.title 
```

我试图更改`import`其他`from WykopLinks import WykopLinks`名称或更改名称，但这没有帮助。

我也在尝试`other-name-formodule.WykopLinks(API)`

错误：

```
Links = WykopLinks(API)
TypeError: 'module' object is not callable 
```

我检查了这里描述的其他问题，但没有一个有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:28:56.837

这段代码

```
Links = WykopLinks(API)
TypeError: 'module' object is not callable 
```

正如错误消息所描述的那样失败：`WykopLinks`是一个模块并且不可调用。

大概你应该调用`WykopLinks`模块中定义的一些函数或类。但是由于我找不到该模块的任何文档，并且由于您没有提供任何信息，因此我无法告诉您代码应该是什么样子。

# validation - 如何防止用户在 Salesforce.com 中编辑 OpportunityLineItem 记录？

> ID：13479711
> 
> 赞同：0
> 
> 时间：2012-11-20T18:27:14.267
> 
> 标签：validation, salesforce

我需要一个验证规则来阻止某些用户编辑 OpportunityLineItem 记录。

我假设我需要比较 LastModifiedDate 值。

任何帮助是极大的赞赏。

干杯! 星期五

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T07:49:50.707

您可能想查看以美元符号开头的公式中可用的特殊字段。粗略地说，它们取决于谁在查看数据，与记录本身无关。它们包含基本的运行用户信息、他的会话 ID 等。

示例验证规则可能如下所示：

```
OR($Profile.Name = 'Marketing User',
$UserRole.Name = 'IT',
$User.Title = 'Contractor'
) 
```

如果您可以通过角色、个人资料或例如您在用户记录上放置的仅可由系统管理员编辑的复选框轻松区分您的“某些用户”，这应该可以帮助您入门。

如果您的逻辑更复杂（例如，取决于成为某个组的成员） - 我相信您必须编写一个触发器。

* * *

请记住，验证规则不会在记录删除时触发！如果这是一个问题，有两种方法可以解决它：

*   理智的方法：从大多数配置文件中删除删除机会的权利（因为 Opp. 产品从机会“继承”此权限），然后将其应用于具有权限集的选定用户
*   hacky 方式：删除产品会导致 Opportunity 上的一些汇总重新计算（例如 Amount 字段）。所以建立一个与你在 Opp 上的规则类似的规则。行项目并附`&& ISCHANGED(Amount)`加到它。

# c# - C# Expect100Continue 头请求

> ID：13479712
> 
> 赞同：0
> 
> 时间：2012-11-20T18:27:14.980
> 
> 标签：c#, http, httpwebrequest, webclient, httpcookie

我正面临使用不同域发布用户名和密码的问题 - 一个成功提交表单，而另一个没有（表单数据为空）！两个域上的 html 代码是相同的。这是示例代码 - 评论域不发布：非常感谢任何帮助！

注意：在 nginx 上运行的域成功发布数据，而 apache 上的另一个域则没有，如果它与服务器有关

```
 public class CookieAwareWebClient : System.Net.WebClient
{
    private System.Net.CookieContainer Cookies = new System.Net.CookieContainer();

    protected override System.Net.WebRequest GetWebRequest(Uri address)
    {
        System.Net.WebRequest request = base.GetWebRequest(address);
        if (request is System.Net.HttpWebRequest)
        {
            var hwr = request as System.Net.HttpWebRequest;
            hwr.CookieContainer = Cookies;
        }
        return request;
    }
}

# Main function
NameValueCollection postData = new NameValueCollection();
postData.Add("username", "abcd");
postData.Add("password", "efgh");

var wc = new CookieAwareWebClient();
//string url = "https://abcd.example.com/service/login/";
string url = "https://efgh.example.com/service/login/";

wc.DownloadString(url);

//writer.WriteLine(wc.ResponseHeaders);
Console.WriteLine(wc.ResponseHeaders);

byte[] results = wc.UploadValues(url, postData);
string text = System.Text.Encoding.ASCII.GetString(results);

Console.WriteLine(text); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T19:23:23.267

问题在于每次通过程序发出请求时都会自动添加 Expect100Continue 标头，而该程序在 Apache 上处理得不好。每次通过以下方式发出请求时，您必须将 Expect100Continue 设置为 false。感谢 Fiddler 的领导，尽管我可以通过 Amazon EC2 实例上的 dumpcap 工具看到它！这是解决方案！

```
# Main function
NameValueCollection postData = new NameValueCollection();  
postData.Add("username", "abcd");
postData.Add("password", "efgh");

var wc = new CookieAwareWebClient();
var uri = new Uri("https://abcd.example.com/service/login/");
var servicePoint = ServicePointManager.FindServicePoint(uri);
servicePoint.Expect100Continue = false;

wc.DownloadString(uri);

Console.WriteLine(wc.ResponseHeaders);

byte[] results = wc.UploadValues(uri, postData);
string text = System.Text.Encoding.ASCII.GetString(results);
Console.WriteLine(text); 
```

# javascript - 如果使用相同的数据，在 JavaScript 中声明多个变量？

> ID：13479719
> 
> 赞同：0
> 
> 时间：2012-11-20T18:27:38.400
> 
> 标签：javascript, jquery

我看过诸如[在 JavaScript](https://stackoverflow.com/questions/694102/declaring-multiple-variables-in-javascript)中声明多个变量之类的帖子，这些帖子专注于唯一变量（以及很多变量），但我正在研究许多非唯一变量，例如我想做一个更大的版本......

```
 var rep;
            var state_def, state_MA, state_WY, state_TN = 'joeblow';
            var state_AZ, state_TX = 'moefoe';
            var state_MT, state_OR = 'growmo';
            var state_OK, state_LA = 'billyjoe';
            var state_WA, state_NM, state_MS = 'messytess';
            var state_VA, state_NY = 'slickrick';
            var state_CA = 'icecube';

            //or
            var state_def = state_MA = state_WY = state_TN = 'joeblow'; 
```

只是为了理解，我正在使用这样的开关......

```
switch (capitalise(data.regionName)) {
                case 'Arizona': rep = state_AZ; break;
                case 'Texas': rep = state_TX; break;
                case 'Montana': rep = state_MT; break;
                case 'Oregon': rep = state_OR; break;
                case 'New Mexico': rep = state_NM; break;
                case 'Mississippi': rep = state_MS; break;
                case 'Oklahoma': rep = state_OK; break;
                case 'Louisiana': rep = state_LA; break;
                case 'Washington': rep = state_WA; break;
                case 'Massachusetts': rep = state_MA; break;
                case 'Wyoming': rep = state_WY; break;
                case 'Tennessee': rep = state_TN; break;
                case 'Virginia': rep = state_VA; break;
                case 'Illinois': rep = state_IL; break;
                case 'Nevada': rep = state_NV; break;
                default: rep = state_def; break;
            }; 
```

这也将有几千个邮政编码，因此需要一个辅助开关。这就是为什么需要尽可能短地声明状态（或 zip）变量/用户关联的原因。但我也不想陷入我可能没有意识到的任何陷阱。`default: rep = state_def; break;`除了返回未定义外，这现在可以工作。此外，在 IE8 中不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T18:32:24.310

我建议用`switch`映射替换你的：

```
var reps = {
    'Arizona': state_AZ,
    'Texas': state_TX,
    // etc.
};

// then you can do this:
var rep = reps[capitalize(data.regionName)]; 
```

稍后，您甚至可以将该映射（包括值）作为 JSON 对象或从服务器或其他数据源下载。

另请注意，您的大多数`state_*`变量都是未定义的。我不知道这是不是你想要的。如果您只有某些状态的数据，最好直接构建数据结构：

```
var reps = {
    'Arizona': undefined, // or just omit from mapping
    'Texas': 'moefoe',
    // etc.
}; 
```

并省去所有`state_*`变量。

# javascript - 文本框中空白、制表符或空格的正则表达式

> ID：13479720
> 
> 赞同：0
> 
> 时间：2012-11-20T18:27:40.783
> 
> 标签：javascript, regex

我需要这个论坛专家的帮助。

我想提出一个正则表达式（javascript）来验证一个文本框，其中包含任何空格、任何空白选项卡，并检查是否有空文本框？

IE。

```
alert("Accepted")
------------------------------
Jameswithsometext
Billy Jean

alert("Not accepted")
------------------------------
- inadvertenly typed blank spaces
- inadvertenly typed tabs
- blank textbox 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:31:43.267

`\s`应该匹配任何空白字符。因此，如果仅此而已，那么您就有问题了。

```
var textbox = document.getElementById('mytextbox');
if (/^\s*$/.test(textbox.value)) {
  alert('Come on man, seriously, what the hell are you doing?');
} else {
  alert('Accepted');
} 
```

在这里看到它：http: [//jsfiddle.net/68KzX/](http://jsfiddle.net/68KzX/)

*   `^`字符串的开头
*   `\s`任何空白字符
*   `*`匹配任意数量的字符
*   `$`字符串结尾

所以如果字符串有零个字符，或者它*只有*空白字符，这将匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:32:15.987

使用`/^\S+$/`（至少一个非空白字符）我们可以做到，

```
var p = prompt("Enter text", "");
var rx = /^\S+$/;
if (rx.test(p) == false)
    alert("Not accepted");
else
    alert("Accepted"); 
```

请注意，这也处理没有输入的情况。

# php - 如何使 jQuery load() 适用于数组的所有元素，而不仅仅是最后一个

> ID：13479723
> 
> 赞同：0
> 
> 时间：2012-11-20T18:27:58.667
> 
> 标签：php, javascript, jquery

我有一个网页，按名称显示数据馈送列表（下面的 dataFeed 变量），我试图模拟一个弹出窗口，其中包含当用户单击图标时有关数据馈送的更多信息（dataFeed + ' dataLink') 旁边的数据馈送名称。我有一个隐藏的 div (diagWindow)，其中包含一个 div (diagWindowContent)，其中填充了有关提要的信息。getDiagData.php 页面使用传递给它的 dataFeed 参数返回我想要显示的信息。

一开始我试过这个...

```
for (i = 0; i < dataFeeds.length; i++) {
    dataFeed= dataFeeds[i];

    $('#' + dataFeed+ 'diagLink').click(function() {
        $('#diagWindow').toggle();
        $('#diagWindowContent').load('getDiagData.php?dataFeed=' + dataFeed);
    });
} 
```

但这只显示了为 dataFeeds 数组中的最后一个 dataFeed 返回的页面。

然后我尝试在切换（）上使用回调方法，就像这样......

```
for (i = 0; i < dataFeeds.length; i++) {
    dataFeed= dataFeeds[i];

    $('#' + dataFeed+ 'diagLink').click(function() {
        $('#diagWindow').toggle('fast', function(dataFeed) {
            return function() {
                $('#diagWindowContent').load('getDiagData.php?dataFeed=' + dataFeed);
            }(dataFeed)
        );            
    });
} 
```

但这似乎具有相同的结果，显示 dataFeeds 数组中最后一个数据馈送的信息。

我正在寻求帮助，以了解如何在单击数据馈送名称旁边的图标时从 getDiagData.php 页面加载适当的数据馈送信息。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:31:34.880

试试这个..您没有在正确的上下文中执行它..

```
for (i = 0; i < dataFeeds.length; i++) {
    (function(num){
        var dataFeed = num;

        $('#' + dataFeed + 'diagLink').click(function() {
            $('#diagWindow').toggle();
            $('#diagWindowContent').load('getDiagData.php?dataFeed=' + dataFeed);
         });
    })(dataFeeds[i])
}​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:30:38.290

这很可能是一个变量范围问题，你可以尝试这样的事情：

```
for (var i = 0; i < dataFeeds.length; i++) {
    var dataFeed= dataFeeds[i];

    $('#' + dataFeed+ 'diagLink').click(function() {
        $('#diagWindow').toggle();
        $('#diagWindowContent').load('getDiagData.php?dataFeed=' + dataFeed);
    });
} 
```

注意添加的`var`关键字

*编辑*：实际上，Sushanth 的答案是更正确的答案。我相信 Javascript 中的变量是由函数限定的，所以我上面的代码可能无法正常工作。他的遗嘱。

# c++ - 在枚举中编写代码

> ID：13479724
> 
> 赞同：3
> 
> 时间：2012-11-20T18:28:02.270
> 
> 标签：c++

我写了一个关于如何访问我的字段的方法`class`，但是我的老师告诉我应该使用`enum`.

如何重新编写此代码以使用`enum`而不使用`goto`s？

```
void SetType() {
    cout << "Book SetType" << endl;
    Choice: cout << "Please Select from the list: \n "
            << "1- Technical literature \n "
            << "2- Fiction literature \n "
            << "3- Textbook" << endl;
    int i;
    cin >> i;

    switch (i) {
    case 1:
        Type = "Technical literature";
        break;
    case 2:
        Type = "Fiction literature";
        break;
    case 3:
        Type = "Textbook";
        break;
    default:
        cout << "Erorr you entered a wrong choice" << endl;
        goto Choice;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T18:46:29.233

只需使用循环而不是 goto 它将成为意大利面条代码。枚举可以不关心定义的数字，因为如果您添加一个新数字，它们会自动递增。

```
#include <iostream>
#include <string>
void SetType();

using namespace std;
string Type;
int main()
{
    SetType();

    cout << "so you choose " << Type << endl;
    return 0;
}
enum select
{
    Technical_literature = 1,
    Fiction_literature,
    Textbook
};

void SetType() {
    cout<<"Book SetType"<<endl;
    while(1)
    {
        cout<<"Please Select from the list: \n 1- Technical literature \n 2- Fiction literature \n 3- Textbook"<<endl;
        int i;
        cin >> i;

        switch(i) {
        case Technical_literature:
            Type="Technical literature";
            return;
        case Fiction_literature:
            Type="Fiction literature";
            return;
        case Textbook:
            Type="Textbook";
            return;
        default:
            cout << "Erorr you entered a wrong choice" << endl;

        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:31:51.630

您的老师的意思是，您需要将 i 声明为枚举，而不是到处硬编码常量。

```
enum some_type {
    type_techlit=1, type_fiction, type_textbook
};

some_type i; 
```

然后阅读枚举。

# c# - 分组的 LongListSelector：标题出现，项目不出现

> ID：13479727
> 
> 赞同：3
> 
> 时间：2012-11-20T18:28:08.667
> 
> 标签：c#, silverlight, windows-phone, windows-phone-8, longlistselector

C# 中的 WinPhone 8 项目。我正在尝试填充分组列表。组标题出现，项目不出现。相关代码为：

```
class MyPage
{
    public class Group : IGrouping<string, string>
    {
        public string Title{get;set;}
        public string[] Items;

        public string Key
        {
            get { return Title; }
        }

        public IEnumerator<string> GetEnumerator()
        {
            return (Items as IEnumerable<string>).GetEnumerator();
        }

        System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
        {
            return Items.GetEnumerator();
        }
    }

    private Group[] m_ItemGroups =
        {
            new Group(){Title = "A", Items = new string[] {"A", "ASA"}},
            new Group(){Title = "X", Items = new string[] {"X", "XX"}},
        };

    private void OnLoaded(object sender, RoutedEventArgs e)
    {
        TheList.ItemsSource = m_ItemGroups;
    }
} 
```

和 XAML：

```
<phone:LongListSelector
        x:Name="TheList"
        Grid.Row="1"
        IsGroupingEnabled="True"
        SelectionChanged="OnSelChanged"
        >

        <phone:LongListSelector.GroupHeaderTemplate>
            <DataTemplate>
                <TextBlock Text="{Binding Title}"
                   Style="{StaticResource PhoneTextGroupHeaderStyle}"
                   Foreground="{StaticResource PhoneForegroundBrush}" />
            </DataTemplate>
        </phone:LongListSelector.GroupHeaderTemplate>

        <phone:LongListSelector.ItemTemplate>
            <DataTemplate>
                <StackPanel Margin="0,0,0,17" Width="432" Orientation="Horizontal">
                    <TextBlock Text="Hello world" TextWrapping="Wrap" Width="345"/>
                </StackPanel>

            </DataTemplate>
        </phone:LongListSelector.ItemTemplate>

    </phone:LongListSelector> 
```

这两种方法都没有`GetEnumerator()`被调用。`Key`getter 也永远不会被调用。看起来该列表无法将我的`Group`类识别为它的字符串集合。请问，这里有什么问题吗？

项目模板很好。当我将列表更改为非分组时，我看到两个带有虚拟文本的项目。

用自定义类替换`string`作为项目类型没有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T00:52:34.933

Seva 是正确的，Microsoft 更改了您在 Grouped 模式下分配给`ItemsSource`a的类型要求。`LongListSelector`

您需要将用于将项目分组的任何类从继承`IEnumerable<T>`转换为仅继承`List<T>`。

[有关答案的完整描述，](http://www.geekchamp.com/articles/the-new-longlistselector-control-in-windows-phone-8-sdk-in-depth)请参见此处

实际上很简单，这就是您可以与**WP8** LongListSelector 一起使用的 Group 类的示例：

```
 public class Group<T> : List<T>
{
    public Group(char name, IEnumerable<T> items) : base(items)
    {
        this.Letter = name;

    }

    public char Letter
    {
        get;
        set;
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T01:22:10.770

看起来`LongListSelector`期望在分组模式下，`ItemsSource`集合中的对象实现`System.Collections.IList`（无类型）。简单的`IEnumerator`不行。

我希望这被记录在案。到目前为止，WP8 SDK 文档吸了很多时间。

# java - JOptionPane 显示选项对话框

> ID：13479731
> 
> 赞同：4
> 
> 时间：2012-11-20T18:28:20.500
> 
> 标签：java, dialog, option, joptionpane

我想使用具有两个按钮的 JOptionPane 创建一个 showOptionDialog：公制和英制。如果说，单击 Metric，将加载 Metric GUI。相反，如果单击 Imperial，则会加载 Imperial GUI。

我该怎么做呢？非常感谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-20T18:39:12.027

```
int choice = JOptionPane.showOptionDialog(null, //Component parentComponent
                               "Metric or Imperial?", //Object message,
                               "Choose an option", //String title
                               JOptionPane.YES_NO_OPTION, //int optionType
                               JOptionPane.INFORMATION_MESSAGE, //int messageType
                               null, //Icon icon,
                               {"Metric","Imperial"}, //Object[] options,
                               "Metric");//Object initialValue 
if(choice == 0 ){
   //Metric was chosen
}else{
   //Imperial was chosen
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:49:13.427

```
Object[] options = {"Metric","Imperial"};
int n = JOptionPane.showOptionDialog(null,
            "A Message",
            "A Title",
            JOptionPane.YES_NO_CANCEL_OPTION,
            JOptionPane.DEFAULT_OPTION,
            null,
            options,
            options[1]);  

System.out.println(n);  

JFrame metric = new JFrame("Metric");  
metric.setBounds(0, 0, 320, 240);  

JFrame imperial = new JFrame("Imperial");  
imperial.setBounds(0, 0, 320, 240);  

if(n==0){  
     metric.setVisible(true);  
}else if(n==1){
    imperial.setVisible(true);
}else{
    System.out.println("no option choosen");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:39:02.200

查看[http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html)它几乎拥有您需要的一切。

“据我了解，JOptionPane 非常适合它可以做的事情，但你不能真正改变除此之外的功能（不容易）。如果你想创建自己的自定义对话框，JDialog 最好继承”

# javascript - 在 jquery ui 布局中设置 div 的高度

> ID：13479744
> 
> 赞同：0
> 
> 时间：2012-11-20T18:28:57.723
> 
> 标签：javascript, jquery, jquery-ui-layout

我一直在尝试可调整的网格插件（jquery ui 布局）。我能够使用插件设置每个 div 的宽度。bt 当涉及到高度时，我只允许调整外部 div 的高度。我想知道是否可以调整在 jsfiddle 链接[http://jsfiddle.net/J4bJ3/1/中添加的内北 div 的高度](http://jsfiddle.net/J4bJ3/1/)

我试过`$("#facetContainer").css({"height":"50%"});` 加载时间。bt 它不会工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:30:56.193

很多这些 ui 元素的设置需要在 css 中使用 !important 覆盖您是否尝试过消除 css 作为罪魁祸首？

**编辑**

如果我改变：

```
.ui-layout-pane-south {           
    border:          1px solid #BBB;
    overflow:        hidden;
} 
```

至：

```
.ui-layout-pane-south {           
    height:          230px !important;
    border:          1px solid #BBB;
    overflow:        hidden;
} 
```

导致：

![在此处输入图像描述](../Images/a80c47e2b77f38c83e60304447148f8b.png)

并且当在元素上使用 id 时，执行如下规则：

![在此处输入图像描述](../Images/f64c3ea3865571fe9ee7b9a129bc7c36.png)

# c - Win32“C”未处理的异常在错误的位置中断

> ID：13479746
> 
> 赞同：1
> 
> 时间：2012-11-20T18:29:03.197
> 
> 标签：c, winapi, floating-point, visual-studio-debugging, unhandled-exception

这几天一直困扰着我！

我们有一个应用程序，我们正在运行被零除。该应用程序是专门为在这种情况下引发异常而构建的，通过调用 _controlfp_s 函数来更改浮点异常的掩码。

现在，当在我们几乎所有的机器上运行被零除时，Visual Studio 2005 调试器会在我们的源文件中的适当位置中断。但是，在 1 台机器上，中断位置遍布各处，似乎与中断的实际原因无关。因此，作为测试，我只用以下几行代码构建了一个简单的 C win32 程序：

```
int main(int argc, char *argv[])
{
    float temp1, temp2, temp3;
    unsigned int control;

    _controlfp_s(&control, (_EM_UNDERFLOW + _EM_INEXACT, _MCW_EM);

    temp1=1.0;
    temp2=0.0;
    temp3=temp1/temp2;

    return 0;
} 
```

在所有那些“好”的机器上，代码确实在 temp3 处中断。但是，在坏机器上，代码在以下位置中断：

C:\Program Files (x86)\Microsoft Visual Studio 8\VC\crt\src\tidtable.c

功能：

__set_flsgetvalue()

在我逐步执行汇编代码时查看寄存器，一切看起来都很好，直到我点击“fstp”指令......然后所有寄存器似乎都搞砸了（与在一台好的机器上看起来一样）。在比较好与坏的堆栈时，我还看到坏机器上的堆栈条目，而我在好机器上看不到......

我在这里跳过了很多细节，以试图缩短第一次通过的时间......但如果有人愿意提供帮助，我会加起来更多。

注意：操作系统 Win7 x64，运行所有最新的 VS2005 服务包。与运行相同软件和服务包的类似（工作）机器相比。在 VS2010 上运行时出现同样奇怪的行为。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T17:53:12.527

哇！

在将这篇文章展示给朋友之后……他发现了一份英特尔文档，其中显示了关于他们的某些 CPU 的非常相似的症状……然后我在这里找到了适用于我们特定 CPU（英特尔 i5-2500）的确切文档：

[http://www.intel.com/content/dam/www/public/us/en/documents/specification-updates/2nd-gen-core-deskt](http://www.intel.com/content/dam/www/public/us/en/documents/specification-updates/2nd-gen-core-deskt) ...

请参阅勘误表 BJ1

这几乎完全描述了我遇到的问题！我从来没有（认真地）认为这会是那个级别的问题！

# ada - 使用 glib.h 在 GPS (Ada IDE) 中编译的问题

> ID：13479748
> 
> 赞同：2
> 
> 时间：2012-11-20T18:29:10.660
> 
> 标签：ada, glib

我在尝试在 GPS 中编译 Ada 代码时遇到了一些麻烦。当我将其包含在包裹中时，GPS 显示丢失。我尝试使用 apt-get 安装，它确实如此，但错误仍然存​​在。接下来我能做什么？我在 x64 Ubuntu 12.04 上运行 GPS。

这是我收到的错误消息：

```
gprbuild -d -P/media/LUISMUNYOZ/QUINTO/str/pendulum/pendulum_portatil/pendulum.gpr
 -XEXTRA=True -XOPENGL=True -XGNOME=True -XBUILD=生产
 print_barrier_sync.adb contrib.gpr:1:09：警告：没有为语言“Xml”指定编译器，
 忽略其所有来源 x86_64-pc-linux-gnu-gcc -c lw.c 在包含的文件中
 /media/LUISMUNYOZ/QUINTO/str/pendulum/pendulum_portatil/gtkada/testgtk/opengl/lw.c:20:0:
 /media/LUISMUNYOZ/QUINTO/str/pendulum/pendulum_portatil/gtkada/testgtk/opengl/lw.h:23:18:
 致命错误：glib.h：没有此类文件或目录编译终止。
 gprbuild:* 编译阶段失败

[2012-11-21 13:24:47] 进程以状态 4 退出（经过时间：02.06 秒）[2012-11-21 13:24:56]
    无法在路径上找到可执行文件：svn SVN 错误：
[…]

```

此时触发错误：

```
#ifndef LW_H
#define LW_H

#include <glib.h>           <------------------------------------------
#include <GL/gl.h>

#define LW_MAX_POINTS   200
#define LW_MAX_NAME_LEN 500 
```

该文件是 lw.h，它在包 GtkAda 中定义。我是从 GPS 页面下载的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T09:40:46.243

我从未使用过 GtkAda。但是......我用谷歌搜索`glib.h`并得到了很多点击，建议对于普通的 C 构建应该使用 - 例如，来自[这个 StackOverflow 问题](https://stackoverflow.com/questions/5277284/glib-h-and-gtk-h-not-found)-

```
# Sample Makefile
CFLAGS := $(shell pkg-config --cflags glib-2.0 gtk+-2.0)
LDFLAGS := $(shell pkg-config --libs glib-2.0 gtk+-2.0)

foo: foo.c
        $(CC) $(CFLAGS) $< -o $@ $(LDFLAGS) 
```

但是，我们在`gprbuild`这里谈论，所以也许[GtkAda 文档](http://docs.adacore.com/gtkada-docs/gtkada_ug/_build/html/getting_started.html#using-project-files)是相关的？它说您需要包含`with "gtkada";`在您的 GNAT 项目文件中，并`gtkada.gpr`在您的位置`ADA_PROJECT_PATH`不存在时包含您的位置（请参阅 的输出`gnatls -v`）。

如果您已经这样做了，请向我们展示 GPR 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-22T14:02:06.417

我会追求@Simon 的[方法](https://stackoverflow.com/a/13509713/230513)，但是基于[*2.4.2 的变通方法。在您解决潜在问题时，使用命令行*](http://docs.adacore.com/gtkada-docs/gtkada_ug/_build/html/getting_started.html#using-the-command-line)可能是一种临时替代方法。

当您使用 linux 时，这里有一个`Makefile`基本[`Interaction`](http://rosettacode.org/wiki/GUI_component_interaction#Ada)演示。

```
# Make shared, static or debug targets.
OS := $(shell uname)
OBJ = obj
TARGET = interaction
GNATMAKE = gnatmake -D $(OBJ)
CARGS = -cargs -O3 -gnatp -gnatwu -gnatf
BARGS = -bargs
LARGS = -largs
.PHONEY: clean cleaner cleanest

all:
    @echo ""
    @echo "Build targets:"
    @echo ""
    @echo "    shared     Use the shared Ada libraries."
    @echo "    static     Link the Ada libraries statically."
    @echo "    debug      Enable debugging."
    @echo ""
    @echo "Support targets:"
    @echo ""
    @echo "    clean      Remove *.ali *.o b~.*"
    @echo "    cleaner    Remove target, too."
    @echo "    cleanest   Remove build directory, too."
    @echo ""

shared: $(OBJ)
shared: INCLUDE = $(shell gtkada-config --cflags)
shared: BARGS += -shared
shared: LARGS += $(shell gtkada-config --libs)
shared: LARGS += -dead_strip
shared: *.ad[sb]
    @echo "building with shared libraries:"
    $(GNATMAKE) $(TARGET) $(INCLUDE) $(CARGS) $(BARGS) $(LARGS)

static: $(OBJ)
static: INCLUDE = $(shell gtkada-config --static --cflags)
static: BARGS += -static
static: LARGS += $(shell gtkada-config --static --libs)
static: LARGS += -dead_strip
static: *.ad[sb]
    $(GNATMAKE) $(TARGET) $(INCLUDE) $(CARGS) $(BARGS) $(LARGS)

debug: $(OBJ)
debug: INCLUDE = $(shell gtkada-config --static --cflags)
debug: BARGS += -static
debug: LARGS += $(shell gtkada-config --static --libs)
debug: *.ad[sb]
    $(GNATMAKE) -g $(TARGET) $(INCLUDE) $(LARGS)

$(OBJ):
    mkdir $(OBJ)

clean:
    ${RM} $(OBJ)/* b~*

cleaner: clean
    ${RM} $(TARGET)

cleanest: cleaner
    ${RM} -r $(OBJ) 
```

作为参考，这些软件包安装在 Ubuntu 12.04 上：

```
$ dpkg --get-selections | egrep "gnat|gtkada"
安装
gnat-4.6 安装
gnat-4.6-base 安装
gnat-gps 安装
gnat-gps-common 安装
gnat-gps-doc 安装
libgnat-4.6 安装
libgnatprj4.6 安装
libgnatvsn4.6 安装
libgtkada-bin 安装
libgtkada2.24.1 安装
libgtkada2.24.1-dev 安装

```

# python - 在 Elementtree 中附加文件名

> ID：13479751
> 
> 赞同：1
> 
> 时间：2012-11-20T18:29:17.490
> 
> 标签：python, elementtree

我有一个名为 sync_list.xml 的 XML 文档，其结构如下：

```
root = ET.Element("root")
synced = ET.SubElement(root, "synced")
synced.set("name", "Already Synced")
sfile = ET.SubElement(synced, "sfile")
sfile.set("name", "Filename")
sfile.text = "base"

tree = ET.ElementTree(root)
tree.write("sync_list.xml") 
```

所以我最终得到：

```
<root><synced name="Already Synced"><sfile name="Filename">base</sfile></synced></root> 
```

我是一个目录中的多个文件。`sfile`每次打开文件时，我想将这些文件名“附加”为新条目。所以我最终会得到这样的结果：

```
<root><synced name="Already Synced"><sfile name="Filename">base</sfile><sfile name="Filename">File1.blah</sfile><sfile name="Filename">File2.blah</sfile><sfile name="Filename">File3.blah</sfile></synced></root> 
```

我将如何实现这一目标？非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:53:37.730

你快到了。你只需要读回文件并找到其中的`<synced>`元素：

```
from __future__ import unicode_literals
from xml.etree import cElementTree as etree

tree = etree.parse('sync_list.xml')
synced = tree.find('synced')
for filename in ["file\u00b9", "file2", "file3"]:
    sfile = etree.SubElement(synced, "sfile", name="Filename")
    sfile.text = filename

tree.write('sync_list_appended.xml', encoding='utf-8', xml_declaration=True) 
```

# jquery - XDomainRequest json POST 正文未在 ASP.NET Web API 调用上反序列化

> ID：13479754
> 
> 赞同：3
> 
> 时间：2012-11-20T18:29:27.783
> 
> 标签：jquery, asp.net-web-api, xdomainrequest

作为实现跨浏览器、跨域支持 MVC4 Web 应用程序对 MVC4 Web api 应用程序进行 ajax 调用的解决方案的一部分，我使用**XDomainRequest**对象来为 IE 进行的跨域 ajax 调用提供支持 < 10个客户。

我在使用请求正文中包含 JSON 的 POST 操作时遇到问题，我希望在 Web api 端反序列化。

当使用 XDomainRequest 从 IE < 10 进行调用时，我无法明确指定`application/json`请求的内容类型（因为使用 XDomainRequest 时无法修改标头），因此 JSON 不会反序列化为方法签名中指定的类型。

请注意，跨域 GET 操作在所有浏览器中都可以正常工作，因此我为 CORS 等正确配置了我的 web api。

考虑在 web api 上定义的以下 POST 操作：

```
public int Customer(Customer customer) {} 
```

即使在`Customer`请求正文中存在表示为 JSON 的对象时，`customer`总是`null`在使用 IE < 10 的 XDomainRequest 进行调用时。发生这种情况是因为 XDomainRequest 生成的请求缺少`content-type: application/json`请求标头。

有没有办法在 web api 端处理这个问题，以便即使请求中未指定内容类型，我也可以强制 JSON 正文正确反序列化？

我已经阅读了有关模型绑定器的信息，但不清楚这是否是它们的用途。

这是我的 XDomainRequest 代码供参考（仅供参考，这是对除 IE < 10 之外的所有浏览器使用 jQuery.ajax 的函数的一部分）：

```
var xdr = new XDomainRequest();
if (xdr) {
    xdr.open(method, url);
    xdr.onload = function() {
        var result = $.parseJSON(xdr.responseText);
        if (result == null || typeof(result) == 'undefined') {
            result = $.parseJSON(data.firstChild.textContent);
        }
        doneCallback(result);
    };
    xdr.onerror = function() {
        failCallback();
    };
    xdr.onprogress = function() {
    };
    xdr.send(data);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:40:05.150

您可以编写一个委托消息处理程序，在其中将传入请求内容的内容类型标头设置为 application/json（如果尚不存在）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T19:07:14.950

我根据 Kiran 的回答编写了以下处理程序：

```
protected override Task<HttpResponseMessage> SendAsync(
    HttpRequestMessage request, CancellationToken cancellationToken)
{
    if (request.Method == HttpMethod.Post && request.Content.Headers.ContentType == null)
    {
        request.Content.Headers.ContentType = new MediaTypeHeaderValue("application/json");
    }

    return base.SendAsync(request, cancellationToken);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T01:31:38.890

你不能按照 Kiran 的建议去做，因为 XDomainRequest 的 contentType 属性是只读的。

[http://msdn.microsoft.com/en-us/library/ie/cc288107%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/ie/cc288107%28v=vs.85%29.aspx)

# c - C socket：接收并发送所有数据

> ID：13479760
> 
> 赞同：14
> 
> 时间：2012-11-20T18:29:37.477
> 
> 标签：c, sockets, client-server, send, recv

我想获得与此类似的行为：

1.  服务器运行
2.  客户端运行
3.  客户端键入“帮助”或其他命令
4.  服务器适当响应
5.  去 3

问题是，当我的函数 excCommand("help") 运行时，只接收并打印了一点文本。我的文本文件是这样的：

```
COMMAND HELP:

help - Display help
quit - Shutdown client 
```

只打印 COMMAND HELP。另一个问题是，当我键入命令时，没有打印任何内容，并且在 2 个命令客户端退出之后。尤其是这件作品：

```
while (quit)
    {
        getLine("client> ", command, 10);
        if (strcmp(command, "quit") == 0)
            quit = 0;
        else
            excCommand(command);
    } 
```

这是服务器：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

#include "common.h"

int main(int argc, char *argv[])
{
    if (argc != 2)
        ErrorWithUserMessage("Parameter(s)", "<Server Port>");

    char *service = argv[1];

    int servSock = SetupTCPServerSocket(service);
    if (servSock < 0)
        ErrorWithUserMessage("SetupTCPServerSocket() failed: ", "unable to establish");

    unsigned int childProcessCount = 0;
    while (1)
    {
        int clntSock = AcceptTCPConnection(servSock);

        pid_t processID = fork();
        if (processID < 0)
            ErrorWithSystemMessage("fork() failed");
        else if (processID == 0)
        {
            close(servSock);
            HandleTCPClient(clntSock);
            exit(EXIT_SUCCESS);
        }

        printf("with child process: %d\n", processID);
        close(clntSock);
        childProcessCount++;

        //clean up zombies
        while (childProcessCount)
        {
            processID = waitpid((pid_t) - 1, NULL, WNOHANG);
            if (processID < 0)
                ErrorWithSystemMessage("waitpid() failed");
            else if (processID == 0)
                break;
            else
                childProcessCount--;
        }

    }

} 
```

处理程序：

```
void HandleTCPClient(int clntSock)
{
    char buffer[BUFSIZE];
    ssize_t numBytesRcvd = recv(clntSock, buffer, BUFSIZE, 0);
    buffer[numBytesRcvd] = '\0';
    if (numBytesRcvd < 0)
        ErrorWithSystemMessage("recv() failed");
    if (strcmp(buffer, "help") == 0)
    {
        FILE *fp = fopen("help.txt", "r");
        if (fp)
        {
            char line[128];
            while (fgets(line, sizeof(line), fp) != NULL)
            {
                if (send(clntSock, line, sizeof(line), 0) < 0)
                    ErrorWithSystemMessage("send() failed");
            }
            fclose(fp);
        }
    }

    close(clntSock);
} 
```

这是我的客户：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

#include <sys/types.h>
#include <sys/socket.h>

#include "common.h"

int sock;

void getLine(char *message, char *buf, int maxLen)
{
    printf("%s", message);
    fgets(buf, maxLen, stdin);
    buf[strlen(buf) - 1] = 0;
}

void excCommand(char *command)
{
    if ( send(sock, command, strlen(command), 0) < 0)
        ErrorWithSystemMessage("send() failed");

    char replyMessage[BUFSIZE];
    ssize_t numBytesRecv = 0;
    do
    {
        numBytesRecv = recv(sock, replyMessage, BUFSIZE, 0);
        if ( numBytesRecv < 0)
            ErrorWithSystemMessage("recv() failed");
        printf("%s\n", replyMessage);
        memset(&replyMessage, 0, sizeof(replyMessage));

    }
    while (numBytesRecv > 0);
}

void PrintFile(const char *filename)
{
    FILE *fp;
    fp = fopen(filename, "r");
    if (fp)
    {
        char line[128];
        while (fgets(line, sizeof(line), fp) != NULL)
            fputs(line, stdout);
        fputs("\n", stdout);
        fclose(fp);
    }
}

int main(int argc, char *argv[])
{
    int quit = 1;
    char command[10];

    if (argc < 2 || argc > 3)
    {
        ErrorWithUserMessage("Parameter(s)", "<Server Address> <Server Port>");
    }

    char *server = argv[1];
    char *service = argv[2];

    sock = SetupTCPClientSocket(server, service);
    if (sock < 0)
        ErrorWithUserMessage("SetupTCPClientSocket() failed: ", "unable to connect");

    printf("Connection established!\n\n");

    PrintFile("menu.txt");
    excCommand("help");

    while (quit)
    {
        getLine("client> ", command, 10);
        if (strcmp(command, "quit") == 0)
            quit = 0;
        else
            excCommand(command);
    }

    fputs("\n", stdout);
    close(sock);
    exit(EXIT_SUCCESS);
} 
```

抱歉这么啰嗦

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-11-20T18:34:45.577

`recv()`and`send()`函数不保证发送/接收所有数据（见man [recv](http://linux.die.net/man/2/recv)，[man send](http://linux.die.net/man/2/send)）

您需要实现自己的`send_all()`and `recv_all()`，例如

```
bool send_all(int socket, void *buffer, size_t length)
{
    char *ptr = (char*) buffer;
    while (length > 0)
    {
        int i = send(socket, ptr, length);
        if (i < 1) return false;
        ptr += i;
        length -= i;
    }
    return true;
} 
```

以下指南可能会对您有所帮助[Beej 的网络编程指南](http://beej.us/guide/bgnet/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-17T22:11:10.053

常见问题。

```
void excCommand(char *command)
{
    if ( send(sock, command, strlen(command), 0) < 0)
        ErrorWithSystemMessage("send() failed");

    char replyMessage[BUFSIZE];
    ssize_t numBytesRecv = 0;
    do
    {
        numBytesRecv = recv(sock, replyMessage, BUFSIZE, 0);
        if ( numBytesRecv < 0)
            ErrorWithSystemMessage("recv() failed");
        printf("%s\n", replyMessage); 
```

无效的。`numBytesRecv`可能为零，在这种情况下根本没有消息，否则此时必须为正，因为您已经测试了负数，它表示消息的实际长度，不一定是空终止的. 改成：

```
 if (numBytesRecv == 0)
        break;
    printf("%.*s\n", numBytesRecv, replyMessage); 
```

接着：

```
 memset(&replyMessage, 0, sizeof(replyMessage)); 
```

无意义。消除。

```
 }
    while (numBytesRecv > 0); 
```

此时，您应该检查`numBytesRecv < 0`并致电`perror()`或其中一位朋友。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-12-14T17:03:08.100

如果我必须继续，我选择在每个 send() 之前发送。

所以我首先有3个定义

```
#define BUFFSIZE 1024
#define CONT "CONT"
#define DONE "DONE" 
```

然后发送我的数据

```
int     send_to_socket(int sock, char *msg)
{
    size_t  len;
    int     ret[2];

    len = strlen(msg);
    ret[0] = send(sock, (len <= BUFFSIZE) ? DONE : CONT, 4, 0);
    ret[1] = send(sock, msg, BUFFSIZE, 0);
    if (ret[0] <= 0 || ret[1] <= 0)
    {
        perror("send_to_socket");
        return (-1);
    }
    if (len > BUFFSIZE)
        return (send_to_socket(sock, msg + BUFFSIZE));
    return (1);
} 
```

并接收它：

```
char    *recv_from_socket(int cs)
{
    char    state[5];
    char    buff[BUFFSIZE+1];
    char    *msg;
    int     ret[2];

    msg = NULL;
    while (42)
    {
        bzero(state, 5);
        bzero(buff, BUFFSIZE+1);
        ret[0] = recv(cs, state, 4, 0);
        ret[1] = recv(cs, buff, BUFFSIZE, 0);
        if (ret[0] <= 0 || ret[1] <= 0)
        {
            perror("recv_from_socket");
            return (NULL);
        }
        // strfljoin() is selfmade
        // join the string and free the left argument to prevent memory leaks.
        // return fresh new string
        msg = (msg) ? ft_strfljoin(msg, buff) : strdup(buff);
        if (strncmp(state, DONE, 4) == 0)
            break ;
        i++;
    }
    return (msg);
} 
```

# git - 如何将子目录中的单个文件推送到 Github（不是 master）

> ID：13479763
> 
> 赞同：43
> 
> 时间：2012-11-20T18:29:47.193
> 
> 标签：git, github, git-branch, git-push

我已经更改了存储库子目录中的一个文件，我只想将该文件推送到 Github。

我对一个文件做了一个小改动，我不想重新上传整个存储库。

到目前为止，我看到的所有指令似乎都要求我在本地与 master 合并，然后将我的本地 master 推送到远程源。

我怎样才能只推送那个文件？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-11-20T18:36:03.757

当您进行推送时，git 只接受您已提交的更改。

还记得当您执行此操作时，`git status`它会向您显示自上次推送以来您更改的文件？

一旦您提交了这些更改并进行了推送，它们是唯一被推送的文件，因此您不必担心认为整个 master 都被推送了，因为实际上它没有。

如何推送单个文件：

```
git commit yourfile.js
git status
git push origin master 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2018-01-22T10:39:47.523

很简单。只需按照以下步骤操作：
1\. git status
2\. git add {File_Name} //您已更改的文件名
3\. git status
4\. git commit -m '{your_message}'
5\. git push origin master

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-11-20T18:41:48.243

首先让我说 git 的工作方式是您不推送/获取文件；好吧，至少不是直接的。

您正在推送/获取引用，即提交。然后 git 中的提交是对对象树的引用（其中文件表示为对象，以及其他对象）。

因此，当您推送提交时，git 会推送一组引用，如下图所示：

![git 提交](../Images/2ea995a8a184e02fbefb1b8ed55e3651.png)

如果您还没有推送您的主分支，则该分支的整个历史记录将被推送。

因此，在您的示例中，当您提交并推送文件时，如果之前未推送过整个主分支，则将被推送。

要执行您的要求，您需要创建一个没有历史记录的干净分支，就像在[这个答案](https://stackoverflow.com/a/4288660/760757)中一样。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-11-20T18:33:29.270

如果您提交一个文件并推送您的修订，它不会传输整个存储库，它会推送更改。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-08-09T14:05:49.033

**只推送单个文件**

```
git commit -m "Message goes here" filename 
```

**只推送两个文件。**

```
git commit -m "Message goes here" file1 file2 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-20T18:33:31.703

它只会推送新的提交。它不会推动整个“主”分支。这是使用分布式版本控制系统的部分好处。Git 找出真正需要的东西，然后只推送这些部分。如果您所在的分支已被其他人更改并推送，则您需要先拉动。然后推送你的提交。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-08-19T03:06:10.097

git status #then 需要推送的文件 git add example.FileExtension

git commit “信息就是例子”

git push -u origin（或您使用的任何名称） master（或您要推送的某个分支的名称）

# javascript - 在 JavaScript/jQuery 中随机化 3 个数组

> ID：13479767
> 
> 赞同：0
> 
> 时间：2012-11-20T18:30:02.610
> 
> 标签：javascript, jquery, arrays, random

我想为字体、字体大小、字体粗细随机化三个数组。然后我需要在一个 div 中显示三个数组的结果，类名为 randomFont。所以每次我使用randomFont类时，它都会返回一个随机的字体/大小/粗细。

关于我将如何做这件事的任何想法？

假设我在每个数组中有 3 个变量。

*   数组 1（字体）> 字体 1、字体 2、字体 3
*   数组 2（字体粗细）> 粗体、浅色、100
*   数组 3（字体大小）> 12px、24px、100px

然后我想要一个数组从每个数组中随机选择一个，并将输出显示在名为 randomFont 的 div> 类中。

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:33:42.683

真的不需要 jQuery，但这应该可以，因为您没有提供任何我必须编写的示例代码，但这应该可以帮助您。

`var item = items[Math.floor(Math.random() * items.length)];`

对每个数组执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T21:18:57.280

[您可以在http://jsfiddle.net/CrossEye/bwsvy/](http://jsfiddle.net/CrossEye/bwsvy/)看到一种方法

```
var fonts = ['Arial', 'Helvetica', 'Georgia', 'Tahoma', 'Verdana'];
var weights = ['normal', 'bold', 'lighter'];
var sizes = ['16px', '20px', '24px', '36px', '40px'];

var choose = function(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
};

// ...
var text = choose(sizes) + ' ' + choose(weights) + ' '  +  choose(fonts);
output.innerHTML = '<div class="randomFont">' + text + '</div>';
// e.g. '24px bold Tahoma' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:54:24.077

目前尚不清楚随机化数组是什么意思。如果你有一个固定的值列表并且你想重新排列它们，那么你需要一个随机函数，如下所示：

```
var shuffle = function(arr) {
    for (var i = arr.length; i--;) {
        var j = Math.floor(Math.random() * (i + 1));
        var temp = arr[i];
        arr[i] = arr[j];
        arr[j] = temp;
    }
    return arr;
} 
```

这可能是您正在寻找的部分答案，但我真的不清楚您的总体目标是什么。

# javascript - JavaScript 代码无法在 Firefox 中运行，而在其他浏览器中运行良好

> ID：13479769
> 
> 赞同：0
> 
> 时间：2012-11-20T18:30:07.490
> 
> 标签：javascript, html

我编写了一个脚本——首先我创建了一个`<div>....</div>`隐藏在页面加载中的脚本。然后我创建了一个空文本框。现在，当任何人单击按钮时，隐藏的全部内容`<div>....</div>`将加载到文本框中。这是它的代码：

```
<div id="hiddendiv" style="display: none;">some content</div>
<button onclick="copyfunction();">click me</button>
<textarea id="textarea"></textarea>

<script>
function copyfunction() {
var textarea = document.getElementById('textarea');
var hiddendiv = document.getElementById('hiddendiv');
textarea.value = hiddendiv.innerText;
}
</script> 
```

当我在任何其他浏览器上查看此 JavaScript 时，它在我的网页上运行良好。但是在 Firefox 中查看时，单击按钮时，文本框会显示“未定义”作为输出。注意：所有 Java 附加组件都已启用并且是最新的。甚至尝试清除所有cookie，但没有帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T18:31:32.683

FF 中没有`innerText`，而是`textContent`.

# jquery - 以编程方式构造jquery的延迟对象

> ID：13479771
> 
> 赞同：0
> 
> 时间：2012-11-20T18:30:09.487
> 
> 标签：jquery, jquery-deferred

我是 javascript 和 jquery 的新手，我正在学习如何使用 jquery 的 Deferred 对象在执行操作之前等待循环完成。循环内的函数不需要以任何特殊顺序调用。换句话说，函数 n 不依赖于函数 n-1 的结果，所以我没有用管道将它们链接在一起。

到目前为止，我有这个，它有效：

```
// wait some random amount of time, then log a message
// and resolve the Deferred object
function doTask(id) {
  var defer = $.Deferred();
  setTimeout(function() {
    console.log(id + " finished!");
    defer.resolve(id);
  }, Math.random()*1000);
  return defer.promise();
}

// log when these three independent tasks complete
$.when( doTask("foo1"), doTask("foo2"), doTask("foo3")).done(function() {
    console.log(" ... all done in no particular order!");
}); 
```

但我想以编程方式为 $.when 构建参数列表。我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:32:20.243

创建一个数组并将其应用于`$.when`.

```
var defArr = [];

defArr.push(doTask("foo1"));
defArr.push(doTask("foo2"));
defArr.push(doTask("foo3"));

$.when.apply(null,defArr).done(function(){
    console.log(" ... all done in no particular order!");
}); 
```

# ajax - MVC 通用错误视图和 Ajax Post 和错误代码 500

> ID：13479775
> 
> 赞同：2
> 
> 时间：2012-11-20T18:30:20.190
> 
> 标签：ajax, asp.net-mvc, iis, razor

我已经设置了一个带有 _error.cshtml 的 mvc 应用程序，该应用程序设置为捕获我在控制器中抛出的异常。

我在一些页面上也有一些 ajax 帖子检查错误，然后它会做其他事情。

在服务器上，我对所有异常都有一个过滤器，然后检查它是否是 ajax 请求并返回可以在客户端反序列化的内容。问题是，如果我没有将发布响应状态代码设置为 500，那么 ajax 将不会看到这个错误并且我无法显示一个好的消息。如果我将状态设置为 500，我会收到默认的 IIS 错误消息，说明服务器上发生了一些事情。

我想在 ajax 结果中处理页面上的一些错误，但保持通用错误处理。这是允许每个站点自定义 500 条消息的 IIS 设置吗？web.config Custom Error On|Off 在我的情况下没有任何区别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T19:59:18.490

您对所有异常进行检查的过滤器是否是 ajax 请求，是您自己制作的过滤器吗？

我有一个稍微类似的问题，我必须确保将*TrySkipIisCustomErrors*标志设置为 true 以避免标准 IIS 错误。此标志位于 HttpContext 的 Response 对象上。

这也是由标准的 HandleError 过滤器完成的，请注意其 OnException 方法实现中的最后一行：

```
 public virtual void OnException(ExceptionContext filterContext) {
        if (filterContext == null) {
            throw new ArgumentNullException("filterContext");
        }
        if (filterContext.IsChildAction) {
            return;
        }

        // If custom errors are disabled, we need to let the normal ASP.NET exception handler
        // execute so that the user can see useful debugging information.
        if (filterContext.ExceptionHandled || !filterContext.HttpContext.IsCustomErrorEnabled) {
            return;
        }

        Exception exception = filterContext.Exception;

        // If this is not an HTTP 500 (for example, if somebody throws an HTTP 404 from an action method),
        // ignore it.
        if (new HttpException(null, exception).GetHttpCode() != 500) {
            return;
        }

        if (!ExceptionType.IsInstanceOfType(exception)) {
            return;
        }

        string controllerName = (string)filterContext.RouteData.Values["controller"];
        string actionName = (string)filterContext.RouteData.Values["action"];
        HandleErrorInfo model = new HandleErrorInfo(filterContext.Exception, controllerName, actionName);
        filterContext.Result = new ViewResult {
            ViewName = View,
            MasterName = Master,
            ViewData = new ViewDataDictionary<HandleErrorInfo>(model),
            TempData = filterContext.Controller.TempData
        };
        filterContext.ExceptionHandled = true;
        filterContext.HttpContext.Response.Clear();
        filterContext.HttpContext.Response.StatusCode = 500;

        // Certain versions of IIS will sometimes use their own error page when
        // they detect a server error. Setting this property indicates that we
        // want it to try to render ASP.NET MVC's error page instead.
        filterContext.HttpContext.Response.TrySkipIisCustomErrors = true;
    } 
```

# android - Dropbox android API带宽限制，每个连接？还是每个帐户？或两者？

> ID：13479781
> 
> 赞同：3
> 
> 时间：2012-11-20T18:30:43.727
> 
> 标签：android, dropbox, dropbox-api

我注意到 dropbox 执行带宽限制根据我的猜测，我认为它是基于 PER-CONNECTION 的，如果错误请纠正我

例如，我在测试dropbox android API 当我上传单个文件时，峰值上传速度约为900 KBytes/s 但是当我同时上传多个文件时，峰值为2.5 MBytes/s

但我猜还有基于 PER-ACCOUNT 的节流，因为我尝试并行上传超过 5 个文件，但峰值仍然在 2.5-3MBytes/s 左右（如果没有 PER-ACCOUNT 节流，应该 >4MBytes/s，但是可能是手机802.11n单通道导致已经达到手机最大上传带宽）

谁能提供有关此问题的更准确信息？谢谢

另外，我可以使用 MULTIPLE chunked_upload（dropbox api 新功能）上传单个文件吗？这样我就可以绕过每个连接的节流阀。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-04T22:56:20.503

已经有一段时间了，但我怀疑 Dropbox 会限制文件*上传*；考虑到像 Dropbox 这样的公司使用的大部分带宽来自 Dropbox 服务器 -> 用户，而不是相反，通常上传成本供应商很少。

但是，您的结果似乎表明它们确实如此，至少对于个人连接而言。很有意思。这听起来像是一个愚蠢的问题，但你的上传速度是多少？4MB/s 是一个非常快的上传速度，所以如果瓶颈在你这边，我也不会感到惊讶。如果你发现任何东西，请告诉我！这是一个很酷的问题，很抱歉你没有得到任何答案。

# php - 如何避免创建重复行？

> ID：13479782
> 
> 赞同：1
> 
> 时间：2012-11-20T18:30:45.517
> 
> 标签：php, duplicate-removal, mysql

我搜索并找到的所有内容都还没有工作，因为我通过 php 脚本访问表格，并且与我看到的所有内容不同。无论如何，我正在将网站上的 Feed 导入到 mysql 表中。我的表是这样创建的......

```
$query2 = <<<EOQ
CREATE TABLE IF NOT EXISTS `Entries` (
`feed_id` int(11) NOT NULL,
`item_title` varchar(200) COLLATE utf8_unicode_ci NOT NULL,
`item_link` varchar(200) COLLATE utf8_unicode_ci NOT NULL,
`item_date` varchar(40) COLLATE utf8_unicode_ci NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci
EOQ;
$result = $db_obj->query($query2); 
```

我像这样输入数据....

```
foreach($rss->channel->item as $Item){
$query5 = <<<EOQ
INSERT INTO Entries (feed_id, item_title, item_link, item_date)
VALUES ('$get_id','$Item->title','$Item->link','$Item->pubDate')
EOQ;
$result = $db_obj->query($query5);
} 
```

现在，每次从站点导入新提要时，我都想确保删除任何可能已经存在的重复项。我尝试过的一切，尤其是 DISTINCT，都没有为我工作。有谁知道我可以使用什么类型的查询来创建临时表，复制任何不同的行（整个行，如果标题相同但日期不同，我想保留它），删除旧表，然后重命名我想要的夯实表....或类似的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:34:19.200

首先避免使用重复的行。将任何唯一值变成键。向数据库添加新值时，请使用

```
REPLACE INTO Entries (feed_id, item_title, item_link, item_date)
VALUES ('$get_id','$Item->title','$Item->link','$Item->pubDate')
EOQ; 
```

重复的将被自动覆盖。替换很方便，因为当键没有冲突时它就像插入一样工作，但是当有冲突时，它会更新记录并增加任何自动递增的键。

**编辑**

我一直在鼓吹这件事。这就是我想出的。

在 (feed_id, item_title, item_link, item_date) 上创建多列键的问题在于它将超过 MySQL 中键长度的 1000 字节限制。因此，改为像这样更改您的架构：

```
CREATE TABLE IF NOT EXISTS `Entries` (
`hash` varchar(32),
`feed_id` int(11) NOT NULL,
`item_title` varchar(200) COLLATE utf8_unicode_ci NOT NULL,
`item_link` varchar(200) COLLATE utf8_unicode_ci NOT NULL,
`item_date` varchar(40) COLLATE utf8_unicode_ci NOT NULL,
 PRIMARY KEY (hash)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci 
```

现在，当您存储一个新值时，将这些值的哈希值放在一起：

```
$hash = md5($get_id . $Item->title . $Item->link . $Item->pubDate); 
```

对于您的插入语句，请使用以下内容：

```
REPLACE INTO Entries (hash, feed_id, item_title, item_link, item_date)
VALUES ('$hash', '$get_id','$Item->title','$Item->link','$Item->pubDate')
EOQ; 
```

哈希将是整个记录的唯一表示，并且易于比较以避免重复。现在，当您尝试多次添加同一记录时，它只会替换现有条目，并且您的查询不会失败。作为替代方案，您可以继续使用插入，查询将返回一个错误，您可以随意处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:51:38.373

删除重复记录的最快和最简单的方法是发出一个非常简单的命令。

ALTER IGNORE TABLE [TABLENAME] 添加唯一索引`UNIQUE_INDEX`([FIELDNAME])

这样做是在您不希望有任何重复的字段上创建一个唯一索引。忽略语法指示 MySQL 在遇到重复项时不要停止并显示错误。这比转储和重新加载表要容易得多。它还将添加唯一索引，以便不会添加新的重复项。只需将您的 INSERT 更改为 INSERT IGNORE。

这也可行，但不那么优雅：

delete from [tablename] where fieldname in (select a.[fieldname] from (select [fieldname] from [tablename] group by [fieldname] with count(*) > 1 ) a )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:57:47.477

也许做这样的事情：

```
$query2 = 'CREATE TABLE entries_new LIKE entries';
$result = $db_obj->query($query2);

$query5 = 'INSERT INTO entries_new (feed_id, item_title, item_link, item_date) VALUES ';
foreach($rss->channel->item as $Item){
    $query5 .= '('$get_id','$Item->title','$Item->link','$Item->pubDate'),';
}
$query5 = rtrim($query5, ',');
$result = $db_obj->query($query5);

$query6 = "RENAME TABLE entries TO entries_backup, entries_new TO entries";
$result = $db_object->query($query6); 
```

这将创建一个名为 entries_new 的表，就像您的条目表一样。在 entry_new 中插入一次数据，然后将旧表重命名为 entries_backup，将新表重命名为条目。

您可能还想考虑将整个序列包装在一个事务中。

# c# - 从数据包中删除 PPPOE 层

> ID：13479787
> 
> 赞同：4
> 
> 时间：2012-11-20T18:31:06.827
> 
> 标签：c#, networking

我在我的应用程序中使用 pcapdotnet 的 DLL，但是因为这个项目目前不支持 PPPOE，所以我想自己添加这个功能。我的问题是我对数据包结构和PPPOE数据包结构没有很好的了解。我不知道最好的开始方式。我在有和没有 PPPOE 层的情况下都采用了相同的数据包，并将字节写入文本文件。对于如何继续，我将不胜感激。

**这是没有 PPPOE 层的数据包：**

0 48 136 21 69 131 0 24 231 253 174 161 8 0 69 0 0 83 39 63 64 0 128 6 222 170 79 176 176 2747 47 211 174 182 45 0 21 130 204 202 187 202 187 119 119 220 220 220 220 8 228 228 228 23 31 128 24 1 2 2 2 2 2 145 161 0 0 1 1 8 10 14 58 64 121 0 213 181 165 51 51 51 49 32 80 97 115 115 115 119 111 111 114 100 32 114 101 113 113 117 105 114 101 100 32 102 102 102 102 111 111 114 32 106 97 110 1310 13 1010 13 1010 13 10 10 10

**这是与 PPPOE 层相同的数据包：**

0 48 136 21 69 131 0 24 231 253 174 161 136 100 17 0 1 95 0 85 0 85 0 33 69 0 0 83 39 63 64 0 128 6 222 170 79 176 176 176 2747 47 211 174 182 45 0 21 130 204 202 187 202 187 202 187 1111 119 119 119 220 8 22 31 128 24 1 2 145 161 0 0 1 1 8 10 14 58 64 121 0 213 181 165 51 51 49 32 80 97 115 115 115 119 111 111 111 114 100 32 114 101 113 113 117 105 114 105 114 101 100 32 102 102 102 102 102 111 114 32 114 32 106 97 110 13 10

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T06:06:18.947

结帐[http://sourceforge.net/projects/sharppcap/](http://sourceforge.net/projects/sharppcap/)或[http://www.wireshark.org/](http://www.wireshark.org/)

他们将让您深入了解数据包结构以及如何在需要时自行手动解码。

# ruby-on-rails - 可以从哈希生成 Rails 迁移（模型）吗？

> ID：13479788
> 
> 赞同：1
> 
> 时间：2012-11-20T18:31:12.730
> 
> 标签：ruby-on-rails, ruby, hash, model

我想知道是否有一种方法可以从哈希创建迁移/模型。例如，我有一个 Twitter API 响应：

```
 twitter = {:possibly_sensitive_editable=>true,
 :geo=>nil,
 :text=>"http://t.co/asdf",
 :created_at=>"Tue Nov 20 18:10:31 +0000 2012",
 :possibly_sensitive=>false,
 :in_reply_to_status_id_str=>nil,
 :coordinates=>nil,
 :id_str=>"123456",
 :retweeted=>false,
 :in_reply_to_user_id_str=>nil,
 :in_reply_to_screen_name=>nil,
 :source=>"<a href=\"http://twitter.com/download/iphone\" rel=\"nofollow\">Twitter for iPhone</a>",
 :entities=>
 {:media=>
    [{:type=>"photo",
     :indices=>[0,
     20],
     :url=>"http://t.co/asdf",
     :expanded_url=>"http://twitter.com/qwerty/",
     :media_url_https=>"https://p.twimg.com/qwerty.jpg",
     :source_status_id_str=>"123456",
     :id_str=>"123456",
     :sizes=>
           {:medium=>{:h=>1003,
                      :w=>600,
                     :resize=>"fit"}}}]}} 
```

如果我想从这个哈希创建一个模型（或者更确切地说是模型），有没有一种快速的方法来做到这一点？我可以想象通过将整个内容解析为文本然后将迁移编写为文本文件来实现，但怀疑这是最好的方法..

因此，如果我想至少从第一级哈希创建一个模型（即只是 Twitter，而不是媒体） - 有没有一种快速的方法来实现这一点？嵌套哈希是否可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:03:09.010

是否有可能（对于非嵌套哈希）？当然。干得好：

```
class CreateTweets < ActiveRecord::Migration
  def change
    create_table :tweets do |t|

      twitter = {:possibly_sensitive_editable=>true,
        :geo=>nil,
        :text=>"http://t.co/asdf",
        :created_at=>"Tue Nov 20 18:10:31 +0000 2012",
        :possibly_sensitive=>false,
        :in_reply_to_status_id_str=>nil,
        :coordinates=>nil,
        :id_str=>"123456",
        :retweeted=>false,
        :in_reply_to_user_id_str=>nil,
        :in_reply_to_screen_name=>nil,
        :source=>"<a href=\"http://twitter.com/download/iphone\" rel=\"nofollow\">Twitter for iPhone</a>"
      }

      twitter.keys.each do |key|
        t.string key
      end

      t.timestamps
    end
  end
end

>> Tweet.new
=> #<Tweet id: nil, possibly_sensitive_editable: nil, geo: nil, text: nil, created_at: nil, possibly_sensitive: nil, in_reply_to_status_id_str: nil, coordinates: nil, id_str: nil, retweeted: nil, in_reply_to_user_id_str: nil, in_reply_to_screen_name: nil, source: nil, updated_at: nil> 
```

可取吗？不...您可以看出这些属性中的每一个都只是字符串，而不是时间戳或布尔值。

但是您可以将其作为基线并进行调整。不建议

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:50:07.917

您要根据此响应中的字段名称创建新的模型类和新的数据库表吗？通过一些黑客攻击，我相信你可以。但这将是一个坏主意。

模型和数据库模式通常不是在应用程序运行时创建的。你不需要这样做。API 通常以非常结构化的格式返回数据，只需一两分钟即可进行迁移以保存您想要的数据，然后您可以使用很长时间。

并且值得仔细检查每个字段，考虑为什么要存储它，您希望它是什么数据类型，是否可以丢弃它等等。盲目地将此 API 响应中的每个字段保存到您的数据库可能最终会存储大量您永远不会使用的数据。

不要偷懒。创建模型，手动调整迁移，并仔细考虑管理该模型所需的数据和代码。值得手动操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-02T07:45:44.183

根据 Jesse 的建议，我将其扩展为创建一种（非 Rails）/原生 ruby​​ 生成器。

我的 API 响应包含一个哈希数组，而我的 ActiveRecord 知识非常有限，只是从 Rails 开始，所以我猜这里还有改进的空间 - 在类型映射和结构中（例如，我可能想遍历哈希的所有实例在数组中并将其放入地图中，以便涵盖不同对象中字段的变化）。

```
# Illustrative structure of activities:
# activities = [{"key"=>"val"},{},{}]

puts "class CreateActivities < ActiveRecord::Migration
  def change
    create_table :activities do |t|"
activities.first.each do |key,val|
  arType = case val
    when Hash,Array
      "RELATION-Determine"
    when Float, Fixnum
      "t.integer"
    when FalseClass, TrueClass
      "t.boolean"
    else
      "t.string"
  end
  puts "      #{arType} :#{key}"
end
puts "      t.timestamps null: false
    end
  end
end" 
```

然后运行`$ ruby activities_generator.rb > db/migrate/$(date +"%Y%m%d%H%M%S")_create_activities.rb`（如果是 linux）

# haskell - 没有主菜的 Leksah

> ID：13479789
> 
> 赞同：4
> 
> 时间：2012-11-20T18:31:16.120
> 
> 标签：haskell, leksah

有没有办法在 Leksah 中编程而不创建主要功能/模块，例如测试小功能和程序？我不能只创建一个新模块并使用它吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T21:25:05.160

Leksah 旨在让您从一开始就正确构建整个主要项目。如果您想将它用于快速编辑器，请认识到这不是它的用途，但您可以采取一种解决方法：

创建一个名为 Scratch/Scratchpad/Temp 的新工作区和包，其中只有一个模块。当你只是想搞砸一点时使用它，并在你开始其他事情时清除它。

# ruby-on-rails - 安装 Ruby On Rails - gem 的问题（没有 RVM）

> ID：13479790
> 
> 赞同：0
> 
> 时间：2012-11-20T18:31:28.080
> 
> 标签：ruby-on-rails, ruby, rubygems

每当我运行“gem install rails”时，我都会遇到这个问题：

```
usr/local/lib/ruby/1.9.1/yaml.rb:56:in `<top (required)>':
It seems your ruby installation is missing psych (for YAML output).
To eliminate this warning, please install libyaml and reinstall your ruby.
ERROR:  Loading command: install (LoadError)
cannot load such file -- zlib
ERROR:  While executing gem ... (NameError)
uninitialized constant Gem::Commands::InstallCommand 
```

Ruby 和 Rubygems 都是从源代码安装的。我已经从源代码和 apt-get 安装了 libyaml。我正在运行 ubuntu 12.04。据我所知，我**没有**运行 RVM（尝试“rvm”返回“bla bla bla not installed apt-get”。我很确定这涉及两个单独的问题，但我需要解决这两个问题。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T04:58:39.233

RVM 是轻松安装、管理和使用多个 ruby​​ 环境的最佳工具。
[https://rvm.io/rvm/install/](https://rvm.io/rvm/install/)按照此链接中的说明使 RVM 正常工作。
那么你应该在安装'libyaml'之前安装'libtool'。

```
 sudo apt-get install libtool
 rvm pkg install libyaml
 rvm reinstall 1.9.3 
```

这些命令用于安装 libyaml。安装后，您可以使用

```
 gem install rails 
```

# javascript - 我如何使用 raphael lib 设置变换

> ID：13479791
> 
> 赞同：0
> 
> 时间：2012-11-20T18:31:30.397
> 
> 标签：javascript, svg, raphael

我正在使用 raphael lib，但是当我打开我的 svg 文件时，它有以下代码，如果我放置没有它的路径，则无法设置这些参数映射不显示。

```
<g transform="translate(0.000000,524.000000) scale(0.100000,-0.100000)"
fill="#000000" stroke="none"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T12:37:15.647

Raphaël 不支持 <g> 元素，但是有一个相关的概念叫做[sets](http://raphaeljs.com/reference.html#Paper.set)。然而，这些集合实际上并没有在 DOM 中表示。

我认为您的问题可能是“如何将现有的 SVG 文件导入 Raphaël”。您是否尝试过沿着这些思路寻找答案？快速搜索显示，例如[Raphael JS - 使用 SVG 文件](https://stackoverflow.com/questions/7926643/raphael-js-use-a-svg-file)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:35:01.707

如果我正确阅读了您的问题，您需要做的是解析出 transform 属性的内容并调用[Element.translate](http://raphaeljs.com/reference.html#Element.translate)进行翻译，调用[Element.scale](http://raphaeljs.com/reference.html#Element.scale)进行缩放。

# jquery - 如何删除破折号并将第一个单词更改为大写？

> ID：13479799
> 
> 赞同：0
> 
> 时间：2012-11-20T18:32:01.213
> 
> 标签：jquery

我想转换这个键 some_name 并将其更改为 Some Name。

如何替换破折号并将单词的第一个字母更改为仅用于键的大写字母

```
var data = $(this).serializeObject();
$.each(data, function(key, val) {
var tablefeed = $('<tr><td>'+key+'</td><td id="'+key+'">'+val+'</td><tr>').appendTo('#display');
                    });
    $(".modal-body").html(tablefeed); 
```

电流输出
键 | 值

```
some_name_11_ar_22     | joe 
```

预期产出

```
Some Name  11 ar 22   | joe 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:40:21.903

要替换破折号，您可以简单地执行以下操作：

```
key = key.replace(/_/g, ' '); 
```

为了使单词大写，我建议您使用 CSS 而不是 javascript，因为它似乎仅用于表示目的：

```
... '<td class="keys">' + key + '</td>' ... 
```

CSS：

```
td.keys {
    text-transform: capitalize;
} 
```

# cakephp - 可包含的“包含”属性未重置

> ID：13479818
> 
> 赞同：0
> 
> 时间：2012-11-20T18:33:25.080
> 
> 标签：cakephp, cakephp-2.1, containable

在以下代码中，可包含的行为与我在 CakePHP 2.1.2 中的预期不同：

```
class ReportCard extends AppModel {

....
    // debug shows expected results
    public function test1(){
        $this->Behaviors->attach('Containable');
        $params = array(
                'conditions' => array('ReportCard.id' => 1),
                'contain' => array(
                        'ReportCardGradingPeriodCollection' => array(
                                'GradingPeriodCollection')));

        debug($this->find('first', $params));
        $this->Behaviors->detach('Containable');
    }

    // Unexpected: debug shows same array as test1
    public function test2(){
        $this->Behaviors->attach('Containable');
        $params = array(
                'conditions' => array('ReportCard.id' => 1),
                'contain' => array(
                        'ReportCardGradingPeriodCollection' => array(
                                'GradingPeriodCollection' => array(
                                        'GradingPeriodCollectionDetail' => array(
                                                'GradingPeriod')))));

        debug($this->find('first', $params));
        $this->Behaviors->detach('Containable');
    }

} 
```

从控制器调用函数时，我得到了意想不到的结果。`test1()`显示预期的数组。`test2()`显示来自 的相同数组`test1`。如果我运行，`test2()`那么`test1()`我会得到预期的结果（大数组，然后是小数组）。

```
class ReportCardsController extends AppController {

    ....

    public function test(){
        $this->ReportCard->test1();
        $this->ReportCard->test2();
    }

} 
```

我尝试`actAs`在模型中使用，而不是在每个函数中动态加载行为，但这并没有帮助。

如果我遗漏了一些简单的东西，我深表歉意。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:06:53.510

引用手册：

> Containable 必须附加到用于收容的所有模型上，

从您的示例代码中不清楚您是否正在这样做。

这是该笔记的剩余一半：

> 您可以考虑将其附加到您的 AppModel。

# ruby-on-rails-3 - 洗劫宝石铁轨 3

> ID：13479826
> 
> 赞同：0
> 
> 时间：2012-11-20T18:34:09.983
> 
> 标签：ruby-on-rails-3, activerecord, ransack

我一直在使用 gem ransack。我已经在我的 gemfile 中放置了 ransack，然后运行 ​​bundle install （虽然我只使用了 bundle，但这有什么不同吗？我认为没有？）

接下来我把它放在我的食谱控制器中

```
 def all_recipes
 @q = Recipe.search(params[:q])
 @searchresults = @q.result(:distinct => true)
 end 
```

在我看来（all_recipes）我有搜索表单和块来显示我的结果

```
 <%= search_form_for @q do |f| %>
      <%= f.label :dish_name_cont %>
      <%= f.text_field :dish_name_cont %>
      <%= f.submit %>
      <% end %>
      ---------------------

      <% @searchresults.each do |r| %>
      <tr>
      <td><%= r.dish_name %></td>
      </tr>
      <% end %> 
```

我有两个问题，甚至没有进行搜索我在我看来这个块在哪里

```
fish and chips my first recipe lasagne Lasagne 
```

然后，如果我搜索说 las，它会在获取请求后将我重定向到我的索引页面，但由于我没有阻止显示结果，我得到一个未定义的错误，这是预期的。

在此之后，我将我的控制器代码放在索引操作中，并将表单和块放在索引视图中，现在一切正常了吗？为什么我不能使用 all_recipes 操作，为什么它会重定向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:12:24.250

深入演示，可能会有所帮助 - [http://railscasts.com/episodes/370-ransack?view=asciicast](http://railscasts.com/episodes/370-ransack?view=asciicast)

# c# - RadScheduler 导致巨大的 ViewState 大小

> ID：13479830
> 
> 赞同：2
> 
> 时间：2012-11-20T18:34:30.973
> 
> 标签：c#, asp.net, telerik, viewstate, radscheduler

目前对于我正在使用的 RadScheduler 的一个月视图，有 90-400 多个约会之间的任何地方。并非所有这些都始终显示，但由于某些过滤逻辑，它们总是需要被拉回并绑定到控件以进行过滤和业务逻辑。

这导致 ViewState 大小高达 2.34MB（即使**在**页面上进行 gzip 压缩之后）。

我尝试设置`EnableViewState = false`控件，该控件适用于每次回发绑定的约会。使用我自定义的 AdvancedEdit 模板时会出现问题。有一点需要回发页面才能重新填充弹出窗口上的下拉列表以插入/更新约会。有什么方法可以使 AdvancedEditForm 持久化而不是 RadScheduler 控件？

除了将 ViewState 移动到 SQL Server 之外，还有什么可以做的吗？

**编辑**RadCompression 模块**不是**一个选项，因为 RadScheduler 与 DotNetNuke 模块一起使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:20:32.277

视图状态实际上就是当前演示的状态。这是一个很好的机制来防止页面来回回发，但最终会导致页面非常重。如果您要将视图状态放在 SQL 服务器或会话数据中，它就不是视图状态，而是基于会话的状态，否则您必须保留您为数据库中的每个页面生成的所有可能的视图状态。我在这里闻到了一个严重的视图状态误解......

解决办法是什么？

重新考虑您的结构，据我所知，RAD 是一个很棒的库，尽管自从我使用 PHP 以来我并没有太多使用它。肯定会有本地事件可以让您将 javascript 代码绑定到您的 RADScheduler 中发生的事件，尽管我不能确定。

另请注意，最好的办法是在 Telerik 的网站上发帖。Telerik 的用户群可能对您可以为您的案例做什么和不做什么有更好的了解......

祝你好运

# python - 当 wxPython 框架调整大小时，最简单的监控方法是什么？

> ID：13479831
> 
> 赞同：3
> 
> 时间：2012-11-20T18:34:33.313
> 
> 标签：python, wxpython, wxwidgets

我想知道何时调整了框架的大小，以便我可以保存大小并在下次应用程序启动时记住它。这是我的`on_resize`方法：

```
def on_resize(self, event):
    logic.config_set('main_frame_size',
                     (event.Size.width, event.Size.height))

    event.Skip() 
```

它是这样绑定的：

```
self.Bind(wx.EVT_SIZE, self.on_resize) 
```

问题是性能。为了安全起见，我的逻辑模块会在每次设置更改时保存配置文件，并且每次触发调整大小事件时都写入配置文件对性能的影响太大了。

**当用户完成**调整框架的大小时，最好/最简单的监控方式是什么？

* * *

### 更新

我的`config_set`功能：

```
def config_set(key, value):
    """Set a value to the config file."""
    vprint(2, 'Setting config value: "{}": "{}"'.format(key, value))

    config[key] = value

    # Save the config file.
    with open(config_file_path, 'w') as f:
        pickle.dump(config, f) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T04:05:37.613

您可以处理[`EVT_IDLE`](http://www.wxpython.org/docs/api/wx.IdleEvent-class.html)事件队列为空时触发的事件：

> **wx.IdleEvent**：此类用于 EVT_IDLE 事件，这些事件在应用程序空闲时生成并发送。换句话说，当事件队列变空时，空闲事件被发送到所有窗口（默认情况下），只要它们都没有调用 RequestMore，那么直到系统事件队列有一些正常事件之后，才会有空闲事件，并且然后再次变为空。

调整窗口大小或移动窗口的过程应保持事件队列阻塞，以便在调整大小/移动完成之前它不会变空（并触发空闲事件）。

设置一个脏标志`EVT_SIZE`并在处理程序中检查它`EVT_IDLE`。如果设置了标志，则保存新大小并重置标志：

```
import wx

class Frame(wx.Frame):
    def __init__(self):
        wx.Frame.__init__(self,None)
        self.resized = False # the dirty flag
        self.Bind(wx.EVT_SIZE,self.OnSize)
        self.Bind(wx.EVT_IDLE,self.OnIdle)

    def OnSize(self,event):
        self.resized = True # set dirty

    def OnIdle(self,event):
        if self.resized: 
            # take action if the dirty flag is set
            print "New size:", self.GetSize()
            self.resized = False # reset the flag

app = wx.PySimpleApp()
frame = Frame().Show()
app.MainLoop() 
```

`EVT_SIZE`恢复最小化窗口时也可能触发（窗口大小保持不变）。如果您想减少不必要的保存，您可能需要在将其保存到配置之前检查大小是否实际不同（您可以在包含上次保存大小的变量中跟踪它）。

您可能需要添加`EVT_MOVE`以跟踪窗口位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T20:23:20.390

您可以启动一个计时器并让它每隔一段时间检查一次更改，有点像 Microsoft Word 中的自动保存。或者您可以在 EVT_SIZING 或 EVT_SIZE 发生时设置某种标志，然后绑定到 EVT_LEAVE_WINDOW，因为当您完成调整大小时您几乎肯定会离开窗口。因此，当该事件触发时，您检查已设置的标志，如果已设置，则保存并重置标志。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T18:46:58.790

在 Windows 上，您可以将配置保存在注册表中，这样在调整窗口大小时不会影响性能。

在没有注册表的其他操作系统上，我想您需要使用文件。但是，令我惊讶的是，即使这样也会造成您会注意到的那种性能损失。

你**确定**你看到的任何糟糕的表现都是因为这个吗？（也许你的重绘代码很慢？）

我认为任何现代操作系统都会在不妨碍您的情况下处理如此小的文件写入。也许是Python问题？

我敦促您先研究上述问题。但是，要回答您的实际问题：

这样做的方法是将窗口大小保存在一个变量中，并且仅在您的应用程序退出时将其写入文件。

* * *

看看你刚刚发布的代码。我不是 python 专家，但看起来你每次更新都重新打开文件。如果是这样，难怪它很慢！

1.  始终保持文件打开。

2.  仅在您的应用退出时写入文件。

您还可以查看 wxWidget wxConfig 类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T23:56:50.270

您绝对不应该在每次调整大小时保存窗口几何图形，通常应该只在框架关闭时完成。如果您想要额外的安全性（但是，老实说，您如何设法在*Python*中崩溃？），您还可以从`EVT_TIMER`处理程序调用在帧关闭时调用的相同函数。但是窗口几何图形几乎不是关键资源，所以我认为没有任何真正需要这样做。

# java - JAVA SWT 动画 GIF

> ID：13479833
> 
> 赞同：4
> 
> 时间：2012-11-20T18:34:41.130
> 
> 标签：java, swt, animated-gif

我需要以微调器的形式将动画 gif 添加到一些 SWT 小部件中，例如标签。此标签将作为默认值`labelSpiner.setEnabled(false)`。当我开始一些长时间的操作时，这个带有微调器的标签将`labelSpinner.setEnabled(true)`在窗口的右上角显示 ()。

Normaly Image 可以通过以下方式添加到标签中`labelSpinner.setImage(arg0)`

如果我将此 SPINNER.GIF 正常方式添加到标签中，它不会动画，它唯一的静态图像。

有人知道如何将动画 gif（例如一些微调器）添加到基于 SWT 的 JAVA SE 应用程序小部件中吗？我浏览了很多例子，但其中很多都是无用的，而且那些好的太复杂了。

我想做的很简单。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T18:40:48.263

[您是否尝试过有关SWT`Images`](http://www.eclipse.org/articles/Article-SWT-images/graphics-resources.html#Animation)的 Eclipse 文章？

这部分将加载图像并将其显示在`Canvas`：

```
ImageLoader loader = new ImageLoader();
loader.load(getClass().getResourceAsStream("Idea_SWT_Animation.gif"));
Canvas canvas = new Canvas(shell,SWT.NONE);
image = new Image(display,loader.data[0]);
int imageNumber;
final GC gc = new GC(image);
canvas.addPaintListener(new PaintListener(){
    public void paintControl(PaintEvent event){
        event.gc.drawImage(image,0,0);
    }
}); 
```

这部分更新了 gif：

```
Thread thread = new Thread(){
    public void run(){
        long currentTime = System.currentTimeMillis();
        int delayTime = loader.data[imageNumber].delayTime;
        while(currentTime + delayTime * 10 > System.currentTimeMillis()){
            // Wait till the delay time has passed
        }
        display.asyncExec(new Runnable(){
            public void run(){
                // Increase the variable holding the frame number
                imageNumber = imageNumber == loader.data.length-1 ? 0 : imageNumber+1;
                // Draw the new data onto the image
                ImageData nextFrameData = loader.data[imageNumber];
                Image frameImage = new Image(display,nextFrameData);
                gc.drawImage(frameImage,nextFrameData.x,nextFrameData.y);
                frameImage.dispose();
                canvas.redraw();
            }
        });
    }
};
shell.open();
thread.start(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-13T03:42:09.827

在尝试了至少 3 个不同的动画 GIF 示例后，没有一个有效，我开始自己工作，主要基于上面的答案。

这是一个完整的运行示例，包括：

*   一个 base64 解码器（由[http://www.source-code.biz/base64coder/java/](http://www.source-code.biz/base64coder/java/)提供）
*   微调器 GIF
*   主要方法

删除 main 方法、base64 方法和图像数据，您将拥有一个工作的动画 GIF 画布。

```
import java.io.IOException;
import java.io.InputStream;

import org.eclipse.swt.SWT;
import org.eclipse.swt.graphics.GC;
import org.eclipse.swt.graphics.Image;
import org.eclipse.swt.graphics.ImageData;
import org.eclipse.swt.graphics.ImageLoader;
import org.eclipse.swt.widgets.Canvas;
import org.eclipse.swt.widgets.Composite;
import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.Shell;

public class AnimatedGif extends Canvas {

    public static void main(String[] args) throws IOException {
        byte[] d = decode(b64.toCharArray(), 0, b64.length());
        Display display = new Display ();
        Shell shell = new Shell(display);
        shell.setBounds(0, 0, 100, 100);

        AnimatedGif gif = new AnimatedGif(shell, SWT.NONE);
        gif.setLocation(10,10);
        gif.setSize(16, 16);
        gif.load(new java.io.ByteArrayInputStream(d));
        shell.open();
        gif.animate();

        while (!shell.isDisposed ()) {
            if (!display.readAndDispatch ()) display.sleep ();
        }
        display.dispose ();

    }

    private final ImageLoader loader = new ImageLoader();
    private int img = 0;
    private volatile boolean animating = false;
    private Thread animateThread;

    public AnimatedGif(Composite parent, int style) {
        super(parent, style);
    }

    public void load (InputStream resource) throws IOException {
        loader.load(resource);
    }

    public void animate() {
        if (animateThread == null) {
            animateThread = createThread();
            animateThread.setDaemon(true);
        }

        if (animateThread.isAlive())
            return;

        animateThread.start();
    }

    public void stop() {
        animating = false;
        if (animateThread != null)
            try {
                animateThread.join();
                animateThread = null;
            } catch (InterruptedException e) {
                // do nothing
            }
    }

    private Thread createThread() {
        return new Thread() {
            long currentTime = System.currentTimeMillis();
            final Display display = getParent().getDisplay();
            public void run() {
                animating = true;
                while(animating) {
                    img = (img == loader.data.length-1) ? 0 : img + 1;
                    int delayTime = Math.max(50, 10*loader.data[img].delayTime);
                    long now = System.currentTimeMillis();
                    long ms = Math.max(currentTime + delayTime - now, 5);
                    currentTime += delayTime;
                    try {
                        Thread.sleep(ms);
                    } catch(Exception e) {
                        return;
                    }

                    if (!display.isDisposed())
                        display.asyncExec(new Runnable() {

                            @Override
                            public void run() {
                                ImageData nextFrameData = loader.data[img];
                                Image frameImage = new Image(display, nextFrameData);
                                new GC(AnimatedGif.this).drawImage(frameImage, nextFrameData.x, nextFrameData.y);
                                frameImage.dispose();
                                //canvas.redraw();
                            }
                        });
                }

                Display.getDefault().asyncExec(new Runnable() {

                    @Override
                    public void run() {
                        new GC(AnimatedGif.this).fillRectangle(
                                0,
                                0,
                                getBounds().width,
                                getBounds().height);
                    }
                });
            }
        };
    }

    private static final char[] map1 = new char[64];
    static {
        int i = 0;
        for (char c = 'A'; c <= 'Z'; c++)
            map1[i++] = c;
        for (char c = 'a'; c <= 'z'; c++)
            map1[i++] = c;
        for (char c = '0'; c <= '9'; c++)
            map1[i++] = c;
        map1[i++] = '+';
        map1[i++] = '/';
    }

    private static final byte[] map2 = new byte[128];
    static {
        for (int i = 0; i < map2.length; i++)
            map2[i] = -1;
        for (int i = 0; i < 64; i++)
            map2[map1[i]] = (byte) i;
    }

    public static byte[] decode(char[] in, int iOff, int iLen) {
        if (iLen % 4 != 0)
            throw new IllegalArgumentException(
                    "Length of Base64 encoded input string is not a multiple of 4.");
        while (iLen > 0 && in[iOff + iLen - 1] == '=')
            iLen--;
        int oLen = (iLen * 3) / 4;
        byte[] out = new byte[oLen];
        int ip = iOff;
        int iEnd = iOff + iLen;
        int op = 0;
        while (ip < iEnd) {
            int i0 = in[ip++];
            int i1 = in[ip++];
            int i2 = ip < iEnd ? in[ip++] : 'A';
            int i3 = ip < iEnd ? in[ip++] : 'A';
            if (i0 > 127 || i1 > 127 || i2 > 127 || i3 > 127)
                throw new IllegalArgumentException(
                        "Illegal character in Base64 encoded data.");
            int b0 = map2[i0];
            int b1 = map2[i1];
            int b2 = map2[i2];
            int b3 = map2[i3];
            if (b0 < 0 || b1 < 0 || b2 < 0 || b3 < 0)
                throw new IllegalArgumentException(
                        "Illegal character in Base64 encoded data.");
            int o0 = (b0 << 2) | (b1 >>> 4);
            int o1 = ((b1 & 0xf) << 4) | (b2 >>> 2);
            int o2 = ((b2 & 3) << 6) | b3;
            out[op++] = (byte) o0;
            if (op < oLen)
                out[op++] = (byte) o1;
            if (op < oLen)
                out[op++] = (byte) o2;
        }
        return out;
    }

    static String b64 =
            "R0lGODlhEAAQAPf/AMra5KO9zOzz9s3b5MDS3aS+zZOwwsrZ4+bt89jm7IKftuLr" + 
            "8ZCswH6bs9vn7qrD0+Ts8oqnvYKetomlu8PV4t7p79Pg6dzp79vm7q/F1aC6zdTi" + 
            "6bbL2XqYsdDf55SwxK/H1ajC0Yajudzp7q7E087c59Xi6niWr8XY4qW/0LnM2aO9" + 
            "zoyov7bK2djk7ICbtIOhtt7p7pq1yc3b5sDU38DR39vm7LDH1afA0Yqovebu85Gt" + 
            "wouovsvZ5oCdtunv9IaiuXyZscrb5qnC0Zezxdjj64WiuZ65y7vQ3N/p8OLq8avE" + 
            "1MTX4o6rwJaxxLnN29jm7a7F1dvm7Y2qwH2bs7zQ3Jizx9Df6djj7HmXr+Tt8rvO" + 
            "26/E1LrO3KC5zKW+z8/e577Q3oCctYShubTK2HyasZGtwHuYsdTg6enw89/p76zE" + 
            "04iku+Lr8LXJ2JKvw+Xt8tHf583b57vP3pu2ycjY45m0yNvp7qzE1bHI13qZsaK8" + 
            "zn2aspq0yODp8Nfi6svb5oaiuuDp76vE09Hf6ZWzxMfY4qnC087e5+rx9eLs8pSv" + 
            "xL/R3rPI2Nfj64ajuq7E1Y2pv7rQ2+Lp8J65yarC1JKvxLzR3nybsrzQ3unw9HmY" + 
            "sLvR3LPI17nO28rY5Iqlvc3c5urx9Iakus/f53iVrtPi6cnY436btNTi6tfi67PK" + 
            "1rHI2H6bspy3yJ63ydXi7JezxKjA0ZGuwNjk64CbtazE0Zezx8DR3NXi68TX4Nvn" + 
            "7e7097vP24CctH2atIqlvN7o7tPh6Nzn7JGvwK/F1MbX4dHg6MfY4b7S3c/e5n2b" + 
            "srjN2ezy9eDq78rb4svb473R2+Ts8cHV3r7R3eXu8rfN2JSvwo+tv9/p7pSxw6C7" + 
            "ytbj6cTX36zD1NHg5vL3+KnB0Onx9cPV35y4yLPJ1dnl7LnO2cHU3avD0bnP2sDV" + 
            "4pKvwdfk7O7z99Xi6XqXsNTi6N3o7sjY4ubv8s7c5qvE0env842svuLs8Z64yJm0" + 
            "xZq2x46svuLq8P///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQFAAD/ACwAAAAAEAAQ" + 
            "AAAIvQD/CRR4poEEf0q0DFz478SZFwqAxPC3AAEChqU6GAQSwcHEihcFntAoQUQE" + 
            "BgkcVKCI4IdAkiYZfCiScmXFfzBzMFhYk6K/jScZ/uspSEFMJ0KxpIxxAQgPBk5k" + 
            "CDVRBIoDDE8/yNAg1MIGmglkyvDy5cHCEh4smIC14d/WLyGGQGpBA4UQtBYsCDyy" + 
            "AseDByBaqKhhqAfaKwNTPIiyBAQZFUjqGmY4KEMGEG5UdAlDgYlQgQ9IdOJQhRPD" + 
            "gAAh+QQFAAD/ACwAAAAAEAAQAAAI1gD/CRR4IkiZBjx0DFwoMIueBj58EBGlRAtD" + 
            "h1TEKAikgJUOfxAWbsKk0QgbFjmEJEkiEIFAVBLGjMoxZUcfG1AEhvz3YiOoSAz/" + 
            "3VHzD8EPIxNYMPgQVMqFSRAWsGjyhoidoAmkVFjgb8eHPq80BMWS4I4fQZboaFiB" + 
            "I6gJFxhGXDiyJ4WsIZUWItrwxwYGF/9ShHjwIEOLGkwAkbJgAgvgwHjwLLnB4QmF" + 
            "HnI8oNmwYSCJDCDycPBUA8UMMHGuMHxAQvSTTBTqzBASVCCIFlWQ1KDAMCAAIfkE" + 
            "BQAA/wAsAAAAABAAEAAACMsA/wkUeKZDmSANfAxc+K8BlRe+FNRSMIbKMoYwFCjI" + 
            "CAOGEY1iqgyMMIHkhJIRgE14JImXEoEMdpiJyYBBpBxN5mjyB+GfEytWiNyyspCR" + 
            "ohE8f2jQ4GUpw38JLvBE8CVFChxDnkadOmTQoRCQtEqFoKNYlAdrMohNyiVDlBst" + 
            "5ix0lAAphAX/uNwgoyIMDQpMdJWAgrSNQC6NODyZQ4NJnVAWCFeYNLDFli6MDM3w" + 
            "gCZXgl0XGFaRVAPFZjQmHEl5KhCaaQ+EKDAMCAAh+QQFAAD/ACwAAAAAEAAQAAAI" + 
            "2wD/CRRIJUiHLCdODFz47xEMCT5eNOBjMAjDKTkisBFh5J+CiK3KDFy06I2ZJix4" + 
            "TJggYowCPr8EHqEjg4iTDzuaTGExQYEVQP9WCN3j5cjCKXYuIfihZEiIEDhwMBSo" + 
            "KMYCLSSiHAqxZKoNB0kW/MvAZQmJDFP/jfi3AMEaEDcacZgqZSACEjfIcOjCZKEL" + 
            "DGr+IdDxz42KJ0hQCEFkQVUCB34WEP6nYssWGqfkxDH1B8MIfwv8DUQShsKnEoQ2" + 
            "FMEQI4lohhR6gLFg4q+DCmn/zQBzZUMqGwwDAgAh+QQFAAD/ACwAAAAAEAAQAAAI" + 
            "uAD/CRTIgAcQBQ06DFz474iMDwVFSEh4gmGKFRoeMogAZGKHUgMHPcDxxYsMJxsl" + 
            "UhSYIcqDEF8yosyh8sy/BxmWPBjyYGFKCS/OkABBFBLDfxsPNujkhkyLFkchcpTA" + 
            "QYVVGkeLJHAQw1+VLkhqoDi6tasSTmFoGBJSYuHWCv4WaPlHAUWPEh4smMDyNi4C" + 
            "gUzu5t2g1QHcBQj+CsSrtwgUw34VD7xiAVZZvz+OCtyQAMMFQf4YBgQAIfkEBQAA" + 
            "/wAsAAAAABAAEAAACNYA/wkUeMTSDhZGXgxc+C9Fij10PjSZoADVJoYk8IRIoaHP" + 
            "GxaBJGDKMvBBBjwPZK14RYQBqDFi9AwkAWLJgyE4NNj5EGmUAiokQeTJcyNDJYY5" + 
            "jMQ80YKD0xYM/01ho6BBkCpPPD2pEfVgIB9lkGSqQYFJ1D45FPhoQBZFD0BRbQhh" + 
            "RYQHhToz5JBCxBBKEh2idPybAcaDhQ0msCSQcudfEn9KBAqJg8bEHxeLL6gRCEHL" + 
            "wCsbsNjAcKfCpH8Qov7b4ALDCD8LICD4N1u1iwuC/C34wTAgACH5BAUAAP8ALAAA" + 
            "AAAQABAAAAjNAP8JFMil2JAvGpwMXPiPC5cMUQal0GCFQQSGLRrdiPLgUAovVnZM" + 
            "gDGwyhYOZG6sCYFDAxEzERQ0ECipyxMVLTJAGqLhFoMJCqj8o1CD0ZwwcxaGHPni" + 
            "DAoUhmjQYPjvpwJfHWZoZUKBKkwYCsp4GFunK8NIEWDUCkIIDZpQuqjmAGZEJgUT" + 
            "uSyUcLSQUROgY8b8c5QACpQEiBErmvMoqEApu0ZIvkD5wghNksQsG3ihgr/PoD/z" + 
            "qsJwUhsIqFNDUEJV4IIfOhAg+MEwIAAh+QQFAAD/ACwAAAAAEAAQAAAI1wD/CRRI" + 
            "Yk0GEkNWDFz4T4WbGyC4RAmx4sgihki2qCBzY8khinQWTRlIIcyWJxwakQiBY4+M" + 
            "NzkeCaRAgQaSLhwyLMHhhYiZCDD+zejx6RQKJguPOGnCRgIVMGBKyBHC8N8HFiJ8" + 
            "BLligVAcRFV38DDyosMGExtMWajaZMK/BllSuSjyR1XVKRMU8DlhA4PfBC4WTsGq" + 
            "9cQ/BzFGOMAg5Z+Nf3YmjCkrsEISf37U/FOs6JICBa2CDPS3YMHAJDEQWOFThqE/" + 
            "HQj+lV7wA9CvqgJhx9aihGFAACH5BAUAAP8ALAAAAAAQABAAAAjAAP8JFMipCodO" + 
            "JB4MXPiPCYUwXVS4AZEhwyCGJXqgoIFEBRkQS6I8SDHwioeMhmqoaAHiwQMcK44I" + 
            "tGDhpJCNLSANCfFFg4x/G2CZqFli4YMvXmR8YJAgQZENFhj+87mUBwYHUIqYkCrD" + 
            "CQMeQC7EcJAAi1SvEUQoEOSvAlmpDCIAkdDA34K2bwcyyPGPbod/CO66dbo0Ld2B" + 
            "PwLjTRBXhN8TAxEgEDhWrt9SDCXfjQFEwYszkKX+06LEH90zDAMCACH5BAkAAP8A" + 
            "LAAAAAAQABAAAAjWAP8JFEihBpIqLUAMXPhPyIw6FDI94ZCHxAOGV+KAmYGihieK" + 
            "IDKQGLhhAxoPcnpQmHhjCR48KQS6wGLCAilATGq0yPDgQYiYLjDY+LMB0cJKQ2Sl" + 
            "2HPkwggMLkww/IdjhQY6lgT5uZMAy1QNr/p82OFvQQUpCabaIfKmCYsFECZdkDL1" + 
            "AwMWE4z8QPBPzZ2pkUAFUvBCIASBUGz02TElx6gxElAJ5PsvSRIhOViwMaJADKZN" + 
            "CyH408FKwWAxVPRkYahFiSgiPnw0UD11oA4eDcoEOcEwIAAh+QQJAAD/ACwAAAAA" + 
            "EAAQAAAIyAD/CRw4zAYtYdwGKvyXz1m2YAaF1XsGbWE1aW3UQKQVb8CBA8YG3qMH" + 
            "Z4E8c++OKQMwD9k4XALTpClp7tsxD8oGIOs2DaamRDPbOFMIwBi6ZARwuQMKp83C" + 
            "fwSiVUEqgKnThdTU9YrWq5nVp73OMWNmzWvQp6tWlUv7j6m4AQpt2Utny1a4tmnc" + 
            "AQhAaVuAAAUABxaoCdwzfq70UaJEzpUrSo8HQjNQqNC+WLEKZda8cNYsIoWuFTLA" + 
            "bhaxpwK1EWOADV+/hQEBACH5BAUAAP8ALAAAAAAQABAAAAjcAP8JFGgj1YYrYGYM" + 
            "XPivggMMLkxYANODAsN//pLEwFBkA6ESnyiEQTLQ3wJ/IzD8MRVHzikaW7aoEKhj" + 
            "gR8HCVRZQCQEBZInKtz804HAnxqIC5l04UDmBgkEEPxdkHKRQ6MbINYgODkiwcUM" + 
            "JJZwybA1iQMbF5eEOBSFhJYFMRR5ZYgDR4gQQ5T8QHDJzpSFR7zsWUH4HyArCiaw" + 
            "mNJkxwcnRGTQOSLwFx8FY0RMmMCDRRMzbxYtGlim1QsfCmAYEcEmQo6/C4N0CMKn" + 
            "wWkJMB5dFHjiRJbZVBgGBAAh+QQFAAD/ACwAAAAAEAAQAAAIuQD/CRToT9AFDAk2" + 
            "DFz47weCBf5iOEgAy8IVhgge+qvgAEoRExY8lBiYESLHBEU2hCzRg4lAjSexgBTZ" + 
            "AwWFf1pMTlxYQoghGmE4KYm4kyGKGki6VCGKkuE/GiqicpAAJAKDD05btCDjplMD" + 
            "BVUZOIUEoiyJMy8kiLC68MGQB0syPPh3poHaHAycyNDwJcSDKBkEnuhgd21eGV6+" + 
            "4HgwaGApwlStfti7IgXDwYV5XJVxxKlAwmA1MwwIACH5BAUAAP8ALAAAAAAQABAA" + 
            "AAjVAP8JFPhjgT9BF1wMXPgPQUMIC/yMwOBiA0OBEP5NqnAHgw0sG64M1JLxn5oL" + 
            "UhK4+GMCTRwhApX4S/LvTkosJjZY8ABmxj8donQkgcIQESk5M+pQ4EGElRAbFwH1" + 
            "QEGhRgMfCnL0ucikaiYkZXwEYrHjYo0nnp5UCdJAAZspF1twmNvihB4xRnIwrJTh" + 
            "Rp48IP5loaJgVKQPdjTgGPJgCQgSA++OAcWAyKsVsh7gyfBgYBZMEsa+6aMhRQg8" + 
            "kBduQqVgQpMPdPakSHFR4AsjZC0dYRgQACH5BAUAAP8ALAAAAAAQABAAAAjRAP8J" + 
            "FFgBAQIdP2wMXPhPCYSHECG0GcaQBi9/GDNirNBuIA8xkjSNuEDywoiTuzYIpKLg" + 
            "0RxFCWLGhAIlgaN/D4womNCE0UJHJSzkMpHphQIjwFgw/KcrFBo0hCTUghHBy1JG" + 
            "dTx4CNVAAVUiS9cxmTGjRxlfO80spUHDEAoUE17AmLDDysIuYeYwqnHpH8sJDG5p" + 
            "CFGJSwsVT7pIEtg1ghkiGnCEWHODDIctWwbOreslxaEHUW40usEwAgMrGlIMipKB" + 
            "y5qlAp1o+DKExBeGAQEAIfkEBQAA/wAsAAAAABAAEAAACNcA/wkUqETLPwQIByr8" + 
            "xwPQjwUQD+rAsBATHysIYiQZCNHfwBWtFCi4pMjBiH9q/PhLkkBghxdjJtj5Z+Of" + 
            "FAwmYzj4xyaIDxEsmih0kQCDUSzw+CiYsGPhP1V/irhIlaXBvwmWnFowtcHElTIv" + 
            "jPD44FRIHEIWrvgESnahEDklwMygIoFNEydHFFJAcepTjzr/YEQwQ8QLjgfeOHRB" + 
            "QoMCBYFAcryRsQdHCBKNODzZEobDwCmL6KwIcWjJDTIqtiBZaObI6ChcQNxw48ap" + 
            "wBVDSGRYs2ZhQAA7";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T19:04:40.637

这是提供的示例代码。基本上这就是它的工作原理。与其他图像格式不同，动画 GIF 将具有一组 ImageData（就像动画中的帧）。您将以所需的延迟在 Cavans 上渲染此图像数据。

[http://www.java2s.com/Code/Java/SWT-JFace-Eclipse/DisplayananimatedGIF.htm](http://www.java2s.com/Code/Java/SWT-JFace-Eclipse/DisplayananimatedGIF.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-27T13:31:22.517

这也是基于关于[SWT](http://www.eclipse.org/articles/Article-SWT-images/graphics-resources.html#Animation)的 Eclipse 文章的工作示例代码。我试图从文件夹中的图像制作*幻灯片*或*动画 gif* ***对话框***。发布在这里，因为它可能对某人有用。

```
public class GifDialog extends Dialog {

    Shell                    dialog;
    private Canvas           canvas;
    int                      numberImage     = 1;
    private volatile boolean running         = true;
    final List<Image>        imageCollection = new ArrayList<Image>();

    DenemeDialog(Shell parent) {
        super(parent);
    }

    public String open() {
        Shell parent = getParent();
        this.func();
        dialog = new Shell(parent, SWT.DIALOG_TRIM | SWT.APPLICATION_MODAL);
        dialog.setSize(600, 400);
        dialog.setText("Show Begins!!!");

        Monitor primary = dialog.getDisplay().getPrimaryMonitor();
        Rectangle bounds = primary.getBounds();
        Rectangle rect = dialog.getBounds();

        int x = bounds.x + (bounds.width - rect.width) / 2;
        int y = bounds.y + (bounds.height - rect.height) / 2;

        dialog.setLocation(x, y);

        dialog.setLayout(new FillLayout());
        final Canvas canvas = new Canvas(dialog, SWT.NONE);
        final Image image = new Image(dialog.getDisplay(), imageCollection.get(
                0).getImageData());
        final GC gc = new GC(image);
        canvas.addPaintListener(new PaintListener() {
            public void paintControl(PaintEvent event) {
                event.gc.drawImage(image, 0, 0);
            }
        });

        Thread thread = new Thread() {
            public void run() {
                while (running) {

                    dialog.getDisplay().asyncExec(new Runnable() {
                        public void run() {
                            numberImage = numberImage == imageCollection.size() - 1
                                    ? 0 : numberImage + 1;
                            ImageData nextFrameData = imageCollection.get(
                                    numberImage).getImageData();
                            Image frameImage = new Image(dialog.getDisplay(),
                                    nextFrameData);
                            gc.drawImage(frameImage, nextFrameData.x,
                                    nextFrameData.y);
                            frameImage.dispose();
                            canvas.redraw();
                            if (numberImage == 0)
                                try {
                                    running = false;
                                } catch (Exception e) {
                                    e.printStackTrace();
                                }

                            try {
                                Thread.sleep(200);
                            } catch (InterruptedException e) {
                                e.printStackTrace();
                            }
                        }

                    });
                }
            }
        };
        dialog.open();
        thread.start();

        Display display = parent.getDisplay();
        while (!dialog.isDisposed()) {
            if (!display.readAndDispatch())
                display.sleep();
        }
        return "After Dialog";
    }

    public void func() {

        File path = new File("..\folder");

        File[] files = path.listFiles();
        for (int i = 0; i < files.length; i++) {
            if (files[i].isFile()) { // this line weeds out other
                // directories/folders
                try {
                    ImageData imageData = new ImageData(
                            new ByteArrayInputStream(loadImage(files[i])));
                    final Image image = new Image(Display.getDefault(),
                            imageData);
                    imageCollection.add(image);
                } catch (IOException e1) {
                    e1.printStackTrace();
                }
            }
        }

    }

    public byte[] loadImage(File file) throws IOException {

        BufferedImage image = ImageIO.read(file);
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        ImageIO.write(image, "jpg", bos);
        return bos.toByteArray();
    }

    public Canvas getCanvas() {
        return canvas;
    }

    public void setCanvas(Canvas canvas) {
        this.canvas = canvas;
    } 
```

# c# - 如何从 C# 运行 PowerShell 脚本

> ID：13479838
> 
> 赞同：5
> 
> 时间：2012-11-20T18:35:04.507
> 
> 标签：c#, powershell, registry, impersonation

我正在尝试使用 C# 运行 PowerShell 脚本，但没有任何成功。这是我的功能：

```
private void ExecutePowerShellCommand(string scriptfile)
{
    RunspaceConfiguration runspaceConfiguration = RunspaceConfiguration.Create();

    Runspace runspace = RunspaceFactory.CreateRunspace(runspaceConfiguration);
    runspace.Open();

    RunspaceInvoke scriptInvoker = new RunspaceInvoke();
    scriptInvoker.Invoke("Set-ExecutionPolicy Unrestricted");

    Pipeline pipeline = runspace.CreatePipeline();

    //Here's how you add a new script with arguments
    Command myCommand = new Command(scriptfile);
    //CommandParameter testParam = new CommandParameter("key", "value");
    //myCommand.Parameters.Add(testParam);

    pipeline.Commands.Add(myCommand);

    // Execute PowerShell script
    pipeline.Invoke();
} 
```

这是我得到的错误：

> 拒绝访问注册表项“HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\PowerShell\1\ShellIds\Microsoft.PowerShell”。

我该如何解决这个问题？我已经看到了模仿的想法，但我似乎没有找到任何好的模仿例子。我想以管理员身份运行此脚本。

我已作出以下声明：

```
[DllImport("advapi32.dll")]
private static extern bool LogonUser(string lpszUsername, string lpszDomain, string lpszPassword, int dwLogonType, int dwLogonProvider, ref IntPtr phToken);
[DllImport("kernel32.dll")]
private static extern bool CloseHandle(IntPtr handle);

public delegate void IncognitoDelegate(params object[] args); 
```

我创建了以下模拟功能：

```
public static void Impersonate(IncognitoDelegate incognitoDelegate, params object[] args)
{
    System.IntPtr token = new IntPtr();
    WindowsIdentity wi;
    if (LogonUser("myusername", "", "mypassword", 8, 0, ref token))
    {
        wi = new WindowsIdentity(token);
        WindowsImpersonationContext wic = wi.Impersonate();

        incognitoDelegate(args);

        wic.Undo();
    }
    CloseHandle(token);
} 
```

我创建了一个用作委托的函数：

```
private static void GIncognito(params object[] args)
{
    RunspaceInvoke scriptInvoker = new RunspaceInvoke();
    scriptInvoker.Invoke("Set-ExecutionPolicy Unrestricted");
} 
```

我修改了我的方法：

```
private void ExecutePowerShellCommand(string scriptfile)
{
    RunspaceConfiguration runspaceConfiguration = RunspaceConfiguration.Create();

    Runspace runspace = RunspaceFactory.CreateRunspace(runspaceConfiguration);
    runspace.Open();

    Impersonate(new Util.IncognitoDelegate(GIncognito));
    //RunspaceInvoke scriptInvoker = new RunspaceInvoke();
    //scriptInvoker.Invoke("Set-ExecutionPolicy Unrestricted");

    Pipeline pipeline = runspace.CreatePipeline();

    //Here's how you add a new script with arguments
    Command myCommand = new Command(scriptfile);
    //CommandParameter testParam = new CommandParameter("key", "value");
    //myCommand.Parameters.Add(testParam);

    pipeline.Commands.Add(myCommand);

    // Execute PowerShell script
    pipeline.Invoke();
} 
```

结果是……

...非常相似的错误，告诉我我无法访问注册表项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:00:50.433

这是方法 b，不需要提升权限或 *注册表修改权限*。

使用`Process.Start`启动它并添加相关的初始`-command`或`-file`参数。

> %SystemRoot%\system32\WindowsPowerShell\v1.0\powershell.exe -ExecutionPolicy 绕过

这是另一种技术，[http://dmitrysotnikov.wordpress.com/2008/06/27/powershell-script-in-a-bat-file/](http://dmitrysotnikov.wordpress.com/2008/06/27/powershell-script-in-a-bat-file/)

这依赖于通过首先对其进行编码并通过`-EncodedCommand`powershell.exe 的 arg 传递 int 来执行，这似乎绕过了执行策略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-02T18:09:18.070

默认`Set-ExecutionPolicy`命令尝试设置机器范围的值。您只想在 C# 应用程序范围内更改设置，因此您应该将`-Scope Process`选项添加到命令中。

使用`Get-Help Set-ExecutionPolicy -detailed`显示此信息：

> 注意：要更改默认 (LocalMachine) 范围的执行策略，请使用“以管理员身份运行”选项启动 Windows PowerShell。

...它还描述了该`-Scope`选项。

这样做的好处是***只***影响从 C# 应用程序运行的脚本的执行策略，并且不会不必要地更改默认 PowerShell 行为的执行策略。（所以它更安全，特别是如果您可以保证您的应用程序运行的脚本的有效性。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:42:18.423

您可以尝试以下内容

```
using ( new Impersonator( "Username", "DomainName", "Password" ) )
{
    using (RunspaceInvoke invoker = new RunspaceInvoke())
    {
        invoker.Invoke("Set-ExecutionPolicy Unrestricted");
    }
} 
```

这是一个链接，您可以查看以获取一个想法作为示例，[Class For Impersonating a User](http://www.codeproject.com/Articles/10090/A-small-C-Class-for-impersonating-a-User)。

# ember.js - Ember 数据渲染 hasMany

> ID：13479842
> 
> 赞同：3
> 
> 时间：2012-11-20T18:35:28.280
> 
> 标签：ember.js, ember-data

在我的 ember 应用程序中，我有一个模型：

```
App.Schedule = DS.Model.extend({
    manager:DS.belongsTo('App.Manager', { embedded: true }),
    entries:DS.hasMany('App.Reservation', { embedded: true })
});
App.Reservation = DS.Model.extend({
    name:DS.attr('string')
}); 
```

和车把视图：

```
{{#each schedule in controller}}
<td>
  {{#each reservation in schedule.entries)}}
  <div>{{reservation.name}}</div>
  {{/each}}
</td>
{{/each}} 
```

但是有了这个观点，就有例外

```
Expecting 'ID', got 'undefined' 
```

这种解决方法有效，但我知道这是错误的方法。

```
{{#each reservation in schedule._data.hasMany.entries}} 
```

有任何想法吗？

**编辑。**

Mike Aski 回答后。我的 JSON，从后端返回。

```
{
  "schedules": [
    {
      "id": "476a3881-4fe8-42f5-8bdb-650d38f911e8",          
      "entries": [
        {              
          "name": "test1",
          "begin": "2012-11-22T10:00:00+06:00",
          "end": "2012-11-22T11:00:00+06:00",
          "id": "71c6da83-8ae2-4210-90f8-e65b06f819d7"
        },
        {              
          "name": "test2",
          "begin": "2012-11-22T12:00:00+06:00",
          "end": "2012-11-22T14:00:00+06:00",
          "id": "d234c8c0-66f5-4e98-b921-4472b39a98f7"
        }
      ]
    },
    {
      "id": "8d9b1539-8a1f-4a5d-acfc-5918e61e3990",          
      "entries": []
    },
    {
      "id": "a279d9a5-ea88-4012-8094-8a30125fd32b",          
      "entries": []
    }
  ]
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T09:18:18.683

您是否确保在JSON 对象中有一个`id`属性？`reservations`

即使关系是嵌入的，您也应该拥有它们。

# .net - .NET 多语言 Web 项目无法在生产中运行 - Resx 问题

> ID：13479846
> 
> 赞同：2
> 
> 时间：2012-11-20T18:36:15.233
> 
> 标签：.net, resx, production, multilingual

我正在开发一个使用 VS 2008 开发的网站应用程序。

我正在本地化 Web 应用程序。我可以生成 resx 文件，并且可以毫无问题地从这些文件中读取值。当我在 localhost 中运行该网站时，它在任何语言中都运行良好。当我在生产服务器中部署我们的网站时会出现此问题。

似乎未读取 resx 文件中的值。

我阅读了很多关于此的博客和问题，并尝试了几种解决方案。我尝试了 resx 文件的大多数可能配置。

我尝试的第一个配置是这样的：

*   **构建操作：**嵌入式资源。
*   **复制到输出目录：**无。
*   **自定义工具：** PublicResXFileCodeGenerator。
*   **自定义工具命名空间：** [空]。

正如我之前提到的，这在 localhost 中效果很好，但在生产服务器中效果不佳。

然后我将**复制到输出目录**属性更改为**“始终复制”**，但结果是一样的。

因此，我决定将**Build Action**更改为**“Content”** ，但是当我们尝试从后面的代码访问资源文件时，我们得到了**System.Resources.MissingManifestResourceException 。**我们访问 Resx 属性的方式如下：

**wImage.AlternateText = App_LocalResources.SelectRecordSet_aspx.wImageActive;**

这发生在本地主机和生产环境中。

正如我在这篇文章中所读到的：[http](http://www.mojoportal.com/Forums/Thread.aspx?pageid=5&t=6062~-1) ://www.mojoportal.com/Forums/Thread.aspx?pageid=5&t= 6062~-1 我将自定义工具命名空间更改为资源，并重命名了访问属性的方式：

**wImage.AlternateText = Resources.SelectRecordSet_aspx.wImageActive;**

但这没有用。

我已经在这个问题上苦苦挣扎了几天，但我仍然找不到合适的解决方案。

任何帮助，将不胜感激。

谢谢！

# listview - 在 Windows 8 中使用模板在页面控件上绑定列表视图

> ID：13479847
> 
> 赞同：1
> 
> 时间：2012-11-20T18:36:17.200
> 
> 标签：listview, binding, windows-8, microsoft-metro, winjs

出于某种原因，我的模板没有用于数据绑定。我正在为 Windows 8 应用程序使用 Visual Studio 的“导航应用程序”项目类型。当我运行它时，每个项目都会被完整的 json 字符串填充。类似于完全不使用任何模板的绑定。

**主页.js**：

```
var dataList = new WinJS.Binding.List();
var publicMembers = { itemList: dataList };
WinJS.Namespace.define("VideosData", publicMembers);

(function () {
  "use strict";

  WinJS.UI.Pages.define("/pages/home/home.html", {
    ready: function (element, options) {
      dataList.push({title: 'title 1'});
      dataList.push({title: 'title 1'});            
    }
  });
})(); 
```

**主页.html**：

```
<section aria-label="Main content" role="main">
  <div id="videosWin8Tmpl" data-win-control="WinJS.Binding.Template" style="display:none">
    <div><span class="detail" data-win-bind="innerText: title"></span></div>
  </div>
  <div id="videosListView" data-win-control="WinJS.UI.ListView" data-win-options="{ itemDataSource: VideosData.itemList.dataSource, itemTemplate: videosWin8Tmpl, layout: { type: WinJS.UI.GridLayout } }"></div>
</section> 
```

输出什么：

```
{"title":"title 1"}
{"title":"title 2"} 
```

为什么模板没有在绑定中使用？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T01:33:28.363

您看到的行为的原因很微妙。我将在下面解释，但简短的回答是：

不要在页面控件中通过 id 查找内容。请改用类和选择语法。

以下将在您的页面控件中起作用：

```
<section aria-label="Main content" role="main">
  <div class="videosWin8Tmpl" 
    data-win-control="WinJS.Binding.Template" style="display:none">
    <div><span class="detail" data-win-bind="innerText: title"></span></div>
  </div>
  <div id="videosListView" data-win-control="WinJS.UI.ListView" 
     data-win-options="{ itemDataSource: VideosData.itemList.dataSource,
                         itemTemplate: select('.videosWin8Tmpl'), 
                         layout: { type: WinJS.UI.GridLayout } }">
  </div>
</section> 
```

发生什么了？

当您`itemTemplate: videosWin8Tmpl`在选项记录中执行此操作时，WinJS 将在处理时查找名为 videosWin8Tmpl 的全局变量，并将其作为模板对象传递给控件。这通常有效，因为浏览器会自动为每个具有 ID 的元素创建全局变量。

但是，在加载页面控件时，在调用 WinJS.UI.processAll 时，页面的 DOM 尚未添加到全局文档中。因此，浏览器还没有创建全局变量，因此它没有找到模板。

select(...) 表达式不依赖全局变量，而是从指定选项记录的元素向上查找，因此它可以正确找到模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:42:20.380

Got it - I moved the template snippet over to default.html just above `<div id="contenthost">...</div>` and the binding could find it then. Not sure why it had to be in `default.html` and not in `home.html`.

# php - MYSQL 两表查询 vs 一次查询

> ID：13479849
> 
> 赞同：-1
> 
> 时间：2012-11-20T18:36:24.573
> 
> 标签：php, mysql, performance

我有这个查询：

```
SELECT 
    cms_mod_lajmet_entry.LajmID, 
    page_id, date, 
    foto, eshte_video, 
    title, intro, 
    komente 
FROM cms_mod_lajmet_entry, cms_mod_lajmet_entry_language 
WHERE cms_mod_lajmet_entry.LajmID = cms_mod_lajmet_entry_language.LajmID 
    AND cms_mod_lajmet_entry.page_id = 2  
    AND cms_mod_lajmet_entry.publikimi = 1 
    AND cms_mod_lajmet_entry_language.language = 'sq' 
    AND cms_mod_lajmet_entry.renditja > 0 
ORDER by renditja ASC, date DESC LIMIT 1 
```

（加载时间 = 0.1219）

当我拆分它们时：

```
SELECT 
    LajmID, 
    page_id, 
    date, 
    foto, 
    eshte_video, 
    komente 
FROM cms_mod_lajmet_entry 
WHERE cms_mod_lajmet_entry.page_id = 2  
    AND cms_mod_lajmet_entry.publikimi = 1 
    AND cms_mod_lajmet_entry.renditja > 0 ORDER by renditja ASC, date DESC LIMIT 1 
```

（加载时间 = 0.0801）

并单独查询：（$t[LajmID] 是最后一个表中的 PrimaryID）

```
SELECT 
    title, 
    intro 
FROM cms_mod_lajmet_entry_language 
WHERE LajmID = $t[LajmID] 
    AND language = 'sq' 
```

（加载时间 = 0.0006）

总计：0.1219 > 0.0807 (0.0801 + 0.0006)。

这看起来真的更快吗和/或是否有其他更快的方法。

指标如下：

第一张表：

LajmID BTREE 否 否 LajmID 36380 A
page_id 36380 A
publikimi 36380 A
klika 36380 A

第二张表：

LajmID BTREE 否 否 LajmID 38456 A
语言 38456 A

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T01:13:08.783

我原本不打算回答，但我对这个问题的评论基本上回答了它。我的评论总结如下：

To get accurate query execution times, make sure you run the queries with `SQL_NO_CACHE`. This will make sure that the query cache doesn't skew the results. The index on the first table wasn't being used since `LajmID` was on the top of it and it wasn't used in the query.

# android - Android 正确的 MVC 编码以显示形状

> ID：13479852
> 
> 赞同：0
> 
> 时间：2012-11-20T18:36:34.970
> 
> 标签：android, model-view-controller, android-canvas

我最近开始在 Eclipse 中使用 android。我必须保持模型-视图-控制器 (MVC) 结构。

我的目标只是在屏幕上显示一个矩形框。我现在得到的是一个有四个屏幕（主菜单和链接到它的其他三个屏幕）的应用程序。盒子实现适用于这三个屏幕（板）之一

board.java 代码

```
package com.example.connectfour;

import com.example.connectfour.model.Gaps;
import com.example.connectfour.view.ConnectFourView;

imports[..]

public class Board extends Activity {

    private Button btnExit;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        connectfourView = new ConnectFourView(this);

        setContentView(R.layout.board);

        btnExit = (Button)findViewById(R.id.btn4);
        btnExit.setOnClickListener(new OnClickListener(){

            public void onClick(View v){
                Intent startMain = new Intent(Board.this, MainActivity.class);
                startActivity(startMain);
            }
        });
    }

} 
```

板子.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" 
    android:background="#48D9AB">

        <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:text="Play"
        tools:context=".Board" />

            <Button 
        android:id="@+id/btn4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_alignParentBottom="true"
        android:text="Exit"        />
</RelativeLayout> 
```

ConnectFourView.java 代码

```
package com.example.connectfour.view;

import com.example.connectfour.model.Gaps;

imports[..]

public class ConnectFourView extends View {
    public ConnectFourView(Context context) {
        super(context);
        setMinimumWidth(100);
        setMinimumHeight(20);
    }

    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
            int width = Math.max(getSuggestedMinimumWidth(),widthMeasureSpec);
            int height = Math.max(getSuggestedMinimumHeight(), heightMeasureSpec);
            setMeasuredDimension(width, height);
    }

    protected void onDraw(Canvas canvas){
        canvas.drawColor(Color.WHITE);
    }

} 
```

我已经在 board.xml 文件中尝试了以下代码，我相信它会将它们组合在一起，但是当插入它时，我的应用程序会向 logcat 发送 30 多个错误。

```
 <example.connectfour.view
 android:layout_width="fill_parent"
 android:layout_height="wrap_content"/> 
```

注意：由于这是我的第一篇 android 帖子，对于任何缺失/额外的代码，我提前感到抱歉。谢谢

编辑 TanjaV。我在 logcat 中遇到的错误（这些都是在将上述代码添加到 board.xml 文件时出现的。

```
11-20 19:14:56.446: E/AndroidRuntime(630): FATAL EXCEPTION: main
11-20 19:14:56.446: E/AndroidRuntime(630): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.connectfour/com.example.connectfour.Board}: android.view.InflateException: Binary XML file line #23: Error inflating class com.example.connectfour.view.ConnectFourView
11-20 19:14:56.446: E/AndroidRuntime(630):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
11-20 19:14:56.446: E/AndroidRuntime(630):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
11-20 19:14:56.446: E/AndroidRuntime(630):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
11-20 19:14:56.446: E/AndroidRuntime(630):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
11-20 19:14:56.446: E/AndroidRuntime(630):  at android.os.Handler.dispatchMessage(Handler.java:99)
11-20 19:14:56.446: E/AndroidRuntime(630):  at android.os.Looper.loop(Looper.java:123)
11-20 19:14:56.446: E/AndroidRuntime(630):  at android.app.ActivityThread.main(ActivityThread.java:4627)
11-20 19:14:56.446: E/AndroidRuntime(630):  at java.lang.reflect.Method.invokeNative(Native Method)
11-20 19:14:56.446: E/AndroidRuntime(630):  at java.lang.reflect.Method.invoke(Method.java:521)
11-20 19:14:56.446: E/AndroidRuntime(630):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
11-20 19:14:56.446: E/AndroidRuntime(630):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
11-20 19:14:56.446: E/AndroidRuntime(630):  at dalvik.system.NativeStart.main(Native Method)
11-20 19:14:56.446: E/AndroidRuntime(630): Caused by: android.view.InflateException: Binary XML file line #23: Error inflating class com.example.connectfour.view.ConnectFourView
11-20 19:14:56.446: E/AndroidRuntime(630):  at android.view.LayoutInflater.createView(LayoutInflater.java:503)
11-20 19:14:56.446: E/AndroidRuntime(630):  at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:565)
11-20 19:14:56.446: E/AndroidRuntime(630):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:618)
11-20 19:14:56.446: E/AndroidRuntime(630):  at android.view.LayoutInflater.inflate(LayoutInflater.java:407)
11-20 19:14:56.446: E/AndroidRuntime(630):  at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
11-20 19:14:56.446: E/AndroidRuntime(630):  at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
11-20 19:14:56.446: E/AndroidRuntime(630):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:198)
11-20 19:14:56.446: E/AndroidRuntime(630):  at android.app.Activity.setContentView(Activity.java:1647)
11-20 19:14:56.446: E/AndroidRuntime(630):  at com.example.connectfour.Board.onCreate(Board.java:28)
11-20 19:14:56.446: E/AndroidRuntime(630):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
11-20 19:14:56.446: E/AndroidRuntime(630):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
11-20 19:14:56.446: E/AndroidRuntime(630):  ... 11 more
11-20 19:14:56.446: E/AndroidRuntime(630): Caused by: java.lang.NoSuchMethodException: ConnectFourView(Context,AttributeSet)
11-20 19:14:56.446: E/AndroidRuntime(630):  at java.lang.Class.getMatchingConstructor(Class.java:660)
11-20 19:14:56.446: E/AndroidRuntime(630):  at java.lang.Class.getConstructor(Class.java:477)
11-20 19:14:56.446: E/AndroidRuntime(630):  at android.view.LayoutInflater.createView(LayoutInflater.java:475)
11-20 19:14:56.446: E/AndroidRuntime(630):  ... 21 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:04:22.620

您需要 xml 中的实际类名：

```
<com.example.connectfour.view.ConnectFourView
 android:layout_width="fill_parent"
 android:layout_height="wrap_content"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:57:43.543

您的 XML 中的包名称错误。它不应该`com.example...`只是`example...`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:31:22.373

发现了答案。我在 ConnectFourView.java 中缺少以下代码

```
public ConnectFourView(Context context, AttributeSet attrs) {
    super(context, attrs);
    setMinimumWidth(100);
    setMinimumHeight(20);
} 
```

感谢所有帮助我发现这一点的人

# c# - 反编译 Dll - 代码有 4$0001 美元用于 vars

> ID：13479856
> 
> 赞同：-5
> 
> 时间：2012-11-20T18:36:55.463
> 
> 标签：c#, .net, asp.net-mvc-3

如果可能，我想编辑一个 dll 文件或提取内容并修改它们。

我使用 .Net Reflector 反编译和生成文件。

这很好用，除了一些文件有类似`CS$4$0001`而不是变量的东西。

还`<>g__initLocal31`

有没有办法找到那些是什么？还是我应该替换所有实例并进行测试？

添加：

```
 [OutputCache(NoStore=true, Location=OutputCacheLocation.Client, Duration=1)]
    public ActionResult _StateTile(string AssetName, string StateName)
    {
        aaReportsEntities dataContext;
        string CS$4$0001 = StateName;
        if (CS$4$0001 != null)
        {
            if (!(CS$4$0001 == "IDLE-UPSTREAM")) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T18:41:38.593

这些可以是：

*   局部变量（在 IL 中没有名称）
*   自动实现的属性/类字段事件的支持字段
*   任何编译器生成的字段（捕获上下文相关范围等）
*   表达式树/委托缓存
*   “动态”缓存
*   迭代器块/“等待”代码中的状态变量
*   等（同样，主要是编译器生成的任何东西）

它们很重要。但坦率地说，您可能不应该通过反射器提取代码：通常，如果您有这样做的理由，您已经拥有源代码（或被许可访问它）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:41:16.390

您无法取回变量名。T逆向工程非常难做，推荐这本书-http://www.amazon.co.uk/Reversing-Secrets-Engineering-Eldad-Eilam/dp/0764574817/ref=sr_1_1?ie=UTF8&qid=1353436851&sr= [8- 1](http://www.amazon.co.uk/Reversing-Secrets-Engineering-Eldad-Eilam/dp/0764574817/ref=sr_1_1?ie=UTF8&qid=1353436851&sr=8-1)

# android - 为什么我无法在 Android 上从此 JSON 文档中获取特定对象？

> ID：13479858
> 
> 赞同：0
> 
> 时间：2012-11-20T18:37:02.013
> 
> 标签：android, json, polyline

我想从 a 获取折线，`JSONObject`但以下代码不起作用。

```
JSONObject poly = steps.getJSONObject("polyline"); 
```

我收到此错误：

> org.json.JSONException：折线没有值

此代码工作正常

```
JSONArray legs = routes.getJSONArray("legs");
JSONObject steps = legs.getJSONObject(0);
JSONObject endLoc = steps.getJSONObject("end_location");
JSONObject duration = steps.getJSONObject("duration"); 
```

传入的 JSON 文档是

```
{
  "duration": {
    "value": 363,
    "text": "6 mins"
  },
  "distance": {
    "value": 506,
    "text": "0.5 km"
  },
  "end_location": {
    "lng": 11.48949,
    "lat": 53.52159
  },
  "start_address": "PCH30, 19079 Banzkow, Germany",
  "end_address": "PCH30, 19079 Banzkow, Germany",
  "start_location": {
    "lng": 11.48189,
    "lat": 53.52114
  },
  "via_waypoint": [

  ],
  "steps": [
    {
      "html_instructions": "Head <b>east<\/b> on <b>PCH30<\/b><div style=\"font-size:0.9em\">Destination will be on the left<\/div>",
      "duration": {
        "value": 363,
        "text": "6 mins"
      },
      "distance": {
        "value": 506,
        "text": "0.5 km"
      },
      "end_location": {
        "lng": 11.48949,
        "lat": 53.52159
      },
      "polyline": {
        "points": "cjteIypaeAGqBKaEGaBC{@A_AM{EMwGMwFIsDC}@"
      },
      "travel_mode": "WALKING",
      "start_location": {
        "lng": 11.48189,
        "lat": 53.52114
      }
    }
  ]
} 
```

以及获取的完整代码`JSONObject`

```
StringBuilder urlString = new StringBuilder();
urlString.append("http://maps.googleapis.com/maps/api/directions/json?");
urlString.append("origin=");// from
urlString.append(Double.toString((double) gpAlt.getLatitudeE6() / 1E6));
urlString.append(",");
urlString.append(Double.toString((double) gpAlt.getLongitudeE6() / 1E6));
urlString.append("&destination=");// to
urlString.append(Double.toString((double) gpNeu.getLatitudeE6() / 1E6));
urlString.append(",");
urlString.append(Double.toString((double) gpNeu.getLongitudeE6() / 1E6));
urlString.append("&mode=walking&sensor=true");
Log.d("xxx", "URL=" + urlString.toString());

urlConnection = null;
URL url = null;

url = new URL(urlString.toString());
urlConnection = (HttpURLConnection) url.openConnection();
urlConnection.setRequestMethod("GET");
urlConnection.setDoOutput(true);
urlConnection.setDoInput(true);
urlConnection.connect();

InputStream inStream = urlConnection.getInputStream();
BufferedReader bReader = new BufferedReader(new InputStreamReader(inStream));

String temp, response = "";
while ((temp = bReader.readLine()) != null) 
{
    response += temp;
}

bReader.close();
inStream.close();
urlConnection.disconnect();

JSONObject object = (JSONObject) new JSONTokener(response).nextValue();
JSONArray array = object.getJSONArray("routes");
JSONObject routes = array.getJSONObject(0);
String summary = routes.getString("summary");
JSONArray legs = routes.getJSONArray("legs");
JSONObject steps = legs.getJSONObject(0);
JSONObject poly = steps.getJSONObject("polyline"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T19:15:16.823

除非您在那里显示的 JSON 不正确，否则您需要做的是

```
JSONArray steps = routes.getJSONArray("steps");
JSONObject obj = steps.getJSONObject(0);
JSONObject poly = obj.getJSONObject("polyline"); 
```

# wcf - basicHttpBinding 上的 WCF 压缩

> ID：13479862
> 
> 赞同：2
> 
> 时间：2012-11-20T18:37:19.333
> 
> 标签：wcf, compression, gzip

尝试了一切以在 WCF 服务上启用压缩，但服务在 basicHttpBinding 上仍然没有成功，因此它将内容类型返回为**text/xml；字符集=utf-8**。在我的 applicationHost.config 添加大量动态类型：

```
<httpCompression directory="%SystemDrive%\inetpub\temp\IIS Temporary Compressed Files" doDiskSpaceLimiting="false" maxDiskSpaceUsage="100000" minFileSizeForComp="0" noCompressionForHttp10="false" noCompressionForProxies="false" noCompressionForRange="false" dynamicCompressionBufferLimit="6553600">
        <scheme name="gzip" dll="%Windir%\system32\inetsrv\gzip.dll" />
        <staticTypes>
            <add mimeType="message/*" enabled="true" />
            <add mimeType="application/x-javascript" enabled="true" />
            <add mimeType="application/atom+xml" enabled="true" />
            <add mimeType="application/xaml+xml" enabled="true" />
            <add mimeType="*/*" enabled="false" />
            <add mimeType="text/*" enabled="true" />
        </staticTypes>
        <dynamicTypes>
            <add mimeType="application/json" enabled="true" />
            <add mimeType="application/atom+xml" enabled="true" />
            <add mimeType="application/atom+xml;charset=utf-8" enabled="true" />
            <add mimeType="application/soap+xml" enabled="true" />
            <add mimeType="application/soap+xml; charset=utf-8" enabled="true" />
            <add mimeType="application/soap+xml; charset=ISO-8895-1" enabled="true" />
            <add mimeType="application/msbin1" enabled="true" />
            <add mimeType="text/*" enabled="true" />
            <add mimeType="message/*" enabled="true" />
            <add mimeType="Application/octet-stream" enabled="true" />
            <add mimeType="text/xml; charset=utf-8" enabled="true" />
            <add mimeType="application/xml; charset=utf-8" enabled="true" />
            <add mimeType="application/soap+msbin1" enabled="true" />
            <add mimeType="*/*" enabled="true" />
        </dynamicTypes>
    </httpCompression> 
```

在提琴手上： **请求：**

```
POST http://[omitted]/Service/ HTTP/1.1
Content-Type: text/xml; charset=utf-8
VsDebuggerCausalityData: uIDPo01MZ7JWHO9Kg43Hd3AGkiQAAAAASwm/c9G/206hW6j58tpV5waE+e97MShJvqGukMzMybEACQAA
SOAPAction: "http://tempuri.org/IService/GetCountries"
Host: [omitted]
Content-Length: 137
Expect: 100-continue
Accept-Encoding: gzip, deflate
Proxy-Connection: Keep-Alive 
```

**回复：**

```
HTTP/1.1 200 OK
Via: 1.1 PROXY
Connection: Keep-Alive
Proxy-Connection: Keep-Alive
Content-Length: 81623
Date: Tue, 20 Nov 2012 18:20:48 GMT
Content-Type: text/xml; charset=utf-8
Server: Microsoft-IIS/7.5
X-Powered-By: ASP.NET 
```

我还能做什么？

# .net - 使用 UDP 传输数据时，是否有必要将消息长度作为消息的一部分包含在内？

> ID：13479868
> 
> 赞同：0
> 
> 时间：2012-11-20T18:37:52.967
> 
> 标签：.net, udp, udpclient

我有一个客户希望将通过线路传输的字节数减少到绝对最小值。创建 udpClient 类并调用接收方法时，会返回一个字节数组。目前我正在使用 receiveBytes.Length 来获取消息中的字节数。

然而，在有多个消息进入的重负载下，有人建议这还不够，证明需要将数据包长度作为消息的前 2 个字节发送。

我可以依赖完整的数据包还是没有接收到数据包，从而依赖 Length 属性？

**编辑**

感谢所有的评论。

使用 UDP 是对 TCP 的补充。当我们需要实现顺序和保证时使用 TCP。UDP 将用于可以按任何顺序但不重要的数据。是的，我知道这意味着添加 OTT 加密。我的问题很简单，我能否只依赖完整的数据包到达。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:44:19.233

每个 UDP 数据包都是独立传送的，不保证任何其他数据包都会到达。

你怎么会（收到一个）知道等待另一个，如果它从未出现，你会怎么做？很长的一段话，你会收到发送的消息或根本没有。

# iphone - performSelector:withObject:afterDelay 方法不能正常工作？

> ID：13479869
> 
> 赞同：1
> 
> 时间：2012-11-20T18:37:55.657
> 
> 标签：iphone, objective-c, ios, methods, selector

我有一个带有一个小的 uiimageview 圆圈的应用程序，它淡入和淡出到两个不同的位置。当用户触摸屏幕时，我希望圆圈立即淡出，并且我希望它停止淡入和淡出移动位置。所以基本上触摸屏幕会杀死圆圈。

在圈子被杀死之后，虽然我希望另一个圈子产生并做同样的事情（淡入和淡出到 2 个不同的位置），直到用户触摸屏幕，然后我希望那个圈子被杀死，另一个圈子产生等等。 .

这是我的简化代码：

```
- (void)spawnCircle {
    self.circle = [[UIImageView alloc]initWithFrame:self.rectCircle];//alocate it and give it its first frame
    self.circle.image=[UIImage imageNamed:@"circle.png"];//make its image the circle image
    [self.view addSubView:self.circle];
    [self performSelector:@selector(fadeCircleOut)withObject:self afterDelay:2];//the circle will fade out after 2 seconds
    self.isFadeCircleOutNecessary=YES;
}

- (void)fadeCircleOut {

    if (self.isFadeCircleOutNecessary){//because after the circle fades in this method is scheduled to occur after 2 seconds, well, if the user has touched the screen within that time frame we obviously don't want this method to be called because we already are fading it out
        [UIView animateWithDuration:.5 delay:0 options:UIViewAnimationOptionCurveLinear animations:^{//the circle will fade out for a duration of .5 seconds
            self.circle.alpha=0;
        } completion:^(BOOL finished) {
            if (finished) {
                if (self.circle.frame.origin.x==self.rectCircle.origin.x) {//if its in the first location go to the second
                    self.circle.frame=self.rectCircle2;

                }else{//if its in the second location go to the first
                    self.circle.frame=self.rectCircle;
                }
                [self fadeCircleIn];//now were going to immediately fade it in its new location
            }
        }];
    }
}

- (void)fadeCircleIn {
    [UIView animateWithDuration:.5 delay:0 options:UIViewAnimationOptionCurveLinear animations:^{//fade it in with a duration of .5 seconds
        self.circle.alpha=1;
    } completion:^(BOOL finished) {
        if (finished) {
            [self performSelector:@selector(fadeCircleOut) withObject:self afterDelay:2];//after 2 seconds the object will fade out again
        }
    }];
}

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {

    [UIView animateWithDuration:.5 delay:0 options:UIViewAnimationCurveLinear|UIViewAnimationOptionBeginFromCurrentState animations:^(){ self.circle.alpha=0;} completion:^(BOOL completion){//begin from current state makes it stop any animations it is currently in the middle of

        [self spawnCircle];//now another circle will pop up
        self.isFadeCircleOutNecessary=NO;
    }];
}

- (void)viewDidLoad {
    [super viewDidLoad];
    [self spawnCircle];
} 
```

所以第一次生成圆圈时效果很好但是当下一个圆圈生成时（在用户触摸屏幕并杀死第一个圆圈之后）淡出方法不会在 2 秒后发生，它在发生时会有所不同，但通常几乎立即消失。所以延迟部分`performSelector:withObject:afterDelay`似乎无法正常工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:07:41.757

我尝试了您的代码，并得到了与您相同的结果。我不确定 performSelector:withObject:afterDelay: 在幕后发生了什么，但似乎一旦你开始使用它，它仍然可以执行它的功能，即使你已经创建了另一个圈子。

我通过去掉 afterDelay 调用稍微更改了代码，而是将 2 秒延迟放在淡出方法中。看看这是否符合您的要求：

```
-(void)spawnCircle{
    self.circle=[[UIImageView alloc]initWithFrame:self.rectCircle];//alocate it and give it its first frame
    self.circle.image=[UIImage imageNamed:@"circle.png"];//make its image the circle image
    [self.view addSubview:self.circle];
    [self fadeCircleOut];
}

- (void)fadeCircleOut {

    [UIView animateWithDuration:.5 delay:2 options:UIViewAnimationOptionCurveLinear animations:^{//the circle will fade out for a duration of .5 seconds
        self.circle.alpha=0;
    } completion:^(BOOL finished) {
        if (finished) {
            if (self.circle.frame.origin.x==self.rectCircle.origin.x) {//if its in the first location go to the second
                self.circle.frame=self.rectCircle2;

            }else{//if its in the second location go to the first
                self.circle.frame=self.rectCircle;
            }
            [self fadeCircleIn];//now were going to immediately fade it in its new location
        }
    }];
}

- (void)fadeCircleIn {
    [UIView animateWithDuration:.5 delay:0 options:UIViewAnimationOptionCurveLinear animations:^{//fade it in with a duration of .5 seconds
        self.circle.alpha=1;
    } completion:^(BOOL finished) {
        if (finished) {
            [self fadeCircleOut];
        }
    }];
}

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    [UIView animateWithDuration:.5 delay:0 options:UIViewAnimationCurveLinear|UIViewAnimationOptionBeginFromCurrentState animations:^{
        self.circle.alpha=0;
    }
                     completion:^(BOOL completion){//begin from current state makes it stop any animations it is currently in the middle of
                         [self.circle removeFromSuperview];
                         self.circle = nil;
                         [self spawnCircle];
    }];
} 
```

# php - 大块回显html正确方法的php语法

> ID：13479873
> 
> 赞同：0
> 
> 时间：2012-11-20T18:38:18.367
> 
> 标签：php, syntax, echo

大部分都在标题中。我想知道它是否应该是这样，或者我可以在没有`if(1)`条件的情况下做同样的事情，因为我的网站页面都是 php 包含的。

谢谢你们

保留答案：

好的，基本上这样做的方法就是简单地包含（'file.php'），因为它将被认为是当前`<?php ?>`环境之外的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T18:41:02.133

推杆

```
<?php if(1): ?>
    ...
<?php endif; ?> 
```

围绕 PHP 文件中的 HTML 代码对结果没有影响。没有它，您仍然可以访问`include`该文件。

您可以将其视为 PHP 文件的“默认模式”，即它包含 HTML 内容。`<?php ?>`如果你想添加 PHP 代码，你只需要添加标签。如果您只是将 HTML 代码放在 PHP 文件中，则它们是不必要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:46:31.160

PHP 的美妙之处在于您可以非常轻松地“移入”和“移出”PHP。您可以毫无问题地执行以下操作：

```
<?PHP 
if(whatever) {
?>

your HTML

<?php
include('whatever.php');
?>

more HTML

<?PHP
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:58:56.243

以 Zak 的回答为基础：

您也可以使用 PHP 来回显不是 PHP 的内容……只要您适当地引用它。

```
<?php 

//HTML 
while ($x < 5) {
 echo "<p> this is html that you can wrap with html tags! </p>";
 $x++;
}

//Javascript
echo "<script type='text/javascript'>
          some javascript code
       </script>"
?> 
```

虽然，仅仅结束 php 标记以保持事物分开并不那么令人困惑。

你甚至可以在 html 或 javascript 中随意使用 php，只要你放置标签，并且只要将文件保存为 .php 文件（这样 PHP 就可以在服务器上处理）。

前任：

```
<script type="text/javascript">
    //set a javascript image array to a php value
    var imgArray = [<?php echo implode(',', getImages()) ?>];
</script> 
```

但是如果你想反过来做（IE，分配一个浏览器编译的值，比如一个 javascript 值到一个 php 值），你就需要使用 AJAX。

# php - 数组键作为插入的mysql列名？

> ID：13479874
> 
> 赞同：4
> 
> 时间：2012-11-20T18:38:20.020
> 
> 标签：php, mysql

我正在使用一个以 json 格式返回搜索结果的 API。然后，我需要将其写入 MYSQL 表。我之前已经成功地做到了这一点，但这次情况有所不同，我认为这是因为结果数组的结构：键名是动态的，如果特定键不存在数据，则键不存在列在数组中。这是数组的示例 vardump：

```
array
  0 => 
    array
      'title' => string 'Funny but not funny' (length=19)
      'body' => string 'by Daniel Doi-yesterday while eating at Curry House...
      'url' => string 'http://danieldoi.com/2012/11/20/funny-but-not-funny/' 
      'source_site_name' => string 'WordPress.com' (length=13)
      'source_site_url' => string 'http://www.wordpress.com' (length=24)
      'query_topic' => string 'thanksgiving' (length=12)
      'query_string' => string 'blogs=on&topic=thanksgiving&output=json' (length=39)
  1 => 
    array
      'title' => string 'Travel Easy this Holiday Season...' (length=34)
      'body' => string 'Give yourself a few gifts and get this holiday season off...
      'url' => string 'http://facadebeauty.wordpress.com/2012/11/20
      'date_published' => string 'Tue, 20 Nov 2012 18:22:35 +0000' (length=31)
      'date_published_stamp' => string '1353435755' (length=10) 
```

请注意键的顺序/包含如何更改。

我提出的解决方案是使用数组键作为列名，将它们变成一个变量以在查询语句中使用，但这对我不起作用。这是我的尝试：

```
$jsonString = file_get_contents("http://search-query-URL&output=json");
$array = json_decode($jsonString, true);

// database connection code snipped out here

$table = "results";

foreach($array as $arr_value) {
        foreach ($arr_value as $value) {
          $colName = key($arr_value);
          $colValue = ($value);
          $insert="INSERT INTO $table ($colName) VALUES ('$colValue')";

          mysql_query($insert) OR die(mysql_error());
          next($arr_value);
              }
         } 
```

关于下一步看哪里的任何建议？谢谢！

**更新 11/27：**

在这里，我试图适应大卫的建议。我收到以下错误：“数据库连接错误 (1110) 列 'title' 在查询中指定了两次。”

这是我现在的代码：

```
$mysqli = mysqli_connect("localhost");
mysqli_select_db($mysqli, "mydatabase");

foreach ($array as $column) {
    foreach ($column as $key => $value) {
    $cols[] = $key;
    $vals[] = mysqli_real_escape_string($mysqli, $value);
    }
}

$colnames = "`".implode("`, `", $cols)."`";
$colvals = "'".implode("', '", $vals)."'";
$mysql = mysqli_query($mysqli, "INSERT INTO $table ($colnames) VALUES ($colvals)") or die('Database Connection Error ('.mysqli_errno($mysqli).') '.mysqli_error($mysqli). " on query: INSERT INTO $table ($colnames) VALUES ($colvals)");
mysqli_close($mysqli);
if ($mysql)
return TRUE;
else return FALSE; 
```

**最后更新 - 工作！**

它正在工作。这是我们所拥有的：

```
$mysqli = mysqli_connect("localhost");
mysqli_select_db($mysqli, "mydatabase");
  foreach ($array as $column) {
foreach ($column as $key => $value) {
    $cols[] = $key;
    $vals[] = mysqli_real_escape_string($mysqli, $value);
    }
  $colnames = "`".implode("`, `", $cols)."`";
  $colvals = "'".implode("', '", $vals)."'";
  $mysql = mysqli_query($mysqli, "INSERT INTO $table ($colnames) VALUES ($colvals)") or die('Database Connection Error ('.mysqli_errno($mysqli).') '.mysqli_error($mysqli). " on query: INSERT INTO $table ($colnames) VALUES ($colvals)");

  unset($cols, $vals);
}
  mysqli_close($mysqli);
if ($mysql)
return TRUE;
else return FALSE; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T18:47:05.860

我实际上只有这个功能，因为我一直在使用它。这是做什么的：将数组中的所有关联对汇集到表中，并将它们作为单个插入插入。需要明确的是：这不是您在上面所做的，因为看起来您正在尝试将每个值插入到它自己的插入中，这可能会给您提供比您想要的更多的行。

```
function mysqli_insert($table, $assoc) {
    $mysqli = mysqli_connect(PUT YOUR DB CREDENTIALS HERE);
    mysqli_select_db($mysqli, DATABASE NAME HERE);
    foreach ($assoc as $column => $value) {
        $cols[] = $column;
        $vals[] = mysqli_real_escape_string($mysqli, $value);
    }
    $colnames = "`".implode("`, `", $cols)."`";
    $colvals = "'".implode("', '", $vals)."'";
    $mysql = mysqli_query($mysqli, "INSERT INTO $table ($colnames) VALUES ($colvals)") or die('Database Connection Error ('.mysqli_errno($mysqli).') '.mysqli_error($mysqli). " on query: INSERT INTO $table ($colnames) VALUES ($colvals)");
    mysqli_close($mysqli);
    if ($mysql)
        return TRUE;
    else return FALSE;
} 
```

正如 MarcB 上面所说，您的目标表可能没有结果显示的列。但是我们正在清理插入（使用`mysqli_real_escape_string`），因此我们不应该遇到注入漏洞的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T17:02:11.520

这是单线：

```
$query = 'INSERT INTO '.$table.'(`'.implode('`, `', array_keys($array)).'`) VALUES("'.implode('", "', $array).'")'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:54:10.480

我注意到上面发布了一个答案，但是由于我已经写了这个，所以我想我会发布它。注意：我希望你相信你从哪里得到你的数据，否则这会带来各种各样的问题。我还在整个代码中添加了注释，希望有助于理解它是如何完成的。

```
$jsonString = file_get_contents("http://search-query-URL&output=json");
$array = json_decode($jsonString, true);

// database connection code snipped out here

$table = "results";

foreach($array as $sub_array) {
    // First, grab all keys and values in separate arrays
    $array_keys = array_keys($sub_array);
    $array_values = array_values($sub_array);

    // Build a list of keys which we'll insert as string in the sql query
    $sql_key_list = array();
    foreach ($array_keys as $key){
        $sql_key_list[] = "`$key`";
    }
    $sql_key_list = implode(',', $sql_key_list);

    // Build a list of values which we'll insert as string in the sql query
    $sql_value_list = array();
    foreach ($array_values as $value){
        $value = mysql_real_escape_string($value);
        $sql_value_list[] = "'$value'";
    }
    $sql_value_list = implode(',', $sql_value_list);

    // Build the query
    $insert = "INSERT INTO $table ($sql_key_list) VALUES ($sql_value_list)";
    mysql_query($insert) or die(mysql_error());
} 
```

# javascript - 带有 API 的 CRUD 应用程序（如何正确配置 API） - Ext-JS 4

> ID：13479880
> 
> 赞同：0
> 
> 时间：2012-11-20T18:38:35.523
> 
> 标签：javascript, extjs

我有一个有效的 CRUD 应用程序，但使用 U（更新）我有一个问题。

在我的商店里，我有：

```
...........

proxy: {
        type: 'ajax',
        api: {
            create  : '../mega_sabrina_cake/workers/create',
            read    : '../mega_sabrina_cake/workers/index',
            update  : '../mega_sabrina_cake/workers/update',
            destroy : '../mega_sabrina_cake/workers/delete'
        },
        actionMethods: {
            create  : 'POST',
            read    : 'POST',
            update  : 'POST',
            destroy : 'POST'
        },
        reader: {
            type: 'json',
            root: 'Worker',
            rootProperty: 'Worker',
            successProperty: 'success',
            messageProperty: 'message'
        },
        writer: {
            type: 'json',
            writeAllFields: true,
            root: 'data',
            encode: true
        },

........... 
```

提交表单进行编辑时，我指定了一个 url：

```
....
panel.getForm().submit({
            url: '../mega_sabrina_cake/workers/edit',
            success: function(form, action) {
            Ext.Msg.alert('Success', "The Worker has been edited!");

... 
```

那么，如何使用**商店中的 url**来避免将 url 放入表单中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:59:59.377

Form 不使用 store，它使用自己的 submit 方法与服务器通信。如果您想使用 Store 或 Model 代理（您可以在模型上定义与在商店中相同的代理配置），您可以执行以下操作：

form.updateRecord(record) 并使用 store.sync() 或[model.save()](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.Model-method-save)

这是您可以遵循的示例：[http ://docs.sencha.com/ext-js/4-1/#!/example/writer/writer.html](http://docs.sencha.com/ext-js/4-1/#!/example/writer/writer.html)

# c++ - qt 4.8.3 中的 Qt 资源系统错误

> ID：13479881
> 
> 赞同：2
> 
> 时间：2012-11-20T18:38:41.017
> 
> 标签：c++, qt

我在 Windows 8 Pro x64 上使用 Qt 4.8.3 开源和 Qt Creator 2.6.0。我使用的编译器是 MingW 4.4。

我有一个使用 Qt 4.8.0 构建的旧项目。该项目有一个名为`Resource.qrc`. 该项目在 Qt 4.8.0 中编译良好，我可以访问我在资源文件中提到的所有内容。

但是在 Qt 4.8.3 中我不能编译同一个项目。Qt 4.8.3 似乎无法编译资源文件。这是尝试编译`Resource.qrc`文件的输出部分：

```
bin\rcc.exe -name Resource ..\Source\Resource.qrc -o release\qrc_Resource.cpp
mingw32-make[1]: Leaving directory `E:/Programs/Version Control/Sources/Spadetrump/Release'
process_begin: CreateProcess(NULL, bin\rcc.exe -name Resource ..\Source\Resource.qrc -o release\qrc_Resource.cpp, ...) failed.
make (e=2): The system cannot find the file specified.
mingw32-make[1]: *** [release/qrc_Resource.cpp] Error 2
mingw32-make: *** [release] Error 2
00:08:10: The process "C:\MingW\bin\mingw32-make.exe" exited with code 2.
Error while building/deploying project Spadetrump (target: Desktop)
When executing step 'Make' 
```

这是一个干净的构建。如果我`rcc.exe`使用完全相同的参数和绝对路径执行，`qrc_Resource.cpp`则会生成。

我用一个全新的 Qt GUI 应用程序尝试了上述方法，结果是一样的。

知道 Qt 4.8.3 有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T13:15:39.233

使用相同的设置遇到与您完全相同的问题，期望 Windows 版本对我来说是 xp。问题是找不到 rcc.exe，因为该调用使用了不正确的路径。

qt-projects 有一个针对此问题的错误报告：[https ://bugreports.qt.io/browse/QTBUG-27237](https://bugreports.qt.io/browse/QTBUG-27237)

Daniel Frömmel 提出的解决方法对我有用：

> 1) 打开平台的 qmake.conf (对我来说是 C:\Qt\4.8.3\mkspecs\win32-g++)
> 2) 搜索 QMAKE_IDC
> 3) 在 QMAKE_IDC 行之后添加以下行：QMAKE_RCC = $$[ QT_INSTALL_BINS]$${DIR_SEPARATOR}rcc.exe
> 4) 保存文件并 clsoe
> 5) 重新启动所有开发工具并删除所有自动生成的 Makefile
> 6) 重新编译

# javascript - removeAttr 摆脱标题在 IE 中不起作用

> ID：13479886
> 
> 赞同：0
> 
> 时间：2012-11-20T18:39:01.500
> 
> 标签：javascript, jquery, tooltip

我正在尝试从链接中删除标题属性并将其重用于工具提示，这是给我带来麻烦的代码片段：

```
 $('.location').each(function() {
    var $this = $(this);
    $this
      .data('title', $this.attr('title'))
      .removeAttr('title');
  });

$('.location').hover(function(e) {
    //hover over code   

    //grabs what's inside the title attribute in the html
    var titleText = $(this).data('title');

    //saves the tooltip text using the data method, so that the orignal tooltip text does not conflict
    $(this)
        .data('tipText', titleText)
        .removeAttr('title'); 
```

我在此处搜索包含以下代码：

```
 $('.location').each(function() {
    var $this = $(this);
    $this
      .data('title', $this.attr('title'))
      .removeAttr('title');
  }); 
```

这很好用，但只有一次，如果我回到 IE8 中的链接，原来的工具提示会重新出现。有什么解决方案吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:48:39.560

~~您是否可以将**标题attr 更改为****title**以外的内容？我认为**标题**是保留字，可能会导致一些问题。~~

~~非~~工作：（用下面的代码更新，现在工作）

[http://jsfiddle.net/abZ6j/3/](http://jsfiddle.net/abZ6j/3/)

```
<a href="#" title="foo" class="location">Test Link</a>​

$('.location').each(function() {
    var $this = $(this);
    $this
        .data('title', $this.attr('title'))
        .removeAttr('title');
});​ 
```

在职的：

[http://jsfiddle.net/abZ6j/1/](http://jsfiddle.net/abZ6j/1/)

```
<a href="#" linkTitle="foo" class="location">Test Link</a>​

$('.location').each(function() {
    var $this = $(this);
    $this
        .data('title', $this.attr('linkTitle'))
        .removeAttr('linkTitle');
});​ 
```

**更新：**

实际上，仔细观察，您可以使用**title**，但在这个特定的例子中，最好在 $.data() 之外访问它。也许是这样的：

```
var $this = $(this);
var t = $this.attr('title');
$this
  .data('title', t)
  .removeAttr('title'); 
```

*   更新了“非工作”jsFiddle 代码以反映上述内容。

# ruby-on-rails - Capybara 测试中的 Sendgrid 错误

> ID：13479887
> 
> 赞同：5
> 
> 时间：2012-11-20T18:39:08.387
> 
> 标签：ruby-on-rails, ruby-on-rails-3, email, testing, rspec

我正在尝试将测试追溯应用到一个非常复杂的应用程序（再也不会）。我已经内置了 Sendgrid 功能，可以在新用户注册时向他们发送电子邮件。结果，当我尝试测试注册页面时，它尝试向我的 example@example.net 电子邮件发送一条消息，我收到以下错误：

```
Net::SMTPFatalError:
550 Cannot receive from specified address <my app's email>: Unauthenticated senders not allowed 
```

不过，我不清楚这是我如何进行测试的问题（我遗漏了一些东西——我是新人），还是更深层次的问题。自从我从 GMail 切换到 Sendgrid 后，我的应用程序在服务器上使用它时应该发送的电子邮件出现了错误，尽管不是在线的。我将其归结为 Sendgrid 是一个专门的基于 Web 应用程序的电子邮件服务，但现在我猜我在配置文件中做错了。我设置配置的方式是这样的：

初始化程序/mail.rb

```
# SendGrid Settings
ActionMailer::Base.smtp_settings = {
  :address        => 'smtp.sendgrid.net',
  :port           => '587',
  :authentication => :plain,
  :user_name      => ENV['SENDGRID_USERNAME'],
  :password       => ENV['SENDGRID_PASSWORD'],
  :domain         => 'heroku.com'
}
ActionMailer::Base.delivery_method = :smtp 
```

我的 environment.rb 文件中没有任何内容。[这个](https://stackoverflow.com/questions/8782274/sendgrid-email-sending-issues-in-ruby-on-rails-hosted-on-heroku)问题表明，也许我应该将这些设置切换到 environment.rb 文件中，但是（显然，我不太了解配置文件），我想知道是否应该为 development.rb 设置单独的设置，测试.rb 等（另外，我尝试了那个开关，但它并没有改变错误）。此外，如果 capybara/rspec 有一种解决方法可以在测试期间忽略电子邮件请求（或者以某种方式处理它是一个假电子邮件地址并在不尝试发送的情况下测试电子邮件）。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T19:53:21.167

您应该能够通过配置将 ActionMailer 设置为测试模式：

```
config.action_mailer.delivery_method = :test 
```

或在您的测试中：

```
ActionMailer::Base.delivery_method = :test 
```

您还可以找到有关[测试邮件的更多信息](http://guides.rubyonrails.org/action_mailer_basics.html#mailer-testing)

# java - 如何使两个项目可以访问 Java 代码

> ID：13479888
> 
> 赞同：1
> 
> 时间：2012-11-20T18:39:08.767
> 
> 标签：java, intellij-idea

这里是Java新手。我在 IntelliJ IDEA 11.1 中创建了一个小型桌面应用程序。它由几个带有类的 java 文件和主应用程序文件 Main.java 组成。我想制作另一个应用程序，它使用相同的类但不同的主文件。我希望能够更改两个项目的类源代码。因此，我希望有一个类似的结构：

```
IdeaProjects\lib/myclasses\*.java (or similar with additional src if recommended)
IdeaProjects\project1\src\Main.java
IdeaProjects\project2\src\Main.java 
```

我该如何正确地做到这一点？我已经阅读了很多关于模块、库、罐子的内容，但现在我迷路了:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:45:05.297

I don't use IntelliJ so I can not help you specifically but You should create one project containing the shared resources and per program another project containing you Main files. Compile this first project into a jar file so you can use it as a library in the projects containing the main files.

In eclipse You can add other projects to your classPath. Maybe this is also possible in IntellyJ.

# javascript - 切换（函数）中的 AJAX 下拉菜单仅有效一次

> ID：13479890
> 
> 赞同：2
> 
> 时间：2012-11-20T18:39:13.363
> 
> 标签：javascript, ajax, drop-down-menu, toggle

我有一个动态添加行的表。

在其中一个单元格中，我想在下拉列表和输入框之间切换。

下拉列表是通过 AJAX 加载的 PHP 文件。问题是下拉菜单只呈现一次。第一次单击切换按钮时，会出现下拉菜单，因为它应该。第二次单击将其切换到输入字段，因为它应该。第三次单击什么也不做，它只是停留在输入框上，不会切换回下拉菜单。

如果我注释掉 AJAX 调用并放入一个简单的下拉列表，它就可以来回切换。所以我认为问题出在 AJAX 部分。

链接到[http://jsfiddle.net/6h5BD/1/](http://jsfiddle.net/6h5BD/1/) 注意：AJAX 目前在 jsfiddle 中被注释掉并替换为临时下拉列表，因此您可以看到我正在寻找的结果。

有问题的JS部分：

```
 $('input[name="button"]').toggle(function() {
      $.ajax({
            url: 'http://localhost/brandDropdown.php',
            type:'POST',
            dataType: 'html',
            success: function(output_string){
            $('#brand').html(output_string);
             } 
      }); 
   }, function() {
       $(this).closest('td').prev().html("<input type=\"text\" name=\"itemBrand[]\" id=\"itemBrand\" size=\"10\" placeholder=\"New Brand\" style=\"text-transform: uppercase\"/>");
 }); 
```

PHP：

```
 $sqlbrand = "SELECT BRD_Name FROM Brands ORDER BY BRD_Name asc";
  $resultbrand = odbc_exec($conn, $sqlbrand);
  ECHO "<select name='itemBrand[]' style='width:120px' size='1'>";
  while ($rowbrand = odbc_fetch_array($resultbrand)) {
      echo "<option value='".$rowbrand['BRD_Name']."'>".$rowbrand['BRD_Name']."</option>";
  }
  echo "</select></td>"; 
```

我非常愿意以不同的方式处理这个问题。我尝试了几种不同的方法，但无济于事。

预先感谢您对此问题的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:56:27.413

如果我看不到 PHP 文件，我无法完全帮助您调试。

但是从 HTML/JS 我可以看到一个潜在的问题。您正在选择**$("#brand")**并将 html 更改为 output_string。但是当你克隆你的行时，你会创建多个**id**为 #brand 的 div，并且**id**应该是唯一的，你应该使用**class**代替。

如果这行得通，你可以试试吗？

```
$('input[name="button"]').toggle(function() {
      var $this = $(this);
      $.ajax({
            url: 'http://localhost/brandDropdown.php',
            type:'POST',
            dataType: 'html',
            success: function(output_string){
                 $this.closest('td').prev().html(output_string);
            } 
      }); 
   }, function() {
       $(this).closest('td').prev().html("<input type=\"text\" name=\"itemBrand[]\" id=\"itemBrand\" size=\"10\" placeholder=\"New Brand\" style=\"text-transform: uppercase\"/>");
 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:15:00.137

在您的代码中（在小提琴中）

```
$(this).closest('td').prev().html(...) 
```

应该

```
$(this).closest('td').prev().find('#brand').html(...) 
```

because `$(this).closest('td').prev().html(...)` is replacing the html of `td` which means it's just removing the `div` with id `#brand` from within the `td` so in your `ajax` success callback `$('#brand').html(output_string);` is not working because it's not inside the `td` once you toggled it.

# c++ - C++ Visual Studio mysqlpp 严重内存泄漏

> ID：13479891
> 
> 赞同：1
> 
> 时间：2012-11-20T18:39:18.080
> 
> 标签：c++, memory-leaks, visual-studio-2005, mysqlpp

在过去的一个月里，我一直在为此挠头，但我仍然无法弄清楚发生了什么。

问题是我在使用 Visual Studio 2005 编译的 Windows Server 2008 上运行的 C++ 应用程序上存在非常严重的内存泄漏。这是一个托管项目。该应用程序从大约 5-6MB 开始（根据任务管理器），并在 ~200MB 左右开始出现故障症状。我知道任务管理器是一个粗糙的工具，但考虑到泄漏的规模，它似乎可以使用。

我已将问题缩小到 MySQL 数据库交互。如果应用程序不与数据库交互，则不会泄漏内存。

所有数据库交互都使用 mysql++。我已按照 tangentsoft.net 手册页中的构建说明进行操作。

我们已经评估了代码的线程安全性（也就是说，我们确保每个线程只使用来自该线程的 mysqlpp 对象而不使用其他线程）并检查以确保为使用“new”创建的任何动态生成的对象调用所有析构函数。

在互联网上，我不断看到来自 mysqlpp 类用户的各种报告，这些报告表明某处存在泄漏。特别是，有人讨论了使用 mysqlpp 时 Win C API 会如何泄漏：

[http://www.phpmarks.com/6-mysql-plus/ffd713579bbb1c3e.htm](http://www.phpmarks.com/6-mysql-plus/ffd713579bbb1c3e.htm)

这个讨论似乎在修复中结束，但是，当我在我的应用程序中尝试修复时，它仍然泄漏。

我实现了上面线程中引用的应用程序的一个版本，但添加了一些来自手册页的建议：

```
int _tmain(int argc, TCHAR* argv[], TCHAR* envp[])
{
    while (true)
    {
        //Initialise MySQL API
        mysql_library_init(0, NULL, NULL);

        Sleep(50);        
        //Connect to Database.
        mysqlpp::Connection c;        
        c.connect("myDatabase","localhost","username","password");

        Sleep(50);
        //Disconnect from Database
        c.disconnect();

        Sleep(50);
        //Free memory allocated to the heap for this thread
        c.thread_end();

        Sleep(50);
        //Free any memory allocated by MySQL C API
        mysql_library_end();

        Sleep(50);
    }
    return 1;
} 
```

我添加了 Sleep(50) 只是为了限制循环的每个阶段，以便每个函数都有时间“安定下来”。我知道这可能没有必要，但至少这样我可以消除它作为一个原因。

然而，这个程序泄漏得非常快（每小时约 1mb）。

我在几个地方看到过与我类似的问题，但没有得出任何结论:(

所以我并不孤单。我突然想到 mysqlpp 类以有用而闻名，因此必须非常健壮。鉴于这种情况，我仍然看不出我做错了什么。有没有人有一些使用 Visual Studio 2005 的 mysqlpp 经验，可能会阐明这个问题？

干杯，亚当。

**编辑**

我使用指针创建了另一个示例，以防 c 在循环中被复制：

```
//LEAKY
int _tmain(int argc, TCHAR* argv[], TCHAR* envp[])
{
    mysqlpp::Connection * c;

    while (true)
    {
        mysql_library_init(0, NULL, NULL);

        c = new mysqlpp::Connection;

        Sleep(50);

        c->connect("myDatabase","localhost","username","password");

        Sleep(50);
        c->disconnect();

        Sleep(50);
        c->thread_end();

        Sleep(50);
        mysql_library_end();

        Sleep(50);

        delete c;
        c = NULL;
    }       
    return 1;
} 
```

这也泄漏了。然后我根据这段代码创建了一个控制示例，它根本不会泄漏：

```
//NOT LEAKY
int _tmain(int argc, TCHAR* argv[], TCHAR* envp[])
{
    char * ch;

    while (true)
    {
        mysql_library_init(0, NULL, NULL);

        //Allocate 4000 bytes
        ch = new char [4000];

        Sleep(250);

        mysql_library_end();

        delete ch;
        ch = NULL;

    }
return 1;
} 
```

请注意，我还在此处留下了对 MySQL C API 的调用，以证明这不是泄漏的原因。然后，我使用指针创建了一个示例，但没有调用连接/断开连接：

```
//NOT LEAKY
int _tmain(int argc, TCHAR* argv[], TCHAR* envp[])
{

    mysqlpp::Connection * c;

    while (true)
    {
        mysql_library_init(0, NULL, NULL);

        c = new mysqlpp::Connection;
        Sleep(250);

        mysql_library_end();

        delete c;
        c = NULL;
    }

return 1;
} 
```

这不会泄漏。

所以区别只是使用 mysqlpp::connect / disconnect 方法。我将深入研究 mysqlpp 类本身并尝试看看发生了什么。

干杯，亚当。

**编辑**

这是进行检查的泄漏代码的示例。

```
//LEAKY
int _tmain(int argc, TCHAR* argv[], TCHAR* envp[])
{
    mysqlpp::Connection * c;

    while (true)
    {
        mysql_library_init(0, NULL, NULL);

        c = new mysqlpp::Connection;

        Sleep(50);

        if ( c->connect("myDatabase","localhost","username","password") == false )
        {
            cout << "Connection Failure";
            return 0;
        }

        Sleep(50);
        c->disconnect();

        Sleep(50);
        c->thread_end();

        Sleep(50);
        mysql_library_end();

        Sleep(50);

        delete c;
        c = NULL;
    }       
return 1;
} 
```

干杯，亚当。

# java - 单击按钮时如何返回数字

> ID：13479894
> 
> 赞同：1
> 
> 时间：2012-11-20T18:39:24.367
> 
> 标签：java, swing, jbutton, actionlistener

我的问题是当数字是从数组列表中获取时，例如 `JNumber.size()=10`；

```
 for(int a=0;a<JNumber.size();a++)
    {
         btnNumber= new JNumber(""+(a+1));
         btnNumber.setPreferredSize(new Dimension(20, 10));
         panel.setLayout(new GridLayout(10,10));
         panel.add(btnNumber, BorderLayout.SOUTH);
    } 
```

那么如何在点击按钮时返回数字呢？

> 输出：
> 
> 数字 2 被点击。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:51:16.347

您可以在 ActionListener 中执行此操作。使用给定的代码，这应该适用于您的情况：

如果您想要显示的文本不仅是数字，则使用特定文本初始化按钮并将按钮的 actioncommand 设置为实际数字。（见下文。）

```
btnNumber= new JNumber(""+(a+1));
btnNumber.setActionCommand(""+(a+1));    
btnNumber.addActionListener(new ActionListener() {
      public void actionPerformed(ActionEvent e) {
        JButton button = (JButton)evt.getSource();
        int num = Integer.parseInt(button.getActionCommand());
        System.out.println(num);
      }
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T19:59:22.393

这是一个小例子，希望对您有所帮助。基本上只需将`JButton`s 添加到`JPanel`，添加`ActionListener`到每个`JButton`，添加`JPanel`到`JFrame`，单击按钮后，`println()`将使用 ActionCommand 执行`JButton`（+1 到 @Pr0gr4mm3r 以供`setActionCommand()`使用）：

![在此处输入图像描述](../Images/3804bfc93c1aa9ed48e12a4c7c6ddebd.png)

```
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;

public class ButtonsTest {

    public ButtonsTest() {
        initComponents();
    }

    private void initComponents() {

        JFrame frame = new JFrame("Test");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel panel = new JPanel(new GridLayout(2, 2));//create gridlayput to hold buttons

        ActionListener al = new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent ae) {
                //display action command of jbutton
                String ac = ((JButton) ae.getSource()).getActionCommand();
                System.out.println(ac);
                //display full test in Jbutton
                //String text = ((JButton) ae.getSource()).getText();
                //System.out.println(text);
            }
        };

        for (int i = 0; i < 4; i++) {
            JButton b = new JButton("No: " + String.valueOf((i + 1)));
            b.setActionCommand(String.valueOf((i + 1)));
            b.addActionListener(al);
            panel.add(b);
        }

        frame.add(panel);

        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        //set L&F and create UI on EDT
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {

                try {//set L&F
                    for (UIManager.LookAndFeelInfo info : UIManager.getInstalledLookAndFeels()) {
                        if ("Nimbus".equals(info.getName())) {
                            UIManager.setLookAndFeel(info.getClassName());
                            break;
                        }
                    }
                } catch (Exception e) {
                    // If Nimbus is not available, you can set the GUI to another look and feel.
                }
                //create UI
                new ButtonsTest();
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:44:40.343

Declare `btnNumber` as `final` and add an `ActionListener` to it:

```
btnNumber.addActionListener(new ActionListener() {
  public void actionPerformed(ActionEvent e) {
    System.out.println("Number " + btnNumber.getText() + " is clicked");
  }
}); 
```

# email - magento 1.7.2 没有发送电子邮件

> ID：13479895
> 
> 赞同：0
> 
> 时间：2012-11-20T18:39:32.317
> 
> 标签：email, magento, smtp

我使用 magento 已经很长时间了，我从来没有遇到过无法发送电子邮件的问题。虽然我现在在 magento 1.7.2 上经营一家商店，但我遇到了新订单不发送电子邮件的问题。我所有的设置都和 magento 1.7 完全一样

# linux - 想知道脚本结果的pid

> ID：13479898
> 
> 赞同：0
> 
> 时间：2012-11-20T18:39:52.587
> 
> 标签：linux, bash, shell, wait, pid

./abcd.sh #这个脚本负责运行一个java代码在/tmp/abcd/中创建一个zip文件

有时 abcd.sh 脚本需要 30 秒来创建 zip 文件，有时需要 60 秒来创建。

由于我没有编辑 abcd.sh 文件的权限，我编写了这段代码来获取 ./abcd.sh 的 pid，但不知道如何获取其子进程的 pid。

```
./abcd.sh &
pid=$!
wait $pid 
```

此代码正在等待 ./abcd.sh 执行，但它不等到 zip 文件完成。

有什么办法可以等到 zip 文件创建？我的想法是，如果我们知道创建 zip 文件的 pid，我们可以使用 wait $zipfilepid，但不知道如何获取创建 zip 文件的 pid。

```
.abcd.sh 
sleep 60 
```

我知道**sleep**是一种替代方法，但即使创建了 zip 文件，我也不想等待。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:15:04.927

如果您知道“zip”程序的名称，您可以在进程列表中找到它，然后确定它的进程 ID。假设您正在等待的进程名称只是“zip”，您可以使用如下内容：

```
PROCNAME="zip"
PROCRUN=`ps h -ef|egrep -e "$PROCNAME"|grep -v " $$ "`
PIDS=`echo "$PROCRUN"|tr -s " "|cut -d" " -f2`
wait $PIDS 
```

这将适用于多个 PID。您可能需要更改`PROCNAME`变量的值以更好地针对特定流程，例如：

```
PROCNAME=" zip "
PROCNAME="zip name-of-file-to-zip"
PROCNAME="zipscriptname" 
```

...ETC。希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T19:57:25.647

在做了一些研究之后，我得出一个结论，这种方法可能是不可能的，因为我无法控制创建 zip 文件的 java 代码和实例化运行 java 代码的 shell 脚本（abcd.sh）。

我采取的方法是：

1.  使用 找出 zip 文件是否仍在写入/打开，如果文件正在写入/打开，我`/usr/sbin/lsof /path/to/zip/abcd.zip`会使用此命令，如果文件完成/关闭，我会得到。`$? 0``$? 1`
2.  进入`$?`while循环，如果`$? -eq 0`进入睡眠状态，则退出程序。

`/usr/sbin/lsof /path/to/zip/abcd.zip
rc=$?
while [ $rc -eq 0 ]
do
echo "Zip file is still creating, sleeping for 3 seconds"
sleep 3
done`

如果您有更好的方法，请告诉我。

# javascript - CSS 'translate(0px, 0px)' off element style 的正则表达式匹配值

> ID：13479899
> 
> 赞同：0
> 
> 时间：2012-11-20T18:39:54.490
> 
> 标签：javascript, css, regex, match, translate

给定一个样式属性字符串，我需要捕获 CSS`translate()`属性的 x 和 y 值。数字可以是零、正数或负数、浮点数或整数，并且只能是像素单位。

一个实用的样式属性字符串示例：

```
min-height: 100%;
min-width: 100%;
transition-property: transform;
transform-origin: 0px 0px;
transform: translate(123px, 0px) translateZ(0px); 
```

我有一个可行的，虽然*非常*丑陋的解决方案。这是一个细分：

`var transform = element.style['transform']`-`transform`变量然后包含这个字符串：`"translate(123px, 0px) translateZ(0px)"`

然后我将它与：

```
transform = transform.match(/translate\(-?[0-9]+(\.[0-9]*)?px, -?[0-9]+(\.[0-9]*)?px\)/); 
```

我这样做是因为如果有另一个转换属性，`rotate(20px, 20px)`例如，我可以避免它。

正则表达式产生这个数组：`["translate(123px, 0px)", undefined, undefined]`.

然后按顺序使用另一个正则表达式，以仅匹配数值：

```
transform = transform[0].match(/(-?[0-9]+(\.[0-9]*)?)px, (-?[0-9]+(\.[0-9]*)?)px/); 
```

然后我剩下以下数组：`["123px, 0px", "123", undefined, "0", undefined]`

并完成我需要做的一切，`parseInt(transform[1])`并`parseInt(transform[3])`实际使用这些价值观。

仅获取这两个数字似乎工作量太大，但是我对正则表达式的经验不是很丰富，而且我不知道如何简化这一点。有没有更优雅的解决方案？

编辑：我会特别乐意把它全部变成一个正则表达式:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:48:35.777

您可以将组标记为非捕获`(?:.)`不会作为捕获，但在其他方面表现正常。和`\d`是一样的`[0-9]`。但也因为无论如何这必须是有效的 CSS，您可以假定数据无论如何都是有效的整数/浮点数，并且不必进行可选的捕获（如果您不想）。

我会做：

```
transform = transform[0].match(/(-?[.\d]+)px, (-?[.\d]+)px/); 
```

或者，对于可选小数点的非捕获组：

```
transform = transform[0].match(/(-?\d+(?:\.\d+)?)px, (-?\d+(?:\.\d+)?)px/); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:49:46.833

您可以通过执行以下操作将这两个步骤合二为一：

```
transform = transform.match(/translate\((-?\d+(?:\.\d*)?)px, (-?\d+(?:\.\d*)?)px\)/); 
```

或者，如果您相信您的输入，您可以执行以下操作：

```
transform = transform.match(/translate\((.*)px, (.*)px\)/); 
```

简化您的正则表达式。

# amazon-web-services - Drupal 与亚马逊网络服务？

> ID：13479902
> 
> 赞同：4
> 
> 时间：2012-11-20T18:40:05.663
> 
> 标签：amazon-web-services, drupal, web-applications, hosting, cloudways

我不确定这是否是写作的地方，但这是我知道的唯一一个可以回答我的问题的网站......无论如何

我想安装drupal，但我应该在哪里托管它？亚马逊网络服务可以托管这样的应用程序吗？我需要去其他地方托管吗？我确实有一个 inmotionhosting 帐户，但我在想如果亚马逊能完成这项工作，为什么不直接使用它呢？有什么想法和意见吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-03-18T07:42:54.643

如果您有系统管理员经验，您可以在 AWS EC2 上安装 Drupal。否则，您将需要为此使用托管平台，例如 Cloudways。在 AWS 上配置 Apache 和 Nginx 等 Web 服务器、Varnish 和 Memcached 等缓存以及其他功能并不困难。许多托管服务器在其平台中提供了这些功能，因此您无需配置任何内容或在 AWS 上安装应用程序的漫长过程。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T18:49:57.643

Amazon Web Services (AWS) 将托管 Drupal 没有问题。

您正在寻找的服务是[Amazon Elastic Compute Cloud (Amazon EC2)](http://aws.amazon.com/ec2/)。它几乎相当于一个私人服务器，您可以使用它做几乎任何您想做的事情（包括 Web 托管）。缺点是您必须自己完成所有设置。

如果您不知道如何安装 Apache 或配置您自己的 Linux 机器，那么您最好使用托管主机，他们会为您设置一切。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-05-11T14:41:26.903

您也可以只使用 AWS Cloudformation 来设置您的 drupal 环境。它是 AWS 的一部分，可为您设置堆栈。您可能仍然需要知道如何处理您的配置文件，但至少您不必手动安装 DB、Apache 等。 [http://aws.amazon.com/cloudformation/](http://aws.amazon.com/cloudformation/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-04-12T02:46:23.017

Bitnami 为您轻松启动的 AWS提供免费（Apache 许可）预构建[Drupal 映像。](http://bitnami.com/stack/drupal/cloud)它非常适合快速测试某些东西，但如果您为预期负载选择正确的实例，也适用于生产（免责声明：我是 Bitnami 的联合创始人，尽管正如我提到的图像是开源的）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-06-14T09:53:22.840

Drupal 可以[在 Jelastic PaaS 上自动](https://jelastic.com/install-application/?manifest=https%3A%2F%2Fgithub.com%2Fjelastic-jps%2Fdrupal%2Fraw%2Fmaster%2Fmanifest.jps)部署和托管。您无需从头开始配置它。如果您希望在安装时进行一些自定义设置，您也可以轻松地手动安装。[指南](https://jelastic.com/blog/how-to-install-drupal-cms-to-the-cloud/)中描述了这两种变体。

因此，您将获得自动扩展、按使用付费定价、通过直观的 UI 进行管理、来自不同国家的广泛选择的本地服务提供商以及其他选项来有效地运行您的 Drupal。

# python - 使用正则表达式从文本中提取类别

> ID：13479903
> 
> 赞同：0
> 
> 时间：2012-11-20T18:40:08.360
> 
> 标签：python, regex

我是在 python 中使用正则表达式的新手。我无法弄清楚如何执行以下操作：

我有一堆文本描述作为字符串，如下所示：

```
FX0XST001ALF89  OLIGO: Bacillus_cand1=ATGCGGTTCAAAATGTTATC      
FILE:/home/AAFC-AAC/fungs/biodiversity/pipelines/454PipelineOutput/v7_newest_testrun_full/rs75/plate1/FX0XST001.MID13/FX0XST001.MID13.sff.trim.fasta    
Project: SAGES  SFF: FX0XST001  SFF.MID: FX0XST001.MID13    
Plate: 1.1     MID_all: MID13   MID: 13 Sample: BK104   
Collector: BK   Year: 2008  Week:   Year_Week:  
Location: Ottawa_ON     City: Ottawa    Province: ON    Crop:   
Treatment:    Substrate_all: Air    Substrate: Air  Target: Bacteria    
Forward Primer: Bac16S27F   Reverse Primer: Bac16S690R  Taq: T 
```

我希望能够提取这个大字符串中的类别并将它们存储到数据库或其他东西中，例如：

```
Year: 2008
Sample: BK104
Collector: BK

etc... 
```

如何在 python 中使用正则表达式来实现这一点？

我正在考虑使用搜索：

```
match = re.search(r'Sample:\w\w\w\w\w', theTextDescription) 
```

问题是每个“字段”中的文本长度不同。我真的不知道如何考虑到这一点

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:43:00.357

something like this, you can use `\w+` to match characters to any number of length:

```
In [37]: strs
Out[37]: 'FX0XST001ALF89  OLIGO: Bacillus_cand1=ATGCGGTTCAAAATGTTATC      \nFILE:/home/AAFC-AAC/fungs/biodiversity/pipelines/454PipelineOutput/v7_newest_testrun_full/rs75/plate1/FX0XST001.MID13/FX0XST001.MID13.sff.trim.fasta    \nProject: SAGES  SFF: FX0XST001  SFF.MID: FX0XST001.MID13    \nPlate: 1.1     MID_all: MID13   MID: 13 Sample: BK104   \nCollector: BK   Year: 2008  Week:   Year_Week:  \nLocation: Ottawa_ON     City: Ottawa    Province: ON    Crop:   \nTreatment:    Substrate_all: Air    Substrate: Air  Target: Bacteria    \nForward Primer: Bac16S27F   Reverse Primer: Bac16S690R  Taq: T'

In [38]: re.findall(r"\w+:\s\w+",strs)
Out[38]: 
['OLIGO: Bacillus_cand1',
 'Project: SAGES',
 'SFF: FX0XST001',
 'MID: FX0XST001',
 'Plate: 1',
 'MID_all: MID13',
 'MID: 13',
 'Sample: BK104',
 'Collector: BK',
 'Year: 2008',
 'Location: Ottawa_ON',
 'City: Ottawa',
 'Province: ON',
 'Substrate_all: Air',
 'Substrate: Air',
 'Target: Bacteria',
 'Primer: Bac16S27F',
 'Primer: Bac16S690R',
 'Taq: T'] 
```

or may be store it in a dictionary:

```
In [39]: dict(x.split(":") for x in  re.findall(r"\w+:\s\w+",strs))
Out[39]: 
{'City': ' Ottawa',
 'Collector': ' BK',
 'Location': ' Ottawa_ON',
 'MID': ' 13',
 'MID_all': ' MID13',
 'OLIGO': ' Bacillus_cand1',
 'Plate': ' 1',
 'Primer': ' Bac16S690R',
 'Project': ' SAGES',
 'Province': ' ON',
 'SFF': ' FX0XST001',
 'Sample': ' BK104',
 'Substrate': ' Air',
 'Substrate_all': ' Air',
 'Taq': ' T',
 'Target': ' Bacteria',
 'Year': ' 2008'} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:42:55.603

Make use of the quantifiers of the regex language:

`?` = 0 or 1

`*` = 0 or more

`+` = 1 or more

```
match = re.search(r'Sample:\s\w+', theTextDescription) 
```

# javascript - 如何在找到第一个匹配项时停止 DOM 搜索循环？

> ID：13479915
> 
> 赞同：0
> 
> 时间：2012-11-20T18:40:48.217
> 
> 标签：javascript, dom, loops, replace, nodes

我已经修改了一个 dom 搜索/替换脚本，以通过链接替换文档中匹配的多个关键字。

它在没有任何`<div>`or的情况下工作得很好`<p>`，但是由于结构复杂，每个节点的关键字都被替换了......

这是一个[例子](http://jsfiddle.net/FRyjK/1/)

正如你所看到的，同一个关键字在一个元素中没有多次链接，但是当有一些其他元素时，关键字是链接的......

这是脚本

```
(function(){
    // don't replace text within these tags
    var skipTags = { 'a': 1, 'style': 1, 'script': 1, 'iframe': 1, 'meta':1, 'title':1, 'img':1, 'h1':1 };
    // find text nodes to apply replFn to
    function findKW( el, term, replFn ) 
    {
        var child, tag;
        if(!found)var found=false;
        for (var i = 0;i<=el.childNodes.length - 1 && !found; i++)
        {
            child = el.childNodes[i];
            if (child.nodeType == 1) 
            { // ELEMENT_NODE
                tag = child.nodeName.toLowerCase();
                if (!(tag in skipTags)) 
                {
                    findKW(child, term, replFn);
                }
            } 
            else if (child.nodeType == 3) 
            { // TEXT_NODE
                found=replaceKW(child, term, replFn);
            }
        }
     };    
    // replace terms in text according to replFn
    function replaceKW( text, term, replFn) 
    {
        var match,
            matches = [],found=false;
        while (match = term.exec(text.data)) 
        {
            matches.push(match);
        }
        for (var i = 0;i<=matches.length - 1 && !found; i++)
        {           
            match = matches[i];            
            // cut out the text node to replace
            text.splitText(match.index);
            text.nextSibling.splitText(match[1].length);
            text.parentNode.replaceChild(replFn(match[1]), text.nextSibling);
            if(matches[i])found=true;// To stop the loop            
        }
        return found;
    };
    // Keywords to replace by a link
    var terms=Array('keywords','words');
    for(kw in terms)
    {
        findKW(
            document.body, 
            new RegExp('\\b(' + terms[kw] + ')\\b', 'gi'),
            function (match) 
            {
              var link = document.createElement('a');
              link.href = 'http://www.okisurf.com/#q=' + terms[kw];
              link.id = '1';
              link.target = '_blank';
              link.innerHTML = match;
              return link;
            }
        );
    }
}());​ 
```

**请任何人都可以帮助我停止循环并仅替换第一个关键字匹配？**（我对那些节点发疯了`var found`，当线程在循环中工作时我不能像全局一样发送，对于`findKW()`函数......）并且没有任何库（没有 jQuery 或其他）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:46:29.543

您可以`true`在替换单词时返回，并测试它以停止递归：

```
if (child.nodeType == 1) { // ELEMENT_NODE
    tag = child.nodeName.toLowerCase();
    if (!(tag in skipTags)) {
        // If `findKW` returns `true`, a replacement as taken place further down
        // the hierarchy and we can stop iterating over the other nodes.
        if (findKW(child, term, replFn)) {
            return true;
        }
    }
} else if (child.nodeType == 3) { // TEXT_NODE
    if (replaceKW(child, term, replFn)) {
        return true;
    }
} 
```

并删除`found`此函数中的任何引用，它不是必需的。

[**DEMO**](http://jsfiddle.net/FRyjK/2/) *（我还更新了`replaceKW`功能，如果您只使用第一个，则不需要收集所有匹配项）*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:45:16.280

使用 break 语句从循环块中存在。

**例子 ：**

```
for(;;) {
   if(condition) 
     break;
} 
```

在您的情况下，您应该将其添加到以下位置

```
else if (child.nodeType == 3) 
{ // TEXT_NODE
     found=replaceKW(child, term, replFn);
     if(found)
       break; // or alternately use return;
} 
```

# optimization - 排列，偶数算法和反向消除

> ID：13479918
> 
> 赞同：0
> 
> 时间：2012-11-20T18:41:03.397
> 
> 标签：optimization, permutation, reverse

我编写了一个实现 Even 算法的函数，以查找递增排序向量的所有排列。但我不需要“反向”路线，即从最后开始阅读时相同的路线。到目前为止，我“倒带”并比较我所有的排列并消除“反向”路线，但我需要一半的运行时间来反转，所以有没有办法调整算法以获得只有一半的排列但没有反转一 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T18:57:10.703

好的，我找到了解决方案，确实，如果你有一个连续数字的排序列表，当你最初的第一个数字变成最后一个，最后一个变成第一个时，你开始创建“反向”排列，即如果您以相反的方式阅读，您将获得与之前相同的列表。

因此，条件，如果最初是最后一个并且最初最后是第一个，则中断是有效且节省时间的。

# android - 当清单具有清单方向标记时，未调用 onConfigurationChanged()

> ID：13479922
> 
> 赞同：0
> 
> 时间：2012-11-20T18:41:21.927
> 
> 标签：android

我已经查看了这个问题的许多其他帖子，最常见的解决方案是确保您的清单中有以下内容：

```
<activity android:name=".activities.myActivity" 
        android:configChanges="orientation|keyboard|keyboardHidden|screenSize"> 
```

这个子已经在我的清单中，我**没有**强制我的活动方向为横向或纵向，但未调用 onConfigurationChanged(...)。

我的 onConfigureationChanged(...) 函数如下，我没有收到 logcat 输出：

```
@Override
public void onConfigurationChanged(Configuration newConfig) {

    Logger.e(getClass().getSimpleName(), "onConfigurationChanged()");

    super.onConfigurationChanged(newConfig);
} 
```

我还通过在 onCreate() 和 onPause() 中添加记录器来验证活动没有经过标准生命周期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:11:32.937

只有当 AndroidManifest.xml 中的指定配置发生变化时，才会调用 OnConfigurationChanged。例如，这个方法会在屏幕方向改变后被调用。如果我理解，您的应用程序的配置不会改变。

从[Android 文档](http://developer.android.com/guide/topics/resources/runtime-changes.html)：

例如，以下清单代码声明了一个处理屏幕方向更改和键盘可用性更改的活动：

```
<activity android:name=".MyActivity"
      android:configChanges="orientation|keyboardHidden"
      android:label="@string/app_name"> 
```

现在，当这些配置之一发生更改时，MyActivity 不会重新启动。相反，MyActivity 收到对 onConfigurationChanged() 的调用。此方法传递一个配置对象，该对象指定新的设备配置。

# c++ - 在运行时加载 DLL

> ID：13479924
> 
> 赞同：1
> 
> 时间：2012-11-20T18:41:24.653
> 
> 标签：c++, c, windows, cuda, visual-studio-2012

我在项目中使用 CUDA 驱动程序 API。当我在没有 NVIDIA GPU 的 PC 上执行该项目时，它会给出“未找到 nvcuda.dll”。

问题是：此 DLL 仅与 GPU 驱动程序一起分发，不像在运行时 API 中，您可以将所需的 DLL 放入可执行文件中。我需要在运行时加载这个 DLL，如果它不存在，我会知道 CUDA 不可用。我正在使用 Visual Studio 2012 Professional。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:02:43.887

Windows 提供了[一个 API 函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684175.aspx)( `LoadLibrary`) 在运行时将 DLL 加载到内存中。您提供一个`LPCTSTR`（指向 const 的空终止指针`TCHAR`），其中包含您要加载的 DLL 的名称/路径。如果您提供相对路径，Windows 将扫描`PATH`该文件的可执行文件的当前目录。如果您提供绝对路径，Windows 将使用它。

如果`LoadLibrary`返回`NULL`，则 Windows 找不到该文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:10:27.103

创建一个小型“启动器”应用程序，它将检查系统是否满足您的要求，并根据检查结果启动主应用程序或显示错误。要检查 DLL 是否可用，您可以`LoadLibrary()`按照之前的建议使用。

# apache - 使用 .htaccess

> ID：13479928
> 
> 赞同：3
> 
> 时间：2012-11-20T18:41:37.107
> 
> 标签：apache, .htaccess

我刚开始学习如何编写 htaccess 。我从此[页面](http://anantgarg.com/2009/03/13/write-your-own-php-mvc-framework-part-1/)获得了以下代码，它将所有内容重定向到 index.php 文件

```
<IfModule mod_rewrite.c>
    RewriteEngine on
    RewriteRule    ^$    public/    [L]
    RewriteRule    (.*) public/    [L]
</IfModule> 
```

我理解除了`^$ public/ [L]`和之外的所有行`(.*) public/ [L]`。它们是什么意思。对我来说，它看起来像是一些常规的 epression :).. 我知道 RewriteRule 用于编写重定向规则。但是符号 $ ,(,),., * 等是什么意思？表明 ？。
当我将这些行放入 .htaccess 时，出现以下错误

> ![在此处输入图像描述](../Images/93d5f2d4994f2a6841a41fad9f2cc42a.png)

但是当我评论第 4 行时，它正在工作..即。以下代码正在工作

```
<IfModule mod_rewrite.c>
    RewriteEngine on
    RewriteRule    ^$    public/    [L]
    #RewriteRule    (.*) public/    [L]
</IfModule 
```

那么这里的问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:54:17.657

这是您第一个问题的答案，对于第二个问题，您应该向我们提供更多信息（例如来自 的日志条目`/var/log/apache2/error.log`）

`^`匹配字符串的开头

`$`匹配字符串的结尾

`^$`匹配一个空字符串

`.`匹配任何字符

`*`允许 0 到任意数量的前一场比赛出现

`(`并`)`标记一个以后可以引用的组

`(.*)`将匹配任意数量的字符

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:54:49.767

我认为您在重写循环中就像自爆：
您将 abc.com/anything 重写为 abc.com/public，并且您正在将 /public 重写为 /public。
也许您应该指定必须重写哪个 url。（限制你的请求）像这样：

```
RewriteEngine on
RewriteRule    ^$    public/    [NC,L]
RewriteRule    ^index.php(.*)$ public/$1    [NC,L] 
```

将 index.php?requests 重写为 public/?requests

# extjs - 将 extjs 组合框绑定到内部对象

> ID：13479932
> 
> 赞同：1
> 
> 时间：2012-11-20T18:41:53.113
> 
> 标签：extjs, extjs4

我的组合框将始终只有一个分配给它的记录存储，它来自服务器，如下所示：

```
[
{
    "consulta_id": 23752, 
    "convenio_id": 1, 
    "data": "2012-07-11", 
    "id": 36569, 
    "paciente": {
        "nome": "Alvasole", 
        "id": 12
     }, 
    "tipo": 1
}, 
{
    "consulta_id": 23753, 
    "convenio_id": 61, 
    "data": "2012-07-11", 
    "id": 36579,
    "paciente": {
        "nome": "Felintoi", 
        "id": 33
     }, 
    "tipo": 1
}
] 
```

在这种情况下，需要将商店分配给“paciente”对象（带有 id 和 nome）。我不会让它自动工作。

这种方式有效，但需要手动调用：

```
setData: function(data) {
    this.getStore().loadRawData(data.get('paciente'));
    this.select(this.getStore().getAt(0));
}, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:19:01.073

扁平化模型的一种方法是使用`mapping`属性并使用点符号来访问嵌套对象的字段，如下所示：

```
Ext.define('MyApp.model.Paciente', {
    extend:'Ext.data.Model',
    fields:[
       {name:'id', mapping:'paciente.id'}
       ...
     ]
}); 
```

# linq - 如何在 lambda 中使用 GroupBy？

> ID：13479938
> 
> 赞同：0
> 
> 时间：2012-11-20T18:42:33.527
> 
> 标签：linq, group-by

我正在尝试将以下代码转换为 lambda 样式，但没有成功。

```
DiscCurrentLocation[] old =
  (from v in volumeDC.Volumes
   join d in volumeDC.Disc_Vs
     on v.VolumeID equals d.DiscVolumeID
   group d by new { v.VolumeLibID, d.DiscCurrentLocation } into g
   where (g.Key.VolumeLibID == libraryId && g.Key.DiscCurrentLocation > -1
     && g.Count() > 1)
   select (DiscCurrentLocation)g.Key.DiscCurrentLocation
  ).ToArray<DiscCurrentLocation>(); 
```

有人可以告诉我如何转换它吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:52:32.637

这应该是相同的：

```
DiscCurrentLocation[] old = volumeDC.Volumes
  .Join(volumeDC.Disc_Vs, (v) => v.VolumeID, (d) => d.DiscVolumeID,
      (v, d) => new { Volume = v, Disc_V = d })
  .GroupBy(vd => new { vd.Volume.VolumeLibID, vd.Disc_V.DiscCurrentLocation })
  .Where (grp => grp.Key.VolumeLibID == libraryId
      && grp.Key.DiscCurrentLocation > -1 && grp.Count() > 1)
  .Select (grp => (DiscCurrentLocation)grp.Key.DiscCurrentLocation)
  .ToArray<DiscCurrentLocation>()
; 
```

# javascript - Chrome Extension: Getting access to the initial tab after popup has been created

> ID：13479940
> 
> 赞同：0
> 
> 时间：2012-11-20T18:42:37.633
> 
> 标签：javascript, google-chrome, google-chrome-extension, popup

I am trying to create an extension where: from clicking a button on chrome it will launch a popup window and from that popup window I would like to get information from the initial tab which was focused on the time I've pressed the button.

```
function onClick(tab) {
    var originalTab = tab,
        popupTab;
    chrome.windows.create(
        {
            url: chrome.extension.getURL('popup.html'),
            type: 'popup'
        },
        function (w) {
            w.getCurrent({populate: true}, function (win) {
                var popupTab = win.tabs[0];
                popupTab.insertCSS(null, {code: 'body {background:red;}'});
                //look now I have access to the original and popup tabs!!!
            });
        }
    );
}

chrome.browserAction.onClicked.addListener(onClick); 
```

By using the following script, nothing really happens.

Where I am creating another window after the button is clicked and when the window is created I am getting the first tab available in it. In this situation I would have access to both originalTab and popupTab instance, but unfortunately this is not what is happening.

Is there particular reason for this script not work as expected?

Thanks in advance

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:23:35.037

我不确定你的代码有什么特别的问题，但我是这样做的。

弹出窗口在清单中指定。这通常可能并不重要，但如果事件处理程序唯一应该做的事情就是打开弹出窗口，这似乎是一种更可取的方法。情况就是这样。

对于弹出 onload 事件，有一个类似的处理程序：

```
function onLoad()
{
  chrome.windows.getCurrent(
  function(win)
  { 
    chrome.tabs.query({'windowId': win.id, 'active': true},
    function(tabArray)
    {
      // tabArray[0] - is the initially selected tab, so you may do...
      chrome.tabs.insertCSS(tabArray[0].id, {code: 'body {background:red;}'});
    }
  }
} 
```

# iphone - 在循环中向 MapView 添加注释

> ID：13479942
> 
> 赞同：1
> 
> 时间：2012-11-20T18:42:45.370
> 
> 标签：iphone, objective-c, ios, google-maps

我正在尝试在此循环中向我的 mkMapView 添加一些注释：

```
for (PFObject *fetchedCompany in companyArray)
{
       Store *store = [[Store alloc] initWithObject:fetchedCompany];
       [self loadStore:store];
       [store release];
}

- (void) loadStore:(Store *) store {
    CLLocationCoordinate2D location = [self getLocationFromAddressString:store.address];
    MapViewAnnotation *mapAnnotation = [[MapViewAnnotation alloc] initWithTitle:store.name coordinate:location];
    [self.indexMapView addAnnotation:mapAnnotation];
} 
```

这是使用 google api 将地址转换为位置的 getLocationFromAddressString 方法：

```
-(CLLocationCoordinate2D) getLocationFromAddressString:(NSString*) addressStr {
    NSString *urlStr = [NSString stringWithFormat:@"http://maps.google.com/maps/geo?q=%@&output=csv", [addressStr stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];

    NSError *error = nil;

    NSString *locationStr = [NSString stringWithContentsOfURL:[NSURL URLWithString:urlStr] encoding:NSUTF8StringEncoding error:&error];

    NSArray *items = [locationStr componentsSeparatedByString:@","];

    double lat = 0.0;
    double lon = 0.0;

    if([items count] >= 4 && [[items objectAtIndex:0] isEqualToString:@"200"]) {
        lat = [[items objectAtIndex:2] doubleValue];
        lon = [[items objectAtIndex:3] doubleValue];
    }
    else {
        NSLog(@"Address, %@ not found: Error %@",addressStr, [items objectAtIndex:0]);
    }

    CLLocationCoordinate2D location;
    location.latitude = lat;
    location.longitude = lon;

    return location;
} 
```

当我只发送一个位置时，它总是可以完美运行，但是当我在循环中添加注释时，有时无法识别某些位置，并且我从我的 NSLog 中得到了错误：

```
Address, Vallgatan 3 GÖTEBORG not found: Error 620 
```

问题是我对地址很确定，因为当我在没有循环的情况下尝试它们时它们起作用了。你知道我该如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:40:57.833

您提交的查询过多，您的请求被拒绝。请参阅[地理编码 API V2 文档](https://developers.google.com/maps/documentation/geocoding/v2/#StatusCodes)。

```
620:    G_GEO_TOO_MANY_QUERIES 
```

*"The given key has gone over the requests limit in the 24 hour period or has submitted too many requests in too short a period of time. If you're sending multiple requests in parallel or in a tight loop, use a timer or pause in your code to make sure you don't send the requests too quickly"*

# java - Avoid round number when casting a float to string

> ID：13479943
> 
> 赞同：0
> 
> 时间：2012-11-20T18:42:45.660
> 
> 标签：java, android

I need avoid round number when casting a float to string, I need the number is exactly the same.

In this moment if I make this:

```
String value =  String.valueOf(1234567.99); 
```

The the value = 1234568.0 ,so I need the value = 1234567.99 after casting.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:47:30.210

`1234567.99`不能完全表示为浮点数。最近的浮点数实际上等于 1234568。

如果你想要更高的精度，你可以使用 double:`1234567.99d`会做你所期望的。

您可以运行这个简单的测试来检查它（它在 Java 中，但通过替换 可以很容易地在 android 上转置`println`）：

```
public static void main(String[] args) {
    float f = 1234567.99f;
    double d = 1234567.99d;
    System.out.println(new BigDecimal(f));
    System.out.println(new BigDecimal(d));
} 
```

印刷：

> 1234568
> 1234567.98999999999068677425384521484375

注意：`String.valueOf(double)`确实将双精度数舍入为相同双精度数的另一种表示形式，小数点较少。换句话说，正如您在上面看到的，`1234567.99d`不能表示为双精度数，而最近的双精度数是`1234567.98999999999068677425384521484375`. 但是`String.valueOf`计算出来并使用该双精度的第一个表示形式（只有 2 个小数），因为根据语言的规范，它们实际上是相同的双精度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:43:55.260

`String.valueOf()` never round off any number you have some other issue but you can try it as:

```
String value =  ""+1234567.99; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:47:59.527

```
String s = Double.toString(1234567.99); 
```

**更新：**为了更好地控制字符串的格式，请使用[DecimalFormat](http://docs.oracle.com/javase/6/docs/api/java/text/DecimalFormat.html)和[DecimalFormatSymbols](http://docs.oracle.com/javase/6/docs/api/java/text/DecimalFormatSymbols.html)

例如：

```
java.text.DecimalFormat formater = new java.text.DecimalFormat();
formater.setMinimumFractionDigits(0);
formater.setMaximumFractionDigits(3);
formater.setGroupingUsed(false);
java.text.DecimalFormatSymbols dfs = new java.text.DecimalFormatSymbols();
dfs.setNaN("NaN");
formater.setDecimalFormatSymbols(dfs);
String s = formater.format(1234567.99); 
```

# css - How do you know if your data is displayed semantically correct as a table or something else?

> ID：13479944
> 
> 赞同：1
> 
> 时间：2012-11-20T18:42:49.847
> 
> 标签：css, semantic-markup

I have information from a database. It is one row. Now, it is old, and tables were used to display the data. It works but is ugly and hard to maintain. I'm "fixing" it. But, I don't know if it is considered tabular or not. It comes from database tables, but I don't know that what it means to be semantically correct in using a table for display.

I have several sections like this on a webpages. They are all calls to the same database, different sets of data, sectioned off in the webpage.

For example, one set is a general set of information, lastname, firstname, middle, other stats...

Next section might be address, etc.

A while back when I did asp.net forms there was a list view, I think that was similar to what I need to create (I'm using just straight html and a scripting language, no controls).

*How should I be displaying the information to be semantically correct?*

edit: It is one person that does not repeat.

edit: A single record, but displayed on the same page, just various `SELECT` statements to get that data all on the same page.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:54:06.737

如果它是表格数据（即显示在彼此下方的多条记录），那么 a`<table>`可能是最佳选择。如果它是单个记录的视图，甚至可能聚合来自多个表的数据，那么它`<table>`不应该是您的首选。

**表格数据：**

```
 --------------------------------
| ID | Name | Description | Date |  
 --------------------------------
| 01 | ...  | ...         | ...  |
| 02 | ...  | ...         | ...  | 
```

**非表格数据：**

```
ID:          ...
Name:        ...
Description: .................
             .................
             .....

Date:        .... 
```

# php - Storing massive temporary files

> ID：13479946
> 
> 赞同：0
> 
> 时间：2012-11-20T18:42:55.727
> 
> 标签：php, file, file-upload, storage

This is a practical question, I am working with quite large website which is going to have a big traffic, and this website is based on music. I guess you could say it's somewhat similar to soundcloud.

So i was wondering how should i store files when they are in uploading process, i'm uploading each file via ajax in chunks, so say user uploaded that file half way trough, and just turned his browser off or whatever, this means that file stays there broken and useless...

So i think best way would be to store it in a folder called `temp` and only once it's 100% complete move it to the user folder.

So i guess the question would be something like, is there a better way and if this moving from one folder to the other would cause to much time? Because i imagine there would files between `1mb to 1gb` size so moving `1gb` file would take quite some time...

# jquery - 我如何将另一个要按值评估的元素添加到此 If 语句？

> ID：13479949
> 
> 赞同：0
> 
> 时间：2012-11-20T18:43:08.367
> 
> 标签：jquery, if-statement, key-value

我将如何向该语句添加另一个要按值评估的元素？

```
if ($(this).val() == 1 && !$(this).data("priority1"))? 
```

我想使用 class 作为这个新元素的选择器（在这种特殊情况下，class="complaint" 并且其中一个值是“Too_small”）

我已经尝试过（带和不带括号）

```
if ($('.complaint').val() === "Too_small" && $(this).val() == 1 && !$(this).data("priority1")) 
```

我已经包含了下面的函数，以及一个工作示例 [http://jsfiddle.net/chayanyc/Dhaat/225/](http://jsfiddle.net/chayanyc/Dhaat/225/)

```
var $priority1 = $(".priority1");
$(".features_rank1").change(function() {
    var name = $(this).data("name"); //get priority name
    if ($(this).val() == 1 && !$(this).data("priority1")) {
        //rank is 1, and not yet added to priority list
        $("<option>", {text:name, val:name}).appendTo($priority1);
        $(this).data("priority1", true); //flag as a priority item
    }
    if ($(this).data("priority1") && $(this).val() != 1) {
        //is in priority list, but now demoted
        $("option[value=" + name + "]", $priority1).remove();
        $(this).removeData("priority1"); //no longer a priority item
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:49:50.050

尝试：

```
$(".complaint select").val() 
```

您需要类`select`下标签的值`.complaint`。

但是，您有两个属于 类的元素`.complaint`，因此您需要弄清楚您想要哪一个。

# android - getView from ImageAdaptar GridLayout - OutofMemoryError

> ID：13479950
> 
> 赞同：0
> 
> 时间：2012-11-20T18:43:15.493
> 
> 标签：android, image, out-of-memory, grid-layout

I having the "out of memory" error on my ImageAdapter, I tried some solutions reusing the ImageView, but not works, I hope any can help me :)

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {         
    ImageView imageView;
    if (convertView == null) { 
        imageView = new ImageView(mContext);//Creamos la imagen sólo si no existe
    } else {
        imageView = (ImageView) convertView;//Sino reusamos el objeto
    }

    //Todas con el mismo ancho
    imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
    imageView.setLayoutParams(new GridView.LayoutParams(70, 70));

    imageView.setImageResource(mThumbIds[position]);
    return imageView;
} 
```

I have some app similar, but not this problem, for sure on this I have 290 diferent images, and the other app I have only one :), I thought that the convertView == null fix the outOfMemory problems

More info: - Only 20 images have more of 100kb, only 3 of these are >500k and <900k

PD: Im using this tutorial code: [http://www.androidhive.info/2012/02/android-gridview-layout-tutorial/](http://www.androidhive.info/2012/02/android-gridview-layout-tutorial/)

Thanks for your help guys and sorry my english

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:48:46.133

Android 程序比大多数程序复杂得多，图像在 Ram 中占用的内存似乎比在磁盘上要多得多。尽管如此，您可以轻松完成一件事，以及其他一些技巧。

1.  添加`android:largeHeap="true"`到清单中的应用程序标记。
2.  运行某种内存分析器来查找泄漏。
3.  删除任何未使用的变量。
4.  如果它们在类中一致使用，则使一些变量成为静态变量。
5.  尝试使用正确大小的图像。

另外，看看[如何在内存有限的情况下优雅地降低性能？](https://stackoverflow.com/q/9986385/544198)

# twig - Twig - Append string data to same variable

> ID：13479952
> 
> 赞同：16
> 
> 时间：2012-11-20T18:43:39.317
> 
> 标签：twig

How would you append more data to the same variable in Twig? For example, this is what I'm trying to do in Twig:

```
var data = "foo";
data += 'bar'; 
```

I have figured out that `~` appends strings together in Twig. When I try `{% set data ~ 'foo' %}` I get an error in Twig.

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-20T19:02:54.147

`~`操作员不执行赋值，这可能是错误的原因。

相反，您需要将附加的字符串分配回变量：

```
{% set data = data ~ 'foo' %} 
```

另请参阅：[如何在树枝中组合两个字符串？](https://stackoverflow.com/questions/10470328/how-to-combine-two-string-in-twig)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-14T21:50:31.453

Displaying dynamically in twig

```
{% for Resp in test.TestRespuestasA %}        
    {% set name = "preg_A_" ~ Resp.id %}
    {% set name_aux = "preg_A_comentario" ~ Resp.id %}
    <li>{{ form_row(attribute(form, name)) }}</li>
{% endfor %} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-25T06:06:05.463

您还可以[`|append`](https://shopify.github.io/liquid/filters/append/)在 Twig 实例中定义一个自定义过滤器，如 Liquid 的过滤器，它执行相同的操作。

```
$loader = new Twig_Loader_Filesystem('./path/to/views/dir');
$twig = new Twig_Environment($loader);

...
...

$twig->addFilter(new Twig_SimpleFilter('append', function($val, $append) {
    return $val . $append;
})); 
```

产生以下标记：

```
{% set pants = 'I\'m wearing stretchy pants!' %}
{% set part2 = ' and they\'re friggin\' comfy!' %}
{% set pants = pants|append(part2) %}

{{ pants }}

{# result: I'm wearing stretchy pants! and they're friggin' comfy! #} 
```

恕我直言，我发现上面的示例比`~`组合器更直观，特别是在处理共享代码库时，语法新手可能会有点混淆。

# python - How to create a dynamic form using WizardView (Django 1.4)?

> ID：13479957
> 
> 赞同：0
> 
> 时间：2012-11-20T18:43:52.763
> 
> 标签：python, django, django-forms, django-formwizard

The full problem statement involves multiple steps, however, at the heart of it is this simple scenario:

Lets say I have two forms

```
from django import forms

class Form1(forms.Form):
    char_field1=forms.CharField(label='field 1')
    char_field2=forms.CharField(label='field 2')
    char_field3=forms.CharField(label='field 3')

class Form2(forms.Form):
    choice_field = forms.ChoiceField() 
```

Now using `django.contrib.formtools.wizard.views.WizardView` or its subclass I would like to populate the choice_field with the options filled by the user in `char_field1` - `char_field3`.

I tried overriding the `get_form` and populating the choice_field when Form2 was to be returned. It did show the options in the form rendered, but the form didn't validate upon submission.

My gut feel says that it should be possible, the 'how' is what I am not able to figure out.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-28T18:21:11.333

迟到总比没有好...我自己最近遇到了这种情况，不得不重写表单的（第二步）init方法并将一个初始关键字从WizardView传递给表单。从那里我可以有条件地设置表单字段的选项。

我自己的实现-

视图.py

```
class QuoteWizard(SessionWizardView):
    form_list = [QQFormProductLine, QQProduct, QQProductFluidProperties]
    ...
    def get_form_initial(self, step):
        #pass variables to forms from here
        initial = self.initial_dict.get(step, {})
        if int(step) > 0:
            self.temperature_units, self.measurement_format = self.get_measurement_units()
            initial.update({'measurement_format': self.measurement_format})
        return initial 
```

表格.py

```
class QQProduct(forms.ModelForm):
    ...
    def __init__(self, *args, **kwargs):
        super(QQProduct, self).__init__(*args, **kwargs)
        units = None 

        if 'initial'in kwargs:
            initial = kwargs.pop('initial')
            if 'measurement_format' in initial:
                units = initial.pop('measurement_format')

        flow_choices = []
        if units == 'imperial':
            flow_units = qq_models.FlowRateUnits()
            flow_units = flow_units.imperial()
        elif units == 'metric':
            flow_units = qq_models.FlowRateUnits()
            flow_units = flow_units.metric()

        for i in flow_units:
            flow_choices.append((i, qq_models.FlowRateUnits.get(i)))
        if len(flow_choices) > 0:
            self.fields['flow_rate_format'].widget.choices = flow_choices 
```

总之，get_form_initial 是一个 WizardView 方法，它将初始关键字传递给表单以执行一个步骤。在我的 self.get_measurement_units() 方法中，我调用 self.get_cleaned_data_for_step('0') 并根据第一步中的用户输入，更改第二步表单中选择字段中显示的选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:15:58.230

你可以这样做：

视图.py：

```
from django.contrib.formtools.wizard.views import CookieWizardView

class ChoiceWizardView(CookieWizardView):
    def done(self, form_list, **kwargs):
        pass

    def get_form(self, step=None, data=None, files=None):
        form = super(ChoiceWizardView, self).get_form(step, data, files)
        if 'choice_field' in form.fields:
            form1_cleaned_data = self.get_cleaned_data_for_step('0')
            if form1_cleaned_data:
                form.fields['choice_field'].choices = [item for item in form1_cleaned_data.items()]
        return form 
```

网址.py：

```
from app.forms import Form1, Form2
from app.views import ChoiceWizardView

urlpatterns = patterns('',
    (r'^my_wizard/$', ChoiceWizardView.as_view([Form1, Form2])),
) 
```

它会起作用的。但也许你选择了错误的应用架构？

# java - 在 ColdFusion 9 中使用 Java 库

> ID：13479961
> 
> 赞同：2
> 
> 时间：2012-11-20T18:44:03.803
> 
> 标签：java, coldfusion, iis-7.5, coldfusion-9

我目前正在运行一个 Java 应用程序，该应用程序应用一些自然语言处理技术来分析数据。此应用程序包括一个 Java 类文件和 1 个 .bin 扩展库该应用程序在我的开发服务器上运行良好，但在实时服务器上我收到以下错误：

对象实例化异常。
实例化 Java 对象时发生异常。该类不能是接口或抽象类。`Error: opennlp/tools/util/ObjectStream.`

> Stack Trace java.lang.NoClassDefFoundError: opennlp/tools/util/ObjectStream at java.lang.Class.getDeclaredFields0(Native Method) at java.lang.Class.privateGetDeclaredFields(Class.java:2291) at java.lang.Class.privateGetPublicFields (Class.java:2324) 在 java.lang.Class.getFields(Class.java:1359) 在 Coldfusion.runtime.java.ObjectHandler.Initialize(ObjectHandler.java:35) 在 Coldfusion.runtime.java.ObjectHandler.(ObjectHandler .java:30) 在coldfusion.runtime.java.ReflectionCache$1.fetch(ReflectionCache.java:29) 在coldfusion.util.SoftCache.get_statsOff(SoftCache.java:133) 在coldfusion.util.SoftCache.get(SoftCache.java :81) 在coldfusion.runtime.java.ReflectionCache.get(ReflectionCache.java:36) 在coldfusion.runtime.java.JavaProxy.(JavaProxy.java:35) 在coldfusion.runtime.java.JavaProxyFactory.getProxy(JavaProxyFactory.java:89) 在coldfusion.runtime.ProxyFactory.getProxy(ProxyFactory.java:65) 在coldfusion.runtime.CFPage.createObjectProxy(CFPage.java:5002 ) 在coldfusion.runtime.CFPage.CreateObject(CFPage.java:4966) 在coldfusion.runtime.CFPage.CreateObject(CFPage.java:4907) 在coldfusion.runtime.CFPage.CreateObject(CFPage.java:4885) 在coldfusion.runtime .CFPage.CreateObject(CFPage.java:4842) 在 cfWord_Cloud_Report2ecfm2061667591.runPage(E:\sites\SignatureWebMedical.Com\cf_modules\reports\sounding\Word_Cloud_Report.cfm:40) 在 Coldfusion.runtime.CfJspPage.invoke(CfJspPage.java: 231) 在coldfusion.tagext.lang.IncludeTag.doStartTag(IncludeTag.java:416) 在coldfusion.runtime。CfJspPage._emptyTcfTag(CfJspPage.java:2722) 在 cfindex2ecfm1980726432._factor0(E:\sites_virtualdirs\admin\reports\index.cfm:425) 在 cfindex2ecfm1980726432._factor7(E:\sites_virtualdirs\admin\reports\index.cfm:403)在 cfindex2ecfm1980726432._factor8(E:\sites_virtualdirs\admin\reports\index.cfm:188) 在 cfindex2ecfm1980726432.runPage(E:\sites_virtualdirs\admin\reports\index.cfm:1) 在 coldfusion.runtime.CfJspPage.invoke(CfJspPage .java:231) 在coldfusion.tagext.lang.IncludeTag.doStartTag(IncludeTag.java:416) 在coldfusion.filter.CfincludeFilter.invoke(CfincludeFilter.java:65) 在coldfusion.filter.ApplicationFilter.invoke(ApplicationFilter.java: 360) 在coldfusion.filter.RequestMonitorFilter.invoke(RequestMonitorFilter.java:48) 在coldfusion.filter。在 coldfusion.filter.ExceptionFilter.invoke(ExceptionFilter.java:70) 在 coldfusion.filter.PathFilter.invoke(PathFilter.java:94) 在 coldfusion.filter.ClientScopePersistenceFilter.invoke(ClientScopePersistenceFilter.invoke(ClientScopePersistenceFilter) 的 MonitoringFilter.invoke(MonitoringFilter.java:40) .java:28) 在coldfusion.filter.BrowserFilter.invoke(BrowserFilter.java:38) 在coldfusion.filter.NoCacheFilter.invoke(NoCacheFilter.java:46) 在coldfusion.filter.GlobalsFilter.invoke(GlobalsFilter.java:38)在coldfusion.filter.DatasourceFilter.invoke(DatasourceFilter.java:22) 在coldfusion.filter.CachingFilter.invoke(CachingFilter.java:62) 在coldfusion.filter.RequestThrottleFilter.invoke(RequestThrottleFilter.java:126) 在coldfusion.CfmServlet。服务（CfmServlet.java：200) 在coldfusion.bootstrap.BootstrapServlet.service(BootstrapServlet.java:89) 在jrun.servlet.FilterChain.doFilter(FilterChain.java:86) 在com.intergral.fusionreactor.filter.FusionReactorFilter.b(FusionReactorFilter.java:376) ) 在 com.intergral.fusionreactor.filter.FusionReactorFilter.c(FusionReactorFilter.java:254) 在 com.intergral.fusionreactor.filter.FusionReactorFilter.doFilter(FusionReactorFilter.java:164) 在 jrun.servlet.FilterChain.doFilter(FilterChain. java:94) 在coldfusion.monitor.event.MonitoringServletFilter.doFilter(MonitoringServletFilter.java:42) 在coldfusion.bootstrap.BootstrapFilter.doFilter(BootstrapFilter.java:46) 在jrun.servlet.FilterChain.doFilter(FilterChain.java:94 ) 在 jrun.servlet.FilterChain.service(FilterChain.java:101) 在 jrun.servlet.JRunRequestDispatcher.invoke(ServletInvoker.java:286) 在 jrun.servlet.JRunInvokerChain.invokeNext(JRunInvokerChain.java:42) 在 jrun.servlet.ServletInvoker.invoke(ServletInvoker.java:106) 在 jrun。 servlet.ServletEngineService.dispatch(ServletEngineService.java:543) 在 jrun.servlet.jrpp.JRunProxyService.invokeRunnable(JRunProxyService.java:203) 在 jrunx.scheduler.ThreadPool$DownstreamMetrics.invokeRunnable(ThreadPool.java:320) 在 jrunx.scheduler .ThreadPool$ThreadThrottle.invokeRunnable(ThreadPool.java:428) 在 jrunx.scheduler.ThreadPool$UpstreamMetrics.invokeRunnable(ThreadPool.java:266) 在 jrunx.scheduler.WorkerThread.run(WorkerThread.java:66)servlet.JRunInvokerChain.invokeNext(JRunInvokerChain.java:42) 在 jrun.servlet.JRunRequestDispatcher.invoke(JRunRequestDispatcher.java:286) 在 jrun.servlet.ServletEngineService.dispatch(ServletEngineService.java:543) 在 jrun.servlet.jrpp.JRunProxyService .invokeRunnable(JRunProxyService.java:203) 在 jrunx.scheduler.ThreadPool$DownstreamMetrics.invokeRunnable(ThreadPool.java:320) 在 jrunx.scheduler.ThreadPool$ThreadThrottle.invokeRunnable(ThreadPool.java:428) 在 jrunx.scheduler.ThreadPool$ UpstreamMetrics.invokeRunnable(ThreadPool.java:266) 在 jrunx.scheduler.WorkerThread.run(WorkerThread.java:66)servlet.JRunInvokerChain.invokeNext(JRunInvokerChain.java:42) 在 jrun.servlet.JRunRequestDispatcher.invoke(JRunRequestDispatcher.java:286) 在 jrun.servlet.ServletEngineService.dispatch(ServletEngineService.java:543) 在 jrun.servlet.jrpp.JRunProxyService .invokeRunnable(JRunProxyService.java:203) 在 jrunx.scheduler.ThreadPool$DownstreamMetrics.invokeRunnable(ThreadPool.java:320) 在 jrunx.scheduler.ThreadPool$ThreadThrottle.invokeRunnable(ThreadPool.java:428) 在 jrunx.scheduler.ThreadPool$ UpstreamMetrics.invokeRunnable(ThreadPool.java:266) 在 jrunx.scheduler.WorkerThread.run(WorkerThread.java:66)ServletEngineService.dispatch(ServletEngineService.java:543) 在 jrun.servlet.jrpp.JRunProxyService.invokeRunnable(JRunProxyService.java:203) 在 jrunx.scheduler.ThreadPool$DownstreamMetrics.invokeRunnable(ThreadPool.java:320) 在 jrunx.scheduler.ThreadPool $ThreadThrottle.invokeRunnable(ThreadPool.java:428) 在 jrunx.scheduler.ThreadPool$UpstreamMetrics.invokeRunnable(ThreadPool.java:266) 在 jrunx.scheduler.WorkerThread.run(WorkerThread.java:66)ServletEngineService.dispatch(ServletEngineService.java:543) 在 jrun.servlet.jrpp.JRunProxyService.invokeRunnable(JRunProxyService.java:203) 在 jrunx.scheduler.ThreadPool$DownstreamMetrics.invokeRunnable(ThreadPool.java:320) 在 jrunx.scheduler.ThreadPool $ThreadThrottle.invokeRunnable(ThreadPool.java:428) 在 jrunx.scheduler.ThreadPool$UpstreamMetrics.invokeRunnable(ThreadPool.java:266) 在 jrunx.scheduler.WorkerThread.run(WorkerThread.java:66)jrunx.scheduler.WorkerThread.run(WorkerThread.java:66) 处的 ThreadPool$UpstreamMetrics.invokeRunnable(ThreadPool.java:266)jrunx.scheduler.WorkerThread.run(WorkerThread.java:66) 处的 ThreadPool$UpstreamMetrics.invokeRunnable(ThreadPool.java:266) **引起：** java.lang.ClassLoader.loadClass(ClassLoader.java:248) 的 Coldfusion.bootstrap.BootstrapClassLoader.loadClass(BootstrapClassLoader.java:235) 的java.lang.ClassNotFoundException:opennlp.tools.util.ObjectStream .ClassLoader.loadClassInternal(ClassLoader.java:316) ... 61 更多

在我看来，这是一个类路径问题。我在开发服务器上遇到了同样的问题，但通过将我的所有文件放在 Cold Fusion 9 目录中来修复它：`C:\ColdFusion9\runtime\servers\lib` 当我将类文件和库 .bin 文件放在 Live 服务器上的同一文件夹中时，它不起作用。每次添加/删除类文件和 .bin 文件时，我都会重新启动生产服务器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T05:58:38.847

您是否检查过 ColdFusion Administrator Java JVM 设置中是否添加了类路径？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T06:47:49.037

这可能类似于您正在处理的内容：[https ://newrelic.com/docs/java/installing-the-java-agent-on-coldfusion](https://newrelic.com/docs/java/installing-the-java-agent-on-coldfusion)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T19:28:19.037

我的问题是windows的版本。在开发中，我们使用的是 Windows server 2008 R2，在生产中，我们使用的是 Windows server 2008 SP2，根据我在网上阅读的内容，它们有很多差异（微小但重要）我们在周五更新了生产服务器，一切都开始工作了。感谢所有回复这篇文章的人。

# objective-c - NSImageView 在拖入图像后不设置图像属性

> ID：13479967
> 
> 赞同：2
> 
> 时间：2012-11-20T18:44:21.497
> 
> 标签：objective-c, macos, cocoa, nsimageview

我有一个 NSImageView 放在我的 NIB 中，我将图像拖到其中。图像出现并显示，但是当我的代码调用时`[imageView image]`，我得到一个 NULL 对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T03:12:11.840

为了使拖放工作，您需要`NSImageView`在 Interface Builder 中或使用方法以编程方式将 设置为可编辑`setEditable:`。但是，您说出现了丢弃的图像，因此您显然在某处启用了编辑。`[imageView image]`唯一会返回的其他原因`nil`是`NSImageView`没有正确连接到引用它的对象。您可以通过打开已定义的`.h`文件`IBOutlet`并单击声明左侧的填充点来检查连接。如果点未填充，则表示尚未建立连接，您需要返回 Interface Builder 并建立连接。[以下](http://i.imgur.com/m41kf.png)是单击实心圆点时您将看到的示例。

# objective-c - UIPageControl showing wrong page when rotating device

> ID：13479968
> 
> 赞同：3
> 
> 时间：2012-11-20T18:44:26.063
> 
> 标签：objective-c, ios, uiscrollview, uipagecontrol

This is a bit of an odd one.

I have a UIScrollView with 5 pages and have device rotation set up.

If I have the UIScrollView on page 1,2,3 or 4 and rotate from either portrait to landscape, or landscape to portrait then the correct corresponding page is shown. i.e. if i'm on page 2 in portrait and switch orientation then page 2 is shown when in landscape.

However if I am on page 5 and switch from landscape to portrait it correctly shows page 5, but if I switch from portrait to landscape then it bizarrely shows page 3!!

Any ideas would be gratefully appreciated.

Heres the code parts:

```
- (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation {
if (UIDeviceOrientationIsLandscape([UIDevice currentDevice].orientation)) {
    [self switchToLandscape];
    }
else if (UIDeviceOrientationIsPortrait([UIDevice currentDevice].orientation)) {
    [self switchToPortrait];
   }
}

- (void)scrollViewDidScroll:(UIScrollView *)sender {
// Switch the indicator when more than 50% of the previous/next page is visible
CGFloat distance = hsScroll.bounds.size.width;
NSInteger pageNumber = floor((hsScroll.contentOffset.x - distance / 2) / distance) + 1;
hsPC.currentPage = pageNumber;
currentPage = pageNumber;
}

- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView {
}

- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView{
}

- (void)switchToPortrait {
//lots of other stuff relating to moving things around
[hsScroll setContentOffset:CGPointMake((currentPage * 320), 0) animated:NO];
hsPC.currentPage = currentPage;
}

- (void)switchToLandscape {
//lots of other stuff relating to moving things around

[hsScroll setContentOffset:CGPointMake((currentPage * 480), 0) animated:NO];
hsPC.currentPage = currentPage;
} 
```

Everything else works perfectly in my app and this is the last bug, quirk, before I submit it.

# android - Embedding OpenGL, written using NDK, inside a Fragment Layout

> ID：13479970
> 
> 赞同：2
> 
> 时间：2012-11-20T18:44:30.883
> 
> 标签：android, android-ndk, android-fragments, opengl-es-2.0

I am working on an educational game and I want the graphics part to be rendered with OpenGL, and NDK may be a better choice, but I am running into a problem with how I can make this work with Fragments.

Currently, if I just pass the fragment activity to GLSurfaceView it should work properly (I am still designing out everything), when I do OpenGL from Java, even though this is in a fragment.

I would like fragments so that on a tablet I can show all of the parts at one time, but on a phone the user will see equations on one screen and the results on another.

Is it possible to have my graphics be in a separate fragment and render the image with OpenGL, using NDK?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:02:08.970

我记得没有障碍为什么 GLSurfaceView 不能成为 Fragment 布局的一部分，就像它可以成为“常规”布局的一部分一样，但是请注意，您当时只能看到一个 SurfaceView。如果您以 API14 及更高版本为目标，则可以检查充当常规视图的[TextureView](http://developer.android.com/reference/android/view/TextureView.html)（与 GLSurfaceView 的工作方式相反）。

# android - Re-generate same debug.keystore

> ID：13479971
> 
> 赞同：1
> 
> 时间：2012-11-20T18:44:33.337
> 
> 标签：android, android-keystore

I had one app installed on my device using debug.keystore which has database store under data dictionary.

Because of some issue of window 7 i have to format it and i lost debug.keystore.

Now I want to update the app but error is "Re-installation failed due to different application signatures".

My purpose is i want the database which is stored in data directory.

Try this but not worked :

```
String currentDBPath = "/data/data/com.myapp/databases/myappdatabase.sqlite";
String backupDBPath = "/sdcard/myappdatabase.sqlite";
try {
    DatabaseExtractor.extractFromDevice(currentDBPath, backupDBPath);
} catch (IOException e) {
    e.printStackTrace();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T19:46:13.500

也许这会起作用，但是如果您丢失了数据库，请不要怪我：

```
adb uninstall -k <package> 
```

`-k`应该保留您的数据目录。

然后安装使用新调试密钥签名的新应用版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:42:12.160

> 由于窗口 7 的某些问题，我必须对其进行格式化，并且我丢失了 debug.keystore。

`debug.keystore`从您的 PC 备份中恢复。如果您不维护开发机器的备份，请停止所有软件开发，直到您这样做为止。

> 我的目的是我想要存储在数据目录中的数据库。

要么从备份中恢复你`debug.keystore`的数据，要么根植你的手机（这样你就可以访问这个目录），否则你将无法访问这些数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T19:42:38.703

删除以前版本的应用并安装新版本。重新生成 debug.keystore：删除`%USERPROFILE%/.android`Windows 目录下的调试证书。当您下次尝试构建调试包时，Eclipse 插件应该会生成一个新证书。您可能需要清理然后构建以生成证书。

# ruby-on-rails - 在 Ruby on Rails 中使用动态日期填充表

> ID：13479974
> 
> 赞同：1
> 
> 时间：2012-11-20T18:44:44.600
> 
> 标签：ruby-on-rails, ruby, date, ruby-on-rails-3.2, actioncontroller

我目前正在开发一个预约应用程序，其中搜索结果显示在表格中，并且列包含特定时间的按钮。请看一下随附的屏幕截图：

![在此处输入图像描述](../Images/6fb4a16540d163ebe25e38e22321a357.png)

我正在寻找一种方法，其中像 10 月 1 日至 10 月 7 日这样的日期（如屏幕截图所示）动态填充当前周日期，例如当前周星期一是 11 月 19 日，星期日将是 11 月 25 日。我已经在网上搜索以找到一种方法来做到这一点，并且我已经搜索了 Ruby Toolbox 以找到可以帮助我实现这一目标的东西，但到目前为止还没有成功。

任何人都可以推荐一种合适的方法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:24:09.673

我会尝试将以前的答案解决方案与 DateTime.now.beginning_of_week 结合起来：

```
week_beginning = DateTime.now.beginning_of_week

7.times do |day_number|

  day = week_beginning + day_number.days

  #assuming we start at 8:30AM
  first_hour = day + 8.hours + 30.minutes

  #you have the 'pivot' for the day, just create as much time ranges as you want now
  hour1 = first_hour + 1.hour
  hour2 = ...
  # (Obviously you will somehow iterate to get all the hours)      
end 
```

Rails 日期和时间支持真的很棒，看看 ActiveSupport 的扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T18:49:42.560

你可以做类似的事情

```
Time.now + 1.day
Time.now + 2.day
... 
```

在您的视图中 7 天以获得一周中每一天的日期，只需将 Time.now 替换为您想要开始的任何日期。这是否实现了您正在寻找的东西？

# c++ - Linux 上最快的截屏方法

> ID：13479975
> 
> 赞同：32
> 
> 时间：2012-11-20T18:44:50.763
> 
> 标签：c++, c, linux, screenshot, x11

这个问题类似于这个问题

[最快的截屏方法](https://stackoverflow.com/questions/5069104/fastest-method-of-screen-capturing)

但对于 linux/X11。

更具体地说，我需要一种方法来捕获在 X11 显示器上运行的一个窗口的像素图像（Windows 中 alt-print 屏幕的编程等效项）。

注意事项和要求：

1) 即使在正在捕获的窗口之上放置了一个新窗口，像素图像仍应指向原始应用程序窗口而没有任何遮挡

2）用户不需要看到应用程序窗口，我只需要存储像素缓冲区/图像以用于视频目的

我探索过的其他选择是：

1) xvfb - 它可以工作，但它确实可以进行 CPU 渲染，这对一个好的 GPU 来说是缓慢和浪费的

2）许多lxc中的x11 - 理论上可以工作，但设置起来很复杂，我不确定它是否能很好地缩放很多窗口被捕获

欢迎提出建议和想法

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-29T15:48:04.050

这可以在具有硬件加速的服务器中使用[VirtualGL](http://virtualgl.svn.sourceforge.net/viewvc/virtualgl/vgl/tags/2.3.2/doc/index.html#hd009001)。基本上只需适当配置服务器，然后在同一台机器或同一网络中的机器上运行

```
export DISPLAY=<your xvfb display>
vglrun <your_app> 
```

这将具有以下优点：

1）您的应用程序将使用 virtualGL 渲染，这将使用硬件

2) VirtualGL 将在 Xfvb 显示器内显示您的 3D 上下文，这只会在 CPU 中渲染 2D 小部件

3) 配置 Xvfb 以渲染到帧缓冲区

4）利润！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-22T19:08:35.633

这对于纯 X11 是不可能的。

你可以通过合成获得你想要的东西，但只能在支持它的服务器上（大多数现代服务器都支持）。这实际上与窗口管理器无关。WM 只是另一个客户端，尽管具有一些特殊能力，但与合成无关。您可以使用相同的合成 API。

`man xcomposite`应该让你开始。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-28T02:45:00.477

您可以使用[xwd(1)](http://www.xfree86.org/current/xwd.1.html "xwd - 转储 X 窗口的图像")转储 X11 窗口（并[使用 xwud(1)](http://www.xfree86.org/current/xwud.1.html "X 的图像显示器")来显示它）。[ImageMagick](http://imagemagick.org)和[Netpbm 工具](http://netpbm.sourceforge.net/)知道如何处理 XWD 格式。但这些并不是特别快。而且它们不会显示窗口的隐藏部分。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-12-28T22:32:38.000

我看到评论说这不能在 X11 中完成，所以可能有一些我不明白的地方，但我可以使用以下代码捕获我的屏幕。

```
#include <X11/Xlib.h> //-lX11
#include <X11/Xutil.h>
#include <X11/Xmd.h> 
#include <X11/Xatom.h>
#include <jpeglib.h> //-ljpeg 

void CopyDesktopImage(std::string sFilePath_Name)
{  
    Display *dis=XOpenDisplay((char *)0);
    Screen *scr = XDefaultScreenOfDisplay(dis);
    Drawable drawable = XDefaultRootWindow(dis);

    XImage *image = XGetImage(dis, drawable, 0, 0, scr->width, scr->height, AllPlanes, ZPixmap);
    Save_XImage_to_JPG(image, sFilePath_Name.c_str(), 75);
    XDestroyImage(image);

    XCloseDisplay(dis); 
}

void Save_XImage_to_JPG(XImage *image, std::string FileName, int Quality)
{
    FILE* outfile = fopen(FileName.c_str(), "wb");
    if(outfile == NULL) return;

    jpeg_compress_struct cinfo;
    jpeg_error_mgr       jerr;

    cinfo.err = jpeg_std_error(&jerr);
    jpeg_create_compress(&cinfo);
    jpeg_stdio_dest(&cinfo, outfile);

    cinfo.image_width      = image->width;
    cinfo.image_height     = image->height;
    cinfo.input_components = image->bitmap_unit >> 3;
    cinfo.in_color_space   = JCS_EXT_BGRX;

    jpeg_set_defaults(&cinfo);
    /*set the quality [0..100]  */
    jpeg_set_quality(&cinfo, Quality, true);
    jpeg_start_compress(&cinfo, true);

    JSAMPROW row_pointer;          /* pointer to a single row */

    while (cinfo.next_scanline < cinfo.image_height) 
    {
        row_pointer = (JSAMPROW) &image->data[cinfo.next_scanline*image->bytes_per_line];
        jpeg_write_scanlines(&cinfo, &row_pointer, 1);
    }
    jpeg_finish_compress(&cinfo);

    fclose(outfile);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-29T13:19:39.453

我会获取 的源代码`gnome-screenshot`或其他一些现有的开源工具，并弄清楚它们是如何做到的。

你可以在这里找到 Ubuntu 使用的资源：[http ://packages.ubuntu.com/quantal/gnome-screenshot](http://packages.ubuntu.com/quantal/gnome-screenshot)

但是，在剪切和粘贴大段代码之前不要忘记检查许可证！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-29T13:34:40.583

这只是一个疯狂的猜测，但我认为您可以使用带有 -id [windowid] (http://www.karlrunge.com/x11vnc/x11vnc_opts.html#opt-id) 选项的 x11vnc 通过 VNC 流式传输该单个窗口. 这将向您显示整个窗口，其位置与主屏幕中的完全相同（您可能会丢失一些弹出菜单），即使它被覆盖。您可以从真正的 X11 屏幕中获取窗口坐标。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-29T15:25:04.487

Xpaint 是一个非常古老的 X11 实用程序，使用 MIT Athena 小部件集构建。File > Take Snapshot 将从屏幕上抓取一个窗口或鼠标选择的矩形。

或者

MagiCapture 是 X Window 系统的屏幕捕捉和预览实用程序。用户可以捕获单个窗口、带有装饰的单个窗口、显示的矩形区域或整个显示本身。用户可以将捕获的图像保存到 ImageMagick 工具包支持的图形文件中，该工具包支持大多数（如果不是全部）流行的图形格式。MagiCapture 使用 GLIB 和 GTK+ 库作为用户界面，使用 ImageMagick 和 GdkMagick 库进行所有图形处理。需要 ImageMagick。

或者

[Zscreen](http://code.google.com/p/zscreen/) :- 这个仅限 Windows 的屏幕捕获应用程序具有大量功能。它抓取活动窗口、选定窗口或整个屏幕的快照。获得图像后，在图像编辑器中自动打开它或将其上传到 Twitpic、YFrog、Flickr 或其他几个受支持的服务之一。ZScreen 会缓存您的所有图像，甚至是剪贴板上的图像，因此您的屏幕截图历史总是触手可及。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-29T15:31:32.983

您可以在本地网络中进行棘手的黑客攻击是使用 X 远程功能打开您的 X 侦听端口，然后使用 env var 将导出设置为 X 侦听端口，然后使用 XscreenCapture

# c# - How to stop a windows service that has multiple threads cannot be stopped

> ID：13479979
> 
> 赞同：1
> 
> 时间：2012-11-20T18:45:03.680
> 
> 标签：c#, windows, service, servicecontroller

I have a windows service written in C# that creates multiple threads, and some threads have legacy code and I don't have enough time/access to legacy code to wait for all these threads to stop before OnStop() completes. Again at some point I dont have references to all threads as there are legacy codes. Now I want to update the service dynamically. So I start a different Updater service from my Job service. The Updater service will stop the Job service, download Job service exe and other dlls, replace these with old service exe, and dlls, and finally would restart the Job service. Upon start, Job service will stop the Updater service.

Now when the Updater service stops the Job service using ServiceController.Stop(), and also calls ServiceController.WaitForStatus(ServiceControllerStatus.Stopped), the Job service stops, but the some legacy threads spawned from Job service may not stop at that moment, and as a result the Job service exe cannot be updated.

I really dont find any good solution yet. The best solution could have been to use WaitHandles (AutoResetEvent/ManualResetEvent) to wait for all threads to finish, which is not happening. Or may be all threads could have been forcefully aborted which also seems critical. Another undesired solution could be to find all threads running in the service process and terminate/abort all threads which is not straightforward and also not a preferable solution at all. I was hopeful to use Environment.Exit in OnStop() but found that it causes Windows to show a bad alert message saying Process terminated unexpectedly (error 1067) which I have not been able to resolve at all.

Now I am confused what should be done at this moment in a short time without touching the legacy code. Any help would be appreciable.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:51:38.867

如果您可以使用 启动线程`thread.IsBackground = true`，则可以在所有前台线程完成处理时自动中断它们（例如您的`Stop`方法）

# c++ - 如何使用 Qt 检查 Web 服务是否已启动

> ID：13479981
> 
> 赞同：1
> 
> 时间：2012-11-20T18:45:15.917
> 
> 标签：c++, web-services, qt, http, networking

我编写了一些代码来监控 SOAP Web 服务。基本上它使用 QNetworkAccessManager 向 web 服务地址发送 HTTP GET 请求，如果收到响应，那么我知道服务已启动。我认为这是可行的，但每隔一段时间（每隔几天一次）我会收到一条通知，说服务器已关闭，然后下次检查时它会再次启动。所以服务器实际上并没有关闭，请求发生了一些事情。我想知道是否有更好的方法来监控 web 服务，下面是一些伪代码，向您展示我所做的：

```
main{
    Qtimer timer;
    connect(timer, SIGNAL(timeout()), this, SLOT(send()));
    timer.start(300000);
}

send(){
    QNetworkAccessManager *qnam;
    connect(qnam, SIGNAL(finished(QNetworkReply*)), this, SLOT(requestFinished(QNetworkReply*));
    qnam.get("https://testWebservice.com/TEST/webservice");
}

requestFinished(QNetworkReply *reply){
    QByteArray data = reply.getData();
    if(reply.error == some sort of error indicating server is down, or if reply == empty){
        ***SERVER DOWN***
    }
    else{
        ***SERVER UP***
    }
} 
```

**编辑** 更改了*if*条件以包括错误检查

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:11:09.293

检查网络回复内容是否为空以确保 web 服务已关闭在我看来在一般情况下并不是一个好的解决方案。

我建议使用`QNetworkReply::error()`方法来检查是否发生错误。有关详细信息，请参阅[http://doc.qt.digia.com/qt/qnetworkreply.html#error](http://doc.qt.digia.com/qt/qnetworkreply.html#error)。

**更新** 没有提到如何从`QNetworkReply`对象中获取回复数据。我认为使用了类似`QIODevice::readAll/read()`的东西。如果是这样，那么空数据回复并不意味着服务器端发生了错误。参见例如[http://doc.qt.digia.com/qt/qiodevice.html#readAll](http://doc.qt.digia.com/qt/qiodevice.html#readAll)

当没有网络错误但回复数据意外为空时，我会假设 web 服务已启动，但 web 服务端的请求处理或请求/响应传输出现问题。

# xcode - 在 OS X 10.8 上设置 SDL

> ID：13479983
> 
> 赞同：9
> 
> 时间：2012-11-20T18:45:21.917
> 
> 标签：xcode, macos, opengl, sdl

我不确定我应该如何设置 SDL 以使用我的 mac。我有 OS X 10.8。

我记得前段时间在[SDL 页面上](http://www.libsdl.org/download-1.2.php)有针对 OS X、Win 和 Linux 的开发库。现在 OS X 不见了，所以我猜我必须让 linux 工作？

我需要可用于 OS X 的运行时库。

我需要做什么才能让整个事情在 Xcode 4 中启动并运行？

将运行时复制`SDL.framework`到`/Library/Frameworks`，然后呢？

我非常感谢整个分步过程，因为我对这些东西不是最熟悉（但如果需要，我确实知道 shell 中的一两个命令）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T19:51:29.013

开发库包含 Xcode 项目模板，但模板不适用于 Xcode 4。由于模板不适用于 Xcode 4，因此 Mac OS X 的开发库已从 SDL 站点中删除。只需下载 Mac 运行时库。以下文章向您展示了如何让 SDL 与 Xcode 4 一起使用：

[在 Xcode 4 中使用 SDL](http://meandmark.com/blog/2012/01/using-sdl-with-xcode-4/)

# vba - 如何识别 MS Word 宏的第三个表的第三列

> ID：13479988
> 
> 赞同：0
> 
> 时间：2012-11-20T18:45:41.260
> 
> 标签：vba, ms-word

我试图弄清楚是否可以将 MS Word VB 中的范围变量的范围设置为 MS Word 文档中第三个表的第三列的应用程序。

到目前为止，这是在不破坏代码的情况下尽可能接近的：

```
Set range = ActiveDocument.Tables(3).range 
```

有什么方法可以让我在其中引用 Columns(3) 而不会让调试器发疯？

到目前为止我的代码：

```
Set range = ActiveDocument.Tables(3).range
With range.Find
    .Text = "Passed"
    .Format = True 
    .MatchCase = True
    .MatchWholeWord = False
    .MatchWildcards = False
    .MatchSoundsLike = False
    .MatchAllWordForms = False
    Do While .Execute(Forward:=True) = True
        iCount = iCount + 1
    Loop
End With 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T21:30:08.183

就像是 ... ？

```
Dim col As Column
Set col = ActiveDocument.Tables(3).Columns(3)
col.Cells(1).Range.Text = "Abc"
Debug.Print col.Cells(1).Range.Text 
```

# bash - 如何检查外部 shell 脚本退出代码

> ID：13479989
> 
> 赞同：0
> 
> 时间：2012-11-20T18:45:41.113
> 
> 标签：bash, shell, ftp

我有一个简单的“主”shell 脚本，它做了一些准备工作，然后调用另一个将文件上传到 ftp 站点的 shell 脚本。我想知道如何等待并检查被调用 shell 脚本的退出代码，以及如何轻松检查 FTP 文件是否实际成功上传并提供正确的退出代码（0 或 1）

谢谢你

主脚本：

```
#!/bin/sh
# check for build tools first
FTP_UPLOAD_SCRIPT=~/Desktop/ftp_upload.sh

if [ -f "$FTP_UPLOAD_SCRIPT" ]; then
    echo "OK 3/5 ftp_upload.sh found. Execution may continue"
else
    echo "ERROR ftp_upload.sh not found at $FTP_UPLOAD_SCRIPT. Execution cannot continue."
exit 1
fi

  # upload the packaged installer to an ftp site
  sh $FTP_UPLOAD_SCRIPT

  # check the ftp upload for its exit status
  ftp_exit_code=$?
  if [[ $ftp_exit_code != 0 ]] ; then
    echo "FTP ERRORED"
    exit $ftp_exit_code
  else
    echo $ftp_exit_code
    echo "FTP WENT FINE"
  fi

  echo "\n"
  exit 0 
```

ftp_upload_script：

```
#!/bin/sh
FTP_HOST='myhost'
FTP_USER='myun'
FTP_PASS='mypass'

FTPLOGFILE=logs/ftplog.log
LOCAL_FILE='local_file'
REMOTE_FILE='remote_file'

ftp -n -v $FTP_HOST <<SCRIPT >> ${FTPLOGFILE} 2>&1
quote USER $FTP_USER
quote PASS $FTP_PASS
binary
prompt off
put $LOCAL_FILE $REMOTE_FILE
bye
SCRIPT
echo $! 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T19:21:56.030

我认为您正在寻找的`exit $?`不是`echo $!`FTP 脚本的底部。

Using`echo`将简单地打印到`stdout`但不会返回退出代码（因此`exit`应该使用）。特殊`$?`的是前一个进程的返回码，not`$!`是进程ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T17:37:31.353

我想出了一个解决方案，既可以仔细检查 ftp 上传，又可以提供适当的退出代码。

```
... ftp upload first ... then ...

# this is FTP download double-check test
ftp -n -v $FTP_HOST <<SCRIPT >> ${FTPLOGFILE} 2>&1
quote USER $FTP_USER
quote PASS $FTP_PASS
binary
prompt off
get $REMOTE_FILE $TEST_FILE
bye
SCRIPT

#check to see if the FTP download test succeeded and return appropriate exit code
if [ -f "$TEST_FILE" ]; then
  echo "... OK FTP download test went fine. Execution may continue"
  exit 0
else
  echo "... ERROR FTP download test failed. Execution cannot continue"
  exit 1
fi 
```

# ruby-on-rails - 为 edit_user_registration 和 users/edit 设计路由错误

> ID：13479991
> 
> 赞同：1
> 
> 时间：2012-11-20T18:45:44.737
> 
> 标签：ruby-on-rails, devise, routes

每当我在登录时转到 /users/edit 时都会收到此错误：

```
No route matches {:action=>"show", :controller=>"users"} 
```

为什么用户/编辑试图在用户控制器中查找显示操作？

路线.rb

```
 devise_for :users do
    get 'users', :to => 'users#show', :as => :user_root # Rails 3
  end

  resources :users, :only => [:index, :show]

  authenticated :user do
    root :to => 'home#index'
  end

  root :to => 'home#index' 
```

耙路线：

```
 user_root                GET    /users(.:format)               users#show
 new_user_session         GET    /users/sign_in(.:format)       devise/sessions#new
 user_session             POST   /users/sign_in(.:format)       devise/sessions#create
 destroy_user_session     DELETE /users/sign_out(.:format)      devise/sessions#destroy
 user_password            POST   /users/password(.:format)      devise/passwords#create
 new_user_password        GET    /users/password/new(.:format)  devise/passwords#new
 edit_user_password       GET    /users/password/edit(.:format) devise/passwords#edit
                          PUT    /users/password(.:forma        devise/passwords#update
 cancel_user_registration GET    /users/cancel(.:format)        devise/registrations#cancel
 user_registration        POST   /users(.:format)               devise/registrations#create
 new_user_registration    GET    /users/sign_up(.:format)       devise/registrations#new
 edit_user_registration   GET    /users/edit(.:format)          devise/registrations#edit
                          PUT    /users(.:format)               devise/registrations#update
                          DELETE /users(.:format)               devise/registrations#destroy
 users                    GET    /users(.:format)               users#index
 user                     GET    /users/:id(.:format)           users#show
 root                     /                                     home#index
 root                     /                                     home#index 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:43:59.657

奇怪的！

因此，我逐步完成了所有最后的更改，发现问题在于位于views/layouts/application.html.erb 中的这行代码：

```
<%= link_to current_user.email, user_path  %> 
```

由于某种原因，当它们是布局文件中 user_path 的链接时，站点中的路由会变得一团糟。

为了修复它，我刚刚更改`user_path`为，`current_user`所以我的新链接如下所示：

```
<%= link_to current_user.email, current_user  %> 
```

真正奇怪的是，当您使用指向`user_path`除 layout/application.html.erb 文件之外的任何地方的链接时，路由工作正常。

# java - 有条件地包含一个 JSP .tag 文件？

> ID：13479992
> 
> 赞同：0
> 
> 时间：2012-11-20T18:45:56.577
> 
> 标签：java, jsp-tags, conditional-statements

一直试图在网上寻找答案，但找不到。我有一个调用标签文件的jsp页面（如下），在这个标签文件中，我需要有条件地调用另一个标签文件。但是，无论我通过**$loadScript**传递什么值，内容都是包含的。

在我的 jsp 页面中，我传入了**loadScript**的值：（已更新）

```
<jsp:attribute name="loadScript">false</jsp:attribute> 
```

这是我的标签文件中的内容：

```
<%@tag description="put the tag description here" pageEncoding="UTF-8"%>
<%@ attribute name="loadScript"%>
<%@ taglib tagdir="/WEB-INF/tags" prefix="main" %>

<html>
<head>
<c:if test="${loadScript == 'true'}">
    <main:script></main:script>  
</c:if>

</head>
</html> 
```

有条件地调用/包含标记文件的正确方法是什么？

更新：是的，我可以使用此测试确认值已成功传输：

```
<c:if test="${'loadScript'}">
    <script type="text/javascript">
        alert(${loadScript});
    </script>
</c:if> 
```

看起来`<main:script></main:script>`标签无论如何都会生成？

# java - SAXParseException - 文档结构

> ID：13479993
> 
> 赞同：1
> 
> 时间：2012-11-20T18:45:58.247
> 
> 标签：java, xml, dom, saxparser

我正在编写一个发送/接收 xml 的应用程序。

消息由 DOM 生成并定期发送到服务器（每 2 秒一次）。当收到一些消息时（它取决于一些参数，但对于不同的启动是不变的）服务器响应错误：`XML document structures must start and end within the same entity`- 可能，接收到的消息结束被切断。有时错误连续出现，有时它们与正常消息混合。

消息正确形成（否则错误可能来自开始）。我想，在某种程度上它与消息长度有关；休息时大约有 9800 个符号。

我还发现了一个类似错误的帖子：[SAXParseException: XML document structure must start and end within the same entity](https://stackoverflow.com/questions/7306626/saxparseexception-xml-document-structures-must-start-and-end-within-the-same-en)，但它与我的不同。

这里是一些代码，可能是我做错了什么。

**生成文档类：**

```
public class DOMConstructor {

private Element actions;
Document document = null;

DOMConstructor (String key) throws ParserConfigurationException, SAXException, IOException {

    DocumentBuilderFactory documentBuilderFactory = DocumentBuilderFactory.newInstance();
    DocumentBuilder documentBuilder = documentBuilderFactory.newDocumentBuilder();

    document = documentBuilder.newDocument();
    Element rootElement = document.createElement("request");
    document.appendChild(rootElement);

    Element token = document.createElement("token");
    token.appendChild(document.createTextNode(key));
    rootElement.appendChild(token);

    Element actions = document.createElement("actions");
    rootElement.appendChild(actions);

    this.actions = actions;
}

public StreamResult getResultXml (OutputStream out) throws TransformerException, FileNotFoundException {

    TransformerFactory transformerFactory = TransformerFactory.newInstance();
    Transformer transformer = transformerFactory.newTransformer();

    DOMSource domSource = new DOMSource(document);

    StreamResult streamResult = new StreamResult(out);
    transformer.transform(domSource, streamResult);

    return streamResult;
}

protected void addAction (String fromId, String toId, String droids_num) {      
    Element action = document.createElement("action");
    actions.appendChild(action);

    Element from = document.createElement("from");
    from.appendChild(document.createTextNode(fromId));
    action.appendChild(from);

    Element to = document.createElement("to");
    to.appendChild(document.createTextNode(toId));
    action.appendChild(to);

    Element units = document.createElement("unitscount");
    units.appendChild(document.createTextNode(droids_num));
    action.appendChild(units);
}       
} 
```

**发送xml：**

```
public void sendData (XMLData xml) throws UnknownHostException, IOException, TransformerException, ParserConfigurationException, SAXException {
    conn = new Socket(address, port);       
    OutputStream out = new BufferedOutputStream(conn.getOutputStream());
    xml.sendData(out, true);

} 
```

# asp.net - 将所有按钮转换为没有 JavaScript 的 jQuery UI 按钮小部件

> ID：13479994
> 
> 赞同：2
> 
> 时间：2012-11-20T18:46:05.813
> 
> 标签：asp.net, jquery-ui

我刚刚对 jQuery UI Button 小部件感兴趣。因此，为了应用 jQuery UI Button 主题，我们必须这样做：

```
$("input[type=button]").button(); 
```

但是，如果我想将整个站点中的所有按钮都设置为 jQuery UI Button 小部件，该怎么办。我是否总是必须调用**button()**（它会增加一些启动性能开销，并且因为我支持 IE7...），或者有没有办法生成标记（使用服务器端 ASP .NET Web 窗体） jQuery UI Button 已经准备好了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:58:49.497

您最好使用创建按钮的方法。

但是，您可以手动添加所有类的按钮样式；你失去了鼠标悬停功能。

不打电话真的没有什么收获`.button`

[小提琴](http://jsfiddle.net/wKH9x/)

```
<button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" name="test" role="button" aria-disabled="false">
<span class="ui-button-text">test</span>
</button>​ 
```

# ios - 在 iOS 6 中，-[UITextField becomeFirstResponder] 在 -viewWillAppear 中不起作用：

> ID：13479997
> 
> 赞同：17
> 
> 时间：2012-11-20T18:46:18.513
> 
> 标签：ios, ios6, uitextfield, viewwillappear, becomefirstresponder

在 iOS 5.1 和 iOS 5.0 中它可以工作，但在 iOS 6.0 中键盘不显示。

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    UITextField *textField = self.emailAddressTextField;
    [textField becomeFirstResponder];
} 
```

现在我将逻辑移至`-viewDidAppear:`.

```
// This works but is not desirable.
- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
    UITextField *textField = self.emailAddressTextField;
    [textField becomeFirstResponder];
} 
```

这可行，但不可取。视图加载后显示键盘上滑动画。

我希望键盘出现，因为向左滑动动画呈现正在加载到导航控制器中的视图。

有谁知道如何在 iOS 6 中显示视图时加载键盘？

***更新***

根据@Duck 的反馈，我做了更多的测试。这似乎特定于 UITableViewCells 中包含的 UITextFields。

有没有人有什么建议？

***第一个解决方案***

所以一个完整的描述。这是一个带有两个静态单元格（电子邮件和密码）的表格视图。在分配了表格页脚视图的视图中有一个登录按钮。这两个单元格中有一个文本字段，属于自定义类型 SICOTextFieldCell。

我的解决方案是在登录按钮后面放置一个假文本字段（在表尾视图中）。

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    UITextField *textField = self.SICO_fakeTextField;
    [textField becomeFirstResponder];
}

- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
    UITextField *textField = self.SICO_emailAddressTextField;
    [textField becomeFirstResponder];
} 
```

***新解决方案***

根据@stm 的回答，我想出了一个新的（更好的？）解决方案。

我的解决方案是致电`-selectRowAtIndexPath:animated:scrollPosition:`. `-[SICOTextFieldCell setSelected:animated:]`，这是一个自定义表格视图单元格，调用`[self.textField becomeFirstResponder]`它神奇地正确绘制键盘。它仍然是一个 hack，但它是一个更清洁的 hack。

```
@interface SICOLogInViewController ()
@property (readonly, nonatomic) UITextField *SICO_emailAddressTextField;
@property (readonly, nonatomic) UITextField *SICO_passwordTextField;
@end

@implementation SICOLogInViewController

- (IBAction)logIn
{
    // Controller Details
}

#pragma mark Private

- (UITextField *)SICO_textFieldForRowAtIndexPath:(NSIndexPath *)indexPath
{
    SICOTextFieldCell *cell = (SICOTextFieldCell *)[self.tableView cellForRowAtIndexPath:indexPath];
    return cell.textField;
}

#pragma mark View lifecycle

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    [self.tableView selectRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:0]
                                animated:NO scrollPosition:UITableViewScrollPositionTop];
}

#pragma mark UITextFieldDelegate

- (BOOL)textFieldShouldReturn:(UITextField *)textField
{
    switch (textField.returnKeyType) {
        case UIReturnKeyGo:   [self logIn];                                       break;
        case UIReturnKeyNext: [self.SICO_passwordTextField becomeFirstResponder]; break;
        default: break;
    }
    return YES;
}

#pragma mark Properties

- (UITextField *)SICO_emailAddressTextField
{
    return [self SICO_textFieldForRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:0]];
}

- (UITextField *)SICO_passwordTextField
{
    return [self SICO_textFieldForRowAtIndexPath:[NSIndexPath indexPathForRow:1 inSection:0]];
}

@end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T20:30:17.777

在创建单元格后尝试在 cellForRowAtIndexPath 方法中调用它，或者在包含该文本字段的 tableViewCell 的 viewWillAppear 中调用它。

如果这给您相同的结果并且您仍然希望键盘出现在之前，我会使用“假”文本字段在开头显示键盘。我的猜测是在 viewWillAppear 之前没有添加您的 textField。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-25T12:06:01.463

我在 viewWillAppear 中完全尝试了您的代码，iOS6 和它似乎工作正常。当您推到不同的视图时，您试图让键盘已经显示，对吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-02T10:24:01.313

我目前正在编写自己的输入表单工具包，并在这个问题上苦苦挣扎了几个小时。在发现我的编码没问题后，我发现这个问题指向 iOS 6 中可能存在的故障，并为此制定了解决方案。

如果您有（或创建）一个自定义 UITableViewCell，一个简单的解决方案就是子类 - (void) layoutSubviews; 并检查单元格的 UITextField 是否应该是第一响应者（即通过检查文本字段是否与您的委托中设置的焦点字段相同）。如果是这样，只需调用 - (BOOL) becomeFirstResponder; 在您的 UITextField 上（再次）。

这绝对是比创建“假” UITextField 更好的解决方案；）

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-12-11T07:38:09.943

-viewWillAppear 可能不会在 iOS6 中调用？你试过把你的代码放进去`- (void)viewWillLayoutSubviews`吗？

# sql-server - SSRS 可以用来模拟使用 aspx 的“漂亮”报告吗？

> ID：13479998
> 
> 赞同：0
> 
> 时间：2012-11-20T18:46:28.283
> 
> 标签：sql-server, reporting-services, ssrs-2008, reportingservices-2005

首先，我是 SSRS 的新手，所以如果这真的很简单，请原谅我。我想研究将报告（通过 C# 和 ASPX 创建）转换为 SSRS。报告如下所示：

![在此处输入图像描述](../Images/953e55a64ae4f66f39c7ae50b38dc2a5.png)

那么SSRS会帮我模拟那张照片吗？我知道里面有添加图片等工具。但我只是想检查一下它是否有限制。 [在此处输入链接描述](https://i.imgur.com/XjzIj.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T19:44:38.250

是的，您的屏幕截图看起来很标准 SSRS 输出。

帮助处理此类报告的一些提示：您可能会在一份报告中使用多个表格：确保将表格彼此对齐。否则，Excel 生成器将开始拆分和合并单元格以模仿您的布局。

如果数据元素的数量可变，请将它们作为单独的行保存在数据集中。（也许您的示例中的问题？）这可能会迫使您使用多个数据集。没关系，而且这些在 SSRS 中很容易使用。